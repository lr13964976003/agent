<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="9000pt" height="451pt"
 viewBox="0.00 0.00 2160.00 108.23" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.16 0.16) rotate(0) translate(4 2836.83)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2836.83 56689.65,-2836.83 56689.65,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightyellow" stroke="black" cx="10687.33" cy="-2784.75" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="10687.33" y="-2803.55" font-family="Times,serif" font-size="14.00">INPUT</text>
<text text-anchor="middle" x="10687.33" y="-2788.55" font-family="Times,serif" font-size="14.00">GPU: ALL_DP_RANKS</text>
<text text-anchor="middle" x="10687.33" y="-2773.55" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=2048]</text>
<text text-anchor="middle" x="10687.33" y="-2758.55" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=2048, hidden=7168]</text>
</g>
<!-- dp_split -->
<g id="node2" class="node">
<title>dp_split</title>
<polygon fill="lightcoral" stroke="black" points="11053.27,-2700.67 10471.13,-2700.67 10321.38,-2564.67 10903.52,-2564.67 11053.27,-2700.67"/>
<text text-anchor="middle" x="10687.33" y="-2651.47" font-family="Times,serif" font-size="14.00">DP_SPLIT</text>
<text text-anchor="middle" x="10687.33" y="-2636.47" font-family="Times,serif" font-size="14.00">GPU: DataParallelController</text>
<text text-anchor="middle" x="10687.33" y="-2621.47" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="10687.33" y="-2606.47" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- input&#45;&gt;dp_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;dp_split</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10687.33,-2736.26C10687.33,-2728.18 10687.33,-2719.59 10687.33,-2710.97"/>
<polygon fill="black" stroke="black" points="10690.83,-2710.86 10687.33,-2700.86 10683.83,-2710.86 10690.83,-2710.86"/>
</g>
<!-- layer1_mla_dp0_tp0 -->
<g id="node3" class="node">
<title>layer1_mla_dp0_tp0</title>
<polygon fill="lightblue" stroke="black" points="10882.83,-2528.67 10491.83,-2528.67 10491.83,-2460.67 10882.83,-2460.67 10882.83,-2528.67"/>
<text text-anchor="middle" x="10687.33" y="-2513.47" font-family="Times,serif" font-size="14.00">LAYER1_MLA</text>
<text text-anchor="middle" x="10687.33" y="-2498.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="10687.33" y="-2483.47" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="10687.33" y="-2468.47" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, heads=64, d_k=56]</text>
</g>
<!-- dp_split&#45;&gt;layer1_mla_dp0_tp0 -->
<g id="edge2" class="edge">
<title>dp_split&#45;&gt;layer1_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M10687.33,-2564.46C10687.33,-2555.71 10687.33,-2546.94 10687.33,-2538.73"/>
<polygon fill="black" stroke="black" points="10690.83,-2538.68 10687.33,-2528.68 10683.83,-2538.68 10690.83,-2538.68"/>
</g>
<!-- layer1_ffn_dp0_tp0 -->
<g id="node4" class="node">
<title>layer1_ffn_dp0_tp0</title>
<polygon fill="lightblue" stroke="black" points="10863.83,-2424.67 10510.83,-2424.67 10510.83,-2356.67 10863.83,-2356.67 10863.83,-2424.67"/>
<text text-anchor="middle" x="10687.33" y="-2409.47" font-family="Times,serif" font-size="14.00">LAYER1_FFN_TP</text>
<text text-anchor="middle" x="10687.33" y="-2394.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="10687.33" y="-2379.47" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="10687.33" y="-2364.47" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=3584]</text>
</g>
<!-- layer1_mla_dp0_tp0&#45;&gt;layer1_ffn_dp0_tp0 -->
<g id="edge3" class="edge">
<title>layer1_mla_dp0_tp0&#45;&gt;layer1_ffn_dp0_tp0</title>
<path fill="none" stroke="black" d="M10687.33,-2460.55C10687.33,-2452.44 10687.33,-2443.65 10687.33,-2435.14"/>
<polygon fill="black" stroke="black" points="10690.83,-2434.97 10687.33,-2424.97 10683.83,-2434.97 10690.83,-2434.97"/>
</g>
<!-- layer1_ffn_allreduce_dp0_tp0 -->
<g id="node5" class="node">
<title>layer1_ffn_allreduce_dp0_tp0</title>
<ellipse fill="lightyellow" stroke="black" cx="10687.33" cy="-2272.58" rx="249.72" ry="48.17"/>
<text text-anchor="middle" x="10687.33" y="-2291.38" font-family="Times,serif" font-size="14.00">LAYER1_FFN_ALLREDUCE</text>
<text text-anchor="middle" x="10687.33" y="-2276.38" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="10687.33" y="-2261.38" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="10687.33" y="-2246.38" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer1_ffn_dp0_tp0&#45;&gt;layer1_ffn_allreduce_dp0_tp0 -->
<g id="edge4" class="edge">
<title>layer1_ffn_dp0_tp0&#45;&gt;layer1_ffn_allreduce_dp0_tp0</title>
<path fill="none" stroke="black" d="M10687.33,-2356.4C10687.33,-2348.41 10687.33,-2339.64 10687.33,-2330.9"/>
<polygon fill="black" stroke="black" points="10690.83,-2330.69 10687.33,-2320.69 10683.83,-2330.69 10690.83,-2330.69"/>
</g>
<!-- layer4_mla_dp0_tp0 -->
<g id="node15" class="node">
<title>layer4_mla_dp0_tp0</title>
<polygon fill="lightblue" stroke="black" points="8149.83,-2188.5 7758.83,-2188.5 7758.83,-2120.5 8149.83,-2120.5 8149.83,-2188.5"/>
<text text-anchor="middle" x="7954.33" y="-2173.3" font-family="Times,serif" font-size="14.00">LAYER4_MLA</text>
<text text-anchor="middle" x="7954.33" y="-2158.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="7954.33" y="-2143.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="7954.33" y="-2128.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, heads=64, d_k=56]</text>
</g>
<!-- layer1_ffn_allreduce_dp0_tp0&#45;&gt;layer4_mla_dp0_tp0 -->
<g id="edge11" class="edge">
<title>layer1_ffn_allreduce_dp0_tp0&#45;&gt;layer4_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M10444.49,-2261.27C9913.15,-2238.7 8655.42,-2185.28 8159.99,-2164.24"/>
<polygon fill="black" stroke="black" points="8160.01,-2160.73 8149.87,-2163.81 8159.72,-2167.73 8160.01,-2160.73"/>
</g>
<!-- layer4_mla_dp0_tp1 -->
<g id="node16" class="node">
<title>layer4_mla_dp0_tp1</title>
<polygon fill="lightblue" stroke="black" points="20495.83,-2188.5 20104.83,-2188.5 20104.83,-2120.5 20495.83,-2120.5 20495.83,-2188.5"/>
<text text-anchor="middle" x="20300.33" y="-2173.3" font-family="Times,serif" font-size="14.00">LAYER4_MLA</text>
<text text-anchor="middle" x="20300.33" y="-2158.3" font-family="Times,serif" font-size="14.00">GPU: 68</text>
<text text-anchor="middle" x="20300.33" y="-2143.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="20300.33" y="-2128.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, heads=64, d_k=56]</text>
</g>
<!-- layer1_ffn_allreduce_dp0_tp0&#45;&gt;layer4_mla_dp0_tp1 -->
<g id="edge13" class="edge">
<title>layer1_ffn_allreduce_dp0_tp0&#45;&gt;layer4_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M10936.14,-2268.58C12299.14,-2252.12 18844.49,-2173.08 20093.97,-2157.99"/>
<polygon fill="black" stroke="black" points="20094.44,-2161.49 20104.4,-2157.87 20094.36,-2154.49 20094.44,-2161.49"/>
</g>
<!-- layer1_mla_dp0_tp1 -->
<g id="node6" class="node">
<title>layer1_mla_dp0_tp1</title>
<polygon fill="lightblue" stroke="black" points="17763.83,-2528.67 17372.83,-2528.67 17372.83,-2460.67 17763.83,-2460.67 17763.83,-2528.67"/>
<text text-anchor="middle" x="17568.33" y="-2513.47" font-family="Times,serif" font-size="14.00">LAYER1_MLA</text>
<text text-anchor="middle" x="17568.33" y="-2498.47" font-family="Times,serif" font-size="14.00">GPU: 64</text>
<text text-anchor="middle" x="17568.33" y="-2483.47" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="17568.33" y="-2468.47" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, heads=64, d_k=56]</text>
</g>
<!-- layer1_ffn_dp0_tp1 -->
<g id="node7" class="node">
<title>layer1_ffn_dp0_tp1</title>
<polygon fill="lightblue" stroke="black" points="17744.83,-2424.67 17391.83,-2424.67 17391.83,-2356.67 17744.83,-2356.67 17744.83,-2424.67"/>
<text text-anchor="middle" x="17568.33" y="-2409.47" font-family="Times,serif" font-size="14.00">LAYER1_FFN_TP</text>
<text text-anchor="middle" x="17568.33" y="-2394.47" font-family="Times,serif" font-size="14.00">GPU: 64</text>
<text text-anchor="middle" x="17568.33" y="-2379.47" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="17568.33" y="-2364.47" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=3584]</text>
</g>
<!-- layer1_mla_dp0_tp1&#45;&gt;layer1_ffn_dp0_tp1 -->
<g id="edge5" class="edge">
<title>layer1_mla_dp0_tp1&#45;&gt;layer1_ffn_dp0_tp1</title>
<path fill="none" stroke="black" d="M17568.33,-2460.55C17568.33,-2452.44 17568.33,-2443.65 17568.33,-2435.14"/>
<polygon fill="black" stroke="black" points="17571.83,-2434.97 17568.33,-2424.97 17564.83,-2434.97 17571.83,-2434.97"/>
</g>
<!-- layer1_ffn_allreduce_dp0_tp1 -->
<g id="node8" class="node">
<title>layer1_ffn_allreduce_dp0_tp1</title>
<ellipse fill="lightyellow" stroke="black" cx="17568.33" cy="-2272.58" rx="249.72" ry="48.17"/>
<text text-anchor="middle" x="17568.33" y="-2291.38" font-family="Times,serif" font-size="14.00">LAYER1_FFN_ALLREDUCE</text>
<text text-anchor="middle" x="17568.33" y="-2276.38" font-family="Times,serif" font-size="14.00">GPU: 64</text>
<text text-anchor="middle" x="17568.33" y="-2261.38" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="17568.33" y="-2246.38" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer1_ffn_dp0_tp1&#45;&gt;layer1_ffn_allreduce_dp0_tp1 -->
<g id="edge6" class="edge">
<title>layer1_ffn_dp0_tp1&#45;&gt;layer1_ffn_allreduce_dp0_tp1</title>
<path fill="none" stroke="black" d="M17568.33,-2356.4C17568.33,-2348.41 17568.33,-2339.64 17568.33,-2330.9"/>
<polygon fill="black" stroke="black" points="17571.83,-2330.69 17568.33,-2320.69 17564.83,-2330.69 17571.83,-2330.69"/>
</g>
<!-- layer1_ffn_allreduce_dp0_tp1&#45;&gt;layer4_mla_dp0_tp0 -->
<g id="edge12" class="edge">
<title>layer1_ffn_allreduce_dp0_tp1&#45;&gt;layer4_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M17319.49,-2268.58C15956.35,-2252.12 9410.32,-2173.08 8160.7,-2157.99"/>
<polygon fill="black" stroke="black" points="8160.31,-2154.49 8150.27,-2157.87 8160.23,-2161.49 8160.31,-2154.49"/>
</g>
<!-- layer1_ffn_allreduce_dp0_tp1&#45;&gt;layer4_mla_dp0_tp1 -->
<g id="edge14" class="edge">
<title>layer1_ffn_allreduce_dp0_tp1&#45;&gt;layer4_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M17811.07,-2261.27C18342.05,-2238.71 19598.73,-2185.31 20094.28,-2164.25"/>
<polygon fill="black" stroke="black" points="20094.56,-2167.75 20104.4,-2163.82 20094.26,-2160.75 20094.56,-2167.75"/>
</g>
<!-- layer1_mla_dp1_tp0 -->
<g id="node9" class="node">
<title>layer1_mla_dp1_tp0</title>
<polygon fill="lightblue" stroke="black" points="39542.83,-2528.67 39151.83,-2528.67 39151.83,-2460.67 39542.83,-2460.67 39542.83,-2528.67"/>
<text text-anchor="middle" x="39347.33" y="-2513.47" font-family="Times,serif" font-size="14.00">LAYER1_MLA</text>
<text text-anchor="middle" x="39347.33" y="-2498.47" font-family="Times,serif" font-size="14.00">GPU: 128</text>
<text text-anchor="middle" x="39347.33" y="-2483.47" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="39347.33" y="-2468.47" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, heads=64, d_k=56]</text>
</g>
<!-- layer1_ffn_dp1_tp0 -->
<g id="node10" class="node">
<title>layer1_ffn_dp1_tp0</title>
<polygon fill="lightblue" stroke="black" points="39523.83,-2424.67 39170.83,-2424.67 39170.83,-2356.67 39523.83,-2356.67 39523.83,-2424.67"/>
<text text-anchor="middle" x="39347.33" y="-2409.47" font-family="Times,serif" font-size="14.00">LAYER1_FFN_TP</text>
<text text-anchor="middle" x="39347.33" y="-2394.47" font-family="Times,serif" font-size="14.00">GPU: 128</text>
<text text-anchor="middle" x="39347.33" y="-2379.47" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="39347.33" y="-2364.47" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=3584]</text>
</g>
<!-- layer1_mla_dp1_tp0&#45;&gt;layer1_ffn_dp1_tp0 -->
<g id="edge7" class="edge">
<title>layer1_mla_dp1_tp0&#45;&gt;layer1_ffn_dp1_tp0</title>
<path fill="none" stroke="black" d="M39347.33,-2460.55C39347.33,-2452.44 39347.33,-2443.65 39347.33,-2435.14"/>
<polygon fill="black" stroke="black" points="39350.83,-2434.97 39347.33,-2424.97 39343.83,-2434.97 39350.83,-2434.97"/>
</g>
<!-- layer1_ffn_allreduce_dp1_tp0 -->
<g id="node11" class="node">
<title>layer1_ffn_allreduce_dp1_tp0</title>
<ellipse fill="lightyellow" stroke="black" cx="39347.33" cy="-2272.58" rx="249.72" ry="48.17"/>
<text text-anchor="middle" x="39347.33" y="-2291.38" font-family="Times,serif" font-size="14.00">LAYER1_FFN_ALLREDUCE</text>
<text text-anchor="middle" x="39347.33" y="-2276.38" font-family="Times,serif" font-size="14.00">GPU: 128</text>
<text text-anchor="middle" x="39347.33" y="-2261.38" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="39347.33" y="-2246.38" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer1_ffn_dp1_tp0&#45;&gt;layer1_ffn_allreduce_dp1_tp0 -->
<g id="edge8" class="edge">
<title>layer1_ffn_dp1_tp0&#45;&gt;layer1_ffn_allreduce_dp1_tp0</title>
<path fill="none" stroke="black" d="M39347.33,-2356.4C39347.33,-2348.41 39347.33,-2339.64 39347.33,-2330.9"/>
<polygon fill="black" stroke="black" points="39350.83,-2330.69 39347.33,-2320.69 39343.83,-2330.69 39350.83,-2330.69"/>
</g>
<!-- layer4_mla_dp1_tp0 -->
<g id="node17" class="node">
<title>layer4_mla_dp1_tp0</title>
<polygon fill="lightblue" stroke="black" points="36581.83,-2188.5 36190.83,-2188.5 36190.83,-2120.5 36581.83,-2120.5 36581.83,-2188.5"/>
<text text-anchor="middle" x="36386.33" y="-2173.3" font-family="Times,serif" font-size="14.00">LAYER4_MLA</text>
<text text-anchor="middle" x="36386.33" y="-2158.3" font-family="Times,serif" font-size="14.00">GPU: 132</text>
<text text-anchor="middle" x="36386.33" y="-2143.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="36386.33" y="-2128.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, heads=64, d_k=56]</text>
</g>
<!-- layer1_ffn_allreduce_dp1_tp0&#45;&gt;layer4_mla_dp1_tp0 -->
<g id="edge15" class="edge">
<title>layer1_ffn_allreduce_dp1_tp0&#45;&gt;layer4_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M39103.76,-2262.03C38533.98,-2239.7 37122.42,-2184.36 36592.1,-2163.57"/>
<polygon fill="black" stroke="black" points="36592.17,-2160.07 36582.04,-2163.17 36591.9,-2167.06 36592.17,-2160.07"/>
</g>
<!-- layer4_mla_dp1_tp1 -->
<g id="node18" class="node">
<title>layer4_mla_dp1_tp1</title>
<polygon fill="lightblue" stroke="black" points="48942.83,-2188.5 48551.83,-2188.5 48551.83,-2120.5 48942.83,-2120.5 48942.83,-2188.5"/>
<text text-anchor="middle" x="48747.33" y="-2173.3" font-family="Times,serif" font-size="14.00">LAYER4_MLA</text>
<text text-anchor="middle" x="48747.33" y="-2158.3" font-family="Times,serif" font-size="14.00">GPU: 196</text>
<text text-anchor="middle" x="48747.33" y="-2143.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="48747.33" y="-2128.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, heads=64, d_k=56]</text>
</g>
<!-- layer1_ffn_allreduce_dp1_tp0&#45;&gt;layer4_mla_dp1_tp1 -->
<g id="edge17" class="edge">
<title>layer1_ffn_allreduce_dp1_tp0&#45;&gt;layer4_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M39596.33,-2268.51C40939.96,-2251.91 47310.04,-2173.25 48541.09,-2158.05"/>
<polygon fill="black" stroke="black" points="48541.41,-2161.54 48551.37,-2157.92 48541.33,-2154.54 48541.41,-2161.54"/>
</g>
<!-- layer1_mla_dp1_tp1 -->
<g id="node12" class="node">
<title>layer1_mla_dp1_tp1</title>
<polygon fill="lightblue" stroke="black" points="45981.83,-2528.67 45590.83,-2528.67 45590.83,-2460.67 45981.83,-2460.67 45981.83,-2528.67"/>
<text text-anchor="middle" x="45786.33" y="-2513.47" font-family="Times,serif" font-size="14.00">LAYER1_MLA</text>
<text text-anchor="middle" x="45786.33" y="-2498.47" font-family="Times,serif" font-size="14.00">GPU: 192</text>
<text text-anchor="middle" x="45786.33" y="-2483.47" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="45786.33" y="-2468.47" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, heads=64, d_k=56]</text>
</g>
<!-- layer1_ffn_dp1_tp1 -->
<g id="node13" class="node">
<title>layer1_ffn_dp1_tp1</title>
<polygon fill="lightblue" stroke="black" points="45962.83,-2424.67 45609.83,-2424.67 45609.83,-2356.67 45962.83,-2356.67 45962.83,-2424.67"/>
<text text-anchor="middle" x="45786.33" y="-2409.47" font-family="Times,serif" font-size="14.00">LAYER1_FFN_TP</text>
<text text-anchor="middle" x="45786.33" y="-2394.47" font-family="Times,serif" font-size="14.00">GPU: 192</text>
<text text-anchor="middle" x="45786.33" y="-2379.47" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="45786.33" y="-2364.47" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=3584]</text>
</g>
<!-- layer1_mla_dp1_tp1&#45;&gt;layer1_ffn_dp1_tp1 -->
<g id="edge9" class="edge">
<title>layer1_mla_dp1_tp1&#45;&gt;layer1_ffn_dp1_tp1</title>
<path fill="none" stroke="black" d="M45786.33,-2460.55C45786.33,-2452.44 45786.33,-2443.65 45786.33,-2435.14"/>
<polygon fill="black" stroke="black" points="45789.83,-2434.97 45786.33,-2424.97 45782.83,-2434.97 45789.83,-2434.97"/>
</g>
<!-- layer1_ffn_allreduce_dp1_tp1 -->
<g id="node14" class="node">
<title>layer1_ffn_allreduce_dp1_tp1</title>
<ellipse fill="lightyellow" stroke="black" cx="45786.33" cy="-2272.58" rx="249.72" ry="48.17"/>
<text text-anchor="middle" x="45786.33" y="-2291.38" font-family="Times,serif" font-size="14.00">LAYER1_FFN_ALLREDUCE</text>
<text text-anchor="middle" x="45786.33" y="-2276.38" font-family="Times,serif" font-size="14.00">GPU: 192</text>
<text text-anchor="middle" x="45786.33" y="-2261.38" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="45786.33" y="-2246.38" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer1_ffn_dp1_tp1&#45;&gt;layer1_ffn_allreduce_dp1_tp1 -->
<g id="edge10" class="edge">
<title>layer1_ffn_dp1_tp1&#45;&gt;layer1_ffn_allreduce_dp1_tp1</title>
<path fill="none" stroke="black" d="M45786.33,-2356.4C45786.33,-2348.41 45786.33,-2339.64 45786.33,-2330.9"/>
<polygon fill="black" stroke="black" points="45789.83,-2330.69 45786.33,-2320.69 45782.83,-2330.69 45789.83,-2330.69"/>
</g>
<!-- layer1_ffn_allreduce_dp1_tp1&#45;&gt;layer4_mla_dp1_tp0 -->
<g id="edge16" class="edge">
<title>layer1_ffn_allreduce_dp1_tp1&#45;&gt;layer4_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M45537.32,-2268.51C44193.7,-2251.91 37823.62,-2173.25 36592.56,-2158.05"/>
<polygon fill="black" stroke="black" points="36592.33,-2154.54 36582.28,-2157.92 36592.24,-2161.54 36592.33,-2154.54"/>
</g>
<!-- layer1_ffn_allreduce_dp1_tp1&#45;&gt;layer4_mla_dp1_tp1 -->
<g id="edge18" class="edge">
<title>layer1_ffn_allreduce_dp1_tp1&#45;&gt;layer4_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M46029.9,-2262.03C46599.67,-2239.7 48011.23,-2184.36 48541.55,-2163.57"/>
<polygon fill="black" stroke="black" points="48541.75,-2167.06 48551.61,-2163.17 48541.48,-2160.07 48541.75,-2167.06"/>
</g>
<!-- layer4_gate_dp0_tp0_ep0 -->
<g id="node19" class="node">
<title>layer4_gate_dp0_tp0_ep0</title>
<polygon fill="lightgreen" stroke="black" points="898.63,-2084.5 263.43,-2084.5 100.03,-1948.5 735.22,-1948.5 898.63,-2084.5"/>
<text text-anchor="middle" x="499.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="499.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="499.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="499.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep0 -->
<g id="edge19" class="edge">
<title>layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7758.61,-2153.22C6695.27,-2151.5 1634.97,-2140.4 940.33,-2084.5 928.22,-2083.53 915.94,-2082.42 903.56,-2081.2"/>
<polygon fill="black" stroke="black" points="903.91,-2077.72 893.61,-2080.2 903.21,-2084.68 903.91,-2077.72"/>
</g>
<!-- layer4_gate_dp0_tp0_ep1 -->
<g id="node25" class="node">
<title>layer4_gate_dp0_tp0_ep1</title>
<polygon fill="lightgreen" stroke="black" points="1747.63,-2084.5 1112.43,-2084.5 949.03,-1948.5 1584.22,-1948.5 1747.63,-2084.5"/>
<text text-anchor="middle" x="1348.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="1348.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1348.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="1348.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep1 -->
<g id="edge25" class="edge">
<title>layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7758.5,-2152.8C6778.02,-2149.09 2425.52,-2130.17 1823.33,-2084.5 1798.86,-2082.64 1773.73,-2080.33 1748.42,-2077.68"/>
<polygon fill="black" stroke="black" points="1748.64,-2074.19 1738.33,-2076.61 1747.91,-2081.15 1748.64,-2074.19"/>
</g>
<!-- layer4_gate_dp0_tp0_ep2 -->
<g id="node31" class="node">
<title>layer4_gate_dp0_tp0_ep2</title>
<polygon fill="lightgreen" stroke="black" points="2630.63,-2084.5 1995.43,-2084.5 1832.03,-1948.5 2467.22,-1948.5 2630.63,-2084.5"/>
<text text-anchor="middle" x="2231.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="2231.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="2231.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="2231.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep2 -->
<g id="edge31" class="edge">
<title>layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7758.67,-2152.4C6867.77,-2147.2 3216.23,-2123.65 2706.33,-2084.5 2681.86,-2082.62 2656.73,-2080.29 2631.42,-2077.63"/>
<polygon fill="black" stroke="black" points="2631.65,-2074.13 2621.34,-2076.55 2630.91,-2081.09 2631.65,-2074.13"/>
</g>
<!-- layer4_gate_dp0_tp0_ep3 -->
<g id="node37" class="node">
<title>layer4_gate_dp0_tp0_ep3</title>
<polygon fill="lightgreen" stroke="black" points="3513.63,-2084.5 2878.43,-2084.5 2715.03,-1948.5 3350.22,-1948.5 3513.63,-2084.5"/>
<text text-anchor="middle" x="3114.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="3114.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="3114.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="3114.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep3 -->
<g id="edge37" class="edge">
<title>layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7758.67,-2153.64C7022.17,-2153.68 4416.6,-2149.13 3589.33,-2084.5 3564.77,-2082.58 3539.55,-2080.21 3514.14,-2077.52"/>
<polygon fill="black" stroke="black" points="3514.34,-2074.02 3504.02,-2076.43 3513.59,-2080.98 3514.34,-2074.02"/>
</g>
<!-- layer4_gate_dp0_tp0_ep4 -->
<g id="node43" class="node">
<title>layer4_gate_dp0_tp0_ep4</title>
<polygon fill="lightgreen" stroke="black" points="4396.63,-2084.5 3761.43,-2084.5 3598.03,-1948.5 4233.22,-1948.5 4396.63,-2084.5"/>
<text text-anchor="middle" x="3997.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="3997.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="3997.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="3997.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep4 -->
<g id="edge43" class="edge">
<title>layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7758.63,-2152.58C7124.74,-2149.12 5131.75,-2134.47 4489.33,-2084.5 4458.6,-2082.11 4426.85,-2079.08 4394.98,-2075.64"/>
<polygon fill="black" stroke="black" points="4394.95,-2072.11 4384.63,-2074.5 4394.19,-2079.07 4394.95,-2072.11"/>
</g>
<!-- layer4_gate_dp0_tp0_ep5 -->
<g id="node49" class="node">
<title>layer4_gate_dp0_tp0_ep5</title>
<polygon fill="lightgreen" stroke="black" points="5296.63,-2084.5 4661.43,-2084.5 4498.03,-1948.5 5133.22,-1948.5 5296.63,-2084.5"/>
<text text-anchor="middle" x="4897.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="4897.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="4897.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="4897.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep5 -->
<g id="edge49" class="edge">
<title>layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7758.6,-2151.14C7239.53,-2144.41 5835.94,-2123.12 5373.33,-2084.5 5348.25,-2082.41 5322.48,-2079.88 5296.53,-2077.04"/>
<polygon fill="black" stroke="black" points="5296.9,-2073.56 5286.58,-2075.94 5296.13,-2080.52 5296.9,-2073.56"/>
</g>
<!-- layer4_gate_dp0_tp0_ep6 -->
<g id="node55" class="node">
<title>layer4_gate_dp0_tp0_ep6</title>
<polygon fill="lightgreen" stroke="black" points="6180.63,-2084.5 5545.43,-2084.5 5382.03,-1948.5 6017.22,-1948.5 6180.63,-2084.5"/>
<text text-anchor="middle" x="5781.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="5781.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="5781.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="5781.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep6 -->
<g id="edge55" class="edge">
<title>layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7758.78,-2151.87C7442.42,-2147.81 6799,-2133.68 6256.33,-2084.5 6231.52,-2082.25 6206.03,-2079.62 6180.35,-2076.71"/>
<polygon fill="black" stroke="black" points="6180.45,-2073.2 6170.12,-2075.54 6179.66,-2080.15 6180.45,-2073.2"/>
</g>
<!-- layer4_gate_dp0_tp0_ep7 -->
<g id="node61" class="node">
<title>layer4_gate_dp0_tp0_ep7</title>
<polygon fill="lightgreen" stroke="black" points="7063.63,-2084.5 6428.43,-2084.5 6265.03,-1948.5 6900.22,-1948.5 7063.63,-2084.5"/>
<text text-anchor="middle" x="6664.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="6664.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="6664.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="6664.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep7 -->
<g id="edge61" class="edge">
<title>layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7758.79,-2141.49C7586.46,-2129.98 7328.78,-2110.52 7105.33,-2084.5 7092.61,-2083.02 7079.69,-2081.45 7066.66,-2079.81"/>
<polygon fill="black" stroke="black" points="7067.03,-2076.33 7056.67,-2078.54 7066.15,-2083.27 7067.03,-2076.33"/>
</g>
<!-- layer4_gate_dp0_tp0_ep8 -->
<g id="node67" class="node">
<title>layer4_gate_dp0_tp0_ep8</title>
<polygon fill="lightgreen" stroke="black" points="7912.63,-2084.5 7277.43,-2084.5 7114.03,-1948.5 7749.22,-1948.5 7912.63,-2084.5"/>
<text text-anchor="middle" x="7513.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="7513.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="7513.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="7513.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep8 -->
<g id="edge67" class="edge">
<title>layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7847.29,-2120.49C7814.88,-2110.5 7777.97,-2099.11 7740.8,-2087.65"/>
<polygon fill="black" stroke="black" points="7741.42,-2084.18 7730.83,-2084.58 7739.35,-2090.87 7741.42,-2084.18"/>
</g>
<!-- layer4_gate_dp0_tp0_ep9 -->
<g id="node73" class="node">
<title>layer4_gate_dp0_tp0_ep9</title>
<polygon fill="lightgreen" stroke="black" points="8745.63,-2084.5 8110.43,-2084.5 7947.03,-1948.5 8582.22,-1948.5 8745.63,-2084.5"/>
<text text-anchor="middle" x="8346.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="8346.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="8346.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="8346.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep9 -->
<g id="edge73" class="edge">
<title>layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8049.47,-2120.49C8078.03,-2110.58 8110.53,-2099.31 8143.28,-2087.94"/>
<polygon fill="black" stroke="black" points="8144.69,-2091.16 8152.99,-2084.58 8142.39,-2084.55 8144.69,-2091.16"/>
</g>
<!-- layer4_gate_dp0_tp0_ep10 -->
<g id="node79" class="node">
<title>layer4_gate_dp0_tp0_ep10</title>
<polygon fill="lightgreen" stroke="black" points="9611.63,-2084.5 8976.43,-2084.5 8813.03,-1948.5 9448.22,-1948.5 9611.63,-2084.5"/>
<text text-anchor="middle" x="9212.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="9212.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="9212.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="9212.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep10 -->
<g id="edge79" class="edge">
<title>layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8149.86,-2139.88C8312.04,-2127.81 8548.52,-2108.41 8754.33,-2084.5 8813.21,-2077.66 8876.19,-2069.2 8936.01,-2060.62"/>
<polygon fill="black" stroke="black" points="8936.57,-2064.07 8945.97,-2059.18 8935.58,-2057.14 8936.57,-2064.07"/>
</g>
<!-- layer4_gate_dp0_tp0_ep11 -->
<g id="node85" class="node">
<title>layer4_gate_dp0_tp0_ep11</title>
<polygon fill="lightgreen" stroke="black" points="10486.63,-2084.5 9851.43,-2084.5 9688.03,-1948.5 10323.22,-1948.5 10486.63,-2084.5"/>
<text text-anchor="middle" x="10087.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="10087.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="10087.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="10087.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep11 -->
<g id="edge85" class="edge">
<title>layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8150,-2151.8C8461.74,-2147.64 9090.11,-2133.39 9620.33,-2084.5 9682.55,-2078.76 9749.17,-2070.49 9812.03,-2061.71"/>
<polygon fill="black" stroke="black" points="9812.66,-2065.16 9822.08,-2060.3 9811.69,-2058.23 9812.66,-2065.16"/>
</g>
<!-- layer4_gate_dp0_tp0_ep12 -->
<g id="node91" class="node">
<title>layer4_gate_dp0_tp0_ep12</title>
<polygon fill="lightgreen" stroke="black" points="11365.63,-2084.5 10730.43,-2084.5 10567.03,-1948.5 11202.22,-1948.5 11365.63,-2084.5"/>
<text text-anchor="middle" x="10966.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="10966.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="10966.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="10966.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep12 -->
<g id="edge91" class="edge">
<title>layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8150.27,-2151.08C8663.89,-2144.26 10040.88,-2122.87 10495.33,-2084.5 10559,-2079.12 10627.2,-2070.88 10691.37,-2061.99"/>
<polygon fill="black" stroke="black" points="10692.22,-2065.41 10701.64,-2060.56 10691.25,-2058.47 10692.22,-2065.41"/>
</g>
<!-- layer4_gate_dp0_tp0_ep13 -->
<g id="node97" class="node">
<title>layer4_gate_dp0_tp0_ep13</title>
<polygon fill="lightgreen" stroke="black" points="12246.63,-2084.5 11611.43,-2084.5 11448.03,-1948.5 12083.22,-1948.5 12246.63,-2084.5"/>
<text text-anchor="middle" x="11847.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="11847.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="11847.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="11847.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep13 -->
<g id="edge97" class="edge">
<title>layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8149.96,-2152.66C8778.35,-2149.46 10741.22,-2135.54 11374.33,-2084.5 11438.81,-2079.3 11507.9,-2071.05 11572.81,-2062.09"/>
<polygon fill="black" stroke="black" points="11573.35,-2065.55 11582.78,-2060.71 11572.39,-2058.62 11573.35,-2065.55"/>
</g>
<!-- layer4_gate_dp0_tp0_ep14 -->
<g id="node103" class="node">
<title>layer4_gate_dp0_tp0_ep14</title>
<polygon fill="lightgreen" stroke="black" points="13128.63,-2084.5 12493.43,-2084.5 12330.03,-1948.5 12965.22,-1948.5 13128.63,-2084.5"/>
<text text-anchor="middle" x="12729.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="12729.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="12729.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="12729.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep14 -->
<g id="edge103" class="edge">
<title>layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8149.92,-2153.6C8879.41,-2153.45 11441.25,-2148.32 12255.33,-2084.5 12320.15,-2079.42 12389.62,-2071.19 12454.84,-2062.2"/>
<polygon fill="black" stroke="black" points="12455.43,-2065.65 12464.85,-2060.81 12454.46,-2058.72 12455.43,-2065.65"/>
</g>
<!-- layer4_gate_dp0_tp0_ep15 -->
<g id="node109" class="node">
<title>layer4_gate_dp0_tp0_ep15</title>
<polygon fill="lightgreen" stroke="black" points="14010.63,-2084.5 13375.43,-2084.5 13212.03,-1948.5 13847.22,-1948.5 14010.63,-2084.5"/>
<text text-anchor="middle" x="13611.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="13611.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="13611.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="13611.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep15 -->
<g id="edge109" class="edge">
<title>layer4_mla_dp0_tp0&#45;&gt;layer4_gate_dp0_tp0_ep15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8150.14,-2152.37C9034.45,-2147.06 12634.24,-2123.25 13137.33,-2084.5 13202.15,-2079.51 13271.63,-2071.31 13336.85,-2062.33"/>
<polygon fill="black" stroke="black" points="13337.44,-2065.78 13346.86,-2060.94 13336.48,-2058.85 13337.44,-2065.78"/>
</g>
<!-- layer4_gate_dp0_tp1_ep0 -->
<g id="node115" class="node">
<title>layer4_gate_dp0_tp1_ep0</title>
<polygon fill="lightgreen" stroke="black" points="15026.63,-2084.5 14391.43,-2084.5 14228.03,-1948.5 14863.22,-1948.5 15026.63,-2084.5"/>
<text text-anchor="middle" x="14627.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="14627.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 68</text>
<text text-anchor="middle" x="14627.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="14627.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep0 -->
<g id="edge115" class="edge">
<title>layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20104.51,-2152.52C19215,-2147.83 15576.32,-2126.24 15068.33,-2084.5 15056.22,-2083.51 15043.95,-2082.38 15031.56,-2081.15"/>
<polygon fill="black" stroke="black" points="15031.92,-2077.66 15021.61,-2080.13 15031.21,-2084.63 15031.92,-2077.66"/>
</g>
<!-- layer4_gate_dp0_tp1_ep1 -->
<g id="node121" class="node">
<title>layer4_gate_dp0_tp1_ep1</title>
<polygon fill="lightgreen" stroke="black" points="15875.63,-2084.5 15240.43,-2084.5 15077.03,-1948.5 15712.22,-1948.5 15875.63,-2084.5"/>
<text text-anchor="middle" x="15476.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="15476.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 69</text>
<text text-anchor="middle" x="15476.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="15476.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep1 -->
<g id="edge121" class="edge">
<title>layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20104.76,-2153.63C19370.11,-2153.62 16775.33,-2148.9 15951.33,-2084.5 15926.77,-2082.58 15901.55,-2080.21 15876.14,-2077.52"/>
<polygon fill="black" stroke="black" points="15876.34,-2074.02 15866.02,-2076.43 15875.59,-2080.98 15876.34,-2074.02"/>
</g>
<!-- layer4_gate_dp0_tp1_ep2 -->
<g id="node127" class="node">
<title>layer4_gate_dp0_tp1_ep2</title>
<polygon fill="lightgreen" stroke="black" points="16758.63,-2084.5 16123.43,-2084.5 15960.03,-1948.5 16595.22,-1948.5 16758.63,-2084.5"/>
<text text-anchor="middle" x="16359.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="16359.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 70</text>
<text text-anchor="middle" x="16359.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="16359.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep2 -->
<g id="edge127" class="edge">
<title>layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20104.56,-2152.7C19470.46,-2149.63 17476.81,-2136.02 16834.33,-2084.5 16809.77,-2082.53 16784.56,-2080.12 16759.15,-2077.4"/>
<polygon fill="black" stroke="black" points="16759.35,-2073.9 16749.03,-2076.3 16758.59,-2080.86 16759.35,-2073.9"/>
</g>
<!-- layer4_gate_dp0_tp1_ep3 -->
<g id="node133" class="node">
<title>layer4_gate_dp0_tp1_ep3</title>
<polygon fill="lightgreen" stroke="black" points="17641.63,-2084.5 17006.43,-2084.5 16843.03,-1948.5 17478.22,-1948.5 17641.63,-2084.5"/>
<text text-anchor="middle" x="17242.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="17242.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 71</text>
<text text-anchor="middle" x="17242.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="17242.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep3 -->
<g id="edge133" class="edge">
<title>layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20104.82,-2150.99C19588.03,-2143.92 18194.05,-2121.87 17734.33,-2084.5 17703.37,-2081.98 17671.39,-2078.85 17639.28,-2075.32"/>
<polygon fill="black" stroke="black" points="17639.64,-2071.84 17629.31,-2074.21 17638.86,-2078.79 17639.64,-2071.84"/>
</g>
<!-- layer4_gate_dp0_tp1_ep4 -->
<g id="node139" class="node">
<title>layer4_gate_dp0_tp1_ep4</title>
<polygon fill="lightgreen" stroke="black" points="18541.63,-2084.5 17906.43,-2084.5 17743.03,-1948.5 18378.22,-1948.5 18541.63,-2084.5"/>
<text text-anchor="middle" x="18142.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="18142.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 72</text>
<text text-anchor="middle" x="18142.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="18142.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep4 -->
<g id="edge139" class="edge">
<title>layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20104.59,-2152.64C19785.49,-2149.66 19133.6,-2137.01 18584.33,-2084.5 18571.55,-2083.28 18558.58,-2081.94 18545.5,-2080.49"/>
<polygon fill="black" stroke="black" points="18545.8,-2077 18535.47,-2079.37 18545.02,-2083.96 18545.8,-2077"/>
</g>
<!-- layer4_gate_dp0_tp1_ep5 -->
<g id="node145" class="node">
<title>layer4_gate_dp0_tp1_ep5</title>
<polygon fill="lightgreen" stroke="black" points="19391.63,-2084.5 18756.43,-2084.5 18593.03,-1948.5 19228.22,-1948.5 19391.63,-2084.5"/>
<text text-anchor="middle" x="18992.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="18992.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 73</text>
<text text-anchor="middle" x="18992.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="18992.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep5 -->
<g id="edge145" class="edge">
<title>layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20104.78,-2140.49C19935.77,-2128.49 19685.09,-2108.86 19467.33,-2084.5 19441.82,-2081.65 19415.58,-2078.51 19389.14,-2075.2"/>
<polygon fill="black" stroke="black" points="19389.36,-2071.7 19379,-2073.92 19388.48,-2078.64 19389.36,-2071.7"/>
</g>
<!-- layer4_gate_dp0_tp1_ep6 -->
<g id="node151" class="node">
<title>layer4_gate_dp0_tp1_ep6</title>
<polygon fill="lightgreen" stroke="black" points="20274.63,-2084.5 19639.43,-2084.5 19476.03,-1948.5 20111.22,-1948.5 20274.63,-2084.5"/>
<text text-anchor="middle" x="19875.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="19875.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 74</text>
<text text-anchor="middle" x="19875.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="19875.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep6 -->
<g id="edge151" class="edge">
<title>layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20197.17,-2120.49C20165.94,-2110.5 20130.37,-2099.11 20094.55,-2087.65"/>
<polygon fill="black" stroke="black" points="20095.53,-2084.29 20084.94,-2084.58 20093.4,-2090.96 20095.53,-2084.29"/>
</g>
<!-- layer4_gate_dp0_tp1_ep7 -->
<g id="node157" class="node">
<title>layer4_gate_dp0_tp1_ep7</title>
<polygon fill="lightgreen" stroke="black" points="21123.63,-2084.5 20488.43,-2084.5 20325.03,-1948.5 20960.22,-1948.5 21123.63,-2084.5"/>
<text text-anchor="middle" x="20724.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="20724.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 75</text>
<text text-anchor="middle" x="20724.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="20724.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep7 -->
<g id="edge157" class="edge">
<title>layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20403.24,-2120.49C20434.4,-2110.5 20469.88,-2099.11 20505.62,-2087.65"/>
<polygon fill="black" stroke="black" points="20506.75,-2090.96 20515.21,-2084.58 20504.62,-2084.3 20506.75,-2090.96"/>
</g>
<!-- layer4_gate_dp0_tp1_ep8 -->
<g id="node163" class="node">
<title>layer4_gate_dp0_tp1_ep8</title>
<polygon fill="lightgreen" stroke="black" points="21990.63,-2084.5 21355.43,-2084.5 21192.03,-1948.5 21827.22,-1948.5 21990.63,-2084.5"/>
<text text-anchor="middle" x="21591.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="21591.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 76</text>
<text text-anchor="middle" x="21591.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="21591.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep8 -->
<g id="edge163" class="edge">
<title>layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20496.09,-2140.72C20664.9,-2128.87 20915.06,-2109.34 21132.33,-2084.5 21191.54,-2077.73 21254.87,-2069.27 21315,-2060.67"/>
<polygon fill="black" stroke="black" points="21315.61,-2064.12 21325.01,-2059.24 21314.62,-2057.19 21315.61,-2064.12"/>
</g>
<!-- layer4_gate_dp0_tp1_ep9 -->
<g id="node169" class="node">
<title>layer4_gate_dp0_tp1_ep9</title>
<polygon fill="lightgreen" stroke="black" points="22856.63,-2084.5 22221.43,-2084.5 22058.03,-1948.5 22693.22,-1948.5 22856.63,-2084.5"/>
<text text-anchor="middle" x="22457.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="22457.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 77</text>
<text text-anchor="middle" x="22457.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="22457.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep9 -->
<g id="edge169" class="edge">
<title>layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20496.02,-2152.2C20812.61,-2148.6 21456.47,-2135.09 21999.33,-2084.5 22058.92,-2078.95 22122.6,-2070.95 22182.95,-2062.41"/>
<polygon fill="black" stroke="black" points="22183.59,-2065.85 22193,-2060.98 22182.61,-2058.92 22183.59,-2065.85"/>
</g>
<!-- layer4_gate_dp0_tp1_ep10 -->
<g id="node175" class="node">
<title>layer4_gate_dp0_tp1_ep10</title>
<polygon fill="lightgreen" stroke="black" points="23731.63,-2084.5 23096.43,-2084.5 22933.03,-1948.5 23568.22,-1948.5 23731.63,-2084.5"/>
<text text-anchor="middle" x="23332.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="23332.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 78</text>
<text text-anchor="middle" x="23332.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="23332.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep10 -->
<g id="edge175" class="edge">
<title>layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20496.24,-2151.16C21013.24,-2144.53 22406.05,-2123.49 22865.33,-2084.5 22927.79,-2079.2 22994.64,-2071.08 23057.67,-2062.3"/>
<polygon fill="black" stroke="black" points="23058.34,-2065.74 23067.75,-2060.88 23057.36,-2058.81 23058.34,-2065.74"/>
</g>
<!-- layer4_gate_dp0_tp1_ep11 -->
<g id="node181" class="node">
<title>layer4_gate_dp0_tp1_ep11</title>
<polygon fill="lightgreen" stroke="black" points="24610.63,-2084.5 23975.43,-2084.5 23812.03,-1948.5 24447.22,-1948.5 24610.63,-2084.5"/>
<text text-anchor="middle" x="24211.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="24211.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 79</text>
<text text-anchor="middle" x="24211.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="24211.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep11 -->
<g id="edge181" class="edge">
<title>layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20496,-2152.7C21126.87,-2149.62 23103.16,-2136.02 23740.33,-2084.5 23804.11,-2079.34 23872.43,-2071.17 23936.7,-2062.28"/>
<polygon fill="black" stroke="black" points="23937.55,-2065.69 23946.98,-2060.85 23936.59,-2058.76 23937.55,-2065.69"/>
</g>
<!-- layer4_gate_dp0_tp1_ep12 -->
<g id="node187" class="node">
<title>layer4_gate_dp0_tp1_ep12</title>
<polygon fill="lightgreen" stroke="black" points="25491.63,-2084.5 24856.43,-2084.5 24693.03,-1948.5 25328.22,-1948.5 25491.63,-2084.5"/>
<text text-anchor="middle" x="25092.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="25092.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 80</text>
<text text-anchor="middle" x="25092.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="25092.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep12 -->
<g id="edge187" class="edge">
<title>layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20496.11,-2153.62C21227.81,-2153.56 23801.61,-2148.69 24619.33,-2084.5 24683.82,-2079.44 24752.92,-2071.24 24817.83,-2062.29"/>
<polygon fill="black" stroke="black" points="24818.37,-2065.75 24827.79,-2060.9 24817.41,-2058.81 24818.37,-2065.75"/>
</g>
<!-- layer4_gate_dp0_tp1_ep13 -->
<g id="node193" class="node">
<title>layer4_gate_dp0_tp1_ep13</title>
<polygon fill="lightgreen" stroke="black" points="26372.63,-2084.5 25737.43,-2084.5 25574.03,-1948.5 26209.22,-1948.5 26372.63,-2084.5"/>
<text text-anchor="middle" x="25973.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="25973.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 81</text>
<text text-anchor="middle" x="25973.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="25973.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep13 -->
<g id="edge193" class="edge">
<title>layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20496.04,-2152.38C21381.98,-2147.12 24995.45,-2123.45 25500.33,-2084.5 25564.92,-2079.52 25634.14,-2071.34 25699.14,-2062.37"/>
<polygon fill="black" stroke="black" points="25699.69,-2065.83 25709.11,-2060.99 25698.73,-2058.9 25699.69,-2065.83"/>
</g>
<!-- layer4_gate_dp0_tp1_ep14 -->
<g id="node199" class="node">
<title>layer4_gate_dp0_tp1_ep14</title>
<polygon fill="lightgreen" stroke="black" points="27255.63,-2084.5 26620.43,-2084.5 26457.03,-1948.5 27092.22,-1948.5 27255.63,-2084.5"/>
<text text-anchor="middle" x="26856.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="26856.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 82</text>
<text text-anchor="middle" x="26856.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="26856.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep14 -->
<g id="edge199" class="edge">
<title>layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20496.16,-2152.78C21471.79,-2148.99 25784.37,-2129.8 26381.33,-2084.5 26446.49,-2079.55 26516.34,-2071.35 26581.87,-2062.34"/>
<polygon fill="black" stroke="black" points="26582.5,-2065.78 26591.93,-2060.95 26581.54,-2058.85 26582.5,-2065.78"/>
</g>
<!-- layer4_gate_dp0_tp1_ep15 -->
<g id="node205" class="node">
<title>layer4_gate_dp0_tp1_ep15</title>
<polygon fill="lightgreen" stroke="black" points="28138.63,-2084.5 27503.43,-2084.5 27340.03,-1948.5 27975.22,-1948.5 28138.63,-2084.5"/>
<text text-anchor="middle" x="27739.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="27739.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 83</text>
<text text-anchor="middle" x="27739.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="27739.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep15 -->
<g id="edge205" class="edge">
<title>layer4_mla_dp0_tp1&#45;&gt;layer4_gate_dp0_tp1_ep15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20495.94,-2153.08C21554.46,-2150.63 26574.64,-2136.34 27264.33,-2084.5 27329.49,-2079.6 27399.34,-2071.41 27464.88,-2062.41"/>
<polygon fill="black" stroke="black" points="27465.51,-2065.85 27474.93,-2061.01 27464.55,-2058.92 27465.51,-2065.85"/>
</g>
<!-- layer4_gate_dp1_tp0_ep0 -->
<g id="node211" class="node">
<title>layer4_gate_dp1_tp0_ep0</title>
<polygon fill="lightgreen" stroke="black" points="29351.63,-2084.5 28716.43,-2084.5 28553.03,-1948.5 29188.22,-1948.5 29351.63,-2084.5"/>
<text text-anchor="middle" x="28952.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="28952.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 132</text>
<text text-anchor="middle" x="28952.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="28952.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep0 -->
<g id="edge211" class="edge">
<title>layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36190.49,-2152.97C35134.99,-2149.91 30146.2,-2132.97 29460.33,-2084.5 29423.98,-2081.93 29386.25,-2078.47 29348.52,-2074.46"/>
<polygon fill="black" stroke="black" points="29348.73,-2070.97 29338.41,-2073.38 29347.98,-2077.93 29348.73,-2070.97"/>
</g>
<!-- layer4_gate_dp1_tp0_ep1 -->
<g id="node217" class="node">
<title>layer4_gate_dp1_tp0_ep1</title>
<polygon fill="lightgreen" stroke="black" points="30267.63,-2084.5 29632.43,-2084.5 29469.03,-1948.5 30104.22,-1948.5 30267.63,-2084.5"/>
<text text-anchor="middle" x="29868.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="29868.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 133</text>
<text text-anchor="middle" x="29868.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="29868.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep1 -->
<g id="edge217" class="edge">
<title>layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36190.76,-2152.83C35217.7,-2149.3 30921.02,-2131.17 30326.33,-2084.5 30308.08,-2083.07 30289.45,-2081.36 30270.65,-2079.44"/>
<polygon fill="black" stroke="black" points="30270.81,-2075.93 30260.5,-2078.38 30270.08,-2082.9 30270.81,-2075.93"/>
</g>
<!-- layer4_gate_dp1_tp0_ep2 -->
<g id="node223" class="node">
<title>layer4_gate_dp1_tp0_ep2</title>
<polygon fill="lightgreen" stroke="black" points="31133.63,-2084.5 30498.43,-2084.5 30335.03,-1948.5 30970.22,-1948.5 31133.63,-2084.5"/>
<text text-anchor="middle" x="30734.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="30734.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 134</text>
<text text-anchor="middle" x="30734.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="30734.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep2 -->
<g id="edge223" class="edge">
<title>layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36190.63,-2152.54C35302.67,-2147.97 31673.93,-2126.83 31167.33,-2084.5 31158.21,-2083.74 31149,-2082.9 31139.71,-2081.99"/>
<polygon fill="black" stroke="black" points="31139.91,-2078.5 31129.61,-2080.99 31139.21,-2085.46 31139.91,-2078.5"/>
</g>
<!-- layer4_gate_dp1_tp0_ep3 -->
<g id="node229" class="node">
<title>layer4_gate_dp1_tp0_ep3</title>
<polygon fill="lightgreen" stroke="black" points="31974.63,-2084.5 31339.43,-2084.5 31176.03,-1948.5 31811.22,-1948.5 31974.63,-2084.5"/>
<text text-anchor="middle" x="31575.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="31575.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 135</text>
<text text-anchor="middle" x="31575.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="31575.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep3 -->
<g id="edge229" class="edge">
<title>layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36190.69,-2153.51C35458.76,-2153.07 32882.05,-2147.01 32063.33,-2084.5 32034.12,-2082.27 32003.99,-2079.44 31973.71,-2076.2"/>
<polygon fill="black" stroke="black" points="31973.76,-2072.69 31963.44,-2075.09 31973,-2079.65 31973.76,-2072.69"/>
</g>
<!-- layer4_gate_dp1_tp0_ep4 -->
<g id="node235" class="node">
<title>layer4_gate_dp1_tp0_ep4</title>
<polygon fill="lightgreen" stroke="black" points="32870.63,-2084.5 32235.43,-2084.5 32072.03,-1948.5 32707.22,-1948.5 32870.63,-2084.5"/>
<text text-anchor="middle" x="32471.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="32471.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 136</text>
<text text-anchor="middle" x="32471.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="32471.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep4 -->
<g id="edge235" class="edge">
<title>layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36190.63,-2152.39C35563.8,-2148.4 33609.99,-2132.33 32979.33,-2084.5 32942.79,-2081.73 32904.85,-2078.11 32866.92,-2074"/>
<polygon fill="black" stroke="black" points="32867.07,-2070.5 32856.75,-2072.89 32866.31,-2077.45 32867.07,-2070.5"/>
</g>
<!-- layer4_gate_dp1_tp0_ep5 -->
<g id="node241" class="node">
<title>layer4_gate_dp1_tp0_ep5</title>
<polygon fill="lightgreen" stroke="black" points="33786.63,-2084.5 33151.43,-2084.5 32988.03,-1948.5 33623.22,-1948.5 33786.63,-2084.5"/>
<text text-anchor="middle" x="33387.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="33387.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 137</text>
<text text-anchor="middle" x="33387.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="33387.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep5 -->
<g id="edge241" class="edge">
<title>layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36190.38,-2151.18C35676.73,-2144.6 34299.7,-2123.77 33845.33,-2084.5 33826.83,-2082.9 33807.95,-2081.05 33788.89,-2078.99"/>
<polygon fill="black" stroke="black" points="33789.24,-2075.51 33778.91,-2077.9 33788.47,-2082.47 33789.24,-2075.51"/>
</g>
<!-- layer4_gate_dp1_tp0_ep6 -->
<g id="node247" class="node">
<title>layer4_gate_dp1_tp0_ep6</title>
<polygon fill="lightgreen" stroke="black" points="34652.63,-2084.5 34017.43,-2084.5 33854.03,-1948.5 34489.22,-1948.5 34652.63,-2084.5"/>
<text text-anchor="middle" x="34253.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="34253.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 138</text>
<text text-anchor="middle" x="34253.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="34253.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep6 -->
<g id="edge247" class="edge">
<title>layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36190.79,-2152.73C35874.06,-2149.87 35229.48,-2137.37 34686.33,-2084.5 34676.91,-2083.58 34667.4,-2082.6 34657.8,-2081.55"/>
<polygon fill="black" stroke="black" points="34658.1,-2078.06 34647.78,-2080.44 34657.33,-2085.02 34658.1,-2078.06"/>
</g>
<!-- layer4_gate_dp1_tp0_ep7 -->
<g id="node253" class="node">
<title>layer4_gate_dp1_tp0_ep7</title>
<polygon fill="lightgreen" stroke="black" points="35493.63,-2084.5 34858.43,-2084.5 34695.03,-1948.5 35330.22,-1948.5 35493.63,-2084.5"/>
<text text-anchor="middle" x="35094.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="35094.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 139</text>
<text text-anchor="middle" x="35094.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="35094.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep7 -->
<g id="edge253" class="edge">
<title>layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36190.75,-2140.76C36021.73,-2128.92 35771.03,-2109.38 35553.33,-2084.5 35533.73,-2082.26 35513.68,-2079.84 35493.45,-2077.28"/>
<polygon fill="black" stroke="black" points="35493.86,-2073.81 35483.5,-2076.02 35492.98,-2080.75 35493.86,-2073.81"/>
</g>
<!-- layer4_gate_dp1_tp0_ep8 -->
<g id="node259" class="node">
<title>layer4_gate_dp1_tp0_ep8</title>
<polygon fill="lightgreen" stroke="black" points="36360.63,-2084.5 35725.43,-2084.5 35562.03,-1948.5 36197.22,-1948.5 36360.63,-2084.5"/>
<text text-anchor="middle" x="35961.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="35961.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 140</text>
<text text-anchor="middle" x="35961.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="35961.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep8 -->
<g id="edge259" class="edge">
<title>layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36283.17,-2120.49C36251.94,-2110.5 36216.37,-2099.11 36180.55,-2087.65"/>
<polygon fill="black" stroke="black" points="36181.53,-2084.29 36170.94,-2084.58 36179.4,-2090.96 36181.53,-2084.29"/>
</g>
<!-- layer4_gate_dp1_tp0_ep9 -->
<g id="node265" class="node">
<title>layer4_gate_dp1_tp0_ep9</title>
<polygon fill="lightgreen" stroke="black" points="37193.63,-2084.5 36558.43,-2084.5 36395.03,-1948.5 37030.22,-1948.5 37193.63,-2084.5"/>
<text text-anchor="middle" x="36794.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="36794.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 141</text>
<text text-anchor="middle" x="36794.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="36794.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep9 -->
<g id="edge265" class="edge">
<title>layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36485.35,-2120.49C36515.21,-2110.54 36549.19,-2099.21 36583.44,-2087.8"/>
<polygon fill="black" stroke="black" points="36584.72,-2091.06 36593.1,-2084.58 36582.5,-2084.42 36584.72,-2091.06"/>
</g>
<!-- layer4_gate_dp1_tp0_ep10 -->
<g id="node271" class="node">
<title>layer4_gate_dp1_tp0_ep10</title>
<polygon fill="lightgreen" stroke="black" points="38059.63,-2084.5 37424.43,-2084.5 37261.03,-1948.5 37896.22,-1948.5 38059.63,-2084.5"/>
<text text-anchor="middle" x="37660.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="37660.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 142</text>
<text text-anchor="middle" x="37660.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="37660.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep10 -->
<g id="edge271" class="edge">
<title>layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36582.04,-2140.31C36747.55,-2128.35 36990.82,-2108.89 37202.33,-2084.5 37261.22,-2077.71 37324.2,-2069.27 37384.02,-2060.69"/>
<polygon fill="black" stroke="black" points="37384.58,-2064.15 37393.98,-2059.26 37383.58,-2057.22 37384.58,-2064.15"/>
</g>
<!-- layer4_gate_dp1_tp0_ep11 -->
<g id="node277" class="node">
<title>layer4_gate_dp1_tp0_ep11</title>
<polygon fill="lightgreen" stroke="black" points="38933.63,-2084.5 38298.43,-2084.5 38135.03,-1948.5 38770.22,-1948.5 38933.63,-2084.5"/>
<text text-anchor="middle" x="38534.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="38534.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 143</text>
<text text-anchor="middle" x="38534.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="38534.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep11 -->
<g id="edge277" class="edge">
<title>layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36581.96,-2151.93C36896.03,-2147.95 37531.93,-2133.93 38068.33,-2084.5 38130.32,-2078.79 38196.69,-2070.54 38259.33,-2061.78"/>
<polygon fill="black" stroke="black" points="38259.93,-2065.22 38269.35,-2060.36 38258.96,-2058.29 38259.93,-2065.22"/>
</g>
<!-- layer4_gate_dp1_tp0_ep12 -->
<g id="node283" class="node">
<title>layer4_gate_dp1_tp0_ep12</title>
<polygon fill="lightgreen" stroke="black" points="39812.63,-2084.5 39177.43,-2084.5 39014.03,-1948.5 39649.22,-1948.5 39812.63,-2084.5"/>
<text text-anchor="middle" x="39413.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="39413.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 144</text>
<text text-anchor="middle" x="39413.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="39413.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep12 -->
<g id="edge283" class="edge">
<title>layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36582.02,-2151.12C37097.57,-2144.37 38484.78,-2123.09 38942.33,-2084.5 39006,-2079.13 39074.2,-2070.89 39138.38,-2062"/>
<polygon fill="black" stroke="black" points="39139.22,-2065.41 39148.64,-2060.57 39138.25,-2058.48 39139.22,-2065.41"/>
</g>
<!-- layer4_gate_dp1_tp0_ep13 -->
<g id="node289" class="node">
<title>layer4_gate_dp1_tp0_ep13</title>
<polygon fill="lightgreen" stroke="black" points="40693.63,-2084.5 40058.43,-2084.5 39895.03,-1948.5 40530.22,-1948.5 40693.63,-2084.5"/>
<text text-anchor="middle" x="40294.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="40294.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 145</text>
<text text-anchor="middle" x="40294.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="40294.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep13 -->
<g id="edge289" class="edge">
<title>layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36581.99,-2152.68C37212.24,-2149.54 39185.16,-2135.76 39821.33,-2084.5 39885.81,-2079.3 39954.9,-2071.06 40019.81,-2062.1"/>
<polygon fill="black" stroke="black" points="40020.35,-2065.55 40029.78,-2060.71 40019.39,-2058.62 40020.35,-2065.55"/>
</g>
<!-- layer4_gate_dp1_tp0_ep14 -->
<g id="node295" class="node">
<title>layer4_gate_dp1_tp0_ep14</title>
<polygon fill="lightgreen" stroke="black" points="41575.63,-2084.5 40940.43,-2084.5 40777.03,-1948.5 41412.22,-1948.5 41575.63,-2084.5"/>
<text text-anchor="middle" x="41176.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="41176.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 146</text>
<text text-anchor="middle" x="41176.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="41176.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep14 -->
<g id="edge295" class="edge">
<title>layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36581.97,-2153.61C37313.16,-2153.52 39885.17,-2148.53 40702.33,-2084.5 40767.15,-2079.42 40836.62,-2071.19 40901.84,-2062.2"/>
<polygon fill="black" stroke="black" points="40902.43,-2065.66 40911.85,-2060.82 40901.47,-2058.72 40902.43,-2065.66"/>
</g>
<!-- layer4_gate_dp1_tp0_ep15 -->
<g id="node301" class="node">
<title>layer4_gate_dp1_tp0_ep15</title>
<polygon fill="lightgreen" stroke="black" points="42458.63,-2084.5 41823.43,-2084.5 41660.03,-1948.5 42295.22,-1948.5 42458.63,-2084.5"/>
<text text-anchor="middle" x="42059.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="42059.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 147</text>
<text text-anchor="middle" x="42059.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="42059.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep15 -->
<g id="edge301" class="edge">
<title>layer4_mla_dp1_tp0&#45;&gt;layer4_gate_dp1_tp0_ep15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36581.97,-2152.37C37467.57,-2147.08 41079.63,-2123.29 41584.33,-2084.5 41649.49,-2079.49 41719.33,-2071.26 41784.87,-2062.25"/>
<polygon fill="black" stroke="black" points="41785.5,-2065.69 41794.92,-2060.85 41784.54,-2058.76 41785.5,-2065.69"/>
</g>
<!-- layer4_gate_dp1_tp1_ep0 -->
<g id="node307" class="node">
<title>layer4_gate_dp1_tp1_ep0</title>
<polygon fill="lightgreen" stroke="black" points="43440.63,-2084.5 42805.43,-2084.5 42642.03,-1948.5 43277.22,-1948.5 43440.63,-2084.5"/>
<text text-anchor="middle" x="43041.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="43041.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 196</text>
<text text-anchor="middle" x="43041.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="43041.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep0 -->
<g id="edge307" class="edge">
<title>layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48551.53,-2152.36C47663.13,-2146.98 44032.54,-2122.81 43525.33,-2084.5 43497.61,-2082.41 43469.07,-2079.75 43440.35,-2076.71"/>
<polygon fill="black" stroke="black" points="43440.51,-2073.21 43430.19,-2075.62 43439.76,-2080.17 43440.51,-2073.21"/>
</g>
<!-- layer4_gate_dp1_tp1_ep1 -->
<g id="node313" class="node">
<title>layer4_gate_dp1_tp1_ep1</title>
<polygon fill="lightgreen" stroke="black" points="44332.63,-2084.5 43697.43,-2084.5 43534.03,-1948.5 44169.22,-1948.5 44332.63,-2084.5"/>
<text text-anchor="middle" x="43933.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="43933.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 197</text>
<text text-anchor="middle" x="43933.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="43933.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep1 -->
<g id="edge313" class="edge">
<title>layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48551.53,-2153.69C47816.77,-2153.89 45223.75,-2149.84 44400.33,-2084.5 44378.63,-2082.78 44356.41,-2080.69 44334.01,-2078.34"/>
<polygon fill="black" stroke="black" points="44334.37,-2074.86 44324.05,-2077.27 44333.62,-2081.82 44334.37,-2074.86"/>
</g>
<!-- layer4_gate_dp1_tp1_ep2 -->
<g id="node319" class="node">
<title>layer4_gate_dp1_tp1_ep2</title>
<polygon fill="lightgreen" stroke="black" points="45207.63,-2084.5 44572.43,-2084.5 44409.03,-1948.5 45044.22,-1948.5 45207.63,-2084.5"/>
<text text-anchor="middle" x="44808.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="44808.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 198</text>
<text text-anchor="middle" x="44808.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="44808.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep2 -->
<g id="edge319" class="edge">
<title>layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48551.67,-2152.17C47926.14,-2147.5 45979.14,-2129.63 45350.33,-2084.5 45301.56,-2081 45250.46,-2076.19 45199.93,-2070.74"/>
<polygon fill="black" stroke="black" points="45200.15,-2067.25 45189.83,-2069.65 45199.39,-2074.21 45200.15,-2067.25"/>
</g>
<!-- layer4_gate_dp1_tp1_ep3 -->
<g id="node325" class="node">
<title>layer4_gate_dp1_tp1_ep3</title>
<polygon fill="lightgreen" stroke="black" points="46157.63,-2084.5 45522.43,-2084.5 45359.03,-1948.5 45994.22,-1948.5 46157.63,-2084.5"/>
<text text-anchor="middle" x="45758.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="45758.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 199</text>
<text text-anchor="middle" x="45758.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="45758.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep3 -->
<g id="edge325" class="edge">
<title>layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48551.62,-2150.98C48042.01,-2143.97 46682.42,-2122.21 46233.33,-2084.5 46208.69,-2082.43 46183.38,-2079.94 46157.89,-2077.16"/>
<polygon fill="black" stroke="black" points="46158.05,-2073.65 46147.73,-2076.03 46157.28,-2080.61 46158.05,-2073.65"/>
</g>
<!-- layer4_gate_dp1_tp1_ep4 -->
<g id="node331" class="node">
<title>layer4_gate_dp1_tp1_ep4</title>
<polygon fill="lightgreen" stroke="black" points="47040.63,-2084.5 46405.43,-2084.5 46242.03,-1948.5 46877.22,-1948.5 47040.63,-2084.5"/>
<text text-anchor="middle" x="46641.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="46641.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 200</text>
<text text-anchor="middle" x="46641.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="46641.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep4 -->
<g id="edge331" class="edge">
<title>layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48551.72,-2152.31C48240.1,-2148.87 47612.02,-2135.56 47082.33,-2084.5 47070.01,-2083.31 47057.51,-2082.01 47044.9,-2080.62"/>
<polygon fill="black" stroke="black" points="47045.1,-2077.12 47034.77,-2079.48 47044.32,-2084.07 47045.1,-2077.12"/>
</g>
<!-- layer4_gate_dp1_tp1_ep5 -->
<g id="node337" class="node">
<title>layer4_gate_dp1_tp1_ep5</title>
<polygon fill="lightgreen" stroke="black" points="47889.63,-2084.5 47254.43,-2084.5 47091.03,-1948.5 47726.22,-1948.5 47889.63,-2084.5"/>
<text text-anchor="middle" x="47490.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="47490.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 201</text>
<text text-anchor="middle" x="47490.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="47490.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep5 -->
<g id="edge337" class="edge">
<title>layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48551.49,-2141.34C48382.63,-2129.89 48132.44,-2110.58 47915.33,-2084.5 47908.66,-2083.7 47901.94,-2082.87 47895.18,-2082.02"/>
<polygon fill="black" stroke="black" points="47895.6,-2078.55 47885.24,-2080.76 47894.72,-2085.49 47895.6,-2078.55"/>
</g>
<!-- layer4_gate_dp1_tp1_ep6 -->
<g id="node343" class="node">
<title>layer4_gate_dp1_tp1_ep6</title>
<polygon fill="lightgreen" stroke="black" points="48722.63,-2084.5 48087.43,-2084.5 47924.03,-1948.5 48559.22,-1948.5 48722.63,-2084.5"/>
<text text-anchor="middle" x="48323.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="48323.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 202</text>
<text text-anchor="middle" x="48323.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="48323.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep6 -->
<g id="edge343" class="edge">
<title>layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48644.42,-2120.49C48613.25,-2110.5 48577.77,-2099.11 48542.03,-2087.65"/>
<polygon fill="black" stroke="black" points="48543.04,-2084.3 48532.45,-2084.58 48540.9,-2090.96 48543.04,-2084.3"/>
</g>
<!-- layer4_gate_dp1_tp1_ep7 -->
<g id="node349" class="node">
<title>layer4_gate_dp1_tp1_ep7</title>
<polygon fill="lightgreen" stroke="black" points="49571.63,-2084.5 48936.43,-2084.5 48773.03,-1948.5 49408.22,-1948.5 49571.63,-2084.5"/>
<text text-anchor="middle" x="49172.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="49172.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 203</text>
<text text-anchor="middle" x="49172.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="49172.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep7 -->
<g id="edge349" class="edge">
<title>layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48850.48,-2120.49C48881.71,-2110.5 48917.28,-2099.11 48953.11,-2087.65"/>
<polygon fill="black" stroke="black" points="48954.26,-2090.96 48962.71,-2084.58 48952.12,-2084.29 48954.26,-2090.96"/>
</g>
<!-- layer4_gate_dp1_tp1_ep8 -->
<g id="node355" class="node">
<title>layer4_gate_dp1_tp1_ep8</title>
<polygon fill="lightgreen" stroke="black" points="50437.63,-2084.5 49802.43,-2084.5 49639.03,-1948.5 50274.22,-1948.5 50437.63,-2084.5"/>
<text text-anchor="middle" x="50038.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="50038.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 204</text>
<text text-anchor="middle" x="50038.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="50038.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep8 -->
<g id="edge355" class="edge">
<title>layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48942.9,-2140.77C49111.93,-2128.94 49362.63,-2109.41 49580.33,-2084.5 49639.22,-2077.76 49702.21,-2069.34 49762.03,-2060.77"/>
<polygon fill="black" stroke="black" points="49762.59,-2064.22 49771.99,-2059.34 49761.59,-2057.3 49762.59,-2064.22"/>
</g>
<!-- layer4_gate_dp1_tp1_ep9 -->
<g id="node361" class="node">
<title>layer4_gate_dp1_tp1_ep9</title>
<polygon fill="lightgreen" stroke="black" points="51312.63,-2084.5 50677.43,-2084.5 50514.03,-1948.5 51149.22,-1948.5 51312.63,-2084.5"/>
<text text-anchor="middle" x="50913.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="50913.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 205</text>
<text text-anchor="middle" x="50913.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="50913.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep9 -->
<g id="edge361" class="edge">
<title>layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48943,-2152.02C49259.57,-2148.18 49903.4,-2134.34 50446.33,-2084.5 50508.55,-2078.79 50575.17,-2070.53 50638.03,-2061.75"/>
<polygon fill="black" stroke="black" points="50638.67,-2065.19 50648.08,-2060.34 50637.69,-2058.26 50638.67,-2065.19"/>
</g>
<!-- layer4_gate_dp1_tp1_ep10 -->
<g id="node367" class="node">
<title>layer4_gate_dp1_tp1_ep10</title>
<polygon fill="lightgreen" stroke="black" points="52191.63,-2084.5 51556.43,-2084.5 51393.03,-1948.5 52028.22,-1948.5 52191.63,-2084.5"/>
<text text-anchor="middle" x="51792.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="51792.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 206</text>
<text text-anchor="middle" x="51792.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="51792.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep10 -->
<g id="edge367" class="edge">
<title>layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48942.99,-2151.16C49461.04,-2144.5 50860.14,-2123.35 51321.33,-2084.5 51385,-2079.14 51453.2,-2070.89 51517.38,-2062.01"/>
<polygon fill="black" stroke="black" points="51518.22,-2065.42 51527.64,-2060.57 51517.25,-2058.49 51518.22,-2065.42"/>
</g>
<!-- layer4_gate_dp1_tp1_ep11 -->
<g id="node373" class="node">
<title>layer4_gate_dp1_tp1_ep11</title>
<polygon fill="lightgreen" stroke="black" points="53072.63,-2084.5 52437.43,-2084.5 52274.03,-1948.5 52909.22,-1948.5 53072.63,-2084.5"/>
<text text-anchor="middle" x="52673.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="52673.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 207</text>
<text text-anchor="middle" x="52673.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="52673.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep11 -->
<g id="edge373" class="edge">
<title>layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48942.91,-2152.7C49575.25,-2149.63 51560.45,-2136.02 52200.33,-2084.5 52264.81,-2079.31 52333.9,-2071.06 52398.81,-2062.1"/>
<polygon fill="black" stroke="black" points="52399.35,-2065.56 52408.78,-2060.72 52398.39,-2058.63 52399.35,-2065.56"/>
</g>
<!-- layer4_gate_dp1_tp1_ep12 -->
<g id="node379" class="node">
<title>layer4_gate_dp1_tp1_ep12</title>
<polygon fill="lightgreen" stroke="black" points="53954.63,-2084.5 53319.43,-2084.5 53156.03,-1948.5 53791.22,-1948.5 53954.63,-2084.5"/>
<text text-anchor="middle" x="53555.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="53555.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 208</text>
<text text-anchor="middle" x="53555.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="53555.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep12 -->
<g id="edge379" class="edge">
<title>layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48942.84,-2153.62C49675.82,-2153.59 52260.41,-2148.8 53081.33,-2084.5 53146.15,-2079.42 53215.62,-2071.19 53280.84,-2062.21"/>
<polygon fill="black" stroke="black" points="53281.43,-2065.66 53290.85,-2060.82 53280.47,-2058.73 53281.43,-2065.66"/>
</g>
<!-- layer4_gate_dp1_tp1_ep13 -->
<g id="node385" class="node">
<title>layer4_gate_dp1_tp1_ep13</title>
<polygon fill="lightgreen" stroke="black" points="54836.63,-2084.5 54201.43,-2084.5 54038.03,-1948.5 54673.22,-1948.5 54836.63,-2084.5"/>
<text text-anchor="middle" x="54437.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="54437.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 209</text>
<text text-anchor="middle" x="54437.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="54437.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep13 -->
<g id="edge385" class="edge">
<title>layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48942.9,-2152.39C49830.29,-2147.14 53456.75,-2123.49 53963.33,-2084.5 54028.15,-2079.51 54097.63,-2071.31 54162.85,-2062.33"/>
<polygon fill="black" stroke="black" points="54163.44,-2065.79 54172.86,-2060.95 54162.48,-2058.85 54163.44,-2065.79"/>
</g>
<!-- layer4_gate_dp1_tp1_ep14 -->
<g id="node391" class="node">
<title>layer4_gate_dp1_tp1_ep14</title>
<polygon fill="lightgreen" stroke="black" points="55719.63,-2084.5 55084.43,-2084.5 54921.03,-1948.5 55556.22,-1948.5 55719.63,-2084.5"/>
<text text-anchor="middle" x="55320.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="55320.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 210</text>
<text text-anchor="middle" x="55320.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="55320.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep14 -->
<g id="edge391" class="edge">
<title>layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48942.9,-2152.79C49919.68,-2149.03 54246.54,-2129.93 54845.33,-2084.5 54910.49,-2079.56 54980.34,-2071.35 55045.87,-2062.34"/>
<polygon fill="black" stroke="black" points="55046.5,-2065.79 55055.93,-2060.95 55045.54,-2058.85 55046.5,-2065.79"/>
</g>
<!-- layer4_gate_dp1_tp1_ep15 -->
<g id="node397" class="node">
<title>layer4_gate_dp1_tp1_ep15</title>
<polygon fill="lightgreen" stroke="black" points="56602.63,-2084.5 55967.43,-2084.5 55804.03,-1948.5 56439.22,-1948.5 56602.63,-2084.5"/>
<text text-anchor="middle" x="56203.33" y="-2035.3" font-family="Times,serif" font-size="14.00">LAYER4_GATE</text>
<text text-anchor="middle" x="56203.33" y="-2020.3" font-family="Times,serif" font-size="14.00">GPU: 211</text>
<text text-anchor="middle" x="56203.33" y="-2005.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="56203.33" y="-1990.3" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep15 -->
<g id="edge397" class="edge">
<title>layer4_mla_dp1_tp1&#45;&gt;layer4_gate_dp1_tp1_ep15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48942.98,-2153.09C50003.15,-2150.66 55036.86,-2136.46 55728.33,-2084.5 55793.49,-2079.6 55863.34,-2071.41 55928.88,-2062.41"/>
<polygon fill="black" stroke="black" points="55929.51,-2065.85 55938.93,-2061.01 55928.55,-2058.92 55929.51,-2065.85"/>
</g>
<!-- layer4_dispatch_dp0_tp0_ep0 -->
<g id="node20" class="node">
<title>layer4_dispatch_dp0_tp0_ep0</title>
<polygon fill="lightgreen" stroke="black" points="864.48,-1912.5 177.02,-1912.5 0.17,-1776.5 687.63,-1776.5 864.48,-1912.5"/>
<text text-anchor="middle" x="432.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="432.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="432.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="432.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp0_ep0&#45;&gt;layer4_dispatch_dp0_tp0_ep0 -->
<g id="edge20" class="edge">
<title>layer4_gate_dp0_tp0_ep0&#45;&gt;layer4_dispatch_dp0_tp0_ep0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M472.85,-1948.31C469.46,-1939.72 465.98,-1930.88 462.54,-1922.16"/>
<polygon fill="black" stroke="black" points="465.76,-1920.78 458.83,-1912.76 459.24,-1923.34 465.76,-1920.78"/>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep0 -->
<g id="node21" class="node">
<title>layer4_expert_mlp_dp0_tp0_ep0</title>
<polygon fill="lightblue" stroke="black" points="864.83,-1740.5 513.83,-1740.5 513.83,-1672.5 864.83,-1672.5 864.83,-1740.5"/>
<text text-anchor="middle" x="689.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="689.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="689.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="689.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp0_ep0&#45;&gt;layer4_expert_mlp_dp0_tp0_ep0 -->
<g id="edge21" class="edge">
<title>layer4_dispatch_dp0_tp0_ep0&#45;&gt;layer4_expert_mlp_dp0_tp0_ep0</title>
<path fill="none" stroke="black" d="M558.94,-1776.5C579.2,-1765.78 599.51,-1755.03 617.88,-1745.31"/>
<polygon fill="black" stroke="black" points="619.52,-1748.4 626.73,-1740.63 616.25,-1742.21 619.52,-1748.4"/>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep0 -->
<g id="node22" class="node">
<title>layer4_expert_proj_dp0_tp0_ep0</title>
<polygon fill="lightblue" stroke="black" points="1396.83,-1636.5 1045.83,-1636.5 1045.83,-1568.5 1396.83,-1568.5 1396.83,-1636.5"/>
<text text-anchor="middle" x="1221.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="1221.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="1221.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="1221.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep0&#45;&gt;layer4_expert_proj_dp0_tp0_ep0 -->
<g id="edge22" class="edge">
<title>layer4_expert_mlp_dp0_tp0_ep0&#45;&gt;layer4_expert_proj_dp0_tp0_ep0</title>
<path fill="none" stroke="black" d="M861.68,-1672.45C918.34,-1661.59 981.5,-1649.48 1038.89,-1638.48"/>
<polygon fill="black" stroke="black" points="1039.63,-1641.9 1048.79,-1636.58 1038.31,-1635.03 1039.63,-1641.9"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep0 -->
<g id="node23" class="node">
<title>layer4_expert_allreduce_dp0_tp0_ep0</title>
<ellipse fill="lightyellow" stroke="black" cx="2285.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="2285.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="2285.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="2285.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="2285.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep0&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep0 -->
<g id="edge23" class="edge">
<title>layer4_expert_proj_dp0_tp0_ep0&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep0</title>
<path fill="none" stroke="black" d="M1397.02,-1582.33C1578.85,-1562.49 1863.44,-1531.44 2061.32,-1509.86"/>
<polygon fill="black" stroke="black" points="2061.7,-1513.33 2071.26,-1508.77 2060.94,-1506.38 2061.7,-1513.33"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep0 -->
<g id="node24" class="node">
<title>layer4_aggregate_dp0_tp0_ep0</title>
<polygon fill="lightpink" stroke="black" points="2911.27,-1400.33 2329.13,-1400.33 2179.38,-1264.33 2761.52,-1264.33 2911.27,-1400.33"/>
<text text-anchor="middle" x="2545.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="2545.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="2545.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="2545.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep0&#45;&gt;layer4_aggregate_dp0_tp0_ep0 -->
<g id="edge24" class="edge">
<title>layer4_expert_allreduce_dp0_tp0_ep0&#45;&gt;layer4_aggregate_dp0_tp0_ep0</title>
<path fill="none" stroke="black" d="M2362.98,-1438.59C2381.1,-1428.13 2400.85,-1416.73 2420.44,-1405.42"/>
<polygon fill="black" stroke="black" points="2422.21,-1408.44 2429.12,-1400.41 2418.71,-1402.38 2422.21,-1408.44"/>
</g>
<!-- layer61_mla_dp0_tp0 -->
<g id="node403" class="node">
<title>layer61_mla_dp0_tp0</title>
<polygon fill="lightblue" stroke="black" points="11115.83,-1228.33 10724.83,-1228.33 10724.83,-1160.33 11115.83,-1160.33 11115.83,-1228.33"/>
<text text-anchor="middle" x="10920.33" y="-1213.13" font-family="Times,serif" font-size="14.00">LAYER61_MLA</text>
<text text-anchor="middle" x="10920.33" y="-1198.13" font-family="Times,serif" font-size="14.00">GPU: 48</text>
<text text-anchor="middle" x="10920.33" y="-1183.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="10920.33" y="-1168.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, heads=64, d_k=56]</text>
</g>
<!-- layer4_aggregate_dp0_tp0_ep0&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge403" class="edge">
<title>layer4_aggregate_dp0_tp0_ep0&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M2782.06,-1282.82C2827.75,-1275.22 2875.38,-1268.51 2920.33,-1264.33 3715.58,-1190.39 9539.96,-1193.62 10714.32,-1195.04"/>
<polygon fill="black" stroke="black" points="10714.54,-1198.54 10724.55,-1195.05 10714.55,-1191.54 10714.54,-1198.54"/>
</g>
<!-- layer61_mla_dp0_tp1 -->
<g id="node404" class="node">
<title>layer61_mla_dp0_tp1</title>
<polygon fill="lightblue" stroke="black" points="17669.83,-1228.33 17278.83,-1228.33 17278.83,-1160.33 17669.83,-1160.33 17669.83,-1228.33"/>
<text text-anchor="middle" x="17474.33" y="-1213.13" font-family="Times,serif" font-size="14.00">LAYER61_MLA</text>
<text text-anchor="middle" x="17474.33" y="-1198.13" font-family="Times,serif" font-size="14.00">GPU: 112</text>
<text text-anchor="middle" x="17474.33" y="-1183.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="17474.33" y="-1168.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, heads=64, d_k=56]</text>
</g>
<!-- layer4_aggregate_dp0_tp0_ep0&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge435" class="edge">
<title>layer4_aggregate_dp0_tp0_ep0&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M2781.79,-1282.71C2827.56,-1275.11 2875.29,-1268.42 2920.33,-1264.33 3374.24,-1223.1 10668.55,-1230.52 11124.33,-1228.33 13541.37,-1216.75 16475.92,-1200.8 17268.71,-1196.46"/>
<polygon fill="black" stroke="black" points="17268.82,-1199.96 17278.8,-1196.41 17268.78,-1192.96 17268.82,-1199.96"/>
</g>
<!-- layer4_dispatch_dp0_tp0_ep1 -->
<g id="node26" class="node">
<title>layer4_dispatch_dp0_tp0_ep1</title>
<polygon fill="lightgreen" stroke="black" points="1747.48,-1912.5 1060.02,-1912.5 883.17,-1776.5 1570.63,-1776.5 1747.48,-1912.5"/>
<text text-anchor="middle" x="1315.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="1315.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1315.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="1315.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp0_ep1&#45;&gt;layer4_dispatch_dp0_tp0_ep1 -->
<g id="edge26" class="edge">
<title>layer4_gate_dp0_tp0_ep1&#45;&gt;layer4_dispatch_dp0_tp0_ep1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1335.28,-1948.31C1333.65,-1939.91 1331.97,-1931.26 1330.32,-1922.72"/>
<polygon fill="black" stroke="black" points="1333.72,-1921.91 1328.38,-1912.76 1326.85,-1923.24 1333.72,-1921.91"/>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep1 -->
<g id="node27" class="node">
<title>layer4_expert_mlp_dp0_tp0_ep1</title>
<polygon fill="lightblue" stroke="black" points="1747.83,-1740.5 1396.83,-1740.5 1396.83,-1672.5 1747.83,-1672.5 1747.83,-1740.5"/>
<text text-anchor="middle" x="1572.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="1572.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1572.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="1572.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp0_ep1&#45;&gt;layer4_expert_mlp_dp0_tp0_ep1 -->
<g id="edge27" class="edge">
<title>layer4_dispatch_dp0_tp0_ep1&#45;&gt;layer4_expert_mlp_dp0_tp0_ep1</title>
<path fill="none" stroke="black" d="M1441.94,-1776.5C1462.2,-1765.78 1482.51,-1755.03 1500.88,-1745.31"/>
<polygon fill="black" stroke="black" points="1502.52,-1748.4 1509.73,-1740.63 1499.25,-1742.21 1502.52,-1748.4"/>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep1 -->
<g id="node28" class="node">
<title>layer4_expert_proj_dp0_tp0_ep1</title>
<polygon fill="lightblue" stroke="black" points="2355.83,-1636.5 2004.83,-1636.5 2004.83,-1568.5 2355.83,-1568.5 2355.83,-1636.5"/>
<text text-anchor="middle" x="2180.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="2180.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="2180.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="2180.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep1&#45;&gt;layer4_expert_proj_dp0_tp0_ep1 -->
<g id="edge28" class="edge">
<title>layer4_expert_mlp_dp0_tp0_ep1&#45;&gt;layer4_expert_proj_dp0_tp0_ep1</title>
<path fill="none" stroke="black" d="M1748.18,-1676C1825.46,-1663.03 1916.25,-1647.8 1994.61,-1634.66"/>
<polygon fill="black" stroke="black" points="1995.32,-1638.09 2004.6,-1632.98 1994.16,-1631.18 1995.32,-1638.09"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep1 -->
<g id="node29" class="node">
<title>layer4_expert_allreduce_dp0_tp0_ep1</title>
<ellipse fill="lightyellow" stroke="black" cx="3040.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="3040.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="3040.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="3040.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="3040.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep1&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep1 -->
<g id="edge29" class="edge">
<title>layer4_expert_proj_dp0_tp0_ep1&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep1</title>
<path fill="none" stroke="black" d="M2355.92,-1577.8C2492.9,-1559.31 2683.68,-1533.56 2829.02,-1513.94"/>
<polygon fill="black" stroke="black" points="2829.53,-1517.4 2838.97,-1512.6 2828.59,-1510.46 2829.53,-1517.4"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep1 -->
<g id="node30" class="node">
<title>layer4_aggregate_dp0_tp0_ep1</title>
<polygon fill="lightpink" stroke="black" points="3661.27,-1400.33 3079.13,-1400.33 2929.38,-1264.33 3511.52,-1264.33 3661.27,-1400.33"/>
<text text-anchor="middle" x="3295.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="3295.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="3295.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="3295.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep1&#45;&gt;layer4_aggregate_dp0_tp0_ep1 -->
<g id="edge30" class="edge">
<title>layer4_expert_allreduce_dp0_tp0_ep1&#45;&gt;layer4_aggregate_dp0_tp0_ep1</title>
<path fill="none" stroke="black" d="M3116.49,-1438.59C3134.18,-1428.18 3153.45,-1416.83 3172.58,-1405.58"/>
<polygon fill="black" stroke="black" points="3174.51,-1408.5 3181.35,-1400.41 3170.96,-1402.47 3174.51,-1408.5"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep1&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge404" class="edge">
<title>layer4_aggregate_dp0_tp0_ep1&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M3532.06,-1282.86C3577.75,-1275.25 3625.38,-1268.53 3670.33,-1264.33 4386.81,-1197.39 9608.17,-1194.99 10714.65,-1195.24"/>
<polygon fill="black" stroke="black" points="10714.69,-1198.74 10724.69,-1195.24 10714.7,-1191.74 10714.69,-1198.74"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep1&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge436" class="edge">
<title>layer4_aggregate_dp0_tp0_ep1&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M3531.79,-1282.73C3577.56,-1275.12 3625.29,-1268.43 3670.33,-1264.33 4082.74,-1226.78 10710.22,-1230.41 11124.33,-1228.33 13541.37,-1216.22 16475.92,-1200.65 17268.71,-1196.43"/>
<polygon fill="black" stroke="black" points="17268.82,-1199.93 17278.8,-1196.38 17268.78,-1192.93 17268.82,-1199.93"/>
</g>
<!-- layer4_dispatch_dp0_tp0_ep2 -->
<g id="node32" class="node">
<title>layer4_dispatch_dp0_tp0_ep2</title>
<polygon fill="lightgreen" stroke="black" points="2630.48,-1912.5 1943.02,-1912.5 1766.17,-1776.5 2453.63,-1776.5 2630.48,-1912.5"/>
<text text-anchor="middle" x="2198.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="2198.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="2198.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="2198.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp0_ep2&#45;&gt;layer4_dispatch_dp0_tp0_ep2 -->
<g id="edge32" class="edge">
<title>layer4_gate_dp0_tp0_ep2&#45;&gt;layer4_dispatch_dp0_tp0_ep2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2218.28,-1948.31C2216.65,-1939.91 2214.97,-1931.26 2213.32,-1922.72"/>
<polygon fill="black" stroke="black" points="2216.72,-1921.91 2211.38,-1912.76 2209.85,-1923.24 2216.72,-1921.91"/>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep2 -->
<g id="node33" class="node">
<title>layer4_expert_mlp_dp0_tp0_ep2</title>
<polygon fill="lightblue" stroke="black" points="2630.83,-1740.5 2279.83,-1740.5 2279.83,-1672.5 2630.83,-1672.5 2630.83,-1740.5"/>
<text text-anchor="middle" x="2455.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="2455.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="2455.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="2455.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp0_ep2&#45;&gt;layer4_expert_mlp_dp0_tp0_ep2 -->
<g id="edge33" class="edge">
<title>layer4_dispatch_dp0_tp0_ep2&#45;&gt;layer4_expert_mlp_dp0_tp0_ep2</title>
<path fill="none" stroke="black" d="M2324.94,-1776.5C2345.2,-1765.78 2365.51,-1755.03 2383.88,-1745.31"/>
<polygon fill="black" stroke="black" points="2385.52,-1748.4 2392.73,-1740.63 2382.25,-1742.21 2385.52,-1748.4"/>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep2 -->
<g id="node34" class="node">
<title>layer4_expert_proj_dp0_tp0_ep2</title>
<polygon fill="lightblue" stroke="black" points="3472.83,-1636.5 3121.83,-1636.5 3121.83,-1568.5 3472.83,-1568.5 3472.83,-1636.5"/>
<text text-anchor="middle" x="3297.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="3297.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="3297.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="3297.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep2&#45;&gt;layer4_expert_proj_dp0_tp0_ep2 -->
<g id="edge34" class="edge">
<title>layer4_expert_mlp_dp0_tp0_ep2&#45;&gt;layer4_expert_proj_dp0_tp0_ep2</title>
<path fill="none" stroke="black" d="M2631.07,-1684.21C2771.7,-1667.17 2968.39,-1643.35 3111.59,-1626"/>
<polygon fill="black" stroke="black" points="3112.3,-1629.44 3121.81,-1624.76 3111.46,-1622.49 3112.3,-1629.44"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep2 -->
<g id="node35" class="node">
<title>layer4_expert_allreduce_dp0_tp0_ep2</title>
<ellipse fill="lightyellow" stroke="black" cx="3799.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="3799.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="3799.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="3799.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="3799.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep2&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep2 -->
<g id="edge35" class="edge">
<title>layer4_expert_proj_dp0_tp0_ep2&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep2</title>
<path fill="none" stroke="black" d="M3440.17,-1568.47C3500.01,-1554.63 3569.99,-1538.45 3632.2,-1524.06"/>
<polygon fill="black" stroke="black" points="3633.16,-1527.43 3642.11,-1521.77 3631.58,-1520.61 3633.16,-1527.43"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep2 -->
<g id="node36" class="node">
<title>layer4_aggregate_dp0_tp0_ep2</title>
<polygon fill="lightpink" stroke="black" points="4411.27,-1400.33 3829.13,-1400.33 3679.38,-1264.33 4261.52,-1264.33 4411.27,-1400.33"/>
<text text-anchor="middle" x="4045.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="4045.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="4045.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="4045.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep2&#45;&gt;layer4_aggregate_dp0_tp0_ep2 -->
<g id="edge36" class="edge">
<title>layer4_expert_allreduce_dp0_tp0_ep2&#45;&gt;layer4_aggregate_dp0_tp0_ep2</title>
<path fill="none" stroke="black" d="M3873.13,-1438.39C3889.92,-1428.15 3908.17,-1417.01 3926.3,-1405.95"/>
<polygon fill="black" stroke="black" points="3928.47,-1408.73 3935.18,-1400.53 3924.82,-1402.75 3928.47,-1408.73"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep2&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge405" class="edge">
<title>layer4_aggregate_dp0_tp0_ep2&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M4282.06,-1282.9C4327.76,-1275.29 4375.39,-1268.56 4420.33,-1264.33 5058.13,-1204.39 9678.05,-1196.5 10714.38,-1195.48"/>
<polygon fill="black" stroke="black" points="10714.55,-1198.98 10724.54,-1195.47 10714.54,-1191.98 10714.55,-1198.98"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep2&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge437" class="edge">
<title>layer4_aggregate_dp0_tp0_ep2&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M4281.79,-1282.74C4327.56,-1275.14 4375.29,-1268.44 4420.33,-1264.33 4430.77,-1263.38 15604.87,-1205.08 17268.29,-1196.41"/>
<polygon fill="black" stroke="black" points="17268.56,-1199.91 17278.54,-1196.35 17268.53,-1192.91 17268.56,-1199.91"/>
</g>
<!-- layer4_dispatch_dp0_tp0_ep3 -->
<g id="node38" class="node">
<title>layer4_dispatch_dp0_tp0_ep3</title>
<polygon fill="lightgreen" stroke="black" points="3513.48,-1912.5 2826.02,-1912.5 2649.17,-1776.5 3336.63,-1776.5 3513.48,-1912.5"/>
<text text-anchor="middle" x="3081.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="3081.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="3081.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="3081.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp0_ep3&#45;&gt;layer4_dispatch_dp0_tp0_ep3 -->
<g id="edge38" class="edge">
<title>layer4_gate_dp0_tp0_ep3&#45;&gt;layer4_dispatch_dp0_tp0_ep3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3101.28,-1948.31C3099.65,-1939.91 3097.97,-1931.26 3096.32,-1922.72"/>
<polygon fill="black" stroke="black" points="3099.72,-1921.91 3094.38,-1912.76 3092.85,-1923.24 3099.72,-1921.91"/>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep3 -->
<g id="node39" class="node">
<title>layer4_expert_mlp_dp0_tp0_ep3</title>
<polygon fill="lightblue" stroke="black" points="3513.83,-1740.5 3162.83,-1740.5 3162.83,-1672.5 3513.83,-1672.5 3513.83,-1740.5"/>
<text text-anchor="middle" x="3338.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="3338.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="3338.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="3338.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp0_ep3&#45;&gt;layer4_expert_mlp_dp0_tp0_ep3 -->
<g id="edge39" class="edge">
<title>layer4_dispatch_dp0_tp0_ep3&#45;&gt;layer4_expert_mlp_dp0_tp0_ep3</title>
<path fill="none" stroke="black" d="M3207.94,-1776.5C3228.2,-1765.78 3248.51,-1755.03 3266.88,-1745.31"/>
<polygon fill="black" stroke="black" points="3268.52,-1748.4 3275.73,-1740.63 3265.25,-1742.21 3268.52,-1748.4"/>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep3 -->
<g id="node40" class="node">
<title>layer4_expert_proj_dp0_tp0_ep3</title>
<polygon fill="lightblue" stroke="black" points="4368.83,-1636.5 4017.83,-1636.5 4017.83,-1568.5 4368.83,-1568.5 4368.83,-1636.5"/>
<text text-anchor="middle" x="4193.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="4193.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="4193.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="4193.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep3&#45;&gt;layer4_expert_proj_dp0_tp0_ep3 -->
<g id="edge40" class="edge">
<title>layer4_expert_mlp_dp0_tp0_ep3&#45;&gt;layer4_expert_proj_dp0_tp0_ep3</title>
<path fill="none" stroke="black" d="M3513.93,-1684.55C3657.84,-1667.38 3860.96,-1643.15 4007.57,-1625.66"/>
<polygon fill="black" stroke="black" points="4008.07,-1629.12 4017.59,-1624.46 4007.24,-1622.17 4008.07,-1629.12"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep3 -->
<g id="node41" class="node">
<title>layer4_expert_allreduce_dp0_tp0_ep3</title>
<ellipse fill="lightyellow" stroke="black" cx="4618.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="4618.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="4618.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="4618.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="4618.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep3&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep3 -->
<g id="edge41" class="edge">
<title>layer4_expert_proj_dp0_tp0_ep3&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep3</title>
<path fill="none" stroke="black" d="M4314.26,-1568.47C4361.76,-1555.49 4416.82,-1540.46 4466.92,-1526.77"/>
<polygon fill="black" stroke="black" points="4468.14,-1530.06 4476.87,-1524.05 4466.3,-1523.31 4468.14,-1530.06"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep3 -->
<g id="node42" class="node">
<title>layer4_aggregate_dp0_tp0_ep3</title>
<polygon fill="lightpink" stroke="black" points="5161.27,-1400.33 4579.13,-1400.33 4429.38,-1264.33 5011.52,-1264.33 5161.27,-1400.33"/>
<text text-anchor="middle" x="4795.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="4795.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="4795.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="4795.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep3&#45;&gt;layer4_aggregate_dp0_tp0_ep3 -->
<g id="edge42" class="edge">
<title>layer4_expert_allreduce_dp0_tp0_ep3&#45;&gt;layer4_aggregate_dp0_tp0_ep3</title>
<path fill="none" stroke="black" d="M4672.88,-1437.16C4684.12,-1427.62 4696.24,-1417.35 4708.31,-1407.12"/>
<polygon fill="black" stroke="black" points="4710.87,-1409.54 4716.23,-1400.4 4706.34,-1404.2 4710.87,-1409.54"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep3&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge406" class="edge">
<title>layer4_aggregate_dp0_tp0_ep3&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M5032.07,-1282.95C5077.76,-1275.34 5125.39,-1268.59 5170.33,-1264.33 5729.81,-1211.36 9753.49,-1198.19 10714.56,-1195.79"/>
<polygon fill="black" stroke="black" points="10714.69,-1199.29 10724.68,-1195.76 10714.68,-1192.29 10714.69,-1199.29"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep3&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge438" class="edge">
<title>layer4_aggregate_dp0_tp0_ep3&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M5032.05,-1282.71C5077.74,-1275.13 5125.38,-1268.44 5170.33,-1264.33 5209.6,-1260.74 15662.91,-1204.97 17268.42,-1196.43"/>
<polygon fill="black" stroke="black" points="17268.63,-1199.93 17278.61,-1196.37 17268.59,-1192.93 17268.63,-1199.93"/>
</g>
<!-- layer4_dispatch_dp0_tp0_ep4 -->
<g id="node44" class="node">
<title>layer4_dispatch_dp0_tp0_ep4</title>
<polygon fill="lightgreen" stroke="black" points="4396.48,-1912.5 3709.02,-1912.5 3532.17,-1776.5 4219.63,-1776.5 4396.48,-1912.5"/>
<text text-anchor="middle" x="3964.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="3964.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="3964.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="3964.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp0_ep4&#45;&gt;layer4_dispatch_dp0_tp0_ep4 -->
<g id="edge44" class="edge">
<title>layer4_gate_dp0_tp0_ep4&#45;&gt;layer4_dispatch_dp0_tp0_ep4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3984.28,-1948.31C3982.65,-1939.91 3980.97,-1931.26 3979.32,-1922.72"/>
<polygon fill="black" stroke="black" points="3982.72,-1921.91 3977.38,-1912.76 3975.85,-1923.24 3982.72,-1921.91"/>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep4 -->
<g id="node45" class="node">
<title>layer4_expert_mlp_dp0_tp0_ep4</title>
<polygon fill="lightblue" stroke="black" points="4511.83,-1740.5 4160.83,-1740.5 4160.83,-1672.5 4511.83,-1672.5 4511.83,-1740.5"/>
<text text-anchor="middle" x="4336.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="4336.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="4336.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="4336.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp0_ep4&#45;&gt;layer4_expert_mlp_dp0_tp0_ep4 -->
<g id="edge45" class="edge">
<title>layer4_dispatch_dp0_tp0_ep4&#45;&gt;layer4_expert_mlp_dp0_tp0_ep4</title>
<path fill="none" stroke="black" d="M4147.6,-1776.5C4178.12,-1765.34 4208.73,-1754.15 4236.15,-1744.12"/>
<polygon fill="black" stroke="black" points="4237.52,-1747.35 4245.71,-1740.63 4235.12,-1740.77 4237.52,-1747.35"/>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep4 -->
<g id="node46" class="node">
<title>layer4_expert_proj_dp0_tp0_ep4</title>
<polygon fill="lightblue" stroke="black" points="5022.83,-1636.5 4671.83,-1636.5 4671.83,-1568.5 5022.83,-1568.5 5022.83,-1636.5"/>
<text text-anchor="middle" x="4847.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="4847.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="4847.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="4847.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep4&#45;&gt;layer4_expert_proj_dp0_tp0_ep4 -->
<g id="edge46" class="edge">
<title>layer4_expert_mlp_dp0_tp0_ep4&#45;&gt;layer4_expert_proj_dp0_tp0_ep4</title>
<path fill="none" stroke="black" d="M4501.88,-1672.45C4556.19,-1661.61 4616.72,-1649.53 4671.75,-1638.55"/>
<polygon fill="black" stroke="black" points="4672.48,-1641.97 4681.6,-1636.58 4671.11,-1635.11 4672.48,-1641.97"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep4 -->
<g id="node47" class="node">
<title>layer4_expert_allreduce_dp0_tp0_ep4</title>
<ellipse fill="lightyellow" stroke="black" cx="5338.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="5338.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="5338.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="5338.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="5338.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep4&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep4 -->
<g id="edge47" class="edge">
<title>layer4_expert_proj_dp0_tp0_ep4&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep4</title>
<path fill="none" stroke="black" d="M4987.04,-1568.47C5045.05,-1554.75 5112.79,-1538.74 5173.23,-1524.45"/>
<polygon fill="black" stroke="black" points="5174.32,-1527.79 5183.25,-1522.08 5172.71,-1520.97 5174.32,-1527.79"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep4 -->
<g id="node48" class="node">
<title>layer4_aggregate_dp0_tp0_ep4</title>
<polygon fill="lightpink" stroke="black" points="5911.27,-1400.33 5329.13,-1400.33 5179.38,-1264.33 5761.52,-1264.33 5911.27,-1400.33"/>
<text text-anchor="middle" x="5545.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="5545.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="5545.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="5545.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep4&#45;&gt;layer4_aggregate_dp0_tp0_ep4 -->
<g id="edge48" class="edge">
<title>layer4_expert_allreduce_dp0_tp0_ep4&#45;&gt;layer4_aggregate_dp0_tp0_ep4</title>
<path fill="none" stroke="black" d="M5401.28,-1437.78C5414.93,-1427.88 5429.69,-1417.17 5444.39,-1406.52"/>
<polygon fill="black" stroke="black" points="5446.5,-1409.31 5452.54,-1400.61 5442.39,-1403.64 5446.5,-1409.31"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep4&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge407" class="edge">
<title>layer4_aggregate_dp0_tp0_ep4&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M5782.32,-1282.97C5827.94,-1275.37 5875.48,-1268.62 5920.33,-1264.33 6401.71,-1218.32 9832.82,-1200.13 10714.31,-1196.19"/>
<polygon fill="black" stroke="black" points="10714.57,-1199.69 10724.56,-1196.15 10714.54,-1192.69 10714.57,-1199.69"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep4&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge439" class="edge">
<title>layer4_aggregate_dp0_tp0_ep4&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M5782.05,-1282.73C5827.74,-1275.14 5875.38,-1268.45 5920.33,-1264.33 5993.88,-1257.59 15723.65,-1204.79 17268.66,-1196.44"/>
<polygon fill="black" stroke="black" points="17268.77,-1199.94 17278.75,-1196.39 17268.73,-1192.94 17268.77,-1199.94"/>
</g>
<!-- layer4_dispatch_dp0_tp0_ep5 -->
<g id="node50" class="node">
<title>layer4_dispatch_dp0_tp0_ep5</title>
<polygon fill="lightgreen" stroke="black" points="5279.48,-1912.5 4592.02,-1912.5 4415.17,-1776.5 5102.63,-1776.5 5279.48,-1912.5"/>
<text text-anchor="middle" x="4847.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="4847.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="4847.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="4847.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp0_ep5&#45;&gt;layer4_dispatch_dp0_tp0_ep5 -->
<g id="edge50" class="edge">
<title>layer4_gate_dp0_tp0_ep5&#45;&gt;layer4_dispatch_dp0_tp0_ep5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4877.56,-1948.31C4875.07,-1939.81 4872.49,-1931.07 4869.95,-1922.44"/>
<polygon fill="black" stroke="black" points="4873.29,-1921.36 4867.11,-1912.76 4866.57,-1923.34 4873.29,-1921.36"/>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep5 -->
<g id="node51" class="node">
<title>layer4_expert_mlp_dp0_tp0_ep5</title>
<polygon fill="lightblue" stroke="black" points="5246.83,-1740.5 4895.83,-1740.5 4895.83,-1672.5 5246.83,-1672.5 5246.83,-1740.5"/>
<text text-anchor="middle" x="5071.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="5071.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="5071.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="5071.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp0_ep5&#45;&gt;layer4_expert_mlp_dp0_tp0_ep5 -->
<g id="edge51" class="edge">
<title>layer4_dispatch_dp0_tp0_ep5&#45;&gt;layer4_expert_mlp_dp0_tp0_ep5</title>
<path fill="none" stroke="black" d="M4957.69,-1776.5C4975.02,-1765.97 4992.4,-1755.42 5008.18,-1745.84"/>
<polygon fill="black" stroke="black" points="5010.03,-1748.81 5016.76,-1740.63 5006.4,-1742.82 5010.03,-1748.81"/>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep5 -->
<g id="node52" class="node">
<title>layer4_expert_proj_dp0_tp0_ep5</title>
<polygon fill="lightblue" stroke="black" points="5601.83,-1636.5 5250.83,-1636.5 5250.83,-1568.5 5601.83,-1568.5 5601.83,-1636.5"/>
<text text-anchor="middle" x="5426.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="5426.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="5426.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="5426.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep5&#45;&gt;layer4_expert_proj_dp0_tp0_ep5 -->
<g id="edge52" class="edge">
<title>layer4_expert_mlp_dp0_tp0_ep5&#45;&gt;layer4_expert_proj_dp0_tp0_ep5</title>
<path fill="none" stroke="black" d="M5186.58,-1672.38C5223.29,-1661.84 5264.06,-1650.12 5301.42,-1639.39"/>
<polygon fill="black" stroke="black" points="5302.7,-1642.66 5311.34,-1636.54 5300.76,-1635.93 5302.7,-1642.66"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep5 -->
<g id="node53" class="node">
<title>layer4_expert_allreduce_dp0_tp0_ep5</title>
<ellipse fill="lightyellow" stroke="black" cx="6159.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="6159.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="6159.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="6159.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="6159.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep5&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep5 -->
<g id="edge53" class="edge">
<title>layer4_expert_proj_dp0_tp0_ep5&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep5</title>
<path fill="none" stroke="black" d="M5601.9,-1573.69C5709.51,-1556.65 5847.59,-1534.78 5959.4,-1517.08"/>
<polygon fill="black" stroke="black" points="5960.12,-1520.51 5969.45,-1515.49 5959.03,-1513.59 5960.12,-1520.51"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep5 -->
<g id="node54" class="node">
<title>layer4_aggregate_dp0_tp0_ep5</title>
<polygon fill="lightpink" stroke="black" points="6661.27,-1400.33 6079.13,-1400.33 5929.38,-1264.33 6511.52,-1264.33 6661.27,-1400.33"/>
<text text-anchor="middle" x="6295.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="6295.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="6295.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="6295.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep5&#45;&gt;layer4_aggregate_dp0_tp0_ep5 -->
<g id="edge54" class="edge">
<title>layer4_expert_allreduce_dp0_tp0_ep5&#45;&gt;layer4_aggregate_dp0_tp0_ep5</title>
<path fill="none" stroke="black" d="M6201.61,-1436.75C6209.94,-1427.56 6218.87,-1417.71 6227.79,-1407.87"/>
<polygon fill="black" stroke="black" points="6230.47,-1410.11 6234.59,-1400.35 6225.29,-1405.41 6230.47,-1410.11"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep5&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge408" class="edge">
<title>layer4_aggregate_dp0_tp0_ep5&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M6532.33,-1283.06C6577.95,-1275.45 6625.48,-1268.67 6670.33,-1264.33 7074.07,-1225.24 9919.29,-1202.4 10714.38,-1196.73"/>
<polygon fill="black" stroke="black" points="10714.52,-1200.23 10724.5,-1196.66 10714.47,-1193.23 10714.52,-1200.23"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep5&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge440" class="edge">
<title>layer4_aggregate_dp0_tp0_ep5&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M6532.05,-1282.74C6577.74,-1275.15 6625.38,-1268.46 6670.33,-1264.33 6807.43,-1251.74 15787.51,-1204.17 17268.58,-1196.41"/>
<polygon fill="black" stroke="black" points="17268.8,-1199.91 17278.78,-1196.35 17268.77,-1192.91 17268.8,-1199.91"/>
</g>
<!-- layer4_dispatch_dp0_tp0_ep6 -->
<g id="node56" class="node">
<title>layer4_dispatch_dp0_tp0_ep6</title>
<polygon fill="lightgreen" stroke="black" points="6162.48,-1912.5 5475.02,-1912.5 5298.17,-1776.5 5985.63,-1776.5 6162.48,-1912.5"/>
<text text-anchor="middle" x="5730.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="5730.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="5730.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="5730.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp0_ep6&#45;&gt;layer4_dispatch_dp0_tp0_ep6 -->
<g id="edge56" class="edge">
<title>layer4_gate_dp0_tp0_ep6&#45;&gt;layer4_dispatch_dp0_tp0_ep6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5761.17,-1948.31C5758.62,-1939.81 5756,-1931.07 5753.41,-1922.44"/>
<polygon fill="black" stroke="black" points="5756.73,-1921.33 5750.5,-1912.76 5750.02,-1923.34 5756.73,-1921.33"/>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep6 -->
<g id="node57" class="node">
<title>layer4_expert_mlp_dp0_tp0_ep6</title>
<polygon fill="lightblue" stroke="black" points="6068.83,-1740.5 5717.83,-1740.5 5717.83,-1672.5 6068.83,-1672.5 6068.83,-1740.5"/>
<text text-anchor="middle" x="5893.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="5893.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="5893.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="5893.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp0_ep6&#45;&gt;layer4_expert_mlp_dp0_tp0_ep6 -->
<g id="edge57" class="edge">
<title>layer4_dispatch_dp0_tp0_ep6&#45;&gt;layer4_expert_mlp_dp0_tp0_ep6</title>
<path fill="none" stroke="black" d="M5810.87,-1776.3C5822.88,-1766.28 5834.91,-1756.24 5845.93,-1747.05"/>
<polygon fill="black" stroke="black" points="5848.32,-1749.61 5853.75,-1740.52 5843.83,-1744.24 5848.32,-1749.61"/>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep6 -->
<g id="node58" class="node">
<title>layer4_expert_proj_dp0_tp0_ep6</title>
<polygon fill="lightblue" stroke="black" points="6888.83,-1636.5 6537.83,-1636.5 6537.83,-1568.5 6888.83,-1568.5 6888.83,-1636.5"/>
<text text-anchor="middle" x="6713.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="6713.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="6713.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="6713.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep6&#45;&gt;layer4_expert_proj_dp0_tp0_ep6 -->
<g id="edge58" class="edge">
<title>layer4_expert_mlp_dp0_tp0_ep6&#45;&gt;layer4_expert_proj_dp0_tp0_ep6</title>
<path fill="none" stroke="black" d="M6068.99,-1683.65C6203.94,-1666.86 6389.91,-1643.73 6527.37,-1626.63"/>
<polygon fill="black" stroke="black" points="6528.11,-1630.07 6537.6,-1625.36 6527.24,-1623.12 6528.11,-1630.07"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep6 -->
<g id="node59" class="node">
<title>layer4_expert_allreduce_dp0_tp0_ep6</title>
<ellipse fill="lightyellow" stroke="black" cx="6746.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="6746.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="6746.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="6746.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="6746.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep6&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep6 -->
<g id="edge59" class="edge">
<title>layer4_expert_proj_dp0_tp0_ep6&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep6</title>
<path fill="none" stroke="black" d="M6722.78,-1568.23C6725.1,-1560.07 6727.66,-1551.09 6730.19,-1542.16"/>
<polygon fill="black" stroke="black" points="6733.57,-1543.1 6732.93,-1532.53 6726.83,-1541.19 6733.57,-1543.1"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep6 -->
<g id="node60" class="node">
<title>layer4_aggregate_dp0_tp0_ep6</title>
<polygon fill="lightpink" stroke="black" points="7411.27,-1400.33 6829.13,-1400.33 6679.38,-1264.33 7261.52,-1264.33 7411.27,-1400.33"/>
<text text-anchor="middle" x="7045.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="7045.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="7045.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="7045.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep6&#45;&gt;layer4_aggregate_dp0_tp0_ep6 -->
<g id="edge60" class="edge">
<title>layer4_expert_allreduce_dp0_tp0_ep6&#45;&gt;layer4_aggregate_dp0_tp0_ep6</title>
<path fill="none" stroke="black" d="M6834.02,-1439.4C6855.64,-1428.55 6879.35,-1416.64 6902.83,-1404.86"/>
<polygon fill="black" stroke="black" points="6904.45,-1407.96 6911.82,-1400.35 6901.31,-1401.71 6904.45,-1407.96"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep6&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge409" class="edge">
<title>layer4_aggregate_dp0_tp0_ep6&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M7282.34,-1283.18C7327.96,-1275.56 7375.49,-1268.75 7420.33,-1264.33 8065.33,-1200.75 10065.04,-1195.22 10714.39,-1195.14"/>
<polygon fill="black" stroke="black" points="10714.8,-1198.64 10724.8,-1195.14 10714.8,-1191.64 10714.8,-1198.64"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep6&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge441" class="edge">
<title>layer4_aggregate_dp0_tp0_ep6&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M7282.05,-1282.76C7327.74,-1275.17 7375.38,-1268.47 7420.33,-1264.33 7674.44,-1240.93 15858.07,-1202.69 17268.38,-1196.26"/>
<polygon fill="black" stroke="black" points="17268.62,-1199.76 17278.61,-1196.22 17268.59,-1192.76 17268.62,-1199.76"/>
</g>
<!-- layer4_dispatch_dp0_tp0_ep7 -->
<g id="node62" class="node">
<title>layer4_dispatch_dp0_tp0_ep7</title>
<polygon fill="lightgreen" stroke="black" points="7045.48,-1912.5 6358.02,-1912.5 6181.17,-1776.5 6868.63,-1776.5 7045.48,-1912.5"/>
<text text-anchor="middle" x="6613.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="6613.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="6613.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="6613.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp0_ep7&#45;&gt;layer4_dispatch_dp0_tp0_ep7 -->
<g id="edge62" class="edge">
<title>layer4_gate_dp0_tp0_ep7&#45;&gt;layer4_dispatch_dp0_tp0_ep7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6644.17,-1948.31C6641.62,-1939.81 6639,-1931.07 6636.41,-1922.44"/>
<polygon fill="black" stroke="black" points="6639.73,-1921.33 6633.5,-1912.76 6633.02,-1923.34 6639.73,-1921.33"/>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep7 -->
<g id="node63" class="node">
<title>layer4_expert_mlp_dp0_tp0_ep7</title>
<polygon fill="lightblue" stroke="black" points="7298.83,-1740.5 6947.83,-1740.5 6947.83,-1672.5 7298.83,-1672.5 7298.83,-1740.5"/>
<text text-anchor="middle" x="7123.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="7123.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="7123.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="7123.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp0_ep7&#45;&gt;layer4_expert_mlp_dp0_tp0_ep7 -->
<g id="edge63" class="edge">
<title>layer4_dispatch_dp0_tp0_ep7&#45;&gt;layer4_expert_mlp_dp0_tp0_ep7</title>
<path fill="none" stroke="black" d="M6864.59,-1776.5C6907.82,-1764.97 6951.19,-1753.4 6989.74,-1743.12"/>
<polygon fill="black" stroke="black" points="6990.67,-1746.5 6999.43,-1740.54 6988.86,-1739.73 6990.67,-1746.5"/>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep7 -->
<g id="node64" class="node">
<title>layer4_expert_proj_dp0_tp0_ep7</title>
<polygon fill="lightblue" stroke="black" points="7414.83,-1636.5 7063.83,-1636.5 7063.83,-1568.5 7414.83,-1568.5 7414.83,-1636.5"/>
<text text-anchor="middle" x="7239.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="7239.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="7239.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="7239.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep7&#45;&gt;layer4_expert_proj_dp0_tp0_ep7 -->
<g id="edge64" class="edge">
<title>layer4_expert_mlp_dp0_tp0_ep7&#45;&gt;layer4_expert_proj_dp0_tp0_ep7</title>
<path fill="none" stroke="black" d="M7160.99,-1672.38C7171.42,-1663.21 7182.86,-1653.15 7193.7,-1643.62"/>
<polygon fill="black" stroke="black" points="7196.26,-1646.03 7201.46,-1636.8 7191.64,-1640.77 7196.26,-1646.03"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep7 -->
<g id="node65" class="node">
<title>layer4_expert_allreduce_dp0_tp0_ep7</title>
<ellipse fill="lightyellow" stroke="black" cx="7648.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="7648.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="7648.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="7648.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="7648.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep7&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep7 -->
<g id="edge65" class="edge">
<title>layer4_expert_proj_dp0_tp0_ep7&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep7</title>
<path fill="none" stroke="black" d="M7355.71,-1568.47C7400.89,-1555.65 7453.16,-1540.81 7500.92,-1527.25"/>
<polygon fill="black" stroke="black" points="7502.05,-1530.57 7510.72,-1524.47 7500.14,-1523.84 7502.05,-1530.57"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep7 -->
<g id="node66" class="node">
<title>layer4_aggregate_dp0_tp0_ep7</title>
<polygon fill="lightpink" stroke="black" points="8161.27,-1400.33 7579.13,-1400.33 7429.38,-1264.33 8011.52,-1264.33 8161.27,-1400.33"/>
<text text-anchor="middle" x="7795.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="7795.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="7795.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="7795.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep7&#45;&gt;layer4_aggregate_dp0_tp0_ep7 -->
<g id="edge66" class="edge">
<title>layer4_expert_allreduce_dp0_tp0_ep7&#45;&gt;layer4_aggregate_dp0_tp0_ep7</title>
<path fill="none" stroke="black" d="M7694.03,-1436.75C7703.12,-1427.47 7712.87,-1417.52 7722.61,-1407.58"/>
<polygon fill="black" stroke="black" points="7725.19,-1409.95 7729.68,-1400.35 7720.18,-1405.05 7725.19,-1409.95"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep7&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge410" class="edge">
<title>layer4_aggregate_dp0_tp0_ep7&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M8032.62,-1283.34C8078.15,-1275.72 8125.58,-1268.86 8170.33,-1264.33 8663.24,-1214.41 10163.48,-1200.08 10714.5,-1196.45"/>
<polygon fill="black" stroke="black" points="10714.57,-1199.95 10724.55,-1196.38 10714.52,-1192.95 10714.57,-1199.95"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep7&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge442" class="edge">
<title>layer4_aggregate_dp0_tp0_ep7&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M8032.05,-1282.78C8077.75,-1275.18 8125.38,-1268.48 8170.33,-1264.33 8404.57,-1242.7 15920.38,-1203.28 17268.37,-1196.38"/>
<polygon fill="black" stroke="black" points="17268.66,-1199.88 17278.64,-1196.33 17268.63,-1192.88 17268.66,-1199.88"/>
</g>
<!-- layer4_dispatch_dp0_tp0_ep8 -->
<g id="node68" class="node">
<title>layer4_dispatch_dp0_tp0_ep8</title>
<polygon fill="lightgreen" stroke="black" points="7928.48,-1912.5 7241.02,-1912.5 7064.17,-1776.5 7751.63,-1776.5 7928.48,-1912.5"/>
<text text-anchor="middle" x="7496.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="7496.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="7496.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="7496.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp0_ep8&#45;&gt;layer4_dispatch_dp0_tp0_ep8 -->
<g id="edge68" class="edge">
<title>layer4_gate_dp0_tp0_ep8&#45;&gt;layer4_dispatch_dp0_tp0_ep8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7506.61,-1948.31C7505.77,-1939.91 7504.9,-1931.26 7504.05,-1922.72"/>
<polygon fill="black" stroke="black" points="7507.53,-1922.36 7503.05,-1912.76 7500.56,-1923.06 7507.53,-1922.36"/>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep8 -->
<g id="node69" class="node">
<title>layer4_expert_mlp_dp0_tp0_ep8</title>
<polygon fill="lightblue" stroke="black" points="7866.83,-1740.5 7515.83,-1740.5 7515.83,-1672.5 7866.83,-1672.5 7866.83,-1740.5"/>
<text text-anchor="middle" x="7691.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="7691.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="7691.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="7691.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp0_ep8&#45;&gt;layer4_expert_mlp_dp0_tp0_ep8 -->
<g id="edge69" class="edge">
<title>layer4_dispatch_dp0_tp0_ep8&#45;&gt;layer4_expert_mlp_dp0_tp0_ep8</title>
<path fill="none" stroke="black" d="M7592.4,-1776.5C7607.21,-1766.17 7622.06,-1755.81 7635.59,-1746.37"/>
<polygon fill="black" stroke="black" points="7637.63,-1749.22 7643.83,-1740.63 7633.62,-1743.48 7637.63,-1749.22"/>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep8 -->
<g id="node70" class="node">
<title>layer4_expert_proj_dp0_tp0_ep8</title>
<polygon fill="lightblue" stroke="black" points="8131.83,-1636.5 7780.83,-1636.5 7780.83,-1568.5 8131.83,-1568.5 8131.83,-1636.5"/>
<text text-anchor="middle" x="7956.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="7956.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="7956.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="7956.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep8&#45;&gt;layer4_expert_proj_dp0_tp0_ep8 -->
<g id="edge70" class="edge">
<title>layer4_expert_mlp_dp0_tp0_ep8&#45;&gt;layer4_expert_proj_dp0_tp0_ep8</title>
<path fill="none" stroke="black" d="M7777.36,-1672.38C7804,-1662.13 7833.5,-1650.78 7860.73,-1640.29"/>
<polygon fill="black" stroke="black" points="7862.19,-1643.48 7870.27,-1636.62 7859.68,-1636.95 7862.19,-1643.48"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep8 -->
<g id="node71" class="node">
<title>layer4_expert_allreduce_dp0_tp0_ep8</title>
<ellipse fill="lightyellow" stroke="black" cx="8353.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="8353.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="8353.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="8353.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="8353.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep8&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep8 -->
<g id="edge71" class="edge">
<title>layer4_expert_proj_dp0_tp0_ep8&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep8</title>
<path fill="none" stroke="black" d="M8069.29,-1568.47C8112.63,-1555.8 8162.68,-1541.16 8208.59,-1527.74"/>
<polygon fill="black" stroke="black" points="8209.71,-1531.06 8218.32,-1524.89 8207.74,-1524.34 8209.71,-1531.06"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep8 -->
<g id="node72" class="node">
<title>layer4_aggregate_dp0_tp0_ep8</title>
<polygon fill="lightpink" stroke="black" points="8911.27,-1400.33 8329.13,-1400.33 8179.38,-1264.33 8761.52,-1264.33 8911.27,-1400.33"/>
<text text-anchor="middle" x="8545.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="8545.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="8545.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="8545.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep8&#45;&gt;layer4_aggregate_dp0_tp0_ep8 -->
<g id="edge72" class="edge">
<title>layer4_expert_allreduce_dp0_tp0_ep8&#45;&gt;layer4_aggregate_dp0_tp0_ep8</title>
<path fill="none" stroke="black" d="M8411.98,-1437.57C8424.51,-1427.77 8438.06,-1417.18 8451.54,-1406.64"/>
<polygon fill="black" stroke="black" points="8453.75,-1409.36 8459.47,-1400.45 8449.44,-1403.85 8453.75,-1409.36"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep8&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge411" class="edge">
<title>layer4_aggregate_dp0_tp0_ep8&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M8782.9,-1283.63C8828.36,-1276 8875.69,-1269.07 8920.33,-1264.33 9263.12,-1227.98 10276.19,-1206.53 10714.44,-1198.72"/>
<polygon fill="black" stroke="black" points="10714.75,-1202.21 10724.68,-1198.53 10714.62,-1195.21 10714.75,-1202.21"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep8&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge443" class="edge">
<title>layer4_aggregate_dp0_tp0_ep8&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M8782.05,-1282.8C8827.75,-1275.21 8875.38,-1268.5 8920.33,-1264.33 9348.54,-1224.64 16006.34,-1200.28 17268.62,-1196.01"/>
<polygon fill="black" stroke="black" points="17268.71,-1199.51 17278.7,-1195.98 17268.69,-1192.51 17268.71,-1199.51"/>
</g>
<!-- layer4_dispatch_dp0_tp0_ep9 -->
<g id="node74" class="node">
<title>layer4_dispatch_dp0_tp0_ep9</title>
<polygon fill="lightgreen" stroke="black" points="8811.48,-1912.5 8124.02,-1912.5 7947.17,-1776.5 8634.63,-1776.5 8811.48,-1912.5"/>
<text text-anchor="middle" x="8379.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="8379.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="8379.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="8379.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp0_ep9&#45;&gt;layer4_dispatch_dp0_tp0_ep9 -->
<g id="edge74" class="edge">
<title>layer4_gate_dp0_tp0_ep9&#45;&gt;layer4_dispatch_dp0_tp0_ep9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8359.37,-1948.31C8361,-1939.91 8362.68,-1931.26 8364.34,-1922.72"/>
<polygon fill="black" stroke="black" points="8367.8,-1923.24 8366.27,-1912.76 8360.93,-1921.91 8367.8,-1923.24"/>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep9 -->
<g id="node75" class="node">
<title>layer4_expert_mlp_dp0_tp0_ep9</title>
<polygon fill="lightblue" stroke="black" points="8811.83,-1740.5 8460.83,-1740.5 8460.83,-1672.5 8811.83,-1672.5 8811.83,-1740.5"/>
<text text-anchor="middle" x="8636.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="8636.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="8636.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="8636.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp0_ep9&#45;&gt;layer4_expert_mlp_dp0_tp0_ep9 -->
<g id="edge75" class="edge">
<title>layer4_dispatch_dp0_tp0_ep9&#45;&gt;layer4_expert_mlp_dp0_tp0_ep9</title>
<path fill="none" stroke="black" d="M8505.94,-1776.5C8526.2,-1765.78 8546.51,-1755.03 8564.88,-1745.31"/>
<polygon fill="black" stroke="black" points="8566.52,-1748.4 8573.73,-1740.63 8563.25,-1742.21 8566.52,-1748.4"/>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep9 -->
<g id="node76" class="node">
<title>layer4_expert_proj_dp0_tp0_ep9</title>
<polygon fill="lightblue" stroke="black" points="9015.83,-1636.5 8664.83,-1636.5 8664.83,-1568.5 9015.83,-1568.5 9015.83,-1636.5"/>
<text text-anchor="middle" x="8840.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="8840.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="8840.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="8840.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep9&#45;&gt;layer4_expert_proj_dp0_tp0_ep9 -->
<g id="edge76" class="edge">
<title>layer4_expert_mlp_dp0_tp0_ep9&#45;&gt;layer4_expert_proj_dp0_tp0_ep9</title>
<path fill="none" stroke="black" d="M8702.56,-1672.38C8722.52,-1662.4 8744.58,-1651.37 8765.09,-1641.12"/>
<polygon fill="black" stroke="black" points="8766.7,-1644.23 8774.08,-1636.62 8763.57,-1637.97 8766.7,-1644.23"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep9 -->
<g id="node77" class="node">
<title>layer4_expert_allreduce_dp0_tp0_ep9</title>
<ellipse fill="lightyellow" stroke="black" cx="9087.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="9087.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="9087.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="9087.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="9087.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep9&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep9 -->
<g id="edge77" class="edge">
<title>layer4_expert_proj_dp0_tp0_ep9&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep9</title>
<path fill="none" stroke="black" d="M8910.78,-1568.39C8933.89,-1557.53 8960.06,-1545.23 8985.04,-1533.49"/>
<polygon fill="black" stroke="black" points="8986.62,-1536.61 8994.18,-1529.19 8983.64,-1530.28 8986.62,-1536.61"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep9 -->
<g id="node78" class="node">
<title>layer4_aggregate_dp0_tp0_ep9</title>
<polygon fill="lightpink" stroke="black" points="9661.27,-1400.33 9079.13,-1400.33 8929.38,-1264.33 9511.52,-1264.33 9661.27,-1400.33"/>
<text text-anchor="middle" x="9295.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="9295.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="9295.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="9295.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep9&#45;&gt;layer4_aggregate_dp0_tp0_ep9 -->
<g id="edge78" class="edge">
<title>layer4_expert_allreduce_dp0_tp0_ep9&#45;&gt;layer4_aggregate_dp0_tp0_ep9</title>
<path fill="none" stroke="black" d="M9150.58,-1437.78C9164.3,-1427.88 9179.13,-1417.17 9193.9,-1406.52"/>
<polygon fill="black" stroke="black" points="9196.03,-1409.3 9202.09,-1400.61 9191.93,-1403.62 9196.03,-1409.3"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep9&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge412" class="edge">
<title>layer4_aggregate_dp0_tp0_ep9&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M9533.74,-1284.25C9578.96,-1276.6 9625.98,-1269.5 9670.33,-1264.33 10036.44,-1221.68 10466.04,-1205.26 10714.34,-1199.03"/>
<polygon fill="black" stroke="black" points="10714.66,-1202.53 10724.57,-1198.78 10714.48,-1195.53 10714.66,-1202.53"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep9&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge444" class="edge">
<title>layer4_aggregate_dp0_tp0_ep9&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M9532.06,-1282.83C9577.75,-1275.23 9625.38,-1268.52 9670.33,-1264.33 10058.94,-1228.16 16071.77,-1201.2 17268.22,-1196.18"/>
<polygon fill="black" stroke="black" points="17268.65,-1199.68 17278.64,-1196.13 17268.62,-1192.68 17268.65,-1199.68"/>
</g>
<!-- layer4_dispatch_dp0_tp0_ep10 -->
<g id="node80" class="node">
<title>layer4_dispatch_dp0_tp0_ep10</title>
<polygon fill="lightgreen" stroke="black" points="9694.48,-1912.5 9007.02,-1912.5 8830.17,-1776.5 9517.63,-1776.5 9694.48,-1912.5"/>
<text text-anchor="middle" x="9262.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="9262.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="9262.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="9262.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp0_ep10&#45;&gt;layer4_dispatch_dp0_tp0_ep10 -->
<g id="edge80" class="edge">
<title>layer4_gate_dp0_tp0_ep10&#45;&gt;layer4_dispatch_dp0_tp0_ep10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9232.09,-1948.31C9234.59,-1939.81 9237.16,-1931.07 9239.7,-1922.44"/>
<polygon fill="black" stroke="black" points="9243.08,-1923.34 9242.54,-1912.76 9236.37,-1921.36 9243.08,-1923.34"/>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep10 -->
<g id="node81" class="node">
<title>layer4_expert_mlp_dp0_tp0_ep10</title>
<polygon fill="lightblue" stroke="black" points="9537.83,-1740.5 9186.83,-1740.5 9186.83,-1672.5 9537.83,-1672.5 9537.83,-1740.5"/>
<text text-anchor="middle" x="9362.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="9362.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="9362.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="9362.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp0_ep10&#45;&gt;layer4_expert_mlp_dp0_tp0_ep10 -->
<g id="edge81" class="edge">
<title>layer4_dispatch_dp0_tp0_ep10&#45;&gt;layer4_expert_mlp_dp0_tp0_ep10</title>
<path fill="none" stroke="black" d="M9311.74,-1776.3C9318.68,-1766.86 9325.63,-1757.41 9332.06,-1748.66"/>
<polygon fill="black" stroke="black" points="9334.94,-1750.65 9338.05,-1740.52 9329.31,-1746.5 9334.94,-1750.65"/>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep10 -->
<g id="node82" class="node">
<title>layer4_expert_proj_dp0_tp0_ep10</title>
<polygon fill="lightblue" stroke="black" points="9587.83,-1636.5 9236.83,-1636.5 9236.83,-1568.5 9587.83,-1568.5 9587.83,-1636.5"/>
<text text-anchor="middle" x="9412.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="9412.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="9412.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="9412.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep10&#45;&gt;layer4_expert_proj_dp0_tp0_ep10 -->
<g id="edge82" class="edge">
<title>layer4_expert_mlp_dp0_tp0_ep10&#45;&gt;layer4_expert_proj_dp0_tp0_ep10</title>
<path fill="none" stroke="black" d="M9378.56,-1672.38C9382.71,-1663.92 9387.22,-1654.71 9391.57,-1645.85"/>
<polygon fill="black" stroke="black" points="9394.74,-1647.32 9396,-1636.8 9388.46,-1644.24 9394.74,-1647.32"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep10 -->
<g id="node83" class="node">
<title>layer4_expert_allreduce_dp0_tp0_ep10</title>
<ellipse fill="lightyellow" stroke="black" cx="9823.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="9823.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="9823.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="9823.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="9823.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep10&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep10 -->
<g id="edge83" class="edge">
<title>layer4_expert_proj_dp0_tp0_ep10&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep10</title>
<path fill="none" stroke="black" d="M9529.28,-1568.47C9574.68,-1555.65 9627.2,-1540.81 9675.2,-1527.25"/>
<polygon fill="black" stroke="black" points="9676.37,-1530.56 9685.05,-1524.47 9674.47,-1523.82 9676.37,-1530.56"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep10 -->
<g id="node84" class="node">
<title>layer4_aggregate_dp0_tp0_ep10</title>
<polygon fill="lightpink" stroke="black" points="10411.27,-1400.33 9829.13,-1400.33 9679.38,-1264.33 10261.52,-1264.33 10411.27,-1400.33"/>
<text text-anchor="middle" x="10045.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="10045.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="10045.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="10045.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep10&#45;&gt;layer4_aggregate_dp0_tp0_ep10 -->
<g id="edge84" class="edge">
<title>layer4_expert_allreduce_dp0_tp0_ep10&#45;&gt;layer4_aggregate_dp0_tp0_ep10</title>
<path fill="none" stroke="black" d="M9890.54,-1437.98C9905.42,-1427.91 9921.56,-1417 9937.61,-1406.15"/>
<polygon fill="black" stroke="black" points="9939.67,-1408.99 9945.99,-1400.49 9935.75,-1403.19 9939.67,-1408.99"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep10&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge413" class="edge">
<title>layer4_aggregate_dp0_tp0_ep10&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M10286.4,-1286.8C10330.89,-1279 10376.97,-1271.2 10420.33,-1264.33 10516.89,-1249.05 10624.25,-1233.98 10714.66,-1221.85"/>
<polygon fill="black" stroke="black" points="10715.31,-1225.29 10724.75,-1220.49 10714.38,-1218.35 10715.31,-1225.29"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep10&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge445" class="edge">
<title>layer4_aggregate_dp0_tp0_ep10&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M10282.06,-1282.87C10327.75,-1275.26 10375.39,-1268.54 10420.33,-1264.33 11116.21,-1199.22 16179.81,-1195.37 17268.5,-1195.29"/>
<polygon fill="black" stroke="black" points="17268.78,-1198.79 17278.77,-1195.29 17268.77,-1191.79 17268.78,-1198.79"/>
</g>
<!-- layer4_dispatch_dp0_tp0_ep11 -->
<g id="node86" class="node">
<title>layer4_dispatch_dp0_tp0_ep11</title>
<polygon fill="lightgreen" stroke="black" points="10577.48,-1912.5 9890.02,-1912.5 9713.17,-1776.5 10400.63,-1776.5 10577.48,-1912.5"/>
<text text-anchor="middle" x="10145.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="10145.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="10145.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="10145.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp0_ep11&#45;&gt;layer4_dispatch_dp0_tp0_ep11 -->
<g id="edge86" class="edge">
<title>layer4_gate_dp0_tp0_ep11&#45;&gt;layer4_dispatch_dp0_tp0_ep11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10110.25,-1948.31C10113.15,-1939.81 10116.13,-1931.07 10119.08,-1922.44"/>
<polygon fill="black" stroke="black" points="10122.46,-1923.35 10122.38,-1912.76 10115.84,-1921.09 10122.46,-1923.35"/>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep11 -->
<g id="node87" class="node">
<title>layer4_expert_mlp_dp0_tp0_ep11</title>
<polygon fill="lightblue" stroke="black" points="10588.83,-1740.5 10237.83,-1740.5 10237.83,-1672.5 10588.83,-1672.5 10588.83,-1740.5"/>
<text text-anchor="middle" x="10413.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="10413.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="10413.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="10413.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp0_ep11&#45;&gt;layer4_expert_mlp_dp0_tp0_ep11 -->
<g id="edge87" class="edge">
<title>layer4_dispatch_dp0_tp0_ep11&#45;&gt;layer4_expert_mlp_dp0_tp0_ep11</title>
<path fill="none" stroke="black" d="M10277.36,-1776.5C10298.58,-1765.73 10319.86,-1754.93 10339.08,-1745.18"/>
<polygon fill="black" stroke="black" points="10340.71,-1748.27 10348.05,-1740.63 10337.54,-1742.03 10340.71,-1748.27"/>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep11 -->
<g id="node88" class="node">
<title>layer4_expert_proj_dp0_tp0_ep11</title>
<polygon fill="lightblue" stroke="black" points="10849.83,-1636.5 10498.83,-1636.5 10498.83,-1568.5 10849.83,-1568.5 10849.83,-1636.5"/>
<text text-anchor="middle" x="10674.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="10674.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="10674.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="10674.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep11&#45;&gt;layer4_expert_proj_dp0_tp0_ep11 -->
<g id="edge88" class="edge">
<title>layer4_expert_mlp_dp0_tp0_ep11&#45;&gt;layer4_expert_proj_dp0_tp0_ep11</title>
<path fill="none" stroke="black" d="M10498.07,-1672.38C10524.3,-1662.13 10553.35,-1650.78 10580.18,-1640.29"/>
<polygon fill="black" stroke="black" points="10581.53,-1643.52 10589.57,-1636.62 10578.98,-1637 10581.53,-1643.52"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep11 -->
<g id="node89" class="node">
<title>layer4_expert_allreduce_dp0_tp0_ep11</title>
<ellipse fill="lightyellow" stroke="black" cx="10749.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="10749.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="10749.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="10749.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="10749.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep11&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep11 -->
<g id="edge89" class="edge">
<title>layer4_expert_proj_dp0_tp0_ep11&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep11</title>
<path fill="none" stroke="black" d="M10695.82,-1568.23C10701.32,-1559.72 10707.39,-1550.33 10713.4,-1541.02"/>
<polygon fill="black" stroke="black" points="10716.4,-1542.82 10718.89,-1532.53 10710.52,-1539.03 10716.4,-1542.82"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep11 -->
<g id="node90" class="node">
<title>layer4_aggregate_dp0_tp0_ep11</title>
<polygon fill="lightpink" stroke="black" points="11161.27,-1400.33 10579.13,-1400.33 10429.38,-1264.33 11011.52,-1264.33 11161.27,-1400.33"/>
<text text-anchor="middle" x="10795.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="10795.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="10795.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="10795.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep11&#45;&gt;layer4_aggregate_dp0_tp0_ep11 -->
<g id="edge90" class="edge">
<title>layer4_expert_allreduce_dp0_tp0_ep11&#45;&gt;layer4_aggregate_dp0_tp0_ep11</title>
<path fill="none" stroke="black" d="M10763.75,-1436.34C10766.31,-1428.01 10769.03,-1419.14 10771.76,-1410.23"/>
<polygon fill="black" stroke="black" points="10775.13,-1411.17 10774.72,-1400.58 10768.44,-1409.11 10775.13,-1411.17"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep11&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge414" class="edge">
<title>layer4_aggregate_dp0_tp0_ep11&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M10857.09,-1264.13C10865.94,-1254.5 10874.81,-1244.85 10882.99,-1235.96"/>
<polygon fill="black" stroke="black" points="10885.79,-1238.08 10889.98,-1228.35 10880.64,-1233.34 10885.79,-1238.08"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep11&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge446" class="edge">
<title>layer4_aggregate_dp0_tp0_ep11&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M11032.06,-1282.91C11077.76,-1275.3 11125.39,-1268.56 11170.33,-1264.33 11787.63,-1206.21 16251.22,-1196.92 17268.39,-1195.55"/>
<polygon fill="black" stroke="black" points="17268.74,-1199.05 17278.73,-1195.54 17268.73,-1192.05 17268.74,-1199.05"/>
</g>
<!-- layer4_dispatch_dp0_tp0_ep12 -->
<g id="node92" class="node">
<title>layer4_dispatch_dp0_tp0_ep12</title>
<polygon fill="lightgreen" stroke="black" points="11460.48,-1912.5 10773.02,-1912.5 10596.17,-1776.5 11283.63,-1776.5 11460.48,-1912.5"/>
<text text-anchor="middle" x="11028.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="11028.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="11028.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="11028.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp0_ep12&#45;&gt;layer4_dispatch_dp0_tp0_ep12 -->
<g id="edge92" class="edge">
<title>layer4_gate_dp0_tp0_ep12&#45;&gt;layer4_dispatch_dp0_tp0_ep12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10990.83,-1948.31C10993.96,-1939.72 10997.19,-1930.88 11000.37,-1922.16"/>
<polygon fill="black" stroke="black" points="11003.66,-1923.35 11003.8,-1912.76 10997.08,-1920.95 11003.66,-1923.35"/>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep12 -->
<g id="node93" class="node">
<title>layer4_expert_mlp_dp0_tp0_ep12</title>
<polygon fill="lightblue" stroke="black" points="11235.83,-1740.5 10884.83,-1740.5 10884.83,-1672.5 11235.83,-1672.5 11235.83,-1740.5"/>
<text text-anchor="middle" x="11060.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="11060.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="11060.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="11060.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp0_ep12&#45;&gt;layer4_expert_mlp_dp0_tp0_ep12 -->
<g id="edge93" class="edge">
<title>layer4_dispatch_dp0_tp0_ep12&#45;&gt;layer4_expert_mlp_dp0_tp0_ep12</title>
<path fill="none" stroke="black" d="M11044.14,-1776.3C11046.22,-1767.45 11048.31,-1758.58 11050.26,-1750.29"/>
<polygon fill="black" stroke="black" points="11053.67,-1751.05 11052.56,-1740.52 11046.86,-1749.45 11053.67,-1751.05"/>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep12 -->
<g id="node94" class="node">
<title>layer4_expert_proj_dp0_tp0_ep12</title>
<polygon fill="lightblue" stroke="black" points="11328.83,-1636.5 10977.83,-1636.5 10977.83,-1568.5 11328.83,-1568.5 11328.83,-1636.5"/>
<text text-anchor="middle" x="11153.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="11153.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="11153.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="11153.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep12&#45;&gt;layer4_expert_proj_dp0_tp0_ep12 -->
<g id="edge94" class="edge">
<title>layer4_expert_mlp_dp0_tp0_ep12&#45;&gt;layer4_expert_proj_dp0_tp0_ep12</title>
<path fill="none" stroke="black" d="M11090.52,-1672.38C11098.64,-1663.48 11107.52,-1653.74 11115.98,-1644.46"/>
<polygon fill="black" stroke="black" points="11118.81,-1646.55 11122.96,-1636.8 11113.64,-1641.83 11118.81,-1646.55"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep12 -->
<g id="node95" class="node">
<title>layer4_expert_allreduce_dp0_tp0_ep12</title>
<ellipse fill="lightyellow" stroke="black" cx="11404.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="11404.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="11404.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="11404.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="11404.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep12&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep12 -->
<g id="edge95" class="edge">
<title>layer4_expert_proj_dp0_tp0_ep12&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep12</title>
<path fill="none" stroke="black" d="M11224.92,-1568.39C11248.53,-1557.47 11275.29,-1545.09 11300.8,-1533.29"/>
<polygon fill="black" stroke="black" points="11302.53,-1536.35 11310.14,-1528.98 11299.59,-1530 11302.53,-1536.35"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep12 -->
<g id="node96" class="node">
<title>layer4_aggregate_dp0_tp0_ep12</title>
<polygon fill="lightpink" stroke="black" points="11911.27,-1400.33 11329.13,-1400.33 11179.38,-1264.33 11761.52,-1264.33 11911.27,-1400.33"/>
<text text-anchor="middle" x="11545.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="11545.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="11545.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="11545.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep12&#45;&gt;layer4_aggregate_dp0_tp0_ep12 -->
<g id="edge96" class="edge">
<title>layer4_expert_allreduce_dp0_tp0_ep12&#45;&gt;layer4_aggregate_dp0_tp0_ep12</title>
<path fill="none" stroke="black" d="M11448.17,-1436.75C11456.8,-1427.56 11466.06,-1417.71 11475.3,-1407.87"/>
<polygon fill="black" stroke="black" points="11478.07,-1410.04 11482.36,-1400.35 11472.96,-1405.25 11478.07,-1410.04"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep12&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge415" class="edge">
<title>layer4_aggregate_dp0_tp0_ep12&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M11237.4,-1264.33C11183.64,-1252.63 11129.7,-1240.89 11081.94,-1230.5"/>
<polygon fill="black" stroke="black" points="11082.68,-1227.08 11072.16,-1228.37 11081.19,-1233.92 11082.68,-1227.08"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep12&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge447" class="edge">
<title>layer4_aggregate_dp0_tp0_ep12&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M11782.07,-1282.96C11827.76,-1275.35 11875.39,-1268.6 11920.33,-1264.33 12459.32,-1213.19 16326.99,-1198.68 17268.24,-1195.88"/>
<polygon fill="black" stroke="black" points="17268.51,-1199.38 17278.5,-1195.85 17268.49,-1192.38 17268.51,-1199.38"/>
</g>
<!-- layer4_dispatch_dp0_tp0_ep13 -->
<g id="node98" class="node">
<title>layer4_dispatch_dp0_tp0_ep13</title>
<polygon fill="lightgreen" stroke="black" points="12343.48,-1912.5 11656.02,-1912.5 11479.17,-1776.5 12166.63,-1776.5 12343.48,-1912.5"/>
<text text-anchor="middle" x="11911.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="11911.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="11911.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="11911.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp0_ep13&#45;&gt;layer4_dispatch_dp0_tp0_ep13 -->
<g id="edge98" class="edge">
<title>layer4_gate_dp0_tp0_ep13&#45;&gt;layer4_dispatch_dp0_tp0_ep13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11872.62,-1948.31C11875.85,-1939.72 11879.18,-1930.88 11882.47,-1922.16"/>
<polygon fill="black" stroke="black" points="11885.76,-1923.35 11886.01,-1912.76 11879.21,-1920.88 11885.76,-1923.35"/>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep13 -->
<g id="node99" class="node">
<title>layer4_expert_mlp_dp0_tp0_ep13</title>
<polygon fill="lightblue" stroke="black" points="12125.83,-1740.5 11774.83,-1740.5 11774.83,-1672.5 12125.83,-1672.5 12125.83,-1740.5"/>
<text text-anchor="middle" x="11950.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="11950.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="11950.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="11950.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp0_ep13&#45;&gt;layer4_expert_mlp_dp0_tp0_ep13 -->
<g id="edge99" class="edge">
<title>layer4_dispatch_dp0_tp0_ep13&#45;&gt;layer4_expert_mlp_dp0_tp0_ep13</title>
<path fill="none" stroke="black" d="M11930.6,-1776.3C11933.14,-1767.45 11935.68,-1758.58 11938.05,-1750.29"/>
<polygon fill="black" stroke="black" points="11941.47,-1751.09 11940.86,-1740.52 11934.74,-1749.16 11941.47,-1751.09"/>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep13 -->
<g id="node100" class="node">
<title>layer4_expert_proj_dp0_tp0_ep13</title>
<polygon fill="lightblue" stroke="black" points="12324.83,-1636.5 11973.83,-1636.5 11973.83,-1568.5 12324.83,-1568.5 12324.83,-1636.5"/>
<text text-anchor="middle" x="12149.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="12149.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="12149.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="12149.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep13&#45;&gt;layer4_expert_proj_dp0_tp0_ep13 -->
<g id="edge100" class="edge">
<title>layer4_expert_mlp_dp0_tp0_ep13&#45;&gt;layer4_expert_proj_dp0_tp0_ep13</title>
<path fill="none" stroke="black" d="M12014.94,-1672.38C12034.32,-1662.45 12055.74,-1651.47 12075.66,-1641.26"/>
<polygon fill="black" stroke="black" points="12077.4,-1644.3 12084.7,-1636.62 12074.2,-1638.07 12077.4,-1644.3"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep13 -->
<g id="node101" class="node">
<title>layer4_expert_allreduce_dp0_tp0_ep13</title>
<ellipse fill="lightyellow" stroke="black" cx="12195.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="12195.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="12195.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="12195.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="12195.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep13&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep13 -->
<g id="edge101" class="edge">
<title>layer4_expert_proj_dp0_tp0_ep13&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep13</title>
<path fill="none" stroke="black" d="M12162.51,-1568.23C12165.78,-1559.98 12169.38,-1550.9 12172.95,-1541.88"/>
<polygon fill="black" stroke="black" points="12176.23,-1543.11 12176.66,-1532.53 12169.72,-1540.53 12176.23,-1543.11"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep13 -->
<g id="node102" class="node">
<title>layer4_aggregate_dp0_tp0_ep13</title>
<polygon fill="lightpink" stroke="black" points="12661.27,-1400.33 12079.13,-1400.33 11929.38,-1264.33 12511.52,-1264.33 12661.27,-1400.33"/>
<text text-anchor="middle" x="12295.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="12295.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="12295.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="12295.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep13&#45;&gt;layer4_aggregate_dp0_tp0_ep13 -->
<g id="edge102" class="edge">
<title>layer4_expert_allreduce_dp0_tp0_ep13&#45;&gt;layer4_aggregate_dp0_tp0_ep13</title>
<path fill="none" stroke="black" d="M12226.69,-1436.34C12232.48,-1427.65 12238.66,-1418.38 12244.85,-1409.1"/>
<polygon fill="black" stroke="black" points="12247.89,-1410.84 12250.52,-1400.58 12242.06,-1406.96 12247.89,-1410.84"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep13&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge416" class="edge">
<title>layer4_aggregate_dp0_tp0_ep13&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M11930.71,-1265.64C11927.23,-1265.19 11923.77,-1264.76 11920.33,-1264.33 11646.66,-1230.54 11328.67,-1212.15 11126.06,-1203.04"/>
<polygon fill="black" stroke="black" points="11126.05,-1199.53 11115.9,-1202.58 11125.74,-1206.52 11126.05,-1199.53"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep13&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge448" class="edge">
<title>layer4_aggregate_dp0_tp0_ep13&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M12532.33,-1282.99C12577.94,-1275.39 12625.48,-1268.63 12670.33,-1264.33 13131.36,-1220.13 16408.41,-1200.69 17268.19,-1196.32"/>
<polygon fill="black" stroke="black" points="17268.52,-1199.82 17278.5,-1196.26 17268.48,-1192.82 17268.52,-1199.82"/>
</g>
<!-- layer4_dispatch_dp0_tp0_ep14 -->
<g id="node104" class="node">
<title>layer4_dispatch_dp0_tp0_ep14</title>
<polygon fill="lightgreen" stroke="black" points="13226.48,-1912.5 12539.02,-1912.5 12362.17,-1776.5 13049.63,-1776.5 13226.48,-1912.5"/>
<text text-anchor="middle" x="12794.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="12794.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="12794.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="12794.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp0_ep14&#45;&gt;layer4_dispatch_dp0_tp0_ep14 -->
<g id="edge104" class="edge">
<title>layer4_gate_dp0_tp0_ep14&#45;&gt;layer4_dispatch_dp0_tp0_ep14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12755.02,-1948.31C12758.3,-1939.72 12761.68,-1930.88 12765.02,-1922.16"/>
<polygon fill="black" stroke="black" points="12768.31,-1923.35 12768.61,-1912.76 12761.77,-1920.85 12768.31,-1923.35"/>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep14 -->
<g id="node105" class="node">
<title>layer4_expert_mlp_dp0_tp0_ep14</title>
<polygon fill="lightblue" stroke="black" points="12998.83,-1740.5 12647.83,-1740.5 12647.83,-1672.5 12998.83,-1672.5 12998.83,-1740.5"/>
<text text-anchor="middle" x="12823.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="12823.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="12823.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="12823.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp0_ep14&#45;&gt;layer4_expert_mlp_dp0_tp0_ep14 -->
<g id="edge105" class="edge">
<title>layer4_dispatch_dp0_tp0_ep14&#45;&gt;layer4_expert_mlp_dp0_tp0_ep14</title>
<path fill="none" stroke="black" d="M12808.66,-1776.3C12810.52,-1767.54 12812.39,-1758.77 12814.14,-1750.57"/>
<polygon fill="black" stroke="black" points="12817.62,-1751.03 12816.29,-1740.52 12810.78,-1749.57 12817.62,-1751.03"/>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep14 -->
<g id="node106" class="node">
<title>layer4_expert_proj_dp0_tp0_ep14</title>
<polygon fill="lightblue" stroke="black" points="13131.83,-1636.5 12780.83,-1636.5 12780.83,-1568.5 13131.83,-1568.5 13131.83,-1636.5"/>
<text text-anchor="middle" x="12956.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="12956.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="12956.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="12956.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep14&#45;&gt;layer4_expert_proj_dp0_tp0_ep14 -->
<g id="edge106" class="edge">
<title>layer4_expert_mlp_dp0_tp0_ep14&#45;&gt;layer4_expert_proj_dp0_tp0_ep14</title>
<path fill="none" stroke="black" d="M12866.51,-1672.38C12878.7,-1663.03 12892.1,-1652.76 12904.73,-1643.07"/>
<polygon fill="black" stroke="black" points="12907.1,-1645.66 12912.91,-1636.8 12902.84,-1640.11 12907.1,-1645.66"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep14 -->
<g id="node107" class="node">
<title>layer4_expert_allreduce_dp0_tp0_ep14</title>
<ellipse fill="lightyellow" stroke="black" cx="12979.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="12979.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="12979.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="12979.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="12979.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep14&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep14 -->
<g id="edge107" class="edge">
<title>layer4_expert_proj_dp0_tp0_ep14&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep14</title>
<path fill="none" stroke="black" d="M12962.92,-1568.23C12964.52,-1560.15 12966.28,-1551.29 12968.03,-1542.45"/>
<polygon fill="black" stroke="black" points="12971.48,-1543.02 12969.99,-1532.53 12964.62,-1541.65 12971.48,-1543.02"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep14 -->
<g id="node108" class="node">
<title>layer4_aggregate_dp0_tp0_ep14</title>
<polygon fill="lightpink" stroke="black" points="13411.27,-1400.33 12829.13,-1400.33 12679.38,-1264.33 13261.52,-1264.33 13411.27,-1400.33"/>
<text text-anchor="middle" x="13045.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="13045.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="13045.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="13045.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep14&#45;&gt;layer4_aggregate_dp0_tp0_ep14 -->
<g id="edge108" class="edge">
<title>layer4_expert_allreduce_dp0_tp0_ep14&#45;&gt;layer4_aggregate_dp0_tp0_ep14</title>
<path fill="none" stroke="black" d="M13000.03,-1436.34C13003.73,-1427.92 13007.68,-1418.95 13011.63,-1409.95"/>
<polygon fill="black" stroke="black" points="13014.93,-1411.14 13015.75,-1400.58 13008.52,-1408.32 13014.93,-1411.14"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep14&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge417" class="edge">
<title>layer4_aggregate_dp0_tp0_ep14&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M12680.23,-1265.44C12676.92,-1265.06 12673.61,-1264.69 12670.33,-1264.33 12376.9,-1232.49 11522.09,-1209.26 11126.1,-1199.89"/>
<polygon fill="black" stroke="black" points="11126.04,-1196.39 11115.96,-1199.66 11125.88,-1203.39 11126.04,-1196.39"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep14&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge449" class="edge">
<title>layer4_aggregate_dp0_tp0_ep14&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M13282.34,-1283.09C13327.95,-1275.48 13375.48,-1268.69 13420.33,-1264.33 13803.86,-1227.05 16497.32,-1203.06 17268.48,-1196.91"/>
<polygon fill="black" stroke="black" points="17268.61,-1200.41 17278.58,-1196.83 17268.55,-1193.41 17268.61,-1200.41"/>
</g>
<!-- layer4_dispatch_dp0_tp0_ep15 -->
<g id="node110" class="node">
<title>layer4_dispatch_dp0_tp0_ep15</title>
<polygon fill="lightgreen" stroke="black" points="14109.48,-1912.5 13422.02,-1912.5 13245.17,-1776.5 13932.63,-1776.5 14109.48,-1912.5"/>
<text text-anchor="middle" x="13677.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="13677.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="13677.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="13677.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp0_ep15&#45;&gt;layer4_dispatch_dp0_tp0_ep15 -->
<g id="edge110" class="edge">
<title>layer4_gate_dp0_tp0_ep15&#45;&gt;layer4_dispatch_dp0_tp0_ep15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13637.41,-1948.31C13640.75,-1939.72 13644.18,-1930.88 13647.56,-1922.16"/>
<polygon fill="black" stroke="black" points="13650.86,-1923.35 13651.21,-1912.76 13644.33,-1920.81 13650.86,-1923.35"/>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep15 -->
<g id="node111" class="node">
<title>layer4_expert_mlp_dp0_tp0_ep15</title>
<polygon fill="lightblue" stroke="black" points="13854.83,-1740.5 13503.83,-1740.5 13503.83,-1672.5 13854.83,-1672.5 13854.83,-1740.5"/>
<text text-anchor="middle" x="13679.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="13679.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="13679.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="13679.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp0_ep15&#45;&gt;layer4_expert_mlp_dp0_tp0_ep15 -->
<g id="edge111" class="edge">
<title>layer4_dispatch_dp0_tp0_ep15&#45;&gt;layer4_expert_mlp_dp0_tp0_ep15</title>
<path fill="none" stroke="black" d="M13678.31,-1776.3C13678.44,-1767.54 13678.57,-1758.77 13678.69,-1750.57"/>
<polygon fill="black" stroke="black" points="13682.19,-1750.57 13678.84,-1740.52 13675.19,-1750.46 13682.19,-1750.57"/>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep15 -->
<g id="node112" class="node">
<title>layer4_expert_proj_dp0_tp0_ep15</title>
<polygon fill="lightblue" stroke="black" points="13887.83,-1636.5 13536.83,-1636.5 13536.83,-1568.5 13887.83,-1568.5 13887.83,-1636.5"/>
<text text-anchor="middle" x="13712.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="13712.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="13712.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="13712.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp0_ep15&#45;&gt;layer4_expert_proj_dp0_tp0_ep15 -->
<g id="edge112" class="edge">
<title>layer4_expert_mlp_dp0_tp0_ep15&#45;&gt;layer4_expert_proj_dp0_tp0_ep15</title>
<path fill="none" stroke="black" d="M13690.04,-1672.38C13692.72,-1664.1 13695.63,-1655.09 13698.44,-1646.41"/>
<polygon fill="black" stroke="black" points="13701.8,-1647.39 13701.55,-1636.8 13695.14,-1645.24 13701.8,-1647.39"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep15 -->
<g id="node113" class="node">
<title>layer4_expert_allreduce_dp0_tp0_ep15</title>
<ellipse fill="lightyellow" stroke="black" cx="13778.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="13778.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="13778.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="13778.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="13778.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp0_ep15&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep15 -->
<g id="edge113" class="edge">
<title>layer4_expert_proj_dp0_tp0_ep15&#45;&gt;layer4_expert_allreduce_dp0_tp0_ep15</title>
<path fill="none" stroke="black" d="M13731.24,-1568.23C13736.03,-1559.81 13741.31,-1550.52 13746.55,-1541.31"/>
<polygon fill="black" stroke="black" points="13749.64,-1542.95 13751.54,-1532.53 13743.56,-1539.49 13749.64,-1542.95"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep15 -->
<g id="node114" class="node">
<title>layer4_aggregate_dp0_tp0_ep15</title>
<polygon fill="lightpink" stroke="black" points="14161.27,-1400.33 13579.13,-1400.33 13429.38,-1264.33 14011.52,-1264.33 14161.27,-1400.33"/>
<text text-anchor="middle" x="13795.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="13795.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="13795.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="13795.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp0_ep15&#45;&gt;layer4_aggregate_dp0_tp0_ep15 -->
<g id="edge114" class="edge">
<title>layer4_expert_allreduce_dp0_tp0_ep15&#45;&gt;layer4_aggregate_dp0_tp0_ep15</title>
<path fill="none" stroke="black" d="M13783.66,-1436.34C13784.59,-1428.1 13785.59,-1419.33 13786.58,-1410.52"/>
<polygon fill="black" stroke="black" points="13790.06,-1410.91 13787.71,-1400.58 13783.11,-1410.12 13790.06,-1410.91"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep15&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge418" class="edge">
<title>layer4_aggregate_dp0_tp0_ep15&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M13430.24,-1265.38C13426.92,-1265.02 13423.62,-1264.67 13420.33,-1264.33 12977.7,-1218.94 11641.42,-1202 11126.1,-1197.05"/>
<polygon fill="black" stroke="black" points="11125.98,-1193.55 11115.95,-1196.96 11125.92,-1200.55 11125.98,-1193.55"/>
</g>
<!-- layer4_aggregate_dp0_tp0_ep15&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge450" class="edge">
<title>layer4_aggregate_dp0_tp0_ep15&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M14032.35,-1283.23C14077.96,-1275.6 14125.49,-1268.78 14170.33,-1264.33 14775.55,-1204.32 16644.41,-1196.38 17268.8,-1195.43"/>
<polygon fill="black" stroke="black" points="17268.81,-1198.93 17278.81,-1195.41 17268.8,-1191.93 17268.81,-1198.93"/>
</g>
<!-- layer4_dispatch_dp0_tp1_ep0 -->
<g id="node116" class="node">
<title>layer4_dispatch_dp0_tp1_ep0</title>
<polygon fill="lightgreen" stroke="black" points="14992.48,-1912.5 14305.02,-1912.5 14128.17,-1776.5 14815.63,-1776.5 14992.48,-1912.5"/>
<text text-anchor="middle" x="14560.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="14560.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 68</text>
<text text-anchor="middle" x="14560.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="14560.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp1_ep0&#45;&gt;layer4_dispatch_dp0_tp1_ep0 -->
<g id="edge116" class="edge">
<title>layer4_gate_dp0_tp1_ep0&#45;&gt;layer4_dispatch_dp0_tp1_ep0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14600.85,-1948.31C14597.46,-1939.72 14593.98,-1930.88 14590.54,-1922.16"/>
<polygon fill="black" stroke="black" points="14593.76,-1920.78 14586.83,-1912.76 14587.24,-1923.34 14593.76,-1920.78"/>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep0 -->
<g id="node117" class="node">
<title>layer4_expert_mlp_dp0_tp1_ep0</title>
<polygon fill="lightblue" stroke="black" points="14727.83,-1740.5 14376.83,-1740.5 14376.83,-1672.5 14727.83,-1672.5 14727.83,-1740.5"/>
<text text-anchor="middle" x="14552.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="14552.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 68</text>
<text text-anchor="middle" x="14552.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="14552.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp1_ep0&#45;&gt;layer4_expert_mlp_dp0_tp1_ep0 -->
<g id="edge117" class="edge">
<title>layer4_dispatch_dp0_tp1_ep0&#45;&gt;layer4_expert_mlp_dp0_tp1_ep0</title>
<path fill="none" stroke="black" d="M14556.37,-1776.3C14555.86,-1767.54 14555.34,-1758.77 14554.86,-1750.57"/>
<polygon fill="black" stroke="black" points="14558.35,-1750.29 14554.27,-1740.52 14551.36,-1750.7 14558.35,-1750.29"/>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep0 -->
<g id="node118" class="node">
<title>layer4_expert_proj_dp0_tp1_ep0</title>
<polygon fill="lightblue" stroke="black" points="14726.83,-1636.5 14375.83,-1636.5 14375.83,-1568.5 14726.83,-1568.5 14726.83,-1636.5"/>
<text text-anchor="middle" x="14551.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="14551.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 68</text>
<text text-anchor="middle" x="14551.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="14551.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep0&#45;&gt;layer4_expert_proj_dp0_tp1_ep0 -->
<g id="edge118" class="edge">
<title>layer4_expert_mlp_dp0_tp1_ep0&#45;&gt;layer4_expert_proj_dp0_tp1_ep0</title>
<path fill="none" stroke="black" d="M14552,-1672.38C14551.92,-1664.28 14551.84,-1655.48 14551.75,-1646.97"/>
<polygon fill="black" stroke="black" points="14555.25,-1646.76 14551.65,-1636.8 14548.25,-1646.83 14555.25,-1646.76"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep0 -->
<g id="node119" class="node">
<title>layer4_expert_allreduce_dp0_tp1_ep0</title>
<ellipse fill="lightyellow" stroke="black" cx="14549.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="14549.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="14549.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 68</text>
<text text-anchor="middle" x="14549.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="14549.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep0&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep0 -->
<g id="edge119" class="edge">
<title>layer4_expert_proj_dp0_tp1_ep0&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep0</title>
<path fill="none" stroke="black" d="M14550.75,-1568.23C14550.62,-1560.24 14550.46,-1551.48 14550.31,-1542.73"/>
<polygon fill="black" stroke="black" points="14553.81,-1542.46 14550.14,-1532.53 14546.81,-1542.58 14553.81,-1542.46"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep0 -->
<g id="node120" class="node">
<title>layer4_aggregate_dp0_tp1_ep0</title>
<polygon fill="lightpink" stroke="black" points="14911.27,-1400.33 14329.13,-1400.33 14179.38,-1264.33 14761.52,-1264.33 14911.27,-1400.33"/>
<text text-anchor="middle" x="14545.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="14545.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 68</text>
<text text-anchor="middle" x="14545.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="14545.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep0&#45;&gt;layer4_aggregate_dp0_tp1_ep0 -->
<g id="edge120" class="edge">
<title>layer4_expert_allreduce_dp0_tp1_ep0&#45;&gt;layer4_aggregate_dp0_tp1_ep0</title>
<path fill="none" stroke="black" d="M14548.06,-1435.93C14547.84,-1427.84 14547.62,-1419.26 14547.39,-1410.64"/>
<polygon fill="black" stroke="black" points="14550.88,-1410.43 14547.12,-1400.53 14543.88,-1410.62 14550.88,-1410.43"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep0&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge419" class="edge">
<title>layer4_aggregate_dp0_tp1_ep0&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M14180.24,-1265.35C14176.92,-1265 14173.62,-1264.66 14170.33,-1264.33 13576.19,-1205.31 11744.04,-1196.72 11126.2,-1195.51"/>
<polygon fill="black" stroke="black" points="11125.86,-1192.01 11115.85,-1195.49 11125.84,-1199.01 11125.86,-1192.01"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep0&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge451" class="edge">
<title>layer4_aggregate_dp0_tp1_ep0&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M14782.62,-1283.41C14828.16,-1275.78 14875.59,-1268.91 14920.33,-1264.33 15373.75,-1217.97 16745.11,-1201.58 17268.4,-1196.92"/>
<polygon fill="black" stroke="black" points="17268.73,-1200.41 17278.7,-1196.82 17268.67,-1193.41 17268.73,-1200.41"/>
</g>
<!-- layer4_dispatch_dp0_tp1_ep1 -->
<g id="node122" class="node">
<title>layer4_dispatch_dp0_tp1_ep1</title>
<polygon fill="lightgreen" stroke="black" points="15875.48,-1912.5 15188.02,-1912.5 15011.17,-1776.5 15698.63,-1776.5 15875.48,-1912.5"/>
<text text-anchor="middle" x="15443.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="15443.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 69</text>
<text text-anchor="middle" x="15443.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="15443.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp1_ep1&#45;&gt;layer4_dispatch_dp0_tp1_ep1 -->
<g id="edge122" class="edge">
<title>layer4_gate_dp0_tp1_ep1&#45;&gt;layer4_dispatch_dp0_tp1_ep1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15463.28,-1948.31C15461.65,-1939.91 15459.97,-1931.26 15458.32,-1922.72"/>
<polygon fill="black" stroke="black" points="15461.72,-1921.91 15456.38,-1912.76 15454.85,-1923.24 15461.72,-1921.91"/>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep1 -->
<g id="node123" class="node">
<title>layer4_expert_mlp_dp0_tp1_ep1</title>
<polygon fill="lightblue" stroke="black" points="15548.83,-1740.5 15197.83,-1740.5 15197.83,-1672.5 15548.83,-1672.5 15548.83,-1740.5"/>
<text text-anchor="middle" x="15373.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="15373.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 69</text>
<text text-anchor="middle" x="15373.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="15373.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp1_ep1&#45;&gt;layer4_expert_mlp_dp0_tp1_ep1 -->
<g id="edge123" class="edge">
<title>layer4_dispatch_dp0_tp1_ep1&#45;&gt;layer4_expert_mlp_dp0_tp1_ep1</title>
<path fill="none" stroke="black" d="M15408.74,-1776.3C15404.03,-1767.16 15399.32,-1758 15394.93,-1749.48"/>
<polygon fill="black" stroke="black" points="15398.01,-1747.81 15390.32,-1740.52 15391.78,-1751.01 15398.01,-1747.81"/>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep1 -->
<g id="node124" class="node">
<title>layer4_expert_proj_dp0_tp1_ep1</title>
<polygon fill="lightblue" stroke="black" points="15528.83,-1636.5 15177.83,-1636.5 15177.83,-1568.5 15528.83,-1568.5 15528.83,-1636.5"/>
<text text-anchor="middle" x="15353.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="15353.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 69</text>
<text text-anchor="middle" x="15353.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="15353.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep1&#45;&gt;layer4_expert_proj_dp0_tp1_ep1 -->
<g id="edge124" class="edge">
<title>layer4_expert_mlp_dp0_tp1_ep1&#45;&gt;layer4_expert_proj_dp0_tp1_ep1</title>
<path fill="none" stroke="black" d="M15366.83,-1672.38C15365.23,-1664.19 15363.48,-1655.29 15361.8,-1646.69"/>
<polygon fill="black" stroke="black" points="15365.21,-1645.94 15359.86,-1636.8 15358.34,-1647.29 15365.21,-1645.94"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep1 -->
<g id="node125" class="node">
<title>layer4_expert_allreduce_dp0_tp1_ep1</title>
<ellipse fill="lightyellow" stroke="black" cx="15314.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="15314.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="15314.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 69</text>
<text text-anchor="middle" x="15314.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="15314.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep1&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep1 -->
<g id="edge125" class="edge">
<title>layer4_expert_proj_dp0_tp1_ep1&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep1</title>
<path fill="none" stroke="black" d="M15342.15,-1568.23C15339.41,-1560.07 15336.39,-1551.09 15333.39,-1542.16"/>
<polygon fill="black" stroke="black" points="15336.66,-1540.89 15330.15,-1532.53 15330.02,-1543.12 15336.66,-1540.89"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep1 -->
<g id="node126" class="node">
<title>layer4_aggregate_dp0_tp1_ep1</title>
<polygon fill="lightpink" stroke="black" points="15661.27,-1400.33 15079.13,-1400.33 14929.38,-1264.33 15511.52,-1264.33 15661.27,-1400.33"/>
<text text-anchor="middle" x="15295.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="15295.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 69</text>
<text text-anchor="middle" x="15295.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="15295.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep1&#45;&gt;layer4_aggregate_dp0_tp1_ep1 -->
<g id="edge126" class="edge">
<title>layer4_expert_allreduce_dp0_tp1_ep1&#45;&gt;layer4_aggregate_dp0_tp1_ep1</title>
<path fill="none" stroke="black" d="M15308.37,-1436.34C15307.32,-1428.1 15306.21,-1419.33 15305.1,-1410.52"/>
<polygon fill="black" stroke="black" points="15308.57,-1410.06 15303.84,-1400.58 15301.62,-1410.94 15308.57,-1410.06"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep1&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge420" class="edge">
<title>layer4_aggregate_dp0_tp1_ep1&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M14930.24,-1265.33C14926.92,-1264.99 14923.62,-1264.65 14920.33,-1264.33 14542.33,-1227.54 11890.36,-1203.25 11126.03,-1196.96"/>
<polygon fill="black" stroke="black" points="11126.05,-1193.46 11116.02,-1196.87 11125.99,-1200.46 11126.05,-1193.46"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep1&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge452" class="edge">
<title>layer4_aggregate_dp0_tp1_ep1&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M15533.17,-1283.73C15578.54,-1276.1 15625.78,-1269.14 15670.33,-1264.33 15974.43,-1231.51 16863.45,-1208.63 17268.72,-1199.61"/>
<polygon fill="black" stroke="black" points="17268.88,-1203.11 17278.8,-1199.39 17268.72,-1196.11 17268.88,-1203.11"/>
</g>
<!-- layer4_dispatch_dp0_tp1_ep2 -->
<g id="node128" class="node">
<title>layer4_dispatch_dp0_tp1_ep2</title>
<polygon fill="lightgreen" stroke="black" points="16758.48,-1912.5 16071.02,-1912.5 15894.17,-1776.5 16581.63,-1776.5 16758.48,-1912.5"/>
<text text-anchor="middle" x="16326.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="16326.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 70</text>
<text text-anchor="middle" x="16326.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="16326.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp1_ep2&#45;&gt;layer4_dispatch_dp0_tp1_ep2 -->
<g id="edge128" class="edge">
<title>layer4_gate_dp0_tp1_ep2&#45;&gt;layer4_dispatch_dp0_tp1_ep2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16346.28,-1948.31C16344.65,-1939.91 16342.97,-1931.26 16341.32,-1922.72"/>
<polygon fill="black" stroke="black" points="16344.72,-1921.91 16339.38,-1912.76 16337.85,-1923.24 16344.72,-1921.91"/>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep2 -->
<g id="node129" class="node">
<title>layer4_expert_mlp_dp0_tp1_ep2</title>
<polygon fill="lightblue" stroke="black" points="16465.83,-1740.5 16114.83,-1740.5 16114.83,-1672.5 16465.83,-1672.5 16465.83,-1740.5"/>
<text text-anchor="middle" x="16290.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="16290.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 70</text>
<text text-anchor="middle" x="16290.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="16290.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp1_ep2&#45;&gt;layer4_expert_mlp_dp0_tp1_ep2 -->
<g id="edge129" class="edge">
<title>layer4_dispatch_dp0_tp1_ep2&#45;&gt;layer4_expert_mlp_dp0_tp1_ep2</title>
<path fill="none" stroke="black" d="M16308.54,-1776.3C16306.19,-1767.45 16303.85,-1758.58 16301.65,-1750.29"/>
<polygon fill="black" stroke="black" points="16305.01,-1749.29 16299.07,-1740.52 16298.24,-1751.08 16305.01,-1749.29"/>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep2 -->
<g id="node130" class="node">
<title>layer4_expert_proj_dp0_tp1_ep2</title>
<polygon fill="lightblue" stroke="black" points="16325.83,-1636.5 15974.83,-1636.5 15974.83,-1568.5 16325.83,-1568.5 16325.83,-1636.5"/>
<text text-anchor="middle" x="16150.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="16150.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 70</text>
<text text-anchor="middle" x="16150.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="16150.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep2&#45;&gt;layer4_expert_proj_dp0_tp1_ep2 -->
<g id="edge130" class="edge">
<title>layer4_expert_mlp_dp0_tp1_ep2&#45;&gt;layer4_expert_proj_dp0_tp1_ep2</title>
<path fill="none" stroke="black" d="M16244.87,-1672.38C16231.91,-1662.94 16217.67,-1652.56 16204.26,-1642.79"/>
<polygon fill="black" stroke="black" points="16206.17,-1639.86 16196.03,-1636.8 16202.05,-1645.52 16206.17,-1639.86"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep2 -->
<g id="node131" class="node">
<title>layer4_expert_allreduce_dp0_tp1_ep2</title>
<ellipse fill="lightyellow" stroke="black" cx="16080.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="16080.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="16080.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 70</text>
<text text-anchor="middle" x="16080.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="16080.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep2&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep2 -->
<g id="edge131" class="edge">
<title>layer4_expert_proj_dp0_tp1_ep2&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep2</title>
<path fill="none" stroke="black" d="M16130.27,-1568.23C16125.18,-1559.81 16119.59,-1550.52 16114.03,-1541.31"/>
<polygon fill="black" stroke="black" points="16116.9,-1539.28 16108.73,-1532.53 16110.9,-1542.9 16116.9,-1539.28"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep2 -->
<g id="node132" class="node">
<title>layer4_aggregate_dp0_tp1_ep2</title>
<polygon fill="lightpink" stroke="black" points="16411.27,-1400.33 15829.13,-1400.33 15679.38,-1264.33 16261.52,-1264.33 16411.27,-1400.33"/>
<text text-anchor="middle" x="16045.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="16045.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 70</text>
<text text-anchor="middle" x="16045.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="16045.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep2&#45;&gt;layer4_aggregate_dp0_tp1_ep2 -->
<g id="edge132" class="edge">
<title>layer4_expert_allreduce_dp0_tp1_ep2&#45;&gt;layer4_aggregate_dp0_tp1_ep2</title>
<path fill="none" stroke="black" d="M16069.35,-1436.34C16067.43,-1428.1 16065.38,-1419.33 16063.33,-1410.52"/>
<polygon fill="black" stroke="black" points="16066.69,-1409.52 16061.01,-1400.58 16059.87,-1411.11 16066.69,-1409.52"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep2&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge421" class="edge">
<title>layer4_aggregate_dp0_tp1_ep2&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M15680.24,-1265.32C15676.92,-1264.98 15673.62,-1264.65 15670.33,-1264.33 15214.86,-1220.63 11979.71,-1200.85 11126.3,-1196.35"/>
<polygon fill="black" stroke="black" points="11126.08,-1192.85 11116.06,-1196.3 11126.04,-1199.85 11126.08,-1192.85"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep2&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge453" class="edge">
<title>layer4_aggregate_dp0_tp1_ep2&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M16284.03,-1284.58C16329.17,-1276.91 16376.09,-1269.72 16420.33,-1264.33 16713.75,-1228.63 17055.54,-1210.53 17268.45,-1202.02"/>
<polygon fill="black" stroke="black" points="17268.64,-1205.52 17278.49,-1201.63 17268.36,-1198.52 17268.64,-1205.52"/>
</g>
<!-- layer4_dispatch_dp0_tp1_ep3 -->
<g id="node134" class="node">
<title>layer4_dispatch_dp0_tp1_ep3</title>
<polygon fill="lightgreen" stroke="black" points="17641.48,-1912.5 16954.02,-1912.5 16777.17,-1776.5 17464.63,-1776.5 17641.48,-1912.5"/>
<text text-anchor="middle" x="17209.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="17209.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 71</text>
<text text-anchor="middle" x="17209.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="17209.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp1_ep3&#45;&gt;layer4_dispatch_dp0_tp1_ep3 -->
<g id="edge134" class="edge">
<title>layer4_gate_dp0_tp1_ep3&#45;&gt;layer4_dispatch_dp0_tp1_ep3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17229.28,-1948.31C17227.65,-1939.91 17225.97,-1931.26 17224.32,-1922.72"/>
<polygon fill="black" stroke="black" points="17227.72,-1921.91 17222.38,-1912.76 17220.85,-1923.24 17227.72,-1921.91"/>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep3 -->
<g id="node135" class="node">
<title>layer4_expert_mlp_dp0_tp1_ep3</title>
<polygon fill="lightblue" stroke="black" points="17303.83,-1740.5 16952.83,-1740.5 16952.83,-1672.5 17303.83,-1672.5 17303.83,-1740.5"/>
<text text-anchor="middle" x="17128.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="17128.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 71</text>
<text text-anchor="middle" x="17128.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="17128.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp1_ep3&#45;&gt;layer4_expert_mlp_dp0_tp1_ep3 -->
<g id="edge135" class="edge">
<title>layer4_dispatch_dp0_tp1_ep3&#45;&gt;layer4_expert_mlp_dp0_tp1_ep3</title>
<path fill="none" stroke="black" d="M17169.3,-1776.3C17163.8,-1767.06 17158.28,-1757.8 17153.17,-1749.21"/>
<polygon fill="black" stroke="black" points="17156.11,-1747.32 17147.99,-1740.52 17150.1,-1750.9 17156.11,-1747.32"/>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep3 -->
<g id="node136" class="node">
<title>layer4_expert_proj_dp0_tp1_ep3</title>
<polygon fill="lightblue" stroke="black" points="17113.83,-1636.5 16762.83,-1636.5 16762.83,-1568.5 17113.83,-1568.5 17113.83,-1636.5"/>
<text text-anchor="middle" x="16938.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="16938.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 71</text>
<text text-anchor="middle" x="16938.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="16938.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep3&#45;&gt;layer4_expert_proj_dp0_tp1_ep3 -->
<g id="edge136" class="edge">
<title>layer4_expert_mlp_dp0_tp1_ep3&#45;&gt;layer4_expert_proj_dp0_tp1_ep3</title>
<path fill="none" stroke="black" d="M17066.64,-1672.38C17048.21,-1662.49 17027.87,-1651.57 17008.92,-1641.4"/>
<polygon fill="black" stroke="black" points="17010.5,-1638.27 17000.03,-1636.62 17007.18,-1644.44 17010.5,-1638.27"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep3 -->
<g id="node137" class="node">
<title>layer4_expert_allreduce_dp0_tp1_ep3</title>
<ellipse fill="lightyellow" stroke="black" cx="16843.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="16843.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="16843.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 71</text>
<text text-anchor="middle" x="16843.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="16843.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep3&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep3 -->
<g id="edge137" class="edge">
<title>layer4_expert_proj_dp0_tp1_ep3&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep3</title>
<path fill="none" stroke="black" d="M16911.1,-1568.23C16903.91,-1559.44 16895.95,-1549.71 16888.09,-1540.11"/>
<polygon fill="black" stroke="black" points="16890.57,-1537.62 16881.53,-1532.09 16885.15,-1542.05 16890.57,-1537.62"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep3 -->
<g id="node138" class="node">
<title>layer4_aggregate_dp0_tp1_ep3</title>
<polygon fill="lightpink" stroke="black" points="17161.27,-1400.33 16579.13,-1400.33 16429.38,-1264.33 17011.52,-1264.33 17161.27,-1400.33"/>
<text text-anchor="middle" x="16795.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="16795.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 71</text>
<text text-anchor="middle" x="16795.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="16795.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep3&#45;&gt;layer4_aggregate_dp0_tp1_ep3 -->
<g id="edge138" class="edge">
<title>layer4_expert_allreduce_dp0_tp1_ep3&#45;&gt;layer4_aggregate_dp0_tp1_ep3</title>
<path fill="none" stroke="black" d="M16828.27,-1436.34C16825.61,-1428.01 16822.77,-1419.14 16819.92,-1410.23"/>
<polygon fill="black" stroke="black" points="16823.21,-1409.04 16816.83,-1400.58 16816.55,-1411.17 16823.21,-1409.04"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep3&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge422" class="edge">
<title>layer4_aggregate_dp0_tp1_ep3&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M16430.24,-1265.31C16426.92,-1264.97 16423.62,-1264.65 16420.33,-1264.33 15886.95,-1213.68 12061.82,-1198.81 11126.35,-1195.91"/>
<polygon fill="black" stroke="black" points="11126.17,-1192.41 11116.15,-1195.88 11126.14,-1199.41 11126.17,-1192.41"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep3&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge454" class="edge">
<title>layer4_aggregate_dp0_tp1_ep3&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M17033.28,-1283.67C17120.81,-1266.14 17218.25,-1246.62 17299.24,-1230.4"/>
<polygon fill="black" stroke="black" points="17300.42,-1233.74 17309.54,-1228.34 17299.04,-1226.87 17300.42,-1233.74"/>
</g>
<!-- layer4_dispatch_dp0_tp1_ep4 -->
<g id="node140" class="node">
<title>layer4_dispatch_dp0_tp1_ep4</title>
<polygon fill="lightgreen" stroke="black" points="18524.48,-1912.5 17837.02,-1912.5 17660.17,-1776.5 18347.63,-1776.5 18524.48,-1912.5"/>
<text text-anchor="middle" x="18092.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="18092.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 72</text>
<text text-anchor="middle" x="18092.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="18092.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp1_ep4&#45;&gt;layer4_dispatch_dp0_tp1_ep4 -->
<g id="edge140" class="edge">
<title>layer4_gate_dp0_tp1_ep4&#45;&gt;layer4_dispatch_dp0_tp1_ep4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18122.56,-1948.31C18120.07,-1939.81 18117.49,-1931.07 18114.95,-1922.44"/>
<polygon fill="black" stroke="black" points="18118.29,-1921.36 18112.11,-1912.76 18111.57,-1923.34 18118.29,-1921.36"/>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep4 -->
<g id="node141" class="node">
<title>layer4_expert_mlp_dp0_tp1_ep4</title>
<polygon fill="lightblue" stroke="black" points="18198.83,-1740.5 17847.83,-1740.5 17847.83,-1672.5 18198.83,-1672.5 18198.83,-1740.5"/>
<text text-anchor="middle" x="18023.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="18023.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 72</text>
<text text-anchor="middle" x="18023.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="18023.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp1_ep4&#45;&gt;layer4_expert_mlp_dp0_tp1_ep4 -->
<g id="edge141" class="edge">
<title>layer4_dispatch_dp0_tp1_ep4&#45;&gt;layer4_expert_mlp_dp0_tp1_ep4</title>
<path fill="none" stroke="black" d="M18058.23,-1776.3C18053.59,-1767.16 18048.95,-1758 18044.62,-1749.48"/>
<polygon fill="black" stroke="black" points="18047.72,-1747.85 18040.08,-1740.52 18041.48,-1751.02 18047.72,-1747.85"/>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep4 -->
<g id="node142" class="node">
<title>layer4_expert_proj_dp0_tp1_ep4</title>
<polygon fill="lightblue" stroke="black" points="17925.83,-1636.5 17574.83,-1636.5 17574.83,-1568.5 17925.83,-1568.5 17925.83,-1636.5"/>
<text text-anchor="middle" x="17750.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="17750.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 72</text>
<text text-anchor="middle" x="17750.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="17750.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep4&#45;&gt;layer4_expert_proj_dp0_tp1_ep4 -->
<g id="edge142" class="edge">
<title>layer4_expert_mlp_dp0_tp1_ep4&#45;&gt;layer4_expert_proj_dp0_tp1_ep4</title>
<path fill="none" stroke="black" d="M17934.69,-1672.38C17907.13,-1662.09 17876.6,-1650.68 17848.44,-1640.16"/>
<polygon fill="black" stroke="black" points="17849.58,-1636.85 17838.98,-1636.62 17847.13,-1643.4 17849.58,-1636.85"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep4 -->
<g id="node143" class="node">
<title>layer4_expert_allreduce_dp0_tp1_ep4</title>
<ellipse fill="lightyellow" stroke="black" cx="17613.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="17613.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="17613.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 72</text>
<text text-anchor="middle" x="17613.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="17613.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep4&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep4 -->
<g id="edge143" class="edge">
<title>layer4_expert_proj_dp0_tp1_ep4&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep4</title>
<path fill="none" stroke="black" d="M17711.07,-1568.23C17699.98,-1558.84 17687.63,-1548.37 17675.54,-1538.13"/>
<polygon fill="black" stroke="black" points="17677.54,-1535.24 17667.65,-1531.45 17673.02,-1540.58 17677.54,-1535.24"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep4 -->
<g id="node144" class="node">
<title>layer4_aggregate_dp0_tp1_ep4</title>
<polygon fill="lightpink" stroke="black" points="17911.27,-1400.33 17329.13,-1400.33 17179.38,-1264.33 17761.52,-1264.33 17911.27,-1400.33"/>
<text text-anchor="middle" x="17545.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="17545.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 72</text>
<text text-anchor="middle" x="17545.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="17545.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep4&#45;&gt;layer4_aggregate_dp0_tp1_ep4 -->
<g id="edge144" class="edge">
<title>layer4_expert_allreduce_dp0_tp1_ep4&#45;&gt;layer4_aggregate_dp0_tp1_ep4</title>
<path fill="none" stroke="black" d="M17592,-1436.34C17588.18,-1427.92 17584.12,-1418.95 17580.04,-1409.95"/>
<polygon fill="black" stroke="black" points="17583.11,-1408.24 17575.79,-1400.58 17576.73,-1411.13 17583.11,-1408.24"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep4&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge423" class="edge">
<title>layer4_aggregate_dp0_tp1_ep4&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M17180.24,-1265.3C17176.92,-1264.97 17173.62,-1264.64 17170.33,-1264.33 16558.65,-1206.71 12137.82,-1197.04 11126.17,-1195.58"/>
<polygon fill="black" stroke="black" points="11125.88,-1192.08 11115.88,-1195.56 11125.87,-1199.08 11125.88,-1192.08"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep4&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge455" class="edge">
<title>layer4_aggregate_dp0_tp1_ep4&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M17510.24,-1264.13C17505.47,-1254.99 17500.69,-1245.83 17496.24,-1237.31"/>
<polygon fill="black" stroke="black" points="17499.29,-1235.59 17491.56,-1228.35 17493.09,-1238.83 17499.29,-1235.59"/>
</g>
<!-- layer4_dispatch_dp0_tp1_ep5 -->
<g id="node146" class="node">
<title>layer4_dispatch_dp0_tp1_ep5</title>
<polygon fill="lightgreen" stroke="black" points="19407.48,-1912.5 18720.02,-1912.5 18543.17,-1776.5 19230.63,-1776.5 19407.48,-1912.5"/>
<text text-anchor="middle" x="18975.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="18975.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 73</text>
<text text-anchor="middle" x="18975.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="18975.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp1_ep5&#45;&gt;layer4_dispatch_dp0_tp1_ep5 -->
<g id="edge146" class="edge">
<title>layer4_gate_dp0_tp1_ep5&#45;&gt;layer4_dispatch_dp0_tp1_ep5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18985.61,-1948.31C18984.77,-1939.91 18983.9,-1931.26 18983.05,-1922.72"/>
<polygon fill="black" stroke="black" points="18986.53,-1922.36 18982.05,-1912.76 18979.56,-1923.06 18986.53,-1922.36"/>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep5 -->
<g id="node147" class="node">
<title>layer4_expert_mlp_dp0_tp1_ep5</title>
<polygon fill="lightblue" stroke="black" points="19112.83,-1740.5 18761.83,-1740.5 18761.83,-1672.5 19112.83,-1672.5 19112.83,-1740.5"/>
<text text-anchor="middle" x="18937.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="18937.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 73</text>
<text text-anchor="middle" x="18937.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="18937.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp1_ep5&#45;&gt;layer4_expert_mlp_dp0_tp1_ep5 -->
<g id="edge147" class="edge">
<title>layer4_dispatch_dp0_tp1_ep5&#45;&gt;layer4_expert_mlp_dp0_tp1_ep5</title>
<path fill="none" stroke="black" d="M18956.55,-1776.3C18954.08,-1767.45 18951.6,-1758.58 18949.28,-1750.29"/>
<polygon fill="black" stroke="black" points="18952.61,-1749.21 18946.55,-1740.52 18945.87,-1751.09 18952.61,-1749.21"/>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep5 -->
<g id="node148" class="node">
<title>layer4_expert_proj_dp0_tp1_ep5</title>
<polygon fill="lightblue" stroke="black" points="18695.83,-1636.5 18344.83,-1636.5 18344.83,-1568.5 18695.83,-1568.5 18695.83,-1636.5"/>
<text text-anchor="middle" x="18520.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="18520.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 73</text>
<text text-anchor="middle" x="18520.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="18520.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep5&#45;&gt;layer4_expert_proj_dp0_tp1_ep5 -->
<g id="edge148" class="edge">
<title>layer4_expert_mlp_dp0_tp1_ep5&#45;&gt;layer4_expert_proj_dp0_tp1_ep5</title>
<path fill="none" stroke="black" d="M18802.23,-1672.45C18758.55,-1661.77 18709.94,-1649.88 18665.56,-1639.02"/>
<polygon fill="black" stroke="black" points="18666.11,-1635.56 18655.57,-1636.58 18664.45,-1642.36 18666.11,-1635.56"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep5 -->
<g id="node149" class="node">
<title>layer4_expert_allreduce_dp0_tp1_ep5</title>
<ellipse fill="lightyellow" stroke="black" cx="18334.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="18334.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="18334.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 73</text>
<text text-anchor="middle" x="18334.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="18334.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep5&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep5 -->
<g id="edge149" class="edge">
<title>layer4_expert_proj_dp0_tp1_ep5&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep5</title>
<path fill="none" stroke="black" d="M18467.03,-1568.23C18450.88,-1558.16 18432.77,-1546.86 18415.25,-1535.92"/>
<polygon fill="black" stroke="black" points="18417.04,-1532.91 18406.7,-1530.58 18413.33,-1538.85 18417.04,-1532.91"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep5 -->
<g id="node150" class="node">
<title>layer4_aggregate_dp0_tp1_ep5</title>
<polygon fill="lightpink" stroke="black" points="18661.27,-1400.33 18079.13,-1400.33 17929.38,-1264.33 18511.52,-1264.33 18661.27,-1400.33"/>
<text text-anchor="middle" x="18295.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="18295.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 73</text>
<text text-anchor="middle" x="18295.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="18295.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep5&#45;&gt;layer4_aggregate_dp0_tp1_ep5 -->
<g id="edge150" class="edge">
<title>layer4_expert_allreduce_dp0_tp1_ep5&#45;&gt;layer4_aggregate_dp0_tp1_ep5</title>
<path fill="none" stroke="black" d="M18322.09,-1436.34C18319.95,-1428.1 18317.67,-1419.33 18315.38,-1410.52"/>
<polygon fill="black" stroke="black" points="18318.7,-1409.38 18312.8,-1400.58 18311.93,-1411.14 18318.7,-1409.38"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep5&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge424" class="edge">
<title>layer4_aggregate_dp0_tp1_ep5&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M17930.24,-1265.3C17926.93,-1264.96 17923.62,-1264.64 17920.33,-1264.33 17230.15,-1199.73 12210.42,-1195.47 11126.35,-1195.31"/>
<polygon fill="black" stroke="black" points="11126.12,-1191.81 11116.12,-1195.31 11126.12,-1198.81 11126.12,-1191.81"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep5&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge456" class="edge">
<title>layer4_aggregate_dp0_tp1_ep5&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M17931.14,-1266.14C17927.52,-1265.53 17923.91,-1264.93 17920.33,-1264.33 17841.92,-1251.27 17755.62,-1237.72 17679.99,-1226.13"/>
<polygon fill="black" stroke="black" points="17680.29,-1222.63 17669.87,-1224.58 17679.23,-1229.55 17680.29,-1222.63"/>
</g>
<!-- layer4_dispatch_dp0_tp1_ep6 -->
<g id="node152" class="node">
<title>layer4_dispatch_dp0_tp1_ep6</title>
<polygon fill="lightgreen" stroke="black" points="20290.48,-1912.5 19603.02,-1912.5 19426.17,-1776.5 20113.63,-1776.5 20290.48,-1912.5"/>
<text text-anchor="middle" x="19858.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="19858.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 74</text>
<text text-anchor="middle" x="19858.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="19858.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp1_ep6&#45;&gt;layer4_dispatch_dp0_tp1_ep6 -->
<g id="edge152" class="edge">
<title>layer4_gate_dp0_tp1_ep6&#45;&gt;layer4_dispatch_dp0_tp1_ep6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19868.61,-1948.31C19867.77,-1939.91 19866.9,-1931.26 19866.05,-1922.72"/>
<polygon fill="black" stroke="black" points="19869.53,-1922.36 19865.05,-1912.76 19862.56,-1923.06 19869.53,-1922.36"/>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep6 -->
<g id="node153" class="node">
<title>layer4_expert_mlp_dp0_tp1_ep6</title>
<polygon fill="lightblue" stroke="black" points="19553.83,-1740.5 19202.83,-1740.5 19202.83,-1672.5 19553.83,-1672.5 19553.83,-1740.5"/>
<text text-anchor="middle" x="19378.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="19378.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 74</text>
<text text-anchor="middle" x="19378.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="19378.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp1_ep6&#45;&gt;layer4_expert_mlp_dp0_tp1_ep6 -->
<g id="edge153" class="edge">
<title>layer4_dispatch_dp0_tp1_ep6&#45;&gt;layer4_expert_mlp_dp0_tp1_ep6</title>
<path fill="none" stroke="black" d="M19621.84,-1776.5C19581.5,-1765.07 19541.03,-1753.6 19504.98,-1743.39"/>
<polygon fill="black" stroke="black" points="19505.51,-1739.9 19494.94,-1740.54 19503.6,-1746.63 19505.51,-1739.9"/>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep6 -->
<g id="node154" class="node">
<title>layer4_expert_proj_dp0_tp1_ep6</title>
<polygon fill="lightblue" stroke="black" points="19400.83,-1636.5 19049.83,-1636.5 19049.83,-1568.5 19400.83,-1568.5 19400.83,-1636.5"/>
<text text-anchor="middle" x="19225.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="19225.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 74</text>
<text text-anchor="middle" x="19225.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="19225.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep6&#45;&gt;layer4_expert_proj_dp0_tp1_ep6 -->
<g id="edge154" class="edge">
<title>layer4_expert_mlp_dp0_tp1_ep6&#45;&gt;layer4_expert_proj_dp0_tp1_ep6</title>
<path fill="none" stroke="black" d="M19328.65,-1672.38C19314.28,-1662.8 19298.47,-1652.26 19283.62,-1642.36"/>
<polygon fill="black" stroke="black" points="19285.28,-1639.26 19275.01,-1636.62 19281.39,-1645.08 19285.28,-1639.26"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep6 -->
<g id="node155" class="node">
<title>layer4_expert_allreduce_dp0_tp1_ep6</title>
<ellipse fill="lightyellow" stroke="black" cx="19148.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="19148.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="19148.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 74</text>
<text text-anchor="middle" x="19148.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="19148.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep6&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep6 -->
<g id="edge155" class="edge">
<title>layer4_expert_proj_dp0_tp1_ep6&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep6</title>
<path fill="none" stroke="black" d="M19203.26,-1568.23C19197.61,-1559.72 19191.38,-1550.33 19185.21,-1541.02"/>
<polygon fill="black" stroke="black" points="19188.02,-1538.92 19179.57,-1532.53 19182.19,-1542.79 19188.02,-1538.92"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep6 -->
<g id="node156" class="node">
<title>layer4_aggregate_dp0_tp1_ep6</title>
<polygon fill="lightpink" stroke="black" points="19411.27,-1400.33 18829.13,-1400.33 18679.38,-1264.33 19261.52,-1264.33 19411.27,-1400.33"/>
<text text-anchor="middle" x="19045.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="19045.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 74</text>
<text text-anchor="middle" x="19045.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="19045.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep6&#45;&gt;layer4_aggregate_dp0_tp1_ep6 -->
<g id="edge156" class="edge">
<title>layer4_expert_allreduce_dp0_tp1_ep6&#45;&gt;layer4_aggregate_dp0_tp1_ep6</title>
<path fill="none" stroke="black" d="M19116.02,-1436.34C19110.06,-1427.65 19103.69,-1418.38 19097.32,-1409.1"/>
<polygon fill="black" stroke="black" points="19100.02,-1406.84 19091.48,-1400.58 19094.25,-1410.8 19100.02,-1406.84"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep6&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge425" class="edge">
<title>layer4_aggregate_dp0_tp1_ep6&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M18680.25,-1265.29C18676.93,-1264.96 18673.62,-1264.64 18670.33,-1264.33 18284.56,-1228.41 12318.02,-1201.27 11126.46,-1196.19"/>
<polygon fill="black" stroke="black" points="11126.09,-1192.69 11116.08,-1196.15 11126.06,-1199.69 11126.09,-1192.69"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep6&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge457" class="edge">
<title>layer4_aggregate_dp0_tp1_ep6&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M18680.72,-1265.59C18677.24,-1265.16 18673.77,-1264.74 18670.33,-1264.33 18324.28,-1223.58 17918.95,-1206.62 17680.13,-1199.76"/>
<polygon fill="black" stroke="black" points="17680.03,-1196.26 17669.94,-1199.47 17679.83,-1203.25 17680.03,-1196.26"/>
</g>
<!-- layer4_dispatch_dp0_tp1_ep7 -->
<g id="node158" class="node">
<title>layer4_dispatch_dp0_tp1_ep7</title>
<polygon fill="lightgreen" stroke="black" points="21173.48,-1912.5 20486.02,-1912.5 20309.17,-1776.5 20996.63,-1776.5 21173.48,-1912.5"/>
<text text-anchor="middle" x="20741.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="20741.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 75</text>
<text text-anchor="middle" x="20741.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="20741.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp1_ep7&#45;&gt;layer4_dispatch_dp0_tp1_ep7 -->
<g id="edge158" class="edge">
<title>layer4_gate_dp0_tp1_ep7&#45;&gt;layer4_dispatch_dp0_tp1_ep7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20731.04,-1948.31C20731.89,-1939.91 20732.75,-1931.26 20733.6,-1922.72"/>
<polygon fill="black" stroke="black" points="20737.09,-1923.06 20734.6,-1912.76 20730.12,-1922.36 20737.09,-1923.06"/>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep7 -->
<g id="node159" class="node">
<title>layer4_expert_mlp_dp0_tp1_ep7</title>
<polygon fill="lightblue" stroke="black" points="20798.83,-1740.5 20447.83,-1740.5 20447.83,-1672.5 20798.83,-1672.5 20798.83,-1740.5"/>
<text text-anchor="middle" x="20623.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="20623.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 75</text>
<text text-anchor="middle" x="20623.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="20623.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp1_ep7&#45;&gt;layer4_expert_mlp_dp0_tp1_ep7 -->
<g id="edge159" class="edge">
<title>layer4_dispatch_dp0_tp1_ep7&#45;&gt;layer4_expert_mlp_dp0_tp1_ep7</title>
<path fill="none" stroke="black" d="M20683.02,-1776.3C20674.66,-1766.67 20666.29,-1757.02 20658.57,-1748.12"/>
<polygon fill="black" stroke="black" points="20661.17,-1745.78 20651.97,-1740.52 20655.88,-1750.36 20661.17,-1745.78"/>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep7 -->
<g id="node160" class="node">
<title>layer4_expert_proj_dp0_tp1_ep7</title>
<polygon fill="lightblue" stroke="black" points="20325.83,-1636.5 19974.83,-1636.5 19974.83,-1568.5 20325.83,-1568.5 20325.83,-1636.5"/>
<text text-anchor="middle" x="20150.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="20150.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 75</text>
<text text-anchor="middle" x="20150.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="20150.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep7&#45;&gt;layer4_expert_proj_dp0_tp1_ep7 -->
<g id="edge160" class="edge">
<title>layer4_expert_mlp_dp0_tp1_ep7&#45;&gt;layer4_expert_proj_dp0_tp1_ep7</title>
<path fill="none" stroke="black" d="M20470.08,-1672.45C20420.12,-1661.68 20364.48,-1649.68 20313.8,-1638.75"/>
<polygon fill="black" stroke="black" points="20314.24,-1635.27 20303.73,-1636.58 20312.77,-1642.11 20314.24,-1635.27"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep7 -->
<g id="node161" class="node">
<title>layer4_expert_allreduce_dp0_tp1_ep7</title>
<ellipse fill="lightyellow" stroke="black" cx="19914.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="19914.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="19914.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 75</text>
<text text-anchor="middle" x="19914.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="19914.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep7&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep7 -->
<g id="edge161" class="edge">
<title>layer4_expert_proj_dp0_tp1_ep7&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep7</title>
<path fill="none" stroke="black" d="M20083.01,-1568.39C20061.15,-1557.63 20036.41,-1545.47 20012.76,-1533.83"/>
<polygon fill="black" stroke="black" points="20014.27,-1530.68 20003.76,-1529.4 20011.18,-1536.96 20014.27,-1530.68"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep7 -->
<g id="node162" class="node">
<title>layer4_aggregate_dp0_tp1_ep7</title>
<polygon fill="lightpink" stroke="black" points="20161.27,-1400.33 19579.13,-1400.33 19429.38,-1264.33 20011.52,-1264.33 20161.27,-1400.33"/>
<text text-anchor="middle" x="19795.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="19795.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 75</text>
<text text-anchor="middle" x="19795.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="19795.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep7&#45;&gt;layer4_aggregate_dp0_tp1_ep7 -->
<g id="edge162" class="edge">
<title>layer4_expert_allreduce_dp0_tp1_ep7&#45;&gt;layer4_aggregate_dp0_tp1_ep7</title>
<path fill="none" stroke="black" d="M19877.33,-1436.75C19870.18,-1427.74 19862.53,-1418.1 19854.88,-1408.45"/>
<polygon fill="black" stroke="black" points="19857.42,-1406.01 19848.47,-1400.35 19851.94,-1410.36 19857.42,-1406.01"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep7&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge426" class="edge">
<title>layer4_aggregate_dp0_tp1_ep7&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M19430.25,-1265.29C19426.93,-1264.96 19423.62,-1264.64 19420.33,-1264.33 18994.99,-1224.89 12384.39,-1200.35 11126.25,-1196.02"/>
<polygon fill="black" stroke="black" points="11126.22,-1192.52 11116.21,-1195.99 11126.19,-1199.52 11126.22,-1192.52"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep7&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge458" class="edge">
<title>layer4_aggregate_dp0_tp1_ep7&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M19430.23,-1265.42C19426.92,-1265.05 19423.61,-1264.68 19420.33,-1264.33 19088.15,-1228.95 18109.07,-1207.08 17679.88,-1198.94"/>
<polygon fill="black" stroke="black" points="17679.91,-1195.44 17669.84,-1198.75 17679.78,-1202.44 17679.91,-1195.44"/>
</g>
<!-- layer4_dispatch_dp0_tp1_ep8 -->
<g id="node164" class="node">
<title>layer4_dispatch_dp0_tp1_ep8</title>
<polygon fill="lightgreen" stroke="black" points="22056.48,-1912.5 21369.02,-1912.5 21192.17,-1776.5 21879.63,-1776.5 22056.48,-1912.5"/>
<text text-anchor="middle" x="21624.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="21624.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 76</text>
<text text-anchor="middle" x="21624.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="21624.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp1_ep8&#45;&gt;layer4_dispatch_dp0_tp1_ep8 -->
<g id="edge164" class="edge">
<title>layer4_gate_dp0_tp1_ep8&#45;&gt;layer4_dispatch_dp0_tp1_ep8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21604.37,-1948.31C21606,-1939.91 21607.68,-1931.26 21609.34,-1922.72"/>
<polygon fill="black" stroke="black" points="21612.8,-1923.24 21611.27,-1912.76 21605.93,-1921.91 21612.8,-1923.24"/>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep8 -->
<g id="node165" class="node">
<title>layer4_expert_mlp_dp0_tp1_ep8</title>
<polygon fill="lightblue" stroke="black" points="21615.83,-1740.5 21264.83,-1740.5 21264.83,-1672.5 21615.83,-1672.5 21615.83,-1740.5"/>
<text text-anchor="middle" x="21440.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="21440.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 76</text>
<text text-anchor="middle" x="21440.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="21440.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp1_ep8&#45;&gt;layer4_expert_mlp_dp0_tp1_ep8 -->
<g id="edge165" class="edge">
<title>layer4_dispatch_dp0_tp1_ep8&#45;&gt;layer4_expert_mlp_dp0_tp1_ep8</title>
<path fill="none" stroke="black" d="M21533.67,-1776.5C21519.83,-1766.27 21505.95,-1756.01 21493.28,-1746.64"/>
<polygon fill="black" stroke="black" points="21495.27,-1743.76 21485.15,-1740.63 21491.11,-1749.39 21495.27,-1743.76"/>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep8 -->
<g id="node166" class="node">
<title>layer4_expert_proj_dp0_tp1_ep8</title>
<polygon fill="lightblue" stroke="black" points="21214.83,-1636.5 20863.83,-1636.5 20863.83,-1568.5 21214.83,-1568.5 21214.83,-1636.5"/>
<text text-anchor="middle" x="21039.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="21039.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 76</text>
<text text-anchor="middle" x="21039.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="21039.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep8&#45;&gt;layer4_expert_proj_dp0_tp1_ep8 -->
<g id="edge166" class="edge">
<title>layer4_expert_mlp_dp0_tp1_ep8&#45;&gt;layer4_expert_proj_dp0_tp1_ep8</title>
<path fill="none" stroke="black" d="M21310.41,-1672.45C21268.5,-1661.79 21221.86,-1649.93 21179.26,-1639.09"/>
<polygon fill="black" stroke="black" points="21179.93,-1635.65 21169.38,-1636.58 21178.21,-1642.44 21179.93,-1635.65"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep8 -->
<g id="node167" class="node">
<title>layer4_expert_allreduce_dp0_tp1_ep8</title>
<ellipse fill="lightyellow" stroke="black" cx="20793.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="20793.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="20793.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 76</text>
<text text-anchor="middle" x="20793.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="20793.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep8&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep8 -->
<g id="edge167" class="edge">
<title>layer4_expert_proj_dp0_tp1_ep8&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep8</title>
<path fill="none" stroke="black" d="M20969.16,-1568.39C20946.14,-1557.53 20920.07,-1545.23 20895.2,-1533.49"/>
<polygon fill="black" stroke="black" points="20896.63,-1530.29 20886.09,-1529.19 20893.64,-1536.62 20896.63,-1530.29"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep8 -->
<g id="node168" class="node">
<title>layer4_aggregate_dp0_tp1_ep8</title>
<polygon fill="lightpink" stroke="black" points="20911.27,-1400.33 20329.13,-1400.33 20179.38,-1264.33 20761.52,-1264.33 20911.27,-1400.33"/>
<text text-anchor="middle" x="20545.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="20545.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 76</text>
<text text-anchor="middle" x="20545.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="20545.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep8&#45;&gt;layer4_aggregate_dp0_tp1_ep8 -->
<g id="edge168" class="edge">
<title>layer4_expert_allreduce_dp0_tp1_ep8&#45;&gt;layer4_aggregate_dp0_tp1_ep8</title>
<path fill="none" stroke="black" d="M20718.92,-1438.39C20702,-1428.15 20683.6,-1417.01 20665.32,-1405.95"/>
<polygon fill="black" stroke="black" points="20666.73,-1402.71 20656.37,-1400.53 20663.11,-1408.7 20666.73,-1402.71"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep8&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge427" class="edge">
<title>layer4_aggregate_dp0_tp1_ep8&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M20180.25,-1265.29C20176.93,-1264.96 20173.62,-1264.64 20170.33,-1264.33 19937.5,-1242.82 12469.25,-1203.33 11126.16,-1196.39"/>
<polygon fill="black" stroke="black" points="11125.95,-1192.89 11115.93,-1196.33 11125.91,-1199.89 11125.95,-1192.89"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep8&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge459" class="edge">
<title>layer4_aggregate_dp0_tp1_ep8&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M20180.24,-1265.37C20176.92,-1265.01 20173.62,-1264.67 20170.33,-1264.33 19688.38,-1215.4 18224.07,-1200.49 17680.41,-1196.57"/>
<polygon fill="black" stroke="black" points="17680.13,-1193.07 17670.1,-1196.5 17680.08,-1200.07 17680.13,-1193.07"/>
</g>
<!-- layer4_dispatch_dp0_tp1_ep9 -->
<g id="node170" class="node">
<title>layer4_dispatch_dp0_tp1_ep9</title>
<polygon fill="lightgreen" stroke="black" points="22939.48,-1912.5 22252.02,-1912.5 22075.17,-1776.5 22762.63,-1776.5 22939.48,-1912.5"/>
<text text-anchor="middle" x="22507.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="22507.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 77</text>
<text text-anchor="middle" x="22507.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="22507.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp1_ep9&#45;&gt;layer4_dispatch_dp0_tp1_ep9 -->
<g id="edge170" class="edge">
<title>layer4_gate_dp0_tp1_ep9&#45;&gt;layer4_dispatch_dp0_tp1_ep9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22477.09,-1948.31C22479.59,-1939.81 22482.16,-1931.07 22484.7,-1922.44"/>
<polygon fill="black" stroke="black" points="22488.08,-1923.34 22487.54,-1912.76 22481.37,-1921.36 22488.08,-1923.34"/>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep9 -->
<g id="node171" class="node">
<title>layer4_expert_mlp_dp0_tp1_ep9</title>
<polygon fill="lightblue" stroke="black" points="22615.83,-1740.5 22264.83,-1740.5 22264.83,-1672.5 22615.83,-1672.5 22615.83,-1740.5"/>
<text text-anchor="middle" x="22440.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="22440.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 77</text>
<text text-anchor="middle" x="22440.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="22440.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp1_ep9&#45;&gt;layer4_expert_mlp_dp0_tp1_ep9 -->
<g id="edge171" class="edge">
<title>layer4_dispatch_dp0_tp1_ep9&#45;&gt;layer4_expert_mlp_dp0_tp1_ep9</title>
<path fill="none" stroke="black" d="M22474.22,-1776.3C22469.76,-1767.25 22465.3,-1758.19 22461.14,-1749.75"/>
<polygon fill="black" stroke="black" points="22464.15,-1747.94 22456.59,-1740.52 22457.87,-1751.03 22464.15,-1747.94"/>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep9 -->
<g id="node172" class="node">
<title>layer4_expert_proj_dp0_tp1_ep9</title>
<polygon fill="lightblue" stroke="black" points="22501.83,-1636.5 22150.83,-1636.5 22150.83,-1568.5 22501.83,-1568.5 22501.83,-1636.5"/>
<text text-anchor="middle" x="22326.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="22326.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 77</text>
<text text-anchor="middle" x="22326.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="22326.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep9&#45;&gt;layer4_expert_proj_dp0_tp1_ep9 -->
<g id="edge172" class="edge">
<title>layer4_expert_mlp_dp0_tp1_ep9&#45;&gt;layer4_expert_proj_dp0_tp1_ep9</title>
<path fill="none" stroke="black" d="M22403.31,-1672.38C22393.06,-1663.21 22381.82,-1653.15 22371.17,-1643.62"/>
<polygon fill="black" stroke="black" points="22373.33,-1640.86 22363.54,-1636.8 22368.66,-1646.08 22373.33,-1640.86"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep9 -->
<g id="node173" class="node">
<title>layer4_expert_allreduce_dp0_tp1_ep9</title>
<ellipse fill="lightyellow" stroke="black" cx="22098.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="22098.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="22098.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 77</text>
<text text-anchor="middle" x="22098.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="22098.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep9&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep9 -->
<g id="edge173" class="edge">
<title>layer4_expert_proj_dp0_tp1_ep9&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep9</title>
<path fill="none" stroke="black" d="M22261.3,-1568.39C22240.38,-1557.74 22216.75,-1545.71 22194.1,-1534.18"/>
<polygon fill="black" stroke="black" points="22195.65,-1531.04 22185.15,-1529.62 22192.47,-1537.28 22195.65,-1531.04"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep9 -->
<g id="node174" class="node">
<title>layer4_aggregate_dp0_tp1_ep9</title>
<polygon fill="lightpink" stroke="black" points="21661.27,-1400.33 21079.13,-1400.33 20929.38,-1264.33 21511.52,-1264.33 21661.27,-1400.33"/>
<text text-anchor="middle" x="21295.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="21295.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 77</text>
<text text-anchor="middle" x="21295.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="21295.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep9&#45;&gt;layer4_aggregate_dp0_tp1_ep9 -->
<g id="edge174" class="edge">
<title>layer4_expert_allreduce_dp0_tp1_ep9&#45;&gt;layer4_aggregate_dp0_tp1_ep9</title>
<path fill="none" stroke="black" d="M21922.1,-1450.48C21846.01,-1436.26 21753.96,-1419.05 21664.1,-1402.26"/>
<polygon fill="black" stroke="black" points="21664.48,-1398.77 21654.01,-1400.37 21663.19,-1405.65 21664.48,-1398.77"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep9&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge428" class="edge">
<title>layer4_aggregate_dp0_tp1_ep9&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M20930.25,-1265.28C20926.93,-1264.95 20923.62,-1264.64 20920.33,-1264.33 20667.65,-1241.06 12532.24,-1202.73 11126.29,-1196.27"/>
<polygon fill="black" stroke="black" points="11126.11,-1192.77 11116.09,-1196.22 11126.08,-1199.77 11126.11,-1192.77"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep9&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge460" class="edge">
<title>layer4_aggregate_dp0_tp1_ep9&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M20930.24,-1265.35C20926.92,-1265 20923.62,-1264.66 20920.33,-1264.33 20286.3,-1201.74 18322.73,-1195.53 17680.17,-1195.22"/>
<polygon fill="black" stroke="black" points="17679.87,-1191.72 17669.87,-1195.22 17679.87,-1198.72 17679.87,-1191.72"/>
</g>
<!-- layer4_dispatch_dp0_tp1_ep10 -->
<g id="node176" class="node">
<title>layer4_dispatch_dp0_tp1_ep10</title>
<polygon fill="lightgreen" stroke="black" points="23822.48,-1912.5 23135.02,-1912.5 22958.17,-1776.5 23645.63,-1776.5 23822.48,-1912.5"/>
<text text-anchor="middle" x="23390.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="23390.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 78</text>
<text text-anchor="middle" x="23390.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="23390.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp1_ep10&#45;&gt;layer4_dispatch_dp0_tp1_ep10 -->
<g id="edge176" class="edge">
<title>layer4_gate_dp0_tp1_ep10&#45;&gt;layer4_dispatch_dp0_tp1_ep10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23355.25,-1948.31C23358.15,-1939.81 23361.13,-1931.07 23364.08,-1922.44"/>
<polygon fill="black" stroke="black" points="23367.46,-1923.35 23367.38,-1912.76 23360.84,-1921.09 23367.46,-1923.35"/>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep10 -->
<g id="node177" class="node">
<title>layer4_expert_mlp_dp0_tp1_ep10</title>
<polygon fill="lightblue" stroke="black" points="23384.83,-1740.5 23033.83,-1740.5 23033.83,-1672.5 23384.83,-1672.5 23384.83,-1740.5"/>
<text text-anchor="middle" x="23209.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="23209.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 78</text>
<text text-anchor="middle" x="23209.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="23209.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp1_ep10&#45;&gt;layer4_expert_mlp_dp0_tp1_ep10 -->
<g id="edge177" class="edge">
<title>layer4_dispatch_dp0_tp1_ep10&#45;&gt;layer4_expert_mlp_dp0_tp1_ep10</title>
<path fill="none" stroke="black" d="M23301.15,-1776.5C23287.54,-1766.27 23273.88,-1756.01 23261.42,-1746.64"/>
<polygon fill="black" stroke="black" points="23263.51,-1743.84 23253.41,-1740.63 23259.31,-1749.43 23263.51,-1743.84"/>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep10 -->
<g id="node178" class="node">
<title>layer4_expert_proj_dp0_tp1_ep10</title>
<polygon fill="lightblue" stroke="black" points="23218.83,-1636.5 22867.83,-1636.5 22867.83,-1568.5 23218.83,-1568.5 23218.83,-1636.5"/>
<text text-anchor="middle" x="23043.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="23043.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 78</text>
<text text-anchor="middle" x="23043.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="23043.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep10&#45;&gt;layer4_expert_proj_dp0_tp1_ep10 -->
<g id="edge178" class="edge">
<title>layer4_expert_mlp_dp0_tp1_ep10&#45;&gt;layer4_expert_proj_dp0_tp1_ep10</title>
<path fill="none" stroke="black" d="M23155.43,-1672.38C23139.69,-1662.71 23122.36,-1652.06 23106.12,-1642.09"/>
<polygon fill="black" stroke="black" points="23107.59,-1638.88 23097.23,-1636.62 23103.92,-1644.84 23107.59,-1638.88"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep10 -->
<g id="node179" class="node">
<title>layer4_expert_allreduce_dp0_tp1_ep10</title>
<ellipse fill="lightyellow" stroke="black" cx="22784.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="22784.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="22784.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 78</text>
<text text-anchor="middle" x="22784.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="22784.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep10&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep10 -->
<g id="edge179" class="edge">
<title>layer4_expert_proj_dp0_tp1_ep10&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep10</title>
<path fill="none" stroke="black" d="M22969.45,-1568.39C22944.84,-1557.36 22916.92,-1544.85 22890.37,-1532.94"/>
<polygon fill="black" stroke="black" points="22891.6,-1529.66 22881.04,-1528.76 22888.73,-1536.05 22891.6,-1529.66"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep10 -->
<g id="node180" class="node">
<title>layer4_aggregate_dp0_tp1_ep10</title>
<polygon fill="lightpink" stroke="black" points="22411.27,-1400.33 21829.13,-1400.33 21679.38,-1264.33 22261.52,-1264.33 22411.27,-1400.33"/>
<text text-anchor="middle" x="22045.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="22045.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 78</text>
<text text-anchor="middle" x="22045.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="22045.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep10&#45;&gt;layer4_aggregate_dp0_tp1_ep10 -->
<g id="edge180" class="edge">
<title>layer4_expert_allreduce_dp0_tp1_ep10&#45;&gt;layer4_aggregate_dp0_tp1_ep10</title>
<path fill="none" stroke="black" d="M22615.25,-1449.08C22546.81,-1435.18 22465.22,-1418.61 22385.46,-1402.41"/>
<polygon fill="black" stroke="black" points="22385.74,-1398.9 22375.24,-1400.34 22384.34,-1405.76 22385.74,-1398.9"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep10&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge429" class="edge">
<title>layer4_aggregate_dp0_tp1_ep10&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M21680.25,-1265.28C21676.93,-1264.95 21673.62,-1264.64 21670.33,-1264.33 21533.95,-1251.8 12603.46,-1204.21 11126.22,-1196.42"/>
<polygon fill="black" stroke="black" points="11126.06,-1192.91 11116.04,-1196.36 11126.02,-1199.91 11126.06,-1192.91"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep10&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge461" class="edge">
<title>layer4_aggregate_dp0_tp1_ep10&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M21680.24,-1265.33C21676.92,-1264.98 21673.62,-1264.65 21670.33,-1264.33 21272.11,-1225.74 18468.21,-1202.58 17680,-1196.78"/>
<polygon fill="black" stroke="black" points="17679.99,-1193.28 17669.96,-1196.7 17679.94,-1200.28 17679.99,-1193.28"/>
</g>
<!-- layer4_dispatch_dp0_tp1_ep11 -->
<g id="node182" class="node">
<title>layer4_dispatch_dp0_tp1_ep11</title>
<polygon fill="lightgreen" stroke="black" points="24705.48,-1912.5 24018.02,-1912.5 23841.17,-1776.5 24528.63,-1776.5 24705.48,-1912.5"/>
<text text-anchor="middle" x="24273.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="24273.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 79</text>
<text text-anchor="middle" x="24273.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="24273.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp1_ep11&#45;&gt;layer4_dispatch_dp0_tp1_ep11 -->
<g id="edge182" class="edge">
<title>layer4_gate_dp0_tp1_ep11&#45;&gt;layer4_dispatch_dp0_tp1_ep11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24235.83,-1948.31C24238.96,-1939.72 24242.19,-1930.88 24245.37,-1922.16"/>
<polygon fill="black" stroke="black" points="24248.66,-1923.35 24248.8,-1912.76 24242.08,-1920.95 24248.66,-1923.35"/>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep11 -->
<g id="node183" class="node">
<title>layer4_expert_mlp_dp0_tp1_ep11</title>
<polygon fill="lightblue" stroke="black" points="24121.83,-1740.5 23770.83,-1740.5 23770.83,-1672.5 24121.83,-1672.5 24121.83,-1740.5"/>
<text text-anchor="middle" x="23946.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="23946.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 79</text>
<text text-anchor="middle" x="23946.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="23946.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp1_ep11&#45;&gt;layer4_expert_mlp_dp0_tp1_ep11 -->
<g id="edge183" class="edge">
<title>layer4_dispatch_dp0_tp1_ep11&#45;&gt;layer4_expert_mlp_dp0_tp1_ep11</title>
<path fill="none" stroke="black" d="M24112.22,-1776.5C24085.75,-1765.49 24059.19,-1754.44 24035.33,-1744.52"/>
<polygon fill="black" stroke="black" points="24036.56,-1741.24 24025.98,-1740.63 24033.87,-1747.7 24036.56,-1741.24"/>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep11 -->
<g id="node184" class="node">
<title>layer4_expert_proj_dp0_tp1_ep11</title>
<polygon fill="lightblue" stroke="black" points="23659.83,-1636.5 23308.83,-1636.5 23308.83,-1568.5 23659.83,-1568.5 23659.83,-1636.5"/>
<text text-anchor="middle" x="23484.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="23484.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 79</text>
<text text-anchor="middle" x="23484.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="23484.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep11&#45;&gt;layer4_expert_proj_dp0_tp1_ep11 -->
<g id="edge184" class="edge">
<title>layer4_expert_mlp_dp0_tp1_ep11&#45;&gt;layer4_expert_proj_dp0_tp1_ep11</title>
<path fill="none" stroke="black" d="M23796.65,-1672.45C23747.85,-1661.68 23693.5,-1649.68 23644,-1638.75"/>
<polygon fill="black" stroke="black" points="23644.68,-1635.32 23634.16,-1636.58 23643.17,-1642.15 23644.68,-1635.32"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep11 -->
<g id="node185" class="node">
<title>layer4_expert_allreduce_dp0_tp1_ep11</title>
<ellipse fill="lightyellow" stroke="black" cx="23401.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="23401.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="23401.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 79</text>
<text text-anchor="middle" x="23401.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="23401.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep11&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep11 -->
<g id="edge185" class="edge">
<title>layer4_expert_proj_dp0_tp1_ep11&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep11</title>
<path fill="none" stroke="black" d="M23460.54,-1568.23C23454.32,-1559.53 23447.44,-1549.91 23440.64,-1540.4"/>
<polygon fill="black" stroke="black" points="23443.36,-1538.19 23434.7,-1532.09 23437.67,-1542.26 23443.36,-1538.19"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep11 -->
<g id="node186" class="node">
<title>layer4_aggregate_dp0_tp1_ep11</title>
<polygon fill="lightpink" stroke="black" points="23161.27,-1400.33 22579.13,-1400.33 22429.38,-1264.33 23011.52,-1264.33 23161.27,-1400.33"/>
<text text-anchor="middle" x="22795.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="22795.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 79</text>
<text text-anchor="middle" x="22795.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="22795.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep11&#45;&gt;layer4_aggregate_dp0_tp1_ep11 -->
<g id="edge186" class="edge">
<title>layer4_expert_allreduce_dp0_tp1_ep11&#45;&gt;layer4_aggregate_dp0_tp1_ep11</title>
<path fill="none" stroke="black" d="M23250.75,-1446.12C23197.7,-1432.99 23136.23,-1417.76 23075.95,-1402.83"/>
<polygon fill="black" stroke="black" points="23076.44,-1399.35 23065.89,-1400.34 23074.76,-1406.14 23076.44,-1399.35"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep11&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge430" class="edge">
<title>layer4_aggregate_dp0_tp1_ep11&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M22430.25,-1265.28C22426.93,-1264.95 22423.62,-1264.63 22420.33,-1264.33 22347.13,-1257.62 12666.66,-1204.81 11125.94,-1196.45"/>
<polygon fill="black" stroke="black" points="11125.9,-1192.95 11115.88,-1196.39 11125.87,-1199.95 11125.9,-1192.95"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep11&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge462" class="edge">
<title>layer4_aggregate_dp0_tp1_ep11&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M22430.24,-1265.32C22426.92,-1264.98 22423.62,-1264.65 22420.33,-1264.33 21944.54,-1218.82 18555.78,-1200.28 17680.32,-1196.22"/>
<polygon fill="black" stroke="black" points="17680.15,-1192.72 17670.14,-1196.18 17680.12,-1199.72 17680.15,-1192.72"/>
</g>
<!-- layer4_dispatch_dp0_tp1_ep12 -->
<g id="node188" class="node">
<title>layer4_dispatch_dp0_tp1_ep12</title>
<polygon fill="lightgreen" stroke="black" points="25588.48,-1912.5 24901.02,-1912.5 24724.17,-1776.5 25411.63,-1776.5 25588.48,-1912.5"/>
<text text-anchor="middle" x="25156.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="25156.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 80</text>
<text text-anchor="middle" x="25156.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="25156.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp1_ep12&#45;&gt;layer4_dispatch_dp0_tp1_ep12 -->
<g id="edge188" class="edge">
<title>layer4_gate_dp0_tp1_ep12&#45;&gt;layer4_dispatch_dp0_tp1_ep12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M25117.62,-1948.31C25120.85,-1939.72 25124.18,-1930.88 25127.47,-1922.16"/>
<polygon fill="black" stroke="black" points="25130.76,-1923.35 25131.01,-1912.76 25124.21,-1920.88 25130.76,-1923.35"/>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep12 -->
<g id="node189" class="node">
<title>layer4_expert_mlp_dp0_tp1_ep12</title>
<polygon fill="lightblue" stroke="black" points="24707.83,-1740.5 24356.83,-1740.5 24356.83,-1672.5 24707.83,-1672.5 24707.83,-1740.5"/>
<text text-anchor="middle" x="24532.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="24532.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 80</text>
<text text-anchor="middle" x="24532.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="24532.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp1_ep12&#45;&gt;layer4_expert_mlp_dp0_tp1_ep12 -->
<g id="edge189" class="edge">
<title>layer4_dispatch_dp0_tp1_ep12&#45;&gt;layer4_expert_mlp_dp0_tp1_ep12</title>
<path fill="none" stroke="black" d="M24848.9,-1776.5C24795.33,-1764.82 24741.59,-1753.11 24693.98,-1742.73"/>
<polygon fill="black" stroke="black" points="24694.44,-1739.25 24683.92,-1740.54 24692.94,-1746.09 24694.44,-1739.25"/>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep12 -->
<g id="node190" class="node">
<title>layer4_expert_proj_dp0_tp1_ep12</title>
<polygon fill="lightblue" stroke="black" points="24357.83,-1636.5 24006.83,-1636.5 24006.83,-1568.5 24357.83,-1568.5 24357.83,-1636.5"/>
<text text-anchor="middle" x="24182.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="24182.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 80</text>
<text text-anchor="middle" x="24182.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="24182.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep12&#45;&gt;layer4_expert_proj_dp0_tp1_ep12 -->
<g id="edge190" class="edge">
<title>layer4_expert_mlp_dp0_tp1_ep12&#45;&gt;layer4_expert_proj_dp0_tp1_ep12</title>
<path fill="none" stroke="black" d="M24418.69,-1672.38C24382.5,-1661.84 24342.31,-1650.12 24305.48,-1639.39"/>
<polygon fill="black" stroke="black" points="24306.27,-1635.97 24295.69,-1636.54 24304.31,-1642.7 24306.27,-1635.97"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep12 -->
<g id="node191" class="node">
<title>layer4_expert_allreduce_dp0_tp1_ep12</title>
<ellipse fill="lightyellow" stroke="black" cx="24001.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="24001.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="24001.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 80</text>
<text text-anchor="middle" x="24001.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="24001.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep12&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep12 -->
<g id="edge191" class="edge">
<title>layer4_expert_proj_dp0_tp1_ep12&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep12</title>
<path fill="none" stroke="black" d="M24130.46,-1568.23C24114.89,-1558.25 24097.45,-1547.06 24080.54,-1536.22"/>
<polygon fill="black" stroke="black" points="24082.06,-1533.04 24071.75,-1530.58 24078.28,-1538.93 24082.06,-1533.04"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep12 -->
<g id="node192" class="node">
<title>layer4_aggregate_dp0_tp1_ep12</title>
<polygon fill="lightpink" stroke="black" points="23911.27,-1400.33 23329.13,-1400.33 23179.38,-1264.33 23761.52,-1264.33 23911.27,-1400.33"/>
<text text-anchor="middle" x="23545.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="23545.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 80</text>
<text text-anchor="middle" x="23545.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="23545.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep12&#45;&gt;layer4_aggregate_dp0_tp1_ep12 -->
<g id="edge192" class="edge">
<title>layer4_expert_allreduce_dp0_tp1_ep12&#45;&gt;layer4_aggregate_dp0_tp1_ep12</title>
<path fill="none" stroke="black" d="M23877.63,-1442.7C23840.8,-1430.58 23799.35,-1416.94 23758.53,-1403.5"/>
<polygon fill="black" stroke="black" points="23759.6,-1400.17 23749.01,-1400.37 23757.41,-1406.82 23759.6,-1400.17"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep12&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge431" class="edge">
<title>layer4_aggregate_dp0_tp1_ep12&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M23180.25,-1265.28C23176.93,-1264.95 23173.62,-1264.63 23170.33,-1264.33 23131.23,-1260.76 12727.91,-1205 11126.27,-1196.43"/>
<polygon fill="black" stroke="black" points="11126.13,-1192.93 11116.11,-1196.38 11126.09,-1199.93 11126.13,-1192.93"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep12&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge463" class="edge">
<title>layer4_aggregate_dp0_tp1_ep12&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M23180.24,-1265.31C23176.92,-1264.97 23173.62,-1264.64 23170.33,-1264.33 22616.48,-1211.86 18635.71,-1198.32 17680.14,-1195.81"/>
<polygon fill="black" stroke="black" points="17680.08,-1192.31 17670.07,-1195.79 17680.06,-1199.31 17680.08,-1192.31"/>
</g>
<!-- layer4_dispatch_dp0_tp1_ep13 -->
<g id="node194" class="node">
<title>layer4_dispatch_dp0_tp1_ep13</title>
<polygon fill="lightgreen" stroke="black" points="26471.48,-1912.5 25784.02,-1912.5 25607.17,-1776.5 26294.63,-1776.5 26471.48,-1912.5"/>
<text text-anchor="middle" x="26039.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="26039.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 81</text>
<text text-anchor="middle" x="26039.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="26039.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp1_ep13&#45;&gt;layer4_dispatch_dp0_tp1_ep13 -->
<g id="edge194" class="edge">
<title>layer4_gate_dp0_tp1_ep13&#45;&gt;layer4_dispatch_dp0_tp1_ep13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M25999.41,-1948.31C26002.75,-1939.72 26006.18,-1930.88 26009.56,-1922.16"/>
<polygon fill="black" stroke="black" points="26012.86,-1923.35 26013.21,-1912.76 26006.33,-1920.81 26012.86,-1923.35"/>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep13 -->
<g id="node195" class="node">
<title>layer4_expert_mlp_dp0_tp1_ep13</title>
<polygon fill="lightblue" stroke="black" points="25148.83,-1740.5 24797.83,-1740.5 24797.83,-1672.5 25148.83,-1672.5 25148.83,-1740.5"/>
<text text-anchor="middle" x="24973.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="24973.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 81</text>
<text text-anchor="middle" x="24973.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="24973.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp1_ep13&#45;&gt;layer4_expert_mlp_dp0_tp1_ep13 -->
<g id="edge195" class="edge">
<title>layer4_dispatch_dp0_tp1_ep13&#45;&gt;layer4_expert_mlp_dp0_tp1_ep13</title>
<path fill="none" stroke="black" d="M25608.94,-1777.91C25605.05,-1777.43 25601.18,-1776.96 25597.33,-1776.5 25418.35,-1754.98 25372.32,-1761.88 25193.33,-1740.5 25182.2,-1739.17 25170.78,-1737.72 25159.26,-1736.19"/>
<polygon fill="black" stroke="black" points="25159.5,-1732.69 25149.12,-1734.83 25158.56,-1739.63 25159.5,-1732.69"/>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep13 -->
<g id="node196" class="node">
<title>layer4_expert_proj_dp0_tp1_ep13</title>
<polygon fill="lightblue" stroke="black" points="24798.83,-1636.5 24447.83,-1636.5 24447.83,-1568.5 24798.83,-1568.5 24798.83,-1636.5"/>
<text text-anchor="middle" x="24623.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="24623.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 81</text>
<text text-anchor="middle" x="24623.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="24623.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep13&#45;&gt;layer4_expert_proj_dp0_tp1_ep13 -->
<g id="edge196" class="edge">
<title>layer4_expert_mlp_dp0_tp1_ep13&#45;&gt;layer4_expert_proj_dp0_tp1_ep13</title>
<path fill="none" stroke="black" d="M24859.69,-1672.38C24823.5,-1661.84 24783.31,-1650.12 24746.48,-1639.39"/>
<polygon fill="black" stroke="black" points="24747.27,-1635.97 24736.69,-1636.54 24745.31,-1642.7 24747.27,-1635.97"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep13 -->
<g id="node197" class="node">
<title>layer4_expert_allreduce_dp0_tp1_ep13</title>
<ellipse fill="lightyellow" stroke="black" cx="24558.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="24558.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="24558.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 81</text>
<text text-anchor="middle" x="24558.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="24558.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep13&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep13 -->
<g id="edge197" class="edge">
<title>layer4_expert_proj_dp0_tp1_ep13&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep13</title>
<path fill="none" stroke="black" d="M24604.7,-1568.23C24599.98,-1559.81 24594.78,-1550.52 24589.62,-1541.31"/>
<polygon fill="black" stroke="black" points="24592.64,-1539.54 24584.7,-1532.53 24586.54,-1542.96 24592.64,-1539.54"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep13 -->
<g id="node198" class="node">
<title>layer4_aggregate_dp0_tp1_ep13</title>
<polygon fill="lightpink" stroke="black" points="24661.27,-1400.33 24079.13,-1400.33 23929.38,-1264.33 24511.52,-1264.33 24661.27,-1400.33"/>
<text text-anchor="middle" x="24295.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="24295.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 81</text>
<text text-anchor="middle" x="24295.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="24295.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep13&#45;&gt;layer4_aggregate_dp0_tp1_ep13 -->
<g id="edge198" class="edge">
<title>layer4_expert_allreduce_dp0_tp1_ep13&#45;&gt;layer4_aggregate_dp0_tp1_ep13</title>
<path fill="none" stroke="black" d="M24479.77,-1438.59C24461.45,-1428.13 24441.47,-1416.73 24421.65,-1405.42"/>
<polygon fill="black" stroke="black" points="24423.29,-1402.33 24412.87,-1400.41 24419.82,-1408.41 24423.29,-1402.33"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep13&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge432" class="edge">
<title>layer4_aggregate_dp0_tp1_ep13&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M23930.25,-1265.28C23926.93,-1264.95 23923.62,-1264.63 23920.33,-1264.33 23909.93,-1263.38 12784.98,-1205.1 11126.16,-1196.41"/>
<polygon fill="black" stroke="black" points="11125.96,-1192.91 11115.94,-1196.36 11125.92,-1199.91 11125.96,-1192.91"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep13&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge464" class="edge">
<title>layer4_aggregate_dp0_tp1_ep13&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M23930.24,-1265.3C23926.92,-1264.97 23923.62,-1264.64 23920.33,-1264.33 23288.17,-1204.89 18711.3,-1196.61 17680.26,-1195.5"/>
<polygon fill="black" stroke="black" points="17680.15,-1192 17670.14,-1195.49 17680.14,-1199 17680.15,-1192"/>
</g>
<!-- layer4_dispatch_dp0_tp1_ep14 -->
<g id="node200" class="node">
<title>layer4_dispatch_dp0_tp1_ep14</title>
<polygon fill="lightgreen" stroke="black" points="27354.48,-1912.5 26667.02,-1912.5 26490.17,-1776.5 27177.63,-1776.5 27354.48,-1912.5"/>
<text text-anchor="middle" x="26922.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="26922.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 82</text>
<text text-anchor="middle" x="26922.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="26922.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp1_ep14&#45;&gt;layer4_dispatch_dp0_tp1_ep14 -->
<g id="edge200" class="edge">
<title>layer4_gate_dp0_tp1_ep14&#45;&gt;layer4_dispatch_dp0_tp1_ep14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26882.41,-1948.31C26885.75,-1939.72 26889.18,-1930.88 26892.56,-1922.16"/>
<polygon fill="black" stroke="black" points="26895.86,-1923.35 26896.21,-1912.76 26889.33,-1920.81 26895.86,-1923.35"/>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep14 -->
<g id="node201" class="node">
<title>layer4_expert_mlp_dp0_tp1_ep14</title>
<polygon fill="lightblue" stroke="black" points="25553.83,-1740.5 25202.83,-1740.5 25202.83,-1672.5 25553.83,-1672.5 25553.83,-1740.5"/>
<text text-anchor="middle" x="25378.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="25378.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 82</text>
<text text-anchor="middle" x="25378.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="25378.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp1_ep14&#45;&gt;layer4_expert_mlp_dp0_tp1_ep14 -->
<g id="edge201" class="edge">
<title>layer4_dispatch_dp0_tp1_ep14&#45;&gt;layer4_expert_mlp_dp0_tp1_ep14</title>
<path fill="none" stroke="black" d="M26491.66,-1777.73C26487.87,-1777.31 26484.09,-1776.9 26480.33,-1776.5 26159.08,-1742.16 25783.2,-1723.13 25563.84,-1714.13"/>
<polygon fill="black" stroke="black" points="25563.98,-1710.64 25553.84,-1713.73 25563.69,-1717.63 25563.98,-1710.64"/>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep14 -->
<g id="node202" class="node">
<title>layer4_expert_proj_dp0_tp1_ep14</title>
<polygon fill="lightblue" stroke="black" points="25363.83,-1636.5 25012.83,-1636.5 25012.83,-1568.5 25363.83,-1568.5 25363.83,-1636.5"/>
<text text-anchor="middle" x="25188.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="25188.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 82</text>
<text text-anchor="middle" x="25188.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="25188.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep14&#45;&gt;layer4_expert_proj_dp0_tp1_ep14 -->
<g id="edge202" class="edge">
<title>layer4_expert_mlp_dp0_tp1_ep14&#45;&gt;layer4_expert_proj_dp0_tp1_ep14</title>
<path fill="none" stroke="black" d="M25316.64,-1672.38C25298.21,-1662.49 25277.87,-1651.57 25258.92,-1641.4"/>
<polygon fill="black" stroke="black" points="25260.5,-1638.27 25250.03,-1636.62 25257.18,-1644.44 25260.5,-1638.27"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep14 -->
<g id="node203" class="node">
<title>layer4_expert_allreduce_dp0_tp1_ep14</title>
<ellipse fill="lightyellow" stroke="black" cx="25093.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="25093.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="25093.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 82</text>
<text text-anchor="middle" x="25093.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="25093.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep14&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep14 -->
<g id="edge203" class="edge">
<title>layer4_expert_proj_dp0_tp1_ep14&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep14</title>
<path fill="none" stroke="black" d="M25161.1,-1568.23C25153.91,-1559.44 25145.95,-1549.71 25138.09,-1540.11"/>
<polygon fill="black" stroke="black" points="25140.57,-1537.62 25131.53,-1532.09 25135.15,-1542.05 25140.57,-1537.62"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep14 -->
<g id="node204" class="node">
<title>layer4_aggregate_dp0_tp1_ep14</title>
<polygon fill="lightpink" stroke="black" points="25411.27,-1400.33 24829.13,-1400.33 24679.38,-1264.33 25261.52,-1264.33 25411.27,-1400.33"/>
<text text-anchor="middle" x="25045.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="25045.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 82</text>
<text text-anchor="middle" x="25045.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="25045.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep14&#45;&gt;layer4_aggregate_dp0_tp1_ep14 -->
<g id="edge204" class="edge">
<title>layer4_expert_allreduce_dp0_tp1_ep14&#45;&gt;layer4_aggregate_dp0_tp1_ep14</title>
<path fill="none" stroke="black" d="M25078.27,-1436.34C25075.61,-1428.01 25072.77,-1419.14 25069.92,-1410.23"/>
<polygon fill="black" stroke="black" points="25073.21,-1409.04 25066.83,-1400.58 25066.55,-1411.17 25073.21,-1409.04"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep14&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge433" class="edge">
<title>layer4_aggregate_dp0_tp1_ep14&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M24680.25,-1265.27C24676.93,-1264.95 24673.62,-1264.63 24670.33,-1264.33 24260.85,-1227.04 17680.49,-1230.4 17269.33,-1228.33 14853,-1216.18 11919.41,-1200.64 11126.24,-1196.43"/>
<polygon fill="black" stroke="black" points="11126.17,-1192.93 11116.15,-1196.37 11126.13,-1199.93 11126.17,-1192.93"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep14&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge465" class="edge">
<title>layer4_aggregate_dp0_tp1_ep14&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M24680.24,-1265.3C24676.93,-1264.96 24673.62,-1264.64 24670.33,-1264.33 23959.57,-1197.9 18782.35,-1195.09 17680.27,-1195.25"/>
<polygon fill="black" stroke="black" points="17680.26,-1191.75 17670.26,-1195.25 17680.27,-1198.75 17680.26,-1191.75"/>
</g>
<!-- layer4_dispatch_dp0_tp1_ep15 -->
<g id="node206" class="node">
<title>layer4_dispatch_dp0_tp1_ep15</title>
<polygon fill="lightgreen" stroke="black" points="28237.48,-1912.5 27550.02,-1912.5 27373.17,-1776.5 28060.63,-1776.5 28237.48,-1912.5"/>
<text text-anchor="middle" x="27805.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="27805.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 83</text>
<text text-anchor="middle" x="27805.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="27805.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp0_tp1_ep15&#45;&gt;layer4_dispatch_dp0_tp1_ep15 -->
<g id="edge206" class="edge">
<title>layer4_gate_dp0_tp1_ep15&#45;&gt;layer4_dispatch_dp0_tp1_ep15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27765.41,-1948.31C27768.75,-1939.72 27772.18,-1930.88 27775.56,-1922.16"/>
<polygon fill="black" stroke="black" points="27778.86,-1923.35 27779.21,-1912.76 27772.33,-1920.81 27778.86,-1923.35"/>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep15 -->
<g id="node207" class="node">
<title>layer4_expert_mlp_dp0_tp1_ep15</title>
<polygon fill="lightblue" stroke="black" points="27728.83,-1740.5 27377.83,-1740.5 27377.83,-1672.5 27728.83,-1672.5 27728.83,-1740.5"/>
<text text-anchor="middle" x="27553.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="27553.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 83</text>
<text text-anchor="middle" x="27553.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="27553.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp0_tp1_ep15&#45;&gt;layer4_expert_mlp_dp0_tp1_ep15 -->
<g id="edge207" class="edge">
<title>layer4_dispatch_dp0_tp1_ep15&#45;&gt;layer4_expert_mlp_dp0_tp1_ep15</title>
<path fill="none" stroke="black" d="M27681.17,-1776.5C27661.49,-1765.88 27641.76,-1755.22 27623.88,-1745.58"/>
<polygon fill="black" stroke="black" points="27625.17,-1742.3 27614.71,-1740.63 27621.85,-1748.46 27625.17,-1742.3"/>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep15 -->
<g id="node208" class="node">
<title>layer4_expert_proj_dp0_tp1_ep15</title>
<polygon fill="lightblue" stroke="black" points="26723.83,-1636.5 26372.83,-1636.5 26372.83,-1568.5 26723.83,-1568.5 26723.83,-1636.5"/>
<text text-anchor="middle" x="26548.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="26548.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 83</text>
<text text-anchor="middle" x="26548.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="26548.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp0_tp1_ep15&#45;&gt;layer4_expert_proj_dp0_tp1_ep15 -->
<g id="edge208" class="edge">
<title>layer4_expert_mlp_dp0_tp1_ep15&#45;&gt;layer4_expert_proj_dp0_tp1_ep15</title>
<path fill="none" stroke="black" d="M27377.69,-1687.67C27197.44,-1669.38 26918.06,-1641.02 26734.17,-1622.36"/>
<polygon fill="black" stroke="black" points="26734.42,-1618.87 26724.12,-1621.34 26733.71,-1625.83 26734.42,-1618.87"/>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep15 -->
<g id="node209" class="node">
<title>layer4_expert_allreduce_dp0_tp1_ep15</title>
<ellipse fill="lightyellow" stroke="black" cx="26046.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="26046.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="26046.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 83</text>
<text text-anchor="middle" x="26046.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="26046.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp0_tp1_ep15&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep15 -->
<g id="edge209" class="edge">
<title>layer4_expert_proj_dp0_tp1_ep15&#45;&gt;layer4_expert_allreduce_dp0_tp1_ep15</title>
<path fill="none" stroke="black" d="M26405.48,-1568.47C26345.64,-1554.63 26275.66,-1538.45 26213.45,-1524.06"/>
<polygon fill="black" stroke="black" points="26214.07,-1520.61 26203.54,-1521.77 26212.49,-1527.43 26214.07,-1520.61"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep15 -->
<g id="node210" class="node">
<title>layer4_aggregate_dp0_tp1_ep15</title>
<polygon fill="lightpink" stroke="black" points="26161.27,-1400.33 25579.13,-1400.33 25429.38,-1264.33 26011.52,-1264.33 26161.27,-1400.33"/>
<text text-anchor="middle" x="25795.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="25795.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 83</text>
<text text-anchor="middle" x="25795.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="25795.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp0_tp1_ep15&#45;&gt;layer4_aggregate_dp0_tp1_ep15 -->
<g id="edge210" class="edge">
<title>layer4_expert_allreduce_dp0_tp1_ep15&#45;&gt;layer4_aggregate_dp0_tp1_ep15</title>
<path fill="none" stroke="black" d="M25971.02,-1438.39C25953.81,-1428.1 25935.11,-1416.91 25916.52,-1405.8"/>
<polygon fill="black" stroke="black" points="25918.09,-1402.66 25907.71,-1400.53 25914.5,-1408.67 25918.09,-1402.66"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep15&#45;&gt;layer61_mla_dp0_tp0 -->
<g id="edge434" class="edge">
<title>layer4_aggregate_dp0_tp1_ep15&#45;&gt;layer61_mla_dp0_tp0</title>
<path fill="none" stroke="black" d="M25430.25,-1265.27C25426.93,-1264.95 25423.62,-1264.63 25420.33,-1264.33 24969.35,-1223.36 17722.16,-1230.51 17269.33,-1228.33 14853,-1216.72 11919.41,-1200.8 11126.24,-1196.46"/>
<polygon fill="black" stroke="black" points="11126.17,-1192.96 11116.15,-1196.41 11126.13,-1199.96 11126.17,-1192.96"/>
</g>
<!-- layer4_aggregate_dp0_tp1_ep15&#45;&gt;layer61_mla_dp0_tp1 -->
<g id="edge466" class="edge">
<title>layer4_aggregate_dp0_tp1_ep15&#45;&gt;layer61_mla_dp0_tp1</title>
<path fill="none" stroke="black" d="M25430.25,-1265.29C25426.93,-1264.96 25423.62,-1264.64 25420.33,-1264.33 24630.77,-1190.9 18850.07,-1193.71 17680.37,-1195.05"/>
<polygon fill="black" stroke="black" points="17680.18,-1191.55 17670.18,-1195.06 17680.18,-1198.55 17680.18,-1191.55"/>
</g>
<!-- layer4_dispatch_dp1_tp0_ep0 -->
<g id="node212" class="node">
<title>layer4_dispatch_dp1_tp0_ep0</title>
<polygon fill="lightgreen" stroke="black" points="29312.48,-1912.5 28625.02,-1912.5 28448.17,-1776.5 29135.63,-1776.5 29312.48,-1912.5"/>
<text text-anchor="middle" x="28880.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="28880.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 132</text>
<text text-anchor="middle" x="28880.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="28880.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp0_ep0&#45;&gt;layer4_dispatch_dp1_tp0_ep0 -->
<g id="edge212" class="edge">
<title>layer4_gate_dp1_tp0_ep0&#45;&gt;layer4_dispatch_dp1_tp0_ep0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M28923.87,-1948.31C28920.23,-1939.72 28916.49,-1930.88 28912.79,-1922.16"/>
<polygon fill="black" stroke="black" points="28915.93,-1920.6 28908.81,-1912.76 28909.49,-1923.33 28915.93,-1920.6"/>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep0 -->
<g id="node213" class="node">
<title>layer4_expert_mlp_dp1_tp0_ep0</title>
<polygon fill="lightblue" stroke="black" points="29440.83,-1740.5 29089.83,-1740.5 29089.83,-1672.5 29440.83,-1672.5 29440.83,-1740.5"/>
<text text-anchor="middle" x="29265.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="29265.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 132</text>
<text text-anchor="middle" x="29265.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="29265.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp0_ep0&#45;&gt;layer4_expert_mlp_dp1_tp0_ep0 -->
<g id="edge213" class="edge">
<title>layer4_dispatch_dp1_tp0_ep0&#45;&gt;layer4_expert_mlp_dp1_tp0_ep0</title>
<path fill="none" stroke="black" d="M29070.01,-1776.5C29101.72,-1765.29 29133.55,-1754.05 29162.02,-1743.99"/>
<polygon fill="black" stroke="black" points="29163.28,-1747.26 29171.55,-1740.63 29160.95,-1740.66 29163.28,-1747.26"/>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep0 -->
<g id="node214" class="node">
<title>layer4_expert_proj_dp1_tp0_ep0</title>
<polygon fill="lightblue" stroke="black" points="29697.83,-1636.5 29346.83,-1636.5 29346.83,-1568.5 29697.83,-1568.5 29697.83,-1636.5"/>
<text text-anchor="middle" x="29522.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="29522.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 132</text>
<text text-anchor="middle" x="29522.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="29522.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep0&#45;&gt;layer4_expert_proj_dp1_tp0_ep0 -->
<g id="edge214" class="edge">
<title>layer4_expert_mlp_dp1_tp0_ep0&#45;&gt;layer4_expert_proj_dp1_tp0_ep0</title>
<path fill="none" stroke="black" d="M29348.77,-1672.38C29374.48,-1662.18 29402.95,-1650.88 29429.27,-1640.43"/>
<polygon fill="black" stroke="black" points="29430.86,-1643.57 29438.86,-1636.62 29428.28,-1637.06 29430.86,-1643.57"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep0 -->
<g id="node215" class="node">
<title>layer4_expert_allreduce_dp1_tp0_ep0</title>
<ellipse fill="lightyellow" stroke="black" cx="30440.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="30440.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="30440.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 132</text>
<text text-anchor="middle" x="30440.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="30440.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep0&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep0 -->
<g id="edge215" class="edge">
<title>layer4_expert_proj_dp1_tp0_ep0&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep0</title>
<path fill="none" stroke="black" d="M29697.97,-1579.29C29847.99,-1560.32 30064.35,-1532.96 30224.82,-1512.67"/>
<polygon fill="black" stroke="black" points="30225.34,-1516.13 30234.83,-1511.4 30224.47,-1509.18 30225.34,-1516.13"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep0 -->
<g id="node216" class="node">
<title>layer4_aggregate_dp1_tp0_ep0</title>
<polygon fill="lightpink" stroke="black" points="31367.27,-1400.33 30785.13,-1400.33 30635.38,-1264.33 31217.52,-1264.33 31367.27,-1400.33"/>
<text text-anchor="middle" x="31001.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="31001.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 132</text>
<text text-anchor="middle" x="31001.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="31001.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep0&#45;&gt;layer4_aggregate_dp1_tp0_ep0 -->
<g id="edge216" class="edge">
<title>layer4_expert_allreduce_dp1_tp0_ep0&#45;&gt;layer4_aggregate_dp1_tp0_ep0</title>
<path fill="none" stroke="black" d="M30583.71,-1445.06C30639.56,-1430.12 30705.03,-1412.6 30767.35,-1395.93"/>
<polygon fill="black" stroke="black" points="30768.57,-1399.23 30777.32,-1393.26 30766.76,-1392.46 30768.57,-1399.23"/>
</g>
<!-- layer61_mla_dp1_tp0 -->
<g id="node405" class="node">
<title>layer61_mla_dp1_tp0</title>
<polygon fill="lightblue" stroke="black" points="39542.83,-1228.33 39151.83,-1228.33 39151.83,-1160.33 39542.83,-1160.33 39542.83,-1228.33"/>
<text text-anchor="middle" x="39347.33" y="-1213.13" font-family="Times,serif" font-size="14.00">LAYER61_MLA</text>
<text text-anchor="middle" x="39347.33" y="-1198.13" font-family="Times,serif" font-size="14.00">GPU: 176</text>
<text text-anchor="middle" x="39347.33" y="-1183.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="39347.33" y="-1168.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, heads=64, d_k=56]</text>
</g>
<!-- layer4_aggregate_dp1_tp0_ep0&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge467" class="edge">
<title>layer4_aggregate_dp1_tp0_ep0&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M31238.06,-1282.82C31283.75,-1275.23 31331.38,-1268.51 31376.33,-1264.33 32168.59,-1190.66 37970.39,-1193.67 39141.59,-1195.04"/>
<polygon fill="black" stroke="black" points="39141.79,-1198.54 39151.79,-1195.06 39141.79,-1191.54 39141.79,-1198.54"/>
</g>
<!-- layer61_mla_dp1_tp1 -->
<g id="node406" class="node">
<title>layer61_mla_dp1_tp1</title>
<polygon fill="lightblue" stroke="black" points="45929.83,-1228.33 45538.83,-1228.33 45538.83,-1160.33 45929.83,-1160.33 45929.83,-1228.33"/>
<text text-anchor="middle" x="45734.33" y="-1213.13" font-family="Times,serif" font-size="14.00">LAYER61_MLA</text>
<text text-anchor="middle" x="45734.33" y="-1198.13" font-family="Times,serif" font-size="14.00">GPU: 240</text>
<text text-anchor="middle" x="45734.33" y="-1183.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="45734.33" y="-1168.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, heads=64, d_k=56]</text>
</g>
<!-- layer4_aggregate_dp1_tp0_ep0&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge499" class="edge">
<title>layer4_aggregate_dp1_tp0_ep0&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M31237.79,-1282.71C31283.56,-1275.11 31331.29,-1268.42 31376.33,-1264.33 31828.69,-1223.24 39098.1,-1230.55 39552.33,-1228.33 41899.8,-1216.9 44748.67,-1200.91 45528.58,-1196.5"/>
<polygon fill="black" stroke="black" points="45528.8,-1200 45538.78,-1196.44 45528.76,-1193 45528.8,-1200"/>
</g>
<!-- layer4_dispatch_dp1_tp0_ep1 -->
<g id="node218" class="node">
<title>layer4_dispatch_dp1_tp0_ep1</title>
<polygon fill="lightgreen" stroke="black" points="30195.48,-1912.5 29508.02,-1912.5 29331.17,-1776.5 30018.63,-1776.5 30195.48,-1912.5"/>
<text text-anchor="middle" x="29763.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="29763.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 133</text>
<text text-anchor="middle" x="29763.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="29763.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp0_ep1&#45;&gt;layer4_dispatch_dp1_tp0_ep1 -->
<g id="edge218" class="edge">
<title>layer4_gate_dp1_tp0_ep1&#45;&gt;layer4_dispatch_dp1_tp0_ep1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29826.83,-1948.31C29821.35,-1939.45 29815.71,-1930.32 29810.16,-1921.32"/>
<polygon fill="black" stroke="black" points="29813.1,-1919.43 29804.87,-1912.76 29807.14,-1923.1 29813.1,-1919.43"/>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep1 -->
<g id="node219" class="node">
<title>layer4_expert_mlp_dp1_tp0_ep1</title>
<polygon fill="lightblue" stroke="black" points="30195.83,-1740.5 29844.83,-1740.5 29844.83,-1672.5 30195.83,-1672.5 30195.83,-1740.5"/>
<text text-anchor="middle" x="30020.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="30020.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 133</text>
<text text-anchor="middle" x="30020.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="30020.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp0_ep1&#45;&gt;layer4_expert_mlp_dp1_tp0_ep1 -->
<g id="edge219" class="edge">
<title>layer4_dispatch_dp1_tp0_ep1&#45;&gt;layer4_expert_mlp_dp1_tp0_ep1</title>
<path fill="none" stroke="black" d="M29889.94,-1776.5C29910.2,-1765.78 29930.51,-1755.03 29948.88,-1745.31"/>
<polygon fill="black" stroke="black" points="29950.52,-1748.4 29957.73,-1740.63 29947.25,-1742.21 29950.52,-1748.4"/>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep1 -->
<g id="node220" class="node">
<title>layer4_expert_proj_dp1_tp0_ep1</title>
<polygon fill="lightblue" stroke="black" points="30828.83,-1636.5 30477.83,-1636.5 30477.83,-1568.5 30828.83,-1568.5 30828.83,-1636.5"/>
<text text-anchor="middle" x="30653.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="30653.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 133</text>
<text text-anchor="middle" x="30653.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="30653.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep1&#45;&gt;layer4_expert_proj_dp1_tp0_ep1 -->
<g id="edge220" class="edge">
<title>layer4_expert_mlp_dp1_tp0_ep1&#45;&gt;layer4_expert_proj_dp1_tp0_ep1</title>
<path fill="none" stroke="black" d="M30196.23,-1677.15C30280.69,-1663.54 30381.92,-1647.23 30467.62,-1633.42"/>
<polygon fill="black" stroke="black" points="30468.41,-1636.84 30477.72,-1631.8 30467.29,-1629.93 30468.41,-1636.84"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep1 -->
<g id="node221" class="node">
<title>layer4_expert_allreduce_dp1_tp0_ep1</title>
<ellipse fill="lightyellow" stroke="black" cx="31303.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="31303.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="31303.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 133</text>
<text text-anchor="middle" x="31303.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="31303.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep1&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep1 -->
<g id="edge221" class="edge">
<title>layer4_expert_proj_dp1_tp0_ep1&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep1</title>
<path fill="none" stroke="black" d="M30829.23,-1570.09C30917.11,-1554.39 31023.55,-1535.38 31113.3,-1519.35"/>
<polygon fill="black" stroke="black" points="31114.1,-1522.77 31123.33,-1517.56 31112.87,-1515.88 31114.1,-1522.77"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep1 -->
<g id="node222" class="node">
<title>layer4_aggregate_dp1_tp0_ep1</title>
<polygon fill="lightpink" stroke="black" points="32117.27,-1400.33 31535.13,-1400.33 31385.38,-1264.33 31967.52,-1264.33 32117.27,-1400.33"/>
<text text-anchor="middle" x="31751.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="31751.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 133</text>
<text text-anchor="middle" x="31751.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="31751.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep1&#45;&gt;layer4_aggregate_dp1_tp0_ep1 -->
<g id="edge222" class="edge">
<title>layer4_expert_allreduce_dp1_tp0_ep1&#45;&gt;layer4_aggregate_dp1_tp0_ep1</title>
<path fill="none" stroke="black" d="M31425.45,-1442.5C31461.43,-1430.45 31501.86,-1416.91 31541.69,-1403.56"/>
<polygon fill="black" stroke="black" points="31542.88,-1406.85 31551.25,-1400.36 31540.66,-1400.22 31542.88,-1406.85"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep1&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge468" class="edge">
<title>layer4_aggregate_dp1_tp0_ep1&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M31988.06,-1282.86C32033.75,-1275.26 32081.38,-1268.53 32126.33,-1264.33 32839.75,-1197.66 38037.59,-1195.04 39141.57,-1195.24"/>
<polygon fill="black" stroke="black" points="39141.59,-1198.74 39151.59,-1195.25 39141.59,-1191.74 39141.59,-1198.74"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep1&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge500" class="edge">
<title>layer4_aggregate_dp1_tp0_ep1&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M31987.79,-1282.73C32033.56,-1275.12 32081.29,-1268.43 32126.33,-1264.33 32537.19,-1226.91 39139.77,-1230.43 39552.33,-1228.33 41899.79,-1216.38 44748.67,-1200.76 45528.58,-1196.47"/>
<polygon fill="black" stroke="black" points="45528.8,-1199.97 45538.78,-1196.41 45528.76,-1192.97 45528.8,-1199.97"/>
</g>
<!-- layer4_dispatch_dp1_tp0_ep2 -->
<g id="node224" class="node">
<title>layer4_dispatch_dp1_tp0_ep2</title>
<polygon fill="lightgreen" stroke="black" points="31078.48,-1912.5 30391.02,-1912.5 30214.17,-1776.5 30901.63,-1776.5 31078.48,-1912.5"/>
<text text-anchor="middle" x="30646.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="30646.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 134</text>
<text text-anchor="middle" x="30646.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="30646.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp0_ep2&#45;&gt;layer4_dispatch_dp1_tp0_ep2 -->
<g id="edge224" class="edge">
<title>layer4_gate_dp1_tp0_ep2&#45;&gt;layer4_dispatch_dp1_tp0_ep2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30699.55,-1948.31C30695.05,-1939.63 30690.43,-1930.69 30685.86,-1921.88"/>
<polygon fill="black" stroke="black" points="30688.85,-1920.03 30681.14,-1912.76 30682.63,-1923.25 30688.85,-1920.03"/>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep2 -->
<g id="node225" class="node">
<title>layer4_expert_mlp_dp1_tp0_ep2</title>
<polygon fill="lightblue" stroke="black" points="31078.83,-1740.5 30727.83,-1740.5 30727.83,-1672.5 31078.83,-1672.5 31078.83,-1740.5"/>
<text text-anchor="middle" x="30903.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="30903.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 134</text>
<text text-anchor="middle" x="30903.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="30903.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp0_ep2&#45;&gt;layer4_expert_mlp_dp1_tp0_ep2 -->
<g id="edge225" class="edge">
<title>layer4_dispatch_dp1_tp0_ep2&#45;&gt;layer4_expert_mlp_dp1_tp0_ep2</title>
<path fill="none" stroke="black" d="M30772.94,-1776.5C30793.2,-1765.78 30813.51,-1755.03 30831.88,-1745.31"/>
<polygon fill="black" stroke="black" points="30833.52,-1748.4 30840.73,-1740.63 30830.25,-1742.21 30833.52,-1748.4"/>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep2 -->
<g id="node226" class="node">
<title>layer4_expert_proj_dp1_tp0_ep2</title>
<polygon fill="lightblue" stroke="black" points="31812.83,-1636.5 31461.83,-1636.5 31461.83,-1568.5 31812.83,-1568.5 31812.83,-1636.5"/>
<text text-anchor="middle" x="31637.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="31637.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 134</text>
<text text-anchor="middle" x="31637.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="31637.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep2&#45;&gt;layer4_expert_proj_dp1_tp0_ep2 -->
<g id="edge226" class="edge">
<title>layer4_expert_mlp_dp1_tp0_ep2&#45;&gt;layer4_expert_proj_dp1_tp0_ep2</title>
<path fill="none" stroke="black" d="M31079.14,-1681.07C31191.64,-1665.43 31337.4,-1645.18 31451.76,-1629.29"/>
<polygon fill="black" stroke="black" points="31452.26,-1632.75 31461.68,-1627.91 31451.29,-1625.82 31452.26,-1632.75"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep2 -->
<g id="node227" class="node">
<title>layer4_expert_allreduce_dp1_tp0_ep2</title>
<ellipse fill="lightyellow" stroke="black" cx="32335.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="32335.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="32335.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 134</text>
<text text-anchor="middle" x="32335.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="32335.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep2&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep2 -->
<g id="edge227" class="edge">
<title>layer4_expert_proj_dp1_tp0_ep2&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep2</title>
<path fill="none" stroke="black" d="M31813.01,-1572.28C31912.38,-1555.76 32036.87,-1535.05 32139.39,-1518"/>
<polygon fill="black" stroke="black" points="32140.26,-1521.4 32149.56,-1516.31 32139.12,-1514.5 32140.26,-1521.4"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep2 -->
<g id="node228" class="node">
<title>layer4_aggregate_dp1_tp0_ep2</title>
<polygon fill="lightpink" stroke="black" points="32867.27,-1400.33 32285.13,-1400.33 32135.38,-1264.33 32717.52,-1264.33 32867.27,-1400.33"/>
<text text-anchor="middle" x="32501.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="32501.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 134</text>
<text text-anchor="middle" x="32501.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="32501.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep2&#45;&gt;layer4_aggregate_dp1_tp0_ep2 -->
<g id="edge228" class="edge">
<title>layer4_expert_allreduce_dp1_tp0_ep2&#45;&gt;layer4_aggregate_dp1_tp0_ep2</title>
<path fill="none" stroke="black" d="M32386.49,-1437.16C32397.04,-1427.62 32408.39,-1417.35 32419.72,-1407.12"/>
<polygon fill="black" stroke="black" points="32422.08,-1409.7 32427.15,-1400.4 32417.38,-1404.51 32422.08,-1409.7"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep2&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge469" class="edge">
<title>layer4_aggregate_dp1_tp0_ep2&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M32738.06,-1282.9C32783.76,-1275.29 32831.39,-1268.56 32876.33,-1264.33 33511.11,-1204.66 38108.07,-1196.56 39141.45,-1195.49"/>
<polygon fill="black" stroke="black" points="39141.59,-1198.99 39151.58,-1195.48 39141.58,-1191.99 39141.59,-1198.99"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep2&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge501" class="edge">
<title>layer4_aggregate_dp1_tp0_ep2&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M32738.04,-1282.71C32783.74,-1275.12 32831.38,-1268.44 32876.33,-1264.33 32876.33,-1264.33 43879.81,-1205.28 45528.61,-1196.44"/>
<polygon fill="black" stroke="black" points="45528.8,-1199.94 45538.78,-1196.38 45528.76,-1192.94 45528.8,-1199.94"/>
</g>
<!-- layer4_dispatch_dp1_tp0_ep3 -->
<g id="node230" class="node">
<title>layer4_dispatch_dp1_tp0_ep3</title>
<polygon fill="lightgreen" stroke="black" points="31961.48,-1912.5 31274.02,-1912.5 31097.17,-1776.5 31784.63,-1776.5 31961.48,-1912.5"/>
<text text-anchor="middle" x="31529.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="31529.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 135</text>
<text text-anchor="middle" x="31529.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="31529.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp0_ep3&#45;&gt;layer4_dispatch_dp1_tp0_ep3 -->
<g id="edge230" class="edge">
<title>layer4_gate_dp1_tp0_ep3&#45;&gt;layer4_dispatch_dp1_tp0_ep3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M31557.15,-1948.31C31554.85,-1939.81 31552.48,-1931.07 31550.14,-1922.44"/>
<polygon fill="black" stroke="black" points="31553.52,-1921.5 31547.53,-1912.76 31546.76,-1923.32 31553.52,-1921.5"/>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep3 -->
<g id="node231" class="node">
<title>layer4_expert_mlp_dp1_tp0_ep3</title>
<polygon fill="lightblue" stroke="black" points="31961.83,-1740.5 31610.83,-1740.5 31610.83,-1672.5 31961.83,-1672.5 31961.83,-1740.5"/>
<text text-anchor="middle" x="31786.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="31786.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 135</text>
<text text-anchor="middle" x="31786.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="31786.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp0_ep3&#45;&gt;layer4_expert_mlp_dp1_tp0_ep3 -->
<g id="edge231" class="edge">
<title>layer4_dispatch_dp1_tp0_ep3&#45;&gt;layer4_expert_mlp_dp1_tp0_ep3</title>
<path fill="none" stroke="black" d="M31655.94,-1776.5C31676.2,-1765.78 31696.51,-1755.03 31714.88,-1745.31"/>
<polygon fill="black" stroke="black" points="31716.52,-1748.4 31723.73,-1740.63 31713.25,-1742.21 31716.52,-1748.4"/>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep3 -->
<g id="node232" class="node">
<title>layer4_expert_proj_dp1_tp0_ep3</title>
<polygon fill="lightblue" stroke="black" points="32925.83,-1636.5 32574.83,-1636.5 32574.83,-1568.5 32925.83,-1568.5 32925.83,-1636.5"/>
<text text-anchor="middle" x="32750.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="32750.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 135</text>
<text text-anchor="middle" x="32750.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="32750.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep3&#45;&gt;layer4_expert_proj_dp1_tp0_ep3 -->
<g id="edge232" class="edge">
<title>layer4_expert_mlp_dp1_tp0_ep3&#45;&gt;layer4_expert_proj_dp1_tp0_ep3</title>
<path fill="none" stroke="black" d="M31962.02,-1686.91C32132.62,-1668.86 32390.65,-1641.56 32564.59,-1623.15"/>
<polygon fill="black" stroke="black" points="32565.05,-1626.62 32574.62,-1622.09 32564.31,-1619.66 32565.05,-1626.62"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep3 -->
<g id="node233" class="node">
<title>layer4_expert_allreduce_dp1_tp0_ep3</title>
<ellipse fill="lightyellow" stroke="black" cx="32982.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="32982.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="32982.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 135</text>
<text text-anchor="middle" x="32982.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="32982.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep3&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep3 -->
<g id="edge233" class="edge">
<title>layer4_expert_proj_dp1_tp0_ep3&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep3</title>
<path fill="none" stroke="black" d="M32816.5,-1568.39C32837.9,-1557.68 32862.09,-1545.58 32885.25,-1533.99"/>
<polygon fill="black" stroke="black" points="32887.04,-1537.01 32894.41,-1529.4 32883.9,-1530.75 32887.04,-1537.01"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep3 -->
<g id="node234" class="node">
<title>layer4_aggregate_dp1_tp0_ep3</title>
<polygon fill="lightpink" stroke="black" points="33617.27,-1400.33 33035.13,-1400.33 32885.38,-1264.33 33467.52,-1264.33 33617.27,-1400.33"/>
<text text-anchor="middle" x="33251.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="33251.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 135</text>
<text text-anchor="middle" x="33251.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="33251.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep3&#45;&gt;layer4_aggregate_dp1_tp0_ep3 -->
<g id="edge234" class="edge">
<title>layer4_expert_allreduce_dp1_tp0_ep3&#45;&gt;layer4_aggregate_dp1_tp0_ep3</title>
<path fill="none" stroke="black" d="M33062.31,-1438.79C33081.21,-1428.25 33101.84,-1416.73 33122.31,-1405.32"/>
<polygon fill="black" stroke="black" points="33124.04,-1408.36 33131.06,-1400.43 33120.62,-1402.25 33124.04,-1408.36"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep3&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge470" class="edge">
<title>layer4_aggregate_dp1_tp0_ep3&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M33488.07,-1282.95C33533.76,-1275.34 33581.39,-1268.59 33626.33,-1264.33 34182.76,-1211.63 38183.06,-1198.26 39141.4,-1195.8"/>
<polygon fill="black" stroke="black" points="39141.51,-1199.3 39151.5,-1195.78 39141.49,-1192.3 39141.51,-1199.3"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep3&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge502" class="edge">
<title>layer4_aggregate_dp1_tp0_ep3&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M33488.05,-1282.72C33533.74,-1275.13 33581.38,-1268.45 33626.33,-1264.33 33664.95,-1260.8 43938.2,-1205.06 45528.57,-1196.45"/>
<polygon fill="black" stroke="black" points="45528.68,-1199.95 45538.66,-1196.39 45528.64,-1192.95 45528.68,-1199.95"/>
</g>
<!-- layer4_dispatch_dp1_tp0_ep4 -->
<g id="node236" class="node">
<title>layer4_dispatch_dp1_tp0_ep4</title>
<polygon fill="lightgreen" stroke="black" points="32844.48,-1912.5 32157.02,-1912.5 31980.17,-1776.5 32667.63,-1776.5 32844.48,-1912.5"/>
<text text-anchor="middle" x="32412.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="32412.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 136</text>
<text text-anchor="middle" x="32412.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="32412.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp0_ep4&#45;&gt;layer4_dispatch_dp1_tp0_ep4 -->
<g id="edge236" class="edge">
<title>layer4_gate_dp1_tp0_ep4&#45;&gt;layer4_dispatch_dp1_tp0_ep4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32448.01,-1948.31C32445.06,-1939.81 32442.02,-1931.07 32439.03,-1922.44"/>
<polygon fill="black" stroke="black" points="32442.25,-1921.06 32435.67,-1912.76 32435.64,-1923.35 32442.25,-1921.06"/>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep4 -->
<g id="node237" class="node">
<title>layer4_expert_mlp_dp1_tp0_ep4</title>
<polygon fill="lightblue" stroke="black" points="32844.83,-1740.5 32493.83,-1740.5 32493.83,-1672.5 32844.83,-1672.5 32844.83,-1740.5"/>
<text text-anchor="middle" x="32669.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="32669.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 136</text>
<text text-anchor="middle" x="32669.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="32669.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp0_ep4&#45;&gt;layer4_expert_mlp_dp1_tp0_ep4 -->
<g id="edge237" class="edge">
<title>layer4_dispatch_dp1_tp0_ep4&#45;&gt;layer4_expert_mlp_dp1_tp0_ep4</title>
<path fill="none" stroke="black" d="M32538.94,-1776.5C32559.2,-1765.78 32579.51,-1755.03 32597.88,-1745.31"/>
<polygon fill="black" stroke="black" points="32599.52,-1748.4 32606.73,-1740.63 32596.25,-1742.21 32599.52,-1748.4"/>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep4 -->
<g id="node238" class="node">
<title>layer4_expert_proj_dp1_tp0_ep4</title>
<polygon fill="lightblue" stroke="black" points="33413.83,-1636.5 33062.83,-1636.5 33062.83,-1568.5 33413.83,-1568.5 33413.83,-1636.5"/>
<text text-anchor="middle" x="33238.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="33238.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 136</text>
<text text-anchor="middle" x="33238.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="33238.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep4&#45;&gt;layer4_expert_proj_dp1_tp0_ep4 -->
<g id="edge238" class="edge">
<title>layer4_expert_mlp_dp1_tp0_ep4&#45;&gt;layer4_expert_proj_dp1_tp0_ep4</title>
<path fill="none" stroke="black" d="M32845.08,-1673.99C32910.91,-1662.19 32985.88,-1648.75 33052.59,-1636.8"/>
<polygon fill="black" stroke="black" points="33053.57,-1640.18 33062.79,-1634.97 33052.33,-1633.29 33053.57,-1640.18"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep4 -->
<g id="node239" class="node">
<title>layer4_expert_allreduce_dp1_tp0_ep4</title>
<ellipse fill="lightyellow" stroke="black" cx="33664.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="33664.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="33664.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 136</text>
<text text-anchor="middle" x="33664.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="33664.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep4&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep4 -->
<g id="edge239" class="edge">
<title>layer4_expert_proj_dp1_tp0_ep4&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep4</title>
<path fill="none" stroke="black" d="M33359.55,-1568.47C33407.38,-1555.43 33462.84,-1540.32 33513.24,-1526.59"/>
<polygon fill="black" stroke="black" points="33514.19,-1529.96 33522.92,-1523.95 33512.35,-1523.2 33514.19,-1529.96"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep4 -->
<g id="node240" class="node">
<title>layer4_aggregate_dp1_tp0_ep4</title>
<polygon fill="lightpink" stroke="black" points="34367.27,-1400.33 33785.13,-1400.33 33635.38,-1264.33 34217.52,-1264.33 34367.27,-1400.33"/>
<text text-anchor="middle" x="34001.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="34001.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 136</text>
<text text-anchor="middle" x="34001.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="34001.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep4&#45;&gt;layer4_aggregate_dp1_tp0_ep4 -->
<g id="edge240" class="edge">
<title>layer4_expert_allreduce_dp1_tp0_ep4&#45;&gt;layer4_aggregate_dp1_tp0_ep4</title>
<path fill="none" stroke="black" d="M33761.8,-1440.01C33786.78,-1428.88 33814.3,-1416.63 33841.52,-1404.5"/>
<polygon fill="black" stroke="black" points="33843.02,-1407.67 33850.73,-1400.4 33840.17,-1401.27 33843.02,-1407.67"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep4&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge471" class="edge">
<title>layer4_aggregate_dp1_tp0_ep4&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M34238.32,-1282.97C34283.94,-1275.37 34331.48,-1268.62 34376.33,-1264.33 34854.72,-1218.58 38263.27,-1200.21 39141.4,-1196.21"/>
<polygon fill="black" stroke="black" points="39141.63,-1199.71 39151.61,-1196.16 39141.6,-1192.71 39141.63,-1199.71"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep4&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge503" class="edge">
<title>layer4_aggregate_dp1_tp0_ep4&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M34238.05,-1282.73C34283.74,-1275.14 34331.38,-1268.45 34376.33,-1264.33 34448.58,-1257.71 43998.27,-1204.89 45528.54,-1196.46"/>
<polygon fill="black" stroke="black" points="45528.83,-1199.96 45538.81,-1196.41 45528.79,-1192.96 45528.83,-1199.96"/>
</g>
<!-- layer4_dispatch_dp1_tp0_ep5 -->
<g id="node242" class="node">
<title>layer4_dispatch_dp1_tp0_ep5</title>
<polygon fill="lightgreen" stroke="black" points="33727.48,-1912.5 33040.02,-1912.5 32863.17,-1776.5 33550.63,-1776.5 33727.48,-1912.5"/>
<text text-anchor="middle" x="33295.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="33295.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 137</text>
<text text-anchor="middle" x="33295.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="33295.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp0_ep5&#45;&gt;layer4_dispatch_dp1_tp0_ep5 -->
<g id="edge242" class="edge">
<title>layer4_gate_dp1_tp0_ep5&#45;&gt;layer4_dispatch_dp1_tp0_ep5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33350.97,-1948.31C33346.22,-1939.54 33341.33,-1930.51 33336.51,-1921.6"/>
<polygon fill="black" stroke="black" points="33339.56,-1919.89 33331.72,-1912.76 33333.41,-1923.22 33339.56,-1919.89"/>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep5 -->
<g id="node243" class="node">
<title>layer4_expert_mlp_dp1_tp0_ep5</title>
<polygon fill="lightblue" stroke="black" points="33636.83,-1740.5 33285.83,-1740.5 33285.83,-1672.5 33636.83,-1672.5 33636.83,-1740.5"/>
<text text-anchor="middle" x="33461.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="33461.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 137</text>
<text text-anchor="middle" x="33461.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="33461.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp0_ep5&#45;&gt;layer4_expert_mlp_dp1_tp0_ep5 -->
<g id="edge243" class="edge">
<title>layer4_dispatch_dp1_tp0_ep5&#45;&gt;layer4_expert_mlp_dp1_tp0_ep5</title>
<path fill="none" stroke="black" d="M33377.35,-1776.3C33389.58,-1766.28 33401.83,-1756.24 33413.05,-1747.05"/>
<polygon fill="black" stroke="black" points="33415.51,-1749.56 33421.03,-1740.52 33411.07,-1744.15 33415.51,-1749.56"/>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep5 -->
<g id="node244" class="node">
<title>layer4_expert_proj_dp1_tp0_ep5</title>
<polygon fill="lightblue" stroke="black" points="33842.83,-1636.5 33491.83,-1636.5 33491.83,-1568.5 33842.83,-1568.5 33842.83,-1636.5"/>
<text text-anchor="middle" x="33667.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="33667.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 137</text>
<text text-anchor="middle" x="33667.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="33667.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep5&#45;&gt;layer4_expert_proj_dp1_tp0_ep5 -->
<g id="edge244" class="edge">
<title>layer4_expert_mlp_dp1_tp0_ep5&#45;&gt;layer4_expert_proj_dp1_tp0_ep5</title>
<path fill="none" stroke="black" d="M33528.21,-1672.38C33548.37,-1662.4 33570.64,-1651.37 33591.35,-1641.12"/>
<polygon fill="black" stroke="black" points="33593.02,-1644.2 33600.43,-1636.62 33589.91,-1637.93 33593.02,-1644.2"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep5 -->
<g id="node245" class="node">
<title>layer4_expert_allreduce_dp1_tp0_ep5</title>
<ellipse fill="lightyellow" stroke="black" cx="34465.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="34465.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="34465.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 137</text>
<text text-anchor="middle" x="34465.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="34465.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep5&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep5 -->
<g id="edge245" class="edge">
<title>layer4_expert_proj_dp1_tp0_ep5&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep5</title>
<path fill="none" stroke="black" d="M33842.94,-1575.95C33965.71,-1558.09 34130.11,-1534.18 34259.11,-1515.41"/>
<polygon fill="black" stroke="black" points="34259.73,-1518.86 34269.12,-1513.96 34258.72,-1511.93 34259.73,-1518.86"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep5 -->
<g id="node246" class="node">
<title>layer4_aggregate_dp1_tp0_ep5</title>
<polygon fill="lightpink" stroke="black" points="35117.27,-1400.33 34535.13,-1400.33 34385.38,-1264.33 34967.52,-1264.33 35117.27,-1400.33"/>
<text text-anchor="middle" x="34751.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="34751.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 137</text>
<text text-anchor="middle" x="34751.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="34751.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep5&#45;&gt;layer4_aggregate_dp1_tp0_ep5 -->
<g id="edge246" class="edge">
<title>layer4_expert_allreduce_dp1_tp0_ep5&#45;&gt;layer4_aggregate_dp1_tp0_ep5</title>
<path fill="none" stroke="black" d="M34549.97,-1439C34570.24,-1428.36 34592.4,-1416.73 34614.36,-1405.21"/>
<polygon fill="black" stroke="black" points="34616.2,-1408.2 34623.43,-1400.45 34612.94,-1402 34616.2,-1408.2"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep5&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge472" class="edge">
<title>layer4_aggregate_dp1_tp0_ep5&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M34988.33,-1283.06C35033.95,-1275.45 35081.48,-1268.68 35126.33,-1264.33 35527.08,-1225.51 38349.92,-1202.5 39141.44,-1196.76"/>
<polygon fill="black" stroke="black" points="39141.54,-1200.26 39151.51,-1196.68 39141.49,-1193.26 39141.54,-1200.26"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep5&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge504" class="edge">
<title>layer4_aggregate_dp1_tp0_ep5&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M34988.05,-1282.75C35033.74,-1275.15 35081.38,-1268.46 35126.33,-1264.33 35260.82,-1251.97 44062.9,-1204.29 45528.53,-1196.43"/>
<polygon fill="black" stroke="black" points="45528.65,-1199.93 45538.63,-1196.38 45528.61,-1192.93 45528.65,-1199.93"/>
</g>
<!-- layer4_dispatch_dp1_tp0_ep6 -->
<g id="node248" class="node">
<title>layer4_dispatch_dp1_tp0_ep6</title>
<polygon fill="lightgreen" stroke="black" points="34610.48,-1912.5 33923.02,-1912.5 33746.17,-1776.5 34433.63,-1776.5 34610.48,-1912.5"/>
<text text-anchor="middle" x="34178.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="34178.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 138</text>
<text text-anchor="middle" x="34178.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="34178.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp0_ep6&#45;&gt;layer4_dispatch_dp1_tp0_ep6 -->
<g id="edge248" class="edge">
<title>layer4_gate_dp1_tp0_ep6&#45;&gt;layer4_dispatch_dp1_tp0_ep6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34223.68,-1948.31C34219.9,-1939.72 34215.99,-1930.88 34212.15,-1922.16"/>
<polygon fill="black" stroke="black" points="34215.24,-1920.49 34208,-1912.76 34208.83,-1923.32 34215.24,-1920.49"/>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep6 -->
<g id="node249" class="node">
<title>layer4_expert_mlp_dp1_tp0_ep6</title>
<polygon fill="lightblue" stroke="black" points="34610.83,-1740.5 34259.83,-1740.5 34259.83,-1672.5 34610.83,-1672.5 34610.83,-1740.5"/>
<text text-anchor="middle" x="34435.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="34435.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 138</text>
<text text-anchor="middle" x="34435.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="34435.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp0_ep6&#45;&gt;layer4_expert_mlp_dp1_tp0_ep6 -->
<g id="edge249" class="edge">
<title>layer4_dispatch_dp1_tp0_ep6&#45;&gt;layer4_expert_mlp_dp1_tp0_ep6</title>
<path fill="none" stroke="black" d="M34304.94,-1776.5C34325.2,-1765.78 34345.51,-1755.03 34363.88,-1745.31"/>
<polygon fill="black" stroke="black" points="34365.52,-1748.4 34372.73,-1740.63 34362.25,-1742.21 34365.52,-1748.4"/>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep6 -->
<g id="node250" class="node">
<title>layer4_expert_proj_dp1_tp0_ep6</title>
<polygon fill="lightblue" stroke="black" points="34867.83,-1636.5 34516.83,-1636.5 34516.83,-1568.5 34867.83,-1568.5 34867.83,-1636.5"/>
<text text-anchor="middle" x="34692.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="34692.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 138</text>
<text text-anchor="middle" x="34692.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="34692.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep6&#45;&gt;layer4_expert_proj_dp1_tp0_ep6 -->
<g id="edge250" class="edge">
<title>layer4_expert_mlp_dp1_tp0_ep6&#45;&gt;layer4_expert_proj_dp1_tp0_ep6</title>
<path fill="none" stroke="black" d="M34518.77,-1672.38C34544.48,-1662.18 34572.95,-1650.88 34599.27,-1640.43"/>
<polygon fill="black" stroke="black" points="34600.86,-1643.57 34608.86,-1636.62 34598.28,-1637.06 34600.86,-1643.57"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep6 -->
<g id="node251" class="node">
<title>layer4_expert_allreduce_dp1_tp0_ep6</title>
<ellipse fill="lightyellow" stroke="black" cx="35383.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="35383.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="35383.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 138</text>
<text text-anchor="middle" x="35383.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="35383.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep6&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep6 -->
<g id="edge251" class="edge">
<title>layer4_expert_proj_dp1_tp0_ep6&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep6</title>
<path fill="none" stroke="black" d="M34868.03,-1571.98C34965.74,-1555.57 35087.56,-1535.1 35188.22,-1518.19"/>
<polygon fill="black" stroke="black" points="35188.92,-1521.62 35198.2,-1516.52 35187.76,-1514.72 35188.92,-1521.62"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep6 -->
<g id="node252" class="node">
<title>layer4_aggregate_dp1_tp0_ep6</title>
<polygon fill="lightpink" stroke="black" points="35867.27,-1400.33 35285.13,-1400.33 35135.38,-1264.33 35717.52,-1264.33 35867.27,-1400.33"/>
<text text-anchor="middle" x="35501.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="35501.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 138</text>
<text text-anchor="middle" x="35501.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="35501.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep6&#45;&gt;layer4_aggregate_dp1_tp0_ep6 -->
<g id="edge252" class="edge">
<title>layer4_expert_allreduce_dp1_tp0_ep6&#45;&gt;layer4_aggregate_dp1_tp0_ep6</title>
<path fill="none" stroke="black" d="M35420.02,-1436.75C35427.1,-1427.74 35434.68,-1418.1 35442.27,-1408.45"/>
<polygon fill="black" stroke="black" points="35445.2,-1410.38 35448.63,-1400.35 35439.7,-1406.05 35445.2,-1410.38"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep6&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge473" class="edge">
<title>layer4_aggregate_dp1_tp0_ep6&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M35738.35,-1283.19C35783.96,-1275.57 35831.49,-1268.76 35876.33,-1264.33 36515.42,-1201.28 38495.66,-1195.39 39141.41,-1195.18"/>
<polygon fill="black" stroke="black" points="39141.75,-1198.68 39151.75,-1195.18 39141.75,-1191.68 39141.75,-1198.68"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep6&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge505" class="edge">
<title>layer4_aggregate_dp1_tp0_ep6&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M35738.05,-1282.76C35783.74,-1275.17 35831.38,-1268.48 35876.33,-1264.33 36125.25,-1241.39 44134.62,-1202.84 45528.5,-1196.29"/>
<polygon fill="black" stroke="black" points="45528.63,-1199.79 45538.62,-1196.24 45528.6,-1192.79 45528.63,-1199.79"/>
</g>
<!-- layer4_dispatch_dp1_tp0_ep7 -->
<g id="node254" class="node">
<title>layer4_dispatch_dp1_tp0_ep7</title>
<polygon fill="lightgreen" stroke="black" points="35493.48,-1912.5 34806.02,-1912.5 34629.17,-1776.5 35316.63,-1776.5 35493.48,-1912.5"/>
<text text-anchor="middle" x="35061.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="35061.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 139</text>
<text text-anchor="middle" x="35061.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="35061.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp0_ep7&#45;&gt;layer4_dispatch_dp1_tp0_ep7 -->
<g id="edge254" class="edge">
<title>layer4_gate_dp1_tp0_ep7&#45;&gt;layer4_dispatch_dp1_tp0_ep7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35081.28,-1948.31C35079.65,-1939.91 35077.97,-1931.26 35076.32,-1922.72"/>
<polygon fill="black" stroke="black" points="35079.72,-1921.91 35074.38,-1912.76 35072.85,-1923.24 35079.72,-1921.91"/>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep7 -->
<g id="node255" class="node">
<title>layer4_expert_mlp_dp1_tp0_ep7</title>
<polygon fill="lightblue" stroke="black" points="35493.83,-1740.5 35142.83,-1740.5 35142.83,-1672.5 35493.83,-1672.5 35493.83,-1740.5"/>
<text text-anchor="middle" x="35318.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="35318.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 139</text>
<text text-anchor="middle" x="35318.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="35318.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp0_ep7&#45;&gt;layer4_expert_mlp_dp1_tp0_ep7 -->
<g id="edge255" class="edge">
<title>layer4_dispatch_dp1_tp0_ep7&#45;&gt;layer4_expert_mlp_dp1_tp0_ep7</title>
<path fill="none" stroke="black" d="M35187.94,-1776.5C35208.2,-1765.78 35228.51,-1755.03 35246.88,-1745.31"/>
<polygon fill="black" stroke="black" points="35248.52,-1748.4 35255.73,-1740.63 35245.25,-1742.21 35248.52,-1748.4"/>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep7 -->
<g id="node256" class="node">
<title>layer4_expert_proj_dp1_tp0_ep7</title>
<polygon fill="lightblue" stroke="black" points="35750.83,-1636.5 35399.83,-1636.5 35399.83,-1568.5 35750.83,-1568.5 35750.83,-1636.5"/>
<text text-anchor="middle" x="35575.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="35575.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 139</text>
<text text-anchor="middle" x="35575.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="35575.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep7&#45;&gt;layer4_expert_proj_dp1_tp0_ep7 -->
<g id="edge256" class="edge">
<title>layer4_expert_mlp_dp1_tp0_ep7&#45;&gt;layer4_expert_proj_dp1_tp0_ep7</title>
<path fill="none" stroke="black" d="M35401.77,-1672.38C35427.48,-1662.18 35455.95,-1650.88 35482.27,-1640.43"/>
<polygon fill="black" stroke="black" points="35483.86,-1643.57 35491.86,-1636.62 35481.28,-1637.06 35483.86,-1643.57"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep7 -->
<g id="node257" class="node">
<title>layer4_expert_allreduce_dp1_tp0_ep7</title>
<ellipse fill="lightyellow" stroke="black" cx="36113.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="36113.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="36113.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 139</text>
<text text-anchor="middle" x="36113.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="36113.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep7&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep7 -->
<g id="edge257" class="edge">
<title>layer4_expert_proj_dp1_tp0_ep7&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep7</title>
<path fill="none" stroke="black" d="M35728.42,-1568.47C35794.44,-1554.22 35871.98,-1537.49 35940.09,-1522.79"/>
<polygon fill="black" stroke="black" points="35941.04,-1526.17 35950.07,-1520.64 35939.56,-1519.33 35941.04,-1526.17"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep7 -->
<g id="node258" class="node">
<title>layer4_aggregate_dp1_tp0_ep7</title>
<polygon fill="lightpink" stroke="black" points="36617.27,-1400.33 36035.13,-1400.33 35885.38,-1264.33 36467.52,-1264.33 36617.27,-1400.33"/>
<text text-anchor="middle" x="36251.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="36251.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 139</text>
<text text-anchor="middle" x="36251.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="36251.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep7&#45;&gt;layer4_aggregate_dp1_tp0_ep7 -->
<g id="edge258" class="edge">
<title>layer4_expert_allreduce_dp1_tp0_ep7&#45;&gt;layer4_aggregate_dp1_tp0_ep7</title>
<path fill="none" stroke="black" d="M36156.23,-1436.75C36164.68,-1427.56 36173.74,-1417.71 36182.79,-1407.87"/>
<polygon fill="black" stroke="black" points="36185.51,-1410.08 36189.7,-1400.35 36180.36,-1405.35 36185.51,-1410.08"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep7&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge474" class="edge">
<title>layer4_aggregate_dp1_tp0_ep7&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M36488.62,-1283.35C36534.15,-1275.73 36581.58,-1268.87 36626.33,-1264.33 37113.33,-1214.94 38594.18,-1200.3 39141.31,-1196.52"/>
<polygon fill="black" stroke="black" points="39141.7,-1200.01 39151.68,-1196.44 39141.65,-1193.01 39141.7,-1200.01"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep7&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge506" class="edge">
<title>layer4_aggregate_dp1_tp0_ep7&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M36488.05,-1282.79C36533.75,-1275.19 36581.38,-1268.49 36626.33,-1264.33 36855.39,-1243.16 44197.38,-1203.45 45528.45,-1196.41"/>
<polygon fill="black" stroke="black" points="45528.62,-1199.91 45538.6,-1196.36 45528.58,-1192.91 45528.62,-1199.91"/>
</g>
<!-- layer4_dispatch_dp1_tp0_ep8 -->
<g id="node260" class="node">
<title>layer4_dispatch_dp1_tp0_ep8</title>
<polygon fill="lightgreen" stroke="black" points="36376.48,-1912.5 35689.02,-1912.5 35512.17,-1776.5 36199.63,-1776.5 36376.48,-1912.5"/>
<text text-anchor="middle" x="35944.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="35944.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 140</text>
<text text-anchor="middle" x="35944.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="35944.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp0_ep8&#45;&gt;layer4_dispatch_dp1_tp0_ep8 -->
<g id="edge260" class="edge">
<title>layer4_gate_dp1_tp0_ep8&#45;&gt;layer4_dispatch_dp1_tp0_ep8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35954.61,-1948.31C35953.77,-1939.91 35952.9,-1931.26 35952.05,-1922.72"/>
<polygon fill="black" stroke="black" points="35955.53,-1922.36 35951.05,-1912.76 35948.56,-1923.06 35955.53,-1922.36"/>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep8 -->
<g id="node261" class="node">
<title>layer4_expert_mlp_dp1_tp0_ep8</title>
<polygon fill="lightblue" stroke="black" points="36394.83,-1740.5 36043.83,-1740.5 36043.83,-1672.5 36394.83,-1672.5 36394.83,-1740.5"/>
<text text-anchor="middle" x="36219.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="36219.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 140</text>
<text text-anchor="middle" x="36219.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="36219.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp0_ep8&#45;&gt;layer4_expert_mlp_dp1_tp0_ep8 -->
<g id="edge261" class="edge">
<title>layer4_dispatch_dp1_tp0_ep8&#45;&gt;layer4_expert_mlp_dp1_tp0_ep8</title>
<path fill="none" stroke="black" d="M36079.81,-1776.5C36101.58,-1765.73 36123.42,-1754.93 36143.14,-1745.18"/>
<polygon fill="black" stroke="black" points="36144.93,-1748.2 36152.34,-1740.63 36141.83,-1741.92 36144.93,-1748.2"/>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep8 -->
<g id="node262" class="node">
<title>layer4_expert_proj_dp1_tp0_ep8</title>
<polygon fill="lightblue" stroke="black" points="36766.83,-1636.5 36415.83,-1636.5 36415.83,-1568.5 36766.83,-1568.5 36766.83,-1636.5"/>
<text text-anchor="middle" x="36591.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="36591.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 140</text>
<text text-anchor="middle" x="36591.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="36591.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep8&#45;&gt;layer4_expert_proj_dp1_tp0_ep8 -->
<g id="edge262" class="edge">
<title>layer4_expert_mlp_dp1_tp0_ep8&#45;&gt;layer4_expert_proj_dp1_tp0_ep8</title>
<path fill="none" stroke="black" d="M36339.85,-1672.45C36378.48,-1661.86 36421.44,-1650.08 36460.76,-1639.3"/>
<polygon fill="black" stroke="black" points="36461.96,-1642.6 36470.68,-1636.58 36460.11,-1635.85 36461.96,-1642.6"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep8 -->
<g id="node263" class="node">
<title>layer4_expert_allreduce_dp1_tp0_ep8</title>
<ellipse fill="lightyellow" stroke="black" cx="36728.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="36728.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="36728.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 140</text>
<text text-anchor="middle" x="36728.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="36728.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep8&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep8 -->
<g id="edge263" class="edge">
<title>layer4_expert_proj_dp1_tp0_ep8&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep8</title>
<path fill="none" stroke="black" d="M36630.58,-1568.23C36641.68,-1558.84 36654.03,-1548.37 36666.11,-1538.13"/>
<polygon fill="black" stroke="black" points="36668.64,-1540.58 36674,-1531.45 36664.11,-1535.24 36668.64,-1540.58"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep8 -->
<g id="node264" class="node">
<title>layer4_aggregate_dp1_tp0_ep8</title>
<polygon fill="lightpink" stroke="black" points="37367.27,-1400.33 36785.13,-1400.33 36635.38,-1264.33 37217.52,-1264.33 37367.27,-1400.33"/>
<text text-anchor="middle" x="37001.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="37001.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 140</text>
<text text-anchor="middle" x="37001.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="37001.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep8&#45;&gt;layer4_aggregate_dp1_tp0_ep8 -->
<g id="edge264" class="edge">
<title>layer4_expert_allreduce_dp1_tp0_ep8&#45;&gt;layer4_aggregate_dp1_tp0_ep8</title>
<path fill="none" stroke="black" d="M36809.5,-1438.79C36828.68,-1428.25 36849.62,-1416.73 36870.39,-1405.32"/>
<polygon fill="black" stroke="black" points="36872.2,-1408.32 36879.27,-1400.43 36868.82,-1402.18 36872.2,-1408.32"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep8&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge475" class="edge">
<title>layer4_aggregate_dp1_tp0_ep8&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M37238.9,-1283.65C37284.36,-1276.02 37331.69,-1269.08 37376.33,-1264.33 37713.41,-1228.5 38708.16,-1206.82 39141.58,-1198.84"/>
<polygon fill="black" stroke="black" points="39141.78,-1202.33 39151.71,-1198.65 39141.65,-1195.33 39141.78,-1202.33"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep8&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge507" class="edge">
<title>layer4_aggregate_dp1_tp0_ep8&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M37238.05,-1282.81C37283.75,-1275.21 37331.38,-1268.5 37376.33,-1264.33 37794.17,-1225.56 44282.64,-1200.51 45528.37,-1196.05"/>
<polygon fill="black" stroke="black" points="45528.78,-1199.55 45538.77,-1196.01 45528.76,-1192.55 45528.78,-1199.55"/>
</g>
<!-- layer4_dispatch_dp1_tp0_ep9 -->
<g id="node266" class="node">
<title>layer4_dispatch_dp1_tp0_ep9</title>
<polygon fill="lightgreen" stroke="black" points="37259.48,-1912.5 36572.02,-1912.5 36395.17,-1776.5 37082.63,-1776.5 37259.48,-1912.5"/>
<text text-anchor="middle" x="36827.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="36827.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 141</text>
<text text-anchor="middle" x="36827.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="36827.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp0_ep9&#45;&gt;layer4_dispatch_dp1_tp0_ep9 -->
<g id="edge266" class="edge">
<title>layer4_gate_dp1_tp0_ep9&#45;&gt;layer4_dispatch_dp1_tp0_ep9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36807.37,-1948.31C36809,-1939.91 36810.68,-1931.26 36812.34,-1922.72"/>
<polygon fill="black" stroke="black" points="36815.8,-1923.24 36814.27,-1912.76 36808.93,-1921.91 36815.8,-1923.24"/>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep9 -->
<g id="node267" class="node">
<title>layer4_expert_mlp_dp1_tp0_ep9</title>
<polygon fill="lightblue" stroke="black" points="37275.83,-1740.5 36924.83,-1740.5 36924.83,-1672.5 37275.83,-1672.5 37275.83,-1740.5"/>
<text text-anchor="middle" x="37100.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="37100.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 141</text>
<text text-anchor="middle" x="37100.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="37100.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp0_ep9&#45;&gt;layer4_expert_mlp_dp1_tp0_ep9 -->
<g id="edge267" class="edge">
<title>layer4_dispatch_dp1_tp0_ep9&#45;&gt;layer4_expert_mlp_dp1_tp0_ep9</title>
<path fill="none" stroke="black" d="M36961.83,-1776.5C36983.44,-1765.73 37005.12,-1754.93 37024.69,-1745.18"/>
<polygon fill="black" stroke="black" points="37026.44,-1748.22 37033.83,-1740.63 37023.32,-1741.95 37026.44,-1748.22"/>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep9 -->
<g id="node268" class="node">
<title>layer4_expert_proj_dp1_tp0_ep9</title>
<polygon fill="lightblue" stroke="black" points="37390.83,-1636.5 37039.83,-1636.5 37039.83,-1568.5 37390.83,-1568.5 37390.83,-1636.5"/>
<text text-anchor="middle" x="37215.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="37215.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 141</text>
<text text-anchor="middle" x="37215.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="37215.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep9&#45;&gt;layer4_expert_proj_dp1_tp0_ep9 -->
<g id="edge268" class="edge">
<title>layer4_expert_mlp_dp1_tp0_ep9&#45;&gt;layer4_expert_proj_dp1_tp0_ep9</title>
<path fill="none" stroke="black" d="M37137.66,-1672.38C37148.01,-1663.21 37159.35,-1653.15 37170.09,-1643.62"/>
<polygon fill="black" stroke="black" points="37172.62,-1646.05 37177.78,-1636.8 37167.98,-1640.82 37172.62,-1646.05"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep9 -->
<g id="node269" class="node">
<title>layer4_expert_allreduce_dp1_tp0_ep9</title>
<ellipse fill="lightyellow" stroke="black" cx="37444.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="37444.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="37444.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 141</text>
<text text-anchor="middle" x="37444.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="37444.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep9&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep9 -->
<g id="edge269" class="edge">
<title>layer4_expert_proj_dp1_tp0_ep9&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep9</title>
<path fill="none" stroke="black" d="M37280.64,-1568.39C37301.65,-1557.74 37325.38,-1545.71 37348.13,-1534.18"/>
<polygon fill="black" stroke="black" points="37349.79,-1537.26 37357.13,-1529.62 37346.62,-1531.02 37349.79,-1537.26"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep9 -->
<g id="node270" class="node">
<title>layer4_aggregate_dp1_tp0_ep9</title>
<polygon fill="lightpink" stroke="black" points="38117.27,-1400.33 37535.13,-1400.33 37385.38,-1264.33 37967.52,-1264.33 38117.27,-1400.33"/>
<text text-anchor="middle" x="37751.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="37751.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 141</text>
<text text-anchor="middle" x="37751.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="37751.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep9&#45;&gt;layer4_aggregate_dp1_tp0_ep9 -->
<g id="edge270" class="edge">
<title>layer4_expert_allreduce_dp1_tp0_ep9&#45;&gt;layer4_aggregate_dp1_tp0_ep9</title>
<path fill="none" stroke="black" d="M37534.36,-1439.4C37556.56,-1428.55 37580.91,-1416.64 37605.02,-1404.86"/>
<polygon fill="black" stroke="black" points="37606.8,-1407.88 37614.25,-1400.35 37603.72,-1401.6 37606.8,-1407.88"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep9&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge476" class="edge">
<title>layer4_aggregate_dp1_tp0_ep9&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M37989.74,-1284.3C38034.96,-1276.64 38081.99,-1269.53 38126.33,-1264.33 38481.73,-1222.69 38898.39,-1205.98 39141.61,-1199.41"/>
<polygon fill="black" stroke="black" points="39141.72,-1202.91 39151.62,-1199.14 39141.53,-1195.91 39141.72,-1202.91"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep9&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge508" class="edge">
<title>layer4_aggregate_dp1_tp0_ep9&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M37988.06,-1282.84C38033.75,-1275.24 38081.38,-1268.52 38126.33,-1264.33 38504.62,-1229.08 44349.57,-1201.45 45528.16,-1196.23"/>
<polygon fill="black" stroke="black" points="45528.44,-1199.72 45538.43,-1196.18 45528.41,-1192.72 45528.44,-1199.72"/>
</g>
<!-- layer4_dispatch_dp1_tp0_ep10 -->
<g id="node272" class="node">
<title>layer4_dispatch_dp1_tp0_ep10</title>
<polygon fill="lightgreen" stroke="black" points="38142.48,-1912.5 37455.02,-1912.5 37278.17,-1776.5 37965.63,-1776.5 38142.48,-1912.5"/>
<text text-anchor="middle" x="37710.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="37710.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 142</text>
<text text-anchor="middle" x="37710.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="37710.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp0_ep10&#45;&gt;layer4_dispatch_dp1_tp0_ep10 -->
<g id="edge272" class="edge">
<title>layer4_gate_dp1_tp0_ep10&#45;&gt;layer4_dispatch_dp1_tp0_ep10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37680.09,-1948.31C37682.59,-1939.81 37685.16,-1931.07 37687.7,-1922.44"/>
<polygon fill="black" stroke="black" points="37691.08,-1923.34 37690.54,-1912.76 37684.37,-1921.36 37691.08,-1923.34"/>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep10 -->
<g id="node273" class="node">
<title>layer4_expert_mlp_dp1_tp0_ep10</title>
<polygon fill="lightblue" stroke="black" points="38142.83,-1740.5 37791.83,-1740.5 37791.83,-1672.5 38142.83,-1672.5 38142.83,-1740.5"/>
<text text-anchor="middle" x="37967.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="37967.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 142</text>
<text text-anchor="middle" x="37967.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="37967.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp0_ep10&#45;&gt;layer4_expert_mlp_dp1_tp0_ep10 -->
<g id="edge273" class="edge">
<title>layer4_dispatch_dp1_tp0_ep10&#45;&gt;layer4_expert_mlp_dp1_tp0_ep10</title>
<path fill="none" stroke="black" d="M37836.94,-1776.5C37857.2,-1765.78 37877.51,-1755.03 37895.88,-1745.31"/>
<polygon fill="black" stroke="black" points="37897.52,-1748.4 37904.73,-1740.63 37894.25,-1742.21 37897.52,-1748.4"/>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep10 -->
<g id="node274" class="node">
<title>layer4_expert_proj_dp1_tp0_ep10</title>
<polygon fill="lightblue" stroke="black" points="38296.83,-1636.5 37945.83,-1636.5 37945.83,-1568.5 38296.83,-1568.5 38296.83,-1636.5"/>
<text text-anchor="middle" x="38121.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="38121.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 142</text>
<text text-anchor="middle" x="38121.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="38121.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep10&#45;&gt;layer4_expert_proj_dp1_tp0_ep10 -->
<g id="edge274" class="edge">
<title>layer4_expert_mlp_dp1_tp0_ep10&#45;&gt;layer4_expert_proj_dp1_tp0_ep10</title>
<path fill="none" stroke="black" d="M38017.33,-1672.38C38031.79,-1662.8 38047.71,-1652.26 38062.65,-1642.36"/>
<polygon fill="black" stroke="black" points="38064.91,-1645.06 38071.31,-1636.62 38061.04,-1639.23 38064.91,-1645.06"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep10 -->
<g id="node275" class="node">
<title>layer4_expert_allreduce_dp1_tp0_ep10</title>
<ellipse fill="lightyellow" stroke="black" cx="38166.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="38166.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="38166.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 142</text>
<text text-anchor="middle" x="38166.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="38166.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep10&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep10 -->
<g id="edge275" class="edge">
<title>layer4_expert_proj_dp1_tp0_ep10&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep10</title>
<path fill="none" stroke="black" d="M38134.22,-1568.23C38137.42,-1559.98 38140.94,-1550.9 38144.44,-1541.88"/>
<polygon fill="black" stroke="black" points="38147.71,-1543.11 38148.06,-1532.53 38141.19,-1540.58 38147.71,-1543.11"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep10 -->
<g id="node276" class="node">
<title>layer4_aggregate_dp1_tp0_ep10</title>
<polygon fill="lightpink" stroke="black" points="38867.27,-1400.33 38285.13,-1400.33 38135.38,-1264.33 38717.52,-1264.33 38867.27,-1400.33"/>
<text text-anchor="middle" x="38501.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="38501.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 142</text>
<text text-anchor="middle" x="38501.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="38501.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep10&#45;&gt;layer4_aggregate_dp1_tp0_ep10 -->
<g id="edge276" class="edge">
<title>layer4_expert_allreduce_dp1_tp0_ep10&#45;&gt;layer4_aggregate_dp1_tp0_ep10</title>
<path fill="none" stroke="black" d="M38263.22,-1440.01C38288.05,-1428.88 38315.41,-1416.63 38342.47,-1404.5"/>
<polygon fill="black" stroke="black" points="38343.93,-1407.68 38351.63,-1400.4 38341.07,-1401.29 38343.93,-1407.68"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep10&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge477" class="edge">
<title>layer4_aggregate_dp1_tp0_ep10&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M38742.7,-1287.06C38787.1,-1279.24 38833.08,-1271.36 38876.33,-1264.33 38963.14,-1250.22 39059.17,-1235.92 39141.76,-1224.02"/>
<polygon fill="black" stroke="black" points="39142.36,-1227.47 39151.76,-1222.58 39141.36,-1220.54 39142.36,-1227.47"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep10&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge509" class="edge">
<title>layer4_aggregate_dp1_tp0_ep10&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M38738.06,-1282.88C38783.75,-1275.27 38831.39,-1268.54 38876.33,-1264.33 39551.67,-1201.05 44458.32,-1195.76 45528.55,-1195.36"/>
<polygon fill="black" stroke="black" points="45528.65,-1198.86 45538.65,-1195.35 45528.65,-1191.86 45528.65,-1198.86"/>
</g>
<!-- layer4_dispatch_dp1_tp0_ep11 -->
<g id="node278" class="node">
<title>layer4_dispatch_dp1_tp0_ep11</title>
<polygon fill="lightgreen" stroke="black" points="39025.48,-1912.5 38338.02,-1912.5 38161.17,-1776.5 38848.63,-1776.5 39025.48,-1912.5"/>
<text text-anchor="middle" x="38593.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="38593.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 143</text>
<text text-anchor="middle" x="38593.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="38593.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp0_ep11&#45;&gt;layer4_dispatch_dp1_tp0_ep11 -->
<g id="edge278" class="edge">
<title>layer4_gate_dp1_tp0_ep11&#45;&gt;layer4_dispatch_dp1_tp0_ep11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38557.64,-1948.31C38560.59,-1939.81 38563.63,-1931.07 38566.62,-1922.44"/>
<polygon fill="black" stroke="black" points="38570.01,-1923.35 38569.98,-1912.76 38563.4,-1921.06 38570.01,-1923.35"/>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep11 -->
<g id="node279" class="node">
<title>layer4_expert_mlp_dp1_tp0_ep11</title>
<polygon fill="lightblue" stroke="black" points="38915.83,-1740.5 38564.83,-1740.5 38564.83,-1672.5 38915.83,-1672.5 38915.83,-1740.5"/>
<text text-anchor="middle" x="38740.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="38740.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 143</text>
<text text-anchor="middle" x="38740.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="38740.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp0_ep11&#45;&gt;layer4_expert_mlp_dp1_tp0_ep11 -->
<g id="edge279" class="edge">
<title>layer4_dispatch_dp1_tp0_ep11&#45;&gt;layer4_expert_mlp_dp1_tp0_ep11</title>
<path fill="none" stroke="black" d="M38665.96,-1776.3C38676.69,-1766.38 38687.43,-1756.44 38697.29,-1747.32"/>
<polygon fill="black" stroke="black" points="38699.68,-1749.88 38704.64,-1740.52 38694.92,-1744.74 38699.68,-1749.88"/>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep11 -->
<g id="node280" class="node">
<title>layer4_expert_proj_dp1_tp0_ep11</title>
<polygon fill="lightblue" stroke="black" points="39176.83,-1636.5 38825.83,-1636.5 38825.83,-1568.5 39176.83,-1568.5 39176.83,-1636.5"/>
<text text-anchor="middle" x="39001.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="39001.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 143</text>
<text text-anchor="middle" x="39001.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="39001.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep11&#45;&gt;layer4_expert_proj_dp1_tp0_ep11 -->
<g id="edge280" class="edge">
<title>layer4_expert_mlp_dp1_tp0_ep11&#45;&gt;layer4_expert_proj_dp1_tp0_ep11</title>
<path fill="none" stroke="black" d="M38825.07,-1672.38C38851.3,-1662.13 38880.35,-1650.78 38907.18,-1640.29"/>
<polygon fill="black" stroke="black" points="38908.53,-1643.52 38916.57,-1636.62 38905.98,-1637 38908.53,-1643.52"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep11 -->
<g id="node281" class="node">
<title>layer4_expert_allreduce_dp1_tp0_ep11</title>
<ellipse fill="lightyellow" stroke="black" cx="39039.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="39039.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="39039.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 143</text>
<text text-anchor="middle" x="39039.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="39039.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep11&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep11 -->
<g id="edge281" class="edge">
<title>layer4_expert_proj_dp1_tp0_ep11&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep11</title>
<path fill="none" stroke="black" d="M39012.22,-1568.23C39014.89,-1560.07 39017.83,-1551.09 39020.75,-1542.16"/>
<polygon fill="black" stroke="black" points="39024.12,-1543.12 39023.9,-1532.53 39017.47,-1540.94 39024.12,-1543.12"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep11 -->
<g id="node282" class="node">
<title>layer4_aggregate_dp1_tp0_ep11</title>
<polygon fill="lightpink" stroke="black" points="39617.27,-1400.33 39035.13,-1400.33 38885.38,-1264.33 39467.52,-1264.33 39617.27,-1400.33"/>
<text text-anchor="middle" x="39251.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="39251.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 143</text>
<text text-anchor="middle" x="39251.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="39251.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep11&#45;&gt;layer4_aggregate_dp1_tp0_ep11 -->
<g id="edge282" class="edge">
<title>layer4_expert_allreduce_dp1_tp0_ep11&#45;&gt;layer4_aggregate_dp1_tp0_ep11</title>
<path fill="none" stroke="black" d="M39103.8,-1437.78C39117.78,-1427.88 39132.9,-1417.17 39147.95,-1406.52"/>
<polygon fill="black" stroke="black" points="39150.16,-1409.24 39156.3,-1400.61 39146.11,-1403.53 39150.16,-1409.24"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep11&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge478" class="edge">
<title>layer4_aggregate_dp1_tp0_ep11&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M39298.76,-1264.13C39305.35,-1254.79 39311.96,-1245.44 39318.08,-1236.77"/>
<polygon fill="black" stroke="black" points="39321.11,-1238.54 39324.02,-1228.35 39315.39,-1234.5 39321.11,-1238.54"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep11&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge510" class="edge">
<title>layer4_aggregate_dp1_tp0_ep11&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M39488.06,-1282.92C39533.76,-1275.31 39581.39,-1268.57 39626.33,-1264.33 40223.2,-1208.03 44531.43,-1197.36 45528.65,-1195.63"/>
<polygon fill="black" stroke="black" points="45528.8,-1199.13 45538.8,-1195.62 45528.79,-1192.13 45528.8,-1199.13"/>
</g>
<!-- layer4_dispatch_dp1_tp0_ep12 -->
<g id="node284" class="node">
<title>layer4_dispatch_dp1_tp0_ep12</title>
<polygon fill="lightgreen" stroke="black" points="39908.48,-1912.5 39221.02,-1912.5 39044.17,-1776.5 39731.63,-1776.5 39908.48,-1912.5"/>
<text text-anchor="middle" x="39476.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="39476.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 144</text>
<text text-anchor="middle" x="39476.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="39476.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp0_ep12&#45;&gt;layer4_dispatch_dp1_tp0_ep12 -->
<g id="edge284" class="edge">
<title>layer4_gate_dp1_tp0_ep12&#45;&gt;layer4_dispatch_dp1_tp0_ep12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39438.23,-1948.31C39441.41,-1939.72 39444.68,-1930.88 39447.92,-1922.16"/>
<polygon fill="black" stroke="black" points="39451.21,-1923.35 39451.4,-1912.76 39444.64,-1920.92 39451.21,-1923.35"/>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep12 -->
<g id="node285" class="node">
<title>layer4_expert_mlp_dp1_tp0_ep12</title>
<polygon fill="lightblue" stroke="black" points="39764.83,-1740.5 39413.83,-1740.5 39413.83,-1672.5 39764.83,-1672.5 39764.83,-1740.5"/>
<text text-anchor="middle" x="39589.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="39589.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 144</text>
<text text-anchor="middle" x="39589.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="39589.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp0_ep12&#45;&gt;layer4_expert_mlp_dp1_tp0_ep12 -->
<g id="edge285" class="edge">
<title>layer4_dispatch_dp1_tp0_ep12&#45;&gt;layer4_expert_mlp_dp1_tp0_ep12</title>
<path fill="none" stroke="black" d="M39532.16,-1776.3C39540.08,-1766.77 39548.02,-1757.22 39555.35,-1748.39"/>
<polygon fill="black" stroke="black" points="39558.19,-1750.44 39561.89,-1740.52 39552.81,-1745.97 39558.19,-1750.44"/>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep12 -->
<g id="node286" class="node">
<title>layer4_expert_proj_dp1_tp0_ep12</title>
<polygon fill="lightblue" stroke="black" points="39839.83,-1636.5 39488.83,-1636.5 39488.83,-1568.5 39839.83,-1568.5 39839.83,-1636.5"/>
<text text-anchor="middle" x="39664.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="39664.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 144</text>
<text text-anchor="middle" x="39664.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="39664.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep12&#45;&gt;layer4_expert_proj_dp1_tp0_ep12 -->
<g id="edge286" class="edge">
<title>layer4_expert_mlp_dp1_tp0_ep12&#45;&gt;layer4_expert_proj_dp1_tp0_ep12</title>
<path fill="none" stroke="black" d="M39613.68,-1672.38C39620.09,-1663.65 39627.1,-1654.12 39633.8,-1645.01"/>
<polygon fill="black" stroke="black" points="39636.74,-1646.93 39639.84,-1636.8 39631.1,-1642.78 39636.74,-1646.93"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep12 -->
<g id="node287" class="node">
<title>layer4_expert_allreduce_dp1_tp0_ep12</title>
<ellipse fill="lightyellow" stroke="black" cx="39776.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="39776.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="39776.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 144</text>
<text text-anchor="middle" x="39776.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="39776.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep12&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep12 -->
<g id="edge287" class="edge">
<title>layer4_expert_proj_dp1_tp0_ep12&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep12</title>
<path fill="none" stroke="black" d="M39696.42,-1568.23C39705.07,-1559.27 39714.67,-1549.32 39724.11,-1539.53"/>
<polygon fill="black" stroke="black" points="39726.87,-1541.72 39731.29,-1532.09 39721.83,-1536.86 39726.87,-1541.72"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep12 -->
<g id="node288" class="node">
<title>layer4_aggregate_dp1_tp0_ep12</title>
<polygon fill="lightpink" stroke="black" points="40367.27,-1400.33 39785.13,-1400.33 39635.38,-1264.33 40217.52,-1264.33 40367.27,-1400.33"/>
<text text-anchor="middle" x="40001.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="40001.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 144</text>
<text text-anchor="middle" x="40001.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="40001.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep12&#45;&gt;layer4_aggregate_dp1_tp0_ep12 -->
<g id="edge288" class="edge">
<title>layer4_expert_allreduce_dp1_tp0_ep12&#45;&gt;layer4_aggregate_dp1_tp0_ep12</title>
<path fill="none" stroke="black" d="M39844.44,-1437.98C39859.53,-1427.91 39875.89,-1417 39892.16,-1406.15"/>
<polygon fill="black" stroke="black" points="39894.27,-1408.95 39900.65,-1400.49 39890.39,-1403.13 39894.27,-1408.95"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep12&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge479" class="edge">
<title>layer4_aggregate_dp1_tp0_ep12&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M39679.12,-1264.33C39622.74,-1252.61 39566.18,-1240.84 39516.13,-1230.44"/>
<polygon fill="black" stroke="black" points="39516.71,-1226.98 39506.21,-1228.37 39515.29,-1233.84 39516.71,-1226.98"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep12&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge511" class="edge">
<title>layer4_aggregate_dp1_tp0_ep12&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M40238.07,-1282.98C40283.76,-1275.36 40331.39,-1268.61 40376.33,-1264.33 40894.99,-1215 44608.87,-1199.17 45528.66,-1195.98"/>
<polygon fill="black" stroke="black" points="45528.7,-1199.48 45538.69,-1195.95 45528.68,-1192.48 45528.7,-1199.48"/>
</g>
<!-- layer4_dispatch_dp1_tp0_ep13 -->
<g id="node290" class="node">
<title>layer4_dispatch_dp1_tp0_ep13</title>
<polygon fill="lightgreen" stroke="black" points="40791.48,-1912.5 40104.02,-1912.5 39927.17,-1776.5 40614.63,-1776.5 40791.48,-1912.5"/>
<text text-anchor="middle" x="40359.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="40359.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 145</text>
<text text-anchor="middle" x="40359.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="40359.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp0_ep13&#45;&gt;layer4_dispatch_dp1_tp0_ep13 -->
<g id="edge290" class="edge">
<title>layer4_gate_dp1_tp0_ep13&#45;&gt;layer4_dispatch_dp1_tp0_ep13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40320.02,-1948.31C40323.3,-1939.72 40326.68,-1930.88 40330.02,-1922.16"/>
<polygon fill="black" stroke="black" points="40333.31,-1923.35 40333.61,-1912.76 40326.77,-1920.85 40333.31,-1923.35"/>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep13 -->
<g id="node291" class="node">
<title>layer4_expert_mlp_dp1_tp0_ep13</title>
<polygon fill="lightblue" stroke="black" points="40580.83,-1740.5 40229.83,-1740.5 40229.83,-1672.5 40580.83,-1672.5 40580.83,-1740.5"/>
<text text-anchor="middle" x="40405.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="40405.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 145</text>
<text text-anchor="middle" x="40405.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="40405.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp0_ep13&#45;&gt;layer4_expert_mlp_dp1_tp0_ep13 -->
<g id="edge291" class="edge">
<title>layer4_dispatch_dp1_tp0_ep13&#45;&gt;layer4_expert_mlp_dp1_tp0_ep13</title>
<path fill="none" stroke="black" d="M40382.06,-1776.3C40385.08,-1767.35 40388.11,-1758.39 40390.94,-1750.02"/>
<polygon fill="black" stroke="black" points="40394.27,-1751.11 40394.16,-1740.52 40387.64,-1748.87 40394.27,-1751.11"/>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep13 -->
<g id="node292" class="node">
<title>layer4_expert_proj_dp1_tp0_ep13</title>
<polygon fill="lightblue" stroke="black" points="40680.83,-1636.5 40329.83,-1636.5 40329.83,-1568.5 40680.83,-1568.5 40680.83,-1636.5"/>
<text text-anchor="middle" x="40505.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="40505.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 145</text>
<text text-anchor="middle" x="40505.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="40505.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep13&#45;&gt;layer4_expert_proj_dp1_tp0_ep13 -->
<g id="edge292" class="edge">
<title>layer4_expert_mlp_dp1_tp0_ep13&#45;&gt;layer4_expert_proj_dp1_tp0_ep13</title>
<path fill="none" stroke="black" d="M40437.79,-1672.38C40446.61,-1663.39 40456.27,-1653.54 40465.45,-1644.18"/>
<polygon fill="black" stroke="black" points="40468.18,-1646.39 40472.68,-1636.8 40463.18,-1641.49 40468.18,-1646.39"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep13 -->
<g id="node293" class="node">
<title>layer4_expert_allreduce_dp1_tp0_ep13</title>
<ellipse fill="lightyellow" stroke="black" cx="40704.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="40704.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="40704.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 145</text>
<text text-anchor="middle" x="40704.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="40704.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep13&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep13 -->
<g id="edge293" class="edge">
<title>layer4_expert_proj_dp1_tp0_ep13&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep13</title>
<path fill="none" stroke="black" d="M40562.09,-1568.39C40579.72,-1558.1 40599.56,-1546.53 40618.71,-1535.36"/>
<polygon fill="black" stroke="black" points="40620.57,-1538.33 40627.44,-1530.26 40617.04,-1532.28 40620.57,-1538.33"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep13 -->
<g id="node294" class="node">
<title>layer4_aggregate_dp1_tp0_ep13</title>
<polygon fill="lightpink" stroke="black" points="41117.27,-1400.33 40535.13,-1400.33 40385.38,-1264.33 40967.52,-1264.33 41117.27,-1400.33"/>
<text text-anchor="middle" x="40751.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="40751.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 145</text>
<text text-anchor="middle" x="40751.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="40751.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep13&#45;&gt;layer4_aggregate_dp1_tp0_ep13 -->
<g id="edge294" class="edge">
<title>layer4_expert_allreduce_dp1_tp0_ep13&#45;&gt;layer4_aggregate_dp1_tp0_ep13</title>
<path fill="none" stroke="black" d="M40719.07,-1436.34C40721.68,-1428.01 40724.46,-1419.14 40727.24,-1410.23"/>
<polygon fill="black" stroke="black" points="40730.62,-1411.17 40730.27,-1400.58 40723.94,-1409.08 40730.62,-1411.17"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep13&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge480" class="edge">
<title>layer4_aggregate_dp1_tp0_ep13&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M40386.71,-1265.63C40383.24,-1265.19 40379.77,-1264.76 40376.33,-1264.33 40092.19,-1229.53 39761.6,-1211.29 39553.41,-1202.49"/>
<polygon fill="black" stroke="black" points="39553.42,-1198.99 39543.28,-1202.07 39553.13,-1205.98 39553.42,-1198.99"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep13&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge512" class="edge">
<title>layer4_aggregate_dp1_tp0_ep13&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M40988.33,-1283.01C41033.94,-1275.41 41081.48,-1268.65 41126.33,-1264.33 41567.11,-1221.94 44691.66,-1201.27 45528.55,-1196.45"/>
<polygon fill="black" stroke="black" points="45528.61,-1199.95 45538.59,-1196.39 45528.57,-1192.95 45528.61,-1199.95"/>
</g>
<!-- layer4_dispatch_dp1_tp0_ep14 -->
<g id="node296" class="node">
<title>layer4_dispatch_dp1_tp0_ep14</title>
<polygon fill="lightgreen" stroke="black" points="41674.48,-1912.5 40987.02,-1912.5 40810.17,-1776.5 41497.63,-1776.5 41674.48,-1912.5"/>
<text text-anchor="middle" x="41242.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="41242.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 146</text>
<text text-anchor="middle" x="41242.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="41242.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp0_ep14&#45;&gt;layer4_dispatch_dp1_tp0_ep14 -->
<g id="edge296" class="edge">
<title>layer4_gate_dp1_tp0_ep14&#45;&gt;layer4_dispatch_dp1_tp0_ep14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41202.41,-1948.31C41205.75,-1939.72 41209.18,-1930.88 41212.56,-1922.16"/>
<polygon fill="black" stroke="black" points="41215.86,-1923.35 41216.21,-1912.76 41209.33,-1920.81 41215.86,-1923.35"/>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep14 -->
<g id="node297" class="node">
<title>layer4_expert_mlp_dp1_tp0_ep14</title>
<polygon fill="lightblue" stroke="black" points="41449.83,-1740.5 41098.83,-1740.5 41098.83,-1672.5 41449.83,-1672.5 41449.83,-1740.5"/>
<text text-anchor="middle" x="41274.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="41274.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 146</text>
<text text-anchor="middle" x="41274.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="41274.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp0_ep14&#45;&gt;layer4_expert_mlp_dp1_tp0_ep14 -->
<g id="edge297" class="edge">
<title>layer4_dispatch_dp1_tp0_ep14&#45;&gt;layer4_expert_mlp_dp1_tp0_ep14</title>
<path fill="none" stroke="black" d="M41258.14,-1776.3C41260.22,-1767.45 41262.31,-1758.58 41264.26,-1750.29"/>
<polygon fill="black" stroke="black" points="41267.67,-1751.05 41266.56,-1740.52 41260.86,-1749.45 41267.67,-1751.05"/>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep14 -->
<g id="node298" class="node">
<title>layer4_expert_proj_dp1_tp0_ep14</title>
<polygon fill="lightblue" stroke="black" points="41582.83,-1636.5 41231.83,-1636.5 41231.83,-1568.5 41582.83,-1568.5 41582.83,-1636.5"/>
<text text-anchor="middle" x="41407.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="41407.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 146</text>
<text text-anchor="middle" x="41407.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="41407.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep14&#45;&gt;layer4_expert_proj_dp1_tp0_ep14 -->
<g id="edge298" class="edge">
<title>layer4_expert_mlp_dp1_tp0_ep14&#45;&gt;layer4_expert_proj_dp1_tp0_ep14</title>
<path fill="none" stroke="black" d="M41317.51,-1672.38C41329.7,-1663.03 41343.1,-1652.76 41355.73,-1643.07"/>
<polygon fill="black" stroke="black" points="41358.1,-1645.66 41363.91,-1636.8 41353.84,-1640.11 41358.1,-1645.66"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep14 -->
<g id="node299" class="node">
<title>layer4_expert_allreduce_dp1_tp0_ep14</title>
<ellipse fill="lightyellow" stroke="black" cx="41438.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="41438.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="41438.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 146</text>
<text text-anchor="middle" x="41438.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="41438.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep14&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep14 -->
<g id="edge299" class="edge">
<title>layer4_expert_proj_dp1_tp0_ep14&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep14</title>
<path fill="none" stroke="black" d="M41416.21,-1568.23C41418.37,-1560.15 41420.74,-1551.29 41423.1,-1542.45"/>
<polygon fill="black" stroke="black" points="41426.55,-1543.09 41425.75,-1532.53 41419.78,-1541.28 41426.55,-1543.09"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep14 -->
<g id="node300" class="node">
<title>layer4_aggregate_dp1_tp0_ep14</title>
<polygon fill="lightpink" stroke="black" points="41867.27,-1400.33 41285.13,-1400.33 41135.38,-1264.33 41717.52,-1264.33 41867.27,-1400.33"/>
<text text-anchor="middle" x="41501.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="41501.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 146</text>
<text text-anchor="middle" x="41501.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="41501.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep14&#45;&gt;layer4_aggregate_dp1_tp0_ep14 -->
<g id="edge300" class="edge">
<title>layer4_expert_allreduce_dp1_tp0_ep14&#45;&gt;layer4_aggregate_dp1_tp0_ep14</title>
<path fill="none" stroke="black" d="M41458.09,-1436.34C41461.62,-1427.92 41465.39,-1418.95 41469.17,-1409.95"/>
<polygon fill="black" stroke="black" points="41472.46,-1411.15 41473.1,-1400.58 41466,-1408.45 41472.46,-1411.15"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep14&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge481" class="edge">
<title>layer4_aggregate_dp1_tp0_ep14&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M41136.23,-1265.43C41132.92,-1265.06 41129.61,-1264.69 41126.33,-1264.33 40827.28,-1231.97 39954.61,-1208.93 39553.43,-1199.75"/>
<polygon fill="black" stroke="black" points="39553.24,-1196.24 39543.16,-1199.51 39553.08,-1203.24 39553.24,-1196.24"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep14&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge513" class="edge">
<title>layer4_aggregate_dp1_tp0_ep14&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M41738.34,-1283.12C41783.95,-1275.5 41831.48,-1268.71 41876.33,-1264.33 42594.53,-1194.2 44836.31,-1193.24 45528.59,-1194.7"/>
<polygon fill="black" stroke="black" points="45528.66,-1198.2 45538.67,-1194.72 45528.68,-1191.2 45528.66,-1198.2"/>
</g>
<!-- layer4_dispatch_dp1_tp0_ep15 -->
<g id="node302" class="node">
<title>layer4_dispatch_dp1_tp0_ep15</title>
<polygon fill="lightgreen" stroke="black" points="42557.48,-1912.5 41870.02,-1912.5 41693.17,-1776.5 42380.63,-1776.5 42557.48,-1912.5"/>
<text text-anchor="middle" x="42125.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="42125.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 147</text>
<text text-anchor="middle" x="42125.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="42125.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp0_ep15&#45;&gt;layer4_dispatch_dp1_tp0_ep15 -->
<g id="edge302" class="edge">
<title>layer4_gate_dp1_tp0_ep15&#45;&gt;layer4_dispatch_dp1_tp0_ep15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42085.41,-1948.31C42088.75,-1939.72 42092.18,-1930.88 42095.56,-1922.16"/>
<polygon fill="black" stroke="black" points="42098.86,-1923.35 42099.21,-1912.76 42092.33,-1920.81 42098.86,-1923.35"/>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep15 -->
<g id="node303" class="node">
<title>layer4_expert_mlp_dp1_tp0_ep15</title>
<polygon fill="lightblue" stroke="black" points="42314.83,-1740.5 41963.83,-1740.5 41963.83,-1672.5 42314.83,-1672.5 42314.83,-1740.5"/>
<text text-anchor="middle" x="42139.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="42139.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 147</text>
<text text-anchor="middle" x="42139.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="42139.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp0_ep15&#45;&gt;layer4_expert_mlp_dp1_tp0_ep15 -->
<g id="edge303" class="edge">
<title>layer4_dispatch_dp1_tp0_ep15&#45;&gt;layer4_expert_mlp_dp1_tp0_ep15</title>
<path fill="none" stroke="black" d="M42132.24,-1776.3C42133.14,-1767.54 42134.05,-1758.77 42134.89,-1750.57"/>
<polygon fill="black" stroke="black" points="42138.38,-1750.82 42135.93,-1740.52 42131.42,-1750.11 42138.38,-1750.82"/>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep15 -->
<g id="node304" class="node">
<title>layer4_expert_proj_dp1_tp0_ep15</title>
<polygon fill="lightblue" stroke="black" points="42347.83,-1636.5 41996.83,-1636.5 41996.83,-1568.5 42347.83,-1568.5 42347.83,-1636.5"/>
<text text-anchor="middle" x="42172.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="42172.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 147</text>
<text text-anchor="middle" x="42172.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="42172.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp0_ep15&#45;&gt;layer4_expert_proj_dp1_tp0_ep15 -->
<g id="edge304" class="edge">
<title>layer4_expert_mlp_dp1_tp0_ep15&#45;&gt;layer4_expert_proj_dp1_tp0_ep15</title>
<path fill="none" stroke="black" d="M42150.04,-1672.38C42152.72,-1664.1 42155.63,-1655.09 42158.44,-1646.41"/>
<polygon fill="black" stroke="black" points="42161.8,-1647.39 42161.55,-1636.8 42155.14,-1645.24 42161.8,-1647.39"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep15 -->
<g id="node305" class="node">
<title>layer4_expert_allreduce_dp1_tp0_ep15</title>
<ellipse fill="lightyellow" stroke="black" cx="42238.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="42238.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="42238.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 147</text>
<text text-anchor="middle" x="42238.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="42238.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp0_ep15&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep15 -->
<g id="edge305" class="edge">
<title>layer4_expert_proj_dp1_tp0_ep15&#45;&gt;layer4_expert_allreduce_dp1_tp0_ep15</title>
<path fill="none" stroke="black" d="M42191.24,-1568.23C42196.03,-1559.81 42201.31,-1550.52 42206.55,-1541.31"/>
<polygon fill="black" stroke="black" points="42209.64,-1542.95 42211.54,-1532.53 42203.56,-1539.49 42209.64,-1542.95"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep15 -->
<g id="node306" class="node">
<title>layer4_aggregate_dp1_tp0_ep15</title>
<polygon fill="lightpink" stroke="black" points="42617.27,-1400.33 42035.13,-1400.33 41885.38,-1264.33 42467.52,-1264.33 42617.27,-1400.33"/>
<text text-anchor="middle" x="42251.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="42251.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 147</text>
<text text-anchor="middle" x="42251.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="42251.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp0_ep15&#45;&gt;layer4_aggregate_dp1_tp0_ep15 -->
<g id="edge306" class="edge">
<title>layer4_expert_allreduce_dp1_tp0_ep15&#45;&gt;layer4_aggregate_dp1_tp0_ep15</title>
<path fill="none" stroke="black" d="M42242.44,-1435.93C42243.14,-1427.84 42243.88,-1419.26 42244.63,-1410.64"/>
<polygon fill="black" stroke="black" points="42248.13,-1410.79 42245.51,-1400.53 42241.16,-1410.19 42248.13,-1410.79"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep15&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge482" class="edge">
<title>layer4_aggregate_dp1_tp0_ep15&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M41886.24,-1265.38C41882.92,-1265.02 41879.62,-1264.67 41876.33,-1264.33 41427.89,-1218.42 40072.69,-1201.77 39553.12,-1196.98"/>
<polygon fill="black" stroke="black" points="39552.92,-1193.48 39542.89,-1196.88 39552.86,-1200.48 39552.92,-1193.48"/>
</g>
<!-- layer4_aggregate_dp1_tp0_ep15&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge514" class="edge">
<title>layer4_aggregate_dp1_tp0_ep15&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M42488.61,-1283.23C42534.14,-1275.62 42581.58,-1268.8 42626.33,-1264.33 43191.73,-1207.89 44929.64,-1197.62 45528.77,-1195.75"/>
<polygon fill="black" stroke="black" points="45528.82,-1199.25 45538.81,-1195.72 45528.8,-1192.25 45528.82,-1199.25"/>
</g>
<!-- layer4_dispatch_dp1_tp1_ep0 -->
<g id="node308" class="node">
<title>layer4_dispatch_dp1_tp1_ep0</title>
<polygon fill="lightgreen" stroke="black" points="43440.48,-1912.5 42753.02,-1912.5 42576.17,-1776.5 43263.63,-1776.5 43440.48,-1912.5"/>
<text text-anchor="middle" x="43008.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="43008.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 196</text>
<text text-anchor="middle" x="43008.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="43008.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp1_ep0&#45;&gt;layer4_dispatch_dp1_tp1_ep0 -->
<g id="edge308" class="edge">
<title>layer4_gate_dp1_tp1_ep0&#45;&gt;layer4_dispatch_dp1_tp1_ep0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43028.28,-1948.31C43026.65,-1939.91 43024.97,-1931.26 43023.32,-1922.72"/>
<polygon fill="black" stroke="black" points="43026.72,-1921.91 43021.38,-1912.76 43019.85,-1923.24 43026.72,-1921.91"/>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep0 -->
<g id="node309" class="node">
<title>layer4_expert_mlp_dp1_tp1_ep0</title>
<polygon fill="lightblue" stroke="black" points="43181.83,-1740.5 42830.83,-1740.5 42830.83,-1672.5 43181.83,-1672.5 43181.83,-1740.5"/>
<text text-anchor="middle" x="43006.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="43006.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 196</text>
<text text-anchor="middle" x="43006.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="43006.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp1_ep0&#45;&gt;layer4_expert_mlp_dp1_tp1_ep0 -->
<g id="edge309" class="edge">
<title>layer4_dispatch_dp1_tp1_ep0&#45;&gt;layer4_expert_mlp_dp1_tp1_ep0</title>
<path fill="none" stroke="black" d="M43007.34,-1776.3C43007.21,-1767.54 43007.08,-1758.77 43006.96,-1750.57"/>
<polygon fill="black" stroke="black" points="43010.46,-1750.46 43006.81,-1740.52 43003.46,-1750.57 43010.46,-1750.46"/>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep0 -->
<g id="node310" class="node">
<title>layer4_expert_proj_dp1_tp1_ep0</title>
<polygon fill="lightblue" stroke="black" points="43177.83,-1636.5 42826.83,-1636.5 42826.83,-1568.5 43177.83,-1568.5 43177.83,-1636.5"/>
<text text-anchor="middle" x="43002.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="43002.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 196</text>
<text text-anchor="middle" x="43002.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="43002.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep0&#45;&gt;layer4_expert_proj_dp1_tp1_ep0 -->
<g id="edge310" class="edge">
<title>layer4_expert_mlp_dp1_tp1_ep0&#45;&gt;layer4_expert_proj_dp1_tp1_ep0</title>
<path fill="none" stroke="black" d="M43005.03,-1672.38C43004.71,-1664.28 43004.36,-1655.48 43004.03,-1646.97"/>
<polygon fill="black" stroke="black" points="43007.52,-1646.65 43003.63,-1636.8 43000.53,-1646.93 43007.52,-1646.65"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep0 -->
<g id="node311" class="node">
<title>layer4_expert_allreduce_dp1_tp1_ep0</title>
<ellipse fill="lightyellow" stroke="black" cx="43001.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="43001.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="43001.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 196</text>
<text text-anchor="middle" x="43001.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="43001.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep0&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep0 -->
<g id="edge311" class="edge">
<title>layer4_expert_proj_dp1_tp1_ep0&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep0</title>
<path fill="none" stroke="black" d="M43002.04,-1568.23C43001.97,-1560.24 43001.9,-1551.48 43001.82,-1542.73"/>
<polygon fill="black" stroke="black" points="43005.32,-1542.5 43001.73,-1532.53 42998.32,-1542.56 43005.32,-1542.5"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep0 -->
<g id="node312" class="node">
<title>layer4_aggregate_dp1_tp1_ep0</title>
<polygon fill="lightpink" stroke="black" points="43367.27,-1400.33 42785.13,-1400.33 42635.38,-1264.33 43217.52,-1264.33 43367.27,-1400.33"/>
<text text-anchor="middle" x="43001.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="43001.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 196</text>
<text text-anchor="middle" x="43001.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="43001.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep0&#45;&gt;layer4_aggregate_dp1_tp1_ep0 -->
<g id="edge312" class="edge">
<title>layer4_expert_allreduce_dp1_tp1_ep0&#45;&gt;layer4_aggregate_dp1_tp1_ep0</title>
<path fill="none" stroke="black" d="M43001.33,-1435.93C43001.33,-1427.84 43001.33,-1419.26 43001.33,-1410.64"/>
<polygon fill="black" stroke="black" points="43004.83,-1410.53 43001.33,-1400.53 42997.83,-1410.53 43004.83,-1410.53"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep0&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge483" class="edge">
<title>layer4_aggregate_dp1_tp1_ep0&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M42636.24,-1265.35C42632.92,-1265 42629.62,-1264.66 42626.33,-1264.33 42026.36,-1204.79 40175.13,-1196.54 39553.39,-1195.47"/>
<polygon fill="black" stroke="black" points="39552.98,-1191.97 39542.98,-1195.45 39552.97,-1198.97 39552.98,-1191.97"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep0&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge515" class="edge">
<title>layer4_aggregate_dp1_tp1_ep0&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M43238.63,-1283.49C43284.17,-1275.85 43331.59,-1268.96 43376.33,-1264.33 43790.53,-1221.51 45034.53,-1203.18 45528.7,-1197.45"/>
<polygon fill="black" stroke="black" points="45528.84,-1200.95 45538.8,-1197.34 45528.76,-1193.95 45528.84,-1200.95"/>
</g>
<!-- layer4_dispatch_dp1_tp1_ep1 -->
<g id="node314" class="node">
<title>layer4_dispatch_dp1_tp1_ep1</title>
<polygon fill="lightgreen" stroke="black" points="44323.48,-1912.5 43636.02,-1912.5 43459.17,-1776.5 44146.63,-1776.5 44323.48,-1912.5"/>
<text text-anchor="middle" x="43891.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="43891.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 197</text>
<text text-anchor="middle" x="43891.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="43891.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp1_ep1&#45;&gt;layer4_dispatch_dp1_tp1_ep1 -->
<g id="edge314" class="edge">
<title>layer4_gate_dp1_tp1_ep1&#45;&gt;layer4_dispatch_dp1_tp1_ep1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43916.73,-1948.31C43914.65,-1939.91 43912.51,-1931.26 43910.4,-1922.72"/>
<polygon fill="black" stroke="black" points="43913.74,-1921.63 43907.94,-1912.76 43906.94,-1923.3 43913.74,-1921.63"/>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep1 -->
<g id="node315" class="node">
<title>layer4_expert_mlp_dp1_tp1_ep1</title>
<polygon fill="lightblue" stroke="black" points="44048.83,-1740.5 43697.83,-1740.5 43697.83,-1672.5 44048.83,-1672.5 44048.83,-1740.5"/>
<text text-anchor="middle" x="43873.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="43873.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 197</text>
<text text-anchor="middle" x="43873.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="43873.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp1_ep1&#45;&gt;layer4_expert_mlp_dp1_tp1_ep1 -->
<g id="edge315" class="edge">
<title>layer4_dispatch_dp1_tp1_ep1&#45;&gt;layer4_expert_mlp_dp1_tp1_ep1</title>
<path fill="none" stroke="black" d="M43882.43,-1776.3C43881.27,-1767.54 43880.11,-1758.77 43879.03,-1750.57"/>
<polygon fill="black" stroke="black" points="43882.48,-1749.97 43877.7,-1740.52 43875.54,-1750.89 43882.48,-1749.97"/>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep1 -->
<g id="node316" class="node">
<title>layer4_expert_proj_dp1_tp1_ep1</title>
<polygon fill="lightblue" stroke="black" points="43978.83,-1636.5 43627.83,-1636.5 43627.83,-1568.5 43978.83,-1568.5 43978.83,-1636.5"/>
<text text-anchor="middle" x="43803.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="43803.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 197</text>
<text text-anchor="middle" x="43803.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="43803.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep1&#45;&gt;layer4_expert_proj_dp1_tp1_ep1 -->
<g id="edge316" class="edge">
<title>layer4_expert_mlp_dp1_tp1_ep1&#45;&gt;layer4_expert_proj_dp1_tp1_ep1</title>
<path fill="none" stroke="black" d="M43850.6,-1672.38C43844.67,-1663.74 43838.2,-1654.32 43832.01,-1645.29"/>
<polygon fill="black" stroke="black" points="43834.72,-1643.06 43826.18,-1636.8 43828.95,-1647.02 43834.72,-1643.06"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep1 -->
<g id="node317" class="node">
<title>layer4_expert_allreduce_dp1_tp1_ep1</title>
<ellipse fill="lightyellow" stroke="black" cx="43768.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="43768.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="43768.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 197</text>
<text text-anchor="middle" x="43768.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="43768.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep1&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep1 -->
<g id="edge317" class="edge">
<title>layer4_expert_proj_dp1_tp1_ep1&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep1</title>
<path fill="none" stroke="black" d="M43793.3,-1568.23C43790.83,-1560.07 43788.13,-1551.09 43785.44,-1542.16"/>
<polygon fill="black" stroke="black" points="43788.77,-1541.09 43782.53,-1532.53 43782.07,-1543.11 43788.77,-1541.09"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep1 -->
<g id="node318" class="node">
<title>layer4_aggregate_dp1_tp1_ep1</title>
<polygon fill="lightpink" stroke="black" points="44117.27,-1400.33 43535.13,-1400.33 43385.38,-1264.33 43967.52,-1264.33 44117.27,-1400.33"/>
<text text-anchor="middle" x="43751.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="43751.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 197</text>
<text text-anchor="middle" x="43751.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="43751.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep1&#45;&gt;layer4_aggregate_dp1_tp1_ep1 -->
<g id="edge318" class="edge">
<title>layer4_expert_allreduce_dp1_tp1_ep1&#45;&gt;layer4_aggregate_dp1_tp1_ep1</title>
<path fill="none" stroke="black" d="M43762.99,-1436.34C43762.06,-1428.1 43761.07,-1419.33 43760.07,-1410.52"/>
<polygon fill="black" stroke="black" points="43763.55,-1410.12 43758.94,-1400.58 43756.59,-1410.91 43763.55,-1410.12"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep1&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge484" class="edge">
<title>layer4_aggregate_dp1_tp1_ep1&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M43386.24,-1265.33C43382.92,-1264.99 43379.62,-1264.65 43376.33,-1264.33 42995.32,-1227.27 40320.59,-1203.15 39552.88,-1196.93"/>
<polygon fill="black" stroke="black" points="39552.86,-1193.43 39542.83,-1196.85 39552.8,-1200.43 39552.86,-1193.43"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep1&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge516" class="edge">
<title>layer4_aggregate_dp1_tp1_ep1&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M43989.19,-1283.9C44034.56,-1276.25 44081.79,-1269.24 44126.33,-1264.33 44627.85,-1209.02 45221.91,-1197.41 45528.43,-1195.37"/>
<polygon fill="black" stroke="black" points="45528.78,-1198.87 45538.76,-1195.3 45528.74,-1191.87 45528.78,-1198.87"/>
</g>
<!-- layer4_dispatch_dp1_tp1_ep2 -->
<g id="node320" class="node">
<title>layer4_dispatch_dp1_tp1_ep2</title>
<polygon fill="lightgreen" stroke="black" points="45206.48,-1912.5 44519.02,-1912.5 44342.17,-1776.5 45029.63,-1776.5 45206.48,-1912.5"/>
<text text-anchor="middle" x="44774.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="44774.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 198</text>
<text text-anchor="middle" x="44774.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="44774.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp1_ep2&#45;&gt;layer4_dispatch_dp1_tp1_ep2 -->
<g id="edge320" class="edge">
<title>layer4_gate_dp1_tp1_ep2&#45;&gt;layer4_dispatch_dp1_tp1_ep2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M44794.89,-1948.31C44793.21,-1939.91 44791.48,-1931.26 44789.77,-1922.72"/>
<polygon fill="black" stroke="black" points="44793.17,-1921.88 44787.78,-1912.76 44786.31,-1923.25 44793.17,-1921.88"/>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep2 -->
<g id="node321" class="node">
<title>layer4_expert_mlp_dp1_tp1_ep2</title>
<polygon fill="lightblue" stroke="black" points="44914.83,-1740.5 44563.83,-1740.5 44563.83,-1672.5 44914.83,-1672.5 44914.83,-1740.5"/>
<text text-anchor="middle" x="44739.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="44739.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 198</text>
<text text-anchor="middle" x="44739.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="44739.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp1_ep2&#45;&gt;layer4_expert_mlp_dp1_tp1_ep2 -->
<g id="edge321" class="edge">
<title>layer4_dispatch_dp1_tp1_ep2&#45;&gt;layer4_expert_mlp_dp1_tp1_ep2</title>
<path fill="none" stroke="black" d="M44757.03,-1776.3C44754.75,-1767.45 44752.47,-1758.58 44750.34,-1750.29"/>
<polygon fill="black" stroke="black" points="44753.7,-1749.33 44747.82,-1740.52 44746.93,-1751.07 44753.7,-1749.33"/>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep2 -->
<g id="node322" class="node">
<title>layer4_expert_proj_dp1_tp1_ep2</title>
<polygon fill="lightblue" stroke="black" points="44778.83,-1636.5 44427.83,-1636.5 44427.83,-1568.5 44778.83,-1568.5 44778.83,-1636.5"/>
<text text-anchor="middle" x="44603.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="44603.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 198</text>
<text text-anchor="middle" x="44603.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="44603.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep2&#45;&gt;layer4_expert_proj_dp1_tp1_ep2 -->
<g id="edge322" class="edge">
<title>layer4_expert_mlp_dp1_tp1_ep2&#45;&gt;layer4_expert_proj_dp1_tp1_ep2</title>
<path fill="none" stroke="black" d="M44695.17,-1672.38C44682.7,-1663.03 44669.01,-1652.76 44656.08,-1643.07"/>
<polygon fill="black" stroke="black" points="44657.83,-1640 44647.73,-1636.8 44653.63,-1645.6 44657.83,-1640"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep2 -->
<g id="node323" class="node">
<title>layer4_expert_allreduce_dp1_tp1_ep2</title>
<ellipse fill="lightyellow" stroke="black" cx="44535.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="44535.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="44535.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 198</text>
<text text-anchor="middle" x="44535.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="44535.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep2&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep2 -->
<g id="edge323" class="edge">
<title>layer4_expert_proj_dp1_tp1_ep2&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep2</title>
<path fill="none" stroke="black" d="M44583.84,-1568.23C44578.9,-1559.81 44573.46,-1550.52 44568.07,-1541.31"/>
<polygon fill="black" stroke="black" points="44571,-1539.39 44562.92,-1532.53 44564.96,-1542.92 44571,-1539.39"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep2 -->
<g id="node324" class="node">
<title>layer4_aggregate_dp1_tp1_ep2</title>
<polygon fill="lightpink" stroke="black" points="44867.27,-1400.33 44285.13,-1400.33 44135.38,-1264.33 44717.52,-1264.33 44867.27,-1400.33"/>
<text text-anchor="middle" x="44501.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="44501.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 198</text>
<text text-anchor="middle" x="44501.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="44501.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep2&#45;&gt;layer4_aggregate_dp1_tp1_ep2 -->
<g id="edge324" class="edge">
<title>layer4_expert_allreduce_dp1_tp1_ep2&#45;&gt;layer4_aggregate_dp1_tp1_ep2</title>
<path fill="none" stroke="black" d="M44524.66,-1436.34C44522.79,-1428.1 44520.81,-1419.33 44518.81,-1410.52"/>
<polygon fill="black" stroke="black" points="44522.18,-1409.56 44516.56,-1400.58 44515.36,-1411.11 44522.18,-1409.56"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep2&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge485" class="edge">
<title>layer4_aggregate_dp1_tp1_ep2&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M44136.24,-1265.32C44132.92,-1264.98 44129.62,-1264.65 44126.33,-1264.33 43667.82,-1220.36 40409.53,-1200.76 39553.11,-1196.33"/>
<polygon fill="black" stroke="black" points="39552.86,-1192.83 39542.84,-1196.28 39552.82,-1199.83 39552.86,-1192.83"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep2&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge517" class="edge">
<title>layer4_aggregate_dp1_tp1_ep2&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M44740.6,-1285.03C44785.58,-1277.34 44832.3,-1270.02 44876.33,-1264.33 45098.4,-1235.63 45354.45,-1216.89 45528.63,-1206.28"/>
<polygon fill="black" stroke="black" points="45528.91,-1209.77 45538.68,-1205.67 45528.49,-1202.78 45528.91,-1209.77"/>
</g>
<!-- layer4_dispatch_dp1_tp1_ep3 -->
<g id="node326" class="node">
<title>layer4_dispatch_dp1_tp1_ep3</title>
<polygon fill="lightgreen" stroke="black" points="46089.48,-1912.5 45402.02,-1912.5 45225.17,-1776.5 45912.63,-1776.5 46089.48,-1912.5"/>
<text text-anchor="middle" x="45657.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="45657.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 199</text>
<text text-anchor="middle" x="45657.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="45657.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp1_ep3&#45;&gt;layer4_dispatch_dp1_tp1_ep3 -->
<g id="edge326" class="edge">
<title>layer4_gate_dp1_tp1_ep3&#45;&gt;layer4_dispatch_dp1_tp1_ep3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45718.41,-1948.31C45713.2,-1939.54 45707.83,-1930.51 45702.54,-1921.6"/>
<polygon fill="black" stroke="black" points="45705.4,-1919.57 45697.28,-1912.76 45699.38,-1923.14 45705.4,-1919.57"/>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep3 -->
<g id="node327" class="node">
<title>layer4_expert_mlp_dp1_tp1_ep3</title>
<polygon fill="lightblue" stroke="black" points="45781.83,-1740.5 45430.83,-1740.5 45430.83,-1672.5 45781.83,-1672.5 45781.83,-1740.5"/>
<text text-anchor="middle" x="45606.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="45606.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 199</text>
<text text-anchor="middle" x="45606.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="45606.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp1_ep3&#45;&gt;layer4_expert_mlp_dp1_tp1_ep3 -->
<g id="edge327" class="edge">
<title>layer4_dispatch_dp1_tp1_ep3&#45;&gt;layer4_expert_mlp_dp1_tp1_ep3</title>
<path fill="none" stroke="black" d="M45632.12,-1776.3C45628.77,-1767.35 45625.41,-1758.39 45622.27,-1750.02"/>
<polygon fill="black" stroke="black" points="45625.5,-1748.65 45618.71,-1740.52 45618.94,-1751.11 45625.5,-1748.65"/>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep3 -->
<g id="node328" class="node">
<title>layer4_expert_proj_dp1_tp1_ep3</title>
<polygon fill="lightblue" stroke="black" points="45578.83,-1636.5 45227.83,-1636.5 45227.83,-1568.5 45578.83,-1568.5 45578.83,-1636.5"/>
<text text-anchor="middle" x="45403.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="45403.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 199</text>
<text text-anchor="middle" x="45403.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="45403.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep3&#45;&gt;layer4_expert_proj_dp1_tp1_ep3 -->
<g id="edge328" class="edge">
<title>layer4_expert_mlp_dp1_tp1_ep3&#45;&gt;layer4_expert_proj_dp1_tp1_ep3</title>
<path fill="none" stroke="black" d="M45540.42,-1672.38C45520.55,-1662.4 45498.6,-1651.37 45478.2,-1641.12"/>
<polygon fill="black" stroke="black" points="45479.76,-1637.99 45469.25,-1636.62 45476.61,-1644.24 45479.76,-1637.99"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep3 -->
<g id="node329" class="node">
<title>layer4_expert_allreduce_dp1_tp1_ep3</title>
<ellipse fill="lightyellow" stroke="black" cx="45302.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="45302.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="45302.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 199</text>
<text text-anchor="middle" x="45302.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="45302.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep3&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep3 -->
<g id="edge329" class="edge">
<title>layer4_expert_proj_dp1_tp1_ep3&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep3</title>
<path fill="none" stroke="black" d="M45374.38,-1568.23C45366.66,-1559.35 45358.1,-1549.52 45349.66,-1539.82"/>
<polygon fill="black" stroke="black" points="45352.14,-1537.34 45342.94,-1532.09 45346.86,-1541.94 45352.14,-1537.34"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep3 -->
<g id="node330" class="node">
<title>layer4_aggregate_dp1_tp1_ep3</title>
<polygon fill="lightpink" stroke="black" points="45617.27,-1400.33 45035.13,-1400.33 44885.38,-1264.33 45467.52,-1264.33 45617.27,-1400.33"/>
<text text-anchor="middle" x="45251.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="45251.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 199</text>
<text text-anchor="middle" x="45251.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="45251.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep3&#45;&gt;layer4_aggregate_dp1_tp1_ep3 -->
<g id="edge330" class="edge">
<title>layer4_expert_allreduce_dp1_tp1_ep3&#45;&gt;layer4_aggregate_dp1_tp1_ep3</title>
<path fill="none" stroke="black" d="M45286.33,-1436.34C45283.5,-1428.01 45280.48,-1419.14 45277.46,-1410.23"/>
<polygon fill="black" stroke="black" points="45280.71,-1408.92 45274.18,-1400.58 45274.08,-1411.17 45280.71,-1408.92"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep3&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge486" class="edge">
<title>layer4_aggregate_dp1_tp1_ep3&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M44886.24,-1265.31C44882.92,-1264.97 44879.62,-1264.65 44876.33,-1264.33 44339.91,-1213.41 40491.63,-1198.74 39553.27,-1195.9"/>
<polygon fill="black" stroke="black" points="39553.05,-1192.4 39543.04,-1195.87 39553.03,-1199.4 39553.05,-1192.4"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep3&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge518" class="edge">
<title>layer4_aggregate_dp1_tp1_ep3&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M45472.68,-1269C45518.75,-1256.03 45565.81,-1242.78 45607.08,-1231.16"/>
<polygon fill="black" stroke="black" points="45608.21,-1234.48 45616.89,-1228.4 45606.31,-1227.74 45608.21,-1234.48"/>
</g>
<!-- layer4_dispatch_dp1_tp1_ep4 -->
<g id="node332" class="node">
<title>layer4_dispatch_dp1_tp1_ep4</title>
<polygon fill="lightgreen" stroke="black" points="46972.48,-1912.5 46285.02,-1912.5 46108.17,-1776.5 46795.63,-1776.5 46972.48,-1912.5"/>
<text text-anchor="middle" x="46540.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="46540.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 200</text>
<text text-anchor="middle" x="46540.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="46540.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp1_ep4&#45;&gt;layer4_dispatch_dp1_tp1_ep4 -->
<g id="edge332" class="edge">
<title>layer4_gate_dp1_tp1_ep4&#45;&gt;layer4_dispatch_dp1_tp1_ep4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46601.41,-1948.31C46596.2,-1939.54 46590.83,-1930.51 46585.54,-1921.6"/>
<polygon fill="black" stroke="black" points="46588.4,-1919.57 46580.28,-1912.76 46582.38,-1923.14 46588.4,-1919.57"/>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep4 -->
<g id="node333" class="node">
<title>layer4_expert_mlp_dp1_tp1_ep4</title>
<polygon fill="lightblue" stroke="black" points="46671.83,-1740.5 46320.83,-1740.5 46320.83,-1672.5 46671.83,-1672.5 46671.83,-1740.5"/>
<text text-anchor="middle" x="46496.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="46496.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 200</text>
<text text-anchor="middle" x="46496.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="46496.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp1_ep4&#45;&gt;layer4_expert_mlp_dp1_tp1_ep4 -->
<g id="edge333" class="edge">
<title>layer4_dispatch_dp1_tp1_ep4&#45;&gt;layer4_expert_mlp_dp1_tp1_ep4</title>
<path fill="none" stroke="black" d="M46518.58,-1776.3C46515.72,-1767.45 46512.85,-1758.58 46510.17,-1750.29"/>
<polygon fill="black" stroke="black" points="46513.42,-1748.95 46507.01,-1740.52 46506.76,-1751.11 46513.42,-1748.95"/>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep4 -->
<g id="node334" class="node">
<title>layer4_expert_proj_dp1_tp1_ep4</title>
<polygon fill="lightblue" stroke="black" points="46319.83,-1636.5 45968.83,-1636.5 45968.83,-1568.5 46319.83,-1568.5 46319.83,-1636.5"/>
<text text-anchor="middle" x="46144.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="46144.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 200</text>
<text text-anchor="middle" x="46144.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="46144.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep4&#45;&gt;layer4_expert_proj_dp1_tp1_ep4 -->
<g id="edge334" class="edge">
<title>layer4_expert_mlp_dp1_tp1_ep4&#45;&gt;layer4_expert_proj_dp1_tp1_ep4</title>
<path fill="none" stroke="black" d="M46382.04,-1672.38C46345.65,-1661.84 46305.22,-1650.12 46268.18,-1639.39"/>
<polygon fill="black" stroke="black" points="46268.92,-1635.96 46258.34,-1636.54 46266.97,-1642.68 46268.92,-1635.96"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep4 -->
<g id="node335" class="node">
<title>layer4_expert_allreduce_dp1_tp1_ep4</title>
<ellipse fill="lightyellow" stroke="black" cx="46049.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="46049.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="46049.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 200</text>
<text text-anchor="middle" x="46049.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="46049.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep4&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep4 -->
<g id="edge335" class="edge">
<title>layer4_expert_proj_dp1_tp1_ep4&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep4</title>
<path fill="none" stroke="black" d="M46117.1,-1568.23C46109.91,-1559.44 46101.95,-1549.71 46094.09,-1540.11"/>
<polygon fill="black" stroke="black" points="46096.57,-1537.62 46087.53,-1532.09 46091.15,-1542.05 46096.57,-1537.62"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep4 -->
<g id="node336" class="node">
<title>layer4_aggregate_dp1_tp1_ep4</title>
<polygon fill="lightpink" stroke="black" points="46367.27,-1400.33 45785.13,-1400.33 45635.38,-1264.33 46217.52,-1264.33 46367.27,-1400.33"/>
<text text-anchor="middle" x="46001.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="46001.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 200</text>
<text text-anchor="middle" x="46001.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="46001.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep4&#45;&gt;layer4_aggregate_dp1_tp1_ep4 -->
<g id="edge336" class="edge">
<title>layer4_expert_allreduce_dp1_tp1_ep4&#45;&gt;layer4_aggregate_dp1_tp1_ep4</title>
<path fill="none" stroke="black" d="M46034.27,-1436.34C46031.61,-1428.01 46028.77,-1419.14 46025.92,-1410.23"/>
<polygon fill="black" stroke="black" points="46029.21,-1409.04 46022.83,-1400.58 46022.55,-1411.17 46029.21,-1409.04"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep4&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge487" class="edge">
<title>layer4_aggregate_dp1_tp1_ep4&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M45636.24,-1265.3C45632.92,-1264.97 45629.62,-1264.64 45626.33,-1264.33 45011.64,-1206.45 40568.02,-1196.98 39553.28,-1195.56"/>
<polygon fill="black" stroke="black" points="39552.97,-1192.06 39542.96,-1195.55 39552.96,-1199.06 39552.97,-1192.06"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep4&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge519" class="edge">
<title>layer4_aggregate_dp1_tp1_ep4&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M45869.78,-1264.33C45848.65,-1253.56 45827.44,-1242.76 45808.3,-1233.01"/>
<polygon fill="black" stroke="black" points="45809.86,-1229.88 45799.36,-1228.46 45806.68,-1236.12 45809.86,-1229.88"/>
</g>
<!-- layer4_dispatch_dp1_tp1_ep5 -->
<g id="node338" class="node">
<title>layer4_dispatch_dp1_tp1_ep5</title>
<polygon fill="lightgreen" stroke="black" points="47855.48,-1912.5 47168.02,-1912.5 46991.17,-1776.5 47678.63,-1776.5 47855.48,-1912.5"/>
<text text-anchor="middle" x="47423.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="47423.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 201</text>
<text text-anchor="middle" x="47423.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="47423.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp1_ep5&#45;&gt;layer4_dispatch_dp1_tp1_ep5 -->
<g id="edge338" class="edge">
<title>layer4_gate_dp1_tp1_ep5&#45;&gt;layer4_dispatch_dp1_tp1_ep5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47463.85,-1948.31C47460.46,-1939.72 47456.98,-1930.88 47453.54,-1922.16"/>
<polygon fill="black" stroke="black" points="47456.76,-1920.78 47449.83,-1912.76 47450.24,-1923.34 47456.76,-1920.78"/>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep5 -->
<g id="node339" class="node">
<title>layer4_expert_mlp_dp1_tp1_ep5</title>
<polygon fill="lightblue" stroke="black" points="47230.83,-1740.5 46879.83,-1740.5 46879.83,-1672.5 47230.83,-1672.5 47230.83,-1740.5"/>
<text text-anchor="middle" x="47055.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="47055.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 201</text>
<text text-anchor="middle" x="47055.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="47055.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp1_ep5&#45;&gt;layer4_expert_mlp_dp1_tp1_ep5 -->
<g id="edge339" class="edge">
<title>layer4_dispatch_dp1_tp1_ep5&#45;&gt;layer4_expert_mlp_dp1_tp1_ep5</title>
<path fill="none" stroke="black" d="M47242.02,-1776.5C47211.84,-1765.34 47181.55,-1754.15 47154.42,-1744.12"/>
<polygon fill="black" stroke="black" points="47155.56,-1740.81 47144.96,-1740.63 47153.13,-1747.38 47155.56,-1740.81"/>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep5 -->
<g id="node340" class="node">
<title>layer4_expert_proj_dp1_tp1_ep5</title>
<polygon fill="lightblue" stroke="black" points="47056.83,-1636.5 46705.83,-1636.5 46705.83,-1568.5 47056.83,-1568.5 47056.83,-1636.5"/>
<text text-anchor="middle" x="46881.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="46881.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 201</text>
<text text-anchor="middle" x="46881.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="46881.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep5&#45;&gt;layer4_expert_proj_dp1_tp1_ep5 -->
<g id="edge340" class="edge">
<title>layer4_expert_mlp_dp1_tp1_ep5&#45;&gt;layer4_expert_proj_dp1_tp1_ep5</title>
<path fill="none" stroke="black" d="M46998.83,-1672.38C46982.19,-1662.62 46963.83,-1651.87 46946.68,-1641.81"/>
<polygon fill="black" stroke="black" points="46948.23,-1638.66 46937.83,-1636.62 46944.69,-1644.7 46948.23,-1638.66"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep5 -->
<g id="node341" class="node">
<title>layer4_expert_allreduce_dp1_tp1_ep5</title>
<ellipse fill="lightyellow" stroke="black" cx="46794.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="46794.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="46794.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 201</text>
<text text-anchor="middle" x="46794.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="46794.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep5&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep5 -->
<g id="edge341" class="edge">
<title>layer4_expert_proj_dp1_tp1_ep5&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep5</title>
<path fill="none" stroke="black" d="M46856.4,-1568.23C46849.81,-1559.44 46842.51,-1549.71 46835.32,-1540.11"/>
<polygon fill="black" stroke="black" points="46838.11,-1538 46829.31,-1532.09 46832.51,-1542.19 46838.11,-1538"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep5 -->
<g id="node342" class="node">
<title>layer4_aggregate_dp1_tp1_ep5</title>
<polygon fill="lightpink" stroke="black" points="47117.27,-1400.33 46535.13,-1400.33 46385.38,-1264.33 46967.52,-1264.33 47117.27,-1400.33"/>
<text text-anchor="middle" x="46751.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="46751.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 201</text>
<text text-anchor="middle" x="46751.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="46751.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep5&#45;&gt;layer4_aggregate_dp1_tp1_ep5 -->
<g id="edge342" class="edge">
<title>layer4_expert_allreduce_dp1_tp1_ep5&#45;&gt;layer4_aggregate_dp1_tp1_ep5</title>
<path fill="none" stroke="black" d="M46780.84,-1436.34C46778.45,-1428.01 46775.91,-1419.14 46773.36,-1410.23"/>
<polygon fill="black" stroke="black" points="46776.71,-1409.23 46770.59,-1400.58 46769.98,-1411.16 46776.71,-1409.23"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep5&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge488" class="edge">
<title>layer4_aggregate_dp1_tp1_ep5&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M46386.24,-1265.3C46382.93,-1264.96 46379.62,-1264.64 46376.33,-1264.33 45683.1,-1199.46 40640.01,-1195.42 39553.31,-1195.3"/>
<polygon fill="black" stroke="black" points="39553.06,-1191.8 39543.06,-1195.3 39553.05,-1198.8 39553.06,-1191.8"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep5&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge520" class="edge">
<title>layer4_aggregate_dp1_tp1_ep5&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M46386.69,-1265.83C46383.22,-1265.32 46379.76,-1264.82 46376.33,-1264.33 46231,-1243.57 46066.36,-1225.99 45940.2,-1213.78"/>
<polygon fill="black" stroke="black" points="45940.32,-1210.27 45930.03,-1212.79 45939.65,-1217.24 45940.32,-1210.27"/>
</g>
<!-- layer4_dispatch_dp1_tp1_ep6 -->
<g id="node344" class="node">
<title>layer4_dispatch_dp1_tp1_ep6</title>
<polygon fill="lightgreen" stroke="black" points="48738.48,-1912.5 48051.02,-1912.5 47874.17,-1776.5 48561.63,-1776.5 48738.48,-1912.5"/>
<text text-anchor="middle" x="48306.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="48306.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 202</text>
<text text-anchor="middle" x="48306.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="48306.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp1_ep6&#45;&gt;layer4_dispatch_dp1_tp1_ep6 -->
<g id="edge344" class="edge">
<title>layer4_gate_dp1_tp1_ep6&#45;&gt;layer4_dispatch_dp1_tp1_ep6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48316.61,-1948.31C48315.77,-1939.91 48314.9,-1931.26 48314.05,-1922.72"/>
<polygon fill="black" stroke="black" points="48317.53,-1922.36 48313.05,-1912.76 48310.56,-1923.06 48317.53,-1922.36"/>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep6 -->
<g id="node345" class="node">
<title>layer4_expert_mlp_dp1_tp1_ep6</title>
<polygon fill="lightblue" stroke="black" points="48342.83,-1740.5 47991.83,-1740.5 47991.83,-1672.5 48342.83,-1672.5 48342.83,-1740.5"/>
<text text-anchor="middle" x="48167.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="48167.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 202</text>
<text text-anchor="middle" x="48167.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="48167.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp1_ep6&#45;&gt;layer4_expert_mlp_dp1_tp1_ep6 -->
<g id="edge345" class="edge">
<title>layer4_dispatch_dp1_tp1_ep6&#45;&gt;layer4_expert_mlp_dp1_tp1_ep6</title>
<path fill="none" stroke="black" d="M48237.64,-1776.3C48227.6,-1766.47 48217.54,-1756.63 48208.3,-1747.58"/>
<polygon fill="black" stroke="black" points="48210.67,-1745.01 48201.07,-1740.52 48205.77,-1750.01 48210.67,-1745.01"/>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep6 -->
<g id="node346" class="node">
<title>layer4_expert_proj_dp1_tp1_ep6</title>
<polygon fill="lightblue" stroke="black" points="47961.83,-1636.5 47610.83,-1636.5 47610.83,-1568.5 47961.83,-1568.5 47961.83,-1636.5"/>
<text text-anchor="middle" x="47786.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="47786.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 202</text>
<text text-anchor="middle" x="47786.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="47786.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep6&#45;&gt;layer4_expert_proj_dp1_tp1_ep6 -->
<g id="edge346" class="edge">
<title>layer4_expert_mlp_dp1_tp1_ep6&#45;&gt;layer4_expert_proj_dp1_tp1_ep6</title>
<path fill="none" stroke="black" d="M48043.89,-1672.45C48004.23,-1661.84 47960.13,-1650.03 47919.79,-1639.23"/>
<polygon fill="black" stroke="black" points="47920.46,-1635.79 47909.89,-1636.58 47918.65,-1642.55 47920.46,-1635.79"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep6 -->
<g id="node347" class="node">
<title>layer4_expert_allreduce_dp1_tp1_ep6</title>
<ellipse fill="lightyellow" stroke="black" cx="47596.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="47596.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="47596.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 202</text>
<text text-anchor="middle" x="47596.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="47596.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep6&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep6 -->
<g id="edge347" class="edge">
<title>layer4_expert_proj_dp1_tp1_ep6&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep6</title>
<path fill="none" stroke="black" d="M47732.13,-1568.39C47715.54,-1558.25 47696.9,-1546.87 47678.87,-1535.85"/>
<polygon fill="black" stroke="black" points="47680.44,-1532.71 47670.08,-1530.48 47676.79,-1538.68 47680.44,-1532.71"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep6 -->
<g id="node348" class="node">
<title>layer4_aggregate_dp1_tp1_ep6</title>
<polygon fill="lightpink" stroke="black" points="47867.27,-1400.33 47285.13,-1400.33 47135.38,-1264.33 47717.52,-1264.33 47867.27,-1400.33"/>
<text text-anchor="middle" x="47501.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="47501.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 202</text>
<text text-anchor="middle" x="47501.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="47501.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep6&#45;&gt;layer4_aggregate_dp1_tp1_ep6 -->
<g id="edge348" class="edge">
<title>layer4_expert_allreduce_dp1_tp1_ep6&#45;&gt;layer4_aggregate_dp1_tp1_ep6</title>
<path fill="none" stroke="black" d="M47566.53,-1436.34C47561.03,-1427.65 47555.16,-1418.38 47549.28,-1409.1"/>
<polygon fill="black" stroke="black" points="47552.2,-1407.16 47543.89,-1400.58 47546.28,-1410.9 47552.2,-1407.16"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep6&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge489" class="edge">
<title>layer4_aggregate_dp1_tp1_ep6&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M47136.25,-1265.29C47132.93,-1264.96 47129.62,-1264.64 47126.33,-1264.33 46739.01,-1228.27 40747.01,-1201.23 39553.26,-1196.18"/>
<polygon fill="black" stroke="black" points="39552.88,-1192.68 39542.86,-1196.14 39552.85,-1199.68 39552.88,-1192.68"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep6&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge521" class="edge">
<title>layer4_aggregate_dp1_tp1_ep6&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M47136.23,-1265.49C47132.91,-1265.09 47129.61,-1264.71 47126.33,-1264.33 46706.93,-1216.67 46212.75,-1201.92 45940.44,-1197.37"/>
<polygon fill="black" stroke="black" points="45940.11,-1193.86 45930.05,-1197.2 45939.99,-1200.86 45940.11,-1193.86"/>
</g>
<!-- layer4_dispatch_dp1_tp1_ep7 -->
<g id="node350" class="node">
<title>layer4_dispatch_dp1_tp1_ep7</title>
<polygon fill="lightgreen" stroke="black" points="49621.48,-1912.5 48934.02,-1912.5 48757.17,-1776.5 49444.63,-1776.5 49621.48,-1912.5"/>
<text text-anchor="middle" x="49189.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="49189.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 203</text>
<text text-anchor="middle" x="49189.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="49189.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp1_ep7&#45;&gt;layer4_dispatch_dp1_tp1_ep7 -->
<g id="edge350" class="edge">
<title>layer4_gate_dp1_tp1_ep7&#45;&gt;layer4_dispatch_dp1_tp1_ep7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49179.04,-1948.31C49179.89,-1939.91 49180.75,-1931.26 49181.6,-1922.72"/>
<polygon fill="black" stroke="black" points="49185.09,-1923.06 49182.6,-1912.76 49178.12,-1922.36 49185.09,-1923.06"/>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep7 -->
<g id="node351" class="node">
<title>layer4_expert_mlp_dp1_tp1_ep7</title>
<polygon fill="lightblue" stroke="black" points="48902.83,-1740.5 48551.83,-1740.5 48551.83,-1672.5 48902.83,-1672.5 48902.83,-1740.5"/>
<text text-anchor="middle" x="48727.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="48727.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 203</text>
<text text-anchor="middle" x="48727.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="48727.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp1_ep7&#45;&gt;layer4_expert_mlp_dp1_tp1_ep7 -->
<g id="edge351" class="edge">
<title>layer4_dispatch_dp1_tp1_ep7&#45;&gt;layer4_expert_mlp_dp1_tp1_ep7</title>
<path fill="none" stroke="black" d="M48961.71,-1776.5C48922.88,-1765.07 48883.93,-1753.6 48849.23,-1743.39"/>
<polygon fill="black" stroke="black" points="48850.14,-1740.01 48839.56,-1740.54 48848.17,-1746.72 48850.14,-1740.01"/>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep7 -->
<g id="node352" class="node">
<title>layer4_expert_proj_dp1_tp1_ep7</title>
<polygon fill="lightblue" stroke="black" points="48711.83,-1636.5 48360.83,-1636.5 48360.83,-1568.5 48711.83,-1568.5 48711.83,-1636.5"/>
<text text-anchor="middle" x="48536.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="48536.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 203</text>
<text text-anchor="middle" x="48536.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="48536.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep7&#45;&gt;layer4_expert_proj_dp1_tp1_ep7 -->
<g id="edge352" class="edge">
<title>layer4_expert_mlp_dp1_tp1_ep7&#45;&gt;layer4_expert_proj_dp1_tp1_ep7</title>
<path fill="none" stroke="black" d="M48665.31,-1672.38C48646.79,-1662.49 48626.34,-1651.57 48607.29,-1641.4"/>
<polygon fill="black" stroke="black" points="48608.82,-1638.25 48598.35,-1636.62 48605.53,-1644.42 48608.82,-1638.25"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep7 -->
<g id="node353" class="node">
<title>layer4_expert_allreduce_dp1_tp1_ep7</title>
<ellipse fill="lightyellow" stroke="black" cx="48346.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="48346.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="48346.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 203</text>
<text text-anchor="middle" x="48346.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="48346.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep7&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep7 -->
<g id="edge353" class="edge">
<title>layer4_expert_proj_dp1_tp1_ep7&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep7</title>
<path fill="none" stroke="black" d="M48482.13,-1568.39C48465.54,-1558.25 48446.9,-1546.87 48428.87,-1535.85"/>
<polygon fill="black" stroke="black" points="48430.44,-1532.71 48420.08,-1530.48 48426.79,-1538.68 48430.44,-1532.71"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep7 -->
<g id="node354" class="node">
<title>layer4_aggregate_dp1_tp1_ep7</title>
<polygon fill="lightpink" stroke="black" points="48617.27,-1400.33 48035.13,-1400.33 47885.38,-1264.33 48467.52,-1264.33 48617.27,-1400.33"/>
<text text-anchor="middle" x="48251.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="48251.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 203</text>
<text text-anchor="middle" x="48251.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="48251.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep7&#45;&gt;layer4_aggregate_dp1_tp1_ep7 -->
<g id="edge354" class="edge">
<title>layer4_expert_allreduce_dp1_tp1_ep7&#45;&gt;layer4_aggregate_dp1_tp1_ep7</title>
<path fill="none" stroke="black" d="M48316.53,-1436.34C48311.03,-1427.65 48305.16,-1418.38 48299.28,-1409.1"/>
<polygon fill="black" stroke="black" points="48302.2,-1407.16 48293.89,-1400.58 48296.28,-1410.9 48302.2,-1407.16"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep7&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge490" class="edge">
<title>layer4_aggregate_dp1_tp1_ep7&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M47886.25,-1265.29C47882.93,-1264.96 47879.62,-1264.64 47876.33,-1264.33 47662.57,-1244.52 40834.2,-1203.96 39553.29,-1196.52"/>
<polygon fill="black" stroke="black" points="39553.08,-1193.02 39543.06,-1196.46 39553.04,-1200.02 39553.08,-1193.02"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep7&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge522" class="edge">
<title>layer4_aggregate_dp1_tp1_ep7&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M47886.23,-1265.4C47882.92,-1265.03 47879.61,-1264.68 47876.33,-1264.33 47505.32,-1225.42 46401.33,-1205.13 45940.25,-1198.17"/>
<polygon fill="black" stroke="black" points="45940.2,-1194.67 45930.15,-1198.02 45940.1,-1201.67 45940.2,-1194.67"/>
</g>
<!-- layer4_dispatch_dp1_tp1_ep8 -->
<g id="node356" class="node">
<title>layer4_dispatch_dp1_tp1_ep8</title>
<polygon fill="lightgreen" stroke="black" points="50504.48,-1912.5 49817.02,-1912.5 49640.17,-1776.5 50327.63,-1776.5 50504.48,-1912.5"/>
<text text-anchor="middle" x="50072.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="50072.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 204</text>
<text text-anchor="middle" x="50072.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="50072.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp1_ep8&#45;&gt;layer4_dispatch_dp1_tp1_ep8 -->
<g id="edge356" class="edge">
<title>layer4_gate_dp1_tp1_ep8&#45;&gt;layer4_dispatch_dp1_tp1_ep8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50051.76,-1948.31C50053.44,-1939.91 50055.17,-1931.26 50056.88,-1922.72"/>
<polygon fill="black" stroke="black" points="50060.35,-1923.25 50058.87,-1912.76 50053.48,-1921.88 50060.35,-1923.25"/>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep8 -->
<g id="node357" class="node">
<title>layer4_expert_mlp_dp1_tp1_ep8</title>
<polygon fill="lightblue" stroke="black" points="49652.83,-1740.5 49301.83,-1740.5 49301.83,-1672.5 49652.83,-1672.5 49652.83,-1740.5"/>
<text text-anchor="middle" x="49477.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="49477.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 204</text>
<text text-anchor="middle" x="49477.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="49477.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp1_ep8&#45;&gt;layer4_expert_mlp_dp1_tp1_ep8 -->
<g id="edge357" class="edge">
<title>layer4_dispatch_dp1_tp1_ep8&#45;&gt;layer4_expert_mlp_dp1_tp1_ep8</title>
<path fill="none" stroke="black" d="M49779.18,-1776.5C49728.22,-1764.85 49677.08,-1753.16 49631.75,-1742.8"/>
<polygon fill="black" stroke="black" points="49632.4,-1739.36 49621.87,-1740.54 49630.84,-1746.18 49632.4,-1739.36"/>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep8 -->
<g id="node358" class="node">
<title>layer4_expert_proj_dp1_tp1_ep8</title>
<polygon fill="lightblue" stroke="black" points="49652.83,-1636.5 49301.83,-1636.5 49301.83,-1568.5 49652.83,-1568.5 49652.83,-1636.5"/>
<text text-anchor="middle" x="49477.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="49477.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 204</text>
<text text-anchor="middle" x="49477.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="49477.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep8&#45;&gt;layer4_expert_proj_dp1_tp1_ep8 -->
<g id="edge358" class="edge">
<title>layer4_expert_mlp_dp1_tp1_ep8&#45;&gt;layer4_expert_proj_dp1_tp1_ep8</title>
<path fill="none" stroke="black" d="M49477.33,-1672.38C49477.33,-1664.28 49477.33,-1655.48 49477.33,-1646.97"/>
<polygon fill="black" stroke="black" points="49480.83,-1646.8 49477.33,-1636.8 49473.83,-1646.8 49480.83,-1646.8"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep8 -->
<g id="node359" class="node">
<title>layer4_expert_allreduce_dp1_tp1_ep8</title>
<ellipse fill="lightyellow" stroke="black" cx="49167.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="49167.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="49167.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 204</text>
<text text-anchor="middle" x="49167.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="49167.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep8&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep8 -->
<g id="edge359" class="edge">
<title>layer4_expert_proj_dp1_tp1_ep8&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep8</title>
<path fill="none" stroke="black" d="M49388.91,-1568.39C49357.88,-1556.77 49322.45,-1543.51 49289.17,-1531.04"/>
<polygon fill="black" stroke="black" points="49289.97,-1527.61 49279.38,-1527.38 49287.52,-1534.16 49289.97,-1527.61"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep8 -->
<g id="node360" class="node">
<title>layer4_aggregate_dp1_tp1_ep8</title>
<polygon fill="lightpink" stroke="black" points="49367.27,-1400.33 48785.13,-1400.33 48635.38,-1264.33 49217.52,-1264.33 49367.27,-1400.33"/>
<text text-anchor="middle" x="49001.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="49001.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 204</text>
<text text-anchor="middle" x="49001.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="49001.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep8&#45;&gt;layer4_aggregate_dp1_tp1_ep8 -->
<g id="edge360" class="edge">
<title>layer4_expert_allreduce_dp1_tp1_ep8&#45;&gt;layer4_aggregate_dp1_tp1_ep8</title>
<path fill="none" stroke="black" d="M49116.17,-1437.16C49105.62,-1427.62 49094.26,-1417.35 49082.93,-1407.12"/>
<polygon fill="black" stroke="black" points="49085.27,-1404.51 49075.51,-1400.4 49080.58,-1409.7 49085.27,-1404.51"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep8&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge491" class="edge">
<title>layer4_aggregate_dp1_tp1_ep8&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M48636.25,-1265.29C48632.93,-1264.96 48629.62,-1264.64 48626.33,-1264.33 48392.74,-1242.75 40899.1,-1203.3 39553.27,-1196.38"/>
<polygon fill="black" stroke="black" points="39553.03,-1192.88 39543.01,-1196.33 39552.99,-1199.88 39553.03,-1192.88"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep8&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge523" class="edge">
<title>layer4_aggregate_dp1_tp1_ep8&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M48636.24,-1265.36C48632.92,-1265.01 48629.62,-1264.66 48626.33,-1264.33 48104.84,-1211.84 46511.32,-1199.08 45940.47,-1196.15"/>
<polygon fill="black" stroke="black" points="45940.09,-1192.65 45930.07,-1196.1 45940.06,-1199.65 45940.09,-1192.65"/>
</g>
<!-- layer4_dispatch_dp1_tp1_ep9 -->
<g id="node362" class="node">
<title>layer4_dispatch_dp1_tp1_ep9</title>
<polygon fill="lightgreen" stroke="black" points="51387.48,-1912.5 50700.02,-1912.5 50523.17,-1776.5 51210.63,-1776.5 51387.48,-1912.5"/>
<text text-anchor="middle" x="50955.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="50955.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 205</text>
<text text-anchor="middle" x="50955.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="50955.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp1_ep9&#45;&gt;layer4_dispatch_dp1_tp1_ep9 -->
<g id="edge362" class="edge">
<title>layer4_gate_dp1_tp1_ep9&#45;&gt;layer4_dispatch_dp1_tp1_ep9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50929.93,-1948.31C50932,-1939.91 50934.14,-1931.26 50936.25,-1922.72"/>
<polygon fill="black" stroke="black" points="50939.71,-1923.3 50938.71,-1912.76 50932.91,-1921.63 50939.71,-1923.3"/>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep9 -->
<g id="node363" class="node">
<title>layer4_expert_mlp_dp1_tp1_ep9</title>
<polygon fill="lightblue" stroke="black" points="50259.83,-1740.5 49908.83,-1740.5 49908.83,-1672.5 50259.83,-1672.5 50259.83,-1740.5"/>
<text text-anchor="middle" x="50084.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="50084.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 205</text>
<text text-anchor="middle" x="50084.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="50084.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp1_ep9&#45;&gt;layer4_expert_mlp_dp1_tp1_ep9 -->
<g id="edge363" class="edge">
<title>layer4_dispatch_dp1_tp1_ep9&#45;&gt;layer4_expert_mlp_dp1_tp1_ep9</title>
<path fill="none" stroke="black" d="M50526.21,-1776.5C50436,-1762.41 50345.43,-1748.27 50269.98,-1736.49"/>
<polygon fill="black" stroke="black" points="50270.33,-1733 50259.91,-1734.92 50269.25,-1739.92 50270.33,-1733"/>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep9 -->
<g id="node364" class="node">
<title>layer4_expert_proj_dp1_tp1_ep9</title>
<polygon fill="lightblue" stroke="black" points="50069.83,-1636.5 49718.83,-1636.5 49718.83,-1568.5 50069.83,-1568.5 50069.83,-1636.5"/>
<text text-anchor="middle" x="49894.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="49894.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 205</text>
<text text-anchor="middle" x="49894.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="49894.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep9&#45;&gt;layer4_expert_proj_dp1_tp1_ep9 -->
<g id="edge364" class="edge">
<title>layer4_expert_mlp_dp1_tp1_ep9&#45;&gt;layer4_expert_proj_dp1_tp1_ep9</title>
<path fill="none" stroke="black" d="M50022.64,-1672.38C50004.21,-1662.49 49983.87,-1651.57 49964.92,-1641.4"/>
<polygon fill="black" stroke="black" points="49966.5,-1638.27 49956.03,-1636.62 49963.18,-1644.44 49966.5,-1638.27"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep9 -->
<g id="node365" class="node">
<title>layer4_expert_allreduce_dp1_tp1_ep9</title>
<ellipse fill="lightyellow" stroke="black" cx="49799.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="49799.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="49799.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 205</text>
<text text-anchor="middle" x="49799.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="49799.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep9&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep9 -->
<g id="edge365" class="edge">
<title>layer4_expert_proj_dp1_tp1_ep9&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep9</title>
<path fill="none" stroke="black" d="M49867.1,-1568.23C49859.91,-1559.44 49851.95,-1549.71 49844.09,-1540.11"/>
<polygon fill="black" stroke="black" points="49846.57,-1537.62 49837.53,-1532.09 49841.15,-1542.05 49846.57,-1537.62"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep9 -->
<g id="node366" class="node">
<title>layer4_aggregate_dp1_tp1_ep9</title>
<polygon fill="lightpink" stroke="black" points="50117.27,-1400.33 49535.13,-1400.33 49385.38,-1264.33 49967.52,-1264.33 50117.27,-1400.33"/>
<text text-anchor="middle" x="49751.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="49751.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 205</text>
<text text-anchor="middle" x="49751.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="49751.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep9&#45;&gt;layer4_aggregate_dp1_tp1_ep9 -->
<g id="edge366" class="edge">
<title>layer4_expert_allreduce_dp1_tp1_ep9&#45;&gt;layer4_aggregate_dp1_tp1_ep9</title>
<path fill="none" stroke="black" d="M49784.27,-1436.34C49781.61,-1428.01 49778.77,-1419.14 49775.92,-1410.23"/>
<polygon fill="black" stroke="black" points="49779.21,-1409.04 49772.83,-1400.58 49772.55,-1411.17 49779.21,-1409.04"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep9&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge492" class="edge">
<title>layer4_aggregate_dp1_tp1_ep9&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M49386.25,-1265.28C49382.93,-1264.95 49379.62,-1264.64 49376.33,-1264.33 49249.51,-1252.65 40971.6,-1204.65 39553.06,-1196.51"/>
<polygon fill="black" stroke="black" points="39553.04,-1193.01 39543.02,-1196.45 39553,-1200.01 39553.04,-1193.01"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep9&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge524" class="edge">
<title>layer4_aggregate_dp1_tp1_ep9&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M49386.24,-1265.34C49382.92,-1264.99 49379.62,-1264.66 49376.33,-1264.33 48702.33,-1198.16 46606.88,-1194.41 45940.21,-1194.96"/>
<polygon fill="black" stroke="black" points="45940.01,-1191.46 45930.02,-1194.97 45940.02,-1198.46 45940.01,-1191.46"/>
</g>
<!-- layer4_dispatch_dp1_tp1_ep10 -->
<g id="node368" class="node">
<title>layer4_dispatch_dp1_tp1_ep10</title>
<polygon fill="lightgreen" stroke="black" points="52270.48,-1912.5 51583.02,-1912.5 51406.17,-1776.5 52093.63,-1776.5 52270.48,-1912.5"/>
<text text-anchor="middle" x="51838.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="51838.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 206</text>
<text text-anchor="middle" x="51838.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="51838.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp1_ep10&#45;&gt;layer4_dispatch_dp1_tp1_ep10 -->
<g id="edge368" class="edge">
<title>layer4_gate_dp1_tp1_ep10&#45;&gt;layer4_dispatch_dp1_tp1_ep10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M51810.51,-1948.31C51812.81,-1939.81 51815.17,-1931.07 51817.51,-1922.44"/>
<polygon fill="black" stroke="black" points="51820.89,-1923.32 51820.13,-1912.76 51814.14,-1921.5 51820.89,-1923.32"/>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep10 -->
<g id="node369" class="node">
<title>layer4_expert_mlp_dp1_tp1_ep10</title>
<polygon fill="lightblue" stroke="black" points="51718.83,-1740.5 51367.83,-1740.5 51367.83,-1672.5 51718.83,-1672.5 51718.83,-1740.5"/>
<text text-anchor="middle" x="51543.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="51543.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 206</text>
<text text-anchor="middle" x="51543.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="51543.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp1_ep10&#45;&gt;layer4_expert_mlp_dp1_tp1_ep10 -->
<g id="edge369" class="edge">
<title>layer4_dispatch_dp1_tp1_ep10&#45;&gt;layer4_expert_mlp_dp1_tp1_ep10</title>
<path fill="none" stroke="black" d="M51692.99,-1776.5C51669.42,-1765.63 51645.79,-1754.73 51624.48,-1744.91"/>
<polygon fill="black" stroke="black" points="51625.73,-1741.64 51615.18,-1740.63 51622.8,-1747.99 51625.73,-1741.64"/>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep10 -->
<g id="node370" class="node">
<title>layer4_expert_proj_dp1_tp1_ep10</title>
<polygon fill="lightblue" stroke="black" points="51050.83,-1636.5 50699.83,-1636.5 50699.83,-1568.5 51050.83,-1568.5 51050.83,-1636.5"/>
<text text-anchor="middle" x="50875.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="50875.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 206</text>
<text text-anchor="middle" x="50875.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="50875.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep10&#45;&gt;layer4_expert_proj_dp1_tp1_ep10 -->
<g id="edge370" class="edge">
<title>layer4_expert_mlp_dp1_tp1_ep10&#45;&gt;layer4_expert_proj_dp1_tp1_ep10</title>
<path fill="none" stroke="black" d="M51367.82,-1678.7C51273.45,-1664.29 51157.12,-1646.53 51061.21,-1631.88"/>
<polygon fill="black" stroke="black" points="51061.53,-1628.39 51051.11,-1630.34 51060.47,-1635.31 51061.53,-1628.39"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep10 -->
<g id="node371" class="node">
<title>layer4_expert_allreduce_dp1_tp1_ep10</title>
<ellipse fill="lightyellow" stroke="black" cx="50626.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="50626.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="50626.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 206</text>
<text text-anchor="middle" x="50626.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="50626.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep10&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep10 -->
<g id="edge371" class="edge">
<title>layer4_expert_proj_dp1_tp1_ep10&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep10</title>
<path fill="none" stroke="black" d="M50804.31,-1568.39C50780.88,-1557.47 50754.33,-1545.09 50729.02,-1533.29"/>
<polygon fill="black" stroke="black" points="50730.31,-1530.03 50719.76,-1528.98 50727.35,-1536.37 50730.31,-1530.03"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep10 -->
<g id="node372" class="node">
<title>layer4_aggregate_dp1_tp1_ep10</title>
<polygon fill="lightpink" stroke="black" points="50867.27,-1400.33 50285.13,-1400.33 50135.38,-1264.33 50717.52,-1264.33 50867.27,-1400.33"/>
<text text-anchor="middle" x="50501.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="50501.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 206</text>
<text text-anchor="middle" x="50501.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="50501.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep10&#45;&gt;layer4_aggregate_dp1_tp1_ep10 -->
<g id="edge372" class="edge">
<title>layer4_expert_allreduce_dp1_tp1_ep10&#45;&gt;layer4_aggregate_dp1_tp1_ep10</title>
<path fill="none" stroke="black" d="M50587.46,-1436.75C50579.88,-1427.65 50571.76,-1417.9 50563.64,-1408.16"/>
<polygon fill="black" stroke="black" points="50566.23,-1405.8 50557.15,-1400.35 50560.86,-1410.28 50566.23,-1405.8"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep10&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge493" class="edge">
<title>layer4_aggregate_dp1_tp1_ep10&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M50136.25,-1265.28C50132.93,-1264.95 50129.62,-1264.64 50126.33,-1264.33 49989.56,-1251.77 41032.62,-1204.19 39553.19,-1196.41"/>
<polygon fill="black" stroke="black" points="39553.01,-1192.91 39542.99,-1196.36 39552.97,-1199.91 39553.01,-1192.91"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep10&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge525" class="edge">
<title>layer4_aggregate_dp1_tp1_ep10&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M50136.24,-1265.33C50132.92,-1264.98 50129.62,-1264.65 50126.33,-1264.33 49707.86,-1223.93 46751.42,-1201.93 45939.93,-1196.61"/>
<polygon fill="black" stroke="black" points="45939.92,-1193.11 45929.9,-1196.55 45939.88,-1200.11 45939.92,-1193.11"/>
</g>
<!-- layer4_dispatch_dp1_tp1_ep11 -->
<g id="node374" class="node">
<title>layer4_dispatch_dp1_tp1_ep11</title>
<polygon fill="lightgreen" stroke="black" points="53153.48,-1912.5 52466.02,-1912.5 52289.17,-1776.5 52976.63,-1776.5 53153.48,-1912.5"/>
<text text-anchor="middle" x="52721.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="52721.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 207</text>
<text text-anchor="middle" x="52721.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="52721.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp1_ep11&#45;&gt;layer4_dispatch_dp1_tp1_ep11 -->
<g id="edge374" class="edge">
<title>layer4_gate_dp1_tp1_ep11&#45;&gt;layer4_dispatch_dp1_tp1_ep11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52692.3,-1948.31C52694.7,-1939.81 52697.17,-1931.07 52699.6,-1922.44"/>
<polygon fill="black" stroke="black" points="52702.99,-1923.33 52702.34,-1912.76 52696.25,-1921.43 52702.99,-1923.33"/>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep11 -->
<g id="node375" class="node">
<title>layer4_expert_mlp_dp1_tp1_ep11</title>
<polygon fill="lightblue" stroke="black" points="52492.83,-1740.5 52141.83,-1740.5 52141.83,-1672.5 52492.83,-1672.5 52492.83,-1740.5"/>
<text text-anchor="middle" x="52317.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="52317.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 207</text>
<text text-anchor="middle" x="52317.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="52317.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp1_ep11&#45;&gt;layer4_expert_mlp_dp1_tp1_ep11 -->
<g id="edge375" class="edge">
<title>layer4_dispatch_dp1_tp1_ep11&#45;&gt;layer4_expert_mlp_dp1_tp1_ep11</title>
<path fill="none" stroke="black" d="M52522.28,-1776.5C52488.77,-1765.21 52455.14,-1753.89 52425.1,-1743.78"/>
<polygon fill="black" stroke="black" points="52426.07,-1740.41 52415.47,-1740.54 52423.83,-1747.05 52426.07,-1740.41"/>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep11 -->
<g id="node376" class="node">
<title>layer4_expert_proj_dp1_tp1_ep11</title>
<polygon fill="lightblue" stroke="black" points="51800.83,-1636.5 51449.83,-1636.5 51449.83,-1568.5 51800.83,-1568.5 51800.83,-1636.5"/>
<text text-anchor="middle" x="51625.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="51625.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 207</text>
<text text-anchor="middle" x="51625.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="51625.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep11&#45;&gt;layer4_expert_proj_dp1_tp1_ep11 -->
<g id="edge376" class="edge">
<title>layer4_expert_mlp_dp1_tp1_ep11&#45;&gt;layer4_expert_proj_dp1_tp1_ep11</title>
<path fill="none" stroke="black" d="M52141.81,-1679.63C52040.77,-1664.74 51913.86,-1646.03 51811.13,-1630.89"/>
<polygon fill="black" stroke="black" points="51811.36,-1627.38 51800.95,-1629.39 51810.34,-1634.31 51811.36,-1627.38"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep11 -->
<g id="node377" class="node">
<title>layer4_expert_allreduce_dp1_tp1_ep11</title>
<ellipse fill="lightyellow" stroke="black" cx="51494.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="51494.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="51494.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 207</text>
<text text-anchor="middle" x="51494.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="51494.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep11&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep11 -->
<g id="edge377" class="edge">
<title>layer4_expert_proj_dp1_tp1_ep11&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep11</title>
<path fill="none" stroke="black" d="M51587.79,-1568.23C51577.24,-1558.89 51565.51,-1548.49 51554.02,-1538.31"/>
<polygon fill="black" stroke="black" points="51556.32,-1535.67 51546.51,-1531.66 51551.68,-1540.91 51556.32,-1535.67"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep11 -->
<g id="node378" class="node">
<title>layer4_aggregate_dp1_tp1_ep11</title>
<polygon fill="lightpink" stroke="black" points="51617.27,-1400.33 51035.13,-1400.33 50885.38,-1264.33 51467.52,-1264.33 51617.27,-1400.33"/>
<text text-anchor="middle" x="51251.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="51251.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 207</text>
<text text-anchor="middle" x="51251.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="51251.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep11&#45;&gt;layer4_aggregate_dp1_tp1_ep11 -->
<g id="edge378" class="edge">
<title>layer4_expert_allreduce_dp1_tp1_ep11&#45;&gt;layer4_aggregate_dp1_tp1_ep11</title>
<path fill="none" stroke="black" d="M51421.42,-1438.39C51404.84,-1428.15 51386.81,-1417.01 51368.9,-1405.95"/>
<polygon fill="black" stroke="black" points="51370.47,-1402.81 51360.13,-1400.53 51366.8,-1408.76 51370.47,-1402.81"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep11&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge494" class="edge">
<title>layer4_aggregate_dp1_tp1_ep11&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M50886.25,-1265.28C50882.93,-1264.95 50879.62,-1264.63 50876.33,-1264.33 50802.94,-1257.61 41096.78,-1204.8 39553.16,-1196.45"/>
<polygon fill="black" stroke="black" points="39553.1,-1192.95 39543.08,-1196.39 39553.06,-1199.95 39553.1,-1192.95"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep11&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge526" class="edge">
<title>layer4_aggregate_dp1_tp1_ep11&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M50886.24,-1265.31C50882.92,-1264.97 50879.62,-1264.65 50876.33,-1264.33 50380.16,-1217 46837.05,-1199.74 45940.2,-1196.11"/>
<polygon fill="black" stroke="black" points="45940.11,-1192.61 45930.1,-1196.06 45940.08,-1199.61 45940.11,-1192.61"/>
</g>
<!-- layer4_dispatch_dp1_tp1_ep12 -->
<g id="node380" class="node">
<title>layer4_dispatch_dp1_tp1_ep12</title>
<polygon fill="lightgreen" stroke="black" points="54036.48,-1912.5 53349.02,-1912.5 53172.17,-1776.5 53859.63,-1776.5 54036.48,-1912.5"/>
<text text-anchor="middle" x="53604.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="53604.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 208</text>
<text text-anchor="middle" x="53604.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="53604.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp1_ep12&#45;&gt;layer4_dispatch_dp1_tp1_ep12 -->
<g id="edge380" class="edge">
<title>layer4_gate_dp1_tp1_ep12&#45;&gt;layer4_dispatch_dp1_tp1_ep12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53574.69,-1948.31C53577.14,-1939.81 53579.66,-1931.07 53582.15,-1922.44"/>
<polygon fill="black" stroke="black" points="53585.53,-1923.33 53584.94,-1912.76 53578.81,-1921.4 53585.53,-1923.33"/>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep12 -->
<g id="node381" class="node">
<title>layer4_expert_mlp_dp1_tp1_ep12</title>
<polygon fill="lightblue" stroke="black" points="53667.83,-1740.5 53316.83,-1740.5 53316.83,-1672.5 53667.83,-1672.5 53667.83,-1740.5"/>
<text text-anchor="middle" x="53492.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="53492.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 208</text>
<text text-anchor="middle" x="53492.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="53492.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp1_ep12&#45;&gt;layer4_expert_mlp_dp1_tp1_ep12 -->
<g id="edge381" class="edge">
<title>layer4_dispatch_dp1_tp1_ep12&#45;&gt;layer4_expert_mlp_dp1_tp1_ep12</title>
<path fill="none" stroke="black" d="M53548.98,-1776.3C53541.13,-1766.77 53533.27,-1757.22 53526,-1748.39"/>
<polygon fill="black" stroke="black" points="53528.58,-1746.01 53519.52,-1740.52 53523.17,-1750.46 53528.58,-1746.01"/>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep12 -->
<g id="node382" class="node">
<title>layer4_expert_proj_dp1_tp1_ep12</title>
<polygon fill="lightblue" stroke="black" points="52550.83,-1636.5 52199.83,-1636.5 52199.83,-1568.5 52550.83,-1568.5 52550.83,-1636.5"/>
<text text-anchor="middle" x="52375.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="52375.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 208</text>
<text text-anchor="middle" x="52375.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="52375.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep12&#45;&gt;layer4_expert_proj_dp1_tp1_ep12 -->
<g id="edge382" class="edge">
<title>layer4_expert_mlp_dp1_tp1_ep12&#45;&gt;layer4_expert_proj_dp1_tp1_ep12</title>
<path fill="none" stroke="black" d="M53316.57,-1689.45C53110.74,-1670.65 52771.29,-1639.66 52561.2,-1620.47"/>
<polygon fill="black" stroke="black" points="52561.26,-1616.96 52550.98,-1619.54 52560.62,-1623.93 52561.26,-1616.96"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep12 -->
<g id="node383" class="node">
<title>layer4_expert_allreduce_dp1_tp1_ep12</title>
<ellipse fill="lightyellow" stroke="black" cx="52126.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="52126.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="52126.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 208</text>
<text text-anchor="middle" x="52126.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="52126.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep12&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep12 -->
<g id="edge383" class="edge">
<title>layer4_expert_proj_dp1_tp1_ep12&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep12</title>
<path fill="none" stroke="black" d="M52304.31,-1568.39C52280.88,-1557.47 52254.33,-1545.09 52229.02,-1533.29"/>
<polygon fill="black" stroke="black" points="52230.31,-1530.03 52219.76,-1528.98 52227.35,-1536.37 52230.31,-1530.03"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep12 -->
<g id="node384" class="node">
<title>layer4_aggregate_dp1_tp1_ep12</title>
<polygon fill="lightpink" stroke="black" points="52367.27,-1400.33 51785.13,-1400.33 51635.38,-1264.33 52217.52,-1264.33 52367.27,-1400.33"/>
<text text-anchor="middle" x="52001.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="52001.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 208</text>
<text text-anchor="middle" x="52001.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="52001.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep12&#45;&gt;layer4_aggregate_dp1_tp1_ep12 -->
<g id="edge384" class="edge">
<title>layer4_expert_allreduce_dp1_tp1_ep12&#45;&gt;layer4_aggregate_dp1_tp1_ep12</title>
<path fill="none" stroke="black" d="M52087.46,-1436.75C52079.88,-1427.65 52071.76,-1417.9 52063.64,-1408.16"/>
<polygon fill="black" stroke="black" points="52066.23,-1405.8 52057.15,-1400.35 52060.86,-1410.28 52066.23,-1405.8"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep12&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge495" class="edge">
<title>layer4_aggregate_dp1_tp1_ep12&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M51636.25,-1265.28C51632.93,-1264.95 51629.62,-1264.63 51626.33,-1264.33 51587.13,-1260.75 41156.44,-1204.98 39553.13,-1196.43"/>
<polygon fill="black" stroke="black" points="39552.97,-1192.93 39542.95,-1196.38 39552.93,-1199.93 39552.97,-1192.93"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep12&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge527" class="edge">
<title>layer4_aggregate_dp1_tp1_ep12&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M51636.24,-1265.31C51632.92,-1264.97 51629.62,-1264.64 51626.33,-1264.33 51052.07,-1210.05 46916.28,-1197.86 45940.3,-1195.73"/>
<polygon fill="black" stroke="black" points="45940.02,-1192.22 45930.02,-1195.7 45940.01,-1199.22 45940.02,-1192.22"/>
</g>
<!-- layer4_dispatch_dp1_tp1_ep13 -->
<g id="node386" class="node">
<title>layer4_dispatch_dp1_tp1_ep13</title>
<polygon fill="lightgreen" stroke="black" points="54919.48,-1912.5 54232.02,-1912.5 54055.17,-1776.5 54742.63,-1776.5 54919.48,-1912.5"/>
<text text-anchor="middle" x="54487.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="54487.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 209</text>
<text text-anchor="middle" x="54487.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="54487.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp1_ep13&#45;&gt;layer4_dispatch_dp1_tp1_ep13 -->
<g id="edge386" class="edge">
<title>layer4_gate_dp1_tp1_ep13&#45;&gt;layer4_dispatch_dp1_tp1_ep13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M54457.09,-1948.31C54459.59,-1939.81 54462.16,-1931.07 54464.7,-1922.44"/>
<polygon fill="black" stroke="black" points="54468.08,-1923.34 54467.54,-1912.76 54461.37,-1921.36 54468.08,-1923.34"/>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep13 -->
<g id="node387" class="node">
<title>layer4_expert_mlp_dp1_tp1_ep13</title>
<polygon fill="lightblue" stroke="black" points="54066.83,-1740.5 53715.83,-1740.5 53715.83,-1672.5 54066.83,-1672.5 54066.83,-1740.5"/>
<text text-anchor="middle" x="53891.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="53891.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 209</text>
<text text-anchor="middle" x="53891.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="53891.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp1_ep13&#45;&gt;layer4_expert_mlp_dp1_tp1_ep13 -->
<g id="edge387" class="edge">
<title>layer4_dispatch_dp1_tp1_ep13&#45;&gt;layer4_expert_mlp_dp1_tp1_ep13</title>
<path fill="none" stroke="black" d="M54193.69,-1776.5C54142.64,-1764.85 54091.41,-1753.16 54046.01,-1742.8"/>
<polygon fill="black" stroke="black" points="54046.65,-1739.35 54036.12,-1740.54 54045.09,-1746.18 54046.65,-1739.35"/>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep13 -->
<g id="node388" class="node">
<title>layer4_expert_proj_dp1_tp1_ep13</title>
<polygon fill="lightblue" stroke="black" points="53465.83,-1636.5 53114.83,-1636.5 53114.83,-1568.5 53465.83,-1568.5 53465.83,-1636.5"/>
<text text-anchor="middle" x="53290.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="53290.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 209</text>
<text text-anchor="middle" x="53290.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="53290.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep13&#45;&gt;layer4_expert_proj_dp1_tp1_ep13 -->
<g id="edge388" class="edge">
<title>layer4_expert_mlp_dp1_tp1_ep13&#45;&gt;layer4_expert_proj_dp1_tp1_ep13</title>
<path fill="none" stroke="black" d="M53715.47,-1675.65C53640.3,-1662.9 53552.47,-1647.99 53476.23,-1635.05"/>
<polygon fill="black" stroke="black" points="53476.47,-1631.54 53466.03,-1633.32 53475.3,-1638.44 53476.47,-1631.54"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep13 -->
<g id="node389" class="node">
<title>layer4_expert_allreduce_dp1_tp1_ep13</title>
<ellipse fill="lightyellow" stroke="black" cx="52980.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="52980.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="52980.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 209</text>
<text text-anchor="middle" x="52980.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="52980.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep13&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep13 -->
<g id="edge389" class="edge">
<title>layer4_expert_proj_dp1_tp1_ep13&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep13</title>
<path fill="none" stroke="black" d="M53201.91,-1568.39C53170.88,-1556.77 53135.45,-1543.51 53102.17,-1531.04"/>
<polygon fill="black" stroke="black" points="53102.97,-1527.61 53092.38,-1527.38 53100.52,-1534.16 53102.97,-1527.61"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep13 -->
<g id="node390" class="node">
<title>layer4_aggregate_dp1_tp1_ep13</title>
<polygon fill="lightpink" stroke="black" points="53117.27,-1400.33 52535.13,-1400.33 52385.38,-1264.33 52967.52,-1264.33 53117.27,-1400.33"/>
<text text-anchor="middle" x="52751.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="52751.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 209</text>
<text text-anchor="middle" x="52751.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="52751.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep13&#45;&gt;layer4_aggregate_dp1_tp1_ep13 -->
<g id="edge390" class="edge">
<title>layer4_expert_allreduce_dp1_tp1_ep13&#45;&gt;layer4_aggregate_dp1_tp1_ep13</title>
<path fill="none" stroke="black" d="M52911.31,-1438.18C52895.83,-1428.04 52879.03,-1417.03 52862.33,-1406.08"/>
<polygon fill="black" stroke="black" points="52863.9,-1402.93 52853.61,-1400.37 52860.06,-1408.78 52863.9,-1402.93"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep13&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge496" class="edge">
<title>layer4_aggregate_dp1_tp1_ep13&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M52386.25,-1265.28C52382.93,-1264.95 52379.62,-1264.63 52376.33,-1264.33 51997.56,-1229.76 45910.66,-1230.35 45530.33,-1228.33 43182.48,-1215.89 40333.15,-1200.62 39553.11,-1196.44"/>
<polygon fill="black" stroke="black" points="39552.92,-1192.94 39542.9,-1196.38 39552.88,-1199.94 39552.92,-1192.94"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep13&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge528" class="edge">
<title>layer4_aggregate_dp1_tp1_ep13&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M52386.24,-1265.3C52382.93,-1264.96 52379.62,-1264.64 52376.33,-1264.33 51723.69,-1203.07 46990.78,-1196.2 45940.43,-1195.43"/>
<polygon fill="black" stroke="black" points="45940.14,-1191.93 45930.13,-1195.42 45940.13,-1198.93 45940.14,-1191.93"/>
</g>
<!-- layer4_dispatch_dp1_tp1_ep14 -->
<g id="node392" class="node">
<title>layer4_dispatch_dp1_tp1_ep14</title>
<polygon fill="lightgreen" stroke="black" points="55802.48,-1912.5 55115.02,-1912.5 54938.17,-1776.5 55625.63,-1776.5 55802.48,-1912.5"/>
<text text-anchor="middle" x="55370.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="55370.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 210</text>
<text text-anchor="middle" x="55370.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="55370.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp1_ep14&#45;&gt;layer4_dispatch_dp1_tp1_ep14 -->
<g id="edge392" class="edge">
<title>layer4_gate_dp1_tp1_ep14&#45;&gt;layer4_dispatch_dp1_tp1_ep14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55340.09,-1948.31C55342.59,-1939.81 55345.16,-1931.07 55347.7,-1922.44"/>
<polygon fill="black" stroke="black" points="55351.08,-1923.34 55350.54,-1912.76 55344.37,-1921.36 55351.08,-1923.34"/>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep14 -->
<g id="node393" class="node">
<title>layer4_expert_mlp_dp1_tp1_ep14</title>
<polygon fill="lightblue" stroke="black" points="54450.83,-1740.5 54099.83,-1740.5 54099.83,-1672.5 54450.83,-1672.5 54450.83,-1740.5"/>
<text text-anchor="middle" x="54275.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="54275.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 210</text>
<text text-anchor="middle" x="54275.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="54275.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp1_ep14&#45;&gt;layer4_expert_mlp_dp1_tp1_ep14 -->
<g id="edge393" class="edge">
<title>layer4_dispatch_dp1_tp1_ep14&#45;&gt;layer4_expert_mlp_dp1_tp1_ep14</title>
<path fill="none" stroke="black" d="M54939.65,-1777.82C54935.86,-1777.37 54932.09,-1776.93 54928.33,-1776.5 54724.59,-1753.12 54671.83,-1765.81 54468.33,-1740.5 54465.91,-1740.2 54463.47,-1739.89 54461.02,-1739.57"/>
<polygon fill="black" stroke="black" points="54461.27,-1736.07 54450.89,-1738.22 54460.34,-1743.01 54461.27,-1736.07"/>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep14 -->
<g id="node394" class="node">
<title>layer4_expert_proj_dp1_tp1_ep14</title>
<polygon fill="lightblue" stroke="black" points="54323.83,-1636.5 53972.83,-1636.5 53972.83,-1568.5 54323.83,-1568.5 54323.83,-1636.5"/>
<text text-anchor="middle" x="54148.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="54148.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 210</text>
<text text-anchor="middle" x="54148.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="54148.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep14&#45;&gt;layer4_expert_proj_dp1_tp1_ep14 -->
<g id="edge394" class="edge">
<title>layer4_expert_mlp_dp1_tp1_ep14&#45;&gt;layer4_expert_proj_dp1_tp1_ep14</title>
<path fill="none" stroke="black" d="M54234.09,-1672.38C54222.45,-1663.03 54209.66,-1652.76 54197.59,-1643.07"/>
<polygon fill="black" stroke="black" points="54199.78,-1640.33 54189.79,-1636.8 54195.39,-1645.79 54199.78,-1640.33"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep14 -->
<g id="node395" class="node">
<title>layer4_expert_allreduce_dp1_tp1_ep14</title>
<ellipse fill="lightyellow" stroke="black" cx="53730.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="53730.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="53730.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 210</text>
<text text-anchor="middle" x="53730.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="53730.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep14&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep14 -->
<g id="edge395" class="edge">
<title>layer4_expert_proj_dp1_tp1_ep14&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep14</title>
<path fill="none" stroke="black" d="M54029.38,-1568.47C53982.89,-1555.56 53929.04,-1540.6 53879.96,-1526.97"/>
<polygon fill="black" stroke="black" points="53880.78,-1523.57 53870.21,-1524.26 53878.91,-1530.31 53880.78,-1523.57"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep14 -->
<g id="node396" class="node">
<title>layer4_aggregate_dp1_tp1_ep14</title>
<polygon fill="lightpink" stroke="black" points="53867.27,-1400.33 53285.13,-1400.33 53135.38,-1264.33 53717.52,-1264.33 53867.27,-1400.33"/>
<text text-anchor="middle" x="53501.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="53501.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 210</text>
<text text-anchor="middle" x="53501.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="53501.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep14&#45;&gt;layer4_aggregate_dp1_tp1_ep14 -->
<g id="edge396" class="edge">
<title>layer4_expert_allreduce_dp1_tp1_ep14&#45;&gt;layer4_aggregate_dp1_tp1_ep14</title>
<path fill="none" stroke="black" d="M53661.31,-1438.18C53645.83,-1428.04 53629.03,-1417.03 53612.33,-1406.08"/>
<polygon fill="black" stroke="black" points="53613.9,-1402.93 53603.61,-1400.37 53610.06,-1408.78 53613.9,-1402.93"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep14&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge497" class="edge">
<title>layer4_aggregate_dp1_tp1_ep14&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M53136.25,-1265.27C53132.93,-1264.95 53129.62,-1264.63 53126.33,-1264.33 52706.06,-1226.08 45952.33,-1230.46 45530.33,-1228.33 43182.48,-1216.5 40333.15,-1200.8 39553.11,-1196.48"/>
<polygon fill="black" stroke="black" points="39552.92,-1192.97 39542.9,-1196.42 39552.88,-1199.97 39552.92,-1192.97"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep14&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge529" class="edge">
<title>layer4_aggregate_dp1_tp1_ep14&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M53136.24,-1265.29C53132.93,-1264.96 53129.62,-1264.64 53126.33,-1264.33 52395.01,-1196.07 47060.57,-1194.72 45940.36,-1195.19"/>
<polygon fill="black" stroke="black" points="45940.19,-1191.69 45930.19,-1195.2 45940.19,-1198.69 45940.19,-1191.69"/>
</g>
<!-- layer4_dispatch_dp1_tp1_ep15 -->
<g id="node398" class="node">
<title>layer4_dispatch_dp1_tp1_ep15</title>
<polygon fill="lightgreen" stroke="black" points="56685.48,-1912.5 55998.02,-1912.5 55821.17,-1776.5 56508.63,-1776.5 56685.48,-1912.5"/>
<text text-anchor="middle" x="56253.33" y="-1863.3" font-family="Times,serif" font-size="14.00">LAYER4_DISPATCH</text>
<text text-anchor="middle" x="56253.33" y="-1848.3" font-family="Times,serif" font-size="14.00">GPU: 211</text>
<text text-anchor="middle" x="56253.33" y="-1833.3" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="56253.33" y="-1818.3" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_gate_dp1_tp1_ep15&#45;&gt;layer4_dispatch_dp1_tp1_ep15 -->
<g id="edge398" class="edge">
<title>layer4_gate_dp1_tp1_ep15&#45;&gt;layer4_dispatch_dp1_tp1_ep15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56223.09,-1948.31C56225.59,-1939.81 56228.16,-1931.07 56230.7,-1922.44"/>
<polygon fill="black" stroke="black" points="56234.08,-1923.34 56233.54,-1912.76 56227.37,-1921.36 56234.08,-1923.34"/>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep15 -->
<g id="node399" class="node">
<title>layer4_expert_mlp_dp1_tp1_ep15</title>
<polygon fill="lightblue" stroke="black" points="54827.83,-1740.5 54476.83,-1740.5 54476.83,-1672.5 54827.83,-1672.5 54827.83,-1740.5"/>
<text text-anchor="middle" x="54652.33" y="-1725.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_MLP</text>
<text text-anchor="middle" x="54652.33" y="-1710.3" font-family="Times,serif" font-size="14.00">GPU: 211</text>
<text text-anchor="middle" x="54652.33" y="-1695.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="54652.33" y="-1680.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer4_dispatch_dp1_tp1_ep15&#45;&gt;layer4_expert_mlp_dp1_tp1_ep15 -->
<g id="edge399" class="edge">
<title>layer4_dispatch_dp1_tp1_ep15&#45;&gt;layer4_expert_mlp_dp1_tp1_ep15</title>
<path fill="none" stroke="black" d="M55822.66,-1777.72C55818.87,-1777.3 55815.09,-1776.9 55811.33,-1776.5 55468.87,-1740.43 55067.34,-1721.77 54838.09,-1713.35"/>
<polygon fill="black" stroke="black" points="54838.1,-1709.85 54827.98,-1712.98 54837.84,-1716.84 54838.1,-1709.85"/>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep15 -->
<g id="node400" class="node">
<title>layer4_expert_proj_dp1_tp1_ep15</title>
<polygon fill="lightblue" stroke="black" points="54760.83,-1636.5 54409.83,-1636.5 54409.83,-1568.5 54760.83,-1568.5 54760.83,-1636.5"/>
<text text-anchor="middle" x="54585.33" y="-1621.3" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_PROJ</text>
<text text-anchor="middle" x="54585.33" y="-1606.3" font-family="Times,serif" font-size="14.00">GPU: 211</text>
<text text-anchor="middle" x="54585.33" y="-1591.3" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="54585.33" y="-1576.3" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer4_expert_mlp_dp1_tp1_ep15&#45;&gt;layer4_expert_proj_dp1_tp1_ep15 -->
<g id="edge400" class="edge">
<title>layer4_expert_mlp_dp1_tp1_ep15&#45;&gt;layer4_expert_proj_dp1_tp1_ep15</title>
<path fill="none" stroke="black" d="M54630.57,-1672.38C54624.9,-1663.74 54618.71,-1654.32 54612.78,-1645.29"/>
<polygon fill="black" stroke="black" points="54615.61,-1643.24 54607.2,-1636.8 54609.76,-1647.08 54615.61,-1643.24"/>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep15 -->
<g id="node401" class="node">
<title>layer4_expert_allreduce_dp1_tp1_ep15</title>
<ellipse fill="lightyellow" stroke="black" cx="54362.33" cy="-1484.42" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="54362.33" y="-1503.22" font-family="Times,serif" font-size="14.00">LAYER4_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="54362.33" y="-1488.22" font-family="Times,serif" font-size="14.00">GPU: 211</text>
<text text-anchor="middle" x="54362.33" y="-1473.22" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="54362.33" y="-1458.22" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_proj_dp1_tp1_ep15&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep15 -->
<g id="edge401" class="edge">
<title>layer4_expert_proj_dp1_tp1_ep15&#45;&gt;layer4_expert_allreduce_dp1_tp1_ep15</title>
<path fill="none" stroke="black" d="M54521.72,-1568.39C54501.36,-1557.79 54478.36,-1545.82 54456.3,-1534.33"/>
<polygon fill="black" stroke="black" points="54457.73,-1531.13 54447.24,-1529.62 54454.5,-1537.34 54457.73,-1531.13"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep15 -->
<g id="node402" class="node">
<title>layer4_aggregate_dp1_tp1_ep15</title>
<polygon fill="lightpink" stroke="black" points="54617.27,-1400.33 54035.13,-1400.33 53885.38,-1264.33 54467.52,-1264.33 54617.27,-1400.33"/>
<text text-anchor="middle" x="54251.33" y="-1351.13" font-family="Times,serif" font-size="14.00">LAYER4_AGGREGATE</text>
<text text-anchor="middle" x="54251.33" y="-1336.13" font-family="Times,serif" font-size="14.00">GPU: 211</text>
<text text-anchor="middle" x="54251.33" y="-1321.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="54251.33" y="-1306.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer4_expert_allreduce_dp1_tp1_ep15&#45;&gt;layer4_aggregate_dp1_tp1_ep15 -->
<g id="edge402" class="edge">
<title>layer4_expert_allreduce_dp1_tp1_ep15&#45;&gt;layer4_aggregate_dp1_tp1_ep15</title>
<path fill="none" stroke="black" d="M54327.81,-1436.75C54321.15,-1427.74 54314.02,-1418.1 54306.88,-1408.45"/>
<polygon fill="black" stroke="black" points="54309.65,-1406.31 54300.89,-1400.35 54304.03,-1410.47 54309.65,-1406.31"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep15&#45;&gt;layer61_mla_dp1_tp0 -->
<g id="edge498" class="edge">
<title>layer4_aggregate_dp1_tp1_ep15&#45;&gt;layer61_mla_dp1_tp0</title>
<path fill="none" stroke="black" d="M53886.25,-1265.27C53882.93,-1264.95 53879.62,-1264.63 53876.33,-1264.33 53414.55,-1222.4 45993.99,-1230.57 45530.33,-1228.33 43182.48,-1217 40333.14,-1200.94 39553.11,-1196.51"/>
<polygon fill="black" stroke="black" points="39552.92,-1193.01 39542.9,-1196.45 39552.88,-1200.01 39552.92,-1193.01"/>
</g>
<!-- layer4_aggregate_dp1_tp1_ep15&#45;&gt;layer61_mla_dp1_tp1 -->
<g id="edge530" class="edge">
<title>layer4_aggregate_dp1_tp1_ep15&#45;&gt;layer61_mla_dp1_tp1</title>
<path fill="none" stroke="black" d="M53886.25,-1265.29C53882.93,-1264.96 53879.62,-1264.64 53876.33,-1264.33 53066.19,-1189.07 47127.94,-1193.37 45940.61,-1195"/>
<polygon fill="black" stroke="black" points="45940.26,-1191.5 45930.26,-1195.02 45940.27,-1198.5 45940.26,-1191.5"/>
</g>
<!-- layer61_gate_dp0_tp0_ep0 -->
<g id="node407" class="node">
<title>layer61_gate_dp0_tp0_ep0</title>
<polygon fill="lightgreen" stroke="black" points="1024.63,-1124.33 389.43,-1124.33 226.03,-988.33 861.22,-988.33 1024.63,-1124.33"/>
<text text-anchor="middle" x="625.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="625.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 48</text>
<text text-anchor="middle" x="625.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="625.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep0 -->
<g id="edge531" class="edge">
<title>layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10724.68,-1193.53C9427.76,-1194.6 2091.74,-1197.41 1100.33,-1124.33 1075.85,-1122.53 1050.72,-1120.25 1025.41,-1117.64"/>
<polygon fill="black" stroke="black" points="1025.63,-1114.14 1015.32,-1116.58 1024.9,-1121.1 1025.63,-1114.14"/>
</g>
<!-- layer61_gate_dp0_tp0_ep1 -->
<g id="node413" class="node">
<title>layer61_gate_dp0_tp0_ep1</title>
<polygon fill="lightgreen" stroke="black" points="1907.63,-1124.33 1272.43,-1124.33 1109.03,-988.33 1744.22,-988.33 1907.63,-1124.33"/>
<text text-anchor="middle" x="1508.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="1508.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 49</text>
<text text-anchor="middle" x="1508.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="1508.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep1 -->
<g id="edge537" class="edge">
<title>layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10724.56,-1193.38C9496.81,-1193.47 2881.16,-1190.83 1983.33,-1124.33 1958.86,-1122.52 1933.72,-1120.24 1908.41,-1117.62"/>
<polygon fill="black" stroke="black" points="1908.63,-1114.12 1898.32,-1116.56 1907.9,-1121.08 1908.63,-1114.12"/>
</g>
<!-- layer61_gate_dp0_tp0_ep2 -->
<g id="node419" class="node">
<title>layer61_gate_dp0_tp0_ep2</title>
<polygon fill="lightgreen" stroke="black" points="2790.63,-1124.33 2155.43,-1124.33 1992.03,-988.33 2627.22,-988.33 2790.63,-1124.33"/>
<text text-anchor="middle" x="2391.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="2391.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 50</text>
<text text-anchor="middle" x="2391.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="2391.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep2 -->
<g id="edge543" class="edge">
<title>layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10724.67,-1193.2C9570.18,-1192.21 3670.86,-1184.26 2866.33,-1124.33 2841.86,-1122.51 2816.73,-1120.22 2791.41,-1117.59"/>
<polygon fill="black" stroke="black" points="2791.64,-1114.1 2781.32,-1116.53 2790.9,-1121.06 2791.64,-1114.1"/>
</g>
<!-- layer61_gate_dp0_tp0_ep3 -->
<g id="node425" class="node">
<title>layer61_gate_dp0_tp0_ep3</title>
<polygon fill="lightgreen" stroke="black" points="3673.63,-1124.33 3038.43,-1124.33 2875.03,-988.33 3510.22,-988.33 3673.63,-1124.33"/>
<text text-anchor="middle" x="3274.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="3274.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 51</text>
<text text-anchor="middle" x="3274.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="3274.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep3 -->
<g id="edge549" class="edge">
<title>layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10724.69,-1192.92C9648.92,-1190.43 4476.13,-1175.88 3766.33,-1124.33 3735.78,-1122.11 3704.23,-1119.22 3672.55,-1115.88"/>
<polygon fill="black" stroke="black" points="3672.58,-1112.37 3662.27,-1114.78 3671.84,-1119.33 3672.58,-1112.37"/>
</g>
<!-- layer61_gate_dp0_tp0_ep4 -->
<g id="node431" class="node">
<title>layer61_gate_dp0_tp0_ep4</title>
<polygon fill="lightgreen" stroke="black" points="4573.63,-1124.33 3938.43,-1124.33 3775.03,-988.33 4410.22,-988.33 4573.63,-1124.33"/>
<text text-anchor="middle" x="4174.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="4174.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 52</text>
<text text-anchor="middle" x="4174.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="4174.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep4 -->
<g id="edge555" class="edge">
<title>layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10724.69,-1192.62C9732.68,-1188.84 5281.56,-1169.44 4666.33,-1124.33 4635.78,-1122.09 4604.24,-1119.18 4572.56,-1115.84"/>
<polygon fill="black" stroke="black" points="4572.59,-1112.32 4562.27,-1114.73 4571.84,-1119.28 4572.59,-1112.32"/>
</g>
<!-- layer61_gate_dp0_tp0_ep5 -->
<g id="node437" class="node">
<title>layer61_gate_dp0_tp0_ep5</title>
<polygon fill="lightgreen" stroke="black" points="5473.63,-1124.33 4838.43,-1124.33 4675.03,-988.33 5310.22,-988.33 5473.63,-1124.33"/>
<text text-anchor="middle" x="5074.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="5074.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 53</text>
<text text-anchor="middle" x="5074.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="5074.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep5 -->
<g id="edge561" class="edge">
<title>layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10724.63,-1192.3C9820.8,-1187.32 6072.06,-1164.39 5549.33,-1124.33 5524.86,-1122.46 5499.73,-1120.13 5474.42,-1117.47"/>
<polygon fill="black" stroke="black" points="5474.65,-1113.97 5464.33,-1116.4 5473.91,-1120.94 5474.65,-1113.97"/>
</g>
<!-- layer61_gate_dp0_tp0_ep6 -->
<g id="node443" class="node">
<title>layer61_gate_dp0_tp0_ep6</title>
<polygon fill="lightgreen" stroke="black" points="6356.63,-1124.33 5721.43,-1124.33 5558.03,-988.33 6193.22,-988.33 6356.63,-1124.33"/>
<text text-anchor="middle" x="5957.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="5957.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 54</text>
<text text-anchor="middle" x="5957.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="5957.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep6 -->
<g id="edge567" class="edge">
<title>layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10724.74,-1193.88C9971.51,-1195.43 7257.68,-1195.84 6398.33,-1124.33 6386.15,-1123.32 6373.79,-1122.18 6361.33,-1120.92"/>
<polygon fill="black" stroke="black" points="6361.62,-1117.44 6351.32,-1119.9 6360.91,-1124.4 6361.62,-1117.44"/>
</g>
<!-- layer61_gate_dp0_tp0_ep7 -->
<g id="node449" class="node">
<title>layer61_gate_dp0_tp0_ep7</title>
<polygon fill="lightgreen" stroke="black" points="7205.63,-1124.33 6570.43,-1124.33 6407.03,-988.33 7042.22,-988.33 7205.63,-1124.33"/>
<text text-anchor="middle" x="6806.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="6806.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 55</text>
<text text-anchor="middle" x="6806.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="6806.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep7 -->
<g id="edge573" class="edge">
<title>layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10724.67,-1192.61C10072.03,-1189.72 7972.91,-1176.51 7298.33,-1124.33 7267.69,-1121.96 7236.05,-1118.95 7204.28,-1115.53"/>
<polygon fill="black" stroke="black" points="7204.28,-1112.01 7193.96,-1114.41 7203.52,-1118.97 7204.28,-1112.01"/>
</g>
<!-- layer61_gate_dp0_tp0_ep8 -->
<g id="node455" class="node">
<title>layer61_gate_dp0_tp0_ep8</title>
<polygon fill="lightgreen" stroke="black" points="8105.63,-1124.33 7470.43,-1124.33 7307.03,-988.33 7942.22,-988.33 8105.63,-1124.33"/>
<text text-anchor="middle" x="7706.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="7706.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 56</text>
<text text-anchor="middle" x="7706.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="7706.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep8 -->
<g id="edge579" class="edge">
<title>layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10724.7,-1191.17C10186.21,-1184.78 8689.55,-1163.89 8198.33,-1124.33 8167.6,-1121.86 8135.86,-1118.77 8103.99,-1115.28"/>
<polygon fill="black" stroke="black" points="8103.97,-1111.76 8093.64,-1114.14 8103.2,-1118.72 8103.97,-1111.76"/>
</g>
<!-- layer61_gate_dp0_tp0_ep9 -->
<g id="node461" class="node">
<title>layer61_gate_dp0_tp0_ep9</title>
<polygon fill="lightgreen" stroke="black" points="9005.63,-1124.33 8370.43,-1124.33 8207.03,-988.33 8842.22,-988.33 9005.63,-1124.33"/>
<text text-anchor="middle" x="8606.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="8606.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 57</text>
<text text-anchor="middle" x="8606.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="8606.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep9 -->
<g id="edge585" class="edge">
<title>layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10724.69,-1193.45C10383.42,-1192.02 9657.39,-1181.72 9047.33,-1124.33 9035.01,-1123.17 9022.51,-1121.9 9009.9,-1120.53"/>
<polygon fill="black" stroke="black" points="9010.09,-1117.03 8999.76,-1119.4 9009.32,-1123.98 9010.09,-1117.03"/>
</g>
<!-- layer61_gate_dp0_tp0_ep10 -->
<g id="node467" class="node">
<title>layer61_gate_dp0_tp0_ep10</title>
<polygon fill="lightgreen" stroke="black" points="9854.63,-1124.33 9219.43,-1124.33 9056.03,-988.33 9691.22,-988.33 9854.63,-1124.33"/>
<text text-anchor="middle" x="9455.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="9455.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 58</text>
<text text-anchor="middle" x="9455.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="9455.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep10 -->
<g id="edge591" class="edge">
<title>layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10724.73,-1184.35C10521.74,-1174 10195.23,-1154.42 9914.33,-1124.33 9894.97,-1122.26 9875.19,-1119.98 9855.22,-1117.55"/>
<polygon fill="black" stroke="black" points="9855.43,-1114.05 9845.08,-1116.31 9854.58,-1121 9855.43,-1114.05"/>
</g>
<!-- layer61_gate_dp0_tp0_ep11 -->
<g id="node473" class="node">
<title>layer61_gate_dp0_tp0_ep11</title>
<polygon fill="lightgreen" stroke="black" points="10721.63,-1124.33 10086.43,-1124.33 9923.03,-988.33 10558.22,-988.33 10721.63,-1124.33"/>
<text text-anchor="middle" x="10322.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="10322.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 59</text>
<text text-anchor="middle" x="10322.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="10322.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep11 -->
<g id="edge597" class="edge">
<title>layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10775.19,-1160.32C10730.12,-1150.08 10678.66,-1138.37 10626.96,-1126.61"/>
<polygon fill="black" stroke="black" points="10627.49,-1123.15 10616.97,-1124.34 10625.94,-1129.97 10627.49,-1123.15"/>
</g>
<!-- layer61_gate_dp0_tp0_ep12 -->
<g id="node479" class="node">
<title>layer61_gate_dp0_tp0_ep12</title>
<polygon fill="lightgreen" stroke="black" points="11570.63,-1124.33 10935.43,-1124.33 10772.03,-988.33 11407.22,-988.33 11570.63,-1124.33"/>
<text text-anchor="middle" x="11171.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="11171.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 60</text>
<text text-anchor="middle" x="11171.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="11171.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep12 -->
<g id="edge603" class="edge">
<title>layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10981.41,-1160.24C10998.85,-1150.79 11018.57,-1140.1 11038.54,-1129.28"/>
<polygon fill="black" stroke="black" points="11040.29,-1132.31 11047.42,-1124.47 11036.96,-1126.16 11040.29,-1132.31"/>
</g>
<!-- layer61_gate_dp0_tp0_ep13 -->
<g id="node485" class="node">
<title>layer61_gate_dp0_tp0_ep13</title>
<polygon fill="lightgreen" stroke="black" points="12436.63,-1124.33 11801.43,-1124.33 11638.03,-988.33 12273.22,-988.33 12436.63,-1124.33"/>
<text text-anchor="middle" x="12037.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="12037.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 61</text>
<text text-anchor="middle" x="12037.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="12037.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep13 -->
<g id="edge609" class="edge">
<title>layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11115.93,-1174.97C11247.16,-1162.13 11423.81,-1143.84 11579.33,-1124.33 11637.86,-1116.99 11700.49,-1108.35 11760.05,-1099.76"/>
<polygon fill="black" stroke="black" points="11760.57,-1103.22 11769.97,-1098.32 11759.57,-1096.29 11760.57,-1103.22"/>
</g>
<!-- layer61_gate_dp0_tp0_ep14 -->
<g id="node491" class="node">
<title>layer61_gate_dp0_tp0_ep14</title>
<polygon fill="lightgreen" stroke="black" points="13294.63,-1124.33 12659.43,-1124.33 12496.03,-988.33 13131.22,-988.33 13294.63,-1124.33"/>
<text text-anchor="middle" x="12895.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="12895.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 62</text>
<text text-anchor="middle" x="12895.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="12895.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep14 -->
<g id="edge615" class="edge">
<title>layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11116.07,-1190.89C11406.73,-1185.81 11969.34,-1170.41 12445.33,-1124.33 12502.46,-1118.8 12563.42,-1111.01 12621.43,-1102.69"/>
<polygon fill="black" stroke="black" points="12622.06,-1106.14 12631.46,-1101.24 12621.06,-1099.21 12622.06,-1106.14"/>
</g>
<!-- layer61_gate_dp0_tp0_ep15 -->
<g id="node497" class="node">
<title>layer61_gate_dp0_tp0_ep15</title>
<polygon fill="lightgreen" stroke="black" points="14173.63,-1124.33 13538.43,-1124.33 13375.03,-988.33 14010.22,-988.33 14173.63,-1124.33"/>
<text text-anchor="middle" x="13774.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="13774.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 63</text>
<text text-anchor="middle" x="13774.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="13774.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep15 -->
<g id="edge621" class="edge">
<title>layer61_mla_dp0_tp0&#45;&gt;layer61_gate_dp0_tp0_ep15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11116.04,-1190.5C11606.81,-1182.95 12880.63,-1160.4 13303.33,-1124.33 13366.89,-1118.91 13434.98,-1110.66 13499.07,-1101.78"/>
<polygon fill="black" stroke="black" points="13499.9,-1105.2 13509.32,-1100.35 13498.94,-1098.27 13499.9,-1105.2"/>
</g>
<!-- layer61_gate_dp0_tp1_ep0 -->
<g id="node503" class="node">
<title>layer61_gate_dp0_tp1_ep0</title>
<polygon fill="lightgreen" stroke="black" points="15186.63,-1124.33 14551.43,-1124.33 14388.03,-988.33 15023.22,-988.33 15186.63,-1124.33"/>
<text text-anchor="middle" x="14787.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="14787.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 112</text>
<text text-anchor="middle" x="14787.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="14787.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep0 -->
<g id="edge627" class="edge">
<title>layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17278.7,-1190.34C16808.26,-1182.66 15623.39,-1160.28 15228.33,-1124.33 15216.08,-1123.22 15203.65,-1121.98 15191.12,-1120.65"/>
<polygon fill="black" stroke="black" points="15191.37,-1117.16 15181.05,-1119.56 15190.61,-1124.12 15191.37,-1117.16"/>
</g>
<!-- layer61_gate_dp0_tp1_ep1 -->
<g id="node509" class="node">
<title>layer61_gate_dp0_tp1_ep1</title>
<polygon fill="lightgreen" stroke="black" points="16035.63,-1124.33 15400.43,-1124.33 15237.03,-988.33 15872.22,-988.33 16035.63,-1124.33"/>
<text text-anchor="middle" x="15636.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="15636.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 113</text>
<text text-anchor="middle" x="15636.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="15636.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep1 -->
<g id="edge633" class="edge">
<title>layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17278.69,-1188.93C17013.61,-1181.71 16525.85,-1163.98 16111.33,-1124.33 16086.24,-1121.93 16060.45,-1119.17 16034.47,-1116.15"/>
<polygon fill="black" stroke="black" points="16034.84,-1112.67 16024.5,-1114.98 16034.03,-1119.62 16034.84,-1112.67"/>
</g>
<!-- layer61_gate_dp0_tp1_ep2 -->
<g id="node515" class="node">
<title>layer61_gate_dp0_tp1_ep2</title>
<polygon fill="lightgreen" stroke="black" points="16918.63,-1124.33 16283.43,-1124.33 16120.03,-988.33 16755.22,-988.33 16918.63,-1124.33"/>
<text text-anchor="middle" x="16519.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="16519.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 114</text>
<text text-anchor="middle" x="16519.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="16519.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep2 -->
<g id="edge639" class="edge">
<title>layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17278.76,-1166.44C17187.45,-1153.8 17077.31,-1138.44 16978.33,-1124.33 16958.02,-1121.44 16937.22,-1118.46 16916.21,-1115.44"/>
<polygon fill="black" stroke="black" points="16916.61,-1111.96 16906.21,-1114 16915.61,-1118.89 16916.61,-1111.96"/>
</g>
<!-- layer61_gate_dp0_tp1_ep3 -->
<g id="node521" class="node">
<title>layer61_gate_dp0_tp1_ep3</title>
<polygon fill="lightgreen" stroke="black" points="17785.63,-1124.33 17150.43,-1124.33 16987.03,-988.33 17622.22,-988.33 17785.63,-1124.33"/>
<text text-anchor="middle" x="17386.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="17386.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 115</text>
<text text-anchor="middle" x="17386.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="17386.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep3 -->
<g id="edge645" class="edge">
<title>layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17452.8,-1160.06C17447.46,-1151.82 17441.52,-1142.63 17435.45,-1133.25"/>
<polygon fill="black" stroke="black" points="17438.22,-1131.09 17429.85,-1124.6 17432.34,-1134.89 17438.22,-1131.09"/>
</g>
<!-- layer61_gate_dp0_tp1_ep4 -->
<g id="node527" class="node">
<title>layer61_gate_dp0_tp1_ep4</title>
<polygon fill="lightgreen" stroke="black" points="18618.63,-1124.33 17983.43,-1124.33 17820.03,-988.33 18455.22,-988.33 18618.63,-1124.33"/>
<text text-anchor="middle" x="18219.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="18219.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 116</text>
<text text-anchor="middle" x="18219.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="18219.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep4 -->
<g id="edge651" class="edge">
<title>layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17655.15,-1160.32C17743.52,-1144.19 17851.68,-1124.45 17949.57,-1106.58"/>
<polygon fill="black" stroke="black" points="17950.41,-1109.98 17959.62,-1104.74 17949.15,-1103.1 17950.41,-1109.98"/>
</g>
<!-- layer61_gate_dp0_tp1_ep5 -->
<g id="node533" class="node">
<title>layer61_gate_dp0_tp1_ep5</title>
<polygon fill="lightgreen" stroke="black" points="19484.63,-1124.33 18849.43,-1124.33 18686.03,-988.33 19321.22,-988.33 19484.63,-1124.33"/>
<text text-anchor="middle" x="19085.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="19085.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 117</text>
<text text-anchor="middle" x="19085.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="19085.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep5 -->
<g id="edge657" class="edge">
<title>layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17670.08,-1186.72C17899.79,-1177.78 18291.95,-1158.83 18627.33,-1124.33 18686.58,-1118.24 18749.92,-1110.05 18810.01,-1101.5"/>
<polygon fill="black" stroke="black" points="18810.61,-1104.95 18820.01,-1100.07 18809.61,-1098.02 18810.61,-1104.95"/>
</g>
<!-- layer61_gate_dp0_tp1_ep6 -->
<g id="node539" class="node">
<title>layer61_gate_dp0_tp1_ep6</title>
<polygon fill="lightgreen" stroke="black" points="20359.63,-1124.33 19724.43,-1124.33 19561.03,-988.33 20196.22,-988.33 20359.63,-1124.33"/>
<text text-anchor="middle" x="19960.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="19960.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 118</text>
<text text-anchor="middle" x="19960.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="19960.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep6 -->
<g id="edge663" class="edge">
<title>layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17670.01,-1193.68C18031.11,-1192.74 18826.27,-1183.41 19493.33,-1124.33 19555.67,-1118.81 19622.4,-1110.62 19685.35,-1101.84"/>
<polygon fill="black" stroke="black" points="19686,-1105.28 19695.42,-1100.42 19685.03,-1098.35 19686,-1105.28"/>
</g>
<!-- layer61_gate_dp0_tp1_ep7 -->
<g id="node545" class="node">
<title>layer61_gate_dp0_tp1_ep7</title>
<polygon fill="lightgreen" stroke="black" points="21238.63,-1124.33 20603.43,-1124.33 20440.03,-988.33 21075.22,-988.33 21238.63,-1124.33"/>
<text text-anchor="middle" x="20839.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="20839.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 119</text>
<text text-anchor="middle" x="20839.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="20839.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep7 -->
<g id="edge669" class="edge">
<title>layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17669.88,-1191.67C18231.44,-1186.41 19842.34,-1167.86 20368.33,-1124.33 20432,-1119.06 20500.21,-1110.86 20564.39,-1101.98"/>
<polygon fill="black" stroke="black" points="20565.23,-1105.39 20574.65,-1100.55 20564.26,-1098.46 20565.23,-1105.39"/>
</g>
<!-- layer61_gate_dp0_tp1_ep8 -->
<g id="node551" class="node">
<title>layer61_gate_dp0_tp1_ep8</title>
<polygon fill="lightgreen" stroke="black" points="22119.63,-1124.33 21484.43,-1124.33 21321.03,-988.33 21956.22,-988.33 22119.63,-1124.33"/>
<text text-anchor="middle" x="21720.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="21720.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 120</text>
<text text-anchor="middle" x="21720.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="21720.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep8 -->
<g id="edge675" class="edge">
<title>layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17669.93,-1192.92C18340.22,-1191.02 20541.9,-1180.53 21247.33,-1124.33 21311.81,-1119.2 21380.91,-1110.97 21445.82,-1102.01"/>
<polygon fill="black" stroke="black" points="21446.36,-1105.47 21455.78,-1100.63 21445.4,-1098.54 21446.36,-1105.47"/>
</g>
<!-- layer61_gate_dp0_tp1_ep9 -->
<g id="node557" class="node">
<title>layer61_gate_dp0_tp1_ep9</title>
<polygon fill="lightgreen" stroke="black" points="23001.63,-1124.33 22366.43,-1124.33 22203.03,-988.33 22838.22,-988.33 23001.63,-1124.33"/>
<text text-anchor="middle" x="22602.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="22602.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 121</text>
<text text-anchor="middle" x="22602.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="22602.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep9 -->
<g id="edge681" class="edge">
<title>layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17670.01,-1193.71C18437.21,-1194.68 21241.36,-1193.32 22128.33,-1124.33 22193.15,-1119.29 22262.62,-1111.07 22327.85,-1102.09"/>
<polygon fill="black" stroke="black" points="22328.43,-1105.54 22337.86,-1100.7 22327.47,-1098.61 22328.43,-1105.54"/>
</g>
<!-- layer61_gate_dp0_tp1_ep10 -->
<g id="node563" class="node">
<title>layer61_gate_dp0_tp1_ep10</title>
<polygon fill="lightgreen" stroke="black" points="23883.63,-1124.33 23248.43,-1124.33 23085.03,-988.33 23720.22,-988.33 23883.63,-1124.33"/>
<text text-anchor="middle" x="23484.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="23484.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 122</text>
<text text-anchor="middle" x="23484.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="23484.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep10 -->
<g id="edge687" class="edge">
<title>layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17669.87,-1192.38C18590.44,-1187.71 22470.34,-1165.69 23010.33,-1124.33 23075.16,-1119.37 23144.63,-1111.18 23209.85,-1102.2"/>
<polygon fill="black" stroke="black" points="23210.44,-1105.66 23219.86,-1100.81 23209.48,-1098.72 23210.44,-1105.66"/>
</g>
<!-- layer61_gate_dp0_tp1_ep11 -->
<g id="node569" class="node">
<title>layer61_gate_dp0_tp1_ep11</title>
<polygon fill="lightgreen" stroke="black" points="24766.63,-1124.33 24131.43,-1124.33 23968.03,-988.33 24603.22,-988.33 24766.63,-1124.33"/>
<text text-anchor="middle" x="24367.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="24367.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 123</text>
<text text-anchor="middle" x="24367.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="24367.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep11 -->
<g id="edge693" class="edge">
<title>layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17670.09,-1192.74C18678.05,-1189.48 23260.02,-1172.12 23892.33,-1124.33 23957.49,-1119.41 24027.34,-1111.21 24092.87,-1102.2"/>
<polygon fill="black" stroke="black" points="24093.51,-1105.65 24102.93,-1100.81 24092.55,-1098.71 24093.51,-1105.65"/>
</g>
<!-- layer61_gate_dp0_tp1_ep12 -->
<g id="node575" class="node">
<title>layer61_gate_dp0_tp1_ep12</title>
<polygon fill="lightgreen" stroke="black" points="25649.63,-1124.33 25014.43,-1124.33 24851.03,-988.33 25486.22,-988.33 25649.63,-1124.33"/>
<text text-anchor="middle" x="25250.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="25250.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 124</text>
<text text-anchor="middle" x="25250.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="25250.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep12 -->
<g id="edge699" class="edge">
<title>layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17669.96,-1193.01C18758.92,-1191.03 24050.18,-1178.67 24775.33,-1124.33 24840.5,-1119.45 24910.34,-1111.27 24975.88,-1102.26"/>
<polygon fill="black" stroke="black" points="24976.51,-1105.71 24985.94,-1100.87 24975.55,-1098.77 24976.51,-1105.71"/>
</g>
<!-- layer61_gate_dp0_tp1_ep13 -->
<g id="node581" class="node">
<title>layer61_gate_dp0_tp1_ep13</title>
<polygon fill="lightgreen" stroke="black" points="26532.63,-1124.33 25897.43,-1124.33 25734.03,-988.33 26369.22,-988.33 26532.63,-1124.33"/>
<text text-anchor="middle" x="26133.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="26133.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 125</text>
<text text-anchor="middle" x="26133.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="26133.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep13 -->
<g id="edge705" class="edge">
<title>layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17670.29,-1193.23C18836.52,-1192.41 24840.14,-1185.22 25658.33,-1124.33 25723.5,-1119.48 25793.35,-1111.31 25858.88,-1102.31"/>
<polygon fill="black" stroke="black" points="25859.51,-1105.76 25868.94,-1100.92 25858.55,-1098.82 25859.51,-1105.76"/>
</g>
<!-- layer61_gate_dp0_tp1_ep14 -->
<g id="node587" class="node">
<title>layer61_gate_dp0_tp1_ep14</title>
<polygon fill="lightgreen" stroke="black" points="27415.63,-1124.33 26780.43,-1124.33 26617.03,-988.33 27252.22,-988.33 27415.63,-1124.33"/>
<text text-anchor="middle" x="27016.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="27016.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 126</text>
<text text-anchor="middle" x="27016.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="27016.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep14 -->
<g id="edge711" class="edge">
<title>layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17669.93,-1193.4C18907.7,-1193.64 25629.69,-1191.8 26541.33,-1124.33 26606.6,-1119.5 26676.56,-1111.32 26742.18,-1102.31"/>
<polygon fill="black" stroke="black" points="26742.83,-1105.75 26752.25,-1100.91 26741.87,-1098.82 26742.83,-1105.75"/>
</g>
<!-- layer61_gate_dp0_tp1_ep15 -->
<g id="node593" class="node">
<title>layer61_gate_dp0_tp1_ep15</title>
<polygon fill="lightgreen" stroke="black" points="28298.63,-1124.33 27663.43,-1124.33 27500.03,-988.33 28135.22,-988.33 28298.63,-1124.33"/>
<text text-anchor="middle" x="27899.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="27899.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 127</text>
<text text-anchor="middle" x="27899.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="27899.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep15 -->
<g id="edge717" class="edge">
<title>layer61_mla_dp0_tp1&#45;&gt;layer61_gate_dp0_tp1_ep15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17669.93,-1193.55C18976.68,-1194.76 26419.11,-1198.38 27424.33,-1124.33 27489.6,-1119.52 27559.56,-1111.35 27625.19,-1102.34"/>
<polygon fill="black" stroke="black" points="27625.83,-1105.78 27635.26,-1100.94 27624.87,-1098.85 27625.83,-1105.78"/>
</g>
<!-- layer61_gate_dp1_tp0_ep0 -->
<g id="node599" class="node">
<title>layer61_gate_dp1_tp0_ep0</title>
<polygon fill="lightgreen" stroke="black" points="29280.63,-1124.33 28645.43,-1124.33 28482.03,-988.33 29117.22,-988.33 29280.63,-1124.33"/>
<text text-anchor="middle" x="28881.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="28881.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 176</text>
<text text-anchor="middle" x="28881.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="28881.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep0 -->
<g id="edge723" class="edge">
<title>layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39151.78,-1193.49C37843.37,-1194.37 30381.28,-1196.15 29373.33,-1124.33 29342.87,-1122.16 29311.43,-1119.31 29279.85,-1116.01"/>
<polygon fill="black" stroke="black" points="29279.91,-1112.49 29269.59,-1114.92 29279.17,-1119.46 29279.91,-1112.49"/>
</g>
<!-- layer61_gate_dp1_tp0_ep1 -->
<g id="node605" class="node">
<title>layer61_gate_dp1_tp0_ep1</title>
<polygon fill="lightgreen" stroke="black" points="30180.63,-1124.33 29545.43,-1124.33 29382.03,-988.33 30017.22,-988.33 30180.63,-1124.33"/>
<text text-anchor="middle" x="29781.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="29781.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 177</text>
<text text-anchor="middle" x="29781.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="29781.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep1 -->
<g id="edge729" class="edge">
<title>layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39151.58,-1193.35C37912.87,-1193.25 31185.83,-1189.67 30273.33,-1124.33 30242.78,-1122.15 30211.23,-1119.28 30179.55,-1115.95"/>
<polygon fill="black" stroke="black" points="30179.57,-1112.44 30169.26,-1114.86 30178.83,-1119.4 30179.57,-1112.44"/>
</g>
<!-- layer61_gate_dp1_tp0_ep2 -->
<g id="node611" class="node">
<title>layer61_gate_dp1_tp0_ep2</title>
<polygon fill="lightgreen" stroke="black" points="31080.63,-1124.33 30445.43,-1124.33 30282.03,-988.33 30917.22,-988.33 31080.63,-1124.33"/>
<text text-anchor="middle" x="30681.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="30681.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 178</text>
<text text-anchor="middle" x="30681.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="30681.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep2 -->
<g id="edge735" class="edge">
<title>layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39151.67,-1193.23C37985.6,-1192.42 31975.32,-1185.28 31156.33,-1124.33 31131.86,-1122.51 31106.73,-1120.22 31081.41,-1117.6"/>
<polygon fill="black" stroke="black" points="31081.64,-1114.1 31071.32,-1116.53 31080.9,-1121.06 31081.64,-1114.1"/>
</g>
<!-- layer61_gate_dp1_tp0_ep3 -->
<g id="node617" class="node">
<title>layer61_gate_dp1_tp0_ep3</title>
<polygon fill="lightgreen" stroke="black" points="31963.63,-1124.33 31328.43,-1124.33 31165.03,-988.33 31800.22,-988.33 31963.63,-1124.33"/>
<text text-anchor="middle" x="31564.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="31564.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 179</text>
<text text-anchor="middle" x="31564.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="31564.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep3 -->
<g id="edge741" class="edge">
<title>layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39151.48,-1193.15C38058.36,-1191.9 32734.45,-1182.85 32005.33,-1124.33 31993.22,-1123.36 31980.94,-1122.26 31968.56,-1121.04"/>
<polygon fill="black" stroke="black" points="31968.91,-1117.56 31958.61,-1120.04 31968.21,-1124.52 31968.91,-1117.56"/>
</g>
<!-- layer61_gate_dp1_tp0_ep4 -->
<g id="node623" class="node">
<title>layer61_gate_dp1_tp0_ep4</title>
<polygon fill="lightgreen" stroke="black" points="32812.63,-1124.33 32177.43,-1124.33 32014.03,-988.33 32649.22,-988.33 32812.63,-1124.33"/>
<text text-anchor="middle" x="32413.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="32413.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 180</text>
<text text-anchor="middle" x="32413.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="32413.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep4 -->
<g id="edge747" class="edge">
<title>layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39151.67,-1192.69C38141.65,-1189.19 33540.28,-1170.79 32905.33,-1124.33 32874.78,-1122.1 32843.23,-1119.19 32811.56,-1115.85"/>
<polygon fill="black" stroke="black" points="32811.58,-1112.33 32801.27,-1114.75 32810.84,-1119.29 32811.58,-1112.33"/>
</g>
<!-- layer61_gate_dp1_tp0_ep5 -->
<g id="node629" class="node">
<title>layer61_gate_dp1_tp0_ep5</title>
<polygon fill="lightgreen" stroke="black" points="33712.63,-1124.33 33077.43,-1124.33 32914.03,-988.33 33549.22,-988.33 33712.63,-1124.33"/>
<text text-anchor="middle" x="33313.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="33313.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 181</text>
<text text-anchor="middle" x="33313.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="33313.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep5 -->
<g id="edge753" class="edge">
<title>layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39151.64,-1192.21C38233.72,-1186.76 34376.63,-1161.8 33839.33,-1124.33 33796.42,-1121.34 33751.66,-1117.21 33707.15,-1112.46"/>
<polygon fill="black" stroke="black" points="33707.38,-1108.96 33697.06,-1111.37 33706.62,-1115.92 33707.38,-1108.96"/>
</g>
<!-- layer61_gate_dp1_tp0_ep6 -->
<g id="node635" class="node">
<title>layer61_gate_dp1_tp0_ep6</title>
<polygon fill="lightgreen" stroke="black" points="34646.63,-1124.33 34011.43,-1124.33 33848.03,-988.33 34483.22,-988.33 34646.63,-1124.33"/>
<text text-anchor="middle" x="34247.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="34247.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 182</text>
<text text-anchor="middle" x="34247.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="34247.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep6 -->
<g id="edge759" class="edge">
<title>layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39151.57,-1193.68C38387.28,-1194.53 35603.27,-1192.76 34722.33,-1124.33 34697.77,-1122.43 34672.55,-1120.06 34647.14,-1117.38"/>
<polygon fill="black" stroke="black" points="34647.33,-1113.88 34637.02,-1116.29 34646.59,-1120.84 34647.33,-1113.88"/>
</g>
<!-- layer61_gate_dp1_tp0_ep7 -->
<g id="node641" class="node">
<title>layer61_gate_dp1_tp0_ep7</title>
<polygon fill="lightgreen" stroke="black" points="35529.63,-1124.33 34894.43,-1124.33 34731.03,-988.33 35366.22,-988.33 35529.63,-1124.33"/>
<text text-anchor="middle" x="35130.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="35130.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 183</text>
<text text-anchor="middle" x="35130.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="35130.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep7 -->
<g id="edge765" class="edge">
<title>layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39151.54,-1193.18C38480.65,-1192.14 36277.02,-1184.12 35571.33,-1124.33 35559.15,-1123.3 35546.8,-1122.14 35534.34,-1120.88"/>
<polygon fill="black" stroke="black" points="35534.63,-1117.39 35524.32,-1119.84 35533.91,-1124.35 35534.63,-1117.39"/>
</g>
<!-- layer61_gate_dp1_tp0_ep8 -->
<g id="node647" class="node">
<title>layer61_gate_dp1_tp0_ep8</title>
<polygon fill="lightgreen" stroke="black" points="36378.63,-1124.33 35743.43,-1124.33 35580.03,-988.33 36215.22,-988.33 36378.63,-1124.33"/>
<text text-anchor="middle" x="35979.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="35979.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 184</text>
<text text-anchor="middle" x="35979.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="35979.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep8 -->
<g id="edge771" class="edge">
<title>layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39151.6,-1191.63C38590,-1186.29 36980.07,-1167.53 36454.33,-1124.33 36429.69,-1122.31 36404.38,-1119.85 36378.88,-1117.09"/>
<polygon fill="black" stroke="black" points="36379.04,-1113.59 36368.72,-1115.98 36378.28,-1120.55 36379.04,-1113.59"/>
</g>
<!-- layer61_gate_dp1_tp0_ep9 -->
<g id="node653" class="node">
<title>layer61_gate_dp1_tp0_ep9</title>
<polygon fill="lightgreen" stroke="black" points="37261.63,-1124.33 36626.43,-1124.33 36463.03,-988.33 37098.22,-988.33 37261.63,-1124.33"/>
<text text-anchor="middle" x="36862.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="36862.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 185</text>
<text text-anchor="middle" x="36862.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="36862.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep9 -->
<g id="edge777" class="edge">
<title>layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39151.82,-1193.48C38792.02,-1192.22 38001.04,-1182.37 37337.33,-1124.33 37312.61,-1122.17 37287.21,-1119.61 37261.62,-1116.76"/>
<polygon fill="black" stroke="black" points="37261.75,-1113.25 37251.42,-1115.61 37260.97,-1120.21 37261.75,-1113.25"/>
</g>
<!-- layer61_gate_dp1_tp0_ep10 -->
<g id="node659" class="node">
<title>layer61_gate_dp1_tp0_ep10</title>
<polygon fill="lightgreen" stroke="black" points="38144.63,-1124.33 37509.43,-1124.33 37346.03,-988.33 37981.22,-988.33 38144.63,-1124.33"/>
<text text-anchor="middle" x="37745.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="37745.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 186</text>
<text text-anchor="middle" x="37745.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="37745.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep10 -->
<g id="edge783" class="edge">
<title>layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39151.73,-1187.17C38920.61,-1178.62 38524.68,-1160.01 38186.33,-1124.33 38173.87,-1123.02 38161.22,-1121.6 38148.47,-1120.11"/>
<polygon fill="black" stroke="black" points="38148.56,-1116.59 38138.21,-1118.89 38147.73,-1123.54 38148.56,-1116.59"/>
</g>
<!-- layer61_gate_dp1_tp0_ep11 -->
<g id="node665" class="node">
<title>layer61_gate_dp1_tp0_ep11</title>
<polygon fill="lightgreen" stroke="black" points="38993.63,-1124.33 38358.43,-1124.33 38195.03,-988.33 38830.22,-988.33 38993.63,-1124.33"/>
<text text-anchor="middle" x="38594.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="38594.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 187</text>
<text text-anchor="middle" x="38594.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="38594.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep11 -->
<g id="edge789" class="edge">
<title>layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39164.57,-1160.32C39107.12,-1149.95 39041.4,-1138.08 38975.49,-1126.17"/>
<polygon fill="black" stroke="black" points="38975.8,-1122.67 38965.34,-1124.34 38974.55,-1129.56 38975.8,-1122.67"/>
</g>
<!-- layer61_gate_dp1_tp0_ep12 -->
<g id="node671" class="node">
<title>layer61_gate_dp1_tp0_ep12</title>
<polygon fill="lightgreen" stroke="black" points="39826.63,-1124.33 39191.43,-1124.33 39028.03,-988.33 39663.22,-988.33 39826.63,-1124.33"/>
<text text-anchor="middle" x="39427.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="39427.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 188</text>
<text text-anchor="middle" x="39427.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="39427.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep12 -->
<g id="edge795" class="edge">
<title>layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39366.9,-1160.06C39371.75,-1151.82 39377.15,-1142.63 39382.67,-1133.25"/>
<polygon fill="black" stroke="black" points="39385.71,-1134.99 39387.76,-1124.6 39379.67,-1131.44 39385.71,-1134.99"/>
</g>
<!-- layer61_gate_dp1_tp0_ep13 -->
<g id="node677" class="node">
<title>layer61_gate_dp1_tp0_ep13</title>
<polygon fill="lightgreen" stroke="black" points="40693.63,-1124.33 40058.43,-1124.33 39895.03,-988.33 40530.22,-988.33 40693.63,-1124.33"/>
<text text-anchor="middle" x="40294.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="40294.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 189</text>
<text text-anchor="middle" x="40294.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="40294.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep13 -->
<g id="edge801" class="edge">
<title>layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39542.96,-1165.88C39632.15,-1153.31 39739.09,-1138.16 39835.33,-1124.33 39893.44,-1115.98 39955.69,-1106.95 40014.99,-1098.31"/>
<polygon fill="black" stroke="black" points="40015.86,-1101.72 40025.25,-1096.82 40014.85,-1094.8 40015.86,-1101.72"/>
</g>
<!-- layer61_gate_dp1_tp0_ep14 -->
<g id="node683" class="node">
<title>layer61_gate_dp1_tp0_ep14</title>
<polygon fill="lightgreen" stroke="black" points="41559.63,-1124.33 40924.43,-1124.33 40761.03,-988.33 41396.22,-988.33 41559.63,-1124.33"/>
<text text-anchor="middle" x="41160.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="41160.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 190</text>
<text text-anchor="middle" x="41160.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="41160.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep14 -->
<g id="edge807" class="edge">
<title>layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39542.97,-1189.16C39806.78,-1182.22 40290.93,-1164.81 40702.33,-1124.33 40761.8,-1118.48 40825.36,-1110.38 40885.62,-1101.82"/>
<polygon fill="black" stroke="black" points="40886.25,-1105.27 40895.65,-1100.39 40885.26,-1098.34 40886.25,-1105.27"/>
</g>
<!-- layer61_gate_dp1_tp0_ep15 -->
<g id="node689" class="node">
<title>layer61_gate_dp1_tp0_ep15</title>
<polygon fill="lightgreen" stroke="black" points="42434.63,-1124.33 41799.43,-1124.33 41636.03,-988.33 42271.22,-988.33 42434.63,-1124.33"/>
<text text-anchor="middle" x="42035.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="42035.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 191</text>
<text text-anchor="middle" x="42035.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="42035.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep15 -->
<g id="edge813" class="edge">
<title>layer61_mla_dp1_tp0&#45;&gt;layer61_gate_dp1_tp0_ep15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39542.91,-1190.06C40009.52,-1181.79 41178.12,-1158.28 41568.33,-1124.33 41630.77,-1118.9 41697.62,-1110.73 41760.65,-1101.94"/>
<polygon fill="black" stroke="black" points="41761.32,-1105.38 41770.74,-1100.52 41760.35,-1098.45 41761.32,-1105.38"/>
</g>
<!-- layer61_gate_dp1_tp1_ep0 -->
<g id="node695" class="node">
<title>layer61_gate_dp1_tp1_ep0</title>
<polygon fill="lightgreen" stroke="black" points="43425.63,-1124.33 42790.43,-1124.33 42627.03,-988.33 43262.22,-988.33 43425.63,-1124.33"/>
<text text-anchor="middle" x="43026.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="43026.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 240</text>
<text text-anchor="middle" x="43026.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="43026.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep0 -->
<g id="edge819" class="edge">
<title>layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45538.66,-1194.08C45151.94,-1194.03 44262.7,-1186.44 43518.33,-1124.33 43487.38,-1121.75 43455.4,-1118.57 43423.29,-1115.01"/>
<polygon fill="black" stroke="black" points="43423.65,-1111.53 43413.32,-1113.89 43422.87,-1118.48 43423.65,-1111.53"/>
</g>
<!-- layer61_gate_dp1_tp1_ep1 -->
<g id="node701" class="node">
<title>layer61_gate_dp1_tp1_ep1</title>
<polygon fill="lightgreen" stroke="black" points="44325.63,-1124.33 43690.43,-1124.33 43527.03,-988.33 44162.22,-988.33 44325.63,-1124.33"/>
<text text-anchor="middle" x="43926.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="43926.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 241</text>
<text text-anchor="middle" x="43926.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="43926.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep1 -->
<g id="edge825" class="edge">
<title>layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45538.61,-1189.62C45272.82,-1183.17 44783.14,-1166.31 44367.33,-1124.33 44354.94,-1123.08 44342.37,-1121.72 44329.69,-1120.28"/>
<polygon fill="black" stroke="black" points="44329.83,-1116.77 44319.49,-1119.1 44329.02,-1123.73 44329.83,-1116.77"/>
</g>
<!-- layer61_gate_dp1_tp1_ep2 -->
<g id="node707" class="node">
<title>layer61_gate_dp1_tp1_ep2</title>
<polygon fill="lightgreen" stroke="black" points="45174.63,-1124.33 44539.43,-1124.33 44376.03,-988.33 45011.22,-988.33 45174.63,-1124.33"/>
<text text-anchor="middle" x="44775.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="44775.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 242</text>
<text text-anchor="middle" x="44775.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="44775.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep2 -->
<g id="edge831" class="edge">
<title>layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45538.67,-1166.69C45446.34,-1154.03 45334.64,-1138.58 45234.33,-1124.33 45214.11,-1121.46 45193.39,-1118.5 45172.47,-1115.5"/>
<polygon fill="black" stroke="black" points="45172.91,-1112.03 45162.52,-1114.07 45171.92,-1118.96 45172.91,-1112.03"/>
</g>
<!-- layer61_gate_dp1_tp1_ep3 -->
<g id="node713" class="node">
<title>layer61_gate_dp1_tp1_ep3</title>
<polygon fill="lightgreen" stroke="black" points="46041.63,-1124.33 45406.43,-1124.33 45243.03,-988.33 45878.22,-988.33 46041.63,-1124.33"/>
<text text-anchor="middle" x="45642.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="45642.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 243</text>
<text text-anchor="middle" x="45642.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="45642.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep3 -->
<g id="edge837" class="edge">
<title>layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45711.82,-1160.06C45706.18,-1151.73 45699.9,-1142.45 45693.49,-1132.96"/>
<polygon fill="black" stroke="black" points="45696.33,-1130.92 45687.83,-1124.6 45690.53,-1134.84 45696.33,-1130.92"/>
</g>
<!-- layer61_gate_dp1_tp1_ep4 -->
<g id="node719" class="node">
<title>layer61_gate_dp1_tp1_ep4</title>
<polygon fill="lightgreen" stroke="black" points="46890.63,-1124.33 46255.43,-1124.33 46092.03,-988.33 46727.22,-988.33 46890.63,-1124.33"/>
<text text-anchor="middle" x="46491.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="46491.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 244</text>
<text text-anchor="middle" x="46491.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="46491.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep4 -->
<g id="edge843" class="edge">
<title>layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45918.06,-1160.32C46009.01,-1143.99 46120.58,-1123.94 46221.04,-1105.89"/>
<polygon fill="black" stroke="black" points="46221.82,-1109.31 46231.04,-1104.1 46220.58,-1102.42 46221.82,-1109.31"/>
</g>
<!-- layer61_gate_dp1_tp1_ep5 -->
<g id="node725" class="node">
<title>layer61_gate_dp1_tp1_ep5</title>
<polygon fill="lightgreen" stroke="black" points="47756.63,-1124.33 47121.43,-1124.33 46958.03,-988.33 47593.22,-988.33 47756.63,-1124.33"/>
<text text-anchor="middle" x="47357.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="47357.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 245</text>
<text text-anchor="middle" x="47357.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="47357.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep5 -->
<g id="edge849" class="edge">
<title>layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45930.05,-1186.89C46161.86,-1178.07 46559.46,-1159.19 46899.33,-1124.33 46958.58,-1118.26 47021.92,-1110.08 47082.01,-1101.53"/>
<polygon fill="black" stroke="black" points="47082.61,-1104.98 47092.01,-1100.1 47081.62,-1098.05 47082.61,-1104.98"/>
</g>
<!-- layer61_gate_dp1_tp1_ep6 -->
<g id="node731" class="node">
<title>layer61_gate_dp1_tp1_ep6</title>
<polygon fill="lightgreen" stroke="black" points="48631.63,-1124.33 47996.43,-1124.33 47833.03,-988.33 48468.22,-988.33 48631.63,-1124.33"/>
<text text-anchor="middle" x="48232.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="48232.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 246</text>
<text text-anchor="middle" x="48232.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="48232.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep6 -->
<g id="edge855" class="edge">
<title>layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45930.11,-1193.73C46292.85,-1192.91 47093.65,-1183.75 47765.33,-1124.33 47827.67,-1118.82 47894.4,-1110.63 47957.35,-1101.85"/>
<polygon fill="black" stroke="black" points="47958,-1105.29 47967.42,-1100.43 47957.03,-1098.36 47958,-1105.29"/>
</g>
<!-- layer61_gate_dp1_tp1_ep7 -->
<g id="node737" class="node">
<title>layer61_gate_dp1_tp1_ep7</title>
<polygon fill="lightgreen" stroke="black" points="49510.63,-1124.33 48875.43,-1124.33 48712.03,-988.33 49347.22,-988.33 49510.63,-1124.33"/>
<text text-anchor="middle" x="49111.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="49111.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 247</text>
<text text-anchor="middle" x="49111.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="49111.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep7 -->
<g id="edge861" class="edge">
<title>layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45929.93,-1191.69C46493.14,-1186.48 48111.93,-1168.04 48640.33,-1124.33 48704,-1119.07 48772.21,-1110.86 48836.39,-1101.98"/>
<polygon fill="black" stroke="black" points="48837.23,-1105.4 48846.65,-1100.55 48836.26,-1098.47 48837.23,-1105.4"/>
</g>
<!-- layer61_gate_dp1_tp1_ep8 -->
<g id="node743" class="node">
<title>layer61_gate_dp1_tp1_ep8</title>
<polygon fill="lightgreen" stroke="black" points="50391.63,-1124.33 49756.43,-1124.33 49593.03,-988.33 50228.22,-988.33 50391.63,-1124.33"/>
<text text-anchor="middle" x="49992.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="49992.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 248</text>
<text text-anchor="middle" x="49992.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="49992.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep8 -->
<g id="edge867" class="edge">
<title>layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45929.97,-1192.94C46601.7,-1191.07 48811.45,-1180.71 49519.33,-1124.33 49583.81,-1119.2 49652.91,-1110.97 49717.82,-1102.02"/>
<polygon fill="black" stroke="black" points="49718.36,-1105.47 49727.78,-1100.63 49717.4,-1098.54 49718.36,-1105.47"/>
</g>
<!-- layer61_gate_dp1_tp1_ep9 -->
<g id="node749" class="node">
<title>layer61_gate_dp1_tp1_ep9</title>
<polygon fill="lightgreen" stroke="black" points="51273.63,-1124.33 50638.43,-1124.33 50475.03,-988.33 51110.22,-988.33 51273.63,-1124.33"/>
<text text-anchor="middle" x="50874.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="50874.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 249</text>
<text text-anchor="middle" x="50874.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="50874.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep9 -->
<g id="edge873" class="edge">
<title>layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45929.86,-1193.72C46698.1,-1194.73 49510.82,-1193.5 50400.33,-1124.33 50465.15,-1119.29 50534.62,-1111.08 50599.85,-1102.09"/>
<polygon fill="black" stroke="black" points="50600.43,-1105.55 50609.86,-1100.71 50599.47,-1098.61 50600.43,-1105.55"/>
</g>
<!-- layer61_gate_dp1_tp1_ep10 -->
<g id="node755" class="node">
<title>layer61_gate_dp1_tp1_ep10</title>
<polygon fill="lightgreen" stroke="black" points="52155.63,-1124.33 51520.43,-1124.33 51357.03,-988.33 51992.22,-988.33 52155.63,-1124.33"/>
<text text-anchor="middle" x="51756.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="51756.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 250</text>
<text text-anchor="middle" x="51756.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="51756.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep10 -->
<g id="edge879" class="edge">
<title>layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45929.91,-1192.39C46851.78,-1187.73 50741.09,-1165.78 51282.33,-1124.33 51347.16,-1119.37 51416.63,-1111.18 51481.85,-1102.2"/>
<polygon fill="black" stroke="black" points="51482.44,-1105.66 51491.86,-1100.82 51481.48,-1098.72 51482.44,-1105.66"/>
</g>
<!-- layer61_gate_dp1_tp1_ep11 -->
<g id="node761" class="node">
<title>layer61_gate_dp1_tp1_ep11</title>
<polygon fill="lightgreen" stroke="black" points="53038.63,-1124.33 52403.43,-1124.33 52240.03,-988.33 52875.22,-988.33 53038.63,-1124.33"/>
<text text-anchor="middle" x="52639.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="52639.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 251</text>
<text text-anchor="middle" x="52639.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="52639.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep11 -->
<g id="edge885" class="edge">
<title>layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45930.04,-1192.74C46939.04,-1189.5 51530.75,-1172.21 52164.33,-1124.33 52229.49,-1119.41 52299.34,-1111.21 52364.87,-1102.2"/>
<polygon fill="black" stroke="black" points="52365.51,-1105.65 52374.93,-1100.81 52364.55,-1098.71 52365.51,-1105.65"/>
</g>
<!-- layer61_gate_dp1_tp1_ep12 -->
<g id="node767" class="node">
<title>layer61_gate_dp1_tp1_ep12</title>
<polygon fill="lightgreen" stroke="black" points="53921.63,-1124.33 53286.43,-1124.33 53123.03,-988.33 53758.22,-988.33 53921.63,-1124.33"/>
<text text-anchor="middle" x="53522.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="53522.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 252</text>
<text text-anchor="middle" x="53522.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="53522.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep12 -->
<g id="edge891" class="edge">
<title>layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45929.84,-1193.02C47019.59,-1191.06 52320.89,-1178.76 53047.33,-1124.33 53112.5,-1119.45 53182.34,-1111.27 53247.88,-1102.26"/>
<polygon fill="black" stroke="black" points="53248.51,-1105.71 53257.94,-1100.87 53247.55,-1098.77 53248.51,-1105.71"/>
</g>
<!-- layer61_gate_dp1_tp1_ep13 -->
<g id="node773" class="node">
<title>layer61_gate_dp1_tp1_ep13</title>
<polygon fill="lightgreen" stroke="black" points="54804.63,-1124.33 54169.43,-1124.33 54006.03,-988.33 54641.22,-988.33 54804.63,-1124.33"/>
<text text-anchor="middle" x="54405.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="54405.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 253</text>
<text text-anchor="middle" x="54405.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="54405.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep13 -->
<g id="edge897" class="edge">
<title>layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45930.1,-1193.23C47096.89,-1192.42 53110.83,-1185.31 53930.33,-1124.33 53995.5,-1119.48 54065.35,-1111.31 54130.88,-1102.31"/>
<polygon fill="black" stroke="black" points="54131.51,-1105.76 54140.94,-1100.92 54130.55,-1098.82 54131.51,-1105.76"/>
</g>
<!-- layer61_gate_dp1_tp1_ep14 -->
<g id="node779" class="node">
<title>layer61_gate_dp1_tp1_ep14</title>
<polygon fill="lightgreen" stroke="black" points="55687.63,-1124.33 55052.43,-1124.33 54889.03,-988.33 55524.22,-988.33 55687.63,-1124.33"/>
<text text-anchor="middle" x="55288.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="55288.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 254</text>
<text text-anchor="middle" x="55288.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="55288.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep14 -->
<g id="edge903" class="edge">
<title>layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45930.19,-1193.41C47169.6,-1193.66 53900.48,-1191.88 54813.33,-1124.33 54878.6,-1119.5 54948.56,-1111.32 55014.18,-1102.31"/>
<polygon fill="black" stroke="black" points="55014.83,-1105.75 55024.25,-1100.91 55013.87,-1098.82 55014.83,-1105.75"/>
</g>
<!-- layer61_gate_dp1_tp1_ep15 -->
<g id="node785" class="node">
<title>layer61_gate_dp1_tp1_ep15</title>
<polygon fill="lightgreen" stroke="black" points="56570.63,-1124.33 55935.43,-1124.33 55772.03,-988.33 56407.22,-988.33 56570.63,-1124.33"/>
<text text-anchor="middle" x="56171.33" y="-1075.13" font-family="Times,serif" font-size="14.00">LAYER61_GATE</text>
<text text-anchor="middle" x="56171.33" y="-1060.13" font-family="Times,serif" font-size="14.00">GPU: 255</text>
<text text-anchor="middle" x="56171.33" y="-1045.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="56171.33" y="-1030.13" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, expert_scores=16]</text>
</g>
<!-- layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep15 -->
<g id="edge909" class="edge">
<title>layer61_mla_dp1_tp1&#45;&gt;layer61_gate_dp1_tp1_ep15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45929.9,-1193.55C47237.5,-1194.78 54689.83,-1198.47 55696.33,-1124.33 55761.6,-1119.52 55831.56,-1111.35 55897.19,-1102.34"/>
<polygon fill="black" stroke="black" points="55897.83,-1105.78 55907.26,-1100.94 55896.87,-1098.85 55897.83,-1105.78"/>
</g>
<!-- layer61_dispatch_dp0_tp0_ep0 -->
<g id="node408" class="node">
<title>layer61_dispatch_dp0_tp0_ep0</title>
<polygon fill="lightgreen" stroke="black" points="1024.48,-952.33 337.02,-952.33 160.17,-816.33 847.63,-816.33 1024.48,-952.33"/>
<text text-anchor="middle" x="592.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="592.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 48</text>
<text text-anchor="middle" x="592.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="592.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp0_ep0&#45;&gt;layer61_dispatch_dp0_tp0_ep0 -->
<g id="edge532" class="edge">
<title>layer61_gate_dp0_tp0_ep0&#45;&gt;layer61_dispatch_dp0_tp0_ep0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M612.28,-988.14C610.65,-979.74 608.97,-971.09 607.32,-962.55"/>
<polygon fill="black" stroke="black" points="610.72,-961.74 605.38,-952.59 603.85,-963.07 610.72,-961.74"/>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep0 -->
<g id="node409" class="node">
<title>layer61_expert_mlp_dp0_tp0_ep0</title>
<polygon fill="lightblue" stroke="black" points="896.83,-780.33 545.83,-780.33 545.83,-712.33 896.83,-712.33 896.83,-780.33"/>
<text text-anchor="middle" x="721.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="721.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 48</text>
<text text-anchor="middle" x="721.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="721.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp0_ep0&#45;&gt;layer61_expert_mlp_dp0_tp0_ep0 -->
<g id="edge533" class="edge">
<title>layer61_dispatch_dp0_tp0_ep0&#45;&gt;layer61_expert_mlp_dp0_tp0_ep0</title>
<path fill="none" stroke="black" d="M656.07,-816.13C665.29,-806.41 674.54,-796.66 683.05,-787.69"/>
<polygon fill="black" stroke="black" points="685.67,-790.01 690.01,-780.35 680.59,-785.2 685.67,-790.01"/>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep0 -->
<g id="node410" class="node">
<title>layer61_expert_proj_dp0_tp0_ep0</title>
<polygon fill="lightblue" stroke="black" points="1171.83,-676.33 820.83,-676.33 820.83,-608.33 1171.83,-608.33 1171.83,-676.33"/>
<text text-anchor="middle" x="996.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="996.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 48</text>
<text text-anchor="middle" x="996.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="996.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep0&#45;&gt;layer61_expert_proj_dp0_tp0_ep0 -->
<g id="edge534" class="edge">
<title>layer61_expert_mlp_dp0_tp0_ep0&#45;&gt;layer61_expert_proj_dp0_tp0_ep0</title>
<path fill="none" stroke="black" d="M810.61,-712.22C838.37,-701.92 869.13,-690.51 897.5,-679.99"/>
<polygon fill="black" stroke="black" points="898.86,-683.22 907.02,-676.46 896.43,-676.65 898.86,-683.22"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep0 -->
<g id="node411" class="node">
<title>layer61_expert_allreduce_dp0_tp0_ep0</title>
<ellipse fill="lightyellow" stroke="black" cx="1546.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="1546.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="1546.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 48</text>
<text text-anchor="middle" x="1546.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="1546.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep0&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep0 -->
<g id="edge535" class="edge">
<title>layer61_expert_proj_dp0_tp0_ep0&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep0</title>
<path fill="none" stroke="black" d="M1152.83,-608.3C1220.92,-593.93 1300.99,-577.03 1371.06,-562.24"/>
<polygon fill="black" stroke="black" points="1371.82,-565.66 1380.88,-560.17 1370.38,-558.81 1371.82,-565.66"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep0 -->
<g id="node412" class="node">
<title>layer61_aggregate_dp0_tp0_ep0</title>
<polygon fill="lightpink" stroke="black" points="3012.27,-440.17 2430.13,-440.17 2280.38,-304.17 2862.52,-304.17 3012.27,-440.17"/>
<text text-anchor="middle" x="2646.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="2646.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 48</text>
<text text-anchor="middle" x="2646.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="2646.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep0&#45;&gt;layer61_aggregate_dp0_tp0_ep0 -->
<g id="edge536" class="edge">
<title>layer61_expert_allreduce_dp0_tp0_ep0&#45;&gt;layer61_aggregate_dp0_tp0_ep0</title>
<path fill="none" stroke="black" d="M1746.8,-495.9C1925.57,-471.51 2188.46,-435.64 2383.92,-408.97"/>
<polygon fill="black" stroke="black" points="2384.62,-412.41 2394.05,-407.59 2383.67,-405.47 2384.62,-412.41"/>
</g>
<!-- output_agg -->
<g id="node791" class="node">
<title>output_agg</title>
<polygon fill="lightpink" stroke="black" points="28848.44,-268.17 28251.72,-268.17 28098.22,-132.17 28694.93,-132.17 28848.44,-268.17"/>
<text text-anchor="middle" x="28473.33" y="-218.97" font-family="Times,serif" font-size="14.00">OUTPUT_AGGREGATION</text>
<text text-anchor="middle" x="28473.33" y="-203.97" font-family="Times,serif" font-size="14.00">GPU: OutputController</text>
<text text-anchor="middle" x="28473.33" y="-188.97" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="28473.33" y="-173.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_aggregate_dp0_tp0_ep0&#45;&gt;output_agg -->
<g id="edge915" class="edge">
<title>layer61_aggregate_dp0_tp0_ep0&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M2921.35,-357.42C3258.81,-341.23 3848.48,-315.16 4354.33,-304.17 9307.56,-196.47 25711.91,-199.87 28165.23,-201"/>
<polygon fill="black" stroke="black" points="28165.5,-204.5 28175.5,-201 28165.5,-197.5 28165.5,-204.5"/>
</g>
<!-- layer61_dispatch_dp0_tp0_ep1 -->
<g id="node414" class="node">
<title>layer61_dispatch_dp0_tp0_ep1</title>
<polygon fill="lightgreen" stroke="black" points="1907.48,-952.33 1220.02,-952.33 1043.17,-816.33 1730.63,-816.33 1907.48,-952.33"/>
<text text-anchor="middle" x="1475.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="1475.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 49</text>
<text text-anchor="middle" x="1475.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="1475.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp0_ep1&#45;&gt;layer61_dispatch_dp0_tp0_ep1 -->
<g id="edge538" class="edge">
<title>layer61_gate_dp0_tp0_ep1&#45;&gt;layer61_dispatch_dp0_tp0_ep1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1495.28,-988.14C1493.65,-979.74 1491.97,-971.09 1490.32,-962.55"/>
<polygon fill="black" stroke="black" points="1493.72,-961.74 1488.38,-952.59 1486.85,-963.07 1493.72,-961.74"/>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep1 -->
<g id="node415" class="node">
<title>layer61_expert_mlp_dp0_tp0_ep1</title>
<polygon fill="lightblue" stroke="black" points="2293.83,-780.33 1942.83,-780.33 1942.83,-712.33 2293.83,-712.33 2293.83,-780.33"/>
<text text-anchor="middle" x="2118.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="2118.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 49</text>
<text text-anchor="middle" x="2118.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="2118.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp0_ep1&#45;&gt;layer61_expert_mlp_dp0_tp0_ep1 -->
<g id="edge539" class="edge">
<title>layer61_dispatch_dp0_tp0_ep1&#45;&gt;layer61_expert_mlp_dp0_tp0_ep1</title>
<path fill="none" stroke="black" d="M1744.29,-826.44C1814.69,-811.56 1888.54,-795.94 1951.84,-782.55"/>
<polygon fill="black" stroke="black" points="1952.85,-785.91 1961.91,-780.42 1951.4,-779.06 1952.85,-785.91"/>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep1 -->
<g id="node416" class="node">
<title>layer61_expert_proj_dp0_tp0_ep1</title>
<polygon fill="lightblue" stroke="black" points="2294.83,-676.33 1943.83,-676.33 1943.83,-608.33 2294.83,-608.33 2294.83,-676.33"/>
<text text-anchor="middle" x="2119.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="2119.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 49</text>
<text text-anchor="middle" x="2119.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="2119.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep1&#45;&gt;layer61_expert_proj_dp0_tp0_ep1 -->
<g id="edge540" class="edge">
<title>layer61_expert_mlp_dp0_tp0_ep1&#45;&gt;layer61_expert_proj_dp0_tp0_ep1</title>
<path fill="none" stroke="black" d="M2118.65,-712.22C2118.73,-704.11 2118.82,-695.32 2118.9,-686.81"/>
<polygon fill="black" stroke="black" points="2122.4,-686.67 2119,-676.63 2115.4,-686.6 2122.4,-686.67"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep1 -->
<g id="node417" class="node">
<title>layer61_expert_allreduce_dp0_tp0_ep1</title>
<ellipse fill="lightyellow" stroke="black" cx="3859.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="3859.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="3859.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 49</text>
<text text-anchor="middle" x="3859.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="3859.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep1&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep1 -->
<g id="edge541" class="edge">
<title>layer61_expert_proj_dp0_tp0_ep1&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep1</title>
<path fill="none" stroke="black" d="M2294.94,-629.62C2607.43,-608.77 3260.51,-565.2 3616.04,-541.48"/>
<polygon fill="black" stroke="black" points="3616.46,-544.96 3626.21,-540.8 3616,-537.98 3616.46,-544.96"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep1 -->
<g id="node418" class="node">
<title>layer61_aggregate_dp0_tp0_ep1</title>
<polygon fill="lightpink" stroke="black" points="5095.27,-440.17 4513.13,-440.17 4363.38,-304.17 4945.52,-304.17 5095.27,-440.17"/>
<text text-anchor="middle" x="4729.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="4729.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 49</text>
<text text-anchor="middle" x="4729.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="4729.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep1&#45;&gt;layer61_aggregate_dp0_tp0_ep1 -->
<g id="edge542" class="edge">
<title>layer61_expert_allreduce_dp0_tp0_ep1&#45;&gt;layer61_aggregate_dp0_tp0_ep1</title>
<path fill="none" stroke="black" d="M4042.24,-491.7C4168.05,-469.99 4336.83,-440.88 4475.62,-416.93"/>
<polygon fill="black" stroke="black" points="4476.3,-420.37 4485.56,-415.22 4475.11,-413.47 4476.3,-420.37"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep1&#45;&gt;output_agg -->
<g id="edge916" class="edge">
<title>layer61_aggregate_dp0_tp0_ep1&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M4990.28,-344.38C5148.86,-329.4 5355.53,-312.17 5539.33,-304.17 7900.34,-201.37 25607.12,-200.65 28165.6,-201.09"/>
<polygon fill="black" stroke="black" points="28165.83,-204.59 28175.83,-201.09 28165.83,-197.59 28165.83,-204.59"/>
</g>
<!-- layer61_dispatch_dp0_tp0_ep2 -->
<g id="node420" class="node">
<title>layer61_dispatch_dp0_tp0_ep2</title>
<polygon fill="lightgreen" stroke="black" points="2790.48,-952.33 2103.02,-952.33 1926.17,-816.33 2613.63,-816.33 2790.48,-952.33"/>
<text text-anchor="middle" x="2358.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="2358.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 50</text>
<text text-anchor="middle" x="2358.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="2358.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp0_ep2&#45;&gt;layer61_dispatch_dp0_tp0_ep2 -->
<g id="edge544" class="edge">
<title>layer61_gate_dp0_tp0_ep2&#45;&gt;layer61_dispatch_dp0_tp0_ep2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2378.28,-988.14C2376.65,-979.74 2374.97,-971.09 2373.32,-962.55"/>
<polygon fill="black" stroke="black" points="2376.72,-961.74 2371.38,-952.59 2369.85,-963.07 2376.72,-961.74"/>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep2 -->
<g id="node421" class="node">
<title>layer61_expert_mlp_dp0_tp0_ep2</title>
<polygon fill="lightblue" stroke="black" points="3176.83,-780.33 2825.83,-780.33 2825.83,-712.33 3176.83,-712.33 3176.83,-780.33"/>
<text text-anchor="middle" x="3001.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="3001.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 50</text>
<text text-anchor="middle" x="3001.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="3001.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp0_ep2&#45;&gt;layer61_expert_mlp_dp0_tp0_ep2 -->
<g id="edge545" class="edge">
<title>layer61_dispatch_dp0_tp0_ep2&#45;&gt;layer61_expert_mlp_dp0_tp0_ep2</title>
<path fill="none" stroke="black" d="M2627.29,-826.44C2697.69,-811.56 2771.54,-795.94 2834.84,-782.55"/>
<polygon fill="black" stroke="black" points="2835.85,-785.91 2844.91,-780.42 2834.4,-779.06 2835.85,-785.91"/>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep2 -->
<g id="node422" class="node">
<title>layer61_expert_proj_dp0_tp0_ep2</title>
<polygon fill="lightblue" stroke="black" points="4476.83,-676.33 4125.83,-676.33 4125.83,-608.33 4476.83,-608.33 4476.83,-676.33"/>
<text text-anchor="middle" x="4301.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="4301.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 50</text>
<text text-anchor="middle" x="4301.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="4301.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep2&#45;&gt;layer61_expert_proj_dp0_tp0_ep2 -->
<g id="edge546" class="edge">
<title>layer61_expert_mlp_dp0_tp0_ep2&#45;&gt;layer61_expert_proj_dp0_tp0_ep2</title>
<path fill="none" stroke="black" d="M3176.99,-731.55C3422.16,-712.31 3864.95,-677.57 4115.47,-657.92"/>
<polygon fill="black" stroke="black" points="4116.08,-661.38 4125.77,-657.11 4115.53,-654.4 4116.08,-661.38"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep2 -->
<g id="node423" class="node">
<title>layer61_expert_allreduce_dp0_tp0_ep2</title>
<ellipse fill="lightyellow" stroke="black" cx="5361.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="5361.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="5361.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 50</text>
<text text-anchor="middle" x="5361.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="5361.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep2&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep2 -->
<g id="edge547" class="edge">
<title>layer61_expert_proj_dp0_tp0_ep2&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep2</title>
<path fill="none" stroke="black" d="M4476.96,-622.1C4657.82,-602.29 4940.3,-571.36 5137.18,-549.8"/>
<polygon fill="black" stroke="black" points="5137.81,-553.25 5147.37,-548.68 5137.05,-546.29 5137.81,-553.25"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep2 -->
<g id="node424" class="node">
<title>layer61_aggregate_dp0_tp0_ep2</title>
<polygon fill="lightpink" stroke="black" points="6280.27,-440.17 5698.13,-440.17 5548.38,-304.17 6130.52,-304.17 6280.27,-440.17"/>
<text text-anchor="middle" x="5914.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="5914.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 50</text>
<text text-anchor="middle" x="5914.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="5914.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep2&#45;&gt;layer61_aggregate_dp0_tp0_ep2 -->
<g id="edge548" class="edge">
<title>layer61_expert_allreduce_dp0_tp0_ep2&#45;&gt;layer61_aggregate_dp0_tp0_ep2</title>
<path fill="none" stroke="black" d="M5503.38,-484.7C5557.52,-470 5620.76,-452.84 5681.17,-436.44"/>
<polygon fill="black" stroke="black" points="5682.1,-439.82 5690.84,-433.82 5680.27,-433.06 5682.1,-439.82"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep2&#45;&gt;output_agg -->
<g id="edge917" class="edge">
<title>layer61_aggregate_dp0_tp0_ep2&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M6166.23,-336.58C6271.17,-323.76 6394.42,-310.74 6506.33,-304.17 7637,-237.73 25589.6,-205.89 28166.29,-201.66"/>
<polygon fill="black" stroke="black" points="28166.6,-205.16 28176.6,-201.64 28166.59,-198.16 28166.6,-205.16"/>
</g>
<!-- layer61_dispatch_dp0_tp0_ep3 -->
<g id="node426" class="node">
<title>layer61_dispatch_dp0_tp0_ep3</title>
<polygon fill="lightgreen" stroke="black" points="3673.48,-952.33 2986.02,-952.33 2809.17,-816.33 3496.63,-816.33 3673.48,-952.33"/>
<text text-anchor="middle" x="3241.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="3241.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 51</text>
<text text-anchor="middle" x="3241.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="3241.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp0_ep3&#45;&gt;layer61_dispatch_dp0_tp0_ep3 -->
<g id="edge550" class="edge">
<title>layer61_gate_dp0_tp0_ep3&#45;&gt;layer61_dispatch_dp0_tp0_ep3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3261.28,-988.14C3259.65,-979.74 3257.97,-971.09 3256.32,-962.55"/>
<polygon fill="black" stroke="black" points="3259.72,-961.74 3254.38,-952.59 3252.85,-963.07 3259.72,-961.74"/>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep3 -->
<g id="node427" class="node">
<title>layer61_expert_mlp_dp0_tp0_ep3</title>
<polygon fill="lightblue" stroke="black" points="3802.83,-780.33 3451.83,-780.33 3451.83,-712.33 3802.83,-712.33 3802.83,-780.33"/>
<text text-anchor="middle" x="3627.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="3627.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 51</text>
<text text-anchor="middle" x="3627.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="3627.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp0_ep3&#45;&gt;layer61_expert_mlp_dp0_tp0_ep3 -->
<g id="edge551" class="edge">
<title>layer61_dispatch_dp0_tp0_ep3&#45;&gt;layer61_expert_mlp_dp0_tp0_ep3</title>
<path fill="none" stroke="black" d="M3431.5,-816.33C3463.3,-805.12 3495.2,-793.88 3523.75,-783.82"/>
<polygon fill="black" stroke="black" points="3525.03,-787.08 3533.3,-780.46 3522.71,-780.48 3525.03,-787.08"/>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep3 -->
<g id="node428" class="node">
<title>layer61_expert_proj_dp0_tp0_ep3</title>
<polygon fill="lightblue" stroke="black" points="5942.83,-676.33 5591.83,-676.33 5591.83,-608.33 5942.83,-608.33 5942.83,-676.33"/>
<text text-anchor="middle" x="5767.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="5767.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 51</text>
<text text-anchor="middle" x="5767.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="5767.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep3&#45;&gt;layer61_expert_proj_dp0_tp0_ep3 -->
<g id="edge552" class="edge">
<title>layer61_expert_mlp_dp0_tp0_ep3&#45;&gt;layer61_expert_proj_dp0_tp0_ep3</title>
<path fill="none" stroke="black" d="M3802.87,-724.66C3847.34,-720 3895.05,-715.51 3939.33,-712.33 4538.75,-669.37 5250.79,-652.22 5581.45,-646.2"/>
<polygon fill="black" stroke="black" points="5581.67,-649.69 5591.6,-646.01 5581.54,-642.7 5581.67,-649.69"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep3 -->
<g id="node429" class="node">
<title>layer61_expert_allreduce_dp0_tp0_ep3</title>
<ellipse fill="lightyellow" stroke="black" cx="6487.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="6487.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="6487.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 51</text>
<text text-anchor="middle" x="6487.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="6487.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep3&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep3 -->
<g id="edge553" class="edge">
<title>layer61_expert_proj_dp0_tp0_ep3&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep3</title>
<path fill="none" stroke="black" d="M5943,-613.01C6047.55,-596.15 6180.51,-574.72 6288.85,-557.25"/>
<polygon fill="black" stroke="black" points="6289.61,-560.67 6298.93,-555.63 6288.5,-553.76 6289.61,-560.67"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep3 -->
<g id="node430" class="node">
<title>layer61_aggregate_dp0_tp0_ep3</title>
<polygon fill="lightpink" stroke="black" points="7247.27,-440.17 6665.13,-440.17 6515.38,-304.17 7097.52,-304.17 7247.27,-440.17"/>
<text text-anchor="middle" x="6881.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="6881.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 51</text>
<text text-anchor="middle" x="6881.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="6881.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep3&#45;&gt;layer61_aggregate_dp0_tp0_ep3 -->
<g id="edge554" class="edge">
<title>layer61_expert_allreduce_dp0_tp0_ep3&#45;&gt;layer61_aggregate_dp0_tp0_ep3</title>
<path fill="none" stroke="black" d="M6597.86,-481.14C6628.35,-469.53 6662.27,-456.61 6695.76,-443.85"/>
<polygon fill="black" stroke="black" points="6697.09,-447.09 6705.19,-440.26 6694.6,-440.55 6697.09,-447.09"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep3&#45;&gt;output_agg -->
<g id="edge918" class="edge">
<title>layer61_aggregate_dp0_tp0_ep3&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M7126.89,-330.74C7203.08,-319.93 7287.48,-309.72 7365.33,-304.17 8449.12,-226.85 25645.63,-204.38 28165.97,-201.5"/>
<polygon fill="black" stroke="black" points="28166.06,-205 28176.05,-201.49 28166.05,-198 28166.06,-205"/>
</g>
<!-- layer61_dispatch_dp0_tp0_ep4 -->
<g id="node432" class="node">
<title>layer61_dispatch_dp0_tp0_ep4</title>
<polygon fill="lightgreen" stroke="black" points="4556.48,-952.33 3869.02,-952.33 3692.17,-816.33 4379.63,-816.33 4556.48,-952.33"/>
<text text-anchor="middle" x="4124.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="4124.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 52</text>
<text text-anchor="middle" x="4124.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="4124.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp0_ep4&#45;&gt;layer61_dispatch_dp0_tp0_ep4 -->
<g id="edge556" class="edge">
<title>layer61_gate_dp0_tp0_ep4&#45;&gt;layer61_dispatch_dp0_tp0_ep4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4154.56,-988.14C4152.07,-979.65 4149.49,-970.9 4146.95,-962.27"/>
<polygon fill="black" stroke="black" points="4150.29,-961.2 4144.11,-952.59 4143.57,-963.17 4150.29,-961.2"/>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep4 -->
<g id="node433" class="node">
<title>layer61_expert_mlp_dp0_tp0_ep4</title>
<polygon fill="lightblue" stroke="black" points="4299.83,-780.33 3948.83,-780.33 3948.83,-712.33 4299.83,-712.33 4299.83,-780.33"/>
<text text-anchor="middle" x="4124.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="4124.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 52</text>
<text text-anchor="middle" x="4124.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="4124.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp0_ep4&#45;&gt;layer61_expert_mlp_dp0_tp0_ep4 -->
<g id="edge557" class="edge">
<title>layer61_dispatch_dp0_tp0_ep4&#45;&gt;layer61_expert_mlp_dp0_tp0_ep4</title>
<path fill="none" stroke="black" d="M4124.33,-816.13C4124.33,-807.38 4124.33,-798.61 4124.33,-790.4"/>
<polygon fill="black" stroke="black" points="4127.83,-790.35 4124.33,-780.35 4120.83,-790.35 4127.83,-790.35"/>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep4 -->
<g id="node434" class="node">
<title>layer61_expert_proj_dp0_tp0_ep4</title>
<polygon fill="lightblue" stroke="black" points="6996.83,-676.33 6645.83,-676.33 6645.83,-608.33 6996.83,-608.33 6996.83,-676.33"/>
<text text-anchor="middle" x="6821.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="6821.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 52</text>
<text text-anchor="middle" x="6821.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="6821.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep4&#45;&gt;layer61_expert_proj_dp0_tp0_ep4 -->
<g id="edge558" class="edge">
<title>layer61_expert_mlp_dp0_tp0_ep4&#45;&gt;layer61_expert_proj_dp0_tp0_ep4</title>
<path fill="none" stroke="black" d="M4300.06,-738.71C4625.73,-726.42 5345.1,-699.28 5951.33,-676.33 6187.28,-667.4 6459.23,-657.08 6635.38,-650.39"/>
<polygon fill="black" stroke="black" points="6635.67,-653.89 6645.53,-650.01 6635.4,-646.89 6635.67,-653.89"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep4 -->
<g id="node435" class="node">
<title>layer61_expert_allreduce_dp0_tp0_ep4</title>
<ellipse fill="lightyellow" stroke="black" cx="7371.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="7371.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="7371.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 52</text>
<text text-anchor="middle" x="7371.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="7371.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep4&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep4 -->
<g id="edge559" class="edge">
<title>layer61_expert_proj_dp0_tp0_ep4&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep4</title>
<path fill="none" stroke="black" d="M6977.83,-608.3C7045.92,-593.93 7125.99,-577.03 7196.06,-562.24"/>
<polygon fill="black" stroke="black" points="7196.82,-565.66 7205.88,-560.17 7195.38,-558.81 7196.82,-565.66"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep4 -->
<g id="node436" class="node">
<title>layer61_aggregate_dp0_tp0_ep4</title>
<polygon fill="lightpink" stroke="black" points="8106.27,-440.17 7524.13,-440.17 7374.38,-304.17 7956.52,-304.17 8106.27,-440.17"/>
<text text-anchor="middle" x="7740.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="7740.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 52</text>
<text text-anchor="middle" x="7740.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="7740.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep4&#45;&gt;layer61_aggregate_dp0_tp0_ep4 -->
<g id="edge560" class="edge">
<title>layer61_expert_allreduce_dp0_tp0_ep4&#45;&gt;layer61_aggregate_dp0_tp0_ep4</title>
<path fill="none" stroke="black" d="M7476.08,-480.64C7504.08,-469.26 7535.11,-456.63 7565.78,-444.16"/>
<polygon fill="black" stroke="black" points="7567.33,-447.31 7575.28,-440.3 7564.7,-440.82 7567.33,-447.31"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep4&#45;&gt;output_agg -->
<g id="edge919" class="edge">
<title>layer61_aggregate_dp0_tp0_ep4&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M7981.77,-326.97C8042.76,-317.6 8108.27,-309.06 8169.33,-304.17 9209.44,-220.78 25699.02,-203.53 28165.62,-201.41"/>
<polygon fill="black" stroke="black" points="28165.94,-204.91 28175.94,-201.4 28165.94,-197.91 28165.94,-204.91"/>
</g>
<!-- layer61_dispatch_dp0_tp0_ep5 -->
<g id="node438" class="node">
<title>layer61_dispatch_dp0_tp0_ep5</title>
<polygon fill="lightgreen" stroke="black" points="5439.48,-952.33 4752.02,-952.33 4575.17,-816.33 5262.63,-816.33 5439.48,-952.33"/>
<text text-anchor="middle" x="5007.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="5007.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 53</text>
<text text-anchor="middle" x="5007.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="5007.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp0_ep5&#45;&gt;layer61_dispatch_dp0_tp0_ep5 -->
<g id="edge562" class="edge">
<title>layer61_gate_dp0_tp0_ep5&#45;&gt;layer61_dispatch_dp0_tp0_ep5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5047.85,-988.14C5044.46,-979.56 5040.98,-970.72 5037.54,-961.99"/>
<polygon fill="black" stroke="black" points="5040.76,-960.61 5033.83,-952.59 5034.24,-963.18 5040.76,-960.61"/>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep5 -->
<g id="node439" class="node">
<title>layer61_expert_mlp_dp0_tp0_ep5</title>
<polygon fill="lightblue" stroke="black" points="5439.83,-780.33 5088.83,-780.33 5088.83,-712.33 5439.83,-712.33 5439.83,-780.33"/>
<text text-anchor="middle" x="5264.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="5264.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 53</text>
<text text-anchor="middle" x="5264.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="5264.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp0_ep5&#45;&gt;layer61_expert_mlp_dp0_tp0_ep5 -->
<g id="edge563" class="edge">
<title>layer61_dispatch_dp0_tp0_ep5&#45;&gt;layer61_expert_mlp_dp0_tp0_ep5</title>
<path fill="none" stroke="black" d="M5133.94,-816.33C5154.2,-805.61 5174.51,-794.86 5192.88,-785.14"/>
<polygon fill="black" stroke="black" points="5194.52,-788.23 5201.73,-780.46 5191.25,-782.04 5194.52,-788.23"/>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep5 -->
<g id="node440" class="node">
<title>layer61_expert_proj_dp0_tp0_ep5</title>
<polygon fill="lightblue" stroke="black" points="8136.83,-676.33 7785.83,-676.33 7785.83,-608.33 8136.83,-608.33 8136.83,-676.33"/>
<text text-anchor="middle" x="7961.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="7961.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 53</text>
<text text-anchor="middle" x="7961.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="7961.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep5&#45;&gt;layer61_expert_proj_dp0_tp0_ep5 -->
<g id="edge564" class="edge">
<title>layer61_expert_mlp_dp0_tp0_ep5&#45;&gt;layer61_expert_proj_dp0_tp0_ep5</title>
<path fill="none" stroke="black" d="M5439.95,-738.16C5607.17,-731.37 5865.89,-720.95 6090.33,-712.33 6707.36,-688.63 7438.93,-662.11 7775.26,-650.01"/>
<polygon fill="black" stroke="black" points="7775.72,-653.49 7785.59,-649.63 7775.47,-646.5 7775.72,-653.49"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep5 -->
<g id="node441" class="node">
<title>layer61_expert_allreduce_dp0_tp0_ep5</title>
<ellipse fill="lightyellow" stroke="black" cx="8426.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="8426.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="8426.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 53</text>
<text text-anchor="middle" x="8426.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="8426.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep5&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep5 -->
<g id="edge565" class="edge">
<title>layer61_expert_proj_dp0_tp0_ep5&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep5</title>
<path fill="none" stroke="black" d="M8093.64,-608.3C8147.57,-594.84 8210.4,-579.15 8266.83,-565.07"/>
<polygon fill="black" stroke="black" points="8267.71,-568.46 8276.56,-562.64 8266.01,-561.66 8267.71,-568.46"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep5 -->
<g id="node442" class="node">
<title>layer61_aggregate_dp0_tp0_ep5</title>
<polygon fill="lightpink" stroke="black" points="8910.27,-440.17 8328.13,-440.17 8178.38,-304.17 8760.52,-304.17 8910.27,-440.17"/>
<text text-anchor="middle" x="8544.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="8544.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 53</text>
<text text-anchor="middle" x="8544.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="8544.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep5&#45;&gt;layer61_aggregate_dp0_tp0_ep5 -->
<g id="edge566" class="edge">
<title>layer61_expert_allreduce_dp0_tp0_ep5&#45;&gt;layer61_aggregate_dp0_tp0_ep5</title>
<path fill="none" stroke="black" d="M8463.02,-476.59C8470.1,-467.58 8477.68,-457.93 8485.27,-448.28"/>
<polygon fill="black" stroke="black" points="8488.2,-450.21 8491.63,-440.19 8482.7,-445.88 8488.2,-450.21"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep5&#45;&gt;output_agg -->
<g id="edge920" class="edge">
<title>layer61_aggregate_dp0_tp0_ep5&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M8783.47,-324.86C8836.87,-316.33 8893.36,-308.69 8946.33,-304.17 9944.62,-218.89 25755.01,-203.27 28166.03,-201.39"/>
<polygon fill="black" stroke="black" points="28166.12,-204.89 28176.12,-201.38 28166.12,-197.89 28166.12,-204.89"/>
</g>
<!-- layer61_dispatch_dp0_tp0_ep6 -->
<g id="node444" class="node">
<title>layer61_dispatch_dp0_tp0_ep6</title>
<polygon fill="lightgreen" stroke="black" points="6322.48,-952.33 5635.02,-952.33 5458.17,-816.33 6145.63,-816.33 6322.48,-952.33"/>
<text text-anchor="middle" x="5890.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="5890.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 54</text>
<text text-anchor="middle" x="5890.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="5890.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp0_ep6&#45;&gt;layer61_dispatch_dp0_tp0_ep6 -->
<g id="edge568" class="edge">
<title>layer61_gate_dp0_tp0_ep6&#45;&gt;layer61_dispatch_dp0_tp0_ep6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5930.85,-988.14C5927.46,-979.56 5923.98,-970.72 5920.54,-961.99"/>
<polygon fill="black" stroke="black" points="5923.76,-960.61 5916.83,-952.59 5917.24,-963.18 5923.76,-960.61"/>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep6 -->
<g id="node445" class="node">
<title>layer61_expert_mlp_dp0_tp0_ep6</title>
<polygon fill="lightblue" stroke="black" points="6450.83,-780.33 6099.83,-780.33 6099.83,-712.33 6450.83,-712.33 6450.83,-780.33"/>
<text text-anchor="middle" x="6275.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="6275.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 54</text>
<text text-anchor="middle" x="6275.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="6275.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp0_ep6&#45;&gt;layer61_expert_mlp_dp0_tp0_ep6 -->
<g id="edge569" class="edge">
<title>layer61_dispatch_dp0_tp0_ep6&#45;&gt;layer61_expert_mlp_dp0_tp0_ep6</title>
<path fill="none" stroke="black" d="M6080.01,-816.33C6111.72,-805.12 6143.55,-793.88 6172.02,-783.82"/>
<polygon fill="black" stroke="black" points="6173.28,-787.09 6181.55,-780.46 6170.95,-780.49 6173.28,-787.09"/>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep6 -->
<g id="node446" class="node">
<title>layer61_expert_proj_dp0_tp0_ep6</title>
<polygon fill="lightblue" stroke="black" points="8987.83,-676.33 8636.83,-676.33 8636.83,-608.33 8987.83,-608.33 8987.83,-676.33"/>
<text text-anchor="middle" x="8812.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="8812.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 54</text>
<text text-anchor="middle" x="8812.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="8812.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep6&#45;&gt;layer61_expert_proj_dp0_tp0_ep6 -->
<g id="edge570" class="edge">
<title>layer61_expert_mlp_dp0_tp0_ep6&#45;&gt;layer61_expert_proj_dp0_tp0_ep6</title>
<path fill="none" stroke="black" d="M6451.16,-738.04C6618.57,-731.17 6877.61,-720.69 7102.33,-712.33 7565.84,-695.09 7681.9,-695.79 8145.33,-676.33 8307.9,-669.51 8492.68,-660.25 8626.46,-653.27"/>
<polygon fill="black" stroke="black" points="8627.01,-656.75 8636.82,-652.73 8626.65,-649.76 8627.01,-656.75"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep6 -->
<g id="node447" class="node">
<title>layer61_expert_allreduce_dp0_tp0_ep6</title>
<ellipse fill="lightyellow" stroke="black" cx="9117.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="9117.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="9117.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 54</text>
<text text-anchor="middle" x="9117.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="9117.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep6&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep6 -->
<g id="edge571" class="edge">
<title>layer61_expert_proj_dp0_tp0_ep6&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep6</title>
<path fill="none" stroke="black" d="M8899.32,-608.22C8929.77,-596.63 8964.52,-583.41 8997.19,-570.97"/>
<polygon fill="black" stroke="black" points="8998.7,-574.15 9006.8,-567.32 8996.21,-567.6 8998.7,-574.15"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep6 -->
<g id="node448" class="node">
<title>layer61_aggregate_dp0_tp0_ep6</title>
<polygon fill="lightpink" stroke="black" points="9687.27,-440.17 9105.13,-440.17 8955.38,-304.17 9537.52,-304.17 9687.27,-440.17"/>
<text text-anchor="middle" x="9321.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="9321.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 54</text>
<text text-anchor="middle" x="9321.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="9321.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep6&#45;&gt;layer61_aggregate_dp0_tp0_ep6 -->
<g id="edge572" class="edge">
<title>layer61_expert_allreduce_dp0_tp0_ep6&#45;&gt;layer61_aggregate_dp0_tp0_ep6</title>
<path fill="none" stroke="black" d="M9179.36,-477.61C9192.69,-467.8 9207.1,-457.2 9221.45,-446.65"/>
<polygon fill="black" stroke="black" points="9223.9,-449.19 9229.88,-440.44 9219.76,-443.55 9223.9,-449.19"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep6&#45;&gt;output_agg -->
<g id="edge921" class="edge">
<title>layer61_aggregate_dp0_tp0_ep6&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M9559.15,-323.81C9608.9,-315.7 9661.18,-308.5 9710.33,-304.17 10667.69,-219.68 25809.39,-203.43 28166.05,-201.41"/>
<polygon fill="black" stroke="black" points="28166.34,-204.91 28176.34,-201.4 28166.33,-197.91 28166.34,-204.91"/>
</g>
<!-- layer61_dispatch_dp0_tp0_ep7 -->
<g id="node450" class="node">
<title>layer61_dispatch_dp0_tp0_ep7</title>
<polygon fill="lightgreen" stroke="black" points="7205.48,-952.33 6518.02,-952.33 6341.17,-816.33 7028.63,-816.33 7205.48,-952.33"/>
<text text-anchor="middle" x="6773.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="6773.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 55</text>
<text text-anchor="middle" x="6773.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="6773.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp0_ep7&#45;&gt;layer61_dispatch_dp0_tp0_ep7 -->
<g id="edge574" class="edge">
<title>layer61_gate_dp0_tp0_ep7&#45;&gt;layer61_dispatch_dp0_tp0_ep7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6793.28,-988.14C6791.65,-979.74 6789.97,-971.09 6788.32,-962.55"/>
<polygon fill="black" stroke="black" points="6791.72,-961.74 6786.38,-952.59 6784.85,-963.07 6791.72,-961.74"/>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep7 -->
<g id="node451" class="node">
<title>layer61_expert_mlp_dp0_tp0_ep7</title>
<polygon fill="lightblue" stroke="black" points="7462.83,-780.33 7111.83,-780.33 7111.83,-712.33 7462.83,-712.33 7462.83,-780.33"/>
<text text-anchor="middle" x="7287.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="7287.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 55</text>
<text text-anchor="middle" x="7287.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="7287.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp0_ep7&#45;&gt;layer61_expert_mlp_dp0_tp0_ep7 -->
<g id="edge575" class="edge">
<title>layer61_dispatch_dp0_tp0_ep7&#45;&gt;layer61_expert_mlp_dp0_tp0_ep7</title>
<path fill="none" stroke="black" d="M7026.56,-816.33C7070.13,-804.8 7113.84,-793.24 7152.69,-782.96"/>
<polygon fill="black" stroke="black" points="7153.68,-786.31 7162.46,-780.37 7151.89,-779.55 7153.68,-786.31"/>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep7 -->
<g id="node452" class="node">
<title>layer61_expert_proj_dp0_tp0_ep7</title>
<polygon fill="lightblue" stroke="black" points="9598.83,-676.33 9247.83,-676.33 9247.83,-608.33 9598.83,-608.33 9598.83,-676.33"/>
<text text-anchor="middle" x="9423.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="9423.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 55</text>
<text text-anchor="middle" x="9423.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="9423.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep7&#45;&gt;layer61_expert_proj_dp0_tp0_ep7 -->
<g id="edge576" class="edge">
<title>layer61_expert_mlp_dp0_tp0_ep7&#45;&gt;layer61_expert_proj_dp0_tp0_ep7</title>
<path fill="none" stroke="black" d="M7463,-736.46C7604.14,-729.47 7807.45,-719.7 7985.33,-712.33 8434.56,-693.72 8547.42,-701.66 8996.33,-676.33 9075.45,-671.87 9162.71,-665.4 9237.62,-659.37"/>
<polygon fill="black" stroke="black" points="9237.94,-662.86 9247.63,-658.56 9237.38,-655.88 9237.94,-662.86"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep7 -->
<g id="node453" class="node">
<title>layer61_expert_allreduce_dp0_tp0_ep7</title>
<ellipse fill="lightyellow" stroke="black" cx="9884.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="9884.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="9884.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 55</text>
<text text-anchor="middle" x="9884.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="9884.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep7&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep7 -->
<g id="edge577" class="edge">
<title>layer61_expert_proj_dp0_tp0_ep7&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep7</title>
<path fill="none" stroke="black" d="M9554.51,-608.3C9607.74,-594.9 9669.7,-579.29 9725.46,-565.25"/>
<polygon fill="black" stroke="black" points="9726.59,-568.58 9735.44,-562.74 9724.88,-561.79 9726.59,-568.58"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep7 -->
<g id="node454" class="node">
<title>layer61_aggregate_dp0_tp0_ep7</title>
<polygon fill="lightpink" stroke="black" points="10451.27,-440.17 9869.13,-440.17 9719.38,-304.17 10301.52,-304.17 10451.27,-440.17"/>
<text text-anchor="middle" x="10085.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="10085.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 55</text>
<text text-anchor="middle" x="10085.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="10085.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep7&#45;&gt;layer61_aggregate_dp0_tp0_ep7 -->
<g id="edge578" class="edge">
<title>layer61_expert_allreduce_dp0_tp0_ep7&#45;&gt;layer61_aggregate_dp0_tp0_ep7</title>
<path fill="none" stroke="black" d="M9945.45,-477.61C9958.58,-467.8 9972.78,-457.2 9986.92,-446.65"/>
<polygon fill="black" stroke="black" points="9989.31,-449.23 9995.23,-440.44 9985.12,-443.62 9989.31,-449.23"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep7&#45;&gt;output_agg -->
<g id="edge922" class="edge">
<title>layer61_aggregate_dp0_tp0_ep7&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M10322.66,-323.18C10370.37,-315.33 10420.3,-308.39 10467.33,-304.17 11384.29,-221.72 25865.02,-203.79 28166.22,-201.45"/>
<polygon fill="black" stroke="black" points="28166.27,-204.95 28176.27,-201.44 28166.26,-197.95 28166.27,-204.95"/>
</g>
<!-- layer61_dispatch_dp0_tp0_ep8 -->
<g id="node456" class="node">
<title>layer61_dispatch_dp0_tp0_ep8</title>
<polygon fill="lightgreen" stroke="black" points="8088.48,-952.33 7401.02,-952.33 7224.17,-816.33 7911.63,-816.33 8088.48,-952.33"/>
<text text-anchor="middle" x="7656.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="7656.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 56</text>
<text text-anchor="middle" x="7656.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="7656.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp0_ep8&#45;&gt;layer61_dispatch_dp0_tp0_ep8 -->
<g id="edge580" class="edge">
<title>layer61_gate_dp0_tp0_ep8&#45;&gt;layer61_dispatch_dp0_tp0_ep8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7686.56,-988.14C7684.07,-979.65 7681.49,-970.9 7678.95,-962.27"/>
<polygon fill="black" stroke="black" points="7682.29,-961.2 7676.11,-952.59 7675.57,-963.17 7682.29,-961.2"/>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep8 -->
<g id="node457" class="node">
<title>layer61_expert_mlp_dp0_tp0_ep8</title>
<polygon fill="lightblue" stroke="black" points="8345.83,-780.33 7994.83,-780.33 7994.83,-712.33 8345.83,-712.33 8345.83,-780.33"/>
<text text-anchor="middle" x="8170.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="8170.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 56</text>
<text text-anchor="middle" x="8170.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="8170.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp0_ep8&#45;&gt;layer61_expert_mlp_dp0_tp0_ep8 -->
<g id="edge581" class="edge">
<title>layer61_dispatch_dp0_tp0_ep8&#45;&gt;layer61_expert_mlp_dp0_tp0_ep8</title>
<path fill="none" stroke="black" d="M7909.56,-816.33C7953.13,-804.8 7996.84,-793.24 8035.69,-782.96"/>
<polygon fill="black" stroke="black" points="8036.68,-786.31 8045.46,-780.37 8034.89,-779.55 8036.68,-786.31"/>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep8 -->
<g id="node458" class="node">
<title>layer61_expert_proj_dp0_tp0_ep8</title>
<polygon fill="lightblue" stroke="black" points="10374.83,-676.33 10023.83,-676.33 10023.83,-608.33 10374.83,-608.33 10374.83,-676.33"/>
<text text-anchor="middle" x="10199.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="10199.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 56</text>
<text text-anchor="middle" x="10199.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="10199.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep8&#45;&gt;layer61_expert_proj_dp0_tp0_ep8 -->
<g id="edge582" class="edge">
<title>layer61_expert_mlp_dp0_tp0_ep8&#45;&gt;layer61_expert_proj_dp0_tp0_ep8</title>
<path fill="none" stroke="black" d="M8345.93,-730.63C8426.71,-724.27 8523.84,-717.19 8611.33,-712.33 9053.6,-687.8 9164.84,-696.66 9607.33,-676.33 9743.34,-670.08 9896.84,-661.48 10013.45,-654.63"/>
<polygon fill="black" stroke="black" points="10013.77,-658.12 10023.55,-654.03 10013.36,-651.13 10013.77,-658.12"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep8 -->
<g id="node459" class="node">
<title>layer61_expert_allreduce_dp0_tp0_ep8</title>
<ellipse fill="lightyellow" stroke="black" cx="10620.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="10620.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="10620.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 56</text>
<text text-anchor="middle" x="10620.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="10620.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep8&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep8 -->
<g id="edge583" class="edge">
<title>layer61_expert_proj_dp0_tp0_ep8&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep8</title>
<path fill="none" stroke="black" d="M10319.12,-608.3C10366.07,-595.36 10420.45,-580.36 10469.98,-566.7"/>
<polygon fill="black" stroke="black" points="10471.11,-570.02 10479.82,-563.99 10469.25,-563.28 10471.11,-570.02"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep8 -->
<g id="node460" class="node">
<title>layer61_aggregate_dp0_tp0_ep8</title>
<polygon fill="lightpink" stroke="black" points="11208.27,-440.17 10626.13,-440.17 10476.38,-304.17 11058.52,-304.17 11208.27,-440.17"/>
<text text-anchor="middle" x="10842.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="10842.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 56</text>
<text text-anchor="middle" x="10842.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="10842.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep8&#45;&gt;layer61_aggregate_dp0_tp0_ep8 -->
<g id="edge584" class="edge">
<title>layer61_expert_allreduce_dp0_tp0_ep8&#45;&gt;layer61_aggregate_dp0_tp0_ep8</title>
<path fill="none" stroke="black" d="M10687.54,-477.81C10702.42,-467.75 10718.56,-456.84 10734.61,-445.99"/>
<polygon fill="black" stroke="black" points="10736.67,-448.82 10742.99,-440.32 10732.75,-443.02 10736.67,-448.82"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep8&#45;&gt;output_agg -->
<g id="edge923" class="edge">
<title>layer61_aggregate_dp0_tp0_ep8&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M11079.18,-322.85C11125.78,-315.14 11174.45,-308.34 11220.33,-304.17 12097.18,-224.42 25920.98,-204.27 28166.26,-201.52"/>
<polygon fill="black" stroke="black" points="28166.48,-205.02 28176.47,-201.51 28166.47,-198.02 28166.48,-205.02"/>
</g>
<!-- layer61_dispatch_dp0_tp0_ep9 -->
<g id="node462" class="node">
<title>layer61_dispatch_dp0_tp0_ep9</title>
<polygon fill="lightgreen" stroke="black" points="8971.48,-952.33 8284.02,-952.33 8107.17,-816.33 8794.63,-816.33 8971.48,-952.33"/>
<text text-anchor="middle" x="8539.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="8539.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 57</text>
<text text-anchor="middle" x="8539.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="8539.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp0_ep9&#45;&gt;layer61_dispatch_dp0_tp0_ep9 -->
<g id="edge586" class="edge">
<title>layer61_gate_dp0_tp0_ep9&#45;&gt;layer61_dispatch_dp0_tp0_ep9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8579.85,-988.14C8576.46,-979.56 8572.98,-970.72 8569.54,-961.99"/>
<polygon fill="black" stroke="black" points="8572.76,-960.61 8565.83,-952.59 8566.24,-963.18 8572.76,-960.61"/>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep9 -->
<g id="node463" class="node">
<title>layer61_expert_mlp_dp0_tp0_ep9</title>
<polygon fill="lightblue" stroke="black" points="8971.83,-780.33 8620.83,-780.33 8620.83,-712.33 8971.83,-712.33 8971.83,-780.33"/>
<text text-anchor="middle" x="8796.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="8796.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 57</text>
<text text-anchor="middle" x="8796.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="8796.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp0_ep9&#45;&gt;layer61_expert_mlp_dp0_tp0_ep9 -->
<g id="edge587" class="edge">
<title>layer61_dispatch_dp0_tp0_ep9&#45;&gt;layer61_expert_mlp_dp0_tp0_ep9</title>
<path fill="none" stroke="black" d="M8665.94,-816.33C8686.2,-805.61 8706.51,-794.86 8724.88,-785.14"/>
<polygon fill="black" stroke="black" points="8726.52,-788.23 8733.73,-780.46 8723.25,-782.04 8726.52,-788.23"/>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep9 -->
<g id="node464" class="node">
<title>layer61_expert_proj_dp0_tp0_ep9</title>
<polygon fill="lightblue" stroke="black" points="11251.83,-676.33 10900.83,-676.33 10900.83,-608.33 11251.83,-608.33 11251.83,-676.33"/>
<text text-anchor="middle" x="11076.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="11076.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 57</text>
<text text-anchor="middle" x="11076.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="11076.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep9&#45;&gt;layer61_expert_proj_dp0_tp0_ep9 -->
<g id="edge588" class="edge">
<title>layer61_expert_mlp_dp0_tp0_ep9&#45;&gt;layer61_expert_proj_dp0_tp0_ep9</title>
<path fill="none" stroke="black" d="M8972.01,-736.7C9113.15,-729.84 9316.47,-720.14 9494.33,-712.33 9889.38,-695 9988.27,-693.74 10383.33,-676.33 10555.16,-668.76 10750.93,-659.37 10890.45,-652.54"/>
<polygon fill="black" stroke="black" points="10891.01,-656.02 10900.82,-652.04 10890.66,-649.03 10891.01,-656.02"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep9 -->
<g id="node465" class="node">
<title>layer61_expert_allreduce_dp0_tp0_ep9</title>
<ellipse fill="lightyellow" stroke="black" cx="11477.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="11477.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="11477.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 57</text>
<text text-anchor="middle" x="11477.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="11477.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep9&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep9 -->
<g id="edge589" class="edge">
<title>layer61_expert_proj_dp0_tp0_ep9&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep9</title>
<path fill="none" stroke="black" d="M11190.43,-608.3C11234.31,-595.6 11285.01,-580.92 11331.48,-567.47"/>
<polygon fill="black" stroke="black" points="11332.69,-570.76 11341.32,-564.62 11330.74,-564.04 11332.69,-570.76"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep9 -->
<g id="node466" class="node">
<title>layer61_aggregate_dp0_tp0_ep9</title>
<polygon fill="lightpink" stroke="black" points="11961.27,-440.17 11379.13,-440.17 11229.38,-304.17 11811.52,-304.17 11961.27,-440.17"/>
<text text-anchor="middle" x="11595.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="11595.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 57</text>
<text text-anchor="middle" x="11595.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="11595.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep9&#45;&gt;layer61_aggregate_dp0_tp0_ep9 -->
<g id="edge590" class="edge">
<title>layer61_expert_allreduce_dp0_tp0_ep9&#45;&gt;layer61_aggregate_dp0_tp0_ep9</title>
<path fill="none" stroke="black" d="M11514.02,-476.59C11521.1,-467.58 11528.68,-457.93 11536.27,-448.28"/>
<polygon fill="black" stroke="black" points="11539.2,-450.21 11542.63,-440.19 11533.7,-445.88 11539.2,-450.21"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep9&#45;&gt;output_agg -->
<g id="edge924" class="edge">
<title>layer61_aggregate_dp0_tp0_ep9&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M11832.06,-322.78C11878.38,-315.1 11926.73,-308.33 11972.33,-304.17 12809.16,-227.75 25976.29,-204.88 28165.85,-201.6"/>
<polygon fill="black" stroke="black" points="28166.22,-205.1 28176.21,-201.59 28166.21,-198.1 28166.22,-205.1"/>
</g>
<!-- layer61_dispatch_dp0_tp0_ep10 -->
<g id="node468" class="node">
<title>layer61_dispatch_dp0_tp0_ep10</title>
<polygon fill="lightgreen" stroke="black" points="9854.48,-952.33 9167.02,-952.33 8990.17,-816.33 9677.63,-816.33 9854.48,-952.33"/>
<text text-anchor="middle" x="9422.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="9422.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 58</text>
<text text-anchor="middle" x="9422.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="9422.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp0_ep10&#45;&gt;layer61_dispatch_dp0_tp0_ep10 -->
<g id="edge592" class="edge">
<title>layer61_gate_dp0_tp0_ep10&#45;&gt;layer61_dispatch_dp0_tp0_ep10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9442.28,-988.14C9440.65,-979.74 9438.97,-971.09 9437.32,-962.55"/>
<polygon fill="black" stroke="black" points="9440.72,-961.74 9435.38,-952.59 9433.85,-963.07 9440.72,-961.74"/>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep10 -->
<g id="node469" class="node">
<title>layer61_expert_mlp_dp0_tp0_ep10</title>
<polygon fill="lightblue" stroke="black" points="9854.83,-780.33 9503.83,-780.33 9503.83,-712.33 9854.83,-712.33 9854.83,-780.33"/>
<text text-anchor="middle" x="9679.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="9679.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 58</text>
<text text-anchor="middle" x="9679.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="9679.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp0_ep10&#45;&gt;layer61_expert_mlp_dp0_tp0_ep10 -->
<g id="edge593" class="edge">
<title>layer61_dispatch_dp0_tp0_ep10&#45;&gt;layer61_expert_mlp_dp0_tp0_ep10</title>
<path fill="none" stroke="black" d="M9548.94,-816.33C9569.2,-805.61 9589.51,-794.86 9607.88,-785.14"/>
<polygon fill="black" stroke="black" points="9609.52,-788.23 9616.73,-780.46 9606.25,-782.04 9609.52,-788.23"/>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep10 -->
<g id="node470" class="node">
<title>layer61_expert_proj_dp0_tp0_ep10</title>
<polygon fill="lightblue" stroke="black" points="12011.83,-676.33 11660.83,-676.33 11660.83,-608.33 12011.83,-608.33 12011.83,-676.33"/>
<text text-anchor="middle" x="11836.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="11836.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 58</text>
<text text-anchor="middle" x="11836.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="11836.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep10&#45;&gt;layer61_expert_proj_dp0_tp0_ep10 -->
<g id="edge594" class="edge">
<title>layer61_expert_mlp_dp0_tp0_ep10&#45;&gt;layer61_expert_proj_dp0_tp0_ep10</title>
<path fill="none" stroke="black" d="M9855.01,-736.71C9996.15,-729.86 10199.47,-720.16 10377.33,-712.33 10769.72,-695.06 10868.03,-695.57 11260.33,-676.33 11390.7,-669.94 11537.6,-661.51 11650.42,-654.76"/>
<polygon fill="black" stroke="black" points="11650.76,-658.25 11660.54,-654.16 11650.35,-651.26 11650.76,-658.25"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep10 -->
<g id="node471" class="node">
<title>layer61_expert_allreduce_dp0_tp0_ep10</title>
<ellipse fill="lightyellow" stroke="black" cx="12169.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="12169.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="12169.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 58</text>
<text text-anchor="middle" x="12169.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="12169.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep10&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep10 -->
<g id="edge595" class="edge">
<title>layer61_expert_proj_dp0_tp0_ep10&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep10</title>
<path fill="none" stroke="black" d="M11931.3,-608.22C11965.45,-596.32 12004.55,-582.69 12041.06,-569.96"/>
<polygon fill="black" stroke="black" points="12042.49,-573.17 12050.78,-566.57 12040.19,-566.56 12042.49,-573.17"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep10 -->
<g id="node472" class="node">
<title>layer61_aggregate_dp0_tp0_ep10</title>
<polygon fill="lightpink" stroke="black" points="12713.27,-440.17 12131.13,-440.17 11981.38,-304.17 12563.52,-304.17 12713.27,-440.17"/>
<text text-anchor="middle" x="12347.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="12347.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 58</text>
<text text-anchor="middle" x="12347.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="12347.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep10&#45;&gt;layer61_aggregate_dp0_tp0_ep10 -->
<g id="edge596" class="edge">
<title>layer61_expert_allreduce_dp0_tp0_ep10&#45;&gt;layer61_aggregate_dp0_tp0_ep10</title>
<path fill="none" stroke="black" d="M12224.18,-477C12235.5,-467.46 12247.68,-457.19 12259.82,-446.95"/>
<polygon fill="black" stroke="black" points="12262.39,-449.36 12267.78,-440.23 12257.88,-444 12262.39,-449.36"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep10&#45;&gt;output_agg -->
<g id="edge925" class="edge">
<title>layer61_aggregate_dp0_tp0_ep10&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M12584.18,-322.67C12630.15,-315.04 12678.1,-308.31 12723.33,-304.17 13520.35,-231.08 26036.51,-205.52 28166.37,-201.69"/>
<polygon fill="black" stroke="black" points="28166.45,-205.19 28176.44,-201.67 28166.44,-198.19 28166.45,-205.19"/>
</g>
<!-- layer61_dispatch_dp0_tp0_ep11 -->
<g id="node474" class="node">
<title>layer61_dispatch_dp0_tp0_ep11</title>
<polygon fill="lightgreen" stroke="black" points="10737.48,-952.33 10050.02,-952.33 9873.17,-816.33 10560.63,-816.33 10737.48,-952.33"/>
<text text-anchor="middle" x="10305.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="10305.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 59</text>
<text text-anchor="middle" x="10305.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="10305.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp0_ep11&#45;&gt;layer61_dispatch_dp0_tp0_ep11 -->
<g id="edge598" class="edge">
<title>layer61_gate_dp0_tp0_ep11&#45;&gt;layer61_dispatch_dp0_tp0_ep11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10315.61,-988.14C10314.77,-979.74 10313.9,-971.09 10313.05,-962.55"/>
<polygon fill="black" stroke="black" points="10316.53,-962.19 10312.05,-952.59 10309.56,-962.89 10316.53,-962.19"/>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep11 -->
<g id="node475" class="node">
<title>layer61_expert_mlp_dp0_tp0_ep11</title>
<polygon fill="lightblue" stroke="black" points="10737.83,-780.33 10386.83,-780.33 10386.83,-712.33 10737.83,-712.33 10737.83,-780.33"/>
<text text-anchor="middle" x="10562.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="10562.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 59</text>
<text text-anchor="middle" x="10562.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="10562.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp0_ep11&#45;&gt;layer61_expert_mlp_dp0_tp0_ep11 -->
<g id="edge599" class="edge">
<title>layer61_dispatch_dp0_tp0_ep11&#45;&gt;layer61_expert_mlp_dp0_tp0_ep11</title>
<path fill="none" stroke="black" d="M10431.94,-816.33C10452.2,-805.61 10472.51,-794.86 10490.88,-785.14"/>
<polygon fill="black" stroke="black" points="10492.52,-788.23 10499.73,-780.46 10489.25,-782.04 10492.52,-788.23"/>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep11 -->
<g id="node476" class="node">
<title>layer61_expert_proj_dp0_tp0_ep11</title>
<polygon fill="lightblue" stroke="black" points="12766.83,-676.33 12415.83,-676.33 12415.83,-608.33 12766.83,-608.33 12766.83,-676.33"/>
<text text-anchor="middle" x="12591.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="12591.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 59</text>
<text text-anchor="middle" x="12591.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="12591.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep11&#45;&gt;layer61_expert_proj_dp0_tp0_ep11 -->
<g id="edge600" class="edge">
<title>layer61_expert_mlp_dp0_tp0_ep11&#45;&gt;layer61_expert_proj_dp0_tp0_ep11</title>
<path fill="none" stroke="black" d="M10738.16,-737.02C11124.2,-718.76 12012.41,-676.75 12020.33,-676.33 12149.07,-669.57 12294.09,-661.18 12405.77,-654.55"/>
<polygon fill="black" stroke="black" points="12406.01,-658.04 12415.79,-653.95 12405.6,-651.05 12406.01,-658.04"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep11 -->
<g id="node477" class="node">
<title>layer61_expert_allreduce_dp0_tp0_ep11</title>
<ellipse fill="lightyellow" stroke="black" cx="12980.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="12980.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="12980.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 59</text>
<text text-anchor="middle" x="12980.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="12980.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep11&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep11 -->
<g id="edge601" class="edge">
<title>layer61_expert_proj_dp0_tp0_ep11&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep11</title>
<path fill="none" stroke="black" d="M12702.02,-608.3C12744.18,-595.72 12792.84,-581.2 12837.56,-567.85"/>
<polygon fill="black" stroke="black" points="12838.76,-571.15 12847.34,-564.94 12836.75,-564.44 12838.76,-571.15"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep11 -->
<g id="node478" class="node">
<title>layer61_aggregate_dp0_tp0_ep11</title>
<polygon fill="lightpink" stroke="black" points="13464.27,-440.17 12882.13,-440.17 12732.38,-304.17 13314.52,-304.17 13464.27,-440.17"/>
<text text-anchor="middle" x="13098.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="13098.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 59</text>
<text text-anchor="middle" x="13098.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="13098.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep11&#45;&gt;layer61_aggregate_dp0_tp0_ep11 -->
<g id="edge602" class="edge">
<title>layer61_expert_allreduce_dp0_tp0_ep11&#45;&gt;layer61_aggregate_dp0_tp0_ep11</title>
<path fill="none" stroke="black" d="M13017.02,-476.59C13024.1,-467.58 13031.68,-457.93 13039.27,-448.28"/>
<polygon fill="black" stroke="black" points="13042.2,-450.21 13045.63,-440.19 13036.7,-445.88 13042.2,-450.21"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep11&#45;&gt;output_agg -->
<g id="edge926" class="edge">
<title>layer61_aggregate_dp0_tp0_ep11&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M13335.05,-322.59C13380.74,-315 13428.38,-308.31 13473.33,-304.17 14230.55,-234.43 26095.56,-206.2 28166.25,-201.79"/>
<polygon fill="black" stroke="black" points="28166.43,-205.29 28176.43,-201.77 28166.42,-198.29 28166.43,-205.29"/>
</g>
<!-- layer61_dispatch_dp0_tp0_ep12 -->
<g id="node480" class="node">
<title>layer61_dispatch_dp0_tp0_ep12</title>
<polygon fill="lightgreen" stroke="black" points="11620.48,-952.33 10933.02,-952.33 10756.17,-816.33 11443.63,-816.33 11620.48,-952.33"/>
<text text-anchor="middle" x="11188.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="11188.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 60</text>
<text text-anchor="middle" x="11188.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="11188.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp0_ep12&#45;&gt;layer61_dispatch_dp0_tp0_ep12 -->
<g id="edge604" class="edge">
<title>layer61_gate_dp0_tp0_ep12&#45;&gt;layer61_dispatch_dp0_tp0_ep12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11178.04,-988.14C11178.89,-979.74 11179.75,-971.09 11180.6,-962.55"/>
<polygon fill="black" stroke="black" points="11184.09,-962.89 11181.6,-952.59 11177.12,-962.19 11184.09,-962.89"/>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep12 -->
<g id="node481" class="node">
<title>layer61_expert_mlp_dp0_tp0_ep12</title>
<polygon fill="lightblue" stroke="black" points="11620.83,-780.33 11269.83,-780.33 11269.83,-712.33 11620.83,-712.33 11620.83,-780.33"/>
<text text-anchor="middle" x="11445.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="11445.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 60</text>
<text text-anchor="middle" x="11445.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="11445.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp0_ep12&#45;&gt;layer61_expert_mlp_dp0_tp0_ep12 -->
<g id="edge605" class="edge">
<title>layer61_dispatch_dp0_tp0_ep12&#45;&gt;layer61_expert_mlp_dp0_tp0_ep12</title>
<path fill="none" stroke="black" d="M11314.94,-816.33C11335.2,-805.61 11355.51,-794.86 11373.88,-785.14"/>
<polygon fill="black" stroke="black" points="11375.52,-788.23 11382.73,-780.46 11372.25,-782.04 11375.52,-788.23"/>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep12 -->
<g id="node482" class="node">
<title>layer61_expert_proj_dp0_tp0_ep12</title>
<polygon fill="lightblue" stroke="black" points="13400.83,-676.33 13049.83,-676.33 13049.83,-608.33 13400.83,-608.33 13400.83,-676.33"/>
<text text-anchor="middle" x="13225.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="13225.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 60</text>
<text text-anchor="middle" x="13225.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="13225.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep12&#45;&gt;layer61_expert_proj_dp0_tp0_ep12 -->
<g id="edge606" class="edge">
<title>layer61_expert_mlp_dp0_tp0_ep12&#45;&gt;layer61_expert_proj_dp0_tp0_ep12</title>
<path fill="none" stroke="black" d="M11621.01,-737.42C11875.58,-725.67 12361.83,-702.22 12775.33,-676.33 12862.11,-670.9 12958.24,-663.97 13039.29,-657.87"/>
<polygon fill="black" stroke="black" points="13039.9,-661.34 13049.61,-657.09 13039.37,-654.36 13039.9,-661.34"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep12 -->
<g id="node483" class="node">
<title>layer61_expert_allreduce_dp0_tp0_ep12</title>
<ellipse fill="lightyellow" stroke="black" cx="13671.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="13671.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="13671.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 60</text>
<text text-anchor="middle" x="13671.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="13671.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep12&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep12 -->
<g id="edge607" class="edge">
<title>layer61_expert_proj_dp0_tp0_ep12&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep12</title>
<path fill="none" stroke="black" d="M13352.24,-608.3C13403.02,-595.08 13462.03,-579.72 13515.39,-565.84"/>
<polygon fill="black" stroke="black" points="13516.49,-569.17 13525.28,-563.26 13514.72,-562.39 13516.49,-569.17"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep12 -->
<g id="node484" class="node">
<title>layer61_aggregate_dp0_tp0_ep12</title>
<polygon fill="lightpink" stroke="black" points="14214.27,-440.17 13632.13,-440.17 13482.38,-304.17 14064.52,-304.17 14214.27,-440.17"/>
<text text-anchor="middle" x="13848.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="13848.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 60</text>
<text text-anchor="middle" x="13848.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="13848.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep12&#45;&gt;layer61_aggregate_dp0_tp0_ep12 -->
<g id="edge608" class="edge">
<title>layer61_expert_allreduce_dp0_tp0_ep12&#45;&gt;layer61_aggregate_dp0_tp0_ep12</title>
<path fill="none" stroke="black" d="M13725.88,-477C13737.12,-467.46 13749.24,-457.19 13761.31,-446.95"/>
<polygon fill="black" stroke="black" points="13763.87,-449.37 13769.23,-440.23 13759.34,-444.03 13763.87,-449.37"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep12&#45;&gt;output_agg -->
<g id="edge927" class="edge">
<title>layer61_aggregate_dp0_tp0_ep12&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M14085.05,-322.61C14130.75,-315.01 14178.38,-308.31 14223.33,-304.17 14940.86,-237.96 26157.44,-206.94 28166.49,-201.91"/>
<polygon fill="black" stroke="black" points="28166.73,-205.41 28176.72,-201.88 28166.71,-198.41 28166.73,-205.41"/>
</g>
<!-- layer61_dispatch_dp0_tp0_ep13 -->
<g id="node486" class="node">
<title>layer61_dispatch_dp0_tp0_ep13</title>
<polygon fill="lightgreen" stroke="black" points="12503.48,-952.33 11816.02,-952.33 11639.17,-816.33 12326.63,-816.33 12503.48,-952.33"/>
<text text-anchor="middle" x="12071.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="12071.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 61</text>
<text text-anchor="middle" x="12071.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="12071.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp0_ep13&#45;&gt;layer61_dispatch_dp0_tp0_ep13 -->
<g id="edge610" class="edge">
<title>layer61_gate_dp0_tp0_ep13&#45;&gt;layer61_dispatch_dp0_tp0_ep13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12050.76,-988.14C12052.44,-979.74 12054.17,-971.09 12055.88,-962.55"/>
<polygon fill="black" stroke="black" points="12059.35,-963.08 12057.87,-952.59 12052.48,-961.71 12059.35,-963.08"/>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep13 -->
<g id="node487" class="node">
<title>layer61_expert_mlp_dp0_tp0_ep13</title>
<polygon fill="lightblue" stroke="black" points="12503.83,-780.33 12152.83,-780.33 12152.83,-712.33 12503.83,-712.33 12503.83,-780.33"/>
<text text-anchor="middle" x="12328.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="12328.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 61</text>
<text text-anchor="middle" x="12328.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="12328.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp0_ep13&#45;&gt;layer61_expert_mlp_dp0_tp0_ep13 -->
<g id="edge611" class="edge">
<title>layer61_dispatch_dp0_tp0_ep13&#45;&gt;layer61_expert_mlp_dp0_tp0_ep13</title>
<path fill="none" stroke="black" d="M12197.94,-816.33C12218.2,-805.61 12238.51,-794.86 12256.88,-785.14"/>
<polygon fill="black" stroke="black" points="12258.52,-788.23 12265.73,-780.46 12255.25,-782.04 12258.52,-788.23"/>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep13 -->
<g id="node488" class="node">
<title>layer61_expert_proj_dp0_tp0_ep13</title>
<polygon fill="lightblue" stroke="black" points="14020.83,-676.33 13669.83,-676.33 13669.83,-608.33 14020.83,-608.33 14020.83,-676.33"/>
<text text-anchor="middle" x="13845.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="13845.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 61</text>
<text text-anchor="middle" x="13845.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="13845.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep13&#45;&gt;layer61_expert_proj_dp0_tp0_ep13 -->
<g id="edge612" class="edge">
<title>layer61_expert_mlp_dp0_tp0_ep13&#45;&gt;layer61_expert_proj_dp0_tp0_ep13</title>
<path fill="none" stroke="black" d="M12503.9,-734.76C12717.81,-721.74 13090.17,-698.6 13409.33,-676.33 13491.4,-670.61 13582.13,-663.82 13659.47,-657.89"/>
<polygon fill="black" stroke="black" points="13660.11,-661.35 13669.81,-657.09 13659.57,-654.37 13660.11,-661.35"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep13 -->
<g id="node489" class="node">
<title>layer61_expert_allreduce_dp0_tp0_ep13</title>
<ellipse fill="lightyellow" stroke="black" cx="14277.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="14277.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="14277.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 61</text>
<text text-anchor="middle" x="14277.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="14277.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep13&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep13 -->
<g id="edge613" class="edge">
<title>layer61_expert_proj_dp0_tp0_ep13&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep13</title>
<path fill="none" stroke="black" d="M13968.25,-608.3C14016.87,-595.24 14073.27,-580.08 14124.48,-566.32"/>
<polygon fill="black" stroke="black" points="14125.57,-569.65 14134.32,-563.68 14123.75,-562.89 14125.57,-569.65"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep13 -->
<g id="node490" class="node">
<title>layer61_aggregate_dp0_tp0_ep13</title>
<polygon fill="lightpink" stroke="black" points="14964.27,-440.17 14382.13,-440.17 14232.38,-304.17 14814.52,-304.17 14964.27,-440.17"/>
<text text-anchor="middle" x="14598.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="14598.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 61</text>
<text text-anchor="middle" x="14598.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="14598.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep13&#45;&gt;layer61_aggregate_dp0_tp0_ep13 -->
<g id="edge614" class="edge">
<title>layer61_expert_allreduce_dp0_tp0_ep13&#45;&gt;layer61_aggregate_dp0_tp0_ep13</title>
<path fill="none" stroke="black" d="M14370.6,-479.64C14394.2,-468.61 14420.16,-456.47 14445.85,-444.46"/>
<polygon fill="black" stroke="black" points="14447.34,-447.62 14454.92,-440.22 14444.38,-441.28 14447.34,-447.62"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep13&#45;&gt;output_agg -->
<g id="edge928" class="edge">
<title>layer61_aggregate_dp0_tp0_ep13&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M14835.05,-322.62C14880.75,-315.03 14928.38,-308.32 14973.33,-304.17 15651.18,-241.48 26219.78,-207.74 28166.41,-202.04"/>
<polygon fill="black" stroke="black" points="28166.69,-205.54 28176.68,-202.01 28166.67,-198.54 28166.69,-205.54"/>
</g>
<!-- layer61_dispatch_dp0_tp0_ep14 -->
<g id="node492" class="node">
<title>layer61_dispatch_dp0_tp0_ep14</title>
<polygon fill="lightgreen" stroke="black" points="13386.48,-952.33 12699.02,-952.33 12522.17,-816.33 13209.63,-816.33 13386.48,-952.33"/>
<text text-anchor="middle" x="12954.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="12954.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 62</text>
<text text-anchor="middle" x="12954.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="12954.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp0_ep14&#45;&gt;layer61_dispatch_dp0_tp0_ep14 -->
<g id="edge616" class="edge">
<title>layer61_gate_dp0_tp0_ep14&#45;&gt;layer61_dispatch_dp0_tp0_ep14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12918.64,-988.14C12921.59,-979.65 12924.63,-970.9 12927.62,-962.27"/>
<polygon fill="black" stroke="black" points="12931.01,-963.19 12930.98,-952.59 12924.4,-960.89 12931.01,-963.19"/>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep14 -->
<g id="node493" class="node">
<title>layer61_expert_mlp_dp0_tp0_ep14</title>
<polygon fill="lightblue" stroke="black" points="13386.83,-780.33 13035.83,-780.33 13035.83,-712.33 13386.83,-712.33 13386.83,-780.33"/>
<text text-anchor="middle" x="13211.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="13211.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 62</text>
<text text-anchor="middle" x="13211.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="13211.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp0_ep14&#45;&gt;layer61_expert_mlp_dp0_tp0_ep14 -->
<g id="edge617" class="edge">
<title>layer61_dispatch_dp0_tp0_ep14&#45;&gt;layer61_expert_mlp_dp0_tp0_ep14</title>
<path fill="none" stroke="black" d="M13080.94,-816.33C13101.2,-805.61 13121.51,-794.86 13139.88,-785.14"/>
<polygon fill="black" stroke="black" points="13141.52,-788.23 13148.73,-780.46 13138.25,-782.04 13141.52,-788.23"/>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep14 -->
<g id="node494" class="node">
<title>layer61_expert_proj_dp0_tp0_ep14</title>
<polygon fill="lightblue" stroke="black" points="15046.83,-676.33 14695.83,-676.33 14695.83,-608.33 15046.83,-608.33 15046.83,-676.33"/>
<text text-anchor="middle" x="14871.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="14871.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 62</text>
<text text-anchor="middle" x="14871.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="14871.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep14&#45;&gt;layer61_expert_proj_dp0_tp0_ep14 -->
<g id="edge618" class="edge">
<title>layer61_expert_mlp_dp0_tp0_ep14&#45;&gt;layer61_expert_proj_dp0_tp0_ep14</title>
<path fill="none" stroke="black" d="M13387.01,-734.54C13702.56,-715.15 14362.41,-674.6 14685.31,-654.76"/>
<polygon fill="black" stroke="black" points="14685.94,-658.23 14695.71,-654.12 14685.51,-651.24 14685.94,-658.23"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep14 -->
<g id="node495" class="node">
<title>layer61_expert_allreduce_dp0_tp0_ep14</title>
<ellipse fill="lightyellow" stroke="black" cx="15069.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="15069.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="15069.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 62</text>
<text text-anchor="middle" x="15069.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="15069.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep14&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep14 -->
<g id="edge619" class="edge">
<title>layer61_expert_proj_dp0_tp0_ep14&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep14</title>
<path fill="none" stroke="black" d="M14927.8,-608.22C14945.34,-597.94 14965.09,-586.36 14984.14,-575.19"/>
<polygon fill="black" stroke="black" points="14985.97,-578.17 14992.83,-570.1 14982.43,-572.14 14985.97,-578.17"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep14 -->
<g id="node496" class="node">
<title>layer61_aggregate_dp0_tp0_ep14</title>
<polygon fill="lightpink" stroke="black" points="15714.27,-440.17 15132.13,-440.17 14982.38,-304.17 15564.52,-304.17 15714.27,-440.17"/>
<text text-anchor="middle" x="15348.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="15348.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 62</text>
<text text-anchor="middle" x="15348.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="15348.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep14&#45;&gt;layer61_aggregate_dp0_tp0_ep14 -->
<g id="edge620" class="edge">
<title>layer61_expert_allreduce_dp0_tp0_ep14&#45;&gt;layer61_aggregate_dp0_tp0_ep14</title>
<path fill="none" stroke="black" d="M15151.9,-478.83C15171.67,-468.19 15193.29,-456.57 15214.72,-445.04"/>
<polygon fill="black" stroke="black" points="15216.41,-448.1 15223.56,-440.28 15213.09,-441.94 15216.41,-448.1"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep14&#45;&gt;output_agg -->
<g id="edge929" class="edge">
<title>layer61_aggregate_dp0_tp0_ep14&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M15585.05,-322.64C15630.75,-315.04 15678.38,-308.33 15723.33,-304.17 16361.58,-245 26284.88,-208.57 28166.61,-202.18"/>
<polygon fill="black" stroke="black" points="28166.9,-205.68 28176.89,-202.14 28166.87,-198.68 28166.9,-205.68"/>
</g>
<!-- layer61_dispatch_dp0_tp0_ep15 -->
<g id="node498" class="node">
<title>layer61_dispatch_dp0_tp0_ep15</title>
<polygon fill="lightgreen" stroke="black" points="14269.48,-952.33 13582.02,-952.33 13405.17,-816.33 14092.63,-816.33 14269.48,-952.33"/>
<text text-anchor="middle" x="13837.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="13837.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 63</text>
<text text-anchor="middle" x="13837.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="13837.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp0_ep15&#45;&gt;layer61_dispatch_dp0_tp0_ep15 -->
<g id="edge622" class="edge">
<title>layer61_gate_dp0_tp0_ep15&#45;&gt;layer61_dispatch_dp0_tp0_ep15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13799.23,-988.14C13802.41,-979.56 13805.68,-970.72 13808.92,-961.99"/>
<polygon fill="black" stroke="black" points="13812.21,-963.18 13812.4,-952.59 13805.64,-960.75 13812.21,-963.18"/>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep15 -->
<g id="node499" class="node">
<title>layer61_expert_mlp_dp0_tp0_ep15</title>
<polygon fill="lightblue" stroke="black" points="14269.83,-780.33 13918.83,-780.33 13918.83,-712.33 14269.83,-712.33 14269.83,-780.33"/>
<text text-anchor="middle" x="14094.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="14094.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 63</text>
<text text-anchor="middle" x="14094.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="14094.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp0_ep15&#45;&gt;layer61_expert_mlp_dp0_tp0_ep15 -->
<g id="edge623" class="edge">
<title>layer61_dispatch_dp0_tp0_ep15&#45;&gt;layer61_expert_mlp_dp0_tp0_ep15</title>
<path fill="none" stroke="black" d="M13963.94,-816.33C13984.2,-805.61 14004.51,-794.86 14022.88,-785.14"/>
<polygon fill="black" stroke="black" points="14024.52,-788.23 14031.73,-780.46 14021.25,-782.04 14024.52,-788.23"/>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep15 -->
<g id="node500" class="node">
<title>layer61_expert_proj_dp0_tp0_ep15</title>
<polygon fill="lightblue" stroke="black" points="15560.83,-676.33 15209.83,-676.33 15209.83,-608.33 15560.83,-608.33 15560.83,-676.33"/>
<text text-anchor="middle" x="15385.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="15385.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 63</text>
<text text-anchor="middle" x="15385.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="15385.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp0_ep15&#45;&gt;layer61_expert_proj_dp0_tp0_ep15 -->
<g id="edge624" class="edge">
<title>layer61_expert_mlp_dp0_tp0_ep15&#45;&gt;layer61_expert_proj_dp0_tp0_ep15</title>
<path fill="none" stroke="black" d="M14270.24,-734.18C14463.03,-721.62 14781.38,-699.86 15055.33,-676.33 15102.05,-672.32 15152.46,-667.52 15199.46,-662.84"/>
<polygon fill="black" stroke="black" points="15199.84,-666.32 15209.44,-661.84 15199.14,-659.35 15199.84,-666.32"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep15 -->
<g id="node501" class="node">
<title>layer61_expert_allreduce_dp0_tp0_ep15</title>
<ellipse fill="lightyellow" stroke="black" cx="15841.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="15841.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="15841.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 63</text>
<text text-anchor="middle" x="15841.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="15841.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp0_ep15&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep15 -->
<g id="edge625" class="edge">
<title>layer61_expert_proj_dp0_tp0_ep15&#45;&gt;layer61_expert_allreduce_dp0_tp0_ep15</title>
<path fill="none" stroke="black" d="M15515.08,-608.3C15567.49,-594.96 15628.45,-579.44 15683.4,-565.45"/>
<polygon fill="black" stroke="black" points="15684.41,-568.81 15693.23,-562.95 15682.68,-562.02 15684.41,-568.81"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep15 -->
<g id="node502" class="node">
<title>layer61_aggregate_dp0_tp0_ep15</title>
<polygon fill="lightpink" stroke="black" points="16464.27,-440.17 15882.13,-440.17 15732.38,-304.17 16314.52,-304.17 16464.27,-440.17"/>
<text text-anchor="middle" x="16098.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="16098.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 63</text>
<text text-anchor="middle" x="16098.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="16098.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp0_ep15&#45;&gt;layer61_aggregate_dp0_tp0_ep15 -->
<g id="edge626" class="edge">
<title>layer61_expert_allreduce_dp0_tp0_ep15&#45;&gt;layer61_aggregate_dp0_tp0_ep15</title>
<path fill="none" stroke="black" d="M15918.09,-478.42C15935.92,-468.01 15955.34,-456.67 15974.62,-445.41"/>
<polygon fill="black" stroke="black" points="15976.59,-448.31 15983.46,-440.25 15973.06,-442.27 15976.59,-448.31"/>
</g>
<!-- layer61_aggregate_dp0_tp0_ep15&#45;&gt;output_agg -->
<g id="edge930" class="edge">
<title>layer61_aggregate_dp0_tp0_ep15&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M16335.06,-322.66C16380.75,-315.06 16428.38,-308.34 16473.33,-304.17 17072.04,-248.51 26352.2,-209.46 28166.91,-202.34"/>
<polygon fill="black" stroke="black" points="28167.17,-205.84 28177.15,-202.3 28167.14,-198.84 28167.17,-205.84"/>
</g>
<!-- layer61_dispatch_dp0_tp1_ep0 -->
<g id="node504" class="node">
<title>layer61_dispatch_dp0_tp1_ep0</title>
<polygon fill="lightgreen" stroke="black" points="15152.48,-952.33 14465.02,-952.33 14288.17,-816.33 14975.63,-816.33 15152.48,-952.33"/>
<text text-anchor="middle" x="14720.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="14720.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 112</text>
<text text-anchor="middle" x="14720.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="14720.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp1_ep0&#45;&gt;layer61_dispatch_dp0_tp1_ep0 -->
<g id="edge628" class="edge">
<title>layer61_gate_dp0_tp1_ep0&#45;&gt;layer61_dispatch_dp0_tp1_ep0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14760.85,-988.14C14757.46,-979.56 14753.98,-970.72 14750.54,-961.99"/>
<polygon fill="black" stroke="black" points="14753.76,-960.61 14746.83,-952.59 14747.24,-963.18 14753.76,-960.61"/>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep0 -->
<g id="node505" class="node">
<title>layer61_expert_mlp_dp0_tp1_ep0</title>
<polygon fill="lightblue" stroke="black" points="15152.83,-780.33 14801.83,-780.33 14801.83,-712.33 15152.83,-712.33 15152.83,-780.33"/>
<text text-anchor="middle" x="14977.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="14977.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 112</text>
<text text-anchor="middle" x="14977.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="14977.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp1_ep0&#45;&gt;layer61_expert_mlp_dp0_tp1_ep0 -->
<g id="edge629" class="edge">
<title>layer61_dispatch_dp0_tp1_ep0&#45;&gt;layer61_expert_mlp_dp0_tp1_ep0</title>
<path fill="none" stroke="black" d="M14846.94,-816.33C14867.2,-805.61 14887.51,-794.86 14905.88,-785.14"/>
<polygon fill="black" stroke="black" points="14907.52,-788.23 14914.73,-780.46 14904.25,-782.04 14907.52,-788.23"/>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep0 -->
<g id="node506" class="node">
<title>layer61_expert_proj_dp0_tp1_ep0</title>
<polygon fill="lightblue" stroke="black" points="16114.83,-676.33 15763.83,-676.33 15763.83,-608.33 16114.83,-608.33 16114.83,-676.33"/>
<text text-anchor="middle" x="15939.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="15939.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 112</text>
<text text-anchor="middle" x="15939.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="15939.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep0&#45;&gt;layer61_expert_proj_dp0_tp1_ep0 -->
<g id="edge630" class="edge">
<title>layer61_expert_mlp_dp0_tp1_ep0&#45;&gt;layer61_expert_proj_dp0_tp1_ep0</title>
<path fill="none" stroke="black" d="M15152.93,-726.71C15323.09,-708.67 15580.2,-681.41 15753.68,-663.02"/>
<polygon fill="black" stroke="black" points="15754.11,-666.49 15763.68,-661.96 15753.37,-659.53 15754.11,-666.49"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep0 -->
<g id="node507" class="node">
<title>layer61_expert_allreduce_dp0_tp1_ep0</title>
<ellipse fill="lightyellow" stroke="black" cx="16602.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="16602.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="16602.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 112</text>
<text text-anchor="middle" x="16602.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="16602.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep0&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep0 -->
<g id="edge631" class="edge">
<title>layer61_expert_proj_dp0_tp1_ep0&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep0</title>
<path fill="none" stroke="black" d="M16115.26,-610.53C16206.22,-594.6 16317.39,-575.14 16410.55,-558.83"/>
<polygon fill="black" stroke="black" points="16411.41,-562.23 16420.66,-557.06 16410.2,-555.34 16411.41,-562.23"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep0 -->
<g id="node508" class="node">
<title>layer61_aggregate_dp0_tp1_ep0</title>
<polygon fill="lightpink" stroke="black" points="17214.27,-440.17 16632.13,-440.17 16482.38,-304.17 17064.52,-304.17 17214.27,-440.17"/>
<text text-anchor="middle" x="16848.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="16848.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 112</text>
<text text-anchor="middle" x="16848.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="16848.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep0&#45;&gt;layer61_aggregate_dp0_tp1_ep0 -->
<g id="edge632" class="edge">
<title>layer61_expert_allreduce_dp0_tp1_ep0&#45;&gt;layer61_aggregate_dp0_tp1_ep0</title>
<path fill="none" stroke="black" d="M16676.13,-478.22C16692.92,-467.98 16711.17,-456.85 16729.3,-445.79"/>
<polygon fill="black" stroke="black" points="16731.47,-448.56 16738.18,-440.36 16727.82,-442.59 16731.47,-448.56"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep0&#45;&gt;output_agg -->
<g id="edge931" class="edge">
<title>layer61_aggregate_dp0_tp1_ep0&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M17085.06,-322.68C17130.75,-315.08 17178.38,-308.36 17223.33,-304.17 18337.57,-200.27 26472.91,-199.85 28165.41,-200.9"/>
<polygon fill="black" stroke="black" points="28165.58,-204.4 28175.58,-200.91 28165.58,-197.4 28165.58,-204.4"/>
</g>
<!-- layer61_dispatch_dp0_tp1_ep1 -->
<g id="node510" class="node">
<title>layer61_dispatch_dp0_tp1_ep1</title>
<polygon fill="lightgreen" stroke="black" points="16035.48,-952.33 15348.02,-952.33 15171.17,-816.33 15858.63,-816.33 16035.48,-952.33"/>
<text text-anchor="middle" x="15603.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="15603.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 113</text>
<text text-anchor="middle" x="15603.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="15603.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp1_ep1&#45;&gt;layer61_dispatch_dp0_tp1_ep1 -->
<g id="edge634" class="edge">
<title>layer61_gate_dp0_tp1_ep1&#45;&gt;layer61_dispatch_dp0_tp1_ep1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15623.28,-988.14C15621.65,-979.74 15619.97,-971.09 15618.32,-962.55"/>
<polygon fill="black" stroke="black" points="15621.72,-961.74 15616.38,-952.59 15614.85,-963.07 15621.72,-961.74"/>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep1 -->
<g id="node511" class="node">
<title>layer61_expert_mlp_dp0_tp1_ep1</title>
<polygon fill="lightblue" stroke="black" points="16035.83,-780.33 15684.83,-780.33 15684.83,-712.33 16035.83,-712.33 16035.83,-780.33"/>
<text text-anchor="middle" x="15860.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="15860.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 113</text>
<text text-anchor="middle" x="15860.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="15860.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp1_ep1&#45;&gt;layer61_expert_mlp_dp0_tp1_ep1 -->
<g id="edge635" class="edge">
<title>layer61_dispatch_dp0_tp1_ep1&#45;&gt;layer61_expert_mlp_dp0_tp1_ep1</title>
<path fill="none" stroke="black" d="M15729.94,-816.33C15750.2,-805.61 15770.51,-794.86 15788.88,-785.14"/>
<polygon fill="black" stroke="black" points="15790.52,-788.23 15797.73,-780.46 15787.25,-782.04 15790.52,-788.23"/>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep1 -->
<g id="node512" class="node">
<title>layer61_expert_proj_dp0_tp1_ep1</title>
<polygon fill="lightblue" stroke="black" points="17253.83,-676.33 16902.83,-676.33 16902.83,-608.33 17253.83,-608.33 17253.83,-676.33"/>
<text text-anchor="middle" x="17078.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="17078.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 113</text>
<text text-anchor="middle" x="17078.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="17078.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep1&#45;&gt;layer61_expert_proj_dp0_tp1_ep1 -->
<g id="edge636" class="edge">
<title>layer61_expert_mlp_dp0_tp1_ep1&#45;&gt;layer61_expert_proj_dp0_tp1_ep1</title>
<path fill="none" stroke="black" d="M16036.13,-730.61C16263.98,-711.53 16659.56,-678.4 16892.3,-658.91"/>
<polygon fill="black" stroke="black" points="16892.9,-662.37 16902.57,-658.05 16892.32,-655.4 16892.9,-662.37"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep1 -->
<g id="node513" class="node">
<title>layer61_expert_allreduce_dp0_tp1_ep1</title>
<ellipse fill="lightyellow" stroke="black" cx="17480.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="17480.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="17480.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 113</text>
<text text-anchor="middle" x="17480.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="17480.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep1&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep1 -->
<g id="edge637" class="edge">
<title>layer61_expert_proj_dp0_tp1_ep1&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep1</title>
<path fill="none" stroke="black" d="M17192.72,-608.3C17236.81,-595.57 17287.78,-580.85 17334.46,-567.37"/>
<polygon fill="black" stroke="black" points="17335.71,-570.65 17344.35,-564.52 17333.77,-563.93 17335.71,-570.65"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep1 -->
<g id="node514" class="node">
<title>layer61_aggregate_dp0_tp1_ep1</title>
<polygon fill="lightpink" stroke="black" points="17964.27,-440.17 17382.13,-440.17 17232.38,-304.17 17814.52,-304.17 17964.27,-440.17"/>
<text text-anchor="middle" x="17598.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="17598.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 113</text>
<text text-anchor="middle" x="17598.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="17598.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep1&#45;&gt;layer61_aggregate_dp0_tp1_ep1 -->
<g id="edge638" class="edge">
<title>layer61_expert_allreduce_dp0_tp1_ep1&#45;&gt;layer61_aggregate_dp0_tp1_ep1</title>
<path fill="none" stroke="black" d="M17517.02,-476.59C17524.1,-467.58 17531.68,-457.93 17539.27,-448.28"/>
<polygon fill="black" stroke="black" points="17542.2,-450.21 17545.63,-440.19 17536.7,-445.88 17542.2,-450.21"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep1&#45;&gt;output_agg -->
<g id="edge932" class="edge">
<title>layer61_aggregate_dp0_tp1_ep1&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M17835.06,-322.7C17880.75,-315.1 17928.39,-308.37 17973.33,-304.17 19008.96,-207.26 26543.46,-201.28 28165.99,-201.12"/>
<polygon fill="black" stroke="black" points="28166.04,-204.62 28176.04,-201.12 28166.04,-197.62 28166.04,-204.62"/>
</g>
<!-- layer61_dispatch_dp0_tp1_ep2 -->
<g id="node516" class="node">
<title>layer61_dispatch_dp0_tp1_ep2</title>
<polygon fill="lightgreen" stroke="black" points="16918.48,-952.33 16231.02,-952.33 16054.17,-816.33 16741.63,-816.33 16918.48,-952.33"/>
<text text-anchor="middle" x="16486.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="16486.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 114</text>
<text text-anchor="middle" x="16486.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="16486.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp1_ep2&#45;&gt;layer61_dispatch_dp0_tp1_ep2 -->
<g id="edge640" class="edge">
<title>layer61_gate_dp0_tp1_ep2&#45;&gt;layer61_dispatch_dp0_tp1_ep2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16506.28,-988.14C16504.65,-979.74 16502.97,-971.09 16501.32,-962.55"/>
<polygon fill="black" stroke="black" points="16504.72,-961.74 16499.38,-952.59 16497.85,-963.07 16504.72,-961.74"/>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep2 -->
<g id="node517" class="node">
<title>layer61_expert_mlp_dp0_tp1_ep2</title>
<polygon fill="lightblue" stroke="black" points="16918.83,-780.33 16567.83,-780.33 16567.83,-712.33 16918.83,-712.33 16918.83,-780.33"/>
<text text-anchor="middle" x="16743.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="16743.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 114</text>
<text text-anchor="middle" x="16743.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="16743.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp1_ep2&#45;&gt;layer61_expert_mlp_dp0_tp1_ep2 -->
<g id="edge641" class="edge">
<title>layer61_dispatch_dp0_tp1_ep2&#45;&gt;layer61_expert_mlp_dp0_tp1_ep2</title>
<path fill="none" stroke="black" d="M16612.94,-816.33C16633.2,-805.61 16653.51,-794.86 16671.88,-785.14"/>
<polygon fill="black" stroke="black" points="16673.52,-788.23 16680.73,-780.46 16670.25,-782.04 16673.52,-788.23"/>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep2 -->
<g id="node518" class="node">
<title>layer61_expert_proj_dp0_tp1_ep2</title>
<polygon fill="lightblue" stroke="black" points="17695.83,-676.33 17344.83,-676.33 17344.83,-608.33 17695.83,-608.33 17695.83,-676.33"/>
<text text-anchor="middle" x="17520.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="17520.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 114</text>
<text text-anchor="middle" x="17520.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="17520.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep2&#45;&gt;layer61_expert_proj_dp0_tp1_ep2 -->
<g id="edge642" class="edge">
<title>layer61_expert_mlp_dp0_tp1_ep2&#45;&gt;layer61_expert_proj_dp0_tp1_ep2</title>
<path fill="none" stroke="black" d="M16919.15,-722.25C17042.94,-706 17208.36,-684.29 17334.35,-667.75"/>
<polygon fill="black" stroke="black" points="17335.04,-671.19 17344.49,-666.42 17334.12,-664.25 17335.04,-671.19"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep2 -->
<g id="node519" class="node">
<title>layer61_expert_allreduce_dp0_tp1_ep2</title>
<ellipse fill="lightyellow" stroke="black" cx="18171.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="18171.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="18171.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 114</text>
<text text-anchor="middle" x="18171.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="18171.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep2&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep2 -->
<g id="edge643" class="edge">
<title>layer61_expert_proj_dp0_tp1_ep2&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep2</title>
<path fill="none" stroke="black" d="M17696.07,-610C17784.18,-594.28 17891.01,-575.23 17981.05,-559.18"/>
<polygon fill="black" stroke="black" points="17981.88,-562.59 17991.11,-557.39 17980.65,-555.7 17981.88,-562.59"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep2 -->
<g id="node520" class="node">
<title>layer61_aggregate_dp0_tp1_ep2</title>
<polygon fill="lightpink" stroke="black" points="18714.27,-440.17 18132.13,-440.17 17982.38,-304.17 18564.52,-304.17 18714.27,-440.17"/>
<text text-anchor="middle" x="18348.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="18348.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 114</text>
<text text-anchor="middle" x="18348.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="18348.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep2&#45;&gt;layer61_aggregate_dp0_tp1_ep2 -->
<g id="edge644" class="edge">
<title>layer61_expert_allreduce_dp0_tp1_ep2&#45;&gt;layer61_aggregate_dp0_tp1_ep2</title>
<path fill="none" stroke="black" d="M18225.88,-477C18237.12,-467.46 18249.24,-457.19 18261.31,-446.95"/>
<polygon fill="black" stroke="black" points="18263.87,-449.37 18269.23,-440.23 18259.34,-444.03 18263.87,-449.37"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep2&#45;&gt;output_agg -->
<g id="edge933" class="edge">
<title>layer61_aggregate_dp0_tp1_ep2&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M18585.06,-322.73C18630.76,-315.12 18678.39,-308.39 18723.33,-304.17 19680.37,-214.25 26614.73,-202.81 28166.02,-201.37"/>
<polygon fill="black" stroke="black" points="28166.2,-204.87 28176.19,-201.36 28166.19,-197.87 28166.2,-204.87"/>
</g>
<!-- layer61_dispatch_dp0_tp1_ep3 -->
<g id="node522" class="node">
<title>layer61_dispatch_dp0_tp1_ep3</title>
<polygon fill="lightgreen" stroke="black" points="17801.48,-952.33 17114.02,-952.33 16937.17,-816.33 17624.63,-816.33 17801.48,-952.33"/>
<text text-anchor="middle" x="17369.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="17369.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 115</text>
<text text-anchor="middle" x="17369.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="17369.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp1_ep3&#45;&gt;layer61_dispatch_dp0_tp1_ep3 -->
<g id="edge646" class="edge">
<title>layer61_gate_dp0_tp1_ep3&#45;&gt;layer61_dispatch_dp0_tp1_ep3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17379.61,-988.14C17378.77,-979.74 17377.9,-971.09 17377.05,-962.55"/>
<polygon fill="black" stroke="black" points="17380.53,-962.19 17376.05,-952.59 17373.56,-962.89 17380.53,-962.19"/>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep3 -->
<g id="node523" class="node">
<title>layer61_expert_mlp_dp0_tp1_ep3</title>
<polygon fill="lightblue" stroke="black" points="17801.83,-780.33 17450.83,-780.33 17450.83,-712.33 17801.83,-712.33 17801.83,-780.33"/>
<text text-anchor="middle" x="17626.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="17626.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 115</text>
<text text-anchor="middle" x="17626.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="17626.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp1_ep3&#45;&gt;layer61_expert_mlp_dp0_tp1_ep3 -->
<g id="edge647" class="edge">
<title>layer61_dispatch_dp0_tp1_ep3&#45;&gt;layer61_expert_mlp_dp0_tp1_ep3</title>
<path fill="none" stroke="black" d="M17495.94,-816.33C17516.2,-805.61 17536.51,-794.86 17554.88,-785.14"/>
<polygon fill="black" stroke="black" points="17556.52,-788.23 17563.73,-780.46 17553.25,-782.04 17556.52,-788.23"/>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep3 -->
<g id="node524" class="node">
<title>layer61_expert_proj_dp0_tp1_ep3</title>
<polygon fill="lightblue" stroke="black" points="18805.83,-676.33 18454.83,-676.33 18454.83,-608.33 18805.83,-608.33 18805.83,-676.33"/>
<text text-anchor="middle" x="18630.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="18630.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 115</text>
<text text-anchor="middle" x="18630.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="18630.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep3&#45;&gt;layer61_expert_proj_dp0_tp1_ep3 -->
<g id="edge648" class="edge">
<title>layer61_expert_mlp_dp0_tp1_ep3&#45;&gt;layer61_expert_proj_dp0_tp1_ep3</title>
<path fill="none" stroke="black" d="M17802.07,-727.48C17982.19,-709.18 18261.17,-680.84 18444.78,-662.18"/>
<polygon fill="black" stroke="black" points="18445.22,-665.66 18454.81,-661.16 18444.51,-658.69 18445.22,-665.66"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep3 -->
<g id="node525" class="node">
<title>layer61_expert_allreduce_dp0_tp1_ep3</title>
<ellipse fill="lightyellow" stroke="black" cx="18980.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="18980.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="18980.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 115</text>
<text text-anchor="middle" x="18980.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="18980.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep3&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep3 -->
<g id="edge649" class="edge">
<title>layer61_expert_proj_dp0_tp1_ep3&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep3</title>
<path fill="none" stroke="black" d="M18730.15,-608.22C18766.66,-596.12 18808.56,-582.22 18847.5,-569.31"/>
<polygon fill="black" stroke="black" points="18848.94,-572.52 18857.33,-566.05 18846.73,-565.87 18848.94,-572.52"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep3 -->
<g id="node526" class="node">
<title>layer61_aggregate_dp0_tp1_ep3</title>
<polygon fill="lightpink" stroke="black" points="19464.27,-440.17 18882.13,-440.17 18732.38,-304.17 19314.52,-304.17 19464.27,-440.17"/>
<text text-anchor="middle" x="19098.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="19098.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 115</text>
<text text-anchor="middle" x="19098.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="19098.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep3&#45;&gt;layer61_aggregate_dp0_tp1_ep3 -->
<g id="edge650" class="edge">
<title>layer61_expert_allreduce_dp0_tp1_ep3&#45;&gt;layer61_aggregate_dp0_tp1_ep3</title>
<path fill="none" stroke="black" d="M19017.02,-476.59C19024.1,-467.58 19031.68,-457.93 19039.27,-448.28"/>
<polygon fill="black" stroke="black" points="19042.2,-450.21 19045.63,-440.19 19036.7,-445.88 19042.2,-450.21"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep3&#45;&gt;output_agg -->
<g id="edge934" class="edge">
<title>layer61_aggregate_dp0_tp1_ep3&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M19335.07,-322.76C19380.76,-315.15 19428.39,-308.41 19473.33,-304.17 20352.01,-221.22 26689.51,-204.46 28166.31,-201.66"/>
<polygon fill="black" stroke="black" points="28166.53,-205.16 28176.53,-201.64 28166.52,-198.16 28166.53,-205.16"/>
</g>
<!-- layer61_dispatch_dp0_tp1_ep4 -->
<g id="node528" class="node">
<title>layer61_dispatch_dp0_tp1_ep4</title>
<polygon fill="lightgreen" stroke="black" points="18684.48,-952.33 17997.02,-952.33 17820.17,-816.33 18507.63,-816.33 18684.48,-952.33"/>
<text text-anchor="middle" x="18252.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="18252.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 116</text>
<text text-anchor="middle" x="18252.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="18252.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp1_ep4&#45;&gt;layer61_dispatch_dp0_tp1_ep4 -->
<g id="edge652" class="edge">
<title>layer61_gate_dp0_tp1_ep4&#45;&gt;layer61_dispatch_dp0_tp1_ep4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18232.37,-988.14C18234,-979.74 18235.68,-971.09 18237.34,-962.55"/>
<polygon fill="black" stroke="black" points="18240.8,-963.07 18239.27,-952.59 18233.93,-961.74 18240.8,-963.07"/>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep4 -->
<g id="node529" class="node">
<title>layer61_expert_mlp_dp0_tp1_ep4</title>
<polygon fill="lightblue" stroke="black" points="18684.83,-780.33 18333.83,-780.33 18333.83,-712.33 18684.83,-712.33 18684.83,-780.33"/>
<text text-anchor="middle" x="18509.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="18509.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 116</text>
<text text-anchor="middle" x="18509.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="18509.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp1_ep4&#45;&gt;layer61_expert_mlp_dp0_tp1_ep4 -->
<g id="edge653" class="edge">
<title>layer61_dispatch_dp0_tp1_ep4&#45;&gt;layer61_expert_mlp_dp0_tp1_ep4</title>
<path fill="none" stroke="black" d="M18378.94,-816.33C18399.2,-805.61 18419.51,-794.86 18437.88,-785.14"/>
<polygon fill="black" stroke="black" points="18439.52,-788.23 18446.73,-780.46 18436.25,-782.04 18439.52,-788.23"/>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep4 -->
<g id="node530" class="node">
<title>layer61_expert_proj_dp0_tp1_ep4</title>
<polygon fill="lightblue" stroke="black" points="19421.83,-676.33 19070.83,-676.33 19070.83,-608.33 19421.83,-608.33 19421.83,-676.33"/>
<text text-anchor="middle" x="19246.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="19246.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 116</text>
<text text-anchor="middle" x="19246.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="19246.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep4&#45;&gt;layer61_expert_proj_dp0_tp1_ep4 -->
<g id="edge654" class="edge">
<title>layer61_expert_mlp_dp0_tp1_ep4&#45;&gt;layer61_expert_proj_dp0_tp1_ep4</title>
<path fill="none" stroke="black" d="M18684.92,-721.03C18798.27,-705.34 18945.54,-684.96 19060.81,-669.01"/>
<polygon fill="black" stroke="black" points="19061.38,-672.46 19070.8,-667.63 19060.42,-665.53 19061.38,-672.46"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep4 -->
<g id="node531" class="node">
<title>layer61_expert_allreduce_dp0_tp1_ep4</title>
<ellipse fill="lightyellow" stroke="black" cx="19671.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="19671.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="19671.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 116</text>
<text text-anchor="middle" x="19671.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="19671.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep4&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep4 -->
<g id="edge655" class="edge">
<title>layer61_expert_proj_dp0_tp1_ep4&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep4</title>
<path fill="none" stroke="black" d="M19367.26,-608.3C19414.76,-595.33 19469.82,-580.29 19519.92,-566.61"/>
<polygon fill="black" stroke="black" points="19521.14,-569.9 19529.87,-563.89 19519.3,-563.15 19521.14,-569.9"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep4 -->
<g id="node532" class="node">
<title>layer61_aggregate_dp0_tp1_ep4</title>
<polygon fill="lightpink" stroke="black" points="20214.27,-440.17 19632.13,-440.17 19482.38,-304.17 20064.52,-304.17 20214.27,-440.17"/>
<text text-anchor="middle" x="19848.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="19848.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 116</text>
<text text-anchor="middle" x="19848.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="19848.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep4&#45;&gt;layer61_aggregate_dp0_tp1_ep4 -->
<g id="edge656" class="edge">
<title>layer61_expert_allreduce_dp0_tp1_ep4&#45;&gt;layer61_aggregate_dp0_tp1_ep4</title>
<path fill="none" stroke="black" d="M19725.88,-477C19737.12,-467.46 19749.24,-457.19 19761.31,-446.95"/>
<polygon fill="black" stroke="black" points="19763.87,-449.37 19769.23,-440.23 19759.34,-444.03 19763.87,-449.37"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep4&#45;&gt;output_agg -->
<g id="edge935" class="edge">
<title>layer61_aggregate_dp0_tp1_ep4&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M20085.07,-322.8C20130.76,-315.19 20178.39,-308.43 20223.33,-304.17 21023.88,-228.17 26767.98,-206.25 28166.81,-202.01"/>
<polygon fill="black" stroke="black" points="28167.01,-205.51 28177,-201.98 28166.99,-198.51 28167.01,-205.51"/>
</g>
<!-- layer61_dispatch_dp0_tp1_ep5 -->
<g id="node534" class="node">
<title>layer61_dispatch_dp0_tp1_ep5</title>
<polygon fill="lightgreen" stroke="black" points="19567.48,-952.33 18880.02,-952.33 18703.17,-816.33 19390.63,-816.33 19567.48,-952.33"/>
<text text-anchor="middle" x="19135.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="19135.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 117</text>
<text text-anchor="middle" x="19135.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="19135.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp1_ep5&#45;&gt;layer61_dispatch_dp0_tp1_ep5 -->
<g id="edge658" class="edge">
<title>layer61_gate_dp0_tp1_ep5&#45;&gt;layer61_dispatch_dp0_tp1_ep5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19105.09,-988.14C19107.59,-979.65 19110.16,-970.9 19112.7,-962.27"/>
<polygon fill="black" stroke="black" points="19116.08,-963.17 19115.54,-952.59 19109.37,-961.2 19116.08,-963.17"/>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep5 -->
<g id="node535" class="node">
<title>layer61_expert_mlp_dp0_tp1_ep5</title>
<polygon fill="lightblue" stroke="black" points="19567.83,-780.33 19216.83,-780.33 19216.83,-712.33 19567.83,-712.33 19567.83,-780.33"/>
<text text-anchor="middle" x="19392.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="19392.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 117</text>
<text text-anchor="middle" x="19392.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="19392.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp1_ep5&#45;&gt;layer61_expert_mlp_dp0_tp1_ep5 -->
<g id="edge659" class="edge">
<title>layer61_dispatch_dp0_tp1_ep5&#45;&gt;layer61_expert_mlp_dp0_tp1_ep5</title>
<path fill="none" stroke="black" d="M19261.94,-816.33C19282.2,-805.61 19302.51,-794.86 19320.88,-785.14"/>
<polygon fill="black" stroke="black" points="19322.52,-788.23 19329.73,-780.46 19319.25,-782.04 19322.52,-788.23"/>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep5 -->
<g id="node536" class="node">
<title>layer61_expert_proj_dp0_tp1_ep5</title>
<polygon fill="lightblue" stroke="black" points="20222.83,-676.33 19871.83,-676.33 19871.83,-608.33 20222.83,-608.33 20222.83,-676.33"/>
<text text-anchor="middle" x="20047.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="20047.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 117</text>
<text text-anchor="middle" x="20047.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="20047.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep5&#45;&gt;layer61_expert_proj_dp0_tp1_ep5 -->
<g id="edge660" class="edge">
<title>layer61_expert_mlp_dp0_tp1_ep5&#45;&gt;layer61_expert_proj_dp0_tp1_ep5</title>
<path fill="none" stroke="black" d="M19567.85,-718C19658.62,-703.86 19769.4,-686.61 19861.6,-672.26"/>
<polygon fill="black" stroke="black" points="19862.26,-675.7 19871.6,-670.7 19861.18,-668.78 19862.26,-675.7"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep5 -->
<g id="node537" class="node">
<title>layer61_expert_allreduce_dp0_tp1_ep5</title>
<ellipse fill="lightyellow" stroke="black" cx="20392.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="20392.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="20392.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 117</text>
<text text-anchor="middle" x="20392.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="20392.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep5&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep5 -->
<g id="edge661" class="edge">
<title>layer61_expert_proj_dp0_tp1_ep5&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep5</title>
<path fill="none" stroke="black" d="M20145.73,-608.22C20181.53,-596.18 20222.59,-582.36 20260.81,-569.5"/>
<polygon fill="black" stroke="black" points="20262.09,-572.76 20270.45,-566.26 20259.86,-566.13 20262.09,-572.76"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep5 -->
<g id="node538" class="node">
<title>layer61_aggregate_dp0_tp1_ep5</title>
<polygon fill="lightpink" stroke="black" points="20964.27,-440.17 20382.13,-440.17 20232.38,-304.17 20814.52,-304.17 20964.27,-440.17"/>
<text text-anchor="middle" x="20598.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="20598.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 117</text>
<text text-anchor="middle" x="20598.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="20598.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep5&#45;&gt;layer61_aggregate_dp0_tp1_ep5 -->
<g id="edge662" class="edge">
<title>layer61_expert_allreduce_dp0_tp1_ep5&#45;&gt;layer61_aggregate_dp0_tp1_ep5</title>
<path fill="none" stroke="black" d="M20454.97,-477.61C20468.56,-467.71 20483.25,-457.01 20497.88,-446.35"/>
<polygon fill="black" stroke="black" points="20499.97,-449.16 20505.99,-440.44 20495.85,-443.5 20499.97,-449.16"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep5&#45;&gt;output_agg -->
<g id="edge936" class="edge">
<title>layer61_aggregate_dp0_tp1_ep5&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M20835.32,-322.8C20880.94,-315.2 20928.48,-308.45 20973.33,-304.17 21695.93,-235.12 26849.47,-208.21 28167.14,-202.42"/>
<polygon fill="black" stroke="black" points="28167.24,-205.92 28177.22,-202.38 28167.21,-198.92 28167.24,-205.92"/>
</g>
<!-- layer61_dispatch_dp0_tp1_ep6 -->
<g id="node540" class="node">
<title>layer61_dispatch_dp0_tp1_ep6</title>
<polygon fill="lightgreen" stroke="black" points="20450.48,-952.33 19763.02,-952.33 19586.17,-816.33 20273.63,-816.33 20450.48,-952.33"/>
<text text-anchor="middle" x="20018.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="20018.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 118</text>
<text text-anchor="middle" x="20018.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="20018.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp1_ep6&#45;&gt;layer61_dispatch_dp0_tp1_ep6 -->
<g id="edge664" class="edge">
<title>layer61_gate_dp0_tp1_ep6&#45;&gt;layer61_dispatch_dp0_tp1_ep6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19983.25,-988.14C19986.15,-979.65 19989.13,-970.9 19992.08,-962.27"/>
<polygon fill="black" stroke="black" points="19995.46,-963.18 19995.38,-952.59 19988.84,-960.92 19995.46,-963.18"/>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep6 -->
<g id="node541" class="node">
<title>layer61_expert_mlp_dp0_tp1_ep6</title>
<polygon fill="lightblue" stroke="black" points="20450.83,-780.33 20099.83,-780.33 20099.83,-712.33 20450.83,-712.33 20450.83,-780.33"/>
<text text-anchor="middle" x="20275.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="20275.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 118</text>
<text text-anchor="middle" x="20275.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="20275.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp1_ep6&#45;&gt;layer61_expert_mlp_dp0_tp1_ep6 -->
<g id="edge665" class="edge">
<title>layer61_dispatch_dp0_tp1_ep6&#45;&gt;layer61_expert_mlp_dp0_tp1_ep6</title>
<path fill="none" stroke="black" d="M20144.94,-816.33C20165.2,-805.61 20185.51,-794.86 20203.88,-785.14"/>
<polygon fill="black" stroke="black" points="20205.52,-788.23 20212.73,-780.46 20202.25,-782.04 20205.52,-788.23"/>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep6 -->
<g id="node542" class="node">
<title>layer61_expert_proj_dp0_tp1_ep6</title>
<polygon fill="lightblue" stroke="black" points="20947.83,-676.33 20596.83,-676.33 20596.83,-608.33 20947.83,-608.33 20947.83,-676.33"/>
<text text-anchor="middle" x="20772.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="20772.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 118</text>
<text text-anchor="middle" x="20772.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="20772.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep6&#45;&gt;layer61_expert_proj_dp0_tp1_ep6 -->
<g id="edge666" class="edge">
<title>layer61_expert_mlp_dp0_tp1_ep6&#45;&gt;layer61_expert_proj_dp0_tp1_ep6</title>
<path fill="none" stroke="black" d="M20436.34,-712.29C20489.06,-701.47 20547.79,-689.41 20601.23,-678.45"/>
<polygon fill="black" stroke="black" points="20602.05,-681.85 20611.14,-676.41 20600.64,-675 20602.05,-681.85"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep6 -->
<g id="node543" class="node">
<title>layer61_expert_allreduce_dp0_tp1_ep6</title>
<ellipse fill="lightyellow" stroke="black" cx="21127.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="21127.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="21127.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 118</text>
<text text-anchor="middle" x="21127.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="21127.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep6&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep6 -->
<g id="edge667" class="edge">
<title>layer61_expert_proj_dp0_tp1_ep6&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep6</title>
<path fill="none" stroke="black" d="M20873.58,-608.22C20910.78,-596.06 20953.5,-582.09 20993.15,-569.12"/>
<polygon fill="black" stroke="black" points="20994.47,-572.37 21002.89,-565.94 20992.3,-565.72 20994.47,-572.37"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep6 -->
<g id="node544" class="node">
<title>layer61_aggregate_dp0_tp1_ep6</title>
<polygon fill="lightpink" stroke="black" points="21714.27,-440.17 21132.13,-440.17 20982.38,-304.17 21564.52,-304.17 21714.27,-440.17"/>
<text text-anchor="middle" x="21348.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="21348.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 118</text>
<text text-anchor="middle" x="21348.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="21348.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep6&#45;&gt;layer61_aggregate_dp0_tp1_ep6 -->
<g id="edge668" class="edge">
<title>layer61_expert_allreduce_dp0_tp1_ep6&#45;&gt;layer61_aggregate_dp0_tp1_ep6</title>
<path fill="none" stroke="black" d="M21194.23,-477.81C21209.05,-467.75 21225.12,-456.84 21241.1,-445.99"/>
<polygon fill="black" stroke="black" points="21243.13,-448.84 21249.44,-440.32 21239.2,-443.05 21243.13,-448.84"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep6&#45;&gt;output_agg -->
<g id="edge937" class="edge">
<title>layer61_aggregate_dp0_tp1_ep6&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M21585.33,-322.86C21630.94,-315.25 21678.48,-308.49 21723.33,-304.17 22368.25,-242.04 26935.3,-210.39 28167.59,-202.92"/>
<polygon fill="black" stroke="black" points="28167.94,-206.42 28177.92,-202.86 28167.9,-199.42 28167.94,-206.42"/>
</g>
<!-- layer61_dispatch_dp0_tp1_ep7 -->
<g id="node546" class="node">
<title>layer61_dispatch_dp0_tp1_ep7</title>
<polygon fill="lightgreen" stroke="black" points="21333.48,-952.33 20646.02,-952.33 20469.17,-816.33 21156.63,-816.33 21333.48,-952.33"/>
<text text-anchor="middle" x="20901.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="20901.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 119</text>
<text text-anchor="middle" x="20901.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="20901.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp1_ep7&#45;&gt;layer61_dispatch_dp0_tp1_ep7 -->
<g id="edge670" class="edge">
<title>layer61_gate_dp0_tp1_ep7&#45;&gt;layer61_dispatch_dp0_tp1_ep7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20863.83,-988.14C20866.96,-979.56 20870.19,-970.72 20873.37,-961.99"/>
<polygon fill="black" stroke="black" points="20876.66,-963.18 20876.8,-952.59 20870.08,-960.79 20876.66,-963.18"/>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep7 -->
<g id="node547" class="node">
<title>layer61_expert_mlp_dp0_tp1_ep7</title>
<polygon fill="lightblue" stroke="black" points="21461.83,-780.33 21110.83,-780.33 21110.83,-712.33 21461.83,-712.33 21461.83,-780.33"/>
<text text-anchor="middle" x="21286.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="21286.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 119</text>
<text text-anchor="middle" x="21286.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="21286.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp1_ep7&#45;&gt;layer61_expert_mlp_dp0_tp1_ep7 -->
<g id="edge671" class="edge">
<title>layer61_dispatch_dp0_tp1_ep7&#45;&gt;layer61_expert_mlp_dp0_tp1_ep7</title>
<path fill="none" stroke="black" d="M21091.01,-816.33C21122.72,-805.12 21154.55,-793.88 21183.02,-783.82"/>
<polygon fill="black" stroke="black" points="21184.28,-787.09 21192.55,-780.46 21181.95,-780.49 21184.28,-787.09"/>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep7 -->
<g id="node548" class="node">
<title>layer61_expert_proj_dp0_tp1_ep7</title>
<polygon fill="lightblue" stroke="black" points="21988.83,-676.33 21637.83,-676.33 21637.83,-608.33 21988.83,-608.33 21988.83,-676.33"/>
<text text-anchor="middle" x="21813.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="21813.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 119</text>
<text text-anchor="middle" x="21813.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="21813.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep7&#45;&gt;layer61_expert_proj_dp0_tp1_ep7 -->
<g id="edge672" class="edge">
<title>layer61_expert_mlp_dp0_tp1_ep7&#45;&gt;layer61_expert_proj_dp0_tp1_ep7</title>
<path fill="none" stroke="black" d="M21457.06,-712.29C21513.08,-701.45 21575.5,-689.36 21632.25,-678.38"/>
<polygon fill="black" stroke="black" points="21633.26,-681.75 21642.41,-676.41 21631.93,-674.88 21633.26,-681.75"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep7 -->
<g id="node549" class="node">
<title>layer61_expert_allreduce_dp0_tp1_ep7</title>
<ellipse fill="lightyellow" stroke="black" cx="22003.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="22003.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="22003.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 119</text>
<text text-anchor="middle" x="22003.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="22003.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep7&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep7 -->
<g id="edge673" class="edge">
<title>layer61_expert_proj_dp0_tp1_ep7&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep7</title>
<path fill="none" stroke="black" d="M21867.52,-608.22C21884.11,-598.09 21902.75,-586.7 21920.78,-575.68"/>
<polygon fill="black" stroke="black" points="21922.86,-578.51 21929.57,-570.31 21919.21,-572.54 21922.86,-578.51"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep7 -->
<g id="node550" class="node">
<title>layer61_aggregate_dp0_tp1_ep7</title>
<polygon fill="lightpink" stroke="black" points="22464.27,-440.17 21882.13,-440.17 21732.38,-304.17 22314.52,-304.17 22464.27,-440.17"/>
<text text-anchor="middle" x="22098.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="22098.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 119</text>
<text text-anchor="middle" x="22098.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="22098.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep7&#45;&gt;layer61_aggregate_dp0_tp1_ep7 -->
<g id="edge674" class="edge">
<title>layer61_expert_allreduce_dp0_tp1_ep7&#45;&gt;layer61_aggregate_dp0_tp1_ep7</title>
<path fill="none" stroke="black" d="M22033.12,-476.17C22038.62,-467.49 22044.49,-458.21 22050.37,-448.93"/>
<polygon fill="black" stroke="black" points="22053.37,-450.73 22055.76,-440.41 22047.45,-446.99 22053.37,-450.73"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep7&#45;&gt;output_agg -->
<g id="edge938" class="edge">
<title>layer61_aggregate_dp0_tp1_ep7&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M22335.34,-322.92C22380.95,-315.31 22428.48,-308.53 22473.33,-304.17 23040.84,-248.95 27025.61,-212.85 28167.93,-203.55"/>
<polygon fill="black" stroke="black" points="28168.37,-207.04 28178.34,-203.46 28168.31,-200.04 28168.37,-207.04"/>
</g>
<!-- layer61_dispatch_dp0_tp1_ep8 -->
<g id="node552" class="node">
<title>layer61_dispatch_dp0_tp1_ep8</title>
<polygon fill="lightgreen" stroke="black" points="22216.48,-952.33 21529.02,-952.33 21352.17,-816.33 22039.63,-816.33 22216.48,-952.33"/>
<text text-anchor="middle" x="21784.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="21784.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 120</text>
<text text-anchor="middle" x="21784.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="21784.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp1_ep8&#45;&gt;layer61_dispatch_dp0_tp1_ep8 -->
<g id="edge676" class="edge">
<title>layer61_gate_dp0_tp1_ep8&#45;&gt;layer61_dispatch_dp0_tp1_ep8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21745.62,-988.14C21748.85,-979.56 21752.18,-970.72 21755.47,-961.99"/>
<polygon fill="black" stroke="black" points="21758.76,-963.18 21759.01,-952.59 21752.21,-960.72 21758.76,-963.18"/>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep8 -->
<g id="node553" class="node">
<title>layer61_expert_mlp_dp0_tp1_ep8</title>
<polygon fill="lightblue" stroke="black" points="22453.83,-780.33 22102.83,-780.33 22102.83,-712.33 22453.83,-712.33 22453.83,-780.33"/>
<text text-anchor="middle" x="22278.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="22278.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 120</text>
<text text-anchor="middle" x="22278.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="22278.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp1_ep8&#45;&gt;layer61_expert_mlp_dp0_tp1_ep8 -->
<g id="edge677" class="edge">
<title>layer61_dispatch_dp0_tp1_ep8&#45;&gt;layer61_expert_mlp_dp0_tp1_ep8</title>
<path fill="none" stroke="black" d="M22027.71,-816.33C22069.4,-804.85 22111.24,-793.33 22148.45,-783.09"/>
<polygon fill="black" stroke="black" points="22149.6,-786.4 22158.31,-780.37 22147.74,-779.65 22149.6,-786.4"/>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep8 -->
<g id="node554" class="node">
<title>layer61_expert_proj_dp0_tp1_ep8</title>
<polygon fill="lightblue" stroke="black" points="22690.83,-676.33 22339.83,-676.33 22339.83,-608.33 22690.83,-608.33 22690.83,-676.33"/>
<text text-anchor="middle" x="22515.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="22515.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 120</text>
<text text-anchor="middle" x="22515.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="22515.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep8&#45;&gt;layer61_expert_proj_dp0_tp1_ep8 -->
<g id="edge678" class="edge">
<title>layer61_expert_mlp_dp0_tp1_ep8&#45;&gt;layer61_expert_proj_dp0_tp1_ep8</title>
<path fill="none" stroke="black" d="M22355.27,-712.22C22378.78,-702.1 22404.78,-690.91 22428.88,-680.54"/>
<polygon fill="black" stroke="black" points="22430.56,-683.63 22438.36,-676.46 22427.79,-677.2 22430.56,-683.63"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep8 -->
<g id="node555" class="node">
<title>layer61_expert_allreduce_dp0_tp1_ep8</title>
<ellipse fill="lightyellow" stroke="black" cx="22682.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="22682.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="22682.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 120</text>
<text text-anchor="middle" x="22682.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="22682.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep8&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep8 -->
<g id="edge679" class="edge">
<title>layer61_expert_proj_dp0_tp1_ep8&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep8</title>
<path fill="none" stroke="black" d="M22563.18,-608.07C22577.25,-598.29 22592.98,-587.35 22608.28,-576.72"/>
<polygon fill="black" stroke="black" points="22610.51,-579.43 22616.73,-570.85 22606.52,-573.68 22610.51,-579.43"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep8 -->
<g id="node556" class="node">
<title>layer61_aggregate_dp0_tp1_ep8</title>
<polygon fill="lightpink" stroke="black" points="23214.27,-440.17 22632.13,-440.17 22482.38,-304.17 23064.52,-304.17 23214.27,-440.17"/>
<text text-anchor="middle" x="22848.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="22848.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 120</text>
<text text-anchor="middle" x="22848.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="22848.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep8&#45;&gt;layer61_aggregate_dp0_tp1_ep8 -->
<g id="edge680" class="edge">
<title>layer61_expert_allreduce_dp0_tp1_ep8&#45;&gt;layer61_aggregate_dp0_tp1_ep8</title>
<path fill="none" stroke="black" d="M22733.49,-477C22744.04,-467.46 22755.39,-457.19 22766.72,-446.95"/>
<polygon fill="black" stroke="black" points="22769.08,-449.54 22774.15,-440.23 22764.38,-444.34 22769.08,-449.54"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep8&#45;&gt;output_agg -->
<g id="edge939" class="edge">
<title>layer61_aggregate_dp0_tp1_ep8&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M23085.34,-323.01C23130.96,-315.4 23178.49,-308.58 23223.33,-304.17 24191.06,-208.82 27191.8,-200.86 28165.12,-200.85"/>
<polygon fill="black" stroke="black" points="28165.41,-204.35 28175.41,-200.85 28165.41,-197.35 28165.41,-204.35"/>
</g>
<!-- layer61_dispatch_dp0_tp1_ep9 -->
<g id="node558" class="node">
<title>layer61_dispatch_dp0_tp1_ep9</title>
<polygon fill="lightgreen" stroke="black" points="23099.48,-952.33 22412.02,-952.33 22235.17,-816.33 22922.63,-816.33 23099.48,-952.33"/>
<text text-anchor="middle" x="22667.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="22667.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 121</text>
<text text-anchor="middle" x="22667.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="22667.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp1_ep9&#45;&gt;layer61_dispatch_dp0_tp1_ep9 -->
<g id="edge682" class="edge">
<title>layer61_gate_dp0_tp1_ep9&#45;&gt;layer61_dispatch_dp0_tp1_ep9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22628.02,-988.14C22631.3,-979.56 22634.68,-970.72 22638.02,-961.99"/>
<polygon fill="black" stroke="black" points="22641.31,-963.18 22641.61,-952.59 22634.77,-960.68 22641.31,-963.18"/>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep9 -->
<g id="node559" class="node">
<title>layer61_expert_mlp_dp0_tp1_ep9</title>
<polygon fill="lightblue" stroke="black" points="23079.83,-780.33 22728.83,-780.33 22728.83,-712.33 23079.83,-712.33 23079.83,-780.33"/>
<text text-anchor="middle" x="22904.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="22904.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 121</text>
<text text-anchor="middle" x="22904.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="22904.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp1_ep9&#45;&gt;layer61_expert_mlp_dp0_tp1_ep9 -->
<g id="edge683" class="edge">
<title>layer61_dispatch_dp0_tp1_ep9&#45;&gt;layer61_expert_mlp_dp0_tp1_ep9</title>
<path fill="none" stroke="black" d="M22784.09,-816.33C22802.43,-805.81 22820.82,-795.25 22837.51,-785.67"/>
<polygon fill="black" stroke="black" points="22839.67,-788.47 22846.6,-780.46 22836.18,-782.4 22839.67,-788.47"/>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep9 -->
<g id="node560" class="node">
<title>layer61_expert_proj_dp0_tp1_ep9</title>
<polygon fill="lightblue" stroke="black" points="23579.83,-676.33 23228.83,-676.33 23228.83,-608.33 23579.83,-608.33 23579.83,-676.33"/>
<text text-anchor="middle" x="23404.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="23404.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 121</text>
<text text-anchor="middle" x="23404.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="23404.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep9&#45;&gt;layer61_expert_proj_dp0_tp1_ep9 -->
<g id="edge684" class="edge">
<title>layer61_expert_mlp_dp0_tp1_ep9&#45;&gt;layer61_expert_proj_dp0_tp1_ep9</title>
<path fill="none" stroke="black" d="M23066.32,-712.29C23119.35,-701.47 23178.44,-689.41 23232.19,-678.45"/>
<polygon fill="black" stroke="black" points="23233.07,-681.84 23242.17,-676.41 23231.67,-674.98 23233.07,-681.84"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep9 -->
<g id="node561" class="node">
<title>layer61_expert_allreduce_dp0_tp1_ep9</title>
<ellipse fill="lightyellow" stroke="black" cx="23469.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="23469.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="23469.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 121</text>
<text text-anchor="middle" x="23469.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="23469.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep9&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep9 -->
<g id="edge685" class="edge">
<title>layer61_expert_proj_dp0_tp1_ep9&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep9</title>
<path fill="none" stroke="black" d="M23422.95,-608.07C23427.67,-599.64 23432.87,-590.35 23438.03,-581.14"/>
<polygon fill="black" stroke="black" points="23441.12,-582.79 23442.95,-572.36 23435.01,-579.37 23441.12,-582.79"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep9 -->
<g id="node562" class="node">
<title>layer61_aggregate_dp0_tp1_ep9</title>
<polygon fill="lightpink" stroke="black" points="23964.27,-440.17 23382.13,-440.17 23232.38,-304.17 23814.52,-304.17 23964.27,-440.17"/>
<text text-anchor="middle" x="23598.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="23598.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 121</text>
<text text-anchor="middle" x="23598.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="23598.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep9&#45;&gt;layer61_aggregate_dp0_tp1_ep9 -->
<g id="edge686" class="edge">
<title>layer61_expert_allreduce_dp0_tp1_ep9&#45;&gt;layer61_aggregate_dp0_tp1_ep9</title>
<path fill="none" stroke="black" d="M23509.44,-476.59C23517.26,-467.49 23525.64,-457.74 23534.01,-447.99"/>
<polygon fill="black" stroke="black" points="23536.86,-450.05 23540.72,-440.19 23531.55,-445.49 23536.86,-450.05"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep9&#45;&gt;output_agg -->
<g id="edge940" class="edge">
<title>layer61_aggregate_dp0_tp1_ep9&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M23835.61,-323.09C23881.14,-315.48 23928.58,-308.65 23973.33,-304.17 24789.12,-222.44 27290.87,-205.49 28166.66,-202.03"/>
<polygon fill="black" stroke="black" points="28166.9,-205.53 28176.89,-201.99 28166.87,-198.53 28166.9,-205.53"/>
</g>
<!-- layer61_dispatch_dp0_tp1_ep10 -->
<g id="node564" class="node">
<title>layer61_dispatch_dp0_tp1_ep10</title>
<polygon fill="lightgreen" stroke="black" points="23982.48,-952.33 23295.02,-952.33 23118.17,-816.33 23805.63,-816.33 23982.48,-952.33"/>
<text text-anchor="middle" x="23550.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="23550.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 122</text>
<text text-anchor="middle" x="23550.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="23550.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp1_ep10&#45;&gt;layer61_dispatch_dp0_tp1_ep10 -->
<g id="edge688" class="edge">
<title>layer61_gate_dp0_tp1_ep10&#45;&gt;layer61_dispatch_dp0_tp1_ep10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23510.41,-988.14C23513.75,-979.56 23517.18,-970.72 23520.56,-961.99"/>
<polygon fill="black" stroke="black" points="23523.86,-963.18 23524.21,-952.59 23517.33,-960.65 23523.86,-963.18"/>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep10 -->
<g id="node565" class="node">
<title>layer61_expert_mlp_dp0_tp1_ep10</title>
<polygon fill="lightblue" stroke="black" points="23790.83,-780.33 23439.83,-780.33 23439.83,-712.33 23790.83,-712.33 23790.83,-780.33"/>
<text text-anchor="middle" x="23615.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="23615.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 122</text>
<text text-anchor="middle" x="23615.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="23615.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp1_ep10&#45;&gt;layer61_expert_mlp_dp0_tp1_ep10 -->
<g id="edge689" class="edge">
<title>layer61_dispatch_dp0_tp1_ep10&#45;&gt;layer61_expert_mlp_dp0_tp1_ep10</title>
<path fill="none" stroke="black" d="M23582.45,-816.13C23586.77,-807.09 23591.1,-798.02 23595.13,-789.58"/>
<polygon fill="black" stroke="black" points="23598.39,-790.88 23599.55,-780.35 23592.08,-787.86 23598.39,-790.88"/>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep10 -->
<g id="node566" class="node">
<title>layer61_expert_proj_dp0_tp1_ep10</title>
<polygon fill="lightblue" stroke="black" points="24048.83,-676.33 23697.83,-676.33 23697.83,-608.33 24048.83,-608.33 24048.83,-676.33"/>
<text text-anchor="middle" x="23873.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="23873.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 122</text>
<text text-anchor="middle" x="23873.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="23873.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep10&#45;&gt;layer61_expert_proj_dp0_tp1_ep10 -->
<g id="edge690" class="edge">
<title>layer61_expert_mlp_dp0_tp1_ep10&#45;&gt;layer61_expert_proj_dp0_tp1_ep10</title>
<path fill="none" stroke="black" d="M23699.09,-712.22C23724.91,-702.01 23753.49,-690.71 23779.91,-680.26"/>
<polygon fill="black" stroke="black" points="23781.53,-683.39 23789.54,-676.46 23778.95,-676.88 23781.53,-683.39"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep10 -->
<g id="node567" class="node">
<title>layer61_expert_allreduce_dp0_tp1_ep10</title>
<ellipse fill="lightyellow" stroke="black" cx="24166.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="24166.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="24166.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 122</text>
<text text-anchor="middle" x="24166.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="24166.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep10&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep10 -->
<g id="edge691" class="edge">
<title>layer61_expert_proj_dp0_tp1_ep10&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep10</title>
<path fill="none" stroke="black" d="M23956.9,-608.22C23985.71,-596.81 24018.54,-583.8 24049.52,-571.53"/>
<polygon fill="black" stroke="black" points="24051.06,-574.68 24059.07,-567.74 24048.49,-568.17 24051.06,-574.68"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep10 -->
<g id="node568" class="node">
<title>layer61_aggregate_dp0_tp1_ep10</title>
<polygon fill="lightpink" stroke="black" points="24714.27,-440.17 24132.13,-440.17 23982.38,-304.17 24564.52,-304.17 24714.27,-440.17"/>
<text text-anchor="middle" x="24348.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="24348.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 122</text>
<text text-anchor="middle" x="24348.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="24348.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep10&#45;&gt;layer61_aggregate_dp0_tp1_ep10 -->
<g id="edge692" class="edge">
<title>layer61_expert_allreduce_dp0_tp1_ep10&#45;&gt;layer61_aggregate_dp0_tp1_ep10</title>
<path fill="none" stroke="black" d="M24222.42,-477C24234.09,-467.37 24246.67,-456.99 24259.21,-446.66"/>
<polygon fill="black" stroke="black" points="24261.51,-449.3 24267,-440.23 24257.05,-443.9 24261.51,-449.3"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep10&#45;&gt;output_agg -->
<g id="edge941" class="edge">
<title>layer61_aggregate_dp0_tp1_ep10&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M24585.62,-323.26C24631.16,-315.63 24678.59,-308.75 24723.33,-304.17 25388.33,-236.01 27398.12,-210.93 28168.38,-203.67"/>
<polygon fill="black" stroke="black" points="28168.54,-207.17 28178.51,-203.57 28168.47,-200.17 28168.54,-207.17"/>
</g>
<!-- layer61_dispatch_dp0_tp1_ep11 -->
<g id="node570" class="node">
<title>layer61_dispatch_dp0_tp1_ep11</title>
<polygon fill="lightgreen" stroke="black" points="24865.48,-952.33 24178.02,-952.33 24001.17,-816.33 24688.63,-816.33 24865.48,-952.33"/>
<text text-anchor="middle" x="24433.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="24433.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 123</text>
<text text-anchor="middle" x="24433.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="24433.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp1_ep11&#45;&gt;layer61_dispatch_dp0_tp1_ep11 -->
<g id="edge694" class="edge">
<title>layer61_gate_dp0_tp1_ep11&#45;&gt;layer61_dispatch_dp0_tp1_ep11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24393.41,-988.14C24396.75,-979.56 24400.18,-970.72 24403.56,-961.99"/>
<polygon fill="black" stroke="black" points="24406.86,-963.18 24407.21,-952.59 24400.33,-960.65 24406.86,-963.18"/>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep11 -->
<g id="node571" class="node">
<title>layer61_expert_mlp_dp0_tp1_ep11</title>
<polygon fill="lightblue" stroke="black" points="24715.83,-780.33 24364.83,-780.33 24364.83,-712.33 24715.83,-712.33 24715.83,-780.33"/>
<text text-anchor="middle" x="24540.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="24540.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 123</text>
<text text-anchor="middle" x="24540.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="24540.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp1_ep11&#45;&gt;layer61_expert_mlp_dp0_tp1_ep11 -->
<g id="edge695" class="edge">
<title>layer61_dispatch_dp0_tp1_ep11&#45;&gt;layer61_expert_mlp_dp0_tp1_ep11</title>
<path fill="none" stroke="black" d="M24486.2,-816.13C24493.7,-806.6 24501.21,-797.05 24508.15,-788.23"/>
<polygon fill="black" stroke="black" points="24510.92,-790.37 24514.35,-780.35 24505.42,-786.04 24510.92,-790.37"/>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep11 -->
<g id="node572" class="node">
<title>layer61_expert_proj_dp0_tp1_ep11</title>
<polygon fill="lightblue" stroke="black" points="24823.83,-676.33 24472.83,-676.33 24472.83,-608.33 24823.83,-608.33 24823.83,-676.33"/>
<text text-anchor="middle" x="24648.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="24648.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 123</text>
<text text-anchor="middle" x="24648.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="24648.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep11&#45;&gt;layer61_expert_proj_dp0_tp1_ep11 -->
<g id="edge696" class="edge">
<title>layer61_expert_mlp_dp0_tp1_ep11&#45;&gt;layer61_expert_proj_dp0_tp1_ep11</title>
<path fill="none" stroke="black" d="M24575.39,-712.22C24585.01,-703.13 24595.55,-693.18 24605.55,-683.73"/>
<polygon fill="black" stroke="black" points="24608.2,-686.04 24613.07,-676.63 24603.39,-680.95 24608.2,-686.04"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep11 -->
<g id="node573" class="node">
<title>layer61_expert_allreduce_dp0_tp1_ep11</title>
<ellipse fill="lightyellow" stroke="black" cx="24980.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="24980.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="24980.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 123</text>
<text text-anchor="middle" x="24980.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="24980.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep11&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep11 -->
<g id="edge697" class="edge">
<title>layer61_expert_proj_dp0_tp1_ep11&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep11</title>
<path fill="none" stroke="black" d="M24743.02,-608.22C24777.06,-596.32 24816.05,-582.69 24852.45,-569.96"/>
<polygon fill="black" stroke="black" points="24853.85,-573.18 24862.14,-566.57 24851.54,-566.57 24853.85,-573.18"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep11 -->
<g id="node574" class="node">
<title>layer61_aggregate_dp0_tp1_ep11</title>
<polygon fill="lightpink" stroke="black" points="25464.27,-440.17 24882.13,-440.17 24732.38,-304.17 25314.52,-304.17 25464.27,-440.17"/>
<text text-anchor="middle" x="25098.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="25098.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 123</text>
<text text-anchor="middle" x="25098.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="25098.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep11&#45;&gt;layer61_aggregate_dp0_tp1_ep11 -->
<g id="edge698" class="edge">
<title>layer61_expert_allreduce_dp0_tp1_ep11&#45;&gt;layer61_aggregate_dp0_tp1_ep11</title>
<path fill="none" stroke="black" d="M25017.02,-476.59C25024.1,-467.58 25031.68,-457.93 25039.27,-448.28"/>
<polygon fill="black" stroke="black" points="25042.2,-450.21 25045.63,-440.19 25036.7,-445.88 25042.2,-450.21"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep11&#45;&gt;output_agg -->
<g id="edge942" class="edge">
<title>layer61_aggregate_dp0_tp1_ep11&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M25335.9,-323.46C25381.36,-315.83 25428.69,-308.9 25473.33,-304.17 25989.31,-249.5 27517.74,-217.56 28171.35,-206.06"/>
<polygon fill="black" stroke="black" points="28171.44,-209.56 28181.38,-205.89 28171.32,-202.56 28171.44,-209.56"/>
</g>
<!-- layer61_dispatch_dp0_tp1_ep12 -->
<g id="node576" class="node">
<title>layer61_dispatch_dp0_tp1_ep12</title>
<polygon fill="lightgreen" stroke="black" points="25748.48,-952.33 25061.02,-952.33 24884.17,-816.33 25571.63,-816.33 25748.48,-952.33"/>
<text text-anchor="middle" x="25316.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="25316.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 124</text>
<text text-anchor="middle" x="25316.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="25316.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp1_ep12&#45;&gt;layer61_dispatch_dp0_tp1_ep12 -->
<g id="edge700" class="edge">
<title>layer61_gate_dp0_tp1_ep12&#45;&gt;layer61_dispatch_dp0_tp1_ep12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M25276.41,-988.14C25279.75,-979.56 25283.18,-970.72 25286.56,-961.99"/>
<polygon fill="black" stroke="black" points="25289.86,-963.18 25290.21,-952.59 25283.33,-960.65 25289.86,-963.18"/>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep12 -->
<g id="node577" class="node">
<title>layer61_expert_mlp_dp0_tp1_ep12</title>
<polygon fill="lightblue" stroke="black" points="25580.83,-780.33 25229.83,-780.33 25229.83,-712.33 25580.83,-712.33 25580.83,-780.33"/>
<text text-anchor="middle" x="25405.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="25405.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 124</text>
<text text-anchor="middle" x="25405.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="25405.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp1_ep12&#45;&gt;layer61_expert_mlp_dp0_tp1_ep12 -->
<g id="edge701" class="edge">
<title>layer61_dispatch_dp0_tp1_ep12&#45;&gt;layer61_expert_mlp_dp0_tp1_ep12</title>
<path fill="none" stroke="black" d="M25360.3,-816.13C25366.41,-806.79 25372.54,-797.44 25378.21,-788.77"/>
<polygon fill="black" stroke="black" points="25381.17,-790.63 25383.72,-780.35 25375.32,-786.8 25381.17,-790.63"/>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep12 -->
<g id="node578" class="node">
<title>layer61_expert_proj_dp0_tp1_ep12</title>
<polygon fill="lightblue" stroke="black" points="25669.83,-676.33 25318.83,-676.33 25318.83,-608.33 25669.83,-608.33 25669.83,-676.33"/>
<text text-anchor="middle" x="25494.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="25494.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 124</text>
<text text-anchor="middle" x="25494.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="25494.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep12&#45;&gt;layer61_expert_proj_dp0_tp1_ep12 -->
<g id="edge702" class="edge">
<title>layer61_expert_mlp_dp0_tp1_ep12&#45;&gt;layer61_expert_proj_dp0_tp1_ep12</title>
<path fill="none" stroke="black" d="M25434.22,-712.22C25441.99,-703.31 25450.49,-693.57 25458.59,-684.29"/>
<polygon fill="black" stroke="black" points="25461.33,-686.47 25465.27,-676.63 25456.06,-681.87 25461.33,-686.47"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep12 -->
<g id="node579" class="node">
<title>layer61_expert_allreduce_dp0_tp1_ep12</title>
<ellipse fill="lightyellow" stroke="black" cx="25671.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="25671.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="25671.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 124</text>
<text text-anchor="middle" x="25671.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="25671.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep12&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep12 -->
<g id="edge703" class="edge">
<title>layer61_expert_proj_dp0_tp1_ep12&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep12</title>
<path fill="none" stroke="black" d="M25545.05,-608.07C25560.18,-598.14 25577.14,-587.02 25593.58,-576.24"/>
<polygon fill="black" stroke="black" points="25595.68,-579.04 25602.13,-570.63 25591.85,-573.19 25595.68,-579.04"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep12 -->
<g id="node580" class="node">
<title>layer61_aggregate_dp0_tp1_ep12</title>
<polygon fill="lightpink" stroke="black" points="26214.27,-440.17 25632.13,-440.17 25482.38,-304.17 26064.52,-304.17 26214.27,-440.17"/>
<text text-anchor="middle" x="25848.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="25848.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 124</text>
<text text-anchor="middle" x="25848.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="25848.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep12&#45;&gt;layer61_aggregate_dp0_tp1_ep12 -->
<g id="edge704" class="edge">
<title>layer61_expert_allreduce_dp0_tp1_ep12&#45;&gt;layer61_aggregate_dp0_tp1_ep12</title>
<path fill="none" stroke="black" d="M25725.88,-477C25737.12,-467.46 25749.24,-457.19 25761.31,-446.95"/>
<polygon fill="black" stroke="black" points="25763.87,-449.37 25769.23,-440.23 25759.34,-444.03 25763.87,-449.37"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep12&#45;&gt;output_agg -->
<g id="edge943" class="edge">
<title>layer61_aggregate_dp0_tp1_ep12&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M26086.2,-323.83C26131.57,-316.18 26178.8,-309.14 26223.33,-304.17 26915.2,-226.86 27732.96,-207.26 28166.89,-202.5"/>
<polygon fill="black" stroke="black" points="28167.11,-205.99 28177.07,-202.39 28167.03,-199 28167.11,-205.99"/>
</g>
<!-- layer61_dispatch_dp0_tp1_ep13 -->
<g id="node582" class="node">
<title>layer61_dispatch_dp0_tp1_ep13</title>
<polygon fill="lightgreen" stroke="black" points="26631.48,-952.33 25944.02,-952.33 25767.17,-816.33 26454.63,-816.33 26631.48,-952.33"/>
<text text-anchor="middle" x="26199.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="26199.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 125</text>
<text text-anchor="middle" x="26199.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="26199.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp1_ep13&#45;&gt;layer61_dispatch_dp0_tp1_ep13 -->
<g id="edge706" class="edge">
<title>layer61_gate_dp0_tp1_ep13&#45;&gt;layer61_dispatch_dp0_tp1_ep13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26159.41,-988.14C26162.75,-979.56 26166.18,-970.72 26169.56,-961.99"/>
<polygon fill="black" stroke="black" points="26172.86,-963.18 26173.21,-952.59 26166.33,-960.65 26172.86,-963.18"/>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep13 -->
<g id="node583" class="node">
<title>layer61_expert_mlp_dp0_tp1_ep13</title>
<polygon fill="lightblue" stroke="black" points="26470.83,-780.33 26119.83,-780.33 26119.83,-712.33 26470.83,-712.33 26470.83,-780.33"/>
<text text-anchor="middle" x="26295.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="26295.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 125</text>
<text text-anchor="middle" x="26295.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="26295.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp1_ep13&#45;&gt;layer61_expert_mlp_dp0_tp1_ep13 -->
<g id="edge707" class="edge">
<title>layer61_dispatch_dp0_tp1_ep13&#45;&gt;layer61_expert_mlp_dp0_tp1_ep13</title>
<path fill="none" stroke="black" d="M26246.76,-816.13C26253.35,-806.79 26259.96,-797.44 26266.08,-788.77"/>
<polygon fill="black" stroke="black" points="26269.11,-790.54 26272.02,-780.35 26263.39,-786.5 26269.11,-790.54"/>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep13 -->
<g id="node584" class="node">
<title>layer61_expert_proj_dp0_tp1_ep13</title>
<polygon fill="lightblue" stroke="black" points="26669.83,-676.33 26318.83,-676.33 26318.83,-608.33 26669.83,-608.33 26669.83,-676.33"/>
<text text-anchor="middle" x="26494.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="26494.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 125</text>
<text text-anchor="middle" x="26494.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="26494.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep13&#45;&gt;layer61_expert_proj_dp0_tp1_ep13 -->
<g id="edge708" class="edge">
<title>layer61_expert_mlp_dp0_tp1_ep13&#45;&gt;layer61_expert_proj_dp0_tp1_ep13</title>
<path fill="none" stroke="black" d="M26359.94,-712.22C26379.32,-702.28 26400.74,-691.3 26420.66,-681.09"/>
<polygon fill="black" stroke="black" points="26422.4,-684.13 26429.7,-676.46 26419.2,-677.9 26422.4,-684.13"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep13 -->
<g id="node585" class="node">
<title>layer61_expert_allreduce_dp0_tp1_ep13</title>
<ellipse fill="lightyellow" stroke="black" cx="26591.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="26591.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="26591.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 125</text>
<text text-anchor="middle" x="26591.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="26591.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep13&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep13 -->
<g id="edge709" class="edge">
<title>layer61_expert_proj_dp0_tp1_ep13&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep13</title>
<path fill="none" stroke="black" d="M26522.12,-608.07C26529.54,-599.19 26537.76,-589.35 26545.86,-579.65"/>
<polygon fill="black" stroke="black" points="26548.6,-581.84 26552.32,-571.93 26543.22,-577.36 26548.6,-581.84"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep13 -->
<g id="node586" class="node">
<title>layer61_aggregate_dp0_tp1_ep13</title>
<polygon fill="lightpink" stroke="black" points="26964.27,-440.17 26382.13,-440.17 26232.38,-304.17 26814.52,-304.17 26964.27,-440.17"/>
<text text-anchor="middle" x="26598.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="26598.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 125</text>
<text text-anchor="middle" x="26598.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="26598.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep13&#45;&gt;layer61_aggregate_dp0_tp1_ep13 -->
<g id="edge710" class="edge">
<title>layer61_expert_allreduce_dp0_tp1_ep13&#45;&gt;layer61_aggregate_dp0_tp1_ep13</title>
<path fill="none" stroke="black" d="M26593.54,-475.76C26593.92,-467.68 26594.32,-459.09 26594.72,-450.47"/>
<polygon fill="black" stroke="black" points="26598.22,-450.51 26595.19,-440.36 26591.23,-450.19 26598.22,-450.51"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep13&#45;&gt;output_agg -->
<g id="edge944" class="edge">
<title>layer61_aggregate_dp0_tp1_ep13&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M26837.05,-324.53C26882.18,-316.84 26929.1,-309.62 26973.33,-304.17 27389.58,-252.84 27874.22,-225.37 28177.42,-212.03"/>
<polygon fill="black" stroke="black" points="28177.84,-215.51 28187.68,-211.58 28177.54,-208.52 28177.84,-215.51"/>
</g>
<!-- layer61_dispatch_dp0_tp1_ep14 -->
<g id="node588" class="node">
<title>layer61_dispatch_dp0_tp1_ep14</title>
<polygon fill="lightgreen" stroke="black" points="27514.48,-952.33 26827.02,-952.33 26650.17,-816.33 27337.63,-816.33 27514.48,-952.33"/>
<text text-anchor="middle" x="27082.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="27082.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 126</text>
<text text-anchor="middle" x="27082.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="27082.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp1_ep14&#45;&gt;layer61_dispatch_dp0_tp1_ep14 -->
<g id="edge712" class="edge">
<title>layer61_gate_dp0_tp1_ep14&#45;&gt;layer61_dispatch_dp0_tp1_ep14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27042.41,-988.14C27045.75,-979.56 27049.18,-970.72 27052.56,-961.99"/>
<polygon fill="black" stroke="black" points="27055.86,-963.18 27056.21,-952.59 27049.33,-960.65 27055.86,-963.18"/>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep14 -->
<g id="node589" class="node">
<title>layer61_expert_mlp_dp0_tp1_ep14</title>
<polygon fill="lightblue" stroke="black" points="27321.83,-780.33 26970.83,-780.33 26970.83,-712.33 27321.83,-712.33 27321.83,-780.33"/>
<text text-anchor="middle" x="27146.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="27146.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 126</text>
<text text-anchor="middle" x="27146.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="27146.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp1_ep14&#45;&gt;layer61_expert_mlp_dp0_tp1_ep14 -->
<g id="edge713" class="edge">
<title>layer61_dispatch_dp0_tp1_ep14&#45;&gt;layer61_expert_mlp_dp0_tp1_ep14</title>
<path fill="none" stroke="black" d="M27113.95,-816.13C27118.21,-807.09 27122.47,-798.02 27126.44,-789.58"/>
<polygon fill="black" stroke="black" points="27129.7,-790.89 27130.79,-780.35 27123.36,-787.91 27129.7,-790.89"/>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep14 -->
<g id="node590" class="node">
<title>layer61_expert_proj_dp0_tp1_ep14</title>
<polygon fill="lightblue" stroke="black" points="27386.83,-676.33 27035.83,-676.33 27035.83,-608.33 27386.83,-608.33 27386.83,-676.33"/>
<text text-anchor="middle" x="27211.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="27211.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 126</text>
<text text-anchor="middle" x="27211.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="27211.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep14&#45;&gt;layer61_expert_proj_dp0_tp1_ep14 -->
<g id="edge714" class="edge">
<title>layer61_expert_mlp_dp0_tp1_ep14&#45;&gt;layer61_expert_proj_dp0_tp1_ep14</title>
<path fill="none" stroke="black" d="M27167.43,-712.22C27172.94,-703.58 27178.94,-694.15 27184.69,-685.13"/>
<polygon fill="black" stroke="black" points="27187.68,-686.95 27190.11,-676.63 27181.78,-683.18 27187.68,-686.95"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep14 -->
<g id="node591" class="node">
<title>layer61_expert_allreduce_dp0_tp1_ep14</title>
<ellipse fill="lightyellow" stroke="black" cx="27226.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="27226.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="27226.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 126</text>
<text text-anchor="middle" x="27226.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="27226.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep14&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep14 -->
<g id="edge715" class="edge">
<title>layer61_expert_proj_dp0_tp1_ep14&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep14</title>
<path fill="none" stroke="black" d="M27215.62,-608.07C27216.67,-599.99 27217.81,-591.12 27218.96,-582.28"/>
<polygon fill="black" stroke="black" points="27222.43,-582.73 27220.24,-572.36 27215.49,-581.83 27222.43,-582.73"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep14 -->
<g id="node592" class="node">
<title>layer61_aggregate_dp0_tp1_ep14</title>
<polygon fill="lightpink" stroke="black" points="27714.27,-440.17 27132.13,-440.17 26982.38,-304.17 27564.52,-304.17 27714.27,-440.17"/>
<text text-anchor="middle" x="27348.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="27348.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 126</text>
<text text-anchor="middle" x="27348.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="27348.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep14&#45;&gt;layer61_aggregate_dp0_tp1_ep14 -->
<g id="edge716" class="edge">
<title>layer61_expert_allreduce_dp0_tp1_ep14&#45;&gt;layer61_aggregate_dp0_tp1_ep14</title>
<path fill="none" stroke="black" d="M27264.26,-476.59C27271.65,-467.49 27279.58,-457.74 27287.5,-447.99"/>
<polygon fill="black" stroke="black" points="27290.25,-450.15 27293.85,-440.19 27284.82,-445.74 27290.25,-450.15"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep14&#45;&gt;output_agg -->
<g id="edge945" class="edge">
<title>layer61_aggregate_dp0_tp1_ep14&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M27589.4,-326.61C27633.88,-318.82 27679.97,-311.01 27723.33,-304.17 27881.96,-279.11 28060.03,-254.51 28202.84,-235.64"/>
<polygon fill="black" stroke="black" points="28203.6,-239.06 28213.06,-234.29 28202.69,-232.13 28203.6,-239.06"/>
</g>
<!-- layer61_dispatch_dp0_tp1_ep15 -->
<g id="node594" class="node">
<title>layer61_dispatch_dp0_tp1_ep15</title>
<polygon fill="lightgreen" stroke="black" points="28397.48,-952.33 27710.02,-952.33 27533.17,-816.33 28220.63,-816.33 28397.48,-952.33"/>
<text text-anchor="middle" x="27965.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="27965.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 127</text>
<text text-anchor="middle" x="27965.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="27965.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp0_tp1_ep15&#45;&gt;layer61_dispatch_dp0_tp1_ep15 -->
<g id="edge718" class="edge">
<title>layer61_gate_dp0_tp1_ep15&#45;&gt;layer61_dispatch_dp0_tp1_ep15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27925.41,-988.14C27928.75,-979.56 27932.18,-970.72 27935.56,-961.99"/>
<polygon fill="black" stroke="black" points="27938.86,-963.18 27939.21,-952.59 27932.33,-960.65 27938.86,-963.18"/>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep15 -->
<g id="node595" class="node">
<title>layer61_expert_mlp_dp0_tp1_ep15</title>
<polygon fill="lightblue" stroke="black" points="28157.83,-780.33 27806.83,-780.33 27806.83,-712.33 28157.83,-712.33 28157.83,-780.33"/>
<text text-anchor="middle" x="27982.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="27982.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 127</text>
<text text-anchor="middle" x="27982.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="27982.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp0_tp1_ep15&#45;&gt;layer61_expert_mlp_dp0_tp1_ep15 -->
<g id="edge719" class="edge">
<title>layer61_dispatch_dp0_tp1_ep15&#45;&gt;layer61_expert_mlp_dp0_tp1_ep15</title>
<path fill="none" stroke="black" d="M27973.73,-816.13C27974.82,-807.38 27975.92,-798.61 27976.94,-790.4"/>
<polygon fill="black" stroke="black" points="27980.43,-790.71 27978.2,-780.35 27973.49,-789.84 27980.43,-790.71"/>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep15 -->
<g id="node596" class="node">
<title>layer61_expert_proj_dp0_tp1_ep15</title>
<polygon fill="lightblue" stroke="black" points="28174.83,-676.33 27823.83,-676.33 27823.83,-608.33 28174.83,-608.33 28174.83,-676.33"/>
<text text-anchor="middle" x="27999.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="27999.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 127</text>
<text text-anchor="middle" x="27999.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="27999.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp0_tp1_ep15&#45;&gt;layer61_expert_proj_dp0_tp1_ep15 -->
<g id="edge720" class="edge">
<title>layer61_expert_mlp_dp0_tp1_ep15&#45;&gt;layer61_expert_proj_dp0_tp1_ep15</title>
<path fill="none" stroke="black" d="M27987.85,-712.22C27989.21,-704.02 27990.69,-695.12 27992.13,-686.52"/>
<polygon fill="black" stroke="black" points="27995.58,-687.07 27993.78,-676.63 27988.68,-685.92 27995.58,-687.07"/>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep15 -->
<g id="node597" class="node">
<title>layer61_expert_allreduce_dp0_tp1_ep15</title>
<ellipse fill="lightyellow" stroke="black" cx="28065.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="28065.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="28065.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 127</text>
<text text-anchor="middle" x="28065.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="28065.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp0_tp1_ep15&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep15 -->
<g id="edge721" class="edge">
<title>layer61_expert_proj_dp0_tp1_ep15&#45;&gt;layer61_expert_allreduce_dp0_tp1_ep15</title>
<path fill="none" stroke="black" d="M28018.24,-608.07C28023.03,-599.64 28028.31,-590.35 28033.55,-581.14"/>
<polygon fill="black" stroke="black" points="28036.64,-582.78 28038.54,-572.36 28030.56,-579.32 28036.64,-582.78"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep15 -->
<g id="node598" class="node">
<title>layer61_aggregate_dp0_tp1_ep15</title>
<polygon fill="lightpink" stroke="black" points="28464.27,-440.17 27882.13,-440.17 27732.38,-304.17 28314.52,-304.17 28464.27,-440.17"/>
<text text-anchor="middle" x="28098.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="28098.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 127</text>
<text text-anchor="middle" x="28098.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="28098.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp0_tp1_ep15&#45;&gt;layer61_aggregate_dp0_tp1_ep15 -->
<g id="edge722" class="edge">
<title>layer61_expert_allreduce_dp0_tp1_ep15&#45;&gt;layer61_aggregate_dp0_tp1_ep15</title>
<path fill="none" stroke="black" d="M28075.68,-476.17C28077.49,-467.93 28079.42,-459.16 28081.36,-450.35"/>
<polygon fill="black" stroke="black" points="28084.81,-450.93 28083.54,-440.41 28077.97,-449.43 28084.81,-450.93"/>
</g>
<!-- layer61_aggregate_dp0_tp1_ep15&#45;&gt;output_agg -->
<g id="edge946" class="edge">
<title>layer61_aggregate_dp0_tp1_ep15&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M28246.27,-304.1C28269.23,-293.69 28293.03,-282.9 28316.19,-272.4"/>
<polygon fill="black" stroke="black" points="28317.71,-275.55 28325.38,-268.24 28314.82,-269.18 28317.71,-275.55"/>
</g>
<!-- layer61_dispatch_dp1_tp0_ep0 -->
<g id="node600" class="node">
<title>layer61_dispatch_dp1_tp0_ep0</title>
<polygon fill="lightgreen" stroke="black" points="29280.48,-952.33 28593.02,-952.33 28416.17,-816.33 29103.63,-816.33 29280.48,-952.33"/>
<text text-anchor="middle" x="28848.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="28848.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 176</text>
<text text-anchor="middle" x="28848.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="28848.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp0_ep0&#45;&gt;layer61_dispatch_dp1_tp0_ep0 -->
<g id="edge724" class="edge">
<title>layer61_gate_dp1_tp0_ep0&#45;&gt;layer61_dispatch_dp1_tp0_ep0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M28868.28,-988.14C28866.65,-979.74 28864.97,-971.09 28863.32,-962.55"/>
<polygon fill="black" stroke="black" points="28866.72,-961.74 28861.38,-952.59 28859.85,-963.07 28866.72,-961.74"/>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep0 -->
<g id="node601" class="node">
<title>layer61_expert_mlp_dp1_tp0_ep0</title>
<polygon fill="lightblue" stroke="black" points="29023.83,-780.33 28672.83,-780.33 28672.83,-712.33 29023.83,-712.33 29023.83,-780.33"/>
<text text-anchor="middle" x="28848.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="28848.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 176</text>
<text text-anchor="middle" x="28848.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="28848.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp0_ep0&#45;&gt;layer61_expert_mlp_dp1_tp0_ep0 -->
<g id="edge725" class="edge">
<title>layer61_dispatch_dp1_tp0_ep0&#45;&gt;layer61_expert_mlp_dp1_tp0_ep0</title>
<path fill="none" stroke="black" d="M28848.33,-816.13C28848.33,-807.38 28848.33,-798.61 28848.33,-790.4"/>
<polygon fill="black" stroke="black" points="28851.83,-790.35 28848.33,-780.35 28844.83,-790.35 28851.83,-790.35"/>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep0 -->
<g id="node602" class="node">
<title>layer61_expert_proj_dp1_tp0_ep0</title>
<polygon fill="lightblue" stroke="black" points="29023.83,-676.33 28672.83,-676.33 28672.83,-608.33 29023.83,-608.33 29023.83,-676.33"/>
<text text-anchor="middle" x="28848.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="28848.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 176</text>
<text text-anchor="middle" x="28848.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="28848.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep0&#45;&gt;layer61_expert_proj_dp1_tp0_ep0 -->
<g id="edge726" class="edge">
<title>layer61_expert_mlp_dp1_tp0_ep0&#45;&gt;layer61_expert_proj_dp1_tp0_ep0</title>
<path fill="none" stroke="black" d="M28848.33,-712.22C28848.33,-704.11 28848.33,-695.32 28848.33,-686.81"/>
<polygon fill="black" stroke="black" points="28851.83,-686.63 28848.33,-676.63 28844.83,-686.63 28851.83,-686.63"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep0 -->
<g id="node603" class="node">
<title>layer61_expert_allreduce_dp1_tp0_ep0</title>
<ellipse fill="lightyellow" stroke="black" cx="28848.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="28848.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="28848.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 176</text>
<text text-anchor="middle" x="28848.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="28848.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep0&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep0 -->
<g id="edge727" class="edge">
<title>layer61_expert_proj_dp1_tp0_ep0&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep0</title>
<path fill="none" stroke="black" d="M28848.33,-608.07C28848.33,-600.07 28848.33,-591.31 28848.33,-582.57"/>
<polygon fill="black" stroke="black" points="28851.83,-582.36 28848.33,-572.36 28844.83,-582.36 28851.83,-582.36"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep0 -->
<g id="node604" class="node">
<title>layer61_aggregate_dp1_tp0_ep0</title>
<polygon fill="lightpink" stroke="black" points="29214.27,-440.17 28632.13,-440.17 28482.38,-304.17 29064.52,-304.17 29214.27,-440.17"/>
<text text-anchor="middle" x="28848.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="28848.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 176</text>
<text text-anchor="middle" x="28848.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="28848.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep0&#45;&gt;layer61_aggregate_dp1_tp0_ep0 -->
<g id="edge728" class="edge">
<title>layer61_expert_allreduce_dp1_tp0_ep0&#45;&gt;layer61_aggregate_dp1_tp0_ep0</title>
<path fill="none" stroke="black" d="M28848.33,-475.76C28848.33,-467.68 28848.33,-459.09 28848.33,-450.47"/>
<polygon fill="black" stroke="black" points="28851.83,-450.36 28848.33,-440.36 28844.83,-450.36 28851.83,-450.36"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep0&#45;&gt;output_agg -->
<g id="edge947" class="edge">
<title>layer61_aggregate_dp1_tp0_ep0&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M28700.39,-304.1C28677.42,-293.69 28653.62,-282.9 28630.46,-272.4"/>
<polygon fill="black" stroke="black" points="28631.83,-269.18 28621.28,-268.24 28628.94,-275.55 28631.83,-269.18"/>
</g>
<!-- layer61_dispatch_dp1_tp0_ep1 -->
<g id="node606" class="node">
<title>layer61_dispatch_dp1_tp0_ep1</title>
<polygon fill="lightgreen" stroke="black" points="30163.48,-952.33 29476.02,-952.33 29299.17,-816.33 29986.63,-816.33 30163.48,-952.33"/>
<text text-anchor="middle" x="29731.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="29731.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 177</text>
<text text-anchor="middle" x="29731.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="29731.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp0_ep1&#45;&gt;layer61_dispatch_dp1_tp0_ep1 -->
<g id="edge730" class="edge">
<title>layer61_gate_dp1_tp0_ep1&#45;&gt;layer61_dispatch_dp1_tp0_ep1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29761.56,-988.14C29759.07,-979.65 29756.49,-970.9 29753.95,-962.27"/>
<polygon fill="black" stroke="black" points="29757.29,-961.2 29751.11,-952.59 29750.57,-963.17 29757.29,-961.2"/>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep1 -->
<g id="node607" class="node">
<title>layer61_expert_mlp_dp1_tp0_ep1</title>
<polygon fill="lightblue" stroke="black" points="29897.83,-780.33 29546.83,-780.33 29546.83,-712.33 29897.83,-712.33 29897.83,-780.33"/>
<text text-anchor="middle" x="29722.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="29722.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 177</text>
<text text-anchor="middle" x="29722.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="29722.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp0_ep1&#45;&gt;layer61_expert_mlp_dp1_tp0_ep1 -->
<g id="edge731" class="edge">
<title>layer61_dispatch_dp1_tp0_ep1&#45;&gt;layer61_expert_mlp_dp1_tp0_ep1</title>
<path fill="none" stroke="black" d="M29726.88,-816.13C29726.3,-807.38 29725.72,-798.61 29725.18,-790.4"/>
<polygon fill="black" stroke="black" points="29728.66,-790.1 29724.51,-780.35 29721.68,-790.56 29728.66,-790.1"/>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep1 -->
<g id="node608" class="node">
<title>layer61_expert_proj_dp1_tp0_ep1</title>
<polygon fill="lightblue" stroke="black" points="29864.83,-676.33 29513.83,-676.33 29513.83,-608.33 29864.83,-608.33 29864.83,-676.33"/>
<text text-anchor="middle" x="29689.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="29689.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 177</text>
<text text-anchor="middle" x="29689.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="29689.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep1&#45;&gt;layer61_expert_proj_dp1_tp0_ep1 -->
<g id="edge732" class="edge">
<title>layer61_expert_mlp_dp1_tp0_ep1&#45;&gt;layer61_expert_proj_dp1_tp0_ep1</title>
<path fill="none" stroke="black" d="M29711.61,-712.22C29708.93,-703.93 29706.02,-694.93 29703.21,-686.24"/>
<polygon fill="black" stroke="black" points="29706.51,-685.07 29700.1,-676.63 29699.85,-687.22 29706.51,-685.07"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep1 -->
<g id="node609" class="node">
<title>layer61_expert_allreduce_dp1_tp0_ep1</title>
<ellipse fill="lightyellow" stroke="black" cx="29672.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="29672.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="29672.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 177</text>
<text text-anchor="middle" x="29672.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="29672.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep1&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep1 -->
<g id="edge733" class="edge">
<title>layer61_expert_proj_dp1_tp0_ep1&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep1</title>
<path fill="none" stroke="black" d="M29684.45,-608.07C29683.27,-599.99 29681.97,-591.12 29680.68,-582.28"/>
<polygon fill="black" stroke="black" points="29684.14,-581.75 29679.23,-572.36 29677.21,-582.76 29684.14,-581.75"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep1 -->
<g id="node610" class="node">
<title>layer61_aggregate_dp1_tp0_ep1</title>
<polygon fill="lightpink" stroke="black" points="30030.27,-440.17 29448.13,-440.17 29298.38,-304.17 29880.52,-304.17 30030.27,-440.17"/>
<text text-anchor="middle" x="29664.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="29664.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 177</text>
<text text-anchor="middle" x="29664.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="29664.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep1&#45;&gt;layer61_aggregate_dp1_tp0_ep1 -->
<g id="edge734" class="edge">
<title>layer61_expert_allreduce_dp1_tp0_ep1&#45;&gt;layer61_aggregate_dp1_tp0_ep1</title>
<path fill="none" stroke="black" d="M29669.79,-475.76C29669.36,-467.68 29668.91,-459.09 29668.45,-450.47"/>
<polygon fill="black" stroke="black" points="29671.94,-450.16 29667.91,-440.36 29664.95,-450.53 29671.94,-450.16"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep1&#45;&gt;output_agg -->
<g id="edge948" class="edge">
<title>layer61_aggregate_dp1_tp0_ep1&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M29312.65,-317.28C29282.45,-312.79 29252.35,-308.36 29223.33,-304.17 29097.31,-285.94 28959.27,-266.76 28836.34,-249.96"/>
<polygon fill="black" stroke="black" points="28836.77,-246.48 28826.39,-248.6 28835.83,-253.42 28836.77,-246.48"/>
</g>
<!-- layer61_dispatch_dp1_tp0_ep2 -->
<g id="node612" class="node">
<title>layer61_dispatch_dp1_tp0_ep2</title>
<polygon fill="lightgreen" stroke="black" points="31046.48,-952.33 30359.02,-952.33 30182.17,-816.33 30869.63,-816.33 31046.48,-952.33"/>
<text text-anchor="middle" x="30614.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="30614.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 178</text>
<text text-anchor="middle" x="30614.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="30614.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp0_ep2&#45;&gt;layer61_dispatch_dp1_tp0_ep2 -->
<g id="edge736" class="edge">
<title>layer61_gate_dp1_tp0_ep2&#45;&gt;layer61_dispatch_dp1_tp0_ep2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30654.85,-988.14C30651.46,-979.56 30647.98,-970.72 30644.54,-961.99"/>
<polygon fill="black" stroke="black" points="30647.76,-960.61 30640.83,-952.59 30641.24,-963.18 30647.76,-960.61"/>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep2 -->
<g id="node613" class="node">
<title>layer61_expert_mlp_dp1_tp0_ep2</title>
<polygon fill="lightblue" stroke="black" points="30786.83,-780.33 30435.83,-780.33 30435.83,-712.33 30786.83,-712.33 30786.83,-780.33"/>
<text text-anchor="middle" x="30611.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="30611.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 178</text>
<text text-anchor="middle" x="30611.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="30611.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp0_ep2&#45;&gt;layer61_expert_mlp_dp1_tp0_ep2 -->
<g id="edge737" class="edge">
<title>layer61_dispatch_dp1_tp0_ep2&#45;&gt;layer61_expert_mlp_dp1_tp0_ep2</title>
<path fill="none" stroke="black" d="M30612.84,-816.13C30612.65,-807.38 30612.46,-798.61 30612.28,-790.4"/>
<polygon fill="black" stroke="black" points="30615.77,-790.27 30612.05,-780.35 30608.78,-790.42 30615.77,-790.27"/>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep2 -->
<g id="node614" class="node">
<title>layer61_expert_proj_dp1_tp0_ep2</title>
<polygon fill="lightblue" stroke="black" points="30776.83,-676.33 30425.83,-676.33 30425.83,-608.33 30776.83,-608.33 30776.83,-676.33"/>
<text text-anchor="middle" x="30601.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="30601.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 178</text>
<text text-anchor="middle" x="30601.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="30601.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep2&#45;&gt;layer61_expert_proj_dp1_tp0_ep2 -->
<g id="edge738" class="edge">
<title>layer61_expert_mlp_dp1_tp0_ep2&#45;&gt;layer61_expert_proj_dp1_tp0_ep2</title>
<path fill="none" stroke="black" d="M30608.08,-712.22C30607.28,-704.11 30606.42,-695.32 30605.59,-686.81"/>
<polygon fill="black" stroke="black" points="30609.05,-686.24 30604.59,-676.63 30602.08,-686.93 30609.05,-686.24"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep2 -->
<g id="node615" class="node">
<title>layer61_expert_allreduce_dp1_tp0_ep2</title>
<ellipse fill="lightyellow" stroke="black" cx="30596.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="30596.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="30596.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 178</text>
<text text-anchor="middle" x="30596.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="30596.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep2&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep2 -->
<g id="edge739" class="edge">
<title>layer61_expert_proj_dp1_tp0_ep2&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep2</title>
<path fill="none" stroke="black" d="M30599.89,-608.07C30599.55,-600.07 30599.17,-591.31 30598.79,-582.57"/>
<polygon fill="black" stroke="black" points="30602.28,-582.2 30598.36,-572.36 30595.29,-582.5 30602.28,-582.2"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep2 -->
<g id="node616" class="node">
<title>layer61_aggregate_dp1_tp0_ep2</title>
<polygon fill="lightpink" stroke="black" points="30821.27,-440.17 30239.13,-440.17 30089.38,-304.17 30671.52,-304.17 30821.27,-440.17"/>
<text text-anchor="middle" x="30455.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="30455.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 178</text>
<text text-anchor="middle" x="30455.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="30455.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep2&#45;&gt;layer61_aggregate_dp1_tp0_ep2 -->
<g id="edge740" class="edge">
<title>layer61_expert_allreduce_dp1_tp0_ep2&#45;&gt;layer61_aggregate_dp1_tp0_ep2</title>
<path fill="none" stroke="black" d="M30552.49,-476.59C30543.85,-467.4 30534.6,-457.54 30525.35,-447.7"/>
<polygon fill="black" stroke="black" points="30527.69,-445.08 30518.29,-440.19 30522.59,-449.87 30527.69,-445.08"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep2&#45;&gt;output_agg -->
<g id="edge949" class="edge">
<title>layer61_aggregate_dp1_tp0_ep2&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M30097.09,-311.28C30077.58,-308.7 30058.23,-306.31 30039.33,-304.17 29610.97,-255.69 29113.92,-227.79 28796.71,-213.55"/>
<polygon fill="black" stroke="black" points="28796.59,-210.04 28786.44,-213.09 28796.28,-217.04 28796.59,-210.04"/>
</g>
<!-- layer61_dispatch_dp1_tp0_ep3 -->
<g id="node618" class="node">
<title>layer61_dispatch_dp1_tp0_ep3</title>
<polygon fill="lightgreen" stroke="black" points="31929.48,-952.33 31242.02,-952.33 31065.17,-816.33 31752.63,-816.33 31929.48,-952.33"/>
<text text-anchor="middle" x="31497.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="31497.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 179</text>
<text text-anchor="middle" x="31497.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="31497.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp0_ep3&#45;&gt;layer61_dispatch_dp1_tp0_ep3 -->
<g id="edge742" class="edge">
<title>layer61_gate_dp1_tp0_ep3&#45;&gt;layer61_dispatch_dp1_tp0_ep3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M31537.85,-988.14C31534.46,-979.56 31530.98,-970.72 31527.54,-961.99"/>
<polygon fill="black" stroke="black" points="31530.76,-960.61 31523.83,-952.59 31524.24,-963.18 31530.76,-960.61"/>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep3 -->
<g id="node619" class="node">
<title>layer61_expert_mlp_dp1_tp0_ep3</title>
<polygon fill="lightblue" stroke="black" points="31607.83,-780.33 31256.83,-780.33 31256.83,-712.33 31607.83,-712.33 31607.83,-780.33"/>
<text text-anchor="middle" x="31432.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="31432.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 179</text>
<text text-anchor="middle" x="31432.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="31432.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp0_ep3&#45;&gt;layer61_expert_mlp_dp1_tp0_ep3 -->
<g id="edge743" class="edge">
<title>layer61_dispatch_dp1_tp0_ep3&#45;&gt;layer61_expert_mlp_dp1_tp0_ep3</title>
<path fill="none" stroke="black" d="M31465.21,-816.13C31460.88,-807.09 31456.55,-798.02 31452.52,-789.58"/>
<polygon fill="black" stroke="black" points="31455.58,-787.86 31448.11,-780.35 31449.26,-790.88 31455.58,-787.86"/>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep3 -->
<g id="node620" class="node">
<title>layer61_expert_proj_dp1_tp0_ep3</title>
<polygon fill="lightblue" stroke="black" points="31471.83,-676.33 31120.83,-676.33 31120.83,-608.33 31471.83,-608.33 31471.83,-676.33"/>
<text text-anchor="middle" x="31296.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="31296.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 179</text>
<text text-anchor="middle" x="31296.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="31296.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep3&#45;&gt;layer61_expert_proj_dp1_tp0_ep3 -->
<g id="edge744" class="edge">
<title>layer61_expert_mlp_dp1_tp0_ep3&#45;&gt;layer61_expert_proj_dp1_tp0_ep3</title>
<path fill="none" stroke="black" d="M31388.17,-712.22C31375.7,-702.86 31362.01,-692.59 31349.08,-682.9"/>
<polygon fill="black" stroke="black" points="31350.83,-679.83 31340.73,-676.63 31346.63,-685.43 31350.83,-679.83"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep3 -->
<g id="node621" class="node">
<title>layer61_expert_allreduce_dp1_tp0_ep3</title>
<ellipse fill="lightyellow" stroke="black" cx="31228.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="31228.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="31228.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 179</text>
<text text-anchor="middle" x="31228.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="31228.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep3&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep3 -->
<g id="edge745" class="edge">
<title>layer61_expert_proj_dp1_tp0_ep3&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep3</title>
<path fill="none" stroke="black" d="M31276.84,-608.07C31271.9,-599.64 31266.46,-590.35 31261.07,-581.14"/>
<polygon fill="black" stroke="black" points="31264,-579.22 31255.92,-572.36 31257.96,-582.76 31264,-579.22"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep3 -->
<g id="node622" class="node">
<title>layer61_aggregate_dp1_tp0_ep3</title>
<polygon fill="lightpink" stroke="black" points="31591.27,-440.17 31009.13,-440.17 30859.38,-304.17 31441.52,-304.17 31591.27,-440.17"/>
<text text-anchor="middle" x="31225.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="31225.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 179</text>
<text text-anchor="middle" x="31225.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="31225.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep3&#45;&gt;layer61_aggregate_dp1_tp0_ep3 -->
<g id="edge746" class="edge">
<title>layer61_expert_allreduce_dp1_tp0_ep3&#45;&gt;layer61_aggregate_dp1_tp0_ep3</title>
<path fill="none" stroke="black" d="M31227.38,-475.76C31227.22,-467.68 31227.04,-459.09 31226.87,-450.47"/>
<polygon fill="black" stroke="black" points="31230.37,-450.29 31226.67,-440.36 31223.37,-450.43 31230.37,-450.29"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep3&#45;&gt;output_agg -->
<g id="edge950" class="edge">
<title>layer61_aggregate_dp1_tp0_ep3&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M30863.41,-307.95C30852.27,-306.59 30841.22,-305.32 30830.33,-304.17 30099.96,-226.57 29236.31,-207.14 28784.46,-202.47"/>
<polygon fill="black" stroke="black" points="28784.23,-198.97 28774.2,-202.36 28784.16,-205.97 28784.23,-198.97"/>
</g>
<!-- layer61_dispatch_dp1_tp0_ep4 -->
<g id="node624" class="node">
<title>layer61_dispatch_dp1_tp0_ep4</title>
<polygon fill="lightgreen" stroke="black" points="32812.48,-952.33 32125.02,-952.33 31948.17,-816.33 32635.63,-816.33 32812.48,-952.33"/>
<text text-anchor="middle" x="32380.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="32380.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 180</text>
<text text-anchor="middle" x="32380.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="32380.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp0_ep4&#45;&gt;layer61_dispatch_dp1_tp0_ep4 -->
<g id="edge748" class="edge">
<title>layer61_gate_dp1_tp0_ep4&#45;&gt;layer61_dispatch_dp1_tp0_ep4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32400.28,-988.14C32398.65,-979.74 32396.97,-971.09 32395.32,-962.55"/>
<polygon fill="black" stroke="black" points="32398.72,-961.74 32393.38,-952.59 32391.85,-963.07 32398.72,-961.74"/>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep4 -->
<g id="node625" class="node">
<title>layer61_expert_mlp_dp1_tp0_ep4</title>
<polygon fill="lightblue" stroke="black" points="32529.83,-780.33 32178.83,-780.33 32178.83,-712.33 32529.83,-712.33 32529.83,-780.33"/>
<text text-anchor="middle" x="32354.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="32354.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 180</text>
<text text-anchor="middle" x="32354.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="32354.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp0_ep4&#45;&gt;layer61_expert_mlp_dp1_tp0_ep4 -->
<g id="edge749" class="edge">
<title>layer61_dispatch_dp1_tp0_ep4&#45;&gt;layer61_expert_mlp_dp1_tp0_ep4</title>
<path fill="none" stroke="black" d="M32367.48,-816.13C32365.81,-807.38 32364.13,-798.61 32362.56,-790.4"/>
<polygon fill="black" stroke="black" points="32365.95,-789.51 32360.64,-780.35 32359.08,-790.83 32365.95,-789.51"/>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep4 -->
<g id="node626" class="node">
<title>layer61_expert_proj_dp1_tp0_ep4</title>
<polygon fill="lightblue" stroke="black" points="32428.83,-676.33 32077.83,-676.33 32077.83,-608.33 32428.83,-608.33 32428.83,-676.33"/>
<text text-anchor="middle" x="32253.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="32253.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 180</text>
<text text-anchor="middle" x="32253.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="32253.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep4&#45;&gt;layer61_expert_proj_dp1_tp0_ep4 -->
<g id="edge750" class="edge">
<title>layer61_expert_mlp_dp1_tp0_ep4&#45;&gt;layer61_expert_proj_dp1_tp0_ep4</title>
<path fill="none" stroke="black" d="M32321.53,-712.22C32312.63,-703.22 32302.88,-693.37 32293.61,-684.01"/>
<polygon fill="black" stroke="black" points="32295.82,-681.28 32286.3,-676.63 32290.85,-686.2 32295.82,-681.28"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep4 -->
<g id="node627" class="node">
<title>layer61_expert_allreduce_dp1_tp0_ep4</title>
<ellipse fill="lightyellow" stroke="black" cx="32202.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="32202.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="32202.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 180</text>
<text text-anchor="middle" x="32202.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="32202.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep4&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep4 -->
<g id="edge751" class="edge">
<title>layer61_expert_proj_dp1_tp0_ep4&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep4</title>
<path fill="none" stroke="black" d="M32238.71,-608.07C32235.09,-599.81 32231.1,-590.74 32227.13,-581.71"/>
<polygon fill="black" stroke="black" points="32230.25,-580.11 32223.02,-572.36 32223.84,-582.92 32230.25,-580.11"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep4 -->
<g id="node628" class="node">
<title>layer61_aggregate_dp1_tp0_ep4</title>
<polygon fill="lightpink" stroke="black" points="32543.27,-440.17 31961.13,-440.17 31811.38,-304.17 32393.52,-304.17 32543.27,-440.17"/>
<text text-anchor="middle" x="32177.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="32177.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 180</text>
<text text-anchor="middle" x="32177.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="32177.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep4&#45;&gt;layer61_aggregate_dp1_tp0_ep4 -->
<g id="edge752" class="edge">
<title>layer61_expert_allreduce_dp1_tp0_ep4&#45;&gt;layer61_aggregate_dp1_tp0_ep4</title>
<path fill="none" stroke="black" d="M32194.48,-476.17C32193.11,-467.93 32191.65,-459.16 32190.18,-450.35"/>
<polygon fill="black" stroke="black" points="32193.62,-449.7 32188.53,-440.41 32186.72,-450.85 32193.62,-449.7"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep4&#45;&gt;output_agg -->
<g id="edge951" class="edge">
<title>layer61_aggregate_dp1_tp0_ep4&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M31836.05,-326.81C31758.66,-318.07 31676.76,-309.85 31600.33,-304.17 30571.53,-227.62 29348.1,-207.96 28785.11,-202.91"/>
<polygon fill="black" stroke="black" points="28784.84,-199.41 28774.81,-202.82 28784.78,-206.41 28784.84,-199.41"/>
</g>
<!-- layer61_dispatch_dp1_tp0_ep5 -->
<g id="node630" class="node">
<title>layer61_dispatch_dp1_tp0_ep5</title>
<polygon fill="lightgreen" stroke="black" points="33695.48,-952.33 33008.02,-952.33 32831.17,-816.33 33518.63,-816.33 33695.48,-952.33"/>
<text text-anchor="middle" x="33263.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="33263.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 181</text>
<text text-anchor="middle" x="33263.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="33263.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp0_ep5&#45;&gt;layer61_dispatch_dp1_tp0_ep5 -->
<g id="edge754" class="edge">
<title>layer61_gate_dp1_tp0_ep5&#45;&gt;layer61_dispatch_dp1_tp0_ep5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33293.56,-988.14C33291.07,-979.65 33288.49,-970.9 33285.95,-962.27"/>
<polygon fill="black" stroke="black" points="33289.29,-961.2 33283.11,-952.59 33282.57,-963.17 33289.29,-961.2"/>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep5 -->
<g id="node631" class="node">
<title>layer61_expert_mlp_dp1_tp0_ep5</title>
<polygon fill="lightblue" stroke="black" points="33417.83,-780.33 33066.83,-780.33 33066.83,-712.33 33417.83,-712.33 33417.83,-780.33"/>
<text text-anchor="middle" x="33242.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="33242.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 181</text>
<text text-anchor="middle" x="33242.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="33242.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp0_ep5&#45;&gt;layer61_expert_mlp_dp1_tp0_ep5 -->
<g id="edge755" class="edge">
<title>layer61_dispatch_dp1_tp0_ep5&#45;&gt;layer61_expert_mlp_dp1_tp0_ep5</title>
<path fill="none" stroke="black" d="M33252.95,-816.13C33251.6,-807.38 33250.24,-798.61 33248.98,-790.4"/>
<polygon fill="black" stroke="black" points="33252.41,-789.7 33247.42,-780.35 33245.49,-790.77 33252.41,-789.7"/>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep5 -->
<g id="node632" class="node">
<title>layer61_expert_proj_dp1_tp0_ep5</title>
<polygon fill="lightblue" stroke="black" points="33333.83,-676.33 32982.83,-676.33 32982.83,-608.33 33333.83,-608.33 33333.83,-676.33"/>
<text text-anchor="middle" x="33158.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="33158.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 181</text>
<text text-anchor="middle" x="33158.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="33158.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep5&#45;&gt;layer61_expert_proj_dp1_tp0_ep5 -->
<g id="edge756" class="edge">
<title>layer61_expert_mlp_dp1_tp0_ep5&#45;&gt;layer61_expert_proj_dp1_tp0_ep5</title>
<path fill="none" stroke="black" d="M33215.05,-712.22C33207.79,-703.4 33199.86,-693.76 33192.28,-684.57"/>
<polygon fill="black" stroke="black" points="33194.81,-682.13 33185.75,-676.63 33189.4,-686.58 33194.81,-682.13"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep5 -->
<g id="node633" class="node">
<title>layer61_expert_allreduce_dp1_tp0_ep5</title>
<ellipse fill="lightyellow" stroke="black" cx="33116.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="33116.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="33116.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 181</text>
<text text-anchor="middle" x="33116.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="33116.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep5&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep5 -->
<g id="edge757" class="edge">
<title>layer61_expert_proj_dp1_tp0_ep5&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep5</title>
<path fill="none" stroke="black" d="M33146.29,-608.07C33143.34,-599.9 33140.09,-590.93 33136.86,-582"/>
<polygon fill="black" stroke="black" points="33140.06,-580.57 33133.37,-572.36 33133.48,-582.95 33140.06,-580.57"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep5 -->
<g id="node634" class="node">
<title>layer61_aggregate_dp1_tp0_ep5</title>
<polygon fill="lightpink" stroke="black" points="33461.27,-440.17 32879.13,-440.17 32729.38,-304.17 33311.52,-304.17 33461.27,-440.17"/>
<text text-anchor="middle" x="33095.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="33095.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 181</text>
<text text-anchor="middle" x="33095.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="33095.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep5&#45;&gt;layer61_aggregate_dp1_tp0_ep5 -->
<g id="edge758" class="edge">
<title>layer61_expert_allreduce_dp1_tp0_ep5&#45;&gt;layer61_aggregate_dp1_tp0_ep5</title>
<path fill="none" stroke="black" d="M33109.74,-476.17C33108.59,-467.93 33107.36,-459.16 33106.13,-450.35"/>
<polygon fill="black" stroke="black" points="33109.59,-449.83 33104.74,-440.41 33102.65,-450.8 33109.59,-449.83"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep5&#45;&gt;output_agg -->
<g id="edge952" class="edge">
<title>layer61_aggregate_dp1_tp0_ep5&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M32750.4,-323.48C32684.74,-315.86 32616.5,-308.92 32552.33,-304.17 31822.21,-250.03 29611.87,-216.17 28787.64,-205.13"/>
<polygon fill="black" stroke="black" points="28787.46,-201.63 28777.41,-205 28787.36,-208.63 28787.46,-201.63"/>
</g>
<!-- layer61_dispatch_dp1_tp0_ep6 -->
<g id="node636" class="node">
<title>layer61_dispatch_dp1_tp0_ep6</title>
<polygon fill="lightgreen" stroke="black" points="34578.48,-952.33 33891.02,-952.33 33714.17,-816.33 34401.63,-816.33 34578.48,-952.33"/>
<text text-anchor="middle" x="34146.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="34146.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 182</text>
<text text-anchor="middle" x="34146.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="34146.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp0_ep6&#45;&gt;layer61_dispatch_dp1_tp0_ep6 -->
<g id="edge760" class="edge">
<title>layer61_gate_dp1_tp0_ep6&#45;&gt;layer61_dispatch_dp1_tp0_ep6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34207.41,-988.14C34202.2,-979.37 34196.83,-970.34 34191.54,-961.44"/>
<polygon fill="black" stroke="black" points="34194.4,-959.4 34186.28,-952.59 34188.38,-962.98 34194.4,-959.4"/>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep6 -->
<g id="node637" class="node">
<title>layer61_expert_mlp_dp1_tp0_ep6</title>
<polygon fill="lightblue" stroke="black" points="34302.83,-780.33 33951.83,-780.33 33951.83,-712.33 34302.83,-712.33 34302.83,-780.33"/>
<text text-anchor="middle" x="34127.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="34127.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 182</text>
<text text-anchor="middle" x="34127.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="34127.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp0_ep6&#45;&gt;layer61_expert_mlp_dp1_tp0_ep6 -->
<g id="edge761" class="edge">
<title>layer61_dispatch_dp1_tp0_ep6&#45;&gt;layer61_expert_mlp_dp1_tp0_ep6</title>
<path fill="none" stroke="black" d="M34136.94,-816.13C34135.71,-807.38 34134.49,-798.61 34133.34,-790.4"/>
<polygon fill="black" stroke="black" points="34136.79,-789.77 34131.94,-780.35 34129.86,-790.74 34136.79,-789.77"/>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep6 -->
<g id="node638" class="node">
<title>layer61_expert_proj_dp1_tp0_ep6</title>
<polygon fill="lightblue" stroke="black" points="34227.83,-676.33 33876.83,-676.33 33876.83,-608.33 34227.83,-608.33 34227.83,-676.33"/>
<text text-anchor="middle" x="34052.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="34052.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 182</text>
<text text-anchor="middle" x="34052.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="34052.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep6&#45;&gt;layer61_expert_proj_dp1_tp0_ep6 -->
<g id="edge762" class="edge">
<title>layer61_expert_mlp_dp1_tp0_ep6&#45;&gt;layer61_expert_proj_dp1_tp0_ep6</title>
<path fill="none" stroke="black" d="M34102.98,-712.22C34096.56,-703.49 34089.55,-693.96 34082.85,-684.85"/>
<polygon fill="black" stroke="black" points="34085.55,-682.62 34076.81,-676.63 34079.92,-686.76 34085.55,-682.62"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep6 -->
<g id="node639" class="node">
<title>layer61_expert_allreduce_dp1_tp0_ep6</title>
<ellipse fill="lightyellow" stroke="black" cx="34014.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="34014.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="34014.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 182</text>
<text text-anchor="middle" x="34014.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="34014.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep6&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep6 -->
<g id="edge763" class="edge">
<title>layer61_expert_proj_dp1_tp0_ep6&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep6</title>
<path fill="none" stroke="black" d="M34041.44,-608.07C34038.76,-599.9 34035.83,-590.93 34032.9,-582"/>
<polygon fill="black" stroke="black" points="34036.18,-580.77 34029.75,-572.36 34029.53,-582.95 34036.18,-580.77"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep6 -->
<g id="node640" class="node">
<title>layer61_aggregate_dp1_tp0_ep6</title>
<polygon fill="lightpink" stroke="black" points="34361.27,-440.17 33779.13,-440.17 33629.38,-304.17 34211.52,-304.17 34361.27,-440.17"/>
<text text-anchor="middle" x="33995.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="33995.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 182</text>
<text text-anchor="middle" x="33995.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="33995.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep6&#45;&gt;layer61_aggregate_dp1_tp0_ep6 -->
<g id="edge764" class="edge">
<title>layer61_expert_allreduce_dp1_tp0_ep6&#45;&gt;layer61_aggregate_dp1_tp0_ep6</title>
<path fill="none" stroke="black" d="M34008.37,-476.17C34007.32,-467.93 34006.21,-459.16 34005.1,-450.35"/>
<polygon fill="black" stroke="black" points="34008.57,-449.89 34003.84,-440.41 34001.62,-450.77 34008.57,-449.89"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep6&#45;&gt;output_agg -->
<g id="edge953" class="edge">
<title>layer61_aggregate_dp1_tp0_ep6&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M33648.5,-321.62C33589.17,-314.66 33528.06,-308.43 33470.33,-304.17 32553.46,-236.41 29730.69,-210.25 28785.43,-203.25"/>
<polygon fill="black" stroke="black" points="28785.45,-199.75 28775.43,-203.18 28785.4,-206.75 28785.45,-199.75"/>
</g>
<!-- layer61_dispatch_dp1_tp0_ep7 -->
<g id="node642" class="node">
<title>layer61_dispatch_dp1_tp0_ep7</title>
<polygon fill="lightgreen" stroke="black" points="35461.48,-952.33 34774.02,-952.33 34597.17,-816.33 35284.63,-816.33 35461.48,-952.33"/>
<text text-anchor="middle" x="35029.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="35029.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 183</text>
<text text-anchor="middle" x="35029.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="35029.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp0_ep7&#45;&gt;layer61_dispatch_dp1_tp0_ep7 -->
<g id="edge766" class="edge">
<title>layer61_gate_dp1_tp0_ep7&#45;&gt;layer61_dispatch_dp1_tp0_ep7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35090.41,-988.14C35085.2,-979.37 35079.83,-970.34 35074.54,-961.44"/>
<polygon fill="black" stroke="black" points="35077.4,-959.4 35069.28,-952.59 35071.38,-962.98 35077.4,-959.4"/>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep7 -->
<g id="node643" class="node">
<title>layer61_expert_mlp_dp1_tp0_ep7</title>
<polygon fill="lightblue" stroke="black" points="35186.83,-780.33 34835.83,-780.33 34835.83,-712.33 35186.83,-712.33 35186.83,-780.33"/>
<text text-anchor="middle" x="35011.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="35011.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 183</text>
<text text-anchor="middle" x="35011.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="35011.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp0_ep7&#45;&gt;layer61_expert_mlp_dp1_tp0_ep7 -->
<g id="edge767" class="edge">
<title>layer61_dispatch_dp1_tp0_ep7&#45;&gt;layer61_expert_mlp_dp1_tp0_ep7</title>
<path fill="none" stroke="black" d="M35020.43,-816.13C35019.27,-807.38 35018.11,-798.61 35017.03,-790.4"/>
<polygon fill="black" stroke="black" points="35020.48,-789.8 35015.7,-780.35 35013.54,-790.72 35020.48,-789.8"/>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep7 -->
<g id="node644" class="node">
<title>layer61_expert_proj_dp1_tp0_ep7</title>
<polygon fill="lightblue" stroke="black" points="35115.83,-676.33 34764.83,-676.33 34764.83,-608.33 35115.83,-608.33 35115.83,-676.33"/>
<text text-anchor="middle" x="34940.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="34940.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 183</text>
<text text-anchor="middle" x="34940.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="34940.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep7&#45;&gt;layer61_expert_proj_dp1_tp0_ep7 -->
<g id="edge768" class="edge">
<title>layer61_expert_mlp_dp1_tp0_ep7&#45;&gt;layer61_expert_proj_dp1_tp0_ep7</title>
<path fill="none" stroke="black" d="M34988.27,-712.22C34982.2,-703.49 34975.56,-693.96 34969.22,-684.85"/>
<polygon fill="black" stroke="black" points="34972.09,-682.84 34963.51,-676.63 34966.35,-686.84 34972.09,-682.84"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep7 -->
<g id="node645" class="node">
<title>layer61_expert_allreduce_dp1_tp0_ep7</title>
<ellipse fill="lightyellow" stroke="black" cx="34905.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="34905.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="34905.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 183</text>
<text text-anchor="middle" x="34905.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="34905.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep7&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep7 -->
<g id="edge769" class="edge">
<title>layer61_expert_proj_dp1_tp0_ep7&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep7</title>
<path fill="none" stroke="black" d="M34930.3,-608.07C34927.83,-599.9 34925.13,-590.93 34922.44,-582"/>
<polygon fill="black" stroke="black" points="34925.77,-580.92 34919.53,-572.36 34919.07,-582.94 34925.77,-580.92"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep7 -->
<g id="node646" class="node">
<title>layer61_aggregate_dp1_tp0_ep7</title>
<polygon fill="lightpink" stroke="black" points="35253.27,-440.17 34671.13,-440.17 34521.38,-304.17 35103.52,-304.17 35253.27,-440.17"/>
<text text-anchor="middle" x="34887.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="34887.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 183</text>
<text text-anchor="middle" x="34887.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="34887.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep7&#45;&gt;layer61_aggregate_dp1_tp0_ep7 -->
<g id="edge770" class="edge">
<title>layer61_expert_allreduce_dp1_tp0_ep7&#45;&gt;layer61_aggregate_dp1_tp0_ep7</title>
<path fill="none" stroke="black" d="M34899.68,-476.17C34898.69,-467.93 34897.64,-459.16 34896.58,-450.35"/>
<polygon fill="black" stroke="black" points="34900.06,-449.92 34895.39,-440.41 34893.11,-450.76 34900.06,-449.92"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep7&#45;&gt;output_agg -->
<g id="edge954" class="edge">
<title>layer61_aggregate_dp1_tp0_ep7&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M34539.55,-320.71C34483.09,-314.07 34425.16,-308.19 34370.33,-304.17 33269.16,-223.45 29838.28,-205.63 28784.41,-202.02"/>
<polygon fill="black" stroke="black" points="28784.04,-198.52 28774.03,-201.99 28784.02,-205.52 28784.04,-198.52"/>
</g>
<!-- layer61_dispatch_dp1_tp0_ep8 -->
<g id="node648" class="node">
<title>layer61_dispatch_dp1_tp0_ep8</title>
<polygon fill="lightgreen" stroke="black" points="36344.48,-952.33 35657.02,-952.33 35480.17,-816.33 36167.63,-816.33 36344.48,-952.33"/>
<text text-anchor="middle" x="35912.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="35912.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 184</text>
<text text-anchor="middle" x="35912.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="35912.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp0_ep8&#45;&gt;layer61_dispatch_dp1_tp0_ep8 -->
<g id="edge772" class="edge">
<title>layer61_gate_dp1_tp0_ep8&#45;&gt;layer61_dispatch_dp1_tp0_ep8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35952.85,-988.14C35949.46,-979.56 35945.98,-970.72 35942.54,-961.99"/>
<polygon fill="black" stroke="black" points="35945.76,-960.61 35938.83,-952.59 35939.24,-963.18 35945.76,-960.61"/>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep8 -->
<g id="node649" class="node">
<title>layer61_expert_mlp_dp1_tp0_ep8</title>
<polygon fill="lightblue" stroke="black" points="36069.83,-780.33 35718.83,-780.33 35718.83,-712.33 36069.83,-712.33 36069.83,-780.33"/>
<text text-anchor="middle" x="35894.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="35894.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 184</text>
<text text-anchor="middle" x="35894.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="35894.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp0_ep8&#45;&gt;layer61_expert_mlp_dp1_tp0_ep8 -->
<g id="edge773" class="edge">
<title>layer61_dispatch_dp1_tp0_ep8&#45;&gt;layer61_expert_mlp_dp1_tp0_ep8</title>
<path fill="none" stroke="black" d="M35903.43,-816.13C35902.27,-807.38 35901.11,-798.61 35900.03,-790.4"/>
<polygon fill="black" stroke="black" points="35903.48,-789.8 35898.7,-780.35 35896.54,-790.72 35903.48,-789.8"/>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep8 -->
<g id="node650" class="node">
<title>layer61_expert_proj_dp1_tp0_ep8</title>
<polygon fill="lightblue" stroke="black" points="36000.83,-676.33 35649.83,-676.33 35649.83,-608.33 36000.83,-608.33 36000.83,-676.33"/>
<text text-anchor="middle" x="35825.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="35825.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 184</text>
<text text-anchor="middle" x="35825.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="35825.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep8&#45;&gt;layer61_expert_proj_dp1_tp0_ep8 -->
<g id="edge774" class="edge">
<title>layer61_expert_mlp_dp1_tp0_ep8&#45;&gt;layer61_expert_proj_dp1_tp0_ep8</title>
<path fill="none" stroke="black" d="M35871.92,-712.22C35866.08,-703.58 35859.7,-694.15 35853.6,-685.13"/>
<polygon fill="black" stroke="black" points="35856.35,-682.95 35847.85,-676.63 35850.56,-686.88 35856.35,-682.95"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep8 -->
<g id="node651" class="node">
<title>layer61_expert_allreduce_dp1_tp0_ep8</title>
<ellipse fill="lightyellow" stroke="black" cx="35791.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="35791.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="35791.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 184</text>
<text text-anchor="middle" x="35791.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="35791.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep8&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep8 -->
<g id="edge775" class="edge">
<title>layer61_expert_proj_dp1_tp0_ep8&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep8</title>
<path fill="none" stroke="black" d="M35815.58,-608.07C35813.19,-599.9 35810.56,-590.93 35807.95,-582"/>
<polygon fill="black" stroke="black" points="35811.29,-580.97 35805.12,-572.36 35804.58,-582.94 35811.29,-580.97"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep8 -->
<g id="node652" class="node">
<title>layer61_aggregate_dp1_tp0_ep8</title>
<polygon fill="lightpink" stroke="black" points="36140.27,-440.17 35558.13,-440.17 35408.38,-304.17 35990.52,-304.17 36140.27,-440.17"/>
<text text-anchor="middle" x="35774.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="35774.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 184</text>
<text text-anchor="middle" x="35774.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="35774.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep8&#45;&gt;layer61_aggregate_dp1_tp0_ep8 -->
<g id="edge776" class="edge">
<title>layer61_expert_allreduce_dp1_tp0_ep8&#45;&gt;layer61_aggregate_dp1_tp0_ep8</title>
<path fill="none" stroke="black" d="M35785.99,-476.17C35785.06,-467.93 35784.07,-459.16 35783.07,-450.35"/>
<polygon fill="black" stroke="black" points="35786.55,-449.96 35781.94,-440.41 35779.59,-450.74 35786.55,-449.96"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep8&#45;&gt;output_agg -->
<g id="edge955" class="edge">
<title>layer61_aggregate_dp1_tp0_ep8&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M35425.78,-320.1C35371.18,-313.68 35315.3,-308.02 35262.33,-304.17 33977.27,-210.65 29936.34,-201.74 28783.29,-201.13"/>
<polygon fill="black" stroke="black" points="28783.2,-197.63 28773.2,-201.13 28783.2,-204.63 28783.2,-197.63"/>
</g>
<!-- layer61_dispatch_dp1_tp0_ep9 -->
<g id="node654" class="node">
<title>layer61_dispatch_dp1_tp0_ep9</title>
<polygon fill="lightgreen" stroke="black" points="37227.48,-952.33 36540.02,-952.33 36363.17,-816.33 37050.63,-816.33 37227.48,-952.33"/>
<text text-anchor="middle" x="36795.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="36795.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 185</text>
<text text-anchor="middle" x="36795.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="36795.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp0_ep9&#45;&gt;layer61_dispatch_dp1_tp0_ep9 -->
<g id="edge778" class="edge">
<title>layer61_gate_dp1_tp0_ep9&#45;&gt;layer61_dispatch_dp1_tp0_ep9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36835.85,-988.14C36832.46,-979.56 36828.98,-970.72 36825.54,-961.99"/>
<polygon fill="black" stroke="black" points="36828.76,-960.61 36821.83,-952.59 36822.24,-963.18 36828.76,-960.61"/>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep9 -->
<g id="node655" class="node">
<title>layer61_expert_mlp_dp1_tp0_ep9</title>
<polygon fill="lightblue" stroke="black" points="36953.83,-780.33 36602.83,-780.33 36602.83,-712.33 36953.83,-712.33 36953.83,-780.33"/>
<text text-anchor="middle" x="36778.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="36778.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 185</text>
<text text-anchor="middle" x="36778.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="36778.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp0_ep9&#45;&gt;layer61_expert_mlp_dp1_tp0_ep9 -->
<g id="edge779" class="edge">
<title>layer61_dispatch_dp1_tp0_ep9&#45;&gt;layer61_expert_mlp_dp1_tp0_ep9</title>
<path fill="none" stroke="black" d="M36786.93,-816.13C36785.83,-807.38 36784.74,-798.61 36783.71,-790.4"/>
<polygon fill="black" stroke="black" points="36787.17,-789.84 36782.45,-780.35 36780.22,-790.71 36787.17,-789.84"/>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep9 -->
<g id="node656" class="node">
<title>layer61_expert_proj_dp1_tp0_ep9</title>
<polygon fill="lightblue" stroke="black" points="36885.83,-676.33 36534.83,-676.33 36534.83,-608.33 36885.83,-608.33 36885.83,-676.33"/>
<text text-anchor="middle" x="36710.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="36710.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 185</text>
<text text-anchor="middle" x="36710.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="36710.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep9&#45;&gt;layer61_expert_proj_dp1_tp0_ep9 -->
<g id="edge780" class="edge">
<title>layer61_expert_mlp_dp1_tp0_ep9&#45;&gt;layer61_expert_proj_dp1_tp0_ep9</title>
<path fill="none" stroke="black" d="M36756.25,-712.22C36750.49,-703.58 36744.21,-694.15 36738.19,-685.13"/>
<polygon fill="black" stroke="black" points="36740.98,-683.01 36732.53,-676.63 36735.16,-686.89 36740.98,-683.01"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep9 -->
<g id="node657" class="node">
<title>layer61_expert_allreduce_dp1_tp0_ep9</title>
<ellipse fill="lightyellow" stroke="black" cx="36676.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="36676.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="36676.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 185</text>
<text text-anchor="middle" x="36676.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="36676.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep9&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep9 -->
<g id="edge781" class="edge">
<title>layer61_expert_proj_dp1_tp0_ep9&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep9</title>
<path fill="none" stroke="black" d="M36700.58,-608.07C36698.19,-599.9 36695.56,-590.93 36692.95,-582"/>
<polygon fill="black" stroke="black" points="36696.29,-580.97 36690.12,-572.36 36689.58,-582.94 36696.29,-580.97"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep9 -->
<g id="node658" class="node">
<title>layer61_aggregate_dp1_tp0_ep9</title>
<polygon fill="lightpink" stroke="black" points="37025.27,-440.17 36443.13,-440.17 36293.38,-304.17 36875.52,-304.17 37025.27,-440.17"/>
<text text-anchor="middle" x="36659.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="36659.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 185</text>
<text text-anchor="middle" x="36659.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="36659.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep9&#45;&gt;layer61_aggregate_dp1_tp0_ep9 -->
<g id="edge782" class="edge">
<title>layer61_expert_allreduce_dp1_tp0_ep9&#45;&gt;layer61_aggregate_dp1_tp0_ep9</title>
<path fill="none" stroke="black" d="M36670.99,-476.17C36670.06,-467.93 36669.07,-459.16 36668.07,-450.35"/>
<polygon fill="black" stroke="black" points="36671.55,-449.96 36666.94,-440.41 36664.59,-450.74 36671.55,-449.96"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep9&#45;&gt;output_agg -->
<g id="edge956" class="edge">
<title>layer61_aggregate_dp1_tp0_ep9&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M36310.43,-319.82C36256.59,-313.49 36201.54,-307.93 36149.33,-304.17 35408.12,-250.69 30131.97,-212.21 28785.5,-203.19"/>
<polygon fill="black" stroke="black" points="28785.22,-199.69 28775.19,-203.12 28785.17,-206.69 28785.22,-199.69"/>
</g>
<!-- layer61_dispatch_dp1_tp0_ep10 -->
<g id="node660" class="node">
<title>layer61_dispatch_dp1_tp0_ep10</title>
<polygon fill="lightgreen" stroke="black" points="38110.48,-952.33 37423.02,-952.33 37246.17,-816.33 37933.63,-816.33 38110.48,-952.33"/>
<text text-anchor="middle" x="37678.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="37678.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 186</text>
<text text-anchor="middle" x="37678.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="37678.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp0_ep10&#45;&gt;layer61_dispatch_dp1_tp0_ep10 -->
<g id="edge784" class="edge">
<title>layer61_gate_dp1_tp0_ep10&#45;&gt;layer61_dispatch_dp1_tp0_ep10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37718.85,-988.14C37715.46,-979.56 37711.98,-970.72 37708.54,-961.99"/>
<polygon fill="black" stroke="black" points="37711.76,-960.61 37704.83,-952.59 37705.24,-963.18 37711.76,-960.61"/>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep10 -->
<g id="node661" class="node">
<title>layer61_expert_mlp_dp1_tp0_ep10</title>
<polygon fill="lightblue" stroke="black" points="37836.83,-780.33 37485.83,-780.33 37485.83,-712.33 37836.83,-712.33 37836.83,-780.33"/>
<text text-anchor="middle" x="37661.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="37661.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 186</text>
<text text-anchor="middle" x="37661.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="37661.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp0_ep10&#45;&gt;layer61_expert_mlp_dp1_tp0_ep10 -->
<g id="edge785" class="edge">
<title>layer61_dispatch_dp1_tp0_ep10&#45;&gt;layer61_expert_mlp_dp1_tp0_ep10</title>
<path fill="none" stroke="black" d="M37669.93,-816.13C37668.83,-807.38 37667.74,-798.61 37666.71,-790.4"/>
<polygon fill="black" stroke="black" points="37670.17,-789.84 37665.45,-780.35 37663.22,-790.71 37670.17,-789.84"/>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep10 -->
<g id="node662" class="node">
<title>layer61_expert_proj_dp1_tp0_ep10</title>
<polygon fill="lightblue" stroke="black" points="37769.83,-676.33 37418.83,-676.33 37418.83,-608.33 37769.83,-608.33 37769.83,-676.33"/>
<text text-anchor="middle" x="37594.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="37594.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 186</text>
<text text-anchor="middle" x="37594.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="37594.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep10&#45;&gt;layer61_expert_proj_dp1_tp0_ep10 -->
<g id="edge786" class="edge">
<title>layer61_expert_mlp_dp1_tp0_ep10&#45;&gt;layer61_expert_proj_dp1_tp0_ep10</title>
<path fill="none" stroke="black" d="M37639.57,-712.22C37633.9,-703.58 37627.71,-694.15 37621.78,-685.13"/>
<polygon fill="black" stroke="black" points="37624.61,-683.07 37616.2,-676.63 37618.76,-686.91 37624.61,-683.07"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep10 -->
<g id="node663" class="node">
<title>layer61_expert_allreduce_dp1_tp0_ep10</title>
<ellipse fill="lightyellow" stroke="black" cx="37560.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="37560.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="37560.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 186</text>
<text text-anchor="middle" x="37560.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="37560.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep10&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep10 -->
<g id="edge787" class="edge">
<title>layer61_expert_proj_dp1_tp0_ep10&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep10</title>
<path fill="none" stroke="black" d="M37584.58,-608.07C37582.19,-599.9 37579.56,-590.93 37576.95,-582"/>
<polygon fill="black" stroke="black" points="37580.29,-580.97 37574.12,-572.36 37573.58,-582.94 37580.29,-580.97"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep10 -->
<g id="node664" class="node">
<title>layer61_aggregate_dp1_tp0_ep10</title>
<polygon fill="lightpink" stroke="black" points="37909.27,-440.17 37327.13,-440.17 37177.38,-304.17 37759.52,-304.17 37909.27,-440.17"/>
<text text-anchor="middle" x="37543.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="37543.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 186</text>
<text text-anchor="middle" x="37543.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="37543.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep10&#45;&gt;layer61_aggregate_dp1_tp0_ep10 -->
<g id="edge788" class="edge">
<title>layer61_expert_allreduce_dp1_tp0_ep10&#45;&gt;layer61_aggregate_dp1_tp0_ep10</title>
<path fill="none" stroke="black" d="M37554.99,-476.17C37554.06,-467.93 37553.07,-459.16 37552.07,-450.35"/>
<polygon fill="black" stroke="black" points="37555.55,-449.96 37550.94,-440.41 37548.59,-450.74 37555.55,-449.96"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep10&#45;&gt;output_agg -->
<g id="edge957" class="edge">
<title>layer61_aggregate_dp1_tp0_ep10&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M37194.44,-319.67C37140.92,-313.39 37086.22,-307.88 37034.33,-304.17 36200.73,-244.5 30224.45,-210.18 28784.74,-202.72"/>
<polygon fill="black" stroke="black" points="28784.53,-199.21 28774.52,-202.66 28784.5,-206.21 28784.53,-199.21"/>
</g>
<!-- layer61_dispatch_dp1_tp0_ep11 -->
<g id="node666" class="node">
<title>layer61_dispatch_dp1_tp0_ep11</title>
<polygon fill="lightgreen" stroke="black" points="38993.48,-952.33 38306.02,-952.33 38129.17,-816.33 38816.63,-816.33 38993.48,-952.33"/>
<text text-anchor="middle" x="38561.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="38561.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 187</text>
<text text-anchor="middle" x="38561.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="38561.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp0_ep11&#45;&gt;layer61_dispatch_dp1_tp0_ep11 -->
<g id="edge790" class="edge">
<title>layer61_gate_dp1_tp0_ep11&#45;&gt;layer61_dispatch_dp1_tp0_ep11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38581.28,-988.14C38579.65,-979.74 38577.97,-971.09 38576.32,-962.55"/>
<polygon fill="black" stroke="black" points="38579.72,-961.74 38574.38,-952.59 38572.85,-963.07 38579.72,-961.74"/>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep11 -->
<g id="node667" class="node">
<title>layer61_expert_mlp_dp1_tp0_ep11</title>
<polygon fill="lightblue" stroke="black" points="38719.83,-780.33 38368.83,-780.33 38368.83,-712.33 38719.83,-712.33 38719.83,-780.33"/>
<text text-anchor="middle" x="38544.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="38544.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 187</text>
<text text-anchor="middle" x="38544.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="38544.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp0_ep11&#45;&gt;layer61_expert_mlp_dp1_tp0_ep11 -->
<g id="edge791" class="edge">
<title>layer61_dispatch_dp1_tp0_ep11&#45;&gt;layer61_expert_mlp_dp1_tp0_ep11</title>
<path fill="none" stroke="black" d="M38552.93,-816.13C38551.83,-807.38 38550.74,-798.61 38549.71,-790.4"/>
<polygon fill="black" stroke="black" points="38553.17,-789.84 38548.45,-780.35 38546.22,-790.71 38553.17,-789.84"/>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep11 -->
<g id="node668" class="node">
<title>layer61_expert_proj_dp1_tp0_ep11</title>
<polygon fill="lightblue" stroke="black" points="38652.83,-676.33 38301.83,-676.33 38301.83,-608.33 38652.83,-608.33 38652.83,-676.33"/>
<text text-anchor="middle" x="38477.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="38477.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 187</text>
<text text-anchor="middle" x="38477.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="38477.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep11&#45;&gt;layer61_expert_proj_dp1_tp0_ep11 -->
<g id="edge792" class="edge">
<title>layer61_expert_mlp_dp1_tp0_ep11&#45;&gt;layer61_expert_proj_dp1_tp0_ep11</title>
<path fill="none" stroke="black" d="M38522.57,-712.22C38516.9,-703.58 38510.71,-694.15 38504.78,-685.13"/>
<polygon fill="black" stroke="black" points="38507.61,-683.07 38499.2,-676.63 38501.76,-686.91 38507.61,-683.07"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep11 -->
<g id="node669" class="node">
<title>layer61_expert_allreduce_dp1_tp0_ep11</title>
<ellipse fill="lightyellow" stroke="black" cx="38444.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="38444.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="38444.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 187</text>
<text text-anchor="middle" x="38444.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="38444.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep11&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep11 -->
<g id="edge793" class="edge">
<title>layer61_expert_proj_dp1_tp0_ep11&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep11</title>
<path fill="none" stroke="black" d="M38467.87,-608.07C38465.55,-599.9 38463,-590.93 38460.46,-582"/>
<polygon fill="black" stroke="black" points="38463.82,-581.02 38457.72,-572.36 38457.09,-582.94 38463.82,-581.02"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep11 -->
<g id="node670" class="node">
<title>layer61_aggregate_dp1_tp0_ep11</title>
<polygon fill="lightpink" stroke="black" points="38793.27,-440.17 38211.13,-440.17 38061.38,-304.17 38643.52,-304.17 38793.27,-440.17"/>
<text text-anchor="middle" x="38427.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="38427.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 187</text>
<text text-anchor="middle" x="38427.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="38427.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep11&#45;&gt;layer61_aggregate_dp1_tp0_ep11 -->
<g id="edge794" class="edge">
<title>layer61_expert_allreduce_dp1_tp0_ep11&#45;&gt;layer61_aggregate_dp1_tp0_ep11</title>
<path fill="none" stroke="black" d="M38438.99,-476.17C38438.06,-467.93 38437.07,-459.16 38436.07,-450.35"/>
<polygon fill="black" stroke="black" points="38439.55,-449.96 38434.94,-440.41 38432.59,-450.74 38439.55,-449.96"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep11&#45;&gt;output_agg -->
<g id="edge958" class="edge">
<title>layer61_aggregate_dp1_tp0_ep11&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M38078.1,-319.58C38024.69,-313.32 37970.11,-307.84 37918.33,-304.17 36992.21,-238.4 30312.98,-208.39 28784.39,-202.34"/>
<polygon fill="black" stroke="black" points="28784.38,-198.84 28774.36,-202.3 28784.35,-205.84 28784.38,-198.84"/>
</g>
<!-- layer61_dispatch_dp1_tp0_ep12 -->
<g id="node672" class="node">
<title>layer61_dispatch_dp1_tp0_ep12</title>
<polygon fill="lightgreen" stroke="black" points="39876.48,-952.33 39189.02,-952.33 39012.17,-816.33 39699.63,-816.33 39876.48,-952.33"/>
<text text-anchor="middle" x="39444.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="39444.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 188</text>
<text text-anchor="middle" x="39444.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="39444.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp0_ep12&#45;&gt;layer61_dispatch_dp1_tp0_ep12 -->
<g id="edge796" class="edge">
<title>layer61_gate_dp1_tp0_ep12&#45;&gt;layer61_dispatch_dp1_tp0_ep12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39434.04,-988.14C39434.89,-979.74 39435.75,-971.09 39436.6,-962.55"/>
<polygon fill="black" stroke="black" points="39440.09,-962.89 39437.6,-952.59 39433.12,-962.19 39440.09,-962.89"/>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep12 -->
<g id="node673" class="node">
<title>layer61_expert_mlp_dp1_tp0_ep12</title>
<polygon fill="lightblue" stroke="black" points="39595.83,-780.33 39244.83,-780.33 39244.83,-712.33 39595.83,-712.33 39595.83,-780.33"/>
<text text-anchor="middle" x="39420.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="39420.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 188</text>
<text text-anchor="middle" x="39420.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="39420.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp0_ep12&#45;&gt;layer61_expert_mlp_dp1_tp0_ep12 -->
<g id="edge797" class="edge">
<title>layer61_dispatch_dp1_tp0_ep12&#45;&gt;layer61_expert_mlp_dp1_tp0_ep12</title>
<path fill="none" stroke="black" d="M39432.47,-816.13C39430.92,-807.38 39429.37,-798.61 39427.93,-790.4"/>
<polygon fill="black" stroke="black" points="39431.34,-789.59 39426.15,-780.35 39424.44,-790.81 39431.34,-789.59"/>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep12 -->
<g id="node674" class="node">
<title>layer61_expert_proj_dp1_tp0_ep12</title>
<polygon fill="lightblue" stroke="black" points="39503.83,-676.33 39152.83,-676.33 39152.83,-608.33 39503.83,-608.33 39503.83,-676.33"/>
<text text-anchor="middle" x="39328.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="39328.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 188</text>
<text text-anchor="middle" x="39328.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="39328.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep12&#45;&gt;layer61_expert_proj_dp1_tp0_ep12 -->
<g id="edge798" class="edge">
<title>layer61_expert_mlp_dp1_tp0_ep12&#45;&gt;layer61_expert_proj_dp1_tp0_ep12</title>
<path fill="none" stroke="black" d="M39390.46,-712.22C39382.42,-703.31 39373.64,-693.57 39365.27,-684.29"/>
<polygon fill="black" stroke="black" points="39367.66,-681.71 39358.36,-676.63 39362.46,-686.4 39367.66,-681.71"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep12 -->
<g id="node675" class="node">
<title>layer61_expert_allreduce_dp1_tp0_ep12</title>
<ellipse fill="lightyellow" stroke="black" cx="39282.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="39282.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="39282.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 188</text>
<text text-anchor="middle" x="39282.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="39282.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep12&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep12 -->
<g id="edge799" class="edge">
<title>layer61_expert_proj_dp1_tp0_ep12&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep12</title>
<path fill="none" stroke="black" d="M39315.14,-608.07C39311.87,-599.81 39308.28,-590.74 39304.7,-581.71"/>
<polygon fill="black" stroke="black" points="39307.93,-580.37 39300.99,-572.36 39301.42,-582.95 39307.93,-580.37"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep12 -->
<g id="node676" class="node">
<title>layer61_aggregate_dp1_tp0_ep12</title>
<polygon fill="lightpink" stroke="black" points="39625.27,-440.17 39043.13,-440.17 38893.38,-304.17 39475.52,-304.17 39625.27,-440.17"/>
<text text-anchor="middle" x="39259.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="39259.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 188</text>
<text text-anchor="middle" x="39259.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="39259.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep12&#45;&gt;layer61_aggregate_dp1_tp0_ep12 -->
<g id="edge800" class="edge">
<title>layer61_expert_allreduce_dp1_tp0_ep12&#45;&gt;layer61_aggregate_dp1_tp0_ep12</title>
<path fill="none" stroke="black" d="M39275.11,-476.17C39273.85,-467.93 39272.5,-459.16 39271.15,-450.35"/>
<polygon fill="black" stroke="black" points="39274.61,-449.77 39269.63,-440.41 39267.69,-450.83 39274.61,-449.77"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep12&#45;&gt;output_agg -->
<g id="edge959" class="edge">
<title>layer61_aggregate_dp1_tp0_ep12&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M38904.34,-314.32C38869.93,-310.26 38835.5,-306.75 38802.33,-304.17 37783.94,-224.8 30396.66,-205.12 28783.8,-201.75"/>
<polygon fill="black" stroke="black" points="28783.53,-198.25 28773.52,-201.73 28783.51,-205.25 28783.53,-198.25"/>
</g>
<!-- layer61_dispatch_dp1_tp0_ep13 -->
<g id="node678" class="node">
<title>layer61_dispatch_dp1_tp0_ep13</title>
<polygon fill="lightgreen" stroke="black" points="40759.48,-952.33 40072.02,-952.33 39895.17,-816.33 40582.63,-816.33 40759.48,-952.33"/>
<text text-anchor="middle" x="40327.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="40327.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 189</text>
<text text-anchor="middle" x="40327.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="40327.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp0_ep13&#45;&gt;layer61_dispatch_dp1_tp0_ep13 -->
<g id="edge802" class="edge">
<title>layer61_gate_dp1_tp0_ep13&#45;&gt;layer61_dispatch_dp1_tp0_ep13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40307.37,-988.14C40309,-979.74 40310.68,-971.09 40312.34,-962.55"/>
<polygon fill="black" stroke="black" points="40315.8,-963.07 40314.27,-952.59 40308.93,-961.74 40315.8,-963.07"/>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep13 -->
<g id="node679" class="node">
<title>layer61_expert_mlp_dp1_tp0_ep13</title>
<polygon fill="lightblue" stroke="black" points="40417.83,-780.33 40066.83,-780.33 40066.83,-712.33 40417.83,-712.33 40417.83,-780.33"/>
<text text-anchor="middle" x="40242.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="40242.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 189</text>
<text text-anchor="middle" x="40242.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="40242.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp0_ep13&#45;&gt;layer61_expert_mlp_dp1_tp0_ep13 -->
<g id="edge803" class="edge">
<title>layer61_dispatch_dp1_tp0_ep13&#45;&gt;layer61_expert_mlp_dp1_tp0_ep13</title>
<path fill="none" stroke="black" d="M40285.32,-816.13C40279.55,-806.89 40273.76,-797.63 40268.39,-789.04"/>
<polygon fill="black" stroke="black" points="40271.23,-786.97 40262.96,-780.35 40265.29,-790.68 40271.23,-786.97"/>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep13 -->
<g id="node680" class="node">
<title>layer61_expert_proj_dp1_tp0_ep13</title>
<polygon fill="lightblue" stroke="black" points="40407.83,-676.33 40056.83,-676.33 40056.83,-608.33 40407.83,-608.33 40407.83,-676.33"/>
<text text-anchor="middle" x="40232.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="40232.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 189</text>
<text text-anchor="middle" x="40232.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="40232.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep13&#45;&gt;layer61_expert_proj_dp1_tp0_ep13 -->
<g id="edge804" class="edge">
<title>layer61_expert_mlp_dp1_tp0_ep13&#45;&gt;layer61_expert_proj_dp1_tp0_ep13</title>
<path fill="none" stroke="black" d="M40239.08,-712.22C40238.28,-704.11 40237.42,-695.32 40236.59,-686.81"/>
<polygon fill="black" stroke="black" points="40240.05,-686.24 40235.59,-676.63 40233.08,-686.93 40240.05,-686.24"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep13 -->
<g id="node681" class="node">
<title>layer61_expert_allreduce_dp1_tp0_ep13</title>
<ellipse fill="lightyellow" stroke="black" cx="40227.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="40227.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="40227.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 189</text>
<text text-anchor="middle" x="40227.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="40227.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep13&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep13 -->
<g id="edge805" class="edge">
<title>layer61_expert_proj_dp1_tp0_ep13&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep13</title>
<path fill="none" stroke="black" d="M40230.89,-608.07C40230.55,-600.07 40230.17,-591.31 40229.79,-582.57"/>
<polygon fill="black" stroke="black" points="40233.28,-582.2 40229.36,-572.36 40226.29,-582.5 40233.28,-582.2"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep13 -->
<g id="node682" class="node">
<title>layer61_aggregate_dp1_tp0_ep13</title>
<polygon fill="lightpink" stroke="black" points="40416.27,-440.17 39834.13,-440.17 39684.38,-304.17 40266.52,-304.17 40416.27,-440.17"/>
<text text-anchor="middle" x="40050.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="40050.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 189</text>
<text text-anchor="middle" x="40050.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="40050.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep13&#45;&gt;layer61_aggregate_dp1_tp0_ep13 -->
<g id="edge806" class="edge">
<title>layer61_expert_allreduce_dp1_tp0_ep13&#45;&gt;layer61_aggregate_dp1_tp0_ep13</title>
<path fill="none" stroke="black" d="M40172.78,-477C40161.53,-467.46 40149.42,-457.19 40137.34,-446.95"/>
<polygon fill="black" stroke="black" points="40139.31,-444.03 40129.42,-440.23 40134.79,-449.37 40139.31,-444.03"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep13&#45;&gt;output_agg -->
<g id="edge960" class="edge">
<title>layer61_aggregate_dp1_tp0_ep13&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M39690.53,-309.79C39671.55,-307.63 39652.73,-305.72 39634.33,-304.17 38529.03,-210.59 30472.01,-202.01 28783.25,-201.24"/>
<polygon fill="black" stroke="black" points="28783.1,-197.74 28773.1,-201.23 28783.1,-204.74 28783.1,-197.74"/>
</g>
<!-- layer61_dispatch_dp1_tp0_ep14 -->
<g id="node684" class="node">
<title>layer61_dispatch_dp1_tp0_ep14</title>
<polygon fill="lightgreen" stroke="black" points="41642.48,-952.33 40955.02,-952.33 40778.17,-816.33 41465.63,-816.33 41642.48,-952.33"/>
<text text-anchor="middle" x="41210.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="41210.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 190</text>
<text text-anchor="middle" x="41210.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="41210.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp0_ep14&#45;&gt;layer61_dispatch_dp1_tp0_ep14 -->
<g id="edge808" class="edge">
<title>layer61_gate_dp1_tp0_ep14&#45;&gt;layer61_dispatch_dp1_tp0_ep14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41180.09,-988.14C41182.59,-979.65 41185.16,-970.9 41187.7,-962.27"/>
<polygon fill="black" stroke="black" points="41191.08,-963.17 41190.54,-952.59 41184.37,-961.2 41191.08,-963.17"/>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep14 -->
<g id="node685" class="node">
<title>layer61_expert_mlp_dp1_tp0_ep14</title>
<polygon fill="lightblue" stroke="black" points="41336.83,-780.33 40985.83,-780.33 40985.83,-712.33 41336.83,-712.33 41336.83,-780.33"/>
<text text-anchor="middle" x="41161.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="41161.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 190</text>
<text text-anchor="middle" x="41161.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="41161.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp0_ep14&#45;&gt;layer61_expert_mlp_dp1_tp0_ep14 -->
<g id="edge809" class="edge">
<title>layer61_dispatch_dp1_tp0_ep14&#45;&gt;layer61_expert_mlp_dp1_tp0_ep14</title>
<path fill="none" stroke="black" d="M41186.11,-816.13C41182.89,-807.18 41179.66,-798.22 41176.65,-789.85"/>
<polygon fill="black" stroke="black" points="41179.9,-788.57 41173.22,-780.35 41173.32,-790.94 41179.9,-788.57"/>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep14 -->
<g id="node686" class="node">
<title>layer61_expert_proj_dp1_tp0_ep14</title>
<polygon fill="lightblue" stroke="black" points="41141.83,-676.33 40790.83,-676.33 40790.83,-608.33 41141.83,-608.33 41141.83,-676.33"/>
<text text-anchor="middle" x="40966.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="40966.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 190</text>
<text text-anchor="middle" x="40966.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="40966.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep14&#45;&gt;layer61_expert_proj_dp1_tp0_ep14 -->
<g id="edge810" class="edge">
<title>layer61_expert_mlp_dp1_tp0_ep14&#45;&gt;layer61_expert_proj_dp1_tp0_ep14</title>
<path fill="none" stroke="black" d="M41098.02,-712.22C41079.1,-702.32 41058.22,-691.4 41038.77,-681.23"/>
<polygon fill="black" stroke="black" points="41040.14,-677.99 41029.65,-676.46 41036.89,-684.19 41040.14,-677.99"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep14 -->
<g id="node687" class="node">
<title>layer61_expert_allreduce_dp1_tp0_ep14</title>
<ellipse fill="lightyellow" stroke="black" cx="40869.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="40869.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="40869.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 190</text>
<text text-anchor="middle" x="40869.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="40869.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep14&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep14 -->
<g id="edge811" class="edge">
<title>layer61_expert_proj_dp1_tp0_ep14&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep14</title>
<path fill="none" stroke="black" d="M40938.53,-608.07C40931.11,-599.19 40922.89,-589.35 40914.79,-579.65"/>
<polygon fill="black" stroke="black" points="40917.43,-577.36 40908.33,-571.93 40912.06,-581.84 40917.43,-577.36"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep14 -->
<g id="node688" class="node">
<title>layer61_aggregate_dp1_tp0_ep14</title>
<polygon fill="lightpink" stroke="black" points="41186.27,-440.17 40604.13,-440.17 40454.38,-304.17 41036.52,-304.17 41186.27,-440.17"/>
<text text-anchor="middle" x="40820.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="40820.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 190</text>
<text text-anchor="middle" x="40820.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="40820.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep14&#45;&gt;layer61_aggregate_dp1_tp0_ep14 -->
<g id="edge812" class="edge">
<title>layer61_expert_allreduce_dp1_tp0_ep14&#45;&gt;layer61_aggregate_dp1_tp0_ep14</title>
<path fill="none" stroke="black" d="M40853.96,-476.17C40851.24,-467.84 40848.34,-458.97 40845.43,-450.07"/>
<polygon fill="black" stroke="black" points="40848.71,-448.83 40842.28,-440.41 40842.06,-451.01 40848.71,-448.83"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep14&#45;&gt;output_agg -->
<g id="edge961" class="edge">
<title>layer61_aggregate_dp1_tp0_ep14&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M40457.93,-307.39C40446.95,-306.2 40436.07,-305.12 40425.33,-304.17 39237.19,-198.96 30542.04,-199.65 28783.08,-200.88"/>
<polygon fill="black" stroke="black" points="28782.83,-197.38 28772.83,-200.89 28782.83,-204.38 28782.83,-197.38"/>
</g>
<!-- layer61_dispatch_dp1_tp0_ep15 -->
<g id="node690" class="node">
<title>layer61_dispatch_dp1_tp0_ep15</title>
<polygon fill="lightgreen" stroke="black" points="42525.48,-952.33 41838.02,-952.33 41661.17,-816.33 42348.63,-816.33 42525.48,-952.33"/>
<text text-anchor="middle" x="42093.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="42093.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 191</text>
<text text-anchor="middle" x="42093.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="42093.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp0_ep15&#45;&gt;layer61_dispatch_dp1_tp0_ep15 -->
<g id="edge814" class="edge">
<title>layer61_gate_dp1_tp0_ep15&#45;&gt;layer61_dispatch_dp1_tp0_ep15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42058.25,-988.14C42061.15,-979.65 42064.13,-970.9 42067.08,-962.27"/>
<polygon fill="black" stroke="black" points="42070.46,-963.18 42070.38,-952.59 42063.84,-960.92 42070.46,-963.18"/>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep15 -->
<g id="node691" class="node">
<title>layer61_expert_mlp_dp1_tp0_ep15</title>
<polygon fill="lightblue" stroke="black" points="42235.83,-780.33 41884.83,-780.33 41884.83,-712.33 42235.83,-712.33 42235.83,-780.33"/>
<text text-anchor="middle" x="42060.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="42060.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 191</text>
<text text-anchor="middle" x="42060.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="42060.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp0_ep15&#45;&gt;layer61_expert_mlp_dp1_tp0_ep15 -->
<g id="edge815" class="edge">
<title>layer61_dispatch_dp1_tp0_ep15&#45;&gt;layer61_expert_mlp_dp1_tp0_ep15</title>
<path fill="none" stroke="black" d="M42077.02,-816.13C42074.87,-807.28 42072.72,-798.41 42070.71,-790.13"/>
<polygon fill="black" stroke="black" points="42074.1,-789.24 42068.34,-780.35 42067.29,-790.89 42074.1,-789.24"/>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep15 -->
<g id="node692" class="node">
<title>layer61_expert_proj_dp1_tp0_ep15</title>
<polygon fill="lightblue" stroke="black" points="42104.83,-676.33 41753.83,-676.33 41753.83,-608.33 42104.83,-608.33 42104.83,-676.33"/>
<text text-anchor="middle" x="41929.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="41929.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 191</text>
<text text-anchor="middle" x="41929.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="41929.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp0_ep15&#45;&gt;layer61_expert_proj_dp1_tp0_ep15 -->
<g id="edge816" class="edge">
<title>layer61_expert_mlp_dp1_tp0_ep15&#45;&gt;layer61_expert_proj_dp1_tp0_ep15</title>
<path fill="none" stroke="black" d="M42017.79,-712.22C42005.78,-702.86 41992.59,-692.59 41980.14,-682.9"/>
<polygon fill="black" stroke="black" points="41982.13,-680.01 41972.09,-676.63 41977.83,-685.54 41982.13,-680.01"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep15 -->
<g id="node693" class="node">
<title>layer61_expert_allreduce_dp1_tp0_ep15</title>
<ellipse fill="lightyellow" stroke="black" cx="41864.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="41864.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="41864.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 191</text>
<text text-anchor="middle" x="41864.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="41864.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp0_ep15&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep15 -->
<g id="edge817" class="edge">
<title>layer61_expert_proj_dp1_tp0_ep15&#45;&gt;layer61_expert_allreduce_dp1_tp0_ep15</title>
<path fill="none" stroke="black" d="M41910.7,-608.07C41905.98,-599.64 41900.78,-590.35 41895.62,-581.14"/>
<polygon fill="black" stroke="black" points="41898.64,-579.37 41890.7,-572.36 41892.54,-582.79 41898.64,-579.37"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep15 -->
<g id="node694" class="node">
<title>layer61_aggregate_dp1_tp0_ep15</title>
<polygon fill="lightpink" stroke="black" points="42197.27,-440.17 41615.13,-440.17 41465.38,-304.17 42047.52,-304.17 42197.27,-440.17"/>
<text text-anchor="middle" x="41831.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="41831.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 191</text>
<text text-anchor="middle" x="41831.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="41831.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp0_ep15&#45;&gt;layer61_aggregate_dp1_tp0_ep15 -->
<g id="edge818" class="edge">
<title>layer61_expert_allreduce_dp1_tp0_ep15&#45;&gt;layer61_aggregate_dp1_tp0_ep15</title>
<path fill="none" stroke="black" d="M41853.98,-476.17C41852.16,-467.93 41850.23,-459.16 41848.3,-450.35"/>
<polygon fill="black" stroke="black" points="41851.68,-449.43 41846.11,-440.41 41844.84,-450.93 41851.68,-449.43"/>
</g>
<!-- layer61_aggregate_dp1_tp0_ep15&#45;&gt;output_agg -->
<g id="edge962" class="edge">
<title>layer61_aggregate_dp1_tp0_ep15&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M41493.09,-329.39C41397.01,-319.19 41292.18,-309.65 41195.33,-304.17 39923.44,-232.19 30612,-206.29 28784.19,-201.88"/>
<polygon fill="black" stroke="black" points="28783.88,-198.38 28773.87,-201.85 28783.87,-205.38 28783.88,-198.38"/>
</g>
<!-- layer61_dispatch_dp1_tp1_ep0 -->
<g id="node696" class="node">
<title>layer61_dispatch_dp1_tp1_ep0</title>
<polygon fill="lightgreen" stroke="black" points="43408.48,-952.33 42721.02,-952.33 42544.17,-816.33 43231.63,-816.33 43408.48,-952.33"/>
<text text-anchor="middle" x="42976.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="42976.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 240</text>
<text text-anchor="middle" x="42976.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="42976.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp1_ep0&#45;&gt;layer61_dispatch_dp1_tp1_ep0 -->
<g id="edge820" class="edge">
<title>layer61_gate_dp1_tp1_ep0&#45;&gt;layer61_dispatch_dp1_tp1_ep0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43006.56,-988.14C43004.07,-979.65 43001.49,-970.9 42998.95,-962.27"/>
<polygon fill="black" stroke="black" points="43002.29,-961.2 42996.11,-952.59 42995.57,-963.17 43002.29,-961.2"/>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep0 -->
<g id="node697" class="node">
<title>layer61_expert_mlp_dp1_tp1_ep0</title>
<polygon fill="lightblue" stroke="black" points="43126.83,-780.33 42775.83,-780.33 42775.83,-712.33 43126.83,-712.33 43126.83,-780.33"/>
<text text-anchor="middle" x="42951.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="42951.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 240</text>
<text text-anchor="middle" x="42951.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="42951.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp1_ep0&#45;&gt;layer61_expert_mlp_dp1_tp1_ep0 -->
<g id="edge821" class="edge">
<title>layer61_dispatch_dp1_tp1_ep0&#45;&gt;layer61_expert_mlp_dp1_tp1_ep0</title>
<path fill="none" stroke="black" d="M42963.97,-816.13C42962.36,-807.38 42960.75,-798.61 42959.24,-790.4"/>
<polygon fill="black" stroke="black" points="42962.65,-789.55 42957.4,-780.35 42955.76,-790.82 42962.65,-789.55"/>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep0 -->
<g id="node698" class="node">
<title>layer61_expert_proj_dp1_tp1_ep0</title>
<polygon fill="lightblue" stroke="black" points="43027.83,-676.33 42676.83,-676.33 42676.83,-608.33 43027.83,-608.33 43027.83,-676.33"/>
<text text-anchor="middle" x="42852.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="42852.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 240</text>
<text text-anchor="middle" x="42852.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="42852.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep0&#45;&gt;layer61_expert_proj_dp1_tp1_ep0 -->
<g id="edge822" class="edge">
<title>layer61_expert_mlp_dp1_tp1_ep0&#45;&gt;layer61_expert_proj_dp1_tp1_ep0</title>
<path fill="none" stroke="black" d="M42919.18,-712.22C42910.45,-703.22 42900.89,-693.37 42891.81,-684.01"/>
<polygon fill="black" stroke="black" points="42894.12,-681.37 42884.65,-676.63 42889.1,-686.25 42894.12,-681.37"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep0 -->
<g id="node699" class="node">
<title>layer61_expert_allreduce_dp1_tp1_ep0</title>
<ellipse fill="lightyellow" stroke="black" cx="42803.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="42803.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="42803.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 240</text>
<text text-anchor="middle" x="42803.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="42803.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep0&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep0 -->
<g id="edge823" class="edge">
<title>layer61_expert_proj_dp1_tp1_ep0&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep0</title>
<path fill="none" stroke="black" d="M42838.28,-608.07C42834.8,-599.81 42830.97,-590.74 42827.16,-581.71"/>
<polygon fill="black" stroke="black" points="42830.32,-580.21 42823.21,-572.36 42823.88,-582.93 42830.32,-580.21"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep0 -->
<g id="node700" class="node">
<title>layer61_aggregate_dp1_tp1_ep0</title>
<polygon fill="lightpink" stroke="black" points="43144.27,-440.17 42562.13,-440.17 42412.38,-304.17 42994.52,-304.17 43144.27,-440.17"/>
<text text-anchor="middle" x="42778.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="42778.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 240</text>
<text text-anchor="middle" x="42778.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="42778.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep0&#45;&gt;layer61_aggregate_dp1_tp1_ep0 -->
<g id="edge824" class="edge">
<title>layer61_expert_allreduce_dp1_tp1_ep0&#45;&gt;layer61_aggregate_dp1_tp1_ep0</title>
<path fill="none" stroke="black" d="M42795.48,-476.17C42794.11,-467.93 42792.65,-459.16 42791.18,-450.35"/>
<polygon fill="black" stroke="black" points="42794.62,-449.7 42789.53,-440.41 42787.72,-450.85 42794.62,-449.7"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep0&#45;&gt;output_agg -->
<g id="edge963" class="edge">
<title>layer61_aggregate_dp1_tp1_ep0&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M42434.81,-324.77C42359.65,-316.34 42280.42,-308.77 42206.33,-304.17 40827.81,-218.52 30693.79,-203.53 28783.44,-201.46"/>
<polygon fill="black" stroke="black" points="28783.36,-197.96 28773.35,-201.45 28783.35,-204.96 28783.36,-197.96"/>
</g>
<!-- layer61_dispatch_dp1_tp1_ep1 -->
<g id="node702" class="node">
<title>layer61_dispatch_dp1_tp1_ep1</title>
<polygon fill="lightgreen" stroke="black" points="44291.48,-952.33 43604.02,-952.33 43427.17,-816.33 44114.63,-816.33 44291.48,-952.33"/>
<text text-anchor="middle" x="43859.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="43859.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 241</text>
<text text-anchor="middle" x="43859.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="43859.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp1_ep1&#45;&gt;layer61_dispatch_dp1_tp1_ep1 -->
<g id="edge826" class="edge">
<title>layer61_gate_dp1_tp1_ep1&#45;&gt;layer61_dispatch_dp1_tp1_ep1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43899.85,-988.14C43896.46,-979.56 43892.98,-970.72 43889.54,-961.99"/>
<polygon fill="black" stroke="black" points="43892.76,-960.61 43885.83,-952.59 43886.24,-963.18 43892.76,-960.61"/>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep1 -->
<g id="node703" class="node">
<title>layer61_expert_mlp_dp1_tp1_ep1</title>
<polygon fill="lightblue" stroke="black" points="44013.83,-780.33 43662.83,-780.33 43662.83,-712.33 44013.83,-712.33 44013.83,-780.33"/>
<text text-anchor="middle" x="43838.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="43838.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 241</text>
<text text-anchor="middle" x="43838.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="43838.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp1_ep1&#45;&gt;layer61_expert_mlp_dp1_tp1_ep1 -->
<g id="edge827" class="edge">
<title>layer61_dispatch_dp1_tp1_ep1&#45;&gt;layer61_expert_mlp_dp1_tp1_ep1</title>
<path fill="none" stroke="black" d="M43848.95,-816.13C43847.6,-807.38 43846.24,-798.61 43844.98,-790.4"/>
<polygon fill="black" stroke="black" points="43848.41,-789.7 43843.42,-780.35 43841.49,-790.77 43848.41,-789.7"/>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep1 -->
<g id="node704" class="node">
<title>layer61_expert_proj_dp1_tp1_ep1</title>
<polygon fill="lightblue" stroke="black" points="43930.83,-676.33 43579.83,-676.33 43579.83,-608.33 43930.83,-608.33 43930.83,-676.33"/>
<text text-anchor="middle" x="43755.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="43755.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 241</text>
<text text-anchor="middle" x="43755.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="43755.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep1&#45;&gt;layer61_expert_proj_dp1_tp1_ep1 -->
<g id="edge828" class="edge">
<title>layer61_expert_mlp_dp1_tp1_ep1&#45;&gt;layer61_expert_proj_dp1_tp1_ep1</title>
<path fill="none" stroke="black" d="M43811.38,-712.22C43804.2,-703.4 43796.36,-693.76 43788.88,-684.57"/>
<polygon fill="black" stroke="black" points="43791.45,-682.18 43782.42,-676.63 43786.02,-686.6 43791.45,-682.18"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep1 -->
<g id="node705" class="node">
<title>layer61_expert_allreduce_dp1_tp1_ep1</title>
<ellipse fill="lightyellow" stroke="black" cx="43714.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="43714.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="43714.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 241</text>
<text text-anchor="middle" x="43714.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="43714.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep1&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep1 -->
<g id="edge829" class="edge">
<title>layer61_expert_proj_dp1_tp1_ep1&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep1</title>
<path fill="none" stroke="black" d="M43743.58,-608.07C43740.69,-599.9 43737.52,-590.93 43734.37,-582"/>
<polygon fill="black" stroke="black" points="43737.6,-580.62 43730.96,-572.36 43731,-582.95 43737.6,-580.62"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep1 -->
<g id="node706" class="node">
<title>layer61_aggregate_dp1_tp1_ep1</title>
<polygon fill="lightpink" stroke="black" points="44059.27,-440.17 43477.13,-440.17 43327.38,-304.17 43909.52,-304.17 44059.27,-440.17"/>
<text text-anchor="middle" x="43693.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="43693.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 241</text>
<text text-anchor="middle" x="43693.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="43693.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep1&#45;&gt;layer61_aggregate_dp1_tp1_ep1 -->
<g id="edge830" class="edge">
<title>layer61_expert_allreduce_dp1_tp1_ep1&#45;&gt;layer61_aggregate_dp1_tp1_ep1</title>
<path fill="none" stroke="black" d="M43707.74,-476.17C43706.59,-467.93 43705.36,-459.16 43704.13,-450.35"/>
<polygon fill="black" stroke="black" points="43707.59,-449.83 43702.74,-440.41 43700.65,-450.8 43707.59,-449.83"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep1&#45;&gt;output_agg -->
<g id="edge964" class="edge">
<title>layer61_aggregate_dp1_tp1_ep1&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M43347.12,-322.15C43282.82,-314.77 43216.13,-308.27 43153.33,-304.17 41674.71,-207.58 30768.22,-201.48 28782.94,-201.17"/>
<polygon fill="black" stroke="black" points="28782.83,-197.67 28772.83,-201.17 28782.83,-204.67 28782.83,-197.67"/>
</g>
<!-- layer61_dispatch_dp1_tp1_ep2 -->
<g id="node708" class="node">
<title>layer61_dispatch_dp1_tp1_ep2</title>
<polygon fill="lightgreen" stroke="black" points="45174.48,-952.33 44487.02,-952.33 44310.17,-816.33 44997.63,-816.33 45174.48,-952.33"/>
<text text-anchor="middle" x="44742.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="44742.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 242</text>
<text text-anchor="middle" x="44742.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="44742.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp1_ep2&#45;&gt;layer61_dispatch_dp1_tp1_ep2 -->
<g id="edge832" class="edge">
<title>layer61_gate_dp1_tp1_ep2&#45;&gt;layer61_dispatch_dp1_tp1_ep2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M44762.28,-988.14C44760.65,-979.74 44758.97,-971.09 44757.32,-962.55"/>
<polygon fill="black" stroke="black" points="44760.72,-961.74 44755.38,-952.59 44753.85,-963.07 44760.72,-961.74"/>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep2 -->
<g id="node709" class="node">
<title>layer61_expert_mlp_dp1_tp1_ep2</title>
<polygon fill="lightblue" stroke="black" points="44898.83,-780.33 44547.83,-780.33 44547.83,-712.33 44898.83,-712.33 44898.83,-780.33"/>
<text text-anchor="middle" x="44723.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="44723.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 242</text>
<text text-anchor="middle" x="44723.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="44723.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp1_ep2&#45;&gt;layer61_expert_mlp_dp1_tp1_ep2 -->
<g id="edge833" class="edge">
<title>layer61_dispatch_dp1_tp1_ep2&#45;&gt;layer61_expert_mlp_dp1_tp1_ep2</title>
<path fill="none" stroke="black" d="M44732.94,-816.13C44731.71,-807.38 44730.49,-798.61 44729.34,-790.4"/>
<polygon fill="black" stroke="black" points="44732.79,-789.77 44727.94,-780.35 44725.86,-790.74 44732.79,-789.77"/>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep2 -->
<g id="node710" class="node">
<title>layer61_expert_proj_dp1_tp1_ep2</title>
<polygon fill="lightblue" stroke="black" points="44823.83,-676.33 44472.83,-676.33 44472.83,-608.33 44823.83,-608.33 44823.83,-676.33"/>
<text text-anchor="middle" x="44648.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="44648.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 242</text>
<text text-anchor="middle" x="44648.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="44648.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep2&#45;&gt;layer61_expert_proj_dp1_tp1_ep2 -->
<g id="edge834" class="edge">
<title>layer61_expert_mlp_dp1_tp1_ep2&#45;&gt;layer61_expert_proj_dp1_tp1_ep2</title>
<path fill="none" stroke="black" d="M44698.98,-712.22C44692.56,-703.49 44685.55,-693.96 44678.85,-684.85"/>
<polygon fill="black" stroke="black" points="44681.55,-682.62 44672.81,-676.63 44675.92,-686.76 44681.55,-682.62"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep2 -->
<g id="node711" class="node">
<title>layer61_expert_allreduce_dp1_tp1_ep2</title>
<ellipse fill="lightyellow" stroke="black" cx="44611.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="44611.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="44611.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 242</text>
<text text-anchor="middle" x="44611.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="44611.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep2&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep2 -->
<g id="edge835" class="edge">
<title>layer61_expert_proj_dp1_tp1_ep2&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep2</title>
<path fill="none" stroke="black" d="M44637.72,-608.07C44635.12,-599.9 44632.26,-590.93 44629.41,-582"/>
<polygon fill="black" stroke="black" points="44632.71,-580.82 44626.34,-572.36 44626.04,-582.95 44632.71,-580.82"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep2 -->
<g id="node712" class="node">
<title>layer61_aggregate_dp1_tp1_ep2</title>
<polygon fill="lightpink" stroke="black" points="44958.27,-440.17 44376.13,-440.17 44226.38,-304.17 44808.52,-304.17 44958.27,-440.17"/>
<text text-anchor="middle" x="44592.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="44592.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 242</text>
<text text-anchor="middle" x="44592.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="44592.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep2&#45;&gt;layer61_aggregate_dp1_tp1_ep2 -->
<g id="edge836" class="edge">
<title>layer61_expert_allreduce_dp1_tp1_ep2&#45;&gt;layer61_aggregate_dp1_tp1_ep2</title>
<path fill="none" stroke="black" d="M44605.37,-476.17C44604.32,-467.93 44603.21,-459.16 44602.1,-450.35"/>
<polygon fill="black" stroke="black" points="44605.57,-449.89 44600.84,-440.41 44598.62,-450.77 44605.57,-449.89"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep2&#45;&gt;output_agg -->
<g id="edge965" class="edge">
<title>layer61_aggregate_dp1_tp1_ep2&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M44244.45,-320.72C44185.78,-313.93 44125.4,-307.99 44068.33,-304.17 42492.89,-198.63 30839.83,-199.9 28783.03,-200.96"/>
<polygon fill="black" stroke="black" points="28782.92,-197.46 28772.93,-200.97 28782.93,-204.46 28782.92,-197.46"/>
</g>
<!-- layer61_dispatch_dp1_tp1_ep3 -->
<g id="node714" class="node">
<title>layer61_dispatch_dp1_tp1_ep3</title>
<polygon fill="lightgreen" stroke="black" points="46057.48,-952.33 45370.02,-952.33 45193.17,-816.33 45880.63,-816.33 46057.48,-952.33"/>
<text text-anchor="middle" x="45625.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="45625.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 243</text>
<text text-anchor="middle" x="45625.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="45625.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp1_ep3&#45;&gt;layer61_dispatch_dp1_tp1_ep3 -->
<g id="edge838" class="edge">
<title>layer61_gate_dp1_tp1_ep3&#45;&gt;layer61_dispatch_dp1_tp1_ep3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45635.61,-988.14C45634.77,-979.74 45633.9,-971.09 45633.05,-962.55"/>
<polygon fill="black" stroke="black" points="45636.53,-962.19 45632.05,-952.59 45629.56,-962.89 45636.53,-962.19"/>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep3 -->
<g id="node715" class="node">
<title>layer61_expert_mlp_dp1_tp1_ep3</title>
<polygon fill="lightblue" stroke="black" points="45782.83,-780.33 45431.83,-780.33 45431.83,-712.33 45782.83,-712.33 45782.83,-780.33"/>
<text text-anchor="middle" x="45607.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="45607.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 243</text>
<text text-anchor="middle" x="45607.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="45607.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp1_ep3&#45;&gt;layer61_expert_mlp_dp1_tp1_ep3 -->
<g id="edge839" class="edge">
<title>layer61_dispatch_dp1_tp1_ep3&#45;&gt;layer61_expert_mlp_dp1_tp1_ep3</title>
<path fill="none" stroke="black" d="M45616.43,-816.13C45615.27,-807.38 45614.11,-798.61 45613.03,-790.4"/>
<polygon fill="black" stroke="black" points="45616.48,-789.8 45611.7,-780.35 45609.54,-790.72 45616.48,-789.8"/>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep3 -->
<g id="node716" class="node">
<title>layer61_expert_proj_dp1_tp1_ep3</title>
<polygon fill="lightblue" stroke="black" points="45711.83,-676.33 45360.83,-676.33 45360.83,-608.33 45711.83,-608.33 45711.83,-676.33"/>
<text text-anchor="middle" x="45536.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="45536.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 243</text>
<text text-anchor="middle" x="45536.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="45536.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep3&#45;&gt;layer61_expert_proj_dp1_tp1_ep3 -->
<g id="edge840" class="edge">
<title>layer61_expert_mlp_dp1_tp1_ep3&#45;&gt;layer61_expert_proj_dp1_tp1_ep3</title>
<path fill="none" stroke="black" d="M45584.27,-712.22C45578.2,-703.49 45571.56,-693.96 45565.22,-684.85"/>
<polygon fill="black" stroke="black" points="45568.09,-682.84 45559.51,-676.63 45562.35,-686.84 45568.09,-682.84"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep3 -->
<g id="node717" class="node">
<title>layer61_expert_allreduce_dp1_tp1_ep3</title>
<ellipse fill="lightyellow" stroke="black" cx="45501.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="45501.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="45501.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 243</text>
<text text-anchor="middle" x="45501.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="45501.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep3&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep3 -->
<g id="edge841" class="edge">
<title>layer61_expert_proj_dp1_tp1_ep3&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep3</title>
<path fill="none" stroke="black" d="M45526.3,-608.07C45523.83,-599.9 45521.13,-590.93 45518.44,-582"/>
<polygon fill="black" stroke="black" points="45521.77,-580.92 45515.53,-572.36 45515.07,-582.94 45521.77,-580.92"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep3 -->
<g id="node718" class="node">
<title>layer61_aggregate_dp1_tp1_ep3</title>
<polygon fill="lightpink" stroke="black" points="45849.27,-440.17 45267.13,-440.17 45117.38,-304.17 45699.52,-304.17 45849.27,-440.17"/>
<text text-anchor="middle" x="45483.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="45483.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 243</text>
<text text-anchor="middle" x="45483.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="45483.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep3&#45;&gt;layer61_aggregate_dp1_tp1_ep3 -->
<g id="edge842" class="edge">
<title>layer61_expert_allreduce_dp1_tp1_ep3&#45;&gt;layer61_aggregate_dp1_tp1_ep3</title>
<path fill="none" stroke="black" d="M45495.68,-476.17C45494.69,-467.93 45493.64,-459.16 45492.58,-450.35"/>
<polygon fill="black" stroke="black" points="45496.06,-449.92 45491.39,-440.41 45489.11,-450.76 45496.06,-449.92"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep3&#45;&gt;output_agg -->
<g id="edge966" class="edge">
<title>layer61_aggregate_dp1_tp1_ep3&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M45134.52,-319.97C45078.71,-313.48 45021.52,-307.84 44967.33,-304.17 44129.74,-247.39 30983.18,-208.19 28784.17,-202.02"/>
<polygon fill="black" stroke="black" points="28784.18,-198.52 28774.17,-201.99 28784.16,-205.52 28784.18,-198.52"/>
</g>
<!-- layer61_dispatch_dp1_tp1_ep4 -->
<g id="node720" class="node">
<title>layer61_dispatch_dp1_tp1_ep4</title>
<polygon fill="lightgreen" stroke="black" points="46940.48,-952.33 46253.02,-952.33 46076.17,-816.33 46763.63,-816.33 46940.48,-952.33"/>
<text text-anchor="middle" x="46508.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="46508.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 244</text>
<text text-anchor="middle" x="46508.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="46508.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp1_ep4&#45;&gt;layer61_dispatch_dp1_tp1_ep4 -->
<g id="edge844" class="edge">
<title>layer61_gate_dp1_tp1_ep4&#45;&gt;layer61_dispatch_dp1_tp1_ep4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46498.04,-988.14C46498.89,-979.74 46499.75,-971.09 46500.6,-962.55"/>
<polygon fill="black" stroke="black" points="46504.09,-962.89 46501.6,-952.59 46497.12,-962.19 46504.09,-962.89"/>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep4 -->
<g id="node721" class="node">
<title>layer61_expert_mlp_dp1_tp1_ep4</title>
<polygon fill="lightblue" stroke="black" points="46665.83,-780.33 46314.83,-780.33 46314.83,-712.33 46665.83,-712.33 46665.83,-780.33"/>
<text text-anchor="middle" x="46490.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="46490.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 244</text>
<text text-anchor="middle" x="46490.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="46490.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp1_ep4&#45;&gt;layer61_expert_mlp_dp1_tp1_ep4 -->
<g id="edge845" class="edge">
<title>layer61_dispatch_dp1_tp1_ep4&#45;&gt;layer61_expert_mlp_dp1_tp1_ep4</title>
<path fill="none" stroke="black" d="M46499.43,-816.13C46498.27,-807.38 46497.11,-798.61 46496.03,-790.4"/>
<polygon fill="black" stroke="black" points="46499.48,-789.8 46494.7,-780.35 46492.54,-790.72 46499.48,-789.8"/>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep4 -->
<g id="node722" class="node">
<title>layer61_expert_proj_dp1_tp1_ep4</title>
<polygon fill="lightblue" stroke="black" points="46596.83,-676.33 46245.83,-676.33 46245.83,-608.33 46596.83,-608.33 46596.83,-676.33"/>
<text text-anchor="middle" x="46421.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="46421.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 244</text>
<text text-anchor="middle" x="46421.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="46421.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep4&#45;&gt;layer61_expert_proj_dp1_tp1_ep4 -->
<g id="edge846" class="edge">
<title>layer61_expert_mlp_dp1_tp1_ep4&#45;&gt;layer61_expert_proj_dp1_tp1_ep4</title>
<path fill="none" stroke="black" d="M46467.92,-712.22C46462.08,-703.58 46455.7,-694.15 46449.6,-685.13"/>
<polygon fill="black" stroke="black" points="46452.35,-682.95 46443.85,-676.63 46446.56,-686.88 46452.35,-682.95"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep4 -->
<g id="node723" class="node">
<title>layer61_expert_allreduce_dp1_tp1_ep4</title>
<ellipse fill="lightyellow" stroke="black" cx="46387.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="46387.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="46387.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 244</text>
<text text-anchor="middle" x="46387.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="46387.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep4&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep4 -->
<g id="edge847" class="edge">
<title>layer61_expert_proj_dp1_tp1_ep4&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep4</title>
<path fill="none" stroke="black" d="M46411.58,-608.07C46409.19,-599.9 46406.56,-590.93 46403.95,-582"/>
<polygon fill="black" stroke="black" points="46407.29,-580.97 46401.12,-572.36 46400.58,-582.94 46407.29,-580.97"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep4 -->
<g id="node724" class="node">
<title>layer61_aggregate_dp1_tp1_ep4</title>
<polygon fill="lightpink" stroke="black" points="46736.27,-440.17 46154.13,-440.17 46004.38,-304.17 46586.52,-304.17 46736.27,-440.17"/>
<text text-anchor="middle" x="46370.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="46370.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 244</text>
<text text-anchor="middle" x="46370.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="46370.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep4&#45;&gt;layer61_aggregate_dp1_tp1_ep4 -->
<g id="edge848" class="edge">
<title>layer61_expert_allreduce_dp1_tp1_ep4&#45;&gt;layer61_aggregate_dp1_tp1_ep4</title>
<path fill="none" stroke="black" d="M46381.99,-476.17C46381.06,-467.93 46380.07,-459.16 46379.07,-450.35"/>
<polygon fill="black" stroke="black" points="46382.55,-449.96 46377.94,-440.41 46375.59,-450.74 46382.55,-449.96"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep4&#45;&gt;output_agg -->
<g id="edge967" class="edge">
<title>layer61_aggregate_dp1_tp1_ep4&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M46021.12,-319.59C45966.74,-313.26 45911.1,-307.76 45858.33,-304.17 44973.34,-243.88 31050.48,-207.45 28784.06,-201.91"/>
<polygon fill="black" stroke="black" points="28783.76,-198.41 28773.75,-201.88 28783.74,-205.41 28783.76,-198.41"/>
</g>
<!-- layer61_dispatch_dp1_tp1_ep5 -->
<g id="node726" class="node">
<title>layer61_dispatch_dp1_tp1_ep5</title>
<polygon fill="lightgreen" stroke="black" points="47823.48,-952.33 47136.02,-952.33 46959.17,-816.33 47646.63,-816.33 47823.48,-952.33"/>
<text text-anchor="middle" x="47391.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="47391.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 245</text>
<text text-anchor="middle" x="47391.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="47391.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp1_ep5&#45;&gt;layer61_dispatch_dp1_tp1_ep5 -->
<g id="edge850" class="edge">
<title>layer61_gate_dp1_tp1_ep5&#45;&gt;layer61_dispatch_dp1_tp1_ep5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47370.76,-988.14C47372.44,-979.74 47374.17,-971.09 47375.88,-962.55"/>
<polygon fill="black" stroke="black" points="47379.35,-963.08 47377.87,-952.59 47372.48,-961.71 47379.35,-963.08"/>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep5 -->
<g id="node727" class="node">
<title>layer61_expert_mlp_dp1_tp1_ep5</title>
<polygon fill="lightblue" stroke="black" points="47549.83,-780.33 47198.83,-780.33 47198.83,-712.33 47549.83,-712.33 47549.83,-780.33"/>
<text text-anchor="middle" x="47374.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="47374.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 245</text>
<text text-anchor="middle" x="47374.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="47374.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp1_ep5&#45;&gt;layer61_expert_mlp_dp1_tp1_ep5 -->
<g id="edge851" class="edge">
<title>layer61_dispatch_dp1_tp1_ep5&#45;&gt;layer61_expert_mlp_dp1_tp1_ep5</title>
<path fill="none" stroke="black" d="M47382.93,-816.13C47381.83,-807.38 47380.74,-798.61 47379.71,-790.4"/>
<polygon fill="black" stroke="black" points="47383.17,-789.84 47378.45,-780.35 47376.22,-790.71 47383.17,-789.84"/>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep5 -->
<g id="node728" class="node">
<title>layer61_expert_proj_dp1_tp1_ep5</title>
<polygon fill="lightblue" stroke="black" points="47481.83,-676.33 47130.83,-676.33 47130.83,-608.33 47481.83,-608.33 47481.83,-676.33"/>
<text text-anchor="middle" x="47306.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="47306.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 245</text>
<text text-anchor="middle" x="47306.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="47306.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep5&#45;&gt;layer61_expert_proj_dp1_tp1_ep5 -->
<g id="edge852" class="edge">
<title>layer61_expert_mlp_dp1_tp1_ep5&#45;&gt;layer61_expert_proj_dp1_tp1_ep5</title>
<path fill="none" stroke="black" d="M47352.25,-712.22C47346.49,-703.58 47340.21,-694.15 47334.19,-685.13"/>
<polygon fill="black" stroke="black" points="47336.98,-683.01 47328.53,-676.63 47331.16,-686.89 47336.98,-683.01"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep5 -->
<g id="node729" class="node">
<title>layer61_expert_allreduce_dp1_tp1_ep5</title>
<ellipse fill="lightyellow" stroke="black" cx="47272.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="47272.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="47272.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 245</text>
<text text-anchor="middle" x="47272.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="47272.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep5&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep5 -->
<g id="edge853" class="edge">
<title>layer61_expert_proj_dp1_tp1_ep5&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep5</title>
<path fill="none" stroke="black" d="M47296.58,-608.07C47294.19,-599.9 47291.56,-590.93 47288.95,-582"/>
<polygon fill="black" stroke="black" points="47292.29,-580.97 47286.12,-572.36 47285.58,-582.94 47292.29,-580.97"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep5 -->
<g id="node730" class="node">
<title>layer61_aggregate_dp1_tp1_ep5</title>
<polygon fill="lightpink" stroke="black" points="47621.27,-440.17 47039.13,-440.17 46889.38,-304.17 47471.52,-304.17 47621.27,-440.17"/>
<text text-anchor="middle" x="47255.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="47255.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 245</text>
<text text-anchor="middle" x="47255.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="47255.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep5&#45;&gt;layer61_aggregate_dp1_tp1_ep5 -->
<g id="edge854" class="edge">
<title>layer61_expert_allreduce_dp1_tp1_ep5&#45;&gt;layer61_aggregate_dp1_tp1_ep5</title>
<path fill="none" stroke="black" d="M47266.99,-476.17C47266.06,-467.93 47265.07,-459.16 47264.07,-450.35"/>
<polygon fill="black" stroke="black" points="47267.55,-449.96 47262.94,-440.41 47260.59,-450.74 47267.55,-449.96"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep5&#45;&gt;output_agg -->
<g id="edge968" class="edge">
<title>layer61_aggregate_dp1_tp1_ep5&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M46906.12,-319.41C46852.38,-313.15 46797.45,-307.72 46745.33,-304.17 45813.11,-240.56 31116.02,-206.78 28784.01,-201.81"/>
<polygon fill="black" stroke="black" points="28783.84,-198.31 28773.83,-201.79 28783.82,-205.31 28783.84,-198.31"/>
</g>
<!-- layer61_dispatch_dp1_tp1_ep6 -->
<g id="node732" class="node">
<title>layer61_dispatch_dp1_tp1_ep6</title>
<polygon fill="lightgreen" stroke="black" points="48706.48,-952.33 48019.02,-952.33 47842.17,-816.33 48529.63,-816.33 48706.48,-952.33"/>
<text text-anchor="middle" x="48274.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="48274.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 246</text>
<text text-anchor="middle" x="48274.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="48274.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp1_ep6&#45;&gt;layer61_dispatch_dp1_tp1_ep6 -->
<g id="edge856" class="edge">
<title>layer61_gate_dp1_tp1_ep6&#45;&gt;layer61_dispatch_dp1_tp1_ep6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48248.93,-988.14C48251,-979.74 48253.14,-971.09 48255.25,-962.55"/>
<polygon fill="black" stroke="black" points="48258.71,-963.14 48257.71,-952.59 48251.91,-961.46 48258.71,-963.14"/>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep6 -->
<g id="node733" class="node">
<title>layer61_expert_mlp_dp1_tp1_ep6</title>
<polygon fill="lightblue" stroke="black" points="48432.83,-780.33 48081.83,-780.33 48081.83,-712.33 48432.83,-712.33 48432.83,-780.33"/>
<text text-anchor="middle" x="48257.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="48257.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 246</text>
<text text-anchor="middle" x="48257.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="48257.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp1_ep6&#45;&gt;layer61_expert_mlp_dp1_tp1_ep6 -->
<g id="edge857" class="edge">
<title>layer61_dispatch_dp1_tp1_ep6&#45;&gt;layer61_expert_mlp_dp1_tp1_ep6</title>
<path fill="none" stroke="black" d="M48265.93,-816.13C48264.83,-807.38 48263.74,-798.61 48262.71,-790.4"/>
<polygon fill="black" stroke="black" points="48266.17,-789.84 48261.45,-780.35 48259.22,-790.71 48266.17,-789.84"/>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep6 -->
<g id="node734" class="node">
<title>layer61_expert_proj_dp1_tp1_ep6</title>
<polygon fill="lightblue" stroke="black" points="48365.83,-676.33 48014.83,-676.33 48014.83,-608.33 48365.83,-608.33 48365.83,-676.33"/>
<text text-anchor="middle" x="48190.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="48190.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 246</text>
<text text-anchor="middle" x="48190.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="48190.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep6&#45;&gt;layer61_expert_proj_dp1_tp1_ep6 -->
<g id="edge858" class="edge">
<title>layer61_expert_mlp_dp1_tp1_ep6&#45;&gt;layer61_expert_proj_dp1_tp1_ep6</title>
<path fill="none" stroke="black" d="M48235.57,-712.22C48229.9,-703.58 48223.71,-694.15 48217.78,-685.13"/>
<polygon fill="black" stroke="black" points="48220.61,-683.07 48212.2,-676.63 48214.76,-686.91 48220.61,-683.07"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep6 -->
<g id="node735" class="node">
<title>layer61_expert_allreduce_dp1_tp1_ep6</title>
<ellipse fill="lightyellow" stroke="black" cx="48156.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="48156.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="48156.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 246</text>
<text text-anchor="middle" x="48156.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="48156.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep6&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep6 -->
<g id="edge859" class="edge">
<title>layer61_expert_proj_dp1_tp1_ep6&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep6</title>
<path fill="none" stroke="black" d="M48180.58,-608.07C48178.19,-599.9 48175.56,-590.93 48172.95,-582"/>
<polygon fill="black" stroke="black" points="48176.29,-580.97 48170.12,-572.36 48169.58,-582.94 48176.29,-580.97"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep6 -->
<g id="node736" class="node">
<title>layer61_aggregate_dp1_tp1_ep6</title>
<polygon fill="lightpink" stroke="black" points="48505.27,-440.17 47923.13,-440.17 47773.38,-304.17 48355.52,-304.17 48505.27,-440.17"/>
<text text-anchor="middle" x="48139.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="48139.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 246</text>
<text text-anchor="middle" x="48139.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="48139.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep6&#45;&gt;layer61_aggregate_dp1_tp1_ep6 -->
<g id="edge860" class="edge">
<title>layer61_expert_allreduce_dp1_tp1_ep6&#45;&gt;layer61_aggregate_dp1_tp1_ep6</title>
<path fill="none" stroke="black" d="M48150.99,-476.17C48150.06,-467.93 48149.07,-459.16 48148.07,-450.35"/>
<polygon fill="black" stroke="black" points="48151.55,-449.96 48146.94,-440.41 48144.59,-450.74 48151.55,-449.96"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep6&#45;&gt;output_agg -->
<g id="edge969" class="edge">
<title>layer61_aggregate_dp1_tp1_ep6&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M47789.77,-319.28C47736.47,-313.07 47682.01,-307.69 47630.33,-304.17 46650.89,-237.34 31178.81,-206.16 28783.73,-201.72"/>
<polygon fill="black" stroke="black" points="28783.72,-198.22 28773.71,-201.71 28783.7,-205.22 28783.72,-198.22"/>
</g>
<!-- layer61_dispatch_dp1_tp1_ep7 -->
<g id="node738" class="node">
<title>layer61_dispatch_dp1_tp1_ep7</title>
<polygon fill="lightgreen" stroke="black" points="49589.48,-952.33 48902.02,-952.33 48725.17,-816.33 49412.63,-816.33 49589.48,-952.33"/>
<text text-anchor="middle" x="49157.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="49157.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 247</text>
<text text-anchor="middle" x="49157.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="49157.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp1_ep7&#45;&gt;layer61_dispatch_dp1_tp1_ep7 -->
<g id="edge862" class="edge">
<title>layer61_gate_dp1_tp1_ep7&#45;&gt;layer61_dispatch_dp1_tp1_ep7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49129.51,-988.14C49131.81,-979.65 49134.17,-970.9 49136.51,-962.27"/>
<polygon fill="black" stroke="black" points="49139.89,-963.16 49139.13,-952.59 49133.14,-961.33 49139.89,-963.16"/>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep7 -->
<g id="node739" class="node">
<title>layer61_expert_mlp_dp1_tp1_ep7</title>
<polygon fill="lightblue" stroke="black" points="49308.83,-780.33 48957.83,-780.33 48957.83,-712.33 49308.83,-712.33 49308.83,-780.33"/>
<text text-anchor="middle" x="49133.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="49133.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 247</text>
<text text-anchor="middle" x="49133.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="49133.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp1_ep7&#45;&gt;layer61_expert_mlp_dp1_tp1_ep7 -->
<g id="edge863" class="edge">
<title>layer61_dispatch_dp1_tp1_ep7&#45;&gt;layer61_expert_mlp_dp1_tp1_ep7</title>
<path fill="none" stroke="black" d="M49145.47,-816.13C49143.92,-807.38 49142.37,-798.61 49140.93,-790.4"/>
<polygon fill="black" stroke="black" points="49144.34,-789.59 49139.15,-780.35 49137.44,-790.81 49144.34,-789.59"/>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep7 -->
<g id="node740" class="node">
<title>layer61_expert_proj_dp1_tp1_ep7</title>
<polygon fill="lightblue" stroke="black" points="49212.83,-676.33 48861.83,-676.33 48861.83,-608.33 49212.83,-608.33 49212.83,-676.33"/>
<text text-anchor="middle" x="49037.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="49037.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 247</text>
<text text-anchor="middle" x="49037.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="49037.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep7&#45;&gt;layer61_expert_proj_dp1_tp1_ep7 -->
<g id="edge864" class="edge">
<title>layer61_expert_mlp_dp1_tp1_ep7&#45;&gt;layer61_expert_proj_dp1_tp1_ep7</title>
<path fill="none" stroke="black" d="M49102.16,-712.22C49093.69,-703.22 49084.42,-693.37 49075.61,-684.01"/>
<polygon fill="black" stroke="black" points="49078.07,-681.52 49068.67,-676.63 49072.97,-686.31 49078.07,-681.52"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep7 -->
<g id="node741" class="node">
<title>layer61_expert_allreduce_dp1_tp1_ep7</title>
<ellipse fill="lightyellow" stroke="black" cx="48989.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="48989.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="48989.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 247</text>
<text text-anchor="middle" x="48989.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="48989.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep7&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep7 -->
<g id="edge865" class="edge">
<title>layer61_expert_proj_dp1_tp1_ep7&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep7</title>
<path fill="none" stroke="black" d="M49023.57,-608.07C49020.16,-599.81 49016.4,-590.74 49012.67,-581.71"/>
<polygon fill="black" stroke="black" points="49015.86,-580.26 49008.81,-572.36 49009.39,-582.94 49015.86,-580.26"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep7 -->
<g id="node742" class="node">
<title>layer61_aggregate_dp1_tp1_ep7</title>
<polygon fill="lightpink" stroke="black" points="49331.27,-440.17 48749.13,-440.17 48599.38,-304.17 49181.52,-304.17 49331.27,-440.17"/>
<text text-anchor="middle" x="48965.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="48965.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 247</text>
<text text-anchor="middle" x="48965.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="48965.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep7&#45;&gt;layer61_aggregate_dp1_tp1_ep7 -->
<g id="edge866" class="edge">
<title>layer61_expert_allreduce_dp1_tp1_ep7&#45;&gt;layer61_aggregate_dp1_tp1_ep7</title>
<path fill="none" stroke="black" d="M48981.8,-476.17C48980.48,-467.93 48979.08,-459.16 48977.67,-450.35"/>
<polygon fill="black" stroke="black" points="48981.11,-449.73 48976.08,-440.41 48974.2,-450.84 48981.11,-449.73"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep7&#45;&gt;output_agg -->
<g id="edge970" class="edge">
<title>layer61_aggregate_dp1_tp1_ep7&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M48609.5,-313.5C48577.39,-309.75 48545.31,-306.54 48514.33,-304.17 47488.34,-225.72 31241.66,-204.3 28783.81,-201.5"/>
<polygon fill="black" stroke="black" points="28783.53,-198 28773.53,-201.49 28783.53,-205 28783.53,-198"/>
</g>
<!-- layer61_dispatch_dp1_tp1_ep8 -->
<g id="node744" class="node">
<title>layer61_dispatch_dp1_tp1_ep8</title>
<polygon fill="lightgreen" stroke="black" points="50472.48,-952.33 49785.02,-952.33 49608.17,-816.33 50295.63,-816.33 50472.48,-952.33"/>
<text text-anchor="middle" x="50040.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="50040.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 248</text>
<text text-anchor="middle" x="50040.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="50040.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp1_ep8&#45;&gt;layer61_dispatch_dp1_tp1_ep8 -->
<g id="edge868" class="edge">
<title>layer61_gate_dp1_tp1_ep8&#45;&gt;layer61_dispatch_dp1_tp1_ep8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50011.3,-988.14C50013.7,-979.65 50016.17,-970.9 50018.6,-962.27"/>
<polygon fill="black" stroke="black" points="50021.99,-963.17 50021.34,-952.59 50015.25,-961.26 50021.99,-963.17"/>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep8 -->
<g id="node745" class="node">
<title>layer61_expert_mlp_dp1_tp1_ep8</title>
<polygon fill="lightblue" stroke="black" points="50179.83,-780.33 49828.83,-780.33 49828.83,-712.33 50179.83,-712.33 50179.83,-780.33"/>
<text text-anchor="middle" x="50004.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="50004.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 248</text>
<text text-anchor="middle" x="50004.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="50004.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp1_ep8&#45;&gt;layer61_expert_mlp_dp1_tp1_ep8 -->
<g id="edge869" class="edge">
<title>layer61_dispatch_dp1_tp1_ep8&#45;&gt;layer61_expert_mlp_dp1_tp1_ep8</title>
<path fill="none" stroke="black" d="M50022.54,-816.13C50020.19,-807.28 50017.85,-798.41 50015.65,-790.13"/>
<polygon fill="black" stroke="black" points="50019.01,-789.12 50013.07,-780.35 50012.24,-790.91 50019.01,-789.12"/>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep8 -->
<g id="node746" class="node">
<title>layer61_expert_proj_dp1_tp1_ep8</title>
<polygon fill="lightblue" stroke="black" points="50036.83,-676.33 49685.83,-676.33 49685.83,-608.33 50036.83,-608.33 50036.83,-676.33"/>
<text text-anchor="middle" x="49861.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="49861.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 248</text>
<text text-anchor="middle" x="49861.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="49861.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep8&#45;&gt;layer61_expert_proj_dp1_tp1_ep8 -->
<g id="edge870" class="edge">
<title>layer61_expert_mlp_dp1_tp1_ep8&#45;&gt;layer61_expert_proj_dp1_tp1_ep8</title>
<path fill="none" stroke="black" d="M49957.9,-712.22C49944.66,-702.77 49930.11,-692.4 49916.41,-682.62"/>
<polygon fill="black" stroke="black" points="49918.18,-679.59 49908.01,-676.63 49914.12,-685.29 49918.18,-679.59"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep8 -->
<g id="node747" class="node">
<title>layer61_expert_allreduce_dp1_tp1_ep8</title>
<ellipse fill="lightyellow" stroke="black" cx="49789.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="49789.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="49789.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 248</text>
<text text-anchor="middle" x="49789.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="49789.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep8&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep8 -->
<g id="edge871" class="edge">
<title>layer61_expert_proj_dp1_tp1_ep8&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep8</title>
<path fill="none" stroke="black" d="M49840.69,-608.07C49835.47,-599.64 49829.71,-590.35 49823.99,-581.14"/>
<polygon fill="black" stroke="black" points="49826.79,-579.01 49818.55,-572.36 49820.84,-582.7 49826.79,-579.01"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep8 -->
<g id="node748" class="node">
<title>layer61_aggregate_dp1_tp1_ep8</title>
<polygon fill="lightpink" stroke="black" points="50119.27,-440.17 49537.13,-440.17 49387.38,-304.17 49969.52,-304.17 50119.27,-440.17"/>
<text text-anchor="middle" x="49753.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="49753.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 248</text>
<text text-anchor="middle" x="49753.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="49753.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep8&#45;&gt;layer61_aggregate_dp1_tp1_ep8 -->
<g id="edge872" class="edge">
<title>layer61_expert_allreduce_dp1_tp1_ep8&#45;&gt;layer61_aggregate_dp1_tp1_ep8</title>
<path fill="none" stroke="black" d="M49778.03,-476.17C49776.06,-467.93 49773.95,-459.16 49771.84,-450.35"/>
<polygon fill="black" stroke="black" points="49775.19,-449.32 49769.46,-440.41 49768.39,-450.95 49775.19,-449.32"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep8&#45;&gt;output_agg -->
<g id="edge971" class="edge">
<title>layer61_aggregate_dp1_tp1_ep8&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M49393.06,-309.35C49375.26,-307.35 49357.61,-305.6 49340.33,-304.17 48270.72,-215.31 31295.71,-202.7 28783.12,-201.32"/>
<polygon fill="black" stroke="black" points="28783.07,-197.82 28773.06,-201.31 28783.06,-204.82 28783.07,-197.82"/>
</g>
<!-- layer61_dispatch_dp1_tp1_ep9 -->
<g id="node750" class="node">
<title>layer61_dispatch_dp1_tp1_ep9</title>
<polygon fill="lightgreen" stroke="black" points="51355.48,-952.33 50668.02,-952.33 50491.17,-816.33 51178.63,-816.33 51355.48,-952.33"/>
<text text-anchor="middle" x="50923.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="50923.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 249</text>
<text text-anchor="middle" x="50923.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="50923.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp1_ep9&#45;&gt;layer61_dispatch_dp1_tp1_ep9 -->
<g id="edge874" class="edge">
<title>layer61_gate_dp1_tp1_ep9&#45;&gt;layer61_dispatch_dp1_tp1_ep9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50893.69,-988.14C50896.14,-979.65 50898.66,-970.9 50901.15,-962.27"/>
<polygon fill="black" stroke="black" points="50904.53,-963.17 50903.94,-952.59 50897.81,-961.23 50904.53,-963.17"/>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep9 -->
<g id="node751" class="node">
<title>layer61_expert_mlp_dp1_tp1_ep9</title>
<polygon fill="lightblue" stroke="black" points="51046.83,-780.33 50695.83,-780.33 50695.83,-712.33 51046.83,-712.33 51046.83,-780.33"/>
<text text-anchor="middle" x="50871.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="50871.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 249</text>
<text text-anchor="middle" x="50871.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="50871.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp1_ep9&#45;&gt;layer61_expert_mlp_dp1_tp1_ep9 -->
<g id="edge875" class="edge">
<title>layer61_dispatch_dp1_tp1_ep9&#45;&gt;layer61_expert_mlp_dp1_tp1_ep9</title>
<path fill="none" stroke="black" d="M50897.63,-816.13C50894.21,-807.18 50890.78,-798.22 50887.58,-789.85"/>
<polygon fill="black" stroke="black" points="50890.79,-788.44 50883.95,-780.35 50884.25,-790.94 50890.79,-788.44"/>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep9 -->
<g id="node752" class="node">
<title>layer61_expert_proj_dp1_tp1_ep9</title>
<polygon fill="lightblue" stroke="black" points="51046.83,-676.33 50695.83,-676.33 50695.83,-608.33 51046.83,-608.33 51046.83,-676.33"/>
<text text-anchor="middle" x="50871.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="50871.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 249</text>
<text text-anchor="middle" x="50871.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="50871.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep9&#45;&gt;layer61_expert_proj_dp1_tp1_ep9 -->
<g id="edge876" class="edge">
<title>layer61_expert_mlp_dp1_tp1_ep9&#45;&gt;layer61_expert_proj_dp1_tp1_ep9</title>
<path fill="none" stroke="black" d="M50871.33,-712.22C50871.33,-704.11 50871.33,-695.32 50871.33,-686.81"/>
<polygon fill="black" stroke="black" points="50874.83,-686.63 50871.33,-676.63 50867.83,-686.63 50874.83,-686.63"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep9 -->
<g id="node753" class="node">
<title>layer61_expert_allreduce_dp1_tp1_ep9</title>
<ellipse fill="lightyellow" stroke="black" cx="50620.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="50620.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="50620.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 249</text>
<text text-anchor="middle" x="50620.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="50620.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep9&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep9 -->
<g id="edge877" class="edge">
<title>layer61_expert_proj_dp1_tp1_ep9&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep9</title>
<path fill="none" stroke="black" d="M50799.74,-608.22C50776.12,-597.3 50749.36,-584.92 50723.85,-573.13"/>
<polygon fill="black" stroke="black" points="50725.06,-569.83 50714.51,-568.81 50722.12,-576.18 50725.06,-569.83"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep9 -->
<g id="node754" class="node">
<title>layer61_aggregate_dp1_tp1_ep9</title>
<polygon fill="lightpink" stroke="black" points="50888.27,-440.17 50306.13,-440.17 50156.38,-304.17 50738.52,-304.17 50888.27,-440.17"/>
<text text-anchor="middle" x="50522.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="50522.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 249</text>
<text text-anchor="middle" x="50522.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="50522.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep9&#45;&gt;layer61_aggregate_dp1_tp1_ep9 -->
<g id="edge878" class="edge">
<title>layer61_expert_allreduce_dp1_tp1_ep9&#45;&gt;layer61_aggregate_dp1_tp1_ep9</title>
<path fill="none" stroke="black" d="M50589.59,-476.17C50583.91,-467.49 50577.86,-458.21 50571.8,-448.93"/>
<polygon fill="black" stroke="black" points="50574.63,-446.87 50566.24,-440.41 50568.77,-450.7 50574.63,-446.87"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep9&#45;&gt;output_agg -->
<g id="edge972" class="edge">
<title>layer61_aggregate_dp1_tp1_ep9&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M50159.53,-307.19C50149.03,-306.07 50138.61,-305.06 50128.33,-304.17 49017.07,-207.69 31351.28,-201.57 28783.59,-201.19"/>
<polygon fill="black" stroke="black" points="28783.32,-197.69 28773.31,-201.19 28783.31,-204.69 28783.32,-197.69"/>
</g>
<!-- layer61_dispatch_dp1_tp1_ep10 -->
<g id="node756" class="node">
<title>layer61_dispatch_dp1_tp1_ep10</title>
<polygon fill="lightgreen" stroke="black" points="52238.48,-952.33 51551.02,-952.33 51374.17,-816.33 52061.63,-816.33 52238.48,-952.33"/>
<text text-anchor="middle" x="51806.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="51806.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 250</text>
<text text-anchor="middle" x="51806.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="51806.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp1_ep10&#45;&gt;layer61_dispatch_dp1_tp1_ep10 -->
<g id="edge880" class="edge">
<title>layer61_gate_dp1_tp1_ep10&#45;&gt;layer61_dispatch_dp1_tp1_ep10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M51776.09,-988.14C51778.59,-979.65 51781.16,-970.9 51783.7,-962.27"/>
<polygon fill="black" stroke="black" points="51787.08,-963.17 51786.54,-952.59 51780.37,-961.2 51787.08,-963.17"/>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep10 -->
<g id="node757" class="node">
<title>layer61_expert_mlp_dp1_tp1_ep10</title>
<polygon fill="lightblue" stroke="black" points="51872.83,-780.33 51521.83,-780.33 51521.83,-712.33 51872.83,-712.33 51872.83,-780.33"/>
<text text-anchor="middle" x="51697.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="51697.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 250</text>
<text text-anchor="middle" x="51697.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="51697.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp1_ep10&#45;&gt;layer61_expert_mlp_dp1_tp1_ep10 -->
<g id="edge881" class="edge">
<title>layer61_dispatch_dp1_tp1_ep10&#45;&gt;layer61_expert_mlp_dp1_tp1_ep10</title>
<path fill="none" stroke="black" d="M51752.46,-816.13C51744.83,-806.6 51737.17,-797.05 51730.1,-788.23"/>
<polygon fill="black" stroke="black" points="51732.77,-785.96 51723.79,-780.35 51727.31,-790.34 51732.77,-785.96"/>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep10 -->
<g id="node758" class="node">
<title>layer61_expert_proj_dp1_tp1_ep10</title>
<polygon fill="lightblue" stroke="black" points="51610.83,-676.33 51259.83,-676.33 51259.83,-608.33 51610.83,-608.33 51610.83,-676.33"/>
<text text-anchor="middle" x="51435.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="51435.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 250</text>
<text text-anchor="middle" x="51435.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="51435.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep10&#45;&gt;layer61_expert_proj_dp1_tp1_ep10 -->
<g id="edge882" class="edge">
<title>layer61_expert_mlp_dp1_tp1_ep10&#45;&gt;layer61_expert_proj_dp1_tp1_ep10</title>
<path fill="none" stroke="black" d="M51612.26,-712.22C51585.93,-701.97 51556.77,-690.61 51529.84,-680.13"/>
<polygon fill="black" stroke="black" points="51531,-676.82 51520.41,-676.46 51528.46,-683.35 51531,-676.82"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep10 -->
<g id="node759" class="node">
<title>layer61_expert_allreduce_dp1_tp1_ep10</title>
<ellipse fill="lightyellow" stroke="black" cx="51333.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="51333.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="51333.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 250</text>
<text text-anchor="middle" x="51333.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="51333.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep10&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep10 -->
<g id="edge883" class="edge">
<title>layer61_expert_proj_dp1_tp1_ep10&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep10</title>
<path fill="none" stroke="black" d="M51406.1,-608.07C51398.29,-599.19 51389.65,-589.35 51381.13,-579.65"/>
<polygon fill="black" stroke="black" points="51383.57,-577.13 51374.34,-571.93 51378.31,-581.75 51383.57,-577.13"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep10 -->
<g id="node760" class="node">
<title>layer61_aggregate_dp1_tp1_ep10</title>
<polygon fill="lightpink" stroke="black" points="51648.27,-440.17 51066.13,-440.17 50916.38,-304.17 51498.52,-304.17 51648.27,-440.17"/>
<text text-anchor="middle" x="51282.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="51282.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 250</text>
<text text-anchor="middle" x="51282.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="51282.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep10&#45;&gt;layer61_aggregate_dp1_tp1_ep10 -->
<g id="edge884" class="edge">
<title>layer61_expert_allreduce_dp1_tp1_ep10&#45;&gt;layer61_aggregate_dp1_tp1_ep10</title>
<path fill="none" stroke="black" d="M51317.33,-476.17C51314.5,-467.84 51311.48,-458.97 51308.46,-450.07"/>
<polygon fill="black" stroke="black" points="51311.71,-448.75 51305.18,-440.41 51305.08,-451.01 51311.71,-448.75"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep10&#45;&gt;output_agg -->
<g id="edge973" class="edge">
<title>layer61_aggregate_dp1_tp1_ep10&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M50918.54,-306.2C50911.41,-305.47 50904.34,-304.79 50897.33,-304.17 49745.17,-202 31401.76,-200.76 28783.43,-201.1"/>
<polygon fill="black" stroke="black" points="28782.95,-197.6 28772.95,-201.11 28782.95,-204.6 28782.95,-197.6"/>
</g>
<!-- layer61_dispatch_dp1_tp1_ep11 -->
<g id="node762" class="node">
<title>layer61_dispatch_dp1_tp1_ep11</title>
<polygon fill="lightgreen" stroke="black" points="53121.48,-952.33 52434.02,-952.33 52257.17,-816.33 52944.63,-816.33 53121.48,-952.33"/>
<text text-anchor="middle" x="52689.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="52689.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 251</text>
<text text-anchor="middle" x="52689.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="52689.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp1_ep11&#45;&gt;layer61_dispatch_dp1_tp1_ep11 -->
<g id="edge886" class="edge">
<title>layer61_gate_dp1_tp1_ep11&#45;&gt;layer61_dispatch_dp1_tp1_ep11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52659.09,-988.14C52661.59,-979.65 52664.16,-970.9 52666.7,-962.27"/>
<polygon fill="black" stroke="black" points="52670.08,-963.17 52669.54,-952.59 52663.37,-961.2 52670.08,-963.17"/>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep11 -->
<g id="node763" class="node">
<title>layer61_expert_mlp_dp1_tp1_ep11</title>
<polygon fill="lightblue" stroke="black" points="52822.83,-780.33 52471.83,-780.33 52471.83,-712.33 52822.83,-712.33 52822.83,-780.33"/>
<text text-anchor="middle" x="52647.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="52647.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 251</text>
<text text-anchor="middle" x="52647.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="52647.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp1_ep11&#45;&gt;layer61_expert_mlp_dp1_tp1_ep11 -->
<g id="edge887" class="edge">
<title>layer61_dispatch_dp1_tp1_ep11&#45;&gt;layer61_expert_mlp_dp1_tp1_ep11</title>
<path fill="none" stroke="black" d="M52668.57,-816.13C52665.84,-807.28 52663.1,-798.41 52660.54,-790.13"/>
<polygon fill="black" stroke="black" points="52663.82,-788.87 52657.52,-780.35 52657.13,-790.94 52663.82,-788.87"/>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep11 -->
<g id="node764" class="node">
<title>layer61_expert_proj_dp1_tp1_ep11</title>
<polygon fill="lightblue" stroke="black" points="52658.83,-676.33 52307.83,-676.33 52307.83,-608.33 52658.83,-608.33 52658.83,-676.33"/>
<text text-anchor="middle" x="52483.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="52483.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 251</text>
<text text-anchor="middle" x="52483.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="52483.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep11&#45;&gt;layer61_expert_proj_dp1_tp1_ep11 -->
<g id="edge888" class="edge">
<title>layer61_expert_mlp_dp1_tp1_ep11&#45;&gt;layer61_expert_proj_dp1_tp1_ep11</title>
<path fill="none" stroke="black" d="M52594.08,-712.22C52578.53,-702.55 52561.41,-691.9 52545.37,-681.92"/>
<polygon fill="black" stroke="black" points="52546.93,-678.77 52536.59,-676.46 52543.23,-684.71 52546.93,-678.77"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep11 -->
<g id="node765" class="node">
<title>layer61_expert_allreduce_dp1_tp1_ep11</title>
<ellipse fill="lightyellow" stroke="black" cx="52401.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="52401.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="52401.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 251</text>
<text text-anchor="middle" x="52401.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="52401.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep11&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep11 -->
<g id="edge889" class="edge">
<title>layer61_expert_proj_dp1_tp1_ep11&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep11</title>
<path fill="none" stroke="black" d="M52459.83,-608.07C52453.68,-599.36 52446.88,-589.74 52440.16,-580.23"/>
<polygon fill="black" stroke="black" points="52442.93,-578.08 52434.3,-571.93 52437.21,-582.11 52442.93,-578.08"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep11 -->
<g id="node766" class="node">
<title>layer61_aggregate_dp1_tp1_ep11</title>
<polygon fill="lightpink" stroke="black" points="52726.27,-440.17 52144.13,-440.17 51994.38,-304.17 52576.52,-304.17 52726.27,-440.17"/>
<text text-anchor="middle" x="52360.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="52360.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 251</text>
<text text-anchor="middle" x="52360.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="52360.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep11&#45;&gt;layer61_aggregate_dp1_tp1_ep11 -->
<g id="edge890" class="edge">
<title>layer61_expert_allreduce_dp1_tp1_ep11&#45;&gt;layer61_aggregate_dp1_tp1_ep11</title>
<path fill="none" stroke="black" d="M52388.47,-476.17C52386.19,-467.84 52383.77,-458.97 52381.33,-450.07"/>
<polygon fill="black" stroke="black" points="52384.71,-449.14 52378.7,-440.41 52377.96,-450.98 52384.71,-449.14"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep11&#45;&gt;output_agg -->
<g id="edge974" class="edge">
<title>layer61_aggregate_dp1_tp1_ep11&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M52025.98,-333.06C51909.48,-321.44 51777.79,-310.16 51657.33,-304.17 50461.44,-244.65 31453.39,-206.78 28783.87,-201.74"/>
<polygon fill="black" stroke="black" points="28783.68,-198.24 28773.68,-201.72 28783.67,-205.24 28783.68,-198.24"/>
</g>
<!-- layer61_dispatch_dp1_tp1_ep12 -->
<g id="node768" class="node">
<title>layer61_dispatch_dp1_tp1_ep12</title>
<polygon fill="lightgreen" stroke="black" points="54004.48,-952.33 53317.02,-952.33 53140.17,-816.33 53827.63,-816.33 54004.48,-952.33"/>
<text text-anchor="middle" x="53572.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="53572.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 252</text>
<text text-anchor="middle" x="53572.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="53572.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp1_ep12&#45;&gt;layer61_dispatch_dp1_tp1_ep12 -->
<g id="edge892" class="edge">
<title>layer61_gate_dp1_tp1_ep12&#45;&gt;layer61_dispatch_dp1_tp1_ep12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53542.09,-988.14C53544.59,-979.65 53547.16,-970.9 53549.7,-962.27"/>
<polygon fill="black" stroke="black" points="53553.08,-963.17 53552.54,-952.59 53546.37,-961.2 53553.08,-963.17"/>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep12 -->
<g id="node769" class="node">
<title>layer61_expert_mlp_dp1_tp1_ep12</title>
<polygon fill="lightblue" stroke="black" points="53718.83,-780.33 53367.83,-780.33 53367.83,-712.33 53718.83,-712.33 53718.83,-780.33"/>
<text text-anchor="middle" x="53543.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="53543.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 252</text>
<text text-anchor="middle" x="53543.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="53543.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp1_ep12&#45;&gt;layer61_expert_mlp_dp1_tp1_ep12 -->
<g id="edge893" class="edge">
<title>layer61_dispatch_dp1_tp1_ep12&#45;&gt;layer61_expert_mlp_dp1_tp1_ep12</title>
<path fill="none" stroke="black" d="M53558,-816.13C53556.13,-807.38 53554.26,-798.61 53552.51,-790.4"/>
<polygon fill="black" stroke="black" points="53555.87,-789.4 53550.37,-780.35 53549.03,-790.86 53555.87,-789.4"/>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep12 -->
<g id="node770" class="node">
<title>layer61_expert_proj_dp1_tp1_ep12</title>
<polygon fill="lightblue" stroke="black" points="53603.83,-676.33 53252.83,-676.33 53252.83,-608.33 53603.83,-608.33 53603.83,-676.33"/>
<text text-anchor="middle" x="53428.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="53428.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 252</text>
<text text-anchor="middle" x="53428.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="53428.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep12&#45;&gt;layer61_expert_proj_dp1_tp1_ep12 -->
<g id="edge894" class="edge">
<title>layer61_expert_mlp_dp1_tp1_ep12&#45;&gt;layer61_expert_proj_dp1_tp1_ep12</title>
<path fill="none" stroke="black" d="M53505.99,-712.22C53495.64,-703.04 53484.3,-692.98 53473.56,-683.46"/>
<polygon fill="black" stroke="black" points="53475.67,-680.65 53465.87,-676.63 53471.03,-685.89 53475.67,-680.65"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep12 -->
<g id="node771" class="node">
<title>layer61_expert_allreduce_dp1_tp1_ep12</title>
<ellipse fill="lightyellow" stroke="black" cx="53370.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="53370.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="53370.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 252</text>
<text text-anchor="middle" x="53370.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="53370.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep12&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep12 -->
<g id="edge895" class="edge">
<title>layer61_expert_proj_dp1_tp1_ep12&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep12</title>
<path fill="none" stroke="black" d="M53411.71,-608.07C53407.54,-599.73 53402.95,-590.55 53398.39,-581.43"/>
<polygon fill="black" stroke="black" points="53401.46,-579.74 53393.86,-572.36 53395.2,-582.87 53401.46,-579.74"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep12 -->
<g id="node772" class="node">
<title>layer61_aggregate_dp1_tp1_ep12</title>
<polygon fill="lightpink" stroke="black" points="53707.27,-440.17 53125.13,-440.17 52975.38,-304.17 53557.52,-304.17 53707.27,-440.17"/>
<text text-anchor="middle" x="53341.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="53341.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 252</text>
<text text-anchor="middle" x="53341.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="53341.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep12&#45;&gt;layer61_aggregate_dp1_tp1_ep12 -->
<g id="edge896" class="edge">
<title>layer61_expert_allreduce_dp1_tp1_ep12&#45;&gt;layer61_aggregate_dp1_tp1_ep12</title>
<path fill="none" stroke="black" d="M53361.23,-476.17C53359.64,-467.93 53357.94,-459.16 53356.24,-450.35"/>
<polygon fill="black" stroke="black" points="53359.65,-449.57 53354.32,-440.41 53352.78,-450.9 53359.65,-449.57"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep12&#45;&gt;output_agg -->
<g id="edge975" class="edge">
<title>layer61_aggregate_dp1_tp1_ep12&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M53000.53,-327.09C52914.16,-317.68 52821.45,-309.1 52735.33,-304.17 51482.12,-232.43 31521.62,-204.98 28783.66,-201.54"/>
<polygon fill="black" stroke="black" points="28783.46,-198.04 28773.45,-201.53 28783.45,-205.04 28783.46,-198.04"/>
</g>
<!-- layer61_dispatch_dp1_tp1_ep13 -->
<g id="node774" class="node">
<title>layer61_dispatch_dp1_tp1_ep13</title>
<polygon fill="lightgreen" stroke="black" points="54887.48,-952.33 54200.02,-952.33 54023.17,-816.33 54710.63,-816.33 54887.48,-952.33"/>
<text text-anchor="middle" x="54455.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="54455.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 253</text>
<text text-anchor="middle" x="54455.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="54455.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp1_ep13&#45;&gt;layer61_dispatch_dp1_tp1_ep13 -->
<g id="edge898" class="edge">
<title>layer61_gate_dp1_tp1_ep13&#45;&gt;layer61_dispatch_dp1_tp1_ep13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M54425.09,-988.14C54427.59,-979.65 54430.16,-970.9 54432.7,-962.27"/>
<polygon fill="black" stroke="black" points="54436.08,-963.17 54435.54,-952.59 54429.37,-961.2 54436.08,-963.17"/>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep13 -->
<g id="node775" class="node">
<title>layer61_expert_mlp_dp1_tp1_ep13</title>
<polygon fill="lightblue" stroke="black" points="54622.83,-780.33 54271.83,-780.33 54271.83,-712.33 54622.83,-712.33 54622.83,-780.33"/>
<text text-anchor="middle" x="54447.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="54447.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 253</text>
<text text-anchor="middle" x="54447.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="54447.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp1_ep13&#45;&gt;layer61_expert_mlp_dp1_tp1_ep13 -->
<g id="edge899" class="edge">
<title>layer61_dispatch_dp1_tp1_ep13&#45;&gt;layer61_expert_mlp_dp1_tp1_ep13</title>
<path fill="none" stroke="black" d="M54451.37,-816.13C54450.86,-807.38 54450.34,-798.61 54449.86,-790.4"/>
<polygon fill="black" stroke="black" points="54453.35,-790.13 54449.27,-780.35 54446.36,-790.54 54453.35,-790.13"/>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep13 -->
<g id="node776" class="node">
<title>layer61_expert_proj_dp1_tp1_ep13</title>
<polygon fill="lightblue" stroke="black" points="54591.83,-676.33 54240.83,-676.33 54240.83,-608.33 54591.83,-608.33 54591.83,-676.33"/>
<text text-anchor="middle" x="54416.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="54416.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 253</text>
<text text-anchor="middle" x="54416.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="54416.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep13&#45;&gt;layer61_expert_proj_dp1_tp1_ep13 -->
<g id="edge900" class="edge">
<title>layer61_expert_mlp_dp1_tp1_ep13&#45;&gt;layer61_expert_proj_dp1_tp1_ep13</title>
<path fill="none" stroke="black" d="M54437.26,-712.22C54434.74,-703.93 54432.01,-694.93 54429.37,-686.24"/>
<polygon fill="black" stroke="black" points="54432.7,-685.18 54426.45,-676.63 54426.01,-687.22 54432.7,-685.18"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep13 -->
<g id="node777" class="node">
<title>layer61_expert_allreduce_dp1_tp1_ep13</title>
<ellipse fill="lightyellow" stroke="black" cx="54401.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="54401.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="54401.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 253</text>
<text text-anchor="middle" x="54401.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="54401.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep13&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep13 -->
<g id="edge901" class="edge">
<title>layer61_expert_proj_dp1_tp1_ep13&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep13</title>
<path fill="none" stroke="black" d="M54412.03,-608.07C54410.98,-599.99 54409.84,-591.12 54408.7,-582.28"/>
<polygon fill="black" stroke="black" points="54412.17,-581.83 54407.41,-572.36 54405.22,-582.73 54412.17,-581.83"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep13 -->
<g id="node778" class="node">
<title>layer61_aggregate_dp1_tp1_ep13</title>
<polygon fill="lightpink" stroke="black" points="54580.27,-440.17 53998.13,-440.17 53848.38,-304.17 54430.52,-304.17 54580.27,-440.17"/>
<text text-anchor="middle" x="54214.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="54214.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 253</text>
<text text-anchor="middle" x="54214.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="54214.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep13&#45;&gt;layer61_aggregate_dp1_tp1_ep13 -->
<g id="edge902" class="edge">
<title>layer61_expert_allreduce_dp1_tp1_ep13&#45;&gt;layer61_aggregate_dp1_tp1_ep13</title>
<path fill="none" stroke="black" d="M54344.2,-477.4C54332.11,-467.7 54319.05,-457.21 54306.03,-446.77"/>
<polygon fill="black" stroke="black" points="54307.94,-443.81 54297.95,-440.28 54303.56,-449.27 54307.94,-443.81"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep13&#45;&gt;output_agg -->
<g id="edge976" class="edge">
<title>layer61_aggregate_dp1_tp1_ep13&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M53863.6,-318.19C53814.25,-312.42 53764.08,-307.46 53716.33,-304.17 52411.41,-214.11 31581.15,-202.44 28783.22,-201.28"/>
<polygon fill="black" stroke="black" points="28783.05,-197.78 28773.04,-201.28 28783.04,-204.78 28783.05,-197.78"/>
</g>
<!-- layer61_dispatch_dp1_tp1_ep14 -->
<g id="node780" class="node">
<title>layer61_dispatch_dp1_tp1_ep14</title>
<polygon fill="lightgreen" stroke="black" points="55770.48,-952.33 55083.02,-952.33 54906.17,-816.33 55593.63,-816.33 55770.48,-952.33"/>
<text text-anchor="middle" x="55338.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="55338.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 254</text>
<text text-anchor="middle" x="55338.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="55338.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp1_ep14&#45;&gt;layer61_dispatch_dp1_tp1_ep14 -->
<g id="edge904" class="edge">
<title>layer61_gate_dp1_tp1_ep14&#45;&gt;layer61_dispatch_dp1_tp1_ep14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55308.09,-988.14C55310.59,-979.65 55313.16,-970.9 55315.7,-962.27"/>
<polygon fill="black" stroke="black" points="55319.08,-963.17 55318.54,-952.59 55312.37,-961.2 55319.08,-963.17"/>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep14 -->
<g id="node781" class="node">
<title>layer61_expert_mlp_dp1_tp1_ep14</title>
<polygon fill="lightblue" stroke="black" points="55505.83,-780.33 55154.83,-780.33 55154.83,-712.33 55505.83,-712.33 55505.83,-780.33"/>
<text text-anchor="middle" x="55330.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="55330.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 254</text>
<text text-anchor="middle" x="55330.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="55330.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp1_ep14&#45;&gt;layer61_expert_mlp_dp1_tp1_ep14 -->
<g id="edge905" class="edge">
<title>layer61_dispatch_dp1_tp1_ep14&#45;&gt;layer61_expert_mlp_dp1_tp1_ep14</title>
<path fill="none" stroke="black" d="M55334.37,-816.13C55333.86,-807.38 55333.34,-798.61 55332.86,-790.4"/>
<polygon fill="black" stroke="black" points="55336.35,-790.13 55332.27,-780.35 55329.36,-790.54 55336.35,-790.13"/>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep14 -->
<g id="node782" class="node">
<title>layer61_expert_proj_dp1_tp1_ep14</title>
<polygon fill="lightblue" stroke="black" points="55334.83,-676.33 54983.83,-676.33 54983.83,-608.33 55334.83,-608.33 55334.83,-676.33"/>
<text text-anchor="middle" x="55159.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="55159.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 254</text>
<text text-anchor="middle" x="55159.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="55159.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep14&#45;&gt;layer61_expert_proj_dp1_tp1_ep14 -->
<g id="edge906" class="edge">
<title>layer61_expert_mlp_dp1_tp1_ep14&#45;&gt;layer61_expert_proj_dp1_tp1_ep14</title>
<path fill="none" stroke="black" d="M55274.81,-712.22C55258.45,-702.46 55240.41,-691.7 55223.55,-681.64"/>
<polygon fill="black" stroke="black" points="55225.24,-678.57 55214.86,-676.46 55221.65,-684.59 55225.24,-678.57"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep14 -->
<g id="node783" class="node">
<title>layer61_expert_allreduce_dp1_tp1_ep14</title>
<ellipse fill="lightyellow" stroke="black" cx="55033.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="55033.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="55033.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 254</text>
<text text-anchor="middle" x="55033.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="55033.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep14&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep14 -->
<g id="edge907" class="edge">
<title>layer61_expert_proj_dp1_tp1_ep14&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep14</title>
<path fill="none" stroke="black" d="M55123.22,-608.07C55113.18,-598.81 55102.01,-588.53 55091.05,-578.43"/>
<polygon fill="black" stroke="black" points="55093.25,-575.7 55083.52,-571.5 55088.51,-580.84 55093.25,-575.7"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep14 -->
<g id="node784" class="node">
<title>layer61_aggregate_dp1_tp1_ep14</title>
<polygon fill="lightpink" stroke="black" points="55391.27,-440.17 54809.13,-440.17 54659.38,-304.17 55241.52,-304.17 55391.27,-440.17"/>
<text text-anchor="middle" x="55025.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="55025.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 254</text>
<text text-anchor="middle" x="55025.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="55025.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep14&#45;&gt;layer61_aggregate_dp1_tp1_ep14 -->
<g id="edge908" class="edge">
<title>layer61_expert_allreduce_dp1_tp1_ep14&#45;&gt;layer61_aggregate_dp1_tp1_ep14</title>
<path fill="none" stroke="black" d="M55030.79,-475.76C55030.36,-467.68 55029.91,-459.09 55029.45,-450.47"/>
<polygon fill="black" stroke="black" points="55032.94,-450.16 55028.91,-440.36 55025.95,-450.53 55032.94,-450.16"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep14&#45;&gt;output_agg -->
<g id="edge977" class="edge">
<title>layer61_aggregate_dp1_tp1_ep14&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M54667.73,-311.85C54641.25,-308.8 54614.9,-306.17 54589.33,-304.17 53238.49,-198.3 31633.88,-200.34 28782.99,-201.07"/>
<polygon fill="black" stroke="black" points="28782.88,-197.57 28772.88,-201.07 28782.88,-204.57 28782.88,-197.57"/>
</g>
<!-- layer61_dispatch_dp1_tp1_ep15 -->
<g id="node786" class="node">
<title>layer61_dispatch_dp1_tp1_ep15</title>
<polygon fill="lightgreen" stroke="black" points="56653.48,-952.33 55966.02,-952.33 55789.17,-816.33 56476.63,-816.33 56653.48,-952.33"/>
<text text-anchor="middle" x="56221.33" y="-903.13" font-family="Times,serif" font-size="14.00">LAYER61_DISPATCH</text>
<text text-anchor="middle" x="56221.33" y="-888.13" font-family="Times,serif" font-size="14.00">GPU: 255</text>
<text text-anchor="middle" x="56221.33" y="-873.13" font-family="Times,serif" font-size="14.00">Input: [batch=512, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="56221.33" y="-858.13" font-family="Times,serif" font-size="14.00">Output: [tokens_selected=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_gate_dp1_tp1_ep15&#45;&gt;layer61_dispatch_dp1_tp1_ep15 -->
<g id="edge910" class="edge">
<title>layer61_gate_dp1_tp1_ep15&#45;&gt;layer61_dispatch_dp1_tp1_ep15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56191.09,-988.14C56193.59,-979.65 56196.16,-970.9 56198.7,-962.27"/>
<polygon fill="black" stroke="black" points="56202.08,-963.17 56201.54,-952.59 56195.37,-961.2 56202.08,-963.17"/>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep15 -->
<g id="node787" class="node">
<title>layer61_expert_mlp_dp1_tp1_ep15</title>
<polygon fill="lightblue" stroke="black" points="56064.83,-780.33 55713.83,-780.33 55713.83,-712.33 56064.83,-712.33 56064.83,-780.33"/>
<text text-anchor="middle" x="55889.33" y="-765.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_MLP</text>
<text text-anchor="middle" x="55889.33" y="-750.13" font-family="Times,serif" font-size="14.00">GPU: 255</text>
<text text-anchor="middle" x="55889.33" y="-735.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="55889.33" y="-720.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=9216]</text>
</g>
<!-- layer61_dispatch_dp1_tp1_ep15&#45;&gt;layer61_expert_mlp_dp1_tp1_ep15 -->
<g id="edge911" class="edge">
<title>layer61_dispatch_dp1_tp1_ep15&#45;&gt;layer61_expert_mlp_dp1_tp1_ep15</title>
<path fill="none" stroke="black" d="M56057.76,-816.33C56030.88,-805.32 56003.92,-794.28 55979.69,-784.35"/>
<polygon fill="black" stroke="black" points="55980.78,-781.01 55970.2,-780.46 55978.12,-787.49 55980.78,-781.01"/>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep15 -->
<g id="node788" class="node">
<title>layer61_expert_proj_dp1_tp1_ep15</title>
<polygon fill="lightblue" stroke="black" points="56034.83,-676.33 55683.83,-676.33 55683.83,-608.33 56034.83,-608.33 56034.83,-676.33"/>
<text text-anchor="middle" x="55859.33" y="-661.13" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_PROJ</text>
<text text-anchor="middle" x="55859.33" y="-646.13" font-family="Times,serif" font-size="14.00">GPU: 255</text>
<text text-anchor="middle" x="55859.33" y="-631.13" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=9216]</text>
<text text-anchor="middle" x="55859.33" y="-616.13" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=3584]</text>
</g>
<!-- layer61_expert_mlp_dp1_tp1_ep15&#45;&gt;layer61_expert_proj_dp1_tp1_ep15 -->
<g id="edge912" class="edge">
<title>layer61_expert_mlp_dp1_tp1_ep15&#45;&gt;layer61_expert_proj_dp1_tp1_ep15</title>
<path fill="none" stroke="black" d="M55879.59,-712.22C55877.15,-703.93 55874.5,-694.93 55871.95,-686.24"/>
<polygon fill="black" stroke="black" points="55875.3,-685.24 55869.12,-676.63 55868.58,-687.21 55875.3,-685.24"/>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep15 -->
<g id="node789" class="node">
<title>layer61_expert_allreduce_dp1_tp1_ep15</title>
<ellipse fill="lightyellow" stroke="black" cx="55844.33" cy="-524.25" rx="248.39" ry="48.17"/>
<text text-anchor="middle" x="55844.33" y="-543.05" font-family="Times,serif" font-size="14.00">LAYER61_EXPERT_ALLREDUCE</text>
<text text-anchor="middle" x="55844.33" y="-528.05" font-family="Times,serif" font-size="14.00">GPU: 255</text>
<text text-anchor="middle" x="55844.33" y="-513.05" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=3584]</text>
<text text-anchor="middle" x="55844.33" y="-498.05" font-family="Times,serif" font-size="14.00">Output: [tokens=32, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_proj_dp1_tp1_ep15&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep15 -->
<g id="edge913" class="edge">
<title>layer61_expert_proj_dp1_tp1_ep15&#45;&gt;layer61_expert_allreduce_dp1_tp1_ep15</title>
<path fill="none" stroke="black" d="M55855.03,-608.07C55853.98,-599.99 55852.84,-591.12 55851.7,-582.28"/>
<polygon fill="black" stroke="black" points="55855.17,-581.83 55850.41,-572.36 55848.22,-582.73 55855.17,-581.83"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep15 -->
<g id="node790" class="node">
<title>layer61_aggregate_dp1_tp1_ep15</title>
<polygon fill="lightpink" stroke="black" points="56202.27,-440.17 55620.13,-440.17 55470.38,-304.17 56052.52,-304.17 56202.27,-440.17"/>
<text text-anchor="middle" x="55836.33" y="-390.97" font-family="Times,serif" font-size="14.00">LAYER61_AGGREGATE</text>
<text text-anchor="middle" x="55836.33" y="-375.97" font-family="Times,serif" font-size="14.00">GPU: 255</text>
<text text-anchor="middle" x="55836.33" y="-360.97" font-family="Times,serif" font-size="14.00">Input: [tokens=32, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="55836.33" y="-345.97" font-family="Times,serif" font-size="14.00">Output: [batch=512, seq=2048, hidden=7168]</text>
</g>
<!-- layer61_expert_allreduce_dp1_tp1_ep15&#45;&gt;layer61_aggregate_dp1_tp1_ep15 -->
<g id="edge914" class="edge">
<title>layer61_expert_allreduce_dp1_tp1_ep15&#45;&gt;layer61_aggregate_dp1_tp1_ep15</title>
<path fill="none" stroke="black" d="M55841.79,-475.76C55841.36,-467.68 55840.91,-459.09 55840.45,-450.47"/>
<polygon fill="black" stroke="black" points="55843.94,-450.16 55839.91,-440.36 55836.95,-450.53 55843.94,-450.16"/>
</g>
<!-- layer61_aggregate_dp1_tp1_ep15&#45;&gt;output_agg -->
<g id="edge978" class="edge">
<title>layer61_aggregate_dp1_tp1_ep15&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M55478.73,-311.85C55452.25,-308.8 55425.9,-306.17 55400.33,-304.17 54006,-194.98 31682.65,-199.92 28782.91,-201.03"/>
<polygon fill="black" stroke="black" points="28782.89,-197.53 28772.89,-201.03 28782.89,-204.53 28782.89,-197.53"/>
</g>
<!-- output -->
<g id="node792" class="node">
<title>output</title>
<ellipse fill="lightyellow" stroke="black" cx="28473.33" cy="-48.08" rx="263.09" ry="48.17"/>
<text text-anchor="middle" x="28473.33" y="-66.88" font-family="Times,serif" font-size="14.00">OUTPUT</text>
<text text-anchor="middle" x="28473.33" y="-51.88" font-family="Times,serif" font-size="14.00">GPU: ALL_DP_RANKS</text>
<text text-anchor="middle" x="28473.33" y="-36.88" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=2048, hidden=7168]</text>
<text text-anchor="middle" x="28473.33" y="-21.88" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=2048, vocab=128000]</text>
</g>
<!-- output_agg&#45;&gt;output -->
<g id="edge979" class="edge">
<title>output_agg&#45;&gt;output</title>
<path fill="none" stroke="black" d="M28473.33,-132.03C28473.33,-123.48 28473.33,-114.8 28473.33,-106.43"/>
<polygon fill="black" stroke="black" points="28476.83,-106.4 28473.33,-96.4 28469.83,-106.4 28476.83,-106.4"/>
</g>
</g>
</svg>
