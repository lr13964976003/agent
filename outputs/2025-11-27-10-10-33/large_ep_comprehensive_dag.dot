// Large-Scale Cross-Node Expert Parallelism DAG
digraph {
	dpi=300 rankdir=TB size="30,40"
	node [fillcolor=lightblue shape=rectangle style=filled]
	input [label="INPUT\nGPU: ALL_DP_RANKS\nInput: [batch=1024, seq=2048]\nOutput: [batch=1024, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	dp_split [label="DP_SPLIT\nGPU: DataParallelController\nInput: [batch=1024, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightcoral shape=parallelogram]
	input -> dp_split [style=dashed]
	layer1_mla_dp0_tp0 [label="LAYER1_MLA\nGPU: 0\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, heads=64, d_k=56]" fillcolor=lightblue]
	layer1_ffn_dp0_tp0 [label="LAYER1_FFN_TP\nGPU: 0\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer1_ffn_allreduce_dp0_tp0 [label="LAYER1_FFN_ALLREDUCE\nGPU: 0\nInput: [batch=512, seq=2048, hidden=3584]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	dp_split -> layer1_mla_dp0_tp0
	layer1_mla_dp0_tp0 -> layer1_ffn_dp0_tp0
	layer1_ffn_dp0_tp0 -> layer1_ffn_allreduce_dp0_tp0
	layer1_mla_dp0_tp1 [label="LAYER1_MLA\nGPU: 64\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, heads=64, d_k=56]" fillcolor=lightblue]
	layer1_ffn_dp0_tp1 [label="LAYER1_FFN_TP\nGPU: 64\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer1_ffn_allreduce_dp0_tp1 [label="LAYER1_FFN_ALLREDUCE\nGPU: 64\nInput: [batch=512, seq=2048, hidden=3584]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer1_mla_dp0_tp1 -> layer1_ffn_dp0_tp1
	layer1_ffn_dp0_tp1 -> layer1_ffn_allreduce_dp0_tp1
	layer1_mla_dp1_tp0 [label="LAYER1_MLA\nGPU: 128\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, heads=64, d_k=56]" fillcolor=lightblue]
	layer1_ffn_dp1_tp0 [label="LAYER1_FFN_TP\nGPU: 128\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer1_ffn_allreduce_dp1_tp0 [label="LAYER1_FFN_ALLREDUCE\nGPU: 128\nInput: [batch=512, seq=2048, hidden=3584]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer1_mla_dp1_tp0 -> layer1_ffn_dp1_tp0
	layer1_ffn_dp1_tp0 -> layer1_ffn_allreduce_dp1_tp0
	layer1_mla_dp1_tp1 [label="LAYER1_MLA\nGPU: 192\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, heads=64, d_k=56]" fillcolor=lightblue]
	layer1_ffn_dp1_tp1 [label="LAYER1_FFN_TP\nGPU: 192\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer1_ffn_allreduce_dp1_tp1 [label="LAYER1_FFN_ALLREDUCE\nGPU: 192\nInput: [batch=512, seq=2048, hidden=3584]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer1_mla_dp1_tp1 -> layer1_ffn_dp1_tp1
	layer1_ffn_dp1_tp1 -> layer1_ffn_allreduce_dp1_tp1
	layer4_mla_dp0_tp0 [label="LAYER4_MLA\nGPU: 4\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, heads=64, d_k=56]" fillcolor=lightblue]
	layer1_ffn_allreduce_dp0_tp0 -> layer4_mla_dp0_tp0
	layer1_ffn_allreduce_dp0_tp1 -> layer4_mla_dp0_tp0
	layer4_mla_dp0_tp1 [label="LAYER4_MLA\nGPU: 68\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, heads=64, d_k=56]" fillcolor=lightblue]
	layer1_ffn_allreduce_dp0_tp0 -> layer4_mla_dp0_tp1
	layer1_ffn_allreduce_dp0_tp1 -> layer4_mla_dp0_tp1
	layer4_mla_dp1_tp0 [label="LAYER4_MLA\nGPU: 132\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, heads=64, d_k=56]" fillcolor=lightblue]
	layer1_ffn_allreduce_dp1_tp0 -> layer4_mla_dp1_tp0
	layer1_ffn_allreduce_dp1_tp1 -> layer4_mla_dp1_tp0
	layer4_mla_dp1_tp1 [label="LAYER4_MLA\nGPU: 196\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, heads=64, d_k=56]" fillcolor=lightblue]
	layer1_ffn_allreduce_dp1_tp0 -> layer4_mla_dp1_tp1
	layer1_ffn_allreduce_dp1_tp1 -> layer4_mla_dp1_tp1
	layer4_gate_dp0_tp0_ep0 [label="LAYER4_GATE\nGPU: 4\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp0_ep0 [label="LAYER4_DISPATCH\nGPU: 4\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp0_ep0 [label="LAYER4_EXPERT_MLP\nGPU: 4\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp0_ep0 [label="LAYER4_EXPERT_PROJ\nGPU: 4\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp0_ep0 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 4\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp0_ep0 [label="LAYER4_AGGREGATE\nGPU: 4\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp0 -> layer4_gate_dp0_tp0_ep0 [style=dashed]
	layer4_gate_dp0_tp0_ep0 -> layer4_dispatch_dp0_tp0_ep0 [style=dashed]
	layer4_dispatch_dp0_tp0_ep0 -> layer4_expert_mlp_dp0_tp0_ep0
	layer4_expert_mlp_dp0_tp0_ep0 -> layer4_expert_proj_dp0_tp0_ep0
	layer4_expert_proj_dp0_tp0_ep0 -> layer4_expert_allreduce_dp0_tp0_ep0
	layer4_expert_allreduce_dp0_tp0_ep0 -> layer4_aggregate_dp0_tp0_ep0
	layer4_gate_dp0_tp0_ep1 [label="LAYER4_GATE\nGPU: 5\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp0_ep1 [label="LAYER4_DISPATCH\nGPU: 5\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp0_ep1 [label="LAYER4_EXPERT_MLP\nGPU: 5\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp0_ep1 [label="LAYER4_EXPERT_PROJ\nGPU: 5\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp0_ep1 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 5\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp0_ep1 [label="LAYER4_AGGREGATE\nGPU: 5\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp0 -> layer4_gate_dp0_tp0_ep1 [style=dashed]
	layer4_gate_dp0_tp0_ep1 -> layer4_dispatch_dp0_tp0_ep1 [style=dashed]
	layer4_dispatch_dp0_tp0_ep1 -> layer4_expert_mlp_dp0_tp0_ep1
	layer4_expert_mlp_dp0_tp0_ep1 -> layer4_expert_proj_dp0_tp0_ep1
	layer4_expert_proj_dp0_tp0_ep1 -> layer4_expert_allreduce_dp0_tp0_ep1
	layer4_expert_allreduce_dp0_tp0_ep1 -> layer4_aggregate_dp0_tp0_ep1
	layer4_gate_dp0_tp0_ep2 [label="LAYER4_GATE\nGPU: 6\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp0_ep2 [label="LAYER4_DISPATCH\nGPU: 6\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp0_ep2 [label="LAYER4_EXPERT_MLP\nGPU: 6\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp0_ep2 [label="LAYER4_EXPERT_PROJ\nGPU: 6\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp0_ep2 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 6\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp0_ep2 [label="LAYER4_AGGREGATE\nGPU: 6\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp0 -> layer4_gate_dp0_tp0_ep2 [style=dashed]
	layer4_gate_dp0_tp0_ep2 -> layer4_dispatch_dp0_tp0_ep2 [style=dashed]
	layer4_dispatch_dp0_tp0_ep2 -> layer4_expert_mlp_dp0_tp0_ep2
	layer4_expert_mlp_dp0_tp0_ep2 -> layer4_expert_proj_dp0_tp0_ep2
	layer4_expert_proj_dp0_tp0_ep2 -> layer4_expert_allreduce_dp0_tp0_ep2
	layer4_expert_allreduce_dp0_tp0_ep2 -> layer4_aggregate_dp0_tp0_ep2
	layer4_gate_dp0_tp0_ep3 [label="LAYER4_GATE\nGPU: 7\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp0_ep3 [label="LAYER4_DISPATCH\nGPU: 7\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp0_ep3 [label="LAYER4_EXPERT_MLP\nGPU: 7\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp0_ep3 [label="LAYER4_EXPERT_PROJ\nGPU: 7\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp0_ep3 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 7\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp0_ep3 [label="LAYER4_AGGREGATE\nGPU: 7\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp0 -> layer4_gate_dp0_tp0_ep3 [style=dashed]
	layer4_gate_dp0_tp0_ep3 -> layer4_dispatch_dp0_tp0_ep3 [style=dashed]
	layer4_dispatch_dp0_tp0_ep3 -> layer4_expert_mlp_dp0_tp0_ep3
	layer4_expert_mlp_dp0_tp0_ep3 -> layer4_expert_proj_dp0_tp0_ep3
	layer4_expert_proj_dp0_tp0_ep3 -> layer4_expert_allreduce_dp0_tp0_ep3
	layer4_expert_allreduce_dp0_tp0_ep3 -> layer4_aggregate_dp0_tp0_ep3
	layer4_gate_dp0_tp0_ep4 [label="LAYER4_GATE\nGPU: 8\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp0_ep4 [label="LAYER4_DISPATCH\nGPU: 8\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp0_ep4 [label="LAYER4_EXPERT_MLP\nGPU: 8\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp0_ep4 [label="LAYER4_EXPERT_PROJ\nGPU: 8\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp0_ep4 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 8\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp0_ep4 [label="LAYER4_AGGREGATE\nGPU: 8\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp0 -> layer4_gate_dp0_tp0_ep4 [style=dashed]
	layer4_gate_dp0_tp0_ep4 -> layer4_dispatch_dp0_tp0_ep4 [style=dashed]
	layer4_dispatch_dp0_tp0_ep4 -> layer4_expert_mlp_dp0_tp0_ep4
	layer4_expert_mlp_dp0_tp0_ep4 -> layer4_expert_proj_dp0_tp0_ep4
	layer4_expert_proj_dp0_tp0_ep4 -> layer4_expert_allreduce_dp0_tp0_ep4
	layer4_expert_allreduce_dp0_tp0_ep4 -> layer4_aggregate_dp0_tp0_ep4
	layer4_gate_dp0_tp0_ep5 [label="LAYER4_GATE\nGPU: 9\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp0_ep5 [label="LAYER4_DISPATCH\nGPU: 9\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp0_ep5 [label="LAYER4_EXPERT_MLP\nGPU: 9\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp0_ep5 [label="LAYER4_EXPERT_PROJ\nGPU: 9\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp0_ep5 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 9\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp0_ep5 [label="LAYER4_AGGREGATE\nGPU: 9\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp0 -> layer4_gate_dp0_tp0_ep5 [style=dashed]
	layer4_gate_dp0_tp0_ep5 -> layer4_dispatch_dp0_tp0_ep5 [style=dashed]
	layer4_dispatch_dp0_tp0_ep5 -> layer4_expert_mlp_dp0_tp0_ep5
	layer4_expert_mlp_dp0_tp0_ep5 -> layer4_expert_proj_dp0_tp0_ep5
	layer4_expert_proj_dp0_tp0_ep5 -> layer4_expert_allreduce_dp0_tp0_ep5
	layer4_expert_allreduce_dp0_tp0_ep5 -> layer4_aggregate_dp0_tp0_ep5
	layer4_gate_dp0_tp0_ep6 [label="LAYER4_GATE\nGPU: 10\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp0_ep6 [label="LAYER4_DISPATCH\nGPU: 10\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp0_ep6 [label="LAYER4_EXPERT_MLP\nGPU: 10\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp0_ep6 [label="LAYER4_EXPERT_PROJ\nGPU: 10\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp0_ep6 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 10\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp0_ep6 [label="LAYER4_AGGREGATE\nGPU: 10\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp0 -> layer4_gate_dp0_tp0_ep6 [style=dashed]
	layer4_gate_dp0_tp0_ep6 -> layer4_dispatch_dp0_tp0_ep6 [style=dashed]
	layer4_dispatch_dp0_tp0_ep6 -> layer4_expert_mlp_dp0_tp0_ep6
	layer4_expert_mlp_dp0_tp0_ep6 -> layer4_expert_proj_dp0_tp0_ep6
	layer4_expert_proj_dp0_tp0_ep6 -> layer4_expert_allreduce_dp0_tp0_ep6
	layer4_expert_allreduce_dp0_tp0_ep6 -> layer4_aggregate_dp0_tp0_ep6
	layer4_gate_dp0_tp0_ep7 [label="LAYER4_GATE\nGPU: 11\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp0_ep7 [label="LAYER4_DISPATCH\nGPU: 11\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp0_ep7 [label="LAYER4_EXPERT_MLP\nGPU: 11\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp0_ep7 [label="LAYER4_EXPERT_PROJ\nGPU: 11\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp0_ep7 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 11\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp0_ep7 [label="LAYER4_AGGREGATE\nGPU: 11\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp0 -> layer4_gate_dp0_tp0_ep7 [style=dashed]
	layer4_gate_dp0_tp0_ep7 -> layer4_dispatch_dp0_tp0_ep7 [style=dashed]
	layer4_dispatch_dp0_tp0_ep7 -> layer4_expert_mlp_dp0_tp0_ep7
	layer4_expert_mlp_dp0_tp0_ep7 -> layer4_expert_proj_dp0_tp0_ep7
	layer4_expert_proj_dp0_tp0_ep7 -> layer4_expert_allreduce_dp0_tp0_ep7
	layer4_expert_allreduce_dp0_tp0_ep7 -> layer4_aggregate_dp0_tp0_ep7
	layer4_gate_dp0_tp0_ep8 [label="LAYER4_GATE\nGPU: 12\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp0_ep8 [label="LAYER4_DISPATCH\nGPU: 12\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp0_ep8 [label="LAYER4_EXPERT_MLP\nGPU: 12\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp0_ep8 [label="LAYER4_EXPERT_PROJ\nGPU: 12\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp0_ep8 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 12\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp0_ep8 [label="LAYER4_AGGREGATE\nGPU: 12\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp0 -> layer4_gate_dp0_tp0_ep8 [style=dashed]
	layer4_gate_dp0_tp0_ep8 -> layer4_dispatch_dp0_tp0_ep8 [style=dashed]
	layer4_dispatch_dp0_tp0_ep8 -> layer4_expert_mlp_dp0_tp0_ep8
	layer4_expert_mlp_dp0_tp0_ep8 -> layer4_expert_proj_dp0_tp0_ep8
	layer4_expert_proj_dp0_tp0_ep8 -> layer4_expert_allreduce_dp0_tp0_ep8
	layer4_expert_allreduce_dp0_tp0_ep8 -> layer4_aggregate_dp0_tp0_ep8
	layer4_gate_dp0_tp0_ep9 [label="LAYER4_GATE\nGPU: 13\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp0_ep9 [label="LAYER4_DISPATCH\nGPU: 13\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp0_ep9 [label="LAYER4_EXPERT_MLP\nGPU: 13\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp0_ep9 [label="LAYER4_EXPERT_PROJ\nGPU: 13\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp0_ep9 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 13\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp0_ep9 [label="LAYER4_AGGREGATE\nGPU: 13\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp0 -> layer4_gate_dp0_tp0_ep9 [style=dashed]
	layer4_gate_dp0_tp0_ep9 -> layer4_dispatch_dp0_tp0_ep9 [style=dashed]
	layer4_dispatch_dp0_tp0_ep9 -> layer4_expert_mlp_dp0_tp0_ep9
	layer4_expert_mlp_dp0_tp0_ep9 -> layer4_expert_proj_dp0_tp0_ep9
	layer4_expert_proj_dp0_tp0_ep9 -> layer4_expert_allreduce_dp0_tp0_ep9
	layer4_expert_allreduce_dp0_tp0_ep9 -> layer4_aggregate_dp0_tp0_ep9
	layer4_gate_dp0_tp0_ep10 [label="LAYER4_GATE\nGPU: 14\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp0_ep10 [label="LAYER4_DISPATCH\nGPU: 14\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp0_ep10 [label="LAYER4_EXPERT_MLP\nGPU: 14\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp0_ep10 [label="LAYER4_EXPERT_PROJ\nGPU: 14\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp0_ep10 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 14\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp0_ep10 [label="LAYER4_AGGREGATE\nGPU: 14\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp0 -> layer4_gate_dp0_tp0_ep10 [style=dashed]
	layer4_gate_dp0_tp0_ep10 -> layer4_dispatch_dp0_tp0_ep10 [style=dashed]
	layer4_dispatch_dp0_tp0_ep10 -> layer4_expert_mlp_dp0_tp0_ep10
	layer4_expert_mlp_dp0_tp0_ep10 -> layer4_expert_proj_dp0_tp0_ep10
	layer4_expert_proj_dp0_tp0_ep10 -> layer4_expert_allreduce_dp0_tp0_ep10
	layer4_expert_allreduce_dp0_tp0_ep10 -> layer4_aggregate_dp0_tp0_ep10
	layer4_gate_dp0_tp0_ep11 [label="LAYER4_GATE\nGPU: 15\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp0_ep11 [label="LAYER4_DISPATCH\nGPU: 15\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp0_ep11 [label="LAYER4_EXPERT_MLP\nGPU: 15\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp0_ep11 [label="LAYER4_EXPERT_PROJ\nGPU: 15\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp0_ep11 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 15\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp0_ep11 [label="LAYER4_AGGREGATE\nGPU: 15\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp0 -> layer4_gate_dp0_tp0_ep11 [style=dashed]
	layer4_gate_dp0_tp0_ep11 -> layer4_dispatch_dp0_tp0_ep11 [style=dashed]
	layer4_dispatch_dp0_tp0_ep11 -> layer4_expert_mlp_dp0_tp0_ep11
	layer4_expert_mlp_dp0_tp0_ep11 -> layer4_expert_proj_dp0_tp0_ep11
	layer4_expert_proj_dp0_tp0_ep11 -> layer4_expert_allreduce_dp0_tp0_ep11
	layer4_expert_allreduce_dp0_tp0_ep11 -> layer4_aggregate_dp0_tp0_ep11
	layer4_gate_dp0_tp0_ep12 [label="LAYER4_GATE\nGPU: 16\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp0_ep12 [label="LAYER4_DISPATCH\nGPU: 16\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp0_ep12 [label="LAYER4_EXPERT_MLP\nGPU: 16\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp0_ep12 [label="LAYER4_EXPERT_PROJ\nGPU: 16\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp0_ep12 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 16\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp0_ep12 [label="LAYER4_AGGREGATE\nGPU: 16\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp0 -> layer4_gate_dp0_tp0_ep12 [style=dashed]
	layer4_gate_dp0_tp0_ep12 -> layer4_dispatch_dp0_tp0_ep12 [style=dashed]
	layer4_dispatch_dp0_tp0_ep12 -> layer4_expert_mlp_dp0_tp0_ep12
	layer4_expert_mlp_dp0_tp0_ep12 -> layer4_expert_proj_dp0_tp0_ep12
	layer4_expert_proj_dp0_tp0_ep12 -> layer4_expert_allreduce_dp0_tp0_ep12
	layer4_expert_allreduce_dp0_tp0_ep12 -> layer4_aggregate_dp0_tp0_ep12
	layer4_gate_dp0_tp0_ep13 [label="LAYER4_GATE\nGPU: 17\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp0_ep13 [label="LAYER4_DISPATCH\nGPU: 17\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp0_ep13 [label="LAYER4_EXPERT_MLP\nGPU: 17\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp0_ep13 [label="LAYER4_EXPERT_PROJ\nGPU: 17\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp0_ep13 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 17\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp0_ep13 [label="LAYER4_AGGREGATE\nGPU: 17\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp0 -> layer4_gate_dp0_tp0_ep13 [style=dashed]
	layer4_gate_dp0_tp0_ep13 -> layer4_dispatch_dp0_tp0_ep13 [style=dashed]
	layer4_dispatch_dp0_tp0_ep13 -> layer4_expert_mlp_dp0_tp0_ep13
	layer4_expert_mlp_dp0_tp0_ep13 -> layer4_expert_proj_dp0_tp0_ep13
	layer4_expert_proj_dp0_tp0_ep13 -> layer4_expert_allreduce_dp0_tp0_ep13
	layer4_expert_allreduce_dp0_tp0_ep13 -> layer4_aggregate_dp0_tp0_ep13
	layer4_gate_dp0_tp0_ep14 [label="LAYER4_GATE\nGPU: 18\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp0_ep14 [label="LAYER4_DISPATCH\nGPU: 18\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp0_ep14 [label="LAYER4_EXPERT_MLP\nGPU: 18\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp0_ep14 [label="LAYER4_EXPERT_PROJ\nGPU: 18\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp0_ep14 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 18\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp0_ep14 [label="LAYER4_AGGREGATE\nGPU: 18\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp0 -> layer4_gate_dp0_tp0_ep14 [style=dashed]
	layer4_gate_dp0_tp0_ep14 -> layer4_dispatch_dp0_tp0_ep14 [style=dashed]
	layer4_dispatch_dp0_tp0_ep14 -> layer4_expert_mlp_dp0_tp0_ep14
	layer4_expert_mlp_dp0_tp0_ep14 -> layer4_expert_proj_dp0_tp0_ep14
	layer4_expert_proj_dp0_tp0_ep14 -> layer4_expert_allreduce_dp0_tp0_ep14
	layer4_expert_allreduce_dp0_tp0_ep14 -> layer4_aggregate_dp0_tp0_ep14
	layer4_gate_dp0_tp0_ep15 [label="LAYER4_GATE\nGPU: 19\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp0_ep15 [label="LAYER4_DISPATCH\nGPU: 19\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp0_ep15 [label="LAYER4_EXPERT_MLP\nGPU: 19\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp0_ep15 [label="LAYER4_EXPERT_PROJ\nGPU: 19\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp0_ep15 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 19\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp0_ep15 [label="LAYER4_AGGREGATE\nGPU: 19\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp0 -> layer4_gate_dp0_tp0_ep15 [style=dashed]
	layer4_gate_dp0_tp0_ep15 -> layer4_dispatch_dp0_tp0_ep15 [style=dashed]
	layer4_dispatch_dp0_tp0_ep15 -> layer4_expert_mlp_dp0_tp0_ep15
	layer4_expert_mlp_dp0_tp0_ep15 -> layer4_expert_proj_dp0_tp0_ep15
	layer4_expert_proj_dp0_tp0_ep15 -> layer4_expert_allreduce_dp0_tp0_ep15
	layer4_expert_allreduce_dp0_tp0_ep15 -> layer4_aggregate_dp0_tp0_ep15
	layer4_gate_dp0_tp1_ep0 [label="LAYER4_GATE\nGPU: 68\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp1_ep0 [label="LAYER4_DISPATCH\nGPU: 68\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp1_ep0 [label="LAYER4_EXPERT_MLP\nGPU: 68\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp1_ep0 [label="LAYER4_EXPERT_PROJ\nGPU: 68\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp1_ep0 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 68\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp1_ep0 [label="LAYER4_AGGREGATE\nGPU: 68\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp1 -> layer4_gate_dp0_tp1_ep0 [style=dashed]
	layer4_gate_dp0_tp1_ep0 -> layer4_dispatch_dp0_tp1_ep0 [style=dashed]
	layer4_dispatch_dp0_tp1_ep0 -> layer4_expert_mlp_dp0_tp1_ep0
	layer4_expert_mlp_dp0_tp1_ep0 -> layer4_expert_proj_dp0_tp1_ep0
	layer4_expert_proj_dp0_tp1_ep0 -> layer4_expert_allreduce_dp0_tp1_ep0
	layer4_expert_allreduce_dp0_tp1_ep0 -> layer4_aggregate_dp0_tp1_ep0
	layer4_gate_dp0_tp1_ep1 [label="LAYER4_GATE\nGPU: 69\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp1_ep1 [label="LAYER4_DISPATCH\nGPU: 69\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp1_ep1 [label="LAYER4_EXPERT_MLP\nGPU: 69\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp1_ep1 [label="LAYER4_EXPERT_PROJ\nGPU: 69\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp1_ep1 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 69\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp1_ep1 [label="LAYER4_AGGREGATE\nGPU: 69\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp1 -> layer4_gate_dp0_tp1_ep1 [style=dashed]
	layer4_gate_dp0_tp1_ep1 -> layer4_dispatch_dp0_tp1_ep1 [style=dashed]
	layer4_dispatch_dp0_tp1_ep1 -> layer4_expert_mlp_dp0_tp1_ep1
	layer4_expert_mlp_dp0_tp1_ep1 -> layer4_expert_proj_dp0_tp1_ep1
	layer4_expert_proj_dp0_tp1_ep1 -> layer4_expert_allreduce_dp0_tp1_ep1
	layer4_expert_allreduce_dp0_tp1_ep1 -> layer4_aggregate_dp0_tp1_ep1
	layer4_gate_dp0_tp1_ep2 [label="LAYER4_GATE\nGPU: 70\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp1_ep2 [label="LAYER4_DISPATCH\nGPU: 70\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp1_ep2 [label="LAYER4_EXPERT_MLP\nGPU: 70\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp1_ep2 [label="LAYER4_EXPERT_PROJ\nGPU: 70\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp1_ep2 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 70\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp1_ep2 [label="LAYER4_AGGREGATE\nGPU: 70\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp1 -> layer4_gate_dp0_tp1_ep2 [style=dashed]
	layer4_gate_dp0_tp1_ep2 -> layer4_dispatch_dp0_tp1_ep2 [style=dashed]
	layer4_dispatch_dp0_tp1_ep2 -> layer4_expert_mlp_dp0_tp1_ep2
	layer4_expert_mlp_dp0_tp1_ep2 -> layer4_expert_proj_dp0_tp1_ep2
	layer4_expert_proj_dp0_tp1_ep2 -> layer4_expert_allreduce_dp0_tp1_ep2
	layer4_expert_allreduce_dp0_tp1_ep2 -> layer4_aggregate_dp0_tp1_ep2
	layer4_gate_dp0_tp1_ep3 [label="LAYER4_GATE\nGPU: 71\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp1_ep3 [label="LAYER4_DISPATCH\nGPU: 71\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp1_ep3 [label="LAYER4_EXPERT_MLP\nGPU: 71\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp1_ep3 [label="LAYER4_EXPERT_PROJ\nGPU: 71\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp1_ep3 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 71\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp1_ep3 [label="LAYER4_AGGREGATE\nGPU: 71\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp1 -> layer4_gate_dp0_tp1_ep3 [style=dashed]
	layer4_gate_dp0_tp1_ep3 -> layer4_dispatch_dp0_tp1_ep3 [style=dashed]
	layer4_dispatch_dp0_tp1_ep3 -> layer4_expert_mlp_dp0_tp1_ep3
	layer4_expert_mlp_dp0_tp1_ep3 -> layer4_expert_proj_dp0_tp1_ep3
	layer4_expert_proj_dp0_tp1_ep3 -> layer4_expert_allreduce_dp0_tp1_ep3
	layer4_expert_allreduce_dp0_tp1_ep3 -> layer4_aggregate_dp0_tp1_ep3
	layer4_gate_dp0_tp1_ep4 [label="LAYER4_GATE\nGPU: 72\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp1_ep4 [label="LAYER4_DISPATCH\nGPU: 72\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp1_ep4 [label="LAYER4_EXPERT_MLP\nGPU: 72\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp1_ep4 [label="LAYER4_EXPERT_PROJ\nGPU: 72\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp1_ep4 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 72\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp1_ep4 [label="LAYER4_AGGREGATE\nGPU: 72\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp1 -> layer4_gate_dp0_tp1_ep4 [style=dashed]
	layer4_gate_dp0_tp1_ep4 -> layer4_dispatch_dp0_tp1_ep4 [style=dashed]
	layer4_dispatch_dp0_tp1_ep4 -> layer4_expert_mlp_dp0_tp1_ep4
	layer4_expert_mlp_dp0_tp1_ep4 -> layer4_expert_proj_dp0_tp1_ep4
	layer4_expert_proj_dp0_tp1_ep4 -> layer4_expert_allreduce_dp0_tp1_ep4
	layer4_expert_allreduce_dp0_tp1_ep4 -> layer4_aggregate_dp0_tp1_ep4
	layer4_gate_dp0_tp1_ep5 [label="LAYER4_GATE\nGPU: 73\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp1_ep5 [label="LAYER4_DISPATCH\nGPU: 73\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp1_ep5 [label="LAYER4_EXPERT_MLP\nGPU: 73\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp1_ep5 [label="LAYER4_EXPERT_PROJ\nGPU: 73\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp1_ep5 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 73\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp1_ep5 [label="LAYER4_AGGREGATE\nGPU: 73\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp1 -> layer4_gate_dp0_tp1_ep5 [style=dashed]
	layer4_gate_dp0_tp1_ep5 -> layer4_dispatch_dp0_tp1_ep5 [style=dashed]
	layer4_dispatch_dp0_tp1_ep5 -> layer4_expert_mlp_dp0_tp1_ep5
	layer4_expert_mlp_dp0_tp1_ep5 -> layer4_expert_proj_dp0_tp1_ep5
	layer4_expert_proj_dp0_tp1_ep5 -> layer4_expert_allreduce_dp0_tp1_ep5
	layer4_expert_allreduce_dp0_tp1_ep5 -> layer4_aggregate_dp0_tp1_ep5
	layer4_gate_dp0_tp1_ep6 [label="LAYER4_GATE\nGPU: 74\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp1_ep6 [label="LAYER4_DISPATCH\nGPU: 74\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp1_ep6 [label="LAYER4_EXPERT_MLP\nGPU: 74\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp1_ep6 [label="LAYER4_EXPERT_PROJ\nGPU: 74\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp1_ep6 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 74\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp1_ep6 [label="LAYER4_AGGREGATE\nGPU: 74\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp1 -> layer4_gate_dp0_tp1_ep6 [style=dashed]
	layer4_gate_dp0_tp1_ep6 -> layer4_dispatch_dp0_tp1_ep6 [style=dashed]
	layer4_dispatch_dp0_tp1_ep6 -> layer4_expert_mlp_dp0_tp1_ep6
	layer4_expert_mlp_dp0_tp1_ep6 -> layer4_expert_proj_dp0_tp1_ep6
	layer4_expert_proj_dp0_tp1_ep6 -> layer4_expert_allreduce_dp0_tp1_ep6
	layer4_expert_allreduce_dp0_tp1_ep6 -> layer4_aggregate_dp0_tp1_ep6
	layer4_gate_dp0_tp1_ep7 [label="LAYER4_GATE\nGPU: 75\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp1_ep7 [label="LAYER4_DISPATCH\nGPU: 75\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp1_ep7 [label="LAYER4_EXPERT_MLP\nGPU: 75\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp1_ep7 [label="LAYER4_EXPERT_PROJ\nGPU: 75\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp1_ep7 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 75\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp1_ep7 [label="LAYER4_AGGREGATE\nGPU: 75\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp1 -> layer4_gate_dp0_tp1_ep7 [style=dashed]
	layer4_gate_dp0_tp1_ep7 -> layer4_dispatch_dp0_tp1_ep7 [style=dashed]
	layer4_dispatch_dp0_tp1_ep7 -> layer4_expert_mlp_dp0_tp1_ep7
	layer4_expert_mlp_dp0_tp1_ep7 -> layer4_expert_proj_dp0_tp1_ep7
	layer4_expert_proj_dp0_tp1_ep7 -> layer4_expert_allreduce_dp0_tp1_ep7
	layer4_expert_allreduce_dp0_tp1_ep7 -> layer4_aggregate_dp0_tp1_ep7
	layer4_gate_dp0_tp1_ep8 [label="LAYER4_GATE\nGPU: 76\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp1_ep8 [label="LAYER4_DISPATCH\nGPU: 76\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp1_ep8 [label="LAYER4_EXPERT_MLP\nGPU: 76\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp1_ep8 [label="LAYER4_EXPERT_PROJ\nGPU: 76\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp1_ep8 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 76\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp1_ep8 [label="LAYER4_AGGREGATE\nGPU: 76\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp1 -> layer4_gate_dp0_tp1_ep8 [style=dashed]
	layer4_gate_dp0_tp1_ep8 -> layer4_dispatch_dp0_tp1_ep8 [style=dashed]
	layer4_dispatch_dp0_tp1_ep8 -> layer4_expert_mlp_dp0_tp1_ep8
	layer4_expert_mlp_dp0_tp1_ep8 -> layer4_expert_proj_dp0_tp1_ep8
	layer4_expert_proj_dp0_tp1_ep8 -> layer4_expert_allreduce_dp0_tp1_ep8
	layer4_expert_allreduce_dp0_tp1_ep8 -> layer4_aggregate_dp0_tp1_ep8
	layer4_gate_dp0_tp1_ep9 [label="LAYER4_GATE\nGPU: 77\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp1_ep9 [label="LAYER4_DISPATCH\nGPU: 77\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp1_ep9 [label="LAYER4_EXPERT_MLP\nGPU: 77\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp1_ep9 [label="LAYER4_EXPERT_PROJ\nGPU: 77\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp1_ep9 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 77\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp1_ep9 [label="LAYER4_AGGREGATE\nGPU: 77\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp1 -> layer4_gate_dp0_tp1_ep9 [style=dashed]
	layer4_gate_dp0_tp1_ep9 -> layer4_dispatch_dp0_tp1_ep9 [style=dashed]
	layer4_dispatch_dp0_tp1_ep9 -> layer4_expert_mlp_dp0_tp1_ep9
	layer4_expert_mlp_dp0_tp1_ep9 -> layer4_expert_proj_dp0_tp1_ep9
	layer4_expert_proj_dp0_tp1_ep9 -> layer4_expert_allreduce_dp0_tp1_ep9
	layer4_expert_allreduce_dp0_tp1_ep9 -> layer4_aggregate_dp0_tp1_ep9
	layer4_gate_dp0_tp1_ep10 [label="LAYER4_GATE\nGPU: 78\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp1_ep10 [label="LAYER4_DISPATCH\nGPU: 78\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp1_ep10 [label="LAYER4_EXPERT_MLP\nGPU: 78\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp1_ep10 [label="LAYER4_EXPERT_PROJ\nGPU: 78\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp1_ep10 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 78\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp1_ep10 [label="LAYER4_AGGREGATE\nGPU: 78\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp1 -> layer4_gate_dp0_tp1_ep10 [style=dashed]
	layer4_gate_dp0_tp1_ep10 -> layer4_dispatch_dp0_tp1_ep10 [style=dashed]
	layer4_dispatch_dp0_tp1_ep10 -> layer4_expert_mlp_dp0_tp1_ep10
	layer4_expert_mlp_dp0_tp1_ep10 -> layer4_expert_proj_dp0_tp1_ep10
	layer4_expert_proj_dp0_tp1_ep10 -> layer4_expert_allreduce_dp0_tp1_ep10
	layer4_expert_allreduce_dp0_tp1_ep10 -> layer4_aggregate_dp0_tp1_ep10
	layer4_gate_dp0_tp1_ep11 [label="LAYER4_GATE\nGPU: 79\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp1_ep11 [label="LAYER4_DISPATCH\nGPU: 79\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp1_ep11 [label="LAYER4_EXPERT_MLP\nGPU: 79\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp1_ep11 [label="LAYER4_EXPERT_PROJ\nGPU: 79\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp1_ep11 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 79\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp1_ep11 [label="LAYER4_AGGREGATE\nGPU: 79\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp1 -> layer4_gate_dp0_tp1_ep11 [style=dashed]
	layer4_gate_dp0_tp1_ep11 -> layer4_dispatch_dp0_tp1_ep11 [style=dashed]
	layer4_dispatch_dp0_tp1_ep11 -> layer4_expert_mlp_dp0_tp1_ep11
	layer4_expert_mlp_dp0_tp1_ep11 -> layer4_expert_proj_dp0_tp1_ep11
	layer4_expert_proj_dp0_tp1_ep11 -> layer4_expert_allreduce_dp0_tp1_ep11
	layer4_expert_allreduce_dp0_tp1_ep11 -> layer4_aggregate_dp0_tp1_ep11
	layer4_gate_dp0_tp1_ep12 [label="LAYER4_GATE\nGPU: 80\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp1_ep12 [label="LAYER4_DISPATCH\nGPU: 80\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp1_ep12 [label="LAYER4_EXPERT_MLP\nGPU: 80\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp1_ep12 [label="LAYER4_EXPERT_PROJ\nGPU: 80\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp1_ep12 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 80\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp1_ep12 [label="LAYER4_AGGREGATE\nGPU: 80\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp1 -> layer4_gate_dp0_tp1_ep12 [style=dashed]
	layer4_gate_dp0_tp1_ep12 -> layer4_dispatch_dp0_tp1_ep12 [style=dashed]
	layer4_dispatch_dp0_tp1_ep12 -> layer4_expert_mlp_dp0_tp1_ep12
	layer4_expert_mlp_dp0_tp1_ep12 -> layer4_expert_proj_dp0_tp1_ep12
	layer4_expert_proj_dp0_tp1_ep12 -> layer4_expert_allreduce_dp0_tp1_ep12
	layer4_expert_allreduce_dp0_tp1_ep12 -> layer4_aggregate_dp0_tp1_ep12
	layer4_gate_dp0_tp1_ep13 [label="LAYER4_GATE\nGPU: 81\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp1_ep13 [label="LAYER4_DISPATCH\nGPU: 81\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp1_ep13 [label="LAYER4_EXPERT_MLP\nGPU: 81\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp1_ep13 [label="LAYER4_EXPERT_PROJ\nGPU: 81\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp1_ep13 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 81\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp1_ep13 [label="LAYER4_AGGREGATE\nGPU: 81\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp1 -> layer4_gate_dp0_tp1_ep13 [style=dashed]
	layer4_gate_dp0_tp1_ep13 -> layer4_dispatch_dp0_tp1_ep13 [style=dashed]
	layer4_dispatch_dp0_tp1_ep13 -> layer4_expert_mlp_dp0_tp1_ep13
	layer4_expert_mlp_dp0_tp1_ep13 -> layer4_expert_proj_dp0_tp1_ep13
	layer4_expert_proj_dp0_tp1_ep13 -> layer4_expert_allreduce_dp0_tp1_ep13
	layer4_expert_allreduce_dp0_tp1_ep13 -> layer4_aggregate_dp0_tp1_ep13
	layer4_gate_dp0_tp1_ep14 [label="LAYER4_GATE\nGPU: 82\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp1_ep14 [label="LAYER4_DISPATCH\nGPU: 82\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp1_ep14 [label="LAYER4_EXPERT_MLP\nGPU: 82\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp1_ep14 [label="LAYER4_EXPERT_PROJ\nGPU: 82\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp1_ep14 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 82\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp1_ep14 [label="LAYER4_AGGREGATE\nGPU: 82\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp1 -> layer4_gate_dp0_tp1_ep14 [style=dashed]
	layer4_gate_dp0_tp1_ep14 -> layer4_dispatch_dp0_tp1_ep14 [style=dashed]
	layer4_dispatch_dp0_tp1_ep14 -> layer4_expert_mlp_dp0_tp1_ep14
	layer4_expert_mlp_dp0_tp1_ep14 -> layer4_expert_proj_dp0_tp1_ep14
	layer4_expert_proj_dp0_tp1_ep14 -> layer4_expert_allreduce_dp0_tp1_ep14
	layer4_expert_allreduce_dp0_tp1_ep14 -> layer4_aggregate_dp0_tp1_ep14
	layer4_gate_dp0_tp1_ep15 [label="LAYER4_GATE\nGPU: 83\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp0_tp1_ep15 [label="LAYER4_DISPATCH\nGPU: 83\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp0_tp1_ep15 [label="LAYER4_EXPERT_MLP\nGPU: 83\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp0_tp1_ep15 [label="LAYER4_EXPERT_PROJ\nGPU: 83\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp0_tp1_ep15 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 83\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp0_tp1_ep15 [label="LAYER4_AGGREGATE\nGPU: 83\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp0_tp1 -> layer4_gate_dp0_tp1_ep15 [style=dashed]
	layer4_gate_dp0_tp1_ep15 -> layer4_dispatch_dp0_tp1_ep15 [style=dashed]
	layer4_dispatch_dp0_tp1_ep15 -> layer4_expert_mlp_dp0_tp1_ep15
	layer4_expert_mlp_dp0_tp1_ep15 -> layer4_expert_proj_dp0_tp1_ep15
	layer4_expert_proj_dp0_tp1_ep15 -> layer4_expert_allreduce_dp0_tp1_ep15
	layer4_expert_allreduce_dp0_tp1_ep15 -> layer4_aggregate_dp0_tp1_ep15
	layer4_gate_dp1_tp0_ep0 [label="LAYER4_GATE\nGPU: 132\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp0_ep0 [label="LAYER4_DISPATCH\nGPU: 132\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp0_ep0 [label="LAYER4_EXPERT_MLP\nGPU: 132\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp0_ep0 [label="LAYER4_EXPERT_PROJ\nGPU: 132\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp0_ep0 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 132\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp0_ep0 [label="LAYER4_AGGREGATE\nGPU: 132\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp0 -> layer4_gate_dp1_tp0_ep0 [style=dashed]
	layer4_gate_dp1_tp0_ep0 -> layer4_dispatch_dp1_tp0_ep0 [style=dashed]
	layer4_dispatch_dp1_tp0_ep0 -> layer4_expert_mlp_dp1_tp0_ep0
	layer4_expert_mlp_dp1_tp0_ep0 -> layer4_expert_proj_dp1_tp0_ep0
	layer4_expert_proj_dp1_tp0_ep0 -> layer4_expert_allreduce_dp1_tp0_ep0
	layer4_expert_allreduce_dp1_tp0_ep0 -> layer4_aggregate_dp1_tp0_ep0
	layer4_gate_dp1_tp0_ep1 [label="LAYER4_GATE\nGPU: 133\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp0_ep1 [label="LAYER4_DISPATCH\nGPU: 133\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp0_ep1 [label="LAYER4_EXPERT_MLP\nGPU: 133\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp0_ep1 [label="LAYER4_EXPERT_PROJ\nGPU: 133\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp0_ep1 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 133\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp0_ep1 [label="LAYER4_AGGREGATE\nGPU: 133\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp0 -> layer4_gate_dp1_tp0_ep1 [style=dashed]
	layer4_gate_dp1_tp0_ep1 -> layer4_dispatch_dp1_tp0_ep1 [style=dashed]
	layer4_dispatch_dp1_tp0_ep1 -> layer4_expert_mlp_dp1_tp0_ep1
	layer4_expert_mlp_dp1_tp0_ep1 -> layer4_expert_proj_dp1_tp0_ep1
	layer4_expert_proj_dp1_tp0_ep1 -> layer4_expert_allreduce_dp1_tp0_ep1
	layer4_expert_allreduce_dp1_tp0_ep1 -> layer4_aggregate_dp1_tp0_ep1
	layer4_gate_dp1_tp0_ep2 [label="LAYER4_GATE\nGPU: 134\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp0_ep2 [label="LAYER4_DISPATCH\nGPU: 134\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp0_ep2 [label="LAYER4_EXPERT_MLP\nGPU: 134\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp0_ep2 [label="LAYER4_EXPERT_PROJ\nGPU: 134\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp0_ep2 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 134\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp0_ep2 [label="LAYER4_AGGREGATE\nGPU: 134\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp0 -> layer4_gate_dp1_tp0_ep2 [style=dashed]
	layer4_gate_dp1_tp0_ep2 -> layer4_dispatch_dp1_tp0_ep2 [style=dashed]
	layer4_dispatch_dp1_tp0_ep2 -> layer4_expert_mlp_dp1_tp0_ep2
	layer4_expert_mlp_dp1_tp0_ep2 -> layer4_expert_proj_dp1_tp0_ep2
	layer4_expert_proj_dp1_tp0_ep2 -> layer4_expert_allreduce_dp1_tp0_ep2
	layer4_expert_allreduce_dp1_tp0_ep2 -> layer4_aggregate_dp1_tp0_ep2
	layer4_gate_dp1_tp0_ep3 [label="LAYER4_GATE\nGPU: 135\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp0_ep3 [label="LAYER4_DISPATCH\nGPU: 135\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp0_ep3 [label="LAYER4_EXPERT_MLP\nGPU: 135\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp0_ep3 [label="LAYER4_EXPERT_PROJ\nGPU: 135\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp0_ep3 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 135\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp0_ep3 [label="LAYER4_AGGREGATE\nGPU: 135\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp0 -> layer4_gate_dp1_tp0_ep3 [style=dashed]
	layer4_gate_dp1_tp0_ep3 -> layer4_dispatch_dp1_tp0_ep3 [style=dashed]
	layer4_dispatch_dp1_tp0_ep3 -> layer4_expert_mlp_dp1_tp0_ep3
	layer4_expert_mlp_dp1_tp0_ep3 -> layer4_expert_proj_dp1_tp0_ep3
	layer4_expert_proj_dp1_tp0_ep3 -> layer4_expert_allreduce_dp1_tp0_ep3
	layer4_expert_allreduce_dp1_tp0_ep3 -> layer4_aggregate_dp1_tp0_ep3
	layer4_gate_dp1_tp0_ep4 [label="LAYER4_GATE\nGPU: 136\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp0_ep4 [label="LAYER4_DISPATCH\nGPU: 136\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp0_ep4 [label="LAYER4_EXPERT_MLP\nGPU: 136\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp0_ep4 [label="LAYER4_EXPERT_PROJ\nGPU: 136\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp0_ep4 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 136\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp0_ep4 [label="LAYER4_AGGREGATE\nGPU: 136\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp0 -> layer4_gate_dp1_tp0_ep4 [style=dashed]
	layer4_gate_dp1_tp0_ep4 -> layer4_dispatch_dp1_tp0_ep4 [style=dashed]
	layer4_dispatch_dp1_tp0_ep4 -> layer4_expert_mlp_dp1_tp0_ep4
	layer4_expert_mlp_dp1_tp0_ep4 -> layer4_expert_proj_dp1_tp0_ep4
	layer4_expert_proj_dp1_tp0_ep4 -> layer4_expert_allreduce_dp1_tp0_ep4
	layer4_expert_allreduce_dp1_tp0_ep4 -> layer4_aggregate_dp1_tp0_ep4
	layer4_gate_dp1_tp0_ep5 [label="LAYER4_GATE\nGPU: 137\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp0_ep5 [label="LAYER4_DISPATCH\nGPU: 137\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp0_ep5 [label="LAYER4_EXPERT_MLP\nGPU: 137\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp0_ep5 [label="LAYER4_EXPERT_PROJ\nGPU: 137\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp0_ep5 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 137\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp0_ep5 [label="LAYER4_AGGREGATE\nGPU: 137\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp0 -> layer4_gate_dp1_tp0_ep5 [style=dashed]
	layer4_gate_dp1_tp0_ep5 -> layer4_dispatch_dp1_tp0_ep5 [style=dashed]
	layer4_dispatch_dp1_tp0_ep5 -> layer4_expert_mlp_dp1_tp0_ep5
	layer4_expert_mlp_dp1_tp0_ep5 -> layer4_expert_proj_dp1_tp0_ep5
	layer4_expert_proj_dp1_tp0_ep5 -> layer4_expert_allreduce_dp1_tp0_ep5
	layer4_expert_allreduce_dp1_tp0_ep5 -> layer4_aggregate_dp1_tp0_ep5
	layer4_gate_dp1_tp0_ep6 [label="LAYER4_GATE\nGPU: 138\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp0_ep6 [label="LAYER4_DISPATCH\nGPU: 138\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp0_ep6 [label="LAYER4_EXPERT_MLP\nGPU: 138\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp0_ep6 [label="LAYER4_EXPERT_PROJ\nGPU: 138\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp0_ep6 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 138\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp0_ep6 [label="LAYER4_AGGREGATE\nGPU: 138\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp0 -> layer4_gate_dp1_tp0_ep6 [style=dashed]
	layer4_gate_dp1_tp0_ep6 -> layer4_dispatch_dp1_tp0_ep6 [style=dashed]
	layer4_dispatch_dp1_tp0_ep6 -> layer4_expert_mlp_dp1_tp0_ep6
	layer4_expert_mlp_dp1_tp0_ep6 -> layer4_expert_proj_dp1_tp0_ep6
	layer4_expert_proj_dp1_tp0_ep6 -> layer4_expert_allreduce_dp1_tp0_ep6
	layer4_expert_allreduce_dp1_tp0_ep6 -> layer4_aggregate_dp1_tp0_ep6
	layer4_gate_dp1_tp0_ep7 [label="LAYER4_GATE\nGPU: 139\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp0_ep7 [label="LAYER4_DISPATCH\nGPU: 139\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp0_ep7 [label="LAYER4_EXPERT_MLP\nGPU: 139\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp0_ep7 [label="LAYER4_EXPERT_PROJ\nGPU: 139\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp0_ep7 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 139\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp0_ep7 [label="LAYER4_AGGREGATE\nGPU: 139\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp0 -> layer4_gate_dp1_tp0_ep7 [style=dashed]
	layer4_gate_dp1_tp0_ep7 -> layer4_dispatch_dp1_tp0_ep7 [style=dashed]
	layer4_dispatch_dp1_tp0_ep7 -> layer4_expert_mlp_dp1_tp0_ep7
	layer4_expert_mlp_dp1_tp0_ep7 -> layer4_expert_proj_dp1_tp0_ep7
	layer4_expert_proj_dp1_tp0_ep7 -> layer4_expert_allreduce_dp1_tp0_ep7
	layer4_expert_allreduce_dp1_tp0_ep7 -> layer4_aggregate_dp1_tp0_ep7
	layer4_gate_dp1_tp0_ep8 [label="LAYER4_GATE\nGPU: 140\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp0_ep8 [label="LAYER4_DISPATCH\nGPU: 140\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp0_ep8 [label="LAYER4_EXPERT_MLP\nGPU: 140\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp0_ep8 [label="LAYER4_EXPERT_PROJ\nGPU: 140\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp0_ep8 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 140\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp0_ep8 [label="LAYER4_AGGREGATE\nGPU: 140\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp0 -> layer4_gate_dp1_tp0_ep8 [style=dashed]
	layer4_gate_dp1_tp0_ep8 -> layer4_dispatch_dp1_tp0_ep8 [style=dashed]
	layer4_dispatch_dp1_tp0_ep8 -> layer4_expert_mlp_dp1_tp0_ep8
	layer4_expert_mlp_dp1_tp0_ep8 -> layer4_expert_proj_dp1_tp0_ep8
	layer4_expert_proj_dp1_tp0_ep8 -> layer4_expert_allreduce_dp1_tp0_ep8
	layer4_expert_allreduce_dp1_tp0_ep8 -> layer4_aggregate_dp1_tp0_ep8
	layer4_gate_dp1_tp0_ep9 [label="LAYER4_GATE\nGPU: 141\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp0_ep9 [label="LAYER4_DISPATCH\nGPU: 141\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp0_ep9 [label="LAYER4_EXPERT_MLP\nGPU: 141\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp0_ep9 [label="LAYER4_EXPERT_PROJ\nGPU: 141\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp0_ep9 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 141\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp0_ep9 [label="LAYER4_AGGREGATE\nGPU: 141\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp0 -> layer4_gate_dp1_tp0_ep9 [style=dashed]
	layer4_gate_dp1_tp0_ep9 -> layer4_dispatch_dp1_tp0_ep9 [style=dashed]
	layer4_dispatch_dp1_tp0_ep9 -> layer4_expert_mlp_dp1_tp0_ep9
	layer4_expert_mlp_dp1_tp0_ep9 -> layer4_expert_proj_dp1_tp0_ep9
	layer4_expert_proj_dp1_tp0_ep9 -> layer4_expert_allreduce_dp1_tp0_ep9
	layer4_expert_allreduce_dp1_tp0_ep9 -> layer4_aggregate_dp1_tp0_ep9
	layer4_gate_dp1_tp0_ep10 [label="LAYER4_GATE\nGPU: 142\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp0_ep10 [label="LAYER4_DISPATCH\nGPU: 142\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp0_ep10 [label="LAYER4_EXPERT_MLP\nGPU: 142\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp0_ep10 [label="LAYER4_EXPERT_PROJ\nGPU: 142\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp0_ep10 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 142\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp0_ep10 [label="LAYER4_AGGREGATE\nGPU: 142\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp0 -> layer4_gate_dp1_tp0_ep10 [style=dashed]
	layer4_gate_dp1_tp0_ep10 -> layer4_dispatch_dp1_tp0_ep10 [style=dashed]
	layer4_dispatch_dp1_tp0_ep10 -> layer4_expert_mlp_dp1_tp0_ep10
	layer4_expert_mlp_dp1_tp0_ep10 -> layer4_expert_proj_dp1_tp0_ep10
	layer4_expert_proj_dp1_tp0_ep10 -> layer4_expert_allreduce_dp1_tp0_ep10
	layer4_expert_allreduce_dp1_tp0_ep10 -> layer4_aggregate_dp1_tp0_ep10
	layer4_gate_dp1_tp0_ep11 [label="LAYER4_GATE\nGPU: 143\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp0_ep11 [label="LAYER4_DISPATCH\nGPU: 143\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp0_ep11 [label="LAYER4_EXPERT_MLP\nGPU: 143\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp0_ep11 [label="LAYER4_EXPERT_PROJ\nGPU: 143\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp0_ep11 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 143\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp0_ep11 [label="LAYER4_AGGREGATE\nGPU: 143\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp0 -> layer4_gate_dp1_tp0_ep11 [style=dashed]
	layer4_gate_dp1_tp0_ep11 -> layer4_dispatch_dp1_tp0_ep11 [style=dashed]
	layer4_dispatch_dp1_tp0_ep11 -> layer4_expert_mlp_dp1_tp0_ep11
	layer4_expert_mlp_dp1_tp0_ep11 -> layer4_expert_proj_dp1_tp0_ep11
	layer4_expert_proj_dp1_tp0_ep11 -> layer4_expert_allreduce_dp1_tp0_ep11
	layer4_expert_allreduce_dp1_tp0_ep11 -> layer4_aggregate_dp1_tp0_ep11
	layer4_gate_dp1_tp0_ep12 [label="LAYER4_GATE\nGPU: 144\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp0_ep12 [label="LAYER4_DISPATCH\nGPU: 144\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp0_ep12 [label="LAYER4_EXPERT_MLP\nGPU: 144\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp0_ep12 [label="LAYER4_EXPERT_PROJ\nGPU: 144\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp0_ep12 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 144\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp0_ep12 [label="LAYER4_AGGREGATE\nGPU: 144\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp0 -> layer4_gate_dp1_tp0_ep12 [style=dashed]
	layer4_gate_dp1_tp0_ep12 -> layer4_dispatch_dp1_tp0_ep12 [style=dashed]
	layer4_dispatch_dp1_tp0_ep12 -> layer4_expert_mlp_dp1_tp0_ep12
	layer4_expert_mlp_dp1_tp0_ep12 -> layer4_expert_proj_dp1_tp0_ep12
	layer4_expert_proj_dp1_tp0_ep12 -> layer4_expert_allreduce_dp1_tp0_ep12
	layer4_expert_allreduce_dp1_tp0_ep12 -> layer4_aggregate_dp1_tp0_ep12
	layer4_gate_dp1_tp0_ep13 [label="LAYER4_GATE\nGPU: 145\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp0_ep13 [label="LAYER4_DISPATCH\nGPU: 145\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp0_ep13 [label="LAYER4_EXPERT_MLP\nGPU: 145\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp0_ep13 [label="LAYER4_EXPERT_PROJ\nGPU: 145\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp0_ep13 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 145\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp0_ep13 [label="LAYER4_AGGREGATE\nGPU: 145\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp0 -> layer4_gate_dp1_tp0_ep13 [style=dashed]
	layer4_gate_dp1_tp0_ep13 -> layer4_dispatch_dp1_tp0_ep13 [style=dashed]
	layer4_dispatch_dp1_tp0_ep13 -> layer4_expert_mlp_dp1_tp0_ep13
	layer4_expert_mlp_dp1_tp0_ep13 -> layer4_expert_proj_dp1_tp0_ep13
	layer4_expert_proj_dp1_tp0_ep13 -> layer4_expert_allreduce_dp1_tp0_ep13
	layer4_expert_allreduce_dp1_tp0_ep13 -> layer4_aggregate_dp1_tp0_ep13
	layer4_gate_dp1_tp0_ep14 [label="LAYER4_GATE\nGPU: 146\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp0_ep14 [label="LAYER4_DISPATCH\nGPU: 146\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp0_ep14 [label="LAYER4_EXPERT_MLP\nGPU: 146\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp0_ep14 [label="LAYER4_EXPERT_PROJ\nGPU: 146\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp0_ep14 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 146\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp0_ep14 [label="LAYER4_AGGREGATE\nGPU: 146\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp0 -> layer4_gate_dp1_tp0_ep14 [style=dashed]
	layer4_gate_dp1_tp0_ep14 -> layer4_dispatch_dp1_tp0_ep14 [style=dashed]
	layer4_dispatch_dp1_tp0_ep14 -> layer4_expert_mlp_dp1_tp0_ep14
	layer4_expert_mlp_dp1_tp0_ep14 -> layer4_expert_proj_dp1_tp0_ep14
	layer4_expert_proj_dp1_tp0_ep14 -> layer4_expert_allreduce_dp1_tp0_ep14
	layer4_expert_allreduce_dp1_tp0_ep14 -> layer4_aggregate_dp1_tp0_ep14
	layer4_gate_dp1_tp0_ep15 [label="LAYER4_GATE\nGPU: 147\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp0_ep15 [label="LAYER4_DISPATCH\nGPU: 147\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp0_ep15 [label="LAYER4_EXPERT_MLP\nGPU: 147\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp0_ep15 [label="LAYER4_EXPERT_PROJ\nGPU: 147\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp0_ep15 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 147\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp0_ep15 [label="LAYER4_AGGREGATE\nGPU: 147\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp0 -> layer4_gate_dp1_tp0_ep15 [style=dashed]
	layer4_gate_dp1_tp0_ep15 -> layer4_dispatch_dp1_tp0_ep15 [style=dashed]
	layer4_dispatch_dp1_tp0_ep15 -> layer4_expert_mlp_dp1_tp0_ep15
	layer4_expert_mlp_dp1_tp0_ep15 -> layer4_expert_proj_dp1_tp0_ep15
	layer4_expert_proj_dp1_tp0_ep15 -> layer4_expert_allreduce_dp1_tp0_ep15
	layer4_expert_allreduce_dp1_tp0_ep15 -> layer4_aggregate_dp1_tp0_ep15
	layer4_gate_dp1_tp1_ep0 [label="LAYER4_GATE\nGPU: 196\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp1_ep0 [label="LAYER4_DISPATCH\nGPU: 196\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp1_ep0 [label="LAYER4_EXPERT_MLP\nGPU: 196\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp1_ep0 [label="LAYER4_EXPERT_PROJ\nGPU: 196\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp1_ep0 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 196\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp1_ep0 [label="LAYER4_AGGREGATE\nGPU: 196\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp1 -> layer4_gate_dp1_tp1_ep0 [style=dashed]
	layer4_gate_dp1_tp1_ep0 -> layer4_dispatch_dp1_tp1_ep0 [style=dashed]
	layer4_dispatch_dp1_tp1_ep0 -> layer4_expert_mlp_dp1_tp1_ep0
	layer4_expert_mlp_dp1_tp1_ep0 -> layer4_expert_proj_dp1_tp1_ep0
	layer4_expert_proj_dp1_tp1_ep0 -> layer4_expert_allreduce_dp1_tp1_ep0
	layer4_expert_allreduce_dp1_tp1_ep0 -> layer4_aggregate_dp1_tp1_ep0
	layer4_gate_dp1_tp1_ep1 [label="LAYER4_GATE\nGPU: 197\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp1_ep1 [label="LAYER4_DISPATCH\nGPU: 197\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp1_ep1 [label="LAYER4_EXPERT_MLP\nGPU: 197\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp1_ep1 [label="LAYER4_EXPERT_PROJ\nGPU: 197\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp1_ep1 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 197\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp1_ep1 [label="LAYER4_AGGREGATE\nGPU: 197\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp1 -> layer4_gate_dp1_tp1_ep1 [style=dashed]
	layer4_gate_dp1_tp1_ep1 -> layer4_dispatch_dp1_tp1_ep1 [style=dashed]
	layer4_dispatch_dp1_tp1_ep1 -> layer4_expert_mlp_dp1_tp1_ep1
	layer4_expert_mlp_dp1_tp1_ep1 -> layer4_expert_proj_dp1_tp1_ep1
	layer4_expert_proj_dp1_tp1_ep1 -> layer4_expert_allreduce_dp1_tp1_ep1
	layer4_expert_allreduce_dp1_tp1_ep1 -> layer4_aggregate_dp1_tp1_ep1
	layer4_gate_dp1_tp1_ep2 [label="LAYER4_GATE\nGPU: 198\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp1_ep2 [label="LAYER4_DISPATCH\nGPU: 198\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp1_ep2 [label="LAYER4_EXPERT_MLP\nGPU: 198\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp1_ep2 [label="LAYER4_EXPERT_PROJ\nGPU: 198\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp1_ep2 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 198\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp1_ep2 [label="LAYER4_AGGREGATE\nGPU: 198\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp1 -> layer4_gate_dp1_tp1_ep2 [style=dashed]
	layer4_gate_dp1_tp1_ep2 -> layer4_dispatch_dp1_tp1_ep2 [style=dashed]
	layer4_dispatch_dp1_tp1_ep2 -> layer4_expert_mlp_dp1_tp1_ep2
	layer4_expert_mlp_dp1_tp1_ep2 -> layer4_expert_proj_dp1_tp1_ep2
	layer4_expert_proj_dp1_tp1_ep2 -> layer4_expert_allreduce_dp1_tp1_ep2
	layer4_expert_allreduce_dp1_tp1_ep2 -> layer4_aggregate_dp1_tp1_ep2
	layer4_gate_dp1_tp1_ep3 [label="LAYER4_GATE\nGPU: 199\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp1_ep3 [label="LAYER4_DISPATCH\nGPU: 199\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp1_ep3 [label="LAYER4_EXPERT_MLP\nGPU: 199\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp1_ep3 [label="LAYER4_EXPERT_PROJ\nGPU: 199\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp1_ep3 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 199\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp1_ep3 [label="LAYER4_AGGREGATE\nGPU: 199\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp1 -> layer4_gate_dp1_tp1_ep3 [style=dashed]
	layer4_gate_dp1_tp1_ep3 -> layer4_dispatch_dp1_tp1_ep3 [style=dashed]
	layer4_dispatch_dp1_tp1_ep3 -> layer4_expert_mlp_dp1_tp1_ep3
	layer4_expert_mlp_dp1_tp1_ep3 -> layer4_expert_proj_dp1_tp1_ep3
	layer4_expert_proj_dp1_tp1_ep3 -> layer4_expert_allreduce_dp1_tp1_ep3
	layer4_expert_allreduce_dp1_tp1_ep3 -> layer4_aggregate_dp1_tp1_ep3
	layer4_gate_dp1_tp1_ep4 [label="LAYER4_GATE\nGPU: 200\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp1_ep4 [label="LAYER4_DISPATCH\nGPU: 200\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp1_ep4 [label="LAYER4_EXPERT_MLP\nGPU: 200\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp1_ep4 [label="LAYER4_EXPERT_PROJ\nGPU: 200\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp1_ep4 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 200\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp1_ep4 [label="LAYER4_AGGREGATE\nGPU: 200\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp1 -> layer4_gate_dp1_tp1_ep4 [style=dashed]
	layer4_gate_dp1_tp1_ep4 -> layer4_dispatch_dp1_tp1_ep4 [style=dashed]
	layer4_dispatch_dp1_tp1_ep4 -> layer4_expert_mlp_dp1_tp1_ep4
	layer4_expert_mlp_dp1_tp1_ep4 -> layer4_expert_proj_dp1_tp1_ep4
	layer4_expert_proj_dp1_tp1_ep4 -> layer4_expert_allreduce_dp1_tp1_ep4
	layer4_expert_allreduce_dp1_tp1_ep4 -> layer4_aggregate_dp1_tp1_ep4
	layer4_gate_dp1_tp1_ep5 [label="LAYER4_GATE\nGPU: 201\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp1_ep5 [label="LAYER4_DISPATCH\nGPU: 201\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp1_ep5 [label="LAYER4_EXPERT_MLP\nGPU: 201\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp1_ep5 [label="LAYER4_EXPERT_PROJ\nGPU: 201\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp1_ep5 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 201\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp1_ep5 [label="LAYER4_AGGREGATE\nGPU: 201\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp1 -> layer4_gate_dp1_tp1_ep5 [style=dashed]
	layer4_gate_dp1_tp1_ep5 -> layer4_dispatch_dp1_tp1_ep5 [style=dashed]
	layer4_dispatch_dp1_tp1_ep5 -> layer4_expert_mlp_dp1_tp1_ep5
	layer4_expert_mlp_dp1_tp1_ep5 -> layer4_expert_proj_dp1_tp1_ep5
	layer4_expert_proj_dp1_tp1_ep5 -> layer4_expert_allreduce_dp1_tp1_ep5
	layer4_expert_allreduce_dp1_tp1_ep5 -> layer4_aggregate_dp1_tp1_ep5
	layer4_gate_dp1_tp1_ep6 [label="LAYER4_GATE\nGPU: 202\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp1_ep6 [label="LAYER4_DISPATCH\nGPU: 202\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp1_ep6 [label="LAYER4_EXPERT_MLP\nGPU: 202\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp1_ep6 [label="LAYER4_EXPERT_PROJ\nGPU: 202\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp1_ep6 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 202\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp1_ep6 [label="LAYER4_AGGREGATE\nGPU: 202\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp1 -> layer4_gate_dp1_tp1_ep6 [style=dashed]
	layer4_gate_dp1_tp1_ep6 -> layer4_dispatch_dp1_tp1_ep6 [style=dashed]
	layer4_dispatch_dp1_tp1_ep6 -> layer4_expert_mlp_dp1_tp1_ep6
	layer4_expert_mlp_dp1_tp1_ep6 -> layer4_expert_proj_dp1_tp1_ep6
	layer4_expert_proj_dp1_tp1_ep6 -> layer4_expert_allreduce_dp1_tp1_ep6
	layer4_expert_allreduce_dp1_tp1_ep6 -> layer4_aggregate_dp1_tp1_ep6
	layer4_gate_dp1_tp1_ep7 [label="LAYER4_GATE\nGPU: 203\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp1_ep7 [label="LAYER4_DISPATCH\nGPU: 203\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp1_ep7 [label="LAYER4_EXPERT_MLP\nGPU: 203\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp1_ep7 [label="LAYER4_EXPERT_PROJ\nGPU: 203\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp1_ep7 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 203\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp1_ep7 [label="LAYER4_AGGREGATE\nGPU: 203\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp1 -> layer4_gate_dp1_tp1_ep7 [style=dashed]
	layer4_gate_dp1_tp1_ep7 -> layer4_dispatch_dp1_tp1_ep7 [style=dashed]
	layer4_dispatch_dp1_tp1_ep7 -> layer4_expert_mlp_dp1_tp1_ep7
	layer4_expert_mlp_dp1_tp1_ep7 -> layer4_expert_proj_dp1_tp1_ep7
	layer4_expert_proj_dp1_tp1_ep7 -> layer4_expert_allreduce_dp1_tp1_ep7
	layer4_expert_allreduce_dp1_tp1_ep7 -> layer4_aggregate_dp1_tp1_ep7
	layer4_gate_dp1_tp1_ep8 [label="LAYER4_GATE\nGPU: 204\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp1_ep8 [label="LAYER4_DISPATCH\nGPU: 204\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp1_ep8 [label="LAYER4_EXPERT_MLP\nGPU: 204\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp1_ep8 [label="LAYER4_EXPERT_PROJ\nGPU: 204\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp1_ep8 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 204\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp1_ep8 [label="LAYER4_AGGREGATE\nGPU: 204\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp1 -> layer4_gate_dp1_tp1_ep8 [style=dashed]
	layer4_gate_dp1_tp1_ep8 -> layer4_dispatch_dp1_tp1_ep8 [style=dashed]
	layer4_dispatch_dp1_tp1_ep8 -> layer4_expert_mlp_dp1_tp1_ep8
	layer4_expert_mlp_dp1_tp1_ep8 -> layer4_expert_proj_dp1_tp1_ep8
	layer4_expert_proj_dp1_tp1_ep8 -> layer4_expert_allreduce_dp1_tp1_ep8
	layer4_expert_allreduce_dp1_tp1_ep8 -> layer4_aggregate_dp1_tp1_ep8
	layer4_gate_dp1_tp1_ep9 [label="LAYER4_GATE\nGPU: 205\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp1_ep9 [label="LAYER4_DISPATCH\nGPU: 205\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp1_ep9 [label="LAYER4_EXPERT_MLP\nGPU: 205\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp1_ep9 [label="LAYER4_EXPERT_PROJ\nGPU: 205\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp1_ep9 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 205\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp1_ep9 [label="LAYER4_AGGREGATE\nGPU: 205\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp1 -> layer4_gate_dp1_tp1_ep9 [style=dashed]
	layer4_gate_dp1_tp1_ep9 -> layer4_dispatch_dp1_tp1_ep9 [style=dashed]
	layer4_dispatch_dp1_tp1_ep9 -> layer4_expert_mlp_dp1_tp1_ep9
	layer4_expert_mlp_dp1_tp1_ep9 -> layer4_expert_proj_dp1_tp1_ep9
	layer4_expert_proj_dp1_tp1_ep9 -> layer4_expert_allreduce_dp1_tp1_ep9
	layer4_expert_allreduce_dp1_tp1_ep9 -> layer4_aggregate_dp1_tp1_ep9
	layer4_gate_dp1_tp1_ep10 [label="LAYER4_GATE\nGPU: 206\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp1_ep10 [label="LAYER4_DISPATCH\nGPU: 206\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp1_ep10 [label="LAYER4_EXPERT_MLP\nGPU: 206\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp1_ep10 [label="LAYER4_EXPERT_PROJ\nGPU: 206\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp1_ep10 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 206\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp1_ep10 [label="LAYER4_AGGREGATE\nGPU: 206\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp1 -> layer4_gate_dp1_tp1_ep10 [style=dashed]
	layer4_gate_dp1_tp1_ep10 -> layer4_dispatch_dp1_tp1_ep10 [style=dashed]
	layer4_dispatch_dp1_tp1_ep10 -> layer4_expert_mlp_dp1_tp1_ep10
	layer4_expert_mlp_dp1_tp1_ep10 -> layer4_expert_proj_dp1_tp1_ep10
	layer4_expert_proj_dp1_tp1_ep10 -> layer4_expert_allreduce_dp1_tp1_ep10
	layer4_expert_allreduce_dp1_tp1_ep10 -> layer4_aggregate_dp1_tp1_ep10
	layer4_gate_dp1_tp1_ep11 [label="LAYER4_GATE\nGPU: 207\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp1_ep11 [label="LAYER4_DISPATCH\nGPU: 207\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp1_ep11 [label="LAYER4_EXPERT_MLP\nGPU: 207\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp1_ep11 [label="LAYER4_EXPERT_PROJ\nGPU: 207\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp1_ep11 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 207\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp1_ep11 [label="LAYER4_AGGREGATE\nGPU: 207\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp1 -> layer4_gate_dp1_tp1_ep11 [style=dashed]
	layer4_gate_dp1_tp1_ep11 -> layer4_dispatch_dp1_tp1_ep11 [style=dashed]
	layer4_dispatch_dp1_tp1_ep11 -> layer4_expert_mlp_dp1_tp1_ep11
	layer4_expert_mlp_dp1_tp1_ep11 -> layer4_expert_proj_dp1_tp1_ep11
	layer4_expert_proj_dp1_tp1_ep11 -> layer4_expert_allreduce_dp1_tp1_ep11
	layer4_expert_allreduce_dp1_tp1_ep11 -> layer4_aggregate_dp1_tp1_ep11
	layer4_gate_dp1_tp1_ep12 [label="LAYER4_GATE\nGPU: 208\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp1_ep12 [label="LAYER4_DISPATCH\nGPU: 208\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp1_ep12 [label="LAYER4_EXPERT_MLP\nGPU: 208\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp1_ep12 [label="LAYER4_EXPERT_PROJ\nGPU: 208\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp1_ep12 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 208\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp1_ep12 [label="LAYER4_AGGREGATE\nGPU: 208\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp1 -> layer4_gate_dp1_tp1_ep12 [style=dashed]
	layer4_gate_dp1_tp1_ep12 -> layer4_dispatch_dp1_tp1_ep12 [style=dashed]
	layer4_dispatch_dp1_tp1_ep12 -> layer4_expert_mlp_dp1_tp1_ep12
	layer4_expert_mlp_dp1_tp1_ep12 -> layer4_expert_proj_dp1_tp1_ep12
	layer4_expert_proj_dp1_tp1_ep12 -> layer4_expert_allreduce_dp1_tp1_ep12
	layer4_expert_allreduce_dp1_tp1_ep12 -> layer4_aggregate_dp1_tp1_ep12
	layer4_gate_dp1_tp1_ep13 [label="LAYER4_GATE\nGPU: 209\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp1_ep13 [label="LAYER4_DISPATCH\nGPU: 209\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp1_ep13 [label="LAYER4_EXPERT_MLP\nGPU: 209\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp1_ep13 [label="LAYER4_EXPERT_PROJ\nGPU: 209\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp1_ep13 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 209\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp1_ep13 [label="LAYER4_AGGREGATE\nGPU: 209\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp1 -> layer4_gate_dp1_tp1_ep13 [style=dashed]
	layer4_gate_dp1_tp1_ep13 -> layer4_dispatch_dp1_tp1_ep13 [style=dashed]
	layer4_dispatch_dp1_tp1_ep13 -> layer4_expert_mlp_dp1_tp1_ep13
	layer4_expert_mlp_dp1_tp1_ep13 -> layer4_expert_proj_dp1_tp1_ep13
	layer4_expert_proj_dp1_tp1_ep13 -> layer4_expert_allreduce_dp1_tp1_ep13
	layer4_expert_allreduce_dp1_tp1_ep13 -> layer4_aggregate_dp1_tp1_ep13
	layer4_gate_dp1_tp1_ep14 [label="LAYER4_GATE\nGPU: 210\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp1_ep14 [label="LAYER4_DISPATCH\nGPU: 210\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp1_ep14 [label="LAYER4_EXPERT_MLP\nGPU: 210\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp1_ep14 [label="LAYER4_EXPERT_PROJ\nGPU: 210\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp1_ep14 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 210\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp1_ep14 [label="LAYER4_AGGREGATE\nGPU: 210\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp1 -> layer4_gate_dp1_tp1_ep14 [style=dashed]
	layer4_gate_dp1_tp1_ep14 -> layer4_dispatch_dp1_tp1_ep14 [style=dashed]
	layer4_dispatch_dp1_tp1_ep14 -> layer4_expert_mlp_dp1_tp1_ep14
	layer4_expert_mlp_dp1_tp1_ep14 -> layer4_expert_proj_dp1_tp1_ep14
	layer4_expert_proj_dp1_tp1_ep14 -> layer4_expert_allreduce_dp1_tp1_ep14
	layer4_expert_allreduce_dp1_tp1_ep14 -> layer4_aggregate_dp1_tp1_ep14
	layer4_gate_dp1_tp1_ep15 [label="LAYER4_GATE\nGPU: 211\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer4_dispatch_dp1_tp1_ep15 [label="LAYER4_DISPATCH\nGPU: 211\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer4_expert_mlp_dp1_tp1_ep15 [label="LAYER4_EXPERT_MLP\nGPU: 211\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer4_expert_proj_dp1_tp1_ep15 [label="LAYER4_EXPERT_PROJ\nGPU: 211\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer4_expert_allreduce_dp1_tp1_ep15 [label="LAYER4_EXPERT_ALLREDUCE\nGPU: 211\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer4_aggregate_dp1_tp1_ep15 [label="LAYER4_AGGREGATE\nGPU: 211\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer4_mla_dp1_tp1 -> layer4_gate_dp1_tp1_ep15 [style=dashed]
	layer4_gate_dp1_tp1_ep15 -> layer4_dispatch_dp1_tp1_ep15 [style=dashed]
	layer4_dispatch_dp1_tp1_ep15 -> layer4_expert_mlp_dp1_tp1_ep15
	layer4_expert_mlp_dp1_tp1_ep15 -> layer4_expert_proj_dp1_tp1_ep15
	layer4_expert_proj_dp1_tp1_ep15 -> layer4_expert_allreduce_dp1_tp1_ep15
	layer4_expert_allreduce_dp1_tp1_ep15 -> layer4_aggregate_dp1_tp1_ep15
	layer61_mla_dp0_tp0 [label="LAYER61_MLA\nGPU: 48\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, heads=64, d_k=56]" fillcolor=lightblue]
	layer4_aggregate_dp0_tp0_ep0 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp0_ep1 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp0_ep2 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp0_ep3 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp0_ep4 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp0_ep5 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp0_ep6 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp0_ep7 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp0_ep8 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp0_ep9 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp0_ep10 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp0_ep11 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp0_ep12 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp0_ep13 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp0_ep14 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp0_ep15 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp1_ep0 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp1_ep1 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp1_ep2 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp1_ep3 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp1_ep4 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp1_ep5 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp1_ep6 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp1_ep7 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp1_ep8 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp1_ep9 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp1_ep10 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp1_ep11 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp1_ep12 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp1_ep13 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp1_ep14 -> layer61_mla_dp0_tp0
	layer4_aggregate_dp0_tp1_ep15 -> layer61_mla_dp0_tp0
	layer61_mla_dp0_tp1 [label="LAYER61_MLA\nGPU: 112\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, heads=64, d_k=56]" fillcolor=lightblue]
	layer4_aggregate_dp0_tp0_ep0 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp0_ep1 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp0_ep2 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp0_ep3 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp0_ep4 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp0_ep5 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp0_ep6 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp0_ep7 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp0_ep8 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp0_ep9 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp0_ep10 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp0_ep11 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp0_ep12 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp0_ep13 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp0_ep14 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp0_ep15 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp1_ep0 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp1_ep1 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp1_ep2 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp1_ep3 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp1_ep4 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp1_ep5 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp1_ep6 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp1_ep7 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp1_ep8 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp1_ep9 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp1_ep10 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp1_ep11 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp1_ep12 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp1_ep13 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp1_ep14 -> layer61_mla_dp0_tp1
	layer4_aggregate_dp0_tp1_ep15 -> layer61_mla_dp0_tp1
	layer61_mla_dp1_tp0 [label="LAYER61_MLA\nGPU: 176\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, heads=64, d_k=56]" fillcolor=lightblue]
	layer4_aggregate_dp1_tp0_ep0 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp0_ep1 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp0_ep2 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp0_ep3 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp0_ep4 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp0_ep5 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp0_ep6 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp0_ep7 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp0_ep8 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp0_ep9 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp0_ep10 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp0_ep11 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp0_ep12 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp0_ep13 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp0_ep14 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp0_ep15 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp1_ep0 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp1_ep1 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp1_ep2 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp1_ep3 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp1_ep4 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp1_ep5 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp1_ep6 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp1_ep7 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp1_ep8 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp1_ep9 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp1_ep10 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp1_ep11 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp1_ep12 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp1_ep13 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp1_ep14 -> layer61_mla_dp1_tp0
	layer4_aggregate_dp1_tp1_ep15 -> layer61_mla_dp1_tp0
	layer61_mla_dp1_tp1 [label="LAYER61_MLA\nGPU: 240\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, heads=64, d_k=56]" fillcolor=lightblue]
	layer4_aggregate_dp1_tp0_ep0 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp0_ep1 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp0_ep2 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp0_ep3 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp0_ep4 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp0_ep5 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp0_ep6 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp0_ep7 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp0_ep8 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp0_ep9 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp0_ep10 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp0_ep11 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp0_ep12 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp0_ep13 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp0_ep14 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp0_ep15 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp1_ep0 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp1_ep1 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp1_ep2 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp1_ep3 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp1_ep4 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp1_ep5 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp1_ep6 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp1_ep7 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp1_ep8 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp1_ep9 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp1_ep10 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp1_ep11 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp1_ep12 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp1_ep13 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp1_ep14 -> layer61_mla_dp1_tp1
	layer4_aggregate_dp1_tp1_ep15 -> layer61_mla_dp1_tp1
	layer61_gate_dp0_tp0_ep0 [label="LAYER61_GATE\nGPU: 48\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp0_ep0 [label="LAYER61_DISPATCH\nGPU: 48\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp0_ep0 [label="LAYER61_EXPERT_MLP\nGPU: 48\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp0_ep0 [label="LAYER61_EXPERT_PROJ\nGPU: 48\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp0_ep0 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 48\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp0_ep0 [label="LAYER61_AGGREGATE\nGPU: 48\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp0 -> layer61_gate_dp0_tp0_ep0 [style=dashed]
	layer61_gate_dp0_tp0_ep0 -> layer61_dispatch_dp0_tp0_ep0 [style=dashed]
	layer61_dispatch_dp0_tp0_ep0 -> layer61_expert_mlp_dp0_tp0_ep0
	layer61_expert_mlp_dp0_tp0_ep0 -> layer61_expert_proj_dp0_tp0_ep0
	layer61_expert_proj_dp0_tp0_ep0 -> layer61_expert_allreduce_dp0_tp0_ep0
	layer61_expert_allreduce_dp0_tp0_ep0 -> layer61_aggregate_dp0_tp0_ep0
	layer61_gate_dp0_tp0_ep1 [label="LAYER61_GATE\nGPU: 49\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp0_ep1 [label="LAYER61_DISPATCH\nGPU: 49\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp0_ep1 [label="LAYER61_EXPERT_MLP\nGPU: 49\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp0_ep1 [label="LAYER61_EXPERT_PROJ\nGPU: 49\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp0_ep1 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 49\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp0_ep1 [label="LAYER61_AGGREGATE\nGPU: 49\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp0 -> layer61_gate_dp0_tp0_ep1 [style=dashed]
	layer61_gate_dp0_tp0_ep1 -> layer61_dispatch_dp0_tp0_ep1 [style=dashed]
	layer61_dispatch_dp0_tp0_ep1 -> layer61_expert_mlp_dp0_tp0_ep1
	layer61_expert_mlp_dp0_tp0_ep1 -> layer61_expert_proj_dp0_tp0_ep1
	layer61_expert_proj_dp0_tp0_ep1 -> layer61_expert_allreduce_dp0_tp0_ep1
	layer61_expert_allreduce_dp0_tp0_ep1 -> layer61_aggregate_dp0_tp0_ep1
	layer61_gate_dp0_tp0_ep2 [label="LAYER61_GATE\nGPU: 50\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp0_ep2 [label="LAYER61_DISPATCH\nGPU: 50\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp0_ep2 [label="LAYER61_EXPERT_MLP\nGPU: 50\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp0_ep2 [label="LAYER61_EXPERT_PROJ\nGPU: 50\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp0_ep2 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 50\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp0_ep2 [label="LAYER61_AGGREGATE\nGPU: 50\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp0 -> layer61_gate_dp0_tp0_ep2 [style=dashed]
	layer61_gate_dp0_tp0_ep2 -> layer61_dispatch_dp0_tp0_ep2 [style=dashed]
	layer61_dispatch_dp0_tp0_ep2 -> layer61_expert_mlp_dp0_tp0_ep2
	layer61_expert_mlp_dp0_tp0_ep2 -> layer61_expert_proj_dp0_tp0_ep2
	layer61_expert_proj_dp0_tp0_ep2 -> layer61_expert_allreduce_dp0_tp0_ep2
	layer61_expert_allreduce_dp0_tp0_ep2 -> layer61_aggregate_dp0_tp0_ep2
	layer61_gate_dp0_tp0_ep3 [label="LAYER61_GATE\nGPU: 51\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp0_ep3 [label="LAYER61_DISPATCH\nGPU: 51\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp0_ep3 [label="LAYER61_EXPERT_MLP\nGPU: 51\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp0_ep3 [label="LAYER61_EXPERT_PROJ\nGPU: 51\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp0_ep3 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 51\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp0_ep3 [label="LAYER61_AGGREGATE\nGPU: 51\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp0 -> layer61_gate_dp0_tp0_ep3 [style=dashed]
	layer61_gate_dp0_tp0_ep3 -> layer61_dispatch_dp0_tp0_ep3 [style=dashed]
	layer61_dispatch_dp0_tp0_ep3 -> layer61_expert_mlp_dp0_tp0_ep3
	layer61_expert_mlp_dp0_tp0_ep3 -> layer61_expert_proj_dp0_tp0_ep3
	layer61_expert_proj_dp0_tp0_ep3 -> layer61_expert_allreduce_dp0_tp0_ep3
	layer61_expert_allreduce_dp0_tp0_ep3 -> layer61_aggregate_dp0_tp0_ep3
	layer61_gate_dp0_tp0_ep4 [label="LAYER61_GATE\nGPU: 52\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp0_ep4 [label="LAYER61_DISPATCH\nGPU: 52\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp0_ep4 [label="LAYER61_EXPERT_MLP\nGPU: 52\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp0_ep4 [label="LAYER61_EXPERT_PROJ\nGPU: 52\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp0_ep4 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 52\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp0_ep4 [label="LAYER61_AGGREGATE\nGPU: 52\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp0 -> layer61_gate_dp0_tp0_ep4 [style=dashed]
	layer61_gate_dp0_tp0_ep4 -> layer61_dispatch_dp0_tp0_ep4 [style=dashed]
	layer61_dispatch_dp0_tp0_ep4 -> layer61_expert_mlp_dp0_tp0_ep4
	layer61_expert_mlp_dp0_tp0_ep4 -> layer61_expert_proj_dp0_tp0_ep4
	layer61_expert_proj_dp0_tp0_ep4 -> layer61_expert_allreduce_dp0_tp0_ep4
	layer61_expert_allreduce_dp0_tp0_ep4 -> layer61_aggregate_dp0_tp0_ep4
	layer61_gate_dp0_tp0_ep5 [label="LAYER61_GATE\nGPU: 53\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp0_ep5 [label="LAYER61_DISPATCH\nGPU: 53\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp0_ep5 [label="LAYER61_EXPERT_MLP\nGPU: 53\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp0_ep5 [label="LAYER61_EXPERT_PROJ\nGPU: 53\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp0_ep5 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 53\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp0_ep5 [label="LAYER61_AGGREGATE\nGPU: 53\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp0 -> layer61_gate_dp0_tp0_ep5 [style=dashed]
	layer61_gate_dp0_tp0_ep5 -> layer61_dispatch_dp0_tp0_ep5 [style=dashed]
	layer61_dispatch_dp0_tp0_ep5 -> layer61_expert_mlp_dp0_tp0_ep5
	layer61_expert_mlp_dp0_tp0_ep5 -> layer61_expert_proj_dp0_tp0_ep5
	layer61_expert_proj_dp0_tp0_ep5 -> layer61_expert_allreduce_dp0_tp0_ep5
	layer61_expert_allreduce_dp0_tp0_ep5 -> layer61_aggregate_dp0_tp0_ep5
	layer61_gate_dp0_tp0_ep6 [label="LAYER61_GATE\nGPU: 54\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp0_ep6 [label="LAYER61_DISPATCH\nGPU: 54\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp0_ep6 [label="LAYER61_EXPERT_MLP\nGPU: 54\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp0_ep6 [label="LAYER61_EXPERT_PROJ\nGPU: 54\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp0_ep6 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 54\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp0_ep6 [label="LAYER61_AGGREGATE\nGPU: 54\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp0 -> layer61_gate_dp0_tp0_ep6 [style=dashed]
	layer61_gate_dp0_tp0_ep6 -> layer61_dispatch_dp0_tp0_ep6 [style=dashed]
	layer61_dispatch_dp0_tp0_ep6 -> layer61_expert_mlp_dp0_tp0_ep6
	layer61_expert_mlp_dp0_tp0_ep6 -> layer61_expert_proj_dp0_tp0_ep6
	layer61_expert_proj_dp0_tp0_ep6 -> layer61_expert_allreduce_dp0_tp0_ep6
	layer61_expert_allreduce_dp0_tp0_ep6 -> layer61_aggregate_dp0_tp0_ep6
	layer61_gate_dp0_tp0_ep7 [label="LAYER61_GATE\nGPU: 55\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp0_ep7 [label="LAYER61_DISPATCH\nGPU: 55\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp0_ep7 [label="LAYER61_EXPERT_MLP\nGPU: 55\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp0_ep7 [label="LAYER61_EXPERT_PROJ\nGPU: 55\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp0_ep7 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 55\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp0_ep7 [label="LAYER61_AGGREGATE\nGPU: 55\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp0 -> layer61_gate_dp0_tp0_ep7 [style=dashed]
	layer61_gate_dp0_tp0_ep7 -> layer61_dispatch_dp0_tp0_ep7 [style=dashed]
	layer61_dispatch_dp0_tp0_ep7 -> layer61_expert_mlp_dp0_tp0_ep7
	layer61_expert_mlp_dp0_tp0_ep7 -> layer61_expert_proj_dp0_tp0_ep7
	layer61_expert_proj_dp0_tp0_ep7 -> layer61_expert_allreduce_dp0_tp0_ep7
	layer61_expert_allreduce_dp0_tp0_ep7 -> layer61_aggregate_dp0_tp0_ep7
	layer61_gate_dp0_tp0_ep8 [label="LAYER61_GATE\nGPU: 56\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp0_ep8 [label="LAYER61_DISPATCH\nGPU: 56\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp0_ep8 [label="LAYER61_EXPERT_MLP\nGPU: 56\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp0_ep8 [label="LAYER61_EXPERT_PROJ\nGPU: 56\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp0_ep8 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 56\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp0_ep8 [label="LAYER61_AGGREGATE\nGPU: 56\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp0 -> layer61_gate_dp0_tp0_ep8 [style=dashed]
	layer61_gate_dp0_tp0_ep8 -> layer61_dispatch_dp0_tp0_ep8 [style=dashed]
	layer61_dispatch_dp0_tp0_ep8 -> layer61_expert_mlp_dp0_tp0_ep8
	layer61_expert_mlp_dp0_tp0_ep8 -> layer61_expert_proj_dp0_tp0_ep8
	layer61_expert_proj_dp0_tp0_ep8 -> layer61_expert_allreduce_dp0_tp0_ep8
	layer61_expert_allreduce_dp0_tp0_ep8 -> layer61_aggregate_dp0_tp0_ep8
	layer61_gate_dp0_tp0_ep9 [label="LAYER61_GATE\nGPU: 57\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp0_ep9 [label="LAYER61_DISPATCH\nGPU: 57\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp0_ep9 [label="LAYER61_EXPERT_MLP\nGPU: 57\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp0_ep9 [label="LAYER61_EXPERT_PROJ\nGPU: 57\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp0_ep9 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 57\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp0_ep9 [label="LAYER61_AGGREGATE\nGPU: 57\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp0 -> layer61_gate_dp0_tp0_ep9 [style=dashed]
	layer61_gate_dp0_tp0_ep9 -> layer61_dispatch_dp0_tp0_ep9 [style=dashed]
	layer61_dispatch_dp0_tp0_ep9 -> layer61_expert_mlp_dp0_tp0_ep9
	layer61_expert_mlp_dp0_tp0_ep9 -> layer61_expert_proj_dp0_tp0_ep9
	layer61_expert_proj_dp0_tp0_ep9 -> layer61_expert_allreduce_dp0_tp0_ep9
	layer61_expert_allreduce_dp0_tp0_ep9 -> layer61_aggregate_dp0_tp0_ep9
	layer61_gate_dp0_tp0_ep10 [label="LAYER61_GATE\nGPU: 58\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp0_ep10 [label="LAYER61_DISPATCH\nGPU: 58\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp0_ep10 [label="LAYER61_EXPERT_MLP\nGPU: 58\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp0_ep10 [label="LAYER61_EXPERT_PROJ\nGPU: 58\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp0_ep10 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 58\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp0_ep10 [label="LAYER61_AGGREGATE\nGPU: 58\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp0 -> layer61_gate_dp0_tp0_ep10 [style=dashed]
	layer61_gate_dp0_tp0_ep10 -> layer61_dispatch_dp0_tp0_ep10 [style=dashed]
	layer61_dispatch_dp0_tp0_ep10 -> layer61_expert_mlp_dp0_tp0_ep10
	layer61_expert_mlp_dp0_tp0_ep10 -> layer61_expert_proj_dp0_tp0_ep10
	layer61_expert_proj_dp0_tp0_ep10 -> layer61_expert_allreduce_dp0_tp0_ep10
	layer61_expert_allreduce_dp0_tp0_ep10 -> layer61_aggregate_dp0_tp0_ep10
	layer61_gate_dp0_tp0_ep11 [label="LAYER61_GATE\nGPU: 59\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp0_ep11 [label="LAYER61_DISPATCH\nGPU: 59\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp0_ep11 [label="LAYER61_EXPERT_MLP\nGPU: 59\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp0_ep11 [label="LAYER61_EXPERT_PROJ\nGPU: 59\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp0_ep11 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 59\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp0_ep11 [label="LAYER61_AGGREGATE\nGPU: 59\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp0 -> layer61_gate_dp0_tp0_ep11 [style=dashed]
	layer61_gate_dp0_tp0_ep11 -> layer61_dispatch_dp0_tp0_ep11 [style=dashed]
	layer61_dispatch_dp0_tp0_ep11 -> layer61_expert_mlp_dp0_tp0_ep11
	layer61_expert_mlp_dp0_tp0_ep11 -> layer61_expert_proj_dp0_tp0_ep11
	layer61_expert_proj_dp0_tp0_ep11 -> layer61_expert_allreduce_dp0_tp0_ep11
	layer61_expert_allreduce_dp0_tp0_ep11 -> layer61_aggregate_dp0_tp0_ep11
	layer61_gate_dp0_tp0_ep12 [label="LAYER61_GATE\nGPU: 60\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp0_ep12 [label="LAYER61_DISPATCH\nGPU: 60\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp0_ep12 [label="LAYER61_EXPERT_MLP\nGPU: 60\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp0_ep12 [label="LAYER61_EXPERT_PROJ\nGPU: 60\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp0_ep12 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 60\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp0_ep12 [label="LAYER61_AGGREGATE\nGPU: 60\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp0 -> layer61_gate_dp0_tp0_ep12 [style=dashed]
	layer61_gate_dp0_tp0_ep12 -> layer61_dispatch_dp0_tp0_ep12 [style=dashed]
	layer61_dispatch_dp0_tp0_ep12 -> layer61_expert_mlp_dp0_tp0_ep12
	layer61_expert_mlp_dp0_tp0_ep12 -> layer61_expert_proj_dp0_tp0_ep12
	layer61_expert_proj_dp0_tp0_ep12 -> layer61_expert_allreduce_dp0_tp0_ep12
	layer61_expert_allreduce_dp0_tp0_ep12 -> layer61_aggregate_dp0_tp0_ep12
	layer61_gate_dp0_tp0_ep13 [label="LAYER61_GATE\nGPU: 61\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp0_ep13 [label="LAYER61_DISPATCH\nGPU: 61\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp0_ep13 [label="LAYER61_EXPERT_MLP\nGPU: 61\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp0_ep13 [label="LAYER61_EXPERT_PROJ\nGPU: 61\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp0_ep13 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 61\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp0_ep13 [label="LAYER61_AGGREGATE\nGPU: 61\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp0 -> layer61_gate_dp0_tp0_ep13 [style=dashed]
	layer61_gate_dp0_tp0_ep13 -> layer61_dispatch_dp0_tp0_ep13 [style=dashed]
	layer61_dispatch_dp0_tp0_ep13 -> layer61_expert_mlp_dp0_tp0_ep13
	layer61_expert_mlp_dp0_tp0_ep13 -> layer61_expert_proj_dp0_tp0_ep13
	layer61_expert_proj_dp0_tp0_ep13 -> layer61_expert_allreduce_dp0_tp0_ep13
	layer61_expert_allreduce_dp0_tp0_ep13 -> layer61_aggregate_dp0_tp0_ep13
	layer61_gate_dp0_tp0_ep14 [label="LAYER61_GATE\nGPU: 62\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp0_ep14 [label="LAYER61_DISPATCH\nGPU: 62\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp0_ep14 [label="LAYER61_EXPERT_MLP\nGPU: 62\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp0_ep14 [label="LAYER61_EXPERT_PROJ\nGPU: 62\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp0_ep14 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 62\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp0_ep14 [label="LAYER61_AGGREGATE\nGPU: 62\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp0 -> layer61_gate_dp0_tp0_ep14 [style=dashed]
	layer61_gate_dp0_tp0_ep14 -> layer61_dispatch_dp0_tp0_ep14 [style=dashed]
	layer61_dispatch_dp0_tp0_ep14 -> layer61_expert_mlp_dp0_tp0_ep14
	layer61_expert_mlp_dp0_tp0_ep14 -> layer61_expert_proj_dp0_tp0_ep14
	layer61_expert_proj_dp0_tp0_ep14 -> layer61_expert_allreduce_dp0_tp0_ep14
	layer61_expert_allreduce_dp0_tp0_ep14 -> layer61_aggregate_dp0_tp0_ep14
	layer61_gate_dp0_tp0_ep15 [label="LAYER61_GATE\nGPU: 63\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp0_ep15 [label="LAYER61_DISPATCH\nGPU: 63\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp0_ep15 [label="LAYER61_EXPERT_MLP\nGPU: 63\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp0_ep15 [label="LAYER61_EXPERT_PROJ\nGPU: 63\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp0_ep15 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 63\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp0_ep15 [label="LAYER61_AGGREGATE\nGPU: 63\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp0 -> layer61_gate_dp0_tp0_ep15 [style=dashed]
	layer61_gate_dp0_tp0_ep15 -> layer61_dispatch_dp0_tp0_ep15 [style=dashed]
	layer61_dispatch_dp0_tp0_ep15 -> layer61_expert_mlp_dp0_tp0_ep15
	layer61_expert_mlp_dp0_tp0_ep15 -> layer61_expert_proj_dp0_tp0_ep15
	layer61_expert_proj_dp0_tp0_ep15 -> layer61_expert_allreduce_dp0_tp0_ep15
	layer61_expert_allreduce_dp0_tp0_ep15 -> layer61_aggregate_dp0_tp0_ep15
	layer61_gate_dp0_tp1_ep0 [label="LAYER61_GATE\nGPU: 112\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp1_ep0 [label="LAYER61_DISPATCH\nGPU: 112\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp1_ep0 [label="LAYER61_EXPERT_MLP\nGPU: 112\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp1_ep0 [label="LAYER61_EXPERT_PROJ\nGPU: 112\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp1_ep0 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 112\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp1_ep0 [label="LAYER61_AGGREGATE\nGPU: 112\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp1 -> layer61_gate_dp0_tp1_ep0 [style=dashed]
	layer61_gate_dp0_tp1_ep0 -> layer61_dispatch_dp0_tp1_ep0 [style=dashed]
	layer61_dispatch_dp0_tp1_ep0 -> layer61_expert_mlp_dp0_tp1_ep0
	layer61_expert_mlp_dp0_tp1_ep0 -> layer61_expert_proj_dp0_tp1_ep0
	layer61_expert_proj_dp0_tp1_ep0 -> layer61_expert_allreduce_dp0_tp1_ep0
	layer61_expert_allreduce_dp0_tp1_ep0 -> layer61_aggregate_dp0_tp1_ep0
	layer61_gate_dp0_tp1_ep1 [label="LAYER61_GATE\nGPU: 113\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp1_ep1 [label="LAYER61_DISPATCH\nGPU: 113\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp1_ep1 [label="LAYER61_EXPERT_MLP\nGPU: 113\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp1_ep1 [label="LAYER61_EXPERT_PROJ\nGPU: 113\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp1_ep1 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 113\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp1_ep1 [label="LAYER61_AGGREGATE\nGPU: 113\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp1 -> layer61_gate_dp0_tp1_ep1 [style=dashed]
	layer61_gate_dp0_tp1_ep1 -> layer61_dispatch_dp0_tp1_ep1 [style=dashed]
	layer61_dispatch_dp0_tp1_ep1 -> layer61_expert_mlp_dp0_tp1_ep1
	layer61_expert_mlp_dp0_tp1_ep1 -> layer61_expert_proj_dp0_tp1_ep1
	layer61_expert_proj_dp0_tp1_ep1 -> layer61_expert_allreduce_dp0_tp1_ep1
	layer61_expert_allreduce_dp0_tp1_ep1 -> layer61_aggregate_dp0_tp1_ep1
	layer61_gate_dp0_tp1_ep2 [label="LAYER61_GATE\nGPU: 114\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp1_ep2 [label="LAYER61_DISPATCH\nGPU: 114\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp1_ep2 [label="LAYER61_EXPERT_MLP\nGPU: 114\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp1_ep2 [label="LAYER61_EXPERT_PROJ\nGPU: 114\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp1_ep2 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 114\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp1_ep2 [label="LAYER61_AGGREGATE\nGPU: 114\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp1 -> layer61_gate_dp0_tp1_ep2 [style=dashed]
	layer61_gate_dp0_tp1_ep2 -> layer61_dispatch_dp0_tp1_ep2 [style=dashed]
	layer61_dispatch_dp0_tp1_ep2 -> layer61_expert_mlp_dp0_tp1_ep2
	layer61_expert_mlp_dp0_tp1_ep2 -> layer61_expert_proj_dp0_tp1_ep2
	layer61_expert_proj_dp0_tp1_ep2 -> layer61_expert_allreduce_dp0_tp1_ep2
	layer61_expert_allreduce_dp0_tp1_ep2 -> layer61_aggregate_dp0_tp1_ep2
	layer61_gate_dp0_tp1_ep3 [label="LAYER61_GATE\nGPU: 115\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp1_ep3 [label="LAYER61_DISPATCH\nGPU: 115\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp1_ep3 [label="LAYER61_EXPERT_MLP\nGPU: 115\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp1_ep3 [label="LAYER61_EXPERT_PROJ\nGPU: 115\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp1_ep3 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 115\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp1_ep3 [label="LAYER61_AGGREGATE\nGPU: 115\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp1 -> layer61_gate_dp0_tp1_ep3 [style=dashed]
	layer61_gate_dp0_tp1_ep3 -> layer61_dispatch_dp0_tp1_ep3 [style=dashed]
	layer61_dispatch_dp0_tp1_ep3 -> layer61_expert_mlp_dp0_tp1_ep3
	layer61_expert_mlp_dp0_tp1_ep3 -> layer61_expert_proj_dp0_tp1_ep3
	layer61_expert_proj_dp0_tp1_ep3 -> layer61_expert_allreduce_dp0_tp1_ep3
	layer61_expert_allreduce_dp0_tp1_ep3 -> layer61_aggregate_dp0_tp1_ep3
	layer61_gate_dp0_tp1_ep4 [label="LAYER61_GATE\nGPU: 116\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp1_ep4 [label="LAYER61_DISPATCH\nGPU: 116\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp1_ep4 [label="LAYER61_EXPERT_MLP\nGPU: 116\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp1_ep4 [label="LAYER61_EXPERT_PROJ\nGPU: 116\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp1_ep4 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 116\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp1_ep4 [label="LAYER61_AGGREGATE\nGPU: 116\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp1 -> layer61_gate_dp0_tp1_ep4 [style=dashed]
	layer61_gate_dp0_tp1_ep4 -> layer61_dispatch_dp0_tp1_ep4 [style=dashed]
	layer61_dispatch_dp0_tp1_ep4 -> layer61_expert_mlp_dp0_tp1_ep4
	layer61_expert_mlp_dp0_tp1_ep4 -> layer61_expert_proj_dp0_tp1_ep4
	layer61_expert_proj_dp0_tp1_ep4 -> layer61_expert_allreduce_dp0_tp1_ep4
	layer61_expert_allreduce_dp0_tp1_ep4 -> layer61_aggregate_dp0_tp1_ep4
	layer61_gate_dp0_tp1_ep5 [label="LAYER61_GATE\nGPU: 117\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp1_ep5 [label="LAYER61_DISPATCH\nGPU: 117\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp1_ep5 [label="LAYER61_EXPERT_MLP\nGPU: 117\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp1_ep5 [label="LAYER61_EXPERT_PROJ\nGPU: 117\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp1_ep5 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 117\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp1_ep5 [label="LAYER61_AGGREGATE\nGPU: 117\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp1 -> layer61_gate_dp0_tp1_ep5 [style=dashed]
	layer61_gate_dp0_tp1_ep5 -> layer61_dispatch_dp0_tp1_ep5 [style=dashed]
	layer61_dispatch_dp0_tp1_ep5 -> layer61_expert_mlp_dp0_tp1_ep5
	layer61_expert_mlp_dp0_tp1_ep5 -> layer61_expert_proj_dp0_tp1_ep5
	layer61_expert_proj_dp0_tp1_ep5 -> layer61_expert_allreduce_dp0_tp1_ep5
	layer61_expert_allreduce_dp0_tp1_ep5 -> layer61_aggregate_dp0_tp1_ep5
	layer61_gate_dp0_tp1_ep6 [label="LAYER61_GATE\nGPU: 118\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp1_ep6 [label="LAYER61_DISPATCH\nGPU: 118\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp1_ep6 [label="LAYER61_EXPERT_MLP\nGPU: 118\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp1_ep6 [label="LAYER61_EXPERT_PROJ\nGPU: 118\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp1_ep6 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 118\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp1_ep6 [label="LAYER61_AGGREGATE\nGPU: 118\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp1 -> layer61_gate_dp0_tp1_ep6 [style=dashed]
	layer61_gate_dp0_tp1_ep6 -> layer61_dispatch_dp0_tp1_ep6 [style=dashed]
	layer61_dispatch_dp0_tp1_ep6 -> layer61_expert_mlp_dp0_tp1_ep6
	layer61_expert_mlp_dp0_tp1_ep6 -> layer61_expert_proj_dp0_tp1_ep6
	layer61_expert_proj_dp0_tp1_ep6 -> layer61_expert_allreduce_dp0_tp1_ep6
	layer61_expert_allreduce_dp0_tp1_ep6 -> layer61_aggregate_dp0_tp1_ep6
	layer61_gate_dp0_tp1_ep7 [label="LAYER61_GATE\nGPU: 119\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp1_ep7 [label="LAYER61_DISPATCH\nGPU: 119\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp1_ep7 [label="LAYER61_EXPERT_MLP\nGPU: 119\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp1_ep7 [label="LAYER61_EXPERT_PROJ\nGPU: 119\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp1_ep7 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 119\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp1_ep7 [label="LAYER61_AGGREGATE\nGPU: 119\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp1 -> layer61_gate_dp0_tp1_ep7 [style=dashed]
	layer61_gate_dp0_tp1_ep7 -> layer61_dispatch_dp0_tp1_ep7 [style=dashed]
	layer61_dispatch_dp0_tp1_ep7 -> layer61_expert_mlp_dp0_tp1_ep7
	layer61_expert_mlp_dp0_tp1_ep7 -> layer61_expert_proj_dp0_tp1_ep7
	layer61_expert_proj_dp0_tp1_ep7 -> layer61_expert_allreduce_dp0_tp1_ep7
	layer61_expert_allreduce_dp0_tp1_ep7 -> layer61_aggregate_dp0_tp1_ep7
	layer61_gate_dp0_tp1_ep8 [label="LAYER61_GATE\nGPU: 120\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp1_ep8 [label="LAYER61_DISPATCH\nGPU: 120\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp1_ep8 [label="LAYER61_EXPERT_MLP\nGPU: 120\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp1_ep8 [label="LAYER61_EXPERT_PROJ\nGPU: 120\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp1_ep8 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 120\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp1_ep8 [label="LAYER61_AGGREGATE\nGPU: 120\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp1 -> layer61_gate_dp0_tp1_ep8 [style=dashed]
	layer61_gate_dp0_tp1_ep8 -> layer61_dispatch_dp0_tp1_ep8 [style=dashed]
	layer61_dispatch_dp0_tp1_ep8 -> layer61_expert_mlp_dp0_tp1_ep8
	layer61_expert_mlp_dp0_tp1_ep8 -> layer61_expert_proj_dp0_tp1_ep8
	layer61_expert_proj_dp0_tp1_ep8 -> layer61_expert_allreduce_dp0_tp1_ep8
	layer61_expert_allreduce_dp0_tp1_ep8 -> layer61_aggregate_dp0_tp1_ep8
	layer61_gate_dp0_tp1_ep9 [label="LAYER61_GATE\nGPU: 121\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp1_ep9 [label="LAYER61_DISPATCH\nGPU: 121\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp1_ep9 [label="LAYER61_EXPERT_MLP\nGPU: 121\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp1_ep9 [label="LAYER61_EXPERT_PROJ\nGPU: 121\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp1_ep9 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 121\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp1_ep9 [label="LAYER61_AGGREGATE\nGPU: 121\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp1 -> layer61_gate_dp0_tp1_ep9 [style=dashed]
	layer61_gate_dp0_tp1_ep9 -> layer61_dispatch_dp0_tp1_ep9 [style=dashed]
	layer61_dispatch_dp0_tp1_ep9 -> layer61_expert_mlp_dp0_tp1_ep9
	layer61_expert_mlp_dp0_tp1_ep9 -> layer61_expert_proj_dp0_tp1_ep9
	layer61_expert_proj_dp0_tp1_ep9 -> layer61_expert_allreduce_dp0_tp1_ep9
	layer61_expert_allreduce_dp0_tp1_ep9 -> layer61_aggregate_dp0_tp1_ep9
	layer61_gate_dp0_tp1_ep10 [label="LAYER61_GATE\nGPU: 122\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp1_ep10 [label="LAYER61_DISPATCH\nGPU: 122\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp1_ep10 [label="LAYER61_EXPERT_MLP\nGPU: 122\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp1_ep10 [label="LAYER61_EXPERT_PROJ\nGPU: 122\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp1_ep10 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 122\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp1_ep10 [label="LAYER61_AGGREGATE\nGPU: 122\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp1 -> layer61_gate_dp0_tp1_ep10 [style=dashed]
	layer61_gate_dp0_tp1_ep10 -> layer61_dispatch_dp0_tp1_ep10 [style=dashed]
	layer61_dispatch_dp0_tp1_ep10 -> layer61_expert_mlp_dp0_tp1_ep10
	layer61_expert_mlp_dp0_tp1_ep10 -> layer61_expert_proj_dp0_tp1_ep10
	layer61_expert_proj_dp0_tp1_ep10 -> layer61_expert_allreduce_dp0_tp1_ep10
	layer61_expert_allreduce_dp0_tp1_ep10 -> layer61_aggregate_dp0_tp1_ep10
	layer61_gate_dp0_tp1_ep11 [label="LAYER61_GATE\nGPU: 123\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp1_ep11 [label="LAYER61_DISPATCH\nGPU: 123\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp1_ep11 [label="LAYER61_EXPERT_MLP\nGPU: 123\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp1_ep11 [label="LAYER61_EXPERT_PROJ\nGPU: 123\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp1_ep11 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 123\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp1_ep11 [label="LAYER61_AGGREGATE\nGPU: 123\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp1 -> layer61_gate_dp0_tp1_ep11 [style=dashed]
	layer61_gate_dp0_tp1_ep11 -> layer61_dispatch_dp0_tp1_ep11 [style=dashed]
	layer61_dispatch_dp0_tp1_ep11 -> layer61_expert_mlp_dp0_tp1_ep11
	layer61_expert_mlp_dp0_tp1_ep11 -> layer61_expert_proj_dp0_tp1_ep11
	layer61_expert_proj_dp0_tp1_ep11 -> layer61_expert_allreduce_dp0_tp1_ep11
	layer61_expert_allreduce_dp0_tp1_ep11 -> layer61_aggregate_dp0_tp1_ep11
	layer61_gate_dp0_tp1_ep12 [label="LAYER61_GATE\nGPU: 124\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp1_ep12 [label="LAYER61_DISPATCH\nGPU: 124\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp1_ep12 [label="LAYER61_EXPERT_MLP\nGPU: 124\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp1_ep12 [label="LAYER61_EXPERT_PROJ\nGPU: 124\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp1_ep12 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 124\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp1_ep12 [label="LAYER61_AGGREGATE\nGPU: 124\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp1 -> layer61_gate_dp0_tp1_ep12 [style=dashed]
	layer61_gate_dp0_tp1_ep12 -> layer61_dispatch_dp0_tp1_ep12 [style=dashed]
	layer61_dispatch_dp0_tp1_ep12 -> layer61_expert_mlp_dp0_tp1_ep12
	layer61_expert_mlp_dp0_tp1_ep12 -> layer61_expert_proj_dp0_tp1_ep12
	layer61_expert_proj_dp0_tp1_ep12 -> layer61_expert_allreduce_dp0_tp1_ep12
	layer61_expert_allreduce_dp0_tp1_ep12 -> layer61_aggregate_dp0_tp1_ep12
	layer61_gate_dp0_tp1_ep13 [label="LAYER61_GATE\nGPU: 125\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp1_ep13 [label="LAYER61_DISPATCH\nGPU: 125\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp1_ep13 [label="LAYER61_EXPERT_MLP\nGPU: 125\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp1_ep13 [label="LAYER61_EXPERT_PROJ\nGPU: 125\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp1_ep13 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 125\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp1_ep13 [label="LAYER61_AGGREGATE\nGPU: 125\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp1 -> layer61_gate_dp0_tp1_ep13 [style=dashed]
	layer61_gate_dp0_tp1_ep13 -> layer61_dispatch_dp0_tp1_ep13 [style=dashed]
	layer61_dispatch_dp0_tp1_ep13 -> layer61_expert_mlp_dp0_tp1_ep13
	layer61_expert_mlp_dp0_tp1_ep13 -> layer61_expert_proj_dp0_tp1_ep13
	layer61_expert_proj_dp0_tp1_ep13 -> layer61_expert_allreduce_dp0_tp1_ep13
	layer61_expert_allreduce_dp0_tp1_ep13 -> layer61_aggregate_dp0_tp1_ep13
	layer61_gate_dp0_tp1_ep14 [label="LAYER61_GATE\nGPU: 126\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp1_ep14 [label="LAYER61_DISPATCH\nGPU: 126\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp1_ep14 [label="LAYER61_EXPERT_MLP\nGPU: 126\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp1_ep14 [label="LAYER61_EXPERT_PROJ\nGPU: 126\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp1_ep14 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 126\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp1_ep14 [label="LAYER61_AGGREGATE\nGPU: 126\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp1 -> layer61_gate_dp0_tp1_ep14 [style=dashed]
	layer61_gate_dp0_tp1_ep14 -> layer61_dispatch_dp0_tp1_ep14 [style=dashed]
	layer61_dispatch_dp0_tp1_ep14 -> layer61_expert_mlp_dp0_tp1_ep14
	layer61_expert_mlp_dp0_tp1_ep14 -> layer61_expert_proj_dp0_tp1_ep14
	layer61_expert_proj_dp0_tp1_ep14 -> layer61_expert_allreduce_dp0_tp1_ep14
	layer61_expert_allreduce_dp0_tp1_ep14 -> layer61_aggregate_dp0_tp1_ep14
	layer61_gate_dp0_tp1_ep15 [label="LAYER61_GATE\nGPU: 127\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp0_tp1_ep15 [label="LAYER61_DISPATCH\nGPU: 127\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp0_tp1_ep15 [label="LAYER61_EXPERT_MLP\nGPU: 127\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp0_tp1_ep15 [label="LAYER61_EXPERT_PROJ\nGPU: 127\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp0_tp1_ep15 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 127\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp1_ep15 [label="LAYER61_AGGREGATE\nGPU: 127\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp0_tp1 -> layer61_gate_dp0_tp1_ep15 [style=dashed]
	layer61_gate_dp0_tp1_ep15 -> layer61_dispatch_dp0_tp1_ep15 [style=dashed]
	layer61_dispatch_dp0_tp1_ep15 -> layer61_expert_mlp_dp0_tp1_ep15
	layer61_expert_mlp_dp0_tp1_ep15 -> layer61_expert_proj_dp0_tp1_ep15
	layer61_expert_proj_dp0_tp1_ep15 -> layer61_expert_allreduce_dp0_tp1_ep15
	layer61_expert_allreduce_dp0_tp1_ep15 -> layer61_aggregate_dp0_tp1_ep15
	layer61_gate_dp1_tp0_ep0 [label="LAYER61_GATE\nGPU: 176\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp0_ep0 [label="LAYER61_DISPATCH\nGPU: 176\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp0_ep0 [label="LAYER61_EXPERT_MLP\nGPU: 176\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp0_ep0 [label="LAYER61_EXPERT_PROJ\nGPU: 176\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp0_ep0 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 176\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp0_ep0 [label="LAYER61_AGGREGATE\nGPU: 176\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp0 -> layer61_gate_dp1_tp0_ep0 [style=dashed]
	layer61_gate_dp1_tp0_ep0 -> layer61_dispatch_dp1_tp0_ep0 [style=dashed]
	layer61_dispatch_dp1_tp0_ep0 -> layer61_expert_mlp_dp1_tp0_ep0
	layer61_expert_mlp_dp1_tp0_ep0 -> layer61_expert_proj_dp1_tp0_ep0
	layer61_expert_proj_dp1_tp0_ep0 -> layer61_expert_allreduce_dp1_tp0_ep0
	layer61_expert_allreduce_dp1_tp0_ep0 -> layer61_aggregate_dp1_tp0_ep0
	layer61_gate_dp1_tp0_ep1 [label="LAYER61_GATE\nGPU: 177\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp0_ep1 [label="LAYER61_DISPATCH\nGPU: 177\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp0_ep1 [label="LAYER61_EXPERT_MLP\nGPU: 177\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp0_ep1 [label="LAYER61_EXPERT_PROJ\nGPU: 177\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp0_ep1 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 177\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp0_ep1 [label="LAYER61_AGGREGATE\nGPU: 177\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp0 -> layer61_gate_dp1_tp0_ep1 [style=dashed]
	layer61_gate_dp1_tp0_ep1 -> layer61_dispatch_dp1_tp0_ep1 [style=dashed]
	layer61_dispatch_dp1_tp0_ep1 -> layer61_expert_mlp_dp1_tp0_ep1
	layer61_expert_mlp_dp1_tp0_ep1 -> layer61_expert_proj_dp1_tp0_ep1
	layer61_expert_proj_dp1_tp0_ep1 -> layer61_expert_allreduce_dp1_tp0_ep1
	layer61_expert_allreduce_dp1_tp0_ep1 -> layer61_aggregate_dp1_tp0_ep1
	layer61_gate_dp1_tp0_ep2 [label="LAYER61_GATE\nGPU: 178\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp0_ep2 [label="LAYER61_DISPATCH\nGPU: 178\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp0_ep2 [label="LAYER61_EXPERT_MLP\nGPU: 178\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp0_ep2 [label="LAYER61_EXPERT_PROJ\nGPU: 178\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp0_ep2 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 178\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp0_ep2 [label="LAYER61_AGGREGATE\nGPU: 178\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp0 -> layer61_gate_dp1_tp0_ep2 [style=dashed]
	layer61_gate_dp1_tp0_ep2 -> layer61_dispatch_dp1_tp0_ep2 [style=dashed]
	layer61_dispatch_dp1_tp0_ep2 -> layer61_expert_mlp_dp1_tp0_ep2
	layer61_expert_mlp_dp1_tp0_ep2 -> layer61_expert_proj_dp1_tp0_ep2
	layer61_expert_proj_dp1_tp0_ep2 -> layer61_expert_allreduce_dp1_tp0_ep2
	layer61_expert_allreduce_dp1_tp0_ep2 -> layer61_aggregate_dp1_tp0_ep2
	layer61_gate_dp1_tp0_ep3 [label="LAYER61_GATE\nGPU: 179\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp0_ep3 [label="LAYER61_DISPATCH\nGPU: 179\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp0_ep3 [label="LAYER61_EXPERT_MLP\nGPU: 179\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp0_ep3 [label="LAYER61_EXPERT_PROJ\nGPU: 179\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp0_ep3 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 179\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp0_ep3 [label="LAYER61_AGGREGATE\nGPU: 179\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp0 -> layer61_gate_dp1_tp0_ep3 [style=dashed]
	layer61_gate_dp1_tp0_ep3 -> layer61_dispatch_dp1_tp0_ep3 [style=dashed]
	layer61_dispatch_dp1_tp0_ep3 -> layer61_expert_mlp_dp1_tp0_ep3
	layer61_expert_mlp_dp1_tp0_ep3 -> layer61_expert_proj_dp1_tp0_ep3
	layer61_expert_proj_dp1_tp0_ep3 -> layer61_expert_allreduce_dp1_tp0_ep3
	layer61_expert_allreduce_dp1_tp0_ep3 -> layer61_aggregate_dp1_tp0_ep3
	layer61_gate_dp1_tp0_ep4 [label="LAYER61_GATE\nGPU: 180\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp0_ep4 [label="LAYER61_DISPATCH\nGPU: 180\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp0_ep4 [label="LAYER61_EXPERT_MLP\nGPU: 180\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp0_ep4 [label="LAYER61_EXPERT_PROJ\nGPU: 180\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp0_ep4 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 180\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp0_ep4 [label="LAYER61_AGGREGATE\nGPU: 180\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp0 -> layer61_gate_dp1_tp0_ep4 [style=dashed]
	layer61_gate_dp1_tp0_ep4 -> layer61_dispatch_dp1_tp0_ep4 [style=dashed]
	layer61_dispatch_dp1_tp0_ep4 -> layer61_expert_mlp_dp1_tp0_ep4
	layer61_expert_mlp_dp1_tp0_ep4 -> layer61_expert_proj_dp1_tp0_ep4
	layer61_expert_proj_dp1_tp0_ep4 -> layer61_expert_allreduce_dp1_tp0_ep4
	layer61_expert_allreduce_dp1_tp0_ep4 -> layer61_aggregate_dp1_tp0_ep4
	layer61_gate_dp1_tp0_ep5 [label="LAYER61_GATE\nGPU: 181\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp0_ep5 [label="LAYER61_DISPATCH\nGPU: 181\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp0_ep5 [label="LAYER61_EXPERT_MLP\nGPU: 181\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp0_ep5 [label="LAYER61_EXPERT_PROJ\nGPU: 181\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp0_ep5 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 181\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp0_ep5 [label="LAYER61_AGGREGATE\nGPU: 181\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp0 -> layer61_gate_dp1_tp0_ep5 [style=dashed]
	layer61_gate_dp1_tp0_ep5 -> layer61_dispatch_dp1_tp0_ep5 [style=dashed]
	layer61_dispatch_dp1_tp0_ep5 -> layer61_expert_mlp_dp1_tp0_ep5
	layer61_expert_mlp_dp1_tp0_ep5 -> layer61_expert_proj_dp1_tp0_ep5
	layer61_expert_proj_dp1_tp0_ep5 -> layer61_expert_allreduce_dp1_tp0_ep5
	layer61_expert_allreduce_dp1_tp0_ep5 -> layer61_aggregate_dp1_tp0_ep5
	layer61_gate_dp1_tp0_ep6 [label="LAYER61_GATE\nGPU: 182\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp0_ep6 [label="LAYER61_DISPATCH\nGPU: 182\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp0_ep6 [label="LAYER61_EXPERT_MLP\nGPU: 182\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp0_ep6 [label="LAYER61_EXPERT_PROJ\nGPU: 182\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp0_ep6 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 182\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp0_ep6 [label="LAYER61_AGGREGATE\nGPU: 182\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp0 -> layer61_gate_dp1_tp0_ep6 [style=dashed]
	layer61_gate_dp1_tp0_ep6 -> layer61_dispatch_dp1_tp0_ep6 [style=dashed]
	layer61_dispatch_dp1_tp0_ep6 -> layer61_expert_mlp_dp1_tp0_ep6
	layer61_expert_mlp_dp1_tp0_ep6 -> layer61_expert_proj_dp1_tp0_ep6
	layer61_expert_proj_dp1_tp0_ep6 -> layer61_expert_allreduce_dp1_tp0_ep6
	layer61_expert_allreduce_dp1_tp0_ep6 -> layer61_aggregate_dp1_tp0_ep6
	layer61_gate_dp1_tp0_ep7 [label="LAYER61_GATE\nGPU: 183\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp0_ep7 [label="LAYER61_DISPATCH\nGPU: 183\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp0_ep7 [label="LAYER61_EXPERT_MLP\nGPU: 183\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp0_ep7 [label="LAYER61_EXPERT_PROJ\nGPU: 183\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp0_ep7 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 183\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp0_ep7 [label="LAYER61_AGGREGATE\nGPU: 183\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp0 -> layer61_gate_dp1_tp0_ep7 [style=dashed]
	layer61_gate_dp1_tp0_ep7 -> layer61_dispatch_dp1_tp0_ep7 [style=dashed]
	layer61_dispatch_dp1_tp0_ep7 -> layer61_expert_mlp_dp1_tp0_ep7
	layer61_expert_mlp_dp1_tp0_ep7 -> layer61_expert_proj_dp1_tp0_ep7
	layer61_expert_proj_dp1_tp0_ep7 -> layer61_expert_allreduce_dp1_tp0_ep7
	layer61_expert_allreduce_dp1_tp0_ep7 -> layer61_aggregate_dp1_tp0_ep7
	layer61_gate_dp1_tp0_ep8 [label="LAYER61_GATE\nGPU: 184\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp0_ep8 [label="LAYER61_DISPATCH\nGPU: 184\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp0_ep8 [label="LAYER61_EXPERT_MLP\nGPU: 184\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp0_ep8 [label="LAYER61_EXPERT_PROJ\nGPU: 184\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp0_ep8 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 184\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp0_ep8 [label="LAYER61_AGGREGATE\nGPU: 184\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp0 -> layer61_gate_dp1_tp0_ep8 [style=dashed]
	layer61_gate_dp1_tp0_ep8 -> layer61_dispatch_dp1_tp0_ep8 [style=dashed]
	layer61_dispatch_dp1_tp0_ep8 -> layer61_expert_mlp_dp1_tp0_ep8
	layer61_expert_mlp_dp1_tp0_ep8 -> layer61_expert_proj_dp1_tp0_ep8
	layer61_expert_proj_dp1_tp0_ep8 -> layer61_expert_allreduce_dp1_tp0_ep8
	layer61_expert_allreduce_dp1_tp0_ep8 -> layer61_aggregate_dp1_tp0_ep8
	layer61_gate_dp1_tp0_ep9 [label="LAYER61_GATE\nGPU: 185\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp0_ep9 [label="LAYER61_DISPATCH\nGPU: 185\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp0_ep9 [label="LAYER61_EXPERT_MLP\nGPU: 185\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp0_ep9 [label="LAYER61_EXPERT_PROJ\nGPU: 185\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp0_ep9 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 185\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp0_ep9 [label="LAYER61_AGGREGATE\nGPU: 185\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp0 -> layer61_gate_dp1_tp0_ep9 [style=dashed]
	layer61_gate_dp1_tp0_ep9 -> layer61_dispatch_dp1_tp0_ep9 [style=dashed]
	layer61_dispatch_dp1_tp0_ep9 -> layer61_expert_mlp_dp1_tp0_ep9
	layer61_expert_mlp_dp1_tp0_ep9 -> layer61_expert_proj_dp1_tp0_ep9
	layer61_expert_proj_dp1_tp0_ep9 -> layer61_expert_allreduce_dp1_tp0_ep9
	layer61_expert_allreduce_dp1_tp0_ep9 -> layer61_aggregate_dp1_tp0_ep9
	layer61_gate_dp1_tp0_ep10 [label="LAYER61_GATE\nGPU: 186\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp0_ep10 [label="LAYER61_DISPATCH\nGPU: 186\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp0_ep10 [label="LAYER61_EXPERT_MLP\nGPU: 186\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp0_ep10 [label="LAYER61_EXPERT_PROJ\nGPU: 186\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp0_ep10 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 186\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp0_ep10 [label="LAYER61_AGGREGATE\nGPU: 186\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp0 -> layer61_gate_dp1_tp0_ep10 [style=dashed]
	layer61_gate_dp1_tp0_ep10 -> layer61_dispatch_dp1_tp0_ep10 [style=dashed]
	layer61_dispatch_dp1_tp0_ep10 -> layer61_expert_mlp_dp1_tp0_ep10
	layer61_expert_mlp_dp1_tp0_ep10 -> layer61_expert_proj_dp1_tp0_ep10
	layer61_expert_proj_dp1_tp0_ep10 -> layer61_expert_allreduce_dp1_tp0_ep10
	layer61_expert_allreduce_dp1_tp0_ep10 -> layer61_aggregate_dp1_tp0_ep10
	layer61_gate_dp1_tp0_ep11 [label="LAYER61_GATE\nGPU: 187\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp0_ep11 [label="LAYER61_DISPATCH\nGPU: 187\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp0_ep11 [label="LAYER61_EXPERT_MLP\nGPU: 187\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp0_ep11 [label="LAYER61_EXPERT_PROJ\nGPU: 187\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp0_ep11 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 187\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp0_ep11 [label="LAYER61_AGGREGATE\nGPU: 187\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp0 -> layer61_gate_dp1_tp0_ep11 [style=dashed]
	layer61_gate_dp1_tp0_ep11 -> layer61_dispatch_dp1_tp0_ep11 [style=dashed]
	layer61_dispatch_dp1_tp0_ep11 -> layer61_expert_mlp_dp1_tp0_ep11
	layer61_expert_mlp_dp1_tp0_ep11 -> layer61_expert_proj_dp1_tp0_ep11
	layer61_expert_proj_dp1_tp0_ep11 -> layer61_expert_allreduce_dp1_tp0_ep11
	layer61_expert_allreduce_dp1_tp0_ep11 -> layer61_aggregate_dp1_tp0_ep11
	layer61_gate_dp1_tp0_ep12 [label="LAYER61_GATE\nGPU: 188\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp0_ep12 [label="LAYER61_DISPATCH\nGPU: 188\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp0_ep12 [label="LAYER61_EXPERT_MLP\nGPU: 188\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp0_ep12 [label="LAYER61_EXPERT_PROJ\nGPU: 188\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp0_ep12 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 188\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp0_ep12 [label="LAYER61_AGGREGATE\nGPU: 188\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp0 -> layer61_gate_dp1_tp0_ep12 [style=dashed]
	layer61_gate_dp1_tp0_ep12 -> layer61_dispatch_dp1_tp0_ep12 [style=dashed]
	layer61_dispatch_dp1_tp0_ep12 -> layer61_expert_mlp_dp1_tp0_ep12
	layer61_expert_mlp_dp1_tp0_ep12 -> layer61_expert_proj_dp1_tp0_ep12
	layer61_expert_proj_dp1_tp0_ep12 -> layer61_expert_allreduce_dp1_tp0_ep12
	layer61_expert_allreduce_dp1_tp0_ep12 -> layer61_aggregate_dp1_tp0_ep12
	layer61_gate_dp1_tp0_ep13 [label="LAYER61_GATE\nGPU: 189\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp0_ep13 [label="LAYER61_DISPATCH\nGPU: 189\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp0_ep13 [label="LAYER61_EXPERT_MLP\nGPU: 189\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp0_ep13 [label="LAYER61_EXPERT_PROJ\nGPU: 189\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp0_ep13 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 189\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp0_ep13 [label="LAYER61_AGGREGATE\nGPU: 189\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp0 -> layer61_gate_dp1_tp0_ep13 [style=dashed]
	layer61_gate_dp1_tp0_ep13 -> layer61_dispatch_dp1_tp0_ep13 [style=dashed]
	layer61_dispatch_dp1_tp0_ep13 -> layer61_expert_mlp_dp1_tp0_ep13
	layer61_expert_mlp_dp1_tp0_ep13 -> layer61_expert_proj_dp1_tp0_ep13
	layer61_expert_proj_dp1_tp0_ep13 -> layer61_expert_allreduce_dp1_tp0_ep13
	layer61_expert_allreduce_dp1_tp0_ep13 -> layer61_aggregate_dp1_tp0_ep13
	layer61_gate_dp1_tp0_ep14 [label="LAYER61_GATE\nGPU: 190\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp0_ep14 [label="LAYER61_DISPATCH\nGPU: 190\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp0_ep14 [label="LAYER61_EXPERT_MLP\nGPU: 190\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp0_ep14 [label="LAYER61_EXPERT_PROJ\nGPU: 190\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp0_ep14 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 190\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp0_ep14 [label="LAYER61_AGGREGATE\nGPU: 190\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp0 -> layer61_gate_dp1_tp0_ep14 [style=dashed]
	layer61_gate_dp1_tp0_ep14 -> layer61_dispatch_dp1_tp0_ep14 [style=dashed]
	layer61_dispatch_dp1_tp0_ep14 -> layer61_expert_mlp_dp1_tp0_ep14
	layer61_expert_mlp_dp1_tp0_ep14 -> layer61_expert_proj_dp1_tp0_ep14
	layer61_expert_proj_dp1_tp0_ep14 -> layer61_expert_allreduce_dp1_tp0_ep14
	layer61_expert_allreduce_dp1_tp0_ep14 -> layer61_aggregate_dp1_tp0_ep14
	layer61_gate_dp1_tp0_ep15 [label="LAYER61_GATE\nGPU: 191\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp0_ep15 [label="LAYER61_DISPATCH\nGPU: 191\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp0_ep15 [label="LAYER61_EXPERT_MLP\nGPU: 191\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp0_ep15 [label="LAYER61_EXPERT_PROJ\nGPU: 191\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp0_ep15 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 191\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp0_ep15 [label="LAYER61_AGGREGATE\nGPU: 191\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp0 -> layer61_gate_dp1_tp0_ep15 [style=dashed]
	layer61_gate_dp1_tp0_ep15 -> layer61_dispatch_dp1_tp0_ep15 [style=dashed]
	layer61_dispatch_dp1_tp0_ep15 -> layer61_expert_mlp_dp1_tp0_ep15
	layer61_expert_mlp_dp1_tp0_ep15 -> layer61_expert_proj_dp1_tp0_ep15
	layer61_expert_proj_dp1_tp0_ep15 -> layer61_expert_allreduce_dp1_tp0_ep15
	layer61_expert_allreduce_dp1_tp0_ep15 -> layer61_aggregate_dp1_tp0_ep15
	layer61_gate_dp1_tp1_ep0 [label="LAYER61_GATE\nGPU: 240\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp1_ep0 [label="LAYER61_DISPATCH\nGPU: 240\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp1_ep0 [label="LAYER61_EXPERT_MLP\nGPU: 240\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp1_ep0 [label="LAYER61_EXPERT_PROJ\nGPU: 240\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp1_ep0 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 240\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp1_ep0 [label="LAYER61_AGGREGATE\nGPU: 240\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp1 -> layer61_gate_dp1_tp1_ep0 [style=dashed]
	layer61_gate_dp1_tp1_ep0 -> layer61_dispatch_dp1_tp1_ep0 [style=dashed]
	layer61_dispatch_dp1_tp1_ep0 -> layer61_expert_mlp_dp1_tp1_ep0
	layer61_expert_mlp_dp1_tp1_ep0 -> layer61_expert_proj_dp1_tp1_ep0
	layer61_expert_proj_dp1_tp1_ep0 -> layer61_expert_allreduce_dp1_tp1_ep0
	layer61_expert_allreduce_dp1_tp1_ep0 -> layer61_aggregate_dp1_tp1_ep0
	layer61_gate_dp1_tp1_ep1 [label="LAYER61_GATE\nGPU: 241\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp1_ep1 [label="LAYER61_DISPATCH\nGPU: 241\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp1_ep1 [label="LAYER61_EXPERT_MLP\nGPU: 241\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp1_ep1 [label="LAYER61_EXPERT_PROJ\nGPU: 241\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp1_ep1 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 241\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp1_ep1 [label="LAYER61_AGGREGATE\nGPU: 241\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp1 -> layer61_gate_dp1_tp1_ep1 [style=dashed]
	layer61_gate_dp1_tp1_ep1 -> layer61_dispatch_dp1_tp1_ep1 [style=dashed]
	layer61_dispatch_dp1_tp1_ep1 -> layer61_expert_mlp_dp1_tp1_ep1
	layer61_expert_mlp_dp1_tp1_ep1 -> layer61_expert_proj_dp1_tp1_ep1
	layer61_expert_proj_dp1_tp1_ep1 -> layer61_expert_allreduce_dp1_tp1_ep1
	layer61_expert_allreduce_dp1_tp1_ep1 -> layer61_aggregate_dp1_tp1_ep1
	layer61_gate_dp1_tp1_ep2 [label="LAYER61_GATE\nGPU: 242\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp1_ep2 [label="LAYER61_DISPATCH\nGPU: 242\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp1_ep2 [label="LAYER61_EXPERT_MLP\nGPU: 242\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp1_ep2 [label="LAYER61_EXPERT_PROJ\nGPU: 242\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp1_ep2 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 242\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp1_ep2 [label="LAYER61_AGGREGATE\nGPU: 242\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp1 -> layer61_gate_dp1_tp1_ep2 [style=dashed]
	layer61_gate_dp1_tp1_ep2 -> layer61_dispatch_dp1_tp1_ep2 [style=dashed]
	layer61_dispatch_dp1_tp1_ep2 -> layer61_expert_mlp_dp1_tp1_ep2
	layer61_expert_mlp_dp1_tp1_ep2 -> layer61_expert_proj_dp1_tp1_ep2
	layer61_expert_proj_dp1_tp1_ep2 -> layer61_expert_allreduce_dp1_tp1_ep2
	layer61_expert_allreduce_dp1_tp1_ep2 -> layer61_aggregate_dp1_tp1_ep2
	layer61_gate_dp1_tp1_ep3 [label="LAYER61_GATE\nGPU: 243\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp1_ep3 [label="LAYER61_DISPATCH\nGPU: 243\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp1_ep3 [label="LAYER61_EXPERT_MLP\nGPU: 243\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp1_ep3 [label="LAYER61_EXPERT_PROJ\nGPU: 243\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp1_ep3 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 243\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp1_ep3 [label="LAYER61_AGGREGATE\nGPU: 243\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp1 -> layer61_gate_dp1_tp1_ep3 [style=dashed]
	layer61_gate_dp1_tp1_ep3 -> layer61_dispatch_dp1_tp1_ep3 [style=dashed]
	layer61_dispatch_dp1_tp1_ep3 -> layer61_expert_mlp_dp1_tp1_ep3
	layer61_expert_mlp_dp1_tp1_ep3 -> layer61_expert_proj_dp1_tp1_ep3
	layer61_expert_proj_dp1_tp1_ep3 -> layer61_expert_allreduce_dp1_tp1_ep3
	layer61_expert_allreduce_dp1_tp1_ep3 -> layer61_aggregate_dp1_tp1_ep3
	layer61_gate_dp1_tp1_ep4 [label="LAYER61_GATE\nGPU: 244\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp1_ep4 [label="LAYER61_DISPATCH\nGPU: 244\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp1_ep4 [label="LAYER61_EXPERT_MLP\nGPU: 244\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp1_ep4 [label="LAYER61_EXPERT_PROJ\nGPU: 244\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp1_ep4 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 244\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp1_ep4 [label="LAYER61_AGGREGATE\nGPU: 244\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp1 -> layer61_gate_dp1_tp1_ep4 [style=dashed]
	layer61_gate_dp1_tp1_ep4 -> layer61_dispatch_dp1_tp1_ep4 [style=dashed]
	layer61_dispatch_dp1_tp1_ep4 -> layer61_expert_mlp_dp1_tp1_ep4
	layer61_expert_mlp_dp1_tp1_ep4 -> layer61_expert_proj_dp1_tp1_ep4
	layer61_expert_proj_dp1_tp1_ep4 -> layer61_expert_allreduce_dp1_tp1_ep4
	layer61_expert_allreduce_dp1_tp1_ep4 -> layer61_aggregate_dp1_tp1_ep4
	layer61_gate_dp1_tp1_ep5 [label="LAYER61_GATE\nGPU: 245\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp1_ep5 [label="LAYER61_DISPATCH\nGPU: 245\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp1_ep5 [label="LAYER61_EXPERT_MLP\nGPU: 245\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp1_ep5 [label="LAYER61_EXPERT_PROJ\nGPU: 245\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp1_ep5 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 245\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp1_ep5 [label="LAYER61_AGGREGATE\nGPU: 245\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp1 -> layer61_gate_dp1_tp1_ep5 [style=dashed]
	layer61_gate_dp1_tp1_ep5 -> layer61_dispatch_dp1_tp1_ep5 [style=dashed]
	layer61_dispatch_dp1_tp1_ep5 -> layer61_expert_mlp_dp1_tp1_ep5
	layer61_expert_mlp_dp1_tp1_ep5 -> layer61_expert_proj_dp1_tp1_ep5
	layer61_expert_proj_dp1_tp1_ep5 -> layer61_expert_allreduce_dp1_tp1_ep5
	layer61_expert_allreduce_dp1_tp1_ep5 -> layer61_aggregate_dp1_tp1_ep5
	layer61_gate_dp1_tp1_ep6 [label="LAYER61_GATE\nGPU: 246\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp1_ep6 [label="LAYER61_DISPATCH\nGPU: 246\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp1_ep6 [label="LAYER61_EXPERT_MLP\nGPU: 246\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp1_ep6 [label="LAYER61_EXPERT_PROJ\nGPU: 246\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp1_ep6 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 246\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp1_ep6 [label="LAYER61_AGGREGATE\nGPU: 246\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp1 -> layer61_gate_dp1_tp1_ep6 [style=dashed]
	layer61_gate_dp1_tp1_ep6 -> layer61_dispatch_dp1_tp1_ep6 [style=dashed]
	layer61_dispatch_dp1_tp1_ep6 -> layer61_expert_mlp_dp1_tp1_ep6
	layer61_expert_mlp_dp1_tp1_ep6 -> layer61_expert_proj_dp1_tp1_ep6
	layer61_expert_proj_dp1_tp1_ep6 -> layer61_expert_allreduce_dp1_tp1_ep6
	layer61_expert_allreduce_dp1_tp1_ep6 -> layer61_aggregate_dp1_tp1_ep6
	layer61_gate_dp1_tp1_ep7 [label="LAYER61_GATE\nGPU: 247\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp1_ep7 [label="LAYER61_DISPATCH\nGPU: 247\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp1_ep7 [label="LAYER61_EXPERT_MLP\nGPU: 247\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp1_ep7 [label="LAYER61_EXPERT_PROJ\nGPU: 247\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp1_ep7 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 247\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp1_ep7 [label="LAYER61_AGGREGATE\nGPU: 247\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp1 -> layer61_gate_dp1_tp1_ep7 [style=dashed]
	layer61_gate_dp1_tp1_ep7 -> layer61_dispatch_dp1_tp1_ep7 [style=dashed]
	layer61_dispatch_dp1_tp1_ep7 -> layer61_expert_mlp_dp1_tp1_ep7
	layer61_expert_mlp_dp1_tp1_ep7 -> layer61_expert_proj_dp1_tp1_ep7
	layer61_expert_proj_dp1_tp1_ep7 -> layer61_expert_allreduce_dp1_tp1_ep7
	layer61_expert_allreduce_dp1_tp1_ep7 -> layer61_aggregate_dp1_tp1_ep7
	layer61_gate_dp1_tp1_ep8 [label="LAYER61_GATE\nGPU: 248\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp1_ep8 [label="LAYER61_DISPATCH\nGPU: 248\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp1_ep8 [label="LAYER61_EXPERT_MLP\nGPU: 248\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp1_ep8 [label="LAYER61_EXPERT_PROJ\nGPU: 248\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp1_ep8 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 248\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp1_ep8 [label="LAYER61_AGGREGATE\nGPU: 248\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp1 -> layer61_gate_dp1_tp1_ep8 [style=dashed]
	layer61_gate_dp1_tp1_ep8 -> layer61_dispatch_dp1_tp1_ep8 [style=dashed]
	layer61_dispatch_dp1_tp1_ep8 -> layer61_expert_mlp_dp1_tp1_ep8
	layer61_expert_mlp_dp1_tp1_ep8 -> layer61_expert_proj_dp1_tp1_ep8
	layer61_expert_proj_dp1_tp1_ep8 -> layer61_expert_allreduce_dp1_tp1_ep8
	layer61_expert_allreduce_dp1_tp1_ep8 -> layer61_aggregate_dp1_tp1_ep8
	layer61_gate_dp1_tp1_ep9 [label="LAYER61_GATE\nGPU: 249\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp1_ep9 [label="LAYER61_DISPATCH\nGPU: 249\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp1_ep9 [label="LAYER61_EXPERT_MLP\nGPU: 249\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp1_ep9 [label="LAYER61_EXPERT_PROJ\nGPU: 249\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp1_ep9 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 249\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp1_ep9 [label="LAYER61_AGGREGATE\nGPU: 249\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp1 -> layer61_gate_dp1_tp1_ep9 [style=dashed]
	layer61_gate_dp1_tp1_ep9 -> layer61_dispatch_dp1_tp1_ep9 [style=dashed]
	layer61_dispatch_dp1_tp1_ep9 -> layer61_expert_mlp_dp1_tp1_ep9
	layer61_expert_mlp_dp1_tp1_ep9 -> layer61_expert_proj_dp1_tp1_ep9
	layer61_expert_proj_dp1_tp1_ep9 -> layer61_expert_allreduce_dp1_tp1_ep9
	layer61_expert_allreduce_dp1_tp1_ep9 -> layer61_aggregate_dp1_tp1_ep9
	layer61_gate_dp1_tp1_ep10 [label="LAYER61_GATE\nGPU: 250\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp1_ep10 [label="LAYER61_DISPATCH\nGPU: 250\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp1_ep10 [label="LAYER61_EXPERT_MLP\nGPU: 250\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp1_ep10 [label="LAYER61_EXPERT_PROJ\nGPU: 250\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp1_ep10 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 250\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp1_ep10 [label="LAYER61_AGGREGATE\nGPU: 250\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp1 -> layer61_gate_dp1_tp1_ep10 [style=dashed]
	layer61_gate_dp1_tp1_ep10 -> layer61_dispatch_dp1_tp1_ep10 [style=dashed]
	layer61_dispatch_dp1_tp1_ep10 -> layer61_expert_mlp_dp1_tp1_ep10
	layer61_expert_mlp_dp1_tp1_ep10 -> layer61_expert_proj_dp1_tp1_ep10
	layer61_expert_proj_dp1_tp1_ep10 -> layer61_expert_allreduce_dp1_tp1_ep10
	layer61_expert_allreduce_dp1_tp1_ep10 -> layer61_aggregate_dp1_tp1_ep10
	layer61_gate_dp1_tp1_ep11 [label="LAYER61_GATE\nGPU: 251\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp1_ep11 [label="LAYER61_DISPATCH\nGPU: 251\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp1_ep11 [label="LAYER61_EXPERT_MLP\nGPU: 251\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp1_ep11 [label="LAYER61_EXPERT_PROJ\nGPU: 251\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp1_ep11 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 251\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp1_ep11 [label="LAYER61_AGGREGATE\nGPU: 251\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp1 -> layer61_gate_dp1_tp1_ep11 [style=dashed]
	layer61_gate_dp1_tp1_ep11 -> layer61_dispatch_dp1_tp1_ep11 [style=dashed]
	layer61_dispatch_dp1_tp1_ep11 -> layer61_expert_mlp_dp1_tp1_ep11
	layer61_expert_mlp_dp1_tp1_ep11 -> layer61_expert_proj_dp1_tp1_ep11
	layer61_expert_proj_dp1_tp1_ep11 -> layer61_expert_allreduce_dp1_tp1_ep11
	layer61_expert_allreduce_dp1_tp1_ep11 -> layer61_aggregate_dp1_tp1_ep11
	layer61_gate_dp1_tp1_ep12 [label="LAYER61_GATE\nGPU: 252\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp1_ep12 [label="LAYER61_DISPATCH\nGPU: 252\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp1_ep12 [label="LAYER61_EXPERT_MLP\nGPU: 252\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp1_ep12 [label="LAYER61_EXPERT_PROJ\nGPU: 252\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp1_ep12 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 252\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp1_ep12 [label="LAYER61_AGGREGATE\nGPU: 252\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp1 -> layer61_gate_dp1_tp1_ep12 [style=dashed]
	layer61_gate_dp1_tp1_ep12 -> layer61_dispatch_dp1_tp1_ep12 [style=dashed]
	layer61_dispatch_dp1_tp1_ep12 -> layer61_expert_mlp_dp1_tp1_ep12
	layer61_expert_mlp_dp1_tp1_ep12 -> layer61_expert_proj_dp1_tp1_ep12
	layer61_expert_proj_dp1_tp1_ep12 -> layer61_expert_allreduce_dp1_tp1_ep12
	layer61_expert_allreduce_dp1_tp1_ep12 -> layer61_aggregate_dp1_tp1_ep12
	layer61_gate_dp1_tp1_ep13 [label="LAYER61_GATE\nGPU: 253\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp1_ep13 [label="LAYER61_DISPATCH\nGPU: 253\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp1_ep13 [label="LAYER61_EXPERT_MLP\nGPU: 253\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp1_ep13 [label="LAYER61_EXPERT_PROJ\nGPU: 253\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp1_ep13 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 253\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp1_ep13 [label="LAYER61_AGGREGATE\nGPU: 253\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp1 -> layer61_gate_dp1_tp1_ep13 [style=dashed]
	layer61_gate_dp1_tp1_ep13 -> layer61_dispatch_dp1_tp1_ep13 [style=dashed]
	layer61_dispatch_dp1_tp1_ep13 -> layer61_expert_mlp_dp1_tp1_ep13
	layer61_expert_mlp_dp1_tp1_ep13 -> layer61_expert_proj_dp1_tp1_ep13
	layer61_expert_proj_dp1_tp1_ep13 -> layer61_expert_allreduce_dp1_tp1_ep13
	layer61_expert_allreduce_dp1_tp1_ep13 -> layer61_aggregate_dp1_tp1_ep13
	layer61_gate_dp1_tp1_ep14 [label="LAYER61_GATE\nGPU: 254\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp1_ep14 [label="LAYER61_DISPATCH\nGPU: 254\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp1_ep14 [label="LAYER61_EXPERT_MLP\nGPU: 254\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp1_ep14 [label="LAYER61_EXPERT_PROJ\nGPU: 254\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp1_ep14 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 254\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp1_ep14 [label="LAYER61_AGGREGATE\nGPU: 254\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp1 -> layer61_gate_dp1_tp1_ep14 [style=dashed]
	layer61_gate_dp1_tp1_ep14 -> layer61_dispatch_dp1_tp1_ep14 [style=dashed]
	layer61_dispatch_dp1_tp1_ep14 -> layer61_expert_mlp_dp1_tp1_ep14
	layer61_expert_mlp_dp1_tp1_ep14 -> layer61_expert_proj_dp1_tp1_ep14
	layer61_expert_proj_dp1_tp1_ep14 -> layer61_expert_allreduce_dp1_tp1_ep14
	layer61_expert_allreduce_dp1_tp1_ep14 -> layer61_aggregate_dp1_tp1_ep14
	layer61_gate_dp1_tp1_ep15 [label="LAYER61_GATE\nGPU: 255\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, expert_scores=16]" fillcolor=lightgreen shape=parallelogram]
	layer61_dispatch_dp1_tp1_ep15 [label="LAYER61_DISPATCH\nGPU: 255\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [tokens_selected=32, seq=2048, hidden=7168]" fillcolor=lightgreen shape=parallelogram]
	layer61_expert_mlp_dp1_tp1_ep15 [label="LAYER61_EXPERT_MLP\nGPU: 255\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [tokens=32, seq=2048, hidden=9216]" fillcolor=lightblue]
	layer61_expert_proj_dp1_tp1_ep15 [label="LAYER61_EXPERT_PROJ\nGPU: 255\nInput: [tokens=32, seq=2048, hidden=9216]\nOutput: [tokens=32, seq=2048, hidden=3584]" fillcolor=lightblue]
	layer61_expert_allreduce_dp1_tp1_ep15 [label="LAYER61_EXPERT_ALLREDUCE\nGPU: 255\nInput: [tokens=32, seq=2048, hidden=3584]\nOutput: [tokens=32, seq=2048, hidden=7168]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp1_tp1_ep15 [label="LAYER61_AGGREGATE\nGPU: 255\nInput: [tokens=32, seq=2048, hidden=7168]\nOutput: [batch=512, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	layer61_mla_dp1_tp1 -> layer61_gate_dp1_tp1_ep15 [style=dashed]
	layer61_gate_dp1_tp1_ep15 -> layer61_dispatch_dp1_tp1_ep15 [style=dashed]
	layer61_dispatch_dp1_tp1_ep15 -> layer61_expert_mlp_dp1_tp1_ep15
	layer61_expert_mlp_dp1_tp1_ep15 -> layer61_expert_proj_dp1_tp1_ep15
	layer61_expert_proj_dp1_tp1_ep15 -> layer61_expert_allreduce_dp1_tp1_ep15
	layer61_expert_allreduce_dp1_tp1_ep15 -> layer61_aggregate_dp1_tp1_ep15
	output_agg [label="OUTPUT_AGGREGATION\nGPU: OutputController\nInput: [batch=512, seq=2048, hidden=7168]\nOutput: [batch=1024, seq=2048, hidden=7168]" fillcolor=lightpink shape=parallelogram]
	output [label="OUTPUT\nGPU: ALL_DP_RANKS\nInput: [batch=1024, seq=2048, hidden=7168]\nOutput: [batch=1024, seq=2048, vocab=128000]" fillcolor=lightyellow shape=ellipse]
	layer61_aggregate_dp0_tp0_ep0 -> output_agg
	layer61_aggregate_dp0_tp0_ep1 -> output_agg
	layer61_aggregate_dp0_tp0_ep2 -> output_agg
	layer61_aggregate_dp0_tp0_ep3 -> output_agg
	layer61_aggregate_dp0_tp0_ep4 -> output_agg
	layer61_aggregate_dp0_tp0_ep5 -> output_agg
	layer61_aggregate_dp0_tp0_ep6 -> output_agg
	layer61_aggregate_dp0_tp0_ep7 -> output_agg
	layer61_aggregate_dp0_tp0_ep8 -> output_agg
	layer61_aggregate_dp0_tp0_ep9 -> output_agg
	layer61_aggregate_dp0_tp0_ep10 -> output_agg
	layer61_aggregate_dp0_tp0_ep11 -> output_agg
	layer61_aggregate_dp0_tp0_ep12 -> output_agg
	layer61_aggregate_dp0_tp0_ep13 -> output_agg
	layer61_aggregate_dp0_tp0_ep14 -> output_agg
	layer61_aggregate_dp0_tp0_ep15 -> output_agg
	layer61_aggregate_dp0_tp1_ep0 -> output_agg
	layer61_aggregate_dp0_tp1_ep1 -> output_agg
	layer61_aggregate_dp0_tp1_ep2 -> output_agg
	layer61_aggregate_dp0_tp1_ep3 -> output_agg
	layer61_aggregate_dp0_tp1_ep4 -> output_agg
	layer61_aggregate_dp0_tp1_ep5 -> output_agg
	layer61_aggregate_dp0_tp1_ep6 -> output_agg
	layer61_aggregate_dp0_tp1_ep7 -> output_agg
	layer61_aggregate_dp0_tp1_ep8 -> output_agg
	layer61_aggregate_dp0_tp1_ep9 -> output_agg
	layer61_aggregate_dp0_tp1_ep10 -> output_agg
	layer61_aggregate_dp0_tp1_ep11 -> output_agg
	layer61_aggregate_dp0_tp1_ep12 -> output_agg
	layer61_aggregate_dp0_tp1_ep13 -> output_agg
	layer61_aggregate_dp0_tp1_ep14 -> output_agg
	layer61_aggregate_dp0_tp1_ep15 -> output_agg
	layer61_aggregate_dp1_tp0_ep0 -> output_agg
	layer61_aggregate_dp1_tp0_ep1 -> output_agg
	layer61_aggregate_dp1_tp0_ep2 -> output_agg
	layer61_aggregate_dp1_tp0_ep3 -> output_agg
	layer61_aggregate_dp1_tp0_ep4 -> output_agg
	layer61_aggregate_dp1_tp0_ep5 -> output_agg
	layer61_aggregate_dp1_tp0_ep6 -> output_agg
	layer61_aggregate_dp1_tp0_ep7 -> output_agg
	layer61_aggregate_dp1_tp0_ep8 -> output_agg
	layer61_aggregate_dp1_tp0_ep9 -> output_agg
	layer61_aggregate_dp1_tp0_ep10 -> output_agg
	layer61_aggregate_dp1_tp0_ep11 -> output_agg
	layer61_aggregate_dp1_tp0_ep12 -> output_agg
	layer61_aggregate_dp1_tp0_ep13 -> output_agg
	layer61_aggregate_dp1_tp0_ep14 -> output_agg
	layer61_aggregate_dp1_tp0_ep15 -> output_agg
	layer61_aggregate_dp1_tp1_ep0 -> output_agg
	layer61_aggregate_dp1_tp1_ep1 -> output_agg
	layer61_aggregate_dp1_tp1_ep2 -> output_agg
	layer61_aggregate_dp1_tp1_ep3 -> output_agg
	layer61_aggregate_dp1_tp1_ep4 -> output_agg
	layer61_aggregate_dp1_tp1_ep5 -> output_agg
	layer61_aggregate_dp1_tp1_ep6 -> output_agg
	layer61_aggregate_dp1_tp1_ep7 -> output_agg
	layer61_aggregate_dp1_tp1_ep8 -> output_agg
	layer61_aggregate_dp1_tp1_ep9 -> output_agg
	layer61_aggregate_dp1_tp1_ep10 -> output_agg
	layer61_aggregate_dp1_tp1_ep11 -> output_agg
	layer61_aggregate_dp1_tp1_ep12 -> output_agg
	layer61_aggregate_dp1_tp1_ep13 -> output_agg
	layer61_aggregate_dp1_tp1_ep14 -> output_agg
	layer61_aggregate_dp1_tp1_ep15 -> output_agg
	output_agg -> output
}
