<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1100pt" height="2880pt"
 viewBox="0.00 0.00 1099.60 2880.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.09 0.09) rotate(0) translate(4 30613.66)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-30613.66 11686,-30613.66 11686,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer0</title>
<path fill="lightgray" stroke="black" d="M20,-28614.16C20,-28614.16 11659,-28614.16 11659,-28614.16 11665,-28614.16 11671,-28620.16 11671,-28626.16 11671,-28626.16 11671,-30493.5 11671,-30493.5 11671,-30499.5 11665,-30505.5 11659,-30505.5 11659,-30505.5 20,-30505.5 20,-30505.5 14,-30505.5 8,-30499.5 8,-30493.5 8,-30493.5 8,-28626.16 8,-28626.16 8,-28620.16 14,-28614.16 20,-28614.16"/>
<text text-anchor="middle" x="5839.5" y="-30490.3" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer1</title>
<path fill="lightgray" stroke="black" d="M20,-26714.83C20,-26714.83 11659,-26714.83 11659,-26714.83 11665,-26714.83 11671,-26720.83 11671,-26726.83 11671,-26726.83 11671,-28594.16 11671,-28594.16 11671,-28600.16 11665,-28606.16 11659,-28606.16 11659,-28606.16 20,-28606.16 20,-28606.16 14,-28606.16 8,-28600.16 8,-28594.16 8,-28594.16 8,-26726.83 8,-26726.83 8,-26720.83 14,-26714.83 20,-26714.83"/>
<text text-anchor="middle" x="5839.5" y="-28590.96" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer2</title>
<path fill="lightgray" stroke="black" d="M20,-24815.5C20,-24815.5 11659,-24815.5 11659,-24815.5 11665,-24815.5 11671,-24821.5 11671,-24827.5 11671,-24827.5 11671,-26694.83 11671,-26694.83 11671,-26700.83 11665,-26706.83 11659,-26706.83 11659,-26706.83 20,-26706.83 20,-26706.83 14,-26706.83 8,-26700.83 8,-26694.83 8,-26694.83 8,-24827.5 8,-24827.5 8,-24821.5 14,-24815.5 20,-24815.5"/>
<text text-anchor="middle" x="5839.5" y="-26691.63" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer3</title>
<path fill="lightgray" stroke="black" d="M20,-22916.16C20,-22916.16 11659,-22916.16 11659,-22916.16 11665,-22916.16 11671,-22922.16 11671,-22928.16 11671,-22928.16 11671,-24795.5 11671,-24795.5 11671,-24801.5 11665,-24807.5 11659,-24807.5 11659,-24807.5 20,-24807.5 20,-24807.5 14,-24807.5 8,-24801.5 8,-24795.5 8,-24795.5 8,-22928.16 8,-22928.16 8,-22922.16 14,-22916.16 20,-22916.16"/>
<text text-anchor="middle" x="5839.5" y="-24792.3" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer4</title>
<path fill="lightgray" stroke="black" d="M20,-21016.83C20,-21016.83 11659,-21016.83 11659,-21016.83 11665,-21016.83 11671,-21022.83 11671,-21028.83 11671,-21028.83 11671,-22896.16 11671,-22896.16 11671,-22902.16 11665,-22908.16 11659,-22908.16 11659,-22908.16 20,-22908.16 20,-22908.16 14,-22908.16 8,-22902.16 8,-22896.16 8,-22896.16 8,-21028.83 8,-21028.83 8,-21022.83 14,-21016.83 20,-21016.83"/>
<text text-anchor="middle" x="5839.5" y="-22892.96" font-family="Times,serif" font-size="14.00">Layer 4</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer5</title>
<path fill="lightgray" stroke="black" d="M20,-19117.5C20,-19117.5 11659,-19117.5 11659,-19117.5 11665,-19117.5 11671,-19123.5 11671,-19129.5 11671,-19129.5 11671,-20996.83 11671,-20996.83 11671,-21002.83 11665,-21008.83 11659,-21008.83 11659,-21008.83 20,-21008.83 20,-21008.83 14,-21008.83 8,-21002.83 8,-20996.83 8,-20996.83 8,-19129.5 8,-19129.5 8,-19123.5 14,-19117.5 20,-19117.5"/>
<text text-anchor="middle" x="5839.5" y="-20993.63" font-family="Times,serif" font-size="14.00">Layer 5</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer6</title>
<path fill="lightgray" stroke="black" d="M20,-17218.16C20,-17218.16 11659,-17218.16 11659,-17218.16 11665,-17218.16 11671,-17224.16 11671,-17230.16 11671,-17230.16 11671,-19097.5 11671,-19097.5 11671,-19103.5 11665,-19109.5 11659,-19109.5 11659,-19109.5 20,-19109.5 20,-19109.5 14,-19109.5 8,-19103.5 8,-19097.5 8,-19097.5 8,-17230.16 8,-17230.16 8,-17224.16 14,-17218.16 20,-17218.16"/>
<text text-anchor="middle" x="5839.5" y="-19094.3" font-family="Times,serif" font-size="14.00">Layer 6</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer7</title>
<path fill="lightgray" stroke="black" d="M20,-15318.83C20,-15318.83 11659,-15318.83 11659,-15318.83 11665,-15318.83 11671,-15324.83 11671,-15330.83 11671,-15330.83 11671,-17198.16 11671,-17198.16 11671,-17204.16 11665,-17210.16 11659,-17210.16 11659,-17210.16 20,-17210.16 20,-17210.16 14,-17210.16 8,-17204.16 8,-17198.16 8,-17198.16 8,-15330.83 8,-15330.83 8,-15324.83 14,-15318.83 20,-15318.83"/>
<text text-anchor="middle" x="5839.5" y="-17194.96" font-family="Times,serif" font-size="14.00">Layer 7</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer8</title>
<path fill="lightgray" stroke="black" d="M23,-13419.5C23,-13419.5 11662,-13419.5 11662,-13419.5 11668,-13419.5 11674,-13425.5 11674,-13431.5 11674,-13431.5 11674,-15298.83 11674,-15298.83 11674,-15304.83 11668,-15310.83 11662,-15310.83 11662,-15310.83 23,-15310.83 23,-15310.83 17,-15310.83 11,-15304.83 11,-15298.83 11,-15298.83 11,-13431.5 11,-13431.5 11,-13425.5 17,-13419.5 23,-13419.5"/>
<text text-anchor="middle" x="5842.5" y="-15295.63" font-family="Times,serif" font-size="14.00">Layer 8</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_layer9</title>
<path fill="lightgray" stroke="black" d="M20,-11520.16C20,-11520.16 11659,-11520.16 11659,-11520.16 11665,-11520.16 11671,-11526.16 11671,-11532.16 11671,-11532.16 11671,-13399.5 11671,-13399.5 11671,-13405.5 11665,-13411.5 11659,-13411.5 11659,-13411.5 20,-13411.5 20,-13411.5 14,-13411.5 8,-13405.5 8,-13399.5 8,-13399.5 8,-11532.16 8,-11532.16 8,-11526.16 14,-11520.16 20,-11520.16"/>
<text text-anchor="middle" x="5839.5" y="-13396.3" font-family="Times,serif" font-size="14.00">Layer 9</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer10</title>
<path fill="lightgray" stroke="black" d="M20,-9620.83C20,-9620.83 11659,-9620.83 11659,-9620.83 11665,-9620.83 11671,-9626.83 11671,-9632.83 11671,-9632.83 11671,-11500.16 11671,-11500.16 11671,-11506.16 11665,-11512.16 11659,-11512.16 11659,-11512.16 20,-11512.16 20,-11512.16 14,-11512.16 8,-11506.16 8,-11500.16 8,-11500.16 8,-9632.83 8,-9632.83 8,-9626.83 14,-9620.83 20,-9620.83"/>
<text text-anchor="middle" x="5839.5" y="-11496.96" font-family="Times,serif" font-size="14.00">Layer 10</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_layer11</title>
<path fill="lightgray" stroke="black" d="M20,-7721.5C20,-7721.5 11659,-7721.5 11659,-7721.5 11665,-7721.5 11671,-7727.5 11671,-7733.5 11671,-7733.5 11671,-9600.83 11671,-9600.83 11671,-9606.83 11665,-9612.83 11659,-9612.83 11659,-9612.83 20,-9612.83 20,-9612.83 14,-9612.83 8,-9606.83 8,-9600.83 8,-9600.83 8,-7733.5 8,-7733.5 8,-7727.5 14,-7721.5 20,-7721.5"/>
<text text-anchor="middle" x="5839.5" y="-9597.63" font-family="Times,serif" font-size="14.00">Layer 11</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_layer12</title>
<path fill="lightgray" stroke="black" d="M20,-5822.17C20,-5822.17 11659,-5822.17 11659,-5822.17 11665,-5822.17 11671,-5828.17 11671,-5834.17 11671,-5834.17 11671,-7701.5 11671,-7701.5 11671,-7707.5 11665,-7713.5 11659,-7713.5 11659,-7713.5 20,-7713.5 20,-7713.5 14,-7713.5 8,-7707.5 8,-7701.5 8,-7701.5 8,-5834.17 8,-5834.17 8,-5828.17 14,-5822.17 20,-5822.17"/>
<text text-anchor="middle" x="5839.5" y="-7698.3" font-family="Times,serif" font-size="14.00">Layer 12</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_layer13</title>
<path fill="lightgray" stroke="black" d="M20,-3922.83C20,-3922.83 11659,-3922.83 11659,-3922.83 11665,-3922.83 11671,-3928.83 11671,-3934.83 11671,-3934.83 11671,-5802.17 11671,-5802.17 11671,-5808.17 11665,-5814.17 11659,-5814.17 11659,-5814.17 20,-5814.17 20,-5814.17 14,-5814.17 8,-5808.17 8,-5802.17 8,-5802.17 8,-3934.83 8,-3934.83 8,-3928.83 14,-3922.83 20,-3922.83"/>
<text text-anchor="middle" x="5839.5" y="-5798.97" font-family="Times,serif" font-size="14.00">Layer 13</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_layer14</title>
<path fill="lightgray" stroke="black" d="M20,-2023.5C20,-2023.5 11659,-2023.5 11659,-2023.5 11665,-2023.5 11671,-2029.5 11671,-2035.5 11671,-2035.5 11671,-3902.83 11671,-3902.83 11671,-3908.83 11665,-3914.83 11659,-3914.83 11659,-3914.83 20,-3914.83 20,-3914.83 14,-3914.83 8,-3908.83 8,-3902.83 8,-3902.83 8,-2035.5 8,-2035.5 8,-2029.5 14,-2023.5 20,-2023.5"/>
<text text-anchor="middle" x="5839.5" y="-3899.63" font-family="Times,serif" font-size="14.00">Layer 14</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_layer15</title>
<path fill="lightgray" stroke="black" d="M20,-124.17C20,-124.17 11659,-124.17 11659,-124.17 11665,-124.17 11671,-130.17 11671,-136.17 11671,-136.17 11671,-2003.5 11671,-2003.5 11671,-2009.5 11665,-2015.5 11659,-2015.5 11659,-2015.5 20,-2015.5 20,-2015.5 14,-2015.5 8,-2009.5 8,-2003.5 8,-2003.5 8,-136.17 8,-136.17 8,-130.17 14,-124.17 20,-124.17"/>
<text text-anchor="middle" x="5839.5" y="-2000.3" font-family="Times,serif" font-size="14.00">Layer 15</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="5838" cy="-30561.58" rx="287.59" ry="48.17"/>
<text text-anchor="middle" x="5838" y="-30580.38" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="5838" y="-30565.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5838" y="-30550.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5838" y="-30535.38" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer0_layernorm -->
<g id="node2" class="node">
<title>layer0_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="6041.5,-30474.5 5634.5,-30474.5 5634.5,-30406.5 6041.5,-30406.5 6041.5,-30474.5"/>
<text text-anchor="middle" x="5838" y="-30459.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5838" y="-30444.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5838" y="-30429.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5838" y="-30414.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- input&#45;&gt;layer0_layernorm -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_layernorm</title>
<path fill="none" stroke="black" d="M5838,-30513.17C5838,-30503.84 5838,-30494.09 5838,-30484.9"/>
<polygon fill="black" stroke="black" points="5841.5,-30484.81 5838,-30474.81 5834.5,-30484.81 5841.5,-30484.81"/>
</g>
<!-- layer0_qkv_proj -->
<g id="node3" class="node">
<title>layer0_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="6095.5,-30370.5 5580.5,-30370.5 5580.5,-30302.5 6095.5,-30302.5 6095.5,-30370.5"/>
<text text-anchor="middle" x="5838" y="-30355.3" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5838" y="-30340.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5838" y="-30325.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5838" y="-30310.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer0_layernorm&#45;&gt;layer0_qkv_proj -->
<g id="edge2" class="edge">
<title>layer0_layernorm&#45;&gt;layer0_qkv_proj</title>
<path fill="none" stroke="black" d="M5838,-30406.38C5838,-30398.27 5838,-30389.48 5838,-30380.97"/>
<polygon fill="black" stroke="black" points="5841.5,-30380.79 5838,-30370.79 5834.5,-30380.79 5841.5,-30380.79"/>
</g>
<!-- layer0_attention -->
<g id="node4" class="node">
<title>layer0_attention</title>
<polygon fill="lightgreen" stroke="black" points="6089.5,-30266.5 5586.5,-30266.5 5586.5,-30198.5 6089.5,-30198.5 6089.5,-30266.5"/>
<text text-anchor="middle" x="5838" y="-30251.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5838" y="-30236.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5838" y="-30221.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5838" y="-30206.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer0_qkv_proj&#45;&gt;layer0_attention -->
<g id="edge3" class="edge">
<title>layer0_qkv_proj&#45;&gt;layer0_attention</title>
<path fill="none" stroke="black" d="M5838,-30302.38C5838,-30294.27 5838,-30285.48 5838,-30276.97"/>
<polygon fill="black" stroke="black" points="5841.5,-30276.79 5838,-30266.79 5834.5,-30276.79 5841.5,-30276.79"/>
</g>
<!-- layer0_attn_out -->
<g id="node5" class="node">
<title>layer0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="6076.5,-30162.5 5599.5,-30162.5 5599.5,-30094.5 6076.5,-30094.5 6076.5,-30162.5"/>
<text text-anchor="middle" x="5838" y="-30147.3" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5838" y="-30132.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5838" y="-30117.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5838" y="-30102.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer0_attention&#45;&gt;layer0_attn_out -->
<g id="edge4" class="edge">
<title>layer0_attention&#45;&gt;layer0_attn_out</title>
<path fill="none" stroke="black" d="M5838,-30198.38C5838,-30190.27 5838,-30181.48 5838,-30172.97"/>
<polygon fill="black" stroke="black" points="5841.5,-30172.79 5838,-30162.79 5834.5,-30172.79 5841.5,-30172.79"/>
</g>
<!-- layer0_residual1 -->
<g id="node6" class="node">
<title>layer0_residual1</title>
<polygon fill="lightyellow" stroke="black" points="6280.89,-30058.5 5576.35,-30058.5 5395.11,-29922.5 6099.65,-29922.5 6280.89,-30058.5"/>
<text text-anchor="middle" x="5838" y="-30009.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5838" y="-29994.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5838" y="-29979.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5838" y="-29964.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer0_attn_out&#45;&gt;layer0_residual1 -->
<g id="edge5" class="edge">
<title>layer0_attn_out&#45;&gt;layer0_residual1</title>
<path fill="none" stroke="black" d="M5838,-30094.23C5838,-30086.4 5838,-30077.73 5838,-30068.85"/>
<polygon fill="black" stroke="black" points="5841.5,-30068.76 5838,-30058.76 5834.5,-30068.76 5841.5,-30068.76"/>
</g>
<!-- layer0_layernorm2 -->
<g id="node7" class="node">
<title>layer0_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="6041.5,-29886.5 5634.5,-29886.5 5634.5,-29818.5 6041.5,-29818.5 6041.5,-29886.5"/>
<text text-anchor="middle" x="5838" y="-29871.3" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5838" y="-29856.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5838" y="-29841.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5838" y="-29826.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer0_residual1&#45;&gt;layer0_layernorm2 -->
<g id="edge6" class="edge">
<title>layer0_residual1&#45;&gt;layer0_layernorm2</title>
<path fill="none" stroke="black" d="M5838,-29922.29C5838,-29913.54 5838,-29904.77 5838,-29896.56"/>
<polygon fill="black" stroke="black" points="5841.5,-29896.51 5838,-29886.51 5834.5,-29896.51 5841.5,-29896.51"/>
</g>
<!-- layer0_global_gate -->
<g id="node8" class="node">
<title>layer0_global_gate</title>
<polygon fill="lightgreen" stroke="black" points="6035.5,-29782.5 5640.5,-29782.5 5640.5,-29714.5 6035.5,-29714.5 6035.5,-29782.5"/>
<text text-anchor="middle" x="5838" y="-29767.3" font-family="Times,serif" font-size="14.00">Global Gate</text>
<text text-anchor="middle" x="5838" y="-29752.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5838" y="-29737.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, experts=64]</text>
<text text-anchor="middle" x="5838" y="-29722.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer0_layernorm2&#45;&gt;layer0_global_gate -->
<g id="edge7" class="edge">
<title>layer0_layernorm2&#45;&gt;layer0_global_gate</title>
<path fill="none" stroke="black" d="M5838,-29818.38C5838,-29810.27 5838,-29801.48 5838,-29792.97"/>
<polygon fill="black" stroke="black" points="5841.5,-29792.79 5838,-29782.79 5834.5,-29792.79 5841.5,-29792.79"/>
</g>
<!-- layer0_routing -->
<g id="node9" class="node">
<title>layer0_routing</title>
<polygon fill="lightyellow" stroke="black" points="6324.47,-29678.5 5550.6,-29678.5 5351.53,-29542.5 6125.4,-29542.5 6324.47,-29678.5"/>
<text text-anchor="middle" x="5838" y="-29629.3" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="5838" y="-29614.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5838" y="-29599.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5838" y="-29584.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer0_global_gate&#45;&gt;layer0_routing -->
<g id="edge8" class="edge">
<title>layer0_global_gate&#45;&gt;layer0_routing</title>
<path fill="none" stroke="black" d="M5838,-29714.23C5838,-29706.4 5838,-29697.73 5838,-29688.85"/>
<polygon fill="black" stroke="black" points="5841.5,-29688.76 5838,-29678.76 5834.5,-29688.76 5841.5,-29688.76"/>
</g>
<!-- layer0_gpu0_token_recv -->
<g id="node10" class="node">
<title>layer0_gpu0_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="505" cy="-29458.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="505" y="-29477.21" font-family="Times,serif" font-size="14.00">Token Receive GPU0</text>
<text text-anchor="middle" x="505" y="-29462.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="505" y="-29447.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="505" y="-29432.21" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_routing&#45;&gt;layer0_gpu0_token_recv -->
<g id="edge9" class="edge">
<title>layer0_routing&#45;&gt;layer0_gpu0_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5444.74,-29606.42C4435.81,-29597.71 1773.04,-29569.31 891,-29506.5 846.3,-29503.31 798.83,-29498.61 753.03,-29493.4"/>
<polygon fill="black" stroke="black" points="753.31,-29489.91 742.98,-29492.24 752.51,-29496.86 753.31,-29489.91"/>
</g>
<!-- layer0_gpu1_token_recv -->
<g id="node15" class="node">
<title>layer0_gpu1_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1234" cy="-29458.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1234" y="-29477.21" font-family="Times,serif" font-size="14.00">Token Receive GPU1</text>
<text text-anchor="middle" x="1234" y="-29462.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1234" y="-29447.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1234" y="-29432.21" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_routing&#45;&gt;layer0_gpu1_token_recv -->
<g id="edge15" class="edge">
<title>layer0_routing&#45;&gt;layer0_gpu1_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5443.15,-29605.15C4538.74,-29594.36 2338.29,-29563.01 1599,-29506.5 1559.27,-29503.46 1517.24,-29499.11 1476.39,-29494.26"/>
<polygon fill="black" stroke="black" points="1476.65,-29490.77 1466.31,-29493.05 1475.82,-29497.72 1476.65,-29490.77"/>
</g>
<!-- layer0_gpu2_token_recv -->
<g id="node20" class="node">
<title>layer0_gpu2_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1942" cy="-29458.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1942" y="-29477.21" font-family="Times,serif" font-size="14.00">Token Receive GPU2</text>
<text text-anchor="middle" x="1942" y="-29462.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1942" y="-29447.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1942" y="-29432.21" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_routing&#45;&gt;layer0_gpu2_token_recv -->
<g id="edge21" class="edge">
<title>layer0_routing&#45;&gt;layer0_gpu2_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5439.75,-29602.92C4648.27,-29589.02 2902.2,-29554 2304,-29506.5 2265.12,-29503.41 2224.02,-29499.08 2184.01,-29494.3"/>
<polygon fill="black" stroke="black" points="2184.21,-29490.8 2173.86,-29493.07 2183.37,-29497.75 2184.21,-29490.8"/>
</g>
<!-- layer0_gpu3_token_recv -->
<g id="node25" class="node">
<title>layer0_gpu3_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="2647" cy="-29458.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2647" y="-29477.21" font-family="Times,serif" font-size="14.00">Token Receive GPU3</text>
<text text-anchor="middle" x="2647" y="-29462.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="2647" y="-29447.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2647" y="-29432.21" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_routing&#45;&gt;layer0_gpu3_token_recv -->
<g id="edge27" class="edge">
<title>layer0_routing&#45;&gt;layer0_gpu3_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5445.02,-29606.56C4898.54,-29599.88 3878.5,-29578.02 3012,-29506.5 2972.73,-29503.25 2931.21,-29498.84 2890.78,-29494.01"/>
<polygon fill="black" stroke="black" points="2891.16,-29490.53 2880.81,-29492.81 2890.32,-29497.48 2891.16,-29490.53"/>
</g>
<!-- layer0_gpu4_token_recv -->
<g id="node30" class="node">
<title>layer0_gpu4_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="3355" cy="-29458.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="3355" y="-29477.21" font-family="Times,serif" font-size="14.00">Token Receive GPU4</text>
<text text-anchor="middle" x="3355" y="-29462.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="3355" y="-29447.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3355" y="-29432.21" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_routing&#45;&gt;layer0_gpu4_token_recv -->
<g id="edge33" class="edge">
<title>layer0_routing&#45;&gt;layer0_gpu4_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5436.11,-29600.38C5006.6,-29588.24 4306.08,-29561.54 3704,-29506.5 3668.8,-29503.28 3631.7,-29499.11 3595.35,-29494.59"/>
<polygon fill="black" stroke="black" points="3595.48,-29491.08 3585.12,-29493.31 3594.61,-29498.02 3595.48,-29491.08"/>
</g>
<!-- layer0_gpu5_token_recv -->
<g id="node35" class="node">
<title>layer0_gpu5_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4047" cy="-29458.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4047" y="-29477.21" font-family="Times,serif" font-size="14.00">Token Receive GPU5</text>
<text text-anchor="middle" x="4047" y="-29462.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4047" y="-29447.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4047" y="-29432.21" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_routing&#45;&gt;layer0_gpu5_token_recv -->
<g id="edge39" class="edge">
<title>layer0_routing&#45;&gt;layer0_gpu5_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5411.38,-29583.58C5132.64,-29565.33 4760.86,-29538.49 4433,-29506.5 4390.77,-29502.37 4346,-29497.44 4302.5,-29492.34"/>
<polygon fill="black" stroke="black" points="4302.7,-29488.84 4292.36,-29491.14 4301.88,-29495.79 4302.7,-29488.84"/>
</g>
<!-- layer0_gpu6_token_recv -->
<g id="node40" class="node">
<title>layer0_gpu6_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4776" cy="-29458.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4776" y="-29477.21" font-family="Times,serif" font-size="14.00">Token Receive GPU6</text>
<text text-anchor="middle" x="4776" y="-29462.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4776" y="-29447.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4776" y="-29432.21" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_routing&#45;&gt;layer0_gpu6_token_recv -->
<g id="edge45" class="edge">
<title>layer0_routing&#45;&gt;layer0_gpu6_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5363.69,-29542.46C5245.48,-29525.76 5123.47,-29508.52 5021.48,-29494.1"/>
<polygon fill="black" stroke="black" points="5021.75,-29490.61 5011.36,-29492.67 5020.77,-29497.54 5021.75,-29490.61"/>
</g>
<!-- layer0_gpu7_token_recv -->
<g id="node45" class="node">
<title>layer0_gpu7_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="5484" cy="-29458.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="5484" y="-29477.21" font-family="Times,serif" font-size="14.00">Token Receive GPU7</text>
<text text-anchor="middle" x="5484" y="-29462.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5484" y="-29447.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5484" y="-29432.21" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_routing&#45;&gt;layer0_gpu7_token_recv -->
<g id="edge51" class="edge">
<title>layer0_routing&#45;&gt;layer0_gpu7_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5679.9,-29542.46C5652.58,-29530.88 5624.65,-29519.04 5598.76,-29508.06"/>
<polygon fill="black" stroke="black" points="5599.89,-29504.74 5589.32,-29504.06 5597.16,-29511.19 5599.89,-29504.74"/>
</g>
<!-- layer0_gpu8_token_recv -->
<g id="node50" class="node">
<title>layer0_gpu8_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6192" cy="-29458.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6192" y="-29477.21" font-family="Times,serif" font-size="14.00">Token Receive GPU8</text>
<text text-anchor="middle" x="6192" y="-29462.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6192" y="-29447.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6192" y="-29432.21" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_routing&#45;&gt;layer0_gpu8_token_recv -->
<g id="edge57" class="edge">
<title>layer0_routing&#45;&gt;layer0_gpu8_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5996.1,-29542.46C6023.42,-29530.88 6051.35,-29519.04 6077.24,-29508.06"/>
<polygon fill="black" stroke="black" points="6078.84,-29511.19 6086.68,-29504.06 6076.11,-29504.74 6078.84,-29511.19"/>
</g>
<!-- layer0_gpu9_token_recv -->
<g id="node55" class="node">
<title>layer0_gpu9_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6889" cy="-29458.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6889" y="-29477.21" font-family="Times,serif" font-size="14.00">Token Receive GPU9</text>
<text text-anchor="middle" x="6889" y="-29462.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6889" y="-29447.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6889" y="-29432.21" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_routing&#45;&gt;layer0_gpu9_token_recv -->
<g id="edge63" class="edge">
<title>layer0_routing&#45;&gt;layer0_gpu9_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6156.9,-29563.96C6313.67,-29541.57 6499.62,-29515.01 6644.89,-29494.27"/>
<polygon fill="black" stroke="black" points="6645.43,-29497.73 6654.84,-29492.85 6644.44,-29490.8 6645.43,-29497.73"/>
</g>
<!-- layer0_gpu10_token_recv -->
<g id="node60" class="node">
<title>layer0_gpu10_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="7592" cy="-29458.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="7592" y="-29477.21" font-family="Times,serif" font-size="14.00">Token Receive GPU10</text>
<text text-anchor="middle" x="7592" y="-29462.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="7592" y="-29447.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7592" y="-29432.21" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_routing&#45;&gt;layer0_gpu10_token_recv -->
<g id="edge69" class="edge">
<title>layer0_routing&#45;&gt;layer0_gpu10_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6193.36,-29588.77C6475.35,-29570.99 6879.38,-29542.55 7232,-29506.5 7268.41,-29502.77 7306.82,-29498.32 7344.45,-29493.65"/>
<polygon fill="black" stroke="black" points="7345.03,-29497.11 7354.52,-29492.4 7344.16,-29490.16 7345.03,-29497.11"/>
</g>
<!-- layer0_gpu11_token_recv -->
<g id="node65" class="node">
<title>layer0_gpu11_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8339" cy="-29458.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8339" y="-29477.21" font-family="Times,serif" font-size="14.00">Token Receive GPU11</text>
<text text-anchor="middle" x="8339" y="-29462.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8339" y="-29447.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8339" y="-29432.21" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_routing&#45;&gt;layer0_gpu11_token_recv -->
<g id="edge75" class="edge">
<title>layer0_routing&#45;&gt;layer0_gpu11_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6208.3,-29598.8C6627.69,-29584.95 7331.31,-29556.44 7935,-29506.5 7982.57,-29502.56 8033.18,-29497.42 8081.92,-29491.99"/>
<polygon fill="black" stroke="black" points="8082.41,-29495.45 8091.96,-29490.86 8081.63,-29488.5 8082.41,-29495.45"/>
</g>
<!-- layer0_gpu12_token_recv -->
<g id="node70" class="node">
<title>layer0_gpu12_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="9077" cy="-29458.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="9077" y="-29477.21" font-family="Times,serif" font-size="14.00">Token Receive GPU12</text>
<text text-anchor="middle" x="9077" y="-29462.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="9077" y="-29447.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9077" y="-29432.21" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_routing&#45;&gt;layer0_gpu12_token_recv -->
<g id="edge81" class="edge">
<title>layer0_routing&#45;&gt;layer0_gpu12_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6218.08,-29605.68C6764.03,-29597.94 7801.49,-29574.8 8682,-29506.5 8728.04,-29502.92 8776.98,-29498.01 8824.16,-29492.69"/>
<polygon fill="black" stroke="black" points="8824.66,-29496.15 8834.2,-29491.55 8823.87,-29489.2 8824.66,-29496.15"/>
</g>
<!-- layer0_gpu13_token_recv -->
<g id="node75" class="node">
<title>layer0_gpu13_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="9811" cy="-29458.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="9811" y="-29477.21" font-family="Times,serif" font-size="14.00">Token Receive GPU13</text>
<text text-anchor="middle" x="9811" y="-29462.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="9811" y="-29447.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9811" y="-29432.21" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_routing&#45;&gt;layer0_gpu13_token_recv -->
<g id="edge87" class="edge">
<title>layer0_routing&#45;&gt;layer0_gpu13_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6224.22,-29609.9C6881.45,-29608.02 8259.05,-29592.91 9420,-29506.5 9465.42,-29503.11 9513.67,-29498.31 9560.22,-29493.04"/>
<polygon fill="black" stroke="black" points="9560.89,-29496.49 9570.43,-29491.87 9560.1,-29489.53 9560.89,-29496.49"/>
</g>
<!-- layer0_gpu14_token_recv -->
<g id="node80" class="node">
<title>layer0_gpu14_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10542" cy="-29458.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10542" y="-29477.21" font-family="Times,serif" font-size="14.00">Token Receive GPU14</text>
<text text-anchor="middle" x="10542" y="-29462.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10542" y="-29447.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10542" y="-29432.21" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_routing&#45;&gt;layer0_gpu14_token_recv -->
<g id="edge93" class="edge">
<title>layer0_routing&#45;&gt;layer0_gpu14_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6217.14,-29605.17C7123.13,-29594.06 9394.76,-29561.49 10154,-29506.5 10199,-29503.24 10246.81,-29498.49 10292.92,-29493.26"/>
<polygon fill="black" stroke="black" points="10293.5,-29496.71 10303.04,-29492.1 10292.7,-29489.76 10293.5,-29496.71"/>
</g>
<!-- layer0_gpu15_token_recv -->
<g id="node85" class="node">
<title>layer0_gpu15_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="11272" cy="-29458.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="11272" y="-29477.21" font-family="Times,serif" font-size="14.00">Token Receive GPU15</text>
<text text-anchor="middle" x="11272" y="-29462.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="11272" y="-29447.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="11272" y="-29432.21" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_routing&#45;&gt;layer0_gpu15_token_recv -->
<g id="edge99" class="edge">
<title>layer0_routing&#45;&gt;layer0_gpu15_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6219.72,-29606.69C7233.81,-29598.43 9979.38,-29570.66 10885,-29506.5 10929.97,-29503.31 10977.74,-29498.59 11023.81,-29493.36"/>
<polygon fill="black" stroke="black" points="11024.39,-29496.82 11033.92,-29492.2 11023.59,-29489.86 11024.39,-29496.82"/>
</g>
<!-- layer0_gpu0_expert_mlp1 -->
<g id="node11" class="node">
<title>layer0_gpu0_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="725.5,-29374.33 264.5,-29374.33 264.5,-29306.33 725.5,-29306.33 725.5,-29374.33"/>
<text text-anchor="middle" x="495" y="-29359.13" font-family="Times,serif" font-size="14.00">Expert 0 MLP1</text>
<text text-anchor="middle" x="495" y="-29344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="495" y="-29329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="495" y="-29314.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gpu0_token_recv&#45;&gt;layer0_gpu0_expert_mlp1 -->
<g id="edge10" class="edge">
<title>layer0_gpu0_token_recv&#45;&gt;layer0_gpu0_expert_mlp1</title>
<path fill="none" stroke="black" d="M500.93,-29410.2C500.21,-29401.81 499.46,-29393.11 498.75,-29384.84"/>
<polygon fill="black" stroke="black" points="502.21,-29384.3 497.87,-29374.63 495.24,-29384.9 502.21,-29384.3"/>
</g>
<!-- layer0_gpu0_expert_act -->
<g id="node12" class="node">
<title>layer0_gpu0_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="647.5,-29270.33 270.5,-29270.33 270.5,-29202.33 647.5,-29202.33 647.5,-29270.33"/>
<text text-anchor="middle" x="459" y="-29255.13" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="459" y="-29240.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="459" y="-29225.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="459" y="-29210.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gpu0_expert_mlp1&#45;&gt;layer0_gpu0_expert_act -->
<g id="edge11" class="edge">
<title>layer0_gpu0_expert_mlp1&#45;&gt;layer0_gpu0_expert_act</title>
<path fill="none" stroke="black" d="M483.31,-29306.21C480.39,-29297.93 477.21,-29288.92 474.15,-29280.24"/>
<polygon fill="black" stroke="black" points="477.38,-29278.89 470.75,-29270.63 470.78,-29281.22 477.38,-29278.89"/>
</g>
<!-- layer0_gpu0_expert_mlp2 -->
<g id="node13" class="node">
<title>layer0_gpu0_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="627.5,-29166.33 220.5,-29166.33 220.5,-29098.33 627.5,-29098.33 627.5,-29166.33"/>
<text text-anchor="middle" x="424" y="-29151.13" font-family="Times,serif" font-size="14.00">Expert 0 MLP2</text>
<text text-anchor="middle" x="424" y="-29136.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="424" y="-29121.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="424" y="-29106.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gpu0_expert_act&#45;&gt;layer0_gpu0_expert_mlp2 -->
<g id="edge12" class="edge">
<title>layer0_gpu0_expert_act&#45;&gt;layer0_gpu0_expert_mlp2</title>
<path fill="none" stroke="black" d="M447.64,-29202.21C444.79,-29193.93 441.7,-29184.92 438.72,-29176.24"/>
<polygon fill="black" stroke="black" points="441.98,-29174.95 435.43,-29166.63 435.36,-29177.22 441.98,-29174.95"/>
</g>
<!-- layer0_gpu0_token_send -->
<g id="node14" class="node">
<title>layer0_gpu0_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="372" cy="-29014.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="372" y="-29033.05" font-family="Times,serif" font-size="14.00">Token Send GPU0</text>
<text text-anchor="middle" x="372" y="-29018.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="372" y="-29003.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="372" y="-28988.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gpu0_expert_mlp2&#45;&gt;layer0_gpu0_token_send -->
<g id="edge13" class="edge">
<title>layer0_gpu0_expert_mlp2&#45;&gt;layer0_gpu0_token_send</title>
<path fill="none" stroke="black" d="M409.1,-29098.06C405.4,-29089.81 401.34,-29080.73 397.29,-29071.71"/>
<polygon fill="black" stroke="black" points="400.39,-29070.05 393.1,-29062.36 394,-29072.91 400.39,-29070.05"/>
</g>
<!-- layer0_expert_agg -->
<g id="node90" class="node">
<title>layer0_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="6271.05,-28930.16 5551.94,-28930.16 5366.95,-28794.16 6086.06,-28794.16 6271.05,-28930.16"/>
<text text-anchor="middle" x="5819" y="-28880.96" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5819" y="-28865.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x16)</text>
<text text-anchor="middle" x="5819" y="-28850.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5819" y="-28835.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer0_gpu0_token_send&#45;&gt;layer0_expert_agg -->
<g id="edge14" class="edge">
<title>layer0_gpu0_token_send&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M610.99,-28978.58C652.58,-28973.62 695.49,-28969.18 736,-28966.16 1653.49,-28897.73 4447.51,-28872.45 5453.33,-28865.42"/>
<polygon fill="black" stroke="black" points="5453.64,-28868.92 5463.61,-28865.35 5453.59,-28861.92 5453.64,-28868.92"/>
</g>
<!-- layer0_gpu1_expert_mlp1 -->
<g id="node16" class="node">
<title>layer0_gpu1_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="1454.5,-29374.33 993.5,-29374.33 993.5,-29306.33 1454.5,-29306.33 1454.5,-29374.33"/>
<text text-anchor="middle" x="1224" y="-29359.13" font-family="Times,serif" font-size="14.00">Expert 1 MLP1</text>
<text text-anchor="middle" x="1224" y="-29344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1224" y="-29329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1224" y="-29314.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gpu1_token_recv&#45;&gt;layer0_gpu1_expert_mlp1 -->
<g id="edge16" class="edge">
<title>layer0_gpu1_token_recv&#45;&gt;layer0_gpu1_expert_mlp1</title>
<path fill="none" stroke="black" d="M1229.93,-29410.2C1229.21,-29401.81 1228.46,-29393.11 1227.75,-29384.84"/>
<polygon fill="black" stroke="black" points="1231.21,-29384.3 1226.87,-29374.63 1224.24,-29384.9 1231.21,-29384.3"/>
</g>
<!-- layer0_gpu1_expert_act -->
<g id="node17" class="node">
<title>layer0_gpu1_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="1376.5,-29270.33 999.5,-29270.33 999.5,-29202.33 1376.5,-29202.33 1376.5,-29270.33"/>
<text text-anchor="middle" x="1188" y="-29255.13" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1188" y="-29240.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1188" y="-29225.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1188" y="-29210.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gpu1_expert_mlp1&#45;&gt;layer0_gpu1_expert_act -->
<g id="edge17" class="edge">
<title>layer0_gpu1_expert_mlp1&#45;&gt;layer0_gpu1_expert_act</title>
<path fill="none" stroke="black" d="M1212.31,-29306.21C1209.39,-29297.93 1206.21,-29288.92 1203.15,-29280.24"/>
<polygon fill="black" stroke="black" points="1206.38,-29278.89 1199.75,-29270.63 1199.78,-29281.22 1206.38,-29278.89"/>
</g>
<!-- layer0_gpu1_expert_mlp2 -->
<g id="node18" class="node">
<title>layer0_gpu1_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="1356.5,-29166.33 949.5,-29166.33 949.5,-29098.33 1356.5,-29098.33 1356.5,-29166.33"/>
<text text-anchor="middle" x="1153" y="-29151.13" font-family="Times,serif" font-size="14.00">Expert 1 MLP2</text>
<text text-anchor="middle" x="1153" y="-29136.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1153" y="-29121.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1153" y="-29106.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gpu1_expert_act&#45;&gt;layer0_gpu1_expert_mlp2 -->
<g id="edge18" class="edge">
<title>layer0_gpu1_expert_act&#45;&gt;layer0_gpu1_expert_mlp2</title>
<path fill="none" stroke="black" d="M1176.64,-29202.21C1173.79,-29193.93 1170.7,-29184.92 1167.72,-29176.24"/>
<polygon fill="black" stroke="black" points="1170.98,-29174.95 1164.43,-29166.63 1164.36,-29177.22 1170.98,-29174.95"/>
</g>
<!-- layer0_gpu1_token_send -->
<g id="node19" class="node">
<title>layer0_gpu1_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1101" cy="-29014.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1101" y="-29033.05" font-family="Times,serif" font-size="14.00">Token Send GPU1</text>
<text text-anchor="middle" x="1101" y="-29018.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1101" y="-29003.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1101" y="-28988.05" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gpu1_expert_mlp2&#45;&gt;layer0_gpu1_token_send -->
<g id="edge19" class="edge">
<title>layer0_gpu1_expert_mlp2&#45;&gt;layer0_gpu1_token_send</title>
<path fill="none" stroke="black" d="M1138.1,-29098.06C1134.4,-29089.81 1130.34,-29080.73 1126.29,-29071.71"/>
<polygon fill="black" stroke="black" points="1129.39,-29070.05 1122.1,-29062.36 1123,-29072.91 1129.39,-29070.05"/>
</g>
<!-- layer0_gpu1_token_send&#45;&gt;layer0_expert_agg -->
<g id="edge20" class="edge">
<title>layer0_gpu1_token_send&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1340.48,-28978.64C1381.93,-28973.69 1424.65,-28969.24 1465,-28966.16 2236.02,-28907.34 4554.37,-28876.76 5455.34,-28866.84"/>
<polygon fill="black" stroke="black" points="5455.58,-28870.34 5465.54,-28866.73 5455.51,-28863.34 5455.58,-28870.34"/>
</g>
<!-- layer0_gpu2_expert_mlp1 -->
<g id="node21" class="node">
<title>layer0_gpu2_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2141.5,-29374.33 1680.5,-29374.33 1680.5,-29306.33 2141.5,-29306.33 2141.5,-29374.33"/>
<text text-anchor="middle" x="1911" y="-29359.13" font-family="Times,serif" font-size="14.00">Expert 2 MLP1</text>
<text text-anchor="middle" x="1911" y="-29344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1911" y="-29329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1911" y="-29314.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gpu2_token_recv&#45;&gt;layer0_gpu2_expert_mlp1 -->
<g id="edge22" class="edge">
<title>layer0_gpu2_token_recv&#45;&gt;layer0_gpu2_expert_mlp1</title>
<path fill="none" stroke="black" d="M1929.39,-29410.2C1927.13,-29401.72 1924.78,-29392.92 1922.54,-29384.56"/>
<polygon fill="black" stroke="black" points="1925.86,-29383.39 1919.89,-29374.63 1919.09,-29385.2 1925.86,-29383.39"/>
</g>
<!-- layer0_gpu2_expert_act -->
<g id="node22" class="node">
<title>layer0_gpu2_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2066.5,-29270.33 1689.5,-29270.33 1689.5,-29202.33 2066.5,-29202.33 2066.5,-29270.33"/>
<text text-anchor="middle" x="1878" y="-29255.13" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="1878" y="-29240.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1878" y="-29225.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1878" y="-29210.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gpu2_expert_mlp1&#45;&gt;layer0_gpu2_expert_act -->
<g id="edge23" class="edge">
<title>layer0_gpu2_expert_mlp1&#45;&gt;layer0_gpu2_expert_act</title>
<path fill="none" stroke="black" d="M1900.29,-29306.21C1897.61,-29297.93 1894.69,-29288.92 1891.88,-29280.24"/>
<polygon fill="black" stroke="black" points="1895.18,-29279.07 1888.77,-29270.63 1888.52,-29281.22 1895.18,-29279.07"/>
</g>
<!-- layer0_gpu2_expert_mlp2 -->
<g id="node23" class="node">
<title>layer0_gpu2_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2063.5,-29166.33 1656.5,-29166.33 1656.5,-29098.33 2063.5,-29098.33 2063.5,-29166.33"/>
<text text-anchor="middle" x="1860" y="-29151.13" font-family="Times,serif" font-size="14.00">Expert 2 MLP2</text>
<text text-anchor="middle" x="1860" y="-29136.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1860" y="-29121.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1860" y="-29106.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gpu2_expert_act&#45;&gt;layer0_gpu2_expert_mlp2 -->
<g id="edge24" class="edge">
<title>layer0_gpu2_expert_act&#45;&gt;layer0_gpu2_expert_mlp2</title>
<path fill="none" stroke="black" d="M1872.16,-29202.21C1870.71,-29194.02 1869.14,-29185.12 1867.62,-29176.52"/>
<polygon fill="black" stroke="black" points="1871.06,-29175.87 1865.88,-29166.63 1864.17,-29177.08 1871.06,-29175.87"/>
</g>
<!-- layer0_gpu2_token_send -->
<g id="node24" class="node">
<title>layer0_gpu2_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1830" cy="-29014.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1830" y="-29033.05" font-family="Times,serif" font-size="14.00">Token Send GPU2</text>
<text text-anchor="middle" x="1830" y="-29018.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1830" y="-29003.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1830" y="-28988.05" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gpu2_expert_mlp2&#45;&gt;layer0_gpu2_token_send -->
<g id="edge25" class="edge">
<title>layer0_gpu2_expert_mlp2&#45;&gt;layer0_gpu2_token_send</title>
<path fill="none" stroke="black" d="M1851.4,-29098.06C1849.31,-29089.98 1847.02,-29081.11 1844.74,-29072.28"/>
<polygon fill="black" stroke="black" points="1848.07,-29071.16 1842.17,-29062.36 1841.29,-29072.91 1848.07,-29071.16"/>
</g>
<!-- layer0_gpu2_token_send&#45;&gt;layer0_expert_agg -->
<g id="edge26" class="edge">
<title>layer0_gpu2_token_send&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2069.99,-28978.74C2111.28,-28973.8 2153.82,-28969.32 2194,-28966.16 2819.85,-28916.92 4670.45,-28881.89 5457.83,-28868.81"/>
<polygon fill="black" stroke="black" points="5457.96,-28872.31 5467.91,-28868.65 5457.85,-28865.31 5457.96,-28872.31"/>
</g>
<!-- layer0_gpu3_expert_mlp1 -->
<g id="node26" class="node">
<title>layer0_gpu3_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2850.5,-29374.33 2389.5,-29374.33 2389.5,-29306.33 2850.5,-29306.33 2850.5,-29374.33"/>
<text text-anchor="middle" x="2620" y="-29359.13" font-family="Times,serif" font-size="14.00">Expert 3 MLP1</text>
<text text-anchor="middle" x="2620" y="-29344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2620" y="-29329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2620" y="-29314.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gpu3_token_recv&#45;&gt;layer0_gpu3_expert_mlp1 -->
<g id="edge28" class="edge">
<title>layer0_gpu3_token_recv&#45;&gt;layer0_gpu3_expert_mlp1</title>
<path fill="none" stroke="black" d="M2636.02,-29410.2C2634.05,-29401.72 2632,-29392.92 2630.06,-29384.56"/>
<polygon fill="black" stroke="black" points="2633.42,-29383.58 2627.75,-29374.63 2626.6,-29385.17 2633.42,-29383.58"/>
</g>
<!-- layer0_gpu3_expert_act -->
<g id="node27" class="node">
<title>layer0_gpu3_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2791.5,-29270.33 2414.5,-29270.33 2414.5,-29202.33 2791.5,-29202.33 2791.5,-29270.33"/>
<text text-anchor="middle" x="2603" y="-29255.13" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="2603" y="-29240.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2603" y="-29225.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2603" y="-29210.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gpu3_expert_mlp1&#45;&gt;layer0_gpu3_expert_act -->
<g id="edge29" class="edge">
<title>layer0_gpu3_expert_mlp1&#45;&gt;layer0_gpu3_expert_act</title>
<path fill="none" stroke="black" d="M2614.48,-29306.21C2613.11,-29298.02 2611.63,-29289.12 2610.2,-29280.52"/>
<polygon fill="black" stroke="black" points="2613.65,-29279.92 2608.55,-29270.63 2606.74,-29281.07 2613.65,-29279.92"/>
</g>
<!-- layer0_gpu3_expert_mlp2 -->
<g id="node28" class="node">
<title>layer0_gpu3_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2790.5,-29166.33 2383.5,-29166.33 2383.5,-29098.33 2790.5,-29098.33 2790.5,-29166.33"/>
<text text-anchor="middle" x="2587" y="-29151.13" font-family="Times,serif" font-size="14.00">Expert 3 MLP2</text>
<text text-anchor="middle" x="2587" y="-29136.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2587" y="-29121.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="2587" y="-29106.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gpu3_expert_act&#45;&gt;layer0_gpu3_expert_mlp2 -->
<g id="edge30" class="edge">
<title>layer0_gpu3_expert_act&#45;&gt;layer0_gpu3_expert_mlp2</title>
<path fill="none" stroke="black" d="M2597.81,-29202.21C2596.52,-29194.02 2595.12,-29185.12 2593.78,-29176.52"/>
<polygon fill="black" stroke="black" points="2597.23,-29175.96 2592.22,-29166.63 2590.32,-29177.05 2597.23,-29175.96"/>
</g>
<!-- layer0_gpu3_token_send -->
<g id="node29" class="node">
<title>layer0_gpu3_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="2559" cy="-29014.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="2559" y="-29033.05" font-family="Times,serif" font-size="14.00">Token Send GPU3</text>
<text text-anchor="middle" x="2559" y="-29018.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="2559" y="-29003.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="2559" y="-28988.05" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gpu3_expert_mlp2&#45;&gt;layer0_gpu3_token_send -->
<g id="edge31" class="edge">
<title>layer0_gpu3_expert_mlp2&#45;&gt;layer0_gpu3_token_send</title>
<path fill="none" stroke="black" d="M2578.98,-29098.06C2577.03,-29089.98 2574.89,-29081.11 2572.76,-29072.28"/>
<polygon fill="black" stroke="black" points="2576.11,-29071.26 2570.36,-29062.36 2569.31,-29072.9 2576.11,-29071.26"/>
</g>
<!-- layer0_gpu3_token_send&#45;&gt;layer0_expert_agg -->
<g id="edge32" class="edge">
<title>layer0_gpu3_token_send&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2799.99,-28978.87C2840.97,-28973.94 2883.15,-28969.44 2923,-28966.16 3830.92,-28891.46 4903.34,-28870.9 5453.32,-28865.27"/>
<polygon fill="black" stroke="black" points="5453.43,-28868.77 5463.39,-28865.17 5453.36,-28861.77 5453.43,-28868.77"/>
</g>
<!-- layer0_gpu4_expert_mlp1 -->
<g id="node31" class="node">
<title>layer0_gpu4_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="3567.5,-29374.33 3106.5,-29374.33 3106.5,-29306.33 3567.5,-29306.33 3567.5,-29374.33"/>
<text text-anchor="middle" x="3337" y="-29359.13" font-family="Times,serif" font-size="14.00">Expert 4 MLP1</text>
<text text-anchor="middle" x="3337" y="-29344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3337" y="-29329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3337" y="-29314.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gpu4_token_recv&#45;&gt;layer0_gpu4_expert_mlp1 -->
<g id="edge34" class="edge">
<title>layer0_gpu4_token_recv&#45;&gt;layer0_gpu4_expert_mlp1</title>
<path fill="none" stroke="black" d="M3347.68,-29410.2C3346.36,-29401.72 3345,-29392.92 3343.7,-29384.56"/>
<polygon fill="black" stroke="black" points="3347.16,-29383.98 3342.16,-29374.63 3340.24,-29385.05 3347.16,-29383.98"/>
</g>
<!-- layer0_gpu4_expert_act -->
<g id="node32" class="node">
<title>layer0_gpu4_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="3491.5,-29270.33 3114.5,-29270.33 3114.5,-29202.33 3491.5,-29202.33 3491.5,-29270.33"/>
<text text-anchor="middle" x="3303" y="-29255.13" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="3303" y="-29240.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3303" y="-29225.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3303" y="-29210.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gpu4_expert_mlp1&#45;&gt;layer0_gpu4_expert_act -->
<g id="edge35" class="edge">
<title>layer0_gpu4_expert_mlp1&#45;&gt;layer0_gpu4_expert_act</title>
<path fill="none" stroke="black" d="M3325.96,-29306.21C3323.2,-29297.93 3320.2,-29288.92 3317.3,-29280.24"/>
<polygon fill="black" stroke="black" points="3320.58,-29279.01 3314.1,-29270.63 3313.94,-29281.22 3320.58,-29279.01"/>
</g>
<!-- layer0_gpu4_expert_mlp2 -->
<g id="node33" class="node">
<title>layer0_gpu4_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="3501.5,-29166.33 3094.5,-29166.33 3094.5,-29098.33 3501.5,-29098.33 3501.5,-29166.33"/>
<text text-anchor="middle" x="3298" y="-29151.13" font-family="Times,serif" font-size="14.00">Expert 4 MLP2</text>
<text text-anchor="middle" x="3298" y="-29136.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3298" y="-29121.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="3298" y="-29106.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gpu4_expert_act&#45;&gt;layer0_gpu4_expert_mlp2 -->
<g id="edge36" class="edge">
<title>layer0_gpu4_expert_act&#45;&gt;layer0_gpu4_expert_mlp2</title>
<path fill="none" stroke="black" d="M3301.38,-29202.21C3300.98,-29194.11 3300.55,-29185.31 3300.13,-29176.8"/>
<polygon fill="black" stroke="black" points="3303.62,-29176.44 3299.63,-29166.63 3296.63,-29176.79 3303.62,-29176.44"/>
</g>
<!-- layer0_gpu4_token_send -->
<g id="node34" class="node">
<title>layer0_gpu4_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="3288" cy="-29014.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="3288" y="-29033.05" font-family="Times,serif" font-size="14.00">Token Send GPU4</text>
<text text-anchor="middle" x="3288" y="-29018.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="3288" y="-29003.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="3288" y="-28988.05" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gpu4_expert_mlp2&#45;&gt;layer0_gpu4_token_send -->
<g id="edge37" class="edge">
<title>layer0_gpu4_expert_mlp2&#45;&gt;layer0_gpu4_token_send</title>
<path fill="none" stroke="black" d="M3295.13,-29098.06C3294.45,-29090.07 3293.69,-29081.3 3292.94,-29072.56"/>
<polygon fill="black" stroke="black" points="3296.4,-29072.02 3292.06,-29062.36 3289.43,-29072.62 3296.4,-29072.02"/>
</g>
<!-- layer0_gpu4_token_send&#45;&gt;layer0_expert_agg -->
<g id="edge38" class="edge">
<title>layer0_gpu4_token_send&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3530.98,-28979.04C3571.34,-28974.15 3612.8,-28969.62 3652,-28966.16 4287.62,-28910.04 5031,-28883.09 5461.15,-28871.28"/>
<polygon fill="black" stroke="black" points="5461.35,-28874.78 5471.25,-28871 5461.16,-28867.78 5461.35,-28874.78"/>
</g>
<!-- layer0_gpu5_expert_mlp1 -->
<g id="node36" class="node">
<title>layer0_gpu5_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4269.5,-29374.33 3808.5,-29374.33 3808.5,-29306.33 4269.5,-29306.33 4269.5,-29374.33"/>
<text text-anchor="middle" x="4039" y="-29359.13" font-family="Times,serif" font-size="14.00">Expert 5 MLP1</text>
<text text-anchor="middle" x="4039" y="-29344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4039" y="-29329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4039" y="-29314.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gpu5_token_recv&#45;&gt;layer0_gpu5_expert_mlp1 -->
<g id="edge40" class="edge">
<title>layer0_gpu5_token_recv&#45;&gt;layer0_gpu5_expert_mlp1</title>
<path fill="none" stroke="black" d="M4043.75,-29410.2C4043.17,-29401.81 4042.57,-29393.11 4042,-29384.84"/>
<polygon fill="black" stroke="black" points="4045.47,-29384.37 4041.3,-29374.63 4038.49,-29384.85 4045.47,-29384.37"/>
</g>
<!-- layer0_gpu5_expert_act -->
<g id="node37" class="node">
<title>layer0_gpu5_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4214.5,-29270.33 3837.5,-29270.33 3837.5,-29202.33 4214.5,-29202.33 4214.5,-29270.33"/>
<text text-anchor="middle" x="4026" y="-29255.13" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="4026" y="-29240.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4026" y="-29225.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4026" y="-29210.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gpu5_expert_mlp1&#45;&gt;layer0_gpu5_expert_act -->
<g id="edge41" class="edge">
<title>layer0_gpu5_expert_mlp1&#45;&gt;layer0_gpu5_expert_act</title>
<path fill="none" stroke="black" d="M4034.78,-29306.21C4033.75,-29298.11 4032.63,-29289.31 4031.54,-29280.8"/>
<polygon fill="black" stroke="black" points="4034.98,-29280.11 4030.24,-29270.63 4028.04,-29280.99 4034.98,-29280.11"/>
</g>
<!-- layer0_gpu5_expert_mlp2 -->
<g id="node38" class="node">
<title>layer0_gpu5_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4224.5,-29166.33 3817.5,-29166.33 3817.5,-29098.33 4224.5,-29098.33 4224.5,-29166.33"/>
<text text-anchor="middle" x="4021" y="-29151.13" font-family="Times,serif" font-size="14.00">Expert 5 MLP2</text>
<text text-anchor="middle" x="4021" y="-29136.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4021" y="-29121.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4021" y="-29106.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gpu5_expert_act&#45;&gt;layer0_gpu5_expert_mlp2 -->
<g id="edge42" class="edge">
<title>layer0_gpu5_expert_act&#45;&gt;layer0_gpu5_expert_mlp2</title>
<path fill="none" stroke="black" d="M4024.38,-29202.21C4023.98,-29194.11 4023.55,-29185.31 4023.13,-29176.8"/>
<polygon fill="black" stroke="black" points="4026.62,-29176.44 4022.63,-29166.63 4019.63,-29176.79 4026.62,-29176.44"/>
</g>
<!-- layer0_gpu5_token_send -->
<g id="node39" class="node">
<title>layer0_gpu5_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4017" cy="-29014.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4017" y="-29033.05" font-family="Times,serif" font-size="14.00">Token Send GPU5</text>
<text text-anchor="middle" x="4017" y="-29018.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4017" y="-29003.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4017" y="-28988.05" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gpu5_expert_mlp2&#45;&gt;layer0_gpu5_token_send -->
<g id="edge43" class="edge">
<title>layer0_gpu5_expert_mlp2&#45;&gt;layer0_gpu5_token_send</title>
<path fill="none" stroke="black" d="M4019.85,-29098.06C4019.58,-29090.07 4019.28,-29081.3 4018.97,-29072.56"/>
<polygon fill="black" stroke="black" points="4022.47,-29072.23 4018.62,-29062.36 4015.47,-29072.47 4022.47,-29072.23"/>
</g>
<!-- layer0_gpu5_token_send&#45;&gt;layer0_expert_agg -->
<g id="edge44" class="edge">
<title>layer0_gpu5_token_send&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4263,-28979.49C4302.42,-28974.64 4342.8,-28970 4381,-28966.16 4754.49,-28928.66 5183.89,-28899.75 5475.51,-28882.23"/>
<polygon fill="black" stroke="black" points="5476.06,-28885.71 5485.83,-28881.62 5475.64,-28878.72 5476.06,-28885.71"/>
</g>
<!-- layer0_gpu6_expert_mlp1 -->
<g id="node41" class="node">
<title>layer0_gpu6_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4992.5,-29374.33 4531.5,-29374.33 4531.5,-29306.33 4992.5,-29306.33 4992.5,-29374.33"/>
<text text-anchor="middle" x="4762" y="-29359.13" font-family="Times,serif" font-size="14.00">Expert 6 MLP1</text>
<text text-anchor="middle" x="4762" y="-29344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4762" y="-29329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4762" y="-29314.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gpu6_token_recv&#45;&gt;layer0_gpu6_expert_mlp1 -->
<g id="edge46" class="edge">
<title>layer0_gpu6_token_recv&#45;&gt;layer0_gpu6_expert_mlp1</title>
<path fill="none" stroke="black" d="M4770.31,-29410.2C4769.29,-29401.81 4768.25,-29393.11 4767.25,-29384.84"/>
<polygon fill="black" stroke="black" points="4770.69,-29384.14 4766.02,-29374.63 4763.74,-29384.98 4770.69,-29384.14"/>
</g>
<!-- layer0_gpu6_expert_act -->
<g id="node42" class="node">
<title>layer0_gpu6_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4946.5,-29270.33 4569.5,-29270.33 4569.5,-29202.33 4946.5,-29202.33 4946.5,-29270.33"/>
<text text-anchor="middle" x="4758" y="-29255.13" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="4758" y="-29240.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4758" y="-29225.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4758" y="-29210.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gpu6_expert_mlp1&#45;&gt;layer0_gpu6_expert_act -->
<g id="edge47" class="edge">
<title>layer0_gpu6_expert_mlp1&#45;&gt;layer0_gpu6_expert_act</title>
<path fill="none" stroke="black" d="M4760.7,-29306.21C4760.38,-29298.11 4760.04,-29289.31 4759.7,-29280.8"/>
<polygon fill="black" stroke="black" points="4763.2,-29280.48 4759.31,-29270.63 4756.2,-29280.76 4763.2,-29280.48"/>
</g>
<!-- layer0_gpu6_expert_mlp2 -->
<g id="node43" class="node">
<title>layer0_gpu6_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4957.5,-29166.33 4550.5,-29166.33 4550.5,-29098.33 4957.5,-29098.33 4957.5,-29166.33"/>
<text text-anchor="middle" x="4754" y="-29151.13" font-family="Times,serif" font-size="14.00">Expert 6 MLP2</text>
<text text-anchor="middle" x="4754" y="-29136.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4754" y="-29121.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4754" y="-29106.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gpu6_expert_act&#45;&gt;layer0_gpu6_expert_mlp2 -->
<g id="edge48" class="edge">
<title>layer0_gpu6_expert_act&#45;&gt;layer0_gpu6_expert_mlp2</title>
<path fill="none" stroke="black" d="M4756.7,-29202.21C4756.38,-29194.11 4756.04,-29185.31 4755.7,-29176.8"/>
<polygon fill="black" stroke="black" points="4759.2,-29176.48 4755.31,-29166.63 4752.2,-29176.76 4759.2,-29176.48"/>
</g>
<!-- layer0_gpu6_token_send -->
<g id="node44" class="node">
<title>layer0_gpu6_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4746" cy="-29014.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4746" y="-29033.05" font-family="Times,serif" font-size="14.00">Token Send GPU6</text>
<text text-anchor="middle" x="4746" y="-29018.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4746" y="-29003.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4746" y="-28988.05" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gpu6_expert_mlp2&#45;&gt;layer0_gpu6_token_send -->
<g id="edge49" class="edge">
<title>layer0_gpu6_expert_mlp2&#45;&gt;layer0_gpu6_token_send</title>
<path fill="none" stroke="black" d="M4751.71,-29098.06C4751.16,-29090.07 4750.55,-29081.3 4749.95,-29072.56"/>
<polygon fill="black" stroke="black" points="4753.43,-29072.09 4749.25,-29062.36 4746.44,-29072.57 4753.43,-29072.09"/>
</g>
<!-- layer0_gpu6_token_send&#45;&gt;layer0_expert_agg -->
<g id="edge50" class="edge">
<title>layer0_gpu6_token_send&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4989.48,-28979.19C5143.01,-28957.71 5342.72,-28929.78 5507.71,-28906.7"/>
<polygon fill="black" stroke="black" points="5508.61,-28910.11 5518.03,-28905.26 5507.64,-28903.18 5508.61,-28910.11"/>
</g>
<!-- layer0_gpu7_expert_mlp1 -->
<g id="node46" class="node">
<title>layer0_gpu7_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5709.5,-29374.33 5248.5,-29374.33 5248.5,-29306.33 5709.5,-29306.33 5709.5,-29374.33"/>
<text text-anchor="middle" x="5479" y="-29359.13" font-family="Times,serif" font-size="14.00">Expert 7 MLP1</text>
<text text-anchor="middle" x="5479" y="-29344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5479" y="-29329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5479" y="-29314.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gpu7_token_recv&#45;&gt;layer0_gpu7_expert_mlp1 -->
<g id="edge52" class="edge">
<title>layer0_gpu7_token_recv&#45;&gt;layer0_gpu7_expert_mlp1</title>
<path fill="none" stroke="black" d="M5481.97,-29410.2C5481.61,-29401.81 5481.23,-29393.11 5480.87,-29384.84"/>
<polygon fill="black" stroke="black" points="5484.36,-29384.47 5480.43,-29374.63 5477.37,-29384.77 5484.36,-29384.47"/>
</g>
<!-- layer0_gpu7_expert_act -->
<g id="node47" class="node">
<title>layer0_gpu7_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="5664.5,-29270.33 5287.5,-29270.33 5287.5,-29202.33 5664.5,-29202.33 5664.5,-29270.33"/>
<text text-anchor="middle" x="5476" y="-29255.13" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="5476" y="-29240.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5476" y="-29225.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5476" y="-29210.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gpu7_expert_mlp1&#45;&gt;layer0_gpu7_expert_act -->
<g id="edge53" class="edge">
<title>layer0_gpu7_expert_mlp1&#45;&gt;layer0_gpu7_expert_act</title>
<path fill="none" stroke="black" d="M5478.03,-29306.21C5477.79,-29298.11 5477.53,-29289.31 5477.28,-29280.8"/>
<polygon fill="black" stroke="black" points="5480.77,-29280.52 5476.98,-29270.63 5473.77,-29280.73 5480.77,-29280.52"/>
</g>
<!-- layer0_gpu7_expert_mlp2 -->
<g id="node48" class="node">
<title>layer0_gpu7_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="5679.5,-29166.33 5272.5,-29166.33 5272.5,-29098.33 5679.5,-29098.33 5679.5,-29166.33"/>
<text text-anchor="middle" x="5476" y="-29151.13" font-family="Times,serif" font-size="14.00">Expert 7 MLP2</text>
<text text-anchor="middle" x="5476" y="-29136.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5476" y="-29121.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-29106.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gpu7_expert_act&#45;&gt;layer0_gpu7_expert_mlp2 -->
<g id="edge54" class="edge">
<title>layer0_gpu7_expert_act&#45;&gt;layer0_gpu7_expert_mlp2</title>
<path fill="none" stroke="black" d="M5476,-29202.21C5476,-29194.11 5476,-29185.31 5476,-29176.8"/>
<polygon fill="black" stroke="black" points="5479.5,-29176.63 5476,-29166.63 5472.5,-29176.63 5479.5,-29176.63"/>
</g>
<!-- layer0_gpu7_token_send -->
<g id="node49" class="node">
<title>layer0_gpu7_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="5475" cy="-29014.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="5475" y="-29033.05" font-family="Times,serif" font-size="14.00">Token Send GPU7</text>
<text text-anchor="middle" x="5475" y="-29018.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="5475" y="-29003.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="5475" y="-28988.05" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gpu7_expert_mlp2&#45;&gt;layer0_gpu7_token_send -->
<g id="edge55" class="edge">
<title>layer0_gpu7_expert_mlp2&#45;&gt;layer0_gpu7_token_send</title>
<path fill="none" stroke="black" d="M5475.71,-29098.06C5475.64,-29090.07 5475.57,-29081.3 5475.49,-29072.56"/>
<polygon fill="black" stroke="black" points="5478.99,-29072.32 5475.41,-29062.36 5471.99,-29072.38 5478.99,-29072.32"/>
</g>
<!-- layer0_gpu7_token_send&#45;&gt;layer0_expert_agg -->
<g id="edge56" class="edge">
<title>layer0_gpu7_token_send&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M5578.21,-28968.22C5602.73,-28957.52 5629.48,-28945.85 5655.95,-28934.3"/>
<polygon fill="black" stroke="black" points="5657.53,-28937.43 5665.3,-28930.22 5654.73,-28931.01 5657.53,-28937.43"/>
</g>
<!-- layer0_gpu8_expert_mlp1 -->
<g id="node51" class="node">
<title>layer0_gpu8_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="6423.5,-29374.33 5962.5,-29374.33 5962.5,-29306.33 6423.5,-29306.33 6423.5,-29374.33"/>
<text text-anchor="middle" x="6193" y="-29359.13" font-family="Times,serif" font-size="14.00">Expert 8 MLP1</text>
<text text-anchor="middle" x="6193" y="-29344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6193" y="-29329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6193" y="-29314.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_gpu8_token_recv&#45;&gt;layer0_gpu8_expert_mlp1 -->
<g id="edge58" class="edge">
<title>layer0_gpu8_token_recv&#45;&gt;layer0_gpu8_expert_mlp1</title>
<path fill="none" stroke="black" d="M6192.41,-29410.2C6192.48,-29401.81 6192.55,-29393.11 6192.63,-29384.84"/>
<polygon fill="black" stroke="black" points="6196.13,-29384.66 6192.71,-29374.63 6189.13,-29384.6 6196.13,-29384.66"/>
</g>
<!-- layer0_gpu8_expert_act -->
<g id="node52" class="node">
<title>layer0_gpu8_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="6384.5,-29270.33 6007.5,-29270.33 6007.5,-29202.33 6384.5,-29202.33 6384.5,-29270.33"/>
<text text-anchor="middle" x="6196" y="-29255.13" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="6196" y="-29240.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6196" y="-29225.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6196" y="-29210.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_gpu8_expert_mlp1&#45;&gt;layer0_gpu8_expert_act -->
<g id="edge59" class="edge">
<title>layer0_gpu8_expert_mlp1&#45;&gt;layer0_gpu8_expert_act</title>
<path fill="none" stroke="black" d="M6193.97,-29306.21C6194.21,-29298.11 6194.47,-29289.31 6194.72,-29280.8"/>
<polygon fill="black" stroke="black" points="6198.23,-29280.73 6195.02,-29270.63 6191.23,-29280.52 6198.23,-29280.73"/>
</g>
<!-- layer0_gpu8_expert_mlp2 -->
<g id="node53" class="node">
<title>layer0_gpu8_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="6401.5,-29166.33 5994.5,-29166.33 5994.5,-29098.33 6401.5,-29098.33 6401.5,-29166.33"/>
<text text-anchor="middle" x="6198" y="-29151.13" font-family="Times,serif" font-size="14.00">Expert 8 MLP2</text>
<text text-anchor="middle" x="6198" y="-29136.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6198" y="-29121.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6198" y="-29106.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_gpu8_expert_act&#45;&gt;layer0_gpu8_expert_mlp2 -->
<g id="edge60" class="edge">
<title>layer0_gpu8_expert_act&#45;&gt;layer0_gpu8_expert_mlp2</title>
<path fill="none" stroke="black" d="M6196.65,-29202.21C6196.81,-29194.11 6196.98,-29185.31 6197.15,-29176.8"/>
<polygon fill="black" stroke="black" points="6200.65,-29176.69 6197.35,-29166.63 6193.65,-29176.56 6200.65,-29176.69"/>
</g>
<!-- layer0_gpu8_token_send -->
<g id="node54" class="node">
<title>layer0_gpu8_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6204" cy="-29014.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6204" y="-29033.05" font-family="Times,serif" font-size="14.00">Token Send GPU8</text>
<text text-anchor="middle" x="6204" y="-29018.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6204" y="-29003.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6204" y="-28988.05" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_gpu8_expert_mlp2&#45;&gt;layer0_gpu8_token_send -->
<g id="edge61" class="edge">
<title>layer0_gpu8_expert_mlp2&#45;&gt;layer0_gpu8_token_send</title>
<path fill="none" stroke="black" d="M6199.72,-29098.06C6200.13,-29090.07 6200.59,-29081.3 6201.04,-29072.56"/>
<polygon fill="black" stroke="black" points="6204.54,-29072.52 6201.57,-29062.36 6197.55,-29072.16 6204.54,-29072.52"/>
</g>
<!-- layer0_gpu8_token_send&#45;&gt;layer0_expert_agg -->
<g id="edge62" class="edge">
<title>layer0_gpu8_token_send&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M6089.53,-28968.62C6061.51,-28957.7 6030.83,-28945.74 6000.52,-28933.92"/>
<polygon fill="black" stroke="black" points="6001.71,-28930.63 5991.12,-28930.26 5999.17,-28937.15 6001.71,-28930.63"/>
</g>
<!-- layer0_gpu9_expert_mlp1 -->
<g id="node56" class="node">
<title>layer0_gpu9_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7120.5,-29374.33 6659.5,-29374.33 6659.5,-29306.33 7120.5,-29306.33 7120.5,-29374.33"/>
<text text-anchor="middle" x="6890" y="-29359.13" font-family="Times,serif" font-size="14.00">Expert 9 MLP1</text>
<text text-anchor="middle" x="6890" y="-29344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6890" y="-29329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6890" y="-29314.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_gpu9_token_recv&#45;&gt;layer0_gpu9_expert_mlp1 -->
<g id="edge64" class="edge">
<title>layer0_gpu9_token_recv&#45;&gt;layer0_gpu9_expert_mlp1</title>
<path fill="none" stroke="black" d="M6889.41,-29410.2C6889.48,-29401.81 6889.55,-29393.11 6889.63,-29384.84"/>
<polygon fill="black" stroke="black" points="6893.13,-29384.66 6889.71,-29374.63 6886.13,-29384.6 6893.13,-29384.66"/>
</g>
<!-- layer0_gpu9_expert_act -->
<g id="node57" class="node">
<title>layer0_gpu9_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7120.5,-29270.33 6743.5,-29270.33 6743.5,-29202.33 7120.5,-29202.33 7120.5,-29270.33"/>
<text text-anchor="middle" x="6932" y="-29255.13" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="6932" y="-29240.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6932" y="-29225.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6932" y="-29210.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_gpu9_expert_mlp1&#45;&gt;layer0_gpu9_expert_act -->
<g id="edge65" class="edge">
<title>layer0_gpu9_expert_mlp1&#45;&gt;layer0_gpu9_expert_act</title>
<path fill="none" stroke="black" d="M6903.64,-29306.21C6907.08,-29297.84 6910.83,-29288.73 6914.45,-29279.96"/>
<polygon fill="black" stroke="black" points="6917.72,-29281.21 6918.29,-29270.63 6911.24,-29278.54 6917.72,-29281.21"/>
</g>
<!-- layer0_gpu9_expert_mlp2 -->
<g id="node58" class="node">
<title>layer0_gpu9_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7135.5,-29166.33 6728.5,-29166.33 6728.5,-29098.33 7135.5,-29098.33 7135.5,-29166.33"/>
<text text-anchor="middle" x="6932" y="-29151.13" font-family="Times,serif" font-size="14.00">Expert 9 MLP2</text>
<text text-anchor="middle" x="6932" y="-29136.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6932" y="-29121.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6932" y="-29106.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_gpu9_expert_act&#45;&gt;layer0_gpu9_expert_mlp2 -->
<g id="edge66" class="edge">
<title>layer0_gpu9_expert_act&#45;&gt;layer0_gpu9_expert_mlp2</title>
<path fill="none" stroke="black" d="M6932,-29202.21C6932,-29194.11 6932,-29185.31 6932,-29176.8"/>
<polygon fill="black" stroke="black" points="6935.5,-29176.63 6932,-29166.63 6928.5,-29176.63 6935.5,-29176.63"/>
</g>
<!-- layer0_gpu9_token_send -->
<g id="node59" class="node">
<title>layer0_gpu9_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6933" cy="-29014.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6933" y="-29033.05" font-family="Times,serif" font-size="14.00">Token Send GPU9</text>
<text text-anchor="middle" x="6933" y="-29018.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6933" y="-29003.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6933" y="-28988.05" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_gpu9_expert_mlp2&#45;&gt;layer0_gpu9_token_send -->
<g id="edge67" class="edge">
<title>layer0_gpu9_expert_mlp2&#45;&gt;layer0_gpu9_token_send</title>
<path fill="none" stroke="black" d="M6932.29,-29098.06C6932.36,-29090.07 6932.43,-29081.3 6932.51,-29072.56"/>
<polygon fill="black" stroke="black" points="6936.01,-29072.38 6932.59,-29062.36 6929.01,-29072.32 6936.01,-29072.38"/>
</g>
<!-- layer0_gpu9_token_send&#45;&gt;layer0_expert_agg -->
<g id="edge68" class="edge">
<title>layer0_gpu9_token_send&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M6684.73,-28979.8C6562.94,-28963.39 6412.37,-28943.1 6271.13,-28924.08"/>
<polygon fill="black" stroke="black" points="6271.35,-28920.57 6260.98,-28922.71 6270.42,-28927.51 6271.35,-28920.57"/>
</g>
<!-- layer0_gpu10_expert_mlp1 -->
<g id="node61" class="node">
<title>layer0_gpu10_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7885.5,-29374.33 7424.5,-29374.33 7424.5,-29306.33 7885.5,-29306.33 7885.5,-29374.33"/>
<text text-anchor="middle" x="7655" y="-29359.13" font-family="Times,serif" font-size="14.00">Expert 10 MLP1</text>
<text text-anchor="middle" x="7655" y="-29344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7655" y="-29329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7655" y="-29314.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_gpu10_token_recv&#45;&gt;layer0_gpu10_expert_mlp1 -->
<g id="edge70" class="edge">
<title>layer0_gpu10_token_recv&#45;&gt;layer0_gpu10_expert_mlp1</title>
<path fill="none" stroke="black" d="M7617.62,-29410.2C7622.43,-29401.34 7627.42,-29392.15 7632.13,-29383.46"/>
<polygon fill="black" stroke="black" points="7635.23,-29385.09 7636.93,-29374.63 7629.08,-29381.75 7635.23,-29385.09"/>
</g>
<!-- layer0_gpu10_expert_act -->
<g id="node62" class="node">
<title>layer0_gpu10_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7845.5,-29270.33 7468.5,-29270.33 7468.5,-29202.33 7845.5,-29202.33 7845.5,-29270.33"/>
<text text-anchor="middle" x="7657" y="-29255.13" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="7657" y="-29240.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7657" y="-29225.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7657" y="-29210.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_gpu10_expert_mlp1&#45;&gt;layer0_gpu10_expert_act -->
<g id="edge71" class="edge">
<title>layer0_gpu10_expert_mlp1&#45;&gt;layer0_gpu10_expert_act</title>
<path fill="none" stroke="black" d="M7655.65,-29306.21C7655.81,-29298.11 7655.98,-29289.31 7656.15,-29280.8"/>
<polygon fill="black" stroke="black" points="7659.65,-29280.69 7656.35,-29270.63 7652.65,-29280.56 7659.65,-29280.69"/>
</g>
<!-- layer0_gpu10_expert_mlp2 -->
<g id="node63" class="node">
<title>layer0_gpu10_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7862.5,-29166.33 7455.5,-29166.33 7455.5,-29098.33 7862.5,-29098.33 7862.5,-29166.33"/>
<text text-anchor="middle" x="7659" y="-29151.13" font-family="Times,serif" font-size="14.00">Expert 10 MLP2</text>
<text text-anchor="middle" x="7659" y="-29136.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7659" y="-29121.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="7659" y="-29106.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_gpu10_expert_act&#45;&gt;layer0_gpu10_expert_mlp2 -->
<g id="edge72" class="edge">
<title>layer0_gpu10_expert_act&#45;&gt;layer0_gpu10_expert_mlp2</title>
<path fill="none" stroke="black" d="M7657.65,-29202.21C7657.81,-29194.11 7657.98,-29185.31 7658.15,-29176.8"/>
<polygon fill="black" stroke="black" points="7661.65,-29176.69 7658.35,-29166.63 7654.65,-29176.56 7661.65,-29176.69"/>
</g>
<!-- layer0_gpu10_token_send -->
<g id="node64" class="node">
<title>layer0_gpu10_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="7662" cy="-29014.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="7662" y="-29033.05" font-family="Times,serif" font-size="14.00">Token Send GPU10</text>
<text text-anchor="middle" x="7662" y="-29018.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="7662" y="-29003.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="7662" y="-28988.05" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_gpu10_expert_mlp2&#45;&gt;layer0_gpu10_token_send -->
<g id="edge73" class="edge">
<title>layer0_gpu10_expert_mlp2&#45;&gt;layer0_gpu10_token_send</title>
<path fill="none" stroke="black" d="M7659.86,-29098.06C7660.07,-29090.07 7660.29,-29081.3 7660.52,-29072.56"/>
<polygon fill="black" stroke="black" points="7664.02,-29072.44 7660.78,-29062.36 7657.03,-29072.26 7664.02,-29072.44"/>
</g>
<!-- layer0_gpu10_token_send&#45;&gt;layer0_expert_agg -->
<g id="edge74" class="edge">
<title>layer0_gpu10_token_send&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M7416.01,-28979.42C7376.59,-28974.58 7336.2,-28969.96 7298,-28966.16 6933.16,-28929.89 6516.42,-28902.1 6218.49,-28884.57"/>
<polygon fill="black" stroke="black" points="6218.58,-28881.07 6208.39,-28883.98 6218.17,-28888.06 6218.58,-28881.07"/>
</g>
<!-- layer0_gpu11_expert_mlp1 -->
<g id="node66" class="node">
<title>layer0_gpu11_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="8575.5,-29374.33 8114.5,-29374.33 8114.5,-29306.33 8575.5,-29306.33 8575.5,-29374.33"/>
<text text-anchor="middle" x="8345" y="-29359.13" font-family="Times,serif" font-size="14.00">Expert 11 MLP1</text>
<text text-anchor="middle" x="8345" y="-29344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8345" y="-29329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8345" y="-29314.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_gpu11_token_recv&#45;&gt;layer0_gpu11_expert_mlp1 -->
<g id="edge76" class="edge">
<title>layer0_gpu11_token_recv&#45;&gt;layer0_gpu11_expert_mlp1</title>
<path fill="none" stroke="black" d="M8341.44,-29410.2C8341.87,-29401.81 8342.32,-29393.11 8342.75,-29384.84"/>
<polygon fill="black" stroke="black" points="8346.26,-29384.8 8343.28,-29374.63 8339.27,-29384.44 8346.26,-29384.8"/>
</g>
<!-- layer0_gpu11_expert_act -->
<g id="node67" class="node">
<title>layer0_gpu11_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="8540.5,-29270.33 8163.5,-29270.33 8163.5,-29202.33 8540.5,-29202.33 8540.5,-29270.33"/>
<text text-anchor="middle" x="8352" y="-29255.13" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="8352" y="-29240.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8352" y="-29225.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8352" y="-29210.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_gpu11_expert_mlp1&#45;&gt;layer0_gpu11_expert_act -->
<g id="edge77" class="edge">
<title>layer0_gpu11_expert_mlp1&#45;&gt;layer0_gpu11_expert_act</title>
<path fill="none" stroke="black" d="M8347.27,-29306.21C8347.83,-29298.11 8348.43,-29289.31 8349.02,-29280.8"/>
<polygon fill="black" stroke="black" points="8352.52,-29280.84 8349.71,-29270.63 8345.54,-29280.36 8352.52,-29280.84"/>
</g>
<!-- layer0_gpu11_expert_mlp2 -->
<g id="node68" class="node">
<title>layer0_gpu11_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="8581.5,-29166.33 8174.5,-29166.33 8174.5,-29098.33 8581.5,-29098.33 8581.5,-29166.33"/>
<text text-anchor="middle" x="8378" y="-29151.13" font-family="Times,serif" font-size="14.00">Expert 11 MLP2</text>
<text text-anchor="middle" x="8378" y="-29136.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8378" y="-29121.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="8378" y="-29106.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_gpu11_expert_act&#45;&gt;layer0_gpu11_expert_mlp2 -->
<g id="edge78" class="edge">
<title>layer0_gpu11_expert_act&#45;&gt;layer0_gpu11_expert_mlp2</title>
<path fill="none" stroke="black" d="M8360.44,-29202.21C8362.53,-29194.02 8364.8,-29185.12 8366.99,-29176.52"/>
<polygon fill="black" stroke="black" points="8370.43,-29177.18 8369.51,-29166.63 8363.65,-29175.45 8370.43,-29177.18"/>
</g>
<!-- layer0_gpu11_token_send -->
<g id="node69" class="node">
<title>layer0_gpu11_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="8391" cy="-29014.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="8391" y="-29033.05" font-family="Times,serif" font-size="14.00">Token Send GPU11</text>
<text text-anchor="middle" x="8391" y="-29018.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="8391" y="-29003.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="8391" y="-28988.05" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_gpu11_expert_mlp2&#45;&gt;layer0_gpu11_token_send -->
<g id="edge79" class="edge">
<title>layer0_gpu11_expert_mlp2&#45;&gt;layer0_gpu11_token_send</title>
<path fill="none" stroke="black" d="M8381.73,-29098.06C8382.62,-29090.07 8383.6,-29081.3 8384.58,-29072.56"/>
<polygon fill="black" stroke="black" points="8388.09,-29072.68 8385.72,-29062.36 8381.13,-29071.9 8388.09,-29072.68"/>
</g>
<!-- layer0_gpu11_token_send&#45;&gt;layer0_expert_agg -->
<g id="edge80" class="edge">
<title>layer0_gpu11_token_send&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M8148.51,-28979.07C8108,-28974.16 8066.36,-28969.62 8027,-28966.16 7387.97,-28910.02 6642.04,-28883.28 6201.28,-28871.48"/>
<polygon fill="black" stroke="black" points="6201.34,-28867.98 6191.25,-28871.22 6201.15,-28874.98 6201.34,-28867.98"/>
</g>
<!-- layer0_gpu12_expert_mlp1 -->
<g id="node71" class="node">
<title>layer0_gpu12_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9330.5,-29374.33 8869.5,-29374.33 8869.5,-29306.33 9330.5,-29306.33 9330.5,-29374.33"/>
<text text-anchor="middle" x="9100" y="-29359.13" font-family="Times,serif" font-size="14.00">Expert 12 MLP1</text>
<text text-anchor="middle" x="9100" y="-29344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9100" y="-29329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9100" y="-29314.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_gpu12_token_recv&#45;&gt;layer0_gpu12_expert_mlp1 -->
<g id="edge82" class="edge">
<title>layer0_gpu12_token_recv&#45;&gt;layer0_gpu12_expert_mlp1</title>
<path fill="none" stroke="black" d="M9086.35,-29410.2C9088.03,-29401.72 9089.78,-29392.92 9091.43,-29384.56"/>
<polygon fill="black" stroke="black" points="9094.89,-29385.12 9093.4,-29374.63 9088.02,-29383.76 9094.89,-29385.12"/>
</g>
<!-- layer0_gpu12_expert_act -->
<g id="node72" class="node">
<title>layer0_gpu12_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9293.5,-29270.33 8916.5,-29270.33 8916.5,-29202.33 9293.5,-29202.33 9293.5,-29270.33"/>
<text text-anchor="middle" x="9105" y="-29255.13" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="9105" y="-29240.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9105" y="-29225.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9105" y="-29210.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_gpu12_expert_mlp1&#45;&gt;layer0_gpu12_expert_act -->
<g id="edge83" class="edge">
<title>layer0_gpu12_expert_mlp1&#45;&gt;layer0_gpu12_expert_act</title>
<path fill="none" stroke="black" d="M9101.62,-29306.21C9102.02,-29298.11 9102.45,-29289.31 9102.87,-29280.8"/>
<polygon fill="black" stroke="black" points="9106.37,-29280.79 9103.37,-29270.63 9099.38,-29280.44 9106.37,-29280.79"/>
</g>
<!-- layer0_gpu12_expert_mlp2 -->
<g id="node73" class="node">
<title>layer0_gpu12_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9318.5,-29166.33 8911.5,-29166.33 8911.5,-29098.33 9318.5,-29098.33 9318.5,-29166.33"/>
<text text-anchor="middle" x="9115" y="-29151.13" font-family="Times,serif" font-size="14.00">Expert 12 MLP2</text>
<text text-anchor="middle" x="9115" y="-29136.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9115" y="-29121.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9115" y="-29106.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_gpu12_expert_act&#45;&gt;layer0_gpu12_expert_mlp2 -->
<g id="edge84" class="edge">
<title>layer0_gpu12_expert_act&#45;&gt;layer0_gpu12_expert_mlp2</title>
<path fill="none" stroke="black" d="M9108.25,-29202.21C9109.04,-29194.11 9109.9,-29185.31 9110.74,-29176.8"/>
<polygon fill="black" stroke="black" points="9114.24,-29176.92 9111.74,-29166.63 9107.28,-29176.24 9114.24,-29176.92"/>
</g>
<!-- layer0_gpu12_token_send -->
<g id="node74" class="node">
<title>layer0_gpu12_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9120" cy="-29014.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9120" y="-29033.05" font-family="Times,serif" font-size="14.00">Token Send GPU12</text>
<text text-anchor="middle" x="9120" y="-29018.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9120" y="-29003.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9120" y="-28988.05" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_gpu12_expert_mlp2&#45;&gt;layer0_gpu12_token_send -->
<g id="edge85" class="edge">
<title>layer0_gpu12_expert_mlp2&#45;&gt;layer0_gpu12_token_send</title>
<path fill="none" stroke="black" d="M9116.43,-29098.06C9116.78,-29090.07 9117.15,-29081.3 9117.53,-29072.56"/>
<polygon fill="black" stroke="black" points="9121.04,-29072.5 9117.97,-29062.36 9114.04,-29072.2 9121.04,-29072.5"/>
</g>
<!-- layer0_gpu12_token_send&#45;&gt;layer0_expert_agg -->
<g id="edge86" class="edge">
<title>layer0_gpu12_token_send&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M8879.02,-28978.85C8838.04,-28973.93 8795.85,-28969.43 8756,-28966.16 7836.81,-28890.76 6751.35,-28870.49 6192.73,-28865.08"/>
<polygon fill="black" stroke="black" points="6192.53,-28861.58 6182.5,-28864.99 6192.47,-28868.58 6192.53,-28861.58"/>
</g>
<!-- layer0_gpu13_expert_mlp1 -->
<g id="node76" class="node">
<title>layer0_gpu13_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="10046.5,-29374.33 9585.5,-29374.33 9585.5,-29306.33 10046.5,-29306.33 10046.5,-29374.33"/>
<text text-anchor="middle" x="9816" y="-29359.13" font-family="Times,serif" font-size="14.00">Expert 13 MLP1</text>
<text text-anchor="middle" x="9816" y="-29344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9816" y="-29329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9816" y="-29314.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_gpu13_token_recv&#45;&gt;layer0_gpu13_expert_mlp1 -->
<g id="edge88" class="edge">
<title>layer0_gpu13_token_recv&#45;&gt;layer0_gpu13_expert_mlp1</title>
<path fill="none" stroke="black" d="M9813.03,-29410.2C9813.39,-29401.81 9813.77,-29393.11 9814.13,-29384.84"/>
<polygon fill="black" stroke="black" points="9817.63,-29384.77 9814.57,-29374.63 9810.64,-29384.47 9817.63,-29384.77"/>
</g>
<!-- layer0_gpu13_expert_act -->
<g id="node77" class="node">
<title>layer0_gpu13_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="10009.5,-29270.33 9632.5,-29270.33 9632.5,-29202.33 10009.5,-29202.33 10009.5,-29270.33"/>
<text text-anchor="middle" x="9821" y="-29255.13" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="9821" y="-29240.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9821" y="-29225.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9821" y="-29210.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_gpu13_expert_mlp1&#45;&gt;layer0_gpu13_expert_act -->
<g id="edge89" class="edge">
<title>layer0_gpu13_expert_mlp1&#45;&gt;layer0_gpu13_expert_act</title>
<path fill="none" stroke="black" d="M9817.62,-29306.21C9818.02,-29298.11 9818.45,-29289.31 9818.87,-29280.8"/>
<polygon fill="black" stroke="black" points="9822.37,-29280.79 9819.37,-29270.63 9815.38,-29280.44 9822.37,-29280.79"/>
</g>
<!-- layer0_gpu13_expert_mlp2 -->
<g id="node78" class="node">
<title>layer0_gpu13_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10043.5,-29166.33 9636.5,-29166.33 9636.5,-29098.33 10043.5,-29098.33 10043.5,-29166.33"/>
<text text-anchor="middle" x="9840" y="-29151.13" font-family="Times,serif" font-size="14.00">Expert 13 MLP2</text>
<text text-anchor="middle" x="9840" y="-29136.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9840" y="-29121.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9840" y="-29106.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_gpu13_expert_act&#45;&gt;layer0_gpu13_expert_mlp2 -->
<g id="edge90" class="edge">
<title>layer0_gpu13_expert_act&#45;&gt;layer0_gpu13_expert_mlp2</title>
<path fill="none" stroke="black" d="M9827.17,-29202.21C9828.7,-29194.02 9830.35,-29185.12 9831.95,-29176.52"/>
<polygon fill="black" stroke="black" points="9835.41,-29177.1 9833.8,-29166.63 9828.53,-29175.82 9835.41,-29177.1"/>
</g>
<!-- layer0_gpu13_token_send -->
<g id="node79" class="node">
<title>layer0_gpu13_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9849" cy="-29014.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9849" y="-29033.05" font-family="Times,serif" font-size="14.00">Token Send GPU13</text>
<text text-anchor="middle" x="9849" y="-29018.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9849" y="-29003.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9849" y="-28988.05" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_gpu13_expert_mlp2&#45;&gt;layer0_gpu13_token_send -->
<g id="edge91" class="edge">
<title>layer0_gpu13_expert_mlp2&#45;&gt;layer0_gpu13_token_send</title>
<path fill="none" stroke="black" d="M9842.58,-29098.06C9843.2,-29090.07 9843.88,-29081.3 9844.56,-29072.56"/>
<polygon fill="black" stroke="black" points="9848.06,-29072.6 9845.35,-29062.36 9841.08,-29072.05 9848.06,-29072.6"/>
</g>
<!-- layer0_gpu13_token_send&#45;&gt;layer0_expert_agg -->
<g id="edge92" class="edge">
<title>layer0_gpu13_token_send&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M9609.01,-28978.73C9567.73,-28973.79 9525.18,-28969.32 9485,-28966.16 8855.72,-28916.75 7002.11,-28882.09 6198.15,-28868.97"/>
<polygon fill="black" stroke="black" points="6197.92,-28865.47 6187.86,-28868.81 6197.8,-28872.47 6197.92,-28865.47"/>
</g>
<!-- layer0_gpu14_expert_mlp1 -->
<g id="node81" class="node">
<title>layer0_gpu14_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="10792.5,-29374.33 10331.5,-29374.33 10331.5,-29306.33 10792.5,-29306.33 10792.5,-29374.33"/>
<text text-anchor="middle" x="10562" y="-29359.13" font-family="Times,serif" font-size="14.00">Expert 14 MLP1</text>
<text text-anchor="middle" x="10562" y="-29344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10562" y="-29329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10562" y="-29314.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_gpu14_token_recv&#45;&gt;layer0_gpu14_expert_mlp1 -->
<g id="edge94" class="edge">
<title>layer0_gpu14_token_recv&#45;&gt;layer0_gpu14_expert_mlp1</title>
<path fill="none" stroke="black" d="M10550.13,-29410.2C10551.6,-29401.72 10553.11,-29392.92 10554.55,-29384.56"/>
<polygon fill="black" stroke="black" points="10558.01,-29385.08 10556.26,-29374.63 10551.11,-29383.89 10558.01,-29385.08"/>
</g>
<!-- layer0_gpu14_expert_act -->
<g id="node82" class="node">
<title>layer0_gpu14_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="10754.5,-29270.33 10377.5,-29270.33 10377.5,-29202.33 10754.5,-29202.33 10754.5,-29270.33"/>
<text text-anchor="middle" x="10566" y="-29255.13" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="10566" y="-29240.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10566" y="-29225.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10566" y="-29210.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_gpu14_expert_mlp1&#45;&gt;layer0_gpu14_expert_act -->
<g id="edge95" class="edge">
<title>layer0_gpu14_expert_mlp1&#45;&gt;layer0_gpu14_expert_act</title>
<path fill="none" stroke="black" d="M10563.3,-29306.21C10563.62,-29298.11 10563.96,-29289.31 10564.3,-29280.8"/>
<polygon fill="black" stroke="black" points="10567.8,-29280.76 10564.69,-29270.63 10560.8,-29280.48 10567.8,-29280.76"/>
</g>
<!-- layer0_gpu14_expert_mlp2 -->
<g id="node83" class="node">
<title>layer0_gpu14_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10777.5,-29166.33 10370.5,-29166.33 10370.5,-29098.33 10777.5,-29098.33 10777.5,-29166.33"/>
<text text-anchor="middle" x="10574" y="-29151.13" font-family="Times,serif" font-size="14.00">Expert 14 MLP2</text>
<text text-anchor="middle" x="10574" y="-29136.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10574" y="-29121.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="10574" y="-29106.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_gpu14_expert_act&#45;&gt;layer0_gpu14_expert_mlp2 -->
<g id="edge96" class="edge">
<title>layer0_gpu14_expert_act&#45;&gt;layer0_gpu14_expert_mlp2</title>
<path fill="none" stroke="black" d="M10568.6,-29202.21C10569.23,-29194.11 10569.92,-29185.31 10570.59,-29176.8"/>
<polygon fill="black" stroke="black" points="10574.1,-29176.87 10571.39,-29166.63 10567.12,-29176.32 10574.1,-29176.87"/>
</g>
<!-- layer0_gpu14_token_send -->
<g id="node84" class="node">
<title>layer0_gpu14_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="10578" cy="-29014.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="10578" y="-29033.05" font-family="Times,serif" font-size="14.00">Token Send GPU14</text>
<text text-anchor="middle" x="10578" y="-29018.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="10578" y="-29003.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="10578" y="-28988.05" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_gpu14_expert_mlp2&#45;&gt;layer0_gpu14_token_send -->
<g id="edge97" class="edge">
<title>layer0_gpu14_expert_mlp2&#45;&gt;layer0_gpu14_token_send</title>
<path fill="none" stroke="black" d="M10575.15,-29098.06C10575.42,-29090.07 10575.72,-29081.3 10576.03,-29072.56"/>
<polygon fill="black" stroke="black" points="10579.53,-29072.47 10576.38,-29062.36 10572.53,-29072.23 10579.53,-29072.47"/>
</g>
<!-- layer0_gpu14_token_send&#45;&gt;layer0_expert_agg -->
<g id="edge98" class="edge">
<title>layer0_gpu14_token_send&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M10338.52,-28978.63C10297.07,-28973.68 10254.35,-28969.24 10214,-28966.16 9438.23,-28907.06 7110.62,-28876.77 6194.93,-28866.88"/>
<polygon fill="black" stroke="black" points="6194.93,-28863.38 6184.89,-28866.78 6194.85,-28870.38 6194.93,-28863.38"/>
</g>
<!-- layer0_gpu15_expert_mlp1 -->
<g id="node86" class="node">
<title>layer0_gpu15_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="11506.5,-29374.33 11045.5,-29374.33 11045.5,-29306.33 11506.5,-29306.33 11506.5,-29374.33"/>
<text text-anchor="middle" x="11276" y="-29359.13" font-family="Times,serif" font-size="14.00">Expert 15 MLP1</text>
<text text-anchor="middle" x="11276" y="-29344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="11276" y="-29329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11276" y="-29314.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_gpu15_token_recv&#45;&gt;layer0_gpu15_expert_mlp1 -->
<g id="edge100" class="edge">
<title>layer0_gpu15_token_recv&#45;&gt;layer0_gpu15_expert_mlp1</title>
<path fill="none" stroke="black" d="M11273.63,-29410.2C11273.92,-29401.81 11274.22,-29393.11 11274.5,-29384.84"/>
<polygon fill="black" stroke="black" points="11278.01,-29384.75 11274.85,-29374.63 11271.01,-29384.51 11278.01,-29384.75"/>
</g>
<!-- layer0_gpu15_expert_act -->
<g id="node87" class="node">
<title>layer0_gpu15_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="11472.5,-29270.33 11095.5,-29270.33 11095.5,-29202.33 11472.5,-29202.33 11472.5,-29270.33"/>
<text text-anchor="middle" x="11284" y="-29255.13" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="11284" y="-29240.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11284" y="-29225.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11284" y="-29210.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_gpu15_expert_mlp1&#45;&gt;layer0_gpu15_expert_act -->
<g id="edge101" class="edge">
<title>layer0_gpu15_expert_mlp1&#45;&gt;layer0_gpu15_expert_act</title>
<path fill="none" stroke="black" d="M11278.6,-29306.21C11279.23,-29298.11 11279.92,-29289.31 11280.59,-29280.8"/>
<polygon fill="black" stroke="black" points="11284.1,-29280.87 11281.39,-29270.63 11277.12,-29280.32 11284.1,-29280.87"/>
</g>
<!-- layer0_gpu15_expert_mlp2 -->
<g id="node88" class="node">
<title>layer0_gpu15_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="11505.5,-29166.33 11098.5,-29166.33 11098.5,-29098.33 11505.5,-29098.33 11505.5,-29166.33"/>
<text text-anchor="middle" x="11302" y="-29151.13" font-family="Times,serif" font-size="14.00">Expert 15 MLP2</text>
<text text-anchor="middle" x="11302" y="-29136.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11302" y="-29121.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="11302" y="-29106.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_gpu15_expert_act&#45;&gt;layer0_gpu15_expert_mlp2 -->
<g id="edge102" class="edge">
<title>layer0_gpu15_expert_act&#45;&gt;layer0_gpu15_expert_mlp2</title>
<path fill="none" stroke="black" d="M11289.84,-29202.21C11291.29,-29194.02 11292.86,-29185.12 11294.38,-29176.52"/>
<polygon fill="black" stroke="black" points="11297.83,-29177.08 11296.12,-29166.63 11290.94,-29175.87 11297.83,-29177.08"/>
</g>
<!-- layer0_gpu15_token_send -->
<g id="node89" class="node">
<title>layer0_gpu15_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="11307" cy="-29014.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="11307" y="-29033.05" font-family="Times,serif" font-size="14.00">Token Send GPU15</text>
<text text-anchor="middle" x="11307" y="-29018.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="11307" y="-29003.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="11307" y="-28988.05" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_gpu15_expert_mlp2&#45;&gt;layer0_gpu15_token_send -->
<g id="edge103" class="edge">
<title>layer0_gpu15_expert_mlp2&#45;&gt;layer0_gpu15_token_send</title>
<path fill="none" stroke="black" d="M11303.43,-29098.06C11303.78,-29090.07 11304.15,-29081.3 11304.53,-29072.56"/>
<polygon fill="black" stroke="black" points="11308.04,-29072.5 11304.97,-29062.36 11301.04,-29072.2 11308.04,-29072.5"/>
</g>
<!-- layer0_gpu15_token_send&#45;&gt;layer0_expert_agg -->
<g id="edge104" class="edge">
<title>layer0_gpu15_token_send&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M11068.01,-28978.57C11026.42,-28973.62 10983.51,-28969.18 10943,-28966.16 10019.79,-28897.38 7211.8,-28872.36 6193.17,-28865.41"/>
<polygon fill="black" stroke="black" points="6193.15,-28861.91 6183.13,-28865.34 6193.1,-28868.91 6193.15,-28861.91"/>
</g>
<!-- layer0_residual2 -->
<g id="node91" class="node">
<title>layer0_residual2</title>
<polygon fill="lightyellow" stroke="black" points="6261.89,-28758.16 5557.35,-28758.16 5376.11,-28622.16 6080.65,-28622.16 6261.89,-28758.16"/>
<text text-anchor="middle" x="5819" y="-28708.96" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="5819" y="-28693.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5819" y="-28678.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5819" y="-28663.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer0_expert_agg&#45;&gt;layer0_residual2 -->
<g id="edge105" class="edge">
<title>layer0_expert_agg&#45;&gt;layer0_residual2</title>
<path fill="none" stroke="black" d="M5819,-28793.97C5819,-28785.66 5819,-28777.11 5819,-28768.66"/>
<polygon fill="black" stroke="black" points="5822.5,-28768.42 5819,-28758.42 5815.5,-28768.42 5822.5,-28768.42"/>
</g>
<!-- layer1_layernorm -->
<g id="node92" class="node">
<title>layer1_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="6022.5,-28575.16 5615.5,-28575.16 5615.5,-28507.16 6022.5,-28507.16 6022.5,-28575.16"/>
<text text-anchor="middle" x="5819" y="-28559.96" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5819" y="-28544.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5819" y="-28529.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5819" y="-28514.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer0_residual2&#45;&gt;layer1_layernorm -->
<g id="edge106" class="edge">
<title>layer0_residual2&#45;&gt;layer1_layernorm</title>
<path fill="none" stroke="black" d="M5819,-28622.11C5819,-28609.71 5819,-28597.05 5819,-28585.58"/>
<polygon fill="black" stroke="black" points="5822.5,-28585.42 5819,-28575.42 5815.5,-28585.42 5822.5,-28585.42"/>
</g>
<!-- layer1_qkv_proj -->
<g id="node93" class="node">
<title>layer1_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="6076.5,-28471.16 5561.5,-28471.16 5561.5,-28403.16 6076.5,-28403.16 6076.5,-28471.16"/>
<text text-anchor="middle" x="5819" y="-28455.96" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5819" y="-28440.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5819" y="-28425.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5819" y="-28410.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer1_layernorm&#45;&gt;layer1_qkv_proj -->
<g id="edge107" class="edge">
<title>layer1_layernorm&#45;&gt;layer1_qkv_proj</title>
<path fill="none" stroke="black" d="M5819,-28507.05C5819,-28498.94 5819,-28490.14 5819,-28481.63"/>
<polygon fill="black" stroke="black" points="5822.5,-28481.46 5819,-28471.46 5815.5,-28481.46 5822.5,-28481.46"/>
</g>
<!-- layer1_attention -->
<g id="node94" class="node">
<title>layer1_attention</title>
<polygon fill="lightgreen" stroke="black" points="6070.5,-28367.16 5567.5,-28367.16 5567.5,-28299.16 6070.5,-28299.16 6070.5,-28367.16"/>
<text text-anchor="middle" x="5819" y="-28351.96" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5819" y="-28336.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5819" y="-28321.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5819" y="-28306.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer1_qkv_proj&#45;&gt;layer1_attention -->
<g id="edge108" class="edge">
<title>layer1_qkv_proj&#45;&gt;layer1_attention</title>
<path fill="none" stroke="black" d="M5819,-28403.05C5819,-28394.94 5819,-28386.14 5819,-28377.63"/>
<polygon fill="black" stroke="black" points="5822.5,-28377.46 5819,-28367.46 5815.5,-28377.46 5822.5,-28377.46"/>
</g>
<!-- layer1_attn_out -->
<g id="node95" class="node">
<title>layer1_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="6057.5,-28263.16 5580.5,-28263.16 5580.5,-28195.16 6057.5,-28195.16 6057.5,-28263.16"/>
<text text-anchor="middle" x="5819" y="-28247.96" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5819" y="-28232.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5819" y="-28217.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5819" y="-28202.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer1_attention&#45;&gt;layer1_attn_out -->
<g id="edge109" class="edge">
<title>layer1_attention&#45;&gt;layer1_attn_out</title>
<path fill="none" stroke="black" d="M5819,-28299.05C5819,-28290.94 5819,-28282.14 5819,-28273.63"/>
<polygon fill="black" stroke="black" points="5822.5,-28273.46 5819,-28263.46 5815.5,-28273.46 5822.5,-28273.46"/>
</g>
<!-- layer1_residual1 -->
<g id="node96" class="node">
<title>layer1_residual1</title>
<polygon fill="lightyellow" stroke="black" points="6261.89,-28159.16 5557.35,-28159.16 5376.11,-28023.16 6080.65,-28023.16 6261.89,-28159.16"/>
<text text-anchor="middle" x="5819" y="-28109.96" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5819" y="-28094.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5819" y="-28079.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5819" y="-28064.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer1_attn_out&#45;&gt;layer1_residual1 -->
<g id="edge110" class="edge">
<title>layer1_attn_out&#45;&gt;layer1_residual1</title>
<path fill="none" stroke="black" d="M5819,-28194.89C5819,-28187.07 5819,-28178.4 5819,-28169.51"/>
<polygon fill="black" stroke="black" points="5822.5,-28169.43 5819,-28159.43 5815.5,-28169.43 5822.5,-28169.43"/>
</g>
<!-- layer1_layernorm2 -->
<g id="node97" class="node">
<title>layer1_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="6022.5,-27987.16 5615.5,-27987.16 5615.5,-27919.16 6022.5,-27919.16 6022.5,-27987.16"/>
<text text-anchor="middle" x="5819" y="-27971.96" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5819" y="-27956.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5819" y="-27941.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5819" y="-27926.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer1_residual1&#45;&gt;layer1_layernorm2 -->
<g id="edge111" class="edge">
<title>layer1_residual1&#45;&gt;layer1_layernorm2</title>
<path fill="none" stroke="black" d="M5819,-28022.96C5819,-28014.21 5819,-28005.44 5819,-27997.23"/>
<polygon fill="black" stroke="black" points="5822.5,-27997.18 5819,-27987.18 5815.5,-27997.18 5822.5,-27997.18"/>
</g>
<!-- layer1_global_gate -->
<g id="node98" class="node">
<title>layer1_global_gate</title>
<polygon fill="lightgreen" stroke="black" points="6016.5,-27883.16 5621.5,-27883.16 5621.5,-27815.16 6016.5,-27815.16 6016.5,-27883.16"/>
<text text-anchor="middle" x="5819" y="-27867.96" font-family="Times,serif" font-size="14.00">Global Gate</text>
<text text-anchor="middle" x="5819" y="-27852.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5819" y="-27837.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, experts=64]</text>
<text text-anchor="middle" x="5819" y="-27822.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer1_layernorm2&#45;&gt;layer1_global_gate -->
<g id="edge112" class="edge">
<title>layer1_layernorm2&#45;&gt;layer1_global_gate</title>
<path fill="none" stroke="black" d="M5819,-27919.05C5819,-27910.94 5819,-27902.14 5819,-27893.63"/>
<polygon fill="black" stroke="black" points="5822.5,-27893.46 5819,-27883.46 5815.5,-27893.46 5822.5,-27893.46"/>
</g>
<!-- layer1_routing -->
<g id="node99" class="node">
<title>layer1_routing</title>
<polygon fill="lightyellow" stroke="black" points="6305.47,-27779.16 5531.6,-27779.16 5332.53,-27643.16 6106.4,-27643.16 6305.47,-27779.16"/>
<text text-anchor="middle" x="5819" y="-27729.96" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="5819" y="-27714.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5819" y="-27699.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5819" y="-27684.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer1_global_gate&#45;&gt;layer1_routing -->
<g id="edge113" class="edge">
<title>layer1_global_gate&#45;&gt;layer1_routing</title>
<path fill="none" stroke="black" d="M5819,-27814.89C5819,-27807.07 5819,-27798.4 5819,-27789.51"/>
<polygon fill="black" stroke="black" points="5822.5,-27789.43 5819,-27779.43 5815.5,-27789.43 5822.5,-27789.43"/>
</g>
<!-- layer1_gpu0_token_recv -->
<g id="node100" class="node">
<title>layer1_gpu0_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="438" cy="-27559.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="438" y="-27577.88" font-family="Times,serif" font-size="14.00">Token Receive GPU0</text>
<text text-anchor="middle" x="438" y="-27562.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="438" y="-27547.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="438" y="-27532.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_routing&#45;&gt;layer1_gpu0_token_recv -->
<g id="edge114" class="edge">
<title>layer1_routing&#45;&gt;layer1_gpu0_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5426.73,-27707.58C4408.65,-27699.99 1699.02,-27673.96 803,-27607.16 763.12,-27604.19 720.92,-27599.86 679.93,-27595"/>
<polygon fill="black" stroke="black" points="680.16,-27591.51 669.81,-27593.79 679.32,-27598.46 680.16,-27591.51"/>
</g>
<!-- layer1_gpu1_token_recv -->
<g id="node105" class="node">
<title>layer1_gpu1_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1146" cy="-27559.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1146" y="-27577.88" font-family="Times,serif" font-size="14.00">Token Receive GPU1</text>
<text text-anchor="middle" x="1146" y="-27562.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1146" y="-27547.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1146" y="-27532.88" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_routing&#45;&gt;layer1_gpu1_token_recv -->
<g id="edge120" class="edge">
<title>layer1_routing&#45;&gt;layer1_gpu1_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5424.66,-27706.36C4507.25,-27696.61 2250.45,-27667.16 1494,-27607.16 1458.17,-27604.32 1420.38,-27600.29 1383.44,-27595.77"/>
<polygon fill="black" stroke="black" points="1383.41,-27592.24 1373.05,-27594.48 1382.55,-27599.19 1383.41,-27592.24"/>
</g>
<!-- layer1_gpu2_token_recv -->
<g id="node110" class="node">
<title>layer1_gpu2_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1837" cy="-27559.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1837" y="-27577.88" font-family="Times,serif" font-size="14.00">Token Receive GPU2</text>
<text text-anchor="middle" x="1837" y="-27562.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1837" y="-27547.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1837" y="-27532.88" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_routing&#45;&gt;layer1_gpu2_token_recv -->
<g id="edge126" class="edge">
<title>layer1_routing&#45;&gt;layer1_gpu2_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5427.75,-27708.37C4775.64,-27703.23 3425.57,-27683.41 2286,-27607.16 2226.46,-27603.18 2162.62,-27597.4 2102.3,-27591.25"/>
<polygon fill="black" stroke="black" points="2102.57,-27587.75 2092.26,-27590.21 2101.85,-27594.72 2102.57,-27587.75"/>
</g>
<!-- layer1_gpu3_token_recv -->
<g id="node115" class="node">
<title>layer1_gpu3_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="2629" cy="-27559.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2629" y="-27577.88" font-family="Times,serif" font-size="14.00">Token Receive GPU3</text>
<text text-anchor="middle" x="2629" y="-27562.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="2629" y="-27547.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2629" y="-27532.88" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_routing&#45;&gt;layer1_gpu3_token_recv -->
<g id="edge132" class="edge">
<title>layer1_routing&#45;&gt;layer1_gpu3_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5423.97,-27705.73C4882.2,-27697.34 3878.55,-27673.53 3025,-27607.16 2978.76,-27603.57 2929.61,-27598.63 2882.23,-27593.3"/>
<polygon fill="black" stroke="black" points="2882.48,-27589.8 2872.15,-27592.16 2881.69,-27596.76 2882.48,-27589.8"/>
</g>
<!-- layer1_gpu4_token_recv -->
<g id="node120" class="node">
<title>layer1_gpu4_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="3368" cy="-27559.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="3368" y="-27577.88" font-family="Times,serif" font-size="14.00">Token Receive GPU4</text>
<text text-anchor="middle" x="3368" y="-27562.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="3368" y="-27547.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3368" y="-27532.88" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_routing&#45;&gt;layer1_gpu4_token_recv -->
<g id="edge138" class="edge">
<title>layer1_routing&#45;&gt;layer1_gpu4_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5414.56,-27699.38C4994.78,-27686.02 4319.48,-27658.47 3738,-27607.16 3698.22,-27603.65 3656.14,-27599.1 3615.17,-27594.21"/>
<polygon fill="black" stroke="black" points="3615.41,-27590.72 3605.06,-27593 3614.57,-27597.67 3615.41,-27590.72"/>
</g>
<!-- layer1_gpu5_token_recv -->
<g id="node125" class="node">
<title>layer1_gpu5_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4081" cy="-27559.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4081" y="-27577.88" font-family="Times,serif" font-size="14.00">Token Receive GPU5</text>
<text text-anchor="middle" x="4081" y="-27562.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4081" y="-27547.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4081" y="-27532.88" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_routing&#45;&gt;layer1_gpu5_token_recv -->
<g id="edge144" class="edge">
<title>layer1_routing&#45;&gt;layer1_gpu5_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5393.06,-27684.65C5119.79,-27666.74 4757.57,-27640.13 4438,-27607.16 4402.33,-27603.48 4364.73,-27599.09 4327.84,-27594.48"/>
<polygon fill="black" stroke="black" points="4327.82,-27590.95 4317.46,-27593.18 4326.94,-27597.9 4327.82,-27590.95"/>
</g>
<!-- layer1_gpu6_token_recv -->
<g id="node130" class="node">
<title>layer1_gpu6_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4781" cy="-27559.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4781" y="-27577.88" font-family="Times,serif" font-size="14.00">Token Receive GPU6</text>
<text text-anchor="middle" x="4781" y="-27562.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4781" y="-27547.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4781" y="-27532.88" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_routing&#45;&gt;layer1_gpu6_token_recv -->
<g id="edge150" class="edge">
<title>layer1_routing&#45;&gt;layer1_gpu6_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5355.4,-27643.13C5240.9,-27626.57 5122.75,-27609.49 5023.6,-27595.16"/>
<polygon fill="black" stroke="black" points="5023.85,-27591.66 5013.46,-27593.69 5022.85,-27598.58 5023.85,-27591.66"/>
</g>
<!-- layer1_gpu7_token_recv -->
<g id="node135" class="node">
<title>layer1_gpu7_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="5475" cy="-27559.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="5475" y="-27577.88" font-family="Times,serif" font-size="14.00">Token Receive GPU7</text>
<text text-anchor="middle" x="5475" y="-27562.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5475" y="-27547.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5475" y="-27532.88" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_routing&#45;&gt;layer1_gpu7_token_recv -->
<g id="edge156" class="edge">
<title>layer1_routing&#45;&gt;layer1_gpu7_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5665.36,-27643.13C5639.17,-27631.7 5612.4,-27620.02 5587.52,-27609.17"/>
<polygon fill="black" stroke="black" points="5588.65,-27605.85 5578.09,-27605.06 5585.85,-27612.26 5588.65,-27605.85"/>
</g>
<!-- layer1_gpu8_token_recv -->
<g id="node140" class="node">
<title>layer1_gpu8_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6163" cy="-27559.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6163" y="-27577.88" font-family="Times,serif" font-size="14.00">Token Receive GPU8</text>
<text text-anchor="middle" x="6163" y="-27562.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6163" y="-27547.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6163" y="-27532.88" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_routing&#45;&gt;layer1_gpu8_token_recv -->
<g id="edge162" class="edge">
<title>layer1_routing&#45;&gt;layer1_gpu8_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5972.64,-27643.13C5998.83,-27631.7 6025.6,-27620.02 6050.48,-27609.17"/>
<polygon fill="black" stroke="black" points="6052.15,-27612.26 6059.91,-27605.06 6049.35,-27605.85 6052.15,-27612.26"/>
</g>
<!-- layer1_gpu9_token_recv -->
<g id="node145" class="node">
<title>layer1_gpu9_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6850" cy="-27559.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6850" y="-27577.88" font-family="Times,serif" font-size="14.00">Token Receive GPU9</text>
<text text-anchor="middle" x="6850" y="-27562.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6850" y="-27547.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6850" y="-27532.88" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_routing&#45;&gt;layer1_gpu9_token_recv -->
<g id="edge168" class="edge">
<title>layer1_routing&#45;&gt;layer1_gpu9_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6137.1,-27663.86C6288.9,-27641.76 6467.6,-27615.75 6608.11,-27595.29"/>
<polygon fill="black" stroke="black" points="6608.77,-27598.73 6618.16,-27593.83 6607.76,-27591.81 6608.77,-27598.73"/>
</g>
<!-- layer1_gpu10_token_recv -->
<g id="node150" class="node">
<title>layer1_gpu10_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="7537" cy="-27559.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="7537" y="-27577.88" font-family="Times,serif" font-size="14.00">Token Receive GPU10</text>
<text text-anchor="middle" x="7537" y="-27562.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="7537" y="-27547.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7537" y="-27532.88" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_routing&#45;&gt;layer1_gpu10_token_recv -->
<g id="edge174" class="edge">
<title>layer1_routing&#45;&gt;layer1_gpu10_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6174.32,-27689.52C6452.06,-27671.93 6847.62,-27643.71 7193,-27607.16 7226.01,-27603.67 7260.73,-27599.5 7294.91,-27595.11"/>
<polygon fill="black" stroke="black" points="7295.54,-27598.56 7305.01,-27593.8 7294.64,-27591.61 7295.54,-27598.56"/>
</g>
<!-- layer1_gpu11_token_recv -->
<g id="node155" class="node">
<title>layer1_gpu11_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8224" cy="-27559.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8224" y="-27577.88" font-family="Times,serif" font-size="14.00">Token Receive GPU11</text>
<text text-anchor="middle" x="8224" y="-27562.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8224" y="-27547.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8224" y="-27532.88" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_routing&#45;&gt;layer1_gpu11_token_recv -->
<g id="edge180" class="edge">
<title>layer1_routing&#45;&gt;layer1_gpu11_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6191.54,-27701.19C6604.86,-27688.99 7291.2,-27662.07 7880,-27607.16 7914.15,-27603.98 7950.11,-27599.88 7985.4,-27595.44"/>
<polygon fill="black" stroke="black" points="7985.85,-27598.91 7995.33,-27594.18 7984.97,-27591.97 7985.85,-27598.91"/>
</g>
<!-- layer1_gpu12_token_recv -->
<g id="node160" class="node">
<title>layer1_gpu12_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8911" cy="-27559.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8911" y="-27577.88" font-family="Times,serif" font-size="14.00">Token Receive GPU12</text>
<text text-anchor="middle" x="8911" y="-27562.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8911" y="-27547.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8911" y="-27532.88" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_routing&#45;&gt;layer1_gpu12_token_recv -->
<g id="edge186" class="edge">
<title>layer1_routing&#45;&gt;layer1_gpu12_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6200.93,-27707.72C6732.36,-27701.61 7724.55,-27680.42 8567,-27607.16 8601.58,-27604.15 8638.01,-27600.12 8673.71,-27595.67"/>
<polygon fill="black" stroke="black" points="8674.27,-27599.12 8683.76,-27594.4 8673.4,-27592.18 8674.27,-27599.12"/>
</g>
<!-- layer1_gpu13_token_recv -->
<g id="node165" class="node">
<title>layer1_gpu13_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="9598" cy="-27559.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="9598" y="-27577.88" font-family="Times,serif" font-size="14.00">Token Receive GPU13</text>
<text text-anchor="middle" x="9598" y="-27562.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="9598" y="-27547.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9598" y="-27532.88" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_routing&#45;&gt;layer1_gpu13_token_recv -->
<g id="edge192" class="edge">
<title>layer1_routing&#45;&gt;layer1_gpu13_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6195.48,-27703.92C6959.72,-27690.42 8670.02,-27655.74 9254,-27607.16 9288.87,-27604.26 9325.61,-27600.26 9361.58,-27595.8"/>
<polygon fill="black" stroke="black" points="9362.22,-27599.24 9371.7,-27594.53 9361.34,-27592.3 9362.22,-27599.24"/>
</g>
<!-- layer1_gpu14_token_recv -->
<g id="node170" class="node">
<title>layer1_gpu14_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10285" cy="-27559.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10285" y="-27577.88" font-family="Times,serif" font-size="14.00">Token Receive GPU14</text>
<text text-anchor="middle" x="10285" y="-27562.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10285" y="-27547.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10285" y="-27532.88" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_routing&#45;&gt;layer1_gpu14_token_recv -->
<g id="edge198" class="edge">
<title>layer1_routing&#45;&gt;layer1_gpu14_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6198.5,-27706.07C7075.19,-27695.75 9221.12,-27665.24 9941,-27607.16 9976.01,-27604.34 10012.91,-27600.36 10049.02,-27595.9"/>
<polygon fill="black" stroke="black" points="10049.69,-27599.34 10059.18,-27594.63 10048.82,-27592.4 10049.69,-27599.34"/>
</g>
<!-- layer1_gpu15_token_recv -->
<g id="node175" class="node">
<title>layer1_gpu15_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10972" cy="-27559.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10972" y="-27577.88" font-family="Times,serif" font-size="14.00">Token Receive GPU15</text>
<text text-anchor="middle" x="10972" y="-27562.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10972" y="-27547.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10972" y="-27532.88" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_routing&#45;&gt;layer1_gpu15_token_recv -->
<g id="edge204" class="edge">
<title>layer1_routing&#45;&gt;layer1_gpu15_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6200.89,-27707.64C7181.47,-27700.26 9770.91,-27674.77 10628,-27607.16 10663.15,-27604.39 10700.21,-27600.42 10736.45,-27595.96"/>
<polygon fill="black" stroke="black" points="10737.16,-27599.4 10746.65,-27594.69 10736.29,-27592.45 10737.16,-27599.4"/>
</g>
<!-- layer1_gpu0_expert_mlp1 -->
<g id="node101" class="node">
<title>layer1_gpu0_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="658.5,-27475 197.5,-27475 197.5,-27407 658.5,-27407 658.5,-27475"/>
<text text-anchor="middle" x="428" y="-27459.8" font-family="Times,serif" font-size="14.00">Expert 0 MLP1</text>
<text text-anchor="middle" x="428" y="-27444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="428" y="-27429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="428" y="-27414.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gpu0_token_recv&#45;&gt;layer1_gpu0_expert_mlp1 -->
<g id="edge115" class="edge">
<title>layer1_gpu0_token_recv&#45;&gt;layer1_gpu0_expert_mlp1</title>
<path fill="none" stroke="black" d="M433.93,-27510.86C433.21,-27502.48 432.46,-27493.78 431.75,-27485.5"/>
<polygon fill="black" stroke="black" points="435.21,-27484.96 430.87,-27475.3 428.24,-27485.56 435.21,-27484.96"/>
</g>
<!-- layer1_gpu0_expert_act -->
<g id="node102" class="node">
<title>layer1_gpu0_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="599.5,-27371 222.5,-27371 222.5,-27303 599.5,-27303 599.5,-27371"/>
<text text-anchor="middle" x="411" y="-27355.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="411" y="-27340.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="411" y="-27325.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="411" y="-27310.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gpu0_expert_mlp1&#45;&gt;layer1_gpu0_expert_act -->
<g id="edge116" class="edge">
<title>layer1_gpu0_expert_mlp1&#45;&gt;layer1_gpu0_expert_act</title>
<path fill="none" stroke="black" d="M422.48,-27406.88C421.11,-27398.68 419.63,-27389.78 418.2,-27381.19"/>
<polygon fill="black" stroke="black" points="421.65,-27380.58 416.55,-27371.3 414.74,-27381.73 421.65,-27380.58"/>
</g>
<!-- layer1_gpu0_expert_mlp2 -->
<g id="node103" class="node">
<title>layer1_gpu0_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="595.5,-27267 188.5,-27267 188.5,-27199 595.5,-27199 595.5,-27267"/>
<text text-anchor="middle" x="392" y="-27251.8" font-family="Times,serif" font-size="14.00">Expert 0 MLP2</text>
<text text-anchor="middle" x="392" y="-27236.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="392" y="-27221.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="392" y="-27206.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gpu0_expert_act&#45;&gt;layer1_gpu0_expert_mlp2 -->
<g id="edge117" class="edge">
<title>layer1_gpu0_expert_act&#45;&gt;layer1_gpu0_expert_mlp2</title>
<path fill="none" stroke="black" d="M404.83,-27302.88C403.3,-27294.68 401.65,-27285.78 400.05,-27277.19"/>
<polygon fill="black" stroke="black" points="403.47,-27276.48 398.2,-27267.3 396.59,-27277.77 403.47,-27276.48"/>
</g>
<!-- layer1_gpu0_token_send -->
<g id="node104" class="node">
<title>layer1_gpu0_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="372" cy="-27114.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="372" y="-27133.71" font-family="Times,serif" font-size="14.00">Token Send GPU0</text>
<text text-anchor="middle" x="372" y="-27118.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="372" y="-27103.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="372" y="-27088.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gpu0_expert_mlp2&#45;&gt;layer1_gpu0_token_send -->
<g id="edge118" class="edge">
<title>layer1_gpu0_expert_mlp2&#45;&gt;layer1_gpu0_token_send</title>
<path fill="none" stroke="black" d="M386.27,-27198.73C384.88,-27190.65 383.35,-27181.78 381.83,-27172.94"/>
<polygon fill="black" stroke="black" points="385.26,-27172.28 380.12,-27163.02 378.37,-27173.47 385.26,-27172.28"/>
</g>
<!-- layer1_expert_agg -->
<g id="node180" class="node">
<title>layer1_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="5929.05,-27030.83 5209.94,-27030.83 5024.95,-26894.83 5744.06,-26894.83 5929.05,-27030.83"/>
<text text-anchor="middle" x="5477" y="-26981.63" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5477" y="-26966.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x16)</text>
<text text-anchor="middle" x="5477" y="-26951.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-26936.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer1_gpu0_token_send&#45;&gt;layer1_expert_agg -->
<g id="edge119" class="edge">
<title>layer1_gpu0_token_send&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M610.99,-27079.3C652.59,-27074.33 695.49,-27069.88 736,-27066.83 1584.6,-27002.91 4154.44,-26975.06 5112.12,-26966.7"/>
<polygon fill="black" stroke="black" points="5112.29,-26970.2 5122.26,-26966.61 5112.23,-26963.2 5112.29,-26970.2"/>
</g>
<!-- layer1_gpu1_expert_mlp1 -->
<g id="node106" class="node">
<title>layer1_gpu1_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="1352.5,-27475 891.5,-27475 891.5,-27407 1352.5,-27407 1352.5,-27475"/>
<text text-anchor="middle" x="1122" y="-27459.8" font-family="Times,serif" font-size="14.00">Expert 1 MLP1</text>
<text text-anchor="middle" x="1122" y="-27444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1122" y="-27429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1122" y="-27414.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gpu1_token_recv&#45;&gt;layer1_gpu1_expert_mlp1 -->
<g id="edge121" class="edge">
<title>layer1_gpu1_token_recv&#45;&gt;layer1_gpu1_expert_mlp1</title>
<path fill="none" stroke="black" d="M1136.24,-27510.86C1134.49,-27502.38 1132.67,-27493.59 1130.94,-27485.23"/>
<polygon fill="black" stroke="black" points="1134.34,-27484.38 1128.89,-27475.3 1127.48,-27485.8 1134.34,-27484.38"/>
</g>
<!-- layer1_gpu1_expert_act -->
<g id="node107" class="node">
<title>layer1_gpu1_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="1298.5,-27371 921.5,-27371 921.5,-27303 1298.5,-27303 1298.5,-27371"/>
<text text-anchor="middle" x="1110" y="-27355.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1110" y="-27340.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1110" y="-27325.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1110" y="-27310.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gpu1_expert_mlp1&#45;&gt;layer1_gpu1_expert_act -->
<g id="edge122" class="edge">
<title>layer1_gpu1_expert_mlp1&#45;&gt;layer1_gpu1_expert_act</title>
<path fill="none" stroke="black" d="M1118.1,-27406.88C1117.15,-27398.77 1116.12,-27389.98 1115.11,-27381.47"/>
<polygon fill="black" stroke="black" points="1118.56,-27380.82 1113.92,-27371.3 1111.61,-27381.64 1118.56,-27380.82"/>
</g>
<!-- layer1_gpu1_expert_mlp2 -->
<g id="node108" class="node">
<title>layer1_gpu1_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="1310.5,-27267 903.5,-27267 903.5,-27199 1310.5,-27199 1310.5,-27267"/>
<text text-anchor="middle" x="1107" y="-27251.8" font-family="Times,serif" font-size="14.00">Expert 1 MLP2</text>
<text text-anchor="middle" x="1107" y="-27236.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1107" y="-27221.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1107" y="-27206.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gpu1_expert_act&#45;&gt;layer1_gpu1_expert_mlp2 -->
<g id="edge123" class="edge">
<title>layer1_gpu1_expert_act&#45;&gt;layer1_gpu1_expert_mlp2</title>
<path fill="none" stroke="black" d="M1109.03,-27302.88C1108.79,-27294.77 1108.53,-27285.98 1108.28,-27277.47"/>
<polygon fill="black" stroke="black" points="1111.77,-27277.19 1107.98,-27267.3 1104.77,-27277.39 1111.77,-27277.19"/>
</g>
<!-- layer1_gpu1_token_send -->
<g id="node109" class="node">
<title>layer1_gpu1_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1101" cy="-27114.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1101" y="-27133.71" font-family="Times,serif" font-size="14.00">Token Send GPU1</text>
<text text-anchor="middle" x="1101" y="-27118.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1101" y="-27103.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1101" y="-27088.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gpu1_expert_mlp2&#45;&gt;layer1_gpu1_token_send -->
<g id="edge124" class="edge">
<title>layer1_gpu1_expert_mlp2&#45;&gt;layer1_gpu1_token_send</title>
<path fill="none" stroke="black" d="M1105.28,-27198.73C1104.87,-27190.74 1104.41,-27181.97 1103.96,-27173.23"/>
<polygon fill="black" stroke="black" points="1107.45,-27172.83 1103.43,-27163.02 1100.46,-27173.19 1107.45,-27172.83"/>
</g>
<!-- layer1_gpu1_token_send&#45;&gt;layer1_expert_agg -->
<g id="edge125" class="edge">
<title>layer1_gpu1_token_send&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M1340.98,-27079.31C1382.27,-27074.38 1424.82,-27069.94 1465,-27066.83 2167.7,-27012.51 4265.31,-26979.72 5114.3,-26968.35"/>
<polygon fill="black" stroke="black" points="5114.59,-26971.85 5124.54,-26968.22 5114.49,-26964.85 5114.59,-26971.85"/>
</g>
<!-- layer1_gpu2_expert_mlp1 -->
<g id="node111" class="node">
<title>layer1_gpu2_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2064.5,-27475 1603.5,-27475 1603.5,-27407 2064.5,-27407 2064.5,-27475"/>
<text text-anchor="middle" x="1834" y="-27459.8" font-family="Times,serif" font-size="14.00">Expert 2 MLP1</text>
<text text-anchor="middle" x="1834" y="-27444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1834" y="-27429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1834" y="-27414.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gpu2_token_recv&#45;&gt;layer1_gpu2_expert_mlp1 -->
<g id="edge127" class="edge">
<title>layer1_gpu2_token_recv&#45;&gt;layer1_gpu2_expert_mlp1</title>
<path fill="none" stroke="black" d="M1835.78,-27510.86C1835.56,-27502.48 1835.34,-27493.78 1835.12,-27485.5"/>
<polygon fill="black" stroke="black" points="1838.62,-27485.21 1834.86,-27475.3 1831.62,-27485.39 1838.62,-27485.21"/>
</g>
<!-- layer1_gpu2_expert_act -->
<g id="node112" class="node">
<title>layer1_gpu2_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2020.5,-27371 1643.5,-27371 1643.5,-27303 2020.5,-27303 2020.5,-27371"/>
<text text-anchor="middle" x="1832" y="-27355.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="1832" y="-27340.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1832" y="-27325.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1832" y="-27310.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gpu2_expert_mlp1&#45;&gt;layer1_gpu2_expert_act -->
<g id="edge128" class="edge">
<title>layer1_gpu2_expert_mlp1&#45;&gt;layer1_gpu2_expert_act</title>
<path fill="none" stroke="black" d="M1833.35,-27406.88C1833.19,-27398.77 1833.02,-27389.98 1832.85,-27381.47"/>
<polygon fill="black" stroke="black" points="1836.35,-27381.22 1832.65,-27371.3 1829.35,-27381.36 1836.35,-27381.22"/>
</g>
<!-- layer1_gpu2_expert_mlp2 -->
<g id="node113" class="node">
<title>layer1_gpu2_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2034.5,-27267 1627.5,-27267 1627.5,-27199 2034.5,-27199 2034.5,-27267"/>
<text text-anchor="middle" x="1831" y="-27251.8" font-family="Times,serif" font-size="14.00">Expert 2 MLP2</text>
<text text-anchor="middle" x="1831" y="-27236.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1831" y="-27221.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1831" y="-27206.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gpu2_expert_act&#45;&gt;layer1_gpu2_expert_mlp2 -->
<g id="edge129" class="edge">
<title>layer1_gpu2_expert_act&#45;&gt;layer1_gpu2_expert_mlp2</title>
<path fill="none" stroke="black" d="M1831.68,-27302.88C1831.6,-27294.77 1831.51,-27285.98 1831.43,-27277.47"/>
<polygon fill="black" stroke="black" points="1834.92,-27277.26 1831.33,-27267.3 1827.92,-27277.33 1834.92,-27277.26"/>
</g>
<!-- layer1_gpu2_token_send -->
<g id="node114" class="node">
<title>layer1_gpu2_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1830" cy="-27114.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1830" y="-27133.71" font-family="Times,serif" font-size="14.00">Token Send GPU2</text>
<text text-anchor="middle" x="1830" y="-27118.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1830" y="-27103.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1830" y="-27088.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gpu2_expert_mlp2&#45;&gt;layer1_gpu2_token_send -->
<g id="edge130" class="edge">
<title>layer1_gpu2_expert_mlp2&#45;&gt;layer1_gpu2_token_send</title>
<path fill="none" stroke="black" d="M1830.71,-27198.73C1830.64,-27190.74 1830.57,-27181.97 1830.49,-27173.23"/>
<polygon fill="black" stroke="black" points="1833.99,-27172.99 1830.41,-27163.02 1826.99,-27173.05 1833.99,-27172.99"/>
</g>
<!-- layer1_gpu2_token_send&#45;&gt;layer1_expert_agg -->
<g id="edge131" class="edge">
<title>layer1_gpu2_token_send&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2070.48,-27079.45C2111.62,-27074.52 2153.98,-27070.04 2194,-27066.83 3249.04,-26982.25 4499.98,-26966.17 5108.15,-26963.72"/>
<polygon fill="black" stroke="black" points="5108.41,-26967.22 5118.39,-26963.68 5108.38,-26960.22 5108.41,-26967.22"/>
</g>
<!-- layer1_gpu3_expert_mlp1 -->
<g id="node116" class="node">
<title>layer1_gpu3_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2850.5,-27475 2389.5,-27475 2389.5,-27407 2850.5,-27407 2850.5,-27475"/>
<text text-anchor="middle" x="2620" y="-27459.8" font-family="Times,serif" font-size="14.00">Expert 3 MLP1</text>
<text text-anchor="middle" x="2620" y="-27444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2620" y="-27429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2620" y="-27414.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gpu3_token_recv&#45;&gt;layer1_gpu3_expert_mlp1 -->
<g id="edge133" class="edge">
<title>layer1_gpu3_token_recv&#45;&gt;layer1_gpu3_expert_mlp1</title>
<path fill="none" stroke="black" d="M2625.34,-27510.86C2624.69,-27502.48 2624.01,-27493.78 2623.37,-27485.5"/>
<polygon fill="black" stroke="black" points="2626.84,-27485 2622.58,-27475.3 2619.87,-27485.54 2626.84,-27485"/>
</g>
<!-- layer1_gpu3_expert_act -->
<g id="node117" class="node">
<title>layer1_gpu3_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2773.5,-27371 2396.5,-27371 2396.5,-27303 2773.5,-27303 2773.5,-27371"/>
<text text-anchor="middle" x="2585" y="-27355.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="2585" y="-27340.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2585" y="-27325.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2585" y="-27310.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gpu3_expert_mlp1&#45;&gt;layer1_gpu3_expert_act -->
<g id="edge134" class="edge">
<title>layer1_gpu3_expert_mlp1&#45;&gt;layer1_gpu3_expert_act</title>
<path fill="none" stroke="black" d="M2608.64,-27406.88C2605.79,-27398.6 2602.7,-27389.59 2599.72,-27380.91"/>
<polygon fill="black" stroke="black" points="2602.98,-27379.62 2596.43,-27371.3 2596.36,-27381.89 2602.98,-27379.62"/>
</g>
<!-- layer1_gpu3_expert_mlp2 -->
<g id="node118" class="node">
<title>layer1_gpu3_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2779.5,-27267 2372.5,-27267 2372.5,-27199 2779.5,-27199 2779.5,-27267"/>
<text text-anchor="middle" x="2576" y="-27251.8" font-family="Times,serif" font-size="14.00">Expert 3 MLP2</text>
<text text-anchor="middle" x="2576" y="-27236.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2576" y="-27221.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="2576" y="-27206.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gpu3_expert_act&#45;&gt;layer1_gpu3_expert_mlp2 -->
<g id="edge135" class="edge">
<title>layer1_gpu3_expert_act&#45;&gt;layer1_gpu3_expert_mlp2</title>
<path fill="none" stroke="black" d="M2582.08,-27302.88C2581.36,-27294.77 2580.59,-27285.98 2579.84,-27277.47"/>
<polygon fill="black" stroke="black" points="2583.3,-27276.95 2578.94,-27267.3 2576.33,-27277.56 2583.3,-27276.95"/>
</g>
<!-- layer1_gpu3_token_send -->
<g id="node119" class="node">
<title>layer1_gpu3_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="2559" cy="-27114.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="2559" y="-27133.71" font-family="Times,serif" font-size="14.00">Token Send GPU3</text>
<text text-anchor="middle" x="2559" y="-27118.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="2559" y="-27103.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="2559" y="-27088.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gpu3_expert_mlp2&#45;&gt;layer1_gpu3_token_send -->
<g id="edge136" class="edge">
<title>layer1_gpu3_expert_mlp2&#45;&gt;layer1_gpu3_token_send</title>
<path fill="none" stroke="black" d="M2571.13,-27198.73C2569.95,-27190.65 2568.65,-27181.78 2567.35,-27172.94"/>
<polygon fill="black" stroke="black" points="2570.81,-27172.41 2565.9,-27163.02 2563.89,-27173.42 2570.81,-27172.41"/>
</g>
<!-- layer1_gpu3_token_send&#45;&gt;layer1_expert_agg -->
<g id="edge137" class="edge">
<title>layer1_gpu3_token_send&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2800.98,-27079.58C2841.65,-27074.68 2883.48,-27070.18 2923,-27066.83 3702.23,-27000.85 4618.9,-26976.9 5114.54,-26968.38"/>
<polygon fill="black" stroke="black" points="5114.77,-26971.88 5124.71,-26968.21 5114.65,-26964.88 5114.77,-26971.88"/>
</g>
<!-- layer1_gpu4_expert_mlp1 -->
<g id="node121" class="node">
<title>layer1_gpu4_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="3558.5,-27475 3097.5,-27475 3097.5,-27407 3558.5,-27407 3558.5,-27475"/>
<text text-anchor="middle" x="3328" y="-27459.8" font-family="Times,serif" font-size="14.00">Expert 4 MLP1</text>
<text text-anchor="middle" x="3328" y="-27444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3328" y="-27429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3328" y="-27414.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gpu4_token_recv&#45;&gt;layer1_gpu4_expert_mlp1 -->
<g id="edge139" class="edge">
<title>layer1_gpu4_token_recv&#45;&gt;layer1_gpu4_expert_mlp1</title>
<path fill="none" stroke="black" d="M3351.73,-27510.86C3348.78,-27502.29 3345.71,-27493.39 3342.8,-27484.95"/>
<polygon fill="black" stroke="black" points="3346.04,-27483.61 3339.48,-27475.3 3339.42,-27485.89 3346.04,-27483.61"/>
</g>
<!-- layer1_gpu4_expert_act -->
<g id="node122" class="node">
<title>layer1_gpu4_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="3506.5,-27371 3129.5,-27371 3129.5,-27303 3506.5,-27303 3506.5,-27371"/>
<text text-anchor="middle" x="3318" y="-27355.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="3318" y="-27340.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3318" y="-27325.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3318" y="-27310.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gpu4_expert_mlp1&#45;&gt;layer1_gpu4_expert_act -->
<g id="edge140" class="edge">
<title>layer1_gpu4_expert_mlp1&#45;&gt;layer1_gpu4_expert_act</title>
<path fill="none" stroke="black" d="M3324.75,-27406.88C3323.96,-27398.77 3323.1,-27389.98 3322.26,-27381.47"/>
<polygon fill="black" stroke="black" points="3325.72,-27380.91 3321.26,-27371.3 3318.76,-27381.59 3325.72,-27380.91"/>
</g>
<!-- layer1_gpu4_expert_mlp2 -->
<g id="node123" class="node">
<title>layer1_gpu4_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="3501.5,-27267 3094.5,-27267 3094.5,-27199 3501.5,-27199 3501.5,-27267"/>
<text text-anchor="middle" x="3298" y="-27251.8" font-family="Times,serif" font-size="14.00">Expert 4 MLP2</text>
<text text-anchor="middle" x="3298" y="-27236.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3298" y="-27221.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="3298" y="-27206.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gpu4_expert_act&#45;&gt;layer1_gpu4_expert_mlp2 -->
<g id="edge141" class="edge">
<title>layer1_gpu4_expert_act&#45;&gt;layer1_gpu4_expert_mlp2</title>
<path fill="none" stroke="black" d="M3311.51,-27302.88C3309.9,-27294.68 3308.15,-27285.78 3306.47,-27277.19"/>
<polygon fill="black" stroke="black" points="3309.89,-27276.43 3304.53,-27267.3 3303.02,-27277.78 3309.89,-27276.43"/>
</g>
<!-- layer1_gpu4_token_send -->
<g id="node124" class="node">
<title>layer1_gpu4_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="3288" cy="-27114.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="3288" y="-27133.71" font-family="Times,serif" font-size="14.00">Token Send GPU4</text>
<text text-anchor="middle" x="3288" y="-27118.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="3288" y="-27103.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="3288" y="-27088.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gpu4_expert_mlp2&#45;&gt;layer1_gpu4_token_send -->
<g id="edge142" class="edge">
<title>layer1_gpu4_expert_mlp2&#45;&gt;layer1_gpu4_token_send</title>
<path fill="none" stroke="black" d="M3295.13,-27198.73C3294.45,-27190.74 3293.69,-27181.97 3292.94,-27173.23"/>
<polygon fill="black" stroke="black" points="3296.4,-27172.68 3292.06,-27163.02 3289.43,-27173.29 3296.4,-27172.68"/>
</g>
<!-- layer1_gpu4_token_send&#45;&gt;layer1_expert_agg -->
<g id="edge143" class="edge">
<title>layer1_gpu4_token_send&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3531.99,-27079.88C3572.03,-27075.01 3613.14,-27070.43 3652,-27066.83 4162.99,-27019.42 4756.65,-26990.81 5124.62,-26976.16"/>
<polygon fill="black" stroke="black" points="5124.78,-26979.66 5134.63,-26975.76 5124.5,-26972.66 5124.78,-26979.66"/>
</g>
<!-- layer1_gpu5_expert_mlp1 -->
<g id="node126" class="node">
<title>layer1_gpu5_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4279.5,-27475 3818.5,-27475 3818.5,-27407 4279.5,-27407 4279.5,-27475"/>
<text text-anchor="middle" x="4049" y="-27459.8" font-family="Times,serif" font-size="14.00">Expert 5 MLP1</text>
<text text-anchor="middle" x="4049" y="-27444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4049" y="-27429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4049" y="-27414.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gpu5_token_recv&#45;&gt;layer1_gpu5_expert_mlp1 -->
<g id="edge145" class="edge">
<title>layer1_gpu5_token_recv&#45;&gt;layer1_gpu5_expert_mlp1</title>
<path fill="none" stroke="black" d="M4067.98,-27510.86C4065.62,-27502.29 4063.17,-27493.39 4060.84,-27484.95"/>
<polygon fill="black" stroke="black" points="4064.21,-27484.01 4058.18,-27475.3 4057.46,-27485.87 4064.21,-27484.01"/>
</g>
<!-- layer1_gpu5_expert_act -->
<g id="node127" class="node">
<title>layer1_gpu5_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4229.5,-27371 3852.5,-27371 3852.5,-27303 4229.5,-27303 4229.5,-27371"/>
<text text-anchor="middle" x="4041" y="-27355.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="4041" y="-27340.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4041" y="-27325.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4041" y="-27310.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gpu5_expert_mlp1&#45;&gt;layer1_gpu5_expert_act -->
<g id="edge146" class="edge">
<title>layer1_gpu5_expert_mlp1&#45;&gt;layer1_gpu5_expert_act</title>
<path fill="none" stroke="black" d="M4046.4,-27406.88C4045.77,-27398.77 4045.08,-27389.98 4044.41,-27381.47"/>
<polygon fill="black" stroke="black" points="4047.88,-27380.99 4043.61,-27371.3 4040.9,-27381.54 4047.88,-27380.99"/>
</g>
<!-- layer1_gpu5_expert_mlp2 -->
<g id="node128" class="node">
<title>layer1_gpu5_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4236.5,-27267 3829.5,-27267 3829.5,-27199 4236.5,-27199 4236.5,-27267"/>
<text text-anchor="middle" x="4033" y="-27251.8" font-family="Times,serif" font-size="14.00">Expert 5 MLP2</text>
<text text-anchor="middle" x="4033" y="-27236.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4033" y="-27221.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4033" y="-27206.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gpu5_expert_act&#45;&gt;layer1_gpu5_expert_mlp2 -->
<g id="edge147" class="edge">
<title>layer1_gpu5_expert_act&#45;&gt;layer1_gpu5_expert_mlp2</title>
<path fill="none" stroke="black" d="M4038.4,-27302.88C4037.77,-27294.77 4037.08,-27285.98 4036.41,-27277.47"/>
<polygon fill="black" stroke="black" points="4039.88,-27276.99 4035.61,-27267.3 4032.9,-27277.54 4039.88,-27276.99"/>
</g>
<!-- layer1_gpu5_token_send -->
<g id="node129" class="node">
<title>layer1_gpu5_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4017" cy="-27114.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4017" y="-27133.71" font-family="Times,serif" font-size="14.00">Token Send GPU5</text>
<text text-anchor="middle" x="4017" y="-27118.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4017" y="-27103.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4017" y="-27088.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gpu5_expert_mlp2&#45;&gt;layer1_gpu5_token_send -->
<g id="edge148" class="edge">
<title>layer1_gpu5_expert_mlp2&#45;&gt;layer1_gpu5_token_send</title>
<path fill="none" stroke="black" d="M4028.42,-27198.73C4027.3,-27190.65 4026.08,-27181.78 4024.86,-27172.94"/>
<polygon fill="black" stroke="black" points="4028.33,-27172.45 4023.49,-27163.02 4021.39,-27173.41 4028.33,-27172.45"/>
</g>
<!-- layer1_gpu5_token_send&#45;&gt;layer1_expert_agg -->
<g id="edge149" class="edge">
<title>layer1_gpu5_token_send&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4266.02,-27080.53C4304.5,-27075.71 4343.8,-27070.98 4381,-27066.83 4637.39,-27038.21 4928.13,-27011.13 5145.7,-26991.93"/>
<polygon fill="black" stroke="black" points="5146.03,-26995.42 5155.68,-26991.05 5145.41,-26988.44 5146.03,-26995.42"/>
</g>
<!-- layer1_gpu6_expert_mlp1 -->
<g id="node131" class="node">
<title>layer1_gpu6_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5006.5,-27475 4545.5,-27475 4545.5,-27407 5006.5,-27407 5006.5,-27475"/>
<text text-anchor="middle" x="4776" y="-27459.8" font-family="Times,serif" font-size="14.00">Expert 6 MLP1</text>
<text text-anchor="middle" x="4776" y="-27444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4776" y="-27429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4776" y="-27414.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gpu6_token_recv&#45;&gt;layer1_gpu6_expert_mlp1 -->
<g id="edge151" class="edge">
<title>layer1_gpu6_token_recv&#45;&gt;layer1_gpu6_expert_mlp1</title>
<path fill="none" stroke="black" d="M4778.97,-27510.86C4778.61,-27502.48 4778.23,-27493.78 4777.87,-27485.5"/>
<polygon fill="black" stroke="black" points="4781.36,-27485.14 4777.43,-27475.3 4774.37,-27485.44 4781.36,-27485.14"/>
</g>
<!-- layer1_gpu6_expert_act -->
<g id="node132" class="node">
<title>layer1_gpu6_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4960.5,-27371 4583.5,-27371 4583.5,-27303 4960.5,-27303 4960.5,-27371"/>
<text text-anchor="middle" x="4772" y="-27355.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="4772" y="-27340.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4772" y="-27325.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4772" y="-27310.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gpu6_expert_mlp1&#45;&gt;layer1_gpu6_expert_act -->
<g id="edge152" class="edge">
<title>layer1_gpu6_expert_mlp1&#45;&gt;layer1_gpu6_expert_act</title>
<path fill="none" stroke="black" d="M4774.7,-27406.88C4774.38,-27398.77 4774.04,-27389.98 4773.7,-27381.47"/>
<polygon fill="black" stroke="black" points="4777.2,-27381.15 4773.31,-27371.3 4770.2,-27381.42 4777.2,-27381.15"/>
</g>
<!-- layer1_gpu6_expert_mlp2 -->
<g id="node133" class="node">
<title>layer1_gpu6_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4966.5,-27267 4559.5,-27267 4559.5,-27199 4966.5,-27199 4966.5,-27267"/>
<text text-anchor="middle" x="4763" y="-27251.8" font-family="Times,serif" font-size="14.00">Expert 6 MLP2</text>
<text text-anchor="middle" x="4763" y="-27236.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4763" y="-27221.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4763" y="-27206.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gpu6_expert_act&#45;&gt;layer1_gpu6_expert_mlp2 -->
<g id="edge153" class="edge">
<title>layer1_gpu6_expert_act&#45;&gt;layer1_gpu6_expert_mlp2</title>
<path fill="none" stroke="black" d="M4769.08,-27302.88C4768.36,-27294.77 4767.59,-27285.98 4766.84,-27277.47"/>
<polygon fill="black" stroke="black" points="4770.3,-27276.95 4765.94,-27267.3 4763.33,-27277.56 4770.3,-27276.95"/>
</g>
<!-- layer1_gpu6_token_send -->
<g id="node134" class="node">
<title>layer1_gpu6_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4746" cy="-27114.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4746" y="-27133.71" font-family="Times,serif" font-size="14.00">Token Send GPU6</text>
<text text-anchor="middle" x="4746" y="-27118.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4746" y="-27103.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4746" y="-27088.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gpu6_expert_mlp2&#45;&gt;layer1_gpu6_token_send -->
<g id="edge154" class="edge">
<title>layer1_gpu6_expert_mlp2&#45;&gt;layer1_gpu6_token_send</title>
<path fill="none" stroke="black" d="M4758.13,-27198.73C4756.95,-27190.65 4755.65,-27181.78 4754.35,-27172.94"/>
<polygon fill="black" stroke="black" points="4757.81,-27172.41 4752.9,-27163.02 4750.89,-27173.42 4757.81,-27172.41"/>
</g>
<!-- layer1_gpu6_token_send&#45;&gt;layer1_expert_agg -->
<g id="edge155" class="edge">
<title>layer1_gpu6_token_send&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4938.54,-27074.38C5014.53,-27058.78 5103.48,-27040.52 5186.94,-27023.38"/>
<polygon fill="black" stroke="black" points="5187.74,-27026.79 5196.83,-27021.35 5186.33,-27019.93 5187.74,-27026.79"/>
</g>
<!-- layer1_gpu7_expert_mlp1 -->
<g id="node136" class="node">
<title>layer1_gpu7_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5705.5,-27475 5244.5,-27475 5244.5,-27407 5705.5,-27407 5705.5,-27475"/>
<text text-anchor="middle" x="5475" y="-27459.8" font-family="Times,serif" font-size="14.00">Expert 7 MLP1</text>
<text text-anchor="middle" x="5475" y="-27444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5475" y="-27429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-27414.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gpu7_token_recv&#45;&gt;layer1_gpu7_expert_mlp1 -->
<g id="edge157" class="edge">
<title>layer1_gpu7_token_recv&#45;&gt;layer1_gpu7_expert_mlp1</title>
<path fill="none" stroke="black" d="M5475,-27510.86C5475,-27502.48 5475,-27493.78 5475,-27485.5"/>
<polygon fill="black" stroke="black" points="5478.5,-27485.3 5475,-27475.3 5471.5,-27485.3 5478.5,-27485.3"/>
</g>
<!-- layer1_gpu7_expert_act -->
<g id="node137" class="node">
<title>layer1_gpu7_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="5663.5,-27371 5286.5,-27371 5286.5,-27303 5663.5,-27303 5663.5,-27371"/>
<text text-anchor="middle" x="5475" y="-27355.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="5475" y="-27340.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-27325.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-27310.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gpu7_expert_mlp1&#45;&gt;layer1_gpu7_expert_act -->
<g id="edge158" class="edge">
<title>layer1_gpu7_expert_mlp1&#45;&gt;layer1_gpu7_expert_act</title>
<path fill="none" stroke="black" d="M5475,-27406.88C5475,-27398.77 5475,-27389.98 5475,-27381.47"/>
<polygon fill="black" stroke="black" points="5478.5,-27381.29 5475,-27371.3 5471.5,-27381.3 5478.5,-27381.29"/>
</g>
<!-- layer1_gpu7_expert_mlp2 -->
<g id="node138" class="node">
<title>layer1_gpu7_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="5678.5,-27267 5271.5,-27267 5271.5,-27199 5678.5,-27199 5678.5,-27267"/>
<text text-anchor="middle" x="5475" y="-27251.8" font-family="Times,serif" font-size="14.00">Expert 7 MLP2</text>
<text text-anchor="middle" x="5475" y="-27236.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-27221.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5475" y="-27206.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gpu7_expert_act&#45;&gt;layer1_gpu7_expert_mlp2 -->
<g id="edge159" class="edge">
<title>layer1_gpu7_expert_act&#45;&gt;layer1_gpu7_expert_mlp2</title>
<path fill="none" stroke="black" d="M5475,-27302.88C5475,-27294.77 5475,-27285.98 5475,-27277.47"/>
<polygon fill="black" stroke="black" points="5478.5,-27277.29 5475,-27267.3 5471.5,-27277.3 5478.5,-27277.29"/>
</g>
<!-- layer1_gpu7_token_send -->
<g id="node139" class="node">
<title>layer1_gpu7_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="5475" cy="-27114.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="5475" y="-27133.71" font-family="Times,serif" font-size="14.00">Token Send GPU7</text>
<text text-anchor="middle" x="5475" y="-27118.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="5475" y="-27103.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="5475" y="-27088.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gpu7_expert_mlp2&#45;&gt;layer1_gpu7_token_send -->
<g id="edge160" class="edge">
<title>layer1_gpu7_expert_mlp2&#45;&gt;layer1_gpu7_token_send</title>
<path fill="none" stroke="black" d="M5475,-27198.73C5475,-27190.74 5475,-27181.97 5475,-27173.23"/>
<polygon fill="black" stroke="black" points="5478.5,-27173.02 5475,-27163.02 5471.5,-27173.02 5478.5,-27173.02"/>
</g>
<!-- layer1_gpu7_token_send&#45;&gt;layer1_expert_agg -->
<g id="edge161" class="edge">
<title>layer1_gpu7_token_send&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5475.63,-27066.43C5475.74,-27058.34 5475.85,-27049.76 5475.97,-27041.14"/>
<polygon fill="black" stroke="black" points="5479.47,-27041.07 5476.1,-27031.02 5472.47,-27040.98 5479.47,-27041.07"/>
</g>
<!-- layer1_gpu8_expert_mlp1 -->
<g id="node141" class="node">
<title>layer1_gpu8_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="6399.5,-27475 5938.5,-27475 5938.5,-27407 6399.5,-27407 6399.5,-27475"/>
<text text-anchor="middle" x="6169" y="-27459.8" font-family="Times,serif" font-size="14.00">Expert 8 MLP1</text>
<text text-anchor="middle" x="6169" y="-27444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6169" y="-27429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6169" y="-27414.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_gpu8_token_recv&#45;&gt;layer1_gpu8_expert_mlp1 -->
<g id="edge163" class="edge">
<title>layer1_gpu8_token_recv&#45;&gt;layer1_gpu8_expert_mlp1</title>
<path fill="none" stroke="black" d="M6165.44,-27510.86C6165.87,-27502.48 6166.32,-27493.78 6166.75,-27485.5"/>
<polygon fill="black" stroke="black" points="6170.26,-27485.47 6167.28,-27475.3 6163.27,-27485.11 6170.26,-27485.47"/>
</g>
<!-- layer1_gpu8_expert_act -->
<g id="node142" class="node">
<title>layer1_gpu8_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="6362.5,-27371 5985.5,-27371 5985.5,-27303 6362.5,-27303 6362.5,-27371"/>
<text text-anchor="middle" x="6174" y="-27355.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="6174" y="-27340.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6174" y="-27325.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6174" y="-27310.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_gpu8_expert_mlp1&#45;&gt;layer1_gpu8_expert_act -->
<g id="edge164" class="edge">
<title>layer1_gpu8_expert_mlp1&#45;&gt;layer1_gpu8_expert_act</title>
<path fill="none" stroke="black" d="M6170.62,-27406.88C6171.02,-27398.77 6171.45,-27389.98 6171.87,-27381.47"/>
<polygon fill="black" stroke="black" points="6175.37,-27381.45 6172.37,-27371.3 6168.38,-27381.11 6175.37,-27381.45"/>
</g>
<!-- layer1_gpu8_expert_mlp2 -->
<g id="node143" class="node">
<title>layer1_gpu8_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="6387.5,-27267 5980.5,-27267 5980.5,-27199 6387.5,-27199 6387.5,-27267"/>
<text text-anchor="middle" x="6184" y="-27251.8" font-family="Times,serif" font-size="14.00">Expert 8 MLP2</text>
<text text-anchor="middle" x="6184" y="-27236.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6184" y="-27221.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6184" y="-27206.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_gpu8_expert_act&#45;&gt;layer1_gpu8_expert_mlp2 -->
<g id="edge165" class="edge">
<title>layer1_gpu8_expert_act&#45;&gt;layer1_gpu8_expert_mlp2</title>
<path fill="none" stroke="black" d="M6177.25,-27302.88C6178.04,-27294.77 6178.9,-27285.98 6179.74,-27277.47"/>
<polygon fill="black" stroke="black" points="6183.24,-27277.59 6180.74,-27267.3 6176.28,-27276.91 6183.24,-27277.59"/>
</g>
<!-- layer1_gpu8_token_send -->
<g id="node144" class="node">
<title>layer1_gpu8_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6204" cy="-27114.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6204" y="-27133.71" font-family="Times,serif" font-size="14.00">Token Send GPU8</text>
<text text-anchor="middle" x="6204" y="-27118.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6204" y="-27103.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6204" y="-27088.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_gpu8_expert_mlp2&#45;&gt;layer1_gpu8_token_send -->
<g id="edge166" class="edge">
<title>layer1_gpu8_expert_mlp2&#45;&gt;layer1_gpu8_token_send</title>
<path fill="none" stroke="black" d="M6189.73,-27198.73C6191.12,-27190.65 6192.65,-27181.78 6194.17,-27172.94"/>
<polygon fill="black" stroke="black" points="6197.63,-27173.47 6195.88,-27163.02 6190.74,-27172.28 6197.63,-27173.47"/>
</g>
<!-- layer1_gpu8_token_send&#45;&gt;layer1_expert_agg -->
<g id="edge167" class="edge">
<title>layer1_gpu8_token_send&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M6012.51,-27074.38C5950.86,-27061.65 5880.64,-27047.16 5811.79,-27032.94"/>
<polygon fill="black" stroke="black" points="5812.14,-27029.44 5801.64,-27030.85 5810.73,-27036.3 5812.14,-27029.44"/>
</g>
<!-- layer1_gpu9_expert_mlp1 -->
<g id="node146" class="node">
<title>layer1_gpu9_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7090.5,-27475 6629.5,-27475 6629.5,-27407 7090.5,-27407 7090.5,-27475"/>
<text text-anchor="middle" x="6860" y="-27459.8" font-family="Times,serif" font-size="14.00">Expert 9 MLP1</text>
<text text-anchor="middle" x="6860" y="-27444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6860" y="-27429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6860" y="-27414.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_gpu9_token_recv&#45;&gt;layer1_gpu9_expert_mlp1 -->
<g id="edge169" class="edge">
<title>layer1_gpu9_token_recv&#45;&gt;layer1_gpu9_expert_mlp1</title>
<path fill="none" stroke="black" d="M6854.07,-27510.86C6854.79,-27502.48 6855.54,-27493.78 6856.25,-27485.5"/>
<polygon fill="black" stroke="black" points="6859.76,-27485.56 6857.13,-27475.3 6852.79,-27484.96 6859.76,-27485.56"/>
</g>
<!-- layer1_gpu9_expert_act -->
<g id="node147" class="node">
<title>layer1_gpu9_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7059.5,-27371 6682.5,-27371 6682.5,-27303 7059.5,-27303 7059.5,-27371"/>
<text text-anchor="middle" x="6871" y="-27355.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="6871" y="-27340.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6871" y="-27325.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6871" y="-27310.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_gpu9_expert_mlp1&#45;&gt;layer1_gpu9_expert_act -->
<g id="edge170" class="edge">
<title>layer1_gpu9_expert_mlp1&#45;&gt;layer1_gpu9_expert_act</title>
<path fill="none" stroke="black" d="M6863.57,-27406.88C6864.45,-27398.77 6865.39,-27389.98 6866.31,-27381.47"/>
<polygon fill="black" stroke="black" points="6869.82,-27381.61 6867.41,-27371.3 6862.86,-27380.86 6869.82,-27381.61"/>
</g>
<!-- layer1_gpu9_expert_mlp2 -->
<g id="node148" class="node">
<title>layer1_gpu9_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7095.5,-27267 6688.5,-27267 6688.5,-27199 7095.5,-27199 7095.5,-27267"/>
<text text-anchor="middle" x="6892" y="-27251.8" font-family="Times,serif" font-size="14.00">Expert 9 MLP2</text>
<text text-anchor="middle" x="6892" y="-27236.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6892" y="-27221.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6892" y="-27206.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_gpu9_expert_act&#45;&gt;layer1_gpu9_expert_mlp2 -->
<g id="edge171" class="edge">
<title>layer1_gpu9_expert_act&#45;&gt;layer1_gpu9_expert_mlp2</title>
<path fill="none" stroke="black" d="M6877.82,-27302.88C6879.51,-27294.68 6881.34,-27285.78 6883.11,-27277.19"/>
<polygon fill="black" stroke="black" points="6886.56,-27277.8 6885.14,-27267.3 6879.7,-27276.38 6886.56,-27277.8"/>
</g>
<!-- layer1_gpu9_token_send -->
<g id="node149" class="node">
<title>layer1_gpu9_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6933" cy="-27114.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6933" y="-27133.71" font-family="Times,serif" font-size="14.00">Token Send GPU9</text>
<text text-anchor="middle" x="6933" y="-27118.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6933" y="-27103.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6933" y="-27088.71" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_gpu9_expert_mlp2&#45;&gt;layer1_gpu9_token_send -->
<g id="edge172" class="edge">
<title>layer1_gpu9_expert_mlp2&#45;&gt;layer1_gpu9_token_send</title>
<path fill="none" stroke="black" d="M6903.75,-27198.73C6906.63,-27190.56 6909.8,-27181.59 6912.96,-27172.66"/>
<polygon fill="black" stroke="black" points="6916.33,-27173.62 6916.36,-27163.02 6909.73,-27171.29 6916.33,-27173.62"/>
</g>
<!-- layer1_gpu9_token_send&#45;&gt;layer1_expert_agg -->
<g id="edge173" class="edge">
<title>layer1_gpu9_token_send&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M6683.98,-27080.54C6645.5,-27075.72 6606.2,-27070.99 6569,-27066.83 6347.19,-27042.03 6099.58,-27018.35 5896.29,-26999.96"/>
<polygon fill="black" stroke="black" points="5896.31,-26996.45 5886.03,-26999.03 5895.68,-27003.42 5896.31,-26996.45"/>
</g>
<!-- layer1_gpu10_expert_mlp1 -->
<g id="node151" class="node">
<title>layer1_gpu10_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7783.5,-27475 7322.5,-27475 7322.5,-27407 7783.5,-27407 7783.5,-27475"/>
<text text-anchor="middle" x="7553" y="-27459.8" font-family="Times,serif" font-size="14.00">Expert 10 MLP1</text>
<text text-anchor="middle" x="7553" y="-27444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7553" y="-27429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7553" y="-27414.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_gpu10_token_recv&#45;&gt;layer1_gpu10_expert_mlp1 -->
<g id="edge175" class="edge">
<title>layer1_gpu10_token_recv&#45;&gt;layer1_gpu10_expert_mlp1</title>
<path fill="none" stroke="black" d="M7543.51,-27510.86C7544.68,-27502.38 7545.89,-27493.59 7547.04,-27485.23"/>
<polygon fill="black" stroke="black" points="7550.51,-27485.68 7548.41,-27475.3 7543.58,-27484.73 7550.51,-27485.68"/>
</g>
<!-- layer1_gpu10_expert_act -->
<g id="node152" class="node">
<title>layer1_gpu10_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7772.5,-27371 7395.5,-27371 7395.5,-27303 7772.5,-27303 7772.5,-27371"/>
<text text-anchor="middle" x="7584" y="-27355.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="7584" y="-27340.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7584" y="-27325.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7584" y="-27310.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_gpu10_expert_mlp1&#45;&gt;layer1_gpu10_expert_act -->
<g id="edge176" class="edge">
<title>layer1_gpu10_expert_mlp1&#45;&gt;layer1_gpu10_expert_act</title>
<path fill="none" stroke="black" d="M7563.06,-27406.88C7565.58,-27398.6 7568.32,-27389.59 7570.96,-27380.91"/>
<polygon fill="black" stroke="black" points="7574.32,-27381.88 7573.88,-27371.3 7567.62,-27379.85 7574.32,-27381.88"/>
</g>
<!-- layer1_gpu10_expert_mlp2 -->
<g id="node153" class="node">
<title>layer1_gpu10_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7803.5,-27267 7396.5,-27267 7396.5,-27199 7803.5,-27199 7803.5,-27267"/>
<text text-anchor="middle" x="7600" y="-27251.8" font-family="Times,serif" font-size="14.00">Expert 10 MLP2</text>
<text text-anchor="middle" x="7600" y="-27236.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7600" y="-27221.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="7600" y="-27206.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_gpu10_expert_act&#45;&gt;layer1_gpu10_expert_mlp2 -->
<g id="edge177" class="edge">
<title>layer1_gpu10_expert_act&#45;&gt;layer1_gpu10_expert_mlp2</title>
<path fill="none" stroke="black" d="M7589.19,-27302.88C7590.48,-27294.68 7591.88,-27285.78 7593.22,-27277.19"/>
<polygon fill="black" stroke="black" points="7596.68,-27277.72 7594.78,-27267.3 7589.77,-27276.63 7596.68,-27277.72"/>
</g>
<!-- layer1_gpu10_token_send -->
<g id="node154" class="node">
<title>layer1_gpu10_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="7662" cy="-27114.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="7662" y="-27133.71" font-family="Times,serif" font-size="14.00">Token Send GPU10</text>
<text text-anchor="middle" x="7662" y="-27118.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="7662" y="-27103.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="7662" y="-27088.71" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_gpu10_expert_mlp2&#45;&gt;layer1_gpu10_token_send -->
<g id="edge178" class="edge">
<title>layer1_gpu10_expert_mlp2&#45;&gt;layer1_gpu10_token_send</title>
<path fill="none" stroke="black" d="M7617.77,-27198.73C7622.22,-27190.39 7627.13,-27181.21 7632,-27172.09"/>
<polygon fill="black" stroke="black" points="7635.21,-27173.49 7636.84,-27163.02 7629.04,-27170.19 7635.21,-27173.49"/>
</g>
<!-- layer1_gpu10_token_send&#45;&gt;layer1_expert_agg -->
<g id="edge179" class="edge">
<title>layer1_gpu10_token_send&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M7418.01,-27079.89C7377.96,-27075.01 7336.86,-27070.44 7298,-27066.83 6805.31,-27021.09 6235.61,-26992.81 5866.49,-26977.72"/>
<polygon fill="black" stroke="black" points="5866.58,-26974.22 5856.44,-26977.31 5866.29,-26981.22 5866.58,-26974.22"/>
</g>
<!-- layer1_gpu11_expert_mlp1 -->
<g id="node156" class="node">
<title>layer1_gpu11_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="8475.5,-27475 8014.5,-27475 8014.5,-27407 8475.5,-27407 8475.5,-27475"/>
<text text-anchor="middle" x="8245" y="-27459.8" font-family="Times,serif" font-size="14.00">Expert 11 MLP1</text>
<text text-anchor="middle" x="8245" y="-27444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8245" y="-27429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8245" y="-27414.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_gpu11_token_recv&#45;&gt;layer1_gpu11_expert_mlp1 -->
<g id="edge181" class="edge">
<title>layer1_gpu11_token_recv&#45;&gt;layer1_gpu11_expert_mlp1</title>
<path fill="none" stroke="black" d="M8232.54,-27510.86C8234.08,-27502.38 8235.67,-27493.59 8237.18,-27485.23"/>
<polygon fill="black" stroke="black" points="8240.64,-27485.76 8238.98,-27475.3 8233.75,-27484.52 8240.64,-27485.76"/>
</g>
<!-- layer1_gpu11_expert_act -->
<g id="node157" class="node">
<title>layer1_gpu11_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="8454.5,-27371 8077.5,-27371 8077.5,-27303 8454.5,-27303 8454.5,-27371"/>
<text text-anchor="middle" x="8266" y="-27355.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="8266" y="-27340.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8266" y="-27325.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8266" y="-27310.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_gpu11_expert_mlp1&#45;&gt;layer1_gpu11_expert_act -->
<g id="edge182" class="edge">
<title>layer1_gpu11_expert_mlp1&#45;&gt;layer1_gpu11_expert_act</title>
<path fill="none" stroke="black" d="M8251.82,-27406.88C8253.51,-27398.68 8255.34,-27389.78 8257.11,-27381.19"/>
<polygon fill="black" stroke="black" points="8260.56,-27381.8 8259.14,-27371.3 8253.7,-27380.38 8260.56,-27381.8"/>
</g>
<!-- layer1_gpu11_expert_mlp2 -->
<g id="node158" class="node">
<title>layer1_gpu11_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="8552.5,-27267 8145.5,-27267 8145.5,-27199 8552.5,-27199 8552.5,-27267"/>
<text text-anchor="middle" x="8349" y="-27251.8" font-family="Times,serif" font-size="14.00">Expert 11 MLP2</text>
<text text-anchor="middle" x="8349" y="-27236.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8349" y="-27221.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="8349" y="-27206.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_gpu11_expert_act&#45;&gt;layer1_gpu11_expert_mlp2 -->
<g id="edge183" class="edge">
<title>layer1_gpu11_expert_act&#45;&gt;layer1_gpu11_expert_mlp2</title>
<path fill="none" stroke="black" d="M8292.95,-27302.88C8300.12,-27294.06 8307.96,-27284.43 8315.45,-27275.23"/>
<polygon fill="black" stroke="black" points="8318.31,-27277.26 8321.9,-27267.3 8312.88,-27272.84 8318.31,-27277.26"/>
</g>
<!-- layer1_gpu11_token_send -->
<g id="node159" class="node">
<title>layer1_gpu11_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="8391" cy="-27114.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="8391" y="-27133.71" font-family="Times,serif" font-size="14.00">Token Send GPU11</text>
<text text-anchor="middle" x="8391" y="-27118.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="8391" y="-27103.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="8391" y="-27088.71" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_gpu11_expert_mlp2&#45;&gt;layer1_gpu11_token_send -->
<g id="edge184" class="edge">
<title>layer1_gpu11_expert_mlp2&#45;&gt;layer1_gpu11_token_send</title>
<path fill="none" stroke="black" d="M8361.04,-27198.73C8363.99,-27190.56 8367.24,-27181.59 8370.47,-27172.66"/>
<polygon fill="black" stroke="black" points="8373.84,-27173.62 8373.96,-27163.02 8367.26,-27171.23 8373.84,-27173.62"/>
</g>
<!-- layer1_gpu11_token_send&#45;&gt;layer1_expert_agg -->
<g id="edge185" class="edge">
<title>layer1_gpu11_token_send&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M8149.02,-27079.58C8108.35,-27074.68 8066.52,-27070.18 8027,-27066.83 7257.21,-27001.62 6353.08,-26977.46 5854.72,-26968.68"/>
<polygon fill="black" stroke="black" points="5854.55,-26965.18 5844.49,-26968.5 5854.43,-26972.17 5854.55,-26965.18"/>
</g>
<!-- layer1_gpu12_expert_mlp1 -->
<g id="node161" class="node">
<title>layer1_gpu12_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9258.5,-27475 8797.5,-27475 8797.5,-27407 9258.5,-27407 9258.5,-27475"/>
<text text-anchor="middle" x="9028" y="-27459.8" font-family="Times,serif" font-size="14.00">Expert 12 MLP1</text>
<text text-anchor="middle" x="9028" y="-27444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9028" y="-27429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9028" y="-27414.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_gpu12_token_recv&#45;&gt;layer1_gpu12_expert_mlp1 -->
<g id="edge187" class="edge">
<title>layer1_gpu12_token_recv&#45;&gt;layer1_gpu12_expert_mlp1</title>
<path fill="none" stroke="black" d="M8958.25,-27511.2C8967.86,-27501.66 8977.89,-27491.71 8987.25,-27482.43"/>
<polygon fill="black" stroke="black" points="8989.96,-27484.67 8994.59,-27475.14 8985.03,-27479.7 8989.96,-27484.67"/>
</g>
<!-- layer1_gpu12_expert_act -->
<g id="node162" class="node">
<title>layer1_gpu12_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9230.5,-27371 8853.5,-27371 8853.5,-27303 9230.5,-27303 9230.5,-27371"/>
<text text-anchor="middle" x="9042" y="-27355.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="9042" y="-27340.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9042" y="-27325.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9042" y="-27310.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_gpu12_expert_mlp1&#45;&gt;layer1_gpu12_expert_act -->
<g id="edge188" class="edge">
<title>layer1_gpu12_expert_mlp1&#45;&gt;layer1_gpu12_expert_act</title>
<path fill="none" stroke="black" d="M9032.55,-27406.88C9033.66,-27398.77 9034.87,-27389.98 9036.03,-27381.47"/>
<polygon fill="black" stroke="black" points="9039.54,-27381.68 9037.43,-27371.3 9032.6,-27380.73 9039.54,-27381.68"/>
</g>
<!-- layer1_gpu12_expert_mlp2 -->
<g id="node163" class="node">
<title>layer1_gpu12_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9297.5,-27267 8890.5,-27267 8890.5,-27199 9297.5,-27199 9297.5,-27267"/>
<text text-anchor="middle" x="9094" y="-27251.8" font-family="Times,serif" font-size="14.00">Expert 12 MLP2</text>
<text text-anchor="middle" x="9094" y="-27236.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9094" y="-27221.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9094" y="-27206.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_gpu12_expert_act&#45;&gt;layer1_gpu12_expert_mlp2 -->
<g id="edge189" class="edge">
<title>layer1_gpu12_expert_act&#45;&gt;layer1_gpu12_expert_mlp2</title>
<path fill="none" stroke="black" d="M9058.88,-27302.88C9063.2,-27294.42 9067.89,-27285.2 9072.41,-27276.35"/>
<polygon fill="black" stroke="black" points="9075.6,-27277.79 9077.02,-27267.3 9069.36,-27274.61 9075.6,-27277.79"/>
</g>
<!-- layer1_gpu12_token_send -->
<g id="node164" class="node">
<title>layer1_gpu12_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9120" cy="-27114.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9120" y="-27133.71" font-family="Times,serif" font-size="14.00">Token Send GPU12</text>
<text text-anchor="middle" x="9120" y="-27118.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9120" y="-27103.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9120" y="-27088.71" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_gpu12_expert_mlp2&#45;&gt;layer1_gpu12_token_send -->
<g id="edge190" class="edge">
<title>layer1_gpu12_expert_mlp2&#45;&gt;layer1_gpu12_token_send</title>
<path fill="none" stroke="black" d="M9101.45,-27198.73C9103.26,-27190.65 9105.25,-27181.78 9107.23,-27172.94"/>
<polygon fill="black" stroke="black" points="9110.68,-27173.55 9109.45,-27163.02 9103.85,-27172.02 9110.68,-27173.55"/>
</g>
<!-- layer1_gpu12_token_send&#45;&gt;layer1_expert_agg -->
<g id="edge191" class="edge">
<title>layer1_gpu12_token_send&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M8879.52,-27079.45C8838.38,-27074.52 8796.02,-27070.04 8756,-27066.83 7703.84,-26982.46 6456.59,-26966.26 5848.15,-26963.75"/>
<polygon fill="black" stroke="black" points="5847.92,-26960.25 5837.9,-26963.71 5847.89,-26967.25 5847.92,-26960.25"/>
</g>
<!-- layer1_gpu13_expert_mlp1 -->
<g id="node166" class="node">
<title>layer1_gpu13_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9841.5,-27475 9380.5,-27475 9380.5,-27407 9841.5,-27407 9841.5,-27475"/>
<text text-anchor="middle" x="9611" y="-27459.8" font-family="Times,serif" font-size="14.00">Expert 13 MLP1</text>
<text text-anchor="middle" x="9611" y="-27444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9611" y="-27429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9611" y="-27414.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_gpu13_token_recv&#45;&gt;layer1_gpu13_expert_mlp1 -->
<g id="edge193" class="edge">
<title>layer1_gpu13_token_recv&#45;&gt;layer1_gpu13_expert_mlp1</title>
<path fill="none" stroke="black" d="M9603.29,-27510.86C9604.23,-27502.48 9605.2,-27493.78 9606.13,-27485.5"/>
<polygon fill="black" stroke="black" points="9609.64,-27485.63 9607.27,-27475.3 9602.68,-27484.85 9609.64,-27485.63"/>
</g>
<!-- layer1_gpu13_expert_act -->
<g id="node167" class="node">
<title>layer1_gpu13_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9849.5,-27371 9472.5,-27371 9472.5,-27303 9849.5,-27303 9849.5,-27371"/>
<text text-anchor="middle" x="9661" y="-27355.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="9661" y="-27340.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9661" y="-27325.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9661" y="-27310.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_gpu13_expert_mlp1&#45;&gt;layer1_gpu13_expert_act -->
<g id="edge194" class="edge">
<title>layer1_gpu13_expert_mlp1&#45;&gt;layer1_gpu13_expert_act</title>
<path fill="none" stroke="black" d="M9627.23,-27406.88C9631.38,-27398.42 9635.9,-27389.2 9640.24,-27380.35"/>
<polygon fill="black" stroke="black" points="9643.42,-27381.81 9644.68,-27371.3 9637.13,-27378.73 9643.42,-27381.81"/>
</g>
<!-- layer1_gpu13_expert_mlp2 -->
<g id="node168" class="node">
<title>layer1_gpu13_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9989.5,-27267 9582.5,-27267 9582.5,-27199 9989.5,-27199 9989.5,-27267"/>
<text text-anchor="middle" x="9786" y="-27251.8" font-family="Times,serif" font-size="14.00">Expert 13 MLP2</text>
<text text-anchor="middle" x="9786" y="-27236.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9786" y="-27221.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9786" y="-27206.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_gpu13_expert_act&#45;&gt;layer1_gpu13_expert_mlp2 -->
<g id="edge195" class="edge">
<title>layer1_gpu13_expert_act&#45;&gt;layer1_gpu13_expert_mlp2</title>
<path fill="none" stroke="black" d="M9701.58,-27302.88C9712.94,-27293.62 9725.39,-27283.45 9737.17,-27273.84"/>
<polygon fill="black" stroke="black" points="9739.66,-27276.33 9745.19,-27267.3 9735.23,-27270.91 9739.66,-27276.33"/>
</g>
<!-- layer1_gpu13_token_send -->
<g id="node169" class="node">
<title>layer1_gpu13_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9849" cy="-27114.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9849" y="-27133.71" font-family="Times,serif" font-size="14.00">Token Send GPU13</text>
<text text-anchor="middle" x="9849" y="-27118.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9849" y="-27103.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9849" y="-27088.71" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_gpu13_expert_mlp2&#45;&gt;layer1_gpu13_token_send -->
<g id="edge196" class="edge">
<title>layer1_gpu13_expert_mlp2&#45;&gt;layer1_gpu13_token_send</title>
<path fill="none" stroke="black" d="M9804.05,-27198.73C9808.58,-27190.39 9813.56,-27181.21 9818.51,-27172.09"/>
<polygon fill="black" stroke="black" points="9821.74,-27173.48 9823.43,-27163.02 9815.59,-27170.14 9821.74,-27173.48"/>
</g>
<!-- layer1_gpu13_token_send&#45;&gt;layer1_expert_agg -->
<g id="edge197" class="edge">
<title>layer1_gpu13_token_send&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M9609.02,-27079.32C9567.73,-27074.38 9525.18,-27069.94 9485,-27066.83 8787.13,-27012.87 6712.07,-26980.12 5854.42,-26968.56"/>
<polygon fill="black" stroke="black" points="5854.44,-26965.06 5844.39,-26968.43 5854.34,-26972.06 5854.44,-26965.06"/>
</g>
<!-- layer1_gpu14_expert_mlp1 -->
<g id="node171" class="node">
<title>layer1_gpu14_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="10623.5,-27475 10162.5,-27475 10162.5,-27407 10623.5,-27407 10623.5,-27475"/>
<text text-anchor="middle" x="10393" y="-27459.8" font-family="Times,serif" font-size="14.00">Expert 14 MLP1</text>
<text text-anchor="middle" x="10393" y="-27444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10393" y="-27429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10393" y="-27414.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_gpu14_token_recv&#45;&gt;layer1_gpu14_expert_mlp1 -->
<g id="edge199" class="edge">
<title>layer1_gpu14_token_recv&#45;&gt;layer1_gpu14_expert_mlp1</title>
<path fill="none" stroke="black" d="M10328.62,-27511.2C10337.4,-27501.76 10346.56,-27491.91 10355.13,-27482.7"/>
<polygon fill="black" stroke="black" points="10357.91,-27484.85 10362.16,-27475.14 10352.79,-27480.08 10357.91,-27484.85"/>
</g>
<!-- layer1_gpu14_expert_act -->
<g id="node172" class="node">
<title>layer1_gpu14_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="10762.5,-27371 10385.5,-27371 10385.5,-27303 10762.5,-27303 10762.5,-27371"/>
<text text-anchor="middle" x="10574" y="-27355.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="10574" y="-27340.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10574" y="-27325.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10574" y="-27310.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_gpu14_expert_mlp1&#45;&gt;layer1_gpu14_expert_act -->
<g id="edge200" class="edge">
<title>layer1_gpu14_expert_mlp1&#45;&gt;layer1_gpu14_expert_act</title>
<path fill="none" stroke="black" d="M10451.77,-27406.88C10469.08,-27397.12 10488.17,-27386.36 10506.02,-27376.31"/>
<polygon fill="black" stroke="black" points="10508.23,-27379.08 10515.22,-27371.12 10504.79,-27372.98 10508.23,-27379.08"/>
</g>
<!-- layer1_gpu14_expert_mlp2 -->
<g id="node173" class="node">
<title>layer1_gpu14_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10777.5,-27267 10370.5,-27267 10370.5,-27199 10777.5,-27199 10777.5,-27267"/>
<text text-anchor="middle" x="10574" y="-27251.8" font-family="Times,serif" font-size="14.00">Expert 14 MLP2</text>
<text text-anchor="middle" x="10574" y="-27236.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10574" y="-27221.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="10574" y="-27206.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_gpu14_expert_act&#45;&gt;layer1_gpu14_expert_mlp2 -->
<g id="edge201" class="edge">
<title>layer1_gpu14_expert_act&#45;&gt;layer1_gpu14_expert_mlp2</title>
<path fill="none" stroke="black" d="M10574,-27302.88C10574,-27294.77 10574,-27285.98 10574,-27277.47"/>
<polygon fill="black" stroke="black" points="10577.5,-27277.29 10574,-27267.3 10570.5,-27277.3 10577.5,-27277.29"/>
</g>
<!-- layer1_gpu14_token_send -->
<g id="node174" class="node">
<title>layer1_gpu14_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="10578" cy="-27114.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="10578" y="-27133.71" font-family="Times,serif" font-size="14.00">Token Send GPU14</text>
<text text-anchor="middle" x="10578" y="-27118.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="10578" y="-27103.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="10578" y="-27088.71" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_gpu14_expert_mlp2&#45;&gt;layer1_gpu14_token_send -->
<g id="edge202" class="edge">
<title>layer1_gpu14_expert_mlp2&#45;&gt;layer1_gpu14_token_send</title>
<path fill="none" stroke="black" d="M10575.15,-27198.73C10575.42,-27190.74 10575.72,-27181.97 10576.03,-27173.23"/>
<polygon fill="black" stroke="black" points="10579.53,-27173.14 10576.38,-27163.02 10572.53,-27172.9 10579.53,-27173.14"/>
</g>
<!-- layer1_gpu14_token_send&#45;&gt;layer1_expert_agg -->
<g id="edge203" class="edge">
<title>layer1_gpu14_token_send&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M10339.01,-27079.3C10297.41,-27074.33 10254.51,-27069.88 10214,-27066.83 9369.31,-27003.2 6817.75,-26975.29 5852.45,-26966.8"/>
<polygon fill="black" stroke="black" points="5852.26,-26963.3 5842.22,-26966.71 5852.19,-26970.3 5852.26,-26963.3"/>
</g>
<!-- layer1_gpu15_expert_mlp1 -->
<g id="node176" class="node">
<title>layer1_gpu15_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="11206.5,-27475 10745.5,-27475 10745.5,-27407 11206.5,-27407 11206.5,-27475"/>
<text text-anchor="middle" x="10976" y="-27459.8" font-family="Times,serif" font-size="14.00">Expert 15 MLP1</text>
<text text-anchor="middle" x="10976" y="-27444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10976" y="-27429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10976" y="-27414.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_gpu15_token_recv&#45;&gt;layer1_gpu15_expert_mlp1 -->
<g id="edge205" class="edge">
<title>layer1_gpu15_token_recv&#45;&gt;layer1_gpu15_expert_mlp1</title>
<path fill="none" stroke="black" d="M10973.63,-27510.86C10973.92,-27502.48 10974.22,-27493.78 10974.5,-27485.5"/>
<polygon fill="black" stroke="black" points="10978.01,-27485.41 10974.85,-27475.3 10971.01,-27485.17 10978.01,-27485.41"/>
</g>
<!-- layer1_gpu15_expert_act -->
<g id="node177" class="node">
<title>layer1_gpu15_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="11172.5,-27371 10795.5,-27371 10795.5,-27303 11172.5,-27303 11172.5,-27371"/>
<text text-anchor="middle" x="10984" y="-27355.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="10984" y="-27340.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10984" y="-27325.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10984" y="-27310.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_gpu15_expert_mlp1&#45;&gt;layer1_gpu15_expert_act -->
<g id="edge206" class="edge">
<title>layer1_gpu15_expert_mlp1&#45;&gt;layer1_gpu15_expert_act</title>
<path fill="none" stroke="black" d="M10978.6,-27406.88C10979.23,-27398.77 10979.92,-27389.98 10980.59,-27381.47"/>
<polygon fill="black" stroke="black" points="10984.1,-27381.54 10981.39,-27371.3 10977.12,-27380.99 10984.1,-27381.54"/>
</g>
<!-- layer1_gpu15_expert_mlp2 -->
<g id="node178" class="node">
<title>layer1_gpu15_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="11362.5,-27267 10955.5,-27267 10955.5,-27199 11362.5,-27199 11362.5,-27267"/>
<text text-anchor="middle" x="11159" y="-27251.8" font-family="Times,serif" font-size="14.00">Expert 15 MLP2</text>
<text text-anchor="middle" x="11159" y="-27236.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11159" y="-27221.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="11159" y="-27206.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_gpu15_expert_act&#45;&gt;layer1_gpu15_expert_mlp2 -->
<g id="edge207" class="edge">
<title>layer1_gpu15_expert_act&#45;&gt;layer1_gpu15_expert_mlp2</title>
<path fill="none" stroke="black" d="M11040.82,-27302.88C11057.56,-27293.12 11076.02,-27282.36 11093.27,-27272.31"/>
<polygon fill="black" stroke="black" points="11095.29,-27275.18 11102.17,-27267.12 11091.77,-27269.13 11095.29,-27275.18"/>
</g>
<!-- layer1_gpu15_token_send -->
<g id="node179" class="node">
<title>layer1_gpu15_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="11307" cy="-27114.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="11307" y="-27133.71" font-family="Times,serif" font-size="14.00">Token Send GPU15</text>
<text text-anchor="middle" x="11307" y="-27118.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="11307" y="-27103.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="11307" y="-27088.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_gpu15_expert_mlp2&#45;&gt;layer1_gpu15_token_send -->
<g id="edge208" class="edge">
<title>layer1_gpu15_expert_mlp2&#45;&gt;layer1_gpu15_token_send</title>
<path fill="none" stroke="black" d="M11201.41,-27198.73C11213.37,-27189.35 11226.67,-27178.92 11239.7,-27168.7"/>
<polygon fill="black" stroke="black" points="11242.06,-27171.3 11247.76,-27162.37 11237.74,-27165.79 11242.06,-27171.3"/>
</g>
<!-- layer1_gpu15_token_send&#45;&gt;layer1_expert_agg -->
<g id="edge209" class="edge">
<title>layer1_gpu15_token_send&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M11068.02,-27079.2C11026.42,-27074.24 10983.51,-27069.82 10943,-27066.83 9950.22,-26993.49 6914.36,-26971.18 5850.26,-26965.52"/>
<polygon fill="black" stroke="black" points="5850.17,-26962.02 5840.15,-26965.46 5850.13,-26969.02 5850.17,-26962.02"/>
</g>
<!-- layer1_residual2 -->
<g id="node181" class="node">
<title>layer1_residual2</title>
<polygon fill="lightyellow" stroke="black" points="5919.89,-26858.83 5215.35,-26858.83 5034.11,-26722.83 5738.65,-26722.83 5919.89,-26858.83"/>
<text text-anchor="middle" x="5477" y="-26809.63" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="5477" y="-26794.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5477" y="-26779.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-26764.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer1_expert_agg&#45;&gt;layer1_residual2 -->
<g id="edge210" class="edge">
<title>layer1_expert_agg&#45;&gt;layer1_residual2</title>
<path fill="none" stroke="black" d="M5477,-26894.64C5477,-26886.33 5477,-26877.78 5477,-26869.32"/>
<polygon fill="black" stroke="black" points="5480.5,-26869.09 5477,-26859.09 5473.5,-26869.09 5480.5,-26869.09"/>
</g>
<!-- layer2_layernorm -->
<g id="node182" class="node">
<title>layer2_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="5680.5,-26675.83 5273.5,-26675.83 5273.5,-26607.83 5680.5,-26607.83 5680.5,-26675.83"/>
<text text-anchor="middle" x="5477" y="-26660.63" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5477" y="-26645.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-26630.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-26615.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer1_residual2&#45;&gt;layer2_layernorm -->
<g id="edge211" class="edge">
<title>layer1_residual2&#45;&gt;layer2_layernorm</title>
<path fill="none" stroke="black" d="M5477,-26722.78C5477,-26710.38 5477,-26697.72 5477,-26686.25"/>
<polygon fill="black" stroke="black" points="5480.5,-26686.09 5477,-26676.09 5473.5,-26686.09 5480.5,-26686.09"/>
</g>
<!-- layer2_qkv_proj -->
<g id="node183" class="node">
<title>layer2_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="5734.5,-26571.83 5219.5,-26571.83 5219.5,-26503.83 5734.5,-26503.83 5734.5,-26571.83"/>
<text text-anchor="middle" x="5477" y="-26556.63" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5477" y="-26541.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-26526.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5477" y="-26511.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer2_layernorm&#45;&gt;layer2_qkv_proj -->
<g id="edge212" class="edge">
<title>layer2_layernorm&#45;&gt;layer2_qkv_proj</title>
<path fill="none" stroke="black" d="M5477,-26607.71C5477,-26599.61 5477,-26590.81 5477,-26582.3"/>
<polygon fill="black" stroke="black" points="5480.5,-26582.13 5477,-26572.13 5473.5,-26582.13 5480.5,-26582.13"/>
</g>
<!-- layer2_attention -->
<g id="node184" class="node">
<title>layer2_attention</title>
<polygon fill="lightgreen" stroke="black" points="5728.5,-26467.83 5225.5,-26467.83 5225.5,-26399.83 5728.5,-26399.83 5728.5,-26467.83"/>
<text text-anchor="middle" x="5477" y="-26452.63" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5477" y="-26437.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5477" y="-26422.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5477" y="-26407.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer2_qkv_proj&#45;&gt;layer2_attention -->
<g id="edge213" class="edge">
<title>layer2_qkv_proj&#45;&gt;layer2_attention</title>
<path fill="none" stroke="black" d="M5477,-26503.71C5477,-26495.61 5477,-26486.81 5477,-26478.3"/>
<polygon fill="black" stroke="black" points="5480.5,-26478.13 5477,-26468.13 5473.5,-26478.13 5480.5,-26478.13"/>
</g>
<!-- layer2_attn_out -->
<g id="node185" class="node">
<title>layer2_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="5715.5,-26363.83 5238.5,-26363.83 5238.5,-26295.83 5715.5,-26295.83 5715.5,-26363.83"/>
<text text-anchor="middle" x="5477" y="-26348.63" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5477" y="-26333.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5477" y="-26318.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-26303.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer2_attention&#45;&gt;layer2_attn_out -->
<g id="edge214" class="edge">
<title>layer2_attention&#45;&gt;layer2_attn_out</title>
<path fill="none" stroke="black" d="M5477,-26399.71C5477,-26391.61 5477,-26382.81 5477,-26374.3"/>
<polygon fill="black" stroke="black" points="5480.5,-26374.13 5477,-26364.13 5473.5,-26374.13 5480.5,-26374.13"/>
</g>
<!-- layer2_residual1 -->
<g id="node186" class="node">
<title>layer2_residual1</title>
<polygon fill="lightyellow" stroke="black" points="5919.89,-26259.83 5215.35,-26259.83 5034.11,-26123.83 5738.65,-26123.83 5919.89,-26259.83"/>
<text text-anchor="middle" x="5477" y="-26210.63" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5477" y="-26195.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5477" y="-26180.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-26165.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer2_attn_out&#45;&gt;layer2_residual1 -->
<g id="edge215" class="edge">
<title>layer2_attn_out&#45;&gt;layer2_residual1</title>
<path fill="none" stroke="black" d="M5477,-26295.56C5477,-26287.73 5477,-26279.07 5477,-26270.18"/>
<polygon fill="black" stroke="black" points="5480.5,-26270.09 5477,-26260.09 5473.5,-26270.09 5480.5,-26270.09"/>
</g>
<!-- layer2_layernorm2 -->
<g id="node187" class="node">
<title>layer2_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="5680.5,-26087.83 5273.5,-26087.83 5273.5,-26019.83 5680.5,-26019.83 5680.5,-26087.83"/>
<text text-anchor="middle" x="5477" y="-26072.63" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5477" y="-26057.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-26042.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-26027.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer2_residual1&#45;&gt;layer2_layernorm2 -->
<g id="edge216" class="edge">
<title>layer2_residual1&#45;&gt;layer2_layernorm2</title>
<path fill="none" stroke="black" d="M5477,-26123.63C5477,-26114.87 5477,-26106.1 5477,-26097.9"/>
<polygon fill="black" stroke="black" points="5480.5,-26097.85 5477,-26087.85 5473.5,-26097.85 5480.5,-26097.85"/>
</g>
<!-- layer2_global_gate -->
<g id="node188" class="node">
<title>layer2_global_gate</title>
<polygon fill="lightgreen" stroke="black" points="5674.5,-25983.83 5279.5,-25983.83 5279.5,-25915.83 5674.5,-25915.83 5674.5,-25983.83"/>
<text text-anchor="middle" x="5477" y="-25968.63" font-family="Times,serif" font-size="14.00">Global Gate</text>
<text text-anchor="middle" x="5477" y="-25953.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-25938.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, experts=64]</text>
<text text-anchor="middle" x="5477" y="-25923.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer2_layernorm2&#45;&gt;layer2_global_gate -->
<g id="edge217" class="edge">
<title>layer2_layernorm2&#45;&gt;layer2_global_gate</title>
<path fill="none" stroke="black" d="M5477,-26019.71C5477,-26011.61 5477,-26002.81 5477,-25994.3"/>
<polygon fill="black" stroke="black" points="5480.5,-25994.13 5477,-25984.13 5473.5,-25994.13 5480.5,-25994.13"/>
</g>
<!-- layer2_routing -->
<g id="node189" class="node">
<title>layer2_routing</title>
<polygon fill="lightyellow" stroke="black" points="5963.47,-25879.83 5189.6,-25879.83 4990.53,-25743.83 5764.4,-25743.83 5963.47,-25879.83"/>
<text text-anchor="middle" x="5477" y="-25830.63" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="5477" y="-25815.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-25800.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5477" y="-25785.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer2_global_gate&#45;&gt;layer2_routing -->
<g id="edge218" class="edge">
<title>layer2_global_gate&#45;&gt;layer2_routing</title>
<path fill="none" stroke="black" d="M5477,-25915.56C5477,-25907.73 5477,-25899.07 5477,-25890.18"/>
<polygon fill="black" stroke="black" points="5480.5,-25890.09 5477,-25880.09 5473.5,-25890.09 5480.5,-25890.09"/>
</g>
<!-- layer2_gpu0_token_recv -->
<g id="node190" class="node">
<title>layer2_gpu0_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="377" cy="-25659.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="377" y="-25678.55" font-family="Times,serif" font-size="14.00">Token Receive GPU0</text>
<text text-anchor="middle" x="377" y="-25663.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="377" y="-25648.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="377" y="-25633.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_routing&#45;&gt;layer2_gpu0_token_recv -->
<g id="edge219" class="edge">
<title>layer2_routing&#45;&gt;layer2_gpu0_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5089.66,-25811.74C4296.62,-25811.5 2431.01,-25800.11 868,-25707.83 797.17,-25703.65 720.76,-25697.24 649.8,-25690.49"/>
<polygon fill="black" stroke="black" points="650.11,-25687 639.82,-25689.53 649.44,-25693.97 650.11,-25687"/>
</g>
<!-- layer2_gpu1_token_recv -->
<g id="node195" class="node">
<title>layer2_gpu1_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1211" cy="-25659.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1211" y="-25678.55" font-family="Times,serif" font-size="14.00">Token Receive GPU1</text>
<text text-anchor="middle" x="1211" y="-25663.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1211" y="-25648.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1211" y="-25633.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_routing&#45;&gt;layer2_gpu1_token_recv -->
<g id="edge225" class="edge">
<title>layer2_routing&#45;&gt;layer2_gpu1_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5089.26,-25811.42C4394.56,-25810.04 2892.1,-25795.94 1628,-25707.83 1576.28,-25704.22 1521.09,-25698.98 1468.36,-25693.3"/>
<polygon fill="black" stroke="black" points="1468.51,-25689.79 1458.19,-25692.19 1467.76,-25696.75 1468.51,-25689.79"/>
</g>
<!-- layer2_gpu2_token_recv -->
<g id="node200" class="node">
<title>layer2_gpu2_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1971" cy="-25659.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1971" y="-25678.55" font-family="Times,serif" font-size="14.00">Token Receive GPU2</text>
<text text-anchor="middle" x="1971" y="-25663.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1971" y="-25648.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1971" y="-25633.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_routing&#45;&gt;layer2_gpu2_token_recv -->
<g id="edge231" class="edge">
<title>layer2_routing&#45;&gt;layer2_gpu2_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5086.02,-25809.22C4493.71,-25804.24 3333.91,-25784.53 2352,-25707.83 2308.99,-25704.47 2263.37,-25699.8 2219.21,-25694.69"/>
<polygon fill="black" stroke="black" points="2219.56,-25691.21 2209.22,-25693.53 2218.75,-25698.16 2219.56,-25691.21"/>
</g>
<!-- layer2_gpu3_token_recv -->
<g id="node205" class="node">
<title>layer2_gpu3_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="2695" cy="-25659.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2695" y="-25678.55" font-family="Times,serif" font-size="14.00">Token Receive GPU3</text>
<text text-anchor="middle" x="2695" y="-25663.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="2695" y="-25648.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2695" y="-25633.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_routing&#45;&gt;layer2_gpu3_token_recv -->
<g id="edge237" class="edge">
<title>layer2_routing&#45;&gt;layer2_gpu3_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5079.13,-25804.47C4599.03,-25794.36 3767.67,-25769.05 3057,-25707.83 3018.73,-25704.53 2978.28,-25700.16 2938.84,-25695.4"/>
<polygon fill="black" stroke="black" points="2939.19,-25691.91 2928.84,-25694.18 2938.34,-25698.86 2939.19,-25691.91"/>
</g>
<!-- layer2_gpu4_token_recv -->
<g id="node210" class="node">
<title>layer2_gpu4_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="3400" cy="-25659.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="3400" y="-25678.55" font-family="Times,serif" font-size="14.00">Token Receive GPU4</text>
<text text-anchor="middle" x="3400" y="-25663.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="3400" y="-25648.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3400" y="-25633.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_routing&#45;&gt;layer2_gpu4_token_recv -->
<g id="edge243" class="edge">
<title>layer2_routing&#45;&gt;layer2_gpu4_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5064.87,-25794.66C4715.2,-25778.92 4200.5,-25750.98 3753,-25707.83 3717.56,-25704.41 3680.2,-25700.15 3643.58,-25695.59"/>
<polygon fill="black" stroke="black" points="3643.63,-25692.07 3633.28,-25694.3 3642.76,-25699.02 3643.63,-25692.07"/>
</g>
<!-- layer2_gpu5_token_recv -->
<g id="node215" class="node">
<title>layer2_gpu5_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4096" cy="-25659.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4096" y="-25678.55" font-family="Times,serif" font-size="14.00">Token Receive GPU5</text>
<text text-anchor="middle" x="4096" y="-25663.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4096" y="-25648.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4096" y="-25633.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_routing&#45;&gt;layer2_gpu5_token_recv -->
<g id="edge249" class="edge">
<title>layer2_routing&#45;&gt;layer2_gpu5_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5027.71,-25769.4C4846.55,-25751.8 4635.68,-25730.2 4445,-25707.83 4411.84,-25703.94 4376.95,-25699.57 4342.57,-25695.09"/>
<polygon fill="black" stroke="black" points="4342.77,-25691.59 4332.4,-25693.77 4341.87,-25698.53 4342.77,-25691.59"/>
</g>
<!-- layer2_gpu6_token_recv -->
<g id="node220" class="node">
<title>layer2_gpu6_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4788" cy="-25659.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4788" y="-25678.55" font-family="Times,serif" font-size="14.00">Token Receive GPU6</text>
<text text-anchor="middle" x="4788" y="-25663.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4788" y="-25648.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4788" y="-25633.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_routing&#45;&gt;layer2_gpu6_token_recv -->
<g id="edge255" class="edge">
<title>layer2_routing&#45;&gt;layer2_gpu6_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5169.28,-25743.8C5104.57,-25729.7 5038.11,-25715.23 4979.18,-25702.39"/>
<polygon fill="black" stroke="black" points="4979.92,-25698.97 4969.4,-25700.26 4978.43,-25705.81 4979.92,-25698.97"/>
</g>
<!-- layer2_gpu7_token_recv -->
<g id="node225" class="node">
<title>layer2_gpu7_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="5477" cy="-25659.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="5477" y="-25678.55" font-family="Times,serif" font-size="14.00">Token Receive GPU7</text>
<text text-anchor="middle" x="5477" y="-25663.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5477" y="-25648.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5477" y="-25633.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_routing&#45;&gt;layer2_gpu7_token_recv -->
<g id="edge261" class="edge">
<title>layer2_routing&#45;&gt;layer2_gpu7_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5477,-25743.69C5477,-25735.14 5477,-25726.46 5477,-25718.09"/>
<polygon fill="black" stroke="black" points="5480.5,-25718.06 5477,-25708.06 5473.5,-25718.06 5480.5,-25718.06"/>
</g>
<!-- layer2_gpu8_token_recv -->
<g id="node230" class="node">
<title>layer2_gpu8_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6180" cy="-25659.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6180" y="-25678.55" font-family="Times,serif" font-size="14.00">Token Receive GPU8</text>
<text text-anchor="middle" x="6180" y="-25663.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6180" y="-25648.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6180" y="-25633.55" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_routing&#45;&gt;layer2_gpu8_token_recv -->
<g id="edge267" class="edge">
<title>layer2_routing&#45;&gt;layer2_gpu8_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5770.81,-25748.1C5843.48,-25732.59 5919.54,-25716.35 5986.09,-25702.14"/>
<polygon fill="black" stroke="black" points="5987.21,-25705.48 5996.26,-25699.97 5985.75,-25698.64 5987.21,-25705.48"/>
</g>
<!-- layer2_gpu9_token_recv -->
<g id="node235" class="node">
<title>layer2_gpu9_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6875" cy="-25659.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6875" y="-25678.55" font-family="Times,serif" font-size="14.00">Token Receive GPU9</text>
<text text-anchor="middle" x="6875" y="-25663.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6875" y="-25648.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6875" y="-25633.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_routing&#45;&gt;layer2_gpu9_token_recv -->
<g id="edge273" class="edge">
<title>layer2_routing&#45;&gt;layer2_gpu9_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5817.97,-25780.28C6022.59,-25761.19 6287.93,-25735.12 6523,-25707.83 6556.72,-25703.91 6592.23,-25699.51 6627.18,-25695"/>
<polygon fill="black" stroke="black" points="6628.05,-25698.41 6637.51,-25693.66 6627.15,-25691.47 6628.05,-25698.41"/>
</g>
<!-- layer2_gpu10_token_recv -->
<g id="node240" class="node">
<title>layer2_gpu10_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="7566" cy="-25659.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="7566" y="-25678.55" font-family="Times,serif" font-size="14.00">Token Receive GPU10</text>
<text text-anchor="middle" x="7566" y="-25663.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="7566" y="-25648.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7566" y="-25633.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_routing&#45;&gt;layer2_gpu10_token_recv -->
<g id="edge279" class="edge">
<title>layer2_routing&#45;&gt;layer2_gpu10_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5842.76,-25797.21C6195.49,-25782.19 6744.1,-25753.84 7218,-25707.83 7252.53,-25704.48 7288.9,-25700.29 7324.59,-25695.8"/>
<polygon fill="black" stroke="black" points="7325.15,-25699.26 7334.63,-25694.53 7324.27,-25692.31 7325.15,-25699.26"/>
</g>
<!-- layer2_gpu11_token_recv -->
<g id="node245" class="node">
<title>layer2_gpu11_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8255" cy="-25659.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8255" y="-25678.55" font-family="Times,serif" font-size="14.00">Token Receive GPU11</text>
<text text-anchor="middle" x="8255" y="-25663.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8255" y="-25648.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8255" y="-25633.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_routing&#45;&gt;layer2_gpu11_token_recv -->
<g id="edge285" class="edge">
<title>layer2_routing&#45;&gt;layer2_gpu11_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5855.02,-25805.69C6333.87,-25796.68 7184.07,-25772.36 7909,-25707.83 7943.77,-25704.73 7980.41,-25700.65 8016.31,-25696.18"/>
<polygon fill="black" stroke="black" points="8016.93,-25699.62 8026.42,-25694.9 8016.06,-25692.68 8016.93,-25699.62"/>
</g>
<!-- layer2_gpu12_token_recv -->
<g id="node250" class="node">
<title>layer2_gpu12_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8943" cy="-25659.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8943" y="-25678.55" font-family="Times,serif" font-size="14.00">Token Receive GPU12</text>
<text text-anchor="middle" x="8943" y="-25663.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8943" y="-25648.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8943" y="-25633.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_routing&#45;&gt;layer2_gpu12_token_recv -->
<g id="edge291" class="edge">
<title>layer2_routing&#45;&gt;layer2_gpu12_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5862.73,-25810.81C6452.94,-25807.91 7615.16,-25790.89 8598,-25707.83 8632.96,-25704.87 8669.81,-25700.84 8705.88,-25696.37"/>
<polygon fill="black" stroke="black" points="8706.55,-25699.81 8716.03,-25695.09 8705.68,-25692.86 8706.55,-25699.81"/>
</g>
<!-- layer2_gpu13_token_recv -->
<g id="node255" class="node">
<title>layer2_gpu13_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="9630" cy="-25659.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="9630" y="-25678.55" font-family="Times,serif" font-size="14.00">Token Receive GPU13</text>
<text text-anchor="middle" x="9630" y="-25663.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="9630" y="-25648.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9630" y="-25633.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_routing&#45;&gt;layer2_gpu13_token_recv -->
<g id="edge297" class="edge">
<title>layer2_routing&#45;&gt;layer2_gpu13_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5855.22,-25805.85C6681.87,-25794.11 8628.22,-25761.58 9286,-25707.83 9321.01,-25704.97 9357.9,-25700.97 9394.01,-25696.5"/>
<polygon fill="black" stroke="black" points="9394.69,-25699.94 9404.17,-25695.23 9393.82,-25693 9394.69,-25699.94"/>
</g>
<!-- layer2_gpu14_token_recv -->
<g id="node260" class="node">
<title>layer2_gpu14_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10317" cy="-25659.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10317" y="-25678.55" font-family="Times,serif" font-size="14.00">Token Receive GPU14</text>
<text text-anchor="middle" x="10317" y="-25663.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10317" y="-25648.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10317" y="-25633.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_routing&#45;&gt;layer2_gpu14_token_recv -->
<g id="edge303" class="edge">
<title>layer2_routing&#45;&gt;layer2_gpu14_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5858.17,-25807.65C6792.57,-25798.95 9178.65,-25771.09 9973,-25707.83 10008.15,-25705.03 10045.2,-25701.05 10081.45,-25696.58"/>
<polygon fill="black" stroke="black" points="10082.16,-25700.02 10091.65,-25695.3 10081.29,-25693.07 10082.16,-25700.02"/>
</g>
<!-- layer2_gpu15_token_recv -->
<g id="node265" class="node">
<title>layer2_gpu15_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="11004" cy="-25659.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="11004" y="-25678.55" font-family="Times,serif" font-size="14.00">Token Receive GPU15</text>
<text text-anchor="middle" x="11004" y="-25663.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="11004" y="-25648.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="11004" y="-25633.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_routing&#45;&gt;layer2_gpu15_token_recv -->
<g id="edge309" class="edge">
<title>layer2_routing&#45;&gt;layer2_gpu15_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5860.16,-25808.99C6894.44,-25803.11 9727.82,-25780.64 10660,-25707.83 10695.29,-25705.07 10732.5,-25701.1 10768.88,-25696.62"/>
<polygon fill="black" stroke="black" points="10769.63,-25700.06 10779.12,-25695.34 10768.76,-25693.11 10769.63,-25700.06"/>
</g>
<!-- layer2_gpu0_expert_mlp1 -->
<g id="node191" class="node">
<title>layer2_gpu0_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="606.5,-25575.66 145.5,-25575.66 145.5,-25507.66 606.5,-25507.66 606.5,-25575.66"/>
<text text-anchor="middle" x="376" y="-25560.46" font-family="Times,serif" font-size="14.00">Expert 0 MLP1</text>
<text text-anchor="middle" x="376" y="-25545.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="376" y="-25530.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="376" y="-25515.46" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gpu0_token_recv&#45;&gt;layer2_gpu0_expert_mlp1 -->
<g id="edge220" class="edge">
<title>layer2_gpu0_token_recv&#45;&gt;layer2_gpu0_expert_mlp1</title>
<path fill="none" stroke="black" d="M376.59,-25611.53C376.52,-25603.14 376.45,-25594.45 376.37,-25586.17"/>
<polygon fill="black" stroke="black" points="379.87,-25585.94 376.29,-25575.97 372.87,-25586 379.87,-25585.94"/>
</g>
<!-- layer2_gpu0_expert_act -->
<g id="node192" class="node">
<title>layer2_gpu0_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="563.5,-25471.66 186.5,-25471.66 186.5,-25403.66 563.5,-25403.66 563.5,-25471.66"/>
<text text-anchor="middle" x="375" y="-25456.46" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="375" y="-25441.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="375" y="-25426.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="375" y="-25411.46" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gpu0_expert_mlp1&#45;&gt;layer2_gpu0_expert_act -->
<g id="edge221" class="edge">
<title>layer2_gpu0_expert_mlp1&#45;&gt;layer2_gpu0_expert_act</title>
<path fill="none" stroke="black" d="M375.68,-25507.55C375.6,-25499.44 375.51,-25490.64 375.43,-25482.13"/>
<polygon fill="black" stroke="black" points="378.92,-25481.93 375.33,-25471.96 371.92,-25482 378.92,-25481.93"/>
</g>
<!-- layer2_gpu0_expert_mlp2 -->
<g id="node193" class="node">
<title>layer2_gpu0_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="578.5,-25367.66 171.5,-25367.66 171.5,-25299.66 578.5,-25299.66 578.5,-25367.66"/>
<text text-anchor="middle" x="375" y="-25352.46" font-family="Times,serif" font-size="14.00">Expert 0 MLP2</text>
<text text-anchor="middle" x="375" y="-25337.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="375" y="-25322.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="375" y="-25307.46" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gpu0_expert_act&#45;&gt;layer2_gpu0_expert_mlp2 -->
<g id="edge222" class="edge">
<title>layer2_gpu0_expert_act&#45;&gt;layer2_gpu0_expert_mlp2</title>
<path fill="none" stroke="black" d="M375,-25403.55C375,-25395.44 375,-25386.64 375,-25378.13"/>
<polygon fill="black" stroke="black" points="378.5,-25377.96 375,-25367.96 371.5,-25377.96 378.5,-25377.96"/>
</g>
<!-- layer2_gpu0_token_send -->
<g id="node194" class="node">
<title>layer2_gpu0_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="372" cy="-25215.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="372" y="-25234.38" font-family="Times,serif" font-size="14.00">Token Send GPU0</text>
<text text-anchor="middle" x="372" y="-25219.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="372" y="-25204.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="372" y="-25189.38" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gpu0_expert_mlp2&#45;&gt;layer2_gpu0_token_send -->
<g id="edge223" class="edge">
<title>layer2_gpu0_expert_mlp2&#45;&gt;layer2_gpu0_token_send</title>
<path fill="none" stroke="black" d="M374.14,-25299.4C373.93,-25291.4 373.71,-25282.64 373.48,-25273.9"/>
<polygon fill="black" stroke="black" points="376.97,-25273.6 373.22,-25263.69 369.98,-25273.78 376.97,-25273.6"/>
</g>
<!-- layer2_expert_agg -->
<g id="node270" class="node">
<title>layer2_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="6278.05,-25131.5 5558.94,-25131.5 5373.95,-24995.5 6093.06,-24995.5 6278.05,-25131.5"/>
<text text-anchor="middle" x="5826" y="-25082.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5826" y="-25067.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x16)</text>
<text text-anchor="middle" x="5826" y="-25052.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5826" y="-25037.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer2_gpu0_token_send&#45;&gt;layer2_expert_agg -->
<g id="edge224" class="edge">
<title>layer2_gpu0_token_send&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M610.99,-25179.91C652.58,-25174.95 695.49,-25170.52 736,-25167.5 1654.89,-25098.97 4453.46,-25073.74 5460.28,-25066.74"/>
<polygon fill="black" stroke="black" points="5460.6,-25070.24 5470.57,-25066.67 5460.55,-25063.24 5460.6,-25070.24"/>
</g>
<!-- layer2_gpu1_expert_mlp1 -->
<g id="node196" class="node">
<title>layer2_gpu1_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="1387.5,-25575.66 926.5,-25575.66 926.5,-25507.66 1387.5,-25507.66 1387.5,-25575.66"/>
<text text-anchor="middle" x="1157" y="-25560.46" font-family="Times,serif" font-size="14.00">Expert 1 MLP1</text>
<text text-anchor="middle" x="1157" y="-25545.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1157" y="-25530.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1157" y="-25515.46" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gpu1_token_recv&#45;&gt;layer2_gpu1_expert_mlp1 -->
<g id="edge226" class="edge">
<title>layer2_gpu1_token_recv&#45;&gt;layer2_gpu1_expert_mlp1</title>
<path fill="none" stroke="black" d="M1189.04,-25611.53C1184.96,-25602.77 1180.73,-25593.67 1176.73,-25585.07"/>
<polygon fill="black" stroke="black" points="1179.88,-25583.56 1172.49,-25575.97 1173.54,-25586.51 1179.88,-25583.56"/>
</g>
<!-- layer2_gpu1_expert_act -->
<g id="node197" class="node">
<title>layer2_gpu1_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="1329.5,-25471.66 952.5,-25471.66 952.5,-25403.66 1329.5,-25403.66 1329.5,-25471.66"/>
<text text-anchor="middle" x="1141" y="-25456.46" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1141" y="-25441.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1141" y="-25426.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1141" y="-25411.46" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gpu1_expert_mlp1&#45;&gt;layer2_gpu1_expert_act -->
<g id="edge227" class="edge">
<title>layer2_gpu1_expert_mlp1&#45;&gt;layer2_gpu1_expert_act</title>
<path fill="none" stroke="black" d="M1151.81,-25507.55C1150.52,-25499.35 1149.12,-25490.45 1147.78,-25481.85"/>
<polygon fill="black" stroke="black" points="1151.23,-25481.3 1146.22,-25471.96 1144.32,-25482.38 1151.23,-25481.3"/>
</g>
<!-- layer2_gpu1_expert_mlp2 -->
<g id="node198" class="node">
<title>layer2_gpu1_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="1331.5,-25367.66 924.5,-25367.66 924.5,-25299.66 1331.5,-25299.66 1331.5,-25367.66"/>
<text text-anchor="middle" x="1128" y="-25352.46" font-family="Times,serif" font-size="14.00">Expert 1 MLP2</text>
<text text-anchor="middle" x="1128" y="-25337.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1128" y="-25322.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1128" y="-25307.46" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gpu1_expert_act&#45;&gt;layer2_gpu1_expert_mlp2 -->
<g id="edge228" class="edge">
<title>layer2_gpu1_expert_act&#45;&gt;layer2_gpu1_expert_mlp2</title>
<path fill="none" stroke="black" d="M1136.78,-25403.55C1135.75,-25395.44 1134.63,-25386.64 1133.54,-25378.13"/>
<polygon fill="black" stroke="black" points="1136.98,-25377.44 1132.24,-25367.96 1130.04,-25378.32 1136.98,-25377.44"/>
</g>
<!-- layer2_gpu1_token_send -->
<g id="node199" class="node">
<title>layer2_gpu1_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1101" cy="-25215.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1101" y="-25234.38" font-family="Times,serif" font-size="14.00">Token Send GPU1</text>
<text text-anchor="middle" x="1101" y="-25219.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1101" y="-25204.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1101" y="-25189.38" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gpu1_expert_mlp2&#45;&gt;layer2_gpu1_token_send -->
<g id="edge229" class="edge">
<title>layer2_gpu1_expert_mlp2&#45;&gt;layer2_gpu1_token_send</title>
<path fill="none" stroke="black" d="M1120.26,-25299.4C1118.38,-25291.32 1116.32,-25282.45 1114.26,-25273.61"/>
<polygon fill="black" stroke="black" points="1117.63,-25272.64 1111.96,-25263.69 1110.81,-25274.22 1117.63,-25272.64"/>
</g>
<!-- layer2_gpu1_token_send&#45;&gt;layer2_expert_agg -->
<g id="edge230" class="edge">
<title>layer2_gpu1_token_send&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M1340.48,-25179.97C1381.93,-25175.02 1424.65,-25170.57 1465,-25167.5 2237.38,-25108.59 4560.04,-25078.05 5462.17,-25068.16"/>
<polygon fill="black" stroke="black" points="5462.42,-25071.66 5472.38,-25068.05 5462.35,-25064.66 5462.42,-25071.66"/>
</g>
<!-- layer2_gpu2_expert_mlp1 -->
<g id="node201" class="node">
<title>layer2_gpu2_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2132.5,-25575.66 1671.5,-25575.66 1671.5,-25507.66 2132.5,-25507.66 2132.5,-25575.66"/>
<text text-anchor="middle" x="1902" y="-25560.46" font-family="Times,serif" font-size="14.00">Expert 2 MLP1</text>
<text text-anchor="middle" x="1902" y="-25545.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1902" y="-25530.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1902" y="-25515.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gpu2_token_recv&#45;&gt;layer2_gpu2_expert_mlp1 -->
<g id="edge232" class="edge">
<title>layer2_gpu2_token_recv&#45;&gt;layer2_gpu2_expert_mlp1</title>
<path fill="none" stroke="black" d="M1942.94,-25611.53C1937.67,-25602.68 1932.21,-25593.48 1927.04,-25584.79"/>
<polygon fill="black" stroke="black" points="1929.91,-25582.77 1921.8,-25575.97 1923.9,-25586.35 1929.91,-25582.77"/>
</g>
<!-- layer2_gpu2_expert_act -->
<g id="node202" class="node">
<title>layer2_gpu2_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2070.5,-25471.66 1693.5,-25471.66 1693.5,-25403.66 2070.5,-25403.66 2070.5,-25471.66"/>
<text text-anchor="middle" x="1882" y="-25456.46" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="1882" y="-25441.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1882" y="-25426.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1882" y="-25411.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gpu2_expert_mlp1&#45;&gt;layer2_gpu2_expert_act -->
<g id="edge233" class="edge">
<title>layer2_gpu2_expert_mlp1&#45;&gt;layer2_gpu2_expert_act</title>
<path fill="none" stroke="black" d="M1895.51,-25507.55C1893.9,-25499.35 1892.15,-25490.45 1890.47,-25481.85"/>
<polygon fill="black" stroke="black" points="1893.89,-25481.1 1888.53,-25471.96 1887.02,-25482.45 1893.89,-25481.1"/>
</g>
<!-- layer2_gpu2_expert_mlp2 -->
<g id="node203" class="node">
<title>layer2_gpu2_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2068.5,-25367.66 1661.5,-25367.66 1661.5,-25299.66 2068.5,-25299.66 2068.5,-25367.66"/>
<text text-anchor="middle" x="1865" y="-25352.46" font-family="Times,serif" font-size="14.00">Expert 2 MLP2</text>
<text text-anchor="middle" x="1865" y="-25337.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1865" y="-25322.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1865" y="-25307.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gpu2_expert_act&#45;&gt;layer2_gpu2_expert_mlp2 -->
<g id="edge234" class="edge">
<title>layer2_gpu2_expert_act&#45;&gt;layer2_gpu2_expert_mlp2</title>
<path fill="none" stroke="black" d="M1876.48,-25403.55C1875.11,-25395.35 1873.63,-25386.45 1872.2,-25377.85"/>
<polygon fill="black" stroke="black" points="1875.65,-25377.25 1870.55,-25367.96 1868.74,-25378.4 1875.65,-25377.25"/>
</g>
<!-- layer2_gpu2_token_send -->
<g id="node204" class="node">
<title>layer2_gpu2_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1830" cy="-25215.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1830" y="-25234.38" font-family="Times,serif" font-size="14.00">Token Send GPU2</text>
<text text-anchor="middle" x="1830" y="-25219.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1830" y="-25204.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1830" y="-25189.38" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gpu2_expert_mlp2&#45;&gt;layer2_gpu2_token_send -->
<g id="edge235" class="edge">
<title>layer2_gpu2_expert_mlp2&#45;&gt;layer2_gpu2_token_send</title>
<path fill="none" stroke="black" d="M1854.97,-25299.4C1852.51,-25291.23 1849.8,-25282.26 1847.11,-25273.33"/>
<polygon fill="black" stroke="black" points="1850.44,-25272.25 1844.2,-25263.69 1843.74,-25274.27 1850.44,-25272.25"/>
</g>
<!-- layer2_gpu2_token_send&#45;&gt;layer2_expert_agg -->
<g id="edge236" class="edge">
<title>layer2_gpu2_token_send&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M2069.99,-25180.07C2111.28,-25175.13 2153.82,-25170.66 2194,-25167.5 2821.26,-25118.16 4676.39,-25083.17 5464.87,-25070.13"/>
<polygon fill="black" stroke="black" points="5465.02,-25073.62 5474.96,-25069.96 5464.9,-25066.62 5465.02,-25073.62"/>
</g>
<!-- layer2_gpu3_expert_mlp1 -->
<g id="node206" class="node">
<title>layer2_gpu3_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2906.5,-25575.66 2445.5,-25575.66 2445.5,-25507.66 2906.5,-25507.66 2906.5,-25575.66"/>
<text text-anchor="middle" x="2676" y="-25560.46" font-family="Times,serif" font-size="14.00">Expert 3 MLP1</text>
<text text-anchor="middle" x="2676" y="-25545.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2676" y="-25530.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2676" y="-25515.46" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gpu3_token_recv&#45;&gt;layer2_gpu3_expert_mlp1 -->
<g id="edge238" class="edge">
<title>layer2_gpu3_token_recv&#45;&gt;layer2_gpu3_expert_mlp1</title>
<path fill="none" stroke="black" d="M2687.27,-25611.53C2685.88,-25603.05 2684.44,-25594.25 2683.08,-25585.89"/>
<polygon fill="black" stroke="black" points="2686.52,-25585.27 2681.45,-25575.97 2679.61,-25586.4 2686.52,-25585.27"/>
</g>
<!-- layer2_gpu3_expert_act -->
<g id="node207" class="node">
<title>layer2_gpu3_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2797.5,-25471.66 2420.5,-25471.66 2420.5,-25403.66 2797.5,-25403.66 2797.5,-25471.66"/>
<text text-anchor="middle" x="2609" y="-25456.46" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="2609" y="-25441.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2609" y="-25426.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2609" y="-25411.46" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gpu3_expert_mlp1&#45;&gt;layer2_gpu3_expert_act -->
<g id="edge239" class="edge">
<title>layer2_gpu3_expert_mlp1&#45;&gt;layer2_gpu3_expert_act</title>
<path fill="none" stroke="black" d="M2654.25,-25507.55C2648.57,-25498.91 2642.38,-25489.48 2636.45,-25480.46"/>
<polygon fill="black" stroke="black" points="2639.29,-25478.4 2630.87,-25471.96 2633.44,-25482.24 2639.29,-25478.4"/>
</g>
<!-- layer2_gpu3_expert_mlp2 -->
<g id="node208" class="node">
<title>layer2_gpu3_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2795.5,-25367.66 2388.5,-25367.66 2388.5,-25299.66 2795.5,-25299.66 2795.5,-25367.66"/>
<text text-anchor="middle" x="2592" y="-25352.46" font-family="Times,serif" font-size="14.00">Expert 3 MLP2</text>
<text text-anchor="middle" x="2592" y="-25337.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2592" y="-25322.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="2592" y="-25307.46" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gpu3_expert_act&#45;&gt;layer2_gpu3_expert_mlp2 -->
<g id="edge240" class="edge">
<title>layer2_gpu3_expert_act&#45;&gt;layer2_gpu3_expert_mlp2</title>
<path fill="none" stroke="black" d="M2603.48,-25403.55C2602.11,-25395.35 2600.63,-25386.45 2599.2,-25377.85"/>
<polygon fill="black" stroke="black" points="2602.65,-25377.25 2597.55,-25367.96 2595.74,-25378.4 2602.65,-25377.25"/>
</g>
<!-- layer2_gpu3_token_send -->
<g id="node209" class="node">
<title>layer2_gpu3_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="2559" cy="-25215.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="2559" y="-25234.38" font-family="Times,serif" font-size="14.00">Token Send GPU3</text>
<text text-anchor="middle" x="2559" y="-25219.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="2559" y="-25204.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="2559" y="-25189.38" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gpu3_expert_mlp2&#45;&gt;layer2_gpu3_token_send -->
<g id="edge241" class="edge">
<title>layer2_gpu3_expert_mlp2&#45;&gt;layer2_gpu3_token_send</title>
<path fill="none" stroke="black" d="M2582.54,-25299.4C2580.22,-25291.23 2577.67,-25282.26 2575.13,-25273.33"/>
<polygon fill="black" stroke="black" points="2578.49,-25272.35 2572.39,-25263.69 2571.76,-25274.26 2578.49,-25272.35"/>
</g>
<!-- layer2_gpu3_token_send&#45;&gt;layer2_expert_agg -->
<g id="edge242" class="edge">
<title>layer2_gpu3_token_send&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M2799.99,-25180.2C2840.97,-25175.27 2883.15,-25170.77 2923,-25167.5 3833.58,-25092.61 4909.24,-25072.13 5460.29,-25066.56"/>
<polygon fill="black" stroke="black" points="5460.41,-25070.06 5470.38,-25066.46 5460.34,-25063.06 5460.41,-25070.06"/>
</g>
<!-- layer2_gpu4_expert_mlp1 -->
<g id="node211" class="node">
<title>layer2_gpu4_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="3575.5,-25575.66 3114.5,-25575.66 3114.5,-25507.66 3575.5,-25507.66 3575.5,-25575.66"/>
<text text-anchor="middle" x="3345" y="-25560.46" font-family="Times,serif" font-size="14.00">Expert 4 MLP1</text>
<text text-anchor="middle" x="3345" y="-25545.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3345" y="-25530.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3345" y="-25515.46" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gpu4_token_recv&#45;&gt;layer2_gpu4_expert_mlp1 -->
<g id="edge244" class="edge">
<title>layer2_gpu4_token_recv&#45;&gt;layer2_gpu4_expert_mlp1</title>
<path fill="none" stroke="black" d="M3377.63,-25611.53C3373.48,-25602.77 3369.17,-25593.67 3365.09,-25585.07"/>
<polygon fill="black" stroke="black" points="3368.22,-25583.5 3360.78,-25575.97 3361.9,-25586.5 3368.22,-25583.5"/>
</g>
<!-- layer2_gpu4_expert_act -->
<g id="node212" class="node">
<title>layer2_gpu4_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="3517.5,-25471.66 3140.5,-25471.66 3140.5,-25403.66 3517.5,-25403.66 3517.5,-25471.66"/>
<text text-anchor="middle" x="3329" y="-25456.46" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="3329" y="-25441.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3329" y="-25426.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3329" y="-25411.46" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gpu4_expert_mlp1&#45;&gt;layer2_gpu4_expert_act -->
<g id="edge245" class="edge">
<title>layer2_gpu4_expert_mlp1&#45;&gt;layer2_gpu4_expert_act</title>
<path fill="none" stroke="black" d="M3339.81,-25507.55C3338.52,-25499.35 3337.12,-25490.45 3335.78,-25481.85"/>
<polygon fill="black" stroke="black" points="3339.23,-25481.3 3334.22,-25471.96 3332.32,-25482.38 3339.23,-25481.3"/>
</g>
<!-- layer2_gpu4_expert_mlp2 -->
<g id="node213" class="node">
<title>layer2_gpu4_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="3518.5,-25367.66 3111.5,-25367.66 3111.5,-25299.66 3518.5,-25299.66 3518.5,-25367.66"/>
<text text-anchor="middle" x="3315" y="-25352.46" font-family="Times,serif" font-size="14.00">Expert 4 MLP2</text>
<text text-anchor="middle" x="3315" y="-25337.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3315" y="-25322.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="3315" y="-25307.46" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gpu4_expert_act&#45;&gt;layer2_gpu4_expert_mlp2 -->
<g id="edge246" class="edge">
<title>layer2_gpu4_expert_act&#45;&gt;layer2_gpu4_expert_mlp2</title>
<path fill="none" stroke="black" d="M3324.45,-25403.55C3323.34,-25395.44 3322.13,-25386.64 3320.97,-25378.13"/>
<polygon fill="black" stroke="black" points="3324.4,-25377.39 3319.57,-25367.96 3317.46,-25378.35 3324.4,-25377.39"/>
</g>
<!-- layer2_gpu4_token_send -->
<g id="node214" class="node">
<title>layer2_gpu4_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="3288" cy="-25215.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="3288" y="-25234.38" font-family="Times,serif" font-size="14.00">Token Send GPU4</text>
<text text-anchor="middle" x="3288" y="-25219.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="3288" y="-25204.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="3288" y="-25189.38" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gpu4_expert_mlp2&#45;&gt;layer2_gpu4_token_send -->
<g id="edge247" class="edge">
<title>layer2_gpu4_expert_mlp2&#45;&gt;layer2_gpu4_token_send</title>
<path fill="none" stroke="black" d="M3307.26,-25299.4C3305.38,-25291.32 3303.32,-25282.45 3301.26,-25273.61"/>
<polygon fill="black" stroke="black" points="3304.63,-25272.64 3298.96,-25263.69 3297.81,-25274.22 3304.63,-25272.64"/>
</g>
<!-- layer2_gpu4_token_send&#45;&gt;layer2_expert_agg -->
<g id="edge248" class="edge">
<title>layer2_gpu4_token_send&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M3530.98,-25180.37C3571.34,-25175.48 3612.8,-25170.95 3652,-25167.5 4290.14,-25111.2 5036.55,-25084.3 5467.94,-25072.54"/>
<polygon fill="black" stroke="black" points="5468.17,-25076.04 5478.07,-25072.27 5467.98,-25069.04 5468.17,-25076.04"/>
</g>
<!-- layer2_gpu5_expert_mlp1 -->
<g id="node216" class="node">
<title>layer2_gpu5_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4288.5,-25575.66 3827.5,-25575.66 3827.5,-25507.66 4288.5,-25507.66 4288.5,-25575.66"/>
<text text-anchor="middle" x="4058" y="-25560.46" font-family="Times,serif" font-size="14.00">Expert 5 MLP1</text>
<text text-anchor="middle" x="4058" y="-25545.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4058" y="-25530.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4058" y="-25515.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gpu5_token_recv&#45;&gt;layer2_gpu5_expert_mlp1 -->
<g id="edge250" class="edge">
<title>layer2_gpu5_token_recv&#45;&gt;layer2_gpu5_expert_mlp1</title>
<path fill="none" stroke="black" d="M4080.54,-25611.53C4077.74,-25602.96 4074.82,-25594.06 4072.06,-25585.62"/>
<polygon fill="black" stroke="black" points="4075.34,-25584.38 4068.9,-25575.97 4068.69,-25586.56 4075.34,-25584.38"/>
</g>
<!-- layer2_gpu5_expert_act -->
<g id="node217" class="node">
<title>layer2_gpu5_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4234.5,-25471.66 3857.5,-25471.66 3857.5,-25403.66 4234.5,-25403.66 4234.5,-25471.66"/>
<text text-anchor="middle" x="4046" y="-25456.46" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="4046" y="-25441.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4046" y="-25426.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4046" y="-25411.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gpu5_expert_mlp1&#45;&gt;layer2_gpu5_expert_act -->
<g id="edge251" class="edge">
<title>layer2_gpu5_expert_mlp1&#45;&gt;layer2_gpu5_expert_act</title>
<path fill="none" stroke="black" d="M4054.1,-25507.55C4053.15,-25499.44 4052.12,-25490.64 4051.11,-25482.13"/>
<polygon fill="black" stroke="black" points="4054.56,-25481.48 4049.92,-25471.96 4047.61,-25482.3 4054.56,-25481.48"/>
</g>
<!-- layer2_gpu5_expert_mlp2 -->
<g id="node218" class="node">
<title>layer2_gpu5_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4239.5,-25367.66 3832.5,-25367.66 3832.5,-25299.66 4239.5,-25299.66 4239.5,-25367.66"/>
<text text-anchor="middle" x="4036" y="-25352.46" font-family="Times,serif" font-size="14.00">Expert 5 MLP2</text>
<text text-anchor="middle" x="4036" y="-25337.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4036" y="-25322.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4036" y="-25307.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gpu5_expert_act&#45;&gt;layer2_gpu5_expert_mlp2 -->
<g id="edge252" class="edge">
<title>layer2_gpu5_expert_act&#45;&gt;layer2_gpu5_expert_mlp2</title>
<path fill="none" stroke="black" d="M4042.75,-25403.55C4041.96,-25395.44 4041.1,-25386.64 4040.26,-25378.13"/>
<polygon fill="black" stroke="black" points="4043.72,-25377.57 4039.26,-25367.96 4036.76,-25378.26 4043.72,-25377.57"/>
</g>
<!-- layer2_gpu5_token_send -->
<g id="node219" class="node">
<title>layer2_gpu5_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4017" cy="-25215.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4017" y="-25234.38" font-family="Times,serif" font-size="14.00">Token Send GPU5</text>
<text text-anchor="middle" x="4017" y="-25219.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4017" y="-25204.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4017" y="-25189.38" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gpu5_expert_mlp2&#45;&gt;layer2_gpu5_token_send -->
<g id="edge253" class="edge">
<title>layer2_gpu5_expert_mlp2&#45;&gt;layer2_gpu5_token_send</title>
<path fill="none" stroke="black" d="M4030.56,-25299.4C4029.23,-25291.32 4027.78,-25282.45 4026.33,-25273.61"/>
<polygon fill="black" stroke="black" points="4029.78,-25272.99 4024.71,-25263.69 4022.87,-25274.12 4029.78,-25272.99"/>
</g>
<!-- layer2_gpu5_token_send&#45;&gt;layer2_expert_agg -->
<g id="edge254" class="edge">
<title>layer2_gpu5_token_send&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M4263,-25180.81C4302.42,-25175.96 4342.8,-25171.32 4381,-25167.5 4756.92,-25129.82 5189.22,-25100.89 5482.29,-25083.42"/>
<polygon fill="black" stroke="black" points="5482.88,-25086.89 5492.66,-25082.8 5482.46,-25079.9 5482.88,-25086.89"/>
</g>
<!-- layer2_gpu6_expert_mlp1 -->
<g id="node221" class="node">
<title>layer2_gpu6_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5008.5,-25575.66 4547.5,-25575.66 4547.5,-25507.66 5008.5,-25507.66 5008.5,-25575.66"/>
<text text-anchor="middle" x="4778" y="-25560.46" font-family="Times,serif" font-size="14.00">Expert 6 MLP1</text>
<text text-anchor="middle" x="4778" y="-25545.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4778" y="-25530.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4778" y="-25515.46" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gpu6_token_recv&#45;&gt;layer2_gpu6_expert_mlp1 -->
<g id="edge256" class="edge">
<title>layer2_gpu6_token_recv&#45;&gt;layer2_gpu6_expert_mlp1</title>
<path fill="none" stroke="black" d="M4783.93,-25611.53C4783.21,-25603.14 4782.46,-25594.45 4781.75,-25586.17"/>
<polygon fill="black" stroke="black" points="4785.21,-25585.63 4780.87,-25575.97 4778.24,-25586.23 4785.21,-25585.63"/>
</g>
<!-- layer2_gpu6_expert_act -->
<g id="node222" class="node">
<title>layer2_gpu6_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4946.5,-25471.66 4569.5,-25471.66 4569.5,-25403.66 4946.5,-25403.66 4946.5,-25471.66"/>
<text text-anchor="middle" x="4758" y="-25456.46" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="4758" y="-25441.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4758" y="-25426.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4758" y="-25411.46" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gpu6_expert_mlp1&#45;&gt;layer2_gpu6_expert_act -->
<g id="edge257" class="edge">
<title>layer2_gpu6_expert_mlp1&#45;&gt;layer2_gpu6_expert_act</title>
<path fill="none" stroke="black" d="M4771.51,-25507.55C4769.9,-25499.35 4768.15,-25490.45 4766.47,-25481.85"/>
<polygon fill="black" stroke="black" points="4769.89,-25481.1 4764.53,-25471.96 4763.02,-25482.45 4769.89,-25481.1"/>
</g>
<!-- layer2_gpu6_expert_mlp2 -->
<g id="node223" class="node">
<title>layer2_gpu6_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4956.5,-25367.66 4549.5,-25367.66 4549.5,-25299.66 4956.5,-25299.66 4956.5,-25367.66"/>
<text text-anchor="middle" x="4753" y="-25352.46" font-family="Times,serif" font-size="14.00">Expert 6 MLP2</text>
<text text-anchor="middle" x="4753" y="-25337.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4753" y="-25322.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4753" y="-25307.46" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gpu6_expert_act&#45;&gt;layer2_gpu6_expert_mlp2 -->
<g id="edge258" class="edge">
<title>layer2_gpu6_expert_act&#45;&gt;layer2_gpu6_expert_mlp2</title>
<path fill="none" stroke="black" d="M4756.38,-25403.55C4755.98,-25395.44 4755.55,-25386.64 4755.13,-25378.13"/>
<polygon fill="black" stroke="black" points="4758.62,-25377.78 4754.63,-25367.96 4751.63,-25378.12 4758.62,-25377.78"/>
</g>
<!-- layer2_gpu6_token_send -->
<g id="node224" class="node">
<title>layer2_gpu6_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4746" cy="-25215.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4746" y="-25234.38" font-family="Times,serif" font-size="14.00">Token Send GPU6</text>
<text text-anchor="middle" x="4746" y="-25219.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4746" y="-25204.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4746" y="-25189.38" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gpu6_expert_mlp2&#45;&gt;layer2_gpu6_token_send -->
<g id="edge259" class="edge">
<title>layer2_gpu6_expert_mlp2&#45;&gt;layer2_gpu6_token_send</title>
<path fill="none" stroke="black" d="M4750.99,-25299.4C4750.51,-25291.4 4749.98,-25282.64 4749.46,-25273.9"/>
<polygon fill="black" stroke="black" points="4752.94,-25273.46 4748.84,-25263.69 4745.95,-25273.88 4752.94,-25273.46"/>
</g>
<!-- layer2_gpu6_token_send&#45;&gt;layer2_expert_agg -->
<g id="edge260" class="edge">
<title>layer2_gpu6_token_send&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M4990.39,-25180.62C5145.66,-25159.04 5348.06,-25130.91 5514.77,-25107.75"/>
<polygon fill="black" stroke="black" points="5515.27,-25111.21 5524.69,-25106.37 5514.31,-25104.28 5515.27,-25111.21"/>
</g>
<!-- layer2_gpu7_expert_mlp1 -->
<g id="node226" class="node">
<title>layer2_gpu7_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5707.5,-25575.66 5246.5,-25575.66 5246.5,-25507.66 5707.5,-25507.66 5707.5,-25575.66"/>
<text text-anchor="middle" x="5477" y="-25560.46" font-family="Times,serif" font-size="14.00">Expert 7 MLP1</text>
<text text-anchor="middle" x="5477" y="-25545.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5477" y="-25530.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5477" y="-25515.46" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gpu7_token_recv&#45;&gt;layer2_gpu7_expert_mlp1 -->
<g id="edge262" class="edge">
<title>layer2_gpu7_token_recv&#45;&gt;layer2_gpu7_expert_mlp1</title>
<path fill="none" stroke="black" d="M5477,-25611.53C5477,-25603.14 5477,-25594.45 5477,-25586.17"/>
<polygon fill="black" stroke="black" points="5480.5,-25585.97 5477,-25575.97 5473.5,-25585.97 5480.5,-25585.97"/>
</g>
<!-- layer2_gpu7_expert_act -->
<g id="node227" class="node">
<title>layer2_gpu7_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="5665.5,-25471.66 5288.5,-25471.66 5288.5,-25403.66 5665.5,-25403.66 5665.5,-25471.66"/>
<text text-anchor="middle" x="5477" y="-25456.46" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="5477" y="-25441.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5477" y="-25426.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5477" y="-25411.46" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gpu7_expert_mlp1&#45;&gt;layer2_gpu7_expert_act -->
<g id="edge263" class="edge">
<title>layer2_gpu7_expert_mlp1&#45;&gt;layer2_gpu7_expert_act</title>
<path fill="none" stroke="black" d="M5477,-25507.55C5477,-25499.44 5477,-25490.64 5477,-25482.13"/>
<polygon fill="black" stroke="black" points="5480.5,-25481.96 5477,-25471.96 5473.5,-25481.96 5480.5,-25481.96"/>
</g>
<!-- layer2_gpu7_expert_mlp2 -->
<g id="node228" class="node">
<title>layer2_gpu7_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="5680.5,-25367.66 5273.5,-25367.66 5273.5,-25299.66 5680.5,-25299.66 5680.5,-25367.66"/>
<text text-anchor="middle" x="5477" y="-25352.46" font-family="Times,serif" font-size="14.00">Expert 7 MLP2</text>
<text text-anchor="middle" x="5477" y="-25337.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5477" y="-25322.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-25307.46" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gpu7_expert_act&#45;&gt;layer2_gpu7_expert_mlp2 -->
<g id="edge264" class="edge">
<title>layer2_gpu7_expert_act&#45;&gt;layer2_gpu7_expert_mlp2</title>
<path fill="none" stroke="black" d="M5477,-25403.55C5477,-25395.44 5477,-25386.64 5477,-25378.13"/>
<polygon fill="black" stroke="black" points="5480.5,-25377.96 5477,-25367.96 5473.5,-25377.96 5480.5,-25377.96"/>
</g>
<!-- layer2_gpu7_token_send -->
<g id="node229" class="node">
<title>layer2_gpu7_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="5475" cy="-25215.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="5475" y="-25234.38" font-family="Times,serif" font-size="14.00">Token Send GPU7</text>
<text text-anchor="middle" x="5475" y="-25219.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="5475" y="-25204.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="5475" y="-25189.38" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gpu7_expert_mlp2&#45;&gt;layer2_gpu7_token_send -->
<g id="edge265" class="edge">
<title>layer2_gpu7_expert_mlp2&#45;&gt;layer2_gpu7_token_send</title>
<path fill="none" stroke="black" d="M5476.43,-25299.4C5476.29,-25291.4 5476.14,-25282.64 5475.99,-25273.9"/>
<polygon fill="black" stroke="black" points="5479.48,-25273.63 5475.81,-25263.69 5472.48,-25273.75 5479.48,-25273.63"/>
</g>
<!-- layer2_gpu7_token_send&#45;&gt;layer2_expert_agg -->
<g id="edge266" class="edge">
<title>layer2_gpu7_token_send&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M5580.31,-25169.55C5605.33,-25158.85 5632.63,-25147.18 5659.63,-25135.63"/>
<polygon fill="black" stroke="black" points="5661.35,-25138.7 5669.17,-25131.56 5658.6,-25132.27 5661.35,-25138.7"/>
</g>
<!-- layer2_gpu8_expert_mlp1 -->
<g id="node231" class="node">
<title>layer2_gpu8_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="6412.5,-25575.66 5951.5,-25575.66 5951.5,-25507.66 6412.5,-25507.66 6412.5,-25575.66"/>
<text text-anchor="middle" x="6182" y="-25560.46" font-family="Times,serif" font-size="14.00">Expert 8 MLP1</text>
<text text-anchor="middle" x="6182" y="-25545.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6182" y="-25530.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6182" y="-25515.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gpu8_token_recv&#45;&gt;layer2_gpu8_expert_mlp1 -->
<g id="edge268" class="edge">
<title>layer2_gpu8_token_recv&#45;&gt;layer2_gpu8_expert_mlp1</title>
<path fill="none" stroke="black" d="M6180.81,-25611.53C6180.96,-25603.14 6181.11,-25594.45 6181.25,-25586.17"/>
<polygon fill="black" stroke="black" points="6184.75,-25586.03 6181.43,-25575.97 6177.75,-25585.9 6184.75,-25586.03"/>
</g>
<!-- layer2_gpu8_expert_act -->
<g id="node232" class="node">
<title>layer2_gpu8_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="6373.5,-25471.66 5996.5,-25471.66 5996.5,-25403.66 6373.5,-25403.66 6373.5,-25471.66"/>
<text text-anchor="middle" x="6185" y="-25456.46" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="6185" y="-25441.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6185" y="-25426.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6185" y="-25411.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gpu8_expert_mlp1&#45;&gt;layer2_gpu8_expert_act -->
<g id="edge269" class="edge">
<title>layer2_gpu8_expert_mlp1&#45;&gt;layer2_gpu8_expert_act</title>
<path fill="none" stroke="black" d="M6182.97,-25507.55C6183.21,-25499.44 6183.47,-25490.64 6183.72,-25482.13"/>
<polygon fill="black" stroke="black" points="6187.23,-25482.06 6184.02,-25471.96 6180.23,-25481.85 6187.23,-25482.06"/>
</g>
<!-- layer2_gpu8_expert_mlp2 -->
<g id="node233" class="node">
<title>layer2_gpu8_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="6401.5,-25367.66 5994.5,-25367.66 5994.5,-25299.66 6401.5,-25299.66 6401.5,-25367.66"/>
<text text-anchor="middle" x="6198" y="-25352.46" font-family="Times,serif" font-size="14.00">Expert 8 MLP2</text>
<text text-anchor="middle" x="6198" y="-25337.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6198" y="-25322.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6198" y="-25307.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gpu8_expert_act&#45;&gt;layer2_gpu8_expert_mlp2 -->
<g id="edge270" class="edge">
<title>layer2_gpu8_expert_act&#45;&gt;layer2_gpu8_expert_mlp2</title>
<path fill="none" stroke="black" d="M6189.22,-25403.55C6190.25,-25395.44 6191.37,-25386.64 6192.46,-25378.13"/>
<polygon fill="black" stroke="black" points="6195.96,-25378.32 6193.76,-25367.96 6189.02,-25377.44 6195.96,-25378.32"/>
</g>
<!-- layer2_gpu8_token_send -->
<g id="node234" class="node">
<title>layer2_gpu8_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6204" cy="-25215.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6204" y="-25234.38" font-family="Times,serif" font-size="14.00">Token Send GPU8</text>
<text text-anchor="middle" x="6204" y="-25219.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6204" y="-25204.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6204" y="-25189.38" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gpu8_expert_mlp2&#45;&gt;layer2_gpu8_token_send -->
<g id="edge271" class="edge">
<title>layer2_gpu8_expert_mlp2&#45;&gt;layer2_gpu8_token_send</title>
<path fill="none" stroke="black" d="M6199.72,-25299.4C6200.13,-25291.4 6200.59,-25282.64 6201.04,-25273.9"/>
<polygon fill="black" stroke="black" points="6204.54,-25273.86 6201.57,-25263.69 6197.55,-25273.49 6204.54,-25273.86"/>
</g>
<!-- layer2_gpu8_token_send&#45;&gt;layer2_expert_agg -->
<g id="edge272" class="edge">
<title>layer2_gpu8_token_send&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M6091.61,-25169.96C6064.22,-25159.08 6034.24,-25147.18 6004.6,-25135.41"/>
<polygon fill="black" stroke="black" points="6005.58,-25132.03 5994.99,-25131.59 6003,-25138.54 6005.58,-25132.03"/>
</g>
<!-- layer2_gpu9_expert_mlp1 -->
<g id="node236" class="node">
<title>layer2_gpu9_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7111.5,-25575.66 6650.5,-25575.66 6650.5,-25507.66 7111.5,-25507.66 7111.5,-25575.66"/>
<text text-anchor="middle" x="6881" y="-25560.46" font-family="Times,serif" font-size="14.00">Expert 9 MLP1</text>
<text text-anchor="middle" x="6881" y="-25545.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6881" y="-25530.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6881" y="-25515.46" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gpu9_token_recv&#45;&gt;layer2_gpu9_expert_mlp1 -->
<g id="edge274" class="edge">
<title>layer2_gpu9_token_recv&#45;&gt;layer2_gpu9_expert_mlp1</title>
<path fill="none" stroke="black" d="M6877.44,-25611.53C6877.87,-25603.14 6878.32,-25594.45 6878.75,-25586.17"/>
<polygon fill="black" stroke="black" points="6882.26,-25586.13 6879.28,-25575.97 6875.27,-25585.77 6882.26,-25586.13"/>
</g>
<!-- layer2_gpu9_expert_act -->
<g id="node237" class="node">
<title>layer2_gpu9_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7084.5,-25471.66 6707.5,-25471.66 6707.5,-25403.66 7084.5,-25403.66 7084.5,-25471.66"/>
<text text-anchor="middle" x="6896" y="-25456.46" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="6896" y="-25441.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6896" y="-25426.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6896" y="-25411.46" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gpu9_expert_mlp1&#45;&gt;layer2_gpu9_expert_act -->
<g id="edge275" class="edge">
<title>layer2_gpu9_expert_mlp1&#45;&gt;layer2_gpu9_expert_act</title>
<path fill="none" stroke="black" d="M6885.87,-25507.55C6887.06,-25499.44 6888.36,-25490.64 6889.61,-25482.13"/>
<polygon fill="black" stroke="black" points="6893.11,-25482.36 6891.1,-25471.96 6886.19,-25481.35 6893.11,-25482.36"/>
</g>
<!-- layer2_gpu9_expert_mlp2 -->
<g id="node238" class="node">
<title>layer2_gpu9_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7106.5,-25367.66 6699.5,-25367.66 6699.5,-25299.66 7106.5,-25299.66 7106.5,-25367.66"/>
<text text-anchor="middle" x="6903" y="-25352.46" font-family="Times,serif" font-size="14.00">Expert 9 MLP2</text>
<text text-anchor="middle" x="6903" y="-25337.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6903" y="-25322.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6903" y="-25307.46" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gpu9_expert_act&#45;&gt;layer2_gpu9_expert_mlp2 -->
<g id="edge276" class="edge">
<title>layer2_gpu9_expert_act&#45;&gt;layer2_gpu9_expert_mlp2</title>
<path fill="none" stroke="black" d="M6898.27,-25403.55C6898.83,-25395.44 6899.43,-25386.64 6900.02,-25378.13"/>
<polygon fill="black" stroke="black" points="6903.52,-25378.18 6900.71,-25367.96 6896.54,-25377.7 6903.52,-25378.18"/>
</g>
<!-- layer2_gpu9_token_send -->
<g id="node239" class="node">
<title>layer2_gpu9_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6933" cy="-25215.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6933" y="-25234.38" font-family="Times,serif" font-size="14.00">Token Send GPU9</text>
<text text-anchor="middle" x="6933" y="-25219.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6933" y="-25204.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6933" y="-25189.38" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gpu9_expert_mlp2&#45;&gt;layer2_gpu9_token_send -->
<g id="edge277" class="edge">
<title>layer2_gpu9_expert_mlp2&#45;&gt;layer2_gpu9_token_send</title>
<path fill="none" stroke="black" d="M6911.6,-25299.4C6913.69,-25291.32 6915.98,-25282.45 6918.26,-25273.61"/>
<polygon fill="black" stroke="black" points="6921.71,-25274.25 6920.83,-25263.69 6914.93,-25272.5 6921.71,-25274.25"/>
</g>
<!-- layer2_gpu9_token_send&#45;&gt;layer2_expert_agg -->
<g id="edge278" class="edge">
<title>layer2_gpu9_token_send&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M6685.26,-25180.99C6565.37,-25164.74 6417.58,-25144.7 6278.59,-25125.86"/>
<polygon fill="black" stroke="black" points="6278.98,-25122.38 6268.6,-25124.5 6278.04,-25129.31 6278.98,-25122.38"/>
</g>
<!-- layer2_gpu10_expert_mlp1 -->
<g id="node241" class="node">
<title>layer2_gpu10_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7808.5,-25575.66 7347.5,-25575.66 7347.5,-25507.66 7808.5,-25507.66 7808.5,-25575.66"/>
<text text-anchor="middle" x="7578" y="-25560.46" font-family="Times,serif" font-size="14.00">Expert 10 MLP1</text>
<text text-anchor="middle" x="7578" y="-25545.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7578" y="-25530.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7578" y="-25515.46" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gpu10_token_recv&#45;&gt;layer2_gpu10_expert_mlp1 -->
<g id="edge280" class="edge">
<title>layer2_gpu10_token_recv&#45;&gt;layer2_gpu10_expert_mlp1</title>
<path fill="none" stroke="black" d="M7570.88,-25611.53C7571.75,-25603.14 7572.65,-25594.45 7573.5,-25586.17"/>
<polygon fill="black" stroke="black" points="7577.01,-25586.27 7574.56,-25575.97 7570.05,-25585.55 7577.01,-25586.27"/>
</g>
<!-- layer2_gpu10_expert_act -->
<g id="node242" class="node">
<title>layer2_gpu10_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7790.5,-25471.66 7413.5,-25471.66 7413.5,-25403.66 7790.5,-25403.66 7790.5,-25471.66"/>
<text text-anchor="middle" x="7602" y="-25456.46" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="7602" y="-25441.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7602" y="-25426.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7602" y="-25411.46" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gpu10_expert_mlp1&#45;&gt;layer2_gpu10_expert_act -->
<g id="edge281" class="edge">
<title>layer2_gpu10_expert_mlp1&#45;&gt;layer2_gpu10_expert_act</title>
<path fill="none" stroke="black" d="M7585.79,-25507.55C7587.72,-25499.35 7589.81,-25490.45 7591.84,-25481.85"/>
<polygon fill="black" stroke="black" points="7595.28,-25482.5 7594.16,-25471.96 7588.47,-25480.89 7595.28,-25482.5"/>
</g>
<!-- layer2_gpu10_expert_mlp2 -->
<g id="node243" class="node">
<title>layer2_gpu10_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7854.5,-25367.66 7447.5,-25367.66 7447.5,-25299.66 7854.5,-25299.66 7854.5,-25367.66"/>
<text text-anchor="middle" x="7651" y="-25352.46" font-family="Times,serif" font-size="14.00">Expert 10 MLP2</text>
<text text-anchor="middle" x="7651" y="-25337.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7651" y="-25322.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="7651" y="-25307.46" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gpu10_expert_act&#45;&gt;layer2_gpu10_expert_mlp2 -->
<g id="edge282" class="edge">
<title>layer2_gpu10_expert_act&#45;&gt;layer2_gpu10_expert_mlp2</title>
<path fill="none" stroke="black" d="M7617.91,-25403.55C7621.97,-25395.08 7626.4,-25385.87 7630.65,-25377.01"/>
<polygon fill="black" stroke="black" points="7633.83,-25378.49 7635,-25367.96 7627.52,-25375.46 7633.83,-25378.49"/>
</g>
<!-- layer2_gpu10_token_send -->
<g id="node244" class="node">
<title>layer2_gpu10_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="7662" cy="-25215.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="7662" y="-25234.38" font-family="Times,serif" font-size="14.00">Token Send GPU10</text>
<text text-anchor="middle" x="7662" y="-25219.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="7662" y="-25204.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="7662" y="-25189.38" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gpu10_expert_mlp2&#45;&gt;layer2_gpu10_token_send -->
<g id="edge283" class="edge">
<title>layer2_gpu10_expert_mlp2&#45;&gt;layer2_gpu10_token_send</title>
<path fill="none" stroke="black" d="M7654.15,-25299.4C7654.91,-25291.4 7655.74,-25282.64 7656.57,-25273.9"/>
<polygon fill="black" stroke="black" points="7660.08,-25273.97 7657.54,-25263.69 7653.11,-25273.31 7660.08,-25273.97"/>
</g>
<!-- layer2_gpu10_token_send&#45;&gt;layer2_expert_agg -->
<g id="edge284" class="edge">
<title>layer2_gpu10_token_send&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M7416.01,-25180.76C7376.59,-25175.92 7336.2,-25171.3 7298,-25167.5 6935.67,-25131.42 6521.91,-25103.65 6225.53,-25086.09"/>
<polygon fill="black" stroke="black" points="6225.67,-25082.59 6215.48,-25085.49 6225.26,-25089.58 6225.67,-25082.59"/>
</g>
<!-- layer2_gpu11_expert_mlp1 -->
<g id="node246" class="node">
<title>layer2_gpu11_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="8502.5,-25575.66 8041.5,-25575.66 8041.5,-25507.66 8502.5,-25507.66 8502.5,-25575.66"/>
<text text-anchor="middle" x="8272" y="-25560.46" font-family="Times,serif" font-size="14.00">Expert 11 MLP1</text>
<text text-anchor="middle" x="8272" y="-25545.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8272" y="-25530.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8272" y="-25515.46" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gpu11_token_recv&#45;&gt;layer2_gpu11_expert_mlp1 -->
<g id="edge286" class="edge">
<title>layer2_gpu11_token_recv&#45;&gt;layer2_gpu11_expert_mlp1</title>
<path fill="none" stroke="black" d="M8261.91,-25611.53C8263.16,-25603.05 8264.44,-25594.25 8265.67,-25585.89"/>
<polygon fill="black" stroke="black" points="8269.14,-25586.37 8267.12,-25575.97 8262.21,-25585.35 8269.14,-25586.37"/>
</g>
<!-- layer2_gpu11_expert_act -->
<g id="node247" class="node">
<title>layer2_gpu11_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="8494.5,-25471.66 8117.5,-25471.66 8117.5,-25403.66 8494.5,-25403.66 8494.5,-25471.66"/>
<text text-anchor="middle" x="8306" y="-25456.46" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="8306" y="-25441.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8306" y="-25426.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8306" y="-25411.46" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gpu11_expert_mlp1&#45;&gt;layer2_gpu11_expert_act -->
<g id="edge287" class="edge">
<title>layer2_gpu11_expert_mlp1&#45;&gt;layer2_gpu11_expert_act</title>
<path fill="none" stroke="black" d="M8283.04,-25507.55C8285.8,-25499.26 8288.8,-25490.26 8291.7,-25481.57"/>
<polygon fill="black" stroke="black" points="8295.06,-25482.56 8294.9,-25471.96 8288.42,-25480.34 8295.06,-25482.56"/>
</g>
<!-- layer2_gpu11_expert_mlp2 -->
<g id="node248" class="node">
<title>layer2_gpu11_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="8578.5,-25367.66 8171.5,-25367.66 8171.5,-25299.66 8578.5,-25299.66 8578.5,-25367.66"/>
<text text-anchor="middle" x="8375" y="-25352.46" font-family="Times,serif" font-size="14.00">Expert 11 MLP2</text>
<text text-anchor="middle" x="8375" y="-25337.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8375" y="-25322.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="8375" y="-25307.46" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gpu11_expert_act&#45;&gt;layer2_gpu11_expert_mlp2 -->
<g id="edge288" class="edge">
<title>layer2_gpu11_expert_act&#45;&gt;layer2_gpu11_expert_mlp2</title>
<path fill="none" stroke="black" d="M8328.4,-25403.55C8334.25,-25394.91 8340.62,-25385.48 8346.73,-25376.46"/>
<polygon fill="black" stroke="black" points="8349.77,-25378.21 8352.47,-25367.96 8343.97,-25374.28 8349.77,-25378.21"/>
</g>
<!-- layer2_gpu11_token_send -->
<g id="node249" class="node">
<title>layer2_gpu11_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="8391" cy="-25215.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="8391" y="-25234.38" font-family="Times,serif" font-size="14.00">Token Send GPU11</text>
<text text-anchor="middle" x="8391" y="-25219.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="8391" y="-25204.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="8391" y="-25189.38" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gpu11_expert_mlp2&#45;&gt;layer2_gpu11_token_send -->
<g id="edge289" class="edge">
<title>layer2_gpu11_expert_mlp2&#45;&gt;layer2_gpu11_token_send</title>
<path fill="none" stroke="black" d="M8379.58,-25299.4C8380.7,-25291.32 8381.92,-25282.45 8383.14,-25273.61"/>
<polygon fill="black" stroke="black" points="8386.61,-25274.07 8384.51,-25263.69 8379.67,-25273.12 8386.61,-25274.07"/>
</g>
<!-- layer2_gpu11_token_send&#45;&gt;layer2_expert_agg -->
<g id="edge290" class="edge">
<title>layer2_gpu11_token_send&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M8148.02,-25180.35C8107.66,-25175.47 8066.2,-25170.94 8027,-25167.5 7390.47,-25111.53 6647.53,-25084.75 6208.05,-25072.89"/>
<polygon fill="black" stroke="black" points="6208.14,-25069.39 6198.05,-25072.62 6207.95,-25076.39 6208.14,-25069.39"/>
</g>
<!-- layer2_gpu12_expert_mlp1 -->
<g id="node251" class="node">
<title>layer2_gpu12_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9195.5,-25575.66 8734.5,-25575.66 8734.5,-25507.66 9195.5,-25507.66 9195.5,-25575.66"/>
<text text-anchor="middle" x="8965" y="-25560.46" font-family="Times,serif" font-size="14.00">Expert 12 MLP1</text>
<text text-anchor="middle" x="8965" y="-25545.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8965" y="-25530.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8965" y="-25515.46" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gpu12_token_recv&#45;&gt;layer2_gpu12_expert_mlp1 -->
<g id="edge292" class="edge">
<title>layer2_gpu12_token_recv&#45;&gt;layer2_gpu12_expert_mlp1</title>
<path fill="none" stroke="black" d="M8951.95,-25611.53C8953.56,-25603.05 8955.22,-25594.25 8956.81,-25585.89"/>
<polygon fill="black" stroke="black" points="8960.26,-25586.44 8958.69,-25575.97 8953.39,-25585.14 8960.26,-25586.44"/>
</g>
<!-- layer2_gpu12_expert_act -->
<g id="node252" class="node">
<title>layer2_gpu12_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9198.5,-25471.66 8821.5,-25471.66 8821.5,-25403.66 9198.5,-25403.66 9198.5,-25471.66"/>
<text text-anchor="middle" x="9010" y="-25456.46" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="9010" y="-25441.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9010" y="-25426.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9010" y="-25411.46" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gpu12_expert_mlp1&#45;&gt;layer2_gpu12_expert_act -->
<g id="edge293" class="edge">
<title>layer2_gpu12_expert_mlp1&#45;&gt;layer2_gpu12_expert_act</title>
<path fill="none" stroke="black" d="M8979.61,-25507.55C8983.3,-25499.17 8987.32,-25490.06 8991.19,-25481.29"/>
<polygon fill="black" stroke="black" points="8994.47,-25482.52 8995.31,-25471.96 8988.07,-25479.7 8994.47,-25482.52"/>
</g>
<!-- layer2_gpu12_expert_mlp2 -->
<g id="node253" class="node">
<title>layer2_gpu12_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9234.5,-25367.66 8827.5,-25367.66 8827.5,-25299.66 9234.5,-25299.66 9234.5,-25367.66"/>
<text text-anchor="middle" x="9031" y="-25352.46" font-family="Times,serif" font-size="14.00">Expert 12 MLP2</text>
<text text-anchor="middle" x="9031" y="-25337.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9031" y="-25322.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9031" y="-25307.46" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gpu12_expert_act&#45;&gt;layer2_gpu12_expert_mlp2 -->
<g id="edge294" class="edge">
<title>layer2_gpu12_expert_act&#45;&gt;layer2_gpu12_expert_mlp2</title>
<path fill="none" stroke="black" d="M9016.82,-25403.55C9018.51,-25395.35 9020.34,-25386.45 9022.11,-25377.85"/>
<polygon fill="black" stroke="black" points="9025.56,-25378.46 9024.14,-25367.96 9018.7,-25377.05 9025.56,-25378.46"/>
</g>
<!-- layer2_gpu12_token_send -->
<g id="node254" class="node">
<title>layer2_gpu12_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9120" cy="-25215.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9120" y="-25234.38" font-family="Times,serif" font-size="14.00">Token Send GPU12</text>
<text text-anchor="middle" x="9120" y="-25219.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9120" y="-25204.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9120" y="-25189.38" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gpu12_expert_mlp2&#45;&gt;layer2_gpu12_token_send -->
<g id="edge295" class="edge">
<title>layer2_gpu12_expert_mlp2&#45;&gt;layer2_gpu12_token_send</title>
<path fill="none" stroke="black" d="M9056.5,-25299.4C9063.1,-25290.8 9070.38,-25281.3 9077.59,-25271.9"/>
<polygon fill="black" stroke="black" points="9080.57,-25273.75 9083.88,-25263.69 9075.02,-25269.5 9080.57,-25273.75"/>
</g>
<!-- layer2_gpu12_token_send&#45;&gt;layer2_expert_agg -->
<g id="edge296" class="edge">
<title>layer2_gpu12_token_send&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M8879.02,-25180.19C8838.04,-25175.26 8795.85,-25170.77 8756,-25167.5 7839.47,-25092.28 6757.24,-25071.93 6199.7,-25066.46"/>
<polygon fill="black" stroke="black" points="6199.53,-25062.96 6189.49,-25066.36 6199.46,-25069.96 6199.53,-25062.96"/>
</g>
<!-- layer2_gpu13_expert_mlp1 -->
<g id="node256" class="node">
<title>layer2_gpu13_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9983.5,-25575.66 9522.5,-25575.66 9522.5,-25507.66 9983.5,-25507.66 9983.5,-25575.66"/>
<text text-anchor="middle" x="9753" y="-25560.46" font-family="Times,serif" font-size="14.00">Expert 13 MLP1</text>
<text text-anchor="middle" x="9753" y="-25545.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9753" y="-25530.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9753" y="-25515.46" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gpu13_token_recv&#45;&gt;layer2_gpu13_expert_mlp1 -->
<g id="edge298" class="edge">
<title>layer2_gpu13_token_recv&#45;&gt;layer2_gpu13_expert_mlp1</title>
<path fill="none" stroke="black" d="M9679.67,-25611.86C9689.88,-25602.24 9700.53,-25592.18 9710.45,-25582.82"/>
<polygon fill="black" stroke="black" points="9713.01,-25585.22 9717.88,-25575.81 9708.2,-25580.13 9713.01,-25585.22"/>
</g>
<!-- layer2_gpu13_expert_act -->
<g id="node257" class="node">
<title>layer2_gpu13_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9955.5,-25471.66 9578.5,-25471.66 9578.5,-25403.66 9955.5,-25403.66 9955.5,-25471.66"/>
<text text-anchor="middle" x="9767" y="-25456.46" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="9767" y="-25441.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9767" y="-25426.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9767" y="-25411.46" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gpu13_expert_mlp1&#45;&gt;layer2_gpu13_expert_act -->
<g id="edge299" class="edge">
<title>layer2_gpu13_expert_mlp1&#45;&gt;layer2_gpu13_expert_act</title>
<path fill="none" stroke="black" d="M9757.55,-25507.55C9758.66,-25499.44 9759.87,-25490.64 9761.03,-25482.13"/>
<polygon fill="black" stroke="black" points="9764.54,-25482.35 9762.43,-25471.96 9757.6,-25481.39 9764.54,-25482.35"/>
</g>
<!-- layer2_gpu13_expert_mlp2 -->
<g id="node258" class="node">
<title>layer2_gpu13_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10025.5,-25367.66 9618.5,-25367.66 9618.5,-25299.66 10025.5,-25299.66 10025.5,-25367.66"/>
<text text-anchor="middle" x="9822" y="-25352.46" font-family="Times,serif" font-size="14.00">Expert 13 MLP2</text>
<text text-anchor="middle" x="9822" y="-25337.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9822" y="-25322.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9822" y="-25307.46" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gpu13_expert_act&#45;&gt;layer2_gpu13_expert_mlp2 -->
<g id="edge300" class="edge">
<title>layer2_gpu13_expert_act&#45;&gt;layer2_gpu13_expert_mlp2</title>
<path fill="none" stroke="black" d="M9784.86,-25403.55C9789.42,-25395.08 9794.39,-25385.87 9799.16,-25377.01"/>
<polygon fill="black" stroke="black" points="9802.38,-25378.43 9804.04,-25367.96 9796.22,-25375.1 9802.38,-25378.43"/>
</g>
<!-- layer2_gpu13_token_send -->
<g id="node259" class="node">
<title>layer2_gpu13_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9849" cy="-25215.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9849" y="-25234.38" font-family="Times,serif" font-size="14.00">Token Send GPU13</text>
<text text-anchor="middle" x="9849" y="-25219.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9849" y="-25204.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9849" y="-25189.38" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gpu13_expert_mlp2&#45;&gt;layer2_gpu13_token_send -->
<g id="edge301" class="edge">
<title>layer2_gpu13_expert_mlp2&#45;&gt;layer2_gpu13_token_send</title>
<path fill="none" stroke="black" d="M9829.74,-25299.4C9831.62,-25291.32 9833.68,-25282.45 9835.74,-25273.61"/>
<polygon fill="black" stroke="black" points="9839.19,-25274.22 9838.04,-25263.69 9832.37,-25272.64 9839.19,-25274.22"/>
</g>
<!-- layer2_gpu13_token_send&#45;&gt;layer2_expert_agg -->
<g id="edge302" class="edge">
<title>layer2_gpu13_token_send&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M9609.01,-25180.07C9567.72,-25175.12 9525.18,-25170.65 9485,-25167.5 8857.12,-25118.18 7008.01,-25083.48 6205.19,-25070.33"/>
<polygon fill="black" stroke="black" points="6204.97,-25066.83 6194.91,-25070.16 6204.85,-25073.83 6204.97,-25066.83"/>
</g>
<!-- layer2_gpu14_expert_mlp1 -->
<g id="node261" class="node">
<title>layer2_gpu14_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="10559.5,-25575.66 10098.5,-25575.66 10098.5,-25507.66 10559.5,-25507.66 10559.5,-25575.66"/>
<text text-anchor="middle" x="10329" y="-25560.46" font-family="Times,serif" font-size="14.00">Expert 14 MLP1</text>
<text text-anchor="middle" x="10329" y="-25545.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10329" y="-25530.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10329" y="-25515.46" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gpu14_token_recv&#45;&gt;layer2_gpu14_expert_mlp1 -->
<g id="edge304" class="edge">
<title>layer2_gpu14_token_recv&#45;&gt;layer2_gpu14_expert_mlp1</title>
<path fill="none" stroke="black" d="M10321.88,-25611.53C10322.75,-25603.14 10323.65,-25594.45 10324.5,-25586.17"/>
<polygon fill="black" stroke="black" points="10328.01,-25586.27 10325.56,-25575.97 10321.05,-25585.55 10328.01,-25586.27"/>
</g>
<!-- layer2_gpu14_expert_act -->
<g id="node262" class="node">
<title>layer2_gpu14_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="10651.5,-25471.66 10274.5,-25471.66 10274.5,-25403.66 10651.5,-25403.66 10651.5,-25471.66"/>
<text text-anchor="middle" x="10463" y="-25456.46" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="10463" y="-25441.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10463" y="-25426.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10463" y="-25411.46" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gpu14_expert_mlp1&#45;&gt;layer2_gpu14_expert_act -->
<g id="edge305" class="edge">
<title>layer2_gpu14_expert_mlp1&#45;&gt;layer2_gpu14_expert_act</title>
<path fill="none" stroke="black" d="M10372.51,-25507.55C10384.79,-25498.19 10398.29,-25487.92 10411.02,-25478.23"/>
<polygon fill="black" stroke="black" points="10413.42,-25480.8 10419.25,-25471.96 10409.18,-25475.23 10413.42,-25480.8"/>
</g>
<!-- layer2_gpu14_expert_mlp2 -->
<g id="node263" class="node">
<title>layer2_gpu14_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10769.5,-25367.66 10362.5,-25367.66 10362.5,-25299.66 10769.5,-25299.66 10769.5,-25367.66"/>
<text text-anchor="middle" x="10566" y="-25352.46" font-family="Times,serif" font-size="14.00">Expert 14 MLP2</text>
<text text-anchor="middle" x="10566" y="-25337.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10566" y="-25322.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="10566" y="-25307.46" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gpu14_expert_act&#45;&gt;layer2_gpu14_expert_mlp2 -->
<g id="edge306" class="edge">
<title>layer2_gpu14_expert_act&#45;&gt;layer2_gpu14_expert_mlp2</title>
<path fill="none" stroke="black" d="M10496.44,-25403.55C10505.62,-25394.46 10515.67,-25384.51 10525.2,-25375.06"/>
<polygon fill="black" stroke="black" points="10527.73,-25377.49 10532.37,-25367.96 10522.81,-25372.51 10527.73,-25377.49"/>
</g>
<!-- layer2_gpu14_token_send -->
<g id="node264" class="node">
<title>layer2_gpu14_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="10578" cy="-25215.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="10578" y="-25234.38" font-family="Times,serif" font-size="14.00">Token Send GPU14</text>
<text text-anchor="middle" x="10578" y="-25219.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="10578" y="-25204.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="10578" y="-25189.38" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gpu14_expert_mlp2&#45;&gt;layer2_gpu14_token_send -->
<g id="edge307" class="edge">
<title>layer2_gpu14_expert_mlp2&#45;&gt;layer2_gpu14_token_send</title>
<path fill="none" stroke="black" d="M10569.44,-25299.4C10570.27,-25291.4 10571.17,-25282.64 10572.08,-25273.9"/>
<polygon fill="black" stroke="black" points="10575.58,-25274 10573.13,-25263.69 10568.62,-25273.28 10575.58,-25274"/>
</g>
<!-- layer2_gpu14_token_send&#45;&gt;layer2_expert_agg -->
<g id="edge308" class="edge">
<title>layer2_gpu14_token_send&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M10338.52,-25179.96C10297.07,-25175.02 10254.35,-25170.57 10214,-25167.5 9439.7,-25108.5 7116.98,-25078.15 6202.17,-25068.24"/>
<polygon fill="black" stroke="black" points="6202.18,-25064.74 6192.14,-25068.13 6202.1,-25071.74 6202.18,-25064.74"/>
</g>
<!-- layer2_gpu15_expert_mlp1 -->
<g id="node266" class="node">
<title>layer2_gpu15_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="11247.5,-25575.66 10786.5,-25575.66 10786.5,-25507.66 11247.5,-25507.66 11247.5,-25575.66"/>
<text text-anchor="middle" x="11017" y="-25560.46" font-family="Times,serif" font-size="14.00">Expert 15 MLP1</text>
<text text-anchor="middle" x="11017" y="-25545.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="11017" y="-25530.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11017" y="-25515.46" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gpu15_token_recv&#45;&gt;layer2_gpu15_expert_mlp1 -->
<g id="edge310" class="edge">
<title>layer2_gpu15_token_recv&#45;&gt;layer2_gpu15_expert_mlp1</title>
<path fill="none" stroke="black" d="M11009.29,-25611.53C11010.23,-25603.14 11011.2,-25594.45 11012.13,-25586.17"/>
<polygon fill="black" stroke="black" points="11015.64,-25586.29 11013.27,-25575.97 11008.68,-25585.51 11015.64,-25586.29"/>
</g>
<!-- layer2_gpu15_expert_act -->
<g id="node267" class="node">
<title>layer2_gpu15_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="11231.5,-25471.66 10854.5,-25471.66 10854.5,-25403.66 11231.5,-25403.66 11231.5,-25471.66"/>
<text text-anchor="middle" x="11043" y="-25456.46" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="11043" y="-25441.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11043" y="-25426.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11043" y="-25411.46" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gpu15_expert_mlp1&#45;&gt;layer2_gpu15_expert_act -->
<g id="edge311" class="edge">
<title>layer2_gpu15_expert_mlp1&#45;&gt;layer2_gpu15_expert_act</title>
<path fill="none" stroke="black" d="M11025.44,-25507.55C11027.53,-25499.35 11029.8,-25490.45 11031.99,-25481.85"/>
<polygon fill="black" stroke="black" points="11035.43,-25482.52 11034.51,-25471.96 11028.65,-25480.79 11035.43,-25482.52"/>
</g>
<!-- layer2_gpu15_expert_mlp2 -->
<g id="node268" class="node">
<title>layer2_gpu15_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="11246.5,-25367.66 10839.5,-25367.66 10839.5,-25299.66 11246.5,-25299.66 11246.5,-25367.66"/>
<text text-anchor="middle" x="11043" y="-25352.46" font-family="Times,serif" font-size="14.00">Expert 15 MLP2</text>
<text text-anchor="middle" x="11043" y="-25337.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11043" y="-25322.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="11043" y="-25307.46" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gpu15_expert_act&#45;&gt;layer2_gpu15_expert_mlp2 -->
<g id="edge312" class="edge">
<title>layer2_gpu15_expert_act&#45;&gt;layer2_gpu15_expert_mlp2</title>
<path fill="none" stroke="black" d="M11043,-25403.55C11043,-25395.44 11043,-25386.64 11043,-25378.13"/>
<polygon fill="black" stroke="black" points="11046.5,-25377.96 11043,-25367.96 11039.5,-25377.96 11046.5,-25377.96"/>
</g>
<!-- layer2_gpu15_token_send -->
<g id="node269" class="node">
<title>layer2_gpu15_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="11307" cy="-25215.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="11307" y="-25234.38" font-family="Times,serif" font-size="14.00">Token Send GPU15</text>
<text text-anchor="middle" x="11307" y="-25219.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="11307" y="-25204.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="11307" y="-25189.38" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gpu15_expert_mlp2&#45;&gt;layer2_gpu15_token_send -->
<g id="edge313" class="edge">
<title>layer2_gpu15_expert_mlp2&#45;&gt;layer2_gpu15_token_send</title>
<path fill="none" stroke="black" d="M11118.3,-25299.55C11142.19,-25289.05 11169.14,-25277.2 11195.03,-25265.81"/>
<polygon fill="black" stroke="black" points="11196.77,-25268.87 11204.52,-25261.64 11193.95,-25262.46 11196.77,-25268.87"/>
</g>
<!-- layer2_gpu15_token_send&#45;&gt;layer2_expert_agg -->
<g id="edge314" class="edge">
<title>layer2_gpu15_token_send&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M11068.01,-25179.91C11026.42,-25174.95 10983.51,-25170.51 10943,-25167.5 10021.19,-25098.8 7217.73,-25073.73 6200.12,-25066.75"/>
<polygon fill="black" stroke="black" points="6200.11,-25063.25 6190.08,-25066.68 6200.06,-25070.25 6200.11,-25063.25"/>
</g>
<!-- layer2_residual2 -->
<g id="node271" class="node">
<title>layer2_residual2</title>
<polygon fill="lightyellow" stroke="black" points="6268.89,-24959.5 5564.35,-24959.5 5383.11,-24823.5 6087.65,-24823.5 6268.89,-24959.5"/>
<text text-anchor="middle" x="5826" y="-24910.3" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="5826" y="-24895.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5826" y="-24880.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5826" y="-24865.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer2_expert_agg&#45;&gt;layer2_residual2 -->
<g id="edge315" class="edge">
<title>layer2_expert_agg&#45;&gt;layer2_residual2</title>
<path fill="none" stroke="black" d="M5826,-24995.31C5826,-24986.99 5826,-24978.44 5826,-24969.99"/>
<polygon fill="black" stroke="black" points="5829.5,-24969.75 5826,-24959.75 5822.5,-24969.75 5829.5,-24969.75"/>
</g>
<!-- layer3_layernorm -->
<g id="node272" class="node">
<title>layer3_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="6029.5,-24776.5 5622.5,-24776.5 5622.5,-24708.5 6029.5,-24708.5 6029.5,-24776.5"/>
<text text-anchor="middle" x="5826" y="-24761.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5826" y="-24746.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5826" y="-24731.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5826" y="-24716.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer2_residual2&#45;&gt;layer3_layernorm -->
<g id="edge316" class="edge">
<title>layer2_residual2&#45;&gt;layer3_layernorm</title>
<path fill="none" stroke="black" d="M5826,-24823.45C5826,-24811.04 5826,-24798.39 5826,-24786.92"/>
<polygon fill="black" stroke="black" points="5829.5,-24786.75 5826,-24776.75 5822.5,-24786.75 5829.5,-24786.75"/>
</g>
<!-- layer3_qkv_proj -->
<g id="node273" class="node">
<title>layer3_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="6083.5,-24672.5 5568.5,-24672.5 5568.5,-24604.5 6083.5,-24604.5 6083.5,-24672.5"/>
<text text-anchor="middle" x="5826" y="-24657.3" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5826" y="-24642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5826" y="-24627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5826" y="-24612.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer3_layernorm&#45;&gt;layer3_qkv_proj -->
<g id="edge317" class="edge">
<title>layer3_layernorm&#45;&gt;layer3_qkv_proj</title>
<path fill="none" stroke="black" d="M5826,-24708.38C5826,-24700.27 5826,-24691.48 5826,-24682.97"/>
<polygon fill="black" stroke="black" points="5829.5,-24682.8 5826,-24672.8 5822.5,-24682.8 5829.5,-24682.8"/>
</g>
<!-- layer3_attention -->
<g id="node274" class="node">
<title>layer3_attention</title>
<polygon fill="lightgreen" stroke="black" points="6077.5,-24568.5 5574.5,-24568.5 5574.5,-24500.5 6077.5,-24500.5 6077.5,-24568.5"/>
<text text-anchor="middle" x="5826" y="-24553.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5826" y="-24538.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5826" y="-24523.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5826" y="-24508.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer3_qkv_proj&#45;&gt;layer3_attention -->
<g id="edge318" class="edge">
<title>layer3_qkv_proj&#45;&gt;layer3_attention</title>
<path fill="none" stroke="black" d="M5826,-24604.38C5826,-24596.27 5826,-24587.48 5826,-24578.97"/>
<polygon fill="black" stroke="black" points="5829.5,-24578.8 5826,-24568.8 5822.5,-24578.8 5829.5,-24578.8"/>
</g>
<!-- layer3_attn_out -->
<g id="node275" class="node">
<title>layer3_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="6064.5,-24464.5 5587.5,-24464.5 5587.5,-24396.5 6064.5,-24396.5 6064.5,-24464.5"/>
<text text-anchor="middle" x="5826" y="-24449.3" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5826" y="-24434.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5826" y="-24419.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5826" y="-24404.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer3_attention&#45;&gt;layer3_attn_out -->
<g id="edge319" class="edge">
<title>layer3_attention&#45;&gt;layer3_attn_out</title>
<path fill="none" stroke="black" d="M5826,-24500.38C5826,-24492.27 5826,-24483.48 5826,-24474.97"/>
<polygon fill="black" stroke="black" points="5829.5,-24474.8 5826,-24464.8 5822.5,-24474.8 5829.5,-24474.8"/>
</g>
<!-- layer3_residual1 -->
<g id="node276" class="node">
<title>layer3_residual1</title>
<polygon fill="lightyellow" stroke="black" points="6268.89,-24360.5 5564.35,-24360.5 5383.11,-24224.5 6087.65,-24224.5 6268.89,-24360.5"/>
<text text-anchor="middle" x="5826" y="-24311.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5826" y="-24296.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5826" y="-24281.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5826" y="-24266.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer3_attn_out&#45;&gt;layer3_residual1 -->
<g id="edge320" class="edge">
<title>layer3_attn_out&#45;&gt;layer3_residual1</title>
<path fill="none" stroke="black" d="M5826,-24396.23C5826,-24388.4 5826,-24379.73 5826,-24370.85"/>
<polygon fill="black" stroke="black" points="5829.5,-24370.76 5826,-24360.76 5822.5,-24370.76 5829.5,-24370.76"/>
</g>
<!-- layer3_layernorm2 -->
<g id="node277" class="node">
<title>layer3_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="6029.5,-24188.5 5622.5,-24188.5 5622.5,-24120.5 6029.5,-24120.5 6029.5,-24188.5"/>
<text text-anchor="middle" x="5826" y="-24173.3" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5826" y="-24158.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5826" y="-24143.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5826" y="-24128.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer3_residual1&#45;&gt;layer3_layernorm2 -->
<g id="edge321" class="edge">
<title>layer3_residual1&#45;&gt;layer3_layernorm2</title>
<path fill="none" stroke="black" d="M5826,-24224.29C5826,-24215.54 5826,-24206.77 5826,-24198.56"/>
<polygon fill="black" stroke="black" points="5829.5,-24198.51 5826,-24188.51 5822.5,-24198.51 5829.5,-24198.51"/>
</g>
<!-- layer3_global_gate -->
<g id="node278" class="node">
<title>layer3_global_gate</title>
<polygon fill="lightgreen" stroke="black" points="6023.5,-24084.5 5628.5,-24084.5 5628.5,-24016.5 6023.5,-24016.5 6023.5,-24084.5"/>
<text text-anchor="middle" x="5826" y="-24069.3" font-family="Times,serif" font-size="14.00">Global Gate</text>
<text text-anchor="middle" x="5826" y="-24054.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5826" y="-24039.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, experts=64]</text>
<text text-anchor="middle" x="5826" y="-24024.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer3_layernorm2&#45;&gt;layer3_global_gate -->
<g id="edge322" class="edge">
<title>layer3_layernorm2&#45;&gt;layer3_global_gate</title>
<path fill="none" stroke="black" d="M5826,-24120.38C5826,-24112.27 5826,-24103.48 5826,-24094.97"/>
<polygon fill="black" stroke="black" points="5829.5,-24094.8 5826,-24084.8 5822.5,-24094.8 5829.5,-24094.8"/>
</g>
<!-- layer3_routing -->
<g id="node279" class="node">
<title>layer3_routing</title>
<polygon fill="lightyellow" stroke="black" points="6312.47,-23980.5 5538.6,-23980.5 5339.53,-23844.5 6113.4,-23844.5 6312.47,-23980.5"/>
<text text-anchor="middle" x="5826" y="-23931.3" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="5826" y="-23916.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5826" y="-23901.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5826" y="-23886.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer3_global_gate&#45;&gt;layer3_routing -->
<g id="edge323" class="edge">
<title>layer3_global_gate&#45;&gt;layer3_routing</title>
<path fill="none" stroke="black" d="M5826,-24016.23C5826,-24008.4 5826,-23999.73 5826,-23990.85"/>
<polygon fill="black" stroke="black" points="5829.5,-23990.76 5826,-23980.76 5822.5,-23990.76 5829.5,-23990.76"/>
</g>
<!-- layer3_gpu0_token_recv -->
<g id="node280" class="node">
<title>layer3_gpu0_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="496" cy="-23760.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="496" y="-23779.21" font-family="Times,serif" font-size="14.00">Token Receive GPU0</text>
<text text-anchor="middle" x="496" y="-23764.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="496" y="-23749.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="496" y="-23734.21" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_routing&#45;&gt;layer3_gpu0_token_recv -->
<g id="edge324" class="edge">
<title>layer3_routing&#45;&gt;layer3_gpu0_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5432.38,-23908.06C4426.67,-23898.49 1780.28,-23868.28 903,-23808.5 853.35,-23805.11 800.44,-23800.06 749.76,-23794.51"/>
<polygon fill="black" stroke="black" points="749.98,-23791.01 739.66,-23793.39 749.21,-23797.97 749.98,-23791.01"/>
</g>
<!-- layer3_gpu1_token_recv -->
<g id="node285" class="node">
<title>layer3_gpu1_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1246" cy="-23760.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1246" y="-23779.21" font-family="Times,serif" font-size="14.00">Token Receive GPU1</text>
<text text-anchor="middle" x="1246" y="-23764.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1246" y="-23749.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1246" y="-23734.21" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_routing&#45;&gt;layer3_gpu1_token_recv -->
<g id="edge330" class="edge">
<title>layer3_routing&#45;&gt;layer3_gpu1_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5430.56,-23906.89C4531.11,-23895.58 2353.43,-23863.31 1621,-23808.5 1578.96,-23805.35 1534.41,-23800.82 1491.24,-23795.79"/>
<polygon fill="black" stroke="black" points="1491.53,-23792.3 1481.19,-23794.61 1490.71,-23799.25 1491.53,-23792.3"/>
</g>
<!-- layer3_gpu2_token_recv -->
<g id="node290" class="node">
<title>layer3_gpu2_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1964" cy="-23760.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1964" y="-23779.21" font-family="Times,serif" font-size="14.00">Token Receive GPU2</text>
<text text-anchor="middle" x="1964" y="-23764.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1964" y="-23749.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1964" y="-23734.21" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_routing&#45;&gt;layer3_gpu2_token_recv -->
<g id="edge336" class="edge">
<title>layer3_routing&#45;&gt;layer3_gpu2_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5427.59,-23904.83C4641.5,-23890.85 2915.82,-23855.78 2324,-23808.5 2285.63,-23805.43 2245.07,-23801.15 2205.56,-23796.4"/>
<polygon fill="black" stroke="black" points="2205.89,-23792.92 2195.54,-23795.19 2205.05,-23799.87 2205.89,-23792.92"/>
</g>
<!-- layer3_gpu3_token_recv -->
<g id="node295" class="node">
<title>layer3_gpu3_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="2667" cy="-23760.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2667" y="-23779.21" font-family="Times,serif" font-size="14.00">Token Receive GPU3</text>
<text text-anchor="middle" x="2667" y="-23764.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="2667" y="-23749.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2667" y="-23734.21" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_routing&#45;&gt;layer3_gpu3_token_recv -->
<g id="edge342" class="edge">
<title>layer3_routing&#45;&gt;layer3_gpu3_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5432.6,-23908.12C4891.78,-23900.93 3888.64,-23878.49 3036,-23808.5 2996.01,-23805.21 2953.7,-23800.75 2912.55,-23795.87"/>
<polygon fill="black" stroke="black" points="2912.74,-23792.37 2902.39,-23794.66 2911.91,-23799.32 2912.74,-23792.37"/>
</g>
<!-- layer3_gpu4_token_recv -->
<g id="node300" class="node">
<title>layer3_gpu4_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="3379" cy="-23760.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="3379" y="-23779.21" font-family="Times,serif" font-size="14.00">Token Receive GPU4</text>
<text text-anchor="middle" x="3379" y="-23764.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="3379" y="-23749.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3379" y="-23734.21" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_routing&#45;&gt;layer3_gpu4_token_recv -->
<g id="edge348" class="edge">
<title>layer3_routing&#45;&gt;layer3_gpu4_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5422.41,-23901.35C5001.16,-23888.47 4321.73,-23861.27 3737,-23808.5 3700.03,-23805.16 3661.02,-23800.85 3622.87,-23796.19"/>
<polygon fill="black" stroke="black" points="3623.02,-23792.68 3612.67,-23794.93 3622.17,-23799.63 3623.02,-23792.68"/>
</g>
<!-- layer3_gpu5_token_recv -->
<g id="node305" class="node">
<title>layer3_gpu5_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4080" cy="-23760.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4080" y="-23779.21" font-family="Times,serif" font-size="14.00">Token Receive GPU5</text>
<text text-anchor="middle" x="4080" y="-23764.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4080" y="-23749.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4080" y="-23734.21" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_routing&#45;&gt;layer3_gpu5_token_recv -->
<g id="edge354" class="edge">
<title>layer3_routing&#45;&gt;layer3_gpu5_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5401.13,-23886.72C5124.45,-23868.97 4755.88,-23842.25 4431,-23808.5 4396.48,-23804.91 4360.12,-23800.62 4324.41,-23796.1"/>
<polygon fill="black" stroke="black" points="4324.72,-23792.61 4314.36,-23794.82 4323.84,-23799.56 4324.72,-23792.61"/>
</g>
<!-- layer3_gpu6_token_recv -->
<g id="node310" class="node">
<title>layer3_gpu6_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4774" cy="-23760.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4774" y="-23779.21" font-family="Times,serif" font-size="14.00">Token Receive GPU6</text>
<text text-anchor="middle" x="4774" y="-23764.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4774" y="-23749.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4774" y="-23734.21" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_routing&#45;&gt;layer3_gpu6_token_recv -->
<g id="edge360" class="edge">
<title>layer3_routing&#45;&gt;layer3_gpu6_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5356.15,-23844.47C5239.45,-23827.82 5119.02,-23810.64 5018.2,-23796.25"/>
<polygon fill="black" stroke="black" points="5018.58,-23792.77 5008.19,-23794.82 5017.6,-23799.7 5018.58,-23792.77"/>
</g>
<!-- layer3_gpu7_token_recv -->
<g id="node315" class="node">
<title>layer3_gpu7_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="5482" cy="-23760.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="5482" y="-23779.21" font-family="Times,serif" font-size="14.00">Token Receive GPU7</text>
<text text-anchor="middle" x="5482" y="-23764.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5482" y="-23749.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5482" y="-23734.21" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_routing&#45;&gt;layer3_gpu7_token_recv -->
<g id="edge366" class="edge">
<title>layer3_routing&#45;&gt;layer3_gpu7_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5672.36,-23844.47C5646.17,-23833.04 5619.4,-23821.36 5594.52,-23810.51"/>
<polygon fill="black" stroke="black" points="5595.65,-23807.18 5585.09,-23806.39 5592.85,-23813.6 5595.65,-23807.18"/>
</g>
<!-- layer3_gpu8_token_recv -->
<g id="node320" class="node">
<title>layer3_gpu8_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6170" cy="-23760.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6170" y="-23779.21" font-family="Times,serif" font-size="14.00">Token Receive GPU8</text>
<text text-anchor="middle" x="6170" y="-23764.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6170" y="-23749.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6170" y="-23734.21" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_routing&#45;&gt;layer3_gpu8_token_recv -->
<g id="edge372" class="edge">
<title>layer3_routing&#45;&gt;layer3_gpu8_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5979.64,-23844.47C6005.83,-23833.04 6032.6,-23821.36 6057.48,-23810.51"/>
<polygon fill="black" stroke="black" points="6059.15,-23813.6 6066.91,-23806.39 6056.35,-23807.18 6059.15,-23813.6"/>
</g>
<!-- layer3_gpu9_token_recv -->
<g id="node325" class="node">
<title>layer3_gpu9_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6857" cy="-23760.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6857" y="-23779.21" font-family="Times,serif" font-size="14.00">Token Receive GPU9</text>
<text text-anchor="middle" x="6857" y="-23764.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6857" y="-23749.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6857" y="-23734.21" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_routing&#45;&gt;layer3_gpu9_token_recv -->
<g id="edge378" class="edge">
<title>layer3_routing&#45;&gt;layer3_gpu9_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6144.1,-23865.19C6295.9,-23843.09 6474.6,-23817.08 6615.11,-23796.63"/>
<polygon fill="black" stroke="black" points="6615.77,-23800.07 6625.16,-23795.16 6614.76,-23793.14 6615.77,-23800.07"/>
</g>
<!-- layer3_gpu10_token_recv -->
<g id="node330" class="node">
<title>layer3_gpu10_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="7544" cy="-23760.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="7544" y="-23779.21" font-family="Times,serif" font-size="14.00">Token Receive GPU10</text>
<text text-anchor="middle" x="7544" y="-23764.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="7544" y="-23749.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7544" y="-23734.21" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_routing&#45;&gt;layer3_gpu10_token_recv -->
<g id="edge384" class="edge">
<title>layer3_routing&#45;&gt;layer3_gpu10_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6181.32,-23890.85C6459.06,-23873.26 6854.62,-23845.04 7200,-23808.5 7233.01,-23805 7267.73,-23800.83 7301.91,-23796.44"/>
<polygon fill="black" stroke="black" points="7302.54,-23799.89 7312.01,-23795.14 7301.64,-23792.95 7302.54,-23799.89"/>
</g>
<!-- layer3_gpu11_token_recv -->
<g id="node335" class="node">
<title>layer3_gpu11_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8231" cy="-23760.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8231" y="-23779.21" font-family="Times,serif" font-size="14.00">Token Receive GPU11</text>
<text text-anchor="middle" x="8231" y="-23764.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8231" y="-23749.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8231" y="-23734.21" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_routing&#45;&gt;layer3_gpu11_token_recv -->
<g id="edge390" class="edge">
<title>layer3_routing&#45;&gt;layer3_gpu11_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6198.54,-23902.52C6611.86,-23890.32 7298.2,-23863.4 7887,-23808.5 7921.15,-23805.31 7957.11,-23801.22 7992.4,-23796.77"/>
<polygon fill="black" stroke="black" points="7992.85,-23800.24 8002.33,-23795.51 7991.97,-23793.3 7992.85,-23800.24"/>
</g>
<!-- layer3_gpu12_token_recv -->
<g id="node340" class="node">
<title>layer3_gpu12_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8918" cy="-23760.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8918" y="-23779.21" font-family="Times,serif" font-size="14.00">Token Receive GPU12</text>
<text text-anchor="middle" x="8918" y="-23764.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8918" y="-23749.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8918" y="-23734.21" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_routing&#45;&gt;layer3_gpu12_token_recv -->
<g id="edge396" class="edge">
<title>layer3_routing&#45;&gt;layer3_gpu12_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6207.93,-23909.05C6739.36,-23902.95 7731.55,-23881.76 8574,-23808.5 8608.58,-23805.49 8645.01,-23801.45 8680.71,-23797"/>
<polygon fill="black" stroke="black" points="8681.27,-23800.46 8690.76,-23795.74 8680.4,-23793.51 8681.27,-23800.46"/>
</g>
<!-- layer3_gpu13_token_recv -->
<g id="node345" class="node">
<title>layer3_gpu13_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="9605" cy="-23760.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="9605" y="-23779.21" font-family="Times,serif" font-size="14.00">Token Receive GPU13</text>
<text text-anchor="middle" x="9605" y="-23764.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="9605" y="-23749.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9605" y="-23734.21" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_routing&#45;&gt;layer3_gpu13_token_recv -->
<g id="edge402" class="edge">
<title>layer3_routing&#45;&gt;layer3_gpu13_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6202.48,-23905.25C6966.72,-23891.75 8677.02,-23857.08 9261,-23808.5 9295.87,-23805.6 9332.61,-23801.59 9368.58,-23797.13"/>
<polygon fill="black" stroke="black" points="9369.22,-23800.58 9378.7,-23795.86 9368.34,-23793.63 9369.22,-23800.58"/>
</g>
<!-- layer3_gpu14_token_recv -->
<g id="node350" class="node">
<title>layer3_gpu14_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10292" cy="-23760.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10292" y="-23779.21" font-family="Times,serif" font-size="14.00">Token Receive GPU14</text>
<text text-anchor="middle" x="10292" y="-23764.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10292" y="-23749.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10292" y="-23734.21" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_routing&#45;&gt;layer3_gpu14_token_recv -->
<g id="edge408" class="edge">
<title>layer3_routing&#45;&gt;layer3_gpu14_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6205.5,-23907.41C7082.19,-23897.09 9228.12,-23866.58 9948,-23808.5 9983.01,-23805.67 10019.91,-23801.69 10056.02,-23797.23"/>
<polygon fill="black" stroke="black" points="10056.69,-23800.68 10066.18,-23795.96 10055.82,-23793.73 10056.69,-23800.68"/>
</g>
<!-- layer3_gpu15_token_recv -->
<g id="node355" class="node">
<title>layer3_gpu15_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10979" cy="-23760.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10979" y="-23779.21" font-family="Times,serif" font-size="14.00">Token Receive GPU15</text>
<text text-anchor="middle" x="10979" y="-23764.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10979" y="-23749.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10979" y="-23734.21" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_routing&#45;&gt;layer3_gpu15_token_recv -->
<g id="edge414" class="edge">
<title>layer3_routing&#45;&gt;layer3_gpu15_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6207.89,-23908.97C7188.47,-23901.59 9777.91,-23876.11 10635,-23808.5 10670.15,-23805.72 10707.21,-23801.76 10743.45,-23797.29"/>
<polygon fill="black" stroke="black" points="10744.16,-23800.73 10753.65,-23796.02 10743.29,-23793.78 10744.16,-23800.73"/>
</g>
<!-- layer3_gpu0_expert_mlp1 -->
<g id="node281" class="node">
<title>layer3_gpu0_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="718.5,-23676.33 257.5,-23676.33 257.5,-23608.33 718.5,-23608.33 718.5,-23676.33"/>
<text text-anchor="middle" x="488" y="-23661.13" font-family="Times,serif" font-size="14.00">Expert 0 MLP1</text>
<text text-anchor="middle" x="488" y="-23646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="488" y="-23631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="488" y="-23616.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gpu0_token_recv&#45;&gt;layer3_gpu0_expert_mlp1 -->
<g id="edge325" class="edge">
<title>layer3_gpu0_token_recv&#45;&gt;layer3_gpu0_expert_mlp1</title>
<path fill="none" stroke="black" d="M492.75,-23712.2C492.17,-23703.81 491.57,-23695.11 491,-23686.84"/>
<polygon fill="black" stroke="black" points="494.47,-23686.37 490.3,-23676.63 487.49,-23686.85 494.47,-23686.37"/>
</g>
<!-- layer3_gpu0_expert_act -->
<g id="node282" class="node">
<title>layer3_gpu0_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="657.5,-23572.33 280.5,-23572.33 280.5,-23504.33 657.5,-23504.33 657.5,-23572.33"/>
<text text-anchor="middle" x="469" y="-23557.13" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="469" y="-23542.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="469" y="-23527.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="469" y="-23512.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gpu0_expert_mlp1&#45;&gt;layer3_gpu0_expert_act -->
<g id="edge326" class="edge">
<title>layer3_gpu0_expert_mlp1&#45;&gt;layer3_gpu0_expert_act</title>
<path fill="none" stroke="black" d="M481.83,-23608.21C480.3,-23600.02 478.65,-23591.12 477.05,-23582.52"/>
<polygon fill="black" stroke="black" points="480.47,-23581.82 475.2,-23572.63 473.59,-23583.1 480.47,-23581.82"/>
</g>
<!-- layer3_gpu0_expert_mlp2 -->
<g id="node283" class="node">
<title>layer3_gpu0_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="624.5,-23468.33 217.5,-23468.33 217.5,-23400.33 624.5,-23400.33 624.5,-23468.33"/>
<text text-anchor="middle" x="421" y="-23453.13" font-family="Times,serif" font-size="14.00">Expert 0 MLP2</text>
<text text-anchor="middle" x="421" y="-23438.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="421" y="-23423.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="421" y="-23408.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gpu0_expert_act&#45;&gt;layer3_gpu0_expert_mlp2 -->
<g id="edge327" class="edge">
<title>layer3_gpu0_expert_act&#45;&gt;layer3_gpu0_expert_mlp2</title>
<path fill="none" stroke="black" d="M453.42,-23504.21C449.43,-23495.75 445.1,-23486.54 440.93,-23477.68"/>
<polygon fill="black" stroke="black" points="444.1,-23476.19 436.67,-23468.63 437.76,-23479.17 444.1,-23476.19"/>
</g>
<!-- layer3_gpu0_token_send -->
<g id="node284" class="node">
<title>layer3_gpu0_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="372" cy="-23316.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="372" y="-23335.05" font-family="Times,serif" font-size="14.00">Token Send GPU0</text>
<text text-anchor="middle" x="372" y="-23320.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="372" y="-23305.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="372" y="-23290.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gpu0_expert_mlp2&#45;&gt;layer3_gpu0_token_send -->
<g id="edge328" class="edge">
<title>layer3_gpu0_expert_mlp2&#45;&gt;layer3_gpu0_token_send</title>
<path fill="none" stroke="black" d="M406.96,-23400.06C403.47,-23391.81 399.64,-23382.73 395.83,-23373.71"/>
<polygon fill="black" stroke="black" points="399,-23372.21 391.89,-23364.36 392.55,-23374.93 399,-23372.21"/>
</g>
<!-- layer3_expert_agg -->
<g id="node360" class="node">
<title>layer3_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="5929.05,-23232.16 5209.94,-23232.16 5024.95,-23096.16 5744.06,-23096.16 5929.05,-23232.16"/>
<text text-anchor="middle" x="5477" y="-23182.96" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5477" y="-23167.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x16)</text>
<text text-anchor="middle" x="5477" y="-23152.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-23137.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer3_gpu0_token_send&#45;&gt;layer3_expert_agg -->
<g id="edge329" class="edge">
<title>layer3_gpu0_token_send&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M610.99,-23280.63C652.59,-23275.67 695.49,-23271.21 736,-23268.16 1584.6,-23204.25 4154.44,-23176.39 5112.12,-23168.04"/>
<polygon fill="black" stroke="black" points="5112.29,-23171.54 5122.26,-23167.95 5112.23,-23164.54 5112.29,-23171.54"/>
</g>
<!-- layer3_gpu1_expert_mlp1 -->
<g id="node286" class="node">
<title>layer3_gpu1_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="1458.5,-23676.33 997.5,-23676.33 997.5,-23608.33 1458.5,-23608.33 1458.5,-23676.33"/>
<text text-anchor="middle" x="1228" y="-23661.13" font-family="Times,serif" font-size="14.00">Expert 1 MLP1</text>
<text text-anchor="middle" x="1228" y="-23646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1228" y="-23631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1228" y="-23616.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gpu1_token_recv&#45;&gt;layer3_gpu1_expert_mlp1 -->
<g id="edge331" class="edge">
<title>layer3_gpu1_token_recv&#45;&gt;layer3_gpu1_expert_mlp1</title>
<path fill="none" stroke="black" d="M1238.68,-23712.2C1237.36,-23703.72 1236,-23694.92 1234.7,-23686.56"/>
<polygon fill="black" stroke="black" points="1238.16,-23685.98 1233.16,-23676.63 1231.24,-23687.05 1238.16,-23685.98"/>
</g>
<!-- layer3_gpu1_expert_act -->
<g id="node287" class="node">
<title>layer3_gpu1_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="1378.5,-23572.33 1001.5,-23572.33 1001.5,-23504.33 1378.5,-23504.33 1378.5,-23572.33"/>
<text text-anchor="middle" x="1190" y="-23557.13" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1190" y="-23542.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1190" y="-23527.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1190" y="-23512.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gpu1_expert_mlp1&#45;&gt;layer3_gpu1_expert_act -->
<g id="edge332" class="edge">
<title>layer3_gpu1_expert_mlp1&#45;&gt;layer3_gpu1_expert_act</title>
<path fill="none" stroke="black" d="M1215.66,-23608.21C1212.58,-23599.93 1209.22,-23590.92 1205.99,-23582.24"/>
<polygon fill="black" stroke="black" points="1209.18,-23580.78 1202.41,-23572.63 1202.62,-23583.22 1209.18,-23580.78"/>
</g>
<!-- layer3_gpu1_expert_mlp2 -->
<g id="node288" class="node">
<title>layer3_gpu1_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="1355.5,-23468.33 948.5,-23468.33 948.5,-23400.33 1355.5,-23400.33 1355.5,-23468.33"/>
<text text-anchor="middle" x="1152" y="-23453.13" font-family="Times,serif" font-size="14.00">Expert 1 MLP2</text>
<text text-anchor="middle" x="1152" y="-23438.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1152" y="-23423.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1152" y="-23408.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gpu1_expert_act&#45;&gt;layer3_gpu1_expert_mlp2 -->
<g id="edge333" class="edge">
<title>layer3_gpu1_expert_act&#45;&gt;layer3_gpu1_expert_mlp2</title>
<path fill="none" stroke="black" d="M1177.66,-23504.21C1174.58,-23495.93 1171.22,-23486.92 1167.99,-23478.24"/>
<polygon fill="black" stroke="black" points="1171.18,-23476.78 1164.41,-23468.63 1164.62,-23479.22 1171.18,-23476.78"/>
</g>
<!-- layer3_gpu1_token_send -->
<g id="node289" class="node">
<title>layer3_gpu1_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1101" cy="-23316.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1101" y="-23335.05" font-family="Times,serif" font-size="14.00">Token Send GPU1</text>
<text text-anchor="middle" x="1101" y="-23320.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1101" y="-23305.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1101" y="-23290.05" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gpu1_expert_mlp2&#45;&gt;layer3_gpu1_token_send -->
<g id="edge334" class="edge">
<title>layer3_gpu1_expert_mlp2&#45;&gt;layer3_gpu1_token_send</title>
<path fill="none" stroke="black" d="M1137.39,-23400.06C1133.76,-23391.81 1129.77,-23382.73 1125.81,-23373.71"/>
<polygon fill="black" stroke="black" points="1128.92,-23372.1 1121.7,-23364.36 1122.52,-23374.92 1128.92,-23372.1"/>
</g>
<!-- layer3_gpu1_token_send&#45;&gt;layer3_expert_agg -->
<g id="edge335" class="edge">
<title>layer3_gpu1_token_send&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M1340.98,-23280.65C1382.27,-23275.71 1424.82,-23271.27 1465,-23268.16 2167.7,-23213.84 4265.31,-23181.05 5114.3,-23169.69"/>
<polygon fill="black" stroke="black" points="5114.59,-23173.18 5124.54,-23169.55 5114.49,-23166.18 5114.59,-23173.18"/>
</g>
<!-- layer3_gpu2_expert_mlp1 -->
<g id="node291" class="node">
<title>layer3_gpu2_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2166.5,-23676.33 1705.5,-23676.33 1705.5,-23608.33 2166.5,-23608.33 2166.5,-23676.33"/>
<text text-anchor="middle" x="1936" y="-23661.13" font-family="Times,serif" font-size="14.00">Expert 2 MLP1</text>
<text text-anchor="middle" x="1936" y="-23646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1936" y="-23631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1936" y="-23616.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gpu2_token_recv&#45;&gt;layer3_gpu2_expert_mlp1 -->
<g id="edge337" class="edge">
<title>layer3_gpu2_token_recv&#45;&gt;layer3_gpu2_expert_mlp1</title>
<path fill="none" stroke="black" d="M1952.61,-23712.2C1950.57,-23703.72 1948.44,-23694.92 1946.43,-23686.56"/>
<polygon fill="black" stroke="black" points="1949.78,-23685.53 1944.03,-23676.63 1942.98,-23687.18 1949.78,-23685.53"/>
</g>
<!-- layer3_gpu2_expert_act -->
<g id="node292" class="node">
<title>layer3_gpu2_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2091.5,-23572.33 1714.5,-23572.33 1714.5,-23504.33 2091.5,-23504.33 2091.5,-23572.33"/>
<text text-anchor="middle" x="1903" y="-23557.13" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="1903" y="-23542.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1903" y="-23527.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1903" y="-23512.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gpu2_expert_mlp1&#45;&gt;layer3_gpu2_expert_act -->
<g id="edge338" class="edge">
<title>layer3_gpu2_expert_mlp1&#45;&gt;layer3_gpu2_expert_act</title>
<path fill="none" stroke="black" d="M1925.29,-23608.21C1922.61,-23599.93 1919.69,-23590.92 1916.88,-23582.24"/>
<polygon fill="black" stroke="black" points="1920.18,-23581.07 1913.77,-23572.63 1913.52,-23583.22 1920.18,-23581.07"/>
</g>
<!-- layer3_gpu2_expert_mlp2 -->
<g id="node293" class="node">
<title>layer3_gpu2_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2073.5,-23468.33 1666.5,-23468.33 1666.5,-23400.33 2073.5,-23400.33 2073.5,-23468.33"/>
<text text-anchor="middle" x="1870" y="-23453.13" font-family="Times,serif" font-size="14.00">Expert 2 MLP2</text>
<text text-anchor="middle" x="1870" y="-23438.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1870" y="-23423.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1870" y="-23408.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gpu2_expert_act&#45;&gt;layer3_gpu2_expert_mlp2 -->
<g id="edge339" class="edge">
<title>layer3_gpu2_expert_act&#45;&gt;layer3_gpu2_expert_mlp2</title>
<path fill="none" stroke="black" d="M1892.29,-23504.21C1889.61,-23495.93 1886.69,-23486.92 1883.88,-23478.24"/>
<polygon fill="black" stroke="black" points="1887.18,-23477.07 1880.77,-23468.63 1880.52,-23479.22 1887.18,-23477.07"/>
</g>
<!-- layer3_gpu2_token_send -->
<g id="node294" class="node">
<title>layer3_gpu2_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1830" cy="-23316.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1830" y="-23335.05" font-family="Times,serif" font-size="14.00">Token Send GPU2</text>
<text text-anchor="middle" x="1830" y="-23320.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1830" y="-23305.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1830" y="-23290.05" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gpu2_expert_mlp2&#45;&gt;layer3_gpu2_token_send -->
<g id="edge340" class="edge">
<title>layer3_gpu2_expert_mlp2&#45;&gt;layer3_gpu2_token_send</title>
<path fill="none" stroke="black" d="M1858.54,-23400.06C1855.72,-23391.9 1852.63,-23382.92 1849.55,-23373.99"/>
<polygon fill="black" stroke="black" points="1852.8,-23372.67 1846.23,-23364.36 1846.18,-23374.95 1852.8,-23372.67"/>
</g>
<!-- layer3_gpu2_token_send&#45;&gt;layer3_expert_agg -->
<g id="edge341" class="edge">
<title>layer3_gpu2_token_send&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M2070.48,-23280.78C2111.62,-23275.85 2153.98,-23271.37 2194,-23268.16 3249.04,-23183.58 4499.98,-23167.5 5108.15,-23165.06"/>
<polygon fill="black" stroke="black" points="5108.41,-23168.56 5118.39,-23165.02 5108.38,-23161.56 5108.41,-23168.56"/>
</g>
<!-- layer3_gpu3_expert_mlp1 -->
<g id="node296" class="node">
<title>layer3_gpu3_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2881.5,-23676.33 2420.5,-23676.33 2420.5,-23608.33 2881.5,-23608.33 2881.5,-23676.33"/>
<text text-anchor="middle" x="2651" y="-23661.13" font-family="Times,serif" font-size="14.00">Expert 3 MLP1</text>
<text text-anchor="middle" x="2651" y="-23646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2651" y="-23631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2651" y="-23616.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gpu3_token_recv&#45;&gt;layer3_gpu3_expert_mlp1 -->
<g id="edge343" class="edge">
<title>layer3_gpu3_token_recv&#45;&gt;layer3_gpu3_expert_mlp1</title>
<path fill="none" stroke="black" d="M2660.49,-23712.2C2659.32,-23703.72 2658.11,-23694.92 2656.96,-23686.56"/>
<polygon fill="black" stroke="black" points="2660.42,-23686.06 2655.59,-23676.63 2653.49,-23687.02 2660.42,-23686.06"/>
</g>
<!-- layer3_gpu3_expert_act -->
<g id="node297" class="node">
<title>layer3_gpu3_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2808.5,-23572.33 2431.5,-23572.33 2431.5,-23504.33 2808.5,-23504.33 2808.5,-23572.33"/>
<text text-anchor="middle" x="2620" y="-23557.13" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="2620" y="-23542.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2620" y="-23527.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2620" y="-23512.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gpu3_expert_mlp1&#45;&gt;layer3_gpu3_expert_act -->
<g id="edge344" class="edge">
<title>layer3_gpu3_expert_mlp1&#45;&gt;layer3_gpu3_expert_act</title>
<path fill="none" stroke="black" d="M2640.94,-23608.21C2638.42,-23599.93 2635.68,-23590.92 2633.04,-23582.24"/>
<polygon fill="black" stroke="black" points="2636.38,-23581.18 2630.12,-23572.63 2629.68,-23583.21 2636.38,-23581.18"/>
</g>
<!-- layer3_gpu3_expert_mlp2 -->
<g id="node298" class="node">
<title>layer3_gpu3_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2798.5,-23468.33 2391.5,-23468.33 2391.5,-23400.33 2798.5,-23400.33 2798.5,-23468.33"/>
<text text-anchor="middle" x="2595" y="-23453.13" font-family="Times,serif" font-size="14.00">Expert 3 MLP2</text>
<text text-anchor="middle" x="2595" y="-23438.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2595" y="-23423.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="2595" y="-23408.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gpu3_expert_act&#45;&gt;layer3_gpu3_expert_mlp2 -->
<g id="edge345" class="edge">
<title>layer3_gpu3_expert_act&#45;&gt;layer3_gpu3_expert_mlp2</title>
<path fill="none" stroke="black" d="M2611.88,-23504.21C2609.87,-23496.02 2607.69,-23487.12 2605.59,-23478.52"/>
<polygon fill="black" stroke="black" points="2608.94,-23477.51 2603.16,-23468.63 2602.14,-23479.17 2608.94,-23477.51"/>
</g>
<!-- layer3_gpu3_token_send -->
<g id="node299" class="node">
<title>layer3_gpu3_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="2559" cy="-23316.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="2559" y="-23335.05" font-family="Times,serif" font-size="14.00">Token Send GPU3</text>
<text text-anchor="middle" x="2559" y="-23320.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="2559" y="-23305.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="2559" y="-23290.05" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gpu3_expert_mlp2&#45;&gt;layer3_gpu3_token_send -->
<g id="edge346" class="edge">
<title>layer3_gpu3_expert_mlp2&#45;&gt;layer3_gpu3_token_send</title>
<path fill="none" stroke="black" d="M2584.68,-23400.06C2582.15,-23391.9 2579.37,-23382.92 2576.6,-23373.99"/>
<polygon fill="black" stroke="black" points="2579.91,-23372.87 2573.61,-23364.36 2573.23,-23374.94 2579.91,-23372.87"/>
</g>
<!-- layer3_gpu3_token_send&#45;&gt;layer3_expert_agg -->
<g id="edge347" class="edge">
<title>layer3_gpu3_token_send&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M2800.98,-23280.91C2841.65,-23276.01 2883.48,-23271.51 2923,-23268.16 3702.23,-23202.18 4618.9,-23178.23 5114.54,-23169.71"/>
<polygon fill="black" stroke="black" points="5114.77,-23173.21 5124.71,-23169.54 5114.65,-23166.21 5114.77,-23173.21"/>
</g>
<!-- layer3_gpu4_expert_mlp1 -->
<g id="node301" class="node">
<title>layer3_gpu4_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="3588.5,-23676.33 3127.5,-23676.33 3127.5,-23608.33 3588.5,-23608.33 3588.5,-23676.33"/>
<text text-anchor="middle" x="3358" y="-23661.13" font-family="Times,serif" font-size="14.00">Expert 4 MLP1</text>
<text text-anchor="middle" x="3358" y="-23646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3358" y="-23631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3358" y="-23616.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gpu4_token_recv&#45;&gt;layer3_gpu4_expert_mlp1 -->
<g id="edge349" class="edge">
<title>layer3_gpu4_token_recv&#45;&gt;layer3_gpu4_expert_mlp1</title>
<path fill="none" stroke="black" d="M3370.46,-23712.2C3368.92,-23703.72 3367.33,-23694.92 3365.82,-23686.56"/>
<polygon fill="black" stroke="black" points="3369.25,-23685.85 3364.02,-23676.63 3362.36,-23687.1 3369.25,-23685.85"/>
</g>
<!-- layer3_gpu4_expert_act -->
<g id="node302" class="node">
<title>layer3_gpu4_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="3512.5,-23572.33 3135.5,-23572.33 3135.5,-23504.33 3512.5,-23504.33 3512.5,-23572.33"/>
<text text-anchor="middle" x="3324" y="-23557.13" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="3324" y="-23542.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3324" y="-23527.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3324" y="-23512.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gpu4_expert_mlp1&#45;&gt;layer3_gpu4_expert_act -->
<g id="edge350" class="edge">
<title>layer3_gpu4_expert_mlp1&#45;&gt;layer3_gpu4_expert_act</title>
<path fill="none" stroke="black" d="M3346.96,-23608.21C3344.2,-23599.93 3341.2,-23590.92 3338.3,-23582.24"/>
<polygon fill="black" stroke="black" points="3341.58,-23581.01 3335.1,-23572.63 3334.94,-23583.22 3341.58,-23581.01"/>
</g>
<!-- layer3_gpu4_expert_mlp2 -->
<g id="node303" class="node">
<title>layer3_gpu4_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="3513.5,-23468.33 3106.5,-23468.33 3106.5,-23400.33 3513.5,-23400.33 3513.5,-23468.33"/>
<text text-anchor="middle" x="3310" y="-23453.13" font-family="Times,serif" font-size="14.00">Expert 4 MLP2</text>
<text text-anchor="middle" x="3310" y="-23438.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3310" y="-23423.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="3310" y="-23408.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gpu4_expert_act&#45;&gt;layer3_gpu4_expert_mlp2 -->
<g id="edge351" class="edge">
<title>layer3_gpu4_expert_act&#45;&gt;layer3_gpu4_expert_mlp2</title>
<path fill="none" stroke="black" d="M3319.45,-23504.21C3318.34,-23496.11 3317.13,-23487.31 3315.97,-23478.8"/>
<polygon fill="black" stroke="black" points="3319.4,-23478.06 3314.57,-23468.63 3312.46,-23479.01 3319.4,-23478.06"/>
</g>
<!-- layer3_gpu4_token_send -->
<g id="node304" class="node">
<title>layer3_gpu4_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="3288" cy="-23316.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="3288" y="-23335.05" font-family="Times,serif" font-size="14.00">Token Send GPU4</text>
<text text-anchor="middle" x="3288" y="-23320.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="3288" y="-23305.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="3288" y="-23290.05" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gpu4_expert_mlp2&#45;&gt;layer3_gpu4_token_send -->
<g id="edge352" class="edge">
<title>layer3_gpu4_expert_mlp2&#45;&gt;layer3_gpu4_token_send</title>
<path fill="none" stroke="black" d="M3303.7,-23400.06C3302.16,-23391.98 3300.48,-23383.12 3298.81,-23374.28"/>
<polygon fill="black" stroke="black" points="3302.23,-23373.53 3296.93,-23364.36 3295.35,-23374.83 3302.23,-23373.53"/>
</g>
<!-- layer3_gpu4_token_send&#45;&gt;layer3_expert_agg -->
<g id="edge353" class="edge">
<title>layer3_gpu4_token_send&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M3531.99,-23281.22C3572.03,-23276.34 3613.14,-23271.77 3652,-23268.16 4162.99,-23220.76 4756.65,-23192.14 5124.62,-23177.5"/>
<polygon fill="black" stroke="black" points="5124.78,-23180.99 5134.63,-23177.1 5124.5,-23174 5124.78,-23180.99"/>
</g>
<!-- layer3_gpu5_expert_mlp1 -->
<g id="node306" class="node">
<title>layer3_gpu5_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4279.5,-23676.33 3818.5,-23676.33 3818.5,-23608.33 4279.5,-23608.33 4279.5,-23676.33"/>
<text text-anchor="middle" x="4049" y="-23661.13" font-family="Times,serif" font-size="14.00">Expert 5 MLP1</text>
<text text-anchor="middle" x="4049" y="-23646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4049" y="-23631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4049" y="-23616.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gpu5_token_recv&#45;&gt;layer3_gpu5_expert_mlp1 -->
<g id="edge355" class="edge">
<title>layer3_gpu5_token_recv&#45;&gt;layer3_gpu5_expert_mlp1</title>
<path fill="none" stroke="black" d="M4067.39,-23712.2C4065.13,-23703.72 4062.78,-23694.92 4060.54,-23686.56"/>
<polygon fill="black" stroke="black" points="4063.86,-23685.39 4057.89,-23676.63 4057.09,-23687.2 4063.86,-23685.39"/>
</g>
<!-- layer3_gpu5_expert_act -->
<g id="node307" class="node">
<title>layer3_gpu5_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4221.5,-23572.33 3844.5,-23572.33 3844.5,-23504.33 4221.5,-23504.33 4221.5,-23572.33"/>
<text text-anchor="middle" x="4033" y="-23557.13" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="4033" y="-23542.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4033" y="-23527.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4033" y="-23512.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gpu5_expert_mlp1&#45;&gt;layer3_gpu5_expert_act -->
<g id="edge356" class="edge">
<title>layer3_gpu5_expert_mlp1&#45;&gt;layer3_gpu5_expert_act</title>
<path fill="none" stroke="black" d="M4043.81,-23608.21C4042.52,-23600.02 4041.12,-23591.12 4039.78,-23582.52"/>
<polygon fill="black" stroke="black" points="4043.23,-23581.97 4038.22,-23572.63 4036.32,-23583.05 4043.23,-23581.97"/>
</g>
<!-- layer3_gpu5_expert_mlp2 -->
<g id="node308" class="node">
<title>layer3_gpu5_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4230.5,-23468.33 3823.5,-23468.33 3823.5,-23400.33 4230.5,-23400.33 4230.5,-23468.33"/>
<text text-anchor="middle" x="4027" y="-23453.13" font-family="Times,serif" font-size="14.00">Expert 5 MLP2</text>
<text text-anchor="middle" x="4027" y="-23438.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4027" y="-23423.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4027" y="-23408.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gpu5_expert_act&#45;&gt;layer3_gpu5_expert_mlp2 -->
<g id="edge357" class="edge">
<title>layer3_gpu5_expert_act&#45;&gt;layer3_gpu5_expert_mlp2</title>
<path fill="none" stroke="black" d="M4031.05,-23504.21C4030.58,-23496.11 4030.06,-23487.31 4029.56,-23478.8"/>
<polygon fill="black" stroke="black" points="4033.04,-23478.41 4028.96,-23468.63 4026.05,-23478.82 4033.04,-23478.41"/>
</g>
<!-- layer3_gpu5_token_send -->
<g id="node309" class="node">
<title>layer3_gpu5_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4017" cy="-23316.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4017" y="-23335.05" font-family="Times,serif" font-size="14.00">Token Send GPU5</text>
<text text-anchor="middle" x="4017" y="-23320.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4017" y="-23305.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4017" y="-23290.05" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gpu5_expert_mlp2&#45;&gt;layer3_gpu5_token_send -->
<g id="edge358" class="edge">
<title>layer3_gpu5_expert_mlp2&#45;&gt;layer3_gpu5_token_send</title>
<path fill="none" stroke="black" d="M4024.13,-23400.06C4023.45,-23392.07 4022.69,-23383.31 4021.94,-23374.56"/>
<polygon fill="black" stroke="black" points="4025.4,-23374.02 4021.06,-23364.36 4018.43,-23374.62 4025.4,-23374.02"/>
</g>
<!-- layer3_gpu5_token_send&#45;&gt;layer3_expert_agg -->
<g id="edge359" class="edge">
<title>layer3_gpu5_token_send&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M4266.02,-23281.86C4304.5,-23277.04 4343.8,-23272.32 4381,-23268.16 4637.39,-23239.54 4928.13,-23212.47 5145.7,-23193.26"/>
<polygon fill="black" stroke="black" points="5146.03,-23196.75 5155.68,-23192.38 5145.41,-23189.78 5146.03,-23196.75"/>
</g>
<!-- layer3_gpu6_expert_mlp1 -->
<g id="node311" class="node">
<title>layer3_gpu6_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4994.5,-23676.33 4533.5,-23676.33 4533.5,-23608.33 4994.5,-23608.33 4994.5,-23676.33"/>
<text text-anchor="middle" x="4764" y="-23661.13" font-family="Times,serif" font-size="14.00">Expert 6 MLP1</text>
<text text-anchor="middle" x="4764" y="-23646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4764" y="-23631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4764" y="-23616.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gpu6_token_recv&#45;&gt;layer3_gpu6_expert_mlp1 -->
<g id="edge361" class="edge">
<title>layer3_gpu6_token_recv&#45;&gt;layer3_gpu6_expert_mlp1</title>
<path fill="none" stroke="black" d="M4769.93,-23712.2C4769.21,-23703.81 4768.46,-23695.11 4767.75,-23686.84"/>
<polygon fill="black" stroke="black" points="4771.21,-23686.3 4766.87,-23676.63 4764.24,-23686.9 4771.21,-23686.3"/>
</g>
<!-- layer3_gpu6_expert_act -->
<g id="node312" class="node">
<title>layer3_gpu6_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4947.5,-23572.33 4570.5,-23572.33 4570.5,-23504.33 4947.5,-23504.33 4947.5,-23572.33"/>
<text text-anchor="middle" x="4759" y="-23557.13" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="4759" y="-23542.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4759" y="-23527.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4759" y="-23512.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gpu6_expert_mlp1&#45;&gt;layer3_gpu6_expert_act -->
<g id="edge362" class="edge">
<title>layer3_gpu6_expert_mlp1&#45;&gt;layer3_gpu6_expert_act</title>
<path fill="none" stroke="black" d="M4762.38,-23608.21C4761.98,-23600.11 4761.55,-23591.31 4761.13,-23582.8"/>
<polygon fill="black" stroke="black" points="4764.62,-23582.45 4760.63,-23572.63 4757.63,-23582.79 4764.62,-23582.45"/>
</g>
<!-- layer3_gpu6_expert_mlp2 -->
<g id="node313" class="node">
<title>layer3_gpu6_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4954.5,-23468.33 4547.5,-23468.33 4547.5,-23400.33 4954.5,-23400.33 4954.5,-23468.33"/>
<text text-anchor="middle" x="4751" y="-23453.13" font-family="Times,serif" font-size="14.00">Expert 6 MLP2</text>
<text text-anchor="middle" x="4751" y="-23438.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4751" y="-23423.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4751" y="-23408.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gpu6_expert_act&#45;&gt;layer3_gpu6_expert_mlp2 -->
<g id="edge363" class="edge">
<title>layer3_gpu6_expert_act&#45;&gt;layer3_gpu6_expert_mlp2</title>
<path fill="none" stroke="black" d="M4756.4,-23504.21C4755.77,-23496.11 4755.08,-23487.31 4754.41,-23478.8"/>
<polygon fill="black" stroke="black" points="4757.88,-23478.32 4753.61,-23468.63 4750.9,-23478.87 4757.88,-23478.32"/>
</g>
<!-- layer3_gpu6_token_send -->
<g id="node314" class="node">
<title>layer3_gpu6_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4746" cy="-23316.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4746" y="-23335.05" font-family="Times,serif" font-size="14.00">Token Send GPU6</text>
<text text-anchor="middle" x="4746" y="-23320.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4746" y="-23305.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4746" y="-23290.05" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gpu6_expert_mlp2&#45;&gt;layer3_gpu6_token_send -->
<g id="edge364" class="edge">
<title>layer3_gpu6_expert_mlp2&#45;&gt;layer3_gpu6_token_send</title>
<path fill="none" stroke="black" d="M4749.57,-23400.06C4749.22,-23392.07 4748.85,-23383.31 4748.47,-23374.56"/>
<polygon fill="black" stroke="black" points="4751.96,-23374.2 4748.03,-23364.36 4744.96,-23374.5 4751.96,-23374.2"/>
</g>
<!-- layer3_gpu6_token_send&#45;&gt;layer3_expert_agg -->
<g id="edge365" class="edge">
<title>layer3_gpu6_token_send&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M4938.54,-23275.72C5014.53,-23260.11 5103.48,-23241.85 5186.94,-23224.72"/>
<polygon fill="black" stroke="black" points="5187.74,-23228.13 5196.83,-23222.69 5186.33,-23221.27 5187.74,-23228.13"/>
</g>
<!-- layer3_gpu7_expert_mlp1 -->
<g id="node316" class="node">
<title>layer3_gpu7_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5711.5,-23676.33 5250.5,-23676.33 5250.5,-23608.33 5711.5,-23608.33 5711.5,-23676.33"/>
<text text-anchor="middle" x="5481" y="-23661.13" font-family="Times,serif" font-size="14.00">Expert 7 MLP1</text>
<text text-anchor="middle" x="5481" y="-23646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5481" y="-23631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5481" y="-23616.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gpu7_token_recv&#45;&gt;layer3_gpu7_expert_mlp1 -->
<g id="edge367" class="edge">
<title>layer3_gpu7_token_recv&#45;&gt;layer3_gpu7_expert_mlp1</title>
<path fill="none" stroke="black" d="M5481.59,-23712.2C5481.52,-23703.81 5481.45,-23695.11 5481.37,-23686.84"/>
<polygon fill="black" stroke="black" points="5484.87,-23686.6 5481.29,-23676.63 5477.87,-23686.66 5484.87,-23686.6"/>
</g>
<!-- layer3_gpu7_expert_act -->
<g id="node317" class="node">
<title>layer3_gpu7_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="5669.5,-23572.33 5292.5,-23572.33 5292.5,-23504.33 5669.5,-23504.33 5669.5,-23572.33"/>
<text text-anchor="middle" x="5481" y="-23557.13" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="5481" y="-23542.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5481" y="-23527.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5481" y="-23512.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gpu7_expert_mlp1&#45;&gt;layer3_gpu7_expert_act -->
<g id="edge368" class="edge">
<title>layer3_gpu7_expert_mlp1&#45;&gt;layer3_gpu7_expert_act</title>
<path fill="none" stroke="black" d="M5481,-23608.21C5481,-23600.11 5481,-23591.31 5481,-23582.8"/>
<polygon fill="black" stroke="black" points="5484.5,-23582.63 5481,-23572.63 5477.5,-23582.63 5484.5,-23582.63"/>
</g>
<!-- layer3_gpu7_expert_mlp2 -->
<g id="node318" class="node">
<title>layer3_gpu7_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="5683.5,-23468.33 5276.5,-23468.33 5276.5,-23400.33 5683.5,-23400.33 5683.5,-23468.33"/>
<text text-anchor="middle" x="5480" y="-23453.13" font-family="Times,serif" font-size="14.00">Expert 7 MLP2</text>
<text text-anchor="middle" x="5480" y="-23438.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5480" y="-23423.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5480" y="-23408.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gpu7_expert_act&#45;&gt;layer3_gpu7_expert_mlp2 -->
<g id="edge369" class="edge">
<title>layer3_gpu7_expert_act&#45;&gt;layer3_gpu7_expert_mlp2</title>
<path fill="none" stroke="black" d="M5480.68,-23504.21C5480.6,-23496.11 5480.51,-23487.31 5480.43,-23478.8"/>
<polygon fill="black" stroke="black" points="5483.92,-23478.59 5480.33,-23468.63 5476.92,-23478.66 5483.92,-23478.59"/>
</g>
<!-- layer3_gpu7_token_send -->
<g id="node319" class="node">
<title>layer3_gpu7_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="5475" cy="-23316.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="5475" y="-23335.05" font-family="Times,serif" font-size="14.00">Token Send GPU7</text>
<text text-anchor="middle" x="5475" y="-23320.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="5475" y="-23305.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="5475" y="-23290.05" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gpu7_expert_mlp2&#45;&gt;layer3_gpu7_token_send -->
<g id="edge370" class="edge">
<title>layer3_gpu7_expert_mlp2&#45;&gt;layer3_gpu7_token_send</title>
<path fill="none" stroke="black" d="M5478.57,-23400.06C5478.22,-23392.07 5477.85,-23383.31 5477.47,-23374.56"/>
<polygon fill="black" stroke="black" points="5480.96,-23374.2 5477.03,-23364.36 5473.96,-23374.5 5480.96,-23374.2"/>
</g>
<!-- layer3_gpu7_token_send&#45;&gt;layer3_expert_agg -->
<g id="edge371" class="edge">
<title>layer3_gpu7_token_send&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M5475.63,-23267.76C5475.74,-23259.67 5475.85,-23251.09 5475.97,-23242.47"/>
<polygon fill="black" stroke="black" points="5479.47,-23242.4 5476.1,-23232.36 5472.47,-23242.31 5479.47,-23242.4"/>
</g>
<!-- layer3_gpu8_expert_mlp1 -->
<g id="node321" class="node">
<title>layer3_gpu8_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="6403.5,-23676.33 5942.5,-23676.33 5942.5,-23608.33 6403.5,-23608.33 6403.5,-23676.33"/>
<text text-anchor="middle" x="6173" y="-23661.13" font-family="Times,serif" font-size="14.00">Expert 8 MLP1</text>
<text text-anchor="middle" x="6173" y="-23646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6173" y="-23631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6173" y="-23616.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gpu8_token_recv&#45;&gt;layer3_gpu8_expert_mlp1 -->
<g id="edge373" class="edge">
<title>layer3_gpu8_token_recv&#45;&gt;layer3_gpu8_expert_mlp1</title>
<path fill="none" stroke="black" d="M6171.22,-23712.2C6171.44,-23703.81 6171.66,-23695.11 6171.88,-23686.84"/>
<polygon fill="black" stroke="black" points="6175.38,-23686.72 6172.14,-23676.63 6168.38,-23686.54 6175.38,-23686.72"/>
</g>
<!-- layer3_gpu8_expert_act -->
<g id="node322" class="node">
<title>layer3_gpu8_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="6371.5,-23572.33 5994.5,-23572.33 5994.5,-23504.33 6371.5,-23504.33 6371.5,-23572.33"/>
<text text-anchor="middle" x="6183" y="-23557.13" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="6183" y="-23542.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6183" y="-23527.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6183" y="-23512.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gpu8_expert_mlp1&#45;&gt;layer3_gpu8_expert_act -->
<g id="edge374" class="edge">
<title>layer3_gpu8_expert_mlp1&#45;&gt;layer3_gpu8_expert_act</title>
<path fill="none" stroke="black" d="M6176.25,-23608.21C6177.04,-23600.11 6177.9,-23591.31 6178.74,-23582.8"/>
<polygon fill="black" stroke="black" points="6182.24,-23582.92 6179.74,-23572.63 6175.28,-23582.24 6182.24,-23582.92"/>
</g>
<!-- layer3_gpu8_expert_mlp2 -->
<g id="node323" class="node">
<title>layer3_gpu8_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="6387.5,-23468.33 5980.5,-23468.33 5980.5,-23400.33 6387.5,-23400.33 6387.5,-23468.33"/>
<text text-anchor="middle" x="6184" y="-23453.13" font-family="Times,serif" font-size="14.00">Expert 8 MLP2</text>
<text text-anchor="middle" x="6184" y="-23438.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6184" y="-23423.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6184" y="-23408.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gpu8_expert_act&#45;&gt;layer3_gpu8_expert_mlp2 -->
<g id="edge375" class="edge">
<title>layer3_gpu8_expert_act&#45;&gt;layer3_gpu8_expert_mlp2</title>
<path fill="none" stroke="black" d="M6183.32,-23504.21C6183.4,-23496.11 6183.49,-23487.31 6183.57,-23478.8"/>
<polygon fill="black" stroke="black" points="6187.08,-23478.66 6183.67,-23468.63 6180.08,-23478.59 6187.08,-23478.66"/>
</g>
<!-- layer3_gpu8_token_send -->
<g id="node324" class="node">
<title>layer3_gpu8_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6204" cy="-23316.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6204" y="-23335.05" font-family="Times,serif" font-size="14.00">Token Send GPU8</text>
<text text-anchor="middle" x="6204" y="-23320.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6204" y="-23305.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6204" y="-23290.05" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gpu8_expert_mlp2&#45;&gt;layer3_gpu8_token_send -->
<g id="edge376" class="edge">
<title>layer3_gpu8_expert_mlp2&#45;&gt;layer3_gpu8_token_send</title>
<path fill="none" stroke="black" d="M6189.73,-23400.06C6191.12,-23391.98 6192.65,-23383.12 6194.17,-23374.28"/>
<polygon fill="black" stroke="black" points="6197.63,-23374.81 6195.88,-23364.36 6190.74,-23373.62 6197.63,-23374.81"/>
</g>
<!-- layer3_gpu8_token_send&#45;&gt;layer3_expert_agg -->
<g id="edge377" class="edge">
<title>layer3_gpu8_token_send&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M6012.51,-23275.72C5950.86,-23262.99 5880.64,-23248.49 5811.79,-23234.28"/>
<polygon fill="black" stroke="black" points="5812.14,-23230.78 5801.64,-23232.18 5810.73,-23237.63 5812.14,-23230.78"/>
</g>
<!-- layer3_gpu9_expert_mlp1 -->
<g id="node326" class="node">
<title>layer3_gpu9_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7096.5,-23676.33 6635.5,-23676.33 6635.5,-23608.33 7096.5,-23608.33 7096.5,-23676.33"/>
<text text-anchor="middle" x="6866" y="-23661.13" font-family="Times,serif" font-size="14.00">Expert 9 MLP1</text>
<text text-anchor="middle" x="6866" y="-23646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6866" y="-23631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6866" y="-23616.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gpu9_token_recv&#45;&gt;layer3_gpu9_expert_mlp1 -->
<g id="edge379" class="edge">
<title>layer3_gpu9_token_recv&#45;&gt;layer3_gpu9_expert_mlp1</title>
<path fill="none" stroke="black" d="M6860.66,-23712.2C6861.31,-23703.81 6861.99,-23695.11 6862.63,-23686.84"/>
<polygon fill="black" stroke="black" points="6866.13,-23686.87 6863.42,-23676.63 6859.16,-23686.33 6866.13,-23686.87"/>
</g>
<!-- layer3_gpu9_expert_act -->
<g id="node327" class="node">
<title>layer3_gpu9_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7063.5,-23572.33 6686.5,-23572.33 6686.5,-23504.33 7063.5,-23504.33 7063.5,-23572.33"/>
<text text-anchor="middle" x="6875" y="-23557.13" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="6875" y="-23542.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6875" y="-23527.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6875" y="-23512.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gpu9_expert_mlp1&#45;&gt;layer3_gpu9_expert_act -->
<g id="edge380" class="edge">
<title>layer3_gpu9_expert_mlp1&#45;&gt;layer3_gpu9_expert_act</title>
<path fill="none" stroke="black" d="M6868.92,-23608.21C6869.64,-23600.11 6870.41,-23591.31 6871.16,-23582.8"/>
<polygon fill="black" stroke="black" points="6874.67,-23582.9 6872.06,-23572.63 6867.7,-23582.28 6874.67,-23582.9"/>
</g>
<!-- layer3_gpu9_expert_mlp2 -->
<g id="node328" class="node">
<title>layer3_gpu9_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7119.5,-23468.33 6712.5,-23468.33 6712.5,-23400.33 7119.5,-23400.33 7119.5,-23468.33"/>
<text text-anchor="middle" x="6916" y="-23453.13" font-family="Times,serif" font-size="14.00">Expert 9 MLP2</text>
<text text-anchor="middle" x="6916" y="-23438.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6916" y="-23423.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6916" y="-23408.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gpu9_expert_act&#45;&gt;layer3_gpu9_expert_mlp2 -->
<g id="edge381" class="edge">
<title>layer3_gpu9_expert_act&#45;&gt;layer3_gpu9_expert_mlp2</title>
<path fill="none" stroke="black" d="M6888.31,-23504.21C6891.68,-23495.84 6895.34,-23486.73 6898.86,-23477.96"/>
<polygon fill="black" stroke="black" points="6902.13,-23479.21 6902.61,-23468.63 6895.64,-23476.6 6902.13,-23479.21"/>
</g>
<!-- layer3_gpu9_token_send -->
<g id="node329" class="node">
<title>layer3_gpu9_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6933" cy="-23316.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6933" y="-23335.05" font-family="Times,serif" font-size="14.00">Token Send GPU9</text>
<text text-anchor="middle" x="6933" y="-23320.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6933" y="-23305.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6933" y="-23290.05" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gpu9_expert_mlp2&#45;&gt;layer3_gpu9_token_send -->
<g id="edge382" class="edge">
<title>layer3_gpu9_expert_mlp2&#45;&gt;layer3_gpu9_token_send</title>
<path fill="none" stroke="black" d="M6920.87,-23400.06C6922.05,-23391.98 6923.35,-23383.12 6924.65,-23374.28"/>
<polygon fill="black" stroke="black" points="6928.11,-23374.76 6926.1,-23364.36 6921.19,-23373.74 6928.11,-23374.76"/>
</g>
<!-- layer3_gpu9_token_send&#45;&gt;layer3_expert_agg -->
<g id="edge383" class="edge">
<title>layer3_gpu9_token_send&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M6683.98,-23281.87C6645.5,-23277.05 6606.2,-23272.32 6569,-23268.16 6347.19,-23243.36 6099.58,-23219.68 5896.29,-23201.29"/>
<polygon fill="black" stroke="black" points="5896.31,-23197.78 5886.03,-23200.37 5895.68,-23204.75 5896.31,-23197.78"/>
</g>
<!-- layer3_gpu10_expert_mlp1 -->
<g id="node331" class="node">
<title>layer3_gpu10_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7786.5,-23676.33 7325.5,-23676.33 7325.5,-23608.33 7786.5,-23608.33 7786.5,-23676.33"/>
<text text-anchor="middle" x="7556" y="-23661.13" font-family="Times,serif" font-size="14.00">Expert 10 MLP1</text>
<text text-anchor="middle" x="7556" y="-23646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7556" y="-23631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7556" y="-23616.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gpu10_token_recv&#45;&gt;layer3_gpu10_expert_mlp1 -->
<g id="edge385" class="edge">
<title>layer3_gpu10_token_recv&#45;&gt;layer3_gpu10_expert_mlp1</title>
<path fill="none" stroke="black" d="M7548.88,-23712.2C7549.75,-23703.81 7550.65,-23695.11 7551.5,-23686.84"/>
<polygon fill="black" stroke="black" points="7555.01,-23686.94 7552.56,-23676.63 7548.05,-23686.22 7555.01,-23686.94"/>
</g>
<!-- layer3_gpu10_expert_act -->
<g id="node332" class="node">
<title>layer3_gpu10_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7807.5,-23572.33 7430.5,-23572.33 7430.5,-23504.33 7807.5,-23504.33 7807.5,-23572.33"/>
<text text-anchor="middle" x="7619" y="-23557.13" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="7619" y="-23542.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7619" y="-23527.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7619" y="-23512.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gpu10_expert_mlp1&#45;&gt;layer3_gpu10_expert_act -->
<g id="edge386" class="edge">
<title>layer3_gpu10_expert_mlp1&#45;&gt;layer3_gpu10_expert_act</title>
<path fill="none" stroke="black" d="M7576.45,-23608.21C7581.74,-23599.66 7587.49,-23590.34 7593.01,-23581.4"/>
<polygon fill="black" stroke="black" points="7596.16,-23582.98 7598.43,-23572.63 7590.2,-23579.3 7596.16,-23582.98"/>
</g>
<!-- layer3_gpu10_expert_mlp2 -->
<g id="node333" class="node">
<title>layer3_gpu10_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7853.5,-23468.33 7446.5,-23468.33 7446.5,-23400.33 7853.5,-23400.33 7853.5,-23468.33"/>
<text text-anchor="middle" x="7650" y="-23453.13" font-family="Times,serif" font-size="14.00">Expert 10 MLP2</text>
<text text-anchor="middle" x="7650" y="-23438.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7650" y="-23423.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="7650" y="-23408.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gpu10_expert_act&#45;&gt;layer3_gpu10_expert_mlp2 -->
<g id="edge387" class="edge">
<title>layer3_gpu10_expert_act&#45;&gt;layer3_gpu10_expert_mlp2</title>
<path fill="none" stroke="black" d="M7629.06,-23504.21C7631.58,-23495.93 7634.32,-23486.92 7636.96,-23478.24"/>
<polygon fill="black" stroke="black" points="7640.32,-23479.21 7639.88,-23468.63 7633.62,-23477.18 7640.32,-23479.21"/>
</g>
<!-- layer3_gpu10_token_send -->
<g id="node334" class="node">
<title>layer3_gpu10_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="7662" cy="-23316.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="7662" y="-23335.05" font-family="Times,serif" font-size="14.00">Token Send GPU10</text>
<text text-anchor="middle" x="7662" y="-23320.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="7662" y="-23305.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="7662" y="-23290.05" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gpu10_expert_mlp2&#45;&gt;layer3_gpu10_token_send -->
<g id="edge388" class="edge">
<title>layer3_gpu10_expert_mlp2&#45;&gt;layer3_gpu10_token_send</title>
<path fill="none" stroke="black" d="M7653.44,-23400.06C7654.27,-23392.07 7655.17,-23383.31 7656.08,-23374.56"/>
<polygon fill="black" stroke="black" points="7659.58,-23374.66 7657.13,-23364.36 7652.62,-23373.94 7659.58,-23374.66"/>
</g>
<!-- layer3_gpu10_token_send&#45;&gt;layer3_expert_agg -->
<g id="edge389" class="edge">
<title>layer3_gpu10_token_send&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M7418.01,-23281.22C7377.96,-23276.35 7336.86,-23271.77 7298,-23268.16 6805.31,-23222.42 6235.61,-23194.15 5866.49,-23179.06"/>
<polygon fill="black" stroke="black" points="5866.58,-23175.56 5856.44,-23178.65 5866.29,-23182.55 5866.58,-23175.56"/>
</g>
<!-- layer3_gpu11_expert_mlp1 -->
<g id="node336" class="node">
<title>layer3_gpu11_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="8480.5,-23676.33 8019.5,-23676.33 8019.5,-23608.33 8480.5,-23608.33 8480.5,-23676.33"/>
<text text-anchor="middle" x="8250" y="-23661.13" font-family="Times,serif" font-size="14.00">Expert 11 MLP1</text>
<text text-anchor="middle" x="8250" y="-23646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8250" y="-23631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8250" y="-23616.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gpu11_token_recv&#45;&gt;layer3_gpu11_expert_mlp1 -->
<g id="edge391" class="edge">
<title>layer3_gpu11_token_recv&#45;&gt;layer3_gpu11_expert_mlp1</title>
<path fill="none" stroke="black" d="M8238.73,-23712.2C8240.12,-23703.72 8241.56,-23694.92 8242.92,-23686.56"/>
<polygon fill="black" stroke="black" points="8246.39,-23687.07 8244.55,-23676.63 8239.48,-23685.94 8246.39,-23687.07"/>
</g>
<!-- layer3_gpu11_expert_act -->
<g id="node337" class="node">
<title>layer3_gpu11_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="8458.5,-23572.33 8081.5,-23572.33 8081.5,-23504.33 8458.5,-23504.33 8458.5,-23572.33"/>
<text text-anchor="middle" x="8270" y="-23557.13" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="8270" y="-23542.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8270" y="-23527.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8270" y="-23512.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gpu11_expert_mlp1&#45;&gt;layer3_gpu11_expert_act -->
<g id="edge392" class="edge">
<title>layer3_gpu11_expert_mlp1&#45;&gt;layer3_gpu11_expert_act</title>
<path fill="none" stroke="black" d="M8256.49,-23608.21C8258.1,-23600.02 8259.85,-23591.12 8261.53,-23582.52"/>
<polygon fill="black" stroke="black" points="8264.98,-23583.12 8263.47,-23572.63 8258.11,-23581.77 8264.98,-23583.12"/>
</g>
<!-- layer3_gpu11_expert_mlp2 -->
<g id="node338" class="node">
<title>layer3_gpu11_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="8556.5,-23468.33 8149.5,-23468.33 8149.5,-23400.33 8556.5,-23400.33 8556.5,-23468.33"/>
<text text-anchor="middle" x="8353" y="-23453.13" font-family="Times,serif" font-size="14.00">Expert 11 MLP2</text>
<text text-anchor="middle" x="8353" y="-23438.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8353" y="-23423.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="8353" y="-23408.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gpu11_expert_act&#45;&gt;layer3_gpu11_expert_mlp2 -->
<g id="edge393" class="edge">
<title>layer3_gpu11_expert_act&#45;&gt;layer3_gpu11_expert_mlp2</title>
<path fill="none" stroke="black" d="M8296.95,-23504.21C8304.12,-23495.39 8311.96,-23485.76 8319.45,-23476.56"/>
<polygon fill="black" stroke="black" points="8322.31,-23478.59 8325.9,-23468.63 8316.88,-23474.18 8322.31,-23478.59"/>
</g>
<!-- layer3_gpu11_token_send -->
<g id="node339" class="node">
<title>layer3_gpu11_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="8391" cy="-23316.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="8391" y="-23335.05" font-family="Times,serif" font-size="14.00">Token Send GPU11</text>
<text text-anchor="middle" x="8391" y="-23320.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="8391" y="-23305.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="8391" y="-23290.05" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gpu11_expert_mlp2&#45;&gt;layer3_gpu11_token_send -->
<g id="edge394" class="edge">
<title>layer3_gpu11_expert_mlp2&#45;&gt;layer3_gpu11_token_send</title>
<path fill="none" stroke="black" d="M8363.89,-23400.06C8366.56,-23391.9 8369.5,-23382.92 8372.42,-23373.99"/>
<polygon fill="black" stroke="black" points="8375.79,-23374.95 8375.58,-23364.36 8369.14,-23372.77 8375.79,-23374.95"/>
</g>
<!-- layer3_gpu11_token_send&#45;&gt;layer3_expert_agg -->
<g id="edge395" class="edge">
<title>layer3_gpu11_token_send&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M8149.02,-23280.91C8108.35,-23276.01 8066.52,-23271.51 8027,-23268.16 7257.21,-23202.96 6353.08,-23178.79 5854.72,-23170.01"/>
<polygon fill="black" stroke="black" points="5854.55,-23166.51 5844.49,-23169.83 5854.43,-23173.51 5854.55,-23166.51"/>
</g>
<!-- layer3_gpu12_expert_mlp1 -->
<g id="node341" class="node">
<title>layer3_gpu12_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9253.5,-23676.33 8792.5,-23676.33 8792.5,-23608.33 9253.5,-23608.33 9253.5,-23676.33"/>
<text text-anchor="middle" x="9023" y="-23661.13" font-family="Times,serif" font-size="14.00">Expert 12 MLP1</text>
<text text-anchor="middle" x="9023" y="-23646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9023" y="-23631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9023" y="-23616.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gpu12_token_recv&#45;&gt;layer3_gpu12_expert_mlp1 -->
<g id="edge397" class="edge">
<title>layer3_gpu12_token_recv&#45;&gt;layer3_gpu12_expert_mlp1</title>
<path fill="none" stroke="black" d="M8960.4,-23712.53C8968.94,-23703.09 8977.85,-23693.25 8986.18,-23684.04"/>
<polygon fill="black" stroke="black" points="8988.9,-23686.24 8993.02,-23676.48 8983.71,-23681.55 8988.9,-23686.24"/>
</g>
<!-- layer3_gpu12_expert_act -->
<g id="node342" class="node">
<title>layer3_gpu12_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9235.5,-23572.33 8858.5,-23572.33 8858.5,-23504.33 9235.5,-23504.33 9235.5,-23572.33"/>
<text text-anchor="middle" x="9047" y="-23557.13" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="9047" y="-23542.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9047" y="-23527.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9047" y="-23512.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gpu12_expert_mlp1&#45;&gt;layer3_gpu12_expert_act -->
<g id="edge398" class="edge">
<title>layer3_gpu12_expert_mlp1&#45;&gt;layer3_gpu12_expert_act</title>
<path fill="none" stroke="black" d="M9030.79,-23608.21C9032.72,-23600.02 9034.81,-23591.12 9036.84,-23582.52"/>
<polygon fill="black" stroke="black" points="9040.28,-23583.16 9039.16,-23572.63 9033.47,-23581.56 9040.28,-23583.16"/>
</g>
<!-- layer3_gpu12_expert_mlp2 -->
<g id="node343" class="node">
<title>layer3_gpu12_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9275.5,-23468.33 8868.5,-23468.33 8868.5,-23400.33 9275.5,-23400.33 9275.5,-23468.33"/>
<text text-anchor="middle" x="9072" y="-23453.13" font-family="Times,serif" font-size="14.00">Expert 12 MLP2</text>
<text text-anchor="middle" x="9072" y="-23438.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9072" y="-23423.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9072" y="-23408.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gpu12_expert_act&#45;&gt;layer3_gpu12_expert_mlp2 -->
<g id="edge399" class="edge">
<title>layer3_gpu12_expert_act&#45;&gt;layer3_gpu12_expert_mlp2</title>
<path fill="none" stroke="black" d="M9055.12,-23504.21C9057.13,-23496.02 9059.31,-23487.12 9061.41,-23478.52"/>
<polygon fill="black" stroke="black" points="9064.86,-23479.17 9063.84,-23468.63 9058.06,-23477.51 9064.86,-23479.17"/>
</g>
<!-- layer3_gpu12_token_send -->
<g id="node344" class="node">
<title>layer3_gpu12_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9120" cy="-23316.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9120" y="-23335.05" font-family="Times,serif" font-size="14.00">Token Send GPU12</text>
<text text-anchor="middle" x="9120" y="-23320.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9120" y="-23305.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9120" y="-23290.05" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gpu12_expert_mlp2&#45;&gt;layer3_gpu12_token_send -->
<g id="edge400" class="edge">
<title>layer3_gpu12_expert_mlp2&#45;&gt;layer3_gpu12_token_send</title>
<path fill="none" stroke="black" d="M9085.75,-23400.06C9089.17,-23391.81 9092.92,-23382.73 9096.65,-23373.71"/>
<polygon fill="black" stroke="black" points="9099.93,-23374.93 9100.52,-23364.36 9093.46,-23372.26 9099.93,-23374.93"/>
</g>
<!-- layer3_gpu12_token_send&#45;&gt;layer3_expert_agg -->
<g id="edge401" class="edge">
<title>layer3_gpu12_token_send&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M8879.52,-23280.79C8838.38,-23275.85 8796.02,-23271.37 8756,-23268.16 7703.84,-23183.79 6456.59,-23167.6 5848.15,-23165.09"/>
<polygon fill="black" stroke="black" points="5847.92,-23161.59 5837.9,-23165.05 5847.89,-23168.59 5847.92,-23161.59"/>
</g>
<!-- layer3_gpu13_expert_mlp1 -->
<g id="node346" class="node">
<title>layer3_gpu13_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9975.5,-23676.33 9514.5,-23676.33 9514.5,-23608.33 9975.5,-23608.33 9975.5,-23676.33"/>
<text text-anchor="middle" x="9745" y="-23661.13" font-family="Times,serif" font-size="14.00">Expert 13 MLP1</text>
<text text-anchor="middle" x="9745" y="-23646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9745" y="-23631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9745" y="-23616.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gpu13_token_recv&#45;&gt;layer3_gpu13_expert_mlp1 -->
<g id="edge403" class="edge">
<title>layer3_gpu13_token_recv&#45;&gt;layer3_gpu13_expert_mlp1</title>
<path fill="none" stroke="black" d="M9661.14,-23712.87C9673,-23703.03 9685.43,-23692.73 9696.96,-23683.16"/>
<polygon fill="black" stroke="black" points="9699.32,-23685.75 9704.79,-23676.67 9694.86,-23680.36 9699.32,-23685.75"/>
</g>
<!-- layer3_gpu13_expert_act -->
<g id="node347" class="node">
<title>layer3_gpu13_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9947.5,-23572.33 9570.5,-23572.33 9570.5,-23504.33 9947.5,-23504.33 9947.5,-23572.33"/>
<text text-anchor="middle" x="9759" y="-23557.13" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="9759" y="-23542.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9759" y="-23527.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9759" y="-23512.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gpu13_expert_mlp1&#45;&gt;layer3_gpu13_expert_act -->
<g id="edge404" class="edge">
<title>layer3_gpu13_expert_mlp1&#45;&gt;layer3_gpu13_expert_act</title>
<path fill="none" stroke="black" d="M9749.55,-23608.21C9750.66,-23600.11 9751.87,-23591.31 9753.03,-23582.8"/>
<polygon fill="black" stroke="black" points="9756.54,-23583.01 9754.43,-23572.63 9749.6,-23582.06 9756.54,-23583.01"/>
</g>
<!-- layer3_gpu13_expert_mlp2 -->
<g id="node348" class="node">
<title>layer3_gpu13_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10024.5,-23468.33 9617.5,-23468.33 9617.5,-23400.33 10024.5,-23400.33 10024.5,-23468.33"/>
<text text-anchor="middle" x="9821" y="-23453.13" font-family="Times,serif" font-size="14.00">Expert 13 MLP2</text>
<text text-anchor="middle" x="9821" y="-23438.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9821" y="-23423.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9821" y="-23408.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gpu13_expert_act&#45;&gt;layer3_gpu13_expert_mlp2 -->
<g id="edge405" class="edge">
<title>layer3_gpu13_expert_act&#45;&gt;layer3_gpu13_expert_mlp2</title>
<path fill="none" stroke="black" d="M9779.13,-23504.21C9784.33,-23495.66 9789.99,-23486.34 9795.43,-23477.4"/>
<polygon fill="black" stroke="black" points="9798.56,-23478.99 9800.76,-23468.63 9792.57,-23475.36 9798.56,-23478.99"/>
</g>
<!-- layer3_gpu13_token_send -->
<g id="node349" class="node">
<title>layer3_gpu13_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9849" cy="-23316.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9849" y="-23335.05" font-family="Times,serif" font-size="14.00">Token Send GPU13</text>
<text text-anchor="middle" x="9849" y="-23320.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9849" y="-23305.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9849" y="-23290.05" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gpu13_expert_mlp2&#45;&gt;layer3_gpu13_token_send -->
<g id="edge406" class="edge">
<title>layer3_gpu13_expert_mlp2&#45;&gt;layer3_gpu13_token_send</title>
<path fill="none" stroke="black" d="M9829.02,-23400.06C9830.97,-23391.98 9833.11,-23383.12 9835.24,-23374.28"/>
<polygon fill="black" stroke="black" points="9838.69,-23374.9 9837.64,-23364.36 9831.89,-23373.26 9838.69,-23374.9"/>
</g>
<!-- layer3_gpu13_token_send&#45;&gt;layer3_expert_agg -->
<g id="edge407" class="edge">
<title>layer3_gpu13_token_send&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M9609.02,-23280.65C9567.73,-23275.72 9525.18,-23271.27 9485,-23268.16 8787.13,-23214.21 6712.07,-23181.46 5854.42,-23169.9"/>
<polygon fill="black" stroke="black" points="5854.44,-23166.4 5844.39,-23169.76 5854.34,-23173.39 5854.44,-23166.4"/>
</g>
<!-- layer3_gpu14_expert_mlp1 -->
<g id="node351" class="node">
<title>layer3_gpu14_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="10536.5,-23676.33 10075.5,-23676.33 10075.5,-23608.33 10536.5,-23608.33 10536.5,-23676.33"/>
<text text-anchor="middle" x="10306" y="-23661.13" font-family="Times,serif" font-size="14.00">Expert 14 MLP1</text>
<text text-anchor="middle" x="10306" y="-23646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10306" y="-23631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10306" y="-23616.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gpu14_token_recv&#45;&gt;layer3_gpu14_expert_mlp1 -->
<g id="edge409" class="edge">
<title>layer3_gpu14_token_recv&#45;&gt;layer3_gpu14_expert_mlp1</title>
<path fill="none" stroke="black" d="M10297.69,-23712.2C10298.71,-23703.81 10299.75,-23695.11 10300.75,-23686.84"/>
<polygon fill="black" stroke="black" points="10304.26,-23686.98 10301.98,-23676.63 10297.31,-23686.14 10304.26,-23686.98"/>
</g>
<!-- layer3_gpu14_expert_act -->
<g id="node352" class="node">
<title>layer3_gpu14_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="10766.5,-23572.33 10389.5,-23572.33 10389.5,-23504.33 10766.5,-23504.33 10766.5,-23572.33"/>
<text text-anchor="middle" x="10578" y="-23557.13" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="10578" y="-23542.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10578" y="-23527.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10578" y="-23512.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gpu14_expert_mlp1&#45;&gt;layer3_gpu14_expert_act -->
<g id="edge410" class="edge">
<title>layer3_gpu14_expert_mlp1&#45;&gt;layer3_gpu14_expert_act</title>
<path fill="none" stroke="black" d="M10394.31,-23608.21C10421.77,-23597.92 10452.19,-23586.51 10480.25,-23575.99"/>
<polygon fill="black" stroke="black" points="10481.53,-23579.24 10489.67,-23572.45 10479.08,-23572.69 10481.53,-23579.24"/>
</g>
<!-- layer3_gpu14_expert_mlp2 -->
<g id="node353" class="node">
<title>layer3_gpu14_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10781.5,-23468.33 10374.5,-23468.33 10374.5,-23400.33 10781.5,-23400.33 10781.5,-23468.33"/>
<text text-anchor="middle" x="10578" y="-23453.13" font-family="Times,serif" font-size="14.00">Expert 14 MLP2</text>
<text text-anchor="middle" x="10578" y="-23438.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10578" y="-23423.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="10578" y="-23408.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gpu14_expert_act&#45;&gt;layer3_gpu14_expert_mlp2 -->
<g id="edge411" class="edge">
<title>layer3_gpu14_expert_act&#45;&gt;layer3_gpu14_expert_mlp2</title>
<path fill="none" stroke="black" d="M10578,-23504.21C10578,-23496.11 10578,-23487.31 10578,-23478.8"/>
<polygon fill="black" stroke="black" points="10581.5,-23478.63 10578,-23468.63 10574.5,-23478.63 10581.5,-23478.63"/>
</g>
<!-- layer3_gpu14_token_send -->
<g id="node354" class="node">
<title>layer3_gpu14_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="10578" cy="-23316.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="10578" y="-23335.05" font-family="Times,serif" font-size="14.00">Token Send GPU14</text>
<text text-anchor="middle" x="10578" y="-23320.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="10578" y="-23305.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="10578" y="-23290.05" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gpu14_expert_mlp2&#45;&gt;layer3_gpu14_token_send -->
<g id="edge412" class="edge">
<title>layer3_gpu14_expert_mlp2&#45;&gt;layer3_gpu14_token_send</title>
<path fill="none" stroke="black" d="M10578,-23400.06C10578,-23392.07 10578,-23383.31 10578,-23374.56"/>
<polygon fill="black" stroke="black" points="10581.5,-23374.36 10578,-23364.36 10574.5,-23374.36 10581.5,-23374.36"/>
</g>
<!-- layer3_gpu14_token_send&#45;&gt;layer3_expert_agg -->
<g id="edge413" class="edge">
<title>layer3_gpu14_token_send&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M10339.01,-23280.63C10297.41,-23275.67 10254.51,-23271.21 10214,-23268.16 9369.31,-23204.53 6817.75,-23176.62 5852.45,-23168.14"/>
<polygon fill="black" stroke="black" points="5852.26,-23164.64 5842.22,-23168.05 5852.19,-23171.64 5852.26,-23164.64"/>
</g>
<!-- layer3_gpu15_expert_mlp1 -->
<g id="node356" class="node">
<title>layer3_gpu15_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="11213.5,-23676.33 10752.5,-23676.33 10752.5,-23608.33 11213.5,-23608.33 11213.5,-23676.33"/>
<text text-anchor="middle" x="10983" y="-23661.13" font-family="Times,serif" font-size="14.00">Expert 15 MLP1</text>
<text text-anchor="middle" x="10983" y="-23646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10983" y="-23631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10983" y="-23616.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gpu15_token_recv&#45;&gt;layer3_gpu15_expert_mlp1 -->
<g id="edge415" class="edge">
<title>layer3_gpu15_token_recv&#45;&gt;layer3_gpu15_expert_mlp1</title>
<path fill="none" stroke="black" d="M10980.63,-23712.2C10980.92,-23703.81 10981.22,-23695.11 10981.5,-23686.84"/>
<polygon fill="black" stroke="black" points="10985.01,-23686.75 10981.85,-23676.63 10978.01,-23686.51 10985.01,-23686.75"/>
</g>
<!-- layer3_gpu15_expert_act -->
<g id="node357" class="node">
<title>layer3_gpu15_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="11176.5,-23572.33 10799.5,-23572.33 10799.5,-23504.33 11176.5,-23504.33 11176.5,-23572.33"/>
<text text-anchor="middle" x="10988" y="-23557.13" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="10988" y="-23542.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10988" y="-23527.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10988" y="-23512.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gpu15_expert_mlp1&#45;&gt;layer3_gpu15_expert_act -->
<g id="edge416" class="edge">
<title>layer3_gpu15_expert_mlp1&#45;&gt;layer3_gpu15_expert_act</title>
<path fill="none" stroke="black" d="M10984.62,-23608.21C10985.02,-23600.11 10985.45,-23591.31 10985.87,-23582.8"/>
<polygon fill="black" stroke="black" points="10989.37,-23582.79 10986.37,-23572.63 10982.38,-23582.45 10989.37,-23582.79"/>
</g>
<!-- layer3_gpu15_expert_mlp2 -->
<g id="node358" class="node">
<title>layer3_gpu15_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="11358.5,-23468.33 10951.5,-23468.33 10951.5,-23400.33 11358.5,-23400.33 11358.5,-23468.33"/>
<text text-anchor="middle" x="11155" y="-23453.13" font-family="Times,serif" font-size="14.00">Expert 15 MLP2</text>
<text text-anchor="middle" x="11155" y="-23438.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11155" y="-23423.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="11155" y="-23408.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gpu15_expert_act&#45;&gt;layer3_gpu15_expert_mlp2 -->
<g id="edge417" class="edge">
<title>layer3_gpu15_expert_act&#45;&gt;layer3_gpu15_expert_mlp2</title>
<path fill="none" stroke="black" d="M11042.22,-23504.21C11058.05,-23494.54 11075.49,-23483.89 11091.82,-23473.92"/>
<polygon fill="black" stroke="black" points="11094.06,-23476.65 11100.77,-23468.45 11090.41,-23470.68 11094.06,-23476.65"/>
</g>
<!-- layer3_gpu15_token_send -->
<g id="node359" class="node">
<title>layer3_gpu15_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="11307" cy="-23316.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="11307" y="-23335.05" font-family="Times,serif" font-size="14.00">Token Send GPU15</text>
<text text-anchor="middle" x="11307" y="-23320.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="11307" y="-23305.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="11307" y="-23290.05" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gpu15_expert_mlp2&#45;&gt;layer3_gpu15_token_send -->
<g id="edge418" class="edge">
<title>layer3_gpu15_expert_mlp2&#45;&gt;layer3_gpu15_token_send</title>
<path fill="none" stroke="black" d="M11198.56,-23400.06C11210.83,-23390.69 11224.5,-23380.25 11237.88,-23370.03"/>
<polygon fill="black" stroke="black" points="11240.34,-23372.56 11246.16,-23363.71 11236.09,-23367 11240.34,-23372.56"/>
</g>
<!-- layer3_gpu15_token_send&#45;&gt;layer3_expert_agg -->
<g id="edge419" class="edge">
<title>layer3_gpu15_token_send&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M11068.02,-23280.53C11026.42,-23275.58 10983.51,-23271.16 10943,-23268.16 9950.22,-23194.82 6914.36,-23172.52 5850.26,-23166.85"/>
<polygon fill="black" stroke="black" points="5850.17,-23163.35 5840.15,-23166.8 5850.13,-23170.35 5850.17,-23163.35"/>
</g>
<!-- layer3_residual2 -->
<g id="node361" class="node">
<title>layer3_residual2</title>
<polygon fill="lightyellow" stroke="black" points="5919.89,-23060.16 5215.35,-23060.16 5034.11,-22924.16 5738.65,-22924.16 5919.89,-23060.16"/>
<text text-anchor="middle" x="5477" y="-23010.96" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="5477" y="-22995.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5477" y="-22980.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-22965.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer3_expert_agg&#45;&gt;layer3_residual2 -->
<g id="edge420" class="edge">
<title>layer3_expert_agg&#45;&gt;layer3_residual2</title>
<path fill="none" stroke="black" d="M5477,-23095.97C5477,-23087.66 5477,-23079.11 5477,-23070.66"/>
<polygon fill="black" stroke="black" points="5480.5,-23070.42 5477,-23060.42 5473.5,-23070.42 5480.5,-23070.42"/>
</g>
<!-- layer4_layernorm -->
<g id="node362" class="node">
<title>layer4_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="5680.5,-22877.16 5273.5,-22877.16 5273.5,-22809.16 5680.5,-22809.16 5680.5,-22877.16"/>
<text text-anchor="middle" x="5477" y="-22861.96" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5477" y="-22846.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-22831.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-22816.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer3_residual2&#45;&gt;layer4_layernorm -->
<g id="edge421" class="edge">
<title>layer3_residual2&#45;&gt;layer4_layernorm</title>
<path fill="none" stroke="black" d="M5477,-22924.12C5477,-22911.71 5477,-22899.06 5477,-22887.58"/>
<polygon fill="black" stroke="black" points="5480.5,-22887.42 5477,-22877.42 5473.5,-22887.42 5480.5,-22887.42"/>
</g>
<!-- layer4_qkv_proj -->
<g id="node363" class="node">
<title>layer4_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="5734.5,-22773.16 5219.5,-22773.16 5219.5,-22705.16 5734.5,-22705.16 5734.5,-22773.16"/>
<text text-anchor="middle" x="5477" y="-22757.96" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5477" y="-22742.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-22727.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5477" y="-22712.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer4_layernorm&#45;&gt;layer4_qkv_proj -->
<g id="edge422" class="edge">
<title>layer4_layernorm&#45;&gt;layer4_qkv_proj</title>
<path fill="none" stroke="black" d="M5477,-22809.05C5477,-22800.94 5477,-22792.15 5477,-22783.64"/>
<polygon fill="black" stroke="black" points="5480.5,-22783.46 5477,-22773.46 5473.5,-22783.46 5480.5,-22783.46"/>
</g>
<!-- layer4_attention -->
<g id="node364" class="node">
<title>layer4_attention</title>
<polygon fill="lightgreen" stroke="black" points="5728.5,-22669.16 5225.5,-22669.16 5225.5,-22601.16 5728.5,-22601.16 5728.5,-22669.16"/>
<text text-anchor="middle" x="5477" y="-22653.96" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5477" y="-22638.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5477" y="-22623.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5477" y="-22608.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer4_qkv_proj&#45;&gt;layer4_attention -->
<g id="edge423" class="edge">
<title>layer4_qkv_proj&#45;&gt;layer4_attention</title>
<path fill="none" stroke="black" d="M5477,-22705.05C5477,-22696.94 5477,-22688.15 5477,-22679.64"/>
<polygon fill="black" stroke="black" points="5480.5,-22679.46 5477,-22669.46 5473.5,-22679.46 5480.5,-22679.46"/>
</g>
<!-- layer4_attn_out -->
<g id="node365" class="node">
<title>layer4_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="5715.5,-22565.16 5238.5,-22565.16 5238.5,-22497.16 5715.5,-22497.16 5715.5,-22565.16"/>
<text text-anchor="middle" x="5477" y="-22549.96" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5477" y="-22534.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5477" y="-22519.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-22504.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer4_attention&#45;&gt;layer4_attn_out -->
<g id="edge424" class="edge">
<title>layer4_attention&#45;&gt;layer4_attn_out</title>
<path fill="none" stroke="black" d="M5477,-22601.05C5477,-22592.94 5477,-22584.15 5477,-22575.64"/>
<polygon fill="black" stroke="black" points="5480.5,-22575.46 5477,-22565.46 5473.5,-22575.46 5480.5,-22575.46"/>
</g>
<!-- layer4_residual1 -->
<g id="node366" class="node">
<title>layer4_residual1</title>
<polygon fill="lightyellow" stroke="black" points="5919.89,-22461.16 5215.35,-22461.16 5034.11,-22325.16 5738.65,-22325.16 5919.89,-22461.16"/>
<text text-anchor="middle" x="5477" y="-22411.96" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5477" y="-22396.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5477" y="-22381.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-22366.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer4_attn_out&#45;&gt;layer4_residual1 -->
<g id="edge425" class="edge">
<title>layer4_attn_out&#45;&gt;layer4_residual1</title>
<path fill="none" stroke="black" d="M5477,-22496.89C5477,-22489.07 5477,-22480.4 5477,-22471.52"/>
<polygon fill="black" stroke="black" points="5480.5,-22471.43 5477,-22461.43 5473.5,-22471.43 5480.5,-22471.43"/>
</g>
<!-- layer4_layernorm2 -->
<g id="node367" class="node">
<title>layer4_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="5680.5,-22289.16 5273.5,-22289.16 5273.5,-22221.16 5680.5,-22221.16 5680.5,-22289.16"/>
<text text-anchor="middle" x="5477" y="-22273.96" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5477" y="-22258.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-22243.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-22228.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer4_residual1&#45;&gt;layer4_layernorm2 -->
<g id="edge426" class="edge">
<title>layer4_residual1&#45;&gt;layer4_layernorm2</title>
<path fill="none" stroke="black" d="M5477,-22324.96C5477,-22316.21 5477,-22307.44 5477,-22299.23"/>
<polygon fill="black" stroke="black" points="5480.5,-22299.18 5477,-22289.18 5473.5,-22299.18 5480.5,-22299.18"/>
</g>
<!-- layer4_global_gate -->
<g id="node368" class="node">
<title>layer4_global_gate</title>
<polygon fill="lightgreen" stroke="black" points="5674.5,-22185.16 5279.5,-22185.16 5279.5,-22117.16 5674.5,-22117.16 5674.5,-22185.16"/>
<text text-anchor="middle" x="5477" y="-22169.96" font-family="Times,serif" font-size="14.00">Global Gate</text>
<text text-anchor="middle" x="5477" y="-22154.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-22139.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, experts=64]</text>
<text text-anchor="middle" x="5477" y="-22124.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer4_layernorm2&#45;&gt;layer4_global_gate -->
<g id="edge427" class="edge">
<title>layer4_layernorm2&#45;&gt;layer4_global_gate</title>
<path fill="none" stroke="black" d="M5477,-22221.05C5477,-22212.94 5477,-22204.15 5477,-22195.64"/>
<polygon fill="black" stroke="black" points="5480.5,-22195.46 5477,-22185.46 5473.5,-22195.46 5480.5,-22195.46"/>
</g>
<!-- layer4_routing -->
<g id="node369" class="node">
<title>layer4_routing</title>
<polygon fill="lightyellow" stroke="black" points="5963.47,-22081.16 5189.6,-22081.16 4990.53,-21945.16 5764.4,-21945.16 5963.47,-22081.16"/>
<text text-anchor="middle" x="5477" y="-22031.96" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="5477" y="-22016.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-22001.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5477" y="-21986.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer4_global_gate&#45;&gt;layer4_routing -->
<g id="edge428" class="edge">
<title>layer4_global_gate&#45;&gt;layer4_routing</title>
<path fill="none" stroke="black" d="M5477,-22116.89C5477,-22109.07 5477,-22100.4 5477,-22091.52"/>
<polygon fill="black" stroke="black" points="5480.5,-22091.43 5477,-22081.43 5473.5,-22091.43 5480.5,-22091.43"/>
</g>
<!-- layer4_gpu0_token_recv -->
<g id="node370" class="node">
<title>layer4_gpu0_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="477" cy="-21861.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="477" y="-21879.88" font-family="Times,serif" font-size="14.00">Token Receive GPU0</text>
<text text-anchor="middle" x="477" y="-21864.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="477" y="-21849.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="477" y="-21834.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer4_routing&#45;&gt;layer4_gpu0_token_recv -->
<g id="edge429" class="edge">
<title>layer4_routing&#45;&gt;layer4_gpu0_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5082.8,-22008.39C4121.85,-21998.38 1677.78,-21967.81 863,-21909.16 818.38,-21905.95 771,-21901.25 725.27,-21896.04"/>
<polygon fill="black" stroke="black" points="725.57,-21892.55 715.24,-21894.89 724.77,-21899.51 725.57,-21892.55"/>
</g>
<!-- layer4_gpu1_token_recv -->
<g id="node375" class="node">
<title>layer4_gpu1_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1206" cy="-21861.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1206" y="-21879.88" font-family="Times,serif" font-size="14.00">Token Receive GPU1</text>
<text text-anchor="middle" x="1206" y="-21864.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1206" y="-21849.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1206" y="-21834.88" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer4_routing&#45;&gt;layer4_gpu1_token_recv -->
<g id="edge435" class="edge">
<title>layer4_routing&#45;&gt;layer4_gpu1_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5080.78,-22006.85C4228.43,-21994.58 2243.53,-21961.27 1571,-21909.16 1531.42,-21906.1 1489.56,-21901.75 1448.85,-21896.91"/>
<polygon fill="black" stroke="black" points="1449.15,-21893.43 1438.8,-21895.71 1448.32,-21900.38 1449.15,-21893.43"/>
</g>
<!-- layer4_gpu2_token_recv -->
<g id="node380" class="node">
<title>layer4_gpu2_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1914" cy="-21861.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1914" y="-21879.88" font-family="Times,serif" font-size="14.00">Token Receive GPU2</text>
<text text-anchor="middle" x="1914" y="-21864.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1914" y="-21849.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1914" y="-21834.88" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer4_routing&#45;&gt;layer4_gpu2_token_recv -->
<g id="edge441" class="edge">
<title>layer4_routing&#45;&gt;layer4_gpu2_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5088.46,-22012.12C4484.53,-22009.25 3284.45,-21992.33 2270,-21909.16 2232.64,-21906.1 2193.19,-21901.88 2154.7,-21897.21"/>
<polygon fill="black" stroke="black" points="2154.75,-21893.69 2144.4,-21895.95 2153.9,-21900.64 2154.75,-21893.69"/>
</g>
<!-- layer4_gpu3_token_recv -->
<g id="node385" class="node">
<title>layer4_gpu3_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="2613" cy="-21861.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2613" y="-21879.88" font-family="Times,serif" font-size="14.00">Token Receive GPU3</text>
<text text-anchor="middle" x="2613" y="-21864.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="2613" y="-21849.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2613" y="-21834.88" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer4_routing&#45;&gt;layer4_gpu3_token_recv -->
<g id="edge447" class="edge">
<title>layer4_routing&#45;&gt;layer4_gpu3_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5081.39,-22007.29C4585.54,-21998.57 3709.98,-21974.57 2963,-21909.16 2927.41,-21906.05 2889.89,-21901.91 2853.16,-21897.38"/>
<polygon fill="black" stroke="black" points="2853.18,-21893.85 2842.82,-21896.09 2852.31,-21900.8 2853.18,-21893.85"/>
</g>
<!-- layer4_gpu4_token_recv -->
<g id="node390" class="node">
<title>layer4_gpu4_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="3306" cy="-21861.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="3306" y="-21879.88" font-family="Times,serif" font-size="14.00">Token Receive GPU4</text>
<text text-anchor="middle" x="3306" y="-21864.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="3306" y="-21849.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3306" y="-21834.88" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_routing&#45;&gt;layer4_gpu4_token_recv -->
<g id="edge453" class="edge">
<title>layer4_routing&#45;&gt;layer4_gpu4_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5062.63,-21994.63C4704.84,-21977.9 4174.29,-21949.28 3713,-21909.16 3665.18,-21905 3614.3,-21899.77 3565.28,-21894.31"/>
<polygon fill="black" stroke="black" points="3565.51,-21890.81 3555.18,-21893.18 3564.73,-21897.77 3565.51,-21890.81"/>
</g>
<!-- layer4_gpu5_token_recv -->
<g id="node395" class="node">
<title>layer4_gpu5_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4056" cy="-21861.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4056" y="-21879.88" font-family="Times,serif" font-size="14.00">Token Receive GPU5</text>
<text text-anchor="middle" x="4056" y="-21864.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4056" y="-21849.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4056" y="-21834.88" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer4_routing&#45;&gt;layer4_gpu5_token_recv -->
<g id="edge459" class="edge">
<title>layer4_routing&#45;&gt;layer4_gpu5_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5027.51,-21970.56C4842.61,-21952.75 4626.4,-21931.05 4431,-21909.16 4392.3,-21904.83 4351.39,-21899.97 4311.38,-21895.07"/>
<polygon fill="black" stroke="black" points="4311.58,-21891.57 4301.23,-21893.83 4310.73,-21898.52 4311.58,-21891.57"/>
</g>
<!-- layer4_gpu6_token_recv -->
<g id="node400" class="node">
<title>layer4_gpu6_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4774" cy="-21861.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4774" y="-21879.88" font-family="Times,serif" font-size="14.00">Token Receive GPU6</text>
<text text-anchor="middle" x="4774" y="-21864.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4774" y="-21849.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4774" y="-21834.88" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer4_routing&#45;&gt;layer4_gpu6_token_recv -->
<g id="edge465" class="edge">
<title>layer4_routing&#45;&gt;layer4_gpu6_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5163.02,-21945.13C5096.48,-21930.93 5028.13,-21916.33 4967.64,-21903.42"/>
<polygon fill="black" stroke="black" points="4968.13,-21899.94 4957.61,-21901.28 4966.66,-21906.79 4968.13,-21899.94"/>
</g>
<!-- layer4_gpu7_token_recv -->
<g id="node405" class="node">
<title>layer4_gpu7_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="5477" cy="-21861.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="5477" y="-21879.88" font-family="Times,serif" font-size="14.00">Token Receive GPU7</text>
<text text-anchor="middle" x="5477" y="-21864.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5477" y="-21849.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5477" y="-21834.88" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer4_routing&#45;&gt;layer4_gpu7_token_recv -->
<g id="edge471" class="edge">
<title>layer4_routing&#45;&gt;layer4_gpu7_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5477,-21945.02C5477,-21936.48 5477,-21927.79 5477,-21919.42"/>
<polygon fill="black" stroke="black" points="5480.5,-21919.4 5477,-21909.4 5473.5,-21919.4 5480.5,-21919.4"/>
</g>
<!-- layer4_gpu8_token_recv -->
<g id="node410" class="node">
<title>layer4_gpu8_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6165" cy="-21861.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6165" y="-21879.88" font-family="Times,serif" font-size="14.00">Token Receive GPU8</text>
<text text-anchor="middle" x="6165" y="-21864.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6165" y="-21849.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6165" y="-21834.88" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer4_routing&#45;&gt;layer4_gpu8_token_recv -->
<g id="edge477" class="edge">
<title>layer4_routing&#45;&gt;layer4_gpu8_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5769.27,-21948.41C5838.41,-21933.32 5910.39,-21917.62 5973.71,-21903.81"/>
<polygon fill="black" stroke="black" points="5974.78,-21907.16 5983.8,-21901.61 5973.29,-21900.32 5974.78,-21907.16"/>
</g>
<!-- layer4_gpu9_token_recv -->
<g id="node415" class="node">
<title>layer4_gpu9_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6852" cy="-21861.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6852" y="-21879.88" font-family="Times,serif" font-size="14.00">Token Receive GPU9</text>
<text text-anchor="middle" x="6852" y="-21864.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6852" y="-21849.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6852" y="-21834.88" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer4_routing&#45;&gt;layer4_gpu9_token_recv -->
<g id="edge483" class="edge">
<title>layer4_routing&#45;&gt;layer4_gpu9_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5817.49,-21981.29C6018.57,-21962.28 6278,-21936.38 6508,-21909.16 6540.01,-21905.38 6573.65,-21901.12 6606.85,-21896.75"/>
<polygon fill="black" stroke="black" points="6607.68,-21900.17 6617.14,-21895.39 6606.77,-21893.23 6607.68,-21900.17"/>
</g>
<!-- layer4_gpu10_token_recv -->
<g id="node420" class="node">
<title>layer4_gpu10_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="7539" cy="-21861.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="7539" y="-21879.88" font-family="Times,serif" font-size="14.00">Token Receive GPU10</text>
<text text-anchor="middle" x="7539" y="-21864.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="7539" y="-21849.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7539" y="-21834.88" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer4_routing&#45;&gt;layer4_gpu10_token_recv -->
<g id="edge489" class="edge">
<title>layer4_routing&#45;&gt;layer4_gpu10_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5842.52,-21998.32C6190.76,-21983.23 6729.43,-21954.91 7195,-21909.16 7228.58,-21905.86 7263.92,-21901.76 7298.65,-21897.35"/>
<polygon fill="black" stroke="black" points="7299.44,-21900.78 7308.91,-21896.04 7298.55,-21893.84 7299.44,-21900.78"/>
</g>
<!-- layer4_gpu11_token_recv -->
<g id="node425" class="node">
<title>layer4_gpu11_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8226" cy="-21861.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8226" y="-21879.88" font-family="Times,serif" font-size="14.00">Token Receive GPU11</text>
<text text-anchor="middle" x="8226" y="-21864.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8226" y="-21849.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8226" y="-21834.88" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer4_routing&#45;&gt;layer4_gpu11_token_recv -->
<g id="edge495" class="edge">
<title>layer4_routing&#45;&gt;layer4_gpu11_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5854.96,-22006.86C6329.25,-21997.7 7167.22,-21973.24 7882,-21909.16 7916.3,-21906.09 7952.42,-21902.04 7987.84,-21897.61"/>
<polygon fill="black" stroke="black" points="7988.33,-21901.07 7997.82,-21896.35 7987.46,-21894.13 7988.33,-21901.07"/>
</g>
<!-- layer4_gpu12_token_recv -->
<g id="node430" class="node">
<title>layer4_gpu12_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8913" cy="-21861.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8913" y="-21879.88" font-family="Times,serif" font-size="14.00">Token Receive GPU12</text>
<text text-anchor="middle" x="8913" y="-21864.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8913" y="-21849.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8913" y="-21834.88" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer4_routing&#45;&gt;layer4_gpu12_token_recv -->
<g id="edge501" class="edge">
<title>layer4_routing&#45;&gt;layer4_gpu12_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5862.47,-22012.02C6448.24,-22008.93 7597.15,-21991.64 8569,-21909.16 8603.73,-21906.22 8640.31,-21902.2 8676.15,-21897.75"/>
<polygon fill="black" stroke="black" points="8676.74,-21901.2 8686.23,-21896.48 8675.87,-21894.25 8676.74,-21901.2"/>
</g>
<!-- layer4_gpu13_token_recv -->
<g id="node435" class="node">
<title>layer4_gpu13_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="9600" cy="-21861.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="9600" y="-21879.88" font-family="Times,serif" font-size="14.00">Token Receive GPU13</text>
<text text-anchor="middle" x="9600" y="-21864.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="9600" y="-21849.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9600" y="-21834.88" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer4_routing&#45;&gt;layer4_gpu13_token_recv -->
<g id="edge507" class="edge">
<title>layer4_routing&#45;&gt;layer4_gpu13_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5855.33,-22007.09C6677.21,-21995.21 8604.22,-21962.49 9256,-21909.16 9291.01,-21906.3 9327.9,-21902.3 9364.01,-21897.83"/>
<polygon fill="black" stroke="black" points="9364.68,-21901.27 9374.17,-21896.56 9363.81,-21894.33 9364.68,-21901.27"/>
</g>
<!-- layer4_gpu14_token_recv -->
<g id="node440" class="node">
<title>layer4_gpu14_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10287" cy="-21861.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10287" y="-21879.88" font-family="Times,serif" font-size="14.00">Token Receive GPU14</text>
<text text-anchor="middle" x="10287" y="-21864.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10287" y="-21849.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10287" y="-21834.88" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer4_routing&#45;&gt;layer4_gpu14_token_recv -->
<g id="edge513" class="edge">
<title>layer4_routing&#45;&gt;layer4_gpu14_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5857.76,-22008.92C6787.42,-22000.1 9154.56,-21972.01 9943,-21909.16 9978.15,-21906.36 10015.2,-21902.38 10051.45,-21897.91"/>
<polygon fill="black" stroke="black" points="10052.16,-21901.35 10061.65,-21896.63 10051.29,-21894.4 10052.16,-21901.35"/>
</g>
<!-- layer4_gpu15_token_recv -->
<g id="node445" class="node">
<title>layer4_gpu15_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10974" cy="-21861.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10974" y="-21879.88" font-family="Times,serif" font-size="14.00">Token Receive GPU15</text>
<text text-anchor="middle" x="10974" y="-21864.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10974" y="-21849.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10974" y="-21834.88" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer4_routing&#45;&gt;layer4_gpu15_token_recv -->
<g id="edge519" class="edge">
<title>layer4_routing&#45;&gt;layer4_gpu15_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5859.8,-22010.28C6889.63,-22004.28 9703.77,-21981.56 10630,-21909.16 10665.29,-21906.4 10702.5,-21902.43 10738.88,-21897.95"/>
<polygon fill="black" stroke="black" points="10739.63,-21901.39 10749.12,-21896.67 10738.76,-21894.44 10739.63,-21901.39"/>
</g>
<!-- layer4_gpu0_expert_mlp1 -->
<g id="node371" class="node">
<title>layer4_gpu0_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="697.5,-21777 236.5,-21777 236.5,-21709 697.5,-21709 697.5,-21777"/>
<text text-anchor="middle" x="467" y="-21761.8" font-family="Times,serif" font-size="14.00">Expert 0 MLP1</text>
<text text-anchor="middle" x="467" y="-21746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="467" y="-21731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="467" y="-21716.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer4_gpu0_token_recv&#45;&gt;layer4_gpu0_expert_mlp1 -->
<g id="edge430" class="edge">
<title>layer4_gpu0_token_recv&#45;&gt;layer4_gpu0_expert_mlp1</title>
<path fill="none" stroke="black" d="M472.93,-21812.86C472.21,-21804.48 471.46,-21795.78 470.75,-21787.5"/>
<polygon fill="black" stroke="black" points="474.21,-21786.96 469.87,-21777.3 467.24,-21787.56 474.21,-21786.96"/>
</g>
<!-- layer4_gpu0_expert_act -->
<g id="node372" class="node">
<title>layer4_gpu0_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="639.5,-21673 262.5,-21673 262.5,-21605 639.5,-21605 639.5,-21673"/>
<text text-anchor="middle" x="451" y="-21657.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="451" y="-21642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="451" y="-21627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="451" y="-21612.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer4_gpu0_expert_mlp1&#45;&gt;layer4_gpu0_expert_act -->
<g id="edge431" class="edge">
<title>layer4_gpu0_expert_mlp1&#45;&gt;layer4_gpu0_expert_act</title>
<path fill="none" stroke="black" d="M461.81,-21708.88C460.52,-21700.69 459.12,-21691.79 457.78,-21683.19"/>
<polygon fill="black" stroke="black" points="461.23,-21682.63 456.22,-21673.3 454.32,-21683.72 461.23,-21682.63"/>
</g>
<!-- layer4_gpu0_expert_mlp2 -->
<g id="node373" class="node">
<title>layer4_gpu0_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="615.5,-21569 208.5,-21569 208.5,-21501 615.5,-21501 615.5,-21569"/>
<text text-anchor="middle" x="412" y="-21553.8" font-family="Times,serif" font-size="14.00">Expert 0 MLP2</text>
<text text-anchor="middle" x="412" y="-21538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="412" y="-21523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="412" y="-21508.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer4_gpu0_expert_act&#45;&gt;layer4_gpu0_expert_mlp2 -->
<g id="edge432" class="edge">
<title>layer4_gpu0_expert_act&#45;&gt;layer4_gpu0_expert_mlp2</title>
<path fill="none" stroke="black" d="M438.34,-21604.88C435.17,-21596.6 431.73,-21587.59 428.41,-21578.91"/>
<polygon fill="black" stroke="black" points="431.57,-21577.39 424.73,-21569.3 425.03,-21579.89 431.57,-21577.39"/>
</g>
<!-- layer4_gpu0_token_send -->
<g id="node374" class="node">
<title>layer4_gpu0_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="372" cy="-21416.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="372" y="-21435.71" font-family="Times,serif" font-size="14.00">Token Send GPU0</text>
<text text-anchor="middle" x="372" y="-21420.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="372" y="-21405.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="372" y="-21390.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer4_gpu0_expert_mlp2&#45;&gt;layer4_gpu0_token_send -->
<g id="edge433" class="edge">
<title>layer4_gpu0_expert_mlp2&#45;&gt;layer4_gpu0_token_send</title>
<path fill="none" stroke="black" d="M400.54,-21500.73C397.72,-21492.56 394.63,-21483.59 391.55,-21474.66"/>
<polygon fill="black" stroke="black" points="394.8,-21473.34 388.23,-21465.02 388.18,-21475.62 394.8,-21473.34"/>
</g>
<!-- layer4_expert_agg -->
<g id="node450" class="node">
<title>layer4_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="5929.05,-21332.83 5209.94,-21332.83 5024.95,-21196.83 5744.06,-21196.83 5929.05,-21332.83"/>
<text text-anchor="middle" x="5477" y="-21283.63" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5477" y="-21268.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x16)</text>
<text text-anchor="middle" x="5477" y="-21253.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-21238.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer4_gpu0_token_send&#45;&gt;layer4_expert_agg -->
<g id="edge434" class="edge">
<title>layer4_gpu0_token_send&#45;&gt;layer4_expert_agg</title>
<path fill="none" stroke="black" d="M610.99,-21381.3C652.59,-21376.33 695.49,-21371.88 736,-21368.83 1584.6,-21304.91 4154.44,-21277.06 5112.12,-21268.7"/>
<polygon fill="black" stroke="black" points="5112.29,-21272.2 5122.26,-21268.62 5112.23,-21265.2 5112.29,-21272.2"/>
</g>
<!-- layer4_gpu1_expert_mlp1 -->
<g id="node376" class="node">
<title>layer4_gpu1_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="1426.5,-21777 965.5,-21777 965.5,-21709 1426.5,-21709 1426.5,-21777"/>
<text text-anchor="middle" x="1196" y="-21761.8" font-family="Times,serif" font-size="14.00">Expert 1 MLP1</text>
<text text-anchor="middle" x="1196" y="-21746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1196" y="-21731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1196" y="-21716.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer4_gpu1_token_recv&#45;&gt;layer4_gpu1_expert_mlp1 -->
<g id="edge436" class="edge">
<title>layer4_gpu1_token_recv&#45;&gt;layer4_gpu1_expert_mlp1</title>
<path fill="none" stroke="black" d="M1201.93,-21812.86C1201.21,-21804.48 1200.46,-21795.78 1199.75,-21787.5"/>
<polygon fill="black" stroke="black" points="1203.21,-21786.96 1198.87,-21777.3 1196.24,-21787.56 1203.21,-21786.96"/>
</g>
<!-- layer4_gpu1_expert_act -->
<g id="node377" class="node">
<title>layer4_gpu1_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="1357.5,-21673 980.5,-21673 980.5,-21605 1357.5,-21605 1357.5,-21673"/>
<text text-anchor="middle" x="1169" y="-21657.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1169" y="-21642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1169" y="-21627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1169" y="-21612.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer4_gpu1_expert_mlp1&#45;&gt;layer4_gpu1_expert_act -->
<g id="edge437" class="edge">
<title>layer4_gpu1_expert_mlp1&#45;&gt;layer4_gpu1_expert_act</title>
<path fill="none" stroke="black" d="M1187.23,-21708.88C1185.06,-21700.69 1182.71,-21691.79 1180.43,-21683.19"/>
<polygon fill="black" stroke="black" points="1183.76,-21682.07 1177.81,-21673.3 1176.99,-21683.86 1183.76,-21682.07"/>
</g>
<!-- layer4_gpu1_expert_mlp2 -->
<g id="node378" class="node">
<title>layer4_gpu1_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="1345.5,-21569 938.5,-21569 938.5,-21501 1345.5,-21501 1345.5,-21569"/>
<text text-anchor="middle" x="1142" y="-21553.8" font-family="Times,serif" font-size="14.00">Expert 1 MLP2</text>
<text text-anchor="middle" x="1142" y="-21538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1142" y="-21523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1142" y="-21508.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer4_gpu1_expert_act&#45;&gt;layer4_gpu1_expert_mlp2 -->
<g id="edge438" class="edge">
<title>layer4_gpu1_expert_act&#45;&gt;layer4_gpu1_expert_mlp2</title>
<path fill="none" stroke="black" d="M1160.23,-21604.88C1158.06,-21596.69 1155.71,-21587.79 1153.43,-21579.19"/>
<polygon fill="black" stroke="black" points="1156.76,-21578.07 1150.81,-21569.3 1149.99,-21579.86 1156.76,-21578.07"/>
</g>
<!-- layer4_gpu1_token_send -->
<g id="node379" class="node">
<title>layer4_gpu1_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1101" cy="-21416.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1101" y="-21435.71" font-family="Times,serif" font-size="14.00">Token Send GPU1</text>
<text text-anchor="middle" x="1101" y="-21420.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1101" y="-21405.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1101" y="-21390.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer4_gpu1_expert_mlp2&#45;&gt;layer4_gpu1_token_send -->
<g id="edge439" class="edge">
<title>layer4_gpu1_expert_mlp2&#45;&gt;layer4_gpu1_token_send</title>
<path fill="none" stroke="black" d="M1130.25,-21500.73C1127.37,-21492.56 1124.2,-21483.59 1121.04,-21474.66"/>
<polygon fill="black" stroke="black" points="1124.27,-21473.29 1117.64,-21465.02 1117.67,-21475.62 1124.27,-21473.29"/>
</g>
<!-- layer4_gpu1_token_send&#45;&gt;layer4_expert_agg -->
<g id="edge440" class="edge">
<title>layer4_gpu1_token_send&#45;&gt;layer4_expert_agg</title>
<path fill="none" stroke="black" d="M1340.98,-21381.32C1382.27,-21376.38 1424.82,-21371.94 1465,-21368.83 2167.7,-21314.51 4265.31,-21281.72 5114.3,-21270.35"/>
<polygon fill="black" stroke="black" points="5114.59,-21273.85 5124.54,-21270.22 5114.49,-21266.85 5114.59,-21273.85"/>
</g>
<!-- layer4_gpu2_expert_mlp1 -->
<g id="node381" class="node">
<title>layer4_gpu2_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2123.5,-21777 1662.5,-21777 1662.5,-21709 2123.5,-21709 2123.5,-21777"/>
<text text-anchor="middle" x="1893" y="-21761.8" font-family="Times,serif" font-size="14.00">Expert 2 MLP1</text>
<text text-anchor="middle" x="1893" y="-21746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1893" y="-21731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1893" y="-21716.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer4_gpu2_token_recv&#45;&gt;layer4_gpu2_expert_mlp1 -->
<g id="edge442" class="edge">
<title>layer4_gpu2_token_recv&#45;&gt;layer4_gpu2_expert_mlp1</title>
<path fill="none" stroke="black" d="M1905.46,-21812.86C1903.92,-21804.39 1902.33,-21795.59 1900.82,-21787.23"/>
<polygon fill="black" stroke="black" points="1904.25,-21786.52 1899.02,-21777.3 1897.36,-21787.76 1904.25,-21786.52"/>
</g>
<!-- layer4_gpu2_expert_act -->
<g id="node382" class="node">
<title>layer4_gpu2_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2049.5,-21673 1672.5,-21673 1672.5,-21605 2049.5,-21605 2049.5,-21673"/>
<text text-anchor="middle" x="1861" y="-21657.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="1861" y="-21642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1861" y="-21627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1861" y="-21612.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer4_gpu2_expert_mlp1&#45;&gt;layer4_gpu2_expert_act -->
<g id="edge443" class="edge">
<title>layer4_gpu2_expert_mlp1&#45;&gt;layer4_gpu2_expert_act</title>
<path fill="none" stroke="black" d="M1882.61,-21708.88C1880.01,-21700.6 1877.19,-21691.59 1874.46,-21682.91"/>
<polygon fill="black" stroke="black" points="1877.78,-21681.79 1871.45,-21673.3 1871.1,-21683.89 1877.78,-21681.79"/>
</g>
<!-- layer4_gpu2_expert_mlp2 -->
<g id="node383" class="node">
<title>layer4_gpu2_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2052.5,-21569 1645.5,-21569 1645.5,-21501 2052.5,-21501 2052.5,-21569"/>
<text text-anchor="middle" x="1849" y="-21553.8" font-family="Times,serif" font-size="14.00">Expert 2 MLP2</text>
<text text-anchor="middle" x="1849" y="-21538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1849" y="-21523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1849" y="-21508.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer4_gpu2_expert_act&#45;&gt;layer4_gpu2_expert_mlp2 -->
<g id="edge444" class="edge">
<title>layer4_gpu2_expert_act&#45;&gt;layer4_gpu2_expert_mlp2</title>
<path fill="none" stroke="black" d="M1857.1,-21604.88C1856.15,-21596.77 1855.12,-21587.98 1854.11,-21579.47"/>
<polygon fill="black" stroke="black" points="1857.56,-21578.82 1852.92,-21569.3 1850.61,-21579.64 1857.56,-21578.82"/>
</g>
<!-- layer4_gpu2_token_send -->
<g id="node384" class="node">
<title>layer4_gpu2_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1830" cy="-21416.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1830" y="-21435.71" font-family="Times,serif" font-size="14.00">Token Send GPU2</text>
<text text-anchor="middle" x="1830" y="-21420.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1830" y="-21405.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1830" y="-21390.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer4_gpu2_expert_mlp2&#45;&gt;layer4_gpu2_token_send -->
<g id="edge445" class="edge">
<title>layer4_gpu2_expert_mlp2&#45;&gt;layer4_gpu2_token_send</title>
<path fill="none" stroke="black" d="M1843.56,-21500.73C1842.23,-21492.65 1840.78,-21483.78 1839.33,-21474.94"/>
<polygon fill="black" stroke="black" points="1842.78,-21474.33 1837.71,-21465.02 1835.87,-21475.46 1842.78,-21474.33"/>
</g>
<!-- layer4_gpu2_token_send&#45;&gt;layer4_expert_agg -->
<g id="edge446" class="edge">
<title>layer4_gpu2_token_send&#45;&gt;layer4_expert_agg</title>
<path fill="none" stroke="black" d="M2070.48,-21381.45C2111.62,-21376.52 2153.98,-21372.04 2194,-21368.83 3249.04,-21284.25 4499.98,-21268.17 5108.15,-21265.72"/>
<polygon fill="black" stroke="black" points="5108.41,-21269.22 5118.39,-21265.68 5108.38,-21262.22 5108.41,-21269.22"/>
</g>
<!-- layer4_gpu3_expert_mlp1 -->
<g id="node386" class="node">
<title>layer4_gpu3_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2814.5,-21777 2353.5,-21777 2353.5,-21709 2814.5,-21709 2814.5,-21777"/>
<text text-anchor="middle" x="2584" y="-21761.8" font-family="Times,serif" font-size="14.00">Expert 3 MLP1</text>
<text text-anchor="middle" x="2584" y="-21746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2584" y="-21731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2584" y="-21716.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer4_gpu3_token_recv&#45;&gt;layer4_gpu3_expert_mlp1 -->
<g id="edge448" class="edge">
<title>layer4_gpu3_token_recv&#45;&gt;layer4_gpu3_expert_mlp1</title>
<path fill="none" stroke="black" d="M2601.2,-21812.86C2599.09,-21804.39 2596.89,-21795.59 2594.8,-21787.23"/>
<polygon fill="black" stroke="black" points="2598.14,-21786.15 2592.32,-21777.3 2591.35,-21787.85 2598.14,-21786.15"/>
</g>
<!-- layer4_gpu3_expert_act -->
<g id="node387" class="node">
<title>layer4_gpu3_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2758.5,-21673 2381.5,-21673 2381.5,-21605 2758.5,-21605 2758.5,-21673"/>
<text text-anchor="middle" x="2570" y="-21657.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="2570" y="-21642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2570" y="-21627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2570" y="-21612.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer4_gpu3_expert_mlp1&#45;&gt;layer4_gpu3_expert_act -->
<g id="edge449" class="edge">
<title>layer4_gpu3_expert_mlp1&#45;&gt;layer4_gpu3_expert_act</title>
<path fill="none" stroke="black" d="M2579.45,-21708.88C2578.34,-21700.77 2577.13,-21691.98 2575.97,-21683.47"/>
<polygon fill="black" stroke="black" points="2579.4,-21682.73 2574.57,-21673.3 2572.46,-21683.68 2579.4,-21682.73"/>
</g>
<!-- layer4_gpu3_expert_mlp2 -->
<g id="node388" class="node">
<title>layer4_gpu3_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2769.5,-21569 2362.5,-21569 2362.5,-21501 2769.5,-21501 2769.5,-21569"/>
<text text-anchor="middle" x="2566" y="-21553.8" font-family="Times,serif" font-size="14.00">Expert 3 MLP2</text>
<text text-anchor="middle" x="2566" y="-21538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2566" y="-21523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="2566" y="-21508.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer4_gpu3_expert_act&#45;&gt;layer4_gpu3_expert_mlp2 -->
<g id="edge450" class="edge">
<title>layer4_gpu3_expert_act&#45;&gt;layer4_gpu3_expert_mlp2</title>
<path fill="none" stroke="black" d="M2568.7,-21604.88C2568.38,-21596.77 2568.04,-21587.98 2567.7,-21579.47"/>
<polygon fill="black" stroke="black" points="2571.2,-21579.15 2567.31,-21569.3 2564.2,-21579.43 2571.2,-21579.15"/>
</g>
<!-- layer4_gpu3_token_send -->
<g id="node389" class="node">
<title>layer4_gpu3_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="2559" cy="-21416.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="2559" y="-21435.71" font-family="Times,serif" font-size="14.00">Token Send GPU3</text>
<text text-anchor="middle" x="2559" y="-21420.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="2559" y="-21405.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="2559" y="-21390.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer4_gpu3_expert_mlp2&#45;&gt;layer4_gpu3_token_send -->
<g id="edge451" class="edge">
<title>layer4_gpu3_expert_mlp2&#45;&gt;layer4_gpu3_token_send</title>
<path fill="none" stroke="black" d="M2563.99,-21500.73C2563.51,-21492.74 2562.98,-21483.97 2562.46,-21475.23"/>
<polygon fill="black" stroke="black" points="2565.94,-21474.79 2561.84,-21465.02 2558.95,-21475.22 2565.94,-21474.79"/>
</g>
<!-- layer4_gpu3_token_send&#45;&gt;layer4_expert_agg -->
<g id="edge452" class="edge">
<title>layer4_gpu3_token_send&#45;&gt;layer4_expert_agg</title>
<path fill="none" stroke="black" d="M2800.98,-21381.58C2841.65,-21376.68 2883.48,-21372.18 2923,-21368.83 3702.23,-21302.85 4618.9,-21278.9 5114.54,-21270.38"/>
<polygon fill="black" stroke="black" points="5114.77,-21273.88 5124.71,-21270.21 5114.65,-21266.88 5114.77,-21273.88"/>
</g>
<!-- layer4_gpu4_expert_mlp1 -->
<g id="node391" class="node">
<title>layer4_gpu4_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="3528.5,-21777 3067.5,-21777 3067.5,-21709 3528.5,-21709 3528.5,-21777"/>
<text text-anchor="middle" x="3298" y="-21761.8" font-family="Times,serif" font-size="14.00">Expert 4 MLP1</text>
<text text-anchor="middle" x="3298" y="-21746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3298" y="-21731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3298" y="-21716.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_gpu4_token_recv&#45;&gt;layer4_gpu4_expert_mlp1 -->
<g id="edge454" class="edge">
<title>layer4_gpu4_token_recv&#45;&gt;layer4_gpu4_expert_mlp1</title>
<path fill="none" stroke="black" d="M3302.75,-21812.86C3302.17,-21804.48 3301.57,-21795.78 3301,-21787.5"/>
<polygon fill="black" stroke="black" points="3304.47,-21787.04 3300.3,-21777.3 3297.49,-21787.52 3304.47,-21787.04"/>
</g>
<!-- layer4_gpu4_expert_act -->
<g id="node392" class="node">
<title>layer4_gpu4_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="3482.5,-21673 3105.5,-21673 3105.5,-21605 3482.5,-21605 3482.5,-21673"/>
<text text-anchor="middle" x="3294" y="-21657.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="3294" y="-21642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3294" y="-21627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3294" y="-21612.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_gpu4_expert_mlp1&#45;&gt;layer4_gpu4_expert_act -->
<g id="edge455" class="edge">
<title>layer4_gpu4_expert_mlp1&#45;&gt;layer4_gpu4_expert_act</title>
<path fill="none" stroke="black" d="M3296.7,-21708.88C3296.38,-21700.77 3296.04,-21691.98 3295.7,-21683.47"/>
<polygon fill="black" stroke="black" points="3299.2,-21683.15 3295.31,-21673.3 3292.2,-21683.43 3299.2,-21683.15"/>
</g>
<!-- layer4_gpu4_expert_mlp2 -->
<g id="node393" class="node">
<title>layer4_gpu4_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="3495.5,-21569 3088.5,-21569 3088.5,-21501 3495.5,-21501 3495.5,-21569"/>
<text text-anchor="middle" x="3292" y="-21553.8" font-family="Times,serif" font-size="14.00">Expert 4 MLP2</text>
<text text-anchor="middle" x="3292" y="-21538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3292" y="-21523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="3292" y="-21508.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_gpu4_expert_act&#45;&gt;layer4_gpu4_expert_mlp2 -->
<g id="edge456" class="edge">
<title>layer4_gpu4_expert_act&#45;&gt;layer4_gpu4_expert_mlp2</title>
<path fill="none" stroke="black" d="M3293.35,-21604.88C3293.19,-21596.77 3293.02,-21587.98 3292.85,-21579.47"/>
<polygon fill="black" stroke="black" points="3296.35,-21579.23 3292.65,-21569.3 3289.35,-21579.36 3296.35,-21579.23"/>
</g>
<!-- layer4_gpu4_token_send -->
<g id="node394" class="node">
<title>layer4_gpu4_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="3288" cy="-21416.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="3288" y="-21435.71" font-family="Times,serif" font-size="14.00">Token Send GPU4</text>
<text text-anchor="middle" x="3288" y="-21420.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="3288" y="-21405.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="3288" y="-21390.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_gpu4_expert_mlp2&#45;&gt;layer4_gpu4_token_send -->
<g id="edge457" class="edge">
<title>layer4_gpu4_expert_mlp2&#45;&gt;layer4_gpu4_token_send</title>
<path fill="none" stroke="black" d="M3290.85,-21500.73C3290.58,-21492.74 3290.28,-21483.97 3289.97,-21475.23"/>
<polygon fill="black" stroke="black" points="3293.47,-21474.9 3289.62,-21465.02 3286.47,-21475.14 3293.47,-21474.9"/>
</g>
<!-- layer4_gpu4_token_send&#45;&gt;layer4_expert_agg -->
<g id="edge458" class="edge">
<title>layer4_gpu4_token_send&#45;&gt;layer4_expert_agg</title>
<path fill="none" stroke="black" d="M3531.99,-21381.89C3572.03,-21377.01 3613.14,-21372.44 3652,-21368.83 4162.99,-21321.42 4756.65,-21292.81 5124.62,-21278.16"/>
<polygon fill="black" stroke="black" points="5124.78,-21281.66 5134.63,-21277.77 5124.5,-21274.66 5124.78,-21281.66"/>
</g>
<!-- layer4_gpu5_expert_mlp1 -->
<g id="node396" class="node">
<title>layer4_gpu5_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4277.5,-21777 3816.5,-21777 3816.5,-21709 4277.5,-21709 4277.5,-21777"/>
<text text-anchor="middle" x="4047" y="-21761.8" font-family="Times,serif" font-size="14.00">Expert 5 MLP1</text>
<text text-anchor="middle" x="4047" y="-21746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4047" y="-21731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4047" y="-21716.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer4_gpu5_token_recv&#45;&gt;layer4_gpu5_expert_mlp1 -->
<g id="edge460" class="edge">
<title>layer4_gpu5_token_recv&#45;&gt;layer4_gpu5_expert_mlp1</title>
<path fill="none" stroke="black" d="M4052.34,-21812.86C4051.69,-21804.48 4051.01,-21795.78 4050.37,-21787.5"/>
<polygon fill="black" stroke="black" points="4053.84,-21787 4049.58,-21777.3 4046.87,-21787.54 4053.84,-21787"/>
</g>
<!-- layer4_gpu5_expert_act -->
<g id="node397" class="node">
<title>layer4_gpu5_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4217.5,-21673 3840.5,-21673 3840.5,-21605 4217.5,-21605 4217.5,-21673"/>
<text text-anchor="middle" x="4029" y="-21657.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="4029" y="-21642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4029" y="-21627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4029" y="-21612.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer4_gpu5_expert_mlp1&#45;&gt;layer4_gpu5_expert_act -->
<g id="edge461" class="edge">
<title>layer4_gpu5_expert_mlp1&#45;&gt;layer4_gpu5_expert_act</title>
<path fill="none" stroke="black" d="M4041.16,-21708.88C4039.71,-21700.69 4038.14,-21691.79 4036.62,-21683.19"/>
<polygon fill="black" stroke="black" points="4040.06,-21682.54 4034.88,-21673.3 4033.17,-21683.75 4040.06,-21682.54"/>
</g>
<!-- layer4_gpu5_expert_mlp2 -->
<g id="node398" class="node">
<title>layer4_gpu5_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4227.5,-21569 3820.5,-21569 3820.5,-21501 4227.5,-21501 4227.5,-21569"/>
<text text-anchor="middle" x="4024" y="-21553.8" font-family="Times,serif" font-size="14.00">Expert 5 MLP2</text>
<text text-anchor="middle" x="4024" y="-21538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4024" y="-21523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4024" y="-21508.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer4_gpu5_expert_act&#45;&gt;layer4_gpu5_expert_mlp2 -->
<g id="edge462" class="edge">
<title>layer4_gpu5_expert_act&#45;&gt;layer4_gpu5_expert_mlp2</title>
<path fill="none" stroke="black" d="M4027.38,-21604.88C4026.98,-21596.77 4026.55,-21587.98 4026.13,-21579.47"/>
<polygon fill="black" stroke="black" points="4029.62,-21579.11 4025.63,-21569.3 4022.63,-21579.46 4029.62,-21579.11"/>
</g>
<!-- layer4_gpu5_token_send -->
<g id="node399" class="node">
<title>layer4_gpu5_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4017" cy="-21416.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4017" y="-21435.71" font-family="Times,serif" font-size="14.00">Token Send GPU5</text>
<text text-anchor="middle" x="4017" y="-21420.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4017" y="-21405.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4017" y="-21390.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer4_gpu5_expert_mlp2&#45;&gt;layer4_gpu5_token_send -->
<g id="edge463" class="edge">
<title>layer4_gpu5_expert_mlp2&#45;&gt;layer4_gpu5_token_send</title>
<path fill="none" stroke="black" d="M4021.99,-21500.73C4021.51,-21492.74 4020.98,-21483.97 4020.46,-21475.23"/>
<polygon fill="black" stroke="black" points="4023.94,-21474.79 4019.84,-21465.02 4016.95,-21475.22 4023.94,-21474.79"/>
</g>
<!-- layer4_gpu5_token_send&#45;&gt;layer4_expert_agg -->
<g id="edge464" class="edge">
<title>layer4_gpu5_token_send&#45;&gt;layer4_expert_agg</title>
<path fill="none" stroke="black" d="M4266.02,-21382.53C4304.5,-21377.71 4343.8,-21372.98 4381,-21368.83 4637.39,-21340.21 4928.13,-21313.13 5145.7,-21293.93"/>
<polygon fill="black" stroke="black" points="5146.03,-21297.42 5155.68,-21293.05 5145.41,-21290.44 5146.03,-21297.42"/>
</g>
<!-- layer4_gpu6_expert_mlp1 -->
<g id="node401" class="node">
<title>layer4_gpu6_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5001.5,-21777 4540.5,-21777 4540.5,-21709 5001.5,-21709 5001.5,-21777"/>
<text text-anchor="middle" x="4771" y="-21761.8" font-family="Times,serif" font-size="14.00">Expert 6 MLP1</text>
<text text-anchor="middle" x="4771" y="-21746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4771" y="-21731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4771" y="-21716.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer4_gpu6_token_recv&#45;&gt;layer4_gpu6_expert_mlp1 -->
<g id="edge466" class="edge">
<title>layer4_gpu6_token_recv&#45;&gt;layer4_gpu6_expert_mlp1</title>
<path fill="none" stroke="black" d="M4772.78,-21812.86C4772.56,-21804.48 4772.34,-21795.78 4772.12,-21787.5"/>
<polygon fill="black" stroke="black" points="4775.62,-21787.21 4771.86,-21777.3 4768.62,-21787.39 4775.62,-21787.21"/>
</g>
<!-- layer4_gpu6_expert_act -->
<g id="node402" class="node">
<title>layer4_gpu6_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4946.5,-21673 4569.5,-21673 4569.5,-21605 4946.5,-21605 4946.5,-21673"/>
<text text-anchor="middle" x="4758" y="-21657.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="4758" y="-21642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4758" y="-21627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4758" y="-21612.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer4_gpu6_expert_mlp1&#45;&gt;layer4_gpu6_expert_act -->
<g id="edge467" class="edge">
<title>layer4_gpu6_expert_mlp1&#45;&gt;layer4_gpu6_expert_act</title>
<path fill="none" stroke="black" d="M4766.78,-21708.88C4765.75,-21700.77 4764.63,-21691.98 4763.54,-21683.47"/>
<polygon fill="black" stroke="black" points="4766.98,-21682.77 4762.24,-21673.3 4760.04,-21683.66 4766.98,-21682.77"/>
</g>
<!-- layer4_gpu6_expert_mlp2 -->
<g id="node403" class="node">
<title>layer4_gpu6_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4955.5,-21569 4548.5,-21569 4548.5,-21501 4955.5,-21501 4955.5,-21569"/>
<text text-anchor="middle" x="4752" y="-21553.8" font-family="Times,serif" font-size="14.00">Expert 6 MLP2</text>
<text text-anchor="middle" x="4752" y="-21538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4752" y="-21523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4752" y="-21508.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer4_gpu6_expert_act&#45;&gt;layer4_gpu6_expert_mlp2 -->
<g id="edge468" class="edge">
<title>layer4_gpu6_expert_act&#45;&gt;layer4_gpu6_expert_mlp2</title>
<path fill="none" stroke="black" d="M4756.05,-21604.88C4755.58,-21596.77 4755.06,-21587.98 4754.56,-21579.47"/>
<polygon fill="black" stroke="black" points="4758.04,-21579.07 4753.96,-21569.3 4751.05,-21579.48 4758.04,-21579.07"/>
</g>
<!-- layer4_gpu6_token_send -->
<g id="node404" class="node">
<title>layer4_gpu6_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4746" cy="-21416.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4746" y="-21435.71" font-family="Times,serif" font-size="14.00">Token Send GPU6</text>
<text text-anchor="middle" x="4746" y="-21420.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4746" y="-21405.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4746" y="-21390.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer4_gpu6_expert_mlp2&#45;&gt;layer4_gpu6_token_send -->
<g id="edge469" class="edge">
<title>layer4_gpu6_expert_mlp2&#45;&gt;layer4_gpu6_token_send</title>
<path fill="none" stroke="black" d="M4750.28,-21500.73C4749.87,-21492.74 4749.41,-21483.97 4748.96,-21475.23"/>
<polygon fill="black" stroke="black" points="4752.45,-21474.83 4748.43,-21465.02 4745.46,-21475.19 4752.45,-21474.83"/>
</g>
<!-- layer4_gpu6_token_send&#45;&gt;layer4_expert_agg -->
<g id="edge470" class="edge">
<title>layer4_gpu6_token_send&#45;&gt;layer4_expert_agg</title>
<path fill="none" stroke="black" d="M4938.54,-21376.38C5014.53,-21360.78 5103.48,-21342.52 5186.94,-21325.38"/>
<polygon fill="black" stroke="black" points="5187.74,-21328.79 5196.83,-21323.35 5186.33,-21321.94 5187.74,-21328.79"/>
</g>
<!-- layer4_gpu7_expert_mlp1 -->
<g id="node406" class="node">
<title>layer4_gpu7_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5707.5,-21777 5246.5,-21777 5246.5,-21709 5707.5,-21709 5707.5,-21777"/>
<text text-anchor="middle" x="5477" y="-21761.8" font-family="Times,serif" font-size="14.00">Expert 7 MLP1</text>
<text text-anchor="middle" x="5477" y="-21746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5477" y="-21731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5477" y="-21716.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer4_gpu7_token_recv&#45;&gt;layer4_gpu7_expert_mlp1 -->
<g id="edge472" class="edge">
<title>layer4_gpu7_token_recv&#45;&gt;layer4_gpu7_expert_mlp1</title>
<path fill="none" stroke="black" d="M5477,-21812.86C5477,-21804.48 5477,-21795.78 5477,-21787.5"/>
<polygon fill="black" stroke="black" points="5480.5,-21787.3 5477,-21777.3 5473.5,-21787.3 5480.5,-21787.3"/>
</g>
<!-- layer4_gpu7_expert_act -->
<g id="node407" class="node">
<title>layer4_gpu7_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="5665.5,-21673 5288.5,-21673 5288.5,-21605 5665.5,-21605 5665.5,-21673"/>
<text text-anchor="middle" x="5477" y="-21657.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="5477" y="-21642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5477" y="-21627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5477" y="-21612.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer4_gpu7_expert_mlp1&#45;&gt;layer4_gpu7_expert_act -->
<g id="edge473" class="edge">
<title>layer4_gpu7_expert_mlp1&#45;&gt;layer4_gpu7_expert_act</title>
<path fill="none" stroke="black" d="M5477,-21708.88C5477,-21700.77 5477,-21691.98 5477,-21683.47"/>
<polygon fill="black" stroke="black" points="5480.5,-21683.3 5477,-21673.3 5473.5,-21683.3 5480.5,-21683.3"/>
</g>
<!-- layer4_gpu7_expert_mlp2 -->
<g id="node408" class="node">
<title>layer4_gpu7_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="5680.5,-21569 5273.5,-21569 5273.5,-21501 5680.5,-21501 5680.5,-21569"/>
<text text-anchor="middle" x="5477" y="-21553.8" font-family="Times,serif" font-size="14.00">Expert 7 MLP2</text>
<text text-anchor="middle" x="5477" y="-21538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5477" y="-21523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-21508.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer4_gpu7_expert_act&#45;&gt;layer4_gpu7_expert_mlp2 -->
<g id="edge474" class="edge">
<title>layer4_gpu7_expert_act&#45;&gt;layer4_gpu7_expert_mlp2</title>
<path fill="none" stroke="black" d="M5477,-21604.88C5477,-21596.77 5477,-21587.98 5477,-21579.47"/>
<polygon fill="black" stroke="black" points="5480.5,-21579.3 5477,-21569.3 5473.5,-21579.3 5480.5,-21579.3"/>
</g>
<!-- layer4_gpu7_token_send -->
<g id="node409" class="node">
<title>layer4_gpu7_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="5475" cy="-21416.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="5475" y="-21435.71" font-family="Times,serif" font-size="14.00">Token Send GPU7</text>
<text text-anchor="middle" x="5475" y="-21420.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="5475" y="-21405.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="5475" y="-21390.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer4_gpu7_expert_mlp2&#45;&gt;layer4_gpu7_token_send -->
<g id="edge475" class="edge">
<title>layer4_gpu7_expert_mlp2&#45;&gt;layer4_gpu7_token_send</title>
<path fill="none" stroke="black" d="M5476.43,-21500.73C5476.29,-21492.74 5476.14,-21483.97 5475.99,-21475.23"/>
<polygon fill="black" stroke="black" points="5479.48,-21474.96 5475.81,-21465.02 5472.48,-21475.08 5479.48,-21474.96"/>
</g>
<!-- layer4_gpu7_token_send&#45;&gt;layer4_expert_agg -->
<g id="edge476" class="edge">
<title>layer4_gpu7_token_send&#45;&gt;layer4_expert_agg</title>
<path fill="none" stroke="black" d="M5475.63,-21368.43C5475.74,-21360.34 5475.85,-21351.76 5475.97,-21343.14"/>
<polygon fill="black" stroke="black" points="5479.47,-21343.07 5476.1,-21333.02 5472.47,-21342.98 5479.47,-21343.07"/>
</g>
<!-- layer4_gpu8_expert_mlp1 -->
<g id="node411" class="node">
<title>layer4_gpu8_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="6400.5,-21777 5939.5,-21777 5939.5,-21709 6400.5,-21709 6400.5,-21777"/>
<text text-anchor="middle" x="6170" y="-21761.8" font-family="Times,serif" font-size="14.00">Expert 8 MLP1</text>
<text text-anchor="middle" x="6170" y="-21746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6170" y="-21731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6170" y="-21716.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer4_gpu8_token_recv&#45;&gt;layer4_gpu8_expert_mlp1 -->
<g id="edge478" class="edge">
<title>layer4_gpu8_token_recv&#45;&gt;layer4_gpu8_expert_mlp1</title>
<path fill="none" stroke="black" d="M6167.03,-21812.86C6167.39,-21804.48 6167.77,-21795.78 6168.13,-21787.5"/>
<polygon fill="black" stroke="black" points="6171.63,-21787.44 6168.57,-21777.3 6164.64,-21787.14 6171.63,-21787.44"/>
</g>
<!-- layer4_gpu8_expert_act -->
<g id="node412" class="node">
<title>layer4_gpu8_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="6368.5,-21673 5991.5,-21673 5991.5,-21605 6368.5,-21605 6368.5,-21673"/>
<text text-anchor="middle" x="6180" y="-21657.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="6180" y="-21642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6180" y="-21627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6180" y="-21612.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer4_gpu8_expert_mlp1&#45;&gt;layer4_gpu8_expert_act -->
<g id="edge479" class="edge">
<title>layer4_gpu8_expert_mlp1&#45;&gt;layer4_gpu8_expert_act</title>
<path fill="none" stroke="black" d="M6173.25,-21708.88C6174.04,-21700.77 6174.9,-21691.98 6175.74,-21683.47"/>
<polygon fill="black" stroke="black" points="6179.24,-21683.59 6176.74,-21673.3 6172.28,-21682.91 6179.24,-21683.59"/>
</g>
<!-- layer4_gpu8_expert_mlp2 -->
<g id="node413" class="node">
<title>layer4_gpu8_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="6387.5,-21569 5980.5,-21569 5980.5,-21501 6387.5,-21501 6387.5,-21569"/>
<text text-anchor="middle" x="6184" y="-21553.8" font-family="Times,serif" font-size="14.00">Expert 8 MLP2</text>
<text text-anchor="middle" x="6184" y="-21538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6184" y="-21523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6184" y="-21508.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer4_gpu8_expert_act&#45;&gt;layer4_gpu8_expert_mlp2 -->
<g id="edge480" class="edge">
<title>layer4_gpu8_expert_act&#45;&gt;layer4_gpu8_expert_mlp2</title>
<path fill="none" stroke="black" d="M6181.3,-21604.88C6181.62,-21596.77 6181.96,-21587.98 6182.3,-21579.47"/>
<polygon fill="black" stroke="black" points="6185.8,-21579.43 6182.69,-21569.3 6178.8,-21579.15 6185.8,-21579.43"/>
</g>
<!-- layer4_gpu8_token_send -->
<g id="node414" class="node">
<title>layer4_gpu8_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6204" cy="-21416.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6204" y="-21435.71" font-family="Times,serif" font-size="14.00">Token Send GPU8</text>
<text text-anchor="middle" x="6204" y="-21420.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6204" y="-21405.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6204" y="-21390.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer4_gpu8_expert_mlp2&#45;&gt;layer4_gpu8_token_send -->
<g id="edge481" class="edge">
<title>layer4_gpu8_expert_mlp2&#45;&gt;layer4_gpu8_token_send</title>
<path fill="none" stroke="black" d="M6189.73,-21500.73C6191.12,-21492.65 6192.65,-21483.78 6194.17,-21474.94"/>
<polygon fill="black" stroke="black" points="6197.63,-21475.47 6195.88,-21465.02 6190.74,-21474.28 6197.63,-21475.47"/>
</g>
<!-- layer4_gpu8_token_send&#45;&gt;layer4_expert_agg -->
<g id="edge482" class="edge">
<title>layer4_gpu8_token_send&#45;&gt;layer4_expert_agg</title>
<path fill="none" stroke="black" d="M6012.51,-21376.38C5950.86,-21363.66 5880.64,-21349.16 5811.79,-21334.94"/>
<polygon fill="black" stroke="black" points="5812.14,-21331.44 5801.64,-21332.85 5810.73,-21338.3 5812.14,-21331.44"/>
</g>
<!-- layer4_gpu9_expert_mlp1 -->
<g id="node416" class="node">
<title>layer4_gpu9_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7091.5,-21777 6630.5,-21777 6630.5,-21709 7091.5,-21709 7091.5,-21777"/>
<text text-anchor="middle" x="6861" y="-21761.8" font-family="Times,serif" font-size="14.00">Expert 9 MLP1</text>
<text text-anchor="middle" x="6861" y="-21746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6861" y="-21731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6861" y="-21716.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer4_gpu9_token_recv&#45;&gt;layer4_gpu9_expert_mlp1 -->
<g id="edge484" class="edge">
<title>layer4_gpu9_token_recv&#45;&gt;layer4_gpu9_expert_mlp1</title>
<path fill="none" stroke="black" d="M6855.66,-21812.86C6856.31,-21804.48 6856.99,-21795.78 6857.63,-21787.5"/>
<polygon fill="black" stroke="black" points="6861.13,-21787.54 6858.42,-21777.3 6854.16,-21787 6861.13,-21787.54"/>
</g>
<!-- layer4_gpu9_expert_act -->
<g id="node417" class="node">
<title>layer4_gpu9_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7059.5,-21673 6682.5,-21673 6682.5,-21605 7059.5,-21605 7059.5,-21673"/>
<text text-anchor="middle" x="6871" y="-21657.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="6871" y="-21642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6871" y="-21627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6871" y="-21612.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer4_gpu9_expert_mlp1&#45;&gt;layer4_gpu9_expert_act -->
<g id="edge485" class="edge">
<title>layer4_gpu9_expert_mlp1&#45;&gt;layer4_gpu9_expert_act</title>
<path fill="none" stroke="black" d="M6864.25,-21708.88C6865.04,-21700.77 6865.9,-21691.98 6866.74,-21683.47"/>
<polygon fill="black" stroke="black" points="6870.24,-21683.59 6867.74,-21673.3 6863.28,-21682.91 6870.24,-21683.59"/>
</g>
<!-- layer4_gpu9_expert_mlp2 -->
<g id="node418" class="node">
<title>layer4_gpu9_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7094.5,-21569 6687.5,-21569 6687.5,-21501 7094.5,-21501 7094.5,-21569"/>
<text text-anchor="middle" x="6891" y="-21553.8" font-family="Times,serif" font-size="14.00">Expert 9 MLP2</text>
<text text-anchor="middle" x="6891" y="-21538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6891" y="-21523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6891" y="-21508.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer4_gpu9_expert_act&#45;&gt;layer4_gpu9_expert_mlp2 -->
<g id="edge486" class="edge">
<title>layer4_gpu9_expert_act&#45;&gt;layer4_gpu9_expert_mlp2</title>
<path fill="none" stroke="black" d="M6877.49,-21604.88C6879.1,-21596.69 6880.85,-21587.79 6882.53,-21579.19"/>
<polygon fill="black" stroke="black" points="6885.98,-21579.78 6884.47,-21569.3 6879.11,-21578.44 6885.98,-21579.78"/>
</g>
<!-- layer4_gpu9_token_send -->
<g id="node419" class="node">
<title>layer4_gpu9_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6933" cy="-21416.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6933" y="-21435.71" font-family="Times,serif" font-size="14.00">Token Send GPU9</text>
<text text-anchor="middle" x="6933" y="-21420.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6933" y="-21405.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6933" y="-21390.71" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer4_gpu9_expert_mlp2&#45;&gt;layer4_gpu9_token_send -->
<g id="edge487" class="edge">
<title>layer4_gpu9_expert_mlp2&#45;&gt;layer4_gpu9_token_send</title>
<path fill="none" stroke="black" d="M6903.04,-21500.73C6905.99,-21492.56 6909.24,-21483.59 6912.47,-21474.66"/>
<polygon fill="black" stroke="black" points="6915.84,-21475.62 6915.96,-21465.02 6909.26,-21473.24 6915.84,-21475.62"/>
</g>
<!-- layer4_gpu9_token_send&#45;&gt;layer4_expert_agg -->
<g id="edge488" class="edge">
<title>layer4_gpu9_token_send&#45;&gt;layer4_expert_agg</title>
<path fill="none" stroke="black" d="M6683.98,-21382.54C6645.5,-21377.72 6606.2,-21372.99 6569,-21368.83 6347.19,-21344.03 6099.58,-21320.35 5896.29,-21301.96"/>
<polygon fill="black" stroke="black" points="5896.31,-21298.45 5886.03,-21301.03 5895.68,-21305.42 5896.31,-21298.45"/>
</g>
<!-- layer4_gpu10_expert_mlp1 -->
<g id="node421" class="node">
<title>layer4_gpu10_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7784.5,-21777 7323.5,-21777 7323.5,-21709 7784.5,-21709 7784.5,-21777"/>
<text text-anchor="middle" x="7554" y="-21761.8" font-family="Times,serif" font-size="14.00">Expert 10 MLP1</text>
<text text-anchor="middle" x="7554" y="-21746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7554" y="-21731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7554" y="-21716.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer4_gpu10_token_recv&#45;&gt;layer4_gpu10_expert_mlp1 -->
<g id="edge490" class="edge">
<title>layer4_gpu10_token_recv&#45;&gt;layer4_gpu10_expert_mlp1</title>
<path fill="none" stroke="black" d="M7545.1,-21812.86C7546.2,-21804.39 7547.33,-21795.59 7548.41,-21787.23"/>
<polygon fill="black" stroke="black" points="7551.89,-21787.67 7549.7,-21777.3 7544.94,-21786.77 7551.89,-21787.67"/>
</g>
<!-- layer4_gpu10_expert_act -->
<g id="node422" class="node">
<title>layer4_gpu10_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7773.5,-21673 7396.5,-21673 7396.5,-21605 7773.5,-21605 7773.5,-21673"/>
<text text-anchor="middle" x="7585" y="-21657.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="7585" y="-21642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7585" y="-21627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7585" y="-21612.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer4_gpu10_expert_mlp1&#45;&gt;layer4_gpu10_expert_act -->
<g id="edge491" class="edge">
<title>layer4_gpu10_expert_mlp1&#45;&gt;layer4_gpu10_expert_act</title>
<path fill="none" stroke="black" d="M7564.06,-21708.88C7566.58,-21700.6 7569.32,-21691.59 7571.96,-21682.91"/>
<polygon fill="black" stroke="black" points="7575.32,-21683.88 7574.88,-21673.3 7568.62,-21681.85 7575.32,-21683.88"/>
</g>
<!-- layer4_gpu10_expert_mlp2 -->
<g id="node423" class="node">
<title>layer4_gpu10_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7802.5,-21569 7395.5,-21569 7395.5,-21501 7802.5,-21501 7802.5,-21569"/>
<text text-anchor="middle" x="7599" y="-21553.8" font-family="Times,serif" font-size="14.00">Expert 10 MLP2</text>
<text text-anchor="middle" x="7599" y="-21538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7599" y="-21523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="7599" y="-21508.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer4_gpu10_expert_act&#45;&gt;layer4_gpu10_expert_mlp2 -->
<g id="edge492" class="edge">
<title>layer4_gpu10_expert_act&#45;&gt;layer4_gpu10_expert_mlp2</title>
<path fill="none" stroke="black" d="M7589.55,-21604.88C7590.66,-21596.77 7591.87,-21587.98 7593.03,-21579.47"/>
<polygon fill="black" stroke="black" points="7596.54,-21579.68 7594.43,-21569.3 7589.6,-21578.73 7596.54,-21579.68"/>
</g>
<!-- layer4_gpu10_token_send -->
<g id="node424" class="node">
<title>layer4_gpu10_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="7662" cy="-21416.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="7662" y="-21435.71" font-family="Times,serif" font-size="14.00">Token Send GPU10</text>
<text text-anchor="middle" x="7662" y="-21420.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="7662" y="-21405.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="7662" y="-21390.71" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer4_gpu10_expert_mlp2&#45;&gt;layer4_gpu10_token_send -->
<g id="edge493" class="edge">
<title>layer4_gpu10_expert_mlp2&#45;&gt;layer4_gpu10_token_send</title>
<path fill="none" stroke="black" d="M7617.05,-21500.73C7621.58,-21492.39 7626.56,-21483.21 7631.51,-21474.09"/>
<polygon fill="black" stroke="black" points="7634.74,-21475.48 7636.43,-21465.02 7628.59,-21472.14 7634.74,-21475.48"/>
</g>
<!-- layer4_gpu10_token_send&#45;&gt;layer4_expert_agg -->
<g id="edge494" class="edge">
<title>layer4_gpu10_token_send&#45;&gt;layer4_expert_agg</title>
<path fill="none" stroke="black" d="M7418.01,-21381.89C7377.96,-21377.01 7336.86,-21372.44 7298,-21368.83 6805.31,-21323.09 6235.61,-21294.81 5866.49,-21279.72"/>
<polygon fill="black" stroke="black" points="5866.58,-21276.22 5856.44,-21279.31 5866.29,-21283.22 5866.58,-21276.22"/>
</g>
<!-- layer4_gpu11_expert_mlp1 -->
<g id="node426" class="node">
<title>layer4_gpu11_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="8477.5,-21777 8016.5,-21777 8016.5,-21709 8477.5,-21709 8477.5,-21777"/>
<text text-anchor="middle" x="8247" y="-21761.8" font-family="Times,serif" font-size="14.00">Expert 11 MLP1</text>
<text text-anchor="middle" x="8247" y="-21746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8247" y="-21731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8247" y="-21716.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer4_gpu11_token_recv&#45;&gt;layer4_gpu11_expert_mlp1 -->
<g id="edge496" class="edge">
<title>layer4_gpu11_token_recv&#45;&gt;layer4_gpu11_expert_mlp1</title>
<path fill="none" stroke="black" d="M8234.54,-21812.86C8236.08,-21804.39 8237.67,-21795.59 8239.18,-21787.23"/>
<polygon fill="black" stroke="black" points="8242.64,-21787.76 8240.98,-21777.3 8235.75,-21786.52 8242.64,-21787.76"/>
</g>
<!-- layer4_gpu11_expert_act -->
<g id="node427" class="node">
<title>layer4_gpu11_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="8477.5,-21673 8100.5,-21673 8100.5,-21605 8477.5,-21605 8477.5,-21673"/>
<text text-anchor="middle" x="8289" y="-21657.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="8289" y="-21642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8289" y="-21627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8289" y="-21612.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer4_gpu11_expert_mlp1&#45;&gt;layer4_gpu11_expert_act -->
<g id="edge497" class="edge">
<title>layer4_gpu11_expert_mlp1&#45;&gt;layer4_gpu11_expert_act</title>
<path fill="none" stroke="black" d="M8260.64,-21708.88C8264.08,-21700.51 8267.83,-21691.4 8271.45,-21682.63"/>
<polygon fill="black" stroke="black" points="8274.72,-21683.88 8275.29,-21673.3 8268.24,-21681.21 8274.72,-21683.88"/>
</g>
<!-- layer4_gpu11_expert_mlp2 -->
<g id="node428" class="node">
<title>layer4_gpu11_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="8575.5,-21569 8168.5,-21569 8168.5,-21501 8575.5,-21501 8575.5,-21569"/>
<text text-anchor="middle" x="8372" y="-21553.8" font-family="Times,serif" font-size="14.00">Expert 11 MLP2</text>
<text text-anchor="middle" x="8372" y="-21538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8372" y="-21523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="8372" y="-21508.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer4_gpu11_expert_act&#45;&gt;layer4_gpu11_expert_mlp2 -->
<g id="edge498" class="edge">
<title>layer4_gpu11_expert_act&#45;&gt;layer4_gpu11_expert_mlp2</title>
<path fill="none" stroke="black" d="M8315.95,-21604.88C8323.12,-21596.06 8330.96,-21586.43 8338.45,-21577.23"/>
<polygon fill="black" stroke="black" points="8341.31,-21579.26 8344.9,-21569.3 8335.88,-21574.84 8341.31,-21579.26"/>
</g>
<!-- layer4_gpu11_token_send -->
<g id="node429" class="node">
<title>layer4_gpu11_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="8391" cy="-21416.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="8391" y="-21435.71" font-family="Times,serif" font-size="14.00">Token Send GPU11</text>
<text text-anchor="middle" x="8391" y="-21420.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="8391" y="-21405.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="8391" y="-21390.71" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer4_gpu11_expert_mlp2&#45;&gt;layer4_gpu11_token_send -->
<g id="edge499" class="edge">
<title>layer4_gpu11_expert_mlp2&#45;&gt;layer4_gpu11_token_send</title>
<path fill="none" stroke="black" d="M8377.44,-21500.73C8378.77,-21492.65 8380.22,-21483.78 8381.67,-21474.94"/>
<polygon fill="black" stroke="black" points="8385.13,-21475.46 8383.29,-21465.02 8378.22,-21474.33 8385.13,-21475.46"/>
</g>
<!-- layer4_gpu11_token_send&#45;&gt;layer4_expert_agg -->
<g id="edge500" class="edge">
<title>layer4_gpu11_token_send&#45;&gt;layer4_expert_agg</title>
<path fill="none" stroke="black" d="M8149.02,-21381.58C8108.35,-21376.68 8066.52,-21372.18 8027,-21368.83 7257.21,-21303.63 6353.08,-21279.46 5854.72,-21270.68"/>
<polygon fill="black" stroke="black" points="5854.55,-21267.18 5844.49,-21270.5 5854.43,-21274.18 5854.55,-21267.18"/>
</g>
<!-- layer4_gpu12_expert_mlp1 -->
<g id="node431" class="node">
<title>layer4_gpu12_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9168.5,-21777 8707.5,-21777 8707.5,-21709 9168.5,-21709 9168.5,-21777"/>
<text text-anchor="middle" x="8938" y="-21761.8" font-family="Times,serif" font-size="14.00">Expert 12 MLP1</text>
<text text-anchor="middle" x="8938" y="-21746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8938" y="-21731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8938" y="-21716.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer4_gpu12_token_recv&#45;&gt;layer4_gpu12_expert_mlp1 -->
<g id="edge502" class="edge">
<title>layer4_gpu12_token_recv&#45;&gt;layer4_gpu12_expert_mlp1</title>
<path fill="none" stroke="black" d="M8923.17,-21812.86C8924.99,-21804.39 8926.89,-21795.59 8928.69,-21787.23"/>
<polygon fill="black" stroke="black" points="8932.14,-21787.81 8930.83,-21777.3 8925.3,-21786.34 8932.14,-21787.81"/>
</g>
<!-- layer4_gpu12_expert_act -->
<g id="node432" class="node">
<title>layer4_gpu12_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9178.5,-21673 8801.5,-21673 8801.5,-21605 9178.5,-21605 9178.5,-21673"/>
<text text-anchor="middle" x="8990" y="-21657.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="8990" y="-21642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8990" y="-21627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8990" y="-21612.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer4_gpu12_expert_mlp1&#45;&gt;layer4_gpu12_expert_act -->
<g id="edge503" class="edge">
<title>layer4_gpu12_expert_mlp1&#45;&gt;layer4_gpu12_expert_act</title>
<path fill="none" stroke="black" d="M8954.88,-21708.88C8959.2,-21700.42 8963.89,-21691.2 8968.41,-21682.35"/>
<polygon fill="black" stroke="black" points="8971.6,-21683.79 8973.02,-21673.3 8965.36,-21680.62 8971.6,-21683.79"/>
</g>
<!-- layer4_gpu12_expert_mlp2 -->
<g id="node433" class="node">
<title>layer4_gpu12_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9219.5,-21569 8812.5,-21569 8812.5,-21501 9219.5,-21501 9219.5,-21569"/>
<text text-anchor="middle" x="9016" y="-21553.8" font-family="Times,serif" font-size="14.00">Expert 12 MLP2</text>
<text text-anchor="middle" x="9016" y="-21538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9016" y="-21523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9016" y="-21508.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer4_gpu12_expert_act&#45;&gt;layer4_gpu12_expert_mlp2 -->
<g id="edge504" class="edge">
<title>layer4_gpu12_expert_act&#45;&gt;layer4_gpu12_expert_mlp2</title>
<path fill="none" stroke="black" d="M8998.44,-21604.88C9000.53,-21596.69 9002.8,-21587.79 9004.99,-21579.19"/>
<polygon fill="black" stroke="black" points="9008.43,-21579.85 9007.51,-21569.3 9001.65,-21578.12 9008.43,-21579.85"/>
</g>
<!-- layer4_gpu12_token_send -->
<g id="node434" class="node">
<title>layer4_gpu12_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9120" cy="-21416.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9120" y="-21435.71" font-family="Times,serif" font-size="14.00">Token Send GPU12</text>
<text text-anchor="middle" x="9120" y="-21420.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9120" y="-21405.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9120" y="-21390.71" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer4_gpu12_expert_mlp2&#45;&gt;layer4_gpu12_token_send -->
<g id="edge505" class="edge">
<title>layer4_gpu12_expert_mlp2&#45;&gt;layer4_gpu12_token_send</title>
<path fill="none" stroke="black" d="M9045.8,-21500.73C9053.66,-21491.96 9062.36,-21482.25 9070.95,-21472.66"/>
<polygon fill="black" stroke="black" points="9073.73,-21474.81 9077.79,-21465.02 9068.51,-21470.14 9073.73,-21474.81"/>
</g>
<!-- layer4_gpu12_token_send&#45;&gt;layer4_expert_agg -->
<g id="edge506" class="edge">
<title>layer4_gpu12_token_send&#45;&gt;layer4_expert_agg</title>
<path fill="none" stroke="black" d="M8879.52,-21381.45C8838.38,-21376.52 8796.02,-21372.04 8756,-21368.83 7703.84,-21284.46 6456.59,-21268.26 5848.15,-21265.75"/>
<polygon fill="black" stroke="black" points="5847.92,-21262.25 5837.9,-21265.71 5847.89,-21269.25 5847.92,-21262.25"/>
</g>
<!-- layer4_gpu13_expert_mlp1 -->
<g id="node436" class="node">
<title>layer4_gpu13_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9970.5,-21777 9509.5,-21777 9509.5,-21709 9970.5,-21709 9970.5,-21777"/>
<text text-anchor="middle" x="9740" y="-21761.8" font-family="Times,serif" font-size="14.00">Expert 13 MLP1</text>
<text text-anchor="middle" x="9740" y="-21746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9740" y="-21731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9740" y="-21716.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer4_gpu13_token_recv&#45;&gt;layer4_gpu13_expert_mlp1 -->
<g id="edge508" class="edge">
<title>layer4_gpu13_token_recv&#45;&gt;layer4_gpu13_expert_mlp1</title>
<path fill="none" stroke="black" d="M9656.14,-21813.53C9668,-21803.69 9680.43,-21793.39 9691.96,-21783.83"/>
<polygon fill="black" stroke="black" points="9694.32,-21786.42 9699.79,-21777.34 9689.86,-21781.03 9694.32,-21786.42"/>
</g>
<!-- layer4_gpu13_expert_act -->
<g id="node437" class="node">
<title>layer4_gpu13_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9959.5,-21673 9582.5,-21673 9582.5,-21605 9959.5,-21605 9959.5,-21673"/>
<text text-anchor="middle" x="9771" y="-21657.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="9771" y="-21642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9771" y="-21627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9771" y="-21612.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer4_gpu13_expert_mlp1&#45;&gt;layer4_gpu13_expert_act -->
<g id="edge509" class="edge">
<title>layer4_gpu13_expert_mlp1&#45;&gt;layer4_gpu13_expert_act</title>
<path fill="none" stroke="black" d="M9750.06,-21708.88C9752.58,-21700.6 9755.32,-21691.59 9757.96,-21682.91"/>
<polygon fill="black" stroke="black" points="9761.32,-21683.88 9760.88,-21673.3 9754.62,-21681.85 9761.32,-21683.88"/>
</g>
<!-- layer4_gpu13_expert_mlp2 -->
<g id="node438" class="node">
<title>layer4_gpu13_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9990.5,-21569 9583.5,-21569 9583.5,-21501 9990.5,-21501 9990.5,-21569"/>
<text text-anchor="middle" x="9787" y="-21553.8" font-family="Times,serif" font-size="14.00">Expert 13 MLP2</text>
<text text-anchor="middle" x="9787" y="-21538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9787" y="-21523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9787" y="-21508.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer4_gpu13_expert_act&#45;&gt;layer4_gpu13_expert_mlp2 -->
<g id="edge510" class="edge">
<title>layer4_gpu13_expert_act&#45;&gt;layer4_gpu13_expert_mlp2</title>
<path fill="none" stroke="black" d="M9776.19,-21604.88C9777.48,-21596.69 9778.88,-21587.79 9780.22,-21579.19"/>
<polygon fill="black" stroke="black" points="9783.68,-21579.72 9781.78,-21569.3 9776.77,-21578.63 9783.68,-21579.72"/>
</g>
<!-- layer4_gpu13_token_send -->
<g id="node439" class="node">
<title>layer4_gpu13_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9849" cy="-21416.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9849" y="-21435.71" font-family="Times,serif" font-size="14.00">Token Send GPU13</text>
<text text-anchor="middle" x="9849" y="-21420.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9849" y="-21405.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9849" y="-21390.71" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer4_gpu13_expert_mlp2&#45;&gt;layer4_gpu13_token_send -->
<g id="edge511" class="edge">
<title>layer4_gpu13_expert_mlp2&#45;&gt;layer4_gpu13_token_send</title>
<path fill="none" stroke="black" d="M9804.77,-21500.73C9809.22,-21492.39 9814.13,-21483.21 9819,-21474.09"/>
<polygon fill="black" stroke="black" points="9822.21,-21475.49 9823.84,-21465.02 9816.04,-21472.19 9822.21,-21475.49"/>
</g>
<!-- layer4_gpu13_token_send&#45;&gt;layer4_expert_agg -->
<g id="edge512" class="edge">
<title>layer4_gpu13_token_send&#45;&gt;layer4_expert_agg</title>
<path fill="none" stroke="black" d="M9609.02,-21381.32C9567.73,-21376.38 9525.18,-21371.94 9485,-21368.83 8787.13,-21314.87 6712.07,-21282.12 5854.42,-21270.56"/>
<polygon fill="black" stroke="black" points="5854.44,-21267.06 5844.39,-21270.43 5854.34,-21274.06 5854.44,-21267.06"/>
</g>
<!-- layer4_gpu14_expert_mlp1 -->
<g id="node441" class="node">
<title>layer4_gpu14_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="10531.5,-21777 10070.5,-21777 10070.5,-21709 10531.5,-21709 10531.5,-21777"/>
<text text-anchor="middle" x="10301" y="-21761.8" font-family="Times,serif" font-size="14.00">Expert 14 MLP1</text>
<text text-anchor="middle" x="10301" y="-21746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10301" y="-21731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10301" y="-21716.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer4_gpu14_token_recv&#45;&gt;layer4_gpu14_expert_mlp1 -->
<g id="edge514" class="edge">
<title>layer4_gpu14_token_recv&#45;&gt;layer4_gpu14_expert_mlp1</title>
<path fill="none" stroke="black" d="M10292.69,-21812.86C10293.71,-21804.48 10294.75,-21795.78 10295.75,-21787.5"/>
<polygon fill="black" stroke="black" points="10299.26,-21787.65 10296.98,-21777.3 10292.31,-21786.81 10299.26,-21787.65"/>
</g>
<!-- layer4_gpu14_expert_act -->
<g id="node442" class="node">
<title>layer4_gpu14_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="10764.5,-21673 10387.5,-21673 10387.5,-21605 10764.5,-21605 10764.5,-21673"/>
<text text-anchor="middle" x="10576" y="-21657.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="10576" y="-21642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10576" y="-21627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10576" y="-21612.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer4_gpu14_expert_mlp1&#45;&gt;layer4_gpu14_expert_act -->
<g id="edge515" class="edge">
<title>layer4_gpu14_expert_mlp1&#45;&gt;layer4_gpu14_expert_act</title>
<path fill="none" stroke="black" d="M10390.28,-21708.88C10418.04,-21698.58 10448.8,-21687.18 10477.17,-21676.65"/>
<polygon fill="black" stroke="black" points="10478.53,-21679.88 10486.69,-21673.12 10476.1,-21673.32 10478.53,-21679.88"/>
</g>
<!-- layer4_gpu14_expert_mlp2 -->
<g id="node443" class="node">
<title>layer4_gpu14_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10779.5,-21569 10372.5,-21569 10372.5,-21501 10779.5,-21501 10779.5,-21569"/>
<text text-anchor="middle" x="10576" y="-21553.8" font-family="Times,serif" font-size="14.00">Expert 14 MLP2</text>
<text text-anchor="middle" x="10576" y="-21538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10576" y="-21523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="10576" y="-21508.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer4_gpu14_expert_act&#45;&gt;layer4_gpu14_expert_mlp2 -->
<g id="edge516" class="edge">
<title>layer4_gpu14_expert_act&#45;&gt;layer4_gpu14_expert_mlp2</title>
<path fill="none" stroke="black" d="M10576,-21604.88C10576,-21596.77 10576,-21587.98 10576,-21579.47"/>
<polygon fill="black" stroke="black" points="10579.5,-21579.3 10576,-21569.3 10572.5,-21579.3 10579.5,-21579.3"/>
</g>
<!-- layer4_gpu14_token_send -->
<g id="node444" class="node">
<title>layer4_gpu14_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="10578" cy="-21416.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="10578" y="-21435.71" font-family="Times,serif" font-size="14.00">Token Send GPU14</text>
<text text-anchor="middle" x="10578" y="-21420.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="10578" y="-21405.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="10578" y="-21390.71" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer4_gpu14_expert_mlp2&#45;&gt;layer4_gpu14_token_send -->
<g id="edge517" class="edge">
<title>layer4_gpu14_expert_mlp2&#45;&gt;layer4_gpu14_token_send</title>
<path fill="none" stroke="black" d="M10576.57,-21500.73C10576.71,-21492.74 10576.86,-21483.97 10577.01,-21475.23"/>
<polygon fill="black" stroke="black" points="10580.52,-21475.08 10577.19,-21465.02 10573.52,-21474.96 10580.52,-21475.08"/>
</g>
<!-- layer4_gpu14_token_send&#45;&gt;layer4_expert_agg -->
<g id="edge518" class="edge">
<title>layer4_gpu14_token_send&#45;&gt;layer4_expert_agg</title>
<path fill="none" stroke="black" d="M10339.01,-21381.3C10297.41,-21376.33 10254.51,-21371.88 10214,-21368.83 9369.31,-21305.2 6817.75,-21277.29 5852.45,-21268.8"/>
<polygon fill="black" stroke="black" points="5852.26,-21265.3 5842.22,-21268.71 5852.19,-21272.3 5852.26,-21265.3"/>
</g>
<!-- layer4_gpu15_expert_mlp1 -->
<g id="node446" class="node">
<title>layer4_gpu15_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="11208.5,-21777 10747.5,-21777 10747.5,-21709 11208.5,-21709 11208.5,-21777"/>
<text text-anchor="middle" x="10978" y="-21761.8" font-family="Times,serif" font-size="14.00">Expert 15 MLP1</text>
<text text-anchor="middle" x="10978" y="-21746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10978" y="-21731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10978" y="-21716.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer4_gpu15_token_recv&#45;&gt;layer4_gpu15_expert_mlp1 -->
<g id="edge520" class="edge">
<title>layer4_gpu15_token_recv&#45;&gt;layer4_gpu15_expert_mlp1</title>
<path fill="none" stroke="black" d="M10975.63,-21812.86C10975.92,-21804.48 10976.22,-21795.78 10976.5,-21787.5"/>
<polygon fill="black" stroke="black" points="10980.01,-21787.41 10976.85,-21777.3 10973.01,-21787.17 10980.01,-21787.41"/>
</g>
<!-- layer4_gpu15_expert_act -->
<g id="node447" class="node">
<title>layer4_gpu15_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="11174.5,-21673 10797.5,-21673 10797.5,-21605 11174.5,-21605 11174.5,-21673"/>
<text text-anchor="middle" x="10986" y="-21657.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="10986" y="-21642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10986" y="-21627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10986" y="-21612.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer4_gpu15_expert_mlp1&#45;&gt;layer4_gpu15_expert_act -->
<g id="edge521" class="edge">
<title>layer4_gpu15_expert_mlp1&#45;&gt;layer4_gpu15_expert_act</title>
<path fill="none" stroke="black" d="M10980.6,-21708.88C10981.23,-21700.77 10981.92,-21691.98 10982.59,-21683.47"/>
<polygon fill="black" stroke="black" points="10986.1,-21683.54 10983.39,-21673.3 10979.12,-21682.99 10986.1,-21683.54"/>
</g>
<!-- layer4_gpu15_expert_mlp2 -->
<g id="node448" class="node">
<title>layer4_gpu15_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="11364.5,-21569 10957.5,-21569 10957.5,-21501 11364.5,-21501 11364.5,-21569"/>
<text text-anchor="middle" x="11161" y="-21553.8" font-family="Times,serif" font-size="14.00">Expert 15 MLP2</text>
<text text-anchor="middle" x="11161" y="-21538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11161" y="-21523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="11161" y="-21508.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer4_gpu15_expert_act&#45;&gt;layer4_gpu15_expert_mlp2 -->
<g id="edge522" class="edge">
<title>layer4_gpu15_expert_act&#45;&gt;layer4_gpu15_expert_mlp2</title>
<path fill="none" stroke="black" d="M11042.82,-21604.88C11059.56,-21595.12 11078.02,-21584.36 11095.27,-21574.31"/>
<polygon fill="black" stroke="black" points="11097.29,-21577.18 11104.17,-21569.12 11093.77,-21571.13 11097.29,-21577.18"/>
</g>
<!-- layer4_gpu15_token_send -->
<g id="node449" class="node">
<title>layer4_gpu15_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="11307" cy="-21416.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="11307" y="-21435.71" font-family="Times,serif" font-size="14.00">Token Send GPU15</text>
<text text-anchor="middle" x="11307" y="-21420.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="11307" y="-21405.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="11307" y="-21390.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer4_gpu15_expert_mlp2&#45;&gt;layer4_gpu15_token_send -->
<g id="edge523" class="edge">
<title>layer4_gpu15_expert_mlp2&#45;&gt;layer4_gpu15_token_send</title>
<path fill="none" stroke="black" d="M11202.84,-21500.73C11214.63,-21491.36 11227.76,-21480.92 11240.61,-21470.7"/>
<polygon fill="black" stroke="black" points="11242.92,-21473.34 11248.56,-21464.37 11238.56,-21467.86 11242.92,-21473.34"/>
</g>
<!-- layer4_gpu15_token_send&#45;&gt;layer4_expert_agg -->
<g id="edge524" class="edge">
<title>layer4_gpu15_token_send&#45;&gt;layer4_expert_agg</title>
<path fill="none" stroke="black" d="M11068.02,-21381.2C11026.42,-21376.24 10983.51,-21371.82 10943,-21368.83 9950.22,-21295.49 6914.36,-21273.18 5850.26,-21267.52"/>
<polygon fill="black" stroke="black" points="5850.17,-21264.02 5840.15,-21267.47 5850.13,-21271.02 5850.17,-21264.02"/>
</g>
<!-- layer4_residual2 -->
<g id="node451" class="node">
<title>layer4_residual2</title>
<polygon fill="lightyellow" stroke="black" points="5919.89,-21160.83 5215.35,-21160.83 5034.11,-21024.83 5738.65,-21024.83 5919.89,-21160.83"/>
<text text-anchor="middle" x="5477" y="-21111.63" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="5477" y="-21096.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5477" y="-21081.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-21066.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer4_expert_agg&#45;&gt;layer4_residual2 -->
<g id="edge525" class="edge">
<title>layer4_expert_agg&#45;&gt;layer4_residual2</title>
<path fill="none" stroke="black" d="M5477,-21196.64C5477,-21188.33 5477,-21179.78 5477,-21171.32"/>
<polygon fill="black" stroke="black" points="5480.5,-21171.09 5477,-21161.09 5473.5,-21171.09 5480.5,-21171.09"/>
</g>
<!-- layer5_layernorm -->
<g id="node452" class="node">
<title>layer5_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="5680.5,-20977.83 5273.5,-20977.83 5273.5,-20909.83 5680.5,-20909.83 5680.5,-20977.83"/>
<text text-anchor="middle" x="5477" y="-20962.63" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5477" y="-20947.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-20932.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-20917.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer4_residual2&#45;&gt;layer5_layernorm -->
<g id="edge526" class="edge">
<title>layer4_residual2&#45;&gt;layer5_layernorm</title>
<path fill="none" stroke="black" d="M5477,-21024.78C5477,-21012.38 5477,-20999.72 5477,-20988.25"/>
<polygon fill="black" stroke="black" points="5480.5,-20988.09 5477,-20978.09 5473.5,-20988.09 5480.5,-20988.09"/>
</g>
<!-- layer5_qkv_proj -->
<g id="node453" class="node">
<title>layer5_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="5734.5,-20873.83 5219.5,-20873.83 5219.5,-20805.83 5734.5,-20805.83 5734.5,-20873.83"/>
<text text-anchor="middle" x="5477" y="-20858.63" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5477" y="-20843.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-20828.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5477" y="-20813.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer5_layernorm&#45;&gt;layer5_qkv_proj -->
<g id="edge527" class="edge">
<title>layer5_layernorm&#45;&gt;layer5_qkv_proj</title>
<path fill="none" stroke="black" d="M5477,-20909.71C5477,-20901.61 5477,-20892.81 5477,-20884.3"/>
<polygon fill="black" stroke="black" points="5480.5,-20884.13 5477,-20874.13 5473.5,-20884.13 5480.5,-20884.13"/>
</g>
<!-- layer5_attention -->
<g id="node454" class="node">
<title>layer5_attention</title>
<polygon fill="lightgreen" stroke="black" points="5728.5,-20769.83 5225.5,-20769.83 5225.5,-20701.83 5728.5,-20701.83 5728.5,-20769.83"/>
<text text-anchor="middle" x="5477" y="-20754.63" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5477" y="-20739.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5477" y="-20724.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5477" y="-20709.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer5_qkv_proj&#45;&gt;layer5_attention -->
<g id="edge528" class="edge">
<title>layer5_qkv_proj&#45;&gt;layer5_attention</title>
<path fill="none" stroke="black" d="M5477,-20805.71C5477,-20797.61 5477,-20788.81 5477,-20780.3"/>
<polygon fill="black" stroke="black" points="5480.5,-20780.13 5477,-20770.13 5473.5,-20780.13 5480.5,-20780.13"/>
</g>
<!-- layer5_attn_out -->
<g id="node455" class="node">
<title>layer5_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="5715.5,-20665.83 5238.5,-20665.83 5238.5,-20597.83 5715.5,-20597.83 5715.5,-20665.83"/>
<text text-anchor="middle" x="5477" y="-20650.63" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5477" y="-20635.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5477" y="-20620.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-20605.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer5_attention&#45;&gt;layer5_attn_out -->
<g id="edge529" class="edge">
<title>layer5_attention&#45;&gt;layer5_attn_out</title>
<path fill="none" stroke="black" d="M5477,-20701.71C5477,-20693.61 5477,-20684.81 5477,-20676.3"/>
<polygon fill="black" stroke="black" points="5480.5,-20676.13 5477,-20666.13 5473.5,-20676.13 5480.5,-20676.13"/>
</g>
<!-- layer5_residual1 -->
<g id="node456" class="node">
<title>layer5_residual1</title>
<polygon fill="lightyellow" stroke="black" points="5919.89,-20561.83 5215.35,-20561.83 5034.11,-20425.83 5738.65,-20425.83 5919.89,-20561.83"/>
<text text-anchor="middle" x="5477" y="-20512.63" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5477" y="-20497.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5477" y="-20482.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-20467.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer5_attn_out&#45;&gt;layer5_residual1 -->
<g id="edge530" class="edge">
<title>layer5_attn_out&#45;&gt;layer5_residual1</title>
<path fill="none" stroke="black" d="M5477,-20597.56C5477,-20589.73 5477,-20581.07 5477,-20572.18"/>
<polygon fill="black" stroke="black" points="5480.5,-20572.09 5477,-20562.09 5473.5,-20572.09 5480.5,-20572.09"/>
</g>
<!-- layer5_layernorm2 -->
<g id="node457" class="node">
<title>layer5_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="5680.5,-20389.83 5273.5,-20389.83 5273.5,-20321.83 5680.5,-20321.83 5680.5,-20389.83"/>
<text text-anchor="middle" x="5477" y="-20374.63" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5477" y="-20359.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-20344.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-20329.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer5_residual1&#45;&gt;layer5_layernorm2 -->
<g id="edge531" class="edge">
<title>layer5_residual1&#45;&gt;layer5_layernorm2</title>
<path fill="none" stroke="black" d="M5477,-20425.63C5477,-20416.87 5477,-20408.11 5477,-20399.9"/>
<polygon fill="black" stroke="black" points="5480.5,-20399.85 5477,-20389.85 5473.5,-20399.85 5480.5,-20399.85"/>
</g>
<!-- layer5_global_gate -->
<g id="node458" class="node">
<title>layer5_global_gate</title>
<polygon fill="lightgreen" stroke="black" points="5674.5,-20285.83 5279.5,-20285.83 5279.5,-20217.83 5674.5,-20217.83 5674.5,-20285.83"/>
<text text-anchor="middle" x="5477" y="-20270.63" font-family="Times,serif" font-size="14.00">Global Gate</text>
<text text-anchor="middle" x="5477" y="-20255.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-20240.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, experts=64]</text>
<text text-anchor="middle" x="5477" y="-20225.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer5_layernorm2&#45;&gt;layer5_global_gate -->
<g id="edge532" class="edge">
<title>layer5_layernorm2&#45;&gt;layer5_global_gate</title>
<path fill="none" stroke="black" d="M5477,-20321.71C5477,-20313.61 5477,-20304.81 5477,-20296.3"/>
<polygon fill="black" stroke="black" points="5480.5,-20296.13 5477,-20286.13 5473.5,-20296.13 5480.5,-20296.13"/>
</g>
<!-- layer5_routing -->
<g id="node459" class="node">
<title>layer5_routing</title>
<polygon fill="lightyellow" stroke="black" points="5963.47,-20181.83 5189.6,-20181.83 4990.53,-20045.83 5764.4,-20045.83 5963.47,-20181.83"/>
<text text-anchor="middle" x="5477" y="-20132.63" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="5477" y="-20117.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-20102.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5477" y="-20087.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer5_global_gate&#45;&gt;layer5_routing -->
<g id="edge533" class="edge">
<title>layer5_global_gate&#45;&gt;layer5_routing</title>
<path fill="none" stroke="black" d="M5477,-20217.56C5477,-20209.73 5477,-20201.07 5477,-20192.18"/>
<polygon fill="black" stroke="black" points="5480.5,-20192.09 5477,-20182.09 5473.5,-20192.09 5480.5,-20192.09"/>
</g>
<!-- layer5_gpu0_token_recv -->
<g id="node460" class="node">
<title>layer5_gpu0_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="494" cy="-19961.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="494" y="-19980.55" font-family="Times,serif" font-size="14.00">Token Receive GPU0</text>
<text text-anchor="middle" x="494" y="-19965.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="494" y="-19950.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="494" y="-19935.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer5_routing&#45;&gt;layer5_gpu0_token_recv -->
<g id="edge534" class="edge">
<title>layer5_routing&#45;&gt;layer5_gpu0_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5082.11,-20108.65C4126.39,-20097.77 1708.13,-20065.48 901,-20009.83 851.44,-20006.41 798.62,-20001.36 748.02,-19995.81"/>
<polygon fill="black" stroke="black" points="748.26,-19992.31 737.93,-19994.69 747.49,-19999.27 748.26,-19992.31"/>
</g>
<!-- layer5_gpu1_token_recv -->
<g id="node465" class="node">
<title>layer5_gpu1_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1244" cy="-19961.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1244" y="-19980.55" font-family="Times,serif" font-size="14.00">Token Receive GPU1</text>
<text text-anchor="middle" x="1244" y="-19965.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1244" y="-19950.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1244" y="-19935.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer5_routing&#45;&gt;layer5_gpu1_token_recv -->
<g id="edge540" class="edge">
<title>layer5_routing&#45;&gt;layer5_gpu1_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5080.09,-20107.18C4235.19,-20094.36 2281.89,-20060.17 1619,-20009.83 1577.12,-20006.65 1532.73,-20002.12 1489.72,-19997.1"/>
<polygon fill="black" stroke="black" points="1490.03,-19993.62 1479.69,-19995.92 1489.21,-20000.57 1490.03,-19993.62"/>
</g>
<!-- layer5_gpu2_token_recv -->
<g id="node470" class="node">
<title>layer5_gpu2_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1962" cy="-19961.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1962" y="-19980.55" font-family="Times,serif" font-size="14.00">Token Receive GPU2</text>
<text text-anchor="middle" x="1962" y="-19965.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1962" y="-19950.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1962" y="-19935.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer5_routing&#45;&gt;layer5_gpu2_token_recv -->
<g id="edge546" class="edge">
<title>layer5_routing&#45;&gt;layer5_gpu2_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5087.74,-20112.3C4491.37,-20108.74 3316.13,-20090.87 2322,-20009.83 2283.78,-20006.71 2243.39,-20002.42 2204.02,-19997.68"/>
<polygon fill="black" stroke="black" points="2204.38,-19994.2 2194.03,-19996.47 2203.54,-20001.15 2204.38,-19994.2"/>
</g>
<!-- layer5_gpu3_token_recv -->
<g id="node475" class="node">
<title>layer5_gpu3_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="2665" cy="-19961.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2665" y="-19980.55" font-family="Times,serif" font-size="14.00">Token Receive GPU3</text>
<text text-anchor="middle" x="2665" y="-19965.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="2665" y="-19950.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2665" y="-19935.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer5_routing&#45;&gt;layer5_gpu3_token_recv -->
<g id="edge552" class="edge">
<title>layer5_routing&#45;&gt;layer5_gpu3_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5079.76,-20106.89C4594.24,-20097.15 3747.97,-20072.17 3025,-20009.83 2987.24,-20006.57 2947.36,-20002.25 2908.44,-19997.54"/>
<polygon fill="black" stroke="black" points="2908.38,-19994.01 2898.03,-19996.27 2907.53,-20000.96 2908.38,-19994.01"/>
</g>
<!-- layer5_gpu4_token_recv -->
<g id="node480" class="node">
<title>layer5_gpu4_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="3368" cy="-19961.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="3368" y="-19980.55" font-family="Times,serif" font-size="14.00">Token Receive GPU4</text>
<text text-anchor="middle" x="3368" y="-19965.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="3368" y="-19950.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3368" y="-19935.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer5_routing&#45;&gt;layer5_gpu4_token_recv -->
<g id="edge558" class="edge">
<title>layer5_routing&#45;&gt;layer5_gpu4_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5064.55,-20096.54C4710.77,-20080.63 4187.66,-20052.53 3733,-20009.83 3694.74,-20006.24 3654.3,-20001.73 3614.83,-19996.94"/>
<polygon fill="black" stroke="black" points="3615.17,-19993.46 3604.82,-19995.72 3614.32,-20000.41 3615.17,-19993.46"/>
</g>
<!-- layer5_gpu5_token_recv -->
<g id="node485" class="node">
<title>layer5_gpu5_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4076" cy="-19961.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4076" y="-19980.55" font-family="Times,serif" font-size="14.00">Token Receive GPU5</text>
<text text-anchor="middle" x="4076" y="-19965.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4076" y="-19950.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4076" y="-19935.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_routing&#45;&gt;layer5_gpu5_token_recv -->
<g id="edge564" class="edge">
<title>layer5_routing&#45;&gt;layer5_gpu5_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5029.45,-20072.55C4842.74,-20054.82 4623.71,-20032.81 4426,-20009.83 4392.6,-20005.95 4357.46,-20001.57 4322.84,-19997.08"/>
<polygon fill="black" stroke="black" points="4322.97,-19993.57 4312.6,-19995.75 4322.07,-20000.51 4322.97,-19993.57"/>
</g>
<!-- layer5_gpu6_token_recv -->
<g id="node490" class="node">
<title>layer5_gpu6_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4769" cy="-19961.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4769" y="-19980.55" font-family="Times,serif" font-size="14.00">Token Receive GPU6</text>
<text text-anchor="middle" x="4769" y="-19965.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4769" y="-19950.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4769" y="-19935.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer5_routing&#45;&gt;layer5_gpu6_token_recv -->
<g id="edge570" class="edge">
<title>layer5_routing&#45;&gt;layer5_gpu6_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5160.79,-20045.8C5093.78,-20031.59 5024.93,-20017 4964.02,-20004.09"/>
<polygon fill="black" stroke="black" points="4964.43,-20000.6 4953.92,-20001.95 4962.98,-20007.44 4964.43,-20000.6"/>
</g>
<!-- layer5_gpu7_token_recv -->
<g id="node495" class="node">
<title>layer5_gpu7_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="5477" cy="-19961.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="5477" y="-19980.55" font-family="Times,serif" font-size="14.00">Token Receive GPU7</text>
<text text-anchor="middle" x="5477" y="-19965.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5477" y="-19950.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5477" y="-19935.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer5_routing&#45;&gt;layer5_gpu7_token_recv -->
<g id="edge576" class="edge">
<title>layer5_routing&#45;&gt;layer5_gpu7_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5477,-20045.69C5477,-20037.14 5477,-20028.46 5477,-20020.09"/>
<polygon fill="black" stroke="black" points="5480.5,-20020.06 5477,-20010.06 5473.5,-20020.06 5480.5,-20020.06"/>
</g>
<!-- layer5_gpu8_token_recv -->
<g id="node500" class="node">
<title>layer5_gpu8_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6165" cy="-19961.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6165" y="-19980.55" font-family="Times,serif" font-size="14.00">Token Receive GPU8</text>
<text text-anchor="middle" x="6165" y="-19965.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6165" y="-19950.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6165" y="-19935.55" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer5_routing&#45;&gt;layer5_gpu8_token_recv -->
<g id="edge582" class="edge">
<title>layer5_routing&#45;&gt;layer5_gpu8_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5769.27,-20049.07C5838.41,-20033.99 5910.39,-20018.29 5973.71,-20004.47"/>
<polygon fill="black" stroke="black" points="5974.78,-20007.83 5983.8,-20002.27 5973.29,-20000.99 5974.78,-20007.83"/>
</g>
<!-- layer5_gpu9_token_recv -->
<g id="node505" class="node">
<title>layer5_gpu9_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6852" cy="-19961.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6852" y="-19980.55" font-family="Times,serif" font-size="14.00">Token Receive GPU9</text>
<text text-anchor="middle" x="6852" y="-19965.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6852" y="-19950.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6852" y="-19935.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer5_routing&#45;&gt;layer5_gpu9_token_recv -->
<g id="edge588" class="edge">
<title>layer5_routing&#45;&gt;layer5_gpu9_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5817.49,-20081.96C6018.57,-20062.94 6278,-20037.05 6508,-20009.83 6540.01,-20006.04 6573.65,-20001.78 6606.85,-19997.41"/>
<polygon fill="black" stroke="black" points="6607.68,-20000.83 6617.14,-19996.05 6606.77,-19993.89 6607.68,-20000.83"/>
</g>
<!-- layer5_gpu10_token_recv -->
<g id="node510" class="node">
<title>layer5_gpu10_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="7539" cy="-19961.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="7539" y="-19980.55" font-family="Times,serif" font-size="14.00">Token Receive GPU10</text>
<text text-anchor="middle" x="7539" y="-19965.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="7539" y="-19950.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7539" y="-19935.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer5_routing&#45;&gt;layer5_gpu10_token_recv -->
<g id="edge594" class="edge">
<title>layer5_routing&#45;&gt;layer5_gpu10_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5842.52,-20098.99C6190.76,-20083.9 6729.43,-20055.58 7195,-20009.83 7228.58,-20006.53 7263.92,-20002.42 7298.65,-19998.02"/>
<polygon fill="black" stroke="black" points="7299.44,-20001.45 7308.91,-19996.71 7298.55,-19994.5 7299.44,-20001.45"/>
</g>
<!-- layer5_gpu11_token_recv -->
<g id="node515" class="node">
<title>layer5_gpu11_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8226" cy="-19961.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8226" y="-19980.55" font-family="Times,serif" font-size="14.00">Token Receive GPU11</text>
<text text-anchor="middle" x="8226" y="-19965.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8226" y="-19950.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8226" y="-19935.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer5_routing&#45;&gt;layer5_gpu11_token_recv -->
<g id="edge600" class="edge">
<title>layer5_routing&#45;&gt;layer5_gpu11_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5854.96,-20107.53C6329.25,-20098.37 7167.22,-20073.91 7882,-20009.83 7916.3,-20006.76 7952.42,-20002.71 7987.84,-19998.28"/>
<polygon fill="black" stroke="black" points="7988.33,-20001.74 7997.82,-19997.02 7987.46,-19994.8 7988.33,-20001.74"/>
</g>
<!-- layer5_gpu12_token_recv -->
<g id="node520" class="node">
<title>layer5_gpu12_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8913" cy="-19961.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8913" y="-19980.55" font-family="Times,serif" font-size="14.00">Token Receive GPU12</text>
<text text-anchor="middle" x="8913" y="-19965.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8913" y="-19950.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8913" y="-19935.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer5_routing&#45;&gt;layer5_gpu12_token_recv -->
<g id="edge606" class="edge">
<title>layer5_routing&#45;&gt;layer5_gpu12_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5862.47,-20112.69C6448.24,-20109.6 7597.15,-20092.31 8569,-20009.83 8603.73,-20006.88 8640.31,-20002.87 8676.15,-19998.41"/>
<polygon fill="black" stroke="black" points="8676.74,-20001.86 8686.23,-19997.14 8675.87,-19994.92 8676.74,-20001.86"/>
</g>
<!-- layer5_gpu13_token_recv -->
<g id="node525" class="node">
<title>layer5_gpu13_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="9600" cy="-19961.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="9600" y="-19980.55" font-family="Times,serif" font-size="14.00">Token Receive GPU13</text>
<text text-anchor="middle" x="9600" y="-19965.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="9600" y="-19950.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9600" y="-19935.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer5_routing&#45;&gt;layer5_gpu13_token_recv -->
<g id="edge612" class="edge">
<title>layer5_routing&#45;&gt;layer5_gpu13_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5855.33,-20107.76C6677.21,-20095.88 8604.22,-20063.16 9256,-20009.83 9291.01,-20006.97 9327.9,-20002.97 9364.01,-19998.5"/>
<polygon fill="black" stroke="black" points="9364.68,-20001.94 9374.17,-19997.22 9363.81,-19994.99 9364.68,-20001.94"/>
</g>
<!-- layer5_gpu14_token_recv -->
<g id="node530" class="node">
<title>layer5_gpu14_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10287" cy="-19961.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10287" y="-19980.55" font-family="Times,serif" font-size="14.00">Token Receive GPU14</text>
<text text-anchor="middle" x="10287" y="-19965.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10287" y="-19950.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10287" y="-19935.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer5_routing&#45;&gt;layer5_gpu14_token_recv -->
<g id="edge618" class="edge">
<title>layer5_routing&#45;&gt;layer5_gpu14_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5857.76,-20109.58C6787.42,-20100.76 9154.56,-20072.68 9943,-20009.83 9978.15,-20007.03 10015.2,-20003.05 10051.45,-19998.57"/>
<polygon fill="black" stroke="black" points="10052.16,-20002.01 10061.65,-19997.3 10051.29,-19995.07 10052.16,-20002.01"/>
</g>
<!-- layer5_gpu15_token_recv -->
<g id="node535" class="node">
<title>layer5_gpu15_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10974" cy="-19961.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10974" y="-19980.55" font-family="Times,serif" font-size="14.00">Token Receive GPU15</text>
<text text-anchor="middle" x="10974" y="-19965.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10974" y="-19950.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10974" y="-19935.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer5_routing&#45;&gt;layer5_gpu15_token_recv -->
<g id="edge624" class="edge">
<title>layer5_routing&#45;&gt;layer5_gpu15_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5859.8,-20110.94C6889.63,-20104.94 9703.77,-20082.23 10630,-20009.83 10665.29,-20007.07 10702.5,-20003.1 10738.88,-19998.62"/>
<polygon fill="black" stroke="black" points="10739.63,-20002.05 10749.12,-19997.34 10738.76,-19995.11 10739.63,-20002.05"/>
</g>
<!-- layer5_gpu0_expert_mlp1 -->
<g id="node461" class="node">
<title>layer5_gpu0_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="716.5,-19877.66 255.5,-19877.66 255.5,-19809.66 716.5,-19809.66 716.5,-19877.66"/>
<text text-anchor="middle" x="486" y="-19862.46" font-family="Times,serif" font-size="14.00">Expert 0 MLP1</text>
<text text-anchor="middle" x="486" y="-19847.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="486" y="-19832.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="486" y="-19817.46" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer5_gpu0_token_recv&#45;&gt;layer5_gpu0_expert_mlp1 -->
<g id="edge535" class="edge">
<title>layer5_gpu0_token_recv&#45;&gt;layer5_gpu0_expert_mlp1</title>
<path fill="none" stroke="black" d="M490.75,-19913.53C490.17,-19905.15 489.57,-19896.45 489,-19888.17"/>
<polygon fill="black" stroke="black" points="492.47,-19887.7 488.3,-19877.97 485.49,-19888.18 492.47,-19887.7"/>
</g>
<!-- layer5_gpu0_expert_act -->
<g id="node462" class="node">
<title>layer5_gpu0_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="655.5,-19773.66 278.5,-19773.66 278.5,-19705.66 655.5,-19705.66 655.5,-19773.66"/>
<text text-anchor="middle" x="467" y="-19758.46" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="467" y="-19743.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="467" y="-19728.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="467" y="-19713.46" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer5_gpu0_expert_mlp1&#45;&gt;layer5_gpu0_expert_act -->
<g id="edge536" class="edge">
<title>layer5_gpu0_expert_mlp1&#45;&gt;layer5_gpu0_expert_act</title>
<path fill="none" stroke="black" d="M479.83,-19809.55C478.3,-19801.35 476.65,-19792.45 475.05,-19783.86"/>
<polygon fill="black" stroke="black" points="478.47,-19783.15 473.2,-19773.96 471.59,-19784.43 478.47,-19783.15"/>
</g>
<!-- layer5_gpu0_expert_mlp2 -->
<g id="node463" class="node">
<title>layer5_gpu0_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="623.5,-19669.66 216.5,-19669.66 216.5,-19601.66 623.5,-19601.66 623.5,-19669.66"/>
<text text-anchor="middle" x="420" y="-19654.46" font-family="Times,serif" font-size="14.00">Expert 0 MLP2</text>
<text text-anchor="middle" x="420" y="-19639.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="420" y="-19624.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="420" y="-19609.46" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer5_gpu0_expert_act&#45;&gt;layer5_gpu0_expert_mlp2 -->
<g id="edge537" class="edge">
<title>layer5_gpu0_expert_act&#45;&gt;layer5_gpu0_expert_mlp2</title>
<path fill="none" stroke="black" d="M451.74,-19705.55C447.88,-19697.17 443.68,-19688.06 439.64,-19679.29"/>
<polygon fill="black" stroke="black" points="442.71,-19677.58 435.34,-19669.96 436.35,-19680.51 442.71,-19677.58"/>
</g>
<!-- layer5_gpu0_token_send -->
<g id="node464" class="node">
<title>layer5_gpu0_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="372" cy="-19517.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="372" y="-19536.38" font-family="Times,serif" font-size="14.00">Token Send GPU0</text>
<text text-anchor="middle" x="372" y="-19521.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="372" y="-19506.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="372" y="-19491.38" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer5_gpu0_expert_mlp2&#45;&gt;layer5_gpu0_token_send -->
<g id="edge538" class="edge">
<title>layer5_gpu0_expert_mlp2&#45;&gt;layer5_gpu0_token_send</title>
<path fill="none" stroke="black" d="M406.25,-19601.4C402.83,-19593.14 399.08,-19584.07 395.35,-19575.04"/>
<polygon fill="black" stroke="black" points="398.54,-19573.59 391.48,-19565.69 392.07,-19576.27 398.54,-19573.59"/>
</g>
<!-- layer5_expert_agg -->
<g id="node540" class="node">
<title>layer5_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="5929.05,-19433.5 5209.94,-19433.5 5024.95,-19297.5 5744.06,-19297.5 5929.05,-19433.5"/>
<text text-anchor="middle" x="5477" y="-19384.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5477" y="-19369.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x16)</text>
<text text-anchor="middle" x="5477" y="-19354.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-19339.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer5_gpu0_token_send&#45;&gt;layer5_expert_agg -->
<g id="edge539" class="edge">
<title>layer5_gpu0_token_send&#45;&gt;layer5_expert_agg</title>
<path fill="none" stroke="black" d="M610.99,-19481.96C652.59,-19477 695.49,-19472.55 736,-19469.5 1584.6,-19405.58 4154.44,-19377.72 5112.12,-19369.37"/>
<polygon fill="black" stroke="black" points="5112.29,-19372.87 5122.26,-19369.28 5112.23,-19365.87 5112.29,-19372.87"/>
</g>
<!-- layer5_gpu1_expert_mlp1 -->
<g id="node466" class="node">
<title>layer5_gpu1_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="1456.5,-19877.66 995.5,-19877.66 995.5,-19809.66 1456.5,-19809.66 1456.5,-19877.66"/>
<text text-anchor="middle" x="1226" y="-19862.46" font-family="Times,serif" font-size="14.00">Expert 1 MLP1</text>
<text text-anchor="middle" x="1226" y="-19847.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1226" y="-19832.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1226" y="-19817.46" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer5_gpu1_token_recv&#45;&gt;layer5_gpu1_expert_mlp1 -->
<g id="edge541" class="edge">
<title>layer5_gpu1_token_recv&#45;&gt;layer5_gpu1_expert_mlp1</title>
<path fill="none" stroke="black" d="M1236.68,-19913.53C1235.36,-19905.05 1234,-19896.25 1232.7,-19887.89"/>
<polygon fill="black" stroke="black" points="1236.16,-19887.31 1231.16,-19877.97 1229.24,-19888.39 1236.16,-19887.31"/>
</g>
<!-- layer5_gpu1_expert_act -->
<g id="node467" class="node">
<title>layer5_gpu1_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="1378.5,-19773.66 1001.5,-19773.66 1001.5,-19705.66 1378.5,-19705.66 1378.5,-19773.66"/>
<text text-anchor="middle" x="1190" y="-19758.46" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1190" y="-19743.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1190" y="-19728.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1190" y="-19713.46" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer5_gpu1_expert_mlp1&#45;&gt;layer5_gpu1_expert_act -->
<g id="edge542" class="edge">
<title>layer5_gpu1_expert_mlp1&#45;&gt;layer5_gpu1_expert_act</title>
<path fill="none" stroke="black" d="M1214.31,-19809.55C1211.39,-19801.26 1208.21,-19792.26 1205.15,-19783.57"/>
<polygon fill="black" stroke="black" points="1208.38,-19782.23 1201.75,-19773.96 1201.78,-19784.56 1208.38,-19782.23"/>
</g>
<!-- layer5_gpu1_expert_mlp2 -->
<g id="node468" class="node">
<title>layer5_gpu1_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="1358.5,-19669.66 951.5,-19669.66 951.5,-19601.66 1358.5,-19601.66 1358.5,-19669.66"/>
<text text-anchor="middle" x="1155" y="-19654.46" font-family="Times,serif" font-size="14.00">Expert 1 MLP2</text>
<text text-anchor="middle" x="1155" y="-19639.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1155" y="-19624.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1155" y="-19609.46" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer5_gpu1_expert_act&#45;&gt;layer5_gpu1_expert_mlp2 -->
<g id="edge543" class="edge">
<title>layer5_gpu1_expert_act&#45;&gt;layer5_gpu1_expert_mlp2</title>
<path fill="none" stroke="black" d="M1178.64,-19705.55C1175.79,-19697.26 1172.7,-19688.26 1169.72,-19679.57"/>
<polygon fill="black" stroke="black" points="1172.98,-19678.29 1166.43,-19669.96 1166.36,-19680.56 1172.98,-19678.29"/>
</g>
<!-- layer5_gpu1_token_send -->
<g id="node469" class="node">
<title>layer5_gpu1_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1101" cy="-19517.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1101" y="-19536.38" font-family="Times,serif" font-size="14.00">Token Send GPU1</text>
<text text-anchor="middle" x="1101" y="-19521.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1101" y="-19506.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1101" y="-19491.38" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer5_gpu1_expert_mlp2&#45;&gt;layer5_gpu1_token_send -->
<g id="edge544" class="edge">
<title>layer5_gpu1_expert_mlp2&#45;&gt;layer5_gpu1_token_send</title>
<path fill="none" stroke="black" d="M1139.53,-19601.4C1135.69,-19593.14 1131.46,-19584.07 1127.26,-19575.04"/>
<polygon fill="black" stroke="black" points="1130.31,-19573.28 1122.91,-19565.69 1123.96,-19576.23 1130.31,-19573.28"/>
</g>
<!-- layer5_gpu1_token_send&#45;&gt;layer5_expert_agg -->
<g id="edge545" class="edge">
<title>layer5_gpu1_token_send&#45;&gt;layer5_expert_agg</title>
<path fill="none" stroke="black" d="M1340.98,-19481.98C1382.27,-19477.05 1424.82,-19472.6 1465,-19469.5 2167.7,-19415.18 4265.31,-19382.39 5114.3,-19371.02"/>
<polygon fill="black" stroke="black" points="5114.59,-19374.52 5124.54,-19370.88 5114.49,-19367.52 5114.59,-19374.52"/>
</g>
<!-- layer5_gpu2_expert_mlp1 -->
<g id="node471" class="node">
<title>layer5_gpu2_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2162.5,-19877.66 1701.5,-19877.66 1701.5,-19809.66 2162.5,-19809.66 2162.5,-19877.66"/>
<text text-anchor="middle" x="1932" y="-19862.46" font-family="Times,serif" font-size="14.00">Expert 2 MLP1</text>
<text text-anchor="middle" x="1932" y="-19847.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1932" y="-19832.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1932" y="-19817.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer5_gpu2_token_recv&#45;&gt;layer5_gpu2_expert_mlp1 -->
<g id="edge547" class="edge">
<title>layer5_gpu2_token_recv&#45;&gt;layer5_gpu2_expert_mlp1</title>
<path fill="none" stroke="black" d="M1949.8,-19913.53C1947.61,-19905.05 1945.33,-19896.25 1943.17,-19887.89"/>
<polygon fill="black" stroke="black" points="1946.5,-19886.77 1940.61,-19877.97 1939.72,-19888.52 1946.5,-19886.77"/>
</g>
<!-- layer5_gpu2_expert_act -->
<g id="node472" class="node">
<title>layer5_gpu2_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2092.5,-19773.66 1715.5,-19773.66 1715.5,-19705.66 2092.5,-19705.66 2092.5,-19773.66"/>
<text text-anchor="middle" x="1904" y="-19758.46" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="1904" y="-19743.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1904" y="-19728.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1904" y="-19713.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer5_gpu2_expert_mlp1&#45;&gt;layer5_gpu2_expert_act -->
<g id="edge548" class="edge">
<title>layer5_gpu2_expert_mlp1&#45;&gt;layer5_gpu2_expert_act</title>
<path fill="none" stroke="black" d="M1922.91,-19809.55C1920.66,-19801.35 1918.22,-19792.45 1915.86,-19783.86"/>
<polygon fill="black" stroke="black" points="1919.16,-19782.68 1913.14,-19773.96 1912.41,-19784.53 1919.16,-19782.68"/>
</g>
<!-- layer5_gpu2_expert_mlp2 -->
<g id="node473" class="node">
<title>layer5_gpu2_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2077.5,-19669.66 1670.5,-19669.66 1670.5,-19601.66 2077.5,-19601.66 2077.5,-19669.66"/>
<text text-anchor="middle" x="1874" y="-19654.46" font-family="Times,serif" font-size="14.00">Expert 2 MLP2</text>
<text text-anchor="middle" x="1874" y="-19639.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1874" y="-19624.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1874" y="-19609.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer5_gpu2_expert_act&#45;&gt;layer5_gpu2_expert_mlp2 -->
<g id="edge549" class="edge">
<title>layer5_gpu2_expert_act&#45;&gt;layer5_gpu2_expert_mlp2</title>
<path fill="none" stroke="black" d="M1894.26,-19705.55C1891.82,-19697.26 1889.18,-19688.26 1886.62,-19679.57"/>
<polygon fill="black" stroke="black" points="1889.97,-19678.57 1883.79,-19669.96 1883.26,-19680.54 1889.97,-19678.57"/>
</g>
<!-- layer5_gpu2_token_send -->
<g id="node474" class="node">
<title>layer5_gpu2_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1830" cy="-19517.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1830" y="-19536.38" font-family="Times,serif" font-size="14.00">Token Send GPU2</text>
<text text-anchor="middle" x="1830" y="-19521.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1830" y="-19506.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1830" y="-19491.38" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer5_gpu2_expert_mlp2&#45;&gt;layer5_gpu2_token_send -->
<g id="edge550" class="edge">
<title>layer5_gpu2_expert_mlp2&#45;&gt;layer5_gpu2_token_send</title>
<path fill="none" stroke="black" d="M1861.39,-19601.4C1858.26,-19593.14 1854.82,-19584.07 1851.4,-19575.04"/>
<polygon fill="black" stroke="black" points="1854.67,-19573.8 1847.86,-19565.69 1848.13,-19576.28 1854.67,-19573.8"/>
</g>
<!-- layer5_gpu2_token_send&#45;&gt;layer5_expert_agg -->
<g id="edge551" class="edge">
<title>layer5_gpu2_token_send&#45;&gt;layer5_expert_agg</title>
<path fill="none" stroke="black" d="M2070.48,-19482.12C2111.62,-19477.19 2153.98,-19472.71 2194,-19469.5 3249.04,-19384.91 4499.98,-19368.84 5108.15,-19366.39"/>
<polygon fill="black" stroke="black" points="5108.41,-19369.89 5118.39,-19366.35 5108.38,-19362.89 5108.41,-19369.89"/>
</g>
<!-- layer5_gpu3_expert_mlp1 -->
<g id="node476" class="node">
<title>layer5_gpu3_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2864.5,-19877.66 2403.5,-19877.66 2403.5,-19809.66 2864.5,-19809.66 2864.5,-19877.66"/>
<text text-anchor="middle" x="2634" y="-19862.46" font-family="Times,serif" font-size="14.00">Expert 3 MLP1</text>
<text text-anchor="middle" x="2634" y="-19847.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2634" y="-19832.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2634" y="-19817.46" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer5_gpu3_token_recv&#45;&gt;layer5_gpu3_expert_mlp1 -->
<g id="edge553" class="edge">
<title>layer5_gpu3_token_recv&#45;&gt;layer5_gpu3_expert_mlp1</title>
<path fill="none" stroke="black" d="M2652.39,-19913.53C2650.13,-19905.05 2647.78,-19896.25 2645.54,-19887.89"/>
<polygon fill="black" stroke="black" points="2648.86,-19886.73 2642.89,-19877.97 2642.09,-19888.53 2648.86,-19886.73"/>
</g>
<!-- layer5_gpu3_expert_act -->
<g id="node477" class="node">
<title>layer5_gpu3_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2791.5,-19773.66 2414.5,-19773.66 2414.5,-19705.66 2791.5,-19705.66 2791.5,-19773.66"/>
<text text-anchor="middle" x="2603" y="-19758.46" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="2603" y="-19743.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2603" y="-19728.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2603" y="-19713.46" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer5_gpu3_expert_mlp1&#45;&gt;layer5_gpu3_expert_act -->
<g id="edge554" class="edge">
<title>layer5_gpu3_expert_mlp1&#45;&gt;layer5_gpu3_expert_act</title>
<path fill="none" stroke="black" d="M2623.94,-19809.55C2621.42,-19801.26 2618.68,-19792.26 2616.04,-19783.57"/>
<polygon fill="black" stroke="black" points="2619.38,-19782.51 2613.12,-19773.96 2612.68,-19784.55 2619.38,-19782.51"/>
</g>
<!-- layer5_gpu3_expert_mlp2 -->
<g id="node478" class="node">
<title>layer5_gpu3_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2790.5,-19669.66 2383.5,-19669.66 2383.5,-19601.66 2790.5,-19601.66 2790.5,-19669.66"/>
<text text-anchor="middle" x="2587" y="-19654.46" font-family="Times,serif" font-size="14.00">Expert 3 MLP2</text>
<text text-anchor="middle" x="2587" y="-19639.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2587" y="-19624.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="2587" y="-19609.46" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer5_gpu3_expert_act&#45;&gt;layer5_gpu3_expert_mlp2 -->
<g id="edge555" class="edge">
<title>layer5_gpu3_expert_act&#45;&gt;layer5_gpu3_expert_mlp2</title>
<path fill="none" stroke="black" d="M2597.81,-19705.55C2596.52,-19697.35 2595.12,-19688.45 2593.78,-19679.86"/>
<polygon fill="black" stroke="black" points="2597.23,-19679.3 2592.22,-19669.96 2590.32,-19680.38 2597.23,-19679.3"/>
</g>
<!-- layer5_gpu3_token_send -->
<g id="node479" class="node">
<title>layer5_gpu3_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="2559" cy="-19517.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="2559" y="-19536.38" font-family="Times,serif" font-size="14.00">Token Send GPU3</text>
<text text-anchor="middle" x="2559" y="-19521.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="2559" y="-19506.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="2559" y="-19491.38" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer5_gpu3_expert_mlp2&#45;&gt;layer5_gpu3_token_send -->
<g id="edge556" class="edge">
<title>layer5_gpu3_expert_mlp2&#45;&gt;layer5_gpu3_token_send</title>
<path fill="none" stroke="black" d="M2578.98,-19601.4C2577.03,-19593.32 2574.89,-19584.45 2572.76,-19575.61"/>
<polygon fill="black" stroke="black" points="2576.11,-19574.59 2570.36,-19565.69 2569.31,-19576.23 2576.11,-19574.59"/>
</g>
<!-- layer5_gpu3_token_send&#45;&gt;layer5_expert_agg -->
<g id="edge557" class="edge">
<title>layer5_gpu3_token_send&#45;&gt;layer5_expert_agg</title>
<path fill="none" stroke="black" d="M2800.98,-19482.25C2841.65,-19477.35 2883.48,-19472.84 2923,-19469.5 3702.23,-19403.52 4618.9,-19379.57 5114.54,-19371.05"/>
<polygon fill="black" stroke="black" points="5114.77,-19374.54 5124.71,-19370.87 5114.65,-19367.55 5114.77,-19374.54"/>
</g>
<!-- layer5_gpu4_expert_mlp1 -->
<g id="node481" class="node">
<title>layer5_gpu4_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="3579.5,-19877.66 3118.5,-19877.66 3118.5,-19809.66 3579.5,-19809.66 3579.5,-19877.66"/>
<text text-anchor="middle" x="3349" y="-19862.46" font-family="Times,serif" font-size="14.00">Expert 4 MLP1</text>
<text text-anchor="middle" x="3349" y="-19847.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3349" y="-19832.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3349" y="-19817.46" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer5_gpu4_token_recv&#45;&gt;layer5_gpu4_expert_mlp1 -->
<g id="edge559" class="edge">
<title>layer5_gpu4_token_recv&#45;&gt;layer5_gpu4_expert_mlp1</title>
<path fill="none" stroke="black" d="M3360.27,-19913.53C3358.88,-19905.05 3357.44,-19896.25 3356.08,-19887.89"/>
<polygon fill="black" stroke="black" points="3359.52,-19887.27 3354.45,-19877.97 3352.61,-19888.4 3359.52,-19887.27"/>
</g>
<!-- layer5_gpu4_expert_act -->
<g id="node482" class="node">
<title>layer5_gpu4_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="3527.5,-19773.66 3150.5,-19773.66 3150.5,-19705.66 3527.5,-19705.66 3527.5,-19773.66"/>
<text text-anchor="middle" x="3339" y="-19758.46" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="3339" y="-19743.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3339" y="-19728.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3339" y="-19713.46" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer5_gpu4_expert_mlp1&#45;&gt;layer5_gpu4_expert_act -->
<g id="edge560" class="edge">
<title>layer5_gpu4_expert_mlp1&#45;&gt;layer5_gpu4_expert_act</title>
<path fill="none" stroke="black" d="M3345.75,-19809.55C3344.96,-19801.44 3344.1,-19792.65 3343.26,-19784.14"/>
<polygon fill="black" stroke="black" points="3346.72,-19783.57 3342.26,-19773.96 3339.76,-19784.26 3346.72,-19783.57"/>
</g>
<!-- layer5_gpu4_expert_mlp2 -->
<g id="node483" class="node">
<title>layer5_gpu4_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="3524.5,-19669.66 3117.5,-19669.66 3117.5,-19601.66 3524.5,-19601.66 3524.5,-19669.66"/>
<text text-anchor="middle" x="3321" y="-19654.46" font-family="Times,serif" font-size="14.00">Expert 4 MLP2</text>
<text text-anchor="middle" x="3321" y="-19639.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3321" y="-19624.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="3321" y="-19609.46" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer5_gpu4_expert_act&#45;&gt;layer5_gpu4_expert_mlp2 -->
<g id="edge561" class="edge">
<title>layer5_gpu4_expert_act&#45;&gt;layer5_gpu4_expert_mlp2</title>
<path fill="none" stroke="black" d="M3333.16,-19705.55C3331.71,-19697.35 3330.14,-19688.45 3328.62,-19679.86"/>
<polygon fill="black" stroke="black" points="3332.06,-19679.2 3326.88,-19669.96 3325.17,-19680.42 3332.06,-19679.2"/>
</g>
<!-- layer5_gpu4_token_send -->
<g id="node484" class="node">
<title>layer5_gpu4_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="3288" cy="-19517.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="3288" y="-19536.38" font-family="Times,serif" font-size="14.00">Token Send GPU4</text>
<text text-anchor="middle" x="3288" y="-19521.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="3288" y="-19506.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="3288" y="-19491.38" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer5_gpu4_expert_mlp2&#45;&gt;layer5_gpu4_token_send -->
<g id="edge562" class="edge">
<title>layer5_gpu4_expert_mlp2&#45;&gt;layer5_gpu4_token_send</title>
<path fill="none" stroke="black" d="M3311.54,-19601.4C3309.22,-19593.23 3306.67,-19584.26 3304.13,-19575.33"/>
<polygon fill="black" stroke="black" points="3307.49,-19574.35 3301.39,-19565.69 3300.76,-19576.27 3307.49,-19574.35"/>
</g>
<!-- layer5_gpu4_token_send&#45;&gt;layer5_expert_agg -->
<g id="edge563" class="edge">
<title>layer5_gpu4_token_send&#45;&gt;layer5_expert_agg</title>
<path fill="none" stroke="black" d="M3531.99,-19482.55C3572.03,-19477.68 3613.14,-19473.1 3652,-19469.5 4162.99,-19422.09 4756.65,-19393.48 5124.62,-19378.83"/>
<polygon fill="black" stroke="black" points="5124.78,-19382.33 5134.63,-19378.43 5124.5,-19375.33 5124.78,-19382.33"/>
</g>
<!-- layer5_gpu5_expert_mlp1 -->
<g id="node486" class="node">
<title>layer5_gpu5_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4290.5,-19877.66 3829.5,-19877.66 3829.5,-19809.66 4290.5,-19809.66 4290.5,-19877.66"/>
<text text-anchor="middle" x="4060" y="-19862.46" font-family="Times,serif" font-size="14.00">Expert 5 MLP1</text>
<text text-anchor="middle" x="4060" y="-19847.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4060" y="-19832.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4060" y="-19817.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_gpu5_token_recv&#45;&gt;layer5_gpu5_expert_mlp1 -->
<g id="edge565" class="edge">
<title>layer5_gpu5_token_recv&#45;&gt;layer5_gpu5_expert_mlp1</title>
<path fill="none" stroke="black" d="M4069.49,-19913.53C4068.32,-19905.05 4067.11,-19896.25 4065.96,-19887.89"/>
<polygon fill="black" stroke="black" points="4069.42,-19887.4 4064.59,-19877.97 4062.49,-19888.35 4069.42,-19887.4"/>
</g>
<!-- layer5_gpu5_expert_act -->
<g id="node487" class="node">
<title>layer5_gpu5_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4217.5,-19773.66 3840.5,-19773.66 3840.5,-19705.66 4217.5,-19705.66 4217.5,-19773.66"/>
<text text-anchor="middle" x="4029" y="-19758.46" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="4029" y="-19743.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4029" y="-19728.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4029" y="-19713.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_gpu5_expert_mlp1&#45;&gt;layer5_gpu5_expert_act -->
<g id="edge566" class="edge">
<title>layer5_gpu5_expert_mlp1&#45;&gt;layer5_gpu5_expert_act</title>
<path fill="none" stroke="black" d="M4049.94,-19809.55C4047.42,-19801.26 4044.68,-19792.26 4042.04,-19783.57"/>
<polygon fill="black" stroke="black" points="4045.38,-19782.51 4039.12,-19773.96 4038.68,-19784.55 4045.38,-19782.51"/>
</g>
<!-- layer5_gpu5_expert_mlp2 -->
<g id="node488" class="node">
<title>layer5_gpu5_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4228.5,-19669.66 3821.5,-19669.66 3821.5,-19601.66 4228.5,-19601.66 4228.5,-19669.66"/>
<text text-anchor="middle" x="4025" y="-19654.46" font-family="Times,serif" font-size="14.00">Expert 5 MLP2</text>
<text text-anchor="middle" x="4025" y="-19639.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4025" y="-19624.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4025" y="-19609.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_gpu5_expert_act&#45;&gt;layer5_gpu5_expert_mlp2 -->
<g id="edge567" class="edge">
<title>layer5_gpu5_expert_act&#45;&gt;layer5_gpu5_expert_mlp2</title>
<path fill="none" stroke="black" d="M4027.7,-19705.55C4027.38,-19697.44 4027.04,-19688.65 4026.7,-19680.14"/>
<polygon fill="black" stroke="black" points="4030.2,-19679.82 4026.31,-19669.96 4023.2,-19680.09 4030.2,-19679.82"/>
</g>
<!-- layer5_gpu5_token_send -->
<g id="node489" class="node">
<title>layer5_gpu5_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4017" cy="-19517.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4017" y="-19536.38" font-family="Times,serif" font-size="14.00">Token Send GPU5</text>
<text text-anchor="middle" x="4017" y="-19521.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4017" y="-19506.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4017" y="-19491.38" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_gpu5_expert_mlp2&#45;&gt;layer5_gpu5_token_send -->
<g id="edge568" class="edge">
<title>layer5_gpu5_expert_mlp2&#45;&gt;layer5_gpu5_token_send</title>
<path fill="none" stroke="black" d="M4022.71,-19601.4C4022.16,-19593.41 4021.55,-19584.64 4020.95,-19575.9"/>
<polygon fill="black" stroke="black" points="4024.43,-19575.43 4020.25,-19565.69 4017.44,-19575.91 4024.43,-19575.43"/>
</g>
<!-- layer5_gpu5_token_send&#45;&gt;layer5_expert_agg -->
<g id="edge569" class="edge">
<title>layer5_gpu5_token_send&#45;&gt;layer5_expert_agg</title>
<path fill="none" stroke="black" d="M4266.02,-19483.19C4304.5,-19478.38 4343.8,-19473.65 4381,-19469.5 4637.39,-19440.88 4928.13,-19413.8 5145.7,-19394.6"/>
<polygon fill="black" stroke="black" points="5146.03,-19398.08 5155.68,-19393.72 5145.41,-19391.11 5146.03,-19398.08"/>
</g>
<!-- layer5_gpu6_expert_mlp1 -->
<g id="node491" class="node">
<title>layer5_gpu6_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4994.5,-19877.66 4533.5,-19877.66 4533.5,-19809.66 4994.5,-19809.66 4994.5,-19877.66"/>
<text text-anchor="middle" x="4764" y="-19862.46" font-family="Times,serif" font-size="14.00">Expert 6 MLP1</text>
<text text-anchor="middle" x="4764" y="-19847.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4764" y="-19832.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4764" y="-19817.46" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer5_gpu6_token_recv&#45;&gt;layer5_gpu6_expert_mlp1 -->
<g id="edge571" class="edge">
<title>layer5_gpu6_token_recv&#45;&gt;layer5_gpu6_expert_mlp1</title>
<path fill="none" stroke="black" d="M4766.97,-19913.53C4766.61,-19905.15 4766.23,-19896.45 4765.87,-19888.17"/>
<polygon fill="black" stroke="black" points="4769.36,-19887.81 4765.43,-19877.97 4762.37,-19888.11 4769.36,-19887.81"/>
</g>
<!-- layer5_gpu6_expert_act -->
<g id="node492" class="node">
<title>layer5_gpu6_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4942.5,-19773.66 4565.5,-19773.66 4565.5,-19705.66 4942.5,-19705.66 4942.5,-19773.66"/>
<text text-anchor="middle" x="4754" y="-19758.46" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="4754" y="-19743.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4754" y="-19728.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4754" y="-19713.46" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer5_gpu6_expert_mlp1&#45;&gt;layer5_gpu6_expert_act -->
<g id="edge572" class="edge">
<title>layer5_gpu6_expert_mlp1&#45;&gt;layer5_gpu6_expert_act</title>
<path fill="none" stroke="black" d="M4760.75,-19809.55C4759.96,-19801.44 4759.1,-19792.65 4758.26,-19784.14"/>
<polygon fill="black" stroke="black" points="4761.72,-19783.57 4757.26,-19773.96 4754.76,-19784.26 4761.72,-19783.57"/>
</g>
<!-- layer5_gpu6_expert_mlp2 -->
<g id="node493" class="node">
<title>layer5_gpu6_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4954.5,-19669.66 4547.5,-19669.66 4547.5,-19601.66 4954.5,-19601.66 4954.5,-19669.66"/>
<text text-anchor="middle" x="4751" y="-19654.46" font-family="Times,serif" font-size="14.00">Expert 6 MLP2</text>
<text text-anchor="middle" x="4751" y="-19639.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4751" y="-19624.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4751" y="-19609.46" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer5_gpu6_expert_act&#45;&gt;layer5_gpu6_expert_mlp2 -->
<g id="edge573" class="edge">
<title>layer5_gpu6_expert_act&#45;&gt;layer5_gpu6_expert_mlp2</title>
<path fill="none" stroke="black" d="M4753.03,-19705.55C4752.79,-19697.44 4752.53,-19688.65 4752.28,-19680.14"/>
<polygon fill="black" stroke="black" points="4755.77,-19679.86 4751.98,-19669.96 4748.77,-19680.06 4755.77,-19679.86"/>
</g>
<!-- layer5_gpu6_token_send -->
<g id="node494" class="node">
<title>layer5_gpu6_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4746" cy="-19517.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4746" y="-19536.38" font-family="Times,serif" font-size="14.00">Token Send GPU6</text>
<text text-anchor="middle" x="4746" y="-19521.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4746" y="-19506.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4746" y="-19491.38" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer5_gpu6_expert_mlp2&#45;&gt;layer5_gpu6_token_send -->
<g id="edge574" class="edge">
<title>layer5_gpu6_expert_mlp2&#45;&gt;layer5_gpu6_token_send</title>
<path fill="none" stroke="black" d="M4749.57,-19601.4C4749.22,-19593.41 4748.85,-19584.64 4748.47,-19575.9"/>
<polygon fill="black" stroke="black" points="4751.96,-19575.53 4748.03,-19565.69 4744.96,-19575.83 4751.96,-19575.53"/>
</g>
<!-- layer5_gpu6_token_send&#45;&gt;layer5_expert_agg -->
<g id="edge575" class="edge">
<title>layer5_gpu6_token_send&#45;&gt;layer5_expert_agg</title>
<path fill="none" stroke="black" d="M4938.54,-19477.05C5014.53,-19461.45 5103.48,-19443.19 5186.94,-19426.05"/>
<polygon fill="black" stroke="black" points="5187.74,-19429.46 5196.83,-19424.02 5186.33,-19422.6 5187.74,-19429.46"/>
</g>
<!-- layer5_gpu7_expert_mlp1 -->
<g id="node496" class="node">
<title>layer5_gpu7_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5707.5,-19877.66 5246.5,-19877.66 5246.5,-19809.66 5707.5,-19809.66 5707.5,-19877.66"/>
<text text-anchor="middle" x="5477" y="-19862.46" font-family="Times,serif" font-size="14.00">Expert 7 MLP1</text>
<text text-anchor="middle" x="5477" y="-19847.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5477" y="-19832.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5477" y="-19817.46" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer5_gpu7_token_recv&#45;&gt;layer5_gpu7_expert_mlp1 -->
<g id="edge577" class="edge">
<title>layer5_gpu7_token_recv&#45;&gt;layer5_gpu7_expert_mlp1</title>
<path fill="none" stroke="black" d="M5477,-19913.53C5477,-19905.15 5477,-19896.45 5477,-19888.17"/>
<polygon fill="black" stroke="black" points="5480.5,-19887.97 5477,-19877.97 5473.5,-19887.97 5480.5,-19887.97"/>
</g>
<!-- layer5_gpu7_expert_act -->
<g id="node497" class="node">
<title>layer5_gpu7_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="5665.5,-19773.66 5288.5,-19773.66 5288.5,-19705.66 5665.5,-19705.66 5665.5,-19773.66"/>
<text text-anchor="middle" x="5477" y="-19758.46" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="5477" y="-19743.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5477" y="-19728.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5477" y="-19713.46" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer5_gpu7_expert_mlp1&#45;&gt;layer5_gpu7_expert_act -->
<g id="edge578" class="edge">
<title>layer5_gpu7_expert_mlp1&#45;&gt;layer5_gpu7_expert_act</title>
<path fill="none" stroke="black" d="M5477,-19809.55C5477,-19801.44 5477,-19792.65 5477,-19784.14"/>
<polygon fill="black" stroke="black" points="5480.5,-19783.96 5477,-19773.96 5473.5,-19783.96 5480.5,-19783.96"/>
</g>
<!-- layer5_gpu7_expert_mlp2 -->
<g id="node498" class="node">
<title>layer5_gpu7_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="5680.5,-19669.66 5273.5,-19669.66 5273.5,-19601.66 5680.5,-19601.66 5680.5,-19669.66"/>
<text text-anchor="middle" x="5477" y="-19654.46" font-family="Times,serif" font-size="14.00">Expert 7 MLP2</text>
<text text-anchor="middle" x="5477" y="-19639.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5477" y="-19624.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-19609.46" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer5_gpu7_expert_act&#45;&gt;layer5_gpu7_expert_mlp2 -->
<g id="edge579" class="edge">
<title>layer5_gpu7_expert_act&#45;&gt;layer5_gpu7_expert_mlp2</title>
<path fill="none" stroke="black" d="M5477,-19705.55C5477,-19697.44 5477,-19688.65 5477,-19680.14"/>
<polygon fill="black" stroke="black" points="5480.5,-19679.96 5477,-19669.96 5473.5,-19679.96 5480.5,-19679.96"/>
</g>
<!-- layer5_gpu7_token_send -->
<g id="node499" class="node">
<title>layer5_gpu7_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="5475" cy="-19517.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="5475" y="-19536.38" font-family="Times,serif" font-size="14.00">Token Send GPU7</text>
<text text-anchor="middle" x="5475" y="-19521.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="5475" y="-19506.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="5475" y="-19491.38" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer5_gpu7_expert_mlp2&#45;&gt;layer5_gpu7_token_send -->
<g id="edge580" class="edge">
<title>layer5_gpu7_expert_mlp2&#45;&gt;layer5_gpu7_token_send</title>
<path fill="none" stroke="black" d="M5476.43,-19601.4C5476.29,-19593.41 5476.14,-19584.64 5475.99,-19575.9"/>
<polygon fill="black" stroke="black" points="5479.48,-19575.63 5475.81,-19565.69 5472.48,-19575.75 5479.48,-19575.63"/>
</g>
<!-- layer5_gpu7_token_send&#45;&gt;layer5_expert_agg -->
<g id="edge581" class="edge">
<title>layer5_gpu7_token_send&#45;&gt;layer5_expert_agg</title>
<path fill="none" stroke="black" d="M5475.63,-19469.09C5475.74,-19461.01 5475.85,-19452.43 5475.97,-19443.8"/>
<polygon fill="black" stroke="black" points="5479.47,-19443.74 5476.1,-19433.69 5472.47,-19443.64 5479.47,-19443.74"/>
</g>
<!-- layer5_gpu8_expert_mlp1 -->
<g id="node501" class="node">
<title>layer5_gpu8_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="6400.5,-19877.66 5939.5,-19877.66 5939.5,-19809.66 6400.5,-19809.66 6400.5,-19877.66"/>
<text text-anchor="middle" x="6170" y="-19862.46" font-family="Times,serif" font-size="14.00">Expert 8 MLP1</text>
<text text-anchor="middle" x="6170" y="-19847.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6170" y="-19832.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6170" y="-19817.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer5_gpu8_token_recv&#45;&gt;layer5_gpu8_expert_mlp1 -->
<g id="edge583" class="edge">
<title>layer5_gpu8_token_recv&#45;&gt;layer5_gpu8_expert_mlp1</title>
<path fill="none" stroke="black" d="M6167.03,-19913.53C6167.39,-19905.15 6167.77,-19896.45 6168.13,-19888.17"/>
<polygon fill="black" stroke="black" points="6171.63,-19888.11 6168.57,-19877.97 6164.64,-19887.81 6171.63,-19888.11"/>
</g>
<!-- layer5_gpu8_expert_act -->
<g id="node502" class="node">
<title>layer5_gpu8_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="6368.5,-19773.66 5991.5,-19773.66 5991.5,-19705.66 6368.5,-19705.66 6368.5,-19773.66"/>
<text text-anchor="middle" x="6180" y="-19758.46" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="6180" y="-19743.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6180" y="-19728.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6180" y="-19713.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer5_gpu8_expert_mlp1&#45;&gt;layer5_gpu8_expert_act -->
<g id="edge584" class="edge">
<title>layer5_gpu8_expert_mlp1&#45;&gt;layer5_gpu8_expert_act</title>
<path fill="none" stroke="black" d="M6173.25,-19809.55C6174.04,-19801.44 6174.9,-19792.65 6175.74,-19784.14"/>
<polygon fill="black" stroke="black" points="6179.24,-19784.26 6176.74,-19773.96 6172.28,-19783.57 6179.24,-19784.26"/>
</g>
<!-- layer5_gpu8_expert_mlp2 -->
<g id="node503" class="node">
<title>layer5_gpu8_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="6387.5,-19669.66 5980.5,-19669.66 5980.5,-19601.66 6387.5,-19601.66 6387.5,-19669.66"/>
<text text-anchor="middle" x="6184" y="-19654.46" font-family="Times,serif" font-size="14.00">Expert 8 MLP2</text>
<text text-anchor="middle" x="6184" y="-19639.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6184" y="-19624.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6184" y="-19609.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer5_gpu8_expert_act&#45;&gt;layer5_gpu8_expert_mlp2 -->
<g id="edge585" class="edge">
<title>layer5_gpu8_expert_act&#45;&gt;layer5_gpu8_expert_mlp2</title>
<path fill="none" stroke="black" d="M6181.3,-19705.55C6181.62,-19697.44 6181.96,-19688.65 6182.3,-19680.14"/>
<polygon fill="black" stroke="black" points="6185.8,-19680.09 6182.69,-19669.96 6178.8,-19679.82 6185.8,-19680.09"/>
</g>
<!-- layer5_gpu8_token_send -->
<g id="node504" class="node">
<title>layer5_gpu8_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6204" cy="-19517.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6204" y="-19536.38" font-family="Times,serif" font-size="14.00">Token Send GPU8</text>
<text text-anchor="middle" x="6204" y="-19521.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6204" y="-19506.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6204" y="-19491.38" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer5_gpu8_expert_mlp2&#45;&gt;layer5_gpu8_token_send -->
<g id="edge586" class="edge">
<title>layer5_gpu8_expert_mlp2&#45;&gt;layer5_gpu8_token_send</title>
<path fill="none" stroke="black" d="M6189.73,-19601.4C6191.12,-19593.32 6192.65,-19584.45 6194.17,-19575.61"/>
<polygon fill="black" stroke="black" points="6197.63,-19576.14 6195.88,-19565.69 6190.74,-19574.95 6197.63,-19576.14"/>
</g>
<!-- layer5_gpu8_token_send&#45;&gt;layer5_expert_agg -->
<g id="edge587" class="edge">
<title>layer5_gpu8_token_send&#45;&gt;layer5_expert_agg</title>
<path fill="none" stroke="black" d="M6012.51,-19477.05C5950.86,-19464.32 5880.64,-19449.82 5811.79,-19435.61"/>
<polygon fill="black" stroke="black" points="5812.14,-19432.11 5801.64,-19433.52 5810.73,-19438.97 5812.14,-19432.11"/>
</g>
<!-- layer5_gpu9_expert_mlp1 -->
<g id="node506" class="node">
<title>layer5_gpu9_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7092.5,-19877.66 6631.5,-19877.66 6631.5,-19809.66 7092.5,-19809.66 7092.5,-19877.66"/>
<text text-anchor="middle" x="6862" y="-19862.46" font-family="Times,serif" font-size="14.00">Expert 9 MLP1</text>
<text text-anchor="middle" x="6862" y="-19847.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6862" y="-19832.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6862" y="-19817.46" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer5_gpu9_token_recv&#45;&gt;layer5_gpu9_expert_mlp1 -->
<g id="edge589" class="edge">
<title>layer5_gpu9_token_recv&#45;&gt;layer5_gpu9_expert_mlp1</title>
<path fill="none" stroke="black" d="M6856.07,-19913.53C6856.79,-19905.15 6857.54,-19896.45 6858.25,-19888.17"/>
<polygon fill="black" stroke="black" points="6861.76,-19888.23 6859.13,-19877.97 6854.79,-19887.63 6861.76,-19888.23"/>
</g>
<!-- layer5_gpu9_expert_act -->
<g id="node507" class="node">
<title>layer5_gpu9_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7071.5,-19773.66 6694.5,-19773.66 6694.5,-19705.66 7071.5,-19705.66 7071.5,-19773.66"/>
<text text-anchor="middle" x="6883" y="-19758.46" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="6883" y="-19743.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6883" y="-19728.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6883" y="-19713.46" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer5_gpu9_expert_mlp1&#45;&gt;layer5_gpu9_expert_act -->
<g id="edge590" class="edge">
<title>layer5_gpu9_expert_mlp1&#45;&gt;layer5_gpu9_expert_act</title>
<path fill="none" stroke="black" d="M6868.82,-19809.55C6870.51,-19801.35 6872.34,-19792.45 6874.11,-19783.86"/>
<polygon fill="black" stroke="black" points="6877.56,-19784.46 6876.14,-19773.96 6870.7,-19783.05 6877.56,-19784.46"/>
</g>
<!-- layer5_gpu9_expert_mlp2 -->
<g id="node508" class="node">
<title>layer5_gpu9_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7127.5,-19669.66 6720.5,-19669.66 6720.5,-19601.66 7127.5,-19601.66 7127.5,-19669.66"/>
<text text-anchor="middle" x="6924" y="-19654.46" font-family="Times,serif" font-size="14.00">Expert 9 MLP2</text>
<text text-anchor="middle" x="6924" y="-19639.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6924" y="-19624.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6924" y="-19609.46" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer5_gpu9_expert_act&#45;&gt;layer5_gpu9_expert_mlp2 -->
<g id="edge591" class="edge">
<title>layer5_gpu9_expert_act&#45;&gt;layer5_gpu9_expert_mlp2</title>
<path fill="none" stroke="black" d="M6896.31,-19705.55C6899.68,-19697.17 6903.34,-19688.06 6906.86,-19679.29"/>
<polygon fill="black" stroke="black" points="6910.13,-19680.55 6910.61,-19669.96 6903.64,-19677.94 6910.13,-19680.55"/>
</g>
<!-- layer5_gpu9_token_send -->
<g id="node509" class="node">
<title>layer5_gpu9_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6933" cy="-19517.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6933" y="-19536.38" font-family="Times,serif" font-size="14.00">Token Send GPU9</text>
<text text-anchor="middle" x="6933" y="-19521.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6933" y="-19506.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6933" y="-19491.38" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer5_gpu9_expert_mlp2&#45;&gt;layer5_gpu9_token_send -->
<g id="edge592" class="edge">
<title>layer5_gpu9_expert_mlp2&#45;&gt;layer5_gpu9_token_send</title>
<path fill="none" stroke="black" d="M6926.58,-19601.4C6927.2,-19593.41 6927.88,-19584.64 6928.56,-19575.9"/>
<polygon fill="black" stroke="black" points="6932.06,-19575.93 6929.35,-19565.69 6925.08,-19575.39 6932.06,-19575.93"/>
</g>
<!-- layer5_gpu9_token_send&#45;&gt;layer5_expert_agg -->
<g id="edge593" class="edge">
<title>layer5_gpu9_token_send&#45;&gt;layer5_expert_agg</title>
<path fill="none" stroke="black" d="M6683.98,-19483.21C6645.5,-19478.39 6606.2,-19473.66 6569,-19469.5 6347.19,-19444.7 6099.58,-19421.02 5896.29,-19402.63"/>
<polygon fill="black" stroke="black" points="5896.31,-19399.11 5886.03,-19401.7 5895.68,-19406.09 5896.31,-19399.11"/>
</g>
<!-- layer5_gpu10_expert_mlp1 -->
<g id="node511" class="node">
<title>layer5_gpu10_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7783.5,-19877.66 7322.5,-19877.66 7322.5,-19809.66 7783.5,-19809.66 7783.5,-19877.66"/>
<text text-anchor="middle" x="7553" y="-19862.46" font-family="Times,serif" font-size="14.00">Expert 10 MLP1</text>
<text text-anchor="middle" x="7553" y="-19847.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7553" y="-19832.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7553" y="-19817.46" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer5_gpu10_token_recv&#45;&gt;layer5_gpu10_expert_mlp1 -->
<g id="edge595" class="edge">
<title>layer5_gpu10_token_recv&#45;&gt;layer5_gpu10_expert_mlp1</title>
<path fill="none" stroke="black" d="M7544.69,-19913.53C7545.71,-19905.15 7546.75,-19896.45 7547.75,-19888.17"/>
<polygon fill="black" stroke="black" points="7551.26,-19888.31 7548.98,-19877.97 7544.31,-19887.48 7551.26,-19888.31"/>
</g>
<!-- layer5_gpu10_expert_act -->
<g id="node512" class="node">
<title>layer5_gpu10_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7772.5,-19773.66 7395.5,-19773.66 7395.5,-19705.66 7772.5,-19705.66 7772.5,-19773.66"/>
<text text-anchor="middle" x="7584" y="-19758.46" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="7584" y="-19743.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7584" y="-19728.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7584" y="-19713.46" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer5_gpu10_expert_mlp1&#45;&gt;layer5_gpu10_expert_act -->
<g id="edge596" class="edge">
<title>layer5_gpu10_expert_mlp1&#45;&gt;layer5_gpu10_expert_act</title>
<path fill="none" stroke="black" d="M7563.06,-19809.55C7565.58,-19801.26 7568.32,-19792.26 7570.96,-19783.57"/>
<polygon fill="black" stroke="black" points="7574.32,-19784.55 7573.88,-19773.96 7567.62,-19782.51 7574.32,-19784.55"/>
</g>
<!-- layer5_gpu10_expert_mlp2 -->
<g id="node513" class="node">
<title>layer5_gpu10_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7803.5,-19669.66 7396.5,-19669.66 7396.5,-19601.66 7803.5,-19601.66 7803.5,-19669.66"/>
<text text-anchor="middle" x="7600" y="-19654.46" font-family="Times,serif" font-size="14.00">Expert 10 MLP2</text>
<text text-anchor="middle" x="7600" y="-19639.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7600" y="-19624.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="7600" y="-19609.46" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer5_gpu10_expert_act&#45;&gt;layer5_gpu10_expert_mlp2 -->
<g id="edge597" class="edge">
<title>layer5_gpu10_expert_act&#45;&gt;layer5_gpu10_expert_mlp2</title>
<path fill="none" stroke="black" d="M7589.19,-19705.55C7590.48,-19697.35 7591.88,-19688.45 7593.22,-19679.86"/>
<polygon fill="black" stroke="black" points="7596.68,-19680.38 7594.78,-19669.96 7589.77,-19679.3 7596.68,-19680.38"/>
</g>
<!-- layer5_gpu10_token_send -->
<g id="node514" class="node">
<title>layer5_gpu10_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="7662" cy="-19517.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="7662" y="-19536.38" font-family="Times,serif" font-size="14.00">Token Send GPU10</text>
<text text-anchor="middle" x="7662" y="-19521.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="7662" y="-19506.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="7662" y="-19491.38" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer5_gpu10_expert_mlp2&#45;&gt;layer5_gpu10_token_send -->
<g id="edge598" class="edge">
<title>layer5_gpu10_expert_mlp2&#45;&gt;layer5_gpu10_token_send</title>
<path fill="none" stroke="black" d="M7617.77,-19601.4C7622.22,-19593.06 7627.13,-19583.88 7632,-19574.76"/>
<polygon fill="black" stroke="black" points="7635.21,-19576.16 7636.84,-19565.69 7629.04,-19572.86 7635.21,-19576.16"/>
</g>
<!-- layer5_gpu10_token_send&#45;&gt;layer5_expert_agg -->
<g id="edge599" class="edge">
<title>layer5_gpu10_token_send&#45;&gt;layer5_expert_agg</title>
<path fill="none" stroke="black" d="M7418.01,-19482.56C7377.96,-19477.68 7336.86,-19473.1 7298,-19469.5 6805.31,-19423.76 6235.61,-19395.48 5866.49,-19380.39"/>
<polygon fill="black" stroke="black" points="5866.58,-19376.89 5856.44,-19379.98 5866.29,-19383.88 5866.58,-19376.89"/>
</g>
<!-- layer5_gpu11_expert_mlp1 -->
<g id="node516" class="node">
<title>layer5_gpu11_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="8475.5,-19877.66 8014.5,-19877.66 8014.5,-19809.66 8475.5,-19809.66 8475.5,-19877.66"/>
<text text-anchor="middle" x="8245" y="-19862.46" font-family="Times,serif" font-size="14.00">Expert 11 MLP1</text>
<text text-anchor="middle" x="8245" y="-19847.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8245" y="-19832.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8245" y="-19817.46" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer5_gpu11_token_recv&#45;&gt;layer5_gpu11_expert_mlp1 -->
<g id="edge601" class="edge">
<title>layer5_gpu11_token_recv&#45;&gt;layer5_gpu11_expert_mlp1</title>
<path fill="none" stroke="black" d="M8233.73,-19913.53C8235.12,-19905.05 8236.56,-19896.25 8237.92,-19887.89"/>
<polygon fill="black" stroke="black" points="8241.39,-19888.4 8239.55,-19877.97 8234.48,-19887.27 8241.39,-19888.4"/>
</g>
<!-- layer5_gpu11_expert_act -->
<g id="node517" class="node">
<title>layer5_gpu11_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="8475.5,-19773.66 8098.5,-19773.66 8098.5,-19705.66 8475.5,-19705.66 8475.5,-19773.66"/>
<text text-anchor="middle" x="8287" y="-19758.46" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="8287" y="-19743.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8287" y="-19728.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8287" y="-19713.46" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer5_gpu11_expert_mlp1&#45;&gt;layer5_gpu11_expert_act -->
<g id="edge602" class="edge">
<title>layer5_gpu11_expert_mlp1&#45;&gt;layer5_gpu11_expert_act</title>
<path fill="none" stroke="black" d="M8258.64,-19809.55C8262.08,-19801.17 8265.83,-19792.06 8269.45,-19783.29"/>
<polygon fill="black" stroke="black" points="8272.72,-19784.54 8273.29,-19773.96 8266.24,-19781.88 8272.72,-19784.54"/>
</g>
<!-- layer5_gpu11_expert_mlp2 -->
<g id="node518" class="node">
<title>layer5_gpu11_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="8573.5,-19669.66 8166.5,-19669.66 8166.5,-19601.66 8573.5,-19601.66 8573.5,-19669.66"/>
<text text-anchor="middle" x="8370" y="-19654.46" font-family="Times,serif" font-size="14.00">Expert 11 MLP2</text>
<text text-anchor="middle" x="8370" y="-19639.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8370" y="-19624.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="8370" y="-19609.46" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer5_gpu11_expert_act&#45;&gt;layer5_gpu11_expert_mlp2 -->
<g id="edge603" class="edge">
<title>layer5_gpu11_expert_act&#45;&gt;layer5_gpu11_expert_mlp2</title>
<path fill="none" stroke="black" d="M8313.95,-19705.55C8321.12,-19696.73 8328.96,-19687.09 8336.45,-19677.9"/>
<polygon fill="black" stroke="black" points="8339.31,-19679.93 8342.9,-19669.96 8333.88,-19675.51 8339.31,-19679.93"/>
</g>
<!-- layer5_gpu11_token_send -->
<g id="node519" class="node">
<title>layer5_gpu11_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="8391" cy="-19517.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="8391" y="-19536.38" font-family="Times,serif" font-size="14.00">Token Send GPU11</text>
<text text-anchor="middle" x="8391" y="-19521.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="8391" y="-19506.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="8391" y="-19491.38" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer5_gpu11_expert_mlp2&#45;&gt;layer5_gpu11_token_send -->
<g id="edge604" class="edge">
<title>layer5_gpu11_expert_mlp2&#45;&gt;layer5_gpu11_token_send</title>
<path fill="none" stroke="black" d="M8376.02,-19601.4C8377.48,-19593.32 8379.08,-19584.45 8380.68,-19575.61"/>
<polygon fill="black" stroke="black" points="8384.14,-19576.15 8382.48,-19565.69 8377.25,-19574.91 8384.14,-19576.15"/>
</g>
<!-- layer5_gpu11_token_send&#45;&gt;layer5_expert_agg -->
<g id="edge605" class="edge">
<title>layer5_gpu11_token_send&#45;&gt;layer5_expert_agg</title>
<path fill="none" stroke="black" d="M8149.02,-19482.25C8108.35,-19477.35 8066.52,-19472.84 8027,-19469.5 7257.21,-19404.29 6353.08,-19380.13 5854.72,-19371.35"/>
<polygon fill="black" stroke="black" points="5854.55,-19367.84 5844.49,-19371.17 5854.43,-19374.84 5854.55,-19367.84"/>
</g>
<!-- layer5_gpu12_expert_mlp1 -->
<g id="node521" class="node">
<title>layer5_gpu12_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9195.5,-19877.66 8734.5,-19877.66 8734.5,-19809.66 9195.5,-19809.66 9195.5,-19877.66"/>
<text text-anchor="middle" x="8965" y="-19862.46" font-family="Times,serif" font-size="14.00">Expert 12 MLP1</text>
<text text-anchor="middle" x="8965" y="-19847.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8965" y="-19832.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8965" y="-19817.46" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer5_gpu12_token_recv&#45;&gt;layer5_gpu12_expert_mlp1 -->
<g id="edge607" class="edge">
<title>layer5_gpu12_token_recv&#45;&gt;layer5_gpu12_expert_mlp1</title>
<path fill="none" stroke="black" d="M8934.15,-19913.53C8938.03,-19904.87 8942.06,-19895.87 8945.88,-19887.34"/>
<polygon fill="black" stroke="black" points="8949.19,-19888.52 8950.08,-19877.97 8942.8,-19885.66 8949.19,-19888.52"/>
</g>
<!-- layer5_gpu12_expert_act -->
<g id="node522" class="node">
<title>layer5_gpu12_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9179.5,-19773.66 8802.5,-19773.66 8802.5,-19705.66 9179.5,-19705.66 9179.5,-19773.66"/>
<text text-anchor="middle" x="8991" y="-19758.46" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="8991" y="-19743.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8991" y="-19728.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8991" y="-19713.46" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer5_gpu12_expert_mlp1&#45;&gt;layer5_gpu12_expert_act -->
<g id="edge608" class="edge">
<title>layer5_gpu12_expert_mlp1&#45;&gt;layer5_gpu12_expert_act</title>
<path fill="none" stroke="black" d="M8973.44,-19809.55C8975.53,-19801.35 8977.8,-19792.45 8979.99,-19783.86"/>
<polygon fill="black" stroke="black" points="8983.43,-19784.52 8982.51,-19773.96 8976.65,-19782.79 8983.43,-19784.52"/>
</g>
<!-- layer5_gpu12_expert_mlp2 -->
<g id="node523" class="node">
<title>layer5_gpu12_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9298.5,-19669.66 8891.5,-19669.66 8891.5,-19601.66 9298.5,-19601.66 9298.5,-19669.66"/>
<text text-anchor="middle" x="9095" y="-19654.46" font-family="Times,serif" font-size="14.00">Expert 12 MLP2</text>
<text text-anchor="middle" x="9095" y="-19639.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9095" y="-19624.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9095" y="-19609.46" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer5_gpu12_expert_act&#45;&gt;layer5_gpu12_expert_mlp2 -->
<g id="edge609" class="edge">
<title>layer5_gpu12_expert_act&#45;&gt;layer5_gpu12_expert_mlp2</title>
<path fill="none" stroke="black" d="M9024.77,-19705.55C9034.03,-19696.46 9044.18,-19686.51 9053.81,-19677.06"/>
<polygon fill="black" stroke="black" points="9056.36,-19679.46 9061.05,-19669.96 9051.46,-19674.47 9056.36,-19679.46"/>
</g>
<!-- layer5_gpu12_token_send -->
<g id="node524" class="node">
<title>layer5_gpu12_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9120" cy="-19517.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9120" y="-19536.38" font-family="Times,serif" font-size="14.00">Token Send GPU12</text>
<text text-anchor="middle" x="9120" y="-19521.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9120" y="-19506.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9120" y="-19491.38" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer5_gpu12_expert_mlp2&#45;&gt;layer5_gpu12_token_send -->
<g id="edge610" class="edge">
<title>layer5_gpu12_expert_mlp2&#45;&gt;layer5_gpu12_token_send</title>
<path fill="none" stroke="black" d="M9102.16,-19601.4C9103.9,-19593.32 9105.81,-19584.45 9107.72,-19575.61"/>
<polygon fill="black" stroke="black" points="9111.17,-19576.2 9109.85,-19565.69 9104.33,-19574.73 9111.17,-19576.2"/>
</g>
<!-- layer5_gpu12_token_send&#45;&gt;layer5_expert_agg -->
<g id="edge611" class="edge">
<title>layer5_gpu12_token_send&#45;&gt;layer5_expert_agg</title>
<path fill="none" stroke="black" d="M8879.52,-19482.12C8838.38,-19477.19 8796.02,-19472.71 8756,-19469.5 7703.84,-19385.12 6456.59,-19368.93 5848.15,-19366.42"/>
<polygon fill="black" stroke="black" points="5847.92,-19362.92 5837.9,-19366.38 5847.89,-19369.92 5847.92,-19362.92"/>
</g>
<!-- layer5_gpu13_expert_mlp1 -->
<g id="node526" class="node">
<title>layer5_gpu13_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9860.5,-19877.66 9399.5,-19877.66 9399.5,-19809.66 9860.5,-19809.66 9860.5,-19877.66"/>
<text text-anchor="middle" x="9630" y="-19862.46" font-family="Times,serif" font-size="14.00">Expert 13 MLP1</text>
<text text-anchor="middle" x="9630" y="-19847.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9630" y="-19832.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9630" y="-19817.46" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer5_gpu13_token_recv&#45;&gt;layer5_gpu13_expert_mlp1 -->
<g id="edge613" class="edge">
<title>layer5_gpu13_token_recv&#45;&gt;layer5_gpu13_expert_mlp1</title>
<path fill="none" stroke="black" d="M9612.2,-19913.53C9614.39,-19905.05 9616.67,-19896.25 9618.83,-19887.89"/>
<polygon fill="black" stroke="black" points="9622.28,-19888.52 9621.39,-19877.97 9615.5,-19886.77 9622.28,-19888.52"/>
</g>
<!-- layer5_gpu13_expert_act -->
<g id="node527" class="node">
<title>layer5_gpu13_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9849.5,-19773.66 9472.5,-19773.66 9472.5,-19705.66 9849.5,-19705.66 9849.5,-19773.66"/>
<text text-anchor="middle" x="9661" y="-19758.46" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="9661" y="-19743.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9661" y="-19728.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9661" y="-19713.46" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer5_gpu13_expert_mlp1&#45;&gt;layer5_gpu13_expert_act -->
<g id="edge614" class="edge">
<title>layer5_gpu13_expert_mlp1&#45;&gt;layer5_gpu13_expert_act</title>
<path fill="none" stroke="black" d="M9640.06,-19809.55C9642.58,-19801.26 9645.32,-19792.26 9647.96,-19783.57"/>
<polygon fill="black" stroke="black" points="9651.32,-19784.55 9650.88,-19773.96 9644.62,-19782.51 9651.32,-19784.55"/>
</g>
<!-- layer5_gpu13_expert_mlp2 -->
<g id="node528" class="node">
<title>layer5_gpu13_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9989.5,-19669.66 9582.5,-19669.66 9582.5,-19601.66 9989.5,-19601.66 9989.5,-19669.66"/>
<text text-anchor="middle" x="9786" y="-19654.46" font-family="Times,serif" font-size="14.00">Expert 13 MLP2</text>
<text text-anchor="middle" x="9786" y="-19639.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9786" y="-19624.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9786" y="-19609.46" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer5_gpu13_expert_act&#45;&gt;layer5_gpu13_expert_mlp2 -->
<g id="edge615" class="edge">
<title>layer5_gpu13_expert_act&#45;&gt;layer5_gpu13_expert_mlp2</title>
<path fill="none" stroke="black" d="M9701.58,-19705.55C9712.94,-19696.28 9725.39,-19686.12 9737.17,-19676.51"/>
<polygon fill="black" stroke="black" points="9739.66,-19679 9745.19,-19669.96 9735.23,-19673.57 9739.66,-19679"/>
</g>
<!-- layer5_gpu13_token_send -->
<g id="node529" class="node">
<title>layer5_gpu13_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9849" cy="-19517.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9849" y="-19536.38" font-family="Times,serif" font-size="14.00">Token Send GPU13</text>
<text text-anchor="middle" x="9849" y="-19521.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9849" y="-19506.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9849" y="-19491.38" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer5_gpu13_expert_mlp2&#45;&gt;layer5_gpu13_token_send -->
<g id="edge616" class="edge">
<title>layer5_gpu13_expert_mlp2&#45;&gt;layer5_gpu13_token_send</title>
<path fill="none" stroke="black" d="M9804.05,-19601.4C9808.58,-19593.06 9813.56,-19583.88 9818.51,-19574.76"/>
<polygon fill="black" stroke="black" points="9821.74,-19576.15 9823.43,-19565.69 9815.59,-19572.81 9821.74,-19576.15"/>
</g>
<!-- layer5_gpu13_token_send&#45;&gt;layer5_expert_agg -->
<g id="edge617" class="edge">
<title>layer5_gpu13_token_send&#45;&gt;layer5_expert_agg</title>
<path fill="none" stroke="black" d="M9609.02,-19481.98C9567.73,-19477.05 9525.18,-19472.6 9485,-19469.5 8787.13,-19415.54 6712.07,-19382.79 5854.42,-19371.23"/>
<polygon fill="black" stroke="black" points="5854.44,-19367.73 5844.39,-19371.09 5854.34,-19374.73 5854.44,-19367.73"/>
</g>
<!-- layer5_gpu14_expert_mlp1 -->
<g id="node531" class="node">
<title>layer5_gpu14_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="10647.5,-19877.66 10186.5,-19877.66 10186.5,-19809.66 10647.5,-19809.66 10647.5,-19877.66"/>
<text text-anchor="middle" x="10417" y="-19862.46" font-family="Times,serif" font-size="14.00">Expert 14 MLP1</text>
<text text-anchor="middle" x="10417" y="-19847.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10417" y="-19832.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10417" y="-19817.46" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer5_gpu14_token_recv&#45;&gt;layer5_gpu14_expert_mlp1 -->
<g id="edge619" class="edge">
<title>layer5_gpu14_token_recv&#45;&gt;layer5_gpu14_expert_mlp1</title>
<path fill="none" stroke="black" d="M10339.13,-19914.2C10350.04,-19904.45 10361.46,-19894.26 10372.08,-19884.77"/>
<polygon fill="black" stroke="black" points="10374.53,-19887.28 10379.66,-19878.01 10369.87,-19882.06 10374.53,-19887.28"/>
</g>
<!-- layer5_gpu14_expert_act -->
<g id="node532" class="node">
<title>layer5_gpu14_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="10764.5,-19773.66 10387.5,-19773.66 10387.5,-19705.66 10764.5,-19705.66 10764.5,-19773.66"/>
<text text-anchor="middle" x="10576" y="-19758.46" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="10576" y="-19743.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10576" y="-19728.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10576" y="-19713.46" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer5_gpu14_expert_mlp1&#45;&gt;layer5_gpu14_expert_act -->
<g id="edge620" class="edge">
<title>layer5_gpu14_expert_mlp1&#45;&gt;layer5_gpu14_expert_act</title>
<path fill="none" stroke="black" d="M10468.62,-19809.55C10483.7,-19799.88 10500.3,-19789.23 10515.85,-19779.25"/>
<polygon fill="black" stroke="black" points="10517.84,-19782.13 10524.36,-19773.79 10514.06,-19776.24 10517.84,-19782.13"/>
</g>
<!-- layer5_gpu14_expert_mlp2 -->
<g id="node533" class="node">
<title>layer5_gpu14_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10779.5,-19669.66 10372.5,-19669.66 10372.5,-19601.66 10779.5,-19601.66 10779.5,-19669.66"/>
<text text-anchor="middle" x="10576" y="-19654.46" font-family="Times,serif" font-size="14.00">Expert 14 MLP2</text>
<text text-anchor="middle" x="10576" y="-19639.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10576" y="-19624.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="10576" y="-19609.46" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer5_gpu14_expert_act&#45;&gt;layer5_gpu14_expert_mlp2 -->
<g id="edge621" class="edge">
<title>layer5_gpu14_expert_act&#45;&gt;layer5_gpu14_expert_mlp2</title>
<path fill="none" stroke="black" d="M10576,-19705.55C10576,-19697.44 10576,-19688.65 10576,-19680.14"/>
<polygon fill="black" stroke="black" points="10579.5,-19679.96 10576,-19669.96 10572.5,-19679.96 10579.5,-19679.96"/>
</g>
<!-- layer5_gpu14_token_send -->
<g id="node534" class="node">
<title>layer5_gpu14_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="10578" cy="-19517.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="10578" y="-19536.38" font-family="Times,serif" font-size="14.00">Token Send GPU14</text>
<text text-anchor="middle" x="10578" y="-19521.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="10578" y="-19506.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="10578" y="-19491.38" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer5_gpu14_expert_mlp2&#45;&gt;layer5_gpu14_token_send -->
<g id="edge622" class="edge">
<title>layer5_gpu14_expert_mlp2&#45;&gt;layer5_gpu14_token_send</title>
<path fill="none" stroke="black" d="M10576.57,-19601.4C10576.71,-19593.41 10576.86,-19584.64 10577.01,-19575.9"/>
<polygon fill="black" stroke="black" points="10580.52,-19575.75 10577.19,-19565.69 10573.52,-19575.63 10580.52,-19575.75"/>
</g>
<!-- layer5_gpu14_token_send&#45;&gt;layer5_expert_agg -->
<g id="edge623" class="edge">
<title>layer5_gpu14_token_send&#45;&gt;layer5_expert_agg</title>
<path fill="none" stroke="black" d="M10339.01,-19481.96C10297.41,-19477 10254.51,-19472.55 10214,-19469.5 9369.31,-19405.87 6817.75,-19377.95 5852.45,-19369.47"/>
<polygon fill="black" stroke="black" points="5852.26,-19365.97 5842.22,-19369.38 5852.19,-19372.97 5852.26,-19365.97"/>
</g>
<!-- layer5_gpu15_expert_mlp1 -->
<g id="node536" class="node">
<title>layer5_gpu15_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="11208.5,-19877.66 10747.5,-19877.66 10747.5,-19809.66 11208.5,-19809.66 11208.5,-19877.66"/>
<text text-anchor="middle" x="10978" y="-19862.46" font-family="Times,serif" font-size="14.00">Expert 15 MLP1</text>
<text text-anchor="middle" x="10978" y="-19847.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10978" y="-19832.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10978" y="-19817.46" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer5_gpu15_token_recv&#45;&gt;layer5_gpu15_expert_mlp1 -->
<g id="edge625" class="edge">
<title>layer5_gpu15_token_recv&#45;&gt;layer5_gpu15_expert_mlp1</title>
<path fill="none" stroke="black" d="M10975.63,-19913.53C10975.92,-19905.15 10976.22,-19896.45 10976.5,-19888.17"/>
<polygon fill="black" stroke="black" points="10980.01,-19888.08 10976.85,-19877.97 10973.01,-19887.84 10980.01,-19888.08"/>
</g>
<!-- layer5_gpu15_expert_act -->
<g id="node537" class="node">
<title>layer5_gpu15_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="11174.5,-19773.66 10797.5,-19773.66 10797.5,-19705.66 11174.5,-19705.66 11174.5,-19773.66"/>
<text text-anchor="middle" x="10986" y="-19758.46" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="10986" y="-19743.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10986" y="-19728.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10986" y="-19713.46" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer5_gpu15_expert_mlp1&#45;&gt;layer5_gpu15_expert_act -->
<g id="edge626" class="edge">
<title>layer5_gpu15_expert_mlp1&#45;&gt;layer5_gpu15_expert_act</title>
<path fill="none" stroke="black" d="M10980.6,-19809.55C10981.23,-19801.44 10981.92,-19792.65 10982.59,-19784.14"/>
<polygon fill="black" stroke="black" points="10986.1,-19784.21 10983.39,-19773.96 10979.12,-19783.66 10986.1,-19784.21"/>
</g>
<!-- layer5_gpu15_expert_mlp2 -->
<g id="node538" class="node">
<title>layer5_gpu15_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="11364.5,-19669.66 10957.5,-19669.66 10957.5,-19601.66 11364.5,-19601.66 11364.5,-19669.66"/>
<text text-anchor="middle" x="11161" y="-19654.46" font-family="Times,serif" font-size="14.00">Expert 15 MLP2</text>
<text text-anchor="middle" x="11161" y="-19639.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11161" y="-19624.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="11161" y="-19609.46" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer5_gpu15_expert_act&#45;&gt;layer5_gpu15_expert_mlp2 -->
<g id="edge627" class="edge">
<title>layer5_gpu15_expert_act&#45;&gt;layer5_gpu15_expert_mlp2</title>
<path fill="none" stroke="black" d="M11042.82,-19705.55C11059.56,-19695.79 11078.02,-19685.03 11095.27,-19674.97"/>
<polygon fill="black" stroke="black" points="11097.29,-19677.85 11104.17,-19669.79 11093.77,-19671.8 11097.29,-19677.85"/>
</g>
<!-- layer5_gpu15_token_send -->
<g id="node539" class="node">
<title>layer5_gpu15_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="11307" cy="-19517.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="11307" y="-19536.38" font-family="Times,serif" font-size="14.00">Token Send GPU15</text>
<text text-anchor="middle" x="11307" y="-19521.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="11307" y="-19506.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="11307" y="-19491.38" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer5_gpu15_expert_mlp2&#45;&gt;layer5_gpu15_token_send -->
<g id="edge628" class="edge">
<title>layer5_gpu15_expert_mlp2&#45;&gt;layer5_gpu15_token_send</title>
<path fill="none" stroke="black" d="M11202.84,-19601.4C11214.63,-19592.02 11227.76,-19581.58 11240.61,-19571.36"/>
<polygon fill="black" stroke="black" points="11242.92,-19574 11248.56,-19565.04 11238.56,-19568.53 11242.92,-19574"/>
</g>
<!-- layer5_gpu15_token_send&#45;&gt;layer5_expert_agg -->
<g id="edge629" class="edge">
<title>layer5_gpu15_token_send&#45;&gt;layer5_expert_agg</title>
<path fill="none" stroke="black" d="M11068.02,-19481.87C11026.42,-19476.91 10983.51,-19472.49 10943,-19469.5 9950.22,-19396.16 6914.36,-19373.85 5850.26,-19368.19"/>
<polygon fill="black" stroke="black" points="5850.17,-19364.69 5840.15,-19368.13 5850.13,-19371.69 5850.17,-19364.69"/>
</g>
<!-- layer5_residual2 -->
<g id="node541" class="node">
<title>layer5_residual2</title>
<polygon fill="lightyellow" stroke="black" points="5919.89,-19261.5 5215.35,-19261.5 5034.11,-19125.5 5738.65,-19125.5 5919.89,-19261.5"/>
<text text-anchor="middle" x="5477" y="-19212.3" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="5477" y="-19197.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5477" y="-19182.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-19167.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer5_expert_agg&#45;&gt;layer5_residual2 -->
<g id="edge630" class="edge">
<title>layer5_expert_agg&#45;&gt;layer5_residual2</title>
<path fill="none" stroke="black" d="M5477,-19297.31C5477,-19288.99 5477,-19280.44 5477,-19271.99"/>
<polygon fill="black" stroke="black" points="5480.5,-19271.75 5477,-19261.75 5473.5,-19271.75 5480.5,-19271.75"/>
</g>
<!-- layer6_layernorm -->
<g id="node542" class="node">
<title>layer6_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="5680.5,-19078.5 5273.5,-19078.5 5273.5,-19010.5 5680.5,-19010.5 5680.5,-19078.5"/>
<text text-anchor="middle" x="5477" y="-19063.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5477" y="-19048.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-19033.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-19018.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer5_residual2&#45;&gt;layer6_layernorm -->
<g id="edge631" class="edge">
<title>layer5_residual2&#45;&gt;layer6_layernorm</title>
<path fill="none" stroke="black" d="M5477,-19125.45C5477,-19113.04 5477,-19100.39 5477,-19088.92"/>
<polygon fill="black" stroke="black" points="5480.5,-19088.75 5477,-19078.75 5473.5,-19088.75 5480.5,-19088.75"/>
</g>
<!-- layer6_qkv_proj -->
<g id="node543" class="node">
<title>layer6_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="5734.5,-18974.5 5219.5,-18974.5 5219.5,-18906.5 5734.5,-18906.5 5734.5,-18974.5"/>
<text text-anchor="middle" x="5477" y="-18959.3" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5477" y="-18944.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-18929.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5477" y="-18914.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer6_layernorm&#45;&gt;layer6_qkv_proj -->
<g id="edge632" class="edge">
<title>layer6_layernorm&#45;&gt;layer6_qkv_proj</title>
<path fill="none" stroke="black" d="M5477,-19010.38C5477,-19002.27 5477,-18993.48 5477,-18984.97"/>
<polygon fill="black" stroke="black" points="5480.5,-18984.8 5477,-18974.8 5473.5,-18984.8 5480.5,-18984.8"/>
</g>
<!-- layer6_attention -->
<g id="node544" class="node">
<title>layer6_attention</title>
<polygon fill="lightgreen" stroke="black" points="5728.5,-18870.5 5225.5,-18870.5 5225.5,-18802.5 5728.5,-18802.5 5728.5,-18870.5"/>
<text text-anchor="middle" x="5477" y="-18855.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5477" y="-18840.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5477" y="-18825.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5477" y="-18810.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer6_qkv_proj&#45;&gt;layer6_attention -->
<g id="edge633" class="edge">
<title>layer6_qkv_proj&#45;&gt;layer6_attention</title>
<path fill="none" stroke="black" d="M5477,-18906.38C5477,-18898.27 5477,-18889.48 5477,-18880.97"/>
<polygon fill="black" stroke="black" points="5480.5,-18880.8 5477,-18870.8 5473.5,-18880.8 5480.5,-18880.8"/>
</g>
<!-- layer6_attn_out -->
<g id="node545" class="node">
<title>layer6_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="5715.5,-18766.5 5238.5,-18766.5 5238.5,-18698.5 5715.5,-18698.5 5715.5,-18766.5"/>
<text text-anchor="middle" x="5477" y="-18751.3" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5477" y="-18736.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5477" y="-18721.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-18706.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer6_attention&#45;&gt;layer6_attn_out -->
<g id="edge634" class="edge">
<title>layer6_attention&#45;&gt;layer6_attn_out</title>
<path fill="none" stroke="black" d="M5477,-18802.38C5477,-18794.27 5477,-18785.48 5477,-18776.97"/>
<polygon fill="black" stroke="black" points="5480.5,-18776.8 5477,-18766.8 5473.5,-18776.8 5480.5,-18776.8"/>
</g>
<!-- layer6_residual1 -->
<g id="node546" class="node">
<title>layer6_residual1</title>
<polygon fill="lightyellow" stroke="black" points="5919.89,-18662.5 5215.35,-18662.5 5034.11,-18526.5 5738.65,-18526.5 5919.89,-18662.5"/>
<text text-anchor="middle" x="5477" y="-18613.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5477" y="-18598.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5477" y="-18583.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-18568.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer6_attn_out&#45;&gt;layer6_residual1 -->
<g id="edge635" class="edge">
<title>layer6_attn_out&#45;&gt;layer6_residual1</title>
<path fill="none" stroke="black" d="M5477,-18698.23C5477,-18690.4 5477,-18681.73 5477,-18672.85"/>
<polygon fill="black" stroke="black" points="5480.5,-18672.76 5477,-18662.76 5473.5,-18672.76 5480.5,-18672.76"/>
</g>
<!-- layer6_layernorm2 -->
<g id="node547" class="node">
<title>layer6_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="5680.5,-18490.5 5273.5,-18490.5 5273.5,-18422.5 5680.5,-18422.5 5680.5,-18490.5"/>
<text text-anchor="middle" x="5477" y="-18475.3" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5477" y="-18460.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-18445.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-18430.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer6_residual1&#45;&gt;layer6_layernorm2 -->
<g id="edge636" class="edge">
<title>layer6_residual1&#45;&gt;layer6_layernorm2</title>
<path fill="none" stroke="black" d="M5477,-18526.29C5477,-18517.54 5477,-18508.77 5477,-18500.57"/>
<polygon fill="black" stroke="black" points="5480.5,-18500.51 5477,-18490.51 5473.5,-18500.51 5480.5,-18500.51"/>
</g>
<!-- layer6_global_gate -->
<g id="node548" class="node">
<title>layer6_global_gate</title>
<polygon fill="lightgreen" stroke="black" points="5674.5,-18386.5 5279.5,-18386.5 5279.5,-18318.5 5674.5,-18318.5 5674.5,-18386.5"/>
<text text-anchor="middle" x="5477" y="-18371.3" font-family="Times,serif" font-size="14.00">Global Gate</text>
<text text-anchor="middle" x="5477" y="-18356.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-18341.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, experts=64]</text>
<text text-anchor="middle" x="5477" y="-18326.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer6_layernorm2&#45;&gt;layer6_global_gate -->
<g id="edge637" class="edge">
<title>layer6_layernorm2&#45;&gt;layer6_global_gate</title>
<path fill="none" stroke="black" d="M5477,-18422.38C5477,-18414.27 5477,-18405.48 5477,-18396.97"/>
<polygon fill="black" stroke="black" points="5480.5,-18396.8 5477,-18386.8 5473.5,-18396.8 5480.5,-18396.8"/>
</g>
<!-- layer6_routing -->
<g id="node549" class="node">
<title>layer6_routing</title>
<polygon fill="lightyellow" stroke="black" points="5963.47,-18282.5 5189.6,-18282.5 4990.53,-18146.5 5764.4,-18146.5 5963.47,-18282.5"/>
<text text-anchor="middle" x="5477" y="-18233.3" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="5477" y="-18218.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-18203.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5477" y="-18188.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer6_global_gate&#45;&gt;layer6_routing -->
<g id="edge638" class="edge">
<title>layer6_global_gate&#45;&gt;layer6_routing</title>
<path fill="none" stroke="black" d="M5477,-18318.23C5477,-18310.4 5477,-18301.73 5477,-18292.85"/>
<polygon fill="black" stroke="black" points="5480.5,-18292.76 5477,-18282.76 5473.5,-18292.76 5480.5,-18292.76"/>
</g>
<!-- layer6_gpu0_token_recv -->
<g id="node550" class="node">
<title>layer6_gpu0_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="474" cy="-18062.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="474" y="-18081.21" font-family="Times,serif" font-size="14.00">Token Receive GPU0</text>
<text text-anchor="middle" x="474" y="-18066.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="474" y="-18051.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="474" y="-18036.21" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer6_routing&#45;&gt;layer6_gpu0_token_recv -->
<g id="edge639" class="edge">
<title>layer6_routing&#45;&gt;layer6_gpu0_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5083.75,-18210.25C4118.96,-18201.42 1653.81,-18173.24 833,-18110.5 794.58,-18107.56 753.97,-18103.33 714.42,-18098.59"/>
<polygon fill="black" stroke="black" points="714.74,-18095.11 704.4,-18097.38 713.9,-18102.06 714.74,-18095.11"/>
</g>
<!-- layer6_gpu1_token_recv -->
<g id="node555" class="node">
<title>layer6_gpu1_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1176" cy="-18062.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1176" y="-18081.21" font-family="Times,serif" font-size="14.00">Token Receive GPU1</text>
<text text-anchor="middle" x="1176" y="-18066.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1176" y="-18051.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1176" y="-18036.21" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer6_routing&#45;&gt;layer6_gpu1_token_recv -->
<g id="edge645" class="edge">
<title>layer6_routing&#45;&gt;layer6_gpu1_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5080.3,-18207.86C4226.26,-18194.93 2236.36,-18160.38 1562,-18110.5 1517.54,-18107.21 1470.34,-18102.48 1424.77,-18097.28"/>
<polygon fill="black" stroke="black" points="1425.1,-18093.8 1414.76,-18096.13 1424.3,-18100.75 1425.1,-18093.8"/>
</g>
<!-- layer6_gpu2_token_recv -->
<g id="node560" class="node">
<title>layer6_gpu2_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1905" cy="-18062.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1905" y="-18081.21" font-family="Times,serif" font-size="14.00">Token Receive GPU2</text>
<text text-anchor="middle" x="1905" y="-18066.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1905" y="-18051.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1905" y="-18036.21" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer6_routing&#45;&gt;layer6_gpu2_token_recv -->
<g id="edge651" class="edge">
<title>layer6_routing&#45;&gt;layer6_gpu2_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5087.88,-18213.05C4483.78,-18209.64 3284.23,-18192.01 2270,-18110.5 2230.58,-18107.33 2188.88,-18102.94 2148.32,-18098.11"/>
<polygon fill="black" stroke="black" points="2148.65,-18094.62 2138.31,-18096.9 2147.82,-18101.57 2148.65,-18094.62"/>
</g>
<!-- layer6_gpu3_token_recv -->
<g id="node565" class="node">
<title>layer6_gpu3_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="2613" cy="-18062.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2613" y="-18081.21" font-family="Times,serif" font-size="14.00">Token Receive GPU3</text>
<text text-anchor="middle" x="2613" y="-18066.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="2613" y="-18051.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2613" y="-18036.21" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer6_routing&#45;&gt;layer6_gpu3_token_recv -->
<g id="edge657" class="edge">
<title>layer6_routing&#45;&gt;layer6_gpu3_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5081.39,-18208.62C4585.54,-18199.9 3709.98,-18175.9 2963,-18110.5 2927.41,-18107.38 2889.89,-18103.24 2853.16,-18098.71"/>
<polygon fill="black" stroke="black" points="2853.18,-18095.19 2842.82,-18097.42 2852.31,-18102.13 2853.18,-18095.19"/>
</g>
<!-- layer6_gpu4_token_recv -->
<g id="node570" class="node">
<title>layer6_gpu4_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="3306" cy="-18062.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="3306" y="-18081.21" font-family="Times,serif" font-size="14.00">Token Receive GPU4</text>
<text text-anchor="middle" x="3306" y="-18066.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="3306" y="-18051.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3306" y="-18036.21" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer6_routing&#45;&gt;layer6_gpu4_token_recv -->
<g id="edge663" class="edge">
<title>layer6_routing&#45;&gt;layer6_gpu4_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5062.63,-18195.96C4704.84,-18179.23 4174.29,-18150.61 3713,-18110.5 3665.18,-18106.34 3614.3,-18101.1 3565.28,-18095.64"/>
<polygon fill="black" stroke="black" points="3565.51,-18092.15 3555.18,-18094.51 3564.73,-18099.1 3565.51,-18092.15"/>
</g>
<!-- layer6_gpu5_token_recv -->
<g id="node575" class="node">
<title>layer6_gpu5_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4056" cy="-18062.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4056" y="-18081.21" font-family="Times,serif" font-size="14.00">Token Receive GPU5</text>
<text text-anchor="middle" x="4056" y="-18066.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4056" y="-18051.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4056" y="-18036.21" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer6_routing&#45;&gt;layer6_gpu5_token_recv -->
<g id="edge669" class="edge">
<title>layer6_routing&#45;&gt;layer6_gpu5_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5027.51,-18171.89C4842.61,-18154.09 4626.4,-18132.38 4431,-18110.5 4392.3,-18106.16 4351.39,-18101.31 4311.38,-18096.41"/>
<polygon fill="black" stroke="black" points="4311.58,-18092.91 4301.23,-18095.16 4310.73,-18099.85 4311.58,-18092.91"/>
</g>
<!-- layer6_gpu6_token_recv -->
<g id="node580" class="node">
<title>layer6_gpu6_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4774" cy="-18062.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4774" y="-18081.21" font-family="Times,serif" font-size="14.00">Token Receive GPU6</text>
<text text-anchor="middle" x="4774" y="-18066.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4774" y="-18051.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4774" y="-18036.21" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_routing&#45;&gt;layer6_gpu6_token_recv -->
<g id="edge675" class="edge">
<title>layer6_routing&#45;&gt;layer6_gpu6_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5163.02,-18146.47C5096.48,-18132.26 5028.13,-18117.67 4967.64,-18104.75"/>
<polygon fill="black" stroke="black" points="4968.13,-18101.28 4957.61,-18102.61 4966.66,-18108.12 4968.13,-18101.28"/>
</g>
<!-- layer6_gpu7_token_recv -->
<g id="node585" class="node">
<title>layer6_gpu7_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="5477" cy="-18062.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="5477" y="-18081.21" font-family="Times,serif" font-size="14.00">Token Receive GPU7</text>
<text text-anchor="middle" x="5477" y="-18066.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5477" y="-18051.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5477" y="-18036.21" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer6_routing&#45;&gt;layer6_gpu7_token_recv -->
<g id="edge681" class="edge">
<title>layer6_routing&#45;&gt;layer6_gpu7_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5477,-18146.36C5477,-18137.81 5477,-18129.13 5477,-18120.76"/>
<polygon fill="black" stroke="black" points="5480.5,-18120.73 5477,-18110.73 5473.5,-18120.73 5480.5,-18120.73"/>
</g>
<!-- layer6_gpu8_token_recv -->
<g id="node590" class="node">
<title>layer6_gpu8_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6165" cy="-18062.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6165" y="-18081.21" font-family="Times,serif" font-size="14.00">Token Receive GPU8</text>
<text text-anchor="middle" x="6165" y="-18066.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6165" y="-18051.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6165" y="-18036.21" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer6_routing&#45;&gt;layer6_gpu8_token_recv -->
<g id="edge687" class="edge">
<title>layer6_routing&#45;&gt;layer6_gpu8_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5769.27,-18149.74C5838.41,-18134.66 5910.39,-18118.96 5973.71,-18105.14"/>
<polygon fill="black" stroke="black" points="5974.78,-18108.49 5983.8,-18102.94 5973.29,-18101.65 5974.78,-18108.49"/>
</g>
<!-- layer6_gpu9_token_recv -->
<g id="node595" class="node">
<title>layer6_gpu9_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6852" cy="-18062.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6852" y="-18081.21" font-family="Times,serif" font-size="14.00">Token Receive GPU9</text>
<text text-anchor="middle" x="6852" y="-18066.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6852" y="-18051.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6852" y="-18036.21" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer6_routing&#45;&gt;layer6_gpu9_token_recv -->
<g id="edge693" class="edge">
<title>layer6_routing&#45;&gt;layer6_gpu9_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5817.49,-18182.63C6018.57,-18163.61 6278,-18137.72 6508,-18110.5 6540.01,-18106.71 6573.65,-18102.45 6606.85,-18098.08"/>
<polygon fill="black" stroke="black" points="6607.68,-18101.5 6617.14,-18096.72 6606.77,-18094.56 6607.68,-18101.5"/>
</g>
<!-- layer6_gpu10_token_recv -->
<g id="node600" class="node">
<title>layer6_gpu10_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="7539" cy="-18062.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="7539" y="-18081.21" font-family="Times,serif" font-size="14.00">Token Receive GPU10</text>
<text text-anchor="middle" x="7539" y="-18066.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="7539" y="-18051.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7539" y="-18036.21" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer6_routing&#45;&gt;layer6_gpu10_token_recv -->
<g id="edge699" class="edge">
<title>layer6_routing&#45;&gt;layer6_gpu10_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5842.52,-18199.66C6190.76,-18184.56 6729.43,-18156.25 7195,-18110.5 7228.58,-18107.2 7263.92,-18103.09 7298.65,-18098.68"/>
<polygon fill="black" stroke="black" points="7299.44,-18102.11 7308.91,-18097.37 7298.55,-18095.17 7299.44,-18102.11"/>
</g>
<!-- layer6_gpu11_token_recv -->
<g id="node605" class="node">
<title>layer6_gpu11_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8226" cy="-18062.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8226" y="-18081.21" font-family="Times,serif" font-size="14.00">Token Receive GPU11</text>
<text text-anchor="middle" x="8226" y="-18066.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8226" y="-18051.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8226" y="-18036.21" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer6_routing&#45;&gt;layer6_gpu11_token_recv -->
<g id="edge705" class="edge">
<title>layer6_routing&#45;&gt;layer6_gpu11_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5854.96,-18208.19C6329.25,-18199.03 7167.22,-18174.58 7882,-18110.5 7916.3,-18107.42 7952.42,-18103.37 7987.84,-18098.94"/>
<polygon fill="black" stroke="black" points="7988.33,-18102.41 7997.82,-18097.68 7987.46,-18095.46 7988.33,-18102.41"/>
</g>
<!-- layer6_gpu12_token_recv -->
<g id="node610" class="node">
<title>layer6_gpu12_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8913" cy="-18062.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8913" y="-18081.21" font-family="Times,serif" font-size="14.00">Token Receive GPU12</text>
<text text-anchor="middle" x="8913" y="-18066.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8913" y="-18051.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8913" y="-18036.21" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer6_routing&#45;&gt;layer6_gpu12_token_recv -->
<g id="edge711" class="edge">
<title>layer6_routing&#45;&gt;layer6_gpu12_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5862.47,-18213.35C6448.24,-18210.27 7597.15,-18192.97 8569,-18110.5 8603.73,-18107.55 8640.31,-18103.53 8676.15,-18099.08"/>
<polygon fill="black" stroke="black" points="8676.74,-18102.53 8686.23,-18097.81 8675.87,-18095.59 8676.74,-18102.53"/>
</g>
<!-- layer6_gpu13_token_recv -->
<g id="node615" class="node">
<title>layer6_gpu13_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="9600" cy="-18062.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="9600" y="-18081.21" font-family="Times,serif" font-size="14.00">Token Receive GPU13</text>
<text text-anchor="middle" x="9600" y="-18066.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="9600" y="-18051.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9600" y="-18036.21" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer6_routing&#45;&gt;layer6_gpu13_token_recv -->
<g id="edge717" class="edge">
<title>layer6_routing&#45;&gt;layer6_gpu13_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5855.33,-18208.42C6677.21,-18196.54 8604.22,-18163.83 9256,-18110.5 9291.01,-18107.63 9327.9,-18103.63 9364.01,-18099.16"/>
<polygon fill="black" stroke="black" points="9364.68,-18102.61 9374.17,-18097.89 9363.81,-18095.66 9364.68,-18102.61"/>
</g>
<!-- layer6_gpu14_token_recv -->
<g id="node620" class="node">
<title>layer6_gpu14_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10287" cy="-18062.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10287" y="-18081.21" font-family="Times,serif" font-size="14.00">Token Receive GPU14</text>
<text text-anchor="middle" x="10287" y="-18066.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10287" y="-18051.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10287" y="-18036.21" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer6_routing&#45;&gt;layer6_gpu14_token_recv -->
<g id="edge723" class="edge">
<title>layer6_routing&#45;&gt;layer6_gpu14_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5857.76,-18210.25C6787.42,-18201.43 9154.56,-18173.34 9943,-18110.5 9978.15,-18107.7 10015.2,-18103.71 10051.45,-18099.24"/>
<polygon fill="black" stroke="black" points="10052.16,-18102.68 10061.65,-18097.97 10051.29,-18095.73 10052.16,-18102.68"/>
</g>
<!-- layer6_gpu15_token_recv -->
<g id="node625" class="node">
<title>layer6_gpu15_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10974" cy="-18062.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10974" y="-18081.21" font-family="Times,serif" font-size="14.00">Token Receive GPU15</text>
<text text-anchor="middle" x="10974" y="-18066.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10974" y="-18051.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10974" y="-18036.21" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer6_routing&#45;&gt;layer6_gpu15_token_recv -->
<g id="edge729" class="edge">
<title>layer6_routing&#45;&gt;layer6_gpu15_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5859.8,-18211.61C6889.63,-18205.61 9703.77,-18182.89 10630,-18110.5 10665.29,-18107.74 10702.5,-18103.77 10738.88,-18099.29"/>
<polygon fill="black" stroke="black" points="10739.63,-18102.72 10749.12,-18098.01 10738.76,-18095.77 10739.63,-18102.72"/>
</g>
<!-- layer6_gpu0_expert_mlp1 -->
<g id="node551" class="node">
<title>layer6_gpu0_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="673.5,-17978.33 212.5,-17978.33 212.5,-17910.33 673.5,-17910.33 673.5,-17978.33"/>
<text text-anchor="middle" x="443" y="-17963.13" font-family="Times,serif" font-size="14.00">Expert 0 MLP1</text>
<text text-anchor="middle" x="443" y="-17948.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="443" y="-17933.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="443" y="-17918.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer6_gpu0_token_recv&#45;&gt;layer6_gpu0_expert_mlp1 -->
<g id="edge640" class="edge">
<title>layer6_gpu0_token_recv&#45;&gt;layer6_gpu0_expert_mlp1</title>
<path fill="none" stroke="black" d="M461.39,-18014.2C459.13,-18005.72 456.78,-17996.92 454.54,-17988.56"/>
<polygon fill="black" stroke="black" points="457.86,-17987.39 451.89,-17978.63 451.09,-17989.2 457.86,-17987.39"/>
</g>
<!-- layer6_gpu0_expert_act -->
<g id="node552" class="node">
<title>layer6_gpu0_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="601.5,-17874.33 224.5,-17874.33 224.5,-17806.33 601.5,-17806.33 601.5,-17874.33"/>
<text text-anchor="middle" x="413" y="-17859.13" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="413" y="-17844.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="413" y="-17829.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="413" y="-17814.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer6_gpu0_expert_mlp1&#45;&gt;layer6_gpu0_expert_act -->
<g id="edge641" class="edge">
<title>layer6_gpu0_expert_mlp1&#45;&gt;layer6_gpu0_expert_act</title>
<path fill="none" stroke="black" d="M433.26,-17910.21C430.82,-17901.93 428.18,-17892.93 425.62,-17884.24"/>
<polygon fill="black" stroke="black" points="428.97,-17883.24 422.79,-17874.63 422.26,-17885.21 428.97,-17883.24"/>
</g>
<!-- layer6_gpu0_expert_mlp2 -->
<g id="node553" class="node">
<title>layer6_gpu0_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="601.5,-17770.33 194.5,-17770.33 194.5,-17702.33 601.5,-17702.33 601.5,-17770.33"/>
<text text-anchor="middle" x="398" y="-17755.13" font-family="Times,serif" font-size="14.00">Expert 0 MLP2</text>
<text text-anchor="middle" x="398" y="-17740.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="398" y="-17725.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="398" y="-17710.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer6_gpu0_expert_act&#45;&gt;layer6_gpu0_expert_mlp2 -->
<g id="edge642" class="edge">
<title>layer6_gpu0_expert_act&#45;&gt;layer6_gpu0_expert_mlp2</title>
<path fill="none" stroke="black" d="M408.13,-17806.21C406.94,-17798.11 405.64,-17789.31 404.39,-17780.8"/>
<polygon fill="black" stroke="black" points="407.81,-17780.01 402.9,-17770.63 400.89,-17781.03 407.81,-17780.01"/>
</g>
<!-- layer6_gpu0_token_send -->
<g id="node554" class="node">
<title>layer6_gpu0_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="372" cy="-17618.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="372" y="-17637.05" font-family="Times,serif" font-size="14.00">Token Send GPU0</text>
<text text-anchor="middle" x="372" y="-17622.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="372" y="-17607.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="372" y="-17592.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer6_gpu0_expert_mlp2&#45;&gt;layer6_gpu0_token_send -->
<g id="edge643" class="edge">
<title>layer6_gpu0_expert_mlp2&#45;&gt;layer6_gpu0_token_send</title>
<path fill="none" stroke="black" d="M390.55,-17702.07C388.74,-17693.99 386.75,-17685.12 384.77,-17676.28"/>
<polygon fill="black" stroke="black" points="388.15,-17675.35 382.55,-17666.36 381.32,-17676.88 388.15,-17675.35"/>
</g>
<!-- layer6_expert_agg -->
<g id="node630" class="node">
<title>layer6_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="5929.05,-17534.16 5209.94,-17534.16 5024.95,-17398.16 5744.06,-17398.16 5929.05,-17534.16"/>
<text text-anchor="middle" x="5477" y="-17484.96" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5477" y="-17469.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x16)</text>
<text text-anchor="middle" x="5477" y="-17454.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-17439.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer6_gpu0_token_send&#45;&gt;layer6_expert_agg -->
<g id="edge644" class="edge">
<title>layer6_gpu0_token_send&#45;&gt;layer6_expert_agg</title>
<path fill="none" stroke="black" d="M610.99,-17582.63C652.59,-17577.67 695.49,-17573.21 736,-17570.16 1584.6,-17506.25 4154.44,-17478.39 5112.12,-17470.04"/>
<polygon fill="black" stroke="black" points="5112.29,-17473.54 5122.26,-17469.95 5112.23,-17466.54 5112.29,-17473.54"/>
</g>
<!-- layer6_gpu1_expert_mlp1 -->
<g id="node556" class="node">
<title>layer6_gpu1_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="1396.5,-17978.33 935.5,-17978.33 935.5,-17910.33 1396.5,-17910.33 1396.5,-17978.33"/>
<text text-anchor="middle" x="1166" y="-17963.13" font-family="Times,serif" font-size="14.00">Expert 1 MLP1</text>
<text text-anchor="middle" x="1166" y="-17948.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1166" y="-17933.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1166" y="-17918.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer6_gpu1_token_recv&#45;&gt;layer6_gpu1_expert_mlp1 -->
<g id="edge646" class="edge">
<title>layer6_gpu1_token_recv&#45;&gt;layer6_gpu1_expert_mlp1</title>
<path fill="none" stroke="black" d="M1171.93,-18014.2C1171.21,-18005.81 1170.46,-17997.11 1169.75,-17988.84"/>
<polygon fill="black" stroke="black" points="1173.21,-17988.3 1168.87,-17978.63 1166.24,-17988.9 1173.21,-17988.3"/>
</g>
<!-- layer6_gpu1_expert_act -->
<g id="node557" class="node">
<title>layer6_gpu1_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="1336.5,-17874.33 959.5,-17874.33 959.5,-17806.33 1336.5,-17806.33 1336.5,-17874.33"/>
<text text-anchor="middle" x="1148" y="-17859.13" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1148" y="-17844.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1148" y="-17829.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1148" y="-17814.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer6_gpu1_expert_mlp1&#45;&gt;layer6_gpu1_expert_act -->
<g id="edge647" class="edge">
<title>layer6_gpu1_expert_mlp1&#45;&gt;layer6_gpu1_expert_act</title>
<path fill="none" stroke="black" d="M1160.16,-17910.21C1158.71,-17902.02 1157.14,-17893.12 1155.62,-17884.52"/>
<polygon fill="black" stroke="black" points="1159.06,-17883.87 1153.88,-17874.63 1152.17,-17885.09 1159.06,-17883.87"/>
</g>
<!-- layer6_gpu1_expert_mlp2 -->
<g id="node558" class="node">
<title>layer6_gpu1_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="1334.5,-17770.33 927.5,-17770.33 927.5,-17702.33 1334.5,-17702.33 1334.5,-17770.33"/>
<text text-anchor="middle" x="1131" y="-17755.13" font-family="Times,serif" font-size="14.00">Expert 1 MLP2</text>
<text text-anchor="middle" x="1131" y="-17740.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1131" y="-17725.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1131" y="-17710.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer6_gpu1_expert_act&#45;&gt;layer6_gpu1_expert_mlp2 -->
<g id="edge648" class="edge">
<title>layer6_gpu1_expert_act&#45;&gt;layer6_gpu1_expert_mlp2</title>
<path fill="none" stroke="black" d="M1142.48,-17806.21C1141.11,-17798.02 1139.63,-17789.12 1138.2,-17780.52"/>
<polygon fill="black" stroke="black" points="1141.65,-17779.92 1136.55,-17770.63 1134.74,-17781.07 1141.65,-17779.92"/>
</g>
<!-- layer6_gpu1_token_send -->
<g id="node559" class="node">
<title>layer6_gpu1_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1101" cy="-17618.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1101" y="-17637.05" font-family="Times,serif" font-size="14.00">Token Send GPU1</text>
<text text-anchor="middle" x="1101" y="-17622.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1101" y="-17607.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1101" y="-17592.05" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer6_gpu1_expert_mlp2&#45;&gt;layer6_gpu1_token_send -->
<g id="edge649" class="edge">
<title>layer6_gpu1_expert_mlp2&#45;&gt;layer6_gpu1_token_send</title>
<path fill="none" stroke="black" d="M1122.4,-17702.07C1120.31,-17693.99 1118.02,-17685.12 1115.74,-17676.28"/>
<polygon fill="black" stroke="black" points="1119.07,-17675.16 1113.17,-17666.36 1112.29,-17676.91 1119.07,-17675.16"/>
</g>
<!-- layer6_gpu1_token_send&#45;&gt;layer6_expert_agg -->
<g id="edge650" class="edge">
<title>layer6_gpu1_token_send&#45;&gt;layer6_expert_agg</title>
<path fill="none" stroke="black" d="M1340.98,-17582.65C1382.27,-17577.72 1424.82,-17573.27 1465,-17570.16 2167.7,-17515.84 4265.31,-17483.05 5114.3,-17471.69"/>
<polygon fill="black" stroke="black" points="5114.59,-17475.18 5124.54,-17471.55 5114.49,-17468.18 5114.59,-17475.18"/>
</g>
<!-- layer6_gpu2_expert_mlp1 -->
<g id="node561" class="node">
<title>layer6_gpu2_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2125.5,-17978.33 1664.5,-17978.33 1664.5,-17910.33 2125.5,-17910.33 2125.5,-17978.33"/>
<text text-anchor="middle" x="1895" y="-17963.13" font-family="Times,serif" font-size="14.00">Expert 2 MLP1</text>
<text text-anchor="middle" x="1895" y="-17948.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1895" y="-17933.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1895" y="-17918.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer6_gpu2_token_recv&#45;&gt;layer6_gpu2_expert_mlp1 -->
<g id="edge652" class="edge">
<title>layer6_gpu2_token_recv&#45;&gt;layer6_gpu2_expert_mlp1</title>
<path fill="none" stroke="black" d="M1900.93,-18014.2C1900.21,-18005.81 1899.46,-17997.11 1898.75,-17988.84"/>
<polygon fill="black" stroke="black" points="1902.21,-17988.3 1897.87,-17978.63 1895.24,-17988.9 1902.21,-17988.3"/>
</g>
<!-- layer6_gpu2_expert_act -->
<g id="node562" class="node">
<title>layer6_gpu2_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2063.5,-17874.33 1686.5,-17874.33 1686.5,-17806.33 2063.5,-17806.33 2063.5,-17874.33"/>
<text text-anchor="middle" x="1875" y="-17859.13" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="1875" y="-17844.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1875" y="-17829.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1875" y="-17814.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer6_gpu2_expert_mlp1&#45;&gt;layer6_gpu2_expert_act -->
<g id="edge653" class="edge">
<title>layer6_gpu2_expert_mlp1&#45;&gt;layer6_gpu2_expert_act</title>
<path fill="none" stroke="black" d="M1888.51,-17910.21C1886.9,-17902.02 1885.15,-17893.12 1883.47,-17884.52"/>
<polygon fill="black" stroke="black" points="1886.89,-17883.77 1881.53,-17874.63 1880.02,-17885.12 1886.89,-17883.77"/>
</g>
<!-- layer6_gpu2_expert_mlp2 -->
<g id="node563" class="node">
<title>layer6_gpu2_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2056.5,-17770.33 1649.5,-17770.33 1649.5,-17702.33 2056.5,-17702.33 2056.5,-17770.33"/>
<text text-anchor="middle" x="1853" y="-17755.13" font-family="Times,serif" font-size="14.00">Expert 2 MLP2</text>
<text text-anchor="middle" x="1853" y="-17740.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1853" y="-17725.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1853" y="-17710.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer6_gpu2_expert_act&#45;&gt;layer6_gpu2_expert_mlp2 -->
<g id="edge654" class="edge">
<title>layer6_gpu2_expert_act&#45;&gt;layer6_gpu2_expert_mlp2</title>
<path fill="none" stroke="black" d="M1867.86,-17806.21C1866.09,-17798.02 1864.17,-17789.12 1862.32,-17780.52"/>
<polygon fill="black" stroke="black" points="1865.71,-17779.67 1860.18,-17770.63 1858.87,-17781.14 1865.71,-17779.67"/>
</g>
<!-- layer6_gpu2_token_send -->
<g id="node564" class="node">
<title>layer6_gpu2_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1830" cy="-17618.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1830" y="-17637.05" font-family="Times,serif" font-size="14.00">Token Send GPU2</text>
<text text-anchor="middle" x="1830" y="-17622.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1830" y="-17607.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1830" y="-17592.05" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer6_gpu2_expert_mlp2&#45;&gt;layer6_gpu2_token_send -->
<g id="edge655" class="edge">
<title>layer6_gpu2_expert_mlp2&#45;&gt;layer6_gpu2_token_send</title>
<path fill="none" stroke="black" d="M1846.41,-17702.07C1844.81,-17693.99 1843.05,-17685.12 1841.3,-17676.28"/>
<polygon fill="black" stroke="black" points="1844.71,-17675.49 1839.33,-17666.36 1837.84,-17676.85 1844.71,-17675.49"/>
</g>
<!-- layer6_gpu2_token_send&#45;&gt;layer6_expert_agg -->
<g id="edge656" class="edge">
<title>layer6_gpu2_token_send&#45;&gt;layer6_expert_agg</title>
<path fill="none" stroke="black" d="M2070.48,-17582.79C2111.62,-17577.85 2153.98,-17573.37 2194,-17570.16 3249.04,-17485.58 4499.98,-17469.5 5108.15,-17467.06"/>
<polygon fill="black" stroke="black" points="5108.41,-17470.56 5118.39,-17467.02 5108.38,-17463.56 5108.41,-17470.56"/>
</g>
<!-- layer6_gpu3_expert_mlp1 -->
<g id="node566" class="node">
<title>layer6_gpu3_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2829.5,-17978.33 2368.5,-17978.33 2368.5,-17910.33 2829.5,-17910.33 2829.5,-17978.33"/>
<text text-anchor="middle" x="2599" y="-17963.13" font-family="Times,serif" font-size="14.00">Expert 3 MLP1</text>
<text text-anchor="middle" x="2599" y="-17948.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2599" y="-17933.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2599" y="-17918.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer6_gpu3_token_recv&#45;&gt;layer6_gpu3_expert_mlp1 -->
<g id="edge658" class="edge">
<title>layer6_gpu3_token_recv&#45;&gt;layer6_gpu3_expert_mlp1</title>
<path fill="none" stroke="black" d="M2607.31,-18014.2C2606.29,-18005.81 2605.25,-17997.11 2604.25,-17988.84"/>
<polygon fill="black" stroke="black" points="2607.69,-17988.14 2603.02,-17978.63 2600.74,-17988.98 2607.69,-17988.14"/>
</g>
<!-- layer6_gpu3_expert_act -->
<g id="node567" class="node">
<title>layer6_gpu3_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2758.5,-17874.33 2381.5,-17874.33 2381.5,-17806.33 2758.5,-17806.33 2758.5,-17874.33"/>
<text text-anchor="middle" x="2570" y="-17859.13" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="2570" y="-17844.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2570" y="-17829.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2570" y="-17814.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer6_gpu3_expert_mlp1&#45;&gt;layer6_gpu3_expert_act -->
<g id="edge659" class="edge">
<title>layer6_gpu3_expert_mlp1&#45;&gt;layer6_gpu3_expert_act</title>
<path fill="none" stroke="black" d="M2589.58,-17910.21C2587.25,-17902.02 2584.72,-17893.12 2582.28,-17884.52"/>
<polygon fill="black" stroke="black" points="2585.57,-17883.29 2579.47,-17874.63 2578.84,-17885.21 2585.57,-17883.29"/>
</g>
<!-- layer6_gpu3_expert_mlp2 -->
<g id="node568" class="node">
<title>layer6_gpu3_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2769.5,-17770.33 2362.5,-17770.33 2362.5,-17702.33 2769.5,-17702.33 2769.5,-17770.33"/>
<text text-anchor="middle" x="2566" y="-17755.13" font-family="Times,serif" font-size="14.00">Expert 3 MLP2</text>
<text text-anchor="middle" x="2566" y="-17740.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2566" y="-17725.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="2566" y="-17710.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer6_gpu3_expert_act&#45;&gt;layer6_gpu3_expert_mlp2 -->
<g id="edge660" class="edge">
<title>layer6_gpu3_expert_act&#45;&gt;layer6_gpu3_expert_mlp2</title>
<path fill="none" stroke="black" d="M2568.7,-17806.21C2568.38,-17798.11 2568.04,-17789.31 2567.7,-17780.8"/>
<polygon fill="black" stroke="black" points="2571.2,-17780.48 2567.31,-17770.63 2564.2,-17780.76 2571.2,-17780.48"/>
</g>
<!-- layer6_gpu3_token_send -->
<g id="node569" class="node">
<title>layer6_gpu3_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="2559" cy="-17618.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="2559" y="-17637.05" font-family="Times,serif" font-size="14.00">Token Send GPU3</text>
<text text-anchor="middle" x="2559" y="-17622.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="2559" y="-17607.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="2559" y="-17592.05" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer6_gpu3_expert_mlp2&#45;&gt;layer6_gpu3_token_send -->
<g id="edge661" class="edge">
<title>layer6_gpu3_expert_mlp2&#45;&gt;layer6_gpu3_token_send</title>
<path fill="none" stroke="black" d="M2563.99,-17702.07C2563.51,-17694.07 2562.98,-17685.31 2562.46,-17676.56"/>
<polygon fill="black" stroke="black" points="2565.94,-17676.13 2561.84,-17666.36 2558.95,-17676.55 2565.94,-17676.13"/>
</g>
<!-- layer6_gpu3_token_send&#45;&gt;layer6_expert_agg -->
<g id="edge662" class="edge">
<title>layer6_gpu3_token_send&#45;&gt;layer6_expert_agg</title>
<path fill="none" stroke="black" d="M2800.98,-17582.91C2841.65,-17578.01 2883.48,-17573.51 2923,-17570.16 3702.23,-17504.18 4618.9,-17480.23 5114.54,-17471.72"/>
<polygon fill="black" stroke="black" points="5114.77,-17475.21 5124.71,-17471.54 5114.65,-17468.21 5114.77,-17475.21"/>
</g>
<!-- layer6_gpu4_expert_mlp1 -->
<g id="node571" class="node">
<title>layer6_gpu4_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="3528.5,-17978.33 3067.5,-17978.33 3067.5,-17910.33 3528.5,-17910.33 3528.5,-17978.33"/>
<text text-anchor="middle" x="3298" y="-17963.13" font-family="Times,serif" font-size="14.00">Expert 4 MLP1</text>
<text text-anchor="middle" x="3298" y="-17948.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3298" y="-17933.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3298" y="-17918.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer6_gpu4_token_recv&#45;&gt;layer6_gpu4_expert_mlp1 -->
<g id="edge664" class="edge">
<title>layer6_gpu4_token_recv&#45;&gt;layer6_gpu4_expert_mlp1</title>
<path fill="none" stroke="black" d="M3302.75,-18014.2C3302.17,-18005.81 3301.57,-17997.11 3301,-17988.84"/>
<polygon fill="black" stroke="black" points="3304.47,-17988.37 3300.3,-17978.63 3297.49,-17988.85 3304.47,-17988.37"/>
</g>
<!-- layer6_gpu4_expert_act -->
<g id="node572" class="node">
<title>layer6_gpu4_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="3482.5,-17874.33 3105.5,-17874.33 3105.5,-17806.33 3482.5,-17806.33 3482.5,-17874.33"/>
<text text-anchor="middle" x="3294" y="-17859.13" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="3294" y="-17844.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3294" y="-17829.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3294" y="-17814.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer6_gpu4_expert_mlp1&#45;&gt;layer6_gpu4_expert_act -->
<g id="edge665" class="edge">
<title>layer6_gpu4_expert_mlp1&#45;&gt;layer6_gpu4_expert_act</title>
<path fill="none" stroke="black" d="M3296.7,-17910.21C3296.38,-17902.11 3296.04,-17893.31 3295.7,-17884.8"/>
<polygon fill="black" stroke="black" points="3299.2,-17884.48 3295.31,-17874.63 3292.2,-17884.76 3299.2,-17884.48"/>
</g>
<!-- layer6_gpu4_expert_mlp2 -->
<g id="node573" class="node">
<title>layer6_gpu4_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="3493.5,-17770.33 3086.5,-17770.33 3086.5,-17702.33 3493.5,-17702.33 3493.5,-17770.33"/>
<text text-anchor="middle" x="3290" y="-17755.13" font-family="Times,serif" font-size="14.00">Expert 4 MLP2</text>
<text text-anchor="middle" x="3290" y="-17740.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3290" y="-17725.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="3290" y="-17710.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer6_gpu4_expert_act&#45;&gt;layer6_gpu4_expert_mlp2 -->
<g id="edge666" class="edge">
<title>layer6_gpu4_expert_act&#45;&gt;layer6_gpu4_expert_mlp2</title>
<path fill="none" stroke="black" d="M3292.7,-17806.21C3292.38,-17798.11 3292.04,-17789.31 3291.7,-17780.8"/>
<polygon fill="black" stroke="black" points="3295.2,-17780.48 3291.31,-17770.63 3288.2,-17780.76 3295.2,-17780.48"/>
</g>
<!-- layer6_gpu4_token_send -->
<g id="node574" class="node">
<title>layer6_gpu4_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="3288" cy="-17618.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="3288" y="-17637.05" font-family="Times,serif" font-size="14.00">Token Send GPU4</text>
<text text-anchor="middle" x="3288" y="-17622.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="3288" y="-17607.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="3288" y="-17592.05" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer6_gpu4_expert_mlp2&#45;&gt;layer6_gpu4_token_send -->
<g id="edge667" class="edge">
<title>layer6_gpu4_expert_mlp2&#45;&gt;layer6_gpu4_token_send</title>
<path fill="none" stroke="black" d="M3289.43,-17702.07C3289.29,-17694.07 3289.14,-17685.31 3288.99,-17676.56"/>
<polygon fill="black" stroke="black" points="3292.48,-17676.29 3288.81,-17666.36 3285.48,-17676.42 3292.48,-17676.29"/>
</g>
<!-- layer6_gpu4_token_send&#45;&gt;layer6_expert_agg -->
<g id="edge668" class="edge">
<title>layer6_gpu4_token_send&#45;&gt;layer6_expert_agg</title>
<path fill="none" stroke="black" d="M3531.99,-17583.22C3572.03,-17578.34 3613.14,-17573.77 3652,-17570.16 4162.99,-17522.76 4756.65,-17494.14 5124.62,-17479.5"/>
<polygon fill="black" stroke="black" points="5124.78,-17482.99 5134.63,-17479.1 5124.5,-17476 5124.78,-17482.99"/>
</g>
<!-- layer6_gpu5_expert_mlp1 -->
<g id="node576" class="node">
<title>layer6_gpu5_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4268.5,-17978.33 3807.5,-17978.33 3807.5,-17910.33 4268.5,-17910.33 4268.5,-17978.33"/>
<text text-anchor="middle" x="4038" y="-17963.13" font-family="Times,serif" font-size="14.00">Expert 5 MLP1</text>
<text text-anchor="middle" x="4038" y="-17948.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4038" y="-17933.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4038" y="-17918.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer6_gpu5_token_recv&#45;&gt;layer6_gpu5_expert_mlp1 -->
<g id="edge670" class="edge">
<title>layer6_gpu5_token_recv&#45;&gt;layer6_gpu5_expert_mlp1</title>
<path fill="none" stroke="black" d="M4048.68,-18014.2C4047.36,-18005.72 4046,-17996.92 4044.7,-17988.56"/>
<polygon fill="black" stroke="black" points="4048.16,-17987.98 4043.16,-17978.63 4041.24,-17989.05 4048.16,-17987.98"/>
</g>
<!-- layer6_gpu5_expert_act -->
<g id="node577" class="node">
<title>layer6_gpu5_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4219.5,-17874.33 3842.5,-17874.33 3842.5,-17806.33 4219.5,-17806.33 4219.5,-17874.33"/>
<text text-anchor="middle" x="4031" y="-17859.13" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="4031" y="-17844.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4031" y="-17829.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4031" y="-17814.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer6_gpu5_expert_mlp1&#45;&gt;layer6_gpu5_expert_act -->
<g id="edge671" class="edge">
<title>layer6_gpu5_expert_mlp1&#45;&gt;layer6_gpu5_expert_act</title>
<path fill="none" stroke="black" d="M4035.73,-17910.21C4035.17,-17902.11 4034.57,-17893.31 4033.98,-17884.8"/>
<polygon fill="black" stroke="black" points="4037.46,-17884.37 4033.29,-17874.63 4030.48,-17884.85 4037.46,-17884.37"/>
</g>
<!-- layer6_gpu5_expert_mlp2 -->
<g id="node578" class="node">
<title>layer6_gpu5_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4229.5,-17770.33 3822.5,-17770.33 3822.5,-17702.33 4229.5,-17702.33 4229.5,-17770.33"/>
<text text-anchor="middle" x="4026" y="-17755.13" font-family="Times,serif" font-size="14.00">Expert 5 MLP2</text>
<text text-anchor="middle" x="4026" y="-17740.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4026" y="-17725.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4026" y="-17710.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer6_gpu5_expert_act&#45;&gt;layer6_gpu5_expert_mlp2 -->
<g id="edge672" class="edge">
<title>layer6_gpu5_expert_act&#45;&gt;layer6_gpu5_expert_mlp2</title>
<path fill="none" stroke="black" d="M4029.38,-17806.21C4028.98,-17798.11 4028.55,-17789.31 4028.13,-17780.8"/>
<polygon fill="black" stroke="black" points="4031.62,-17780.45 4027.63,-17770.63 4024.63,-17780.79 4031.62,-17780.45"/>
</g>
<!-- layer6_gpu5_token_send -->
<g id="node579" class="node">
<title>layer6_gpu5_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4017" cy="-17618.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4017" y="-17637.05" font-family="Times,serif" font-size="14.00">Token Send GPU5</text>
<text text-anchor="middle" x="4017" y="-17622.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4017" y="-17607.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4017" y="-17592.05" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer6_gpu5_expert_mlp2&#45;&gt;layer6_gpu5_token_send -->
<g id="edge673" class="edge">
<title>layer6_gpu5_expert_mlp2&#45;&gt;layer6_gpu5_token_send</title>
<path fill="none" stroke="black" d="M4023.42,-17702.07C4022.8,-17694.07 4022.12,-17685.31 4021.44,-17676.56"/>
<polygon fill="black" stroke="black" points="4024.92,-17676.06 4020.65,-17666.36 4017.94,-17676.6 4024.92,-17676.06"/>
</g>
<!-- layer6_gpu5_token_send&#45;&gt;layer6_expert_agg -->
<g id="edge674" class="edge">
<title>layer6_gpu5_token_send&#45;&gt;layer6_expert_agg</title>
<path fill="none" stroke="black" d="M4266.02,-17583.86C4304.5,-17579.04 4343.8,-17574.32 4381,-17570.16 4637.39,-17541.54 4928.13,-17514.47 5145.7,-17495.27"/>
<polygon fill="black" stroke="black" points="5146.03,-17498.75 5155.68,-17494.39 5145.41,-17491.78 5146.03,-17498.75"/>
</g>
<!-- layer6_gpu6_expert_mlp1 -->
<g id="node581" class="node">
<title>layer6_gpu6_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4998.5,-17978.33 4537.5,-17978.33 4537.5,-17910.33 4998.5,-17910.33 4998.5,-17978.33"/>
<text text-anchor="middle" x="4768" y="-17963.13" font-family="Times,serif" font-size="14.00">Expert 6 MLP1</text>
<text text-anchor="middle" x="4768" y="-17948.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4768" y="-17933.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4768" y="-17918.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_gpu6_token_recv&#45;&gt;layer6_gpu6_expert_mlp1 -->
<g id="edge676" class="edge">
<title>layer6_gpu6_token_recv&#45;&gt;layer6_gpu6_expert_mlp1</title>
<path fill="none" stroke="black" d="M4771.56,-18014.2C4771.13,-18005.81 4770.68,-17997.11 4770.25,-17988.84"/>
<polygon fill="black" stroke="black" points="4773.73,-17988.44 4769.72,-17978.63 4766.74,-17988.8 4773.73,-17988.44"/>
</g>
<!-- layer6_gpu6_expert_act -->
<g id="node582" class="node">
<title>layer6_gpu6_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4943.5,-17874.33 4566.5,-17874.33 4566.5,-17806.33 4943.5,-17806.33 4943.5,-17874.33"/>
<text text-anchor="middle" x="4755" y="-17859.13" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="4755" y="-17844.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4755" y="-17829.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4755" y="-17814.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_gpu6_expert_mlp1&#45;&gt;layer6_gpu6_expert_act -->
<g id="edge677" class="edge">
<title>layer6_gpu6_expert_mlp1&#45;&gt;layer6_gpu6_expert_act</title>
<path fill="none" stroke="black" d="M4763.78,-17910.21C4762.75,-17902.11 4761.63,-17893.31 4760.54,-17884.8"/>
<polygon fill="black" stroke="black" points="4763.98,-17884.11 4759.24,-17874.63 4757.04,-17884.99 4763.98,-17884.11"/>
</g>
<!-- layer6_gpu6_expert_mlp2 -->
<g id="node583" class="node">
<title>layer6_gpu6_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4955.5,-17770.33 4548.5,-17770.33 4548.5,-17702.33 4955.5,-17702.33 4955.5,-17770.33"/>
<text text-anchor="middle" x="4752" y="-17755.13" font-family="Times,serif" font-size="14.00">Expert 6 MLP2</text>
<text text-anchor="middle" x="4752" y="-17740.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4752" y="-17725.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4752" y="-17710.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_gpu6_expert_act&#45;&gt;layer6_gpu6_expert_mlp2 -->
<g id="edge678" class="edge">
<title>layer6_gpu6_expert_act&#45;&gt;layer6_gpu6_expert_mlp2</title>
<path fill="none" stroke="black" d="M4754.03,-17806.21C4753.79,-17798.11 4753.53,-17789.31 4753.28,-17780.8"/>
<polygon fill="black" stroke="black" points="4756.77,-17780.52 4752.98,-17770.63 4749.77,-17780.73 4756.77,-17780.52"/>
</g>
<!-- layer6_gpu6_token_send -->
<g id="node584" class="node">
<title>layer6_gpu6_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4746" cy="-17618.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4746" y="-17637.05" font-family="Times,serif" font-size="14.00">Token Send GPU6</text>
<text text-anchor="middle" x="4746" y="-17622.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4746" y="-17607.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4746" y="-17592.05" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_gpu6_expert_mlp2&#45;&gt;layer6_gpu6_token_send -->
<g id="edge679" class="edge">
<title>layer6_gpu6_expert_mlp2&#45;&gt;layer6_gpu6_token_send</title>
<path fill="none" stroke="black" d="M4750.28,-17702.07C4749.87,-17694.07 4749.41,-17685.31 4748.96,-17676.56"/>
<polygon fill="black" stroke="black" points="4752.45,-17676.16 4748.43,-17666.36 4745.46,-17676.52 4752.45,-17676.16"/>
</g>
<!-- layer6_gpu6_token_send&#45;&gt;layer6_expert_agg -->
<g id="edge680" class="edge">
<title>layer6_gpu6_token_send&#45;&gt;layer6_expert_agg</title>
<path fill="none" stroke="black" d="M4938.54,-17577.72C5014.53,-17562.12 5103.48,-17543.85 5186.94,-17526.72"/>
<polygon fill="black" stroke="black" points="5187.74,-17530.13 5196.83,-17524.69 5186.33,-17523.27 5187.74,-17530.13"/>
</g>
<!-- layer6_gpu7_expert_mlp1 -->
<g id="node586" class="node">
<title>layer6_gpu7_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5707.5,-17978.33 5246.5,-17978.33 5246.5,-17910.33 5707.5,-17910.33 5707.5,-17978.33"/>
<text text-anchor="middle" x="5477" y="-17963.13" font-family="Times,serif" font-size="14.00">Expert 7 MLP1</text>
<text text-anchor="middle" x="5477" y="-17948.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5477" y="-17933.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5477" y="-17918.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer6_gpu7_token_recv&#45;&gt;layer6_gpu7_expert_mlp1 -->
<g id="edge682" class="edge">
<title>layer6_gpu7_token_recv&#45;&gt;layer6_gpu7_expert_mlp1</title>
<path fill="none" stroke="black" d="M5477,-18014.2C5477,-18005.81 5477,-17997.11 5477,-17988.84"/>
<polygon fill="black" stroke="black" points="5480.5,-17988.63 5477,-17978.63 5473.5,-17988.63 5480.5,-17988.63"/>
</g>
<!-- layer6_gpu7_expert_act -->
<g id="node587" class="node">
<title>layer6_gpu7_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="5665.5,-17874.33 5288.5,-17874.33 5288.5,-17806.33 5665.5,-17806.33 5665.5,-17874.33"/>
<text text-anchor="middle" x="5477" y="-17859.13" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="5477" y="-17844.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5477" y="-17829.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5477" y="-17814.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer6_gpu7_expert_mlp1&#45;&gt;layer6_gpu7_expert_act -->
<g id="edge683" class="edge">
<title>layer6_gpu7_expert_mlp1&#45;&gt;layer6_gpu7_expert_act</title>
<path fill="none" stroke="black" d="M5477,-17910.21C5477,-17902.11 5477,-17893.31 5477,-17884.8"/>
<polygon fill="black" stroke="black" points="5480.5,-17884.63 5477,-17874.63 5473.5,-17884.63 5480.5,-17884.63"/>
</g>
<!-- layer6_gpu7_expert_mlp2 -->
<g id="node588" class="node">
<title>layer6_gpu7_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="5680.5,-17770.33 5273.5,-17770.33 5273.5,-17702.33 5680.5,-17702.33 5680.5,-17770.33"/>
<text text-anchor="middle" x="5477" y="-17755.13" font-family="Times,serif" font-size="14.00">Expert 7 MLP2</text>
<text text-anchor="middle" x="5477" y="-17740.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5477" y="-17725.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-17710.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer6_gpu7_expert_act&#45;&gt;layer6_gpu7_expert_mlp2 -->
<g id="edge684" class="edge">
<title>layer6_gpu7_expert_act&#45;&gt;layer6_gpu7_expert_mlp2</title>
<path fill="none" stroke="black" d="M5477,-17806.21C5477,-17798.11 5477,-17789.31 5477,-17780.8"/>
<polygon fill="black" stroke="black" points="5480.5,-17780.63 5477,-17770.63 5473.5,-17780.63 5480.5,-17780.63"/>
</g>
<!-- layer6_gpu7_token_send -->
<g id="node589" class="node">
<title>layer6_gpu7_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="5475" cy="-17618.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="5475" y="-17637.05" font-family="Times,serif" font-size="14.00">Token Send GPU7</text>
<text text-anchor="middle" x="5475" y="-17622.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="5475" y="-17607.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="5475" y="-17592.05" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer6_gpu7_expert_mlp2&#45;&gt;layer6_gpu7_token_send -->
<g id="edge685" class="edge">
<title>layer6_gpu7_expert_mlp2&#45;&gt;layer6_gpu7_token_send</title>
<path fill="none" stroke="black" d="M5476.43,-17702.07C5476.29,-17694.07 5476.14,-17685.31 5475.99,-17676.56"/>
<polygon fill="black" stroke="black" points="5479.48,-17676.29 5475.81,-17666.36 5472.48,-17676.42 5479.48,-17676.29"/>
</g>
<!-- layer6_gpu7_token_send&#45;&gt;layer6_expert_agg -->
<g id="edge686" class="edge">
<title>layer6_gpu7_token_send&#45;&gt;layer6_expert_agg</title>
<path fill="none" stroke="black" d="M5475.63,-17569.76C5475.74,-17561.67 5475.85,-17553.09 5475.97,-17544.47"/>
<polygon fill="black" stroke="black" points="5479.47,-17544.4 5476.1,-17534.36 5472.47,-17544.31 5479.47,-17544.4"/>
</g>
<!-- layer6_gpu8_expert_mlp1 -->
<g id="node591" class="node">
<title>layer6_gpu8_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="6400.5,-17978.33 5939.5,-17978.33 5939.5,-17910.33 6400.5,-17910.33 6400.5,-17978.33"/>
<text text-anchor="middle" x="6170" y="-17963.13" font-family="Times,serif" font-size="14.00">Expert 8 MLP1</text>
<text text-anchor="middle" x="6170" y="-17948.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6170" y="-17933.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6170" y="-17918.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer6_gpu8_token_recv&#45;&gt;layer6_gpu8_expert_mlp1 -->
<g id="edge688" class="edge">
<title>layer6_gpu8_token_recv&#45;&gt;layer6_gpu8_expert_mlp1</title>
<path fill="none" stroke="black" d="M6167.03,-18014.2C6167.39,-18005.81 6167.77,-17997.11 6168.13,-17988.84"/>
<polygon fill="black" stroke="black" points="6171.63,-17988.78 6168.57,-17978.63 6164.64,-17988.47 6171.63,-17988.78"/>
</g>
<!-- layer6_gpu8_expert_act -->
<g id="node592" class="node">
<title>layer6_gpu8_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="6368.5,-17874.33 5991.5,-17874.33 5991.5,-17806.33 6368.5,-17806.33 6368.5,-17874.33"/>
<text text-anchor="middle" x="6180" y="-17859.13" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="6180" y="-17844.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6180" y="-17829.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6180" y="-17814.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer6_gpu8_expert_mlp1&#45;&gt;layer6_gpu8_expert_act -->
<g id="edge689" class="edge">
<title>layer6_gpu8_expert_mlp1&#45;&gt;layer6_gpu8_expert_act</title>
<path fill="none" stroke="black" d="M6173.25,-17910.21C6174.04,-17902.11 6174.9,-17893.31 6175.74,-17884.8"/>
<polygon fill="black" stroke="black" points="6179.24,-17884.92 6176.74,-17874.63 6172.28,-17884.24 6179.24,-17884.92"/>
</g>
<!-- layer6_gpu8_expert_mlp2 -->
<g id="node593" class="node">
<title>layer6_gpu8_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="6403.5,-17770.33 5996.5,-17770.33 5996.5,-17702.33 6403.5,-17702.33 6403.5,-17770.33"/>
<text text-anchor="middle" x="6200" y="-17755.13" font-family="Times,serif" font-size="14.00">Expert 8 MLP2</text>
<text text-anchor="middle" x="6200" y="-17740.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6200" y="-17725.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6200" y="-17710.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer6_gpu8_expert_act&#45;&gt;layer6_gpu8_expert_mlp2 -->
<g id="edge690" class="edge">
<title>layer6_gpu8_expert_act&#45;&gt;layer6_gpu8_expert_mlp2</title>
<path fill="none" stroke="black" d="M6186.49,-17806.21C6188.1,-17798.02 6189.85,-17789.12 6191.53,-17780.52"/>
<polygon fill="black" stroke="black" points="6194.98,-17781.12 6193.47,-17770.63 6188.11,-17779.77 6194.98,-17781.12"/>
</g>
<!-- layer6_gpu8_token_send -->
<g id="node594" class="node">
<title>layer6_gpu8_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6204" cy="-17618.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6204" y="-17637.05" font-family="Times,serif" font-size="14.00">Token Send GPU8</text>
<text text-anchor="middle" x="6204" y="-17622.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6204" y="-17607.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6204" y="-17592.05" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer6_gpu8_expert_mlp2&#45;&gt;layer6_gpu8_token_send -->
<g id="edge691" class="edge">
<title>layer6_gpu8_expert_mlp2&#45;&gt;layer6_gpu8_token_send</title>
<path fill="none" stroke="black" d="M6201.15,-17702.07C6201.42,-17694.07 6201.72,-17685.31 6202.03,-17676.56"/>
<polygon fill="black" stroke="black" points="6205.53,-17676.47 6202.38,-17666.36 6198.53,-17676.23 6205.53,-17676.47"/>
</g>
<!-- layer6_gpu8_token_send&#45;&gt;layer6_expert_agg -->
<g id="edge692" class="edge">
<title>layer6_gpu8_token_send&#45;&gt;layer6_expert_agg</title>
<path fill="none" stroke="black" d="M6012.51,-17577.72C5950.86,-17564.99 5880.64,-17550.49 5811.79,-17536.28"/>
<polygon fill="black" stroke="black" points="5812.14,-17532.78 5801.64,-17534.18 5810.73,-17539.63 5812.14,-17532.78"/>
</g>
<!-- layer6_gpu9_expert_mlp1 -->
<g id="node596" class="node">
<title>layer6_gpu9_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7091.5,-17978.33 6630.5,-17978.33 6630.5,-17910.33 7091.5,-17910.33 7091.5,-17978.33"/>
<text text-anchor="middle" x="6861" y="-17963.13" font-family="Times,serif" font-size="14.00">Expert 9 MLP1</text>
<text text-anchor="middle" x="6861" y="-17948.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6861" y="-17933.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6861" y="-17918.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer6_gpu9_token_recv&#45;&gt;layer6_gpu9_expert_mlp1 -->
<g id="edge694" class="edge">
<title>layer6_gpu9_token_recv&#45;&gt;layer6_gpu9_expert_mlp1</title>
<path fill="none" stroke="black" d="M6855.66,-18014.2C6856.31,-18005.81 6856.99,-17997.11 6857.63,-17988.84"/>
<polygon fill="black" stroke="black" points="6861.13,-17988.87 6858.42,-17978.63 6854.16,-17988.33 6861.13,-17988.87"/>
</g>
<!-- layer6_gpu9_expert_act -->
<g id="node597" class="node">
<title>layer6_gpu9_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7070.5,-17874.33 6693.5,-17874.33 6693.5,-17806.33 7070.5,-17806.33 7070.5,-17874.33"/>
<text text-anchor="middle" x="6882" y="-17859.13" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="6882" y="-17844.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6882" y="-17829.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6882" y="-17814.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer6_gpu9_expert_mlp1&#45;&gt;layer6_gpu9_expert_act -->
<g id="edge695" class="edge">
<title>layer6_gpu9_expert_mlp1&#45;&gt;layer6_gpu9_expert_act</title>
<path fill="none" stroke="black" d="M6867.82,-17910.21C6869.51,-17902.02 6871.34,-17893.12 6873.11,-17884.52"/>
<polygon fill="black" stroke="black" points="6876.56,-17885.13 6875.14,-17874.63 6869.7,-17883.72 6876.56,-17885.13"/>
</g>
<!-- layer6_gpu9_expert_mlp2 -->
<g id="node598" class="node">
<title>layer6_gpu9_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7095.5,-17770.33 6688.5,-17770.33 6688.5,-17702.33 7095.5,-17702.33 7095.5,-17770.33"/>
<text text-anchor="middle" x="6892" y="-17755.13" font-family="Times,serif" font-size="14.00">Expert 9 MLP2</text>
<text text-anchor="middle" x="6892" y="-17740.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6892" y="-17725.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6892" y="-17710.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer6_gpu9_expert_act&#45;&gt;layer6_gpu9_expert_mlp2 -->
<g id="edge696" class="edge">
<title>layer6_gpu9_expert_act&#45;&gt;layer6_gpu9_expert_mlp2</title>
<path fill="none" stroke="black" d="M6885.25,-17806.21C6886.04,-17798.11 6886.9,-17789.31 6887.74,-17780.8"/>
<polygon fill="black" stroke="black" points="6891.24,-17780.92 6888.74,-17770.63 6884.28,-17780.24 6891.24,-17780.92"/>
</g>
<!-- layer6_gpu9_token_send -->
<g id="node599" class="node">
<title>layer6_gpu9_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6933" cy="-17618.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6933" y="-17637.05" font-family="Times,serif" font-size="14.00">Token Send GPU9</text>
<text text-anchor="middle" x="6933" y="-17622.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6933" y="-17607.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6933" y="-17592.05" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer6_gpu9_expert_mlp2&#45;&gt;layer6_gpu9_token_send -->
<g id="edge697" class="edge">
<title>layer6_gpu9_expert_mlp2&#45;&gt;layer6_gpu9_token_send</title>
<path fill="none" stroke="black" d="M6903.75,-17702.07C6906.63,-17693.9 6909.8,-17684.93 6912.96,-17675.99"/>
<polygon fill="black" stroke="black" points="6916.33,-17676.95 6916.36,-17666.36 6909.73,-17674.62 6916.33,-17676.95"/>
</g>
<!-- layer6_gpu9_token_send&#45;&gt;layer6_expert_agg -->
<g id="edge698" class="edge">
<title>layer6_gpu9_token_send&#45;&gt;layer6_expert_agg</title>
<path fill="none" stroke="black" d="M6683.98,-17583.87C6645.5,-17579.05 6606.2,-17574.32 6569,-17570.16 6347.19,-17545.36 6099.58,-17521.68 5896.29,-17503.29"/>
<polygon fill="black" stroke="black" points="5896.31,-17499.78 5886.03,-17502.37 5895.68,-17506.75 5896.31,-17499.78"/>
</g>
<!-- layer6_gpu10_expert_mlp1 -->
<g id="node601" class="node">
<title>layer6_gpu10_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7800.5,-17978.33 7339.5,-17978.33 7339.5,-17910.33 7800.5,-17910.33 7800.5,-17978.33"/>
<text text-anchor="middle" x="7570" y="-17963.13" font-family="Times,serif" font-size="14.00">Expert 10 MLP1</text>
<text text-anchor="middle" x="7570" y="-17948.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7570" y="-17933.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7570" y="-17918.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer6_gpu10_token_recv&#45;&gt;layer6_gpu10_expert_mlp1 -->
<g id="edge700" class="edge">
<title>layer6_gpu10_token_recv&#45;&gt;layer6_gpu10_expert_mlp1</title>
<path fill="none" stroke="black" d="M7551.61,-18014.2C7553.87,-18005.72 7556.22,-17996.92 7558.46,-17988.56"/>
<polygon fill="black" stroke="black" points="7561.91,-17989.2 7561.11,-17978.63 7555.14,-17987.39 7561.91,-17989.2"/>
</g>
<!-- layer6_gpu10_expert_act -->
<g id="node602" class="node">
<title>layer6_gpu10_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7774.5,-17874.33 7397.5,-17874.33 7397.5,-17806.33 7774.5,-17806.33 7774.5,-17874.33"/>
<text text-anchor="middle" x="7586" y="-17859.13" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="7586" y="-17844.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7586" y="-17829.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7586" y="-17814.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer6_gpu10_expert_mlp1&#45;&gt;layer6_gpu10_expert_act -->
<g id="edge701" class="edge">
<title>layer6_gpu10_expert_mlp1&#45;&gt;layer6_gpu10_expert_act</title>
<path fill="none" stroke="black" d="M7575.19,-17910.21C7576.48,-17902.02 7577.88,-17893.12 7579.22,-17884.52"/>
<polygon fill="black" stroke="black" points="7582.68,-17885.05 7580.78,-17874.63 7575.77,-17883.97 7582.68,-17885.05"/>
</g>
<!-- layer6_gpu10_expert_mlp2 -->
<g id="node603" class="node">
<title>layer6_gpu10_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7803.5,-17770.33 7396.5,-17770.33 7396.5,-17702.33 7803.5,-17702.33 7803.5,-17770.33"/>
<text text-anchor="middle" x="7600" y="-17755.13" font-family="Times,serif" font-size="14.00">Expert 10 MLP2</text>
<text text-anchor="middle" x="7600" y="-17740.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7600" y="-17725.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="7600" y="-17710.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer6_gpu10_expert_act&#45;&gt;layer6_gpu10_expert_mlp2 -->
<g id="edge702" class="edge">
<title>layer6_gpu10_expert_act&#45;&gt;layer6_gpu10_expert_mlp2</title>
<path fill="none" stroke="black" d="M7590.55,-17806.21C7591.66,-17798.11 7592.87,-17789.31 7594.03,-17780.8"/>
<polygon fill="black" stroke="black" points="7597.54,-17781.01 7595.43,-17770.63 7590.6,-17780.06 7597.54,-17781.01"/>
</g>
<!-- layer6_gpu10_token_send -->
<g id="node604" class="node">
<title>layer6_gpu10_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="7662" cy="-17618.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="7662" y="-17637.05" font-family="Times,serif" font-size="14.00">Token Send GPU10</text>
<text text-anchor="middle" x="7662" y="-17622.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="7662" y="-17607.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="7662" y="-17592.05" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer6_gpu10_expert_mlp2&#45;&gt;layer6_gpu10_token_send -->
<g id="edge703" class="edge">
<title>layer6_gpu10_expert_mlp2&#45;&gt;layer6_gpu10_token_send</title>
<path fill="none" stroke="black" d="M7617.77,-17702.07C7622.22,-17693.72 7627.13,-17684.54 7632,-17675.42"/>
<polygon fill="black" stroke="black" points="7635.21,-17676.83 7636.84,-17666.36 7629.04,-17673.53 7635.21,-17676.83"/>
</g>
<!-- layer6_gpu10_token_send&#45;&gt;layer6_expert_agg -->
<g id="edge704" class="edge">
<title>layer6_gpu10_token_send&#45;&gt;layer6_expert_agg</title>
<path fill="none" stroke="black" d="M7418.01,-17583.22C7377.96,-17578.35 7336.86,-17573.77 7298,-17570.16 6805.31,-17524.43 6235.61,-17496.15 5866.49,-17481.06"/>
<polygon fill="black" stroke="black" points="5866.58,-17477.56 5856.44,-17480.65 5866.29,-17484.55 5866.58,-17477.56"/>
</g>
<!-- layer6_gpu11_expert_mlp1 -->
<g id="node606" class="node">
<title>layer6_gpu11_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="8475.5,-17978.33 8014.5,-17978.33 8014.5,-17910.33 8475.5,-17910.33 8475.5,-17978.33"/>
<text text-anchor="middle" x="8245" y="-17963.13" font-family="Times,serif" font-size="14.00">Expert 11 MLP1</text>
<text text-anchor="middle" x="8245" y="-17948.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8245" y="-17933.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8245" y="-17918.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer6_gpu11_token_recv&#45;&gt;layer6_gpu11_expert_mlp1 -->
<g id="edge706" class="edge">
<title>layer6_gpu11_token_recv&#45;&gt;layer6_gpu11_expert_mlp1</title>
<path fill="none" stroke="black" d="M8233.73,-18014.2C8235.12,-18005.72 8236.56,-17996.92 8237.92,-17988.56"/>
<polygon fill="black" stroke="black" points="8241.39,-17989.07 8239.55,-17978.63 8234.48,-17987.94 8241.39,-17989.07"/>
</g>
<!-- layer6_gpu11_expert_act -->
<g id="node607" class="node">
<title>layer6_gpu11_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="8475.5,-17874.33 8098.5,-17874.33 8098.5,-17806.33 8475.5,-17806.33 8475.5,-17874.33"/>
<text text-anchor="middle" x="8287" y="-17859.13" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="8287" y="-17844.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8287" y="-17829.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8287" y="-17814.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer6_gpu11_expert_mlp1&#45;&gt;layer6_gpu11_expert_act -->
<g id="edge707" class="edge">
<title>layer6_gpu11_expert_mlp1&#45;&gt;layer6_gpu11_expert_act</title>
<path fill="none" stroke="black" d="M8258.64,-17910.21C8262.08,-17901.84 8265.83,-17892.73 8269.45,-17883.96"/>
<polygon fill="black" stroke="black" points="8272.72,-17885.21 8273.29,-17874.63 8266.24,-17882.54 8272.72,-17885.21"/>
</g>
<!-- layer6_gpu11_expert_mlp2 -->
<g id="node608" class="node">
<title>layer6_gpu11_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="8573.5,-17770.33 8166.5,-17770.33 8166.5,-17702.33 8573.5,-17702.33 8573.5,-17770.33"/>
<text text-anchor="middle" x="8370" y="-17755.13" font-family="Times,serif" font-size="14.00">Expert 11 MLP2</text>
<text text-anchor="middle" x="8370" y="-17740.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8370" y="-17725.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="8370" y="-17710.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer6_gpu11_expert_act&#45;&gt;layer6_gpu11_expert_mlp2 -->
<g id="edge708" class="edge">
<title>layer6_gpu11_expert_act&#45;&gt;layer6_gpu11_expert_mlp2</title>
<path fill="none" stroke="black" d="M8313.95,-17806.21C8321.12,-17797.4 8328.96,-17787.76 8336.45,-17778.57"/>
<polygon fill="black" stroke="black" points="8339.31,-17780.6 8342.9,-17770.63 8333.88,-17776.18 8339.31,-17780.6"/>
</g>
<!-- layer6_gpu11_token_send -->
<g id="node609" class="node">
<title>layer6_gpu11_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="8391" cy="-17618.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="8391" y="-17637.05" font-family="Times,serif" font-size="14.00">Token Send GPU11</text>
<text text-anchor="middle" x="8391" y="-17622.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="8391" y="-17607.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="8391" y="-17592.05" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer6_gpu11_expert_mlp2&#45;&gt;layer6_gpu11_token_send -->
<g id="edge709" class="edge">
<title>layer6_gpu11_expert_mlp2&#45;&gt;layer6_gpu11_token_send</title>
<path fill="none" stroke="black" d="M8376.02,-17702.07C8377.48,-17693.99 8379.08,-17685.12 8380.68,-17676.28"/>
<polygon fill="black" stroke="black" points="8384.14,-17676.82 8382.48,-17666.36 8377.25,-17675.57 8384.14,-17676.82"/>
</g>
<!-- layer6_gpu11_token_send&#45;&gt;layer6_expert_agg -->
<g id="edge710" class="edge">
<title>layer6_gpu11_token_send&#45;&gt;layer6_expert_agg</title>
<path fill="none" stroke="black" d="M8149.02,-17582.91C8108.35,-17578.02 8066.52,-17573.51 8027,-17570.16 7257.21,-17504.96 6353.08,-17480.79 5854.72,-17472.01"/>
<polygon fill="black" stroke="black" points="5854.55,-17468.51 5844.49,-17471.83 5854.43,-17475.51 5854.55,-17468.51"/>
</g>
<!-- layer6_gpu12_expert_mlp1 -->
<g id="node611" class="node">
<title>layer6_gpu12_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9240.5,-17978.33 8779.5,-17978.33 8779.5,-17910.33 9240.5,-17910.33 9240.5,-17978.33"/>
<text text-anchor="middle" x="9010" y="-17963.13" font-family="Times,serif" font-size="14.00">Expert 12 MLP1</text>
<text text-anchor="middle" x="9010" y="-17948.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9010" y="-17933.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9010" y="-17918.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer6_gpu12_token_recv&#45;&gt;layer6_gpu12_expert_mlp1 -->
<g id="edge712" class="edge">
<title>layer6_gpu12_token_recv&#45;&gt;layer6_gpu12_expert_mlp1</title>
<path fill="none" stroke="black" d="M8952.17,-18014.53C8959.98,-18005.19 8968.13,-17995.44 8975.75,-17986.32"/>
<polygon fill="black" stroke="black" points="8978.57,-17988.4 8982.3,-17978.48 8973.2,-17983.91 8978.57,-17988.4"/>
</g>
<!-- layer6_gpu12_expert_act -->
<g id="node612" class="node">
<title>layer6_gpu12_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9229.5,-17874.33 8852.5,-17874.33 8852.5,-17806.33 9229.5,-17806.33 9229.5,-17874.33"/>
<text text-anchor="middle" x="9041" y="-17859.13" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="9041" y="-17844.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9041" y="-17829.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9041" y="-17814.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer6_gpu12_expert_mlp1&#45;&gt;layer6_gpu12_expert_act -->
<g id="edge713" class="edge">
<title>layer6_gpu12_expert_mlp1&#45;&gt;layer6_gpu12_expert_act</title>
<path fill="none" stroke="black" d="M9020.06,-17910.21C9022.58,-17901.93 9025.32,-17892.93 9027.96,-17884.24"/>
<polygon fill="black" stroke="black" points="9031.32,-17885.22 9030.88,-17874.63 9024.62,-17883.18 9031.32,-17885.22"/>
</g>
<!-- layer6_gpu12_expert_mlp2 -->
<g id="node613" class="node">
<title>layer6_gpu12_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9307.5,-17770.33 8900.5,-17770.33 8900.5,-17702.33 9307.5,-17702.33 9307.5,-17770.33"/>
<text text-anchor="middle" x="9104" y="-17755.13" font-family="Times,serif" font-size="14.00">Expert 12 MLP2</text>
<text text-anchor="middle" x="9104" y="-17740.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9104" y="-17725.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9104" y="-17710.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer6_gpu12_expert_act&#45;&gt;layer6_gpu12_expert_mlp2 -->
<g id="edge714" class="edge">
<title>layer6_gpu12_expert_act&#45;&gt;layer6_gpu12_expert_mlp2</title>
<path fill="none" stroke="black" d="M9061.45,-17806.21C9066.74,-17797.66 9072.49,-17788.34 9078.01,-17779.4"/>
<polygon fill="black" stroke="black" points="9081.16,-17780.98 9083.43,-17770.63 9075.2,-17777.3 9081.16,-17780.98"/>
</g>
<!-- layer6_gpu12_token_send -->
<g id="node614" class="node">
<title>layer6_gpu12_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9120" cy="-17618.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9120" y="-17637.05" font-family="Times,serif" font-size="14.00">Token Send GPU12</text>
<text text-anchor="middle" x="9120" y="-17622.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9120" y="-17607.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9120" y="-17592.05" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer6_gpu12_expert_mlp2&#45;&gt;layer6_gpu12_token_send -->
<g id="edge715" class="edge">
<title>layer6_gpu12_expert_mlp2&#45;&gt;layer6_gpu12_token_send</title>
<path fill="none" stroke="black" d="M9108.58,-17702.07C9109.7,-17693.99 9110.92,-17685.12 9112.14,-17676.28"/>
<polygon fill="black" stroke="black" points="9115.61,-17676.74 9113.51,-17666.36 9108.67,-17675.79 9115.61,-17676.74"/>
</g>
<!-- layer6_gpu12_token_send&#45;&gt;layer6_expert_agg -->
<g id="edge716" class="edge">
<title>layer6_gpu12_token_send&#45;&gt;layer6_expert_agg</title>
<path fill="none" stroke="black" d="M8879.52,-17582.79C8838.38,-17577.85 8796.02,-17573.37 8756,-17570.16 7703.84,-17485.79 6456.59,-17469.6 5848.15,-17467.09"/>
<polygon fill="black" stroke="black" points="5847.92,-17463.59 5837.9,-17467.05 5847.89,-17470.59 5847.92,-17463.59"/>
</g>
<!-- layer6_gpu13_expert_mlp1 -->
<g id="node616" class="node">
<title>layer6_gpu13_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9844.5,-17978.33 9383.5,-17978.33 9383.5,-17910.33 9844.5,-17910.33 9844.5,-17978.33"/>
<text text-anchor="middle" x="9614" y="-17963.13" font-family="Times,serif" font-size="14.00">Expert 13 MLP1</text>
<text text-anchor="middle" x="9614" y="-17948.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9614" y="-17933.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9614" y="-17918.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer6_gpu13_token_recv&#45;&gt;layer6_gpu13_expert_mlp1 -->
<g id="edge718" class="edge">
<title>layer6_gpu13_token_recv&#45;&gt;layer6_gpu13_expert_mlp1</title>
<path fill="none" stroke="black" d="M9605.69,-18014.2C9606.71,-18005.81 9607.75,-17997.11 9608.75,-17988.84"/>
<polygon fill="black" stroke="black" points="9612.26,-17988.98 9609.98,-17978.63 9605.31,-17988.14 9612.26,-17988.98"/>
</g>
<!-- layer6_gpu13_expert_act -->
<g id="node617" class="node">
<title>layer6_gpu13_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9881.5,-17874.33 9504.5,-17874.33 9504.5,-17806.33 9881.5,-17806.33 9881.5,-17874.33"/>
<text text-anchor="middle" x="9693" y="-17859.13" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="9693" y="-17844.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9693" y="-17829.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9693" y="-17814.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer6_gpu13_expert_mlp1&#45;&gt;layer6_gpu13_expert_act -->
<g id="edge719" class="edge">
<title>layer6_gpu13_expert_mlp1&#45;&gt;layer6_gpu13_expert_act</title>
<path fill="none" stroke="black" d="M9639.65,-17910.21C9646.48,-17901.4 9653.94,-17891.76 9661.06,-17882.57"/>
<polygon fill="black" stroke="black" points="9663.85,-17884.68 9667.21,-17874.63 9658.32,-17880.39 9663.85,-17884.68"/>
</g>
<!-- layer6_gpu13_expert_mlp2 -->
<g id="node618" class="node">
<title>layer6_gpu13_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9990.5,-17770.33 9583.5,-17770.33 9583.5,-17702.33 9990.5,-17702.33 9990.5,-17770.33"/>
<text text-anchor="middle" x="9787" y="-17755.13" font-family="Times,serif" font-size="14.00">Expert 13 MLP2</text>
<text text-anchor="middle" x="9787" y="-17740.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9787" y="-17725.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9787" y="-17710.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer6_gpu13_expert_act&#45;&gt;layer6_gpu13_expert_mlp2 -->
<g id="edge720" class="edge">
<title>layer6_gpu13_expert_act&#45;&gt;layer6_gpu13_expert_mlp2</title>
<path fill="none" stroke="black" d="M9723.52,-17806.21C9731.81,-17797.22 9740.88,-17787.37 9749.51,-17778.01"/>
<polygon fill="black" stroke="black" points="9752.11,-17780.36 9756.31,-17770.63 9746.96,-17775.61 9752.11,-17780.36"/>
</g>
<!-- layer6_gpu13_token_send -->
<g id="node619" class="node">
<title>layer6_gpu13_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9849" cy="-17618.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9849" y="-17637.05" font-family="Times,serif" font-size="14.00">Token Send GPU13</text>
<text text-anchor="middle" x="9849" y="-17622.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9849" y="-17607.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9849" y="-17592.05" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer6_gpu13_expert_mlp2&#45;&gt;layer6_gpu13_token_send -->
<g id="edge721" class="edge">
<title>layer6_gpu13_expert_mlp2&#45;&gt;layer6_gpu13_token_send</title>
<path fill="none" stroke="black" d="M9804.77,-17702.07C9809.22,-17693.72 9814.13,-17684.54 9819,-17675.42"/>
<polygon fill="black" stroke="black" points="9822.21,-17676.83 9823.84,-17666.36 9816.04,-17673.53 9822.21,-17676.83"/>
</g>
<!-- layer6_gpu13_token_send&#45;&gt;layer6_expert_agg -->
<g id="edge722" class="edge">
<title>layer6_gpu13_token_send&#45;&gt;layer6_expert_agg</title>
<path fill="none" stroke="black" d="M9609.02,-17582.65C9567.73,-17577.72 9525.18,-17573.27 9485,-17570.16 8787.13,-17516.21 6712.07,-17483.46 5854.42,-17471.9"/>
<polygon fill="black" stroke="black" points="5854.44,-17468.4 5844.39,-17471.76 5854.34,-17475.4 5854.44,-17468.4"/>
</g>
<!-- layer6_gpu14_expert_mlp1 -->
<g id="node621" class="node">
<title>layer6_gpu14_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="10625.5,-17978.33 10164.5,-17978.33 10164.5,-17910.33 10625.5,-17910.33 10625.5,-17978.33"/>
<text text-anchor="middle" x="10395" y="-17963.13" font-family="Times,serif" font-size="14.00">Expert 14 MLP1</text>
<text text-anchor="middle" x="10395" y="-17948.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10395" y="-17933.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10395" y="-17918.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer6_gpu14_token_recv&#45;&gt;layer6_gpu14_expert_mlp1 -->
<g id="edge724" class="edge">
<title>layer6_gpu14_token_recv&#45;&gt;layer6_gpu14_expert_mlp1</title>
<path fill="none" stroke="black" d="M10330.62,-18014.53C10339.4,-18005.09 10348.56,-17995.25 10357.13,-17986.04"/>
<polygon fill="black" stroke="black" points="10359.91,-17988.18 10364.16,-17978.48 10354.79,-17983.42 10359.91,-17988.18"/>
</g>
<!-- layer6_gpu14_expert_act -->
<g id="node622" class="node">
<title>layer6_gpu14_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="10764.5,-17874.33 10387.5,-17874.33 10387.5,-17806.33 10764.5,-17806.33 10764.5,-17874.33"/>
<text text-anchor="middle" x="10576" y="-17859.13" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="10576" y="-17844.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10576" y="-17829.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10576" y="-17814.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer6_gpu14_expert_mlp1&#45;&gt;layer6_gpu14_expert_act -->
<g id="edge725" class="edge">
<title>layer6_gpu14_expert_mlp1&#45;&gt;layer6_gpu14_expert_act</title>
<path fill="none" stroke="black" d="M10453.77,-17910.21C10471.08,-17900.46 10490.17,-17889.7 10508.02,-17879.64"/>
<polygon fill="black" stroke="black" points="10510.23,-17882.41 10517.22,-17874.46 10506.79,-17876.32 10510.23,-17882.41"/>
</g>
<!-- layer6_gpu14_expert_mlp2 -->
<g id="node623" class="node">
<title>layer6_gpu14_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10779.5,-17770.33 10372.5,-17770.33 10372.5,-17702.33 10779.5,-17702.33 10779.5,-17770.33"/>
<text text-anchor="middle" x="10576" y="-17755.13" font-family="Times,serif" font-size="14.00">Expert 14 MLP2</text>
<text text-anchor="middle" x="10576" y="-17740.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10576" y="-17725.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="10576" y="-17710.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer6_gpu14_expert_act&#45;&gt;layer6_gpu14_expert_mlp2 -->
<g id="edge726" class="edge">
<title>layer6_gpu14_expert_act&#45;&gt;layer6_gpu14_expert_mlp2</title>
<path fill="none" stroke="black" d="M10576,-17806.21C10576,-17798.11 10576,-17789.31 10576,-17780.8"/>
<polygon fill="black" stroke="black" points="10579.5,-17780.63 10576,-17770.63 10572.5,-17780.63 10579.5,-17780.63"/>
</g>
<!-- layer6_gpu14_token_send -->
<g id="node624" class="node">
<title>layer6_gpu14_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="10578" cy="-17618.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="10578" y="-17637.05" font-family="Times,serif" font-size="14.00">Token Send GPU14</text>
<text text-anchor="middle" x="10578" y="-17622.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="10578" y="-17607.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="10578" y="-17592.05" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer6_gpu14_expert_mlp2&#45;&gt;layer6_gpu14_token_send -->
<g id="edge727" class="edge">
<title>layer6_gpu14_expert_mlp2&#45;&gt;layer6_gpu14_token_send</title>
<path fill="none" stroke="black" d="M10576.57,-17702.07C10576.71,-17694.07 10576.86,-17685.31 10577.01,-17676.56"/>
<polygon fill="black" stroke="black" points="10580.52,-17676.42 10577.19,-17666.36 10573.52,-17676.29 10580.52,-17676.42"/>
</g>
<!-- layer6_gpu14_token_send&#45;&gt;layer6_expert_agg -->
<g id="edge728" class="edge">
<title>layer6_gpu14_token_send&#45;&gt;layer6_expert_agg</title>
<path fill="none" stroke="black" d="M10339.01,-17582.63C10297.41,-17577.67 10254.51,-17573.22 10214,-17570.16 9369.31,-17506.53 6817.75,-17478.62 5852.45,-17470.14"/>
<polygon fill="black" stroke="black" points="5852.26,-17466.64 5842.22,-17470.05 5852.19,-17473.64 5852.26,-17466.64"/>
</g>
<!-- layer6_gpu15_expert_mlp1 -->
<g id="node626" class="node">
<title>layer6_gpu15_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="11208.5,-17978.33 10747.5,-17978.33 10747.5,-17910.33 11208.5,-17910.33 11208.5,-17978.33"/>
<text text-anchor="middle" x="10978" y="-17963.13" font-family="Times,serif" font-size="14.00">Expert 15 MLP1</text>
<text text-anchor="middle" x="10978" y="-17948.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10978" y="-17933.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10978" y="-17918.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer6_gpu15_token_recv&#45;&gt;layer6_gpu15_expert_mlp1 -->
<g id="edge730" class="edge">
<title>layer6_gpu15_token_recv&#45;&gt;layer6_gpu15_expert_mlp1</title>
<path fill="none" stroke="black" d="M10975.63,-18014.2C10975.92,-18005.81 10976.22,-17997.11 10976.5,-17988.84"/>
<polygon fill="black" stroke="black" points="10980.01,-17988.75 10976.85,-17978.63 10973.01,-17988.51 10980.01,-17988.75"/>
</g>
<!-- layer6_gpu15_expert_act -->
<g id="node627" class="node">
<title>layer6_gpu15_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="11174.5,-17874.33 10797.5,-17874.33 10797.5,-17806.33 11174.5,-17806.33 11174.5,-17874.33"/>
<text text-anchor="middle" x="10986" y="-17859.13" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="10986" y="-17844.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10986" y="-17829.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10986" y="-17814.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer6_gpu15_expert_mlp1&#45;&gt;layer6_gpu15_expert_act -->
<g id="edge731" class="edge">
<title>layer6_gpu15_expert_mlp1&#45;&gt;layer6_gpu15_expert_act</title>
<path fill="none" stroke="black" d="M10980.6,-17910.21C10981.23,-17902.11 10981.92,-17893.31 10982.59,-17884.8"/>
<polygon fill="black" stroke="black" points="10986.1,-17884.87 10983.39,-17874.63 10979.12,-17884.33 10986.1,-17884.87"/>
</g>
<!-- layer6_gpu15_expert_mlp2 -->
<g id="node628" class="node">
<title>layer6_gpu15_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="11364.5,-17770.33 10957.5,-17770.33 10957.5,-17702.33 11364.5,-17702.33 11364.5,-17770.33"/>
<text text-anchor="middle" x="11161" y="-17755.13" font-family="Times,serif" font-size="14.00">Expert 15 MLP2</text>
<text text-anchor="middle" x="11161" y="-17740.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11161" y="-17725.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="11161" y="-17710.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer6_gpu15_expert_act&#45;&gt;layer6_gpu15_expert_mlp2 -->
<g id="edge732" class="edge">
<title>layer6_gpu15_expert_act&#45;&gt;layer6_gpu15_expert_mlp2</title>
<path fill="none" stroke="black" d="M11042.82,-17806.21C11059.56,-17796.46 11078.02,-17785.7 11095.27,-17775.64"/>
<polygon fill="black" stroke="black" points="11097.29,-17778.51 11104.17,-17770.46 11093.77,-17772.47 11097.29,-17778.51"/>
</g>
<!-- layer6_gpu15_token_send -->
<g id="node629" class="node">
<title>layer6_gpu15_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="11307" cy="-17618.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="11307" y="-17637.05" font-family="Times,serif" font-size="14.00">Token Send GPU15</text>
<text text-anchor="middle" x="11307" y="-17622.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="11307" y="-17607.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="11307" y="-17592.05" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer6_gpu15_expert_mlp2&#45;&gt;layer6_gpu15_token_send -->
<g id="edge733" class="edge">
<title>layer6_gpu15_expert_mlp2&#45;&gt;layer6_gpu15_token_send</title>
<path fill="none" stroke="black" d="M11202.84,-17702.07C11214.63,-17692.69 11227.76,-17682.25 11240.61,-17672.03"/>
<polygon fill="black" stroke="black" points="11242.92,-17674.67 11248.56,-17665.71 11238.56,-17669.19 11242.92,-17674.67"/>
</g>
<!-- layer6_gpu15_token_send&#45;&gt;layer6_expert_agg -->
<g id="edge734" class="edge">
<title>layer6_gpu15_token_send&#45;&gt;layer6_expert_agg</title>
<path fill="none" stroke="black" d="M11068.02,-17582.53C11026.42,-17577.58 10983.51,-17573.16 10943,-17570.16 9950.22,-17496.82 6914.36,-17474.52 5850.26,-17468.85"/>
<polygon fill="black" stroke="black" points="5850.17,-17465.35 5840.15,-17468.8 5850.13,-17472.35 5850.17,-17465.35"/>
</g>
<!-- layer6_residual2 -->
<g id="node631" class="node">
<title>layer6_residual2</title>
<polygon fill="lightyellow" stroke="black" points="5919.89,-17362.16 5215.35,-17362.16 5034.11,-17226.16 5738.65,-17226.16 5919.89,-17362.16"/>
<text text-anchor="middle" x="5477" y="-17312.96" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="5477" y="-17297.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5477" y="-17282.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-17267.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer6_expert_agg&#45;&gt;layer6_residual2 -->
<g id="edge735" class="edge">
<title>layer6_expert_agg&#45;&gt;layer6_residual2</title>
<path fill="none" stroke="black" d="M5477,-17397.98C5477,-17389.66 5477,-17381.11 5477,-17372.66"/>
<polygon fill="black" stroke="black" points="5480.5,-17372.42 5477,-17362.42 5473.5,-17372.42 5480.5,-17372.42"/>
</g>
<!-- layer7_layernorm -->
<g id="node632" class="node">
<title>layer7_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="5680.5,-17179.16 5273.5,-17179.16 5273.5,-17111.16 5680.5,-17111.16 5680.5,-17179.16"/>
<text text-anchor="middle" x="5477" y="-17163.96" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5477" y="-17148.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-17133.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-17118.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer6_residual2&#45;&gt;layer7_layernorm -->
<g id="edge736" class="edge">
<title>layer6_residual2&#45;&gt;layer7_layernorm</title>
<path fill="none" stroke="black" d="M5477,-17226.12C5477,-17213.71 5477,-17201.06 5477,-17189.58"/>
<polygon fill="black" stroke="black" points="5480.5,-17189.42 5477,-17179.42 5473.5,-17189.42 5480.5,-17189.42"/>
</g>
<!-- layer7_qkv_proj -->
<g id="node633" class="node">
<title>layer7_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="5734.5,-17075.16 5219.5,-17075.16 5219.5,-17007.16 5734.5,-17007.16 5734.5,-17075.16"/>
<text text-anchor="middle" x="5477" y="-17059.96" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5477" y="-17044.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-17029.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5477" y="-17014.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer7_layernorm&#45;&gt;layer7_qkv_proj -->
<g id="edge737" class="edge">
<title>layer7_layernorm&#45;&gt;layer7_qkv_proj</title>
<path fill="none" stroke="black" d="M5477,-17111.05C5477,-17102.94 5477,-17094.15 5477,-17085.64"/>
<polygon fill="black" stroke="black" points="5480.5,-17085.46 5477,-17075.46 5473.5,-17085.46 5480.5,-17085.46"/>
</g>
<!-- layer7_attention -->
<g id="node634" class="node">
<title>layer7_attention</title>
<polygon fill="lightgreen" stroke="black" points="5728.5,-16971.16 5225.5,-16971.16 5225.5,-16903.16 5728.5,-16903.16 5728.5,-16971.16"/>
<text text-anchor="middle" x="5477" y="-16955.96" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5477" y="-16940.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5477" y="-16925.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5477" y="-16910.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer7_qkv_proj&#45;&gt;layer7_attention -->
<g id="edge738" class="edge">
<title>layer7_qkv_proj&#45;&gt;layer7_attention</title>
<path fill="none" stroke="black" d="M5477,-17007.05C5477,-16998.94 5477,-16990.15 5477,-16981.64"/>
<polygon fill="black" stroke="black" points="5480.5,-16981.46 5477,-16971.46 5473.5,-16981.46 5480.5,-16981.46"/>
</g>
<!-- layer7_attn_out -->
<g id="node635" class="node">
<title>layer7_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="5715.5,-16867.16 5238.5,-16867.16 5238.5,-16799.16 5715.5,-16799.16 5715.5,-16867.16"/>
<text text-anchor="middle" x="5477" y="-16851.96" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5477" y="-16836.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5477" y="-16821.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-16806.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer7_attention&#45;&gt;layer7_attn_out -->
<g id="edge739" class="edge">
<title>layer7_attention&#45;&gt;layer7_attn_out</title>
<path fill="none" stroke="black" d="M5477,-16903.05C5477,-16894.94 5477,-16886.15 5477,-16877.64"/>
<polygon fill="black" stroke="black" points="5480.5,-16877.46 5477,-16867.46 5473.5,-16877.46 5480.5,-16877.46"/>
</g>
<!-- layer7_residual1 -->
<g id="node636" class="node">
<title>layer7_residual1</title>
<polygon fill="lightyellow" stroke="black" points="5919.89,-16763.16 5215.35,-16763.16 5034.11,-16627.16 5738.65,-16627.16 5919.89,-16763.16"/>
<text text-anchor="middle" x="5477" y="-16713.96" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5477" y="-16698.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5477" y="-16683.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-16668.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer7_attn_out&#45;&gt;layer7_residual1 -->
<g id="edge740" class="edge">
<title>layer7_attn_out&#45;&gt;layer7_residual1</title>
<path fill="none" stroke="black" d="M5477,-16798.89C5477,-16791.07 5477,-16782.4 5477,-16773.52"/>
<polygon fill="black" stroke="black" points="5480.5,-16773.43 5477,-16763.43 5473.5,-16773.43 5480.5,-16773.43"/>
</g>
<!-- layer7_layernorm2 -->
<g id="node637" class="node">
<title>layer7_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="5680.5,-16591.16 5273.5,-16591.16 5273.5,-16523.16 5680.5,-16523.16 5680.5,-16591.16"/>
<text text-anchor="middle" x="5477" y="-16575.96" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5477" y="-16560.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-16545.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-16530.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer7_residual1&#45;&gt;layer7_layernorm2 -->
<g id="edge741" class="edge">
<title>layer7_residual1&#45;&gt;layer7_layernorm2</title>
<path fill="none" stroke="black" d="M5477,-16626.96C5477,-16618.21 5477,-16609.44 5477,-16601.23"/>
<polygon fill="black" stroke="black" points="5480.5,-16601.18 5477,-16591.18 5473.5,-16601.18 5480.5,-16601.18"/>
</g>
<!-- layer7_global_gate -->
<g id="node638" class="node">
<title>layer7_global_gate</title>
<polygon fill="lightgreen" stroke="black" points="5674.5,-16487.16 5279.5,-16487.16 5279.5,-16419.16 5674.5,-16419.16 5674.5,-16487.16"/>
<text text-anchor="middle" x="5477" y="-16471.96" font-family="Times,serif" font-size="14.00">Global Gate</text>
<text text-anchor="middle" x="5477" y="-16456.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-16441.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, experts=64]</text>
<text text-anchor="middle" x="5477" y="-16426.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer7_layernorm2&#45;&gt;layer7_global_gate -->
<g id="edge742" class="edge">
<title>layer7_layernorm2&#45;&gt;layer7_global_gate</title>
<path fill="none" stroke="black" d="M5477,-16523.05C5477,-16514.94 5477,-16506.15 5477,-16497.64"/>
<polygon fill="black" stroke="black" points="5480.5,-16497.46 5477,-16487.46 5473.5,-16497.46 5480.5,-16497.46"/>
</g>
<!-- layer7_routing -->
<g id="node639" class="node">
<title>layer7_routing</title>
<polygon fill="lightyellow" stroke="black" points="5963.47,-16383.16 5189.6,-16383.16 4990.53,-16247.16 5764.4,-16247.16 5963.47,-16383.16"/>
<text text-anchor="middle" x="5477" y="-16333.96" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="5477" y="-16318.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-16303.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5477" y="-16288.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer7_global_gate&#45;&gt;layer7_routing -->
<g id="edge743" class="edge">
<title>layer7_global_gate&#45;&gt;layer7_routing</title>
<path fill="none" stroke="black" d="M5477,-16418.89C5477,-16411.07 5477,-16402.4 5477,-16393.52"/>
<polygon fill="black" stroke="black" points="5480.5,-16393.43 5477,-16383.43 5473.5,-16393.43 5480.5,-16393.43"/>
</g>
<!-- layer7_gpu0_token_recv -->
<g id="node640" class="node">
<title>layer7_gpu0_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="442" cy="-16163.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="442" y="-16181.88" font-family="Times,serif" font-size="14.00">Token Receive GPU0</text>
<text text-anchor="middle" x="442" y="-16166.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="442" y="-16151.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="442" y="-16136.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer7_routing&#45;&gt;layer7_gpu0_token_recv -->
<g id="edge744" class="edge">
<title>layer7_routing&#45;&gt;layer7_gpu0_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5082.92,-16310.47C4116.85,-16300.59 1649.85,-16270.24 828,-16211.16 783.38,-16207.96 736,-16203.25 690.27,-16198.05"/>
<polygon fill="black" stroke="black" points="690.57,-16194.56 680.24,-16196.89 689.77,-16201.51 690.57,-16194.56"/>
</g>
<!-- layer7_gpu1_token_recv -->
<g id="node645" class="node">
<title>layer7_gpu1_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1171" cy="-16163.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1171" y="-16181.88" font-family="Times,serif" font-size="14.00">Token Receive GPU1</text>
<text text-anchor="middle" x="1171" y="-16166.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1171" y="-16151.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1171" y="-16136.88" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer7_routing&#45;&gt;layer7_gpu1_token_recv -->
<g id="edge750" class="edge">
<title>layer7_routing&#45;&gt;layer7_gpu1_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5080.87,-16308.96C4222.91,-16296.85 2215.52,-16263.73 1536,-16211.16 1496.42,-16208.1 1454.56,-16203.75 1413.85,-16198.92"/>
<polygon fill="black" stroke="black" points="1414.15,-16195.43 1403.8,-16197.72 1413.32,-16202.38 1414.15,-16195.43"/>
</g>
<!-- layer7_gpu2_token_recv -->
<g id="node650" class="node">
<title>layer7_gpu2_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1879" cy="-16163.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1879" y="-16181.88" font-family="Times,serif" font-size="14.00">Token Receive GPU2</text>
<text text-anchor="middle" x="1879" y="-16166.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1879" y="-16151.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1879" y="-16136.88" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer7_routing&#45;&gt;layer7_gpu2_token_recv -->
<g id="edge756" class="edge">
<title>layer7_routing&#45;&gt;layer7_gpu2_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5089.11,-16314.63C4479.27,-16312.49 3259.49,-16296.59 2229,-16211.16 2192.82,-16208.16 2154.66,-16204.03 2117.36,-16199.46"/>
<polygon fill="black" stroke="black" points="2117.74,-16195.98 2107.38,-16198.22 2116.88,-16202.92 2117.74,-16195.98"/>
</g>
<!-- layer7_gpu3_token_recv -->
<g id="node655" class="node">
<title>layer7_gpu3_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="2572" cy="-16163.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2572" y="-16181.88" font-family="Times,serif" font-size="14.00">Token Receive GPU3</text>
<text text-anchor="middle" x="2572" y="-16166.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="2572" y="-16151.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2572" y="-16136.88" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer7_routing&#45;&gt;layer7_gpu3_token_recv -->
<g id="edge762" class="edge">
<title>layer7_routing&#45;&gt;layer7_gpu3_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5076.46,-16305.88C4586.27,-16293.82 3731.21,-16266.52 3000,-16211.16 2946.32,-16207.1 2888.97,-16201.6 2834.26,-16195.78"/>
<polygon fill="black" stroke="black" points="2834.39,-16192.28 2824.08,-16194.7 2833.65,-16199.24 2834.39,-16192.28"/>
</g>
<!-- layer7_gpu4_token_recv -->
<g id="node660" class="node">
<title>layer7_gpu4_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="3343" cy="-16163.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="3343" y="-16181.88" font-family="Times,serif" font-size="14.00">Token Receive GPU4</text>
<text text-anchor="middle" x="3343" y="-16166.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="3343" y="-16151.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3343" y="-16136.88" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer7_routing&#45;&gt;layer7_gpu4_token_recv -->
<g id="edge768" class="edge">
<title>layer7_routing&#45;&gt;layer7_gpu4_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5063.24,-16297.08C4708.7,-16280.7 4184.66,-16252.34 3729,-16211.16 3686.03,-16207.28 3640.45,-16202.4 3596.25,-16197.27"/>
<polygon fill="black" stroke="black" points="3596.58,-16193.78 3586.24,-16196.1 3595.77,-16200.73 3596.58,-16193.78"/>
</g>
<!-- layer7_gpu5_token_recv -->
<g id="node665" class="node">
<title>layer7_gpu5_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4072" cy="-16163.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4072" y="-16181.88" font-family="Times,serif" font-size="14.00">Token Receive GPU5</text>
<text text-anchor="middle" x="4072" y="-16166.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4072" y="-16151.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4072" y="-16136.88" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer7_routing&#45;&gt;layer7_gpu5_token_recv -->
<g id="edge774" class="edge">
<title>layer7_routing&#45;&gt;layer7_gpu5_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5027.49,-16272.57C4844.22,-16254.85 4630.34,-16233.2 4437,-16211.16 4400.43,-16207 4361.84,-16202.32 4323.99,-16197.57"/>
<polygon fill="black" stroke="black" points="4324.22,-16194.08 4313.86,-16196.3 4323.35,-16201.02 4324.22,-16194.08"/>
</g>
<!-- layer7_gpu6_token_recv -->
<g id="node670" class="node">
<title>layer7_gpu6_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4780" cy="-16163.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4780" y="-16181.88" font-family="Times,serif" font-size="14.00">Token Receive GPU6</text>
<text text-anchor="middle" x="4780" y="-16166.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4780" y="-16151.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4780" y="-16136.88" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer7_routing&#45;&gt;layer7_gpu6_token_recv -->
<g id="edge780" class="edge">
<title>layer7_routing&#45;&gt;layer7_gpu6_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5165.7,-16247.13C5099.9,-16232.96 5032.31,-16218.41 4972.46,-16205.52"/>
<polygon fill="black" stroke="black" points="4973.05,-16202.07 4962.53,-16203.39 4971.57,-16208.91 4973.05,-16202.07"/>
</g>
<!-- layer7_gpu7_token_recv -->
<g id="node675" class="node">
<title>layer7_gpu7_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="5477" cy="-16163.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="5477" y="-16181.88" font-family="Times,serif" font-size="14.00">Token Receive GPU7</text>
<text text-anchor="middle" x="5477" y="-16166.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5477" y="-16151.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5477" y="-16136.88" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_routing&#45;&gt;layer7_gpu7_token_recv -->
<g id="edge786" class="edge">
<title>layer7_routing&#45;&gt;layer7_gpu7_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5477,-16247.02C5477,-16238.48 5477,-16229.8 5477,-16221.42"/>
<polygon fill="black" stroke="black" points="5480.5,-16221.4 5477,-16211.4 5473.5,-16221.4 5480.5,-16221.4"/>
</g>
<!-- layer7_gpu8_token_recv -->
<g id="node680" class="node">
<title>layer7_gpu8_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6165" cy="-16163.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6165" y="-16181.88" font-family="Times,serif" font-size="14.00">Token Receive GPU8</text>
<text text-anchor="middle" x="6165" y="-16166.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6165" y="-16151.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6165" y="-16136.88" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer7_routing&#45;&gt;layer7_gpu8_token_recv -->
<g id="edge792" class="edge">
<title>layer7_routing&#45;&gt;layer7_gpu8_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5769.27,-16250.41C5838.41,-16235.33 5910.39,-16219.62 5973.71,-16205.81"/>
<polygon fill="black" stroke="black" points="5974.78,-16209.16 5983.8,-16203.61 5973.29,-16202.32 5974.78,-16209.16"/>
</g>
<!-- layer7_gpu9_token_recv -->
<g id="node685" class="node">
<title>layer7_gpu9_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6852" cy="-16163.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6852" y="-16181.88" font-family="Times,serif" font-size="14.00">Token Receive GPU9</text>
<text text-anchor="middle" x="6852" y="-16166.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6852" y="-16151.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6852" y="-16136.88" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer7_routing&#45;&gt;layer7_gpu9_token_recv -->
<g id="edge798" class="edge">
<title>layer7_routing&#45;&gt;layer7_gpu9_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5817.49,-16283.29C6018.57,-16264.28 6278,-16238.38 6508,-16211.16 6540.01,-16207.38 6573.65,-16203.12 6606.85,-16198.75"/>
<polygon fill="black" stroke="black" points="6607.68,-16202.17 6617.14,-16197.39 6606.77,-16195.23 6607.68,-16202.17"/>
</g>
<!-- layer7_gpu10_token_recv -->
<g id="node690" class="node">
<title>layer7_gpu10_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="7539" cy="-16163.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="7539" y="-16181.88" font-family="Times,serif" font-size="14.00">Token Receive GPU10</text>
<text text-anchor="middle" x="7539" y="-16166.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="7539" y="-16151.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7539" y="-16136.88" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer7_routing&#45;&gt;layer7_gpu10_token_recv -->
<g id="edge804" class="edge">
<title>layer7_routing&#45;&gt;layer7_gpu10_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5842.52,-16300.32C6190.76,-16285.23 6729.43,-16256.91 7195,-16211.16 7228.58,-16207.86 7263.92,-16203.76 7298.65,-16199.35"/>
<polygon fill="black" stroke="black" points="7299.44,-16202.78 7308.91,-16198.04 7298.55,-16195.84 7299.44,-16202.78"/>
</g>
<!-- layer7_gpu11_token_recv -->
<g id="node695" class="node">
<title>layer7_gpu11_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8226" cy="-16163.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8226" y="-16181.88" font-family="Times,serif" font-size="14.00">Token Receive GPU11</text>
<text text-anchor="middle" x="8226" y="-16166.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8226" y="-16151.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8226" y="-16136.88" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer7_routing&#45;&gt;layer7_gpu11_token_recv -->
<g id="edge810" class="edge">
<title>layer7_routing&#45;&gt;layer7_gpu11_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5854.96,-16308.86C6329.25,-16299.7 7167.22,-16275.25 7882,-16211.16 7916.3,-16208.09 7952.42,-16204.04 7987.84,-16199.61"/>
<polygon fill="black" stroke="black" points="7988.33,-16203.08 7997.82,-16198.35 7987.46,-16196.13 7988.33,-16203.08"/>
</g>
<!-- layer7_gpu12_token_recv -->
<g id="node700" class="node">
<title>layer7_gpu12_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8913" cy="-16163.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8913" y="-16181.88" font-family="Times,serif" font-size="14.00">Token Receive GPU12</text>
<text text-anchor="middle" x="8913" y="-16166.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8913" y="-16151.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8913" y="-16136.88" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer7_routing&#45;&gt;layer7_gpu12_token_recv -->
<g id="edge816" class="edge">
<title>layer7_routing&#45;&gt;layer7_gpu12_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5862.47,-16314.02C6448.24,-16310.93 7597.15,-16293.64 8569,-16211.16 8603.73,-16208.22 8640.31,-16204.2 8676.15,-16199.75"/>
<polygon fill="black" stroke="black" points="8676.74,-16203.2 8686.23,-16198.48 8675.87,-16196.25 8676.74,-16203.2"/>
</g>
<!-- layer7_gpu13_token_recv -->
<g id="node705" class="node">
<title>layer7_gpu13_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="9600" cy="-16163.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="9600" y="-16181.88" font-family="Times,serif" font-size="14.00">Token Receive GPU13</text>
<text text-anchor="middle" x="9600" y="-16166.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="9600" y="-16151.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9600" y="-16136.88" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer7_routing&#45;&gt;layer7_gpu13_token_recv -->
<g id="edge822" class="edge">
<title>layer7_routing&#45;&gt;layer7_gpu13_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5855.33,-16309.09C6677.21,-16297.21 8604.22,-16264.49 9256,-16211.16 9291.01,-16208.3 9327.9,-16204.3 9364.01,-16199.83"/>
<polygon fill="black" stroke="black" points="9364.68,-16203.27 9374.17,-16198.56 9363.81,-16196.33 9364.68,-16203.27"/>
</g>
<!-- layer7_gpu14_token_recv -->
<g id="node710" class="node">
<title>layer7_gpu14_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10287" cy="-16163.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10287" y="-16181.88" font-family="Times,serif" font-size="14.00">Token Receive GPU14</text>
<text text-anchor="middle" x="10287" y="-16166.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10287" y="-16151.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10287" y="-16136.88" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer7_routing&#45;&gt;layer7_gpu14_token_recv -->
<g id="edge828" class="edge">
<title>layer7_routing&#45;&gt;layer7_gpu14_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5857.76,-16310.92C6787.42,-16302.1 9154.56,-16274.01 9943,-16211.16 9978.15,-16208.36 10015.2,-16204.38 10051.45,-16199.91"/>
<polygon fill="black" stroke="black" points="10052.16,-16203.35 10061.65,-16198.63 10051.29,-16196.4 10052.16,-16203.35"/>
</g>
<!-- layer7_gpu15_token_recv -->
<g id="node715" class="node">
<title>layer7_gpu15_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10974" cy="-16163.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10974" y="-16181.88" font-family="Times,serif" font-size="14.00">Token Receive GPU15</text>
<text text-anchor="middle" x="10974" y="-16166.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10974" y="-16151.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10974" y="-16136.88" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer7_routing&#45;&gt;layer7_gpu15_token_recv -->
<g id="edge834" class="edge">
<title>layer7_routing&#45;&gt;layer7_gpu15_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5859.8,-16312.28C6889.63,-16306.28 9703.77,-16283.56 10630,-16211.16 10665.29,-16208.41 10702.5,-16204.43 10738.88,-16199.95"/>
<polygon fill="black" stroke="black" points="10739.63,-16203.39 10749.12,-16198.68 10738.76,-16196.44 10739.63,-16203.39"/>
</g>
<!-- layer7_gpu0_expert_mlp1 -->
<g id="node641" class="node">
<title>layer7_gpu0_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="662.5,-16079 201.5,-16079 201.5,-16011 662.5,-16011 662.5,-16079"/>
<text text-anchor="middle" x="432" y="-16063.8" font-family="Times,serif" font-size="14.00">Expert 0 MLP1</text>
<text text-anchor="middle" x="432" y="-16048.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="432" y="-16033.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="432" y="-16018.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer7_gpu0_token_recv&#45;&gt;layer7_gpu0_expert_mlp1 -->
<g id="edge745" class="edge">
<title>layer7_gpu0_token_recv&#45;&gt;layer7_gpu0_expert_mlp1</title>
<path fill="none" stroke="black" d="M437.93,-16114.87C437.21,-16106.48 436.46,-16097.78 435.75,-16089.5"/>
<polygon fill="black" stroke="black" points="439.21,-16088.96 434.87,-16079.3 432.24,-16089.56 439.21,-16088.96"/>
</g>
<!-- layer7_gpu0_expert_act -->
<g id="node642" class="node">
<title>layer7_gpu0_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="602.5,-15975 225.5,-15975 225.5,-15907 602.5,-15907 602.5,-15975"/>
<text text-anchor="middle" x="414" y="-15959.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="414" y="-15944.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="414" y="-15929.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="414" y="-15914.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer7_gpu0_expert_mlp1&#45;&gt;layer7_gpu0_expert_act -->
<g id="edge746" class="edge">
<title>layer7_gpu0_expert_mlp1&#45;&gt;layer7_gpu0_expert_act</title>
<path fill="none" stroke="black" d="M426.16,-16010.88C424.71,-16002.69 423.14,-15993.79 421.62,-15985.19"/>
<polygon fill="black" stroke="black" points="425.06,-15984.54 419.88,-15975.3 418.17,-15985.75 425.06,-15984.54"/>
</g>
<!-- layer7_gpu0_expert_mlp2 -->
<g id="node643" class="node">
<title>layer7_gpu0_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="596.5,-15871 189.5,-15871 189.5,-15803 596.5,-15803 596.5,-15871"/>
<text text-anchor="middle" x="393" y="-15855.8" font-family="Times,serif" font-size="14.00">Expert 0 MLP2</text>
<text text-anchor="middle" x="393" y="-15840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="393" y="-15825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="393" y="-15810.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer7_gpu0_expert_act&#45;&gt;layer7_gpu0_expert_mlp2 -->
<g id="edge747" class="edge">
<title>layer7_gpu0_expert_act&#45;&gt;layer7_gpu0_expert_mlp2</title>
<path fill="none" stroke="black" d="M407.18,-15906.88C405.49,-15898.69 403.66,-15889.79 401.89,-15881.19"/>
<polygon fill="black" stroke="black" points="405.3,-15880.39 399.86,-15871.3 398.44,-15881.8 405.3,-15880.39"/>
</g>
<!-- layer7_gpu0_token_send -->
<g id="node644" class="node">
<title>layer7_gpu0_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="372" cy="-15718.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="372" y="-15737.71" font-family="Times,serif" font-size="14.00">Token Send GPU0</text>
<text text-anchor="middle" x="372" y="-15722.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="372" y="-15707.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="372" y="-15692.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer7_gpu0_expert_mlp2&#45;&gt;layer7_gpu0_token_send -->
<g id="edge748" class="edge">
<title>layer7_gpu0_expert_mlp2&#45;&gt;layer7_gpu0_token_send</title>
<path fill="none" stroke="black" d="M386.98,-15802.73C385.52,-15794.65 383.92,-15785.78 382.32,-15776.95"/>
<polygon fill="black" stroke="black" points="385.75,-15776.24 380.52,-15767.02 378.86,-15777.49 385.75,-15776.24"/>
</g>
<!-- layer7_expert_agg -->
<g id="node720" class="node">
<title>layer7_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="6285.05,-15634.83 5565.94,-15634.83 5380.95,-15498.83 6100.06,-15498.83 6285.05,-15634.83"/>
<text text-anchor="middle" x="5833" y="-15585.63" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5833" y="-15570.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x16)</text>
<text text-anchor="middle" x="5833" y="-15555.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5833" y="-15540.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer7_gpu0_token_send&#45;&gt;layer7_expert_agg -->
<g id="edge749" class="edge">
<title>layer7_gpu0_token_send&#45;&gt;layer7_expert_agg</title>
<path fill="none" stroke="black" d="M610.99,-15683.25C652.58,-15678.29 695.49,-15673.85 736,-15670.83 1656.29,-15602.22 4459.41,-15577.04 5467.22,-15570.06"/>
<polygon fill="black" stroke="black" points="5467.56,-15573.56 5477.53,-15569.99 5467.51,-15566.56 5467.56,-15573.56"/>
</g>
<!-- layer7_gpu1_expert_mlp1 -->
<g id="node646" class="node">
<title>layer7_gpu1_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="1391.5,-16079 930.5,-16079 930.5,-16011 1391.5,-16011 1391.5,-16079"/>
<text text-anchor="middle" x="1161" y="-16063.8" font-family="Times,serif" font-size="14.00">Expert 1 MLP1</text>
<text text-anchor="middle" x="1161" y="-16048.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1161" y="-16033.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1161" y="-16018.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer7_gpu1_token_recv&#45;&gt;layer7_gpu1_expert_mlp1 -->
<g id="edge751" class="edge">
<title>layer7_gpu1_token_recv&#45;&gt;layer7_gpu1_expert_mlp1</title>
<path fill="none" stroke="black" d="M1166.93,-16114.87C1166.21,-16106.48 1165.46,-16097.78 1164.75,-16089.5"/>
<polygon fill="black" stroke="black" points="1168.21,-16088.96 1163.87,-16079.3 1161.24,-16089.56 1168.21,-16088.96"/>
</g>
<!-- layer7_gpu1_expert_act -->
<g id="node647" class="node">
<title>layer7_gpu1_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="1331.5,-15975 954.5,-15975 954.5,-15907 1331.5,-15907 1331.5,-15975"/>
<text text-anchor="middle" x="1143" y="-15959.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1143" y="-15944.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1143" y="-15929.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1143" y="-15914.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer7_gpu1_expert_mlp1&#45;&gt;layer7_gpu1_expert_act -->
<g id="edge752" class="edge">
<title>layer7_gpu1_expert_mlp1&#45;&gt;layer7_gpu1_expert_act</title>
<path fill="none" stroke="black" d="M1155.16,-16010.88C1153.71,-16002.69 1152.14,-15993.79 1150.62,-15985.19"/>
<polygon fill="black" stroke="black" points="1154.06,-15984.54 1148.88,-15975.3 1147.17,-15985.75 1154.06,-15984.54"/>
</g>
<!-- layer7_gpu1_expert_mlp2 -->
<g id="node648" class="node">
<title>layer7_gpu1_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="1323.5,-15871 916.5,-15871 916.5,-15803 1323.5,-15803 1323.5,-15871"/>
<text text-anchor="middle" x="1120" y="-15855.8" font-family="Times,serif" font-size="14.00">Expert 1 MLP2</text>
<text text-anchor="middle" x="1120" y="-15840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1120" y="-15825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1120" y="-15810.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer7_gpu1_expert_act&#45;&gt;layer7_gpu1_expert_mlp2 -->
<g id="edge753" class="edge">
<title>layer7_gpu1_expert_act&#45;&gt;layer7_gpu1_expert_mlp2</title>
<path fill="none" stroke="black" d="M1135.53,-15906.88C1133.68,-15898.69 1131.68,-15889.79 1129.74,-15881.19"/>
<polygon fill="black" stroke="black" points="1133.12,-15880.28 1127.51,-15871.3 1126.29,-15881.82 1133.12,-15880.28"/>
</g>
<!-- layer7_gpu1_token_send -->
<g id="node649" class="node">
<title>layer7_gpu1_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1101" cy="-15718.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1101" y="-15737.71" font-family="Times,serif" font-size="14.00">Token Send GPU1</text>
<text text-anchor="middle" x="1101" y="-15722.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1101" y="-15707.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1101" y="-15692.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer7_gpu1_expert_mlp2&#45;&gt;layer7_gpu1_token_send -->
<g id="edge754" class="edge">
<title>layer7_gpu1_expert_mlp2&#45;&gt;layer7_gpu1_token_send</title>
<path fill="none" stroke="black" d="M1114.56,-15802.73C1113.23,-15794.65 1111.78,-15785.78 1110.33,-15776.95"/>
<polygon fill="black" stroke="black" points="1113.78,-15776.33 1108.71,-15767.02 1106.87,-15777.46 1113.78,-15776.33"/>
</g>
<!-- layer7_gpu1_token_send&#45;&gt;layer7_expert_agg -->
<g id="edge755" class="edge">
<title>layer7_gpu1_token_send&#45;&gt;layer7_expert_agg</title>
<path fill="none" stroke="black" d="M1340.48,-15683.3C1381.93,-15678.35 1424.65,-15673.91 1465,-15670.83 2238.74,-15611.83 4565.72,-15581.35 5468.99,-15571.49"/>
<polygon fill="black" stroke="black" points="5469.26,-15574.98 5479.23,-15571.37 5469.19,-15567.98 5469.26,-15574.98"/>
</g>
<!-- layer7_gpu2_expert_mlp1 -->
<g id="node651" class="node">
<title>layer7_gpu2_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2083.5,-16079 1622.5,-16079 1622.5,-16011 2083.5,-16011 2083.5,-16079"/>
<text text-anchor="middle" x="1853" y="-16063.8" font-family="Times,serif" font-size="14.00">Expert 2 MLP1</text>
<text text-anchor="middle" x="1853" y="-16048.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1853" y="-16033.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1853" y="-16018.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer7_gpu2_token_recv&#45;&gt;layer7_gpu2_expert_mlp1 -->
<g id="edge757" class="edge">
<title>layer7_gpu2_token_recv&#45;&gt;layer7_gpu2_expert_mlp1</title>
<path fill="none" stroke="black" d="M1868.42,-16114.87C1866.53,-16106.39 1864.56,-16097.59 1862.68,-16089.23"/>
<polygon fill="black" stroke="black" points="1866.06,-16088.29 1860.46,-16079.3 1859.23,-16089.82 1866.06,-16088.29"/>
</g>
<!-- layer7_gpu2_expert_act -->
<g id="node652" class="node">
<title>layer7_gpu2_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2028.5,-15975 1651.5,-15975 1651.5,-15907 2028.5,-15907 2028.5,-15975"/>
<text text-anchor="middle" x="1840" y="-15959.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="1840" y="-15944.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1840" y="-15929.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1840" y="-15914.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer7_gpu2_expert_mlp1&#45;&gt;layer7_gpu2_expert_act -->
<g id="edge758" class="edge">
<title>layer7_gpu2_expert_mlp1&#45;&gt;layer7_gpu2_expert_act</title>
<path fill="none" stroke="black" d="M1848.78,-16010.88C1847.75,-16002.78 1846.63,-15993.98 1845.54,-15985.47"/>
<polygon fill="black" stroke="black" points="1848.98,-15984.77 1844.24,-15975.3 1842.04,-15985.66 1848.98,-15984.77"/>
</g>
<!-- layer7_gpu2_expert_mlp2 -->
<g id="node653" class="node">
<title>layer7_gpu2_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2040.5,-15871 1633.5,-15871 1633.5,-15803 2040.5,-15803 2040.5,-15871"/>
<text text-anchor="middle" x="1837" y="-15855.8" font-family="Times,serif" font-size="14.00">Expert 2 MLP2</text>
<text text-anchor="middle" x="1837" y="-15840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1837" y="-15825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1837" y="-15810.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer7_gpu2_expert_act&#45;&gt;layer7_gpu2_expert_mlp2 -->
<g id="edge759" class="edge">
<title>layer7_gpu2_expert_act&#45;&gt;layer7_gpu2_expert_mlp2</title>
<path fill="none" stroke="black" d="M1839.03,-15906.88C1838.79,-15898.78 1838.53,-15889.98 1838.28,-15881.47"/>
<polygon fill="black" stroke="black" points="1841.77,-15881.19 1837.98,-15871.3 1834.77,-15881.4 1841.77,-15881.19"/>
</g>
<!-- layer7_gpu2_token_send -->
<g id="node654" class="node">
<title>layer7_gpu2_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1830" cy="-15718.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1830" y="-15737.71" font-family="Times,serif" font-size="14.00">Token Send GPU2</text>
<text text-anchor="middle" x="1830" y="-15722.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1830" y="-15707.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1830" y="-15692.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer7_gpu2_expert_mlp2&#45;&gt;layer7_gpu2_token_send -->
<g id="edge760" class="edge">
<title>layer7_gpu2_expert_mlp2&#45;&gt;layer7_gpu2_token_send</title>
<path fill="none" stroke="black" d="M1834.99,-15802.73C1834.51,-15794.74 1833.98,-15785.97 1833.46,-15777.23"/>
<polygon fill="black" stroke="black" points="1836.94,-15776.79 1832.84,-15767.02 1829.95,-15777.22 1836.94,-15776.79"/>
</g>
<!-- layer7_gpu2_token_send&#45;&gt;layer7_expert_agg -->
<g id="edge761" class="edge">
<title>layer7_gpu2_token_send&#45;&gt;layer7_expert_agg</title>
<path fill="none" stroke="black" d="M2069.99,-15683.41C2111.28,-15678.46 2153.82,-15673.99 2194,-15670.83 2822.66,-15621.4 4682.34,-15586.45 5471.91,-15573.44"/>
<polygon fill="black" stroke="black" points="5472.08,-15576.93 5482.02,-15573.27 5471.96,-15569.94 5472.08,-15576.93"/>
</g>
<!-- layer7_gpu3_expert_mlp1 -->
<g id="node656" class="node">
<title>layer7_gpu3_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2798.5,-16079 2337.5,-16079 2337.5,-16011 2798.5,-16011 2798.5,-16079"/>
<text text-anchor="middle" x="2568" y="-16063.8" font-family="Times,serif" font-size="14.00">Expert 3 MLP1</text>
<text text-anchor="middle" x="2568" y="-16048.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2568" y="-16033.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2568" y="-16018.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer7_gpu3_token_recv&#45;&gt;layer7_gpu3_expert_mlp1 -->
<g id="edge763" class="edge">
<title>layer7_gpu3_token_recv&#45;&gt;layer7_gpu3_expert_mlp1</title>
<path fill="none" stroke="black" d="M2570.37,-16114.87C2570.08,-16106.48 2569.78,-16097.78 2569.5,-16089.5"/>
<polygon fill="black" stroke="black" points="2572.99,-16089.17 2569.15,-16079.3 2565.99,-16089.42 2572.99,-16089.17"/>
</g>
<!-- layer7_gpu3_expert_act -->
<g id="node657" class="node">
<title>layer7_gpu3_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2751.5,-15975 2374.5,-15975 2374.5,-15907 2751.5,-15907 2751.5,-15975"/>
<text text-anchor="middle" x="2563" y="-15959.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="2563" y="-15944.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2563" y="-15929.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2563" y="-15914.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer7_gpu3_expert_mlp1&#45;&gt;layer7_gpu3_expert_act -->
<g id="edge764" class="edge">
<title>layer7_gpu3_expert_mlp1&#45;&gt;layer7_gpu3_expert_act</title>
<path fill="none" stroke="black" d="M2566.38,-16010.88C2565.98,-16002.78 2565.55,-15993.98 2565.13,-15985.47"/>
<polygon fill="black" stroke="black" points="2568.62,-15985.11 2564.63,-15975.3 2561.63,-15985.46 2568.62,-15985.11"/>
</g>
<!-- layer7_gpu3_expert_mlp2 -->
<g id="node658" class="node">
<title>layer7_gpu3_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2765.5,-15871 2358.5,-15871 2358.5,-15803 2765.5,-15803 2765.5,-15871"/>
<text text-anchor="middle" x="2562" y="-15855.8" font-family="Times,serif" font-size="14.00">Expert 3 MLP2</text>
<text text-anchor="middle" x="2562" y="-15840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2562" y="-15825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="2562" y="-15810.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer7_gpu3_expert_act&#45;&gt;layer7_gpu3_expert_mlp2 -->
<g id="edge765" class="edge">
<title>layer7_gpu3_expert_act&#45;&gt;layer7_gpu3_expert_mlp2</title>
<path fill="none" stroke="black" d="M2562.68,-15906.88C2562.6,-15898.78 2562.51,-15889.98 2562.43,-15881.47"/>
<polygon fill="black" stroke="black" points="2565.92,-15881.26 2562.33,-15871.3 2558.92,-15881.33 2565.92,-15881.26"/>
</g>
<!-- layer7_gpu3_token_send -->
<g id="node659" class="node">
<title>layer7_gpu3_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="2559" cy="-15718.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="2559" y="-15737.71" font-family="Times,serif" font-size="14.00">Token Send GPU3</text>
<text text-anchor="middle" x="2559" y="-15722.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="2559" y="-15707.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="2559" y="-15692.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer7_gpu3_expert_mlp2&#45;&gt;layer7_gpu3_token_send -->
<g id="edge766" class="edge">
<title>layer7_gpu3_expert_mlp2&#45;&gt;layer7_gpu3_token_send</title>
<path fill="none" stroke="black" d="M2561.14,-15802.73C2560.93,-15794.74 2560.71,-15785.97 2560.48,-15777.23"/>
<polygon fill="black" stroke="black" points="2563.97,-15776.93 2560.22,-15767.02 2556.98,-15777.11 2563.97,-15776.93"/>
</g>
<!-- layer7_gpu3_token_send&#45;&gt;layer7_expert_agg -->
<g id="edge767" class="edge">
<title>layer7_gpu3_token_send&#45;&gt;layer7_expert_agg</title>
<path fill="none" stroke="black" d="M2799.99,-15683.53C2840.97,-15678.6 2883.15,-15674.11 2923,-15670.83 3836.24,-15595.77 4915.14,-15575.36 5467.26,-15569.85"/>
<polygon fill="black" stroke="black" points="5467.4,-15573.35 5477.37,-15569.75 5467.33,-15566.35 5467.4,-15573.35"/>
</g>
<!-- layer7_gpu4_expert_mlp1 -->
<g id="node661" class="node">
<title>layer7_gpu4_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="3547.5,-16079 3086.5,-16079 3086.5,-16011 3547.5,-16011 3547.5,-16079"/>
<text text-anchor="middle" x="3317" y="-16063.8" font-family="Times,serif" font-size="14.00">Expert 4 MLP1</text>
<text text-anchor="middle" x="3317" y="-16048.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3317" y="-16033.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3317" y="-16018.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer7_gpu4_token_recv&#45;&gt;layer7_gpu4_expert_mlp1 -->
<g id="edge769" class="edge">
<title>layer7_gpu4_token_recv&#45;&gt;layer7_gpu4_expert_mlp1</title>
<path fill="none" stroke="black" d="M3332.42,-16114.87C3330.53,-16106.39 3328.56,-16097.59 3326.68,-16089.23"/>
<polygon fill="black" stroke="black" points="3330.06,-16088.29 3324.46,-16079.3 3323.23,-16089.82 3330.06,-16088.29"/>
</g>
<!-- layer7_gpu4_expert_act -->
<g id="node662" class="node">
<title>layer7_gpu4_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="3498.5,-15975 3121.5,-15975 3121.5,-15907 3498.5,-15907 3498.5,-15975"/>
<text text-anchor="middle" x="3310" y="-15959.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="3310" y="-15944.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3310" y="-15929.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3310" y="-15914.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer7_gpu4_expert_mlp1&#45;&gt;layer7_gpu4_expert_act -->
<g id="edge770" class="edge">
<title>layer7_gpu4_expert_mlp1&#45;&gt;layer7_gpu4_expert_act</title>
<path fill="none" stroke="black" d="M3314.73,-16010.88C3314.17,-16002.78 3313.57,-15993.98 3312.98,-15985.47"/>
<polygon fill="black" stroke="black" points="3316.46,-15985.03 3312.29,-15975.3 3309.48,-15985.51 3316.46,-15985.03"/>
</g>
<!-- layer7_gpu4_expert_mlp2 -->
<g id="node663" class="node">
<title>layer7_gpu4_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="3500.5,-15871 3093.5,-15871 3093.5,-15803 3500.5,-15803 3500.5,-15871"/>
<text text-anchor="middle" x="3297" y="-15855.8" font-family="Times,serif" font-size="14.00">Expert 4 MLP2</text>
<text text-anchor="middle" x="3297" y="-15840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3297" y="-15825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="3297" y="-15810.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer7_gpu4_expert_act&#45;&gt;layer7_gpu4_expert_mlp2 -->
<g id="edge771" class="edge">
<title>layer7_gpu4_expert_act&#45;&gt;layer7_gpu4_expert_mlp2</title>
<path fill="none" stroke="black" d="M3305.78,-15906.88C3304.75,-15898.78 3303.63,-15889.98 3302.54,-15881.47"/>
<polygon fill="black" stroke="black" points="3305.98,-15880.77 3301.24,-15871.3 3299.04,-15881.66 3305.98,-15880.77"/>
</g>
<!-- layer7_gpu4_token_send -->
<g id="node664" class="node">
<title>layer7_gpu4_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="3288" cy="-15718.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="3288" y="-15737.71" font-family="Times,serif" font-size="14.00">Token Send GPU4</text>
<text text-anchor="middle" x="3288" y="-15722.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="3288" y="-15707.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="3288" y="-15692.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer7_gpu4_expert_mlp2&#45;&gt;layer7_gpu4_token_send -->
<g id="edge772" class="edge">
<title>layer7_gpu4_expert_mlp2&#45;&gt;layer7_gpu4_token_send</title>
<path fill="none" stroke="black" d="M3294.42,-15802.73C3293.8,-15794.74 3293.12,-15785.97 3292.44,-15777.23"/>
<polygon fill="black" stroke="black" points="3295.92,-15776.72 3291.65,-15767.02 3288.94,-15777.26 3295.92,-15776.72"/>
</g>
<!-- layer7_gpu4_token_send&#45;&gt;layer7_expert_agg -->
<g id="edge773" class="edge">
<title>layer7_gpu4_token_send&#45;&gt;layer7_expert_agg</title>
<path fill="none" stroke="black" d="M3530.98,-15683.69C3571.34,-15678.81 3612.8,-15674.29 3652,-15670.83 4292.66,-15614.36 5042.1,-15587.5 5474.73,-15575.81"/>
<polygon fill="black" stroke="black" points="5474.99,-15579.3 5484.89,-15575.53 5474.8,-15572.3 5474.99,-15579.3"/>
</g>
<!-- layer7_gpu5_expert_mlp1 -->
<g id="node666" class="node">
<title>layer7_gpu5_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4276.5,-16079 3815.5,-16079 3815.5,-16011 4276.5,-16011 4276.5,-16079"/>
<text text-anchor="middle" x="4046" y="-16063.8" font-family="Times,serif" font-size="14.00">Expert 5 MLP1</text>
<text text-anchor="middle" x="4046" y="-16048.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4046" y="-16033.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4046" y="-16018.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer7_gpu5_token_recv&#45;&gt;layer7_gpu5_expert_mlp1 -->
<g id="edge775" class="edge">
<title>layer7_gpu5_token_recv&#45;&gt;layer7_gpu5_expert_mlp1</title>
<path fill="none" stroke="black" d="M4061.42,-16114.87C4059.53,-16106.39 4057.56,-16097.59 4055.68,-16089.23"/>
<polygon fill="black" stroke="black" points="4059.06,-16088.29 4053.46,-16079.3 4052.23,-16089.82 4059.06,-16088.29"/>
</g>
<!-- layer7_gpu5_expert_act -->
<g id="node667" class="node">
<title>layer7_gpu5_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4225.5,-15975 3848.5,-15975 3848.5,-15907 4225.5,-15907 4225.5,-15975"/>
<text text-anchor="middle" x="4037" y="-15959.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="4037" y="-15944.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4037" y="-15929.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4037" y="-15914.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer7_gpu5_expert_mlp1&#45;&gt;layer7_gpu5_expert_act -->
<g id="edge776" class="edge">
<title>layer7_gpu5_expert_mlp1&#45;&gt;layer7_gpu5_expert_act</title>
<path fill="none" stroke="black" d="M4043.08,-16010.88C4042.36,-16002.78 4041.59,-15993.98 4040.84,-15985.47"/>
<polygon fill="black" stroke="black" points="4044.3,-15984.95 4039.94,-15975.3 4037.33,-15985.57 4044.3,-15984.95"/>
</g>
<!-- layer7_gpu5_expert_mlp2 -->
<g id="node668" class="node">
<title>layer7_gpu5_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4233.5,-15871 3826.5,-15871 3826.5,-15803 4233.5,-15803 4233.5,-15871"/>
<text text-anchor="middle" x="4030" y="-15855.8" font-family="Times,serif" font-size="14.00">Expert 5 MLP2</text>
<text text-anchor="middle" x="4030" y="-15840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4030" y="-15825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4030" y="-15810.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer7_gpu5_expert_act&#45;&gt;layer7_gpu5_expert_mlp2 -->
<g id="edge777" class="edge">
<title>layer7_gpu5_expert_act&#45;&gt;layer7_gpu5_expert_mlp2</title>
<path fill="none" stroke="black" d="M4034.73,-15906.88C4034.17,-15898.78 4033.57,-15889.98 4032.98,-15881.47"/>
<polygon fill="black" stroke="black" points="4036.46,-15881.03 4032.29,-15871.3 4029.48,-15881.51 4036.46,-15881.03"/>
</g>
<!-- layer7_gpu5_token_send -->
<g id="node669" class="node">
<title>layer7_gpu5_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4017" cy="-15718.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4017" y="-15737.71" font-family="Times,serif" font-size="14.00">Token Send GPU5</text>
<text text-anchor="middle" x="4017" y="-15722.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4017" y="-15707.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4017" y="-15692.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer7_gpu5_expert_mlp2&#45;&gt;layer7_gpu5_token_send -->
<g id="edge778" class="edge">
<title>layer7_gpu5_expert_mlp2&#45;&gt;layer7_gpu5_token_send</title>
<path fill="none" stroke="black" d="M4026.27,-15802.73C4025.38,-15794.74 4024.4,-15785.97 4023.42,-15777.23"/>
<polygon fill="black" stroke="black" points="4026.87,-15776.57 4022.28,-15767.02 4019.91,-15777.35 4026.87,-15776.57"/>
</g>
<!-- layer7_gpu5_token_send&#45;&gt;layer7_expert_agg -->
<g id="edge779" class="edge">
<title>layer7_gpu5_token_send&#45;&gt;layer7_expert_agg</title>
<path fill="none" stroke="black" d="M4263,-15684.13C4302.42,-15679.28 4342.8,-15674.65 4381,-15670.83 4759.36,-15632.97 5194.56,-15604.03 5489.07,-15586.61"/>
<polygon fill="black" stroke="black" points="5489.71,-15590.08 5499.49,-15586 5489.3,-15583.09 5489.71,-15590.08"/>
</g>
<!-- layer7_gpu6_expert_mlp1 -->
<g id="node671" class="node">
<title>layer7_gpu6_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5002.5,-16079 4541.5,-16079 4541.5,-16011 5002.5,-16011 5002.5,-16079"/>
<text text-anchor="middle" x="4772" y="-16063.8" font-family="Times,serif" font-size="14.00">Expert 6 MLP1</text>
<text text-anchor="middle" x="4772" y="-16048.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4772" y="-16033.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4772" y="-16018.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer7_gpu6_token_recv&#45;&gt;layer7_gpu6_expert_mlp1 -->
<g id="edge781" class="edge">
<title>layer7_gpu6_token_recv&#45;&gt;layer7_gpu6_expert_mlp1</title>
<path fill="none" stroke="black" d="M4776.75,-16114.87C4776.17,-16106.48 4775.57,-16097.78 4775,-16089.5"/>
<polygon fill="black" stroke="black" points="4778.47,-16089.04 4774.3,-16079.3 4771.49,-16089.52 4778.47,-16089.04"/>
</g>
<!-- layer7_gpu6_expert_act -->
<g id="node672" class="node">
<title>layer7_gpu6_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4944.5,-15975 4567.5,-15975 4567.5,-15907 4944.5,-15907 4944.5,-15975"/>
<text text-anchor="middle" x="4756" y="-15959.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="4756" y="-15944.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4756" y="-15929.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4756" y="-15914.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer7_gpu6_expert_mlp1&#45;&gt;layer7_gpu6_expert_act -->
<g id="edge782" class="edge">
<title>layer7_gpu6_expert_mlp1&#45;&gt;layer7_gpu6_expert_act</title>
<path fill="none" stroke="black" d="M4766.81,-16010.88C4765.52,-16002.69 4764.12,-15993.79 4762.78,-15985.19"/>
<polygon fill="black" stroke="black" points="4766.23,-15984.63 4761.22,-15975.3 4759.32,-15985.72 4766.23,-15984.63"/>
</g>
<!-- layer7_gpu6_expert_mlp2 -->
<g id="node673" class="node">
<title>layer7_gpu6_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4955.5,-15871 4548.5,-15871 4548.5,-15803 4955.5,-15803 4955.5,-15871"/>
<text text-anchor="middle" x="4752" y="-15855.8" font-family="Times,serif" font-size="14.00">Expert 6 MLP2</text>
<text text-anchor="middle" x="4752" y="-15840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4752" y="-15825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4752" y="-15810.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer7_gpu6_expert_act&#45;&gt;layer7_gpu6_expert_mlp2 -->
<g id="edge783" class="edge">
<title>layer7_gpu6_expert_act&#45;&gt;layer7_gpu6_expert_mlp2</title>
<path fill="none" stroke="black" d="M4754.7,-15906.88C4754.38,-15898.78 4754.04,-15889.98 4753.7,-15881.47"/>
<polygon fill="black" stroke="black" points="4757.2,-15881.15 4753.31,-15871.3 4750.2,-15881.43 4757.2,-15881.15"/>
</g>
<!-- layer7_gpu6_token_send -->
<g id="node674" class="node">
<title>layer7_gpu6_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4746" cy="-15718.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4746" y="-15737.71" font-family="Times,serif" font-size="14.00">Token Send GPU6</text>
<text text-anchor="middle" x="4746" y="-15722.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4746" y="-15707.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4746" y="-15692.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer7_gpu6_expert_mlp2&#45;&gt;layer7_gpu6_token_send -->
<g id="edge784" class="edge">
<title>layer7_gpu6_expert_mlp2&#45;&gt;layer7_gpu6_token_send</title>
<path fill="none" stroke="black" d="M4750.28,-15802.73C4749.87,-15794.74 4749.41,-15785.97 4748.96,-15777.23"/>
<polygon fill="black" stroke="black" points="4752.45,-15776.83 4748.43,-15767.02 4745.46,-15777.19 4752.45,-15776.83"/>
</g>
<!-- layer7_gpu6_token_send&#45;&gt;layer7_expert_agg -->
<g id="edge785" class="edge">
<title>layer7_gpu6_token_send&#45;&gt;layer7_expert_agg</title>
<path fill="none" stroke="black" d="M4991.3,-15684.05C5148.16,-15662.39 5353.02,-15634.1 5521.36,-15610.86"/>
<polygon fill="black" stroke="black" points="5521.95,-15614.31 5531.38,-15609.48 5520.99,-15607.38 5521.95,-15614.31"/>
</g>
<!-- layer7_gpu7_expert_mlp1 -->
<g id="node676" class="node">
<title>layer7_gpu7_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5705.5,-16079 5244.5,-16079 5244.5,-16011 5705.5,-16011 5705.5,-16079"/>
<text text-anchor="middle" x="5475" y="-16063.8" font-family="Times,serif" font-size="14.00">Expert 7 MLP1</text>
<text text-anchor="middle" x="5475" y="-16048.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5475" y="-16033.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-16018.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_gpu7_token_recv&#45;&gt;layer7_gpu7_expert_mlp1 -->
<g id="edge787" class="edge">
<title>layer7_gpu7_token_recv&#45;&gt;layer7_gpu7_expert_mlp1</title>
<path fill="none" stroke="black" d="M5476.19,-16114.87C5476.04,-16106.48 5475.89,-16097.78 5475.75,-16089.5"/>
<polygon fill="black" stroke="black" points="5479.25,-16089.24 5475.57,-16079.3 5472.25,-16089.36 5479.25,-16089.24"/>
</g>
<!-- layer7_gpu7_expert_act -->
<g id="node677" class="node">
<title>layer7_gpu7_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="5663.5,-15975 5286.5,-15975 5286.5,-15907 5663.5,-15907 5663.5,-15975"/>
<text text-anchor="middle" x="5475" y="-15959.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="5475" y="-15944.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-15929.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-15914.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_gpu7_expert_mlp1&#45;&gt;layer7_gpu7_expert_act -->
<g id="edge788" class="edge">
<title>layer7_gpu7_expert_mlp1&#45;&gt;layer7_gpu7_expert_act</title>
<path fill="none" stroke="black" d="M5475,-16010.88C5475,-16002.78 5475,-15993.98 5475,-15985.47"/>
<polygon fill="black" stroke="black" points="5478.5,-15985.3 5475,-15975.3 5471.5,-15985.3 5478.5,-15985.3"/>
</g>
<!-- layer7_gpu7_expert_mlp2 -->
<g id="node678" class="node">
<title>layer7_gpu7_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="5678.5,-15871 5271.5,-15871 5271.5,-15803 5678.5,-15803 5678.5,-15871"/>
<text text-anchor="middle" x="5475" y="-15855.8" font-family="Times,serif" font-size="14.00">Expert 7 MLP2</text>
<text text-anchor="middle" x="5475" y="-15840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-15825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5475" y="-15810.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_gpu7_expert_act&#45;&gt;layer7_gpu7_expert_mlp2 -->
<g id="edge789" class="edge">
<title>layer7_gpu7_expert_act&#45;&gt;layer7_gpu7_expert_mlp2</title>
<path fill="none" stroke="black" d="M5475,-15906.88C5475,-15898.78 5475,-15889.98 5475,-15881.47"/>
<polygon fill="black" stroke="black" points="5478.5,-15881.3 5475,-15871.3 5471.5,-15881.3 5478.5,-15881.3"/>
</g>
<!-- layer7_gpu7_token_send -->
<g id="node679" class="node">
<title>layer7_gpu7_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="5475" cy="-15718.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="5475" y="-15737.71" font-family="Times,serif" font-size="14.00">Token Send GPU7</text>
<text text-anchor="middle" x="5475" y="-15722.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="5475" y="-15707.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="5475" y="-15692.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_gpu7_expert_mlp2&#45;&gt;layer7_gpu7_token_send -->
<g id="edge790" class="edge">
<title>layer7_gpu7_expert_mlp2&#45;&gt;layer7_gpu7_token_send</title>
<path fill="none" stroke="black" d="M5475,-15802.73C5475,-15794.74 5475,-15785.97 5475,-15777.23"/>
<polygon fill="black" stroke="black" points="5478.5,-15777.02 5475,-15767.02 5471.5,-15777.02 5478.5,-15777.02"/>
</g>
<!-- layer7_gpu7_token_send&#45;&gt;layer7_expert_agg -->
<g id="edge791" class="edge">
<title>layer7_gpu7_token_send&#45;&gt;layer7_expert_agg</title>
<path fill="none" stroke="black" d="M5582.41,-15672.88C5608.04,-15662.14 5636.01,-15650.41 5663.68,-15638.82"/>
<polygon fill="black" stroke="black" points="5665.17,-15641.98 5673.04,-15634.89 5662.47,-15635.53 5665.17,-15641.98"/>
</g>
<!-- layer7_gpu8_expert_mlp1 -->
<g id="node681" class="node">
<title>layer7_gpu8_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="6400.5,-16079 5939.5,-16079 5939.5,-16011 6400.5,-16011 6400.5,-16079"/>
<text text-anchor="middle" x="6170" y="-16063.8" font-family="Times,serif" font-size="14.00">Expert 8 MLP1</text>
<text text-anchor="middle" x="6170" y="-16048.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6170" y="-16033.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6170" y="-16018.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer7_gpu8_token_recv&#45;&gt;layer7_gpu8_expert_mlp1 -->
<g id="edge793" class="edge">
<title>layer7_gpu8_token_recv&#45;&gt;layer7_gpu8_expert_mlp1</title>
<path fill="none" stroke="black" d="M6167.03,-16114.87C6167.39,-16106.48 6167.77,-16097.78 6168.13,-16089.5"/>
<polygon fill="black" stroke="black" points="6171.63,-16089.44 6168.57,-16079.3 6164.64,-16089.14 6171.63,-16089.44"/>
</g>
<!-- layer7_gpu8_expert_act -->
<g id="node682" class="node">
<title>layer7_gpu8_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="6368.5,-15975 5991.5,-15975 5991.5,-15907 6368.5,-15907 6368.5,-15975"/>
<text text-anchor="middle" x="6180" y="-15959.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="6180" y="-15944.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6180" y="-15929.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6180" y="-15914.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer7_gpu8_expert_mlp1&#45;&gt;layer7_gpu8_expert_act -->
<g id="edge794" class="edge">
<title>layer7_gpu8_expert_mlp1&#45;&gt;layer7_gpu8_expert_act</title>
<path fill="none" stroke="black" d="M6173.25,-16010.88C6174.04,-16002.78 6174.9,-15993.98 6175.74,-15985.47"/>
<polygon fill="black" stroke="black" points="6179.24,-15985.59 6176.74,-15975.3 6172.28,-15984.91 6179.24,-15985.59"/>
</g>
<!-- layer7_gpu8_expert_mlp2 -->
<g id="node683" class="node">
<title>layer7_gpu8_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="6403.5,-15871 5996.5,-15871 5996.5,-15803 6403.5,-15803 6403.5,-15871"/>
<text text-anchor="middle" x="6200" y="-15855.8" font-family="Times,serif" font-size="14.00">Expert 8 MLP2</text>
<text text-anchor="middle" x="6200" y="-15840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6200" y="-15825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6200" y="-15810.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer7_gpu8_expert_act&#45;&gt;layer7_gpu8_expert_mlp2 -->
<g id="edge795" class="edge">
<title>layer7_gpu8_expert_act&#45;&gt;layer7_gpu8_expert_mlp2</title>
<path fill="none" stroke="black" d="M6186.49,-15906.88C6188.1,-15898.69 6189.85,-15889.79 6191.53,-15881.19"/>
<polygon fill="black" stroke="black" points="6194.98,-15881.78 6193.47,-15871.3 6188.11,-15880.44 6194.98,-15881.78"/>
</g>
<!-- layer7_gpu8_token_send -->
<g id="node684" class="node">
<title>layer7_gpu8_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6204" cy="-15718.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6204" y="-15737.71" font-family="Times,serif" font-size="14.00">Token Send GPU8</text>
<text text-anchor="middle" x="6204" y="-15722.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6204" y="-15707.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6204" y="-15692.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer7_gpu8_expert_mlp2&#45;&gt;layer7_gpu8_token_send -->
<g id="edge796" class="edge">
<title>layer7_gpu8_expert_mlp2&#45;&gt;layer7_gpu8_token_send</title>
<path fill="none" stroke="black" d="M6201.15,-15802.73C6201.42,-15794.74 6201.72,-15785.97 6202.03,-15777.23"/>
<polygon fill="black" stroke="black" points="6205.53,-15777.14 6202.38,-15767.02 6198.53,-15776.9 6205.53,-15777.14"/>
</g>
<!-- layer7_gpu8_token_send&#45;&gt;layer7_expert_agg -->
<g id="edge797" class="edge">
<title>layer7_gpu8_token_send&#45;&gt;layer7_expert_agg</title>
<path fill="none" stroke="black" d="M6093.44,-15673.19C6066.56,-15662.31 6037.15,-15650.42 6008.09,-15638.66"/>
<polygon fill="black" stroke="black" points="6009.25,-15635.36 5998.67,-15634.85 6006.63,-15641.84 6009.25,-15635.36"/>
</g>
<!-- layer7_gpu9_expert_mlp1 -->
<g id="node686" class="node">
<title>layer7_gpu9_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7092.5,-16079 6631.5,-16079 6631.5,-16011 7092.5,-16011 7092.5,-16079"/>
<text text-anchor="middle" x="6862" y="-16063.8" font-family="Times,serif" font-size="14.00">Expert 9 MLP1</text>
<text text-anchor="middle" x="6862" y="-16048.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6862" y="-16033.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6862" y="-16018.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer7_gpu9_token_recv&#45;&gt;layer7_gpu9_expert_mlp1 -->
<g id="edge799" class="edge">
<title>layer7_gpu9_token_recv&#45;&gt;layer7_gpu9_expert_mlp1</title>
<path fill="none" stroke="black" d="M6856.07,-16114.87C6856.79,-16106.48 6857.54,-16097.78 6858.25,-16089.5"/>
<polygon fill="black" stroke="black" points="6861.76,-16089.56 6859.13,-16079.3 6854.79,-16088.96 6861.76,-16089.56"/>
</g>
<!-- layer7_gpu9_expert_act -->
<g id="node687" class="node">
<title>layer7_gpu9_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7059.5,-15975 6682.5,-15975 6682.5,-15907 7059.5,-15907 7059.5,-15975"/>
<text text-anchor="middle" x="6871" y="-15959.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="6871" y="-15944.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6871" y="-15929.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6871" y="-15914.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer7_gpu9_expert_mlp1&#45;&gt;layer7_gpu9_expert_act -->
<g id="edge800" class="edge">
<title>layer7_gpu9_expert_mlp1&#45;&gt;layer7_gpu9_expert_act</title>
<path fill="none" stroke="black" d="M6864.92,-16010.88C6865.64,-16002.78 6866.41,-15993.98 6867.16,-15985.47"/>
<polygon fill="black" stroke="black" points="6870.67,-15985.57 6868.06,-15975.3 6863.7,-15984.95 6870.67,-15985.57"/>
</g>
<!-- layer7_gpu9_expert_mlp2 -->
<g id="node688" class="node">
<title>layer7_gpu9_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7094.5,-15871 6687.5,-15871 6687.5,-15803 7094.5,-15803 7094.5,-15871"/>
<text text-anchor="middle" x="6891" y="-15855.8" font-family="Times,serif" font-size="14.00">Expert 9 MLP2</text>
<text text-anchor="middle" x="6891" y="-15840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6891" y="-15825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6891" y="-15810.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer7_gpu9_expert_act&#45;&gt;layer7_gpu9_expert_mlp2 -->
<g id="edge801" class="edge">
<title>layer7_gpu9_expert_act&#45;&gt;layer7_gpu9_expert_mlp2</title>
<path fill="none" stroke="black" d="M6877.49,-15906.88C6879.1,-15898.69 6880.85,-15889.79 6882.53,-15881.19"/>
<polygon fill="black" stroke="black" points="6885.98,-15881.78 6884.47,-15871.3 6879.11,-15880.44 6885.98,-15881.78"/>
</g>
<!-- layer7_gpu9_token_send -->
<g id="node689" class="node">
<title>layer7_gpu9_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6933" cy="-15718.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6933" y="-15737.71" font-family="Times,serif" font-size="14.00">Token Send GPU9</text>
<text text-anchor="middle" x="6933" y="-15722.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6933" y="-15707.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6933" y="-15692.71" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer7_gpu9_expert_mlp2&#45;&gt;layer7_gpu9_token_send -->
<g id="edge802" class="edge">
<title>layer7_gpu9_expert_mlp2&#45;&gt;layer7_gpu9_token_send</title>
<path fill="none" stroke="black" d="M6903.04,-15802.73C6905.99,-15794.57 6909.24,-15785.59 6912.47,-15776.66"/>
<polygon fill="black" stroke="black" points="6915.84,-15777.62 6915.96,-15767.02 6909.26,-15775.24 6915.84,-15777.62"/>
</g>
<!-- layer7_gpu9_token_send&#45;&gt;layer7_expert_agg -->
<g id="edge803" class="edge">
<title>layer7_gpu9_token_send&#45;&gt;layer7_expert_agg</title>
<path fill="none" stroke="black" d="M6686.14,-15684.23C6568.26,-15668.15 6423.37,-15648.38 6286.67,-15629.73"/>
<polygon fill="black" stroke="black" points="6286.8,-15626.22 6276.42,-15628.33 6285.86,-15633.15 6286.8,-15626.22"/>
</g>
<!-- layer7_gpu10_expert_mlp1 -->
<g id="node691" class="node">
<title>layer7_gpu10_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7785.5,-16079 7324.5,-16079 7324.5,-16011 7785.5,-16011 7785.5,-16079"/>
<text text-anchor="middle" x="7555" y="-16063.8" font-family="Times,serif" font-size="14.00">Expert 10 MLP1</text>
<text text-anchor="middle" x="7555" y="-16048.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7555" y="-16033.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7555" y="-16018.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer7_gpu10_token_recv&#45;&gt;layer7_gpu10_expert_mlp1 -->
<g id="edge805" class="edge">
<title>layer7_gpu10_token_recv&#45;&gt;layer7_gpu10_expert_mlp1</title>
<path fill="none" stroke="black" d="M7545.51,-16114.87C7546.68,-16106.39 7547.89,-16097.59 7549.04,-16089.23"/>
<polygon fill="black" stroke="black" points="7552.51,-16089.69 7550.41,-16079.3 7545.58,-16088.73 7552.51,-16089.69"/>
</g>
<!-- layer7_gpu10_expert_act -->
<g id="node692" class="node">
<title>layer7_gpu10_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7774.5,-15975 7397.5,-15975 7397.5,-15907 7774.5,-15907 7774.5,-15975"/>
<text text-anchor="middle" x="7586" y="-15959.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="7586" y="-15944.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7586" y="-15929.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7586" y="-15914.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer7_gpu10_expert_mlp1&#45;&gt;layer7_gpu10_expert_act -->
<g id="edge806" class="edge">
<title>layer7_gpu10_expert_mlp1&#45;&gt;layer7_gpu10_expert_act</title>
<path fill="none" stroke="black" d="M7565.06,-16010.88C7567.58,-16002.6 7570.32,-15993.59 7572.96,-15984.91"/>
<polygon fill="black" stroke="black" points="7576.32,-15985.88 7575.88,-15975.3 7569.62,-15983.85 7576.32,-15985.88"/>
</g>
<!-- layer7_gpu10_expert_mlp2 -->
<g id="node693" class="node">
<title>layer7_gpu10_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7851.5,-15871 7444.5,-15871 7444.5,-15803 7851.5,-15803 7851.5,-15871"/>
<text text-anchor="middle" x="7648" y="-15855.8" font-family="Times,serif" font-size="14.00">Expert 10 MLP2</text>
<text text-anchor="middle" x="7648" y="-15840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7648" y="-15825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="7648" y="-15810.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer7_gpu10_expert_act&#45;&gt;layer7_gpu10_expert_mlp2 -->
<g id="edge807" class="edge">
<title>layer7_gpu10_expert_act&#45;&gt;layer7_gpu10_expert_mlp2</title>
<path fill="none" stroke="black" d="M7606.13,-15906.88C7611.33,-15898.33 7616.99,-15889.01 7622.43,-15880.07"/>
<polygon fill="black" stroke="black" points="7625.56,-15881.66 7627.76,-15871.3 7619.57,-15878.02 7625.56,-15881.66"/>
</g>
<!-- layer7_gpu10_token_send -->
<g id="node694" class="node">
<title>layer7_gpu10_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="7662" cy="-15718.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="7662" y="-15737.71" font-family="Times,serif" font-size="14.00">Token Send GPU10</text>
<text text-anchor="middle" x="7662" y="-15722.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="7662" y="-15707.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="7662" y="-15692.71" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer7_gpu10_expert_mlp2&#45;&gt;layer7_gpu10_token_send -->
<g id="edge808" class="edge">
<title>layer7_gpu10_expert_mlp2&#45;&gt;layer7_gpu10_token_send</title>
<path fill="none" stroke="black" d="M7652.01,-15802.73C7652.98,-15794.74 7654.03,-15785.97 7655.09,-15777.23"/>
<polygon fill="black" stroke="black" points="7658.6,-15777.37 7656.32,-15767.02 7651.65,-15776.53 7658.6,-15777.37"/>
</g>
<!-- layer7_gpu10_token_send&#45;&gt;layer7_expert_agg -->
<g id="edge809" class="edge">
<title>layer7_gpu10_token_send&#45;&gt;layer7_expert_agg</title>
<path fill="none" stroke="black" d="M7416.01,-15684.11C7376.58,-15679.27 7336.2,-15674.64 7298,-15670.83 6938.33,-15634.96 6527.75,-15607.23 6232.94,-15589.63"/>
<polygon fill="black" stroke="black" points="6233.13,-15586.13 6222.94,-15589.03 6232.72,-15593.12 6233.13,-15586.13"/>
</g>
<!-- layer7_gpu11_expert_mlp1 -->
<g id="node696" class="node">
<title>layer7_gpu11_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="8476.5,-16079 8015.5,-16079 8015.5,-16011 8476.5,-16011 8476.5,-16079"/>
<text text-anchor="middle" x="8246" y="-16063.8" font-family="Times,serif" font-size="14.00">Expert 11 MLP1</text>
<text text-anchor="middle" x="8246" y="-16048.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8246" y="-16033.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8246" y="-16018.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer7_gpu11_token_recv&#45;&gt;layer7_gpu11_expert_mlp1 -->
<g id="edge811" class="edge">
<title>layer7_gpu11_token_recv&#45;&gt;layer7_gpu11_expert_mlp1</title>
<path fill="none" stroke="black" d="M8234.13,-16114.87C8235.6,-16106.39 8237.11,-16097.59 8238.55,-16089.23"/>
<polygon fill="black" stroke="black" points="8242.01,-16089.75 8240.26,-16079.3 8235.11,-16088.56 8242.01,-16089.75"/>
</g>
<!-- layer7_gpu11_expert_act -->
<g id="node697" class="node">
<title>layer7_gpu11_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="8517.5,-15975 8140.5,-15975 8140.5,-15907 8517.5,-15907 8517.5,-15975"/>
<text text-anchor="middle" x="8329" y="-15959.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="8329" y="-15944.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8329" y="-15929.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8329" y="-15914.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer7_gpu11_expert_mlp1&#45;&gt;layer7_gpu11_expert_act -->
<g id="edge812" class="edge">
<title>layer7_gpu11_expert_mlp1&#45;&gt;layer7_gpu11_expert_act</title>
<path fill="none" stroke="black" d="M8272.95,-16010.88C8280.12,-16002.06 8287.96,-15992.43 8295.45,-15983.23"/>
<polygon fill="black" stroke="black" points="8298.31,-15985.26 8301.9,-15975.3 8292.88,-15980.84 8298.31,-15985.26"/>
</g>
<!-- layer7_gpu11_expert_mlp2 -->
<g id="node698" class="node">
<title>layer7_gpu11_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="8552.5,-15871 8145.5,-15871 8145.5,-15803 8552.5,-15803 8552.5,-15871"/>
<text text-anchor="middle" x="8349" y="-15855.8" font-family="Times,serif" font-size="14.00">Expert 11 MLP2</text>
<text text-anchor="middle" x="8349" y="-15840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8349" y="-15825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="8349" y="-15810.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer7_gpu11_expert_act&#45;&gt;layer7_gpu11_expert_mlp2 -->
<g id="edge813" class="edge">
<title>layer7_gpu11_expert_act&#45;&gt;layer7_gpu11_expert_mlp2</title>
<path fill="none" stroke="black" d="M8335.49,-15906.88C8337.1,-15898.69 8338.85,-15889.79 8340.53,-15881.19"/>
<polygon fill="black" stroke="black" points="8343.98,-15881.78 8342.47,-15871.3 8337.11,-15880.44 8343.98,-15881.78"/>
</g>
<!-- layer7_gpu11_token_send -->
<g id="node699" class="node">
<title>layer7_gpu11_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="8391" cy="-15718.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="8391" y="-15737.71" font-family="Times,serif" font-size="14.00">Token Send GPU11</text>
<text text-anchor="middle" x="8391" y="-15722.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="8391" y="-15707.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="8391" y="-15692.71" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer7_gpu11_expert_mlp2&#45;&gt;layer7_gpu11_token_send -->
<g id="edge814" class="edge">
<title>layer7_gpu11_expert_mlp2&#45;&gt;layer7_gpu11_token_send</title>
<path fill="none" stroke="black" d="M8361.04,-15802.73C8363.99,-15794.57 8367.24,-15785.59 8370.47,-15776.66"/>
<polygon fill="black" stroke="black" points="8373.84,-15777.62 8373.96,-15767.02 8367.26,-15775.24 8373.84,-15777.62"/>
</g>
<!-- layer7_gpu11_token_send&#45;&gt;layer7_expert_agg -->
<g id="edge815" class="edge">
<title>layer7_gpu11_token_send&#45;&gt;layer7_expert_agg</title>
<path fill="none" stroke="black" d="M8148.02,-15683.69C8107.66,-15678.8 8066.2,-15674.28 8027,-15670.83 7393.36,-15615.07 6653.93,-15588.25 6215.62,-15576.32"/>
<polygon fill="black" stroke="black" points="6215.42,-15572.81 6205.32,-15576.04 6215.23,-15579.81 6215.42,-15572.81"/>
</g>
<!-- layer7_gpu12_expert_mlp1 -->
<g id="node701" class="node">
<title>layer7_gpu12_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9195.5,-16079 8734.5,-16079 8734.5,-16011 9195.5,-16011 9195.5,-16079"/>
<text text-anchor="middle" x="8965" y="-16063.8" font-family="Times,serif" font-size="14.00">Expert 12 MLP1</text>
<text text-anchor="middle" x="8965" y="-16048.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8965" y="-16033.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8965" y="-16018.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer7_gpu12_token_recv&#45;&gt;layer7_gpu12_expert_mlp1 -->
<g id="edge817" class="edge">
<title>layer7_gpu12_token_recv&#45;&gt;layer7_gpu12_expert_mlp1</title>
<path fill="none" stroke="black" d="M8934.15,-16114.87C8938.03,-16106.2 8942.06,-16097.2 8945.88,-16088.68"/>
<polygon fill="black" stroke="black" points="8949.19,-16089.86 8950.08,-16079.3 8942.8,-16087 8949.19,-16089.86"/>
</g>
<!-- layer7_gpu12_expert_act -->
<g id="node702" class="node">
<title>layer7_gpu12_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9179.5,-15975 8802.5,-15975 8802.5,-15907 9179.5,-15907 9179.5,-15975"/>
<text text-anchor="middle" x="8991" y="-15959.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="8991" y="-15944.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8991" y="-15929.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8991" y="-15914.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer7_gpu12_expert_mlp1&#45;&gt;layer7_gpu12_expert_act -->
<g id="edge818" class="edge">
<title>layer7_gpu12_expert_mlp1&#45;&gt;layer7_gpu12_expert_act</title>
<path fill="none" stroke="black" d="M8973.44,-16010.88C8975.53,-16002.69 8977.8,-15993.79 8979.99,-15985.19"/>
<polygon fill="black" stroke="black" points="8983.43,-15985.85 8982.51,-15975.3 8976.65,-15984.12 8983.43,-15985.85"/>
</g>
<!-- layer7_gpu12_expert_mlp2 -->
<g id="node703" class="node">
<title>layer7_gpu12_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9298.5,-15871 8891.5,-15871 8891.5,-15803 9298.5,-15803 9298.5,-15871"/>
<text text-anchor="middle" x="9095" y="-15855.8" font-family="Times,serif" font-size="14.00">Expert 12 MLP2</text>
<text text-anchor="middle" x="9095" y="-15840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9095" y="-15825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9095" y="-15810.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer7_gpu12_expert_act&#45;&gt;layer7_gpu12_expert_mlp2 -->
<g id="edge819" class="edge">
<title>layer7_gpu12_expert_act&#45;&gt;layer7_gpu12_expert_mlp2</title>
<path fill="none" stroke="black" d="M9024.77,-15906.88C9034.03,-15897.8 9044.18,-15887.84 9053.81,-15878.4"/>
<polygon fill="black" stroke="black" points="9056.36,-15880.8 9061.05,-15871.3 9051.46,-15875.8 9056.36,-15880.8"/>
</g>
<!-- layer7_gpu12_token_send -->
<g id="node704" class="node">
<title>layer7_gpu12_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9120" cy="-15718.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9120" y="-15737.71" font-family="Times,serif" font-size="14.00">Token Send GPU12</text>
<text text-anchor="middle" x="9120" y="-15722.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9120" y="-15707.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9120" y="-15692.71" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer7_gpu12_expert_mlp2&#45;&gt;layer7_gpu12_token_send -->
<g id="edge820" class="edge">
<title>layer7_gpu12_expert_mlp2&#45;&gt;layer7_gpu12_token_send</title>
<path fill="none" stroke="black" d="M9102.16,-15802.73C9103.9,-15794.65 9105.81,-15785.78 9107.72,-15776.95"/>
<polygon fill="black" stroke="black" points="9111.17,-15777.54 9109.85,-15767.02 9104.33,-15776.06 9111.17,-15777.54"/>
</g>
<!-- layer7_gpu12_token_send&#45;&gt;layer7_expert_agg -->
<g id="edge821" class="edge">
<title>layer7_gpu12_token_send&#45;&gt;layer7_expert_agg</title>
<path fill="none" stroke="black" d="M8879.02,-15683.52C8838.04,-15678.6 8795.85,-15674.1 8756,-15670.83 7842.29,-15595.8 6763.5,-15575.37 6206.96,-15569.85"/>
<polygon fill="black" stroke="black" points="6206.8,-15566.34 6196.77,-15569.75 6206.73,-15573.34 6206.8,-15566.34"/>
</g>
<!-- layer7_gpu13_expert_mlp1 -->
<g id="node706" class="node">
<title>layer7_gpu13_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9861.5,-16079 9400.5,-16079 9400.5,-16011 9861.5,-16011 9861.5,-16079"/>
<text text-anchor="middle" x="9631" y="-16063.8" font-family="Times,serif" font-size="14.00">Expert 13 MLP1</text>
<text text-anchor="middle" x="9631" y="-16048.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9631" y="-16033.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9631" y="-16018.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer7_gpu13_token_recv&#45;&gt;layer7_gpu13_expert_mlp1 -->
<g id="edge823" class="edge">
<title>layer7_gpu13_token_recv&#45;&gt;layer7_gpu13_expert_mlp1</title>
<path fill="none" stroke="black" d="M9612.61,-16114.87C9614.87,-16106.39 9617.22,-16097.59 9619.46,-16089.23"/>
<polygon fill="black" stroke="black" points="9622.91,-16089.87 9622.11,-16079.3 9616.14,-16088.06 9622.91,-16089.87"/>
</g>
<!-- layer7_gpu13_expert_act -->
<g id="node707" class="node">
<title>layer7_gpu13_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9849.5,-15975 9472.5,-15975 9472.5,-15907 9849.5,-15907 9849.5,-15975"/>
<text text-anchor="middle" x="9661" y="-15959.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="9661" y="-15944.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9661" y="-15929.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9661" y="-15914.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer7_gpu13_expert_mlp1&#45;&gt;layer7_gpu13_expert_act -->
<g id="edge824" class="edge">
<title>layer7_gpu13_expert_mlp1&#45;&gt;layer7_gpu13_expert_act</title>
<path fill="none" stroke="black" d="M9640.74,-16010.88C9643.18,-16002.6 9645.82,-15993.59 9648.38,-15984.91"/>
<polygon fill="black" stroke="black" points="9651.74,-15985.88 9651.21,-15975.3 9645.03,-15983.9 9651.74,-15985.88"/>
</g>
<!-- layer7_gpu13_expert_mlp2 -->
<g id="node708" class="node">
<title>layer7_gpu13_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9989.5,-15871 9582.5,-15871 9582.5,-15803 9989.5,-15803 9989.5,-15871"/>
<text text-anchor="middle" x="9786" y="-15855.8" font-family="Times,serif" font-size="14.00">Expert 13 MLP2</text>
<text text-anchor="middle" x="9786" y="-15840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9786" y="-15825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9786" y="-15810.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer7_gpu13_expert_act&#45;&gt;layer7_gpu13_expert_mlp2 -->
<g id="edge825" class="edge">
<title>layer7_gpu13_expert_act&#45;&gt;layer7_gpu13_expert_mlp2</title>
<path fill="none" stroke="black" d="M9701.58,-15906.88C9712.94,-15897.62 9725.39,-15887.45 9737.17,-15877.84"/>
<polygon fill="black" stroke="black" points="9739.66,-15880.33 9745.19,-15871.3 9735.23,-15874.91 9739.66,-15880.33"/>
</g>
<!-- layer7_gpu13_token_send -->
<g id="node709" class="node">
<title>layer7_gpu13_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9849" cy="-15718.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9849" y="-15737.71" font-family="Times,serif" font-size="14.00">Token Send GPU13</text>
<text text-anchor="middle" x="9849" y="-15722.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9849" y="-15707.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9849" y="-15692.71" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer7_gpu13_expert_mlp2&#45;&gt;layer7_gpu13_token_send -->
<g id="edge826" class="edge">
<title>layer7_gpu13_expert_mlp2&#45;&gt;layer7_gpu13_token_send</title>
<path fill="none" stroke="black" d="M9804.05,-15802.73C9808.58,-15794.39 9813.56,-15785.21 9818.51,-15776.09"/>
<polygon fill="black" stroke="black" points="9821.74,-15777.48 9823.43,-15767.02 9815.59,-15774.14 9821.74,-15777.48"/>
</g>
<!-- layer7_gpu13_token_send&#45;&gt;layer7_expert_agg -->
<g id="edge827" class="edge">
<title>layer7_gpu13_token_send&#45;&gt;layer7_expert_agg</title>
<path fill="none" stroke="black" d="M9609.01,-15683.4C9567.72,-15678.46 9525.18,-15673.99 9485,-15670.83 8858.52,-15621.6 7013.91,-15586.87 6212.22,-15573.69"/>
<polygon fill="black" stroke="black" points="6212.01,-15570.19 6201.95,-15573.52 6211.89,-15577.19 6212.01,-15570.19"/>
</g>
<!-- layer7_gpu14_expert_mlp1 -->
<g id="node711" class="node">
<title>layer7_gpu14_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="10625.5,-16079 10164.5,-16079 10164.5,-16011 10625.5,-16011 10625.5,-16079"/>
<text text-anchor="middle" x="10395" y="-16063.8" font-family="Times,serif" font-size="14.00">Expert 14 MLP1</text>
<text text-anchor="middle" x="10395" y="-16048.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10395" y="-16033.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10395" y="-16018.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer7_gpu14_token_recv&#45;&gt;layer7_gpu14_expert_mlp1 -->
<g id="edge829" class="edge">
<title>layer7_gpu14_token_recv&#45;&gt;layer7_gpu14_expert_mlp1</title>
<path fill="none" stroke="black" d="M10330.62,-16115.2C10339.4,-16105.76 10348.56,-16095.91 10357.13,-16086.71"/>
<polygon fill="black" stroke="black" points="10359.91,-16088.85 10364.16,-16079.15 10354.79,-16084.08 10359.91,-16088.85"/>
</g>
<!-- layer7_gpu14_expert_act -->
<g id="node712" class="node">
<title>layer7_gpu14_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="10764.5,-15975 10387.5,-15975 10387.5,-15907 10764.5,-15907 10764.5,-15975"/>
<text text-anchor="middle" x="10576" y="-15959.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="10576" y="-15944.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10576" y="-15929.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10576" y="-15914.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer7_gpu14_expert_mlp1&#45;&gt;layer7_gpu14_expert_act -->
<g id="edge830" class="edge">
<title>layer7_gpu14_expert_mlp1&#45;&gt;layer7_gpu14_expert_act</title>
<path fill="none" stroke="black" d="M10453.77,-16010.88C10471.08,-16001.12 10490.17,-15990.36 10508.02,-15980.31"/>
<polygon fill="black" stroke="black" points="10510.23,-15983.08 10517.22,-15975.12 10506.79,-15976.98 10510.23,-15983.08"/>
</g>
<!-- layer7_gpu14_expert_mlp2 -->
<g id="node713" class="node">
<title>layer7_gpu14_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10779.5,-15871 10372.5,-15871 10372.5,-15803 10779.5,-15803 10779.5,-15871"/>
<text text-anchor="middle" x="10576" y="-15855.8" font-family="Times,serif" font-size="14.00">Expert 14 MLP2</text>
<text text-anchor="middle" x="10576" y="-15840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10576" y="-15825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="10576" y="-15810.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer7_gpu14_expert_act&#45;&gt;layer7_gpu14_expert_mlp2 -->
<g id="edge831" class="edge">
<title>layer7_gpu14_expert_act&#45;&gt;layer7_gpu14_expert_mlp2</title>
<path fill="none" stroke="black" d="M10576,-15906.88C10576,-15898.78 10576,-15889.98 10576,-15881.47"/>
<polygon fill="black" stroke="black" points="10579.5,-15881.3 10576,-15871.3 10572.5,-15881.3 10579.5,-15881.3"/>
</g>
<!-- layer7_gpu14_token_send -->
<g id="node714" class="node">
<title>layer7_gpu14_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="10578" cy="-15718.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="10578" y="-15737.71" font-family="Times,serif" font-size="14.00">Token Send GPU14</text>
<text text-anchor="middle" x="10578" y="-15722.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="10578" y="-15707.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="10578" y="-15692.71" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer7_gpu14_expert_mlp2&#45;&gt;layer7_gpu14_token_send -->
<g id="edge832" class="edge">
<title>layer7_gpu14_expert_mlp2&#45;&gt;layer7_gpu14_token_send</title>
<path fill="none" stroke="black" d="M10576.57,-15802.73C10576.71,-15794.74 10576.86,-15785.97 10577.01,-15777.23"/>
<polygon fill="black" stroke="black" points="10580.52,-15777.08 10577.19,-15767.02 10573.52,-15776.96 10580.52,-15777.08"/>
</g>
<!-- layer7_gpu14_token_send&#45;&gt;layer7_expert_agg -->
<g id="edge833" class="edge">
<title>layer7_gpu14_token_send&#45;&gt;layer7_expert_agg</title>
<path fill="none" stroke="black" d="M10338.52,-15683.3C10297.07,-15678.35 10254.35,-15673.91 10214,-15670.83 9441.05,-15611.92 7122.63,-15581.53 6208.99,-15571.59"/>
<polygon fill="black" stroke="black" points="6209.01,-15568.09 6198.97,-15571.48 6208.93,-15575.09 6209.01,-15568.09"/>
</g>
<!-- layer7_gpu15_expert_mlp1 -->
<g id="node716" class="node">
<title>layer7_gpu15_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="11208.5,-16079 10747.5,-16079 10747.5,-16011 11208.5,-16011 11208.5,-16079"/>
<text text-anchor="middle" x="10978" y="-16063.8" font-family="Times,serif" font-size="14.00">Expert 15 MLP1</text>
<text text-anchor="middle" x="10978" y="-16048.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10978" y="-16033.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10978" y="-16018.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer7_gpu15_token_recv&#45;&gt;layer7_gpu15_expert_mlp1 -->
<g id="edge835" class="edge">
<title>layer7_gpu15_token_recv&#45;&gt;layer7_gpu15_expert_mlp1</title>
<path fill="none" stroke="black" d="M10975.63,-16114.87C10975.92,-16106.48 10976.22,-16097.78 10976.5,-16089.5"/>
<polygon fill="black" stroke="black" points="10980.01,-16089.42 10976.85,-16079.3 10973.01,-16089.17 10980.01,-16089.42"/>
</g>
<!-- layer7_gpu15_expert_act -->
<g id="node717" class="node">
<title>layer7_gpu15_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="11174.5,-15975 10797.5,-15975 10797.5,-15907 11174.5,-15907 11174.5,-15975"/>
<text text-anchor="middle" x="10986" y="-15959.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="10986" y="-15944.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10986" y="-15929.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10986" y="-15914.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer7_gpu15_expert_mlp1&#45;&gt;layer7_gpu15_expert_act -->
<g id="edge836" class="edge">
<title>layer7_gpu15_expert_mlp1&#45;&gt;layer7_gpu15_expert_act</title>
<path fill="none" stroke="black" d="M10980.6,-16010.88C10981.23,-16002.78 10981.92,-15993.98 10982.59,-15985.47"/>
<polygon fill="black" stroke="black" points="10986.1,-15985.54 10983.39,-15975.3 10979.12,-15984.99 10986.1,-15985.54"/>
</g>
<!-- layer7_gpu15_expert_mlp2 -->
<g id="node718" class="node">
<title>layer7_gpu15_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="11364.5,-15871 10957.5,-15871 10957.5,-15803 11364.5,-15803 11364.5,-15871"/>
<text text-anchor="middle" x="11161" y="-15855.8" font-family="Times,serif" font-size="14.00">Expert 15 MLP2</text>
<text text-anchor="middle" x="11161" y="-15840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11161" y="-15825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="11161" y="-15810.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer7_gpu15_expert_act&#45;&gt;layer7_gpu15_expert_mlp2 -->
<g id="edge837" class="edge">
<title>layer7_gpu15_expert_act&#45;&gt;layer7_gpu15_expert_mlp2</title>
<path fill="none" stroke="black" d="M11042.82,-15906.88C11059.56,-15897.12 11078.02,-15886.36 11095.27,-15876.31"/>
<polygon fill="black" stroke="black" points="11097.29,-15879.18 11104.17,-15871.12 11093.77,-15873.13 11097.29,-15879.18"/>
</g>
<!-- layer7_gpu15_token_send -->
<g id="node719" class="node">
<title>layer7_gpu15_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="11307" cy="-15718.91" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="11307" y="-15737.71" font-family="Times,serif" font-size="14.00">Token Send GPU15</text>
<text text-anchor="middle" x="11307" y="-15722.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="11307" y="-15707.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="11307" y="-15692.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer7_gpu15_expert_mlp2&#45;&gt;layer7_gpu15_token_send -->
<g id="edge838" class="edge">
<title>layer7_gpu15_expert_mlp2&#45;&gt;layer7_gpu15_token_send</title>
<path fill="none" stroke="black" d="M11202.84,-15802.73C11214.63,-15793.36 11227.76,-15782.92 11240.61,-15772.7"/>
<polygon fill="black" stroke="black" points="11242.92,-15775.34 11248.56,-15766.38 11238.56,-15769.86 11242.92,-15775.34"/>
</g>
<!-- layer7_gpu15_token_send&#45;&gt;layer7_expert_agg -->
<g id="edge839" class="edge">
<title>layer7_gpu15_token_send&#45;&gt;layer7_expert_agg</title>
<path fill="none" stroke="black" d="M11068.01,-15683.24C11026.42,-15678.29 10983.51,-15673.85 10943,-15670.83 10022.59,-15602.23 7223.67,-15577.11 6207.06,-15570.1"/>
<polygon fill="black" stroke="black" points="6207.06,-15566.6 6197.04,-15570.03 6207.01,-15573.6 6207.06,-15566.6"/>
</g>
<!-- layer7_residual2 -->
<g id="node721" class="node">
<title>layer7_residual2</title>
<polygon fill="lightyellow" stroke="black" points="6275.89,-15462.83 5571.35,-15462.83 5390.11,-15326.83 6094.65,-15326.83 6275.89,-15462.83"/>
<text text-anchor="middle" x="5833" y="-15413.63" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="5833" y="-15398.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5833" y="-15383.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5833" y="-15368.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer7_expert_agg&#45;&gt;layer7_residual2 -->
<g id="edge840" class="edge">
<title>layer7_expert_agg&#45;&gt;layer7_residual2</title>
<path fill="none" stroke="black" d="M5833,-15498.64C5833,-15490.33 5833,-15481.78 5833,-15473.33"/>
<polygon fill="black" stroke="black" points="5836.5,-15473.09 5833,-15463.09 5829.5,-15473.09 5836.5,-15473.09"/>
</g>
<!-- layer8_layernorm -->
<g id="node722" class="node">
<title>layer8_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="6036.5,-15279.83 5629.5,-15279.83 5629.5,-15211.83 6036.5,-15211.83 6036.5,-15279.83"/>
<text text-anchor="middle" x="5833" y="-15264.63" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5833" y="-15249.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5833" y="-15234.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5833" y="-15219.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer7_residual2&#45;&gt;layer8_layernorm -->
<g id="edge841" class="edge">
<title>layer7_residual2&#45;&gt;layer8_layernorm</title>
<path fill="none" stroke="black" d="M5833,-15326.78C5833,-15314.38 5833,-15301.72 5833,-15290.25"/>
<polygon fill="black" stroke="black" points="5836.5,-15290.09 5833,-15280.09 5829.5,-15290.09 5836.5,-15290.09"/>
</g>
<!-- layer8_qkv_proj -->
<g id="node723" class="node">
<title>layer8_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="6090.5,-15175.83 5575.5,-15175.83 5575.5,-15107.83 6090.5,-15107.83 6090.5,-15175.83"/>
<text text-anchor="middle" x="5833" y="-15160.63" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5833" y="-15145.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5833" y="-15130.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5833" y="-15115.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer8_layernorm&#45;&gt;layer8_qkv_proj -->
<g id="edge842" class="edge">
<title>layer8_layernorm&#45;&gt;layer8_qkv_proj</title>
<path fill="none" stroke="black" d="M5833,-15211.71C5833,-15203.61 5833,-15194.81 5833,-15186.3"/>
<polygon fill="black" stroke="black" points="5836.5,-15186.13 5833,-15176.13 5829.5,-15186.13 5836.5,-15186.13"/>
</g>
<!-- layer8_attention -->
<g id="node724" class="node">
<title>layer8_attention</title>
<polygon fill="lightgreen" stroke="black" points="6084.5,-15071.83 5581.5,-15071.83 5581.5,-15003.83 6084.5,-15003.83 6084.5,-15071.83"/>
<text text-anchor="middle" x="5833" y="-15056.63" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5833" y="-15041.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5833" y="-15026.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5833" y="-15011.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer8_qkv_proj&#45;&gt;layer8_attention -->
<g id="edge843" class="edge">
<title>layer8_qkv_proj&#45;&gt;layer8_attention</title>
<path fill="none" stroke="black" d="M5833,-15107.71C5833,-15099.61 5833,-15090.81 5833,-15082.3"/>
<polygon fill="black" stroke="black" points="5836.5,-15082.13 5833,-15072.13 5829.5,-15082.13 5836.5,-15082.13"/>
</g>
<!-- layer8_attn_out -->
<g id="node725" class="node">
<title>layer8_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="6071.5,-14967.83 5594.5,-14967.83 5594.5,-14899.83 6071.5,-14899.83 6071.5,-14967.83"/>
<text text-anchor="middle" x="5833" y="-14952.63" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5833" y="-14937.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5833" y="-14922.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5833" y="-14907.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer8_attention&#45;&gt;layer8_attn_out -->
<g id="edge844" class="edge">
<title>layer8_attention&#45;&gt;layer8_attn_out</title>
<path fill="none" stroke="black" d="M5833,-15003.71C5833,-14995.61 5833,-14986.81 5833,-14978.3"/>
<polygon fill="black" stroke="black" points="5836.5,-14978.13 5833,-14968.13 5829.5,-14978.13 5836.5,-14978.13"/>
</g>
<!-- layer8_residual1 -->
<g id="node726" class="node">
<title>layer8_residual1</title>
<polygon fill="lightyellow" stroke="black" points="6275.89,-14863.83 5571.35,-14863.83 5390.11,-14727.83 6094.65,-14727.83 6275.89,-14863.83"/>
<text text-anchor="middle" x="5833" y="-14814.63" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5833" y="-14799.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5833" y="-14784.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5833" y="-14769.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer8_attn_out&#45;&gt;layer8_residual1 -->
<g id="edge845" class="edge">
<title>layer8_attn_out&#45;&gt;layer8_residual1</title>
<path fill="none" stroke="black" d="M5833,-14899.56C5833,-14891.73 5833,-14883.07 5833,-14874.18"/>
<polygon fill="black" stroke="black" points="5836.5,-14874.09 5833,-14864.09 5829.5,-14874.09 5836.5,-14874.09"/>
</g>
<!-- layer8_layernorm2 -->
<g id="node727" class="node">
<title>layer8_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="6036.5,-14691.83 5629.5,-14691.83 5629.5,-14623.83 6036.5,-14623.83 6036.5,-14691.83"/>
<text text-anchor="middle" x="5833" y="-14676.63" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5833" y="-14661.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5833" y="-14646.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5833" y="-14631.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer8_residual1&#45;&gt;layer8_layernorm2 -->
<g id="edge846" class="edge">
<title>layer8_residual1&#45;&gt;layer8_layernorm2</title>
<path fill="none" stroke="black" d="M5833,-14727.63C5833,-14718.88 5833,-14710.11 5833,-14701.9"/>
<polygon fill="black" stroke="black" points="5836.5,-14701.85 5833,-14691.85 5829.5,-14701.85 5836.5,-14701.85"/>
</g>
<!-- layer8_global_gate -->
<g id="node728" class="node">
<title>layer8_global_gate</title>
<polygon fill="lightgreen" stroke="black" points="6030.5,-14587.83 5635.5,-14587.83 5635.5,-14519.83 6030.5,-14519.83 6030.5,-14587.83"/>
<text text-anchor="middle" x="5833" y="-14572.63" font-family="Times,serif" font-size="14.00">Global Gate</text>
<text text-anchor="middle" x="5833" y="-14557.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5833" y="-14542.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, experts=64]</text>
<text text-anchor="middle" x="5833" y="-14527.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer8_layernorm2&#45;&gt;layer8_global_gate -->
<g id="edge847" class="edge">
<title>layer8_layernorm2&#45;&gt;layer8_global_gate</title>
<path fill="none" stroke="black" d="M5833,-14623.71C5833,-14615.61 5833,-14606.81 5833,-14598.3"/>
<polygon fill="black" stroke="black" points="5836.5,-14598.13 5833,-14588.13 5829.5,-14598.13 5836.5,-14598.13"/>
</g>
<!-- layer8_routing -->
<g id="node729" class="node">
<title>layer8_routing</title>
<polygon fill="lightyellow" stroke="black" points="6319.47,-14483.83 5545.6,-14483.83 5346.53,-14347.83 6120.4,-14347.83 6319.47,-14483.83"/>
<text text-anchor="middle" x="5833" y="-14434.63" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="5833" y="-14419.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5833" y="-14404.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5833" y="-14389.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer8_global_gate&#45;&gt;layer8_routing -->
<g id="edge848" class="edge">
<title>layer8_global_gate&#45;&gt;layer8_routing</title>
<path fill="none" stroke="black" d="M5833,-14519.56C5833,-14511.73 5833,-14503.07 5833,-14494.18"/>
<polygon fill="black" stroke="black" points="5836.5,-14494.09 5833,-14484.09 5829.5,-14494.09 5836.5,-14494.09"/>
</g>
<!-- layer8_gpu0_token_recv -->
<g id="node730" class="node">
<title>layer8_gpu0_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="451" cy="-14263.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="451" y="-14282.55" font-family="Times,serif" font-size="14.00">Token Receive GPU0</text>
<text text-anchor="middle" x="451" y="-14267.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="451" y="-14252.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="451" y="-14237.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer8_routing&#45;&gt;layer8_gpu0_token_recv -->
<g id="edge849" class="edge">
<title>layer8_routing&#45;&gt;layer8_gpu0_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5439.39,-14411.49C4426.2,-14402.12 1745.76,-14372.24 858,-14311.83 808.35,-14308.45 755.44,-14303.4 704.76,-14297.85"/>
<polygon fill="black" stroke="black" points="704.98,-14294.35 694.66,-14296.73 704.21,-14301.31 704.98,-14294.35"/>
</g>
<!-- layer8_gpu1_token_recv -->
<g id="node735" class="node">
<title>layer8_gpu1_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1201" cy="-14263.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1201" y="-14282.55" font-family="Times,serif" font-size="14.00">Token Receive GPU1</text>
<text text-anchor="middle" x="1201" y="-14267.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1201" y="-14252.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1201" y="-14237.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer8_routing&#45;&gt;layer8_gpu1_token_recv -->
<g id="edge855" class="edge">
<title>layer8_routing&#45;&gt;layer8_gpu1_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5437.75,-14410.36C4530.32,-14399.27 2318.87,-14367.31 1576,-14311.83 1533.96,-14308.69 1489.41,-14304.16 1446.24,-14299.14"/>
<polygon fill="black" stroke="black" points="1446.52,-14295.65 1436.18,-14297.96 1445.71,-14302.6 1446.52,-14295.65"/>
</g>
<!-- layer8_gpu2_token_recv -->
<g id="node740" class="node">
<title>layer8_gpu2_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1919" cy="-14263.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1919" y="-14282.55" font-family="Times,serif" font-size="14.00">Token Receive GPU2</text>
<text text-anchor="middle" x="1919" y="-14267.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1919" y="-14252.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1919" y="-14237.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer8_routing&#45;&gt;layer8_gpu2_token_recv -->
<g id="edge861" class="edge">
<title>layer8_routing&#45;&gt;layer8_gpu2_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5434.78,-14408.37C4639.9,-14394.63 2881.15,-14359.81 2279,-14311.83 2240.63,-14308.77 2200.07,-14304.49 2160.56,-14299.75"/>
<polygon fill="black" stroke="black" points="2160.89,-14296.27 2150.54,-14298.54 2160.05,-14303.22 2160.89,-14296.27"/>
</g>
<!-- layer8_gpu3_token_recv -->
<g id="node745" class="node">
<title>layer8_gpu3_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="2622" cy="-14263.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2622" y="-14282.55" font-family="Times,serif" font-size="14.00">Token Receive GPU3</text>
<text text-anchor="middle" x="2622" y="-14267.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="2622" y="-14252.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2622" y="-14237.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer8_routing&#45;&gt;layer8_gpu3_token_recv -->
<g id="edge867" class="edge">
<title>layer8_routing&#45;&gt;layer8_gpu3_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5441.36,-14412.67C4890.09,-14406.91 3854.24,-14386.14 2975,-14311.83 2938.38,-14308.74 2899.74,-14304.54 2861.98,-14299.92"/>
<polygon fill="black" stroke="black" points="2862.24,-14296.43 2851.88,-14298.67 2861.38,-14303.37 2862.24,-14296.43"/>
</g>
<!-- layer8_gpu4_token_recv -->
<g id="node750" class="node">
<title>layer8_gpu4_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="3318" cy="-14263.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="3318" y="-14282.55" font-family="Times,serif" font-size="14.00">Token Receive GPU4</text>
<text text-anchor="middle" x="3318" y="-14267.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="3318" y="-14252.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3318" y="-14237.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer8_routing&#45;&gt;layer8_gpu4_token_recv -->
<g id="edge873" class="edge">
<title>layer8_routing&#45;&gt;layer8_gpu4_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5426.89,-14402.98C5002.01,-14388.72 4315.9,-14360.39 3725,-14311.83 3676.75,-14307.87 3625.39,-14302.68 3575.98,-14297.21"/>
<polygon fill="black" stroke="black" points="3576.12,-14293.7 3565.8,-14296.07 3575.35,-14300.66 3576.12,-14293.7"/>
</g>
<!-- layer8_gpu5_token_recv -->
<g id="node755" class="node">
<title>layer8_gpu5_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4068" cy="-14263.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4068" y="-14282.55" font-family="Times,serif" font-size="14.00">Token Receive GPU5</text>
<text text-anchor="middle" x="4068" y="-14267.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4068" y="-14252.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4068" y="-14237.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer8_routing&#45;&gt;layer8_gpu5_token_recv -->
<g id="edge879" class="edge">
<title>layer8_routing&#45;&gt;layer8_gpu5_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5406.21,-14388.78C5131.2,-14370.62 4766.13,-14343.92 4444,-14311.83 4404.01,-14307.85 4361.69,-14303.08 4320.44,-14298.14"/>
<polygon fill="black" stroke="black" points="4320.61,-14294.63 4310.26,-14296.91 4319.77,-14301.58 4320.61,-14294.63"/>
</g>
<!-- layer8_gpu6_token_recv -->
<g id="node760" class="node">
<title>layer8_gpu6_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4787" cy="-14263.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4787" y="-14282.55" font-family="Times,serif" font-size="14.00">Token Receive GPU6</text>
<text text-anchor="middle" x="4787" y="-14267.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4787" y="-14252.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4787" y="-14237.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer8_routing&#45;&gt;layer8_gpu6_token_recv -->
<g id="edge885" class="edge">
<title>layer8_routing&#45;&gt;layer8_gpu6_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5365.83,-14347.8C5250.06,-14331.19 5130.6,-14314.05 5030.49,-14299.68"/>
<polygon fill="black" stroke="black" points="5030.95,-14296.21 5020.55,-14298.26 5029.95,-14303.14 5030.95,-14296.21"/>
</g>
<!-- layer8_gpu7_token_recv -->
<g id="node765" class="node">
<title>layer8_gpu7_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="5490" cy="-14263.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="5490" y="-14282.55" font-family="Times,serif" font-size="14.00">Token Receive GPU7</text>
<text text-anchor="middle" x="5490" y="-14267.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5490" y="-14252.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5490" y="-14237.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer8_routing&#45;&gt;layer8_gpu7_token_recv -->
<g id="edge891" class="edge">
<title>layer8_routing&#45;&gt;layer8_gpu7_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5679.56,-14347.69C5653.46,-14336.27 5626.8,-14324.61 5602.03,-14313.77"/>
<polygon fill="black" stroke="black" points="5603.2,-14310.46 5592.63,-14309.66 5600.39,-14316.87 5603.2,-14310.46"/>
</g>
<!-- layer8_gpu8_token_recv -->
<g id="node770" class="node">
<title>layer8_gpu8_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6177" cy="-14263.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6177" y="-14282.55" font-family="Times,serif" font-size="14.00">Token Receive GPU8</text>
<text text-anchor="middle" x="6177" y="-14267.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6177" y="-14252.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6177" y="-14237.55" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_routing&#45;&gt;layer8_gpu8_token_recv -->
<g id="edge897" class="edge">
<title>layer8_routing&#45;&gt;layer8_gpu8_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5986.64,-14347.8C6012.83,-14336.37 6039.6,-14324.69 6064.48,-14313.84"/>
<polygon fill="black" stroke="black" points="6066.15,-14316.93 6073.91,-14309.72 6063.35,-14310.52 6066.15,-14316.93"/>
</g>
<!-- layer8_gpu9_token_recv -->
<g id="node775" class="node">
<title>layer8_gpu9_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6864" cy="-14263.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6864" y="-14282.55" font-family="Times,serif" font-size="14.00">Token Receive GPU9</text>
<text text-anchor="middle" x="6864" y="-14267.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6864" y="-14252.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6864" y="-14237.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer8_routing&#45;&gt;layer8_gpu9_token_recv -->
<g id="edge903" class="edge">
<title>layer8_routing&#45;&gt;layer8_gpu9_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6151.1,-14368.53C6302.9,-14346.43 6481.6,-14320.41 6622.11,-14299.96"/>
<polygon fill="black" stroke="black" points="6622.77,-14303.4 6632.16,-14298.5 6621.76,-14296.47 6622.77,-14303.4"/>
</g>
<!-- layer8_gpu10_token_recv -->
<g id="node780" class="node">
<title>layer8_gpu10_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="7551" cy="-14263.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="7551" y="-14282.55" font-family="Times,serif" font-size="14.00">Token Receive GPU10</text>
<text text-anchor="middle" x="7551" y="-14267.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="7551" y="-14252.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7551" y="-14237.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer8_routing&#45;&gt;layer8_gpu10_token_recv -->
<g id="edge909" class="edge">
<title>layer8_routing&#45;&gt;layer8_gpu10_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6188.32,-14394.18C6466.06,-14376.6 6861.62,-14348.38 7207,-14311.83 7240.01,-14308.34 7274.73,-14304.17 7308.91,-14299.78"/>
<polygon fill="black" stroke="black" points="7309.54,-14303.22 7319.01,-14298.47 7308.64,-14296.28 7309.54,-14303.22"/>
</g>
<!-- layer8_gpu11_token_recv -->
<g id="node785" class="node">
<title>layer8_gpu11_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8238" cy="-14263.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8238" y="-14282.55" font-family="Times,serif" font-size="14.00">Token Receive GPU11</text>
<text text-anchor="middle" x="8238" y="-14267.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8238" y="-14252.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8238" y="-14237.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer8_routing&#45;&gt;layer8_gpu11_token_recv -->
<g id="edge915" class="edge">
<title>layer8_routing&#45;&gt;layer8_gpu11_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6205.54,-14405.86C6618.86,-14393.66 7305.2,-14366.74 7894,-14311.83 7928.15,-14308.65 7964.11,-14304.55 7999.4,-14300.11"/>
<polygon fill="black" stroke="black" points="7999.85,-14303.58 8009.33,-14298.85 7998.97,-14296.63 7999.85,-14303.58"/>
</g>
<!-- layer8_gpu12_token_recv -->
<g id="node790" class="node">
<title>layer8_gpu12_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8925" cy="-14263.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8925" y="-14282.55" font-family="Times,serif" font-size="14.00">Token Receive GPU12</text>
<text text-anchor="middle" x="8925" y="-14267.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8925" y="-14252.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8925" y="-14237.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer8_routing&#45;&gt;layer8_gpu12_token_recv -->
<g id="edge921" class="edge">
<title>layer8_routing&#45;&gt;layer8_gpu12_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6214.93,-14412.39C6746.36,-14406.28 7738.55,-14385.09 8581,-14311.83 8615.58,-14308.82 8652.01,-14304.79 8687.71,-14300.34"/>
<polygon fill="black" stroke="black" points="8688.27,-14303.79 8697.76,-14299.07 8687.4,-14296.85 8688.27,-14303.79"/>
</g>
<!-- layer8_gpu13_token_recv -->
<g id="node795" class="node">
<title>layer8_gpu13_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="9612" cy="-14263.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="9612" y="-14282.55" font-family="Times,serif" font-size="14.00">Token Receive GPU13</text>
<text text-anchor="middle" x="9612" y="-14267.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="9612" y="-14252.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9612" y="-14237.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer8_routing&#45;&gt;layer8_gpu13_token_recv -->
<g id="edge927" class="edge">
<title>layer8_routing&#45;&gt;layer8_gpu13_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6209.48,-14408.59C6973.72,-14395.08 8684.02,-14360.41 9268,-14311.83 9302.87,-14308.93 9339.61,-14304.92 9375.58,-14300.46"/>
<polygon fill="black" stroke="black" points="9376.22,-14303.91 9385.7,-14299.19 9375.34,-14296.97 9376.22,-14303.91"/>
</g>
<!-- layer8_gpu14_token_recv -->
<g id="node800" class="node">
<title>layer8_gpu14_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10314" cy="-14263.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10314" y="-14282.55" font-family="Times,serif" font-size="14.00">Token Receive GPU14</text>
<text text-anchor="middle" x="10314" y="-14267.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10314" y="-14252.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10314" y="-14237.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer8_routing&#45;&gt;layer8_gpu14_token_recv -->
<g id="edge933" class="edge">
<title>layer8_routing&#45;&gt;layer8_gpu14_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6212.47,-14410.47C7089.12,-14399.57 9234.95,-14367.89 9955,-14311.83 9993.42,-14308.84 10034.03,-14304.58 10073.57,-14299.83"/>
<polygon fill="black" stroke="black" points="10074.09,-14303.3 10083.6,-14298.62 10073.25,-14296.35 10074.09,-14303.3"/>
</g>
<!-- layer8_gpu15_token_recv -->
<g id="node805" class="node">
<title>layer8_gpu15_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="11009" cy="-14263.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="11009" y="-14282.55" font-family="Times,serif" font-size="14.00">Token Receive GPU15</text>
<text text-anchor="middle" x="11009" y="-14267.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="11009" y="-14252.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="11009" y="-14237.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer8_routing&#45;&gt;layer8_gpu15_token_recv -->
<g id="edge939" class="edge">
<title>layer8_routing&#45;&gt;layer8_gpu15_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6214.73,-14412.19C7197.32,-14404.51 9796.75,-14378.34 10657,-14311.83 10693.96,-14308.97 10732.98,-14304.86 10771.05,-14300.24"/>
<polygon fill="black" stroke="black" points="10771.73,-14303.68 10781.23,-14298.99 10770.87,-14296.74 10771.73,-14303.68"/>
</g>
<!-- layer8_gpu0_expert_mlp1 -->
<g id="node731" class="node">
<title>layer8_gpu0_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="673.5,-14179.66 212.5,-14179.66 212.5,-14111.66 673.5,-14111.66 673.5,-14179.66"/>
<text text-anchor="middle" x="443" y="-14164.46" font-family="Times,serif" font-size="14.00">Expert 0 MLP1</text>
<text text-anchor="middle" x="443" y="-14149.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="443" y="-14134.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="443" y="-14119.46" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer8_gpu0_token_recv&#45;&gt;layer8_gpu0_expert_mlp1 -->
<g id="edge850" class="edge">
<title>layer8_gpu0_token_recv&#45;&gt;layer8_gpu0_expert_mlp1</title>
<path fill="none" stroke="black" d="M447.75,-14215.53C447.17,-14207.15 446.57,-14198.45 446,-14190.17"/>
<polygon fill="black" stroke="black" points="449.47,-14189.7 445.3,-14179.97 442.49,-14190.19 449.47,-14189.7"/>
</g>
<!-- layer8_gpu0_expert_act -->
<g id="node732" class="node">
<title>layer8_gpu0_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="613.5,-14075.66 236.5,-14075.66 236.5,-14007.66 613.5,-14007.66 613.5,-14075.66"/>
<text text-anchor="middle" x="425" y="-14060.46" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="425" y="-14045.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="425" y="-14030.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="425" y="-14015.46" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer8_gpu0_expert_mlp1&#45;&gt;layer8_gpu0_expert_act -->
<g id="edge851" class="edge">
<title>layer8_gpu0_expert_mlp1&#45;&gt;layer8_gpu0_expert_act</title>
<path fill="none" stroke="black" d="M437.16,-14111.55C435.71,-14103.35 434.14,-14094.45 432.62,-14085.86"/>
<polygon fill="black" stroke="black" points="436.06,-14085.2 430.88,-14075.96 429.17,-14086.42 436.06,-14085.2"/>
</g>
<!-- layer8_gpu0_expert_mlp2 -->
<g id="node733" class="node">
<title>layer8_gpu0_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="603.5,-13971.66 196.5,-13971.66 196.5,-13903.66 603.5,-13903.66 603.5,-13971.66"/>
<text text-anchor="middle" x="400" y="-13956.46" font-family="Times,serif" font-size="14.00">Expert 0 MLP2</text>
<text text-anchor="middle" x="400" y="-13941.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="400" y="-13926.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="400" y="-13911.46" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer8_gpu0_expert_act&#45;&gt;layer8_gpu0_expert_mlp2 -->
<g id="edge852" class="edge">
<title>layer8_gpu0_expert_act&#45;&gt;layer8_gpu0_expert_mlp2</title>
<path fill="none" stroke="black" d="M416.88,-14007.55C414.87,-13999.35 412.69,-13990.45 410.59,-13981.86"/>
<polygon fill="black" stroke="black" points="413.94,-13980.84 408.16,-13971.96 407.14,-13982.51 413.94,-13980.84"/>
</g>
<!-- layer8_gpu0_token_send -->
<g id="node734" class="node">
<title>layer8_gpu0_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="375" cy="-13819.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="375" y="-13838.38" font-family="Times,serif" font-size="14.00">Token Send GPU0</text>
<text text-anchor="middle" x="375" y="-13823.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="375" y="-13808.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="375" y="-13793.38" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer8_gpu0_expert_mlp2&#45;&gt;layer8_gpu0_token_send -->
<g id="edge853" class="edge">
<title>layer8_gpu0_expert_mlp2&#45;&gt;layer8_gpu0_token_send</title>
<path fill="none" stroke="black" d="M392.84,-13903.4C391.1,-13895.32 389.19,-13886.45 387.28,-13877.61"/>
<polygon fill="black" stroke="black" points="390.67,-13876.73 385.15,-13867.69 383.83,-13878.2 390.67,-13876.73"/>
</g>
<!-- layer8_expert_agg -->
<g id="node810" class="node">
<title>layer8_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="5932.05,-13735.5 5212.94,-13735.5 5027.95,-13599.5 5747.06,-13599.5 5932.05,-13735.5"/>
<text text-anchor="middle" x="5480" y="-13686.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5480" y="-13671.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x16)</text>
<text text-anchor="middle" x="5480" y="-13656.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5480" y="-13641.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer8_gpu0_token_send&#45;&gt;layer8_expert_agg -->
<g id="edge854" class="edge">
<title>layer8_gpu0_token_send&#45;&gt;layer8_expert_agg</title>
<path fill="none" stroke="black" d="M613.99,-13783.96C655.59,-13779 698.49,-13774.55 739,-13771.5 1587.6,-13707.58 4157.44,-13679.73 5115.12,-13671.37"/>
<polygon fill="black" stroke="black" points="5115.29,-13674.87 5125.26,-13671.28 5115.23,-13667.87 5115.29,-13674.87"/>
</g>
<!-- layer8_gpu1_expert_mlp1 -->
<g id="node736" class="node">
<title>layer8_gpu1_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="1413.5,-14179.66 952.5,-14179.66 952.5,-14111.66 1413.5,-14111.66 1413.5,-14179.66"/>
<text text-anchor="middle" x="1183" y="-14164.46" font-family="Times,serif" font-size="14.00">Expert 1 MLP1</text>
<text text-anchor="middle" x="1183" y="-14149.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1183" y="-14134.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1183" y="-14119.46" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer8_gpu1_token_recv&#45;&gt;layer8_gpu1_expert_mlp1 -->
<g id="edge856" class="edge">
<title>layer8_gpu1_token_recv&#45;&gt;layer8_gpu1_expert_mlp1</title>
<path fill="none" stroke="black" d="M1193.68,-14215.53C1192.36,-14207.05 1191,-14198.25 1189.7,-14189.9"/>
<polygon fill="black" stroke="black" points="1193.16,-14189.31 1188.16,-14179.97 1186.24,-14190.39 1193.16,-14189.31"/>
</g>
<!-- layer8_gpu1_expert_act -->
<g id="node737" class="node">
<title>layer8_gpu1_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="1349.5,-14075.66 972.5,-14075.66 972.5,-14007.66 1349.5,-14007.66 1349.5,-14075.66"/>
<text text-anchor="middle" x="1161" y="-14060.46" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1161" y="-14045.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1161" y="-14030.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1161" y="-14015.46" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer8_gpu1_expert_mlp1&#45;&gt;layer8_gpu1_expert_act -->
<g id="edge857" class="edge">
<title>layer8_gpu1_expert_mlp1&#45;&gt;layer8_gpu1_expert_act</title>
<path fill="none" stroke="black" d="M1175.86,-14111.55C1174.09,-14103.35 1172.17,-14094.45 1170.32,-14085.86"/>
<polygon fill="black" stroke="black" points="1173.71,-14085 1168.18,-14075.96 1166.87,-14086.48 1173.71,-14085"/>
</g>
<!-- layer8_gpu1_expert_mlp2 -->
<g id="node738" class="node">
<title>layer8_gpu1_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="1342.5,-13971.66 935.5,-13971.66 935.5,-13903.66 1342.5,-13903.66 1342.5,-13971.66"/>
<text text-anchor="middle" x="1139" y="-13956.46" font-family="Times,serif" font-size="14.00">Expert 1 MLP2</text>
<text text-anchor="middle" x="1139" y="-13941.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1139" y="-13926.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1139" y="-13911.46" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer8_gpu1_expert_act&#45;&gt;layer8_gpu1_expert_mlp2 -->
<g id="edge858" class="edge">
<title>layer8_gpu1_expert_act&#45;&gt;layer8_gpu1_expert_mlp2</title>
<path fill="none" stroke="black" d="M1153.86,-14007.55C1152.09,-13999.35 1150.17,-13990.45 1148.32,-13981.86"/>
<polygon fill="black" stroke="black" points="1151.71,-13981 1146.18,-13971.96 1144.87,-13982.48 1151.71,-13981"/>
</g>
<!-- layer8_gpu1_token_send -->
<g id="node739" class="node">
<title>layer8_gpu1_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1104" cy="-13819.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1104" y="-13838.38" font-family="Times,serif" font-size="14.00">Token Send GPU1</text>
<text text-anchor="middle" x="1104" y="-13823.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1104" y="-13808.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1104" y="-13793.38" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer8_gpu1_expert_mlp2&#45;&gt;layer8_gpu1_token_send -->
<g id="edge859" class="edge">
<title>layer8_gpu1_expert_mlp2&#45;&gt;layer8_gpu1_token_send</title>
<path fill="none" stroke="black" d="M1128.97,-13903.4C1126.51,-13895.23 1123.8,-13886.26 1121.11,-13877.33"/>
<polygon fill="black" stroke="black" points="1124.44,-13876.25 1118.2,-13867.69 1117.74,-13878.28 1124.44,-13876.25"/>
</g>
<!-- layer8_gpu1_token_send&#45;&gt;layer8_expert_agg -->
<g id="edge860" class="edge">
<title>layer8_gpu1_token_send&#45;&gt;layer8_expert_agg</title>
<path fill="none" stroke="black" d="M1343.98,-13783.98C1385.27,-13779.05 1427.82,-13774.6 1468,-13771.5 2170.7,-13717.18 4268.31,-13684.39 5117.3,-13673.02"/>
<polygon fill="black" stroke="black" points="5117.59,-13676.52 5127.54,-13672.88 5117.49,-13669.52 5117.59,-13676.52"/>
</g>
<!-- layer8_gpu2_expert_mlp1 -->
<g id="node741" class="node">
<title>layer8_gpu2_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2136.5,-14179.66 1675.5,-14179.66 1675.5,-14111.66 2136.5,-14111.66 2136.5,-14179.66"/>
<text text-anchor="middle" x="1906" y="-14164.46" font-family="Times,serif" font-size="14.00">Expert 2 MLP1</text>
<text text-anchor="middle" x="1906" y="-14149.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1906" y="-14134.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1906" y="-14119.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer8_gpu2_token_recv&#45;&gt;layer8_gpu2_expert_mlp1 -->
<g id="edge862" class="edge">
<title>layer8_gpu2_token_recv&#45;&gt;layer8_gpu2_expert_mlp1</title>
<path fill="none" stroke="black" d="M1913.71,-14215.53C1912.77,-14207.15 1911.8,-14198.45 1910.87,-14190.17"/>
<polygon fill="black" stroke="black" points="1914.32,-14189.52 1909.73,-14179.97 1907.36,-14190.3 1914.32,-14189.52"/>
</g>
<!-- layer8_gpu2_expert_act -->
<g id="node742" class="node">
<title>layer8_gpu2_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2073.5,-14075.66 1696.5,-14075.66 1696.5,-14007.66 2073.5,-14007.66 2073.5,-14075.66"/>
<text text-anchor="middle" x="1885" y="-14060.46" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="1885" y="-14045.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1885" y="-14030.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1885" y="-14015.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer8_gpu2_expert_mlp1&#45;&gt;layer8_gpu2_expert_act -->
<g id="edge863" class="edge">
<title>layer8_gpu2_expert_mlp1&#45;&gt;layer8_gpu2_expert_act</title>
<path fill="none" stroke="black" d="M1899.18,-14111.55C1897.49,-14103.35 1895.66,-14094.45 1893.89,-14085.86"/>
<polygon fill="black" stroke="black" points="1897.3,-14085.05 1891.86,-14075.96 1890.44,-14086.46 1897.3,-14085.05"/>
</g>
<!-- layer8_gpu2_expert_mlp2 -->
<g id="node743" class="node">
<title>layer8_gpu2_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2068.5,-13971.66 1661.5,-13971.66 1661.5,-13903.66 2068.5,-13903.66 2068.5,-13971.66"/>
<text text-anchor="middle" x="1865" y="-13956.46" font-family="Times,serif" font-size="14.00">Expert 2 MLP2</text>
<text text-anchor="middle" x="1865" y="-13941.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1865" y="-13926.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1865" y="-13911.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer8_gpu2_expert_act&#45;&gt;layer8_gpu2_expert_mlp2 -->
<g id="edge864" class="edge">
<title>layer8_gpu2_expert_act&#45;&gt;layer8_gpu2_expert_mlp2</title>
<path fill="none" stroke="black" d="M1878.51,-14007.55C1876.9,-13999.35 1875.15,-13990.45 1873.47,-13981.86"/>
<polygon fill="black" stroke="black" points="1876.89,-13981.1 1871.53,-13971.96 1870.02,-13982.45 1876.89,-13981.1"/>
</g>
<!-- layer8_gpu2_token_send -->
<g id="node744" class="node">
<title>layer8_gpu2_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1833" cy="-13819.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1833" y="-13838.38" font-family="Times,serif" font-size="14.00">Token Send GPU2</text>
<text text-anchor="middle" x="1833" y="-13823.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1833" y="-13808.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1833" y="-13793.38" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer8_gpu2_expert_mlp2&#45;&gt;layer8_gpu2_token_send -->
<g id="edge865" class="edge">
<title>layer8_gpu2_expert_mlp2&#45;&gt;layer8_gpu2_token_send</title>
<path fill="none" stroke="black" d="M1855.83,-13903.4C1853.6,-13895.32 1851.16,-13886.45 1848.72,-13877.61"/>
<polygon fill="black" stroke="black" points="1852.02,-13876.4 1845.99,-13867.69 1845.27,-13878.26 1852.02,-13876.4"/>
</g>
<!-- layer8_gpu2_token_send&#45;&gt;layer8_expert_agg -->
<g id="edge866" class="edge">
<title>layer8_gpu2_token_send&#45;&gt;layer8_expert_agg</title>
<path fill="none" stroke="black" d="M2073.48,-13784.12C2114.62,-13779.19 2156.98,-13774.71 2197,-13771.5 3252.04,-13686.91 4502.98,-13670.84 5111.15,-13668.39"/>
<polygon fill="black" stroke="black" points="5111.41,-13671.89 5121.39,-13668.35 5111.38,-13664.89 5111.41,-13671.89"/>
</g>
<!-- layer8_gpu3_expert_mlp1 -->
<g id="node746" class="node">
<title>layer8_gpu3_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2823.5,-14179.66 2362.5,-14179.66 2362.5,-14111.66 2823.5,-14111.66 2823.5,-14179.66"/>
<text text-anchor="middle" x="2593" y="-14164.46" font-family="Times,serif" font-size="14.00">Expert 3 MLP1</text>
<text text-anchor="middle" x="2593" y="-14149.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2593" y="-14134.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2593" y="-14119.46" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer8_gpu3_token_recv&#45;&gt;layer8_gpu3_expert_mlp1 -->
<g id="edge868" class="edge">
<title>layer8_gpu3_token_recv&#45;&gt;layer8_gpu3_expert_mlp1</title>
<path fill="none" stroke="black" d="M2610.2,-14215.53C2608.09,-14207.05 2605.89,-14198.25 2603.8,-14189.9"/>
<polygon fill="black" stroke="black" points="2607.14,-14188.82 2601.32,-14179.97 2600.35,-14190.52 2607.14,-14188.82"/>
</g>
<!-- layer8_gpu3_expert_act -->
<g id="node747" class="node">
<title>layer8_gpu3_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2767.5,-14075.66 2390.5,-14075.66 2390.5,-14007.66 2767.5,-14007.66 2767.5,-14075.66"/>
<text text-anchor="middle" x="2579" y="-14060.46" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="2579" y="-14045.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2579" y="-14030.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2579" y="-14015.46" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer8_gpu3_expert_mlp1&#45;&gt;layer8_gpu3_expert_act -->
<g id="edge869" class="edge">
<title>layer8_gpu3_expert_mlp1&#45;&gt;layer8_gpu3_expert_act</title>
<path fill="none" stroke="black" d="M2588.45,-14111.55C2587.34,-14103.44 2586.13,-14094.65 2584.97,-14086.14"/>
<polygon fill="black" stroke="black" points="2588.4,-14085.39 2583.57,-14075.96 2581.46,-14086.35 2588.4,-14085.39"/>
</g>
<!-- layer8_gpu3_expert_mlp2 -->
<g id="node748" class="node">
<title>layer8_gpu3_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2773.5,-13971.66 2366.5,-13971.66 2366.5,-13903.66 2773.5,-13903.66 2773.5,-13971.66"/>
<text text-anchor="middle" x="2570" y="-13956.46" font-family="Times,serif" font-size="14.00">Expert 3 MLP2</text>
<text text-anchor="middle" x="2570" y="-13941.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2570" y="-13926.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="2570" y="-13911.46" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer8_gpu3_expert_act&#45;&gt;layer8_gpu3_expert_mlp2 -->
<g id="edge870" class="edge">
<title>layer8_gpu3_expert_act&#45;&gt;layer8_gpu3_expert_mlp2</title>
<path fill="none" stroke="black" d="M2576.08,-14007.55C2575.36,-13999.44 2574.59,-13990.65 2573.84,-13982.14"/>
<polygon fill="black" stroke="black" points="2577.3,-13981.62 2572.94,-13971.96 2570.33,-13982.23 2577.3,-13981.62"/>
</g>
<!-- layer8_gpu3_token_send -->
<g id="node749" class="node">
<title>layer8_gpu3_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="2562" cy="-13819.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="2562" y="-13838.38" font-family="Times,serif" font-size="14.00">Token Send GPU3</text>
<text text-anchor="middle" x="2562" y="-13823.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="2562" y="-13808.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="2562" y="-13793.38" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer8_gpu3_expert_mlp2&#45;&gt;layer8_gpu3_token_send -->
<g id="edge871" class="edge">
<title>layer8_gpu3_expert_mlp2&#45;&gt;layer8_gpu3_token_send</title>
<path fill="none" stroke="black" d="M2567.71,-13903.4C2567.16,-13895.41 2566.55,-13886.64 2565.95,-13877.9"/>
<polygon fill="black" stroke="black" points="2569.43,-13877.43 2565.25,-13867.69 2562.44,-13877.91 2569.43,-13877.43"/>
</g>
<!-- layer8_gpu3_token_send&#45;&gt;layer8_expert_agg -->
<g id="edge872" class="edge">
<title>layer8_gpu3_token_send&#45;&gt;layer8_expert_agg</title>
<path fill="none" stroke="black" d="M2803.98,-13784.25C2844.65,-13779.35 2886.48,-13774.84 2926,-13771.5 3705.23,-13705.52 4621.9,-13681.57 5117.54,-13673.05"/>
<polygon fill="black" stroke="black" points="5117.77,-13676.55 5127.71,-13672.88 5117.65,-13669.55 5117.77,-13676.55"/>
</g>
<!-- layer8_gpu4_expert_mlp1 -->
<g id="node751" class="node">
<title>layer8_gpu4_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="3541.5,-14179.66 3080.5,-14179.66 3080.5,-14111.66 3541.5,-14111.66 3541.5,-14179.66"/>
<text text-anchor="middle" x="3311" y="-14164.46" font-family="Times,serif" font-size="14.00">Expert 4 MLP1</text>
<text text-anchor="middle" x="3311" y="-14149.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3311" y="-14134.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3311" y="-14119.46" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer8_gpu4_token_recv&#45;&gt;layer8_gpu4_expert_mlp1 -->
<g id="edge874" class="edge">
<title>layer8_gpu4_token_recv&#45;&gt;layer8_gpu4_expert_mlp1</title>
<path fill="none" stroke="black" d="M3315.15,-14215.53C3314.65,-14207.15 3314.12,-14198.45 3313.62,-14190.17"/>
<polygon fill="black" stroke="black" points="3317.1,-14189.74 3313.01,-14179.97 3310.12,-14190.16 3317.1,-14189.74"/>
</g>
<!-- layer8_gpu4_expert_act -->
<g id="node752" class="node">
<title>layer8_gpu4_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="3491.5,-14075.66 3114.5,-14075.66 3114.5,-14007.66 3491.5,-14007.66 3491.5,-14075.66"/>
<text text-anchor="middle" x="3303" y="-14060.46" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="3303" y="-14045.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3303" y="-14030.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3303" y="-14015.46" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer8_gpu4_expert_mlp1&#45;&gt;layer8_gpu4_expert_act -->
<g id="edge875" class="edge">
<title>layer8_gpu4_expert_mlp1&#45;&gt;layer8_gpu4_expert_act</title>
<path fill="none" stroke="black" d="M3308.4,-14111.55C3307.77,-14103.44 3307.08,-14094.65 3306.41,-14086.14"/>
<polygon fill="black" stroke="black" points="3309.88,-14085.66 3305.61,-14075.96 3302.9,-14086.21 3309.88,-14085.66"/>
</g>
<!-- layer8_gpu4_expert_mlp2 -->
<g id="node753" class="node">
<title>layer8_gpu4_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="3499.5,-13971.66 3092.5,-13971.66 3092.5,-13903.66 3499.5,-13903.66 3499.5,-13971.66"/>
<text text-anchor="middle" x="3296" y="-13956.46" font-family="Times,serif" font-size="14.00">Expert 4 MLP2</text>
<text text-anchor="middle" x="3296" y="-13941.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3296" y="-13926.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="3296" y="-13911.46" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer8_gpu4_expert_act&#45;&gt;layer8_gpu4_expert_mlp2 -->
<g id="edge876" class="edge">
<title>layer8_gpu4_expert_act&#45;&gt;layer8_gpu4_expert_mlp2</title>
<path fill="none" stroke="black" d="M3300.73,-14007.55C3300.17,-13999.44 3299.57,-13990.65 3298.98,-13982.14"/>
<polygon fill="black" stroke="black" points="3302.46,-13981.7 3298.29,-13971.96 3295.48,-13982.18 3302.46,-13981.7"/>
</g>
<!-- layer8_gpu4_token_send -->
<g id="node754" class="node">
<title>layer8_gpu4_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="3291" cy="-13819.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="3291" y="-13838.38" font-family="Times,serif" font-size="14.00">Token Send GPU4</text>
<text text-anchor="middle" x="3291" y="-13823.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="3291" y="-13808.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="3291" y="-13793.38" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer8_gpu4_expert_mlp2&#45;&gt;layer8_gpu4_token_send -->
<g id="edge877" class="edge">
<title>layer8_gpu4_expert_mlp2&#45;&gt;layer8_gpu4_token_send</title>
<path fill="none" stroke="black" d="M3294.57,-13903.4C3294.22,-13895.41 3293.85,-13886.64 3293.47,-13877.9"/>
<polygon fill="black" stroke="black" points="3296.96,-13877.53 3293.03,-13867.69 3289.96,-13877.83 3296.96,-13877.53"/>
</g>
<!-- layer8_gpu4_token_send&#45;&gt;layer8_expert_agg -->
<g id="edge878" class="edge">
<title>layer8_gpu4_token_send&#45;&gt;layer8_expert_agg</title>
<path fill="none" stroke="black" d="M3534.99,-13784.55C3575.03,-13779.68 3616.14,-13775.1 3655,-13771.5 4165.99,-13724.09 4759.65,-13695.48 5127.62,-13680.83"/>
<polygon fill="black" stroke="black" points="5127.78,-13684.33 5137.63,-13680.43 5127.5,-13677.33 5127.78,-13684.33"/>
</g>
<!-- layer8_gpu5_expert_mlp1 -->
<g id="node756" class="node">
<title>layer8_gpu5_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4280.5,-14179.66 3819.5,-14179.66 3819.5,-14111.66 4280.5,-14111.66 4280.5,-14179.66"/>
<text text-anchor="middle" x="4050" y="-14164.46" font-family="Times,serif" font-size="14.00">Expert 5 MLP1</text>
<text text-anchor="middle" x="4050" y="-14149.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4050" y="-14134.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4050" y="-14119.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer8_gpu5_token_recv&#45;&gt;layer8_gpu5_expert_mlp1 -->
<g id="edge880" class="edge">
<title>layer8_gpu5_token_recv&#45;&gt;layer8_gpu5_expert_mlp1</title>
<path fill="none" stroke="black" d="M4060.68,-14215.53C4059.36,-14207.05 4058,-14198.25 4056.7,-14189.9"/>
<polygon fill="black" stroke="black" points="4060.16,-14189.31 4055.16,-14179.97 4053.24,-14190.39 4060.16,-14189.31"/>
</g>
<!-- layer8_gpu5_expert_act -->
<g id="node757" class="node">
<title>layer8_gpu5_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4229.5,-14075.66 3852.5,-14075.66 3852.5,-14007.66 4229.5,-14007.66 4229.5,-14075.66"/>
<text text-anchor="middle" x="4041" y="-14060.46" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="4041" y="-14045.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4041" y="-14030.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4041" y="-14015.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer8_gpu5_expert_mlp1&#45;&gt;layer8_gpu5_expert_act -->
<g id="edge881" class="edge">
<title>layer8_gpu5_expert_mlp1&#45;&gt;layer8_gpu5_expert_act</title>
<path fill="none" stroke="black" d="M4047.08,-14111.55C4046.36,-14103.44 4045.59,-14094.65 4044.84,-14086.14"/>
<polygon fill="black" stroke="black" points="4048.3,-14085.62 4043.94,-14075.96 4041.33,-14086.23 4048.3,-14085.62"/>
</g>
<!-- layer8_gpu5_expert_mlp2 -->
<g id="node758" class="node">
<title>layer8_gpu5_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4229.5,-13971.66 3822.5,-13971.66 3822.5,-13903.66 4229.5,-13903.66 4229.5,-13971.66"/>
<text text-anchor="middle" x="4026" y="-13956.46" font-family="Times,serif" font-size="14.00">Expert 5 MLP2</text>
<text text-anchor="middle" x="4026" y="-13941.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4026" y="-13926.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4026" y="-13911.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer8_gpu5_expert_act&#45;&gt;layer8_gpu5_expert_mlp2 -->
<g id="edge882" class="edge">
<title>layer8_gpu5_expert_act&#45;&gt;layer8_gpu5_expert_mlp2</title>
<path fill="none" stroke="black" d="M4036.13,-14007.55C4034.94,-13999.44 4033.64,-13990.65 4032.39,-13982.14"/>
<polygon fill="black" stroke="black" points="4035.81,-13981.35 4030.9,-13971.96 4028.89,-13982.37 4035.81,-13981.35"/>
</g>
<!-- layer8_gpu5_token_send -->
<g id="node759" class="node">
<title>layer8_gpu5_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4020" cy="-13819.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4020" y="-13838.38" font-family="Times,serif" font-size="14.00">Token Send GPU5</text>
<text text-anchor="middle" x="4020" y="-13823.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4020" y="-13808.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4020" y="-13793.38" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer8_gpu5_expert_mlp2&#45;&gt;layer8_gpu5_token_send -->
<g id="edge883" class="edge">
<title>layer8_gpu5_expert_mlp2&#45;&gt;layer8_gpu5_token_send</title>
<path fill="none" stroke="black" d="M4024.28,-13903.4C4023.87,-13895.41 4023.41,-13886.64 4022.96,-13877.9"/>
<polygon fill="black" stroke="black" points="4026.45,-13877.5 4022.43,-13867.69 4019.46,-13877.86 4026.45,-13877.5"/>
</g>
<!-- layer8_gpu5_token_send&#45;&gt;layer8_expert_agg -->
<g id="edge884" class="edge">
<title>layer8_gpu5_token_send&#45;&gt;layer8_expert_agg</title>
<path fill="none" stroke="black" d="M4269.02,-13785.2C4307.5,-13780.38 4346.8,-13775.65 4384,-13771.5 4640.39,-13742.88 4931.13,-13715.8 5148.7,-13696.6"/>
<polygon fill="black" stroke="black" points="5149.03,-13700.08 5158.68,-13695.72 5148.41,-13693.11 5149.03,-13700.08"/>
</g>
<!-- layer8_gpu6_expert_mlp1 -->
<g id="node761" class="node">
<title>layer8_gpu6_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5010.5,-14179.66 4549.5,-14179.66 4549.5,-14111.66 5010.5,-14111.66 5010.5,-14179.66"/>
<text text-anchor="middle" x="4780" y="-14164.46" font-family="Times,serif" font-size="14.00">Expert 6 MLP1</text>
<text text-anchor="middle" x="4780" y="-14149.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4780" y="-14134.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4780" y="-14119.46" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer8_gpu6_token_recv&#45;&gt;layer8_gpu6_expert_mlp1 -->
<g id="edge886" class="edge">
<title>layer8_gpu6_token_recv&#45;&gt;layer8_gpu6_expert_mlp1</title>
<path fill="none" stroke="black" d="M4784.15,-14215.53C4783.65,-14207.15 4783.12,-14198.45 4782.62,-14190.17"/>
<polygon fill="black" stroke="black" points="4786.1,-14189.74 4782.01,-14179.97 4779.12,-14190.16 4786.1,-14189.74"/>
</g>
<!-- layer8_gpu6_expert_act -->
<g id="node762" class="node">
<title>layer8_gpu6_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4955.5,-14075.66 4578.5,-14075.66 4578.5,-14007.66 4955.5,-14007.66 4955.5,-14075.66"/>
<text text-anchor="middle" x="4767" y="-14060.46" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="4767" y="-14045.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4767" y="-14030.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4767" y="-14015.46" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer8_gpu6_expert_mlp1&#45;&gt;layer8_gpu6_expert_act -->
<g id="edge887" class="edge">
<title>layer8_gpu6_expert_mlp1&#45;&gt;layer8_gpu6_expert_act</title>
<path fill="none" stroke="black" d="M4775.78,-14111.55C4774.75,-14103.44 4773.63,-14094.65 4772.54,-14086.14"/>
<polygon fill="black" stroke="black" points="4775.98,-14085.44 4771.24,-14075.96 4769.04,-14086.33 4775.98,-14085.44"/>
</g>
<!-- layer8_gpu6_expert_mlp2 -->
<g id="node763" class="node">
<title>layer8_gpu6_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4961.5,-13971.66 4554.5,-13971.66 4554.5,-13903.66 4961.5,-13903.66 4961.5,-13971.66"/>
<text text-anchor="middle" x="4758" y="-13956.46" font-family="Times,serif" font-size="14.00">Expert 6 MLP2</text>
<text text-anchor="middle" x="4758" y="-13941.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4758" y="-13926.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4758" y="-13911.46" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer8_gpu6_expert_act&#45;&gt;layer8_gpu6_expert_mlp2 -->
<g id="edge888" class="edge">
<title>layer8_gpu6_expert_act&#45;&gt;layer8_gpu6_expert_mlp2</title>
<path fill="none" stroke="black" d="M4764.08,-14007.55C4763.36,-13999.44 4762.59,-13990.65 4761.84,-13982.14"/>
<polygon fill="black" stroke="black" points="4765.3,-13981.62 4760.94,-13971.96 4758.33,-13982.23 4765.3,-13981.62"/>
</g>
<!-- layer8_gpu6_token_send -->
<g id="node764" class="node">
<title>layer8_gpu6_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4749" cy="-13819.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4749" y="-13838.38" font-family="Times,serif" font-size="14.00">Token Send GPU6</text>
<text text-anchor="middle" x="4749" y="-13823.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4749" y="-13808.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4749" y="-13793.38" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer8_gpu6_expert_mlp2&#45;&gt;layer8_gpu6_token_send -->
<g id="edge889" class="edge">
<title>layer8_gpu6_expert_mlp2&#45;&gt;layer8_gpu6_token_send</title>
<path fill="none" stroke="black" d="M4755.42,-13903.4C4754.8,-13895.41 4754.12,-13886.64 4753.44,-13877.9"/>
<polygon fill="black" stroke="black" points="4756.92,-13877.39 4752.65,-13867.69 4749.94,-13877.93 4756.92,-13877.39"/>
</g>
<!-- layer8_gpu6_token_send&#45;&gt;layer8_expert_agg -->
<g id="edge890" class="edge">
<title>layer8_gpu6_token_send&#45;&gt;layer8_expert_agg</title>
<path fill="none" stroke="black" d="M4941.54,-13779.05C5017.53,-13763.45 5106.48,-13745.19 5189.94,-13728.05"/>
<polygon fill="black" stroke="black" points="5190.74,-13731.46 5199.83,-13726.02 5189.33,-13724.6 5190.74,-13731.46"/>
</g>
<!-- layer8_gpu7_expert_mlp1 -->
<g id="node766" class="node">
<title>layer8_gpu7_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5720.5,-14179.66 5259.5,-14179.66 5259.5,-14111.66 5720.5,-14111.66 5720.5,-14179.66"/>
<text text-anchor="middle" x="5490" y="-14164.46" font-family="Times,serif" font-size="14.00">Expert 7 MLP1</text>
<text text-anchor="middle" x="5490" y="-14149.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5490" y="-14134.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5490" y="-14119.46" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer8_gpu7_token_recv&#45;&gt;layer8_gpu7_expert_mlp1 -->
<g id="edge892" class="edge">
<title>layer8_gpu7_token_recv&#45;&gt;layer8_gpu7_expert_mlp1</title>
<path fill="none" stroke="black" d="M5490,-14215.53C5490,-14207.15 5490,-14198.45 5490,-14190.17"/>
<polygon fill="black" stroke="black" points="5493.5,-14189.97 5490,-14179.97 5486.5,-14189.97 5493.5,-14189.97"/>
</g>
<!-- layer8_gpu7_expert_act -->
<g id="node767" class="node">
<title>layer8_gpu7_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="5676.5,-14075.66 5299.5,-14075.66 5299.5,-14007.66 5676.5,-14007.66 5676.5,-14075.66"/>
<text text-anchor="middle" x="5488" y="-14060.46" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="5488" y="-14045.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5488" y="-14030.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5488" y="-14015.46" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer8_gpu7_expert_mlp1&#45;&gt;layer8_gpu7_expert_act -->
<g id="edge893" class="edge">
<title>layer8_gpu7_expert_mlp1&#45;&gt;layer8_gpu7_expert_act</title>
<path fill="none" stroke="black" d="M5489.35,-14111.55C5489.19,-14103.44 5489.02,-14094.65 5488.85,-14086.14"/>
<polygon fill="black" stroke="black" points="5492.35,-14085.89 5488.65,-14075.96 5485.35,-14086.03 5492.35,-14085.89"/>
</g>
<!-- layer8_gpu7_expert_mlp2 -->
<g id="node768" class="node">
<title>layer8_gpu7_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="5682.5,-13971.66 5275.5,-13971.66 5275.5,-13903.66 5682.5,-13903.66 5682.5,-13971.66"/>
<text text-anchor="middle" x="5479" y="-13956.46" font-family="Times,serif" font-size="14.00">Expert 7 MLP2</text>
<text text-anchor="middle" x="5479" y="-13941.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5479" y="-13926.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5479" y="-13911.46" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer8_gpu7_expert_act&#45;&gt;layer8_gpu7_expert_mlp2 -->
<g id="edge894" class="edge">
<title>layer8_gpu7_expert_act&#45;&gt;layer8_gpu7_expert_mlp2</title>
<path fill="none" stroke="black" d="M5485.08,-14007.55C5484.36,-13999.44 5483.59,-13990.65 5482.84,-13982.14"/>
<polygon fill="black" stroke="black" points="5486.3,-13981.62 5481.94,-13971.96 5479.33,-13982.23 5486.3,-13981.62"/>
</g>
<!-- layer8_gpu7_token_send -->
<g id="node769" class="node">
<title>layer8_gpu7_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="5478" cy="-13819.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="5478" y="-13838.38" font-family="Times,serif" font-size="14.00">Token Send GPU7</text>
<text text-anchor="middle" x="5478" y="-13823.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="5478" y="-13808.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="5478" y="-13793.38" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer8_gpu7_expert_mlp2&#45;&gt;layer8_gpu7_token_send -->
<g id="edge895" class="edge">
<title>layer8_gpu7_expert_mlp2&#45;&gt;layer8_gpu7_token_send</title>
<path fill="none" stroke="black" d="M5478.71,-13903.4C5478.64,-13895.41 5478.57,-13886.64 5478.49,-13877.9"/>
<polygon fill="black" stroke="black" points="5481.99,-13877.66 5478.41,-13867.69 5474.99,-13877.72 5481.99,-13877.66"/>
</g>
<!-- layer8_gpu7_token_send&#45;&gt;layer8_expert_agg -->
<g id="edge896" class="edge">
<title>layer8_gpu7_token_send&#45;&gt;layer8_expert_agg</title>
<path fill="none" stroke="black" d="M5478.63,-13771.09C5478.74,-13763.01 5478.85,-13754.43 5478.97,-13745.8"/>
<polygon fill="black" stroke="black" points="5482.47,-13745.74 5479.1,-13735.69 5475.47,-13745.65 5482.47,-13745.74"/>
</g>
<!-- layer8_gpu8_expert_mlp1 -->
<g id="node771" class="node">
<title>layer8_gpu8_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="6409.5,-14179.66 5948.5,-14179.66 5948.5,-14111.66 6409.5,-14111.66 6409.5,-14179.66"/>
<text text-anchor="middle" x="6179" y="-14164.46" font-family="Times,serif" font-size="14.00">Expert 8 MLP1</text>
<text text-anchor="middle" x="6179" y="-14149.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6179" y="-14134.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6179" y="-14119.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_gpu8_token_recv&#45;&gt;layer8_gpu8_expert_mlp1 -->
<g id="edge898" class="edge">
<title>layer8_gpu8_token_recv&#45;&gt;layer8_gpu8_expert_mlp1</title>
<path fill="none" stroke="black" d="M6177.81,-14215.53C6177.96,-14207.15 6178.11,-14198.45 6178.25,-14190.17"/>
<polygon fill="black" stroke="black" points="6181.75,-14190.03 6178.43,-14179.97 6174.75,-14189.91 6181.75,-14190.03"/>
</g>
<!-- layer8_gpu8_expert_act -->
<g id="node772" class="node">
<title>layer8_gpu8_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="6372.5,-14075.66 5995.5,-14075.66 5995.5,-14007.66 6372.5,-14007.66 6372.5,-14075.66"/>
<text text-anchor="middle" x="6184" y="-14060.46" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="6184" y="-14045.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6184" y="-14030.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6184" y="-14015.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_gpu8_expert_mlp1&#45;&gt;layer8_gpu8_expert_act -->
<g id="edge899" class="edge">
<title>layer8_gpu8_expert_mlp1&#45;&gt;layer8_gpu8_expert_act</title>
<path fill="none" stroke="black" d="M6180.62,-14111.55C6181.02,-14103.44 6181.45,-14094.65 6181.87,-14086.14"/>
<polygon fill="black" stroke="black" points="6185.37,-14086.12 6182.37,-14075.96 6178.38,-14085.78 6185.37,-14086.12"/>
</g>
<!-- layer8_gpu8_expert_mlp2 -->
<g id="node773" class="node">
<title>layer8_gpu8_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="6407.5,-13971.66 6000.5,-13971.66 6000.5,-13903.66 6407.5,-13903.66 6407.5,-13971.66"/>
<text text-anchor="middle" x="6204" y="-13956.46" font-family="Times,serif" font-size="14.00">Expert 8 MLP2</text>
<text text-anchor="middle" x="6204" y="-13941.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6204" y="-13926.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6204" y="-13911.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_gpu8_expert_act&#45;&gt;layer8_gpu8_expert_mlp2 -->
<g id="edge900" class="edge">
<title>layer8_gpu8_expert_act&#45;&gt;layer8_gpu8_expert_mlp2</title>
<path fill="none" stroke="black" d="M6190.49,-14007.55C6192.1,-13999.35 6193.85,-13990.45 6195.53,-13981.86"/>
<polygon fill="black" stroke="black" points="6198.98,-13982.45 6197.47,-13971.96 6192.11,-13981.1 6198.98,-13982.45"/>
</g>
<!-- layer8_gpu8_token_send -->
<g id="node774" class="node">
<title>layer8_gpu8_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6207" cy="-13819.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6207" y="-13838.38" font-family="Times,serif" font-size="14.00">Token Send GPU8</text>
<text text-anchor="middle" x="6207" y="-13823.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6207" y="-13808.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6207" y="-13793.38" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_gpu8_expert_mlp2&#45;&gt;layer8_gpu8_token_send -->
<g id="edge901" class="edge">
<title>layer8_gpu8_expert_mlp2&#45;&gt;layer8_gpu8_token_send</title>
<path fill="none" stroke="black" d="M6204.86,-13903.4C6205.07,-13895.41 6205.29,-13886.64 6205.52,-13877.9"/>
<polygon fill="black" stroke="black" points="6209.02,-13877.78 6205.78,-13867.69 6202.03,-13877.6 6209.02,-13877.78"/>
</g>
<!-- layer8_gpu8_token_send&#45;&gt;layer8_expert_agg -->
<g id="edge902" class="edge">
<title>layer8_gpu8_token_send&#45;&gt;layer8_expert_agg</title>
<path fill="none" stroke="black" d="M6015.51,-13779.05C5953.86,-13766.32 5883.64,-13751.83 5814.79,-13737.61"/>
<polygon fill="black" stroke="black" points="5815.14,-13734.11 5804.64,-13735.52 5813.73,-13740.97 5815.14,-13734.11"/>
</g>
<!-- layer8_gpu9_expert_mlp1 -->
<g id="node776" class="node">
<title>layer8_gpu9_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7099.5,-14179.66 6638.5,-14179.66 6638.5,-14111.66 7099.5,-14111.66 7099.5,-14179.66"/>
<text text-anchor="middle" x="6869" y="-14164.46" font-family="Times,serif" font-size="14.00">Expert 9 MLP1</text>
<text text-anchor="middle" x="6869" y="-14149.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6869" y="-14134.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6869" y="-14119.46" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer8_gpu9_token_recv&#45;&gt;layer8_gpu9_expert_mlp1 -->
<g id="edge904" class="edge">
<title>layer8_gpu9_token_recv&#45;&gt;layer8_gpu9_expert_mlp1</title>
<path fill="none" stroke="black" d="M6866.03,-14215.53C6866.39,-14207.15 6866.77,-14198.45 6867.13,-14190.17"/>
<polygon fill="black" stroke="black" points="6870.63,-14190.11 6867.57,-14179.97 6863.64,-14189.81 6870.63,-14190.11"/>
</g>
<!-- layer8_gpu9_expert_act -->
<g id="node777" class="node">
<title>layer8_gpu9_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7078.5,-14075.66 6701.5,-14075.66 6701.5,-14007.66 7078.5,-14007.66 7078.5,-14075.66"/>
<text text-anchor="middle" x="6890" y="-14060.46" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="6890" y="-14045.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6890" y="-14030.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6890" y="-14015.46" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer8_gpu9_expert_mlp1&#45;&gt;layer8_gpu9_expert_act -->
<g id="edge905" class="edge">
<title>layer8_gpu9_expert_mlp1&#45;&gt;layer8_gpu9_expert_act</title>
<path fill="none" stroke="black" d="M6875.82,-14111.55C6877.51,-14103.35 6879.34,-14094.45 6881.11,-14085.86"/>
<polygon fill="black" stroke="black" points="6884.56,-14086.46 6883.14,-14075.96 6877.7,-14085.05 6884.56,-14086.46"/>
</g>
<!-- layer8_gpu9_expert_mlp2 -->
<g id="node778" class="node">
<title>layer8_gpu9_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7098.5,-13971.66 6691.5,-13971.66 6691.5,-13903.66 7098.5,-13903.66 7098.5,-13971.66"/>
<text text-anchor="middle" x="6895" y="-13956.46" font-family="Times,serif" font-size="14.00">Expert 9 MLP2</text>
<text text-anchor="middle" x="6895" y="-13941.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6895" y="-13926.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6895" y="-13911.46" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer8_gpu9_expert_act&#45;&gt;layer8_gpu9_expert_mlp2 -->
<g id="edge906" class="edge">
<title>layer8_gpu9_expert_act&#45;&gt;layer8_gpu9_expert_mlp2</title>
<path fill="none" stroke="black" d="M6891.62,-14007.55C6892.02,-13999.44 6892.45,-13990.65 6892.87,-13982.14"/>
<polygon fill="black" stroke="black" points="6896.37,-13982.12 6893.37,-13971.96 6889.38,-13981.78 6896.37,-13982.12"/>
</g>
<!-- layer8_gpu9_token_send -->
<g id="node779" class="node">
<title>layer8_gpu9_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6936" cy="-13819.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6936" y="-13838.38" font-family="Times,serif" font-size="14.00">Token Send GPU9</text>
<text text-anchor="middle" x="6936" y="-13823.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6936" y="-13808.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6936" y="-13793.38" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer8_gpu9_expert_mlp2&#45;&gt;layer8_gpu9_token_send -->
<g id="edge907" class="edge">
<title>layer8_gpu9_expert_mlp2&#45;&gt;layer8_gpu9_token_send</title>
<path fill="none" stroke="black" d="M6906.75,-13903.4C6909.63,-13895.23 6912.8,-13886.26 6915.96,-13877.33"/>
<polygon fill="black" stroke="black" points="6919.33,-13878.29 6919.36,-13867.69 6912.73,-13875.95 6919.33,-13878.29"/>
</g>
<!-- layer8_gpu9_token_send&#45;&gt;layer8_expert_agg -->
<g id="edge908" class="edge">
<title>layer8_gpu9_token_send&#45;&gt;layer8_expert_agg</title>
<path fill="none" stroke="black" d="M6686.98,-13785.21C6648.5,-13780.39 6609.2,-13775.66 6572,-13771.5 6350.19,-13746.7 6102.58,-13723.02 5899.29,-13704.63"/>
<polygon fill="black" stroke="black" points="5899.31,-13701.11 5889.03,-13703.7 5898.68,-13708.09 5899.31,-13701.11"/>
</g>
<!-- layer8_gpu10_expert_mlp1 -->
<g id="node781" class="node">
<title>layer8_gpu10_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7843.5,-14179.66 7382.5,-14179.66 7382.5,-14111.66 7843.5,-14111.66 7843.5,-14179.66"/>
<text text-anchor="middle" x="7613" y="-14164.46" font-family="Times,serif" font-size="14.00">Expert 10 MLP1</text>
<text text-anchor="middle" x="7613" y="-14149.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7613" y="-14134.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7613" y="-14119.46" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer8_gpu10_token_recv&#45;&gt;layer8_gpu10_expert_mlp1 -->
<g id="edge910" class="edge">
<title>layer8_gpu10_token_recv&#45;&gt;layer8_gpu10_expert_mlp1</title>
<path fill="none" stroke="black" d="M7576.22,-14215.53C7580.95,-14206.68 7585.86,-14197.48 7590.5,-14188.8"/>
<polygon fill="black" stroke="black" points="7593.59,-14190.44 7595.21,-14179.97 7587.41,-14187.14 7593.59,-14190.44"/>
</g>
<!-- layer8_gpu10_expert_act -->
<g id="node782" class="node">
<title>layer8_gpu10_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7814.5,-14075.66 7437.5,-14075.66 7437.5,-14007.66 7814.5,-14007.66 7814.5,-14075.66"/>
<text text-anchor="middle" x="7626" y="-14060.46" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="7626" y="-14045.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7626" y="-14030.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7626" y="-14015.46" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer8_gpu10_expert_mlp1&#45;&gt;layer8_gpu10_expert_act -->
<g id="edge911" class="edge">
<title>layer8_gpu10_expert_mlp1&#45;&gt;layer8_gpu10_expert_act</title>
<path fill="none" stroke="black" d="M7617.22,-14111.55C7618.25,-14103.44 7619.37,-14094.65 7620.46,-14086.14"/>
<polygon fill="black" stroke="black" points="7623.96,-14086.33 7621.76,-14075.96 7617.02,-14085.44 7623.96,-14086.33"/>
</g>
<!-- layer8_gpu10_expert_mlp2 -->
<g id="node783" class="node">
<title>layer8_gpu10_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7842.5,-13971.66 7435.5,-13971.66 7435.5,-13903.66 7842.5,-13903.66 7842.5,-13971.66"/>
<text text-anchor="middle" x="7639" y="-13956.46" font-family="Times,serif" font-size="14.00">Expert 10 MLP2</text>
<text text-anchor="middle" x="7639" y="-13941.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7639" y="-13926.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="7639" y="-13911.46" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer8_gpu10_expert_act&#45;&gt;layer8_gpu10_expert_mlp2 -->
<g id="edge912" class="edge">
<title>layer8_gpu10_expert_act&#45;&gt;layer8_gpu10_expert_mlp2</title>
<path fill="none" stroke="black" d="M7630.22,-14007.55C7631.25,-13999.44 7632.37,-13990.65 7633.46,-13982.14"/>
<polygon fill="black" stroke="black" points="7636.96,-13982.33 7634.76,-13971.96 7630.02,-13981.44 7636.96,-13982.33"/>
</g>
<!-- layer8_gpu10_token_send -->
<g id="node784" class="node">
<title>layer8_gpu10_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="7665" cy="-13819.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="7665" y="-13838.38" font-family="Times,serif" font-size="14.00">Token Send GPU10</text>
<text text-anchor="middle" x="7665" y="-13823.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="7665" y="-13808.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="7665" y="-13793.38" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer8_gpu10_expert_mlp2&#45;&gt;layer8_gpu10_token_send -->
<g id="edge913" class="edge">
<title>layer8_gpu10_expert_mlp2&#45;&gt;layer8_gpu10_token_send</title>
<path fill="none" stroke="black" d="M7646.45,-13903.4C7648.26,-13895.32 7650.25,-13886.45 7652.23,-13877.61"/>
<polygon fill="black" stroke="black" points="7655.68,-13878.21 7654.45,-13867.69 7648.85,-13876.68 7655.68,-13878.21"/>
</g>
<!-- layer8_gpu10_token_send&#45;&gt;layer8_expert_agg -->
<g id="edge914" class="edge">
<title>layer8_gpu10_token_send&#45;&gt;layer8_expert_agg</title>
<path fill="none" stroke="black" d="M7421.01,-13784.56C7380.96,-13779.68 7339.86,-13775.11 7301,-13771.5 6808.31,-13725.76 6238.61,-13697.48 5869.49,-13682.39"/>
<polygon fill="black" stroke="black" points="5869.58,-13678.89 5859.44,-13681.98 5869.29,-13685.89 5869.58,-13678.89"/>
</g>
<!-- layer8_gpu11_expert_mlp1 -->
<g id="node786" class="node">
<title>layer8_gpu11_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="8487.5,-14179.66 8026.5,-14179.66 8026.5,-14111.66 8487.5,-14111.66 8487.5,-14179.66"/>
<text text-anchor="middle" x="8257" y="-14164.46" font-family="Times,serif" font-size="14.00">Expert 11 MLP1</text>
<text text-anchor="middle" x="8257" y="-14149.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8257" y="-14134.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8257" y="-14119.46" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer8_gpu11_token_recv&#45;&gt;layer8_gpu11_expert_mlp1 -->
<g id="edge916" class="edge">
<title>layer8_gpu11_token_recv&#45;&gt;layer8_gpu11_expert_mlp1</title>
<path fill="none" stroke="black" d="M8245.73,-14215.53C8247.12,-14207.05 8248.56,-14198.25 8249.92,-14189.9"/>
<polygon fill="black" stroke="black" points="8253.39,-14190.4 8251.55,-14179.97 8246.48,-14189.27 8253.39,-14190.4"/>
</g>
<!-- layer8_gpu11_expert_act -->
<g id="node787" class="node">
<title>layer8_gpu11_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="8463.5,-14075.66 8086.5,-14075.66 8086.5,-14007.66 8463.5,-14007.66 8463.5,-14075.66"/>
<text text-anchor="middle" x="8275" y="-14060.46" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="8275" y="-14045.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8275" y="-14030.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8275" y="-14015.46" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer8_gpu11_expert_mlp1&#45;&gt;layer8_gpu11_expert_act -->
<g id="edge917" class="edge">
<title>layer8_gpu11_expert_mlp1&#45;&gt;layer8_gpu11_expert_act</title>
<path fill="none" stroke="black" d="M8262.84,-14111.55C8264.29,-14103.35 8265.86,-14094.45 8267.38,-14085.86"/>
<polygon fill="black" stroke="black" points="8270.83,-14086.42 8269.12,-14075.96 8263.94,-14085.2 8270.83,-14086.42"/>
</g>
<!-- layer8_gpu11_expert_mlp2 -->
<g id="node788" class="node">
<title>layer8_gpu11_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="8561.5,-13971.66 8154.5,-13971.66 8154.5,-13903.66 8561.5,-13903.66 8561.5,-13971.66"/>
<text text-anchor="middle" x="8358" y="-13956.46" font-family="Times,serif" font-size="14.00">Expert 11 MLP2</text>
<text text-anchor="middle" x="8358" y="-13941.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8358" y="-13926.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="8358" y="-13911.46" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer8_gpu11_expert_act&#45;&gt;layer8_gpu11_expert_mlp2 -->
<g id="edge918" class="edge">
<title>layer8_gpu11_expert_act&#45;&gt;layer8_gpu11_expert_mlp2</title>
<path fill="none" stroke="black" d="M8301.95,-14007.55C8309.12,-13998.73 8316.96,-13989.09 8324.45,-13979.9"/>
<polygon fill="black" stroke="black" points="8327.31,-13981.93 8330.9,-13971.96 8321.88,-13977.51 8327.31,-13981.93"/>
</g>
<!-- layer8_gpu11_token_send -->
<g id="node789" class="node">
<title>layer8_gpu11_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="8394" cy="-13819.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="8394" y="-13838.38" font-family="Times,serif" font-size="14.00">Token Send GPU11</text>
<text text-anchor="middle" x="8394" y="-13823.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="8394" y="-13808.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="8394" y="-13793.38" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer8_gpu11_expert_mlp2&#45;&gt;layer8_gpu11_token_send -->
<g id="edge919" class="edge">
<title>layer8_gpu11_expert_mlp2&#45;&gt;layer8_gpu11_token_send</title>
<path fill="none" stroke="black" d="M8368.32,-13903.4C8370.85,-13895.23 8373.63,-13886.26 8376.4,-13877.33"/>
<polygon fill="black" stroke="black" points="8379.77,-13878.28 8379.39,-13867.69 8373.09,-13876.21 8379.77,-13878.28"/>
</g>
<!-- layer8_gpu11_token_send&#45;&gt;layer8_expert_agg -->
<g id="edge920" class="edge">
<title>layer8_gpu11_token_send&#45;&gt;layer8_expert_agg</title>
<path fill="none" stroke="black" d="M8152.02,-13784.25C8111.35,-13779.35 8069.52,-13774.85 8030,-13771.5 7260.21,-13706.29 6356.08,-13682.13 5857.72,-13673.35"/>
<polygon fill="black" stroke="black" points="5857.55,-13669.84 5847.49,-13673.17 5857.43,-13676.84 5857.55,-13669.84"/>
</g>
<!-- layer8_gpu12_expert_mlp1 -->
<g id="node791" class="node">
<title>layer8_gpu12_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9280.5,-14179.66 8819.5,-14179.66 8819.5,-14111.66 9280.5,-14111.66 9280.5,-14179.66"/>
<text text-anchor="middle" x="9050" y="-14164.46" font-family="Times,serif" font-size="14.00">Expert 12 MLP1</text>
<text text-anchor="middle" x="9050" y="-14149.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9050" y="-14134.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9050" y="-14119.46" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer8_gpu12_token_recv&#45;&gt;layer8_gpu12_expert_mlp1 -->
<g id="edge922" class="edge">
<title>layer8_gpu12_token_recv&#45;&gt;layer8_gpu12_expert_mlp1</title>
<path fill="none" stroke="black" d="M8975.12,-14216.2C8985.51,-14206.55 8996.38,-14196.46 9006.51,-14187.05"/>
<polygon fill="black" stroke="black" points="9009.15,-14189.38 9014.1,-14180.01 9004.39,-14184.25 9009.15,-14189.38"/>
</g>
<!-- layer8_gpu12_expert_act -->
<g id="node792" class="node">
<title>layer8_gpu12_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9249.5,-14075.66 8872.5,-14075.66 8872.5,-14007.66 9249.5,-14007.66 9249.5,-14075.66"/>
<text text-anchor="middle" x="9061" y="-14060.46" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="9061" y="-14045.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9061" y="-14030.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9061" y="-14015.46" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer8_gpu12_expert_mlp1&#45;&gt;layer8_gpu12_expert_act -->
<g id="edge923" class="edge">
<title>layer8_gpu12_expert_mlp1&#45;&gt;layer8_gpu12_expert_act</title>
<path fill="none" stroke="black" d="M9053.57,-14111.55C9054.45,-14103.44 9055.39,-14094.65 9056.31,-14086.14"/>
<polygon fill="black" stroke="black" points="9059.82,-14086.28 9057.41,-14075.96 9052.86,-14085.53 9059.82,-14086.28"/>
</g>
<!-- layer8_gpu12_expert_mlp2 -->
<g id="node793" class="node">
<title>layer8_gpu12_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9274.5,-13971.66 8867.5,-13971.66 8867.5,-13903.66 9274.5,-13903.66 9274.5,-13971.66"/>
<text text-anchor="middle" x="9071" y="-13956.46" font-family="Times,serif" font-size="14.00">Expert 12 MLP2</text>
<text text-anchor="middle" x="9071" y="-13941.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9071" y="-13926.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9071" y="-13911.46" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer8_gpu12_expert_act&#45;&gt;layer8_gpu12_expert_mlp2 -->
<g id="edge924" class="edge">
<title>layer8_gpu12_expert_act&#45;&gt;layer8_gpu12_expert_mlp2</title>
<path fill="none" stroke="black" d="M9064.25,-14007.55C9065.04,-13999.44 9065.9,-13990.65 9066.74,-13982.14"/>
<polygon fill="black" stroke="black" points="9070.24,-13982.26 9067.74,-13971.96 9063.28,-13981.57 9070.24,-13982.26"/>
</g>
<!-- layer8_gpu12_token_send -->
<g id="node794" class="node">
<title>layer8_gpu12_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9123" cy="-13819.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9123" y="-13838.38" font-family="Times,serif" font-size="14.00">Token Send GPU12</text>
<text text-anchor="middle" x="9123" y="-13823.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9123" y="-13808.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9123" y="-13793.38" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer8_gpu12_expert_mlp2&#45;&gt;layer8_gpu12_token_send -->
<g id="edge925" class="edge">
<title>layer8_gpu12_expert_mlp2&#45;&gt;layer8_gpu12_token_send</title>
<path fill="none" stroke="black" d="M9085.9,-13903.4C9089.6,-13895.15 9093.66,-13886.07 9097.71,-13877.04"/>
<polygon fill="black" stroke="black" points="9101,-13878.25 9101.9,-13867.69 9094.61,-13875.39 9101,-13878.25"/>
</g>
<!-- layer8_gpu12_token_send&#45;&gt;layer8_expert_agg -->
<g id="edge926" class="edge">
<title>layer8_gpu12_token_send&#45;&gt;layer8_expert_agg</title>
<path fill="none" stroke="black" d="M8882.52,-13784.12C8841.38,-13779.19 8799.02,-13774.71 8759,-13771.5 7706.84,-13687.13 6459.59,-13670.93 5851.15,-13668.42"/>
<polygon fill="black" stroke="black" points="5850.92,-13664.92 5840.9,-13668.38 5850.89,-13671.92 5850.92,-13664.92"/>
</g>
<!-- layer8_gpu13_expert_mlp1 -->
<g id="node796" class="node">
<title>layer8_gpu13_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9863.5,-14179.66 9402.5,-14179.66 9402.5,-14111.66 9863.5,-14111.66 9863.5,-14179.66"/>
<text text-anchor="middle" x="9633" y="-14164.46" font-family="Times,serif" font-size="14.00">Expert 13 MLP1</text>
<text text-anchor="middle" x="9633" y="-14149.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9633" y="-14134.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9633" y="-14119.46" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer8_gpu13_token_recv&#45;&gt;layer8_gpu13_expert_mlp1 -->
<g id="edge928" class="edge">
<title>layer8_gpu13_token_recv&#45;&gt;layer8_gpu13_expert_mlp1</title>
<path fill="none" stroke="black" d="M9620.54,-14215.53C9622.08,-14207.05 9623.67,-14198.25 9625.18,-14189.9"/>
<polygon fill="black" stroke="black" points="9628.64,-14190.43 9626.98,-14179.97 9621.75,-14189.19 9628.64,-14190.43"/>
</g>
<!-- layer8_gpu13_expert_act -->
<g id="node797" class="node">
<title>layer8_gpu13_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9868.5,-14075.66 9491.5,-14075.66 9491.5,-14007.66 9868.5,-14007.66 9868.5,-14075.66"/>
<text text-anchor="middle" x="9680" y="-14060.46" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="9680" y="-14045.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9680" y="-14030.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9680" y="-14015.46" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer8_gpu13_expert_mlp1&#45;&gt;layer8_gpu13_expert_act -->
<g id="edge929" class="edge">
<title>layer8_gpu13_expert_mlp1&#45;&gt;layer8_gpu13_expert_act</title>
<path fill="none" stroke="black" d="M9648.26,-14111.55C9652.12,-14103.17 9656.32,-14094.07 9660.36,-14085.3"/>
<polygon fill="black" stroke="black" points="9663.65,-14086.51 9664.66,-14075.96 9657.29,-14083.58 9663.65,-14086.51"/>
</g>
<!-- layer8_gpu13_expert_mlp2 -->
<g id="node798" class="node">
<title>layer8_gpu13_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9930.5,-13971.66 9523.5,-13971.66 9523.5,-13903.66 9930.5,-13903.66 9930.5,-13971.66"/>
<text text-anchor="middle" x="9727" y="-13956.46" font-family="Times,serif" font-size="14.00">Expert 13 MLP2</text>
<text text-anchor="middle" x="9727" y="-13941.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9727" y="-13926.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9727" y="-13911.46" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer8_gpu13_expert_act&#45;&gt;layer8_gpu13_expert_mlp2 -->
<g id="edge930" class="edge">
<title>layer8_gpu13_expert_act&#45;&gt;layer8_gpu13_expert_mlp2</title>
<path fill="none" stroke="black" d="M9695.26,-14007.55C9699.12,-13999.17 9703.32,-13990.07 9707.36,-13981.3"/>
<polygon fill="black" stroke="black" points="9710.65,-13982.51 9711.66,-13971.96 9704.29,-13979.58 9710.65,-13982.51"/>
</g>
<!-- layer8_gpu13_token_send -->
<g id="node799" class="node">
<title>layer8_gpu13_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9852" cy="-13819.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9852" y="-13838.38" font-family="Times,serif" font-size="14.00">Token Send GPU13</text>
<text text-anchor="middle" x="9852" y="-13823.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9852" y="-13808.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9852" y="-13793.38" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer8_gpu13_expert_mlp2&#45;&gt;layer8_gpu13_token_send -->
<g id="edge931" class="edge">
<title>layer8_gpu13_expert_mlp2&#45;&gt;layer8_gpu13_token_send</title>
<path fill="none" stroke="black" d="M9762.82,-13903.4C9772.67,-13894.25 9783.6,-13884.1 9794.35,-13874.12"/>
<polygon fill="black" stroke="black" points="9796.79,-13876.63 9801.74,-13867.26 9792.03,-13871.5 9796.79,-13876.63"/>
</g>
<!-- layer8_gpu13_token_send&#45;&gt;layer8_expert_agg -->
<g id="edge932" class="edge">
<title>layer8_gpu13_token_send&#45;&gt;layer8_expert_agg</title>
<path fill="none" stroke="black" d="M9612.02,-13783.98C9570.73,-13779.05 9528.18,-13774.6 9488,-13771.5 8790.13,-13717.54 6715.07,-13684.79 5857.42,-13673.23"/>
<polygon fill="black" stroke="black" points="5857.44,-13669.73 5847.39,-13673.1 5857.34,-13676.73 5857.44,-13669.73"/>
</g>
<!-- layer8_gpu14_expert_mlp1 -->
<g id="node801" class="node">
<title>layer8_gpu14_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="10671.5,-14179.66 10210.5,-14179.66 10210.5,-14111.66 10671.5,-14111.66 10671.5,-14179.66"/>
<text text-anchor="middle" x="10441" y="-14164.46" font-family="Times,serif" font-size="14.00">Expert 14 MLP1</text>
<text text-anchor="middle" x="10441" y="-14149.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10441" y="-14134.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10441" y="-14119.46" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer8_gpu14_token_recv&#45;&gt;layer8_gpu14_expert_mlp1 -->
<g id="edge934" class="edge">
<title>layer8_gpu14_token_recv&#45;&gt;layer8_gpu14_expert_mlp1</title>
<path fill="none" stroke="black" d="M10364.92,-14216.2C10375.59,-14206.46 10386.74,-14196.26 10397.12,-14186.77"/>
<polygon fill="black" stroke="black" points="10399.5,-14189.34 10404.52,-14180.01 10394.78,-14184.17 10399.5,-14189.34"/>
</g>
<!-- layer8_gpu14_expert_act -->
<g id="node802" class="node">
<title>layer8_gpu14_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="10689.5,-14075.66 10312.5,-14075.66 10312.5,-14007.66 10689.5,-14007.66 10689.5,-14075.66"/>
<text text-anchor="middle" x="10501" y="-14060.46" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="10501" y="-14045.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10501" y="-14030.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10501" y="-14015.46" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer8_gpu14_expert_mlp1&#45;&gt;layer8_gpu14_expert_act -->
<g id="edge935" class="edge">
<title>layer8_gpu14_expert_mlp1&#45;&gt;layer8_gpu14_expert_act</title>
<path fill="none" stroke="black" d="M10460.48,-14111.55C10465.51,-14103 10470.99,-14093.68 10476.25,-14084.74"/>
<polygon fill="black" stroke="black" points="10479.36,-14086.36 10481.41,-14075.96 10473.33,-14082.81 10479.36,-14086.36"/>
</g>
<!-- layer8_gpu14_expert_mlp2 -->
<g id="node803" class="node">
<title>layer8_gpu14_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10765.5,-13971.66 10358.5,-13971.66 10358.5,-13903.66 10765.5,-13903.66 10765.5,-13971.66"/>
<text text-anchor="middle" x="10562" y="-13956.46" font-family="Times,serif" font-size="14.00">Expert 14 MLP2</text>
<text text-anchor="middle" x="10562" y="-13941.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10562" y="-13926.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="10562" y="-13911.46" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer8_gpu14_expert_act&#45;&gt;layer8_gpu14_expert_mlp2 -->
<g id="edge936" class="edge">
<title>layer8_gpu14_expert_act&#45;&gt;layer8_gpu14_expert_mlp2</title>
<path fill="none" stroke="black" d="M10520.8,-14007.55C10525.92,-13999 10531.49,-13989.68 10536.84,-13980.74"/>
<polygon fill="black" stroke="black" points="10539.96,-13982.34 10542.09,-13971.96 10533.95,-13978.75 10539.96,-13982.34"/>
</g>
<!-- layer8_gpu14_token_send -->
<g id="node804" class="node">
<title>layer8_gpu14_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="10581" cy="-13819.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="10581" y="-13838.38" font-family="Times,serif" font-size="14.00">Token Send GPU14</text>
<text text-anchor="middle" x="10581" y="-13823.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="10581" y="-13808.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="10581" y="-13793.38" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer8_gpu14_expert_mlp2&#45;&gt;layer8_gpu14_token_send -->
<g id="edge937" class="edge">
<title>layer8_gpu14_expert_mlp2&#45;&gt;layer8_gpu14_token_send</title>
<path fill="none" stroke="black" d="M10567.44,-13903.4C10568.77,-13895.32 10570.22,-13886.45 10571.67,-13877.61"/>
<polygon fill="black" stroke="black" points="10575.13,-13878.12 10573.29,-13867.69 10568.22,-13876.99 10575.13,-13878.12"/>
</g>
<!-- layer8_gpu14_token_send&#45;&gt;layer8_expert_agg -->
<g id="edge938" class="edge">
<title>layer8_gpu14_token_send&#45;&gt;layer8_expert_agg</title>
<path fill="none" stroke="black" d="M10342.01,-13783.97C10300.41,-13779 10257.51,-13774.55 10217,-13771.5 9372.31,-13707.87 6820.75,-13679.95 5855.45,-13671.47"/>
<polygon fill="black" stroke="black" points="5855.26,-13667.97 5845.22,-13671.38 5855.19,-13674.97 5855.26,-13667.97"/>
</g>
<!-- layer8_gpu15_expert_mlp1 -->
<g id="node806" class="node">
<title>layer8_gpu15_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="11258.5,-14179.66 10797.5,-14179.66 10797.5,-14111.66 11258.5,-14111.66 11258.5,-14179.66"/>
<text text-anchor="middle" x="11028" y="-14164.46" font-family="Times,serif" font-size="14.00">Expert 15 MLP1</text>
<text text-anchor="middle" x="11028" y="-14149.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="11028" y="-14134.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11028" y="-14119.46" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer8_gpu15_token_recv&#45;&gt;layer8_gpu15_expert_mlp1 -->
<g id="edge940" class="edge">
<title>layer8_gpu15_token_recv&#45;&gt;layer8_gpu15_expert_mlp1</title>
<path fill="none" stroke="black" d="M11016.73,-14215.53C11018.12,-14207.05 11019.56,-14198.25 11020.92,-14189.9"/>
<polygon fill="black" stroke="black" points="11024.39,-14190.4 11022.55,-14179.97 11017.48,-14189.27 11024.39,-14190.4"/>
</g>
<!-- layer8_gpu15_expert_act -->
<g id="node807" class="node">
<title>layer8_gpu15_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="11254.5,-14075.66 10877.5,-14075.66 10877.5,-14007.66 11254.5,-14007.66 11254.5,-14075.66"/>
<text text-anchor="middle" x="11066" y="-14060.46" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="11066" y="-14045.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11066" y="-14030.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11066" y="-14015.46" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer8_gpu15_expert_mlp1&#45;&gt;layer8_gpu15_expert_act -->
<g id="edge941" class="edge">
<title>layer8_gpu15_expert_mlp1&#45;&gt;layer8_gpu15_expert_act</title>
<path fill="none" stroke="black" d="M11040.34,-14111.55C11043.42,-14103.26 11046.78,-14094.26 11050.01,-14085.58"/>
<polygon fill="black" stroke="black" points="11053.38,-14086.56 11053.59,-14075.96 11046.82,-14084.11 11053.38,-14086.56"/>
</g>
<!-- layer8_gpu15_expert_mlp2 -->
<g id="node808" class="node">
<title>layer8_gpu15_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="11273.5,-13971.66 10866.5,-13971.66 10866.5,-13903.66 11273.5,-13903.66 11273.5,-13971.66"/>
<text text-anchor="middle" x="11070" y="-13956.46" font-family="Times,serif" font-size="14.00">Expert 15 MLP2</text>
<text text-anchor="middle" x="11070" y="-13941.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11070" y="-13926.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="11070" y="-13911.46" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer8_gpu15_expert_act&#45;&gt;layer8_gpu15_expert_mlp2 -->
<g id="edge942" class="edge">
<title>layer8_gpu15_expert_act&#45;&gt;layer8_gpu15_expert_mlp2</title>
<path fill="none" stroke="black" d="M11067.3,-14007.55C11067.62,-13999.44 11067.96,-13990.65 11068.3,-13982.14"/>
<polygon fill="black" stroke="black" points="11071.8,-13982.09 11068.69,-13971.96 11064.8,-13981.82 11071.8,-13982.09"/>
</g>
<!-- layer8_gpu15_token_send -->
<g id="node809" class="node">
<title>layer8_gpu15_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="11310" cy="-13819.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="11310" y="-13838.38" font-family="Times,serif" font-size="14.00">Token Send GPU15</text>
<text text-anchor="middle" x="11310" y="-13823.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="11310" y="-13808.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="11310" y="-13793.38" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer8_gpu15_expert_mlp2&#45;&gt;layer8_gpu15_token_send -->
<g id="edge943" class="edge">
<title>layer8_gpu15_expert_mlp2&#45;&gt;layer8_gpu15_token_send</title>
<path fill="none" stroke="black" d="M11138.45,-13903.55C11159.74,-13893.26 11183.69,-13881.68 11206.79,-13870.5"/>
<polygon fill="black" stroke="black" points="11208.47,-13873.58 11215.94,-13866.07 11205.42,-13867.28 11208.47,-13873.58"/>
</g>
<!-- layer8_gpu15_token_send&#45;&gt;layer8_expert_agg -->
<g id="edge944" class="edge">
<title>layer8_gpu15_token_send&#45;&gt;layer8_expert_agg</title>
<path fill="none" stroke="black" d="M11071.02,-13783.87C11029.42,-13778.91 10986.51,-13774.49 10946,-13771.5 9953.22,-13698.16 6917.36,-13675.85 5853.26,-13670.19"/>
<polygon fill="black" stroke="black" points="5853.17,-13666.69 5843.15,-13670.13 5853.13,-13673.69 5853.17,-13666.69"/>
</g>
<!-- layer8_residual2 -->
<g id="node811" class="node">
<title>layer8_residual2</title>
<polygon fill="lightyellow" stroke="black" points="5922.89,-13563.5 5218.35,-13563.5 5037.11,-13427.5 5741.65,-13427.5 5922.89,-13563.5"/>
<text text-anchor="middle" x="5480" y="-13514.3" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="5480" y="-13499.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5480" y="-13484.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5480" y="-13469.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer8_expert_agg&#45;&gt;layer8_residual2 -->
<g id="edge945" class="edge">
<title>layer8_expert_agg&#45;&gt;layer8_residual2</title>
<path fill="none" stroke="black" d="M5480,-13599.31C5480,-13591 5480,-13582.44 5480,-13573.99"/>
<polygon fill="black" stroke="black" points="5483.5,-13573.75 5480,-13563.75 5476.5,-13573.76 5483.5,-13573.75"/>
</g>
<!-- layer9_layernorm -->
<g id="node812" class="node">
<title>layer9_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="5683.5,-13380.5 5276.5,-13380.5 5276.5,-13312.5 5683.5,-13312.5 5683.5,-13380.5"/>
<text text-anchor="middle" x="5480" y="-13365.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5480" y="-13350.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5480" y="-13335.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5480" y="-13320.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer8_residual2&#45;&gt;layer9_layernorm -->
<g id="edge946" class="edge">
<title>layer8_residual2&#45;&gt;layer9_layernorm</title>
<path fill="none" stroke="black" d="M5480,-13427.45C5480,-13415.04 5480,-13402.39 5480,-13390.92"/>
<polygon fill="black" stroke="black" points="5483.5,-13390.76 5480,-13380.76 5476.5,-13390.76 5483.5,-13390.76"/>
</g>
<!-- layer9_qkv_proj -->
<g id="node813" class="node">
<title>layer9_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="5737.5,-13276.5 5222.5,-13276.5 5222.5,-13208.5 5737.5,-13208.5 5737.5,-13276.5"/>
<text text-anchor="middle" x="5480" y="-13261.3" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5480" y="-13246.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5480" y="-13231.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5480" y="-13216.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer9_layernorm&#45;&gt;layer9_qkv_proj -->
<g id="edge947" class="edge">
<title>layer9_layernorm&#45;&gt;layer9_qkv_proj</title>
<path fill="none" stroke="black" d="M5480,-13312.38C5480,-13304.28 5480,-13295.48 5480,-13286.97"/>
<polygon fill="black" stroke="black" points="5483.5,-13286.8 5480,-13276.8 5476.5,-13286.8 5483.5,-13286.8"/>
</g>
<!-- layer9_attention -->
<g id="node814" class="node">
<title>layer9_attention</title>
<polygon fill="lightgreen" stroke="black" points="5731.5,-13172.5 5228.5,-13172.5 5228.5,-13104.5 5731.5,-13104.5 5731.5,-13172.5"/>
<text text-anchor="middle" x="5480" y="-13157.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5480" y="-13142.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5480" y="-13127.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5480" y="-13112.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer9_qkv_proj&#45;&gt;layer9_attention -->
<g id="edge948" class="edge">
<title>layer9_qkv_proj&#45;&gt;layer9_attention</title>
<path fill="none" stroke="black" d="M5480,-13208.38C5480,-13200.28 5480,-13191.48 5480,-13182.97"/>
<polygon fill="black" stroke="black" points="5483.5,-13182.8 5480,-13172.8 5476.5,-13182.8 5483.5,-13182.8"/>
</g>
<!-- layer9_attn_out -->
<g id="node815" class="node">
<title>layer9_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="5718.5,-13068.5 5241.5,-13068.5 5241.5,-13000.5 5718.5,-13000.5 5718.5,-13068.5"/>
<text text-anchor="middle" x="5480" y="-13053.3" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5480" y="-13038.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5480" y="-13023.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5480" y="-13008.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer9_attention&#45;&gt;layer9_attn_out -->
<g id="edge949" class="edge">
<title>layer9_attention&#45;&gt;layer9_attn_out</title>
<path fill="none" stroke="black" d="M5480,-13104.38C5480,-13096.28 5480,-13087.48 5480,-13078.97"/>
<polygon fill="black" stroke="black" points="5483.5,-13078.8 5480,-13068.8 5476.5,-13078.8 5483.5,-13078.8"/>
</g>
<!-- layer9_residual1 -->
<g id="node816" class="node">
<title>layer9_residual1</title>
<polygon fill="lightyellow" stroke="black" points="5922.89,-12964.5 5218.35,-12964.5 5037.11,-12828.5 5741.65,-12828.5 5922.89,-12964.5"/>
<text text-anchor="middle" x="5480" y="-12915.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5480" y="-12900.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5480" y="-12885.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5480" y="-12870.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer9_attn_out&#45;&gt;layer9_residual1 -->
<g id="edge950" class="edge">
<title>layer9_attn_out&#45;&gt;layer9_residual1</title>
<path fill="none" stroke="black" d="M5480,-13000.23C5480,-12992.4 5480,-12983.73 5480,-12974.85"/>
<polygon fill="black" stroke="black" points="5483.5,-12974.76 5480,-12964.76 5476.5,-12974.76 5483.5,-12974.76"/>
</g>
<!-- layer9_layernorm2 -->
<g id="node817" class="node">
<title>layer9_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="5683.5,-12792.5 5276.5,-12792.5 5276.5,-12724.5 5683.5,-12724.5 5683.5,-12792.5"/>
<text text-anchor="middle" x="5480" y="-12777.3" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5480" y="-12762.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5480" y="-12747.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5480" y="-12732.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer9_residual1&#45;&gt;layer9_layernorm2 -->
<g id="edge951" class="edge">
<title>layer9_residual1&#45;&gt;layer9_layernorm2</title>
<path fill="none" stroke="black" d="M5480,-12828.29C5480,-12819.54 5480,-12810.77 5480,-12802.57"/>
<polygon fill="black" stroke="black" points="5483.5,-12802.51 5480,-12792.51 5476.5,-12802.51 5483.5,-12802.51"/>
</g>
<!-- layer9_global_gate -->
<g id="node818" class="node">
<title>layer9_global_gate</title>
<polygon fill="lightgreen" stroke="black" points="5677.5,-12688.5 5282.5,-12688.5 5282.5,-12620.5 5677.5,-12620.5 5677.5,-12688.5"/>
<text text-anchor="middle" x="5480" y="-12673.3" font-family="Times,serif" font-size="14.00">Global Gate</text>
<text text-anchor="middle" x="5480" y="-12658.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5480" y="-12643.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, experts=64]</text>
<text text-anchor="middle" x="5480" y="-12628.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer9_layernorm2&#45;&gt;layer9_global_gate -->
<g id="edge952" class="edge">
<title>layer9_layernorm2&#45;&gt;layer9_global_gate</title>
<path fill="none" stroke="black" d="M5480,-12724.38C5480,-12716.28 5480,-12707.48 5480,-12698.97"/>
<polygon fill="black" stroke="black" points="5483.5,-12698.8 5480,-12688.8 5476.5,-12698.8 5483.5,-12698.8"/>
</g>
<!-- layer9_routing -->
<g id="node819" class="node">
<title>layer9_routing</title>
<polygon fill="lightyellow" stroke="black" points="5966.47,-12584.5 5192.6,-12584.5 4993.53,-12448.5 5767.4,-12448.5 5966.47,-12584.5"/>
<text text-anchor="middle" x="5480" y="-12535.3" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="5480" y="-12520.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5480" y="-12505.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5480" y="-12490.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer9_global_gate&#45;&gt;layer9_routing -->
<g id="edge953" class="edge">
<title>layer9_global_gate&#45;&gt;layer9_routing</title>
<path fill="none" stroke="black" d="M5480,-12620.23C5480,-12612.4 5480,-12603.73 5480,-12594.85"/>
<polygon fill="black" stroke="black" points="5483.5,-12594.76 5480,-12584.76 5476.5,-12594.76 5483.5,-12594.76"/>
</g>
<!-- layer9_gpu0_token_recv -->
<g id="node820" class="node">
<title>layer9_gpu0_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="495" cy="-12364.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="495" y="-12383.21" font-family="Times,serif" font-size="14.00">Token Receive GPU0</text>
<text text-anchor="middle" x="495" y="-12368.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="495" y="-12353.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="495" y="-12338.21" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer9_routing&#45;&gt;layer9_gpu0_token_recv -->
<g id="edge954" class="edge">
<title>layer9_routing&#45;&gt;layer9_gpu0_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5085.76,-12511.78C4126.27,-12501.91 1688.72,-12471.66 876,-12412.5 832.51,-12409.33 786.36,-12404.71 741.76,-12399.58"/>
<polygon fill="black" stroke="black" points="742,-12396.09 731.67,-12398.41 741.2,-12403.04 742,-12396.09"/>
</g>
<!-- layer9_gpu1_token_recv -->
<g id="node825" class="node">
<title>layer9_gpu1_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1219" cy="-12364.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1219" y="-12383.21" font-family="Times,serif" font-size="14.00">Token Receive GPU1</text>
<text text-anchor="middle" x="1219" y="-12368.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1219" y="-12353.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1219" y="-12338.21" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer9_routing&#45;&gt;layer9_gpu1_token_recv -->
<g id="edge960" class="edge">
<title>layer9_routing&#45;&gt;layer9_gpu1_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5083.32,-12509.96C4233.82,-12497.3 2261.7,-12463.32 1593,-12412.5 1551.3,-12409.33 1507.12,-12404.81 1464.29,-12399.81"/>
<polygon fill="black" stroke="black" points="1464.65,-12396.33 1454.31,-12398.63 1463.83,-12403.28 1464.65,-12396.33"/>
</g>
<!-- layer9_gpu2_token_recv -->
<g id="node830" class="node">
<title>layer9_gpu2_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1936" cy="-12364.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1936" y="-12383.21" font-family="Times,serif" font-size="14.00">Token Receive GPU2</text>
<text text-anchor="middle" x="1936" y="-12368.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1936" y="-12353.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1936" y="-12338.21" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer9_routing&#45;&gt;layer9_gpu2_token_recv -->
<g id="edge966" class="edge">
<title>layer9_routing&#45;&gt;layer9_gpu2_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5090.87,-12515.14C4490.2,-12511.83 3301.33,-12494.3 2296,-12412.5 2257.78,-12409.39 2217.38,-12405.1 2178.02,-12400.36"/>
<polygon fill="black" stroke="black" points="2178.38,-12396.88 2168.03,-12399.15 2177.54,-12403.83 2178.38,-12396.88"/>
</g>
<!-- layer9_gpu3_token_recv -->
<g id="node835" class="node">
<title>layer9_gpu3_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="2639" cy="-12364.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2639" y="-12383.21" font-family="Times,serif" font-size="14.00">Token Receive GPU3</text>
<text text-anchor="middle" x="2639" y="-12368.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="2639" y="-12353.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2639" y="-12338.21" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer9_routing&#45;&gt;layer9_gpu3_token_recv -->
<g id="edge972" class="edge">
<title>layer9_routing&#45;&gt;layer9_gpu3_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5081.29,-12508.5C4595.09,-12497.72 3748.58,-12471.71 3025,-12412.5 2981.29,-12408.92 2934.91,-12404.13 2890.02,-12398.97"/>
<polygon fill="black" stroke="black" points="2890.2,-12395.46 2879.87,-12397.79 2889.4,-12402.42 2890.2,-12395.46"/>
</g>
<!-- layer9_gpu4_token_recv -->
<g id="node840" class="node">
<title>layer9_gpu4_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="3368" cy="-12364.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="3368" y="-12383.21" font-family="Times,serif" font-size="14.00">Token Receive GPU4</text>
<text text-anchor="middle" x="3368" y="-12368.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="3368" y="-12353.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3368" y="-12338.21" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer9_routing&#45;&gt;layer9_gpu4_token_recv -->
<g id="edge978" class="edge">
<title>layer9_routing&#45;&gt;layer9_gpu4_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5067.72,-12499.27C4713.33,-12483.39 4188.82,-12455.28 3733,-12412.5 3694.73,-12408.91 3654.3,-12404.4 3614.83,-12399.61"/>
<polygon fill="black" stroke="black" points="3615.17,-12396.13 3604.82,-12398.39 3614.32,-12403.08 3615.17,-12396.13"/>
</g>
<!-- layer9_gpu5_token_recv -->
<g id="node845" class="node">
<title>layer9_gpu5_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4076" cy="-12364.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4076" y="-12383.21" font-family="Times,serif" font-size="14.00">Token Receive GPU5</text>
<text text-anchor="middle" x="4076" y="-12368.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4076" y="-12353.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4076" y="-12338.21" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer9_routing&#45;&gt;layer9_gpu5_token_recv -->
<g id="edge984" class="edge">
<title>layer9_routing&#45;&gt;layer9_gpu5_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5032.36,-12475.19C4845.4,-12457.44 4626.02,-12435.43 4428,-12412.5 4394.28,-12408.59 4358.77,-12404.19 4323.82,-12399.68"/>
<polygon fill="black" stroke="black" points="4323.85,-12396.16 4313.48,-12398.34 4322.95,-12403.1 4323.85,-12396.16"/>
</g>
<!-- layer9_gpu6_token_recv -->
<g id="node850" class="node">
<title>layer9_gpu6_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4771" cy="-12364.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4771" y="-12383.21" font-family="Times,serif" font-size="14.00">Token Receive GPU6</text>
<text text-anchor="middle" x="4771" y="-12368.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4771" y="-12353.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4771" y="-12338.21" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer9_routing&#45;&gt;layer9_gpu6_token_recv -->
<g id="edge990" class="edge">
<title>layer9_routing&#45;&gt;layer9_gpu6_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5163.34,-12448.47C5096.06,-12434.22 5026.94,-12419.59 4965.82,-12406.65"/>
<polygon fill="black" stroke="black" points="4966.19,-12403.16 4955.69,-12404.51 4964.74,-12410 4966.19,-12403.16"/>
</g>
<!-- layer9_gpu7_token_recv -->
<g id="node855" class="node">
<title>layer9_gpu7_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="5479" cy="-12364.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="5479" y="-12383.21" font-family="Times,serif" font-size="14.00">Token Receive GPU7</text>
<text text-anchor="middle" x="5479" y="-12368.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5479" y="-12353.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5479" y="-12338.21" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer9_routing&#45;&gt;layer9_gpu7_token_recv -->
<g id="edge996" class="edge">
<title>layer9_routing&#45;&gt;layer9_gpu7_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5479.55,-12448.36C5479.5,-12439.81 5479.44,-12431.13 5479.38,-12422.76"/>
<polygon fill="black" stroke="black" points="5482.88,-12422.71 5479.32,-12412.73 5475.88,-12422.75 5482.88,-12422.71"/>
</g>
<!-- layer9_gpu8_token_recv -->
<g id="node860" class="node">
<title>layer9_gpu8_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6166" cy="-12364.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6166" y="-12383.21" font-family="Times,serif" font-size="14.00">Token Receive GPU8</text>
<text text-anchor="middle" x="6166" y="-12368.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6166" y="-12353.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6166" y="-12338.21" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer9_routing&#45;&gt;layer9_gpu8_token_recv -->
<g id="edge1002" class="edge">
<title>layer9_routing&#45;&gt;layer9_gpu8_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5772.42,-12451.52C5841.08,-12436.5 5912.51,-12420.87 5975.37,-12407.12"/>
<polygon fill="black" stroke="black" points="5976.36,-12410.49 5985.38,-12404.93 5974.87,-12403.65 5976.36,-12410.49"/>
</g>
<!-- layer9_gpu9_token_recv -->
<g id="node865" class="node">
<title>layer9_gpu9_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6853" cy="-12364.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6853" y="-12383.21" font-family="Times,serif" font-size="14.00">Token Receive GPU9</text>
<text text-anchor="middle" x="6853" y="-12368.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6853" y="-12353.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6853" y="-12338.21" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_routing&#45;&gt;layer9_gpu9_token_recv -->
<g id="edge1008" class="edge">
<title>layer9_routing&#45;&gt;layer9_gpu9_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5820.41,-12484.55C6021.02,-12465.53 6279.67,-12439.66 6509,-12412.5 6541.01,-12408.71 6574.65,-12404.45 6607.85,-12400.08"/>
<polygon fill="black" stroke="black" points="6608.68,-12403.5 6618.14,-12398.72 6607.76,-12396.56 6608.68,-12403.5"/>
</g>
<!-- layer9_gpu10_token_recv -->
<g id="node870" class="node">
<title>layer9_gpu10_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="7540" cy="-12364.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="7540" y="-12383.21" font-family="Times,serif" font-size="14.00">Token Receive GPU10</text>
<text text-anchor="middle" x="7540" y="-12368.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="7540" y="-12353.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7540" y="-12338.21" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer9_routing&#45;&gt;layer9_gpu10_token_recv -->
<g id="edge1014" class="edge">
<title>layer9_routing&#45;&gt;layer9_gpu10_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5845.51,-12501.62C6193.35,-12486.51 6731.16,-12458.19 7196,-12412.5 7229.58,-12409.2 7264.92,-12405.09 7299.65,-12400.68"/>
<polygon fill="black" stroke="black" points="7300.44,-12404.11 7309.91,-12399.37 7299.55,-12397.17 7300.44,-12404.11"/>
</g>
<!-- layer9_gpu11_token_recv -->
<g id="node875" class="node">
<title>layer9_gpu11_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8227" cy="-12364.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8227" y="-12383.21" font-family="Times,serif" font-size="14.00">Token Receive GPU11</text>
<text text-anchor="middle" x="8227" y="-12368.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8227" y="-12353.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8227" y="-12338.21" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer9_routing&#45;&gt;layer9_gpu11_token_recv -->
<g id="edge1020" class="edge">
<title>layer9_routing&#45;&gt;layer9_gpu11_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5857.91,-12510.18C6331.85,-12501 7168.95,-12476.53 7883,-12412.5 7917.3,-12409.42 7953.42,-12405.37 7988.84,-12400.94"/>
<polygon fill="black" stroke="black" points="7989.33,-12404.41 7998.82,-12399.68 7988.46,-12397.46 7989.33,-12404.41"/>
</g>
<!-- layer9_gpu12_token_recv -->
<g id="node880" class="node">
<title>layer9_gpu12_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8914" cy="-12364.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8914" y="-12383.21" font-family="Times,serif" font-size="14.00">Token Receive GPU12</text>
<text text-anchor="middle" x="8914" y="-12368.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8914" y="-12353.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8914" y="-12338.21" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer9_routing&#45;&gt;layer9_gpu12_token_recv -->
<g id="edge1026" class="edge">
<title>layer9_routing&#45;&gt;layer9_gpu12_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5865.53,-12515.34C6451,-12512.24 7598.94,-12494.92 8570,-12412.5 8604.73,-12409.55 8641.31,-12405.53 8677.15,-12401.08"/>
<polygon fill="black" stroke="black" points="8677.74,-12404.53 8687.23,-12399.81 8676.87,-12397.59 8677.74,-12404.53"/>
</g>
<!-- layer9_gpu13_token_recv -->
<g id="node885" class="node">
<title>layer9_gpu13_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="9601" cy="-12364.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="9601" y="-12383.21" font-family="Times,serif" font-size="14.00">Token Receive GPU13</text>
<text text-anchor="middle" x="9601" y="-12368.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="9601" y="-12353.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9601" y="-12338.21" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer9_routing&#45;&gt;layer9_gpu13_token_recv -->
<g id="edge1032" class="edge">
<title>layer9_routing&#45;&gt;layer9_gpu13_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5858.13,-12510.42C6679.58,-12498.53 8605.56,-12465.8 9257,-12412.5 9292.01,-12409.63 9328.9,-12405.63 9365.01,-12401.16"/>
<polygon fill="black" stroke="black" points="9365.68,-12404.61 9375.17,-12399.89 9364.81,-12397.66 9365.68,-12404.61"/>
</g>
<!-- layer9_gpu14_token_recv -->
<g id="node890" class="node">
<title>layer9_gpu14_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10304" cy="-12364.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10304" y="-12383.21" font-family="Times,serif" font-size="14.00">Token Receive GPU14</text>
<text text-anchor="middle" x="10304" y="-12368.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10304" y="-12353.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10304" y="-12338.21" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer9_routing&#45;&gt;layer9_gpu14_token_recv -->
<g id="edge1038" class="edge">
<title>layer9_routing&#45;&gt;layer9_gpu14_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5860.57,-12511.96C6789.76,-12502.46 9155.73,-12472.97 9944,-12412.5 9982.67,-12409.53 10023.56,-12405.27 10063.35,-12400.51"/>
<polygon fill="black" stroke="black" points="10063.93,-12403.96 10073.44,-12399.29 10063.09,-12397.01 10063.93,-12403.96"/>
</g>
<!-- layer9_gpu15_token_recv -->
<g id="node895" class="node">
<title>layer9_gpu15_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10999" cy="-12364.41" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10999" y="-12383.21" font-family="Times,serif" font-size="14.00">Token Receive GPU15</text>
<text text-anchor="middle" x="10999" y="-12368.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10999" y="-12353.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10999" y="-12338.21" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer9_routing&#45;&gt;layer9_gpu15_token_recv -->
<g id="edge1044" class="edge">
<title>layer9_routing&#45;&gt;layer9_gpu15_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5862.89,-12513.48C6894.72,-12507.16 9717.87,-12483.67 10647,-12412.5 10683.96,-12409.67 10722.98,-12405.57 10761.05,-12400.95"/>
<polygon fill="black" stroke="black" points="10761.73,-12404.4 10771.23,-12399.7 10760.88,-12397.45 10761.73,-12404.4"/>
</g>
<!-- layer9_gpu0_expert_mlp1 -->
<g id="node821" class="node">
<title>layer9_gpu0_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="704.5,-12280.33 243.5,-12280.33 243.5,-12212.33 704.5,-12212.33 704.5,-12280.33"/>
<text text-anchor="middle" x="474" y="-12265.13" font-family="Times,serif" font-size="14.00">Expert 0 MLP1</text>
<text text-anchor="middle" x="474" y="-12250.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="474" y="-12235.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="474" y="-12220.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer9_gpu0_token_recv&#45;&gt;layer9_gpu0_expert_mlp1 -->
<g id="edge955" class="edge">
<title>layer9_gpu0_token_recv&#45;&gt;layer9_gpu0_expert_mlp1</title>
<path fill="none" stroke="black" d="M486.46,-12316.2C484.92,-12307.72 483.33,-12298.92 481.82,-12290.56"/>
<polygon fill="black" stroke="black" points="485.25,-12289.85 480.02,-12280.63 478.36,-12291.1 485.25,-12289.85"/>
</g>
<!-- layer9_gpu0_expert_act -->
<g id="node822" class="node">
<title>layer9_gpu0_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="641.5,-12176.33 264.5,-12176.33 264.5,-12108.33 641.5,-12108.33 641.5,-12176.33"/>
<text text-anchor="middle" x="453" y="-12161.13" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="453" y="-12146.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="453" y="-12131.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="453" y="-12116.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer9_gpu0_expert_mlp1&#45;&gt;layer9_gpu0_expert_act -->
<g id="edge956" class="edge">
<title>layer9_gpu0_expert_mlp1&#45;&gt;layer9_gpu0_expert_act</title>
<path fill="none" stroke="black" d="M467.18,-12212.21C465.49,-12204.02 463.66,-12195.12 461.89,-12186.52"/>
<polygon fill="black" stroke="black" points="465.3,-12185.72 459.86,-12176.63 458.44,-12187.13 465.3,-12185.72"/>
</g>
<!-- layer9_gpu0_expert_mlp2 -->
<g id="node823" class="node">
<title>layer9_gpu0_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="619.5,-12072.33 212.5,-12072.33 212.5,-12004.33 619.5,-12004.33 619.5,-12072.33"/>
<text text-anchor="middle" x="416" y="-12057.13" font-family="Times,serif" font-size="14.00">Expert 0 MLP2</text>
<text text-anchor="middle" x="416" y="-12042.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="416" y="-12027.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="416" y="-12012.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer9_gpu0_expert_act&#45;&gt;layer9_gpu0_expert_mlp2 -->
<g id="edge957" class="edge">
<title>layer9_gpu0_expert_act&#45;&gt;layer9_gpu0_expert_mlp2</title>
<path fill="none" stroke="black" d="M440.99,-12108.21C437.98,-12099.93 434.72,-12090.93 431.57,-12082.24"/>
<polygon fill="black" stroke="black" points="434.78,-12080.84 428.08,-12072.63 428.2,-12083.22 434.78,-12080.84"/>
</g>
<!-- layer9_gpu0_token_send -->
<g id="node824" class="node">
<title>layer9_gpu0_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="372" cy="-11920.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="372" y="-11939.05" font-family="Times,serif" font-size="14.00">Token Send GPU0</text>
<text text-anchor="middle" x="372" y="-11924.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="372" y="-11909.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="372" y="-11894.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer9_gpu0_expert_mlp2&#45;&gt;layer9_gpu0_token_send -->
<g id="edge958" class="edge">
<title>layer9_gpu0_expert_mlp2&#45;&gt;layer9_gpu0_token_send</title>
<path fill="none" stroke="black" d="M403.39,-12004.07C400.26,-11995.81 396.82,-11986.74 393.4,-11977.71"/>
<polygon fill="black" stroke="black" points="396.67,-11976.47 389.86,-11968.36 390.13,-11978.95 396.67,-11976.47"/>
</g>
<!-- layer9_expert_agg -->
<g id="node900" class="node">
<title>layer9_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="5927.05,-11836.16 5207.94,-11836.16 5022.95,-11700.16 5742.06,-11700.16 5927.05,-11836.16"/>
<text text-anchor="middle" x="5475" y="-11786.96" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5475" y="-11771.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x16)</text>
<text text-anchor="middle" x="5475" y="-11756.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5475" y="-11741.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer9_gpu0_token_send&#45;&gt;layer9_expert_agg -->
<g id="edge959" class="edge">
<title>layer9_gpu0_token_send&#45;&gt;layer9_expert_agg</title>
<path fill="none" stroke="black" d="M610.99,-11884.63C652.59,-11879.67 695.49,-11875.22 736,-11872.16 1584.24,-11808.27 4153,-11780.4 5110.27,-11772.04"/>
<polygon fill="black" stroke="black" points="5110.44,-11775.54 5120.41,-11771.95 5110.38,-11768.54 5110.44,-11775.54"/>
</g>
<!-- layer9_gpu1_expert_mlp1 -->
<g id="node826" class="node">
<title>layer9_gpu1_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="1428.5,-12280.33 967.5,-12280.33 967.5,-12212.33 1428.5,-12212.33 1428.5,-12280.33"/>
<text text-anchor="middle" x="1198" y="-12265.13" font-family="Times,serif" font-size="14.00">Expert 1 MLP1</text>
<text text-anchor="middle" x="1198" y="-12250.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1198" y="-12235.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1198" y="-12220.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer9_gpu1_token_recv&#45;&gt;layer9_gpu1_expert_mlp1 -->
<g id="edge961" class="edge">
<title>layer9_gpu1_token_recv&#45;&gt;layer9_gpu1_expert_mlp1</title>
<path fill="none" stroke="black" d="M1210.46,-12316.2C1208.92,-12307.72 1207.33,-12298.92 1205.82,-12290.56"/>
<polygon fill="black" stroke="black" points="1209.25,-12289.85 1204.02,-12280.63 1202.36,-12291.1 1209.25,-12289.85"/>
</g>
<!-- layer9_gpu1_expert_act -->
<g id="node827" class="node">
<title>layer9_gpu1_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="1360.5,-12176.33 983.5,-12176.33 983.5,-12108.33 1360.5,-12108.33 1360.5,-12176.33"/>
<text text-anchor="middle" x="1172" y="-12161.13" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1172" y="-12146.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1172" y="-12131.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1172" y="-12116.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer9_gpu1_expert_mlp1&#45;&gt;layer9_gpu1_expert_act -->
<g id="edge962" class="edge">
<title>layer9_gpu1_expert_mlp1&#45;&gt;layer9_gpu1_expert_act</title>
<path fill="none" stroke="black" d="M1189.56,-12212.21C1187.47,-12204.02 1185.2,-12195.12 1183.01,-12186.52"/>
<polygon fill="black" stroke="black" points="1186.35,-12185.46 1180.49,-12176.63 1179.57,-12187.19 1186.35,-12185.46"/>
</g>
<!-- layer9_gpu1_expert_mlp2 -->
<g id="node828" class="node">
<title>layer9_gpu1_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="1346.5,-12072.33 939.5,-12072.33 939.5,-12004.33 1346.5,-12004.33 1346.5,-12072.33"/>
<text text-anchor="middle" x="1143" y="-12057.13" font-family="Times,serif" font-size="14.00">Expert 1 MLP2</text>
<text text-anchor="middle" x="1143" y="-12042.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1143" y="-12027.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1143" y="-12012.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer9_gpu1_expert_act&#45;&gt;layer9_gpu1_expert_mlp2 -->
<g id="edge963" class="edge">
<title>layer9_gpu1_expert_act&#45;&gt;layer9_gpu1_expert_mlp2</title>
<path fill="none" stroke="black" d="M1162.58,-12108.21C1160.25,-12100.02 1157.72,-12091.12 1155.28,-12082.52"/>
<polygon fill="black" stroke="black" points="1158.57,-12081.29 1152.47,-12072.63 1151.84,-12083.21 1158.57,-12081.29"/>
</g>
<!-- layer9_gpu1_token_send -->
<g id="node829" class="node">
<title>layer9_gpu1_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1101" cy="-11920.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1101" y="-11939.05" font-family="Times,serif" font-size="14.00">Token Send GPU1</text>
<text text-anchor="middle" x="1101" y="-11924.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1101" y="-11909.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1101" y="-11894.05" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer9_gpu1_expert_mlp2&#45;&gt;layer9_gpu1_token_send -->
<g id="edge964" class="edge">
<title>layer9_gpu1_expert_mlp2&#45;&gt;layer9_gpu1_token_send</title>
<path fill="none" stroke="black" d="M1130.96,-12004.07C1128.01,-11995.9 1124.76,-11986.93 1121.53,-11977.99"/>
<polygon fill="black" stroke="black" points="1124.74,-11976.57 1118.04,-11968.36 1118.16,-11978.95 1124.74,-11976.57"/>
</g>
<!-- layer9_gpu1_token_send&#45;&gt;layer9_expert_agg -->
<g id="edge965" class="edge">
<title>layer9_gpu1_token_send&#45;&gt;layer9_expert_agg</title>
<path fill="none" stroke="black" d="M1340.98,-11884.65C1382.27,-11879.72 1424.82,-11875.27 1465,-11872.16 2167.35,-11817.87 4263.91,-11785.06 5112.48,-11773.69"/>
<polygon fill="black" stroke="black" points="5112.76,-11777.19 5122.72,-11773.55 5112.67,-11770.19 5112.76,-11777.19"/>
</g>
<!-- layer9_gpu2_expert_mlp1 -->
<g id="node831" class="node">
<title>layer9_gpu2_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2135.5,-12280.33 1674.5,-12280.33 1674.5,-12212.33 2135.5,-12212.33 2135.5,-12280.33"/>
<text text-anchor="middle" x="1905" y="-12265.13" font-family="Times,serif" font-size="14.00">Expert 2 MLP1</text>
<text text-anchor="middle" x="1905" y="-12250.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1905" y="-12235.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1905" y="-12220.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer9_gpu2_token_recv&#45;&gt;layer9_gpu2_expert_mlp1 -->
<g id="edge967" class="edge">
<title>layer9_gpu2_token_recv&#45;&gt;layer9_gpu2_expert_mlp1</title>
<path fill="none" stroke="black" d="M1923.39,-12316.2C1921.13,-12307.72 1918.78,-12298.92 1916.54,-12290.56"/>
<polygon fill="black" stroke="black" points="1919.86,-12289.39 1913.89,-12280.63 1913.09,-12291.2 1919.86,-12289.39"/>
</g>
<!-- layer9_gpu2_expert_act -->
<g id="node832" class="node">
<title>layer9_gpu2_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2062.5,-12176.33 1685.5,-12176.33 1685.5,-12108.33 2062.5,-12108.33 2062.5,-12176.33"/>
<text text-anchor="middle" x="1874" y="-12161.13" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="1874" y="-12146.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1874" y="-12131.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1874" y="-12116.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer9_gpu2_expert_mlp1&#45;&gt;layer9_gpu2_expert_act -->
<g id="edge968" class="edge">
<title>layer9_gpu2_expert_mlp1&#45;&gt;layer9_gpu2_expert_act</title>
<path fill="none" stroke="black" d="M1894.94,-12212.21C1892.42,-12203.93 1889.68,-12194.93 1887.04,-12186.24"/>
<polygon fill="black" stroke="black" points="1890.38,-12185.18 1884.12,-12176.63 1883.68,-12187.22 1890.38,-12185.18"/>
</g>
<!-- layer9_gpu2_expert_mlp2 -->
<g id="node833" class="node">
<title>layer9_gpu2_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2061.5,-12072.33 1654.5,-12072.33 1654.5,-12004.33 2061.5,-12004.33 2061.5,-12072.33"/>
<text text-anchor="middle" x="1858" y="-12057.13" font-family="Times,serif" font-size="14.00">Expert 2 MLP2</text>
<text text-anchor="middle" x="1858" y="-12042.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1858" y="-12027.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1858" y="-12012.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer9_gpu2_expert_act&#45;&gt;layer9_gpu2_expert_mlp2 -->
<g id="edge969" class="edge">
<title>layer9_gpu2_expert_act&#45;&gt;layer9_gpu2_expert_mlp2</title>
<path fill="none" stroke="black" d="M1868.81,-12108.21C1867.52,-12100.02 1866.12,-12091.12 1864.78,-12082.52"/>
<polygon fill="black" stroke="black" points="1868.23,-12081.97 1863.22,-12072.63 1861.32,-12083.05 1868.23,-12081.97"/>
</g>
<!-- layer9_gpu2_token_send -->
<g id="node834" class="node">
<title>layer9_gpu2_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1830" cy="-11920.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1830" y="-11939.05" font-family="Times,serif" font-size="14.00">Token Send GPU2</text>
<text text-anchor="middle" x="1830" y="-11924.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1830" y="-11909.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1830" y="-11894.05" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer9_gpu2_expert_mlp2&#45;&gt;layer9_gpu2_token_send -->
<g id="edge970" class="edge">
<title>layer9_gpu2_expert_mlp2&#45;&gt;layer9_gpu2_token_send</title>
<path fill="none" stroke="black" d="M1849.98,-12004.07C1848.03,-11995.99 1845.89,-11987.12 1843.76,-11978.28"/>
<polygon fill="black" stroke="black" points="1847.11,-11977.26 1841.36,-11968.36 1840.31,-11978.9 1847.11,-11977.26"/>
</g>
<!-- layer9_gpu2_token_send&#45;&gt;layer9_expert_agg -->
<g id="edge971" class="edge">
<title>layer9_gpu2_token_send&#45;&gt;layer9_expert_agg</title>
<path fill="none" stroke="black" d="M2070.48,-11884.79C2111.62,-11879.85 2153.98,-11875.37 2194,-11872.16 3248.39,-11787.62 4498.58,-11771.53 5106.38,-11769.07"/>
<polygon fill="black" stroke="black" points="5106.63,-11772.57 5116.61,-11769.03 5106.6,-11765.57 5106.63,-11772.57"/>
</g>
<!-- layer9_gpu3_expert_mlp1 -->
<g id="node836" class="node">
<title>layer9_gpu3_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2850.5,-12280.33 2389.5,-12280.33 2389.5,-12212.33 2850.5,-12212.33 2850.5,-12280.33"/>
<text text-anchor="middle" x="2620" y="-12265.13" font-family="Times,serif" font-size="14.00">Expert 3 MLP1</text>
<text text-anchor="middle" x="2620" y="-12250.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2620" y="-12235.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2620" y="-12220.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer9_gpu3_token_recv&#45;&gt;layer9_gpu3_expert_mlp1 -->
<g id="edge973" class="edge">
<title>layer9_gpu3_token_recv&#45;&gt;layer9_gpu3_expert_mlp1</title>
<path fill="none" stroke="black" d="M2631.27,-12316.2C2629.88,-12307.72 2628.44,-12298.92 2627.08,-12290.56"/>
<polygon fill="black" stroke="black" points="2630.52,-12289.94 2625.45,-12280.63 2623.61,-12291.07 2630.52,-12289.94"/>
</g>
<!-- layer9_gpu3_expert_act -->
<g id="node837" class="node">
<title>layer9_gpu3_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2798.5,-12176.33 2421.5,-12176.33 2421.5,-12108.33 2798.5,-12108.33 2798.5,-12176.33"/>
<text text-anchor="middle" x="2610" y="-12161.13" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="2610" y="-12146.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2610" y="-12131.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2610" y="-12116.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer9_gpu3_expert_mlp1&#45;&gt;layer9_gpu3_expert_act -->
<g id="edge974" class="edge">
<title>layer9_gpu3_expert_mlp1&#45;&gt;layer9_gpu3_expert_act</title>
<path fill="none" stroke="black" d="M2616.75,-12212.21C2615.96,-12204.11 2615.1,-12195.31 2614.26,-12186.8"/>
<polygon fill="black" stroke="black" points="2617.72,-12186.24 2613.26,-12176.63 2610.76,-12186.92 2617.72,-12186.24"/>
</g>
<!-- layer9_gpu3_expert_mlp2 -->
<g id="node838" class="node">
<title>layer9_gpu3_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2795.5,-12072.33 2388.5,-12072.33 2388.5,-12004.33 2795.5,-12004.33 2795.5,-12072.33"/>
<text text-anchor="middle" x="2592" y="-12057.13" font-family="Times,serif" font-size="14.00">Expert 3 MLP2</text>
<text text-anchor="middle" x="2592" y="-12042.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2592" y="-12027.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="2592" y="-12012.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer9_gpu3_expert_act&#45;&gt;layer9_gpu3_expert_mlp2 -->
<g id="edge975" class="edge">
<title>layer9_gpu3_expert_act&#45;&gt;layer9_gpu3_expert_mlp2</title>
<path fill="none" stroke="black" d="M2604.16,-12108.21C2602.71,-12100.02 2601.14,-12091.12 2599.62,-12082.52"/>
<polygon fill="black" stroke="black" points="2603.06,-12081.87 2597.88,-12072.63 2596.17,-12083.09 2603.06,-12081.87"/>
</g>
<!-- layer9_gpu3_token_send -->
<g id="node839" class="node">
<title>layer9_gpu3_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="2559" cy="-11920.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="2559" y="-11939.05" font-family="Times,serif" font-size="14.00">Token Send GPU3</text>
<text text-anchor="middle" x="2559" y="-11924.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="2559" y="-11909.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="2559" y="-11894.05" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer9_gpu3_expert_mlp2&#45;&gt;layer9_gpu3_token_send -->
<g id="edge976" class="edge">
<title>layer9_gpu3_expert_mlp2&#45;&gt;layer9_gpu3_token_send</title>
<path fill="none" stroke="black" d="M2582.54,-12004.07C2580.22,-11995.9 2577.67,-11986.93 2575.13,-11977.99"/>
<polygon fill="black" stroke="black" points="2578.49,-11977.02 2572.39,-11968.36 2571.76,-11978.93 2578.49,-11977.02"/>
</g>
<!-- layer9_gpu3_token_send&#45;&gt;layer9_expert_agg -->
<g id="edge977" class="edge">
<title>layer9_gpu3_token_send&#45;&gt;layer9_expert_agg</title>
<path fill="none" stroke="black" d="M2800.98,-11884.91C2841.65,-11880.02 2883.48,-11875.51 2923,-11872.16 3701.48,-11806.24 4617.25,-11782.27 5112.56,-11773.73"/>
<polygon fill="black" stroke="black" points="5112.79,-11777.23 5122.73,-11773.56 5112.67,-11770.23 5112.79,-11777.23"/>
</g>
<!-- layer9_gpu4_expert_mlp1 -->
<g id="node841" class="node">
<title>layer9_gpu4_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="3588.5,-12280.33 3127.5,-12280.33 3127.5,-12212.33 3588.5,-12212.33 3588.5,-12280.33"/>
<text text-anchor="middle" x="3358" y="-12265.13" font-family="Times,serif" font-size="14.00">Expert 4 MLP1</text>
<text text-anchor="middle" x="3358" y="-12250.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3358" y="-12235.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3358" y="-12220.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer9_gpu4_token_recv&#45;&gt;layer9_gpu4_expert_mlp1 -->
<g id="edge979" class="edge">
<title>layer9_gpu4_token_recv&#45;&gt;layer9_gpu4_expert_mlp1</title>
<path fill="none" stroke="black" d="M3363.93,-12316.2C3363.21,-12307.81 3362.46,-12299.12 3361.75,-12290.84"/>
<polygon fill="black" stroke="black" points="3365.21,-12290.3 3360.87,-12280.63 3358.24,-12290.9 3365.21,-12290.3"/>
</g>
<!-- layer9_gpu4_expert_act -->
<g id="node842" class="node">
<title>layer9_gpu4_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="3541.5,-12176.33 3164.5,-12176.33 3164.5,-12108.33 3541.5,-12108.33 3541.5,-12176.33"/>
<text text-anchor="middle" x="3353" y="-12161.13" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="3353" y="-12146.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3353" y="-12131.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3353" y="-12116.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer9_gpu4_expert_mlp1&#45;&gt;layer9_gpu4_expert_act -->
<g id="edge980" class="edge">
<title>layer9_gpu4_expert_mlp1&#45;&gt;layer9_gpu4_expert_act</title>
<path fill="none" stroke="black" d="M3356.38,-12212.21C3355.98,-12204.11 3355.55,-12195.31 3355.13,-12186.8"/>
<polygon fill="black" stroke="black" points="3358.62,-12186.45 3354.63,-12176.63 3351.63,-12186.79 3358.62,-12186.45"/>
</g>
<!-- layer9_gpu4_expert_mlp2 -->
<g id="node843" class="node">
<title>layer9_gpu4_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="3521.5,-12072.33 3114.5,-12072.33 3114.5,-12004.33 3521.5,-12004.33 3521.5,-12072.33"/>
<text text-anchor="middle" x="3318" y="-12057.13" font-family="Times,serif" font-size="14.00">Expert 4 MLP2</text>
<text text-anchor="middle" x="3318" y="-12042.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3318" y="-12027.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="3318" y="-12012.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer9_gpu4_expert_act&#45;&gt;layer9_gpu4_expert_mlp2 -->
<g id="edge981" class="edge">
<title>layer9_gpu4_expert_act&#45;&gt;layer9_gpu4_expert_mlp2</title>
<path fill="none" stroke="black" d="M3341.64,-12108.21C3338.79,-12099.93 3335.7,-12090.93 3332.72,-12082.24"/>
<polygon fill="black" stroke="black" points="3335.98,-12080.95 3329.43,-12072.63 3329.36,-12083.23 3335.98,-12080.95"/>
</g>
<!-- layer9_gpu4_token_send -->
<g id="node844" class="node">
<title>layer9_gpu4_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="3288" cy="-11920.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="3288" y="-11939.05" font-family="Times,serif" font-size="14.00">Token Send GPU4</text>
<text text-anchor="middle" x="3288" y="-11924.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="3288" y="-11909.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="3288" y="-11894.05" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer9_gpu4_expert_mlp2&#45;&gt;layer9_gpu4_token_send -->
<g id="edge982" class="edge">
<title>layer9_gpu4_expert_mlp2&#45;&gt;layer9_gpu4_token_send</title>
<path fill="none" stroke="black" d="M3309.4,-12004.07C3307.31,-11995.99 3305.02,-11987.12 3302.74,-11978.28"/>
<polygon fill="black" stroke="black" points="3306.07,-11977.16 3300.17,-11968.36 3299.29,-11978.92 3306.07,-11977.16"/>
</g>
<!-- layer9_gpu4_token_send&#45;&gt;layer9_expert_agg -->
<g id="edge983" class="edge">
<title>layer9_gpu4_token_send&#45;&gt;layer9_expert_agg</title>
<path fill="none" stroke="black" d="M3531.99,-11885.22C3572.04,-11880.35 3613.14,-11875.77 3652,-11872.16 4162.43,-11824.79 4755.44,-11796.17 5123.01,-11781.51"/>
<polygon fill="black" stroke="black" points="5123.15,-11785.01 5133,-11781.11 5122.87,-11778.01 5123.15,-11785.01"/>
</g>
<!-- layer9_gpu5_expert_mlp1 -->
<g id="node846" class="node">
<title>layer9_gpu5_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4290.5,-12280.33 3829.5,-12280.33 3829.5,-12212.33 4290.5,-12212.33 4290.5,-12280.33"/>
<text text-anchor="middle" x="4060" y="-12265.13" font-family="Times,serif" font-size="14.00">Expert 5 MLP1</text>
<text text-anchor="middle" x="4060" y="-12250.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4060" y="-12235.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4060" y="-12220.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer9_gpu5_token_recv&#45;&gt;layer9_gpu5_expert_mlp1 -->
<g id="edge985" class="edge">
<title>layer9_gpu5_token_recv&#45;&gt;layer9_gpu5_expert_mlp1</title>
<path fill="none" stroke="black" d="M4069.49,-12316.2C4068.32,-12307.72 4067.11,-12298.92 4065.96,-12290.56"/>
<polygon fill="black" stroke="black" points="4069.42,-12290.06 4064.59,-12280.63 4062.49,-12291.02 4069.42,-12290.06"/>
</g>
<!-- layer9_gpu5_expert_act -->
<g id="node847" class="node">
<title>layer9_gpu5_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4217.5,-12176.33 3840.5,-12176.33 3840.5,-12108.33 4217.5,-12108.33 4217.5,-12176.33"/>
<text text-anchor="middle" x="4029" y="-12161.13" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="4029" y="-12146.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4029" y="-12131.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4029" y="-12116.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer9_gpu5_expert_mlp1&#45;&gt;layer9_gpu5_expert_act -->
<g id="edge986" class="edge">
<title>layer9_gpu5_expert_mlp1&#45;&gt;layer9_gpu5_expert_act</title>
<path fill="none" stroke="black" d="M4049.94,-12212.21C4047.42,-12203.93 4044.68,-12194.93 4042.04,-12186.24"/>
<polygon fill="black" stroke="black" points="4045.38,-12185.18 4039.12,-12176.63 4038.68,-12187.22 4045.38,-12185.18"/>
</g>
<!-- layer9_gpu5_expert_mlp2 -->
<g id="node848" class="node">
<title>layer9_gpu5_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4228.5,-12072.33 3821.5,-12072.33 3821.5,-12004.33 4228.5,-12004.33 4228.5,-12072.33"/>
<text text-anchor="middle" x="4025" y="-12057.13" font-family="Times,serif" font-size="14.00">Expert 5 MLP2</text>
<text text-anchor="middle" x="4025" y="-12042.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4025" y="-12027.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4025" y="-12012.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer9_gpu5_expert_act&#45;&gt;layer9_gpu5_expert_mlp2 -->
<g id="edge987" class="edge">
<title>layer9_gpu5_expert_act&#45;&gt;layer9_gpu5_expert_mlp2</title>
<path fill="none" stroke="black" d="M4027.7,-12108.21C4027.38,-12100.11 4027.04,-12091.31 4026.7,-12082.8"/>
<polygon fill="black" stroke="black" points="4030.2,-12082.49 4026.31,-12072.63 4023.2,-12082.76 4030.2,-12082.49"/>
</g>
<!-- layer9_gpu5_token_send -->
<g id="node849" class="node">
<title>layer9_gpu5_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4017" cy="-11920.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4017" y="-11939.05" font-family="Times,serif" font-size="14.00">Token Send GPU5</text>
<text text-anchor="middle" x="4017" y="-11924.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4017" y="-11909.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4017" y="-11894.05" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer9_gpu5_expert_mlp2&#45;&gt;layer9_gpu5_token_send -->
<g id="edge988" class="edge">
<title>layer9_gpu5_expert_mlp2&#45;&gt;layer9_gpu5_token_send</title>
<path fill="none" stroke="black" d="M4022.71,-12004.07C4022.16,-11996.07 4021.55,-11987.31 4020.95,-11978.56"/>
<polygon fill="black" stroke="black" points="4024.43,-11978.09 4020.25,-11968.36 4017.44,-11978.57 4024.43,-11978.09"/>
</g>
<!-- layer9_gpu5_token_send&#45;&gt;layer9_expert_agg -->
<g id="edge989" class="edge">
<title>layer9_gpu5_token_send&#45;&gt;layer9_expert_agg</title>
<path fill="none" stroke="black" d="M4266.02,-11885.87C4304.5,-11881.05 4343.8,-11876.32 4381,-11872.16 4636.56,-11843.61 4926.31,-11816.57 5143.39,-11797.37"/>
<polygon fill="black" stroke="black" points="5144.02,-11800.83 5153.67,-11796.46 5143.4,-11793.85 5144.02,-11800.83"/>
</g>
<!-- layer9_gpu6_expert_mlp1 -->
<g id="node851" class="node">
<title>layer9_gpu6_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4997.5,-12280.33 4536.5,-12280.33 4536.5,-12212.33 4997.5,-12212.33 4997.5,-12280.33"/>
<text text-anchor="middle" x="4767" y="-12265.13" font-family="Times,serif" font-size="14.00">Expert 6 MLP1</text>
<text text-anchor="middle" x="4767" y="-12250.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4767" y="-12235.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4767" y="-12220.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer9_gpu6_token_recv&#45;&gt;layer9_gpu6_expert_mlp1 -->
<g id="edge991" class="edge">
<title>layer9_gpu6_token_recv&#45;&gt;layer9_gpu6_expert_mlp1</title>
<path fill="none" stroke="black" d="M4769.37,-12316.2C4769.08,-12307.81 4768.78,-12299.12 4768.5,-12290.84"/>
<polygon fill="black" stroke="black" points="4771.99,-12290.51 4768.15,-12280.63 4764.99,-12290.75 4771.99,-12290.51"/>
</g>
<!-- layer9_gpu6_expert_act -->
<g id="node852" class="node">
<title>layer9_gpu6_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4945.5,-12176.33 4568.5,-12176.33 4568.5,-12108.33 4945.5,-12108.33 4945.5,-12176.33"/>
<text text-anchor="middle" x="4757" y="-12161.13" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="4757" y="-12146.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4757" y="-12131.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4757" y="-12116.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer9_gpu6_expert_mlp1&#45;&gt;layer9_gpu6_expert_act -->
<g id="edge992" class="edge">
<title>layer9_gpu6_expert_mlp1&#45;&gt;layer9_gpu6_expert_act</title>
<path fill="none" stroke="black" d="M4763.75,-12212.21C4762.96,-12204.11 4762.1,-12195.31 4761.26,-12186.8"/>
<polygon fill="black" stroke="black" points="4764.72,-12186.24 4760.26,-12176.63 4757.76,-12186.92 4764.72,-12186.24"/>
</g>
<!-- layer9_gpu6_expert_mlp2 -->
<g id="node853" class="node">
<title>layer9_gpu6_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4955.5,-12072.33 4548.5,-12072.33 4548.5,-12004.33 4955.5,-12004.33 4955.5,-12072.33"/>
<text text-anchor="middle" x="4752" y="-12057.13" font-family="Times,serif" font-size="14.00">Expert 6 MLP2</text>
<text text-anchor="middle" x="4752" y="-12042.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4752" y="-12027.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4752" y="-12012.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer9_gpu6_expert_act&#45;&gt;layer9_gpu6_expert_mlp2 -->
<g id="edge993" class="edge">
<title>layer9_gpu6_expert_act&#45;&gt;layer9_gpu6_expert_mlp2</title>
<path fill="none" stroke="black" d="M4755.38,-12108.21C4754.98,-12100.11 4754.55,-12091.31 4754.13,-12082.8"/>
<polygon fill="black" stroke="black" points="4757.62,-12082.45 4753.63,-12072.63 4750.63,-12082.79 4757.62,-12082.45"/>
</g>
<!-- layer9_gpu6_token_send -->
<g id="node854" class="node">
<title>layer9_gpu6_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4746" cy="-11920.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4746" y="-11939.05" font-family="Times,serif" font-size="14.00">Token Send GPU6</text>
<text text-anchor="middle" x="4746" y="-11924.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4746" y="-11909.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4746" y="-11894.05" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer9_gpu6_expert_mlp2&#45;&gt;layer9_gpu6_token_send -->
<g id="edge994" class="edge">
<title>layer9_gpu6_expert_mlp2&#45;&gt;layer9_gpu6_token_send</title>
<path fill="none" stroke="black" d="M4750.28,-12004.07C4749.87,-11996.07 4749.41,-11987.31 4748.96,-11978.56"/>
<polygon fill="black" stroke="black" points="4752.45,-11978.16 4748.43,-11968.36 4745.46,-11978.53 4752.45,-11978.16"/>
</g>
<!-- layer9_gpu6_token_send&#45;&gt;layer9_expert_agg -->
<g id="edge995" class="edge">
<title>layer9_gpu6_token_send&#45;&gt;layer9_expert_agg</title>
<path fill="none" stroke="black" d="M4938.01,-11879.72C5013.59,-11864.16 5102.02,-11845.95 5185.07,-11828.86"/>
<polygon fill="black" stroke="black" points="5185.81,-11832.27 5194.9,-11826.83 5184.4,-11825.42 5185.81,-11832.27"/>
</g>
<!-- layer9_gpu7_expert_mlp1 -->
<g id="node856" class="node">
<title>layer9_gpu7_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5709.5,-12280.33 5248.5,-12280.33 5248.5,-12212.33 5709.5,-12212.33 5709.5,-12280.33"/>
<text text-anchor="middle" x="5479" y="-12265.13" font-family="Times,serif" font-size="14.00">Expert 7 MLP1</text>
<text text-anchor="middle" x="5479" y="-12250.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5479" y="-12235.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5479" y="-12220.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer9_gpu7_token_recv&#45;&gt;layer9_gpu7_expert_mlp1 -->
<g id="edge997" class="edge">
<title>layer9_gpu7_token_recv&#45;&gt;layer9_gpu7_expert_mlp1</title>
<path fill="none" stroke="black" d="M5479,-12316.2C5479,-12307.81 5479,-12299.12 5479,-12290.84"/>
<polygon fill="black" stroke="black" points="5482.5,-12290.63 5479,-12280.63 5475.5,-12290.64 5482.5,-12290.63"/>
</g>
<!-- layer9_gpu7_expert_act -->
<g id="node857" class="node">
<title>layer9_gpu7_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="5667.5,-12176.33 5290.5,-12176.33 5290.5,-12108.33 5667.5,-12108.33 5667.5,-12176.33"/>
<text text-anchor="middle" x="5479" y="-12161.13" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="5479" y="-12146.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5479" y="-12131.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5479" y="-12116.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer9_gpu7_expert_mlp1&#45;&gt;layer9_gpu7_expert_act -->
<g id="edge998" class="edge">
<title>layer9_gpu7_expert_mlp1&#45;&gt;layer9_gpu7_expert_act</title>
<path fill="none" stroke="black" d="M5479,-12212.21C5479,-12204.11 5479,-12195.31 5479,-12186.8"/>
<polygon fill="black" stroke="black" points="5482.5,-12186.63 5479,-12176.63 5475.5,-12186.63 5482.5,-12186.63"/>
</g>
<!-- layer9_gpu7_expert_mlp2 -->
<g id="node858" class="node">
<title>layer9_gpu7_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="5678.5,-12072.33 5271.5,-12072.33 5271.5,-12004.33 5678.5,-12004.33 5678.5,-12072.33"/>
<text text-anchor="middle" x="5475" y="-12057.13" font-family="Times,serif" font-size="14.00">Expert 7 MLP2</text>
<text text-anchor="middle" x="5475" y="-12042.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-12027.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5475" y="-12012.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer9_gpu7_expert_act&#45;&gt;layer9_gpu7_expert_mlp2 -->
<g id="edge999" class="edge">
<title>layer9_gpu7_expert_act&#45;&gt;layer9_gpu7_expert_mlp2</title>
<path fill="none" stroke="black" d="M5477.7,-12108.21C5477.38,-12100.11 5477.04,-12091.31 5476.7,-12082.8"/>
<polygon fill="black" stroke="black" points="5480.2,-12082.49 5476.31,-12072.63 5473.2,-12082.76 5480.2,-12082.49"/>
</g>
<!-- layer9_gpu7_token_send -->
<g id="node859" class="node">
<title>layer9_gpu7_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="5475" cy="-11920.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="5475" y="-11939.05" font-family="Times,serif" font-size="14.00">Token Send GPU7</text>
<text text-anchor="middle" x="5475" y="-11924.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="5475" y="-11909.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="5475" y="-11894.05" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer9_gpu7_expert_mlp2&#45;&gt;layer9_gpu7_token_send -->
<g id="edge1000" class="edge">
<title>layer9_gpu7_expert_mlp2&#45;&gt;layer9_gpu7_token_send</title>
<path fill="none" stroke="black" d="M5475,-12004.07C5475,-11996.07 5475,-11987.31 5475,-11978.56"/>
<polygon fill="black" stroke="black" points="5478.5,-11978.36 5475,-11968.36 5471.5,-11978.36 5478.5,-11978.36"/>
</g>
<!-- layer9_gpu7_token_send&#45;&gt;layer9_expert_agg -->
<g id="edge1001" class="edge">
<title>layer9_gpu7_token_send&#45;&gt;layer9_expert_agg</title>
<path fill="none" stroke="black" d="M5475,-11871.76C5475,-11863.67 5475,-11855.09 5475,-11846.47"/>
<polygon fill="black" stroke="black" points="5478.5,-11846.36 5475,-11836.36 5471.5,-11846.36 5478.5,-11846.36"/>
</g>
<!-- layer9_gpu8_expert_mlp1 -->
<g id="node861" class="node">
<title>layer9_gpu8_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="6398.5,-12280.33 5937.5,-12280.33 5937.5,-12212.33 6398.5,-12212.33 6398.5,-12280.33"/>
<text text-anchor="middle" x="6168" y="-12265.13" font-family="Times,serif" font-size="14.00">Expert 8 MLP1</text>
<text text-anchor="middle" x="6168" y="-12250.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6168" y="-12235.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6168" y="-12220.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer9_gpu8_token_recv&#45;&gt;layer9_gpu8_expert_mlp1 -->
<g id="edge1003" class="edge">
<title>layer9_gpu8_token_recv&#45;&gt;layer9_gpu8_expert_mlp1</title>
<path fill="none" stroke="black" d="M6166.81,-12316.2C6166.96,-12307.81 6167.11,-12299.12 6167.25,-12290.84"/>
<polygon fill="black" stroke="black" points="6170.75,-12290.69 6167.43,-12280.63 6163.75,-12290.57 6170.75,-12290.69"/>
</g>
<!-- layer9_gpu8_expert_act -->
<g id="node862" class="node">
<title>layer9_gpu8_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="6361.5,-12176.33 5984.5,-12176.33 5984.5,-12108.33 6361.5,-12108.33 6361.5,-12176.33"/>
<text text-anchor="middle" x="6173" y="-12161.13" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="6173" y="-12146.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6173" y="-12131.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6173" y="-12116.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer9_gpu8_expert_mlp1&#45;&gt;layer9_gpu8_expert_act -->
<g id="edge1004" class="edge">
<title>layer9_gpu8_expert_mlp1&#45;&gt;layer9_gpu8_expert_act</title>
<path fill="none" stroke="black" d="M6169.62,-12212.21C6170.02,-12204.11 6170.45,-12195.31 6170.87,-12186.8"/>
<polygon fill="black" stroke="black" points="6174.37,-12186.79 6171.37,-12176.63 6167.38,-12186.45 6174.37,-12186.79"/>
</g>
<!-- layer9_gpu8_expert_mlp2 -->
<g id="node863" class="node">
<title>layer9_gpu8_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="6386.5,-12072.33 5979.5,-12072.33 5979.5,-12004.33 6386.5,-12004.33 6386.5,-12072.33"/>
<text text-anchor="middle" x="6183" y="-12057.13" font-family="Times,serif" font-size="14.00">Expert 8 MLP2</text>
<text text-anchor="middle" x="6183" y="-12042.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6183" y="-12027.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6183" y="-12012.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer9_gpu8_expert_act&#45;&gt;layer9_gpu8_expert_mlp2 -->
<g id="edge1005" class="edge">
<title>layer9_gpu8_expert_act&#45;&gt;layer9_gpu8_expert_mlp2</title>
<path fill="none" stroke="black" d="M6176.25,-12108.21C6177.04,-12100.11 6177.9,-12091.31 6178.74,-12082.8"/>
<polygon fill="black" stroke="black" points="6182.24,-12082.92 6179.74,-12072.63 6175.28,-12082.24 6182.24,-12082.92"/>
</g>
<!-- layer9_gpu8_token_send -->
<g id="node864" class="node">
<title>layer9_gpu8_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6204" cy="-11920.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6204" y="-11939.05" font-family="Times,serif" font-size="14.00">Token Send GPU8</text>
<text text-anchor="middle" x="6204" y="-11924.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6204" y="-11909.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6204" y="-11894.05" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer9_gpu8_expert_mlp2&#45;&gt;layer9_gpu8_token_send -->
<g id="edge1006" class="edge">
<title>layer9_gpu8_expert_mlp2&#45;&gt;layer9_gpu8_token_send</title>
<path fill="none" stroke="black" d="M6189.02,-12004.07C6190.48,-11995.99 6192.08,-11987.12 6193.68,-11978.28"/>
<polygon fill="black" stroke="black" points="6197.14,-11978.82 6195.48,-11968.36 6190.25,-11977.57 6197.14,-11978.82"/>
</g>
<!-- layer9_gpu8_token_send&#45;&gt;layer9_expert_agg -->
<g id="edge1007" class="edge">
<title>layer9_gpu8_token_send&#45;&gt;layer9_expert_agg</title>
<path fill="none" stroke="black" d="M6011.99,-11879.72C5950.17,-11866.99 5879.75,-11852.49 5810.71,-11838.28"/>
<polygon fill="black" stroke="black" points="5811.04,-11834.77 5800.54,-11836.18 5809.63,-11841.63 5811.04,-11834.77"/>
</g>
<!-- layer9_gpu9_expert_mlp1 -->
<g id="node866" class="node">
<title>layer9_gpu9_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7092.5,-12280.33 6631.5,-12280.33 6631.5,-12212.33 7092.5,-12212.33 7092.5,-12280.33"/>
<text text-anchor="middle" x="6862" y="-12265.13" font-family="Times,serif" font-size="14.00">Expert 9 MLP1</text>
<text text-anchor="middle" x="6862" y="-12250.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6862" y="-12235.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6862" y="-12220.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_gpu9_token_recv&#45;&gt;layer9_gpu9_expert_mlp1 -->
<g id="edge1009" class="edge">
<title>layer9_gpu9_token_recv&#45;&gt;layer9_gpu9_expert_mlp1</title>
<path fill="none" stroke="black" d="M6856.66,-12316.2C6857.31,-12307.81 6857.99,-12299.12 6858.63,-12290.84"/>
<polygon fill="black" stroke="black" points="6862.13,-12290.88 6859.42,-12280.63 6855.16,-12290.33 6862.13,-12290.88"/>
</g>
<!-- layer9_gpu9_expert_act -->
<g id="node867" class="node">
<title>layer9_gpu9_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7092.5,-12176.33 6715.5,-12176.33 6715.5,-12108.33 7092.5,-12108.33 7092.5,-12176.33"/>
<text text-anchor="middle" x="6904" y="-12161.13" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="6904" y="-12146.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6904" y="-12131.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6904" y="-12116.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_gpu9_expert_mlp1&#45;&gt;layer9_gpu9_expert_act -->
<g id="edge1010" class="edge">
<title>layer9_gpu9_expert_mlp1&#45;&gt;layer9_gpu9_expert_act</title>
<path fill="none" stroke="black" d="M6875.64,-12212.21C6879.08,-12203.84 6882.83,-12194.73 6886.45,-12185.96"/>
<polygon fill="black" stroke="black" points="6889.72,-12187.21 6890.29,-12176.63 6883.24,-12184.54 6889.72,-12187.21"/>
</g>
<!-- layer9_gpu9_expert_mlp2 -->
<g id="node868" class="node">
<title>layer9_gpu9_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7128.5,-12072.33 6721.5,-12072.33 6721.5,-12004.33 7128.5,-12004.33 7128.5,-12072.33"/>
<text text-anchor="middle" x="6925" y="-12057.13" font-family="Times,serif" font-size="14.00">Expert 9 MLP2</text>
<text text-anchor="middle" x="6925" y="-12042.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6925" y="-12027.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6925" y="-12012.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_gpu9_expert_act&#45;&gt;layer9_gpu9_expert_mlp2 -->
<g id="edge1011" class="edge">
<title>layer9_gpu9_expert_act&#45;&gt;layer9_gpu9_expert_mlp2</title>
<path fill="none" stroke="black" d="M6910.82,-12108.21C6912.51,-12100.02 6914.34,-12091.12 6916.11,-12082.52"/>
<polygon fill="black" stroke="black" points="6919.56,-12083.13 6918.14,-12072.63 6912.7,-12081.72 6919.56,-12083.13"/>
</g>
<!-- layer9_gpu9_token_send -->
<g id="node869" class="node">
<title>layer9_gpu9_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6933" cy="-11920.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6933" y="-11939.05" font-family="Times,serif" font-size="14.00">Token Send GPU9</text>
<text text-anchor="middle" x="6933" y="-11924.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6933" y="-11909.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6933" y="-11894.05" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_gpu9_expert_mlp2&#45;&gt;layer9_gpu9_token_send -->
<g id="edge1012" class="edge">
<title>layer9_gpu9_expert_mlp2&#45;&gt;layer9_gpu9_token_send</title>
<path fill="none" stroke="black" d="M6927.29,-12004.07C6927.84,-11996.07 6928.45,-11987.31 6929.05,-11978.56"/>
<polygon fill="black" stroke="black" points="6932.56,-11978.57 6929.75,-11968.36 6925.57,-11978.09 6932.56,-11978.57"/>
</g>
<!-- layer9_gpu9_token_send&#45;&gt;layer9_expert_agg -->
<g id="edge1013" class="edge">
<title>layer9_gpu9_token_send&#45;&gt;layer9_expert_agg</title>
<path fill="none" stroke="black" d="M6683.98,-11885.87C6645.5,-11881.05 6606.2,-11876.32 6569,-11872.16 6346.32,-11847.29 6097.69,-11823.56 5893.8,-11805.16"/>
<polygon fill="black" stroke="black" points="5894.09,-11801.67 5883.81,-11804.26 5893.46,-11808.64 5894.09,-11801.67"/>
</g>
<!-- layer9_gpu10_expert_mlp1 -->
<g id="node871" class="node">
<title>layer9_gpu10_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7785.5,-12280.33 7324.5,-12280.33 7324.5,-12212.33 7785.5,-12212.33 7785.5,-12280.33"/>
<text text-anchor="middle" x="7555" y="-12265.13" font-family="Times,serif" font-size="14.00">Expert 10 MLP1</text>
<text text-anchor="middle" x="7555" y="-12250.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7555" y="-12235.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7555" y="-12220.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer9_gpu10_token_recv&#45;&gt;layer9_gpu10_expert_mlp1 -->
<g id="edge1015" class="edge">
<title>layer9_gpu10_token_recv&#45;&gt;layer9_gpu10_expert_mlp1</title>
<path fill="none" stroke="black" d="M7546.1,-12316.2C7547.2,-12307.72 7548.33,-12298.92 7549.41,-12290.56"/>
<polygon fill="black" stroke="black" points="7552.89,-12291 7550.7,-12280.63 7545.94,-12290.1 7552.89,-12291"/>
</g>
<!-- layer9_gpu10_expert_act -->
<g id="node872" class="node">
<title>layer9_gpu10_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7804.5,-12176.33 7427.5,-12176.33 7427.5,-12108.33 7804.5,-12108.33 7804.5,-12176.33"/>
<text text-anchor="middle" x="7616" y="-12161.13" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="7616" y="-12146.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7616" y="-12131.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7616" y="-12116.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer9_gpu10_expert_mlp1&#45;&gt;layer9_gpu10_expert_act -->
<g id="edge1016" class="edge">
<title>layer9_gpu10_expert_mlp1&#45;&gt;layer9_gpu10_expert_act</title>
<path fill="none" stroke="black" d="M7574.8,-12212.21C7579.92,-12203.66 7585.49,-12194.34 7590.84,-12185.4"/>
<polygon fill="black" stroke="black" points="7593.96,-12187.01 7596.09,-12176.63 7587.95,-12183.42 7593.96,-12187.01"/>
</g>
<!-- layer9_gpu10_expert_mlp2 -->
<g id="node873" class="node">
<title>layer9_gpu10_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7834.5,-12072.33 7427.5,-12072.33 7427.5,-12004.33 7834.5,-12004.33 7834.5,-12072.33"/>
<text text-anchor="middle" x="7631" y="-12057.13" font-family="Times,serif" font-size="14.00">Expert 10 MLP2</text>
<text text-anchor="middle" x="7631" y="-12042.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7631" y="-12027.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="7631" y="-12012.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer9_gpu10_expert_act&#45;&gt;layer9_gpu10_expert_mlp2 -->
<g id="edge1017" class="edge">
<title>layer9_gpu10_expert_act&#45;&gt;layer9_gpu10_expert_mlp2</title>
<path fill="none" stroke="black" d="M7620.87,-12108.21C7622.06,-12100.11 7623.36,-12091.31 7624.61,-12082.8"/>
<polygon fill="black" stroke="black" points="7628.11,-12083.03 7626.1,-12072.63 7621.19,-12082.02 7628.11,-12083.03"/>
</g>
<!-- layer9_gpu10_token_send -->
<g id="node874" class="node">
<title>layer9_gpu10_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="7662" cy="-11920.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="7662" y="-11939.05" font-family="Times,serif" font-size="14.00">Token Send GPU10</text>
<text text-anchor="middle" x="7662" y="-11924.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="7662" y="-11909.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="7662" y="-11894.05" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer9_gpu10_expert_mlp2&#45;&gt;layer9_gpu10_token_send -->
<g id="edge1018" class="edge">
<title>layer9_gpu10_expert_mlp2&#45;&gt;layer9_gpu10_token_send</title>
<path fill="none" stroke="black" d="M7639.88,-12004.07C7642.04,-11995.99 7644.41,-11987.12 7646.77,-11978.28"/>
<polygon fill="black" stroke="black" points="7650.22,-11978.92 7649.42,-11968.36 7643.46,-11977.12 7650.22,-11978.92"/>
</g>
<!-- layer9_gpu10_token_send&#45;&gt;layer9_expert_agg -->
<g id="edge1019" class="edge">
<title>layer9_gpu10_token_send&#45;&gt;layer9_expert_agg</title>
<path fill="none" stroke="black" d="M7418.01,-11885.22C7377.96,-11880.35 7336.86,-11875.77 7298,-11872.16 6804.57,-11826.37 6233.99,-11798.1 5864.47,-11783.02"/>
<polygon fill="black" stroke="black" points="5864.55,-11779.52 5854.42,-11782.61 5864.27,-11786.52 5864.55,-11779.52"/>
</g>
<!-- layer9_gpu11_expert_mlp1 -->
<g id="node876" class="node">
<title>layer9_gpu11_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="8477.5,-12280.33 8016.5,-12280.33 8016.5,-12212.33 8477.5,-12212.33 8477.5,-12280.33"/>
<text text-anchor="middle" x="8247" y="-12265.13" font-family="Times,serif" font-size="14.00">Expert 11 MLP1</text>
<text text-anchor="middle" x="8247" y="-12250.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8247" y="-12235.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8247" y="-12220.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer9_gpu11_token_recv&#45;&gt;layer9_gpu11_expert_mlp1 -->
<g id="edge1021" class="edge">
<title>layer9_gpu11_token_recv&#45;&gt;layer9_gpu11_expert_mlp1</title>
<path fill="none" stroke="black" d="M8235.13,-12316.2C8236.6,-12307.72 8238.11,-12298.92 8239.55,-12290.56"/>
<polygon fill="black" stroke="black" points="8243.01,-12291.08 8241.26,-12280.63 8236.11,-12289.9 8243.01,-12291.08"/>
</g>
<!-- layer9_gpu11_expert_act -->
<g id="node877" class="node">
<title>layer9_gpu11_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="8475.5,-12176.33 8098.5,-12176.33 8098.5,-12108.33 8475.5,-12108.33 8475.5,-12176.33"/>
<text text-anchor="middle" x="8287" y="-12161.13" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="8287" y="-12146.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8287" y="-12131.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8287" y="-12116.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer9_gpu11_expert_mlp1&#45;&gt;layer9_gpu11_expert_act -->
<g id="edge1022" class="edge">
<title>layer9_gpu11_expert_mlp1&#45;&gt;layer9_gpu11_expert_act</title>
<path fill="none" stroke="black" d="M8259.99,-12212.21C8263.27,-12203.84 8266.84,-12194.73 8270.28,-12185.96"/>
<polygon fill="black" stroke="black" points="8273.55,-12187.22 8273.94,-12176.63 8267.03,-12184.66 8273.55,-12187.22"/>
</g>
<!-- layer9_gpu11_expert_mlp2 -->
<g id="node878" class="node">
<title>layer9_gpu11_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="8510.5,-12072.33 8103.5,-12072.33 8103.5,-12004.33 8510.5,-12004.33 8510.5,-12072.33"/>
<text text-anchor="middle" x="8307" y="-12057.13" font-family="Times,serif" font-size="14.00">Expert 11 MLP2</text>
<text text-anchor="middle" x="8307" y="-12042.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8307" y="-12027.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="8307" y="-12012.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer9_gpu11_expert_act&#45;&gt;layer9_gpu11_expert_mlp2 -->
<g id="edge1023" class="edge">
<title>layer9_gpu11_expert_act&#45;&gt;layer9_gpu11_expert_mlp2</title>
<path fill="none" stroke="black" d="M8293.49,-12108.21C8295.1,-12100.02 8296.85,-12091.12 8298.53,-12082.52"/>
<polygon fill="black" stroke="black" points="8301.98,-12083.12 8300.47,-12072.63 8295.11,-12081.77 8301.98,-12083.12"/>
</g>
<!-- layer9_gpu11_token_send -->
<g id="node879" class="node">
<title>layer9_gpu11_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="8391" cy="-11920.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="8391" y="-11939.05" font-family="Times,serif" font-size="14.00">Token Send GPU11</text>
<text text-anchor="middle" x="8391" y="-11924.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="8391" y="-11909.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="8391" y="-11894.05" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer9_gpu11_expert_mlp2&#45;&gt;layer9_gpu11_token_send -->
<g id="edge1024" class="edge">
<title>layer9_gpu11_expert_mlp2&#45;&gt;layer9_gpu11_token_send</title>
<path fill="none" stroke="black" d="M8331.07,-12004.07C8337.3,-11995.46 8344.17,-11985.97 8350.97,-11976.57"/>
<polygon fill="black" stroke="black" points="8353.88,-11978.51 8356.91,-11968.36 8348.21,-11974.41 8353.88,-11978.51"/>
</g>
<!-- layer9_gpu11_token_send&#45;&gt;layer9_expert_agg -->
<g id="edge1025" class="edge">
<title>layer9_gpu11_token_send&#45;&gt;layer9_expert_agg</title>
<path fill="none" stroke="black" d="M8149.02,-11884.91C8108.35,-11880.02 8066.52,-11875.51 8027,-11872.16 7256.33,-11806.9 6351.13,-11782.75 5852.49,-11773.99"/>
<polygon fill="black" stroke="black" points="5852.31,-11770.49 5842.25,-11773.82 5852.19,-11777.49 5852.31,-11770.49"/>
</g>
<!-- layer9_gpu12_expert_mlp1 -->
<g id="node881" class="node">
<title>layer9_gpu12_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9249.5,-12280.33 8788.5,-12280.33 8788.5,-12212.33 9249.5,-12212.33 9249.5,-12280.33"/>
<text text-anchor="middle" x="9019" y="-12265.13" font-family="Times,serif" font-size="14.00">Expert 12 MLP1</text>
<text text-anchor="middle" x="9019" y="-12250.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9019" y="-12235.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9019" y="-12220.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer9_gpu12_token_recv&#45;&gt;layer9_gpu12_expert_mlp1 -->
<g id="edge1027" class="edge">
<title>layer9_gpu12_token_recv&#45;&gt;layer9_gpu12_expert_mlp1</title>
<path fill="none" stroke="black" d="M8956.4,-12316.53C8964.94,-12307.09 8973.85,-12297.25 8982.18,-12288.04"/>
<polygon fill="black" stroke="black" points="8984.9,-12290.24 8989.02,-12280.48 8979.71,-12285.55 8984.9,-12290.24"/>
</g>
<!-- layer9_gpu12_expert_act -->
<g id="node882" class="node">
<title>layer9_gpu12_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9230.5,-12176.33 8853.5,-12176.33 8853.5,-12108.33 9230.5,-12108.33 9230.5,-12176.33"/>
<text text-anchor="middle" x="9042" y="-12161.13" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="9042" y="-12146.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9042" y="-12131.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9042" y="-12116.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer9_gpu12_expert_mlp1&#45;&gt;layer9_gpu12_expert_act -->
<g id="edge1028" class="edge">
<title>layer9_gpu12_expert_mlp1&#45;&gt;layer9_gpu12_expert_act</title>
<path fill="none" stroke="black" d="M9026.47,-12212.21C9028.32,-12204.02 9030.32,-12195.12 9032.26,-12186.52"/>
<polygon fill="black" stroke="black" points="9035.71,-12187.16 9034.49,-12176.63 9028.88,-12185.62 9035.71,-12187.16"/>
</g>
<!-- layer9_gpu12_expert_mlp2 -->
<g id="node883" class="node">
<title>layer9_gpu12_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9271.5,-12072.33 8864.5,-12072.33 8864.5,-12004.33 9271.5,-12004.33 9271.5,-12072.33"/>
<text text-anchor="middle" x="9068" y="-12057.13" font-family="Times,serif" font-size="14.00">Expert 12 MLP2</text>
<text text-anchor="middle" x="9068" y="-12042.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9068" y="-12027.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9068" y="-12012.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer9_gpu12_expert_act&#45;&gt;layer9_gpu12_expert_mlp2 -->
<g id="edge1029" class="edge">
<title>layer9_gpu12_expert_act&#45;&gt;layer9_gpu12_expert_mlp2</title>
<path fill="none" stroke="black" d="M9050.44,-12108.21C9052.53,-12100.02 9054.8,-12091.12 9056.99,-12082.52"/>
<polygon fill="black" stroke="black" points="9060.43,-12083.19 9059.51,-12072.63 9053.65,-12081.46 9060.43,-12083.19"/>
</g>
<!-- layer9_gpu12_token_send -->
<g id="node884" class="node">
<title>layer9_gpu12_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9120" cy="-11920.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9120" y="-11939.05" font-family="Times,serif" font-size="14.00">Token Send GPU12</text>
<text text-anchor="middle" x="9120" y="-11924.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9120" y="-11909.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9120" y="-11894.05" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer9_gpu12_expert_mlp2&#45;&gt;layer9_gpu12_token_send -->
<g id="edge1030" class="edge">
<title>layer9_gpu12_expert_mlp2&#45;&gt;layer9_gpu12_token_send</title>
<path fill="none" stroke="black" d="M9082.9,-12004.07C9086.6,-11995.81 9090.66,-11986.74 9094.71,-11977.71"/>
<polygon fill="black" stroke="black" points="9098,-11978.91 9098.9,-11968.36 9091.61,-11976.05 9098,-11978.91"/>
</g>
<!-- layer9_gpu12_token_send&#45;&gt;layer9_expert_agg -->
<g id="edge1031" class="edge">
<title>layer9_gpu12_token_send&#45;&gt;layer9_expert_agg</title>
<path fill="none" stroke="black" d="M8879.52,-11884.79C8838.38,-11879.85 8796.02,-11875.37 8756,-11872.16 7703.02,-11787.74 6454.77,-11771.57 5846.07,-11769.08"/>
<polygon fill="black" stroke="black" points="5845.83,-11765.58 5835.82,-11769.04 5845.8,-11772.58 5845.83,-11765.58"/>
</g>
<!-- layer9_gpu13_expert_mlp1 -->
<g id="node886" class="node">
<title>layer9_gpu13_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9832.5,-12280.33 9371.5,-12280.33 9371.5,-12212.33 9832.5,-12212.33 9832.5,-12280.33"/>
<text text-anchor="middle" x="9602" y="-12265.13" font-family="Times,serif" font-size="14.00">Expert 13 MLP1</text>
<text text-anchor="middle" x="9602" y="-12250.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9602" y="-12235.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9602" y="-12220.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer9_gpu13_token_recv&#45;&gt;layer9_gpu13_expert_mlp1 -->
<g id="edge1033" class="edge">
<title>layer9_gpu13_token_recv&#45;&gt;layer9_gpu13_expert_mlp1</title>
<path fill="none" stroke="black" d="M9601.41,-12316.2C9601.48,-12307.81 9601.55,-12299.12 9601.63,-12290.84"/>
<polygon fill="black" stroke="black" points="9605.13,-12290.66 9601.71,-12280.63 9598.13,-12290.6 9605.13,-12290.66"/>
</g>
<!-- layer9_gpu13_expert_act -->
<g id="node887" class="node">
<title>layer9_gpu13_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9915.5,-12176.33 9538.5,-12176.33 9538.5,-12108.33 9915.5,-12108.33 9915.5,-12176.33"/>
<text text-anchor="middle" x="9727" y="-12161.13" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="9727" y="-12146.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9727" y="-12131.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9727" y="-12116.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer9_gpu13_expert_mlp1&#45;&gt;layer9_gpu13_expert_act -->
<g id="edge1034" class="edge">
<title>layer9_gpu13_expert_mlp1&#45;&gt;layer9_gpu13_expert_act</title>
<path fill="none" stroke="black" d="M9642.58,-12212.21C9653.94,-12202.95 9666.39,-12192.79 9678.17,-12183.18"/>
<polygon fill="black" stroke="black" points="9680.66,-12185.66 9686.19,-12176.63 9676.23,-12180.24 9680.66,-12185.66"/>
</g>
<!-- layer9_gpu13_expert_mlp2 -->
<g id="node888" class="node">
<title>layer9_gpu13_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9991.5,-12072.33 9584.5,-12072.33 9584.5,-12004.33 9991.5,-12004.33 9991.5,-12072.33"/>
<text text-anchor="middle" x="9788" y="-12057.13" font-family="Times,serif" font-size="14.00">Expert 13 MLP2</text>
<text text-anchor="middle" x="9788" y="-12042.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9788" y="-12027.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9788" y="-12012.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer9_gpu13_expert_act&#45;&gt;layer9_gpu13_expert_mlp2 -->
<g id="edge1035" class="edge">
<title>layer9_gpu13_expert_act&#45;&gt;layer9_gpu13_expert_mlp2</title>
<path fill="none" stroke="black" d="M9746.8,-12108.21C9751.92,-12099.66 9757.49,-12090.34 9762.84,-12081.4"/>
<polygon fill="black" stroke="black" points="9765.96,-12083.01 9768.09,-12072.63 9759.95,-12079.42 9765.96,-12083.01"/>
</g>
<!-- layer9_gpu13_token_send -->
<g id="node889" class="node">
<title>layer9_gpu13_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9849" cy="-11920.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9849" y="-11939.05" font-family="Times,serif" font-size="14.00">Token Send GPU13</text>
<text text-anchor="middle" x="9849" y="-11924.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9849" y="-11909.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9849" y="-11894.05" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer9_gpu13_expert_mlp2&#45;&gt;layer9_gpu13_token_send -->
<g id="edge1036" class="edge">
<title>layer9_gpu13_expert_mlp2&#45;&gt;layer9_gpu13_token_send</title>
<path fill="none" stroke="black" d="M9805.48,-12004.07C9809.86,-11995.73 9814.69,-11986.54 9819.48,-11977.42"/>
<polygon fill="black" stroke="black" points="9822.69,-11978.84 9824.24,-11968.36 9816.49,-11975.58 9822.69,-11978.84"/>
</g>
<!-- layer9_gpu13_token_send&#45;&gt;layer9_expert_agg -->
<g id="edge1037" class="edge">
<title>layer9_gpu13_token_send&#45;&gt;layer9_expert_agg</title>
<path fill="none" stroke="black" d="M9609.02,-11884.65C9567.73,-11879.72 9525.18,-11875.27 9485,-11872.16 8786.67,-11818.18 6710.04,-11785.44 5852.21,-11773.89"/>
<polygon fill="black" stroke="black" points="5852.22,-11770.39 5842.18,-11773.75 5852.13,-11777.39 5852.22,-11770.39"/>
</g>
<!-- layer9_gpu14_expert_mlp1 -->
<g id="node891" class="node">
<title>layer9_gpu14_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="10652.5,-12280.33 10191.5,-12280.33 10191.5,-12212.33 10652.5,-12212.33 10652.5,-12280.33"/>
<text text-anchor="middle" x="10422" y="-12265.13" font-family="Times,serif" font-size="14.00">Expert 14 MLP1</text>
<text text-anchor="middle" x="10422" y="-12250.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10422" y="-12235.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10422" y="-12220.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer9_gpu14_token_recv&#45;&gt;layer9_gpu14_expert_mlp1 -->
<g id="edge1039" class="edge">
<title>layer9_gpu14_token_recv&#45;&gt;layer9_gpu14_expert_mlp1</title>
<path fill="none" stroke="black" d="M10351.65,-12316.53C10361.35,-12307 10371.46,-12297.05 10380.9,-12287.76"/>
<polygon fill="black" stroke="black" points="10383.63,-12289.99 10388.3,-12280.48 10378.72,-12285 10383.63,-12289.99"/>
</g>
<!-- layer9_gpu14_expert_act -->
<g id="node892" class="node">
<title>layer9_gpu14_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="10676.5,-12176.33 10299.5,-12176.33 10299.5,-12108.33 10676.5,-12108.33 10676.5,-12176.33"/>
<text text-anchor="middle" x="10488" y="-12161.13" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="10488" y="-12146.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10488" y="-12131.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10488" y="-12116.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer9_gpu14_expert_mlp1&#45;&gt;layer9_gpu14_expert_act -->
<g id="edge1040" class="edge">
<title>layer9_gpu14_expert_mlp1&#45;&gt;layer9_gpu14_expert_act</title>
<path fill="none" stroke="black" d="M10443.43,-12212.21C10449.02,-12203.57 10455.12,-12194.15 10460.96,-12185.12"/>
<polygon fill="black" stroke="black" points="10463.96,-12186.93 10466.45,-12176.63 10458.08,-12183.12 10463.96,-12186.93"/>
</g>
<!-- layer9_gpu14_expert_mlp2 -->
<g id="node893" class="node">
<title>layer9_gpu14_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10772.5,-12072.33 10365.5,-12072.33 10365.5,-12004.33 10772.5,-12004.33 10772.5,-12072.33"/>
<text text-anchor="middle" x="10569" y="-12057.13" font-family="Times,serif" font-size="14.00">Expert 14 MLP2</text>
<text text-anchor="middle" x="10569" y="-12042.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10569" y="-12027.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="10569" y="-12012.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer9_gpu14_expert_act&#45;&gt;layer9_gpu14_expert_mlp2 -->
<g id="edge1041" class="edge">
<title>layer9_gpu14_expert_act&#45;&gt;layer9_gpu14_expert_mlp2</title>
<path fill="none" stroke="black" d="M10514.3,-12108.21C10521.3,-12099.4 10528.95,-12089.76 10536.25,-12080.57"/>
<polygon fill="black" stroke="black" points="10539.08,-12082.64 10542.56,-12072.63 10533.6,-12078.29 10539.08,-12082.64"/>
</g>
<!-- layer9_gpu14_token_send -->
<g id="node894" class="node">
<title>layer9_gpu14_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="10578" cy="-11920.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="10578" y="-11939.05" font-family="Times,serif" font-size="14.00">Token Send GPU14</text>
<text text-anchor="middle" x="10578" y="-11924.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="10578" y="-11909.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="10578" y="-11894.05" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer9_gpu14_expert_mlp2&#45;&gt;layer9_gpu14_token_send -->
<g id="edge1042" class="edge">
<title>layer9_gpu14_expert_mlp2&#45;&gt;layer9_gpu14_token_send</title>
<path fill="none" stroke="black" d="M10571.58,-12004.07C10572.2,-11996.07 10572.88,-11987.31 10573.56,-11978.56"/>
<polygon fill="black" stroke="black" points="10577.06,-11978.6 10574.35,-11968.36 10570.08,-11978.06 10577.06,-11978.6"/>
</g>
<!-- layer9_gpu14_token_send&#45;&gt;layer9_expert_agg -->
<g id="edge1043" class="edge">
<title>layer9_gpu14_token_send&#45;&gt;layer9_expert_agg</title>
<path fill="none" stroke="black" d="M10339.01,-11884.63C10297.41,-11879.67 10254.51,-11875.22 10214,-11872.16 9368.82,-11808.5 6815.55,-11780.6 5850.17,-11772.13"/>
<polygon fill="black" stroke="black" points="5849.97,-11768.63 5839.94,-11772.04 5849.91,-11775.63 5849.97,-11768.63"/>
</g>
<!-- layer9_gpu15_expert_mlp1 -->
<g id="node896" class="node">
<title>layer9_gpu15_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="11239.5,-12280.33 10778.5,-12280.33 10778.5,-12212.33 11239.5,-12212.33 11239.5,-12280.33"/>
<text text-anchor="middle" x="11009" y="-12265.13" font-family="Times,serif" font-size="14.00">Expert 15 MLP1</text>
<text text-anchor="middle" x="11009" y="-12250.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="11009" y="-12235.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11009" y="-12220.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer9_gpu15_token_recv&#45;&gt;layer9_gpu15_expert_mlp1 -->
<g id="edge1045" class="edge">
<title>layer9_gpu15_token_recv&#45;&gt;layer9_gpu15_expert_mlp1</title>
<path fill="none" stroke="black" d="M11003.07,-12316.2C11003.79,-12307.81 11004.54,-12299.12 11005.25,-12290.84"/>
<polygon fill="black" stroke="black" points="11008.76,-12290.9 11006.13,-12280.63 11001.79,-12290.3 11008.76,-12290.9"/>
</g>
<!-- layer9_gpu15_expert_act -->
<g id="node897" class="node">
<title>layer9_gpu15_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="11220.5,-12176.33 10843.5,-12176.33 10843.5,-12108.33 11220.5,-12108.33 11220.5,-12176.33"/>
<text text-anchor="middle" x="11032" y="-12161.13" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="11032" y="-12146.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11032" y="-12131.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11032" y="-12116.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer9_gpu15_expert_mlp1&#45;&gt;layer9_gpu15_expert_act -->
<g id="edge1046" class="edge">
<title>layer9_gpu15_expert_mlp1&#45;&gt;layer9_gpu15_expert_act</title>
<path fill="none" stroke="black" d="M11016.47,-12212.21C11018.32,-12204.02 11020.32,-12195.12 11022.26,-12186.52"/>
<polygon fill="black" stroke="black" points="11025.71,-12187.16 11024.49,-12176.63 11018.88,-12185.62 11025.71,-12187.16"/>
</g>
<!-- layer9_gpu15_expert_mlp2 -->
<g id="node898" class="node">
<title>layer9_gpu15_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="11239.5,-12072.33 10832.5,-12072.33 10832.5,-12004.33 11239.5,-12004.33 11239.5,-12072.33"/>
<text text-anchor="middle" x="11036" y="-12057.13" font-family="Times,serif" font-size="14.00">Expert 15 MLP2</text>
<text text-anchor="middle" x="11036" y="-12042.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11036" y="-12027.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="11036" y="-12012.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer9_gpu15_expert_act&#45;&gt;layer9_gpu15_expert_mlp2 -->
<g id="edge1047" class="edge">
<title>layer9_gpu15_expert_act&#45;&gt;layer9_gpu15_expert_mlp2</title>
<path fill="none" stroke="black" d="M11033.3,-12108.21C11033.62,-12100.11 11033.96,-12091.31 11034.3,-12082.8"/>
<polygon fill="black" stroke="black" points="11037.8,-12082.76 11034.69,-12072.63 11030.8,-12082.49 11037.8,-12082.76"/>
</g>
<!-- layer9_gpu15_token_send -->
<g id="node899" class="node">
<title>layer9_gpu15_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="11307" cy="-11920.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="11307" y="-11939.05" font-family="Times,serif" font-size="14.00">Token Send GPU15</text>
<text text-anchor="middle" x="11307" y="-11924.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="11307" y="-11909.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="11307" y="-11894.05" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer9_gpu15_expert_mlp2&#45;&gt;layer9_gpu15_token_send -->
<g id="edge1048" class="edge">
<title>layer9_gpu15_expert_mlp2&#45;&gt;layer9_gpu15_token_send</title>
<path fill="none" stroke="black" d="M11113.3,-12004.22C11138,-11993.64 11165.88,-11981.7 11192.64,-11970.23"/>
<polygon fill="black" stroke="black" points="11194.24,-11973.36 11202.05,-11966.2 11191.48,-11966.92 11194.24,-11973.36"/>
</g>
<!-- layer9_gpu15_token_send&#45;&gt;layer9_expert_agg -->
<g id="edge1049" class="edge">
<title>layer9_gpu15_token_send&#45;&gt;layer9_expert_agg</title>
<path fill="none" stroke="black" d="M11068.02,-11884.53C11026.42,-11879.58 10983.51,-11875.16 10943,-11872.16 9949.85,-11798.8 6912.88,-11776.51 5848.39,-11770.85"/>
<polygon fill="black" stroke="black" points="5848.3,-11767.35 5838.29,-11770.8 5848.27,-11774.35 5848.3,-11767.35"/>
</g>
<!-- layer9_residual2 -->
<g id="node901" class="node">
<title>layer9_residual2</title>
<polygon fill="lightyellow" stroke="black" points="5917.89,-11664.16 5213.35,-11664.16 5032.11,-11528.16 5736.65,-11528.16 5917.89,-11664.16"/>
<text text-anchor="middle" x="5475" y="-11614.96" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="5475" y="-11599.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5475" y="-11584.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5475" y="-11569.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer9_expert_agg&#45;&gt;layer9_residual2 -->
<g id="edge1050" class="edge">
<title>layer9_expert_agg&#45;&gt;layer9_residual2</title>
<path fill="none" stroke="black" d="M5475,-11699.98C5475,-11691.66 5475,-11683.11 5475,-11674.66"/>
<polygon fill="black" stroke="black" points="5478.5,-11674.42 5475,-11664.42 5471.5,-11674.42 5478.5,-11674.42"/>
</g>
<!-- layer10_layernorm -->
<g id="node902" class="node">
<title>layer10_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="5678.5,-11481.16 5271.5,-11481.16 5271.5,-11413.16 5678.5,-11413.16 5678.5,-11481.16"/>
<text text-anchor="middle" x="5475" y="-11465.96" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5475" y="-11450.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5475" y="-11435.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5475" y="-11420.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer9_residual2&#45;&gt;layer10_layernorm -->
<g id="edge1051" class="edge">
<title>layer9_residual2&#45;&gt;layer10_layernorm</title>
<path fill="none" stroke="black" d="M5475,-11528.12C5475,-11515.71 5475,-11503.06 5475,-11491.58"/>
<polygon fill="black" stroke="black" points="5478.5,-11491.42 5475,-11481.42 5471.5,-11491.42 5478.5,-11491.42"/>
</g>
<!-- layer10_qkv_proj -->
<g id="node903" class="node">
<title>layer10_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="5732.5,-11377.16 5217.5,-11377.16 5217.5,-11309.16 5732.5,-11309.16 5732.5,-11377.16"/>
<text text-anchor="middle" x="5475" y="-11361.96" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5475" y="-11346.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5475" y="-11331.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5475" y="-11316.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer10_layernorm&#45;&gt;layer10_qkv_proj -->
<g id="edge1052" class="edge">
<title>layer10_layernorm&#45;&gt;layer10_qkv_proj</title>
<path fill="none" stroke="black" d="M5475,-11413.05C5475,-11404.94 5475,-11396.15 5475,-11387.64"/>
<polygon fill="black" stroke="black" points="5478.5,-11387.46 5475,-11377.46 5471.5,-11387.46 5478.5,-11387.46"/>
</g>
<!-- layer10_attention -->
<g id="node904" class="node">
<title>layer10_attention</title>
<polygon fill="lightgreen" stroke="black" points="5726.5,-11273.16 5223.5,-11273.16 5223.5,-11205.16 5726.5,-11205.16 5726.5,-11273.16"/>
<text text-anchor="middle" x="5475" y="-11257.96" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5475" y="-11242.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5475" y="-11227.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5475" y="-11212.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer10_qkv_proj&#45;&gt;layer10_attention -->
<g id="edge1053" class="edge">
<title>layer10_qkv_proj&#45;&gt;layer10_attention</title>
<path fill="none" stroke="black" d="M5475,-11309.05C5475,-11300.94 5475,-11292.15 5475,-11283.64"/>
<polygon fill="black" stroke="black" points="5478.5,-11283.46 5475,-11273.46 5471.5,-11283.46 5478.5,-11283.46"/>
</g>
<!-- layer10_attn_out -->
<g id="node905" class="node">
<title>layer10_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="5713.5,-11169.16 5236.5,-11169.16 5236.5,-11101.16 5713.5,-11101.16 5713.5,-11169.16"/>
<text text-anchor="middle" x="5475" y="-11153.96" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5475" y="-11138.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5475" y="-11123.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5475" y="-11108.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer10_attention&#45;&gt;layer10_attn_out -->
<g id="edge1054" class="edge">
<title>layer10_attention&#45;&gt;layer10_attn_out</title>
<path fill="none" stroke="black" d="M5475,-11205.05C5475,-11196.94 5475,-11188.15 5475,-11179.64"/>
<polygon fill="black" stroke="black" points="5478.5,-11179.46 5475,-11169.46 5471.5,-11179.46 5478.5,-11179.46"/>
</g>
<!-- layer10_residual1 -->
<g id="node906" class="node">
<title>layer10_residual1</title>
<polygon fill="lightyellow" stroke="black" points="5917.89,-11065.16 5213.35,-11065.16 5032.11,-10929.16 5736.65,-10929.16 5917.89,-11065.16"/>
<text text-anchor="middle" x="5475" y="-11015.96" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5475" y="-11000.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5475" y="-10985.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5475" y="-10970.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer10_attn_out&#45;&gt;layer10_residual1 -->
<g id="edge1055" class="edge">
<title>layer10_attn_out&#45;&gt;layer10_residual1</title>
<path fill="none" stroke="black" d="M5475,-11100.9C5475,-11093.07 5475,-11084.4 5475,-11075.52"/>
<polygon fill="black" stroke="black" points="5478.5,-11075.43 5475,-11065.43 5471.5,-11075.43 5478.5,-11075.43"/>
</g>
<!-- layer10_layernorm2 -->
<g id="node907" class="node">
<title>layer10_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="5678.5,-10893.16 5271.5,-10893.16 5271.5,-10825.16 5678.5,-10825.16 5678.5,-10893.16"/>
<text text-anchor="middle" x="5475" y="-10877.96" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5475" y="-10862.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5475" y="-10847.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5475" y="-10832.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer10_residual1&#45;&gt;layer10_layernorm2 -->
<g id="edge1056" class="edge">
<title>layer10_residual1&#45;&gt;layer10_layernorm2</title>
<path fill="none" stroke="black" d="M5475,-10928.96C5475,-10920.21 5475,-10911.44 5475,-10903.23"/>
<polygon fill="black" stroke="black" points="5478.5,-10903.18 5475,-10893.18 5471.5,-10903.18 5478.5,-10903.18"/>
</g>
<!-- layer10_global_gate -->
<g id="node908" class="node">
<title>layer10_global_gate</title>
<polygon fill="lightgreen" stroke="black" points="5672.5,-10789.16 5277.5,-10789.16 5277.5,-10721.16 5672.5,-10721.16 5672.5,-10789.16"/>
<text text-anchor="middle" x="5475" y="-10773.96" font-family="Times,serif" font-size="14.00">Global Gate</text>
<text text-anchor="middle" x="5475" y="-10758.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5475" y="-10743.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, experts=64]</text>
<text text-anchor="middle" x="5475" y="-10728.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer10_layernorm2&#45;&gt;layer10_global_gate -->
<g id="edge1057" class="edge">
<title>layer10_layernorm2&#45;&gt;layer10_global_gate</title>
<path fill="none" stroke="black" d="M5475,-10825.05C5475,-10816.94 5475,-10808.15 5475,-10799.64"/>
<polygon fill="black" stroke="black" points="5478.5,-10799.46 5475,-10789.46 5471.5,-10799.46 5478.5,-10799.46"/>
</g>
<!-- layer10_routing -->
<g id="node909" class="node">
<title>layer10_routing</title>
<polygon fill="lightyellow" stroke="black" points="5961.47,-10685.16 5187.6,-10685.16 4988.53,-10549.16 5762.4,-10549.16 5961.47,-10685.16"/>
<text text-anchor="middle" x="5475" y="-10635.96" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="5475" y="-10620.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5475" y="-10605.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5475" y="-10590.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer10_global_gate&#45;&gt;layer10_routing -->
<g id="edge1058" class="edge">
<title>layer10_global_gate&#45;&gt;layer10_routing</title>
<path fill="none" stroke="black" d="M5475,-10720.9C5475,-10713.07 5475,-10704.4 5475,-10695.52"/>
<polygon fill="black" stroke="black" points="5478.5,-10695.43 5475,-10685.43 5471.5,-10695.43 5478.5,-10695.43"/>
</g>
<!-- layer10_gpu0_token_recv -->
<g id="node910" class="node">
<title>layer10_gpu0_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="442" cy="-10465.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="442" y="-10483.88" font-family="Times,serif" font-size="14.00">Token Receive GPU0</text>
<text text-anchor="middle" x="442" y="-10468.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="442" y="-10453.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="442" y="-10438.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer10_routing&#45;&gt;layer10_gpu0_token_recv -->
<g id="edge1059" class="edge">
<title>layer10_routing&#45;&gt;layer10_gpu0_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5079.84,-10611.76C4119.63,-10600.34 1683.03,-10566.87 870,-10513.16 815.29,-10509.55 756.8,-10504.14 701.18,-10498.27"/>
<polygon fill="black" stroke="black" points="701.51,-10494.78 691.19,-10497.2 700.77,-10501.74 701.51,-10494.78"/>
</g>
<!-- layer10_gpu1_token_recv -->
<g id="node915" class="node">
<title>layer10_gpu1_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1213" cy="-10465.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1213" y="-10483.88" font-family="Times,serif" font-size="14.00">Token Receive GPU1</text>
<text text-anchor="middle" x="1213" y="-10468.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1213" y="-10453.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1213" y="-10438.88" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer10_routing&#45;&gt;layer10_gpu1_token_recv -->
<g id="edge1065" class="edge">
<title>layer10_routing&#45;&gt;layer10_gpu1_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5077.86,-10610.4C4229.91,-10597.29 2265.49,-10562.56 1599,-10513.16 1554.54,-10509.87 1507.34,-10505.14 1461.77,-10499.94"/>
<polygon fill="black" stroke="black" points="1462.1,-10496.46 1451.76,-10498.79 1461.3,-10503.41 1462.1,-10496.46"/>
</g>
<!-- layer10_gpu2_token_recv -->
<g id="node920" class="node">
<title>layer10_gpu2_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1942" cy="-10465.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1942" y="-10483.88" font-family="Times,serif" font-size="14.00">Token Receive GPU2</text>
<text text-anchor="middle" x="1942" y="-10468.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1942" y="-10453.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1942" y="-10438.88" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer10_routing&#45;&gt;layer10_gpu2_token_recv -->
<g id="edge1071" class="edge">
<title>layer10_routing&#45;&gt;layer10_gpu2_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5085.38,-10615.49C4486.97,-10611.75 3305.98,-10593.65 2307,-10513.16 2267.58,-10509.99 2225.88,-10505.6 2185.32,-10500.76"/>
<polygon fill="black" stroke="black" points="2185.66,-10497.28 2175.31,-10499.56 2184.82,-10504.23 2185.66,-10497.28"/>
</g>
<!-- layer10_gpu3_token_recv -->
<g id="node925" class="node">
<title>layer10_gpu3_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="2650" cy="-10465.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2650" y="-10483.88" font-family="Times,serif" font-size="14.00">Token Receive GPU3</text>
<text text-anchor="middle" x="2650" y="-10468.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="2650" y="-10453.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2650" y="-10438.88" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer10_routing&#45;&gt;layer10_gpu3_token_recv -->
<g id="edge1077" class="edge">
<title>layer10_routing&#45;&gt;layer10_gpu3_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5078.42,-10610.68C4589.73,-10601.39 3734.37,-10576.83 3004,-10513.16 2967.43,-10509.98 2928.84,-10505.75 2891.12,-10501.12"/>
<polygon fill="black" stroke="black" points="2891.38,-10497.63 2881.03,-10499.88 2890.52,-10504.58 2891.38,-10497.63"/>
</g>
<!-- layer10_gpu4_token_recv -->
<g id="node930" class="node">
<title>layer10_gpu4_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="3347" cy="-10465.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="3347" y="-10483.88" font-family="Times,serif" font-size="14.00">Token Receive GPU4</text>
<text text-anchor="middle" x="3347" y="-10468.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="3347" y="-10453.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3347" y="-10438.88" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer10_routing&#45;&gt;layer10_gpu4_token_recv -->
<g id="edge1083" class="edge">
<title>layer10_routing&#45;&gt;layer10_gpu4_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5064.71,-10601.36C4703.49,-10586.2 4163.53,-10558.35 3695,-10513.16 3660.47,-10509.83 3624.1,-10505.66 3588.41,-10501.18"/>
<polygon fill="black" stroke="black" points="3588.72,-10497.69 3578.36,-10499.91 3587.84,-10504.63 3588.72,-10497.69"/>
</g>
<!-- layer10_gpu5_token_recv -->
<g id="node935" class="node">
<title>layer10_gpu5_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4038" cy="-10465.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4038" y="-10483.88" font-family="Times,serif" font-size="14.00">Token Receive GPU5</text>
<text text-anchor="middle" x="4038" y="-10468.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4038" y="-10453.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4038" y="-10438.88" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer10_routing&#45;&gt;layer10_gpu5_token_recv -->
<g id="edge1089" class="edge">
<title>layer10_routing&#45;&gt;layer10_gpu5_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5025.33,-10574.46C4839.13,-10556.57 4621.05,-10534.83 4424,-10513.16 4382.76,-10508.63 4339.07,-10503.56 4296.48,-10498.47"/>
<polygon fill="black" stroke="black" points="4296.9,-10494.99 4286.55,-10497.28 4296.07,-10501.94 4296.9,-10494.99"/>
</g>
<!-- layer10_gpu6_token_recv -->
<g id="node940" class="node">
<title>layer10_gpu6_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4767" cy="-10465.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4767" y="-10483.88" font-family="Times,serif" font-size="14.00">Token Receive GPU6</text>
<text text-anchor="middle" x="4767" y="-10468.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4767" y="-10453.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4767" y="-10438.88" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer10_routing&#45;&gt;layer10_gpu6_token_recv -->
<g id="edge1095" class="edge">
<title>layer10_routing&#45;&gt;layer10_gpu6_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5158.79,-10549.13C5091.78,-10534.93 5022.93,-10520.33 4962.02,-10507.42"/>
<polygon fill="black" stroke="black" points="4962.43,-10503.93 4951.92,-10505.28 4960.98,-10510.78 4962.43,-10503.93"/>
</g>
<!-- layer10_gpu7_token_recv -->
<g id="node945" class="node">
<title>layer10_gpu7_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="5475" cy="-10465.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="5475" y="-10483.88" font-family="Times,serif" font-size="14.00">Token Receive GPU7</text>
<text text-anchor="middle" x="5475" y="-10468.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5475" y="-10453.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5475" y="-10438.88" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer10_routing&#45;&gt;layer10_gpu7_token_recv -->
<g id="edge1101" class="edge">
<title>layer10_routing&#45;&gt;layer10_gpu7_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5475,-10549.02C5475,-10540.48 5475,-10531.8 5475,-10523.42"/>
<polygon fill="black" stroke="black" points="5478.5,-10523.4 5475,-10513.4 5471.5,-10523.4 5478.5,-10523.4"/>
</g>
<!-- layer10_gpu8_token_recv -->
<g id="node950" class="node">
<title>layer10_gpu8_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6183" cy="-10465.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6183" y="-10483.88" font-family="Times,serif" font-size="14.00">Token Receive GPU8</text>
<text text-anchor="middle" x="6183" y="-10468.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6183" y="-10453.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6183" y="-10438.88" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer10_routing&#45;&gt;layer10_gpu8_token_recv -->
<g id="edge1107" class="edge">
<title>layer10_routing&#45;&gt;layer10_gpu8_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5769.36,-10553.77C5843.3,-10538.09 5920.81,-10521.66 5988.49,-10507.31"/>
<polygon fill="black" stroke="black" points="5989.35,-10510.71 5998.4,-10505.21 5987.89,-10503.86 5989.35,-10510.71"/>
</g>
<!-- layer10_gpu9_token_recv -->
<g id="node955" class="node">
<title>layer10_gpu9_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6881" cy="-10465.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6881" y="-10483.88" font-family="Times,serif" font-size="14.00">Token Receive GPU9</text>
<text text-anchor="middle" x="6881" y="-10468.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6881" y="-10453.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6881" y="-10438.88" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer10_routing&#45;&gt;layer10_gpu9_token_recv -->
<g id="edge1113" class="edge">
<title>layer10_routing&#45;&gt;layer10_gpu9_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5816.11,-10585.71C6021.9,-10566.59 6289.23,-10540.46 6526,-10513.16 6560.44,-10509.19 6596.71,-10504.72 6632.4,-10500.15"/>
<polygon fill="black" stroke="black" points="6632.97,-10503.61 6642.44,-10498.86 6632.08,-10496.66 6632.97,-10503.61"/>
</g>
<!-- layer10_gpu10_token_recv -->
<g id="node960" class="node">
<title>layer10_gpu10_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="7574" cy="-10465.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="7574" y="-10483.88" font-family="Times,serif" font-size="14.00">Token Receive GPU10</text>
<text text-anchor="middle" x="7574" y="-10468.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="7574" y="-10453.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7574" y="-10438.88" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_routing&#45;&gt;layer10_gpu10_token_recv -->
<g id="edge1119" class="edge">
<title>layer10_routing&#45;&gt;layer10_gpu10_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5840.75,-10602.61C6195.03,-10587.59 6747.15,-10559.21 7224,-10513.16 7258.86,-10509.8 7295.6,-10505.59 7331.63,-10501.08"/>
<polygon fill="black" stroke="black" points="7332.29,-10504.53 7341.77,-10499.8 7331.41,-10497.58 7332.29,-10504.53"/>
</g>
<!-- layer10_gpu11_token_recv -->
<g id="node965" class="node">
<title>layer10_gpu11_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8264" cy="-10465.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8264" y="-10483.88" font-family="Times,serif" font-size="14.00">Token Receive GPU11</text>
<text text-anchor="middle" x="8264" y="-10468.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8264" y="-10453.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8264" y="-10438.88" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer10_routing&#45;&gt;layer10_gpu11_token_recv -->
<g id="edge1125" class="edge">
<title>layer10_routing&#45;&gt;layer10_gpu11_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5853.26,-10611.07C6333.83,-10602.1 7188.42,-10577.82 7917,-10513.16 7952.01,-10510.06 7988.91,-10505.95 8025.05,-10501.46"/>
<polygon fill="black" stroke="black" points="8025.73,-10504.9 8035.22,-10500.18 8024.86,-10497.96 8025.73,-10504.9"/>
</g>
<!-- layer10_gpu12_token_recv -->
<g id="node970" class="node">
<title>layer10_gpu12_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8952" cy="-10465.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8952" y="-10483.88" font-family="Times,serif" font-size="14.00">Token Receive GPU12</text>
<text text-anchor="middle" x="8952" y="-10468.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8952" y="-10453.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8952" y="-10438.88" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer10_routing&#45;&gt;layer10_gpu12_token_recv -->
<g id="edge1131" class="edge">
<title>layer10_routing&#45;&gt;layer10_gpu12_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5860.57,-10616.21C6452.38,-10613.42 7619.84,-10596.53 8607,-10513.16 8641.96,-10510.21 8678.81,-10506.18 8714.88,-10501.7"/>
<polygon fill="black" stroke="black" points="8715.55,-10505.15 8725.03,-10500.43 8714.68,-10498.2 8715.55,-10505.15"/>
</g>
<!-- layer10_gpu13_token_recv -->
<g id="node975" class="node">
<title>layer10_gpu13_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="9640" cy="-10465.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="9640" y="-10483.88" font-family="Times,serif" font-size="14.00">Token Receive GPU13</text>
<text text-anchor="middle" x="9640" y="-10468.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="9640" y="-10453.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9640" y="-10438.88" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer10_routing&#45;&gt;layer10_gpu13_token_recv -->
<g id="edge1137" class="edge">
<title>layer10_routing&#45;&gt;layer10_gpu13_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5853.53,-10611.2C6682.12,-10599.47 8635.1,-10566.93 9295,-10513.16 9330.11,-10510.3 9367.11,-10506.31 9403.32,-10501.84"/>
<polygon fill="black" stroke="black" points="9404.02,-10505.28 9413.51,-10500.56 9403.16,-10498.33 9404.02,-10505.28"/>
</g>
<!-- layer10_gpu14_token_recv -->
<g id="node980" class="node">
<title>layer10_gpu14_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10327" cy="-10465.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10327" y="-10483.88" font-family="Times,serif" font-size="14.00">Token Receive GPU14</text>
<text text-anchor="middle" x="10327" y="-10468.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10327" y="-10453.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10327" y="-10438.88" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer10_routing&#45;&gt;layer10_gpu14_token_recv -->
<g id="edge1143" class="edge">
<title>layer10_routing&#45;&gt;layer10_gpu14_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5855.9,-10613.01C6791.88,-10604.37 9186.16,-10576.59 9983,-10513.16 10018.15,-10510.37 10055.2,-10506.39 10091.45,-10501.92"/>
<polygon fill="black" stroke="black" points="10092.16,-10505.35 10101.65,-10500.64 10091.29,-10498.41 10092.16,-10505.35"/>
</g>
<!-- layer10_gpu15_token_recv -->
<g id="node985" class="node">
<title>layer10_gpu15_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="11160" cy="-10465.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="11160" y="-10483.88" font-family="Times,serif" font-size="14.00">Token Receive GPU15</text>
<text text-anchor="middle" x="11160" y="-10468.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="11160" y="-10453.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="11160" y="-10438.88" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer10_routing&#45;&gt;layer10_gpu15_token_recv -->
<g id="edge1149" class="edge">
<title>layer10_routing&#45;&gt;layer10_gpu15_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5855.17,-10612.38C6888.41,-10601.5 9733.26,-10567.38 10670,-10513.16 10740.69,-10509.07 10816.95,-10502.7 10887.77,-10495.95"/>
<polygon fill="black" stroke="black" points="10888.1,-10499.43 10897.72,-10494.99 10887.43,-10492.46 10888.1,-10499.43"/>
</g>
<!-- layer10_gpu0_expert_mlp1 -->
<g id="node911" class="node">
<title>layer10_gpu0_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="667.5,-10381 206.5,-10381 206.5,-10313 667.5,-10313 667.5,-10381"/>
<text text-anchor="middle" x="437" y="-10365.8" font-family="Times,serif" font-size="14.00">Expert 0 MLP1</text>
<text text-anchor="middle" x="437" y="-10350.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="437" y="-10335.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="437" y="-10320.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer10_gpu0_token_recv&#45;&gt;layer10_gpu0_expert_mlp1 -->
<g id="edge1060" class="edge">
<title>layer10_gpu0_token_recv&#45;&gt;layer10_gpu0_expert_mlp1</title>
<path fill="none" stroke="black" d="M439.97,-10416.87C439.61,-10408.48 439.23,-10399.78 438.87,-10391.51"/>
<polygon fill="black" stroke="black" points="442.36,-10391.14 438.43,-10381.3 435.37,-10391.44 442.36,-10391.14"/>
</g>
<!-- layer10_gpu0_expert_act -->
<g id="node912" class="node">
<title>layer10_gpu0_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="607.5,-10277 230.5,-10277 230.5,-10209 607.5,-10209 607.5,-10277"/>
<text text-anchor="middle" x="419" y="-10261.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="419" y="-10246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="419" y="-10231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="419" y="-10216.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer10_gpu0_expert_mlp1&#45;&gt;layer10_gpu0_expert_act -->
<g id="edge1061" class="edge">
<title>layer10_gpu0_expert_mlp1&#45;&gt;layer10_gpu0_expert_act</title>
<path fill="none" stroke="black" d="M431.16,-10312.88C429.71,-10304.69 428.14,-10295.79 426.62,-10287.19"/>
<polygon fill="black" stroke="black" points="430.06,-10286.54 424.88,-10277.3 423.17,-10287.75 430.06,-10286.54"/>
</g>
<!-- layer10_gpu0_expert_mlp2 -->
<g id="node913" class="node">
<title>layer10_gpu0_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="605.5,-10173 198.5,-10173 198.5,-10105 605.5,-10105 605.5,-10173"/>
<text text-anchor="middle" x="402" y="-10157.8" font-family="Times,serif" font-size="14.00">Expert 0 MLP2</text>
<text text-anchor="middle" x="402" y="-10142.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="402" y="-10127.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="402" y="-10112.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer10_gpu0_expert_act&#45;&gt;layer10_gpu0_expert_mlp2 -->
<g id="edge1062" class="edge">
<title>layer10_gpu0_expert_act&#45;&gt;layer10_gpu0_expert_mlp2</title>
<path fill="none" stroke="black" d="M413.48,-10208.88C412.11,-10200.69 410.63,-10191.79 409.2,-10183.19"/>
<polygon fill="black" stroke="black" points="412.65,-10182.59 407.55,-10173.3 405.74,-10183.74 412.65,-10182.59"/>
</g>
<!-- layer10_gpu0_token_send -->
<g id="node914" class="node">
<title>layer10_gpu0_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="372" cy="-10020.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="372" y="-10039.72" font-family="Times,serif" font-size="14.00">Token Send GPU0</text>
<text text-anchor="middle" x="372" y="-10024.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="372" y="-10009.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="372" y="-9994.72" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer10_gpu0_expert_mlp2&#45;&gt;layer10_gpu0_token_send -->
<g id="edge1063" class="edge">
<title>layer10_gpu0_expert_mlp2&#45;&gt;layer10_gpu0_token_send</title>
<path fill="none" stroke="black" d="M393.4,-10104.73C391.31,-10096.65 389.02,-10087.78 386.74,-10078.95"/>
<polygon fill="black" stroke="black" points="390.07,-10077.83 384.17,-10069.02 383.29,-10079.58 390.07,-10077.83"/>
</g>
<!-- layer10_expert_agg -->
<g id="node990" class="node">
<title>layer10_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="6279.05,-9936.83 5559.94,-9936.83 5374.95,-9800.83 6094.06,-9800.83 6279.05,-9936.83"/>
<text text-anchor="middle" x="5827" y="-9887.63" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5827" y="-9872.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x16)</text>
<text text-anchor="middle" x="5827" y="-9857.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5827" y="-9842.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer10_gpu0_token_send&#45;&gt;layer10_expert_agg -->
<g id="edge1064" class="edge">
<title>layer10_gpu0_token_send&#45;&gt;layer10_expert_agg</title>
<path fill="none" stroke="black" d="M610.99,-9985.25C652.58,-9980.29 695.49,-9975.85 736,-9972.83 1655.07,-9904.3 4454.19,-9879.07 5461.2,-9872.08"/>
<polygon fill="black" stroke="black" points="5461.53,-9875.57 5471.5,-9872 5461.48,-9868.57 5461.53,-9875.57"/>
</g>
<!-- layer10_gpu1_expert_mlp1 -->
<g id="node916" class="node">
<title>layer10_gpu1_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="1417.5,-10381 956.5,-10381 956.5,-10313 1417.5,-10313 1417.5,-10381"/>
<text text-anchor="middle" x="1187" y="-10365.8" font-family="Times,serif" font-size="14.00">Expert 1 MLP1</text>
<text text-anchor="middle" x="1187" y="-10350.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1187" y="-10335.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1187" y="-10320.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer10_gpu1_token_recv&#45;&gt;layer10_gpu1_expert_mlp1 -->
<g id="edge1066" class="edge">
<title>layer10_gpu1_token_recv&#45;&gt;layer10_gpu1_expert_mlp1</title>
<path fill="none" stroke="black" d="M1202.42,-10416.87C1200.53,-10408.39 1198.56,-10399.59 1196.68,-10391.23"/>
<polygon fill="black" stroke="black" points="1200.06,-10390.3 1194.46,-10381.3 1193.23,-10391.83 1200.06,-10390.3"/>
</g>
<!-- layer10_gpu1_expert_act -->
<g id="node917" class="node">
<title>layer10_gpu1_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="1352.5,-10277 975.5,-10277 975.5,-10209 1352.5,-10209 1352.5,-10277"/>
<text text-anchor="middle" x="1164" y="-10261.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1164" y="-10246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1164" y="-10231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1164" y="-10216.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer10_gpu1_expert_mlp1&#45;&gt;layer10_gpu1_expert_act -->
<g id="edge1067" class="edge">
<title>layer10_gpu1_expert_mlp1&#45;&gt;layer10_gpu1_expert_act</title>
<path fill="none" stroke="black" d="M1179.53,-10312.88C1177.68,-10304.69 1175.68,-10295.79 1173.74,-10287.19"/>
<polygon fill="black" stroke="black" points="1177.12,-10286.28 1171.51,-10277.3 1170.29,-10287.82 1177.12,-10286.28"/>
</g>
<!-- layer10_gpu1_expert_mlp2 -->
<g id="node918" class="node">
<title>layer10_gpu1_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="1345.5,-10173 938.5,-10173 938.5,-10105 1345.5,-10105 1345.5,-10173"/>
<text text-anchor="middle" x="1142" y="-10157.8" font-family="Times,serif" font-size="14.00">Expert 1 MLP2</text>
<text text-anchor="middle" x="1142" y="-10142.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1142" y="-10127.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1142" y="-10112.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer10_gpu1_expert_act&#45;&gt;layer10_gpu1_expert_mlp2 -->
<g id="edge1068" class="edge">
<title>layer10_gpu1_expert_act&#45;&gt;layer10_gpu1_expert_mlp2</title>
<path fill="none" stroke="black" d="M1156.86,-10208.88C1155.09,-10200.69 1153.17,-10191.79 1151.32,-10183.19"/>
<polygon fill="black" stroke="black" points="1154.71,-10182.33 1149.18,-10173.3 1147.87,-10183.81 1154.71,-10182.33"/>
</g>
<!-- layer10_gpu1_token_send -->
<g id="node919" class="node">
<title>layer10_gpu1_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1101" cy="-10020.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1101" y="-10039.72" font-family="Times,serif" font-size="14.00">Token Send GPU1</text>
<text text-anchor="middle" x="1101" y="-10024.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1101" y="-10009.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1101" y="-9994.72" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer10_gpu1_expert_mlp2&#45;&gt;layer10_gpu1_token_send -->
<g id="edge1069" class="edge">
<title>layer10_gpu1_expert_mlp2&#45;&gt;layer10_gpu1_token_send</title>
<path fill="none" stroke="black" d="M1130.25,-10104.73C1127.37,-10096.57 1124.2,-10087.59 1121.04,-10078.66"/>
<polygon fill="black" stroke="black" points="1124.27,-10077.29 1117.64,-10069.02 1117.67,-10079.62 1124.27,-10077.29"/>
</g>
<!-- layer10_gpu1_token_send&#45;&gt;layer10_expert_agg -->
<g id="edge1070" class="edge">
<title>layer10_gpu1_token_send&#45;&gt;layer10_expert_agg</title>
<path fill="none" stroke="black" d="M1340.48,-9985.31C1381.93,-9980.36 1424.65,-9975.91 1465,-9972.83 2237.56,-9913.91 4560.75,-9883.39 5463.08,-9873.5"/>
<polygon fill="black" stroke="black" points="5463.34,-9877 5473.3,-9873.39 5463.27,-9870 5463.34,-9877"/>
</g>
<!-- layer10_gpu2_expert_mlp1 -->
<g id="node921" class="node">
<title>layer10_gpu2_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2146.5,-10381 1685.5,-10381 1685.5,-10313 2146.5,-10313 2146.5,-10381"/>
<text text-anchor="middle" x="1916" y="-10365.8" font-family="Times,serif" font-size="14.00">Expert 2 MLP1</text>
<text text-anchor="middle" x="1916" y="-10350.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1916" y="-10335.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1916" y="-10320.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer10_gpu2_token_recv&#45;&gt;layer10_gpu2_expert_mlp1 -->
<g id="edge1072" class="edge">
<title>layer10_gpu2_token_recv&#45;&gt;layer10_gpu2_expert_mlp1</title>
<path fill="none" stroke="black" d="M1931.42,-10416.87C1929.53,-10408.39 1927.56,-10399.59 1925.68,-10391.23"/>
<polygon fill="black" stroke="black" points="1929.06,-10390.3 1923.46,-10381.3 1922.23,-10391.83 1929.06,-10390.3"/>
</g>
<!-- layer10_gpu2_expert_act -->
<g id="node922" class="node">
<title>layer10_gpu2_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2081.5,-10277 1704.5,-10277 1704.5,-10209 2081.5,-10209 2081.5,-10277"/>
<text text-anchor="middle" x="1893" y="-10261.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="1893" y="-10246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1893" y="-10231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1893" y="-10216.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer10_gpu2_expert_mlp1&#45;&gt;layer10_gpu2_expert_act -->
<g id="edge1073" class="edge">
<title>layer10_gpu2_expert_mlp1&#45;&gt;layer10_gpu2_expert_act</title>
<path fill="none" stroke="black" d="M1908.53,-10312.88C1906.68,-10304.69 1904.68,-10295.79 1902.74,-10287.19"/>
<polygon fill="black" stroke="black" points="1906.12,-10286.28 1900.51,-10277.3 1899.29,-10287.82 1906.12,-10286.28"/>
</g>
<!-- layer10_gpu2_expert_mlp2 -->
<g id="node923" class="node">
<title>layer10_gpu2_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2074.5,-10173 1667.5,-10173 1667.5,-10105 2074.5,-10105 2074.5,-10173"/>
<text text-anchor="middle" x="1871" y="-10157.8" font-family="Times,serif" font-size="14.00">Expert 2 MLP2</text>
<text text-anchor="middle" x="1871" y="-10142.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1871" y="-10127.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1871" y="-10112.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer10_gpu2_expert_act&#45;&gt;layer10_gpu2_expert_mlp2 -->
<g id="edge1074" class="edge">
<title>layer10_gpu2_expert_act&#45;&gt;layer10_gpu2_expert_mlp2</title>
<path fill="none" stroke="black" d="M1885.86,-10208.88C1884.09,-10200.69 1882.17,-10191.79 1880.32,-10183.19"/>
<polygon fill="black" stroke="black" points="1883.71,-10182.33 1878.18,-10173.3 1876.87,-10183.81 1883.71,-10182.33"/>
</g>
<!-- layer10_gpu2_token_send -->
<g id="node924" class="node">
<title>layer10_gpu2_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1830" cy="-10020.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1830" y="-10039.72" font-family="Times,serif" font-size="14.00">Token Send GPU2</text>
<text text-anchor="middle" x="1830" y="-10024.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1830" y="-10009.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1830" y="-9994.72" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer10_gpu2_expert_mlp2&#45;&gt;layer10_gpu2_token_send -->
<g id="edge1075" class="edge">
<title>layer10_gpu2_expert_mlp2&#45;&gt;layer10_gpu2_token_send</title>
<path fill="none" stroke="black" d="M1859.25,-10104.73C1856.37,-10096.57 1853.2,-10087.59 1850.04,-10078.66"/>
<polygon fill="black" stroke="black" points="1853.27,-10077.29 1846.64,-10069.02 1846.67,-10079.62 1853.27,-10077.29"/>
</g>
<!-- layer10_gpu2_token_send&#45;&gt;layer10_expert_agg -->
<g id="edge1076" class="edge">
<title>layer10_gpu2_token_send&#45;&gt;layer10_expert_agg</title>
<path fill="none" stroke="black" d="M2069.99,-9985.41C2111.28,-9980.46 2153.82,-9975.99 2194,-9972.83 2821.43,-9923.48 4677.07,-9888.5 5465.77,-9875.46"/>
<polygon fill="black" stroke="black" points="5465.92,-9878.96 5475.86,-9875.29 5465.81,-9871.96 5465.92,-9878.96"/>
</g>
<!-- layer10_gpu3_expert_mlp1 -->
<g id="node926" class="node">
<title>layer10_gpu3_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2860.5,-10381 2399.5,-10381 2399.5,-10313 2860.5,-10313 2860.5,-10381"/>
<text text-anchor="middle" x="2630" y="-10365.8" font-family="Times,serif" font-size="14.00">Expert 3 MLP1</text>
<text text-anchor="middle" x="2630" y="-10350.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2630" y="-10335.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2630" y="-10320.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer10_gpu3_token_recv&#45;&gt;layer10_gpu3_expert_mlp1 -->
<g id="edge1078" class="edge">
<title>layer10_gpu3_token_recv&#45;&gt;layer10_gpu3_expert_mlp1</title>
<path fill="none" stroke="black" d="M2641.87,-10416.87C2640.4,-10408.39 2638.89,-10399.59 2637.45,-10391.23"/>
<polygon fill="black" stroke="black" points="2640.89,-10390.56 2635.74,-10381.3 2633.99,-10391.75 2640.89,-10390.56"/>
</g>
<!-- layer10_gpu3_expert_act -->
<g id="node927" class="node">
<title>layer10_gpu3_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2802.5,-10277 2425.5,-10277 2425.5,-10209 2802.5,-10209 2802.5,-10277"/>
<text text-anchor="middle" x="2614" y="-10261.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="2614" y="-10246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2614" y="-10231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2614" y="-10216.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer10_gpu3_expert_mlp1&#45;&gt;layer10_gpu3_expert_act -->
<g id="edge1079" class="edge">
<title>layer10_gpu3_expert_mlp1&#45;&gt;layer10_gpu3_expert_act</title>
<path fill="none" stroke="black" d="M2624.81,-10312.88C2623.52,-10304.69 2622.12,-10295.79 2620.78,-10287.19"/>
<polygon fill="black" stroke="black" points="2624.23,-10286.63 2619.22,-10277.3 2617.32,-10287.72 2624.23,-10286.63"/>
</g>
<!-- layer10_gpu3_expert_mlp2 -->
<g id="node928" class="node">
<title>layer10_gpu3_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2797.5,-10173 2390.5,-10173 2390.5,-10105 2797.5,-10105 2797.5,-10173"/>
<text text-anchor="middle" x="2594" y="-10157.8" font-family="Times,serif" font-size="14.00">Expert 3 MLP2</text>
<text text-anchor="middle" x="2594" y="-10142.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2594" y="-10127.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="2594" y="-10112.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer10_gpu3_expert_act&#45;&gt;layer10_gpu3_expert_mlp2 -->
<g id="edge1080" class="edge">
<title>layer10_gpu3_expert_act&#45;&gt;layer10_gpu3_expert_mlp2</title>
<path fill="none" stroke="black" d="M2607.51,-10208.88C2605.9,-10200.69 2604.15,-10191.79 2602.47,-10183.19"/>
<polygon fill="black" stroke="black" points="2605.89,-10182.44 2600.53,-10173.3 2599.02,-10183.78 2605.89,-10182.44"/>
</g>
<!-- layer10_gpu3_token_send -->
<g id="node929" class="node">
<title>layer10_gpu3_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="2559" cy="-10020.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="2559" y="-10039.72" font-family="Times,serif" font-size="14.00">Token Send GPU3</text>
<text text-anchor="middle" x="2559" y="-10024.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="2559" y="-10009.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="2559" y="-9994.72" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer10_gpu3_expert_mlp2&#45;&gt;layer10_gpu3_token_send -->
<g id="edge1081" class="edge">
<title>layer10_gpu3_expert_mlp2&#45;&gt;layer10_gpu3_token_send</title>
<path fill="none" stroke="black" d="M2583.97,-10104.73C2581.51,-10096.57 2578.8,-10087.59 2576.11,-10078.66"/>
<polygon fill="black" stroke="black" points="2579.44,-10077.59 2573.2,-10069.02 2572.74,-10079.61 2579.44,-10077.59"/>
</g>
<!-- layer10_gpu3_token_send&#45;&gt;layer10_expert_agg -->
<g id="edge1082" class="edge">
<title>layer10_gpu3_token_send&#45;&gt;layer10_expert_agg</title>
<path fill="none" stroke="black" d="M2799.99,-9985.53C2840.97,-9980.61 2883.15,-9976.11 2923,-9972.83 3833.89,-9897.93 4909.92,-9877.46 5461.16,-9871.89"/>
<polygon fill="black" stroke="black" points="5461.29,-9875.39 5471.26,-9871.79 5461.22,-9868.39 5461.29,-9875.39"/>
</g>
<!-- layer10_gpu4_expert_mlp1 -->
<g id="node931" class="node">
<title>layer10_gpu4_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="3561.5,-10381 3100.5,-10381 3100.5,-10313 3561.5,-10313 3561.5,-10381"/>
<text text-anchor="middle" x="3331" y="-10365.8" font-family="Times,serif" font-size="14.00">Expert 4 MLP1</text>
<text text-anchor="middle" x="3331" y="-10350.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3331" y="-10335.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3331" y="-10320.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer10_gpu4_token_recv&#45;&gt;layer10_gpu4_expert_mlp1 -->
<g id="edge1084" class="edge">
<title>layer10_gpu4_token_recv&#45;&gt;layer10_gpu4_expert_mlp1</title>
<path fill="none" stroke="black" d="M3340.49,-10416.87C3339.32,-10408.39 3338.11,-10399.59 3336.96,-10391.23"/>
<polygon fill="black" stroke="black" points="3340.42,-10390.73 3335.59,-10381.3 3333.49,-10391.69 3340.42,-10390.73"/>
</g>
<!-- layer10_gpu4_expert_act -->
<g id="node932" class="node">
<title>layer10_gpu4_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="3488.5,-10277 3111.5,-10277 3111.5,-10209 3488.5,-10209 3488.5,-10277"/>
<text text-anchor="middle" x="3300" y="-10261.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="3300" y="-10246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3300" y="-10231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3300" y="-10216.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer10_gpu4_expert_mlp1&#45;&gt;layer10_gpu4_expert_act -->
<g id="edge1085" class="edge">
<title>layer10_gpu4_expert_mlp1&#45;&gt;layer10_gpu4_expert_act</title>
<path fill="none" stroke="black" d="M3320.94,-10312.88C3318.42,-10304.6 3315.68,-10295.59 3313.04,-10286.91"/>
<polygon fill="black" stroke="black" points="3316.38,-10285.85 3310.12,-10277.3 3309.68,-10287.88 3316.38,-10285.85"/>
</g>
<!-- layer10_gpu4_expert_mlp2 -->
<g id="node933" class="node">
<title>layer10_gpu4_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="3499.5,-10173 3092.5,-10173 3092.5,-10105 3499.5,-10105 3499.5,-10173"/>
<text text-anchor="middle" x="3296" y="-10157.8" font-family="Times,serif" font-size="14.00">Expert 4 MLP2</text>
<text text-anchor="middle" x="3296" y="-10142.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3296" y="-10127.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="3296" y="-10112.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer10_gpu4_expert_act&#45;&gt;layer10_gpu4_expert_mlp2 -->
<g id="edge1086" class="edge">
<title>layer10_gpu4_expert_act&#45;&gt;layer10_gpu4_expert_mlp2</title>
<path fill="none" stroke="black" d="M3298.7,-10208.88C3298.38,-10200.78 3298.04,-10191.98 3297.7,-10183.47"/>
<polygon fill="black" stroke="black" points="3301.2,-10183.15 3297.31,-10173.3 3294.2,-10183.43 3301.2,-10183.15"/>
</g>
<!-- layer10_gpu4_token_send -->
<g id="node934" class="node">
<title>layer10_gpu4_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="3288" cy="-10020.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="3288" y="-10039.72" font-family="Times,serif" font-size="14.00">Token Send GPU4</text>
<text text-anchor="middle" x="3288" y="-10024.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="3288" y="-10009.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="3288" y="-9994.72" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer10_gpu4_expert_mlp2&#45;&gt;layer10_gpu4_token_send -->
<g id="edge1087" class="edge">
<title>layer10_gpu4_expert_mlp2&#45;&gt;layer10_gpu4_token_send</title>
<path fill="none" stroke="black" d="M3293.71,-10104.73C3293.16,-10096.74 3292.55,-10087.97 3291.95,-10079.23"/>
<polygon fill="black" stroke="black" points="3295.43,-10078.76 3291.25,-10069.02 3288.44,-10079.24 3295.43,-10078.76"/>
</g>
<!-- layer10_gpu4_token_send&#45;&gt;layer10_expert_agg -->
<g id="edge1088" class="edge">
<title>layer10_gpu4_token_send&#45;&gt;layer10_expert_agg</title>
<path fill="none" stroke="black" d="M3530.98,-9985.7C3571.34,-9980.82 3612.8,-9976.29 3652,-9972.83 4290.43,-9916.52 5037.18,-9889.62 5468.77,-9877.87"/>
<polygon fill="black" stroke="black" points="5469.01,-9881.37 5478.91,-9877.6 5468.82,-9874.37 5469.01,-9881.37"/>
</g>
<!-- layer10_gpu5_expert_mlp1 -->
<g id="node936" class="node">
<title>layer10_gpu5_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4258.5,-10381 3797.5,-10381 3797.5,-10313 4258.5,-10313 4258.5,-10381"/>
<text text-anchor="middle" x="4028" y="-10365.8" font-family="Times,serif" font-size="14.00">Expert 5 MLP1</text>
<text text-anchor="middle" x="4028" y="-10350.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4028" y="-10335.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4028" y="-10320.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer10_gpu5_token_recv&#45;&gt;layer10_gpu5_expert_mlp1 -->
<g id="edge1090" class="edge">
<title>layer10_gpu5_token_recv&#45;&gt;layer10_gpu5_expert_mlp1</title>
<path fill="none" stroke="black" d="M4033.93,-10416.87C4033.21,-10408.48 4032.46,-10399.78 4031.75,-10391.51"/>
<polygon fill="black" stroke="black" points="4035.21,-10390.96 4030.87,-10381.3 4028.24,-10391.57 4035.21,-10390.96"/>
</g>
<!-- layer10_gpu5_expert_act -->
<g id="node937" class="node">
<title>layer10_gpu5_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4213.5,-10277 3836.5,-10277 3836.5,-10209 4213.5,-10209 4213.5,-10277"/>
<text text-anchor="middle" x="4025" y="-10261.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="4025" y="-10246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4025" y="-10231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4025" y="-10216.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer10_gpu5_expert_mlp1&#45;&gt;layer10_gpu5_expert_act -->
<g id="edge1091" class="edge">
<title>layer10_gpu5_expert_mlp1&#45;&gt;layer10_gpu5_expert_act</title>
<path fill="none" stroke="black" d="M4027.03,-10312.88C4026.79,-10304.78 4026.53,-10295.98 4026.28,-10287.47"/>
<polygon fill="black" stroke="black" points="4029.77,-10287.19 4025.98,-10277.3 4022.77,-10287.4 4029.77,-10287.19"/>
</g>
<!-- layer10_gpu5_expert_mlp2 -->
<g id="node938" class="node">
<title>layer10_gpu5_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4225.5,-10173 3818.5,-10173 3818.5,-10105 4225.5,-10105 4225.5,-10173"/>
<text text-anchor="middle" x="4022" y="-10157.8" font-family="Times,serif" font-size="14.00">Expert 5 MLP2</text>
<text text-anchor="middle" x="4022" y="-10142.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4022" y="-10127.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4022" y="-10112.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer10_gpu5_expert_act&#45;&gt;layer10_gpu5_expert_mlp2 -->
<g id="edge1092" class="edge">
<title>layer10_gpu5_expert_act&#45;&gt;layer10_gpu5_expert_mlp2</title>
<path fill="none" stroke="black" d="M4024.03,-10208.88C4023.79,-10200.78 4023.53,-10191.98 4023.28,-10183.47"/>
<polygon fill="black" stroke="black" points="4026.77,-10183.19 4022.98,-10173.3 4019.77,-10183.4 4026.77,-10183.19"/>
</g>
<!-- layer10_gpu5_token_send -->
<g id="node939" class="node">
<title>layer10_gpu5_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4017" cy="-10020.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4017" y="-10039.72" font-family="Times,serif" font-size="14.00">Token Send GPU5</text>
<text text-anchor="middle" x="4017" y="-10024.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4017" y="-10009.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4017" y="-9994.72" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer10_gpu5_expert_mlp2&#45;&gt;layer10_gpu5_token_send -->
<g id="edge1093" class="edge">
<title>layer10_gpu5_expert_mlp2&#45;&gt;layer10_gpu5_token_send</title>
<path fill="none" stroke="black" d="M4020.57,-10104.73C4020.22,-10096.74 4019.85,-10087.97 4019.47,-10079.23"/>
<polygon fill="black" stroke="black" points="4022.96,-10078.86 4019.03,-10069.02 4015.96,-10079.17 4022.96,-10078.86"/>
</g>
<!-- layer10_gpu5_token_send&#45;&gt;layer10_expert_agg -->
<g id="edge1094" class="edge">
<title>layer10_gpu5_token_send&#45;&gt;layer10_expert_agg</title>
<path fill="none" stroke="black" d="M4263,-9986.14C4302.42,-9981.29 4342.8,-9976.66 4381,-9972.83 4757.18,-9935.14 5189.78,-9906.21 5483.05,-9888.75"/>
<polygon fill="black" stroke="black" points="5483.65,-9892.22 5493.42,-9888.13 5483.23,-9885.23 5483.65,-9892.22"/>
</g>
<!-- layer10_gpu6_expert_mlp1 -->
<g id="node941" class="node">
<title>layer10_gpu6_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4992.5,-10381 4531.5,-10381 4531.5,-10313 4992.5,-10313 4992.5,-10381"/>
<text text-anchor="middle" x="4762" y="-10365.8" font-family="Times,serif" font-size="14.00">Expert 6 MLP1</text>
<text text-anchor="middle" x="4762" y="-10350.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4762" y="-10335.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4762" y="-10320.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer10_gpu6_token_recv&#45;&gt;layer10_gpu6_expert_mlp1 -->
<g id="edge1096" class="edge">
<title>layer10_gpu6_token_recv&#45;&gt;layer10_gpu6_expert_mlp1</title>
<path fill="none" stroke="black" d="M4764.97,-10416.87C4764.61,-10408.48 4764.23,-10399.78 4763.87,-10391.51"/>
<polygon fill="black" stroke="black" points="4767.36,-10391.14 4763.43,-10381.3 4760.37,-10391.44 4767.36,-10391.14"/>
</g>
<!-- layer10_gpu6_expert_act -->
<g id="node942" class="node">
<title>layer10_gpu6_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4940.5,-10277 4563.5,-10277 4563.5,-10209 4940.5,-10209 4940.5,-10277"/>
<text text-anchor="middle" x="4752" y="-10261.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="4752" y="-10246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4752" y="-10231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4752" y="-10216.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer10_gpu6_expert_mlp1&#45;&gt;layer10_gpu6_expert_act -->
<g id="edge1097" class="edge">
<title>layer10_gpu6_expert_mlp1&#45;&gt;layer10_gpu6_expert_act</title>
<path fill="none" stroke="black" d="M4758.75,-10312.88C4757.96,-10304.78 4757.1,-10295.98 4756.26,-10287.47"/>
<polygon fill="black" stroke="black" points="4759.72,-10286.91 4755.26,-10277.3 4752.76,-10287.59 4759.72,-10286.91"/>
</g>
<!-- layer10_gpu6_expert_mlp2 -->
<g id="node943" class="node">
<title>layer10_gpu6_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4952.5,-10173 4545.5,-10173 4545.5,-10105 4952.5,-10105 4952.5,-10173"/>
<text text-anchor="middle" x="4749" y="-10157.8" font-family="Times,serif" font-size="14.00">Expert 6 MLP2</text>
<text text-anchor="middle" x="4749" y="-10142.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4749" y="-10127.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4749" y="-10112.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer10_gpu6_expert_act&#45;&gt;layer10_gpu6_expert_mlp2 -->
<g id="edge1098" class="edge">
<title>layer10_gpu6_expert_act&#45;&gt;layer10_gpu6_expert_mlp2</title>
<path fill="none" stroke="black" d="M4751.03,-10208.88C4750.79,-10200.78 4750.53,-10191.98 4750.28,-10183.47"/>
<polygon fill="black" stroke="black" points="4753.77,-10183.19 4749.98,-10173.3 4746.77,-10183.4 4753.77,-10183.19"/>
</g>
<!-- layer10_gpu6_token_send -->
<g id="node944" class="node">
<title>layer10_gpu6_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4746" cy="-10020.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4746" y="-10039.72" font-family="Times,serif" font-size="14.00">Token Send GPU6</text>
<text text-anchor="middle" x="4746" y="-10024.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4746" y="-10009.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4746" y="-9994.72" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer10_gpu6_expert_mlp2&#45;&gt;layer10_gpu6_token_send -->
<g id="edge1099" class="edge">
<title>layer10_gpu6_expert_mlp2&#45;&gt;layer10_gpu6_token_send</title>
<path fill="none" stroke="black" d="M4748.14,-10104.73C4747.93,-10096.74 4747.71,-10087.97 4747.48,-10079.23"/>
<polygon fill="black" stroke="black" points="4750.97,-10078.93 4747.22,-10069.02 4743.98,-10079.11 4750.97,-10078.93"/>
</g>
<!-- layer10_gpu6_token_send&#45;&gt;layer10_expert_agg -->
<g id="edge1100" class="edge">
<title>layer10_gpu6_token_send&#45;&gt;layer10_expert_agg</title>
<path fill="none" stroke="black" d="M4990.62,-9985.95C5146.03,-9964.38 5348.62,-9936.25 5515.48,-9913.08"/>
<polygon fill="black" stroke="black" points="5515.99,-9916.55 5525.41,-9911.7 5515.03,-9909.61 5515.99,-9916.55"/>
</g>
<!-- layer10_gpu7_expert_mlp1 -->
<g id="node946" class="node">
<title>layer10_gpu7_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5705.5,-10381 5244.5,-10381 5244.5,-10313 5705.5,-10313 5705.5,-10381"/>
<text text-anchor="middle" x="5475" y="-10365.8" font-family="Times,serif" font-size="14.00">Expert 7 MLP1</text>
<text text-anchor="middle" x="5475" y="-10350.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5475" y="-10335.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-10320.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer10_gpu7_token_recv&#45;&gt;layer10_gpu7_expert_mlp1 -->
<g id="edge1102" class="edge">
<title>layer10_gpu7_token_recv&#45;&gt;layer10_gpu7_expert_mlp1</title>
<path fill="none" stroke="black" d="M5475,-10416.87C5475,-10408.48 5475,-10399.78 5475,-10391.51"/>
<polygon fill="black" stroke="black" points="5478.5,-10391.3 5475,-10381.3 5471.5,-10391.3 5478.5,-10391.3"/>
</g>
<!-- layer10_gpu7_expert_act -->
<g id="node947" class="node">
<title>layer10_gpu7_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="5663.5,-10277 5286.5,-10277 5286.5,-10209 5663.5,-10209 5663.5,-10277"/>
<text text-anchor="middle" x="5475" y="-10261.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="5475" y="-10246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-10231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-10216.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer10_gpu7_expert_mlp1&#45;&gt;layer10_gpu7_expert_act -->
<g id="edge1103" class="edge">
<title>layer10_gpu7_expert_mlp1&#45;&gt;layer10_gpu7_expert_act</title>
<path fill="none" stroke="black" d="M5475,-10312.88C5475,-10304.78 5475,-10295.98 5475,-10287.47"/>
<polygon fill="black" stroke="black" points="5478.5,-10287.3 5475,-10277.3 5471.5,-10287.3 5478.5,-10287.3"/>
</g>
<!-- layer10_gpu7_expert_mlp2 -->
<g id="node948" class="node">
<title>layer10_gpu7_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="5678.5,-10173 5271.5,-10173 5271.5,-10105 5678.5,-10105 5678.5,-10173"/>
<text text-anchor="middle" x="5475" y="-10157.8" font-family="Times,serif" font-size="14.00">Expert 7 MLP2</text>
<text text-anchor="middle" x="5475" y="-10142.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-10127.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5475" y="-10112.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer10_gpu7_expert_act&#45;&gt;layer10_gpu7_expert_mlp2 -->
<g id="edge1104" class="edge">
<title>layer10_gpu7_expert_act&#45;&gt;layer10_gpu7_expert_mlp2</title>
<path fill="none" stroke="black" d="M5475,-10208.88C5475,-10200.78 5475,-10191.98 5475,-10183.47"/>
<polygon fill="black" stroke="black" points="5478.5,-10183.3 5475,-10173.3 5471.5,-10183.3 5478.5,-10183.3"/>
</g>
<!-- layer10_gpu7_token_send -->
<g id="node949" class="node">
<title>layer10_gpu7_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="5475" cy="-10020.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="5475" y="-10039.72" font-family="Times,serif" font-size="14.00">Token Send GPU7</text>
<text text-anchor="middle" x="5475" y="-10024.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="5475" y="-10009.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="5475" y="-9994.72" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer10_gpu7_expert_mlp2&#45;&gt;layer10_gpu7_token_send -->
<g id="edge1105" class="edge">
<title>layer10_gpu7_expert_mlp2&#45;&gt;layer10_gpu7_token_send</title>
<path fill="none" stroke="black" d="M5475,-10104.73C5475,-10096.74 5475,-10087.97 5475,-10079.23"/>
<polygon fill="black" stroke="black" points="5478.5,-10079.02 5475,-10069.02 5471.5,-10079.02 5478.5,-10079.02"/>
</g>
<!-- layer10_gpu7_token_send&#45;&gt;layer10_expert_agg -->
<g id="edge1106" class="edge">
<title>layer10_gpu7_token_send&#45;&gt;layer10_expert_agg</title>
<path fill="none" stroke="black" d="M5580.61,-9974.89C5605.81,-9964.14 5633.31,-9952.41 5660.51,-9940.82"/>
<polygon fill="black" stroke="black" points="5661.9,-9944.03 5669.72,-9936.89 5659.15,-9937.59 5661.9,-9944.03"/>
</g>
<!-- layer10_gpu8_expert_mlp1 -->
<g id="node951" class="node">
<title>layer10_gpu8_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="6416.5,-10381 5955.5,-10381 5955.5,-10313 6416.5,-10313 6416.5,-10381"/>
<text text-anchor="middle" x="6186" y="-10365.8" font-family="Times,serif" font-size="14.00">Expert 8 MLP1</text>
<text text-anchor="middle" x="6186" y="-10350.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6186" y="-10335.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6186" y="-10320.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer10_gpu8_token_recv&#45;&gt;layer10_gpu8_expert_mlp1 -->
<g id="edge1108" class="edge">
<title>layer10_gpu8_token_recv&#45;&gt;layer10_gpu8_expert_mlp1</title>
<path fill="none" stroke="black" d="M6184.22,-10416.87C6184.44,-10408.48 6184.66,-10399.78 6184.88,-10391.51"/>
<polygon fill="black" stroke="black" points="6188.38,-10391.39 6185.14,-10381.3 6181.38,-10391.21 6188.38,-10391.39"/>
</g>
<!-- layer10_gpu8_expert_act -->
<g id="node952" class="node">
<title>layer10_gpu8_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="6379.5,-10277 6002.5,-10277 6002.5,-10209 6379.5,-10209 6379.5,-10277"/>
<text text-anchor="middle" x="6191" y="-10261.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="6191" y="-10246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6191" y="-10231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6191" y="-10216.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer10_gpu8_expert_mlp1&#45;&gt;layer10_gpu8_expert_act -->
<g id="edge1109" class="edge">
<title>layer10_gpu8_expert_mlp1&#45;&gt;layer10_gpu8_expert_act</title>
<path fill="none" stroke="black" d="M6187.62,-10312.88C6188.02,-10304.78 6188.45,-10295.98 6188.87,-10287.47"/>
<polygon fill="black" stroke="black" points="6192.37,-10287.46 6189.37,-10277.3 6185.38,-10287.11 6192.37,-10287.46"/>
</g>
<!-- layer10_gpu8_expert_mlp2 -->
<g id="node953" class="node">
<title>layer10_gpu8_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="6397.5,-10173 5990.5,-10173 5990.5,-10105 6397.5,-10105 6397.5,-10173"/>
<text text-anchor="middle" x="6194" y="-10157.8" font-family="Times,serif" font-size="14.00">Expert 8 MLP2</text>
<text text-anchor="middle" x="6194" y="-10142.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6194" y="-10127.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6194" y="-10112.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer10_gpu8_expert_act&#45;&gt;layer10_gpu8_expert_mlp2 -->
<g id="edge1110" class="edge">
<title>layer10_gpu8_expert_act&#45;&gt;layer10_gpu8_expert_mlp2</title>
<path fill="none" stroke="black" d="M6191.97,-10208.88C6192.21,-10200.78 6192.47,-10191.98 6192.72,-10183.47"/>
<polygon fill="black" stroke="black" points="6196.23,-10183.4 6193.02,-10173.3 6189.23,-10183.19 6196.23,-10183.4"/>
</g>
<!-- layer10_gpu8_token_send -->
<g id="node954" class="node">
<title>layer10_gpu8_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6204" cy="-10020.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6204" y="-10039.72" font-family="Times,serif" font-size="14.00">Token Send GPU8</text>
<text text-anchor="middle" x="6204" y="-10024.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6204" y="-10009.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6204" y="-9994.72" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer10_gpu8_expert_mlp2&#45;&gt;layer10_gpu8_token_send -->
<g id="edge1111" class="edge">
<title>layer10_gpu8_expert_mlp2&#45;&gt;layer10_gpu8_token_send</title>
<path fill="none" stroke="black" d="M6196.87,-10104.73C6197.55,-10096.74 6198.31,-10087.97 6199.06,-10079.23"/>
<polygon fill="black" stroke="black" points="6202.57,-10079.29 6199.94,-10069.02 6195.6,-10078.69 6202.57,-10079.29"/>
</g>
<!-- layer10_gpu8_token_send&#45;&gt;layer10_expert_agg -->
<g id="edge1112" class="edge">
<title>layer10_gpu8_token_send&#45;&gt;layer10_expert_agg</title>
<path fill="none" stroke="black" d="M6091.65,-9975.19C6064.34,-9964.32 6034.46,-9952.42 6004.92,-9940.66"/>
<polygon fill="black" stroke="black" points="6005.93,-9937.3 5995.35,-9936.85 6003.34,-9943.8 6005.93,-9937.3"/>
</g>
<!-- layer10_gpu9_expert_mlp1 -->
<g id="node956" class="node">
<title>layer10_gpu9_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7117.5,-10381 6656.5,-10381 6656.5,-10313 7117.5,-10313 7117.5,-10381"/>
<text text-anchor="middle" x="6887" y="-10365.8" font-family="Times,serif" font-size="14.00">Expert 9 MLP1</text>
<text text-anchor="middle" x="6887" y="-10350.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6887" y="-10335.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6887" y="-10320.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer10_gpu9_token_recv&#45;&gt;layer10_gpu9_expert_mlp1 -->
<g id="edge1114" class="edge">
<title>layer10_gpu9_token_recv&#45;&gt;layer10_gpu9_expert_mlp1</title>
<path fill="none" stroke="black" d="M6883.44,-10416.87C6883.87,-10408.48 6884.32,-10399.78 6884.75,-10391.51"/>
<polygon fill="black" stroke="black" points="6888.26,-10391.47 6885.28,-10381.3 6881.27,-10391.11 6888.26,-10391.47"/>
</g>
<!-- layer10_gpu9_expert_act -->
<g id="node957" class="node">
<title>layer10_gpu9_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7088.5,-10277 6711.5,-10277 6711.5,-10209 7088.5,-10209 7088.5,-10277"/>
<text text-anchor="middle" x="6900" y="-10261.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="6900" y="-10246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6900" y="-10231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6900" y="-10216.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer10_gpu9_expert_mlp1&#45;&gt;layer10_gpu9_expert_act -->
<g id="edge1115" class="edge">
<title>layer10_gpu9_expert_mlp1&#45;&gt;layer10_gpu9_expert_act</title>
<path fill="none" stroke="black" d="M6891.22,-10312.88C6892.25,-10304.78 6893.37,-10295.98 6894.46,-10287.47"/>
<polygon fill="black" stroke="black" points="6897.96,-10287.66 6895.76,-10277.3 6891.02,-10286.77 6897.96,-10287.66"/>
</g>
<!-- layer10_gpu9_expert_mlp2 -->
<g id="node958" class="node">
<title>layer10_gpu9_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7110.5,-10173 6703.5,-10173 6703.5,-10105 7110.5,-10105 7110.5,-10173"/>
<text text-anchor="middle" x="6907" y="-10157.8" font-family="Times,serif" font-size="14.00">Expert 9 MLP2</text>
<text text-anchor="middle" x="6907" y="-10142.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6907" y="-10127.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6907" y="-10112.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer10_gpu9_expert_act&#45;&gt;layer10_gpu9_expert_mlp2 -->
<g id="edge1116" class="edge">
<title>layer10_gpu9_expert_act&#45;&gt;layer10_gpu9_expert_mlp2</title>
<path fill="none" stroke="black" d="M6902.27,-10208.88C6902.83,-10200.78 6903.43,-10191.98 6904.02,-10183.47"/>
<polygon fill="black" stroke="black" points="6907.52,-10183.51 6904.71,-10173.3 6900.54,-10183.03 6907.52,-10183.51"/>
</g>
<!-- layer10_gpu9_token_send -->
<g id="node959" class="node">
<title>layer10_gpu9_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6933" cy="-10020.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6933" y="-10039.72" font-family="Times,serif" font-size="14.00">Token Send GPU9</text>
<text text-anchor="middle" x="6933" y="-10024.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6933" y="-10009.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6933" y="-9994.72" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer10_gpu9_expert_mlp2&#45;&gt;layer10_gpu9_token_send -->
<g id="edge1117" class="edge">
<title>layer10_gpu9_expert_mlp2&#45;&gt;layer10_gpu9_token_send</title>
<path fill="none" stroke="black" d="M6914.45,-10104.73C6916.26,-10096.65 6918.25,-10087.78 6920.23,-10078.95"/>
<polygon fill="black" stroke="black" points="6923.68,-10079.55 6922.45,-10069.02 6916.85,-10078.02 6923.68,-10079.55"/>
</g>
<!-- layer10_gpu9_token_send&#45;&gt;layer10_expert_agg -->
<g id="edge1118" class="edge">
<title>layer10_gpu9_token_send&#45;&gt;layer10_expert_agg</title>
<path fill="none" stroke="black" d="M6685.48,-9986.33C6565.85,-9970.09 6418.43,-9950.09 6279.72,-9931.27"/>
<polygon fill="black" stroke="black" points="6280.13,-9927.79 6269.75,-9929.91 6279.19,-9934.73 6280.13,-9927.79"/>
</g>
<!-- layer10_gpu10_expert_mlp1 -->
<g id="node961" class="node">
<title>layer10_gpu10_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7815.5,-10381 7354.5,-10381 7354.5,-10313 7815.5,-10313 7815.5,-10381"/>
<text text-anchor="middle" x="7585" y="-10365.8" font-family="Times,serif" font-size="14.00">Expert 10 MLP1</text>
<text text-anchor="middle" x="7585" y="-10350.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7585" y="-10335.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7585" y="-10320.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_gpu10_token_recv&#45;&gt;layer10_gpu10_expert_mlp1 -->
<g id="edge1120" class="edge">
<title>layer10_gpu10_token_recv&#45;&gt;layer10_gpu10_expert_mlp1</title>
<path fill="none" stroke="black" d="M7578.47,-10416.87C7579.27,-10408.48 7580.09,-10399.78 7580.88,-10391.51"/>
<polygon fill="black" stroke="black" points="7584.39,-10391.59 7581.84,-10381.3 7577.42,-10390.93 7584.39,-10391.59"/>
</g>
<!-- layer10_gpu10_expert_act -->
<g id="node962" class="node">
<title>layer10_gpu10_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7795.5,-10277 7418.5,-10277 7418.5,-10209 7795.5,-10209 7795.5,-10277"/>
<text text-anchor="middle" x="7607" y="-10261.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="7607" y="-10246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7607" y="-10231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7607" y="-10216.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_gpu10_expert_mlp1&#45;&gt;layer10_gpu10_expert_act -->
<g id="edge1121" class="edge">
<title>layer10_gpu10_expert_mlp1&#45;&gt;layer10_gpu10_expert_act</title>
<path fill="none" stroke="black" d="M7592.14,-10312.88C7593.91,-10304.69 7595.83,-10295.79 7597.68,-10287.19"/>
<polygon fill="black" stroke="black" points="7601.13,-10287.81 7599.82,-10277.3 7594.29,-10286.33 7601.13,-10287.81"/>
</g>
<!-- layer10_gpu10_expert_mlp2 -->
<g id="node963" class="node">
<title>layer10_gpu10_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7854.5,-10173 7447.5,-10173 7447.5,-10105 7854.5,-10105 7854.5,-10173"/>
<text text-anchor="middle" x="7651" y="-10157.8" font-family="Times,serif" font-size="14.00">Expert 10 MLP2</text>
<text text-anchor="middle" x="7651" y="-10142.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7651" y="-10127.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="7651" y="-10112.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_gpu10_expert_act&#45;&gt;layer10_gpu10_expert_mlp2 -->
<g id="edge1122" class="edge">
<title>layer10_gpu10_expert_act&#45;&gt;layer10_gpu10_expert_mlp2</title>
<path fill="none" stroke="black" d="M7621.29,-10208.88C7624.9,-10200.51 7628.83,-10191.4 7632.61,-10182.63"/>
<polygon fill="black" stroke="black" points="7635.89,-10183.87 7636.64,-10173.3 7629.46,-10181.09 7635.89,-10183.87"/>
</g>
<!-- layer10_gpu10_token_send -->
<g id="node964" class="node">
<title>layer10_gpu10_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="7662" cy="-10020.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="7662" y="-10039.72" font-family="Times,serif" font-size="14.00">Token Send GPU10</text>
<text text-anchor="middle" x="7662" y="-10024.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="7662" y="-10009.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="7662" y="-9994.72" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_gpu10_expert_mlp2&#45;&gt;layer10_gpu10_token_send -->
<g id="edge1123" class="edge">
<title>layer10_gpu10_expert_mlp2&#45;&gt;layer10_gpu10_token_send</title>
<path fill="none" stroke="black" d="M7654.15,-10104.73C7654.91,-10096.74 7655.74,-10087.97 7656.57,-10079.23"/>
<polygon fill="black" stroke="black" points="7660.08,-10079.31 7657.54,-10069.02 7653.11,-10078.65 7660.08,-10079.31"/>
</g>
<!-- layer10_gpu10_token_send&#45;&gt;layer10_expert_agg -->
<g id="edge1124" class="edge">
<title>layer10_gpu10_token_send&#45;&gt;layer10_expert_agg</title>
<path fill="none" stroke="black" d="M7416.01,-9986.1C7376.59,-9981.26 7336.2,-9976.64 7298,-9972.83 6936.07,-9936.78 6522.8,-9909.02 6226.65,-9891.45"/>
<polygon fill="black" stroke="black" points="6226.79,-9887.96 6216.6,-9890.86 6226.38,-9894.95 6226.79,-9887.96"/>
</g>
<!-- layer10_gpu11_expert_mlp1 -->
<g id="node966" class="node">
<title>layer10_gpu11_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="8505.5,-10381 8044.5,-10381 8044.5,-10313 8505.5,-10313 8505.5,-10381"/>
<text text-anchor="middle" x="8275" y="-10365.8" font-family="Times,serif" font-size="14.00">Expert 11 MLP1</text>
<text text-anchor="middle" x="8275" y="-10350.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8275" y="-10335.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8275" y="-10320.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer10_gpu11_token_recv&#45;&gt;layer10_gpu11_expert_mlp1 -->
<g id="edge1126" class="edge">
<title>layer10_gpu11_token_recv&#45;&gt;layer10_gpu11_expert_mlp1</title>
<path fill="none" stroke="black" d="M8268.47,-10416.87C8269.27,-10408.48 8270.09,-10399.78 8270.88,-10391.51"/>
<polygon fill="black" stroke="black" points="8274.39,-10391.59 8271.84,-10381.3 8267.42,-10390.93 8274.39,-10391.59"/>
</g>
<!-- layer10_gpu11_expert_act -->
<g id="node967" class="node">
<title>layer10_gpu11_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="8474.5,-10277 8097.5,-10277 8097.5,-10209 8474.5,-10209 8474.5,-10277"/>
<text text-anchor="middle" x="8286" y="-10261.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="8286" y="-10246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8286" y="-10231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8286" y="-10216.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer10_gpu11_expert_mlp1&#45;&gt;layer10_gpu11_expert_act -->
<g id="edge1127" class="edge">
<title>layer10_gpu11_expert_mlp1&#45;&gt;layer10_gpu11_expert_act</title>
<path fill="none" stroke="black" d="M8278.57,-10312.88C8279.45,-10304.78 8280.39,-10295.98 8281.31,-10287.47"/>
<polygon fill="black" stroke="black" points="8284.82,-10287.62 8282.41,-10277.3 8277.86,-10286.86 8284.82,-10287.62"/>
</g>
<!-- layer10_gpu11_expert_mlp2 -->
<g id="node968" class="node">
<title>layer10_gpu11_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="8510.5,-10173 8103.5,-10173 8103.5,-10105 8510.5,-10105 8510.5,-10173"/>
<text text-anchor="middle" x="8307" y="-10157.8" font-family="Times,serif" font-size="14.00">Expert 11 MLP2</text>
<text text-anchor="middle" x="8307" y="-10142.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8307" y="-10127.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="8307" y="-10112.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer10_gpu11_expert_act&#45;&gt;layer10_gpu11_expert_mlp2 -->
<g id="edge1128" class="edge">
<title>layer10_gpu11_expert_act&#45;&gt;layer10_gpu11_expert_mlp2</title>
<path fill="none" stroke="black" d="M8292.82,-10208.88C8294.51,-10200.69 8296.34,-10191.79 8298.11,-10183.19"/>
<polygon fill="black" stroke="black" points="8301.56,-10183.8 8300.14,-10173.3 8294.7,-10182.39 8301.56,-10183.8"/>
</g>
<!-- layer10_gpu11_token_send -->
<g id="node969" class="node">
<title>layer10_gpu11_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="8391" cy="-10020.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="8391" y="-10039.72" font-family="Times,serif" font-size="14.00">Token Send GPU11</text>
<text text-anchor="middle" x="8391" y="-10024.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="8391" y="-10009.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="8391" y="-9994.72" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer10_gpu11_expert_mlp2&#45;&gt;layer10_gpu11_token_send -->
<g id="edge1129" class="edge">
<title>layer10_gpu11_expert_mlp2&#45;&gt;layer10_gpu11_token_send</title>
<path fill="none" stroke="black" d="M8331.07,-10104.73C8337.3,-10096.13 8344.17,-10086.64 8350.97,-10077.24"/>
<polygon fill="black" stroke="black" points="8353.88,-10079.18 8356.91,-10069.02 8348.21,-10075.07 8353.88,-10079.18"/>
</g>
<!-- layer10_gpu11_token_send&#45;&gt;layer10_expert_agg -->
<g id="edge1130" class="edge">
<title>layer10_gpu11_token_send&#45;&gt;layer10_expert_agg</title>
<path fill="none" stroke="black" d="M8148.02,-9985.68C8107.66,-9980.8 8066.2,-9976.28 8027,-9972.83 7391,-9916.9 6648.71,-9890.12 6209.36,-9878.25"/>
<polygon fill="black" stroke="black" points="6209.46,-9874.75 6199.37,-9877.98 6209.27,-9881.75 6209.46,-9874.75"/>
</g>
<!-- layer10_gpu12_expert_mlp1 -->
<g id="node971" class="node">
<title>layer10_gpu12_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9203.5,-10381 8742.5,-10381 8742.5,-10313 9203.5,-10313 9203.5,-10381"/>
<text text-anchor="middle" x="8973" y="-10365.8" font-family="Times,serif" font-size="14.00">Expert 12 MLP1</text>
<text text-anchor="middle" x="8973" y="-10350.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8973" y="-10335.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8973" y="-10320.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer10_gpu12_token_recv&#45;&gt;layer10_gpu12_expert_mlp1 -->
<g id="edge1132" class="edge">
<title>layer10_gpu12_token_recv&#45;&gt;layer10_gpu12_expert_mlp1</title>
<path fill="none" stroke="black" d="M8960.54,-10416.87C8962.08,-10408.39 8963.67,-10399.59 8965.18,-10391.23"/>
<polygon fill="black" stroke="black" points="8968.64,-10391.77 8966.98,-10381.3 8961.75,-10390.52 8968.64,-10391.77"/>
</g>
<!-- layer10_gpu12_expert_act -->
<g id="node972" class="node">
<title>layer10_gpu12_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9203.5,-10277 8826.5,-10277 8826.5,-10209 9203.5,-10209 9203.5,-10277"/>
<text text-anchor="middle" x="9015" y="-10261.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="9015" y="-10246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9015" y="-10231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9015" y="-10216.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer10_gpu12_expert_mlp1&#45;&gt;layer10_gpu12_expert_act -->
<g id="edge1133" class="edge">
<title>layer10_gpu12_expert_mlp1&#45;&gt;layer10_gpu12_expert_act</title>
<path fill="none" stroke="black" d="M8986.64,-10312.88C8990.08,-10304.51 8993.83,-10295.4 8997.45,-10286.63"/>
<polygon fill="black" stroke="black" points="9000.72,-10287.88 9001.29,-10277.3 8994.24,-10285.21 9000.72,-10287.88"/>
</g>
<!-- layer10_gpu12_expert_mlp2 -->
<g id="node973" class="node">
<title>layer10_gpu12_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9302.5,-10173 8895.5,-10173 8895.5,-10105 9302.5,-10105 9302.5,-10173"/>
<text text-anchor="middle" x="9099" y="-10157.8" font-family="Times,serif" font-size="14.00">Expert 12 MLP2</text>
<text text-anchor="middle" x="9099" y="-10142.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9099" y="-10127.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9099" y="-10112.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer10_gpu12_expert_act&#45;&gt;layer10_gpu12_expert_mlp2 -->
<g id="edge1134" class="edge">
<title>layer10_gpu12_expert_act&#45;&gt;layer10_gpu12_expert_mlp2</title>
<path fill="none" stroke="black" d="M9042.27,-10208.88C9049.53,-10200.06 9057.47,-10190.43 9065.04,-10181.23"/>
<polygon fill="black" stroke="black" points="9067.92,-10183.24 9071.58,-10173.3 9062.52,-10178.79 9067.92,-10183.24"/>
</g>
<!-- layer10_gpu12_token_send -->
<g id="node974" class="node">
<title>layer10_gpu12_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9120" cy="-10020.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9120" y="-10039.72" font-family="Times,serif" font-size="14.00">Token Send GPU12</text>
<text text-anchor="middle" x="9120" y="-10024.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9120" y="-10009.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9120" y="-9994.72" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer10_gpu12_expert_mlp2&#45;&gt;layer10_gpu12_token_send -->
<g id="edge1135" class="edge">
<title>layer10_gpu12_expert_mlp2&#45;&gt;layer10_gpu12_token_send</title>
<path fill="none" stroke="black" d="M9105.02,-10104.73C9106.48,-10096.65 9108.08,-10087.78 9109.68,-10078.95"/>
<polygon fill="black" stroke="black" points="9113.14,-10079.49 9111.48,-10069.02 9106.25,-10078.24 9113.14,-10079.49"/>
</g>
<!-- layer10_gpu12_token_send&#45;&gt;layer10_expert_agg -->
<g id="edge1136" class="edge">
<title>layer10_gpu12_token_send&#45;&gt;layer10_expert_agg</title>
<path fill="none" stroke="black" d="M8879.02,-9985.52C8838.04,-9980.6 8795.85,-9976.1 8756,-9972.83 7839.94,-9897.64 6758.3,-9877.28 6200.86,-9871.81"/>
<polygon fill="black" stroke="black" points="6200.69,-9868.31 6190.65,-9871.71 6200.62,-9875.31 6200.69,-9868.31"/>
</g>
<!-- layer10_gpu13_expert_mlp1 -->
<g id="node976" class="node">
<title>layer10_gpu13_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="10000.5,-10381 9539.5,-10381 9539.5,-10313 10000.5,-10313 10000.5,-10381"/>
<text text-anchor="middle" x="9770" y="-10365.8" font-family="Times,serif" font-size="14.00">Expert 13 MLP1</text>
<text text-anchor="middle" x="9770" y="-10350.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9770" y="-10335.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9770" y="-10320.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer10_gpu13_token_recv&#45;&gt;layer10_gpu13_expert_mlp1 -->
<g id="edge1138" class="edge">
<title>layer10_gpu13_token_recv&#45;&gt;layer10_gpu13_expert_mlp1</title>
<path fill="none" stroke="black" d="M9692.13,-10417.53C9703.04,-10407.79 9714.46,-10397.59 9725.08,-10388.11"/>
<polygon fill="black" stroke="black" points="9727.53,-10390.61 9732.66,-10381.34 9722.87,-10385.39 9727.53,-10390.61"/>
</g>
<!-- layer10_gpu13_expert_act -->
<g id="node977" class="node">
<title>layer10_gpu13_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9972.5,-10277 9595.5,-10277 9595.5,-10209 9972.5,-10209 9972.5,-10277"/>
<text text-anchor="middle" x="9784" y="-10261.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="9784" y="-10246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9784" y="-10231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9784" y="-10216.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer10_gpu13_expert_mlp1&#45;&gt;layer10_gpu13_expert_act -->
<g id="edge1139" class="edge">
<title>layer10_gpu13_expert_mlp1&#45;&gt;layer10_gpu13_expert_act</title>
<path fill="none" stroke="black" d="M9774.55,-10312.88C9775.66,-10304.78 9776.87,-10295.98 9778.03,-10287.47"/>
<polygon fill="black" stroke="black" points="9781.54,-10287.68 9779.43,-10277.3 9774.6,-10286.73 9781.54,-10287.68"/>
</g>
<!-- layer10_gpu13_expert_mlp2 -->
<g id="node978" class="node">
<title>layer10_gpu13_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10039.5,-10173 9632.5,-10173 9632.5,-10105 10039.5,-10105 10039.5,-10173"/>
<text text-anchor="middle" x="9836" y="-10157.8" font-family="Times,serif" font-size="14.00">Expert 13 MLP2</text>
<text text-anchor="middle" x="9836" y="-10142.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9836" y="-10127.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9836" y="-10112.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer10_gpu13_expert_act&#45;&gt;layer10_gpu13_expert_mlp2 -->
<g id="edge1140" class="edge">
<title>layer10_gpu13_expert_act&#45;&gt;layer10_gpu13_expert_mlp2</title>
<path fill="none" stroke="black" d="M9800.88,-10208.88C9805.2,-10200.42 9809.89,-10191.21 9814.41,-10182.35"/>
<polygon fill="black" stroke="black" points="9817.6,-10183.8 9819.02,-10173.3 9811.36,-10180.62 9817.6,-10183.8"/>
</g>
<!-- layer10_gpu13_token_send -->
<g id="node979" class="node">
<title>layer10_gpu13_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9849" cy="-10020.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9849" y="-10039.72" font-family="Times,serif" font-size="14.00">Token Send GPU13</text>
<text text-anchor="middle" x="9849" y="-10024.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9849" y="-10009.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9849" y="-9994.72" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer10_gpu13_expert_mlp2&#45;&gt;layer10_gpu13_token_send -->
<g id="edge1141" class="edge">
<title>layer10_gpu13_expert_mlp2&#45;&gt;layer10_gpu13_token_send</title>
<path fill="none" stroke="black" d="M9839.73,-10104.73C9840.62,-10096.74 9841.6,-10087.97 9842.58,-10079.23"/>
<polygon fill="black" stroke="black" points="9846.09,-10079.35 9843.72,-10069.02 9839.13,-10078.57 9846.09,-10079.35"/>
</g>
<!-- layer10_gpu13_token_send&#45;&gt;layer10_expert_agg -->
<g id="edge1142" class="edge">
<title>layer10_gpu13_token_send&#45;&gt;layer10_expert_agg</title>
<path fill="none" stroke="black" d="M9609.01,-9985.4C9567.72,-9980.46 9525.18,-9975.99 9485,-9972.83 8857.29,-9923.52 7008.68,-9888.82 6206.08,-9875.67"/>
<polygon fill="black" stroke="black" points="6205.86,-9872.17 6195.81,-9875.5 6205.75,-9879.17 6205.86,-9872.17"/>
</g>
<!-- layer10_gpu14_expert_mlp1 -->
<g id="node981" class="node">
<title>layer10_gpu14_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="10583.5,-10381 10122.5,-10381 10122.5,-10313 10583.5,-10313 10583.5,-10381"/>
<text text-anchor="middle" x="10353" y="-10365.8" font-family="Times,serif" font-size="14.00">Expert 14 MLP1</text>
<text text-anchor="middle" x="10353" y="-10350.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10353" y="-10335.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10353" y="-10320.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer10_gpu14_token_recv&#45;&gt;layer10_gpu14_expert_mlp1 -->
<g id="edge1144" class="edge">
<title>layer10_gpu14_token_recv&#45;&gt;layer10_gpu14_expert_mlp1</title>
<path fill="none" stroke="black" d="M10337.58,-10416.87C10339.47,-10408.39 10341.44,-10399.59 10343.32,-10391.23"/>
<polygon fill="black" stroke="black" points="10346.77,-10391.83 10345.54,-10381.3 10339.94,-10390.3 10346.77,-10391.83"/>
</g>
<!-- layer10_gpu14_expert_act -->
<g id="node982" class="node">
<title>layer10_gpu14_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="10591.5,-10277 10214.5,-10277 10214.5,-10209 10591.5,-10209 10591.5,-10277"/>
<text text-anchor="middle" x="10403" y="-10261.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="10403" y="-10246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10403" y="-10231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10403" y="-10216.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer10_gpu14_expert_mlp1&#45;&gt;layer10_gpu14_expert_act -->
<g id="edge1145" class="edge">
<title>layer10_gpu14_expert_mlp1&#45;&gt;layer10_gpu14_expert_act</title>
<path fill="none" stroke="black" d="M10369.23,-10312.88C10373.38,-10304.42 10377.9,-10295.21 10382.24,-10286.35"/>
<polygon fill="black" stroke="black" points="10385.42,-10287.82 10386.68,-10277.3 10379.13,-10284.74 10385.42,-10287.82"/>
</g>
<!-- layer10_gpu14_expert_mlp2 -->
<g id="node983" class="node">
<title>layer10_gpu14_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10731.5,-10173 10324.5,-10173 10324.5,-10105 10731.5,-10105 10731.5,-10173"/>
<text text-anchor="middle" x="10528" y="-10157.8" font-family="Times,serif" font-size="14.00">Expert 14 MLP2</text>
<text text-anchor="middle" x="10528" y="-10142.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10528" y="-10127.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="10528" y="-10112.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer10_gpu14_expert_act&#45;&gt;layer10_gpu14_expert_mlp2 -->
<g id="edge1146" class="edge">
<title>layer10_gpu14_expert_act&#45;&gt;layer10_gpu14_expert_mlp2</title>
<path fill="none" stroke="black" d="M10443.58,-10208.88C10454.94,-10199.62 10467.39,-10189.45 10479.17,-10179.84"/>
<polygon fill="black" stroke="black" points="10481.66,-10182.33 10487.19,-10173.3 10477.23,-10176.91 10481.66,-10182.33"/>
</g>
<!-- layer10_gpu14_token_send -->
<g id="node984" class="node">
<title>layer10_gpu14_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="10578" cy="-10020.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="10578" y="-10039.72" font-family="Times,serif" font-size="14.00">Token Send GPU14</text>
<text text-anchor="middle" x="10578" y="-10024.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="10578" y="-10009.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="10578" y="-9994.72" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer10_gpu14_expert_mlp2&#45;&gt;layer10_gpu14_token_send -->
<g id="edge1147" class="edge">
<title>layer10_gpu14_expert_mlp2&#45;&gt;layer10_gpu14_token_send</title>
<path fill="none" stroke="black" d="M10542.33,-10104.73C10545.88,-10096.48 10549.79,-10087.4 10553.68,-10078.38"/>
<polygon fill="black" stroke="black" points="10556.97,-10079.59 10557.71,-10069.02 10550.54,-10076.82 10556.97,-10079.59"/>
</g>
<!-- layer10_gpu14_token_send&#45;&gt;layer10_expert_agg -->
<g id="edge1148" class="edge">
<title>layer10_gpu14_token_send&#45;&gt;layer10_expert_agg</title>
<path fill="none" stroke="black" d="M10338.52,-9985.3C10297.07,-9980.35 10254.35,-9975.91 10214,-9972.83 9439.88,-9913.84 7117.69,-9883.49 6203.09,-9873.57"/>
<polygon fill="black" stroke="black" points="6203.1,-9870.07 6193.06,-9873.46 6203.02,-9877.07 6203.1,-9870.07"/>
</g>
<!-- layer10_gpu15_expert_mlp1 -->
<g id="node986" class="node">
<title>layer10_gpu15_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="11408.5,-10381 10947.5,-10381 10947.5,-10313 11408.5,-10313 11408.5,-10381"/>
<text text-anchor="middle" x="11178" y="-10365.8" font-family="Times,serif" font-size="14.00">Expert 15 MLP1</text>
<text text-anchor="middle" x="11178" y="-10350.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="11178" y="-10335.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11178" y="-10320.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer10_gpu15_token_recv&#45;&gt;layer10_gpu15_expert_mlp1 -->
<g id="edge1150" class="edge">
<title>layer10_gpu15_token_recv&#45;&gt;layer10_gpu15_expert_mlp1</title>
<path fill="none" stroke="black" d="M11167.32,-10416.87C11168.64,-10408.39 11170,-10399.59 11171.3,-10391.23"/>
<polygon fill="black" stroke="black" points="11174.76,-10391.72 11172.84,-10381.3 11167.84,-10390.65 11174.76,-10391.72"/>
</g>
<!-- layer10_gpu15_expert_act -->
<g id="node987" class="node">
<title>layer10_gpu15_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="11403.5,-10277 11026.5,-10277 11026.5,-10209 11403.5,-10209 11403.5,-10277"/>
<text text-anchor="middle" x="11215" y="-10261.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="11215" y="-10246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11215" y="-10231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11215" y="-10216.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer10_gpu15_expert_mlp1&#45;&gt;layer10_gpu15_expert_act -->
<g id="edge1151" class="edge">
<title>layer10_gpu15_expert_mlp1&#45;&gt;layer10_gpu15_expert_act</title>
<path fill="none" stroke="black" d="M11190.01,-10312.88C11193.02,-10304.6 11196.28,-10295.59 11199.43,-10286.91"/>
<polygon fill="black" stroke="black" points="11202.8,-10287.89 11202.92,-10277.3 11196.22,-10285.5 11202.8,-10287.89"/>
</g>
<!-- layer10_gpu15_expert_mlp2 -->
<g id="node988" class="node">
<title>layer10_gpu15_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="11491.5,-10173 11084.5,-10173 11084.5,-10105 11491.5,-10105 11491.5,-10173"/>
<text text-anchor="middle" x="11288" y="-10157.8" font-family="Times,serif" font-size="14.00">Expert 15 MLP2</text>
<text text-anchor="middle" x="11288" y="-10142.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11288" y="-10127.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="11288" y="-10112.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer10_gpu15_expert_act&#45;&gt;layer10_gpu15_expert_mlp2 -->
<g id="edge1152" class="edge">
<title>layer10_gpu15_expert_act&#45;&gt;layer10_gpu15_expert_mlp2</title>
<path fill="none" stroke="black" d="M11238.7,-10208.88C11244.95,-10200.15 11251.77,-10190.62 11258.29,-10181.51"/>
<polygon fill="black" stroke="black" points="11261.19,-10183.47 11264.17,-10173.3 11255.5,-10179.39 11261.19,-10183.47"/>
</g>
<!-- layer10_gpu15_token_send -->
<g id="node989" class="node">
<title>layer10_gpu15_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="11307" cy="-10020.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="11307" y="-10039.72" font-family="Times,serif" font-size="14.00">Token Send GPU15</text>
<text text-anchor="middle" x="11307" y="-10024.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="11307" y="-10009.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="11307" y="-9994.72" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer10_gpu15_expert_mlp2&#45;&gt;layer10_gpu15_token_send -->
<g id="edge1153" class="edge">
<title>layer10_gpu15_expert_mlp2&#45;&gt;layer10_gpu15_token_send</title>
<path fill="none" stroke="black" d="M11293.44,-10104.73C11294.77,-10096.65 11296.22,-10087.78 11297.67,-10078.95"/>
<polygon fill="black" stroke="black" points="11301.13,-10079.46 11299.29,-10069.02 11294.22,-10078.33 11301.13,-10079.46"/>
</g>
<!-- layer10_gpu15_token_send&#45;&gt;layer10_expert_agg -->
<g id="edge1154" class="edge">
<title>layer10_gpu15_token_send&#45;&gt;layer10_expert_agg</title>
<path fill="none" stroke="black" d="M11068.01,-9985.24C11026.42,-9980.29 10983.51,-9975.85 10943,-9972.83 10021.37,-9904.15 7218.46,-9879.07 6201.05,-9872.09"/>
<polygon fill="black" stroke="black" points="6201.04,-9868.59 6191.01,-9872.02 6200.99,-9875.59 6201.04,-9868.59"/>
</g>
<!-- layer10_residual2 -->
<g id="node991" class="node">
<title>layer10_residual2</title>
<polygon fill="lightyellow" stroke="black" points="6269.89,-9764.83 5565.35,-9764.83 5384.11,-9628.83 6088.65,-9628.83 6269.89,-9764.83"/>
<text text-anchor="middle" x="5827" y="-9715.63" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="5827" y="-9700.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5827" y="-9685.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5827" y="-9670.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer10_expert_agg&#45;&gt;layer10_residual2 -->
<g id="edge1155" class="edge">
<title>layer10_expert_agg&#45;&gt;layer10_residual2</title>
<path fill="none" stroke="black" d="M5827,-9800.64C5827,-9792.33 5827,-9783.78 5827,-9775.33"/>
<polygon fill="black" stroke="black" points="5830.5,-9775.09 5827,-9765.09 5823.5,-9775.09 5830.5,-9775.09"/>
</g>
<!-- layer11_layernorm -->
<g id="node992" class="node">
<title>layer11_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="6030.5,-9581.83 5623.5,-9581.83 5623.5,-9513.83 6030.5,-9513.83 6030.5,-9581.83"/>
<text text-anchor="middle" x="5827" y="-9566.63" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5827" y="-9551.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5827" y="-9536.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5827" y="-9521.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer10_residual2&#45;&gt;layer11_layernorm -->
<g id="edge1156" class="edge">
<title>layer10_residual2&#45;&gt;layer11_layernorm</title>
<path fill="none" stroke="black" d="M5827,-9628.78C5827,-9616.38 5827,-9603.72 5827,-9592.25"/>
<polygon fill="black" stroke="black" points="5830.5,-9592.09 5827,-9582.09 5823.5,-9592.09 5830.5,-9592.09"/>
</g>
<!-- layer11_qkv_proj -->
<g id="node993" class="node">
<title>layer11_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="6084.5,-9477.83 5569.5,-9477.83 5569.5,-9409.83 6084.5,-9409.83 6084.5,-9477.83"/>
<text text-anchor="middle" x="5827" y="-9462.63" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5827" y="-9447.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5827" y="-9432.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5827" y="-9417.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer11_layernorm&#45;&gt;layer11_qkv_proj -->
<g id="edge1157" class="edge">
<title>layer11_layernorm&#45;&gt;layer11_qkv_proj</title>
<path fill="none" stroke="black" d="M5827,-9513.72C5827,-9505.61 5827,-9496.81 5827,-9488.3"/>
<polygon fill="black" stroke="black" points="5830.5,-9488.13 5827,-9478.13 5823.5,-9488.13 5830.5,-9488.13"/>
</g>
<!-- layer11_attention -->
<g id="node994" class="node">
<title>layer11_attention</title>
<polygon fill="lightgreen" stroke="black" points="6078.5,-9373.83 5575.5,-9373.83 5575.5,-9305.83 6078.5,-9305.83 6078.5,-9373.83"/>
<text text-anchor="middle" x="5827" y="-9358.63" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5827" y="-9343.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5827" y="-9328.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5827" y="-9313.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer11_qkv_proj&#45;&gt;layer11_attention -->
<g id="edge1158" class="edge">
<title>layer11_qkv_proj&#45;&gt;layer11_attention</title>
<path fill="none" stroke="black" d="M5827,-9409.72C5827,-9401.61 5827,-9392.81 5827,-9384.3"/>
<polygon fill="black" stroke="black" points="5830.5,-9384.13 5827,-9374.13 5823.5,-9384.13 5830.5,-9384.13"/>
</g>
<!-- layer11_attn_out -->
<g id="node995" class="node">
<title>layer11_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="6065.5,-9269.83 5588.5,-9269.83 5588.5,-9201.83 6065.5,-9201.83 6065.5,-9269.83"/>
<text text-anchor="middle" x="5827" y="-9254.63" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5827" y="-9239.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5827" y="-9224.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5827" y="-9209.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer11_attention&#45;&gt;layer11_attn_out -->
<g id="edge1159" class="edge">
<title>layer11_attention&#45;&gt;layer11_attn_out</title>
<path fill="none" stroke="black" d="M5827,-9305.72C5827,-9297.61 5827,-9288.81 5827,-9280.3"/>
<polygon fill="black" stroke="black" points="5830.5,-9280.13 5827,-9270.13 5823.5,-9280.13 5830.5,-9280.13"/>
</g>
<!-- layer11_residual1 -->
<g id="node996" class="node">
<title>layer11_residual1</title>
<polygon fill="lightyellow" stroke="black" points="6269.89,-9165.83 5565.35,-9165.83 5384.11,-9029.83 6088.65,-9029.83 6269.89,-9165.83"/>
<text text-anchor="middle" x="5827" y="-9116.63" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5827" y="-9101.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5827" y="-9086.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5827" y="-9071.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer11_attn_out&#45;&gt;layer11_residual1 -->
<g id="edge1160" class="edge">
<title>layer11_attn_out&#45;&gt;layer11_residual1</title>
<path fill="none" stroke="black" d="M5827,-9201.56C5827,-9193.73 5827,-9185.07 5827,-9176.18"/>
<polygon fill="black" stroke="black" points="5830.5,-9176.09 5827,-9166.09 5823.5,-9176.09 5830.5,-9176.09"/>
</g>
<!-- layer11_layernorm2 -->
<g id="node997" class="node">
<title>layer11_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="6030.5,-8993.83 5623.5,-8993.83 5623.5,-8925.83 6030.5,-8925.83 6030.5,-8993.83"/>
<text text-anchor="middle" x="5827" y="-8978.63" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5827" y="-8963.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5827" y="-8948.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5827" y="-8933.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer11_residual1&#45;&gt;layer11_layernorm2 -->
<g id="edge1161" class="edge">
<title>layer11_residual1&#45;&gt;layer11_layernorm2</title>
<path fill="none" stroke="black" d="M5827,-9029.63C5827,-9020.88 5827,-9012.11 5827,-9003.9"/>
<polygon fill="black" stroke="black" points="5830.5,-9003.85 5827,-8993.85 5823.5,-9003.85 5830.5,-9003.85"/>
</g>
<!-- layer11_global_gate -->
<g id="node998" class="node">
<title>layer11_global_gate</title>
<polygon fill="lightgreen" stroke="black" points="6024.5,-8889.83 5629.5,-8889.83 5629.5,-8821.83 6024.5,-8821.83 6024.5,-8889.83"/>
<text text-anchor="middle" x="5827" y="-8874.63" font-family="Times,serif" font-size="14.00">Global Gate</text>
<text text-anchor="middle" x="5827" y="-8859.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5827" y="-8844.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, experts=64]</text>
<text text-anchor="middle" x="5827" y="-8829.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer11_layernorm2&#45;&gt;layer11_global_gate -->
<g id="edge1162" class="edge">
<title>layer11_layernorm2&#45;&gt;layer11_global_gate</title>
<path fill="none" stroke="black" d="M5827,-8925.72C5827,-8917.61 5827,-8908.81 5827,-8900.3"/>
<polygon fill="black" stroke="black" points="5830.5,-8900.13 5827,-8890.13 5823.5,-8900.13 5830.5,-8900.13"/>
</g>
<!-- layer11_routing -->
<g id="node999" class="node">
<title>layer11_routing</title>
<polygon fill="lightyellow" stroke="black" points="6313.47,-8785.83 5539.6,-8785.83 5340.53,-8649.83 6114.4,-8649.83 6313.47,-8785.83"/>
<text text-anchor="middle" x="5827" y="-8736.63" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="5827" y="-8721.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5827" y="-8706.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5827" y="-8691.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer11_global_gate&#45;&gt;layer11_routing -->
<g id="edge1163" class="edge">
<title>layer11_global_gate&#45;&gt;layer11_routing</title>
<path fill="none" stroke="black" d="M5827,-8821.56C5827,-8813.73 5827,-8805.07 5827,-8796.18"/>
<polygon fill="black" stroke="black" points="5830.5,-8796.09 5827,-8786.09 5823.5,-8796.09 5830.5,-8796.09"/>
</g>
<!-- layer11_gpu0_token_recv -->
<g id="node1000" class="node">
<title>layer11_gpu0_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="504" cy="-8565.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="504" y="-8584.55" font-family="Times,serif" font-size="14.00">Token Receive GPU0</text>
<text text-anchor="middle" x="504" y="-8569.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="504" y="-8554.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="504" y="-8539.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer11_routing&#45;&gt;layer11_gpu0_token_recv -->
<g id="edge1164" class="edge">
<title>layer11_routing&#45;&gt;layer11_gpu0_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5434.22,-8714.13C4424.04,-8706.31 1753.18,-8679.85 869,-8613.83 829.12,-8610.85 786.92,-8606.52 745.93,-8601.67"/>
<polygon fill="black" stroke="black" points="746.16,-8598.17 735.81,-8600.46 745.32,-8605.12 746.16,-8598.17"/>
</g>
<!-- layer11_gpu1_token_recv -->
<g id="node1005" class="node">
<title>layer11_gpu1_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1212" cy="-8565.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1212" y="-8584.55" font-family="Times,serif" font-size="14.00">Token Receive GPU1</text>
<text text-anchor="middle" x="1212" y="-8569.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1212" y="-8554.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1212" y="-8539.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer11_routing&#45;&gt;layer11_gpu1_token_recv -->
<g id="edge1170" class="edge">
<title>layer11_routing&#45;&gt;layer11_gpu1_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5432.34,-8712.62C4525.56,-8702.09 2314.49,-8671.21 1572,-8613.83 1533.33,-8610.84 1492.45,-8606.57 1452.65,-8601.8"/>
<polygon fill="black" stroke="black" points="1452.91,-8598.31 1442.56,-8600.58 1452.07,-8605.26 1452.91,-8598.31"/>
</g>
<!-- layer11_gpu2_token_recv -->
<g id="node1010" class="node">
<title>layer11_gpu2_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1915" cy="-8565.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1915" y="-8584.55" font-family="Times,serif" font-size="14.00">Token Receive GPU2</text>
<text text-anchor="middle" x="1915" y="-8569.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1915" y="-8554.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1915" y="-8539.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer11_routing&#45;&gt;layer11_gpu2_token_recv -->
<g id="edge1176" class="edge">
<title>layer11_routing&#45;&gt;layer11_gpu2_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5438.99,-8717.17C4788.96,-8715.12 3439.15,-8699.69 2301,-8613.83 2256.63,-8610.48 2209.52,-8605.74 2164.02,-8600.54"/>
<polygon fill="black" stroke="black" points="2164.36,-8597.06 2154.03,-8599.39 2163.56,-8604.01 2164.36,-8597.06"/>
</g>
<!-- layer11_gpu3_token_recv -->
<g id="node1015" class="node">
<title>layer11_gpu3_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="2644" cy="-8565.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2644" y="-8584.55" font-family="Times,serif" font-size="14.00">Token Receive GPU3</text>
<text text-anchor="middle" x="2644" y="-8569.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="2644" y="-8554.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2644" y="-8539.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer11_routing&#45;&gt;layer11_gpu3_token_recv -->
<g id="edge1182" class="edge">
<title>layer11_routing&#45;&gt;layer11_gpu3_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5433.98,-8713.83C4888.76,-8707.09 3872.43,-8685.15 3009,-8613.83 2969.73,-8610.59 2928.21,-8606.18 2887.78,-8601.35"/>
<polygon fill="black" stroke="black" points="2888.16,-8597.86 2877.81,-8600.14 2887.32,-8604.81 2888.16,-8597.86"/>
</g>
<!-- layer11_gpu4_token_recv -->
<g id="node1020" class="node">
<title>layer11_gpu4_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="3352" cy="-8565.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="3352" y="-8584.55" font-family="Times,serif" font-size="14.00">Token Receive GPU4</text>
<text text-anchor="middle" x="3352" y="-8569.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="3352" y="-8554.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3352" y="-8539.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer11_routing&#45;&gt;layer11_gpu4_token_recv -->
<g id="edge1188" class="edge">
<title>layer11_routing&#45;&gt;layer11_gpu4_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5424.54,-8707.48C4996.84,-8695.17 4301.14,-8668.35 3703,-8613.83 3667.46,-8610.59 3629.99,-8606.4 3593.3,-8601.86"/>
<polygon fill="black" stroke="black" points="3593.33,-8598.33 3582.97,-8600.57 3592.46,-8605.28 3593.33,-8598.33"/>
</g>
<!-- layer11_gpu5_token_recv -->
<g id="node1025" class="node">
<title>layer11_gpu5_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4046" cy="-8565.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4046" y="-8584.55" font-family="Times,serif" font-size="14.00">Token Receive GPU5</text>
<text text-anchor="middle" x="4046" y="-8569.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4046" y="-8554.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4046" y="-8539.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer11_routing&#45;&gt;layer11_gpu5_token_recv -->
<g id="edge1194" class="edge">
<title>layer11_routing&#45;&gt;layer11_gpu5_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5399.94,-8690.59C5123.58,-8672.31 4756.17,-8645.55 4432,-8613.83 4389.77,-8609.7 4345.01,-8604.76 4301.5,-8599.65"/>
<polygon fill="black" stroke="black" points="4301.7,-8596.15 4291.36,-8598.46 4300.88,-8603.11 4301.7,-8596.15"/>
</g>
<!-- layer11_gpu6_token_recv -->
<g id="node1030" class="node">
<title>layer11_gpu6_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4775" cy="-8565.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4775" y="-8584.55" font-family="Times,serif" font-size="14.00">Token Receive GPU6</text>
<text text-anchor="middle" x="4775" y="-8569.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4775" y="-8554.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4775" y="-8539.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer11_routing&#45;&gt;layer11_gpu6_token_recv -->
<g id="edge1200" class="edge">
<title>layer11_routing&#45;&gt;layer11_gpu6_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5357.15,-8649.8C5240.45,-8633.15 5120.02,-8615.97 5019.2,-8601.59"/>
<polygon fill="black" stroke="black" points="5019.58,-8598.11 5009.19,-8600.16 5018.6,-8605.04 5019.58,-8598.11"/>
</g>
<!-- layer11_gpu7_token_recv -->
<g id="node1035" class="node">
<title>layer11_gpu7_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="5483" cy="-8565.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="5483" y="-8584.55" font-family="Times,serif" font-size="14.00">Token Receive GPU7</text>
<text text-anchor="middle" x="5483" y="-8569.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5483" y="-8554.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5483" y="-8539.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer11_routing&#45;&gt;layer11_gpu7_token_recv -->
<g id="edge1206" class="edge">
<title>layer11_routing&#45;&gt;layer11_gpu7_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5673.36,-8649.8C5647.17,-8638.37 5620.4,-8626.69 5595.52,-8615.84"/>
<polygon fill="black" stroke="black" points="5596.65,-8612.52 5586.09,-8611.72 5593.85,-8618.93 5596.65,-8612.52"/>
</g>
<!-- layer11_gpu8_token_recv -->
<g id="node1040" class="node">
<title>layer11_gpu8_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6171" cy="-8565.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6171" y="-8584.55" font-family="Times,serif" font-size="14.00">Token Receive GPU8</text>
<text text-anchor="middle" x="6171" y="-8569.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6171" y="-8554.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6171" y="-8539.55" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer11_routing&#45;&gt;layer11_gpu8_token_recv -->
<g id="edge1212" class="edge">
<title>layer11_routing&#45;&gt;layer11_gpu8_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5980.64,-8649.8C6006.83,-8638.37 6033.6,-8626.69 6058.48,-8615.84"/>
<polygon fill="black" stroke="black" points="6060.15,-8618.93 6067.91,-8611.72 6057.35,-8612.52 6060.15,-8618.93"/>
</g>
<!-- layer11_gpu9_token_recv -->
<g id="node1045" class="node">
<title>layer11_gpu9_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6858" cy="-8565.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6858" y="-8584.55" font-family="Times,serif" font-size="14.00">Token Receive GPU9</text>
<text text-anchor="middle" x="6858" y="-8569.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6858" y="-8554.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6858" y="-8539.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer11_routing&#45;&gt;layer11_gpu9_token_recv -->
<g id="edge1218" class="edge">
<title>layer11_routing&#45;&gt;layer11_gpu9_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6145.1,-8670.53C6296.9,-8648.43 6475.6,-8622.42 6616.11,-8601.96"/>
<polygon fill="black" stroke="black" points="6616.77,-8605.4 6626.16,-8600.5 6615.76,-8598.47 6616.77,-8605.4"/>
</g>
<!-- layer11_gpu10_token_recv -->
<g id="node1050" class="node">
<title>layer11_gpu10_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="7545" cy="-8565.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="7545" y="-8584.55" font-family="Times,serif" font-size="14.00">Token Receive GPU10</text>
<text text-anchor="middle" x="7545" y="-8569.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="7545" y="-8554.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7545" y="-8539.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer11_routing&#45;&gt;layer11_gpu10_token_recv -->
<g id="edge1224" class="edge">
<title>layer11_routing&#45;&gt;layer11_gpu10_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6182.32,-8696.19C6460.06,-8678.6 6855.62,-8650.38 7201,-8613.83 7234.01,-8610.34 7268.73,-8606.17 7302.91,-8601.78"/>
<polygon fill="black" stroke="black" points="7303.54,-8605.23 7313.01,-8600.47 7302.64,-8598.28 7303.54,-8605.23"/>
</g>
<!-- layer11_gpu11_token_recv -->
<g id="node1055" class="node">
<title>layer11_gpu11_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8232" cy="-8565.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8232" y="-8584.55" font-family="Times,serif" font-size="14.00">Token Receive GPU11</text>
<text text-anchor="middle" x="8232" y="-8569.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8232" y="-8554.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8232" y="-8539.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_routing&#45;&gt;layer11_gpu11_token_recv -->
<g id="edge1230" class="edge">
<title>layer11_routing&#45;&gt;layer11_gpu11_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6199.54,-8707.86C6612.86,-8695.66 7299.2,-8668.74 7888,-8613.83 7922.15,-8610.65 7958.11,-8606.55 7993.4,-8602.11"/>
<polygon fill="black" stroke="black" points="7993.85,-8605.58 8003.33,-8600.85 7992.97,-8598.64 7993.85,-8605.58"/>
</g>
<!-- layer11_gpu12_token_recv -->
<g id="node1060" class="node">
<title>layer11_gpu12_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8919" cy="-8565.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8919" y="-8584.55" font-family="Times,serif" font-size="14.00">Token Receive GPU12</text>
<text text-anchor="middle" x="8919" y="-8569.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8919" y="-8554.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8919" y="-8539.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer11_routing&#45;&gt;layer11_gpu12_token_recv -->
<g id="edge1236" class="edge">
<title>layer11_routing&#45;&gt;layer11_gpu12_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6208.93,-8714.39C6740.36,-8708.28 7732.55,-8687.09 8575,-8613.83 8609.58,-8610.82 8646.01,-8606.79 8681.71,-8602.34"/>
<polygon fill="black" stroke="black" points="8682.27,-8605.79 8691.76,-8601.07 8681.4,-8598.85 8682.27,-8605.79"/>
</g>
<!-- layer11_gpu13_token_recv -->
<g id="node1065" class="node">
<title>layer11_gpu13_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="9606" cy="-8565.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="9606" y="-8584.55" font-family="Times,serif" font-size="14.00">Token Receive GPU13</text>
<text text-anchor="middle" x="9606" y="-8569.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="9606" y="-8554.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9606" y="-8539.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer11_routing&#45;&gt;layer11_gpu13_token_recv -->
<g id="edge1242" class="edge">
<title>layer11_routing&#45;&gt;layer11_gpu13_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6203.48,-8710.59C6967.72,-8697.09 8678.02,-8662.41 9262,-8613.83 9296.87,-8610.93 9333.61,-8606.93 9369.58,-8602.46"/>
<polygon fill="black" stroke="black" points="9370.22,-8605.91 9379.7,-8601.2 9369.34,-8598.97 9370.22,-8605.91"/>
</g>
<!-- layer11_gpu14_token_recv -->
<g id="node1070" class="node">
<title>layer11_gpu14_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10293" cy="-8565.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10293" y="-8584.55" font-family="Times,serif" font-size="14.00">Token Receive GPU14</text>
<text text-anchor="middle" x="10293" y="-8569.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10293" y="-8554.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10293" y="-8539.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer11_routing&#45;&gt;layer11_gpu14_token_recv -->
<g id="edge1248" class="edge">
<title>layer11_routing&#45;&gt;layer11_gpu14_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6206.5,-8712.74C7083.19,-8702.42 9229.12,-8671.91 9949,-8613.83 9984.01,-8611.01 10020.91,-8607.03 10057.02,-8602.57"/>
<polygon fill="black" stroke="black" points="10057.69,-8606.01 10067.18,-8601.3 10056.82,-8599.07 10057.69,-8606.01"/>
</g>
<!-- layer11_gpu15_token_recv -->
<g id="node1075" class="node">
<title>layer11_gpu15_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10980" cy="-8565.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10980" y="-8584.55" font-family="Times,serif" font-size="14.00">Token Receive GPU15</text>
<text text-anchor="middle" x="10980" y="-8569.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10980" y="-8554.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10980" y="-8539.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer11_routing&#45;&gt;layer11_gpu15_token_recv -->
<g id="edge1254" class="edge">
<title>layer11_routing&#45;&gt;layer11_gpu15_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6208.89,-8714.31C7189.47,-8706.93 9778.91,-8681.44 10636,-8613.83 10671.15,-8611.06 10708.21,-8607.09 10744.45,-8602.63"/>
<polygon fill="black" stroke="black" points="10745.16,-8606.07 10754.65,-8601.36 10744.29,-8599.12 10745.16,-8606.07"/>
</g>
<!-- layer11_gpu0_expert_mlp1 -->
<g id="node1001" class="node">
<title>layer11_gpu0_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="724.5,-8481.67 263.5,-8481.67 263.5,-8413.67 724.5,-8413.67 724.5,-8481.67"/>
<text text-anchor="middle" x="494" y="-8466.47" font-family="Times,serif" font-size="14.00">Expert 0 MLP1</text>
<text text-anchor="middle" x="494" y="-8451.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="494" y="-8436.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="494" y="-8421.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer11_gpu0_token_recv&#45;&gt;layer11_gpu0_expert_mlp1 -->
<g id="edge1165" class="edge">
<title>layer11_gpu0_token_recv&#45;&gt;layer11_gpu0_expert_mlp1</title>
<path fill="none" stroke="black" d="M499.93,-8517.53C499.21,-8509.15 498.46,-8500.45 497.75,-8492.17"/>
<polygon fill="black" stroke="black" points="501.21,-8491.63 496.87,-8481.97 494.24,-8492.23 501.21,-8491.63"/>
</g>
<!-- layer11_gpu0_expert_act -->
<g id="node1002" class="node">
<title>layer11_gpu0_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="647.5,-8377.67 270.5,-8377.67 270.5,-8309.67 647.5,-8309.67 647.5,-8377.67"/>
<text text-anchor="middle" x="459" y="-8362.47" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="459" y="-8347.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="459" y="-8332.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="459" y="-8317.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer11_gpu0_expert_mlp1&#45;&gt;layer11_gpu0_expert_act -->
<g id="edge1166" class="edge">
<title>layer11_gpu0_expert_mlp1&#45;&gt;layer11_gpu0_expert_act</title>
<path fill="none" stroke="black" d="M482.64,-8413.55C479.79,-8405.26 476.7,-8396.26 473.72,-8387.58"/>
<polygon fill="black" stroke="black" points="476.98,-8386.29 470.43,-8377.96 470.36,-8388.56 476.98,-8386.29"/>
</g>
<!-- layer11_gpu0_expert_mlp2 -->
<g id="node1003" class="node">
<title>layer11_gpu0_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="628.5,-8273.67 221.5,-8273.67 221.5,-8205.67 628.5,-8205.67 628.5,-8273.67"/>
<text text-anchor="middle" x="425" y="-8258.47" font-family="Times,serif" font-size="14.00">Expert 0 MLP2</text>
<text text-anchor="middle" x="425" y="-8243.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="425" y="-8228.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="425" y="-8213.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer11_gpu0_expert_act&#45;&gt;layer11_gpu0_expert_mlp2 -->
<g id="edge1167" class="edge">
<title>layer11_gpu0_expert_act&#45;&gt;layer11_gpu0_expert_mlp2</title>
<path fill="none" stroke="black" d="M447.96,-8309.55C445.2,-8301.26 442.2,-8292.26 439.3,-8283.58"/>
<polygon fill="black" stroke="black" points="442.58,-8282.34 436.1,-8273.96 435.94,-8284.56 442.58,-8282.34"/>
</g>
<!-- layer11_gpu0_token_send -->
<g id="node1004" class="node">
<title>layer11_gpu0_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="372" cy="-8121.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="372" y="-8140.38" font-family="Times,serif" font-size="14.00">Token Send GPU0</text>
<text text-anchor="middle" x="372" y="-8125.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="372" y="-8110.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="372" y="-8095.38" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer11_gpu0_expert_mlp2&#45;&gt;layer11_gpu0_token_send -->
<g id="edge1168" class="edge">
<title>layer11_gpu0_expert_mlp2&#45;&gt;layer11_gpu0_token_send</title>
<path fill="none" stroke="black" d="M409.81,-8205.4C406.04,-8197.15 401.9,-8188.07 397.78,-8179.04"/>
<polygon fill="black" stroke="black" points="400.85,-8177.33 393.51,-8169.69 394.48,-8180.24 400.85,-8177.33"/>
</g>
<!-- layer11_expert_agg -->
<g id="node1080" class="node">
<title>layer11_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="5928.05,-8037.5 5208.94,-8037.5 5023.95,-7901.5 5743.06,-7901.5 5928.05,-8037.5"/>
<text text-anchor="middle" x="5476" y="-7988.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5476" y="-7973.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x16)</text>
<text text-anchor="middle" x="5476" y="-7958.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-7943.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer11_gpu0_token_send&#45;&gt;layer11_expert_agg -->
<g id="edge1169" class="edge">
<title>layer11_gpu0_token_send&#45;&gt;layer11_expert_agg</title>
<path fill="none" stroke="black" d="M610.99,-8085.97C652.59,-8081 695.49,-8076.55 736,-8073.5 1584.42,-8009.59 4153.72,-7981.73 5111.19,-7973.37"/>
<polygon fill="black" stroke="black" points="5111.37,-7976.87 5121.34,-7973.29 5111.31,-7969.87 5111.37,-7976.87"/>
</g>
<!-- layer11_gpu1_expert_mlp1 -->
<g id="node1006" class="node">
<title>layer11_gpu1_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="1411.5,-8481.67 950.5,-8481.67 950.5,-8413.67 1411.5,-8413.67 1411.5,-8481.67"/>
<text text-anchor="middle" x="1181" y="-8466.47" font-family="Times,serif" font-size="14.00">Expert 1 MLP1</text>
<text text-anchor="middle" x="1181" y="-8451.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1181" y="-8436.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1181" y="-8421.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer11_gpu1_token_recv&#45;&gt;layer11_gpu1_expert_mlp1 -->
<g id="edge1171" class="edge">
<title>layer11_gpu1_token_recv&#45;&gt;layer11_gpu1_expert_mlp1</title>
<path fill="none" stroke="black" d="M1199.39,-8517.53C1197.13,-8509.05 1194.78,-8500.26 1192.54,-8491.9"/>
<polygon fill="black" stroke="black" points="1195.86,-8490.73 1189.89,-8481.97 1189.09,-8492.53 1195.86,-8490.73"/>
</g>
<!-- layer11_gpu1_expert_act -->
<g id="node1007" class="node">
<title>layer11_gpu1_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="1330.5,-8377.67 953.5,-8377.67 953.5,-8309.67 1330.5,-8309.67 1330.5,-8377.67"/>
<text text-anchor="middle" x="1142" y="-8362.47" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1142" y="-8347.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1142" y="-8332.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1142" y="-8317.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer11_gpu1_expert_mlp1&#45;&gt;layer11_gpu1_expert_act -->
<g id="edge1172" class="edge">
<title>layer11_gpu1_expert_mlp1&#45;&gt;layer11_gpu1_expert_act</title>
<path fill="none" stroke="black" d="M1168.34,-8413.55C1165.17,-8405.26 1161.73,-8396.26 1158.41,-8387.58"/>
<polygon fill="black" stroke="black" points="1161.57,-8386.06 1154.73,-8377.96 1155.03,-8388.56 1161.57,-8386.06"/>
</g>
<!-- layer11_gpu1_expert_mlp2 -->
<g id="node1008" class="node">
<title>layer11_gpu1_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="1329.5,-8273.67 922.5,-8273.67 922.5,-8205.67 1329.5,-8205.67 1329.5,-8273.67"/>
<text text-anchor="middle" x="1126" y="-8258.47" font-family="Times,serif" font-size="14.00">Expert 1 MLP2</text>
<text text-anchor="middle" x="1126" y="-8243.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1126" y="-8228.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1126" y="-8213.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer11_gpu1_expert_act&#45;&gt;layer11_gpu1_expert_mlp2 -->
<g id="edge1173" class="edge">
<title>layer11_gpu1_expert_act&#45;&gt;layer11_gpu1_expert_mlp2</title>
<path fill="none" stroke="black" d="M1136.81,-8309.55C1135.52,-8301.35 1134.12,-8292.45 1132.78,-8283.86"/>
<polygon fill="black" stroke="black" points="1136.23,-8283.3 1131.22,-8273.96 1129.32,-8284.39 1136.23,-8283.3"/>
</g>
<!-- layer11_gpu1_token_send -->
<g id="node1009" class="node">
<title>layer11_gpu1_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1101" cy="-8121.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1101" y="-8140.38" font-family="Times,serif" font-size="14.00">Token Send GPU1</text>
<text text-anchor="middle" x="1101" y="-8125.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1101" y="-8110.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1101" y="-8095.38" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer11_gpu1_expert_mlp2&#45;&gt;layer11_gpu1_token_send -->
<g id="edge1174" class="edge">
<title>layer11_gpu1_expert_mlp2&#45;&gt;layer11_gpu1_token_send</title>
<path fill="none" stroke="black" d="M1118.84,-8205.4C1117.1,-8197.32 1115.19,-8188.45 1113.28,-8179.61"/>
<polygon fill="black" stroke="black" points="1116.67,-8178.73 1111.15,-8169.69 1109.83,-8180.2 1116.67,-8178.73"/>
</g>
<!-- layer11_gpu1_token_send&#45;&gt;layer11_expert_agg -->
<g id="edge1175" class="edge">
<title>layer11_gpu1_token_send&#45;&gt;layer11_expert_agg</title>
<path fill="none" stroke="black" d="M1340.98,-8085.98C1382.27,-8081.05 1424.82,-8076.61 1465,-8073.5 2167.52,-8019.19 4264.61,-7986.39 5113.39,-7975.02"/>
<polygon fill="black" stroke="black" points="5113.68,-7978.52 5123.63,-7974.89 5113.58,-7971.52 5113.68,-7978.52"/>
</g>
<!-- layer11_gpu2_expert_mlp1 -->
<g id="node1011" class="node">
<title>layer11_gpu2_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2135.5,-8481.67 1674.5,-8481.67 1674.5,-8413.67 2135.5,-8413.67 2135.5,-8481.67"/>
<text text-anchor="middle" x="1905" y="-8466.47" font-family="Times,serif" font-size="14.00">Expert 2 MLP1</text>
<text text-anchor="middle" x="1905" y="-8451.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1905" y="-8436.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1905" y="-8421.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer11_gpu2_token_recv&#45;&gt;layer11_gpu2_expert_mlp1 -->
<g id="edge1177" class="edge">
<title>layer11_gpu2_token_recv&#45;&gt;layer11_gpu2_expert_mlp1</title>
<path fill="none" stroke="black" d="M1910.93,-8517.53C1910.21,-8509.15 1909.46,-8500.45 1908.75,-8492.17"/>
<polygon fill="black" stroke="black" points="1912.21,-8491.63 1907.87,-8481.97 1905.24,-8492.23 1912.21,-8491.63"/>
</g>
<!-- layer11_gpu2_expert_act -->
<g id="node1012" class="node">
<title>layer11_gpu2_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2072.5,-8377.67 1695.5,-8377.67 1695.5,-8309.67 2072.5,-8309.67 2072.5,-8377.67"/>
<text text-anchor="middle" x="1884" y="-8362.47" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="1884" y="-8347.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1884" y="-8332.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1884" y="-8317.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer11_gpu2_expert_mlp1&#45;&gt;layer11_gpu2_expert_act -->
<g id="edge1178" class="edge">
<title>layer11_gpu2_expert_mlp1&#45;&gt;layer11_gpu2_expert_act</title>
<path fill="none" stroke="black" d="M1898.18,-8413.55C1896.49,-8405.35 1894.66,-8396.45 1892.89,-8387.86"/>
<polygon fill="black" stroke="black" points="1896.3,-8387.05 1890.86,-8377.96 1889.44,-8388.46 1896.3,-8387.05"/>
</g>
<!-- layer11_gpu2_expert_mlp2 -->
<g id="node1013" class="node">
<title>layer11_gpu2_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2067.5,-8273.67 1660.5,-8273.67 1660.5,-8205.67 2067.5,-8205.67 2067.5,-8273.67"/>
<text text-anchor="middle" x="1864" y="-8258.47" font-family="Times,serif" font-size="14.00">Expert 2 MLP2</text>
<text text-anchor="middle" x="1864" y="-8243.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1864" y="-8228.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1864" y="-8213.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer11_gpu2_expert_act&#45;&gt;layer11_gpu2_expert_mlp2 -->
<g id="edge1179" class="edge">
<title>layer11_gpu2_expert_act&#45;&gt;layer11_gpu2_expert_mlp2</title>
<path fill="none" stroke="black" d="M1877.51,-8309.55C1875.9,-8301.35 1874.15,-8292.45 1872.47,-8283.86"/>
<polygon fill="black" stroke="black" points="1875.89,-8283.1 1870.53,-8273.96 1869.02,-8284.45 1875.89,-8283.1"/>
</g>
<!-- layer11_gpu2_token_send -->
<g id="node1014" class="node">
<title>layer11_gpu2_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1830" cy="-8121.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1830" y="-8140.38" font-family="Times,serif" font-size="14.00">Token Send GPU2</text>
<text text-anchor="middle" x="1830" y="-8125.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1830" y="-8110.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1830" y="-8095.38" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer11_gpu2_expert_mlp2&#45;&gt;layer11_gpu2_token_send -->
<g id="edge1180" class="edge">
<title>layer11_gpu2_expert_mlp2&#45;&gt;layer11_gpu2_token_send</title>
<path fill="none" stroke="black" d="M1854.26,-8205.4C1851.86,-8197.23 1849.24,-8188.26 1846.62,-8179.33"/>
<polygon fill="black" stroke="black" points="1849.97,-8178.3 1843.8,-8169.69 1843.25,-8180.27 1849.97,-8178.3"/>
</g>
<!-- layer11_gpu2_token_send&#45;&gt;layer11_expert_agg -->
<g id="edge1181" class="edge">
<title>layer11_gpu2_token_send&#45;&gt;layer11_expert_agg</title>
<path fill="none" stroke="black" d="M2070.48,-8086.12C2111.62,-8081.19 2153.98,-8076.71 2194,-8073.5 3248.72,-7988.94 4499.28,-7972.85 5107.27,-7970.4"/>
<polygon fill="black" stroke="black" points="5107.52,-7973.9 5117.5,-7970.36 5107.49,-7966.9 5107.52,-7973.9"/>
</g>
<!-- layer11_gpu3_expert_mlp1 -->
<g id="node1016" class="node">
<title>layer11_gpu3_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2864.5,-8481.67 2403.5,-8481.67 2403.5,-8413.67 2864.5,-8413.67 2864.5,-8481.67"/>
<text text-anchor="middle" x="2634" y="-8466.47" font-family="Times,serif" font-size="14.00">Expert 3 MLP1</text>
<text text-anchor="middle" x="2634" y="-8451.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2634" y="-8436.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2634" y="-8421.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer11_gpu3_token_recv&#45;&gt;layer11_gpu3_expert_mlp1 -->
<g id="edge1183" class="edge">
<title>layer11_gpu3_token_recv&#45;&gt;layer11_gpu3_expert_mlp1</title>
<path fill="none" stroke="black" d="M2639.93,-8517.53C2639.21,-8509.15 2638.46,-8500.45 2637.75,-8492.17"/>
<polygon fill="black" stroke="black" points="2641.21,-8491.63 2636.87,-8481.97 2634.24,-8492.23 2641.21,-8491.63"/>
</g>
<!-- layer11_gpu3_expert_act -->
<g id="node1017" class="node">
<title>layer11_gpu3_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2801.5,-8377.67 2424.5,-8377.67 2424.5,-8309.67 2801.5,-8309.67 2801.5,-8377.67"/>
<text text-anchor="middle" x="2613" y="-8362.47" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="2613" y="-8347.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2613" y="-8332.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2613" y="-8317.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer11_gpu3_expert_mlp1&#45;&gt;layer11_gpu3_expert_act -->
<g id="edge1184" class="edge">
<title>layer11_gpu3_expert_mlp1&#45;&gt;layer11_gpu3_expert_act</title>
<path fill="none" stroke="black" d="M2627.18,-8413.55C2625.49,-8405.35 2623.66,-8396.45 2621.89,-8387.86"/>
<polygon fill="black" stroke="black" points="2625.3,-8387.05 2619.86,-8377.96 2618.44,-8388.46 2625.3,-8387.05"/>
</g>
<!-- layer11_gpu3_expert_mlp2 -->
<g id="node1018" class="node">
<title>layer11_gpu3_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2796.5,-8273.67 2389.5,-8273.67 2389.5,-8205.67 2796.5,-8205.67 2796.5,-8273.67"/>
<text text-anchor="middle" x="2593" y="-8258.47" font-family="Times,serif" font-size="14.00">Expert 3 MLP2</text>
<text text-anchor="middle" x="2593" y="-8243.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2593" y="-8228.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="2593" y="-8213.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer11_gpu3_expert_act&#45;&gt;layer11_gpu3_expert_mlp2 -->
<g id="edge1185" class="edge">
<title>layer11_gpu3_expert_act&#45;&gt;layer11_gpu3_expert_mlp2</title>
<path fill="none" stroke="black" d="M2606.51,-8309.55C2604.9,-8301.35 2603.15,-8292.45 2601.47,-8283.86"/>
<polygon fill="black" stroke="black" points="2604.89,-8283.1 2599.53,-8273.96 2598.02,-8284.45 2604.89,-8283.1"/>
</g>
<!-- layer11_gpu3_token_send -->
<g id="node1019" class="node">
<title>layer11_gpu3_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="2559" cy="-8121.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="2559" y="-8140.38" font-family="Times,serif" font-size="14.00">Token Send GPU3</text>
<text text-anchor="middle" x="2559" y="-8125.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="2559" y="-8110.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="2559" y="-8095.38" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer11_gpu3_expert_mlp2&#45;&gt;layer11_gpu3_token_send -->
<g id="edge1186" class="edge">
<title>layer11_gpu3_expert_mlp2&#45;&gt;layer11_gpu3_token_send</title>
<path fill="none" stroke="black" d="M2583.26,-8205.4C2580.86,-8197.23 2578.24,-8188.26 2575.62,-8179.33"/>
<polygon fill="black" stroke="black" points="2578.97,-8178.3 2572.8,-8169.69 2572.25,-8180.27 2578.97,-8178.3"/>
</g>
<!-- layer11_gpu3_token_send&#45;&gt;layer11_expert_agg -->
<g id="edge1187" class="edge">
<title>layer11_gpu3_token_send&#45;&gt;layer11_expert_agg</title>
<path fill="none" stroke="black" d="M2800.98,-8086.25C2841.65,-8081.35 2883.48,-8076.85 2923,-8073.5 3701.79,-8007.55 4617.91,-7983.59 5113.42,-7975.06"/>
<polygon fill="black" stroke="black" points="5113.65,-7978.56 5123.59,-7974.89 5113.53,-7971.56 5113.65,-7978.56"/>
</g>
<!-- layer11_gpu4_expert_mlp1 -->
<g id="node1021" class="node">
<title>layer11_gpu4_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="3551.5,-8481.67 3090.5,-8481.67 3090.5,-8413.67 3551.5,-8413.67 3551.5,-8481.67"/>
<text text-anchor="middle" x="3321" y="-8466.47" font-family="Times,serif" font-size="14.00">Expert 4 MLP1</text>
<text text-anchor="middle" x="3321" y="-8451.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3321" y="-8436.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3321" y="-8421.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer11_gpu4_token_recv&#45;&gt;layer11_gpu4_expert_mlp1 -->
<g id="edge1189" class="edge">
<title>layer11_gpu4_token_recv&#45;&gt;layer11_gpu4_expert_mlp1</title>
<path fill="none" stroke="black" d="M3339.39,-8517.53C3337.13,-8509.05 3334.78,-8500.26 3332.54,-8491.9"/>
<polygon fill="black" stroke="black" points="3335.86,-8490.73 3329.89,-8481.97 3329.09,-8492.53 3335.86,-8490.73"/>
</g>
<!-- layer11_gpu4_expert_act -->
<g id="node1022" class="node">
<title>layer11_gpu4_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="3493.5,-8377.67 3116.5,-8377.67 3116.5,-8309.67 3493.5,-8309.67 3493.5,-8377.67"/>
<text text-anchor="middle" x="3305" y="-8362.47" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="3305" y="-8347.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3305" y="-8332.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3305" y="-8317.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer11_gpu4_expert_mlp1&#45;&gt;layer11_gpu4_expert_act -->
<g id="edge1190" class="edge">
<title>layer11_gpu4_expert_mlp1&#45;&gt;layer11_gpu4_expert_act</title>
<path fill="none" stroke="black" d="M3315.81,-8413.55C3314.52,-8405.35 3313.12,-8396.45 3311.78,-8387.86"/>
<polygon fill="black" stroke="black" points="3315.23,-8387.3 3310.22,-8377.96 3308.32,-8388.39 3315.23,-8387.3"/>
</g>
<!-- layer11_gpu4_expert_mlp2 -->
<g id="node1023" class="node">
<title>layer11_gpu4_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="3501.5,-8273.67 3094.5,-8273.67 3094.5,-8205.67 3501.5,-8205.67 3501.5,-8273.67"/>
<text text-anchor="middle" x="3298" y="-8258.47" font-family="Times,serif" font-size="14.00">Expert 4 MLP2</text>
<text text-anchor="middle" x="3298" y="-8243.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3298" y="-8228.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="3298" y="-8213.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer11_gpu4_expert_act&#45;&gt;layer11_gpu4_expert_mlp2 -->
<g id="edge1191" class="edge">
<title>layer11_gpu4_expert_act&#45;&gt;layer11_gpu4_expert_mlp2</title>
<path fill="none" stroke="black" d="M3302.73,-8309.55C3302.17,-8301.44 3301.57,-8292.65 3300.98,-8284.14"/>
<polygon fill="black" stroke="black" points="3304.46,-8283.7 3300.29,-8273.96 3297.48,-8284.18 3304.46,-8283.7"/>
</g>
<!-- layer11_gpu4_token_send -->
<g id="node1024" class="node">
<title>layer11_gpu4_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="3288" cy="-8121.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="3288" y="-8140.38" font-family="Times,serif" font-size="14.00">Token Send GPU4</text>
<text text-anchor="middle" x="3288" y="-8125.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="3288" y="-8110.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="3288" y="-8095.38" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer11_gpu4_expert_mlp2&#45;&gt;layer11_gpu4_token_send -->
<g id="edge1192" class="edge">
<title>layer11_gpu4_expert_mlp2&#45;&gt;layer11_gpu4_token_send</title>
<path fill="none" stroke="black" d="M3295.13,-8205.4C3294.45,-8197.41 3293.69,-8188.64 3292.94,-8179.9"/>
<polygon fill="black" stroke="black" points="3296.4,-8179.35 3292.06,-8169.69 3289.43,-8179.96 3296.4,-8179.35"/>
</g>
<!-- layer11_gpu4_token_send&#45;&gt;layer11_expert_agg -->
<g id="edge1193" class="edge">
<title>layer11_gpu4_token_send&#45;&gt;layer11_expert_agg</title>
<path fill="none" stroke="black" d="M3531.99,-8086.56C3572.03,-8081.68 3613.14,-8077.1 3652,-8073.5 4162.71,-8026.11 4756.04,-7997.49 5123.82,-7982.84"/>
<polygon fill="black" stroke="black" points="5123.96,-7986.34 5133.82,-7982.44 5123.69,-7979.34 5123.96,-7986.34"/>
</g>
<!-- layer11_gpu5_expert_mlp1 -->
<g id="node1026" class="node">
<title>layer11_gpu5_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4266.5,-8481.67 3805.5,-8481.67 3805.5,-8413.67 4266.5,-8413.67 4266.5,-8481.67"/>
<text text-anchor="middle" x="4036" y="-8466.47" font-family="Times,serif" font-size="14.00">Expert 5 MLP1</text>
<text text-anchor="middle" x="4036" y="-8451.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4036" y="-8436.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4036" y="-8421.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer11_gpu5_token_recv&#45;&gt;layer11_gpu5_expert_mlp1 -->
<g id="edge1195" class="edge">
<title>layer11_gpu5_token_recv&#45;&gt;layer11_gpu5_expert_mlp1</title>
<path fill="none" stroke="black" d="M4041.93,-8517.53C4041.21,-8509.15 4040.46,-8500.45 4039.75,-8492.17"/>
<polygon fill="black" stroke="black" points="4043.21,-8491.63 4038.87,-8481.97 4036.24,-8492.23 4043.21,-8491.63"/>
</g>
<!-- layer11_gpu5_expert_act -->
<g id="node1027" class="node">
<title>layer11_gpu5_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4219.5,-8377.67 3842.5,-8377.67 3842.5,-8309.67 4219.5,-8309.67 4219.5,-8377.67"/>
<text text-anchor="middle" x="4031" y="-8362.47" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="4031" y="-8347.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4031" y="-8332.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4031" y="-8317.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer11_gpu5_expert_mlp1&#45;&gt;layer11_gpu5_expert_act -->
<g id="edge1196" class="edge">
<title>layer11_gpu5_expert_mlp1&#45;&gt;layer11_gpu5_expert_act</title>
<path fill="none" stroke="black" d="M4034.38,-8413.55C4033.98,-8405.44 4033.55,-8396.65 4033.13,-8388.14"/>
<polygon fill="black" stroke="black" points="4036.62,-8387.78 4032.63,-8377.96 4029.63,-8388.12 4036.62,-8387.78"/>
</g>
<!-- layer11_gpu5_expert_mlp2 -->
<g id="node1028" class="node">
<title>layer11_gpu5_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4225.5,-8273.67 3818.5,-8273.67 3818.5,-8205.67 4225.5,-8205.67 4225.5,-8273.67"/>
<text text-anchor="middle" x="4022" y="-8258.47" font-family="Times,serif" font-size="14.00">Expert 5 MLP2</text>
<text text-anchor="middle" x="4022" y="-8243.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4022" y="-8228.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4022" y="-8213.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer11_gpu5_expert_act&#45;&gt;layer11_gpu5_expert_mlp2 -->
<g id="edge1197" class="edge">
<title>layer11_gpu5_expert_act&#45;&gt;layer11_gpu5_expert_mlp2</title>
<path fill="none" stroke="black" d="M4028.08,-8309.55C4027.36,-8301.44 4026.59,-8292.65 4025.84,-8284.14"/>
<polygon fill="black" stroke="black" points="4029.3,-8283.62 4024.94,-8273.96 4022.33,-8284.23 4029.3,-8283.62"/>
</g>
<!-- layer11_gpu5_token_send -->
<g id="node1029" class="node">
<title>layer11_gpu5_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4017" cy="-8121.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4017" y="-8140.38" font-family="Times,serif" font-size="14.00">Token Send GPU5</text>
<text text-anchor="middle" x="4017" y="-8125.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4017" y="-8110.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4017" y="-8095.38" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer11_gpu5_expert_mlp2&#45;&gt;layer11_gpu5_token_send -->
<g id="edge1198" class="edge">
<title>layer11_gpu5_expert_mlp2&#45;&gt;layer11_gpu5_token_send</title>
<path fill="none" stroke="black" d="M4020.57,-8205.4C4020.22,-8197.41 4019.85,-8188.64 4019.47,-8179.9"/>
<polygon fill="black" stroke="black" points="4022.96,-8179.53 4019.03,-8169.69 4015.96,-8179.83 4022.96,-8179.53"/>
</g>
<!-- layer11_gpu5_token_send&#45;&gt;layer11_expert_agg -->
<g id="edge1199" class="edge">
<title>layer11_gpu5_token_send&#45;&gt;layer11_expert_agg</title>
<path fill="none" stroke="black" d="M4266.02,-8087.2C4304.5,-8082.38 4343.8,-8077.65 4381,-8073.5 4637.04,-8044.91 4927.36,-8017.84 5144.71,-7998.64"/>
<polygon fill="black" stroke="black" points="5145.02,-8002.12 5154.68,-7997.76 5144.41,-7995.15 5145.02,-8002.12"/>
</g>
<!-- layer11_gpu6_expert_mlp1 -->
<g id="node1031" class="node">
<title>layer11_gpu6_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4995.5,-8481.67 4534.5,-8481.67 4534.5,-8413.67 4995.5,-8413.67 4995.5,-8481.67"/>
<text text-anchor="middle" x="4765" y="-8466.47" font-family="Times,serif" font-size="14.00">Expert 6 MLP1</text>
<text text-anchor="middle" x="4765" y="-8451.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4765" y="-8436.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4765" y="-8421.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer11_gpu6_token_recv&#45;&gt;layer11_gpu6_expert_mlp1 -->
<g id="edge1201" class="edge">
<title>layer11_gpu6_token_recv&#45;&gt;layer11_gpu6_expert_mlp1</title>
<path fill="none" stroke="black" d="M4770.93,-8517.53C4770.21,-8509.15 4769.46,-8500.45 4768.75,-8492.17"/>
<polygon fill="black" stroke="black" points="4772.21,-8491.63 4767.87,-8481.97 4765.24,-8492.23 4772.21,-8491.63"/>
</g>
<!-- layer11_gpu6_expert_act -->
<g id="node1032" class="node">
<title>layer11_gpu6_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4947.5,-8377.67 4570.5,-8377.67 4570.5,-8309.67 4947.5,-8309.67 4947.5,-8377.67"/>
<text text-anchor="middle" x="4759" y="-8362.47" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="4759" y="-8347.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4759" y="-8332.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4759" y="-8317.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer11_gpu6_expert_mlp1&#45;&gt;layer11_gpu6_expert_act -->
<g id="edge1202" class="edge">
<title>layer11_gpu6_expert_mlp1&#45;&gt;layer11_gpu6_expert_act</title>
<path fill="none" stroke="black" d="M4763.05,-8413.55C4762.58,-8405.44 4762.06,-8396.65 4761.56,-8388.14"/>
<polygon fill="black" stroke="black" points="4765.04,-8387.74 4760.96,-8377.96 4758.05,-8388.15 4765.04,-8387.74"/>
</g>
<!-- layer11_gpu6_expert_mlp2 -->
<g id="node1033" class="node">
<title>layer11_gpu6_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4957.5,-8273.67 4550.5,-8273.67 4550.5,-8205.67 4957.5,-8205.67 4957.5,-8273.67"/>
<text text-anchor="middle" x="4754" y="-8258.47" font-family="Times,serif" font-size="14.00">Expert 6 MLP2</text>
<text text-anchor="middle" x="4754" y="-8243.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4754" y="-8228.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4754" y="-8213.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer11_gpu6_expert_act&#45;&gt;layer11_gpu6_expert_mlp2 -->
<g id="edge1203" class="edge">
<title>layer11_gpu6_expert_act&#45;&gt;layer11_gpu6_expert_mlp2</title>
<path fill="none" stroke="black" d="M4757.38,-8309.55C4756.98,-8301.44 4756.55,-8292.65 4756.13,-8284.14"/>
<polygon fill="black" stroke="black" points="4759.62,-8283.78 4755.63,-8273.96 4752.63,-8284.12 4759.62,-8283.78"/>
</g>
<!-- layer11_gpu6_token_send -->
<g id="node1034" class="node">
<title>layer11_gpu6_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4746" cy="-8121.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4746" y="-8140.38" font-family="Times,serif" font-size="14.00">Token Send GPU6</text>
<text text-anchor="middle" x="4746" y="-8125.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4746" y="-8110.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4746" y="-8095.38" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer11_gpu6_expert_mlp2&#45;&gt;layer11_gpu6_token_send -->
<g id="edge1204" class="edge">
<title>layer11_gpu6_expert_mlp2&#45;&gt;layer11_gpu6_token_send</title>
<path fill="none" stroke="black" d="M4751.71,-8205.4C4751.16,-8197.41 4750.55,-8188.64 4749.95,-8179.9"/>
<polygon fill="black" stroke="black" points="4753.43,-8179.43 4749.25,-8169.69 4746.44,-8179.91 4753.43,-8179.43"/>
</g>
<!-- layer11_gpu6_token_send&#45;&gt;layer11_expert_agg -->
<g id="edge1205" class="edge">
<title>layer11_gpu6_token_send&#45;&gt;layer11_expert_agg</title>
<path fill="none" stroke="black" d="M4938.28,-8081.05C5014.06,-8065.47 5102.75,-8047.24 5186,-8030.12"/>
<polygon fill="black" stroke="black" points="5186.77,-8033.53 5195.86,-8028.09 5185.36,-8026.68 5186.77,-8033.53"/>
</g>
<!-- layer11_gpu7_expert_mlp1 -->
<g id="node1036" class="node">
<title>layer11_gpu7_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5713.5,-8481.67 5252.5,-8481.67 5252.5,-8413.67 5713.5,-8413.67 5713.5,-8481.67"/>
<text text-anchor="middle" x="5483" y="-8466.47" font-family="Times,serif" font-size="14.00">Expert 7 MLP1</text>
<text text-anchor="middle" x="5483" y="-8451.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5483" y="-8436.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5483" y="-8421.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer11_gpu7_token_recv&#45;&gt;layer11_gpu7_expert_mlp1 -->
<g id="edge1207" class="edge">
<title>layer11_gpu7_token_recv&#45;&gt;layer11_gpu7_expert_mlp1</title>
<path fill="none" stroke="black" d="M5483,-8517.53C5483,-8509.15 5483,-8500.45 5483,-8492.17"/>
<polygon fill="black" stroke="black" points="5486.5,-8491.97 5483,-8481.97 5479.5,-8491.97 5486.5,-8491.97"/>
</g>
<!-- layer11_gpu7_expert_act -->
<g id="node1037" class="node">
<title>layer11_gpu7_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="5671.5,-8377.67 5294.5,-8377.67 5294.5,-8309.67 5671.5,-8309.67 5671.5,-8377.67"/>
<text text-anchor="middle" x="5483" y="-8362.47" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="5483" y="-8347.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5483" y="-8332.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5483" y="-8317.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer11_gpu7_expert_mlp1&#45;&gt;layer11_gpu7_expert_act -->
<g id="edge1208" class="edge">
<title>layer11_gpu7_expert_mlp1&#45;&gt;layer11_gpu7_expert_act</title>
<path fill="none" stroke="black" d="M5483,-8413.55C5483,-8405.44 5483,-8396.65 5483,-8388.14"/>
<polygon fill="black" stroke="black" points="5486.5,-8387.96 5483,-8377.96 5479.5,-8387.96 5486.5,-8387.96"/>
</g>
<!-- layer11_gpu7_expert_mlp2 -->
<g id="node1038" class="node">
<title>layer11_gpu7_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="5683.5,-8273.67 5276.5,-8273.67 5276.5,-8205.67 5683.5,-8205.67 5683.5,-8273.67"/>
<text text-anchor="middle" x="5480" y="-8258.47" font-family="Times,serif" font-size="14.00">Expert 7 MLP2</text>
<text text-anchor="middle" x="5480" y="-8243.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5480" y="-8228.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5480" y="-8213.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer11_gpu7_expert_act&#45;&gt;layer11_gpu7_expert_mlp2 -->
<g id="edge1209" class="edge">
<title>layer11_gpu7_expert_act&#45;&gt;layer11_gpu7_expert_mlp2</title>
<path fill="none" stroke="black" d="M5482.03,-8309.55C5481.79,-8301.44 5481.53,-8292.65 5481.28,-8284.14"/>
<polygon fill="black" stroke="black" points="5484.77,-8283.86 5480.98,-8273.96 5477.77,-8284.06 5484.77,-8283.86"/>
</g>
<!-- layer11_gpu7_token_send -->
<g id="node1039" class="node">
<title>layer11_gpu7_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="5475" cy="-8121.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="5475" y="-8140.38" font-family="Times,serif" font-size="14.00">Token Send GPU7</text>
<text text-anchor="middle" x="5475" y="-8125.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="5475" y="-8110.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="5475" y="-8095.38" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer11_gpu7_expert_mlp2&#45;&gt;layer11_gpu7_token_send -->
<g id="edge1210" class="edge">
<title>layer11_gpu7_expert_mlp2&#45;&gt;layer11_gpu7_token_send</title>
<path fill="none" stroke="black" d="M5478.57,-8205.4C5478.22,-8197.41 5477.85,-8188.64 5477.47,-8179.9"/>
<polygon fill="black" stroke="black" points="5480.96,-8179.53 5477.03,-8169.69 5473.96,-8179.83 5480.96,-8179.53"/>
</g>
<!-- layer11_gpu7_token_send&#45;&gt;layer11_expert_agg -->
<g id="edge1211" class="edge">
<title>layer11_gpu7_token_send&#45;&gt;layer11_expert_agg</title>
<path fill="none" stroke="black" d="M5475.32,-8073.09C5475.37,-8065.01 5475.43,-8056.43 5475.48,-8047.81"/>
<polygon fill="black" stroke="black" points="5478.99,-8047.72 5475.55,-8037.69 5471.99,-8047.67 5478.99,-8047.72"/>
</g>
<!-- layer11_gpu8_expert_mlp1 -->
<g id="node1041" class="node">
<title>layer11_gpu8_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="6405.5,-8481.67 5944.5,-8481.67 5944.5,-8413.67 6405.5,-8413.67 6405.5,-8481.67"/>
<text text-anchor="middle" x="6175" y="-8466.47" font-family="Times,serif" font-size="14.00">Expert 8 MLP1</text>
<text text-anchor="middle" x="6175" y="-8451.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6175" y="-8436.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6175" y="-8421.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer11_gpu8_token_recv&#45;&gt;layer11_gpu8_expert_mlp1 -->
<g id="edge1213" class="edge">
<title>layer11_gpu8_token_recv&#45;&gt;layer11_gpu8_expert_mlp1</title>
<path fill="none" stroke="black" d="M6172.63,-8517.53C6172.92,-8509.15 6173.22,-8500.45 6173.5,-8492.17"/>
<polygon fill="black" stroke="black" points="6177.01,-8492.08 6173.85,-8481.97 6170.01,-8491.84 6177.01,-8492.08"/>
</g>
<!-- layer11_gpu8_expert_act -->
<g id="node1042" class="node">
<title>layer11_gpu8_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="6379.5,-8377.67 6002.5,-8377.67 6002.5,-8309.67 6379.5,-8309.67 6379.5,-8377.67"/>
<text text-anchor="middle" x="6191" y="-8362.47" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="6191" y="-8347.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6191" y="-8332.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6191" y="-8317.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer11_gpu8_expert_mlp1&#45;&gt;layer11_gpu8_expert_act -->
<g id="edge1214" class="edge">
<title>layer11_gpu8_expert_mlp1&#45;&gt;layer11_gpu8_expert_act</title>
<path fill="none" stroke="black" d="M6180.19,-8413.55C6181.48,-8405.35 6182.88,-8396.45 6184.22,-8387.86"/>
<polygon fill="black" stroke="black" points="6187.68,-8388.39 6185.78,-8377.96 6180.77,-8387.3 6187.68,-8388.39"/>
</g>
<!-- layer11_gpu8_expert_mlp2 -->
<g id="node1043" class="node">
<title>layer11_gpu8_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="6399.5,-8273.67 5992.5,-8273.67 5992.5,-8205.67 6399.5,-8205.67 6399.5,-8273.67"/>
<text text-anchor="middle" x="6196" y="-8258.47" font-family="Times,serif" font-size="14.00">Expert 8 MLP2</text>
<text text-anchor="middle" x="6196" y="-8243.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6196" y="-8228.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6196" y="-8213.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer11_gpu8_expert_act&#45;&gt;layer11_gpu8_expert_mlp2 -->
<g id="edge1215" class="edge">
<title>layer11_gpu8_expert_act&#45;&gt;layer11_gpu8_expert_mlp2</title>
<path fill="none" stroke="black" d="M6192.62,-8309.55C6193.02,-8301.44 6193.45,-8292.65 6193.87,-8284.14"/>
<polygon fill="black" stroke="black" points="6197.37,-8284.12 6194.37,-8273.96 6190.38,-8283.78 6197.37,-8284.12"/>
</g>
<!-- layer11_gpu8_token_send -->
<g id="node1044" class="node">
<title>layer11_gpu8_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6204" cy="-8121.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6204" y="-8140.38" font-family="Times,serif" font-size="14.00">Token Send GPU8</text>
<text text-anchor="middle" x="6204" y="-8125.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6204" y="-8110.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6204" y="-8095.38" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer11_gpu8_expert_mlp2&#45;&gt;layer11_gpu8_token_send -->
<g id="edge1216" class="edge">
<title>layer11_gpu8_expert_mlp2&#45;&gt;layer11_gpu8_token_send</title>
<path fill="none" stroke="black" d="M6198.29,-8205.4C6198.84,-8197.41 6199.45,-8188.64 6200.05,-8179.9"/>
<polygon fill="black" stroke="black" points="6203.56,-8179.91 6200.75,-8169.69 6196.57,-8179.43 6203.56,-8179.91"/>
</g>
<!-- layer11_gpu8_token_send&#45;&gt;layer11_expert_agg -->
<g id="edge1217" class="edge">
<title>layer11_gpu8_token_send&#45;&gt;layer11_expert_agg</title>
<path fill="none" stroke="black" d="M6012.25,-8081.05C5950.52,-8068.32 5880.19,-8053.83 5811.25,-8039.61"/>
<polygon fill="black" stroke="black" points="5811.59,-8036.11 5801.09,-8037.52 5810.18,-8042.97 5811.59,-8036.11"/>
</g>
<!-- layer11_gpu9_expert_mlp1 -->
<g id="node1046" class="node">
<title>layer11_gpu9_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7091.5,-8481.67 6630.5,-8481.67 6630.5,-8413.67 7091.5,-8413.67 7091.5,-8481.67"/>
<text text-anchor="middle" x="6861" y="-8466.47" font-family="Times,serif" font-size="14.00">Expert 9 MLP1</text>
<text text-anchor="middle" x="6861" y="-8451.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6861" y="-8436.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6861" y="-8421.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer11_gpu9_token_recv&#45;&gt;layer11_gpu9_expert_mlp1 -->
<g id="edge1219" class="edge">
<title>layer11_gpu9_token_recv&#45;&gt;layer11_gpu9_expert_mlp1</title>
<path fill="none" stroke="black" d="M6859.22,-8517.53C6859.44,-8509.15 6859.66,-8500.45 6859.88,-8492.17"/>
<polygon fill="black" stroke="black" points="6863.38,-8492.06 6860.14,-8481.97 6856.38,-8491.88 6863.38,-8492.06"/>
</g>
<!-- layer11_gpu9_expert_act -->
<g id="node1047" class="node">
<title>layer11_gpu9_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7091.5,-8377.67 6714.5,-8377.67 6714.5,-8309.67 7091.5,-8309.67 7091.5,-8377.67"/>
<text text-anchor="middle" x="6903" y="-8362.47" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="6903" y="-8347.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6903" y="-8332.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6903" y="-8317.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer11_gpu9_expert_mlp1&#45;&gt;layer11_gpu9_expert_act -->
<g id="edge1220" class="edge">
<title>layer11_gpu9_expert_mlp1&#45;&gt;layer11_gpu9_expert_act</title>
<path fill="none" stroke="black" d="M6874.64,-8413.55C6878.08,-8405.18 6881.83,-8396.07 6885.45,-8387.3"/>
<polygon fill="black" stroke="black" points="6888.72,-8388.54 6889.29,-8377.96 6882.24,-8385.88 6888.72,-8388.54"/>
</g>
<!-- layer11_gpu9_expert_mlp2 -->
<g id="node1048" class="node">
<title>layer11_gpu9_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7116.5,-8273.67 6709.5,-8273.67 6709.5,-8205.67 7116.5,-8205.67 7116.5,-8273.67"/>
<text text-anchor="middle" x="6913" y="-8258.47" font-family="Times,serif" font-size="14.00">Expert 9 MLP2</text>
<text text-anchor="middle" x="6913" y="-8243.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6913" y="-8228.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6913" y="-8213.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer11_gpu9_expert_act&#45;&gt;layer11_gpu9_expert_mlp2 -->
<g id="edge1221" class="edge">
<title>layer11_gpu9_expert_act&#45;&gt;layer11_gpu9_expert_mlp2</title>
<path fill="none" stroke="black" d="M6906.25,-8309.55C6907.04,-8301.44 6907.9,-8292.65 6908.74,-8284.14"/>
<polygon fill="black" stroke="black" points="6912.24,-8284.26 6909.74,-8273.96 6905.28,-8283.58 6912.24,-8284.26"/>
</g>
<!-- layer11_gpu9_token_send -->
<g id="node1049" class="node">
<title>layer11_gpu9_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6933" cy="-8121.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6933" y="-8140.38" font-family="Times,serif" font-size="14.00">Token Send GPU9</text>
<text text-anchor="middle" x="6933" y="-8125.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6933" y="-8110.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6933" y="-8095.38" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer11_gpu9_expert_mlp2&#45;&gt;layer11_gpu9_token_send -->
<g id="edge1222" class="edge">
<title>layer11_gpu9_expert_mlp2&#45;&gt;layer11_gpu9_token_send</title>
<path fill="none" stroke="black" d="M6918.73,-8205.4C6920.12,-8197.32 6921.65,-8188.45 6923.17,-8179.61"/>
<polygon fill="black" stroke="black" points="6926.63,-8180.14 6924.88,-8169.69 6919.74,-8178.95 6926.63,-8180.14"/>
</g>
<!-- layer11_gpu9_token_send&#45;&gt;layer11_expert_agg -->
<g id="edge1223" class="edge">
<title>layer11_gpu9_token_send&#45;&gt;layer11_expert_agg</title>
<path fill="none" stroke="black" d="M6683.98,-8087.21C6645.5,-8082.39 6606.2,-8077.66 6569,-8073.5 6346.64,-8048.65 6098.38,-8024.93 5894.73,-8006.53"/>
<polygon fill="black" stroke="black" points="5895.04,-8003.04 5884.76,-8005.63 5894.41,-8010.02 5895.04,-8003.04"/>
</g>
<!-- layer11_gpu10_expert_mlp1 -->
<g id="node1051" class="node">
<title>layer11_gpu10_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7789.5,-8481.67 7328.5,-8481.67 7328.5,-8413.67 7789.5,-8413.67 7789.5,-8481.67"/>
<text text-anchor="middle" x="7559" y="-8466.47" font-family="Times,serif" font-size="14.00">Expert 10 MLP1</text>
<text text-anchor="middle" x="7559" y="-8451.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7559" y="-8436.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7559" y="-8421.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer11_gpu10_token_recv&#45;&gt;layer11_gpu10_expert_mlp1 -->
<g id="edge1225" class="edge">
<title>layer11_gpu10_token_recv&#45;&gt;layer11_gpu10_expert_mlp1</title>
<path fill="none" stroke="black" d="M7550.69,-8517.53C7551.71,-8509.15 7552.75,-8500.45 7553.75,-8492.17"/>
<polygon fill="black" stroke="black" points="7557.26,-8492.32 7554.98,-8481.97 7550.31,-8491.48 7557.26,-8492.32"/>
</g>
<!-- layer11_gpu10_expert_act -->
<g id="node1052" class="node">
<title>layer11_gpu10_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7774.5,-8377.67 7397.5,-8377.67 7397.5,-8309.67 7774.5,-8309.67 7774.5,-8377.67"/>
<text text-anchor="middle" x="7586" y="-8362.47" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="7586" y="-8347.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7586" y="-8332.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7586" y="-8317.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer11_gpu10_expert_mlp1&#45;&gt;layer11_gpu10_expert_act -->
<g id="edge1226" class="edge">
<title>layer11_gpu10_expert_mlp1&#45;&gt;layer11_gpu10_expert_act</title>
<path fill="none" stroke="black" d="M7567.77,-8413.55C7569.94,-8405.35 7572.29,-8396.45 7574.57,-8387.86"/>
<polygon fill="black" stroke="black" points="7578.01,-8388.53 7577.19,-8377.96 7571.24,-8386.74 7578.01,-8388.53"/>
</g>
<!-- layer11_gpu10_expert_mlp2 -->
<g id="node1053" class="node">
<title>layer11_gpu10_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7803.5,-8273.67 7396.5,-8273.67 7396.5,-8205.67 7803.5,-8205.67 7803.5,-8273.67"/>
<text text-anchor="middle" x="7600" y="-8258.47" font-family="Times,serif" font-size="14.00">Expert 10 MLP2</text>
<text text-anchor="middle" x="7600" y="-8243.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7600" y="-8228.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="7600" y="-8213.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer11_gpu10_expert_act&#45;&gt;layer11_gpu10_expert_mlp2 -->
<g id="edge1227" class="edge">
<title>layer11_gpu10_expert_act&#45;&gt;layer11_gpu10_expert_mlp2</title>
<path fill="none" stroke="black" d="M7590.55,-8309.55C7591.66,-8301.44 7592.87,-8292.65 7594.03,-8284.14"/>
<polygon fill="black" stroke="black" points="7597.54,-8284.35 7595.43,-8273.96 7590.6,-8283.4 7597.54,-8284.35"/>
</g>
<!-- layer11_gpu10_token_send -->
<g id="node1054" class="node">
<title>layer11_gpu10_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="7662" cy="-8121.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="7662" y="-8140.38" font-family="Times,serif" font-size="14.00">Token Send GPU10</text>
<text text-anchor="middle" x="7662" y="-8125.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="7662" y="-8110.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="7662" y="-8095.38" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer11_gpu10_expert_mlp2&#45;&gt;layer11_gpu10_token_send -->
<g id="edge1228" class="edge">
<title>layer11_gpu10_expert_mlp2&#45;&gt;layer11_gpu10_token_send</title>
<path fill="none" stroke="black" d="M7617.77,-8205.4C7622.22,-8197.06 7627.13,-8187.88 7632,-8178.76"/>
<polygon fill="black" stroke="black" points="7635.21,-8180.16 7636.84,-8169.69 7629.04,-8176.86 7635.21,-8180.16"/>
</g>
<!-- layer11_gpu10_token_send&#45;&gt;layer11_expert_agg -->
<g id="edge1229" class="edge">
<title>layer11_gpu10_token_send&#45;&gt;layer11_expert_agg</title>
<path fill="none" stroke="black" d="M7418.01,-8086.56C7377.96,-8081.68 7336.86,-8077.11 7298,-8073.5 6805.04,-8027.74 6235.03,-7999.47 5865.7,-7984.38"/>
<polygon fill="black" stroke="black" points="5865.78,-7980.88 5855.65,-7983.97 5865.5,-7987.88 5865.78,-7980.88"/>
</g>
<!-- layer11_gpu11_expert_mlp1 -->
<g id="node1056" class="node">
<title>layer11_gpu11_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="8482.5,-8481.67 8021.5,-8481.67 8021.5,-8413.67 8482.5,-8413.67 8482.5,-8481.67"/>
<text text-anchor="middle" x="8252" y="-8466.47" font-family="Times,serif" font-size="14.00">Expert 11 MLP1</text>
<text text-anchor="middle" x="8252" y="-8451.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8252" y="-8436.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8252" y="-8421.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_gpu11_token_recv&#45;&gt;layer11_gpu11_expert_mlp1 -->
<g id="edge1231" class="edge">
<title>layer11_gpu11_token_recv&#45;&gt;layer11_gpu11_expert_mlp1</title>
<path fill="none" stroke="black" d="M8240.13,-8517.53C8241.6,-8509.05 8243.11,-8500.26 8244.55,-8491.9"/>
<polygon fill="black" stroke="black" points="8248.01,-8492.42 8246.26,-8481.97 8241.11,-8491.23 8248.01,-8492.42"/>
</g>
<!-- layer11_gpu11_expert_act -->
<g id="node1057" class="node">
<title>layer11_gpu11_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="8519.5,-8377.67 8142.5,-8377.67 8142.5,-8309.67 8519.5,-8309.67 8519.5,-8377.67"/>
<text text-anchor="middle" x="8331" y="-8362.47" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="8331" y="-8347.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8331" y="-8332.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8331" y="-8317.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_gpu11_expert_mlp1&#45;&gt;layer11_gpu11_expert_act -->
<g id="edge1232" class="edge">
<title>layer11_gpu11_expert_mlp1&#45;&gt;layer11_gpu11_expert_act</title>
<path fill="none" stroke="black" d="M8277.65,-8413.55C8284.48,-8404.73 8291.94,-8395.1 8299.06,-8385.9"/>
<polygon fill="black" stroke="black" points="8301.85,-8388.01 8305.21,-8377.96 8296.32,-8383.73 8301.85,-8388.01"/>
</g>
<!-- layer11_gpu11_expert_mlp2 -->
<g id="node1058" class="node">
<title>layer11_gpu11_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="8554.5,-8273.67 8147.5,-8273.67 8147.5,-8205.67 8554.5,-8205.67 8554.5,-8273.67"/>
<text text-anchor="middle" x="8351" y="-8258.47" font-family="Times,serif" font-size="14.00">Expert 11 MLP2</text>
<text text-anchor="middle" x="8351" y="-8243.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8351" y="-8228.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="8351" y="-8213.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_gpu11_expert_act&#45;&gt;layer11_gpu11_expert_mlp2 -->
<g id="edge1233" class="edge">
<title>layer11_gpu11_expert_act&#45;&gt;layer11_gpu11_expert_mlp2</title>
<path fill="none" stroke="black" d="M8337.49,-8309.55C8339.1,-8301.35 8340.85,-8292.45 8342.53,-8283.86"/>
<polygon fill="black" stroke="black" points="8345.98,-8284.45 8344.47,-8273.96 8339.11,-8283.1 8345.98,-8284.45"/>
</g>
<!-- layer11_gpu11_token_send -->
<g id="node1059" class="node">
<title>layer11_gpu11_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="8391" cy="-8121.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="8391" y="-8140.38" font-family="Times,serif" font-size="14.00">Token Send GPU11</text>
<text text-anchor="middle" x="8391" y="-8125.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="8391" y="-8110.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="8391" y="-8095.38" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_gpu11_expert_mlp2&#45;&gt;layer11_gpu11_token_send -->
<g id="edge1234" class="edge">
<title>layer11_gpu11_expert_mlp2&#45;&gt;layer11_gpu11_token_send</title>
<path fill="none" stroke="black" d="M8362.46,-8205.4C8365.28,-8197.23 8368.37,-8188.26 8371.45,-8179.33"/>
<polygon fill="black" stroke="black" points="8374.82,-8180.29 8374.77,-8169.69 8368.2,-8178.01 8374.82,-8180.29"/>
</g>
<!-- layer11_gpu11_token_send&#45;&gt;layer11_expert_agg -->
<g id="edge1235" class="edge">
<title>layer11_gpu11_token_send&#45;&gt;layer11_expert_agg</title>
<path fill="none" stroke="black" d="M8149.02,-8086.25C8108.35,-8081.35 8066.52,-8076.85 8027,-8073.5 7256.77,-8008.26 6352.11,-7984.11 5853.6,-7975.34"/>
<polygon fill="black" stroke="black" points="5853.43,-7971.83 5843.37,-7975.16 5853.31,-7978.83 5853.43,-7971.83"/>
</g>
<!-- layer11_gpu12_expert_mlp1 -->
<g id="node1061" class="node">
<title>layer11_gpu12_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9263.5,-8481.67 8802.5,-8481.67 8802.5,-8413.67 9263.5,-8413.67 9263.5,-8481.67"/>
<text text-anchor="middle" x="9033" y="-8466.47" font-family="Times,serif" font-size="14.00">Expert 12 MLP1</text>
<text text-anchor="middle" x="9033" y="-8451.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9033" y="-8436.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9033" y="-8421.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer11_gpu12_token_recv&#45;&gt;layer11_gpu12_expert_mlp1 -->
<g id="edge1237" class="edge">
<title>layer11_gpu12_token_recv&#45;&gt;layer11_gpu12_expert_mlp1</title>
<path fill="none" stroke="black" d="M8965.04,-8517.87C8974.4,-8508.33 8984.17,-8498.38 8993.29,-8489.1"/>
<polygon fill="black" stroke="black" points="8995.94,-8491.4 9000.45,-8481.81 8990.94,-8486.5 8995.94,-8491.4"/>
</g>
<!-- layer11_gpu12_expert_act -->
<g id="node1062" class="node">
<title>layer11_gpu12_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9232.5,-8377.67 8855.5,-8377.67 8855.5,-8309.67 9232.5,-8309.67 9232.5,-8377.67"/>
<text text-anchor="middle" x="9044" y="-8362.47" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="9044" y="-8347.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9044" y="-8332.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9044" y="-8317.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer11_gpu12_expert_mlp1&#45;&gt;layer11_gpu12_expert_act -->
<g id="edge1238" class="edge">
<title>layer11_gpu12_expert_mlp1&#45;&gt;layer11_gpu12_expert_act</title>
<path fill="none" stroke="black" d="M9036.57,-8413.55C9037.45,-8405.44 9038.39,-8396.65 9039.31,-8388.14"/>
<polygon fill="black" stroke="black" points="9042.82,-8388.28 9040.41,-8377.96 9035.86,-8387.53 9042.82,-8388.28"/>
</g>
<!-- layer11_gpu12_expert_mlp2 -->
<g id="node1063" class="node">
<title>layer11_gpu12_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9299.5,-8273.67 8892.5,-8273.67 8892.5,-8205.67 9299.5,-8205.67 9299.5,-8273.67"/>
<text text-anchor="middle" x="9096" y="-8258.47" font-family="Times,serif" font-size="14.00">Expert 12 MLP2</text>
<text text-anchor="middle" x="9096" y="-8243.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9096" y="-8228.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9096" y="-8213.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer11_gpu12_expert_act&#45;&gt;layer11_gpu12_expert_mlp2 -->
<g id="edge1239" class="edge">
<title>layer11_gpu12_expert_act&#45;&gt;layer11_gpu12_expert_mlp2</title>
<path fill="none" stroke="black" d="M9060.88,-8309.55C9065.2,-8301.09 9069.89,-8291.87 9074.41,-8283.02"/>
<polygon fill="black" stroke="black" points="9077.6,-8284.46 9079.02,-8273.96 9071.36,-8281.28 9077.6,-8284.46"/>
</g>
<!-- layer11_gpu12_token_send -->
<g id="node1064" class="node">
<title>layer11_gpu12_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9120" cy="-8121.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9120" y="-8140.38" font-family="Times,serif" font-size="14.00">Token Send GPU12</text>
<text text-anchor="middle" x="9120" y="-8125.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9120" y="-8110.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9120" y="-8095.38" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer11_gpu12_expert_mlp2&#45;&gt;layer11_gpu12_token_send -->
<g id="edge1240" class="edge">
<title>layer11_gpu12_expert_mlp2&#45;&gt;layer11_gpu12_token_send</title>
<path fill="none" stroke="black" d="M9102.88,-8205.4C9104.55,-8197.32 9106.38,-8188.45 9108.21,-8179.61"/>
<polygon fill="black" stroke="black" points="9111.66,-8180.19 9110.26,-8169.69 9104.81,-8178.78 9111.66,-8180.19"/>
</g>
<!-- layer11_gpu12_token_send&#45;&gt;layer11_expert_agg -->
<g id="edge1241" class="edge">
<title>layer11_gpu12_token_send&#45;&gt;layer11_expert_agg</title>
<path fill="none" stroke="black" d="M8879.52,-8086.12C8838.38,-8081.19 8796.02,-8076.71 8756,-8073.5 7703.52,-7989.11 6455.89,-7972.92 5847.26,-7970.42"/>
<polygon fill="black" stroke="black" points="5847.03,-7966.92 5837.01,-7970.38 5847,-7973.92 5847.03,-7966.92"/>
</g>
<!-- layer11_gpu13_expert_mlp1 -->
<g id="node1066" class="node">
<title>layer11_gpu13_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9846.5,-8481.67 9385.5,-8481.67 9385.5,-8413.67 9846.5,-8413.67 9846.5,-8481.67"/>
<text text-anchor="middle" x="9616" y="-8466.47" font-family="Times,serif" font-size="14.00">Expert 13 MLP1</text>
<text text-anchor="middle" x="9616" y="-8451.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9616" y="-8436.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9616" y="-8421.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer11_gpu13_token_recv&#45;&gt;layer11_gpu13_expert_mlp1 -->
<g id="edge1243" class="edge">
<title>layer11_gpu13_token_recv&#45;&gt;layer11_gpu13_expert_mlp1</title>
<path fill="none" stroke="black" d="M9610.07,-8517.53C9610.79,-8509.15 9611.54,-8500.45 9612.25,-8492.17"/>
<polygon fill="black" stroke="black" points="9615.76,-8492.23 9613.13,-8481.97 9608.79,-8491.63 9615.76,-8492.23"/>
</g>
<!-- layer11_gpu13_expert_act -->
<g id="node1067" class="node">
<title>layer11_gpu13_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9863.5,-8377.67 9486.5,-8377.67 9486.5,-8309.67 9863.5,-8309.67 9863.5,-8377.67"/>
<text text-anchor="middle" x="9675" y="-8362.47" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="9675" y="-8347.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9675" y="-8332.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9675" y="-8317.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer11_gpu13_expert_mlp1&#45;&gt;layer11_gpu13_expert_act -->
<g id="edge1244" class="edge">
<title>layer11_gpu13_expert_mlp1&#45;&gt;layer11_gpu13_expert_act</title>
<path fill="none" stroke="black" d="M9635.16,-8413.55C9640.1,-8405 9645.49,-8395.68 9650.66,-8386.74"/>
<polygon fill="black" stroke="black" points="9653.76,-8388.37 9655.74,-8377.96 9647.7,-8384.87 9653.76,-8388.37"/>
</g>
<!-- layer11_gpu13_expert_mlp2 -->
<g id="node1068" class="node">
<title>layer11_gpu13_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9927.5,-8273.67 9520.5,-8273.67 9520.5,-8205.67 9927.5,-8205.67 9927.5,-8273.67"/>
<text text-anchor="middle" x="9724" y="-8258.47" font-family="Times,serif" font-size="14.00">Expert 13 MLP2</text>
<text text-anchor="middle" x="9724" y="-8243.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9724" y="-8228.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9724" y="-8213.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer11_gpu13_expert_act&#45;&gt;layer11_gpu13_expert_mlp2 -->
<g id="edge1245" class="edge">
<title>layer11_gpu13_expert_act&#45;&gt;layer11_gpu13_expert_mlp2</title>
<path fill="none" stroke="black" d="M9690.91,-8309.55C9694.97,-8301.09 9699.4,-8291.87 9703.65,-8283.02"/>
<polygon fill="black" stroke="black" points="9706.83,-8284.49 9708,-8273.96 9700.52,-8281.46 9706.83,-8284.49"/>
</g>
<!-- layer11_gpu13_token_send -->
<g id="node1069" class="node">
<title>layer11_gpu13_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9849" cy="-8121.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9849" y="-8140.38" font-family="Times,serif" font-size="14.00">Token Send GPU13</text>
<text text-anchor="middle" x="9849" y="-8125.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9849" y="-8110.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9849" y="-8095.38" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer11_gpu13_expert_mlp2&#45;&gt;layer11_gpu13_token_send -->
<g id="edge1246" class="edge">
<title>layer11_gpu13_expert_mlp2&#45;&gt;layer11_gpu13_token_send</title>
<path fill="none" stroke="black" d="M9759.82,-8205.4C9769.67,-8196.26 9780.6,-8186.1 9791.35,-8176.12"/>
<polygon fill="black" stroke="black" points="9793.79,-8178.63 9798.74,-8169.26 9789.03,-8173.5 9793.79,-8178.63"/>
</g>
<!-- layer11_gpu13_token_send&#45;&gt;layer11_expert_agg -->
<g id="edge1247" class="edge">
<title>layer11_gpu13_token_send&#45;&gt;layer11_expert_agg</title>
<path fill="none" stroke="black" d="M9609.02,-8085.98C9567.73,-8081.05 9525.18,-8076.61 9485,-8073.5 8786.96,-8019.53 6711.38,-7986.79 5853.52,-7975.23"/>
<polygon fill="black" stroke="black" points="5853.53,-7971.73 5843.48,-7975.09 5853.43,-7978.73 5853.53,-7971.73"/>
</g>
<!-- layer11_gpu14_expert_mlp1 -->
<g id="node1071" class="node">
<title>layer11_gpu14_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="10629.5,-8481.67 10168.5,-8481.67 10168.5,-8413.67 10629.5,-8413.67 10629.5,-8481.67"/>
<text text-anchor="middle" x="10399" y="-8466.47" font-family="Times,serif" font-size="14.00">Expert 14 MLP1</text>
<text text-anchor="middle" x="10399" y="-8451.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10399" y="-8436.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10399" y="-8421.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer11_gpu14_token_recv&#45;&gt;layer11_gpu14_expert_mlp1 -->
<g id="edge1249" class="edge">
<title>layer11_gpu14_token_recv&#45;&gt;layer11_gpu14_expert_mlp1</title>
<path fill="none" stroke="black" d="M10335.81,-8517.87C10344.43,-8508.43 10353.42,-8498.58 10361.83,-8489.37"/>
<polygon fill="black" stroke="black" points="10364.57,-8491.56 10368.73,-8481.81 10359.4,-8486.84 10364.57,-8491.56"/>
</g>
<!-- layer11_gpu14_expert_act -->
<g id="node1072" class="node">
<title>layer11_gpu14_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="10764.5,-8377.67 10387.5,-8377.67 10387.5,-8309.67 10764.5,-8309.67 10764.5,-8377.67"/>
<text text-anchor="middle" x="10576" y="-8362.47" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="10576" y="-8347.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10576" y="-8332.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10576" y="-8317.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer11_gpu14_expert_mlp1&#45;&gt;layer11_gpu14_expert_act -->
<g id="edge1250" class="edge">
<title>layer11_gpu14_expert_mlp1&#45;&gt;layer11_gpu14_expert_act</title>
<path fill="none" stroke="black" d="M10456.47,-8413.55C10473.4,-8403.79 10492.07,-8393.03 10509.52,-8382.98"/>
<polygon fill="black" stroke="black" points="10511.6,-8385.82 10518.52,-8377.79 10508.11,-8379.75 10511.6,-8385.82"/>
</g>
<!-- layer11_gpu14_expert_mlp2 -->
<g id="node1073" class="node">
<title>layer11_gpu14_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10779.5,-8273.67 10372.5,-8273.67 10372.5,-8205.67 10779.5,-8205.67 10779.5,-8273.67"/>
<text text-anchor="middle" x="10576" y="-8258.47" font-family="Times,serif" font-size="14.00">Expert 14 MLP2</text>
<text text-anchor="middle" x="10576" y="-8243.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10576" y="-8228.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="10576" y="-8213.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer11_gpu14_expert_act&#45;&gt;layer11_gpu14_expert_mlp2 -->
<g id="edge1251" class="edge">
<title>layer11_gpu14_expert_act&#45;&gt;layer11_gpu14_expert_mlp2</title>
<path fill="none" stroke="black" d="M10576,-8309.55C10576,-8301.44 10576,-8292.65 10576,-8284.14"/>
<polygon fill="black" stroke="black" points="10579.5,-8283.96 10576,-8273.96 10572.5,-8283.96 10579.5,-8283.96"/>
</g>
<!-- layer11_gpu14_token_send -->
<g id="node1074" class="node">
<title>layer11_gpu14_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="10578" cy="-8121.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="10578" y="-8140.38" font-family="Times,serif" font-size="14.00">Token Send GPU14</text>
<text text-anchor="middle" x="10578" y="-8125.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="10578" y="-8110.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="10578" y="-8095.38" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer11_gpu14_expert_mlp2&#45;&gt;layer11_gpu14_token_send -->
<g id="edge1252" class="edge">
<title>layer11_gpu14_expert_mlp2&#45;&gt;layer11_gpu14_token_send</title>
<path fill="none" stroke="black" d="M10576.57,-8205.4C10576.71,-8197.41 10576.86,-8188.64 10577.01,-8179.9"/>
<polygon fill="black" stroke="black" points="10580.52,-8179.75 10577.19,-8169.69 10573.52,-8179.63 10580.52,-8179.75"/>
</g>
<!-- layer11_gpu14_token_send&#45;&gt;layer11_expert_agg -->
<g id="edge1253" class="edge">
<title>layer11_gpu14_token_send&#45;&gt;layer11_expert_agg</title>
<path fill="none" stroke="black" d="M10339.01,-8085.97C10297.41,-8081 10254.51,-8076.55 10214,-8073.5 9369,-8009.85 6816.27,-7981.94 5851.09,-7973.47"/>
<polygon fill="black" stroke="black" points="5850.9,-7969.97 5840.87,-7973.38 5850.84,-7976.97 5850.9,-7969.97"/>
</g>
<!-- layer11_gpu15_expert_mlp1 -->
<g id="node1076" class="node">
<title>layer11_gpu15_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="11212.5,-8481.67 10751.5,-8481.67 10751.5,-8413.67 11212.5,-8413.67 11212.5,-8481.67"/>
<text text-anchor="middle" x="10982" y="-8466.47" font-family="Times,serif" font-size="14.00">Expert 15 MLP1</text>
<text text-anchor="middle" x="10982" y="-8451.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10982" y="-8436.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10982" y="-8421.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer11_gpu15_token_recv&#45;&gt;layer11_gpu15_expert_mlp1 -->
<g id="edge1255" class="edge">
<title>layer11_gpu15_token_recv&#45;&gt;layer11_gpu15_expert_mlp1</title>
<path fill="none" stroke="black" d="M10980.81,-8517.53C10980.96,-8509.15 10981.11,-8500.45 10981.25,-8492.17"/>
<polygon fill="black" stroke="black" points="10984.75,-8492.03 10981.43,-8481.97 10977.75,-8491.91 10984.75,-8492.03"/>
</g>
<!-- layer11_gpu15_expert_act -->
<g id="node1077" class="node">
<title>layer11_gpu15_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="11174.5,-8377.67 10797.5,-8377.67 10797.5,-8309.67 11174.5,-8309.67 11174.5,-8377.67"/>
<text text-anchor="middle" x="10986" y="-8362.47" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="10986" y="-8347.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10986" y="-8332.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10986" y="-8317.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer11_gpu15_expert_mlp1&#45;&gt;layer11_gpu15_expert_act -->
<g id="edge1256" class="edge">
<title>layer11_gpu15_expert_mlp1&#45;&gt;layer11_gpu15_expert_act</title>
<path fill="none" stroke="black" d="M10983.3,-8413.55C10983.62,-8405.44 10983.96,-8396.65 10984.3,-8388.14"/>
<polygon fill="black" stroke="black" points="10987.8,-8388.09 10984.69,-8377.96 10980.8,-8387.82 10987.8,-8388.09"/>
</g>
<!-- layer11_gpu15_expert_mlp2 -->
<g id="node1078" class="node">
<title>layer11_gpu15_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="11364.5,-8273.67 10957.5,-8273.67 10957.5,-8205.67 11364.5,-8205.67 11364.5,-8273.67"/>
<text text-anchor="middle" x="11161" y="-8258.47" font-family="Times,serif" font-size="14.00">Expert 15 MLP2</text>
<text text-anchor="middle" x="11161" y="-8243.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11161" y="-8228.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="11161" y="-8213.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer11_gpu15_expert_act&#45;&gt;layer11_gpu15_expert_mlp2 -->
<g id="edge1257" class="edge">
<title>layer11_gpu15_expert_act&#45;&gt;layer11_gpu15_expert_mlp2</title>
<path fill="none" stroke="black" d="M11042.82,-8309.55C11059.56,-8299.79 11078.02,-8289.03 11095.27,-8278.98"/>
<polygon fill="black" stroke="black" points="11097.29,-8281.85 11104.17,-8273.79 11093.77,-8275.8 11097.29,-8281.85"/>
</g>
<!-- layer11_gpu15_token_send -->
<g id="node1079" class="node">
<title>layer11_gpu15_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="11307" cy="-8121.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="11307" y="-8140.38" font-family="Times,serif" font-size="14.00">Token Send GPU15</text>
<text text-anchor="middle" x="11307" y="-8125.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="11307" y="-8110.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="11307" y="-8095.38" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer11_gpu15_expert_mlp2&#45;&gt;layer11_gpu15_token_send -->
<g id="edge1258" class="edge">
<title>layer11_gpu15_expert_mlp2&#45;&gt;layer11_gpu15_token_send</title>
<path fill="none" stroke="black" d="M11202.84,-8205.4C11214.63,-8196.02 11227.76,-8185.59 11240.61,-8175.37"/>
<polygon fill="black" stroke="black" points="11242.92,-8178.01 11248.56,-8169.04 11238.56,-8172.53 11242.92,-8178.01"/>
</g>
<!-- layer11_gpu15_token_send&#45;&gt;layer11_expert_agg -->
<g id="edge1259" class="edge">
<title>layer11_gpu15_token_send&#45;&gt;layer11_expert_agg</title>
<path fill="none" stroke="black" d="M11068.02,-8085.87C11026.42,-8080.91 10983.51,-8076.49 10943,-8073.5 9950.03,-8000.15 6913.62,-7977.85 5849.33,-7972.19"/>
<polygon fill="black" stroke="black" points="5849.24,-7968.69 5839.22,-7972.13 5849.2,-7975.69 5849.24,-7968.69"/>
</g>
<!-- layer11_residual2 -->
<g id="node1081" class="node">
<title>layer11_residual2</title>
<polygon fill="lightyellow" stroke="black" points="5918.89,-7865.5 5214.35,-7865.5 5033.11,-7729.5 5737.65,-7729.5 5918.89,-7865.5"/>
<text text-anchor="middle" x="5476" y="-7816.3" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="5476" y="-7801.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5476" y="-7786.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-7771.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer11_expert_agg&#45;&gt;layer11_residual2 -->
<g id="edge1260" class="edge">
<title>layer11_expert_agg&#45;&gt;layer11_residual2</title>
<path fill="none" stroke="black" d="M5476,-7901.31C5476,-7893 5476,-7884.44 5476,-7875.99"/>
<polygon fill="black" stroke="black" points="5479.5,-7875.76 5476,-7865.76 5472.5,-7875.76 5479.5,-7875.76"/>
</g>
<!-- layer12_layernorm -->
<g id="node1082" class="node">
<title>layer12_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="5679.5,-7682.5 5272.5,-7682.5 5272.5,-7614.5 5679.5,-7614.5 5679.5,-7682.5"/>
<text text-anchor="middle" x="5476" y="-7667.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5476" y="-7652.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-7637.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-7622.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer11_residual2&#45;&gt;layer12_layernorm -->
<g id="edge1261" class="edge">
<title>layer11_residual2&#45;&gt;layer12_layernorm</title>
<path fill="none" stroke="black" d="M5476,-7729.45C5476,-7717.04 5476,-7704.39 5476,-7692.92"/>
<polygon fill="black" stroke="black" points="5479.5,-7692.76 5476,-7682.76 5472.5,-7692.76 5479.5,-7692.76"/>
</g>
<!-- layer12_qkv_proj -->
<g id="node1083" class="node">
<title>layer12_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="5733.5,-7578.5 5218.5,-7578.5 5218.5,-7510.5 5733.5,-7510.5 5733.5,-7578.5"/>
<text text-anchor="middle" x="5476" y="-7563.3" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5476" y="-7548.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-7533.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5476" y="-7518.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer12_layernorm&#45;&gt;layer12_qkv_proj -->
<g id="edge1262" class="edge">
<title>layer12_layernorm&#45;&gt;layer12_qkv_proj</title>
<path fill="none" stroke="black" d="M5476,-7614.38C5476,-7606.28 5476,-7597.48 5476,-7588.97"/>
<polygon fill="black" stroke="black" points="5479.5,-7588.8 5476,-7578.8 5472.5,-7588.8 5479.5,-7588.8"/>
</g>
<!-- layer12_attention -->
<g id="node1084" class="node">
<title>layer12_attention</title>
<polygon fill="lightgreen" stroke="black" points="5727.5,-7474.5 5224.5,-7474.5 5224.5,-7406.5 5727.5,-7406.5 5727.5,-7474.5"/>
<text text-anchor="middle" x="5476" y="-7459.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5476" y="-7444.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5476" y="-7429.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5476" y="-7414.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer12_qkv_proj&#45;&gt;layer12_attention -->
<g id="edge1263" class="edge">
<title>layer12_qkv_proj&#45;&gt;layer12_attention</title>
<path fill="none" stroke="black" d="M5476,-7510.38C5476,-7502.28 5476,-7493.48 5476,-7484.97"/>
<polygon fill="black" stroke="black" points="5479.5,-7484.8 5476,-7474.8 5472.5,-7484.8 5479.5,-7484.8"/>
</g>
<!-- layer12_attn_out -->
<g id="node1085" class="node">
<title>layer12_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="5714.5,-7370.5 5237.5,-7370.5 5237.5,-7302.5 5714.5,-7302.5 5714.5,-7370.5"/>
<text text-anchor="middle" x="5476" y="-7355.3" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5476" y="-7340.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5476" y="-7325.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-7310.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer12_attention&#45;&gt;layer12_attn_out -->
<g id="edge1264" class="edge">
<title>layer12_attention&#45;&gt;layer12_attn_out</title>
<path fill="none" stroke="black" d="M5476,-7406.38C5476,-7398.28 5476,-7389.48 5476,-7380.97"/>
<polygon fill="black" stroke="black" points="5479.5,-7380.8 5476,-7370.8 5472.5,-7380.8 5479.5,-7380.8"/>
</g>
<!-- layer12_residual1 -->
<g id="node1086" class="node">
<title>layer12_residual1</title>
<polygon fill="lightyellow" stroke="black" points="5918.89,-7266.5 5214.35,-7266.5 5033.11,-7130.5 5737.65,-7130.5 5918.89,-7266.5"/>
<text text-anchor="middle" x="5476" y="-7217.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5476" y="-7202.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5476" y="-7187.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-7172.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer12_attn_out&#45;&gt;layer12_residual1 -->
<g id="edge1265" class="edge">
<title>layer12_attn_out&#45;&gt;layer12_residual1</title>
<path fill="none" stroke="black" d="M5476,-7302.23C5476,-7294.4 5476,-7285.73 5476,-7276.85"/>
<polygon fill="black" stroke="black" points="5479.5,-7276.76 5476,-7266.76 5472.5,-7276.76 5479.5,-7276.76"/>
</g>
<!-- layer12_layernorm2 -->
<g id="node1087" class="node">
<title>layer12_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="5679.5,-7094.5 5272.5,-7094.5 5272.5,-7026.5 5679.5,-7026.5 5679.5,-7094.5"/>
<text text-anchor="middle" x="5476" y="-7079.3" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5476" y="-7064.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-7049.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-7034.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer12_residual1&#45;&gt;layer12_layernorm2 -->
<g id="edge1266" class="edge">
<title>layer12_residual1&#45;&gt;layer12_layernorm2</title>
<path fill="none" stroke="black" d="M5476,-7130.3C5476,-7121.54 5476,-7112.77 5476,-7104.57"/>
<polygon fill="black" stroke="black" points="5479.5,-7104.52 5476,-7094.52 5472.5,-7104.52 5479.5,-7104.52"/>
</g>
<!-- layer12_global_gate -->
<g id="node1088" class="node">
<title>layer12_global_gate</title>
<polygon fill="lightgreen" stroke="black" points="5673.5,-6990.5 5278.5,-6990.5 5278.5,-6922.5 5673.5,-6922.5 5673.5,-6990.5"/>
<text text-anchor="middle" x="5476" y="-6975.3" font-family="Times,serif" font-size="14.00">Global Gate</text>
<text text-anchor="middle" x="5476" y="-6960.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-6945.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, experts=64]</text>
<text text-anchor="middle" x="5476" y="-6930.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer12_layernorm2&#45;&gt;layer12_global_gate -->
<g id="edge1267" class="edge">
<title>layer12_layernorm2&#45;&gt;layer12_global_gate</title>
<path fill="none" stroke="black" d="M5476,-7026.38C5476,-7018.28 5476,-7009.48 5476,-7000.97"/>
<polygon fill="black" stroke="black" points="5479.5,-7000.8 5476,-6990.8 5472.5,-7000.8 5479.5,-7000.8"/>
</g>
<!-- layer12_routing -->
<g id="node1089" class="node">
<title>layer12_routing</title>
<polygon fill="lightyellow" stroke="black" points="5962.47,-6886.5 5188.6,-6886.5 4989.53,-6750.5 5763.4,-6750.5 5962.47,-6886.5"/>
<text text-anchor="middle" x="5476" y="-6837.3" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="5476" y="-6822.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-6807.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5476" y="-6792.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer12_global_gate&#45;&gt;layer12_routing -->
<g id="edge1268" class="edge">
<title>layer12_global_gate&#45;&gt;layer12_routing</title>
<path fill="none" stroke="black" d="M5476,-6922.23C5476,-6914.4 5476,-6905.73 5476,-6896.85"/>
<polygon fill="black" stroke="black" points="5479.5,-6896.76 5476,-6886.76 5472.5,-6896.76 5479.5,-6896.76"/>
</g>
<!-- layer12_gpu0_token_recv -->
<g id="node1090" class="node">
<title>layer12_gpu0_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="442" cy="-6666.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="442" y="-6685.22" font-family="Times,serif" font-size="14.00">Token Receive GPU0</text>
<text text-anchor="middle" x="442" y="-6670.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="442" y="-6655.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="442" y="-6640.22" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer12_routing&#45;&gt;layer12_gpu0_token_recv -->
<g id="edge1269" class="edge">
<title>layer12_routing&#45;&gt;layer12_gpu0_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5082,-6813.8C4116.14,-6803.92 1649.67,-6773.57 828,-6714.5 783.38,-6711.29 736,-6706.59 690.27,-6701.38"/>
<polygon fill="black" stroke="black" points="690.57,-6697.89 680.24,-6700.23 689.77,-6704.85 690.57,-6697.89"/>
</g>
<!-- layer12_gpu1_token_recv -->
<g id="node1095" class="node">
<title>layer12_gpu1_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1171" cy="-6666.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1171" y="-6685.22" font-family="Times,serif" font-size="14.00">Token Receive GPU1</text>
<text text-anchor="middle" x="1171" y="-6670.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1171" y="-6655.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1171" y="-6640.22" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer12_routing&#45;&gt;layer12_gpu1_token_recv -->
<g id="edge1275" class="edge">
<title>layer12_routing&#45;&gt;layer12_gpu1_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5079.98,-6812.29C4222.23,-6800.18 2215.34,-6767.06 1536,-6714.5 1496.42,-6711.44 1454.56,-6707.09 1413.85,-6702.26"/>
<polygon fill="black" stroke="black" points="1414.15,-6698.77 1403.8,-6701.05 1413.32,-6705.72 1414.15,-6698.77"/>
</g>
<!-- layer12_gpu2_token_recv -->
<g id="node1100" class="node">
<title>layer12_gpu2_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1879" cy="-6666.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1879" y="-6685.22" font-family="Times,serif" font-size="14.00">Token Receive GPU2</text>
<text text-anchor="middle" x="1879" y="-6670.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1879" y="-6655.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1879" y="-6640.22" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer12_routing&#45;&gt;layer12_gpu2_token_recv -->
<g id="edge1281" class="edge">
<title>layer12_routing&#45;&gt;layer12_gpu2_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5088.1,-6818.01C4478.27,-6815.94 3258.47,-6800.12 2228,-6714.5 2192.22,-6711.53 2154.48,-6707.44 2117.58,-6702.91"/>
<polygon fill="black" stroke="black" points="2117.55,-6699.37 2107.2,-6701.62 2116.69,-6706.32 2117.55,-6699.37"/>
</g>
<!-- layer12_gpu3_token_recv -->
<g id="node1105" class="node">
<title>layer12_gpu3_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="2571" cy="-6666.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2571" y="-6685.22" font-family="Times,serif" font-size="14.00">Token Receive GPU3</text>
<text text-anchor="middle" x="2571" y="-6670.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="2571" y="-6655.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2571" y="-6640.22" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer12_routing&#45;&gt;layer12_gpu3_token_recv -->
<g id="edge1287" class="edge">
<title>layer12_routing&#45;&gt;layer12_gpu3_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5075.46,-6809.22C4585.27,-6797.15 3730.21,-6769.86 2999,-6714.5 2945.32,-6710.43 2887.97,-6704.93 2833.26,-6699.12"/>
<polygon fill="black" stroke="black" points="2833.39,-6695.61 2823.08,-6698.03 2832.65,-6702.57 2833.39,-6695.61"/>
</g>
<!-- layer12_gpu4_token_recv -->
<g id="node1110" class="node">
<title>layer12_gpu4_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="3342" cy="-6666.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="3342" y="-6685.22" font-family="Times,serif" font-size="14.00">Token Receive GPU4</text>
<text text-anchor="middle" x="3342" y="-6670.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="3342" y="-6655.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3342" y="-6640.22" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer12_routing&#45;&gt;layer12_gpu4_token_recv -->
<g id="edge1293" class="edge">
<title>layer12_routing&#45;&gt;layer12_gpu4_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5062.24,-6800.42C4707.7,-6784.03 4183.66,-6755.67 3728,-6714.5 3685.03,-6710.62 3639.45,-6705.74 3595.25,-6700.6"/>
<polygon fill="black" stroke="black" points="3595.58,-6697.12 3585.24,-6699.43 3594.77,-6704.07 3595.58,-6697.12"/>
</g>
<!-- layer12_gpu5_token_recv -->
<g id="node1115" class="node">
<title>layer12_gpu5_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4071" cy="-6666.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4071" y="-6685.22" font-family="Times,serif" font-size="14.00">Token Receive GPU5</text>
<text text-anchor="middle" x="4071" y="-6670.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4071" y="-6655.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4071" y="-6640.22" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer12_routing&#45;&gt;layer12_gpu5_token_recv -->
<g id="edge1299" class="edge">
<title>layer12_routing&#45;&gt;layer12_gpu5_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5026.49,-6775.91C4843.22,-6758.19 4629.34,-6736.54 4436,-6714.5 4399.43,-6710.33 4360.84,-6705.65 4322.99,-6700.91"/>
<polygon fill="black" stroke="black" points="4323.22,-6697.41 4312.86,-6699.64 4322.35,-6704.36 4323.22,-6697.41"/>
</g>
<!-- layer12_gpu6_token_recv -->
<g id="node1120" class="node">
<title>layer12_gpu6_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4779" cy="-6666.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4779" y="-6685.22" font-family="Times,serif" font-size="14.00">Token Receive GPU6</text>
<text text-anchor="middle" x="4779" y="-6670.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4779" y="-6655.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4779" y="-6640.22" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer12_routing&#45;&gt;layer12_gpu6_token_recv -->
<g id="edge1305" class="edge">
<title>layer12_routing&#45;&gt;layer12_gpu6_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5164.7,-6750.47C5098.9,-6736.3 5031.31,-6721.74 4971.46,-6708.86"/>
<polygon fill="black" stroke="black" points="4972.05,-6705.4 4961.53,-6706.72 4970.57,-6712.25 4972.05,-6705.4"/>
</g>
<!-- layer12_gpu7_token_recv -->
<g id="node1125" class="node">
<title>layer12_gpu7_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="5476" cy="-6666.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="5476" y="-6685.22" font-family="Times,serif" font-size="14.00">Token Receive GPU7</text>
<text text-anchor="middle" x="5476" y="-6670.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5476" y="-6655.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5476" y="-6640.22" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer12_routing&#45;&gt;layer12_gpu7_token_recv -->
<g id="edge1311" class="edge">
<title>layer12_routing&#45;&gt;layer12_gpu7_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5476,-6750.36C5476,-6741.81 5476,-6733.13 5476,-6724.76"/>
<polygon fill="black" stroke="black" points="5479.5,-6724.73 5476,-6714.73 5472.5,-6724.73 5479.5,-6724.73"/>
</g>
<!-- layer12_gpu8_token_recv -->
<g id="node1130" class="node">
<title>layer12_gpu8_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6184" cy="-6666.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6184" y="-6685.22" font-family="Times,serif" font-size="14.00">Token Receive GPU8</text>
<text text-anchor="middle" x="6184" y="-6670.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6184" y="-6655.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6184" y="-6640.22" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer12_routing&#45;&gt;layer12_gpu8_token_recv -->
<g id="edge1317" class="edge">
<title>layer12_routing&#45;&gt;layer12_gpu8_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5770.36,-6755.1C5844.3,-6739.43 5921.81,-6722.99 5989.49,-6708.65"/>
<polygon fill="black" stroke="black" points="5990.35,-6712.04 5999.4,-6706.55 5988.89,-6705.2 5990.35,-6712.04"/>
</g>
<!-- layer12_gpu9_token_recv -->
<g id="node1135" class="node">
<title>layer12_gpu9_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6881" cy="-6666.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6881" y="-6685.22" font-family="Times,serif" font-size="14.00">Token Receive GPU9</text>
<text text-anchor="middle" x="6881" y="-6670.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6881" y="-6655.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6881" y="-6640.22" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer12_routing&#45;&gt;layer12_gpu9_token_recv -->
<g id="edge1323" class="edge">
<title>layer12_routing&#45;&gt;layer12_gpu9_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5817.11,-6787.07C6022.91,-6767.97 6290.23,-6741.84 6527,-6714.5 6561.2,-6710.55 6597.22,-6706.1 6632.66,-6701.55"/>
<polygon fill="black" stroke="black" points="6633.17,-6705.01 6642.64,-6700.26 6632.27,-6698.07 6633.17,-6705.01"/>
</g>
<!-- layer12_gpu10_token_recv -->
<g id="node1140" class="node">
<title>layer12_gpu10_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="7595" cy="-6666.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="7595" y="-6685.22" font-family="Times,serif" font-size="14.00">Token Receive GPU10</text>
<text text-anchor="middle" x="7595" y="-6670.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="7595" y="-6655.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7595" y="-6640.22" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer12_routing&#45;&gt;layer12_gpu10_token_recv -->
<g id="edge1329" class="edge">
<title>layer12_routing&#45;&gt;layer12_gpu10_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5840.62,-6803.18C6194.61,-6787.58 6746.87,-6758.78 7224,-6714.5 7263.57,-6710.83 7305.42,-6706.22 7346.21,-6701.33"/>
<polygon fill="black" stroke="black" points="7346.76,-6704.79 7356.27,-6700.12 7345.92,-6697.84 7346.76,-6704.79"/>
</g>
<!-- layer12_gpu11_token_recv -->
<g id="node1145" class="node">
<title>layer12_gpu11_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8296" cy="-6666.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8296" y="-6685.22" font-family="Times,serif" font-size="14.00">Token Receive GPU11</text>
<text text-anchor="middle" x="8296" y="-6670.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8296" y="-6655.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8296" y="-6640.22" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer12_routing&#45;&gt;layer12_gpu11_token_recv -->
<g id="edge1335" class="edge">
<title>layer12_routing&#45;&gt;layer12_gpu11_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5853.63,-6812.12C6337.4,-6802.84 7201.45,-6778.21 7938,-6714.5 7975.27,-6711.28 8014.61,-6707 8053.03,-6702.33"/>
<polygon fill="black" stroke="black" points="8053.81,-6705.76 8063.31,-6701.07 8052.96,-6698.81 8053.81,-6705.76"/>
</g>
<!-- layer12_gpu12_token_recv -->
<g id="node1150" class="node">
<title>layer12_gpu12_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8990" cy="-6666.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8990" y="-6685.22" font-family="Times,serif" font-size="14.00">Token Receive GPU12</text>
<text text-anchor="middle" x="8990" y="-6670.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8990" y="-6655.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8990" y="-6640.22" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_routing&#45;&gt;layer12_gpu12_token_recv -->
<g id="edge1341" class="edge">
<title>layer12_routing&#45;&gt;layer12_gpu12_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5861.67,-6817.45C6458.14,-6814.54 7639.92,-6797.56 8639,-6714.5 8675.28,-6711.48 8713.55,-6707.34 8750.96,-6702.76"/>
<polygon fill="black" stroke="black" points="8751.47,-6706.22 8760.96,-6701.52 8750.61,-6699.28 8751.47,-6706.22"/>
</g>
<!-- layer12_gpu13_token_recv -->
<g id="node1155" class="node">
<title>layer12_gpu13_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="9680" cy="-6666.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="9680" y="-6685.22" font-family="Times,serif" font-size="14.00">Token Receive GPU13</text>
<text text-anchor="middle" x="9680" y="-6670.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="9680" y="-6655.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9680" y="-6640.22" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer12_routing&#45;&gt;layer12_gpu13_token_recv -->
<g id="edge1347" class="edge">
<title>layer12_routing&#45;&gt;layer12_gpu13_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5854.66,-6812.61C6689.24,-6800.97 8665.74,-6768.52 9333,-6714.5 9368.59,-6711.62 9406.11,-6707.58 9442.8,-6703.07"/>
<polygon fill="black" stroke="black" points="9443.64,-6706.49 9453.13,-6701.79 9442.77,-6699.55 9443.64,-6706.49"/>
</g>
<!-- layer12_gpu14_token_recv -->
<g id="node1160" class="node">
<title>layer12_gpu14_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10369" cy="-6666.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10369" y="-6685.22" font-family="Times,serif" font-size="14.00">Token Receive GPU14</text>
<text text-anchor="middle" x="10369" y="-6670.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10369" y="-6655.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10369" y="-6640.22" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer12_routing&#45;&gt;layer12_gpu14_token_recv -->
<g id="edge1353" class="edge">
<title>layer12_routing&#45;&gt;layer12_gpu14_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5857.16,-6814.39C6799.09,-6805.83 9218.38,-6778.15 10023,-6714.5 10058.49,-6711.69 10095.91,-6707.69 10132.5,-6703.2"/>
<polygon fill="black" stroke="black" points="10133.3,-6706.63 10142.8,-6701.92 10132.44,-6699.68 10133.3,-6706.63"/>
</g>
<!-- layer12_gpu15_token_recv -->
<g id="node1165" class="node">
<title>layer12_gpu15_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="11057" cy="-6666.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="11057" y="-6685.22" font-family="Times,serif" font-size="14.00">Token Receive GPU15</text>
<text text-anchor="middle" x="11057" y="-6670.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="11057" y="-6655.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="11057" y="-6640.22" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer12_routing&#45;&gt;layer12_gpu15_token_recv -->
<g id="edge1359" class="edge">
<title>layer12_routing&#45;&gt;layer12_gpu15_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5859.31,-6815.73C6901.04,-6810.01 9769.14,-6787.86 10712,-6714.5 10747.4,-6711.74 10784.71,-6707.78 10821.19,-6703.3"/>
<polygon fill="black" stroke="black" points="10821.97,-6706.73 10831.46,-6702.02 10821.1,-6699.78 10821.97,-6706.73"/>
</g>
<!-- layer12_gpu0_expert_mlp1 -->
<g id="node1091" class="node">
<title>layer12_gpu0_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="662.5,-6582.33 201.5,-6582.33 201.5,-6514.33 662.5,-6514.33 662.5,-6582.33"/>
<text text-anchor="middle" x="432" y="-6567.13" font-family="Times,serif" font-size="14.00">Expert 0 MLP1</text>
<text text-anchor="middle" x="432" y="-6552.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="432" y="-6537.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="432" y="-6522.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer12_gpu0_token_recv&#45;&gt;layer12_gpu0_expert_mlp1 -->
<g id="edge1270" class="edge">
<title>layer12_gpu0_token_recv&#45;&gt;layer12_gpu0_expert_mlp1</title>
<path fill="none" stroke="black" d="M437.93,-6618.2C437.21,-6609.81 436.46,-6601.12 435.75,-6592.84"/>
<polygon fill="black" stroke="black" points="439.21,-6592.3 434.87,-6582.64 432.24,-6592.9 439.21,-6592.3"/>
</g>
<!-- layer12_gpu0_expert_act -->
<g id="node1092" class="node">
<title>layer12_gpu0_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="595.5,-6478.33 218.5,-6478.33 218.5,-6410.33 595.5,-6410.33 595.5,-6478.33"/>
<text text-anchor="middle" x="407" y="-6463.13" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="407" y="-6448.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="407" y="-6433.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="407" y="-6418.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer12_gpu0_expert_mlp1&#45;&gt;layer12_gpu0_expert_act -->
<g id="edge1271" class="edge">
<title>layer12_gpu0_expert_mlp1&#45;&gt;layer12_gpu0_expert_act</title>
<path fill="none" stroke="black" d="M423.88,-6514.22C421.87,-6506.02 419.69,-6497.12 417.59,-6488.52"/>
<polygon fill="black" stroke="black" points="420.94,-6487.51 415.16,-6478.63 414.14,-6489.18 420.94,-6487.51"/>
</g>
<!-- layer12_gpu0_expert_mlp2 -->
<g id="node1093" class="node">
<title>layer12_gpu0_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="593.5,-6374.33 186.5,-6374.33 186.5,-6306.33 593.5,-6306.33 593.5,-6374.33"/>
<text text-anchor="middle" x="390" y="-6359.13" font-family="Times,serif" font-size="14.00">Expert 0 MLP2</text>
<text text-anchor="middle" x="390" y="-6344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="390" y="-6329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="390" y="-6314.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer12_gpu0_expert_act&#45;&gt;layer12_gpu0_expert_mlp2 -->
<g id="edge1272" class="edge">
<title>layer12_gpu0_expert_act&#45;&gt;layer12_gpu0_expert_mlp2</title>
<path fill="none" stroke="black" d="M401.48,-6410.22C400.11,-6402.02 398.63,-6393.12 397.2,-6384.52"/>
<polygon fill="black" stroke="black" points="400.65,-6383.92 395.55,-6374.63 393.74,-6385.07 400.65,-6383.92"/>
</g>
<!-- layer12_gpu0_token_send -->
<g id="node1094" class="node">
<title>layer12_gpu0_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="372" cy="-6222.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="372" y="-6241.05" font-family="Times,serif" font-size="14.00">Token Send GPU0</text>
<text text-anchor="middle" x="372" y="-6226.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="372" y="-6211.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="372" y="-6196.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer12_gpu0_expert_mlp2&#45;&gt;layer12_gpu0_token_send -->
<g id="edge1273" class="edge">
<title>layer12_gpu0_expert_mlp2&#45;&gt;layer12_gpu0_token_send</title>
<path fill="none" stroke="black" d="M384.84,-6306.07C383.59,-6297.99 382.21,-6289.12 380.84,-6280.28"/>
<polygon fill="black" stroke="black" points="384.3,-6279.7 379.3,-6270.36 377.38,-6280.78 384.3,-6279.7"/>
</g>
<!-- layer12_expert_agg -->
<g id="node1170" class="node">
<title>layer12_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="5928.05,-6138.17 5208.94,-6138.17 5023.95,-6002.17 5743.06,-6002.17 5928.05,-6138.17"/>
<text text-anchor="middle" x="5476" y="-6088.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5476" y="-6073.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x16)</text>
<text text-anchor="middle" x="5476" y="-6058.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-6043.97" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer12_gpu0_token_send&#45;&gt;layer12_expert_agg -->
<g id="edge1274" class="edge">
<title>layer12_gpu0_token_send&#45;&gt;layer12_expert_agg</title>
<path fill="none" stroke="black" d="M610.99,-6186.63C652.59,-6181.67 695.49,-6177.22 736,-6174.17 1584.42,-6110.26 4153.72,-6082.4 5111.19,-6074.04"/>
<polygon fill="black" stroke="black" points="5111.37,-6077.54 5121.34,-6073.95 5111.31,-6070.54 5111.37,-6077.54"/>
</g>
<!-- layer12_gpu1_expert_mlp1 -->
<g id="node1096" class="node">
<title>layer12_gpu1_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="1391.5,-6582.33 930.5,-6582.33 930.5,-6514.33 1391.5,-6514.33 1391.5,-6582.33"/>
<text text-anchor="middle" x="1161" y="-6567.13" font-family="Times,serif" font-size="14.00">Expert 1 MLP1</text>
<text text-anchor="middle" x="1161" y="-6552.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1161" y="-6537.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1161" y="-6522.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer12_gpu1_token_recv&#45;&gt;layer12_gpu1_expert_mlp1 -->
<g id="edge1276" class="edge">
<title>layer12_gpu1_token_recv&#45;&gt;layer12_gpu1_expert_mlp1</title>
<path fill="none" stroke="black" d="M1166.93,-6618.2C1166.21,-6609.81 1165.46,-6601.12 1164.75,-6592.84"/>
<polygon fill="black" stroke="black" points="1168.21,-6592.3 1163.87,-6582.64 1161.24,-6592.9 1168.21,-6592.3"/>
</g>
<!-- layer12_gpu1_expert_act -->
<g id="node1097" class="node">
<title>layer12_gpu1_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="1324.5,-6478.33 947.5,-6478.33 947.5,-6410.33 1324.5,-6410.33 1324.5,-6478.33"/>
<text text-anchor="middle" x="1136" y="-6463.13" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1136" y="-6448.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1136" y="-6433.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1136" y="-6418.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer12_gpu1_expert_mlp1&#45;&gt;layer12_gpu1_expert_act -->
<g id="edge1277" class="edge">
<title>layer12_gpu1_expert_mlp1&#45;&gt;layer12_gpu1_expert_act</title>
<path fill="none" stroke="black" d="M1152.88,-6514.22C1150.87,-6506.02 1148.69,-6497.12 1146.59,-6488.52"/>
<polygon fill="black" stroke="black" points="1149.94,-6487.51 1144.16,-6478.63 1143.14,-6489.18 1149.94,-6487.51"/>
</g>
<!-- layer12_gpu1_expert_mlp2 -->
<g id="node1098" class="node">
<title>layer12_gpu1_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="1322.5,-6374.33 915.5,-6374.33 915.5,-6306.33 1322.5,-6306.33 1322.5,-6374.33"/>
<text text-anchor="middle" x="1119" y="-6359.13" font-family="Times,serif" font-size="14.00">Expert 1 MLP2</text>
<text text-anchor="middle" x="1119" y="-6344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1119" y="-6329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1119" y="-6314.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer12_gpu1_expert_act&#45;&gt;layer12_gpu1_expert_mlp2 -->
<g id="edge1278" class="edge">
<title>layer12_gpu1_expert_act&#45;&gt;layer12_gpu1_expert_mlp2</title>
<path fill="none" stroke="black" d="M1130.48,-6410.22C1129.11,-6402.02 1127.63,-6393.12 1126.2,-6384.52"/>
<polygon fill="black" stroke="black" points="1129.65,-6383.92 1124.55,-6374.63 1122.74,-6385.07 1129.65,-6383.92"/>
</g>
<!-- layer12_gpu1_token_send -->
<g id="node1099" class="node">
<title>layer12_gpu1_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1101" cy="-6222.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1101" y="-6241.05" font-family="Times,serif" font-size="14.00">Token Send GPU1</text>
<text text-anchor="middle" x="1101" y="-6226.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1101" y="-6211.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1101" y="-6196.05" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer12_gpu1_expert_mlp2&#45;&gt;layer12_gpu1_token_send -->
<g id="edge1279" class="edge">
<title>layer12_gpu1_expert_mlp2&#45;&gt;layer12_gpu1_token_send</title>
<path fill="none" stroke="black" d="M1113.84,-6306.07C1112.59,-6297.99 1111.21,-6289.12 1109.84,-6280.28"/>
<polygon fill="black" stroke="black" points="1113.3,-6279.7 1108.3,-6270.36 1106.38,-6280.78 1113.3,-6279.7"/>
</g>
<!-- layer12_gpu1_token_send&#45;&gt;layer12_expert_agg -->
<g id="edge1280" class="edge">
<title>layer12_gpu1_token_send&#45;&gt;layer12_expert_agg</title>
<path fill="none" stroke="black" d="M1340.98,-6186.65C1382.27,-6181.72 1424.82,-6177.27 1465,-6174.17 2167.52,-6119.86 4264.61,-6087.06 5113.39,-6075.69"/>
<polygon fill="black" stroke="black" points="5113.68,-6079.19 5123.63,-6075.55 5113.58,-6072.19 5113.68,-6079.19"/>
</g>
<!-- layer12_gpu2_expert_mlp1 -->
<g id="node1101" class="node">
<title>layer12_gpu2_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2083.5,-6582.33 1622.5,-6582.33 1622.5,-6514.33 2083.5,-6514.33 2083.5,-6582.33"/>
<text text-anchor="middle" x="1853" y="-6567.13" font-family="Times,serif" font-size="14.00">Expert 2 MLP1</text>
<text text-anchor="middle" x="1853" y="-6552.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1853" y="-6537.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1853" y="-6522.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer12_gpu2_token_recv&#45;&gt;layer12_gpu2_expert_mlp1 -->
<g id="edge1282" class="edge">
<title>layer12_gpu2_token_recv&#45;&gt;layer12_gpu2_expert_mlp1</title>
<path fill="none" stroke="black" d="M1868.42,-6618.2C1866.53,-6609.72 1864.56,-6600.92 1862.68,-6592.56"/>
<polygon fill="black" stroke="black" points="1866.06,-6591.63 1860.46,-6582.64 1859.23,-6593.16 1866.06,-6591.63"/>
</g>
<!-- layer12_gpu2_expert_act -->
<g id="node1102" class="node">
<title>layer12_gpu2_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2028.5,-6478.33 1651.5,-6478.33 1651.5,-6410.33 2028.5,-6410.33 2028.5,-6478.33"/>
<text text-anchor="middle" x="1840" y="-6463.13" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="1840" y="-6448.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1840" y="-6433.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1840" y="-6418.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer12_gpu2_expert_mlp1&#45;&gt;layer12_gpu2_expert_act -->
<g id="edge1283" class="edge">
<title>layer12_gpu2_expert_mlp1&#45;&gt;layer12_gpu2_expert_act</title>
<path fill="none" stroke="black" d="M1848.78,-6514.22C1847.75,-6506.11 1846.63,-6497.31 1845.54,-6488.8"/>
<polygon fill="black" stroke="black" points="1848.98,-6488.11 1844.24,-6478.63 1842.04,-6488.99 1848.98,-6488.11"/>
</g>
<!-- layer12_gpu2_expert_mlp2 -->
<g id="node1103" class="node">
<title>layer12_gpu2_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2040.5,-6374.33 1633.5,-6374.33 1633.5,-6306.33 2040.5,-6306.33 2040.5,-6374.33"/>
<text text-anchor="middle" x="1837" y="-6359.13" font-family="Times,serif" font-size="14.00">Expert 2 MLP2</text>
<text text-anchor="middle" x="1837" y="-6344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1837" y="-6329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1837" y="-6314.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer12_gpu2_expert_act&#45;&gt;layer12_gpu2_expert_mlp2 -->
<g id="edge1284" class="edge">
<title>layer12_gpu2_expert_act&#45;&gt;layer12_gpu2_expert_mlp2</title>
<path fill="none" stroke="black" d="M1839.03,-6410.22C1838.79,-6402.11 1838.53,-6393.31 1838.28,-6384.8"/>
<polygon fill="black" stroke="black" points="1841.77,-6384.52 1837.98,-6374.63 1834.77,-6384.73 1841.77,-6384.52"/>
</g>
<!-- layer12_gpu2_token_send -->
<g id="node1104" class="node">
<title>layer12_gpu2_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1830" cy="-6222.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1830" y="-6241.05" font-family="Times,serif" font-size="14.00">Token Send GPU2</text>
<text text-anchor="middle" x="1830" y="-6226.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1830" y="-6211.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1830" y="-6196.05" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer12_gpu2_expert_mlp2&#45;&gt;layer12_gpu2_token_send -->
<g id="edge1285" class="edge">
<title>layer12_gpu2_expert_mlp2&#45;&gt;layer12_gpu2_token_send</title>
<path fill="none" stroke="black" d="M1834.99,-6306.07C1834.51,-6298.07 1833.98,-6289.31 1833.46,-6280.56"/>
<polygon fill="black" stroke="black" points="1836.94,-6280.13 1832.84,-6270.36 1829.95,-6280.55 1836.94,-6280.13"/>
</g>
<!-- layer12_gpu2_token_send&#45;&gt;layer12_expert_agg -->
<g id="edge1286" class="edge">
<title>layer12_gpu2_token_send&#45;&gt;layer12_expert_agg</title>
<path fill="none" stroke="black" d="M2070.48,-6186.79C2111.62,-6181.85 2153.98,-6177.37 2194,-6174.17 3248.72,-6089.6 4499.28,-6073.52 5107.27,-6071.07"/>
<polygon fill="black" stroke="black" points="5107.52,-6074.56 5117.5,-6071.02 5107.49,-6067.56 5107.52,-6074.56"/>
</g>
<!-- layer12_gpu3_expert_mlp1 -->
<g id="node1106" class="node">
<title>layer12_gpu3_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2798.5,-6582.33 2337.5,-6582.33 2337.5,-6514.33 2798.5,-6514.33 2798.5,-6582.33"/>
<text text-anchor="middle" x="2568" y="-6567.13" font-family="Times,serif" font-size="14.00">Expert 3 MLP1</text>
<text text-anchor="middle" x="2568" y="-6552.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2568" y="-6537.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2568" y="-6522.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer12_gpu3_token_recv&#45;&gt;layer12_gpu3_expert_mlp1 -->
<g id="edge1288" class="edge">
<title>layer12_gpu3_token_recv&#45;&gt;layer12_gpu3_expert_mlp1</title>
<path fill="none" stroke="black" d="M2569.78,-6618.2C2569.56,-6609.81 2569.34,-6601.12 2569.12,-6592.84"/>
<polygon fill="black" stroke="black" points="2572.62,-6592.54 2568.86,-6582.64 2565.62,-6592.72 2572.62,-6592.54"/>
</g>
<!-- layer12_gpu3_expert_act -->
<g id="node1107" class="node">
<title>layer12_gpu3_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2755.5,-6478.33 2378.5,-6478.33 2378.5,-6410.33 2755.5,-6410.33 2755.5,-6478.33"/>
<text text-anchor="middle" x="2567" y="-6463.13" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="2567" y="-6448.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2567" y="-6433.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2567" y="-6418.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer12_gpu3_expert_mlp1&#45;&gt;layer12_gpu3_expert_act -->
<g id="edge1289" class="edge">
<title>layer12_gpu3_expert_mlp1&#45;&gt;layer12_gpu3_expert_act</title>
<path fill="none" stroke="black" d="M2567.68,-6514.22C2567.6,-6506.11 2567.51,-6497.31 2567.43,-6488.8"/>
<polygon fill="black" stroke="black" points="2570.92,-6488.6 2567.33,-6478.63 2563.92,-6488.67 2570.92,-6488.6"/>
</g>
<!-- layer12_gpu3_expert_mlp2 -->
<g id="node1108" class="node">
<title>layer12_gpu3_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2767.5,-6374.33 2360.5,-6374.33 2360.5,-6306.33 2767.5,-6306.33 2767.5,-6374.33"/>
<text text-anchor="middle" x="2564" y="-6359.13" font-family="Times,serif" font-size="14.00">Expert 3 MLP2</text>
<text text-anchor="middle" x="2564" y="-6344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2564" y="-6329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="2564" y="-6314.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer12_gpu3_expert_act&#45;&gt;layer12_gpu3_expert_mlp2 -->
<g id="edge1290" class="edge">
<title>layer12_gpu3_expert_act&#45;&gt;layer12_gpu3_expert_mlp2</title>
<path fill="none" stroke="black" d="M2566.03,-6410.22C2565.79,-6402.11 2565.53,-6393.31 2565.28,-6384.8"/>
<polygon fill="black" stroke="black" points="2568.77,-6384.52 2564.98,-6374.63 2561.77,-6384.73 2568.77,-6384.52"/>
</g>
<!-- layer12_gpu3_token_send -->
<g id="node1109" class="node">
<title>layer12_gpu3_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="2559" cy="-6222.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="2559" y="-6241.05" font-family="Times,serif" font-size="14.00">Token Send GPU3</text>
<text text-anchor="middle" x="2559" y="-6226.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="2559" y="-6211.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="2559" y="-6196.05" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer12_gpu3_expert_mlp2&#45;&gt;layer12_gpu3_token_send -->
<g id="edge1291" class="edge">
<title>layer12_gpu3_expert_mlp2&#45;&gt;layer12_gpu3_token_send</title>
<path fill="none" stroke="black" d="M2562.57,-6306.07C2562.22,-6298.07 2561.85,-6289.31 2561.47,-6280.56"/>
<polygon fill="black" stroke="black" points="2564.96,-6280.2 2561.03,-6270.36 2557.96,-6280.5 2564.96,-6280.2"/>
</g>
<!-- layer12_gpu3_token_send&#45;&gt;layer12_expert_agg -->
<g id="edge1292" class="edge">
<title>layer12_gpu3_token_send&#45;&gt;layer12_expert_agg</title>
<path fill="none" stroke="black" d="M2800.98,-6186.92C2841.65,-6182.02 2883.48,-6177.51 2923,-6174.17 3701.79,-6108.22 4617.91,-6084.26 5113.42,-6075.73"/>
<polygon fill="black" stroke="black" points="5113.65,-6079.22 5123.59,-6075.55 5113.53,-6072.22 5113.65,-6079.22"/>
</g>
<!-- layer12_gpu4_expert_mlp1 -->
<g id="node1111" class="node">
<title>layer12_gpu4_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="3546.5,-6582.33 3085.5,-6582.33 3085.5,-6514.33 3546.5,-6514.33 3546.5,-6582.33"/>
<text text-anchor="middle" x="3316" y="-6567.13" font-family="Times,serif" font-size="14.00">Expert 4 MLP1</text>
<text text-anchor="middle" x="3316" y="-6552.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3316" y="-6537.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3316" y="-6522.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer12_gpu4_token_recv&#45;&gt;layer12_gpu4_expert_mlp1 -->
<g id="edge1294" class="edge">
<title>layer12_gpu4_token_recv&#45;&gt;layer12_gpu4_expert_mlp1</title>
<path fill="none" stroke="black" d="M3331.42,-6618.2C3329.53,-6609.72 3327.56,-6600.92 3325.68,-6592.56"/>
<polygon fill="black" stroke="black" points="3329.06,-6591.63 3323.46,-6582.64 3322.23,-6593.16 3329.06,-6591.63"/>
</g>
<!-- layer12_gpu4_expert_act -->
<g id="node1112" class="node">
<title>layer12_gpu4_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="3496.5,-6478.33 3119.5,-6478.33 3119.5,-6410.33 3496.5,-6410.33 3496.5,-6478.33"/>
<text text-anchor="middle" x="3308" y="-6463.13" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="3308" y="-6448.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3308" y="-6433.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3308" y="-6418.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer12_gpu4_expert_mlp1&#45;&gt;layer12_gpu4_expert_act -->
<g id="edge1295" class="edge">
<title>layer12_gpu4_expert_mlp1&#45;&gt;layer12_gpu4_expert_act</title>
<path fill="none" stroke="black" d="M3313.4,-6514.22C3312.77,-6506.11 3312.08,-6497.31 3311.41,-6488.8"/>
<polygon fill="black" stroke="black" points="3314.88,-6488.33 3310.61,-6478.63 3307.9,-6488.87 3314.88,-6488.33"/>
</g>
<!-- layer12_gpu4_expert_mlp2 -->
<g id="node1113" class="node">
<title>layer12_gpu4_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="3504.5,-6374.33 3097.5,-6374.33 3097.5,-6306.33 3504.5,-6306.33 3504.5,-6374.33"/>
<text text-anchor="middle" x="3301" y="-6359.13" font-family="Times,serif" font-size="14.00">Expert 4 MLP2</text>
<text text-anchor="middle" x="3301" y="-6344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3301" y="-6329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="3301" y="-6314.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer12_gpu4_expert_act&#45;&gt;layer12_gpu4_expert_mlp2 -->
<g id="edge1296" class="edge">
<title>layer12_gpu4_expert_act&#45;&gt;layer12_gpu4_expert_mlp2</title>
<path fill="none" stroke="black" d="M3305.73,-6410.22C3305.17,-6402.11 3304.57,-6393.31 3303.98,-6384.8"/>
<polygon fill="black" stroke="black" points="3307.46,-6384.37 3303.29,-6374.63 3300.48,-6384.85 3307.46,-6384.37"/>
</g>
<!-- layer12_gpu4_token_send -->
<g id="node1114" class="node">
<title>layer12_gpu4_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="3288" cy="-6222.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="3288" y="-6241.05" font-family="Times,serif" font-size="14.00">Token Send GPU4</text>
<text text-anchor="middle" x="3288" y="-6226.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="3288" y="-6211.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="3288" y="-6196.05" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer12_gpu4_expert_mlp2&#45;&gt;layer12_gpu4_token_send -->
<g id="edge1297" class="edge">
<title>layer12_gpu4_expert_mlp2&#45;&gt;layer12_gpu4_token_send</title>
<path fill="none" stroke="black" d="M3297.27,-6306.07C3296.38,-6298.07 3295.4,-6289.31 3294.42,-6280.56"/>
<polygon fill="black" stroke="black" points="3297.87,-6279.91 3293.28,-6270.36 3290.91,-6280.69 3297.87,-6279.91"/>
</g>
<!-- layer12_gpu4_token_send&#45;&gt;layer12_expert_agg -->
<g id="edge1298" class="edge">
<title>layer12_gpu4_token_send&#45;&gt;layer12_expert_agg</title>
<path fill="none" stroke="black" d="M3531.99,-6187.22C3572.03,-6182.35 3613.14,-6177.77 3652,-6174.17 4162.71,-6126.78 4756.04,-6098.16 5123.82,-6083.51"/>
<polygon fill="black" stroke="black" points="5123.96,-6087 5133.82,-6083.11 5123.69,-6080.01 5123.96,-6087"/>
</g>
<!-- layer12_gpu5_expert_mlp1 -->
<g id="node1116" class="node">
<title>layer12_gpu5_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4275.5,-6582.33 3814.5,-6582.33 3814.5,-6514.33 4275.5,-6514.33 4275.5,-6582.33"/>
<text text-anchor="middle" x="4045" y="-6567.13" font-family="Times,serif" font-size="14.00">Expert 5 MLP1</text>
<text text-anchor="middle" x="4045" y="-6552.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4045" y="-6537.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4045" y="-6522.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer12_gpu5_token_recv&#45;&gt;layer12_gpu5_expert_mlp1 -->
<g id="edge1300" class="edge">
<title>layer12_gpu5_token_recv&#45;&gt;layer12_gpu5_expert_mlp1</title>
<path fill="none" stroke="black" d="M4060.42,-6618.2C4058.53,-6609.72 4056.56,-6600.92 4054.68,-6592.56"/>
<polygon fill="black" stroke="black" points="4058.06,-6591.63 4052.46,-6582.64 4051.23,-6593.16 4058.06,-6591.63"/>
</g>
<!-- layer12_gpu5_expert_act -->
<g id="node1117" class="node">
<title>layer12_gpu5_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4225.5,-6478.33 3848.5,-6478.33 3848.5,-6410.33 4225.5,-6410.33 4225.5,-6478.33"/>
<text text-anchor="middle" x="4037" y="-6463.13" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="4037" y="-6448.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4037" y="-6433.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4037" y="-6418.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer12_gpu5_expert_mlp1&#45;&gt;layer12_gpu5_expert_act -->
<g id="edge1301" class="edge">
<title>layer12_gpu5_expert_mlp1&#45;&gt;layer12_gpu5_expert_act</title>
<path fill="none" stroke="black" d="M4042.4,-6514.22C4041.77,-6506.11 4041.08,-6497.31 4040.41,-6488.8"/>
<polygon fill="black" stroke="black" points="4043.88,-6488.33 4039.61,-6478.63 4036.9,-6488.87 4043.88,-6488.33"/>
</g>
<!-- layer12_gpu5_expert_mlp2 -->
<g id="node1118" class="node">
<title>layer12_gpu5_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4233.5,-6374.33 3826.5,-6374.33 3826.5,-6306.33 4233.5,-6306.33 4233.5,-6374.33"/>
<text text-anchor="middle" x="4030" y="-6359.13" font-family="Times,serif" font-size="14.00">Expert 5 MLP2</text>
<text text-anchor="middle" x="4030" y="-6344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4030" y="-6329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4030" y="-6314.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer12_gpu5_expert_act&#45;&gt;layer12_gpu5_expert_mlp2 -->
<g id="edge1302" class="edge">
<title>layer12_gpu5_expert_act&#45;&gt;layer12_gpu5_expert_mlp2</title>
<path fill="none" stroke="black" d="M4034.73,-6410.22C4034.17,-6402.11 4033.57,-6393.31 4032.98,-6384.8"/>
<polygon fill="black" stroke="black" points="4036.46,-6384.37 4032.29,-6374.63 4029.48,-6384.85 4036.46,-6384.37"/>
</g>
<!-- layer12_gpu5_token_send -->
<g id="node1119" class="node">
<title>layer12_gpu5_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4017" cy="-6222.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4017" y="-6241.05" font-family="Times,serif" font-size="14.00">Token Send GPU5</text>
<text text-anchor="middle" x="4017" y="-6226.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4017" y="-6211.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4017" y="-6196.05" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer12_gpu5_expert_mlp2&#45;&gt;layer12_gpu5_token_send -->
<g id="edge1303" class="edge">
<title>layer12_gpu5_expert_mlp2&#45;&gt;layer12_gpu5_token_send</title>
<path fill="none" stroke="black" d="M4026.27,-6306.07C4025.38,-6298.07 4024.4,-6289.31 4023.42,-6280.56"/>
<polygon fill="black" stroke="black" points="4026.87,-6279.91 4022.28,-6270.36 4019.91,-6280.69 4026.87,-6279.91"/>
</g>
<!-- layer12_gpu5_token_send&#45;&gt;layer12_expert_agg -->
<g id="edge1304" class="edge">
<title>layer12_gpu5_token_send&#45;&gt;layer12_expert_agg</title>
<path fill="none" stroke="black" d="M4266.02,-6187.87C4304.5,-6183.05 4343.8,-6178.32 4381,-6174.17 4637.04,-6145.57 4927.36,-6118.51 5144.71,-6099.3"/>
<polygon fill="black" stroke="black" points="5145.02,-6102.79 5154.68,-6098.42 5144.41,-6095.82 5145.02,-6102.79"/>
</g>
<!-- layer12_gpu6_expert_mlp1 -->
<g id="node1121" class="node">
<title>layer12_gpu6_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4993.5,-6582.33 4532.5,-6582.33 4532.5,-6514.33 4993.5,-6514.33 4993.5,-6582.33"/>
<text text-anchor="middle" x="4763" y="-6567.13" font-family="Times,serif" font-size="14.00">Expert 6 MLP1</text>
<text text-anchor="middle" x="4763" y="-6552.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4763" y="-6537.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4763" y="-6522.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer12_gpu6_token_recv&#45;&gt;layer12_gpu6_expert_mlp1 -->
<g id="edge1306" class="edge">
<title>layer12_gpu6_token_recv&#45;&gt;layer12_gpu6_expert_mlp1</title>
<path fill="none" stroke="black" d="M4772.49,-6618.2C4771.32,-6609.72 4770.11,-6600.92 4768.96,-6592.56"/>
<polygon fill="black" stroke="black" points="4772.42,-6592.06 4767.59,-6582.64 4765.49,-6593.02 4772.42,-6592.06"/>
</g>
<!-- layer12_gpu6_expert_act -->
<g id="node1122" class="node">
<title>layer12_gpu6_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4943.5,-6478.33 4566.5,-6478.33 4566.5,-6410.33 4943.5,-6410.33 4943.5,-6478.33"/>
<text text-anchor="middle" x="4755" y="-6463.13" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="4755" y="-6448.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4755" y="-6433.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4755" y="-6418.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer12_gpu6_expert_mlp1&#45;&gt;layer12_gpu6_expert_act -->
<g id="edge1307" class="edge">
<title>layer12_gpu6_expert_mlp1&#45;&gt;layer12_gpu6_expert_act</title>
<path fill="none" stroke="black" d="M4760.4,-6514.22C4759.77,-6506.11 4759.08,-6497.31 4758.41,-6488.8"/>
<polygon fill="black" stroke="black" points="4761.88,-6488.33 4757.61,-6478.63 4754.9,-6488.87 4761.88,-6488.33"/>
</g>
<!-- layer12_gpu6_expert_mlp2 -->
<g id="node1123" class="node">
<title>layer12_gpu6_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4954.5,-6374.33 4547.5,-6374.33 4547.5,-6306.33 4954.5,-6306.33 4954.5,-6374.33"/>
<text text-anchor="middle" x="4751" y="-6359.13" font-family="Times,serif" font-size="14.00">Expert 6 MLP2</text>
<text text-anchor="middle" x="4751" y="-6344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4751" y="-6329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4751" y="-6314.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer12_gpu6_expert_act&#45;&gt;layer12_gpu6_expert_mlp2 -->
<g id="edge1308" class="edge">
<title>layer12_gpu6_expert_act&#45;&gt;layer12_gpu6_expert_mlp2</title>
<path fill="none" stroke="black" d="M4753.7,-6410.22C4753.38,-6402.11 4753.04,-6393.31 4752.7,-6384.8"/>
<polygon fill="black" stroke="black" points="4756.2,-6384.49 4752.31,-6374.63 4749.2,-6384.76 4756.2,-6384.49"/>
</g>
<!-- layer12_gpu6_token_send -->
<g id="node1124" class="node">
<title>layer12_gpu6_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4746" cy="-6222.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4746" y="-6241.05" font-family="Times,serif" font-size="14.00">Token Send GPU6</text>
<text text-anchor="middle" x="4746" y="-6226.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4746" y="-6211.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4746" y="-6196.05" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer12_gpu6_expert_mlp2&#45;&gt;layer12_gpu6_token_send -->
<g id="edge1309" class="edge">
<title>layer12_gpu6_expert_mlp2&#45;&gt;layer12_gpu6_token_send</title>
<path fill="none" stroke="black" d="M4749.57,-6306.07C4749.22,-6298.07 4748.85,-6289.31 4748.47,-6280.56"/>
<polygon fill="black" stroke="black" points="4751.96,-6280.2 4748.03,-6270.36 4744.96,-6280.5 4751.96,-6280.2"/>
</g>
<!-- layer12_gpu6_token_send&#45;&gt;layer12_expert_agg -->
<g id="edge1310" class="edge">
<title>layer12_gpu6_token_send&#45;&gt;layer12_expert_agg</title>
<path fill="none" stroke="black" d="M4938.28,-6181.72C5014.06,-6166.14 5102.75,-6147.9 5186,-6130.79"/>
<polygon fill="black" stroke="black" points="5186.77,-6134.2 5195.86,-6128.76 5185.36,-6127.35 5186.77,-6134.2"/>
</g>
<!-- layer12_gpu7_expert_mlp1 -->
<g id="node1126" class="node">
<title>layer12_gpu7_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5706.5,-6582.33 5245.5,-6582.33 5245.5,-6514.33 5706.5,-6514.33 5706.5,-6582.33"/>
<text text-anchor="middle" x="5476" y="-6567.13" font-family="Times,serif" font-size="14.00">Expert 7 MLP1</text>
<text text-anchor="middle" x="5476" y="-6552.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5476" y="-6537.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5476" y="-6522.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer12_gpu7_token_recv&#45;&gt;layer12_gpu7_expert_mlp1 -->
<g id="edge1312" class="edge">
<title>layer12_gpu7_token_recv&#45;&gt;layer12_gpu7_expert_mlp1</title>
<path fill="none" stroke="black" d="M5476,-6618.2C5476,-6609.81 5476,-6601.12 5476,-6592.84"/>
<polygon fill="black" stroke="black" points="5479.5,-6592.64 5476,-6582.64 5472.5,-6592.64 5479.5,-6592.64"/>
</g>
<!-- layer12_gpu7_expert_act -->
<g id="node1127" class="node">
<title>layer12_gpu7_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="5663.5,-6478.33 5286.5,-6478.33 5286.5,-6410.33 5663.5,-6410.33 5663.5,-6478.33"/>
<text text-anchor="middle" x="5475" y="-6463.13" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="5475" y="-6448.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-6433.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-6418.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer12_gpu7_expert_mlp1&#45;&gt;layer12_gpu7_expert_act -->
<g id="edge1313" class="edge">
<title>layer12_gpu7_expert_mlp1&#45;&gt;layer12_gpu7_expert_act</title>
<path fill="none" stroke="black" d="M5475.68,-6514.22C5475.6,-6506.11 5475.51,-6497.31 5475.43,-6488.8"/>
<polygon fill="black" stroke="black" points="5478.92,-6488.6 5475.33,-6478.63 5471.92,-6488.67 5478.92,-6488.6"/>
</g>
<!-- layer12_gpu7_expert_mlp2 -->
<g id="node1128" class="node">
<title>layer12_gpu7_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="5678.5,-6374.33 5271.5,-6374.33 5271.5,-6306.33 5678.5,-6306.33 5678.5,-6374.33"/>
<text text-anchor="middle" x="5475" y="-6359.13" font-family="Times,serif" font-size="14.00">Expert 7 MLP2</text>
<text text-anchor="middle" x="5475" y="-6344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-6329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5475" y="-6314.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer12_gpu7_expert_act&#45;&gt;layer12_gpu7_expert_mlp2 -->
<g id="edge1314" class="edge">
<title>layer12_gpu7_expert_act&#45;&gt;layer12_gpu7_expert_mlp2</title>
<path fill="none" stroke="black" d="M5475,-6410.22C5475,-6402.11 5475,-6393.31 5475,-6384.8"/>
<polygon fill="black" stroke="black" points="5478.5,-6384.63 5475,-6374.63 5471.5,-6384.63 5478.5,-6384.63"/>
</g>
<!-- layer12_gpu7_token_send -->
<g id="node1129" class="node">
<title>layer12_gpu7_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="5475" cy="-6222.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="5475" y="-6241.05" font-family="Times,serif" font-size="14.00">Token Send GPU7</text>
<text text-anchor="middle" x="5475" y="-6226.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="5475" y="-6211.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="5475" y="-6196.05" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer12_gpu7_expert_mlp2&#45;&gt;layer12_gpu7_token_send -->
<g id="edge1315" class="edge">
<title>layer12_gpu7_expert_mlp2&#45;&gt;layer12_gpu7_token_send</title>
<path fill="none" stroke="black" d="M5475,-6306.07C5475,-6298.07 5475,-6289.31 5475,-6280.56"/>
<polygon fill="black" stroke="black" points="5478.5,-6280.36 5475,-6270.36 5471.5,-6280.36 5478.5,-6280.36"/>
</g>
<!-- layer12_gpu7_token_send&#45;&gt;layer12_expert_agg -->
<g id="edge1316" class="edge">
<title>layer12_gpu7_token_send&#45;&gt;layer12_expert_agg</title>
<path fill="none" stroke="black" d="M5475.32,-6173.76C5475.37,-6165.68 5475.43,-6157.09 5475.48,-6148.47"/>
<polygon fill="black" stroke="black" points="5478.99,-6148.38 5475.55,-6138.36 5471.99,-6148.34 5478.99,-6148.38"/>
</g>
<!-- layer12_gpu8_expert_mlp1 -->
<g id="node1131" class="node">
<title>layer12_gpu8_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="6417.5,-6582.33 5956.5,-6582.33 5956.5,-6514.33 6417.5,-6514.33 6417.5,-6582.33"/>
<text text-anchor="middle" x="6187" y="-6567.13" font-family="Times,serif" font-size="14.00">Expert 8 MLP1</text>
<text text-anchor="middle" x="6187" y="-6552.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6187" y="-6537.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6187" y="-6522.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer12_gpu8_token_recv&#45;&gt;layer12_gpu8_expert_mlp1 -->
<g id="edge1318" class="edge">
<title>layer12_gpu8_token_recv&#45;&gt;layer12_gpu8_expert_mlp1</title>
<path fill="none" stroke="black" d="M6185.22,-6618.2C6185.44,-6609.81 6185.66,-6601.12 6185.88,-6592.84"/>
<polygon fill="black" stroke="black" points="6189.38,-6592.72 6186.14,-6582.64 6182.38,-6592.54 6189.38,-6592.72"/>
</g>
<!-- layer12_gpu8_expert_act -->
<g id="node1132" class="node">
<title>layer12_gpu8_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="6380.5,-6478.33 6003.5,-6478.33 6003.5,-6410.33 6380.5,-6410.33 6380.5,-6478.33"/>
<text text-anchor="middle" x="6192" y="-6463.13" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="6192" y="-6448.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6192" y="-6433.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6192" y="-6418.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer12_gpu8_expert_mlp1&#45;&gt;layer12_gpu8_expert_act -->
<g id="edge1319" class="edge">
<title>layer12_gpu8_expert_mlp1&#45;&gt;layer12_gpu8_expert_act</title>
<path fill="none" stroke="black" d="M6188.62,-6514.22C6189.02,-6506.11 6189.45,-6497.31 6189.87,-6488.8"/>
<polygon fill="black" stroke="black" points="6193.37,-6488.79 6190.37,-6478.63 6186.38,-6488.45 6193.37,-6488.79"/>
</g>
<!-- layer12_gpu8_expert_mlp2 -->
<g id="node1133" class="node">
<title>layer12_gpu8_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="6405.5,-6374.33 5998.5,-6374.33 5998.5,-6306.33 6405.5,-6306.33 6405.5,-6374.33"/>
<text text-anchor="middle" x="6202" y="-6359.13" font-family="Times,serif" font-size="14.00">Expert 8 MLP2</text>
<text text-anchor="middle" x="6202" y="-6344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6202" y="-6329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6202" y="-6314.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer12_gpu8_expert_act&#45;&gt;layer12_gpu8_expert_mlp2 -->
<g id="edge1320" class="edge">
<title>layer12_gpu8_expert_act&#45;&gt;layer12_gpu8_expert_mlp2</title>
<path fill="none" stroke="black" d="M6195.25,-6410.22C6196.04,-6402.11 6196.9,-6393.31 6197.74,-6384.8"/>
<polygon fill="black" stroke="black" points="6201.24,-6384.93 6198.74,-6374.63 6194.28,-6384.24 6201.24,-6384.93"/>
</g>
<!-- layer12_gpu8_token_send -->
<g id="node1134" class="node">
<title>layer12_gpu8_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6204" cy="-6222.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6204" y="-6241.05" font-family="Times,serif" font-size="14.00">Token Send GPU8</text>
<text text-anchor="middle" x="6204" y="-6226.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6204" y="-6211.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6204" y="-6196.05" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer12_gpu8_expert_mlp2&#45;&gt;layer12_gpu8_token_send -->
<g id="edge1321" class="edge">
<title>layer12_gpu8_expert_mlp2&#45;&gt;layer12_gpu8_token_send</title>
<path fill="none" stroke="black" d="M6202.57,-6306.07C6202.71,-6298.07 6202.86,-6289.31 6203.01,-6280.56"/>
<polygon fill="black" stroke="black" points="6206.52,-6280.42 6203.19,-6270.36 6199.52,-6280.3 6206.52,-6280.42"/>
</g>
<!-- layer12_gpu8_token_send&#45;&gt;layer12_expert_agg -->
<g id="edge1322" class="edge">
<title>layer12_gpu8_token_send&#45;&gt;layer12_expert_agg</title>
<path fill="none" stroke="black" d="M6012.25,-6181.72C5950.52,-6168.99 5880.19,-6154.49 5811.25,-6140.28"/>
<polygon fill="black" stroke="black" points="5811.59,-6136.78 5801.09,-6138.19 5810.18,-6143.63 5811.59,-6136.78"/>
</g>
<!-- layer12_gpu9_expert_mlp1 -->
<g id="node1136" class="node">
<title>layer12_gpu9_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7114.5,-6582.33 6653.5,-6582.33 6653.5,-6514.33 7114.5,-6514.33 7114.5,-6582.33"/>
<text text-anchor="middle" x="6884" y="-6567.13" font-family="Times,serif" font-size="14.00">Expert 9 MLP1</text>
<text text-anchor="middle" x="6884" y="-6552.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6884" y="-6537.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6884" y="-6522.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer12_gpu9_token_recv&#45;&gt;layer12_gpu9_expert_mlp1 -->
<g id="edge1324" class="edge">
<title>layer12_gpu9_token_recv&#45;&gt;layer12_gpu9_expert_mlp1</title>
<path fill="none" stroke="black" d="M6882.22,-6618.2C6882.44,-6609.81 6882.66,-6601.12 6882.88,-6592.84"/>
<polygon fill="black" stroke="black" points="6886.38,-6592.72 6883.14,-6582.64 6879.38,-6592.54 6886.38,-6592.72"/>
</g>
<!-- layer12_gpu9_expert_act -->
<g id="node1137" class="node">
<title>layer12_gpu9_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7074.5,-6478.33 6697.5,-6478.33 6697.5,-6410.33 7074.5,-6410.33 7074.5,-6478.33"/>
<text text-anchor="middle" x="6886" y="-6463.13" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="6886" y="-6448.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6886" y="-6433.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6886" y="-6418.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer12_gpu9_expert_mlp1&#45;&gt;layer12_gpu9_expert_act -->
<g id="edge1325" class="edge">
<title>layer12_gpu9_expert_mlp1&#45;&gt;layer12_gpu9_expert_act</title>
<path fill="none" stroke="black" d="M6884.65,-6514.22C6884.81,-6506.11 6884.98,-6497.31 6885.15,-6488.8"/>
<polygon fill="black" stroke="black" points="6888.65,-6488.7 6885.35,-6478.63 6881.65,-6488.56 6888.65,-6488.7"/>
</g>
<!-- layer12_gpu9_expert_mlp2 -->
<g id="node1138" class="node">
<title>layer12_gpu9_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7131.5,-6374.33 6724.5,-6374.33 6724.5,-6306.33 7131.5,-6306.33 7131.5,-6374.33"/>
<text text-anchor="middle" x="6928" y="-6359.13" font-family="Times,serif" font-size="14.00">Expert 9 MLP2</text>
<text text-anchor="middle" x="6928" y="-6344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6928" y="-6329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6928" y="-6314.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer12_gpu9_expert_act&#45;&gt;layer12_gpu9_expert_mlp2 -->
<g id="edge1326" class="edge">
<title>layer12_gpu9_expert_act&#45;&gt;layer12_gpu9_expert_mlp2</title>
<path fill="none" stroke="black" d="M6899.64,-6410.22C6903.08,-6401.84 6906.83,-6392.73 6910.45,-6383.96"/>
<polygon fill="black" stroke="black" points="6913.72,-6385.21 6914.29,-6374.63 6907.24,-6382.55 6913.72,-6385.21"/>
</g>
<!-- layer12_gpu9_token_send -->
<g id="node1139" class="node">
<title>layer12_gpu9_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6933" cy="-6222.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6933" y="-6241.05" font-family="Times,serif" font-size="14.00">Token Send GPU9</text>
<text text-anchor="middle" x="6933" y="-6226.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6933" y="-6211.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6933" y="-6196.05" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer12_gpu9_expert_mlp2&#45;&gt;layer12_gpu9_token_send -->
<g id="edge1327" class="edge">
<title>layer12_gpu9_expert_mlp2&#45;&gt;layer12_gpu9_token_send</title>
<path fill="none" stroke="black" d="M6929.43,-6306.07C6929.78,-6298.07 6930.15,-6289.31 6930.53,-6280.56"/>
<polygon fill="black" stroke="black" points="6934.04,-6280.5 6930.97,-6270.36 6927.04,-6280.2 6934.04,-6280.5"/>
</g>
<!-- layer12_gpu9_token_send&#45;&gt;layer12_expert_agg -->
<g id="edge1328" class="edge">
<title>layer12_gpu9_token_send&#45;&gt;layer12_expert_agg</title>
<path fill="none" stroke="black" d="M6683.98,-6187.87C6645.5,-6183.05 6606.2,-6178.32 6569,-6174.17 6346.64,-6149.32 6098.38,-6125.6 5894.73,-6107.2"/>
<polygon fill="black" stroke="black" points="5895.04,-6103.71 5884.76,-6106.3 5894.41,-6110.68 5895.04,-6103.71"/>
</g>
<!-- layer12_gpu10_expert_mlp1 -->
<g id="node1141" class="node">
<title>layer12_gpu10_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7833.5,-6582.33 7372.5,-6582.33 7372.5,-6514.33 7833.5,-6514.33 7833.5,-6582.33"/>
<text text-anchor="middle" x="7603" y="-6567.13" font-family="Times,serif" font-size="14.00">Expert 10 MLP1</text>
<text text-anchor="middle" x="7603" y="-6552.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7603" y="-6537.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7603" y="-6522.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer12_gpu10_token_recv&#45;&gt;layer12_gpu10_expert_mlp1 -->
<g id="edge1330" class="edge">
<title>layer12_gpu10_token_recv&#45;&gt;layer12_gpu10_expert_mlp1</title>
<path fill="none" stroke="black" d="M7598.25,-6618.2C7598.83,-6609.81 7599.43,-6601.12 7600,-6592.84"/>
<polygon fill="black" stroke="black" points="7603.51,-6592.85 7600.7,-6582.64 7596.53,-6592.37 7603.51,-6592.85"/>
</g>
<!-- layer12_gpu10_expert_act -->
<g id="node1142" class="node">
<title>layer12_gpu10_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7808.5,-6478.33 7431.5,-6478.33 7431.5,-6410.33 7808.5,-6410.33 7808.5,-6478.33"/>
<text text-anchor="middle" x="7620" y="-6463.13" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="7620" y="-6448.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7620" y="-6433.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7620" y="-6418.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer12_gpu10_expert_mlp1&#45;&gt;layer12_gpu10_expert_act -->
<g id="edge1331" class="edge">
<title>layer12_gpu10_expert_mlp1&#45;&gt;layer12_gpu10_expert_act</title>
<path fill="none" stroke="black" d="M7608.52,-6514.22C7609.89,-6506.02 7611.37,-6497.12 7612.8,-6488.52"/>
<polygon fill="black" stroke="black" points="7616.26,-6489.07 7614.45,-6478.63 7609.35,-6487.92 7616.26,-6489.07"/>
</g>
<!-- layer12_gpu10_expert_mlp2 -->
<g id="node1143" class="node">
<title>layer12_gpu10_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7831.5,-6374.33 7424.5,-6374.33 7424.5,-6306.33 7831.5,-6306.33 7831.5,-6374.33"/>
<text text-anchor="middle" x="7628" y="-6359.13" font-family="Times,serif" font-size="14.00">Expert 10 MLP2</text>
<text text-anchor="middle" x="7628" y="-6344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7628" y="-6329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="7628" y="-6314.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer12_gpu10_expert_act&#45;&gt;layer12_gpu10_expert_mlp2 -->
<g id="edge1332" class="edge">
<title>layer12_gpu10_expert_act&#45;&gt;layer12_gpu10_expert_mlp2</title>
<path fill="none" stroke="black" d="M7622.6,-6410.22C7623.23,-6402.11 7623.92,-6393.31 7624.59,-6384.8"/>
<polygon fill="black" stroke="black" points="7628.1,-6384.87 7625.39,-6374.63 7621.12,-6384.33 7628.1,-6384.87"/>
</g>
<!-- layer12_gpu10_token_send -->
<g id="node1144" class="node">
<title>layer12_gpu10_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="7662" cy="-6222.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="7662" y="-6241.05" font-family="Times,serif" font-size="14.00">Token Send GPU10</text>
<text text-anchor="middle" x="7662" y="-6226.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="7662" y="-6211.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="7662" y="-6196.05" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer12_gpu10_expert_mlp2&#45;&gt;layer12_gpu10_token_send -->
<g id="edge1333" class="edge">
<title>layer12_gpu10_expert_mlp2&#45;&gt;layer12_gpu10_token_send</title>
<path fill="none" stroke="black" d="M7637.74,-6306.07C7640.14,-6297.9 7642.76,-6288.93 7645.38,-6279.99"/>
<polygon fill="black" stroke="black" points="7648.75,-6280.94 7648.2,-6270.36 7642.03,-6278.97 7648.75,-6280.94"/>
</g>
<!-- layer12_gpu10_token_send&#45;&gt;layer12_expert_agg -->
<g id="edge1334" class="edge">
<title>layer12_gpu10_token_send&#45;&gt;layer12_expert_agg</title>
<path fill="none" stroke="black" d="M7418.01,-6187.22C7377.96,-6182.35 7336.86,-6177.77 7298,-6174.17 6805.04,-6128.41 6235.03,-6100.14 5865.7,-6085.05"/>
<polygon fill="black" stroke="black" points="5865.78,-6081.55 5855.65,-6084.64 5865.5,-6088.55 5865.78,-6081.55"/>
</g>
<!-- layer12_gpu11_expert_mlp1 -->
<g id="node1146" class="node">
<title>layer12_gpu11_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="8537.5,-6582.33 8076.5,-6582.33 8076.5,-6514.33 8537.5,-6514.33 8537.5,-6582.33"/>
<text text-anchor="middle" x="8307" y="-6567.13" font-family="Times,serif" font-size="14.00">Expert 11 MLP1</text>
<text text-anchor="middle" x="8307" y="-6552.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8307" y="-6537.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8307" y="-6522.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer12_gpu11_token_recv&#45;&gt;layer12_gpu11_expert_mlp1 -->
<g id="edge1336" class="edge">
<title>layer12_gpu11_token_recv&#45;&gt;layer12_gpu11_expert_mlp1</title>
<path fill="none" stroke="black" d="M8300.47,-6618.2C8301.27,-6609.81 8302.09,-6601.12 8302.88,-6592.84"/>
<polygon fill="black" stroke="black" points="8306.39,-6592.92 8303.84,-6582.64 8299.42,-6592.26 8306.39,-6592.92"/>
</g>
<!-- layer12_gpu11_expert_act -->
<g id="node1147" class="node">
<title>layer12_gpu11_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="8519.5,-6478.33 8142.5,-6478.33 8142.5,-6410.33 8519.5,-6410.33 8519.5,-6478.33"/>
<text text-anchor="middle" x="8331" y="-6463.13" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="8331" y="-6448.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8331" y="-6433.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8331" y="-6418.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer12_gpu11_expert_mlp1&#45;&gt;layer12_gpu11_expert_act -->
<g id="edge1337" class="edge">
<title>layer12_gpu11_expert_mlp1&#45;&gt;layer12_gpu11_expert_act</title>
<path fill="none" stroke="black" d="M8314.79,-6514.22C8316.72,-6506.02 8318.81,-6497.12 8320.84,-6488.52"/>
<polygon fill="black" stroke="black" points="8324.28,-6489.17 8323.16,-6478.63 8317.47,-6487.56 8324.28,-6489.17"/>
</g>
<!-- layer12_gpu11_expert_mlp2 -->
<g id="node1148" class="node">
<title>layer12_gpu11_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="8546.5,-6374.33 8139.5,-6374.33 8139.5,-6306.33 8546.5,-6306.33 8546.5,-6374.33"/>
<text text-anchor="middle" x="8343" y="-6359.13" font-family="Times,serif" font-size="14.00">Expert 11 MLP2</text>
<text text-anchor="middle" x="8343" y="-6344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8343" y="-6329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="8343" y="-6314.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer12_gpu11_expert_act&#45;&gt;layer12_gpu11_expert_mlp2 -->
<g id="edge1338" class="edge">
<title>layer12_gpu11_expert_act&#45;&gt;layer12_gpu11_expert_mlp2</title>
<path fill="none" stroke="black" d="M8334.9,-6410.22C8335.85,-6402.11 8336.88,-6393.31 8337.89,-6384.8"/>
<polygon fill="black" stroke="black" points="8341.39,-6384.97 8339.08,-6374.63 8334.44,-6384.15 8341.39,-6384.97"/>
</g>
<!-- layer12_gpu11_token_send -->
<g id="node1149" class="node">
<title>layer12_gpu11_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="8391" cy="-6222.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="8391" y="-6241.05" font-family="Times,serif" font-size="14.00">Token Send GPU11</text>
<text text-anchor="middle" x="8391" y="-6226.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="8391" y="-6211.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="8391" y="-6196.05" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer12_gpu11_expert_mlp2&#45;&gt;layer12_gpu11_token_send -->
<g id="edge1339" class="edge">
<title>layer12_gpu11_expert_mlp2&#45;&gt;layer12_gpu11_token_send</title>
<path fill="none" stroke="black" d="M8356.75,-6306.07C8360.17,-6297.81 8363.92,-6288.74 8367.65,-6279.71"/>
<polygon fill="black" stroke="black" points="8370.93,-6280.94 8371.52,-6270.36 8364.46,-6278.26 8370.93,-6280.94"/>
</g>
<!-- layer12_gpu11_token_send&#45;&gt;layer12_expert_agg -->
<g id="edge1340" class="edge">
<title>layer12_gpu11_token_send&#45;&gt;layer12_expert_agg</title>
<path fill="none" stroke="black" d="M8149.02,-6186.92C8108.35,-6182.02 8066.52,-6177.51 8027,-6174.17 7256.77,-6108.93 6352.11,-6084.78 5853.6,-6076.01"/>
<polygon fill="black" stroke="black" points="5853.43,-6072.5 5843.37,-6075.83 5853.31,-6079.5 5853.43,-6072.5"/>
</g>
<!-- layer12_gpu12_expert_mlp1 -->
<g id="node1151" class="node">
<title>layer12_gpu12_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9236.5,-6582.33 8775.5,-6582.33 8775.5,-6514.33 9236.5,-6514.33 9236.5,-6582.33"/>
<text text-anchor="middle" x="9006" y="-6567.13" font-family="Times,serif" font-size="14.00">Expert 12 MLP1</text>
<text text-anchor="middle" x="9006" y="-6552.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9006" y="-6537.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9006" y="-6522.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_gpu12_token_recv&#45;&gt;layer12_gpu12_expert_mlp1 -->
<g id="edge1342" class="edge">
<title>layer12_gpu12_token_recv&#45;&gt;layer12_gpu12_expert_mlp1</title>
<path fill="none" stroke="black" d="M8996.51,-6618.2C8997.68,-6609.72 8998.89,-6600.92 9000.04,-6592.56"/>
<polygon fill="black" stroke="black" points="9003.51,-6593.02 9001.41,-6582.64 8996.58,-6592.06 9003.51,-6593.02"/>
</g>
<!-- layer12_gpu12_expert_act -->
<g id="node1152" class="node">
<title>layer12_gpu12_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9227.5,-6478.33 8850.5,-6478.33 8850.5,-6410.33 9227.5,-6410.33 9227.5,-6478.33"/>
<text text-anchor="middle" x="9039" y="-6463.13" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="9039" y="-6448.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9039" y="-6433.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9039" y="-6418.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_gpu12_expert_mlp1&#45;&gt;layer12_gpu12_expert_act -->
<g id="edge1343" class="edge">
<title>layer12_gpu12_expert_mlp1&#45;&gt;layer12_gpu12_expert_act</title>
<path fill="none" stroke="black" d="M9016.71,-6514.22C9019.39,-6505.93 9022.31,-6496.93 9025.12,-6488.24"/>
<polygon fill="black" stroke="black" points="9028.48,-6489.22 9028.23,-6478.63 9021.82,-6487.07 9028.48,-6489.22"/>
</g>
<!-- layer12_gpu12_expert_mlp2 -->
<g id="node1153" class="node">
<title>layer12_gpu12_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9258.5,-6374.33 8851.5,-6374.33 8851.5,-6306.33 9258.5,-6306.33 9258.5,-6374.33"/>
<text text-anchor="middle" x="9055" y="-6359.13" font-family="Times,serif" font-size="14.00">Expert 12 MLP2</text>
<text text-anchor="middle" x="9055" y="-6344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9055" y="-6329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9055" y="-6314.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_gpu12_expert_act&#45;&gt;layer12_gpu12_expert_mlp2 -->
<g id="edge1344" class="edge">
<title>layer12_gpu12_expert_act&#45;&gt;layer12_gpu12_expert_mlp2</title>
<path fill="none" stroke="black" d="M9044.19,-6410.22C9045.48,-6402.02 9046.88,-6393.12 9048.22,-6384.52"/>
<polygon fill="black" stroke="black" points="9051.68,-6385.05 9049.78,-6374.63 9044.77,-6383.97 9051.68,-6385.05"/>
</g>
<!-- layer12_gpu12_token_send -->
<g id="node1154" class="node">
<title>layer12_gpu12_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9120" cy="-6222.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9120" y="-6241.05" font-family="Times,serif" font-size="14.00">Token Send GPU12</text>
<text text-anchor="middle" x="9120" y="-6226.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9120" y="-6211.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9120" y="-6196.05" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_gpu12_expert_mlp2&#45;&gt;layer12_gpu12_token_send -->
<g id="edge1345" class="edge">
<title>layer12_gpu12_expert_mlp2&#45;&gt;layer12_gpu12_token_send</title>
<path fill="none" stroke="black" d="M9073.63,-6306.07C9078.35,-6297.64 9083.55,-6288.35 9088.7,-6279.14"/>
<polygon fill="black" stroke="black" points="9091.79,-6280.79 9093.62,-6270.36 9085.68,-6277.37 9091.79,-6280.79"/>
</g>
<!-- layer12_gpu12_token_send&#45;&gt;layer12_expert_agg -->
<g id="edge1346" class="edge">
<title>layer12_gpu12_token_send&#45;&gt;layer12_expert_agg</title>
<path fill="none" stroke="black" d="M8879.52,-6186.79C8838.38,-6181.86 8796.02,-6177.37 8756,-6174.17 7703.52,-6089.77 6455.89,-6073.59 5847.26,-6071.09"/>
<polygon fill="black" stroke="black" points="5847.03,-6067.58 5837.01,-6071.04 5847,-6074.58 5847.03,-6067.58"/>
</g>
<!-- layer12_gpu13_expert_mlp1 -->
<g id="node1156" class="node">
<title>layer12_gpu13_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9931.5,-6582.33 9470.5,-6582.33 9470.5,-6514.33 9931.5,-6514.33 9931.5,-6582.33"/>
<text text-anchor="middle" x="9701" y="-6567.13" font-family="Times,serif" font-size="14.00">Expert 13 MLP1</text>
<text text-anchor="middle" x="9701" y="-6552.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9701" y="-6537.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9701" y="-6522.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer12_gpu13_token_recv&#45;&gt;layer12_gpu13_expert_mlp1 -->
<g id="edge1348" class="edge">
<title>layer12_gpu13_token_recv&#45;&gt;layer12_gpu13_expert_mlp1</title>
<path fill="none" stroke="black" d="M9688.54,-6618.2C9690.08,-6609.72 9691.67,-6600.92 9693.18,-6592.56"/>
<polygon fill="black" stroke="black" points="9696.64,-6593.1 9694.98,-6582.64 9689.75,-6591.85 9696.64,-6593.1"/>
</g>
<!-- layer12_gpu13_expert_act -->
<g id="node1157" class="node">
<title>layer12_gpu13_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9931.5,-6478.33 9554.5,-6478.33 9554.5,-6410.33 9931.5,-6410.33 9931.5,-6478.33"/>
<text text-anchor="middle" x="9743" y="-6463.13" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="9743" y="-6448.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9743" y="-6433.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9743" y="-6418.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer12_gpu13_expert_mlp1&#45;&gt;layer12_gpu13_expert_act -->
<g id="edge1349" class="edge">
<title>layer12_gpu13_expert_mlp1&#45;&gt;layer12_gpu13_expert_act</title>
<path fill="none" stroke="black" d="M9714.64,-6514.22C9718.08,-6505.84 9721.83,-6496.73 9725.45,-6487.96"/>
<polygon fill="black" stroke="black" points="9728.72,-6489.21 9729.29,-6478.63 9722.24,-6486.55 9728.72,-6489.21"/>
</g>
<!-- layer12_gpu13_expert_mlp2 -->
<g id="node1158" class="node">
<title>layer12_gpu13_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10031.5,-6374.33 9624.5,-6374.33 9624.5,-6306.33 10031.5,-6306.33 10031.5,-6374.33"/>
<text text-anchor="middle" x="9828" y="-6359.13" font-family="Times,serif" font-size="14.00">Expert 13 MLP2</text>
<text text-anchor="middle" x="9828" y="-6344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9828" y="-6329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9828" y="-6314.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer12_gpu13_expert_act&#45;&gt;layer12_gpu13_expert_mlp2 -->
<g id="edge1350" class="edge">
<title>layer12_gpu13_expert_act&#45;&gt;layer12_gpu13_expert_mlp2</title>
<path fill="none" stroke="black" d="M9770.6,-6410.22C9777.95,-6401.4 9785.97,-6391.76 9793.64,-6382.57"/>
<polygon fill="black" stroke="black" points="9796.54,-6384.55 9800.25,-6374.63 9791.16,-6380.07 9796.54,-6384.55"/>
</g>
<!-- layer12_gpu13_token_send -->
<g id="node1159" class="node">
<title>layer12_gpu13_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9849" cy="-6222.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9849" y="-6241.05" font-family="Times,serif" font-size="14.00">Token Send GPU13</text>
<text text-anchor="middle" x="9849" y="-6226.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9849" y="-6211.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9849" y="-6196.05" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer12_gpu13_expert_mlp2&#45;&gt;layer12_gpu13_token_send -->
<g id="edge1351" class="edge">
<title>layer12_gpu13_expert_mlp2&#45;&gt;layer12_gpu13_token_send</title>
<path fill="none" stroke="black" d="M9834.02,-6306.07C9835.48,-6297.99 9837.08,-6289.12 9838.68,-6280.28"/>
<polygon fill="black" stroke="black" points="9842.14,-6280.82 9840.48,-6270.36 9835.25,-6279.58 9842.14,-6280.82"/>
</g>
<!-- layer12_gpu13_token_send&#45;&gt;layer12_expert_agg -->
<g id="edge1352" class="edge">
<title>layer12_gpu13_token_send&#45;&gt;layer12_expert_agg</title>
<path fill="none" stroke="black" d="M9609.02,-6186.65C9567.73,-6181.72 9525.18,-6177.27 9485,-6174.17 8786.96,-6120.2 6711.38,-6087.45 5853.52,-6075.9"/>
<polygon fill="black" stroke="black" points="5853.53,-6072.4 5843.48,-6075.76 5853.43,-6079.4 5853.53,-6072.4"/>
</g>
<!-- layer12_gpu14_expert_mlp1 -->
<g id="node1161" class="node">
<title>layer12_gpu14_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="10730.5,-6582.33 10269.5,-6582.33 10269.5,-6514.33 10730.5,-6514.33 10730.5,-6582.33"/>
<text text-anchor="middle" x="10500" y="-6567.13" font-family="Times,serif" font-size="14.00">Expert 14 MLP1</text>
<text text-anchor="middle" x="10500" y="-6552.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10500" y="-6537.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10500" y="-6522.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer12_gpu14_token_recv&#45;&gt;layer12_gpu14_expert_mlp1 -->
<g id="edge1354" class="edge">
<title>layer12_gpu14_token_recv&#45;&gt;layer12_gpu14_expert_mlp1</title>
<path fill="none" stroke="black" d="M10421.53,-6618.87C10432.53,-6609.12 10444.03,-6598.93 10454.74,-6589.44"/>
<polygon fill="black" stroke="black" points="10457.21,-6591.93 10462.37,-6582.67 10452.57,-6586.69 10457.21,-6591.93"/>
</g>
<!-- layer12_gpu14_expert_act -->
<g id="node1162" class="node">
<title>layer12_gpu14_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="10701.5,-6478.33 10324.5,-6478.33 10324.5,-6410.33 10701.5,-6410.33 10701.5,-6478.33"/>
<text text-anchor="middle" x="10513" y="-6463.13" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="10513" y="-6448.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10513" y="-6433.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10513" y="-6418.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer12_gpu14_expert_mlp1&#45;&gt;layer12_gpu14_expert_act -->
<g id="edge1355" class="edge">
<title>layer12_gpu14_expert_mlp1&#45;&gt;layer12_gpu14_expert_act</title>
<path fill="none" stroke="black" d="M10504.22,-6514.22C10505.25,-6506.11 10506.37,-6497.31 10507.46,-6488.8"/>
<polygon fill="black" stroke="black" points="10510.96,-6488.99 10508.76,-6478.63 10504.02,-6488.11 10510.96,-6488.99"/>
</g>
<!-- layer12_gpu14_expert_mlp2 -->
<g id="node1163" class="node">
<title>layer12_gpu14_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10768.5,-6374.33 10361.5,-6374.33 10361.5,-6306.33 10768.5,-6306.33 10768.5,-6374.33"/>
<text text-anchor="middle" x="10565" y="-6359.13" font-family="Times,serif" font-size="14.00">Expert 14 MLP2</text>
<text text-anchor="middle" x="10565" y="-6344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10565" y="-6329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="10565" y="-6314.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer12_gpu14_expert_act&#45;&gt;layer12_gpu14_expert_mlp2 -->
<g id="edge1356" class="edge">
<title>layer12_gpu14_expert_act&#45;&gt;layer12_gpu14_expert_mlp2</title>
<path fill="none" stroke="black" d="M10529.88,-6410.22C10534.2,-6401.75 10538.89,-6392.54 10543.41,-6383.68"/>
<polygon fill="black" stroke="black" points="10546.6,-6385.13 10548.02,-6374.63 10540.36,-6381.95 10546.6,-6385.13"/>
</g>
<!-- layer12_gpu14_token_send -->
<g id="node1164" class="node">
<title>layer12_gpu14_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="10578" cy="-6222.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="10578" y="-6241.05" font-family="Times,serif" font-size="14.00">Token Send GPU14</text>
<text text-anchor="middle" x="10578" y="-6226.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="10578" y="-6211.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="10578" y="-6196.05" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer12_gpu14_expert_mlp2&#45;&gt;layer12_gpu14_token_send -->
<g id="edge1357" class="edge">
<title>layer12_gpu14_expert_mlp2&#45;&gt;layer12_gpu14_token_send</title>
<path fill="none" stroke="black" d="M10568.73,-6306.07C10569.62,-6298.07 10570.6,-6289.31 10571.58,-6280.56"/>
<polygon fill="black" stroke="black" points="10575.09,-6280.69 10572.72,-6270.36 10568.13,-6279.91 10575.09,-6280.69"/>
</g>
<!-- layer12_gpu14_token_send&#45;&gt;layer12_expert_agg -->
<g id="edge1358" class="edge">
<title>layer12_gpu14_token_send&#45;&gt;layer12_expert_agg</title>
<path fill="none" stroke="black" d="M10339.01,-6186.63C10297.41,-6181.67 10254.51,-6177.22 10214,-6174.17 9369,-6110.51 6816.27,-6082.61 5851.09,-6074.14"/>
<polygon fill="black" stroke="black" points="5850.9,-6070.63 5840.87,-6074.05 5850.84,-6077.63 5850.9,-6070.63"/>
</g>
<!-- layer12_gpu15_expert_mlp1 -->
<g id="node1166" class="node">
<title>layer12_gpu15_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="11313.5,-6582.33 10852.5,-6582.33 10852.5,-6514.33 11313.5,-6514.33 11313.5,-6582.33"/>
<text text-anchor="middle" x="11083" y="-6567.13" font-family="Times,serif" font-size="14.00">Expert 15 MLP1</text>
<text text-anchor="middle" x="11083" y="-6552.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="11083" y="-6537.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11083" y="-6522.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer12_gpu15_token_recv&#45;&gt;layer12_gpu15_expert_mlp1 -->
<g id="edge1360" class="edge">
<title>layer12_gpu15_token_recv&#45;&gt;layer12_gpu15_expert_mlp1</title>
<path fill="none" stroke="black" d="M11067.58,-6618.2C11069.47,-6609.72 11071.44,-6600.92 11073.32,-6592.56"/>
<polygon fill="black" stroke="black" points="11076.77,-6593.16 11075.54,-6582.64 11069.94,-6591.63 11076.77,-6593.16"/>
</g>
<!-- layer12_gpu15_expert_act -->
<g id="node1167" class="node">
<title>layer12_gpu15_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="11334.5,-6478.33 10957.5,-6478.33 10957.5,-6410.33 11334.5,-6410.33 11334.5,-6478.33"/>
<text text-anchor="middle" x="11146" y="-6463.13" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="11146" y="-6448.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11146" y="-6433.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11146" y="-6418.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer12_gpu15_expert_mlp1&#45;&gt;layer12_gpu15_expert_act -->
<g id="edge1361" class="edge">
<title>layer12_gpu15_expert_mlp1&#45;&gt;layer12_gpu15_expert_act</title>
<path fill="none" stroke="black" d="M11103.45,-6514.22C11108.74,-6505.66 11114.49,-6496.35 11120.01,-6487.4"/>
<polygon fill="black" stroke="black" points="11123.16,-6488.98 11125.43,-6478.63 11117.2,-6485.3 11123.16,-6488.98"/>
</g>
<!-- layer12_gpu15_expert_mlp2 -->
<g id="node1168" class="node">
<title>layer12_gpu15_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="11474.5,-6374.33 11067.5,-6374.33 11067.5,-6306.33 11474.5,-6306.33 11474.5,-6374.33"/>
<text text-anchor="middle" x="11271" y="-6359.13" font-family="Times,serif" font-size="14.00">Expert 15 MLP2</text>
<text text-anchor="middle" x="11271" y="-6344.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11271" y="-6329.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="11271" y="-6314.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer12_gpu15_expert_act&#45;&gt;layer12_gpu15_expert_mlp2 -->
<g id="edge1362" class="edge">
<title>layer12_gpu15_expert_act&#45;&gt;layer12_gpu15_expert_mlp2</title>
<path fill="none" stroke="black" d="M11186.58,-6410.22C11197.94,-6400.95 11210.39,-6390.79 11222.17,-6381.18"/>
<polygon fill="black" stroke="black" points="11224.66,-6383.67 11230.19,-6374.63 11220.23,-6378.24 11224.66,-6383.67"/>
</g>
<!-- layer12_gpu15_token_send -->
<g id="node1169" class="node">
<title>layer12_gpu15_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="11307" cy="-6222.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="11307" y="-6241.05" font-family="Times,serif" font-size="14.00">Token Send GPU15</text>
<text text-anchor="middle" x="11307" y="-6226.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="11307" y="-6211.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="11307" y="-6196.05" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer12_gpu15_expert_mlp2&#45;&gt;layer12_gpu15_token_send -->
<g id="edge1363" class="edge">
<title>layer12_gpu15_expert_mlp2&#45;&gt;layer12_gpu15_token_send</title>
<path fill="none" stroke="black" d="M11281.32,-6306.07C11283.85,-6297.9 11286.63,-6288.93 11289.4,-6279.99"/>
<polygon fill="black" stroke="black" points="11292.77,-6280.95 11292.39,-6270.36 11286.09,-6278.87 11292.77,-6280.95"/>
</g>
<!-- layer12_gpu15_token_send&#45;&gt;layer12_expert_agg -->
<g id="edge1364" class="edge">
<title>layer12_gpu15_token_send&#45;&gt;layer12_expert_agg</title>
<path fill="none" stroke="black" d="M11068.02,-6186.53C11026.42,-6181.58 10983.51,-6177.16 10943,-6174.17 9950.03,-6100.81 6913.62,-6078.52 5849.33,-6072.85"/>
<polygon fill="black" stroke="black" points="5849.24,-6069.35 5839.22,-6072.8 5849.2,-6076.35 5849.24,-6069.35"/>
</g>
<!-- layer12_residual2 -->
<g id="node1171" class="node">
<title>layer12_residual2</title>
<polygon fill="lightyellow" stroke="black" points="5918.89,-5966.17 5214.35,-5966.17 5033.11,-5830.17 5737.65,-5830.17 5918.89,-5966.17"/>
<text text-anchor="middle" x="5476" y="-5916.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="5476" y="-5901.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5476" y="-5886.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-5871.97" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer12_expert_agg&#45;&gt;layer12_residual2 -->
<g id="edge1365" class="edge">
<title>layer12_expert_agg&#45;&gt;layer12_residual2</title>
<path fill="none" stroke="black" d="M5476,-6001.98C5476,-5993.66 5476,-5985.11 5476,-5976.66"/>
<polygon fill="black" stroke="black" points="5479.5,-5976.42 5476,-5966.42 5472.5,-5976.42 5479.5,-5976.42"/>
</g>
<!-- layer13_layernorm -->
<g id="node1172" class="node">
<title>layer13_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="5679.5,-5783.17 5272.5,-5783.17 5272.5,-5715.17 5679.5,-5715.17 5679.5,-5783.17"/>
<text text-anchor="middle" x="5476" y="-5767.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5476" y="-5752.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-5737.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-5722.97" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer12_residual2&#45;&gt;layer13_layernorm -->
<g id="edge1366" class="edge">
<title>layer12_residual2&#45;&gt;layer13_layernorm</title>
<path fill="none" stroke="black" d="M5476,-5830.12C5476,-5817.71 5476,-5805.06 5476,-5793.59"/>
<polygon fill="black" stroke="black" points="5479.5,-5793.42 5476,-5783.42 5472.5,-5793.42 5479.5,-5793.42"/>
</g>
<!-- layer13_qkv_proj -->
<g id="node1173" class="node">
<title>layer13_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="5733.5,-5679.17 5218.5,-5679.17 5218.5,-5611.17 5733.5,-5611.17 5733.5,-5679.17"/>
<text text-anchor="middle" x="5476" y="-5663.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5476" y="-5648.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-5633.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5476" y="-5618.97" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer13_layernorm&#45;&gt;layer13_qkv_proj -->
<g id="edge1367" class="edge">
<title>layer13_layernorm&#45;&gt;layer13_qkv_proj</title>
<path fill="none" stroke="black" d="M5476,-5715.05C5476,-5706.94 5476,-5698.15 5476,-5689.64"/>
<polygon fill="black" stroke="black" points="5479.5,-5689.46 5476,-5679.47 5472.5,-5689.47 5479.5,-5689.46"/>
</g>
<!-- layer13_attention -->
<g id="node1174" class="node">
<title>layer13_attention</title>
<polygon fill="lightgreen" stroke="black" points="5727.5,-5575.17 5224.5,-5575.17 5224.5,-5507.17 5727.5,-5507.17 5727.5,-5575.17"/>
<text text-anchor="middle" x="5476" y="-5559.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5476" y="-5544.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5476" y="-5529.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5476" y="-5514.97" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer13_qkv_proj&#45;&gt;layer13_attention -->
<g id="edge1368" class="edge">
<title>layer13_qkv_proj&#45;&gt;layer13_attention</title>
<path fill="none" stroke="black" d="M5476,-5611.05C5476,-5602.94 5476,-5594.15 5476,-5585.64"/>
<polygon fill="black" stroke="black" points="5479.5,-5585.46 5476,-5575.47 5472.5,-5585.47 5479.5,-5585.46"/>
</g>
<!-- layer13_attn_out -->
<g id="node1175" class="node">
<title>layer13_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="5714.5,-5471.17 5237.5,-5471.17 5237.5,-5403.17 5714.5,-5403.17 5714.5,-5471.17"/>
<text text-anchor="middle" x="5476" y="-5455.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5476" y="-5440.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5476" y="-5425.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-5410.97" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer13_attention&#45;&gt;layer13_attn_out -->
<g id="edge1369" class="edge">
<title>layer13_attention&#45;&gt;layer13_attn_out</title>
<path fill="none" stroke="black" d="M5476,-5507.05C5476,-5498.94 5476,-5490.15 5476,-5481.64"/>
<polygon fill="black" stroke="black" points="5479.5,-5481.46 5476,-5471.47 5472.5,-5481.47 5479.5,-5481.46"/>
</g>
<!-- layer13_residual1 -->
<g id="node1176" class="node">
<title>layer13_residual1</title>
<polygon fill="lightyellow" stroke="black" points="5918.89,-5367.17 5214.35,-5367.17 5033.11,-5231.17 5737.65,-5231.17 5918.89,-5367.17"/>
<text text-anchor="middle" x="5476" y="-5317.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5476" y="-5302.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5476" y="-5287.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-5272.97" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer13_attn_out&#45;&gt;layer13_residual1 -->
<g id="edge1370" class="edge">
<title>layer13_attn_out&#45;&gt;layer13_residual1</title>
<path fill="none" stroke="black" d="M5476,-5402.9C5476,-5395.07 5476,-5386.4 5476,-5377.52"/>
<polygon fill="black" stroke="black" points="5479.5,-5377.43 5476,-5367.43 5472.5,-5377.43 5479.5,-5377.43"/>
</g>
<!-- layer13_layernorm2 -->
<g id="node1177" class="node">
<title>layer13_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="5679.5,-5195.17 5272.5,-5195.17 5272.5,-5127.17 5679.5,-5127.17 5679.5,-5195.17"/>
<text text-anchor="middle" x="5476" y="-5179.97" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5476" y="-5164.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-5149.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-5134.97" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer13_residual1&#45;&gt;layer13_layernorm2 -->
<g id="edge1371" class="edge">
<title>layer13_residual1&#45;&gt;layer13_layernorm2</title>
<path fill="none" stroke="black" d="M5476,-5230.96C5476,-5222.21 5476,-5213.44 5476,-5205.23"/>
<polygon fill="black" stroke="black" points="5479.5,-5205.18 5476,-5195.18 5472.5,-5205.18 5479.5,-5205.18"/>
</g>
<!-- layer13_global_gate -->
<g id="node1178" class="node">
<title>layer13_global_gate</title>
<polygon fill="lightgreen" stroke="black" points="5673.5,-5091.17 5278.5,-5091.17 5278.5,-5023.17 5673.5,-5023.17 5673.5,-5091.17"/>
<text text-anchor="middle" x="5476" y="-5075.97" font-family="Times,serif" font-size="14.00">Global Gate</text>
<text text-anchor="middle" x="5476" y="-5060.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-5045.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, experts=64]</text>
<text text-anchor="middle" x="5476" y="-5030.97" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer13_layernorm2&#45;&gt;layer13_global_gate -->
<g id="edge1372" class="edge">
<title>layer13_layernorm2&#45;&gt;layer13_global_gate</title>
<path fill="none" stroke="black" d="M5476,-5127.05C5476,-5118.94 5476,-5110.15 5476,-5101.64"/>
<polygon fill="black" stroke="black" points="5479.5,-5101.46 5476,-5091.47 5472.5,-5101.47 5479.5,-5101.46"/>
</g>
<!-- layer13_routing -->
<g id="node1179" class="node">
<title>layer13_routing</title>
<polygon fill="lightyellow" stroke="black" points="5962.47,-4987.17 5188.6,-4987.17 4989.53,-4851.17 5763.4,-4851.17 5962.47,-4987.17"/>
<text text-anchor="middle" x="5476" y="-4937.97" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="5476" y="-4922.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-4907.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5476" y="-4892.97" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer13_global_gate&#45;&gt;layer13_routing -->
<g id="edge1373" class="edge">
<title>layer13_global_gate&#45;&gt;layer13_routing</title>
<path fill="none" stroke="black" d="M5476,-5022.9C5476,-5015.07 5476,-5006.4 5476,-4997.52"/>
<polygon fill="black" stroke="black" points="5479.5,-4997.43 5476,-4987.43 5472.5,-4997.43 5479.5,-4997.43"/>
</g>
<!-- layer13_gpu0_token_recv -->
<g id="node1180" class="node">
<title>layer13_gpu0_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="607" cy="-4767.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="607" y="-4785.88" font-family="Times,serif" font-size="14.00">Token Receive GPU0</text>
<text text-anchor="middle" x="607" y="-4770.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="607" y="-4755.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="607" y="-4740.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer13_routing&#45;&gt;layer13_gpu0_token_recv -->
<g id="edge1374" class="edge">
<title>layer13_routing&#45;&gt;layer13_gpu0_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5082.15,-4914.57C4137.25,-4905.08 1761.37,-4875.79 968,-4815.17 929.07,-4812.19 887.92,-4807.91 847.87,-4803.13"/>
<polygon fill="black" stroke="black" points="848.07,-4799.63 837.72,-4801.9 847.23,-4806.58 848.07,-4799.63"/>
</g>
<!-- layer13_gpu1_token_recv -->
<g id="node1185" class="node">
<title>layer13_gpu1_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1311" cy="-4767.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1311" y="-4785.88" font-family="Times,serif" font-size="14.00">Token Receive GPU1</text>
<text text-anchor="middle" x="1311" y="-4770.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1311" y="-4755.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1311" y="-4740.88" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer13_routing&#45;&gt;layer13_gpu1_token_recv -->
<g id="edge1380" class="edge">
<title>layer13_routing&#45;&gt;layer13_gpu1_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5079.24,-4912.48C4244.07,-4899.69 2328.13,-4865.74 1677,-4815.17 1637.17,-4812.07 1595.03,-4807.69 1554.06,-4802.83"/>
<polygon fill="black" stroke="black" points="1554.3,-4799.34 1543.96,-4801.62 1553.47,-4806.29 1554.3,-4799.34"/>
</g>
<!-- layer13_gpu2_token_recv -->
<g id="node1190" class="node">
<title>layer13_gpu2_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="2020" cy="-4767.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2020" y="-4785.88" font-family="Times,serif" font-size="14.00">Token Receive GPU2</text>
<text text-anchor="middle" x="2020" y="-4770.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="2020" y="-4755.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2020" y="-4740.88" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer13_routing&#45;&gt;layer13_gpu2_token_recv -->
<g id="edge1386" class="edge">
<title>layer13_routing&#45;&gt;layer13_gpu2_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5086.41,-4917.54C4498.07,-4913.81 3348.17,-4895.67 2375,-4815.17 2337.89,-4812.1 2298.71,-4807.88 2260.46,-4803.24"/>
<polygon fill="black" stroke="black" points="2260.58,-4799.72 2250.23,-4801.98 2259.73,-4806.67 2260.58,-4799.72"/>
</g>
<!-- layer13_gpu3_token_recv -->
<g id="node1195" class="node">
<title>layer13_gpu3_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="2718" cy="-4767.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2718" y="-4785.88" font-family="Times,serif" font-size="14.00">Token Receive GPU3</text>
<text text-anchor="middle" x="2718" y="-4770.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="2718" y="-4755.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2718" y="-4740.88" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer13_routing&#45;&gt;layer13_gpu3_token_recv -->
<g id="edge1392" class="edge">
<title>layer13_routing&#45;&gt;layer13_gpu3_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5078.83,-4912.29C4600.7,-4902.66 3773.77,-4877.82 3067,-4815.17 3031.65,-4812.03 2994.39,-4807.9 2957.9,-4803.38"/>
<polygon fill="black" stroke="black" points="2957.99,-4799.86 2947.63,-4802.1 2957.12,-4806.81 2957.99,-4799.86"/>
</g>
<!-- layer13_gpu4_token_recv -->
<g id="node1200" class="node">
<title>layer13_gpu4_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="3410" cy="-4767.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="3410" y="-4785.88" font-family="Times,serif" font-size="14.00">Token Receive GPU4</text>
<text text-anchor="middle" x="3410" y="-4770.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="3410" y="-4755.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3410" y="-4740.88" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer13_routing&#45;&gt;layer13_gpu4_token_recv -->
<g id="edge1398" class="edge">
<title>layer13_routing&#45;&gt;layer13_gpu4_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5064.17,-4902.17C4715.51,-4886.56 4202.78,-4858.7 3757,-4815.17 3722.71,-4811.82 3686.6,-4807.64 3651.15,-4803.17"/>
<polygon fill="black" stroke="black" points="3651.53,-4799.69 3641.17,-4801.91 3650.65,-4806.64 3651.53,-4799.69"/>
</g>
<!-- layer13_gpu5_token_recv -->
<g id="node1205" class="node">
<title>layer13_gpu5_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4100" cy="-4767.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4100" y="-4785.88" font-family="Times,serif" font-size="14.00">Token Receive GPU5</text>
<text text-anchor="middle" x="4100" y="-4770.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4100" y="-4755.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4100" y="-4740.88" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer13_routing&#45;&gt;layer13_gpu5_token_recv -->
<g id="edge1404" class="edge">
<title>layer13_routing&#45;&gt;layer13_gpu5_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5027.13,-4876.87C4846.14,-4859.3 4635.48,-4837.67 4445,-4815.17 4412.63,-4811.34 4378.58,-4807.04 4345.01,-4802.63"/>
<polygon fill="black" stroke="black" points="4345.45,-4799.16 4335.08,-4801.32 4344.54,-4806.1 4345.45,-4799.16"/>
</g>
<!-- layer13_gpu6_token_recv -->
<g id="node1210" class="node">
<title>layer13_gpu6_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4788" cy="-4767.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4788" y="-4785.88" font-family="Times,serif" font-size="14.00">Token Receive GPU6</text>
<text text-anchor="middle" x="4788" y="-4770.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4788" y="-4755.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4788" y="-4740.88" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer13_routing&#45;&gt;layer13_gpu6_token_recv -->
<g id="edge1410" class="edge">
<title>layer13_routing&#45;&gt;layer13_gpu6_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5168.72,-4851.13C5104.24,-4837.07 5038.02,-4822.62 4979.26,-4809.81"/>
<polygon fill="black" stroke="black" points="4979.66,-4806.31 4969.14,-4807.6 4978.17,-4813.15 4979.66,-4806.31"/>
</g>
<!-- layer13_gpu7_token_recv -->
<g id="node1215" class="node">
<title>layer13_gpu7_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="5476" cy="-4767.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="5476" y="-4785.88" font-family="Times,serif" font-size="14.00">Token Receive GPU7</text>
<text text-anchor="middle" x="5476" y="-4770.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5476" y="-4755.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5476" y="-4740.88" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer13_routing&#45;&gt;layer13_gpu7_token_recv -->
<g id="edge1416" class="edge">
<title>layer13_routing&#45;&gt;layer13_gpu7_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5476,-4851.03C5476,-4842.48 5476,-4833.8 5476,-4825.43"/>
<polygon fill="black" stroke="black" points="5479.5,-4825.4 5476,-4815.4 5472.5,-4825.4 5479.5,-4825.4"/>
</g>
<!-- layer13_gpu8_token_recv -->
<g id="node1220" class="node">
<title>layer13_gpu8_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6184" cy="-4767.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6184" y="-4785.88" font-family="Times,serif" font-size="14.00">Token Receive GPU8</text>
<text text-anchor="middle" x="6184" y="-4770.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6184" y="-4755.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6184" y="-4740.88" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer13_routing&#45;&gt;layer13_gpu8_token_recv -->
<g id="edge1422" class="edge">
<title>layer13_routing&#45;&gt;layer13_gpu8_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5770.36,-4855.77C5844.3,-4840.09 5921.81,-4823.66 5989.49,-4809.31"/>
<polygon fill="black" stroke="black" points="5990.35,-4812.71 5999.4,-4807.21 5988.89,-4805.86 5990.35,-4812.71"/>
</g>
<!-- layer13_gpu9_token_recv -->
<g id="node1225" class="node">
<title>layer13_gpu9_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6902" cy="-4767.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6902" y="-4785.88" font-family="Times,serif" font-size="14.00">Token Receive GPU9</text>
<text text-anchor="middle" x="6902" y="-4770.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6902" y="-4755.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6902" y="-4740.88" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer13_routing&#45;&gt;layer13_gpu9_token_recv -->
<g id="edge1428" class="edge">
<title>layer13_routing&#45;&gt;layer13_gpu9_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5816.15,-4887.19C6022.04,-4867.86 6289.79,-4841.68 6527,-4815.17 6565.7,-4810.84 6606.61,-4805.99 6646.62,-4801.09"/>
<polygon fill="black" stroke="black" points="6647.28,-4804.54 6656.78,-4799.85 6646.42,-4797.59 6647.28,-4804.54"/>
</g>
<!-- layer13_gpu10_token_recv -->
<g id="node1230" class="node">
<title>layer13_gpu10_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="7606" cy="-4767.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="7606" y="-4785.88" font-family="Times,serif" font-size="14.00">Token Receive GPU10</text>
<text text-anchor="middle" x="7606" y="-4770.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="7606" y="-4755.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7606" y="-4740.88" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer13_routing&#45;&gt;layer13_gpu10_token_recv -->
<g id="edge1434" class="edge">
<title>layer13_routing&#45;&gt;layer13_gpu10_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5841.64,-4904.52C6199.76,-4889.35 6760.69,-4860.79 7245,-4815.17 7282.26,-4811.66 7321.59,-4807.25 7360.05,-4802.55"/>
<polygon fill="black" stroke="black" points="7360.84,-4805.98 7370.34,-4801.29 7359.98,-4799.03 7360.84,-4805.98"/>
</g>
<!-- layer13_gpu11_token_recv -->
<g id="node1235" class="node">
<title>layer13_gpu11_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8301" cy="-4767.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8301" y="-4785.88" font-family="Times,serif" font-size="14.00">Token Receive GPU11</text>
<text text-anchor="middle" x="8301" y="-4770.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8301" y="-4755.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8301" y="-4740.88" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer13_routing&#45;&gt;layer13_gpu11_token_recv -->
<g id="edge1440" class="edge">
<title>layer13_routing&#45;&gt;layer13_gpu11_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5854.29,-4913.13C6340.04,-4904.21 7208.7,-4879.96 7949,-4815.17 7985.08,-4812.01 8023.15,-4807.82 8060.38,-4803.24"/>
<polygon fill="black" stroke="black" points="8060.84,-4806.71 8070.33,-4802 8059.98,-4799.76 8060.84,-4806.71"/>
</g>
<!-- layer13_gpu12_token_recv -->
<g id="node1240" class="node">
<title>layer13_gpu12_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8992" cy="-4767.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8992" y="-4785.88" font-family="Times,serif" font-size="14.00">Token Receive GPU12</text>
<text text-anchor="middle" x="8992" y="-4770.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8992" y="-4755.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8992" y="-4740.88" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer13_routing&#45;&gt;layer13_gpu12_token_recv -->
<g id="edge1446" class="edge">
<title>layer13_routing&#45;&gt;layer13_gpu12_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5861.68,-4918.28C6458.91,-4915.61 7643.05,-4898.93 8644,-4815.17 8679.54,-4812.19 8717.01,-4808.12 8753.67,-4803.6"/>
<polygon fill="black" stroke="black" points="8754.5,-4807.03 8763.99,-4802.32 8753.63,-4800.08 8754.5,-4807.03"/>
</g>
<!-- layer13_gpu13_token_recv -->
<g id="node1245" class="node">
<title>layer13_gpu13_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="9681" cy="-4767.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="9681" y="-4785.88" font-family="Times,serif" font-size="14.00">Token Receive GPU13</text>
<text text-anchor="middle" x="9681" y="-4770.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="9681" y="-4755.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9681" y="-4740.88" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_routing&#45;&gt;layer13_gpu13_token_recv -->
<g id="edge1452" class="edge">
<title>layer13_routing&#45;&gt;layer13_gpu13_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5854.47,-4913.3C6689.26,-4901.72 8667.3,-4869.34 9335,-4815.17 9370.35,-4812.3 9407.61,-4808.28 9444.06,-4803.79"/>
<polygon fill="black" stroke="black" points="9444.83,-4807.22 9454.32,-4802.51 9443.96,-4800.28 9444.83,-4807.22"/>
</g>
<!-- layer13_gpu14_token_recv -->
<g id="node1250" class="node">
<title>layer13_gpu14_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10369" cy="-4767.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10369" y="-4785.88" font-family="Times,serif" font-size="14.00">Token Receive GPU14</text>
<text text-anchor="middle" x="10369" y="-4770.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10369" y="-4755.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10369" y="-4740.88" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer13_routing&#45;&gt;layer13_gpu14_token_recv -->
<g id="edge1458" class="edge">
<title>layer13_routing&#45;&gt;layer13_gpu14_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5857.24,-4915.08C6799.38,-4906.56 9219.22,-4878.99 10024,-4815.17 10059.39,-4812.36 10096.7,-4808.36 10133.19,-4803.87"/>
<polygon fill="black" stroke="black" points="10133.96,-4807.3 10143.45,-4802.59 10133.1,-4800.35 10133.96,-4807.3"/>
</g>
<!-- layer13_gpu15_token_recv -->
<g id="node1255" class="node">
<title>layer13_gpu15_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="11057" cy="-4767.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="11057" y="-4785.88" font-family="Times,serif" font-size="14.00">Token Receive GPU15</text>
<text text-anchor="middle" x="11057" y="-4770.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="11057" y="-4755.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="11057" y="-4740.88" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer13_routing&#45;&gt;layer13_gpu15_token_recv -->
<g id="edge1464" class="edge">
<title>layer13_routing&#45;&gt;layer13_gpu15_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5859.31,-4916.4C6901.04,-4910.68 9769.14,-4888.53 10712,-4815.17 10747.4,-4812.41 10784.71,-4808.44 10821.19,-4803.96"/>
<polygon fill="black" stroke="black" points="10821.97,-4807.39 10831.46,-4802.69 10821.1,-4800.45 10821.97,-4807.39"/>
</g>
<!-- layer13_gpu0_expert_mlp1 -->
<g id="node1181" class="node">
<title>layer13_gpu0_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="837.5,-4683 376.5,-4683 376.5,-4615 837.5,-4615 837.5,-4683"/>
<text text-anchor="middle" x="607" y="-4667.8" font-family="Times,serif" font-size="14.00">Expert 0 MLP1</text>
<text text-anchor="middle" x="607" y="-4652.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="607" y="-4637.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="607" y="-4622.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer13_gpu0_token_recv&#45;&gt;layer13_gpu0_expert_mlp1 -->
<g id="edge1375" class="edge">
<title>layer13_gpu0_token_recv&#45;&gt;layer13_gpu0_expert_mlp1</title>
<path fill="none" stroke="black" d="M607,-4718.87C607,-4710.48 607,-4701.78 607,-4693.51"/>
<polygon fill="black" stroke="black" points="610.5,-4693.3 607,-4683.3 603.5,-4693.3 610.5,-4693.3"/>
</g>
<!-- layer13_gpu0_expert_act -->
<g id="node1182" class="node">
<title>layer13_gpu0_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="670.5,-4579 293.5,-4579 293.5,-4511 670.5,-4511 670.5,-4579"/>
<text text-anchor="middle" x="482" y="-4563.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="482" y="-4548.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="482" y="-4533.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="482" y="-4518.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer13_gpu0_expert_mlp1&#45;&gt;layer13_gpu0_expert_act -->
<g id="edge1376" class="edge">
<title>layer13_gpu0_expert_mlp1&#45;&gt;layer13_gpu0_expert_act</title>
<path fill="none" stroke="black" d="M566.42,-4614.88C555.06,-4605.62 542.61,-4595.45 530.83,-4585.84"/>
<polygon fill="black" stroke="black" points="532.77,-4582.91 522.81,-4579.3 528.34,-4588.33 532.77,-4582.91"/>
</g>
<!-- layer13_gpu0_expert_mlp2 -->
<g id="node1183" class="node">
<title>layer13_gpu0_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="630.5,-4475 223.5,-4475 223.5,-4407 630.5,-4407 630.5,-4475"/>
<text text-anchor="middle" x="427" y="-4459.8" font-family="Times,serif" font-size="14.00">Expert 0 MLP2</text>
<text text-anchor="middle" x="427" y="-4444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="427" y="-4429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="427" y="-4414.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer13_gpu0_expert_act&#45;&gt;layer13_gpu0_expert_mlp2 -->
<g id="edge1377" class="edge">
<title>layer13_gpu0_expert_act&#45;&gt;layer13_gpu0_expert_mlp2</title>
<path fill="none" stroke="black" d="M464.14,-4510.88C459.58,-4502.42 454.61,-4493.21 449.84,-4484.35"/>
<polygon fill="black" stroke="black" points="452.78,-4482.44 444.96,-4475.3 446.62,-4485.76 452.78,-4482.44"/>
</g>
<!-- layer13_gpu0_token_send -->
<g id="node1184" class="node">
<title>layer13_gpu0_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="372" cy="-4322.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="372" y="-4341.72" font-family="Times,serif" font-size="14.00">Token Send GPU0</text>
<text text-anchor="middle" x="372" y="-4326.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="372" y="-4311.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="372" y="-4296.72" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer13_gpu0_expert_mlp2&#45;&gt;layer13_gpu0_token_send -->
<g id="edge1378" class="edge">
<title>layer13_gpu0_expert_mlp2&#45;&gt;layer13_gpu0_token_send</title>
<path fill="none" stroke="black" d="M411.24,-4406.73C407.29,-4398.39 402.94,-4389.21 398.62,-4380.09"/>
<polygon fill="black" stroke="black" points="401.77,-4378.56 394.32,-4371.03 395.44,-4381.56 401.77,-4378.56"/>
</g>
<!-- layer13_expert_agg -->
<g id="node1260" class="node">
<title>layer13_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="5929.05,-4238.83 5209.94,-4238.83 5024.95,-4102.83 5744.06,-4102.83 5929.05,-4238.83"/>
<text text-anchor="middle" x="5477" y="-4189.63" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5477" y="-4174.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x16)</text>
<text text-anchor="middle" x="5477" y="-4159.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-4144.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer13_gpu0_token_send&#45;&gt;layer13_expert_agg -->
<g id="edge1379" class="edge">
<title>layer13_gpu0_token_send&#45;&gt;layer13_expert_agg</title>
<path fill="none" stroke="black" d="M610.99,-4287.3C652.59,-4282.33 695.49,-4277.88 736,-4274.83 1584.6,-4210.92 4154.44,-4183.06 5112.12,-4174.71"/>
<polygon fill="black" stroke="black" points="5112.29,-4178.21 5122.26,-4174.62 5112.23,-4171.21 5112.29,-4178.21"/>
</g>
<!-- layer13_gpu1_expert_mlp1 -->
<g id="node1186" class="node">
<title>layer13_gpu1_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="1378.5,-4683 917.5,-4683 917.5,-4615 1378.5,-4615 1378.5,-4683"/>
<text text-anchor="middle" x="1148" y="-4667.8" font-family="Times,serif" font-size="14.00">Expert 1 MLP1</text>
<text text-anchor="middle" x="1148" y="-4652.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1148" y="-4637.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1148" y="-4622.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer13_gpu1_token_recv&#45;&gt;layer13_gpu1_expert_mlp1 -->
<g id="edge1381" class="edge">
<title>layer13_gpu1_token_recv&#45;&gt;layer13_gpu1_expert_mlp1</title>
<path fill="none" stroke="black" d="M1246.11,-4719.87C1231.85,-4709.71 1216.87,-4699.05 1203.04,-4689.2"/>
<polygon fill="black" stroke="black" points="1204.77,-4686.13 1194.6,-4683.18 1200.71,-4691.83 1204.77,-4686.13"/>
</g>
<!-- layer13_gpu1_expert_act -->
<g id="node1187" class="node">
<title>layer13_gpu1_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="1336.5,-4579 959.5,-4579 959.5,-4511 1336.5,-4511 1336.5,-4579"/>
<text text-anchor="middle" x="1148" y="-4563.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1148" y="-4548.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1148" y="-4533.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1148" y="-4518.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer13_gpu1_expert_mlp1&#45;&gt;layer13_gpu1_expert_act -->
<g id="edge1382" class="edge">
<title>layer13_gpu1_expert_mlp1&#45;&gt;layer13_gpu1_expert_act</title>
<path fill="none" stroke="black" d="M1148,-4614.88C1148,-4606.78 1148,-4597.98 1148,-4589.47"/>
<polygon fill="black" stroke="black" points="1151.5,-4589.3 1148,-4579.3 1144.5,-4589.3 1151.5,-4589.3"/>
</g>
<!-- layer13_gpu1_expert_mlp2 -->
<g id="node1188" class="node">
<title>layer13_gpu1_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="1335.5,-4475 928.5,-4475 928.5,-4407 1335.5,-4407 1335.5,-4475"/>
<text text-anchor="middle" x="1132" y="-4459.8" font-family="Times,serif" font-size="14.00">Expert 1 MLP2</text>
<text text-anchor="middle" x="1132" y="-4444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1132" y="-4429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1132" y="-4414.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer13_gpu1_expert_act&#45;&gt;layer13_gpu1_expert_mlp2 -->
<g id="edge1383" class="edge">
<title>layer13_gpu1_expert_act&#45;&gt;layer13_gpu1_expert_mlp2</title>
<path fill="none" stroke="black" d="M1142.81,-4510.88C1141.52,-4502.69 1140.12,-4493.79 1138.78,-4485.19"/>
<polygon fill="black" stroke="black" points="1142.23,-4484.64 1137.22,-4475.3 1135.32,-4485.72 1142.23,-4484.64"/>
</g>
<!-- layer13_gpu1_token_send -->
<g id="node1189" class="node">
<title>layer13_gpu1_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1101" cy="-4322.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1101" y="-4341.72" font-family="Times,serif" font-size="14.00">Token Send GPU1</text>
<text text-anchor="middle" x="1101" y="-4326.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1101" y="-4311.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1101" y="-4296.72" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer13_gpu1_expert_mlp2&#45;&gt;layer13_gpu1_token_send -->
<g id="edge1384" class="edge">
<title>layer13_gpu1_expert_mlp2&#45;&gt;layer13_gpu1_token_send</title>
<path fill="none" stroke="black" d="M1123.12,-4406.73C1120.96,-4398.65 1118.59,-4389.78 1116.23,-4380.95"/>
<polygon fill="black" stroke="black" points="1119.54,-4379.78 1113.58,-4371.03 1112.78,-4381.59 1119.54,-4379.78"/>
</g>
<!-- layer13_gpu1_token_send&#45;&gt;layer13_expert_agg -->
<g id="edge1385" class="edge">
<title>layer13_gpu1_token_send&#45;&gt;layer13_expert_agg</title>
<path fill="none" stroke="black" d="M1340.98,-4287.32C1382.27,-4282.38 1424.82,-4277.94 1465,-4274.83 2167.7,-4220.51 4265.31,-4187.72 5114.3,-4176.36"/>
<polygon fill="black" stroke="black" points="5114.59,-4179.85 5124.54,-4176.22 5114.49,-4172.85 5114.59,-4179.85"/>
</g>
<!-- layer13_gpu2_expert_mlp1 -->
<g id="node1191" class="node">
<title>layer13_gpu2_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2225.5,-4683 1764.5,-4683 1764.5,-4615 2225.5,-4615 2225.5,-4683"/>
<text text-anchor="middle" x="1995" y="-4667.8" font-family="Times,serif" font-size="14.00">Expert 2 MLP1</text>
<text text-anchor="middle" x="1995" y="-4652.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1995" y="-4637.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1995" y="-4622.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer13_gpu2_token_recv&#45;&gt;layer13_gpu2_expert_mlp1 -->
<g id="edge1387" class="edge">
<title>layer13_gpu2_token_recv&#45;&gt;layer13_gpu2_expert_mlp1</title>
<path fill="none" stroke="black" d="M2009.83,-4718.87C2008.01,-4710.39 2006.11,-4701.59 2004.31,-4693.23"/>
<polygon fill="black" stroke="black" points="2007.7,-4692.34 2002.17,-4683.3 2000.86,-4693.82 2007.7,-4692.34"/>
</g>
<!-- layer13_gpu2_expert_act -->
<g id="node1192" class="node">
<title>layer13_gpu2_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2089.5,-4579 1712.5,-4579 1712.5,-4511 2089.5,-4511 2089.5,-4579"/>
<text text-anchor="middle" x="1901" y="-4563.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="1901" y="-4548.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1901" y="-4533.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1901" y="-4518.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer13_gpu2_expert_mlp1&#45;&gt;layer13_gpu2_expert_act -->
<g id="edge1388" class="edge">
<title>layer13_gpu2_expert_mlp1&#45;&gt;layer13_gpu2_expert_act</title>
<path fill="none" stroke="black" d="M1964.48,-4614.88C1956.19,-4605.89 1947.12,-4596.04 1938.49,-4586.68"/>
<polygon fill="black" stroke="black" points="1941.04,-4584.28 1931.69,-4579.3 1935.89,-4589.02 1941.04,-4584.28"/>
</g>
<!-- layer13_gpu2_expert_mlp2 -->
<g id="node1193" class="node">
<title>layer13_gpu2_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2080.5,-4475 1673.5,-4475 1673.5,-4407 2080.5,-4407 2080.5,-4475"/>
<text text-anchor="middle" x="1877" y="-4459.8" font-family="Times,serif" font-size="14.00">Expert 2 MLP2</text>
<text text-anchor="middle" x="1877" y="-4444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1877" y="-4429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1877" y="-4414.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer13_gpu2_expert_act&#45;&gt;layer13_gpu2_expert_mlp2 -->
<g id="edge1389" class="edge">
<title>layer13_gpu2_expert_act&#45;&gt;layer13_gpu2_expert_mlp2</title>
<path fill="none" stroke="black" d="M1893.21,-4510.88C1891.28,-4502.69 1889.19,-4493.79 1887.16,-4485.19"/>
<polygon fill="black" stroke="black" points="1890.53,-4484.23 1884.84,-4475.3 1883.72,-4485.83 1890.53,-4484.23"/>
</g>
<!-- layer13_gpu2_token_send -->
<g id="node1194" class="node">
<title>layer13_gpu2_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1830" cy="-4322.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1830" y="-4341.72" font-family="Times,serif" font-size="14.00">Token Send GPU2</text>
<text text-anchor="middle" x="1830" y="-4326.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1830" y="-4311.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1830" y="-4296.72" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer13_gpu2_expert_mlp2&#45;&gt;layer13_gpu2_token_send -->
<g id="edge1390" class="edge">
<title>layer13_gpu2_expert_mlp2&#45;&gt;layer13_gpu2_token_send</title>
<path fill="none" stroke="black" d="M1863.53,-4406.73C1860.19,-4398.48 1856.51,-4389.4 1852.86,-4380.38"/>
<polygon fill="black" stroke="black" points="1856.07,-4378.98 1849.07,-4371.03 1849.58,-4381.61 1856.07,-4378.98"/>
</g>
<!-- layer13_gpu2_token_send&#45;&gt;layer13_expert_agg -->
<g id="edge1391" class="edge">
<title>layer13_gpu2_token_send&#45;&gt;layer13_expert_agg</title>
<path fill="none" stroke="black" d="M2070.48,-4287.45C2111.62,-4282.52 2153.98,-4278.04 2194,-4274.83 3249.04,-4190.25 4499.98,-4174.17 5108.15,-4171.73"/>
<polygon fill="black" stroke="black" points="5108.41,-4175.23 5118.39,-4171.69 5108.38,-4168.23 5108.41,-4175.23"/>
</g>
<!-- layer13_gpu3_expert_mlp1 -->
<g id="node1196" class="node">
<title>layer13_gpu3_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2927.5,-4683 2466.5,-4683 2466.5,-4615 2927.5,-4615 2927.5,-4683"/>
<text text-anchor="middle" x="2697" y="-4667.8" font-family="Times,serif" font-size="14.00">Expert 3 MLP1</text>
<text text-anchor="middle" x="2697" y="-4652.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2697" y="-4637.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2697" y="-4622.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer13_gpu3_token_recv&#45;&gt;layer13_gpu3_expert_mlp1 -->
<g id="edge1393" class="edge">
<title>layer13_gpu3_token_recv&#45;&gt;layer13_gpu3_expert_mlp1</title>
<path fill="none" stroke="black" d="M2709.46,-4718.87C2707.92,-4710.39 2706.33,-4701.59 2704.82,-4693.23"/>
<polygon fill="black" stroke="black" points="2708.25,-4692.52 2703.02,-4683.3 2701.36,-4693.77 2708.25,-4692.52"/>
</g>
<!-- layer13_gpu3_expert_act -->
<g id="node1197" class="node">
<title>layer13_gpu3_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2806.5,-4579 2429.5,-4579 2429.5,-4511 2806.5,-4511 2806.5,-4579"/>
<text text-anchor="middle" x="2618" y="-4563.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="2618" y="-4548.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2618" y="-4533.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2618" y="-4518.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer13_gpu3_expert_mlp1&#45;&gt;layer13_gpu3_expert_act -->
<g id="edge1394" class="edge">
<title>layer13_gpu3_expert_mlp1&#45;&gt;layer13_gpu3_expert_act</title>
<path fill="none" stroke="black" d="M2671.35,-4614.88C2664.52,-4606.06 2657.06,-4596.43 2649.94,-4587.23"/>
<polygon fill="black" stroke="black" points="2652.68,-4585.06 2643.79,-4579.3 2647.15,-4589.35 2652.68,-4585.06"/>
</g>
<!-- layer13_gpu3_expert_mlp2 -->
<g id="node1198" class="node">
<title>layer13_gpu3_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2801.5,-4475 2394.5,-4475 2394.5,-4407 2801.5,-4407 2801.5,-4475"/>
<text text-anchor="middle" x="2598" y="-4459.8" font-family="Times,serif" font-size="14.00">Expert 3 MLP2</text>
<text text-anchor="middle" x="2598" y="-4444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2598" y="-4429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="2598" y="-4414.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer13_gpu3_expert_act&#45;&gt;layer13_gpu3_expert_mlp2 -->
<g id="edge1395" class="edge">
<title>layer13_gpu3_expert_act&#45;&gt;layer13_gpu3_expert_mlp2</title>
<path fill="none" stroke="black" d="M2611.51,-4510.88C2609.9,-4502.69 2608.15,-4493.79 2606.47,-4485.19"/>
<polygon fill="black" stroke="black" points="2609.89,-4484.44 2604.53,-4475.3 2603.02,-4485.79 2609.89,-4484.44"/>
</g>
<!-- layer13_gpu3_token_send -->
<g id="node1199" class="node">
<title>layer13_gpu3_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="2559" cy="-4322.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="2559" y="-4341.72" font-family="Times,serif" font-size="14.00">Token Send GPU3</text>
<text text-anchor="middle" x="2559" y="-4326.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="2559" y="-4311.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="2559" y="-4296.72" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer13_gpu3_expert_mlp2&#45;&gt;layer13_gpu3_token_send -->
<g id="edge1396" class="edge">
<title>layer13_gpu3_expert_mlp2&#45;&gt;layer13_gpu3_token_send</title>
<path fill="none" stroke="black" d="M2586.82,-4406.73C2584.08,-4398.57 2581.07,-4389.59 2578.06,-4380.66"/>
<polygon fill="black" stroke="black" points="2581.33,-4379.39 2574.83,-4371.03 2574.69,-4381.62 2581.33,-4379.39"/>
</g>
<!-- layer13_gpu3_token_send&#45;&gt;layer13_expert_agg -->
<g id="edge1397" class="edge">
<title>layer13_gpu3_token_send&#45;&gt;layer13_expert_agg</title>
<path fill="none" stroke="black" d="M2800.98,-4287.58C2841.65,-4282.68 2883.48,-4278.18 2923,-4274.83 3702.23,-4208.85 4618.9,-4184.9 5114.54,-4176.38"/>
<polygon fill="black" stroke="black" points="5114.77,-4179.88 5124.71,-4176.21 5114.65,-4172.88 5114.77,-4179.88"/>
</g>
<!-- layer13_gpu4_expert_mlp1 -->
<g id="node1201" class="node">
<title>layer13_gpu4_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="3580.5,-4683 3119.5,-4683 3119.5,-4615 3580.5,-4615 3580.5,-4683"/>
<text text-anchor="middle" x="3350" y="-4667.8" font-family="Times,serif" font-size="14.00">Expert 4 MLP1</text>
<text text-anchor="middle" x="3350" y="-4652.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3350" y="-4637.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3350" y="-4622.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer13_gpu4_token_recv&#45;&gt;layer13_gpu4_expert_mlp1 -->
<g id="edge1399" class="edge">
<title>layer13_gpu4_token_recv&#45;&gt;layer13_gpu4_expert_mlp1</title>
<path fill="none" stroke="black" d="M3385.6,-4718.87C3381.07,-4710.11 3376.37,-4701.01 3371.92,-4692.41"/>
<polygon fill="black" stroke="black" points="3374.91,-4690.58 3367.21,-4683.3 3368.7,-4693.79 3374.91,-4690.58"/>
</g>
<!-- layer13_gpu4_expert_act -->
<g id="node1202" class="node">
<title>layer13_gpu4_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="3521.5,-4579 3144.5,-4579 3144.5,-4511 3521.5,-4511 3521.5,-4579"/>
<text text-anchor="middle" x="3333" y="-4563.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="3333" y="-4548.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3333" y="-4533.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3333" y="-4518.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer13_gpu4_expert_mlp1&#45;&gt;layer13_gpu4_expert_act -->
<g id="edge1400" class="edge">
<title>layer13_gpu4_expert_mlp1&#45;&gt;layer13_gpu4_expert_act</title>
<path fill="none" stroke="black" d="M3344.48,-4614.88C3343.11,-4606.69 3341.63,-4597.79 3340.2,-4589.19"/>
<polygon fill="black" stroke="black" points="3343.65,-4588.59 3338.55,-4579.3 3336.74,-4589.74 3343.65,-4588.59"/>
</g>
<!-- layer13_gpu4_expert_mlp2 -->
<g id="node1203" class="node">
<title>layer13_gpu4_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="3521.5,-4475 3114.5,-4475 3114.5,-4407 3521.5,-4407 3521.5,-4475"/>
<text text-anchor="middle" x="3318" y="-4459.8" font-family="Times,serif" font-size="14.00">Expert 4 MLP2</text>
<text text-anchor="middle" x="3318" y="-4444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3318" y="-4429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="3318" y="-4414.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer13_gpu4_expert_act&#45;&gt;layer13_gpu4_expert_mlp2 -->
<g id="edge1401" class="edge">
<title>layer13_gpu4_expert_act&#45;&gt;layer13_gpu4_expert_mlp2</title>
<path fill="none" stroke="black" d="M3328.13,-4510.88C3326.94,-4502.78 3325.64,-4493.98 3324.39,-4485.47"/>
<polygon fill="black" stroke="black" points="3327.81,-4484.68 3322.9,-4475.3 3320.89,-4485.7 3327.81,-4484.68"/>
</g>
<!-- layer13_gpu4_token_send -->
<g id="node1204" class="node">
<title>layer13_gpu4_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="3288" cy="-4322.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="3288" y="-4341.72" font-family="Times,serif" font-size="14.00">Token Send GPU4</text>
<text text-anchor="middle" x="3288" y="-4326.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="3288" y="-4311.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="3288" y="-4296.72" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer13_gpu4_expert_mlp2&#45;&gt;layer13_gpu4_token_send -->
<g id="edge1402" class="edge">
<title>layer13_gpu4_expert_mlp2&#45;&gt;layer13_gpu4_token_send</title>
<path fill="none" stroke="black" d="M3309.4,-4406.73C3307.31,-4398.65 3305.02,-4389.78 3302.74,-4380.95"/>
<polygon fill="black" stroke="black" points="3306.07,-4379.83 3300.17,-4371.03 3299.29,-4381.58 3306.07,-4379.83"/>
</g>
<!-- layer13_gpu4_token_send&#45;&gt;layer13_expert_agg -->
<g id="edge1403" class="edge">
<title>layer13_gpu4_token_send&#45;&gt;layer13_expert_agg</title>
<path fill="none" stroke="black" d="M3531.99,-4287.89C3572.03,-4283.01 3613.14,-4278.44 3652,-4274.83 4162.99,-4227.43 4756.65,-4198.81 5124.62,-4184.16"/>
<polygon fill="black" stroke="black" points="5124.78,-4187.66 5134.63,-4183.77 5124.5,-4180.67 5124.78,-4187.66"/>
</g>
<!-- layer13_gpu5_expert_mlp1 -->
<g id="node1206" class="node">
<title>layer13_gpu5_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4289.5,-4683 3828.5,-4683 3828.5,-4615 4289.5,-4615 4289.5,-4683"/>
<text text-anchor="middle" x="4059" y="-4667.8" font-family="Times,serif" font-size="14.00">Expert 5 MLP1</text>
<text text-anchor="middle" x="4059" y="-4652.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4059" y="-4637.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4059" y="-4622.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer13_gpu5_token_recv&#45;&gt;layer13_gpu5_expert_mlp1 -->
<g id="edge1405" class="edge">
<title>layer13_gpu5_token_recv&#45;&gt;layer13_gpu5_expert_mlp1</title>
<path fill="none" stroke="black" d="M4083.32,-4718.87C4080.3,-4710.29 4077.15,-4701.4 4074.17,-4692.95"/>
<polygon fill="black" stroke="black" points="4077.39,-4691.57 4070.76,-4683.3 4070.79,-4693.9 4077.39,-4691.57"/>
</g>
<!-- layer13_gpu5_expert_act -->
<g id="node1207" class="node">
<title>layer13_gpu5_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4237.5,-4579 3860.5,-4579 3860.5,-4511 4237.5,-4511 4237.5,-4579"/>
<text text-anchor="middle" x="4049" y="-4563.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="4049" y="-4548.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4049" y="-4533.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4049" y="-4518.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer13_gpu5_expert_mlp1&#45;&gt;layer13_gpu5_expert_act -->
<g id="edge1406" class="edge">
<title>layer13_gpu5_expert_mlp1&#45;&gt;layer13_gpu5_expert_act</title>
<path fill="none" stroke="black" d="M4055.75,-4614.88C4054.96,-4606.78 4054.1,-4597.98 4053.26,-4589.47"/>
<polygon fill="black" stroke="black" points="4056.72,-4588.91 4052.26,-4579.3 4049.76,-4589.59 4056.72,-4588.91"/>
</g>
<!-- layer13_gpu5_expert_mlp2 -->
<g id="node1208" class="node">
<title>layer13_gpu5_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4232.5,-4475 3825.5,-4475 3825.5,-4407 4232.5,-4407 4232.5,-4475"/>
<text text-anchor="middle" x="4029" y="-4459.8" font-family="Times,serif" font-size="14.00">Expert 5 MLP2</text>
<text text-anchor="middle" x="4029" y="-4444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4029" y="-4429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4029" y="-4414.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer13_gpu5_expert_act&#45;&gt;layer13_gpu5_expert_mlp2 -->
<g id="edge1407" class="edge">
<title>layer13_gpu5_expert_act&#45;&gt;layer13_gpu5_expert_mlp2</title>
<path fill="none" stroke="black" d="M4042.51,-4510.88C4040.9,-4502.69 4039.15,-4493.79 4037.47,-4485.19"/>
<polygon fill="black" stroke="black" points="4040.89,-4484.44 4035.53,-4475.3 4034.02,-4485.79 4040.89,-4484.44"/>
</g>
<!-- layer13_gpu5_token_send -->
<g id="node1209" class="node">
<title>layer13_gpu5_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4017" cy="-4322.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4017" y="-4341.72" font-family="Times,serif" font-size="14.00">Token Send GPU5</text>
<text text-anchor="middle" x="4017" y="-4326.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4017" y="-4311.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4017" y="-4296.72" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer13_gpu5_expert_mlp2&#45;&gt;layer13_gpu5_token_send -->
<g id="edge1408" class="edge">
<title>layer13_gpu5_expert_mlp2&#45;&gt;layer13_gpu5_token_send</title>
<path fill="none" stroke="black" d="M4025.56,-4406.73C4024.73,-4398.74 4023.83,-4389.98 4022.92,-4381.23"/>
<polygon fill="black" stroke="black" points="4026.38,-4380.61 4021.87,-4371.03 4019.42,-4381.33 4026.38,-4380.61"/>
</g>
<!-- layer13_gpu5_token_send&#45;&gt;layer13_expert_agg -->
<g id="edge1409" class="edge">
<title>layer13_gpu5_token_send&#45;&gt;layer13_expert_agg</title>
<path fill="none" stroke="black" d="M4266.02,-4288.53C4304.5,-4283.71 4343.8,-4278.99 4381,-4274.83 4637.39,-4246.21 4928.13,-4219.14 5145.7,-4199.93"/>
<polygon fill="black" stroke="black" points="5146.03,-4203.42 5155.68,-4199.05 5145.41,-4196.45 5146.03,-4203.42"/>
</g>
<!-- layer13_gpu6_expert_mlp1 -->
<g id="node1211" class="node">
<title>layer13_gpu6_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5011.5,-4683 4550.5,-4683 4550.5,-4615 5011.5,-4615 5011.5,-4683"/>
<text text-anchor="middle" x="4781" y="-4667.8" font-family="Times,serif" font-size="14.00">Expert 6 MLP1</text>
<text text-anchor="middle" x="4781" y="-4652.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4781" y="-4637.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4781" y="-4622.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer13_gpu6_token_recv&#45;&gt;layer13_gpu6_expert_mlp1 -->
<g id="edge1411" class="edge">
<title>layer13_gpu6_token_recv&#45;&gt;layer13_gpu6_expert_mlp1</title>
<path fill="none" stroke="black" d="M4785.15,-4718.87C4784.65,-4710.48 4784.12,-4701.78 4783.62,-4693.51"/>
<polygon fill="black" stroke="black" points="4787.1,-4693.07 4783.01,-4683.3 4780.12,-4693.5 4787.1,-4693.07"/>
</g>
<!-- layer13_gpu6_expert_act -->
<g id="node1212" class="node">
<title>layer13_gpu6_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4964.5,-4579 4587.5,-4579 4587.5,-4511 4964.5,-4511 4964.5,-4579"/>
<text text-anchor="middle" x="4776" y="-4563.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="4776" y="-4548.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4776" y="-4533.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4776" y="-4518.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer13_gpu6_expert_mlp1&#45;&gt;layer13_gpu6_expert_act -->
<g id="edge1412" class="edge">
<title>layer13_gpu6_expert_mlp1&#45;&gt;layer13_gpu6_expert_act</title>
<path fill="none" stroke="black" d="M4779.38,-4614.88C4778.98,-4606.78 4778.55,-4597.98 4778.13,-4589.47"/>
<polygon fill="black" stroke="black" points="4781.62,-4589.12 4777.63,-4579.3 4774.63,-4589.46 4781.62,-4589.12"/>
</g>
<!-- layer13_gpu6_expert_mlp2 -->
<g id="node1213" class="node">
<title>layer13_gpu6_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4969.5,-4475 4562.5,-4475 4562.5,-4407 4969.5,-4407 4969.5,-4475"/>
<text text-anchor="middle" x="4766" y="-4459.8" font-family="Times,serif" font-size="14.00">Expert 6 MLP2</text>
<text text-anchor="middle" x="4766" y="-4444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4766" y="-4429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4766" y="-4414.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer13_gpu6_expert_act&#45;&gt;layer13_gpu6_expert_mlp2 -->
<g id="edge1413" class="edge">
<title>layer13_gpu6_expert_act&#45;&gt;layer13_gpu6_expert_mlp2</title>
<path fill="none" stroke="black" d="M4772.75,-4510.88C4771.96,-4502.78 4771.1,-4493.98 4770.26,-4485.47"/>
<polygon fill="black" stroke="black" points="4773.72,-4484.91 4769.26,-4475.3 4766.76,-4485.59 4773.72,-4484.91"/>
</g>
<!-- layer13_gpu6_token_send -->
<g id="node1214" class="node">
<title>layer13_gpu6_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4746" cy="-4322.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4746" y="-4341.72" font-family="Times,serif" font-size="14.00">Token Send GPU6</text>
<text text-anchor="middle" x="4746" y="-4326.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4746" y="-4311.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4746" y="-4296.72" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer13_gpu6_expert_mlp2&#45;&gt;layer13_gpu6_token_send -->
<g id="edge1414" class="edge">
<title>layer13_gpu6_expert_mlp2&#45;&gt;layer13_gpu6_token_send</title>
<path fill="none" stroke="black" d="M4760.27,-4406.73C4758.88,-4398.65 4757.35,-4389.78 4755.83,-4380.95"/>
<polygon fill="black" stroke="black" points="4759.26,-4380.29 4754.12,-4371.03 4752.37,-4381.47 4759.26,-4380.29"/>
</g>
<!-- layer13_gpu6_token_send&#45;&gt;layer13_expert_agg -->
<g id="edge1415" class="edge">
<title>layer13_gpu6_token_send&#45;&gt;layer13_expert_agg</title>
<path fill="none" stroke="black" d="M4938.54,-4282.39C5014.53,-4266.78 5103.48,-4248.52 5186.94,-4231.39"/>
<polygon fill="black" stroke="black" points="5187.74,-4234.8 5196.83,-4229.36 5186.33,-4227.94 5187.74,-4234.8"/>
</g>
<!-- layer13_gpu7_expert_mlp1 -->
<g id="node1216" class="node">
<title>layer13_gpu7_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5706.5,-4683 5245.5,-4683 5245.5,-4615 5706.5,-4615 5706.5,-4683"/>
<text text-anchor="middle" x="5476" y="-4667.8" font-family="Times,serif" font-size="14.00">Expert 7 MLP1</text>
<text text-anchor="middle" x="5476" y="-4652.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5476" y="-4637.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5476" y="-4622.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer13_gpu7_token_recv&#45;&gt;layer13_gpu7_expert_mlp1 -->
<g id="edge1417" class="edge">
<title>layer13_gpu7_token_recv&#45;&gt;layer13_gpu7_expert_mlp1</title>
<path fill="none" stroke="black" d="M5476,-4718.87C5476,-4710.48 5476,-4701.78 5476,-4693.51"/>
<polygon fill="black" stroke="black" points="5479.5,-4693.3 5476,-4683.3 5472.5,-4693.3 5479.5,-4693.3"/>
</g>
<!-- layer13_gpu7_expert_act -->
<g id="node1217" class="node">
<title>layer13_gpu7_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="5664.5,-4579 5287.5,-4579 5287.5,-4511 5664.5,-4511 5664.5,-4579"/>
<text text-anchor="middle" x="5476" y="-4563.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="5476" y="-4548.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5476" y="-4533.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5476" y="-4518.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer13_gpu7_expert_mlp1&#45;&gt;layer13_gpu7_expert_act -->
<g id="edge1418" class="edge">
<title>layer13_gpu7_expert_mlp1&#45;&gt;layer13_gpu7_expert_act</title>
<path fill="none" stroke="black" d="M5476,-4614.88C5476,-4606.78 5476,-4597.98 5476,-4589.47"/>
<polygon fill="black" stroke="black" points="5479.5,-4589.3 5476,-4579.3 5472.5,-4589.3 5479.5,-4589.3"/>
</g>
<!-- layer13_gpu7_expert_mlp2 -->
<g id="node1218" class="node">
<title>layer13_gpu7_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="5679.5,-4475 5272.5,-4475 5272.5,-4407 5679.5,-4407 5679.5,-4475"/>
<text text-anchor="middle" x="5476" y="-4459.8" font-family="Times,serif" font-size="14.00">Expert 7 MLP2</text>
<text text-anchor="middle" x="5476" y="-4444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5476" y="-4429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5476" y="-4414.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer13_gpu7_expert_act&#45;&gt;layer13_gpu7_expert_mlp2 -->
<g id="edge1419" class="edge">
<title>layer13_gpu7_expert_act&#45;&gt;layer13_gpu7_expert_mlp2</title>
<path fill="none" stroke="black" d="M5476,-4510.88C5476,-4502.78 5476,-4493.98 5476,-4485.47"/>
<polygon fill="black" stroke="black" points="5479.5,-4485.3 5476,-4475.3 5472.5,-4485.3 5479.5,-4485.3"/>
</g>
<!-- layer13_gpu7_token_send -->
<g id="node1219" class="node">
<title>layer13_gpu7_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="5475" cy="-4322.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="5475" y="-4341.72" font-family="Times,serif" font-size="14.00">Token Send GPU7</text>
<text text-anchor="middle" x="5475" y="-4326.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="5475" y="-4311.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="5475" y="-4296.72" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer13_gpu7_expert_mlp2&#45;&gt;layer13_gpu7_token_send -->
<g id="edge1420" class="edge">
<title>layer13_gpu7_expert_mlp2&#45;&gt;layer13_gpu7_token_send</title>
<path fill="none" stroke="black" d="M5475.71,-4406.73C5475.64,-4398.74 5475.57,-4389.98 5475.49,-4381.23"/>
<polygon fill="black" stroke="black" points="5478.99,-4380.99 5475.41,-4371.03 5471.99,-4381.06 5478.99,-4380.99"/>
</g>
<!-- layer13_gpu7_token_send&#45;&gt;layer13_expert_agg -->
<g id="edge1421" class="edge">
<title>layer13_gpu7_token_send&#45;&gt;layer13_expert_agg</title>
<path fill="none" stroke="black" d="M5475.63,-4274.43C5475.74,-4266.34 5475.85,-4257.76 5475.97,-4249.14"/>
<polygon fill="black" stroke="black" points="5479.47,-4249.07 5476.1,-4239.03 5472.47,-4248.98 5479.47,-4249.07"/>
</g>
<!-- layer13_gpu8_expert_mlp1 -->
<g id="node1221" class="node">
<title>layer13_gpu8_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="6417.5,-4683 5956.5,-4683 5956.5,-4615 6417.5,-4615 6417.5,-4683"/>
<text text-anchor="middle" x="6187" y="-4667.8" font-family="Times,serif" font-size="14.00">Expert 8 MLP1</text>
<text text-anchor="middle" x="6187" y="-4652.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6187" y="-4637.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6187" y="-4622.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer13_gpu8_token_recv&#45;&gt;layer13_gpu8_expert_mlp1 -->
<g id="edge1423" class="edge">
<title>layer13_gpu8_token_recv&#45;&gt;layer13_gpu8_expert_mlp1</title>
<path fill="none" stroke="black" d="M6185.22,-4718.87C6185.44,-4710.48 6185.66,-4701.78 6185.88,-4693.51"/>
<polygon fill="black" stroke="black" points="6189.38,-4693.39 6186.14,-4683.3 6182.38,-4693.21 6189.38,-4693.39"/>
</g>
<!-- layer13_gpu8_expert_act -->
<g id="node1222" class="node">
<title>layer13_gpu8_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="6377.5,-4579 6000.5,-4579 6000.5,-4511 6377.5,-4511 6377.5,-4579"/>
<text text-anchor="middle" x="6189" y="-4563.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="6189" y="-4548.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6189" y="-4533.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6189" y="-4518.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer13_gpu8_expert_mlp1&#45;&gt;layer13_gpu8_expert_act -->
<g id="edge1424" class="edge">
<title>layer13_gpu8_expert_mlp1&#45;&gt;layer13_gpu8_expert_act</title>
<path fill="none" stroke="black" d="M6187.65,-4614.88C6187.81,-4606.78 6187.98,-4597.98 6188.15,-4589.47"/>
<polygon fill="black" stroke="black" points="6191.65,-4589.37 6188.35,-4579.3 6184.65,-4589.23 6191.65,-4589.37"/>
</g>
<!-- layer13_gpu8_expert_mlp2 -->
<g id="node1223" class="node">
<title>layer13_gpu8_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="6402.5,-4475 5995.5,-4475 5995.5,-4407 6402.5,-4407 6402.5,-4475"/>
<text text-anchor="middle" x="6199" y="-4459.8" font-family="Times,serif" font-size="14.00">Expert 8 MLP2</text>
<text text-anchor="middle" x="6199" y="-4444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6199" y="-4429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6199" y="-4414.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer13_gpu8_expert_act&#45;&gt;layer13_gpu8_expert_mlp2 -->
<g id="edge1425" class="edge">
<title>layer13_gpu8_expert_act&#45;&gt;layer13_gpu8_expert_mlp2</title>
<path fill="none" stroke="black" d="M6192.25,-4510.88C6193.04,-4502.78 6193.9,-4493.98 6194.74,-4485.47"/>
<polygon fill="black" stroke="black" points="6198.24,-4485.59 6195.74,-4475.3 6191.28,-4484.91 6198.24,-4485.59"/>
</g>
<!-- layer13_gpu8_token_send -->
<g id="node1224" class="node">
<title>layer13_gpu8_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6204" cy="-4322.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6204" y="-4341.72" font-family="Times,serif" font-size="14.00">Token Send GPU8</text>
<text text-anchor="middle" x="6204" y="-4326.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6204" y="-4311.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6204" y="-4296.72" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer13_gpu8_expert_mlp2&#45;&gt;layer13_gpu8_token_send -->
<g id="edge1426" class="edge">
<title>layer13_gpu8_expert_mlp2&#45;&gt;layer13_gpu8_token_send</title>
<path fill="none" stroke="black" d="M6200.43,-4406.73C6200.78,-4398.74 6201.15,-4389.98 6201.53,-4381.23"/>
<polygon fill="black" stroke="black" points="6205.04,-4381.17 6201.97,-4371.03 6198.04,-4380.87 6205.04,-4381.17"/>
</g>
<!-- layer13_gpu8_token_send&#45;&gt;layer13_expert_agg -->
<g id="edge1427" class="edge">
<title>layer13_gpu8_token_send&#45;&gt;layer13_expert_agg</title>
<path fill="none" stroke="black" d="M6012.51,-4282.39C5950.86,-4269.66 5880.64,-4255.16 5811.79,-4240.95"/>
<polygon fill="black" stroke="black" points="5812.14,-4237.45 5801.64,-4238.85 5810.73,-4244.3 5812.14,-4237.45"/>
</g>
<!-- layer13_gpu9_expert_mlp1 -->
<g id="node1226" class="node">
<title>layer13_gpu9_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7135.5,-4683 6674.5,-4683 6674.5,-4615 7135.5,-4615 7135.5,-4683"/>
<text text-anchor="middle" x="6905" y="-4667.8" font-family="Times,serif" font-size="14.00">Expert 9 MLP1</text>
<text text-anchor="middle" x="6905" y="-4652.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6905" y="-4637.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6905" y="-4622.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer13_gpu9_token_recv&#45;&gt;layer13_gpu9_expert_mlp1 -->
<g id="edge1429" class="edge">
<title>layer13_gpu9_token_recv&#45;&gt;layer13_gpu9_expert_mlp1</title>
<path fill="none" stroke="black" d="M6903.22,-4718.87C6903.44,-4710.48 6903.66,-4701.78 6903.88,-4693.51"/>
<polygon fill="black" stroke="black" points="6907.38,-4693.39 6904.14,-4683.3 6900.38,-4693.21 6907.38,-4693.39"/>
</g>
<!-- layer13_gpu9_expert_act -->
<g id="node1227" class="node">
<title>layer13_gpu9_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7101.5,-4579 6724.5,-4579 6724.5,-4511 7101.5,-4511 7101.5,-4579"/>
<text text-anchor="middle" x="6913" y="-4563.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="6913" y="-4548.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6913" y="-4533.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6913" y="-4518.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer13_gpu9_expert_mlp1&#45;&gt;layer13_gpu9_expert_act -->
<g id="edge1430" class="edge">
<title>layer13_gpu9_expert_mlp1&#45;&gt;layer13_gpu9_expert_act</title>
<path fill="none" stroke="black" d="M6907.6,-4614.88C6908.23,-4606.78 6908.92,-4597.98 6909.59,-4589.47"/>
<polygon fill="black" stroke="black" points="6913.1,-4589.54 6910.39,-4579.3 6906.12,-4588.99 6913.1,-4589.54"/>
</g>
<!-- layer13_gpu9_expert_mlp2 -->
<g id="node1228" class="node">
<title>layer13_gpu9_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7120.5,-4475 6713.5,-4475 6713.5,-4407 7120.5,-4407 7120.5,-4475"/>
<text text-anchor="middle" x="6917" y="-4459.8" font-family="Times,serif" font-size="14.00">Expert 9 MLP2</text>
<text text-anchor="middle" x="6917" y="-4444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6917" y="-4429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6917" y="-4414.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer13_gpu9_expert_act&#45;&gt;layer13_gpu9_expert_mlp2 -->
<g id="edge1431" class="edge">
<title>layer13_gpu9_expert_act&#45;&gt;layer13_gpu9_expert_mlp2</title>
<path fill="none" stroke="black" d="M6914.3,-4510.88C6914.62,-4502.78 6914.96,-4493.98 6915.3,-4485.47"/>
<polygon fill="black" stroke="black" points="6918.8,-4485.43 6915.69,-4475.3 6911.8,-4485.15 6918.8,-4485.43"/>
</g>
<!-- layer13_gpu9_token_send -->
<g id="node1229" class="node">
<title>layer13_gpu9_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6933" cy="-4322.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6933" y="-4341.72" font-family="Times,serif" font-size="14.00">Token Send GPU9</text>
<text text-anchor="middle" x="6933" y="-4326.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6933" y="-4311.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6933" y="-4296.72" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer13_gpu9_expert_mlp2&#45;&gt;layer13_gpu9_token_send -->
<g id="edge1432" class="edge">
<title>layer13_gpu9_expert_mlp2&#45;&gt;layer13_gpu9_token_send</title>
<path fill="none" stroke="black" d="M6921.58,-4406.73C6922.7,-4398.65 6923.92,-4389.78 6925.14,-4380.95"/>
<polygon fill="black" stroke="black" points="6928.61,-4381.41 6926.51,-4371.03 6921.67,-4380.45 6928.61,-4381.41"/>
</g>
<!-- layer13_gpu9_token_send&#45;&gt;layer13_expert_agg -->
<g id="edge1433" class="edge">
<title>layer13_gpu9_token_send&#45;&gt;layer13_expert_agg</title>
<path fill="none" stroke="black" d="M6683.98,-4288.54C6645.5,-4283.72 6606.2,-4278.99 6569,-4274.83 6347.19,-4250.03 6099.58,-4226.35 5896.29,-4207.96"/>
<polygon fill="black" stroke="black" points="5896.31,-4204.45 5886.03,-4207.04 5895.68,-4211.42 5896.31,-4204.45"/>
</g>
<!-- layer13_gpu10_expert_mlp1 -->
<g id="node1231" class="node">
<title>layer13_gpu10_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7864.5,-4683 7403.5,-4683 7403.5,-4615 7864.5,-4615 7864.5,-4683"/>
<text text-anchor="middle" x="7634" y="-4667.8" font-family="Times,serif" font-size="14.00">Expert 10 MLP1</text>
<text text-anchor="middle" x="7634" y="-4652.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7634" y="-4637.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7634" y="-4622.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer13_gpu10_token_recv&#45;&gt;layer13_gpu10_expert_mlp1 -->
<g id="edge1435" class="edge">
<title>layer13_gpu10_token_recv&#45;&gt;layer13_gpu10_expert_mlp1</title>
<path fill="none" stroke="black" d="M7617.39,-4718.87C7619.43,-4710.39 7621.56,-4701.59 7623.57,-4693.23"/>
<polygon fill="black" stroke="black" points="7627.02,-4693.84 7625.97,-4683.3 7620.22,-4692.2 7627.02,-4693.84"/>
</g>
<!-- layer13_gpu10_expert_act -->
<g id="node1232" class="node">
<title>layer13_gpu10_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7829.5,-4579 7452.5,-4579 7452.5,-4511 7829.5,-4511 7829.5,-4579"/>
<text text-anchor="middle" x="7641" y="-4563.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="7641" y="-4548.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7641" y="-4533.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7641" y="-4518.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer13_gpu10_expert_mlp1&#45;&gt;layer13_gpu10_expert_act -->
<g id="edge1436" class="edge">
<title>layer13_gpu10_expert_mlp1&#45;&gt;layer13_gpu10_expert_act</title>
<path fill="none" stroke="black" d="M7636.27,-4614.88C7636.83,-4606.78 7637.43,-4597.98 7638.02,-4589.47"/>
<polygon fill="black" stroke="black" points="7641.52,-4589.51 7638.71,-4579.3 7634.54,-4589.04 7641.52,-4589.51"/>
</g>
<!-- layer13_gpu10_expert_mlp2 -->
<g id="node1233" class="node">
<title>layer13_gpu10_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7851.5,-4475 7444.5,-4475 7444.5,-4407 7851.5,-4407 7851.5,-4475"/>
<text text-anchor="middle" x="7648" y="-4459.8" font-family="Times,serif" font-size="14.00">Expert 10 MLP2</text>
<text text-anchor="middle" x="7648" y="-4444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7648" y="-4429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="7648" y="-4414.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer13_gpu10_expert_act&#45;&gt;layer13_gpu10_expert_mlp2 -->
<g id="edge1437" class="edge">
<title>layer13_gpu10_expert_act&#45;&gt;layer13_gpu10_expert_mlp2</title>
<path fill="none" stroke="black" d="M7643.27,-4510.88C7643.83,-4502.78 7644.43,-4493.98 7645.02,-4485.47"/>
<polygon fill="black" stroke="black" points="7648.52,-4485.51 7645.71,-4475.3 7641.54,-4485.04 7648.52,-4485.51"/>
</g>
<!-- layer13_gpu10_token_send -->
<g id="node1234" class="node">
<title>layer13_gpu10_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="7662" cy="-4322.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="7662" y="-4341.72" font-family="Times,serif" font-size="14.00">Token Send GPU10</text>
<text text-anchor="middle" x="7662" y="-4326.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="7662" y="-4311.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="7662" y="-4296.72" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer13_gpu10_expert_mlp2&#45;&gt;layer13_gpu10_token_send -->
<g id="edge1438" class="edge">
<title>layer13_gpu10_expert_mlp2&#45;&gt;layer13_gpu10_token_send</title>
<path fill="none" stroke="black" d="M7652.01,-4406.73C7652.98,-4398.74 7654.03,-4389.98 7655.09,-4381.23"/>
<polygon fill="black" stroke="black" points="7658.6,-4381.37 7656.32,-4371.03 7651.65,-4380.53 7658.6,-4381.37"/>
</g>
<!-- layer13_gpu10_token_send&#45;&gt;layer13_expert_agg -->
<g id="edge1439" class="edge">
<title>layer13_gpu10_token_send&#45;&gt;layer13_expert_agg</title>
<path fill="none" stroke="black" d="M7418.01,-4287.89C7377.96,-4283.02 7336.86,-4278.44 7298,-4274.83 6805.31,-4229.09 6235.61,-4200.82 5866.49,-4185.73"/>
<polygon fill="black" stroke="black" points="5866.58,-4182.23 5856.44,-4185.32 5866.29,-4189.22 5866.58,-4182.23"/>
</g>
<!-- layer13_gpu11_expert_mlp1 -->
<g id="node1236" class="node">
<title>layer13_gpu11_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="8542.5,-4683 8081.5,-4683 8081.5,-4615 8542.5,-4615 8542.5,-4683"/>
<text text-anchor="middle" x="8312" y="-4667.8" font-family="Times,serif" font-size="14.00">Expert 11 MLP1</text>
<text text-anchor="middle" x="8312" y="-4652.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8312" y="-4637.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8312" y="-4622.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer13_gpu11_token_recv&#45;&gt;layer13_gpu11_expert_mlp1 -->
<g id="edge1441" class="edge">
<title>layer13_gpu11_token_recv&#45;&gt;layer13_gpu11_expert_mlp1</title>
<path fill="none" stroke="black" d="M8305.47,-4718.87C8306.27,-4710.48 8307.09,-4701.78 8307.88,-4693.51"/>
<polygon fill="black" stroke="black" points="8311.39,-4693.59 8308.84,-4683.3 8304.42,-4692.93 8311.39,-4693.59"/>
</g>
<!-- layer13_gpu11_expert_act -->
<g id="node1237" class="node">
<title>layer13_gpu11_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="8511.5,-4579 8134.5,-4579 8134.5,-4511 8511.5,-4511 8511.5,-4579"/>
<text text-anchor="middle" x="8323" y="-4563.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="8323" y="-4548.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8323" y="-4533.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8323" y="-4518.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer13_gpu11_expert_mlp1&#45;&gt;layer13_gpu11_expert_act -->
<g id="edge1442" class="edge">
<title>layer13_gpu11_expert_mlp1&#45;&gt;layer13_gpu11_expert_act</title>
<path fill="none" stroke="black" d="M8315.57,-4614.88C8316.45,-4606.78 8317.39,-4597.98 8318.31,-4589.47"/>
<polygon fill="black" stroke="black" points="8321.82,-4589.62 8319.41,-4579.3 8314.86,-4588.87 8321.82,-4589.62"/>
</g>
<!-- layer13_gpu11_expert_mlp2 -->
<g id="node1238" class="node">
<title>layer13_gpu11_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="8571.5,-4475 8164.5,-4475 8164.5,-4407 8571.5,-4407 8571.5,-4475"/>
<text text-anchor="middle" x="8368" y="-4459.8" font-family="Times,serif" font-size="14.00">Expert 11 MLP2</text>
<text text-anchor="middle" x="8368" y="-4444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8368" y="-4429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="8368" y="-4414.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer13_gpu11_expert_act&#45;&gt;layer13_gpu11_expert_mlp2 -->
<g id="edge1443" class="edge">
<title>layer13_gpu11_expert_act&#45;&gt;layer13_gpu11_expert_mlp2</title>
<path fill="none" stroke="black" d="M8337.61,-4510.88C8341.3,-4502.51 8345.32,-4493.4 8349.19,-4484.63"/>
<polygon fill="black" stroke="black" points="8352.47,-4485.86 8353.31,-4475.3 8346.07,-4483.03 8352.47,-4485.86"/>
</g>
<!-- layer13_gpu11_token_send -->
<g id="node1239" class="node">
<title>layer13_gpu11_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="8391" cy="-4322.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="8391" y="-4341.72" font-family="Times,serif" font-size="14.00">Token Send GPU11</text>
<text text-anchor="middle" x="8391" y="-4326.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="8391" y="-4311.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="8391" y="-4296.72" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer13_gpu11_expert_mlp2&#45;&gt;layer13_gpu11_token_send -->
<g id="edge1444" class="edge">
<title>layer13_gpu11_expert_mlp2&#45;&gt;layer13_gpu11_token_send</title>
<path fill="none" stroke="black" d="M8374.59,-4406.73C8376.19,-4398.65 8377.95,-4389.78 8379.7,-4380.95"/>
<polygon fill="black" stroke="black" points="8383.16,-4381.52 8381.67,-4371.03 8376.29,-4380.15 8383.16,-4381.52"/>
</g>
<!-- layer13_gpu11_token_send&#45;&gt;layer13_expert_agg -->
<g id="edge1445" class="edge">
<title>layer13_gpu11_token_send&#45;&gt;layer13_expert_agg</title>
<path fill="none" stroke="black" d="M8149.02,-4287.58C8108.35,-4282.68 8066.52,-4278.18 8027,-4274.83 7257.21,-4209.63 6353.08,-4185.46 5854.72,-4176.68"/>
<polygon fill="black" stroke="black" points="5854.55,-4173.18 5844.49,-4176.5 5854.43,-4180.18 5854.55,-4173.18"/>
</g>
<!-- layer13_gpu12_expert_mlp1 -->
<g id="node1241" class="node">
<title>layer13_gpu12_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9238.5,-4683 8777.5,-4683 8777.5,-4615 9238.5,-4615 9238.5,-4683"/>
<text text-anchor="middle" x="9008" y="-4667.8" font-family="Times,serif" font-size="14.00">Expert 12 MLP1</text>
<text text-anchor="middle" x="9008" y="-4652.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9008" y="-4637.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9008" y="-4622.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer13_gpu12_token_recv&#45;&gt;layer13_gpu12_expert_mlp1 -->
<g id="edge1447" class="edge">
<title>layer13_gpu12_token_recv&#45;&gt;layer13_gpu12_expert_mlp1</title>
<path fill="none" stroke="black" d="M8998.51,-4718.87C8999.68,-4710.39 9000.89,-4701.59 9002.04,-4693.23"/>
<polygon fill="black" stroke="black" points="9005.51,-4693.69 9003.41,-4683.3 8998.58,-4692.73 9005.51,-4693.69"/>
</g>
<!-- layer13_gpu12_expert_act -->
<g id="node1242" class="node">
<title>layer13_gpu12_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9228.5,-4579 8851.5,-4579 8851.5,-4511 9228.5,-4511 9228.5,-4579"/>
<text text-anchor="middle" x="9040" y="-4563.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="9040" y="-4548.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9040" y="-4533.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9040" y="-4518.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer13_gpu12_expert_mlp1&#45;&gt;layer13_gpu12_expert_act -->
<g id="edge1448" class="edge">
<title>layer13_gpu12_expert_mlp1&#45;&gt;layer13_gpu12_expert_act</title>
<path fill="none" stroke="black" d="M9018.39,-4614.88C9020.99,-4606.6 9023.81,-4597.59 9026.54,-4588.91"/>
<polygon fill="black" stroke="black" points="9029.9,-4589.89 9029.55,-4579.3 9023.22,-4587.79 9029.9,-4589.89"/>
</g>
<!-- layer13_gpu12_expert_mlp2 -->
<g id="node1243" class="node">
<title>layer13_gpu12_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9259.5,-4475 8852.5,-4475 8852.5,-4407 9259.5,-4407 9259.5,-4475"/>
<text text-anchor="middle" x="9056" y="-4459.8" font-family="Times,serif" font-size="14.00">Expert 12 MLP2</text>
<text text-anchor="middle" x="9056" y="-4444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9056" y="-4429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9056" y="-4414.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer13_gpu12_expert_act&#45;&gt;layer13_gpu12_expert_mlp2 -->
<g id="edge1449" class="edge">
<title>layer13_gpu12_expert_act&#45;&gt;layer13_gpu12_expert_mlp2</title>
<path fill="none" stroke="black" d="M9045.19,-4510.88C9046.48,-4502.69 9047.88,-4493.79 9049.22,-4485.19"/>
<polygon fill="black" stroke="black" points="9052.68,-4485.72 9050.78,-4475.3 9045.77,-4484.64 9052.68,-4485.72"/>
</g>
<!-- layer13_gpu12_token_send -->
<g id="node1244" class="node">
<title>layer13_gpu12_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9120" cy="-4322.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9120" y="-4341.72" font-family="Times,serif" font-size="14.00">Token Send GPU12</text>
<text text-anchor="middle" x="9120" y="-4326.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9120" y="-4311.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9120" y="-4296.72" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer13_gpu12_expert_mlp2&#45;&gt;layer13_gpu12_token_send -->
<g id="edge1450" class="edge">
<title>layer13_gpu12_expert_mlp2&#45;&gt;layer13_gpu12_token_send</title>
<path fill="none" stroke="black" d="M9074.34,-4406.73C9078.99,-4398.31 9084.11,-4389.02 9089.19,-4379.81"/>
<polygon fill="black" stroke="black" points="9092.26,-4381.47 9094.03,-4371.03 9086.13,-4378.09 9092.26,-4381.47"/>
</g>
<!-- layer13_gpu12_token_send&#45;&gt;layer13_expert_agg -->
<g id="edge1451" class="edge">
<title>layer13_gpu12_token_send&#45;&gt;layer13_expert_agg</title>
<path fill="none" stroke="black" d="M8879.52,-4287.46C8838.38,-4282.52 8796.02,-4278.04 8756,-4274.83 7703.84,-4190.46 6456.59,-4174.27 5848.15,-4171.76"/>
<polygon fill="black" stroke="black" points="5847.92,-4168.26 5837.9,-4171.72 5847.89,-4175.26 5847.92,-4168.26"/>
</g>
<!-- layer13_gpu13_expert_mlp1 -->
<g id="node1246" class="node">
<title>layer13_gpu13_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9932.5,-4683 9471.5,-4683 9471.5,-4615 9932.5,-4615 9932.5,-4683"/>
<text text-anchor="middle" x="9702" y="-4667.8" font-family="Times,serif" font-size="14.00">Expert 13 MLP1</text>
<text text-anchor="middle" x="9702" y="-4652.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9702" y="-4637.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9702" y="-4622.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_gpu13_token_recv&#45;&gt;layer13_gpu13_expert_mlp1 -->
<g id="edge1453" class="edge">
<title>layer13_gpu13_token_recv&#45;&gt;layer13_gpu13_expert_mlp1</title>
<path fill="none" stroke="black" d="M9689.54,-4718.87C9691.08,-4710.39 9692.67,-4701.59 9694.18,-4693.23"/>
<polygon fill="black" stroke="black" points="9697.64,-4693.77 9695.98,-4683.3 9690.75,-4692.52 9697.64,-4693.77"/>
</g>
<!-- layer13_gpu13_expert_act -->
<g id="node1247" class="node">
<title>layer13_gpu13_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9932.5,-4579 9555.5,-4579 9555.5,-4511 9932.5,-4511 9932.5,-4579"/>
<text text-anchor="middle" x="9744" y="-4563.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="9744" y="-4548.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9744" y="-4533.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9744" y="-4518.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_gpu13_expert_mlp1&#45;&gt;layer13_gpu13_expert_act -->
<g id="edge1454" class="edge">
<title>layer13_gpu13_expert_mlp1&#45;&gt;layer13_gpu13_expert_act</title>
<path fill="none" stroke="black" d="M9715.64,-4614.88C9719.08,-4606.51 9722.83,-4597.4 9726.45,-4588.63"/>
<polygon fill="black" stroke="black" points="9729.72,-4589.88 9730.29,-4579.3 9723.24,-4587.21 9729.72,-4589.88"/>
</g>
<!-- layer13_gpu13_expert_mlp2 -->
<g id="node1248" class="node">
<title>layer13_gpu13_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10031.5,-4475 9624.5,-4475 9624.5,-4407 10031.5,-4407 10031.5,-4475"/>
<text text-anchor="middle" x="9828" y="-4459.8" font-family="Times,serif" font-size="14.00">Expert 13 MLP2</text>
<text text-anchor="middle" x="9828" y="-4444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9828" y="-4429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9828" y="-4414.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_gpu13_expert_act&#45;&gt;layer13_gpu13_expert_mlp2 -->
<g id="edge1455" class="edge">
<title>layer13_gpu13_expert_act&#45;&gt;layer13_gpu13_expert_mlp2</title>
<path fill="none" stroke="black" d="M9771.27,-4510.88C9778.53,-4502.06 9786.47,-4492.43 9794.04,-4483.23"/>
<polygon fill="black" stroke="black" points="9796.92,-4485.24 9800.58,-4475.3 9791.52,-4480.79 9796.92,-4485.24"/>
</g>
<!-- layer13_gpu13_token_send -->
<g id="node1249" class="node">
<title>layer13_gpu13_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9849" cy="-4322.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9849" y="-4341.72" font-family="Times,serif" font-size="14.00">Token Send GPU13</text>
<text text-anchor="middle" x="9849" y="-4326.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9849" y="-4311.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9849" y="-4296.72" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_gpu13_expert_mlp2&#45;&gt;layer13_gpu13_token_send -->
<g id="edge1456" class="edge">
<title>layer13_gpu13_expert_mlp2&#45;&gt;layer13_gpu13_token_send</title>
<path fill="none" stroke="black" d="M9834.02,-4406.73C9835.48,-4398.65 9837.08,-4389.78 9838.68,-4380.95"/>
<polygon fill="black" stroke="black" points="9842.14,-4381.49 9840.48,-4371.03 9835.25,-4380.24 9842.14,-4381.49"/>
</g>
<!-- layer13_gpu13_token_send&#45;&gt;layer13_expert_agg -->
<g id="edge1457" class="edge">
<title>layer13_gpu13_token_send&#45;&gt;layer13_expert_agg</title>
<path fill="none" stroke="black" d="M9609.02,-4287.32C9567.73,-4282.39 9525.18,-4277.94 9485,-4274.83 8787.13,-4220.87 6712.07,-4188.13 5854.42,-4176.56"/>
<polygon fill="black" stroke="black" points="5854.44,-4173.06 5844.39,-4176.43 5854.34,-4180.06 5854.44,-4173.06"/>
</g>
<!-- layer13_gpu14_expert_mlp1 -->
<g id="node1251" class="node">
<title>layer13_gpu14_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="10730.5,-4683 10269.5,-4683 10269.5,-4615 10730.5,-4615 10730.5,-4683"/>
<text text-anchor="middle" x="10500" y="-4667.8" font-family="Times,serif" font-size="14.00">Expert 14 MLP1</text>
<text text-anchor="middle" x="10500" y="-4652.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10500" y="-4637.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10500" y="-4622.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer13_gpu14_token_recv&#45;&gt;layer13_gpu14_expert_mlp1 -->
<g id="edge1459" class="edge">
<title>layer13_gpu14_token_recv&#45;&gt;layer13_gpu14_expert_mlp1</title>
<path fill="none" stroke="black" d="M10421.53,-4719.54C10432.53,-4709.79 10444.03,-4699.59 10454.74,-4690.11"/>
<polygon fill="black" stroke="black" points="10457.21,-4692.59 10462.37,-4683.34 10452.57,-4687.35 10457.21,-4692.59"/>
</g>
<!-- layer13_gpu14_expert_act -->
<g id="node1252" class="node">
<title>layer13_gpu14_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="10701.5,-4579 10324.5,-4579 10324.5,-4511 10701.5,-4511 10701.5,-4579"/>
<text text-anchor="middle" x="10513" y="-4563.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="10513" y="-4548.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10513" y="-4533.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10513" y="-4518.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer13_gpu14_expert_mlp1&#45;&gt;layer13_gpu14_expert_act -->
<g id="edge1460" class="edge">
<title>layer13_gpu14_expert_mlp1&#45;&gt;layer13_gpu14_expert_act</title>
<path fill="none" stroke="black" d="M10504.22,-4614.88C10505.25,-4606.78 10506.37,-4597.98 10507.46,-4589.47"/>
<polygon fill="black" stroke="black" points="10510.96,-4589.66 10508.76,-4579.3 10504.02,-4588.78 10510.96,-4589.66"/>
</g>
<!-- layer13_gpu14_expert_mlp2 -->
<g id="node1253" class="node">
<title>layer13_gpu14_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10768.5,-4475 10361.5,-4475 10361.5,-4407 10768.5,-4407 10768.5,-4475"/>
<text text-anchor="middle" x="10565" y="-4459.8" font-family="Times,serif" font-size="14.00">Expert 14 MLP2</text>
<text text-anchor="middle" x="10565" y="-4444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10565" y="-4429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="10565" y="-4414.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer13_gpu14_expert_act&#45;&gt;layer13_gpu14_expert_mlp2 -->
<g id="edge1461" class="edge">
<title>layer13_gpu14_expert_act&#45;&gt;layer13_gpu14_expert_mlp2</title>
<path fill="none" stroke="black" d="M10529.88,-4510.88C10534.2,-4502.42 10538.89,-4493.21 10543.41,-4484.35"/>
<polygon fill="black" stroke="black" points="10546.6,-4485.8 10548.02,-4475.3 10540.36,-4482.62 10546.6,-4485.8"/>
</g>
<!-- layer13_gpu14_token_send -->
<g id="node1254" class="node">
<title>layer13_gpu14_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="10578" cy="-4322.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="10578" y="-4341.72" font-family="Times,serif" font-size="14.00">Token Send GPU14</text>
<text text-anchor="middle" x="10578" y="-4326.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="10578" y="-4311.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="10578" y="-4296.72" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer13_gpu14_expert_mlp2&#45;&gt;layer13_gpu14_token_send -->
<g id="edge1462" class="edge">
<title>layer13_gpu14_expert_mlp2&#45;&gt;layer13_gpu14_token_send</title>
<path fill="none" stroke="black" d="M10568.73,-4406.73C10569.62,-4398.74 10570.6,-4389.98 10571.58,-4381.23"/>
<polygon fill="black" stroke="black" points="10575.09,-4381.35 10572.72,-4371.03 10568.13,-4380.57 10575.09,-4381.35"/>
</g>
<!-- layer13_gpu14_token_send&#45;&gt;layer13_expert_agg -->
<g id="edge1463" class="edge">
<title>layer13_gpu14_token_send&#45;&gt;layer13_expert_agg</title>
<path fill="none" stroke="black" d="M10339.01,-4287.3C10297.41,-4282.34 10254.51,-4277.88 10214,-4274.83 9369.31,-4211.2 6817.75,-4183.29 5852.45,-4174.81"/>
<polygon fill="black" stroke="black" points="5852.26,-4171.31 5842.22,-4174.72 5852.19,-4178.31 5852.26,-4171.31"/>
</g>
<!-- layer13_gpu15_expert_mlp1 -->
<g id="node1256" class="node">
<title>layer13_gpu15_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="11313.5,-4683 10852.5,-4683 10852.5,-4615 11313.5,-4615 11313.5,-4683"/>
<text text-anchor="middle" x="11083" y="-4667.8" font-family="Times,serif" font-size="14.00">Expert 15 MLP1</text>
<text text-anchor="middle" x="11083" y="-4652.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="11083" y="-4637.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11083" y="-4622.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer13_gpu15_token_recv&#45;&gt;layer13_gpu15_expert_mlp1 -->
<g id="edge1465" class="edge">
<title>layer13_gpu15_token_recv&#45;&gt;layer13_gpu15_expert_mlp1</title>
<path fill="none" stroke="black" d="M11067.58,-4718.87C11069.47,-4710.39 11071.44,-4701.59 11073.32,-4693.23"/>
<polygon fill="black" stroke="black" points="11076.77,-4693.83 11075.54,-4683.3 11069.94,-4692.3 11076.77,-4693.83"/>
</g>
<!-- layer13_gpu15_expert_act -->
<g id="node1257" class="node">
<title>layer13_gpu15_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="11334.5,-4579 10957.5,-4579 10957.5,-4511 11334.5,-4511 11334.5,-4579"/>
<text text-anchor="middle" x="11146" y="-4563.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="11146" y="-4548.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11146" y="-4533.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11146" y="-4518.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer13_gpu15_expert_mlp1&#45;&gt;layer13_gpu15_expert_act -->
<g id="edge1466" class="edge">
<title>layer13_gpu15_expert_mlp1&#45;&gt;layer13_gpu15_expert_act</title>
<path fill="none" stroke="black" d="M11103.45,-4614.88C11108.74,-4606.33 11114.49,-4597.01 11120.01,-4588.07"/>
<polygon fill="black" stroke="black" points="11123.16,-4589.65 11125.43,-4579.3 11117.2,-4585.97 11123.16,-4589.65"/>
</g>
<!-- layer13_gpu15_expert_mlp2 -->
<g id="node1258" class="node">
<title>layer13_gpu15_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="11474.5,-4475 11067.5,-4475 11067.5,-4407 11474.5,-4407 11474.5,-4475"/>
<text text-anchor="middle" x="11271" y="-4459.8" font-family="Times,serif" font-size="14.00">Expert 15 MLP2</text>
<text text-anchor="middle" x="11271" y="-4444.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11271" y="-4429.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="11271" y="-4414.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer13_gpu15_expert_act&#45;&gt;layer13_gpu15_expert_mlp2 -->
<g id="edge1467" class="edge">
<title>layer13_gpu15_expert_act&#45;&gt;layer13_gpu15_expert_mlp2</title>
<path fill="none" stroke="black" d="M11186.58,-4510.88C11197.94,-4501.62 11210.39,-4491.45 11222.17,-4481.84"/>
<polygon fill="black" stroke="black" points="11224.66,-4484.33 11230.19,-4475.3 11220.23,-4478.91 11224.66,-4484.33"/>
</g>
<!-- layer13_gpu15_token_send -->
<g id="node1259" class="node">
<title>layer13_gpu15_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="11307" cy="-4322.92" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="11307" y="-4341.72" font-family="Times,serif" font-size="14.00">Token Send GPU15</text>
<text text-anchor="middle" x="11307" y="-4326.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="11307" y="-4311.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="11307" y="-4296.72" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer13_gpu15_expert_mlp2&#45;&gt;layer13_gpu15_token_send -->
<g id="edge1468" class="edge">
<title>layer13_gpu15_expert_mlp2&#45;&gt;layer13_gpu15_token_send</title>
<path fill="none" stroke="black" d="M11281.32,-4406.73C11283.85,-4398.57 11286.63,-4389.59 11289.4,-4380.66"/>
<polygon fill="black" stroke="black" points="11292.77,-4381.61 11292.39,-4371.03 11286.09,-4379.54 11292.77,-4381.61"/>
</g>
<!-- layer13_gpu15_token_send&#45;&gt;layer13_expert_agg -->
<g id="edge1469" class="edge">
<title>layer13_gpu15_token_send&#45;&gt;layer13_expert_agg</title>
<path fill="none" stroke="black" d="M11068.02,-4287.2C11026.42,-4282.25 10983.51,-4277.83 10943,-4274.83 9950.22,-4201.49 6914.36,-4179.19 5850.26,-4173.52"/>
<polygon fill="black" stroke="black" points="5850.17,-4170.02 5840.15,-4173.47 5850.13,-4177.02 5850.17,-4170.02"/>
</g>
<!-- layer13_residual2 -->
<g id="node1261" class="node">
<title>layer13_residual2</title>
<polygon fill="lightyellow" stroke="black" points="5919.89,-4066.83 5215.35,-4066.83 5034.11,-3930.83 5738.65,-3930.83 5919.89,-4066.83"/>
<text text-anchor="middle" x="5477" y="-4017.63" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="5477" y="-4002.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5477" y="-3987.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-3972.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer13_expert_agg&#45;&gt;layer13_residual2 -->
<g id="edge1470" class="edge">
<title>layer13_expert_agg&#45;&gt;layer13_residual2</title>
<path fill="none" stroke="black" d="M5477,-4102.64C5477,-4094.33 5477,-4085.78 5477,-4077.33"/>
<polygon fill="black" stroke="black" points="5480.5,-4077.09 5477,-4067.09 5473.5,-4077.09 5480.5,-4077.09"/>
</g>
<!-- layer14_layernorm -->
<g id="node1262" class="node">
<title>layer14_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="5680.5,-3883.83 5273.5,-3883.83 5273.5,-3815.83 5680.5,-3815.83 5680.5,-3883.83"/>
<text text-anchor="middle" x="5477" y="-3868.63" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5477" y="-3853.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-3838.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-3823.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer13_residual2&#45;&gt;layer14_layernorm -->
<g id="edge1471" class="edge">
<title>layer13_residual2&#45;&gt;layer14_layernorm</title>
<path fill="none" stroke="black" d="M5477,-3930.79C5477,-3918.38 5477,-3905.72 5477,-3894.25"/>
<polygon fill="black" stroke="black" points="5480.5,-3894.09 5477,-3884.09 5473.5,-3894.09 5480.5,-3894.09"/>
</g>
<!-- layer14_qkv_proj -->
<g id="node1263" class="node">
<title>layer14_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="5734.5,-3779.83 5219.5,-3779.83 5219.5,-3711.83 5734.5,-3711.83 5734.5,-3779.83"/>
<text text-anchor="middle" x="5477" y="-3764.63" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5477" y="-3749.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-3734.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5477" y="-3719.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer14_layernorm&#45;&gt;layer14_qkv_proj -->
<g id="edge1472" class="edge">
<title>layer14_layernorm&#45;&gt;layer14_qkv_proj</title>
<path fill="none" stroke="black" d="M5477,-3815.72C5477,-3807.61 5477,-3798.81 5477,-3790.3"/>
<polygon fill="black" stroke="black" points="5480.5,-3790.13 5477,-3780.13 5473.5,-3790.13 5480.5,-3790.13"/>
</g>
<!-- layer14_attention -->
<g id="node1264" class="node">
<title>layer14_attention</title>
<polygon fill="lightgreen" stroke="black" points="5728.5,-3675.83 5225.5,-3675.83 5225.5,-3607.83 5728.5,-3607.83 5728.5,-3675.83"/>
<text text-anchor="middle" x="5477" y="-3660.63" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5477" y="-3645.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5477" y="-3630.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5477" y="-3615.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer14_qkv_proj&#45;&gt;layer14_attention -->
<g id="edge1473" class="edge">
<title>layer14_qkv_proj&#45;&gt;layer14_attention</title>
<path fill="none" stroke="black" d="M5477,-3711.72C5477,-3703.61 5477,-3694.81 5477,-3686.3"/>
<polygon fill="black" stroke="black" points="5480.5,-3686.13 5477,-3676.13 5473.5,-3686.13 5480.5,-3686.13"/>
</g>
<!-- layer14_attn_out -->
<g id="node1265" class="node">
<title>layer14_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="5715.5,-3571.83 5238.5,-3571.83 5238.5,-3503.83 5715.5,-3503.83 5715.5,-3571.83"/>
<text text-anchor="middle" x="5477" y="-3556.63" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5477" y="-3541.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5477" y="-3526.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-3511.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer14_attention&#45;&gt;layer14_attn_out -->
<g id="edge1474" class="edge">
<title>layer14_attention&#45;&gt;layer14_attn_out</title>
<path fill="none" stroke="black" d="M5477,-3607.72C5477,-3599.61 5477,-3590.81 5477,-3582.3"/>
<polygon fill="black" stroke="black" points="5480.5,-3582.13 5477,-3572.13 5473.5,-3582.13 5480.5,-3582.13"/>
</g>
<!-- layer14_residual1 -->
<g id="node1266" class="node">
<title>layer14_residual1</title>
<polygon fill="lightyellow" stroke="black" points="5919.89,-3467.83 5215.35,-3467.83 5034.11,-3331.83 5738.65,-3331.83 5919.89,-3467.83"/>
<text text-anchor="middle" x="5477" y="-3418.63" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5477" y="-3403.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5477" y="-3388.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-3373.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer14_attn_out&#45;&gt;layer14_residual1 -->
<g id="edge1475" class="edge">
<title>layer14_attn_out&#45;&gt;layer14_residual1</title>
<path fill="none" stroke="black" d="M5477,-3503.56C5477,-3495.74 5477,-3487.07 5477,-3478.18"/>
<polygon fill="black" stroke="black" points="5480.5,-3478.1 5477,-3468.1 5473.5,-3478.1 5480.5,-3478.1"/>
</g>
<!-- layer14_layernorm2 -->
<g id="node1267" class="node">
<title>layer14_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="5680.5,-3295.83 5273.5,-3295.83 5273.5,-3227.83 5680.5,-3227.83 5680.5,-3295.83"/>
<text text-anchor="middle" x="5477" y="-3280.63" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5477" y="-3265.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-3250.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-3235.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer14_residual1&#45;&gt;layer14_layernorm2 -->
<g id="edge1476" class="edge">
<title>layer14_residual1&#45;&gt;layer14_layernorm2</title>
<path fill="none" stroke="black" d="M5477,-3331.63C5477,-3322.88 5477,-3314.11 5477,-3305.9"/>
<polygon fill="black" stroke="black" points="5480.5,-3305.85 5477,-3295.85 5473.5,-3305.85 5480.5,-3305.85"/>
</g>
<!-- layer14_global_gate -->
<g id="node1268" class="node">
<title>layer14_global_gate</title>
<polygon fill="lightgreen" stroke="black" points="5674.5,-3191.83 5279.5,-3191.83 5279.5,-3123.83 5674.5,-3123.83 5674.5,-3191.83"/>
<text text-anchor="middle" x="5477" y="-3176.63" font-family="Times,serif" font-size="14.00">Global Gate</text>
<text text-anchor="middle" x="5477" y="-3161.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-3146.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, experts=64]</text>
<text text-anchor="middle" x="5477" y="-3131.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer14_layernorm2&#45;&gt;layer14_global_gate -->
<g id="edge1477" class="edge">
<title>layer14_layernorm2&#45;&gt;layer14_global_gate</title>
<path fill="none" stroke="black" d="M5477,-3227.72C5477,-3219.61 5477,-3210.81 5477,-3202.3"/>
<polygon fill="black" stroke="black" points="5480.5,-3202.13 5477,-3192.13 5473.5,-3202.13 5480.5,-3202.13"/>
</g>
<!-- layer14_routing -->
<g id="node1269" class="node">
<title>layer14_routing</title>
<polygon fill="lightyellow" stroke="black" points="5963.47,-3087.83 5189.6,-3087.83 4990.53,-2951.83 5764.4,-2951.83 5963.47,-3087.83"/>
<text text-anchor="middle" x="5477" y="-3038.63" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="5477" y="-3023.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-3008.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5477" y="-2993.63" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer14_global_gate&#45;&gt;layer14_routing -->
<g id="edge1478" class="edge">
<title>layer14_global_gate&#45;&gt;layer14_routing</title>
<path fill="none" stroke="black" d="M5477,-3123.56C5477,-3115.74 5477,-3107.07 5477,-3098.18"/>
<polygon fill="black" stroke="black" points="5480.5,-3098.1 5477,-3088.1 5473.5,-3098.1 5480.5,-3098.1"/>
</g>
<!-- layer14_gpu0_token_recv -->
<g id="node1270" class="node">
<title>layer14_gpu0_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="625" cy="-2867.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="625" y="-2886.55" font-family="Times,serif" font-size="14.00">Token Receive GPU0</text>
<text text-anchor="middle" x="625" y="-2871.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="625" y="-2856.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="625" y="-2841.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer14_routing&#45;&gt;layer14_gpu0_token_recv -->
<g id="edge1479" class="edge">
<title>layer14_routing&#45;&gt;layer14_gpu0_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5082.9,-3015.1C4141.17,-3005.31 1779.95,-2975.47 991,-2915.83 951.02,-2912.81 908.71,-2908.45 867.6,-2903.59"/>
<polygon fill="black" stroke="black" points="867.8,-2900.09 857.45,-2902.38 866.97,-2907.04 867.8,-2900.09"/>
</g>
<!-- layer14_gpu1_token_recv -->
<g id="node1275" class="node">
<title>layer14_gpu1_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1334" cy="-2867.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1334" y="-2886.55" font-family="Times,serif" font-size="14.00">Token Receive GPU1</text>
<text text-anchor="middle" x="1334" y="-2871.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1334" y="-2856.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1334" y="-2841.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer14_routing&#45;&gt;layer14_gpu1_token_recv -->
<g id="edge1485" class="edge">
<title>layer14_routing&#45;&gt;layer14_gpu1_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5080.19,-3013.31C4246.78,-3000.85 2337.84,-2967.54 1689,-2915.83 1651.74,-2912.86 1612.39,-2908.69 1574,-2904.05"/>
<polygon fill="black" stroke="black" points="1574.09,-2900.53 1563.74,-2902.79 1573.24,-2907.48 1574.09,-2900.53"/>
</g>
<!-- layer14_gpu2_token_recv -->
<g id="node1280" class="node">
<title>layer14_gpu2_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="2032" cy="-2867.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2032" y="-2886.55" font-family="Times,serif" font-size="14.00">Token Receive GPU2</text>
<text text-anchor="middle" x="2032" y="-2871.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="2032" y="-2856.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2032" y="-2841.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer14_routing&#45;&gt;layer14_gpu2_token_recv -->
<g id="edge1491" class="edge">
<title>layer14_routing&#45;&gt;layer14_gpu2_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5088.01,-3018.46C4500.59,-3015.05 3352.51,-2997.32 2381,-2915.83 2345.36,-2912.84 2307.78,-2908.76 2271.02,-2904.24"/>
<polygon fill="black" stroke="black" points="2271.02,-2900.72 2260.67,-2902.96 2270.16,-2907.66 2271.02,-2900.72"/>
</g>
<!-- layer14_gpu3_token_recv -->
<g id="node1285" class="node">
<title>layer14_gpu3_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="2724" cy="-2867.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2724" y="-2886.55" font-family="Times,serif" font-size="14.00">Token Receive GPU3</text>
<text text-anchor="middle" x="2724" y="-2871.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="2724" y="-2856.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2724" y="-2841.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer14_routing&#45;&gt;layer14_gpu3_token_recv -->
<g id="edge1497" class="edge">
<title>layer14_routing&#45;&gt;layer14_gpu3_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5080.06,-3013.03C4602.47,-3003.46 3776.74,-2978.68 3071,-2915.83 3035.99,-2912.71 2999.1,-2908.6 2962.95,-2904.11"/>
<polygon fill="black" stroke="black" points="2963.14,-2900.6 2952.78,-2902.83 2962.27,-2907.55 2963.14,-2900.6"/>
</g>
<!-- layer14_gpu4_token_recv -->
<g id="node1290" class="node">
<title>layer14_gpu4_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="3414" cy="-2867.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="3414" y="-2886.55" font-family="Times,serif" font-size="14.00">Token Receive GPU4</text>
<text text-anchor="middle" x="3414" y="-2871.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="3414" y="-2856.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3414" y="-2841.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer14_routing&#45;&gt;layer14_gpu4_token_recv -->
<g id="edge1503" class="edge">
<title>layer14_routing&#45;&gt;layer14_gpu4_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5064.96,-3002.9C4716.51,-2987.33 4204.32,-2959.51 3759,-2915.83 3725.19,-2912.52 3689.59,-2908.39 3654.63,-2903.96"/>
<polygon fill="black" stroke="black" points="3654.66,-2900.44 3644.3,-2902.64 3653.77,-2907.38 3654.66,-2900.44"/>
</g>
<!-- layer14_gpu5_token_recv -->
<g id="node1295" class="node">
<title>layer14_gpu5_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4102" cy="-2867.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4102" y="-2886.55" font-family="Times,serif" font-size="14.00">Token Receive GPU5</text>
<text text-anchor="middle" x="4102" y="-2871.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4102" y="-2856.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4102" y="-2841.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer14_routing&#45;&gt;layer14_gpu5_token_recv -->
<g id="edge1509" class="edge">
<title>layer14_routing&#45;&gt;layer14_gpu5_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5027.93,-2977.46C4847.26,-2959.9 4637.07,-2938.3 4447,-2915.83 4414.63,-2912.01 4380.58,-2907.7 4347.01,-2903.29"/>
<polygon fill="black" stroke="black" points="4347.45,-2899.82 4337.08,-2901.98 4346.54,-2906.76 4347.45,-2899.82"/>
</g>
<!-- layer14_gpu6_token_recv -->
<g id="node1300" class="node">
<title>layer14_gpu6_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4790" cy="-2867.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4790" y="-2886.55" font-family="Times,serif" font-size="14.00">Token Receive GPU6</text>
<text text-anchor="middle" x="4790" y="-2871.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4790" y="-2856.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4790" y="-2841.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer14_routing&#45;&gt;layer14_gpu6_token_recv -->
<g id="edge1515" class="edge">
<title>layer14_routing&#45;&gt;layer14_gpu6_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5170.17,-2951.8C5105.78,-2937.74 5039.66,-2923.29 4980.98,-2910.47"/>
<polygon fill="black" stroke="black" points="4981.39,-2906.98 4970.88,-2908.26 4979.9,-2913.82 4981.39,-2906.98"/>
</g>
<!-- layer14_gpu7_token_recv -->
<g id="node1305" class="node">
<title>layer14_gpu7_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="5477" cy="-2867.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="5477" y="-2886.55" font-family="Times,serif" font-size="14.00">Token Receive GPU7</text>
<text text-anchor="middle" x="5477" y="-2871.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5477" y="-2856.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5477" y="-2841.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer14_routing&#45;&gt;layer14_gpu7_token_recv -->
<g id="edge1521" class="edge">
<title>layer14_routing&#45;&gt;layer14_gpu7_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5477,-2951.69C5477,-2943.15 5477,-2934.46 5477,-2926.09"/>
<polygon fill="black" stroke="black" points="5480.5,-2926.07 5477,-2916.07 5473.5,-2926.07 5480.5,-2926.07"/>
</g>
<!-- layer14_gpu8_token_recv -->
<g id="node1310" class="node">
<title>layer14_gpu8_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6180" cy="-2867.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6180" y="-2886.55" font-family="Times,serif" font-size="14.00">Token Receive GPU8</text>
<text text-anchor="middle" x="6180" y="-2871.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6180" y="-2856.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6180" y="-2841.55" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer14_routing&#45;&gt;layer14_gpu8_token_recv -->
<g id="edge1527" class="edge">
<title>layer14_routing&#45;&gt;layer14_gpu8_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5770.81,-2956.11C5843.48,-2940.59 5919.54,-2924.36 5986.09,-2910.15"/>
<polygon fill="black" stroke="black" points="5987.21,-2913.49 5996.26,-2907.98 5985.75,-2906.64 5987.21,-2913.49"/>
</g>
<!-- layer14_gpu9_token_recv -->
<g id="node1315" class="node">
<title>layer14_gpu9_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6875" cy="-2867.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6875" y="-2886.55" font-family="Times,serif" font-size="14.00">Token Receive GPU9</text>
<text text-anchor="middle" x="6875" y="-2871.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6875" y="-2856.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6875" y="-2841.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer14_routing&#45;&gt;layer14_gpu9_token_recv -->
<g id="edge1533" class="edge">
<title>layer14_routing&#45;&gt;layer14_gpu9_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5817.97,-2988.28C6022.59,-2969.19 6287.93,-2943.12 6523,-2915.83 6556.72,-2911.92 6592.23,-2907.51 6627.18,-2903"/>
<polygon fill="black" stroke="black" points="6628.05,-2906.42 6637.51,-2901.66 6627.15,-2899.47 6628.05,-2906.42"/>
</g>
<!-- layer14_gpu10_token_recv -->
<g id="node1320" class="node">
<title>layer14_gpu10_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="7566" cy="-2867.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="7566" y="-2886.55" font-family="Times,serif" font-size="14.00">Token Receive GPU10</text>
<text text-anchor="middle" x="7566" y="-2871.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="7566" y="-2856.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7566" y="-2841.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer14_routing&#45;&gt;layer14_gpu10_token_recv -->
<g id="edge1539" class="edge">
<title>layer14_routing&#45;&gt;layer14_gpu10_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5842.76,-3005.22C6195.49,-2990.19 6744.1,-2961.84 7218,-2915.83 7252.53,-2912.48 7288.9,-2908.29 7324.59,-2903.81"/>
<polygon fill="black" stroke="black" points="7325.15,-2907.26 7334.63,-2902.53 7324.27,-2900.32 7325.15,-2907.26"/>
</g>
<!-- layer14_gpu11_token_recv -->
<g id="node1325" class="node">
<title>layer14_gpu11_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8255" cy="-2867.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8255" y="-2886.55" font-family="Times,serif" font-size="14.00">Token Receive GPU11</text>
<text text-anchor="middle" x="8255" y="-2871.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8255" y="-2856.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8255" y="-2841.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer14_routing&#45;&gt;layer14_gpu11_token_recv -->
<g id="edge1545" class="edge">
<title>layer14_routing&#45;&gt;layer14_gpu11_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5855.02,-3013.69C6333.87,-3004.69 7184.07,-2980.37 7909,-2915.83 7943.77,-2912.74 7980.41,-2908.65 8016.31,-2904.18"/>
<polygon fill="black" stroke="black" points="8016.93,-2907.63 8026.42,-2902.91 8016.06,-2900.68 8016.93,-2907.63"/>
</g>
<!-- layer14_gpu12_token_recv -->
<g id="node1330" class="node">
<title>layer14_gpu12_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8943" cy="-2867.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8943" y="-2886.55" font-family="Times,serif" font-size="14.00">Token Receive GPU12</text>
<text text-anchor="middle" x="8943" y="-2871.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8943" y="-2856.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8943" y="-2841.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer14_routing&#45;&gt;layer14_gpu12_token_recv -->
<g id="edge1551" class="edge">
<title>layer14_routing&#45;&gt;layer14_gpu12_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5862.73,-3018.81C6452.94,-3015.92 7615.16,-2998.9 8598,-2915.83 8632.96,-2912.88 8669.81,-2908.84 8705.88,-2904.37"/>
<polygon fill="black" stroke="black" points="8706.55,-2907.81 8716.03,-2903.1 8705.68,-2900.87 8706.55,-2907.81"/>
</g>
<!-- layer14_gpu13_token_recv -->
<g id="node1335" class="node">
<title>layer14_gpu13_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="9630" cy="-2867.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="9630" y="-2886.55" font-family="Times,serif" font-size="14.00">Token Receive GPU13</text>
<text text-anchor="middle" x="9630" y="-2871.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="9630" y="-2856.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9630" y="-2841.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer14_routing&#45;&gt;layer14_gpu13_token_recv -->
<g id="edge1557" class="edge">
<title>layer14_routing&#45;&gt;layer14_gpu13_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5855.22,-3013.85C6681.87,-3002.12 8628.22,-2969.58 9286,-2915.83 9321.01,-2912.97 9357.9,-2908.97 9394.01,-2904.51"/>
<polygon fill="black" stroke="black" points="9394.69,-2907.95 9404.17,-2903.23 9393.82,-2901 9394.69,-2907.95"/>
</g>
<!-- layer14_gpu14_token_recv -->
<g id="node1340" class="node">
<title>layer14_gpu14_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10317" cy="-2867.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10317" y="-2886.55" font-family="Times,serif" font-size="14.00">Token Receive GPU14</text>
<text text-anchor="middle" x="10317" y="-2871.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10317" y="-2856.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10317" y="-2841.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_routing&#45;&gt;layer14_gpu14_token_recv -->
<g id="edge1563" class="edge">
<title>layer14_routing&#45;&gt;layer14_gpu14_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5858.17,-3015.65C6792.57,-3006.95 9178.65,-2979.09 9973,-2915.83 10008.15,-2913.03 10045.2,-2909.05 10081.45,-2904.58"/>
<polygon fill="black" stroke="black" points="10082.16,-2908.02 10091.65,-2903.31 10081.29,-2901.07 10082.16,-2908.02"/>
</g>
<!-- layer14_gpu15_token_recv -->
<g id="node1345" class="node">
<title>layer14_gpu15_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="11004" cy="-2867.75" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="11004" y="-2886.55" font-family="Times,serif" font-size="14.00">Token Receive GPU15</text>
<text text-anchor="middle" x="11004" y="-2871.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="11004" y="-2856.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="11004" y="-2841.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer14_routing&#45;&gt;layer14_gpu15_token_recv -->
<g id="edge1569" class="edge">
<title>layer14_routing&#45;&gt;layer14_gpu15_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5860.16,-3017C6894.44,-3011.11 9727.82,-2988.64 10660,-2915.83 10695.29,-2913.08 10732.5,-2909.11 10768.88,-2904.63"/>
<polygon fill="black" stroke="black" points="10769.63,-2908.06 10779.12,-2903.35 10768.76,-2901.11 10769.63,-2908.06"/>
</g>
<!-- layer14_gpu0_expert_mlp1 -->
<g id="node1271" class="node">
<title>layer14_gpu0_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="855.5,-2783.67 394.5,-2783.67 394.5,-2715.67 855.5,-2715.67 855.5,-2783.67"/>
<text text-anchor="middle" x="625" y="-2768.47" font-family="Times,serif" font-size="14.00">Expert 0 MLP1</text>
<text text-anchor="middle" x="625" y="-2753.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="625" y="-2738.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="625" y="-2723.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer14_gpu0_token_recv&#45;&gt;layer14_gpu0_expert_mlp1 -->
<g id="edge1480" class="edge">
<title>layer14_gpu0_token_recv&#45;&gt;layer14_gpu0_expert_mlp1</title>
<path fill="none" stroke="black" d="M625,-2819.53C625,-2811.15 625,-2802.45 625,-2794.17"/>
<polygon fill="black" stroke="black" points="628.5,-2793.97 625,-2783.97 621.5,-2793.97 628.5,-2793.97"/>
</g>
<!-- layer14_gpu0_expert_act -->
<g id="node1272" class="node">
<title>layer14_gpu0_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="748.5,-2679.67 371.5,-2679.67 371.5,-2611.67 748.5,-2611.67 748.5,-2679.67"/>
<text text-anchor="middle" x="560" y="-2664.47" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="560" y="-2649.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="560" y="-2634.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="560" y="-2619.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer14_gpu0_expert_mlp1&#45;&gt;layer14_gpu0_expert_act -->
<g id="edge1481" class="edge">
<title>layer14_gpu0_expert_mlp1&#45;&gt;layer14_gpu0_expert_act</title>
<path fill="none" stroke="black" d="M603.9,-2715.55C598.39,-2706.91 592.38,-2697.49 586.63,-2688.46"/>
<polygon fill="black" stroke="black" points="589.55,-2686.52 581.22,-2679.97 583.64,-2690.28 589.55,-2686.52"/>
</g>
<!-- layer14_gpu0_expert_mlp2 -->
<g id="node1273" class="node">
<title>layer14_gpu0_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="700.5,-2575.67 293.5,-2575.67 293.5,-2507.67 700.5,-2507.67 700.5,-2575.67"/>
<text text-anchor="middle" x="497" y="-2560.47" font-family="Times,serif" font-size="14.00">Expert 0 MLP2</text>
<text text-anchor="middle" x="497" y="-2545.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="497" y="-2530.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="497" y="-2515.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer14_gpu0_expert_act&#45;&gt;layer14_gpu0_expert_mlp2 -->
<g id="edge1482" class="edge">
<title>layer14_gpu0_expert_act&#45;&gt;layer14_gpu0_expert_mlp2</title>
<path fill="none" stroke="black" d="M539.55,-2611.55C534.26,-2603 528.51,-2593.68 522.99,-2584.74"/>
<polygon fill="black" stroke="black" points="525.8,-2582.63 517.57,-2575.97 519.84,-2586.31 525.8,-2582.63"/>
</g>
<!-- layer14_gpu0_token_send -->
<g id="node1274" class="node">
<title>layer14_gpu0_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="372" cy="-2423.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="372" y="-2442.38" font-family="Times,serif" font-size="14.00">Token Send GPU0</text>
<text text-anchor="middle" x="372" y="-2427.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="372" y="-2412.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="372" y="-2397.38" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer14_gpu0_expert_mlp2&#45;&gt;layer14_gpu0_token_send -->
<g id="edge1483" class="edge">
<title>layer14_gpu0_expert_mlp2&#45;&gt;layer14_gpu0_token_send</title>
<path fill="none" stroke="black" d="M461.18,-2507.4C451.33,-2498.26 440.4,-2488.1 429.65,-2478.12"/>
<polygon fill="black" stroke="black" points="431.97,-2475.5 422.26,-2471.26 427.21,-2480.63 431.97,-2475.5"/>
</g>
<!-- layer14_expert_agg -->
<g id="node1350" class="node">
<title>layer14_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="5929.05,-2339.5 5209.94,-2339.5 5024.95,-2203.5 5744.06,-2203.5 5929.05,-2339.5"/>
<text text-anchor="middle" x="5477" y="-2290.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5477" y="-2275.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x16)</text>
<text text-anchor="middle" x="5477" y="-2260.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-2245.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer14_gpu0_token_send&#45;&gt;layer14_expert_agg -->
<g id="edge1484" class="edge">
<title>layer14_gpu0_token_send&#45;&gt;layer14_expert_agg</title>
<path fill="none" stroke="black" d="M610.99,-2387.97C652.59,-2383 695.49,-2378.55 736,-2375.5 1584.6,-2311.58 4154.44,-2283.73 5112.12,-2275.37"/>
<polygon fill="black" stroke="black" points="5112.29,-2278.87 5122.26,-2275.29 5112.23,-2271.87 5112.29,-2278.87"/>
</g>
<!-- layer14_gpu1_expert_mlp1 -->
<g id="node1276" class="node">
<title>layer14_gpu1_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="1449.5,-2783.67 988.5,-2783.67 988.5,-2715.67 1449.5,-2715.67 1449.5,-2783.67"/>
<text text-anchor="middle" x="1219" y="-2768.47" font-family="Times,serif" font-size="14.00">Expert 1 MLP1</text>
<text text-anchor="middle" x="1219" y="-2753.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1219" y="-2738.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1219" y="-2723.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer14_gpu1_token_recv&#45;&gt;layer14_gpu1_expert_mlp1 -->
<g id="edge1486" class="edge">
<title>layer14_gpu1_token_recv&#45;&gt;layer14_gpu1_expert_mlp1</title>
<path fill="none" stroke="black" d="M1287.56,-2819.87C1278.11,-2810.34 1268.25,-2800.38 1259.06,-2791.1"/>
<polygon fill="black" stroke="black" points="1261.36,-2788.46 1251.84,-2783.81 1256.39,-2793.38 1261.36,-2788.46"/>
</g>
<!-- layer14_gpu1_expert_act -->
<g id="node1277" class="node">
<title>layer14_gpu1_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="1376.5,-2679.67 999.5,-2679.67 999.5,-2611.67 1376.5,-2611.67 1376.5,-2679.67"/>
<text text-anchor="middle" x="1188" y="-2664.47" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1188" y="-2649.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1188" y="-2634.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1188" y="-2619.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer14_gpu1_expert_mlp1&#45;&gt;layer14_gpu1_expert_act -->
<g id="edge1487" class="edge">
<title>layer14_gpu1_expert_mlp1&#45;&gt;layer14_gpu1_expert_act</title>
<path fill="none" stroke="black" d="M1208.94,-2715.55C1206.42,-2707.27 1203.68,-2698.26 1201.04,-2689.58"/>
<polygon fill="black" stroke="black" points="1204.38,-2688.52 1198.12,-2679.97 1197.68,-2690.55 1204.38,-2688.52"/>
</g>
<!-- layer14_gpu1_expert_mlp2 -->
<g id="node1278" class="node">
<title>layer14_gpu1_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="1362.5,-2575.67 955.5,-2575.67 955.5,-2507.67 1362.5,-2507.67 1362.5,-2575.67"/>
<text text-anchor="middle" x="1159" y="-2560.47" font-family="Times,serif" font-size="14.00">Expert 1 MLP2</text>
<text text-anchor="middle" x="1159" y="-2545.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1159" y="-2530.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1159" y="-2515.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer14_gpu1_expert_act&#45;&gt;layer14_gpu1_expert_mlp2 -->
<g id="edge1488" class="edge">
<title>layer14_gpu1_expert_act&#45;&gt;layer14_gpu1_expert_mlp2</title>
<path fill="none" stroke="black" d="M1178.58,-2611.55C1176.25,-2603.35 1173.72,-2594.45 1171.28,-2585.86"/>
<polygon fill="black" stroke="black" points="1174.57,-2584.63 1168.47,-2575.97 1167.84,-2586.54 1174.57,-2584.63"/>
</g>
<!-- layer14_gpu1_token_send -->
<g id="node1279" class="node">
<title>layer14_gpu1_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1101" cy="-2423.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1101" y="-2442.38" font-family="Times,serif" font-size="14.00">Token Send GPU1</text>
<text text-anchor="middle" x="1101" y="-2427.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1101" y="-2412.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1101" y="-2397.38" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer14_gpu1_expert_mlp2&#45;&gt;layer14_gpu1_token_send -->
<g id="edge1489" class="edge">
<title>layer14_gpu1_expert_mlp2&#45;&gt;layer14_gpu1_token_send</title>
<path fill="none" stroke="black" d="M1142.38,-2507.4C1138.21,-2499.06 1133.62,-2489.88 1129.07,-2480.76"/>
<polygon fill="black" stroke="black" points="1132.14,-2479.07 1124.54,-2471.69 1125.88,-2482.2 1132.14,-2479.07"/>
</g>
<!-- layer14_gpu1_token_send&#45;&gt;layer14_expert_agg -->
<g id="edge1490" class="edge">
<title>layer14_gpu1_token_send&#45;&gt;layer14_expert_agg</title>
<path fill="none" stroke="black" d="M1340.98,-2387.98C1382.27,-2383.05 1424.82,-2378.61 1465,-2375.5 2167.7,-2321.18 4265.31,-2288.39 5114.3,-2277.02"/>
<polygon fill="black" stroke="black" points="5114.59,-2280.52 5124.54,-2276.89 5114.49,-2273.52 5114.59,-2280.52"/>
</g>
<!-- layer14_gpu2_expert_mlp1 -->
<g id="node1281" class="node">
<title>layer14_gpu2_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2235.5,-2783.67 1774.5,-2783.67 1774.5,-2715.67 2235.5,-2715.67 2235.5,-2783.67"/>
<text text-anchor="middle" x="2005" y="-2768.47" font-family="Times,serif" font-size="14.00">Expert 2 MLP1</text>
<text text-anchor="middle" x="2005" y="-2753.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2005" y="-2738.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2005" y="-2723.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer14_gpu2_token_recv&#45;&gt;layer14_gpu2_expert_mlp1 -->
<g id="edge1492" class="edge">
<title>layer14_gpu2_token_recv&#45;&gt;layer14_gpu2_expert_mlp1</title>
<path fill="none" stroke="black" d="M2021.02,-2819.53C2019.05,-2811.05 2017,-2802.26 2015.06,-2793.9"/>
<polygon fill="black" stroke="black" points="2018.42,-2792.92 2012.75,-2783.97 2011.6,-2794.5 2018.42,-2792.92"/>
</g>
<!-- layer14_gpu2_expert_act -->
<g id="node1282" class="node">
<title>layer14_gpu2_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2093.5,-2679.67 1716.5,-2679.67 1716.5,-2611.67 2093.5,-2611.67 2093.5,-2679.67"/>
<text text-anchor="middle" x="1905" y="-2664.47" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="1905" y="-2649.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1905" y="-2634.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1905" y="-2619.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer14_gpu2_expert_mlp1&#45;&gt;layer14_gpu2_expert_act -->
<g id="edge1493" class="edge">
<title>layer14_gpu2_expert_mlp1&#45;&gt;layer14_gpu2_expert_act</title>
<path fill="none" stroke="black" d="M1972.53,-2715.55C1963.71,-2706.55 1954.06,-2696.71 1944.88,-2687.34"/>
<polygon fill="black" stroke="black" points="1947.15,-2684.66 1937.65,-2679.97 1942.15,-2689.56 1947.15,-2684.66"/>
</g>
<!-- layer14_gpu2_expert_mlp2 -->
<g id="node1283" class="node">
<title>layer14_gpu2_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2083.5,-2575.67 1676.5,-2575.67 1676.5,-2507.67 2083.5,-2507.67 2083.5,-2575.67"/>
<text text-anchor="middle" x="1880" y="-2560.47" font-family="Times,serif" font-size="14.00">Expert 2 MLP2</text>
<text text-anchor="middle" x="1880" y="-2545.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1880" y="-2530.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1880" y="-2515.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer14_gpu2_expert_act&#45;&gt;layer14_gpu2_expert_mlp2 -->
<g id="edge1494" class="edge">
<title>layer14_gpu2_expert_act&#45;&gt;layer14_gpu2_expert_mlp2</title>
<path fill="none" stroke="black" d="M1896.88,-2611.55C1894.87,-2603.35 1892.69,-2594.45 1890.59,-2585.86"/>
<polygon fill="black" stroke="black" points="1893.94,-2584.84 1888.16,-2575.97 1887.14,-2586.51 1893.94,-2584.84"/>
</g>
<!-- layer14_gpu2_token_send -->
<g id="node1284" class="node">
<title>layer14_gpu2_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1830" cy="-2423.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1830" y="-2442.38" font-family="Times,serif" font-size="14.00">Token Send GPU2</text>
<text text-anchor="middle" x="1830" y="-2427.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1830" y="-2412.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1830" y="-2397.38" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer14_gpu2_expert_mlp2&#45;&gt;layer14_gpu2_token_send -->
<g id="edge1495" class="edge">
<title>layer14_gpu2_expert_mlp2&#45;&gt;layer14_gpu2_token_send</title>
<path fill="none" stroke="black" d="M1865.67,-2507.4C1862.12,-2499.15 1858.21,-2490.07 1854.32,-2481.04"/>
<polygon fill="black" stroke="black" points="1857.46,-2479.49 1850.29,-2471.69 1851.03,-2482.26 1857.46,-2479.49"/>
</g>
<!-- layer14_gpu2_token_send&#45;&gt;layer14_expert_agg -->
<g id="edge1496" class="edge">
<title>layer14_gpu2_token_send&#45;&gt;layer14_expert_agg</title>
<path fill="none" stroke="black" d="M2070.48,-2388.12C2111.62,-2383.19 2153.98,-2378.71 2194,-2375.5 3249.04,-2290.92 4499.98,-2274.84 5108.15,-2272.39"/>
<polygon fill="black" stroke="black" points="5108.41,-2275.89 5118.39,-2272.35 5108.38,-2268.89 5108.41,-2275.89"/>
</g>
<!-- layer14_gpu3_expert_mlp1 -->
<g id="node1286" class="node">
<title>layer14_gpu3_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2873.5,-2783.67 2412.5,-2783.67 2412.5,-2715.67 2873.5,-2715.67 2873.5,-2783.67"/>
<text text-anchor="middle" x="2643" y="-2768.47" font-family="Times,serif" font-size="14.00">Expert 3 MLP1</text>
<text text-anchor="middle" x="2643" y="-2753.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2643" y="-2738.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2643" y="-2723.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer14_gpu3_token_recv&#45;&gt;layer14_gpu3_expert_mlp1 -->
<g id="edge1498" class="edge">
<title>layer14_gpu3_token_recv&#45;&gt;layer14_gpu3_expert_mlp1</title>
<path fill="none" stroke="black" d="M2691.29,-2819.87C2684.9,-2810.71 2678.24,-2801.17 2671.98,-2792.21"/>
<polygon fill="black" stroke="black" points="2674.72,-2790.01 2666.13,-2783.81 2668.98,-2794.02 2674.72,-2790.01"/>
</g>
<!-- layer14_gpu3_expert_act -->
<g id="node1287" class="node">
<title>layer14_gpu3_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2808.5,-2679.67 2431.5,-2679.67 2431.5,-2611.67 2808.5,-2611.67 2808.5,-2679.67"/>
<text text-anchor="middle" x="2620" y="-2664.47" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="2620" y="-2649.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2620" y="-2634.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2620" y="-2619.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer14_gpu3_expert_mlp1&#45;&gt;layer14_gpu3_expert_act -->
<g id="edge1499" class="edge">
<title>layer14_gpu3_expert_mlp1&#45;&gt;layer14_gpu3_expert_act</title>
<path fill="none" stroke="black" d="M2635.53,-2715.55C2633.68,-2707.35 2631.68,-2698.45 2629.74,-2689.86"/>
<polygon fill="black" stroke="black" points="2633.12,-2688.95 2627.51,-2679.97 2626.29,-2690.49 2633.12,-2688.95"/>
</g>
<!-- layer14_gpu3_expert_mlp2 -->
<g id="node1288" class="node">
<title>layer14_gpu3_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2803.5,-2575.67 2396.5,-2575.67 2396.5,-2507.67 2803.5,-2507.67 2803.5,-2575.67"/>
<text text-anchor="middle" x="2600" y="-2560.47" font-family="Times,serif" font-size="14.00">Expert 3 MLP2</text>
<text text-anchor="middle" x="2600" y="-2545.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2600" y="-2530.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="2600" y="-2515.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer14_gpu3_expert_act&#45;&gt;layer14_gpu3_expert_mlp2 -->
<g id="edge1500" class="edge">
<title>layer14_gpu3_expert_act&#45;&gt;layer14_gpu3_expert_mlp2</title>
<path fill="none" stroke="black" d="M2613.51,-2611.55C2611.9,-2603.35 2610.15,-2594.45 2608.47,-2585.86"/>
<polygon fill="black" stroke="black" points="2611.89,-2585.11 2606.53,-2575.97 2605.02,-2586.45 2611.89,-2585.11"/>
</g>
<!-- layer14_gpu3_token_send -->
<g id="node1289" class="node">
<title>layer14_gpu3_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="2559" cy="-2423.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="2559" y="-2442.38" font-family="Times,serif" font-size="14.00">Token Send GPU3</text>
<text text-anchor="middle" x="2559" y="-2427.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="2559" y="-2412.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="2559" y="-2397.38" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer14_gpu3_expert_mlp2&#45;&gt;layer14_gpu3_token_send -->
<g id="edge1501" class="edge">
<title>layer14_gpu3_expert_mlp2&#45;&gt;layer14_gpu3_token_send</title>
<path fill="none" stroke="black" d="M2588.25,-2507.4C2585.37,-2499.23 2582.2,-2490.26 2579.04,-2481.33"/>
<polygon fill="black" stroke="black" points="2582.27,-2479.96 2575.64,-2471.69 2575.67,-2482.29 2582.27,-2479.96"/>
</g>
<!-- layer14_gpu3_token_send&#45;&gt;layer14_expert_agg -->
<g id="edge1502" class="edge">
<title>layer14_gpu3_token_send&#45;&gt;layer14_expert_agg</title>
<path fill="none" stroke="black" d="M2800.98,-2388.25C2841.65,-2383.35 2883.48,-2378.85 2923,-2375.5 3702.23,-2309.52 4618.9,-2285.57 5114.54,-2277.05"/>
<polygon fill="black" stroke="black" points="5114.77,-2280.55 5124.71,-2276.88 5114.65,-2273.55 5114.77,-2280.55"/>
</g>
<!-- layer14_gpu4_expert_mlp1 -->
<g id="node1291" class="node">
<title>layer14_gpu4_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="3626.5,-2783.67 3165.5,-2783.67 3165.5,-2715.67 3626.5,-2715.67 3626.5,-2783.67"/>
<text text-anchor="middle" x="3396" y="-2768.47" font-family="Times,serif" font-size="14.00">Expert 4 MLP1</text>
<text text-anchor="middle" x="3396" y="-2753.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3396" y="-2738.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3396" y="-2723.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer14_gpu4_token_recv&#45;&gt;layer14_gpu4_expert_mlp1 -->
<g id="edge1504" class="edge">
<title>layer14_gpu4_token_recv&#45;&gt;layer14_gpu4_expert_mlp1</title>
<path fill="none" stroke="black" d="M3406.68,-2819.53C3405.36,-2811.05 3404,-2802.26 3402.7,-2793.9"/>
<polygon fill="black" stroke="black" points="3406.16,-2793.32 3401.16,-2783.97 3399.24,-2794.39 3406.16,-2793.32"/>
</g>
<!-- layer14_gpu4_expert_act -->
<g id="node1292" class="node">
<title>layer14_gpu4_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="3569.5,-2679.67 3192.5,-2679.67 3192.5,-2611.67 3569.5,-2611.67 3569.5,-2679.67"/>
<text text-anchor="middle" x="3381" y="-2664.47" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="3381" y="-2649.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3381" y="-2634.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3381" y="-2619.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer14_gpu4_expert_mlp1&#45;&gt;layer14_gpu4_expert_act -->
<g id="edge1505" class="edge">
<title>layer14_gpu4_expert_mlp1&#45;&gt;layer14_gpu4_expert_act</title>
<path fill="none" stroke="black" d="M3391.13,-2715.55C3389.94,-2707.44 3388.64,-2698.65 3387.39,-2690.14"/>
<polygon fill="black" stroke="black" points="3390.81,-2689.35 3385.9,-2679.97 3383.89,-2690.37 3390.81,-2689.35"/>
</g>
<!-- layer14_gpu4_expert_mlp2 -->
<g id="node1293" class="node">
<title>layer14_gpu4_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="3553.5,-2575.67 3146.5,-2575.67 3146.5,-2507.67 3553.5,-2507.67 3553.5,-2575.67"/>
<text text-anchor="middle" x="3350" y="-2560.47" font-family="Times,serif" font-size="14.00">Expert 4 MLP2</text>
<text text-anchor="middle" x="3350" y="-2545.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3350" y="-2530.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="3350" y="-2515.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer14_gpu4_expert_act&#45;&gt;layer14_gpu4_expert_mlp2 -->
<g id="edge1506" class="edge">
<title>layer14_gpu4_expert_act&#45;&gt;layer14_gpu4_expert_mlp2</title>
<path fill="none" stroke="black" d="M3370.94,-2611.55C3368.42,-2603.27 3365.68,-2594.26 3363.04,-2585.58"/>
<polygon fill="black" stroke="black" points="3366.38,-2584.52 3360.12,-2575.97 3359.68,-2586.55 3366.38,-2584.52"/>
</g>
<!-- layer14_gpu4_token_send -->
<g id="node1294" class="node">
<title>layer14_gpu4_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="3288" cy="-2423.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="3288" y="-2442.38" font-family="Times,serif" font-size="14.00">Token Send GPU4</text>
<text text-anchor="middle" x="3288" y="-2427.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="3288" y="-2412.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="3288" y="-2397.38" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer14_gpu4_expert_mlp2&#45;&gt;layer14_gpu4_token_send -->
<g id="edge1507" class="edge">
<title>layer14_gpu4_expert_mlp2&#45;&gt;layer14_gpu4_token_send</title>
<path fill="none" stroke="black" d="M3332.23,-2507.4C3327.78,-2499.06 3322.87,-2489.88 3318,-2480.76"/>
<polygon fill="black" stroke="black" points="3320.96,-2478.86 3313.16,-2471.69 3314.79,-2482.16 3320.96,-2478.86"/>
</g>
<!-- layer14_gpu4_token_send&#45;&gt;layer14_expert_agg -->
<g id="edge1508" class="edge">
<title>layer14_gpu4_token_send&#45;&gt;layer14_expert_agg</title>
<path fill="none" stroke="black" d="M3531.99,-2388.56C3572.03,-2383.68 3613.14,-2379.1 3652,-2375.5 4162.99,-2328.09 4756.65,-2299.48 5124.62,-2284.83"/>
<polygon fill="black" stroke="black" points="5124.78,-2288.33 5134.63,-2284.43 5124.5,-2281.33 5124.78,-2288.33"/>
</g>
<!-- layer14_gpu5_expert_mlp1 -->
<g id="node1296" class="node">
<title>layer14_gpu5_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4319.5,-2783.67 3858.5,-2783.67 3858.5,-2715.67 4319.5,-2715.67 4319.5,-2783.67"/>
<text text-anchor="middle" x="4089" y="-2768.47" font-family="Times,serif" font-size="14.00">Expert 5 MLP1</text>
<text text-anchor="middle" x="4089" y="-2753.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4089" y="-2738.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4089" y="-2723.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer14_gpu5_token_recv&#45;&gt;layer14_gpu5_expert_mlp1 -->
<g id="edge1510" class="edge">
<title>layer14_gpu5_token_recv&#45;&gt;layer14_gpu5_expert_mlp1</title>
<path fill="none" stroke="black" d="M4096.71,-2819.53C4095.77,-2811.15 4094.8,-2802.45 4093.87,-2794.17"/>
<polygon fill="black" stroke="black" points="4097.32,-2793.52 4092.73,-2783.97 4090.36,-2794.3 4097.32,-2793.52"/>
</g>
<!-- layer14_gpu5_expert_act -->
<g id="node1297" class="node">
<title>layer14_gpu5_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4236.5,-2679.67 3859.5,-2679.67 3859.5,-2611.67 4236.5,-2611.67 4236.5,-2679.67"/>
<text text-anchor="middle" x="4048" y="-2664.47" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="4048" y="-2649.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4048" y="-2634.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4048" y="-2619.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer14_gpu5_expert_mlp1&#45;&gt;layer14_gpu5_expert_act -->
<g id="edge1511" class="edge">
<title>layer14_gpu5_expert_mlp1&#45;&gt;layer14_gpu5_expert_act</title>
<path fill="none" stroke="black" d="M4075.69,-2715.55C4072.32,-2707.18 4068.66,-2698.07 4065.14,-2689.3"/>
<polygon fill="black" stroke="black" points="4068.36,-2687.94 4061.39,-2679.97 4061.87,-2690.55 4068.36,-2687.94"/>
</g>
<!-- layer14_gpu5_expert_mlp2 -->
<g id="node1298" class="node">
<title>layer14_gpu5_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4241.5,-2575.67 3834.5,-2575.67 3834.5,-2507.67 4241.5,-2507.67 4241.5,-2575.67"/>
<text text-anchor="middle" x="4038" y="-2560.47" font-family="Times,serif" font-size="14.00">Expert 5 MLP2</text>
<text text-anchor="middle" x="4038" y="-2545.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4038" y="-2530.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4038" y="-2515.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer14_gpu5_expert_act&#45;&gt;layer14_gpu5_expert_mlp2 -->
<g id="edge1512" class="edge">
<title>layer14_gpu5_expert_act&#45;&gt;layer14_gpu5_expert_mlp2</title>
<path fill="none" stroke="black" d="M4044.75,-2611.55C4043.96,-2603.44 4043.1,-2594.65 4042.26,-2586.14"/>
<polygon fill="black" stroke="black" points="4045.72,-2585.58 4041.26,-2575.97 4038.76,-2586.26 4045.72,-2585.58"/>
</g>
<!-- layer14_gpu5_token_send -->
<g id="node1299" class="node">
<title>layer14_gpu5_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4017" cy="-2423.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4017" y="-2442.38" font-family="Times,serif" font-size="14.00">Token Send GPU5</text>
<text text-anchor="middle" x="4017" y="-2427.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4017" y="-2412.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4017" y="-2397.38" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer14_gpu5_expert_mlp2&#45;&gt;layer14_gpu5_token_send -->
<g id="edge1513" class="edge">
<title>layer14_gpu5_expert_mlp2&#45;&gt;layer14_gpu5_token_send</title>
<path fill="none" stroke="black" d="M4031.98,-2507.4C4030.52,-2499.32 4028.92,-2490.45 4027.32,-2481.61"/>
<polygon fill="black" stroke="black" points="4030.75,-2480.91 4025.52,-2471.69 4023.86,-2482.16 4030.75,-2480.91"/>
</g>
<!-- layer14_gpu5_token_send&#45;&gt;layer14_expert_agg -->
<g id="edge1514" class="edge">
<title>layer14_gpu5_token_send&#45;&gt;layer14_expert_agg</title>
<path fill="none" stroke="black" d="M4266.02,-2389.2C4304.5,-2384.38 4343.8,-2379.65 4381,-2375.5 4637.39,-2346.88 4928.13,-2319.8 5145.7,-2300.6"/>
<polygon fill="black" stroke="black" points="5146.03,-2304.09 5155.68,-2299.72 5145.41,-2297.11 5146.03,-2304.09"/>
</g>
<!-- layer14_gpu6_expert_mlp1 -->
<g id="node1301" class="node">
<title>layer14_gpu6_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5010.5,-2783.67 4549.5,-2783.67 4549.5,-2715.67 5010.5,-2715.67 5010.5,-2783.67"/>
<text text-anchor="middle" x="4780" y="-2768.47" font-family="Times,serif" font-size="14.00">Expert 6 MLP1</text>
<text text-anchor="middle" x="4780" y="-2753.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4780" y="-2738.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4780" y="-2723.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer14_gpu6_token_recv&#45;&gt;layer14_gpu6_expert_mlp1 -->
<g id="edge1516" class="edge">
<title>layer14_gpu6_token_recv&#45;&gt;layer14_gpu6_expert_mlp1</title>
<path fill="none" stroke="black" d="M4785.93,-2819.53C4785.21,-2811.15 4784.46,-2802.45 4783.75,-2794.17"/>
<polygon fill="black" stroke="black" points="4787.21,-2793.63 4782.87,-2783.97 4780.24,-2794.23 4787.21,-2793.63"/>
</g>
<!-- layer14_gpu6_expert_act -->
<g id="node1302" class="node">
<title>layer14_gpu6_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4947.5,-2679.67 4570.5,-2679.67 4570.5,-2611.67 4947.5,-2611.67 4947.5,-2679.67"/>
<text text-anchor="middle" x="4759" y="-2664.47" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="4759" y="-2649.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4759" y="-2634.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4759" y="-2619.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer14_gpu6_expert_mlp1&#45;&gt;layer14_gpu6_expert_act -->
<g id="edge1517" class="edge">
<title>layer14_gpu6_expert_mlp1&#45;&gt;layer14_gpu6_expert_act</title>
<path fill="none" stroke="black" d="M4773.18,-2715.55C4771.49,-2707.35 4769.66,-2698.45 4767.89,-2689.86"/>
<polygon fill="black" stroke="black" points="4771.3,-2689.05 4765.86,-2679.97 4764.44,-2690.47 4771.3,-2689.05"/>
</g>
<!-- layer14_gpu6_expert_mlp2 -->
<g id="node1303" class="node">
<title>layer14_gpu6_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4954.5,-2575.67 4547.5,-2575.67 4547.5,-2507.67 4954.5,-2507.67 4954.5,-2575.67"/>
<text text-anchor="middle" x="4751" y="-2560.47" font-family="Times,serif" font-size="14.00">Expert 6 MLP2</text>
<text text-anchor="middle" x="4751" y="-2545.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4751" y="-2530.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4751" y="-2515.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer14_gpu6_expert_act&#45;&gt;layer14_gpu6_expert_mlp2 -->
<g id="edge1518" class="edge">
<title>layer14_gpu6_expert_act&#45;&gt;layer14_gpu6_expert_mlp2</title>
<path fill="none" stroke="black" d="M4756.4,-2611.55C4755.77,-2603.44 4755.08,-2594.65 4754.41,-2586.14"/>
<polygon fill="black" stroke="black" points="4757.88,-2585.66 4753.61,-2575.97 4750.9,-2586.21 4757.88,-2585.66"/>
</g>
<!-- layer14_gpu6_token_send -->
<g id="node1304" class="node">
<title>layer14_gpu6_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4746" cy="-2423.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4746" y="-2442.38" font-family="Times,serif" font-size="14.00">Token Send GPU6</text>
<text text-anchor="middle" x="4746" y="-2427.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4746" y="-2412.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4746" y="-2397.38" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer14_gpu6_expert_mlp2&#45;&gt;layer14_gpu6_token_send -->
<g id="edge1519" class="edge">
<title>layer14_gpu6_expert_mlp2&#45;&gt;layer14_gpu6_token_send</title>
<path fill="none" stroke="black" d="M4749.57,-2507.4C4749.22,-2499.41 4748.85,-2490.64 4748.47,-2481.9"/>
<polygon fill="black" stroke="black" points="4751.96,-2481.53 4748.03,-2471.69 4744.96,-2481.83 4751.96,-2481.53"/>
</g>
<!-- layer14_gpu6_token_send&#45;&gt;layer14_expert_agg -->
<g id="edge1520" class="edge">
<title>layer14_gpu6_token_send&#45;&gt;layer14_expert_agg</title>
<path fill="none" stroke="black" d="M4938.54,-2383.05C5014.53,-2367.45 5103.48,-2349.19 5186.94,-2332.05"/>
<polygon fill="black" stroke="black" points="5187.74,-2335.46 5196.83,-2330.02 5186.33,-2328.61 5187.74,-2335.46"/>
</g>
<!-- layer14_gpu7_expert_mlp1 -->
<g id="node1306" class="node">
<title>layer14_gpu7_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5707.5,-2783.67 5246.5,-2783.67 5246.5,-2715.67 5707.5,-2715.67 5707.5,-2783.67"/>
<text text-anchor="middle" x="5477" y="-2768.47" font-family="Times,serif" font-size="14.00">Expert 7 MLP1</text>
<text text-anchor="middle" x="5477" y="-2753.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5477" y="-2738.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5477" y="-2723.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer14_gpu7_token_recv&#45;&gt;layer14_gpu7_expert_mlp1 -->
<g id="edge1522" class="edge">
<title>layer14_gpu7_token_recv&#45;&gt;layer14_gpu7_expert_mlp1</title>
<path fill="none" stroke="black" d="M5477,-2819.53C5477,-2811.15 5477,-2802.45 5477,-2794.17"/>
<polygon fill="black" stroke="black" points="5480.5,-2793.97 5477,-2783.97 5473.5,-2793.97 5480.5,-2793.97"/>
</g>
<!-- layer14_gpu7_expert_act -->
<g id="node1307" class="node">
<title>layer14_gpu7_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="5663.5,-2679.67 5286.5,-2679.67 5286.5,-2611.67 5663.5,-2611.67 5663.5,-2679.67"/>
<text text-anchor="middle" x="5475" y="-2664.47" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="5475" y="-2649.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-2634.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-2619.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer14_gpu7_expert_mlp1&#45;&gt;layer14_gpu7_expert_act -->
<g id="edge1523" class="edge">
<title>layer14_gpu7_expert_mlp1&#45;&gt;layer14_gpu7_expert_act</title>
<path fill="none" stroke="black" d="M5476.35,-2715.55C5476.19,-2707.44 5476.02,-2698.65 5475.85,-2690.14"/>
<polygon fill="black" stroke="black" points="5479.35,-2689.89 5475.65,-2679.97 5472.35,-2690.03 5479.35,-2689.89"/>
</g>
<!-- layer14_gpu7_expert_mlp2 -->
<g id="node1308" class="node">
<title>layer14_gpu7_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="5678.5,-2575.67 5271.5,-2575.67 5271.5,-2507.67 5678.5,-2507.67 5678.5,-2575.67"/>
<text text-anchor="middle" x="5475" y="-2560.47" font-family="Times,serif" font-size="14.00">Expert 7 MLP2</text>
<text text-anchor="middle" x="5475" y="-2545.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-2530.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5475" y="-2515.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer14_gpu7_expert_act&#45;&gt;layer14_gpu7_expert_mlp2 -->
<g id="edge1524" class="edge">
<title>layer14_gpu7_expert_act&#45;&gt;layer14_gpu7_expert_mlp2</title>
<path fill="none" stroke="black" d="M5475,-2611.55C5475,-2603.44 5475,-2594.65 5475,-2586.14"/>
<polygon fill="black" stroke="black" points="5478.5,-2585.97 5475,-2575.97 5471.5,-2585.97 5478.5,-2585.97"/>
</g>
<!-- layer14_gpu7_token_send -->
<g id="node1309" class="node">
<title>layer14_gpu7_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="5475" cy="-2423.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="5475" y="-2442.38" font-family="Times,serif" font-size="14.00">Token Send GPU7</text>
<text text-anchor="middle" x="5475" y="-2427.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="5475" y="-2412.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="5475" y="-2397.38" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer14_gpu7_expert_mlp2&#45;&gt;layer14_gpu7_token_send -->
<g id="edge1525" class="edge">
<title>layer14_gpu7_expert_mlp2&#45;&gt;layer14_gpu7_token_send</title>
<path fill="none" stroke="black" d="M5475,-2507.4C5475,-2499.41 5475,-2490.64 5475,-2481.9"/>
<polygon fill="black" stroke="black" points="5478.5,-2481.69 5475,-2471.69 5471.5,-2481.69 5478.5,-2481.69"/>
</g>
<!-- layer14_gpu7_token_send&#45;&gt;layer14_expert_agg -->
<g id="edge1526" class="edge">
<title>layer14_gpu7_token_send&#45;&gt;layer14_expert_agg</title>
<path fill="none" stroke="black" d="M5475.63,-2375.1C5475.74,-2367.01 5475.85,-2358.43 5475.97,-2349.81"/>
<polygon fill="black" stroke="black" points="5479.47,-2349.74 5476.1,-2339.69 5472.47,-2349.65 5479.47,-2349.74"/>
</g>
<!-- layer14_gpu8_expert_mlp1 -->
<g id="node1311" class="node">
<title>layer14_gpu8_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="6413.5,-2783.67 5952.5,-2783.67 5952.5,-2715.67 6413.5,-2715.67 6413.5,-2783.67"/>
<text text-anchor="middle" x="6183" y="-2768.47" font-family="Times,serif" font-size="14.00">Expert 8 MLP1</text>
<text text-anchor="middle" x="6183" y="-2753.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6183" y="-2738.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6183" y="-2723.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer14_gpu8_token_recv&#45;&gt;layer14_gpu8_expert_mlp1 -->
<g id="edge1528" class="edge">
<title>layer14_gpu8_token_recv&#45;&gt;layer14_gpu8_expert_mlp1</title>
<path fill="none" stroke="black" d="M6181.22,-2819.53C6181.44,-2811.15 6181.66,-2802.45 6181.88,-2794.17"/>
<polygon fill="black" stroke="black" points="6185.38,-2794.06 6182.14,-2783.97 6178.38,-2793.88 6185.38,-2794.06"/>
</g>
<!-- layer14_gpu8_expert_act -->
<g id="node1312" class="node">
<title>layer14_gpu8_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="6377.5,-2679.67 6000.5,-2679.67 6000.5,-2611.67 6377.5,-2611.67 6377.5,-2679.67"/>
<text text-anchor="middle" x="6189" y="-2664.47" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="6189" y="-2649.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6189" y="-2634.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6189" y="-2619.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer14_gpu8_expert_mlp1&#45;&gt;layer14_gpu8_expert_act -->
<g id="edge1529" class="edge">
<title>layer14_gpu8_expert_mlp1&#45;&gt;layer14_gpu8_expert_act</title>
<path fill="none" stroke="black" d="M6184.95,-2715.55C6185.42,-2707.44 6185.94,-2698.65 6186.44,-2690.14"/>
<polygon fill="black" stroke="black" points="6189.95,-2690.15 6187.04,-2679.97 6182.96,-2689.74 6189.95,-2690.15"/>
</g>
<!-- layer14_gpu8_expert_mlp2 -->
<g id="node1313" class="node">
<title>layer14_gpu8_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="6394.5,-2575.67 5987.5,-2575.67 5987.5,-2507.67 6394.5,-2507.67 6394.5,-2575.67"/>
<text text-anchor="middle" x="6191" y="-2560.47" font-family="Times,serif" font-size="14.00">Expert 8 MLP2</text>
<text text-anchor="middle" x="6191" y="-2545.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6191" y="-2530.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6191" y="-2515.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer14_gpu8_expert_act&#45;&gt;layer14_gpu8_expert_mlp2 -->
<g id="edge1530" class="edge">
<title>layer14_gpu8_expert_act&#45;&gt;layer14_gpu8_expert_mlp2</title>
<path fill="none" stroke="black" d="M6189.65,-2611.55C6189.81,-2603.44 6189.98,-2594.65 6190.15,-2586.14"/>
<polygon fill="black" stroke="black" points="6193.65,-2586.03 6190.35,-2575.97 6186.65,-2585.89 6193.65,-2586.03"/>
</g>
<!-- layer14_gpu8_token_send -->
<g id="node1314" class="node">
<title>layer14_gpu8_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6204" cy="-2423.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6204" y="-2442.38" font-family="Times,serif" font-size="14.00">Token Send GPU8</text>
<text text-anchor="middle" x="6204" y="-2427.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6204" y="-2412.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6204" y="-2397.38" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer14_gpu8_expert_mlp2&#45;&gt;layer14_gpu8_token_send -->
<g id="edge1531" class="edge">
<title>layer14_gpu8_expert_mlp2&#45;&gt;layer14_gpu8_token_send</title>
<path fill="none" stroke="black" d="M6194.73,-2507.4C6195.62,-2499.41 6196.6,-2490.64 6197.58,-2481.9"/>
<polygon fill="black" stroke="black" points="6201.09,-2482.02 6198.72,-2471.69 6194.13,-2481.24 6201.09,-2482.02"/>
</g>
<!-- layer14_gpu8_token_send&#45;&gt;layer14_expert_agg -->
<g id="edge1532" class="edge">
<title>layer14_gpu8_token_send&#45;&gt;layer14_expert_agg</title>
<path fill="none" stroke="black" d="M6012.51,-2383.05C5950.86,-2370.33 5880.64,-2355.83 5811.79,-2341.61"/>
<polygon fill="black" stroke="black" points="5812.14,-2338.11 5801.64,-2339.52 5810.73,-2344.97 5812.14,-2338.11"/>
</g>
<!-- layer14_gpu9_expert_mlp1 -->
<g id="node1316" class="node">
<title>layer14_gpu9_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7111.5,-2783.67 6650.5,-2783.67 6650.5,-2715.67 7111.5,-2715.67 7111.5,-2783.67"/>
<text text-anchor="middle" x="6881" y="-2768.47" font-family="Times,serif" font-size="14.00">Expert 9 MLP1</text>
<text text-anchor="middle" x="6881" y="-2753.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6881" y="-2738.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6881" y="-2723.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer14_gpu9_token_recv&#45;&gt;layer14_gpu9_expert_mlp1 -->
<g id="edge1534" class="edge">
<title>layer14_gpu9_token_recv&#45;&gt;layer14_gpu9_expert_mlp1</title>
<path fill="none" stroke="black" d="M6877.44,-2819.53C6877.87,-2811.15 6878.32,-2802.45 6878.75,-2794.17"/>
<polygon fill="black" stroke="black" points="6882.26,-2794.14 6879.28,-2783.97 6875.27,-2793.78 6882.26,-2794.14"/>
</g>
<!-- layer14_gpu9_expert_act -->
<g id="node1317" class="node">
<title>layer14_gpu9_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7076.5,-2679.67 6699.5,-2679.67 6699.5,-2611.67 7076.5,-2611.67 7076.5,-2679.67"/>
<text text-anchor="middle" x="6888" y="-2664.47" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="6888" y="-2649.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6888" y="-2634.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6888" y="-2619.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer14_gpu9_expert_mlp1&#45;&gt;layer14_gpu9_expert_act -->
<g id="edge1535" class="edge">
<title>layer14_gpu9_expert_mlp1&#45;&gt;layer14_gpu9_expert_act</title>
<path fill="none" stroke="black" d="M6883.27,-2715.55C6883.83,-2707.44 6884.43,-2698.65 6885.02,-2690.14"/>
<polygon fill="black" stroke="black" points="6888.52,-2690.18 6885.71,-2679.97 6881.54,-2689.7 6888.52,-2690.18"/>
</g>
<!-- layer14_gpu9_expert_mlp2 -->
<g id="node1318" class="node">
<title>layer14_gpu9_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7106.5,-2575.67 6699.5,-2575.67 6699.5,-2507.67 7106.5,-2507.67 7106.5,-2575.67"/>
<text text-anchor="middle" x="6903" y="-2560.47" font-family="Times,serif" font-size="14.00">Expert 9 MLP2</text>
<text text-anchor="middle" x="6903" y="-2545.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6903" y="-2530.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6903" y="-2515.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer14_gpu9_expert_act&#45;&gt;layer14_gpu9_expert_mlp2 -->
<g id="edge1536" class="edge">
<title>layer14_gpu9_expert_act&#45;&gt;layer14_gpu9_expert_mlp2</title>
<path fill="none" stroke="black" d="M6892.87,-2611.55C6894.06,-2603.44 6895.36,-2594.65 6896.61,-2586.14"/>
<polygon fill="black" stroke="black" points="6900.11,-2586.37 6898.1,-2575.97 6893.19,-2585.35 6900.11,-2586.37"/>
</g>
<!-- layer14_gpu9_token_send -->
<g id="node1319" class="node">
<title>layer14_gpu9_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6933" cy="-2423.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6933" y="-2442.38" font-family="Times,serif" font-size="14.00">Token Send GPU9</text>
<text text-anchor="middle" x="6933" y="-2427.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6933" y="-2412.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6933" y="-2397.38" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer14_gpu9_expert_mlp2&#45;&gt;layer14_gpu9_token_send -->
<g id="edge1537" class="edge">
<title>layer14_gpu9_expert_mlp2&#45;&gt;layer14_gpu9_token_send</title>
<path fill="none" stroke="black" d="M6911.6,-2507.4C6913.69,-2499.32 6915.98,-2490.45 6918.26,-2481.61"/>
<polygon fill="black" stroke="black" points="6921.71,-2482.25 6920.83,-2471.69 6914.93,-2480.5 6921.71,-2482.25"/>
</g>
<!-- layer14_gpu9_token_send&#45;&gt;layer14_expert_agg -->
<g id="edge1538" class="edge">
<title>layer14_gpu9_token_send&#45;&gt;layer14_expert_agg</title>
<path fill="none" stroke="black" d="M6683.98,-2389.21C6645.5,-2384.39 6606.2,-2379.66 6569,-2375.5 6347.19,-2350.7 6099.58,-2327.02 5896.29,-2308.63"/>
<polygon fill="black" stroke="black" points="5896.31,-2305.12 5886.03,-2307.7 5895.68,-2312.09 5896.31,-2305.12"/>
</g>
<!-- layer14_gpu10_expert_mlp1 -->
<g id="node1321" class="node">
<title>layer14_gpu10_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7807.5,-2783.67 7346.5,-2783.67 7346.5,-2715.67 7807.5,-2715.67 7807.5,-2783.67"/>
<text text-anchor="middle" x="7577" y="-2768.47" font-family="Times,serif" font-size="14.00">Expert 10 MLP1</text>
<text text-anchor="middle" x="7577" y="-2753.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7577" y="-2738.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7577" y="-2723.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer14_gpu10_token_recv&#45;&gt;layer14_gpu10_expert_mlp1 -->
<g id="edge1540" class="edge">
<title>layer14_gpu10_token_recv&#45;&gt;layer14_gpu10_expert_mlp1</title>
<path fill="none" stroke="black" d="M7570.47,-2819.53C7571.27,-2811.15 7572.09,-2802.45 7572.88,-2794.17"/>
<polygon fill="black" stroke="black" points="7576.39,-2794.26 7573.84,-2783.97 7569.42,-2793.59 7576.39,-2794.26"/>
</g>
<!-- layer14_gpu10_expert_act -->
<g id="node1322" class="node">
<title>layer14_gpu10_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7777.5,-2679.67 7400.5,-2679.67 7400.5,-2611.67 7777.5,-2611.67 7777.5,-2679.67"/>
<text text-anchor="middle" x="7589" y="-2664.47" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="7589" y="-2649.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7589" y="-2634.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7589" y="-2619.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer14_gpu10_expert_mlp1&#45;&gt;layer14_gpu10_expert_act -->
<g id="edge1541" class="edge">
<title>layer14_gpu10_expert_mlp1&#45;&gt;layer14_gpu10_expert_act</title>
<path fill="none" stroke="black" d="M7580.9,-2715.55C7581.85,-2707.44 7582.88,-2698.65 7583.89,-2690.14"/>
<polygon fill="black" stroke="black" points="7587.39,-2690.31 7585.08,-2679.97 7580.44,-2689.49 7587.39,-2690.31"/>
</g>
<!-- layer14_gpu10_expert_mlp2 -->
<g id="node1323" class="node">
<title>layer14_gpu10_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7841.5,-2575.67 7434.5,-2575.67 7434.5,-2507.67 7841.5,-2507.67 7841.5,-2575.67"/>
<text text-anchor="middle" x="7638" y="-2560.47" font-family="Times,serif" font-size="14.00">Expert 10 MLP2</text>
<text text-anchor="middle" x="7638" y="-2545.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7638" y="-2530.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="7638" y="-2515.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer14_gpu10_expert_act&#45;&gt;layer14_gpu10_expert_mlp2 -->
<g id="edge1542" class="edge">
<title>layer14_gpu10_expert_act&#45;&gt;layer14_gpu10_expert_mlp2</title>
<path fill="none" stroke="black" d="M7604.91,-2611.55C7608.97,-2603.09 7613.4,-2593.87 7617.65,-2585.02"/>
<polygon fill="black" stroke="black" points="7620.83,-2586.49 7622,-2575.97 7614.52,-2583.46 7620.83,-2586.49"/>
</g>
<!-- layer14_gpu10_token_send -->
<g id="node1324" class="node">
<title>layer14_gpu10_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="7662" cy="-2423.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="7662" y="-2442.38" font-family="Times,serif" font-size="14.00">Token Send GPU10</text>
<text text-anchor="middle" x="7662" y="-2427.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="7662" y="-2412.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="7662" y="-2397.38" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer14_gpu10_expert_mlp2&#45;&gt;layer14_gpu10_token_send -->
<g id="edge1543" class="edge">
<title>layer14_gpu10_expert_mlp2&#45;&gt;layer14_gpu10_token_send</title>
<path fill="none" stroke="black" d="M7644.88,-2507.4C7646.55,-2499.32 7648.38,-2490.45 7650.21,-2481.61"/>
<polygon fill="black" stroke="black" points="7653.66,-2482.19 7652.26,-2471.69 7646.81,-2480.78 7653.66,-2482.19"/>
</g>
<!-- layer14_gpu10_token_send&#45;&gt;layer14_expert_agg -->
<g id="edge1544" class="edge">
<title>layer14_gpu10_token_send&#45;&gt;layer14_expert_agg</title>
<path fill="none" stroke="black" d="M7418.01,-2388.56C7377.96,-2383.68 7336.86,-2379.11 7298,-2375.5 6805.31,-2329.76 6235.61,-2301.48 5866.49,-2286.39"/>
<polygon fill="black" stroke="black" points="5866.58,-2282.89 5856.44,-2285.98 5866.29,-2289.89 5866.58,-2282.89"/>
</g>
<!-- layer14_gpu11_expert_mlp1 -->
<g id="node1326" class="node">
<title>layer14_gpu11_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="8501.5,-2783.67 8040.5,-2783.67 8040.5,-2715.67 8501.5,-2715.67 8501.5,-2783.67"/>
<text text-anchor="middle" x="8271" y="-2768.47" font-family="Times,serif" font-size="14.00">Expert 11 MLP1</text>
<text text-anchor="middle" x="8271" y="-2753.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8271" y="-2738.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8271" y="-2723.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer14_gpu11_token_recv&#45;&gt;layer14_gpu11_expert_mlp1 -->
<g id="edge1546" class="edge">
<title>layer14_gpu11_token_recv&#45;&gt;layer14_gpu11_expert_mlp1</title>
<path fill="none" stroke="black" d="M8261.51,-2819.53C8262.68,-2811.05 8263.89,-2802.26 8265.04,-2793.9"/>
<polygon fill="black" stroke="black" points="8268.51,-2794.35 8266.41,-2783.97 8261.58,-2793.4 8268.51,-2794.35"/>
</g>
<!-- layer14_gpu11_expert_act -->
<g id="node1327" class="node">
<title>layer14_gpu11_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="8476.5,-2679.67 8099.5,-2679.67 8099.5,-2611.67 8476.5,-2611.67 8476.5,-2679.67"/>
<text text-anchor="middle" x="8288" y="-2664.47" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="8288" y="-2649.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8288" y="-2634.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8288" y="-2619.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer14_gpu11_expert_mlp1&#45;&gt;layer14_gpu11_expert_act -->
<g id="edge1547" class="edge">
<title>layer14_gpu11_expert_mlp1&#45;&gt;layer14_gpu11_expert_act</title>
<path fill="none" stroke="black" d="M8276.52,-2715.55C8277.89,-2707.35 8279.37,-2698.45 8280.8,-2689.86"/>
<polygon fill="black" stroke="black" points="8284.26,-2690.4 8282.45,-2679.97 8277.35,-2689.25 8284.26,-2690.4"/>
</g>
<!-- layer14_gpu11_expert_mlp2 -->
<g id="node1328" class="node">
<title>layer14_gpu11_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="8560.5,-2575.67 8153.5,-2575.67 8153.5,-2507.67 8560.5,-2507.67 8560.5,-2575.67"/>
<text text-anchor="middle" x="8357" y="-2560.47" font-family="Times,serif" font-size="14.00">Expert 11 MLP2</text>
<text text-anchor="middle" x="8357" y="-2545.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8357" y="-2530.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="8357" y="-2515.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer14_gpu11_expert_act&#45;&gt;layer14_gpu11_expert_mlp2 -->
<g id="edge1548" class="edge">
<title>layer14_gpu11_expert_act&#45;&gt;layer14_gpu11_expert_mlp2</title>
<path fill="none" stroke="black" d="M8310.4,-2611.55C8316.25,-2602.91 8322.62,-2593.49 8328.73,-2584.46"/>
<polygon fill="black" stroke="black" points="8331.77,-2586.21 8334.47,-2575.97 8325.97,-2582.29 8331.77,-2586.21"/>
</g>
<!-- layer14_gpu11_token_send -->
<g id="node1329" class="node">
<title>layer14_gpu11_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="8391" cy="-2423.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="8391" y="-2442.38" font-family="Times,serif" font-size="14.00">Token Send GPU11</text>
<text text-anchor="middle" x="8391" y="-2427.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="8391" y="-2412.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="8391" y="-2397.38" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer14_gpu11_expert_mlp2&#45;&gt;layer14_gpu11_token_send -->
<g id="edge1549" class="edge">
<title>layer14_gpu11_expert_mlp2&#45;&gt;layer14_gpu11_token_send</title>
<path fill="none" stroke="black" d="M8366.74,-2507.4C8369.14,-2499.23 8371.76,-2490.26 8374.38,-2481.33"/>
<polygon fill="black" stroke="black" points="8377.75,-2482.27 8377.2,-2471.69 8371.03,-2480.31 8377.75,-2482.27"/>
</g>
<!-- layer14_gpu11_token_send&#45;&gt;layer14_expert_agg -->
<g id="edge1550" class="edge">
<title>layer14_gpu11_token_send&#45;&gt;layer14_expert_agg</title>
<path fill="none" stroke="black" d="M8149.02,-2388.25C8108.35,-2383.35 8066.52,-2378.85 8027,-2375.5 7257.21,-2310.29 6353.08,-2286.13 5854.72,-2277.35"/>
<polygon fill="black" stroke="black" points="5854.55,-2273.85 5844.49,-2277.17 5854.43,-2280.85 5854.55,-2273.85"/>
</g>
<!-- layer14_gpu12_expert_mlp1 -->
<g id="node1331" class="node">
<title>layer14_gpu12_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9195.5,-2783.67 8734.5,-2783.67 8734.5,-2715.67 9195.5,-2715.67 9195.5,-2783.67"/>
<text text-anchor="middle" x="8965" y="-2768.47" font-family="Times,serif" font-size="14.00">Expert 12 MLP1</text>
<text text-anchor="middle" x="8965" y="-2753.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8965" y="-2738.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8965" y="-2723.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer14_gpu12_token_recv&#45;&gt;layer14_gpu12_expert_mlp1 -->
<g id="edge1552" class="edge">
<title>layer14_gpu12_token_recv&#45;&gt;layer14_gpu12_expert_mlp1</title>
<path fill="none" stroke="black" d="M8951.95,-2819.53C8953.56,-2811.05 8955.22,-2802.26 8956.81,-2793.9"/>
<polygon fill="black" stroke="black" points="8960.26,-2794.45 8958.69,-2783.97 8953.39,-2793.14 8960.26,-2794.45"/>
</g>
<!-- layer14_gpu12_expert_act -->
<g id="node1332" class="node">
<title>layer14_gpu12_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9174.5,-2679.67 8797.5,-2679.67 8797.5,-2611.67 9174.5,-2611.67 9174.5,-2679.67"/>
<text text-anchor="middle" x="8986" y="-2664.47" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="8986" y="-2649.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8986" y="-2634.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8986" y="-2619.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer14_gpu12_expert_mlp1&#45;&gt;layer14_gpu12_expert_act -->
<g id="edge1553" class="edge">
<title>layer14_gpu12_expert_mlp1&#45;&gt;layer14_gpu12_expert_act</title>
<path fill="none" stroke="black" d="M8971.82,-2715.55C8973.51,-2707.35 8975.34,-2698.45 8977.11,-2689.86"/>
<polygon fill="black" stroke="black" points="8980.56,-2690.47 8979.14,-2679.97 8973.7,-2689.05 8980.56,-2690.47"/>
</g>
<!-- layer14_gpu12_expert_mlp2 -->
<g id="node1333" class="node">
<title>layer14_gpu12_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9234.5,-2575.67 8827.5,-2575.67 8827.5,-2507.67 9234.5,-2507.67 9234.5,-2575.67"/>
<text text-anchor="middle" x="9031" y="-2560.47" font-family="Times,serif" font-size="14.00">Expert 12 MLP2</text>
<text text-anchor="middle" x="9031" y="-2545.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9031" y="-2530.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9031" y="-2515.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer14_gpu12_expert_act&#45;&gt;layer14_gpu12_expert_mlp2 -->
<g id="edge1554" class="edge">
<title>layer14_gpu12_expert_act&#45;&gt;layer14_gpu12_expert_mlp2</title>
<path fill="none" stroke="black" d="M9000.61,-2611.55C9004.3,-2603.18 9008.32,-2594.07 9012.19,-2585.3"/>
<polygon fill="black" stroke="black" points="9015.47,-2586.53 9016.31,-2575.97 9009.07,-2583.7 9015.47,-2586.53"/>
</g>
<!-- layer14_gpu12_token_send -->
<g id="node1334" class="node">
<title>layer14_gpu12_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9120" cy="-2423.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9120" y="-2442.38" font-family="Times,serif" font-size="14.00">Token Send GPU12</text>
<text text-anchor="middle" x="9120" y="-2427.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9120" y="-2412.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9120" y="-2397.38" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer14_gpu12_expert_mlp2&#45;&gt;layer14_gpu12_token_send -->
<g id="edge1555" class="edge">
<title>layer14_gpu12_expert_mlp2&#45;&gt;layer14_gpu12_token_send</title>
<path fill="none" stroke="black" d="M9056.5,-2507.4C9063.1,-2498.8 9070.38,-2489.3 9077.59,-2479.9"/>
<polygon fill="black" stroke="black" points="9080.57,-2481.76 9083.88,-2471.69 9075.02,-2477.5 9080.57,-2481.76"/>
</g>
<!-- layer14_gpu12_token_send&#45;&gt;layer14_expert_agg -->
<g id="edge1556" class="edge">
<title>layer14_gpu12_token_send&#45;&gt;layer14_expert_agg</title>
<path fill="none" stroke="black" d="M8879.52,-2388.12C8838.38,-2383.19 8796.02,-2378.71 8756,-2375.5 7703.84,-2291.13 6456.59,-2274.93 5848.15,-2272.42"/>
<polygon fill="black" stroke="black" points="5847.92,-2268.92 5837.9,-2272.38 5847.89,-2275.92 5847.92,-2268.92"/>
</g>
<!-- layer14_gpu13_expert_mlp1 -->
<g id="node1336" class="node">
<title>layer14_gpu13_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9888.5,-2783.67 9427.5,-2783.67 9427.5,-2715.67 9888.5,-2715.67 9888.5,-2783.67"/>
<text text-anchor="middle" x="9658" y="-2768.47" font-family="Times,serif" font-size="14.00">Expert 13 MLP1</text>
<text text-anchor="middle" x="9658" y="-2753.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9658" y="-2738.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9658" y="-2723.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer14_gpu13_token_recv&#45;&gt;layer14_gpu13_expert_mlp1 -->
<g id="edge1558" class="edge">
<title>layer14_gpu13_token_recv&#45;&gt;layer14_gpu13_expert_mlp1</title>
<path fill="none" stroke="black" d="M9641.39,-2819.53C9643.43,-2811.05 9645.56,-2802.26 9647.57,-2793.9"/>
<polygon fill="black" stroke="black" points="9651.02,-2794.51 9649.97,-2783.97 9644.22,-2792.87 9651.02,-2794.51"/>
</g>
<!-- layer14_gpu13_expert_act -->
<g id="node1337" class="node">
<title>layer14_gpu13_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9872.5,-2679.67 9495.5,-2679.67 9495.5,-2611.67 9872.5,-2611.67 9872.5,-2679.67"/>
<text text-anchor="middle" x="9684" y="-2664.47" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="9684" y="-2649.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9684" y="-2634.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9684" y="-2619.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer14_gpu13_expert_mlp1&#45;&gt;layer14_gpu13_expert_act -->
<g id="edge1559" class="edge">
<title>layer14_gpu13_expert_mlp1&#45;&gt;layer14_gpu13_expert_act</title>
<path fill="none" stroke="black" d="M9666.44,-2715.55C9668.53,-2707.35 9670.8,-2698.45 9672.99,-2689.86"/>
<polygon fill="black" stroke="black" points="9676.43,-2690.52 9675.51,-2679.97 9669.65,-2688.79 9676.43,-2690.52"/>
</g>
<!-- layer14_gpu13_expert_mlp2 -->
<g id="node1338" class="node">
<title>layer14_gpu13_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9997.5,-2575.67 9590.5,-2575.67 9590.5,-2507.67 9997.5,-2507.67 9997.5,-2575.67"/>
<text text-anchor="middle" x="9794" y="-2560.47" font-family="Times,serif" font-size="14.00">Expert 13 MLP2</text>
<text text-anchor="middle" x="9794" y="-2545.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9794" y="-2530.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9794" y="-2515.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer14_gpu13_expert_act&#45;&gt;layer14_gpu13_expert_mlp2 -->
<g id="edge1560" class="edge">
<title>layer14_gpu13_expert_act&#45;&gt;layer14_gpu13_expert_mlp2</title>
<path fill="none" stroke="black" d="M9719.71,-2611.55C9729.61,-2602.38 9740.46,-2592.32 9750.73,-2582.79"/>
<polygon fill="black" stroke="black" points="9753.14,-2585.33 9758.09,-2575.97 9748.38,-2580.2 9753.14,-2585.33"/>
</g>
<!-- layer14_gpu13_token_send -->
<g id="node1339" class="node">
<title>layer14_gpu13_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9849" cy="-2423.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9849" y="-2442.38" font-family="Times,serif" font-size="14.00">Token Send GPU13</text>
<text text-anchor="middle" x="9849" y="-2427.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9849" y="-2412.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9849" y="-2397.38" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer14_gpu13_expert_mlp2&#45;&gt;layer14_gpu13_token_send -->
<g id="edge1561" class="edge">
<title>layer14_gpu13_expert_mlp2&#45;&gt;layer14_gpu13_token_send</title>
<path fill="none" stroke="black" d="M9809.76,-2507.4C9813.71,-2499.06 9818.06,-2489.88 9822.38,-2480.76"/>
<polygon fill="black" stroke="black" points="9825.56,-2482.23 9826.68,-2471.69 9819.23,-2479.23 9825.56,-2482.23"/>
</g>
<!-- layer14_gpu13_token_send&#45;&gt;layer14_expert_agg -->
<g id="edge1562" class="edge">
<title>layer14_gpu13_token_send&#45;&gt;layer14_expert_agg</title>
<path fill="none" stroke="black" d="M9609.02,-2387.99C9567.73,-2383.05 9525.18,-2378.61 9485,-2375.5 8787.13,-2321.54 6712.07,-2288.79 5854.42,-2277.23"/>
<polygon fill="black" stroke="black" points="5854.44,-2273.73 5844.39,-2277.1 5854.34,-2280.73 5854.44,-2273.73"/>
</g>
<!-- layer14_gpu14_expert_mlp1 -->
<g id="node1341" class="node">
<title>layer14_gpu14_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="10661.5,-2783.67 10200.5,-2783.67 10200.5,-2715.67 10661.5,-2715.67 10661.5,-2783.67"/>
<text text-anchor="middle" x="10431" y="-2768.47" font-family="Times,serif" font-size="14.00">Expert 14 MLP1</text>
<text text-anchor="middle" x="10431" y="-2753.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10431" y="-2738.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10431" y="-2723.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_gpu14_token_recv&#45;&gt;layer14_gpu14_expert_mlp1 -->
<g id="edge1564" class="edge">
<title>layer14_gpu14_token_recv&#45;&gt;layer14_gpu14_expert_mlp1</title>
<path fill="none" stroke="black" d="M10363.04,-2819.87C10372.4,-2810.34 10382.17,-2800.38 10391.29,-2791.1"/>
<polygon fill="black" stroke="black" points="10393.94,-2793.4 10398.45,-2783.81 10388.94,-2788.5 10393.94,-2793.4"/>
</g>
<!-- layer14_gpu14_expert_act -->
<g id="node1342" class="node">
<title>layer14_gpu14_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="10679.5,-2679.67 10302.5,-2679.67 10302.5,-2611.67 10679.5,-2611.67 10679.5,-2679.67"/>
<text text-anchor="middle" x="10491" y="-2664.47" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="10491" y="-2649.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10491" y="-2634.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10491" y="-2619.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_gpu14_expert_mlp1&#45;&gt;layer14_gpu14_expert_act -->
<g id="edge1565" class="edge">
<title>layer14_gpu14_expert_mlp1&#45;&gt;layer14_gpu14_expert_act</title>
<path fill="none" stroke="black" d="M10450.48,-2715.55C10455.51,-2707 10460.99,-2697.68 10466.25,-2688.74"/>
<polygon fill="black" stroke="black" points="10469.36,-2690.36 10471.41,-2679.97 10463.33,-2686.81 10469.36,-2690.36"/>
</g>
<!-- layer14_gpu14_expert_mlp2 -->
<g id="node1343" class="node">
<title>layer14_gpu14_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10773.5,-2575.67 10366.5,-2575.67 10366.5,-2507.67 10773.5,-2507.67 10773.5,-2575.67"/>
<text text-anchor="middle" x="10570" y="-2560.47" font-family="Times,serif" font-size="14.00">Expert 14 MLP2</text>
<text text-anchor="middle" x="10570" y="-2545.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10570" y="-2530.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="10570" y="-2515.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_gpu14_expert_act&#45;&gt;layer14_gpu14_expert_mlp2 -->
<g id="edge1566" class="edge">
<title>layer14_gpu14_expert_act&#45;&gt;layer14_gpu14_expert_mlp2</title>
<path fill="none" stroke="black" d="M10516.65,-2611.55C10523.48,-2602.73 10530.94,-2593.1 10538.06,-2583.9"/>
<polygon fill="black" stroke="black" points="10540.85,-2586.01 10544.21,-2575.97 10535.32,-2581.73 10540.85,-2586.01"/>
</g>
<!-- layer14_gpu14_token_send -->
<g id="node1344" class="node">
<title>layer14_gpu14_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="10578" cy="-2423.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="10578" y="-2442.38" font-family="Times,serif" font-size="14.00">Token Send GPU14</text>
<text text-anchor="middle" x="10578" y="-2427.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="10578" y="-2412.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="10578" y="-2397.38" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_gpu14_expert_mlp2&#45;&gt;layer14_gpu14_token_send -->
<g id="edge1567" class="edge">
<title>layer14_gpu14_expert_mlp2&#45;&gt;layer14_gpu14_token_send</title>
<path fill="none" stroke="black" d="M10572.29,-2507.4C10572.84,-2499.41 10573.45,-2490.64 10574.05,-2481.9"/>
<polygon fill="black" stroke="black" points="10577.56,-2481.91 10574.75,-2471.69 10570.57,-2481.43 10577.56,-2481.91"/>
</g>
<!-- layer14_gpu14_token_send&#45;&gt;layer14_expert_agg -->
<g id="edge1568" class="edge">
<title>layer14_gpu14_token_send&#45;&gt;layer14_expert_agg</title>
<path fill="none" stroke="black" d="M10339.01,-2387.97C10297.41,-2383 10254.51,-2378.55 10214,-2375.5 9369.31,-2311.87 6817.75,-2283.96 5852.45,-2275.47"/>
<polygon fill="black" stroke="black" points="5852.26,-2271.97 5842.22,-2275.38 5852.19,-2278.97 5852.26,-2271.97"/>
</g>
<!-- layer14_gpu15_expert_mlp1 -->
<g id="node1346" class="node">
<title>layer14_gpu15_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="11244.5,-2783.67 10783.5,-2783.67 10783.5,-2715.67 11244.5,-2715.67 11244.5,-2783.67"/>
<text text-anchor="middle" x="11014" y="-2768.47" font-family="Times,serif" font-size="14.00">Expert 15 MLP1</text>
<text text-anchor="middle" x="11014" y="-2753.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="11014" y="-2738.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11014" y="-2723.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer14_gpu15_token_recv&#45;&gt;layer14_gpu15_expert_mlp1 -->
<g id="edge1570" class="edge">
<title>layer14_gpu15_token_recv&#45;&gt;layer14_gpu15_expert_mlp1</title>
<path fill="none" stroke="black" d="M11008.07,-2819.53C11008.79,-2811.15 11009.54,-2802.45 11010.25,-2794.17"/>
<polygon fill="black" stroke="black" points="11013.76,-2794.23 11011.13,-2783.97 11006.79,-2793.63 11013.76,-2794.23"/>
</g>
<!-- layer14_gpu15_expert_act -->
<g id="node1347" class="node">
<title>layer14_gpu15_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="11222.5,-2679.67 10845.5,-2679.67 10845.5,-2611.67 11222.5,-2611.67 11222.5,-2679.67"/>
<text text-anchor="middle" x="11034" y="-2664.47" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="11034" y="-2649.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11034" y="-2634.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11034" y="-2619.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer14_gpu15_expert_mlp1&#45;&gt;layer14_gpu15_expert_act -->
<g id="edge1571" class="edge">
<title>layer14_gpu15_expert_mlp1&#45;&gt;layer14_gpu15_expert_act</title>
<path fill="none" stroke="black" d="M11020.49,-2715.55C11022.1,-2707.35 11023.85,-2698.45 11025.53,-2689.86"/>
<polygon fill="black" stroke="black" points="11028.98,-2690.45 11027.47,-2679.97 11022.11,-2689.11 11028.98,-2690.45"/>
</g>
<!-- layer14_gpu15_expert_mlp2 -->
<g id="node1348" class="node">
<title>layer14_gpu15_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="11237.5,-2575.67 10830.5,-2575.67 10830.5,-2507.67 11237.5,-2507.67 11237.5,-2575.67"/>
<text text-anchor="middle" x="11034" y="-2560.47" font-family="Times,serif" font-size="14.00">Expert 15 MLP2</text>
<text text-anchor="middle" x="11034" y="-2545.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11034" y="-2530.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="11034" y="-2515.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer14_gpu15_expert_act&#45;&gt;layer14_gpu15_expert_mlp2 -->
<g id="edge1572" class="edge">
<title>layer14_gpu15_expert_act&#45;&gt;layer14_gpu15_expert_mlp2</title>
<path fill="none" stroke="black" d="M11034,-2611.55C11034,-2603.44 11034,-2594.65 11034,-2586.14"/>
<polygon fill="black" stroke="black" points="11037.5,-2585.97 11034,-2575.97 11030.5,-2585.97 11037.5,-2585.97"/>
</g>
<!-- layer14_gpu15_token_send -->
<g id="node1349" class="node">
<title>layer14_gpu15_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="11307" cy="-2423.58" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="11307" y="-2442.38" font-family="Times,serif" font-size="14.00">Token Send GPU15</text>
<text text-anchor="middle" x="11307" y="-2427.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="11307" y="-2412.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="11307" y="-2397.38" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer14_gpu15_expert_mlp2&#45;&gt;layer14_gpu15_token_send -->
<g id="edge1573" class="edge">
<title>layer14_gpu15_expert_mlp2&#45;&gt;layer14_gpu15_token_send</title>
<path fill="none" stroke="black" d="M11111.87,-2507.56C11136.75,-2496.98 11164.84,-2485.03 11191.8,-2473.57"/>
<polygon fill="black" stroke="black" points="11193.44,-2476.67 11201.28,-2469.54 11190.7,-2470.23 11193.44,-2476.67"/>
</g>
<!-- layer14_gpu15_token_send&#45;&gt;layer14_expert_agg -->
<g id="edge1574" class="edge">
<title>layer14_gpu15_token_send&#45;&gt;layer14_expert_agg</title>
<path fill="none" stroke="black" d="M11068.02,-2387.87C11026.42,-2382.91 10983.51,-2378.49 10943,-2375.5 9950.22,-2302.16 6914.36,-2279.85 5850.26,-2274.19"/>
<polygon fill="black" stroke="black" points="5850.17,-2270.69 5840.15,-2274.13 5850.13,-2277.69 5850.17,-2270.69"/>
</g>
<!-- layer14_residual2 -->
<g id="node1351" class="node">
<title>layer14_residual2</title>
<polygon fill="lightyellow" stroke="black" points="5919.89,-2167.5 5215.35,-2167.5 5034.11,-2031.5 5738.65,-2031.5 5919.89,-2167.5"/>
<text text-anchor="middle" x="5477" y="-2118.3" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="5477" y="-2103.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5477" y="-2088.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-2073.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer14_expert_agg&#45;&gt;layer14_residual2 -->
<g id="edge1575" class="edge">
<title>layer14_expert_agg&#45;&gt;layer14_residual2</title>
<path fill="none" stroke="black" d="M5477,-2203.31C5477,-2195 5477,-2186.45 5477,-2177.99"/>
<polygon fill="black" stroke="black" points="5480.5,-2177.76 5477,-2167.76 5473.5,-2177.76 5480.5,-2177.76"/>
</g>
<!-- layer15_layernorm -->
<g id="node1352" class="node">
<title>layer15_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="5680.5,-1984.5 5273.5,-1984.5 5273.5,-1916.5 5680.5,-1916.5 5680.5,-1984.5"/>
<text text-anchor="middle" x="5477" y="-1969.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5477" y="-1954.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-1939.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-1924.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer14_residual2&#45;&gt;layer15_layernorm -->
<g id="edge1576" class="edge">
<title>layer14_residual2&#45;&gt;layer15_layernorm</title>
<path fill="none" stroke="black" d="M5477,-2031.45C5477,-2019.05 5477,-2006.39 5477,-1994.92"/>
<polygon fill="black" stroke="black" points="5480.5,-1994.76 5477,-1984.76 5473.5,-1994.76 5480.5,-1994.76"/>
</g>
<!-- layer15_qkv_proj -->
<g id="node1353" class="node">
<title>layer15_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="5734.5,-1880.5 5219.5,-1880.5 5219.5,-1812.5 5734.5,-1812.5 5734.5,-1880.5"/>
<text text-anchor="middle" x="5477" y="-1865.3" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5477" y="-1850.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-1835.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5477" y="-1820.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer15_layernorm&#45;&gt;layer15_qkv_proj -->
<g id="edge1577" class="edge">
<title>layer15_layernorm&#45;&gt;layer15_qkv_proj</title>
<path fill="none" stroke="black" d="M5477,-1916.38C5477,-1908.28 5477,-1899.48 5477,-1890.97"/>
<polygon fill="black" stroke="black" points="5480.5,-1890.8 5477,-1880.8 5473.5,-1890.8 5480.5,-1890.8"/>
</g>
<!-- layer15_attention -->
<g id="node1354" class="node">
<title>layer15_attention</title>
<polygon fill="lightgreen" stroke="black" points="5728.5,-1776.5 5225.5,-1776.5 5225.5,-1708.5 5728.5,-1708.5 5728.5,-1776.5"/>
<text text-anchor="middle" x="5477" y="-1761.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5477" y="-1746.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64, 3x]</text>
<text text-anchor="middle" x="5477" y="-1731.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5477" y="-1716.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer15_qkv_proj&#45;&gt;layer15_attention -->
<g id="edge1578" class="edge">
<title>layer15_qkv_proj&#45;&gt;layer15_attention</title>
<path fill="none" stroke="black" d="M5477,-1812.38C5477,-1804.28 5477,-1795.48 5477,-1786.97"/>
<polygon fill="black" stroke="black" points="5480.5,-1786.8 5477,-1776.8 5473.5,-1786.8 5480.5,-1786.8"/>
</g>
<!-- layer15_attn_out -->
<g id="node1355" class="node">
<title>layer15_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="5715.5,-1672.5 5238.5,-1672.5 5238.5,-1604.5 5715.5,-1604.5 5715.5,-1672.5"/>
<text text-anchor="middle" x="5477" y="-1657.3" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5477" y="-1642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, heads=16, head_dim=64]</text>
<text text-anchor="middle" x="5477" y="-1627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-1612.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer15_attention&#45;&gt;layer15_attn_out -->
<g id="edge1579" class="edge">
<title>layer15_attention&#45;&gt;layer15_attn_out</title>
<path fill="none" stroke="black" d="M5477,-1708.38C5477,-1700.28 5477,-1691.48 5477,-1682.97"/>
<polygon fill="black" stroke="black" points="5480.5,-1682.8 5477,-1672.8 5473.5,-1682.8 5480.5,-1682.8"/>
</g>
<!-- layer15_residual1 -->
<g id="node1356" class="node">
<title>layer15_residual1</title>
<polygon fill="lightyellow" stroke="black" points="5919.89,-1568.5 5215.35,-1568.5 5034.11,-1432.5 5738.65,-1432.5 5919.89,-1568.5"/>
<text text-anchor="middle" x="5477" y="-1519.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5477" y="-1504.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5477" y="-1489.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-1474.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer15_attn_out&#45;&gt;layer15_residual1 -->
<g id="edge1580" class="edge">
<title>layer15_attn_out&#45;&gt;layer15_residual1</title>
<path fill="none" stroke="black" d="M5477,-1604.23C5477,-1596.4 5477,-1587.74 5477,-1578.85"/>
<polygon fill="black" stroke="black" points="5480.5,-1578.76 5477,-1568.76 5473.5,-1578.76 5480.5,-1578.76"/>
</g>
<!-- layer15_layernorm2 -->
<g id="node1357" class="node">
<title>layer15_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="5680.5,-1396.5 5273.5,-1396.5 5273.5,-1328.5 5680.5,-1328.5 5680.5,-1396.5"/>
<text text-anchor="middle" x="5477" y="-1381.3" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5477" y="-1366.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-1351.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-1336.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer15_residual1&#45;&gt;layer15_layernorm2 -->
<g id="edge1581" class="edge">
<title>layer15_residual1&#45;&gt;layer15_layernorm2</title>
<path fill="none" stroke="black" d="M5477,-1432.3C5477,-1423.54 5477,-1414.77 5477,-1406.57"/>
<polygon fill="black" stroke="black" points="5480.5,-1406.52 5477,-1396.52 5473.5,-1406.52 5480.5,-1406.52"/>
</g>
<!-- layer15_global_gate -->
<g id="node1358" class="node">
<title>layer15_global_gate</title>
<polygon fill="lightgreen" stroke="black" points="5674.5,-1292.5 5279.5,-1292.5 5279.5,-1224.5 5674.5,-1224.5 5674.5,-1292.5"/>
<text text-anchor="middle" x="5477" y="-1277.3" font-family="Times,serif" font-size="14.00">Global Gate</text>
<text text-anchor="middle" x="5477" y="-1262.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-1247.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, experts=64]</text>
<text text-anchor="middle" x="5477" y="-1232.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer15_layernorm2&#45;&gt;layer15_global_gate -->
<g id="edge1582" class="edge">
<title>layer15_layernorm2&#45;&gt;layer15_global_gate</title>
<path fill="none" stroke="black" d="M5477,-1328.38C5477,-1320.28 5477,-1311.48 5477,-1302.97"/>
<polygon fill="black" stroke="black" points="5480.5,-1302.8 5477,-1292.8 5473.5,-1302.8 5480.5,-1302.8"/>
</g>
<!-- layer15_routing -->
<g id="node1359" class="node">
<title>layer15_routing</title>
<polygon fill="lightyellow" stroke="black" points="5963.47,-1188.5 5189.6,-1188.5 4990.53,-1052.5 5764.4,-1052.5 5963.47,-1188.5"/>
<text text-anchor="middle" x="5477" y="-1139.3" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="5477" y="-1124.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5477" y="-1109.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5477" y="-1094.3" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer15_global_gate&#45;&gt;layer15_routing -->
<g id="edge1583" class="edge">
<title>layer15_global_gate&#45;&gt;layer15_routing</title>
<path fill="none" stroke="black" d="M5477,-1224.23C5477,-1216.4 5477,-1207.74 5477,-1198.85"/>
<polygon fill="black" stroke="black" points="5480.5,-1198.76 5477,-1188.76 5473.5,-1198.76 5480.5,-1198.76"/>
</g>
<!-- layer15_gpu0_token_recv -->
<g id="node1360" class="node">
<title>layer15_gpu0_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="478" cy="-968.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="478" y="-987.22" font-family="Times,serif" font-size="14.00">Token Receive GPU0</text>
<text text-anchor="middle" x="478" y="-972.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="478" y="-957.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="478" y="-942.22" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer15_routing&#45;&gt;layer15_gpu0_token_recv -->
<g id="edge1584" class="edge">
<title>layer15_routing&#45;&gt;layer15_gpu0_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5082.88,-1115.72C4122.14,-1105.71 1678.61,-1075.13 864,-1016.5 819.38,-1013.29 772,-1008.58 726.27,-1003.38"/>
<polygon fill="black" stroke="black" points="726.57,-999.89 716.24,-1002.22 725.77,-1006.84 726.57,-999.89"/>
</g>
<!-- layer15_gpu1_token_recv -->
<g id="node1365" class="node">
<title>layer15_gpu1_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1207" cy="-968.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1207" y="-987.22" font-family="Times,serif" font-size="14.00">Token Receive GPU1</text>
<text text-anchor="middle" x="1207" y="-972.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1207" y="-957.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1207" y="-942.22" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer15_routing&#45;&gt;layer15_gpu1_token_recv -->
<g id="edge1590" class="edge">
<title>layer15_routing&#45;&gt;layer15_gpu1_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5080.48,-1114.18C4228.13,-1101.9 2244.25,-1068.59 1572,-1016.5 1532.42,-1013.43 1490.56,-1009.08 1449.85,-1004.25"/>
<polygon fill="black" stroke="black" points="1450.15,-1000.76 1439.8,-1003.05 1449.32,-1007.71 1450.15,-1000.76"/>
</g>
<!-- layer15_gpu2_token_recv -->
<g id="node1370" class="node">
<title>layer15_gpu2_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="1915" cy="-968.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="1915" y="-987.22" font-family="Times,serif" font-size="14.00">Token Receive GPU2</text>
<text text-anchor="middle" x="1915" y="-972.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="1915" y="-957.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1915" y="-942.22" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer15_routing&#45;&gt;layer15_gpu2_token_recv -->
<g id="edge1596" class="edge">
<title>layer15_routing&#45;&gt;layer15_gpu2_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5088.27,-1119.45C4484.43,-1116.57 3284.96,-1099.63 2271,-1016.5 2233.64,-1013.44 2194.19,-1009.21 2155.7,-1004.55"/>
<polygon fill="black" stroke="black" points="2155.75,-1001.03 2145.4,-1003.29 2154.9,-1007.98 2155.75,-1001.03"/>
</g>
<!-- layer15_gpu3_token_recv -->
<g id="node1375" class="node">
<title>layer15_gpu3_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="2614" cy="-968.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2614" y="-987.22" font-family="Times,serif" font-size="14.00">Token Receive GPU3</text>
<text text-anchor="middle" x="2614" y="-972.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="2614" y="-957.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2614" y="-942.22" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer15_routing&#45;&gt;layer15_gpu3_token_recv -->
<g id="edge1602" class="edge">
<title>layer15_routing&#45;&gt;layer15_gpu3_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5077.12,-1111.72C4590.61,-1100.19 3744.53,-1073.44 3021,-1016.5 2972.41,-1012.67 2920.66,-1007.52 2870.94,-1002.03"/>
<polygon fill="black" stroke="black" points="2871.02,-998.52 2860.69,-1000.89 2870.24,-1005.48 2871.02,-998.52"/>
</g>
<!-- layer15_gpu4_token_recv -->
<g id="node1380" class="node">
<title>layer15_gpu4_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="3364" cy="-968.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="3364" y="-987.22" font-family="Times,serif" font-size="14.00">Token Receive GPU4</text>
<text text-anchor="middle" x="3364" y="-972.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="3364" y="-957.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3364" y="-942.22" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer15_routing&#45;&gt;layer15_gpu4_token_recv -->
<g id="edge1608" class="edge">
<title>layer15_routing&#45;&gt;layer15_gpu4_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5063.81,-1102.66C4711.31,-1086.47 4191.23,-1058.24 3739,-1016.5 3698.55,-1012.77 3655.73,-1008.08 3614.05,-1003.13"/>
<polygon fill="black" stroke="black" points="3614.4,-999.65 3604.06,-1001.94 3613.57,-1006.6 3614.4,-999.65"/>
</g>
<!-- layer15_gpu5_token_recv -->
<g id="node1385" class="node">
<title>layer15_gpu5_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4082" cy="-968.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4082" y="-987.22" font-family="Times,serif" font-size="14.00">Token Receive GPU5</text>
<text text-anchor="middle" x="4082" y="-972.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4082" y="-957.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4082" y="-942.22" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer15_routing&#45;&gt;layer15_gpu5_token_recv -->
<g id="edge1614" class="edge">
<title>layer15_routing&#45;&gt;layer15_gpu5_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5027.4,-1077.8C4845.51,-1060.14 4633.61,-1038.56 4442,-1016.5 4406.66,-1012.43 4369.4,-1007.87 4332.79,-1003.22"/>
<polygon fill="black" stroke="black" points="4332.84,-999.7 4322.48,-1001.91 4331.96,-1006.65 4332.84,-999.7"/>
</g>
<!-- layer15_gpu6_token_recv -->
<g id="node1390" class="node">
<title>layer15_gpu6_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="4785" cy="-968.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4785" y="-987.22" font-family="Times,serif" font-size="14.00">Token Receive GPU6</text>
<text text-anchor="middle" x="4785" y="-972.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="4785" y="-957.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4785" y="-942.22" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer15_routing&#45;&gt;layer15_gpu6_token_recv -->
<g id="edge1620" class="edge">
<title>layer15_routing&#45;&gt;layer15_gpu6_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5167.94,-1052.47C5102.78,-1038.34 5035.85,-1023.82 4976.54,-1010.96"/>
<polygon fill="black" stroke="black" points="4977.22,-1007.53 4966.71,-1008.83 4975.74,-1014.37 4977.22,-1007.53"/>
</g>
<!-- layer15_gpu7_token_recv -->
<g id="node1395" class="node">
<title>layer15_gpu7_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="5477" cy="-968.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="5477" y="-987.22" font-family="Times,serif" font-size="14.00">Token Receive GPU7</text>
<text text-anchor="middle" x="5477" y="-972.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="5477" y="-957.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5477" y="-942.22" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer15_routing&#45;&gt;layer15_gpu7_token_recv -->
<g id="edge1626" class="edge">
<title>layer15_routing&#45;&gt;layer15_gpu7_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5477,-1052.36C5477,-1043.81 5477,-1035.13 5477,-1026.76"/>
<polygon fill="black" stroke="black" points="5480.5,-1026.73 5477,-1016.73 5473.5,-1026.73 5480.5,-1026.73"/>
</g>
<!-- layer15_gpu8_token_recv -->
<g id="node1400" class="node">
<title>layer15_gpu8_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6165" cy="-968.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6165" y="-987.22" font-family="Times,serif" font-size="14.00">Token Receive GPU8</text>
<text text-anchor="middle" x="6165" y="-972.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6165" y="-957.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6165" y="-942.22" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer15_routing&#45;&gt;layer15_gpu8_token_recv -->
<g id="edge1632" class="edge">
<title>layer15_routing&#45;&gt;layer15_gpu8_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5769.27,-1055.74C5838.41,-1040.66 5910.39,-1024.96 5973.71,-1011.14"/>
<polygon fill="black" stroke="black" points="5974.78,-1014.49 5983.8,-1008.94 5973.29,-1007.66 5974.78,-1014.49"/>
</g>
<!-- layer15_gpu9_token_recv -->
<g id="node1405" class="node">
<title>layer15_gpu9_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="6852" cy="-968.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6852" y="-987.22" font-family="Times,serif" font-size="14.00">Token Receive GPU9</text>
<text text-anchor="middle" x="6852" y="-972.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="6852" y="-957.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6852" y="-942.22" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer15_routing&#45;&gt;layer15_gpu9_token_recv -->
<g id="edge1638" class="edge">
<title>layer15_routing&#45;&gt;layer15_gpu9_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5817.49,-1088.63C6018.57,-1069.61 6278,-1043.72 6508,-1016.5 6540.01,-1012.71 6573.65,-1008.45 6606.85,-1004.08"/>
<polygon fill="black" stroke="black" points="6607.68,-1007.5 6617.14,-1002.72 6606.77,-1000.56 6607.68,-1007.5"/>
</g>
<!-- layer15_gpu10_token_recv -->
<g id="node1410" class="node">
<title>layer15_gpu10_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="7539" cy="-968.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="7539" y="-987.22" font-family="Times,serif" font-size="14.00">Token Receive GPU10</text>
<text text-anchor="middle" x="7539" y="-972.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="7539" y="-957.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7539" y="-942.22" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer15_routing&#45;&gt;layer15_gpu10_token_recv -->
<g id="edge1644" class="edge">
<title>layer15_routing&#45;&gt;layer15_gpu10_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5842.52,-1105.66C6190.76,-1090.56 6729.43,-1062.25 7195,-1016.5 7228.58,-1013.2 7263.92,-1009.09 7298.65,-1004.69"/>
<polygon fill="black" stroke="black" points="7299.44,-1008.12 7308.91,-1003.37 7298.55,-1001.17 7299.44,-1008.12"/>
</g>
<!-- layer15_gpu11_token_recv -->
<g id="node1415" class="node">
<title>layer15_gpu11_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8226" cy="-968.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8226" y="-987.22" font-family="Times,serif" font-size="14.00">Token Receive GPU11</text>
<text text-anchor="middle" x="8226" y="-972.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8226" y="-957.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8226" y="-942.22" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer15_routing&#45;&gt;layer15_gpu11_token_recv -->
<g id="edge1650" class="edge">
<title>layer15_routing&#45;&gt;layer15_gpu11_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5854.96,-1114.2C6329.25,-1105.04 7167.22,-1080.58 7882,-1016.5 7916.3,-1013.42 7952.42,-1009.38 7987.84,-1004.94"/>
<polygon fill="black" stroke="black" points="7988.33,-1008.41 7997.82,-1003.68 7987.46,-1001.47 7988.33,-1008.41"/>
</g>
<!-- layer15_gpu12_token_recv -->
<g id="node1420" class="node">
<title>layer15_gpu12_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="8913" cy="-968.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8913" y="-987.22" font-family="Times,serif" font-size="14.00">Token Receive GPU12</text>
<text text-anchor="middle" x="8913" y="-972.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="8913" y="-957.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8913" y="-942.22" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer15_routing&#45;&gt;layer15_gpu12_token_recv -->
<g id="edge1656" class="edge">
<title>layer15_routing&#45;&gt;layer15_gpu12_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5862.47,-1119.36C6448.24,-1116.27 7597.15,-1098.98 8569,-1016.5 8603.73,-1013.55 8640.31,-1009.54 8676.15,-1005.08"/>
<polygon fill="black" stroke="black" points="8676.74,-1008.53 8686.23,-1003.81 8675.87,-1001.59 8676.74,-1008.53"/>
</g>
<!-- layer15_gpu13_token_recv -->
<g id="node1425" class="node">
<title>layer15_gpu13_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="9600" cy="-968.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="9600" y="-987.22" font-family="Times,serif" font-size="14.00">Token Receive GPU13</text>
<text text-anchor="middle" x="9600" y="-972.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="9600" y="-957.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9600" y="-942.22" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer15_routing&#45;&gt;layer15_gpu13_token_recv -->
<g id="edge1662" class="edge">
<title>layer15_routing&#45;&gt;layer15_gpu13_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5855.33,-1114.43C6677.21,-1102.55 8604.22,-1069.83 9256,-1016.5 9291.01,-1013.64 9327.9,-1009.64 9364.01,-1005.17"/>
<polygon fill="black" stroke="black" points="9364.68,-1008.61 9374.17,-1003.89 9363.81,-1001.66 9364.68,-1008.61"/>
</g>
<!-- layer15_gpu14_token_recv -->
<g id="node1430" class="node">
<title>layer15_gpu14_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10287" cy="-968.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10287" y="-987.22" font-family="Times,serif" font-size="14.00">Token Receive GPU14</text>
<text text-anchor="middle" x="10287" y="-972.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10287" y="-957.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10287" y="-942.22" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer15_routing&#45;&gt;layer15_gpu14_token_recv -->
<g id="edge1668" class="edge">
<title>layer15_routing&#45;&gt;layer15_gpu14_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5857.76,-1116.25C6787.42,-1107.43 9154.56,-1079.35 9943,-1016.5 9978.15,-1013.7 10015.2,-1009.72 10051.45,-1005.24"/>
<polygon fill="black" stroke="black" points="10052.16,-1008.68 10061.65,-1003.97 10051.29,-1001.74 10052.16,-1008.68"/>
</g>
<!-- layer15_gpu15_token_recv -->
<g id="node1435" class="node">
<title>layer15_gpu15_token_recv</title>
<ellipse fill="lightblue" stroke="black" cx="10974" cy="-968.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="10974" y="-987.22" font-family="Times,serif" font-size="14.00">Token Receive GPU15</text>
<text text-anchor="middle" x="10974" y="-972.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (routed)</text>
<text text-anchor="middle" x="10974" y="-957.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10974" y="-942.22" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_routing&#45;&gt;layer15_gpu15_token_recv -->
<g id="edge1674" class="edge">
<title>layer15_routing&#45;&gt;layer15_gpu15_token_recv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5859.8,-1117.61C6889.63,-1111.61 9703.77,-1088.9 10630,-1016.5 10665.29,-1013.74 10702.5,-1009.77 10738.88,-1005.29"/>
<polygon fill="black" stroke="black" points="10739.63,-1008.72 10749.12,-1004.01 10738.76,-1001.78 10739.63,-1008.72"/>
</g>
<!-- layer15_gpu0_expert_mlp1 -->
<g id="node1361" class="node">
<title>layer15_gpu0_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="698.5,-884.33 237.5,-884.33 237.5,-816.33 698.5,-816.33 698.5,-884.33"/>
<text text-anchor="middle" x="468" y="-869.13" font-family="Times,serif" font-size="14.00">Expert 0 MLP1</text>
<text text-anchor="middle" x="468" y="-854.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="468" y="-839.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="468" y="-824.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer15_gpu0_token_recv&#45;&gt;layer15_gpu0_expert_mlp1 -->
<g id="edge1585" class="edge">
<title>layer15_gpu0_token_recv&#45;&gt;layer15_gpu0_expert_mlp1</title>
<path fill="none" stroke="black" d="M473.93,-920.2C473.21,-911.82 472.46,-903.12 471.75,-894.84"/>
<polygon fill="black" stroke="black" points="475.21,-894.3 470.87,-884.64 468.24,-894.9 475.21,-894.3"/>
</g>
<!-- layer15_gpu0_expert_act -->
<g id="node1362" class="node">
<title>layer15_gpu0_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="636.5,-780.33 259.5,-780.33 259.5,-712.33 636.5,-712.33 636.5,-780.33"/>
<text text-anchor="middle" x="448" y="-765.13" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="448" y="-750.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="448" y="-735.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="448" y="-720.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer15_gpu0_expert_mlp1&#45;&gt;layer15_gpu0_expert_act -->
<g id="edge1586" class="edge">
<title>layer15_gpu0_expert_mlp1&#45;&gt;layer15_gpu0_expert_act</title>
<path fill="none" stroke="black" d="M461.51,-816.22C459.9,-808.02 458.15,-799.12 456.47,-790.52"/>
<polygon fill="black" stroke="black" points="459.89,-789.77 454.53,-780.63 453.02,-791.12 459.89,-789.77"/>
</g>
<!-- layer15_gpu0_expert_mlp2 -->
<g id="node1363" class="node">
<title>layer15_gpu0_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="613.5,-676.33 206.5,-676.33 206.5,-608.33 613.5,-608.33 613.5,-676.33"/>
<text text-anchor="middle" x="410" y="-661.13" font-family="Times,serif" font-size="14.00">Expert 0 MLP2</text>
<text text-anchor="middle" x="410" y="-646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="410" y="-631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="410" y="-616.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer15_gpu0_expert_act&#45;&gt;layer15_gpu0_expert_mlp2 -->
<g id="edge1587" class="edge">
<title>layer15_gpu0_expert_act&#45;&gt;layer15_gpu0_expert_mlp2</title>
<path fill="none" stroke="black" d="M435.66,-712.22C432.58,-703.93 429.22,-694.93 425.99,-686.24"/>
<polygon fill="black" stroke="black" points="429.18,-684.78 422.41,-676.63 422.62,-687.23 429.18,-684.78"/>
</g>
<!-- layer15_gpu0_token_send -->
<g id="node1364" class="node">
<title>layer15_gpu0_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="372" cy="-524.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="372" y="-543.05" font-family="Times,serif" font-size="14.00">Token Send GPU0</text>
<text text-anchor="middle" x="372" y="-528.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="372" y="-513.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="372" y="-498.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer15_gpu0_expert_mlp2&#45;&gt;layer15_gpu0_token_send -->
<g id="edge1588" class="edge">
<title>layer15_gpu0_expert_mlp2&#45;&gt;layer15_gpu0_token_send</title>
<path fill="none" stroke="black" d="M399.11,-608.07C396.44,-599.9 393.5,-590.93 390.58,-582"/>
<polygon fill="black" stroke="black" points="393.86,-580.77 387.42,-572.36 387.21,-582.95 393.86,-580.77"/>
</g>
<!-- layer15_expert_agg -->
<g id="node1440" class="node">
<title>layer15_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="6291.05,-440.17 5571.94,-440.17 5386.95,-304.17 6106.06,-304.17 6291.05,-440.17"/>
<text text-anchor="middle" x="5839" y="-390.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5839" y="-375.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x16)</text>
<text text-anchor="middle" x="5839" y="-360.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5839" y="-345.97" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer15_gpu0_token_send&#45;&gt;layer15_expert_agg -->
<g id="edge1589" class="edge">
<title>layer15_gpu0_token_send&#45;&gt;layer15_expert_agg</title>
<path fill="none" stroke="black" d="M610.99,-488.58C652.58,-483.62 695.49,-479.19 736,-476.17 1657.51,-407.47 4464.63,-382.34 5473.25,-375.39"/>
<polygon fill="black" stroke="black" points="5473.58,-378.89 5483.56,-375.32 5473.54,-371.89 5473.58,-378.89"/>
</g>
<!-- layer15_gpu1_expert_mlp1 -->
<g id="node1366" class="node">
<title>layer15_gpu1_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="1427.5,-884.33 966.5,-884.33 966.5,-816.33 1427.5,-816.33 1427.5,-884.33"/>
<text text-anchor="middle" x="1197" y="-869.13" font-family="Times,serif" font-size="14.00">Expert 1 MLP1</text>
<text text-anchor="middle" x="1197" y="-854.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1197" y="-839.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1197" y="-824.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer15_gpu1_token_recv&#45;&gt;layer15_gpu1_expert_mlp1 -->
<g id="edge1591" class="edge">
<title>layer15_gpu1_token_recv&#45;&gt;layer15_gpu1_expert_mlp1</title>
<path fill="none" stroke="black" d="M1202.93,-920.2C1202.21,-911.82 1201.46,-903.12 1200.75,-894.84"/>
<polygon fill="black" stroke="black" points="1204.21,-894.3 1199.87,-884.64 1197.24,-894.9 1204.21,-894.3"/>
</g>
<!-- layer15_gpu1_expert_act -->
<g id="node1367" class="node">
<title>layer15_gpu1_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="1365.5,-780.33 988.5,-780.33 988.5,-712.33 1365.5,-712.33 1365.5,-780.33"/>
<text text-anchor="middle" x="1177" y="-765.13" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1177" y="-750.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1177" y="-735.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1177" y="-720.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer15_gpu1_expert_mlp1&#45;&gt;layer15_gpu1_expert_act -->
<g id="edge1592" class="edge">
<title>layer15_gpu1_expert_mlp1&#45;&gt;layer15_gpu1_expert_act</title>
<path fill="none" stroke="black" d="M1190.51,-816.22C1188.9,-808.02 1187.15,-799.12 1185.47,-790.52"/>
<polygon fill="black" stroke="black" points="1188.89,-789.77 1183.53,-780.63 1182.02,-791.12 1188.89,-789.77"/>
</g>
<!-- layer15_gpu1_expert_mlp2 -->
<g id="node1368" class="node">
<title>layer15_gpu1_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="1342.5,-676.33 935.5,-676.33 935.5,-608.33 1342.5,-608.33 1342.5,-676.33"/>
<text text-anchor="middle" x="1139" y="-661.13" font-family="Times,serif" font-size="14.00">Expert 1 MLP2</text>
<text text-anchor="middle" x="1139" y="-646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1139" y="-631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1139" y="-616.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer15_gpu1_expert_act&#45;&gt;layer15_gpu1_expert_mlp2 -->
<g id="edge1593" class="edge">
<title>layer15_gpu1_expert_act&#45;&gt;layer15_gpu1_expert_mlp2</title>
<path fill="none" stroke="black" d="M1164.66,-712.22C1161.58,-703.93 1158.22,-694.93 1154.99,-686.24"/>
<polygon fill="black" stroke="black" points="1158.18,-684.78 1151.41,-676.63 1151.62,-687.23 1158.18,-684.78"/>
</g>
<!-- layer15_gpu1_token_send -->
<g id="node1369" class="node">
<title>layer15_gpu1_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1101" cy="-524.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1101" y="-543.05" font-family="Times,serif" font-size="14.00">Token Send GPU1</text>
<text text-anchor="middle" x="1101" y="-528.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1101" y="-513.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1101" y="-498.05" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer15_gpu1_expert_mlp2&#45;&gt;layer15_gpu1_token_send -->
<g id="edge1594" class="edge">
<title>layer15_gpu1_expert_mlp2&#45;&gt;layer15_gpu1_token_send</title>
<path fill="none" stroke="black" d="M1128.11,-608.07C1125.44,-599.9 1122.5,-590.93 1119.58,-582"/>
<polygon fill="black" stroke="black" points="1122.86,-580.77 1116.42,-572.36 1116.21,-582.95 1122.86,-580.77"/>
</g>
<!-- layer15_gpu1_token_send&#45;&gt;layer15_expert_agg -->
<g id="edge1595" class="edge">
<title>layer15_gpu1_token_send&#45;&gt;layer15_expert_agg</title>
<path fill="none" stroke="black" d="M1340.48,-488.64C1381.93,-483.69 1424.65,-479.24 1465,-476.17 2240.04,-417.08 4571.4,-386.64 5475.32,-376.8"/>
<polygon fill="black" stroke="black" points="5475.6,-380.3 5485.56,-376.69 5475.52,-373.3 5475.6,-380.3"/>
</g>
<!-- layer15_gpu2_expert_mlp1 -->
<g id="node1371" class="node">
<title>layer15_gpu2_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2120.5,-884.33 1659.5,-884.33 1659.5,-816.33 2120.5,-816.33 2120.5,-884.33"/>
<text text-anchor="middle" x="1890" y="-869.13" font-family="Times,serif" font-size="14.00">Expert 2 MLP1</text>
<text text-anchor="middle" x="1890" y="-854.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="1890" y="-839.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1890" y="-824.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer15_gpu2_token_recv&#45;&gt;layer15_gpu2_expert_mlp1 -->
<g id="edge1597" class="edge">
<title>layer15_gpu2_token_recv&#45;&gt;layer15_gpu2_expert_mlp1</title>
<path fill="none" stroke="black" d="M1904.83,-920.2C1903.01,-911.72 1901.11,-902.92 1899.31,-894.56"/>
<polygon fill="black" stroke="black" points="1902.7,-893.68 1897.17,-884.64 1895.86,-895.15 1902.7,-893.68"/>
</g>
<!-- layer15_gpu2_expert_act -->
<g id="node1372" class="node">
<title>layer15_gpu2_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2049.5,-780.33 1672.5,-780.33 1672.5,-712.33 2049.5,-712.33 2049.5,-780.33"/>
<text text-anchor="middle" x="1861" y="-765.13" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="1861" y="-750.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1861" y="-735.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1861" y="-720.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer15_gpu2_expert_mlp1&#45;&gt;layer15_gpu2_expert_act -->
<g id="edge1598" class="edge">
<title>layer15_gpu2_expert_mlp1&#45;&gt;layer15_gpu2_expert_act</title>
<path fill="none" stroke="black" d="M1880.58,-816.22C1878.25,-808.02 1875.72,-799.12 1873.28,-790.52"/>
<polygon fill="black" stroke="black" points="1876.57,-789.29 1870.47,-780.63 1869.84,-791.21 1876.57,-789.29"/>
</g>
<!-- layer15_gpu2_expert_mlp2 -->
<g id="node1373" class="node">
<title>layer15_gpu2_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2053.5,-676.33 1646.5,-676.33 1646.5,-608.33 2053.5,-608.33 2053.5,-676.33"/>
<text text-anchor="middle" x="1850" y="-661.13" font-family="Times,serif" font-size="14.00">Expert 2 MLP2</text>
<text text-anchor="middle" x="1850" y="-646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="1850" y="-631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="1850" y="-616.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer15_gpu2_expert_act&#45;&gt;layer15_gpu2_expert_mlp2 -->
<g id="edge1599" class="edge">
<title>layer15_gpu2_expert_act&#45;&gt;layer15_gpu2_expert_mlp2</title>
<path fill="none" stroke="black" d="M1857.43,-712.22C1856.55,-704.11 1855.61,-695.32 1854.69,-686.81"/>
<polygon fill="black" stroke="black" points="1858.14,-686.2 1853.59,-676.63 1851.18,-686.95 1858.14,-686.2"/>
</g>
<!-- layer15_gpu2_token_send -->
<g id="node1374" class="node">
<title>layer15_gpu2_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="1830" cy="-524.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="1830" y="-543.05" font-family="Times,serif" font-size="14.00">Token Send GPU2</text>
<text text-anchor="middle" x="1830" y="-528.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="1830" y="-513.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="1830" y="-498.05" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer15_gpu2_expert_mlp2&#45;&gt;layer15_gpu2_token_send -->
<g id="edge1600" class="edge">
<title>layer15_gpu2_expert_mlp2&#45;&gt;layer15_gpu2_token_send</title>
<path fill="none" stroke="black" d="M1844.27,-608.07C1842.88,-599.99 1841.35,-591.12 1839.83,-582.28"/>
<polygon fill="black" stroke="black" points="1843.26,-581.62 1838.12,-572.36 1836.37,-582.81 1843.26,-581.62"/>
</g>
<!-- layer15_gpu2_token_send&#45;&gt;layer15_expert_agg -->
<g id="edge1601" class="edge">
<title>layer15_gpu2_token_send&#45;&gt;layer15_expert_agg</title>
<path fill="none" stroke="black" d="M2069.99,-488.74C2111.28,-483.8 2153.82,-479.32 2194,-476.17 2823.89,-426.65 4687.6,-391.73 5478.06,-378.75"/>
<polygon fill="black" stroke="black" points="5478.23,-382.25 5488.17,-378.58 5478.12,-375.25 5478.23,-382.25"/>
</g>
<!-- layer15_gpu3_expert_mlp1 -->
<g id="node1376" class="node">
<title>layer15_gpu3_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="2831.5,-884.33 2370.5,-884.33 2370.5,-816.33 2831.5,-816.33 2831.5,-884.33"/>
<text text-anchor="middle" x="2601" y="-869.13" font-family="Times,serif" font-size="14.00">Expert 3 MLP1</text>
<text text-anchor="middle" x="2601" y="-854.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="2601" y="-839.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2601" y="-824.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer15_gpu3_token_recv&#45;&gt;layer15_gpu3_expert_mlp1 -->
<g id="edge1603" class="edge">
<title>layer15_gpu3_token_recv&#45;&gt;layer15_gpu3_expert_mlp1</title>
<path fill="none" stroke="black" d="M2608.71,-920.2C2607.77,-911.82 2606.8,-903.12 2605.87,-894.84"/>
<polygon fill="black" stroke="black" points="2609.32,-894.19 2604.73,-884.64 2602.36,-894.96 2609.32,-894.19"/>
</g>
<!-- layer15_gpu3_expert_act -->
<g id="node1377" class="node">
<title>layer15_gpu3_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="2781.5,-780.33 2404.5,-780.33 2404.5,-712.33 2781.5,-712.33 2781.5,-780.33"/>
<text text-anchor="middle" x="2593" y="-765.13" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="2593" y="-750.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2593" y="-735.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2593" y="-720.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer15_gpu3_expert_mlp1&#45;&gt;layer15_gpu3_expert_act -->
<g id="edge1604" class="edge">
<title>layer15_gpu3_expert_mlp1&#45;&gt;layer15_gpu3_expert_act</title>
<path fill="none" stroke="black" d="M2598.4,-816.22C2597.77,-808.11 2597.08,-799.32 2596.41,-790.81"/>
<polygon fill="black" stroke="black" points="2599.88,-790.33 2595.61,-780.63 2592.9,-790.88 2599.88,-790.33"/>
</g>
<!-- layer15_gpu3_expert_mlp2 -->
<g id="node1378" class="node">
<title>layer15_gpu3_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="2784.5,-676.33 2377.5,-676.33 2377.5,-608.33 2784.5,-608.33 2784.5,-676.33"/>
<text text-anchor="middle" x="2581" y="-661.13" font-family="Times,serif" font-size="14.00">Expert 3 MLP2</text>
<text text-anchor="middle" x="2581" y="-646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="2581" y="-631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="2581" y="-616.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer15_gpu3_expert_act&#45;&gt;layer15_gpu3_expert_mlp2 -->
<g id="edge1605" class="edge">
<title>layer15_gpu3_expert_act&#45;&gt;layer15_gpu3_expert_mlp2</title>
<path fill="none" stroke="black" d="M2589.1,-712.22C2588.15,-704.11 2587.12,-695.32 2586.11,-686.81"/>
<polygon fill="black" stroke="black" points="2589.56,-686.15 2584.92,-676.63 2582.61,-686.97 2589.56,-686.15"/>
</g>
<!-- layer15_gpu3_token_send -->
<g id="node1379" class="node">
<title>layer15_gpu3_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="2559" cy="-524.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="2559" y="-543.05" font-family="Times,serif" font-size="14.00">Token Send GPU3</text>
<text text-anchor="middle" x="2559" y="-528.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="2559" y="-513.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="2559" y="-498.05" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer15_gpu3_expert_mlp2&#45;&gt;layer15_gpu3_token_send -->
<g id="edge1606" class="edge">
<title>layer15_gpu3_expert_mlp2&#45;&gt;layer15_gpu3_token_send</title>
<path fill="none" stroke="black" d="M2574.7,-608.07C2573.16,-599.99 2571.48,-591.12 2569.81,-582.28"/>
<polygon fill="black" stroke="black" points="2573.23,-581.53 2567.93,-572.36 2566.35,-582.84 2573.23,-581.53"/>
</g>
<!-- layer15_gpu3_token_send&#45;&gt;layer15_expert_agg -->
<g id="edge1607" class="edge">
<title>layer15_gpu3_token_send&#45;&gt;layer15_expert_agg</title>
<path fill="none" stroke="black" d="M2799.99,-488.86C2840.96,-483.94 2883.15,-479.44 2923,-476.17 3838.44,-400.96 4919.99,-380.62 5473.07,-375.15"/>
<polygon fill="black" stroke="black" points="5473.23,-378.65 5483.2,-375.05 5473.17,-371.65 5473.23,-378.65"/>
</g>
<!-- layer15_gpu4_expert_mlp1 -->
<g id="node1381" class="node">
<title>layer15_gpu4_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="3584.5,-884.33 3123.5,-884.33 3123.5,-816.33 3584.5,-816.33 3584.5,-884.33"/>
<text text-anchor="middle" x="3354" y="-869.13" font-family="Times,serif" font-size="14.00">Expert 4 MLP1</text>
<text text-anchor="middle" x="3354" y="-854.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="3354" y="-839.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3354" y="-824.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer15_gpu4_token_recv&#45;&gt;layer15_gpu4_expert_mlp1 -->
<g id="edge1609" class="edge">
<title>layer15_gpu4_token_recv&#45;&gt;layer15_gpu4_expert_mlp1</title>
<path fill="none" stroke="black" d="M3359.93,-920.2C3359.21,-911.82 3358.46,-903.12 3357.75,-894.84"/>
<polygon fill="black" stroke="black" points="3361.21,-894.3 3356.87,-884.64 3354.24,-894.9 3361.21,-894.3"/>
</g>
<!-- layer15_gpu4_expert_act -->
<g id="node1382" class="node">
<title>layer15_gpu4_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="3532.5,-780.33 3155.5,-780.33 3155.5,-712.33 3532.5,-712.33 3532.5,-780.33"/>
<text text-anchor="middle" x="3344" y="-765.13" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="3344" y="-750.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3344" y="-735.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3344" y="-720.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer15_gpu4_expert_mlp1&#45;&gt;layer15_gpu4_expert_act -->
<g id="edge1610" class="edge">
<title>layer15_gpu4_expert_mlp1&#45;&gt;layer15_gpu4_expert_act</title>
<path fill="none" stroke="black" d="M3350.75,-816.22C3349.96,-808.11 3349.1,-799.32 3348.26,-790.81"/>
<polygon fill="black" stroke="black" points="3351.72,-790.24 3347.26,-780.63 3344.76,-790.93 3351.72,-790.24"/>
</g>
<!-- layer15_gpu4_expert_mlp2 -->
<g id="node1383" class="node">
<title>layer15_gpu4_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="3527.5,-676.33 3120.5,-676.33 3120.5,-608.33 3527.5,-608.33 3527.5,-676.33"/>
<text text-anchor="middle" x="3324" y="-661.13" font-family="Times,serif" font-size="14.00">Expert 4 MLP2</text>
<text text-anchor="middle" x="3324" y="-646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="3324" y="-631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="3324" y="-616.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer15_gpu4_expert_act&#45;&gt;layer15_gpu4_expert_mlp2 -->
<g id="edge1611" class="edge">
<title>layer15_gpu4_expert_act&#45;&gt;layer15_gpu4_expert_mlp2</title>
<path fill="none" stroke="black" d="M3337.51,-712.22C3335.9,-704.02 3334.15,-695.12 3332.47,-686.52"/>
<polygon fill="black" stroke="black" points="3335.89,-685.77 3330.53,-676.63 3329.02,-687.12 3335.89,-685.77"/>
</g>
<!-- layer15_gpu4_token_send -->
<g id="node1384" class="node">
<title>layer15_gpu4_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="3288" cy="-524.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="3288" y="-543.05" font-family="Times,serif" font-size="14.00">Token Send GPU4</text>
<text text-anchor="middle" x="3288" y="-528.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="3288" y="-513.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="3288" y="-498.05" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer15_gpu4_expert_mlp2&#45;&gt;layer15_gpu4_token_send -->
<g id="edge1612" class="edge">
<title>layer15_gpu4_expert_mlp2&#45;&gt;layer15_gpu4_token_send</title>
<path fill="none" stroke="black" d="M3313.68,-608.07C3311.15,-599.9 3308.37,-590.93 3305.6,-582"/>
<polygon fill="black" stroke="black" points="3308.91,-580.87 3302.61,-572.36 3302.23,-582.95 3308.91,-580.87"/>
</g>
<!-- layer15_gpu4_token_send&#45;&gt;layer15_expert_agg -->
<g id="edge1613" class="edge">
<title>layer15_gpu4_token_send&#45;&gt;layer15_expert_agg</title>
<path fill="none" stroke="black" d="M3530.98,-489.03C3571.34,-484.14 3612.8,-479.62 3652,-476.17 4294.89,-419.54 5047.02,-392.72 5480.7,-381.08"/>
<polygon fill="black" stroke="black" points="5480.98,-384.57 5490.88,-380.81 5480.79,-377.57 5480.98,-384.57"/>
</g>
<!-- layer15_gpu5_expert_mlp1 -->
<g id="node1386" class="node">
<title>layer15_gpu5_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="4289.5,-884.33 3828.5,-884.33 3828.5,-816.33 4289.5,-816.33 4289.5,-884.33"/>
<text text-anchor="middle" x="4059" y="-869.13" font-family="Times,serif" font-size="14.00">Expert 5 MLP1</text>
<text text-anchor="middle" x="4059" y="-854.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4059" y="-839.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4059" y="-824.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer15_gpu5_token_recv&#45;&gt;layer15_gpu5_expert_mlp1 -->
<g id="edge1615" class="edge">
<title>layer15_gpu5_token_recv&#45;&gt;layer15_gpu5_expert_mlp1</title>
<path fill="none" stroke="black" d="M4072.65,-920.2C4070.97,-911.72 4069.22,-902.92 4067.57,-894.56"/>
<polygon fill="black" stroke="black" points="4070.98,-893.77 4065.6,-884.64 4064.11,-895.13 4070.98,-893.77"/>
</g>
<!-- layer15_gpu5_expert_act -->
<g id="node1387" class="node">
<title>layer15_gpu5_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4235.5,-780.33 3858.5,-780.33 3858.5,-712.33 4235.5,-712.33 4235.5,-780.33"/>
<text text-anchor="middle" x="4047" y="-765.13" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="4047" y="-750.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4047" y="-735.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4047" y="-720.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer15_gpu5_expert_mlp1&#45;&gt;layer15_gpu5_expert_act -->
<g id="edge1616" class="edge">
<title>layer15_gpu5_expert_mlp1&#45;&gt;layer15_gpu5_expert_act</title>
<path fill="none" stroke="black" d="M4055.1,-816.22C4054.15,-808.11 4053.12,-799.32 4052.11,-790.81"/>
<polygon fill="black" stroke="black" points="4055.56,-790.15 4050.92,-780.63 4048.61,-790.97 4055.56,-790.15"/>
</g>
<!-- layer15_gpu5_expert_mlp2 -->
<g id="node1388" class="node">
<title>layer15_gpu5_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4239.5,-676.33 3832.5,-676.33 3832.5,-608.33 4239.5,-608.33 4239.5,-676.33"/>
<text text-anchor="middle" x="4036" y="-661.13" font-family="Times,serif" font-size="14.00">Expert 5 MLP2</text>
<text text-anchor="middle" x="4036" y="-646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4036" y="-631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4036" y="-616.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer15_gpu5_expert_act&#45;&gt;layer15_gpu5_expert_mlp2 -->
<g id="edge1617" class="edge">
<title>layer15_gpu5_expert_act&#45;&gt;layer15_gpu5_expert_mlp2</title>
<path fill="none" stroke="black" d="M4043.43,-712.22C4042.55,-704.11 4041.61,-695.32 4040.69,-686.81"/>
<polygon fill="black" stroke="black" points="4044.14,-686.2 4039.59,-676.63 4037.18,-686.95 4044.14,-686.2"/>
</g>
<!-- layer15_gpu5_token_send -->
<g id="node1389" class="node">
<title>layer15_gpu5_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4017" cy="-524.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4017" y="-543.05" font-family="Times,serif" font-size="14.00">Token Send GPU5</text>
<text text-anchor="middle" x="4017" y="-528.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4017" y="-513.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4017" y="-498.05" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer15_gpu5_expert_mlp2&#45;&gt;layer15_gpu5_token_send -->
<g id="edge1618" class="edge">
<title>layer15_gpu5_expert_mlp2&#45;&gt;layer15_gpu5_token_send</title>
<path fill="none" stroke="black" d="M4030.56,-608.07C4029.23,-599.99 4027.78,-591.12 4026.33,-582.28"/>
<polygon fill="black" stroke="black" points="4029.78,-581.66 4024.71,-572.36 4022.87,-582.79 4029.78,-581.66"/>
</g>
<!-- layer15_gpu5_token_send&#45;&gt;layer15_expert_agg -->
<g id="edge1619" class="edge">
<title>layer15_gpu5_token_send&#45;&gt;layer15_expert_agg</title>
<path fill="none" stroke="black" d="M4263,-489.46C4302.42,-484.61 4342.8,-479.98 4381,-476.17 4761.58,-438.14 5199.43,-409.19 5495.18,-391.8"/>
<polygon fill="black" stroke="black" points="5495.43,-395.3 5505.2,-391.22 5495.02,-388.31 5495.43,-395.3"/>
</g>
<!-- layer15_gpu6_expert_mlp1 -->
<g id="node1391" class="node">
<title>layer15_gpu6_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5005.5,-884.33 4544.5,-884.33 4544.5,-816.33 5005.5,-816.33 5005.5,-884.33"/>
<text text-anchor="middle" x="4775" y="-869.13" font-family="Times,serif" font-size="14.00">Expert 6 MLP1</text>
<text text-anchor="middle" x="4775" y="-854.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="4775" y="-839.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4775" y="-824.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer15_gpu6_token_recv&#45;&gt;layer15_gpu6_expert_mlp1 -->
<g id="edge1621" class="edge">
<title>layer15_gpu6_token_recv&#45;&gt;layer15_gpu6_expert_mlp1</title>
<path fill="none" stroke="black" d="M4780.93,-920.2C4780.21,-911.82 4779.46,-903.12 4778.75,-894.84"/>
<polygon fill="black" stroke="black" points="4782.21,-894.3 4777.87,-884.64 4775.24,-894.9 4782.21,-894.3"/>
</g>
<!-- layer15_gpu6_expert_act -->
<g id="node1392" class="node">
<title>layer15_gpu6_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="4942.5,-780.33 4565.5,-780.33 4565.5,-712.33 4942.5,-712.33 4942.5,-780.33"/>
<text text-anchor="middle" x="4754" y="-765.13" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="4754" y="-750.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4754" y="-735.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4754" y="-720.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer15_gpu6_expert_mlp1&#45;&gt;layer15_gpu6_expert_act -->
<g id="edge1622" class="edge">
<title>layer15_gpu6_expert_mlp1&#45;&gt;layer15_gpu6_expert_act</title>
<path fill="none" stroke="black" d="M4768.18,-816.22C4766.49,-808.02 4764.66,-799.12 4762.89,-790.52"/>
<polygon fill="black" stroke="black" points="4766.3,-789.72 4760.86,-780.63 4759.44,-791.13 4766.3,-789.72"/>
</g>
<!-- layer15_gpu6_expert_mlp2 -->
<g id="node1393" class="node">
<title>layer15_gpu6_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="4954.5,-676.33 4547.5,-676.33 4547.5,-608.33 4954.5,-608.33 4954.5,-676.33"/>
<text text-anchor="middle" x="4751" y="-661.13" font-family="Times,serif" font-size="14.00">Expert 6 MLP2</text>
<text text-anchor="middle" x="4751" y="-646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="4751" y="-631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="4751" y="-616.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer15_gpu6_expert_act&#45;&gt;layer15_gpu6_expert_mlp2 -->
<g id="edge1623" class="edge">
<title>layer15_gpu6_expert_act&#45;&gt;layer15_gpu6_expert_mlp2</title>
<path fill="none" stroke="black" d="M4753.03,-712.22C4752.79,-704.11 4752.53,-695.32 4752.28,-686.81"/>
<polygon fill="black" stroke="black" points="4755.77,-686.53 4751.98,-676.63 4748.77,-686.73 4755.77,-686.53"/>
</g>
<!-- layer15_gpu6_token_send -->
<g id="node1394" class="node">
<title>layer15_gpu6_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="4746" cy="-524.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="4746" y="-543.05" font-family="Times,serif" font-size="14.00">Token Send GPU6</text>
<text text-anchor="middle" x="4746" y="-528.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="4746" y="-513.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="4746" y="-498.05" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer15_gpu6_expert_mlp2&#45;&gt;layer15_gpu6_token_send -->
<g id="edge1624" class="edge">
<title>layer15_gpu6_expert_mlp2&#45;&gt;layer15_gpu6_token_send</title>
<path fill="none" stroke="black" d="M4749.57,-608.07C4749.22,-600.07 4748.85,-591.31 4748.47,-582.57"/>
<polygon fill="black" stroke="black" points="4751.96,-582.2 4748.03,-572.36 4744.96,-582.5 4751.96,-582.2"/>
</g>
<!-- layer15_gpu6_token_send&#45;&gt;layer15_expert_agg -->
<g id="edge1625" class="edge">
<title>layer15_gpu6_token_send&#45;&gt;layer15_expert_agg</title>
<path fill="none" stroke="black" d="M4991.97,-489.47C5150.21,-467.75 5357.24,-439.32 5527.01,-416.01"/>
<polygon fill="black" stroke="black" points="5527.68,-419.45 5537.11,-414.62 5526.72,-412.51 5527.68,-419.45"/>
</g>
<!-- layer15_gpu7_expert_mlp1 -->
<g id="node1396" class="node">
<title>layer15_gpu7_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="5705.5,-884.33 5244.5,-884.33 5244.5,-816.33 5705.5,-816.33 5705.5,-884.33"/>
<text text-anchor="middle" x="5475" y="-869.13" font-family="Times,serif" font-size="14.00">Expert 7 MLP1</text>
<text text-anchor="middle" x="5475" y="-854.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="5475" y="-839.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-824.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer15_gpu7_token_recv&#45;&gt;layer15_gpu7_expert_mlp1 -->
<g id="edge1627" class="edge">
<title>layer15_gpu7_token_recv&#45;&gt;layer15_gpu7_expert_mlp1</title>
<path fill="none" stroke="black" d="M5476.19,-920.2C5476.04,-911.82 5475.89,-903.12 5475.75,-894.84"/>
<polygon fill="black" stroke="black" points="5479.25,-894.57 5475.57,-884.64 5472.25,-894.7 5479.25,-894.57"/>
</g>
<!-- layer15_gpu7_expert_act -->
<g id="node1397" class="node">
<title>layer15_gpu7_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="5663.5,-780.33 5286.5,-780.33 5286.5,-712.33 5663.5,-712.33 5663.5,-780.33"/>
<text text-anchor="middle" x="5475" y="-765.13" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="5475" y="-750.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-735.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-720.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer15_gpu7_expert_mlp1&#45;&gt;layer15_gpu7_expert_act -->
<g id="edge1628" class="edge">
<title>layer15_gpu7_expert_mlp1&#45;&gt;layer15_gpu7_expert_act</title>
<path fill="none" stroke="black" d="M5475,-816.22C5475,-808.11 5475,-799.32 5475,-790.81"/>
<polygon fill="black" stroke="black" points="5478.5,-790.63 5475,-780.63 5471.5,-790.63 5478.5,-790.63"/>
</g>
<!-- layer15_gpu7_expert_mlp2 -->
<g id="node1398" class="node">
<title>layer15_gpu7_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="5678.5,-676.33 5271.5,-676.33 5271.5,-608.33 5678.5,-608.33 5678.5,-676.33"/>
<text text-anchor="middle" x="5475" y="-661.13" font-family="Times,serif" font-size="14.00">Expert 7 MLP2</text>
<text text-anchor="middle" x="5475" y="-646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="5475" y="-631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5475" y="-616.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer15_gpu7_expert_act&#45;&gt;layer15_gpu7_expert_mlp2 -->
<g id="edge1629" class="edge">
<title>layer15_gpu7_expert_act&#45;&gt;layer15_gpu7_expert_mlp2</title>
<path fill="none" stroke="black" d="M5475,-712.22C5475,-704.11 5475,-695.32 5475,-686.81"/>
<polygon fill="black" stroke="black" points="5478.5,-686.63 5475,-676.63 5471.5,-686.63 5478.5,-686.63"/>
</g>
<!-- layer15_gpu7_token_send -->
<g id="node1399" class="node">
<title>layer15_gpu7_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="5475" cy="-524.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="5475" y="-543.05" font-family="Times,serif" font-size="14.00">Token Send GPU7</text>
<text text-anchor="middle" x="5475" y="-528.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="5475" y="-513.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="5475" y="-498.05" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer15_gpu7_expert_mlp2&#45;&gt;layer15_gpu7_token_send -->
<g id="edge1630" class="edge">
<title>layer15_gpu7_expert_mlp2&#45;&gt;layer15_gpu7_token_send</title>
<path fill="none" stroke="black" d="M5475,-608.07C5475,-600.07 5475,-591.31 5475,-582.57"/>
<polygon fill="black" stroke="black" points="5478.5,-582.36 5475,-572.36 5471.5,-582.36 5478.5,-582.36"/>
</g>
<!-- layer15_gpu7_token_send&#45;&gt;layer15_expert_agg -->
<g id="edge1631" class="edge">
<title>layer15_gpu7_token_send&#45;&gt;layer15_expert_agg</title>
<path fill="none" stroke="black" d="M5583.72,-478.42C5609.88,-467.64 5638.47,-455.85 5666.74,-444.19"/>
<polygon fill="black" stroke="black" points="5668.4,-447.29 5676.31,-440.25 5665.73,-440.82 5668.4,-447.29"/>
</g>
<!-- layer15_gpu8_expert_mlp1 -->
<g id="node1401" class="node">
<title>layer15_gpu8_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="6400.5,-884.33 5939.5,-884.33 5939.5,-816.33 6400.5,-816.33 6400.5,-884.33"/>
<text text-anchor="middle" x="6170" y="-869.13" font-family="Times,serif" font-size="14.00">Expert 8 MLP1</text>
<text text-anchor="middle" x="6170" y="-854.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6170" y="-839.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6170" y="-824.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer15_gpu8_token_recv&#45;&gt;layer15_gpu8_expert_mlp1 -->
<g id="edge1633" class="edge">
<title>layer15_gpu8_token_recv&#45;&gt;layer15_gpu8_expert_mlp1</title>
<path fill="none" stroke="black" d="M6167.03,-920.2C6167.39,-911.82 6167.77,-903.12 6168.13,-894.84"/>
<polygon fill="black" stroke="black" points="6171.63,-894.78 6168.57,-884.64 6164.64,-894.48 6171.63,-894.78"/>
</g>
<!-- layer15_gpu8_expert_act -->
<g id="node1402" class="node">
<title>layer15_gpu8_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="6362.5,-780.33 5985.5,-780.33 5985.5,-712.33 6362.5,-712.33 6362.5,-780.33"/>
<text text-anchor="middle" x="6174" y="-765.13" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="6174" y="-750.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6174" y="-735.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6174" y="-720.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer15_gpu8_expert_mlp1&#45;&gt;layer15_gpu8_expert_act -->
<g id="edge1634" class="edge">
<title>layer15_gpu8_expert_mlp1&#45;&gt;layer15_gpu8_expert_act</title>
<path fill="none" stroke="black" d="M6171.3,-816.22C6171.62,-808.11 6171.96,-799.32 6172.3,-790.81"/>
<polygon fill="black" stroke="black" points="6175.8,-790.76 6172.69,-780.63 6168.8,-790.49 6175.8,-790.76"/>
</g>
<!-- layer15_gpu8_expert_mlp2 -->
<g id="node1403" class="node">
<title>layer15_gpu8_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="6397.5,-676.33 5990.5,-676.33 5990.5,-608.33 6397.5,-608.33 6397.5,-676.33"/>
<text text-anchor="middle" x="6194" y="-661.13" font-family="Times,serif" font-size="14.00">Expert 8 MLP2</text>
<text text-anchor="middle" x="6194" y="-646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6194" y="-631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6194" y="-616.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer15_gpu8_expert_act&#45;&gt;layer15_gpu8_expert_mlp2 -->
<g id="edge1635" class="edge">
<title>layer15_gpu8_expert_act&#45;&gt;layer15_gpu8_expert_mlp2</title>
<path fill="none" stroke="black" d="M6180.49,-712.22C6182.1,-704.02 6183.85,-695.12 6185.53,-686.52"/>
<polygon fill="black" stroke="black" points="6188.98,-687.12 6187.47,-676.63 6182.11,-685.77 6188.98,-687.12"/>
</g>
<!-- layer15_gpu8_token_send -->
<g id="node1404" class="node">
<title>layer15_gpu8_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6204" cy="-524.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6204" y="-543.05" font-family="Times,serif" font-size="14.00">Token Send GPU8</text>
<text text-anchor="middle" x="6204" y="-528.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6204" y="-513.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6204" y="-498.05" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer15_gpu8_expert_mlp2&#45;&gt;layer15_gpu8_token_send -->
<g id="edge1636" class="edge">
<title>layer15_gpu8_expert_mlp2&#45;&gt;layer15_gpu8_token_send</title>
<path fill="none" stroke="black" d="M6196.87,-608.07C6197.55,-600.07 6198.31,-591.31 6199.06,-582.57"/>
<polygon fill="black" stroke="black" points="6202.57,-582.62 6199.94,-572.36 6195.6,-582.02 6202.57,-582.62"/>
</g>
<!-- layer15_gpu8_token_send&#45;&gt;layer15_expert_agg -->
<g id="edge1637" class="edge">
<title>layer15_gpu8_token_send&#45;&gt;layer15_expert_agg</title>
<path fill="none" stroke="black" d="M6094.98,-478.42C6068.75,-467.64 6040.08,-455.85 6011.73,-444.19"/>
<polygon fill="black" stroke="black" points="6012.71,-440.81 6002.14,-440.25 6010.05,-447.29 6012.71,-440.81"/>
</g>
<!-- layer15_gpu9_expert_mlp1 -->
<g id="node1406" class="node">
<title>layer15_gpu9_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7091.5,-884.33 6630.5,-884.33 6630.5,-816.33 7091.5,-816.33 7091.5,-884.33"/>
<text text-anchor="middle" x="6861" y="-869.13" font-family="Times,serif" font-size="14.00">Expert 9 MLP1</text>
<text text-anchor="middle" x="6861" y="-854.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="6861" y="-839.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6861" y="-824.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer15_gpu9_token_recv&#45;&gt;layer15_gpu9_expert_mlp1 -->
<g id="edge1639" class="edge">
<title>layer15_gpu9_token_recv&#45;&gt;layer15_gpu9_expert_mlp1</title>
<path fill="none" stroke="black" d="M6855.66,-920.2C6856.31,-911.82 6856.99,-903.12 6857.63,-894.84"/>
<polygon fill="black" stroke="black" points="6861.13,-894.88 6858.42,-884.64 6854.16,-894.34 6861.13,-894.88"/>
</g>
<!-- layer15_gpu9_expert_act -->
<g id="node1407" class="node">
<title>layer15_gpu9_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7059.5,-780.33 6682.5,-780.33 6682.5,-712.33 7059.5,-712.33 7059.5,-780.33"/>
<text text-anchor="middle" x="6871" y="-765.13" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="6871" y="-750.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6871" y="-735.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6871" y="-720.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer15_gpu9_expert_mlp1&#45;&gt;layer15_gpu9_expert_act -->
<g id="edge1640" class="edge">
<title>layer15_gpu9_expert_mlp1&#45;&gt;layer15_gpu9_expert_act</title>
<path fill="none" stroke="black" d="M6864.25,-816.22C6865.04,-808.11 6865.9,-799.32 6866.74,-790.81"/>
<polygon fill="black" stroke="black" points="6870.24,-790.93 6867.74,-780.63 6863.28,-790.24 6870.24,-790.93"/>
</g>
<!-- layer15_gpu9_expert_mlp2 -->
<g id="node1408" class="node">
<title>layer15_gpu9_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7116.5,-676.33 6709.5,-676.33 6709.5,-608.33 7116.5,-608.33 7116.5,-676.33"/>
<text text-anchor="middle" x="6913" y="-661.13" font-family="Times,serif" font-size="14.00">Expert 9 MLP2</text>
<text text-anchor="middle" x="6913" y="-646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="6913" y="-631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="6913" y="-616.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer15_gpu9_expert_act&#45;&gt;layer15_gpu9_expert_mlp2 -->
<g id="edge1641" class="edge">
<title>layer15_gpu9_expert_act&#45;&gt;layer15_gpu9_expert_mlp2</title>
<path fill="none" stroke="black" d="M6884.64,-712.22C6888.08,-703.84 6891.83,-694.73 6895.45,-685.96"/>
<polygon fill="black" stroke="black" points="6898.72,-687.21 6899.29,-676.63 6892.24,-684.55 6898.72,-687.21"/>
</g>
<!-- layer15_gpu9_token_send -->
<g id="node1409" class="node">
<title>layer15_gpu9_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="6933" cy="-524.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="6933" y="-543.05" font-family="Times,serif" font-size="14.00">Token Send GPU9</text>
<text text-anchor="middle" x="6933" y="-528.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="6933" y="-513.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="6933" y="-498.05" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer15_gpu9_expert_mlp2&#45;&gt;layer15_gpu9_token_send -->
<g id="edge1642" class="edge">
<title>layer15_gpu9_expert_mlp2&#45;&gt;layer15_gpu9_token_send</title>
<path fill="none" stroke="black" d="M6918.73,-608.07C6920.12,-599.99 6921.65,-591.12 6923.17,-582.28"/>
<polygon fill="black" stroke="black" points="6926.63,-582.81 6924.88,-572.36 6919.74,-581.62 6926.63,-582.81"/>
</g>
<!-- layer15_gpu9_token_send&#45;&gt;layer15_expert_agg -->
<g id="edge1643" class="edge">
<title>layer15_gpu9_token_send&#45;&gt;layer15_expert_agg</title>
<path fill="none" stroke="black" d="M6686.8,-489.47C6570.47,-473.52 6427.79,-453.94 6292.9,-435.44"/>
<polygon fill="black" stroke="black" points="6293.17,-431.94 6282.79,-434.05 6292.22,-438.88 6293.17,-431.94"/>
</g>
<!-- layer15_gpu10_expert_mlp1 -->
<g id="node1411" class="node">
<title>layer15_gpu10_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="7785.5,-884.33 7324.5,-884.33 7324.5,-816.33 7785.5,-816.33 7785.5,-884.33"/>
<text text-anchor="middle" x="7555" y="-869.13" font-family="Times,serif" font-size="14.00">Expert 10 MLP1</text>
<text text-anchor="middle" x="7555" y="-854.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="7555" y="-839.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7555" y="-824.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer15_gpu10_token_recv&#45;&gt;layer15_gpu10_expert_mlp1 -->
<g id="edge1645" class="edge">
<title>layer15_gpu10_token_recv&#45;&gt;layer15_gpu10_expert_mlp1</title>
<path fill="none" stroke="black" d="M7545.51,-920.2C7546.68,-911.72 7547.89,-902.92 7549.04,-894.56"/>
<polygon fill="black" stroke="black" points="7552.51,-895.02 7550.41,-884.64 7545.58,-894.07 7552.51,-895.02"/>
</g>
<!-- layer15_gpu10_expert_act -->
<g id="node1412" class="node">
<title>layer15_gpu10_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="7774.5,-780.33 7397.5,-780.33 7397.5,-712.33 7774.5,-712.33 7774.5,-780.33"/>
<text text-anchor="middle" x="7586" y="-765.13" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="7586" y="-750.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7586" y="-735.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7586" y="-720.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer15_gpu10_expert_mlp1&#45;&gt;layer15_gpu10_expert_act -->
<g id="edge1646" class="edge">
<title>layer15_gpu10_expert_mlp1&#45;&gt;layer15_gpu10_expert_act</title>
<path fill="none" stroke="black" d="M7565.06,-816.22C7567.58,-807.93 7570.32,-798.93 7572.96,-790.24"/>
<polygon fill="black" stroke="black" points="7576.32,-791.22 7575.88,-780.63 7569.62,-789.18 7576.32,-791.22"/>
</g>
<!-- layer15_gpu10_expert_mlp2 -->
<g id="node1413" class="node">
<title>layer15_gpu10_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="7803.5,-676.33 7396.5,-676.33 7396.5,-608.33 7803.5,-608.33 7803.5,-676.33"/>
<text text-anchor="middle" x="7600" y="-661.13" font-family="Times,serif" font-size="14.00">Expert 10 MLP2</text>
<text text-anchor="middle" x="7600" y="-646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="7600" y="-631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="7600" y="-616.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer15_gpu10_expert_act&#45;&gt;layer15_gpu10_expert_mlp2 -->
<g id="edge1647" class="edge">
<title>layer15_gpu10_expert_act&#45;&gt;layer15_gpu10_expert_mlp2</title>
<path fill="none" stroke="black" d="M7590.55,-712.22C7591.66,-704.11 7592.87,-695.32 7594.03,-686.81"/>
<polygon fill="black" stroke="black" points="7597.54,-687.02 7595.43,-676.63 7590.6,-686.06 7597.54,-687.02"/>
</g>
<!-- layer15_gpu10_token_send -->
<g id="node1414" class="node">
<title>layer15_gpu10_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="7662" cy="-524.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="7662" y="-543.05" font-family="Times,serif" font-size="14.00">Token Send GPU10</text>
<text text-anchor="middle" x="7662" y="-528.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="7662" y="-513.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="7662" y="-498.05" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer15_gpu10_expert_mlp2&#45;&gt;layer15_gpu10_token_send -->
<g id="edge1648" class="edge">
<title>layer15_gpu10_expert_mlp2&#45;&gt;layer15_gpu10_token_send</title>
<path fill="none" stroke="black" d="M7617.77,-608.07C7622.22,-599.73 7627.13,-590.55 7632,-581.43"/>
<polygon fill="black" stroke="black" points="7635.21,-582.83 7636.84,-572.36 7629.04,-579.53 7635.21,-582.83"/>
</g>
<!-- layer15_gpu10_token_send&#45;&gt;layer15_expert_agg -->
<g id="edge1649" class="edge">
<title>layer15_gpu10_token_send&#45;&gt;layer15_expert_agg</title>
<path fill="none" stroke="black" d="M7416,-489.46C7376.58,-484.61 7336.2,-479.98 7298,-476.17 6940.76,-440.48 6533.09,-412.8 6239.66,-395.16"/>
<polygon fill="black" stroke="black" points="6239.46,-391.64 6229.27,-394.54 6239.04,-398.63 6239.46,-391.64"/>
</g>
<!-- layer15_gpu11_expert_mlp1 -->
<g id="node1416" class="node">
<title>layer15_gpu11_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="8477.5,-884.33 8016.5,-884.33 8016.5,-816.33 8477.5,-816.33 8477.5,-884.33"/>
<text text-anchor="middle" x="8247" y="-869.13" font-family="Times,serif" font-size="14.00">Expert 11 MLP1</text>
<text text-anchor="middle" x="8247" y="-854.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8247" y="-839.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8247" y="-824.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer15_gpu11_token_recv&#45;&gt;layer15_gpu11_expert_mlp1 -->
<g id="edge1651" class="edge">
<title>layer15_gpu11_token_recv&#45;&gt;layer15_gpu11_expert_mlp1</title>
<path fill="none" stroke="black" d="M8234.54,-920.2C8236.08,-911.72 8237.67,-902.92 8239.18,-894.56"/>
<polygon fill="black" stroke="black" points="8242.64,-895.1 8240.98,-884.64 8235.75,-893.85 8242.64,-895.1"/>
</g>
<!-- layer15_gpu11_expert_act -->
<g id="node1417" class="node">
<title>layer15_gpu11_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="8454.5,-780.33 8077.5,-780.33 8077.5,-712.33 8454.5,-712.33 8454.5,-780.33"/>
<text text-anchor="middle" x="8266" y="-765.13" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="8266" y="-750.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8266" y="-735.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8266" y="-720.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer15_gpu11_expert_mlp1&#45;&gt;layer15_gpu11_expert_act -->
<g id="edge1652" class="edge">
<title>layer15_gpu11_expert_mlp1&#45;&gt;layer15_gpu11_expert_act</title>
<path fill="none" stroke="black" d="M8253.17,-816.22C8254.7,-808.02 8256.35,-799.12 8257.95,-790.52"/>
<polygon fill="black" stroke="black" points="8261.41,-791.1 8259.8,-780.63 8254.53,-789.82 8261.41,-791.1"/>
</g>
<!-- layer15_gpu11_expert_mlp2 -->
<g id="node1418" class="node">
<title>layer15_gpu11_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="8552.5,-676.33 8145.5,-676.33 8145.5,-608.33 8552.5,-608.33 8552.5,-676.33"/>
<text text-anchor="middle" x="8349" y="-661.13" font-family="Times,serif" font-size="14.00">Expert 11 MLP2</text>
<text text-anchor="middle" x="8349" y="-646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8349" y="-631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="8349" y="-616.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer15_gpu11_expert_act&#45;&gt;layer15_gpu11_expert_mlp2 -->
<g id="edge1653" class="edge">
<title>layer15_gpu11_expert_act&#45;&gt;layer15_gpu11_expert_mlp2</title>
<path fill="none" stroke="black" d="M8292.95,-712.22C8300.12,-703.4 8307.96,-693.76 8315.45,-684.57"/>
<polygon fill="black" stroke="black" points="8318.31,-686.6 8321.9,-676.63 8312.88,-682.18 8318.31,-686.6"/>
</g>
<!-- layer15_gpu11_token_send -->
<g id="node1419" class="node">
<title>layer15_gpu11_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="8391" cy="-524.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="8391" y="-543.05" font-family="Times,serif" font-size="14.00">Token Send GPU11</text>
<text text-anchor="middle" x="8391" y="-528.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="8391" y="-513.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="8391" y="-498.05" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer15_gpu11_expert_mlp2&#45;&gt;layer15_gpu11_token_send -->
<g id="edge1654" class="edge">
<title>layer15_gpu11_expert_mlp2&#45;&gt;layer15_gpu11_token_send</title>
<path fill="none" stroke="black" d="M8361.04,-608.07C8363.99,-599.9 8367.24,-590.93 8370.47,-582"/>
<polygon fill="black" stroke="black" points="8373.84,-582.95 8373.96,-572.36 8367.26,-580.57 8373.84,-582.95"/>
</g>
<!-- layer15_gpu11_token_send&#45;&gt;layer15_expert_agg -->
<g id="edge1655" class="edge">
<title>layer15_gpu11_token_send&#45;&gt;layer15_expert_agg</title>
<path fill="none" stroke="black" d="M8148.02,-489.03C8107.66,-484.14 8066.2,-479.62 8027,-476.17 7395.56,-420.56 6658.78,-393.7 6221.55,-381.72"/>
<polygon fill="black" stroke="black" points="6221.37,-378.22 6211.28,-381.44 6221.18,-385.22 6221.37,-378.22"/>
</g>
<!-- layer15_gpu12_expert_mlp1 -->
<g id="node1421" class="node">
<title>layer15_gpu12_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9169.5,-884.33 8708.5,-884.33 8708.5,-816.33 9169.5,-816.33 9169.5,-884.33"/>
<text text-anchor="middle" x="8939" y="-869.13" font-family="Times,serif" font-size="14.00">Expert 12 MLP1</text>
<text text-anchor="middle" x="8939" y="-854.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="8939" y="-839.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8939" y="-824.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer15_gpu12_token_recv&#45;&gt;layer15_gpu12_expert_mlp1 -->
<g id="edge1657" class="edge">
<title>layer15_gpu12_token_recv&#45;&gt;layer15_gpu12_expert_mlp1</title>
<path fill="none" stroke="black" d="M8923.58,-920.2C8925.47,-911.72 8927.44,-902.92 8929.32,-894.56"/>
<polygon fill="black" stroke="black" points="8932.77,-895.16 8931.54,-884.64 8925.94,-893.63 8932.77,-895.16"/>
</g>
<!-- layer15_gpu12_expert_act -->
<g id="node1422" class="node">
<title>layer15_gpu12_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9152.5,-780.33 8775.5,-780.33 8775.5,-712.33 9152.5,-712.33 9152.5,-780.33"/>
<text text-anchor="middle" x="8964" y="-765.13" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="8964" y="-750.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8964" y="-735.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="8964" y="-720.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer15_gpu12_expert_mlp1&#45;&gt;layer15_gpu12_expert_act -->
<g id="edge1658" class="edge">
<title>layer15_gpu12_expert_mlp1&#45;&gt;layer15_gpu12_expert_act</title>
<path fill="none" stroke="black" d="M8947.12,-816.22C8949.13,-808.02 8951.31,-799.12 8953.41,-790.52"/>
<polygon fill="black" stroke="black" points="8956.86,-791.18 8955.84,-780.63 8950.06,-789.51 8956.86,-791.18"/>
</g>
<!-- layer15_gpu12_expert_mlp2 -->
<g id="node1423" class="node">
<title>layer15_gpu12_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="9271.5,-676.33 8864.5,-676.33 8864.5,-608.33 9271.5,-608.33 9271.5,-676.33"/>
<text text-anchor="middle" x="9068" y="-661.13" font-family="Times,serif" font-size="14.00">Expert 12 MLP2</text>
<text text-anchor="middle" x="9068" y="-646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9068" y="-631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9068" y="-616.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer15_gpu12_expert_act&#45;&gt;layer15_gpu12_expert_mlp2 -->
<g id="edge1659" class="edge">
<title>layer15_gpu12_expert_act&#45;&gt;layer15_gpu12_expert_mlp2</title>
<path fill="none" stroke="black" d="M8997.77,-712.22C9007.03,-703.13 9017.18,-693.18 9026.81,-683.73"/>
<polygon fill="black" stroke="black" points="9029.36,-686.13 9034.05,-676.63 9024.46,-681.14 9029.36,-686.13"/>
</g>
<!-- layer15_gpu12_token_send -->
<g id="node1424" class="node">
<title>layer15_gpu12_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9120" cy="-524.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9120" y="-543.05" font-family="Times,serif" font-size="14.00">Token Send GPU12</text>
<text text-anchor="middle" x="9120" y="-528.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9120" y="-513.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9120" y="-498.05" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer15_gpu12_expert_mlp2&#45;&gt;layer15_gpu12_token_send -->
<g id="edge1660" class="edge">
<title>layer15_gpu12_expert_mlp2&#45;&gt;layer15_gpu12_token_send</title>
<path fill="none" stroke="black" d="M9082.9,-608.07C9086.6,-599.81 9090.66,-590.74 9094.71,-581.71"/>
<polygon fill="black" stroke="black" points="9098,-582.92 9098.9,-572.36 9091.61,-580.05 9098,-582.92"/>
</g>
<!-- layer15_gpu12_token_send&#45;&gt;layer15_expert_agg -->
<g id="edge1661" class="edge">
<title>layer15_gpu12_token_send&#45;&gt;layer15_expert_agg</title>
<path fill="none" stroke="black" d="M8879.02,-488.86C8838.04,-483.94 8795.85,-479.44 8756,-476.17 7844.48,-401.29 6768.33,-380.79 6212.77,-375.22"/>
<polygon fill="black" stroke="black" points="6212.62,-371.72 6202.59,-375.12 6212.55,-378.72 6212.62,-371.72"/>
</g>
<!-- layer15_gpu13_expert_mlp1 -->
<g id="node1426" class="node">
<title>layer15_gpu13_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="9955.5,-884.33 9494.5,-884.33 9494.5,-816.33 9955.5,-816.33 9955.5,-884.33"/>
<text text-anchor="middle" x="9725" y="-869.13" font-family="Times,serif" font-size="14.00">Expert 13 MLP1</text>
<text text-anchor="middle" x="9725" y="-854.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="9725" y="-839.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9725" y="-824.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer15_gpu13_token_recv&#45;&gt;layer15_gpu13_expert_mlp1 -->
<g id="edge1663" class="edge">
<title>layer15_gpu13_token_recv&#45;&gt;layer15_gpu13_expert_mlp1</title>
<path fill="none" stroke="black" d="M9650.12,-920.87C9660.51,-911.22 9671.38,-901.13 9681.51,-891.72"/>
<polygon fill="black" stroke="black" points="9684.15,-894.05 9689.1,-884.68 9679.39,-888.92 9684.15,-894.05"/>
</g>
<!-- layer15_gpu13_expert_act -->
<g id="node1427" class="node">
<title>layer15_gpu13_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="9944.5,-780.33 9567.5,-780.33 9567.5,-712.33 9944.5,-712.33 9944.5,-780.33"/>
<text text-anchor="middle" x="9756" y="-765.13" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="9756" y="-750.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9756" y="-735.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9756" y="-720.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer15_gpu13_expert_mlp1&#45;&gt;layer15_gpu13_expert_act -->
<g id="edge1664" class="edge">
<title>layer15_gpu13_expert_mlp1&#45;&gt;layer15_gpu13_expert_act</title>
<path fill="none" stroke="black" d="M9735.06,-816.22C9737.58,-807.93 9740.32,-798.93 9742.96,-790.24"/>
<polygon fill="black" stroke="black" points="9746.32,-791.22 9745.88,-780.63 9739.62,-789.18 9746.32,-791.22"/>
</g>
<!-- layer15_gpu13_expert_mlp2 -->
<g id="node1428" class="node">
<title>layer15_gpu13_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10022.5,-676.33 9615.5,-676.33 9615.5,-608.33 10022.5,-608.33 10022.5,-676.33"/>
<text text-anchor="middle" x="9819" y="-661.13" font-family="Times,serif" font-size="14.00">Expert 13 MLP2</text>
<text text-anchor="middle" x="9819" y="-646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="9819" y="-631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="9819" y="-616.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer15_gpu13_expert_act&#45;&gt;layer15_gpu13_expert_mlp2 -->
<g id="edge1665" class="edge">
<title>layer15_gpu13_expert_act&#45;&gt;layer15_gpu13_expert_mlp2</title>
<path fill="none" stroke="black" d="M9776.45,-712.22C9781.74,-703.67 9787.49,-694.35 9793.01,-685.41"/>
<polygon fill="black" stroke="black" points="9796.16,-686.98 9798.43,-676.63 9790.2,-683.3 9796.16,-686.98"/>
</g>
<!-- layer15_gpu13_token_send -->
<g id="node1429" class="node">
<title>layer15_gpu13_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="9849" cy="-524.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="9849" y="-543.05" font-family="Times,serif" font-size="14.00">Token Send GPU13</text>
<text text-anchor="middle" x="9849" y="-528.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="9849" y="-513.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="9849" y="-498.05" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer15_gpu13_expert_mlp2&#45;&gt;layer15_gpu13_token_send -->
<g id="edge1666" class="edge">
<title>layer15_gpu13_expert_mlp2&#45;&gt;layer15_gpu13_token_send</title>
<path fill="none" stroke="black" d="M9827.6,-608.07C9829.69,-599.99 9831.98,-591.12 9834.26,-582.28"/>
<polygon fill="black" stroke="black" points="9837.71,-582.92 9836.83,-572.36 9830.93,-581.17 9837.71,-582.92"/>
</g>
<!-- layer15_gpu13_token_send&#45;&gt;layer15_expert_agg -->
<g id="edge1667" class="edge">
<title>layer15_gpu13_token_send&#45;&gt;layer15_expert_agg</title>
<path fill="none" stroke="black" d="M9609.01,-488.74C9567.72,-483.8 9525.18,-479.32 9485,-476.17 8859.65,-427.01 7018.54,-392.25 6217.97,-379.04"/>
<polygon fill="black" stroke="black" points="6217.78,-375.54 6207.72,-378.87 6217.66,-382.54 6217.78,-375.54"/>
</g>
<!-- layer15_gpu14_expert_mlp1 -->
<g id="node1431" class="node">
<title>layer15_gpu14_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="10625.5,-884.33 10164.5,-884.33 10164.5,-816.33 10625.5,-816.33 10625.5,-884.33"/>
<text text-anchor="middle" x="10395" y="-869.13" font-family="Times,serif" font-size="14.00">Expert 14 MLP1</text>
<text text-anchor="middle" x="10395" y="-854.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10395" y="-839.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10395" y="-824.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer15_gpu14_token_recv&#45;&gt;layer15_gpu14_expert_mlp1 -->
<g id="edge1669" class="edge">
<title>layer15_gpu14_token_recv&#45;&gt;layer15_gpu14_expert_mlp1</title>
<path fill="none" stroke="black" d="M10330.62,-920.54C10339.4,-911.1 10348.56,-901.25 10357.13,-892.04"/>
<polygon fill="black" stroke="black" points="10359.91,-894.19 10364.16,-884.48 10354.79,-889.42 10359.91,-894.19"/>
</g>
<!-- layer15_gpu14_expert_act -->
<g id="node1432" class="node">
<title>layer15_gpu14_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="10764.5,-780.33 10387.5,-780.33 10387.5,-712.33 10764.5,-712.33 10764.5,-780.33"/>
<text text-anchor="middle" x="10576" y="-765.13" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="10576" y="-750.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10576" y="-735.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10576" y="-720.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer15_gpu14_expert_mlp1&#45;&gt;layer15_gpu14_expert_act -->
<g id="edge1670" class="edge">
<title>layer15_gpu14_expert_mlp1&#45;&gt;layer15_gpu14_expert_act</title>
<path fill="none" stroke="black" d="M10453.77,-816.22C10471.08,-806.46 10490.17,-795.7 10508.02,-785.64"/>
<polygon fill="black" stroke="black" points="10510.23,-788.42 10517.22,-780.46 10506.79,-782.32 10510.23,-788.42"/>
</g>
<!-- layer15_gpu14_expert_mlp2 -->
<g id="node1433" class="node">
<title>layer15_gpu14_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="10779.5,-676.33 10372.5,-676.33 10372.5,-608.33 10779.5,-608.33 10779.5,-676.33"/>
<text text-anchor="middle" x="10576" y="-661.13" font-family="Times,serif" font-size="14.00">Expert 14 MLP2</text>
<text text-anchor="middle" x="10576" y="-646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10576" y="-631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="10576" y="-616.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer15_gpu14_expert_act&#45;&gt;layer15_gpu14_expert_mlp2 -->
<g id="edge1671" class="edge">
<title>layer15_gpu14_expert_act&#45;&gt;layer15_gpu14_expert_mlp2</title>
<path fill="none" stroke="black" d="M10576,-712.22C10576,-704.11 10576,-695.32 10576,-686.81"/>
<polygon fill="black" stroke="black" points="10579.5,-686.63 10576,-676.63 10572.5,-686.63 10579.5,-686.63"/>
</g>
<!-- layer15_gpu14_token_send -->
<g id="node1434" class="node">
<title>layer15_gpu14_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="10578" cy="-524.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="10578" y="-543.05" font-family="Times,serif" font-size="14.00">Token Send GPU14</text>
<text text-anchor="middle" x="10578" y="-528.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="10578" y="-513.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="10578" y="-498.05" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer15_gpu14_expert_mlp2&#45;&gt;layer15_gpu14_token_send -->
<g id="edge1672" class="edge">
<title>layer15_gpu14_expert_mlp2&#45;&gt;layer15_gpu14_token_send</title>
<path fill="none" stroke="black" d="M10576.57,-608.07C10576.71,-600.07 10576.86,-591.31 10577.01,-582.57"/>
<polygon fill="black" stroke="black" points="10580.52,-582.42 10577.19,-572.36 10573.52,-582.3 10580.52,-582.42"/>
</g>
<!-- layer15_gpu14_token_send&#45;&gt;layer15_expert_agg -->
<g id="edge1673" class="edge">
<title>layer15_gpu14_token_send&#45;&gt;layer15_expert_agg</title>
<path fill="none" stroke="black" d="M10338.52,-488.64C10297.07,-483.69 10254.35,-479.24 10214,-476.17 9442.35,-417.34 7128.28,-386.91 6215.31,-376.94"/>
<polygon fill="black" stroke="black" points="6215.34,-373.44 6205.3,-376.83 6215.26,-380.44 6215.34,-373.44"/>
</g>
<!-- layer15_gpu15_expert_mlp1 -->
<g id="node1436" class="node">
<title>layer15_gpu15_expert_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="11208.5,-884.33 10747.5,-884.33 10747.5,-816.33 11208.5,-816.33 11208.5,-884.33"/>
<text text-anchor="middle" x="10978" y="-869.13" font-family="Times,serif" font-size="14.00">Expert 15 MLP1</text>
<text text-anchor="middle" x="10978" y="-854.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (filtered)</text>
<text text-anchor="middle" x="10978" y="-839.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10978" y="-824.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_gpu15_token_recv&#45;&gt;layer15_gpu15_expert_mlp1 -->
<g id="edge1675" class="edge">
<title>layer15_gpu15_token_recv&#45;&gt;layer15_gpu15_expert_mlp1</title>
<path fill="none" stroke="black" d="M10975.63,-920.2C10975.92,-911.82 10976.22,-903.12 10976.5,-894.84"/>
<polygon fill="black" stroke="black" points="10980.01,-894.75 10976.85,-884.64 10973.01,-894.51 10980.01,-894.75"/>
</g>
<!-- layer15_gpu15_expert_act -->
<g id="node1437" class="node">
<title>layer15_gpu15_expert_act</title>
<polygon fill="lightgreen" stroke="black" points="11174.5,-780.33 10797.5,-780.33 10797.5,-712.33 11174.5,-712.33 11174.5,-780.33"/>
<text text-anchor="middle" x="10986" y="-765.13" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="10986" y="-750.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10986" y="-735.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="10986" y="-720.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_gpu15_expert_mlp1&#45;&gt;layer15_gpu15_expert_act -->
<g id="edge1676" class="edge">
<title>layer15_gpu15_expert_mlp1&#45;&gt;layer15_gpu15_expert_act</title>
<path fill="none" stroke="black" d="M10980.6,-816.22C10981.23,-808.11 10981.92,-799.32 10982.59,-790.81"/>
<polygon fill="black" stroke="black" points="10986.1,-790.88 10983.39,-780.63 10979.12,-790.33 10986.1,-790.88"/>
</g>
<!-- layer15_gpu15_expert_mlp2 -->
<g id="node1438" class="node">
<title>layer15_gpu15_expert_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="11364.5,-676.33 10957.5,-676.33 10957.5,-608.33 11364.5,-608.33 11364.5,-676.33"/>
<text text-anchor="middle" x="11161" y="-661.13" font-family="Times,serif" font-size="14.00">Expert 15 MLP2</text>
<text text-anchor="middle" x="11161" y="-646.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, ffn=2048]</text>
<text text-anchor="middle" x="11161" y="-631.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="11161" y="-616.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_gpu15_expert_act&#45;&gt;layer15_gpu15_expert_mlp2 -->
<g id="edge1677" class="edge">
<title>layer15_gpu15_expert_act&#45;&gt;layer15_gpu15_expert_mlp2</title>
<path fill="none" stroke="black" d="M11042.82,-712.22C11059.56,-702.46 11078.02,-691.7 11095.27,-681.64"/>
<polygon fill="black" stroke="black" points="11097.29,-684.52 11104.17,-676.46 11093.77,-678.47 11097.29,-684.52"/>
</g>
<!-- layer15_gpu15_token_send -->
<g id="node1439" class="node">
<title>layer15_gpu15_token_send</title>
<ellipse fill="lightblue" stroke="black" cx="11307" cy="-524.25" rx="355.85" ry="48.17"/>
<text text-anchor="middle" x="11307" y="-543.05" font-family="Times,serif" font-size="14.00">Token Send GPU15</text>
<text text-anchor="middle" x="11307" y="-528.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (processed)</text>
<text text-anchor="middle" x="11307" y="-513.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024] (aggregated)</text>
<text text-anchor="middle" x="11307" y="-498.05" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_gpu15_expert_mlp2&#45;&gt;layer15_gpu15_token_send -->
<g id="edge1678" class="edge">
<title>layer15_gpu15_expert_mlp2&#45;&gt;layer15_gpu15_token_send</title>
<path fill="none" stroke="black" d="M11202.84,-608.07C11214.63,-598.69 11227.76,-588.25 11240.61,-578.03"/>
<polygon fill="black" stroke="black" points="11242.92,-580.67 11248.56,-571.71 11238.56,-575.19 11242.92,-580.67"/>
</g>
<!-- layer15_gpu15_token_send&#45;&gt;layer15_expert_agg -->
<g id="edge1679" class="edge">
<title>layer15_gpu15_token_send&#45;&gt;layer15_expert_agg</title>
<path fill="none" stroke="black" d="M11068.01,-488.58C11026.42,-483.62 10983.51,-479.19 10943,-476.17 10023.81,-407.65 7228.87,-382.48 6213.08,-375.45"/>
<polygon fill="black" stroke="black" points="6213.09,-371.95 6203.06,-375.38 6213.04,-378.95 6213.09,-371.95"/>
</g>
<!-- layer15_residual2 -->
<g id="node1441" class="node">
<title>layer15_residual2</title>
<polygon fill="lightyellow" stroke="black" points="6281.89,-268.17 5577.35,-268.17 5396.11,-132.17 6100.65,-132.17 6281.89,-268.17"/>
<text text-anchor="middle" x="5839" y="-218.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="5839" y="-203.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024] (x2)</text>
<text text-anchor="middle" x="5839" y="-188.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5839" y="-173.97" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer15_expert_agg&#45;&gt;layer15_residual2 -->
<g id="edge1680" class="edge">
<title>layer15_expert_agg&#45;&gt;layer15_residual2</title>
<path fill="none" stroke="black" d="M5839,-303.98C5839,-295.66 5839,-287.11 5839,-278.66"/>
<polygon fill="black" stroke="black" points="5842.5,-278.42 5839,-268.42 5835.5,-278.42 5842.5,-278.42"/>
</g>
<!-- output -->
<g id="node1442" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="5839" cy="-48.08" rx="287.59" ry="48.17"/>
<text text-anchor="middle" x="5839" y="-66.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="5839" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5839" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=128, hidden=1024]</text>
<text text-anchor="middle" x="5839" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer15_residual2&#45;&gt;output -->
<g id="edge1681" class="edge">
<title>layer15_residual2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M5839,-132.03C5839,-123.48 5839,-114.8 5839,-106.43"/>
<polygon fill="black" stroke="black" points="5842.5,-106.4 5839,-96.4 5835.5,-106.4 5842.5,-106.4"/>
</g>
</g>
</svg>
