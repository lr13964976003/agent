<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="3442pt" height="6650pt"
 viewBox="0.00 0.00 826.00 1595.91" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(4.17 4.17) rotate(0) translate(4 1591.91)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1591.91 822,-1591.91 822,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<path fill="lightgray" stroke="black" d="M405,-1248.93C405,-1248.93 655,-1248.93 655,-1248.93 661,-1248.93 667,-1254.93 667,-1260.93 667,-1260.93 667,-1567.91 667,-1567.91 667,-1573.91 661,-1579.91 655,-1579.91 655,-1579.91 405,-1579.91 405,-1579.91 399,-1579.91 393,-1573.91 393,-1567.91 393,-1567.91 393,-1260.93 393,-1260.93 393,-1254.93 399,-1248.93 405,-1248.93"/>
<text text-anchor="middle" x="530" y="-1564.71" font-family="Times,serif" font-size="14.00">Stage 0: GPU 0 &#45; Input Processing</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<path fill="lightgray" stroke="black" d="M20,-767.95C20,-767.95 544,-767.95 544,-767.95 550,-767.95 556,-773.95 556,-779.95 556,-779.95 556,-1122.95 556,-1122.95 556,-1128.95 550,-1134.95 544,-1134.95 544,-1134.95 20,-1134.95 20,-1134.95 14,-1134.95 8,-1128.95 8,-1122.95 8,-1122.95 8,-779.95 8,-779.95 8,-773.95 14,-767.95 20,-767.95"/>
<text text-anchor="middle" x="282" y="-1119.75" font-family="Times,serif" font-size="14.00">Stage 1: GPUs 1&#45;2 &#45; Expert Layer (Tensor Parallel)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu1</title>
<path fill="lightcyan" stroke="black" d="M28,-775.95C28,-775.95 266,-775.95 266,-775.95 272,-775.95 278,-781.95 278,-787.95 278,-787.95 278,-1091.95 278,-1091.95 278,-1097.95 272,-1103.95 266,-1103.95 266,-1103.95 28,-1103.95 28,-1103.95 22,-1103.95 16,-1097.95 16,-1091.95 16,-1091.95 16,-787.95 16,-787.95 16,-781.95 22,-775.95 28,-775.95"/>
<text text-anchor="middle" x="147" y="-1088.75" font-family="Times,serif" font-size="14.00">GPU 1 &#45; Tensor Parallel Part 1</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_gpu2</title>
<path fill="lightcyan" stroke="black" d="M298,-775.95C298,-775.95 536,-775.95 536,-775.95 542,-775.95 548,-781.95 548,-787.95 548,-787.95 548,-1091.95 548,-1091.95 548,-1097.95 542,-1103.95 536,-1103.95 536,-1103.95 298,-1103.95 298,-1103.95 292,-1103.95 286,-1097.95 286,-1091.95 286,-1091.95 286,-787.95 286,-787.95 286,-781.95 292,-775.95 298,-775.95"/>
<text text-anchor="middle" x="417" y="-1088.75" font-family="Times,serif" font-size="14.00">GPU 2 &#45; Tensor Parallel Part 2</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_stage2</title>
<path fill="lightgray" stroke="black" d="M286,-86.98C286,-86.98 798,-86.98 798,-86.98 804,-86.98 810,-92.98 810,-98.98 810,-98.98 810,-429.98 810,-429.98 810,-435.98 804,-441.98 798,-441.98 798,-441.98 286,-441.98 286,-441.98 280,-441.98 274,-435.98 274,-429.98 274,-429.98 274,-98.98 274,-98.98 274,-92.98 280,-86.98 286,-86.98"/>
<text text-anchor="middle" x="542" y="-426.78" font-family="Times,serif" font-size="14.00">Stage 2: GPU 0 &#45; Aggregation and Output</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="530" cy="-1519.92" rx="129.3" ry="28.98"/>
<text text-anchor="middle" x="530" y="-1528.42" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="530" y="-1517.42" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024]</text>
<text text-anchor="middle" x="530" y="-1506.42" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024]</text>
</g>
<!-- tokenize -->
<g id="node2" class="node">
<title>tokenize</title>
<polygon fill="lightgreen" stroke="black" points="649.5,-1453.93 410.5,-1453.93 410.5,-1412.93 649.5,-1412.93 649.5,-1453.93"/>
<text text-anchor="middle" x="530" y="-1441.93" font-family="Arial" font-size="10.00">Tokenize</text>
<text text-anchor="middle" x="530" y="-1430.93" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024]</text>
<text text-anchor="middle" x="530" y="-1419.93" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, vocab_size]</text>
</g>
<!-- input&#45;&gt;tokenize -->
<g id="edge1" class="edge">
<title>input&#45;&gt;tokenize</title>
<path fill="none" stroke="black" d="M530,-1490.79C530,-1482.26 530,-1472.86 530,-1464.22"/>
<polygon fill="black" stroke="black" points="533.5,-1464.17 530,-1454.17 526.5,-1464.17 533.5,-1464.17"/>
</g>
<!-- embed -->
<g id="node3" class="node">
<title>embed</title>
<polygon fill="lightgreen" stroke="black" points="652.5,-1375.93 407.5,-1375.93 407.5,-1334.93 652.5,-1334.93 652.5,-1375.93"/>
<text text-anchor="middle" x="530" y="-1363.93" font-family="Arial" font-size="10.00">Embedding</text>
<text text-anchor="middle" x="530" y="-1352.93" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, vocab_size]</text>
<text text-anchor="middle" x="530" y="-1341.93" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=4096]</text>
</g>
<!-- tokenize&#45;&gt;embed -->
<g id="edge2" class="edge">
<title>tokenize&#45;&gt;embed</title>
<path fill="none" stroke="black" d="M530,-1412.86C530,-1404.7 530,-1395.05 530,-1386.06"/>
<polygon fill="black" stroke="black" points="533.5,-1385.94 530,-1375.94 526.5,-1385.94 533.5,-1385.94"/>
</g>
<!-- pos_enc -->
<g id="node4" class="node">
<title>pos_enc</title>
<polygon fill="lightgreen" stroke="black" points="652.5,-1297.93 407.5,-1297.93 407.5,-1256.93 652.5,-1256.93 652.5,-1297.93"/>
<text text-anchor="middle" x="530" y="-1285.93" font-family="Arial" font-size="10.00">Position Encoding</text>
<text text-anchor="middle" x="530" y="-1274.93" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=4096]</text>
<text text-anchor="middle" x="530" y="-1263.93" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=4096]</text>
</g>
<!-- embed&#45;&gt;pos_enc -->
<g id="edge3" class="edge">
<title>embed&#45;&gt;pos_enc</title>
<path fill="none" stroke="black" d="M530,-1334.86C530,-1326.7 530,-1317.05 530,-1308.06"/>
<polygon fill="black" stroke="black" points="533.5,-1307.94 530,-1297.94 526.5,-1307.94 533.5,-1307.94"/>
</g>
<!-- comm_stage0_to_1 -->
<g id="node5" class="node">
<title>comm_stage0_to_1</title>
<ellipse fill="lightblue" stroke="black" cx="386" cy="-1190.94" rx="173.48" ry="28.98"/>
<text text-anchor="middle" x="386" y="-1199.44" font-family="Arial" font-size="10.00">Send to Stage 1</text>
<text text-anchor="middle" x="386" y="-1188.44" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=4096]</text>
<text text-anchor="middle" x="386" y="-1177.44" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=4096]</text>
</g>
<!-- pos_enc&#45;&gt;comm_stage0_to_1 -->
<g id="edge4" class="edge">
<title>pos_enc&#45;&gt;comm_stage0_to_1</title>
<path fill="none" stroke="black" d="M496.6,-1256.83C480.03,-1247.11 459.59,-1235.12 440.81,-1224.1"/>
<polygon fill="black" stroke="black" points="442.43,-1220.99 432.03,-1218.95 438.89,-1227.03 442.43,-1220.99"/>
</g>
<!-- residual -->
<g id="node17" class="node">
<title>residual</title>
<polygon fill="lightyellow" stroke="black" points="802.45,-410.98 388.13,-410.98 281.55,-328.98 695.87,-328.98 802.45,-410.98"/>
<text text-anchor="middle" x="542" y="-378.48" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="542" y="-367.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=4096] x2</text>
<text text-anchor="middle" x="542" y="-356.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=4096]</text>
</g>
<!-- pos_enc&#45;&gt;residual -->
<g id="edge18" class="edge">
<title>pos_enc&#45;&gt;residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M553.18,-1256.7C568.96,-1240.97 587,-1217.42 587,-1191.94 587,-1191.94 587,-1191.94 587,-496.97 587,-470.76 578.25,-443.17 568.47,-420.51"/>
<polygon fill="black" stroke="black" points="571.54,-418.8 564.24,-411.12 565.16,-421.67 571.54,-418.8"/>
<text text-anchor="middle" x="658" y="-846.75" font-family="Times,serif" font-size="14.00">residual_connection</text>
</g>
<!-- ln_gpu1 -->
<g id="node6" class="node">
<title>ln_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="269.5,-1072.95 24.5,-1072.95 24.5,-1031.95 269.5,-1031.95 269.5,-1072.95"/>
<text text-anchor="middle" x="147" y="-1060.95" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="147" y="-1049.95" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=4096]</text>
<text text-anchor="middle" x="147" y="-1038.95" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=4096]</text>
</g>
<!-- comm_stage0_to_1&#45;&gt;ln_gpu1 -->
<g id="edge5" class="edge">
<title>comm_stage0_to_1&#45;&gt;ln_gpu1</title>
<path fill="none" stroke="black" d="M334.11,-1163.24C317.37,-1154.43 298.8,-1144.45 282,-1134.95 249.67,-1116.66 213.7,-1094.87 187.02,-1078.42"/>
<polygon fill="black" stroke="black" points="188.69,-1075.34 178.34,-1073.06 185.01,-1081.3 188.69,-1075.34"/>
</g>
<!-- ln_gpu2 -->
<g id="node10" class="node">
<title>ln_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="539.5,-1072.95 294.5,-1072.95 294.5,-1031.95 539.5,-1031.95 539.5,-1072.95"/>
<text text-anchor="middle" x="417" y="-1060.95" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="417" y="-1049.95" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=4096]</text>
<text text-anchor="middle" x="417" y="-1038.95" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=4096]</text>
</g>
<!-- comm_stage0_to_1&#45;&gt;ln_gpu2 -->
<g id="edge6" class="edge">
<title>comm_stage0_to_1&#45;&gt;ln_gpu2</title>
<path fill="none" stroke="black" d="M392.42,-1161.66C397.62,-1138.77 404.92,-1106.62 410.22,-1083.32"/>
<polygon fill="black" stroke="black" points="413.69,-1083.83 412.49,-1073.3 406.86,-1082.28 413.69,-1083.83"/>
</g>
<!-- linear1_gpu1 -->
<g id="node7" class="node">
<title>linear1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="265.5,-994.95 28.5,-994.95 28.5,-953.95 265.5,-953.95 265.5,-994.95"/>
<text text-anchor="middle" x="147" y="-982.95" font-family="Arial" font-size="10.00">Linear1 (Col&#45;Parallel)</text>
<text text-anchor="middle" x="147" y="-971.95" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=4096]</text>
<text text-anchor="middle" x="147" y="-960.95" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, ffn=8192/2]</text>
</g>
<!-- ln_gpu1&#45;&gt;linear1_gpu1 -->
<g id="edge7" class="edge">
<title>ln_gpu1&#45;&gt;linear1_gpu1</title>
<path fill="none" stroke="black" d="M147,-1031.88C147,-1023.72 147,-1014.07 147,-1005.08"/>
<polygon fill="black" stroke="black" points="150.5,-1004.95 147,-994.95 143.5,-1004.95 150.5,-1004.95"/>
</g>
<!-- gelu_gpu1 -->
<g id="node8" class="node">
<title>gelu_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="260.5,-916.95 33.5,-916.95 33.5,-875.95 260.5,-875.95 260.5,-916.95"/>
<text text-anchor="middle" x="147" y="-904.95" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="147" y="-893.95" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, ffn=4096]</text>
<text text-anchor="middle" x="147" y="-882.95" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, ffn=4096]</text>
</g>
<!-- linear1_gpu1&#45;&gt;gelu_gpu1 -->
<g id="edge8" class="edge">
<title>linear1_gpu1&#45;&gt;gelu_gpu1</title>
<path fill="none" stroke="black" d="M147,-953.88C147,-945.72 147,-936.07 147,-927.08"/>
<polygon fill="black" stroke="black" points="150.5,-926.95 147,-916.95 143.5,-926.95 150.5,-926.95"/>
</g>
<!-- linear2_gpu1 -->
<g id="node9" class="node">
<title>linear2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="269.5,-824.95 24.5,-824.95 24.5,-783.95 269.5,-783.95 269.5,-824.95"/>
<text text-anchor="middle" x="147" y="-812.95" font-family="Arial" font-size="10.00">Linear2 (Row&#45;Parallel)</text>
<text text-anchor="middle" x="147" y="-801.95" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, ffn=4096]</text>
<text text-anchor="middle" x="147" y="-790.95" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=4096]</text>
</g>
<!-- gelu_gpu1&#45;&gt;linear2_gpu1 -->
<g id="edge9" class="edge">
<title>gelu_gpu1&#45;&gt;linear2_gpu1</title>
<path fill="none" stroke="black" d="M147,-875.92C147,-864.09 147,-848.76 147,-835.42"/>
<polygon fill="black" stroke="black" points="150.5,-835.25 147,-825.25 143.5,-835.25 150.5,-835.25"/>
</g>
<!-- all_reduce -->
<g id="node14" class="node">
<title>all_reduce</title>
<ellipse fill="lightblue" stroke="black" cx="305" cy="-711.96" rx="177.47" ry="28.98"/>
<text text-anchor="middle" x="305" y="-720.46" font-family="Arial" font-size="10.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="305" y="-709.46" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=4096] x2</text>
<text text-anchor="middle" x="305" y="-698.46" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=4096]</text>
</g>
<!-- linear2_gpu1&#45;&gt;all_reduce -->
<g id="edge13" class="edge">
<title>linear2_gpu1&#45;&gt;all_reduce</title>
<path fill="none" stroke="black" d="M181.28,-783.81C201.07,-772.48 226.45,-757.95 249.06,-745"/>
<polygon fill="black" stroke="black" points="250.96,-747.94 257.9,-739.93 247.48,-741.87 250.96,-747.94"/>
</g>
<!-- linear1_gpu2 -->
<g id="node11" class="node">
<title>linear1_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="535.5,-994.95 298.5,-994.95 298.5,-953.95 535.5,-953.95 535.5,-994.95"/>
<text text-anchor="middle" x="417" y="-982.95" font-family="Arial" font-size="10.00">Linear1 (Col&#45;Parallel)</text>
<text text-anchor="middle" x="417" y="-971.95" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=4096]</text>
<text text-anchor="middle" x="417" y="-960.95" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, ffn=8192/2]</text>
</g>
<!-- ln_gpu2&#45;&gt;linear1_gpu2 -->
<g id="edge10" class="edge">
<title>ln_gpu2&#45;&gt;linear1_gpu2</title>
<path fill="none" stroke="black" d="M417,-1031.88C417,-1023.72 417,-1014.07 417,-1005.08"/>
<polygon fill="black" stroke="black" points="420.5,-1004.95 417,-994.95 413.5,-1004.95 420.5,-1004.95"/>
</g>
<!-- gelu_gpu2 -->
<g id="node12" class="node">
<title>gelu_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="530.5,-916.95 303.5,-916.95 303.5,-875.95 530.5,-875.95 530.5,-916.95"/>
<text text-anchor="middle" x="417" y="-904.95" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="417" y="-893.95" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, ffn=4096]</text>
<text text-anchor="middle" x="417" y="-882.95" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, ffn=4096]</text>
</g>
<!-- linear1_gpu2&#45;&gt;gelu_gpu2 -->
<g id="edge11" class="edge">
<title>linear1_gpu2&#45;&gt;gelu_gpu2</title>
<path fill="none" stroke="black" d="M417,-953.88C417,-945.72 417,-936.07 417,-927.08"/>
<polygon fill="black" stroke="black" points="420.5,-926.95 417,-916.95 413.5,-926.95 420.5,-926.95"/>
</g>
<!-- linear2_gpu2 -->
<g id="node13" class="node">
<title>linear2_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="539.5,-824.95 294.5,-824.95 294.5,-783.95 539.5,-783.95 539.5,-824.95"/>
<text text-anchor="middle" x="417" y="-812.95" font-family="Arial" font-size="10.00">Linear2 (Row&#45;Parallel)</text>
<text text-anchor="middle" x="417" y="-801.95" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, ffn=4096]</text>
<text text-anchor="middle" x="417" y="-790.95" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=4096]</text>
</g>
<!-- gelu_gpu2&#45;&gt;linear2_gpu2 -->
<g id="edge12" class="edge">
<title>gelu_gpu2&#45;&gt;linear2_gpu2</title>
<path fill="none" stroke="black" d="M417,-875.92C417,-864.09 417,-848.76 417,-835.42"/>
<polygon fill="black" stroke="black" points="420.5,-835.25 417,-825.25 413.5,-835.25 420.5,-835.25"/>
</g>
<!-- linear2_gpu2&#45;&gt;all_reduce -->
<g id="edge14" class="edge">
<title>linear2_gpu2&#45;&gt;all_reduce</title>
<path fill="none" stroke="black" d="M392.7,-783.81C379.33,-773.01 362.37,-759.31 346.93,-746.84"/>
<polygon fill="black" stroke="black" points="349,-744.01 339.03,-740.45 344.61,-749.46 349,-744.01"/>
</g>
<!-- agg -->
<g id="node15" class="node">
<title>agg</title>
<polygon fill="lightyellow" stroke="black" points="559.01,-645.97 154.94,-645.97 50.99,-563.97 455.06,-563.97 559.01,-645.97"/>
<text text-anchor="middle" x="305" y="-613.47" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="305" y="-602.47" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=4096]</text>
<text text-anchor="middle" x="305" y="-591.47" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=4096]</text>
</g>
<!-- all_reduce&#45;&gt;agg -->
<g id="edge15" class="edge">
<title>all_reduce&#45;&gt;agg</title>
<path fill="none" stroke="black" d="M305,-682.82C305,-674.61 305,-665.38 305,-656.24"/>
<polygon fill="black" stroke="black" points="308.5,-656.02 305,-646.02 301.5,-656.02 308.5,-656.02"/>
</g>
<!-- comm_stage1_to_2 -->
<g id="node16" class="node">
<title>comm_stage1_to_2</title>
<ellipse fill="lightblue" stroke="black" cx="366" cy="-497.97" rx="173.48" ry="28.98"/>
<text text-anchor="middle" x="366" y="-506.47" font-family="Arial" font-size="10.00">Send to Stage 2</text>
<text text-anchor="middle" x="366" y="-495.47" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=4096]</text>
<text text-anchor="middle" x="366" y="-484.47" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=4096]</text>
</g>
<!-- agg&#45;&gt;comm_stage1_to_2 -->
<g id="edge16" class="edge">
<title>agg&#45;&gt;comm_stage1_to_2</title>
<path fill="none" stroke="black" d="M328.41,-563.67C333.75,-554.48 339.4,-544.76 344.65,-535.72"/>
<polygon fill="black" stroke="black" points="347.75,-537.36 349.74,-526.95 341.69,-533.84 347.75,-537.36"/>
</g>
<!-- comm_stage1_to_2&#45;&gt;residual -->
<g id="edge17" class="edge">
<title>comm_stage1_to_2&#45;&gt;residual</title>
<path fill="none" stroke="black" d="M404.19,-469.64C425.63,-454.29 452.94,-434.74 477.59,-417.09"/>
<polygon fill="black" stroke="black" points="479.74,-419.86 485.84,-411.19 475.67,-414.16 479.74,-419.86"/>
</g>
<!-- final_ln -->
<g id="node18" class="node">
<title>final_ln</title>
<polygon fill="lightgreen" stroke="black" points="664.5,-291.98 419.5,-291.98 419.5,-250.98 664.5,-250.98 664.5,-291.98"/>
<text text-anchor="middle" x="542" y="-279.98" font-family="Arial" font-size="10.00">Final LayerNorm</text>
<text text-anchor="middle" x="542" y="-268.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=4096]</text>
<text text-anchor="middle" x="542" y="-257.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=4096]</text>
</g>
<!-- residual&#45;&gt;final_ln -->
<g id="edge19" class="edge">
<title>residual&#45;&gt;final_ln</title>
<path fill="none" stroke="black" d="M542,-328.9C542,-319.94 542,-310.6 542,-302.15"/>
<polygon fill="black" stroke="black" points="545.5,-302.03 542,-292.03 538.5,-302.03 545.5,-302.03"/>
</g>
<!-- output_proj -->
<g id="node19" class="node">
<title>output_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.5,-213.98 422.5,-213.98 422.5,-172.98 661.5,-172.98 661.5,-213.98"/>
<text text-anchor="middle" x="542" y="-201.98" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="542" y="-190.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=4096]</text>
<text text-anchor="middle" x="542" y="-179.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, vocab_size]</text>
</g>
<!-- final_ln&#45;&gt;output_proj -->
<g id="edge20" class="edge">
<title>final_ln&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M542,-250.91C542,-242.76 542,-233.11 542,-224.11"/>
<polygon fill="black" stroke="black" points="545.5,-223.99 542,-213.99 538.5,-223.99 545.5,-223.99"/>
</g>
<!-- softmax -->
<g id="node20" class="node">
<title>softmax</title>
<polygon fill="lightgreen" stroke="black" points="661.5,-135.98 422.5,-135.98 422.5,-94.98 661.5,-94.98 661.5,-135.98"/>
<text text-anchor="middle" x="542" y="-123.98" font-family="Arial" font-size="10.00">Softmax</text>
<text text-anchor="middle" x="542" y="-112.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, vocab_size]</text>
<text text-anchor="middle" x="542" y="-101.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, vocab_size]</text>
</g>
<!-- output_proj&#45;&gt;softmax -->
<g id="edge21" class="edge">
<title>output_proj&#45;&gt;softmax</title>
<path fill="none" stroke="black" d="M542,-172.91C542,-164.76 542,-155.11 542,-146.11"/>
<polygon fill="black" stroke="black" points="545.5,-145.99 542,-135.99 538.5,-145.99 545.5,-145.99"/>
</g>
<!-- output -->
<g id="node21" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="542" cy="-28.99" rx="169" ry="28.98"/>
<text text-anchor="middle" x="542" y="-37.49" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="542" y="-26.49" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, vocab_size]</text>
<text text-anchor="middle" x="542" y="-15.49" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, vocab_size]</text>
</g>
<!-- softmax&#45;&gt;output -->
<g id="edge22" class="edge">
<title>softmax&#45;&gt;output</title>
<path fill="none" stroke="black" d="M542,-94.89C542,-86.95 542,-77.51 542,-68.31"/>
<polygon fill="black" stroke="black" points="545.5,-68.13 542,-58.13 538.5,-68.13 545.5,-68.13"/>
</g>
</g>
</svg>
