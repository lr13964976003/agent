// Complete MoE EP16+TP4+PP2 Parallel Strategy - Fixed
digraph {
	rankdir=TB size="200,400"
	node [fontsize=8]
	input [label="Model Input\nGPU: Host\n[batch=128, seq=10240, hidden=1024]" fillcolor=white fontsize=10 shape=box]
	layer0_qkv_tp0 [label="Layer0 QKV TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer0_attn_out_tp0 [label="Layer0 AttnOut TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer0_mlp1_tp0 [label="Layer0 MLP1 TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=512]" fillcolor=lightblue fontsize=8 shape=box]
	layer0_mlp2_tp0 [label="Layer0 MLP2 TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer0_qkv_tp1 [label="Layer0 QKV TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer0_attn_out_tp1 [label="Layer0 AttnOut TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer0_mlp1_tp1 [label="Layer0 MLP1 TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=512]" fillcolor=lightgreen fontsize=8 shape=box]
	layer0_mlp2_tp1 [label="Layer0 MLP2 TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer0_qkv_tp2 [label="Layer0 QKV TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer0_attn_out_tp2 [label="Layer0 AttnOut TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer0_mlp1_tp2 [label="Layer0 MLP1 TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=512]" fillcolor=lightyellow fontsize=8 shape=box]
	layer0_mlp2_tp2 [label="Layer0 MLP2 TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer0_qkv_tp3 [label="Layer0 QKV TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer0_attn_out_tp3 [label="Layer0 AttnOut TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer0_mlp1_tp3 [label="Layer0 MLP1 TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=512]" fillcolor=lightpink fontsize=8 shape=box]
	layer0_mlp2_tp3 [label="Layer0 MLP2 TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer0_qkv_comm [label="Layer0 QKV AllGather\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer0_attn_out_comm [label="Layer0 AttnOut AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer0_mlp_comm [label="Layer0 MLP AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer0_gate [label="Layer0 MoE Gate\nGPU:EP0-15\n[batch=128, seq=10240, experts=64]" fillcolor=lightgreen fontsize=8 shape=box]
	layer0_dispatch [label="Layer0 Expert Dispatch\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer0_expert0 [label="Layer0 Expert0\nGPU:0\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert1 [label="Layer0 Expert1\nGPU:1\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert2 [label="Layer0 Expert2\nGPU:2\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert3 [label="Layer0 Expert3\nGPU:3\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert4 [label="Layer0 Expert4\nGPU:4\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert5 [label="Layer0 Expert5\nGPU:5\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert6 [label="Layer0 Expert6\nGPU:6\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert7 [label="Layer0 Expert7\nGPU:7\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert8 [label="Layer0 Expert8\nGPU:8\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert9 [label="Layer0 Expert9\nGPU:9\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert10 [label="Layer0 Expert10\nGPU:10\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert11 [label="Layer0 Expert11\nGPU:11\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert12 [label="Layer0 Expert12\nGPU:12\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert13 [label="Layer0 Expert13\nGPU:13\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert14 [label="Layer0 Expert14\nGPU:14\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert15 [label="Layer0 Expert15\nGPU:15\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert16 [label="Layer0 Expert16\nGPU:16\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert17 [label="Layer0 Expert17\nGPU:17\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert18 [label="Layer0 Expert18\nGPU:18\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert19 [label="Layer0 Expert19\nGPU:19\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert20 [label="Layer0 Expert20\nGPU:20\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert21 [label="Layer0 Expert21\nGPU:21\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert22 [label="Layer0 Expert22\nGPU:22\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert23 [label="Layer0 Expert23\nGPU:23\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert24 [label="Layer0 Expert24\nGPU:24\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert25 [label="Layer0 Expert25\nGPU:25\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert26 [label="Layer0 Expert26\nGPU:26\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert27 [label="Layer0 Expert27\nGPU:27\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert28 [label="Layer0 Expert28\nGPU:28\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert29 [label="Layer0 Expert29\nGPU:29\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert30 [label="Layer0 Expert30\nGPU:30\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert31 [label="Layer0 Expert31\nGPU:31\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert32 [label="Layer0 Expert32\nGPU:32\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert33 [label="Layer0 Expert33\nGPU:33\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert34 [label="Layer0 Expert34\nGPU:34\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert35 [label="Layer0 Expert35\nGPU:35\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert36 [label="Layer0 Expert36\nGPU:36\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert37 [label="Layer0 Expert37\nGPU:37\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert38 [label="Layer0 Expert38\nGPU:38\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert39 [label="Layer0 Expert39\nGPU:39\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert40 [label="Layer0 Expert40\nGPU:40\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert41 [label="Layer0 Expert41\nGPU:41\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert42 [label="Layer0 Expert42\nGPU:42\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert43 [label="Layer0 Expert43\nGPU:43\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert44 [label="Layer0 Expert44\nGPU:44\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert45 [label="Layer0 Expert45\nGPU:45\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert46 [label="Layer0 Expert46\nGPU:46\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert47 [label="Layer0 Expert47\nGPU:47\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert48 [label="Layer0 Expert48\nGPU:48\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert49 [label="Layer0 Expert49\nGPU:49\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert50 [label="Layer0 Expert50\nGPU:50\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert51 [label="Layer0 Expert51\nGPU:51\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert52 [label="Layer0 Expert52\nGPU:52\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert53 [label="Layer0 Expert53\nGPU:53\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert54 [label="Layer0 Expert54\nGPU:54\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert55 [label="Layer0 Expert55\nGPU:55\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert56 [label="Layer0 Expert56\nGPU:56\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert57 [label="Layer0 Expert57\nGPU:57\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert58 [label="Layer0 Expert58\nGPU:58\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert59 [label="Layer0 Expert59\nGPU:59\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert60 [label="Layer0 Expert60\nGPU:60\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert61 [label="Layer0 Expert61\nGPU:61\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert62 [label="Layer0 Expert62\nGPU:62\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_expert63 [label="Layer0 Expert63\nGPU:63\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer0_combine [label="Layer0 Expert Combine\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer0_res1 [label="Layer0 Residual1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer0_ln1 [label="Layer0 LayerNorm1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer0_res2 [label="Layer0 Residual2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer0_ln2 [label="Layer0 LayerNorm2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer0_qkv_tp0 -> layer0_qkv_comm
	layer0_qkv_comm -> layer0_attn_out_tp0
	layer0_attn_out_tp0 -> layer0_attn_out_comm
	layer0_qkv_tp1 -> layer0_qkv_comm
	layer0_qkv_comm -> layer0_attn_out_tp1
	layer0_attn_out_tp1 -> layer0_attn_out_comm
	layer0_qkv_tp2 -> layer0_qkv_comm
	layer0_qkv_comm -> layer0_attn_out_tp2
	layer0_attn_out_tp2 -> layer0_attn_out_comm
	layer0_qkv_tp3 -> layer0_qkv_comm
	layer0_qkv_comm -> layer0_attn_out_tp3
	layer0_attn_out_tp3 -> layer0_attn_out_comm
	layer0_attn_out_comm -> layer0_res1
	input -> layer0_res1
	layer0_res1 -> layer0_ln1
	layer0_ln1 -> layer0_gate
	layer0_gate -> layer0_dispatch
	layer0_dispatch -> layer0_expert0
	layer0_expert0 -> layer0_combine
	layer0_dispatch -> layer0_expert1
	layer0_expert1 -> layer0_combine
	layer0_dispatch -> layer0_expert2
	layer0_expert2 -> layer0_combine
	layer0_dispatch -> layer0_expert3
	layer0_expert3 -> layer0_combine
	layer0_dispatch -> layer0_expert4
	layer0_expert4 -> layer0_combine
	layer0_dispatch -> layer0_expert5
	layer0_expert5 -> layer0_combine
	layer0_dispatch -> layer0_expert6
	layer0_expert6 -> layer0_combine
	layer0_dispatch -> layer0_expert7
	layer0_expert7 -> layer0_combine
	layer0_dispatch -> layer0_expert8
	layer0_expert8 -> layer0_combine
	layer0_dispatch -> layer0_expert9
	layer0_expert9 -> layer0_combine
	layer0_dispatch -> layer0_expert10
	layer0_expert10 -> layer0_combine
	layer0_dispatch -> layer0_expert11
	layer0_expert11 -> layer0_combine
	layer0_dispatch -> layer0_expert12
	layer0_expert12 -> layer0_combine
	layer0_dispatch -> layer0_expert13
	layer0_expert13 -> layer0_combine
	layer0_dispatch -> layer0_expert14
	layer0_expert14 -> layer0_combine
	layer0_dispatch -> layer0_expert15
	layer0_expert15 -> layer0_combine
	layer0_dispatch -> layer0_expert16
	layer0_expert16 -> layer0_combine
	layer0_dispatch -> layer0_expert17
	layer0_expert17 -> layer0_combine
	layer0_dispatch -> layer0_expert18
	layer0_expert18 -> layer0_combine
	layer0_dispatch -> layer0_expert19
	layer0_expert19 -> layer0_combine
	layer0_dispatch -> layer0_expert20
	layer0_expert20 -> layer0_combine
	layer0_dispatch -> layer0_expert21
	layer0_expert21 -> layer0_combine
	layer0_dispatch -> layer0_expert22
	layer0_expert22 -> layer0_combine
	layer0_dispatch -> layer0_expert23
	layer0_expert23 -> layer0_combine
	layer0_dispatch -> layer0_expert24
	layer0_expert24 -> layer0_combine
	layer0_dispatch -> layer0_expert25
	layer0_expert25 -> layer0_combine
	layer0_dispatch -> layer0_expert26
	layer0_expert26 -> layer0_combine
	layer0_dispatch -> layer0_expert27
	layer0_expert27 -> layer0_combine
	layer0_dispatch -> layer0_expert28
	layer0_expert28 -> layer0_combine
	layer0_dispatch -> layer0_expert29
	layer0_expert29 -> layer0_combine
	layer0_dispatch -> layer0_expert30
	layer0_expert30 -> layer0_combine
	layer0_dispatch -> layer0_expert31
	layer0_expert31 -> layer0_combine
	layer0_dispatch -> layer0_expert32
	layer0_expert32 -> layer0_combine
	layer0_dispatch -> layer0_expert33
	layer0_expert33 -> layer0_combine
	layer0_dispatch -> layer0_expert34
	layer0_expert34 -> layer0_combine
	layer0_dispatch -> layer0_expert35
	layer0_expert35 -> layer0_combine
	layer0_dispatch -> layer0_expert36
	layer0_expert36 -> layer0_combine
	layer0_dispatch -> layer0_expert37
	layer0_expert37 -> layer0_combine
	layer0_dispatch -> layer0_expert38
	layer0_expert38 -> layer0_combine
	layer0_dispatch -> layer0_expert39
	layer0_expert39 -> layer0_combine
	layer0_dispatch -> layer0_expert40
	layer0_expert40 -> layer0_combine
	layer0_dispatch -> layer0_expert41
	layer0_expert41 -> layer0_combine
	layer0_dispatch -> layer0_expert42
	layer0_expert42 -> layer0_combine
	layer0_dispatch -> layer0_expert43
	layer0_expert43 -> layer0_combine
	layer0_dispatch -> layer0_expert44
	layer0_expert44 -> layer0_combine
	layer0_dispatch -> layer0_expert45
	layer0_expert45 -> layer0_combine
	layer0_dispatch -> layer0_expert46
	layer0_expert46 -> layer0_combine
	layer0_dispatch -> layer0_expert47
	layer0_expert47 -> layer0_combine
	layer0_dispatch -> layer0_expert48
	layer0_expert48 -> layer0_combine
	layer0_dispatch -> layer0_expert49
	layer0_expert49 -> layer0_combine
	layer0_dispatch -> layer0_expert50
	layer0_expert50 -> layer0_combine
	layer0_dispatch -> layer0_expert51
	layer0_expert51 -> layer0_combine
	layer0_dispatch -> layer0_expert52
	layer0_expert52 -> layer0_combine
	layer0_dispatch -> layer0_expert53
	layer0_expert53 -> layer0_combine
	layer0_dispatch -> layer0_expert54
	layer0_expert54 -> layer0_combine
	layer0_dispatch -> layer0_expert55
	layer0_expert55 -> layer0_combine
	layer0_dispatch -> layer0_expert56
	layer0_expert56 -> layer0_combine
	layer0_dispatch -> layer0_expert57
	layer0_expert57 -> layer0_combine
	layer0_dispatch -> layer0_expert58
	layer0_expert58 -> layer0_combine
	layer0_dispatch -> layer0_expert59
	layer0_expert59 -> layer0_combine
	layer0_dispatch -> layer0_expert60
	layer0_expert60 -> layer0_combine
	layer0_dispatch -> layer0_expert61
	layer0_expert61 -> layer0_combine
	layer0_dispatch -> layer0_expert62
	layer0_expert62 -> layer0_combine
	layer0_dispatch -> layer0_expert63
	layer0_expert63 -> layer0_combine
	layer0_combine -> layer0_res2
	layer0_ln1 -> layer0_res2
	layer0_res2 -> layer0_ln2
	layer1_qkv_tp0 [label="Layer1 QKV TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer1_attn_out_tp0 [label="Layer1 AttnOut TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer1_mlp1_tp0 [label="Layer1 MLP1 TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=512]" fillcolor=lightblue fontsize=8 shape=box]
	layer1_mlp2_tp0 [label="Layer1 MLP2 TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer1_qkv_tp1 [label="Layer1 QKV TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer1_attn_out_tp1 [label="Layer1 AttnOut TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer1_mlp1_tp1 [label="Layer1 MLP1 TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=512]" fillcolor=lightgreen fontsize=8 shape=box]
	layer1_mlp2_tp1 [label="Layer1 MLP2 TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer1_qkv_tp2 [label="Layer1 QKV TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer1_attn_out_tp2 [label="Layer1 AttnOut TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer1_mlp1_tp2 [label="Layer1 MLP1 TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=512]" fillcolor=lightyellow fontsize=8 shape=box]
	layer1_mlp2_tp2 [label="Layer1 MLP2 TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer1_qkv_tp3 [label="Layer1 QKV TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer1_attn_out_tp3 [label="Layer1 AttnOut TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer1_mlp1_tp3 [label="Layer1 MLP1 TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=512]" fillcolor=lightpink fontsize=8 shape=box]
	layer1_mlp2_tp3 [label="Layer1 MLP2 TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer1_qkv_comm [label="Layer1 QKV AllGather\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer1_attn_out_comm [label="Layer1 AttnOut AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer1_mlp_comm [label="Layer1 MLP AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer1_gate [label="Layer1 MoE Gate\nGPU:EP0-15\n[batch=128, seq=10240, experts=64]" fillcolor=lightgreen fontsize=8 shape=box]
	layer1_dispatch [label="Layer1 Expert Dispatch\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer1_expert0 [label="Layer1 Expert0\nGPU:0\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert1 [label="Layer1 Expert1\nGPU:1\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert2 [label="Layer1 Expert2\nGPU:2\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert3 [label="Layer1 Expert3\nGPU:3\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert4 [label="Layer1 Expert4\nGPU:4\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert5 [label="Layer1 Expert5\nGPU:5\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert6 [label="Layer1 Expert6\nGPU:6\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert7 [label="Layer1 Expert7\nGPU:7\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert8 [label="Layer1 Expert8\nGPU:8\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert9 [label="Layer1 Expert9\nGPU:9\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert10 [label="Layer1 Expert10\nGPU:10\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert11 [label="Layer1 Expert11\nGPU:11\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert12 [label="Layer1 Expert12\nGPU:12\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert13 [label="Layer1 Expert13\nGPU:13\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert14 [label="Layer1 Expert14\nGPU:14\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert15 [label="Layer1 Expert15\nGPU:15\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert16 [label="Layer1 Expert16\nGPU:16\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert17 [label="Layer1 Expert17\nGPU:17\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert18 [label="Layer1 Expert18\nGPU:18\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert19 [label="Layer1 Expert19\nGPU:19\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert20 [label="Layer1 Expert20\nGPU:20\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert21 [label="Layer1 Expert21\nGPU:21\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert22 [label="Layer1 Expert22\nGPU:22\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert23 [label="Layer1 Expert23\nGPU:23\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert24 [label="Layer1 Expert24\nGPU:24\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert25 [label="Layer1 Expert25\nGPU:25\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert26 [label="Layer1 Expert26\nGPU:26\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert27 [label="Layer1 Expert27\nGPU:27\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert28 [label="Layer1 Expert28\nGPU:28\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert29 [label="Layer1 Expert29\nGPU:29\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert30 [label="Layer1 Expert30\nGPU:30\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert31 [label="Layer1 Expert31\nGPU:31\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert32 [label="Layer1 Expert32\nGPU:32\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert33 [label="Layer1 Expert33\nGPU:33\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert34 [label="Layer1 Expert34\nGPU:34\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert35 [label="Layer1 Expert35\nGPU:35\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert36 [label="Layer1 Expert36\nGPU:36\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert37 [label="Layer1 Expert37\nGPU:37\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert38 [label="Layer1 Expert38\nGPU:38\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert39 [label="Layer1 Expert39\nGPU:39\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert40 [label="Layer1 Expert40\nGPU:40\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert41 [label="Layer1 Expert41\nGPU:41\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert42 [label="Layer1 Expert42\nGPU:42\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert43 [label="Layer1 Expert43\nGPU:43\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert44 [label="Layer1 Expert44\nGPU:44\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert45 [label="Layer1 Expert45\nGPU:45\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert46 [label="Layer1 Expert46\nGPU:46\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert47 [label="Layer1 Expert47\nGPU:47\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert48 [label="Layer1 Expert48\nGPU:48\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert49 [label="Layer1 Expert49\nGPU:49\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert50 [label="Layer1 Expert50\nGPU:50\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert51 [label="Layer1 Expert51\nGPU:51\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert52 [label="Layer1 Expert52\nGPU:52\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert53 [label="Layer1 Expert53\nGPU:53\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert54 [label="Layer1 Expert54\nGPU:54\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert55 [label="Layer1 Expert55\nGPU:55\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert56 [label="Layer1 Expert56\nGPU:56\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert57 [label="Layer1 Expert57\nGPU:57\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert58 [label="Layer1 Expert58\nGPU:58\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert59 [label="Layer1 Expert59\nGPU:59\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert60 [label="Layer1 Expert60\nGPU:60\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert61 [label="Layer1 Expert61\nGPU:61\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert62 [label="Layer1 Expert62\nGPU:62\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_expert63 [label="Layer1 Expert63\nGPU:63\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer1_combine [label="Layer1 Expert Combine\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer1_res1 [label="Layer1 Residual1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer1_ln1 [label="Layer1 LayerNorm1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer1_res2 [label="Layer1 Residual2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer1_ln2 [label="Layer1 LayerNorm2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer1_qkv_tp0 -> layer1_qkv_comm
	layer1_qkv_comm -> layer1_attn_out_tp0
	layer1_attn_out_tp0 -> layer1_attn_out_comm
	layer1_qkv_tp1 -> layer1_qkv_comm
	layer1_qkv_comm -> layer1_attn_out_tp1
	layer1_attn_out_tp1 -> layer1_attn_out_comm
	layer1_qkv_tp2 -> layer1_qkv_comm
	layer1_qkv_comm -> layer1_attn_out_tp2
	layer1_attn_out_tp2 -> layer1_attn_out_comm
	layer1_qkv_tp3 -> layer1_qkv_comm
	layer1_qkv_comm -> layer1_attn_out_tp3
	layer1_attn_out_tp3 -> layer1_attn_out_comm
	layer1_attn_out_comm -> layer1_res1
	layer0_ln2 -> layer1_res1
	layer1_res1 -> layer1_ln1
	layer1_ln1 -> layer1_gate
	layer1_gate -> layer1_dispatch
	layer1_dispatch -> layer1_expert0
	layer1_expert0 -> layer1_combine
	layer1_dispatch -> layer1_expert1
	layer1_expert1 -> layer1_combine
	layer1_dispatch -> layer1_expert2
	layer1_expert2 -> layer1_combine
	layer1_dispatch -> layer1_expert3
	layer1_expert3 -> layer1_combine
	layer1_dispatch -> layer1_expert4
	layer1_expert4 -> layer1_combine
	layer1_dispatch -> layer1_expert5
	layer1_expert5 -> layer1_combine
	layer1_dispatch -> layer1_expert6
	layer1_expert6 -> layer1_combine
	layer1_dispatch -> layer1_expert7
	layer1_expert7 -> layer1_combine
	layer1_dispatch -> layer1_expert8
	layer1_expert8 -> layer1_combine
	layer1_dispatch -> layer1_expert9
	layer1_expert9 -> layer1_combine
	layer1_dispatch -> layer1_expert10
	layer1_expert10 -> layer1_combine
	layer1_dispatch -> layer1_expert11
	layer1_expert11 -> layer1_combine
	layer1_dispatch -> layer1_expert12
	layer1_expert12 -> layer1_combine
	layer1_dispatch -> layer1_expert13
	layer1_expert13 -> layer1_combine
	layer1_dispatch -> layer1_expert14
	layer1_expert14 -> layer1_combine
	layer1_dispatch -> layer1_expert15
	layer1_expert15 -> layer1_combine
	layer1_dispatch -> layer1_expert16
	layer1_expert16 -> layer1_combine
	layer1_dispatch -> layer1_expert17
	layer1_expert17 -> layer1_combine
	layer1_dispatch -> layer1_expert18
	layer1_expert18 -> layer1_combine
	layer1_dispatch -> layer1_expert19
	layer1_expert19 -> layer1_combine
	layer1_dispatch -> layer1_expert20
	layer1_expert20 -> layer1_combine
	layer1_dispatch -> layer1_expert21
	layer1_expert21 -> layer1_combine
	layer1_dispatch -> layer1_expert22
	layer1_expert22 -> layer1_combine
	layer1_dispatch -> layer1_expert23
	layer1_expert23 -> layer1_combine
	layer1_dispatch -> layer1_expert24
	layer1_expert24 -> layer1_combine
	layer1_dispatch -> layer1_expert25
	layer1_expert25 -> layer1_combine
	layer1_dispatch -> layer1_expert26
	layer1_expert26 -> layer1_combine
	layer1_dispatch -> layer1_expert27
	layer1_expert27 -> layer1_combine
	layer1_dispatch -> layer1_expert28
	layer1_expert28 -> layer1_combine
	layer1_dispatch -> layer1_expert29
	layer1_expert29 -> layer1_combine
	layer1_dispatch -> layer1_expert30
	layer1_expert30 -> layer1_combine
	layer1_dispatch -> layer1_expert31
	layer1_expert31 -> layer1_combine
	layer1_dispatch -> layer1_expert32
	layer1_expert32 -> layer1_combine
	layer1_dispatch -> layer1_expert33
	layer1_expert33 -> layer1_combine
	layer1_dispatch -> layer1_expert34
	layer1_expert34 -> layer1_combine
	layer1_dispatch -> layer1_expert35
	layer1_expert35 -> layer1_combine
	layer1_dispatch -> layer1_expert36
	layer1_expert36 -> layer1_combine
	layer1_dispatch -> layer1_expert37
	layer1_expert37 -> layer1_combine
	layer1_dispatch -> layer1_expert38
	layer1_expert38 -> layer1_combine
	layer1_dispatch -> layer1_expert39
	layer1_expert39 -> layer1_combine
	layer1_dispatch -> layer1_expert40
	layer1_expert40 -> layer1_combine
	layer1_dispatch -> layer1_expert41
	layer1_expert41 -> layer1_combine
	layer1_dispatch -> layer1_expert42
	layer1_expert42 -> layer1_combine
	layer1_dispatch -> layer1_expert43
	layer1_expert43 -> layer1_combine
	layer1_dispatch -> layer1_expert44
	layer1_expert44 -> layer1_combine
	layer1_dispatch -> layer1_expert45
	layer1_expert45 -> layer1_combine
	layer1_dispatch -> layer1_expert46
	layer1_expert46 -> layer1_combine
	layer1_dispatch -> layer1_expert47
	layer1_expert47 -> layer1_combine
	layer1_dispatch -> layer1_expert48
	layer1_expert48 -> layer1_combine
	layer1_dispatch -> layer1_expert49
	layer1_expert49 -> layer1_combine
	layer1_dispatch -> layer1_expert50
	layer1_expert50 -> layer1_combine
	layer1_dispatch -> layer1_expert51
	layer1_expert51 -> layer1_combine
	layer1_dispatch -> layer1_expert52
	layer1_expert52 -> layer1_combine
	layer1_dispatch -> layer1_expert53
	layer1_expert53 -> layer1_combine
	layer1_dispatch -> layer1_expert54
	layer1_expert54 -> layer1_combine
	layer1_dispatch -> layer1_expert55
	layer1_expert55 -> layer1_combine
	layer1_dispatch -> layer1_expert56
	layer1_expert56 -> layer1_combine
	layer1_dispatch -> layer1_expert57
	layer1_expert57 -> layer1_combine
	layer1_dispatch -> layer1_expert58
	layer1_expert58 -> layer1_combine
	layer1_dispatch -> layer1_expert59
	layer1_expert59 -> layer1_combine
	layer1_dispatch -> layer1_expert60
	layer1_expert60 -> layer1_combine
	layer1_dispatch -> layer1_expert61
	layer1_expert61 -> layer1_combine
	layer1_dispatch -> layer1_expert62
	layer1_expert62 -> layer1_combine
	layer1_dispatch -> layer1_expert63
	layer1_expert63 -> layer1_combine
	layer1_combine -> layer1_res2
	layer1_ln1 -> layer1_res2
	layer1_res2 -> layer1_ln2
	layer2_qkv_tp0 [label="Layer2 QKV TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer2_attn_out_tp0 [label="Layer2 AttnOut TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer2_mlp1_tp0 [label="Layer2 MLP1 TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=512]" fillcolor=lightblue fontsize=8 shape=box]
	layer2_mlp2_tp0 [label="Layer2 MLP2 TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer2_qkv_tp1 [label="Layer2 QKV TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer2_attn_out_tp1 [label="Layer2 AttnOut TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer2_mlp1_tp1 [label="Layer2 MLP1 TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=512]" fillcolor=lightgreen fontsize=8 shape=box]
	layer2_mlp2_tp1 [label="Layer2 MLP2 TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer2_qkv_tp2 [label="Layer2 QKV TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer2_attn_out_tp2 [label="Layer2 AttnOut TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer2_mlp1_tp2 [label="Layer2 MLP1 TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=512]" fillcolor=lightyellow fontsize=8 shape=box]
	layer2_mlp2_tp2 [label="Layer2 MLP2 TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer2_qkv_tp3 [label="Layer2 QKV TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer2_attn_out_tp3 [label="Layer2 AttnOut TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer2_mlp1_tp3 [label="Layer2 MLP1 TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=512]" fillcolor=lightpink fontsize=8 shape=box]
	layer2_mlp2_tp3 [label="Layer2 MLP2 TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer2_qkv_comm [label="Layer2 QKV AllGather\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer2_attn_out_comm [label="Layer2 AttnOut AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer2_mlp_comm [label="Layer2 MLP AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer2_gate [label="Layer2 MoE Gate\nGPU:EP0-15\n[batch=128, seq=10240, experts=64]" fillcolor=lightgreen fontsize=8 shape=box]
	layer2_dispatch [label="Layer2 Expert Dispatch\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer2_expert0 [label="Layer2 Expert0\nGPU:0\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert1 [label="Layer2 Expert1\nGPU:1\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert2 [label="Layer2 Expert2\nGPU:2\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert3 [label="Layer2 Expert3\nGPU:3\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert4 [label="Layer2 Expert4\nGPU:4\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert5 [label="Layer2 Expert5\nGPU:5\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert6 [label="Layer2 Expert6\nGPU:6\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert7 [label="Layer2 Expert7\nGPU:7\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert8 [label="Layer2 Expert8\nGPU:8\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert9 [label="Layer2 Expert9\nGPU:9\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert10 [label="Layer2 Expert10\nGPU:10\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert11 [label="Layer2 Expert11\nGPU:11\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert12 [label="Layer2 Expert12\nGPU:12\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert13 [label="Layer2 Expert13\nGPU:13\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert14 [label="Layer2 Expert14\nGPU:14\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert15 [label="Layer2 Expert15\nGPU:15\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert16 [label="Layer2 Expert16\nGPU:16\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert17 [label="Layer2 Expert17\nGPU:17\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert18 [label="Layer2 Expert18\nGPU:18\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert19 [label="Layer2 Expert19\nGPU:19\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert20 [label="Layer2 Expert20\nGPU:20\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert21 [label="Layer2 Expert21\nGPU:21\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert22 [label="Layer2 Expert22\nGPU:22\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert23 [label="Layer2 Expert23\nGPU:23\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert24 [label="Layer2 Expert24\nGPU:24\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert25 [label="Layer2 Expert25\nGPU:25\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert26 [label="Layer2 Expert26\nGPU:26\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert27 [label="Layer2 Expert27\nGPU:27\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert28 [label="Layer2 Expert28\nGPU:28\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert29 [label="Layer2 Expert29\nGPU:29\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert30 [label="Layer2 Expert30\nGPU:30\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert31 [label="Layer2 Expert31\nGPU:31\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert32 [label="Layer2 Expert32\nGPU:32\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert33 [label="Layer2 Expert33\nGPU:33\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert34 [label="Layer2 Expert34\nGPU:34\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert35 [label="Layer2 Expert35\nGPU:35\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert36 [label="Layer2 Expert36\nGPU:36\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert37 [label="Layer2 Expert37\nGPU:37\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert38 [label="Layer2 Expert38\nGPU:38\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert39 [label="Layer2 Expert39\nGPU:39\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert40 [label="Layer2 Expert40\nGPU:40\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert41 [label="Layer2 Expert41\nGPU:41\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert42 [label="Layer2 Expert42\nGPU:42\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert43 [label="Layer2 Expert43\nGPU:43\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert44 [label="Layer2 Expert44\nGPU:44\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert45 [label="Layer2 Expert45\nGPU:45\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert46 [label="Layer2 Expert46\nGPU:46\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert47 [label="Layer2 Expert47\nGPU:47\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert48 [label="Layer2 Expert48\nGPU:48\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert49 [label="Layer2 Expert49\nGPU:49\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert50 [label="Layer2 Expert50\nGPU:50\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert51 [label="Layer2 Expert51\nGPU:51\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert52 [label="Layer2 Expert52\nGPU:52\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert53 [label="Layer2 Expert53\nGPU:53\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert54 [label="Layer2 Expert54\nGPU:54\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert55 [label="Layer2 Expert55\nGPU:55\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert56 [label="Layer2 Expert56\nGPU:56\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert57 [label="Layer2 Expert57\nGPU:57\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert58 [label="Layer2 Expert58\nGPU:58\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert59 [label="Layer2 Expert59\nGPU:59\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert60 [label="Layer2 Expert60\nGPU:60\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert61 [label="Layer2 Expert61\nGPU:61\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert62 [label="Layer2 Expert62\nGPU:62\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_expert63 [label="Layer2 Expert63\nGPU:63\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer2_combine [label="Layer2 Expert Combine\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer2_res1 [label="Layer2 Residual1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer2_ln1 [label="Layer2 LayerNorm1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer2_res2 [label="Layer2 Residual2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer2_ln2 [label="Layer2 LayerNorm2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer2_qkv_tp0 -> layer2_qkv_comm
	layer2_qkv_comm -> layer2_attn_out_tp0
	layer2_attn_out_tp0 -> layer2_attn_out_comm
	layer2_qkv_tp1 -> layer2_qkv_comm
	layer2_qkv_comm -> layer2_attn_out_tp1
	layer2_attn_out_tp1 -> layer2_attn_out_comm
	layer2_qkv_tp2 -> layer2_qkv_comm
	layer2_qkv_comm -> layer2_attn_out_tp2
	layer2_attn_out_tp2 -> layer2_attn_out_comm
	layer2_qkv_tp3 -> layer2_qkv_comm
	layer2_qkv_comm -> layer2_attn_out_tp3
	layer2_attn_out_tp3 -> layer2_attn_out_comm
	layer2_attn_out_comm -> layer2_res1
	layer1_ln2 -> layer2_res1
	layer2_res1 -> layer2_ln1
	layer2_ln1 -> layer2_gate
	layer2_gate -> layer2_dispatch
	layer2_dispatch -> layer2_expert0
	layer2_expert0 -> layer2_combine
	layer2_dispatch -> layer2_expert1
	layer2_expert1 -> layer2_combine
	layer2_dispatch -> layer2_expert2
	layer2_expert2 -> layer2_combine
	layer2_dispatch -> layer2_expert3
	layer2_expert3 -> layer2_combine
	layer2_dispatch -> layer2_expert4
	layer2_expert4 -> layer2_combine
	layer2_dispatch -> layer2_expert5
	layer2_expert5 -> layer2_combine
	layer2_dispatch -> layer2_expert6
	layer2_expert6 -> layer2_combine
	layer2_dispatch -> layer2_expert7
	layer2_expert7 -> layer2_combine
	layer2_dispatch -> layer2_expert8
	layer2_expert8 -> layer2_combine
	layer2_dispatch -> layer2_expert9
	layer2_expert9 -> layer2_combine
	layer2_dispatch -> layer2_expert10
	layer2_expert10 -> layer2_combine
	layer2_dispatch -> layer2_expert11
	layer2_expert11 -> layer2_combine
	layer2_dispatch -> layer2_expert12
	layer2_expert12 -> layer2_combine
	layer2_dispatch -> layer2_expert13
	layer2_expert13 -> layer2_combine
	layer2_dispatch -> layer2_expert14
	layer2_expert14 -> layer2_combine
	layer2_dispatch -> layer2_expert15
	layer2_expert15 -> layer2_combine
	layer2_dispatch -> layer2_expert16
	layer2_expert16 -> layer2_combine
	layer2_dispatch -> layer2_expert17
	layer2_expert17 -> layer2_combine
	layer2_dispatch -> layer2_expert18
	layer2_expert18 -> layer2_combine
	layer2_dispatch -> layer2_expert19
	layer2_expert19 -> layer2_combine
	layer2_dispatch -> layer2_expert20
	layer2_expert20 -> layer2_combine
	layer2_dispatch -> layer2_expert21
	layer2_expert21 -> layer2_combine
	layer2_dispatch -> layer2_expert22
	layer2_expert22 -> layer2_combine
	layer2_dispatch -> layer2_expert23
	layer2_expert23 -> layer2_combine
	layer2_dispatch -> layer2_expert24
	layer2_expert24 -> layer2_combine
	layer2_dispatch -> layer2_expert25
	layer2_expert25 -> layer2_combine
	layer2_dispatch -> layer2_expert26
	layer2_expert26 -> layer2_combine
	layer2_dispatch -> layer2_expert27
	layer2_expert27 -> layer2_combine
	layer2_dispatch -> layer2_expert28
	layer2_expert28 -> layer2_combine
	layer2_dispatch -> layer2_expert29
	layer2_expert29 -> layer2_combine
	layer2_dispatch -> layer2_expert30
	layer2_expert30 -> layer2_combine
	layer2_dispatch -> layer2_expert31
	layer2_expert31 -> layer2_combine
	layer2_dispatch -> layer2_expert32
	layer2_expert32 -> layer2_combine
	layer2_dispatch -> layer2_expert33
	layer2_expert33 -> layer2_combine
	layer2_dispatch -> layer2_expert34
	layer2_expert34 -> layer2_combine
	layer2_dispatch -> layer2_expert35
	layer2_expert35 -> layer2_combine
	layer2_dispatch -> layer2_expert36
	layer2_expert36 -> layer2_combine
	layer2_dispatch -> layer2_expert37
	layer2_expert37 -> layer2_combine
	layer2_dispatch -> layer2_expert38
	layer2_expert38 -> layer2_combine
	layer2_dispatch -> layer2_expert39
	layer2_expert39 -> layer2_combine
	layer2_dispatch -> layer2_expert40
	layer2_expert40 -> layer2_combine
	layer2_dispatch -> layer2_expert41
	layer2_expert41 -> layer2_combine
	layer2_dispatch -> layer2_expert42
	layer2_expert42 -> layer2_combine
	layer2_dispatch -> layer2_expert43
	layer2_expert43 -> layer2_combine
	layer2_dispatch -> layer2_expert44
	layer2_expert44 -> layer2_combine
	layer2_dispatch -> layer2_expert45
	layer2_expert45 -> layer2_combine
	layer2_dispatch -> layer2_expert46
	layer2_expert46 -> layer2_combine
	layer2_dispatch -> layer2_expert47
	layer2_expert47 -> layer2_combine
	layer2_dispatch -> layer2_expert48
	layer2_expert48 -> layer2_combine
	layer2_dispatch -> layer2_expert49
	layer2_expert49 -> layer2_combine
	layer2_dispatch -> layer2_expert50
	layer2_expert50 -> layer2_combine
	layer2_dispatch -> layer2_expert51
	layer2_expert51 -> layer2_combine
	layer2_dispatch -> layer2_expert52
	layer2_expert52 -> layer2_combine
	layer2_dispatch -> layer2_expert53
	layer2_expert53 -> layer2_combine
	layer2_dispatch -> layer2_expert54
	layer2_expert54 -> layer2_combine
	layer2_dispatch -> layer2_expert55
	layer2_expert55 -> layer2_combine
	layer2_dispatch -> layer2_expert56
	layer2_expert56 -> layer2_combine
	layer2_dispatch -> layer2_expert57
	layer2_expert57 -> layer2_combine
	layer2_dispatch -> layer2_expert58
	layer2_expert58 -> layer2_combine
	layer2_dispatch -> layer2_expert59
	layer2_expert59 -> layer2_combine
	layer2_dispatch -> layer2_expert60
	layer2_expert60 -> layer2_combine
	layer2_dispatch -> layer2_expert61
	layer2_expert61 -> layer2_combine
	layer2_dispatch -> layer2_expert62
	layer2_expert62 -> layer2_combine
	layer2_dispatch -> layer2_expert63
	layer2_expert63 -> layer2_combine
	layer2_combine -> layer2_res2
	layer2_ln1 -> layer2_res2
	layer2_res2 -> layer2_ln2
	layer3_qkv_tp0 [label="Layer3 QKV TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer3_attn_out_tp0 [label="Layer3 AttnOut TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer3_mlp1_tp0 [label="Layer3 MLP1 TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=512]" fillcolor=lightblue fontsize=8 shape=box]
	layer3_mlp2_tp0 [label="Layer3 MLP2 TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer3_qkv_tp1 [label="Layer3 QKV TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer3_attn_out_tp1 [label="Layer3 AttnOut TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer3_mlp1_tp1 [label="Layer3 MLP1 TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=512]" fillcolor=lightgreen fontsize=8 shape=box]
	layer3_mlp2_tp1 [label="Layer3 MLP2 TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer3_qkv_tp2 [label="Layer3 QKV TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer3_attn_out_tp2 [label="Layer3 AttnOut TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer3_mlp1_tp2 [label="Layer3 MLP1 TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=512]" fillcolor=lightyellow fontsize=8 shape=box]
	layer3_mlp2_tp2 [label="Layer3 MLP2 TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer3_qkv_tp3 [label="Layer3 QKV TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer3_attn_out_tp3 [label="Layer3 AttnOut TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer3_mlp1_tp3 [label="Layer3 MLP1 TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=512]" fillcolor=lightpink fontsize=8 shape=box]
	layer3_mlp2_tp3 [label="Layer3 MLP2 TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer3_qkv_comm [label="Layer3 QKV AllGather\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer3_attn_out_comm [label="Layer3 AttnOut AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer3_mlp_comm [label="Layer3 MLP AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer3_gate [label="Layer3 MoE Gate\nGPU:EP0-15\n[batch=128, seq=10240, experts=64]" fillcolor=lightgreen fontsize=8 shape=box]
	layer3_dispatch [label="Layer3 Expert Dispatch\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer3_expert0 [label="Layer3 Expert0\nGPU:0\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert1 [label="Layer3 Expert1\nGPU:1\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert2 [label="Layer3 Expert2\nGPU:2\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert3 [label="Layer3 Expert3\nGPU:3\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert4 [label="Layer3 Expert4\nGPU:4\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert5 [label="Layer3 Expert5\nGPU:5\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert6 [label="Layer3 Expert6\nGPU:6\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert7 [label="Layer3 Expert7\nGPU:7\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert8 [label="Layer3 Expert8\nGPU:8\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert9 [label="Layer3 Expert9\nGPU:9\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert10 [label="Layer3 Expert10\nGPU:10\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert11 [label="Layer3 Expert11\nGPU:11\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert12 [label="Layer3 Expert12\nGPU:12\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert13 [label="Layer3 Expert13\nGPU:13\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert14 [label="Layer3 Expert14\nGPU:14\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert15 [label="Layer3 Expert15\nGPU:15\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert16 [label="Layer3 Expert16\nGPU:16\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert17 [label="Layer3 Expert17\nGPU:17\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert18 [label="Layer3 Expert18\nGPU:18\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert19 [label="Layer3 Expert19\nGPU:19\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert20 [label="Layer3 Expert20\nGPU:20\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert21 [label="Layer3 Expert21\nGPU:21\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert22 [label="Layer3 Expert22\nGPU:22\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert23 [label="Layer3 Expert23\nGPU:23\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert24 [label="Layer3 Expert24\nGPU:24\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert25 [label="Layer3 Expert25\nGPU:25\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert26 [label="Layer3 Expert26\nGPU:26\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert27 [label="Layer3 Expert27\nGPU:27\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert28 [label="Layer3 Expert28\nGPU:28\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert29 [label="Layer3 Expert29\nGPU:29\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert30 [label="Layer3 Expert30\nGPU:30\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert31 [label="Layer3 Expert31\nGPU:31\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert32 [label="Layer3 Expert32\nGPU:32\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert33 [label="Layer3 Expert33\nGPU:33\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert34 [label="Layer3 Expert34\nGPU:34\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert35 [label="Layer3 Expert35\nGPU:35\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert36 [label="Layer3 Expert36\nGPU:36\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert37 [label="Layer3 Expert37\nGPU:37\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert38 [label="Layer3 Expert38\nGPU:38\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert39 [label="Layer3 Expert39\nGPU:39\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert40 [label="Layer3 Expert40\nGPU:40\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert41 [label="Layer3 Expert41\nGPU:41\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert42 [label="Layer3 Expert42\nGPU:42\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert43 [label="Layer3 Expert43\nGPU:43\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert44 [label="Layer3 Expert44\nGPU:44\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert45 [label="Layer3 Expert45\nGPU:45\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert46 [label="Layer3 Expert46\nGPU:46\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert47 [label="Layer3 Expert47\nGPU:47\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert48 [label="Layer3 Expert48\nGPU:48\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert49 [label="Layer3 Expert49\nGPU:49\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert50 [label="Layer3 Expert50\nGPU:50\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert51 [label="Layer3 Expert51\nGPU:51\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert52 [label="Layer3 Expert52\nGPU:52\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert53 [label="Layer3 Expert53\nGPU:53\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert54 [label="Layer3 Expert54\nGPU:54\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert55 [label="Layer3 Expert55\nGPU:55\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert56 [label="Layer3 Expert56\nGPU:56\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert57 [label="Layer3 Expert57\nGPU:57\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert58 [label="Layer3 Expert58\nGPU:58\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert59 [label="Layer3 Expert59\nGPU:59\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert60 [label="Layer3 Expert60\nGPU:60\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert61 [label="Layer3 Expert61\nGPU:61\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert62 [label="Layer3 Expert62\nGPU:62\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_expert63 [label="Layer3 Expert63\nGPU:63\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer3_combine [label="Layer3 Expert Combine\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer3_res1 [label="Layer3 Residual1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer3_ln1 [label="Layer3 LayerNorm1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer3_res2 [label="Layer3 Residual2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer3_ln2 [label="Layer3 LayerNorm2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer3_qkv_tp0 -> layer3_qkv_comm
	layer3_qkv_comm -> layer3_attn_out_tp0
	layer3_attn_out_tp0 -> layer3_attn_out_comm
	layer3_qkv_tp1 -> layer3_qkv_comm
	layer3_qkv_comm -> layer3_attn_out_tp1
	layer3_attn_out_tp1 -> layer3_attn_out_comm
	layer3_qkv_tp2 -> layer3_qkv_comm
	layer3_qkv_comm -> layer3_attn_out_tp2
	layer3_attn_out_tp2 -> layer3_attn_out_comm
	layer3_qkv_tp3 -> layer3_qkv_comm
	layer3_qkv_comm -> layer3_attn_out_tp3
	layer3_attn_out_tp3 -> layer3_attn_out_comm
	layer3_attn_out_comm -> layer3_res1
	layer2_ln2 -> layer3_res1
	layer3_res1 -> layer3_ln1
	layer3_ln1 -> layer3_gate
	layer3_gate -> layer3_dispatch
	layer3_dispatch -> layer3_expert0
	layer3_expert0 -> layer3_combine
	layer3_dispatch -> layer3_expert1
	layer3_expert1 -> layer3_combine
	layer3_dispatch -> layer3_expert2
	layer3_expert2 -> layer3_combine
	layer3_dispatch -> layer3_expert3
	layer3_expert3 -> layer3_combine
	layer3_dispatch -> layer3_expert4
	layer3_expert4 -> layer3_combine
	layer3_dispatch -> layer3_expert5
	layer3_expert5 -> layer3_combine
	layer3_dispatch -> layer3_expert6
	layer3_expert6 -> layer3_combine
	layer3_dispatch -> layer3_expert7
	layer3_expert7 -> layer3_combine
	layer3_dispatch -> layer3_expert8
	layer3_expert8 -> layer3_combine
	layer3_dispatch -> layer3_expert9
	layer3_expert9 -> layer3_combine
	layer3_dispatch -> layer3_expert10
	layer3_expert10 -> layer3_combine
	layer3_dispatch -> layer3_expert11
	layer3_expert11 -> layer3_combine
	layer3_dispatch -> layer3_expert12
	layer3_expert12 -> layer3_combine
	layer3_dispatch -> layer3_expert13
	layer3_expert13 -> layer3_combine
	layer3_dispatch -> layer3_expert14
	layer3_expert14 -> layer3_combine
	layer3_dispatch -> layer3_expert15
	layer3_expert15 -> layer3_combine
	layer3_dispatch -> layer3_expert16
	layer3_expert16 -> layer3_combine
	layer3_dispatch -> layer3_expert17
	layer3_expert17 -> layer3_combine
	layer3_dispatch -> layer3_expert18
	layer3_expert18 -> layer3_combine
	layer3_dispatch -> layer3_expert19
	layer3_expert19 -> layer3_combine
	layer3_dispatch -> layer3_expert20
	layer3_expert20 -> layer3_combine
	layer3_dispatch -> layer3_expert21
	layer3_expert21 -> layer3_combine
	layer3_dispatch -> layer3_expert22
	layer3_expert22 -> layer3_combine
	layer3_dispatch -> layer3_expert23
	layer3_expert23 -> layer3_combine
	layer3_dispatch -> layer3_expert24
	layer3_expert24 -> layer3_combine
	layer3_dispatch -> layer3_expert25
	layer3_expert25 -> layer3_combine
	layer3_dispatch -> layer3_expert26
	layer3_expert26 -> layer3_combine
	layer3_dispatch -> layer3_expert27
	layer3_expert27 -> layer3_combine
	layer3_dispatch -> layer3_expert28
	layer3_expert28 -> layer3_combine
	layer3_dispatch -> layer3_expert29
	layer3_expert29 -> layer3_combine
	layer3_dispatch -> layer3_expert30
	layer3_expert30 -> layer3_combine
	layer3_dispatch -> layer3_expert31
	layer3_expert31 -> layer3_combine
	layer3_dispatch -> layer3_expert32
	layer3_expert32 -> layer3_combine
	layer3_dispatch -> layer3_expert33
	layer3_expert33 -> layer3_combine
	layer3_dispatch -> layer3_expert34
	layer3_expert34 -> layer3_combine
	layer3_dispatch -> layer3_expert35
	layer3_expert35 -> layer3_combine
	layer3_dispatch -> layer3_expert36
	layer3_expert36 -> layer3_combine
	layer3_dispatch -> layer3_expert37
	layer3_expert37 -> layer3_combine
	layer3_dispatch -> layer3_expert38
	layer3_expert38 -> layer3_combine
	layer3_dispatch -> layer3_expert39
	layer3_expert39 -> layer3_combine
	layer3_dispatch -> layer3_expert40
	layer3_expert40 -> layer3_combine
	layer3_dispatch -> layer3_expert41
	layer3_expert41 -> layer3_combine
	layer3_dispatch -> layer3_expert42
	layer3_expert42 -> layer3_combine
	layer3_dispatch -> layer3_expert43
	layer3_expert43 -> layer3_combine
	layer3_dispatch -> layer3_expert44
	layer3_expert44 -> layer3_combine
	layer3_dispatch -> layer3_expert45
	layer3_expert45 -> layer3_combine
	layer3_dispatch -> layer3_expert46
	layer3_expert46 -> layer3_combine
	layer3_dispatch -> layer3_expert47
	layer3_expert47 -> layer3_combine
	layer3_dispatch -> layer3_expert48
	layer3_expert48 -> layer3_combine
	layer3_dispatch -> layer3_expert49
	layer3_expert49 -> layer3_combine
	layer3_dispatch -> layer3_expert50
	layer3_expert50 -> layer3_combine
	layer3_dispatch -> layer3_expert51
	layer3_expert51 -> layer3_combine
	layer3_dispatch -> layer3_expert52
	layer3_expert52 -> layer3_combine
	layer3_dispatch -> layer3_expert53
	layer3_expert53 -> layer3_combine
	layer3_dispatch -> layer3_expert54
	layer3_expert54 -> layer3_combine
	layer3_dispatch -> layer3_expert55
	layer3_expert55 -> layer3_combine
	layer3_dispatch -> layer3_expert56
	layer3_expert56 -> layer3_combine
	layer3_dispatch -> layer3_expert57
	layer3_expert57 -> layer3_combine
	layer3_dispatch -> layer3_expert58
	layer3_expert58 -> layer3_combine
	layer3_dispatch -> layer3_expert59
	layer3_expert59 -> layer3_combine
	layer3_dispatch -> layer3_expert60
	layer3_expert60 -> layer3_combine
	layer3_dispatch -> layer3_expert61
	layer3_expert61 -> layer3_combine
	layer3_dispatch -> layer3_expert62
	layer3_expert62 -> layer3_combine
	layer3_dispatch -> layer3_expert63
	layer3_expert63 -> layer3_combine
	layer3_combine -> layer3_res2
	layer3_ln1 -> layer3_res2
	layer3_res2 -> layer3_ln2
	layer4_qkv_tp0 [label="Layer4 QKV TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer4_attn_out_tp0 [label="Layer4 AttnOut TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer4_mlp1_tp0 [label="Layer4 MLP1 TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=512]" fillcolor=lightblue fontsize=8 shape=box]
	layer4_mlp2_tp0 [label="Layer4 MLP2 TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer4_qkv_tp1 [label="Layer4 QKV TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer4_attn_out_tp1 [label="Layer4 AttnOut TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer4_mlp1_tp1 [label="Layer4 MLP1 TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=512]" fillcolor=lightgreen fontsize=8 shape=box]
	layer4_mlp2_tp1 [label="Layer4 MLP2 TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer4_qkv_tp2 [label="Layer4 QKV TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer4_attn_out_tp2 [label="Layer4 AttnOut TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer4_mlp1_tp2 [label="Layer4 MLP1 TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=512]" fillcolor=lightyellow fontsize=8 shape=box]
	layer4_mlp2_tp2 [label="Layer4 MLP2 TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer4_qkv_tp3 [label="Layer4 QKV TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer4_attn_out_tp3 [label="Layer4 AttnOut TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer4_mlp1_tp3 [label="Layer4 MLP1 TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=512]" fillcolor=lightpink fontsize=8 shape=box]
	layer4_mlp2_tp3 [label="Layer4 MLP2 TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer4_qkv_comm [label="Layer4 QKV AllGather\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer4_attn_out_comm [label="Layer4 AttnOut AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer4_mlp_comm [label="Layer4 MLP AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer4_gate [label="Layer4 MoE Gate\nGPU:EP0-15\n[batch=128, seq=10240, experts=64]" fillcolor=lightgreen fontsize=8 shape=box]
	layer4_dispatch [label="Layer4 Expert Dispatch\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer4_expert0 [label="Layer4 Expert0\nGPU:0\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert1 [label="Layer4 Expert1\nGPU:1\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert2 [label="Layer4 Expert2\nGPU:2\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert3 [label="Layer4 Expert3\nGPU:3\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert4 [label="Layer4 Expert4\nGPU:4\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert5 [label="Layer4 Expert5\nGPU:5\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert6 [label="Layer4 Expert6\nGPU:6\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert7 [label="Layer4 Expert7\nGPU:7\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert8 [label="Layer4 Expert8\nGPU:8\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert9 [label="Layer4 Expert9\nGPU:9\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert10 [label="Layer4 Expert10\nGPU:10\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert11 [label="Layer4 Expert11\nGPU:11\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert12 [label="Layer4 Expert12\nGPU:12\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert13 [label="Layer4 Expert13\nGPU:13\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert14 [label="Layer4 Expert14\nGPU:14\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert15 [label="Layer4 Expert15\nGPU:15\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert16 [label="Layer4 Expert16\nGPU:16\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert17 [label="Layer4 Expert17\nGPU:17\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert18 [label="Layer4 Expert18\nGPU:18\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert19 [label="Layer4 Expert19\nGPU:19\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert20 [label="Layer4 Expert20\nGPU:20\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert21 [label="Layer4 Expert21\nGPU:21\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert22 [label="Layer4 Expert22\nGPU:22\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert23 [label="Layer4 Expert23\nGPU:23\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert24 [label="Layer4 Expert24\nGPU:24\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert25 [label="Layer4 Expert25\nGPU:25\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert26 [label="Layer4 Expert26\nGPU:26\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert27 [label="Layer4 Expert27\nGPU:27\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert28 [label="Layer4 Expert28\nGPU:28\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert29 [label="Layer4 Expert29\nGPU:29\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert30 [label="Layer4 Expert30\nGPU:30\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert31 [label="Layer4 Expert31\nGPU:31\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert32 [label="Layer4 Expert32\nGPU:32\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert33 [label="Layer4 Expert33\nGPU:33\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert34 [label="Layer4 Expert34\nGPU:34\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert35 [label="Layer4 Expert35\nGPU:35\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert36 [label="Layer4 Expert36\nGPU:36\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert37 [label="Layer4 Expert37\nGPU:37\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert38 [label="Layer4 Expert38\nGPU:38\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert39 [label="Layer4 Expert39\nGPU:39\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert40 [label="Layer4 Expert40\nGPU:40\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert41 [label="Layer4 Expert41\nGPU:41\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert42 [label="Layer4 Expert42\nGPU:42\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert43 [label="Layer4 Expert43\nGPU:43\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert44 [label="Layer4 Expert44\nGPU:44\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert45 [label="Layer4 Expert45\nGPU:45\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert46 [label="Layer4 Expert46\nGPU:46\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert47 [label="Layer4 Expert47\nGPU:47\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert48 [label="Layer4 Expert48\nGPU:48\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert49 [label="Layer4 Expert49\nGPU:49\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert50 [label="Layer4 Expert50\nGPU:50\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert51 [label="Layer4 Expert51\nGPU:51\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert52 [label="Layer4 Expert52\nGPU:52\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert53 [label="Layer4 Expert53\nGPU:53\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert54 [label="Layer4 Expert54\nGPU:54\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert55 [label="Layer4 Expert55\nGPU:55\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert56 [label="Layer4 Expert56\nGPU:56\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert57 [label="Layer4 Expert57\nGPU:57\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert58 [label="Layer4 Expert58\nGPU:58\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert59 [label="Layer4 Expert59\nGPU:59\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert60 [label="Layer4 Expert60\nGPU:60\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert61 [label="Layer4 Expert61\nGPU:61\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert62 [label="Layer4 Expert62\nGPU:62\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_expert63 [label="Layer4 Expert63\nGPU:63\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer4_combine [label="Layer4 Expert Combine\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer4_res1 [label="Layer4 Residual1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer4_ln1 [label="Layer4 LayerNorm1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer4_res2 [label="Layer4 Residual2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer4_ln2 [label="Layer4 LayerNorm2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer4_qkv_tp0 -> layer4_qkv_comm
	layer4_qkv_comm -> layer4_attn_out_tp0
	layer4_attn_out_tp0 -> layer4_attn_out_comm
	layer4_qkv_tp1 -> layer4_qkv_comm
	layer4_qkv_comm -> layer4_attn_out_tp1
	layer4_attn_out_tp1 -> layer4_attn_out_comm
	layer4_qkv_tp2 -> layer4_qkv_comm
	layer4_qkv_comm -> layer4_attn_out_tp2
	layer4_attn_out_tp2 -> layer4_attn_out_comm
	layer4_qkv_tp3 -> layer4_qkv_comm
	layer4_qkv_comm -> layer4_attn_out_tp3
	layer4_attn_out_tp3 -> layer4_attn_out_comm
	layer4_attn_out_comm -> layer4_res1
	layer3_ln2 -> layer4_res1
	layer4_res1 -> layer4_ln1
	layer4_ln1 -> layer4_gate
	layer4_gate -> layer4_dispatch
	layer4_dispatch -> layer4_expert0
	layer4_expert0 -> layer4_combine
	layer4_dispatch -> layer4_expert1
	layer4_expert1 -> layer4_combine
	layer4_dispatch -> layer4_expert2
	layer4_expert2 -> layer4_combine
	layer4_dispatch -> layer4_expert3
	layer4_expert3 -> layer4_combine
	layer4_dispatch -> layer4_expert4
	layer4_expert4 -> layer4_combine
	layer4_dispatch -> layer4_expert5
	layer4_expert5 -> layer4_combine
	layer4_dispatch -> layer4_expert6
	layer4_expert6 -> layer4_combine
	layer4_dispatch -> layer4_expert7
	layer4_expert7 -> layer4_combine
	layer4_dispatch -> layer4_expert8
	layer4_expert8 -> layer4_combine
	layer4_dispatch -> layer4_expert9
	layer4_expert9 -> layer4_combine
	layer4_dispatch -> layer4_expert10
	layer4_expert10 -> layer4_combine
	layer4_dispatch -> layer4_expert11
	layer4_expert11 -> layer4_combine
	layer4_dispatch -> layer4_expert12
	layer4_expert12 -> layer4_combine
	layer4_dispatch -> layer4_expert13
	layer4_expert13 -> layer4_combine
	layer4_dispatch -> layer4_expert14
	layer4_expert14 -> layer4_combine
	layer4_dispatch -> layer4_expert15
	layer4_expert15 -> layer4_combine
	layer4_dispatch -> layer4_expert16
	layer4_expert16 -> layer4_combine
	layer4_dispatch -> layer4_expert17
	layer4_expert17 -> layer4_combine
	layer4_dispatch -> layer4_expert18
	layer4_expert18 -> layer4_combine
	layer4_dispatch -> layer4_expert19
	layer4_expert19 -> layer4_combine
	layer4_dispatch -> layer4_expert20
	layer4_expert20 -> layer4_combine
	layer4_dispatch -> layer4_expert21
	layer4_expert21 -> layer4_combine
	layer4_dispatch -> layer4_expert22
	layer4_expert22 -> layer4_combine
	layer4_dispatch -> layer4_expert23
	layer4_expert23 -> layer4_combine
	layer4_dispatch -> layer4_expert24
	layer4_expert24 -> layer4_combine
	layer4_dispatch -> layer4_expert25
	layer4_expert25 -> layer4_combine
	layer4_dispatch -> layer4_expert26
	layer4_expert26 -> layer4_combine
	layer4_dispatch -> layer4_expert27
	layer4_expert27 -> layer4_combine
	layer4_dispatch -> layer4_expert28
	layer4_expert28 -> layer4_combine
	layer4_dispatch -> layer4_expert29
	layer4_expert29 -> layer4_combine
	layer4_dispatch -> layer4_expert30
	layer4_expert30 -> layer4_combine
	layer4_dispatch -> layer4_expert31
	layer4_expert31 -> layer4_combine
	layer4_dispatch -> layer4_expert32
	layer4_expert32 -> layer4_combine
	layer4_dispatch -> layer4_expert33
	layer4_expert33 -> layer4_combine
	layer4_dispatch -> layer4_expert34
	layer4_expert34 -> layer4_combine
	layer4_dispatch -> layer4_expert35
	layer4_expert35 -> layer4_combine
	layer4_dispatch -> layer4_expert36
	layer4_expert36 -> layer4_combine
	layer4_dispatch -> layer4_expert37
	layer4_expert37 -> layer4_combine
	layer4_dispatch -> layer4_expert38
	layer4_expert38 -> layer4_combine
	layer4_dispatch -> layer4_expert39
	layer4_expert39 -> layer4_combine
	layer4_dispatch -> layer4_expert40
	layer4_expert40 -> layer4_combine
	layer4_dispatch -> layer4_expert41
	layer4_expert41 -> layer4_combine
	layer4_dispatch -> layer4_expert42
	layer4_expert42 -> layer4_combine
	layer4_dispatch -> layer4_expert43
	layer4_expert43 -> layer4_combine
	layer4_dispatch -> layer4_expert44
	layer4_expert44 -> layer4_combine
	layer4_dispatch -> layer4_expert45
	layer4_expert45 -> layer4_combine
	layer4_dispatch -> layer4_expert46
	layer4_expert46 -> layer4_combine
	layer4_dispatch -> layer4_expert47
	layer4_expert47 -> layer4_combine
	layer4_dispatch -> layer4_expert48
	layer4_expert48 -> layer4_combine
	layer4_dispatch -> layer4_expert49
	layer4_expert49 -> layer4_combine
	layer4_dispatch -> layer4_expert50
	layer4_expert50 -> layer4_combine
	layer4_dispatch -> layer4_expert51
	layer4_expert51 -> layer4_combine
	layer4_dispatch -> layer4_expert52
	layer4_expert52 -> layer4_combine
	layer4_dispatch -> layer4_expert53
	layer4_expert53 -> layer4_combine
	layer4_dispatch -> layer4_expert54
	layer4_expert54 -> layer4_combine
	layer4_dispatch -> layer4_expert55
	layer4_expert55 -> layer4_combine
	layer4_dispatch -> layer4_expert56
	layer4_expert56 -> layer4_combine
	layer4_dispatch -> layer4_expert57
	layer4_expert57 -> layer4_combine
	layer4_dispatch -> layer4_expert58
	layer4_expert58 -> layer4_combine
	layer4_dispatch -> layer4_expert59
	layer4_expert59 -> layer4_combine
	layer4_dispatch -> layer4_expert60
	layer4_expert60 -> layer4_combine
	layer4_dispatch -> layer4_expert61
	layer4_expert61 -> layer4_combine
	layer4_dispatch -> layer4_expert62
	layer4_expert62 -> layer4_combine
	layer4_dispatch -> layer4_expert63
	layer4_expert63 -> layer4_combine
	layer4_combine -> layer4_res2
	layer4_ln1 -> layer4_res2
	layer4_res2 -> layer4_ln2
	layer5_qkv_tp0 [label="Layer5 QKV TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer5_attn_out_tp0 [label="Layer5 AttnOut TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer5_mlp1_tp0 [label="Layer5 MLP1 TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=512]" fillcolor=lightblue fontsize=8 shape=box]
	layer5_mlp2_tp0 [label="Layer5 MLP2 TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer5_qkv_tp1 [label="Layer5 QKV TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer5_attn_out_tp1 [label="Layer5 AttnOut TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer5_mlp1_tp1 [label="Layer5 MLP1 TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=512]" fillcolor=lightgreen fontsize=8 shape=box]
	layer5_mlp2_tp1 [label="Layer5 MLP2 TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer5_qkv_tp2 [label="Layer5 QKV TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer5_attn_out_tp2 [label="Layer5 AttnOut TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer5_mlp1_tp2 [label="Layer5 MLP1 TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=512]" fillcolor=lightyellow fontsize=8 shape=box]
	layer5_mlp2_tp2 [label="Layer5 MLP2 TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer5_qkv_tp3 [label="Layer5 QKV TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer5_attn_out_tp3 [label="Layer5 AttnOut TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer5_mlp1_tp3 [label="Layer5 MLP1 TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=512]" fillcolor=lightpink fontsize=8 shape=box]
	layer5_mlp2_tp3 [label="Layer5 MLP2 TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer5_qkv_comm [label="Layer5 QKV AllGather\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer5_attn_out_comm [label="Layer5 AttnOut AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer5_mlp_comm [label="Layer5 MLP AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer5_gate [label="Layer5 MoE Gate\nGPU:EP0-15\n[batch=128, seq=10240, experts=64]" fillcolor=lightgreen fontsize=8 shape=box]
	layer5_dispatch [label="Layer5 Expert Dispatch\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer5_expert0 [label="Layer5 Expert0\nGPU:0\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert1 [label="Layer5 Expert1\nGPU:1\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert2 [label="Layer5 Expert2\nGPU:2\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert3 [label="Layer5 Expert3\nGPU:3\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert4 [label="Layer5 Expert4\nGPU:4\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert5 [label="Layer5 Expert5\nGPU:5\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert6 [label="Layer5 Expert6\nGPU:6\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert7 [label="Layer5 Expert7\nGPU:7\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert8 [label="Layer5 Expert8\nGPU:8\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert9 [label="Layer5 Expert9\nGPU:9\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert10 [label="Layer5 Expert10\nGPU:10\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert11 [label="Layer5 Expert11\nGPU:11\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert12 [label="Layer5 Expert12\nGPU:12\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert13 [label="Layer5 Expert13\nGPU:13\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert14 [label="Layer5 Expert14\nGPU:14\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert15 [label="Layer5 Expert15\nGPU:15\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert16 [label="Layer5 Expert16\nGPU:16\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert17 [label="Layer5 Expert17\nGPU:17\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert18 [label="Layer5 Expert18\nGPU:18\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert19 [label="Layer5 Expert19\nGPU:19\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert20 [label="Layer5 Expert20\nGPU:20\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert21 [label="Layer5 Expert21\nGPU:21\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert22 [label="Layer5 Expert22\nGPU:22\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert23 [label="Layer5 Expert23\nGPU:23\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert24 [label="Layer5 Expert24\nGPU:24\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert25 [label="Layer5 Expert25\nGPU:25\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert26 [label="Layer5 Expert26\nGPU:26\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert27 [label="Layer5 Expert27\nGPU:27\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert28 [label="Layer5 Expert28\nGPU:28\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert29 [label="Layer5 Expert29\nGPU:29\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert30 [label="Layer5 Expert30\nGPU:30\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert31 [label="Layer5 Expert31\nGPU:31\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert32 [label="Layer5 Expert32\nGPU:32\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert33 [label="Layer5 Expert33\nGPU:33\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert34 [label="Layer5 Expert34\nGPU:34\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert35 [label="Layer5 Expert35\nGPU:35\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert36 [label="Layer5 Expert36\nGPU:36\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert37 [label="Layer5 Expert37\nGPU:37\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert38 [label="Layer5 Expert38\nGPU:38\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert39 [label="Layer5 Expert39\nGPU:39\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert40 [label="Layer5 Expert40\nGPU:40\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert41 [label="Layer5 Expert41\nGPU:41\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert42 [label="Layer5 Expert42\nGPU:42\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert43 [label="Layer5 Expert43\nGPU:43\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert44 [label="Layer5 Expert44\nGPU:44\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert45 [label="Layer5 Expert45\nGPU:45\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert46 [label="Layer5 Expert46\nGPU:46\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert47 [label="Layer5 Expert47\nGPU:47\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert48 [label="Layer5 Expert48\nGPU:48\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert49 [label="Layer5 Expert49\nGPU:49\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert50 [label="Layer5 Expert50\nGPU:50\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert51 [label="Layer5 Expert51\nGPU:51\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert52 [label="Layer5 Expert52\nGPU:52\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert53 [label="Layer5 Expert53\nGPU:53\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert54 [label="Layer5 Expert54\nGPU:54\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert55 [label="Layer5 Expert55\nGPU:55\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert56 [label="Layer5 Expert56\nGPU:56\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert57 [label="Layer5 Expert57\nGPU:57\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert58 [label="Layer5 Expert58\nGPU:58\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert59 [label="Layer5 Expert59\nGPU:59\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert60 [label="Layer5 Expert60\nGPU:60\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert61 [label="Layer5 Expert61\nGPU:61\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert62 [label="Layer5 Expert62\nGPU:62\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_expert63 [label="Layer5 Expert63\nGPU:63\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer5_combine [label="Layer5 Expert Combine\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer5_res1 [label="Layer5 Residual1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer5_ln1 [label="Layer5 LayerNorm1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer5_res2 [label="Layer5 Residual2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer5_ln2 [label="Layer5 LayerNorm2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer5_qkv_tp0 -> layer5_qkv_comm
	layer5_qkv_comm -> layer5_attn_out_tp0
	layer5_attn_out_tp0 -> layer5_attn_out_comm
	layer5_qkv_tp1 -> layer5_qkv_comm
	layer5_qkv_comm -> layer5_attn_out_tp1
	layer5_attn_out_tp1 -> layer5_attn_out_comm
	layer5_qkv_tp2 -> layer5_qkv_comm
	layer5_qkv_comm -> layer5_attn_out_tp2
	layer5_attn_out_tp2 -> layer5_attn_out_comm
	layer5_qkv_tp3 -> layer5_qkv_comm
	layer5_qkv_comm -> layer5_attn_out_tp3
	layer5_attn_out_tp3 -> layer5_attn_out_comm
	layer5_attn_out_comm -> layer5_res1
	layer4_ln2 -> layer5_res1
	layer5_res1 -> layer5_ln1
	layer5_ln1 -> layer5_gate
	layer5_gate -> layer5_dispatch
	layer5_dispatch -> layer5_expert0
	layer5_expert0 -> layer5_combine
	layer5_dispatch -> layer5_expert1
	layer5_expert1 -> layer5_combine
	layer5_dispatch -> layer5_expert2
	layer5_expert2 -> layer5_combine
	layer5_dispatch -> layer5_expert3
	layer5_expert3 -> layer5_combine
	layer5_dispatch -> layer5_expert4
	layer5_expert4 -> layer5_combine
	layer5_dispatch -> layer5_expert5
	layer5_expert5 -> layer5_combine
	layer5_dispatch -> layer5_expert6
	layer5_expert6 -> layer5_combine
	layer5_dispatch -> layer5_expert7
	layer5_expert7 -> layer5_combine
	layer5_dispatch -> layer5_expert8
	layer5_expert8 -> layer5_combine
	layer5_dispatch -> layer5_expert9
	layer5_expert9 -> layer5_combine
	layer5_dispatch -> layer5_expert10
	layer5_expert10 -> layer5_combine
	layer5_dispatch -> layer5_expert11
	layer5_expert11 -> layer5_combine
	layer5_dispatch -> layer5_expert12
	layer5_expert12 -> layer5_combine
	layer5_dispatch -> layer5_expert13
	layer5_expert13 -> layer5_combine
	layer5_dispatch -> layer5_expert14
	layer5_expert14 -> layer5_combine
	layer5_dispatch -> layer5_expert15
	layer5_expert15 -> layer5_combine
	layer5_dispatch -> layer5_expert16
	layer5_expert16 -> layer5_combine
	layer5_dispatch -> layer5_expert17
	layer5_expert17 -> layer5_combine
	layer5_dispatch -> layer5_expert18
	layer5_expert18 -> layer5_combine
	layer5_dispatch -> layer5_expert19
	layer5_expert19 -> layer5_combine
	layer5_dispatch -> layer5_expert20
	layer5_expert20 -> layer5_combine
	layer5_dispatch -> layer5_expert21
	layer5_expert21 -> layer5_combine
	layer5_dispatch -> layer5_expert22
	layer5_expert22 -> layer5_combine
	layer5_dispatch -> layer5_expert23
	layer5_expert23 -> layer5_combine
	layer5_dispatch -> layer5_expert24
	layer5_expert24 -> layer5_combine
	layer5_dispatch -> layer5_expert25
	layer5_expert25 -> layer5_combine
	layer5_dispatch -> layer5_expert26
	layer5_expert26 -> layer5_combine
	layer5_dispatch -> layer5_expert27
	layer5_expert27 -> layer5_combine
	layer5_dispatch -> layer5_expert28
	layer5_expert28 -> layer5_combine
	layer5_dispatch -> layer5_expert29
	layer5_expert29 -> layer5_combine
	layer5_dispatch -> layer5_expert30
	layer5_expert30 -> layer5_combine
	layer5_dispatch -> layer5_expert31
	layer5_expert31 -> layer5_combine
	layer5_dispatch -> layer5_expert32
	layer5_expert32 -> layer5_combine
	layer5_dispatch -> layer5_expert33
	layer5_expert33 -> layer5_combine
	layer5_dispatch -> layer5_expert34
	layer5_expert34 -> layer5_combine
	layer5_dispatch -> layer5_expert35
	layer5_expert35 -> layer5_combine
	layer5_dispatch -> layer5_expert36
	layer5_expert36 -> layer5_combine
	layer5_dispatch -> layer5_expert37
	layer5_expert37 -> layer5_combine
	layer5_dispatch -> layer5_expert38
	layer5_expert38 -> layer5_combine
	layer5_dispatch -> layer5_expert39
	layer5_expert39 -> layer5_combine
	layer5_dispatch -> layer5_expert40
	layer5_expert40 -> layer5_combine
	layer5_dispatch -> layer5_expert41
	layer5_expert41 -> layer5_combine
	layer5_dispatch -> layer5_expert42
	layer5_expert42 -> layer5_combine
	layer5_dispatch -> layer5_expert43
	layer5_expert43 -> layer5_combine
	layer5_dispatch -> layer5_expert44
	layer5_expert44 -> layer5_combine
	layer5_dispatch -> layer5_expert45
	layer5_expert45 -> layer5_combine
	layer5_dispatch -> layer5_expert46
	layer5_expert46 -> layer5_combine
	layer5_dispatch -> layer5_expert47
	layer5_expert47 -> layer5_combine
	layer5_dispatch -> layer5_expert48
	layer5_expert48 -> layer5_combine
	layer5_dispatch -> layer5_expert49
	layer5_expert49 -> layer5_combine
	layer5_dispatch -> layer5_expert50
	layer5_expert50 -> layer5_combine
	layer5_dispatch -> layer5_expert51
	layer5_expert51 -> layer5_combine
	layer5_dispatch -> layer5_expert52
	layer5_expert52 -> layer5_combine
	layer5_dispatch -> layer5_expert53
	layer5_expert53 -> layer5_combine
	layer5_dispatch -> layer5_expert54
	layer5_expert54 -> layer5_combine
	layer5_dispatch -> layer5_expert55
	layer5_expert55 -> layer5_combine
	layer5_dispatch -> layer5_expert56
	layer5_expert56 -> layer5_combine
	layer5_dispatch -> layer5_expert57
	layer5_expert57 -> layer5_combine
	layer5_dispatch -> layer5_expert58
	layer5_expert58 -> layer5_combine
	layer5_dispatch -> layer5_expert59
	layer5_expert59 -> layer5_combine
	layer5_dispatch -> layer5_expert60
	layer5_expert60 -> layer5_combine
	layer5_dispatch -> layer5_expert61
	layer5_expert61 -> layer5_combine
	layer5_dispatch -> layer5_expert62
	layer5_expert62 -> layer5_combine
	layer5_dispatch -> layer5_expert63
	layer5_expert63 -> layer5_combine
	layer5_combine -> layer5_res2
	layer5_ln1 -> layer5_res2
	layer5_res2 -> layer5_ln2
	layer6_qkv_tp0 [label="Layer6 QKV TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer6_attn_out_tp0 [label="Layer6 AttnOut TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer6_mlp1_tp0 [label="Layer6 MLP1 TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=512]" fillcolor=lightblue fontsize=8 shape=box]
	layer6_mlp2_tp0 [label="Layer6 MLP2 TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer6_qkv_tp1 [label="Layer6 QKV TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer6_attn_out_tp1 [label="Layer6 AttnOut TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer6_mlp1_tp1 [label="Layer6 MLP1 TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=512]" fillcolor=lightgreen fontsize=8 shape=box]
	layer6_mlp2_tp1 [label="Layer6 MLP2 TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer6_qkv_tp2 [label="Layer6 QKV TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer6_attn_out_tp2 [label="Layer6 AttnOut TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer6_mlp1_tp2 [label="Layer6 MLP1 TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=512]" fillcolor=lightyellow fontsize=8 shape=box]
	layer6_mlp2_tp2 [label="Layer6 MLP2 TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer6_qkv_tp3 [label="Layer6 QKV TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer6_attn_out_tp3 [label="Layer6 AttnOut TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer6_mlp1_tp3 [label="Layer6 MLP1 TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=512]" fillcolor=lightpink fontsize=8 shape=box]
	layer6_mlp2_tp3 [label="Layer6 MLP2 TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer6_qkv_comm [label="Layer6 QKV AllGather\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer6_attn_out_comm [label="Layer6 AttnOut AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer6_mlp_comm [label="Layer6 MLP AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer6_gate [label="Layer6 MoE Gate\nGPU:EP0-15\n[batch=128, seq=10240, experts=64]" fillcolor=lightgreen fontsize=8 shape=box]
	layer6_dispatch [label="Layer6 Expert Dispatch\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer6_expert0 [label="Layer6 Expert0\nGPU:0\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert1 [label="Layer6 Expert1\nGPU:1\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert2 [label="Layer6 Expert2\nGPU:2\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert3 [label="Layer6 Expert3\nGPU:3\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert4 [label="Layer6 Expert4\nGPU:4\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert5 [label="Layer6 Expert5\nGPU:5\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert6 [label="Layer6 Expert6\nGPU:6\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert7 [label="Layer6 Expert7\nGPU:7\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert8 [label="Layer6 Expert8\nGPU:8\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert9 [label="Layer6 Expert9\nGPU:9\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert10 [label="Layer6 Expert10\nGPU:10\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert11 [label="Layer6 Expert11\nGPU:11\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert12 [label="Layer6 Expert12\nGPU:12\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert13 [label="Layer6 Expert13\nGPU:13\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert14 [label="Layer6 Expert14\nGPU:14\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert15 [label="Layer6 Expert15\nGPU:15\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert16 [label="Layer6 Expert16\nGPU:16\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert17 [label="Layer6 Expert17\nGPU:17\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert18 [label="Layer6 Expert18\nGPU:18\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert19 [label="Layer6 Expert19\nGPU:19\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert20 [label="Layer6 Expert20\nGPU:20\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert21 [label="Layer6 Expert21\nGPU:21\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert22 [label="Layer6 Expert22\nGPU:22\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert23 [label="Layer6 Expert23\nGPU:23\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert24 [label="Layer6 Expert24\nGPU:24\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert25 [label="Layer6 Expert25\nGPU:25\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert26 [label="Layer6 Expert26\nGPU:26\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert27 [label="Layer6 Expert27\nGPU:27\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert28 [label="Layer6 Expert28\nGPU:28\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert29 [label="Layer6 Expert29\nGPU:29\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert30 [label="Layer6 Expert30\nGPU:30\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert31 [label="Layer6 Expert31\nGPU:31\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert32 [label="Layer6 Expert32\nGPU:32\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert33 [label="Layer6 Expert33\nGPU:33\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert34 [label="Layer6 Expert34\nGPU:34\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert35 [label="Layer6 Expert35\nGPU:35\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert36 [label="Layer6 Expert36\nGPU:36\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert37 [label="Layer6 Expert37\nGPU:37\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert38 [label="Layer6 Expert38\nGPU:38\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert39 [label="Layer6 Expert39\nGPU:39\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert40 [label="Layer6 Expert40\nGPU:40\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert41 [label="Layer6 Expert41\nGPU:41\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert42 [label="Layer6 Expert42\nGPU:42\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert43 [label="Layer6 Expert43\nGPU:43\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert44 [label="Layer6 Expert44\nGPU:44\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert45 [label="Layer6 Expert45\nGPU:45\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert46 [label="Layer6 Expert46\nGPU:46\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert47 [label="Layer6 Expert47\nGPU:47\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert48 [label="Layer6 Expert48\nGPU:48\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert49 [label="Layer6 Expert49\nGPU:49\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert50 [label="Layer6 Expert50\nGPU:50\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert51 [label="Layer6 Expert51\nGPU:51\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert52 [label="Layer6 Expert52\nGPU:52\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert53 [label="Layer6 Expert53\nGPU:53\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert54 [label="Layer6 Expert54\nGPU:54\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert55 [label="Layer6 Expert55\nGPU:55\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert56 [label="Layer6 Expert56\nGPU:56\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert57 [label="Layer6 Expert57\nGPU:57\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert58 [label="Layer6 Expert58\nGPU:58\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert59 [label="Layer6 Expert59\nGPU:59\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert60 [label="Layer6 Expert60\nGPU:60\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert61 [label="Layer6 Expert61\nGPU:61\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert62 [label="Layer6 Expert62\nGPU:62\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_expert63 [label="Layer6 Expert63\nGPU:63\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer6_combine [label="Layer6 Expert Combine\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer6_res1 [label="Layer6 Residual1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer6_ln1 [label="Layer6 LayerNorm1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer6_res2 [label="Layer6 Residual2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer6_ln2 [label="Layer6 LayerNorm2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer6_qkv_tp0 -> layer6_qkv_comm
	layer6_qkv_comm -> layer6_attn_out_tp0
	layer6_attn_out_tp0 -> layer6_attn_out_comm
	layer6_qkv_tp1 -> layer6_qkv_comm
	layer6_qkv_comm -> layer6_attn_out_tp1
	layer6_attn_out_tp1 -> layer6_attn_out_comm
	layer6_qkv_tp2 -> layer6_qkv_comm
	layer6_qkv_comm -> layer6_attn_out_tp2
	layer6_attn_out_tp2 -> layer6_attn_out_comm
	layer6_qkv_tp3 -> layer6_qkv_comm
	layer6_qkv_comm -> layer6_attn_out_tp3
	layer6_attn_out_tp3 -> layer6_attn_out_comm
	layer6_attn_out_comm -> layer6_res1
	layer5_ln2 -> layer6_res1
	layer6_res1 -> layer6_ln1
	layer6_ln1 -> layer6_gate
	layer6_gate -> layer6_dispatch
	layer6_dispatch -> layer6_expert0
	layer6_expert0 -> layer6_combine
	layer6_dispatch -> layer6_expert1
	layer6_expert1 -> layer6_combine
	layer6_dispatch -> layer6_expert2
	layer6_expert2 -> layer6_combine
	layer6_dispatch -> layer6_expert3
	layer6_expert3 -> layer6_combine
	layer6_dispatch -> layer6_expert4
	layer6_expert4 -> layer6_combine
	layer6_dispatch -> layer6_expert5
	layer6_expert5 -> layer6_combine
	layer6_dispatch -> layer6_expert6
	layer6_expert6 -> layer6_combine
	layer6_dispatch -> layer6_expert7
	layer6_expert7 -> layer6_combine
	layer6_dispatch -> layer6_expert8
	layer6_expert8 -> layer6_combine
	layer6_dispatch -> layer6_expert9
	layer6_expert9 -> layer6_combine
	layer6_dispatch -> layer6_expert10
	layer6_expert10 -> layer6_combine
	layer6_dispatch -> layer6_expert11
	layer6_expert11 -> layer6_combine
	layer6_dispatch -> layer6_expert12
	layer6_expert12 -> layer6_combine
	layer6_dispatch -> layer6_expert13
	layer6_expert13 -> layer6_combine
	layer6_dispatch -> layer6_expert14
	layer6_expert14 -> layer6_combine
	layer6_dispatch -> layer6_expert15
	layer6_expert15 -> layer6_combine
	layer6_dispatch -> layer6_expert16
	layer6_expert16 -> layer6_combine
	layer6_dispatch -> layer6_expert17
	layer6_expert17 -> layer6_combine
	layer6_dispatch -> layer6_expert18
	layer6_expert18 -> layer6_combine
	layer6_dispatch -> layer6_expert19
	layer6_expert19 -> layer6_combine
	layer6_dispatch -> layer6_expert20
	layer6_expert20 -> layer6_combine
	layer6_dispatch -> layer6_expert21
	layer6_expert21 -> layer6_combine
	layer6_dispatch -> layer6_expert22
	layer6_expert22 -> layer6_combine
	layer6_dispatch -> layer6_expert23
	layer6_expert23 -> layer6_combine
	layer6_dispatch -> layer6_expert24
	layer6_expert24 -> layer6_combine
	layer6_dispatch -> layer6_expert25
	layer6_expert25 -> layer6_combine
	layer6_dispatch -> layer6_expert26
	layer6_expert26 -> layer6_combine
	layer6_dispatch -> layer6_expert27
	layer6_expert27 -> layer6_combine
	layer6_dispatch -> layer6_expert28
	layer6_expert28 -> layer6_combine
	layer6_dispatch -> layer6_expert29
	layer6_expert29 -> layer6_combine
	layer6_dispatch -> layer6_expert30
	layer6_expert30 -> layer6_combine
	layer6_dispatch -> layer6_expert31
	layer6_expert31 -> layer6_combine
	layer6_dispatch -> layer6_expert32
	layer6_expert32 -> layer6_combine
	layer6_dispatch -> layer6_expert33
	layer6_expert33 -> layer6_combine
	layer6_dispatch -> layer6_expert34
	layer6_expert34 -> layer6_combine
	layer6_dispatch -> layer6_expert35
	layer6_expert35 -> layer6_combine
	layer6_dispatch -> layer6_expert36
	layer6_expert36 -> layer6_combine
	layer6_dispatch -> layer6_expert37
	layer6_expert37 -> layer6_combine
	layer6_dispatch -> layer6_expert38
	layer6_expert38 -> layer6_combine
	layer6_dispatch -> layer6_expert39
	layer6_expert39 -> layer6_combine
	layer6_dispatch -> layer6_expert40
	layer6_expert40 -> layer6_combine
	layer6_dispatch -> layer6_expert41
	layer6_expert41 -> layer6_combine
	layer6_dispatch -> layer6_expert42
	layer6_expert42 -> layer6_combine
	layer6_dispatch -> layer6_expert43
	layer6_expert43 -> layer6_combine
	layer6_dispatch -> layer6_expert44
	layer6_expert44 -> layer6_combine
	layer6_dispatch -> layer6_expert45
	layer6_expert45 -> layer6_combine
	layer6_dispatch -> layer6_expert46
	layer6_expert46 -> layer6_combine
	layer6_dispatch -> layer6_expert47
	layer6_expert47 -> layer6_combine
	layer6_dispatch -> layer6_expert48
	layer6_expert48 -> layer6_combine
	layer6_dispatch -> layer6_expert49
	layer6_expert49 -> layer6_combine
	layer6_dispatch -> layer6_expert50
	layer6_expert50 -> layer6_combine
	layer6_dispatch -> layer6_expert51
	layer6_expert51 -> layer6_combine
	layer6_dispatch -> layer6_expert52
	layer6_expert52 -> layer6_combine
	layer6_dispatch -> layer6_expert53
	layer6_expert53 -> layer6_combine
	layer6_dispatch -> layer6_expert54
	layer6_expert54 -> layer6_combine
	layer6_dispatch -> layer6_expert55
	layer6_expert55 -> layer6_combine
	layer6_dispatch -> layer6_expert56
	layer6_expert56 -> layer6_combine
	layer6_dispatch -> layer6_expert57
	layer6_expert57 -> layer6_combine
	layer6_dispatch -> layer6_expert58
	layer6_expert58 -> layer6_combine
	layer6_dispatch -> layer6_expert59
	layer6_expert59 -> layer6_combine
	layer6_dispatch -> layer6_expert60
	layer6_expert60 -> layer6_combine
	layer6_dispatch -> layer6_expert61
	layer6_expert61 -> layer6_combine
	layer6_dispatch -> layer6_expert62
	layer6_expert62 -> layer6_combine
	layer6_dispatch -> layer6_expert63
	layer6_expert63 -> layer6_combine
	layer6_combine -> layer6_res2
	layer6_ln1 -> layer6_res2
	layer6_res2 -> layer6_ln2
	layer7_qkv_tp0 [label="Layer7 QKV TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer7_attn_out_tp0 [label="Layer7 AttnOut TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer7_mlp1_tp0 [label="Layer7 MLP1 TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=512]" fillcolor=lightblue fontsize=8 shape=box]
	layer7_mlp2_tp0 [label="Layer7 MLP2 TP0\nGPU:0-15\n[batch=128, seq=10240, hidden=256]" fillcolor=lightblue fontsize=8 shape=box]
	layer7_qkv_tp1 [label="Layer7 QKV TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer7_attn_out_tp1 [label="Layer7 AttnOut TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer7_mlp1_tp1 [label="Layer7 MLP1 TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=512]" fillcolor=lightgreen fontsize=8 shape=box]
	layer7_mlp2_tp1 [label="Layer7 MLP2 TP1\nGPU:16-31\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgreen fontsize=8 shape=box]
	layer7_qkv_tp2 [label="Layer7 QKV TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer7_attn_out_tp2 [label="Layer7 AttnOut TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer7_mlp1_tp2 [label="Layer7 MLP1 TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=512]" fillcolor=lightyellow fontsize=8 shape=box]
	layer7_mlp2_tp2 [label="Layer7 MLP2 TP2\nGPU:32-47\n[batch=128, seq=10240, hidden=256]" fillcolor=lightyellow fontsize=8 shape=box]
	layer7_qkv_tp3 [label="Layer7 QKV TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer7_attn_out_tp3 [label="Layer7 AttnOut TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer7_mlp1_tp3 [label="Layer7 MLP1 TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=512]" fillcolor=lightpink fontsize=8 shape=box]
	layer7_mlp2_tp3 [label="Layer7 MLP2 TP3\nGPU:48-63\n[batch=128, seq=10240, hidden=256]" fillcolor=lightpink fontsize=8 shape=box]
	layer7_qkv_comm [label="Layer7 QKV AllGather\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer7_attn_out_comm [label="Layer7 AttnOut AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer7_mlp_comm [label="Layer7 MLP AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer7_gate [label="Layer7 MoE Gate\nGPU:EP0-15\n[batch=128, seq=10240, experts=64]" fillcolor=lightgreen fontsize=8 shape=box]
	layer7_dispatch [label="Layer7 Expert Dispatch\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer7_expert0 [label="Layer7 Expert0\nGPU:0\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert1 [label="Layer7 Expert1\nGPU:1\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert2 [label="Layer7 Expert2\nGPU:2\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert3 [label="Layer7 Expert3\nGPU:3\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert4 [label="Layer7 Expert4\nGPU:4\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert5 [label="Layer7 Expert5\nGPU:5\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert6 [label="Layer7 Expert6\nGPU:6\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert7 [label="Layer7 Expert7\nGPU:7\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert8 [label="Layer7 Expert8\nGPU:8\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert9 [label="Layer7 Expert9\nGPU:9\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert10 [label="Layer7 Expert10\nGPU:10\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert11 [label="Layer7 Expert11\nGPU:11\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert12 [label="Layer7 Expert12\nGPU:12\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert13 [label="Layer7 Expert13\nGPU:13\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert14 [label="Layer7 Expert14\nGPU:14\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert15 [label="Layer7 Expert15\nGPU:15\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert16 [label="Layer7 Expert16\nGPU:16\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert17 [label="Layer7 Expert17\nGPU:17\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert18 [label="Layer7 Expert18\nGPU:18\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert19 [label="Layer7 Expert19\nGPU:19\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert20 [label="Layer7 Expert20\nGPU:20\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert21 [label="Layer7 Expert21\nGPU:21\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert22 [label="Layer7 Expert22\nGPU:22\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert23 [label="Layer7 Expert23\nGPU:23\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert24 [label="Layer7 Expert24\nGPU:24\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert25 [label="Layer7 Expert25\nGPU:25\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert26 [label="Layer7 Expert26\nGPU:26\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert27 [label="Layer7 Expert27\nGPU:27\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert28 [label="Layer7 Expert28\nGPU:28\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert29 [label="Layer7 Expert29\nGPU:29\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert30 [label="Layer7 Expert30\nGPU:30\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert31 [label="Layer7 Expert31\nGPU:31\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert32 [label="Layer7 Expert32\nGPU:32\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert33 [label="Layer7 Expert33\nGPU:33\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert34 [label="Layer7 Expert34\nGPU:34\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert35 [label="Layer7 Expert35\nGPU:35\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert36 [label="Layer7 Expert36\nGPU:36\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert37 [label="Layer7 Expert37\nGPU:37\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert38 [label="Layer7 Expert38\nGPU:38\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert39 [label="Layer7 Expert39\nGPU:39\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert40 [label="Layer7 Expert40\nGPU:40\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert41 [label="Layer7 Expert41\nGPU:41\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert42 [label="Layer7 Expert42\nGPU:42\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert43 [label="Layer7 Expert43\nGPU:43\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert44 [label="Layer7 Expert44\nGPU:44\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert45 [label="Layer7 Expert45\nGPU:45\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert46 [label="Layer7 Expert46\nGPU:46\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert47 [label="Layer7 Expert47\nGPU:47\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert48 [label="Layer7 Expert48\nGPU:48\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert49 [label="Layer7 Expert49\nGPU:49\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert50 [label="Layer7 Expert50\nGPU:50\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert51 [label="Layer7 Expert51\nGPU:51\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert52 [label="Layer7 Expert52\nGPU:52\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert53 [label="Layer7 Expert53\nGPU:53\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert54 [label="Layer7 Expert54\nGPU:54\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert55 [label="Layer7 Expert55\nGPU:55\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert56 [label="Layer7 Expert56\nGPU:56\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert57 [label="Layer7 Expert57\nGPU:57\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert58 [label="Layer7 Expert58\nGPU:58\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert59 [label="Layer7 Expert59\nGPU:59\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert60 [label="Layer7 Expert60\nGPU:60\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert61 [label="Layer7 Expert61\nGPU:61\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert62 [label="Layer7 Expert62\nGPU:62\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_expert63 [label="Layer7 Expert63\nGPU:63\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer7_combine [label="Layer7 Expert Combine\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer7_res1 [label="Layer7 Residual1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer7_ln1 [label="Layer7 LayerNorm1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer7_res2 [label="Layer7 Residual2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer7_ln2 [label="Layer7 LayerNorm2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer7_qkv_tp0 -> layer7_qkv_comm
	layer7_qkv_comm -> layer7_attn_out_tp0
	layer7_attn_out_tp0 -> layer7_attn_out_comm
	layer7_qkv_tp1 -> layer7_qkv_comm
	layer7_qkv_comm -> layer7_attn_out_tp1
	layer7_attn_out_tp1 -> layer7_attn_out_comm
	layer7_qkv_tp2 -> layer7_qkv_comm
	layer7_qkv_comm -> layer7_attn_out_tp2
	layer7_attn_out_tp2 -> layer7_attn_out_comm
	layer7_qkv_tp3 -> layer7_qkv_comm
	layer7_qkv_comm -> layer7_attn_out_tp3
	layer7_attn_out_tp3 -> layer7_attn_out_comm
	layer7_attn_out_comm -> layer7_res1
	layer6_ln2 -> layer7_res1
	layer7_res1 -> layer7_ln1
	layer7_ln1 -> layer7_gate
	layer7_gate -> layer7_dispatch
	layer7_dispatch -> layer7_expert0
	layer7_expert0 -> layer7_combine
	layer7_dispatch -> layer7_expert1
	layer7_expert1 -> layer7_combine
	layer7_dispatch -> layer7_expert2
	layer7_expert2 -> layer7_combine
	layer7_dispatch -> layer7_expert3
	layer7_expert3 -> layer7_combine
	layer7_dispatch -> layer7_expert4
	layer7_expert4 -> layer7_combine
	layer7_dispatch -> layer7_expert5
	layer7_expert5 -> layer7_combine
	layer7_dispatch -> layer7_expert6
	layer7_expert6 -> layer7_combine
	layer7_dispatch -> layer7_expert7
	layer7_expert7 -> layer7_combine
	layer7_dispatch -> layer7_expert8
	layer7_expert8 -> layer7_combine
	layer7_dispatch -> layer7_expert9
	layer7_expert9 -> layer7_combine
	layer7_dispatch -> layer7_expert10
	layer7_expert10 -> layer7_combine
	layer7_dispatch -> layer7_expert11
	layer7_expert11 -> layer7_combine
	layer7_dispatch -> layer7_expert12
	layer7_expert12 -> layer7_combine
	layer7_dispatch -> layer7_expert13
	layer7_expert13 -> layer7_combine
	layer7_dispatch -> layer7_expert14
	layer7_expert14 -> layer7_combine
	layer7_dispatch -> layer7_expert15
	layer7_expert15 -> layer7_combine
	layer7_dispatch -> layer7_expert16
	layer7_expert16 -> layer7_combine
	layer7_dispatch -> layer7_expert17
	layer7_expert17 -> layer7_combine
	layer7_dispatch -> layer7_expert18
	layer7_expert18 -> layer7_combine
	layer7_dispatch -> layer7_expert19
	layer7_expert19 -> layer7_combine
	layer7_dispatch -> layer7_expert20
	layer7_expert20 -> layer7_combine
	layer7_dispatch -> layer7_expert21
	layer7_expert21 -> layer7_combine
	layer7_dispatch -> layer7_expert22
	layer7_expert22 -> layer7_combine
	layer7_dispatch -> layer7_expert23
	layer7_expert23 -> layer7_combine
	layer7_dispatch -> layer7_expert24
	layer7_expert24 -> layer7_combine
	layer7_dispatch -> layer7_expert25
	layer7_expert25 -> layer7_combine
	layer7_dispatch -> layer7_expert26
	layer7_expert26 -> layer7_combine
	layer7_dispatch -> layer7_expert27
	layer7_expert27 -> layer7_combine
	layer7_dispatch -> layer7_expert28
	layer7_expert28 -> layer7_combine
	layer7_dispatch -> layer7_expert29
	layer7_expert29 -> layer7_combine
	layer7_dispatch -> layer7_expert30
	layer7_expert30 -> layer7_combine
	layer7_dispatch -> layer7_expert31
	layer7_expert31 -> layer7_combine
	layer7_dispatch -> layer7_expert32
	layer7_expert32 -> layer7_combine
	layer7_dispatch -> layer7_expert33
	layer7_expert33 -> layer7_combine
	layer7_dispatch -> layer7_expert34
	layer7_expert34 -> layer7_combine
	layer7_dispatch -> layer7_expert35
	layer7_expert35 -> layer7_combine
	layer7_dispatch -> layer7_expert36
	layer7_expert36 -> layer7_combine
	layer7_dispatch -> layer7_expert37
	layer7_expert37 -> layer7_combine
	layer7_dispatch -> layer7_expert38
	layer7_expert38 -> layer7_combine
	layer7_dispatch -> layer7_expert39
	layer7_expert39 -> layer7_combine
	layer7_dispatch -> layer7_expert40
	layer7_expert40 -> layer7_combine
	layer7_dispatch -> layer7_expert41
	layer7_expert41 -> layer7_combine
	layer7_dispatch -> layer7_expert42
	layer7_expert42 -> layer7_combine
	layer7_dispatch -> layer7_expert43
	layer7_expert43 -> layer7_combine
	layer7_dispatch -> layer7_expert44
	layer7_expert44 -> layer7_combine
	layer7_dispatch -> layer7_expert45
	layer7_expert45 -> layer7_combine
	layer7_dispatch -> layer7_expert46
	layer7_expert46 -> layer7_combine
	layer7_dispatch -> layer7_expert47
	layer7_expert47 -> layer7_combine
	layer7_dispatch -> layer7_expert48
	layer7_expert48 -> layer7_combine
	layer7_dispatch -> layer7_expert49
	layer7_expert49 -> layer7_combine
	layer7_dispatch -> layer7_expert50
	layer7_expert50 -> layer7_combine
	layer7_dispatch -> layer7_expert51
	layer7_expert51 -> layer7_combine
	layer7_dispatch -> layer7_expert52
	layer7_expert52 -> layer7_combine
	layer7_dispatch -> layer7_expert53
	layer7_expert53 -> layer7_combine
	layer7_dispatch -> layer7_expert54
	layer7_expert54 -> layer7_combine
	layer7_dispatch -> layer7_expert55
	layer7_expert55 -> layer7_combine
	layer7_dispatch -> layer7_expert56
	layer7_expert56 -> layer7_combine
	layer7_dispatch -> layer7_expert57
	layer7_expert57 -> layer7_combine
	layer7_dispatch -> layer7_expert58
	layer7_expert58 -> layer7_combine
	layer7_dispatch -> layer7_expert59
	layer7_expert59 -> layer7_combine
	layer7_dispatch -> layer7_expert60
	layer7_expert60 -> layer7_combine
	layer7_dispatch -> layer7_expert61
	layer7_expert61 -> layer7_combine
	layer7_dispatch -> layer7_expert62
	layer7_expert62 -> layer7_combine
	layer7_dispatch -> layer7_expert63
	layer7_expert63 -> layer7_combine
	layer7_combine -> layer7_res2
	layer7_ln1 -> layer7_res2
	layer7_res2 -> layer7_ln2
	layer8_qkv_tp0 [label="Layer8 QKV TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer8_attn_out_tp0 [label="Layer8 AttnOut TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer8_mlp1_tp0 [label="Layer8 MLP1 TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=512]" fillcolor=lightcoral fontsize=8 shape=box]
	layer8_mlp2_tp0 [label="Layer8 MLP2 TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer8_qkv_tp1 [label="Layer8 QKV TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer8_attn_out_tp1 [label="Layer8 AttnOut TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer8_mlp1_tp1 [label="Layer8 MLP1 TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=512]" fillcolor=lightcyan fontsize=8 shape=box]
	layer8_mlp2_tp1 [label="Layer8 MLP2 TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer8_qkv_tp2 [label="Layer8 QKV TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer8_attn_out_tp2 [label="Layer8 AttnOut TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer8_mlp1_tp2 [label="Layer8 MLP1 TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=512]" fillcolor=lightgray fontsize=8 shape=box]
	layer8_mlp2_tp2 [label="Layer8 MLP2 TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer8_qkv_tp3 [label="Layer8 QKV TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer8_attn_out_tp3 [label="Layer8 AttnOut TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer8_mlp1_tp3 [label="Layer8 MLP1 TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=512]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer8_mlp2_tp3 [label="Layer8 MLP2 TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer8_qkv_comm [label="Layer8 QKV AllGather\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer8_attn_out_comm [label="Layer8 AttnOut AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer8_mlp_comm [label="Layer8 MLP AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer8_gate [label="Layer8 MoE Gate\nGPU:EP0-15\n[batch=128, seq=10240, experts=64]" fillcolor=lightgreen fontsize=8 shape=box]
	layer8_dispatch [label="Layer8 Expert Dispatch\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer8_expert0 [label="Layer8 Expert0\nGPU:64\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert1 [label="Layer8 Expert1\nGPU:65\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert2 [label="Layer8 Expert2\nGPU:66\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert3 [label="Layer8 Expert3\nGPU:67\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert4 [label="Layer8 Expert4\nGPU:68\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert5 [label="Layer8 Expert5\nGPU:69\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert6 [label="Layer8 Expert6\nGPU:70\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert7 [label="Layer8 Expert7\nGPU:71\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert8 [label="Layer8 Expert8\nGPU:72\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert9 [label="Layer8 Expert9\nGPU:73\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert10 [label="Layer8 Expert10\nGPU:74\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert11 [label="Layer8 Expert11\nGPU:75\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert12 [label="Layer8 Expert12\nGPU:76\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert13 [label="Layer8 Expert13\nGPU:77\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert14 [label="Layer8 Expert14\nGPU:78\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert15 [label="Layer8 Expert15\nGPU:79\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert16 [label="Layer8 Expert16\nGPU:80\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert17 [label="Layer8 Expert17\nGPU:81\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert18 [label="Layer8 Expert18\nGPU:82\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert19 [label="Layer8 Expert19\nGPU:83\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert20 [label="Layer8 Expert20\nGPU:84\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert21 [label="Layer8 Expert21\nGPU:85\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert22 [label="Layer8 Expert22\nGPU:86\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert23 [label="Layer8 Expert23\nGPU:87\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert24 [label="Layer8 Expert24\nGPU:88\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert25 [label="Layer8 Expert25\nGPU:89\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert26 [label="Layer8 Expert26\nGPU:90\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert27 [label="Layer8 Expert27\nGPU:91\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert28 [label="Layer8 Expert28\nGPU:92\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert29 [label="Layer8 Expert29\nGPU:93\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert30 [label="Layer8 Expert30\nGPU:94\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert31 [label="Layer8 Expert31\nGPU:95\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert32 [label="Layer8 Expert32\nGPU:96\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert33 [label="Layer8 Expert33\nGPU:97\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert34 [label="Layer8 Expert34\nGPU:98\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert35 [label="Layer8 Expert35\nGPU:99\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert36 [label="Layer8 Expert36\nGPU:100\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert37 [label="Layer8 Expert37\nGPU:101\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert38 [label="Layer8 Expert38\nGPU:102\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert39 [label="Layer8 Expert39\nGPU:103\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert40 [label="Layer8 Expert40\nGPU:104\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert41 [label="Layer8 Expert41\nGPU:105\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert42 [label="Layer8 Expert42\nGPU:106\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert43 [label="Layer8 Expert43\nGPU:107\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert44 [label="Layer8 Expert44\nGPU:108\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert45 [label="Layer8 Expert45\nGPU:109\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert46 [label="Layer8 Expert46\nGPU:110\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert47 [label="Layer8 Expert47\nGPU:111\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert48 [label="Layer8 Expert48\nGPU:112\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert49 [label="Layer8 Expert49\nGPU:113\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert50 [label="Layer8 Expert50\nGPU:114\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert51 [label="Layer8 Expert51\nGPU:115\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert52 [label="Layer8 Expert52\nGPU:116\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert53 [label="Layer8 Expert53\nGPU:117\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert54 [label="Layer8 Expert54\nGPU:118\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert55 [label="Layer8 Expert55\nGPU:119\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert56 [label="Layer8 Expert56\nGPU:120\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert57 [label="Layer8 Expert57\nGPU:121\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert58 [label="Layer8 Expert58\nGPU:122\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert59 [label="Layer8 Expert59\nGPU:123\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert60 [label="Layer8 Expert60\nGPU:124\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert61 [label="Layer8 Expert61\nGPU:125\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert62 [label="Layer8 Expert62\nGPU:126\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_expert63 [label="Layer8 Expert63\nGPU:127\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer8_combine [label="Layer8 Expert Combine\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer8_res1 [label="Layer8 Residual1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer8_ln1 [label="Layer8 LayerNorm1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer8_res2 [label="Layer8 Residual2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer8_ln2 [label="Layer8 LayerNorm2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer8_qkv_tp0 -> layer8_qkv_comm
	layer8_qkv_comm -> layer8_attn_out_tp0
	layer8_attn_out_tp0 -> layer8_attn_out_comm
	layer8_qkv_tp1 -> layer8_qkv_comm
	layer8_qkv_comm -> layer8_attn_out_tp1
	layer8_attn_out_tp1 -> layer8_attn_out_comm
	layer8_qkv_tp2 -> layer8_qkv_comm
	layer8_qkv_comm -> layer8_attn_out_tp2
	layer8_attn_out_tp2 -> layer8_attn_out_comm
	layer8_qkv_tp3 -> layer8_qkv_comm
	layer8_qkv_comm -> layer8_attn_out_tp3
	layer8_attn_out_tp3 -> layer8_attn_out_comm
	layer8_attn_out_comm -> layer8_res1
	layer7_ln2 -> layer8_res1
	layer8_res1 -> layer8_ln1
	layer8_ln1 -> layer8_gate
	layer8_gate -> layer8_dispatch
	layer8_dispatch -> layer8_expert0
	layer8_expert0 -> layer8_combine
	layer8_dispatch -> layer8_expert1
	layer8_expert1 -> layer8_combine
	layer8_dispatch -> layer8_expert2
	layer8_expert2 -> layer8_combine
	layer8_dispatch -> layer8_expert3
	layer8_expert3 -> layer8_combine
	layer8_dispatch -> layer8_expert4
	layer8_expert4 -> layer8_combine
	layer8_dispatch -> layer8_expert5
	layer8_expert5 -> layer8_combine
	layer8_dispatch -> layer8_expert6
	layer8_expert6 -> layer8_combine
	layer8_dispatch -> layer8_expert7
	layer8_expert7 -> layer8_combine
	layer8_dispatch -> layer8_expert8
	layer8_expert8 -> layer8_combine
	layer8_dispatch -> layer8_expert9
	layer8_expert9 -> layer8_combine
	layer8_dispatch -> layer8_expert10
	layer8_expert10 -> layer8_combine
	layer8_dispatch -> layer8_expert11
	layer8_expert11 -> layer8_combine
	layer8_dispatch -> layer8_expert12
	layer8_expert12 -> layer8_combine
	layer8_dispatch -> layer8_expert13
	layer8_expert13 -> layer8_combine
	layer8_dispatch -> layer8_expert14
	layer8_expert14 -> layer8_combine
	layer8_dispatch -> layer8_expert15
	layer8_expert15 -> layer8_combine
	layer8_dispatch -> layer8_expert16
	layer8_expert16 -> layer8_combine
	layer8_dispatch -> layer8_expert17
	layer8_expert17 -> layer8_combine
	layer8_dispatch -> layer8_expert18
	layer8_expert18 -> layer8_combine
	layer8_dispatch -> layer8_expert19
	layer8_expert19 -> layer8_combine
	layer8_dispatch -> layer8_expert20
	layer8_expert20 -> layer8_combine
	layer8_dispatch -> layer8_expert21
	layer8_expert21 -> layer8_combine
	layer8_dispatch -> layer8_expert22
	layer8_expert22 -> layer8_combine
	layer8_dispatch -> layer8_expert23
	layer8_expert23 -> layer8_combine
	layer8_dispatch -> layer8_expert24
	layer8_expert24 -> layer8_combine
	layer8_dispatch -> layer8_expert25
	layer8_expert25 -> layer8_combine
	layer8_dispatch -> layer8_expert26
	layer8_expert26 -> layer8_combine
	layer8_dispatch -> layer8_expert27
	layer8_expert27 -> layer8_combine
	layer8_dispatch -> layer8_expert28
	layer8_expert28 -> layer8_combine
	layer8_dispatch -> layer8_expert29
	layer8_expert29 -> layer8_combine
	layer8_dispatch -> layer8_expert30
	layer8_expert30 -> layer8_combine
	layer8_dispatch -> layer8_expert31
	layer8_expert31 -> layer8_combine
	layer8_dispatch -> layer8_expert32
	layer8_expert32 -> layer8_combine
	layer8_dispatch -> layer8_expert33
	layer8_expert33 -> layer8_combine
	layer8_dispatch -> layer8_expert34
	layer8_expert34 -> layer8_combine
	layer8_dispatch -> layer8_expert35
	layer8_expert35 -> layer8_combine
	layer8_dispatch -> layer8_expert36
	layer8_expert36 -> layer8_combine
	layer8_dispatch -> layer8_expert37
	layer8_expert37 -> layer8_combine
	layer8_dispatch -> layer8_expert38
	layer8_expert38 -> layer8_combine
	layer8_dispatch -> layer8_expert39
	layer8_expert39 -> layer8_combine
	layer8_dispatch -> layer8_expert40
	layer8_expert40 -> layer8_combine
	layer8_dispatch -> layer8_expert41
	layer8_expert41 -> layer8_combine
	layer8_dispatch -> layer8_expert42
	layer8_expert42 -> layer8_combine
	layer8_dispatch -> layer8_expert43
	layer8_expert43 -> layer8_combine
	layer8_dispatch -> layer8_expert44
	layer8_expert44 -> layer8_combine
	layer8_dispatch -> layer8_expert45
	layer8_expert45 -> layer8_combine
	layer8_dispatch -> layer8_expert46
	layer8_expert46 -> layer8_combine
	layer8_dispatch -> layer8_expert47
	layer8_expert47 -> layer8_combine
	layer8_dispatch -> layer8_expert48
	layer8_expert48 -> layer8_combine
	layer8_dispatch -> layer8_expert49
	layer8_expert49 -> layer8_combine
	layer8_dispatch -> layer8_expert50
	layer8_expert50 -> layer8_combine
	layer8_dispatch -> layer8_expert51
	layer8_expert51 -> layer8_combine
	layer8_dispatch -> layer8_expert52
	layer8_expert52 -> layer8_combine
	layer8_dispatch -> layer8_expert53
	layer8_expert53 -> layer8_combine
	layer8_dispatch -> layer8_expert54
	layer8_expert54 -> layer8_combine
	layer8_dispatch -> layer8_expert55
	layer8_expert55 -> layer8_combine
	layer8_dispatch -> layer8_expert56
	layer8_expert56 -> layer8_combine
	layer8_dispatch -> layer8_expert57
	layer8_expert57 -> layer8_combine
	layer8_dispatch -> layer8_expert58
	layer8_expert58 -> layer8_combine
	layer8_dispatch -> layer8_expert59
	layer8_expert59 -> layer8_combine
	layer8_dispatch -> layer8_expert60
	layer8_expert60 -> layer8_combine
	layer8_dispatch -> layer8_expert61
	layer8_expert61 -> layer8_combine
	layer8_dispatch -> layer8_expert62
	layer8_expert62 -> layer8_combine
	layer8_dispatch -> layer8_expert63
	layer8_expert63 -> layer8_combine
	layer8_combine -> layer8_res2
	layer8_ln1 -> layer8_res2
	layer8_res2 -> layer8_ln2
	layer9_qkv_tp0 [label="Layer9 QKV TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer9_attn_out_tp0 [label="Layer9 AttnOut TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer9_mlp1_tp0 [label="Layer9 MLP1 TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=512]" fillcolor=lightcoral fontsize=8 shape=box]
	layer9_mlp2_tp0 [label="Layer9 MLP2 TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer9_qkv_tp1 [label="Layer9 QKV TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer9_attn_out_tp1 [label="Layer9 AttnOut TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer9_mlp1_tp1 [label="Layer9 MLP1 TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=512]" fillcolor=lightcyan fontsize=8 shape=box]
	layer9_mlp2_tp1 [label="Layer9 MLP2 TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer9_qkv_tp2 [label="Layer9 QKV TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer9_attn_out_tp2 [label="Layer9 AttnOut TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer9_mlp1_tp2 [label="Layer9 MLP1 TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=512]" fillcolor=lightgray fontsize=8 shape=box]
	layer9_mlp2_tp2 [label="Layer9 MLP2 TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer9_qkv_tp3 [label="Layer9 QKV TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer9_attn_out_tp3 [label="Layer9 AttnOut TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer9_mlp1_tp3 [label="Layer9 MLP1 TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=512]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer9_mlp2_tp3 [label="Layer9 MLP2 TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer9_qkv_comm [label="Layer9 QKV AllGather\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer9_attn_out_comm [label="Layer9 AttnOut AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer9_mlp_comm [label="Layer9 MLP AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer9_gate [label="Layer9 MoE Gate\nGPU:EP0-15\n[batch=128, seq=10240, experts=64]" fillcolor=lightgreen fontsize=8 shape=box]
	layer9_dispatch [label="Layer9 Expert Dispatch\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer9_expert0 [label="Layer9 Expert0\nGPU:64\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert1 [label="Layer9 Expert1\nGPU:65\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert2 [label="Layer9 Expert2\nGPU:66\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert3 [label="Layer9 Expert3\nGPU:67\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert4 [label="Layer9 Expert4\nGPU:68\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert5 [label="Layer9 Expert5\nGPU:69\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert6 [label="Layer9 Expert6\nGPU:70\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert7 [label="Layer9 Expert7\nGPU:71\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert8 [label="Layer9 Expert8\nGPU:72\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert9 [label="Layer9 Expert9\nGPU:73\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert10 [label="Layer9 Expert10\nGPU:74\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert11 [label="Layer9 Expert11\nGPU:75\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert12 [label="Layer9 Expert12\nGPU:76\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert13 [label="Layer9 Expert13\nGPU:77\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert14 [label="Layer9 Expert14\nGPU:78\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert15 [label="Layer9 Expert15\nGPU:79\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert16 [label="Layer9 Expert16\nGPU:80\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert17 [label="Layer9 Expert17\nGPU:81\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert18 [label="Layer9 Expert18\nGPU:82\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert19 [label="Layer9 Expert19\nGPU:83\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert20 [label="Layer9 Expert20\nGPU:84\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert21 [label="Layer9 Expert21\nGPU:85\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert22 [label="Layer9 Expert22\nGPU:86\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert23 [label="Layer9 Expert23\nGPU:87\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert24 [label="Layer9 Expert24\nGPU:88\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert25 [label="Layer9 Expert25\nGPU:89\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert26 [label="Layer9 Expert26\nGPU:90\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert27 [label="Layer9 Expert27\nGPU:91\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert28 [label="Layer9 Expert28\nGPU:92\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert29 [label="Layer9 Expert29\nGPU:93\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert30 [label="Layer9 Expert30\nGPU:94\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert31 [label="Layer9 Expert31\nGPU:95\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert32 [label="Layer9 Expert32\nGPU:96\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert33 [label="Layer9 Expert33\nGPU:97\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert34 [label="Layer9 Expert34\nGPU:98\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert35 [label="Layer9 Expert35\nGPU:99\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert36 [label="Layer9 Expert36\nGPU:100\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert37 [label="Layer9 Expert37\nGPU:101\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert38 [label="Layer9 Expert38\nGPU:102\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert39 [label="Layer9 Expert39\nGPU:103\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert40 [label="Layer9 Expert40\nGPU:104\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert41 [label="Layer9 Expert41\nGPU:105\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert42 [label="Layer9 Expert42\nGPU:106\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert43 [label="Layer9 Expert43\nGPU:107\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert44 [label="Layer9 Expert44\nGPU:108\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert45 [label="Layer9 Expert45\nGPU:109\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert46 [label="Layer9 Expert46\nGPU:110\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert47 [label="Layer9 Expert47\nGPU:111\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert48 [label="Layer9 Expert48\nGPU:112\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert49 [label="Layer9 Expert49\nGPU:113\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert50 [label="Layer9 Expert50\nGPU:114\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert51 [label="Layer9 Expert51\nGPU:115\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert52 [label="Layer9 Expert52\nGPU:116\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert53 [label="Layer9 Expert53\nGPU:117\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert54 [label="Layer9 Expert54\nGPU:118\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert55 [label="Layer9 Expert55\nGPU:119\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert56 [label="Layer9 Expert56\nGPU:120\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert57 [label="Layer9 Expert57\nGPU:121\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert58 [label="Layer9 Expert58\nGPU:122\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert59 [label="Layer9 Expert59\nGPU:123\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert60 [label="Layer9 Expert60\nGPU:124\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert61 [label="Layer9 Expert61\nGPU:125\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert62 [label="Layer9 Expert62\nGPU:126\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_expert63 [label="Layer9 Expert63\nGPU:127\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer9_combine [label="Layer9 Expert Combine\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer9_res1 [label="Layer9 Residual1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer9_ln1 [label="Layer9 LayerNorm1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer9_res2 [label="Layer9 Residual2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer9_ln2 [label="Layer9 LayerNorm2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer9_qkv_tp0 -> layer9_qkv_comm
	layer9_qkv_comm -> layer9_attn_out_tp0
	layer9_attn_out_tp0 -> layer9_attn_out_comm
	layer9_qkv_tp1 -> layer9_qkv_comm
	layer9_qkv_comm -> layer9_attn_out_tp1
	layer9_attn_out_tp1 -> layer9_attn_out_comm
	layer9_qkv_tp2 -> layer9_qkv_comm
	layer9_qkv_comm -> layer9_attn_out_tp2
	layer9_attn_out_tp2 -> layer9_attn_out_comm
	layer9_qkv_tp3 -> layer9_qkv_comm
	layer9_qkv_comm -> layer9_attn_out_tp3
	layer9_attn_out_tp3 -> layer9_attn_out_comm
	layer9_attn_out_comm -> layer9_res1
	layer8_ln2 -> layer9_res1
	layer9_res1 -> layer9_ln1
	layer9_ln1 -> layer9_gate
	layer9_gate -> layer9_dispatch
	layer9_dispatch -> layer9_expert0
	layer9_expert0 -> layer9_combine
	layer9_dispatch -> layer9_expert1
	layer9_expert1 -> layer9_combine
	layer9_dispatch -> layer9_expert2
	layer9_expert2 -> layer9_combine
	layer9_dispatch -> layer9_expert3
	layer9_expert3 -> layer9_combine
	layer9_dispatch -> layer9_expert4
	layer9_expert4 -> layer9_combine
	layer9_dispatch -> layer9_expert5
	layer9_expert5 -> layer9_combine
	layer9_dispatch -> layer9_expert6
	layer9_expert6 -> layer9_combine
	layer9_dispatch -> layer9_expert7
	layer9_expert7 -> layer9_combine
	layer9_dispatch -> layer9_expert8
	layer9_expert8 -> layer9_combine
	layer9_dispatch -> layer9_expert9
	layer9_expert9 -> layer9_combine
	layer9_dispatch -> layer9_expert10
	layer9_expert10 -> layer9_combine
	layer9_dispatch -> layer9_expert11
	layer9_expert11 -> layer9_combine
	layer9_dispatch -> layer9_expert12
	layer9_expert12 -> layer9_combine
	layer9_dispatch -> layer9_expert13
	layer9_expert13 -> layer9_combine
	layer9_dispatch -> layer9_expert14
	layer9_expert14 -> layer9_combine
	layer9_dispatch -> layer9_expert15
	layer9_expert15 -> layer9_combine
	layer9_dispatch -> layer9_expert16
	layer9_expert16 -> layer9_combine
	layer9_dispatch -> layer9_expert17
	layer9_expert17 -> layer9_combine
	layer9_dispatch -> layer9_expert18
	layer9_expert18 -> layer9_combine
	layer9_dispatch -> layer9_expert19
	layer9_expert19 -> layer9_combine
	layer9_dispatch -> layer9_expert20
	layer9_expert20 -> layer9_combine
	layer9_dispatch -> layer9_expert21
	layer9_expert21 -> layer9_combine
	layer9_dispatch -> layer9_expert22
	layer9_expert22 -> layer9_combine
	layer9_dispatch -> layer9_expert23
	layer9_expert23 -> layer9_combine
	layer9_dispatch -> layer9_expert24
	layer9_expert24 -> layer9_combine
	layer9_dispatch -> layer9_expert25
	layer9_expert25 -> layer9_combine
	layer9_dispatch -> layer9_expert26
	layer9_expert26 -> layer9_combine
	layer9_dispatch -> layer9_expert27
	layer9_expert27 -> layer9_combine
	layer9_dispatch -> layer9_expert28
	layer9_expert28 -> layer9_combine
	layer9_dispatch -> layer9_expert29
	layer9_expert29 -> layer9_combine
	layer9_dispatch -> layer9_expert30
	layer9_expert30 -> layer9_combine
	layer9_dispatch -> layer9_expert31
	layer9_expert31 -> layer9_combine
	layer9_dispatch -> layer9_expert32
	layer9_expert32 -> layer9_combine
	layer9_dispatch -> layer9_expert33
	layer9_expert33 -> layer9_combine
	layer9_dispatch -> layer9_expert34
	layer9_expert34 -> layer9_combine
	layer9_dispatch -> layer9_expert35
	layer9_expert35 -> layer9_combine
	layer9_dispatch -> layer9_expert36
	layer9_expert36 -> layer9_combine
	layer9_dispatch -> layer9_expert37
	layer9_expert37 -> layer9_combine
	layer9_dispatch -> layer9_expert38
	layer9_expert38 -> layer9_combine
	layer9_dispatch -> layer9_expert39
	layer9_expert39 -> layer9_combine
	layer9_dispatch -> layer9_expert40
	layer9_expert40 -> layer9_combine
	layer9_dispatch -> layer9_expert41
	layer9_expert41 -> layer9_combine
	layer9_dispatch -> layer9_expert42
	layer9_expert42 -> layer9_combine
	layer9_dispatch -> layer9_expert43
	layer9_expert43 -> layer9_combine
	layer9_dispatch -> layer9_expert44
	layer9_expert44 -> layer9_combine
	layer9_dispatch -> layer9_expert45
	layer9_expert45 -> layer9_combine
	layer9_dispatch -> layer9_expert46
	layer9_expert46 -> layer9_combine
	layer9_dispatch -> layer9_expert47
	layer9_expert47 -> layer9_combine
	layer9_dispatch -> layer9_expert48
	layer9_expert48 -> layer9_combine
	layer9_dispatch -> layer9_expert49
	layer9_expert49 -> layer9_combine
	layer9_dispatch -> layer9_expert50
	layer9_expert50 -> layer9_combine
	layer9_dispatch -> layer9_expert51
	layer9_expert51 -> layer9_combine
	layer9_dispatch -> layer9_expert52
	layer9_expert52 -> layer9_combine
	layer9_dispatch -> layer9_expert53
	layer9_expert53 -> layer9_combine
	layer9_dispatch -> layer9_expert54
	layer9_expert54 -> layer9_combine
	layer9_dispatch -> layer9_expert55
	layer9_expert55 -> layer9_combine
	layer9_dispatch -> layer9_expert56
	layer9_expert56 -> layer9_combine
	layer9_dispatch -> layer9_expert57
	layer9_expert57 -> layer9_combine
	layer9_dispatch -> layer9_expert58
	layer9_expert58 -> layer9_combine
	layer9_dispatch -> layer9_expert59
	layer9_expert59 -> layer9_combine
	layer9_dispatch -> layer9_expert60
	layer9_expert60 -> layer9_combine
	layer9_dispatch -> layer9_expert61
	layer9_expert61 -> layer9_combine
	layer9_dispatch -> layer9_expert62
	layer9_expert62 -> layer9_combine
	layer9_dispatch -> layer9_expert63
	layer9_expert63 -> layer9_combine
	layer9_combine -> layer9_res2
	layer9_ln1 -> layer9_res2
	layer9_res2 -> layer9_ln2
	layer10_qkv_tp0 [label="Layer10 QKV TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer10_attn_out_tp0 [label="Layer10 AttnOut TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer10_mlp1_tp0 [label="Layer10 MLP1 TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=512]" fillcolor=lightcoral fontsize=8 shape=box]
	layer10_mlp2_tp0 [label="Layer10 MLP2 TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer10_qkv_tp1 [label="Layer10 QKV TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer10_attn_out_tp1 [label="Layer10 AttnOut TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer10_mlp1_tp1 [label="Layer10 MLP1 TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=512]" fillcolor=lightcyan fontsize=8 shape=box]
	layer10_mlp2_tp1 [label="Layer10 MLP2 TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer10_qkv_tp2 [label="Layer10 QKV TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer10_attn_out_tp2 [label="Layer10 AttnOut TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer10_mlp1_tp2 [label="Layer10 MLP1 TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=512]" fillcolor=lightgray fontsize=8 shape=box]
	layer10_mlp2_tp2 [label="Layer10 MLP2 TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer10_qkv_tp3 [label="Layer10 QKV TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer10_attn_out_tp3 [label="Layer10 AttnOut TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer10_mlp1_tp3 [label="Layer10 MLP1 TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=512]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer10_mlp2_tp3 [label="Layer10 MLP2 TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer10_qkv_comm [label="Layer10 QKV AllGather\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer10_attn_out_comm [label="Layer10 AttnOut AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer10_mlp_comm [label="Layer10 MLP AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer10_gate [label="Layer10 MoE Gate\nGPU:EP0-15\n[batch=128, seq=10240, experts=64]" fillcolor=lightgreen fontsize=8 shape=box]
	layer10_dispatch [label="Layer10 Expert Dispatch\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer10_expert0 [label="Layer10 Expert0\nGPU:64\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert1 [label="Layer10 Expert1\nGPU:65\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert2 [label="Layer10 Expert2\nGPU:66\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert3 [label="Layer10 Expert3\nGPU:67\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert4 [label="Layer10 Expert4\nGPU:68\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert5 [label="Layer10 Expert5\nGPU:69\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert6 [label="Layer10 Expert6\nGPU:70\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert7 [label="Layer10 Expert7\nGPU:71\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert8 [label="Layer10 Expert8\nGPU:72\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert9 [label="Layer10 Expert9\nGPU:73\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert10 [label="Layer10 Expert10\nGPU:74\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert11 [label="Layer10 Expert11\nGPU:75\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert12 [label="Layer10 Expert12\nGPU:76\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert13 [label="Layer10 Expert13\nGPU:77\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert14 [label="Layer10 Expert14\nGPU:78\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert15 [label="Layer10 Expert15\nGPU:79\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert16 [label="Layer10 Expert16\nGPU:80\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert17 [label="Layer10 Expert17\nGPU:81\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert18 [label="Layer10 Expert18\nGPU:82\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert19 [label="Layer10 Expert19\nGPU:83\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert20 [label="Layer10 Expert20\nGPU:84\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert21 [label="Layer10 Expert21\nGPU:85\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert22 [label="Layer10 Expert22\nGPU:86\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert23 [label="Layer10 Expert23\nGPU:87\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert24 [label="Layer10 Expert24\nGPU:88\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert25 [label="Layer10 Expert25\nGPU:89\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert26 [label="Layer10 Expert26\nGPU:90\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert27 [label="Layer10 Expert27\nGPU:91\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert28 [label="Layer10 Expert28\nGPU:92\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert29 [label="Layer10 Expert29\nGPU:93\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert30 [label="Layer10 Expert30\nGPU:94\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert31 [label="Layer10 Expert31\nGPU:95\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert32 [label="Layer10 Expert32\nGPU:96\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert33 [label="Layer10 Expert33\nGPU:97\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert34 [label="Layer10 Expert34\nGPU:98\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert35 [label="Layer10 Expert35\nGPU:99\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert36 [label="Layer10 Expert36\nGPU:100\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert37 [label="Layer10 Expert37\nGPU:101\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert38 [label="Layer10 Expert38\nGPU:102\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert39 [label="Layer10 Expert39\nGPU:103\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert40 [label="Layer10 Expert40\nGPU:104\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert41 [label="Layer10 Expert41\nGPU:105\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert42 [label="Layer10 Expert42\nGPU:106\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert43 [label="Layer10 Expert43\nGPU:107\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert44 [label="Layer10 Expert44\nGPU:108\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert45 [label="Layer10 Expert45\nGPU:109\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert46 [label="Layer10 Expert46\nGPU:110\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert47 [label="Layer10 Expert47\nGPU:111\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert48 [label="Layer10 Expert48\nGPU:112\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert49 [label="Layer10 Expert49\nGPU:113\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert50 [label="Layer10 Expert50\nGPU:114\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert51 [label="Layer10 Expert51\nGPU:115\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert52 [label="Layer10 Expert52\nGPU:116\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert53 [label="Layer10 Expert53\nGPU:117\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert54 [label="Layer10 Expert54\nGPU:118\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert55 [label="Layer10 Expert55\nGPU:119\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert56 [label="Layer10 Expert56\nGPU:120\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert57 [label="Layer10 Expert57\nGPU:121\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert58 [label="Layer10 Expert58\nGPU:122\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert59 [label="Layer10 Expert59\nGPU:123\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert60 [label="Layer10 Expert60\nGPU:124\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert61 [label="Layer10 Expert61\nGPU:125\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert62 [label="Layer10 Expert62\nGPU:126\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_expert63 [label="Layer10 Expert63\nGPU:127\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer10_combine [label="Layer10 Expert Combine\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer10_res1 [label="Layer10 Residual1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer10_ln1 [label="Layer10 LayerNorm1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer10_res2 [label="Layer10 Residual2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer10_ln2 [label="Layer10 LayerNorm2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer10_qkv_tp0 -> layer10_qkv_comm
	layer10_qkv_comm -> layer10_attn_out_tp0
	layer10_attn_out_tp0 -> layer10_attn_out_comm
	layer10_qkv_tp1 -> layer10_qkv_comm
	layer10_qkv_comm -> layer10_attn_out_tp1
	layer10_attn_out_tp1 -> layer10_attn_out_comm
	layer10_qkv_tp2 -> layer10_qkv_comm
	layer10_qkv_comm -> layer10_attn_out_tp2
	layer10_attn_out_tp2 -> layer10_attn_out_comm
	layer10_qkv_tp3 -> layer10_qkv_comm
	layer10_qkv_comm -> layer10_attn_out_tp3
	layer10_attn_out_tp3 -> layer10_attn_out_comm
	layer10_attn_out_comm -> layer10_res1
	layer9_ln2 -> layer10_res1
	layer10_res1 -> layer10_ln1
	layer10_ln1 -> layer10_gate
	layer10_gate -> layer10_dispatch
	layer10_dispatch -> layer10_expert0
	layer10_expert0 -> layer10_combine
	layer10_dispatch -> layer10_expert1
	layer10_expert1 -> layer10_combine
	layer10_dispatch -> layer10_expert2
	layer10_expert2 -> layer10_combine
	layer10_dispatch -> layer10_expert3
	layer10_expert3 -> layer10_combine
	layer10_dispatch -> layer10_expert4
	layer10_expert4 -> layer10_combine
	layer10_dispatch -> layer10_expert5
	layer10_expert5 -> layer10_combine
	layer10_dispatch -> layer10_expert6
	layer10_expert6 -> layer10_combine
	layer10_dispatch -> layer10_expert7
	layer10_expert7 -> layer10_combine
	layer10_dispatch -> layer10_expert8
	layer10_expert8 -> layer10_combine
	layer10_dispatch -> layer10_expert9
	layer10_expert9 -> layer10_combine
	layer10_dispatch -> layer10_expert10
	layer10_expert10 -> layer10_combine
	layer10_dispatch -> layer10_expert11
	layer10_expert11 -> layer10_combine
	layer10_dispatch -> layer10_expert12
	layer10_expert12 -> layer10_combine
	layer10_dispatch -> layer10_expert13
	layer10_expert13 -> layer10_combine
	layer10_dispatch -> layer10_expert14
	layer10_expert14 -> layer10_combine
	layer10_dispatch -> layer10_expert15
	layer10_expert15 -> layer10_combine
	layer10_dispatch -> layer10_expert16
	layer10_expert16 -> layer10_combine
	layer10_dispatch -> layer10_expert17
	layer10_expert17 -> layer10_combine
	layer10_dispatch -> layer10_expert18
	layer10_expert18 -> layer10_combine
	layer10_dispatch -> layer10_expert19
	layer10_expert19 -> layer10_combine
	layer10_dispatch -> layer10_expert20
	layer10_expert20 -> layer10_combine
	layer10_dispatch -> layer10_expert21
	layer10_expert21 -> layer10_combine
	layer10_dispatch -> layer10_expert22
	layer10_expert22 -> layer10_combine
	layer10_dispatch -> layer10_expert23
	layer10_expert23 -> layer10_combine
	layer10_dispatch -> layer10_expert24
	layer10_expert24 -> layer10_combine
	layer10_dispatch -> layer10_expert25
	layer10_expert25 -> layer10_combine
	layer10_dispatch -> layer10_expert26
	layer10_expert26 -> layer10_combine
	layer10_dispatch -> layer10_expert27
	layer10_expert27 -> layer10_combine
	layer10_dispatch -> layer10_expert28
	layer10_expert28 -> layer10_combine
	layer10_dispatch -> layer10_expert29
	layer10_expert29 -> layer10_combine
	layer10_dispatch -> layer10_expert30
	layer10_expert30 -> layer10_combine
	layer10_dispatch -> layer10_expert31
	layer10_expert31 -> layer10_combine
	layer10_dispatch -> layer10_expert32
	layer10_expert32 -> layer10_combine
	layer10_dispatch -> layer10_expert33
	layer10_expert33 -> layer10_combine
	layer10_dispatch -> layer10_expert34
	layer10_expert34 -> layer10_combine
	layer10_dispatch -> layer10_expert35
	layer10_expert35 -> layer10_combine
	layer10_dispatch -> layer10_expert36
	layer10_expert36 -> layer10_combine
	layer10_dispatch -> layer10_expert37
	layer10_expert37 -> layer10_combine
	layer10_dispatch -> layer10_expert38
	layer10_expert38 -> layer10_combine
	layer10_dispatch -> layer10_expert39
	layer10_expert39 -> layer10_combine
	layer10_dispatch -> layer10_expert40
	layer10_expert40 -> layer10_combine
	layer10_dispatch -> layer10_expert41
	layer10_expert41 -> layer10_combine
	layer10_dispatch -> layer10_expert42
	layer10_expert42 -> layer10_combine
	layer10_dispatch -> layer10_expert43
	layer10_expert43 -> layer10_combine
	layer10_dispatch -> layer10_expert44
	layer10_expert44 -> layer10_combine
	layer10_dispatch -> layer10_expert45
	layer10_expert45 -> layer10_combine
	layer10_dispatch -> layer10_expert46
	layer10_expert46 -> layer10_combine
	layer10_dispatch -> layer10_expert47
	layer10_expert47 -> layer10_combine
	layer10_dispatch -> layer10_expert48
	layer10_expert48 -> layer10_combine
	layer10_dispatch -> layer10_expert49
	layer10_expert49 -> layer10_combine
	layer10_dispatch -> layer10_expert50
	layer10_expert50 -> layer10_combine
	layer10_dispatch -> layer10_expert51
	layer10_expert51 -> layer10_combine
	layer10_dispatch -> layer10_expert52
	layer10_expert52 -> layer10_combine
	layer10_dispatch -> layer10_expert53
	layer10_expert53 -> layer10_combine
	layer10_dispatch -> layer10_expert54
	layer10_expert54 -> layer10_combine
	layer10_dispatch -> layer10_expert55
	layer10_expert55 -> layer10_combine
	layer10_dispatch -> layer10_expert56
	layer10_expert56 -> layer10_combine
	layer10_dispatch -> layer10_expert57
	layer10_expert57 -> layer10_combine
	layer10_dispatch -> layer10_expert58
	layer10_expert58 -> layer10_combine
	layer10_dispatch -> layer10_expert59
	layer10_expert59 -> layer10_combine
	layer10_dispatch -> layer10_expert60
	layer10_expert60 -> layer10_combine
	layer10_dispatch -> layer10_expert61
	layer10_expert61 -> layer10_combine
	layer10_dispatch -> layer10_expert62
	layer10_expert62 -> layer10_combine
	layer10_dispatch -> layer10_expert63
	layer10_expert63 -> layer10_combine
	layer10_combine -> layer10_res2
	layer10_ln1 -> layer10_res2
	layer10_res2 -> layer10_ln2
	layer11_qkv_tp0 [label="Layer11 QKV TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer11_attn_out_tp0 [label="Layer11 AttnOut TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer11_mlp1_tp0 [label="Layer11 MLP1 TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=512]" fillcolor=lightcoral fontsize=8 shape=box]
	layer11_mlp2_tp0 [label="Layer11 MLP2 TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer11_qkv_tp1 [label="Layer11 QKV TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer11_attn_out_tp1 [label="Layer11 AttnOut TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer11_mlp1_tp1 [label="Layer11 MLP1 TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=512]" fillcolor=lightcyan fontsize=8 shape=box]
	layer11_mlp2_tp1 [label="Layer11 MLP2 TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer11_qkv_tp2 [label="Layer11 QKV TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer11_attn_out_tp2 [label="Layer11 AttnOut TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer11_mlp1_tp2 [label="Layer11 MLP1 TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=512]" fillcolor=lightgray fontsize=8 shape=box]
	layer11_mlp2_tp2 [label="Layer11 MLP2 TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer11_qkv_tp3 [label="Layer11 QKV TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer11_attn_out_tp3 [label="Layer11 AttnOut TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer11_mlp1_tp3 [label="Layer11 MLP1 TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=512]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer11_mlp2_tp3 [label="Layer11 MLP2 TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer11_qkv_comm [label="Layer11 QKV AllGather\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer11_attn_out_comm [label="Layer11 AttnOut AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer11_mlp_comm [label="Layer11 MLP AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer11_gate [label="Layer11 MoE Gate\nGPU:EP0-15\n[batch=128, seq=10240, experts=64]" fillcolor=lightgreen fontsize=8 shape=box]
	layer11_dispatch [label="Layer11 Expert Dispatch\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer11_expert0 [label="Layer11 Expert0\nGPU:64\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert1 [label="Layer11 Expert1\nGPU:65\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert2 [label="Layer11 Expert2\nGPU:66\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert3 [label="Layer11 Expert3\nGPU:67\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert4 [label="Layer11 Expert4\nGPU:68\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert5 [label="Layer11 Expert5\nGPU:69\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert6 [label="Layer11 Expert6\nGPU:70\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert7 [label="Layer11 Expert7\nGPU:71\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert8 [label="Layer11 Expert8\nGPU:72\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert9 [label="Layer11 Expert9\nGPU:73\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert10 [label="Layer11 Expert10\nGPU:74\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert11 [label="Layer11 Expert11\nGPU:75\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert12 [label="Layer11 Expert12\nGPU:76\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert13 [label="Layer11 Expert13\nGPU:77\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert14 [label="Layer11 Expert14\nGPU:78\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert15 [label="Layer11 Expert15\nGPU:79\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert16 [label="Layer11 Expert16\nGPU:80\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert17 [label="Layer11 Expert17\nGPU:81\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert18 [label="Layer11 Expert18\nGPU:82\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert19 [label="Layer11 Expert19\nGPU:83\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert20 [label="Layer11 Expert20\nGPU:84\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert21 [label="Layer11 Expert21\nGPU:85\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert22 [label="Layer11 Expert22\nGPU:86\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert23 [label="Layer11 Expert23\nGPU:87\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert24 [label="Layer11 Expert24\nGPU:88\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert25 [label="Layer11 Expert25\nGPU:89\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert26 [label="Layer11 Expert26\nGPU:90\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert27 [label="Layer11 Expert27\nGPU:91\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert28 [label="Layer11 Expert28\nGPU:92\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert29 [label="Layer11 Expert29\nGPU:93\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert30 [label="Layer11 Expert30\nGPU:94\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert31 [label="Layer11 Expert31\nGPU:95\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert32 [label="Layer11 Expert32\nGPU:96\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert33 [label="Layer11 Expert33\nGPU:97\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert34 [label="Layer11 Expert34\nGPU:98\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert35 [label="Layer11 Expert35\nGPU:99\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert36 [label="Layer11 Expert36\nGPU:100\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert37 [label="Layer11 Expert37\nGPU:101\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert38 [label="Layer11 Expert38\nGPU:102\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert39 [label="Layer11 Expert39\nGPU:103\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert40 [label="Layer11 Expert40\nGPU:104\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert41 [label="Layer11 Expert41\nGPU:105\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert42 [label="Layer11 Expert42\nGPU:106\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert43 [label="Layer11 Expert43\nGPU:107\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert44 [label="Layer11 Expert44\nGPU:108\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert45 [label="Layer11 Expert45\nGPU:109\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert46 [label="Layer11 Expert46\nGPU:110\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert47 [label="Layer11 Expert47\nGPU:111\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert48 [label="Layer11 Expert48\nGPU:112\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert49 [label="Layer11 Expert49\nGPU:113\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert50 [label="Layer11 Expert50\nGPU:114\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert51 [label="Layer11 Expert51\nGPU:115\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert52 [label="Layer11 Expert52\nGPU:116\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert53 [label="Layer11 Expert53\nGPU:117\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert54 [label="Layer11 Expert54\nGPU:118\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert55 [label="Layer11 Expert55\nGPU:119\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert56 [label="Layer11 Expert56\nGPU:120\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert57 [label="Layer11 Expert57\nGPU:121\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert58 [label="Layer11 Expert58\nGPU:122\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert59 [label="Layer11 Expert59\nGPU:123\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert60 [label="Layer11 Expert60\nGPU:124\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert61 [label="Layer11 Expert61\nGPU:125\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert62 [label="Layer11 Expert62\nGPU:126\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_expert63 [label="Layer11 Expert63\nGPU:127\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer11_combine [label="Layer11 Expert Combine\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer11_res1 [label="Layer11 Residual1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer11_ln1 [label="Layer11 LayerNorm1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer11_res2 [label="Layer11 Residual2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer11_ln2 [label="Layer11 LayerNorm2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer11_qkv_tp0 -> layer11_qkv_comm
	layer11_qkv_comm -> layer11_attn_out_tp0
	layer11_attn_out_tp0 -> layer11_attn_out_comm
	layer11_qkv_tp1 -> layer11_qkv_comm
	layer11_qkv_comm -> layer11_attn_out_tp1
	layer11_attn_out_tp1 -> layer11_attn_out_comm
	layer11_qkv_tp2 -> layer11_qkv_comm
	layer11_qkv_comm -> layer11_attn_out_tp2
	layer11_attn_out_tp2 -> layer11_attn_out_comm
	layer11_qkv_tp3 -> layer11_qkv_comm
	layer11_qkv_comm -> layer11_attn_out_tp3
	layer11_attn_out_tp3 -> layer11_attn_out_comm
	layer11_attn_out_comm -> layer11_res1
	layer10_ln2 -> layer11_res1
	layer11_res1 -> layer11_ln1
	layer11_ln1 -> layer11_gate
	layer11_gate -> layer11_dispatch
	layer11_dispatch -> layer11_expert0
	layer11_expert0 -> layer11_combine
	layer11_dispatch -> layer11_expert1
	layer11_expert1 -> layer11_combine
	layer11_dispatch -> layer11_expert2
	layer11_expert2 -> layer11_combine
	layer11_dispatch -> layer11_expert3
	layer11_expert3 -> layer11_combine
	layer11_dispatch -> layer11_expert4
	layer11_expert4 -> layer11_combine
	layer11_dispatch -> layer11_expert5
	layer11_expert5 -> layer11_combine
	layer11_dispatch -> layer11_expert6
	layer11_expert6 -> layer11_combine
	layer11_dispatch -> layer11_expert7
	layer11_expert7 -> layer11_combine
	layer11_dispatch -> layer11_expert8
	layer11_expert8 -> layer11_combine
	layer11_dispatch -> layer11_expert9
	layer11_expert9 -> layer11_combine
	layer11_dispatch -> layer11_expert10
	layer11_expert10 -> layer11_combine
	layer11_dispatch -> layer11_expert11
	layer11_expert11 -> layer11_combine
	layer11_dispatch -> layer11_expert12
	layer11_expert12 -> layer11_combine
	layer11_dispatch -> layer11_expert13
	layer11_expert13 -> layer11_combine
	layer11_dispatch -> layer11_expert14
	layer11_expert14 -> layer11_combine
	layer11_dispatch -> layer11_expert15
	layer11_expert15 -> layer11_combine
	layer11_dispatch -> layer11_expert16
	layer11_expert16 -> layer11_combine
	layer11_dispatch -> layer11_expert17
	layer11_expert17 -> layer11_combine
	layer11_dispatch -> layer11_expert18
	layer11_expert18 -> layer11_combine
	layer11_dispatch -> layer11_expert19
	layer11_expert19 -> layer11_combine
	layer11_dispatch -> layer11_expert20
	layer11_expert20 -> layer11_combine
	layer11_dispatch -> layer11_expert21
	layer11_expert21 -> layer11_combine
	layer11_dispatch -> layer11_expert22
	layer11_expert22 -> layer11_combine
	layer11_dispatch -> layer11_expert23
	layer11_expert23 -> layer11_combine
	layer11_dispatch -> layer11_expert24
	layer11_expert24 -> layer11_combine
	layer11_dispatch -> layer11_expert25
	layer11_expert25 -> layer11_combine
	layer11_dispatch -> layer11_expert26
	layer11_expert26 -> layer11_combine
	layer11_dispatch -> layer11_expert27
	layer11_expert27 -> layer11_combine
	layer11_dispatch -> layer11_expert28
	layer11_expert28 -> layer11_combine
	layer11_dispatch -> layer11_expert29
	layer11_expert29 -> layer11_combine
	layer11_dispatch -> layer11_expert30
	layer11_expert30 -> layer11_combine
	layer11_dispatch -> layer11_expert31
	layer11_expert31 -> layer11_combine
	layer11_dispatch -> layer11_expert32
	layer11_expert32 -> layer11_combine
	layer11_dispatch -> layer11_expert33
	layer11_expert33 -> layer11_combine
	layer11_dispatch -> layer11_expert34
	layer11_expert34 -> layer11_combine
	layer11_dispatch -> layer11_expert35
	layer11_expert35 -> layer11_combine
	layer11_dispatch -> layer11_expert36
	layer11_expert36 -> layer11_combine
	layer11_dispatch -> layer11_expert37
	layer11_expert37 -> layer11_combine
	layer11_dispatch -> layer11_expert38
	layer11_expert38 -> layer11_combine
	layer11_dispatch -> layer11_expert39
	layer11_expert39 -> layer11_combine
	layer11_dispatch -> layer11_expert40
	layer11_expert40 -> layer11_combine
	layer11_dispatch -> layer11_expert41
	layer11_expert41 -> layer11_combine
	layer11_dispatch -> layer11_expert42
	layer11_expert42 -> layer11_combine
	layer11_dispatch -> layer11_expert43
	layer11_expert43 -> layer11_combine
	layer11_dispatch -> layer11_expert44
	layer11_expert44 -> layer11_combine
	layer11_dispatch -> layer11_expert45
	layer11_expert45 -> layer11_combine
	layer11_dispatch -> layer11_expert46
	layer11_expert46 -> layer11_combine
	layer11_dispatch -> layer11_expert47
	layer11_expert47 -> layer11_combine
	layer11_dispatch -> layer11_expert48
	layer11_expert48 -> layer11_combine
	layer11_dispatch -> layer11_expert49
	layer11_expert49 -> layer11_combine
	layer11_dispatch -> layer11_expert50
	layer11_expert50 -> layer11_combine
	layer11_dispatch -> layer11_expert51
	layer11_expert51 -> layer11_combine
	layer11_dispatch -> layer11_expert52
	layer11_expert52 -> layer11_combine
	layer11_dispatch -> layer11_expert53
	layer11_expert53 -> layer11_combine
	layer11_dispatch -> layer11_expert54
	layer11_expert54 -> layer11_combine
	layer11_dispatch -> layer11_expert55
	layer11_expert55 -> layer11_combine
	layer11_dispatch -> layer11_expert56
	layer11_expert56 -> layer11_combine
	layer11_dispatch -> layer11_expert57
	layer11_expert57 -> layer11_combine
	layer11_dispatch -> layer11_expert58
	layer11_expert58 -> layer11_combine
	layer11_dispatch -> layer11_expert59
	layer11_expert59 -> layer11_combine
	layer11_dispatch -> layer11_expert60
	layer11_expert60 -> layer11_combine
	layer11_dispatch -> layer11_expert61
	layer11_expert61 -> layer11_combine
	layer11_dispatch -> layer11_expert62
	layer11_expert62 -> layer11_combine
	layer11_dispatch -> layer11_expert63
	layer11_expert63 -> layer11_combine
	layer11_combine -> layer11_res2
	layer11_ln1 -> layer11_res2
	layer11_res2 -> layer11_ln2
	layer12_qkv_tp0 [label="Layer12 QKV TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer12_attn_out_tp0 [label="Layer12 AttnOut TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer12_mlp1_tp0 [label="Layer12 MLP1 TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=512]" fillcolor=lightcoral fontsize=8 shape=box]
	layer12_mlp2_tp0 [label="Layer12 MLP2 TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer12_qkv_tp1 [label="Layer12 QKV TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer12_attn_out_tp1 [label="Layer12 AttnOut TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer12_mlp1_tp1 [label="Layer12 MLP1 TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=512]" fillcolor=lightcyan fontsize=8 shape=box]
	layer12_mlp2_tp1 [label="Layer12 MLP2 TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer12_qkv_tp2 [label="Layer12 QKV TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer12_attn_out_tp2 [label="Layer12 AttnOut TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer12_mlp1_tp2 [label="Layer12 MLP1 TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=512]" fillcolor=lightgray fontsize=8 shape=box]
	layer12_mlp2_tp2 [label="Layer12 MLP2 TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer12_qkv_tp3 [label="Layer12 QKV TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer12_attn_out_tp3 [label="Layer12 AttnOut TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer12_mlp1_tp3 [label="Layer12 MLP1 TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=512]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer12_mlp2_tp3 [label="Layer12 MLP2 TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer12_qkv_comm [label="Layer12 QKV AllGather\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer12_attn_out_comm [label="Layer12 AttnOut AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer12_mlp_comm [label="Layer12 MLP AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer12_gate [label="Layer12 MoE Gate\nGPU:EP0-15\n[batch=128, seq=10240, experts=64]" fillcolor=lightgreen fontsize=8 shape=box]
	layer12_dispatch [label="Layer12 Expert Dispatch\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer12_expert0 [label="Layer12 Expert0\nGPU:64\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert1 [label="Layer12 Expert1\nGPU:65\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert2 [label="Layer12 Expert2\nGPU:66\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert3 [label="Layer12 Expert3\nGPU:67\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert4 [label="Layer12 Expert4\nGPU:68\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert5 [label="Layer12 Expert5\nGPU:69\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert6 [label="Layer12 Expert6\nGPU:70\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert7 [label="Layer12 Expert7\nGPU:71\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert8 [label="Layer12 Expert8\nGPU:72\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert9 [label="Layer12 Expert9\nGPU:73\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert10 [label="Layer12 Expert10\nGPU:74\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert11 [label="Layer12 Expert11\nGPU:75\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert12 [label="Layer12 Expert12\nGPU:76\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert13 [label="Layer12 Expert13\nGPU:77\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert14 [label="Layer12 Expert14\nGPU:78\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert15 [label="Layer12 Expert15\nGPU:79\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert16 [label="Layer12 Expert16\nGPU:80\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert17 [label="Layer12 Expert17\nGPU:81\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert18 [label="Layer12 Expert18\nGPU:82\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert19 [label="Layer12 Expert19\nGPU:83\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert20 [label="Layer12 Expert20\nGPU:84\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert21 [label="Layer12 Expert21\nGPU:85\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert22 [label="Layer12 Expert22\nGPU:86\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert23 [label="Layer12 Expert23\nGPU:87\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert24 [label="Layer12 Expert24\nGPU:88\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert25 [label="Layer12 Expert25\nGPU:89\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert26 [label="Layer12 Expert26\nGPU:90\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert27 [label="Layer12 Expert27\nGPU:91\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert28 [label="Layer12 Expert28\nGPU:92\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert29 [label="Layer12 Expert29\nGPU:93\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert30 [label="Layer12 Expert30\nGPU:94\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert31 [label="Layer12 Expert31\nGPU:95\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert32 [label="Layer12 Expert32\nGPU:96\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert33 [label="Layer12 Expert33\nGPU:97\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert34 [label="Layer12 Expert34\nGPU:98\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert35 [label="Layer12 Expert35\nGPU:99\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert36 [label="Layer12 Expert36\nGPU:100\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert37 [label="Layer12 Expert37\nGPU:101\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert38 [label="Layer12 Expert38\nGPU:102\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert39 [label="Layer12 Expert39\nGPU:103\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert40 [label="Layer12 Expert40\nGPU:104\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert41 [label="Layer12 Expert41\nGPU:105\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert42 [label="Layer12 Expert42\nGPU:106\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert43 [label="Layer12 Expert43\nGPU:107\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert44 [label="Layer12 Expert44\nGPU:108\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert45 [label="Layer12 Expert45\nGPU:109\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert46 [label="Layer12 Expert46\nGPU:110\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert47 [label="Layer12 Expert47\nGPU:111\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert48 [label="Layer12 Expert48\nGPU:112\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert49 [label="Layer12 Expert49\nGPU:113\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert50 [label="Layer12 Expert50\nGPU:114\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert51 [label="Layer12 Expert51\nGPU:115\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert52 [label="Layer12 Expert52\nGPU:116\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert53 [label="Layer12 Expert53\nGPU:117\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert54 [label="Layer12 Expert54\nGPU:118\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert55 [label="Layer12 Expert55\nGPU:119\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert56 [label="Layer12 Expert56\nGPU:120\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert57 [label="Layer12 Expert57\nGPU:121\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert58 [label="Layer12 Expert58\nGPU:122\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert59 [label="Layer12 Expert59\nGPU:123\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert60 [label="Layer12 Expert60\nGPU:124\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert61 [label="Layer12 Expert61\nGPU:125\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert62 [label="Layer12 Expert62\nGPU:126\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_expert63 [label="Layer12 Expert63\nGPU:127\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer12_combine [label="Layer12 Expert Combine\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer12_res1 [label="Layer12 Residual1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer12_ln1 [label="Layer12 LayerNorm1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer12_res2 [label="Layer12 Residual2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer12_ln2 [label="Layer12 LayerNorm2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer12_qkv_tp0 -> layer12_qkv_comm
	layer12_qkv_comm -> layer12_attn_out_tp0
	layer12_attn_out_tp0 -> layer12_attn_out_comm
	layer12_qkv_tp1 -> layer12_qkv_comm
	layer12_qkv_comm -> layer12_attn_out_tp1
	layer12_attn_out_tp1 -> layer12_attn_out_comm
	layer12_qkv_tp2 -> layer12_qkv_comm
	layer12_qkv_comm -> layer12_attn_out_tp2
	layer12_attn_out_tp2 -> layer12_attn_out_comm
	layer12_qkv_tp3 -> layer12_qkv_comm
	layer12_qkv_comm -> layer12_attn_out_tp3
	layer12_attn_out_tp3 -> layer12_attn_out_comm
	layer12_attn_out_comm -> layer12_res1
	layer11_ln2 -> layer12_res1
	layer12_res1 -> layer12_ln1
	layer12_ln1 -> layer12_gate
	layer12_gate -> layer12_dispatch
	layer12_dispatch -> layer12_expert0
	layer12_expert0 -> layer12_combine
	layer12_dispatch -> layer12_expert1
	layer12_expert1 -> layer12_combine
	layer12_dispatch -> layer12_expert2
	layer12_expert2 -> layer12_combine
	layer12_dispatch -> layer12_expert3
	layer12_expert3 -> layer12_combine
	layer12_dispatch -> layer12_expert4
	layer12_expert4 -> layer12_combine
	layer12_dispatch -> layer12_expert5
	layer12_expert5 -> layer12_combine
	layer12_dispatch -> layer12_expert6
	layer12_expert6 -> layer12_combine
	layer12_dispatch -> layer12_expert7
	layer12_expert7 -> layer12_combine
	layer12_dispatch -> layer12_expert8
	layer12_expert8 -> layer12_combine
	layer12_dispatch -> layer12_expert9
	layer12_expert9 -> layer12_combine
	layer12_dispatch -> layer12_expert10
	layer12_expert10 -> layer12_combine
	layer12_dispatch -> layer12_expert11
	layer12_expert11 -> layer12_combine
	layer12_dispatch -> layer12_expert12
	layer12_expert12 -> layer12_combine
	layer12_dispatch -> layer12_expert13
	layer12_expert13 -> layer12_combine
	layer12_dispatch -> layer12_expert14
	layer12_expert14 -> layer12_combine
	layer12_dispatch -> layer12_expert15
	layer12_expert15 -> layer12_combine
	layer12_dispatch -> layer12_expert16
	layer12_expert16 -> layer12_combine
	layer12_dispatch -> layer12_expert17
	layer12_expert17 -> layer12_combine
	layer12_dispatch -> layer12_expert18
	layer12_expert18 -> layer12_combine
	layer12_dispatch -> layer12_expert19
	layer12_expert19 -> layer12_combine
	layer12_dispatch -> layer12_expert20
	layer12_expert20 -> layer12_combine
	layer12_dispatch -> layer12_expert21
	layer12_expert21 -> layer12_combine
	layer12_dispatch -> layer12_expert22
	layer12_expert22 -> layer12_combine
	layer12_dispatch -> layer12_expert23
	layer12_expert23 -> layer12_combine
	layer12_dispatch -> layer12_expert24
	layer12_expert24 -> layer12_combine
	layer12_dispatch -> layer12_expert25
	layer12_expert25 -> layer12_combine
	layer12_dispatch -> layer12_expert26
	layer12_expert26 -> layer12_combine
	layer12_dispatch -> layer12_expert27
	layer12_expert27 -> layer12_combine
	layer12_dispatch -> layer12_expert28
	layer12_expert28 -> layer12_combine
	layer12_dispatch -> layer12_expert29
	layer12_expert29 -> layer12_combine
	layer12_dispatch -> layer12_expert30
	layer12_expert30 -> layer12_combine
	layer12_dispatch -> layer12_expert31
	layer12_expert31 -> layer12_combine
	layer12_dispatch -> layer12_expert32
	layer12_expert32 -> layer12_combine
	layer12_dispatch -> layer12_expert33
	layer12_expert33 -> layer12_combine
	layer12_dispatch -> layer12_expert34
	layer12_expert34 -> layer12_combine
	layer12_dispatch -> layer12_expert35
	layer12_expert35 -> layer12_combine
	layer12_dispatch -> layer12_expert36
	layer12_expert36 -> layer12_combine
	layer12_dispatch -> layer12_expert37
	layer12_expert37 -> layer12_combine
	layer12_dispatch -> layer12_expert38
	layer12_expert38 -> layer12_combine
	layer12_dispatch -> layer12_expert39
	layer12_expert39 -> layer12_combine
	layer12_dispatch -> layer12_expert40
	layer12_expert40 -> layer12_combine
	layer12_dispatch -> layer12_expert41
	layer12_expert41 -> layer12_combine
	layer12_dispatch -> layer12_expert42
	layer12_expert42 -> layer12_combine
	layer12_dispatch -> layer12_expert43
	layer12_expert43 -> layer12_combine
	layer12_dispatch -> layer12_expert44
	layer12_expert44 -> layer12_combine
	layer12_dispatch -> layer12_expert45
	layer12_expert45 -> layer12_combine
	layer12_dispatch -> layer12_expert46
	layer12_expert46 -> layer12_combine
	layer12_dispatch -> layer12_expert47
	layer12_expert47 -> layer12_combine
	layer12_dispatch -> layer12_expert48
	layer12_expert48 -> layer12_combine
	layer12_dispatch -> layer12_expert49
	layer12_expert49 -> layer12_combine
	layer12_dispatch -> layer12_expert50
	layer12_expert50 -> layer12_combine
	layer12_dispatch -> layer12_expert51
	layer12_expert51 -> layer12_combine
	layer12_dispatch -> layer12_expert52
	layer12_expert52 -> layer12_combine
	layer12_dispatch -> layer12_expert53
	layer12_expert53 -> layer12_combine
	layer12_dispatch -> layer12_expert54
	layer12_expert54 -> layer12_combine
	layer12_dispatch -> layer12_expert55
	layer12_expert55 -> layer12_combine
	layer12_dispatch -> layer12_expert56
	layer12_expert56 -> layer12_combine
	layer12_dispatch -> layer12_expert57
	layer12_expert57 -> layer12_combine
	layer12_dispatch -> layer12_expert58
	layer12_expert58 -> layer12_combine
	layer12_dispatch -> layer12_expert59
	layer12_expert59 -> layer12_combine
	layer12_dispatch -> layer12_expert60
	layer12_expert60 -> layer12_combine
	layer12_dispatch -> layer12_expert61
	layer12_expert61 -> layer12_combine
	layer12_dispatch -> layer12_expert62
	layer12_expert62 -> layer12_combine
	layer12_dispatch -> layer12_expert63
	layer12_expert63 -> layer12_combine
	layer12_combine -> layer12_res2
	layer12_ln1 -> layer12_res2
	layer12_res2 -> layer12_ln2
	layer13_qkv_tp0 [label="Layer13 QKV TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer13_attn_out_tp0 [label="Layer13 AttnOut TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer13_mlp1_tp0 [label="Layer13 MLP1 TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=512]" fillcolor=lightcoral fontsize=8 shape=box]
	layer13_mlp2_tp0 [label="Layer13 MLP2 TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer13_qkv_tp1 [label="Layer13 QKV TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer13_attn_out_tp1 [label="Layer13 AttnOut TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer13_mlp1_tp1 [label="Layer13 MLP1 TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=512]" fillcolor=lightcyan fontsize=8 shape=box]
	layer13_mlp2_tp1 [label="Layer13 MLP2 TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer13_qkv_tp2 [label="Layer13 QKV TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer13_attn_out_tp2 [label="Layer13 AttnOut TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer13_mlp1_tp2 [label="Layer13 MLP1 TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=512]" fillcolor=lightgray fontsize=8 shape=box]
	layer13_mlp2_tp2 [label="Layer13 MLP2 TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer13_qkv_tp3 [label="Layer13 QKV TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer13_attn_out_tp3 [label="Layer13 AttnOut TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer13_mlp1_tp3 [label="Layer13 MLP1 TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=512]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer13_mlp2_tp3 [label="Layer13 MLP2 TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer13_qkv_comm [label="Layer13 QKV AllGather\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer13_attn_out_comm [label="Layer13 AttnOut AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer13_mlp_comm [label="Layer13 MLP AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer13_gate [label="Layer13 MoE Gate\nGPU:EP0-15\n[batch=128, seq=10240, experts=64]" fillcolor=lightgreen fontsize=8 shape=box]
	layer13_dispatch [label="Layer13 Expert Dispatch\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer13_expert0 [label="Layer13 Expert0\nGPU:64\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert1 [label="Layer13 Expert1\nGPU:65\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert2 [label="Layer13 Expert2\nGPU:66\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert3 [label="Layer13 Expert3\nGPU:67\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert4 [label="Layer13 Expert4\nGPU:68\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert5 [label="Layer13 Expert5\nGPU:69\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert6 [label="Layer13 Expert6\nGPU:70\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert7 [label="Layer13 Expert7\nGPU:71\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert8 [label="Layer13 Expert8\nGPU:72\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert9 [label="Layer13 Expert9\nGPU:73\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert10 [label="Layer13 Expert10\nGPU:74\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert11 [label="Layer13 Expert11\nGPU:75\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert12 [label="Layer13 Expert12\nGPU:76\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert13 [label="Layer13 Expert13\nGPU:77\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert14 [label="Layer13 Expert14\nGPU:78\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert15 [label="Layer13 Expert15\nGPU:79\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert16 [label="Layer13 Expert16\nGPU:80\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert17 [label="Layer13 Expert17\nGPU:81\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert18 [label="Layer13 Expert18\nGPU:82\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert19 [label="Layer13 Expert19\nGPU:83\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert20 [label="Layer13 Expert20\nGPU:84\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert21 [label="Layer13 Expert21\nGPU:85\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert22 [label="Layer13 Expert22\nGPU:86\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert23 [label="Layer13 Expert23\nGPU:87\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert24 [label="Layer13 Expert24\nGPU:88\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert25 [label="Layer13 Expert25\nGPU:89\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert26 [label="Layer13 Expert26\nGPU:90\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert27 [label="Layer13 Expert27\nGPU:91\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert28 [label="Layer13 Expert28\nGPU:92\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert29 [label="Layer13 Expert29\nGPU:93\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert30 [label="Layer13 Expert30\nGPU:94\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert31 [label="Layer13 Expert31\nGPU:95\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert32 [label="Layer13 Expert32\nGPU:96\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert33 [label="Layer13 Expert33\nGPU:97\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert34 [label="Layer13 Expert34\nGPU:98\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert35 [label="Layer13 Expert35\nGPU:99\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert36 [label="Layer13 Expert36\nGPU:100\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert37 [label="Layer13 Expert37\nGPU:101\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert38 [label="Layer13 Expert38\nGPU:102\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert39 [label="Layer13 Expert39\nGPU:103\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert40 [label="Layer13 Expert40\nGPU:104\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert41 [label="Layer13 Expert41\nGPU:105\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert42 [label="Layer13 Expert42\nGPU:106\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert43 [label="Layer13 Expert43\nGPU:107\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert44 [label="Layer13 Expert44\nGPU:108\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert45 [label="Layer13 Expert45\nGPU:109\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert46 [label="Layer13 Expert46\nGPU:110\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert47 [label="Layer13 Expert47\nGPU:111\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert48 [label="Layer13 Expert48\nGPU:112\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert49 [label="Layer13 Expert49\nGPU:113\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert50 [label="Layer13 Expert50\nGPU:114\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert51 [label="Layer13 Expert51\nGPU:115\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert52 [label="Layer13 Expert52\nGPU:116\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert53 [label="Layer13 Expert53\nGPU:117\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert54 [label="Layer13 Expert54\nGPU:118\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert55 [label="Layer13 Expert55\nGPU:119\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert56 [label="Layer13 Expert56\nGPU:120\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert57 [label="Layer13 Expert57\nGPU:121\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert58 [label="Layer13 Expert58\nGPU:122\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert59 [label="Layer13 Expert59\nGPU:123\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert60 [label="Layer13 Expert60\nGPU:124\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert61 [label="Layer13 Expert61\nGPU:125\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert62 [label="Layer13 Expert62\nGPU:126\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_expert63 [label="Layer13 Expert63\nGPU:127\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer13_combine [label="Layer13 Expert Combine\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer13_res1 [label="Layer13 Residual1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer13_ln1 [label="Layer13 LayerNorm1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer13_res2 [label="Layer13 Residual2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer13_ln2 [label="Layer13 LayerNorm2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer13_qkv_tp0 -> layer13_qkv_comm
	layer13_qkv_comm -> layer13_attn_out_tp0
	layer13_attn_out_tp0 -> layer13_attn_out_comm
	layer13_qkv_tp1 -> layer13_qkv_comm
	layer13_qkv_comm -> layer13_attn_out_tp1
	layer13_attn_out_tp1 -> layer13_attn_out_comm
	layer13_qkv_tp2 -> layer13_qkv_comm
	layer13_qkv_comm -> layer13_attn_out_tp2
	layer13_attn_out_tp2 -> layer13_attn_out_comm
	layer13_qkv_tp3 -> layer13_qkv_comm
	layer13_qkv_comm -> layer13_attn_out_tp3
	layer13_attn_out_tp3 -> layer13_attn_out_comm
	layer13_attn_out_comm -> layer13_res1
	layer12_ln2 -> layer13_res1
	layer13_res1 -> layer13_ln1
	layer13_ln1 -> layer13_gate
	layer13_gate -> layer13_dispatch
	layer13_dispatch -> layer13_expert0
	layer13_expert0 -> layer13_combine
	layer13_dispatch -> layer13_expert1
	layer13_expert1 -> layer13_combine
	layer13_dispatch -> layer13_expert2
	layer13_expert2 -> layer13_combine
	layer13_dispatch -> layer13_expert3
	layer13_expert3 -> layer13_combine
	layer13_dispatch -> layer13_expert4
	layer13_expert4 -> layer13_combine
	layer13_dispatch -> layer13_expert5
	layer13_expert5 -> layer13_combine
	layer13_dispatch -> layer13_expert6
	layer13_expert6 -> layer13_combine
	layer13_dispatch -> layer13_expert7
	layer13_expert7 -> layer13_combine
	layer13_dispatch -> layer13_expert8
	layer13_expert8 -> layer13_combine
	layer13_dispatch -> layer13_expert9
	layer13_expert9 -> layer13_combine
	layer13_dispatch -> layer13_expert10
	layer13_expert10 -> layer13_combine
	layer13_dispatch -> layer13_expert11
	layer13_expert11 -> layer13_combine
	layer13_dispatch -> layer13_expert12
	layer13_expert12 -> layer13_combine
	layer13_dispatch -> layer13_expert13
	layer13_expert13 -> layer13_combine
	layer13_dispatch -> layer13_expert14
	layer13_expert14 -> layer13_combine
	layer13_dispatch -> layer13_expert15
	layer13_expert15 -> layer13_combine
	layer13_dispatch -> layer13_expert16
	layer13_expert16 -> layer13_combine
	layer13_dispatch -> layer13_expert17
	layer13_expert17 -> layer13_combine
	layer13_dispatch -> layer13_expert18
	layer13_expert18 -> layer13_combine
	layer13_dispatch -> layer13_expert19
	layer13_expert19 -> layer13_combine
	layer13_dispatch -> layer13_expert20
	layer13_expert20 -> layer13_combine
	layer13_dispatch -> layer13_expert21
	layer13_expert21 -> layer13_combine
	layer13_dispatch -> layer13_expert22
	layer13_expert22 -> layer13_combine
	layer13_dispatch -> layer13_expert23
	layer13_expert23 -> layer13_combine
	layer13_dispatch -> layer13_expert24
	layer13_expert24 -> layer13_combine
	layer13_dispatch -> layer13_expert25
	layer13_expert25 -> layer13_combine
	layer13_dispatch -> layer13_expert26
	layer13_expert26 -> layer13_combine
	layer13_dispatch -> layer13_expert27
	layer13_expert27 -> layer13_combine
	layer13_dispatch -> layer13_expert28
	layer13_expert28 -> layer13_combine
	layer13_dispatch -> layer13_expert29
	layer13_expert29 -> layer13_combine
	layer13_dispatch -> layer13_expert30
	layer13_expert30 -> layer13_combine
	layer13_dispatch -> layer13_expert31
	layer13_expert31 -> layer13_combine
	layer13_dispatch -> layer13_expert32
	layer13_expert32 -> layer13_combine
	layer13_dispatch -> layer13_expert33
	layer13_expert33 -> layer13_combine
	layer13_dispatch -> layer13_expert34
	layer13_expert34 -> layer13_combine
	layer13_dispatch -> layer13_expert35
	layer13_expert35 -> layer13_combine
	layer13_dispatch -> layer13_expert36
	layer13_expert36 -> layer13_combine
	layer13_dispatch -> layer13_expert37
	layer13_expert37 -> layer13_combine
	layer13_dispatch -> layer13_expert38
	layer13_expert38 -> layer13_combine
	layer13_dispatch -> layer13_expert39
	layer13_expert39 -> layer13_combine
	layer13_dispatch -> layer13_expert40
	layer13_expert40 -> layer13_combine
	layer13_dispatch -> layer13_expert41
	layer13_expert41 -> layer13_combine
	layer13_dispatch -> layer13_expert42
	layer13_expert42 -> layer13_combine
	layer13_dispatch -> layer13_expert43
	layer13_expert43 -> layer13_combine
	layer13_dispatch -> layer13_expert44
	layer13_expert44 -> layer13_combine
	layer13_dispatch -> layer13_expert45
	layer13_expert45 -> layer13_combine
	layer13_dispatch -> layer13_expert46
	layer13_expert46 -> layer13_combine
	layer13_dispatch -> layer13_expert47
	layer13_expert47 -> layer13_combine
	layer13_dispatch -> layer13_expert48
	layer13_expert48 -> layer13_combine
	layer13_dispatch -> layer13_expert49
	layer13_expert49 -> layer13_combine
	layer13_dispatch -> layer13_expert50
	layer13_expert50 -> layer13_combine
	layer13_dispatch -> layer13_expert51
	layer13_expert51 -> layer13_combine
	layer13_dispatch -> layer13_expert52
	layer13_expert52 -> layer13_combine
	layer13_dispatch -> layer13_expert53
	layer13_expert53 -> layer13_combine
	layer13_dispatch -> layer13_expert54
	layer13_expert54 -> layer13_combine
	layer13_dispatch -> layer13_expert55
	layer13_expert55 -> layer13_combine
	layer13_dispatch -> layer13_expert56
	layer13_expert56 -> layer13_combine
	layer13_dispatch -> layer13_expert57
	layer13_expert57 -> layer13_combine
	layer13_dispatch -> layer13_expert58
	layer13_expert58 -> layer13_combine
	layer13_dispatch -> layer13_expert59
	layer13_expert59 -> layer13_combine
	layer13_dispatch -> layer13_expert60
	layer13_expert60 -> layer13_combine
	layer13_dispatch -> layer13_expert61
	layer13_expert61 -> layer13_combine
	layer13_dispatch -> layer13_expert62
	layer13_expert62 -> layer13_combine
	layer13_dispatch -> layer13_expert63
	layer13_expert63 -> layer13_combine
	layer13_combine -> layer13_res2
	layer13_ln1 -> layer13_res2
	layer13_res2 -> layer13_ln2
	layer14_qkv_tp0 [label="Layer14 QKV TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer14_attn_out_tp0 [label="Layer14 AttnOut TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer14_mlp1_tp0 [label="Layer14 MLP1 TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=512]" fillcolor=lightcoral fontsize=8 shape=box]
	layer14_mlp2_tp0 [label="Layer14 MLP2 TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer14_qkv_tp1 [label="Layer14 QKV TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer14_attn_out_tp1 [label="Layer14 AttnOut TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer14_mlp1_tp1 [label="Layer14 MLP1 TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=512]" fillcolor=lightcyan fontsize=8 shape=box]
	layer14_mlp2_tp1 [label="Layer14 MLP2 TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer14_qkv_tp2 [label="Layer14 QKV TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer14_attn_out_tp2 [label="Layer14 AttnOut TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer14_mlp1_tp2 [label="Layer14 MLP1 TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=512]" fillcolor=lightgray fontsize=8 shape=box]
	layer14_mlp2_tp2 [label="Layer14 MLP2 TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer14_qkv_tp3 [label="Layer14 QKV TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer14_attn_out_tp3 [label="Layer14 AttnOut TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer14_mlp1_tp3 [label="Layer14 MLP1 TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=512]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer14_mlp2_tp3 [label="Layer14 MLP2 TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer14_qkv_comm [label="Layer14 QKV AllGather\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer14_attn_out_comm [label="Layer14 AttnOut AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer14_mlp_comm [label="Layer14 MLP AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer14_gate [label="Layer14 MoE Gate\nGPU:EP0-15\n[batch=128, seq=10240, experts=64]" fillcolor=lightgreen fontsize=8 shape=box]
	layer14_dispatch [label="Layer14 Expert Dispatch\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer14_expert0 [label="Layer14 Expert0\nGPU:64\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert1 [label="Layer14 Expert1\nGPU:65\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert2 [label="Layer14 Expert2\nGPU:66\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert3 [label="Layer14 Expert3\nGPU:67\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert4 [label="Layer14 Expert4\nGPU:68\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert5 [label="Layer14 Expert5\nGPU:69\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert6 [label="Layer14 Expert6\nGPU:70\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert7 [label="Layer14 Expert7\nGPU:71\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert8 [label="Layer14 Expert8\nGPU:72\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert9 [label="Layer14 Expert9\nGPU:73\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert10 [label="Layer14 Expert10\nGPU:74\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert11 [label="Layer14 Expert11\nGPU:75\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert12 [label="Layer14 Expert12\nGPU:76\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert13 [label="Layer14 Expert13\nGPU:77\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert14 [label="Layer14 Expert14\nGPU:78\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert15 [label="Layer14 Expert15\nGPU:79\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert16 [label="Layer14 Expert16\nGPU:80\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert17 [label="Layer14 Expert17\nGPU:81\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert18 [label="Layer14 Expert18\nGPU:82\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert19 [label="Layer14 Expert19\nGPU:83\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert20 [label="Layer14 Expert20\nGPU:84\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert21 [label="Layer14 Expert21\nGPU:85\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert22 [label="Layer14 Expert22\nGPU:86\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert23 [label="Layer14 Expert23\nGPU:87\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert24 [label="Layer14 Expert24\nGPU:88\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert25 [label="Layer14 Expert25\nGPU:89\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert26 [label="Layer14 Expert26\nGPU:90\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert27 [label="Layer14 Expert27\nGPU:91\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert28 [label="Layer14 Expert28\nGPU:92\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert29 [label="Layer14 Expert29\nGPU:93\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert30 [label="Layer14 Expert30\nGPU:94\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert31 [label="Layer14 Expert31\nGPU:95\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert32 [label="Layer14 Expert32\nGPU:96\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert33 [label="Layer14 Expert33\nGPU:97\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert34 [label="Layer14 Expert34\nGPU:98\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert35 [label="Layer14 Expert35\nGPU:99\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert36 [label="Layer14 Expert36\nGPU:100\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert37 [label="Layer14 Expert37\nGPU:101\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert38 [label="Layer14 Expert38\nGPU:102\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert39 [label="Layer14 Expert39\nGPU:103\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert40 [label="Layer14 Expert40\nGPU:104\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert41 [label="Layer14 Expert41\nGPU:105\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert42 [label="Layer14 Expert42\nGPU:106\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert43 [label="Layer14 Expert43\nGPU:107\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert44 [label="Layer14 Expert44\nGPU:108\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert45 [label="Layer14 Expert45\nGPU:109\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert46 [label="Layer14 Expert46\nGPU:110\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert47 [label="Layer14 Expert47\nGPU:111\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert48 [label="Layer14 Expert48\nGPU:112\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert49 [label="Layer14 Expert49\nGPU:113\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert50 [label="Layer14 Expert50\nGPU:114\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert51 [label="Layer14 Expert51\nGPU:115\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert52 [label="Layer14 Expert52\nGPU:116\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert53 [label="Layer14 Expert53\nGPU:117\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert54 [label="Layer14 Expert54\nGPU:118\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert55 [label="Layer14 Expert55\nGPU:119\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert56 [label="Layer14 Expert56\nGPU:120\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert57 [label="Layer14 Expert57\nGPU:121\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert58 [label="Layer14 Expert58\nGPU:122\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert59 [label="Layer14 Expert59\nGPU:123\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert60 [label="Layer14 Expert60\nGPU:124\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert61 [label="Layer14 Expert61\nGPU:125\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert62 [label="Layer14 Expert62\nGPU:126\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_expert63 [label="Layer14 Expert63\nGPU:127\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer14_combine [label="Layer14 Expert Combine\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer14_res1 [label="Layer14 Residual1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer14_ln1 [label="Layer14 LayerNorm1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer14_res2 [label="Layer14 Residual2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer14_ln2 [label="Layer14 LayerNorm2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer14_qkv_tp0 -> layer14_qkv_comm
	layer14_qkv_comm -> layer14_attn_out_tp0
	layer14_attn_out_tp0 -> layer14_attn_out_comm
	layer14_qkv_tp1 -> layer14_qkv_comm
	layer14_qkv_comm -> layer14_attn_out_tp1
	layer14_attn_out_tp1 -> layer14_attn_out_comm
	layer14_qkv_tp2 -> layer14_qkv_comm
	layer14_qkv_comm -> layer14_attn_out_tp2
	layer14_attn_out_tp2 -> layer14_attn_out_comm
	layer14_qkv_tp3 -> layer14_qkv_comm
	layer14_qkv_comm -> layer14_attn_out_tp3
	layer14_attn_out_tp3 -> layer14_attn_out_comm
	layer14_attn_out_comm -> layer14_res1
	layer13_ln2 -> layer14_res1
	layer14_res1 -> layer14_ln1
	layer14_ln1 -> layer14_gate
	layer14_gate -> layer14_dispatch
	layer14_dispatch -> layer14_expert0
	layer14_expert0 -> layer14_combine
	layer14_dispatch -> layer14_expert1
	layer14_expert1 -> layer14_combine
	layer14_dispatch -> layer14_expert2
	layer14_expert2 -> layer14_combine
	layer14_dispatch -> layer14_expert3
	layer14_expert3 -> layer14_combine
	layer14_dispatch -> layer14_expert4
	layer14_expert4 -> layer14_combine
	layer14_dispatch -> layer14_expert5
	layer14_expert5 -> layer14_combine
	layer14_dispatch -> layer14_expert6
	layer14_expert6 -> layer14_combine
	layer14_dispatch -> layer14_expert7
	layer14_expert7 -> layer14_combine
	layer14_dispatch -> layer14_expert8
	layer14_expert8 -> layer14_combine
	layer14_dispatch -> layer14_expert9
	layer14_expert9 -> layer14_combine
	layer14_dispatch -> layer14_expert10
	layer14_expert10 -> layer14_combine
	layer14_dispatch -> layer14_expert11
	layer14_expert11 -> layer14_combine
	layer14_dispatch -> layer14_expert12
	layer14_expert12 -> layer14_combine
	layer14_dispatch -> layer14_expert13
	layer14_expert13 -> layer14_combine
	layer14_dispatch -> layer14_expert14
	layer14_expert14 -> layer14_combine
	layer14_dispatch -> layer14_expert15
	layer14_expert15 -> layer14_combine
	layer14_dispatch -> layer14_expert16
	layer14_expert16 -> layer14_combine
	layer14_dispatch -> layer14_expert17
	layer14_expert17 -> layer14_combine
	layer14_dispatch -> layer14_expert18
	layer14_expert18 -> layer14_combine
	layer14_dispatch -> layer14_expert19
	layer14_expert19 -> layer14_combine
	layer14_dispatch -> layer14_expert20
	layer14_expert20 -> layer14_combine
	layer14_dispatch -> layer14_expert21
	layer14_expert21 -> layer14_combine
	layer14_dispatch -> layer14_expert22
	layer14_expert22 -> layer14_combine
	layer14_dispatch -> layer14_expert23
	layer14_expert23 -> layer14_combine
	layer14_dispatch -> layer14_expert24
	layer14_expert24 -> layer14_combine
	layer14_dispatch -> layer14_expert25
	layer14_expert25 -> layer14_combine
	layer14_dispatch -> layer14_expert26
	layer14_expert26 -> layer14_combine
	layer14_dispatch -> layer14_expert27
	layer14_expert27 -> layer14_combine
	layer14_dispatch -> layer14_expert28
	layer14_expert28 -> layer14_combine
	layer14_dispatch -> layer14_expert29
	layer14_expert29 -> layer14_combine
	layer14_dispatch -> layer14_expert30
	layer14_expert30 -> layer14_combine
	layer14_dispatch -> layer14_expert31
	layer14_expert31 -> layer14_combine
	layer14_dispatch -> layer14_expert32
	layer14_expert32 -> layer14_combine
	layer14_dispatch -> layer14_expert33
	layer14_expert33 -> layer14_combine
	layer14_dispatch -> layer14_expert34
	layer14_expert34 -> layer14_combine
	layer14_dispatch -> layer14_expert35
	layer14_expert35 -> layer14_combine
	layer14_dispatch -> layer14_expert36
	layer14_expert36 -> layer14_combine
	layer14_dispatch -> layer14_expert37
	layer14_expert37 -> layer14_combine
	layer14_dispatch -> layer14_expert38
	layer14_expert38 -> layer14_combine
	layer14_dispatch -> layer14_expert39
	layer14_expert39 -> layer14_combine
	layer14_dispatch -> layer14_expert40
	layer14_expert40 -> layer14_combine
	layer14_dispatch -> layer14_expert41
	layer14_expert41 -> layer14_combine
	layer14_dispatch -> layer14_expert42
	layer14_expert42 -> layer14_combine
	layer14_dispatch -> layer14_expert43
	layer14_expert43 -> layer14_combine
	layer14_dispatch -> layer14_expert44
	layer14_expert44 -> layer14_combine
	layer14_dispatch -> layer14_expert45
	layer14_expert45 -> layer14_combine
	layer14_dispatch -> layer14_expert46
	layer14_expert46 -> layer14_combine
	layer14_dispatch -> layer14_expert47
	layer14_expert47 -> layer14_combine
	layer14_dispatch -> layer14_expert48
	layer14_expert48 -> layer14_combine
	layer14_dispatch -> layer14_expert49
	layer14_expert49 -> layer14_combine
	layer14_dispatch -> layer14_expert50
	layer14_expert50 -> layer14_combine
	layer14_dispatch -> layer14_expert51
	layer14_expert51 -> layer14_combine
	layer14_dispatch -> layer14_expert52
	layer14_expert52 -> layer14_combine
	layer14_dispatch -> layer14_expert53
	layer14_expert53 -> layer14_combine
	layer14_dispatch -> layer14_expert54
	layer14_expert54 -> layer14_combine
	layer14_dispatch -> layer14_expert55
	layer14_expert55 -> layer14_combine
	layer14_dispatch -> layer14_expert56
	layer14_expert56 -> layer14_combine
	layer14_dispatch -> layer14_expert57
	layer14_expert57 -> layer14_combine
	layer14_dispatch -> layer14_expert58
	layer14_expert58 -> layer14_combine
	layer14_dispatch -> layer14_expert59
	layer14_expert59 -> layer14_combine
	layer14_dispatch -> layer14_expert60
	layer14_expert60 -> layer14_combine
	layer14_dispatch -> layer14_expert61
	layer14_expert61 -> layer14_combine
	layer14_dispatch -> layer14_expert62
	layer14_expert62 -> layer14_combine
	layer14_dispatch -> layer14_expert63
	layer14_expert63 -> layer14_combine
	layer14_combine -> layer14_res2
	layer14_ln1 -> layer14_res2
	layer14_res2 -> layer14_ln2
	layer15_qkv_tp0 [label="Layer15 QKV TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer15_attn_out_tp0 [label="Layer15 AttnOut TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer15_mlp1_tp0 [label="Layer15 MLP1 TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=512]" fillcolor=lightcoral fontsize=8 shape=box]
	layer15_mlp2_tp0 [label="Layer15 MLP2 TP0\nGPU:64-79\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcoral fontsize=8 shape=box]
	layer15_qkv_tp1 [label="Layer15 QKV TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer15_attn_out_tp1 [label="Layer15 AttnOut TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer15_mlp1_tp1 [label="Layer15 MLP1 TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=512]" fillcolor=lightcyan fontsize=8 shape=box]
	layer15_mlp2_tp1 [label="Layer15 MLP2 TP1\nGPU:80-95\n[batch=128, seq=10240, hidden=256]" fillcolor=lightcyan fontsize=8 shape=box]
	layer15_qkv_tp2 [label="Layer15 QKV TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer15_attn_out_tp2 [label="Layer15 AttnOut TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer15_mlp1_tp2 [label="Layer15 MLP1 TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=512]" fillcolor=lightgray fontsize=8 shape=box]
	layer15_mlp2_tp2 [label="Layer15 MLP2 TP2\nGPU:96-111\n[batch=128, seq=10240, hidden=256]" fillcolor=lightgray fontsize=8 shape=box]
	layer15_qkv_tp3 [label="Layer15 QKV TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer15_attn_out_tp3 [label="Layer15 AttnOut TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer15_mlp1_tp3 [label="Layer15 MLP1 TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=512]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer15_mlp2_tp3 [label="Layer15 MLP2 TP3\nGPU:112-127\n[batch=128, seq=10240, hidden=256]" fillcolor=lightsteelblue fontsize=8 shape=box]
	layer15_qkv_comm [label="Layer15 QKV AllGather\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer15_attn_out_comm [label="Layer15 AttnOut AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer15_mlp_comm [label="Layer15 MLP AllReduce\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer15_gate [label="Layer15 MoE Gate\nGPU:EP0-15\n[batch=128, seq=10240, experts=64]" fillcolor=lightgreen fontsize=8 shape=box]
	layer15_dispatch [label="Layer15 Expert Dispatch\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer15_expert0 [label="Layer15 Expert0\nGPU:64\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert1 [label="Layer15 Expert1\nGPU:65\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert2 [label="Layer15 Expert2\nGPU:66\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert3 [label="Layer15 Expert3\nGPU:67\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert4 [label="Layer15 Expert4\nGPU:68\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert5 [label="Layer15 Expert5\nGPU:69\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert6 [label="Layer15 Expert6\nGPU:70\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert7 [label="Layer15 Expert7\nGPU:71\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert8 [label="Layer15 Expert8\nGPU:72\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert9 [label="Layer15 Expert9\nGPU:73\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert10 [label="Layer15 Expert10\nGPU:74\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert11 [label="Layer15 Expert11\nGPU:75\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert12 [label="Layer15 Expert12\nGPU:76\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert13 [label="Layer15 Expert13\nGPU:77\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert14 [label="Layer15 Expert14\nGPU:78\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert15 [label="Layer15 Expert15\nGPU:79\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert16 [label="Layer15 Expert16\nGPU:80\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert17 [label="Layer15 Expert17\nGPU:81\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert18 [label="Layer15 Expert18\nGPU:82\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert19 [label="Layer15 Expert19\nGPU:83\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert20 [label="Layer15 Expert20\nGPU:84\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert21 [label="Layer15 Expert21\nGPU:85\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert22 [label="Layer15 Expert22\nGPU:86\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert23 [label="Layer15 Expert23\nGPU:87\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert24 [label="Layer15 Expert24\nGPU:88\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert25 [label="Layer15 Expert25\nGPU:89\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert26 [label="Layer15 Expert26\nGPU:90\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert27 [label="Layer15 Expert27\nGPU:91\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert28 [label="Layer15 Expert28\nGPU:92\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert29 [label="Layer15 Expert29\nGPU:93\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert30 [label="Layer15 Expert30\nGPU:94\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert31 [label="Layer15 Expert31\nGPU:95\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert32 [label="Layer15 Expert32\nGPU:96\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert33 [label="Layer15 Expert33\nGPU:97\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert34 [label="Layer15 Expert34\nGPU:98\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert35 [label="Layer15 Expert35\nGPU:99\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert36 [label="Layer15 Expert36\nGPU:100\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert37 [label="Layer15 Expert37\nGPU:101\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert38 [label="Layer15 Expert38\nGPU:102\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert39 [label="Layer15 Expert39\nGPU:103\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert40 [label="Layer15 Expert40\nGPU:104\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert41 [label="Layer15 Expert41\nGPU:105\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert42 [label="Layer15 Expert42\nGPU:106\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert43 [label="Layer15 Expert43\nGPU:107\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert44 [label="Layer15 Expert44\nGPU:108\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert45 [label="Layer15 Expert45\nGPU:109\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert46 [label="Layer15 Expert46\nGPU:110\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert47 [label="Layer15 Expert47\nGPU:111\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert48 [label="Layer15 Expert48\nGPU:112\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert49 [label="Layer15 Expert49\nGPU:113\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert50 [label="Layer15 Expert50\nGPU:114\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert51 [label="Layer15 Expert51\nGPU:115\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert52 [label="Layer15 Expert52\nGPU:116\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert53 [label="Layer15 Expert53\nGPU:117\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert54 [label="Layer15 Expert54\nGPU:118\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert55 [label="Layer15 Expert55\nGPU:119\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert56 [label="Layer15 Expert56\nGPU:120\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert57 [label="Layer15 Expert57\nGPU:121\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert58 [label="Layer15 Expert58\nGPU:122\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert59 [label="Layer15 Expert59\nGPU:123\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert60 [label="Layer15 Expert60\nGPU:124\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert61 [label="Layer15 Expert61\nGPU:125\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert62 [label="Layer15 Expert62\nGPU:126\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_expert63 [label="Layer15 Expert63\nGPU:127\n[batch=8, seq=640, hidden=1024]" fillcolor=lightyellow fontsize=7 shape=box]
	layer15_combine [label="Layer15 Expert Combine\nAll-to-All Comm" fillcolor=lightblue fontsize=8 shape=ellipse]
	layer15_res1 [label="Layer15 Residual1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer15_ln1 [label="Layer15 LayerNorm1\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer15_res2 [label="Layer15 Residual2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightcyan fontsize=8 shape=parallelogram]
	layer15_ln2 [label="Layer15 LayerNorm2\n[batch=128, seq=10240, hidden=1024]" fillcolor=lightgreen fontsize=8 shape=box]
	layer15_qkv_tp0 -> layer15_qkv_comm
	layer15_qkv_comm -> layer15_attn_out_tp0
	layer15_attn_out_tp0 -> layer15_attn_out_comm
	layer15_qkv_tp1 -> layer15_qkv_comm
	layer15_qkv_comm -> layer15_attn_out_tp1
	layer15_attn_out_tp1 -> layer15_attn_out_comm
	layer15_qkv_tp2 -> layer15_qkv_comm
	layer15_qkv_comm -> layer15_attn_out_tp2
	layer15_attn_out_tp2 -> layer15_attn_out_comm
	layer15_qkv_tp3 -> layer15_qkv_comm
	layer15_qkv_comm -> layer15_attn_out_tp3
	layer15_attn_out_tp3 -> layer15_attn_out_comm
	layer15_attn_out_comm -> layer15_res1
	layer14_ln2 -> layer15_res1
	layer15_res1 -> layer15_ln1
	layer15_ln1 -> layer15_gate
	layer15_gate -> layer15_dispatch
	layer15_dispatch -> layer15_expert0
	layer15_expert0 -> layer15_combine
	layer15_dispatch -> layer15_expert1
	layer15_expert1 -> layer15_combine
	layer15_dispatch -> layer15_expert2
	layer15_expert2 -> layer15_combine
	layer15_dispatch -> layer15_expert3
	layer15_expert3 -> layer15_combine
	layer15_dispatch -> layer15_expert4
	layer15_expert4 -> layer15_combine
	layer15_dispatch -> layer15_expert5
	layer15_expert5 -> layer15_combine
	layer15_dispatch -> layer15_expert6
	layer15_expert6 -> layer15_combine
	layer15_dispatch -> layer15_expert7
	layer15_expert7 -> layer15_combine
	layer15_dispatch -> layer15_expert8
	layer15_expert8 -> layer15_combine
	layer15_dispatch -> layer15_expert9
	layer15_expert9 -> layer15_combine
	layer15_dispatch -> layer15_expert10
	layer15_expert10 -> layer15_combine
	layer15_dispatch -> layer15_expert11
	layer15_expert11 -> layer15_combine
	layer15_dispatch -> layer15_expert12
	layer15_expert12 -> layer15_combine
	layer15_dispatch -> layer15_expert13
	layer15_expert13 -> layer15_combine
	layer15_dispatch -> layer15_expert14
	layer15_expert14 -> layer15_combine
	layer15_dispatch -> layer15_expert15
	layer15_expert15 -> layer15_combine
	layer15_dispatch -> layer15_expert16
	layer15_expert16 -> layer15_combine
	layer15_dispatch -> layer15_expert17
	layer15_expert17 -> layer15_combine
	layer15_dispatch -> layer15_expert18
	layer15_expert18 -> layer15_combine
	layer15_dispatch -> layer15_expert19
	layer15_expert19 -> layer15_combine
	layer15_dispatch -> layer15_expert20
	layer15_expert20 -> layer15_combine
	layer15_dispatch -> layer15_expert21
	layer15_expert21 -> layer15_combine
	layer15_dispatch -> layer15_expert22
	layer15_expert22 -> layer15_combine
	layer15_dispatch -> layer15_expert23
	layer15_expert23 -> layer15_combine
	layer15_dispatch -> layer15_expert24
	layer15_expert24 -> layer15_combine
	layer15_dispatch -> layer15_expert25
	layer15_expert25 -> layer15_combine
	layer15_dispatch -> layer15_expert26
	layer15_expert26 -> layer15_combine
	layer15_dispatch -> layer15_expert27
	layer15_expert27 -> layer15_combine
	layer15_dispatch -> layer15_expert28
	layer15_expert28 -> layer15_combine
	layer15_dispatch -> layer15_expert29
	layer15_expert29 -> layer15_combine
	layer15_dispatch -> layer15_expert30
	layer15_expert30 -> layer15_combine
	layer15_dispatch -> layer15_expert31
	layer15_expert31 -> layer15_combine
	layer15_dispatch -> layer15_expert32
	layer15_expert32 -> layer15_combine
	layer15_dispatch -> layer15_expert33
	layer15_expert33 -> layer15_combine
	layer15_dispatch -> layer15_expert34
	layer15_expert34 -> layer15_combine
	layer15_dispatch -> layer15_expert35
	layer15_expert35 -> layer15_combine
	layer15_dispatch -> layer15_expert36
	layer15_expert36 -> layer15_combine
	layer15_dispatch -> layer15_expert37
	layer15_expert37 -> layer15_combine
	layer15_dispatch -> layer15_expert38
	layer15_expert38 -> layer15_combine
	layer15_dispatch -> layer15_expert39
	layer15_expert39 -> layer15_combine
	layer15_dispatch -> layer15_expert40
	layer15_expert40 -> layer15_combine
	layer15_dispatch -> layer15_expert41
	layer15_expert41 -> layer15_combine
	layer15_dispatch -> layer15_expert42
	layer15_expert42 -> layer15_combine
	layer15_dispatch -> layer15_expert43
	layer15_expert43 -> layer15_combine
	layer15_dispatch -> layer15_expert44
	layer15_expert44 -> layer15_combine
	layer15_dispatch -> layer15_expert45
	layer15_expert45 -> layer15_combine
	layer15_dispatch -> layer15_expert46
	layer15_expert46 -> layer15_combine
	layer15_dispatch -> layer15_expert47
	layer15_expert47 -> layer15_combine
	layer15_dispatch -> layer15_expert48
	layer15_expert48 -> layer15_combine
	layer15_dispatch -> layer15_expert49
	layer15_expert49 -> layer15_combine
	layer15_dispatch -> layer15_expert50
	layer15_expert50 -> layer15_combine
	layer15_dispatch -> layer15_expert51
	layer15_expert51 -> layer15_combine
	layer15_dispatch -> layer15_expert52
	layer15_expert52 -> layer15_combine
	layer15_dispatch -> layer15_expert53
	layer15_expert53 -> layer15_combine
	layer15_dispatch -> layer15_expert54
	layer15_expert54 -> layer15_combine
	layer15_dispatch -> layer15_expert55
	layer15_expert55 -> layer15_combine
	layer15_dispatch -> layer15_expert56
	layer15_expert56 -> layer15_combine
	layer15_dispatch -> layer15_expert57
	layer15_expert57 -> layer15_combine
	layer15_dispatch -> layer15_expert58
	layer15_expert58 -> layer15_combine
	layer15_dispatch -> layer15_expert59
	layer15_expert59 -> layer15_combine
	layer15_dispatch -> layer15_expert60
	layer15_expert60 -> layer15_combine
	layer15_dispatch -> layer15_expert61
	layer15_expert61 -> layer15_combine
	layer15_dispatch -> layer15_expert62
	layer15_expert62 -> layer15_combine
	layer15_dispatch -> layer15_expert63
	layer15_expert63 -> layer15_combine
	layer15_combine -> layer15_res2
	layer15_ln1 -> layer15_res2
	layer15_res2 -> layer15_ln2
	output [label="Model Output\nGPU: Host\n[batch=128, seq=10240, hidden=1024]" fillcolor=white fontsize=10 shape=box]
	layer15_ln2 -> output
}
