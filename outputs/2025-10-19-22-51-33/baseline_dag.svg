<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="435pt" height="2290pt"
 viewBox="0.00 0.00 435.09 2289.69" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2285.69)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2285.69 431.09,-2285.69 431.09,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<path fill="lightblue" stroke="black" d="M136.55,-1234.95C136.55,-1234.95 290.55,-1234.95 290.55,-1234.95 296.55,-1234.95 302.55,-1240.95 302.55,-1246.95 302.55,-1246.95 302.55,-2102.95 302.55,-2102.95 302.55,-2108.95 296.55,-2114.95 290.55,-2114.95 290.55,-2114.95 136.55,-2114.95 136.55,-2114.95 130.55,-2114.95 124.55,-2108.95 124.55,-2102.95 124.55,-2102.95 124.55,-1246.95 124.55,-1246.95 124.55,-1240.95 130.55,-1234.95 136.55,-1234.95"/>
<text text-anchor="middle" x="213.55" y="-2099.75" font-family="Times,serif" font-size="14.00">Stage 0 (GPUs 0&#45;7)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<path fill="lightcoral" stroke="black" d="M102.55,-8C102.55,-8 324.55,-8 324.55,-8 330.55,-8 336.55,-14 336.55,-20 336.55,-20 336.55,-897.95 336.55,-897.95 336.55,-903.95 330.55,-909.95 324.55,-909.95 324.55,-909.95 102.55,-909.95 102.55,-909.95 96.55,-909.95 90.55,-903.95 90.55,-897.95 90.55,-897.95 90.55,-20 90.55,-20 90.55,-14 96.55,-8 102.55,-8"/>
<text text-anchor="middle" x="213.55" y="-894.75" font-family="Times,serif" font-size="14.00">Stage 1 (GPUs 8&#45;15)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="213.55" cy="-2254.82" rx="213.59" ry="26.74"/>
<text text-anchor="middle" x="213.55" y="-2258.62" font-family="Times,serif" font-size="14.00">Total Input</text>
<text text-anchor="middle" x="213.55" y="-2243.62" font-family="Times,serif" font-size="14.00">[batch=1024, seq=4096, hidden=4096]</text>
</g>
<!-- stage0_embed -->
<g id="node2" class="node">
<title>stage0_embed</title>
<polygon fill="none" stroke="black" points="271.55,-2083.95 155.55,-2083.95 155.55,-2030.95 271.55,-2030.95 271.55,-2083.95"/>
<text text-anchor="middle" x="213.55" y="-2068.75" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="213.55" y="-2053.75" font-family="Times,serif" font-size="14.00">[vocab→4096]</text>
<text text-anchor="middle" x="213.55" y="-2038.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;stage0_embed -->
<g id="edge1" class="edge">
<title>input&#45;&gt;stage0_embed</title>
<path fill="none" stroke="black" d="M213.55,-2227.88C213.55,-2193.63 213.55,-2133.15 213.55,-2094.48"/>
<polygon fill="black" stroke="black" points="217.05,-2094.19 213.55,-2084.19 210.05,-2094.19 217.05,-2094.19"/>
</g>
<!-- layer0_attn -->
<g id="node3" class="node">
<title>layer0_attn</title>
<polygon fill="none" stroke="black" points="290.05,-1886.95 137.05,-1886.95 137.05,-1833.95 290.05,-1833.95 290.05,-1886.95"/>
<text text-anchor="middle" x="213.55" y="-1871.75" font-family="Times,serif" font-size="14.00">L0 Attention</text>
<text text-anchor="middle" x="213.55" y="-1856.75" font-family="Times,serif" font-size="14.00">TP=8 GPUs</text>
<text text-anchor="middle" x="213.55" y="-1841.75" font-family="Times,serif" font-size="14.00">[1024, 4096, 4096]</text>
</g>
<!-- stage0_embed&#45;&gt;layer0_attn -->
<g id="edge2" class="edge">
<title>stage0_embed&#45;&gt;layer0_attn</title>
<path fill="none" stroke="black" d="M213.55,-2030.56C213.55,-1996.37 213.55,-1936.01 213.55,-1897.41"/>
<polygon fill="black" stroke="black" points="217.05,-1897.14 213.55,-1887.14 210.05,-1897.14 217.05,-1897.14"/>
</g>
<!-- layer0_ffn -->
<g id="node4" class="node">
<title>layer0_ffn</title>
<polygon fill="none" stroke="black" points="294.55,-1689.95 132.55,-1689.95 132.55,-1636.95 294.55,-1636.95 294.55,-1689.95"/>
<text text-anchor="middle" x="213.55" y="-1674.75" font-family="Times,serif" font-size="14.00">L0 FFN</text>
<text text-anchor="middle" x="213.55" y="-1659.75" font-family="Times,serif" font-size="14.00">TP=8 GPUs</text>
<text text-anchor="middle" x="213.55" y="-1644.75" font-family="Times,serif" font-size="14.00">[1024, 4096, 16384]</text>
</g>
<!-- layer0_attn&#45;&gt;layer0_ffn -->
<g id="edge3" class="edge">
<title>layer0_attn&#45;&gt;layer0_ffn</title>
<path fill="none" stroke="black" d="M213.55,-1833.56C213.55,-1799.37 213.55,-1739.01 213.55,-1700.41"/>
<polygon fill="black" stroke="black" points="217.05,-1700.14 213.55,-1690.14 210.05,-1700.14 217.05,-1700.14"/>
</g>
<!-- layer1_attn -->
<g id="node5" class="node">
<title>layer1_attn</title>
<polygon fill="none" stroke="black" points="290.05,-1492.95 137.05,-1492.95 137.05,-1439.95 290.05,-1439.95 290.05,-1492.95"/>
<text text-anchor="middle" x="213.55" y="-1477.75" font-family="Times,serif" font-size="14.00">L1 Attention</text>
<text text-anchor="middle" x="213.55" y="-1462.75" font-family="Times,serif" font-size="14.00">TP=8 GPUs</text>
<text text-anchor="middle" x="213.55" y="-1447.75" font-family="Times,serif" font-size="14.00">[1024, 4096, 4096]</text>
</g>
<!-- layer0_ffn&#45;&gt;layer1_attn -->
<g id="edge4" class="edge">
<title>layer0_ffn&#45;&gt;layer1_attn</title>
<path fill="none" stroke="black" d="M213.55,-1636.56C213.55,-1602.37 213.55,-1542.01 213.55,-1503.41"/>
<polygon fill="black" stroke="black" points="217.05,-1503.14 213.55,-1493.14 210.05,-1503.14 217.05,-1503.14"/>
</g>
<!-- layer1_ffn -->
<g id="node6" class="node">
<title>layer1_ffn</title>
<polygon fill="none" stroke="black" points="294.55,-1295.95 132.55,-1295.95 132.55,-1242.95 294.55,-1242.95 294.55,-1295.95"/>
<text text-anchor="middle" x="213.55" y="-1280.75" font-family="Times,serif" font-size="14.00">L1 FFN</text>
<text text-anchor="middle" x="213.55" y="-1265.75" font-family="Times,serif" font-size="14.00">TP=8 GPUs</text>
<text text-anchor="middle" x="213.55" y="-1250.75" font-family="Times,serif" font-size="14.00">[1024, 4096, 16384]</text>
</g>
<!-- layer1_attn&#45;&gt;layer1_ffn -->
<g id="edge5" class="edge">
<title>layer1_attn&#45;&gt;layer1_ffn</title>
<path fill="none" stroke="black" d="M213.55,-1439.56C213.55,-1405.37 213.55,-1345.01 213.55,-1306.41"/>
<polygon fill="black" stroke="black" points="217.05,-1306.14 213.55,-1296.14 210.05,-1306.14 217.05,-1306.14"/>
</g>
<!-- pipeline_comm -->
<g id="node7" class="node">
<title>pipeline_comm</title>
<polygon fill="none" stroke="black" points="347.53,-1098.95 134.39,-1098.95 79.56,-1022.95 292.7,-1022.95 347.53,-1098.95"/>
<text text-anchor="middle" x="213.55" y="-1064.75" font-family="Times,serif" font-size="14.00">Pipeline Send</text>
<text text-anchor="middle" x="213.55" y="-1049.75" font-family="Times,serif" font-size="14.00">GPU 7 → GPU 8</text>
</g>
<!-- layer1_ffn&#45;&gt;pipeline_comm -->
<g id="edge6" class="edge">
<title>layer1_ffn&#45;&gt;pipeline_comm</title>
<path fill="none" stroke="black" d="M213.55,-1242.72C213.55,-1209.43 213.55,-1150.8 213.55,-1109.35"/>
<polygon fill="black" stroke="black" points="217.05,-1109.21 213.55,-1099.21 210.05,-1109.21 217.05,-1109.21"/>
</g>
<!-- layer2_attn -->
<g id="node8" class="node">
<title>layer2_attn</title>
<polygon fill="none" stroke="black" points="290.05,-878.95 137.05,-878.95 137.05,-825.95 290.05,-825.95 290.05,-878.95"/>
<text text-anchor="middle" x="213.55" y="-863.75" font-family="Times,serif" font-size="14.00">L2 Attention</text>
<text text-anchor="middle" x="213.55" y="-848.75" font-family="Times,serif" font-size="14.00">TP=8 GPUs</text>
<text text-anchor="middle" x="213.55" y="-833.75" font-family="Times,serif" font-size="14.00">[1024, 4096, 4096]</text>
</g>
<!-- pipeline_comm&#45;&gt;layer2_attn -->
<g id="edge7" class="edge">
<title>pipeline_comm&#45;&gt;layer2_attn</title>
<path fill="none" stroke="black" d="M213.55,-1022.56C213.55,-984.79 213.55,-926.86 213.55,-889.56"/>
<polygon fill="black" stroke="black" points="217.05,-889.16 213.55,-879.16 210.05,-889.16 217.05,-889.16"/>
</g>
<!-- layer2_ffn -->
<g id="node9" class="node">
<title>layer2_ffn</title>
<polygon fill="none" stroke="black" points="294.55,-681.95 132.55,-681.95 132.55,-628.95 294.55,-628.95 294.55,-681.95"/>
<text text-anchor="middle" x="213.55" y="-666.75" font-family="Times,serif" font-size="14.00">L2 FFN</text>
<text text-anchor="middle" x="213.55" y="-651.75" font-family="Times,serif" font-size="14.00">TP=8 GPUs</text>
<text text-anchor="middle" x="213.55" y="-636.75" font-family="Times,serif" font-size="14.00">[1024, 4096, 16384]</text>
</g>
<!-- layer2_attn&#45;&gt;layer2_ffn -->
<g id="edge8" class="edge">
<title>layer2_attn&#45;&gt;layer2_ffn</title>
<path fill="none" stroke="black" d="M213.55,-825.56C213.55,-791.37 213.55,-731.01 213.55,-692.41"/>
<polygon fill="black" stroke="black" points="217.05,-692.14 213.55,-682.14 210.05,-692.14 217.05,-692.14"/>
</g>
<!-- layer3_attn -->
<g id="node10" class="node">
<title>layer3_attn</title>
<polygon fill="none" stroke="black" points="290.05,-484.95 137.05,-484.95 137.05,-431.95 290.05,-431.95 290.05,-484.95"/>
<text text-anchor="middle" x="213.55" y="-469.75" font-family="Times,serif" font-size="14.00">L3 Attention</text>
<text text-anchor="middle" x="213.55" y="-454.75" font-family="Times,serif" font-size="14.00">TP=8 GPUs</text>
<text text-anchor="middle" x="213.55" y="-439.75" font-family="Times,serif" font-size="14.00">[1024, 4096, 4096]</text>
</g>
<!-- layer2_ffn&#45;&gt;layer3_attn -->
<g id="edge9" class="edge">
<title>layer2_ffn&#45;&gt;layer3_attn</title>
<path fill="none" stroke="black" d="M213.55,-628.56C213.55,-594.37 213.55,-534.01 213.55,-495.41"/>
<polygon fill="black" stroke="black" points="217.05,-495.14 213.55,-485.14 210.05,-495.14 217.05,-495.14"/>
</g>
<!-- layer3_ffn -->
<g id="node11" class="node">
<title>layer3_ffn</title>
<polygon fill="none" stroke="black" points="294.55,-287.95 132.55,-287.95 132.55,-234.95 294.55,-234.95 294.55,-287.95"/>
<text text-anchor="middle" x="213.55" y="-272.75" font-family="Times,serif" font-size="14.00">L3 FFN</text>
<text text-anchor="middle" x="213.55" y="-257.75" font-family="Times,serif" font-size="14.00">TP=8 GPUs</text>
<text text-anchor="middle" x="213.55" y="-242.75" font-family="Times,serif" font-size="14.00">[1024, 4096, 16384]</text>
</g>
<!-- layer3_attn&#45;&gt;layer3_ffn -->
<g id="edge10" class="edge">
<title>layer3_attn&#45;&gt;layer3_ffn</title>
<path fill="none" stroke="black" d="M213.55,-431.56C213.55,-397.37 213.55,-337.01 213.55,-298.41"/>
<polygon fill="black" stroke="black" points="217.05,-298.14 213.55,-288.14 210.05,-298.14 217.05,-298.14"/>
</g>
<!-- output -->
<g id="node12" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="213.55" cy="-53.48" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="213.55" y="-64.78" font-family="Times,serif" font-size="14.00">Total Output</text>
<text text-anchor="middle" x="213.55" y="-49.78" font-family="Times,serif" font-size="14.00">[1024, 4096, 32000]</text>
<text text-anchor="middle" x="213.55" y="-34.78" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_ffn&#45;&gt;output -->
<g id="edge11" class="edge">
<title>layer3_ffn&#45;&gt;output</title>
<path fill="none" stroke="black" d="M213.55,-234.78C213.55,-201.48 213.55,-142.75 213.55,-101.39"/>
<polygon fill="black" stroke="black" points="217.05,-101.27 213.55,-91.27 210.05,-101.27 217.05,-101.27"/>
</g>
</g>
</svg>
