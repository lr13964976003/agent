<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: LLM_TP4_PP2_Detailed_Corrected Pages: 1 -->
<svg width="793pt" height="7238pt"
 viewBox="0.00 0.00 792.73 7238.24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 7234.24)">
<title>LLM_TP4_PP2_Detailed_Corrected</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-7234.24 788.73,-7234.24 788.73,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightcoral" stroke="black" points="403.03,-7196.76 317.63,-7230.21 146.83,-7230.21 61.44,-7196.76 146.83,-7163.31 317.63,-7163.31 403.03,-7196.76"/>
<text text-anchor="middle" x="232.23" y="-7205.26" font-family="Arial" font-size="10.00">INPUT</text>
<text text-anchor="middle" x="232.23" y="-7194.26" font-family="Arial" font-size="10.00">[batch_size=1, seq_len=2048, hidden=8192]</text>
<text text-anchor="middle" x="232.23" y="-7183.26" font-family="Arial" font-size="10.00">GPU: Host</text>
</g>
<!-- embed_s0 -->
<g id="node3" class="node">
<title>embed_s0</title>
<polygon fill="lightblue" stroke="black" points="325.23,-7105.28 139.23,-7105.28 139.23,-7064.28 325.23,-7064.28 325.23,-7105.28"/>
<text text-anchor="middle" x="232.23" y="-7093.28" font-family="Arial" font-size="10.00">Embedding Layer 0</text>
<text text-anchor="middle" x="232.23" y="-7082.28" font-family="Arial" font-size="10.00">[Input: [1,2048], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-7071.28" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- input&#45;&gt;embed_s0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embed_s0</title>
<path fill="none" stroke="black" d="M232.23,-7163.06C232.23,-7147.98 232.23,-7130.21 232.23,-7115.51"/>
<polygon fill="black" stroke="black" points="235.73,-7115.43 232.23,-7105.43 228.73,-7115.43 235.73,-7115.43"/>
</g>
<!-- stage0_label -->
<g id="node2" class="node">
<title>stage0_label</title>
<path fill="lightgray" stroke="black" d="M581.73,-7220.26C581.73,-7220.26 450.73,-7220.26 450.73,-7220.26 444.73,-7220.26 438.73,-7214.26 438.73,-7208.26 438.73,-7208.26 438.73,-7185.26 438.73,-7185.26 438.73,-7179.26 444.73,-7173.26 450.73,-7173.26 450.73,-7173.26 581.73,-7173.26 581.73,-7173.26 587.73,-7173.26 593.73,-7179.26 593.73,-7185.26 593.73,-7185.26 593.73,-7208.26 593.73,-7208.26 593.73,-7214.26 587.73,-7220.26 581.73,-7220.26"/>
<text text-anchor="middle" x="516.23" y="-7206.66" font-family="Times,serif" font-size="12.00">PIPELINE STAGE 0</text>
<text text-anchor="middle" x="516.23" y="-7193.66" font-family="Times,serif" font-size="12.00">GPUs 0&#45;3 (TP Group 0)</text>
<text text-anchor="middle" x="516.23" y="-7180.66" font-family="Times,serif" font-size="12.00">Layers 0&#45;39</text>
</g>
<!-- rmsnorm_0_s0 -->
<g id="node4" class="node">
<title>rmsnorm_0_s0</title>
<polygon fill="lightblue" stroke="black" points="337.23,-7006.28 127.23,-7006.28 127.23,-6965.28 337.23,-6965.28 337.23,-7006.28"/>
<text text-anchor="middle" x="232.23" y="-6994.28" font-family="Arial" font-size="10.00">RMSNorm Layer 0</text>
<text text-anchor="middle" x="232.23" y="-6983.28" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-6972.28" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- embed_s0&#45;&gt;rmsnorm_0_s0 -->
<g id="edge2" class="edge">
<title>embed_s0&#45;&gt;rmsnorm_0_s0</title>
<path fill="none" stroke="black" d="M232.23,-7064.16C232.23,-7050.48 232.23,-7031.99 232.23,-7016.52"/>
<polygon fill="black" stroke="black" points="235.73,-7016.39 232.23,-7006.39 228.73,-7016.39 235.73,-7016.39"/>
</g>
<!-- qkv_0_s0 -->
<g id="node5" class="node">
<title>qkv_0_s0</title>
<polygon fill="lightblue" stroke="black" points="339.73,-6907.28 124.73,-6907.28 124.73,-6866.28 339.73,-6866.28 339.73,-6907.28"/>
<text text-anchor="middle" x="232.23" y="-6895.28" font-family="Arial" font-size="10.00">QKV Linear Layer 0</text>
<text text-anchor="middle" x="232.23" y="-6884.28" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,12288]]</text>
<text text-anchor="middle" x="232.23" y="-6873.28" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- rmsnorm_0_s0&#45;&gt;qkv_0_s0 -->
<g id="edge3" class="edge">
<title>rmsnorm_0_s0&#45;&gt;qkv_0_s0</title>
<path fill="none" stroke="black" d="M232.23,-6965.16C232.23,-6951.48 232.23,-6932.99 232.23,-6917.52"/>
<polygon fill="black" stroke="black" points="235.73,-6917.39 232.23,-6907.39 228.73,-6917.39 235.73,-6917.39"/>
</g>
<!-- attn_split_0_s0 -->
<g id="node6" class="node">
<title>attn_split_0_s0</title>
<polygon fill="lightgreen" stroke="black" points="464.7,-6808.28 94.9,-6808.28 -0.23,-6726.28 369.57,-6726.28 464.7,-6808.28"/>
<text text-anchor="middle" x="232.23" y="-6775.78" font-family="Arial" font-size="10.00">Attention Head Split</text>
<text text-anchor="middle" x="232.23" y="-6764.78" font-family="Arial" font-size="10.00">[Input: [1,2048,12288], Output: [1,64,2048,128]]</text>
<text text-anchor="middle" x="232.23" y="-6753.78" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- qkv_0_s0&#45;&gt;attn_split_0_s0 -->
<g id="edge4" class="edge">
<title>qkv_0_s0&#45;&gt;attn_split_0_s0</title>
<path fill="none" stroke="black" d="M232.23,-6866.12C232.23,-6853.13 232.23,-6835.49 232.23,-6818.76"/>
<polygon fill="black" stroke="black" points="235.73,-6818.51 232.23,-6808.51 228.73,-6818.51 235.73,-6818.51"/>
</g>
<!-- attn_compute_0_s0 -->
<g id="node7" class="node">
<title>attn_compute_0_s0</title>
<polygon fill="lightblue" stroke="black" points="345.73,-6668.28 118.73,-6668.28 118.73,-6627.28 345.73,-6627.28 345.73,-6668.28"/>
<text text-anchor="middle" x="232.23" y="-6656.28" font-family="Arial" font-size="10.00">Attention Compute</text>
<text text-anchor="middle" x="232.23" y="-6645.28" font-family="Arial" font-size="10.00">[Input: [1,64,2048,128], Output: [1,64,2048,128]]</text>
<text text-anchor="middle" x="232.23" y="-6634.28" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- attn_split_0_s0&#45;&gt;attn_compute_0_s0 -->
<g id="edge5" class="edge">
<title>attn_split_0_s0&#45;&gt;attn_compute_0_s0</title>
<path fill="none" stroke="black" d="M232.23,-6726.18C232.23,-6710.6 232.23,-6693.08 232.23,-6678.65"/>
<polygon fill="black" stroke="black" points="235.73,-6678.3 232.23,-6668.3 228.73,-6678.3 235.73,-6678.3"/>
</g>
<!-- attn_ar_0_s0 -->
<g id="node8" class="node">
<title>attn_ar_0_s0</title>
<ellipse fill="lightyellow" stroke="black" cx="232.23" cy="-6540.29" rx="160.53" ry="28.98"/>
<text text-anchor="middle" x="232.23" y="-6548.79" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="232.23" y="-6537.79" font-family="Arial" font-size="10.00">[Input: [1,64,2048,128], Output: [1,64,2048,128]]</text>
<text text-anchor="middle" x="232.23" y="-6526.79" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- attn_compute_0_s0&#45;&gt;attn_ar_0_s0 -->
<g id="edge6" class="edge">
<title>attn_compute_0_s0&#45;&gt;attn_ar_0_s0</title>
<path fill="none" stroke="black" d="M232.23,-6626.94C232.23,-6613.63 232.23,-6595.65 232.23,-6579.6"/>
<polygon fill="black" stroke="black" points="235.73,-6579.41 232.23,-6569.41 228.73,-6579.41 235.73,-6579.41"/>
</g>
<!-- attn_out_0_s0 -->
<g id="node9" class="node">
<title>attn_out_0_s0</title>
<polygon fill="lightblue" stroke="black" points="337.23,-6453.3 127.23,-6453.3 127.23,-6412.3 337.23,-6412.3 337.23,-6453.3"/>
<text text-anchor="middle" x="232.23" y="-6441.3" font-family="Arial" font-size="10.00">Attention Output Linear</text>
<text text-anchor="middle" x="232.23" y="-6430.3" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-6419.3" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- attn_ar_0_s0&#45;&gt;attn_out_0_s0 -->
<g id="edge7" class="edge">
<title>attn_ar_0_s0&#45;&gt;attn_out_0_s0</title>
<path fill="none" stroke="black" d="M232.23,-6511.3C232.23,-6496.66 232.23,-6478.74 232.23,-6463.81"/>
<polygon fill="black" stroke="black" points="235.73,-6463.57 232.23,-6453.57 228.73,-6463.57 235.73,-6463.57"/>
</g>
<!-- ffn_up_0_s0 -->
<g id="node10" class="node">
<title>ffn_up_0_s0</title>
<polygon fill="lightblue" stroke="black" points="339.73,-6354.3 124.73,-6354.3 124.73,-6313.3 339.73,-6313.3 339.73,-6354.3"/>
<text text-anchor="middle" x="232.23" y="-6342.3" font-family="Arial" font-size="10.00">FFN Up&#45;Projection</text>
<text text-anchor="middle" x="232.23" y="-6331.3" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,28672]]</text>
<text text-anchor="middle" x="232.23" y="-6320.3" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- attn_out_0_s0&#45;&gt;ffn_up_0_s0 -->
<g id="edge8" class="edge">
<title>attn_out_0_s0&#45;&gt;ffn_up_0_s0</title>
<path fill="none" stroke="black" d="M232.23,-6412.17C232.23,-6398.5 232.23,-6380.01 232.23,-6364.54"/>
<polygon fill="black" stroke="black" points="235.73,-6364.4 232.23,-6354.4 228.73,-6364.4 235.73,-6364.4"/>
</g>
<!-- ffn_act_0_s0 -->
<g id="node11" class="node">
<title>ffn_act_0_s0</title>
<polygon fill="lightblue" stroke="black" points="342.73,-6255.3 121.73,-6255.3 121.73,-6214.3 342.73,-6214.3 342.73,-6255.3"/>
<text text-anchor="middle" x="232.23" y="-6243.3" font-family="Arial" font-size="10.00">FFN Activation (SiLU)</text>
<text text-anchor="middle" x="232.23" y="-6232.3" font-family="Arial" font-size="10.00">[Input: [1,2048,28672], Output: [1,2048,28672]]</text>
<text text-anchor="middle" x="232.23" y="-6221.3" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- ffn_up_0_s0&#45;&gt;ffn_act_0_s0 -->
<g id="edge9" class="edge">
<title>ffn_up_0_s0&#45;&gt;ffn_act_0_s0</title>
<path fill="none" stroke="black" d="M232.23,-6313.17C232.23,-6299.5 232.23,-6281.01 232.23,-6265.54"/>
<polygon fill="black" stroke="black" points="235.73,-6265.4 232.23,-6255.4 228.73,-6265.4 235.73,-6265.4"/>
</g>
<!-- ffn_down_0_s0 -->
<g id="node12" class="node">
<title>ffn_down_0_s0</title>
<polygon fill="lightblue" stroke="black" points="339.73,-6156.3 124.73,-6156.3 124.73,-6115.3 339.73,-6115.3 339.73,-6156.3"/>
<text text-anchor="middle" x="232.23" y="-6144.3" font-family="Arial" font-size="10.00">FFN Down&#45;Projection</text>
<text text-anchor="middle" x="232.23" y="-6133.3" font-family="Arial" font-size="10.00">[Input: [1,2048,28672], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-6122.3" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- ffn_act_0_s0&#45;&gt;ffn_down_0_s0 -->
<g id="edge10" class="edge">
<title>ffn_act_0_s0&#45;&gt;ffn_down_0_s0</title>
<path fill="none" stroke="black" d="M232.23,-6214.17C232.23,-6200.5 232.23,-6182.01 232.23,-6166.54"/>
<polygon fill="black" stroke="black" points="235.73,-6166.4 232.23,-6156.4 228.73,-6166.4 235.73,-6166.4"/>
</g>
<!-- ffn_ar_0_s0 -->
<g id="node13" class="node">
<title>ffn_ar_0_s0</title>
<ellipse fill="lightyellow" stroke="black" cx="232.23" cy="-6028.31" rx="148.48" ry="28.98"/>
<text text-anchor="middle" x="232.23" y="-6036.81" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="232.23" y="-6025.81" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-6014.81" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- ffn_down_0_s0&#45;&gt;ffn_ar_0_s0 -->
<g id="edge11" class="edge">
<title>ffn_down_0_s0&#45;&gt;ffn_ar_0_s0</title>
<path fill="none" stroke="black" d="M232.23,-6114.96C232.23,-6101.64 232.23,-6083.67 232.23,-6067.62"/>
<polygon fill="black" stroke="black" points="235.73,-6067.42 232.23,-6057.42 228.73,-6067.42 235.73,-6067.42"/>
</g>
<!-- rmsnorm_1_s0 -->
<g id="node14" class="node">
<title>rmsnorm_1_s0</title>
<polygon fill="lightblue" stroke="black" points="337.23,-5941.32 127.23,-5941.32 127.23,-5900.32 337.23,-5900.32 337.23,-5941.32"/>
<text text-anchor="middle" x="232.23" y="-5929.32" font-family="Arial" font-size="10.00">RMSNorm Layer 1</text>
<text text-anchor="middle" x="232.23" y="-5918.32" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-5907.32" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- ffn_ar_0_s0&#45;&gt;rmsnorm_1_s0 -->
<g id="edge12" class="edge">
<title>ffn_ar_0_s0&#45;&gt;rmsnorm_1_s0</title>
<path fill="none" stroke="black" d="M232.23,-5999.32C232.23,-5984.68 232.23,-5966.75 232.23,-5951.83"/>
<polygon fill="black" stroke="black" points="235.73,-5951.59 232.23,-5941.59 228.73,-5951.59 235.73,-5951.59"/>
</g>
<!-- qkv_1_s0 -->
<g id="node15" class="node">
<title>qkv_1_s0</title>
<polygon fill="lightblue" stroke="black" points="339.73,-5842.32 124.73,-5842.32 124.73,-5801.32 339.73,-5801.32 339.73,-5842.32"/>
<text text-anchor="middle" x="232.23" y="-5830.32" font-family="Arial" font-size="10.00">QKV Linear Layer 1</text>
<text text-anchor="middle" x="232.23" y="-5819.32" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,12288]]</text>
<text text-anchor="middle" x="232.23" y="-5808.32" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- rmsnorm_1_s0&#45;&gt;qkv_1_s0 -->
<g id="edge13" class="edge">
<title>rmsnorm_1_s0&#45;&gt;qkv_1_s0</title>
<path fill="none" stroke="black" d="M232.23,-5900.19C232.23,-5886.52 232.23,-5868.03 232.23,-5852.55"/>
<polygon fill="black" stroke="black" points="235.73,-5852.42 232.23,-5842.42 228.73,-5852.42 235.73,-5852.42"/>
</g>
<!-- attn_split_1_s0 -->
<g id="node16" class="node">
<title>attn_split_1_s0</title>
<polygon fill="lightgreen" stroke="black" points="464.7,-5743.32 94.9,-5743.32 -0.23,-5661.32 369.57,-5661.32 464.7,-5743.32"/>
<text text-anchor="middle" x="232.23" y="-5710.82" font-family="Arial" font-size="10.00">Attention Head Split</text>
<text text-anchor="middle" x="232.23" y="-5699.82" font-family="Arial" font-size="10.00">[Input: [1,2048,12288], Output: [1,64,2048,128]]</text>
<text text-anchor="middle" x="232.23" y="-5688.82" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- qkv_1_s0&#45;&gt;attn_split_1_s0 -->
<g id="edge14" class="edge">
<title>qkv_1_s0&#45;&gt;attn_split_1_s0</title>
<path fill="none" stroke="black" d="M232.23,-5801.15C232.23,-5788.17 232.23,-5770.52 232.23,-5753.79"/>
<polygon fill="black" stroke="black" points="235.73,-5753.54 232.23,-5743.54 228.73,-5753.54 235.73,-5753.54"/>
</g>
<!-- attn_compute_1_s0 -->
<g id="node17" class="node">
<title>attn_compute_1_s0</title>
<polygon fill="lightblue" stroke="black" points="345.73,-5603.32 118.73,-5603.32 118.73,-5562.32 345.73,-5562.32 345.73,-5603.32"/>
<text text-anchor="middle" x="232.23" y="-5591.32" font-family="Arial" font-size="10.00">Attention Compute</text>
<text text-anchor="middle" x="232.23" y="-5580.32" font-family="Arial" font-size="10.00">[Input: [1,64,2048,128], Output: [1,64,2048,128]]</text>
<text text-anchor="middle" x="232.23" y="-5569.32" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- attn_split_1_s0&#45;&gt;attn_compute_1_s0 -->
<g id="edge15" class="edge">
<title>attn_split_1_s0&#45;&gt;attn_compute_1_s0</title>
<path fill="none" stroke="black" d="M232.23,-5661.21C232.23,-5645.64 232.23,-5628.11 232.23,-5613.68"/>
<polygon fill="black" stroke="black" points="235.73,-5613.33 232.23,-5603.33 228.73,-5613.33 235.73,-5613.33"/>
</g>
<!-- attn_ar_1_s0 -->
<g id="node18" class="node">
<title>attn_ar_1_s0</title>
<ellipse fill="lightyellow" stroke="black" cx="232.23" cy="-5475.33" rx="160.53" ry="28.98"/>
<text text-anchor="middle" x="232.23" y="-5483.83" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="232.23" y="-5472.83" font-family="Arial" font-size="10.00">[Input: [1,64,2048,128], Output: [1,64,2048,128]]</text>
<text text-anchor="middle" x="232.23" y="-5461.83" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- attn_compute_1_s0&#45;&gt;attn_ar_1_s0 -->
<g id="edge16" class="edge">
<title>attn_compute_1_s0&#45;&gt;attn_ar_1_s0</title>
<path fill="none" stroke="black" d="M232.23,-5561.98C232.23,-5548.66 232.23,-5530.68 232.23,-5514.64"/>
<polygon fill="black" stroke="black" points="235.73,-5514.44 232.23,-5504.44 228.73,-5514.44 235.73,-5514.44"/>
</g>
<!-- attn_out_1_s0 -->
<g id="node19" class="node">
<title>attn_out_1_s0</title>
<polygon fill="lightblue" stroke="black" points="337.23,-5388.34 127.23,-5388.34 127.23,-5347.34 337.23,-5347.34 337.23,-5388.34"/>
<text text-anchor="middle" x="232.23" y="-5376.34" font-family="Arial" font-size="10.00">Attention Output Linear</text>
<text text-anchor="middle" x="232.23" y="-5365.34" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-5354.34" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- attn_ar_1_s0&#45;&gt;attn_out_1_s0 -->
<g id="edge17" class="edge">
<title>attn_ar_1_s0&#45;&gt;attn_out_1_s0</title>
<path fill="none" stroke="black" d="M232.23,-5446.34C232.23,-5431.7 232.23,-5413.77 232.23,-5398.85"/>
<polygon fill="black" stroke="black" points="235.73,-5398.6 232.23,-5388.6 228.73,-5398.6 235.73,-5398.6"/>
</g>
<!-- ffn_up_1_s0 -->
<g id="node20" class="node">
<title>ffn_up_1_s0</title>
<polygon fill="lightblue" stroke="black" points="339.73,-5289.34 124.73,-5289.34 124.73,-5248.34 339.73,-5248.34 339.73,-5289.34"/>
<text text-anchor="middle" x="232.23" y="-5277.34" font-family="Arial" font-size="10.00">FFN Up&#45;Projection</text>
<text text-anchor="middle" x="232.23" y="-5266.34" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,28672]]</text>
<text text-anchor="middle" x="232.23" y="-5255.34" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- attn_out_1_s0&#45;&gt;ffn_up_1_s0 -->
<g id="edge18" class="edge">
<title>attn_out_1_s0&#45;&gt;ffn_up_1_s0</title>
<path fill="none" stroke="black" d="M232.23,-5347.21C232.23,-5333.53 232.23,-5315.05 232.23,-5299.57"/>
<polygon fill="black" stroke="black" points="235.73,-5299.44 232.23,-5289.44 228.73,-5299.44 235.73,-5299.44"/>
</g>
<!-- ffn_act_1_s0 -->
<g id="node21" class="node">
<title>ffn_act_1_s0</title>
<polygon fill="lightblue" stroke="black" points="342.73,-5190.34 121.73,-5190.34 121.73,-5149.34 342.73,-5149.34 342.73,-5190.34"/>
<text text-anchor="middle" x="232.23" y="-5178.34" font-family="Arial" font-size="10.00">FFN Activation (SiLU)</text>
<text text-anchor="middle" x="232.23" y="-5167.34" font-family="Arial" font-size="10.00">[Input: [1,2048,28672], Output: [1,2048,28672]]</text>
<text text-anchor="middle" x="232.23" y="-5156.34" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- ffn_up_1_s0&#45;&gt;ffn_act_1_s0 -->
<g id="edge19" class="edge">
<title>ffn_up_1_s0&#45;&gt;ffn_act_1_s0</title>
<path fill="none" stroke="black" d="M232.23,-5248.21C232.23,-5234.53 232.23,-5216.05 232.23,-5200.57"/>
<polygon fill="black" stroke="black" points="235.73,-5200.44 232.23,-5190.44 228.73,-5200.44 235.73,-5200.44"/>
</g>
<!-- ffn_down_1_s0 -->
<g id="node22" class="node">
<title>ffn_down_1_s0</title>
<polygon fill="lightblue" stroke="black" points="339.73,-5091.34 124.73,-5091.34 124.73,-5050.34 339.73,-5050.34 339.73,-5091.34"/>
<text text-anchor="middle" x="232.23" y="-5079.34" font-family="Arial" font-size="10.00">FFN Down&#45;Projection</text>
<text text-anchor="middle" x="232.23" y="-5068.34" font-family="Arial" font-size="10.00">[Input: [1,2048,28672], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-5057.34" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- ffn_act_1_s0&#45;&gt;ffn_down_1_s0 -->
<g id="edge20" class="edge">
<title>ffn_act_1_s0&#45;&gt;ffn_down_1_s0</title>
<path fill="none" stroke="black" d="M232.23,-5149.21C232.23,-5135.53 232.23,-5117.05 232.23,-5101.57"/>
<polygon fill="black" stroke="black" points="235.73,-5101.44 232.23,-5091.44 228.73,-5101.44 235.73,-5101.44"/>
</g>
<!-- ffn_ar_1_s0 -->
<g id="node23" class="node">
<title>ffn_ar_1_s0</title>
<ellipse fill="lightyellow" stroke="black" cx="232.23" cy="-4963.35" rx="148.48" ry="28.98"/>
<text text-anchor="middle" x="232.23" y="-4971.85" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="232.23" y="-4960.85" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-4949.85" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- ffn_down_1_s0&#45;&gt;ffn_ar_1_s0 -->
<g id="edge21" class="edge">
<title>ffn_down_1_s0&#45;&gt;ffn_ar_1_s0</title>
<path fill="none" stroke="black" d="M232.23,-5049.99C232.23,-5036.68 232.23,-5018.7 232.23,-5002.66"/>
<polygon fill="black" stroke="black" points="235.73,-5002.46 232.23,-4992.46 228.73,-5002.46 235.73,-5002.46"/>
</g>
<!-- rmsnorm_2_s0 -->
<g id="node24" class="node">
<title>rmsnorm_2_s0</title>
<polygon fill="lightblue" stroke="black" points="337.23,-4876.35 127.23,-4876.35 127.23,-4835.35 337.23,-4835.35 337.23,-4876.35"/>
<text text-anchor="middle" x="232.23" y="-4864.35" font-family="Arial" font-size="10.00">RMSNorm Layer 2</text>
<text text-anchor="middle" x="232.23" y="-4853.35" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-4842.35" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- ffn_ar_1_s0&#45;&gt;rmsnorm_2_s0 -->
<g id="edge22" class="edge">
<title>ffn_ar_1_s0&#45;&gt;rmsnorm_2_s0</title>
<path fill="none" stroke="black" d="M232.23,-4934.35C232.23,-4919.72 232.23,-4901.79 232.23,-4886.87"/>
<polygon fill="black" stroke="black" points="235.73,-4886.62 232.23,-4876.62 228.73,-4886.62 235.73,-4886.62"/>
</g>
<!-- qkv_2_s0 -->
<g id="node25" class="node">
<title>qkv_2_s0</title>
<polygon fill="lightblue" stroke="black" points="339.73,-4777.35 124.73,-4777.35 124.73,-4736.35 339.73,-4736.35 339.73,-4777.35"/>
<text text-anchor="middle" x="232.23" y="-4765.35" font-family="Arial" font-size="10.00">QKV Linear Layer 2</text>
<text text-anchor="middle" x="232.23" y="-4754.35" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,12288]]</text>
<text text-anchor="middle" x="232.23" y="-4743.35" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- rmsnorm_2_s0&#45;&gt;qkv_2_s0 -->
<g id="edge23" class="edge">
<title>rmsnorm_2_s0&#45;&gt;qkv_2_s0</title>
<path fill="none" stroke="black" d="M232.23,-4835.22C232.23,-4821.55 232.23,-4803.06 232.23,-4787.59"/>
<polygon fill="black" stroke="black" points="235.73,-4787.45 232.23,-4777.45 228.73,-4787.45 235.73,-4787.45"/>
</g>
<!-- attn_split_2_s0 -->
<g id="node26" class="node">
<title>attn_split_2_s0</title>
<polygon fill="lightgreen" stroke="black" points="464.7,-4678.35 94.9,-4678.35 -0.23,-4596.35 369.57,-4596.35 464.7,-4678.35"/>
<text text-anchor="middle" x="232.23" y="-4645.85" font-family="Arial" font-size="10.00">Attention Head Split</text>
<text text-anchor="middle" x="232.23" y="-4634.85" font-family="Arial" font-size="10.00">[Input: [1,2048,12288], Output: [1,64,2048,128]]</text>
<text text-anchor="middle" x="232.23" y="-4623.85" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- qkv_2_s0&#45;&gt;attn_split_2_s0 -->
<g id="edge24" class="edge">
<title>qkv_2_s0&#45;&gt;attn_split_2_s0</title>
<path fill="none" stroke="black" d="M232.23,-4736.19C232.23,-4723.2 232.23,-4705.56 232.23,-4688.82"/>
<polygon fill="black" stroke="black" points="235.73,-4688.57 232.23,-4678.57 228.73,-4688.58 235.73,-4688.57"/>
</g>
<!-- attn_compute_2_s0 -->
<g id="node27" class="node">
<title>attn_compute_2_s0</title>
<polygon fill="lightblue" stroke="black" points="345.73,-4538.35 118.73,-4538.35 118.73,-4497.35 345.73,-4497.35 345.73,-4538.35"/>
<text text-anchor="middle" x="232.23" y="-4526.35" font-family="Arial" font-size="10.00">Attention Compute</text>
<text text-anchor="middle" x="232.23" y="-4515.35" font-family="Arial" font-size="10.00">[Input: [1,64,2048,128], Output: [1,64,2048,128]]</text>
<text text-anchor="middle" x="232.23" y="-4504.35" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- attn_split_2_s0&#45;&gt;attn_compute_2_s0 -->
<g id="edge25" class="edge">
<title>attn_split_2_s0&#45;&gt;attn_compute_2_s0</title>
<path fill="none" stroke="black" d="M232.23,-4596.25C232.23,-4580.67 232.23,-4563.14 232.23,-4548.71"/>
<polygon fill="black" stroke="black" points="235.73,-4548.37 232.23,-4538.37 228.73,-4548.37 235.73,-4548.37"/>
</g>
<!-- attn_ar_2_s0 -->
<g id="node28" class="node">
<title>attn_ar_2_s0</title>
<ellipse fill="lightyellow" stroke="black" cx="232.23" cy="-4410.36" rx="160.53" ry="28.98"/>
<text text-anchor="middle" x="232.23" y="-4418.86" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="232.23" y="-4407.86" font-family="Arial" font-size="10.00">[Input: [1,64,2048,128], Output: [1,64,2048,128]]</text>
<text text-anchor="middle" x="232.23" y="-4396.86" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- attn_compute_2_s0&#45;&gt;attn_ar_2_s0 -->
<g id="edge26" class="edge">
<title>attn_compute_2_s0&#45;&gt;attn_ar_2_s0</title>
<path fill="none" stroke="black" d="M232.23,-4497.01C232.23,-4483.69 232.23,-4465.72 232.23,-4449.67"/>
<polygon fill="black" stroke="black" points="235.73,-4449.48 232.23,-4439.48 228.73,-4449.48 235.73,-4449.48"/>
</g>
<!-- attn_out_2_s0 -->
<g id="node29" class="node">
<title>attn_out_2_s0</title>
<polygon fill="lightblue" stroke="black" points="337.23,-4323.37 127.23,-4323.37 127.23,-4282.37 337.23,-4282.37 337.23,-4323.37"/>
<text text-anchor="middle" x="232.23" y="-4311.37" font-family="Arial" font-size="10.00">Attention Output Linear</text>
<text text-anchor="middle" x="232.23" y="-4300.37" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-4289.37" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- attn_ar_2_s0&#45;&gt;attn_out_2_s0 -->
<g id="edge27" class="edge">
<title>attn_ar_2_s0&#45;&gt;attn_out_2_s0</title>
<path fill="none" stroke="black" d="M232.23,-4381.37C232.23,-4366.73 232.23,-4348.81 232.23,-4333.88"/>
<polygon fill="black" stroke="black" points="235.73,-4333.64 232.23,-4323.64 228.73,-4333.64 235.73,-4333.64"/>
</g>
<!-- ffn_up_2_s0 -->
<g id="node30" class="node">
<title>ffn_up_2_s0</title>
<polygon fill="lightblue" stroke="black" points="339.73,-4224.37 124.73,-4224.37 124.73,-4183.37 339.73,-4183.37 339.73,-4224.37"/>
<text text-anchor="middle" x="232.23" y="-4212.37" font-family="Arial" font-size="10.00">FFN Up&#45;Projection</text>
<text text-anchor="middle" x="232.23" y="-4201.37" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,28672]]</text>
<text text-anchor="middle" x="232.23" y="-4190.37" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- attn_out_2_s0&#45;&gt;ffn_up_2_s0 -->
<g id="edge28" class="edge">
<title>attn_out_2_s0&#45;&gt;ffn_up_2_s0</title>
<path fill="none" stroke="black" d="M232.23,-4282.24C232.23,-4268.57 232.23,-4250.08 232.23,-4234.61"/>
<polygon fill="black" stroke="black" points="235.73,-4234.47 232.23,-4224.47 228.73,-4234.47 235.73,-4234.47"/>
</g>
<!-- ffn_act_2_s0 -->
<g id="node31" class="node">
<title>ffn_act_2_s0</title>
<polygon fill="lightblue" stroke="black" points="342.73,-4125.37 121.73,-4125.37 121.73,-4084.37 342.73,-4084.37 342.73,-4125.37"/>
<text text-anchor="middle" x="232.23" y="-4113.37" font-family="Arial" font-size="10.00">FFN Activation (SiLU)</text>
<text text-anchor="middle" x="232.23" y="-4102.37" font-family="Arial" font-size="10.00">[Input: [1,2048,28672], Output: [1,2048,28672]]</text>
<text text-anchor="middle" x="232.23" y="-4091.37" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- ffn_up_2_s0&#45;&gt;ffn_act_2_s0 -->
<g id="edge29" class="edge">
<title>ffn_up_2_s0&#45;&gt;ffn_act_2_s0</title>
<path fill="none" stroke="black" d="M232.23,-4183.24C232.23,-4169.57 232.23,-4151.08 232.23,-4135.61"/>
<polygon fill="black" stroke="black" points="235.73,-4135.47 232.23,-4125.47 228.73,-4135.47 235.73,-4135.47"/>
</g>
<!-- ffn_down_2_s0 -->
<g id="node32" class="node">
<title>ffn_down_2_s0</title>
<polygon fill="lightblue" stroke="black" points="339.73,-4026.37 124.73,-4026.37 124.73,-3985.37 339.73,-3985.37 339.73,-4026.37"/>
<text text-anchor="middle" x="232.23" y="-4014.37" font-family="Arial" font-size="10.00">FFN Down&#45;Projection</text>
<text text-anchor="middle" x="232.23" y="-4003.37" font-family="Arial" font-size="10.00">[Input: [1,2048,28672], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-3992.37" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- ffn_act_2_s0&#45;&gt;ffn_down_2_s0 -->
<g id="edge30" class="edge">
<title>ffn_act_2_s0&#45;&gt;ffn_down_2_s0</title>
<path fill="none" stroke="black" d="M232.23,-4084.24C232.23,-4070.57 232.23,-4052.08 232.23,-4036.61"/>
<polygon fill="black" stroke="black" points="235.73,-4036.47 232.23,-4026.47 228.73,-4036.47 235.73,-4036.47"/>
</g>
<!-- ffn_ar_2_s0 -->
<g id="node33" class="node">
<title>ffn_ar_2_s0</title>
<ellipse fill="lightyellow" stroke="black" cx="232.23" cy="-3898.38" rx="148.48" ry="28.98"/>
<text text-anchor="middle" x="232.23" y="-3906.88" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="232.23" y="-3895.88" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-3884.88" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- ffn_down_2_s0&#45;&gt;ffn_ar_2_s0 -->
<g id="edge31" class="edge">
<title>ffn_down_2_s0&#45;&gt;ffn_ar_2_s0</title>
<path fill="none" stroke="black" d="M232.23,-3985.03C232.23,-3971.71 232.23,-3953.74 232.23,-3937.69"/>
<polygon fill="black" stroke="black" points="235.73,-3937.49 232.23,-3927.49 228.73,-3937.49 235.73,-3937.49"/>
</g>
<!-- intermediate_s0 -->
<g id="node34" class="node">
<title>intermediate_s0</title>
<polygon fill="lightgray" stroke="black" points="302.23,-3811.39 156.23,-3811.39 156.23,-3759.39 308.23,-3759.39 308.23,-3805.39 302.23,-3811.39"/>
<polyline fill="none" stroke="black" points="302.23,-3811.39 302.23,-3805.39 "/>
<polyline fill="none" stroke="black" points="308.23,-3805.39 302.23,-3805.39 "/>
<text text-anchor="middle" x="232.23" y="-3799.39" font-family="Times,serif" font-size="10.00">Intermediate Layers 3&#45;38</text>
<text text-anchor="middle" x="232.23" y="-3788.39" font-family="Times,serif" font-size="10.00">[36 transformer layers]</text>
<text text-anchor="middle" x="232.23" y="-3777.39" font-family="Times,serif" font-size="10.00">Same pattern as layers 0&#45;2</text>
<text text-anchor="middle" x="232.23" y="-3766.39" font-family="Times,serif" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- ffn_ar_2_s0&#45;&gt;intermediate_s0 -->
<g id="edge32" class="edge">
<title>ffn_ar_2_s0&#45;&gt;intermediate_s0</title>
<path fill="none" stroke="black" d="M232.23,-3869.37C232.23,-3854.97 232.23,-3837.27 232.23,-3821.91"/>
<polygon fill="black" stroke="black" points="235.73,-3821.73 232.23,-3811.73 228.73,-3821.73 235.73,-3821.73"/>
</g>
<!-- rmsnorm_39_s0 -->
<g id="node35" class="node">
<title>rmsnorm_39_s0</title>
<polygon fill="lightblue" stroke="black" points="337.23,-3701.39 127.23,-3701.39 127.23,-3660.39 337.23,-3660.39 337.23,-3701.39"/>
<text text-anchor="middle" x="232.23" y="-3689.39" font-family="Arial" font-size="10.00">RMSNorm Layer 39</text>
<text text-anchor="middle" x="232.23" y="-3678.39" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-3667.39" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP4)</text>
</g>
<!-- intermediate_s0&#45;&gt;rmsnorm_39_s0 -->
<g id="edge33" class="edge">
<title>intermediate_s0&#45;&gt;rmsnorm_39_s0</title>
<path fill="none" stroke="black" d="M232.23,-3759.31C232.23,-3745.01 232.23,-3726.98 232.23,-3711.92"/>
<polygon fill="black" stroke="black" points="235.73,-3711.57 232.23,-3701.57 228.73,-3711.57 235.73,-3711.57"/>
</g>
<!-- pipe_comm_s0_s1 -->
<g id="node36" class="node">
<title>pipe_comm_s0_s1</title>
<ellipse fill="lightyellow" stroke="black" cx="232.23" cy="-3565.62" rx="148.48" ry="36.54"/>
<text text-anchor="middle" x="232.23" y="-3579.62" font-family="Arial" font-size="10.00">Pipeline Communication</text>
<text text-anchor="middle" x="232.23" y="-3568.62" font-family="Arial" font-size="10.00">Stage 0 → Stage 1</text>
<text text-anchor="middle" x="232.23" y="-3557.62" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-3546.62" font-family="Arial" font-size="10.00">GPU: 0&#45;3 → 4&#45;7</text>
</g>
<!-- rmsnorm_39_s0&#45;&gt;pipe_comm_s0_s1 -->
<g id="edge34" class="edge">
<title>rmsnorm_39_s0&#45;&gt;pipe_comm_s0_s1</title>
<path fill="none" stroke="black" d="M232.23,-3660.16C232.23,-3647.04 232.23,-3629.23 232.23,-3612.68"/>
<polygon fill="black" stroke="black" points="235.73,-3612.58 232.23,-3602.58 228.73,-3612.58 235.73,-3612.58"/>
</g>
<!-- rmsnorm_40_s1 -->
<g id="node38" class="node">
<title>rmsnorm_40_s1</title>
<polygon fill="lightblue" stroke="black" points="337.23,-3470.85 127.23,-3470.85 127.23,-3429.85 337.23,-3429.85 337.23,-3470.85"/>
<text text-anchor="middle" x="232.23" y="-3458.85" font-family="Arial" font-size="10.00">RMSNorm Layer 40</text>
<text text-anchor="middle" x="232.23" y="-3447.85" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-3436.85" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- pipe_comm_s0_s1&#45;&gt;rmsnorm_40_s1 -->
<g id="edge35" class="edge">
<title>pipe_comm_s0_s1&#45;&gt;rmsnorm_40_s1</title>
<path fill="none" stroke="black" d="M232.23,-3528.78C232.23,-3513.45 232.23,-3495.75 232.23,-3481.15"/>
<polygon fill="black" stroke="black" points="235.73,-3481.14 232.23,-3471.14 228.73,-3481.14 235.73,-3481.14"/>
</g>
<!-- stage1_label -->
<g id="node37" class="node">
<title>stage1_label</title>
<path fill="lightgray" stroke="black" d="M772.73,-7220.26C772.73,-7220.26 641.73,-7220.26 641.73,-7220.26 635.73,-7220.26 629.73,-7214.26 629.73,-7208.26 629.73,-7208.26 629.73,-7185.26 629.73,-7185.26 629.73,-7179.26 635.73,-7173.26 641.73,-7173.26 641.73,-7173.26 772.73,-7173.26 772.73,-7173.26 778.73,-7173.26 784.73,-7179.26 784.73,-7185.26 784.73,-7185.26 784.73,-7208.26 784.73,-7208.26 784.73,-7214.26 778.73,-7220.26 772.73,-7220.26"/>
<text text-anchor="middle" x="707.23" y="-7206.66" font-family="Times,serif" font-size="12.00">PIPELINE STAGE 1</text>
<text text-anchor="middle" x="707.23" y="-7193.66" font-family="Times,serif" font-size="12.00">GPUs 4&#45;7 (TP Group 1)</text>
<text text-anchor="middle" x="707.23" y="-7180.66" font-family="Times,serif" font-size="12.00">Layers 40&#45;79</text>
</g>
<!-- qkv_40_s1 -->
<g id="node39" class="node">
<title>qkv_40_s1</title>
<polygon fill="lightblue" stroke="black" points="339.73,-3371.85 124.73,-3371.85 124.73,-3330.85 339.73,-3330.85 339.73,-3371.85"/>
<text text-anchor="middle" x="232.23" y="-3359.85" font-family="Arial" font-size="10.00">QKV Linear Layer 40</text>
<text text-anchor="middle" x="232.23" y="-3348.85" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,12288]]</text>
<text text-anchor="middle" x="232.23" y="-3337.85" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- rmsnorm_40_s1&#45;&gt;qkv_40_s1 -->
<g id="edge36" class="edge">
<title>rmsnorm_40_s1&#45;&gt;qkv_40_s1</title>
<path fill="none" stroke="black" d="M232.23,-3429.72C232.23,-3416.05 232.23,-3397.56 232.23,-3382.08"/>
<polygon fill="black" stroke="black" points="235.73,-3381.95 232.23,-3371.95 228.73,-3381.95 235.73,-3381.95"/>
</g>
<!-- attn_split_40_s1 -->
<g id="node40" class="node">
<title>attn_split_40_s1</title>
<polygon fill="lightgreen" stroke="black" points="464.7,-3272.85 94.9,-3272.85 -0.23,-3190.85 369.57,-3190.85 464.7,-3272.85"/>
<text text-anchor="middle" x="232.23" y="-3240.35" font-family="Arial" font-size="10.00">Attention Head Split</text>
<text text-anchor="middle" x="232.23" y="-3229.35" font-family="Arial" font-size="10.00">[Input: [1,2048,12288], Output: [1,64,2048,128]]</text>
<text text-anchor="middle" x="232.23" y="-3218.35" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- qkv_40_s1&#45;&gt;attn_split_40_s1 -->
<g id="edge37" class="edge">
<title>qkv_40_s1&#45;&gt;attn_split_40_s1</title>
<path fill="none" stroke="black" d="M232.23,-3330.68C232.23,-3317.7 232.23,-3300.05 232.23,-3283.32"/>
<polygon fill="black" stroke="black" points="235.73,-3283.07 232.23,-3273.07 228.73,-3283.07 235.73,-3283.07"/>
</g>
<!-- attn_compute_40_s1 -->
<g id="node41" class="node">
<title>attn_compute_40_s1</title>
<polygon fill="lightblue" stroke="black" points="345.73,-3132.85 118.73,-3132.85 118.73,-3091.85 345.73,-3091.85 345.73,-3132.85"/>
<text text-anchor="middle" x="232.23" y="-3120.85" font-family="Arial" font-size="10.00">Attention Compute</text>
<text text-anchor="middle" x="232.23" y="-3109.85" font-family="Arial" font-size="10.00">[Input: [1,64,2048,128], Output: [1,64,2048,128]]</text>
<text text-anchor="middle" x="232.23" y="-3098.85" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- attn_split_40_s1&#45;&gt;attn_compute_40_s1 -->
<g id="edge38" class="edge">
<title>attn_split_40_s1&#45;&gt;attn_compute_40_s1</title>
<path fill="none" stroke="black" d="M232.23,-3190.74C232.23,-3175.17 232.23,-3157.64 232.23,-3143.21"/>
<polygon fill="black" stroke="black" points="235.73,-3142.86 232.23,-3132.86 228.73,-3142.86 235.73,-3142.86"/>
</g>
<!-- attn_ar_40_s1 -->
<g id="node42" class="node">
<title>attn_ar_40_s1</title>
<ellipse fill="lightyellow" stroke="black" cx="232.23" cy="-3004.86" rx="160.53" ry="28.98"/>
<text text-anchor="middle" x="232.23" y="-3013.36" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="232.23" y="-3002.36" font-family="Arial" font-size="10.00">[Input: [1,64,2048,128], Output: [1,64,2048,128]]</text>
<text text-anchor="middle" x="232.23" y="-2991.36" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- attn_compute_40_s1&#45;&gt;attn_ar_40_s1 -->
<g id="edge39" class="edge">
<title>attn_compute_40_s1&#45;&gt;attn_ar_40_s1</title>
<path fill="none" stroke="black" d="M232.23,-3091.51C232.23,-3078.19 232.23,-3060.21 232.23,-3044.17"/>
<polygon fill="black" stroke="black" points="235.73,-3043.97 232.23,-3033.97 228.73,-3043.97 235.73,-3043.97"/>
</g>
<!-- attn_out_40_s1 -->
<g id="node43" class="node">
<title>attn_out_40_s1</title>
<polygon fill="lightblue" stroke="black" points="337.23,-2917.87 127.23,-2917.87 127.23,-2876.87 337.23,-2876.87 337.23,-2917.87"/>
<text text-anchor="middle" x="232.23" y="-2905.87" font-family="Arial" font-size="10.00">Attention Output Linear</text>
<text text-anchor="middle" x="232.23" y="-2894.87" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-2883.87" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- attn_ar_40_s1&#45;&gt;attn_out_40_s1 -->
<g id="edge40" class="edge">
<title>attn_ar_40_s1&#45;&gt;attn_out_40_s1</title>
<path fill="none" stroke="black" d="M232.23,-2975.87C232.23,-2961.23 232.23,-2943.3 232.23,-2928.38"/>
<polygon fill="black" stroke="black" points="235.73,-2928.13 232.23,-2918.13 228.73,-2928.13 235.73,-2928.13"/>
</g>
<!-- ffn_up_40_s1 -->
<g id="node44" class="node">
<title>ffn_up_40_s1</title>
<polygon fill="lightblue" stroke="black" points="339.73,-2818.87 124.73,-2818.87 124.73,-2777.87 339.73,-2777.87 339.73,-2818.87"/>
<text text-anchor="middle" x="232.23" y="-2806.87" font-family="Arial" font-size="10.00">FFN Up&#45;Projection</text>
<text text-anchor="middle" x="232.23" y="-2795.87" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,28672]]</text>
<text text-anchor="middle" x="232.23" y="-2784.87" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- attn_out_40_s1&#45;&gt;ffn_up_40_s1 -->
<g id="edge41" class="edge">
<title>attn_out_40_s1&#45;&gt;ffn_up_40_s1</title>
<path fill="none" stroke="black" d="M232.23,-2876.74C232.23,-2863.06 232.23,-2844.58 232.23,-2829.1"/>
<polygon fill="black" stroke="black" points="235.73,-2828.97 232.23,-2818.97 228.73,-2828.97 235.73,-2828.97"/>
</g>
<!-- ffn_act_40_s1 -->
<g id="node45" class="node">
<title>ffn_act_40_s1</title>
<polygon fill="lightblue" stroke="black" points="342.73,-2719.87 121.73,-2719.87 121.73,-2678.87 342.73,-2678.87 342.73,-2719.87"/>
<text text-anchor="middle" x="232.23" y="-2707.87" font-family="Arial" font-size="10.00">FFN Activation (SiLU)</text>
<text text-anchor="middle" x="232.23" y="-2696.87" font-family="Arial" font-size="10.00">[Input: [1,2048,28672], Output: [1,2048,28672]]</text>
<text text-anchor="middle" x="232.23" y="-2685.87" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- ffn_up_40_s1&#45;&gt;ffn_act_40_s1 -->
<g id="edge42" class="edge">
<title>ffn_up_40_s1&#45;&gt;ffn_act_40_s1</title>
<path fill="none" stroke="black" d="M232.23,-2777.74C232.23,-2764.06 232.23,-2745.58 232.23,-2730.1"/>
<polygon fill="black" stroke="black" points="235.73,-2729.97 232.23,-2719.97 228.73,-2729.97 235.73,-2729.97"/>
</g>
<!-- ffn_down_40_s1 -->
<g id="node46" class="node">
<title>ffn_down_40_s1</title>
<polygon fill="lightblue" stroke="black" points="339.73,-2620.87 124.73,-2620.87 124.73,-2579.87 339.73,-2579.87 339.73,-2620.87"/>
<text text-anchor="middle" x="232.23" y="-2608.87" font-family="Arial" font-size="10.00">FFN Down&#45;Projection</text>
<text text-anchor="middle" x="232.23" y="-2597.87" font-family="Arial" font-size="10.00">[Input: [1,2048,28672], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-2586.87" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- ffn_act_40_s1&#45;&gt;ffn_down_40_s1 -->
<g id="edge43" class="edge">
<title>ffn_act_40_s1&#45;&gt;ffn_down_40_s1</title>
<path fill="none" stroke="black" d="M232.23,-2678.74C232.23,-2665.06 232.23,-2646.58 232.23,-2631.1"/>
<polygon fill="black" stroke="black" points="235.73,-2630.97 232.23,-2620.97 228.73,-2630.97 235.73,-2630.97"/>
</g>
<!-- ffn_ar_40_s1 -->
<g id="node47" class="node">
<title>ffn_ar_40_s1</title>
<ellipse fill="lightyellow" stroke="black" cx="232.23" cy="-2492.88" rx="148.48" ry="28.98"/>
<text text-anchor="middle" x="232.23" y="-2501.38" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="232.23" y="-2490.38" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-2479.38" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- ffn_down_40_s1&#45;&gt;ffn_ar_40_s1 -->
<g id="edge44" class="edge">
<title>ffn_down_40_s1&#45;&gt;ffn_ar_40_s1</title>
<path fill="none" stroke="black" d="M232.23,-2579.52C232.23,-2566.21 232.23,-2548.23 232.23,-2532.19"/>
<polygon fill="black" stroke="black" points="235.73,-2531.99 232.23,-2521.99 228.73,-2531.99 235.73,-2531.99"/>
</g>
<!-- rmsnorm_41_s1 -->
<g id="node48" class="node">
<title>rmsnorm_41_s1</title>
<polygon fill="lightblue" stroke="black" points="337.23,-2405.88 127.23,-2405.88 127.23,-2364.88 337.23,-2364.88 337.23,-2405.88"/>
<text text-anchor="middle" x="232.23" y="-2393.88" font-family="Arial" font-size="10.00">RMSNorm Layer 41</text>
<text text-anchor="middle" x="232.23" y="-2382.88" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-2371.88" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- ffn_ar_40_s1&#45;&gt;rmsnorm_41_s1 -->
<g id="edge45" class="edge">
<title>ffn_ar_40_s1&#45;&gt;rmsnorm_41_s1</title>
<path fill="none" stroke="black" d="M232.23,-2463.88C232.23,-2449.25 232.23,-2431.32 232.23,-2416.4"/>
<polygon fill="black" stroke="black" points="235.73,-2416.15 232.23,-2406.15 228.73,-2416.15 235.73,-2416.15"/>
</g>
<!-- qkv_41_s1 -->
<g id="node49" class="node">
<title>qkv_41_s1</title>
<polygon fill="lightblue" stroke="black" points="339.73,-2306.88 124.73,-2306.88 124.73,-2265.88 339.73,-2265.88 339.73,-2306.88"/>
<text text-anchor="middle" x="232.23" y="-2294.88" font-family="Arial" font-size="10.00">QKV Linear Layer 41</text>
<text text-anchor="middle" x="232.23" y="-2283.88" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,12288]]</text>
<text text-anchor="middle" x="232.23" y="-2272.88" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- rmsnorm_41_s1&#45;&gt;qkv_41_s1 -->
<g id="edge46" class="edge">
<title>rmsnorm_41_s1&#45;&gt;qkv_41_s1</title>
<path fill="none" stroke="black" d="M232.23,-2364.75C232.23,-2351.08 232.23,-2332.59 232.23,-2317.12"/>
<polygon fill="black" stroke="black" points="235.73,-2316.98 232.23,-2306.98 228.73,-2316.98 235.73,-2316.98"/>
</g>
<!-- attn_split_41_s1 -->
<g id="node50" class="node">
<title>attn_split_41_s1</title>
<polygon fill="lightgreen" stroke="black" points="464.7,-2207.88 94.9,-2207.88 -0.23,-2125.88 369.57,-2125.88 464.7,-2207.88"/>
<text text-anchor="middle" x="232.23" y="-2175.38" font-family="Arial" font-size="10.00">Attention Head Split</text>
<text text-anchor="middle" x="232.23" y="-2164.38" font-family="Arial" font-size="10.00">[Input: [1,2048,12288], Output: [1,64,2048,128]]</text>
<text text-anchor="middle" x="232.23" y="-2153.38" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- qkv_41_s1&#45;&gt;attn_split_41_s1 -->
<g id="edge47" class="edge">
<title>qkv_41_s1&#45;&gt;attn_split_41_s1</title>
<path fill="none" stroke="black" d="M232.23,-2265.72C232.23,-2252.73 232.23,-2235.09 232.23,-2218.35"/>
<polygon fill="black" stroke="black" points="235.73,-2218.1 232.23,-2208.1 228.73,-2218.1 235.73,-2218.1"/>
</g>
<!-- attn_compute_41_s1 -->
<g id="node51" class="node">
<title>attn_compute_41_s1</title>
<polygon fill="lightblue" stroke="black" points="345.73,-2067.88 118.73,-2067.88 118.73,-2026.88 345.73,-2026.88 345.73,-2067.88"/>
<text text-anchor="middle" x="232.23" y="-2055.88" font-family="Arial" font-size="10.00">Attention Compute</text>
<text text-anchor="middle" x="232.23" y="-2044.88" font-family="Arial" font-size="10.00">[Input: [1,64,2048,128], Output: [1,64,2048,128]]</text>
<text text-anchor="middle" x="232.23" y="-2033.88" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- attn_split_41_s1&#45;&gt;attn_compute_41_s1 -->
<g id="edge48" class="edge">
<title>attn_split_41_s1&#45;&gt;attn_compute_41_s1</title>
<path fill="none" stroke="black" d="M232.23,-2125.78C232.23,-2110.2 232.23,-2092.67 232.23,-2078.24"/>
<polygon fill="black" stroke="black" points="235.73,-2077.9 232.23,-2067.9 228.73,-2077.9 235.73,-2077.9"/>
</g>
<!-- attn_ar_41_s1 -->
<g id="node52" class="node">
<title>attn_ar_41_s1</title>
<ellipse fill="lightyellow" stroke="black" cx="232.23" cy="-1939.89" rx="160.53" ry="28.98"/>
<text text-anchor="middle" x="232.23" y="-1948.39" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="232.23" y="-1937.39" font-family="Arial" font-size="10.00">[Input: [1,64,2048,128], Output: [1,64,2048,128]]</text>
<text text-anchor="middle" x="232.23" y="-1926.39" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- attn_compute_41_s1&#45;&gt;attn_ar_41_s1 -->
<g id="edge49" class="edge">
<title>attn_compute_41_s1&#45;&gt;attn_ar_41_s1</title>
<path fill="none" stroke="black" d="M232.23,-2026.54C232.23,-2013.22 232.23,-1995.25 232.23,-1979.2"/>
<polygon fill="black" stroke="black" points="235.73,-1979.01 232.23,-1969.01 228.73,-1979.01 235.73,-1979.01"/>
</g>
<!-- attn_out_41_s1 -->
<g id="node53" class="node">
<title>attn_out_41_s1</title>
<polygon fill="lightblue" stroke="black" points="337.23,-1852.9 127.23,-1852.9 127.23,-1811.9 337.23,-1811.9 337.23,-1852.9"/>
<text text-anchor="middle" x="232.23" y="-1840.9" font-family="Arial" font-size="10.00">Attention Output Linear</text>
<text text-anchor="middle" x="232.23" y="-1829.9" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-1818.9" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- attn_ar_41_s1&#45;&gt;attn_out_41_s1 -->
<g id="edge50" class="edge">
<title>attn_ar_41_s1&#45;&gt;attn_out_41_s1</title>
<path fill="none" stroke="black" d="M232.23,-1910.9C232.23,-1896.26 232.23,-1878.34 232.23,-1863.41"/>
<polygon fill="black" stroke="black" points="235.73,-1863.17 232.23,-1853.17 228.73,-1863.17 235.73,-1863.17"/>
</g>
<!-- ffn_up_41_s1 -->
<g id="node54" class="node">
<title>ffn_up_41_s1</title>
<polygon fill="lightblue" stroke="black" points="339.73,-1753.9 124.73,-1753.9 124.73,-1712.9 339.73,-1712.9 339.73,-1753.9"/>
<text text-anchor="middle" x="232.23" y="-1741.9" font-family="Arial" font-size="10.00">FFN Up&#45;Projection</text>
<text text-anchor="middle" x="232.23" y="-1730.9" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,28672]]</text>
<text text-anchor="middle" x="232.23" y="-1719.9" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- attn_out_41_s1&#45;&gt;ffn_up_41_s1 -->
<g id="edge51" class="edge">
<title>attn_out_41_s1&#45;&gt;ffn_up_41_s1</title>
<path fill="none" stroke="black" d="M232.23,-1811.77C232.23,-1798.1 232.23,-1779.61 232.23,-1764.14"/>
<polygon fill="black" stroke="black" points="235.73,-1764 232.23,-1754 228.73,-1764 235.73,-1764"/>
</g>
<!-- ffn_act_41_s1 -->
<g id="node55" class="node">
<title>ffn_act_41_s1</title>
<polygon fill="lightblue" stroke="black" points="342.73,-1654.9 121.73,-1654.9 121.73,-1613.9 342.73,-1613.9 342.73,-1654.9"/>
<text text-anchor="middle" x="232.23" y="-1642.9" font-family="Arial" font-size="10.00">FFN Activation (SiLU)</text>
<text text-anchor="middle" x="232.23" y="-1631.9" font-family="Arial" font-size="10.00">[Input: [1,2048,28672], Output: [1,2048,28672]]</text>
<text text-anchor="middle" x="232.23" y="-1620.9" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- ffn_up_41_s1&#45;&gt;ffn_act_41_s1 -->
<g id="edge52" class="edge">
<title>ffn_up_41_s1&#45;&gt;ffn_act_41_s1</title>
<path fill="none" stroke="black" d="M232.23,-1712.77C232.23,-1699.1 232.23,-1680.61 232.23,-1665.14"/>
<polygon fill="black" stroke="black" points="235.73,-1665 232.23,-1655 228.73,-1665 235.73,-1665"/>
</g>
<!-- ffn_down_41_s1 -->
<g id="node56" class="node">
<title>ffn_down_41_s1</title>
<polygon fill="lightblue" stroke="black" points="339.73,-1555.9 124.73,-1555.9 124.73,-1514.9 339.73,-1514.9 339.73,-1555.9"/>
<text text-anchor="middle" x="232.23" y="-1543.9" font-family="Arial" font-size="10.00">FFN Down&#45;Projection</text>
<text text-anchor="middle" x="232.23" y="-1532.9" font-family="Arial" font-size="10.00">[Input: [1,2048,28672], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-1521.9" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- ffn_act_41_s1&#45;&gt;ffn_down_41_s1 -->
<g id="edge53" class="edge">
<title>ffn_act_41_s1&#45;&gt;ffn_down_41_s1</title>
<path fill="none" stroke="black" d="M232.23,-1613.77C232.23,-1600.1 232.23,-1581.61 232.23,-1566.14"/>
<polygon fill="black" stroke="black" points="235.73,-1566 232.23,-1556 228.73,-1566 235.73,-1566"/>
</g>
<!-- ffn_ar_41_s1 -->
<g id="node57" class="node">
<title>ffn_ar_41_s1</title>
<ellipse fill="lightyellow" stroke="black" cx="232.23" cy="-1427.91" rx="148.48" ry="28.98"/>
<text text-anchor="middle" x="232.23" y="-1436.41" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="232.23" y="-1425.41" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-1414.41" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- ffn_down_41_s1&#45;&gt;ffn_ar_41_s1 -->
<g id="edge54" class="edge">
<title>ffn_down_41_s1&#45;&gt;ffn_ar_41_s1</title>
<path fill="none" stroke="black" d="M232.23,-1514.56C232.23,-1501.24 232.23,-1483.27 232.23,-1467.22"/>
<polygon fill="black" stroke="black" points="235.73,-1467.02 232.23,-1457.02 228.73,-1467.02 235.73,-1467.02"/>
</g>
<!-- rmsnorm_42_s1 -->
<g id="node58" class="node">
<title>rmsnorm_42_s1</title>
<polygon fill="lightblue" stroke="black" points="337.23,-1340.92 127.23,-1340.92 127.23,-1299.92 337.23,-1299.92 337.23,-1340.92"/>
<text text-anchor="middle" x="232.23" y="-1328.92" font-family="Arial" font-size="10.00">RMSNorm Layer 42</text>
<text text-anchor="middle" x="232.23" y="-1317.92" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-1306.92" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- ffn_ar_41_s1&#45;&gt;rmsnorm_42_s1 -->
<g id="edge55" class="edge">
<title>ffn_ar_41_s1&#45;&gt;rmsnorm_42_s1</title>
<path fill="none" stroke="black" d="M232.23,-1398.92C232.23,-1384.28 232.23,-1366.35 232.23,-1351.43"/>
<polygon fill="black" stroke="black" points="235.73,-1351.18 232.23,-1341.18 228.73,-1351.18 235.73,-1351.18"/>
</g>
<!-- qkv_42_s1 -->
<g id="node59" class="node">
<title>qkv_42_s1</title>
<polygon fill="lightblue" stroke="black" points="339.73,-1241.92 124.73,-1241.92 124.73,-1200.92 339.73,-1200.92 339.73,-1241.92"/>
<text text-anchor="middle" x="232.23" y="-1229.92" font-family="Arial" font-size="10.00">QKV Linear Layer 42</text>
<text text-anchor="middle" x="232.23" y="-1218.92" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,12288]]</text>
<text text-anchor="middle" x="232.23" y="-1207.92" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- rmsnorm_42_s1&#45;&gt;qkv_42_s1 -->
<g id="edge56" class="edge">
<title>rmsnorm_42_s1&#45;&gt;qkv_42_s1</title>
<path fill="none" stroke="black" d="M232.23,-1299.79C232.23,-1286.12 232.23,-1267.63 232.23,-1252.15"/>
<polygon fill="black" stroke="black" points="235.73,-1252.02 232.23,-1242.02 228.73,-1252.02 235.73,-1252.02"/>
</g>
<!-- attn_split_42_s1 -->
<g id="node60" class="node">
<title>attn_split_42_s1</title>
<polygon fill="lightgreen" stroke="black" points="464.7,-1142.92 94.9,-1142.92 -0.23,-1060.92 369.57,-1060.92 464.7,-1142.92"/>
<text text-anchor="middle" x="232.23" y="-1110.42" font-family="Arial" font-size="10.00">Attention Head Split</text>
<text text-anchor="middle" x="232.23" y="-1099.42" font-family="Arial" font-size="10.00">[Input: [1,2048,12288], Output: [1,64,2048,128]]</text>
<text text-anchor="middle" x="232.23" y="-1088.42" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- qkv_42_s1&#45;&gt;attn_split_42_s1 -->
<g id="edge57" class="edge">
<title>qkv_42_s1&#45;&gt;attn_split_42_s1</title>
<path fill="none" stroke="black" d="M232.23,-1200.75C232.23,-1187.77 232.23,-1170.12 232.23,-1153.39"/>
<polygon fill="black" stroke="black" points="235.73,-1153.14 232.23,-1143.14 228.73,-1153.14 235.73,-1153.14"/>
</g>
<!-- attn_compute_42_s1 -->
<g id="node61" class="node">
<title>attn_compute_42_s1</title>
<polygon fill="lightblue" stroke="black" points="345.73,-1002.92 118.73,-1002.92 118.73,-961.92 345.73,-961.92 345.73,-1002.92"/>
<text text-anchor="middle" x="232.23" y="-990.92" font-family="Arial" font-size="10.00">Attention Compute</text>
<text text-anchor="middle" x="232.23" y="-979.92" font-family="Arial" font-size="10.00">[Input: [1,64,2048,128], Output: [1,64,2048,128]]</text>
<text text-anchor="middle" x="232.23" y="-968.92" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- attn_split_42_s1&#45;&gt;attn_compute_42_s1 -->
<g id="edge58" class="edge">
<title>attn_split_42_s1&#45;&gt;attn_compute_42_s1</title>
<path fill="none" stroke="black" d="M232.23,-1060.81C232.23,-1045.23 232.23,-1027.71 232.23,-1013.28"/>
<polygon fill="black" stroke="black" points="235.73,-1012.93 232.23,-1002.93 228.73,-1012.93 235.73,-1012.93"/>
</g>
<!-- attn_ar_42_s1 -->
<g id="node62" class="node">
<title>attn_ar_42_s1</title>
<ellipse fill="lightyellow" stroke="black" cx="232.23" cy="-874.93" rx="160.53" ry="28.98"/>
<text text-anchor="middle" x="232.23" y="-883.43" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="232.23" y="-872.43" font-family="Arial" font-size="10.00">[Input: [1,64,2048,128], Output: [1,64,2048,128]]</text>
<text text-anchor="middle" x="232.23" y="-861.43" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- attn_compute_42_s1&#45;&gt;attn_ar_42_s1 -->
<g id="edge59" class="edge">
<title>attn_compute_42_s1&#45;&gt;attn_ar_42_s1</title>
<path fill="none" stroke="black" d="M232.23,-961.58C232.23,-948.26 232.23,-930.28 232.23,-914.24"/>
<polygon fill="black" stroke="black" points="235.73,-914.04 232.23,-904.04 228.73,-914.04 235.73,-914.04"/>
</g>
<!-- attn_out_42_s1 -->
<g id="node63" class="node">
<title>attn_out_42_s1</title>
<polygon fill="lightblue" stroke="black" points="337.23,-787.94 127.23,-787.94 127.23,-746.94 337.23,-746.94 337.23,-787.94"/>
<text text-anchor="middle" x="232.23" y="-775.94" font-family="Arial" font-size="10.00">Attention Output Linear</text>
<text text-anchor="middle" x="232.23" y="-764.94" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-753.94" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- attn_ar_42_s1&#45;&gt;attn_out_42_s1 -->
<g id="edge60" class="edge">
<title>attn_ar_42_s1&#45;&gt;attn_out_42_s1</title>
<path fill="none" stroke="black" d="M232.23,-845.93C232.23,-831.3 232.23,-813.37 232.23,-798.45"/>
<polygon fill="black" stroke="black" points="235.73,-798.2 232.23,-788.2 228.73,-798.2 235.73,-798.2"/>
</g>
<!-- ffn_up_42_s1 -->
<g id="node64" class="node">
<title>ffn_up_42_s1</title>
<polygon fill="lightblue" stroke="black" points="339.73,-688.94 124.73,-688.94 124.73,-647.94 339.73,-647.94 339.73,-688.94"/>
<text text-anchor="middle" x="232.23" y="-676.94" font-family="Arial" font-size="10.00">FFN Up&#45;Projection</text>
<text text-anchor="middle" x="232.23" y="-665.94" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,28672]]</text>
<text text-anchor="middle" x="232.23" y="-654.94" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- attn_out_42_s1&#45;&gt;ffn_up_42_s1 -->
<g id="edge61" class="edge">
<title>attn_out_42_s1&#45;&gt;ffn_up_42_s1</title>
<path fill="none" stroke="black" d="M232.23,-746.81C232.23,-733.13 232.23,-714.65 232.23,-699.17"/>
<polygon fill="black" stroke="black" points="235.73,-699.04 232.23,-689.04 228.73,-699.04 235.73,-699.04"/>
</g>
<!-- ffn_act_42_s1 -->
<g id="node65" class="node">
<title>ffn_act_42_s1</title>
<polygon fill="lightblue" stroke="black" points="342.73,-589.94 121.73,-589.94 121.73,-548.94 342.73,-548.94 342.73,-589.94"/>
<text text-anchor="middle" x="232.23" y="-577.94" font-family="Arial" font-size="10.00">FFN Activation (SiLU)</text>
<text text-anchor="middle" x="232.23" y="-566.94" font-family="Arial" font-size="10.00">[Input: [1,2048,28672], Output: [1,2048,28672]]</text>
<text text-anchor="middle" x="232.23" y="-555.94" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- ffn_up_42_s1&#45;&gt;ffn_act_42_s1 -->
<g id="edge62" class="edge">
<title>ffn_up_42_s1&#45;&gt;ffn_act_42_s1</title>
<path fill="none" stroke="black" d="M232.23,-647.81C232.23,-634.13 232.23,-615.65 232.23,-600.17"/>
<polygon fill="black" stroke="black" points="235.73,-600.04 232.23,-590.04 228.73,-600.04 235.73,-600.04"/>
</g>
<!-- ffn_down_42_s1 -->
<g id="node66" class="node">
<title>ffn_down_42_s1</title>
<polygon fill="lightblue" stroke="black" points="339.73,-490.94 124.73,-490.94 124.73,-449.94 339.73,-449.94 339.73,-490.94"/>
<text text-anchor="middle" x="232.23" y="-478.94" font-family="Arial" font-size="10.00">FFN Down&#45;Projection</text>
<text text-anchor="middle" x="232.23" y="-467.94" font-family="Arial" font-size="10.00">[Input: [1,2048,28672], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-456.94" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- ffn_act_42_s1&#45;&gt;ffn_down_42_s1 -->
<g id="edge63" class="edge">
<title>ffn_act_42_s1&#45;&gt;ffn_down_42_s1</title>
<path fill="none" stroke="black" d="M232.23,-548.81C232.23,-535.13 232.23,-516.65 232.23,-501.17"/>
<polygon fill="black" stroke="black" points="235.73,-501.04 232.23,-491.04 228.73,-501.04 235.73,-501.04"/>
</g>
<!-- ffn_ar_42_s1 -->
<g id="node67" class="node">
<title>ffn_ar_42_s1</title>
<ellipse fill="lightyellow" stroke="black" cx="232.23" cy="-362.94" rx="148.48" ry="28.98"/>
<text text-anchor="middle" x="232.23" y="-371.44" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="232.23" y="-360.44" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-349.44" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- ffn_down_42_s1&#45;&gt;ffn_ar_42_s1 -->
<g id="edge64" class="edge">
<title>ffn_down_42_s1&#45;&gt;ffn_ar_42_s1</title>
<path fill="none" stroke="black" d="M232.23,-449.59C232.23,-436.28 232.23,-418.3 232.23,-402.25"/>
<polygon fill="black" stroke="black" points="235.73,-402.06 232.23,-392.06 228.73,-402.06 235.73,-402.06"/>
</g>
<!-- intermediate_s1 -->
<g id="node68" class="node">
<title>intermediate_s1</title>
<polygon fill="lightgray" stroke="black" points="308.23,-275.95 150.23,-275.95 150.23,-223.95 314.23,-223.95 314.23,-269.95 308.23,-275.95"/>
<polyline fill="none" stroke="black" points="308.23,-275.95 308.23,-269.95 "/>
<polyline fill="none" stroke="black" points="314.23,-269.95 308.23,-269.95 "/>
<text text-anchor="middle" x="232.23" y="-263.95" font-family="Times,serif" font-size="10.00">Intermediate Layers 43&#45;78</text>
<text text-anchor="middle" x="232.23" y="-252.95" font-family="Times,serif" font-size="10.00">[36 transformer layers]</text>
<text text-anchor="middle" x="232.23" y="-241.95" font-family="Times,serif" font-size="10.00">Same pattern as layers 40&#45;42</text>
<text text-anchor="middle" x="232.23" y="-230.95" font-family="Times,serif" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- ffn_ar_42_s1&#45;&gt;intermediate_s1 -->
<g id="edge65" class="edge">
<title>ffn_ar_42_s1&#45;&gt;intermediate_s1</title>
<path fill="none" stroke="black" d="M232.23,-333.94C232.23,-319.54 232.23,-301.83 232.23,-286.48"/>
<polygon fill="black" stroke="black" points="235.73,-286.29 232.23,-276.29 228.73,-286.29 235.73,-286.29"/>
</g>
<!-- rmsnorm_79_s1 -->
<g id="node69" class="node">
<title>rmsnorm_79_s1</title>
<polygon fill="lightblue" stroke="black" points="337.23,-165.95 127.23,-165.95 127.23,-124.95 337.23,-124.95 337.23,-165.95"/>
<text text-anchor="middle" x="232.23" y="-153.95" font-family="Arial" font-size="10.00">RMSNorm Layer 79</text>
<text text-anchor="middle" x="232.23" y="-142.95" font-family="Arial" font-size="10.00">[Input: [1,2048,8192], Output: [1,2048,8192]]</text>
<text text-anchor="middle" x="232.23" y="-131.95" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- intermediate_s1&#45;&gt;rmsnorm_79_s1 -->
<g id="edge66" class="edge">
<title>intermediate_s1&#45;&gt;rmsnorm_79_s1</title>
<path fill="none" stroke="black" d="M232.23,-223.88C232.23,-209.57 232.23,-191.54 232.23,-176.48"/>
<polygon fill="black" stroke="black" points="235.73,-176.14 232.23,-166.14 228.73,-176.14 235.73,-176.14"/>
</g>
<!-- output -->
<g id="node70" class="node">
<title>output</title>
<polygon fill="lightcoral" stroke="black" points="403.03,-33.48 317.63,-66.93 146.83,-66.93 61.44,-33.48 146.83,-0.02 317.63,-0.02 403.03,-33.48"/>
<text text-anchor="middle" x="232.23" y="-41.98" font-family="Arial" font-size="10.00">OUTPUT</text>
<text text-anchor="middle" x="232.23" y="-30.98" font-family="Arial" font-size="10.00">[batch_size=1, seq_len=2048, hidden=8192]</text>
<text text-anchor="middle" x="232.23" y="-19.98" font-family="Arial" font-size="10.00">GPU: 4&#45;7 (TP4)</text>
</g>
<!-- rmsnorm_79_s1&#45;&gt;output -->
<g id="edge67" class="edge">
<title>rmsnorm_79_s1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M232.23,-124.79C232.23,-111.72 232.23,-94.02 232.23,-77.75"/>
<polygon fill="black" stroke="black" points="235.73,-77.34 232.23,-67.34 228.73,-77.34 235.73,-77.34"/>
</g>
</g>
</svg>
