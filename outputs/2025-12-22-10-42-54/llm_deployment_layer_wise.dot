digraph {
	graph [bb="0,0,244.08,3031.1",
		rankdir=TB,
		size="16,20"
	];
	node [label="\N",
		shape=box,
		style="rounded,filled"
	];
	layer_0	[fillcolor=lightyellow,
		height=1.9868,
		label="Layer 0\nMoE Layer\nPP Stage 0\n64 Experts (EP64)\nTP8 Parallel",
		pos="122.04,2959.6",
		shape=tripleoctagon,
		width=3.39];
	layer_1	[fillcolor=lightcoral,
		height=1.5568,
		label="Layer 1\nDense Layer\nPP Stage 0\nTP8 Parallel",
		pos="122.04,2766",
		shape=doubleoctagon,
		width=2.3647];
	layer_0 -> layer_1	[label="Layer\nOutput",
		lp="147.54,2855.1",
		pos="e,122.04,2822.3 122.04,2887.8 122.04,2869.7 122.04,2850.4 122.04,2832.5"];
	layer_2	[fillcolor=lightyellow,
		height=1.9868,
		label="Layer 2\nMoE Layer\nPP Stage 0\n64 Experts (EP64)\nTP8 Parallel",
		pos="122.04,2572.5",
		shape=tripleoctagon,
		width=3.39];
	layer_1 -> layer_2	[label="Layer\nOutput",
		lp="147.54,2677",
		pos="e,122.04,2644.3 122.04,2709.9 122.04,2692.5 122.04,2673 122.04,2654.3"];
	layer_3	[fillcolor=lightcoral,
		height=1.5568,
		label="Layer 3\nDense Layer\nPP Stage 0\nTP8 Parallel",
		pos="122.04,2378.9",
		shape=doubleoctagon,
		width=2.3647];
	layer_2 -> layer_3	[label="Layer\nOutput",
		lp="147.54,2467.9",
		pos="e,122.04,2435.1 122.04,2500.7 122.04,2482.6 122.04,2463.2 122.04,2445.4"];
	layer_4	[fillcolor=lightyellow,
		height=1.9868,
		label="Layer 4\nMoE Layer\nPP Stage 0\n64 Experts (EP64)\nTP8 Parallel",
		pos="122.04,2185.3",
		shape=tripleoctagon,
		width=3.39];
	layer_3 -> layer_4	[label="Layer\nOutput",
		lp="147.54,2289.8",
		pos="e,122.04,2257.2 122.04,2322.7 122.04,2305.4 122.04,2285.9 122.04,2267.2"];
	layer_5	[fillcolor=lightcoral,
		height=1.5568,
		label="Layer 5\nDense Layer\nPP Stage 0\nTP8 Parallel",
		pos="122.04,1991.7",
		shape=doubleoctagon,
		width=2.3647];
	layer_4 -> layer_5	[label="Layer\nOutput",
		lp="147.54,2080.8",
		pos="e,122.04,2048 122.04,2113.5 122.04,2095.4 122.04,2076.1 122.04,2058.3"];
	layer_6	[fillcolor=lightyellow,
		height=1.9868,
		label="Layer 6\nMoE Layer\nPP Stage 0\n64 Experts (EP64)\nTP8 Parallel",
		pos="122.04,1798.2",
		shape=tripleoctagon,
		width=3.39];
	layer_5 -> layer_6	[label="Layer\nOutput",
		lp="147.54,1902.7",
		pos="e,122.04,1870 122.04,1935.6 122.04,1918.3 122.04,1898.7 122.04,1880"];
	layer_7	[fillcolor=lightcoral,
		height=1.5568,
		label="Layer 7\nDense Layer\nPP Stage 0\nTP8 Parallel",
		pos="122.04,1604.6",
		shape=doubleoctagon,
		width=2.3647];
	layer_6 -> layer_7	[label="Layer\nOutput",
		lp="147.54,1693.7",
		pos="e,122.04,1660.8 122.04,1726.4 122.04,1708.3 122.04,1688.9 122.04,1671.1"];
	layer_8	[fillcolor=lightyellow,
		height=1.9868,
		label="Layer 8\nMoE Layer\nPP Stage 1\n64 Experts (EP64)\nTP8 Parallel",
		pos="122.04,1411",
		shape=tripleoctagon,
		width=3.39];
	layer_7 -> layer_8	[color=green,
		label="Pipeline\nCommunication",
		lp="178.04,1515.6",
		penwidth=2,
		pos="e,122.04,1482.9 122.04,1548.5 122.04,1531.1 122.04,1511.6 122.04,1492.9",
		style=dashed];
	layer_9	[fillcolor=lightcoral,
		height=1.5568,
		label="Layer 9\nDense Layer\nPP Stage 1\nTP8 Parallel",
		pos="122.04,1217.5",
		shape=doubleoctagon,
		width=2.3647];
	layer_8 -> layer_9	[label="Layer\nOutput",
		lp="147.54,1306.5",
		pos="e,122.04,1273.7 122.04,1339.2 122.04,1321.2 122.04,1301.8 122.04,1284"];
	layer_10	[fillcolor=lightyellow,
		height=1.9868,
		label="Layer 10\nMoE Layer\nPP Stage 1\n64 Experts (EP64)\nTP8 Parallel",
		pos="122.04,1023.9",
		shape=tripleoctagon,
		width=3.39];
	layer_9 -> layer_10	[label="Layer\nOutput",
		lp="147.54,1128.4",
		pos="e,122.04,1095.7 122.04,1161.3 122.04,1144 122.04,1124.5 122.04,1105.7"];
	layer_11	[fillcolor=lightcoral,
		height=1.5568,
		label="Layer 11\nDense Layer\nPP Stage 1\nTP8 Parallel",
		pos="122.04,830.33",
		shape=doubleoctagon,
		width=2.3647];
	layer_10 -> layer_11	[label="Layer\nOutput",
		lp="147.54,919.37",
		pos="e,122.04,886.56 122.04,952.11 122.04,934.02 122.04,914.66 122.04,896.85"];
	layer_12	[fillcolor=lightyellow,
		height=1.9868,
		label="Layer 12\nMoE Layer\nPP Stage 1\n64 Experts (EP64)\nTP8 Parallel",
		pos="122.04,636.76",
		shape=tripleoctagon,
		width=3.39];
	layer_11 -> layer_12	[label="Layer\nOutput",
		lp="147.54,741.28",
		pos="e,122.04,708.59 122.04,774.17 122.04,756.84 122.04,737.33 122.04,718.6"];
	layer_13	[fillcolor=lightcoral,
		height=1.5568,
		label="Layer 13\nDense Layer\nPP Stage 1\nTP8 Parallel",
		pos="122.04,443.19",
		shape=doubleoctagon,
		width=2.3647];
	layer_12 -> layer_13	[label="Layer\nOutput",
		lp="147.54,532.23",
		pos="e,122.04,499.42 122.04,564.97 122.04,546.88 122.04,527.51 122.04,509.7"];
	layer_14	[fillcolor=lightyellow,
		height=1.9868,
		label="Layer 14\nMoE Layer\nPP Stage 1\n64 Experts (EP64)\nTP8 Parallel",
		pos="122.04,249.62",
		shape=tripleoctagon,
		width=3.39];
	layer_13 -> layer_14	[label="Layer\nOutput",
		lp="147.54,354.14",
		pos="e,122.04,321.45 122.04,387.03 122.04,369.7 122.04,350.19 122.04,331.46"];
	layer_15	[fillcolor=lightcoral,
		height=1.5568,
		label="Layer 15\nDense Layer\nPP Stage 1\nTP8 Parallel",
		pos="122.04,56.045",
		shape=doubleoctagon,
		width=2.3647];
	layer_14 -> layer_15	[label="Layer\nOutput",
		lp="147.54,145.09",
		pos="e,122.04,112.28 122.04,177.83 122.04,159.74 122.04,140.37 122.04,122.56"];
}
