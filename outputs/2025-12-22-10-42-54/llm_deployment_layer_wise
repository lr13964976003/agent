// 30B MoE Model Layer-wise Deployment DAG
digraph {
	rankdir=TB size="16,20"
	node [shape=box style="rounded,filled"]
	layer_0 [label="Layer 0\nMoE Layer\nPP Stage 0\n64 Experts (EP64)\nTP8 Parallel" fillcolor=lightyellow shape=tripleoctagon]
	layer_1 [label="Layer 1\nDense Layer\nPP Stage 0\nTP8 Parallel" fillcolor=lightcoral shape=doubleoctagon]
	layer_0 -> layer_1 [label="Layer\nOutput"]
	layer_2 [label="Layer 2\nMoE Layer\nPP Stage 0\n64 Experts (EP64)\nTP8 Parallel" fillcolor=lightyellow shape=tripleoctagon]
	layer_1 -> layer_2 [label="Layer\nOutput"]
	layer_3 [label="Layer 3\nDense Layer\nPP Stage 0\nTP8 Parallel" fillcolor=lightcoral shape=doubleoctagon]
	layer_2 -> layer_3 [label="Layer\nOutput"]
	layer_4 [label="Layer 4\nMoE Layer\nPP Stage 0\n64 Experts (EP64)\nTP8 Parallel" fillcolor=lightyellow shape=tripleoctagon]
	layer_3 -> layer_4 [label="Layer\nOutput"]
	layer_5 [label="Layer 5\nDense Layer\nPP Stage 0\nTP8 Parallel" fillcolor=lightcoral shape=doubleoctagon]
	layer_4 -> layer_5 [label="Layer\nOutput"]
	layer_6 [label="Layer 6\nMoE Layer\nPP Stage 0\n64 Experts (EP64)\nTP8 Parallel" fillcolor=lightyellow shape=tripleoctagon]
	layer_5 -> layer_6 [label="Layer\nOutput"]
	layer_7 [label="Layer 7\nDense Layer\nPP Stage 0\nTP8 Parallel" fillcolor=lightcoral shape=doubleoctagon]
	layer_6 -> layer_7 [label="Layer\nOutput"]
	layer_8 [label="Layer 8\nMoE Layer\nPP Stage 1\n64 Experts (EP64)\nTP8 Parallel" fillcolor=lightyellow shape=tripleoctagon]
	layer_7 -> layer_8 [label="Pipeline\nCommunication" color=green penwidth=2 style=dashed]
	layer_9 [label="Layer 9\nDense Layer\nPP Stage 1\nTP8 Parallel" fillcolor=lightcoral shape=doubleoctagon]
	layer_8 -> layer_9 [label="Layer\nOutput"]
	layer_10 [label="Layer 10\nMoE Layer\nPP Stage 1\n64 Experts (EP64)\nTP8 Parallel" fillcolor=lightyellow shape=tripleoctagon]
	layer_9 -> layer_10 [label="Layer\nOutput"]
	layer_11 [label="Layer 11\nDense Layer\nPP Stage 1\nTP8 Parallel" fillcolor=lightcoral shape=doubleoctagon]
	layer_10 -> layer_11 [label="Layer\nOutput"]
	layer_12 [label="Layer 12\nMoE Layer\nPP Stage 1\n64 Experts (EP64)\nTP8 Parallel" fillcolor=lightyellow shape=tripleoctagon]
	layer_11 -> layer_12 [label="Layer\nOutput"]
	layer_13 [label="Layer 13\nDense Layer\nPP Stage 1\nTP8 Parallel" fillcolor=lightcoral shape=doubleoctagon]
	layer_12 -> layer_13 [label="Layer\nOutput"]
	layer_14 [label="Layer 14\nMoE Layer\nPP Stage 1\n64 Experts (EP64)\nTP8 Parallel" fillcolor=lightyellow shape=tripleoctagon]
	layer_13 -> layer_14 [label="Layer\nOutput"]
	layer_15 [label="Layer 15\nDense Layer\nPP Stage 1\nTP8 Parallel" fillcolor=lightcoral shape=doubleoctagon]
	layer_14 -> layer_15 [label="Layer\nOutput"]
}
