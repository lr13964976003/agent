<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="864pt" height="32pt"
 viewBox="0.00 0.00 864.00 31.74" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.69 0.69) rotate(0) translate(4 42)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-42 1248,-42 1248,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<path fill="lightblue" stroke="black" d="M110,-38C110,-38 12,-38 12,-38 6,-38 0,-32 0,-26 0,-26 0,-12 0,-12 0,-6 6,0 12,0 12,0 110,0 110,0 116,0 122,-6 122,-12 122,-12 122,-26 122,-26 122,-32 116,-38 110,-38"/>
<text text-anchor="middle" x="61" y="-22.8" font-family="Times,serif" font-size="14.00">Input Batch</text>
<text text-anchor="middle" x="61" y="-7.8" font-family="Times,serif" font-size="14.00">128 sequences</text>
</g>
<!-- dp -->
<g id="node2" class="node">
<title>dp</title>
<path fill="lightblue" stroke="black" d="M255,-38C255,-38 170,-38 170,-38 164,-38 158,-32 158,-26 158,-26 158,-12 158,-12 158,-6 164,0 170,0 170,0 255,0 255,0 261,0 267,-6 267,-12 267,-12 267,-26 267,-26 267,-32 261,-38 255,-38"/>
<text text-anchor="middle" x="212.5" y="-22.8" font-family="Times,serif" font-size="14.00">Data Parallel</text>
<text text-anchor="middle" x="212.5" y="-7.8" font-family="Times,serif" font-size="14.00">DP=2</text>
</g>
<!-- input&#45;&gt;dp -->
<g id="edge1" class="edge">
<title>input&#45;&gt;dp</title>
<path fill="none" stroke="black" d="M122.38,-19C130.67,-19 139.21,-19 147.57,-19"/>
<polygon fill="black" stroke="black" points="147.65,-22.5 157.65,-19 147.65,-15.5 147.65,-22.5"/>
</g>
<!-- pp -->
<g id="node3" class="node">
<title>pp</title>
<path fill="lightgreen" stroke="black" d="M424,-38C424,-38 315,-38 315,-38 309,-38 303,-32 303,-26 303,-26 303,-12 303,-12 303,-6 309,0 315,0 315,0 424,0 424,0 430,0 436,-6 436,-12 436,-12 436,-26 436,-26 436,-32 430,-38 424,-38"/>
<text text-anchor="middle" x="369.5" y="-22.8" font-family="Times,serif" font-size="14.00">Pipeline Parallel</text>
<text text-anchor="middle" x="369.5" y="-7.8" font-family="Times,serif" font-size="14.00">PP=2</text>
</g>
<!-- dp&#45;&gt;pp -->
<g id="edge2" class="edge">
<title>dp&#45;&gt;pp</title>
<path fill="none" stroke="black" d="M267.28,-19C275.51,-19 284.14,-19 292.74,-19"/>
<polygon fill="black" stroke="black" points="292.79,-22.5 302.79,-19 292.79,-15.5 292.79,-22.5"/>
</g>
<!-- ep -->
<g id="node4" class="node">
<title>ep</title>
<path fill="lightyellow" stroke="black" d="M584,-38C584,-38 484,-38 484,-38 478,-38 472,-32 472,-26 472,-26 472,-12 472,-12 472,-6 478,0 484,0 484,0 584,0 584,0 590,0 596,-6 596,-12 596,-12 596,-26 596,-26 596,-32 590,-38 584,-38"/>
<text text-anchor="middle" x="534" y="-22.8" font-family="Times,serif" font-size="14.00">Expert Parallel</text>
<text text-anchor="middle" x="534" y="-7.8" font-family="Times,serif" font-size="14.00">EP=64</text>
</g>
<!-- pp&#45;&gt;ep -->
<g id="edge3" class="edge">
<title>pp&#45;&gt;ep</title>
<path fill="none" stroke="black" d="M436.13,-19C444.52,-19 453.14,-19 461.62,-19"/>
<polygon fill="black" stroke="black" points="461.86,-22.5 471.86,-19 461.86,-15.5 461.86,-22.5"/>
</g>
<!-- tp -->
<g id="node5" class="node">
<title>tp</title>
<path fill="lightcoral" stroke="black" d="M743,-38C743,-38 644,-38 644,-38 638,-38 632,-32 632,-26 632,-26 632,-12 632,-12 632,-6 638,0 644,0 644,0 743,0 743,0 749,0 755,-6 755,-12 755,-12 755,-26 755,-26 755,-32 749,-38 743,-38"/>
<text text-anchor="middle" x="693.5" y="-22.8" font-family="Times,serif" font-size="14.00">Tensor Parallel</text>
<text text-anchor="middle" x="693.5" y="-7.8" font-family="Times,serif" font-size="14.00">TP=8</text>
</g>
<!-- ep&#45;&gt;tp -->
<g id="edge4" class="edge">
<title>ep&#45;&gt;tp</title>
<path fill="none" stroke="black" d="M596.34,-19C604.63,-19 613.2,-19 621.63,-19"/>
<polygon fill="black" stroke="black" points="621.84,-22.5 631.84,-19 621.84,-15.5 621.84,-22.5"/>
</g>
<!-- moe_layers -->
<g id="node6" class="node">
<title>moe_layers</title>
<path fill="lightyellow" stroke="black" d="M881,-38C881,-38 803,-38 803,-38 797,-38 791,-32 791,-26 791,-26 791,-12 791,-12 791,-6 797,0 803,0 803,0 881,0 881,0 887,0 893,-6 893,-12 893,-12 893,-26 893,-26 893,-32 887,-38 881,-38"/>
<text text-anchor="middle" x="842" y="-22.8" font-family="Times,serif" font-size="14.00">MoE Layers</text>
<text text-anchor="middle" x="842" y="-7.8" font-family="Times,serif" font-size="14.00">16 total</text>
</g>
<!-- tp&#45;&gt;moe_layers -->
<g id="edge5" class="edge">
<title>tp&#45;&gt;moe_layers</title>
<path fill="none" stroke="black" d="M755.36,-19C763.74,-19 772.35,-19 780.72,-19"/>
<polygon fill="black" stroke="black" points="780.79,-22.5 790.79,-19 780.79,-15.5 780.79,-22.5"/>
</g>
<!-- attention -->
<g id="node7" class="node">
<title>attention</title>
<path fill="lightcoral" stroke="black" d="M1053,-38C1053,-38 941,-38 941,-38 935,-38 929,-32 929,-26 929,-26 929,-12 929,-12 929,-6 935,0 941,0 941,0 1053,0 1053,0 1059,0 1065,-6 1065,-12 1065,-12 1065,-26 1065,-26 1065,-32 1059,-38 1053,-38"/>
<text text-anchor="middle" x="997" y="-22.8" font-family="Times,serif" font-size="14.00">Attention Layers</text>
<text text-anchor="middle" x="997" y="-7.8" font-family="Times,serif" font-size="14.00">TP optimized</text>
</g>
<!-- moe_layers&#45;&gt;attention -->
<g id="edge6" class="edge">
<title>moe_layers&#45;&gt;attention</title>
<path fill="none" stroke="black" d="M893.1,-19C901.3,-19 909.97,-19 918.65,-19"/>
<polygon fill="black" stroke="black" points="918.83,-22.5 928.83,-19 918.83,-15.5 918.83,-22.5"/>
</g>
<!-- output -->
<g id="node8" class="node">
<title>output</title>
<path fill="lightblue" stroke="black" d="M1232,-38C1232,-38 1113,-38 1113,-38 1107,-38 1101,-32 1101,-26 1101,-26 1101,-12 1101,-12 1101,-6 1107,0 1113,0 1113,0 1232,0 1232,0 1238,0 1244,-6 1244,-12 1244,-12 1244,-26 1244,-26 1244,-32 1238,-38 1232,-38"/>
<text text-anchor="middle" x="1172.5" y="-22.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="1172.5" y="-7.8" font-family="Times,serif" font-size="14.00">Generated tokens</text>
</g>
<!-- attention&#45;&gt;output -->
<g id="edge7" class="edge">
<title>attention&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1065.08,-19C1073.51,-19 1082.2,-19 1090.81,-19"/>
<polygon fill="black" stroke="black" points="1090.87,-22.5 1100.87,-19 1090.87,-15.5 1090.87,-22.5"/>
</g>
</g>
</svg>
