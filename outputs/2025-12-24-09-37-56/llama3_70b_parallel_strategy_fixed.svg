<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: LLaMA3&#45;70B&#45;Parallel&#45;Strategy&#45;DAG&#45;Simplified Pages: 1 -->
<svg width="801pt" height="12000pt"
 viewBox="0.00 0.00 192.18 2880.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1.31 1.31) rotate(0) translate(4 9137.6)">
<title>LLaMA3&#45;70B&#45;Parallel&#45;Strategy&#45;DAG&#45;Simplified</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-9137.6 606,-9137.6 606,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<path fill="lightyellow" stroke="black" d="M20,-4764.34C20,-4764.34 582,-4764.34 582,-4764.34 588,-4764.34 594,-4770.34 594,-4776.34 594,-4776.34 594,-9113.6 594,-9113.6 594,-9119.6 588,-9125.6 582,-9125.6 582,-9125.6 20,-9125.6 20,-9125.6 14,-9125.6 8,-9119.6 8,-9113.6 8,-9113.6 8,-4776.34 8,-4776.34 8,-4770.34 14,-4764.34 20,-4764.34"/>
<text text-anchor="middle" x="301" y="-9110.4" font-family="Arial Bold" font-size="14.00">Pipeline Stage 0: Layers 0&#45;39 (GPUs 0,1,2,3)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<path fill="lightsteelblue" stroke="black" d="M20,-8C20,-8 582,-8 582,-8 588,-8 594,-14 594,-20 594,-20 594,-4642.8 594,-4642.8 594,-4648.8 588,-4654.8 582,-4654.8 582,-4654.8 20,-4654.8 20,-4654.8 14,-4654.8 8,-4648.8 8,-4642.8 8,-4642.8 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="301" y="-4639.6" font-family="Arial Bold" font-size="14.00">Pipeline Stage 1: Layers 40&#45;79 (GPUs 4,5,6,7)</text>
</g>
<!-- input_stage0 -->
<g id="node1" class="node">
<title>input_stage0</title>
<polygon fill="lightgreen" stroke="black" points="423.5,-9094.6 178.5,-9094.6 178.5,-9042.6 423.5,-9042.6 423.5,-9094.6"/>
<text text-anchor="middle" x="301" y="-9082.6" font-family="Arial" font-size="10.00">Input Embedding</text>
<text text-anchor="middle" x="301" y="-9071.6" font-family="Arial" font-size="10.00">GPU: [0,1,2,3]</text>
<text text-anchor="middle" x="301" y="-9060.6" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=4096]</text>
<text text-anchor="middle" x="301" y="-9049.6" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=4096, hidden=8192]</text>
</g>
<!-- layer0_norm1 -->
<g id="node2" class="node">
<title>layer0_norm1</title>
<polygon fill="lightblue" stroke="black" points="402.5,-9006.6 199.5,-9006.6 199.5,-8954.6 402.5,-8954.6 402.5,-9006.6"/>
<text text-anchor="middle" x="301" y="-8994.6" font-family="Arial" font-size="10.00">Layer 0: RMSNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="301" y="-8983.6" font-family="Arial" font-size="10.00">GPU: [0,1,2,3]</text>
<text text-anchor="middle" x="301" y="-8972.6" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-8961.6" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- input_stage0&#45;&gt;layer0_norm1 -->
<g id="edge1" class="edge">
<title>input_stage0&#45;&gt;layer0_norm1</title>
<path fill="none" stroke="black" d="M301,-9042.26C301,-9034.3 301,-9025.36 301,-9016.85"/>
<polygon fill="black" stroke="black" points="304.5,-9016.76 301,-9006.76 297.5,-9016.76 304.5,-9016.76"/>
</g>
<!-- layer0_qkv_proj -->
<g id="node3" class="node">
<title>layer0_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="418,-8918.6 184,-8918.6 184,-8866.6 418,-8866.6 418,-8918.6"/>
<text text-anchor="middle" x="301" y="-8906.6" font-family="Arial" font-size="10.00">Layer 0: QKV Projection</text>
<text text-anchor="middle" x="301" y="-8895.6" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-8884.6" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-8873.6" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=64, d_k=128]</text>
</g>
<!-- layer0_norm1&#45;&gt;layer0_qkv_proj -->
<g id="edge2" class="edge">
<title>layer0_norm1&#45;&gt;layer0_qkv_proj</title>
<path fill="none" stroke="black" d="M301,-8954.26C301,-8946.3 301,-8937.36 301,-8928.85"/>
<polygon fill="black" stroke="black" points="304.5,-8928.76 301,-8918.76 297.5,-8928.76 304.5,-8928.76"/>
</g>
<!-- layer0_qkv_split -->
<g id="node4" class="node">
<title>layer0_qkv_split</title>
<polygon fill="lightcyan" stroke="black" points="586.21,-8830.6 132.5,-8830.6 15.79,-8726.6 469.5,-8726.6 586.21,-8830.6"/>
<text text-anchor="middle" x="301" y="-8792.6" font-family="Arial" font-size="10.00">Layer 0: QKV Split (TP=4)</text>
<text text-anchor="middle" x="301" y="-8781.6" font-family="Arial" font-size="10.00">GPU: [0,1,2,3]</text>
<text text-anchor="middle" x="301" y="-8770.6" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-8759.6" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=16, d_k=128] per GPU</text>
</g>
<!-- layer0_qkv_proj&#45;&gt;layer0_qkv_split -->
<g id="edge3" class="edge">
<title>layer0_qkv_proj&#45;&gt;layer0_qkv_split</title>
<path fill="none" stroke="black" d="M301,-8866.47C301,-8858.78 301,-8849.97 301,-8840.97"/>
<polygon fill="black" stroke="black" points="304.5,-8840.78 301,-8830.78 297.5,-8840.78 304.5,-8840.78"/>
</g>
<!-- layer0_attention -->
<g id="node5" class="node">
<title>layer0_attention</title>
<polygon fill="lightblue" stroke="black" points="418,-8690.6 184,-8690.6 184,-8638.6 418,-8638.6 418,-8690.6"/>
<text text-anchor="middle" x="301" y="-8678.6" font-family="Arial" font-size="10.00">Layer 0: Attention Compute</text>
<text text-anchor="middle" x="301" y="-8667.6" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-8656.6" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, heads=16, d_k=128]</text>
<text text-anchor="middle" x="301" y="-8645.6" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=16, d_k=128]</text>
</g>
<!-- layer0_qkv_split&#45;&gt;layer0_attention -->
<g id="edge4" class="edge">
<title>layer0_qkv_split&#45;&gt;layer0_attention</title>
<path fill="none" stroke="black" d="M301,-8726.52C301,-8717.85 301,-8709.03 301,-8700.89"/>
<polygon fill="black" stroke="black" points="304.5,-8700.64 301,-8690.64 297.5,-8700.64 304.5,-8700.64"/>
</g>
<!-- layer0_attn_allreduce -->
<g id="node6" class="node">
<title>layer0_attn_allreduce</title>
<ellipse fill="lightpink" stroke="black" cx="301" cy="-8565.83" rx="160.53" ry="36.54"/>
<text text-anchor="middle" x="301" y="-8579.83" font-family="Arial" font-size="10.00">Layer 0: Attention All&#45;Reduce</text>
<text text-anchor="middle" x="301" y="-8568.83" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-8557.83" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, heads=16, d_k=128]</text>
<text text-anchor="middle" x="301" y="-8546.83" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer0_attention&#45;&gt;layer0_attn_allreduce -->
<g id="edge5" class="edge">
<title>layer0_attention&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M301,-8638.43C301,-8630.62 301,-8621.75 301,-8612.99"/>
<polygon fill="black" stroke="black" points="304.5,-8612.81 301,-8602.81 297.5,-8612.81 304.5,-8612.81"/>
</g>
<!-- layer0_norm2 -->
<g id="node7" class="node">
<title>layer0_norm2</title>
<polygon fill="lightblue" stroke="black" points="402.5,-8493.06 199.5,-8493.06 199.5,-8441.06 402.5,-8441.06 402.5,-8493.06"/>
<text text-anchor="middle" x="301" y="-8481.06" font-family="Arial" font-size="10.00">Layer 0: RMSNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="301" y="-8470.06" font-family="Arial" font-size="10.00">GPU: [0,1,2,3]</text>
<text text-anchor="middle" x="301" y="-8459.06" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-8448.06" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer0_attn_allreduce&#45;&gt;layer0_norm2 -->
<g id="edge6" class="edge">
<title>layer0_attn_allreduce&#45;&gt;layer0_norm2</title>
<path fill="none" stroke="black" d="M301,-8528.8C301,-8520.49 301,-8511.65 301,-8503.37"/>
<polygon fill="black" stroke="black" points="304.5,-8503.26 301,-8493.26 297.5,-8503.26 304.5,-8503.26"/>
</g>
<!-- layer0_ffn_gate -->
<g id="node8" class="node">
<title>layer0_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="425,-8405.06 177,-8405.06 177,-8353.06 425,-8353.06 425,-8405.06"/>
<text text-anchor="middle" x="301" y="-8393.06" font-family="Arial" font-size="10.00">Layer 0: FFN Gate Proj</text>
<text text-anchor="middle" x="301" y="-8382.06" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-8371.06" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-8360.06" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, ffn_dim=2752] per GPU</text>
</g>
<!-- layer0_norm2&#45;&gt;layer0_ffn_gate -->
<g id="edge7" class="edge">
<title>layer0_norm2&#45;&gt;layer0_ffn_gate</title>
<path fill="none" stroke="black" d="M301,-8440.72C301,-8432.76 301,-8423.82 301,-8415.31"/>
<polygon fill="black" stroke="black" points="304.5,-8415.22 301,-8405.22 297.5,-8415.22 304.5,-8415.22"/>
</g>
<!-- layer0_ffn_up -->
<g id="node9" class="node">
<title>layer0_ffn_up</title>
<polygon fill="lightblue" stroke="black" points="425,-8317.06 177,-8317.06 177,-8265.06 425,-8265.06 425,-8317.06"/>
<text text-anchor="middle" x="301" y="-8305.06" font-family="Arial" font-size="10.00">Layer 0: FFN Up Proj</text>
<text text-anchor="middle" x="301" y="-8294.06" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-8283.06" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-8272.06" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, ffn_dim=2752] per GPU</text>
</g>
<!-- layer0_ffn_gate&#45;&gt;layer0_ffn_up -->
<g id="edge8" class="edge">
<title>layer0_ffn_gate&#45;&gt;layer0_ffn_up</title>
<path fill="none" stroke="black" d="M301,-8352.72C301,-8344.76 301,-8335.82 301,-8327.31"/>
<polygon fill="black" stroke="black" points="304.5,-8327.22 301,-8317.22 297.5,-8327.22 304.5,-8327.22"/>
</g>
<!-- layer0_ffn_down -->
<g id="node10" class="node">
<title>layer0_ffn_down</title>
<polygon fill="lightblue" stroke="black" points="423.5,-8229.06 178.5,-8229.06 178.5,-8177.06 423.5,-8177.06 423.5,-8229.06"/>
<text text-anchor="middle" x="301" y="-8217.06" font-family="Arial" font-size="10.00">Layer 0: FFN Down Proj</text>
<text text-anchor="middle" x="301" y="-8206.06" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-8195.06" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, ffn_dim=2752]</text>
<text text-anchor="middle" x="301" y="-8184.06" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192] per GPU</text>
</g>
<!-- layer0_ffn_up&#45;&gt;layer0_ffn_down -->
<g id="edge9" class="edge">
<title>layer0_ffn_up&#45;&gt;layer0_ffn_down</title>
<path fill="none" stroke="black" d="M301,-8264.72C301,-8256.76 301,-8247.82 301,-8239.31"/>
<polygon fill="black" stroke="black" points="304.5,-8239.22 301,-8229.22 297.5,-8239.22 304.5,-8239.22"/>
</g>
<!-- layer0_ffn_allreduce -->
<g id="node11" class="node">
<title>layer0_ffn_allreduce</title>
<ellipse fill="lightpink" stroke="black" cx="301" cy="-8104.29" rx="167.67" ry="36.54"/>
<text text-anchor="middle" x="301" y="-8118.29" font-family="Arial" font-size="10.00">Layer 0: FFN All&#45;Reduce</text>
<text text-anchor="middle" x="301" y="-8107.29" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-8096.29" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=2048] per GPU</text>
<text text-anchor="middle" x="301" y="-8085.29" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer0_ffn_down&#45;&gt;layer0_ffn_allreduce -->
<g id="edge10" class="edge">
<title>layer0_ffn_down&#45;&gt;layer0_ffn_allreduce</title>
<path fill="none" stroke="black" d="M301,-8176.89C301,-8169.08 301,-8160.21 301,-8151.45"/>
<polygon fill="black" stroke="black" points="304.5,-8151.27 301,-8141.27 297.5,-8151.27 304.5,-8151.27"/>
</g>
<!-- layer0_intermediate -->
<g id="node12" class="node">
<title>layer0_intermediate</title>
<ellipse fill="lightgray" stroke="black" stroke-dasharray="5,2" cx="301" cy="-8002.53" rx="86.03" ry="28.98"/>
<text text-anchor="middle" x="301" y="-8011.03" font-family="Arial" font-size="10.00">Layers 1&#45;9</text>
<text text-anchor="middle" x="301" y="-8000.03" font-family="Arial" font-size="10.00">Intermediate Processing</text>
<text text-anchor="middle" x="301" y="-7989.03" font-family="Arial" font-size="10.00">GPU: [0,1,2,3]</text>
</g>
<!-- layer0_ffn_allreduce&#45;&gt;layer0_intermediate -->
<g id="edge11" class="edge">
<title>layer0_ffn_allreduce&#45;&gt;layer0_intermediate</title>
<path fill="none" stroke="black" d="M301,-8067.28C301,-8059.03 301,-8050.25 301,-8041.91"/>
<polygon fill="black" stroke="black" points="304.5,-8041.67 301,-8031.67 297.5,-8041.67 304.5,-8041.67"/>
</g>
<!-- layer10_norm1 -->
<g id="node13" class="node">
<title>layer10_norm1</title>
<polygon fill="lightblue" stroke="black" points="402.5,-7937.54 199.5,-7937.54 199.5,-7885.54 402.5,-7885.54 402.5,-7937.54"/>
<text text-anchor="middle" x="301" y="-7925.54" font-family="Arial" font-size="10.00">Layer 10: RMSNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="301" y="-7914.54" font-family="Arial" font-size="10.00">GPU: [0,1,2,3]</text>
<text text-anchor="middle" x="301" y="-7903.54" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-7892.54" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer0_intermediate&#45;&gt;layer10_norm1 -->
<g id="edge12" class="edge">
<title>layer0_intermediate&#45;&gt;layer10_norm1</title>
<path fill="none" stroke="black" d="M301,-7973.37C301,-7965.26 301,-7956.31 301,-7947.83"/>
<polygon fill="black" stroke="black" points="304.5,-7947.8 301,-7937.8 297.5,-7947.8 304.5,-7947.8"/>
</g>
<!-- layer10_qkv_proj -->
<g id="node14" class="node">
<title>layer10_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="418,-7849.54 184,-7849.54 184,-7797.54 418,-7797.54 418,-7849.54"/>
<text text-anchor="middle" x="301" y="-7837.54" font-family="Arial" font-size="10.00">Layer 10: QKV Projection</text>
<text text-anchor="middle" x="301" y="-7826.54" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-7815.54" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-7804.54" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=64, d_k=128]</text>
</g>
<!-- layer10_norm1&#45;&gt;layer10_qkv_proj -->
<g id="edge13" class="edge">
<title>layer10_norm1&#45;&gt;layer10_qkv_proj</title>
<path fill="none" stroke="black" d="M301,-7885.2C301,-7877.24 301,-7868.3 301,-7859.78"/>
<polygon fill="black" stroke="black" points="304.5,-7859.7 301,-7849.7 297.5,-7859.7 304.5,-7859.7"/>
</g>
<!-- layer10_qkv_split -->
<g id="node15" class="node">
<title>layer10_qkv_split</title>
<polygon fill="lightcyan" stroke="black" points="586.21,-7761.54 132.5,-7761.54 15.79,-7657.54 469.5,-7657.54 586.21,-7761.54"/>
<text text-anchor="middle" x="301" y="-7723.54" font-family="Arial" font-size="10.00">Layer 10: QKV Split (TP=4)</text>
<text text-anchor="middle" x="301" y="-7712.54" font-family="Arial" font-size="10.00">GPU: [0,1,2,3]</text>
<text text-anchor="middle" x="301" y="-7701.54" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-7690.54" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=16, d_k=128] per GPU</text>
</g>
<!-- layer10_qkv_proj&#45;&gt;layer10_qkv_split -->
<g id="edge14" class="edge">
<title>layer10_qkv_proj&#45;&gt;layer10_qkv_split</title>
<path fill="none" stroke="black" d="M301,-7797.4C301,-7789.72 301,-7780.91 301,-7771.91"/>
<polygon fill="black" stroke="black" points="304.5,-7771.72 301,-7761.72 297.5,-7771.72 304.5,-7771.72"/>
</g>
<!-- layer10_attention -->
<g id="node16" class="node">
<title>layer10_attention</title>
<polygon fill="lightblue" stroke="black" points="418,-7621.54 184,-7621.54 184,-7569.54 418,-7569.54 418,-7621.54"/>
<text text-anchor="middle" x="301" y="-7609.54" font-family="Arial" font-size="10.00">Layer 10: Attention Compute</text>
<text text-anchor="middle" x="301" y="-7598.54" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-7587.54" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, heads=16, d_k=128]</text>
<text text-anchor="middle" x="301" y="-7576.54" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=16, d_k=128]</text>
</g>
<!-- layer10_qkv_split&#45;&gt;layer10_attention -->
<g id="edge15" class="edge">
<title>layer10_qkv_split&#45;&gt;layer10_attention</title>
<path fill="none" stroke="black" d="M301,-7657.46C301,-7648.79 301,-7639.97 301,-7631.83"/>
<polygon fill="black" stroke="black" points="304.5,-7631.58 301,-7621.58 297.5,-7631.58 304.5,-7631.58"/>
</g>
<!-- layer10_attn_allreduce -->
<g id="node17" class="node">
<title>layer10_attn_allreduce</title>
<ellipse fill="lightpink" stroke="black" cx="301" cy="-7496.77" rx="160.53" ry="36.54"/>
<text text-anchor="middle" x="301" y="-7510.77" font-family="Arial" font-size="10.00">Layer 10: Attention All&#45;Reduce</text>
<text text-anchor="middle" x="301" y="-7499.77" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-7488.77" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, heads=16, d_k=128]</text>
<text text-anchor="middle" x="301" y="-7477.77" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer10_attention&#45;&gt;layer10_attn_allreduce -->
<g id="edge16" class="edge">
<title>layer10_attention&#45;&gt;layer10_attn_allreduce</title>
<path fill="none" stroke="black" d="M301,-7569.37C301,-7561.56 301,-7552.69 301,-7543.92"/>
<polygon fill="black" stroke="black" points="304.5,-7543.75 301,-7533.75 297.5,-7543.75 304.5,-7543.75"/>
</g>
<!-- layer10_norm2 -->
<g id="node18" class="node">
<title>layer10_norm2</title>
<polygon fill="lightblue" stroke="black" points="402.5,-7424 199.5,-7424 199.5,-7372 402.5,-7372 402.5,-7424"/>
<text text-anchor="middle" x="301" y="-7412" font-family="Arial" font-size="10.00">Layer 10: RMSNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="301" y="-7401" font-family="Arial" font-size="10.00">GPU: [0,1,2,3]</text>
<text text-anchor="middle" x="301" y="-7390" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-7379" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer10_attn_allreduce&#45;&gt;layer10_norm2 -->
<g id="edge17" class="edge">
<title>layer10_attn_allreduce&#45;&gt;layer10_norm2</title>
<path fill="none" stroke="black" d="M301,-7459.74C301,-7451.42 301,-7442.59 301,-7434.31"/>
<polygon fill="black" stroke="black" points="304.5,-7434.2 301,-7424.2 297.5,-7434.2 304.5,-7434.2"/>
</g>
<!-- layer10_ffn_gate -->
<g id="node19" class="node">
<title>layer10_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="425,-7336 177,-7336 177,-7284 425,-7284 425,-7336"/>
<text text-anchor="middle" x="301" y="-7324" font-family="Arial" font-size="10.00">Layer 10: FFN Gate Proj</text>
<text text-anchor="middle" x="301" y="-7313" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-7302" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-7291" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, ffn_dim=2752] per GPU</text>
</g>
<!-- layer10_norm2&#45;&gt;layer10_ffn_gate -->
<g id="edge18" class="edge">
<title>layer10_norm2&#45;&gt;layer10_ffn_gate</title>
<path fill="none" stroke="black" d="M301,-7371.66C301,-7363.7 301,-7354.76 301,-7346.25"/>
<polygon fill="black" stroke="black" points="304.5,-7346.16 301,-7336.16 297.5,-7346.16 304.5,-7346.16"/>
</g>
<!-- layer10_ffn_up -->
<g id="node20" class="node">
<title>layer10_ffn_up</title>
<polygon fill="lightblue" stroke="black" points="425,-7248 177,-7248 177,-7196 425,-7196 425,-7248"/>
<text text-anchor="middle" x="301" y="-7236" font-family="Arial" font-size="10.00">Layer 10: FFN Up Proj</text>
<text text-anchor="middle" x="301" y="-7225" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-7214" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-7203" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, ffn_dim=2752] per GPU</text>
</g>
<!-- layer10_ffn_gate&#45;&gt;layer10_ffn_up -->
<g id="edge19" class="edge">
<title>layer10_ffn_gate&#45;&gt;layer10_ffn_up</title>
<path fill="none" stroke="black" d="M301,-7283.66C301,-7275.7 301,-7266.76 301,-7258.25"/>
<polygon fill="black" stroke="black" points="304.5,-7258.16 301,-7248.16 297.5,-7258.16 304.5,-7258.16"/>
</g>
<!-- layer10_ffn_down -->
<g id="node21" class="node">
<title>layer10_ffn_down</title>
<polygon fill="lightblue" stroke="black" points="423.5,-7160 178.5,-7160 178.5,-7108 423.5,-7108 423.5,-7160"/>
<text text-anchor="middle" x="301" y="-7148" font-family="Arial" font-size="10.00">Layer 10: FFN Down Proj</text>
<text text-anchor="middle" x="301" y="-7137" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-7126" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, ffn_dim=2752]</text>
<text text-anchor="middle" x="301" y="-7115" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192] per GPU</text>
</g>
<!-- layer10_ffn_up&#45;&gt;layer10_ffn_down -->
<g id="edge20" class="edge">
<title>layer10_ffn_up&#45;&gt;layer10_ffn_down</title>
<path fill="none" stroke="black" d="M301,-7195.66C301,-7187.7 301,-7178.76 301,-7170.25"/>
<polygon fill="black" stroke="black" points="304.5,-7170.16 301,-7160.16 297.5,-7170.16 304.5,-7170.16"/>
</g>
<!-- layer10_ffn_allreduce -->
<g id="node22" class="node">
<title>layer10_ffn_allreduce</title>
<ellipse fill="lightpink" stroke="black" cx="301" cy="-7035.23" rx="167.67" ry="36.54"/>
<text text-anchor="middle" x="301" y="-7049.23" font-family="Arial" font-size="10.00">Layer 10: FFN All&#45;Reduce</text>
<text text-anchor="middle" x="301" y="-7038.23" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-7027.23" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=2048] per GPU</text>
<text text-anchor="middle" x="301" y="-7016.23" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer10_ffn_down&#45;&gt;layer10_ffn_allreduce -->
<g id="edge21" class="edge">
<title>layer10_ffn_down&#45;&gt;layer10_ffn_allreduce</title>
<path fill="none" stroke="black" d="M301,-7107.83C301,-7100.02 301,-7091.15 301,-7082.39"/>
<polygon fill="black" stroke="black" points="304.5,-7082.21 301,-7072.21 297.5,-7082.21 304.5,-7082.21"/>
</g>
<!-- layer10_intermediate -->
<g id="node23" class="node">
<title>layer10_intermediate</title>
<ellipse fill="lightgray" stroke="black" stroke-dasharray="5,2" cx="301" cy="-6933.47" rx="86.03" ry="28.98"/>
<text text-anchor="middle" x="301" y="-6941.97" font-family="Arial" font-size="10.00">Layers 11&#45;19</text>
<text text-anchor="middle" x="301" y="-6930.97" font-family="Arial" font-size="10.00">Intermediate Processing</text>
<text text-anchor="middle" x="301" y="-6919.97" font-family="Arial" font-size="10.00">GPU: [0,1,2,3]</text>
</g>
<!-- layer10_ffn_allreduce&#45;&gt;layer10_intermediate -->
<g id="edge22" class="edge">
<title>layer10_ffn_allreduce&#45;&gt;layer10_intermediate</title>
<path fill="none" stroke="black" d="M301,-6998.21C301,-6989.97 301,-6981.18 301,-6972.85"/>
<polygon fill="black" stroke="black" points="304.5,-6972.61 301,-6962.61 297.5,-6972.61 304.5,-6972.61"/>
</g>
<!-- layer20_norm1 -->
<g id="node24" class="node">
<title>layer20_norm1</title>
<polygon fill="lightblue" stroke="black" points="402.5,-6868.48 199.5,-6868.48 199.5,-6816.48 402.5,-6816.48 402.5,-6868.48"/>
<text text-anchor="middle" x="301" y="-6856.48" font-family="Arial" font-size="10.00">Layer 20: RMSNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="301" y="-6845.48" font-family="Arial" font-size="10.00">GPU: [0,1,2,3]</text>
<text text-anchor="middle" x="301" y="-6834.48" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-6823.48" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer10_intermediate&#45;&gt;layer20_norm1 -->
<g id="edge23" class="edge">
<title>layer10_intermediate&#45;&gt;layer20_norm1</title>
<path fill="none" stroke="black" d="M301,-6904.31C301,-6896.2 301,-6887.25 301,-6878.77"/>
<polygon fill="black" stroke="black" points="304.5,-6878.74 301,-6868.74 297.5,-6878.74 304.5,-6878.74"/>
</g>
<!-- layer20_qkv_proj -->
<g id="node25" class="node">
<title>layer20_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="418,-6780.48 184,-6780.48 184,-6728.48 418,-6728.48 418,-6780.48"/>
<text text-anchor="middle" x="301" y="-6768.48" font-family="Arial" font-size="10.00">Layer 20: QKV Projection</text>
<text text-anchor="middle" x="301" y="-6757.48" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-6746.48" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-6735.48" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=64, d_k=128]</text>
</g>
<!-- layer20_norm1&#45;&gt;layer20_qkv_proj -->
<g id="edge24" class="edge">
<title>layer20_norm1&#45;&gt;layer20_qkv_proj</title>
<path fill="none" stroke="black" d="M301,-6816.14C301,-6808.18 301,-6799.24 301,-6790.72"/>
<polygon fill="black" stroke="black" points="304.5,-6790.64 301,-6780.64 297.5,-6790.64 304.5,-6790.64"/>
</g>
<!-- layer20_qkv_split -->
<g id="node26" class="node">
<title>layer20_qkv_split</title>
<polygon fill="lightcyan" stroke="black" points="586.21,-6692.48 132.5,-6692.48 15.79,-6588.48 469.5,-6588.48 586.21,-6692.48"/>
<text text-anchor="middle" x="301" y="-6654.48" font-family="Arial" font-size="10.00">Layer 20: QKV Split (TP=4)</text>
<text text-anchor="middle" x="301" y="-6643.48" font-family="Arial" font-size="10.00">GPU: [0,1,2,3]</text>
<text text-anchor="middle" x="301" y="-6632.48" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-6621.48" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=16, d_k=128] per GPU</text>
</g>
<!-- layer20_qkv_proj&#45;&gt;layer20_qkv_split -->
<g id="edge25" class="edge">
<title>layer20_qkv_proj&#45;&gt;layer20_qkv_split</title>
<path fill="none" stroke="black" d="M301,-6728.34C301,-6720.66 301,-6711.85 301,-6702.85"/>
<polygon fill="black" stroke="black" points="304.5,-6702.66 301,-6692.66 297.5,-6702.66 304.5,-6702.66"/>
</g>
<!-- layer20_attention -->
<g id="node27" class="node">
<title>layer20_attention</title>
<polygon fill="lightblue" stroke="black" points="418,-6552.48 184,-6552.48 184,-6500.48 418,-6500.48 418,-6552.48"/>
<text text-anchor="middle" x="301" y="-6540.48" font-family="Arial" font-size="10.00">Layer 20: Attention Compute</text>
<text text-anchor="middle" x="301" y="-6529.48" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-6518.48" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, heads=16, d_k=128]</text>
<text text-anchor="middle" x="301" y="-6507.48" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=16, d_k=128]</text>
</g>
<!-- layer20_qkv_split&#45;&gt;layer20_attention -->
<g id="edge26" class="edge">
<title>layer20_qkv_split&#45;&gt;layer20_attention</title>
<path fill="none" stroke="black" d="M301,-6588.39C301,-6579.73 301,-6570.91 301,-6562.76"/>
<polygon fill="black" stroke="black" points="304.5,-6562.52 301,-6552.52 297.5,-6562.52 304.5,-6562.52"/>
</g>
<!-- layer20_attn_allreduce -->
<g id="node28" class="node">
<title>layer20_attn_allreduce</title>
<ellipse fill="lightpink" stroke="black" cx="301" cy="-6427.71" rx="160.53" ry="36.54"/>
<text text-anchor="middle" x="301" y="-6441.71" font-family="Arial" font-size="10.00">Layer 20: Attention All&#45;Reduce</text>
<text text-anchor="middle" x="301" y="-6430.71" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-6419.71" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, heads=16, d_k=128]</text>
<text text-anchor="middle" x="301" y="-6408.71" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer20_attention&#45;&gt;layer20_attn_allreduce -->
<g id="edge27" class="edge">
<title>layer20_attention&#45;&gt;layer20_attn_allreduce</title>
<path fill="none" stroke="black" d="M301,-6500.31C301,-6492.5 301,-6483.63 301,-6474.86"/>
<polygon fill="black" stroke="black" points="304.5,-6474.69 301,-6464.69 297.5,-6474.69 304.5,-6474.69"/>
</g>
<!-- layer20_norm2 -->
<g id="node29" class="node">
<title>layer20_norm2</title>
<polygon fill="lightblue" stroke="black" points="402.5,-6354.94 199.5,-6354.94 199.5,-6302.94 402.5,-6302.94 402.5,-6354.94"/>
<text text-anchor="middle" x="301" y="-6342.94" font-family="Arial" font-size="10.00">Layer 20: RMSNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="301" y="-6331.94" font-family="Arial" font-size="10.00">GPU: [0,1,2,3]</text>
<text text-anchor="middle" x="301" y="-6320.94" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-6309.94" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer20_attn_allreduce&#45;&gt;layer20_norm2 -->
<g id="edge28" class="edge">
<title>layer20_attn_allreduce&#45;&gt;layer20_norm2</title>
<path fill="none" stroke="black" d="M301,-6390.68C301,-6382.36 301,-6373.53 301,-6365.25"/>
<polygon fill="black" stroke="black" points="304.5,-6365.14 301,-6355.14 297.5,-6365.14 304.5,-6365.14"/>
</g>
<!-- layer20_ffn_gate -->
<g id="node30" class="node">
<title>layer20_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="425,-6266.94 177,-6266.94 177,-6214.94 425,-6214.94 425,-6266.94"/>
<text text-anchor="middle" x="301" y="-6254.94" font-family="Arial" font-size="10.00">Layer 20: FFN Gate Proj</text>
<text text-anchor="middle" x="301" y="-6243.94" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-6232.94" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-6221.94" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, ffn_dim=2752] per GPU</text>
</g>
<!-- layer20_norm2&#45;&gt;layer20_ffn_gate -->
<g id="edge29" class="edge">
<title>layer20_norm2&#45;&gt;layer20_ffn_gate</title>
<path fill="none" stroke="black" d="M301,-6302.6C301,-6294.64 301,-6285.7 301,-6277.18"/>
<polygon fill="black" stroke="black" points="304.5,-6277.1 301,-6267.1 297.5,-6277.1 304.5,-6277.1"/>
</g>
<!-- layer20_ffn_up -->
<g id="node31" class="node">
<title>layer20_ffn_up</title>
<polygon fill="lightblue" stroke="black" points="425,-6178.94 177,-6178.94 177,-6126.94 425,-6126.94 425,-6178.94"/>
<text text-anchor="middle" x="301" y="-6166.94" font-family="Arial" font-size="10.00">Layer 20: FFN Up Proj</text>
<text text-anchor="middle" x="301" y="-6155.94" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-6144.94" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-6133.94" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, ffn_dim=2752] per GPU</text>
</g>
<!-- layer20_ffn_gate&#45;&gt;layer20_ffn_up -->
<g id="edge30" class="edge">
<title>layer20_ffn_gate&#45;&gt;layer20_ffn_up</title>
<path fill="none" stroke="black" d="M301,-6214.6C301,-6206.64 301,-6197.7 301,-6189.18"/>
<polygon fill="black" stroke="black" points="304.5,-6189.1 301,-6179.1 297.5,-6189.1 304.5,-6189.1"/>
</g>
<!-- layer20_ffn_down -->
<g id="node32" class="node">
<title>layer20_ffn_down</title>
<polygon fill="lightblue" stroke="black" points="423.5,-6090.94 178.5,-6090.94 178.5,-6038.94 423.5,-6038.94 423.5,-6090.94"/>
<text text-anchor="middle" x="301" y="-6078.94" font-family="Arial" font-size="10.00">Layer 20: FFN Down Proj</text>
<text text-anchor="middle" x="301" y="-6067.94" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-6056.94" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, ffn_dim=2752]</text>
<text text-anchor="middle" x="301" y="-6045.94" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192] per GPU</text>
</g>
<!-- layer20_ffn_up&#45;&gt;layer20_ffn_down -->
<g id="edge31" class="edge">
<title>layer20_ffn_up&#45;&gt;layer20_ffn_down</title>
<path fill="none" stroke="black" d="M301,-6126.6C301,-6118.64 301,-6109.7 301,-6101.18"/>
<polygon fill="black" stroke="black" points="304.5,-6101.1 301,-6091.1 297.5,-6101.1 304.5,-6101.1"/>
</g>
<!-- layer20_ffn_allreduce -->
<g id="node33" class="node">
<title>layer20_ffn_allreduce</title>
<ellipse fill="lightpink" stroke="black" cx="301" cy="-5966.17" rx="167.67" ry="36.54"/>
<text text-anchor="middle" x="301" y="-5980.17" font-family="Arial" font-size="10.00">Layer 20: FFN All&#45;Reduce</text>
<text text-anchor="middle" x="301" y="-5969.17" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-5958.17" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=2048] per GPU</text>
<text text-anchor="middle" x="301" y="-5947.17" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer20_ffn_down&#45;&gt;layer20_ffn_allreduce -->
<g id="edge32" class="edge">
<title>layer20_ffn_down&#45;&gt;layer20_ffn_allreduce</title>
<path fill="none" stroke="black" d="M301,-6038.77C301,-6030.96 301,-6022.09 301,-6013.32"/>
<polygon fill="black" stroke="black" points="304.5,-6013.15 301,-6003.15 297.5,-6013.15 304.5,-6013.15"/>
</g>
<!-- layer20_intermediate -->
<g id="node34" class="node">
<title>layer20_intermediate</title>
<ellipse fill="lightgray" stroke="black" stroke-dasharray="5,2" cx="301" cy="-5864.41" rx="86.03" ry="28.98"/>
<text text-anchor="middle" x="301" y="-5872.91" font-family="Arial" font-size="10.00">Layers 21&#45;29</text>
<text text-anchor="middle" x="301" y="-5861.91" font-family="Arial" font-size="10.00">Intermediate Processing</text>
<text text-anchor="middle" x="301" y="-5850.91" font-family="Arial" font-size="10.00">GPU: [0,1,2,3]</text>
</g>
<!-- layer20_ffn_allreduce&#45;&gt;layer20_intermediate -->
<g id="edge33" class="edge">
<title>layer20_ffn_allreduce&#45;&gt;layer20_intermediate</title>
<path fill="none" stroke="black" d="M301,-5929.15C301,-5920.91 301,-5912.12 301,-5903.79"/>
<polygon fill="black" stroke="black" points="304.5,-5903.55 301,-5893.55 297.5,-5903.55 304.5,-5903.55"/>
</g>
<!-- layer30_norm1 -->
<g id="node35" class="node">
<title>layer30_norm1</title>
<polygon fill="lightblue" stroke="black" points="402.5,-5799.42 199.5,-5799.42 199.5,-5747.42 402.5,-5747.42 402.5,-5799.42"/>
<text text-anchor="middle" x="301" y="-5787.42" font-family="Arial" font-size="10.00">Layer 30: RMSNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="301" y="-5776.42" font-family="Arial" font-size="10.00">GPU: [0,1,2,3]</text>
<text text-anchor="middle" x="301" y="-5765.42" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-5754.42" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer20_intermediate&#45;&gt;layer30_norm1 -->
<g id="edge34" class="edge">
<title>layer20_intermediate&#45;&gt;layer30_norm1</title>
<path fill="none" stroke="black" d="M301,-5835.25C301,-5827.14 301,-5818.19 301,-5809.71"/>
<polygon fill="black" stroke="black" points="304.5,-5809.68 301,-5799.68 297.5,-5809.68 304.5,-5809.68"/>
</g>
<!-- layer30_qkv_proj -->
<g id="node36" class="node">
<title>layer30_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="418,-5711.42 184,-5711.42 184,-5659.42 418,-5659.42 418,-5711.42"/>
<text text-anchor="middle" x="301" y="-5699.42" font-family="Arial" font-size="10.00">Layer 30: QKV Projection</text>
<text text-anchor="middle" x="301" y="-5688.42" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-5677.42" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-5666.42" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=64, d_k=128]</text>
</g>
<!-- layer30_norm1&#45;&gt;layer30_qkv_proj -->
<g id="edge35" class="edge">
<title>layer30_norm1&#45;&gt;layer30_qkv_proj</title>
<path fill="none" stroke="black" d="M301,-5747.08C301,-5739.12 301,-5730.18 301,-5721.66"/>
<polygon fill="black" stroke="black" points="304.5,-5721.57 301,-5711.57 297.5,-5721.57 304.5,-5721.57"/>
</g>
<!-- layer30_qkv_split -->
<g id="node37" class="node">
<title>layer30_qkv_split</title>
<polygon fill="lightcyan" stroke="black" points="586.21,-5623.42 132.5,-5623.42 15.79,-5519.42 469.5,-5519.42 586.21,-5623.42"/>
<text text-anchor="middle" x="301" y="-5585.42" font-family="Arial" font-size="10.00">Layer 30: QKV Split (TP=4)</text>
<text text-anchor="middle" x="301" y="-5574.42" font-family="Arial" font-size="10.00">GPU: [0,1,2,3]</text>
<text text-anchor="middle" x="301" y="-5563.42" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-5552.42" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=16, d_k=128] per GPU</text>
</g>
<!-- layer30_qkv_proj&#45;&gt;layer30_qkv_split -->
<g id="edge36" class="edge">
<title>layer30_qkv_proj&#45;&gt;layer30_qkv_split</title>
<path fill="none" stroke="black" d="M301,-5659.28C301,-5651.6 301,-5642.78 301,-5633.79"/>
<polygon fill="black" stroke="black" points="304.5,-5633.6 301,-5623.6 297.5,-5633.6 304.5,-5633.6"/>
</g>
<!-- layer30_attention -->
<g id="node38" class="node">
<title>layer30_attention</title>
<polygon fill="lightblue" stroke="black" points="418,-5483.42 184,-5483.42 184,-5431.42 418,-5431.42 418,-5483.42"/>
<text text-anchor="middle" x="301" y="-5471.42" font-family="Arial" font-size="10.00">Layer 30: Attention Compute</text>
<text text-anchor="middle" x="301" y="-5460.42" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-5449.42" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, heads=16, d_k=128]</text>
<text text-anchor="middle" x="301" y="-5438.42" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=16, d_k=128]</text>
</g>
<!-- layer30_qkv_split&#45;&gt;layer30_attention -->
<g id="edge37" class="edge">
<title>layer30_qkv_split&#45;&gt;layer30_attention</title>
<path fill="none" stroke="black" d="M301,-5519.33C301,-5510.67 301,-5501.85 301,-5493.7"/>
<polygon fill="black" stroke="black" points="304.5,-5493.46 301,-5483.46 297.5,-5493.46 304.5,-5493.46"/>
</g>
<!-- layer30_attn_allreduce -->
<g id="node39" class="node">
<title>layer30_attn_allreduce</title>
<ellipse fill="lightpink" stroke="black" cx="301" cy="-5358.65" rx="160.53" ry="36.54"/>
<text text-anchor="middle" x="301" y="-5372.65" font-family="Arial" font-size="10.00">Layer 30: Attention All&#45;Reduce</text>
<text text-anchor="middle" x="301" y="-5361.65" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-5350.65" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, heads=16, d_k=128]</text>
<text text-anchor="middle" x="301" y="-5339.65" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer30_attention&#45;&gt;layer30_attn_allreduce -->
<g id="edge38" class="edge">
<title>layer30_attention&#45;&gt;layer30_attn_allreduce</title>
<path fill="none" stroke="black" d="M301,-5431.25C301,-5423.44 301,-5414.57 301,-5405.8"/>
<polygon fill="black" stroke="black" points="304.5,-5405.62 301,-5395.62 297.5,-5405.62 304.5,-5405.62"/>
</g>
<!-- layer30_norm2 -->
<g id="node40" class="node">
<title>layer30_norm2</title>
<polygon fill="lightblue" stroke="black" points="402.5,-5285.88 199.5,-5285.88 199.5,-5233.88 402.5,-5233.88 402.5,-5285.88"/>
<text text-anchor="middle" x="301" y="-5273.88" font-family="Arial" font-size="10.00">Layer 30: RMSNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="301" y="-5262.88" font-family="Arial" font-size="10.00">GPU: [0,1,2,3]</text>
<text text-anchor="middle" x="301" y="-5251.88" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-5240.88" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer30_attn_allreduce&#45;&gt;layer30_norm2 -->
<g id="edge39" class="edge">
<title>layer30_attn_allreduce&#45;&gt;layer30_norm2</title>
<path fill="none" stroke="black" d="M301,-5321.61C301,-5313.3 301,-5304.47 301,-5296.19"/>
<polygon fill="black" stroke="black" points="304.5,-5296.07 301,-5286.07 297.5,-5296.07 304.5,-5296.07"/>
</g>
<!-- layer30_ffn_gate -->
<g id="node41" class="node">
<title>layer30_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="425,-5197.88 177,-5197.88 177,-5145.88 425,-5145.88 425,-5197.88"/>
<text text-anchor="middle" x="301" y="-5185.88" font-family="Arial" font-size="10.00">Layer 30: FFN Gate Proj</text>
<text text-anchor="middle" x="301" y="-5174.88" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-5163.88" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-5152.88" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, ffn_dim=2752] per GPU</text>
</g>
<!-- layer30_norm2&#45;&gt;layer30_ffn_gate -->
<g id="edge40" class="edge">
<title>layer30_norm2&#45;&gt;layer30_ffn_gate</title>
<path fill="none" stroke="black" d="M301,-5233.54C301,-5225.58 301,-5216.64 301,-5208.12"/>
<polygon fill="black" stroke="black" points="304.5,-5208.03 301,-5198.04 297.5,-5208.04 304.5,-5208.03"/>
</g>
<!-- layer30_ffn_up -->
<g id="node42" class="node">
<title>layer30_ffn_up</title>
<polygon fill="lightblue" stroke="black" points="425,-5109.88 177,-5109.88 177,-5057.88 425,-5057.88 425,-5109.88"/>
<text text-anchor="middle" x="301" y="-5097.88" font-family="Arial" font-size="10.00">Layer 30: FFN Up Proj</text>
<text text-anchor="middle" x="301" y="-5086.88" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-5075.88" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-5064.88" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, ffn_dim=2752] per GPU</text>
</g>
<!-- layer30_ffn_gate&#45;&gt;layer30_ffn_up -->
<g id="edge41" class="edge">
<title>layer30_ffn_gate&#45;&gt;layer30_ffn_up</title>
<path fill="none" stroke="black" d="M301,-5145.54C301,-5137.58 301,-5128.64 301,-5120.12"/>
<polygon fill="black" stroke="black" points="304.5,-5120.03 301,-5110.04 297.5,-5120.04 304.5,-5120.03"/>
</g>
<!-- layer30_ffn_down -->
<g id="node43" class="node">
<title>layer30_ffn_down</title>
<polygon fill="lightblue" stroke="black" points="423.5,-5021.88 178.5,-5021.88 178.5,-4969.88 423.5,-4969.88 423.5,-5021.88"/>
<text text-anchor="middle" x="301" y="-5009.88" font-family="Arial" font-size="10.00">Layer 30: FFN Down Proj</text>
<text text-anchor="middle" x="301" y="-4998.88" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-4987.88" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, ffn_dim=2752]</text>
<text text-anchor="middle" x="301" y="-4976.88" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192] per GPU</text>
</g>
<!-- layer30_ffn_up&#45;&gt;layer30_ffn_down -->
<g id="edge42" class="edge">
<title>layer30_ffn_up&#45;&gt;layer30_ffn_down</title>
<path fill="none" stroke="black" d="M301,-5057.54C301,-5049.58 301,-5040.64 301,-5032.12"/>
<polygon fill="black" stroke="black" points="304.5,-5032.03 301,-5022.04 297.5,-5032.04 304.5,-5032.03"/>
</g>
<!-- layer30_ffn_allreduce -->
<g id="node44" class="node">
<title>layer30_ffn_allreduce</title>
<ellipse fill="lightpink" stroke="black" cx="301" cy="-4897.11" rx="167.67" ry="36.54"/>
<text text-anchor="middle" x="301" y="-4911.11" font-family="Arial" font-size="10.00">Layer 30: FFN All&#45;Reduce</text>
<text text-anchor="middle" x="301" y="-4900.11" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] TP=4</text>
<text text-anchor="middle" x="301" y="-4889.11" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=2048] per GPU</text>
<text text-anchor="middle" x="301" y="-4878.11" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer30_ffn_down&#45;&gt;layer30_ffn_allreduce -->
<g id="edge43" class="edge">
<title>layer30_ffn_down&#45;&gt;layer30_ffn_allreduce</title>
<path fill="none" stroke="black" d="M301,-4969.71C301,-4961.9 301,-4953.03 301,-4944.26"/>
<polygon fill="black" stroke="black" points="304.5,-4944.09 301,-4934.09 297.5,-4944.09 304.5,-4944.09"/>
</g>
<!-- stage0_output -->
<g id="node45" class="node">
<title>stage0_output</title>
<polygon fill="lightgreen" stroke="black" points="402.5,-4824.34 199.5,-4824.34 199.5,-4772.34 402.5,-4772.34 402.5,-4824.34"/>
<text text-anchor="middle" x="301" y="-4812.34" font-family="Arial" font-size="10.00">Stage 0 Output</text>
<text text-anchor="middle" x="301" y="-4801.34" font-family="Arial" font-size="10.00">GPU: [0,1,2,3]</text>
<text text-anchor="middle" x="301" y="-4790.34" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-4779.34" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer30_ffn_allreduce&#45;&gt;stage0_output -->
<g id="edge44" class="edge">
<title>layer30_ffn_allreduce&#45;&gt;stage0_output</title>
<path fill="none" stroke="black" d="M301,-4860.08C301,-4851.76 301,-4842.93 301,-4834.65"/>
<polygon fill="black" stroke="black" points="304.5,-4834.54 301,-4824.54 297.5,-4834.54 304.5,-4834.54"/>
</g>
<!-- pipeline_comm -->
<g id="node94" class="node">
<title>pipeline_comm</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="301" cy="-4699.57" rx="137.77" ry="36.54"/>
<text text-anchor="middle" x="301" y="-4713.57" font-family="Arial" font-size="10.00">Pipeline Communication</text>
<text text-anchor="middle" x="301" y="-4702.57" font-family="Arial" font-size="10.00">Stage 0 → Stage 1</text>
<text text-anchor="middle" x="301" y="-4691.57" font-family="Arial" font-size="10.00">GPU: [0,1,2,3] → [4,5,6,7]</text>
<text text-anchor="middle" x="301" y="-4680.57" font-family="Arial" font-size="10.00">Data: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- stage0_output&#45;&gt;pipeline_comm -->
<g id="edge92" class="edge">
<title>stage0_output&#45;&gt;pipeline_comm</title>
<path fill="none" stroke="black" d="M301,-4772.17C301,-4764.36 301,-4755.49 301,-4746.72"/>
<polygon fill="black" stroke="black" points="304.5,-4746.55 301,-4736.55 297.5,-4746.55 304.5,-4746.55"/>
</g>
<!-- input_stage1 -->
<g id="node46" class="node">
<title>input_stage1</title>
<polygon fill="lightgreen" stroke="black" points="402.5,-4623.8 199.5,-4623.8 199.5,-4571.8 402.5,-4571.8 402.5,-4623.8"/>
<text text-anchor="middle" x="301" y="-4611.8" font-family="Arial" font-size="10.00">Stage 1 Input</text>
<text text-anchor="middle" x="301" y="-4600.8" font-family="Arial" font-size="10.00">GPU: [4,5,6,7]</text>
<text text-anchor="middle" x="301" y="-4589.8" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-4578.8" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer40_norm1 -->
<g id="node47" class="node">
<title>layer40_norm1</title>
<polygon fill="lightblue" stroke="black" points="402.5,-4535.8 199.5,-4535.8 199.5,-4483.8 402.5,-4483.8 402.5,-4535.8"/>
<text text-anchor="middle" x="301" y="-4523.8" font-family="Arial" font-size="10.00">Layer 40: RMSNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="301" y="-4512.8" font-family="Arial" font-size="10.00">GPU: [4,5,6,7]</text>
<text text-anchor="middle" x="301" y="-4501.8" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-4490.8" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- input_stage1&#45;&gt;layer40_norm1 -->
<g id="edge45" class="edge">
<title>input_stage1&#45;&gt;layer40_norm1</title>
<path fill="none" stroke="black" d="M301,-4571.46C301,-4563.5 301,-4554.56 301,-4546.05"/>
<polygon fill="black" stroke="black" points="304.5,-4545.96 301,-4535.96 297.5,-4545.96 304.5,-4545.96"/>
</g>
<!-- layer40_qkv_proj -->
<g id="node48" class="node">
<title>layer40_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="418,-4447.8 184,-4447.8 184,-4395.8 418,-4395.8 418,-4447.8"/>
<text text-anchor="middle" x="301" y="-4435.8" font-family="Arial" font-size="10.00">Layer 40: QKV Projection</text>
<text text-anchor="middle" x="301" y="-4424.8" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-4413.8" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-4402.8" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=64, d_k=128]</text>
</g>
<!-- layer40_norm1&#45;&gt;layer40_qkv_proj -->
<g id="edge46" class="edge">
<title>layer40_norm1&#45;&gt;layer40_qkv_proj</title>
<path fill="none" stroke="black" d="M301,-4483.46C301,-4475.5 301,-4466.56 301,-4458.05"/>
<polygon fill="black" stroke="black" points="304.5,-4457.96 301,-4447.96 297.5,-4457.96 304.5,-4457.96"/>
</g>
<!-- layer40_qkv_split -->
<g id="node49" class="node">
<title>layer40_qkv_split</title>
<polygon fill="lightcyan" stroke="black" points="586.21,-4359.8 132.5,-4359.8 15.79,-4255.8 469.5,-4255.8 586.21,-4359.8"/>
<text text-anchor="middle" x="301" y="-4321.8" font-family="Arial" font-size="10.00">Layer 40: QKV Split (TP=4)</text>
<text text-anchor="middle" x="301" y="-4310.8" font-family="Arial" font-size="10.00">GPU: [4,5,6,7]</text>
<text text-anchor="middle" x="301" y="-4299.8" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-4288.8" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=16, d_k=128] per GPU</text>
</g>
<!-- layer40_qkv_proj&#45;&gt;layer40_qkv_split -->
<g id="edge47" class="edge">
<title>layer40_qkv_proj&#45;&gt;layer40_qkv_split</title>
<path fill="none" stroke="black" d="M301,-4395.67C301,-4387.98 301,-4379.17 301,-4370.17"/>
<polygon fill="black" stroke="black" points="304.5,-4369.98 301,-4359.98 297.5,-4369.98 304.5,-4369.98"/>
</g>
<!-- layer40_attention -->
<g id="node50" class="node">
<title>layer40_attention</title>
<polygon fill="lightblue" stroke="black" points="418,-4219.8 184,-4219.8 184,-4167.8 418,-4167.8 418,-4219.8"/>
<text text-anchor="middle" x="301" y="-4207.8" font-family="Arial" font-size="10.00">Layer 40: Attention Compute</text>
<text text-anchor="middle" x="301" y="-4196.8" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-4185.8" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, heads=16, d_k=128]</text>
<text text-anchor="middle" x="301" y="-4174.8" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=16, d_k=128]</text>
</g>
<!-- layer40_qkv_split&#45;&gt;layer40_attention -->
<g id="edge48" class="edge">
<title>layer40_qkv_split&#45;&gt;layer40_attention</title>
<path fill="none" stroke="black" d="M301,-4255.72C301,-4247.05 301,-4238.23 301,-4230.09"/>
<polygon fill="black" stroke="black" points="304.5,-4229.84 301,-4219.84 297.5,-4229.84 304.5,-4229.84"/>
</g>
<!-- layer40_attn_allreduce -->
<g id="node51" class="node">
<title>layer40_attn_allreduce</title>
<ellipse fill="lightpink" stroke="black" cx="301" cy="-4095.03" rx="160.53" ry="36.54"/>
<text text-anchor="middle" x="301" y="-4109.03" font-family="Arial" font-size="10.00">Layer 40: Attention All&#45;Reduce</text>
<text text-anchor="middle" x="301" y="-4098.03" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-4087.03" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, heads=16, d_k=128]</text>
<text text-anchor="middle" x="301" y="-4076.03" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer40_attention&#45;&gt;layer40_attn_allreduce -->
<g id="edge49" class="edge">
<title>layer40_attention&#45;&gt;layer40_attn_allreduce</title>
<path fill="none" stroke="black" d="M301,-4167.63C301,-4159.82 301,-4150.95 301,-4142.19"/>
<polygon fill="black" stroke="black" points="304.5,-4142.01 301,-4132.01 297.5,-4142.01 304.5,-4142.01"/>
</g>
<!-- layer40_norm2 -->
<g id="node52" class="node">
<title>layer40_norm2</title>
<polygon fill="lightblue" stroke="black" points="402.5,-4022.26 199.5,-4022.26 199.5,-3970.26 402.5,-3970.26 402.5,-4022.26"/>
<text text-anchor="middle" x="301" y="-4010.26" font-family="Arial" font-size="10.00">Layer 40: RMSNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="301" y="-3999.26" font-family="Arial" font-size="10.00">GPU: [4,5,6,7]</text>
<text text-anchor="middle" x="301" y="-3988.26" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-3977.26" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer40_attn_allreduce&#45;&gt;layer40_norm2 -->
<g id="edge50" class="edge">
<title>layer40_attn_allreduce&#45;&gt;layer40_norm2</title>
<path fill="none" stroke="black" d="M301,-4058C301,-4049.68 301,-4040.85 301,-4032.57"/>
<polygon fill="black" stroke="black" points="304.5,-4032.46 301,-4022.46 297.5,-4032.46 304.5,-4032.46"/>
</g>
<!-- layer40_ffn_gate -->
<g id="node53" class="node">
<title>layer40_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="425,-3934.26 177,-3934.26 177,-3882.26 425,-3882.26 425,-3934.26"/>
<text text-anchor="middle" x="301" y="-3922.26" font-family="Arial" font-size="10.00">Layer 40: FFN Gate Proj</text>
<text text-anchor="middle" x="301" y="-3911.26" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-3900.26" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-3889.26" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, ffn_dim=2752] per GPU</text>
</g>
<!-- layer40_norm2&#45;&gt;layer40_ffn_gate -->
<g id="edge51" class="edge">
<title>layer40_norm2&#45;&gt;layer40_ffn_gate</title>
<path fill="none" stroke="black" d="M301,-3969.92C301,-3961.96 301,-3953.02 301,-3944.51"/>
<polygon fill="black" stroke="black" points="304.5,-3944.42 301,-3934.42 297.5,-3944.42 304.5,-3944.42"/>
</g>
<!-- layer40_ffn_up -->
<g id="node54" class="node">
<title>layer40_ffn_up</title>
<polygon fill="lightblue" stroke="black" points="425,-3846.26 177,-3846.26 177,-3794.26 425,-3794.26 425,-3846.26"/>
<text text-anchor="middle" x="301" y="-3834.26" font-family="Arial" font-size="10.00">Layer 40: FFN Up Proj</text>
<text text-anchor="middle" x="301" y="-3823.26" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-3812.26" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-3801.26" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, ffn_dim=2752] per GPU</text>
</g>
<!-- layer40_ffn_gate&#45;&gt;layer40_ffn_up -->
<g id="edge52" class="edge">
<title>layer40_ffn_gate&#45;&gt;layer40_ffn_up</title>
<path fill="none" stroke="black" d="M301,-3881.92C301,-3873.96 301,-3865.02 301,-3856.51"/>
<polygon fill="black" stroke="black" points="304.5,-3856.42 301,-3846.42 297.5,-3856.42 304.5,-3856.42"/>
</g>
<!-- layer40_ffn_down -->
<g id="node55" class="node">
<title>layer40_ffn_down</title>
<polygon fill="lightblue" stroke="black" points="423.5,-3758.26 178.5,-3758.26 178.5,-3706.26 423.5,-3706.26 423.5,-3758.26"/>
<text text-anchor="middle" x="301" y="-3746.26" font-family="Arial" font-size="10.00">Layer 40: FFN Down Proj</text>
<text text-anchor="middle" x="301" y="-3735.26" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-3724.26" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, ffn_dim=2752]</text>
<text text-anchor="middle" x="301" y="-3713.26" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192] per GPU</text>
</g>
<!-- layer40_ffn_up&#45;&gt;layer40_ffn_down -->
<g id="edge53" class="edge">
<title>layer40_ffn_up&#45;&gt;layer40_ffn_down</title>
<path fill="none" stroke="black" d="M301,-3793.92C301,-3785.96 301,-3777.02 301,-3768.51"/>
<polygon fill="black" stroke="black" points="304.5,-3768.42 301,-3758.42 297.5,-3768.42 304.5,-3768.42"/>
</g>
<!-- layer40_ffn_allreduce -->
<g id="node56" class="node">
<title>layer40_ffn_allreduce</title>
<ellipse fill="lightpink" stroke="black" cx="301" cy="-3633.49" rx="167.67" ry="36.54"/>
<text text-anchor="middle" x="301" y="-3647.49" font-family="Arial" font-size="10.00">Layer 40: FFN All&#45;Reduce</text>
<text text-anchor="middle" x="301" y="-3636.49" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-3625.49" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=2048] per GPU</text>
<text text-anchor="middle" x="301" y="-3614.49" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer40_ffn_down&#45;&gt;layer40_ffn_allreduce -->
<g id="edge54" class="edge">
<title>layer40_ffn_down&#45;&gt;layer40_ffn_allreduce</title>
<path fill="none" stroke="black" d="M301,-3706.09C301,-3698.28 301,-3689.41 301,-3680.65"/>
<polygon fill="black" stroke="black" points="304.5,-3680.47 301,-3670.47 297.5,-3680.47 304.5,-3680.47"/>
</g>
<!-- layer40_intermediate -->
<g id="node57" class="node">
<title>layer40_intermediate</title>
<ellipse fill="lightgray" stroke="black" stroke-dasharray="5,2" cx="301" cy="-3531.73" rx="86.03" ry="28.98"/>
<text text-anchor="middle" x="301" y="-3540.23" font-family="Arial" font-size="10.00">Layers 41&#45;49</text>
<text text-anchor="middle" x="301" y="-3529.23" font-family="Arial" font-size="10.00">Intermediate Processing</text>
<text text-anchor="middle" x="301" y="-3518.23" font-family="Arial" font-size="10.00">GPU: [4,5,6,7]</text>
</g>
<!-- layer40_ffn_allreduce&#45;&gt;layer40_intermediate -->
<g id="edge55" class="edge">
<title>layer40_ffn_allreduce&#45;&gt;layer40_intermediate</title>
<path fill="none" stroke="black" d="M301,-3596.48C301,-3588.23 301,-3579.45 301,-3571.11"/>
<polygon fill="black" stroke="black" points="304.5,-3570.87 301,-3560.87 297.5,-3570.87 304.5,-3570.87"/>
</g>
<!-- layer50_norm1 -->
<g id="node58" class="node">
<title>layer50_norm1</title>
<polygon fill="lightblue" stroke="black" points="402.5,-3466.74 199.5,-3466.74 199.5,-3414.74 402.5,-3414.74 402.5,-3466.74"/>
<text text-anchor="middle" x="301" y="-3454.74" font-family="Arial" font-size="10.00">Layer 50: RMSNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="301" y="-3443.74" font-family="Arial" font-size="10.00">GPU: [4,5,6,7]</text>
<text text-anchor="middle" x="301" y="-3432.74" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-3421.74" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer40_intermediate&#45;&gt;layer50_norm1 -->
<g id="edge56" class="edge">
<title>layer40_intermediate&#45;&gt;layer50_norm1</title>
<path fill="none" stroke="black" d="M301,-3502.57C301,-3494.46 301,-3485.51 301,-3477.03"/>
<polygon fill="black" stroke="black" points="304.5,-3477 301,-3467 297.5,-3477 304.5,-3477"/>
</g>
<!-- layer50_qkv_proj -->
<g id="node59" class="node">
<title>layer50_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="418,-3378.74 184,-3378.74 184,-3326.74 418,-3326.74 418,-3378.74"/>
<text text-anchor="middle" x="301" y="-3366.74" font-family="Arial" font-size="10.00">Layer 50: QKV Projection</text>
<text text-anchor="middle" x="301" y="-3355.74" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-3344.74" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-3333.74" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=64, d_k=128]</text>
</g>
<!-- layer50_norm1&#45;&gt;layer50_qkv_proj -->
<g id="edge57" class="edge">
<title>layer50_norm1&#45;&gt;layer50_qkv_proj</title>
<path fill="none" stroke="black" d="M301,-3414.4C301,-3406.44 301,-3397.5 301,-3388.98"/>
<polygon fill="black" stroke="black" points="304.5,-3388.9 301,-3378.9 297.5,-3388.9 304.5,-3388.9"/>
</g>
<!-- layer50_qkv_split -->
<g id="node60" class="node">
<title>layer50_qkv_split</title>
<polygon fill="lightcyan" stroke="black" points="586.21,-3290.74 132.5,-3290.74 15.79,-3186.74 469.5,-3186.74 586.21,-3290.74"/>
<text text-anchor="middle" x="301" y="-3252.74" font-family="Arial" font-size="10.00">Layer 50: QKV Split (TP=4)</text>
<text text-anchor="middle" x="301" y="-3241.74" font-family="Arial" font-size="10.00">GPU: [4,5,6,7]</text>
<text text-anchor="middle" x="301" y="-3230.74" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-3219.74" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=16, d_k=128] per GPU</text>
</g>
<!-- layer50_qkv_proj&#45;&gt;layer50_qkv_split -->
<g id="edge58" class="edge">
<title>layer50_qkv_proj&#45;&gt;layer50_qkv_split</title>
<path fill="none" stroke="black" d="M301,-3326.6C301,-3318.92 301,-3310.11 301,-3301.11"/>
<polygon fill="black" stroke="black" points="304.5,-3300.92 301,-3290.92 297.5,-3300.92 304.5,-3300.92"/>
</g>
<!-- layer50_attention -->
<g id="node61" class="node">
<title>layer50_attention</title>
<polygon fill="lightblue" stroke="black" points="418,-3150.74 184,-3150.74 184,-3098.74 418,-3098.74 418,-3150.74"/>
<text text-anchor="middle" x="301" y="-3138.74" font-family="Arial" font-size="10.00">Layer 50: Attention Compute</text>
<text text-anchor="middle" x="301" y="-3127.74" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-3116.74" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, heads=16, d_k=128]</text>
<text text-anchor="middle" x="301" y="-3105.74" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=16, d_k=128]</text>
</g>
<!-- layer50_qkv_split&#45;&gt;layer50_attention -->
<g id="edge59" class="edge">
<title>layer50_qkv_split&#45;&gt;layer50_attention</title>
<path fill="none" stroke="black" d="M301,-3186.66C301,-3177.99 301,-3169.17 301,-3161.02"/>
<polygon fill="black" stroke="black" points="304.5,-3160.78 301,-3150.78 297.5,-3160.78 304.5,-3160.78"/>
</g>
<!-- layer50_attn_allreduce -->
<g id="node62" class="node">
<title>layer50_attn_allreduce</title>
<ellipse fill="lightpink" stroke="black" cx="301" cy="-3025.97" rx="160.53" ry="36.54"/>
<text text-anchor="middle" x="301" y="-3039.97" font-family="Arial" font-size="10.00">Layer 50: Attention All&#45;Reduce</text>
<text text-anchor="middle" x="301" y="-3028.97" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-3017.97" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, heads=16, d_k=128]</text>
<text text-anchor="middle" x="301" y="-3006.97" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer50_attention&#45;&gt;layer50_attn_allreduce -->
<g id="edge60" class="edge">
<title>layer50_attention&#45;&gt;layer50_attn_allreduce</title>
<path fill="none" stroke="black" d="M301,-3098.57C301,-3090.76 301,-3081.89 301,-3073.12"/>
<polygon fill="black" stroke="black" points="304.5,-3072.95 301,-3062.95 297.5,-3072.95 304.5,-3072.95"/>
</g>
<!-- layer50_norm2 -->
<g id="node63" class="node">
<title>layer50_norm2</title>
<polygon fill="lightblue" stroke="black" points="402.5,-2953.2 199.5,-2953.2 199.5,-2901.2 402.5,-2901.2 402.5,-2953.2"/>
<text text-anchor="middle" x="301" y="-2941.2" font-family="Arial" font-size="10.00">Layer 50: RMSNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="301" y="-2930.2" font-family="Arial" font-size="10.00">GPU: [4,5,6,7]</text>
<text text-anchor="middle" x="301" y="-2919.2" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-2908.2" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer50_attn_allreduce&#45;&gt;layer50_norm2 -->
<g id="edge61" class="edge">
<title>layer50_attn_allreduce&#45;&gt;layer50_norm2</title>
<path fill="none" stroke="black" d="M301,-2988.94C301,-2980.62 301,-2971.79 301,-2963.51"/>
<polygon fill="black" stroke="black" points="304.5,-2963.4 301,-2953.4 297.5,-2963.4 304.5,-2963.4"/>
</g>
<!-- layer50_ffn_gate -->
<g id="node64" class="node">
<title>layer50_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="425,-2865.2 177,-2865.2 177,-2813.2 425,-2813.2 425,-2865.2"/>
<text text-anchor="middle" x="301" y="-2853.2" font-family="Arial" font-size="10.00">Layer 50: FFN Gate Proj</text>
<text text-anchor="middle" x="301" y="-2842.2" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-2831.2" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-2820.2" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, ffn_dim=2752] per GPU</text>
</g>
<!-- layer50_norm2&#45;&gt;layer50_ffn_gate -->
<g id="edge62" class="edge">
<title>layer50_norm2&#45;&gt;layer50_ffn_gate</title>
<path fill="none" stroke="black" d="M301,-2900.86C301,-2892.9 301,-2883.96 301,-2875.45"/>
<polygon fill="black" stroke="black" points="304.5,-2875.36 301,-2865.36 297.5,-2875.36 304.5,-2875.36"/>
</g>
<!-- layer50_ffn_up -->
<g id="node65" class="node">
<title>layer50_ffn_up</title>
<polygon fill="lightblue" stroke="black" points="425,-2777.2 177,-2777.2 177,-2725.2 425,-2725.2 425,-2777.2"/>
<text text-anchor="middle" x="301" y="-2765.2" font-family="Arial" font-size="10.00">Layer 50: FFN Up Proj</text>
<text text-anchor="middle" x="301" y="-2754.2" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-2743.2" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-2732.2" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, ffn_dim=2752] per GPU</text>
</g>
<!-- layer50_ffn_gate&#45;&gt;layer50_ffn_up -->
<g id="edge63" class="edge">
<title>layer50_ffn_gate&#45;&gt;layer50_ffn_up</title>
<path fill="none" stroke="black" d="M301,-2812.86C301,-2804.9 301,-2795.96 301,-2787.45"/>
<polygon fill="black" stroke="black" points="304.5,-2787.36 301,-2777.36 297.5,-2787.36 304.5,-2787.36"/>
</g>
<!-- layer50_ffn_down -->
<g id="node66" class="node">
<title>layer50_ffn_down</title>
<polygon fill="lightblue" stroke="black" points="423.5,-2689.2 178.5,-2689.2 178.5,-2637.2 423.5,-2637.2 423.5,-2689.2"/>
<text text-anchor="middle" x="301" y="-2677.2" font-family="Arial" font-size="10.00">Layer 50: FFN Down Proj</text>
<text text-anchor="middle" x="301" y="-2666.2" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-2655.2" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, ffn_dim=2752]</text>
<text text-anchor="middle" x="301" y="-2644.2" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192] per GPU</text>
</g>
<!-- layer50_ffn_up&#45;&gt;layer50_ffn_down -->
<g id="edge64" class="edge">
<title>layer50_ffn_up&#45;&gt;layer50_ffn_down</title>
<path fill="none" stroke="black" d="M301,-2724.86C301,-2716.9 301,-2707.96 301,-2699.45"/>
<polygon fill="black" stroke="black" points="304.5,-2699.36 301,-2689.36 297.5,-2699.36 304.5,-2699.36"/>
</g>
<!-- layer50_ffn_allreduce -->
<g id="node67" class="node">
<title>layer50_ffn_allreduce</title>
<ellipse fill="lightpink" stroke="black" cx="301" cy="-2564.43" rx="167.67" ry="36.54"/>
<text text-anchor="middle" x="301" y="-2578.43" font-family="Arial" font-size="10.00">Layer 50: FFN All&#45;Reduce</text>
<text text-anchor="middle" x="301" y="-2567.43" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-2556.43" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=2048] per GPU</text>
<text text-anchor="middle" x="301" y="-2545.43" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer50_ffn_down&#45;&gt;layer50_ffn_allreduce -->
<g id="edge65" class="edge">
<title>layer50_ffn_down&#45;&gt;layer50_ffn_allreduce</title>
<path fill="none" stroke="black" d="M301,-2637.03C301,-2629.22 301,-2620.35 301,-2611.59"/>
<polygon fill="black" stroke="black" points="304.5,-2611.41 301,-2601.41 297.5,-2611.41 304.5,-2611.41"/>
</g>
<!-- layer50_intermediate -->
<g id="node68" class="node">
<title>layer50_intermediate</title>
<ellipse fill="lightgray" stroke="black" stroke-dasharray="5,2" cx="301" cy="-2462.67" rx="86.03" ry="28.98"/>
<text text-anchor="middle" x="301" y="-2471.17" font-family="Arial" font-size="10.00">Layers 51&#45;59</text>
<text text-anchor="middle" x="301" y="-2460.17" font-family="Arial" font-size="10.00">Intermediate Processing</text>
<text text-anchor="middle" x="301" y="-2449.17" font-family="Arial" font-size="10.00">GPU: [4,5,6,7]</text>
</g>
<!-- layer50_ffn_allreduce&#45;&gt;layer50_intermediate -->
<g id="edge66" class="edge">
<title>layer50_ffn_allreduce&#45;&gt;layer50_intermediate</title>
<path fill="none" stroke="black" d="M301,-2527.41C301,-2519.17 301,-2510.38 301,-2502.05"/>
<polygon fill="black" stroke="black" points="304.5,-2501.81 301,-2491.81 297.5,-2501.81 304.5,-2501.81"/>
</g>
<!-- layer60_norm1 -->
<g id="node69" class="node">
<title>layer60_norm1</title>
<polygon fill="lightblue" stroke="black" points="402.5,-2397.68 199.5,-2397.68 199.5,-2345.68 402.5,-2345.68 402.5,-2397.68"/>
<text text-anchor="middle" x="301" y="-2385.68" font-family="Arial" font-size="10.00">Layer 60: RMSNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="301" y="-2374.68" font-family="Arial" font-size="10.00">GPU: [4,5,6,7]</text>
<text text-anchor="middle" x="301" y="-2363.68" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-2352.68" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer50_intermediate&#45;&gt;layer60_norm1 -->
<g id="edge67" class="edge">
<title>layer50_intermediate&#45;&gt;layer60_norm1</title>
<path fill="none" stroke="black" d="M301,-2433.51C301,-2425.4 301,-2416.45 301,-2407.97"/>
<polygon fill="black" stroke="black" points="304.5,-2407.94 301,-2397.94 297.5,-2407.94 304.5,-2407.94"/>
</g>
<!-- layer60_qkv_proj -->
<g id="node70" class="node">
<title>layer60_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="418,-2309.68 184,-2309.68 184,-2257.68 418,-2257.68 418,-2309.68"/>
<text text-anchor="middle" x="301" y="-2297.68" font-family="Arial" font-size="10.00">Layer 60: QKV Projection</text>
<text text-anchor="middle" x="301" y="-2286.68" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-2275.68" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-2264.68" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=64, d_k=128]</text>
</g>
<!-- layer60_norm1&#45;&gt;layer60_qkv_proj -->
<g id="edge68" class="edge">
<title>layer60_norm1&#45;&gt;layer60_qkv_proj</title>
<path fill="none" stroke="black" d="M301,-2345.34C301,-2337.38 301,-2328.44 301,-2319.92"/>
<polygon fill="black" stroke="black" points="304.5,-2319.83 301,-2309.83 297.5,-2319.83 304.5,-2319.83"/>
</g>
<!-- layer60_qkv_split -->
<g id="node71" class="node">
<title>layer60_qkv_split</title>
<polygon fill="lightcyan" stroke="black" points="586.21,-2221.68 132.5,-2221.68 15.79,-2117.68 469.5,-2117.68 586.21,-2221.68"/>
<text text-anchor="middle" x="301" y="-2183.68" font-family="Arial" font-size="10.00">Layer 60: QKV Split (TP=4)</text>
<text text-anchor="middle" x="301" y="-2172.68" font-family="Arial" font-size="10.00">GPU: [4,5,6,7]</text>
<text text-anchor="middle" x="301" y="-2161.68" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-2150.68" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=16, d_k=128] per GPU</text>
</g>
<!-- layer60_qkv_proj&#45;&gt;layer60_qkv_split -->
<g id="edge69" class="edge">
<title>layer60_qkv_proj&#45;&gt;layer60_qkv_split</title>
<path fill="none" stroke="black" d="M301,-2257.54C301,-2249.86 301,-2241.05 301,-2232.05"/>
<polygon fill="black" stroke="black" points="304.5,-2231.86 301,-2221.86 297.5,-2231.86 304.5,-2231.86"/>
</g>
<!-- layer60_attention -->
<g id="node72" class="node">
<title>layer60_attention</title>
<polygon fill="lightblue" stroke="black" points="418,-2081.68 184,-2081.68 184,-2029.68 418,-2029.68 418,-2081.68"/>
<text text-anchor="middle" x="301" y="-2069.68" font-family="Arial" font-size="10.00">Layer 60: Attention Compute</text>
<text text-anchor="middle" x="301" y="-2058.68" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-2047.68" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, heads=16, d_k=128]</text>
<text text-anchor="middle" x="301" y="-2036.68" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=16, d_k=128]</text>
</g>
<!-- layer60_qkv_split&#45;&gt;layer60_attention -->
<g id="edge70" class="edge">
<title>layer60_qkv_split&#45;&gt;layer60_attention</title>
<path fill="none" stroke="black" d="M301,-2117.59C301,-2108.93 301,-2100.11 301,-2091.96"/>
<polygon fill="black" stroke="black" points="304.5,-2091.72 301,-2081.72 297.5,-2091.72 304.5,-2091.72"/>
</g>
<!-- layer60_attn_allreduce -->
<g id="node73" class="node">
<title>layer60_attn_allreduce</title>
<ellipse fill="lightpink" stroke="black" cx="301" cy="-1956.91" rx="160.53" ry="36.54"/>
<text text-anchor="middle" x="301" y="-1970.91" font-family="Arial" font-size="10.00">Layer 60: Attention All&#45;Reduce</text>
<text text-anchor="middle" x="301" y="-1959.91" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-1948.91" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, heads=16, d_k=128]</text>
<text text-anchor="middle" x="301" y="-1937.91" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer60_attention&#45;&gt;layer60_attn_allreduce -->
<g id="edge71" class="edge">
<title>layer60_attention&#45;&gt;layer60_attn_allreduce</title>
<path fill="none" stroke="black" d="M301,-2029.51C301,-2021.7 301,-2012.83 301,-2004.06"/>
<polygon fill="black" stroke="black" points="304.5,-2003.89 301,-1993.89 297.5,-2003.89 304.5,-2003.89"/>
</g>
<!-- layer60_norm2 -->
<g id="node74" class="node">
<title>layer60_norm2</title>
<polygon fill="lightblue" stroke="black" points="402.5,-1884.14 199.5,-1884.14 199.5,-1832.14 402.5,-1832.14 402.5,-1884.14"/>
<text text-anchor="middle" x="301" y="-1872.14" font-family="Arial" font-size="10.00">Layer 60: RMSNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="301" y="-1861.14" font-family="Arial" font-size="10.00">GPU: [4,5,6,7]</text>
<text text-anchor="middle" x="301" y="-1850.14" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-1839.14" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer60_attn_allreduce&#45;&gt;layer60_norm2 -->
<g id="edge72" class="edge">
<title>layer60_attn_allreduce&#45;&gt;layer60_norm2</title>
<path fill="none" stroke="black" d="M301,-1919.88C301,-1911.56 301,-1902.73 301,-1894.45"/>
<polygon fill="black" stroke="black" points="304.5,-1894.34 301,-1884.34 297.5,-1894.34 304.5,-1894.34"/>
</g>
<!-- layer60_ffn_gate -->
<g id="node75" class="node">
<title>layer60_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="425,-1796.14 177,-1796.14 177,-1744.14 425,-1744.14 425,-1796.14"/>
<text text-anchor="middle" x="301" y="-1784.14" font-family="Arial" font-size="10.00">Layer 60: FFN Gate Proj</text>
<text text-anchor="middle" x="301" y="-1773.14" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-1762.14" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-1751.14" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, ffn_dim=2752] per GPU</text>
</g>
<!-- layer60_norm2&#45;&gt;layer60_ffn_gate -->
<g id="edge73" class="edge">
<title>layer60_norm2&#45;&gt;layer60_ffn_gate</title>
<path fill="none" stroke="black" d="M301,-1831.8C301,-1823.84 301,-1814.9 301,-1806.38"/>
<polygon fill="black" stroke="black" points="304.5,-1806.3 301,-1796.3 297.5,-1806.3 304.5,-1806.3"/>
</g>
<!-- layer60_ffn_up -->
<g id="node76" class="node">
<title>layer60_ffn_up</title>
<polygon fill="lightblue" stroke="black" points="425,-1708.14 177,-1708.14 177,-1656.14 425,-1656.14 425,-1708.14"/>
<text text-anchor="middle" x="301" y="-1696.14" font-family="Arial" font-size="10.00">Layer 60: FFN Up Proj</text>
<text text-anchor="middle" x="301" y="-1685.14" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-1674.14" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-1663.14" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, ffn_dim=2752] per GPU</text>
</g>
<!-- layer60_ffn_gate&#45;&gt;layer60_ffn_up -->
<g id="edge74" class="edge">
<title>layer60_ffn_gate&#45;&gt;layer60_ffn_up</title>
<path fill="none" stroke="black" d="M301,-1743.8C301,-1735.84 301,-1726.9 301,-1718.38"/>
<polygon fill="black" stroke="black" points="304.5,-1718.3 301,-1708.3 297.5,-1718.3 304.5,-1718.3"/>
</g>
<!-- layer60_ffn_down -->
<g id="node77" class="node">
<title>layer60_ffn_down</title>
<polygon fill="lightblue" stroke="black" points="423.5,-1620.14 178.5,-1620.14 178.5,-1568.14 423.5,-1568.14 423.5,-1620.14"/>
<text text-anchor="middle" x="301" y="-1608.14" font-family="Arial" font-size="10.00">Layer 60: FFN Down Proj</text>
<text text-anchor="middle" x="301" y="-1597.14" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-1586.14" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, ffn_dim=2752]</text>
<text text-anchor="middle" x="301" y="-1575.14" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192] per GPU</text>
</g>
<!-- layer60_ffn_up&#45;&gt;layer60_ffn_down -->
<g id="edge75" class="edge">
<title>layer60_ffn_up&#45;&gt;layer60_ffn_down</title>
<path fill="none" stroke="black" d="M301,-1655.8C301,-1647.84 301,-1638.9 301,-1630.38"/>
<polygon fill="black" stroke="black" points="304.5,-1630.3 301,-1620.3 297.5,-1630.3 304.5,-1630.3"/>
</g>
<!-- layer60_ffn_allreduce -->
<g id="node78" class="node">
<title>layer60_ffn_allreduce</title>
<ellipse fill="lightpink" stroke="black" cx="301" cy="-1495.37" rx="167.67" ry="36.54"/>
<text text-anchor="middle" x="301" y="-1509.37" font-family="Arial" font-size="10.00">Layer 60: FFN All&#45;Reduce</text>
<text text-anchor="middle" x="301" y="-1498.37" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-1487.37" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=2048] per GPU</text>
<text text-anchor="middle" x="301" y="-1476.37" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer60_ffn_down&#45;&gt;layer60_ffn_allreduce -->
<g id="edge76" class="edge">
<title>layer60_ffn_down&#45;&gt;layer60_ffn_allreduce</title>
<path fill="none" stroke="black" d="M301,-1567.97C301,-1560.16 301,-1551.29 301,-1542.52"/>
<polygon fill="black" stroke="black" points="304.5,-1542.35 301,-1532.35 297.5,-1542.35 304.5,-1542.35"/>
</g>
<!-- layer60_intermediate -->
<g id="node79" class="node">
<title>layer60_intermediate</title>
<ellipse fill="lightgray" stroke="black" stroke-dasharray="5,2" cx="301" cy="-1393.61" rx="86.03" ry="28.98"/>
<text text-anchor="middle" x="301" y="-1402.11" font-family="Arial" font-size="10.00">Layers 61&#45;69</text>
<text text-anchor="middle" x="301" y="-1391.11" font-family="Arial" font-size="10.00">Intermediate Processing</text>
<text text-anchor="middle" x="301" y="-1380.11" font-family="Arial" font-size="10.00">GPU: [4,5,6,7]</text>
</g>
<!-- layer60_ffn_allreduce&#45;&gt;layer60_intermediate -->
<g id="edge77" class="edge">
<title>layer60_ffn_allreduce&#45;&gt;layer60_intermediate</title>
<path fill="none" stroke="black" d="M301,-1458.35C301,-1450.11 301,-1441.32 301,-1432.99"/>
<polygon fill="black" stroke="black" points="304.5,-1432.75 301,-1422.75 297.5,-1432.75 304.5,-1432.75"/>
</g>
<!-- layer70_norm1 -->
<g id="node80" class="node">
<title>layer70_norm1</title>
<polygon fill="lightblue" stroke="black" points="402.5,-1328.62 199.5,-1328.62 199.5,-1276.62 402.5,-1276.62 402.5,-1328.62"/>
<text text-anchor="middle" x="301" y="-1316.62" font-family="Arial" font-size="10.00">Layer 70: RMSNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="301" y="-1305.62" font-family="Arial" font-size="10.00">GPU: [4,5,6,7]</text>
<text text-anchor="middle" x="301" y="-1294.62" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-1283.62" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer60_intermediate&#45;&gt;layer70_norm1 -->
<g id="edge78" class="edge">
<title>layer60_intermediate&#45;&gt;layer70_norm1</title>
<path fill="none" stroke="black" d="M301,-1364.45C301,-1356.34 301,-1347.39 301,-1338.91"/>
<polygon fill="black" stroke="black" points="304.5,-1338.88 301,-1328.88 297.5,-1338.88 304.5,-1338.88"/>
</g>
<!-- layer70_qkv_proj -->
<g id="node81" class="node">
<title>layer70_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="418,-1240.62 184,-1240.62 184,-1188.62 418,-1188.62 418,-1240.62"/>
<text text-anchor="middle" x="301" y="-1228.62" font-family="Arial" font-size="10.00">Layer 70: QKV Projection</text>
<text text-anchor="middle" x="301" y="-1217.62" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-1206.62" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-1195.62" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=64, d_k=128]</text>
</g>
<!-- layer70_norm1&#45;&gt;layer70_qkv_proj -->
<g id="edge79" class="edge">
<title>layer70_norm1&#45;&gt;layer70_qkv_proj</title>
<path fill="none" stroke="black" d="M301,-1276.28C301,-1268.32 301,-1259.38 301,-1250.86"/>
<polygon fill="black" stroke="black" points="304.5,-1250.77 301,-1240.77 297.5,-1250.77 304.5,-1250.77"/>
</g>
<!-- layer70_qkv_split -->
<g id="node82" class="node">
<title>layer70_qkv_split</title>
<polygon fill="lightcyan" stroke="black" points="586.21,-1152.62 132.5,-1152.62 15.79,-1048.62 469.5,-1048.62 586.21,-1152.62"/>
<text text-anchor="middle" x="301" y="-1114.62" font-family="Arial" font-size="10.00">Layer 70: QKV Split (TP=4)</text>
<text text-anchor="middle" x="301" y="-1103.62" font-family="Arial" font-size="10.00">GPU: [4,5,6,7]</text>
<text text-anchor="middle" x="301" y="-1092.62" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-1081.62" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=16, d_k=128] per GPU</text>
</g>
<!-- layer70_qkv_proj&#45;&gt;layer70_qkv_split -->
<g id="edge80" class="edge">
<title>layer70_qkv_proj&#45;&gt;layer70_qkv_split</title>
<path fill="none" stroke="black" d="M301,-1188.48C301,-1180.8 301,-1171.98 301,-1162.99"/>
<polygon fill="black" stroke="black" points="304.5,-1162.8 301,-1152.8 297.5,-1162.8 304.5,-1162.8"/>
</g>
<!-- layer70_attention -->
<g id="node83" class="node">
<title>layer70_attention</title>
<polygon fill="lightblue" stroke="black" points="418,-1012.62 184,-1012.62 184,-960.62 418,-960.62 418,-1012.62"/>
<text text-anchor="middle" x="301" y="-1000.62" font-family="Arial" font-size="10.00">Layer 70: Attention Compute</text>
<text text-anchor="middle" x="301" y="-989.62" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-978.62" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, heads=16, d_k=128]</text>
<text text-anchor="middle" x="301" y="-967.62" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, heads=16, d_k=128]</text>
</g>
<!-- layer70_qkv_split&#45;&gt;layer70_attention -->
<g id="edge81" class="edge">
<title>layer70_qkv_split&#45;&gt;layer70_attention</title>
<path fill="none" stroke="black" d="M301,-1048.53C301,-1039.87 301,-1031.05 301,-1022.9"/>
<polygon fill="black" stroke="black" points="304.5,-1022.66 301,-1012.66 297.5,-1022.66 304.5,-1022.66"/>
</g>
<!-- layer70_attn_allreduce -->
<g id="node84" class="node">
<title>layer70_attn_allreduce</title>
<ellipse fill="lightpink" stroke="black" cx="301" cy="-887.85" rx="160.53" ry="36.54"/>
<text text-anchor="middle" x="301" y="-901.85" font-family="Arial" font-size="10.00">Layer 70: Attention All&#45;Reduce</text>
<text text-anchor="middle" x="301" y="-890.85" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-879.85" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, heads=16, d_k=128]</text>
<text text-anchor="middle" x="301" y="-868.85" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer70_attention&#45;&gt;layer70_attn_allreduce -->
<g id="edge82" class="edge">
<title>layer70_attention&#45;&gt;layer70_attn_allreduce</title>
<path fill="none" stroke="black" d="M301,-960.44C301,-952.64 301,-943.77 301,-935"/>
<polygon fill="black" stroke="black" points="304.5,-934.82 301,-924.82 297.5,-934.82 304.5,-934.82"/>
</g>
<!-- layer70_norm2 -->
<g id="node85" class="node">
<title>layer70_norm2</title>
<polygon fill="lightblue" stroke="black" points="402.5,-815.08 199.5,-815.08 199.5,-763.08 402.5,-763.08 402.5,-815.08"/>
<text text-anchor="middle" x="301" y="-803.08" font-family="Arial" font-size="10.00">Layer 70: RMSNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="301" y="-792.08" font-family="Arial" font-size="10.00">GPU: [4,5,6,7]</text>
<text text-anchor="middle" x="301" y="-781.08" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-770.08" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer70_attn_allreduce&#45;&gt;layer70_norm2 -->
<g id="edge83" class="edge">
<title>layer70_attn_allreduce&#45;&gt;layer70_norm2</title>
<path fill="none" stroke="black" d="M301,-850.81C301,-842.5 301,-833.67 301,-825.39"/>
<polygon fill="black" stroke="black" points="304.5,-825.27 301,-815.27 297.5,-825.27 304.5,-825.27"/>
</g>
<!-- layer70_ffn_gate -->
<g id="node86" class="node">
<title>layer70_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="425,-727.08 177,-727.08 177,-675.08 425,-675.08 425,-727.08"/>
<text text-anchor="middle" x="301" y="-715.08" font-family="Arial" font-size="10.00">Layer 70: FFN Gate Proj</text>
<text text-anchor="middle" x="301" y="-704.08" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-693.08" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-682.08" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, ffn_dim=2752] per GPU</text>
</g>
<!-- layer70_norm2&#45;&gt;layer70_ffn_gate -->
<g id="edge84" class="edge">
<title>layer70_norm2&#45;&gt;layer70_ffn_gate</title>
<path fill="none" stroke="black" d="M301,-762.74C301,-754.78 301,-745.84 301,-737.32"/>
<polygon fill="black" stroke="black" points="304.5,-737.23 301,-727.23 297.5,-737.23 304.5,-737.23"/>
</g>
<!-- layer70_ffn_up -->
<g id="node87" class="node">
<title>layer70_ffn_up</title>
<polygon fill="lightblue" stroke="black" points="425,-639.08 177,-639.08 177,-587.08 425,-587.08 425,-639.08"/>
<text text-anchor="middle" x="301" y="-627.08" font-family="Arial" font-size="10.00">Layer 70: FFN Up Proj</text>
<text text-anchor="middle" x="301" y="-616.08" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-605.08" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-594.08" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, ffn_dim=2752] per GPU</text>
</g>
<!-- layer70_ffn_gate&#45;&gt;layer70_ffn_up -->
<g id="edge85" class="edge">
<title>layer70_ffn_gate&#45;&gt;layer70_ffn_up</title>
<path fill="none" stroke="black" d="M301,-674.74C301,-666.78 301,-657.84 301,-649.32"/>
<polygon fill="black" stroke="black" points="304.5,-649.23 301,-639.23 297.5,-649.23 304.5,-649.23"/>
</g>
<!-- layer70_ffn_down -->
<g id="node88" class="node">
<title>layer70_ffn_down</title>
<polygon fill="lightblue" stroke="black" points="423.5,-551.08 178.5,-551.08 178.5,-499.08 423.5,-499.08 423.5,-551.08"/>
<text text-anchor="middle" x="301" y="-539.08" font-family="Arial" font-size="10.00">Layer 70: FFN Down Proj</text>
<text text-anchor="middle" x="301" y="-528.08" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-517.08" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, ffn_dim=2752]</text>
<text text-anchor="middle" x="301" y="-506.08" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192] per GPU</text>
</g>
<!-- layer70_ffn_up&#45;&gt;layer70_ffn_down -->
<g id="edge86" class="edge">
<title>layer70_ffn_up&#45;&gt;layer70_ffn_down</title>
<path fill="none" stroke="black" d="M301,-586.74C301,-578.78 301,-569.84 301,-561.32"/>
<polygon fill="black" stroke="black" points="304.5,-561.23 301,-551.23 297.5,-561.23 304.5,-561.23"/>
</g>
<!-- layer70_ffn_allreduce -->
<g id="node89" class="node">
<title>layer70_ffn_allreduce</title>
<ellipse fill="lightpink" stroke="black" cx="301" cy="-426.31" rx="167.67" ry="36.54"/>
<text text-anchor="middle" x="301" y="-440.31" font-family="Arial" font-size="10.00">Layer 70: FFN All&#45;Reduce</text>
<text text-anchor="middle" x="301" y="-429.31" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-418.31" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=2048] per GPU</text>
<text text-anchor="middle" x="301" y="-407.31" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer70_ffn_down&#45;&gt;layer70_ffn_allreduce -->
<g id="edge87" class="edge">
<title>layer70_ffn_down&#45;&gt;layer70_ffn_allreduce</title>
<path fill="none" stroke="black" d="M301,-498.91C301,-491.1 301,-482.23 301,-473.46"/>
<polygon fill="black" stroke="black" points="304.5,-473.29 301,-463.29 297.5,-473.29 304.5,-473.29"/>
</g>
<!-- final_norm -->
<g id="node90" class="node">
<title>final_norm</title>
<polygon fill="lightblue" stroke="black" points="402.5,-353.54 199.5,-353.54 199.5,-301.54 402.5,-301.54 402.5,-353.54"/>
<text text-anchor="middle" x="301" y="-341.54" font-family="Arial" font-size="10.00">Final RMSNorm</text>
<text text-anchor="middle" x="301" y="-330.54" font-family="Arial" font-size="10.00">GPU: [4,5,6,7]</text>
<text text-anchor="middle" x="301" y="-319.54" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-308.54" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, hidden=8192]</text>
</g>
<!-- layer70_ffn_allreduce&#45;&gt;final_norm -->
<g id="edge88" class="edge">
<title>layer70_ffn_allreduce&#45;&gt;final_norm</title>
<path fill="none" stroke="black" d="M301,-389.28C301,-380.96 301,-372.13 301,-363.85"/>
<polygon fill="black" stroke="black" points="304.5,-363.74 301,-353.74 297.5,-363.74 304.5,-363.74"/>
</g>
<!-- logits_projection -->
<g id="node91" class="node">
<title>logits_projection</title>
<polygon fill="lightblue" stroke="black" points="427.5,-265.54 174.5,-265.54 174.5,-213.54 427.5,-213.54 427.5,-265.54"/>
<text text-anchor="middle" x="301" y="-253.54" font-family="Arial" font-size="10.00">Logits Projection</text>
<text text-anchor="middle" x="301" y="-242.54" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-231.54" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, hidden=8192]</text>
<text text-anchor="middle" x="301" y="-220.54" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, vocab=128256] per GPU</text>
</g>
<!-- final_norm&#45;&gt;logits_projection -->
<g id="edge89" class="edge">
<title>final_norm&#45;&gt;logits_projection</title>
<path fill="none" stroke="black" d="M301,-301.2C301,-293.24 301,-284.3 301,-275.78"/>
<polygon fill="black" stroke="black" points="304.5,-275.7 301,-265.7 297.5,-275.7 304.5,-275.7"/>
</g>
<!-- logits_allgather -->
<g id="node92" class="node">
<title>logits_allgather</title>
<ellipse fill="lightpink" stroke="black" cx="301" cy="-140.77" rx="169.91" ry="36.54"/>
<text text-anchor="middle" x="301" y="-154.77" font-family="Arial" font-size="10.00">Logits All&#45;Gather</text>
<text text-anchor="middle" x="301" y="-143.77" font-family="Arial" font-size="10.00">GPU: [4,5,6,7] TP=4</text>
<text text-anchor="middle" x="301" y="-132.77" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, vocab=32064] per GPU</text>
<text text-anchor="middle" x="301" y="-121.77" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, vocab=128256]</text>
</g>
<!-- logits_projection&#45;&gt;logits_allgather -->
<g id="edge90" class="edge">
<title>logits_projection&#45;&gt;logits_allgather</title>
<path fill="none" stroke="black" d="M301,-213.37C301,-205.56 301,-196.69 301,-187.92"/>
<polygon fill="black" stroke="black" points="304.5,-187.75 301,-177.75 297.5,-187.75 304.5,-187.75"/>
</g>
<!-- output -->
<g id="node93" class="node">
<title>output</title>
<polygon fill="lightgreen" stroke="black" points="407,-68 195,-68 195,-16 407,-16 407,-68"/>
<text text-anchor="middle" x="301" y="-56" font-family="Arial" font-size="10.00">Final Output</text>
<text text-anchor="middle" x="301" y="-45" font-family="Arial" font-size="10.00">GPU: [4,5,6,7]</text>
<text text-anchor="middle" x="301" y="-34" font-family="Arial" font-size="10.00">Input: [batch=8, seq=4096, vocab=128256]</text>
<text text-anchor="middle" x="301" y="-23" font-family="Arial" font-size="10.00">Output: [batch=8, seq=4096, vocab=128256]</text>
</g>
<!-- logits_allgather&#45;&gt;output -->
<g id="edge91" class="edge">
<title>logits_allgather&#45;&gt;output</title>
<path fill="none" stroke="black" d="M301,-103.74C301,-95.42 301,-86.59 301,-78.31"/>
<polygon fill="black" stroke="black" points="304.5,-78.2 301,-68.2 297.5,-78.2 304.5,-78.2"/>
</g>
<!-- pipeline_comm&#45;&gt;input_stage1 -->
<g id="edge93" class="edge">
<title>pipeline_comm&#45;&gt;input_stage1</title>
<path fill="none" stroke="black" d="M301,-4662.55C301,-4653.22 301,-4643.19 301,-4633.91"/>
<polygon fill="black" stroke="black" points="304.5,-4633.83 301,-4623.83 297.5,-4633.83 304.5,-4633.83"/>
</g>
</g>
</svg>
