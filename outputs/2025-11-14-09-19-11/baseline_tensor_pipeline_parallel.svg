<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_tensor_pipeline_parallel Pages: 1 -->
<svg width="1789pt" height="4856pt"
 viewBox="0.00 0.00 1789.00 4856.49" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 4852.49)">
<title>baseline_tensor_pipeline_parallel</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-4852.49 1785,-4852.49 1785,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_pipeline_stage_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-2393.61 8,-4744.33 1769,-4744.33 1769,-2393.61 8,-2393.61"/>
<text text-anchor="middle" x="888.5" y="-4729.13" font-family="Times,serif" font-size="14.00">Pipeline Stage 0</text>
<text text-anchor="middle" x="888.5" y="-4714.13" font-family="Times,serif" font-size="14.00">Devices: 0&#45;7</text>
<text text-anchor="middle" x="888.5" y="-4699.13" font-family="Times,serif" font-size="14.00">Layers: 0,1</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="16,-3347.83 16,-4683.33 1761,-4683.33 1761,-3347.83 16,-3347.83"/>
<text text-anchor="middle" x="888.5" y="-4668.13" font-family="Times,serif" font-size="14.00">Layer 0 (Pipeline Stage 0)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="934,-2401.61 934,-3339.83 1322,-3339.83 1322,-2401.61 934,-2401.61"/>
<text text-anchor="middle" x="1128" y="-3324.63" font-family="Times,serif" font-size="14.00">Layer 1 (Pipeline Stage 0)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_pipeline_stage_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="853,-116.17 853,-2385.61 1619,-2385.61 1619,-116.17 853,-116.17"/>
<text text-anchor="middle" x="1236" y="-2370.41" font-family="Times,serif" font-size="14.00">Pipeline Stage 1</text>
<text text-anchor="middle" x="1236" y="-2355.41" font-family="Times,serif" font-size="14.00">Devices: 8&#45;15</text>
<text text-anchor="middle" x="1236" y="-2340.41" font-family="Times,serif" font-size="14.00">Layers: 2,3</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="920,-1070.39 920,-2008.61 1308,-2008.61 1308,-1070.39 920,-1070.39"/>
<text text-anchor="middle" x="1114" y="-1993.41" font-family="Times,serif" font-size="14.00">Layer 2 (Pipeline Stage 1)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="914,-124.17 914,-1062.39 1302,-1062.39 1302,-124.17 914,-124.17"/>
<text text-anchor="middle" x="1108" y="-1047.19" font-family="Times,serif" font-size="14.00">Layer 3 (Pipeline Stage 1)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="1289" cy="-4800.41" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1289" y="-4819.21" font-family="Arial" font-size="14.00">Input</text>
<text text-anchor="middle" x="1289" y="-4804.21" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1289" y="-4789.21" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1289" y="-4774.21" font-family="Arial" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer0_norm -->
<g id="node2" class="node">
<title>layer0_norm</title>
<polygon fill="none" stroke="black" points="1300,-4652.33 938,-4652.33 938,-4584.33 1300,-4584.33 1300,-4652.33"/>
<text text-anchor="middle" x="1119" y="-4637.13" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1119" y="-4622.13" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1119" y="-4607.13" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1119" y="-4592.13" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- input&#45;&gt;layer0_norm -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_norm</title>
<path fill="none" stroke="black" d="M1245.22,-4753.03C1218.06,-4724.27 1183.5,-4687.65 1157.41,-4660.02"/>
<polygon fill="black" stroke="black" points="1159.7,-4657.34 1150.29,-4652.47 1154.61,-4662.15 1159.7,-4657.34"/>
</g>
<!-- layer0_residual -->
<g id="node11" class="node">
<title>layer0_residual</title>
<polygon fill="none" stroke="black" points="1477,-3971.99 1115,-3971.99 1115,-3903.99 1477,-3903.99 1477,-3971.99"/>
<text text-anchor="middle" x="1296" y="-3956.79" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1296" y="-3941.79" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1296" y="-3926.79" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1296" y="-3911.79" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- input&#45;&gt;layer0_residual -->
<g id="edge13" class="edge">
<title>input&#45;&gt;layer0_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1478.87,-4768.07C1617.39,-4733.08 1781,-4660.93 1781,-4515.33 1781,-4515.33 1781,-4515.33 1781,-4173.16 1781,-4036.56 1623.05,-3979.61 1487.42,-3955.88"/>
<polygon fill="black" stroke="black" points="1487.73,-3952.39 1477.29,-3954.16 1486.56,-3959.29 1487.73,-3952.39"/>
</g>
<!-- layer0_q_proj -->
<g id="node3" class="node">
<title>layer0_q_proj</title>
<polygon fill="none" stroke="black" points="466,-4430.24 24,-4430.24 24,-4362.24 466,-4362.24 466,-4430.24"/>
<text text-anchor="middle" x="245" y="-4415.04" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="245" y="-4400.04" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="245" y="-4385.04" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="245" y="-4370.04" font-family="Arial" font-size="14.00">GPU: 0&#45;7 (TP: column split)</text>
</g>
<!-- layer0_norm&#45;&gt;layer0_q_proj -->
<g id="edge2" class="edge">
<title>layer0_norm&#45;&gt;layer0_q_proj</title>
<path fill="none" stroke="black" d="M937.94,-4603.88C840.47,-4593.84 718.85,-4576.77 613,-4548.33 508.1,-4520.14 393.2,-4469.56 320.18,-4434.74"/>
<polygon fill="black" stroke="black" points="321.57,-4431.53 311.04,-4430.37 318.55,-4437.84 321.57,-4431.53"/>
</g>
<!-- layer0_k_proj -->
<g id="node4" class="node">
<title>layer0_k_proj</title>
<polygon fill="none" stroke="black" points="1064,-4548.33 622,-4548.33 622,-4480.33 1064,-4480.33 1064,-4548.33"/>
<text text-anchor="middle" x="843" y="-4533.13" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="843" y="-4518.13" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="843" y="-4503.13" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="843" y="-4488.13" font-family="Arial" font-size="14.00">GPU: 0&#45;7 (TP: column split)</text>
</g>
<!-- layer0_norm&#45;&gt;layer0_k_proj -->
<g id="edge3" class="edge">
<title>layer0_norm&#45;&gt;layer0_k_proj</title>
<path fill="none" stroke="black" d="M1029.39,-4584.21C1001.53,-4573.91 970.66,-4562.51 942.19,-4551.98"/>
<polygon fill="black" stroke="black" points="943.22,-4548.64 932.63,-4548.45 940.8,-4555.2 943.22,-4548.64"/>
</g>
<!-- layer0_v_proj -->
<g id="node5" class="node">
<title>layer0_v_proj</title>
<polygon fill="none" stroke="black" points="1615,-4548.33 1173,-4548.33 1173,-4480.33 1615,-4480.33 1615,-4548.33"/>
<text text-anchor="middle" x="1394" y="-4533.13" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1394" y="-4518.13" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1394" y="-4503.13" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="1394" y="-4488.13" font-family="Arial" font-size="14.00">GPU: 0&#45;7 (TP: column split)</text>
</g>
<!-- layer0_norm&#45;&gt;layer0_v_proj -->
<g id="edge4" class="edge">
<title>layer0_norm&#45;&gt;layer0_v_proj</title>
<path fill="none" stroke="black" d="M1208.28,-4584.21C1236.04,-4573.91 1266.8,-4562.51 1295.17,-4551.98"/>
<polygon fill="black" stroke="black" points="1296.53,-4555.21 1304.69,-4548.45 1294.1,-4548.65 1296.53,-4555.21"/>
</g>
<!-- layer0_attention -->
<g id="node8" class="node">
<title>layer0_attention</title>
<polygon fill="none" stroke="black" points="1187.5,-4312.16 756.5,-4312.16 756.5,-4244.16 1187.5,-4244.16 1187.5,-4312.16"/>
<text text-anchor="middle" x="972" y="-4296.96" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="972" y="-4281.96" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="972" y="-4266.96" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="972" y="-4251.96" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer0_q_proj&#45;&gt;layer0_attention -->
<g id="edge7" class="edge">
<title>layer0_q_proj&#45;&gt;layer0_attention</title>
<path fill="none" stroke="black" d="M399.39,-4362.23C424.61,-4357.24 450.5,-4352.37 475,-4348.16 563.37,-4333 661.02,-4318.87 746.2,-4307.4"/>
<polygon fill="black" stroke="black" points="746.81,-4310.85 756.26,-4306.05 745.88,-4303.92 746.81,-4310.85"/>
</g>
<!-- layer0_allgather_k -->
<g id="node6" class="node">
<title>layer0_allgather_k</title>
<ellipse fill="none" stroke="black" cx="797" cy="-4396.24" rx="312.58" ry="48.17"/>
<text text-anchor="middle" x="797" y="-4415.04" font-family="Arial" font-size="14.00">AllGather K</text>
<text text-anchor="middle" x="797" y="-4400.04" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="797" y="-4385.04" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="797" y="-4370.04" font-family="Arial" font-size="14.00">GPU: 0&#45;7 (TP communication)</text>
</g>
<!-- layer0_k_proj&#45;&gt;layer0_allgather_k -->
<g id="edge5" class="edge">
<title>layer0_k_proj&#45;&gt;layer0_allgather_k</title>
<path fill="none" stroke="black" d="M829.82,-4480.06C826.55,-4471.81 822.95,-4462.73 819.37,-4453.7"/>
<polygon fill="black" stroke="black" points="822.61,-4452.36 815.67,-4444.35 816.1,-4454.94 822.61,-4452.36"/>
</g>
<!-- layer0_allgather_v -->
<g id="node7" class="node">
<title>layer0_allgather_v</title>
<ellipse fill="none" stroke="black" cx="1440" cy="-4396.24" rx="312.58" ry="48.17"/>
<text text-anchor="middle" x="1440" y="-4415.04" font-family="Arial" font-size="14.00">AllGather V</text>
<text text-anchor="middle" x="1440" y="-4400.04" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="1440" y="-4385.04" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="1440" y="-4370.04" font-family="Arial" font-size="14.00">GPU: 0&#45;7 (TP communication)</text>
</g>
<!-- layer0_v_proj&#45;&gt;layer0_allgather_v -->
<g id="edge6" class="edge">
<title>layer0_v_proj&#45;&gt;layer0_allgather_v</title>
<path fill="none" stroke="black" d="M1407.18,-4480.06C1410.45,-4471.81 1414.05,-4462.73 1417.63,-4453.7"/>
<polygon fill="black" stroke="black" points="1420.9,-4454.94 1421.33,-4444.35 1414.39,-4452.36 1420.9,-4454.94"/>
</g>
<!-- layer0_allgather_k&#45;&gt;layer0_attention -->
<g id="edge8" class="edge">
<title>layer0_allgather_k&#45;&gt;layer0_attention</title>
<path fill="none" stroke="black" d="M866.42,-4349.2C881.97,-4338.88 898.32,-4328.03 913.39,-4318.04"/>
<polygon fill="black" stroke="black" points="915.7,-4320.71 922.1,-4312.26 911.83,-4314.87 915.7,-4320.71"/>
</g>
<!-- layer0_allgather_v&#45;&gt;layer0_attention -->
<g id="edge9" class="edge">
<title>layer0_allgather_v&#45;&gt;layer0_attention</title>
<path fill="none" stroke="black" d="M1277.96,-4355.05C1224.99,-4341.91 1166.56,-4327.42 1115.09,-4314.65"/>
<polygon fill="black" stroke="black" points="1115.78,-4311.22 1105.23,-4312.21 1114.09,-4318.01 1115.78,-4311.22"/>
</g>
<!-- layer0_out_proj -->
<g id="node9" class="node">
<title>layer0_out_proj</title>
<polygon fill="none" stroke="black" points="1241,-4208.16 879,-4208.16 879,-4140.16 1241,-4140.16 1241,-4208.16"/>
<text text-anchor="middle" x="1060" y="-4192.96" font-family="Arial" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1060" y="-4177.96" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1060" y="-4162.96" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1060" y="-4147.96" font-family="Arial" font-size="14.00">GPU: 0&#45;7 (TP: row split)</text>
</g>
<!-- layer0_attention&#45;&gt;layer0_out_proj -->
<g id="edge10" class="edge">
<title>layer0_attention&#45;&gt;layer0_out_proj</title>
<path fill="none" stroke="black" d="M1000.57,-4244.04C1008.26,-4235.14 1016.66,-4225.4 1024.66,-4216.12"/>
<polygon fill="black" stroke="black" points="1027.39,-4218.32 1031.27,-4208.46 1022.09,-4213.75 1027.39,-4218.32"/>
</g>
<!-- layer0_allreduce -->
<g id="node10" class="node">
<title>layer0_allreduce</title>
<ellipse fill="none" stroke="black" cx="1147" cy="-4056.08" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1147" y="-4074.88" font-family="Arial" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="1147" y="-4059.88" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, hidden=512]</text>
<text text-anchor="middle" x="1147" y="-4044.88" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1147" y="-4029.88" font-family="Arial" font-size="14.00">GPU: 0&#45;7 (TP communication)</text>
</g>
<!-- layer0_out_proj&#45;&gt;layer0_allreduce -->
<g id="edge11" class="edge">
<title>layer0_out_proj&#45;&gt;layer0_allreduce</title>
<path fill="none" stroke="black" d="M1084.93,-4139.9C1091.52,-4131.1 1098.81,-4121.38 1106.01,-4111.77"/>
<polygon fill="black" stroke="black" points="1108.82,-4113.86 1112.02,-4103.75 1103.22,-4109.66 1108.82,-4113.86"/>
</g>
<!-- layer0_allreduce&#45;&gt;layer0_residual -->
<g id="edge12" class="edge">
<title>layer0_allreduce&#45;&gt;layer0_residual</title>
<path fill="none" stroke="black" d="M1205.89,-4009.2C1218.97,-3999.01 1232.72,-3988.3 1245.43,-3978.39"/>
<polygon fill="black" stroke="black" points="1247.88,-3980.92 1253.61,-3972.02 1243.57,-3975.4 1247.88,-3980.92"/>
</g>
<!-- layer0_norm2 -->
<g id="node12" class="node">
<title>layer0_norm2</title>
<polygon fill="none" stroke="black" points="1370,-3867.99 1008,-3867.99 1008,-3799.99 1370,-3799.99 1370,-3867.99"/>
<text text-anchor="middle" x="1189" y="-3852.79" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1189" y="-3837.79" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1189" y="-3822.79" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1189" y="-3807.79" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer0_residual&#45;&gt;layer0_norm2 -->
<g id="edge14" class="edge">
<title>layer0_residual&#45;&gt;layer0_norm2</title>
<path fill="none" stroke="black" d="M1261.26,-3903.88C1251.73,-3894.79 1241.29,-3884.84 1231.38,-3875.39"/>
<polygon fill="black" stroke="black" points="1233.58,-3872.66 1223.93,-3868.29 1228.75,-3877.73 1233.58,-3872.66"/>
</g>
<!-- layer0_mlp_residual -->
<g id="node16" class="node">
<title>layer0_mlp_residual</title>
<polygon fill="none" stroke="black" points="1439,-3423.83 1077,-3423.83 1077,-3355.83 1439,-3355.83 1439,-3423.83"/>
<text text-anchor="middle" x="1258" y="-3408.63" font-family="Arial" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="1258" y="-3393.63" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1258" y="-3378.63" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1258" y="-3363.63" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer0_residual&#45;&gt;layer0_mlp_residual -->
<g id="edge19" class="edge">
<title>layer0_residual&#45;&gt;layer0_mlp_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1348.26,-3903.75C1360.19,-3893.69 1371.54,-3881.64 1379,-3867.99 1408.43,-3814.16 1396,-3792.35 1396,-3730.99 1396,-3730.99 1396,-3730.99 1396,-3624.99 1396,-3551.45 1425.59,-3521.8 1386,-3459.83 1378.45,-3448.01 1368.16,-3438.08 1356.67,-3429.76"/>
<polygon fill="black" stroke="black" points="1358.35,-3426.68 1348.11,-3423.99 1354.44,-3432.49 1358.35,-3426.68"/>
</g>
<!-- layer0_mlp_fc1 -->
<g id="node13" class="node">
<title>layer0_mlp_fc1</title>
<polygon fill="none" stroke="black" points="1347,-3763.99 955,-3763.99 955,-3695.99 1347,-3695.99 1347,-3763.99"/>
<text text-anchor="middle" x="1151" y="-3748.79" font-family="Arial" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="1151" y="-3733.79" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1151" y="-3718.79" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="1151" y="-3703.79" font-family="Arial" font-size="14.00">GPU: 0&#45;7 (TP: column split)</text>
</g>
<!-- layer0_norm2&#45;&gt;layer0_mlp_fc1 -->
<g id="edge15" class="edge">
<title>layer0_norm2&#45;&gt;layer0_mlp_fc1</title>
<path fill="none" stroke="black" d="M1176.66,-3799.88C1173.58,-3791.59 1170.22,-3782.59 1166.99,-3773.91"/>
<polygon fill="black" stroke="black" points="1170.18,-3772.44 1163.41,-3764.29 1163.62,-3774.89 1170.18,-3772.44"/>
</g>
<!-- layer0_mlp_fc2 -->
<g id="node14" class="node">
<title>layer0_mlp_fc2</title>
<polygon fill="none" stroke="black" points="1326.5,-3659.99 945.5,-3659.99 945.5,-3591.99 1326.5,-3591.99 1326.5,-3659.99"/>
<text text-anchor="middle" x="1136" y="-3644.79" font-family="Arial" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="1136" y="-3629.79" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="1136" y="-3614.79" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, hidden=512]</text>
<text text-anchor="middle" x="1136" y="-3599.79" font-family="Arial" font-size="14.00">GPU: 0&#45;7 (TP: row split)</text>
</g>
<!-- layer0_mlp_fc1&#45;&gt;layer0_mlp_fc2 -->
<g id="edge16" class="edge">
<title>layer0_mlp_fc1&#45;&gt;layer0_mlp_fc2</title>
<path fill="none" stroke="black" d="M1146.13,-3695.88C1144.94,-3687.77 1143.64,-3678.98 1142.39,-3670.47"/>
<polygon fill="black" stroke="black" points="1145.81,-3669.68 1140.9,-3660.29 1138.89,-3670.7 1145.81,-3669.68"/>
</g>
<!-- layer0_mlp_allreduce -->
<g id="node15" class="node">
<title>layer0_mlp_allreduce</title>
<ellipse fill="none" stroke="black" cx="1121" cy="-3507.91" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1121" y="-3526.71" font-family="Arial" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="1121" y="-3511.71" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, hidden=512]</text>
<text text-anchor="middle" x="1121" y="-3496.71" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1121" y="-3481.71" font-family="Arial" font-size="14.00">GPU: 0&#45;7 (TP communication)</text>
</g>
<!-- layer0_mlp_fc2&#45;&gt;layer0_mlp_allreduce -->
<g id="edge17" class="edge">
<title>layer0_mlp_fc2&#45;&gt;layer0_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1131.7,-3591.73C1130.66,-3583.65 1129.51,-3574.78 1128.37,-3565.94"/>
<polygon fill="black" stroke="black" points="1131.84,-3565.49 1127.09,-3556.02 1124.9,-3566.39 1131.84,-3565.49"/>
</g>
<!-- layer0_mlp_allreduce&#45;&gt;layer0_mlp_residual -->
<g id="edge18" class="edge">
<title>layer0_mlp_allreduce&#45;&gt;layer0_mlp_residual</title>
<path fill="none" stroke="black" d="M1175.54,-3460.7C1187.3,-3450.73 1199.64,-3440.28 1211.08,-3430.59"/>
<polygon fill="black" stroke="black" points="1213.47,-3433.15 1218.84,-3424.01 1208.95,-3427.81 1213.47,-3433.15"/>
</g>
<!-- layer1_norm -->
<g id="node17" class="node">
<title>layer1_norm</title>
<polygon fill="none" stroke="black" points="1225,-3308.83 1141,-3308.83 1141,-3270.83 1225,-3270.83 1225,-3308.83"/>
<text text-anchor="middle" x="1183" y="-3293.63" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1183" y="-3278.63" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer0_mlp_residual&#45;&gt;layer1_norm -->
<g id="edge20" class="edge">
<title>layer0_mlp_residual&#45;&gt;layer1_norm</title>
<path fill="none" stroke="black" d="M1232.61,-3355.65C1222.97,-3343.05 1212.13,-3328.88 1203.04,-3317.02"/>
<polygon fill="black" stroke="black" points="1205.64,-3314.65 1196.78,-3308.84 1200.08,-3318.91 1205.64,-3314.65"/>
</g>
<!-- layer1_residual -->
<g id="node26" class="node">
<title>layer1_residual</title>
<polygon fill="none" stroke="black" points="1289,-2833.35 1193,-2833.35 1193,-2795.35 1289,-2795.35 1289,-2833.35"/>
<text text-anchor="middle" x="1241" y="-2818.15" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1241" y="-2803.15" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer0_mlp_residual&#45;&gt;layer1_residual -->
<g id="edge32" class="edge">
<title>layer0_mlp_residual&#45;&gt;layer1_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1282.14,-3355.77C1304.07,-3322.43 1333,-3268.62 1333,-3216.83 1333,-3216.83 1333,-3216.83 1333,-2977.09 1333,-2923.41 1294.25,-2871.28 1267.04,-2841.3"/>
<polygon fill="black" stroke="black" points="1269.44,-2838.74 1260.06,-2833.8 1264.32,-2843.51 1269.44,-2838.74"/>
</g>
<!-- layer1_q_proj -->
<g id="node18" class="node">
<title>layer1_q_proj</title>
<polygon fill="none" stroke="black" points="1034,-3152.96 942,-3152.96 942,-3114.96 1034,-3114.96 1034,-3152.96"/>
<text text-anchor="middle" x="988" y="-3137.76" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="988" y="-3122.76" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer1_norm&#45;&gt;layer1_q_proj -->
<g id="edge21" class="edge">
<title>layer1_norm&#45;&gt;layer1_q_proj</title>
<path fill="none" stroke="black" d="M1140.91,-3274.16C1118.21,-3265.01 1090.53,-3251.74 1069,-3234.83 1042.77,-3214.22 1019.57,-3183.65 1004.79,-3161.76"/>
<polygon fill="black" stroke="black" points="1007.61,-3159.68 999.18,-3153.26 1001.77,-3163.53 1007.61,-3159.68"/>
</g>
<!-- layer1_k_proj -->
<g id="node19" class="node">
<title>layer1_k_proj</title>
<polygon fill="none" stroke="black" points="1166.5,-3234.83 1077.5,-3234.83 1077.5,-3196.83 1166.5,-3196.83 1166.5,-3234.83"/>
<text text-anchor="middle" x="1122" y="-3219.63" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1122" y="-3204.63" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer1_norm&#45;&gt;layer1_k_proj -->
<g id="edge22" class="edge">
<title>layer1_norm&#45;&gt;layer1_k_proj</title>
<path fill="none" stroke="black" d="M1167.61,-3270.66C1160.51,-3262.28 1151.95,-3252.18 1144.18,-3243"/>
<polygon fill="black" stroke="black" points="1146.73,-3240.61 1137.6,-3235.24 1141.39,-3245.13 1146.73,-3240.61"/>
</g>
<!-- layer1_v_proj -->
<g id="node20" class="node">
<title>layer1_v_proj</title>
<polygon fill="none" stroke="black" points="1289.5,-3234.83 1200.5,-3234.83 1200.5,-3196.83 1289.5,-3196.83 1289.5,-3234.83"/>
<text text-anchor="middle" x="1245" y="-3219.63" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1245" y="-3204.63" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer1_norm&#45;&gt;layer1_v_proj -->
<g id="edge23" class="edge">
<title>layer1_norm&#45;&gt;layer1_v_proj</title>
<path fill="none" stroke="black" d="M1198.65,-3270.66C1205.86,-3262.28 1214.56,-3252.18 1222.46,-3243"/>
<polygon fill="black" stroke="black" points="1225.27,-3245.1 1229.14,-3235.24 1219.97,-3240.53 1225.27,-3245.1"/>
</g>
<!-- layer1_attention -->
<g id="node23" class="node">
<title>layer1_attention</title>
<polygon fill="none" stroke="black" points="1248.5,-3071.09 1109.5,-3071.09 1109.5,-3033.09 1248.5,-3033.09 1248.5,-3071.09"/>
<text text-anchor="middle" x="1179" y="-3055.89" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1179" y="-3040.89" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer1_q_proj&#45;&gt;layer1_attention -->
<g id="edge26" class="edge">
<title>layer1_q_proj&#45;&gt;layer1_attention</title>
<path fill="none" stroke="black" d="M1025.73,-3114.84C1031.49,-3112.18 1037.38,-3109.52 1043,-3107.09 1068.72,-3095.94 1097.54,-3084.37 1122.01,-3074.81"/>
<polygon fill="black" stroke="black" points="1123.45,-3078.01 1131.5,-3071.12 1120.91,-3071.48 1123.45,-3078.01"/>
</g>
<!-- layer1_allgather_k -->
<g id="node21" class="node">
<title>layer1_allgather_k</title>
<ellipse fill="none" stroke="black" cx="1113" cy="-3133.96" rx="60.62" ry="26.74"/>
<text text-anchor="middle" x="1113" y="-3137.76" font-family="Arial" font-size="14.00">AllGather K</text>
<text text-anchor="middle" x="1113" y="-3122.76" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer1_k_proj&#45;&gt;layer1_allgather_k -->
<g id="edge24" class="edge">
<title>layer1_k_proj&#45;&gt;layer1_allgather_k</title>
<path fill="none" stroke="black" d="M1119.96,-3196.7C1119.1,-3189.1 1118.07,-3179.96 1117.07,-3171.08"/>
<polygon fill="black" stroke="black" points="1120.52,-3170.43 1115.92,-3160.88 1113.56,-3171.21 1120.52,-3170.43"/>
</g>
<!-- layer1_allgather_v -->
<g id="node22" class="node">
<title>layer1_allgather_v</title>
<ellipse fill="none" stroke="black" cx="1253" cy="-3133.96" rx="60.62" ry="26.74"/>
<text text-anchor="middle" x="1253" y="-3137.76" font-family="Arial" font-size="14.00">AllGather V</text>
<text text-anchor="middle" x="1253" y="-3122.76" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer1_v_proj&#45;&gt;layer1_allgather_v -->
<g id="edge25" class="edge">
<title>layer1_v_proj&#45;&gt;layer1_allgather_v</title>
<path fill="none" stroke="black" d="M1246.82,-3196.7C1247.58,-3189.1 1248.49,-3179.96 1249.38,-3171.08"/>
<polygon fill="black" stroke="black" points="1252.89,-3171.18 1250.4,-3160.88 1245.92,-3170.49 1252.89,-3171.18"/>
</g>
<!-- layer1_allgather_k&#45;&gt;layer1_attention -->
<g id="edge27" class="edge">
<title>layer1_allgather_k&#45;&gt;layer1_attention</title>
<path fill="none" stroke="black" d="M1133.16,-3108.56C1140.84,-3099.26 1149.62,-3088.64 1157.43,-3079.19"/>
<polygon fill="black" stroke="black" points="1160.32,-3081.19 1163.99,-3071.25 1154.92,-3076.73 1160.32,-3081.19"/>
</g>
<!-- layer1_allgather_v&#45;&gt;layer1_attention -->
<g id="edge28" class="edge">
<title>layer1_allgather_v&#45;&gt;layer1_attention</title>
<path fill="none" stroke="black" d="M1230.4,-3108.56C1221.61,-3099.08 1211.54,-3088.21 1202.65,-3078.62"/>
<polygon fill="black" stroke="black" points="1205.19,-3076.21 1195.83,-3071.25 1200.06,-3080.97 1205.19,-3076.21"/>
</g>
<!-- layer1_out_proj -->
<g id="node24" class="node">
<title>layer1_out_proj</title>
<polygon fill="none" stroke="black" points="1249,-2997.09 1127,-2997.09 1127,-2959.09 1249,-2959.09 1249,-2997.09"/>
<text text-anchor="middle" x="1188" y="-2981.89" font-family="Arial" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1188" y="-2966.89" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer1_attention&#45;&gt;layer1_out_proj -->
<g id="edge29" class="edge">
<title>layer1_attention&#45;&gt;layer1_out_proj</title>
<path fill="none" stroke="black" d="M1181.27,-3032.92C1182.23,-3025.22 1183.38,-3016.06 1184.45,-3007.5"/>
<polygon fill="black" stroke="black" points="1187.93,-3007.86 1185.7,-2997.5 1180.98,-3006.99 1187.93,-3007.86"/>
</g>
<!-- layer1_allreduce -->
<g id="node25" class="node">
<title>layer1_allreduce</title>
<ellipse fill="none" stroke="black" cx="1224" cy="-2896.22" rx="55.31" ry="26.74"/>
<text text-anchor="middle" x="1224" y="-2900.02" font-family="Arial" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="1224" y="-2885.02" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer1_out_proj&#45;&gt;layer1_allreduce -->
<g id="edge30" class="edge">
<title>layer1_out_proj&#45;&gt;layer1_allreduce</title>
<path fill="none" stroke="black" d="M1196.17,-2958.96C1199.81,-2950.89 1204.22,-2941.09 1208.46,-2931.71"/>
<polygon fill="black" stroke="black" points="1211.67,-2933.09 1212.59,-2922.54 1205.29,-2930.21 1211.67,-2933.09"/>
</g>
<!-- layer1_allreduce&#45;&gt;layer1_residual -->
<g id="edge31" class="edge">
<title>layer1_allreduce&#45;&gt;layer1_residual</title>
<path fill="none" stroke="black" d="M1229.57,-2869.06C1231.31,-2860.88 1233.24,-2851.81 1235.01,-2843.49"/>
<polygon fill="black" stroke="black" points="1238.48,-2843.98 1237.14,-2833.47 1231.64,-2842.52 1238.48,-2843.98"/>
</g>
<!-- layer1_norm2 -->
<g id="node27" class="node">
<title>layer1_norm2</title>
<polygon fill="none" stroke="black" points="1280,-2759.35 1196,-2759.35 1196,-2721.35 1280,-2721.35 1280,-2759.35"/>
<text text-anchor="middle" x="1238" y="-2744.15" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1238" y="-2729.15" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer1_residual&#45;&gt;layer1_norm2 -->
<g id="edge33" class="edge">
<title>layer1_residual&#45;&gt;layer1_norm2</title>
<path fill="none" stroke="black" d="M1240.24,-2795.18C1239.92,-2787.48 1239.54,-2778.32 1239.18,-2769.76"/>
<polygon fill="black" stroke="black" points="1242.68,-2769.61 1238.77,-2759.76 1235.69,-2769.9 1242.68,-2769.61"/>
</g>
<!-- layer1_mlp_residual -->
<g id="node31" class="node">
<title>layer1_mlp_residual</title>
<polygon fill="none" stroke="black" points="1300,-2447.61 1172,-2447.61 1172,-2409.61 1300,-2409.61 1300,-2447.61"/>
<text text-anchor="middle" x="1236" y="-2432.41" font-family="Arial" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="1236" y="-2417.41" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer1_residual&#45;&gt;layer1_mlp_residual -->
<g id="edge38" class="edge">
<title>layer1_residual&#45;&gt;layer1_mlp_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1261.71,-2795.3C1271.51,-2785.62 1282.46,-2772.9 1289,-2759.35 1307.03,-2721.97 1305,-2708.85 1305,-2667.35 1305,-2667.35 1305,-2667.35 1305,-2591.35 1305,-2543.26 1316.4,-2526.68 1295,-2483.61 1289.45,-2472.43 1280.53,-2462.45 1271.29,-2454.2"/>
<polygon fill="black" stroke="black" points="1273.43,-2451.43 1263.51,-2447.69 1268.93,-2456.8 1273.43,-2451.43"/>
</g>
<!-- layer1_mlp_fc1 -->
<g id="node28" class="node">
<title>layer1_mlp_fc1</title>
<polygon fill="none" stroke="black" points="1272,-2685.35 1198,-2685.35 1198,-2647.35 1272,-2647.35 1272,-2685.35"/>
<text text-anchor="middle" x="1235" y="-2670.15" font-family="Arial" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="1235" y="-2655.15" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer1_norm2&#45;&gt;layer1_mlp_fc1 -->
<g id="edge34" class="edge">
<title>layer1_norm2&#45;&gt;layer1_mlp_fc1</title>
<path fill="none" stroke="black" d="M1237.24,-2721.18C1236.92,-2713.48 1236.54,-2704.32 1236.18,-2695.76"/>
<polygon fill="black" stroke="black" points="1239.68,-2695.61 1235.77,-2685.76 1232.69,-2695.9 1239.68,-2695.61"/>
</g>
<!-- layer1_mlp_fc2 -->
<g id="node29" class="node">
<title>layer1_mlp_fc2</title>
<polygon fill="none" stroke="black" points="1270,-2611.35 1196,-2611.35 1196,-2573.35 1270,-2573.35 1270,-2611.35"/>
<text text-anchor="middle" x="1233" y="-2596.15" font-family="Arial" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="1233" y="-2581.15" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer1_mlp_fc1&#45;&gt;layer1_mlp_fc2 -->
<g id="edge35" class="edge">
<title>layer1_mlp_fc1&#45;&gt;layer1_mlp_fc2</title>
<path fill="none" stroke="black" d="M1234.5,-2647.18C1234.28,-2639.48 1234.03,-2630.32 1233.79,-2621.76"/>
<polygon fill="black" stroke="black" points="1237.29,-2621.66 1233.51,-2611.76 1230.29,-2621.85 1237.29,-2621.66"/>
</g>
<!-- layer1_mlp_allreduce -->
<g id="node30" class="node">
<title>layer1_mlp_allreduce</title>
<ellipse fill="none" stroke="black" cx="1231" cy="-2510.48" rx="55.31" ry="26.74"/>
<text text-anchor="middle" x="1231" y="-2514.28" font-family="Arial" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="1231" y="-2499.28" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer1_mlp_fc2&#45;&gt;layer1_mlp_allreduce -->
<g id="edge36" class="edge">
<title>layer1_mlp_fc2&#45;&gt;layer1_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1232.55,-2573.22C1232.36,-2565.62 1232.13,-2556.48 1231.9,-2547.6"/>
<polygon fill="black" stroke="black" points="1235.4,-2547.31 1231.65,-2537.4 1228.4,-2547.49 1235.4,-2547.31"/>
</g>
<!-- layer1_mlp_allreduce&#45;&gt;layer1_mlp_residual -->
<g id="edge37" class="edge">
<title>layer1_mlp_allreduce&#45;&gt;layer1_mlp_residual</title>
<path fill="none" stroke="black" d="M1232.64,-2483.32C1233.15,-2475.14 1233.72,-2466.07 1234.24,-2457.75"/>
<polygon fill="black" stroke="black" points="1237.73,-2457.93 1234.87,-2447.73 1230.75,-2457.49 1237.73,-2457.93"/>
</g>
<!-- pipeline_send_0_1 -->
<g id="node32" class="node">
<title>pipeline_send_0_1</title>
<polygon fill="none" stroke="black" points="1611.11,-2324.61 1014.39,-2324.61 860.89,-2188.61 1457.61,-2188.61 1611.11,-2324.61"/>
<text text-anchor="middle" x="1236" y="-2275.41" font-family="Arial" font-size="14.00">Send</text>
<text text-anchor="middle" x="1236" y="-2260.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1236" y="-2245.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1236" y="-2230.41" font-family="Arial" font-size="14.00">GPU: 0&#45;7 â†’ 8&#45;15</text>
</g>
<!-- layer1_mlp_residual&#45;&gt;pipeline_send_0_1 -->
<g id="edge39" class="edge">
<title>layer1_mlp_residual&#45;&gt;pipeline_send_0_1</title>
<path fill="none" stroke="black" d="M1236,-2409.41C1236,-2391.41 1236,-2362.6 1236,-2334.9"/>
<polygon fill="black" stroke="black" points="1239.5,-2334.77 1236,-2324.77 1232.5,-2334.77 1239.5,-2334.77"/>
</g>
<!-- pipeline_recv_1_0 -->
<g id="node33" class="node">
<title>pipeline_recv_1_0</title>
<polygon fill="none" stroke="black" points="1611.11,-2152.61 1014.39,-2152.61 860.89,-2016.61 1457.61,-2016.61 1611.11,-2152.61"/>
<text text-anchor="middle" x="1236" y="-2103.41" font-family="Arial" font-size="14.00">Receive</text>
<text text-anchor="middle" x="1236" y="-2088.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1236" y="-2073.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1236" y="-2058.41" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- pipeline_send_0_1&#45;&gt;pipeline_recv_1_0 -->
<g id="edge40" class="edge">
<title>pipeline_send_0_1&#45;&gt;pipeline_recv_1_0</title>
<path fill="none" stroke="black" d="M1236,-2188.42C1236,-2180.11 1236,-2171.55 1236,-2163.1"/>
<polygon fill="black" stroke="black" points="1239.5,-2162.86 1236,-2152.86 1232.5,-2162.86 1239.5,-2162.86"/>
</g>
<!-- layer2_norm -->
<g id="node34" class="node">
<title>layer2_norm</title>
<polygon fill="none" stroke="black" points="1228,-1977.61 1144,-1977.61 1144,-1939.61 1228,-1939.61 1228,-1977.61"/>
<text text-anchor="middle" x="1186" y="-1962.41" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1186" y="-1947.41" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- pipeline_recv_1_0&#45;&gt;layer2_norm -->
<g id="edge41" class="edge">
<title>pipeline_recv_1_0&#45;&gt;layer2_norm</title>
<path fill="none" stroke="black" d="M1208.95,-2016.53C1204.74,-2006.08 1200.6,-1995.82 1197.03,-1986.96"/>
<polygon fill="black" stroke="black" points="1200.24,-1985.57 1193.26,-1977.61 1193.75,-1988.19 1200.24,-1985.57"/>
</g>
<!-- layer2_residual -->
<g id="node43" class="node">
<title>layer2_residual</title>
<polygon fill="none" stroke="black" points="1283,-1502.13 1187,-1502.13 1187,-1464.13 1283,-1464.13 1283,-1502.13"/>
<text text-anchor="middle" x="1235" y="-1486.93" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1235" y="-1471.93" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- pipeline_recv_1_0&#45;&gt;layer2_residual -->
<g id="edge53" class="edge">
<title>pipeline_recv_1_0&#45;&gt;layer2_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1279.69,-2016.38C1299.68,-1979.34 1319,-1931.64 1319,-1885.61 1319,-1885.61 1319,-1885.61 1319,-1645.87 1319,-1593.23 1283.53,-1540.7 1258.69,-1510.37"/>
<polygon fill="black" stroke="black" points="1261.11,-1507.82 1252,-1502.42 1255.76,-1512.33 1261.11,-1507.82"/>
</g>
<!-- layer2_q_proj -->
<g id="node35" class="node">
<title>layer2_q_proj</title>
<polygon fill="none" stroke="black" points="1020,-1821.74 928,-1821.74 928,-1783.74 1020,-1783.74 1020,-1821.74"/>
<text text-anchor="middle" x="974" y="-1806.54" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="974" y="-1791.54" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer2_norm&#45;&gt;layer2_q_proj -->
<g id="edge42" class="edge">
<title>layer2_norm&#45;&gt;layer2_q_proj</title>
<path fill="none" stroke="black" d="M1143.72,-1946.11C1116.61,-1937.38 1081.63,-1923.44 1055,-1903.61 1028.09,-1883.57 1004.86,-1852.63 990.26,-1830.51"/>
<polygon fill="black" stroke="black" points="993.09,-1828.43 984.73,-1821.91 987.2,-1832.22 993.09,-1828.43"/>
</g>
<!-- layer2_k_proj -->
<g id="node36" class="node">
<title>layer2_k_proj</title>
<polygon fill="none" stroke="black" points="1152.5,-1903.61 1063.5,-1903.61 1063.5,-1865.61 1152.5,-1865.61 1152.5,-1903.61"/>
<text text-anchor="middle" x="1108" y="-1888.41" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1108" y="-1873.41" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer2_norm&#45;&gt;layer2_k_proj -->
<g id="edge43" class="edge">
<title>layer2_norm&#45;&gt;layer2_k_proj</title>
<path fill="none" stroke="black" d="M1166.32,-1939.44C1156.89,-1930.74 1145.46,-1920.19 1135.22,-1910.73"/>
<polygon fill="black" stroke="black" points="1137.4,-1907.98 1127.68,-1903.77 1132.65,-1913.12 1137.4,-1907.98"/>
</g>
<!-- layer2_v_proj -->
<g id="node37" class="node">
<title>layer2_v_proj</title>
<polygon fill="none" stroke="black" points="1275.5,-1903.61 1186.5,-1903.61 1186.5,-1865.61 1275.5,-1865.61 1275.5,-1903.61"/>
<text text-anchor="middle" x="1231" y="-1888.41" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1231" y="-1873.41" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer2_norm&#45;&gt;layer2_v_proj -->
<g id="edge44" class="edge">
<title>layer2_norm&#45;&gt;layer2_v_proj</title>
<path fill="none" stroke="black" d="M1197.36,-1939.44C1202.43,-1931.32 1208.52,-1921.57 1214.12,-1912.62"/>
<polygon fill="black" stroke="black" points="1217.16,-1914.36 1219.49,-1904.02 1211.22,-1910.65 1217.16,-1914.36"/>
</g>
<!-- layer2_attention -->
<g id="node40" class="node">
<title>layer2_attention</title>
<polygon fill="none" stroke="black" points="1234.5,-1739.87 1095.5,-1739.87 1095.5,-1701.87 1234.5,-1701.87 1234.5,-1739.87"/>
<text text-anchor="middle" x="1165" y="-1724.67" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1165" y="-1709.67" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer2_q_proj&#45;&gt;layer2_attention -->
<g id="edge47" class="edge">
<title>layer2_q_proj&#45;&gt;layer2_attention</title>
<path fill="none" stroke="black" d="M1011.73,-1783.62C1017.49,-1780.96 1023.38,-1778.3 1029,-1775.87 1054.72,-1764.72 1083.54,-1753.15 1108.01,-1743.59"/>
<polygon fill="black" stroke="black" points="1109.45,-1746.79 1117.5,-1739.9 1106.91,-1740.26 1109.45,-1746.79"/>
</g>
<!-- layer2_allgather_k -->
<g id="node38" class="node">
<title>layer2_allgather_k</title>
<ellipse fill="none" stroke="black" cx="1099" cy="-1802.74" rx="60.62" ry="26.74"/>
<text text-anchor="middle" x="1099" y="-1806.54" font-family="Arial" font-size="14.00">AllGather K</text>
<text text-anchor="middle" x="1099" y="-1791.54" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer2_k_proj&#45;&gt;layer2_allgather_k -->
<g id="edge45" class="edge">
<title>layer2_k_proj&#45;&gt;layer2_allgather_k</title>
<path fill="none" stroke="black" d="M1105.96,-1865.48C1105.1,-1857.87 1104.07,-1848.74 1103.07,-1839.86"/>
<polygon fill="black" stroke="black" points="1106.52,-1839.21 1101.92,-1829.66 1099.56,-1839.99 1106.52,-1839.21"/>
</g>
<!-- layer2_allgather_v -->
<g id="node39" class="node">
<title>layer2_allgather_v</title>
<ellipse fill="none" stroke="black" cx="1239" cy="-1802.74" rx="60.62" ry="26.74"/>
<text text-anchor="middle" x="1239" y="-1806.54" font-family="Arial" font-size="14.00">AllGather V</text>
<text text-anchor="middle" x="1239" y="-1791.54" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer2_v_proj&#45;&gt;layer2_allgather_v -->
<g id="edge46" class="edge">
<title>layer2_v_proj&#45;&gt;layer2_allgather_v</title>
<path fill="none" stroke="black" d="M1232.82,-1865.48C1233.58,-1857.87 1234.49,-1848.74 1235.38,-1839.86"/>
<polygon fill="black" stroke="black" points="1238.89,-1839.96 1236.4,-1829.66 1231.92,-1839.26 1238.89,-1839.96"/>
</g>
<!-- layer2_allgather_k&#45;&gt;layer2_attention -->
<g id="edge48" class="edge">
<title>layer2_allgather_k&#45;&gt;layer2_attention</title>
<path fill="none" stroke="black" d="M1119.16,-1777.34C1126.84,-1768.04 1135.62,-1757.42 1143.43,-1747.97"/>
<polygon fill="black" stroke="black" points="1146.32,-1749.97 1149.99,-1740.03 1140.92,-1745.51 1146.32,-1749.97"/>
</g>
<!-- layer2_allgather_v&#45;&gt;layer2_attention -->
<g id="edge49" class="edge">
<title>layer2_allgather_v&#45;&gt;layer2_attention</title>
<path fill="none" stroke="black" d="M1216.4,-1777.34C1207.61,-1767.86 1197.54,-1756.99 1188.65,-1747.4"/>
<polygon fill="black" stroke="black" points="1191.19,-1744.99 1181.83,-1740.03 1186.06,-1749.75 1191.19,-1744.99"/>
</g>
<!-- layer2_out_proj -->
<g id="node41" class="node">
<title>layer2_out_proj</title>
<polygon fill="none" stroke="black" points="1245,-1665.87 1123,-1665.87 1123,-1627.87 1245,-1627.87 1245,-1665.87"/>
<text text-anchor="middle" x="1184" y="-1650.67" font-family="Arial" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1184" y="-1635.67" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer2_attention&#45;&gt;layer2_out_proj -->
<g id="edge50" class="edge">
<title>layer2_attention&#45;&gt;layer2_out_proj</title>
<path fill="none" stroke="black" d="M1169.79,-1701.7C1171.85,-1693.91 1174.3,-1684.64 1176.58,-1676"/>
<polygon fill="black" stroke="black" points="1179.97,-1676.84 1179.14,-1666.28 1173.21,-1675.06 1179.97,-1676.84"/>
</g>
<!-- layer2_allreduce -->
<g id="node42" class="node">
<title>layer2_allreduce</title>
<ellipse fill="none" stroke="black" cx="1204" cy="-1565" rx="57.05" ry="26.74"/>
<text text-anchor="middle" x="1204" y="-1568.8" font-family="Arial" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="1204" y="-1553.8" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer2_out_proj&#45;&gt;layer2_allreduce -->
<g id="edge51" class="edge">
<title>layer2_out_proj&#45;&gt;layer2_allreduce</title>
<path fill="none" stroke="black" d="M1188.54,-1627.74C1190.46,-1620.05 1192.78,-1610.8 1195.03,-1601.83"/>
<polygon fill="black" stroke="black" points="1198.47,-1602.47 1197.51,-1591.92 1191.68,-1600.77 1198.47,-1602.47"/>
</g>
<!-- layer2_allreduce&#45;&gt;layer2_residual -->
<g id="edge52" class="edge">
<title>layer2_allreduce&#45;&gt;layer2_residual</title>
<path fill="none" stroke="black" d="M1213.98,-1538.29C1217.24,-1529.9 1220.87,-1520.54 1224.18,-1512"/>
<polygon fill="black" stroke="black" points="1227.53,-1513.04 1227.89,-1502.45 1221.01,-1510.51 1227.53,-1513.04"/>
</g>
<!-- layer2_norm2 -->
<g id="node44" class="node">
<title>layer2_norm2</title>
<polygon fill="none" stroke="black" points="1232,-1428.13 1148,-1428.13 1148,-1390.13 1232,-1390.13 1232,-1428.13"/>
<text text-anchor="middle" x="1190" y="-1412.93" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1190" y="-1397.93" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer2_residual&#45;&gt;layer2_norm2 -->
<g id="edge54" class="edge">
<title>layer2_residual&#45;&gt;layer2_norm2</title>
<path fill="none" stroke="black" d="M1223.64,-1463.96C1218.57,-1455.83 1212.48,-1446.09 1206.88,-1437.14"/>
<polygon fill="black" stroke="black" points="1209.78,-1435.17 1201.51,-1428.54 1203.84,-1438.88 1209.78,-1435.17"/>
</g>
<!-- layer2_mlp_residual -->
<g id="node48" class="node">
<title>layer2_mlp_residual</title>
<polygon fill="none" stroke="black" points="1263,-1116.39 1135,-1116.39 1135,-1078.39 1263,-1078.39 1263,-1116.39"/>
<text text-anchor="middle" x="1199" y="-1101.19" font-family="Arial" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="1199" y="-1086.19" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer2_residual&#45;&gt;layer2_mlp_residual -->
<g id="edge59" class="edge">
<title>layer2_residual&#45;&gt;layer2_mlp_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1239.77,-1463.83C1246.5,-1436.32 1258,-1382.57 1258,-1336.13 1258,-1336.13 1258,-1336.13 1258,-1260.13 1258,-1212.04 1267.38,-1196.4 1248,-1152.39 1243.39,-1141.92 1235.93,-1132.11 1228.21,-1123.81"/>
<polygon fill="black" stroke="black" points="1230.63,-1121.28 1221.12,-1116.63 1225.65,-1126.2 1230.63,-1121.28"/>
</g>
<!-- layer2_mlp_fc1 -->
<g id="node45" class="node">
<title>layer2_mlp_fc1</title>
<polygon fill="none" stroke="black" points="1228.5,-1354.13 1147.5,-1354.13 1147.5,-1316.13 1228.5,-1316.13 1228.5,-1354.13"/>
<text text-anchor="middle" x="1188" y="-1338.93" font-family="Arial" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="1188" y="-1323.93" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer2_norm2&#45;&gt;layer2_mlp_fc1 -->
<g id="edge55" class="edge">
<title>layer2_norm2&#45;&gt;layer2_mlp_fc1</title>
<path fill="none" stroke="black" d="M1189.5,-1389.96C1189.28,-1382.26 1189.03,-1373.1 1188.79,-1364.54"/>
<polygon fill="black" stroke="black" points="1192.29,-1364.44 1188.51,-1354.54 1185.29,-1364.63 1192.29,-1364.44"/>
</g>
<!-- layer2_mlp_fc2 -->
<g id="node46" class="node">
<title>layer2_mlp_fc2</title>
<polygon fill="none" stroke="black" points="1226.5,-1280.13 1145.5,-1280.13 1145.5,-1242.13 1226.5,-1242.13 1226.5,-1280.13"/>
<text text-anchor="middle" x="1186" y="-1264.93" font-family="Arial" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="1186" y="-1249.93" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer2_mlp_fc1&#45;&gt;layer2_mlp_fc2 -->
<g id="edge56" class="edge">
<title>layer2_mlp_fc1&#45;&gt;layer2_mlp_fc2</title>
<path fill="none" stroke="black" d="M1187.5,-1315.96C1187.28,-1308.26 1187.03,-1299.1 1186.79,-1290.54"/>
<polygon fill="black" stroke="black" points="1190.29,-1290.44 1186.51,-1280.54 1183.29,-1290.63 1190.29,-1290.44"/>
</g>
<!-- layer2_mlp_allreduce -->
<g id="node47" class="node">
<title>layer2_mlp_allreduce</title>
<ellipse fill="none" stroke="black" cx="1182" cy="-1179.26" rx="57.05" ry="26.74"/>
<text text-anchor="middle" x="1182" y="-1183.06" font-family="Arial" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="1182" y="-1168.06" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer2_mlp_fc2&#45;&gt;layer2_mlp_allreduce -->
<g id="edge57" class="edge">
<title>layer2_mlp_fc2&#45;&gt;layer2_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1185.09,-1242C1184.71,-1234.39 1184.25,-1225.26 1183.81,-1216.38"/>
<polygon fill="black" stroke="black" points="1187.29,-1216 1183.3,-1206.18 1180.3,-1216.35 1187.29,-1216"/>
</g>
<!-- layer2_mlp_allreduce&#45;&gt;layer2_mlp_residual -->
<g id="edge58" class="edge">
<title>layer2_mlp_allreduce&#45;&gt;layer2_mlp_residual</title>
<path fill="none" stroke="black" d="M1187.57,-1152.1C1189.31,-1143.92 1191.24,-1134.84 1193.01,-1126.52"/>
<polygon fill="black" stroke="black" points="1196.48,-1127.02 1195.14,-1116.51 1189.64,-1125.56 1196.48,-1127.02"/>
</g>
<!-- layer3_norm -->
<g id="node49" class="node">
<title>layer3_norm</title>
<polygon fill="none" stroke="black" points="1215,-1031.39 1131,-1031.39 1131,-993.39 1215,-993.39 1215,-1031.39"/>
<text text-anchor="middle" x="1173" y="-1016.19" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1173" y="-1001.19" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer2_mlp_residual&#45;&gt;layer3_norm -->
<g id="edge60" class="edge">
<title>layer2_mlp_residual&#45;&gt;layer3_norm</title>
<path fill="none" stroke="black" d="M1193.36,-1078.38C1189.97,-1067.58 1185.6,-1053.61 1181.77,-1041.39"/>
<polygon fill="black" stroke="black" points="1185.05,-1040.14 1178.72,-1031.65 1178.37,-1042.24 1185.05,-1040.14"/>
</g>
<!-- layer3_residual -->
<g id="node58" class="node">
<title>layer3_residual</title>
<polygon fill="none" stroke="black" points="1276,-555.91 1180,-555.91 1180,-517.91 1276,-517.91 1276,-555.91"/>
<text text-anchor="middle" x="1228" y="-540.71" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1228" y="-525.71" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer2_mlp_residual&#45;&gt;layer3_residual -->
<g id="edge72" class="edge">
<title>layer2_mlp_residual&#45;&gt;layer3_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1224.3,-1078.24C1257.89,-1051.83 1313,-999.35 1313,-939.39 1313,-939.39 1313,-939.39 1313,-699.65 1313,-646.88 1277.11,-594.39 1251.97,-564.1"/>
<polygon fill="black" stroke="black" points="1254.35,-561.5 1245.2,-556.17 1249.03,-566.05 1254.35,-561.5"/>
</g>
<!-- layer3_q_proj -->
<g id="node50" class="node">
<title>layer3_q_proj</title>
<polygon fill="none" stroke="black" points="1014,-875.52 922,-875.52 922,-837.52 1014,-837.52 1014,-875.52"/>
<text text-anchor="middle" x="968" y="-860.32" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="968" y="-845.32" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer3_norm&#45;&gt;layer3_q_proj -->
<g id="edge61" class="edge">
<title>layer3_norm&#45;&gt;layer3_q_proj</title>
<path fill="none" stroke="black" d="M1130.98,-998.75C1105.63,-989.81 1073.58,-976.07 1049,-957.39 1022.29,-937.08 999.02,-906.2 984.36,-884.15"/>
<polygon fill="black" stroke="black" points="987.19,-882.08 978.81,-875.59 981.32,-885.89 987.19,-882.08"/>
</g>
<!-- layer3_k_proj -->
<g id="node51" class="node">
<title>layer3_k_proj</title>
<polygon fill="none" stroke="black" points="1146.5,-957.39 1057.5,-957.39 1057.5,-919.39 1146.5,-919.39 1146.5,-957.39"/>
<text text-anchor="middle" x="1102" y="-942.19" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1102" y="-927.19" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer3_norm&#45;&gt;layer3_k_proj -->
<g id="edge62" class="edge">
<title>layer3_norm&#45;&gt;layer3_k_proj</title>
<path fill="none" stroke="black" d="M1155.08,-993.22C1146.66,-984.67 1136.46,-974.33 1127.26,-965.01"/>
<polygon fill="black" stroke="black" points="1129.67,-962.46 1120.16,-957.8 1124.69,-967.38 1129.67,-962.46"/>
</g>
<!-- layer3_v_proj -->
<g id="node52" class="node">
<title>layer3_v_proj</title>
<polygon fill="none" stroke="black" points="1269.5,-957.39 1180.5,-957.39 1180.5,-919.39 1269.5,-919.39 1269.5,-957.39"/>
<text text-anchor="middle" x="1225" y="-942.19" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1225" y="-927.19" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer3_norm&#45;&gt;layer3_v_proj -->
<g id="edge63" class="edge">
<title>layer3_norm&#45;&gt;layer3_v_proj</title>
<path fill="none" stroke="black" d="M1186.12,-993.22C1192.05,-985.01 1199.17,-975.15 1205.69,-966.12"/>
<polygon fill="black" stroke="black" points="1208.68,-967.96 1211.7,-957.8 1203.01,-963.86 1208.68,-967.96"/>
</g>
<!-- layer3_attention -->
<g id="node55" class="node">
<title>layer3_attention</title>
<polygon fill="none" stroke="black" points="1171.5,-793.65 1032.5,-793.65 1032.5,-755.65 1171.5,-755.65 1171.5,-793.65"/>
<text text-anchor="middle" x="1102" y="-778.45" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1102" y="-763.45" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer3_q_proj&#45;&gt;layer3_attention -->
<g id="edge66" class="edge">
<title>layer3_q_proj&#45;&gt;layer3_attention</title>
<path fill="none" stroke="black" d="M998.41,-837.39C1017.51,-826.01 1042.34,-811.21 1062.9,-798.95"/>
<polygon fill="black" stroke="black" points="1064.92,-801.83 1071.71,-793.7 1061.33,-795.81 1064.92,-801.83"/>
</g>
<!-- layer3_allgather_k -->
<g id="node53" class="node">
<title>layer3_allgather_k</title>
<ellipse fill="none" stroke="black" cx="1093" cy="-856.52" rx="60.62" ry="26.74"/>
<text text-anchor="middle" x="1093" y="-860.32" font-family="Arial" font-size="14.00">AllGather K</text>
<text text-anchor="middle" x="1093" y="-845.32" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer3_k_proj&#45;&gt;layer3_allgather_k -->
<g id="edge64" class="edge">
<title>layer3_k_proj&#45;&gt;layer3_allgather_k</title>
<path fill="none" stroke="black" d="M1099.96,-919.26C1099.1,-911.65 1098.07,-902.52 1097.07,-893.64"/>
<polygon fill="black" stroke="black" points="1100.52,-892.99 1095.92,-883.44 1093.56,-893.77 1100.52,-892.99"/>
</g>
<!-- layer3_allgather_v -->
<g id="node54" class="node">
<title>layer3_allgather_v</title>
<ellipse fill="none" stroke="black" cx="1233" cy="-856.52" rx="60.62" ry="26.74"/>
<text text-anchor="middle" x="1233" y="-860.32" font-family="Arial" font-size="14.00">AllGather V</text>
<text text-anchor="middle" x="1233" y="-845.32" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer3_v_proj&#45;&gt;layer3_allgather_v -->
<g id="edge65" class="edge">
<title>layer3_v_proj&#45;&gt;layer3_allgather_v</title>
<path fill="none" stroke="black" d="M1226.82,-919.26C1227.58,-911.65 1228.49,-902.52 1229.38,-893.64"/>
<polygon fill="black" stroke="black" points="1232.89,-893.74 1230.4,-883.44 1225.92,-893.04 1232.89,-893.74"/>
</g>
<!-- layer3_allgather_k&#45;&gt;layer3_attention -->
<g id="edge67" class="edge">
<title>layer3_allgather_k&#45;&gt;layer3_attention</title>
<path fill="none" stroke="black" d="M1095.95,-829.36C1096.87,-821.18 1097.89,-812.1 1098.83,-803.78"/>
<polygon fill="black" stroke="black" points="1102.32,-804.1 1099.96,-793.77 1095.36,-803.32 1102.32,-804.1"/>
</g>
<!-- layer3_allgather_v&#45;&gt;layer3_attention -->
<g id="edge68" class="edge">
<title>layer3_allgather_v&#45;&gt;layer3_attention</title>
<path fill="none" stroke="black" d="M1198.24,-834.32C1180.39,-823.44 1158.6,-810.16 1140.28,-798.98"/>
<polygon fill="black" stroke="black" points="1141.95,-795.9 1131.59,-793.69 1138.31,-801.88 1141.95,-795.9"/>
</g>
<!-- layer3_out_proj -->
<g id="node56" class="node">
<title>layer3_out_proj</title>
<polygon fill="none" stroke="black" points="1181,-719.65 1059,-719.65 1059,-681.65 1181,-681.65 1181,-719.65"/>
<text text-anchor="middle" x="1120" y="-704.45" font-family="Arial" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1120" y="-689.45" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer3_attention&#45;&gt;layer3_out_proj -->
<g id="edge69" class="edge">
<title>layer3_attention&#45;&gt;layer3_out_proj</title>
<path fill="none" stroke="black" d="M1106.54,-755.48C1108.49,-747.69 1110.81,-738.42 1112.97,-729.78"/>
<polygon fill="black" stroke="black" points="1116.37,-730.61 1115.4,-720.06 1109.58,-728.91 1116.37,-730.61"/>
</g>
<!-- layer3_allreduce -->
<g id="node57" class="node">
<title>layer3_allreduce</title>
<ellipse fill="none" stroke="black" cx="1156" cy="-618.78" rx="57.05" ry="26.74"/>
<text text-anchor="middle" x="1156" y="-622.58" font-family="Arial" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="1156" y="-607.58" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer3_out_proj&#45;&gt;layer3_allreduce -->
<g id="edge70" class="edge">
<title>layer3_out_proj&#45;&gt;layer3_allreduce</title>
<path fill="none" stroke="black" d="M1128.17,-681.52C1131.74,-673.6 1136.06,-664.02 1140.22,-654.8"/>
<polygon fill="black" stroke="black" points="1143.53,-655.95 1144.45,-645.4 1137.15,-653.08 1143.53,-655.95"/>
</g>
<!-- layer3_allreduce&#45;&gt;layer3_residual -->
<g id="edge71" class="edge">
<title>layer3_allreduce&#45;&gt;layer3_residual</title>
<path fill="none" stroke="black" d="M1177.6,-593.81C1186.23,-584.24 1196.18,-573.2 1204.95,-563.48"/>
<polygon fill="black" stroke="black" points="1207.58,-565.78 1211.68,-556.01 1202.38,-561.1 1207.58,-565.78"/>
</g>
<!-- layer3_norm2 -->
<g id="node59" class="node">
<title>layer3_norm2</title>
<polygon fill="none" stroke="black" points="1232,-481.91 1148,-481.91 1148,-443.91 1232,-443.91 1232,-481.91"/>
<text text-anchor="middle" x="1190" y="-466.71" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1190" y="-451.71" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer3_residual&#45;&gt;layer3_norm2 -->
<g id="edge73" class="edge">
<title>layer3_residual&#45;&gt;layer3_norm2</title>
<path fill="none" stroke="black" d="M1218.41,-517.74C1214.17,-509.7 1209.09,-500.07 1204.4,-491.2"/>
<polygon fill="black" stroke="black" points="1207.48,-489.53 1199.72,-482.32 1201.29,-492.8 1207.48,-489.53"/>
</g>
<!-- layer3_mlp_residual -->
<g id="node63" class="node">
<title>layer3_mlp_residual</title>
<polygon fill="none" stroke="black" points="1284,-170.17 1156,-170.17 1156,-132.17 1284,-132.17 1284,-170.17"/>
<text text-anchor="middle" x="1220" y="-154.97" font-family="Arial" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="1220" y="-139.97" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer3_residual&#45;&gt;layer3_mlp_residual -->
<g id="edge78" class="edge">
<title>layer3_residual&#45;&gt;layer3_mlp_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1234.22,-517.72C1243,-490.33 1258,-436.74 1258,-389.91 1258,-389.91 1258,-389.91 1258,-313.91 1258,-265.82 1261.54,-252.31 1248,-206.17 1245.32,-197.04 1241.06,-187.65 1236.66,-179.31"/>
<polygon fill="black" stroke="black" points="1239.63,-177.45 1231.71,-170.41 1233.52,-180.85 1239.63,-177.45"/>
</g>
<!-- layer3_mlp_fc1 -->
<g id="node60" class="node">
<title>layer3_mlp_fc1</title>
<polygon fill="none" stroke="black" points="1226.5,-407.91 1145.5,-407.91 1145.5,-369.91 1226.5,-369.91 1226.5,-407.91"/>
<text text-anchor="middle" x="1186" y="-392.71" font-family="Arial" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="1186" y="-377.71" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer3_norm2&#45;&gt;layer3_mlp_fc1 -->
<g id="edge74" class="edge">
<title>layer3_norm2&#45;&gt;layer3_mlp_fc1</title>
<path fill="none" stroke="black" d="M1188.99,-443.74C1188.56,-436.04 1188.05,-426.88 1187.58,-418.32"/>
<polygon fill="black" stroke="black" points="1191.07,-418.11 1187.02,-408.32 1184.08,-418.5 1191.07,-418.11"/>
</g>
<!-- layer3_mlp_fc2 -->
<g id="node61" class="node">
<title>layer3_mlp_fc2</title>
<polygon fill="none" stroke="black" points="1224.5,-333.91 1143.5,-333.91 1143.5,-295.91 1224.5,-295.91 1224.5,-333.91"/>
<text text-anchor="middle" x="1184" y="-318.71" font-family="Arial" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="1184" y="-303.71" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer3_mlp_fc1&#45;&gt;layer3_mlp_fc2 -->
<g id="edge75" class="edge">
<title>layer3_mlp_fc1&#45;&gt;layer3_mlp_fc2</title>
<path fill="none" stroke="black" d="M1185.5,-369.74C1185.28,-362.04 1185.03,-352.88 1184.79,-344.32"/>
<polygon fill="black" stroke="black" points="1188.29,-344.22 1184.51,-334.32 1181.29,-344.41 1188.29,-344.22"/>
</g>
<!-- layer3_mlp_allreduce -->
<g id="node62" class="node">
<title>layer3_mlp_allreduce</title>
<ellipse fill="none" stroke="black" cx="1182" cy="-233.04" rx="57.05" ry="26.74"/>
<text text-anchor="middle" x="1182" y="-236.84" font-family="Arial" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="1182" y="-221.84" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer3_mlp_fc2&#45;&gt;layer3_mlp_allreduce -->
<g id="edge76" class="edge">
<title>layer3_mlp_fc2&#45;&gt;layer3_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1183.55,-295.78C1183.36,-288.17 1183.13,-279.04 1182.9,-270.16"/>
<polygon fill="black" stroke="black" points="1186.4,-269.87 1182.65,-259.96 1179.4,-270.05 1186.4,-269.87"/>
</g>
<!-- layer3_mlp_allreduce&#45;&gt;layer3_mlp_residual -->
<g id="edge77" class="edge">
<title>layer3_mlp_allreduce&#45;&gt;layer3_mlp_residual</title>
<path fill="none" stroke="black" d="M1194.02,-206.77C1198.18,-198.04 1202.84,-188.23 1207.06,-179.35"/>
<polygon fill="black" stroke="black" points="1210.29,-180.72 1211.42,-170.19 1203.97,-177.72 1210.29,-180.72"/>
</g>
<!-- output -->
<g id="node64" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="1220" cy="-48.08" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1220" y="-66.88" font-family="Arial" font-size="14.00">Output</text>
<text text-anchor="middle" x="1220" y="-51.88" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1220" y="-36.88" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=100000, hidden=4096]</text>
<text text-anchor="middle" x="1220" y="-21.88" font-family="Arial" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer3_mlp_residual&#45;&gt;output -->
<g id="edge79" class="edge">
<title>layer3_mlp_residual&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1220,-132.09C1220,-124.76 1220,-115.83 1220,-106.59"/>
<polygon fill="black" stroke="black" points="1223.5,-106.5 1220,-96.5 1216.5,-106.5 1223.5,-106.5"/>
</g>
</g>
</svg>
