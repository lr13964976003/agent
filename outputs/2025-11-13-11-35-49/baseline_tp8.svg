<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Llama3_405B_Baseline_TP8 Pages: 1 -->
<svg width="1709pt" height="1799pt"
 viewBox="0.00 0.00 1708.50 1799.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1795)">
<title>Llama3_405B_Baseline_TP8</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1795 1704.5,-1795 1704.5,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_attention_layer_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-449 8,-1508 1565,-1508 1565,-449 8,-449"/>
<text text-anchor="middle" x="786.5" y="-1492.8" font-family="Times,serif" font-size="14.00">Attention Layer 1 (TP8 across GPUs 0&#45;7)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="1547.59,-1791 849.89,-1791 670.41,-1715 1368.11,-1715 1547.59,-1791"/>
<text text-anchor="middle" x="1109" y="-1756.8" font-family="Times,serif" font-size="14.00">Model Input</text>
<text text-anchor="middle" x="1109" y="-1741.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=128000, d_model=16384]</text>
</g>
<!-- embedding -->
<g id="node2" class="node">
<title>embedding</title>
<polygon fill="lightyellow" stroke="black" points="1326.5,-1678 891.5,-1678 891.5,-1625 1326.5,-1625 1326.5,-1678"/>
<text text-anchor="middle" x="1109" y="-1662.8" font-family="Times,serif" font-size="14.00">Token Embedding</text>
<text text-anchor="middle" x="1109" y="-1647.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=128000]</text>
<text text-anchor="middle" x="1109" y="-1632.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=128000, d_model=16384]</text>
</g>
<!-- input&#45;&gt;embedding -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embedding</title>
<path fill="none" stroke="black" d="M1109,-1714.95C1109,-1706.23 1109,-1696.95 1109,-1688.29"/>
<polygon fill="black" stroke="black" points="1112.5,-1688.1 1109,-1678.1 1105.5,-1688.1 1112.5,-1688.1"/>
</g>
<!-- layer_norm_0 -->
<g id="node3" class="node">
<title>layer_norm_0</title>
<polygon fill="pink" stroke="black" points="1326.5,-1588 891.5,-1588 891.5,-1535 1326.5,-1535 1326.5,-1588"/>
<text text-anchor="middle" x="1109" y="-1572.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1109" y="-1557.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=128000, d_model=16384]</text>
<text text-anchor="middle" x="1109" y="-1542.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=128000, d_model=16384]</text>
</g>
<!-- embedding&#45;&gt;layer_norm_0 -->
<g id="edge2" class="edge">
<title>embedding&#45;&gt;layer_norm_0</title>
<path fill="none" stroke="black" d="M1109,-1624.57C1109,-1616.34 1109,-1607.08 1109,-1598.28"/>
<polygon fill="black" stroke="black" points="1112.5,-1598.24 1109,-1588.24 1105.5,-1598.24 1112.5,-1598.24"/>
</g>
<!-- q_proj_1 -->
<g id="node4" class="node">
<title>q_proj_1</title>
<polygon fill="lightblue" stroke="black" points="514,-1477 16,-1477 16,-1409 514,-1409 514,-1477"/>
<text text-anchor="middle" x="265" y="-1461.8" font-family="Times,serif" font-size="14.00">Query Projection</text>
<text text-anchor="middle" x="265" y="-1446.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=128000, d_model=16384]</text>
<text text-anchor="middle" x="265" y="-1431.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=128000, heads=128, d_head=128]</text>
<text text-anchor="middle" x="265" y="-1416.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- layer_norm_0&#45;&gt;q_proj_1 -->
<g id="edge3" class="edge">
<title>layer_norm_0&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M891.3,-1548.9C780.77,-1541 644.69,-1528.2 524,-1508 480.76,-1500.76 434.08,-1490.12 392.42,-1479.59"/>
<polygon fill="black" stroke="black" points="393.06,-1476.14 382.51,-1477.06 391.33,-1482.93 393.06,-1476.14"/>
</g>
<!-- k_proj_1 -->
<g id="node5" class="node">
<title>k_proj_1</title>
<polygon fill="lightblue" stroke="black" points="1035.5,-1477 532.5,-1477 532.5,-1409 1035.5,-1409 1035.5,-1477"/>
<text text-anchor="middle" x="784" y="-1461.8" font-family="Times,serif" font-size="14.00">Key Projection</text>
<text text-anchor="middle" x="784" y="-1446.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=128000, d_model=16384]</text>
<text text-anchor="middle" x="784" y="-1431.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=128000, kv_heads=8, d_head=128]</text>
<text text-anchor="middle" x="784" y="-1416.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- layer_norm_0&#45;&gt;k_proj_1 -->
<g id="edge4" class="edge">
<title>layer_norm_0&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M1037.68,-1534.93C993.09,-1518.95 934.96,-1498.11 885.6,-1480.42"/>
<polygon fill="black" stroke="black" points="886.77,-1477.12 876.17,-1477.04 884.4,-1483.71 886.77,-1477.12"/>
</g>
<!-- v_proj_1 -->
<g id="node6" class="node">
<title>v_proj_1</title>
<polygon fill="lightblue" stroke="black" points="1556.5,-1477 1053.5,-1477 1053.5,-1409 1556.5,-1409 1556.5,-1477"/>
<text text-anchor="middle" x="1305" y="-1461.8" font-family="Times,serif" font-size="14.00">Value Projection</text>
<text text-anchor="middle" x="1305" y="-1446.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=128000, d_model=16384]</text>
<text text-anchor="middle" x="1305" y="-1431.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=128000, kv_heads=8, d_head=128]</text>
<text text-anchor="middle" x="1305" y="-1416.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- layer_norm_0&#45;&gt;v_proj_1 -->
<g id="edge5" class="edge">
<title>layer_norm_0&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M1152.01,-1534.93C1177.95,-1519.52 1211.49,-1499.58 1240.55,-1482.31"/>
<polygon fill="black" stroke="black" points="1242.61,-1485.16 1249.41,-1477.04 1239.03,-1479.14 1242.61,-1485.16"/>
</g>
<!-- residual_add_1 -->
<g id="node9" class="node">
<title>residual_add_1</title>
<polygon fill="purple" stroke="black" points="1517.5,-1147 1068.5,-1147 1068.5,-1094 1517.5,-1094 1517.5,-1147"/>
<text text-anchor="middle" x="1293" y="-1131.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1293" y="-1116.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=128000, d_model=16384] x 2</text>
<text text-anchor="middle" x="1293" y="-1101.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=128000, d_model=16384]</text>
</g>
<!-- layer_norm_0&#45;&gt;residual_add_1 -->
<g id="edge11" class="edge">
<title>layer_norm_0&#45;&gt;residual_add_1</title>
<path fill="none" stroke="black" d="M1326.67,-1546.25C1434.84,-1537.25 1546.66,-1524.24 1566,-1508 1588.73,-1488.92 1585,-1473.67 1585,-1444 1585,-1444 1585,-1444 1585,-1217 1585,-1186.81 1527.92,-1164.65 1464.23,-1149.32"/>
<polygon fill="black" stroke="black" points="1464.91,-1145.88 1454.37,-1147.01 1463.31,-1152.7 1464.91,-1145.88"/>
</g>
<!-- attention_1 -->
<g id="node7" class="node">
<title>attention_1</title>
<polygon fill="orange" stroke="black" points="1301,-1372 781,-1372 781,-1289 1301,-1289 1301,-1372"/>
<text text-anchor="middle" x="1041" y="-1356.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1041" y="-1341.8" font-family="Times,serif" font-size="14.00">Input Q: [batch_size=1, seq_len=128000, heads=128, d_head=128]</text>
<text text-anchor="middle" x="1041" y="-1326.8" font-family="Times,serif" font-size="14.00">Input K/V: [batch_size=1, seq_len=128000, kv_heads=8, d_head=128]</text>
<text text-anchor="middle" x="1041" y="-1311.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=128000, heads=128, d_head=128]</text>
<text text-anchor="middle" x="1041" y="-1296.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- q_proj_1&#45;&gt;attention_1 -->
<g id="edge6" class="edge">
<title>q_proj_1&#45;&gt;attention_1</title>
<path fill="none" stroke="black" d="M496.77,-1409C582.98,-1396.72 681.53,-1382.69 770.87,-1369.97"/>
<polygon fill="black" stroke="black" points="771.47,-1373.42 780.87,-1368.54 770.48,-1366.49 771.47,-1373.42"/>
</g>
<!-- k_proj_1&#45;&gt;attention_1 -->
<g id="edge7" class="edge">
<title>k_proj_1&#45;&gt;attention_1</title>
<path fill="none" stroke="black" d="M860.76,-1409C884.74,-1398.69 911.6,-1387.14 937.11,-1376.17"/>
<polygon fill="black" stroke="black" points="938.64,-1379.32 946.44,-1372.16 935.87,-1372.89 938.64,-1379.32"/>
</g>
<!-- v_proj_1&#45;&gt;attention_1 -->
<g id="edge8" class="edge">
<title>v_proj_1&#45;&gt;attention_1</title>
<path fill="none" stroke="black" d="M1226.15,-1409C1201.41,-1398.64 1173.69,-1387.04 1147.37,-1376.02"/>
<polygon fill="black" stroke="black" points="1148.71,-1372.79 1138.13,-1372.16 1146.01,-1379.25 1148.71,-1372.79"/>
</g>
<!-- o_proj_1 -->
<g id="node8" class="node">
<title>o_proj_1</title>
<polygon fill="lightblue" stroke="black" points="1421,-1252 935,-1252 935,-1184 1421,-1184 1421,-1252"/>
<text text-anchor="middle" x="1178" y="-1236.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1178" y="-1221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=128000, heads=128, d_head=128]</text>
<text text-anchor="middle" x="1178" y="-1206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=128000, d_model=16384]</text>
<text text-anchor="middle" x="1178" y="-1191.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- attention_1&#45;&gt;o_proj_1 -->
<g id="edge9" class="edge">
<title>attention_1&#45;&gt;o_proj_1</title>
<path fill="none" stroke="black" d="M1091.24,-1288.98C1103.51,-1279.08 1116.64,-1268.49 1128.86,-1258.63"/>
<polygon fill="black" stroke="black" points="1131.16,-1261.27 1136.75,-1252.27 1126.77,-1255.82 1131.16,-1261.27"/>
</g>
<!-- o_proj_1&#45;&gt;residual_add_1 -->
<g id="edge10" class="edge">
<title>o_proj_1&#45;&gt;residual_add_1</title>
<path fill="none" stroke="black" d="M1217.9,-1183.87C1229.71,-1174.06 1242.61,-1163.35 1254.34,-1153.61"/>
<polygon fill="black" stroke="black" points="1256.78,-1156.13 1262.24,-1147.05 1252.31,-1150.74 1256.78,-1156.13"/>
</g>
<!-- attn_layer_norm_1 -->
<g id="node10" class="node">
<title>attn_layer_norm_1</title>
<polygon fill="pink" stroke="black" points="1335.5,-1057 900.5,-1057 900.5,-1004 1335.5,-1004 1335.5,-1057"/>
<text text-anchor="middle" x="1118" y="-1041.8" font-family="Times,serif" font-size="14.00">Post&#45;Attention LayerNorm</text>
<text text-anchor="middle" x="1118" y="-1026.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=128000, d_model=16384]</text>
<text text-anchor="middle" x="1118" y="-1011.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=128000, d_model=16384]</text>
</g>
<!-- residual_add_1&#45;&gt;attn_layer_norm_1 -->
<g id="edge12" class="edge">
<title>residual_add_1&#45;&gt;attn_layer_norm_1</title>
<path fill="none" stroke="black" d="M1241.91,-1093.81C1221.88,-1083.73 1198.74,-1072.1 1177.92,-1061.63"/>
<polygon fill="black" stroke="black" points="1179.36,-1058.44 1168.85,-1057.07 1176.21,-1064.69 1179.36,-1058.44"/>
</g>
<!-- mlp_residual_1 -->
<g id="node16" class="node">
<title>mlp_residual_1</title>
<polygon fill="purple" stroke="black" points="1459.5,-510 1010.5,-510 1010.5,-457 1459.5,-457 1459.5,-510"/>
<text text-anchor="middle" x="1235" y="-494.8" font-family="Times,serif" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="1235" y="-479.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=128000, d_model=16384] x 2</text>
<text text-anchor="middle" x="1235" y="-464.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=128000, d_model=16384]</text>
</g>
<!-- residual_add_1&#45;&gt;mlp_residual_1 -->
<g id="edge20" class="edge">
<title>residual_add_1&#45;&gt;mlp_residual_1</title>
<path fill="none" stroke="black" d="M1323.14,-1093.72C1338.51,-1077.64 1354,-1055.48 1354,-1031.5 1354,-1031.5 1354,-1031.5 1354,-580 1354,-551.8 1333.42,-530.54 1309.38,-515.33"/>
<polygon fill="black" stroke="black" points="1311.15,-512.3 1300.77,-510.19 1307.57,-518.32 1311.15,-512.3"/>
</g>
<!-- gate_proj_1 -->
<g id="node11" class="node">
<title>gate_proj_1</title>
<polygon fill="lightblue" stroke="black" points="1334,-967 906,-967 906,-899 1334,-899 1334,-967"/>
<text text-anchor="middle" x="1120" y="-951.8" font-family="Times,serif" font-size="14.00">Gate Projection</text>
<text text-anchor="middle" x="1120" y="-936.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=128000, d_model=16384]</text>
<text text-anchor="middle" x="1120" y="-921.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=128000, ffn_dim=53248]</text>
<text text-anchor="middle" x="1120" y="-906.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- attn_layer_norm_1&#45;&gt;gate_proj_1 -->
<g id="edge13" class="edge">
<title>attn_layer_norm_1&#45;&gt;gate_proj_1</title>
<path fill="none" stroke="black" d="M1118.54,-1003.91C1118.71,-995.72 1118.9,-986.41 1119.09,-977.32"/>
<polygon fill="black" stroke="black" points="1122.59,-977.29 1119.3,-967.22 1115.6,-977.15 1122.59,-977.29"/>
</g>
<!-- up_proj_1 -->
<g id="node12" class="node">
<title>up_proj_1</title>
<polygon fill="lightblue" stroke="black" points="1101,-881 673,-881 673,-813 1101,-813 1101,-881"/>
<text text-anchor="middle" x="887" y="-865.8" font-family="Times,serif" font-size="14.00">Up Projection</text>
<text text-anchor="middle" x="887" y="-850.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=128000, d_model=16384]</text>
<text text-anchor="middle" x="887" y="-835.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=128000, ffn_dim=53248]</text>
<text text-anchor="middle" x="887" y="-820.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- attn_layer_norm_1&#45;&gt;up_proj_1 -->
<g id="edge14" class="edge">
<title>attn_layer_norm_1&#45;&gt;up_proj_1</title>
<path fill="none" stroke="black" d="M980.6,-1003.93C942.94,-994.12 909.11,-981.69 897,-967 879.92,-946.28 877.56,-916.08 879.4,-891.28"/>
<polygon fill="black" stroke="black" points="882.91,-891.32 880.42,-881.03 875.95,-890.63 882.91,-891.32"/>
</g>
<!-- silu_1 -->
<g id="node13" class="node">
<title>silu_1</title>
<polygon fill="yellow" stroke="black" points="1334,-795 906,-795 906,-742 1334,-742 1334,-795"/>
<text text-anchor="middle" x="1120" y="-779.8" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1120" y="-764.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=128000, ffn_dim=53248]</text>
<text text-anchor="middle" x="1120" y="-749.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=128000, ffn_dim=53248]</text>
</g>
<!-- gate_proj_1&#45;&gt;silu_1 -->
<g id="edge15" class="edge">
<title>gate_proj_1&#45;&gt;silu_1</title>
<path fill="none" stroke="black" d="M1120,-898.72C1120,-871.47 1120,-833 1120,-805.13"/>
<polygon fill="black" stroke="black" points="1123.5,-805.01 1120,-795.01 1116.5,-805.01 1123.5,-805.01"/>
</g>
<!-- elem_mul_1 -->
<g id="node14" class="node">
<title>elem_mul_1</title>
<polygon fill="yellow" stroke="black" points="1334.5,-705 891.5,-705 891.5,-652 1334.5,-652 1334.5,-705"/>
<text text-anchor="middle" x="1113" y="-689.8" font-family="Times,serif" font-size="14.00">Element&#45;wise Multiply</text>
<text text-anchor="middle" x="1113" y="-674.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=128000, ffn_dim=53248] x 2</text>
<text text-anchor="middle" x="1113" y="-659.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=128000, ffn_dim=53248]</text>
</g>
<!-- up_proj_1&#45;&gt;elem_mul_1 -->
<g id="edge16" class="edge">
<title>up_proj_1&#45;&gt;elem_mul_1</title>
<path fill="none" stroke="black" d="M881.27,-812.85C879.34,-790.4 880.9,-761.41 897,-742 908,-728.74 937.11,-717.19 970.52,-707.75"/>
<polygon fill="black" stroke="black" points="971.8,-711.03 980.52,-705.02 969.95,-704.28 971.8,-711.03"/>
</g>
<!-- silu_1&#45;&gt;elem_mul_1 -->
<g id="edge17" class="edge">
<title>silu_1&#45;&gt;elem_mul_1</title>
<path fill="none" stroke="black" d="M1117.94,-741.57C1117.28,-733.34 1116.55,-724.08 1115.85,-715.28"/>
<polygon fill="black" stroke="black" points="1119.33,-714.93 1115.05,-705.24 1112.35,-715.49 1119.33,-714.93"/>
</g>
<!-- down_proj_1 -->
<g id="node15" class="node">
<title>down_proj_1</title>
<polygon fill="lightblue" stroke="black" points="1333.5,-615 898.5,-615 898.5,-547 1333.5,-547 1333.5,-615"/>
<text text-anchor="middle" x="1116" y="-599.8" font-family="Times,serif" font-size="14.00">Down Projection</text>
<text text-anchor="middle" x="1116" y="-584.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=128000, ffn_dim=53248]</text>
<text text-anchor="middle" x="1116" y="-569.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=128000, d_model=16384]</text>
<text text-anchor="middle" x="1116" y="-554.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- elem_mul_1&#45;&gt;down_proj_1 -->
<g id="edge18" class="edge">
<title>elem_mul_1&#45;&gt;down_proj_1</title>
<path fill="none" stroke="black" d="M1113.8,-651.91C1114.06,-643.72 1114.35,-634.41 1114.64,-625.32"/>
<polygon fill="black" stroke="black" points="1118.14,-625.33 1114.96,-615.22 1111.14,-625.11 1118.14,-625.33"/>
</g>
<!-- down_proj_1&#45;&gt;mlp_residual_1 -->
<g id="edge19" class="edge">
<title>down_proj_1&#45;&gt;mlp_residual_1</title>
<path fill="none" stroke="black" d="M1157.29,-546.87C1169.62,-536.97 1183.11,-526.14 1195.34,-516.33"/>
<polygon fill="black" stroke="black" points="1197.56,-519.03 1203.17,-510.05 1193.18,-513.57 1197.56,-519.03"/>
</g>
<!-- layer_126_input -->
<!-- mlp_residual_1&#45;&gt;layer_126_input -->
<g id="edge21" class="edge">
<title>mlp_residual_1&#45;&gt;layer_126_input</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1235,-456.59C1235,-448.31 1235,-439.11 1235,-430.65"/>
<polygon fill="black" stroke="black" points="1238.5,-430.47 1235,-420.47 1231.5,-430.47 1238.5,-430.47"/>
</g>
<!-- layer_126_output -->
<!-- layer_126_input&#45;&gt;layer_126_output -->
<g id="edge22" class="edge">
<title>layer_126_input&#45;&gt;layer_126_output</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1235,-381.97C1235,-370.19 1235,-354.56 1235,-341.16"/>
<polygon fill="black" stroke="black" points="1238.5,-341 1235,-331 1231.5,-341 1238.5,-341"/>
<text text-anchor="middle" x="1321" y="-352.8" font-family="Times,serif" font-size="14.00">... 124 layers skipped ...</text>
</g>
<!-- final_layer_norm -->
<g id="node19" class="node">
<title>final_layer_norm</title>
<polygon fill="pink" stroke="black" points="1452.5,-256 1017.5,-256 1017.5,-203 1452.5,-203 1452.5,-256"/>
<text text-anchor="middle" x="1235" y="-240.8" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="1235" y="-225.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=128000, d_model=16384]</text>
<text text-anchor="middle" x="1235" y="-210.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=128000, d_model=16384]</text>
</g>
<!-- layer_126_output&#45;&gt;final_layer_norm -->
<g id="edge23" class="edge">
<title>layer_126_output&#45;&gt;final_layer_norm</title>
<path fill="none" stroke="black" d="M1235,-292.73C1235,-284.85 1235,-275.34 1235,-266.15"/>
<polygon fill="black" stroke="black" points="1238.5,-266.02 1235,-256.02 1231.5,-266.02 1238.5,-266.02"/>
</g>
<!-- output_projection -->
<g id="node20" class="node">
<title>output_projection</title>
<polygon fill="lightblue" stroke="black" points="1465.5,-166 1004.5,-166 1004.5,-113 1465.5,-113 1465.5,-166"/>
<text text-anchor="middle" x="1235" y="-150.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1235" y="-135.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=128000, d_model=16384]</text>
<text text-anchor="middle" x="1235" y="-120.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=128000, vocab_size=128256]</text>
</g>
<!-- final_layer_norm&#45;&gt;output_projection -->
<g id="edge24" class="edge">
<title>final_layer_norm&#45;&gt;output_projection</title>
<path fill="none" stroke="black" d="M1235,-202.57C1235,-194.34 1235,-185.08 1235,-176.28"/>
<polygon fill="black" stroke="black" points="1238.5,-176.24 1235,-166.24 1231.5,-176.24 1238.5,-176.24"/>
</g>
<!-- output -->
<g id="node21" class="node">
<title>output</title>
<polygon fill="lightgreen" stroke="black" points="1700.5,-76 959.99,-76 769.5,0 1510.01,0 1700.5,-76"/>
<text text-anchor="middle" x="1235" y="-41.8" font-family="Times,serif" font-size="14.00">Model Output</text>
<text text-anchor="middle" x="1235" y="-26.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=128000, vocab_size=128256]</text>
</g>
<!-- output_projection&#45;&gt;output -->
<g id="edge25" class="edge">
<title>output_projection&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1235,-112.88C1235,-104.76 1235,-95.51 1235,-86.37"/>
<polygon fill="black" stroke="black" points="1238.5,-86.17 1235,-76.17 1231.5,-86.17 1238.5,-86.17"/>
</g>
</g>
</svg>
