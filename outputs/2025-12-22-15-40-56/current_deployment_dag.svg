<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: current_deployment_dag Pages: 1 -->
<svg width="1006pt" height="2410pt"
 viewBox="0.00 0.00 1006.00 2409.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2405.72)">
<title>current_deployment_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2405.72 1002,-2405.72 1002,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="589.5" cy="-2364.24" rx="267.99" ry="37.45"/>
<text text-anchor="middle" x="589.5" y="-2375.54" font-family="Arial" font-size="14.00">Input</text>
<text text-anchor="middle" x="589.5" y="-2360.54" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="589.5" y="-2345.54" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- embed -->
<g id="node2" class="node">
<title>embed</title>
<polygon fill="lightgreen" stroke="black" points="775,-2290.77 404,-2290.77 404,-2222.77 775,-2222.77 775,-2290.77"/>
<text text-anchor="middle" x="589.5" y="-2275.57" font-family="Arial" font-size="14.00">Embedding Layer</text>
<text text-anchor="middle" x="589.5" y="-2260.57" font-family="Arial" font-size="14.00">GPU: TP0&#45;TP7</text>
<text text-anchor="middle" x="589.5" y="-2245.57" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="589.5" y="-2230.57" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=512]</text>
</g>
<!-- input&#45;&gt;embed -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embed</title>
<path fill="none" stroke="black" d="M589.5,-2326.65C589.5,-2318.36 589.5,-2309.48 589.5,-2300.94"/>
<polygon fill="black" stroke="black" points="593,-2300.77 589.5,-2290.77 586,-2300.77 593,-2300.77"/>
</g>
<!-- pp0_start -->
<g id="node3" class="node">
<title>pp0_start</title>
<polygon fill="yellow" stroke="black" points="677.75,-2186.77 537.37,-2186.77 501.25,-2080.77 641.63,-2080.77 677.75,-2186.77"/>
<text text-anchor="middle" x="589.5" y="-2145.07" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="589.5" y="-2130.07" font-family="Arial" font-size="14.00">GPU: PP0</text>
<text text-anchor="middle" x="589.5" y="-2115.07" font-family="Arial" font-size="14.00">Layers 0&#45;7</text>
</g>
<!-- embed&#45;&gt;pp0_start -->
<g id="edge2" class="edge">
<title>embed&#45;&gt;pp0_start</title>
<path fill="none" stroke="black" d="M589.5,-2222.7C589.5,-2214.67 589.5,-2205.82 589.5,-2196.92"/>
<polygon fill="black" stroke="black" points="593,-2196.89 589.5,-2186.89 586,-2196.89 593,-2196.89"/>
</g>
<!-- layer0_attn_q -->
<g id="node4" class="node">
<title>layer0_attn_q</title>
<polygon fill="lightcoral" stroke="black" points="381,-2044.77 0,-2044.77 0,-1976.77 381,-1976.77 381,-2044.77"/>
<text text-anchor="middle" x="190.5" y="-2029.57" font-family="Arial" font-size="14.00">Layer 0: Q Projection</text>
<text text-anchor="middle" x="190.5" y="-2014.57" font-family="Arial" font-size="14.00">GPU: TP0&#45;TP7</text>
<text text-anchor="middle" x="190.5" y="-1999.57" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=512]</text>
<text text-anchor="middle" x="190.5" y="-1984.57" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=64]</text>
</g>
<!-- pp0_start&#45;&gt;layer0_attn_q -->
<g id="edge3" class="edge">
<title>pp0_start&#45;&gt;layer0_attn_q</title>
<path fill="none" stroke="black" d="M510.67,-2108.86C453.21,-2091.44 374.35,-2067.52 309.28,-2047.79"/>
<polygon fill="black" stroke="black" points="309.96,-2044.34 299.37,-2044.78 307.93,-2051.03 309.96,-2044.34"/>
</g>
<!-- layer0_attn_k -->
<g id="node5" class="node">
<title>layer0_attn_k</title>
<polygon fill="lightcoral" stroke="black" points="780,-2044.77 399,-2044.77 399,-1976.77 780,-1976.77 780,-2044.77"/>
<text text-anchor="middle" x="589.5" y="-2029.57" font-family="Arial" font-size="14.00">Layer 0: K Projection</text>
<text text-anchor="middle" x="589.5" y="-2014.57" font-family="Arial" font-size="14.00">GPU: TP0&#45;TP7</text>
<text text-anchor="middle" x="589.5" y="-1999.57" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=512]</text>
<text text-anchor="middle" x="589.5" y="-1984.57" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=64]</text>
</g>
<!-- pp0_start&#45;&gt;layer0_attn_k -->
<g id="edge4" class="edge">
<title>pp0_start&#45;&gt;layer0_attn_k</title>
<path fill="none" stroke="black" d="M589.5,-2080.75C589.5,-2072.19 589.5,-2063.4 589.5,-2055.09"/>
<polygon fill="black" stroke="black" points="593,-2054.86 589.5,-2044.86 586,-2054.86 593,-2054.86"/>
</g>
<!-- layer0_attn_v -->
<g id="node6" class="node">
<title>layer0_attn_v</title>
<polygon fill="lightcoral" stroke="black" points="998,-1940.77 617,-1940.77 617,-1872.77 998,-1872.77 998,-1940.77"/>
<text text-anchor="middle" x="807.5" y="-1925.57" font-family="Arial" font-size="14.00">Layer 0: V Projection</text>
<text text-anchor="middle" x="807.5" y="-1910.57" font-family="Arial" font-size="14.00">GPU: TP0&#45;TP7</text>
<text text-anchor="middle" x="807.5" y="-1895.57" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=512]</text>
<text text-anchor="middle" x="807.5" y="-1880.57" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=64]</text>
</g>
<!-- pp0_start&#45;&gt;layer0_attn_v -->
<g id="edge5" class="edge">
<title>pp0_start&#45;&gt;layer0_attn_v</title>
<path fill="none" stroke="black" d="M655.43,-2120.95C700.13,-2109.35 756.66,-2086.99 788.5,-2044.77 808.46,-2018.3 812.42,-1980.54 811.83,-1951.36"/>
<polygon fill="black" stroke="black" points="815.31,-1950.89 811.43,-1941.04 808.32,-1951.17 815.31,-1950.89"/>
</g>
<!-- layer0_attn_score -->
<g id="node7" class="node">
<title>layer0_attn_score</title>
<polygon fill="lightcoral" stroke="black" points="598.5,-1940.77 176.5,-1940.77 176.5,-1872.77 598.5,-1872.77 598.5,-1940.77"/>
<text text-anchor="middle" x="387.5" y="-1925.57" font-family="Arial" font-size="14.00">Layer 0: Attention Score</text>
<text text-anchor="middle" x="387.5" y="-1910.57" font-family="Arial" font-size="14.00">GPU: TP0&#45;TP7</text>
<text text-anchor="middle" x="387.5" y="-1895.57" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=64]</text>
<text text-anchor="middle" x="387.5" y="-1880.57" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=1024, seq_len=1024, heads=32]</text>
</g>
<!-- layer0_attn_q&#45;&gt;layer0_attn_score -->
<g id="edge6" class="edge">
<title>layer0_attn_q&#45;&gt;layer0_attn_score</title>
<path fill="none" stroke="black" d="M254.46,-1976.65C273.65,-1966.71 294.85,-1955.74 314.58,-1945.52"/>
<polygon fill="black" stroke="black" points="316.25,-1948.6 323.52,-1940.89 313.03,-1942.38 316.25,-1948.6"/>
</g>
<!-- layer0_attn_k&#45;&gt;layer0_attn_score -->
<g id="edge7" class="edge">
<title>layer0_attn_k&#45;&gt;layer0_attn_score</title>
<path fill="none" stroke="black" d="M523.92,-1976.65C504.24,-1966.71 482.5,-1955.74 462.27,-1945.52"/>
<polygon fill="black" stroke="black" points="463.6,-1942.27 453.1,-1940.89 460.45,-1948.52 463.6,-1942.27"/>
</g>
<!-- layer0_attn_out -->
<g id="node9" class="node">
<title>layer0_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="782,-1732.77 411,-1732.77 411,-1664.77 782,-1664.77 782,-1732.77"/>
<text text-anchor="middle" x="596.5" y="-1717.57" font-family="Arial" font-size="14.00">Layer 0: Attention Output</text>
<text text-anchor="middle" x="596.5" y="-1702.57" font-family="Arial" font-size="14.00">GPU: TP0&#45;TP7</text>
<text text-anchor="middle" x="596.5" y="-1687.57" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=64]</text>
<text text-anchor="middle" x="596.5" y="-1672.57" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=512]</text>
</g>
<!-- layer0_attn_v&#45;&gt;layer0_attn_out -->
<g id="edge8" class="edge">
<title>layer0_attn_v&#45;&gt;layer0_attn_out</title>
<path fill="none" stroke="black" d="M785.24,-1872.76C764.56,-1843.49 731.86,-1800.57 697.5,-1768.77 685.99,-1758.12 672.72,-1747.87 659.67,-1738.68"/>
<polygon fill="black" stroke="black" points="661.36,-1735.59 651.14,-1732.8 657.38,-1741.36 661.36,-1735.59"/>
</g>
<!-- layer0_attn_softmax -->
<g id="node8" class="node">
<title>layer0_attn_softmax</title>
<polygon fill="lightcoral" stroke="black" points="688.5,-1836.77 266.5,-1836.77 266.5,-1768.77 688.5,-1768.77 688.5,-1836.77"/>
<text text-anchor="middle" x="477.5" y="-1821.57" font-family="Arial" font-size="14.00">Layer 0: Softmax</text>
<text text-anchor="middle" x="477.5" y="-1806.57" font-family="Arial" font-size="14.00">GPU: TP0&#45;TP7</text>
<text text-anchor="middle" x="477.5" y="-1791.57" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=1024, seq_len=1024, heads=32]</text>
<text text-anchor="middle" x="477.5" y="-1776.57" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=1024, seq_len=1024, heads=32]</text>
</g>
<!-- layer0_attn_score&#45;&gt;layer0_attn_softmax -->
<g id="edge9" class="edge">
<title>layer0_attn_score&#45;&gt;layer0_attn_softmax</title>
<path fill="none" stroke="black" d="M416.72,-1872.65C424.58,-1863.74 433.17,-1854 441.36,-1844.72"/>
<polygon fill="black" stroke="black" points="444.13,-1846.88 448.12,-1837.07 438.88,-1842.25 444.13,-1846.88"/>
</g>
<!-- layer0_attn_softmax&#45;&gt;layer0_attn_out -->
<g id="edge10" class="edge">
<title>layer0_attn_softmax&#45;&gt;layer0_attn_out</title>
<path fill="none" stroke="black" d="M516.14,-1768.65C526.94,-1759.39 538.8,-1749.22 550.01,-1739.61"/>
<polygon fill="black" stroke="black" points="552.34,-1742.23 557.65,-1733.07 547.78,-1736.92 552.34,-1742.23"/>
</g>
<!-- layer0_attn_proj -->
<g id="node10" class="node">
<title>layer0_attn_proj</title>
<polygon fill="lightcoral" stroke="black" points="782,-1628.77 411,-1628.77 411,-1560.77 782,-1560.77 782,-1628.77"/>
<text text-anchor="middle" x="596.5" y="-1613.57" font-family="Arial" font-size="14.00">Layer 0: Output Projection</text>
<text text-anchor="middle" x="596.5" y="-1598.57" font-family="Arial" font-size="14.00">GPU: TP0&#45;TP7</text>
<text text-anchor="middle" x="596.5" y="-1583.57" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=512]</text>
<text text-anchor="middle" x="596.5" y="-1568.57" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=512]</text>
</g>
<!-- layer0_attn_out&#45;&gt;layer0_attn_proj -->
<g id="edge11" class="edge">
<title>layer0_attn_out&#45;&gt;layer0_attn_proj</title>
<path fill="none" stroke="black" d="M596.5,-1664.65C596.5,-1656.54 596.5,-1647.75 596.5,-1639.24"/>
<polygon fill="black" stroke="black" points="600,-1639.07 596.5,-1629.07 593,-1639.07 600,-1639.07"/>
</g>
<!-- layer0_attn_ar -->
<g id="node11" class="node">
<title>layer0_attn_ar</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="596.5" cy="-1487.29" rx="251.96" ry="37.45"/>
<text text-anchor="middle" x="596.5" y="-1498.59" font-family="Arial" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="596.5" y="-1483.59" font-family="Arial" font-size="14.00">TP Group: TP0&#45;TP7</text>
<text text-anchor="middle" x="596.5" y="-1468.59" font-family="Arial" font-size="14.00">Size: [batch_size=128, seq_len=1024, hidden_size=512]</text>
</g>
<!-- layer0_attn_proj&#45;&gt;layer0_attn_ar -->
<g id="edge12" class="edge">
<title>layer0_attn_proj&#45;&gt;layer0_attn_ar</title>
<path fill="none" stroke="black" d="M596.5,-1560.68C596.5,-1552.52 596.5,-1543.62 596.5,-1534.95"/>
<polygon fill="black" stroke="black" points="600,-1534.92 596.5,-1524.92 593,-1534.92 600,-1534.92"/>
</g>
<!-- layer0_gate -->
<g id="node12" class="node">
<title>layer0_gate</title>
<polygon fill="lightyellow" stroke="black" points="981.27,-1413.81 369.19,-1413.81 211.73,-1277.81 823.81,-1277.81 981.27,-1413.81"/>
<text text-anchor="middle" x="596.5" y="-1364.61" font-family="Arial" font-size="14.00">Layer 0: MoE Gate</text>
<text text-anchor="middle" x="596.5" y="-1349.61" font-family="Arial" font-size="14.00">GPU: EP0&#45;EP63</text>
<text text-anchor="middle" x="596.5" y="-1334.61" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=512]</text>
<text text-anchor="middle" x="596.5" y="-1319.61" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=1024, num_experts=64]</text>
</g>
<!-- layer0_attn_ar&#45;&gt;layer0_gate -->
<g id="edge13" class="edge">
<title>layer0_attn_ar&#45;&gt;layer0_gate</title>
<path fill="none" stroke="black" d="M596.5,-1449.64C596.5,-1441.67 596.5,-1432.94 596.5,-1424.05"/>
<polygon fill="black" stroke="black" points="600,-1423.97 596.5,-1413.97 593,-1423.97 600,-1423.97"/>
</g>
<!-- layer0_route -->
<g id="node13" class="node">
<title>layer0_route</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="596.5" cy="-1204.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="596.5" y="-1215.64" font-family="Arial" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="596.5" y="-1200.64" font-family="Arial" font-size="14.00">GPU: EP0&#45;EP63</text>
<text text-anchor="middle" x="596.5" y="-1185.64" font-family="Arial" font-size="14.00">Select 2 experts per token</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route -->
<g id="edge14" class="edge">
<title>layer0_gate&#45;&gt;layer0_route</title>
<path fill="none" stroke="black" d="M596.5,-1277.53C596.5,-1268.91 596.5,-1260.23 596.5,-1252.04"/>
<polygon fill="black" stroke="black" points="600,-1251.96 596.5,-1241.96 593,-1251.96 600,-1251.96"/>
</g>
<!-- layer0_expert0_up -->
<g id="node14" class="node">
<title>layer0_expert0_up</title>
<polygon fill="lightsteelblue" stroke="black" points="587.5,-1130.86 223.5,-1130.86 223.5,-1062.86 587.5,-1062.86 587.5,-1130.86"/>
<text text-anchor="middle" x="405.5" y="-1115.66" font-family="Arial" font-size="14.00">Layer 0: Expert 0 Up&#45;proj</text>
<text text-anchor="middle" x="405.5" y="-1100.66" font-family="Arial" font-size="14.00">GPU: EP0</text>
<text text-anchor="middle" x="405.5" y="-1085.66" font-family="Arial" font-size="14.00">Input: [batch_size=64, seq_len=512, hidden_size=512]</text>
<text text-anchor="middle" x="405.5" y="-1070.66" font-family="Arial" font-size="14.00">Output: [batch_size=64, seq_len=512, hidden_size=2048]</text>
</g>
<!-- layer0_route&#45;&gt;layer0_expert0_up -->
<g id="edge15" class="edge">
<title>layer0_route&#45;&gt;layer0_expert0_up</title>
<path fill="none" stroke="black" d="M538.42,-1171.26C518.15,-1160.07 495.22,-1147.41 474.18,-1135.79"/>
<polygon fill="black" stroke="black" points="475.74,-1132.65 465.29,-1130.88 472.35,-1138.78 475.74,-1132.65"/>
</g>
<!-- layer0_expert1_up -->
<g id="node17" class="node">
<title>layer0_expert1_up</title>
<polygon fill="lightsteelblue" stroke="black" points="969.5,-1130.86 605.5,-1130.86 605.5,-1062.86 969.5,-1062.86 969.5,-1130.86"/>
<text text-anchor="middle" x="787.5" y="-1115.66" font-family="Arial" font-size="14.00">Layer 0: Expert 1 Up&#45;proj</text>
<text text-anchor="middle" x="787.5" y="-1100.66" font-family="Arial" font-size="14.00">GPU: EP1</text>
<text text-anchor="middle" x="787.5" y="-1085.66" font-family="Arial" font-size="14.00">Input: [batch_size=64, seq_len=512, hidden_size=512]</text>
<text text-anchor="middle" x="787.5" y="-1070.66" font-family="Arial" font-size="14.00">Output: [batch_size=64, seq_len=512, hidden_size=2048]</text>
</g>
<!-- layer0_route&#45;&gt;layer0_expert1_up -->
<g id="edge18" class="edge">
<title>layer0_route&#45;&gt;layer0_expert1_up</title>
<path fill="none" stroke="black" d="M654.58,-1171.26C674.85,-1160.07 697.78,-1147.41 718.82,-1135.79"/>
<polygon fill="black" stroke="black" points="720.65,-1138.78 727.71,-1130.88 717.26,-1132.65 720.65,-1138.78"/>
</g>
<!-- layer0_expert0_act -->
<g id="node15" class="node">
<title>layer0_expert0_act</title>
<polygon fill="lightsteelblue" stroke="black" points="587.5,-1026.86 223.5,-1026.86 223.5,-958.86 587.5,-958.86 587.5,-1026.86"/>
<text text-anchor="middle" x="405.5" y="-1011.66" font-family="Arial" font-size="14.00">Layer 0: Expert 0 Activation</text>
<text text-anchor="middle" x="405.5" y="-996.66" font-family="Arial" font-size="14.00">GPU: EP0</text>
<text text-anchor="middle" x="405.5" y="-981.66" font-family="Arial" font-size="14.00">Input: [batch_size=64, seq_len=512, hidden_size=2048]</text>
<text text-anchor="middle" x="405.5" y="-966.66" font-family="Arial" font-size="14.00">Output: [batch_size=64, seq_len=512, hidden_size=2048]</text>
</g>
<!-- layer0_expert0_up&#45;&gt;layer0_expert0_act -->
<g id="edge16" class="edge">
<title>layer0_expert0_up&#45;&gt;layer0_expert0_act</title>
<path fill="none" stroke="black" d="M405.5,-1062.74C405.5,-1054.64 405.5,-1045.84 405.5,-1037.33"/>
<polygon fill="black" stroke="black" points="409,-1037.16 405.5,-1027.16 402,-1037.16 409,-1037.16"/>
</g>
<!-- layer0_expert0_down -->
<g id="node16" class="node">
<title>layer0_expert0_down</title>
<polygon fill="lightsteelblue" stroke="black" points="587.5,-922.86 231.5,-922.86 231.5,-854.86 587.5,-854.86 587.5,-922.86"/>
<text text-anchor="middle" x="409.5" y="-907.66" font-family="Arial" font-size="14.00">Layer 0: Expert 0 Down&#45;proj</text>
<text text-anchor="middle" x="409.5" y="-892.66" font-family="Arial" font-size="14.00">GPU: EP0</text>
<text text-anchor="middle" x="409.5" y="-877.66" font-family="Arial" font-size="14.00">Input: [batch_size=64, seq_len=512, hidden_size=2048]</text>
<text text-anchor="middle" x="409.5" y="-862.66" font-family="Arial" font-size="14.00">Output: [batch_size=64, seq_len=512, hidden_size=512]</text>
</g>
<!-- layer0_expert0_act&#45;&gt;layer0_expert0_down -->
<g id="edge17" class="edge">
<title>layer0_expert0_act&#45;&gt;layer0_expert0_down</title>
<path fill="none" stroke="black" d="M406.8,-958.74C407.12,-950.64 407.46,-941.84 407.8,-933.33"/>
<polygon fill="black" stroke="black" points="411.3,-933.29 408.19,-923.16 404.3,-933.01 411.3,-933.29"/>
</g>
<!-- layer0_ep_a2a -->
<g id="node20" class="node">
<title>layer0_ep_a2a</title>
<ellipse fill="orange" stroke="black" cx="596.5" cy="-781.38" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="596.5" y="-792.68" font-family="Arial" font-size="14.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="596.5" y="-777.68" font-family="Arial" font-size="14.00">EP Group: EP0&#45;EP63</text>
<text text-anchor="middle" x="596.5" y="-762.68" font-family="Arial" font-size="14.00">Token dispatch/combine</text>
</g>
<!-- layer0_expert0_down&#45;&gt;layer0_ep_a2a -->
<g id="edge21" class="edge">
<title>layer0_expert0_down&#45;&gt;layer0_ep_a2a</title>
<path fill="none" stroke="black" d="M468.15,-854.78C488.22,-843.46 510.77,-830.74 531.32,-819.15"/>
<polygon fill="black" stroke="black" points="533.3,-822.05 540.29,-814.09 529.86,-815.95 533.3,-822.05"/>
</g>
<!-- layer0_expert1_act -->
<g id="node18" class="node">
<title>layer0_expert1_act</title>
<polygon fill="lightsteelblue" stroke="black" points="969.5,-1026.86 605.5,-1026.86 605.5,-958.86 969.5,-958.86 969.5,-1026.86"/>
<text text-anchor="middle" x="787.5" y="-1011.66" font-family="Arial" font-size="14.00">Layer 0: Expert 1 Activation</text>
<text text-anchor="middle" x="787.5" y="-996.66" font-family="Arial" font-size="14.00">GPU: EP1</text>
<text text-anchor="middle" x="787.5" y="-981.66" font-family="Arial" font-size="14.00">Input: [batch_size=64, seq_len=512, hidden_size=2048]</text>
<text text-anchor="middle" x="787.5" y="-966.66" font-family="Arial" font-size="14.00">Output: [batch_size=64, seq_len=512, hidden_size=2048]</text>
</g>
<!-- layer0_expert1_up&#45;&gt;layer0_expert1_act -->
<g id="edge19" class="edge">
<title>layer0_expert1_up&#45;&gt;layer0_expert1_act</title>
<path fill="none" stroke="black" d="M787.5,-1062.74C787.5,-1054.64 787.5,-1045.84 787.5,-1037.33"/>
<polygon fill="black" stroke="black" points="791,-1037.16 787.5,-1027.16 784,-1037.16 791,-1037.16"/>
</g>
<!-- layer0_expert1_down -->
<g id="node19" class="node">
<title>layer0_expert1_down</title>
<polygon fill="lightsteelblue" stroke="black" points="963.5,-922.86 607.5,-922.86 607.5,-854.86 963.5,-854.86 963.5,-922.86"/>
<text text-anchor="middle" x="785.5" y="-907.66" font-family="Arial" font-size="14.00">Layer 0: Expert 1 Down&#45;proj</text>
<text text-anchor="middle" x="785.5" y="-892.66" font-family="Arial" font-size="14.00">GPU: EP1</text>
<text text-anchor="middle" x="785.5" y="-877.66" font-family="Arial" font-size="14.00">Input: [batch_size=64, seq_len=512, hidden_size=2048]</text>
<text text-anchor="middle" x="785.5" y="-862.66" font-family="Arial" font-size="14.00">Output: [batch_size=64, seq_len=512, hidden_size=512]</text>
</g>
<!-- layer0_expert1_act&#45;&gt;layer0_expert1_down -->
<g id="edge20" class="edge">
<title>layer0_expert1_act&#45;&gt;layer0_expert1_down</title>
<path fill="none" stroke="black" d="M786.85,-958.74C786.69,-950.64 786.52,-941.84 786.35,-933.33"/>
<polygon fill="black" stroke="black" points="789.85,-933.09 786.15,-923.16 782.85,-933.23 789.85,-933.09"/>
</g>
<!-- layer0_expert1_down&#45;&gt;layer0_ep_a2a -->
<g id="edge22" class="edge">
<title>layer0_expert1_down&#45;&gt;layer0_ep_a2a</title>
<path fill="none" stroke="black" d="M726.22,-854.78C705.85,-843.41 682.94,-830.62 662.1,-818.99"/>
<polygon fill="black" stroke="black" points="663.75,-815.91 653.31,-814.09 660.34,-822.02 663.75,-815.91"/>
</g>
<!-- layer0_expert_combine -->
<g id="node21" class="node">
<title>layer0_expert_combine</title>
<polygon fill="lightyellow" stroke="black" points="981.27,-707.91 369.19,-707.91 211.73,-571.91 823.81,-571.91 981.27,-707.91"/>
<text text-anchor="middle" x="596.5" y="-658.71" font-family="Arial" font-size="14.00">Expert Combine</text>
<text text-anchor="middle" x="596.5" y="-643.71" font-family="Arial" font-size="14.00">GPU: EP0&#45;EP63</text>
<text text-anchor="middle" x="596.5" y="-628.71" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=512]</text>
<text text-anchor="middle" x="596.5" y="-613.71" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=512]</text>
</g>
<!-- layer0_ep_a2a&#45;&gt;layer0_expert_combine -->
<g id="edge23" class="edge">
<title>layer0_ep_a2a&#45;&gt;layer0_expert_combine</title>
<path fill="none" stroke="black" d="M596.5,-743.74C596.5,-735.76 596.5,-727.04 596.5,-718.14"/>
<polygon fill="black" stroke="black" points="600,-718.07 596.5,-708.07 593,-718.07 600,-718.07"/>
</g>
<!-- pp0_to_pp1 -->
<g id="node22" class="node">
<title>pp0_to_pp1</title>
<ellipse fill="orange" stroke="black" cx="596.5" cy="-498.43" rx="92.76" ry="37.45"/>
<text text-anchor="middle" x="596.5" y="-509.73" font-family="Arial" font-size="14.00">Pipeline Transfer</text>
<text text-anchor="middle" x="596.5" y="-494.73" font-family="Arial" font-size="14.00">PP0 â†’ PP1</text>
<text text-anchor="middle" x="596.5" y="-479.73" font-family="Arial" font-size="14.00">Activations transfer</text>
</g>
<!-- layer0_expert_combine&#45;&gt;pp0_to_pp1 -->
<g id="edge24" class="edge">
<title>layer0_expert_combine&#45;&gt;pp0_to_pp1</title>
<path fill="none" stroke="black" d="M596.5,-571.62C596.5,-563 596.5,-554.33 596.5,-546.14"/>
<polygon fill="black" stroke="black" points="600,-546.05 596.5,-536.05 593,-546.05 600,-546.05"/>
</g>
<!-- pp1_start -->
<g id="node23" class="node">
<title>pp1_start</title>
<polygon fill="yellow" stroke="black" points="687.97,-424.95 542.46,-424.95 505.03,-318.95 650.54,-318.95 687.97,-424.95"/>
<text text-anchor="middle" x="596.5" y="-383.25" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="596.5" y="-368.25" font-family="Arial" font-size="14.00">GPU: PP1</text>
<text text-anchor="middle" x="596.5" y="-353.25" font-family="Arial" font-size="14.00">Layers 8&#45;15</text>
</g>
<!-- pp0_to_pp1&#45;&gt;pp1_start -->
<g id="edge25" class="edge">
<title>pp0_to_pp1&#45;&gt;pp1_start</title>
<path fill="none" stroke="black" d="M596.5,-460.76C596.5,-452.72 596.5,-443.99 596.5,-435.25"/>
<polygon fill="black" stroke="black" points="600,-435.04 596.5,-425.04 593,-435.04 600,-435.04"/>
</g>
<!-- layer15_attn -->
<g id="node24" class="node">
<title>layer15_attn</title>
<polygon fill="lightcoral" stroke="black" points="782,-282.95 411,-282.95 411,-214.95 782,-214.95 782,-282.95"/>
<text text-anchor="middle" x="596.5" y="-267.75" font-family="Arial" font-size="14.00">Layer 15: Attention</text>
<text text-anchor="middle" x="596.5" y="-252.75" font-family="Arial" font-size="14.00">GPU: TP0&#45;TP7, PP1</text>
<text text-anchor="middle" x="596.5" y="-237.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=512]</text>
<text text-anchor="middle" x="596.5" y="-222.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=512]</text>
</g>
<!-- pp1_start&#45;&gt;layer15_attn -->
<g id="edge26" class="edge">
<title>pp1_start&#45;&gt;layer15_attn</title>
<path fill="none" stroke="black" d="M596.5,-318.94C596.5,-310.38 596.5,-301.59 596.5,-293.28"/>
<polygon fill="black" stroke="black" points="600,-293.05 596.5,-283.05 593,-293.05 600,-293.05"/>
</g>
<!-- layer15_moe -->
<g id="node25" class="node">
<title>layer15_moe</title>
<polygon fill="lightsteelblue" stroke="black" points="782,-178.95 411,-178.95 411,-110.95 782,-110.95 782,-178.95"/>
<text text-anchor="middle" x="596.5" y="-163.75" font-family="Arial" font-size="14.00">Layer 15: MoE</text>
<text text-anchor="middle" x="596.5" y="-148.75" font-family="Arial" font-size="14.00">GPU: EP0&#45;EP63, PP1</text>
<text text-anchor="middle" x="596.5" y="-133.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=512]</text>
<text text-anchor="middle" x="596.5" y="-118.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=512]</text>
</g>
<!-- layer15_attn&#45;&gt;layer15_moe -->
<g id="edge27" class="edge">
<title>layer15_attn&#45;&gt;layer15_moe</title>
<path fill="none" stroke="black" d="M596.5,-214.84C596.5,-206.73 596.5,-197.94 596.5,-189.43"/>
<polygon fill="black" stroke="black" points="600,-189.25 596.5,-179.25 593,-189.25 600,-189.25"/>
</g>
<!-- output -->
<g id="node26" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="596.5" cy="-37.48" rx="270.23" ry="37.45"/>
<text text-anchor="middle" x="596.5" y="-48.78" font-family="Arial" font-size="14.00">Output</text>
<text text-anchor="middle" x="596.5" y="-33.78" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="596.5" y="-18.78" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=1024, vocab_size=51200]</text>
</g>
<!-- layer15_moe&#45;&gt;output -->
<g id="edge28" class="edge">
<title>layer15_moe&#45;&gt;output</title>
<path fill="none" stroke="black" d="M596.5,-110.87C596.5,-102.71 596.5,-93.81 596.5,-85.13"/>
<polygon fill="black" stroke="black" points="600,-85.11 596.5,-75.11 593,-85.11 600,-85.11"/>
</g>
</g>
</svg>
