// Proposed MoE EP=16 Deployment
digraph proposed_ep16_moe {
	rankdir=TB size="30,40"
	node [fillcolor=lightblue shape=ellipse style=filled]
	node [fillcolor=lightgreen shape=rectangle style=filled]
	node [fillcolor=lightyellow shape=parallelogram style=filled]
	input [label="Input\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nGPU: all GPUs" fillcolor=lightblue shape=ellipse]
	subgraph cluster_layer0 {
		label="Layer 0 (EP=16)\n16 GPUs, 1 expert per GPU" style=dashed
		l0_qkv_gpu0 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l0_attn_gpu0 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_gpu0 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l0_attn_residual_gpu0 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_gpu1 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l0_attn_gpu1 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_gpu1 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l0_attn_residual_gpu1 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_gpu2 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l0_attn_gpu2 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_gpu2 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l0_attn_residual_gpu2 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_gpu3 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l0_attn_gpu3 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_gpu3 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l0_attn_residual_gpu3 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_gpu4 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l0_attn_gpu4 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_gpu4 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l0_attn_residual_gpu4 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_gpu5 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l0_attn_gpu5 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_gpu5 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l0_attn_residual_gpu5 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_gpu6 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l0_attn_gpu6 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_gpu6 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l0_attn_residual_gpu6 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_gpu7 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l0_attn_gpu7 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_gpu7 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l0_attn_residual_gpu7 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_gpu8 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l0_attn_gpu8 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_gpu8 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l0_attn_residual_gpu8 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_gpu9 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l0_attn_gpu9 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_gpu9 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l0_attn_residual_gpu9 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_gpu10 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l0_attn_gpu10 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_gpu10 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l0_attn_residual_gpu10 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_gpu11 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l0_attn_gpu11 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_gpu11 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l0_attn_residual_gpu11 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_gpu12 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l0_attn_gpu12 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_gpu12 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l0_attn_residual_gpu12 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_gpu13 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l0_attn_gpu13 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_gpu13 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l0_attn_residual_gpu13 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_gpu14 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l0_attn_gpu14 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_gpu14 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l0_attn_residual_gpu14 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_gpu15 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l0_attn_gpu15 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_gpu15 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l0_attn_residual_gpu15 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l0_gate_gpu0 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l0_gate_gpu1 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l0_gate_gpu2 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l0_gate_gpu3 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l0_gate_gpu4 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l0_gate_gpu5 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l0_gate_gpu6 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l0_gate_gpu7 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l0_gate_gpu8 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l0_gate_gpu9 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l0_gate_gpu10 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l0_gate_gpu11 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l0_gate_gpu12 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l0_gate_gpu13 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l0_gate_gpu14 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l0_gate_gpu15 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l0_expert_gpu0 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l0_expert_gpu1 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l0_expert_gpu2 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l0_expert_gpu3 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l0_expert_gpu4 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l0_expert_gpu5 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l0_expert_gpu6 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l0_expert_gpu7 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l0_expert_gpu8 [label="Expert 8\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l0_expert_gpu9 [label="Expert 9\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l0_expert_gpu10 [label="Expert 10\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l0_expert_gpu11 [label="Expert 11\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l0_expert_gpu12 [label="Expert 12\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l0_expert_gpu13 [label="Expert 13\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l0_expert_gpu14 [label="Expert 14\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l0_expert_gpu15 [label="Expert 15\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l0_token_split_gpu0 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l0_send_gpu0_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→1" fillcolor=orange shape=parallelogram]
		l0_send_gpu0_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→2" fillcolor=orange shape=parallelogram]
		l0_send_gpu0_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→3" fillcolor=orange shape=parallelogram]
		l0_send_gpu0_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→4" fillcolor=orange shape=parallelogram]
		l0_send_gpu0_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→5" fillcolor=orange shape=parallelogram]
		l0_send_gpu0_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→6" fillcolor=orange shape=parallelogram]
		l0_send_gpu0_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→7" fillcolor=orange shape=parallelogram]
		l0_send_gpu0_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→8" fillcolor=orange shape=parallelogram]
		l0_send_gpu0_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→9" fillcolor=orange shape=parallelogram]
		l0_send_gpu0_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→10" fillcolor=orange shape=parallelogram]
		l0_send_gpu0_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→11" fillcolor=orange shape=parallelogram]
		l0_send_gpu0_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→12" fillcolor=orange shape=parallelogram]
		l0_send_gpu0_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→13" fillcolor=orange shape=parallelogram]
		l0_send_gpu0_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→14" fillcolor=orange shape=parallelogram]
		l0_send_gpu0_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu1_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→0" fillcolor=orange shape=parallelogram]
		l0_recv_gpu2_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→0" fillcolor=orange shape=parallelogram]
		l0_recv_gpu3_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→0" fillcolor=orange shape=parallelogram]
		l0_recv_gpu4_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→0" fillcolor=orange shape=parallelogram]
		l0_recv_gpu5_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→0" fillcolor=orange shape=parallelogram]
		l0_recv_gpu6_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→0" fillcolor=orange shape=parallelogram]
		l0_recv_gpu7_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→0" fillcolor=orange shape=parallelogram]
		l0_recv_gpu8_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→0" fillcolor=orange shape=parallelogram]
		l0_recv_gpu9_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→0" fillcolor=orange shape=parallelogram]
		l0_recv_gpu10_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→0" fillcolor=orange shape=parallelogram]
		l0_recv_gpu11_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→0" fillcolor=orange shape=parallelogram]
		l0_recv_gpu12_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→0" fillcolor=orange shape=parallelogram]
		l0_recv_gpu13_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→0" fillcolor=orange shape=parallelogram]
		l0_recv_gpu14_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→0" fillcolor=orange shape=parallelogram]
		l0_recv_gpu15_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→0" fillcolor=orange shape=parallelogram]
		l0_local_tokens_gpu0 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l0_expert_agg_gpu0 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l0_final_residual_gpu0 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l0_token_split_gpu1 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l0_send_gpu1_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→0" fillcolor=orange shape=parallelogram]
		l0_send_gpu1_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→2" fillcolor=orange shape=parallelogram]
		l0_send_gpu1_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→3" fillcolor=orange shape=parallelogram]
		l0_send_gpu1_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→4" fillcolor=orange shape=parallelogram]
		l0_send_gpu1_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→5" fillcolor=orange shape=parallelogram]
		l0_send_gpu1_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→6" fillcolor=orange shape=parallelogram]
		l0_send_gpu1_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→7" fillcolor=orange shape=parallelogram]
		l0_send_gpu1_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→8" fillcolor=orange shape=parallelogram]
		l0_send_gpu1_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→9" fillcolor=orange shape=parallelogram]
		l0_send_gpu1_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→10" fillcolor=orange shape=parallelogram]
		l0_send_gpu1_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→11" fillcolor=orange shape=parallelogram]
		l0_send_gpu1_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→12" fillcolor=orange shape=parallelogram]
		l0_send_gpu1_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→13" fillcolor=orange shape=parallelogram]
		l0_send_gpu1_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→14" fillcolor=orange shape=parallelogram]
		l0_send_gpu1_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu0_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→1" fillcolor=orange shape=parallelogram]
		l0_recv_gpu2_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→1" fillcolor=orange shape=parallelogram]
		l0_recv_gpu3_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→1" fillcolor=orange shape=parallelogram]
		l0_recv_gpu4_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→1" fillcolor=orange shape=parallelogram]
		l0_recv_gpu5_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→1" fillcolor=orange shape=parallelogram]
		l0_recv_gpu6_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→1" fillcolor=orange shape=parallelogram]
		l0_recv_gpu7_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→1" fillcolor=orange shape=parallelogram]
		l0_recv_gpu8_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→1" fillcolor=orange shape=parallelogram]
		l0_recv_gpu9_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→1" fillcolor=orange shape=parallelogram]
		l0_recv_gpu10_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→1" fillcolor=orange shape=parallelogram]
		l0_recv_gpu11_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→1" fillcolor=orange shape=parallelogram]
		l0_recv_gpu12_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→1" fillcolor=orange shape=parallelogram]
		l0_recv_gpu13_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→1" fillcolor=orange shape=parallelogram]
		l0_recv_gpu14_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→1" fillcolor=orange shape=parallelogram]
		l0_recv_gpu15_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→1" fillcolor=orange shape=parallelogram]
		l0_local_tokens_gpu1 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l0_expert_agg_gpu1 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l0_final_residual_gpu1 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l0_token_split_gpu2 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l0_send_gpu2_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→0" fillcolor=orange shape=parallelogram]
		l0_send_gpu2_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→1" fillcolor=orange shape=parallelogram]
		l0_send_gpu2_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→3" fillcolor=orange shape=parallelogram]
		l0_send_gpu2_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→4" fillcolor=orange shape=parallelogram]
		l0_send_gpu2_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→5" fillcolor=orange shape=parallelogram]
		l0_send_gpu2_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→6" fillcolor=orange shape=parallelogram]
		l0_send_gpu2_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→7" fillcolor=orange shape=parallelogram]
		l0_send_gpu2_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→8" fillcolor=orange shape=parallelogram]
		l0_send_gpu2_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→9" fillcolor=orange shape=parallelogram]
		l0_send_gpu2_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→10" fillcolor=orange shape=parallelogram]
		l0_send_gpu2_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→11" fillcolor=orange shape=parallelogram]
		l0_send_gpu2_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→12" fillcolor=orange shape=parallelogram]
		l0_send_gpu2_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→13" fillcolor=orange shape=parallelogram]
		l0_send_gpu2_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→14" fillcolor=orange shape=parallelogram]
		l0_send_gpu2_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu0_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→2" fillcolor=orange shape=parallelogram]
		l0_recv_gpu1_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→2" fillcolor=orange shape=parallelogram]
		l0_recv_gpu3_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→2" fillcolor=orange shape=parallelogram]
		l0_recv_gpu4_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→2" fillcolor=orange shape=parallelogram]
		l0_recv_gpu5_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→2" fillcolor=orange shape=parallelogram]
		l0_recv_gpu6_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→2" fillcolor=orange shape=parallelogram]
		l0_recv_gpu7_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→2" fillcolor=orange shape=parallelogram]
		l0_recv_gpu8_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→2" fillcolor=orange shape=parallelogram]
		l0_recv_gpu9_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→2" fillcolor=orange shape=parallelogram]
		l0_recv_gpu10_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→2" fillcolor=orange shape=parallelogram]
		l0_recv_gpu11_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→2" fillcolor=orange shape=parallelogram]
		l0_recv_gpu12_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→2" fillcolor=orange shape=parallelogram]
		l0_recv_gpu13_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→2" fillcolor=orange shape=parallelogram]
		l0_recv_gpu14_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→2" fillcolor=orange shape=parallelogram]
		l0_recv_gpu15_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→2" fillcolor=orange shape=parallelogram]
		l0_local_tokens_gpu2 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l0_expert_agg_gpu2 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l0_final_residual_gpu2 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l0_token_split_gpu3 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l0_send_gpu3_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→0" fillcolor=orange shape=parallelogram]
		l0_send_gpu3_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→1" fillcolor=orange shape=parallelogram]
		l0_send_gpu3_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→2" fillcolor=orange shape=parallelogram]
		l0_send_gpu3_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→4" fillcolor=orange shape=parallelogram]
		l0_send_gpu3_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→5" fillcolor=orange shape=parallelogram]
		l0_send_gpu3_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→6" fillcolor=orange shape=parallelogram]
		l0_send_gpu3_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→7" fillcolor=orange shape=parallelogram]
		l0_send_gpu3_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→8" fillcolor=orange shape=parallelogram]
		l0_send_gpu3_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→9" fillcolor=orange shape=parallelogram]
		l0_send_gpu3_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→10" fillcolor=orange shape=parallelogram]
		l0_send_gpu3_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→11" fillcolor=orange shape=parallelogram]
		l0_send_gpu3_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→12" fillcolor=orange shape=parallelogram]
		l0_send_gpu3_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→13" fillcolor=orange shape=parallelogram]
		l0_send_gpu3_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→14" fillcolor=orange shape=parallelogram]
		l0_send_gpu3_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu0_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→3" fillcolor=orange shape=parallelogram]
		l0_recv_gpu1_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→3" fillcolor=orange shape=parallelogram]
		l0_recv_gpu2_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→3" fillcolor=orange shape=parallelogram]
		l0_recv_gpu4_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→3" fillcolor=orange shape=parallelogram]
		l0_recv_gpu5_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→3" fillcolor=orange shape=parallelogram]
		l0_recv_gpu6_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→3" fillcolor=orange shape=parallelogram]
		l0_recv_gpu7_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→3" fillcolor=orange shape=parallelogram]
		l0_recv_gpu8_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→3" fillcolor=orange shape=parallelogram]
		l0_recv_gpu9_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→3" fillcolor=orange shape=parallelogram]
		l0_recv_gpu10_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→3" fillcolor=orange shape=parallelogram]
		l0_recv_gpu11_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→3" fillcolor=orange shape=parallelogram]
		l0_recv_gpu12_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→3" fillcolor=orange shape=parallelogram]
		l0_recv_gpu13_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→3" fillcolor=orange shape=parallelogram]
		l0_recv_gpu14_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→3" fillcolor=orange shape=parallelogram]
		l0_recv_gpu15_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→3" fillcolor=orange shape=parallelogram]
		l0_local_tokens_gpu3 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l0_expert_agg_gpu3 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l0_final_residual_gpu3 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l0_token_split_gpu4 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l0_send_gpu4_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→0" fillcolor=orange shape=parallelogram]
		l0_send_gpu4_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→1" fillcolor=orange shape=parallelogram]
		l0_send_gpu4_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→2" fillcolor=orange shape=parallelogram]
		l0_send_gpu4_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→3" fillcolor=orange shape=parallelogram]
		l0_send_gpu4_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→5" fillcolor=orange shape=parallelogram]
		l0_send_gpu4_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→6" fillcolor=orange shape=parallelogram]
		l0_send_gpu4_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→7" fillcolor=orange shape=parallelogram]
		l0_send_gpu4_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→8" fillcolor=orange shape=parallelogram]
		l0_send_gpu4_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→9" fillcolor=orange shape=parallelogram]
		l0_send_gpu4_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→10" fillcolor=orange shape=parallelogram]
		l0_send_gpu4_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→11" fillcolor=orange shape=parallelogram]
		l0_send_gpu4_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→12" fillcolor=orange shape=parallelogram]
		l0_send_gpu4_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→13" fillcolor=orange shape=parallelogram]
		l0_send_gpu4_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→14" fillcolor=orange shape=parallelogram]
		l0_send_gpu4_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu0_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→4" fillcolor=orange shape=parallelogram]
		l0_recv_gpu1_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→4" fillcolor=orange shape=parallelogram]
		l0_recv_gpu2_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→4" fillcolor=orange shape=parallelogram]
		l0_recv_gpu3_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→4" fillcolor=orange shape=parallelogram]
		l0_recv_gpu5_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→4" fillcolor=orange shape=parallelogram]
		l0_recv_gpu6_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→4" fillcolor=orange shape=parallelogram]
		l0_recv_gpu7_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→4" fillcolor=orange shape=parallelogram]
		l0_recv_gpu8_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→4" fillcolor=orange shape=parallelogram]
		l0_recv_gpu9_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→4" fillcolor=orange shape=parallelogram]
		l0_recv_gpu10_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→4" fillcolor=orange shape=parallelogram]
		l0_recv_gpu11_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→4" fillcolor=orange shape=parallelogram]
		l0_recv_gpu12_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→4" fillcolor=orange shape=parallelogram]
		l0_recv_gpu13_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→4" fillcolor=orange shape=parallelogram]
		l0_recv_gpu14_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→4" fillcolor=orange shape=parallelogram]
		l0_recv_gpu15_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→4" fillcolor=orange shape=parallelogram]
		l0_local_tokens_gpu4 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l0_expert_agg_gpu4 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l0_final_residual_gpu4 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l0_token_split_gpu5 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l0_send_gpu5_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→0" fillcolor=orange shape=parallelogram]
		l0_send_gpu5_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→1" fillcolor=orange shape=parallelogram]
		l0_send_gpu5_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→2" fillcolor=orange shape=parallelogram]
		l0_send_gpu5_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→3" fillcolor=orange shape=parallelogram]
		l0_send_gpu5_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→4" fillcolor=orange shape=parallelogram]
		l0_send_gpu5_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→6" fillcolor=orange shape=parallelogram]
		l0_send_gpu5_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→7" fillcolor=orange shape=parallelogram]
		l0_send_gpu5_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→8" fillcolor=orange shape=parallelogram]
		l0_send_gpu5_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→9" fillcolor=orange shape=parallelogram]
		l0_send_gpu5_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→10" fillcolor=orange shape=parallelogram]
		l0_send_gpu5_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→11" fillcolor=orange shape=parallelogram]
		l0_send_gpu5_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→12" fillcolor=orange shape=parallelogram]
		l0_send_gpu5_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→13" fillcolor=orange shape=parallelogram]
		l0_send_gpu5_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→14" fillcolor=orange shape=parallelogram]
		l0_send_gpu5_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu0_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→5" fillcolor=orange shape=parallelogram]
		l0_recv_gpu1_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→5" fillcolor=orange shape=parallelogram]
		l0_recv_gpu2_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→5" fillcolor=orange shape=parallelogram]
		l0_recv_gpu3_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→5" fillcolor=orange shape=parallelogram]
		l0_recv_gpu4_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→5" fillcolor=orange shape=parallelogram]
		l0_recv_gpu6_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→5" fillcolor=orange shape=parallelogram]
		l0_recv_gpu7_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→5" fillcolor=orange shape=parallelogram]
		l0_recv_gpu8_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→5" fillcolor=orange shape=parallelogram]
		l0_recv_gpu9_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→5" fillcolor=orange shape=parallelogram]
		l0_recv_gpu10_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→5" fillcolor=orange shape=parallelogram]
		l0_recv_gpu11_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→5" fillcolor=orange shape=parallelogram]
		l0_recv_gpu12_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→5" fillcolor=orange shape=parallelogram]
		l0_recv_gpu13_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→5" fillcolor=orange shape=parallelogram]
		l0_recv_gpu14_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→5" fillcolor=orange shape=parallelogram]
		l0_recv_gpu15_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→5" fillcolor=orange shape=parallelogram]
		l0_local_tokens_gpu5 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l0_expert_agg_gpu5 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l0_final_residual_gpu5 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l0_token_split_gpu6 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l0_send_gpu6_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→0" fillcolor=orange shape=parallelogram]
		l0_send_gpu6_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→1" fillcolor=orange shape=parallelogram]
		l0_send_gpu6_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→2" fillcolor=orange shape=parallelogram]
		l0_send_gpu6_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→3" fillcolor=orange shape=parallelogram]
		l0_send_gpu6_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→4" fillcolor=orange shape=parallelogram]
		l0_send_gpu6_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→5" fillcolor=orange shape=parallelogram]
		l0_send_gpu6_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→7" fillcolor=orange shape=parallelogram]
		l0_send_gpu6_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→8" fillcolor=orange shape=parallelogram]
		l0_send_gpu6_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→9" fillcolor=orange shape=parallelogram]
		l0_send_gpu6_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→10" fillcolor=orange shape=parallelogram]
		l0_send_gpu6_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→11" fillcolor=orange shape=parallelogram]
		l0_send_gpu6_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→12" fillcolor=orange shape=parallelogram]
		l0_send_gpu6_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→13" fillcolor=orange shape=parallelogram]
		l0_send_gpu6_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→14" fillcolor=orange shape=parallelogram]
		l0_send_gpu6_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu0_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→6" fillcolor=orange shape=parallelogram]
		l0_recv_gpu1_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→6" fillcolor=orange shape=parallelogram]
		l0_recv_gpu2_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→6" fillcolor=orange shape=parallelogram]
		l0_recv_gpu3_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→6" fillcolor=orange shape=parallelogram]
		l0_recv_gpu4_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→6" fillcolor=orange shape=parallelogram]
		l0_recv_gpu5_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→6" fillcolor=orange shape=parallelogram]
		l0_recv_gpu7_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→6" fillcolor=orange shape=parallelogram]
		l0_recv_gpu8_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→6" fillcolor=orange shape=parallelogram]
		l0_recv_gpu9_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→6" fillcolor=orange shape=parallelogram]
		l0_recv_gpu10_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→6" fillcolor=orange shape=parallelogram]
		l0_recv_gpu11_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→6" fillcolor=orange shape=parallelogram]
		l0_recv_gpu12_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→6" fillcolor=orange shape=parallelogram]
		l0_recv_gpu13_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→6" fillcolor=orange shape=parallelogram]
		l0_recv_gpu14_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→6" fillcolor=orange shape=parallelogram]
		l0_recv_gpu15_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→6" fillcolor=orange shape=parallelogram]
		l0_local_tokens_gpu6 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l0_expert_agg_gpu6 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l0_final_residual_gpu6 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l0_token_split_gpu7 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l0_send_gpu7_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→0" fillcolor=orange shape=parallelogram]
		l0_send_gpu7_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→1" fillcolor=orange shape=parallelogram]
		l0_send_gpu7_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→2" fillcolor=orange shape=parallelogram]
		l0_send_gpu7_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→3" fillcolor=orange shape=parallelogram]
		l0_send_gpu7_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→4" fillcolor=orange shape=parallelogram]
		l0_send_gpu7_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→5" fillcolor=orange shape=parallelogram]
		l0_send_gpu7_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→6" fillcolor=orange shape=parallelogram]
		l0_send_gpu7_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→8" fillcolor=orange shape=parallelogram]
		l0_send_gpu7_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→9" fillcolor=orange shape=parallelogram]
		l0_send_gpu7_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→10" fillcolor=orange shape=parallelogram]
		l0_send_gpu7_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→11" fillcolor=orange shape=parallelogram]
		l0_send_gpu7_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→12" fillcolor=orange shape=parallelogram]
		l0_send_gpu7_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→13" fillcolor=orange shape=parallelogram]
		l0_send_gpu7_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→14" fillcolor=orange shape=parallelogram]
		l0_send_gpu7_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu0_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→7" fillcolor=orange shape=parallelogram]
		l0_recv_gpu1_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→7" fillcolor=orange shape=parallelogram]
		l0_recv_gpu2_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→7" fillcolor=orange shape=parallelogram]
		l0_recv_gpu3_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→7" fillcolor=orange shape=parallelogram]
		l0_recv_gpu4_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→7" fillcolor=orange shape=parallelogram]
		l0_recv_gpu5_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→7" fillcolor=orange shape=parallelogram]
		l0_recv_gpu6_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→7" fillcolor=orange shape=parallelogram]
		l0_recv_gpu8_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→7" fillcolor=orange shape=parallelogram]
		l0_recv_gpu9_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→7" fillcolor=orange shape=parallelogram]
		l0_recv_gpu10_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→7" fillcolor=orange shape=parallelogram]
		l0_recv_gpu11_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→7" fillcolor=orange shape=parallelogram]
		l0_recv_gpu12_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→7" fillcolor=orange shape=parallelogram]
		l0_recv_gpu13_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→7" fillcolor=orange shape=parallelogram]
		l0_recv_gpu14_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→7" fillcolor=orange shape=parallelogram]
		l0_recv_gpu15_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→7" fillcolor=orange shape=parallelogram]
		l0_local_tokens_gpu7 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l0_expert_agg_gpu7 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l0_final_residual_gpu7 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l0_token_split_gpu8 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l0_send_gpu8_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→0" fillcolor=orange shape=parallelogram]
		l0_send_gpu8_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→1" fillcolor=orange shape=parallelogram]
		l0_send_gpu8_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→2" fillcolor=orange shape=parallelogram]
		l0_send_gpu8_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→3" fillcolor=orange shape=parallelogram]
		l0_send_gpu8_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→4" fillcolor=orange shape=parallelogram]
		l0_send_gpu8_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→5" fillcolor=orange shape=parallelogram]
		l0_send_gpu8_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→6" fillcolor=orange shape=parallelogram]
		l0_send_gpu8_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→7" fillcolor=orange shape=parallelogram]
		l0_send_gpu8_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→9" fillcolor=orange shape=parallelogram]
		l0_send_gpu8_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→10" fillcolor=orange shape=parallelogram]
		l0_send_gpu8_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→11" fillcolor=orange shape=parallelogram]
		l0_send_gpu8_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→12" fillcolor=orange shape=parallelogram]
		l0_send_gpu8_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→13" fillcolor=orange shape=parallelogram]
		l0_send_gpu8_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→14" fillcolor=orange shape=parallelogram]
		l0_send_gpu8_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu0_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→8" fillcolor=orange shape=parallelogram]
		l0_recv_gpu1_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→8" fillcolor=orange shape=parallelogram]
		l0_recv_gpu2_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→8" fillcolor=orange shape=parallelogram]
		l0_recv_gpu3_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→8" fillcolor=orange shape=parallelogram]
		l0_recv_gpu4_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→8" fillcolor=orange shape=parallelogram]
		l0_recv_gpu5_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→8" fillcolor=orange shape=parallelogram]
		l0_recv_gpu6_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→8" fillcolor=orange shape=parallelogram]
		l0_recv_gpu7_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→8" fillcolor=orange shape=parallelogram]
		l0_recv_gpu9_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→8" fillcolor=orange shape=parallelogram]
		l0_recv_gpu10_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→8" fillcolor=orange shape=parallelogram]
		l0_recv_gpu11_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→8" fillcolor=orange shape=parallelogram]
		l0_recv_gpu12_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→8" fillcolor=orange shape=parallelogram]
		l0_recv_gpu13_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→8" fillcolor=orange shape=parallelogram]
		l0_recv_gpu14_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→8" fillcolor=orange shape=parallelogram]
		l0_recv_gpu15_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→8" fillcolor=orange shape=parallelogram]
		l0_local_tokens_gpu8 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l0_expert_agg_gpu8 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l0_final_residual_gpu8 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l0_token_split_gpu9 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l0_send_gpu9_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→0" fillcolor=orange shape=parallelogram]
		l0_send_gpu9_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→1" fillcolor=orange shape=parallelogram]
		l0_send_gpu9_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→2" fillcolor=orange shape=parallelogram]
		l0_send_gpu9_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→3" fillcolor=orange shape=parallelogram]
		l0_send_gpu9_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→4" fillcolor=orange shape=parallelogram]
		l0_send_gpu9_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→5" fillcolor=orange shape=parallelogram]
		l0_send_gpu9_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→6" fillcolor=orange shape=parallelogram]
		l0_send_gpu9_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→7" fillcolor=orange shape=parallelogram]
		l0_send_gpu9_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→8" fillcolor=orange shape=parallelogram]
		l0_send_gpu9_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→10" fillcolor=orange shape=parallelogram]
		l0_send_gpu9_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→11" fillcolor=orange shape=parallelogram]
		l0_send_gpu9_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→12" fillcolor=orange shape=parallelogram]
		l0_send_gpu9_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→13" fillcolor=orange shape=parallelogram]
		l0_send_gpu9_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→14" fillcolor=orange shape=parallelogram]
		l0_send_gpu9_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu0_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→9" fillcolor=orange shape=parallelogram]
		l0_recv_gpu1_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→9" fillcolor=orange shape=parallelogram]
		l0_recv_gpu2_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→9" fillcolor=orange shape=parallelogram]
		l0_recv_gpu3_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→9" fillcolor=orange shape=parallelogram]
		l0_recv_gpu4_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→9" fillcolor=orange shape=parallelogram]
		l0_recv_gpu5_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→9" fillcolor=orange shape=parallelogram]
		l0_recv_gpu6_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→9" fillcolor=orange shape=parallelogram]
		l0_recv_gpu7_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→9" fillcolor=orange shape=parallelogram]
		l0_recv_gpu8_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→9" fillcolor=orange shape=parallelogram]
		l0_recv_gpu10_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→9" fillcolor=orange shape=parallelogram]
		l0_recv_gpu11_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→9" fillcolor=orange shape=parallelogram]
		l0_recv_gpu12_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→9" fillcolor=orange shape=parallelogram]
		l0_recv_gpu13_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→9" fillcolor=orange shape=parallelogram]
		l0_recv_gpu14_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→9" fillcolor=orange shape=parallelogram]
		l0_recv_gpu15_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→9" fillcolor=orange shape=parallelogram]
		l0_local_tokens_gpu9 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l0_expert_agg_gpu9 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l0_final_residual_gpu9 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l0_token_split_gpu10 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l0_send_gpu10_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→0" fillcolor=orange shape=parallelogram]
		l0_send_gpu10_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→1" fillcolor=orange shape=parallelogram]
		l0_send_gpu10_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→2" fillcolor=orange shape=parallelogram]
		l0_send_gpu10_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→3" fillcolor=orange shape=parallelogram]
		l0_send_gpu10_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→4" fillcolor=orange shape=parallelogram]
		l0_send_gpu10_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→5" fillcolor=orange shape=parallelogram]
		l0_send_gpu10_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→6" fillcolor=orange shape=parallelogram]
		l0_send_gpu10_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→7" fillcolor=orange shape=parallelogram]
		l0_send_gpu10_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→8" fillcolor=orange shape=parallelogram]
		l0_send_gpu10_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→9" fillcolor=orange shape=parallelogram]
		l0_send_gpu10_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→11" fillcolor=orange shape=parallelogram]
		l0_send_gpu10_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→12" fillcolor=orange shape=parallelogram]
		l0_send_gpu10_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→13" fillcolor=orange shape=parallelogram]
		l0_send_gpu10_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→14" fillcolor=orange shape=parallelogram]
		l0_send_gpu10_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu0_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→10" fillcolor=orange shape=parallelogram]
		l0_recv_gpu1_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→10" fillcolor=orange shape=parallelogram]
		l0_recv_gpu2_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→10" fillcolor=orange shape=parallelogram]
		l0_recv_gpu3_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→10" fillcolor=orange shape=parallelogram]
		l0_recv_gpu4_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→10" fillcolor=orange shape=parallelogram]
		l0_recv_gpu5_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→10" fillcolor=orange shape=parallelogram]
		l0_recv_gpu6_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→10" fillcolor=orange shape=parallelogram]
		l0_recv_gpu7_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→10" fillcolor=orange shape=parallelogram]
		l0_recv_gpu8_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→10" fillcolor=orange shape=parallelogram]
		l0_recv_gpu9_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→10" fillcolor=orange shape=parallelogram]
		l0_recv_gpu11_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→10" fillcolor=orange shape=parallelogram]
		l0_recv_gpu12_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→10" fillcolor=orange shape=parallelogram]
		l0_recv_gpu13_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→10" fillcolor=orange shape=parallelogram]
		l0_recv_gpu14_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→10" fillcolor=orange shape=parallelogram]
		l0_recv_gpu15_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→10" fillcolor=orange shape=parallelogram]
		l0_local_tokens_gpu10 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l0_expert_agg_gpu10 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l0_final_residual_gpu10 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l0_token_split_gpu11 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l0_send_gpu11_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→0" fillcolor=orange shape=parallelogram]
		l0_send_gpu11_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→1" fillcolor=orange shape=parallelogram]
		l0_send_gpu11_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→2" fillcolor=orange shape=parallelogram]
		l0_send_gpu11_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→3" fillcolor=orange shape=parallelogram]
		l0_send_gpu11_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→4" fillcolor=orange shape=parallelogram]
		l0_send_gpu11_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→5" fillcolor=orange shape=parallelogram]
		l0_send_gpu11_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→6" fillcolor=orange shape=parallelogram]
		l0_send_gpu11_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→7" fillcolor=orange shape=parallelogram]
		l0_send_gpu11_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→8" fillcolor=orange shape=parallelogram]
		l0_send_gpu11_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→9" fillcolor=orange shape=parallelogram]
		l0_send_gpu11_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→10" fillcolor=orange shape=parallelogram]
		l0_send_gpu11_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→12" fillcolor=orange shape=parallelogram]
		l0_send_gpu11_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→13" fillcolor=orange shape=parallelogram]
		l0_send_gpu11_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→14" fillcolor=orange shape=parallelogram]
		l0_send_gpu11_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu0_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→11" fillcolor=orange shape=parallelogram]
		l0_recv_gpu1_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→11" fillcolor=orange shape=parallelogram]
		l0_recv_gpu2_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→11" fillcolor=orange shape=parallelogram]
		l0_recv_gpu3_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→11" fillcolor=orange shape=parallelogram]
		l0_recv_gpu4_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→11" fillcolor=orange shape=parallelogram]
		l0_recv_gpu5_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→11" fillcolor=orange shape=parallelogram]
		l0_recv_gpu6_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→11" fillcolor=orange shape=parallelogram]
		l0_recv_gpu7_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→11" fillcolor=orange shape=parallelogram]
		l0_recv_gpu8_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→11" fillcolor=orange shape=parallelogram]
		l0_recv_gpu9_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→11" fillcolor=orange shape=parallelogram]
		l0_recv_gpu10_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→11" fillcolor=orange shape=parallelogram]
		l0_recv_gpu12_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→11" fillcolor=orange shape=parallelogram]
		l0_recv_gpu13_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→11" fillcolor=orange shape=parallelogram]
		l0_recv_gpu14_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→11" fillcolor=orange shape=parallelogram]
		l0_recv_gpu15_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→11" fillcolor=orange shape=parallelogram]
		l0_local_tokens_gpu11 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l0_expert_agg_gpu11 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l0_final_residual_gpu11 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l0_token_split_gpu12 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l0_send_gpu12_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→0" fillcolor=orange shape=parallelogram]
		l0_send_gpu12_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→1" fillcolor=orange shape=parallelogram]
		l0_send_gpu12_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→2" fillcolor=orange shape=parallelogram]
		l0_send_gpu12_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→3" fillcolor=orange shape=parallelogram]
		l0_send_gpu12_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→4" fillcolor=orange shape=parallelogram]
		l0_send_gpu12_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→5" fillcolor=orange shape=parallelogram]
		l0_send_gpu12_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→6" fillcolor=orange shape=parallelogram]
		l0_send_gpu12_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→7" fillcolor=orange shape=parallelogram]
		l0_send_gpu12_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→8" fillcolor=orange shape=parallelogram]
		l0_send_gpu12_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→9" fillcolor=orange shape=parallelogram]
		l0_send_gpu12_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→10" fillcolor=orange shape=parallelogram]
		l0_send_gpu12_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→11" fillcolor=orange shape=parallelogram]
		l0_send_gpu12_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→13" fillcolor=orange shape=parallelogram]
		l0_send_gpu12_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→14" fillcolor=orange shape=parallelogram]
		l0_send_gpu12_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu0_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→12" fillcolor=orange shape=parallelogram]
		l0_recv_gpu1_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→12" fillcolor=orange shape=parallelogram]
		l0_recv_gpu2_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→12" fillcolor=orange shape=parallelogram]
		l0_recv_gpu3_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→12" fillcolor=orange shape=parallelogram]
		l0_recv_gpu4_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→12" fillcolor=orange shape=parallelogram]
		l0_recv_gpu5_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→12" fillcolor=orange shape=parallelogram]
		l0_recv_gpu6_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→12" fillcolor=orange shape=parallelogram]
		l0_recv_gpu7_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→12" fillcolor=orange shape=parallelogram]
		l0_recv_gpu8_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→12" fillcolor=orange shape=parallelogram]
		l0_recv_gpu9_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→12" fillcolor=orange shape=parallelogram]
		l0_recv_gpu10_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→12" fillcolor=orange shape=parallelogram]
		l0_recv_gpu11_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→12" fillcolor=orange shape=parallelogram]
		l0_recv_gpu13_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→12" fillcolor=orange shape=parallelogram]
		l0_recv_gpu14_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→12" fillcolor=orange shape=parallelogram]
		l0_recv_gpu15_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→12" fillcolor=orange shape=parallelogram]
		l0_local_tokens_gpu12 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l0_expert_agg_gpu12 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l0_final_residual_gpu12 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l0_token_split_gpu13 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l0_send_gpu13_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→0" fillcolor=orange shape=parallelogram]
		l0_send_gpu13_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→1" fillcolor=orange shape=parallelogram]
		l0_send_gpu13_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→2" fillcolor=orange shape=parallelogram]
		l0_send_gpu13_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→3" fillcolor=orange shape=parallelogram]
		l0_send_gpu13_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→4" fillcolor=orange shape=parallelogram]
		l0_send_gpu13_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→5" fillcolor=orange shape=parallelogram]
		l0_send_gpu13_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→6" fillcolor=orange shape=parallelogram]
		l0_send_gpu13_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→7" fillcolor=orange shape=parallelogram]
		l0_send_gpu13_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→8" fillcolor=orange shape=parallelogram]
		l0_send_gpu13_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→9" fillcolor=orange shape=parallelogram]
		l0_send_gpu13_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→10" fillcolor=orange shape=parallelogram]
		l0_send_gpu13_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→11" fillcolor=orange shape=parallelogram]
		l0_send_gpu13_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→12" fillcolor=orange shape=parallelogram]
		l0_send_gpu13_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→14" fillcolor=orange shape=parallelogram]
		l0_send_gpu13_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu0_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→13" fillcolor=orange shape=parallelogram]
		l0_recv_gpu1_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→13" fillcolor=orange shape=parallelogram]
		l0_recv_gpu2_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→13" fillcolor=orange shape=parallelogram]
		l0_recv_gpu3_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→13" fillcolor=orange shape=parallelogram]
		l0_recv_gpu4_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→13" fillcolor=orange shape=parallelogram]
		l0_recv_gpu5_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→13" fillcolor=orange shape=parallelogram]
		l0_recv_gpu6_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→13" fillcolor=orange shape=parallelogram]
		l0_recv_gpu7_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→13" fillcolor=orange shape=parallelogram]
		l0_recv_gpu8_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→13" fillcolor=orange shape=parallelogram]
		l0_recv_gpu9_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→13" fillcolor=orange shape=parallelogram]
		l0_recv_gpu10_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→13" fillcolor=orange shape=parallelogram]
		l0_recv_gpu11_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→13" fillcolor=orange shape=parallelogram]
		l0_recv_gpu12_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→13" fillcolor=orange shape=parallelogram]
		l0_recv_gpu14_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→13" fillcolor=orange shape=parallelogram]
		l0_recv_gpu15_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→13" fillcolor=orange shape=parallelogram]
		l0_local_tokens_gpu13 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l0_expert_agg_gpu13 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l0_final_residual_gpu13 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l0_token_split_gpu14 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l0_send_gpu14_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→0" fillcolor=orange shape=parallelogram]
		l0_send_gpu14_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→1" fillcolor=orange shape=parallelogram]
		l0_send_gpu14_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→2" fillcolor=orange shape=parallelogram]
		l0_send_gpu14_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→3" fillcolor=orange shape=parallelogram]
		l0_send_gpu14_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→4" fillcolor=orange shape=parallelogram]
		l0_send_gpu14_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→5" fillcolor=orange shape=parallelogram]
		l0_send_gpu14_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→6" fillcolor=orange shape=parallelogram]
		l0_send_gpu14_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→7" fillcolor=orange shape=parallelogram]
		l0_send_gpu14_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→8" fillcolor=orange shape=parallelogram]
		l0_send_gpu14_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→9" fillcolor=orange shape=parallelogram]
		l0_send_gpu14_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→10" fillcolor=orange shape=parallelogram]
		l0_send_gpu14_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→11" fillcolor=orange shape=parallelogram]
		l0_send_gpu14_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→12" fillcolor=orange shape=parallelogram]
		l0_send_gpu14_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→13" fillcolor=orange shape=parallelogram]
		l0_send_gpu14_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu0_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→14" fillcolor=orange shape=parallelogram]
		l0_recv_gpu1_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→14" fillcolor=orange shape=parallelogram]
		l0_recv_gpu2_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→14" fillcolor=orange shape=parallelogram]
		l0_recv_gpu3_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→14" fillcolor=orange shape=parallelogram]
		l0_recv_gpu4_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→14" fillcolor=orange shape=parallelogram]
		l0_recv_gpu5_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→14" fillcolor=orange shape=parallelogram]
		l0_recv_gpu6_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→14" fillcolor=orange shape=parallelogram]
		l0_recv_gpu7_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→14" fillcolor=orange shape=parallelogram]
		l0_recv_gpu8_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→14" fillcolor=orange shape=parallelogram]
		l0_recv_gpu9_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→14" fillcolor=orange shape=parallelogram]
		l0_recv_gpu10_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→14" fillcolor=orange shape=parallelogram]
		l0_recv_gpu11_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→14" fillcolor=orange shape=parallelogram]
		l0_recv_gpu12_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→14" fillcolor=orange shape=parallelogram]
		l0_recv_gpu13_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→14" fillcolor=orange shape=parallelogram]
		l0_recv_gpu15_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→14" fillcolor=orange shape=parallelogram]
		l0_local_tokens_gpu14 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l0_expert_agg_gpu14 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l0_final_residual_gpu14 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l0_token_split_gpu15 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l0_send_gpu15_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→0" fillcolor=orange shape=parallelogram]
		l0_send_gpu15_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→1" fillcolor=orange shape=parallelogram]
		l0_send_gpu15_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→2" fillcolor=orange shape=parallelogram]
		l0_send_gpu15_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→3" fillcolor=orange shape=parallelogram]
		l0_send_gpu15_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→4" fillcolor=orange shape=parallelogram]
		l0_send_gpu15_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→5" fillcolor=orange shape=parallelogram]
		l0_send_gpu15_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→6" fillcolor=orange shape=parallelogram]
		l0_send_gpu15_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→7" fillcolor=orange shape=parallelogram]
		l0_send_gpu15_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→8" fillcolor=orange shape=parallelogram]
		l0_send_gpu15_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→9" fillcolor=orange shape=parallelogram]
		l0_send_gpu15_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→10" fillcolor=orange shape=parallelogram]
		l0_send_gpu15_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→11" fillcolor=orange shape=parallelogram]
		l0_send_gpu15_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→12" fillcolor=orange shape=parallelogram]
		l0_send_gpu15_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→13" fillcolor=orange shape=parallelogram]
		l0_send_gpu15_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→14" fillcolor=orange shape=parallelogram]
		l0_recv_gpu0_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu1_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu2_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu3_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu4_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu5_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu6_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu7_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu8_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu9_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu10_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu11_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu12_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu13_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→15" fillcolor=orange shape=parallelogram]
		l0_recv_gpu14_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→15" fillcolor=orange shape=parallelogram]
		l0_local_tokens_gpu15 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l0_expert_agg_gpu15 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l0_final_residual_gpu15 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_layer1 {
		label="Layer 1 (EP=16)\n16 GPUs, 1 expert per GPU" style=dashed
		l1_qkv_gpu0 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l1_attn_gpu0 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_gpu0 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l1_attn_residual_gpu0 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_gpu1 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l1_attn_gpu1 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_gpu1 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l1_attn_residual_gpu1 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_gpu2 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l1_attn_gpu2 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_gpu2 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l1_attn_residual_gpu2 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_gpu3 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l1_attn_gpu3 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_gpu3 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l1_attn_residual_gpu3 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_gpu4 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l1_attn_gpu4 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_gpu4 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l1_attn_residual_gpu4 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_gpu5 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l1_attn_gpu5 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_gpu5 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l1_attn_residual_gpu5 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_gpu6 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l1_attn_gpu6 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_gpu6 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l1_attn_residual_gpu6 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_gpu7 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l1_attn_gpu7 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_gpu7 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l1_attn_residual_gpu7 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_gpu8 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l1_attn_gpu8 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_gpu8 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l1_attn_residual_gpu8 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_gpu9 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l1_attn_gpu9 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_gpu9 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l1_attn_residual_gpu9 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_gpu10 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l1_attn_gpu10 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_gpu10 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l1_attn_residual_gpu10 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_gpu11 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l1_attn_gpu11 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_gpu11 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l1_attn_residual_gpu11 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_gpu12 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l1_attn_gpu12 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_gpu12 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l1_attn_residual_gpu12 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_gpu13 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l1_attn_gpu13 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_gpu13 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l1_attn_residual_gpu13 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_gpu14 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l1_attn_gpu14 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_gpu14 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l1_attn_residual_gpu14 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_gpu15 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l1_attn_gpu15 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_gpu15 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l1_attn_residual_gpu15 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l1_gate_gpu0 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l1_gate_gpu1 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l1_gate_gpu2 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l1_gate_gpu3 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l1_gate_gpu4 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l1_gate_gpu5 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l1_gate_gpu6 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l1_gate_gpu7 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l1_gate_gpu8 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l1_gate_gpu9 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l1_gate_gpu10 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l1_gate_gpu11 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l1_gate_gpu12 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l1_gate_gpu13 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l1_gate_gpu14 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l1_gate_gpu15 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l1_expert_gpu0 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l1_expert_gpu1 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l1_expert_gpu2 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l1_expert_gpu3 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l1_expert_gpu4 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l1_expert_gpu5 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l1_expert_gpu6 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l1_expert_gpu7 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l1_expert_gpu8 [label="Expert 8\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l1_expert_gpu9 [label="Expert 9\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l1_expert_gpu10 [label="Expert 10\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l1_expert_gpu11 [label="Expert 11\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l1_expert_gpu12 [label="Expert 12\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l1_expert_gpu13 [label="Expert 13\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l1_expert_gpu14 [label="Expert 14\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l1_expert_gpu15 [label="Expert 15\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l1_token_split_gpu0 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l1_send_gpu0_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→1" fillcolor=orange shape=parallelogram]
		l1_send_gpu0_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→2" fillcolor=orange shape=parallelogram]
		l1_send_gpu0_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→3" fillcolor=orange shape=parallelogram]
		l1_send_gpu0_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→4" fillcolor=orange shape=parallelogram]
		l1_send_gpu0_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→5" fillcolor=orange shape=parallelogram]
		l1_send_gpu0_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→6" fillcolor=orange shape=parallelogram]
		l1_send_gpu0_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→7" fillcolor=orange shape=parallelogram]
		l1_send_gpu0_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→8" fillcolor=orange shape=parallelogram]
		l1_send_gpu0_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→9" fillcolor=orange shape=parallelogram]
		l1_send_gpu0_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→10" fillcolor=orange shape=parallelogram]
		l1_send_gpu0_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→11" fillcolor=orange shape=parallelogram]
		l1_send_gpu0_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→12" fillcolor=orange shape=parallelogram]
		l1_send_gpu0_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→13" fillcolor=orange shape=parallelogram]
		l1_send_gpu0_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→14" fillcolor=orange shape=parallelogram]
		l1_send_gpu0_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu1_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→0" fillcolor=orange shape=parallelogram]
		l1_recv_gpu2_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→0" fillcolor=orange shape=parallelogram]
		l1_recv_gpu3_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→0" fillcolor=orange shape=parallelogram]
		l1_recv_gpu4_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→0" fillcolor=orange shape=parallelogram]
		l1_recv_gpu5_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→0" fillcolor=orange shape=parallelogram]
		l1_recv_gpu6_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→0" fillcolor=orange shape=parallelogram]
		l1_recv_gpu7_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→0" fillcolor=orange shape=parallelogram]
		l1_recv_gpu8_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→0" fillcolor=orange shape=parallelogram]
		l1_recv_gpu9_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→0" fillcolor=orange shape=parallelogram]
		l1_recv_gpu10_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→0" fillcolor=orange shape=parallelogram]
		l1_recv_gpu11_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→0" fillcolor=orange shape=parallelogram]
		l1_recv_gpu12_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→0" fillcolor=orange shape=parallelogram]
		l1_recv_gpu13_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→0" fillcolor=orange shape=parallelogram]
		l1_recv_gpu14_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→0" fillcolor=orange shape=parallelogram]
		l1_recv_gpu15_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→0" fillcolor=orange shape=parallelogram]
		l1_local_tokens_gpu0 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l1_expert_agg_gpu0 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l1_final_residual_gpu0 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l1_token_split_gpu1 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l1_send_gpu1_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→0" fillcolor=orange shape=parallelogram]
		l1_send_gpu1_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→2" fillcolor=orange shape=parallelogram]
		l1_send_gpu1_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→3" fillcolor=orange shape=parallelogram]
		l1_send_gpu1_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→4" fillcolor=orange shape=parallelogram]
		l1_send_gpu1_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→5" fillcolor=orange shape=parallelogram]
		l1_send_gpu1_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→6" fillcolor=orange shape=parallelogram]
		l1_send_gpu1_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→7" fillcolor=orange shape=parallelogram]
		l1_send_gpu1_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→8" fillcolor=orange shape=parallelogram]
		l1_send_gpu1_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→9" fillcolor=orange shape=parallelogram]
		l1_send_gpu1_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→10" fillcolor=orange shape=parallelogram]
		l1_send_gpu1_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→11" fillcolor=orange shape=parallelogram]
		l1_send_gpu1_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→12" fillcolor=orange shape=parallelogram]
		l1_send_gpu1_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→13" fillcolor=orange shape=parallelogram]
		l1_send_gpu1_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→14" fillcolor=orange shape=parallelogram]
		l1_send_gpu1_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu0_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→1" fillcolor=orange shape=parallelogram]
		l1_recv_gpu2_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→1" fillcolor=orange shape=parallelogram]
		l1_recv_gpu3_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→1" fillcolor=orange shape=parallelogram]
		l1_recv_gpu4_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→1" fillcolor=orange shape=parallelogram]
		l1_recv_gpu5_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→1" fillcolor=orange shape=parallelogram]
		l1_recv_gpu6_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→1" fillcolor=orange shape=parallelogram]
		l1_recv_gpu7_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→1" fillcolor=orange shape=parallelogram]
		l1_recv_gpu8_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→1" fillcolor=orange shape=parallelogram]
		l1_recv_gpu9_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→1" fillcolor=orange shape=parallelogram]
		l1_recv_gpu10_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→1" fillcolor=orange shape=parallelogram]
		l1_recv_gpu11_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→1" fillcolor=orange shape=parallelogram]
		l1_recv_gpu12_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→1" fillcolor=orange shape=parallelogram]
		l1_recv_gpu13_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→1" fillcolor=orange shape=parallelogram]
		l1_recv_gpu14_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→1" fillcolor=orange shape=parallelogram]
		l1_recv_gpu15_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→1" fillcolor=orange shape=parallelogram]
		l1_local_tokens_gpu1 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l1_expert_agg_gpu1 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l1_final_residual_gpu1 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l1_token_split_gpu2 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l1_send_gpu2_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→0" fillcolor=orange shape=parallelogram]
		l1_send_gpu2_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→1" fillcolor=orange shape=parallelogram]
		l1_send_gpu2_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→3" fillcolor=orange shape=parallelogram]
		l1_send_gpu2_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→4" fillcolor=orange shape=parallelogram]
		l1_send_gpu2_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→5" fillcolor=orange shape=parallelogram]
		l1_send_gpu2_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→6" fillcolor=orange shape=parallelogram]
		l1_send_gpu2_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→7" fillcolor=orange shape=parallelogram]
		l1_send_gpu2_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→8" fillcolor=orange shape=parallelogram]
		l1_send_gpu2_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→9" fillcolor=orange shape=parallelogram]
		l1_send_gpu2_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→10" fillcolor=orange shape=parallelogram]
		l1_send_gpu2_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→11" fillcolor=orange shape=parallelogram]
		l1_send_gpu2_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→12" fillcolor=orange shape=parallelogram]
		l1_send_gpu2_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→13" fillcolor=orange shape=parallelogram]
		l1_send_gpu2_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→14" fillcolor=orange shape=parallelogram]
		l1_send_gpu2_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu0_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→2" fillcolor=orange shape=parallelogram]
		l1_recv_gpu1_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→2" fillcolor=orange shape=parallelogram]
		l1_recv_gpu3_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→2" fillcolor=orange shape=parallelogram]
		l1_recv_gpu4_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→2" fillcolor=orange shape=parallelogram]
		l1_recv_gpu5_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→2" fillcolor=orange shape=parallelogram]
		l1_recv_gpu6_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→2" fillcolor=orange shape=parallelogram]
		l1_recv_gpu7_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→2" fillcolor=orange shape=parallelogram]
		l1_recv_gpu8_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→2" fillcolor=orange shape=parallelogram]
		l1_recv_gpu9_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→2" fillcolor=orange shape=parallelogram]
		l1_recv_gpu10_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→2" fillcolor=orange shape=parallelogram]
		l1_recv_gpu11_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→2" fillcolor=orange shape=parallelogram]
		l1_recv_gpu12_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→2" fillcolor=orange shape=parallelogram]
		l1_recv_gpu13_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→2" fillcolor=orange shape=parallelogram]
		l1_recv_gpu14_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→2" fillcolor=orange shape=parallelogram]
		l1_recv_gpu15_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→2" fillcolor=orange shape=parallelogram]
		l1_local_tokens_gpu2 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l1_expert_agg_gpu2 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l1_final_residual_gpu2 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l1_token_split_gpu3 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l1_send_gpu3_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→0" fillcolor=orange shape=parallelogram]
		l1_send_gpu3_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→1" fillcolor=orange shape=parallelogram]
		l1_send_gpu3_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→2" fillcolor=orange shape=parallelogram]
		l1_send_gpu3_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→4" fillcolor=orange shape=parallelogram]
		l1_send_gpu3_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→5" fillcolor=orange shape=parallelogram]
		l1_send_gpu3_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→6" fillcolor=orange shape=parallelogram]
		l1_send_gpu3_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→7" fillcolor=orange shape=parallelogram]
		l1_send_gpu3_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→8" fillcolor=orange shape=parallelogram]
		l1_send_gpu3_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→9" fillcolor=orange shape=parallelogram]
		l1_send_gpu3_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→10" fillcolor=orange shape=parallelogram]
		l1_send_gpu3_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→11" fillcolor=orange shape=parallelogram]
		l1_send_gpu3_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→12" fillcolor=orange shape=parallelogram]
		l1_send_gpu3_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→13" fillcolor=orange shape=parallelogram]
		l1_send_gpu3_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→14" fillcolor=orange shape=parallelogram]
		l1_send_gpu3_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu0_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→3" fillcolor=orange shape=parallelogram]
		l1_recv_gpu1_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→3" fillcolor=orange shape=parallelogram]
		l1_recv_gpu2_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→3" fillcolor=orange shape=parallelogram]
		l1_recv_gpu4_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→3" fillcolor=orange shape=parallelogram]
		l1_recv_gpu5_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→3" fillcolor=orange shape=parallelogram]
		l1_recv_gpu6_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→3" fillcolor=orange shape=parallelogram]
		l1_recv_gpu7_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→3" fillcolor=orange shape=parallelogram]
		l1_recv_gpu8_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→3" fillcolor=orange shape=parallelogram]
		l1_recv_gpu9_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→3" fillcolor=orange shape=parallelogram]
		l1_recv_gpu10_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→3" fillcolor=orange shape=parallelogram]
		l1_recv_gpu11_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→3" fillcolor=orange shape=parallelogram]
		l1_recv_gpu12_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→3" fillcolor=orange shape=parallelogram]
		l1_recv_gpu13_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→3" fillcolor=orange shape=parallelogram]
		l1_recv_gpu14_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→3" fillcolor=orange shape=parallelogram]
		l1_recv_gpu15_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→3" fillcolor=orange shape=parallelogram]
		l1_local_tokens_gpu3 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l1_expert_agg_gpu3 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l1_final_residual_gpu3 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l1_token_split_gpu4 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l1_send_gpu4_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→0" fillcolor=orange shape=parallelogram]
		l1_send_gpu4_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→1" fillcolor=orange shape=parallelogram]
		l1_send_gpu4_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→2" fillcolor=orange shape=parallelogram]
		l1_send_gpu4_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→3" fillcolor=orange shape=parallelogram]
		l1_send_gpu4_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→5" fillcolor=orange shape=parallelogram]
		l1_send_gpu4_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→6" fillcolor=orange shape=parallelogram]
		l1_send_gpu4_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→7" fillcolor=orange shape=parallelogram]
		l1_send_gpu4_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→8" fillcolor=orange shape=parallelogram]
		l1_send_gpu4_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→9" fillcolor=orange shape=parallelogram]
		l1_send_gpu4_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→10" fillcolor=orange shape=parallelogram]
		l1_send_gpu4_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→11" fillcolor=orange shape=parallelogram]
		l1_send_gpu4_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→12" fillcolor=orange shape=parallelogram]
		l1_send_gpu4_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→13" fillcolor=orange shape=parallelogram]
		l1_send_gpu4_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→14" fillcolor=orange shape=parallelogram]
		l1_send_gpu4_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu0_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→4" fillcolor=orange shape=parallelogram]
		l1_recv_gpu1_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→4" fillcolor=orange shape=parallelogram]
		l1_recv_gpu2_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→4" fillcolor=orange shape=parallelogram]
		l1_recv_gpu3_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→4" fillcolor=orange shape=parallelogram]
		l1_recv_gpu5_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→4" fillcolor=orange shape=parallelogram]
		l1_recv_gpu6_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→4" fillcolor=orange shape=parallelogram]
		l1_recv_gpu7_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→4" fillcolor=orange shape=parallelogram]
		l1_recv_gpu8_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→4" fillcolor=orange shape=parallelogram]
		l1_recv_gpu9_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→4" fillcolor=orange shape=parallelogram]
		l1_recv_gpu10_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→4" fillcolor=orange shape=parallelogram]
		l1_recv_gpu11_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→4" fillcolor=orange shape=parallelogram]
		l1_recv_gpu12_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→4" fillcolor=orange shape=parallelogram]
		l1_recv_gpu13_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→4" fillcolor=orange shape=parallelogram]
		l1_recv_gpu14_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→4" fillcolor=orange shape=parallelogram]
		l1_recv_gpu15_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→4" fillcolor=orange shape=parallelogram]
		l1_local_tokens_gpu4 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l1_expert_agg_gpu4 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l1_final_residual_gpu4 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l1_token_split_gpu5 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l1_send_gpu5_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→0" fillcolor=orange shape=parallelogram]
		l1_send_gpu5_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→1" fillcolor=orange shape=parallelogram]
		l1_send_gpu5_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→2" fillcolor=orange shape=parallelogram]
		l1_send_gpu5_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→3" fillcolor=orange shape=parallelogram]
		l1_send_gpu5_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→4" fillcolor=orange shape=parallelogram]
		l1_send_gpu5_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→6" fillcolor=orange shape=parallelogram]
		l1_send_gpu5_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→7" fillcolor=orange shape=parallelogram]
		l1_send_gpu5_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→8" fillcolor=orange shape=parallelogram]
		l1_send_gpu5_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→9" fillcolor=orange shape=parallelogram]
		l1_send_gpu5_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→10" fillcolor=orange shape=parallelogram]
		l1_send_gpu5_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→11" fillcolor=orange shape=parallelogram]
		l1_send_gpu5_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→12" fillcolor=orange shape=parallelogram]
		l1_send_gpu5_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→13" fillcolor=orange shape=parallelogram]
		l1_send_gpu5_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→14" fillcolor=orange shape=parallelogram]
		l1_send_gpu5_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu0_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→5" fillcolor=orange shape=parallelogram]
		l1_recv_gpu1_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→5" fillcolor=orange shape=parallelogram]
		l1_recv_gpu2_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→5" fillcolor=orange shape=parallelogram]
		l1_recv_gpu3_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→5" fillcolor=orange shape=parallelogram]
		l1_recv_gpu4_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→5" fillcolor=orange shape=parallelogram]
		l1_recv_gpu6_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→5" fillcolor=orange shape=parallelogram]
		l1_recv_gpu7_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→5" fillcolor=orange shape=parallelogram]
		l1_recv_gpu8_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→5" fillcolor=orange shape=parallelogram]
		l1_recv_gpu9_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→5" fillcolor=orange shape=parallelogram]
		l1_recv_gpu10_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→5" fillcolor=orange shape=parallelogram]
		l1_recv_gpu11_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→5" fillcolor=orange shape=parallelogram]
		l1_recv_gpu12_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→5" fillcolor=orange shape=parallelogram]
		l1_recv_gpu13_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→5" fillcolor=orange shape=parallelogram]
		l1_recv_gpu14_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→5" fillcolor=orange shape=parallelogram]
		l1_recv_gpu15_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→5" fillcolor=orange shape=parallelogram]
		l1_local_tokens_gpu5 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l1_expert_agg_gpu5 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l1_final_residual_gpu5 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l1_token_split_gpu6 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l1_send_gpu6_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→0" fillcolor=orange shape=parallelogram]
		l1_send_gpu6_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→1" fillcolor=orange shape=parallelogram]
		l1_send_gpu6_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→2" fillcolor=orange shape=parallelogram]
		l1_send_gpu6_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→3" fillcolor=orange shape=parallelogram]
		l1_send_gpu6_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→4" fillcolor=orange shape=parallelogram]
		l1_send_gpu6_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→5" fillcolor=orange shape=parallelogram]
		l1_send_gpu6_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→7" fillcolor=orange shape=parallelogram]
		l1_send_gpu6_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→8" fillcolor=orange shape=parallelogram]
		l1_send_gpu6_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→9" fillcolor=orange shape=parallelogram]
		l1_send_gpu6_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→10" fillcolor=orange shape=parallelogram]
		l1_send_gpu6_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→11" fillcolor=orange shape=parallelogram]
		l1_send_gpu6_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→12" fillcolor=orange shape=parallelogram]
		l1_send_gpu6_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→13" fillcolor=orange shape=parallelogram]
		l1_send_gpu6_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→14" fillcolor=orange shape=parallelogram]
		l1_send_gpu6_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu0_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→6" fillcolor=orange shape=parallelogram]
		l1_recv_gpu1_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→6" fillcolor=orange shape=parallelogram]
		l1_recv_gpu2_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→6" fillcolor=orange shape=parallelogram]
		l1_recv_gpu3_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→6" fillcolor=orange shape=parallelogram]
		l1_recv_gpu4_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→6" fillcolor=orange shape=parallelogram]
		l1_recv_gpu5_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→6" fillcolor=orange shape=parallelogram]
		l1_recv_gpu7_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→6" fillcolor=orange shape=parallelogram]
		l1_recv_gpu8_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→6" fillcolor=orange shape=parallelogram]
		l1_recv_gpu9_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→6" fillcolor=orange shape=parallelogram]
		l1_recv_gpu10_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→6" fillcolor=orange shape=parallelogram]
		l1_recv_gpu11_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→6" fillcolor=orange shape=parallelogram]
		l1_recv_gpu12_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→6" fillcolor=orange shape=parallelogram]
		l1_recv_gpu13_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→6" fillcolor=orange shape=parallelogram]
		l1_recv_gpu14_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→6" fillcolor=orange shape=parallelogram]
		l1_recv_gpu15_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→6" fillcolor=orange shape=parallelogram]
		l1_local_tokens_gpu6 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l1_expert_agg_gpu6 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l1_final_residual_gpu6 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l1_token_split_gpu7 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l1_send_gpu7_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→0" fillcolor=orange shape=parallelogram]
		l1_send_gpu7_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→1" fillcolor=orange shape=parallelogram]
		l1_send_gpu7_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→2" fillcolor=orange shape=parallelogram]
		l1_send_gpu7_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→3" fillcolor=orange shape=parallelogram]
		l1_send_gpu7_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→4" fillcolor=orange shape=parallelogram]
		l1_send_gpu7_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→5" fillcolor=orange shape=parallelogram]
		l1_send_gpu7_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→6" fillcolor=orange shape=parallelogram]
		l1_send_gpu7_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→8" fillcolor=orange shape=parallelogram]
		l1_send_gpu7_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→9" fillcolor=orange shape=parallelogram]
		l1_send_gpu7_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→10" fillcolor=orange shape=parallelogram]
		l1_send_gpu7_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→11" fillcolor=orange shape=parallelogram]
		l1_send_gpu7_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→12" fillcolor=orange shape=parallelogram]
		l1_send_gpu7_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→13" fillcolor=orange shape=parallelogram]
		l1_send_gpu7_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→14" fillcolor=orange shape=parallelogram]
		l1_send_gpu7_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu0_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→7" fillcolor=orange shape=parallelogram]
		l1_recv_gpu1_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→7" fillcolor=orange shape=parallelogram]
		l1_recv_gpu2_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→7" fillcolor=orange shape=parallelogram]
		l1_recv_gpu3_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→7" fillcolor=orange shape=parallelogram]
		l1_recv_gpu4_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→7" fillcolor=orange shape=parallelogram]
		l1_recv_gpu5_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→7" fillcolor=orange shape=parallelogram]
		l1_recv_gpu6_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→7" fillcolor=orange shape=parallelogram]
		l1_recv_gpu8_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→7" fillcolor=orange shape=parallelogram]
		l1_recv_gpu9_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→7" fillcolor=orange shape=parallelogram]
		l1_recv_gpu10_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→7" fillcolor=orange shape=parallelogram]
		l1_recv_gpu11_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→7" fillcolor=orange shape=parallelogram]
		l1_recv_gpu12_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→7" fillcolor=orange shape=parallelogram]
		l1_recv_gpu13_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→7" fillcolor=orange shape=parallelogram]
		l1_recv_gpu14_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→7" fillcolor=orange shape=parallelogram]
		l1_recv_gpu15_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→7" fillcolor=orange shape=parallelogram]
		l1_local_tokens_gpu7 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l1_expert_agg_gpu7 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l1_final_residual_gpu7 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l1_token_split_gpu8 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l1_send_gpu8_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→0" fillcolor=orange shape=parallelogram]
		l1_send_gpu8_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→1" fillcolor=orange shape=parallelogram]
		l1_send_gpu8_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→2" fillcolor=orange shape=parallelogram]
		l1_send_gpu8_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→3" fillcolor=orange shape=parallelogram]
		l1_send_gpu8_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→4" fillcolor=orange shape=parallelogram]
		l1_send_gpu8_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→5" fillcolor=orange shape=parallelogram]
		l1_send_gpu8_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→6" fillcolor=orange shape=parallelogram]
		l1_send_gpu8_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→7" fillcolor=orange shape=parallelogram]
		l1_send_gpu8_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→9" fillcolor=orange shape=parallelogram]
		l1_send_gpu8_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→10" fillcolor=orange shape=parallelogram]
		l1_send_gpu8_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→11" fillcolor=orange shape=parallelogram]
		l1_send_gpu8_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→12" fillcolor=orange shape=parallelogram]
		l1_send_gpu8_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→13" fillcolor=orange shape=parallelogram]
		l1_send_gpu8_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→14" fillcolor=orange shape=parallelogram]
		l1_send_gpu8_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu0_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→8" fillcolor=orange shape=parallelogram]
		l1_recv_gpu1_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→8" fillcolor=orange shape=parallelogram]
		l1_recv_gpu2_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→8" fillcolor=orange shape=parallelogram]
		l1_recv_gpu3_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→8" fillcolor=orange shape=parallelogram]
		l1_recv_gpu4_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→8" fillcolor=orange shape=parallelogram]
		l1_recv_gpu5_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→8" fillcolor=orange shape=parallelogram]
		l1_recv_gpu6_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→8" fillcolor=orange shape=parallelogram]
		l1_recv_gpu7_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→8" fillcolor=orange shape=parallelogram]
		l1_recv_gpu9_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→8" fillcolor=orange shape=parallelogram]
		l1_recv_gpu10_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→8" fillcolor=orange shape=parallelogram]
		l1_recv_gpu11_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→8" fillcolor=orange shape=parallelogram]
		l1_recv_gpu12_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→8" fillcolor=orange shape=parallelogram]
		l1_recv_gpu13_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→8" fillcolor=orange shape=parallelogram]
		l1_recv_gpu14_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→8" fillcolor=orange shape=parallelogram]
		l1_recv_gpu15_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→8" fillcolor=orange shape=parallelogram]
		l1_local_tokens_gpu8 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l1_expert_agg_gpu8 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l1_final_residual_gpu8 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l1_token_split_gpu9 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l1_send_gpu9_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→0" fillcolor=orange shape=parallelogram]
		l1_send_gpu9_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→1" fillcolor=orange shape=parallelogram]
		l1_send_gpu9_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→2" fillcolor=orange shape=parallelogram]
		l1_send_gpu9_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→3" fillcolor=orange shape=parallelogram]
		l1_send_gpu9_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→4" fillcolor=orange shape=parallelogram]
		l1_send_gpu9_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→5" fillcolor=orange shape=parallelogram]
		l1_send_gpu9_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→6" fillcolor=orange shape=parallelogram]
		l1_send_gpu9_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→7" fillcolor=orange shape=parallelogram]
		l1_send_gpu9_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→8" fillcolor=orange shape=parallelogram]
		l1_send_gpu9_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→10" fillcolor=orange shape=parallelogram]
		l1_send_gpu9_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→11" fillcolor=orange shape=parallelogram]
		l1_send_gpu9_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→12" fillcolor=orange shape=parallelogram]
		l1_send_gpu9_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→13" fillcolor=orange shape=parallelogram]
		l1_send_gpu9_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→14" fillcolor=orange shape=parallelogram]
		l1_send_gpu9_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu0_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→9" fillcolor=orange shape=parallelogram]
		l1_recv_gpu1_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→9" fillcolor=orange shape=parallelogram]
		l1_recv_gpu2_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→9" fillcolor=orange shape=parallelogram]
		l1_recv_gpu3_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→9" fillcolor=orange shape=parallelogram]
		l1_recv_gpu4_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→9" fillcolor=orange shape=parallelogram]
		l1_recv_gpu5_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→9" fillcolor=orange shape=parallelogram]
		l1_recv_gpu6_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→9" fillcolor=orange shape=parallelogram]
		l1_recv_gpu7_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→9" fillcolor=orange shape=parallelogram]
		l1_recv_gpu8_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→9" fillcolor=orange shape=parallelogram]
		l1_recv_gpu10_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→9" fillcolor=orange shape=parallelogram]
		l1_recv_gpu11_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→9" fillcolor=orange shape=parallelogram]
		l1_recv_gpu12_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→9" fillcolor=orange shape=parallelogram]
		l1_recv_gpu13_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→9" fillcolor=orange shape=parallelogram]
		l1_recv_gpu14_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→9" fillcolor=orange shape=parallelogram]
		l1_recv_gpu15_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→9" fillcolor=orange shape=parallelogram]
		l1_local_tokens_gpu9 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l1_expert_agg_gpu9 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l1_final_residual_gpu9 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l1_token_split_gpu10 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l1_send_gpu10_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→0" fillcolor=orange shape=parallelogram]
		l1_send_gpu10_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→1" fillcolor=orange shape=parallelogram]
		l1_send_gpu10_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→2" fillcolor=orange shape=parallelogram]
		l1_send_gpu10_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→3" fillcolor=orange shape=parallelogram]
		l1_send_gpu10_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→4" fillcolor=orange shape=parallelogram]
		l1_send_gpu10_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→5" fillcolor=orange shape=parallelogram]
		l1_send_gpu10_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→6" fillcolor=orange shape=parallelogram]
		l1_send_gpu10_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→7" fillcolor=orange shape=parallelogram]
		l1_send_gpu10_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→8" fillcolor=orange shape=parallelogram]
		l1_send_gpu10_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→9" fillcolor=orange shape=parallelogram]
		l1_send_gpu10_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→11" fillcolor=orange shape=parallelogram]
		l1_send_gpu10_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→12" fillcolor=orange shape=parallelogram]
		l1_send_gpu10_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→13" fillcolor=orange shape=parallelogram]
		l1_send_gpu10_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→14" fillcolor=orange shape=parallelogram]
		l1_send_gpu10_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu0_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→10" fillcolor=orange shape=parallelogram]
		l1_recv_gpu1_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→10" fillcolor=orange shape=parallelogram]
		l1_recv_gpu2_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→10" fillcolor=orange shape=parallelogram]
		l1_recv_gpu3_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→10" fillcolor=orange shape=parallelogram]
		l1_recv_gpu4_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→10" fillcolor=orange shape=parallelogram]
		l1_recv_gpu5_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→10" fillcolor=orange shape=parallelogram]
		l1_recv_gpu6_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→10" fillcolor=orange shape=parallelogram]
		l1_recv_gpu7_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→10" fillcolor=orange shape=parallelogram]
		l1_recv_gpu8_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→10" fillcolor=orange shape=parallelogram]
		l1_recv_gpu9_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→10" fillcolor=orange shape=parallelogram]
		l1_recv_gpu11_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→10" fillcolor=orange shape=parallelogram]
		l1_recv_gpu12_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→10" fillcolor=orange shape=parallelogram]
		l1_recv_gpu13_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→10" fillcolor=orange shape=parallelogram]
		l1_recv_gpu14_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→10" fillcolor=orange shape=parallelogram]
		l1_recv_gpu15_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→10" fillcolor=orange shape=parallelogram]
		l1_local_tokens_gpu10 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l1_expert_agg_gpu10 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l1_final_residual_gpu10 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l1_token_split_gpu11 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l1_send_gpu11_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→0" fillcolor=orange shape=parallelogram]
		l1_send_gpu11_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→1" fillcolor=orange shape=parallelogram]
		l1_send_gpu11_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→2" fillcolor=orange shape=parallelogram]
		l1_send_gpu11_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→3" fillcolor=orange shape=parallelogram]
		l1_send_gpu11_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→4" fillcolor=orange shape=parallelogram]
		l1_send_gpu11_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→5" fillcolor=orange shape=parallelogram]
		l1_send_gpu11_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→6" fillcolor=orange shape=parallelogram]
		l1_send_gpu11_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→7" fillcolor=orange shape=parallelogram]
		l1_send_gpu11_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→8" fillcolor=orange shape=parallelogram]
		l1_send_gpu11_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→9" fillcolor=orange shape=parallelogram]
		l1_send_gpu11_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→10" fillcolor=orange shape=parallelogram]
		l1_send_gpu11_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→12" fillcolor=orange shape=parallelogram]
		l1_send_gpu11_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→13" fillcolor=orange shape=parallelogram]
		l1_send_gpu11_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→14" fillcolor=orange shape=parallelogram]
		l1_send_gpu11_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu0_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→11" fillcolor=orange shape=parallelogram]
		l1_recv_gpu1_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→11" fillcolor=orange shape=parallelogram]
		l1_recv_gpu2_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→11" fillcolor=orange shape=parallelogram]
		l1_recv_gpu3_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→11" fillcolor=orange shape=parallelogram]
		l1_recv_gpu4_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→11" fillcolor=orange shape=parallelogram]
		l1_recv_gpu5_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→11" fillcolor=orange shape=parallelogram]
		l1_recv_gpu6_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→11" fillcolor=orange shape=parallelogram]
		l1_recv_gpu7_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→11" fillcolor=orange shape=parallelogram]
		l1_recv_gpu8_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→11" fillcolor=orange shape=parallelogram]
		l1_recv_gpu9_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→11" fillcolor=orange shape=parallelogram]
		l1_recv_gpu10_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→11" fillcolor=orange shape=parallelogram]
		l1_recv_gpu12_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→11" fillcolor=orange shape=parallelogram]
		l1_recv_gpu13_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→11" fillcolor=orange shape=parallelogram]
		l1_recv_gpu14_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→11" fillcolor=orange shape=parallelogram]
		l1_recv_gpu15_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→11" fillcolor=orange shape=parallelogram]
		l1_local_tokens_gpu11 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l1_expert_agg_gpu11 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l1_final_residual_gpu11 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l1_token_split_gpu12 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l1_send_gpu12_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→0" fillcolor=orange shape=parallelogram]
		l1_send_gpu12_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→1" fillcolor=orange shape=parallelogram]
		l1_send_gpu12_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→2" fillcolor=orange shape=parallelogram]
		l1_send_gpu12_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→3" fillcolor=orange shape=parallelogram]
		l1_send_gpu12_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→4" fillcolor=orange shape=parallelogram]
		l1_send_gpu12_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→5" fillcolor=orange shape=parallelogram]
		l1_send_gpu12_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→6" fillcolor=orange shape=parallelogram]
		l1_send_gpu12_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→7" fillcolor=orange shape=parallelogram]
		l1_send_gpu12_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→8" fillcolor=orange shape=parallelogram]
		l1_send_gpu12_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→9" fillcolor=orange shape=parallelogram]
		l1_send_gpu12_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→10" fillcolor=orange shape=parallelogram]
		l1_send_gpu12_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→11" fillcolor=orange shape=parallelogram]
		l1_send_gpu12_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→13" fillcolor=orange shape=parallelogram]
		l1_send_gpu12_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→14" fillcolor=orange shape=parallelogram]
		l1_send_gpu12_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu0_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→12" fillcolor=orange shape=parallelogram]
		l1_recv_gpu1_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→12" fillcolor=orange shape=parallelogram]
		l1_recv_gpu2_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→12" fillcolor=orange shape=parallelogram]
		l1_recv_gpu3_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→12" fillcolor=orange shape=parallelogram]
		l1_recv_gpu4_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→12" fillcolor=orange shape=parallelogram]
		l1_recv_gpu5_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→12" fillcolor=orange shape=parallelogram]
		l1_recv_gpu6_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→12" fillcolor=orange shape=parallelogram]
		l1_recv_gpu7_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→12" fillcolor=orange shape=parallelogram]
		l1_recv_gpu8_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→12" fillcolor=orange shape=parallelogram]
		l1_recv_gpu9_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→12" fillcolor=orange shape=parallelogram]
		l1_recv_gpu10_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→12" fillcolor=orange shape=parallelogram]
		l1_recv_gpu11_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→12" fillcolor=orange shape=parallelogram]
		l1_recv_gpu13_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→12" fillcolor=orange shape=parallelogram]
		l1_recv_gpu14_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→12" fillcolor=orange shape=parallelogram]
		l1_recv_gpu15_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→12" fillcolor=orange shape=parallelogram]
		l1_local_tokens_gpu12 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l1_expert_agg_gpu12 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l1_final_residual_gpu12 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l1_token_split_gpu13 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l1_send_gpu13_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→0" fillcolor=orange shape=parallelogram]
		l1_send_gpu13_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→1" fillcolor=orange shape=parallelogram]
		l1_send_gpu13_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→2" fillcolor=orange shape=parallelogram]
		l1_send_gpu13_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→3" fillcolor=orange shape=parallelogram]
		l1_send_gpu13_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→4" fillcolor=orange shape=parallelogram]
		l1_send_gpu13_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→5" fillcolor=orange shape=parallelogram]
		l1_send_gpu13_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→6" fillcolor=orange shape=parallelogram]
		l1_send_gpu13_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→7" fillcolor=orange shape=parallelogram]
		l1_send_gpu13_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→8" fillcolor=orange shape=parallelogram]
		l1_send_gpu13_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→9" fillcolor=orange shape=parallelogram]
		l1_send_gpu13_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→10" fillcolor=orange shape=parallelogram]
		l1_send_gpu13_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→11" fillcolor=orange shape=parallelogram]
		l1_send_gpu13_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→12" fillcolor=orange shape=parallelogram]
		l1_send_gpu13_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→14" fillcolor=orange shape=parallelogram]
		l1_send_gpu13_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu0_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→13" fillcolor=orange shape=parallelogram]
		l1_recv_gpu1_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→13" fillcolor=orange shape=parallelogram]
		l1_recv_gpu2_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→13" fillcolor=orange shape=parallelogram]
		l1_recv_gpu3_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→13" fillcolor=orange shape=parallelogram]
		l1_recv_gpu4_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→13" fillcolor=orange shape=parallelogram]
		l1_recv_gpu5_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→13" fillcolor=orange shape=parallelogram]
		l1_recv_gpu6_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→13" fillcolor=orange shape=parallelogram]
		l1_recv_gpu7_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→13" fillcolor=orange shape=parallelogram]
		l1_recv_gpu8_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→13" fillcolor=orange shape=parallelogram]
		l1_recv_gpu9_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→13" fillcolor=orange shape=parallelogram]
		l1_recv_gpu10_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→13" fillcolor=orange shape=parallelogram]
		l1_recv_gpu11_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→13" fillcolor=orange shape=parallelogram]
		l1_recv_gpu12_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→13" fillcolor=orange shape=parallelogram]
		l1_recv_gpu14_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→13" fillcolor=orange shape=parallelogram]
		l1_recv_gpu15_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→13" fillcolor=orange shape=parallelogram]
		l1_local_tokens_gpu13 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l1_expert_agg_gpu13 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l1_final_residual_gpu13 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l1_token_split_gpu14 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l1_send_gpu14_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→0" fillcolor=orange shape=parallelogram]
		l1_send_gpu14_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→1" fillcolor=orange shape=parallelogram]
		l1_send_gpu14_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→2" fillcolor=orange shape=parallelogram]
		l1_send_gpu14_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→3" fillcolor=orange shape=parallelogram]
		l1_send_gpu14_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→4" fillcolor=orange shape=parallelogram]
		l1_send_gpu14_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→5" fillcolor=orange shape=parallelogram]
		l1_send_gpu14_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→6" fillcolor=orange shape=parallelogram]
		l1_send_gpu14_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→7" fillcolor=orange shape=parallelogram]
		l1_send_gpu14_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→8" fillcolor=orange shape=parallelogram]
		l1_send_gpu14_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→9" fillcolor=orange shape=parallelogram]
		l1_send_gpu14_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→10" fillcolor=orange shape=parallelogram]
		l1_send_gpu14_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→11" fillcolor=orange shape=parallelogram]
		l1_send_gpu14_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→12" fillcolor=orange shape=parallelogram]
		l1_send_gpu14_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→13" fillcolor=orange shape=parallelogram]
		l1_send_gpu14_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu0_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→14" fillcolor=orange shape=parallelogram]
		l1_recv_gpu1_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→14" fillcolor=orange shape=parallelogram]
		l1_recv_gpu2_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→14" fillcolor=orange shape=parallelogram]
		l1_recv_gpu3_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→14" fillcolor=orange shape=parallelogram]
		l1_recv_gpu4_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→14" fillcolor=orange shape=parallelogram]
		l1_recv_gpu5_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→14" fillcolor=orange shape=parallelogram]
		l1_recv_gpu6_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→14" fillcolor=orange shape=parallelogram]
		l1_recv_gpu7_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→14" fillcolor=orange shape=parallelogram]
		l1_recv_gpu8_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→14" fillcolor=orange shape=parallelogram]
		l1_recv_gpu9_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→14" fillcolor=orange shape=parallelogram]
		l1_recv_gpu10_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→14" fillcolor=orange shape=parallelogram]
		l1_recv_gpu11_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→14" fillcolor=orange shape=parallelogram]
		l1_recv_gpu12_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→14" fillcolor=orange shape=parallelogram]
		l1_recv_gpu13_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→14" fillcolor=orange shape=parallelogram]
		l1_recv_gpu15_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→14" fillcolor=orange shape=parallelogram]
		l1_local_tokens_gpu14 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l1_expert_agg_gpu14 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l1_final_residual_gpu14 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l1_token_split_gpu15 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l1_send_gpu15_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→0" fillcolor=orange shape=parallelogram]
		l1_send_gpu15_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→1" fillcolor=orange shape=parallelogram]
		l1_send_gpu15_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→2" fillcolor=orange shape=parallelogram]
		l1_send_gpu15_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→3" fillcolor=orange shape=parallelogram]
		l1_send_gpu15_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→4" fillcolor=orange shape=parallelogram]
		l1_send_gpu15_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→5" fillcolor=orange shape=parallelogram]
		l1_send_gpu15_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→6" fillcolor=orange shape=parallelogram]
		l1_send_gpu15_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→7" fillcolor=orange shape=parallelogram]
		l1_send_gpu15_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→8" fillcolor=orange shape=parallelogram]
		l1_send_gpu15_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→9" fillcolor=orange shape=parallelogram]
		l1_send_gpu15_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→10" fillcolor=orange shape=parallelogram]
		l1_send_gpu15_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→11" fillcolor=orange shape=parallelogram]
		l1_send_gpu15_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→12" fillcolor=orange shape=parallelogram]
		l1_send_gpu15_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→13" fillcolor=orange shape=parallelogram]
		l1_send_gpu15_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→14" fillcolor=orange shape=parallelogram]
		l1_recv_gpu0_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu1_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu2_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu3_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu4_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu5_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu6_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu7_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu8_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu9_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu10_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu11_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu12_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu13_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→15" fillcolor=orange shape=parallelogram]
		l1_recv_gpu14_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→15" fillcolor=orange shape=parallelogram]
		l1_local_tokens_gpu15 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l1_expert_agg_gpu15 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l1_final_residual_gpu15 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_layer2 {
		label="Layer 2 (EP=16)\n16 GPUs, 1 expert per GPU" style=dashed
		l2_qkv_gpu0 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l2_attn_gpu0 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_gpu0 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l2_attn_residual_gpu0 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_gpu1 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l2_attn_gpu1 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_gpu1 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l2_attn_residual_gpu1 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_gpu2 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l2_attn_gpu2 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_gpu2 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l2_attn_residual_gpu2 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_gpu3 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l2_attn_gpu3 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_gpu3 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l2_attn_residual_gpu3 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_gpu4 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l2_attn_gpu4 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_gpu4 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l2_attn_residual_gpu4 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_gpu5 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l2_attn_gpu5 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_gpu5 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l2_attn_residual_gpu5 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_gpu6 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l2_attn_gpu6 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_gpu6 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l2_attn_residual_gpu6 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_gpu7 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l2_attn_gpu7 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_gpu7 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l2_attn_residual_gpu7 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_gpu8 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l2_attn_gpu8 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_gpu8 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l2_attn_residual_gpu8 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_gpu9 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l2_attn_gpu9 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_gpu9 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l2_attn_residual_gpu9 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_gpu10 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l2_attn_gpu10 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_gpu10 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l2_attn_residual_gpu10 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_gpu11 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l2_attn_gpu11 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_gpu11 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l2_attn_residual_gpu11 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_gpu12 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l2_attn_gpu12 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_gpu12 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l2_attn_residual_gpu12 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_gpu13 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l2_attn_gpu13 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_gpu13 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l2_attn_residual_gpu13 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_gpu14 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l2_attn_gpu14 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_gpu14 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l2_attn_residual_gpu14 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_gpu15 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l2_attn_gpu15 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_gpu15 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l2_attn_residual_gpu15 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l2_gate_gpu0 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l2_gate_gpu1 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l2_gate_gpu2 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l2_gate_gpu3 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l2_gate_gpu4 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l2_gate_gpu5 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l2_gate_gpu6 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l2_gate_gpu7 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l2_gate_gpu8 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l2_gate_gpu9 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l2_gate_gpu10 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l2_gate_gpu11 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l2_gate_gpu12 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l2_gate_gpu13 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l2_gate_gpu14 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l2_gate_gpu15 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l2_expert_gpu0 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l2_expert_gpu1 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l2_expert_gpu2 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l2_expert_gpu3 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l2_expert_gpu4 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l2_expert_gpu5 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l2_expert_gpu6 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l2_expert_gpu7 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l2_expert_gpu8 [label="Expert 8\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l2_expert_gpu9 [label="Expert 9\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l2_expert_gpu10 [label="Expert 10\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l2_expert_gpu11 [label="Expert 11\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l2_expert_gpu12 [label="Expert 12\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l2_expert_gpu13 [label="Expert 13\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l2_expert_gpu14 [label="Expert 14\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l2_expert_gpu15 [label="Expert 15\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l2_token_split_gpu0 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l2_send_gpu0_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→1" fillcolor=orange shape=parallelogram]
		l2_send_gpu0_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→2" fillcolor=orange shape=parallelogram]
		l2_send_gpu0_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→3" fillcolor=orange shape=parallelogram]
		l2_send_gpu0_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→4" fillcolor=orange shape=parallelogram]
		l2_send_gpu0_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→5" fillcolor=orange shape=parallelogram]
		l2_send_gpu0_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→6" fillcolor=orange shape=parallelogram]
		l2_send_gpu0_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→7" fillcolor=orange shape=parallelogram]
		l2_send_gpu0_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→8" fillcolor=orange shape=parallelogram]
		l2_send_gpu0_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→9" fillcolor=orange shape=parallelogram]
		l2_send_gpu0_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→10" fillcolor=orange shape=parallelogram]
		l2_send_gpu0_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→11" fillcolor=orange shape=parallelogram]
		l2_send_gpu0_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→12" fillcolor=orange shape=parallelogram]
		l2_send_gpu0_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→13" fillcolor=orange shape=parallelogram]
		l2_send_gpu0_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→14" fillcolor=orange shape=parallelogram]
		l2_send_gpu0_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu1_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→0" fillcolor=orange shape=parallelogram]
		l2_recv_gpu2_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→0" fillcolor=orange shape=parallelogram]
		l2_recv_gpu3_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→0" fillcolor=orange shape=parallelogram]
		l2_recv_gpu4_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→0" fillcolor=orange shape=parallelogram]
		l2_recv_gpu5_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→0" fillcolor=orange shape=parallelogram]
		l2_recv_gpu6_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→0" fillcolor=orange shape=parallelogram]
		l2_recv_gpu7_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→0" fillcolor=orange shape=parallelogram]
		l2_recv_gpu8_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→0" fillcolor=orange shape=parallelogram]
		l2_recv_gpu9_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→0" fillcolor=orange shape=parallelogram]
		l2_recv_gpu10_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→0" fillcolor=orange shape=parallelogram]
		l2_recv_gpu11_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→0" fillcolor=orange shape=parallelogram]
		l2_recv_gpu12_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→0" fillcolor=orange shape=parallelogram]
		l2_recv_gpu13_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→0" fillcolor=orange shape=parallelogram]
		l2_recv_gpu14_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→0" fillcolor=orange shape=parallelogram]
		l2_recv_gpu15_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→0" fillcolor=orange shape=parallelogram]
		l2_local_tokens_gpu0 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l2_expert_agg_gpu0 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l2_final_residual_gpu0 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l2_token_split_gpu1 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l2_send_gpu1_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→0" fillcolor=orange shape=parallelogram]
		l2_send_gpu1_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→2" fillcolor=orange shape=parallelogram]
		l2_send_gpu1_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→3" fillcolor=orange shape=parallelogram]
		l2_send_gpu1_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→4" fillcolor=orange shape=parallelogram]
		l2_send_gpu1_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→5" fillcolor=orange shape=parallelogram]
		l2_send_gpu1_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→6" fillcolor=orange shape=parallelogram]
		l2_send_gpu1_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→7" fillcolor=orange shape=parallelogram]
		l2_send_gpu1_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→8" fillcolor=orange shape=parallelogram]
		l2_send_gpu1_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→9" fillcolor=orange shape=parallelogram]
		l2_send_gpu1_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→10" fillcolor=orange shape=parallelogram]
		l2_send_gpu1_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→11" fillcolor=orange shape=parallelogram]
		l2_send_gpu1_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→12" fillcolor=orange shape=parallelogram]
		l2_send_gpu1_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→13" fillcolor=orange shape=parallelogram]
		l2_send_gpu1_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→14" fillcolor=orange shape=parallelogram]
		l2_send_gpu1_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu0_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→1" fillcolor=orange shape=parallelogram]
		l2_recv_gpu2_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→1" fillcolor=orange shape=parallelogram]
		l2_recv_gpu3_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→1" fillcolor=orange shape=parallelogram]
		l2_recv_gpu4_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→1" fillcolor=orange shape=parallelogram]
		l2_recv_gpu5_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→1" fillcolor=orange shape=parallelogram]
		l2_recv_gpu6_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→1" fillcolor=orange shape=parallelogram]
		l2_recv_gpu7_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→1" fillcolor=orange shape=parallelogram]
		l2_recv_gpu8_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→1" fillcolor=orange shape=parallelogram]
		l2_recv_gpu9_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→1" fillcolor=orange shape=parallelogram]
		l2_recv_gpu10_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→1" fillcolor=orange shape=parallelogram]
		l2_recv_gpu11_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→1" fillcolor=orange shape=parallelogram]
		l2_recv_gpu12_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→1" fillcolor=orange shape=parallelogram]
		l2_recv_gpu13_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→1" fillcolor=orange shape=parallelogram]
		l2_recv_gpu14_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→1" fillcolor=orange shape=parallelogram]
		l2_recv_gpu15_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→1" fillcolor=orange shape=parallelogram]
		l2_local_tokens_gpu1 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l2_expert_agg_gpu1 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l2_final_residual_gpu1 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l2_token_split_gpu2 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l2_send_gpu2_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→0" fillcolor=orange shape=parallelogram]
		l2_send_gpu2_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→1" fillcolor=orange shape=parallelogram]
		l2_send_gpu2_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→3" fillcolor=orange shape=parallelogram]
		l2_send_gpu2_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→4" fillcolor=orange shape=parallelogram]
		l2_send_gpu2_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→5" fillcolor=orange shape=parallelogram]
		l2_send_gpu2_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→6" fillcolor=orange shape=parallelogram]
		l2_send_gpu2_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→7" fillcolor=orange shape=parallelogram]
		l2_send_gpu2_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→8" fillcolor=orange shape=parallelogram]
		l2_send_gpu2_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→9" fillcolor=orange shape=parallelogram]
		l2_send_gpu2_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→10" fillcolor=orange shape=parallelogram]
		l2_send_gpu2_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→11" fillcolor=orange shape=parallelogram]
		l2_send_gpu2_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→12" fillcolor=orange shape=parallelogram]
		l2_send_gpu2_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→13" fillcolor=orange shape=parallelogram]
		l2_send_gpu2_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→14" fillcolor=orange shape=parallelogram]
		l2_send_gpu2_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu0_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→2" fillcolor=orange shape=parallelogram]
		l2_recv_gpu1_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→2" fillcolor=orange shape=parallelogram]
		l2_recv_gpu3_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→2" fillcolor=orange shape=parallelogram]
		l2_recv_gpu4_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→2" fillcolor=orange shape=parallelogram]
		l2_recv_gpu5_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→2" fillcolor=orange shape=parallelogram]
		l2_recv_gpu6_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→2" fillcolor=orange shape=parallelogram]
		l2_recv_gpu7_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→2" fillcolor=orange shape=parallelogram]
		l2_recv_gpu8_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→2" fillcolor=orange shape=parallelogram]
		l2_recv_gpu9_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→2" fillcolor=orange shape=parallelogram]
		l2_recv_gpu10_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→2" fillcolor=orange shape=parallelogram]
		l2_recv_gpu11_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→2" fillcolor=orange shape=parallelogram]
		l2_recv_gpu12_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→2" fillcolor=orange shape=parallelogram]
		l2_recv_gpu13_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→2" fillcolor=orange shape=parallelogram]
		l2_recv_gpu14_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→2" fillcolor=orange shape=parallelogram]
		l2_recv_gpu15_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→2" fillcolor=orange shape=parallelogram]
		l2_local_tokens_gpu2 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l2_expert_agg_gpu2 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l2_final_residual_gpu2 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l2_token_split_gpu3 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l2_send_gpu3_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→0" fillcolor=orange shape=parallelogram]
		l2_send_gpu3_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→1" fillcolor=orange shape=parallelogram]
		l2_send_gpu3_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→2" fillcolor=orange shape=parallelogram]
		l2_send_gpu3_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→4" fillcolor=orange shape=parallelogram]
		l2_send_gpu3_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→5" fillcolor=orange shape=parallelogram]
		l2_send_gpu3_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→6" fillcolor=orange shape=parallelogram]
		l2_send_gpu3_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→7" fillcolor=orange shape=parallelogram]
		l2_send_gpu3_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→8" fillcolor=orange shape=parallelogram]
		l2_send_gpu3_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→9" fillcolor=orange shape=parallelogram]
		l2_send_gpu3_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→10" fillcolor=orange shape=parallelogram]
		l2_send_gpu3_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→11" fillcolor=orange shape=parallelogram]
		l2_send_gpu3_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→12" fillcolor=orange shape=parallelogram]
		l2_send_gpu3_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→13" fillcolor=orange shape=parallelogram]
		l2_send_gpu3_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→14" fillcolor=orange shape=parallelogram]
		l2_send_gpu3_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu0_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→3" fillcolor=orange shape=parallelogram]
		l2_recv_gpu1_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→3" fillcolor=orange shape=parallelogram]
		l2_recv_gpu2_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→3" fillcolor=orange shape=parallelogram]
		l2_recv_gpu4_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→3" fillcolor=orange shape=parallelogram]
		l2_recv_gpu5_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→3" fillcolor=orange shape=parallelogram]
		l2_recv_gpu6_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→3" fillcolor=orange shape=parallelogram]
		l2_recv_gpu7_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→3" fillcolor=orange shape=parallelogram]
		l2_recv_gpu8_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→3" fillcolor=orange shape=parallelogram]
		l2_recv_gpu9_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→3" fillcolor=orange shape=parallelogram]
		l2_recv_gpu10_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→3" fillcolor=orange shape=parallelogram]
		l2_recv_gpu11_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→3" fillcolor=orange shape=parallelogram]
		l2_recv_gpu12_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→3" fillcolor=orange shape=parallelogram]
		l2_recv_gpu13_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→3" fillcolor=orange shape=parallelogram]
		l2_recv_gpu14_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→3" fillcolor=orange shape=parallelogram]
		l2_recv_gpu15_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→3" fillcolor=orange shape=parallelogram]
		l2_local_tokens_gpu3 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l2_expert_agg_gpu3 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l2_final_residual_gpu3 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l2_token_split_gpu4 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l2_send_gpu4_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→0" fillcolor=orange shape=parallelogram]
		l2_send_gpu4_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→1" fillcolor=orange shape=parallelogram]
		l2_send_gpu4_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→2" fillcolor=orange shape=parallelogram]
		l2_send_gpu4_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→3" fillcolor=orange shape=parallelogram]
		l2_send_gpu4_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→5" fillcolor=orange shape=parallelogram]
		l2_send_gpu4_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→6" fillcolor=orange shape=parallelogram]
		l2_send_gpu4_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→7" fillcolor=orange shape=parallelogram]
		l2_send_gpu4_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→8" fillcolor=orange shape=parallelogram]
		l2_send_gpu4_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→9" fillcolor=orange shape=parallelogram]
		l2_send_gpu4_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→10" fillcolor=orange shape=parallelogram]
		l2_send_gpu4_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→11" fillcolor=orange shape=parallelogram]
		l2_send_gpu4_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→12" fillcolor=orange shape=parallelogram]
		l2_send_gpu4_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→13" fillcolor=orange shape=parallelogram]
		l2_send_gpu4_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→14" fillcolor=orange shape=parallelogram]
		l2_send_gpu4_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu0_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→4" fillcolor=orange shape=parallelogram]
		l2_recv_gpu1_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→4" fillcolor=orange shape=parallelogram]
		l2_recv_gpu2_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→4" fillcolor=orange shape=parallelogram]
		l2_recv_gpu3_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→4" fillcolor=orange shape=parallelogram]
		l2_recv_gpu5_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→4" fillcolor=orange shape=parallelogram]
		l2_recv_gpu6_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→4" fillcolor=orange shape=parallelogram]
		l2_recv_gpu7_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→4" fillcolor=orange shape=parallelogram]
		l2_recv_gpu8_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→4" fillcolor=orange shape=parallelogram]
		l2_recv_gpu9_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→4" fillcolor=orange shape=parallelogram]
		l2_recv_gpu10_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→4" fillcolor=orange shape=parallelogram]
		l2_recv_gpu11_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→4" fillcolor=orange shape=parallelogram]
		l2_recv_gpu12_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→4" fillcolor=orange shape=parallelogram]
		l2_recv_gpu13_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→4" fillcolor=orange shape=parallelogram]
		l2_recv_gpu14_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→4" fillcolor=orange shape=parallelogram]
		l2_recv_gpu15_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→4" fillcolor=orange shape=parallelogram]
		l2_local_tokens_gpu4 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l2_expert_agg_gpu4 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l2_final_residual_gpu4 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l2_token_split_gpu5 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l2_send_gpu5_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→0" fillcolor=orange shape=parallelogram]
		l2_send_gpu5_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→1" fillcolor=orange shape=parallelogram]
		l2_send_gpu5_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→2" fillcolor=orange shape=parallelogram]
		l2_send_gpu5_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→3" fillcolor=orange shape=parallelogram]
		l2_send_gpu5_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→4" fillcolor=orange shape=parallelogram]
		l2_send_gpu5_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→6" fillcolor=orange shape=parallelogram]
		l2_send_gpu5_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→7" fillcolor=orange shape=parallelogram]
		l2_send_gpu5_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→8" fillcolor=orange shape=parallelogram]
		l2_send_gpu5_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→9" fillcolor=orange shape=parallelogram]
		l2_send_gpu5_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→10" fillcolor=orange shape=parallelogram]
		l2_send_gpu5_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→11" fillcolor=orange shape=parallelogram]
		l2_send_gpu5_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→12" fillcolor=orange shape=parallelogram]
		l2_send_gpu5_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→13" fillcolor=orange shape=parallelogram]
		l2_send_gpu5_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→14" fillcolor=orange shape=parallelogram]
		l2_send_gpu5_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu0_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→5" fillcolor=orange shape=parallelogram]
		l2_recv_gpu1_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→5" fillcolor=orange shape=parallelogram]
		l2_recv_gpu2_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→5" fillcolor=orange shape=parallelogram]
		l2_recv_gpu3_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→5" fillcolor=orange shape=parallelogram]
		l2_recv_gpu4_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→5" fillcolor=orange shape=parallelogram]
		l2_recv_gpu6_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→5" fillcolor=orange shape=parallelogram]
		l2_recv_gpu7_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→5" fillcolor=orange shape=parallelogram]
		l2_recv_gpu8_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→5" fillcolor=orange shape=parallelogram]
		l2_recv_gpu9_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→5" fillcolor=orange shape=parallelogram]
		l2_recv_gpu10_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→5" fillcolor=orange shape=parallelogram]
		l2_recv_gpu11_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→5" fillcolor=orange shape=parallelogram]
		l2_recv_gpu12_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→5" fillcolor=orange shape=parallelogram]
		l2_recv_gpu13_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→5" fillcolor=orange shape=parallelogram]
		l2_recv_gpu14_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→5" fillcolor=orange shape=parallelogram]
		l2_recv_gpu15_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→5" fillcolor=orange shape=parallelogram]
		l2_local_tokens_gpu5 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l2_expert_agg_gpu5 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l2_final_residual_gpu5 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l2_token_split_gpu6 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l2_send_gpu6_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→0" fillcolor=orange shape=parallelogram]
		l2_send_gpu6_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→1" fillcolor=orange shape=parallelogram]
		l2_send_gpu6_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→2" fillcolor=orange shape=parallelogram]
		l2_send_gpu6_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→3" fillcolor=orange shape=parallelogram]
		l2_send_gpu6_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→4" fillcolor=orange shape=parallelogram]
		l2_send_gpu6_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→5" fillcolor=orange shape=parallelogram]
		l2_send_gpu6_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→7" fillcolor=orange shape=parallelogram]
		l2_send_gpu6_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→8" fillcolor=orange shape=parallelogram]
		l2_send_gpu6_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→9" fillcolor=orange shape=parallelogram]
		l2_send_gpu6_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→10" fillcolor=orange shape=parallelogram]
		l2_send_gpu6_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→11" fillcolor=orange shape=parallelogram]
		l2_send_gpu6_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→12" fillcolor=orange shape=parallelogram]
		l2_send_gpu6_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→13" fillcolor=orange shape=parallelogram]
		l2_send_gpu6_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→14" fillcolor=orange shape=parallelogram]
		l2_send_gpu6_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu0_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→6" fillcolor=orange shape=parallelogram]
		l2_recv_gpu1_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→6" fillcolor=orange shape=parallelogram]
		l2_recv_gpu2_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→6" fillcolor=orange shape=parallelogram]
		l2_recv_gpu3_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→6" fillcolor=orange shape=parallelogram]
		l2_recv_gpu4_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→6" fillcolor=orange shape=parallelogram]
		l2_recv_gpu5_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→6" fillcolor=orange shape=parallelogram]
		l2_recv_gpu7_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→6" fillcolor=orange shape=parallelogram]
		l2_recv_gpu8_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→6" fillcolor=orange shape=parallelogram]
		l2_recv_gpu9_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→6" fillcolor=orange shape=parallelogram]
		l2_recv_gpu10_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→6" fillcolor=orange shape=parallelogram]
		l2_recv_gpu11_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→6" fillcolor=orange shape=parallelogram]
		l2_recv_gpu12_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→6" fillcolor=orange shape=parallelogram]
		l2_recv_gpu13_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→6" fillcolor=orange shape=parallelogram]
		l2_recv_gpu14_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→6" fillcolor=orange shape=parallelogram]
		l2_recv_gpu15_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→6" fillcolor=orange shape=parallelogram]
		l2_local_tokens_gpu6 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l2_expert_agg_gpu6 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l2_final_residual_gpu6 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l2_token_split_gpu7 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l2_send_gpu7_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→0" fillcolor=orange shape=parallelogram]
		l2_send_gpu7_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→1" fillcolor=orange shape=parallelogram]
		l2_send_gpu7_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→2" fillcolor=orange shape=parallelogram]
		l2_send_gpu7_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→3" fillcolor=orange shape=parallelogram]
		l2_send_gpu7_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→4" fillcolor=orange shape=parallelogram]
		l2_send_gpu7_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→5" fillcolor=orange shape=parallelogram]
		l2_send_gpu7_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→6" fillcolor=orange shape=parallelogram]
		l2_send_gpu7_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→8" fillcolor=orange shape=parallelogram]
		l2_send_gpu7_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→9" fillcolor=orange shape=parallelogram]
		l2_send_gpu7_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→10" fillcolor=orange shape=parallelogram]
		l2_send_gpu7_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→11" fillcolor=orange shape=parallelogram]
		l2_send_gpu7_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→12" fillcolor=orange shape=parallelogram]
		l2_send_gpu7_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→13" fillcolor=orange shape=parallelogram]
		l2_send_gpu7_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→14" fillcolor=orange shape=parallelogram]
		l2_send_gpu7_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu0_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→7" fillcolor=orange shape=parallelogram]
		l2_recv_gpu1_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→7" fillcolor=orange shape=parallelogram]
		l2_recv_gpu2_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→7" fillcolor=orange shape=parallelogram]
		l2_recv_gpu3_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→7" fillcolor=orange shape=parallelogram]
		l2_recv_gpu4_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→7" fillcolor=orange shape=parallelogram]
		l2_recv_gpu5_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→7" fillcolor=orange shape=parallelogram]
		l2_recv_gpu6_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→7" fillcolor=orange shape=parallelogram]
		l2_recv_gpu8_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→7" fillcolor=orange shape=parallelogram]
		l2_recv_gpu9_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→7" fillcolor=orange shape=parallelogram]
		l2_recv_gpu10_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→7" fillcolor=orange shape=parallelogram]
		l2_recv_gpu11_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→7" fillcolor=orange shape=parallelogram]
		l2_recv_gpu12_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→7" fillcolor=orange shape=parallelogram]
		l2_recv_gpu13_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→7" fillcolor=orange shape=parallelogram]
		l2_recv_gpu14_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→7" fillcolor=orange shape=parallelogram]
		l2_recv_gpu15_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→7" fillcolor=orange shape=parallelogram]
		l2_local_tokens_gpu7 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l2_expert_agg_gpu7 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l2_final_residual_gpu7 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l2_token_split_gpu8 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l2_send_gpu8_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→0" fillcolor=orange shape=parallelogram]
		l2_send_gpu8_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→1" fillcolor=orange shape=parallelogram]
		l2_send_gpu8_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→2" fillcolor=orange shape=parallelogram]
		l2_send_gpu8_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→3" fillcolor=orange shape=parallelogram]
		l2_send_gpu8_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→4" fillcolor=orange shape=parallelogram]
		l2_send_gpu8_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→5" fillcolor=orange shape=parallelogram]
		l2_send_gpu8_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→6" fillcolor=orange shape=parallelogram]
		l2_send_gpu8_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→7" fillcolor=orange shape=parallelogram]
		l2_send_gpu8_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→9" fillcolor=orange shape=parallelogram]
		l2_send_gpu8_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→10" fillcolor=orange shape=parallelogram]
		l2_send_gpu8_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→11" fillcolor=orange shape=parallelogram]
		l2_send_gpu8_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→12" fillcolor=orange shape=parallelogram]
		l2_send_gpu8_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→13" fillcolor=orange shape=parallelogram]
		l2_send_gpu8_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→14" fillcolor=orange shape=parallelogram]
		l2_send_gpu8_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu0_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→8" fillcolor=orange shape=parallelogram]
		l2_recv_gpu1_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→8" fillcolor=orange shape=parallelogram]
		l2_recv_gpu2_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→8" fillcolor=orange shape=parallelogram]
		l2_recv_gpu3_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→8" fillcolor=orange shape=parallelogram]
		l2_recv_gpu4_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→8" fillcolor=orange shape=parallelogram]
		l2_recv_gpu5_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→8" fillcolor=orange shape=parallelogram]
		l2_recv_gpu6_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→8" fillcolor=orange shape=parallelogram]
		l2_recv_gpu7_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→8" fillcolor=orange shape=parallelogram]
		l2_recv_gpu9_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→8" fillcolor=orange shape=parallelogram]
		l2_recv_gpu10_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→8" fillcolor=orange shape=parallelogram]
		l2_recv_gpu11_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→8" fillcolor=orange shape=parallelogram]
		l2_recv_gpu12_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→8" fillcolor=orange shape=parallelogram]
		l2_recv_gpu13_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→8" fillcolor=orange shape=parallelogram]
		l2_recv_gpu14_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→8" fillcolor=orange shape=parallelogram]
		l2_recv_gpu15_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→8" fillcolor=orange shape=parallelogram]
		l2_local_tokens_gpu8 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l2_expert_agg_gpu8 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l2_final_residual_gpu8 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l2_token_split_gpu9 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l2_send_gpu9_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→0" fillcolor=orange shape=parallelogram]
		l2_send_gpu9_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→1" fillcolor=orange shape=parallelogram]
		l2_send_gpu9_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→2" fillcolor=orange shape=parallelogram]
		l2_send_gpu9_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→3" fillcolor=orange shape=parallelogram]
		l2_send_gpu9_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→4" fillcolor=orange shape=parallelogram]
		l2_send_gpu9_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→5" fillcolor=orange shape=parallelogram]
		l2_send_gpu9_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→6" fillcolor=orange shape=parallelogram]
		l2_send_gpu9_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→7" fillcolor=orange shape=parallelogram]
		l2_send_gpu9_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→8" fillcolor=orange shape=parallelogram]
		l2_send_gpu9_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→10" fillcolor=orange shape=parallelogram]
		l2_send_gpu9_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→11" fillcolor=orange shape=parallelogram]
		l2_send_gpu9_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→12" fillcolor=orange shape=parallelogram]
		l2_send_gpu9_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→13" fillcolor=orange shape=parallelogram]
		l2_send_gpu9_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→14" fillcolor=orange shape=parallelogram]
		l2_send_gpu9_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu0_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→9" fillcolor=orange shape=parallelogram]
		l2_recv_gpu1_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→9" fillcolor=orange shape=parallelogram]
		l2_recv_gpu2_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→9" fillcolor=orange shape=parallelogram]
		l2_recv_gpu3_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→9" fillcolor=orange shape=parallelogram]
		l2_recv_gpu4_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→9" fillcolor=orange shape=parallelogram]
		l2_recv_gpu5_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→9" fillcolor=orange shape=parallelogram]
		l2_recv_gpu6_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→9" fillcolor=orange shape=parallelogram]
		l2_recv_gpu7_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→9" fillcolor=orange shape=parallelogram]
		l2_recv_gpu8_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→9" fillcolor=orange shape=parallelogram]
		l2_recv_gpu10_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→9" fillcolor=orange shape=parallelogram]
		l2_recv_gpu11_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→9" fillcolor=orange shape=parallelogram]
		l2_recv_gpu12_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→9" fillcolor=orange shape=parallelogram]
		l2_recv_gpu13_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→9" fillcolor=orange shape=parallelogram]
		l2_recv_gpu14_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→9" fillcolor=orange shape=parallelogram]
		l2_recv_gpu15_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→9" fillcolor=orange shape=parallelogram]
		l2_local_tokens_gpu9 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l2_expert_agg_gpu9 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l2_final_residual_gpu9 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l2_token_split_gpu10 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l2_send_gpu10_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→0" fillcolor=orange shape=parallelogram]
		l2_send_gpu10_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→1" fillcolor=orange shape=parallelogram]
		l2_send_gpu10_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→2" fillcolor=orange shape=parallelogram]
		l2_send_gpu10_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→3" fillcolor=orange shape=parallelogram]
		l2_send_gpu10_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→4" fillcolor=orange shape=parallelogram]
		l2_send_gpu10_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→5" fillcolor=orange shape=parallelogram]
		l2_send_gpu10_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→6" fillcolor=orange shape=parallelogram]
		l2_send_gpu10_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→7" fillcolor=orange shape=parallelogram]
		l2_send_gpu10_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→8" fillcolor=orange shape=parallelogram]
		l2_send_gpu10_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→9" fillcolor=orange shape=parallelogram]
		l2_send_gpu10_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→11" fillcolor=orange shape=parallelogram]
		l2_send_gpu10_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→12" fillcolor=orange shape=parallelogram]
		l2_send_gpu10_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→13" fillcolor=orange shape=parallelogram]
		l2_send_gpu10_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→14" fillcolor=orange shape=parallelogram]
		l2_send_gpu10_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu0_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→10" fillcolor=orange shape=parallelogram]
		l2_recv_gpu1_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→10" fillcolor=orange shape=parallelogram]
		l2_recv_gpu2_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→10" fillcolor=orange shape=parallelogram]
		l2_recv_gpu3_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→10" fillcolor=orange shape=parallelogram]
		l2_recv_gpu4_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→10" fillcolor=orange shape=parallelogram]
		l2_recv_gpu5_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→10" fillcolor=orange shape=parallelogram]
		l2_recv_gpu6_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→10" fillcolor=orange shape=parallelogram]
		l2_recv_gpu7_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→10" fillcolor=orange shape=parallelogram]
		l2_recv_gpu8_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→10" fillcolor=orange shape=parallelogram]
		l2_recv_gpu9_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→10" fillcolor=orange shape=parallelogram]
		l2_recv_gpu11_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→10" fillcolor=orange shape=parallelogram]
		l2_recv_gpu12_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→10" fillcolor=orange shape=parallelogram]
		l2_recv_gpu13_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→10" fillcolor=orange shape=parallelogram]
		l2_recv_gpu14_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→10" fillcolor=orange shape=parallelogram]
		l2_recv_gpu15_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→10" fillcolor=orange shape=parallelogram]
		l2_local_tokens_gpu10 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l2_expert_agg_gpu10 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l2_final_residual_gpu10 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l2_token_split_gpu11 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l2_send_gpu11_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→0" fillcolor=orange shape=parallelogram]
		l2_send_gpu11_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→1" fillcolor=orange shape=parallelogram]
		l2_send_gpu11_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→2" fillcolor=orange shape=parallelogram]
		l2_send_gpu11_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→3" fillcolor=orange shape=parallelogram]
		l2_send_gpu11_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→4" fillcolor=orange shape=parallelogram]
		l2_send_gpu11_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→5" fillcolor=orange shape=parallelogram]
		l2_send_gpu11_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→6" fillcolor=orange shape=parallelogram]
		l2_send_gpu11_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→7" fillcolor=orange shape=parallelogram]
		l2_send_gpu11_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→8" fillcolor=orange shape=parallelogram]
		l2_send_gpu11_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→9" fillcolor=orange shape=parallelogram]
		l2_send_gpu11_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→10" fillcolor=orange shape=parallelogram]
		l2_send_gpu11_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→12" fillcolor=orange shape=parallelogram]
		l2_send_gpu11_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→13" fillcolor=orange shape=parallelogram]
		l2_send_gpu11_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→14" fillcolor=orange shape=parallelogram]
		l2_send_gpu11_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu0_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→11" fillcolor=orange shape=parallelogram]
		l2_recv_gpu1_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→11" fillcolor=orange shape=parallelogram]
		l2_recv_gpu2_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→11" fillcolor=orange shape=parallelogram]
		l2_recv_gpu3_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→11" fillcolor=orange shape=parallelogram]
		l2_recv_gpu4_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→11" fillcolor=orange shape=parallelogram]
		l2_recv_gpu5_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→11" fillcolor=orange shape=parallelogram]
		l2_recv_gpu6_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→11" fillcolor=orange shape=parallelogram]
		l2_recv_gpu7_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→11" fillcolor=orange shape=parallelogram]
		l2_recv_gpu8_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→11" fillcolor=orange shape=parallelogram]
		l2_recv_gpu9_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→11" fillcolor=orange shape=parallelogram]
		l2_recv_gpu10_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→11" fillcolor=orange shape=parallelogram]
		l2_recv_gpu12_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→11" fillcolor=orange shape=parallelogram]
		l2_recv_gpu13_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→11" fillcolor=orange shape=parallelogram]
		l2_recv_gpu14_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→11" fillcolor=orange shape=parallelogram]
		l2_recv_gpu15_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→11" fillcolor=orange shape=parallelogram]
		l2_local_tokens_gpu11 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l2_expert_agg_gpu11 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l2_final_residual_gpu11 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l2_token_split_gpu12 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l2_send_gpu12_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→0" fillcolor=orange shape=parallelogram]
		l2_send_gpu12_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→1" fillcolor=orange shape=parallelogram]
		l2_send_gpu12_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→2" fillcolor=orange shape=parallelogram]
		l2_send_gpu12_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→3" fillcolor=orange shape=parallelogram]
		l2_send_gpu12_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→4" fillcolor=orange shape=parallelogram]
		l2_send_gpu12_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→5" fillcolor=orange shape=parallelogram]
		l2_send_gpu12_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→6" fillcolor=orange shape=parallelogram]
		l2_send_gpu12_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→7" fillcolor=orange shape=parallelogram]
		l2_send_gpu12_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→8" fillcolor=orange shape=parallelogram]
		l2_send_gpu12_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→9" fillcolor=orange shape=parallelogram]
		l2_send_gpu12_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→10" fillcolor=orange shape=parallelogram]
		l2_send_gpu12_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→11" fillcolor=orange shape=parallelogram]
		l2_send_gpu12_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→13" fillcolor=orange shape=parallelogram]
		l2_send_gpu12_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→14" fillcolor=orange shape=parallelogram]
		l2_send_gpu12_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu0_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→12" fillcolor=orange shape=parallelogram]
		l2_recv_gpu1_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→12" fillcolor=orange shape=parallelogram]
		l2_recv_gpu2_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→12" fillcolor=orange shape=parallelogram]
		l2_recv_gpu3_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→12" fillcolor=orange shape=parallelogram]
		l2_recv_gpu4_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→12" fillcolor=orange shape=parallelogram]
		l2_recv_gpu5_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→12" fillcolor=orange shape=parallelogram]
		l2_recv_gpu6_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→12" fillcolor=orange shape=parallelogram]
		l2_recv_gpu7_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→12" fillcolor=orange shape=parallelogram]
		l2_recv_gpu8_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→12" fillcolor=orange shape=parallelogram]
		l2_recv_gpu9_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→12" fillcolor=orange shape=parallelogram]
		l2_recv_gpu10_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→12" fillcolor=orange shape=parallelogram]
		l2_recv_gpu11_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→12" fillcolor=orange shape=parallelogram]
		l2_recv_gpu13_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→12" fillcolor=orange shape=parallelogram]
		l2_recv_gpu14_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→12" fillcolor=orange shape=parallelogram]
		l2_recv_gpu15_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→12" fillcolor=orange shape=parallelogram]
		l2_local_tokens_gpu12 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l2_expert_agg_gpu12 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l2_final_residual_gpu12 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l2_token_split_gpu13 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l2_send_gpu13_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→0" fillcolor=orange shape=parallelogram]
		l2_send_gpu13_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→1" fillcolor=orange shape=parallelogram]
		l2_send_gpu13_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→2" fillcolor=orange shape=parallelogram]
		l2_send_gpu13_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→3" fillcolor=orange shape=parallelogram]
		l2_send_gpu13_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→4" fillcolor=orange shape=parallelogram]
		l2_send_gpu13_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→5" fillcolor=orange shape=parallelogram]
		l2_send_gpu13_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→6" fillcolor=orange shape=parallelogram]
		l2_send_gpu13_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→7" fillcolor=orange shape=parallelogram]
		l2_send_gpu13_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→8" fillcolor=orange shape=parallelogram]
		l2_send_gpu13_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→9" fillcolor=orange shape=parallelogram]
		l2_send_gpu13_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→10" fillcolor=orange shape=parallelogram]
		l2_send_gpu13_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→11" fillcolor=orange shape=parallelogram]
		l2_send_gpu13_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→12" fillcolor=orange shape=parallelogram]
		l2_send_gpu13_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→14" fillcolor=orange shape=parallelogram]
		l2_send_gpu13_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu0_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→13" fillcolor=orange shape=parallelogram]
		l2_recv_gpu1_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→13" fillcolor=orange shape=parallelogram]
		l2_recv_gpu2_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→13" fillcolor=orange shape=parallelogram]
		l2_recv_gpu3_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→13" fillcolor=orange shape=parallelogram]
		l2_recv_gpu4_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→13" fillcolor=orange shape=parallelogram]
		l2_recv_gpu5_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→13" fillcolor=orange shape=parallelogram]
		l2_recv_gpu6_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→13" fillcolor=orange shape=parallelogram]
		l2_recv_gpu7_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→13" fillcolor=orange shape=parallelogram]
		l2_recv_gpu8_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→13" fillcolor=orange shape=parallelogram]
		l2_recv_gpu9_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→13" fillcolor=orange shape=parallelogram]
		l2_recv_gpu10_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→13" fillcolor=orange shape=parallelogram]
		l2_recv_gpu11_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→13" fillcolor=orange shape=parallelogram]
		l2_recv_gpu12_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→13" fillcolor=orange shape=parallelogram]
		l2_recv_gpu14_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→13" fillcolor=orange shape=parallelogram]
		l2_recv_gpu15_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→13" fillcolor=orange shape=parallelogram]
		l2_local_tokens_gpu13 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l2_expert_agg_gpu13 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l2_final_residual_gpu13 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l2_token_split_gpu14 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l2_send_gpu14_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→0" fillcolor=orange shape=parallelogram]
		l2_send_gpu14_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→1" fillcolor=orange shape=parallelogram]
		l2_send_gpu14_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→2" fillcolor=orange shape=parallelogram]
		l2_send_gpu14_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→3" fillcolor=orange shape=parallelogram]
		l2_send_gpu14_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→4" fillcolor=orange shape=parallelogram]
		l2_send_gpu14_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→5" fillcolor=orange shape=parallelogram]
		l2_send_gpu14_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→6" fillcolor=orange shape=parallelogram]
		l2_send_gpu14_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→7" fillcolor=orange shape=parallelogram]
		l2_send_gpu14_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→8" fillcolor=orange shape=parallelogram]
		l2_send_gpu14_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→9" fillcolor=orange shape=parallelogram]
		l2_send_gpu14_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→10" fillcolor=orange shape=parallelogram]
		l2_send_gpu14_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→11" fillcolor=orange shape=parallelogram]
		l2_send_gpu14_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→12" fillcolor=orange shape=parallelogram]
		l2_send_gpu14_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→13" fillcolor=orange shape=parallelogram]
		l2_send_gpu14_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu0_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→14" fillcolor=orange shape=parallelogram]
		l2_recv_gpu1_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→14" fillcolor=orange shape=parallelogram]
		l2_recv_gpu2_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→14" fillcolor=orange shape=parallelogram]
		l2_recv_gpu3_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→14" fillcolor=orange shape=parallelogram]
		l2_recv_gpu4_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→14" fillcolor=orange shape=parallelogram]
		l2_recv_gpu5_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→14" fillcolor=orange shape=parallelogram]
		l2_recv_gpu6_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→14" fillcolor=orange shape=parallelogram]
		l2_recv_gpu7_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→14" fillcolor=orange shape=parallelogram]
		l2_recv_gpu8_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→14" fillcolor=orange shape=parallelogram]
		l2_recv_gpu9_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→14" fillcolor=orange shape=parallelogram]
		l2_recv_gpu10_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→14" fillcolor=orange shape=parallelogram]
		l2_recv_gpu11_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→14" fillcolor=orange shape=parallelogram]
		l2_recv_gpu12_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→14" fillcolor=orange shape=parallelogram]
		l2_recv_gpu13_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→14" fillcolor=orange shape=parallelogram]
		l2_recv_gpu15_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→14" fillcolor=orange shape=parallelogram]
		l2_local_tokens_gpu14 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l2_expert_agg_gpu14 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l2_final_residual_gpu14 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l2_token_split_gpu15 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l2_send_gpu15_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→0" fillcolor=orange shape=parallelogram]
		l2_send_gpu15_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→1" fillcolor=orange shape=parallelogram]
		l2_send_gpu15_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→2" fillcolor=orange shape=parallelogram]
		l2_send_gpu15_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→3" fillcolor=orange shape=parallelogram]
		l2_send_gpu15_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→4" fillcolor=orange shape=parallelogram]
		l2_send_gpu15_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→5" fillcolor=orange shape=parallelogram]
		l2_send_gpu15_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→6" fillcolor=orange shape=parallelogram]
		l2_send_gpu15_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→7" fillcolor=orange shape=parallelogram]
		l2_send_gpu15_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→8" fillcolor=orange shape=parallelogram]
		l2_send_gpu15_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→9" fillcolor=orange shape=parallelogram]
		l2_send_gpu15_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→10" fillcolor=orange shape=parallelogram]
		l2_send_gpu15_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→11" fillcolor=orange shape=parallelogram]
		l2_send_gpu15_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→12" fillcolor=orange shape=parallelogram]
		l2_send_gpu15_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→13" fillcolor=orange shape=parallelogram]
		l2_send_gpu15_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→14" fillcolor=orange shape=parallelogram]
		l2_recv_gpu0_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu1_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu2_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu3_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu4_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu5_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu6_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu7_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu8_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu9_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu10_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu11_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu12_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu13_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→15" fillcolor=orange shape=parallelogram]
		l2_recv_gpu14_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→15" fillcolor=orange shape=parallelogram]
		l2_local_tokens_gpu15 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l2_expert_agg_gpu15 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l2_final_residual_gpu15 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_layer3 {
		label="Layer 3 (EP=16)\n16 GPUs, 1 expert per GPU" style=dashed
		l3_qkv_gpu0 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l3_attn_gpu0 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_gpu0 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l3_attn_residual_gpu0 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_gpu1 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l3_attn_gpu1 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_gpu1 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l3_attn_residual_gpu1 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_gpu2 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l3_attn_gpu2 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_gpu2 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l3_attn_residual_gpu2 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_gpu3 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l3_attn_gpu3 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_gpu3 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l3_attn_residual_gpu3 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_gpu4 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l3_attn_gpu4 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_gpu4 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l3_attn_residual_gpu4 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_gpu5 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l3_attn_gpu5 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_gpu5 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l3_attn_residual_gpu5 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_gpu6 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l3_attn_gpu6 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_gpu6 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l3_attn_residual_gpu6 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_gpu7 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l3_attn_gpu7 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_gpu7 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l3_attn_residual_gpu7 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_gpu8 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l3_attn_gpu8 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_gpu8 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l3_attn_residual_gpu8 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_gpu9 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l3_attn_gpu9 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_gpu9 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l3_attn_residual_gpu9 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_gpu10 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l3_attn_gpu10 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_gpu10 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l3_attn_residual_gpu10 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_gpu11 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l3_attn_gpu11 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_gpu11 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l3_attn_residual_gpu11 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_gpu12 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l3_attn_gpu12 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_gpu12 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l3_attn_residual_gpu12 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_gpu13 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l3_attn_gpu13 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_gpu13 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l3_attn_residual_gpu13 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_gpu14 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l3_attn_gpu14 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_gpu14 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l3_attn_residual_gpu14 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_gpu15 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l3_attn_gpu15 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_gpu15 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l3_attn_residual_gpu15 [label="Attention Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l3_gate_gpu0 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l3_gate_gpu1 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l3_gate_gpu2 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l3_gate_gpu3 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l3_gate_gpu4 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l3_gate_gpu5 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l3_gate_gpu6 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l3_gate_gpu7 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l3_gate_gpu8 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l3_gate_gpu9 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l3_gate_gpu10 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l3_gate_gpu11 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l3_gate_gpu12 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l3_gate_gpu13 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l3_gate_gpu14 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l3_gate_gpu15 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l3_expert_gpu0 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l3_expert_gpu1 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l3_expert_gpu2 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l3_expert_gpu3 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l3_expert_gpu4 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l3_expert_gpu5 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l3_expert_gpu6 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l3_expert_gpu7 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l3_expert_gpu8 [label="Expert 8\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l3_expert_gpu9 [label="Expert 9\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l3_expert_gpu10 [label="Expert 10\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l3_expert_gpu11 [label="Expert 11\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l3_expert_gpu12 [label="Expert 12\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l3_expert_gpu13 [label="Expert 13\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l3_expert_gpu14 [label="Expert 14\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l3_expert_gpu15 [label="Expert 15\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l3_token_split_gpu0 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l3_send_gpu0_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→1" fillcolor=orange shape=parallelogram]
		l3_send_gpu0_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→2" fillcolor=orange shape=parallelogram]
		l3_send_gpu0_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→3" fillcolor=orange shape=parallelogram]
		l3_send_gpu0_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→4" fillcolor=orange shape=parallelogram]
		l3_send_gpu0_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→5" fillcolor=orange shape=parallelogram]
		l3_send_gpu0_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→6" fillcolor=orange shape=parallelogram]
		l3_send_gpu0_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→7" fillcolor=orange shape=parallelogram]
		l3_send_gpu0_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→8" fillcolor=orange shape=parallelogram]
		l3_send_gpu0_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→9" fillcolor=orange shape=parallelogram]
		l3_send_gpu0_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→10" fillcolor=orange shape=parallelogram]
		l3_send_gpu0_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→11" fillcolor=orange shape=parallelogram]
		l3_send_gpu0_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→12" fillcolor=orange shape=parallelogram]
		l3_send_gpu0_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→13" fillcolor=orange shape=parallelogram]
		l3_send_gpu0_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→14" fillcolor=orange shape=parallelogram]
		l3_send_gpu0_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu1_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→0" fillcolor=orange shape=parallelogram]
		l3_recv_gpu2_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→0" fillcolor=orange shape=parallelogram]
		l3_recv_gpu3_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→0" fillcolor=orange shape=parallelogram]
		l3_recv_gpu4_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→0" fillcolor=orange shape=parallelogram]
		l3_recv_gpu5_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→0" fillcolor=orange shape=parallelogram]
		l3_recv_gpu6_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→0" fillcolor=orange shape=parallelogram]
		l3_recv_gpu7_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→0" fillcolor=orange shape=parallelogram]
		l3_recv_gpu8_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→0" fillcolor=orange shape=parallelogram]
		l3_recv_gpu9_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→0" fillcolor=orange shape=parallelogram]
		l3_recv_gpu10_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→0" fillcolor=orange shape=parallelogram]
		l3_recv_gpu11_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→0" fillcolor=orange shape=parallelogram]
		l3_recv_gpu12_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→0" fillcolor=orange shape=parallelogram]
		l3_recv_gpu13_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→0" fillcolor=orange shape=parallelogram]
		l3_recv_gpu14_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→0" fillcolor=orange shape=parallelogram]
		l3_recv_gpu15_to_0 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→0" fillcolor=orange shape=parallelogram]
		l3_local_tokens_gpu0 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l3_expert_agg_gpu0 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l3_final_residual_gpu0 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l3_token_split_gpu1 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l3_send_gpu1_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→0" fillcolor=orange shape=parallelogram]
		l3_send_gpu1_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→2" fillcolor=orange shape=parallelogram]
		l3_send_gpu1_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→3" fillcolor=orange shape=parallelogram]
		l3_send_gpu1_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→4" fillcolor=orange shape=parallelogram]
		l3_send_gpu1_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→5" fillcolor=orange shape=parallelogram]
		l3_send_gpu1_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→6" fillcolor=orange shape=parallelogram]
		l3_send_gpu1_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→7" fillcolor=orange shape=parallelogram]
		l3_send_gpu1_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→8" fillcolor=orange shape=parallelogram]
		l3_send_gpu1_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→9" fillcolor=orange shape=parallelogram]
		l3_send_gpu1_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→10" fillcolor=orange shape=parallelogram]
		l3_send_gpu1_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→11" fillcolor=orange shape=parallelogram]
		l3_send_gpu1_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→12" fillcolor=orange shape=parallelogram]
		l3_send_gpu1_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→13" fillcolor=orange shape=parallelogram]
		l3_send_gpu1_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→14" fillcolor=orange shape=parallelogram]
		l3_send_gpu1_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu0_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→1" fillcolor=orange shape=parallelogram]
		l3_recv_gpu2_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→1" fillcolor=orange shape=parallelogram]
		l3_recv_gpu3_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→1" fillcolor=orange shape=parallelogram]
		l3_recv_gpu4_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→1" fillcolor=orange shape=parallelogram]
		l3_recv_gpu5_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→1" fillcolor=orange shape=parallelogram]
		l3_recv_gpu6_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→1" fillcolor=orange shape=parallelogram]
		l3_recv_gpu7_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→1" fillcolor=orange shape=parallelogram]
		l3_recv_gpu8_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→1" fillcolor=orange shape=parallelogram]
		l3_recv_gpu9_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→1" fillcolor=orange shape=parallelogram]
		l3_recv_gpu10_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→1" fillcolor=orange shape=parallelogram]
		l3_recv_gpu11_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→1" fillcolor=orange shape=parallelogram]
		l3_recv_gpu12_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→1" fillcolor=orange shape=parallelogram]
		l3_recv_gpu13_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→1" fillcolor=orange shape=parallelogram]
		l3_recv_gpu14_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→1" fillcolor=orange shape=parallelogram]
		l3_recv_gpu15_to_1 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→1" fillcolor=orange shape=parallelogram]
		l3_local_tokens_gpu1 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l3_expert_agg_gpu1 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l3_final_residual_gpu1 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l3_token_split_gpu2 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l3_send_gpu2_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→0" fillcolor=orange shape=parallelogram]
		l3_send_gpu2_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→1" fillcolor=orange shape=parallelogram]
		l3_send_gpu2_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→3" fillcolor=orange shape=parallelogram]
		l3_send_gpu2_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→4" fillcolor=orange shape=parallelogram]
		l3_send_gpu2_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→5" fillcolor=orange shape=parallelogram]
		l3_send_gpu2_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→6" fillcolor=orange shape=parallelogram]
		l3_send_gpu2_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→7" fillcolor=orange shape=parallelogram]
		l3_send_gpu2_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→8" fillcolor=orange shape=parallelogram]
		l3_send_gpu2_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→9" fillcolor=orange shape=parallelogram]
		l3_send_gpu2_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→10" fillcolor=orange shape=parallelogram]
		l3_send_gpu2_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→11" fillcolor=orange shape=parallelogram]
		l3_send_gpu2_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→12" fillcolor=orange shape=parallelogram]
		l3_send_gpu2_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→13" fillcolor=orange shape=parallelogram]
		l3_send_gpu2_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→14" fillcolor=orange shape=parallelogram]
		l3_send_gpu2_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu0_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→2" fillcolor=orange shape=parallelogram]
		l3_recv_gpu1_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→2" fillcolor=orange shape=parallelogram]
		l3_recv_gpu3_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→2" fillcolor=orange shape=parallelogram]
		l3_recv_gpu4_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→2" fillcolor=orange shape=parallelogram]
		l3_recv_gpu5_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→2" fillcolor=orange shape=parallelogram]
		l3_recv_gpu6_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→2" fillcolor=orange shape=parallelogram]
		l3_recv_gpu7_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→2" fillcolor=orange shape=parallelogram]
		l3_recv_gpu8_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→2" fillcolor=orange shape=parallelogram]
		l3_recv_gpu9_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→2" fillcolor=orange shape=parallelogram]
		l3_recv_gpu10_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→2" fillcolor=orange shape=parallelogram]
		l3_recv_gpu11_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→2" fillcolor=orange shape=parallelogram]
		l3_recv_gpu12_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→2" fillcolor=orange shape=parallelogram]
		l3_recv_gpu13_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→2" fillcolor=orange shape=parallelogram]
		l3_recv_gpu14_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→2" fillcolor=orange shape=parallelogram]
		l3_recv_gpu15_to_2 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→2" fillcolor=orange shape=parallelogram]
		l3_local_tokens_gpu2 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l3_expert_agg_gpu2 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l3_final_residual_gpu2 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l3_token_split_gpu3 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l3_send_gpu3_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→0" fillcolor=orange shape=parallelogram]
		l3_send_gpu3_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→1" fillcolor=orange shape=parallelogram]
		l3_send_gpu3_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→2" fillcolor=orange shape=parallelogram]
		l3_send_gpu3_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→4" fillcolor=orange shape=parallelogram]
		l3_send_gpu3_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→5" fillcolor=orange shape=parallelogram]
		l3_send_gpu3_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→6" fillcolor=orange shape=parallelogram]
		l3_send_gpu3_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→7" fillcolor=orange shape=parallelogram]
		l3_send_gpu3_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→8" fillcolor=orange shape=parallelogram]
		l3_send_gpu3_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→9" fillcolor=orange shape=parallelogram]
		l3_send_gpu3_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→10" fillcolor=orange shape=parallelogram]
		l3_send_gpu3_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→11" fillcolor=orange shape=parallelogram]
		l3_send_gpu3_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→12" fillcolor=orange shape=parallelogram]
		l3_send_gpu3_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→13" fillcolor=orange shape=parallelogram]
		l3_send_gpu3_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→14" fillcolor=orange shape=parallelogram]
		l3_send_gpu3_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu0_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→3" fillcolor=orange shape=parallelogram]
		l3_recv_gpu1_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→3" fillcolor=orange shape=parallelogram]
		l3_recv_gpu2_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→3" fillcolor=orange shape=parallelogram]
		l3_recv_gpu4_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→3" fillcolor=orange shape=parallelogram]
		l3_recv_gpu5_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→3" fillcolor=orange shape=parallelogram]
		l3_recv_gpu6_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→3" fillcolor=orange shape=parallelogram]
		l3_recv_gpu7_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→3" fillcolor=orange shape=parallelogram]
		l3_recv_gpu8_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→3" fillcolor=orange shape=parallelogram]
		l3_recv_gpu9_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→3" fillcolor=orange shape=parallelogram]
		l3_recv_gpu10_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→3" fillcolor=orange shape=parallelogram]
		l3_recv_gpu11_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→3" fillcolor=orange shape=parallelogram]
		l3_recv_gpu12_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→3" fillcolor=orange shape=parallelogram]
		l3_recv_gpu13_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→3" fillcolor=orange shape=parallelogram]
		l3_recv_gpu14_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→3" fillcolor=orange shape=parallelogram]
		l3_recv_gpu15_to_3 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→3" fillcolor=orange shape=parallelogram]
		l3_local_tokens_gpu3 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l3_expert_agg_gpu3 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l3_final_residual_gpu3 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l3_token_split_gpu4 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l3_send_gpu4_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→0" fillcolor=orange shape=parallelogram]
		l3_send_gpu4_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→1" fillcolor=orange shape=parallelogram]
		l3_send_gpu4_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→2" fillcolor=orange shape=parallelogram]
		l3_send_gpu4_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→3" fillcolor=orange shape=parallelogram]
		l3_send_gpu4_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→5" fillcolor=orange shape=parallelogram]
		l3_send_gpu4_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→6" fillcolor=orange shape=parallelogram]
		l3_send_gpu4_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→7" fillcolor=orange shape=parallelogram]
		l3_send_gpu4_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→8" fillcolor=orange shape=parallelogram]
		l3_send_gpu4_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→9" fillcolor=orange shape=parallelogram]
		l3_send_gpu4_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→10" fillcolor=orange shape=parallelogram]
		l3_send_gpu4_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→11" fillcolor=orange shape=parallelogram]
		l3_send_gpu4_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→12" fillcolor=orange shape=parallelogram]
		l3_send_gpu4_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→13" fillcolor=orange shape=parallelogram]
		l3_send_gpu4_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→14" fillcolor=orange shape=parallelogram]
		l3_send_gpu4_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu0_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→4" fillcolor=orange shape=parallelogram]
		l3_recv_gpu1_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→4" fillcolor=orange shape=parallelogram]
		l3_recv_gpu2_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→4" fillcolor=orange shape=parallelogram]
		l3_recv_gpu3_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→4" fillcolor=orange shape=parallelogram]
		l3_recv_gpu5_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→4" fillcolor=orange shape=parallelogram]
		l3_recv_gpu6_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→4" fillcolor=orange shape=parallelogram]
		l3_recv_gpu7_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→4" fillcolor=orange shape=parallelogram]
		l3_recv_gpu8_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→4" fillcolor=orange shape=parallelogram]
		l3_recv_gpu9_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→4" fillcolor=orange shape=parallelogram]
		l3_recv_gpu10_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→4" fillcolor=orange shape=parallelogram]
		l3_recv_gpu11_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→4" fillcolor=orange shape=parallelogram]
		l3_recv_gpu12_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→4" fillcolor=orange shape=parallelogram]
		l3_recv_gpu13_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→4" fillcolor=orange shape=parallelogram]
		l3_recv_gpu14_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→4" fillcolor=orange shape=parallelogram]
		l3_recv_gpu15_to_4 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→4" fillcolor=orange shape=parallelogram]
		l3_local_tokens_gpu4 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l3_expert_agg_gpu4 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l3_final_residual_gpu4 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l3_token_split_gpu5 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l3_send_gpu5_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→0" fillcolor=orange shape=parallelogram]
		l3_send_gpu5_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→1" fillcolor=orange shape=parallelogram]
		l3_send_gpu5_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→2" fillcolor=orange shape=parallelogram]
		l3_send_gpu5_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→3" fillcolor=orange shape=parallelogram]
		l3_send_gpu5_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→4" fillcolor=orange shape=parallelogram]
		l3_send_gpu5_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→6" fillcolor=orange shape=parallelogram]
		l3_send_gpu5_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→7" fillcolor=orange shape=parallelogram]
		l3_send_gpu5_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→8" fillcolor=orange shape=parallelogram]
		l3_send_gpu5_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→9" fillcolor=orange shape=parallelogram]
		l3_send_gpu5_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→10" fillcolor=orange shape=parallelogram]
		l3_send_gpu5_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→11" fillcolor=orange shape=parallelogram]
		l3_send_gpu5_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→12" fillcolor=orange shape=parallelogram]
		l3_send_gpu5_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→13" fillcolor=orange shape=parallelogram]
		l3_send_gpu5_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→14" fillcolor=orange shape=parallelogram]
		l3_send_gpu5_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu0_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→5" fillcolor=orange shape=parallelogram]
		l3_recv_gpu1_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→5" fillcolor=orange shape=parallelogram]
		l3_recv_gpu2_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→5" fillcolor=orange shape=parallelogram]
		l3_recv_gpu3_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→5" fillcolor=orange shape=parallelogram]
		l3_recv_gpu4_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→5" fillcolor=orange shape=parallelogram]
		l3_recv_gpu6_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→5" fillcolor=orange shape=parallelogram]
		l3_recv_gpu7_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→5" fillcolor=orange shape=parallelogram]
		l3_recv_gpu8_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→5" fillcolor=orange shape=parallelogram]
		l3_recv_gpu9_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→5" fillcolor=orange shape=parallelogram]
		l3_recv_gpu10_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→5" fillcolor=orange shape=parallelogram]
		l3_recv_gpu11_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→5" fillcolor=orange shape=parallelogram]
		l3_recv_gpu12_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→5" fillcolor=orange shape=parallelogram]
		l3_recv_gpu13_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→5" fillcolor=orange shape=parallelogram]
		l3_recv_gpu14_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→5" fillcolor=orange shape=parallelogram]
		l3_recv_gpu15_to_5 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→5" fillcolor=orange shape=parallelogram]
		l3_local_tokens_gpu5 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l3_expert_agg_gpu5 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l3_final_residual_gpu5 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l3_token_split_gpu6 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l3_send_gpu6_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→0" fillcolor=orange shape=parallelogram]
		l3_send_gpu6_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→1" fillcolor=orange shape=parallelogram]
		l3_send_gpu6_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→2" fillcolor=orange shape=parallelogram]
		l3_send_gpu6_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→3" fillcolor=orange shape=parallelogram]
		l3_send_gpu6_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→4" fillcolor=orange shape=parallelogram]
		l3_send_gpu6_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→5" fillcolor=orange shape=parallelogram]
		l3_send_gpu6_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→7" fillcolor=orange shape=parallelogram]
		l3_send_gpu6_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→8" fillcolor=orange shape=parallelogram]
		l3_send_gpu6_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→9" fillcolor=orange shape=parallelogram]
		l3_send_gpu6_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→10" fillcolor=orange shape=parallelogram]
		l3_send_gpu6_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→11" fillcolor=orange shape=parallelogram]
		l3_send_gpu6_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→12" fillcolor=orange shape=parallelogram]
		l3_send_gpu6_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→13" fillcolor=orange shape=parallelogram]
		l3_send_gpu6_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→14" fillcolor=orange shape=parallelogram]
		l3_send_gpu6_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu0_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→6" fillcolor=orange shape=parallelogram]
		l3_recv_gpu1_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→6" fillcolor=orange shape=parallelogram]
		l3_recv_gpu2_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→6" fillcolor=orange shape=parallelogram]
		l3_recv_gpu3_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→6" fillcolor=orange shape=parallelogram]
		l3_recv_gpu4_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→6" fillcolor=orange shape=parallelogram]
		l3_recv_gpu5_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→6" fillcolor=orange shape=parallelogram]
		l3_recv_gpu7_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→6" fillcolor=orange shape=parallelogram]
		l3_recv_gpu8_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→6" fillcolor=orange shape=parallelogram]
		l3_recv_gpu9_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→6" fillcolor=orange shape=parallelogram]
		l3_recv_gpu10_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→6" fillcolor=orange shape=parallelogram]
		l3_recv_gpu11_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→6" fillcolor=orange shape=parallelogram]
		l3_recv_gpu12_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→6" fillcolor=orange shape=parallelogram]
		l3_recv_gpu13_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→6" fillcolor=orange shape=parallelogram]
		l3_recv_gpu14_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→6" fillcolor=orange shape=parallelogram]
		l3_recv_gpu15_to_6 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→6" fillcolor=orange shape=parallelogram]
		l3_local_tokens_gpu6 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l3_expert_agg_gpu6 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l3_final_residual_gpu6 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l3_token_split_gpu7 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l3_send_gpu7_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→0" fillcolor=orange shape=parallelogram]
		l3_send_gpu7_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→1" fillcolor=orange shape=parallelogram]
		l3_send_gpu7_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→2" fillcolor=orange shape=parallelogram]
		l3_send_gpu7_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→3" fillcolor=orange shape=parallelogram]
		l3_send_gpu7_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→4" fillcolor=orange shape=parallelogram]
		l3_send_gpu7_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→5" fillcolor=orange shape=parallelogram]
		l3_send_gpu7_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→6" fillcolor=orange shape=parallelogram]
		l3_send_gpu7_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→8" fillcolor=orange shape=parallelogram]
		l3_send_gpu7_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→9" fillcolor=orange shape=parallelogram]
		l3_send_gpu7_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→10" fillcolor=orange shape=parallelogram]
		l3_send_gpu7_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→11" fillcolor=orange shape=parallelogram]
		l3_send_gpu7_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→12" fillcolor=orange shape=parallelogram]
		l3_send_gpu7_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→13" fillcolor=orange shape=parallelogram]
		l3_send_gpu7_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→14" fillcolor=orange shape=parallelogram]
		l3_send_gpu7_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu0_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→7" fillcolor=orange shape=parallelogram]
		l3_recv_gpu1_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→7" fillcolor=orange shape=parallelogram]
		l3_recv_gpu2_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→7" fillcolor=orange shape=parallelogram]
		l3_recv_gpu3_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→7" fillcolor=orange shape=parallelogram]
		l3_recv_gpu4_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→7" fillcolor=orange shape=parallelogram]
		l3_recv_gpu5_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→7" fillcolor=orange shape=parallelogram]
		l3_recv_gpu6_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→7" fillcolor=orange shape=parallelogram]
		l3_recv_gpu8_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→7" fillcolor=orange shape=parallelogram]
		l3_recv_gpu9_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→7" fillcolor=orange shape=parallelogram]
		l3_recv_gpu10_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→7" fillcolor=orange shape=parallelogram]
		l3_recv_gpu11_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→7" fillcolor=orange shape=parallelogram]
		l3_recv_gpu12_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→7" fillcolor=orange shape=parallelogram]
		l3_recv_gpu13_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→7" fillcolor=orange shape=parallelogram]
		l3_recv_gpu14_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→7" fillcolor=orange shape=parallelogram]
		l3_recv_gpu15_to_7 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→7" fillcolor=orange shape=parallelogram]
		l3_local_tokens_gpu7 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l3_expert_agg_gpu7 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l3_final_residual_gpu7 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l3_token_split_gpu8 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l3_send_gpu8_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→0" fillcolor=orange shape=parallelogram]
		l3_send_gpu8_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→1" fillcolor=orange shape=parallelogram]
		l3_send_gpu8_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→2" fillcolor=orange shape=parallelogram]
		l3_send_gpu8_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→3" fillcolor=orange shape=parallelogram]
		l3_send_gpu8_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→4" fillcolor=orange shape=parallelogram]
		l3_send_gpu8_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→5" fillcolor=orange shape=parallelogram]
		l3_send_gpu8_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→6" fillcolor=orange shape=parallelogram]
		l3_send_gpu8_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→7" fillcolor=orange shape=parallelogram]
		l3_send_gpu8_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→9" fillcolor=orange shape=parallelogram]
		l3_send_gpu8_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→10" fillcolor=orange shape=parallelogram]
		l3_send_gpu8_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→11" fillcolor=orange shape=parallelogram]
		l3_send_gpu8_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→12" fillcolor=orange shape=parallelogram]
		l3_send_gpu8_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→13" fillcolor=orange shape=parallelogram]
		l3_send_gpu8_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→14" fillcolor=orange shape=parallelogram]
		l3_send_gpu8_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu0_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→8" fillcolor=orange shape=parallelogram]
		l3_recv_gpu1_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→8" fillcolor=orange shape=parallelogram]
		l3_recv_gpu2_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→8" fillcolor=orange shape=parallelogram]
		l3_recv_gpu3_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→8" fillcolor=orange shape=parallelogram]
		l3_recv_gpu4_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→8" fillcolor=orange shape=parallelogram]
		l3_recv_gpu5_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→8" fillcolor=orange shape=parallelogram]
		l3_recv_gpu6_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→8" fillcolor=orange shape=parallelogram]
		l3_recv_gpu7_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→8" fillcolor=orange shape=parallelogram]
		l3_recv_gpu9_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→8" fillcolor=orange shape=parallelogram]
		l3_recv_gpu10_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→8" fillcolor=orange shape=parallelogram]
		l3_recv_gpu11_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→8" fillcolor=orange shape=parallelogram]
		l3_recv_gpu12_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→8" fillcolor=orange shape=parallelogram]
		l3_recv_gpu13_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→8" fillcolor=orange shape=parallelogram]
		l3_recv_gpu14_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→8" fillcolor=orange shape=parallelogram]
		l3_recv_gpu15_to_8 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→8" fillcolor=orange shape=parallelogram]
		l3_local_tokens_gpu8 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l3_expert_agg_gpu8 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l3_final_residual_gpu8 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l3_token_split_gpu9 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l3_send_gpu9_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→0" fillcolor=orange shape=parallelogram]
		l3_send_gpu9_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→1" fillcolor=orange shape=parallelogram]
		l3_send_gpu9_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→2" fillcolor=orange shape=parallelogram]
		l3_send_gpu9_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→3" fillcolor=orange shape=parallelogram]
		l3_send_gpu9_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→4" fillcolor=orange shape=parallelogram]
		l3_send_gpu9_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→5" fillcolor=orange shape=parallelogram]
		l3_send_gpu9_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→6" fillcolor=orange shape=parallelogram]
		l3_send_gpu9_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→7" fillcolor=orange shape=parallelogram]
		l3_send_gpu9_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→8" fillcolor=orange shape=parallelogram]
		l3_send_gpu9_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→10" fillcolor=orange shape=parallelogram]
		l3_send_gpu9_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→11" fillcolor=orange shape=parallelogram]
		l3_send_gpu9_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→12" fillcolor=orange shape=parallelogram]
		l3_send_gpu9_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→13" fillcolor=orange shape=parallelogram]
		l3_send_gpu9_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→14" fillcolor=orange shape=parallelogram]
		l3_send_gpu9_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu0_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→9" fillcolor=orange shape=parallelogram]
		l3_recv_gpu1_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→9" fillcolor=orange shape=parallelogram]
		l3_recv_gpu2_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→9" fillcolor=orange shape=parallelogram]
		l3_recv_gpu3_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→9" fillcolor=orange shape=parallelogram]
		l3_recv_gpu4_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→9" fillcolor=orange shape=parallelogram]
		l3_recv_gpu5_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→9" fillcolor=orange shape=parallelogram]
		l3_recv_gpu6_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→9" fillcolor=orange shape=parallelogram]
		l3_recv_gpu7_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→9" fillcolor=orange shape=parallelogram]
		l3_recv_gpu8_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→9" fillcolor=orange shape=parallelogram]
		l3_recv_gpu10_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→9" fillcolor=orange shape=parallelogram]
		l3_recv_gpu11_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→9" fillcolor=orange shape=parallelogram]
		l3_recv_gpu12_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→9" fillcolor=orange shape=parallelogram]
		l3_recv_gpu13_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→9" fillcolor=orange shape=parallelogram]
		l3_recv_gpu14_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→9" fillcolor=orange shape=parallelogram]
		l3_recv_gpu15_to_9 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→9" fillcolor=orange shape=parallelogram]
		l3_local_tokens_gpu9 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l3_expert_agg_gpu9 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l3_final_residual_gpu9 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l3_token_split_gpu10 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l3_send_gpu10_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→0" fillcolor=orange shape=parallelogram]
		l3_send_gpu10_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→1" fillcolor=orange shape=parallelogram]
		l3_send_gpu10_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→2" fillcolor=orange shape=parallelogram]
		l3_send_gpu10_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→3" fillcolor=orange shape=parallelogram]
		l3_send_gpu10_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→4" fillcolor=orange shape=parallelogram]
		l3_send_gpu10_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→5" fillcolor=orange shape=parallelogram]
		l3_send_gpu10_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→6" fillcolor=orange shape=parallelogram]
		l3_send_gpu10_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→7" fillcolor=orange shape=parallelogram]
		l3_send_gpu10_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→8" fillcolor=orange shape=parallelogram]
		l3_send_gpu10_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→9" fillcolor=orange shape=parallelogram]
		l3_send_gpu10_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→11" fillcolor=orange shape=parallelogram]
		l3_send_gpu10_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→12" fillcolor=orange shape=parallelogram]
		l3_send_gpu10_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→13" fillcolor=orange shape=parallelogram]
		l3_send_gpu10_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→14" fillcolor=orange shape=parallelogram]
		l3_send_gpu10_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu0_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→10" fillcolor=orange shape=parallelogram]
		l3_recv_gpu1_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→10" fillcolor=orange shape=parallelogram]
		l3_recv_gpu2_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→10" fillcolor=orange shape=parallelogram]
		l3_recv_gpu3_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→10" fillcolor=orange shape=parallelogram]
		l3_recv_gpu4_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→10" fillcolor=orange shape=parallelogram]
		l3_recv_gpu5_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→10" fillcolor=orange shape=parallelogram]
		l3_recv_gpu6_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→10" fillcolor=orange shape=parallelogram]
		l3_recv_gpu7_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→10" fillcolor=orange shape=parallelogram]
		l3_recv_gpu8_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→10" fillcolor=orange shape=parallelogram]
		l3_recv_gpu9_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→10" fillcolor=orange shape=parallelogram]
		l3_recv_gpu11_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→10" fillcolor=orange shape=parallelogram]
		l3_recv_gpu12_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→10" fillcolor=orange shape=parallelogram]
		l3_recv_gpu13_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→10" fillcolor=orange shape=parallelogram]
		l3_recv_gpu14_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→10" fillcolor=orange shape=parallelogram]
		l3_recv_gpu15_to_10 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→10" fillcolor=orange shape=parallelogram]
		l3_local_tokens_gpu10 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l3_expert_agg_gpu10 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l3_final_residual_gpu10 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l3_token_split_gpu11 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l3_send_gpu11_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→0" fillcolor=orange shape=parallelogram]
		l3_send_gpu11_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→1" fillcolor=orange shape=parallelogram]
		l3_send_gpu11_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→2" fillcolor=orange shape=parallelogram]
		l3_send_gpu11_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→3" fillcolor=orange shape=parallelogram]
		l3_send_gpu11_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→4" fillcolor=orange shape=parallelogram]
		l3_send_gpu11_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→5" fillcolor=orange shape=parallelogram]
		l3_send_gpu11_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→6" fillcolor=orange shape=parallelogram]
		l3_send_gpu11_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→7" fillcolor=orange shape=parallelogram]
		l3_send_gpu11_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→8" fillcolor=orange shape=parallelogram]
		l3_send_gpu11_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→9" fillcolor=orange shape=parallelogram]
		l3_send_gpu11_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→10" fillcolor=orange shape=parallelogram]
		l3_send_gpu11_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→12" fillcolor=orange shape=parallelogram]
		l3_send_gpu11_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→13" fillcolor=orange shape=parallelogram]
		l3_send_gpu11_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→14" fillcolor=orange shape=parallelogram]
		l3_send_gpu11_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu0_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→11" fillcolor=orange shape=parallelogram]
		l3_recv_gpu1_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→11" fillcolor=orange shape=parallelogram]
		l3_recv_gpu2_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→11" fillcolor=orange shape=parallelogram]
		l3_recv_gpu3_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→11" fillcolor=orange shape=parallelogram]
		l3_recv_gpu4_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→11" fillcolor=orange shape=parallelogram]
		l3_recv_gpu5_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→11" fillcolor=orange shape=parallelogram]
		l3_recv_gpu6_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→11" fillcolor=orange shape=parallelogram]
		l3_recv_gpu7_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→11" fillcolor=orange shape=parallelogram]
		l3_recv_gpu8_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→11" fillcolor=orange shape=parallelogram]
		l3_recv_gpu9_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→11" fillcolor=orange shape=parallelogram]
		l3_recv_gpu10_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→11" fillcolor=orange shape=parallelogram]
		l3_recv_gpu12_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→11" fillcolor=orange shape=parallelogram]
		l3_recv_gpu13_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→11" fillcolor=orange shape=parallelogram]
		l3_recv_gpu14_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→11" fillcolor=orange shape=parallelogram]
		l3_recv_gpu15_to_11 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→11" fillcolor=orange shape=parallelogram]
		l3_local_tokens_gpu11 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l3_expert_agg_gpu11 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l3_final_residual_gpu11 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l3_token_split_gpu12 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l3_send_gpu12_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→0" fillcolor=orange shape=parallelogram]
		l3_send_gpu12_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→1" fillcolor=orange shape=parallelogram]
		l3_send_gpu12_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→2" fillcolor=orange shape=parallelogram]
		l3_send_gpu12_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→3" fillcolor=orange shape=parallelogram]
		l3_send_gpu12_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→4" fillcolor=orange shape=parallelogram]
		l3_send_gpu12_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→5" fillcolor=orange shape=parallelogram]
		l3_send_gpu12_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→6" fillcolor=orange shape=parallelogram]
		l3_send_gpu12_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→7" fillcolor=orange shape=parallelogram]
		l3_send_gpu12_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→8" fillcolor=orange shape=parallelogram]
		l3_send_gpu12_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→9" fillcolor=orange shape=parallelogram]
		l3_send_gpu12_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→10" fillcolor=orange shape=parallelogram]
		l3_send_gpu12_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→11" fillcolor=orange shape=parallelogram]
		l3_send_gpu12_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→13" fillcolor=orange shape=parallelogram]
		l3_send_gpu12_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→14" fillcolor=orange shape=parallelogram]
		l3_send_gpu12_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu0_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→12" fillcolor=orange shape=parallelogram]
		l3_recv_gpu1_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→12" fillcolor=orange shape=parallelogram]
		l3_recv_gpu2_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→12" fillcolor=orange shape=parallelogram]
		l3_recv_gpu3_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→12" fillcolor=orange shape=parallelogram]
		l3_recv_gpu4_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→12" fillcolor=orange shape=parallelogram]
		l3_recv_gpu5_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→12" fillcolor=orange shape=parallelogram]
		l3_recv_gpu6_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→12" fillcolor=orange shape=parallelogram]
		l3_recv_gpu7_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→12" fillcolor=orange shape=parallelogram]
		l3_recv_gpu8_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→12" fillcolor=orange shape=parallelogram]
		l3_recv_gpu9_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→12" fillcolor=orange shape=parallelogram]
		l3_recv_gpu10_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→12" fillcolor=orange shape=parallelogram]
		l3_recv_gpu11_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→12" fillcolor=orange shape=parallelogram]
		l3_recv_gpu13_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→12" fillcolor=orange shape=parallelogram]
		l3_recv_gpu14_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→12" fillcolor=orange shape=parallelogram]
		l3_recv_gpu15_to_12 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→12" fillcolor=orange shape=parallelogram]
		l3_local_tokens_gpu12 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l3_expert_agg_gpu12 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l3_final_residual_gpu12 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l3_token_split_gpu13 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l3_send_gpu13_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→0" fillcolor=orange shape=parallelogram]
		l3_send_gpu13_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→1" fillcolor=orange shape=parallelogram]
		l3_send_gpu13_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→2" fillcolor=orange shape=parallelogram]
		l3_send_gpu13_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→3" fillcolor=orange shape=parallelogram]
		l3_send_gpu13_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→4" fillcolor=orange shape=parallelogram]
		l3_send_gpu13_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→5" fillcolor=orange shape=parallelogram]
		l3_send_gpu13_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→6" fillcolor=orange shape=parallelogram]
		l3_send_gpu13_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→7" fillcolor=orange shape=parallelogram]
		l3_send_gpu13_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→8" fillcolor=orange shape=parallelogram]
		l3_send_gpu13_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→9" fillcolor=orange shape=parallelogram]
		l3_send_gpu13_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→10" fillcolor=orange shape=parallelogram]
		l3_send_gpu13_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→11" fillcolor=orange shape=parallelogram]
		l3_send_gpu13_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→12" fillcolor=orange shape=parallelogram]
		l3_send_gpu13_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→14" fillcolor=orange shape=parallelogram]
		l3_send_gpu13_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu0_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→13" fillcolor=orange shape=parallelogram]
		l3_recv_gpu1_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→13" fillcolor=orange shape=parallelogram]
		l3_recv_gpu2_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→13" fillcolor=orange shape=parallelogram]
		l3_recv_gpu3_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→13" fillcolor=orange shape=parallelogram]
		l3_recv_gpu4_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→13" fillcolor=orange shape=parallelogram]
		l3_recv_gpu5_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→13" fillcolor=orange shape=parallelogram]
		l3_recv_gpu6_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→13" fillcolor=orange shape=parallelogram]
		l3_recv_gpu7_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→13" fillcolor=orange shape=parallelogram]
		l3_recv_gpu8_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→13" fillcolor=orange shape=parallelogram]
		l3_recv_gpu9_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→13" fillcolor=orange shape=parallelogram]
		l3_recv_gpu10_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→13" fillcolor=orange shape=parallelogram]
		l3_recv_gpu11_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→13" fillcolor=orange shape=parallelogram]
		l3_recv_gpu12_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→13" fillcolor=orange shape=parallelogram]
		l3_recv_gpu14_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→13" fillcolor=orange shape=parallelogram]
		l3_recv_gpu15_to_13 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→13" fillcolor=orange shape=parallelogram]
		l3_local_tokens_gpu13 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l3_expert_agg_gpu13 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l3_final_residual_gpu13 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l3_token_split_gpu14 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l3_send_gpu14_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→0" fillcolor=orange shape=parallelogram]
		l3_send_gpu14_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→1" fillcolor=orange shape=parallelogram]
		l3_send_gpu14_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→2" fillcolor=orange shape=parallelogram]
		l3_send_gpu14_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→3" fillcolor=orange shape=parallelogram]
		l3_send_gpu14_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→4" fillcolor=orange shape=parallelogram]
		l3_send_gpu14_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→5" fillcolor=orange shape=parallelogram]
		l3_send_gpu14_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→6" fillcolor=orange shape=parallelogram]
		l3_send_gpu14_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→7" fillcolor=orange shape=parallelogram]
		l3_send_gpu14_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→8" fillcolor=orange shape=parallelogram]
		l3_send_gpu14_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→9" fillcolor=orange shape=parallelogram]
		l3_send_gpu14_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→10" fillcolor=orange shape=parallelogram]
		l3_send_gpu14_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→11" fillcolor=orange shape=parallelogram]
		l3_send_gpu14_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→12" fillcolor=orange shape=parallelogram]
		l3_send_gpu14_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→13" fillcolor=orange shape=parallelogram]
		l3_send_gpu14_to_15 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu0_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→14" fillcolor=orange shape=parallelogram]
		l3_recv_gpu1_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→14" fillcolor=orange shape=parallelogram]
		l3_recv_gpu2_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→14" fillcolor=orange shape=parallelogram]
		l3_recv_gpu3_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→14" fillcolor=orange shape=parallelogram]
		l3_recv_gpu4_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→14" fillcolor=orange shape=parallelogram]
		l3_recv_gpu5_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→14" fillcolor=orange shape=parallelogram]
		l3_recv_gpu6_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→14" fillcolor=orange shape=parallelogram]
		l3_recv_gpu7_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→14" fillcolor=orange shape=parallelogram]
		l3_recv_gpu8_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→14" fillcolor=orange shape=parallelogram]
		l3_recv_gpu9_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→14" fillcolor=orange shape=parallelogram]
		l3_recv_gpu10_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→14" fillcolor=orange shape=parallelogram]
		l3_recv_gpu11_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→14" fillcolor=orange shape=parallelogram]
		l3_recv_gpu12_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→14" fillcolor=orange shape=parallelogram]
		l3_recv_gpu13_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→14" fillcolor=orange shape=parallelogram]
		l3_recv_gpu15_to_14 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→14" fillcolor=orange shape=parallelogram]
		l3_local_tokens_gpu14 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l3_expert_agg_gpu14 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l3_final_residual_gpu14 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l3_token_split_gpu15 [label="Token Split\nInput: [1024,10000,8192]\nOutput: [16,tokens_per_expert,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l3_send_gpu15_to_0 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→0" fillcolor=orange shape=parallelogram]
		l3_send_gpu15_to_1 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→1" fillcolor=orange shape=parallelogram]
		l3_send_gpu15_to_2 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→2" fillcolor=orange shape=parallelogram]
		l3_send_gpu15_to_3 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→3" fillcolor=orange shape=parallelogram]
		l3_send_gpu15_to_4 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→4" fillcolor=orange shape=parallelogram]
		l3_send_gpu15_to_5 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→5" fillcolor=orange shape=parallelogram]
		l3_send_gpu15_to_6 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→6" fillcolor=orange shape=parallelogram]
		l3_send_gpu15_to_7 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→7" fillcolor=orange shape=parallelogram]
		l3_send_gpu15_to_8 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→8" fillcolor=orange shape=parallelogram]
		l3_send_gpu15_to_9 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→9" fillcolor=orange shape=parallelogram]
		l3_send_gpu15_to_10 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→10" fillcolor=orange shape=parallelogram]
		l3_send_gpu15_to_11 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→11" fillcolor=orange shape=parallelogram]
		l3_send_gpu15_to_12 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→12" fillcolor=orange shape=parallelogram]
		l3_send_gpu15_to_13 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→13" fillcolor=orange shape=parallelogram]
		l3_send_gpu15_to_14 [label="Send Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15→14" fillcolor=orange shape=parallelogram]
		l3_recv_gpu0_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu1_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu2_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu3_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu4_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu5_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu6_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu7_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu8_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu9_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu10_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu11_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu12_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu13_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13→15" fillcolor=orange shape=parallelogram]
		l3_recv_gpu14_to_15 [label="Receive Tokens\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14→15" fillcolor=orange shape=parallelogram]
		l3_local_tokens_gpu15 [label="Local Token Buffer\nInput: [local_tokens,8192]\nOutput: [local_tokens,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l3_expert_agg_gpu15 [label="Expert Aggregation\nInput: [computed_tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l3_final_residual_gpu15 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
	}
	output [label="Output\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: all GPUs" fillcolor=lightblue shape=ellipse]
	input -> l0_qkv_gpu0
	input -> l0_qkv_gpu1
	input -> l0_qkv_gpu2
	input -> l0_qkv_gpu3
	input -> l0_qkv_gpu4
	input -> l0_qkv_gpu5
	input -> l0_qkv_gpu6
	input -> l0_qkv_gpu7
	input -> l0_qkv_gpu8
	input -> l0_qkv_gpu9
	input -> l0_qkv_gpu10
	input -> l0_qkv_gpu11
	input -> l0_qkv_gpu12
	input -> l0_qkv_gpu13
	input -> l0_qkv_gpu14
	input -> l0_qkv_gpu15
	l0_qkv_gpu0 -> l0_attn_gpu0
	l0_attn_gpu0 -> l0_out_proj_gpu0
	l0_out_proj_gpu0 -> l0_attn_residual_gpu0
	input -> l0_attn_residual_gpu0
	l0_attn_residual_gpu0 -> l0_gate_gpu0
	l0_attn_residual_gpu0 -> l0_token_split_gpu0
	l0_gate_gpu0 -> l0_token_split_gpu0 [style=dashed]
	l0_token_split_gpu0 -> l0_send_gpu0_to_1
	l0_send_gpu0_to_1 -> l0_recv_gpu0_to_1
	l0_recv_gpu0_to_1 -> l0_local_tokens_gpu1
	l0_token_split_gpu0 -> l0_send_gpu0_to_2
	l0_send_gpu0_to_2 -> l0_recv_gpu0_to_2
	l0_recv_gpu0_to_2 -> l0_local_tokens_gpu2
	l0_token_split_gpu0 -> l0_send_gpu0_to_3
	l0_send_gpu0_to_3 -> l0_recv_gpu0_to_3
	l0_recv_gpu0_to_3 -> l0_local_tokens_gpu3
	l0_token_split_gpu0 -> l0_send_gpu0_to_4
	l0_send_gpu0_to_4 -> l0_recv_gpu0_to_4
	l0_recv_gpu0_to_4 -> l0_local_tokens_gpu4
	l0_token_split_gpu0 -> l0_send_gpu0_to_5
	l0_send_gpu0_to_5 -> l0_recv_gpu0_to_5
	l0_recv_gpu0_to_5 -> l0_local_tokens_gpu5
	l0_token_split_gpu0 -> l0_send_gpu0_to_6
	l0_send_gpu0_to_6 -> l0_recv_gpu0_to_6
	l0_recv_gpu0_to_6 -> l0_local_tokens_gpu6
	l0_token_split_gpu0 -> l0_send_gpu0_to_7
	l0_send_gpu0_to_7 -> l0_recv_gpu0_to_7
	l0_recv_gpu0_to_7 -> l0_local_tokens_gpu7
	l0_token_split_gpu0 -> l0_send_gpu0_to_8
	l0_send_gpu0_to_8 -> l0_recv_gpu0_to_8
	l0_recv_gpu0_to_8 -> l0_local_tokens_gpu8
	l0_token_split_gpu0 -> l0_send_gpu0_to_9
	l0_send_gpu0_to_9 -> l0_recv_gpu0_to_9
	l0_recv_gpu0_to_9 -> l0_local_tokens_gpu9
	l0_token_split_gpu0 -> l0_send_gpu0_to_10
	l0_send_gpu0_to_10 -> l0_recv_gpu0_to_10
	l0_recv_gpu0_to_10 -> l0_local_tokens_gpu10
	l0_token_split_gpu0 -> l0_send_gpu0_to_11
	l0_send_gpu0_to_11 -> l0_recv_gpu0_to_11
	l0_recv_gpu0_to_11 -> l0_local_tokens_gpu11
	l0_token_split_gpu0 -> l0_send_gpu0_to_12
	l0_send_gpu0_to_12 -> l0_recv_gpu0_to_12
	l0_recv_gpu0_to_12 -> l0_local_tokens_gpu12
	l0_token_split_gpu0 -> l0_send_gpu0_to_13
	l0_send_gpu0_to_13 -> l0_recv_gpu0_to_13
	l0_recv_gpu0_to_13 -> l0_local_tokens_gpu13
	l0_token_split_gpu0 -> l0_send_gpu0_to_14
	l0_send_gpu0_to_14 -> l0_recv_gpu0_to_14
	l0_recv_gpu0_to_14 -> l0_local_tokens_gpu14
	l0_token_split_gpu0 -> l0_send_gpu0_to_15
	l0_send_gpu0_to_15 -> l0_recv_gpu0_to_15
	l0_recv_gpu0_to_15 -> l0_local_tokens_gpu15
	l0_token_split_gpu0 -> l0_local_tokens_gpu0
	l0_local_tokens_gpu0 -> l0_expert_gpu0
	l0_expert_gpu0 -> l0_expert_agg_gpu0
	l0_expert_gpu1 -> l0_expert_agg_gpu0
	l0_expert_gpu2 -> l0_expert_agg_gpu0
	l0_expert_gpu3 -> l0_expert_agg_gpu0
	l0_expert_gpu4 -> l0_expert_agg_gpu0
	l0_expert_gpu5 -> l0_expert_agg_gpu0
	l0_expert_gpu6 -> l0_expert_agg_gpu0
	l0_expert_gpu7 -> l0_expert_agg_gpu0
	l0_expert_gpu8 -> l0_expert_agg_gpu0
	l0_expert_gpu9 -> l0_expert_agg_gpu0
	l0_expert_gpu10 -> l0_expert_agg_gpu0
	l0_expert_gpu11 -> l0_expert_agg_gpu0
	l0_expert_gpu12 -> l0_expert_agg_gpu0
	l0_expert_gpu13 -> l0_expert_agg_gpu0
	l0_expert_gpu14 -> l0_expert_agg_gpu0
	l0_expert_gpu15 -> l0_expert_agg_gpu0
	l0_attn_residual_gpu0 -> l0_final_residual_gpu0
	l0_expert_agg_gpu0 -> l0_final_residual_gpu0
	l0_qkv_gpu1 -> l0_attn_gpu1
	l0_attn_gpu1 -> l0_out_proj_gpu1
	l0_out_proj_gpu1 -> l0_attn_residual_gpu1
	input -> l0_attn_residual_gpu1
	l0_attn_residual_gpu1 -> l0_gate_gpu1
	l0_attn_residual_gpu1 -> l0_token_split_gpu1
	l0_gate_gpu1 -> l0_token_split_gpu1 [style=dashed]
	l0_token_split_gpu1 -> l0_send_gpu1_to_0
	l0_send_gpu1_to_0 -> l0_recv_gpu1_to_0
	l0_recv_gpu1_to_0 -> l0_local_tokens_gpu0
	l0_token_split_gpu1 -> l0_send_gpu1_to_2
	l0_send_gpu1_to_2 -> l0_recv_gpu1_to_2
	l0_recv_gpu1_to_2 -> l0_local_tokens_gpu2
	l0_token_split_gpu1 -> l0_send_gpu1_to_3
	l0_send_gpu1_to_3 -> l0_recv_gpu1_to_3
	l0_recv_gpu1_to_3 -> l0_local_tokens_gpu3
	l0_token_split_gpu1 -> l0_send_gpu1_to_4
	l0_send_gpu1_to_4 -> l0_recv_gpu1_to_4
	l0_recv_gpu1_to_4 -> l0_local_tokens_gpu4
	l0_token_split_gpu1 -> l0_send_gpu1_to_5
	l0_send_gpu1_to_5 -> l0_recv_gpu1_to_5
	l0_recv_gpu1_to_5 -> l0_local_tokens_gpu5
	l0_token_split_gpu1 -> l0_send_gpu1_to_6
	l0_send_gpu1_to_6 -> l0_recv_gpu1_to_6
	l0_recv_gpu1_to_6 -> l0_local_tokens_gpu6
	l0_token_split_gpu1 -> l0_send_gpu1_to_7
	l0_send_gpu1_to_7 -> l0_recv_gpu1_to_7
	l0_recv_gpu1_to_7 -> l0_local_tokens_gpu7
	l0_token_split_gpu1 -> l0_send_gpu1_to_8
	l0_send_gpu1_to_8 -> l0_recv_gpu1_to_8
	l0_recv_gpu1_to_8 -> l0_local_tokens_gpu8
	l0_token_split_gpu1 -> l0_send_gpu1_to_9
	l0_send_gpu1_to_9 -> l0_recv_gpu1_to_9
	l0_recv_gpu1_to_9 -> l0_local_tokens_gpu9
	l0_token_split_gpu1 -> l0_send_gpu1_to_10
	l0_send_gpu1_to_10 -> l0_recv_gpu1_to_10
	l0_recv_gpu1_to_10 -> l0_local_tokens_gpu10
	l0_token_split_gpu1 -> l0_send_gpu1_to_11
	l0_send_gpu1_to_11 -> l0_recv_gpu1_to_11
	l0_recv_gpu1_to_11 -> l0_local_tokens_gpu11
	l0_token_split_gpu1 -> l0_send_gpu1_to_12
	l0_send_gpu1_to_12 -> l0_recv_gpu1_to_12
	l0_recv_gpu1_to_12 -> l0_local_tokens_gpu12
	l0_token_split_gpu1 -> l0_send_gpu1_to_13
	l0_send_gpu1_to_13 -> l0_recv_gpu1_to_13
	l0_recv_gpu1_to_13 -> l0_local_tokens_gpu13
	l0_token_split_gpu1 -> l0_send_gpu1_to_14
	l0_send_gpu1_to_14 -> l0_recv_gpu1_to_14
	l0_recv_gpu1_to_14 -> l0_local_tokens_gpu14
	l0_token_split_gpu1 -> l0_send_gpu1_to_15
	l0_send_gpu1_to_15 -> l0_recv_gpu1_to_15
	l0_recv_gpu1_to_15 -> l0_local_tokens_gpu15
	l0_token_split_gpu1 -> l0_local_tokens_gpu1
	l0_local_tokens_gpu1 -> l0_expert_gpu1
	l0_expert_gpu0 -> l0_expert_agg_gpu1
	l0_expert_gpu1 -> l0_expert_agg_gpu1
	l0_expert_gpu2 -> l0_expert_agg_gpu1
	l0_expert_gpu3 -> l0_expert_agg_gpu1
	l0_expert_gpu4 -> l0_expert_agg_gpu1
	l0_expert_gpu5 -> l0_expert_agg_gpu1
	l0_expert_gpu6 -> l0_expert_agg_gpu1
	l0_expert_gpu7 -> l0_expert_agg_gpu1
	l0_expert_gpu8 -> l0_expert_agg_gpu1
	l0_expert_gpu9 -> l0_expert_agg_gpu1
	l0_expert_gpu10 -> l0_expert_agg_gpu1
	l0_expert_gpu11 -> l0_expert_agg_gpu1
	l0_expert_gpu12 -> l0_expert_agg_gpu1
	l0_expert_gpu13 -> l0_expert_agg_gpu1
	l0_expert_gpu14 -> l0_expert_agg_gpu1
	l0_expert_gpu15 -> l0_expert_agg_gpu1
	l0_attn_residual_gpu1 -> l0_final_residual_gpu1
	l0_expert_agg_gpu1 -> l0_final_residual_gpu1
	l0_qkv_gpu2 -> l0_attn_gpu2
	l0_attn_gpu2 -> l0_out_proj_gpu2
	l0_out_proj_gpu2 -> l0_attn_residual_gpu2
	input -> l0_attn_residual_gpu2
	l0_attn_residual_gpu2 -> l0_gate_gpu2
	l0_attn_residual_gpu2 -> l0_token_split_gpu2
	l0_gate_gpu2 -> l0_token_split_gpu2 [style=dashed]
	l0_token_split_gpu2 -> l0_send_gpu2_to_0
	l0_send_gpu2_to_0 -> l0_recv_gpu2_to_0
	l0_recv_gpu2_to_0 -> l0_local_tokens_gpu0
	l0_token_split_gpu2 -> l0_send_gpu2_to_1
	l0_send_gpu2_to_1 -> l0_recv_gpu2_to_1
	l0_recv_gpu2_to_1 -> l0_local_tokens_gpu1
	l0_token_split_gpu2 -> l0_send_gpu2_to_3
	l0_send_gpu2_to_3 -> l0_recv_gpu2_to_3
	l0_recv_gpu2_to_3 -> l0_local_tokens_gpu3
	l0_token_split_gpu2 -> l0_send_gpu2_to_4
	l0_send_gpu2_to_4 -> l0_recv_gpu2_to_4
	l0_recv_gpu2_to_4 -> l0_local_tokens_gpu4
	l0_token_split_gpu2 -> l0_send_gpu2_to_5
	l0_send_gpu2_to_5 -> l0_recv_gpu2_to_5
	l0_recv_gpu2_to_5 -> l0_local_tokens_gpu5
	l0_token_split_gpu2 -> l0_send_gpu2_to_6
	l0_send_gpu2_to_6 -> l0_recv_gpu2_to_6
	l0_recv_gpu2_to_6 -> l0_local_tokens_gpu6
	l0_token_split_gpu2 -> l0_send_gpu2_to_7
	l0_send_gpu2_to_7 -> l0_recv_gpu2_to_7
	l0_recv_gpu2_to_7 -> l0_local_tokens_gpu7
	l0_token_split_gpu2 -> l0_send_gpu2_to_8
	l0_send_gpu2_to_8 -> l0_recv_gpu2_to_8
	l0_recv_gpu2_to_8 -> l0_local_tokens_gpu8
	l0_token_split_gpu2 -> l0_send_gpu2_to_9
	l0_send_gpu2_to_9 -> l0_recv_gpu2_to_9
	l0_recv_gpu2_to_9 -> l0_local_tokens_gpu9
	l0_token_split_gpu2 -> l0_send_gpu2_to_10
	l0_send_gpu2_to_10 -> l0_recv_gpu2_to_10
	l0_recv_gpu2_to_10 -> l0_local_tokens_gpu10
	l0_token_split_gpu2 -> l0_send_gpu2_to_11
	l0_send_gpu2_to_11 -> l0_recv_gpu2_to_11
	l0_recv_gpu2_to_11 -> l0_local_tokens_gpu11
	l0_token_split_gpu2 -> l0_send_gpu2_to_12
	l0_send_gpu2_to_12 -> l0_recv_gpu2_to_12
	l0_recv_gpu2_to_12 -> l0_local_tokens_gpu12
	l0_token_split_gpu2 -> l0_send_gpu2_to_13
	l0_send_gpu2_to_13 -> l0_recv_gpu2_to_13
	l0_recv_gpu2_to_13 -> l0_local_tokens_gpu13
	l0_token_split_gpu2 -> l0_send_gpu2_to_14
	l0_send_gpu2_to_14 -> l0_recv_gpu2_to_14
	l0_recv_gpu2_to_14 -> l0_local_tokens_gpu14
	l0_token_split_gpu2 -> l0_send_gpu2_to_15
	l0_send_gpu2_to_15 -> l0_recv_gpu2_to_15
	l0_recv_gpu2_to_15 -> l0_local_tokens_gpu15
	l0_token_split_gpu2 -> l0_local_tokens_gpu2
	l0_local_tokens_gpu2 -> l0_expert_gpu2
	l0_expert_gpu0 -> l0_expert_agg_gpu2
	l0_expert_gpu1 -> l0_expert_agg_gpu2
	l0_expert_gpu2 -> l0_expert_agg_gpu2
	l0_expert_gpu3 -> l0_expert_agg_gpu2
	l0_expert_gpu4 -> l0_expert_agg_gpu2
	l0_expert_gpu5 -> l0_expert_agg_gpu2
	l0_expert_gpu6 -> l0_expert_agg_gpu2
	l0_expert_gpu7 -> l0_expert_agg_gpu2
	l0_expert_gpu8 -> l0_expert_agg_gpu2
	l0_expert_gpu9 -> l0_expert_agg_gpu2
	l0_expert_gpu10 -> l0_expert_agg_gpu2
	l0_expert_gpu11 -> l0_expert_agg_gpu2
	l0_expert_gpu12 -> l0_expert_agg_gpu2
	l0_expert_gpu13 -> l0_expert_agg_gpu2
	l0_expert_gpu14 -> l0_expert_agg_gpu2
	l0_expert_gpu15 -> l0_expert_agg_gpu2
	l0_attn_residual_gpu2 -> l0_final_residual_gpu2
	l0_expert_agg_gpu2 -> l0_final_residual_gpu2
	l0_qkv_gpu3 -> l0_attn_gpu3
	l0_attn_gpu3 -> l0_out_proj_gpu3
	l0_out_proj_gpu3 -> l0_attn_residual_gpu3
	input -> l0_attn_residual_gpu3
	l0_attn_residual_gpu3 -> l0_gate_gpu3
	l0_attn_residual_gpu3 -> l0_token_split_gpu3
	l0_gate_gpu3 -> l0_token_split_gpu3 [style=dashed]
	l0_token_split_gpu3 -> l0_send_gpu3_to_0
	l0_send_gpu3_to_0 -> l0_recv_gpu3_to_0
	l0_recv_gpu3_to_0 -> l0_local_tokens_gpu0
	l0_token_split_gpu3 -> l0_send_gpu3_to_1
	l0_send_gpu3_to_1 -> l0_recv_gpu3_to_1
	l0_recv_gpu3_to_1 -> l0_local_tokens_gpu1
	l0_token_split_gpu3 -> l0_send_gpu3_to_2
	l0_send_gpu3_to_2 -> l0_recv_gpu3_to_2
	l0_recv_gpu3_to_2 -> l0_local_tokens_gpu2
	l0_token_split_gpu3 -> l0_send_gpu3_to_4
	l0_send_gpu3_to_4 -> l0_recv_gpu3_to_4
	l0_recv_gpu3_to_4 -> l0_local_tokens_gpu4
	l0_token_split_gpu3 -> l0_send_gpu3_to_5
	l0_send_gpu3_to_5 -> l0_recv_gpu3_to_5
	l0_recv_gpu3_to_5 -> l0_local_tokens_gpu5
	l0_token_split_gpu3 -> l0_send_gpu3_to_6
	l0_send_gpu3_to_6 -> l0_recv_gpu3_to_6
	l0_recv_gpu3_to_6 -> l0_local_tokens_gpu6
	l0_token_split_gpu3 -> l0_send_gpu3_to_7
	l0_send_gpu3_to_7 -> l0_recv_gpu3_to_7
	l0_recv_gpu3_to_7 -> l0_local_tokens_gpu7
	l0_token_split_gpu3 -> l0_send_gpu3_to_8
	l0_send_gpu3_to_8 -> l0_recv_gpu3_to_8
	l0_recv_gpu3_to_8 -> l0_local_tokens_gpu8
	l0_token_split_gpu3 -> l0_send_gpu3_to_9
	l0_send_gpu3_to_9 -> l0_recv_gpu3_to_9
	l0_recv_gpu3_to_9 -> l0_local_tokens_gpu9
	l0_token_split_gpu3 -> l0_send_gpu3_to_10
	l0_send_gpu3_to_10 -> l0_recv_gpu3_to_10
	l0_recv_gpu3_to_10 -> l0_local_tokens_gpu10
	l0_token_split_gpu3 -> l0_send_gpu3_to_11
	l0_send_gpu3_to_11 -> l0_recv_gpu3_to_11
	l0_recv_gpu3_to_11 -> l0_local_tokens_gpu11
	l0_token_split_gpu3 -> l0_send_gpu3_to_12
	l0_send_gpu3_to_12 -> l0_recv_gpu3_to_12
	l0_recv_gpu3_to_12 -> l0_local_tokens_gpu12
	l0_token_split_gpu3 -> l0_send_gpu3_to_13
	l0_send_gpu3_to_13 -> l0_recv_gpu3_to_13
	l0_recv_gpu3_to_13 -> l0_local_tokens_gpu13
	l0_token_split_gpu3 -> l0_send_gpu3_to_14
	l0_send_gpu3_to_14 -> l0_recv_gpu3_to_14
	l0_recv_gpu3_to_14 -> l0_local_tokens_gpu14
	l0_token_split_gpu3 -> l0_send_gpu3_to_15
	l0_send_gpu3_to_15 -> l0_recv_gpu3_to_15
	l0_recv_gpu3_to_15 -> l0_local_tokens_gpu15
	l0_token_split_gpu3 -> l0_local_tokens_gpu3
	l0_local_tokens_gpu3 -> l0_expert_gpu3
	l0_expert_gpu0 -> l0_expert_agg_gpu3
	l0_expert_gpu1 -> l0_expert_agg_gpu3
	l0_expert_gpu2 -> l0_expert_agg_gpu3
	l0_expert_gpu3 -> l0_expert_agg_gpu3
	l0_expert_gpu4 -> l0_expert_agg_gpu3
	l0_expert_gpu5 -> l0_expert_agg_gpu3
	l0_expert_gpu6 -> l0_expert_agg_gpu3
	l0_expert_gpu7 -> l0_expert_agg_gpu3
	l0_expert_gpu8 -> l0_expert_agg_gpu3
	l0_expert_gpu9 -> l0_expert_agg_gpu3
	l0_expert_gpu10 -> l0_expert_agg_gpu3
	l0_expert_gpu11 -> l0_expert_agg_gpu3
	l0_expert_gpu12 -> l0_expert_agg_gpu3
	l0_expert_gpu13 -> l0_expert_agg_gpu3
	l0_expert_gpu14 -> l0_expert_agg_gpu3
	l0_expert_gpu15 -> l0_expert_agg_gpu3
	l0_attn_residual_gpu3 -> l0_final_residual_gpu3
	l0_expert_agg_gpu3 -> l0_final_residual_gpu3
	l0_qkv_gpu4 -> l0_attn_gpu4
	l0_attn_gpu4 -> l0_out_proj_gpu4
	l0_out_proj_gpu4 -> l0_attn_residual_gpu4
	input -> l0_attn_residual_gpu4
	l0_attn_residual_gpu4 -> l0_gate_gpu4
	l0_attn_residual_gpu4 -> l0_token_split_gpu4
	l0_gate_gpu4 -> l0_token_split_gpu4 [style=dashed]
	l0_token_split_gpu4 -> l0_send_gpu4_to_0
	l0_send_gpu4_to_0 -> l0_recv_gpu4_to_0
	l0_recv_gpu4_to_0 -> l0_local_tokens_gpu0
	l0_token_split_gpu4 -> l0_send_gpu4_to_1
	l0_send_gpu4_to_1 -> l0_recv_gpu4_to_1
	l0_recv_gpu4_to_1 -> l0_local_tokens_gpu1
	l0_token_split_gpu4 -> l0_send_gpu4_to_2
	l0_send_gpu4_to_2 -> l0_recv_gpu4_to_2
	l0_recv_gpu4_to_2 -> l0_local_tokens_gpu2
	l0_token_split_gpu4 -> l0_send_gpu4_to_3
	l0_send_gpu4_to_3 -> l0_recv_gpu4_to_3
	l0_recv_gpu4_to_3 -> l0_local_tokens_gpu3
	l0_token_split_gpu4 -> l0_send_gpu4_to_5
	l0_send_gpu4_to_5 -> l0_recv_gpu4_to_5
	l0_recv_gpu4_to_5 -> l0_local_tokens_gpu5
	l0_token_split_gpu4 -> l0_send_gpu4_to_6
	l0_send_gpu4_to_6 -> l0_recv_gpu4_to_6
	l0_recv_gpu4_to_6 -> l0_local_tokens_gpu6
	l0_token_split_gpu4 -> l0_send_gpu4_to_7
	l0_send_gpu4_to_7 -> l0_recv_gpu4_to_7
	l0_recv_gpu4_to_7 -> l0_local_tokens_gpu7
	l0_token_split_gpu4 -> l0_send_gpu4_to_8
	l0_send_gpu4_to_8 -> l0_recv_gpu4_to_8
	l0_recv_gpu4_to_8 -> l0_local_tokens_gpu8
	l0_token_split_gpu4 -> l0_send_gpu4_to_9
	l0_send_gpu4_to_9 -> l0_recv_gpu4_to_9
	l0_recv_gpu4_to_9 -> l0_local_tokens_gpu9
	l0_token_split_gpu4 -> l0_send_gpu4_to_10
	l0_send_gpu4_to_10 -> l0_recv_gpu4_to_10
	l0_recv_gpu4_to_10 -> l0_local_tokens_gpu10
	l0_token_split_gpu4 -> l0_send_gpu4_to_11
	l0_send_gpu4_to_11 -> l0_recv_gpu4_to_11
	l0_recv_gpu4_to_11 -> l0_local_tokens_gpu11
	l0_token_split_gpu4 -> l0_send_gpu4_to_12
	l0_send_gpu4_to_12 -> l0_recv_gpu4_to_12
	l0_recv_gpu4_to_12 -> l0_local_tokens_gpu12
	l0_token_split_gpu4 -> l0_send_gpu4_to_13
	l0_send_gpu4_to_13 -> l0_recv_gpu4_to_13
	l0_recv_gpu4_to_13 -> l0_local_tokens_gpu13
	l0_token_split_gpu4 -> l0_send_gpu4_to_14
	l0_send_gpu4_to_14 -> l0_recv_gpu4_to_14
	l0_recv_gpu4_to_14 -> l0_local_tokens_gpu14
	l0_token_split_gpu4 -> l0_send_gpu4_to_15
	l0_send_gpu4_to_15 -> l0_recv_gpu4_to_15
	l0_recv_gpu4_to_15 -> l0_local_tokens_gpu15
	l0_token_split_gpu4 -> l0_local_tokens_gpu4
	l0_local_tokens_gpu4 -> l0_expert_gpu4
	l0_expert_gpu0 -> l0_expert_agg_gpu4
	l0_expert_gpu1 -> l0_expert_agg_gpu4
	l0_expert_gpu2 -> l0_expert_agg_gpu4
	l0_expert_gpu3 -> l0_expert_agg_gpu4
	l0_expert_gpu4 -> l0_expert_agg_gpu4
	l0_expert_gpu5 -> l0_expert_agg_gpu4
	l0_expert_gpu6 -> l0_expert_agg_gpu4
	l0_expert_gpu7 -> l0_expert_agg_gpu4
	l0_expert_gpu8 -> l0_expert_agg_gpu4
	l0_expert_gpu9 -> l0_expert_agg_gpu4
	l0_expert_gpu10 -> l0_expert_agg_gpu4
	l0_expert_gpu11 -> l0_expert_agg_gpu4
	l0_expert_gpu12 -> l0_expert_agg_gpu4
	l0_expert_gpu13 -> l0_expert_agg_gpu4
	l0_expert_gpu14 -> l0_expert_agg_gpu4
	l0_expert_gpu15 -> l0_expert_agg_gpu4
	l0_attn_residual_gpu4 -> l0_final_residual_gpu4
	l0_expert_agg_gpu4 -> l0_final_residual_gpu4
	l0_qkv_gpu5 -> l0_attn_gpu5
	l0_attn_gpu5 -> l0_out_proj_gpu5
	l0_out_proj_gpu5 -> l0_attn_residual_gpu5
	input -> l0_attn_residual_gpu5
	l0_attn_residual_gpu5 -> l0_gate_gpu5
	l0_attn_residual_gpu5 -> l0_token_split_gpu5
	l0_gate_gpu5 -> l0_token_split_gpu5 [style=dashed]
	l0_token_split_gpu5 -> l0_send_gpu5_to_0
	l0_send_gpu5_to_0 -> l0_recv_gpu5_to_0
	l0_recv_gpu5_to_0 -> l0_local_tokens_gpu0
	l0_token_split_gpu5 -> l0_send_gpu5_to_1
	l0_send_gpu5_to_1 -> l0_recv_gpu5_to_1
	l0_recv_gpu5_to_1 -> l0_local_tokens_gpu1
	l0_token_split_gpu5 -> l0_send_gpu5_to_2
	l0_send_gpu5_to_2 -> l0_recv_gpu5_to_2
	l0_recv_gpu5_to_2 -> l0_local_tokens_gpu2
	l0_token_split_gpu5 -> l0_send_gpu5_to_3
	l0_send_gpu5_to_3 -> l0_recv_gpu5_to_3
	l0_recv_gpu5_to_3 -> l0_local_tokens_gpu3
	l0_token_split_gpu5 -> l0_send_gpu5_to_4
	l0_send_gpu5_to_4 -> l0_recv_gpu5_to_4
	l0_recv_gpu5_to_4 -> l0_local_tokens_gpu4
	l0_token_split_gpu5 -> l0_send_gpu5_to_6
	l0_send_gpu5_to_6 -> l0_recv_gpu5_to_6
	l0_recv_gpu5_to_6 -> l0_local_tokens_gpu6
	l0_token_split_gpu5 -> l0_send_gpu5_to_7
	l0_send_gpu5_to_7 -> l0_recv_gpu5_to_7
	l0_recv_gpu5_to_7 -> l0_local_tokens_gpu7
	l0_token_split_gpu5 -> l0_send_gpu5_to_8
	l0_send_gpu5_to_8 -> l0_recv_gpu5_to_8
	l0_recv_gpu5_to_8 -> l0_local_tokens_gpu8
	l0_token_split_gpu5 -> l0_send_gpu5_to_9
	l0_send_gpu5_to_9 -> l0_recv_gpu5_to_9
	l0_recv_gpu5_to_9 -> l0_local_tokens_gpu9
	l0_token_split_gpu5 -> l0_send_gpu5_to_10
	l0_send_gpu5_to_10 -> l0_recv_gpu5_to_10
	l0_recv_gpu5_to_10 -> l0_local_tokens_gpu10
	l0_token_split_gpu5 -> l0_send_gpu5_to_11
	l0_send_gpu5_to_11 -> l0_recv_gpu5_to_11
	l0_recv_gpu5_to_11 -> l0_local_tokens_gpu11
	l0_token_split_gpu5 -> l0_send_gpu5_to_12
	l0_send_gpu5_to_12 -> l0_recv_gpu5_to_12
	l0_recv_gpu5_to_12 -> l0_local_tokens_gpu12
	l0_token_split_gpu5 -> l0_send_gpu5_to_13
	l0_send_gpu5_to_13 -> l0_recv_gpu5_to_13
	l0_recv_gpu5_to_13 -> l0_local_tokens_gpu13
	l0_token_split_gpu5 -> l0_send_gpu5_to_14
	l0_send_gpu5_to_14 -> l0_recv_gpu5_to_14
	l0_recv_gpu5_to_14 -> l0_local_tokens_gpu14
	l0_token_split_gpu5 -> l0_send_gpu5_to_15
	l0_send_gpu5_to_15 -> l0_recv_gpu5_to_15
	l0_recv_gpu5_to_15 -> l0_local_tokens_gpu15
	l0_token_split_gpu5 -> l0_local_tokens_gpu5
	l0_local_tokens_gpu5 -> l0_expert_gpu5
	l0_expert_gpu0 -> l0_expert_agg_gpu5
	l0_expert_gpu1 -> l0_expert_agg_gpu5
	l0_expert_gpu2 -> l0_expert_agg_gpu5
	l0_expert_gpu3 -> l0_expert_agg_gpu5
	l0_expert_gpu4 -> l0_expert_agg_gpu5
	l0_expert_gpu5 -> l0_expert_agg_gpu5
	l0_expert_gpu6 -> l0_expert_agg_gpu5
	l0_expert_gpu7 -> l0_expert_agg_gpu5
	l0_expert_gpu8 -> l0_expert_agg_gpu5
	l0_expert_gpu9 -> l0_expert_agg_gpu5
	l0_expert_gpu10 -> l0_expert_agg_gpu5
	l0_expert_gpu11 -> l0_expert_agg_gpu5
	l0_expert_gpu12 -> l0_expert_agg_gpu5
	l0_expert_gpu13 -> l0_expert_agg_gpu5
	l0_expert_gpu14 -> l0_expert_agg_gpu5
	l0_expert_gpu15 -> l0_expert_agg_gpu5
	l0_attn_residual_gpu5 -> l0_final_residual_gpu5
	l0_expert_agg_gpu5 -> l0_final_residual_gpu5
	l0_qkv_gpu6 -> l0_attn_gpu6
	l0_attn_gpu6 -> l0_out_proj_gpu6
	l0_out_proj_gpu6 -> l0_attn_residual_gpu6
	input -> l0_attn_residual_gpu6
	l0_attn_residual_gpu6 -> l0_gate_gpu6
	l0_attn_residual_gpu6 -> l0_token_split_gpu6
	l0_gate_gpu6 -> l0_token_split_gpu6 [style=dashed]
	l0_token_split_gpu6 -> l0_send_gpu6_to_0
	l0_send_gpu6_to_0 -> l0_recv_gpu6_to_0
	l0_recv_gpu6_to_0 -> l0_local_tokens_gpu0
	l0_token_split_gpu6 -> l0_send_gpu6_to_1
	l0_send_gpu6_to_1 -> l0_recv_gpu6_to_1
	l0_recv_gpu6_to_1 -> l0_local_tokens_gpu1
	l0_token_split_gpu6 -> l0_send_gpu6_to_2
	l0_send_gpu6_to_2 -> l0_recv_gpu6_to_2
	l0_recv_gpu6_to_2 -> l0_local_tokens_gpu2
	l0_token_split_gpu6 -> l0_send_gpu6_to_3
	l0_send_gpu6_to_3 -> l0_recv_gpu6_to_3
	l0_recv_gpu6_to_3 -> l0_local_tokens_gpu3
	l0_token_split_gpu6 -> l0_send_gpu6_to_4
	l0_send_gpu6_to_4 -> l0_recv_gpu6_to_4
	l0_recv_gpu6_to_4 -> l0_local_tokens_gpu4
	l0_token_split_gpu6 -> l0_send_gpu6_to_5
	l0_send_gpu6_to_5 -> l0_recv_gpu6_to_5
	l0_recv_gpu6_to_5 -> l0_local_tokens_gpu5
	l0_token_split_gpu6 -> l0_send_gpu6_to_7
	l0_send_gpu6_to_7 -> l0_recv_gpu6_to_7
	l0_recv_gpu6_to_7 -> l0_local_tokens_gpu7
	l0_token_split_gpu6 -> l0_send_gpu6_to_8
	l0_send_gpu6_to_8 -> l0_recv_gpu6_to_8
	l0_recv_gpu6_to_8 -> l0_local_tokens_gpu8
	l0_token_split_gpu6 -> l0_send_gpu6_to_9
	l0_send_gpu6_to_9 -> l0_recv_gpu6_to_9
	l0_recv_gpu6_to_9 -> l0_local_tokens_gpu9
	l0_token_split_gpu6 -> l0_send_gpu6_to_10
	l0_send_gpu6_to_10 -> l0_recv_gpu6_to_10
	l0_recv_gpu6_to_10 -> l0_local_tokens_gpu10
	l0_token_split_gpu6 -> l0_send_gpu6_to_11
	l0_send_gpu6_to_11 -> l0_recv_gpu6_to_11
	l0_recv_gpu6_to_11 -> l0_local_tokens_gpu11
	l0_token_split_gpu6 -> l0_send_gpu6_to_12
	l0_send_gpu6_to_12 -> l0_recv_gpu6_to_12
	l0_recv_gpu6_to_12 -> l0_local_tokens_gpu12
	l0_token_split_gpu6 -> l0_send_gpu6_to_13
	l0_send_gpu6_to_13 -> l0_recv_gpu6_to_13
	l0_recv_gpu6_to_13 -> l0_local_tokens_gpu13
	l0_token_split_gpu6 -> l0_send_gpu6_to_14
	l0_send_gpu6_to_14 -> l0_recv_gpu6_to_14
	l0_recv_gpu6_to_14 -> l0_local_tokens_gpu14
	l0_token_split_gpu6 -> l0_send_gpu6_to_15
	l0_send_gpu6_to_15 -> l0_recv_gpu6_to_15
	l0_recv_gpu6_to_15 -> l0_local_tokens_gpu15
	l0_token_split_gpu6 -> l0_local_tokens_gpu6
	l0_local_tokens_gpu6 -> l0_expert_gpu6
	l0_expert_gpu0 -> l0_expert_agg_gpu6
	l0_expert_gpu1 -> l0_expert_agg_gpu6
	l0_expert_gpu2 -> l0_expert_agg_gpu6
	l0_expert_gpu3 -> l0_expert_agg_gpu6
	l0_expert_gpu4 -> l0_expert_agg_gpu6
	l0_expert_gpu5 -> l0_expert_agg_gpu6
	l0_expert_gpu6 -> l0_expert_agg_gpu6
	l0_expert_gpu7 -> l0_expert_agg_gpu6
	l0_expert_gpu8 -> l0_expert_agg_gpu6
	l0_expert_gpu9 -> l0_expert_agg_gpu6
	l0_expert_gpu10 -> l0_expert_agg_gpu6
	l0_expert_gpu11 -> l0_expert_agg_gpu6
	l0_expert_gpu12 -> l0_expert_agg_gpu6
	l0_expert_gpu13 -> l0_expert_agg_gpu6
	l0_expert_gpu14 -> l0_expert_agg_gpu6
	l0_expert_gpu15 -> l0_expert_agg_gpu6
	l0_attn_residual_gpu6 -> l0_final_residual_gpu6
	l0_expert_agg_gpu6 -> l0_final_residual_gpu6
	l0_qkv_gpu7 -> l0_attn_gpu7
	l0_attn_gpu7 -> l0_out_proj_gpu7
	l0_out_proj_gpu7 -> l0_attn_residual_gpu7
	input -> l0_attn_residual_gpu7
	l0_attn_residual_gpu7 -> l0_gate_gpu7
	l0_attn_residual_gpu7 -> l0_token_split_gpu7
	l0_gate_gpu7 -> l0_token_split_gpu7 [style=dashed]
	l0_token_split_gpu7 -> l0_send_gpu7_to_0
	l0_send_gpu7_to_0 -> l0_recv_gpu7_to_0
	l0_recv_gpu7_to_0 -> l0_local_tokens_gpu0
	l0_token_split_gpu7 -> l0_send_gpu7_to_1
	l0_send_gpu7_to_1 -> l0_recv_gpu7_to_1
	l0_recv_gpu7_to_1 -> l0_local_tokens_gpu1
	l0_token_split_gpu7 -> l0_send_gpu7_to_2
	l0_send_gpu7_to_2 -> l0_recv_gpu7_to_2
	l0_recv_gpu7_to_2 -> l0_local_tokens_gpu2
	l0_token_split_gpu7 -> l0_send_gpu7_to_3
	l0_send_gpu7_to_3 -> l0_recv_gpu7_to_3
	l0_recv_gpu7_to_3 -> l0_local_tokens_gpu3
	l0_token_split_gpu7 -> l0_send_gpu7_to_4
	l0_send_gpu7_to_4 -> l0_recv_gpu7_to_4
	l0_recv_gpu7_to_4 -> l0_local_tokens_gpu4
	l0_token_split_gpu7 -> l0_send_gpu7_to_5
	l0_send_gpu7_to_5 -> l0_recv_gpu7_to_5
	l0_recv_gpu7_to_5 -> l0_local_tokens_gpu5
	l0_token_split_gpu7 -> l0_send_gpu7_to_6
	l0_send_gpu7_to_6 -> l0_recv_gpu7_to_6
	l0_recv_gpu7_to_6 -> l0_local_tokens_gpu6
	l0_token_split_gpu7 -> l0_send_gpu7_to_8
	l0_send_gpu7_to_8 -> l0_recv_gpu7_to_8
	l0_recv_gpu7_to_8 -> l0_local_tokens_gpu8
	l0_token_split_gpu7 -> l0_send_gpu7_to_9
	l0_send_gpu7_to_9 -> l0_recv_gpu7_to_9
	l0_recv_gpu7_to_9 -> l0_local_tokens_gpu9
	l0_token_split_gpu7 -> l0_send_gpu7_to_10
	l0_send_gpu7_to_10 -> l0_recv_gpu7_to_10
	l0_recv_gpu7_to_10 -> l0_local_tokens_gpu10
	l0_token_split_gpu7 -> l0_send_gpu7_to_11
	l0_send_gpu7_to_11 -> l0_recv_gpu7_to_11
	l0_recv_gpu7_to_11 -> l0_local_tokens_gpu11
	l0_token_split_gpu7 -> l0_send_gpu7_to_12
	l0_send_gpu7_to_12 -> l0_recv_gpu7_to_12
	l0_recv_gpu7_to_12 -> l0_local_tokens_gpu12
	l0_token_split_gpu7 -> l0_send_gpu7_to_13
	l0_send_gpu7_to_13 -> l0_recv_gpu7_to_13
	l0_recv_gpu7_to_13 -> l0_local_tokens_gpu13
	l0_token_split_gpu7 -> l0_send_gpu7_to_14
	l0_send_gpu7_to_14 -> l0_recv_gpu7_to_14
	l0_recv_gpu7_to_14 -> l0_local_tokens_gpu14
	l0_token_split_gpu7 -> l0_send_gpu7_to_15
	l0_send_gpu7_to_15 -> l0_recv_gpu7_to_15
	l0_recv_gpu7_to_15 -> l0_local_tokens_gpu15
	l0_token_split_gpu7 -> l0_local_tokens_gpu7
	l0_local_tokens_gpu7 -> l0_expert_gpu7
	l0_expert_gpu0 -> l0_expert_agg_gpu7
	l0_expert_gpu1 -> l0_expert_agg_gpu7
	l0_expert_gpu2 -> l0_expert_agg_gpu7
	l0_expert_gpu3 -> l0_expert_agg_gpu7
	l0_expert_gpu4 -> l0_expert_agg_gpu7
	l0_expert_gpu5 -> l0_expert_agg_gpu7
	l0_expert_gpu6 -> l0_expert_agg_gpu7
	l0_expert_gpu7 -> l0_expert_agg_gpu7
	l0_expert_gpu8 -> l0_expert_agg_gpu7
	l0_expert_gpu9 -> l0_expert_agg_gpu7
	l0_expert_gpu10 -> l0_expert_agg_gpu7
	l0_expert_gpu11 -> l0_expert_agg_gpu7
	l0_expert_gpu12 -> l0_expert_agg_gpu7
	l0_expert_gpu13 -> l0_expert_agg_gpu7
	l0_expert_gpu14 -> l0_expert_agg_gpu7
	l0_expert_gpu15 -> l0_expert_agg_gpu7
	l0_attn_residual_gpu7 -> l0_final_residual_gpu7
	l0_expert_agg_gpu7 -> l0_final_residual_gpu7
	l0_qkv_gpu8 -> l0_attn_gpu8
	l0_attn_gpu8 -> l0_out_proj_gpu8
	l0_out_proj_gpu8 -> l0_attn_residual_gpu8
	input -> l0_attn_residual_gpu8
	l0_attn_residual_gpu8 -> l0_gate_gpu8
	l0_attn_residual_gpu8 -> l0_token_split_gpu8
	l0_gate_gpu8 -> l0_token_split_gpu8 [style=dashed]
	l0_token_split_gpu8 -> l0_send_gpu8_to_0
	l0_send_gpu8_to_0 -> l0_recv_gpu8_to_0
	l0_recv_gpu8_to_0 -> l0_local_tokens_gpu0
	l0_token_split_gpu8 -> l0_send_gpu8_to_1
	l0_send_gpu8_to_1 -> l0_recv_gpu8_to_1
	l0_recv_gpu8_to_1 -> l0_local_tokens_gpu1
	l0_token_split_gpu8 -> l0_send_gpu8_to_2
	l0_send_gpu8_to_2 -> l0_recv_gpu8_to_2
	l0_recv_gpu8_to_2 -> l0_local_tokens_gpu2
	l0_token_split_gpu8 -> l0_send_gpu8_to_3
	l0_send_gpu8_to_3 -> l0_recv_gpu8_to_3
	l0_recv_gpu8_to_3 -> l0_local_tokens_gpu3
	l0_token_split_gpu8 -> l0_send_gpu8_to_4
	l0_send_gpu8_to_4 -> l0_recv_gpu8_to_4
	l0_recv_gpu8_to_4 -> l0_local_tokens_gpu4
	l0_token_split_gpu8 -> l0_send_gpu8_to_5
	l0_send_gpu8_to_5 -> l0_recv_gpu8_to_5
	l0_recv_gpu8_to_5 -> l0_local_tokens_gpu5
	l0_token_split_gpu8 -> l0_send_gpu8_to_6
	l0_send_gpu8_to_6 -> l0_recv_gpu8_to_6
	l0_recv_gpu8_to_6 -> l0_local_tokens_gpu6
	l0_token_split_gpu8 -> l0_send_gpu8_to_7
	l0_send_gpu8_to_7 -> l0_recv_gpu8_to_7
	l0_recv_gpu8_to_7 -> l0_local_tokens_gpu7
	l0_token_split_gpu8 -> l0_send_gpu8_to_9
	l0_send_gpu8_to_9 -> l0_recv_gpu8_to_9
	l0_recv_gpu8_to_9 -> l0_local_tokens_gpu9
	l0_token_split_gpu8 -> l0_send_gpu8_to_10
	l0_send_gpu8_to_10 -> l0_recv_gpu8_to_10
	l0_recv_gpu8_to_10 -> l0_local_tokens_gpu10
	l0_token_split_gpu8 -> l0_send_gpu8_to_11
	l0_send_gpu8_to_11 -> l0_recv_gpu8_to_11
	l0_recv_gpu8_to_11 -> l0_local_tokens_gpu11
	l0_token_split_gpu8 -> l0_send_gpu8_to_12
	l0_send_gpu8_to_12 -> l0_recv_gpu8_to_12
	l0_recv_gpu8_to_12 -> l0_local_tokens_gpu12
	l0_token_split_gpu8 -> l0_send_gpu8_to_13
	l0_send_gpu8_to_13 -> l0_recv_gpu8_to_13
	l0_recv_gpu8_to_13 -> l0_local_tokens_gpu13
	l0_token_split_gpu8 -> l0_send_gpu8_to_14
	l0_send_gpu8_to_14 -> l0_recv_gpu8_to_14
	l0_recv_gpu8_to_14 -> l0_local_tokens_gpu14
	l0_token_split_gpu8 -> l0_send_gpu8_to_15
	l0_send_gpu8_to_15 -> l0_recv_gpu8_to_15
	l0_recv_gpu8_to_15 -> l0_local_tokens_gpu15
	l0_token_split_gpu8 -> l0_local_tokens_gpu8
	l0_local_tokens_gpu8 -> l0_expert_gpu8
	l0_expert_gpu0 -> l0_expert_agg_gpu8
	l0_expert_gpu1 -> l0_expert_agg_gpu8
	l0_expert_gpu2 -> l0_expert_agg_gpu8
	l0_expert_gpu3 -> l0_expert_agg_gpu8
	l0_expert_gpu4 -> l0_expert_agg_gpu8
	l0_expert_gpu5 -> l0_expert_agg_gpu8
	l0_expert_gpu6 -> l0_expert_agg_gpu8
	l0_expert_gpu7 -> l0_expert_agg_gpu8
	l0_expert_gpu8 -> l0_expert_agg_gpu8
	l0_expert_gpu9 -> l0_expert_agg_gpu8
	l0_expert_gpu10 -> l0_expert_agg_gpu8
	l0_expert_gpu11 -> l0_expert_agg_gpu8
	l0_expert_gpu12 -> l0_expert_agg_gpu8
	l0_expert_gpu13 -> l0_expert_agg_gpu8
	l0_expert_gpu14 -> l0_expert_agg_gpu8
	l0_expert_gpu15 -> l0_expert_agg_gpu8
	l0_attn_residual_gpu8 -> l0_final_residual_gpu8
	l0_expert_agg_gpu8 -> l0_final_residual_gpu8
	l0_qkv_gpu9 -> l0_attn_gpu9
	l0_attn_gpu9 -> l0_out_proj_gpu9
	l0_out_proj_gpu9 -> l0_attn_residual_gpu9
	input -> l0_attn_residual_gpu9
	l0_attn_residual_gpu9 -> l0_gate_gpu9
	l0_attn_residual_gpu9 -> l0_token_split_gpu9
	l0_gate_gpu9 -> l0_token_split_gpu9 [style=dashed]
	l0_token_split_gpu9 -> l0_send_gpu9_to_0
	l0_send_gpu9_to_0 -> l0_recv_gpu9_to_0
	l0_recv_gpu9_to_0 -> l0_local_tokens_gpu0
	l0_token_split_gpu9 -> l0_send_gpu9_to_1
	l0_send_gpu9_to_1 -> l0_recv_gpu9_to_1
	l0_recv_gpu9_to_1 -> l0_local_tokens_gpu1
	l0_token_split_gpu9 -> l0_send_gpu9_to_2
	l0_send_gpu9_to_2 -> l0_recv_gpu9_to_2
	l0_recv_gpu9_to_2 -> l0_local_tokens_gpu2
	l0_token_split_gpu9 -> l0_send_gpu9_to_3
	l0_send_gpu9_to_3 -> l0_recv_gpu9_to_3
	l0_recv_gpu9_to_3 -> l0_local_tokens_gpu3
	l0_token_split_gpu9 -> l0_send_gpu9_to_4
	l0_send_gpu9_to_4 -> l0_recv_gpu9_to_4
	l0_recv_gpu9_to_4 -> l0_local_tokens_gpu4
	l0_token_split_gpu9 -> l0_send_gpu9_to_5
	l0_send_gpu9_to_5 -> l0_recv_gpu9_to_5
	l0_recv_gpu9_to_5 -> l0_local_tokens_gpu5
	l0_token_split_gpu9 -> l0_send_gpu9_to_6
	l0_send_gpu9_to_6 -> l0_recv_gpu9_to_6
	l0_recv_gpu9_to_6 -> l0_local_tokens_gpu6
	l0_token_split_gpu9 -> l0_send_gpu9_to_7
	l0_send_gpu9_to_7 -> l0_recv_gpu9_to_7
	l0_recv_gpu9_to_7 -> l0_local_tokens_gpu7
	l0_token_split_gpu9 -> l0_send_gpu9_to_8
	l0_send_gpu9_to_8 -> l0_recv_gpu9_to_8
	l0_recv_gpu9_to_8 -> l0_local_tokens_gpu8
	l0_token_split_gpu9 -> l0_send_gpu9_to_10
	l0_send_gpu9_to_10 -> l0_recv_gpu9_to_10
	l0_recv_gpu9_to_10 -> l0_local_tokens_gpu10
	l0_token_split_gpu9 -> l0_send_gpu9_to_11
	l0_send_gpu9_to_11 -> l0_recv_gpu9_to_11
	l0_recv_gpu9_to_11 -> l0_local_tokens_gpu11
	l0_token_split_gpu9 -> l0_send_gpu9_to_12
	l0_send_gpu9_to_12 -> l0_recv_gpu9_to_12
	l0_recv_gpu9_to_12 -> l0_local_tokens_gpu12
	l0_token_split_gpu9 -> l0_send_gpu9_to_13
	l0_send_gpu9_to_13 -> l0_recv_gpu9_to_13
	l0_recv_gpu9_to_13 -> l0_local_tokens_gpu13
	l0_token_split_gpu9 -> l0_send_gpu9_to_14
	l0_send_gpu9_to_14 -> l0_recv_gpu9_to_14
	l0_recv_gpu9_to_14 -> l0_local_tokens_gpu14
	l0_token_split_gpu9 -> l0_send_gpu9_to_15
	l0_send_gpu9_to_15 -> l0_recv_gpu9_to_15
	l0_recv_gpu9_to_15 -> l0_local_tokens_gpu15
	l0_token_split_gpu9 -> l0_local_tokens_gpu9
	l0_local_tokens_gpu9 -> l0_expert_gpu9
	l0_expert_gpu0 -> l0_expert_agg_gpu9
	l0_expert_gpu1 -> l0_expert_agg_gpu9
	l0_expert_gpu2 -> l0_expert_agg_gpu9
	l0_expert_gpu3 -> l0_expert_agg_gpu9
	l0_expert_gpu4 -> l0_expert_agg_gpu9
	l0_expert_gpu5 -> l0_expert_agg_gpu9
	l0_expert_gpu6 -> l0_expert_agg_gpu9
	l0_expert_gpu7 -> l0_expert_agg_gpu9
	l0_expert_gpu8 -> l0_expert_agg_gpu9
	l0_expert_gpu9 -> l0_expert_agg_gpu9
	l0_expert_gpu10 -> l0_expert_agg_gpu9
	l0_expert_gpu11 -> l0_expert_agg_gpu9
	l0_expert_gpu12 -> l0_expert_agg_gpu9
	l0_expert_gpu13 -> l0_expert_agg_gpu9
	l0_expert_gpu14 -> l0_expert_agg_gpu9
	l0_expert_gpu15 -> l0_expert_agg_gpu9
	l0_attn_residual_gpu9 -> l0_final_residual_gpu9
	l0_expert_agg_gpu9 -> l0_final_residual_gpu9
	l0_qkv_gpu10 -> l0_attn_gpu10
	l0_attn_gpu10 -> l0_out_proj_gpu10
	l0_out_proj_gpu10 -> l0_attn_residual_gpu10
	input -> l0_attn_residual_gpu10
	l0_attn_residual_gpu10 -> l0_gate_gpu10
	l0_attn_residual_gpu10 -> l0_token_split_gpu10
	l0_gate_gpu10 -> l0_token_split_gpu10 [style=dashed]
	l0_token_split_gpu10 -> l0_send_gpu10_to_0
	l0_send_gpu10_to_0 -> l0_recv_gpu10_to_0
	l0_recv_gpu10_to_0 -> l0_local_tokens_gpu0
	l0_token_split_gpu10 -> l0_send_gpu10_to_1
	l0_send_gpu10_to_1 -> l0_recv_gpu10_to_1
	l0_recv_gpu10_to_1 -> l0_local_tokens_gpu1
	l0_token_split_gpu10 -> l0_send_gpu10_to_2
	l0_send_gpu10_to_2 -> l0_recv_gpu10_to_2
	l0_recv_gpu10_to_2 -> l0_local_tokens_gpu2
	l0_token_split_gpu10 -> l0_send_gpu10_to_3
	l0_send_gpu10_to_3 -> l0_recv_gpu10_to_3
	l0_recv_gpu10_to_3 -> l0_local_tokens_gpu3
	l0_token_split_gpu10 -> l0_send_gpu10_to_4
	l0_send_gpu10_to_4 -> l0_recv_gpu10_to_4
	l0_recv_gpu10_to_4 -> l0_local_tokens_gpu4
	l0_token_split_gpu10 -> l0_send_gpu10_to_5
	l0_send_gpu10_to_5 -> l0_recv_gpu10_to_5
	l0_recv_gpu10_to_5 -> l0_local_tokens_gpu5
	l0_token_split_gpu10 -> l0_send_gpu10_to_6
	l0_send_gpu10_to_6 -> l0_recv_gpu10_to_6
	l0_recv_gpu10_to_6 -> l0_local_tokens_gpu6
	l0_token_split_gpu10 -> l0_send_gpu10_to_7
	l0_send_gpu10_to_7 -> l0_recv_gpu10_to_7
	l0_recv_gpu10_to_7 -> l0_local_tokens_gpu7
	l0_token_split_gpu10 -> l0_send_gpu10_to_8
	l0_send_gpu10_to_8 -> l0_recv_gpu10_to_8
	l0_recv_gpu10_to_8 -> l0_local_tokens_gpu8
	l0_token_split_gpu10 -> l0_send_gpu10_to_9
	l0_send_gpu10_to_9 -> l0_recv_gpu10_to_9
	l0_recv_gpu10_to_9 -> l0_local_tokens_gpu9
	l0_token_split_gpu10 -> l0_send_gpu10_to_11
	l0_send_gpu10_to_11 -> l0_recv_gpu10_to_11
	l0_recv_gpu10_to_11 -> l0_local_tokens_gpu11
	l0_token_split_gpu10 -> l0_send_gpu10_to_12
	l0_send_gpu10_to_12 -> l0_recv_gpu10_to_12
	l0_recv_gpu10_to_12 -> l0_local_tokens_gpu12
	l0_token_split_gpu10 -> l0_send_gpu10_to_13
	l0_send_gpu10_to_13 -> l0_recv_gpu10_to_13
	l0_recv_gpu10_to_13 -> l0_local_tokens_gpu13
	l0_token_split_gpu10 -> l0_send_gpu10_to_14
	l0_send_gpu10_to_14 -> l0_recv_gpu10_to_14
	l0_recv_gpu10_to_14 -> l0_local_tokens_gpu14
	l0_token_split_gpu10 -> l0_send_gpu10_to_15
	l0_send_gpu10_to_15 -> l0_recv_gpu10_to_15
	l0_recv_gpu10_to_15 -> l0_local_tokens_gpu15
	l0_token_split_gpu10 -> l0_local_tokens_gpu10
	l0_local_tokens_gpu10 -> l0_expert_gpu10
	l0_expert_gpu0 -> l0_expert_agg_gpu10
	l0_expert_gpu1 -> l0_expert_agg_gpu10
	l0_expert_gpu2 -> l0_expert_agg_gpu10
	l0_expert_gpu3 -> l0_expert_agg_gpu10
	l0_expert_gpu4 -> l0_expert_agg_gpu10
	l0_expert_gpu5 -> l0_expert_agg_gpu10
	l0_expert_gpu6 -> l0_expert_agg_gpu10
	l0_expert_gpu7 -> l0_expert_agg_gpu10
	l0_expert_gpu8 -> l0_expert_agg_gpu10
	l0_expert_gpu9 -> l0_expert_agg_gpu10
	l0_expert_gpu10 -> l0_expert_agg_gpu10
	l0_expert_gpu11 -> l0_expert_agg_gpu10
	l0_expert_gpu12 -> l0_expert_agg_gpu10
	l0_expert_gpu13 -> l0_expert_agg_gpu10
	l0_expert_gpu14 -> l0_expert_agg_gpu10
	l0_expert_gpu15 -> l0_expert_agg_gpu10
	l0_attn_residual_gpu10 -> l0_final_residual_gpu10
	l0_expert_agg_gpu10 -> l0_final_residual_gpu10
	l0_qkv_gpu11 -> l0_attn_gpu11
	l0_attn_gpu11 -> l0_out_proj_gpu11
	l0_out_proj_gpu11 -> l0_attn_residual_gpu11
	input -> l0_attn_residual_gpu11
	l0_attn_residual_gpu11 -> l0_gate_gpu11
	l0_attn_residual_gpu11 -> l0_token_split_gpu11
	l0_gate_gpu11 -> l0_token_split_gpu11 [style=dashed]
	l0_token_split_gpu11 -> l0_send_gpu11_to_0
	l0_send_gpu11_to_0 -> l0_recv_gpu11_to_0
	l0_recv_gpu11_to_0 -> l0_local_tokens_gpu0
	l0_token_split_gpu11 -> l0_send_gpu11_to_1
	l0_send_gpu11_to_1 -> l0_recv_gpu11_to_1
	l0_recv_gpu11_to_1 -> l0_local_tokens_gpu1
	l0_token_split_gpu11 -> l0_send_gpu11_to_2
	l0_send_gpu11_to_2 -> l0_recv_gpu11_to_2
	l0_recv_gpu11_to_2 -> l0_local_tokens_gpu2
	l0_token_split_gpu11 -> l0_send_gpu11_to_3
	l0_send_gpu11_to_3 -> l0_recv_gpu11_to_3
	l0_recv_gpu11_to_3 -> l0_local_tokens_gpu3
	l0_token_split_gpu11 -> l0_send_gpu11_to_4
	l0_send_gpu11_to_4 -> l0_recv_gpu11_to_4
	l0_recv_gpu11_to_4 -> l0_local_tokens_gpu4
	l0_token_split_gpu11 -> l0_send_gpu11_to_5
	l0_send_gpu11_to_5 -> l0_recv_gpu11_to_5
	l0_recv_gpu11_to_5 -> l0_local_tokens_gpu5
	l0_token_split_gpu11 -> l0_send_gpu11_to_6
	l0_send_gpu11_to_6 -> l0_recv_gpu11_to_6
	l0_recv_gpu11_to_6 -> l0_local_tokens_gpu6
	l0_token_split_gpu11 -> l0_send_gpu11_to_7
	l0_send_gpu11_to_7 -> l0_recv_gpu11_to_7
	l0_recv_gpu11_to_7 -> l0_local_tokens_gpu7
	l0_token_split_gpu11 -> l0_send_gpu11_to_8
	l0_send_gpu11_to_8 -> l0_recv_gpu11_to_8
	l0_recv_gpu11_to_8 -> l0_local_tokens_gpu8
	l0_token_split_gpu11 -> l0_send_gpu11_to_9
	l0_send_gpu11_to_9 -> l0_recv_gpu11_to_9
	l0_recv_gpu11_to_9 -> l0_local_tokens_gpu9
	l0_token_split_gpu11 -> l0_send_gpu11_to_10
	l0_send_gpu11_to_10 -> l0_recv_gpu11_to_10
	l0_recv_gpu11_to_10 -> l0_local_tokens_gpu10
	l0_token_split_gpu11 -> l0_send_gpu11_to_12
	l0_send_gpu11_to_12 -> l0_recv_gpu11_to_12
	l0_recv_gpu11_to_12 -> l0_local_tokens_gpu12
	l0_token_split_gpu11 -> l0_send_gpu11_to_13
	l0_send_gpu11_to_13 -> l0_recv_gpu11_to_13
	l0_recv_gpu11_to_13 -> l0_local_tokens_gpu13
	l0_token_split_gpu11 -> l0_send_gpu11_to_14
	l0_send_gpu11_to_14 -> l0_recv_gpu11_to_14
	l0_recv_gpu11_to_14 -> l0_local_tokens_gpu14
	l0_token_split_gpu11 -> l0_send_gpu11_to_15
	l0_send_gpu11_to_15 -> l0_recv_gpu11_to_15
	l0_recv_gpu11_to_15 -> l0_local_tokens_gpu15
	l0_token_split_gpu11 -> l0_local_tokens_gpu11
	l0_local_tokens_gpu11 -> l0_expert_gpu11
	l0_expert_gpu0 -> l0_expert_agg_gpu11
	l0_expert_gpu1 -> l0_expert_agg_gpu11
	l0_expert_gpu2 -> l0_expert_agg_gpu11
	l0_expert_gpu3 -> l0_expert_agg_gpu11
	l0_expert_gpu4 -> l0_expert_agg_gpu11
	l0_expert_gpu5 -> l0_expert_agg_gpu11
	l0_expert_gpu6 -> l0_expert_agg_gpu11
	l0_expert_gpu7 -> l0_expert_agg_gpu11
	l0_expert_gpu8 -> l0_expert_agg_gpu11
	l0_expert_gpu9 -> l0_expert_agg_gpu11
	l0_expert_gpu10 -> l0_expert_agg_gpu11
	l0_expert_gpu11 -> l0_expert_agg_gpu11
	l0_expert_gpu12 -> l0_expert_agg_gpu11
	l0_expert_gpu13 -> l0_expert_agg_gpu11
	l0_expert_gpu14 -> l0_expert_agg_gpu11
	l0_expert_gpu15 -> l0_expert_agg_gpu11
	l0_attn_residual_gpu11 -> l0_final_residual_gpu11
	l0_expert_agg_gpu11 -> l0_final_residual_gpu11
	l0_qkv_gpu12 -> l0_attn_gpu12
	l0_attn_gpu12 -> l0_out_proj_gpu12
	l0_out_proj_gpu12 -> l0_attn_residual_gpu12
	input -> l0_attn_residual_gpu12
	l0_attn_residual_gpu12 -> l0_gate_gpu12
	l0_attn_residual_gpu12 -> l0_token_split_gpu12
	l0_gate_gpu12 -> l0_token_split_gpu12 [style=dashed]
	l0_token_split_gpu12 -> l0_send_gpu12_to_0
	l0_send_gpu12_to_0 -> l0_recv_gpu12_to_0
	l0_recv_gpu12_to_0 -> l0_local_tokens_gpu0
	l0_token_split_gpu12 -> l0_send_gpu12_to_1
	l0_send_gpu12_to_1 -> l0_recv_gpu12_to_1
	l0_recv_gpu12_to_1 -> l0_local_tokens_gpu1
	l0_token_split_gpu12 -> l0_send_gpu12_to_2
	l0_send_gpu12_to_2 -> l0_recv_gpu12_to_2
	l0_recv_gpu12_to_2 -> l0_local_tokens_gpu2
	l0_token_split_gpu12 -> l0_send_gpu12_to_3
	l0_send_gpu12_to_3 -> l0_recv_gpu12_to_3
	l0_recv_gpu12_to_3 -> l0_local_tokens_gpu3
	l0_token_split_gpu12 -> l0_send_gpu12_to_4
	l0_send_gpu12_to_4 -> l0_recv_gpu12_to_4
	l0_recv_gpu12_to_4 -> l0_local_tokens_gpu4
	l0_token_split_gpu12 -> l0_send_gpu12_to_5
	l0_send_gpu12_to_5 -> l0_recv_gpu12_to_5
	l0_recv_gpu12_to_5 -> l0_local_tokens_gpu5
	l0_token_split_gpu12 -> l0_send_gpu12_to_6
	l0_send_gpu12_to_6 -> l0_recv_gpu12_to_6
	l0_recv_gpu12_to_6 -> l0_local_tokens_gpu6
	l0_token_split_gpu12 -> l0_send_gpu12_to_7
	l0_send_gpu12_to_7 -> l0_recv_gpu12_to_7
	l0_recv_gpu12_to_7 -> l0_local_tokens_gpu7
	l0_token_split_gpu12 -> l0_send_gpu12_to_8
	l0_send_gpu12_to_8 -> l0_recv_gpu12_to_8
	l0_recv_gpu12_to_8 -> l0_local_tokens_gpu8
	l0_token_split_gpu12 -> l0_send_gpu12_to_9
	l0_send_gpu12_to_9 -> l0_recv_gpu12_to_9
	l0_recv_gpu12_to_9 -> l0_local_tokens_gpu9
	l0_token_split_gpu12 -> l0_send_gpu12_to_10
	l0_send_gpu12_to_10 -> l0_recv_gpu12_to_10
	l0_recv_gpu12_to_10 -> l0_local_tokens_gpu10
	l0_token_split_gpu12 -> l0_send_gpu12_to_11
	l0_send_gpu12_to_11 -> l0_recv_gpu12_to_11
	l0_recv_gpu12_to_11 -> l0_local_tokens_gpu11
	l0_token_split_gpu12 -> l0_send_gpu12_to_13
	l0_send_gpu12_to_13 -> l0_recv_gpu12_to_13
	l0_recv_gpu12_to_13 -> l0_local_tokens_gpu13
	l0_token_split_gpu12 -> l0_send_gpu12_to_14
	l0_send_gpu12_to_14 -> l0_recv_gpu12_to_14
	l0_recv_gpu12_to_14 -> l0_local_tokens_gpu14
	l0_token_split_gpu12 -> l0_send_gpu12_to_15
	l0_send_gpu12_to_15 -> l0_recv_gpu12_to_15
	l0_recv_gpu12_to_15 -> l0_local_tokens_gpu15
	l0_token_split_gpu12 -> l0_local_tokens_gpu12
	l0_local_tokens_gpu12 -> l0_expert_gpu12
	l0_expert_gpu0 -> l0_expert_agg_gpu12
	l0_expert_gpu1 -> l0_expert_agg_gpu12
	l0_expert_gpu2 -> l0_expert_agg_gpu12
	l0_expert_gpu3 -> l0_expert_agg_gpu12
	l0_expert_gpu4 -> l0_expert_agg_gpu12
	l0_expert_gpu5 -> l0_expert_agg_gpu12
	l0_expert_gpu6 -> l0_expert_agg_gpu12
	l0_expert_gpu7 -> l0_expert_agg_gpu12
	l0_expert_gpu8 -> l0_expert_agg_gpu12
	l0_expert_gpu9 -> l0_expert_agg_gpu12
	l0_expert_gpu10 -> l0_expert_agg_gpu12
	l0_expert_gpu11 -> l0_expert_agg_gpu12
	l0_expert_gpu12 -> l0_expert_agg_gpu12
	l0_expert_gpu13 -> l0_expert_agg_gpu12
	l0_expert_gpu14 -> l0_expert_agg_gpu12
	l0_expert_gpu15 -> l0_expert_agg_gpu12
	l0_attn_residual_gpu12 -> l0_final_residual_gpu12
	l0_expert_agg_gpu12 -> l0_final_residual_gpu12
	l0_qkv_gpu13 -> l0_attn_gpu13
	l0_attn_gpu13 -> l0_out_proj_gpu13
	l0_out_proj_gpu13 -> l0_attn_residual_gpu13
	input -> l0_attn_residual_gpu13
	l0_attn_residual_gpu13 -> l0_gate_gpu13
	l0_attn_residual_gpu13 -> l0_token_split_gpu13
	l0_gate_gpu13 -> l0_token_split_gpu13 [style=dashed]
	l0_token_split_gpu13 -> l0_send_gpu13_to_0
	l0_send_gpu13_to_0 -> l0_recv_gpu13_to_0
	l0_recv_gpu13_to_0 -> l0_local_tokens_gpu0
	l0_token_split_gpu13 -> l0_send_gpu13_to_1
	l0_send_gpu13_to_1 -> l0_recv_gpu13_to_1
	l0_recv_gpu13_to_1 -> l0_local_tokens_gpu1
	l0_token_split_gpu13 -> l0_send_gpu13_to_2
	l0_send_gpu13_to_2 -> l0_recv_gpu13_to_2
	l0_recv_gpu13_to_2 -> l0_local_tokens_gpu2
	l0_token_split_gpu13 -> l0_send_gpu13_to_3
	l0_send_gpu13_to_3 -> l0_recv_gpu13_to_3
	l0_recv_gpu13_to_3 -> l0_local_tokens_gpu3
	l0_token_split_gpu13 -> l0_send_gpu13_to_4
	l0_send_gpu13_to_4 -> l0_recv_gpu13_to_4
	l0_recv_gpu13_to_4 -> l0_local_tokens_gpu4
	l0_token_split_gpu13 -> l0_send_gpu13_to_5
	l0_send_gpu13_to_5 -> l0_recv_gpu13_to_5
	l0_recv_gpu13_to_5 -> l0_local_tokens_gpu5
	l0_token_split_gpu13 -> l0_send_gpu13_to_6
	l0_send_gpu13_to_6 -> l0_recv_gpu13_to_6
	l0_recv_gpu13_to_6 -> l0_local_tokens_gpu6
	l0_token_split_gpu13 -> l0_send_gpu13_to_7
	l0_send_gpu13_to_7 -> l0_recv_gpu13_to_7
	l0_recv_gpu13_to_7 -> l0_local_tokens_gpu7
	l0_token_split_gpu13 -> l0_send_gpu13_to_8
	l0_send_gpu13_to_8 -> l0_recv_gpu13_to_8
	l0_recv_gpu13_to_8 -> l0_local_tokens_gpu8
	l0_token_split_gpu13 -> l0_send_gpu13_to_9
	l0_send_gpu13_to_9 -> l0_recv_gpu13_to_9
	l0_recv_gpu13_to_9 -> l0_local_tokens_gpu9
	l0_token_split_gpu13 -> l0_send_gpu13_to_10
	l0_send_gpu13_to_10 -> l0_recv_gpu13_to_10
	l0_recv_gpu13_to_10 -> l0_local_tokens_gpu10
	l0_token_split_gpu13 -> l0_send_gpu13_to_11
	l0_send_gpu13_to_11 -> l0_recv_gpu13_to_11
	l0_recv_gpu13_to_11 -> l0_local_tokens_gpu11
	l0_token_split_gpu13 -> l0_send_gpu13_to_12
	l0_send_gpu13_to_12 -> l0_recv_gpu13_to_12
	l0_recv_gpu13_to_12 -> l0_local_tokens_gpu12
	l0_token_split_gpu13 -> l0_send_gpu13_to_14
	l0_send_gpu13_to_14 -> l0_recv_gpu13_to_14
	l0_recv_gpu13_to_14 -> l0_local_tokens_gpu14
	l0_token_split_gpu13 -> l0_send_gpu13_to_15
	l0_send_gpu13_to_15 -> l0_recv_gpu13_to_15
	l0_recv_gpu13_to_15 -> l0_local_tokens_gpu15
	l0_token_split_gpu13 -> l0_local_tokens_gpu13
	l0_local_tokens_gpu13 -> l0_expert_gpu13
	l0_expert_gpu0 -> l0_expert_agg_gpu13
	l0_expert_gpu1 -> l0_expert_agg_gpu13
	l0_expert_gpu2 -> l0_expert_agg_gpu13
	l0_expert_gpu3 -> l0_expert_agg_gpu13
	l0_expert_gpu4 -> l0_expert_agg_gpu13
	l0_expert_gpu5 -> l0_expert_agg_gpu13
	l0_expert_gpu6 -> l0_expert_agg_gpu13
	l0_expert_gpu7 -> l0_expert_agg_gpu13
	l0_expert_gpu8 -> l0_expert_agg_gpu13
	l0_expert_gpu9 -> l0_expert_agg_gpu13
	l0_expert_gpu10 -> l0_expert_agg_gpu13
	l0_expert_gpu11 -> l0_expert_agg_gpu13
	l0_expert_gpu12 -> l0_expert_agg_gpu13
	l0_expert_gpu13 -> l0_expert_agg_gpu13
	l0_expert_gpu14 -> l0_expert_agg_gpu13
	l0_expert_gpu15 -> l0_expert_agg_gpu13
	l0_attn_residual_gpu13 -> l0_final_residual_gpu13
	l0_expert_agg_gpu13 -> l0_final_residual_gpu13
	l0_qkv_gpu14 -> l0_attn_gpu14
	l0_attn_gpu14 -> l0_out_proj_gpu14
	l0_out_proj_gpu14 -> l0_attn_residual_gpu14
	input -> l0_attn_residual_gpu14
	l0_attn_residual_gpu14 -> l0_gate_gpu14
	l0_attn_residual_gpu14 -> l0_token_split_gpu14
	l0_gate_gpu14 -> l0_token_split_gpu14 [style=dashed]
	l0_token_split_gpu14 -> l0_send_gpu14_to_0
	l0_send_gpu14_to_0 -> l0_recv_gpu14_to_0
	l0_recv_gpu14_to_0 -> l0_local_tokens_gpu0
	l0_token_split_gpu14 -> l0_send_gpu14_to_1
	l0_send_gpu14_to_1 -> l0_recv_gpu14_to_1
	l0_recv_gpu14_to_1 -> l0_local_tokens_gpu1
	l0_token_split_gpu14 -> l0_send_gpu14_to_2
	l0_send_gpu14_to_2 -> l0_recv_gpu14_to_2
	l0_recv_gpu14_to_2 -> l0_local_tokens_gpu2
	l0_token_split_gpu14 -> l0_send_gpu14_to_3
	l0_send_gpu14_to_3 -> l0_recv_gpu14_to_3
	l0_recv_gpu14_to_3 -> l0_local_tokens_gpu3
	l0_token_split_gpu14 -> l0_send_gpu14_to_4
	l0_send_gpu14_to_4 -> l0_recv_gpu14_to_4
	l0_recv_gpu14_to_4 -> l0_local_tokens_gpu4
	l0_token_split_gpu14 -> l0_send_gpu14_to_5
	l0_send_gpu14_to_5 -> l0_recv_gpu14_to_5
	l0_recv_gpu14_to_5 -> l0_local_tokens_gpu5
	l0_token_split_gpu14 -> l0_send_gpu14_to_6
	l0_send_gpu14_to_6 -> l0_recv_gpu14_to_6
	l0_recv_gpu14_to_6 -> l0_local_tokens_gpu6
	l0_token_split_gpu14 -> l0_send_gpu14_to_7
	l0_send_gpu14_to_7 -> l0_recv_gpu14_to_7
	l0_recv_gpu14_to_7 -> l0_local_tokens_gpu7
	l0_token_split_gpu14 -> l0_send_gpu14_to_8
	l0_send_gpu14_to_8 -> l0_recv_gpu14_to_8
	l0_recv_gpu14_to_8 -> l0_local_tokens_gpu8
	l0_token_split_gpu14 -> l0_send_gpu14_to_9
	l0_send_gpu14_to_9 -> l0_recv_gpu14_to_9
	l0_recv_gpu14_to_9 -> l0_local_tokens_gpu9
	l0_token_split_gpu14 -> l0_send_gpu14_to_10
	l0_send_gpu14_to_10 -> l0_recv_gpu14_to_10
	l0_recv_gpu14_to_10 -> l0_local_tokens_gpu10
	l0_token_split_gpu14 -> l0_send_gpu14_to_11
	l0_send_gpu14_to_11 -> l0_recv_gpu14_to_11
	l0_recv_gpu14_to_11 -> l0_local_tokens_gpu11
	l0_token_split_gpu14 -> l0_send_gpu14_to_12
	l0_send_gpu14_to_12 -> l0_recv_gpu14_to_12
	l0_recv_gpu14_to_12 -> l0_local_tokens_gpu12
	l0_token_split_gpu14 -> l0_send_gpu14_to_13
	l0_send_gpu14_to_13 -> l0_recv_gpu14_to_13
	l0_recv_gpu14_to_13 -> l0_local_tokens_gpu13
	l0_token_split_gpu14 -> l0_send_gpu14_to_15
	l0_send_gpu14_to_15 -> l0_recv_gpu14_to_15
	l0_recv_gpu14_to_15 -> l0_local_tokens_gpu15
	l0_token_split_gpu14 -> l0_local_tokens_gpu14
	l0_local_tokens_gpu14 -> l0_expert_gpu14
	l0_expert_gpu0 -> l0_expert_agg_gpu14
	l0_expert_gpu1 -> l0_expert_agg_gpu14
	l0_expert_gpu2 -> l0_expert_agg_gpu14
	l0_expert_gpu3 -> l0_expert_agg_gpu14
	l0_expert_gpu4 -> l0_expert_agg_gpu14
	l0_expert_gpu5 -> l0_expert_agg_gpu14
	l0_expert_gpu6 -> l0_expert_agg_gpu14
	l0_expert_gpu7 -> l0_expert_agg_gpu14
	l0_expert_gpu8 -> l0_expert_agg_gpu14
	l0_expert_gpu9 -> l0_expert_agg_gpu14
	l0_expert_gpu10 -> l0_expert_agg_gpu14
	l0_expert_gpu11 -> l0_expert_agg_gpu14
	l0_expert_gpu12 -> l0_expert_agg_gpu14
	l0_expert_gpu13 -> l0_expert_agg_gpu14
	l0_expert_gpu14 -> l0_expert_agg_gpu14
	l0_expert_gpu15 -> l0_expert_agg_gpu14
	l0_attn_residual_gpu14 -> l0_final_residual_gpu14
	l0_expert_agg_gpu14 -> l0_final_residual_gpu14
	l0_qkv_gpu15 -> l0_attn_gpu15
	l0_attn_gpu15 -> l0_out_proj_gpu15
	l0_out_proj_gpu15 -> l0_attn_residual_gpu15
	input -> l0_attn_residual_gpu15
	l0_attn_residual_gpu15 -> l0_gate_gpu15
	l0_attn_residual_gpu15 -> l0_token_split_gpu15
	l0_gate_gpu15 -> l0_token_split_gpu15 [style=dashed]
	l0_token_split_gpu15 -> l0_send_gpu15_to_0
	l0_send_gpu15_to_0 -> l0_recv_gpu15_to_0
	l0_recv_gpu15_to_0 -> l0_local_tokens_gpu0
	l0_token_split_gpu15 -> l0_send_gpu15_to_1
	l0_send_gpu15_to_1 -> l0_recv_gpu15_to_1
	l0_recv_gpu15_to_1 -> l0_local_tokens_gpu1
	l0_token_split_gpu15 -> l0_send_gpu15_to_2
	l0_send_gpu15_to_2 -> l0_recv_gpu15_to_2
	l0_recv_gpu15_to_2 -> l0_local_tokens_gpu2
	l0_token_split_gpu15 -> l0_send_gpu15_to_3
	l0_send_gpu15_to_3 -> l0_recv_gpu15_to_3
	l0_recv_gpu15_to_3 -> l0_local_tokens_gpu3
	l0_token_split_gpu15 -> l0_send_gpu15_to_4
	l0_send_gpu15_to_4 -> l0_recv_gpu15_to_4
	l0_recv_gpu15_to_4 -> l0_local_tokens_gpu4
	l0_token_split_gpu15 -> l0_send_gpu15_to_5
	l0_send_gpu15_to_5 -> l0_recv_gpu15_to_5
	l0_recv_gpu15_to_5 -> l0_local_tokens_gpu5
	l0_token_split_gpu15 -> l0_send_gpu15_to_6
	l0_send_gpu15_to_6 -> l0_recv_gpu15_to_6
	l0_recv_gpu15_to_6 -> l0_local_tokens_gpu6
	l0_token_split_gpu15 -> l0_send_gpu15_to_7
	l0_send_gpu15_to_7 -> l0_recv_gpu15_to_7
	l0_recv_gpu15_to_7 -> l0_local_tokens_gpu7
	l0_token_split_gpu15 -> l0_send_gpu15_to_8
	l0_send_gpu15_to_8 -> l0_recv_gpu15_to_8
	l0_recv_gpu15_to_8 -> l0_local_tokens_gpu8
	l0_token_split_gpu15 -> l0_send_gpu15_to_9
	l0_send_gpu15_to_9 -> l0_recv_gpu15_to_9
	l0_recv_gpu15_to_9 -> l0_local_tokens_gpu9
	l0_token_split_gpu15 -> l0_send_gpu15_to_10
	l0_send_gpu15_to_10 -> l0_recv_gpu15_to_10
	l0_recv_gpu15_to_10 -> l0_local_tokens_gpu10
	l0_token_split_gpu15 -> l0_send_gpu15_to_11
	l0_send_gpu15_to_11 -> l0_recv_gpu15_to_11
	l0_recv_gpu15_to_11 -> l0_local_tokens_gpu11
	l0_token_split_gpu15 -> l0_send_gpu15_to_12
	l0_send_gpu15_to_12 -> l0_recv_gpu15_to_12
	l0_recv_gpu15_to_12 -> l0_local_tokens_gpu12
	l0_token_split_gpu15 -> l0_send_gpu15_to_13
	l0_send_gpu15_to_13 -> l0_recv_gpu15_to_13
	l0_recv_gpu15_to_13 -> l0_local_tokens_gpu13
	l0_token_split_gpu15 -> l0_send_gpu15_to_14
	l0_send_gpu15_to_14 -> l0_recv_gpu15_to_14
	l0_recv_gpu15_to_14 -> l0_local_tokens_gpu14
	l0_token_split_gpu15 -> l0_local_tokens_gpu15
	l0_local_tokens_gpu15 -> l0_expert_gpu15
	l0_expert_gpu0 -> l0_expert_agg_gpu15
	l0_expert_gpu1 -> l0_expert_agg_gpu15
	l0_expert_gpu2 -> l0_expert_agg_gpu15
	l0_expert_gpu3 -> l0_expert_agg_gpu15
	l0_expert_gpu4 -> l0_expert_agg_gpu15
	l0_expert_gpu5 -> l0_expert_agg_gpu15
	l0_expert_gpu6 -> l0_expert_agg_gpu15
	l0_expert_gpu7 -> l0_expert_agg_gpu15
	l0_expert_gpu8 -> l0_expert_agg_gpu15
	l0_expert_gpu9 -> l0_expert_agg_gpu15
	l0_expert_gpu10 -> l0_expert_agg_gpu15
	l0_expert_gpu11 -> l0_expert_agg_gpu15
	l0_expert_gpu12 -> l0_expert_agg_gpu15
	l0_expert_gpu13 -> l0_expert_agg_gpu15
	l0_expert_gpu14 -> l0_expert_agg_gpu15
	l0_expert_gpu15 -> l0_expert_agg_gpu15
	l0_attn_residual_gpu15 -> l0_final_residual_gpu15
	l0_expert_agg_gpu15 -> l0_final_residual_gpu15
	l0_final_residual_gpu0 -> l1_qkv_gpu0
	l0_final_residual_gpu1 -> l1_qkv_gpu1
	l0_final_residual_gpu2 -> l1_qkv_gpu2
	l0_final_residual_gpu3 -> l1_qkv_gpu3
	l0_final_residual_gpu4 -> l1_qkv_gpu4
	l0_final_residual_gpu5 -> l1_qkv_gpu5
	l0_final_residual_gpu6 -> l1_qkv_gpu6
	l0_final_residual_gpu7 -> l1_qkv_gpu7
	l0_final_residual_gpu8 -> l1_qkv_gpu8
	l0_final_residual_gpu9 -> l1_qkv_gpu9
	l0_final_residual_gpu10 -> l1_qkv_gpu10
	l0_final_residual_gpu11 -> l1_qkv_gpu11
	l0_final_residual_gpu12 -> l1_qkv_gpu12
	l0_final_residual_gpu13 -> l1_qkv_gpu13
	l0_final_residual_gpu14 -> l1_qkv_gpu14
	l0_final_residual_gpu15 -> l1_qkv_gpu15
	l1_qkv_gpu0 -> l1_attn_gpu0
	l1_attn_gpu0 -> l1_out_proj_gpu0
	l1_out_proj_gpu0 -> l1_attn_residual_gpu0
	l0_final_residual_gpu0 -> l1_attn_residual_gpu0
	l1_attn_residual_gpu0 -> l1_gate_gpu0
	l1_attn_residual_gpu0 -> l1_token_split_gpu0
	l1_gate_gpu0 -> l1_token_split_gpu0 [style=dashed]
	l1_token_split_gpu0 -> l1_send_gpu0_to_1
	l1_send_gpu0_to_1 -> l1_recv_gpu0_to_1
	l1_recv_gpu0_to_1 -> l1_local_tokens_gpu1
	l1_token_split_gpu0 -> l1_send_gpu0_to_2
	l1_send_gpu0_to_2 -> l1_recv_gpu0_to_2
	l1_recv_gpu0_to_2 -> l1_local_tokens_gpu2
	l1_token_split_gpu0 -> l1_send_gpu0_to_3
	l1_send_gpu0_to_3 -> l1_recv_gpu0_to_3
	l1_recv_gpu0_to_3 -> l1_local_tokens_gpu3
	l1_token_split_gpu0 -> l1_send_gpu0_to_4
	l1_send_gpu0_to_4 -> l1_recv_gpu0_to_4
	l1_recv_gpu0_to_4 -> l1_local_tokens_gpu4
	l1_token_split_gpu0 -> l1_send_gpu0_to_5
	l1_send_gpu0_to_5 -> l1_recv_gpu0_to_5
	l1_recv_gpu0_to_5 -> l1_local_tokens_gpu5
	l1_token_split_gpu0 -> l1_send_gpu0_to_6
	l1_send_gpu0_to_6 -> l1_recv_gpu0_to_6
	l1_recv_gpu0_to_6 -> l1_local_tokens_gpu6
	l1_token_split_gpu0 -> l1_send_gpu0_to_7
	l1_send_gpu0_to_7 -> l1_recv_gpu0_to_7
	l1_recv_gpu0_to_7 -> l1_local_tokens_gpu7
	l1_token_split_gpu0 -> l1_send_gpu0_to_8
	l1_send_gpu0_to_8 -> l1_recv_gpu0_to_8
	l1_recv_gpu0_to_8 -> l1_local_tokens_gpu8
	l1_token_split_gpu0 -> l1_send_gpu0_to_9
	l1_send_gpu0_to_9 -> l1_recv_gpu0_to_9
	l1_recv_gpu0_to_9 -> l1_local_tokens_gpu9
	l1_token_split_gpu0 -> l1_send_gpu0_to_10
	l1_send_gpu0_to_10 -> l1_recv_gpu0_to_10
	l1_recv_gpu0_to_10 -> l1_local_tokens_gpu10
	l1_token_split_gpu0 -> l1_send_gpu0_to_11
	l1_send_gpu0_to_11 -> l1_recv_gpu0_to_11
	l1_recv_gpu0_to_11 -> l1_local_tokens_gpu11
	l1_token_split_gpu0 -> l1_send_gpu0_to_12
	l1_send_gpu0_to_12 -> l1_recv_gpu0_to_12
	l1_recv_gpu0_to_12 -> l1_local_tokens_gpu12
	l1_token_split_gpu0 -> l1_send_gpu0_to_13
	l1_send_gpu0_to_13 -> l1_recv_gpu0_to_13
	l1_recv_gpu0_to_13 -> l1_local_tokens_gpu13
	l1_token_split_gpu0 -> l1_send_gpu0_to_14
	l1_send_gpu0_to_14 -> l1_recv_gpu0_to_14
	l1_recv_gpu0_to_14 -> l1_local_tokens_gpu14
	l1_token_split_gpu0 -> l1_send_gpu0_to_15
	l1_send_gpu0_to_15 -> l1_recv_gpu0_to_15
	l1_recv_gpu0_to_15 -> l1_local_tokens_gpu15
	l1_token_split_gpu0 -> l1_local_tokens_gpu0
	l1_local_tokens_gpu0 -> l1_expert_gpu0
	l1_expert_gpu0 -> l1_expert_agg_gpu0
	l1_expert_gpu1 -> l1_expert_agg_gpu0
	l1_expert_gpu2 -> l1_expert_agg_gpu0
	l1_expert_gpu3 -> l1_expert_agg_gpu0
	l1_expert_gpu4 -> l1_expert_agg_gpu0
	l1_expert_gpu5 -> l1_expert_agg_gpu0
	l1_expert_gpu6 -> l1_expert_agg_gpu0
	l1_expert_gpu7 -> l1_expert_agg_gpu0
	l1_expert_gpu8 -> l1_expert_agg_gpu0
	l1_expert_gpu9 -> l1_expert_agg_gpu0
	l1_expert_gpu10 -> l1_expert_agg_gpu0
	l1_expert_gpu11 -> l1_expert_agg_gpu0
	l1_expert_gpu12 -> l1_expert_agg_gpu0
	l1_expert_gpu13 -> l1_expert_agg_gpu0
	l1_expert_gpu14 -> l1_expert_agg_gpu0
	l1_expert_gpu15 -> l1_expert_agg_gpu0
	l1_attn_residual_gpu0 -> l1_final_residual_gpu0
	l1_expert_agg_gpu0 -> l1_final_residual_gpu0
	l1_qkv_gpu1 -> l1_attn_gpu1
	l1_attn_gpu1 -> l1_out_proj_gpu1
	l1_out_proj_gpu1 -> l1_attn_residual_gpu1
	l0_final_residual_gpu1 -> l1_attn_residual_gpu1
	l1_attn_residual_gpu1 -> l1_gate_gpu1
	l1_attn_residual_gpu1 -> l1_token_split_gpu1
	l1_gate_gpu1 -> l1_token_split_gpu1 [style=dashed]
	l1_token_split_gpu1 -> l1_send_gpu1_to_0
	l1_send_gpu1_to_0 -> l1_recv_gpu1_to_0
	l1_recv_gpu1_to_0 -> l1_local_tokens_gpu0
	l1_token_split_gpu1 -> l1_send_gpu1_to_2
	l1_send_gpu1_to_2 -> l1_recv_gpu1_to_2
	l1_recv_gpu1_to_2 -> l1_local_tokens_gpu2
	l1_token_split_gpu1 -> l1_send_gpu1_to_3
	l1_send_gpu1_to_3 -> l1_recv_gpu1_to_3
	l1_recv_gpu1_to_3 -> l1_local_tokens_gpu3
	l1_token_split_gpu1 -> l1_send_gpu1_to_4
	l1_send_gpu1_to_4 -> l1_recv_gpu1_to_4
	l1_recv_gpu1_to_4 -> l1_local_tokens_gpu4
	l1_token_split_gpu1 -> l1_send_gpu1_to_5
	l1_send_gpu1_to_5 -> l1_recv_gpu1_to_5
	l1_recv_gpu1_to_5 -> l1_local_tokens_gpu5
	l1_token_split_gpu1 -> l1_send_gpu1_to_6
	l1_send_gpu1_to_6 -> l1_recv_gpu1_to_6
	l1_recv_gpu1_to_6 -> l1_local_tokens_gpu6
	l1_token_split_gpu1 -> l1_send_gpu1_to_7
	l1_send_gpu1_to_7 -> l1_recv_gpu1_to_7
	l1_recv_gpu1_to_7 -> l1_local_tokens_gpu7
	l1_token_split_gpu1 -> l1_send_gpu1_to_8
	l1_send_gpu1_to_8 -> l1_recv_gpu1_to_8
	l1_recv_gpu1_to_8 -> l1_local_tokens_gpu8
	l1_token_split_gpu1 -> l1_send_gpu1_to_9
	l1_send_gpu1_to_9 -> l1_recv_gpu1_to_9
	l1_recv_gpu1_to_9 -> l1_local_tokens_gpu9
	l1_token_split_gpu1 -> l1_send_gpu1_to_10
	l1_send_gpu1_to_10 -> l1_recv_gpu1_to_10
	l1_recv_gpu1_to_10 -> l1_local_tokens_gpu10
	l1_token_split_gpu1 -> l1_send_gpu1_to_11
	l1_send_gpu1_to_11 -> l1_recv_gpu1_to_11
	l1_recv_gpu1_to_11 -> l1_local_tokens_gpu11
	l1_token_split_gpu1 -> l1_send_gpu1_to_12
	l1_send_gpu1_to_12 -> l1_recv_gpu1_to_12
	l1_recv_gpu1_to_12 -> l1_local_tokens_gpu12
	l1_token_split_gpu1 -> l1_send_gpu1_to_13
	l1_send_gpu1_to_13 -> l1_recv_gpu1_to_13
	l1_recv_gpu1_to_13 -> l1_local_tokens_gpu13
	l1_token_split_gpu1 -> l1_send_gpu1_to_14
	l1_send_gpu1_to_14 -> l1_recv_gpu1_to_14
	l1_recv_gpu1_to_14 -> l1_local_tokens_gpu14
	l1_token_split_gpu1 -> l1_send_gpu1_to_15
	l1_send_gpu1_to_15 -> l1_recv_gpu1_to_15
	l1_recv_gpu1_to_15 -> l1_local_tokens_gpu15
	l1_token_split_gpu1 -> l1_local_tokens_gpu1
	l1_local_tokens_gpu1 -> l1_expert_gpu1
	l1_expert_gpu0 -> l1_expert_agg_gpu1
	l1_expert_gpu1 -> l1_expert_agg_gpu1
	l1_expert_gpu2 -> l1_expert_agg_gpu1
	l1_expert_gpu3 -> l1_expert_agg_gpu1
	l1_expert_gpu4 -> l1_expert_agg_gpu1
	l1_expert_gpu5 -> l1_expert_agg_gpu1
	l1_expert_gpu6 -> l1_expert_agg_gpu1
	l1_expert_gpu7 -> l1_expert_agg_gpu1
	l1_expert_gpu8 -> l1_expert_agg_gpu1
	l1_expert_gpu9 -> l1_expert_agg_gpu1
	l1_expert_gpu10 -> l1_expert_agg_gpu1
	l1_expert_gpu11 -> l1_expert_agg_gpu1
	l1_expert_gpu12 -> l1_expert_agg_gpu1
	l1_expert_gpu13 -> l1_expert_agg_gpu1
	l1_expert_gpu14 -> l1_expert_agg_gpu1
	l1_expert_gpu15 -> l1_expert_agg_gpu1
	l1_attn_residual_gpu1 -> l1_final_residual_gpu1
	l1_expert_agg_gpu1 -> l1_final_residual_gpu1
	l1_qkv_gpu2 -> l1_attn_gpu2
	l1_attn_gpu2 -> l1_out_proj_gpu2
	l1_out_proj_gpu2 -> l1_attn_residual_gpu2
	l0_final_residual_gpu2 -> l1_attn_residual_gpu2
	l1_attn_residual_gpu2 -> l1_gate_gpu2
	l1_attn_residual_gpu2 -> l1_token_split_gpu2
	l1_gate_gpu2 -> l1_token_split_gpu2 [style=dashed]
	l1_token_split_gpu2 -> l1_send_gpu2_to_0
	l1_send_gpu2_to_0 -> l1_recv_gpu2_to_0
	l1_recv_gpu2_to_0 -> l1_local_tokens_gpu0
	l1_token_split_gpu2 -> l1_send_gpu2_to_1
	l1_send_gpu2_to_1 -> l1_recv_gpu2_to_1
	l1_recv_gpu2_to_1 -> l1_local_tokens_gpu1
	l1_token_split_gpu2 -> l1_send_gpu2_to_3
	l1_send_gpu2_to_3 -> l1_recv_gpu2_to_3
	l1_recv_gpu2_to_3 -> l1_local_tokens_gpu3
	l1_token_split_gpu2 -> l1_send_gpu2_to_4
	l1_send_gpu2_to_4 -> l1_recv_gpu2_to_4
	l1_recv_gpu2_to_4 -> l1_local_tokens_gpu4
	l1_token_split_gpu2 -> l1_send_gpu2_to_5
	l1_send_gpu2_to_5 -> l1_recv_gpu2_to_5
	l1_recv_gpu2_to_5 -> l1_local_tokens_gpu5
	l1_token_split_gpu2 -> l1_send_gpu2_to_6
	l1_send_gpu2_to_6 -> l1_recv_gpu2_to_6
	l1_recv_gpu2_to_6 -> l1_local_tokens_gpu6
	l1_token_split_gpu2 -> l1_send_gpu2_to_7
	l1_send_gpu2_to_7 -> l1_recv_gpu2_to_7
	l1_recv_gpu2_to_7 -> l1_local_tokens_gpu7
	l1_token_split_gpu2 -> l1_send_gpu2_to_8
	l1_send_gpu2_to_8 -> l1_recv_gpu2_to_8
	l1_recv_gpu2_to_8 -> l1_local_tokens_gpu8
	l1_token_split_gpu2 -> l1_send_gpu2_to_9
	l1_send_gpu2_to_9 -> l1_recv_gpu2_to_9
	l1_recv_gpu2_to_9 -> l1_local_tokens_gpu9
	l1_token_split_gpu2 -> l1_send_gpu2_to_10
	l1_send_gpu2_to_10 -> l1_recv_gpu2_to_10
	l1_recv_gpu2_to_10 -> l1_local_tokens_gpu10
	l1_token_split_gpu2 -> l1_send_gpu2_to_11
	l1_send_gpu2_to_11 -> l1_recv_gpu2_to_11
	l1_recv_gpu2_to_11 -> l1_local_tokens_gpu11
	l1_token_split_gpu2 -> l1_send_gpu2_to_12
	l1_send_gpu2_to_12 -> l1_recv_gpu2_to_12
	l1_recv_gpu2_to_12 -> l1_local_tokens_gpu12
	l1_token_split_gpu2 -> l1_send_gpu2_to_13
	l1_send_gpu2_to_13 -> l1_recv_gpu2_to_13
	l1_recv_gpu2_to_13 -> l1_local_tokens_gpu13
	l1_token_split_gpu2 -> l1_send_gpu2_to_14
	l1_send_gpu2_to_14 -> l1_recv_gpu2_to_14
	l1_recv_gpu2_to_14 -> l1_local_tokens_gpu14
	l1_token_split_gpu2 -> l1_send_gpu2_to_15
	l1_send_gpu2_to_15 -> l1_recv_gpu2_to_15
	l1_recv_gpu2_to_15 -> l1_local_tokens_gpu15
	l1_token_split_gpu2 -> l1_local_tokens_gpu2
	l1_local_tokens_gpu2 -> l1_expert_gpu2
	l1_expert_gpu0 -> l1_expert_agg_gpu2
	l1_expert_gpu1 -> l1_expert_agg_gpu2
	l1_expert_gpu2 -> l1_expert_agg_gpu2
	l1_expert_gpu3 -> l1_expert_agg_gpu2
	l1_expert_gpu4 -> l1_expert_agg_gpu2
	l1_expert_gpu5 -> l1_expert_agg_gpu2
	l1_expert_gpu6 -> l1_expert_agg_gpu2
	l1_expert_gpu7 -> l1_expert_agg_gpu2
	l1_expert_gpu8 -> l1_expert_agg_gpu2
	l1_expert_gpu9 -> l1_expert_agg_gpu2
	l1_expert_gpu10 -> l1_expert_agg_gpu2
	l1_expert_gpu11 -> l1_expert_agg_gpu2
	l1_expert_gpu12 -> l1_expert_agg_gpu2
	l1_expert_gpu13 -> l1_expert_agg_gpu2
	l1_expert_gpu14 -> l1_expert_agg_gpu2
	l1_expert_gpu15 -> l1_expert_agg_gpu2
	l1_attn_residual_gpu2 -> l1_final_residual_gpu2
	l1_expert_agg_gpu2 -> l1_final_residual_gpu2
	l1_qkv_gpu3 -> l1_attn_gpu3
	l1_attn_gpu3 -> l1_out_proj_gpu3
	l1_out_proj_gpu3 -> l1_attn_residual_gpu3
	l0_final_residual_gpu3 -> l1_attn_residual_gpu3
	l1_attn_residual_gpu3 -> l1_gate_gpu3
	l1_attn_residual_gpu3 -> l1_token_split_gpu3
	l1_gate_gpu3 -> l1_token_split_gpu3 [style=dashed]
	l1_token_split_gpu3 -> l1_send_gpu3_to_0
	l1_send_gpu3_to_0 -> l1_recv_gpu3_to_0
	l1_recv_gpu3_to_0 -> l1_local_tokens_gpu0
	l1_token_split_gpu3 -> l1_send_gpu3_to_1
	l1_send_gpu3_to_1 -> l1_recv_gpu3_to_1
	l1_recv_gpu3_to_1 -> l1_local_tokens_gpu1
	l1_token_split_gpu3 -> l1_send_gpu3_to_2
	l1_send_gpu3_to_2 -> l1_recv_gpu3_to_2
	l1_recv_gpu3_to_2 -> l1_local_tokens_gpu2
	l1_token_split_gpu3 -> l1_send_gpu3_to_4
	l1_send_gpu3_to_4 -> l1_recv_gpu3_to_4
	l1_recv_gpu3_to_4 -> l1_local_tokens_gpu4
	l1_token_split_gpu3 -> l1_send_gpu3_to_5
	l1_send_gpu3_to_5 -> l1_recv_gpu3_to_5
	l1_recv_gpu3_to_5 -> l1_local_tokens_gpu5
	l1_token_split_gpu3 -> l1_send_gpu3_to_6
	l1_send_gpu3_to_6 -> l1_recv_gpu3_to_6
	l1_recv_gpu3_to_6 -> l1_local_tokens_gpu6
	l1_token_split_gpu3 -> l1_send_gpu3_to_7
	l1_send_gpu3_to_7 -> l1_recv_gpu3_to_7
	l1_recv_gpu3_to_7 -> l1_local_tokens_gpu7
	l1_token_split_gpu3 -> l1_send_gpu3_to_8
	l1_send_gpu3_to_8 -> l1_recv_gpu3_to_8
	l1_recv_gpu3_to_8 -> l1_local_tokens_gpu8
	l1_token_split_gpu3 -> l1_send_gpu3_to_9
	l1_send_gpu3_to_9 -> l1_recv_gpu3_to_9
	l1_recv_gpu3_to_9 -> l1_local_tokens_gpu9
	l1_token_split_gpu3 -> l1_send_gpu3_to_10
	l1_send_gpu3_to_10 -> l1_recv_gpu3_to_10
	l1_recv_gpu3_to_10 -> l1_local_tokens_gpu10
	l1_token_split_gpu3 -> l1_send_gpu3_to_11
	l1_send_gpu3_to_11 -> l1_recv_gpu3_to_11
	l1_recv_gpu3_to_11 -> l1_local_tokens_gpu11
	l1_token_split_gpu3 -> l1_send_gpu3_to_12
	l1_send_gpu3_to_12 -> l1_recv_gpu3_to_12
	l1_recv_gpu3_to_12 -> l1_local_tokens_gpu12
	l1_token_split_gpu3 -> l1_send_gpu3_to_13
	l1_send_gpu3_to_13 -> l1_recv_gpu3_to_13
	l1_recv_gpu3_to_13 -> l1_local_tokens_gpu13
	l1_token_split_gpu3 -> l1_send_gpu3_to_14
	l1_send_gpu3_to_14 -> l1_recv_gpu3_to_14
	l1_recv_gpu3_to_14 -> l1_local_tokens_gpu14
	l1_token_split_gpu3 -> l1_send_gpu3_to_15
	l1_send_gpu3_to_15 -> l1_recv_gpu3_to_15
	l1_recv_gpu3_to_15 -> l1_local_tokens_gpu15
	l1_token_split_gpu3 -> l1_local_tokens_gpu3
	l1_local_tokens_gpu3 -> l1_expert_gpu3
	l1_expert_gpu0 -> l1_expert_agg_gpu3
	l1_expert_gpu1 -> l1_expert_agg_gpu3
	l1_expert_gpu2 -> l1_expert_agg_gpu3
	l1_expert_gpu3 -> l1_expert_agg_gpu3
	l1_expert_gpu4 -> l1_expert_agg_gpu3
	l1_expert_gpu5 -> l1_expert_agg_gpu3
	l1_expert_gpu6 -> l1_expert_agg_gpu3
	l1_expert_gpu7 -> l1_expert_agg_gpu3
	l1_expert_gpu8 -> l1_expert_agg_gpu3
	l1_expert_gpu9 -> l1_expert_agg_gpu3
	l1_expert_gpu10 -> l1_expert_agg_gpu3
	l1_expert_gpu11 -> l1_expert_agg_gpu3
	l1_expert_gpu12 -> l1_expert_agg_gpu3
	l1_expert_gpu13 -> l1_expert_agg_gpu3
	l1_expert_gpu14 -> l1_expert_agg_gpu3
	l1_expert_gpu15 -> l1_expert_agg_gpu3
	l1_attn_residual_gpu3 -> l1_final_residual_gpu3
	l1_expert_agg_gpu3 -> l1_final_residual_gpu3
	l1_qkv_gpu4 -> l1_attn_gpu4
	l1_attn_gpu4 -> l1_out_proj_gpu4
	l1_out_proj_gpu4 -> l1_attn_residual_gpu4
	l0_final_residual_gpu4 -> l1_attn_residual_gpu4
	l1_attn_residual_gpu4 -> l1_gate_gpu4
	l1_attn_residual_gpu4 -> l1_token_split_gpu4
	l1_gate_gpu4 -> l1_token_split_gpu4 [style=dashed]
	l1_token_split_gpu4 -> l1_send_gpu4_to_0
	l1_send_gpu4_to_0 -> l1_recv_gpu4_to_0
	l1_recv_gpu4_to_0 -> l1_local_tokens_gpu0
	l1_token_split_gpu4 -> l1_send_gpu4_to_1
	l1_send_gpu4_to_1 -> l1_recv_gpu4_to_1
	l1_recv_gpu4_to_1 -> l1_local_tokens_gpu1
	l1_token_split_gpu4 -> l1_send_gpu4_to_2
	l1_send_gpu4_to_2 -> l1_recv_gpu4_to_2
	l1_recv_gpu4_to_2 -> l1_local_tokens_gpu2
	l1_token_split_gpu4 -> l1_send_gpu4_to_3
	l1_send_gpu4_to_3 -> l1_recv_gpu4_to_3
	l1_recv_gpu4_to_3 -> l1_local_tokens_gpu3
	l1_token_split_gpu4 -> l1_send_gpu4_to_5
	l1_send_gpu4_to_5 -> l1_recv_gpu4_to_5
	l1_recv_gpu4_to_5 -> l1_local_tokens_gpu5
	l1_token_split_gpu4 -> l1_send_gpu4_to_6
	l1_send_gpu4_to_6 -> l1_recv_gpu4_to_6
	l1_recv_gpu4_to_6 -> l1_local_tokens_gpu6
	l1_token_split_gpu4 -> l1_send_gpu4_to_7
	l1_send_gpu4_to_7 -> l1_recv_gpu4_to_7
	l1_recv_gpu4_to_7 -> l1_local_tokens_gpu7
	l1_token_split_gpu4 -> l1_send_gpu4_to_8
	l1_send_gpu4_to_8 -> l1_recv_gpu4_to_8
	l1_recv_gpu4_to_8 -> l1_local_tokens_gpu8
	l1_token_split_gpu4 -> l1_send_gpu4_to_9
	l1_send_gpu4_to_9 -> l1_recv_gpu4_to_9
	l1_recv_gpu4_to_9 -> l1_local_tokens_gpu9
	l1_token_split_gpu4 -> l1_send_gpu4_to_10
	l1_send_gpu4_to_10 -> l1_recv_gpu4_to_10
	l1_recv_gpu4_to_10 -> l1_local_tokens_gpu10
	l1_token_split_gpu4 -> l1_send_gpu4_to_11
	l1_send_gpu4_to_11 -> l1_recv_gpu4_to_11
	l1_recv_gpu4_to_11 -> l1_local_tokens_gpu11
	l1_token_split_gpu4 -> l1_send_gpu4_to_12
	l1_send_gpu4_to_12 -> l1_recv_gpu4_to_12
	l1_recv_gpu4_to_12 -> l1_local_tokens_gpu12
	l1_token_split_gpu4 -> l1_send_gpu4_to_13
	l1_send_gpu4_to_13 -> l1_recv_gpu4_to_13
	l1_recv_gpu4_to_13 -> l1_local_tokens_gpu13
	l1_token_split_gpu4 -> l1_send_gpu4_to_14
	l1_send_gpu4_to_14 -> l1_recv_gpu4_to_14
	l1_recv_gpu4_to_14 -> l1_local_tokens_gpu14
	l1_token_split_gpu4 -> l1_send_gpu4_to_15
	l1_send_gpu4_to_15 -> l1_recv_gpu4_to_15
	l1_recv_gpu4_to_15 -> l1_local_tokens_gpu15
	l1_token_split_gpu4 -> l1_local_tokens_gpu4
	l1_local_tokens_gpu4 -> l1_expert_gpu4
	l1_expert_gpu0 -> l1_expert_agg_gpu4
	l1_expert_gpu1 -> l1_expert_agg_gpu4
	l1_expert_gpu2 -> l1_expert_agg_gpu4
	l1_expert_gpu3 -> l1_expert_agg_gpu4
	l1_expert_gpu4 -> l1_expert_agg_gpu4
	l1_expert_gpu5 -> l1_expert_agg_gpu4
	l1_expert_gpu6 -> l1_expert_agg_gpu4
	l1_expert_gpu7 -> l1_expert_agg_gpu4
	l1_expert_gpu8 -> l1_expert_agg_gpu4
	l1_expert_gpu9 -> l1_expert_agg_gpu4
	l1_expert_gpu10 -> l1_expert_agg_gpu4
	l1_expert_gpu11 -> l1_expert_agg_gpu4
	l1_expert_gpu12 -> l1_expert_agg_gpu4
	l1_expert_gpu13 -> l1_expert_agg_gpu4
	l1_expert_gpu14 -> l1_expert_agg_gpu4
	l1_expert_gpu15 -> l1_expert_agg_gpu4
	l1_attn_residual_gpu4 -> l1_final_residual_gpu4
	l1_expert_agg_gpu4 -> l1_final_residual_gpu4
	l1_qkv_gpu5 -> l1_attn_gpu5
	l1_attn_gpu5 -> l1_out_proj_gpu5
	l1_out_proj_gpu5 -> l1_attn_residual_gpu5
	l0_final_residual_gpu5 -> l1_attn_residual_gpu5
	l1_attn_residual_gpu5 -> l1_gate_gpu5
	l1_attn_residual_gpu5 -> l1_token_split_gpu5
	l1_gate_gpu5 -> l1_token_split_gpu5 [style=dashed]
	l1_token_split_gpu5 -> l1_send_gpu5_to_0
	l1_send_gpu5_to_0 -> l1_recv_gpu5_to_0
	l1_recv_gpu5_to_0 -> l1_local_tokens_gpu0
	l1_token_split_gpu5 -> l1_send_gpu5_to_1
	l1_send_gpu5_to_1 -> l1_recv_gpu5_to_1
	l1_recv_gpu5_to_1 -> l1_local_tokens_gpu1
	l1_token_split_gpu5 -> l1_send_gpu5_to_2
	l1_send_gpu5_to_2 -> l1_recv_gpu5_to_2
	l1_recv_gpu5_to_2 -> l1_local_tokens_gpu2
	l1_token_split_gpu5 -> l1_send_gpu5_to_3
	l1_send_gpu5_to_3 -> l1_recv_gpu5_to_3
	l1_recv_gpu5_to_3 -> l1_local_tokens_gpu3
	l1_token_split_gpu5 -> l1_send_gpu5_to_4
	l1_send_gpu5_to_4 -> l1_recv_gpu5_to_4
	l1_recv_gpu5_to_4 -> l1_local_tokens_gpu4
	l1_token_split_gpu5 -> l1_send_gpu5_to_6
	l1_send_gpu5_to_6 -> l1_recv_gpu5_to_6
	l1_recv_gpu5_to_6 -> l1_local_tokens_gpu6
	l1_token_split_gpu5 -> l1_send_gpu5_to_7
	l1_send_gpu5_to_7 -> l1_recv_gpu5_to_7
	l1_recv_gpu5_to_7 -> l1_local_tokens_gpu7
	l1_token_split_gpu5 -> l1_send_gpu5_to_8
	l1_send_gpu5_to_8 -> l1_recv_gpu5_to_8
	l1_recv_gpu5_to_8 -> l1_local_tokens_gpu8
	l1_token_split_gpu5 -> l1_send_gpu5_to_9
	l1_send_gpu5_to_9 -> l1_recv_gpu5_to_9
	l1_recv_gpu5_to_9 -> l1_local_tokens_gpu9
	l1_token_split_gpu5 -> l1_send_gpu5_to_10
	l1_send_gpu5_to_10 -> l1_recv_gpu5_to_10
	l1_recv_gpu5_to_10 -> l1_local_tokens_gpu10
	l1_token_split_gpu5 -> l1_send_gpu5_to_11
	l1_send_gpu5_to_11 -> l1_recv_gpu5_to_11
	l1_recv_gpu5_to_11 -> l1_local_tokens_gpu11
	l1_token_split_gpu5 -> l1_send_gpu5_to_12
	l1_send_gpu5_to_12 -> l1_recv_gpu5_to_12
	l1_recv_gpu5_to_12 -> l1_local_tokens_gpu12
	l1_token_split_gpu5 -> l1_send_gpu5_to_13
	l1_send_gpu5_to_13 -> l1_recv_gpu5_to_13
	l1_recv_gpu5_to_13 -> l1_local_tokens_gpu13
	l1_token_split_gpu5 -> l1_send_gpu5_to_14
	l1_send_gpu5_to_14 -> l1_recv_gpu5_to_14
	l1_recv_gpu5_to_14 -> l1_local_tokens_gpu14
	l1_token_split_gpu5 -> l1_send_gpu5_to_15
	l1_send_gpu5_to_15 -> l1_recv_gpu5_to_15
	l1_recv_gpu5_to_15 -> l1_local_tokens_gpu15
	l1_token_split_gpu5 -> l1_local_tokens_gpu5
	l1_local_tokens_gpu5 -> l1_expert_gpu5
	l1_expert_gpu0 -> l1_expert_agg_gpu5
	l1_expert_gpu1 -> l1_expert_agg_gpu5
	l1_expert_gpu2 -> l1_expert_agg_gpu5
	l1_expert_gpu3 -> l1_expert_agg_gpu5
	l1_expert_gpu4 -> l1_expert_agg_gpu5
	l1_expert_gpu5 -> l1_expert_agg_gpu5
	l1_expert_gpu6 -> l1_expert_agg_gpu5
	l1_expert_gpu7 -> l1_expert_agg_gpu5
	l1_expert_gpu8 -> l1_expert_agg_gpu5
	l1_expert_gpu9 -> l1_expert_agg_gpu5
	l1_expert_gpu10 -> l1_expert_agg_gpu5
	l1_expert_gpu11 -> l1_expert_agg_gpu5
	l1_expert_gpu12 -> l1_expert_agg_gpu5
	l1_expert_gpu13 -> l1_expert_agg_gpu5
	l1_expert_gpu14 -> l1_expert_agg_gpu5
	l1_expert_gpu15 -> l1_expert_agg_gpu5
	l1_attn_residual_gpu5 -> l1_final_residual_gpu5
	l1_expert_agg_gpu5 -> l1_final_residual_gpu5
	l1_qkv_gpu6 -> l1_attn_gpu6
	l1_attn_gpu6 -> l1_out_proj_gpu6
	l1_out_proj_gpu6 -> l1_attn_residual_gpu6
	l0_final_residual_gpu6 -> l1_attn_residual_gpu6
	l1_attn_residual_gpu6 -> l1_gate_gpu6
	l1_attn_residual_gpu6 -> l1_token_split_gpu6
	l1_gate_gpu6 -> l1_token_split_gpu6 [style=dashed]
	l1_token_split_gpu6 -> l1_send_gpu6_to_0
	l1_send_gpu6_to_0 -> l1_recv_gpu6_to_0
	l1_recv_gpu6_to_0 -> l1_local_tokens_gpu0
	l1_token_split_gpu6 -> l1_send_gpu6_to_1
	l1_send_gpu6_to_1 -> l1_recv_gpu6_to_1
	l1_recv_gpu6_to_1 -> l1_local_tokens_gpu1
	l1_token_split_gpu6 -> l1_send_gpu6_to_2
	l1_send_gpu6_to_2 -> l1_recv_gpu6_to_2
	l1_recv_gpu6_to_2 -> l1_local_tokens_gpu2
	l1_token_split_gpu6 -> l1_send_gpu6_to_3
	l1_send_gpu6_to_3 -> l1_recv_gpu6_to_3
	l1_recv_gpu6_to_3 -> l1_local_tokens_gpu3
	l1_token_split_gpu6 -> l1_send_gpu6_to_4
	l1_send_gpu6_to_4 -> l1_recv_gpu6_to_4
	l1_recv_gpu6_to_4 -> l1_local_tokens_gpu4
	l1_token_split_gpu6 -> l1_send_gpu6_to_5
	l1_send_gpu6_to_5 -> l1_recv_gpu6_to_5
	l1_recv_gpu6_to_5 -> l1_local_tokens_gpu5
	l1_token_split_gpu6 -> l1_send_gpu6_to_7
	l1_send_gpu6_to_7 -> l1_recv_gpu6_to_7
	l1_recv_gpu6_to_7 -> l1_local_tokens_gpu7
	l1_token_split_gpu6 -> l1_send_gpu6_to_8
	l1_send_gpu6_to_8 -> l1_recv_gpu6_to_8
	l1_recv_gpu6_to_8 -> l1_local_tokens_gpu8
	l1_token_split_gpu6 -> l1_send_gpu6_to_9
	l1_send_gpu6_to_9 -> l1_recv_gpu6_to_9
	l1_recv_gpu6_to_9 -> l1_local_tokens_gpu9
	l1_token_split_gpu6 -> l1_send_gpu6_to_10
	l1_send_gpu6_to_10 -> l1_recv_gpu6_to_10
	l1_recv_gpu6_to_10 -> l1_local_tokens_gpu10
	l1_token_split_gpu6 -> l1_send_gpu6_to_11
	l1_send_gpu6_to_11 -> l1_recv_gpu6_to_11
	l1_recv_gpu6_to_11 -> l1_local_tokens_gpu11
	l1_token_split_gpu6 -> l1_send_gpu6_to_12
	l1_send_gpu6_to_12 -> l1_recv_gpu6_to_12
	l1_recv_gpu6_to_12 -> l1_local_tokens_gpu12
	l1_token_split_gpu6 -> l1_send_gpu6_to_13
	l1_send_gpu6_to_13 -> l1_recv_gpu6_to_13
	l1_recv_gpu6_to_13 -> l1_local_tokens_gpu13
	l1_token_split_gpu6 -> l1_send_gpu6_to_14
	l1_send_gpu6_to_14 -> l1_recv_gpu6_to_14
	l1_recv_gpu6_to_14 -> l1_local_tokens_gpu14
	l1_token_split_gpu6 -> l1_send_gpu6_to_15
	l1_send_gpu6_to_15 -> l1_recv_gpu6_to_15
	l1_recv_gpu6_to_15 -> l1_local_tokens_gpu15
	l1_token_split_gpu6 -> l1_local_tokens_gpu6
	l1_local_tokens_gpu6 -> l1_expert_gpu6
	l1_expert_gpu0 -> l1_expert_agg_gpu6
	l1_expert_gpu1 -> l1_expert_agg_gpu6
	l1_expert_gpu2 -> l1_expert_agg_gpu6
	l1_expert_gpu3 -> l1_expert_agg_gpu6
	l1_expert_gpu4 -> l1_expert_agg_gpu6
	l1_expert_gpu5 -> l1_expert_agg_gpu6
	l1_expert_gpu6 -> l1_expert_agg_gpu6
	l1_expert_gpu7 -> l1_expert_agg_gpu6
	l1_expert_gpu8 -> l1_expert_agg_gpu6
	l1_expert_gpu9 -> l1_expert_agg_gpu6
	l1_expert_gpu10 -> l1_expert_agg_gpu6
	l1_expert_gpu11 -> l1_expert_agg_gpu6
	l1_expert_gpu12 -> l1_expert_agg_gpu6
	l1_expert_gpu13 -> l1_expert_agg_gpu6
	l1_expert_gpu14 -> l1_expert_agg_gpu6
	l1_expert_gpu15 -> l1_expert_agg_gpu6
	l1_attn_residual_gpu6 -> l1_final_residual_gpu6
	l1_expert_agg_gpu6 -> l1_final_residual_gpu6
	l1_qkv_gpu7 -> l1_attn_gpu7
	l1_attn_gpu7 -> l1_out_proj_gpu7
	l1_out_proj_gpu7 -> l1_attn_residual_gpu7
	l0_final_residual_gpu7 -> l1_attn_residual_gpu7
	l1_attn_residual_gpu7 -> l1_gate_gpu7
	l1_attn_residual_gpu7 -> l1_token_split_gpu7
	l1_gate_gpu7 -> l1_token_split_gpu7 [style=dashed]
	l1_token_split_gpu7 -> l1_send_gpu7_to_0
	l1_send_gpu7_to_0 -> l1_recv_gpu7_to_0
	l1_recv_gpu7_to_0 -> l1_local_tokens_gpu0
	l1_token_split_gpu7 -> l1_send_gpu7_to_1
	l1_send_gpu7_to_1 -> l1_recv_gpu7_to_1
	l1_recv_gpu7_to_1 -> l1_local_tokens_gpu1
	l1_token_split_gpu7 -> l1_send_gpu7_to_2
	l1_send_gpu7_to_2 -> l1_recv_gpu7_to_2
	l1_recv_gpu7_to_2 -> l1_local_tokens_gpu2
	l1_token_split_gpu7 -> l1_send_gpu7_to_3
	l1_send_gpu7_to_3 -> l1_recv_gpu7_to_3
	l1_recv_gpu7_to_3 -> l1_local_tokens_gpu3
	l1_token_split_gpu7 -> l1_send_gpu7_to_4
	l1_send_gpu7_to_4 -> l1_recv_gpu7_to_4
	l1_recv_gpu7_to_4 -> l1_local_tokens_gpu4
	l1_token_split_gpu7 -> l1_send_gpu7_to_5
	l1_send_gpu7_to_5 -> l1_recv_gpu7_to_5
	l1_recv_gpu7_to_5 -> l1_local_tokens_gpu5
	l1_token_split_gpu7 -> l1_send_gpu7_to_6
	l1_send_gpu7_to_6 -> l1_recv_gpu7_to_6
	l1_recv_gpu7_to_6 -> l1_local_tokens_gpu6
	l1_token_split_gpu7 -> l1_send_gpu7_to_8
	l1_send_gpu7_to_8 -> l1_recv_gpu7_to_8
	l1_recv_gpu7_to_8 -> l1_local_tokens_gpu8
	l1_token_split_gpu7 -> l1_send_gpu7_to_9
	l1_send_gpu7_to_9 -> l1_recv_gpu7_to_9
	l1_recv_gpu7_to_9 -> l1_local_tokens_gpu9
	l1_token_split_gpu7 -> l1_send_gpu7_to_10
	l1_send_gpu7_to_10 -> l1_recv_gpu7_to_10
	l1_recv_gpu7_to_10 -> l1_local_tokens_gpu10
	l1_token_split_gpu7 -> l1_send_gpu7_to_11
	l1_send_gpu7_to_11 -> l1_recv_gpu7_to_11
	l1_recv_gpu7_to_11 -> l1_local_tokens_gpu11
	l1_token_split_gpu7 -> l1_send_gpu7_to_12
	l1_send_gpu7_to_12 -> l1_recv_gpu7_to_12
	l1_recv_gpu7_to_12 -> l1_local_tokens_gpu12
	l1_token_split_gpu7 -> l1_send_gpu7_to_13
	l1_send_gpu7_to_13 -> l1_recv_gpu7_to_13
	l1_recv_gpu7_to_13 -> l1_local_tokens_gpu13
	l1_token_split_gpu7 -> l1_send_gpu7_to_14
	l1_send_gpu7_to_14 -> l1_recv_gpu7_to_14
	l1_recv_gpu7_to_14 -> l1_local_tokens_gpu14
	l1_token_split_gpu7 -> l1_send_gpu7_to_15
	l1_send_gpu7_to_15 -> l1_recv_gpu7_to_15
	l1_recv_gpu7_to_15 -> l1_local_tokens_gpu15
	l1_token_split_gpu7 -> l1_local_tokens_gpu7
	l1_local_tokens_gpu7 -> l1_expert_gpu7
	l1_expert_gpu0 -> l1_expert_agg_gpu7
	l1_expert_gpu1 -> l1_expert_agg_gpu7
	l1_expert_gpu2 -> l1_expert_agg_gpu7
	l1_expert_gpu3 -> l1_expert_agg_gpu7
	l1_expert_gpu4 -> l1_expert_agg_gpu7
	l1_expert_gpu5 -> l1_expert_agg_gpu7
	l1_expert_gpu6 -> l1_expert_agg_gpu7
	l1_expert_gpu7 -> l1_expert_agg_gpu7
	l1_expert_gpu8 -> l1_expert_agg_gpu7
	l1_expert_gpu9 -> l1_expert_agg_gpu7
	l1_expert_gpu10 -> l1_expert_agg_gpu7
	l1_expert_gpu11 -> l1_expert_agg_gpu7
	l1_expert_gpu12 -> l1_expert_agg_gpu7
	l1_expert_gpu13 -> l1_expert_agg_gpu7
	l1_expert_gpu14 -> l1_expert_agg_gpu7
	l1_expert_gpu15 -> l1_expert_agg_gpu7
	l1_attn_residual_gpu7 -> l1_final_residual_gpu7
	l1_expert_agg_gpu7 -> l1_final_residual_gpu7
	l1_qkv_gpu8 -> l1_attn_gpu8
	l1_attn_gpu8 -> l1_out_proj_gpu8
	l1_out_proj_gpu8 -> l1_attn_residual_gpu8
	l0_final_residual_gpu8 -> l1_attn_residual_gpu8
	l1_attn_residual_gpu8 -> l1_gate_gpu8
	l1_attn_residual_gpu8 -> l1_token_split_gpu8
	l1_gate_gpu8 -> l1_token_split_gpu8 [style=dashed]
	l1_token_split_gpu8 -> l1_send_gpu8_to_0
	l1_send_gpu8_to_0 -> l1_recv_gpu8_to_0
	l1_recv_gpu8_to_0 -> l1_local_tokens_gpu0
	l1_token_split_gpu8 -> l1_send_gpu8_to_1
	l1_send_gpu8_to_1 -> l1_recv_gpu8_to_1
	l1_recv_gpu8_to_1 -> l1_local_tokens_gpu1
	l1_token_split_gpu8 -> l1_send_gpu8_to_2
	l1_send_gpu8_to_2 -> l1_recv_gpu8_to_2
	l1_recv_gpu8_to_2 -> l1_local_tokens_gpu2
	l1_token_split_gpu8 -> l1_send_gpu8_to_3
	l1_send_gpu8_to_3 -> l1_recv_gpu8_to_3
	l1_recv_gpu8_to_3 -> l1_local_tokens_gpu3
	l1_token_split_gpu8 -> l1_send_gpu8_to_4
	l1_send_gpu8_to_4 -> l1_recv_gpu8_to_4
	l1_recv_gpu8_to_4 -> l1_local_tokens_gpu4
	l1_token_split_gpu8 -> l1_send_gpu8_to_5
	l1_send_gpu8_to_5 -> l1_recv_gpu8_to_5
	l1_recv_gpu8_to_5 -> l1_local_tokens_gpu5
	l1_token_split_gpu8 -> l1_send_gpu8_to_6
	l1_send_gpu8_to_6 -> l1_recv_gpu8_to_6
	l1_recv_gpu8_to_6 -> l1_local_tokens_gpu6
	l1_token_split_gpu8 -> l1_send_gpu8_to_7
	l1_send_gpu8_to_7 -> l1_recv_gpu8_to_7
	l1_recv_gpu8_to_7 -> l1_local_tokens_gpu7
	l1_token_split_gpu8 -> l1_send_gpu8_to_9
	l1_send_gpu8_to_9 -> l1_recv_gpu8_to_9
	l1_recv_gpu8_to_9 -> l1_local_tokens_gpu9
	l1_token_split_gpu8 -> l1_send_gpu8_to_10
	l1_send_gpu8_to_10 -> l1_recv_gpu8_to_10
	l1_recv_gpu8_to_10 -> l1_local_tokens_gpu10
	l1_token_split_gpu8 -> l1_send_gpu8_to_11
	l1_send_gpu8_to_11 -> l1_recv_gpu8_to_11
	l1_recv_gpu8_to_11 -> l1_local_tokens_gpu11
	l1_token_split_gpu8 -> l1_send_gpu8_to_12
	l1_send_gpu8_to_12 -> l1_recv_gpu8_to_12
	l1_recv_gpu8_to_12 -> l1_local_tokens_gpu12
	l1_token_split_gpu8 -> l1_send_gpu8_to_13
	l1_send_gpu8_to_13 -> l1_recv_gpu8_to_13
	l1_recv_gpu8_to_13 -> l1_local_tokens_gpu13
	l1_token_split_gpu8 -> l1_send_gpu8_to_14
	l1_send_gpu8_to_14 -> l1_recv_gpu8_to_14
	l1_recv_gpu8_to_14 -> l1_local_tokens_gpu14
	l1_token_split_gpu8 -> l1_send_gpu8_to_15
	l1_send_gpu8_to_15 -> l1_recv_gpu8_to_15
	l1_recv_gpu8_to_15 -> l1_local_tokens_gpu15
	l1_token_split_gpu8 -> l1_local_tokens_gpu8
	l1_local_tokens_gpu8 -> l1_expert_gpu8
	l1_expert_gpu0 -> l1_expert_agg_gpu8
	l1_expert_gpu1 -> l1_expert_agg_gpu8
	l1_expert_gpu2 -> l1_expert_agg_gpu8
	l1_expert_gpu3 -> l1_expert_agg_gpu8
	l1_expert_gpu4 -> l1_expert_agg_gpu8
	l1_expert_gpu5 -> l1_expert_agg_gpu8
	l1_expert_gpu6 -> l1_expert_agg_gpu8
	l1_expert_gpu7 -> l1_expert_agg_gpu8
	l1_expert_gpu8 -> l1_expert_agg_gpu8
	l1_expert_gpu9 -> l1_expert_agg_gpu8
	l1_expert_gpu10 -> l1_expert_agg_gpu8
	l1_expert_gpu11 -> l1_expert_agg_gpu8
	l1_expert_gpu12 -> l1_expert_agg_gpu8
	l1_expert_gpu13 -> l1_expert_agg_gpu8
	l1_expert_gpu14 -> l1_expert_agg_gpu8
	l1_expert_gpu15 -> l1_expert_agg_gpu8
	l1_attn_residual_gpu8 -> l1_final_residual_gpu8
	l1_expert_agg_gpu8 -> l1_final_residual_gpu8
	l1_qkv_gpu9 -> l1_attn_gpu9
	l1_attn_gpu9 -> l1_out_proj_gpu9
	l1_out_proj_gpu9 -> l1_attn_residual_gpu9
	l0_final_residual_gpu9 -> l1_attn_residual_gpu9
	l1_attn_residual_gpu9 -> l1_gate_gpu9
	l1_attn_residual_gpu9 -> l1_token_split_gpu9
	l1_gate_gpu9 -> l1_token_split_gpu9 [style=dashed]
	l1_token_split_gpu9 -> l1_send_gpu9_to_0
	l1_send_gpu9_to_0 -> l1_recv_gpu9_to_0
	l1_recv_gpu9_to_0 -> l1_local_tokens_gpu0
	l1_token_split_gpu9 -> l1_send_gpu9_to_1
	l1_send_gpu9_to_1 -> l1_recv_gpu9_to_1
	l1_recv_gpu9_to_1 -> l1_local_tokens_gpu1
	l1_token_split_gpu9 -> l1_send_gpu9_to_2
	l1_send_gpu9_to_2 -> l1_recv_gpu9_to_2
	l1_recv_gpu9_to_2 -> l1_local_tokens_gpu2
	l1_token_split_gpu9 -> l1_send_gpu9_to_3
	l1_send_gpu9_to_3 -> l1_recv_gpu9_to_3
	l1_recv_gpu9_to_3 -> l1_local_tokens_gpu3
	l1_token_split_gpu9 -> l1_send_gpu9_to_4
	l1_send_gpu9_to_4 -> l1_recv_gpu9_to_4
	l1_recv_gpu9_to_4 -> l1_local_tokens_gpu4
	l1_token_split_gpu9 -> l1_send_gpu9_to_5
	l1_send_gpu9_to_5 -> l1_recv_gpu9_to_5
	l1_recv_gpu9_to_5 -> l1_local_tokens_gpu5
	l1_token_split_gpu9 -> l1_send_gpu9_to_6
	l1_send_gpu9_to_6 -> l1_recv_gpu9_to_6
	l1_recv_gpu9_to_6 -> l1_local_tokens_gpu6
	l1_token_split_gpu9 -> l1_send_gpu9_to_7
	l1_send_gpu9_to_7 -> l1_recv_gpu9_to_7
	l1_recv_gpu9_to_7 -> l1_local_tokens_gpu7
	l1_token_split_gpu9 -> l1_send_gpu9_to_8
	l1_send_gpu9_to_8 -> l1_recv_gpu9_to_8
	l1_recv_gpu9_to_8 -> l1_local_tokens_gpu8
	l1_token_split_gpu9 -> l1_send_gpu9_to_10
	l1_send_gpu9_to_10 -> l1_recv_gpu9_to_10
	l1_recv_gpu9_to_10 -> l1_local_tokens_gpu10
	l1_token_split_gpu9 -> l1_send_gpu9_to_11
	l1_send_gpu9_to_11 -> l1_recv_gpu9_to_11
	l1_recv_gpu9_to_11 -> l1_local_tokens_gpu11
	l1_token_split_gpu9 -> l1_send_gpu9_to_12
	l1_send_gpu9_to_12 -> l1_recv_gpu9_to_12
	l1_recv_gpu9_to_12 -> l1_local_tokens_gpu12
	l1_token_split_gpu9 -> l1_send_gpu9_to_13
	l1_send_gpu9_to_13 -> l1_recv_gpu9_to_13
	l1_recv_gpu9_to_13 -> l1_local_tokens_gpu13
	l1_token_split_gpu9 -> l1_send_gpu9_to_14
	l1_send_gpu9_to_14 -> l1_recv_gpu9_to_14
	l1_recv_gpu9_to_14 -> l1_local_tokens_gpu14
	l1_token_split_gpu9 -> l1_send_gpu9_to_15
	l1_send_gpu9_to_15 -> l1_recv_gpu9_to_15
	l1_recv_gpu9_to_15 -> l1_local_tokens_gpu15
	l1_token_split_gpu9 -> l1_local_tokens_gpu9
	l1_local_tokens_gpu9 -> l1_expert_gpu9
	l1_expert_gpu0 -> l1_expert_agg_gpu9
	l1_expert_gpu1 -> l1_expert_agg_gpu9
	l1_expert_gpu2 -> l1_expert_agg_gpu9
	l1_expert_gpu3 -> l1_expert_agg_gpu9
	l1_expert_gpu4 -> l1_expert_agg_gpu9
	l1_expert_gpu5 -> l1_expert_agg_gpu9
	l1_expert_gpu6 -> l1_expert_agg_gpu9
	l1_expert_gpu7 -> l1_expert_agg_gpu9
	l1_expert_gpu8 -> l1_expert_agg_gpu9
	l1_expert_gpu9 -> l1_expert_agg_gpu9
	l1_expert_gpu10 -> l1_expert_agg_gpu9
	l1_expert_gpu11 -> l1_expert_agg_gpu9
	l1_expert_gpu12 -> l1_expert_agg_gpu9
	l1_expert_gpu13 -> l1_expert_agg_gpu9
	l1_expert_gpu14 -> l1_expert_agg_gpu9
	l1_expert_gpu15 -> l1_expert_agg_gpu9
	l1_attn_residual_gpu9 -> l1_final_residual_gpu9
	l1_expert_agg_gpu9 -> l1_final_residual_gpu9
	l1_qkv_gpu10 -> l1_attn_gpu10
	l1_attn_gpu10 -> l1_out_proj_gpu10
	l1_out_proj_gpu10 -> l1_attn_residual_gpu10
	l0_final_residual_gpu10 -> l1_attn_residual_gpu10
	l1_attn_residual_gpu10 -> l1_gate_gpu10
	l1_attn_residual_gpu10 -> l1_token_split_gpu10
	l1_gate_gpu10 -> l1_token_split_gpu10 [style=dashed]
	l1_token_split_gpu10 -> l1_send_gpu10_to_0
	l1_send_gpu10_to_0 -> l1_recv_gpu10_to_0
	l1_recv_gpu10_to_0 -> l1_local_tokens_gpu0
	l1_token_split_gpu10 -> l1_send_gpu10_to_1
	l1_send_gpu10_to_1 -> l1_recv_gpu10_to_1
	l1_recv_gpu10_to_1 -> l1_local_tokens_gpu1
	l1_token_split_gpu10 -> l1_send_gpu10_to_2
	l1_send_gpu10_to_2 -> l1_recv_gpu10_to_2
	l1_recv_gpu10_to_2 -> l1_local_tokens_gpu2
	l1_token_split_gpu10 -> l1_send_gpu10_to_3
	l1_send_gpu10_to_3 -> l1_recv_gpu10_to_3
	l1_recv_gpu10_to_3 -> l1_local_tokens_gpu3
	l1_token_split_gpu10 -> l1_send_gpu10_to_4
	l1_send_gpu10_to_4 -> l1_recv_gpu10_to_4
	l1_recv_gpu10_to_4 -> l1_local_tokens_gpu4
	l1_token_split_gpu10 -> l1_send_gpu10_to_5
	l1_send_gpu10_to_5 -> l1_recv_gpu10_to_5
	l1_recv_gpu10_to_5 -> l1_local_tokens_gpu5
	l1_token_split_gpu10 -> l1_send_gpu10_to_6
	l1_send_gpu10_to_6 -> l1_recv_gpu10_to_6
	l1_recv_gpu10_to_6 -> l1_local_tokens_gpu6
	l1_token_split_gpu10 -> l1_send_gpu10_to_7
	l1_send_gpu10_to_7 -> l1_recv_gpu10_to_7
	l1_recv_gpu10_to_7 -> l1_local_tokens_gpu7
	l1_token_split_gpu10 -> l1_send_gpu10_to_8
	l1_send_gpu10_to_8 -> l1_recv_gpu10_to_8
	l1_recv_gpu10_to_8 -> l1_local_tokens_gpu8
	l1_token_split_gpu10 -> l1_send_gpu10_to_9
	l1_send_gpu10_to_9 -> l1_recv_gpu10_to_9
	l1_recv_gpu10_to_9 -> l1_local_tokens_gpu9
	l1_token_split_gpu10 -> l1_send_gpu10_to_11
	l1_send_gpu10_to_11 -> l1_recv_gpu10_to_11
	l1_recv_gpu10_to_11 -> l1_local_tokens_gpu11
	l1_token_split_gpu10 -> l1_send_gpu10_to_12
	l1_send_gpu10_to_12 -> l1_recv_gpu10_to_12
	l1_recv_gpu10_to_12 -> l1_local_tokens_gpu12
	l1_token_split_gpu10 -> l1_send_gpu10_to_13
	l1_send_gpu10_to_13 -> l1_recv_gpu10_to_13
	l1_recv_gpu10_to_13 -> l1_local_tokens_gpu13
	l1_token_split_gpu10 -> l1_send_gpu10_to_14
	l1_send_gpu10_to_14 -> l1_recv_gpu10_to_14
	l1_recv_gpu10_to_14 -> l1_local_tokens_gpu14
	l1_token_split_gpu10 -> l1_send_gpu10_to_15
	l1_send_gpu10_to_15 -> l1_recv_gpu10_to_15
	l1_recv_gpu10_to_15 -> l1_local_tokens_gpu15
	l1_token_split_gpu10 -> l1_local_tokens_gpu10
	l1_local_tokens_gpu10 -> l1_expert_gpu10
	l1_expert_gpu0 -> l1_expert_agg_gpu10
	l1_expert_gpu1 -> l1_expert_agg_gpu10
	l1_expert_gpu2 -> l1_expert_agg_gpu10
	l1_expert_gpu3 -> l1_expert_agg_gpu10
	l1_expert_gpu4 -> l1_expert_agg_gpu10
	l1_expert_gpu5 -> l1_expert_agg_gpu10
	l1_expert_gpu6 -> l1_expert_agg_gpu10
	l1_expert_gpu7 -> l1_expert_agg_gpu10
	l1_expert_gpu8 -> l1_expert_agg_gpu10
	l1_expert_gpu9 -> l1_expert_agg_gpu10
	l1_expert_gpu10 -> l1_expert_agg_gpu10
	l1_expert_gpu11 -> l1_expert_agg_gpu10
	l1_expert_gpu12 -> l1_expert_agg_gpu10
	l1_expert_gpu13 -> l1_expert_agg_gpu10
	l1_expert_gpu14 -> l1_expert_agg_gpu10
	l1_expert_gpu15 -> l1_expert_agg_gpu10
	l1_attn_residual_gpu10 -> l1_final_residual_gpu10
	l1_expert_agg_gpu10 -> l1_final_residual_gpu10
	l1_qkv_gpu11 -> l1_attn_gpu11
	l1_attn_gpu11 -> l1_out_proj_gpu11
	l1_out_proj_gpu11 -> l1_attn_residual_gpu11
	l0_final_residual_gpu11 -> l1_attn_residual_gpu11
	l1_attn_residual_gpu11 -> l1_gate_gpu11
	l1_attn_residual_gpu11 -> l1_token_split_gpu11
	l1_gate_gpu11 -> l1_token_split_gpu11 [style=dashed]
	l1_token_split_gpu11 -> l1_send_gpu11_to_0
	l1_send_gpu11_to_0 -> l1_recv_gpu11_to_0
	l1_recv_gpu11_to_0 -> l1_local_tokens_gpu0
	l1_token_split_gpu11 -> l1_send_gpu11_to_1
	l1_send_gpu11_to_1 -> l1_recv_gpu11_to_1
	l1_recv_gpu11_to_1 -> l1_local_tokens_gpu1
	l1_token_split_gpu11 -> l1_send_gpu11_to_2
	l1_send_gpu11_to_2 -> l1_recv_gpu11_to_2
	l1_recv_gpu11_to_2 -> l1_local_tokens_gpu2
	l1_token_split_gpu11 -> l1_send_gpu11_to_3
	l1_send_gpu11_to_3 -> l1_recv_gpu11_to_3
	l1_recv_gpu11_to_3 -> l1_local_tokens_gpu3
	l1_token_split_gpu11 -> l1_send_gpu11_to_4
	l1_send_gpu11_to_4 -> l1_recv_gpu11_to_4
	l1_recv_gpu11_to_4 -> l1_local_tokens_gpu4
	l1_token_split_gpu11 -> l1_send_gpu11_to_5
	l1_send_gpu11_to_5 -> l1_recv_gpu11_to_5
	l1_recv_gpu11_to_5 -> l1_local_tokens_gpu5
	l1_token_split_gpu11 -> l1_send_gpu11_to_6
	l1_send_gpu11_to_6 -> l1_recv_gpu11_to_6
	l1_recv_gpu11_to_6 -> l1_local_tokens_gpu6
	l1_token_split_gpu11 -> l1_send_gpu11_to_7
	l1_send_gpu11_to_7 -> l1_recv_gpu11_to_7
	l1_recv_gpu11_to_7 -> l1_local_tokens_gpu7
	l1_token_split_gpu11 -> l1_send_gpu11_to_8
	l1_send_gpu11_to_8 -> l1_recv_gpu11_to_8
	l1_recv_gpu11_to_8 -> l1_local_tokens_gpu8
	l1_token_split_gpu11 -> l1_send_gpu11_to_9
	l1_send_gpu11_to_9 -> l1_recv_gpu11_to_9
	l1_recv_gpu11_to_9 -> l1_local_tokens_gpu9
	l1_token_split_gpu11 -> l1_send_gpu11_to_10
	l1_send_gpu11_to_10 -> l1_recv_gpu11_to_10
	l1_recv_gpu11_to_10 -> l1_local_tokens_gpu10
	l1_token_split_gpu11 -> l1_send_gpu11_to_12
	l1_send_gpu11_to_12 -> l1_recv_gpu11_to_12
	l1_recv_gpu11_to_12 -> l1_local_tokens_gpu12
	l1_token_split_gpu11 -> l1_send_gpu11_to_13
	l1_send_gpu11_to_13 -> l1_recv_gpu11_to_13
	l1_recv_gpu11_to_13 -> l1_local_tokens_gpu13
	l1_token_split_gpu11 -> l1_send_gpu11_to_14
	l1_send_gpu11_to_14 -> l1_recv_gpu11_to_14
	l1_recv_gpu11_to_14 -> l1_local_tokens_gpu14
	l1_token_split_gpu11 -> l1_send_gpu11_to_15
	l1_send_gpu11_to_15 -> l1_recv_gpu11_to_15
	l1_recv_gpu11_to_15 -> l1_local_tokens_gpu15
	l1_token_split_gpu11 -> l1_local_tokens_gpu11
	l1_local_tokens_gpu11 -> l1_expert_gpu11
	l1_expert_gpu0 -> l1_expert_agg_gpu11
	l1_expert_gpu1 -> l1_expert_agg_gpu11
	l1_expert_gpu2 -> l1_expert_agg_gpu11
	l1_expert_gpu3 -> l1_expert_agg_gpu11
	l1_expert_gpu4 -> l1_expert_agg_gpu11
	l1_expert_gpu5 -> l1_expert_agg_gpu11
	l1_expert_gpu6 -> l1_expert_agg_gpu11
	l1_expert_gpu7 -> l1_expert_agg_gpu11
	l1_expert_gpu8 -> l1_expert_agg_gpu11
	l1_expert_gpu9 -> l1_expert_agg_gpu11
	l1_expert_gpu10 -> l1_expert_agg_gpu11
	l1_expert_gpu11 -> l1_expert_agg_gpu11
	l1_expert_gpu12 -> l1_expert_agg_gpu11
	l1_expert_gpu13 -> l1_expert_agg_gpu11
	l1_expert_gpu14 -> l1_expert_agg_gpu11
	l1_expert_gpu15 -> l1_expert_agg_gpu11
	l1_attn_residual_gpu11 -> l1_final_residual_gpu11
	l1_expert_agg_gpu11 -> l1_final_residual_gpu11
	l1_qkv_gpu12 -> l1_attn_gpu12
	l1_attn_gpu12 -> l1_out_proj_gpu12
	l1_out_proj_gpu12 -> l1_attn_residual_gpu12
	l0_final_residual_gpu12 -> l1_attn_residual_gpu12
	l1_attn_residual_gpu12 -> l1_gate_gpu12
	l1_attn_residual_gpu12 -> l1_token_split_gpu12
	l1_gate_gpu12 -> l1_token_split_gpu12 [style=dashed]
	l1_token_split_gpu12 -> l1_send_gpu12_to_0
	l1_send_gpu12_to_0 -> l1_recv_gpu12_to_0
	l1_recv_gpu12_to_0 -> l1_local_tokens_gpu0
	l1_token_split_gpu12 -> l1_send_gpu12_to_1
	l1_send_gpu12_to_1 -> l1_recv_gpu12_to_1
	l1_recv_gpu12_to_1 -> l1_local_tokens_gpu1
	l1_token_split_gpu12 -> l1_send_gpu12_to_2
	l1_send_gpu12_to_2 -> l1_recv_gpu12_to_2
	l1_recv_gpu12_to_2 -> l1_local_tokens_gpu2
	l1_token_split_gpu12 -> l1_send_gpu12_to_3
	l1_send_gpu12_to_3 -> l1_recv_gpu12_to_3
	l1_recv_gpu12_to_3 -> l1_local_tokens_gpu3
	l1_token_split_gpu12 -> l1_send_gpu12_to_4
	l1_send_gpu12_to_4 -> l1_recv_gpu12_to_4
	l1_recv_gpu12_to_4 -> l1_local_tokens_gpu4
	l1_token_split_gpu12 -> l1_send_gpu12_to_5
	l1_send_gpu12_to_5 -> l1_recv_gpu12_to_5
	l1_recv_gpu12_to_5 -> l1_local_tokens_gpu5
	l1_token_split_gpu12 -> l1_send_gpu12_to_6
	l1_send_gpu12_to_6 -> l1_recv_gpu12_to_6
	l1_recv_gpu12_to_6 -> l1_local_tokens_gpu6
	l1_token_split_gpu12 -> l1_send_gpu12_to_7
	l1_send_gpu12_to_7 -> l1_recv_gpu12_to_7
	l1_recv_gpu12_to_7 -> l1_local_tokens_gpu7
	l1_token_split_gpu12 -> l1_send_gpu12_to_8
	l1_send_gpu12_to_8 -> l1_recv_gpu12_to_8
	l1_recv_gpu12_to_8 -> l1_local_tokens_gpu8
	l1_token_split_gpu12 -> l1_send_gpu12_to_9
	l1_send_gpu12_to_9 -> l1_recv_gpu12_to_9
	l1_recv_gpu12_to_9 -> l1_local_tokens_gpu9
	l1_token_split_gpu12 -> l1_send_gpu12_to_10
	l1_send_gpu12_to_10 -> l1_recv_gpu12_to_10
	l1_recv_gpu12_to_10 -> l1_local_tokens_gpu10
	l1_token_split_gpu12 -> l1_send_gpu12_to_11
	l1_send_gpu12_to_11 -> l1_recv_gpu12_to_11
	l1_recv_gpu12_to_11 -> l1_local_tokens_gpu11
	l1_token_split_gpu12 -> l1_send_gpu12_to_13
	l1_send_gpu12_to_13 -> l1_recv_gpu12_to_13
	l1_recv_gpu12_to_13 -> l1_local_tokens_gpu13
	l1_token_split_gpu12 -> l1_send_gpu12_to_14
	l1_send_gpu12_to_14 -> l1_recv_gpu12_to_14
	l1_recv_gpu12_to_14 -> l1_local_tokens_gpu14
	l1_token_split_gpu12 -> l1_send_gpu12_to_15
	l1_send_gpu12_to_15 -> l1_recv_gpu12_to_15
	l1_recv_gpu12_to_15 -> l1_local_tokens_gpu15
	l1_token_split_gpu12 -> l1_local_tokens_gpu12
	l1_local_tokens_gpu12 -> l1_expert_gpu12
	l1_expert_gpu0 -> l1_expert_agg_gpu12
	l1_expert_gpu1 -> l1_expert_agg_gpu12
	l1_expert_gpu2 -> l1_expert_agg_gpu12
	l1_expert_gpu3 -> l1_expert_agg_gpu12
	l1_expert_gpu4 -> l1_expert_agg_gpu12
	l1_expert_gpu5 -> l1_expert_agg_gpu12
	l1_expert_gpu6 -> l1_expert_agg_gpu12
	l1_expert_gpu7 -> l1_expert_agg_gpu12
	l1_expert_gpu8 -> l1_expert_agg_gpu12
	l1_expert_gpu9 -> l1_expert_agg_gpu12
	l1_expert_gpu10 -> l1_expert_agg_gpu12
	l1_expert_gpu11 -> l1_expert_agg_gpu12
	l1_expert_gpu12 -> l1_expert_agg_gpu12
	l1_expert_gpu13 -> l1_expert_agg_gpu12
	l1_expert_gpu14 -> l1_expert_agg_gpu12
	l1_expert_gpu15 -> l1_expert_agg_gpu12
	l1_attn_residual_gpu12 -> l1_final_residual_gpu12
	l1_expert_agg_gpu12 -> l1_final_residual_gpu12
	l1_qkv_gpu13 -> l1_attn_gpu13
	l1_attn_gpu13 -> l1_out_proj_gpu13
	l1_out_proj_gpu13 -> l1_attn_residual_gpu13
	l0_final_residual_gpu13 -> l1_attn_residual_gpu13
	l1_attn_residual_gpu13 -> l1_gate_gpu13
	l1_attn_residual_gpu13 -> l1_token_split_gpu13
	l1_gate_gpu13 -> l1_token_split_gpu13 [style=dashed]
	l1_token_split_gpu13 -> l1_send_gpu13_to_0
	l1_send_gpu13_to_0 -> l1_recv_gpu13_to_0
	l1_recv_gpu13_to_0 -> l1_local_tokens_gpu0
	l1_token_split_gpu13 -> l1_send_gpu13_to_1
	l1_send_gpu13_to_1 -> l1_recv_gpu13_to_1
	l1_recv_gpu13_to_1 -> l1_local_tokens_gpu1
	l1_token_split_gpu13 -> l1_send_gpu13_to_2
	l1_send_gpu13_to_2 -> l1_recv_gpu13_to_2
	l1_recv_gpu13_to_2 -> l1_local_tokens_gpu2
	l1_token_split_gpu13 -> l1_send_gpu13_to_3
	l1_send_gpu13_to_3 -> l1_recv_gpu13_to_3
	l1_recv_gpu13_to_3 -> l1_local_tokens_gpu3
	l1_token_split_gpu13 -> l1_send_gpu13_to_4
	l1_send_gpu13_to_4 -> l1_recv_gpu13_to_4
	l1_recv_gpu13_to_4 -> l1_local_tokens_gpu4
	l1_token_split_gpu13 -> l1_send_gpu13_to_5
	l1_send_gpu13_to_5 -> l1_recv_gpu13_to_5
	l1_recv_gpu13_to_5 -> l1_local_tokens_gpu5
	l1_token_split_gpu13 -> l1_send_gpu13_to_6
	l1_send_gpu13_to_6 -> l1_recv_gpu13_to_6
	l1_recv_gpu13_to_6 -> l1_local_tokens_gpu6
	l1_token_split_gpu13 -> l1_send_gpu13_to_7
	l1_send_gpu13_to_7 -> l1_recv_gpu13_to_7
	l1_recv_gpu13_to_7 -> l1_local_tokens_gpu7
	l1_token_split_gpu13 -> l1_send_gpu13_to_8
	l1_send_gpu13_to_8 -> l1_recv_gpu13_to_8
	l1_recv_gpu13_to_8 -> l1_local_tokens_gpu8
	l1_token_split_gpu13 -> l1_send_gpu13_to_9
	l1_send_gpu13_to_9 -> l1_recv_gpu13_to_9
	l1_recv_gpu13_to_9 -> l1_local_tokens_gpu9
	l1_token_split_gpu13 -> l1_send_gpu13_to_10
	l1_send_gpu13_to_10 -> l1_recv_gpu13_to_10
	l1_recv_gpu13_to_10 -> l1_local_tokens_gpu10
	l1_token_split_gpu13 -> l1_send_gpu13_to_11
	l1_send_gpu13_to_11 -> l1_recv_gpu13_to_11
	l1_recv_gpu13_to_11 -> l1_local_tokens_gpu11
	l1_token_split_gpu13 -> l1_send_gpu13_to_12
	l1_send_gpu13_to_12 -> l1_recv_gpu13_to_12
	l1_recv_gpu13_to_12 -> l1_local_tokens_gpu12
	l1_token_split_gpu13 -> l1_send_gpu13_to_14
	l1_send_gpu13_to_14 -> l1_recv_gpu13_to_14
	l1_recv_gpu13_to_14 -> l1_local_tokens_gpu14
	l1_token_split_gpu13 -> l1_send_gpu13_to_15
	l1_send_gpu13_to_15 -> l1_recv_gpu13_to_15
	l1_recv_gpu13_to_15 -> l1_local_tokens_gpu15
	l1_token_split_gpu13 -> l1_local_tokens_gpu13
	l1_local_tokens_gpu13 -> l1_expert_gpu13
	l1_expert_gpu0 -> l1_expert_agg_gpu13
	l1_expert_gpu1 -> l1_expert_agg_gpu13
	l1_expert_gpu2 -> l1_expert_agg_gpu13
	l1_expert_gpu3 -> l1_expert_agg_gpu13
	l1_expert_gpu4 -> l1_expert_agg_gpu13
	l1_expert_gpu5 -> l1_expert_agg_gpu13
	l1_expert_gpu6 -> l1_expert_agg_gpu13
	l1_expert_gpu7 -> l1_expert_agg_gpu13
	l1_expert_gpu8 -> l1_expert_agg_gpu13
	l1_expert_gpu9 -> l1_expert_agg_gpu13
	l1_expert_gpu10 -> l1_expert_agg_gpu13
	l1_expert_gpu11 -> l1_expert_agg_gpu13
	l1_expert_gpu12 -> l1_expert_agg_gpu13
	l1_expert_gpu13 -> l1_expert_agg_gpu13
	l1_expert_gpu14 -> l1_expert_agg_gpu13
	l1_expert_gpu15 -> l1_expert_agg_gpu13
	l1_attn_residual_gpu13 -> l1_final_residual_gpu13
	l1_expert_agg_gpu13 -> l1_final_residual_gpu13
	l1_qkv_gpu14 -> l1_attn_gpu14
	l1_attn_gpu14 -> l1_out_proj_gpu14
	l1_out_proj_gpu14 -> l1_attn_residual_gpu14
	l0_final_residual_gpu14 -> l1_attn_residual_gpu14
	l1_attn_residual_gpu14 -> l1_gate_gpu14
	l1_attn_residual_gpu14 -> l1_token_split_gpu14
	l1_gate_gpu14 -> l1_token_split_gpu14 [style=dashed]
	l1_token_split_gpu14 -> l1_send_gpu14_to_0
	l1_send_gpu14_to_0 -> l1_recv_gpu14_to_0
	l1_recv_gpu14_to_0 -> l1_local_tokens_gpu0
	l1_token_split_gpu14 -> l1_send_gpu14_to_1
	l1_send_gpu14_to_1 -> l1_recv_gpu14_to_1
	l1_recv_gpu14_to_1 -> l1_local_tokens_gpu1
	l1_token_split_gpu14 -> l1_send_gpu14_to_2
	l1_send_gpu14_to_2 -> l1_recv_gpu14_to_2
	l1_recv_gpu14_to_2 -> l1_local_tokens_gpu2
	l1_token_split_gpu14 -> l1_send_gpu14_to_3
	l1_send_gpu14_to_3 -> l1_recv_gpu14_to_3
	l1_recv_gpu14_to_3 -> l1_local_tokens_gpu3
	l1_token_split_gpu14 -> l1_send_gpu14_to_4
	l1_send_gpu14_to_4 -> l1_recv_gpu14_to_4
	l1_recv_gpu14_to_4 -> l1_local_tokens_gpu4
	l1_token_split_gpu14 -> l1_send_gpu14_to_5
	l1_send_gpu14_to_5 -> l1_recv_gpu14_to_5
	l1_recv_gpu14_to_5 -> l1_local_tokens_gpu5
	l1_token_split_gpu14 -> l1_send_gpu14_to_6
	l1_send_gpu14_to_6 -> l1_recv_gpu14_to_6
	l1_recv_gpu14_to_6 -> l1_local_tokens_gpu6
	l1_token_split_gpu14 -> l1_send_gpu14_to_7
	l1_send_gpu14_to_7 -> l1_recv_gpu14_to_7
	l1_recv_gpu14_to_7 -> l1_local_tokens_gpu7
	l1_token_split_gpu14 -> l1_send_gpu14_to_8
	l1_send_gpu14_to_8 -> l1_recv_gpu14_to_8
	l1_recv_gpu14_to_8 -> l1_local_tokens_gpu8
	l1_token_split_gpu14 -> l1_send_gpu14_to_9
	l1_send_gpu14_to_9 -> l1_recv_gpu14_to_9
	l1_recv_gpu14_to_9 -> l1_local_tokens_gpu9
	l1_token_split_gpu14 -> l1_send_gpu14_to_10
	l1_send_gpu14_to_10 -> l1_recv_gpu14_to_10
	l1_recv_gpu14_to_10 -> l1_local_tokens_gpu10
	l1_token_split_gpu14 -> l1_send_gpu14_to_11
	l1_send_gpu14_to_11 -> l1_recv_gpu14_to_11
	l1_recv_gpu14_to_11 -> l1_local_tokens_gpu11
	l1_token_split_gpu14 -> l1_send_gpu14_to_12
	l1_send_gpu14_to_12 -> l1_recv_gpu14_to_12
	l1_recv_gpu14_to_12 -> l1_local_tokens_gpu12
	l1_token_split_gpu14 -> l1_send_gpu14_to_13
	l1_send_gpu14_to_13 -> l1_recv_gpu14_to_13
	l1_recv_gpu14_to_13 -> l1_local_tokens_gpu13
	l1_token_split_gpu14 -> l1_send_gpu14_to_15
	l1_send_gpu14_to_15 -> l1_recv_gpu14_to_15
	l1_recv_gpu14_to_15 -> l1_local_tokens_gpu15
	l1_token_split_gpu14 -> l1_local_tokens_gpu14
	l1_local_tokens_gpu14 -> l1_expert_gpu14
	l1_expert_gpu0 -> l1_expert_agg_gpu14
	l1_expert_gpu1 -> l1_expert_agg_gpu14
	l1_expert_gpu2 -> l1_expert_agg_gpu14
	l1_expert_gpu3 -> l1_expert_agg_gpu14
	l1_expert_gpu4 -> l1_expert_agg_gpu14
	l1_expert_gpu5 -> l1_expert_agg_gpu14
	l1_expert_gpu6 -> l1_expert_agg_gpu14
	l1_expert_gpu7 -> l1_expert_agg_gpu14
	l1_expert_gpu8 -> l1_expert_agg_gpu14
	l1_expert_gpu9 -> l1_expert_agg_gpu14
	l1_expert_gpu10 -> l1_expert_agg_gpu14
	l1_expert_gpu11 -> l1_expert_agg_gpu14
	l1_expert_gpu12 -> l1_expert_agg_gpu14
	l1_expert_gpu13 -> l1_expert_agg_gpu14
	l1_expert_gpu14 -> l1_expert_agg_gpu14
	l1_expert_gpu15 -> l1_expert_agg_gpu14
	l1_attn_residual_gpu14 -> l1_final_residual_gpu14
	l1_expert_agg_gpu14 -> l1_final_residual_gpu14
	l1_qkv_gpu15 -> l1_attn_gpu15
	l1_attn_gpu15 -> l1_out_proj_gpu15
	l1_out_proj_gpu15 -> l1_attn_residual_gpu15
	l0_final_residual_gpu15 -> l1_attn_residual_gpu15
	l1_attn_residual_gpu15 -> l1_gate_gpu15
	l1_attn_residual_gpu15 -> l1_token_split_gpu15
	l1_gate_gpu15 -> l1_token_split_gpu15 [style=dashed]
	l1_token_split_gpu15 -> l1_send_gpu15_to_0
	l1_send_gpu15_to_0 -> l1_recv_gpu15_to_0
	l1_recv_gpu15_to_0 -> l1_local_tokens_gpu0
	l1_token_split_gpu15 -> l1_send_gpu15_to_1
	l1_send_gpu15_to_1 -> l1_recv_gpu15_to_1
	l1_recv_gpu15_to_1 -> l1_local_tokens_gpu1
	l1_token_split_gpu15 -> l1_send_gpu15_to_2
	l1_send_gpu15_to_2 -> l1_recv_gpu15_to_2
	l1_recv_gpu15_to_2 -> l1_local_tokens_gpu2
	l1_token_split_gpu15 -> l1_send_gpu15_to_3
	l1_send_gpu15_to_3 -> l1_recv_gpu15_to_3
	l1_recv_gpu15_to_3 -> l1_local_tokens_gpu3
	l1_token_split_gpu15 -> l1_send_gpu15_to_4
	l1_send_gpu15_to_4 -> l1_recv_gpu15_to_4
	l1_recv_gpu15_to_4 -> l1_local_tokens_gpu4
	l1_token_split_gpu15 -> l1_send_gpu15_to_5
	l1_send_gpu15_to_5 -> l1_recv_gpu15_to_5
	l1_recv_gpu15_to_5 -> l1_local_tokens_gpu5
	l1_token_split_gpu15 -> l1_send_gpu15_to_6
	l1_send_gpu15_to_6 -> l1_recv_gpu15_to_6
	l1_recv_gpu15_to_6 -> l1_local_tokens_gpu6
	l1_token_split_gpu15 -> l1_send_gpu15_to_7
	l1_send_gpu15_to_7 -> l1_recv_gpu15_to_7
	l1_recv_gpu15_to_7 -> l1_local_tokens_gpu7
	l1_token_split_gpu15 -> l1_send_gpu15_to_8
	l1_send_gpu15_to_8 -> l1_recv_gpu15_to_8
	l1_recv_gpu15_to_8 -> l1_local_tokens_gpu8
	l1_token_split_gpu15 -> l1_send_gpu15_to_9
	l1_send_gpu15_to_9 -> l1_recv_gpu15_to_9
	l1_recv_gpu15_to_9 -> l1_local_tokens_gpu9
	l1_token_split_gpu15 -> l1_send_gpu15_to_10
	l1_send_gpu15_to_10 -> l1_recv_gpu15_to_10
	l1_recv_gpu15_to_10 -> l1_local_tokens_gpu10
	l1_token_split_gpu15 -> l1_send_gpu15_to_11
	l1_send_gpu15_to_11 -> l1_recv_gpu15_to_11
	l1_recv_gpu15_to_11 -> l1_local_tokens_gpu11
	l1_token_split_gpu15 -> l1_send_gpu15_to_12
	l1_send_gpu15_to_12 -> l1_recv_gpu15_to_12
	l1_recv_gpu15_to_12 -> l1_local_tokens_gpu12
	l1_token_split_gpu15 -> l1_send_gpu15_to_13
	l1_send_gpu15_to_13 -> l1_recv_gpu15_to_13
	l1_recv_gpu15_to_13 -> l1_local_tokens_gpu13
	l1_token_split_gpu15 -> l1_send_gpu15_to_14
	l1_send_gpu15_to_14 -> l1_recv_gpu15_to_14
	l1_recv_gpu15_to_14 -> l1_local_tokens_gpu14
	l1_token_split_gpu15 -> l1_local_tokens_gpu15
	l1_local_tokens_gpu15 -> l1_expert_gpu15
	l1_expert_gpu0 -> l1_expert_agg_gpu15
	l1_expert_gpu1 -> l1_expert_agg_gpu15
	l1_expert_gpu2 -> l1_expert_agg_gpu15
	l1_expert_gpu3 -> l1_expert_agg_gpu15
	l1_expert_gpu4 -> l1_expert_agg_gpu15
	l1_expert_gpu5 -> l1_expert_agg_gpu15
	l1_expert_gpu6 -> l1_expert_agg_gpu15
	l1_expert_gpu7 -> l1_expert_agg_gpu15
	l1_expert_gpu8 -> l1_expert_agg_gpu15
	l1_expert_gpu9 -> l1_expert_agg_gpu15
	l1_expert_gpu10 -> l1_expert_agg_gpu15
	l1_expert_gpu11 -> l1_expert_agg_gpu15
	l1_expert_gpu12 -> l1_expert_agg_gpu15
	l1_expert_gpu13 -> l1_expert_agg_gpu15
	l1_expert_gpu14 -> l1_expert_agg_gpu15
	l1_expert_gpu15 -> l1_expert_agg_gpu15
	l1_attn_residual_gpu15 -> l1_final_residual_gpu15
	l1_expert_agg_gpu15 -> l1_final_residual_gpu15
	l1_final_residual_gpu0 -> l2_qkv_gpu0
	l1_final_residual_gpu1 -> l2_qkv_gpu1
	l1_final_residual_gpu2 -> l2_qkv_gpu2
	l1_final_residual_gpu3 -> l2_qkv_gpu3
	l1_final_residual_gpu4 -> l2_qkv_gpu4
	l1_final_residual_gpu5 -> l2_qkv_gpu5
	l1_final_residual_gpu6 -> l2_qkv_gpu6
	l1_final_residual_gpu7 -> l2_qkv_gpu7
	l1_final_residual_gpu8 -> l2_qkv_gpu8
	l1_final_residual_gpu9 -> l2_qkv_gpu9
	l1_final_residual_gpu10 -> l2_qkv_gpu10
	l1_final_residual_gpu11 -> l2_qkv_gpu11
	l1_final_residual_gpu12 -> l2_qkv_gpu12
	l1_final_residual_gpu13 -> l2_qkv_gpu13
	l1_final_residual_gpu14 -> l2_qkv_gpu14
	l1_final_residual_gpu15 -> l2_qkv_gpu15
	l2_qkv_gpu0 -> l2_attn_gpu0
	l2_attn_gpu0 -> l2_out_proj_gpu0
	l2_out_proj_gpu0 -> l2_attn_residual_gpu0
	l1_final_residual_gpu0 -> l2_attn_residual_gpu0
	l2_attn_residual_gpu0 -> l2_gate_gpu0
	l2_attn_residual_gpu0 -> l2_token_split_gpu0
	l2_gate_gpu0 -> l2_token_split_gpu0 [style=dashed]
	l2_token_split_gpu0 -> l2_send_gpu0_to_1
	l2_send_gpu0_to_1 -> l2_recv_gpu0_to_1
	l2_recv_gpu0_to_1 -> l2_local_tokens_gpu1
	l2_token_split_gpu0 -> l2_send_gpu0_to_2
	l2_send_gpu0_to_2 -> l2_recv_gpu0_to_2
	l2_recv_gpu0_to_2 -> l2_local_tokens_gpu2
	l2_token_split_gpu0 -> l2_send_gpu0_to_3
	l2_send_gpu0_to_3 -> l2_recv_gpu0_to_3
	l2_recv_gpu0_to_3 -> l2_local_tokens_gpu3
	l2_token_split_gpu0 -> l2_send_gpu0_to_4
	l2_send_gpu0_to_4 -> l2_recv_gpu0_to_4
	l2_recv_gpu0_to_4 -> l2_local_tokens_gpu4
	l2_token_split_gpu0 -> l2_send_gpu0_to_5
	l2_send_gpu0_to_5 -> l2_recv_gpu0_to_5
	l2_recv_gpu0_to_5 -> l2_local_tokens_gpu5
	l2_token_split_gpu0 -> l2_send_gpu0_to_6
	l2_send_gpu0_to_6 -> l2_recv_gpu0_to_6
	l2_recv_gpu0_to_6 -> l2_local_tokens_gpu6
	l2_token_split_gpu0 -> l2_send_gpu0_to_7
	l2_send_gpu0_to_7 -> l2_recv_gpu0_to_7
	l2_recv_gpu0_to_7 -> l2_local_tokens_gpu7
	l2_token_split_gpu0 -> l2_send_gpu0_to_8
	l2_send_gpu0_to_8 -> l2_recv_gpu0_to_8
	l2_recv_gpu0_to_8 -> l2_local_tokens_gpu8
	l2_token_split_gpu0 -> l2_send_gpu0_to_9
	l2_send_gpu0_to_9 -> l2_recv_gpu0_to_9
	l2_recv_gpu0_to_9 -> l2_local_tokens_gpu9
	l2_token_split_gpu0 -> l2_send_gpu0_to_10
	l2_send_gpu0_to_10 -> l2_recv_gpu0_to_10
	l2_recv_gpu0_to_10 -> l2_local_tokens_gpu10
	l2_token_split_gpu0 -> l2_send_gpu0_to_11
	l2_send_gpu0_to_11 -> l2_recv_gpu0_to_11
	l2_recv_gpu0_to_11 -> l2_local_tokens_gpu11
	l2_token_split_gpu0 -> l2_send_gpu0_to_12
	l2_send_gpu0_to_12 -> l2_recv_gpu0_to_12
	l2_recv_gpu0_to_12 -> l2_local_tokens_gpu12
	l2_token_split_gpu0 -> l2_send_gpu0_to_13
	l2_send_gpu0_to_13 -> l2_recv_gpu0_to_13
	l2_recv_gpu0_to_13 -> l2_local_tokens_gpu13
	l2_token_split_gpu0 -> l2_send_gpu0_to_14
	l2_send_gpu0_to_14 -> l2_recv_gpu0_to_14
	l2_recv_gpu0_to_14 -> l2_local_tokens_gpu14
	l2_token_split_gpu0 -> l2_send_gpu0_to_15
	l2_send_gpu0_to_15 -> l2_recv_gpu0_to_15
	l2_recv_gpu0_to_15 -> l2_local_tokens_gpu15
	l2_token_split_gpu0 -> l2_local_tokens_gpu0
	l2_local_tokens_gpu0 -> l2_expert_gpu0
	l2_expert_gpu0 -> l2_expert_agg_gpu0
	l2_expert_gpu1 -> l2_expert_agg_gpu0
	l2_expert_gpu2 -> l2_expert_agg_gpu0
	l2_expert_gpu3 -> l2_expert_agg_gpu0
	l2_expert_gpu4 -> l2_expert_agg_gpu0
	l2_expert_gpu5 -> l2_expert_agg_gpu0
	l2_expert_gpu6 -> l2_expert_agg_gpu0
	l2_expert_gpu7 -> l2_expert_agg_gpu0
	l2_expert_gpu8 -> l2_expert_agg_gpu0
	l2_expert_gpu9 -> l2_expert_agg_gpu0
	l2_expert_gpu10 -> l2_expert_agg_gpu0
	l2_expert_gpu11 -> l2_expert_agg_gpu0
	l2_expert_gpu12 -> l2_expert_agg_gpu0
	l2_expert_gpu13 -> l2_expert_agg_gpu0
	l2_expert_gpu14 -> l2_expert_agg_gpu0
	l2_expert_gpu15 -> l2_expert_agg_gpu0
	l2_attn_residual_gpu0 -> l2_final_residual_gpu0
	l2_expert_agg_gpu0 -> l2_final_residual_gpu0
	l2_qkv_gpu1 -> l2_attn_gpu1
	l2_attn_gpu1 -> l2_out_proj_gpu1
	l2_out_proj_gpu1 -> l2_attn_residual_gpu1
	l1_final_residual_gpu1 -> l2_attn_residual_gpu1
	l2_attn_residual_gpu1 -> l2_gate_gpu1
	l2_attn_residual_gpu1 -> l2_token_split_gpu1
	l2_gate_gpu1 -> l2_token_split_gpu1 [style=dashed]
	l2_token_split_gpu1 -> l2_send_gpu1_to_0
	l2_send_gpu1_to_0 -> l2_recv_gpu1_to_0
	l2_recv_gpu1_to_0 -> l2_local_tokens_gpu0
	l2_token_split_gpu1 -> l2_send_gpu1_to_2
	l2_send_gpu1_to_2 -> l2_recv_gpu1_to_2
	l2_recv_gpu1_to_2 -> l2_local_tokens_gpu2
	l2_token_split_gpu1 -> l2_send_gpu1_to_3
	l2_send_gpu1_to_3 -> l2_recv_gpu1_to_3
	l2_recv_gpu1_to_3 -> l2_local_tokens_gpu3
	l2_token_split_gpu1 -> l2_send_gpu1_to_4
	l2_send_gpu1_to_4 -> l2_recv_gpu1_to_4
	l2_recv_gpu1_to_4 -> l2_local_tokens_gpu4
	l2_token_split_gpu1 -> l2_send_gpu1_to_5
	l2_send_gpu1_to_5 -> l2_recv_gpu1_to_5
	l2_recv_gpu1_to_5 -> l2_local_tokens_gpu5
	l2_token_split_gpu1 -> l2_send_gpu1_to_6
	l2_send_gpu1_to_6 -> l2_recv_gpu1_to_6
	l2_recv_gpu1_to_6 -> l2_local_tokens_gpu6
	l2_token_split_gpu1 -> l2_send_gpu1_to_7
	l2_send_gpu1_to_7 -> l2_recv_gpu1_to_7
	l2_recv_gpu1_to_7 -> l2_local_tokens_gpu7
	l2_token_split_gpu1 -> l2_send_gpu1_to_8
	l2_send_gpu1_to_8 -> l2_recv_gpu1_to_8
	l2_recv_gpu1_to_8 -> l2_local_tokens_gpu8
	l2_token_split_gpu1 -> l2_send_gpu1_to_9
	l2_send_gpu1_to_9 -> l2_recv_gpu1_to_9
	l2_recv_gpu1_to_9 -> l2_local_tokens_gpu9
	l2_token_split_gpu1 -> l2_send_gpu1_to_10
	l2_send_gpu1_to_10 -> l2_recv_gpu1_to_10
	l2_recv_gpu1_to_10 -> l2_local_tokens_gpu10
	l2_token_split_gpu1 -> l2_send_gpu1_to_11
	l2_send_gpu1_to_11 -> l2_recv_gpu1_to_11
	l2_recv_gpu1_to_11 -> l2_local_tokens_gpu11
	l2_token_split_gpu1 -> l2_send_gpu1_to_12
	l2_send_gpu1_to_12 -> l2_recv_gpu1_to_12
	l2_recv_gpu1_to_12 -> l2_local_tokens_gpu12
	l2_token_split_gpu1 -> l2_send_gpu1_to_13
	l2_send_gpu1_to_13 -> l2_recv_gpu1_to_13
	l2_recv_gpu1_to_13 -> l2_local_tokens_gpu13
	l2_token_split_gpu1 -> l2_send_gpu1_to_14
	l2_send_gpu1_to_14 -> l2_recv_gpu1_to_14
	l2_recv_gpu1_to_14 -> l2_local_tokens_gpu14
	l2_token_split_gpu1 -> l2_send_gpu1_to_15
	l2_send_gpu1_to_15 -> l2_recv_gpu1_to_15
	l2_recv_gpu1_to_15 -> l2_local_tokens_gpu15
	l2_token_split_gpu1 -> l2_local_tokens_gpu1
	l2_local_tokens_gpu1 -> l2_expert_gpu1
	l2_expert_gpu0 -> l2_expert_agg_gpu1
	l2_expert_gpu1 -> l2_expert_agg_gpu1
	l2_expert_gpu2 -> l2_expert_agg_gpu1
	l2_expert_gpu3 -> l2_expert_agg_gpu1
	l2_expert_gpu4 -> l2_expert_agg_gpu1
	l2_expert_gpu5 -> l2_expert_agg_gpu1
	l2_expert_gpu6 -> l2_expert_agg_gpu1
	l2_expert_gpu7 -> l2_expert_agg_gpu1
	l2_expert_gpu8 -> l2_expert_agg_gpu1
	l2_expert_gpu9 -> l2_expert_agg_gpu1
	l2_expert_gpu10 -> l2_expert_agg_gpu1
	l2_expert_gpu11 -> l2_expert_agg_gpu1
	l2_expert_gpu12 -> l2_expert_agg_gpu1
	l2_expert_gpu13 -> l2_expert_agg_gpu1
	l2_expert_gpu14 -> l2_expert_agg_gpu1
	l2_expert_gpu15 -> l2_expert_agg_gpu1
	l2_attn_residual_gpu1 -> l2_final_residual_gpu1
	l2_expert_agg_gpu1 -> l2_final_residual_gpu1
	l2_qkv_gpu2 -> l2_attn_gpu2
	l2_attn_gpu2 -> l2_out_proj_gpu2
	l2_out_proj_gpu2 -> l2_attn_residual_gpu2
	l1_final_residual_gpu2 -> l2_attn_residual_gpu2
	l2_attn_residual_gpu2 -> l2_gate_gpu2
	l2_attn_residual_gpu2 -> l2_token_split_gpu2
	l2_gate_gpu2 -> l2_token_split_gpu2 [style=dashed]
	l2_token_split_gpu2 -> l2_send_gpu2_to_0
	l2_send_gpu2_to_0 -> l2_recv_gpu2_to_0
	l2_recv_gpu2_to_0 -> l2_local_tokens_gpu0
	l2_token_split_gpu2 -> l2_send_gpu2_to_1
	l2_send_gpu2_to_1 -> l2_recv_gpu2_to_1
	l2_recv_gpu2_to_1 -> l2_local_tokens_gpu1
	l2_token_split_gpu2 -> l2_send_gpu2_to_3
	l2_send_gpu2_to_3 -> l2_recv_gpu2_to_3
	l2_recv_gpu2_to_3 -> l2_local_tokens_gpu3
	l2_token_split_gpu2 -> l2_send_gpu2_to_4
	l2_send_gpu2_to_4 -> l2_recv_gpu2_to_4
	l2_recv_gpu2_to_4 -> l2_local_tokens_gpu4
	l2_token_split_gpu2 -> l2_send_gpu2_to_5
	l2_send_gpu2_to_5 -> l2_recv_gpu2_to_5
	l2_recv_gpu2_to_5 -> l2_local_tokens_gpu5
	l2_token_split_gpu2 -> l2_send_gpu2_to_6
	l2_send_gpu2_to_6 -> l2_recv_gpu2_to_6
	l2_recv_gpu2_to_6 -> l2_local_tokens_gpu6
	l2_token_split_gpu2 -> l2_send_gpu2_to_7
	l2_send_gpu2_to_7 -> l2_recv_gpu2_to_7
	l2_recv_gpu2_to_7 -> l2_local_tokens_gpu7
	l2_token_split_gpu2 -> l2_send_gpu2_to_8
	l2_send_gpu2_to_8 -> l2_recv_gpu2_to_8
	l2_recv_gpu2_to_8 -> l2_local_tokens_gpu8
	l2_token_split_gpu2 -> l2_send_gpu2_to_9
	l2_send_gpu2_to_9 -> l2_recv_gpu2_to_9
	l2_recv_gpu2_to_9 -> l2_local_tokens_gpu9
	l2_token_split_gpu2 -> l2_send_gpu2_to_10
	l2_send_gpu2_to_10 -> l2_recv_gpu2_to_10
	l2_recv_gpu2_to_10 -> l2_local_tokens_gpu10
	l2_token_split_gpu2 -> l2_send_gpu2_to_11
	l2_send_gpu2_to_11 -> l2_recv_gpu2_to_11
	l2_recv_gpu2_to_11 -> l2_local_tokens_gpu11
	l2_token_split_gpu2 -> l2_send_gpu2_to_12
	l2_send_gpu2_to_12 -> l2_recv_gpu2_to_12
	l2_recv_gpu2_to_12 -> l2_local_tokens_gpu12
	l2_token_split_gpu2 -> l2_send_gpu2_to_13
	l2_send_gpu2_to_13 -> l2_recv_gpu2_to_13
	l2_recv_gpu2_to_13 -> l2_local_tokens_gpu13
	l2_token_split_gpu2 -> l2_send_gpu2_to_14
	l2_send_gpu2_to_14 -> l2_recv_gpu2_to_14
	l2_recv_gpu2_to_14 -> l2_local_tokens_gpu14
	l2_token_split_gpu2 -> l2_send_gpu2_to_15
	l2_send_gpu2_to_15 -> l2_recv_gpu2_to_15
	l2_recv_gpu2_to_15 -> l2_local_tokens_gpu15
	l2_token_split_gpu2 -> l2_local_tokens_gpu2
	l2_local_tokens_gpu2 -> l2_expert_gpu2
	l2_expert_gpu0 -> l2_expert_agg_gpu2
	l2_expert_gpu1 -> l2_expert_agg_gpu2
	l2_expert_gpu2 -> l2_expert_agg_gpu2
	l2_expert_gpu3 -> l2_expert_agg_gpu2
	l2_expert_gpu4 -> l2_expert_agg_gpu2
	l2_expert_gpu5 -> l2_expert_agg_gpu2
	l2_expert_gpu6 -> l2_expert_agg_gpu2
	l2_expert_gpu7 -> l2_expert_agg_gpu2
	l2_expert_gpu8 -> l2_expert_agg_gpu2
	l2_expert_gpu9 -> l2_expert_agg_gpu2
	l2_expert_gpu10 -> l2_expert_agg_gpu2
	l2_expert_gpu11 -> l2_expert_agg_gpu2
	l2_expert_gpu12 -> l2_expert_agg_gpu2
	l2_expert_gpu13 -> l2_expert_agg_gpu2
	l2_expert_gpu14 -> l2_expert_agg_gpu2
	l2_expert_gpu15 -> l2_expert_agg_gpu2
	l2_attn_residual_gpu2 -> l2_final_residual_gpu2
	l2_expert_agg_gpu2 -> l2_final_residual_gpu2
	l2_qkv_gpu3 -> l2_attn_gpu3
	l2_attn_gpu3 -> l2_out_proj_gpu3
	l2_out_proj_gpu3 -> l2_attn_residual_gpu3
	l1_final_residual_gpu3 -> l2_attn_residual_gpu3
	l2_attn_residual_gpu3 -> l2_gate_gpu3
	l2_attn_residual_gpu3 -> l2_token_split_gpu3
	l2_gate_gpu3 -> l2_token_split_gpu3 [style=dashed]
	l2_token_split_gpu3 -> l2_send_gpu3_to_0
	l2_send_gpu3_to_0 -> l2_recv_gpu3_to_0
	l2_recv_gpu3_to_0 -> l2_local_tokens_gpu0
	l2_token_split_gpu3 -> l2_send_gpu3_to_1
	l2_send_gpu3_to_1 -> l2_recv_gpu3_to_1
	l2_recv_gpu3_to_1 -> l2_local_tokens_gpu1
	l2_token_split_gpu3 -> l2_send_gpu3_to_2
	l2_send_gpu3_to_2 -> l2_recv_gpu3_to_2
	l2_recv_gpu3_to_2 -> l2_local_tokens_gpu2
	l2_token_split_gpu3 -> l2_send_gpu3_to_4
	l2_send_gpu3_to_4 -> l2_recv_gpu3_to_4
	l2_recv_gpu3_to_4 -> l2_local_tokens_gpu4
	l2_token_split_gpu3 -> l2_send_gpu3_to_5
	l2_send_gpu3_to_5 -> l2_recv_gpu3_to_5
	l2_recv_gpu3_to_5 -> l2_local_tokens_gpu5
	l2_token_split_gpu3 -> l2_send_gpu3_to_6
	l2_send_gpu3_to_6 -> l2_recv_gpu3_to_6
	l2_recv_gpu3_to_6 -> l2_local_tokens_gpu6
	l2_token_split_gpu3 -> l2_send_gpu3_to_7
	l2_send_gpu3_to_7 -> l2_recv_gpu3_to_7
	l2_recv_gpu3_to_7 -> l2_local_tokens_gpu7
	l2_token_split_gpu3 -> l2_send_gpu3_to_8
	l2_send_gpu3_to_8 -> l2_recv_gpu3_to_8
	l2_recv_gpu3_to_8 -> l2_local_tokens_gpu8
	l2_token_split_gpu3 -> l2_send_gpu3_to_9
	l2_send_gpu3_to_9 -> l2_recv_gpu3_to_9
	l2_recv_gpu3_to_9 -> l2_local_tokens_gpu9
	l2_token_split_gpu3 -> l2_send_gpu3_to_10
	l2_send_gpu3_to_10 -> l2_recv_gpu3_to_10
	l2_recv_gpu3_to_10 -> l2_local_tokens_gpu10
	l2_token_split_gpu3 -> l2_send_gpu3_to_11
	l2_send_gpu3_to_11 -> l2_recv_gpu3_to_11
	l2_recv_gpu3_to_11 -> l2_local_tokens_gpu11
	l2_token_split_gpu3 -> l2_send_gpu3_to_12
	l2_send_gpu3_to_12 -> l2_recv_gpu3_to_12
	l2_recv_gpu3_to_12 -> l2_local_tokens_gpu12
	l2_token_split_gpu3 -> l2_send_gpu3_to_13
	l2_send_gpu3_to_13 -> l2_recv_gpu3_to_13
	l2_recv_gpu3_to_13 -> l2_local_tokens_gpu13
	l2_token_split_gpu3 -> l2_send_gpu3_to_14
	l2_send_gpu3_to_14 -> l2_recv_gpu3_to_14
	l2_recv_gpu3_to_14 -> l2_local_tokens_gpu14
	l2_token_split_gpu3 -> l2_send_gpu3_to_15
	l2_send_gpu3_to_15 -> l2_recv_gpu3_to_15
	l2_recv_gpu3_to_15 -> l2_local_tokens_gpu15
	l2_token_split_gpu3 -> l2_local_tokens_gpu3
	l2_local_tokens_gpu3 -> l2_expert_gpu3
	l2_expert_gpu0 -> l2_expert_agg_gpu3
	l2_expert_gpu1 -> l2_expert_agg_gpu3
	l2_expert_gpu2 -> l2_expert_agg_gpu3
	l2_expert_gpu3 -> l2_expert_agg_gpu3
	l2_expert_gpu4 -> l2_expert_agg_gpu3
	l2_expert_gpu5 -> l2_expert_agg_gpu3
	l2_expert_gpu6 -> l2_expert_agg_gpu3
	l2_expert_gpu7 -> l2_expert_agg_gpu3
	l2_expert_gpu8 -> l2_expert_agg_gpu3
	l2_expert_gpu9 -> l2_expert_agg_gpu3
	l2_expert_gpu10 -> l2_expert_agg_gpu3
	l2_expert_gpu11 -> l2_expert_agg_gpu3
	l2_expert_gpu12 -> l2_expert_agg_gpu3
	l2_expert_gpu13 -> l2_expert_agg_gpu3
	l2_expert_gpu14 -> l2_expert_agg_gpu3
	l2_expert_gpu15 -> l2_expert_agg_gpu3
	l2_attn_residual_gpu3 -> l2_final_residual_gpu3
	l2_expert_agg_gpu3 -> l2_final_residual_gpu3
	l2_qkv_gpu4 -> l2_attn_gpu4
	l2_attn_gpu4 -> l2_out_proj_gpu4
	l2_out_proj_gpu4 -> l2_attn_residual_gpu4
	l1_final_residual_gpu4 -> l2_attn_residual_gpu4
	l2_attn_residual_gpu4 -> l2_gate_gpu4
	l2_attn_residual_gpu4 -> l2_token_split_gpu4
	l2_gate_gpu4 -> l2_token_split_gpu4 [style=dashed]
	l2_token_split_gpu4 -> l2_send_gpu4_to_0
	l2_send_gpu4_to_0 -> l2_recv_gpu4_to_0
	l2_recv_gpu4_to_0 -> l2_local_tokens_gpu0
	l2_token_split_gpu4 -> l2_send_gpu4_to_1
	l2_send_gpu4_to_1 -> l2_recv_gpu4_to_1
	l2_recv_gpu4_to_1 -> l2_local_tokens_gpu1
	l2_token_split_gpu4 -> l2_send_gpu4_to_2
	l2_send_gpu4_to_2 -> l2_recv_gpu4_to_2
	l2_recv_gpu4_to_2 -> l2_local_tokens_gpu2
	l2_token_split_gpu4 -> l2_send_gpu4_to_3
	l2_send_gpu4_to_3 -> l2_recv_gpu4_to_3
	l2_recv_gpu4_to_3 -> l2_local_tokens_gpu3
	l2_token_split_gpu4 -> l2_send_gpu4_to_5
	l2_send_gpu4_to_5 -> l2_recv_gpu4_to_5
	l2_recv_gpu4_to_5 -> l2_local_tokens_gpu5
	l2_token_split_gpu4 -> l2_send_gpu4_to_6
	l2_send_gpu4_to_6 -> l2_recv_gpu4_to_6
	l2_recv_gpu4_to_6 -> l2_local_tokens_gpu6
	l2_token_split_gpu4 -> l2_send_gpu4_to_7
	l2_send_gpu4_to_7 -> l2_recv_gpu4_to_7
	l2_recv_gpu4_to_7 -> l2_local_tokens_gpu7
	l2_token_split_gpu4 -> l2_send_gpu4_to_8
	l2_send_gpu4_to_8 -> l2_recv_gpu4_to_8
	l2_recv_gpu4_to_8 -> l2_local_tokens_gpu8
	l2_token_split_gpu4 -> l2_send_gpu4_to_9
	l2_send_gpu4_to_9 -> l2_recv_gpu4_to_9
	l2_recv_gpu4_to_9 -> l2_local_tokens_gpu9
	l2_token_split_gpu4 -> l2_send_gpu4_to_10
	l2_send_gpu4_to_10 -> l2_recv_gpu4_to_10
	l2_recv_gpu4_to_10 -> l2_local_tokens_gpu10
	l2_token_split_gpu4 -> l2_send_gpu4_to_11
	l2_send_gpu4_to_11 -> l2_recv_gpu4_to_11
	l2_recv_gpu4_to_11 -> l2_local_tokens_gpu11
	l2_token_split_gpu4 -> l2_send_gpu4_to_12
	l2_send_gpu4_to_12 -> l2_recv_gpu4_to_12
	l2_recv_gpu4_to_12 -> l2_local_tokens_gpu12
	l2_token_split_gpu4 -> l2_send_gpu4_to_13
	l2_send_gpu4_to_13 -> l2_recv_gpu4_to_13
	l2_recv_gpu4_to_13 -> l2_local_tokens_gpu13
	l2_token_split_gpu4 -> l2_send_gpu4_to_14
	l2_send_gpu4_to_14 -> l2_recv_gpu4_to_14
	l2_recv_gpu4_to_14 -> l2_local_tokens_gpu14
	l2_token_split_gpu4 -> l2_send_gpu4_to_15
	l2_send_gpu4_to_15 -> l2_recv_gpu4_to_15
	l2_recv_gpu4_to_15 -> l2_local_tokens_gpu15
	l2_token_split_gpu4 -> l2_local_tokens_gpu4
	l2_local_tokens_gpu4 -> l2_expert_gpu4
	l2_expert_gpu0 -> l2_expert_agg_gpu4
	l2_expert_gpu1 -> l2_expert_agg_gpu4
	l2_expert_gpu2 -> l2_expert_agg_gpu4
	l2_expert_gpu3 -> l2_expert_agg_gpu4
	l2_expert_gpu4 -> l2_expert_agg_gpu4
	l2_expert_gpu5 -> l2_expert_agg_gpu4
	l2_expert_gpu6 -> l2_expert_agg_gpu4
	l2_expert_gpu7 -> l2_expert_agg_gpu4
	l2_expert_gpu8 -> l2_expert_agg_gpu4
	l2_expert_gpu9 -> l2_expert_agg_gpu4
	l2_expert_gpu10 -> l2_expert_agg_gpu4
	l2_expert_gpu11 -> l2_expert_agg_gpu4
	l2_expert_gpu12 -> l2_expert_agg_gpu4
	l2_expert_gpu13 -> l2_expert_agg_gpu4
	l2_expert_gpu14 -> l2_expert_agg_gpu4
	l2_expert_gpu15 -> l2_expert_agg_gpu4
	l2_attn_residual_gpu4 -> l2_final_residual_gpu4
	l2_expert_agg_gpu4 -> l2_final_residual_gpu4
	l2_qkv_gpu5 -> l2_attn_gpu5
	l2_attn_gpu5 -> l2_out_proj_gpu5
	l2_out_proj_gpu5 -> l2_attn_residual_gpu5
	l1_final_residual_gpu5 -> l2_attn_residual_gpu5
	l2_attn_residual_gpu5 -> l2_gate_gpu5
	l2_attn_residual_gpu5 -> l2_token_split_gpu5
	l2_gate_gpu5 -> l2_token_split_gpu5 [style=dashed]
	l2_token_split_gpu5 -> l2_send_gpu5_to_0
	l2_send_gpu5_to_0 -> l2_recv_gpu5_to_0
	l2_recv_gpu5_to_0 -> l2_local_tokens_gpu0
	l2_token_split_gpu5 -> l2_send_gpu5_to_1
	l2_send_gpu5_to_1 -> l2_recv_gpu5_to_1
	l2_recv_gpu5_to_1 -> l2_local_tokens_gpu1
	l2_token_split_gpu5 -> l2_send_gpu5_to_2
	l2_send_gpu5_to_2 -> l2_recv_gpu5_to_2
	l2_recv_gpu5_to_2 -> l2_local_tokens_gpu2
	l2_token_split_gpu5 -> l2_send_gpu5_to_3
	l2_send_gpu5_to_3 -> l2_recv_gpu5_to_3
	l2_recv_gpu5_to_3 -> l2_local_tokens_gpu3
	l2_token_split_gpu5 -> l2_send_gpu5_to_4
	l2_send_gpu5_to_4 -> l2_recv_gpu5_to_4
	l2_recv_gpu5_to_4 -> l2_local_tokens_gpu4
	l2_token_split_gpu5 -> l2_send_gpu5_to_6
	l2_send_gpu5_to_6 -> l2_recv_gpu5_to_6
	l2_recv_gpu5_to_6 -> l2_local_tokens_gpu6
	l2_token_split_gpu5 -> l2_send_gpu5_to_7
	l2_send_gpu5_to_7 -> l2_recv_gpu5_to_7
	l2_recv_gpu5_to_7 -> l2_local_tokens_gpu7
	l2_token_split_gpu5 -> l2_send_gpu5_to_8
	l2_send_gpu5_to_8 -> l2_recv_gpu5_to_8
	l2_recv_gpu5_to_8 -> l2_local_tokens_gpu8
	l2_token_split_gpu5 -> l2_send_gpu5_to_9
	l2_send_gpu5_to_9 -> l2_recv_gpu5_to_9
	l2_recv_gpu5_to_9 -> l2_local_tokens_gpu9
	l2_token_split_gpu5 -> l2_send_gpu5_to_10
	l2_send_gpu5_to_10 -> l2_recv_gpu5_to_10
	l2_recv_gpu5_to_10 -> l2_local_tokens_gpu10
	l2_token_split_gpu5 -> l2_send_gpu5_to_11
	l2_send_gpu5_to_11 -> l2_recv_gpu5_to_11
	l2_recv_gpu5_to_11 -> l2_local_tokens_gpu11
	l2_token_split_gpu5 -> l2_send_gpu5_to_12
	l2_send_gpu5_to_12 -> l2_recv_gpu5_to_12
	l2_recv_gpu5_to_12 -> l2_local_tokens_gpu12
	l2_token_split_gpu5 -> l2_send_gpu5_to_13
	l2_send_gpu5_to_13 -> l2_recv_gpu5_to_13
	l2_recv_gpu5_to_13 -> l2_local_tokens_gpu13
	l2_token_split_gpu5 -> l2_send_gpu5_to_14
	l2_send_gpu5_to_14 -> l2_recv_gpu5_to_14
	l2_recv_gpu5_to_14 -> l2_local_tokens_gpu14
	l2_token_split_gpu5 -> l2_send_gpu5_to_15
	l2_send_gpu5_to_15 -> l2_recv_gpu5_to_15
	l2_recv_gpu5_to_15 -> l2_local_tokens_gpu15
	l2_token_split_gpu5 -> l2_local_tokens_gpu5
	l2_local_tokens_gpu5 -> l2_expert_gpu5
	l2_expert_gpu0 -> l2_expert_agg_gpu5
	l2_expert_gpu1 -> l2_expert_agg_gpu5
	l2_expert_gpu2 -> l2_expert_agg_gpu5
	l2_expert_gpu3 -> l2_expert_agg_gpu5
	l2_expert_gpu4 -> l2_expert_agg_gpu5
	l2_expert_gpu5 -> l2_expert_agg_gpu5
	l2_expert_gpu6 -> l2_expert_agg_gpu5
	l2_expert_gpu7 -> l2_expert_agg_gpu5
	l2_expert_gpu8 -> l2_expert_agg_gpu5
	l2_expert_gpu9 -> l2_expert_agg_gpu5
	l2_expert_gpu10 -> l2_expert_agg_gpu5
	l2_expert_gpu11 -> l2_expert_agg_gpu5
	l2_expert_gpu12 -> l2_expert_agg_gpu5
	l2_expert_gpu13 -> l2_expert_agg_gpu5
	l2_expert_gpu14 -> l2_expert_agg_gpu5
	l2_expert_gpu15 -> l2_expert_agg_gpu5
	l2_attn_residual_gpu5 -> l2_final_residual_gpu5
	l2_expert_agg_gpu5 -> l2_final_residual_gpu5
	l2_qkv_gpu6 -> l2_attn_gpu6
	l2_attn_gpu6 -> l2_out_proj_gpu6
	l2_out_proj_gpu6 -> l2_attn_residual_gpu6
	l1_final_residual_gpu6 -> l2_attn_residual_gpu6
	l2_attn_residual_gpu6 -> l2_gate_gpu6
	l2_attn_residual_gpu6 -> l2_token_split_gpu6
	l2_gate_gpu6 -> l2_token_split_gpu6 [style=dashed]
	l2_token_split_gpu6 -> l2_send_gpu6_to_0
	l2_send_gpu6_to_0 -> l2_recv_gpu6_to_0
	l2_recv_gpu6_to_0 -> l2_local_tokens_gpu0
	l2_token_split_gpu6 -> l2_send_gpu6_to_1
	l2_send_gpu6_to_1 -> l2_recv_gpu6_to_1
	l2_recv_gpu6_to_1 -> l2_local_tokens_gpu1
	l2_token_split_gpu6 -> l2_send_gpu6_to_2
	l2_send_gpu6_to_2 -> l2_recv_gpu6_to_2
	l2_recv_gpu6_to_2 -> l2_local_tokens_gpu2
	l2_token_split_gpu6 -> l2_send_gpu6_to_3
	l2_send_gpu6_to_3 -> l2_recv_gpu6_to_3
	l2_recv_gpu6_to_3 -> l2_local_tokens_gpu3
	l2_token_split_gpu6 -> l2_send_gpu6_to_4
	l2_send_gpu6_to_4 -> l2_recv_gpu6_to_4
	l2_recv_gpu6_to_4 -> l2_local_tokens_gpu4
	l2_token_split_gpu6 -> l2_send_gpu6_to_5
	l2_send_gpu6_to_5 -> l2_recv_gpu6_to_5
	l2_recv_gpu6_to_5 -> l2_local_tokens_gpu5
	l2_token_split_gpu6 -> l2_send_gpu6_to_7
	l2_send_gpu6_to_7 -> l2_recv_gpu6_to_7
	l2_recv_gpu6_to_7 -> l2_local_tokens_gpu7
	l2_token_split_gpu6 -> l2_send_gpu6_to_8
	l2_send_gpu6_to_8 -> l2_recv_gpu6_to_8
	l2_recv_gpu6_to_8 -> l2_local_tokens_gpu8
	l2_token_split_gpu6 -> l2_send_gpu6_to_9
	l2_send_gpu6_to_9 -> l2_recv_gpu6_to_9
	l2_recv_gpu6_to_9 -> l2_local_tokens_gpu9
	l2_token_split_gpu6 -> l2_send_gpu6_to_10
	l2_send_gpu6_to_10 -> l2_recv_gpu6_to_10
	l2_recv_gpu6_to_10 -> l2_local_tokens_gpu10
	l2_token_split_gpu6 -> l2_send_gpu6_to_11
	l2_send_gpu6_to_11 -> l2_recv_gpu6_to_11
	l2_recv_gpu6_to_11 -> l2_local_tokens_gpu11
	l2_token_split_gpu6 -> l2_send_gpu6_to_12
	l2_send_gpu6_to_12 -> l2_recv_gpu6_to_12
	l2_recv_gpu6_to_12 -> l2_local_tokens_gpu12
	l2_token_split_gpu6 -> l2_send_gpu6_to_13
	l2_send_gpu6_to_13 -> l2_recv_gpu6_to_13
	l2_recv_gpu6_to_13 -> l2_local_tokens_gpu13
	l2_token_split_gpu6 -> l2_send_gpu6_to_14
	l2_send_gpu6_to_14 -> l2_recv_gpu6_to_14
	l2_recv_gpu6_to_14 -> l2_local_tokens_gpu14
	l2_token_split_gpu6 -> l2_send_gpu6_to_15
	l2_send_gpu6_to_15 -> l2_recv_gpu6_to_15
	l2_recv_gpu6_to_15 -> l2_local_tokens_gpu15
	l2_token_split_gpu6 -> l2_local_tokens_gpu6
	l2_local_tokens_gpu6 -> l2_expert_gpu6
	l2_expert_gpu0 -> l2_expert_agg_gpu6
	l2_expert_gpu1 -> l2_expert_agg_gpu6
	l2_expert_gpu2 -> l2_expert_agg_gpu6
	l2_expert_gpu3 -> l2_expert_agg_gpu6
	l2_expert_gpu4 -> l2_expert_agg_gpu6
	l2_expert_gpu5 -> l2_expert_agg_gpu6
	l2_expert_gpu6 -> l2_expert_agg_gpu6
	l2_expert_gpu7 -> l2_expert_agg_gpu6
	l2_expert_gpu8 -> l2_expert_agg_gpu6
	l2_expert_gpu9 -> l2_expert_agg_gpu6
	l2_expert_gpu10 -> l2_expert_agg_gpu6
	l2_expert_gpu11 -> l2_expert_agg_gpu6
	l2_expert_gpu12 -> l2_expert_agg_gpu6
	l2_expert_gpu13 -> l2_expert_agg_gpu6
	l2_expert_gpu14 -> l2_expert_agg_gpu6
	l2_expert_gpu15 -> l2_expert_agg_gpu6
	l2_attn_residual_gpu6 -> l2_final_residual_gpu6
	l2_expert_agg_gpu6 -> l2_final_residual_gpu6
	l2_qkv_gpu7 -> l2_attn_gpu7
	l2_attn_gpu7 -> l2_out_proj_gpu7
	l2_out_proj_gpu7 -> l2_attn_residual_gpu7
	l1_final_residual_gpu7 -> l2_attn_residual_gpu7
	l2_attn_residual_gpu7 -> l2_gate_gpu7
	l2_attn_residual_gpu7 -> l2_token_split_gpu7
	l2_gate_gpu7 -> l2_token_split_gpu7 [style=dashed]
	l2_token_split_gpu7 -> l2_send_gpu7_to_0
	l2_send_gpu7_to_0 -> l2_recv_gpu7_to_0
	l2_recv_gpu7_to_0 -> l2_local_tokens_gpu0
	l2_token_split_gpu7 -> l2_send_gpu7_to_1
	l2_send_gpu7_to_1 -> l2_recv_gpu7_to_1
	l2_recv_gpu7_to_1 -> l2_local_tokens_gpu1
	l2_token_split_gpu7 -> l2_send_gpu7_to_2
	l2_send_gpu7_to_2 -> l2_recv_gpu7_to_2
	l2_recv_gpu7_to_2 -> l2_local_tokens_gpu2
	l2_token_split_gpu7 -> l2_send_gpu7_to_3
	l2_send_gpu7_to_3 -> l2_recv_gpu7_to_3
	l2_recv_gpu7_to_3 -> l2_local_tokens_gpu3
	l2_token_split_gpu7 -> l2_send_gpu7_to_4
	l2_send_gpu7_to_4 -> l2_recv_gpu7_to_4
	l2_recv_gpu7_to_4 -> l2_local_tokens_gpu4
	l2_token_split_gpu7 -> l2_send_gpu7_to_5
	l2_send_gpu7_to_5 -> l2_recv_gpu7_to_5
	l2_recv_gpu7_to_5 -> l2_local_tokens_gpu5
	l2_token_split_gpu7 -> l2_send_gpu7_to_6
	l2_send_gpu7_to_6 -> l2_recv_gpu7_to_6
	l2_recv_gpu7_to_6 -> l2_local_tokens_gpu6
	l2_token_split_gpu7 -> l2_send_gpu7_to_8
	l2_send_gpu7_to_8 -> l2_recv_gpu7_to_8
	l2_recv_gpu7_to_8 -> l2_local_tokens_gpu8
	l2_token_split_gpu7 -> l2_send_gpu7_to_9
	l2_send_gpu7_to_9 -> l2_recv_gpu7_to_9
	l2_recv_gpu7_to_9 -> l2_local_tokens_gpu9
	l2_token_split_gpu7 -> l2_send_gpu7_to_10
	l2_send_gpu7_to_10 -> l2_recv_gpu7_to_10
	l2_recv_gpu7_to_10 -> l2_local_tokens_gpu10
	l2_token_split_gpu7 -> l2_send_gpu7_to_11
	l2_send_gpu7_to_11 -> l2_recv_gpu7_to_11
	l2_recv_gpu7_to_11 -> l2_local_tokens_gpu11
	l2_token_split_gpu7 -> l2_send_gpu7_to_12
	l2_send_gpu7_to_12 -> l2_recv_gpu7_to_12
	l2_recv_gpu7_to_12 -> l2_local_tokens_gpu12
	l2_token_split_gpu7 -> l2_send_gpu7_to_13
	l2_send_gpu7_to_13 -> l2_recv_gpu7_to_13
	l2_recv_gpu7_to_13 -> l2_local_tokens_gpu13
	l2_token_split_gpu7 -> l2_send_gpu7_to_14
	l2_send_gpu7_to_14 -> l2_recv_gpu7_to_14
	l2_recv_gpu7_to_14 -> l2_local_tokens_gpu14
	l2_token_split_gpu7 -> l2_send_gpu7_to_15
	l2_send_gpu7_to_15 -> l2_recv_gpu7_to_15
	l2_recv_gpu7_to_15 -> l2_local_tokens_gpu15
	l2_token_split_gpu7 -> l2_local_tokens_gpu7
	l2_local_tokens_gpu7 -> l2_expert_gpu7
	l2_expert_gpu0 -> l2_expert_agg_gpu7
	l2_expert_gpu1 -> l2_expert_agg_gpu7
	l2_expert_gpu2 -> l2_expert_agg_gpu7
	l2_expert_gpu3 -> l2_expert_agg_gpu7
	l2_expert_gpu4 -> l2_expert_agg_gpu7
	l2_expert_gpu5 -> l2_expert_agg_gpu7
	l2_expert_gpu6 -> l2_expert_agg_gpu7
	l2_expert_gpu7 -> l2_expert_agg_gpu7
	l2_expert_gpu8 -> l2_expert_agg_gpu7
	l2_expert_gpu9 -> l2_expert_agg_gpu7
	l2_expert_gpu10 -> l2_expert_agg_gpu7
	l2_expert_gpu11 -> l2_expert_agg_gpu7
	l2_expert_gpu12 -> l2_expert_agg_gpu7
	l2_expert_gpu13 -> l2_expert_agg_gpu7
	l2_expert_gpu14 -> l2_expert_agg_gpu7
	l2_expert_gpu15 -> l2_expert_agg_gpu7
	l2_attn_residual_gpu7 -> l2_final_residual_gpu7
	l2_expert_agg_gpu7 -> l2_final_residual_gpu7
	l2_qkv_gpu8 -> l2_attn_gpu8
	l2_attn_gpu8 -> l2_out_proj_gpu8
	l2_out_proj_gpu8 -> l2_attn_residual_gpu8
	l1_final_residual_gpu8 -> l2_attn_residual_gpu8
	l2_attn_residual_gpu8 -> l2_gate_gpu8
	l2_attn_residual_gpu8 -> l2_token_split_gpu8
	l2_gate_gpu8 -> l2_token_split_gpu8 [style=dashed]
	l2_token_split_gpu8 -> l2_send_gpu8_to_0
	l2_send_gpu8_to_0 -> l2_recv_gpu8_to_0
	l2_recv_gpu8_to_0 -> l2_local_tokens_gpu0
	l2_token_split_gpu8 -> l2_send_gpu8_to_1
	l2_send_gpu8_to_1 -> l2_recv_gpu8_to_1
	l2_recv_gpu8_to_1 -> l2_local_tokens_gpu1
	l2_token_split_gpu8 -> l2_send_gpu8_to_2
	l2_send_gpu8_to_2 -> l2_recv_gpu8_to_2
	l2_recv_gpu8_to_2 -> l2_local_tokens_gpu2
	l2_token_split_gpu8 -> l2_send_gpu8_to_3
	l2_send_gpu8_to_3 -> l2_recv_gpu8_to_3
	l2_recv_gpu8_to_3 -> l2_local_tokens_gpu3
	l2_token_split_gpu8 -> l2_send_gpu8_to_4
	l2_send_gpu8_to_4 -> l2_recv_gpu8_to_4
	l2_recv_gpu8_to_4 -> l2_local_tokens_gpu4
	l2_token_split_gpu8 -> l2_send_gpu8_to_5
	l2_send_gpu8_to_5 -> l2_recv_gpu8_to_5
	l2_recv_gpu8_to_5 -> l2_local_tokens_gpu5
	l2_token_split_gpu8 -> l2_send_gpu8_to_6
	l2_send_gpu8_to_6 -> l2_recv_gpu8_to_6
	l2_recv_gpu8_to_6 -> l2_local_tokens_gpu6
	l2_token_split_gpu8 -> l2_send_gpu8_to_7
	l2_send_gpu8_to_7 -> l2_recv_gpu8_to_7
	l2_recv_gpu8_to_7 -> l2_local_tokens_gpu7
	l2_token_split_gpu8 -> l2_send_gpu8_to_9
	l2_send_gpu8_to_9 -> l2_recv_gpu8_to_9
	l2_recv_gpu8_to_9 -> l2_local_tokens_gpu9
	l2_token_split_gpu8 -> l2_send_gpu8_to_10
	l2_send_gpu8_to_10 -> l2_recv_gpu8_to_10
	l2_recv_gpu8_to_10 -> l2_local_tokens_gpu10
	l2_token_split_gpu8 -> l2_send_gpu8_to_11
	l2_send_gpu8_to_11 -> l2_recv_gpu8_to_11
	l2_recv_gpu8_to_11 -> l2_local_tokens_gpu11
	l2_token_split_gpu8 -> l2_send_gpu8_to_12
	l2_send_gpu8_to_12 -> l2_recv_gpu8_to_12
	l2_recv_gpu8_to_12 -> l2_local_tokens_gpu12
	l2_token_split_gpu8 -> l2_send_gpu8_to_13
	l2_send_gpu8_to_13 -> l2_recv_gpu8_to_13
	l2_recv_gpu8_to_13 -> l2_local_tokens_gpu13
	l2_token_split_gpu8 -> l2_send_gpu8_to_14
	l2_send_gpu8_to_14 -> l2_recv_gpu8_to_14
	l2_recv_gpu8_to_14 -> l2_local_tokens_gpu14
	l2_token_split_gpu8 -> l2_send_gpu8_to_15
	l2_send_gpu8_to_15 -> l2_recv_gpu8_to_15
	l2_recv_gpu8_to_15 -> l2_local_tokens_gpu15
	l2_token_split_gpu8 -> l2_local_tokens_gpu8
	l2_local_tokens_gpu8 -> l2_expert_gpu8
	l2_expert_gpu0 -> l2_expert_agg_gpu8
	l2_expert_gpu1 -> l2_expert_agg_gpu8
	l2_expert_gpu2 -> l2_expert_agg_gpu8
	l2_expert_gpu3 -> l2_expert_agg_gpu8
	l2_expert_gpu4 -> l2_expert_agg_gpu8
	l2_expert_gpu5 -> l2_expert_agg_gpu8
	l2_expert_gpu6 -> l2_expert_agg_gpu8
	l2_expert_gpu7 -> l2_expert_agg_gpu8
	l2_expert_gpu8 -> l2_expert_agg_gpu8
	l2_expert_gpu9 -> l2_expert_agg_gpu8
	l2_expert_gpu10 -> l2_expert_agg_gpu8
	l2_expert_gpu11 -> l2_expert_agg_gpu8
	l2_expert_gpu12 -> l2_expert_agg_gpu8
	l2_expert_gpu13 -> l2_expert_agg_gpu8
	l2_expert_gpu14 -> l2_expert_agg_gpu8
	l2_expert_gpu15 -> l2_expert_agg_gpu8
	l2_attn_residual_gpu8 -> l2_final_residual_gpu8
	l2_expert_agg_gpu8 -> l2_final_residual_gpu8
	l2_qkv_gpu9 -> l2_attn_gpu9
	l2_attn_gpu9 -> l2_out_proj_gpu9
	l2_out_proj_gpu9 -> l2_attn_residual_gpu9
	l1_final_residual_gpu9 -> l2_attn_residual_gpu9
	l2_attn_residual_gpu9 -> l2_gate_gpu9
	l2_attn_residual_gpu9 -> l2_token_split_gpu9
	l2_gate_gpu9 -> l2_token_split_gpu9 [style=dashed]
	l2_token_split_gpu9 -> l2_send_gpu9_to_0
	l2_send_gpu9_to_0 -> l2_recv_gpu9_to_0
	l2_recv_gpu9_to_0 -> l2_local_tokens_gpu0
	l2_token_split_gpu9 -> l2_send_gpu9_to_1
	l2_send_gpu9_to_1 -> l2_recv_gpu9_to_1
	l2_recv_gpu9_to_1 -> l2_local_tokens_gpu1
	l2_token_split_gpu9 -> l2_send_gpu9_to_2
	l2_send_gpu9_to_2 -> l2_recv_gpu9_to_2
	l2_recv_gpu9_to_2 -> l2_local_tokens_gpu2
	l2_token_split_gpu9 -> l2_send_gpu9_to_3
	l2_send_gpu9_to_3 -> l2_recv_gpu9_to_3
	l2_recv_gpu9_to_3 -> l2_local_tokens_gpu3
	l2_token_split_gpu9 -> l2_send_gpu9_to_4
	l2_send_gpu9_to_4 -> l2_recv_gpu9_to_4
	l2_recv_gpu9_to_4 -> l2_local_tokens_gpu4
	l2_token_split_gpu9 -> l2_send_gpu9_to_5
	l2_send_gpu9_to_5 -> l2_recv_gpu9_to_5
	l2_recv_gpu9_to_5 -> l2_local_tokens_gpu5
	l2_token_split_gpu9 -> l2_send_gpu9_to_6
	l2_send_gpu9_to_6 -> l2_recv_gpu9_to_6
	l2_recv_gpu9_to_6 -> l2_local_tokens_gpu6
	l2_token_split_gpu9 -> l2_send_gpu9_to_7
	l2_send_gpu9_to_7 -> l2_recv_gpu9_to_7
	l2_recv_gpu9_to_7 -> l2_local_tokens_gpu7
	l2_token_split_gpu9 -> l2_send_gpu9_to_8
	l2_send_gpu9_to_8 -> l2_recv_gpu9_to_8
	l2_recv_gpu9_to_8 -> l2_local_tokens_gpu8
	l2_token_split_gpu9 -> l2_send_gpu9_to_10
	l2_send_gpu9_to_10 -> l2_recv_gpu9_to_10
	l2_recv_gpu9_to_10 -> l2_local_tokens_gpu10
	l2_token_split_gpu9 -> l2_send_gpu9_to_11
	l2_send_gpu9_to_11 -> l2_recv_gpu9_to_11
	l2_recv_gpu9_to_11 -> l2_local_tokens_gpu11
	l2_token_split_gpu9 -> l2_send_gpu9_to_12
	l2_send_gpu9_to_12 -> l2_recv_gpu9_to_12
	l2_recv_gpu9_to_12 -> l2_local_tokens_gpu12
	l2_token_split_gpu9 -> l2_send_gpu9_to_13
	l2_send_gpu9_to_13 -> l2_recv_gpu9_to_13
	l2_recv_gpu9_to_13 -> l2_local_tokens_gpu13
	l2_token_split_gpu9 -> l2_send_gpu9_to_14
	l2_send_gpu9_to_14 -> l2_recv_gpu9_to_14
	l2_recv_gpu9_to_14 -> l2_local_tokens_gpu14
	l2_token_split_gpu9 -> l2_send_gpu9_to_15
	l2_send_gpu9_to_15 -> l2_recv_gpu9_to_15
	l2_recv_gpu9_to_15 -> l2_local_tokens_gpu15
	l2_token_split_gpu9 -> l2_local_tokens_gpu9
	l2_local_tokens_gpu9 -> l2_expert_gpu9
	l2_expert_gpu0 -> l2_expert_agg_gpu9
	l2_expert_gpu1 -> l2_expert_agg_gpu9
	l2_expert_gpu2 -> l2_expert_agg_gpu9
	l2_expert_gpu3 -> l2_expert_agg_gpu9
	l2_expert_gpu4 -> l2_expert_agg_gpu9
	l2_expert_gpu5 -> l2_expert_agg_gpu9
	l2_expert_gpu6 -> l2_expert_agg_gpu9
	l2_expert_gpu7 -> l2_expert_agg_gpu9
	l2_expert_gpu8 -> l2_expert_agg_gpu9
	l2_expert_gpu9 -> l2_expert_agg_gpu9
	l2_expert_gpu10 -> l2_expert_agg_gpu9
	l2_expert_gpu11 -> l2_expert_agg_gpu9
	l2_expert_gpu12 -> l2_expert_agg_gpu9
	l2_expert_gpu13 -> l2_expert_agg_gpu9
	l2_expert_gpu14 -> l2_expert_agg_gpu9
	l2_expert_gpu15 -> l2_expert_agg_gpu9
	l2_attn_residual_gpu9 -> l2_final_residual_gpu9
	l2_expert_agg_gpu9 -> l2_final_residual_gpu9
	l2_qkv_gpu10 -> l2_attn_gpu10
	l2_attn_gpu10 -> l2_out_proj_gpu10
	l2_out_proj_gpu10 -> l2_attn_residual_gpu10
	l1_final_residual_gpu10 -> l2_attn_residual_gpu10
	l2_attn_residual_gpu10 -> l2_gate_gpu10
	l2_attn_residual_gpu10 -> l2_token_split_gpu10
	l2_gate_gpu10 -> l2_token_split_gpu10 [style=dashed]
	l2_token_split_gpu10 -> l2_send_gpu10_to_0
	l2_send_gpu10_to_0 -> l2_recv_gpu10_to_0
	l2_recv_gpu10_to_0 -> l2_local_tokens_gpu0
	l2_token_split_gpu10 -> l2_send_gpu10_to_1
	l2_send_gpu10_to_1 -> l2_recv_gpu10_to_1
	l2_recv_gpu10_to_1 -> l2_local_tokens_gpu1
	l2_token_split_gpu10 -> l2_send_gpu10_to_2
	l2_send_gpu10_to_2 -> l2_recv_gpu10_to_2
	l2_recv_gpu10_to_2 -> l2_local_tokens_gpu2
	l2_token_split_gpu10 -> l2_send_gpu10_to_3
	l2_send_gpu10_to_3 -> l2_recv_gpu10_to_3
	l2_recv_gpu10_to_3 -> l2_local_tokens_gpu3
	l2_token_split_gpu10 -> l2_send_gpu10_to_4
	l2_send_gpu10_to_4 -> l2_recv_gpu10_to_4
	l2_recv_gpu10_to_4 -> l2_local_tokens_gpu4
	l2_token_split_gpu10 -> l2_send_gpu10_to_5
	l2_send_gpu10_to_5 -> l2_recv_gpu10_to_5
	l2_recv_gpu10_to_5 -> l2_local_tokens_gpu5
	l2_token_split_gpu10 -> l2_send_gpu10_to_6
	l2_send_gpu10_to_6 -> l2_recv_gpu10_to_6
	l2_recv_gpu10_to_6 -> l2_local_tokens_gpu6
	l2_token_split_gpu10 -> l2_send_gpu10_to_7
	l2_send_gpu10_to_7 -> l2_recv_gpu10_to_7
	l2_recv_gpu10_to_7 -> l2_local_tokens_gpu7
	l2_token_split_gpu10 -> l2_send_gpu10_to_8
	l2_send_gpu10_to_8 -> l2_recv_gpu10_to_8
	l2_recv_gpu10_to_8 -> l2_local_tokens_gpu8
	l2_token_split_gpu10 -> l2_send_gpu10_to_9
	l2_send_gpu10_to_9 -> l2_recv_gpu10_to_9
	l2_recv_gpu10_to_9 -> l2_local_tokens_gpu9
	l2_token_split_gpu10 -> l2_send_gpu10_to_11
	l2_send_gpu10_to_11 -> l2_recv_gpu10_to_11
	l2_recv_gpu10_to_11 -> l2_local_tokens_gpu11
	l2_token_split_gpu10 -> l2_send_gpu10_to_12
	l2_send_gpu10_to_12 -> l2_recv_gpu10_to_12
	l2_recv_gpu10_to_12 -> l2_local_tokens_gpu12
	l2_token_split_gpu10 -> l2_send_gpu10_to_13
	l2_send_gpu10_to_13 -> l2_recv_gpu10_to_13
	l2_recv_gpu10_to_13 -> l2_local_tokens_gpu13
	l2_token_split_gpu10 -> l2_send_gpu10_to_14
	l2_send_gpu10_to_14 -> l2_recv_gpu10_to_14
	l2_recv_gpu10_to_14 -> l2_local_tokens_gpu14
	l2_token_split_gpu10 -> l2_send_gpu10_to_15
	l2_send_gpu10_to_15 -> l2_recv_gpu10_to_15
	l2_recv_gpu10_to_15 -> l2_local_tokens_gpu15
	l2_token_split_gpu10 -> l2_local_tokens_gpu10
	l2_local_tokens_gpu10 -> l2_expert_gpu10
	l2_expert_gpu0 -> l2_expert_agg_gpu10
	l2_expert_gpu1 -> l2_expert_agg_gpu10
	l2_expert_gpu2 -> l2_expert_agg_gpu10
	l2_expert_gpu3 -> l2_expert_agg_gpu10
	l2_expert_gpu4 -> l2_expert_agg_gpu10
	l2_expert_gpu5 -> l2_expert_agg_gpu10
	l2_expert_gpu6 -> l2_expert_agg_gpu10
	l2_expert_gpu7 -> l2_expert_agg_gpu10
	l2_expert_gpu8 -> l2_expert_agg_gpu10
	l2_expert_gpu9 -> l2_expert_agg_gpu10
	l2_expert_gpu10 -> l2_expert_agg_gpu10
	l2_expert_gpu11 -> l2_expert_agg_gpu10
	l2_expert_gpu12 -> l2_expert_agg_gpu10
	l2_expert_gpu13 -> l2_expert_agg_gpu10
	l2_expert_gpu14 -> l2_expert_agg_gpu10
	l2_expert_gpu15 -> l2_expert_agg_gpu10
	l2_attn_residual_gpu10 -> l2_final_residual_gpu10
	l2_expert_agg_gpu10 -> l2_final_residual_gpu10
	l2_qkv_gpu11 -> l2_attn_gpu11
	l2_attn_gpu11 -> l2_out_proj_gpu11
	l2_out_proj_gpu11 -> l2_attn_residual_gpu11
	l1_final_residual_gpu11 -> l2_attn_residual_gpu11
	l2_attn_residual_gpu11 -> l2_gate_gpu11
	l2_attn_residual_gpu11 -> l2_token_split_gpu11
	l2_gate_gpu11 -> l2_token_split_gpu11 [style=dashed]
	l2_token_split_gpu11 -> l2_send_gpu11_to_0
	l2_send_gpu11_to_0 -> l2_recv_gpu11_to_0
	l2_recv_gpu11_to_0 -> l2_local_tokens_gpu0
	l2_token_split_gpu11 -> l2_send_gpu11_to_1
	l2_send_gpu11_to_1 -> l2_recv_gpu11_to_1
	l2_recv_gpu11_to_1 -> l2_local_tokens_gpu1
	l2_token_split_gpu11 -> l2_send_gpu11_to_2
	l2_send_gpu11_to_2 -> l2_recv_gpu11_to_2
	l2_recv_gpu11_to_2 -> l2_local_tokens_gpu2
	l2_token_split_gpu11 -> l2_send_gpu11_to_3
	l2_send_gpu11_to_3 -> l2_recv_gpu11_to_3
	l2_recv_gpu11_to_3 -> l2_local_tokens_gpu3
	l2_token_split_gpu11 -> l2_send_gpu11_to_4
	l2_send_gpu11_to_4 -> l2_recv_gpu11_to_4
	l2_recv_gpu11_to_4 -> l2_local_tokens_gpu4
	l2_token_split_gpu11 -> l2_send_gpu11_to_5
	l2_send_gpu11_to_5 -> l2_recv_gpu11_to_5
	l2_recv_gpu11_to_5 -> l2_local_tokens_gpu5
	l2_token_split_gpu11 -> l2_send_gpu11_to_6
	l2_send_gpu11_to_6 -> l2_recv_gpu11_to_6
	l2_recv_gpu11_to_6 -> l2_local_tokens_gpu6
	l2_token_split_gpu11 -> l2_send_gpu11_to_7
	l2_send_gpu11_to_7 -> l2_recv_gpu11_to_7
	l2_recv_gpu11_to_7 -> l2_local_tokens_gpu7
	l2_token_split_gpu11 -> l2_send_gpu11_to_8
	l2_send_gpu11_to_8 -> l2_recv_gpu11_to_8
	l2_recv_gpu11_to_8 -> l2_local_tokens_gpu8
	l2_token_split_gpu11 -> l2_send_gpu11_to_9
	l2_send_gpu11_to_9 -> l2_recv_gpu11_to_9
	l2_recv_gpu11_to_9 -> l2_local_tokens_gpu9
	l2_token_split_gpu11 -> l2_send_gpu11_to_10
	l2_send_gpu11_to_10 -> l2_recv_gpu11_to_10
	l2_recv_gpu11_to_10 -> l2_local_tokens_gpu10
	l2_token_split_gpu11 -> l2_send_gpu11_to_12
	l2_send_gpu11_to_12 -> l2_recv_gpu11_to_12
	l2_recv_gpu11_to_12 -> l2_local_tokens_gpu12
	l2_token_split_gpu11 -> l2_send_gpu11_to_13
	l2_send_gpu11_to_13 -> l2_recv_gpu11_to_13
	l2_recv_gpu11_to_13 -> l2_local_tokens_gpu13
	l2_token_split_gpu11 -> l2_send_gpu11_to_14
	l2_send_gpu11_to_14 -> l2_recv_gpu11_to_14
	l2_recv_gpu11_to_14 -> l2_local_tokens_gpu14
	l2_token_split_gpu11 -> l2_send_gpu11_to_15
	l2_send_gpu11_to_15 -> l2_recv_gpu11_to_15
	l2_recv_gpu11_to_15 -> l2_local_tokens_gpu15
	l2_token_split_gpu11 -> l2_local_tokens_gpu11
	l2_local_tokens_gpu11 -> l2_expert_gpu11
	l2_expert_gpu0 -> l2_expert_agg_gpu11
	l2_expert_gpu1 -> l2_expert_agg_gpu11
	l2_expert_gpu2 -> l2_expert_agg_gpu11
	l2_expert_gpu3 -> l2_expert_agg_gpu11
	l2_expert_gpu4 -> l2_expert_agg_gpu11
	l2_expert_gpu5 -> l2_expert_agg_gpu11
	l2_expert_gpu6 -> l2_expert_agg_gpu11
	l2_expert_gpu7 -> l2_expert_agg_gpu11
	l2_expert_gpu8 -> l2_expert_agg_gpu11
	l2_expert_gpu9 -> l2_expert_agg_gpu11
	l2_expert_gpu10 -> l2_expert_agg_gpu11
	l2_expert_gpu11 -> l2_expert_agg_gpu11
	l2_expert_gpu12 -> l2_expert_agg_gpu11
	l2_expert_gpu13 -> l2_expert_agg_gpu11
	l2_expert_gpu14 -> l2_expert_agg_gpu11
	l2_expert_gpu15 -> l2_expert_agg_gpu11
	l2_attn_residual_gpu11 -> l2_final_residual_gpu11
	l2_expert_agg_gpu11 -> l2_final_residual_gpu11
	l2_qkv_gpu12 -> l2_attn_gpu12
	l2_attn_gpu12 -> l2_out_proj_gpu12
	l2_out_proj_gpu12 -> l2_attn_residual_gpu12
	l1_final_residual_gpu12 -> l2_attn_residual_gpu12
	l2_attn_residual_gpu12 -> l2_gate_gpu12
	l2_attn_residual_gpu12 -> l2_token_split_gpu12
	l2_gate_gpu12 -> l2_token_split_gpu12 [style=dashed]
	l2_token_split_gpu12 -> l2_send_gpu12_to_0
	l2_send_gpu12_to_0 -> l2_recv_gpu12_to_0
	l2_recv_gpu12_to_0 -> l2_local_tokens_gpu0
	l2_token_split_gpu12 -> l2_send_gpu12_to_1
	l2_send_gpu12_to_1 -> l2_recv_gpu12_to_1
	l2_recv_gpu12_to_1 -> l2_local_tokens_gpu1
	l2_token_split_gpu12 -> l2_send_gpu12_to_2
	l2_send_gpu12_to_2 -> l2_recv_gpu12_to_2
	l2_recv_gpu12_to_2 -> l2_local_tokens_gpu2
	l2_token_split_gpu12 -> l2_send_gpu12_to_3
	l2_send_gpu12_to_3 -> l2_recv_gpu12_to_3
	l2_recv_gpu12_to_3 -> l2_local_tokens_gpu3
	l2_token_split_gpu12 -> l2_send_gpu12_to_4
	l2_send_gpu12_to_4 -> l2_recv_gpu12_to_4
	l2_recv_gpu12_to_4 -> l2_local_tokens_gpu4
	l2_token_split_gpu12 -> l2_send_gpu12_to_5
	l2_send_gpu12_to_5 -> l2_recv_gpu12_to_5
	l2_recv_gpu12_to_5 -> l2_local_tokens_gpu5
	l2_token_split_gpu12 -> l2_send_gpu12_to_6
	l2_send_gpu12_to_6 -> l2_recv_gpu12_to_6
	l2_recv_gpu12_to_6 -> l2_local_tokens_gpu6
	l2_token_split_gpu12 -> l2_send_gpu12_to_7
	l2_send_gpu12_to_7 -> l2_recv_gpu12_to_7
	l2_recv_gpu12_to_7 -> l2_local_tokens_gpu7
	l2_token_split_gpu12 -> l2_send_gpu12_to_8
	l2_send_gpu12_to_8 -> l2_recv_gpu12_to_8
	l2_recv_gpu12_to_8 -> l2_local_tokens_gpu8
	l2_token_split_gpu12 -> l2_send_gpu12_to_9
	l2_send_gpu12_to_9 -> l2_recv_gpu12_to_9
	l2_recv_gpu12_to_9 -> l2_local_tokens_gpu9
	l2_token_split_gpu12 -> l2_send_gpu12_to_10
	l2_send_gpu12_to_10 -> l2_recv_gpu12_to_10
	l2_recv_gpu12_to_10 -> l2_local_tokens_gpu10
	l2_token_split_gpu12 -> l2_send_gpu12_to_11
	l2_send_gpu12_to_11 -> l2_recv_gpu12_to_11
	l2_recv_gpu12_to_11 -> l2_local_tokens_gpu11
	l2_token_split_gpu12 -> l2_send_gpu12_to_13
	l2_send_gpu12_to_13 -> l2_recv_gpu12_to_13
	l2_recv_gpu12_to_13 -> l2_local_tokens_gpu13
	l2_token_split_gpu12 -> l2_send_gpu12_to_14
	l2_send_gpu12_to_14 -> l2_recv_gpu12_to_14
	l2_recv_gpu12_to_14 -> l2_local_tokens_gpu14
	l2_token_split_gpu12 -> l2_send_gpu12_to_15
	l2_send_gpu12_to_15 -> l2_recv_gpu12_to_15
	l2_recv_gpu12_to_15 -> l2_local_tokens_gpu15
	l2_token_split_gpu12 -> l2_local_tokens_gpu12
	l2_local_tokens_gpu12 -> l2_expert_gpu12
	l2_expert_gpu0 -> l2_expert_agg_gpu12
	l2_expert_gpu1 -> l2_expert_agg_gpu12
	l2_expert_gpu2 -> l2_expert_agg_gpu12
	l2_expert_gpu3 -> l2_expert_agg_gpu12
	l2_expert_gpu4 -> l2_expert_agg_gpu12
	l2_expert_gpu5 -> l2_expert_agg_gpu12
	l2_expert_gpu6 -> l2_expert_agg_gpu12
	l2_expert_gpu7 -> l2_expert_agg_gpu12
	l2_expert_gpu8 -> l2_expert_agg_gpu12
	l2_expert_gpu9 -> l2_expert_agg_gpu12
	l2_expert_gpu10 -> l2_expert_agg_gpu12
	l2_expert_gpu11 -> l2_expert_agg_gpu12
	l2_expert_gpu12 -> l2_expert_agg_gpu12
	l2_expert_gpu13 -> l2_expert_agg_gpu12
	l2_expert_gpu14 -> l2_expert_agg_gpu12
	l2_expert_gpu15 -> l2_expert_agg_gpu12
	l2_attn_residual_gpu12 -> l2_final_residual_gpu12
	l2_expert_agg_gpu12 -> l2_final_residual_gpu12
	l2_qkv_gpu13 -> l2_attn_gpu13
	l2_attn_gpu13 -> l2_out_proj_gpu13
	l2_out_proj_gpu13 -> l2_attn_residual_gpu13
	l1_final_residual_gpu13 -> l2_attn_residual_gpu13
	l2_attn_residual_gpu13 -> l2_gate_gpu13
	l2_attn_residual_gpu13 -> l2_token_split_gpu13
	l2_gate_gpu13 -> l2_token_split_gpu13 [style=dashed]
	l2_token_split_gpu13 -> l2_send_gpu13_to_0
	l2_send_gpu13_to_0 -> l2_recv_gpu13_to_0
	l2_recv_gpu13_to_0 -> l2_local_tokens_gpu0
	l2_token_split_gpu13 -> l2_send_gpu13_to_1
	l2_send_gpu13_to_1 -> l2_recv_gpu13_to_1
	l2_recv_gpu13_to_1 -> l2_local_tokens_gpu1
	l2_token_split_gpu13 -> l2_send_gpu13_to_2
	l2_send_gpu13_to_2 -> l2_recv_gpu13_to_2
	l2_recv_gpu13_to_2 -> l2_local_tokens_gpu2
	l2_token_split_gpu13 -> l2_send_gpu13_to_3
	l2_send_gpu13_to_3 -> l2_recv_gpu13_to_3
	l2_recv_gpu13_to_3 -> l2_local_tokens_gpu3
	l2_token_split_gpu13 -> l2_send_gpu13_to_4
	l2_send_gpu13_to_4 -> l2_recv_gpu13_to_4
	l2_recv_gpu13_to_4 -> l2_local_tokens_gpu4
	l2_token_split_gpu13 -> l2_send_gpu13_to_5
	l2_send_gpu13_to_5 -> l2_recv_gpu13_to_5
	l2_recv_gpu13_to_5 -> l2_local_tokens_gpu5
	l2_token_split_gpu13 -> l2_send_gpu13_to_6
	l2_send_gpu13_to_6 -> l2_recv_gpu13_to_6
	l2_recv_gpu13_to_6 -> l2_local_tokens_gpu6
	l2_token_split_gpu13 -> l2_send_gpu13_to_7
	l2_send_gpu13_to_7 -> l2_recv_gpu13_to_7
	l2_recv_gpu13_to_7 -> l2_local_tokens_gpu7
	l2_token_split_gpu13 -> l2_send_gpu13_to_8
	l2_send_gpu13_to_8 -> l2_recv_gpu13_to_8
	l2_recv_gpu13_to_8 -> l2_local_tokens_gpu8
	l2_token_split_gpu13 -> l2_send_gpu13_to_9
	l2_send_gpu13_to_9 -> l2_recv_gpu13_to_9
	l2_recv_gpu13_to_9 -> l2_local_tokens_gpu9
	l2_token_split_gpu13 -> l2_send_gpu13_to_10
	l2_send_gpu13_to_10 -> l2_recv_gpu13_to_10
	l2_recv_gpu13_to_10 -> l2_local_tokens_gpu10
	l2_token_split_gpu13 -> l2_send_gpu13_to_11
	l2_send_gpu13_to_11 -> l2_recv_gpu13_to_11
	l2_recv_gpu13_to_11 -> l2_local_tokens_gpu11
	l2_token_split_gpu13 -> l2_send_gpu13_to_12
	l2_send_gpu13_to_12 -> l2_recv_gpu13_to_12
	l2_recv_gpu13_to_12 -> l2_local_tokens_gpu12
	l2_token_split_gpu13 -> l2_send_gpu13_to_14
	l2_send_gpu13_to_14 -> l2_recv_gpu13_to_14
	l2_recv_gpu13_to_14 -> l2_local_tokens_gpu14
	l2_token_split_gpu13 -> l2_send_gpu13_to_15
	l2_send_gpu13_to_15 -> l2_recv_gpu13_to_15
	l2_recv_gpu13_to_15 -> l2_local_tokens_gpu15
	l2_token_split_gpu13 -> l2_local_tokens_gpu13
	l2_local_tokens_gpu13 -> l2_expert_gpu13
	l2_expert_gpu0 -> l2_expert_agg_gpu13
	l2_expert_gpu1 -> l2_expert_agg_gpu13
	l2_expert_gpu2 -> l2_expert_agg_gpu13
	l2_expert_gpu3 -> l2_expert_agg_gpu13
	l2_expert_gpu4 -> l2_expert_agg_gpu13
	l2_expert_gpu5 -> l2_expert_agg_gpu13
	l2_expert_gpu6 -> l2_expert_agg_gpu13
	l2_expert_gpu7 -> l2_expert_agg_gpu13
	l2_expert_gpu8 -> l2_expert_agg_gpu13
	l2_expert_gpu9 -> l2_expert_agg_gpu13
	l2_expert_gpu10 -> l2_expert_agg_gpu13
	l2_expert_gpu11 -> l2_expert_agg_gpu13
	l2_expert_gpu12 -> l2_expert_agg_gpu13
	l2_expert_gpu13 -> l2_expert_agg_gpu13
	l2_expert_gpu14 -> l2_expert_agg_gpu13
	l2_expert_gpu15 -> l2_expert_agg_gpu13
	l2_attn_residual_gpu13 -> l2_final_residual_gpu13
	l2_expert_agg_gpu13 -> l2_final_residual_gpu13
	l2_qkv_gpu14 -> l2_attn_gpu14
	l2_attn_gpu14 -> l2_out_proj_gpu14
	l2_out_proj_gpu14 -> l2_attn_residual_gpu14
	l1_final_residual_gpu14 -> l2_attn_residual_gpu14
	l2_attn_residual_gpu14 -> l2_gate_gpu14
	l2_attn_residual_gpu14 -> l2_token_split_gpu14
	l2_gate_gpu14 -> l2_token_split_gpu14 [style=dashed]
	l2_token_split_gpu14 -> l2_send_gpu14_to_0
	l2_send_gpu14_to_0 -> l2_recv_gpu14_to_0
	l2_recv_gpu14_to_0 -> l2_local_tokens_gpu0
	l2_token_split_gpu14 -> l2_send_gpu14_to_1
	l2_send_gpu14_to_1 -> l2_recv_gpu14_to_1
	l2_recv_gpu14_to_1 -> l2_local_tokens_gpu1
	l2_token_split_gpu14 -> l2_send_gpu14_to_2
	l2_send_gpu14_to_2 -> l2_recv_gpu14_to_2
	l2_recv_gpu14_to_2 -> l2_local_tokens_gpu2
	l2_token_split_gpu14 -> l2_send_gpu14_to_3
	l2_send_gpu14_to_3 -> l2_recv_gpu14_to_3
	l2_recv_gpu14_to_3 -> l2_local_tokens_gpu3
	l2_token_split_gpu14 -> l2_send_gpu14_to_4
	l2_send_gpu14_to_4 -> l2_recv_gpu14_to_4
	l2_recv_gpu14_to_4 -> l2_local_tokens_gpu4
	l2_token_split_gpu14 -> l2_send_gpu14_to_5
	l2_send_gpu14_to_5 -> l2_recv_gpu14_to_5
	l2_recv_gpu14_to_5 -> l2_local_tokens_gpu5
	l2_token_split_gpu14 -> l2_send_gpu14_to_6
	l2_send_gpu14_to_6 -> l2_recv_gpu14_to_6
	l2_recv_gpu14_to_6 -> l2_local_tokens_gpu6
	l2_token_split_gpu14 -> l2_send_gpu14_to_7
	l2_send_gpu14_to_7 -> l2_recv_gpu14_to_7
	l2_recv_gpu14_to_7 -> l2_local_tokens_gpu7
	l2_token_split_gpu14 -> l2_send_gpu14_to_8
	l2_send_gpu14_to_8 -> l2_recv_gpu14_to_8
	l2_recv_gpu14_to_8 -> l2_local_tokens_gpu8
	l2_token_split_gpu14 -> l2_send_gpu14_to_9
	l2_send_gpu14_to_9 -> l2_recv_gpu14_to_9
	l2_recv_gpu14_to_9 -> l2_local_tokens_gpu9
	l2_token_split_gpu14 -> l2_send_gpu14_to_10
	l2_send_gpu14_to_10 -> l2_recv_gpu14_to_10
	l2_recv_gpu14_to_10 -> l2_local_tokens_gpu10
	l2_token_split_gpu14 -> l2_send_gpu14_to_11
	l2_send_gpu14_to_11 -> l2_recv_gpu14_to_11
	l2_recv_gpu14_to_11 -> l2_local_tokens_gpu11
	l2_token_split_gpu14 -> l2_send_gpu14_to_12
	l2_send_gpu14_to_12 -> l2_recv_gpu14_to_12
	l2_recv_gpu14_to_12 -> l2_local_tokens_gpu12
	l2_token_split_gpu14 -> l2_send_gpu14_to_13
	l2_send_gpu14_to_13 -> l2_recv_gpu14_to_13
	l2_recv_gpu14_to_13 -> l2_local_tokens_gpu13
	l2_token_split_gpu14 -> l2_send_gpu14_to_15
	l2_send_gpu14_to_15 -> l2_recv_gpu14_to_15
	l2_recv_gpu14_to_15 -> l2_local_tokens_gpu15
	l2_token_split_gpu14 -> l2_local_tokens_gpu14
	l2_local_tokens_gpu14 -> l2_expert_gpu14
	l2_expert_gpu0 -> l2_expert_agg_gpu14
	l2_expert_gpu1 -> l2_expert_agg_gpu14
	l2_expert_gpu2 -> l2_expert_agg_gpu14
	l2_expert_gpu3 -> l2_expert_agg_gpu14
	l2_expert_gpu4 -> l2_expert_agg_gpu14
	l2_expert_gpu5 -> l2_expert_agg_gpu14
	l2_expert_gpu6 -> l2_expert_agg_gpu14
	l2_expert_gpu7 -> l2_expert_agg_gpu14
	l2_expert_gpu8 -> l2_expert_agg_gpu14
	l2_expert_gpu9 -> l2_expert_agg_gpu14
	l2_expert_gpu10 -> l2_expert_agg_gpu14
	l2_expert_gpu11 -> l2_expert_agg_gpu14
	l2_expert_gpu12 -> l2_expert_agg_gpu14
	l2_expert_gpu13 -> l2_expert_agg_gpu14
	l2_expert_gpu14 -> l2_expert_agg_gpu14
	l2_expert_gpu15 -> l2_expert_agg_gpu14
	l2_attn_residual_gpu14 -> l2_final_residual_gpu14
	l2_expert_agg_gpu14 -> l2_final_residual_gpu14
	l2_qkv_gpu15 -> l2_attn_gpu15
	l2_attn_gpu15 -> l2_out_proj_gpu15
	l2_out_proj_gpu15 -> l2_attn_residual_gpu15
	l1_final_residual_gpu15 -> l2_attn_residual_gpu15
	l2_attn_residual_gpu15 -> l2_gate_gpu15
	l2_attn_residual_gpu15 -> l2_token_split_gpu15
	l2_gate_gpu15 -> l2_token_split_gpu15 [style=dashed]
	l2_token_split_gpu15 -> l2_send_gpu15_to_0
	l2_send_gpu15_to_0 -> l2_recv_gpu15_to_0
	l2_recv_gpu15_to_0 -> l2_local_tokens_gpu0
	l2_token_split_gpu15 -> l2_send_gpu15_to_1
	l2_send_gpu15_to_1 -> l2_recv_gpu15_to_1
	l2_recv_gpu15_to_1 -> l2_local_tokens_gpu1
	l2_token_split_gpu15 -> l2_send_gpu15_to_2
	l2_send_gpu15_to_2 -> l2_recv_gpu15_to_2
	l2_recv_gpu15_to_2 -> l2_local_tokens_gpu2
	l2_token_split_gpu15 -> l2_send_gpu15_to_3
	l2_send_gpu15_to_3 -> l2_recv_gpu15_to_3
	l2_recv_gpu15_to_3 -> l2_local_tokens_gpu3
	l2_token_split_gpu15 -> l2_send_gpu15_to_4
	l2_send_gpu15_to_4 -> l2_recv_gpu15_to_4
	l2_recv_gpu15_to_4 -> l2_local_tokens_gpu4
	l2_token_split_gpu15 -> l2_send_gpu15_to_5
	l2_send_gpu15_to_5 -> l2_recv_gpu15_to_5
	l2_recv_gpu15_to_5 -> l2_local_tokens_gpu5
	l2_token_split_gpu15 -> l2_send_gpu15_to_6
	l2_send_gpu15_to_6 -> l2_recv_gpu15_to_6
	l2_recv_gpu15_to_6 -> l2_local_tokens_gpu6
	l2_token_split_gpu15 -> l2_send_gpu15_to_7
	l2_send_gpu15_to_7 -> l2_recv_gpu15_to_7
	l2_recv_gpu15_to_7 -> l2_local_tokens_gpu7
	l2_token_split_gpu15 -> l2_send_gpu15_to_8
	l2_send_gpu15_to_8 -> l2_recv_gpu15_to_8
	l2_recv_gpu15_to_8 -> l2_local_tokens_gpu8
	l2_token_split_gpu15 -> l2_send_gpu15_to_9
	l2_send_gpu15_to_9 -> l2_recv_gpu15_to_9
	l2_recv_gpu15_to_9 -> l2_local_tokens_gpu9
	l2_token_split_gpu15 -> l2_send_gpu15_to_10
	l2_send_gpu15_to_10 -> l2_recv_gpu15_to_10
	l2_recv_gpu15_to_10 -> l2_local_tokens_gpu10
	l2_token_split_gpu15 -> l2_send_gpu15_to_11
	l2_send_gpu15_to_11 -> l2_recv_gpu15_to_11
	l2_recv_gpu15_to_11 -> l2_local_tokens_gpu11
	l2_token_split_gpu15 -> l2_send_gpu15_to_12
	l2_send_gpu15_to_12 -> l2_recv_gpu15_to_12
	l2_recv_gpu15_to_12 -> l2_local_tokens_gpu12
	l2_token_split_gpu15 -> l2_send_gpu15_to_13
	l2_send_gpu15_to_13 -> l2_recv_gpu15_to_13
	l2_recv_gpu15_to_13 -> l2_local_tokens_gpu13
	l2_token_split_gpu15 -> l2_send_gpu15_to_14
	l2_send_gpu15_to_14 -> l2_recv_gpu15_to_14
	l2_recv_gpu15_to_14 -> l2_local_tokens_gpu14
	l2_token_split_gpu15 -> l2_local_tokens_gpu15
	l2_local_tokens_gpu15 -> l2_expert_gpu15
	l2_expert_gpu0 -> l2_expert_agg_gpu15
	l2_expert_gpu1 -> l2_expert_agg_gpu15
	l2_expert_gpu2 -> l2_expert_agg_gpu15
	l2_expert_gpu3 -> l2_expert_agg_gpu15
	l2_expert_gpu4 -> l2_expert_agg_gpu15
	l2_expert_gpu5 -> l2_expert_agg_gpu15
	l2_expert_gpu6 -> l2_expert_agg_gpu15
	l2_expert_gpu7 -> l2_expert_agg_gpu15
	l2_expert_gpu8 -> l2_expert_agg_gpu15
	l2_expert_gpu9 -> l2_expert_agg_gpu15
	l2_expert_gpu10 -> l2_expert_agg_gpu15
	l2_expert_gpu11 -> l2_expert_agg_gpu15
	l2_expert_gpu12 -> l2_expert_agg_gpu15
	l2_expert_gpu13 -> l2_expert_agg_gpu15
	l2_expert_gpu14 -> l2_expert_agg_gpu15
	l2_expert_gpu15 -> l2_expert_agg_gpu15
	l2_attn_residual_gpu15 -> l2_final_residual_gpu15
	l2_expert_agg_gpu15 -> l2_final_residual_gpu15
	l2_final_residual_gpu0 -> l3_qkv_gpu0
	l2_final_residual_gpu1 -> l3_qkv_gpu1
	l2_final_residual_gpu2 -> l3_qkv_gpu2
	l2_final_residual_gpu3 -> l3_qkv_gpu3
	l2_final_residual_gpu4 -> l3_qkv_gpu4
	l2_final_residual_gpu5 -> l3_qkv_gpu5
	l2_final_residual_gpu6 -> l3_qkv_gpu6
	l2_final_residual_gpu7 -> l3_qkv_gpu7
	l2_final_residual_gpu8 -> l3_qkv_gpu8
	l2_final_residual_gpu9 -> l3_qkv_gpu9
	l2_final_residual_gpu10 -> l3_qkv_gpu10
	l2_final_residual_gpu11 -> l3_qkv_gpu11
	l2_final_residual_gpu12 -> l3_qkv_gpu12
	l2_final_residual_gpu13 -> l3_qkv_gpu13
	l2_final_residual_gpu14 -> l3_qkv_gpu14
	l2_final_residual_gpu15 -> l3_qkv_gpu15
	l3_qkv_gpu0 -> l3_attn_gpu0
	l3_attn_gpu0 -> l3_out_proj_gpu0
	l3_out_proj_gpu0 -> l3_attn_residual_gpu0
	l2_final_residual_gpu0 -> l3_attn_residual_gpu0
	l3_attn_residual_gpu0 -> l3_gate_gpu0
	l3_attn_residual_gpu0 -> l3_token_split_gpu0
	l3_gate_gpu0 -> l3_token_split_gpu0 [style=dashed]
	l3_token_split_gpu0 -> l3_send_gpu0_to_1
	l3_send_gpu0_to_1 -> l3_recv_gpu0_to_1
	l3_recv_gpu0_to_1 -> l3_local_tokens_gpu1
	l3_token_split_gpu0 -> l3_send_gpu0_to_2
	l3_send_gpu0_to_2 -> l3_recv_gpu0_to_2
	l3_recv_gpu0_to_2 -> l3_local_tokens_gpu2
	l3_token_split_gpu0 -> l3_send_gpu0_to_3
	l3_send_gpu0_to_3 -> l3_recv_gpu0_to_3
	l3_recv_gpu0_to_3 -> l3_local_tokens_gpu3
	l3_token_split_gpu0 -> l3_send_gpu0_to_4
	l3_send_gpu0_to_4 -> l3_recv_gpu0_to_4
	l3_recv_gpu0_to_4 -> l3_local_tokens_gpu4
	l3_token_split_gpu0 -> l3_send_gpu0_to_5
	l3_send_gpu0_to_5 -> l3_recv_gpu0_to_5
	l3_recv_gpu0_to_5 -> l3_local_tokens_gpu5
	l3_token_split_gpu0 -> l3_send_gpu0_to_6
	l3_send_gpu0_to_6 -> l3_recv_gpu0_to_6
	l3_recv_gpu0_to_6 -> l3_local_tokens_gpu6
	l3_token_split_gpu0 -> l3_send_gpu0_to_7
	l3_send_gpu0_to_7 -> l3_recv_gpu0_to_7
	l3_recv_gpu0_to_7 -> l3_local_tokens_gpu7
	l3_token_split_gpu0 -> l3_send_gpu0_to_8
	l3_send_gpu0_to_8 -> l3_recv_gpu0_to_8
	l3_recv_gpu0_to_8 -> l3_local_tokens_gpu8
	l3_token_split_gpu0 -> l3_send_gpu0_to_9
	l3_send_gpu0_to_9 -> l3_recv_gpu0_to_9
	l3_recv_gpu0_to_9 -> l3_local_tokens_gpu9
	l3_token_split_gpu0 -> l3_send_gpu0_to_10
	l3_send_gpu0_to_10 -> l3_recv_gpu0_to_10
	l3_recv_gpu0_to_10 -> l3_local_tokens_gpu10
	l3_token_split_gpu0 -> l3_send_gpu0_to_11
	l3_send_gpu0_to_11 -> l3_recv_gpu0_to_11
	l3_recv_gpu0_to_11 -> l3_local_tokens_gpu11
	l3_token_split_gpu0 -> l3_send_gpu0_to_12
	l3_send_gpu0_to_12 -> l3_recv_gpu0_to_12
	l3_recv_gpu0_to_12 -> l3_local_tokens_gpu12
	l3_token_split_gpu0 -> l3_send_gpu0_to_13
	l3_send_gpu0_to_13 -> l3_recv_gpu0_to_13
	l3_recv_gpu0_to_13 -> l3_local_tokens_gpu13
	l3_token_split_gpu0 -> l3_send_gpu0_to_14
	l3_send_gpu0_to_14 -> l3_recv_gpu0_to_14
	l3_recv_gpu0_to_14 -> l3_local_tokens_gpu14
	l3_token_split_gpu0 -> l3_send_gpu0_to_15
	l3_send_gpu0_to_15 -> l3_recv_gpu0_to_15
	l3_recv_gpu0_to_15 -> l3_local_tokens_gpu15
	l3_token_split_gpu0 -> l3_local_tokens_gpu0
	l3_local_tokens_gpu0 -> l3_expert_gpu0
	l3_expert_gpu0 -> l3_expert_agg_gpu0
	l3_expert_gpu1 -> l3_expert_agg_gpu0
	l3_expert_gpu2 -> l3_expert_agg_gpu0
	l3_expert_gpu3 -> l3_expert_agg_gpu0
	l3_expert_gpu4 -> l3_expert_agg_gpu0
	l3_expert_gpu5 -> l3_expert_agg_gpu0
	l3_expert_gpu6 -> l3_expert_agg_gpu0
	l3_expert_gpu7 -> l3_expert_agg_gpu0
	l3_expert_gpu8 -> l3_expert_agg_gpu0
	l3_expert_gpu9 -> l3_expert_agg_gpu0
	l3_expert_gpu10 -> l3_expert_agg_gpu0
	l3_expert_gpu11 -> l3_expert_agg_gpu0
	l3_expert_gpu12 -> l3_expert_agg_gpu0
	l3_expert_gpu13 -> l3_expert_agg_gpu0
	l3_expert_gpu14 -> l3_expert_agg_gpu0
	l3_expert_gpu15 -> l3_expert_agg_gpu0
	l3_attn_residual_gpu0 -> l3_final_residual_gpu0
	l3_expert_agg_gpu0 -> l3_final_residual_gpu0
	l3_qkv_gpu1 -> l3_attn_gpu1
	l3_attn_gpu1 -> l3_out_proj_gpu1
	l3_out_proj_gpu1 -> l3_attn_residual_gpu1
	l2_final_residual_gpu1 -> l3_attn_residual_gpu1
	l3_attn_residual_gpu1 -> l3_gate_gpu1
	l3_attn_residual_gpu1 -> l3_token_split_gpu1
	l3_gate_gpu1 -> l3_token_split_gpu1 [style=dashed]
	l3_token_split_gpu1 -> l3_send_gpu1_to_0
	l3_send_gpu1_to_0 -> l3_recv_gpu1_to_0
	l3_recv_gpu1_to_0 -> l3_local_tokens_gpu0
	l3_token_split_gpu1 -> l3_send_gpu1_to_2
	l3_send_gpu1_to_2 -> l3_recv_gpu1_to_2
	l3_recv_gpu1_to_2 -> l3_local_tokens_gpu2
	l3_token_split_gpu1 -> l3_send_gpu1_to_3
	l3_send_gpu1_to_3 -> l3_recv_gpu1_to_3
	l3_recv_gpu1_to_3 -> l3_local_tokens_gpu3
	l3_token_split_gpu1 -> l3_send_gpu1_to_4
	l3_send_gpu1_to_4 -> l3_recv_gpu1_to_4
	l3_recv_gpu1_to_4 -> l3_local_tokens_gpu4
	l3_token_split_gpu1 -> l3_send_gpu1_to_5
	l3_send_gpu1_to_5 -> l3_recv_gpu1_to_5
	l3_recv_gpu1_to_5 -> l3_local_tokens_gpu5
	l3_token_split_gpu1 -> l3_send_gpu1_to_6
	l3_send_gpu1_to_6 -> l3_recv_gpu1_to_6
	l3_recv_gpu1_to_6 -> l3_local_tokens_gpu6
	l3_token_split_gpu1 -> l3_send_gpu1_to_7
	l3_send_gpu1_to_7 -> l3_recv_gpu1_to_7
	l3_recv_gpu1_to_7 -> l3_local_tokens_gpu7
	l3_token_split_gpu1 -> l3_send_gpu1_to_8
	l3_send_gpu1_to_8 -> l3_recv_gpu1_to_8
	l3_recv_gpu1_to_8 -> l3_local_tokens_gpu8
	l3_token_split_gpu1 -> l3_send_gpu1_to_9
	l3_send_gpu1_to_9 -> l3_recv_gpu1_to_9
	l3_recv_gpu1_to_9 -> l3_local_tokens_gpu9
	l3_token_split_gpu1 -> l3_send_gpu1_to_10
	l3_send_gpu1_to_10 -> l3_recv_gpu1_to_10
	l3_recv_gpu1_to_10 -> l3_local_tokens_gpu10
	l3_token_split_gpu1 -> l3_send_gpu1_to_11
	l3_send_gpu1_to_11 -> l3_recv_gpu1_to_11
	l3_recv_gpu1_to_11 -> l3_local_tokens_gpu11
	l3_token_split_gpu1 -> l3_send_gpu1_to_12
	l3_send_gpu1_to_12 -> l3_recv_gpu1_to_12
	l3_recv_gpu1_to_12 -> l3_local_tokens_gpu12
	l3_token_split_gpu1 -> l3_send_gpu1_to_13
	l3_send_gpu1_to_13 -> l3_recv_gpu1_to_13
	l3_recv_gpu1_to_13 -> l3_local_tokens_gpu13
	l3_token_split_gpu1 -> l3_send_gpu1_to_14
	l3_send_gpu1_to_14 -> l3_recv_gpu1_to_14
	l3_recv_gpu1_to_14 -> l3_local_tokens_gpu14
	l3_token_split_gpu1 -> l3_send_gpu1_to_15
	l3_send_gpu1_to_15 -> l3_recv_gpu1_to_15
	l3_recv_gpu1_to_15 -> l3_local_tokens_gpu15
	l3_token_split_gpu1 -> l3_local_tokens_gpu1
	l3_local_tokens_gpu1 -> l3_expert_gpu1
	l3_expert_gpu0 -> l3_expert_agg_gpu1
	l3_expert_gpu1 -> l3_expert_agg_gpu1
	l3_expert_gpu2 -> l3_expert_agg_gpu1
	l3_expert_gpu3 -> l3_expert_agg_gpu1
	l3_expert_gpu4 -> l3_expert_agg_gpu1
	l3_expert_gpu5 -> l3_expert_agg_gpu1
	l3_expert_gpu6 -> l3_expert_agg_gpu1
	l3_expert_gpu7 -> l3_expert_agg_gpu1
	l3_expert_gpu8 -> l3_expert_agg_gpu1
	l3_expert_gpu9 -> l3_expert_agg_gpu1
	l3_expert_gpu10 -> l3_expert_agg_gpu1
	l3_expert_gpu11 -> l3_expert_agg_gpu1
	l3_expert_gpu12 -> l3_expert_agg_gpu1
	l3_expert_gpu13 -> l3_expert_agg_gpu1
	l3_expert_gpu14 -> l3_expert_agg_gpu1
	l3_expert_gpu15 -> l3_expert_agg_gpu1
	l3_attn_residual_gpu1 -> l3_final_residual_gpu1
	l3_expert_agg_gpu1 -> l3_final_residual_gpu1
	l3_qkv_gpu2 -> l3_attn_gpu2
	l3_attn_gpu2 -> l3_out_proj_gpu2
	l3_out_proj_gpu2 -> l3_attn_residual_gpu2
	l2_final_residual_gpu2 -> l3_attn_residual_gpu2
	l3_attn_residual_gpu2 -> l3_gate_gpu2
	l3_attn_residual_gpu2 -> l3_token_split_gpu2
	l3_gate_gpu2 -> l3_token_split_gpu2 [style=dashed]
	l3_token_split_gpu2 -> l3_send_gpu2_to_0
	l3_send_gpu2_to_0 -> l3_recv_gpu2_to_0
	l3_recv_gpu2_to_0 -> l3_local_tokens_gpu0
	l3_token_split_gpu2 -> l3_send_gpu2_to_1
	l3_send_gpu2_to_1 -> l3_recv_gpu2_to_1
	l3_recv_gpu2_to_1 -> l3_local_tokens_gpu1
	l3_token_split_gpu2 -> l3_send_gpu2_to_3
	l3_send_gpu2_to_3 -> l3_recv_gpu2_to_3
	l3_recv_gpu2_to_3 -> l3_local_tokens_gpu3
	l3_token_split_gpu2 -> l3_send_gpu2_to_4
	l3_send_gpu2_to_4 -> l3_recv_gpu2_to_4
	l3_recv_gpu2_to_4 -> l3_local_tokens_gpu4
	l3_token_split_gpu2 -> l3_send_gpu2_to_5
	l3_send_gpu2_to_5 -> l3_recv_gpu2_to_5
	l3_recv_gpu2_to_5 -> l3_local_tokens_gpu5
	l3_token_split_gpu2 -> l3_send_gpu2_to_6
	l3_send_gpu2_to_6 -> l3_recv_gpu2_to_6
	l3_recv_gpu2_to_6 -> l3_local_tokens_gpu6
	l3_token_split_gpu2 -> l3_send_gpu2_to_7
	l3_send_gpu2_to_7 -> l3_recv_gpu2_to_7
	l3_recv_gpu2_to_7 -> l3_local_tokens_gpu7
	l3_token_split_gpu2 -> l3_send_gpu2_to_8
	l3_send_gpu2_to_8 -> l3_recv_gpu2_to_8
	l3_recv_gpu2_to_8 -> l3_local_tokens_gpu8
	l3_token_split_gpu2 -> l3_send_gpu2_to_9
	l3_send_gpu2_to_9 -> l3_recv_gpu2_to_9
	l3_recv_gpu2_to_9 -> l3_local_tokens_gpu9
	l3_token_split_gpu2 -> l3_send_gpu2_to_10
	l3_send_gpu2_to_10 -> l3_recv_gpu2_to_10
	l3_recv_gpu2_to_10 -> l3_local_tokens_gpu10
	l3_token_split_gpu2 -> l3_send_gpu2_to_11
	l3_send_gpu2_to_11 -> l3_recv_gpu2_to_11
	l3_recv_gpu2_to_11 -> l3_local_tokens_gpu11
	l3_token_split_gpu2 -> l3_send_gpu2_to_12
	l3_send_gpu2_to_12 -> l3_recv_gpu2_to_12
	l3_recv_gpu2_to_12 -> l3_local_tokens_gpu12
	l3_token_split_gpu2 -> l3_send_gpu2_to_13
	l3_send_gpu2_to_13 -> l3_recv_gpu2_to_13
	l3_recv_gpu2_to_13 -> l3_local_tokens_gpu13
	l3_token_split_gpu2 -> l3_send_gpu2_to_14
	l3_send_gpu2_to_14 -> l3_recv_gpu2_to_14
	l3_recv_gpu2_to_14 -> l3_local_tokens_gpu14
	l3_token_split_gpu2 -> l3_send_gpu2_to_15
	l3_send_gpu2_to_15 -> l3_recv_gpu2_to_15
	l3_recv_gpu2_to_15 -> l3_local_tokens_gpu15
	l3_token_split_gpu2 -> l3_local_tokens_gpu2
	l3_local_tokens_gpu2 -> l3_expert_gpu2
	l3_expert_gpu0 -> l3_expert_agg_gpu2
	l3_expert_gpu1 -> l3_expert_agg_gpu2
	l3_expert_gpu2 -> l3_expert_agg_gpu2
	l3_expert_gpu3 -> l3_expert_agg_gpu2
	l3_expert_gpu4 -> l3_expert_agg_gpu2
	l3_expert_gpu5 -> l3_expert_agg_gpu2
	l3_expert_gpu6 -> l3_expert_agg_gpu2
	l3_expert_gpu7 -> l3_expert_agg_gpu2
	l3_expert_gpu8 -> l3_expert_agg_gpu2
	l3_expert_gpu9 -> l3_expert_agg_gpu2
	l3_expert_gpu10 -> l3_expert_agg_gpu2
	l3_expert_gpu11 -> l3_expert_agg_gpu2
	l3_expert_gpu12 -> l3_expert_agg_gpu2
	l3_expert_gpu13 -> l3_expert_agg_gpu2
	l3_expert_gpu14 -> l3_expert_agg_gpu2
	l3_expert_gpu15 -> l3_expert_agg_gpu2
	l3_attn_residual_gpu2 -> l3_final_residual_gpu2
	l3_expert_agg_gpu2 -> l3_final_residual_gpu2
	l3_qkv_gpu3 -> l3_attn_gpu3
	l3_attn_gpu3 -> l3_out_proj_gpu3
	l3_out_proj_gpu3 -> l3_attn_residual_gpu3
	l2_final_residual_gpu3 -> l3_attn_residual_gpu3
	l3_attn_residual_gpu3 -> l3_gate_gpu3
	l3_attn_residual_gpu3 -> l3_token_split_gpu3
	l3_gate_gpu3 -> l3_token_split_gpu3 [style=dashed]
	l3_token_split_gpu3 -> l3_send_gpu3_to_0
	l3_send_gpu3_to_0 -> l3_recv_gpu3_to_0
	l3_recv_gpu3_to_0 -> l3_local_tokens_gpu0
	l3_token_split_gpu3 -> l3_send_gpu3_to_1
	l3_send_gpu3_to_1 -> l3_recv_gpu3_to_1
	l3_recv_gpu3_to_1 -> l3_local_tokens_gpu1
	l3_token_split_gpu3 -> l3_send_gpu3_to_2
	l3_send_gpu3_to_2 -> l3_recv_gpu3_to_2
	l3_recv_gpu3_to_2 -> l3_local_tokens_gpu2
	l3_token_split_gpu3 -> l3_send_gpu3_to_4
	l3_send_gpu3_to_4 -> l3_recv_gpu3_to_4
	l3_recv_gpu3_to_4 -> l3_local_tokens_gpu4
	l3_token_split_gpu3 -> l3_send_gpu3_to_5
	l3_send_gpu3_to_5 -> l3_recv_gpu3_to_5
	l3_recv_gpu3_to_5 -> l3_local_tokens_gpu5
	l3_token_split_gpu3 -> l3_send_gpu3_to_6
	l3_send_gpu3_to_6 -> l3_recv_gpu3_to_6
	l3_recv_gpu3_to_6 -> l3_local_tokens_gpu6
	l3_token_split_gpu3 -> l3_send_gpu3_to_7
	l3_send_gpu3_to_7 -> l3_recv_gpu3_to_7
	l3_recv_gpu3_to_7 -> l3_local_tokens_gpu7
	l3_token_split_gpu3 -> l3_send_gpu3_to_8
	l3_send_gpu3_to_8 -> l3_recv_gpu3_to_8
	l3_recv_gpu3_to_8 -> l3_local_tokens_gpu8
	l3_token_split_gpu3 -> l3_send_gpu3_to_9
	l3_send_gpu3_to_9 -> l3_recv_gpu3_to_9
	l3_recv_gpu3_to_9 -> l3_local_tokens_gpu9
	l3_token_split_gpu3 -> l3_send_gpu3_to_10
	l3_send_gpu3_to_10 -> l3_recv_gpu3_to_10
	l3_recv_gpu3_to_10 -> l3_local_tokens_gpu10
	l3_token_split_gpu3 -> l3_send_gpu3_to_11
	l3_send_gpu3_to_11 -> l3_recv_gpu3_to_11
	l3_recv_gpu3_to_11 -> l3_local_tokens_gpu11
	l3_token_split_gpu3 -> l3_send_gpu3_to_12
	l3_send_gpu3_to_12 -> l3_recv_gpu3_to_12
	l3_recv_gpu3_to_12 -> l3_local_tokens_gpu12
	l3_token_split_gpu3 -> l3_send_gpu3_to_13
	l3_send_gpu3_to_13 -> l3_recv_gpu3_to_13
	l3_recv_gpu3_to_13 -> l3_local_tokens_gpu13
	l3_token_split_gpu3 -> l3_send_gpu3_to_14
	l3_send_gpu3_to_14 -> l3_recv_gpu3_to_14
	l3_recv_gpu3_to_14 -> l3_local_tokens_gpu14
	l3_token_split_gpu3 -> l3_send_gpu3_to_15
	l3_send_gpu3_to_15 -> l3_recv_gpu3_to_15
	l3_recv_gpu3_to_15 -> l3_local_tokens_gpu15
	l3_token_split_gpu3 -> l3_local_tokens_gpu3
	l3_local_tokens_gpu3 -> l3_expert_gpu3
	l3_expert_gpu0 -> l3_expert_agg_gpu3
	l3_expert_gpu1 -> l3_expert_agg_gpu3
	l3_expert_gpu2 -> l3_expert_agg_gpu3
	l3_expert_gpu3 -> l3_expert_agg_gpu3
	l3_expert_gpu4 -> l3_expert_agg_gpu3
	l3_expert_gpu5 -> l3_expert_agg_gpu3
	l3_expert_gpu6 -> l3_expert_agg_gpu3
	l3_expert_gpu7 -> l3_expert_agg_gpu3
	l3_expert_gpu8 -> l3_expert_agg_gpu3
	l3_expert_gpu9 -> l3_expert_agg_gpu3
	l3_expert_gpu10 -> l3_expert_agg_gpu3
	l3_expert_gpu11 -> l3_expert_agg_gpu3
	l3_expert_gpu12 -> l3_expert_agg_gpu3
	l3_expert_gpu13 -> l3_expert_agg_gpu3
	l3_expert_gpu14 -> l3_expert_agg_gpu3
	l3_expert_gpu15 -> l3_expert_agg_gpu3
	l3_attn_residual_gpu3 -> l3_final_residual_gpu3
	l3_expert_agg_gpu3 -> l3_final_residual_gpu3
	l3_qkv_gpu4 -> l3_attn_gpu4
	l3_attn_gpu4 -> l3_out_proj_gpu4
	l3_out_proj_gpu4 -> l3_attn_residual_gpu4
	l2_final_residual_gpu4 -> l3_attn_residual_gpu4
	l3_attn_residual_gpu4 -> l3_gate_gpu4
	l3_attn_residual_gpu4 -> l3_token_split_gpu4
	l3_gate_gpu4 -> l3_token_split_gpu4 [style=dashed]
	l3_token_split_gpu4 -> l3_send_gpu4_to_0
	l3_send_gpu4_to_0 -> l3_recv_gpu4_to_0
	l3_recv_gpu4_to_0 -> l3_local_tokens_gpu0
	l3_token_split_gpu4 -> l3_send_gpu4_to_1
	l3_send_gpu4_to_1 -> l3_recv_gpu4_to_1
	l3_recv_gpu4_to_1 -> l3_local_tokens_gpu1
	l3_token_split_gpu4 -> l3_send_gpu4_to_2
	l3_send_gpu4_to_2 -> l3_recv_gpu4_to_2
	l3_recv_gpu4_to_2 -> l3_local_tokens_gpu2
	l3_token_split_gpu4 -> l3_send_gpu4_to_3
	l3_send_gpu4_to_3 -> l3_recv_gpu4_to_3
	l3_recv_gpu4_to_3 -> l3_local_tokens_gpu3
	l3_token_split_gpu4 -> l3_send_gpu4_to_5
	l3_send_gpu4_to_5 -> l3_recv_gpu4_to_5
	l3_recv_gpu4_to_5 -> l3_local_tokens_gpu5
	l3_token_split_gpu4 -> l3_send_gpu4_to_6
	l3_send_gpu4_to_6 -> l3_recv_gpu4_to_6
	l3_recv_gpu4_to_6 -> l3_local_tokens_gpu6
	l3_token_split_gpu4 -> l3_send_gpu4_to_7
	l3_send_gpu4_to_7 -> l3_recv_gpu4_to_7
	l3_recv_gpu4_to_7 -> l3_local_tokens_gpu7
	l3_token_split_gpu4 -> l3_send_gpu4_to_8
	l3_send_gpu4_to_8 -> l3_recv_gpu4_to_8
	l3_recv_gpu4_to_8 -> l3_local_tokens_gpu8
	l3_token_split_gpu4 -> l3_send_gpu4_to_9
	l3_send_gpu4_to_9 -> l3_recv_gpu4_to_9
	l3_recv_gpu4_to_9 -> l3_local_tokens_gpu9
	l3_token_split_gpu4 -> l3_send_gpu4_to_10
	l3_send_gpu4_to_10 -> l3_recv_gpu4_to_10
	l3_recv_gpu4_to_10 -> l3_local_tokens_gpu10
	l3_token_split_gpu4 -> l3_send_gpu4_to_11
	l3_send_gpu4_to_11 -> l3_recv_gpu4_to_11
	l3_recv_gpu4_to_11 -> l3_local_tokens_gpu11
	l3_token_split_gpu4 -> l3_send_gpu4_to_12
	l3_send_gpu4_to_12 -> l3_recv_gpu4_to_12
	l3_recv_gpu4_to_12 -> l3_local_tokens_gpu12
	l3_token_split_gpu4 -> l3_send_gpu4_to_13
	l3_send_gpu4_to_13 -> l3_recv_gpu4_to_13
	l3_recv_gpu4_to_13 -> l3_local_tokens_gpu13
	l3_token_split_gpu4 -> l3_send_gpu4_to_14
	l3_send_gpu4_to_14 -> l3_recv_gpu4_to_14
	l3_recv_gpu4_to_14 -> l3_local_tokens_gpu14
	l3_token_split_gpu4 -> l3_send_gpu4_to_15
	l3_send_gpu4_to_15 -> l3_recv_gpu4_to_15
	l3_recv_gpu4_to_15 -> l3_local_tokens_gpu15
	l3_token_split_gpu4 -> l3_local_tokens_gpu4
	l3_local_tokens_gpu4 -> l3_expert_gpu4
	l3_expert_gpu0 -> l3_expert_agg_gpu4
	l3_expert_gpu1 -> l3_expert_agg_gpu4
	l3_expert_gpu2 -> l3_expert_agg_gpu4
	l3_expert_gpu3 -> l3_expert_agg_gpu4
	l3_expert_gpu4 -> l3_expert_agg_gpu4
	l3_expert_gpu5 -> l3_expert_agg_gpu4
	l3_expert_gpu6 -> l3_expert_agg_gpu4
	l3_expert_gpu7 -> l3_expert_agg_gpu4
	l3_expert_gpu8 -> l3_expert_agg_gpu4
	l3_expert_gpu9 -> l3_expert_agg_gpu4
	l3_expert_gpu10 -> l3_expert_agg_gpu4
	l3_expert_gpu11 -> l3_expert_agg_gpu4
	l3_expert_gpu12 -> l3_expert_agg_gpu4
	l3_expert_gpu13 -> l3_expert_agg_gpu4
	l3_expert_gpu14 -> l3_expert_agg_gpu4
	l3_expert_gpu15 -> l3_expert_agg_gpu4
	l3_attn_residual_gpu4 -> l3_final_residual_gpu4
	l3_expert_agg_gpu4 -> l3_final_residual_gpu4
	l3_qkv_gpu5 -> l3_attn_gpu5
	l3_attn_gpu5 -> l3_out_proj_gpu5
	l3_out_proj_gpu5 -> l3_attn_residual_gpu5
	l2_final_residual_gpu5 -> l3_attn_residual_gpu5
	l3_attn_residual_gpu5 -> l3_gate_gpu5
	l3_attn_residual_gpu5 -> l3_token_split_gpu5
	l3_gate_gpu5 -> l3_token_split_gpu5 [style=dashed]
	l3_token_split_gpu5 -> l3_send_gpu5_to_0
	l3_send_gpu5_to_0 -> l3_recv_gpu5_to_0
	l3_recv_gpu5_to_0 -> l3_local_tokens_gpu0
	l3_token_split_gpu5 -> l3_send_gpu5_to_1
	l3_send_gpu5_to_1 -> l3_recv_gpu5_to_1
	l3_recv_gpu5_to_1 -> l3_local_tokens_gpu1
	l3_token_split_gpu5 -> l3_send_gpu5_to_2
	l3_send_gpu5_to_2 -> l3_recv_gpu5_to_2
	l3_recv_gpu5_to_2 -> l3_local_tokens_gpu2
	l3_token_split_gpu5 -> l3_send_gpu5_to_3
	l3_send_gpu5_to_3 -> l3_recv_gpu5_to_3
	l3_recv_gpu5_to_3 -> l3_local_tokens_gpu3
	l3_token_split_gpu5 -> l3_send_gpu5_to_4
	l3_send_gpu5_to_4 -> l3_recv_gpu5_to_4
	l3_recv_gpu5_to_4 -> l3_local_tokens_gpu4
	l3_token_split_gpu5 -> l3_send_gpu5_to_6
	l3_send_gpu5_to_6 -> l3_recv_gpu5_to_6
	l3_recv_gpu5_to_6 -> l3_local_tokens_gpu6
	l3_token_split_gpu5 -> l3_send_gpu5_to_7
	l3_send_gpu5_to_7 -> l3_recv_gpu5_to_7
	l3_recv_gpu5_to_7 -> l3_local_tokens_gpu7
	l3_token_split_gpu5 -> l3_send_gpu5_to_8
	l3_send_gpu5_to_8 -> l3_recv_gpu5_to_8
	l3_recv_gpu5_to_8 -> l3_local_tokens_gpu8
	l3_token_split_gpu5 -> l3_send_gpu5_to_9
	l3_send_gpu5_to_9 -> l3_recv_gpu5_to_9
	l3_recv_gpu5_to_9 -> l3_local_tokens_gpu9
	l3_token_split_gpu5 -> l3_send_gpu5_to_10
	l3_send_gpu5_to_10 -> l3_recv_gpu5_to_10
	l3_recv_gpu5_to_10 -> l3_local_tokens_gpu10
	l3_token_split_gpu5 -> l3_send_gpu5_to_11
	l3_send_gpu5_to_11 -> l3_recv_gpu5_to_11
	l3_recv_gpu5_to_11 -> l3_local_tokens_gpu11
	l3_token_split_gpu5 -> l3_send_gpu5_to_12
	l3_send_gpu5_to_12 -> l3_recv_gpu5_to_12
	l3_recv_gpu5_to_12 -> l3_local_tokens_gpu12
	l3_token_split_gpu5 -> l3_send_gpu5_to_13
	l3_send_gpu5_to_13 -> l3_recv_gpu5_to_13
	l3_recv_gpu5_to_13 -> l3_local_tokens_gpu13
	l3_token_split_gpu5 -> l3_send_gpu5_to_14
	l3_send_gpu5_to_14 -> l3_recv_gpu5_to_14
	l3_recv_gpu5_to_14 -> l3_local_tokens_gpu14
	l3_token_split_gpu5 -> l3_send_gpu5_to_15
	l3_send_gpu5_to_15 -> l3_recv_gpu5_to_15
	l3_recv_gpu5_to_15 -> l3_local_tokens_gpu15
	l3_token_split_gpu5 -> l3_local_tokens_gpu5
	l3_local_tokens_gpu5 -> l3_expert_gpu5
	l3_expert_gpu0 -> l3_expert_agg_gpu5
	l3_expert_gpu1 -> l3_expert_agg_gpu5
	l3_expert_gpu2 -> l3_expert_agg_gpu5
	l3_expert_gpu3 -> l3_expert_agg_gpu5
	l3_expert_gpu4 -> l3_expert_agg_gpu5
	l3_expert_gpu5 -> l3_expert_agg_gpu5
	l3_expert_gpu6 -> l3_expert_agg_gpu5
	l3_expert_gpu7 -> l3_expert_agg_gpu5
	l3_expert_gpu8 -> l3_expert_agg_gpu5
	l3_expert_gpu9 -> l3_expert_agg_gpu5
	l3_expert_gpu10 -> l3_expert_agg_gpu5
	l3_expert_gpu11 -> l3_expert_agg_gpu5
	l3_expert_gpu12 -> l3_expert_agg_gpu5
	l3_expert_gpu13 -> l3_expert_agg_gpu5
	l3_expert_gpu14 -> l3_expert_agg_gpu5
	l3_expert_gpu15 -> l3_expert_agg_gpu5
	l3_attn_residual_gpu5 -> l3_final_residual_gpu5
	l3_expert_agg_gpu5 -> l3_final_residual_gpu5
	l3_qkv_gpu6 -> l3_attn_gpu6
	l3_attn_gpu6 -> l3_out_proj_gpu6
	l3_out_proj_gpu6 -> l3_attn_residual_gpu6
	l2_final_residual_gpu6 -> l3_attn_residual_gpu6
	l3_attn_residual_gpu6 -> l3_gate_gpu6
	l3_attn_residual_gpu6 -> l3_token_split_gpu6
	l3_gate_gpu6 -> l3_token_split_gpu6 [style=dashed]
	l3_token_split_gpu6 -> l3_send_gpu6_to_0
	l3_send_gpu6_to_0 -> l3_recv_gpu6_to_0
	l3_recv_gpu6_to_0 -> l3_local_tokens_gpu0
	l3_token_split_gpu6 -> l3_send_gpu6_to_1
	l3_send_gpu6_to_1 -> l3_recv_gpu6_to_1
	l3_recv_gpu6_to_1 -> l3_local_tokens_gpu1
	l3_token_split_gpu6 -> l3_send_gpu6_to_2
	l3_send_gpu6_to_2 -> l3_recv_gpu6_to_2
	l3_recv_gpu6_to_2 -> l3_local_tokens_gpu2
	l3_token_split_gpu6 -> l3_send_gpu6_to_3
	l3_send_gpu6_to_3 -> l3_recv_gpu6_to_3
	l3_recv_gpu6_to_3 -> l3_local_tokens_gpu3
	l3_token_split_gpu6 -> l3_send_gpu6_to_4
	l3_send_gpu6_to_4 -> l3_recv_gpu6_to_4
	l3_recv_gpu6_to_4 -> l3_local_tokens_gpu4
	l3_token_split_gpu6 -> l3_send_gpu6_to_5
	l3_send_gpu6_to_5 -> l3_recv_gpu6_to_5
	l3_recv_gpu6_to_5 -> l3_local_tokens_gpu5
	l3_token_split_gpu6 -> l3_send_gpu6_to_7
	l3_send_gpu6_to_7 -> l3_recv_gpu6_to_7
	l3_recv_gpu6_to_7 -> l3_local_tokens_gpu7
	l3_token_split_gpu6 -> l3_send_gpu6_to_8
	l3_send_gpu6_to_8 -> l3_recv_gpu6_to_8
	l3_recv_gpu6_to_8 -> l3_local_tokens_gpu8
	l3_token_split_gpu6 -> l3_send_gpu6_to_9
	l3_send_gpu6_to_9 -> l3_recv_gpu6_to_9
	l3_recv_gpu6_to_9 -> l3_local_tokens_gpu9
	l3_token_split_gpu6 -> l3_send_gpu6_to_10
	l3_send_gpu6_to_10 -> l3_recv_gpu6_to_10
	l3_recv_gpu6_to_10 -> l3_local_tokens_gpu10
	l3_token_split_gpu6 -> l3_send_gpu6_to_11
	l3_send_gpu6_to_11 -> l3_recv_gpu6_to_11
	l3_recv_gpu6_to_11 -> l3_local_tokens_gpu11
	l3_token_split_gpu6 -> l3_send_gpu6_to_12
	l3_send_gpu6_to_12 -> l3_recv_gpu6_to_12
	l3_recv_gpu6_to_12 -> l3_local_tokens_gpu12
	l3_token_split_gpu6 -> l3_send_gpu6_to_13
	l3_send_gpu6_to_13 -> l3_recv_gpu6_to_13
	l3_recv_gpu6_to_13 -> l3_local_tokens_gpu13
	l3_token_split_gpu6 -> l3_send_gpu6_to_14
	l3_send_gpu6_to_14 -> l3_recv_gpu6_to_14
	l3_recv_gpu6_to_14 -> l3_local_tokens_gpu14
	l3_token_split_gpu6 -> l3_send_gpu6_to_15
	l3_send_gpu6_to_15 -> l3_recv_gpu6_to_15
	l3_recv_gpu6_to_15 -> l3_local_tokens_gpu15
	l3_token_split_gpu6 -> l3_local_tokens_gpu6
	l3_local_tokens_gpu6 -> l3_expert_gpu6
	l3_expert_gpu0 -> l3_expert_agg_gpu6
	l3_expert_gpu1 -> l3_expert_agg_gpu6
	l3_expert_gpu2 -> l3_expert_agg_gpu6
	l3_expert_gpu3 -> l3_expert_agg_gpu6
	l3_expert_gpu4 -> l3_expert_agg_gpu6
	l3_expert_gpu5 -> l3_expert_agg_gpu6
	l3_expert_gpu6 -> l3_expert_agg_gpu6
	l3_expert_gpu7 -> l3_expert_agg_gpu6
	l3_expert_gpu8 -> l3_expert_agg_gpu6
	l3_expert_gpu9 -> l3_expert_agg_gpu6
	l3_expert_gpu10 -> l3_expert_agg_gpu6
	l3_expert_gpu11 -> l3_expert_agg_gpu6
	l3_expert_gpu12 -> l3_expert_agg_gpu6
	l3_expert_gpu13 -> l3_expert_agg_gpu6
	l3_expert_gpu14 -> l3_expert_agg_gpu6
	l3_expert_gpu15 -> l3_expert_agg_gpu6
	l3_attn_residual_gpu6 -> l3_final_residual_gpu6
	l3_expert_agg_gpu6 -> l3_final_residual_gpu6
	l3_qkv_gpu7 -> l3_attn_gpu7
	l3_attn_gpu7 -> l3_out_proj_gpu7
	l3_out_proj_gpu7 -> l3_attn_residual_gpu7
	l2_final_residual_gpu7 -> l3_attn_residual_gpu7
	l3_attn_residual_gpu7 -> l3_gate_gpu7
	l3_attn_residual_gpu7 -> l3_token_split_gpu7
	l3_gate_gpu7 -> l3_token_split_gpu7 [style=dashed]
	l3_token_split_gpu7 -> l3_send_gpu7_to_0
	l3_send_gpu7_to_0 -> l3_recv_gpu7_to_0
	l3_recv_gpu7_to_0 -> l3_local_tokens_gpu0
	l3_token_split_gpu7 -> l3_send_gpu7_to_1
	l3_send_gpu7_to_1 -> l3_recv_gpu7_to_1
	l3_recv_gpu7_to_1 -> l3_local_tokens_gpu1
	l3_token_split_gpu7 -> l3_send_gpu7_to_2
	l3_send_gpu7_to_2 -> l3_recv_gpu7_to_2
	l3_recv_gpu7_to_2 -> l3_local_tokens_gpu2
	l3_token_split_gpu7 -> l3_send_gpu7_to_3
	l3_send_gpu7_to_3 -> l3_recv_gpu7_to_3
	l3_recv_gpu7_to_3 -> l3_local_tokens_gpu3
	l3_token_split_gpu7 -> l3_send_gpu7_to_4
	l3_send_gpu7_to_4 -> l3_recv_gpu7_to_4
	l3_recv_gpu7_to_4 -> l3_local_tokens_gpu4
	l3_token_split_gpu7 -> l3_send_gpu7_to_5
	l3_send_gpu7_to_5 -> l3_recv_gpu7_to_5
	l3_recv_gpu7_to_5 -> l3_local_tokens_gpu5
	l3_token_split_gpu7 -> l3_send_gpu7_to_6
	l3_send_gpu7_to_6 -> l3_recv_gpu7_to_6
	l3_recv_gpu7_to_6 -> l3_local_tokens_gpu6
	l3_token_split_gpu7 -> l3_send_gpu7_to_8
	l3_send_gpu7_to_8 -> l3_recv_gpu7_to_8
	l3_recv_gpu7_to_8 -> l3_local_tokens_gpu8
	l3_token_split_gpu7 -> l3_send_gpu7_to_9
	l3_send_gpu7_to_9 -> l3_recv_gpu7_to_9
	l3_recv_gpu7_to_9 -> l3_local_tokens_gpu9
	l3_token_split_gpu7 -> l3_send_gpu7_to_10
	l3_send_gpu7_to_10 -> l3_recv_gpu7_to_10
	l3_recv_gpu7_to_10 -> l3_local_tokens_gpu10
	l3_token_split_gpu7 -> l3_send_gpu7_to_11
	l3_send_gpu7_to_11 -> l3_recv_gpu7_to_11
	l3_recv_gpu7_to_11 -> l3_local_tokens_gpu11
	l3_token_split_gpu7 -> l3_send_gpu7_to_12
	l3_send_gpu7_to_12 -> l3_recv_gpu7_to_12
	l3_recv_gpu7_to_12 -> l3_local_tokens_gpu12
	l3_token_split_gpu7 -> l3_send_gpu7_to_13
	l3_send_gpu7_to_13 -> l3_recv_gpu7_to_13
	l3_recv_gpu7_to_13 -> l3_local_tokens_gpu13
	l3_token_split_gpu7 -> l3_send_gpu7_to_14
	l3_send_gpu7_to_14 -> l3_recv_gpu7_to_14
	l3_recv_gpu7_to_14 -> l3_local_tokens_gpu14
	l3_token_split_gpu7 -> l3_send_gpu7_to_15
	l3_send_gpu7_to_15 -> l3_recv_gpu7_to_15
	l3_recv_gpu7_to_15 -> l3_local_tokens_gpu15
	l3_token_split_gpu7 -> l3_local_tokens_gpu7
	l3_local_tokens_gpu7 -> l3_expert_gpu7
	l3_expert_gpu0 -> l3_expert_agg_gpu7
	l3_expert_gpu1 -> l3_expert_agg_gpu7
	l3_expert_gpu2 -> l3_expert_agg_gpu7
	l3_expert_gpu3 -> l3_expert_agg_gpu7
	l3_expert_gpu4 -> l3_expert_agg_gpu7
	l3_expert_gpu5 -> l3_expert_agg_gpu7
	l3_expert_gpu6 -> l3_expert_agg_gpu7
	l3_expert_gpu7 -> l3_expert_agg_gpu7
	l3_expert_gpu8 -> l3_expert_agg_gpu7
	l3_expert_gpu9 -> l3_expert_agg_gpu7
	l3_expert_gpu10 -> l3_expert_agg_gpu7
	l3_expert_gpu11 -> l3_expert_agg_gpu7
	l3_expert_gpu12 -> l3_expert_agg_gpu7
	l3_expert_gpu13 -> l3_expert_agg_gpu7
	l3_expert_gpu14 -> l3_expert_agg_gpu7
	l3_expert_gpu15 -> l3_expert_agg_gpu7
	l3_attn_residual_gpu7 -> l3_final_residual_gpu7
	l3_expert_agg_gpu7 -> l3_final_residual_gpu7
	l3_qkv_gpu8 -> l3_attn_gpu8
	l3_attn_gpu8 -> l3_out_proj_gpu8
	l3_out_proj_gpu8 -> l3_attn_residual_gpu8
	l2_final_residual_gpu8 -> l3_attn_residual_gpu8
	l3_attn_residual_gpu8 -> l3_gate_gpu8
	l3_attn_residual_gpu8 -> l3_token_split_gpu8
	l3_gate_gpu8 -> l3_token_split_gpu8 [style=dashed]
	l3_token_split_gpu8 -> l3_send_gpu8_to_0
	l3_send_gpu8_to_0 -> l3_recv_gpu8_to_0
	l3_recv_gpu8_to_0 -> l3_local_tokens_gpu0
	l3_token_split_gpu8 -> l3_send_gpu8_to_1
	l3_send_gpu8_to_1 -> l3_recv_gpu8_to_1
	l3_recv_gpu8_to_1 -> l3_local_tokens_gpu1
	l3_token_split_gpu8 -> l3_send_gpu8_to_2
	l3_send_gpu8_to_2 -> l3_recv_gpu8_to_2
	l3_recv_gpu8_to_2 -> l3_local_tokens_gpu2
	l3_token_split_gpu8 -> l3_send_gpu8_to_3
	l3_send_gpu8_to_3 -> l3_recv_gpu8_to_3
	l3_recv_gpu8_to_3 -> l3_local_tokens_gpu3
	l3_token_split_gpu8 -> l3_send_gpu8_to_4
	l3_send_gpu8_to_4 -> l3_recv_gpu8_to_4
	l3_recv_gpu8_to_4 -> l3_local_tokens_gpu4
	l3_token_split_gpu8 -> l3_send_gpu8_to_5
	l3_send_gpu8_to_5 -> l3_recv_gpu8_to_5
	l3_recv_gpu8_to_5 -> l3_local_tokens_gpu5
	l3_token_split_gpu8 -> l3_send_gpu8_to_6
	l3_send_gpu8_to_6 -> l3_recv_gpu8_to_6
	l3_recv_gpu8_to_6 -> l3_local_tokens_gpu6
	l3_token_split_gpu8 -> l3_send_gpu8_to_7
	l3_send_gpu8_to_7 -> l3_recv_gpu8_to_7
	l3_recv_gpu8_to_7 -> l3_local_tokens_gpu7
	l3_token_split_gpu8 -> l3_send_gpu8_to_9
	l3_send_gpu8_to_9 -> l3_recv_gpu8_to_9
	l3_recv_gpu8_to_9 -> l3_local_tokens_gpu9
	l3_token_split_gpu8 -> l3_send_gpu8_to_10
	l3_send_gpu8_to_10 -> l3_recv_gpu8_to_10
	l3_recv_gpu8_to_10 -> l3_local_tokens_gpu10
	l3_token_split_gpu8 -> l3_send_gpu8_to_11
	l3_send_gpu8_to_11 -> l3_recv_gpu8_to_11
	l3_recv_gpu8_to_11 -> l3_local_tokens_gpu11
	l3_token_split_gpu8 -> l3_send_gpu8_to_12
	l3_send_gpu8_to_12 -> l3_recv_gpu8_to_12
	l3_recv_gpu8_to_12 -> l3_local_tokens_gpu12
	l3_token_split_gpu8 -> l3_send_gpu8_to_13
	l3_send_gpu8_to_13 -> l3_recv_gpu8_to_13
	l3_recv_gpu8_to_13 -> l3_local_tokens_gpu13
	l3_token_split_gpu8 -> l3_send_gpu8_to_14
	l3_send_gpu8_to_14 -> l3_recv_gpu8_to_14
	l3_recv_gpu8_to_14 -> l3_local_tokens_gpu14
	l3_token_split_gpu8 -> l3_send_gpu8_to_15
	l3_send_gpu8_to_15 -> l3_recv_gpu8_to_15
	l3_recv_gpu8_to_15 -> l3_local_tokens_gpu15
	l3_token_split_gpu8 -> l3_local_tokens_gpu8
	l3_local_tokens_gpu8 -> l3_expert_gpu8
	l3_expert_gpu0 -> l3_expert_agg_gpu8
	l3_expert_gpu1 -> l3_expert_agg_gpu8
	l3_expert_gpu2 -> l3_expert_agg_gpu8
	l3_expert_gpu3 -> l3_expert_agg_gpu8
	l3_expert_gpu4 -> l3_expert_agg_gpu8
	l3_expert_gpu5 -> l3_expert_agg_gpu8
	l3_expert_gpu6 -> l3_expert_agg_gpu8
	l3_expert_gpu7 -> l3_expert_agg_gpu8
	l3_expert_gpu8 -> l3_expert_agg_gpu8
	l3_expert_gpu9 -> l3_expert_agg_gpu8
	l3_expert_gpu10 -> l3_expert_agg_gpu8
	l3_expert_gpu11 -> l3_expert_agg_gpu8
	l3_expert_gpu12 -> l3_expert_agg_gpu8
	l3_expert_gpu13 -> l3_expert_agg_gpu8
	l3_expert_gpu14 -> l3_expert_agg_gpu8
	l3_expert_gpu15 -> l3_expert_agg_gpu8
	l3_attn_residual_gpu8 -> l3_final_residual_gpu8
	l3_expert_agg_gpu8 -> l3_final_residual_gpu8
	l3_qkv_gpu9 -> l3_attn_gpu9
	l3_attn_gpu9 -> l3_out_proj_gpu9
	l3_out_proj_gpu9 -> l3_attn_residual_gpu9
	l2_final_residual_gpu9 -> l3_attn_residual_gpu9
	l3_attn_residual_gpu9 -> l3_gate_gpu9
	l3_attn_residual_gpu9 -> l3_token_split_gpu9
	l3_gate_gpu9 -> l3_token_split_gpu9 [style=dashed]
	l3_token_split_gpu9 -> l3_send_gpu9_to_0
	l3_send_gpu9_to_0 -> l3_recv_gpu9_to_0
	l3_recv_gpu9_to_0 -> l3_local_tokens_gpu0
	l3_token_split_gpu9 -> l3_send_gpu9_to_1
	l3_send_gpu9_to_1 -> l3_recv_gpu9_to_1
	l3_recv_gpu9_to_1 -> l3_local_tokens_gpu1
	l3_token_split_gpu9 -> l3_send_gpu9_to_2
	l3_send_gpu9_to_2 -> l3_recv_gpu9_to_2
	l3_recv_gpu9_to_2 -> l3_local_tokens_gpu2
	l3_token_split_gpu9 -> l3_send_gpu9_to_3
	l3_send_gpu9_to_3 -> l3_recv_gpu9_to_3
	l3_recv_gpu9_to_3 -> l3_local_tokens_gpu3
	l3_token_split_gpu9 -> l3_send_gpu9_to_4
	l3_send_gpu9_to_4 -> l3_recv_gpu9_to_4
	l3_recv_gpu9_to_4 -> l3_local_tokens_gpu4
	l3_token_split_gpu9 -> l3_send_gpu9_to_5
	l3_send_gpu9_to_5 -> l3_recv_gpu9_to_5
	l3_recv_gpu9_to_5 -> l3_local_tokens_gpu5
	l3_token_split_gpu9 -> l3_send_gpu9_to_6
	l3_send_gpu9_to_6 -> l3_recv_gpu9_to_6
	l3_recv_gpu9_to_6 -> l3_local_tokens_gpu6
	l3_token_split_gpu9 -> l3_send_gpu9_to_7
	l3_send_gpu9_to_7 -> l3_recv_gpu9_to_7
	l3_recv_gpu9_to_7 -> l3_local_tokens_gpu7
	l3_token_split_gpu9 -> l3_send_gpu9_to_8
	l3_send_gpu9_to_8 -> l3_recv_gpu9_to_8
	l3_recv_gpu9_to_8 -> l3_local_tokens_gpu8
	l3_token_split_gpu9 -> l3_send_gpu9_to_10
	l3_send_gpu9_to_10 -> l3_recv_gpu9_to_10
	l3_recv_gpu9_to_10 -> l3_local_tokens_gpu10
	l3_token_split_gpu9 -> l3_send_gpu9_to_11
	l3_send_gpu9_to_11 -> l3_recv_gpu9_to_11
	l3_recv_gpu9_to_11 -> l3_local_tokens_gpu11
	l3_token_split_gpu9 -> l3_send_gpu9_to_12
	l3_send_gpu9_to_12 -> l3_recv_gpu9_to_12
	l3_recv_gpu9_to_12 -> l3_local_tokens_gpu12
	l3_token_split_gpu9 -> l3_send_gpu9_to_13
	l3_send_gpu9_to_13 -> l3_recv_gpu9_to_13
	l3_recv_gpu9_to_13 -> l3_local_tokens_gpu13
	l3_token_split_gpu9 -> l3_send_gpu9_to_14
	l3_send_gpu9_to_14 -> l3_recv_gpu9_to_14
	l3_recv_gpu9_to_14 -> l3_local_tokens_gpu14
	l3_token_split_gpu9 -> l3_send_gpu9_to_15
	l3_send_gpu9_to_15 -> l3_recv_gpu9_to_15
	l3_recv_gpu9_to_15 -> l3_local_tokens_gpu15
	l3_token_split_gpu9 -> l3_local_tokens_gpu9
	l3_local_tokens_gpu9 -> l3_expert_gpu9
	l3_expert_gpu0 -> l3_expert_agg_gpu9
	l3_expert_gpu1 -> l3_expert_agg_gpu9
	l3_expert_gpu2 -> l3_expert_agg_gpu9
	l3_expert_gpu3 -> l3_expert_agg_gpu9
	l3_expert_gpu4 -> l3_expert_agg_gpu9
	l3_expert_gpu5 -> l3_expert_agg_gpu9
	l3_expert_gpu6 -> l3_expert_agg_gpu9
	l3_expert_gpu7 -> l3_expert_agg_gpu9
	l3_expert_gpu8 -> l3_expert_agg_gpu9
	l3_expert_gpu9 -> l3_expert_agg_gpu9
	l3_expert_gpu10 -> l3_expert_agg_gpu9
	l3_expert_gpu11 -> l3_expert_agg_gpu9
	l3_expert_gpu12 -> l3_expert_agg_gpu9
	l3_expert_gpu13 -> l3_expert_agg_gpu9
	l3_expert_gpu14 -> l3_expert_agg_gpu9
	l3_expert_gpu15 -> l3_expert_agg_gpu9
	l3_attn_residual_gpu9 -> l3_final_residual_gpu9
	l3_expert_agg_gpu9 -> l3_final_residual_gpu9
	l3_qkv_gpu10 -> l3_attn_gpu10
	l3_attn_gpu10 -> l3_out_proj_gpu10
	l3_out_proj_gpu10 -> l3_attn_residual_gpu10
	l2_final_residual_gpu10 -> l3_attn_residual_gpu10
	l3_attn_residual_gpu10 -> l3_gate_gpu10
	l3_attn_residual_gpu10 -> l3_token_split_gpu10
	l3_gate_gpu10 -> l3_token_split_gpu10 [style=dashed]
	l3_token_split_gpu10 -> l3_send_gpu10_to_0
	l3_send_gpu10_to_0 -> l3_recv_gpu10_to_0
	l3_recv_gpu10_to_0 -> l3_local_tokens_gpu0
	l3_token_split_gpu10 -> l3_send_gpu10_to_1
	l3_send_gpu10_to_1 -> l3_recv_gpu10_to_1
	l3_recv_gpu10_to_1 -> l3_local_tokens_gpu1
	l3_token_split_gpu10 -> l3_send_gpu10_to_2
	l3_send_gpu10_to_2 -> l3_recv_gpu10_to_2
	l3_recv_gpu10_to_2 -> l3_local_tokens_gpu2
	l3_token_split_gpu10 -> l3_send_gpu10_to_3
	l3_send_gpu10_to_3 -> l3_recv_gpu10_to_3
	l3_recv_gpu10_to_3 -> l3_local_tokens_gpu3
	l3_token_split_gpu10 -> l3_send_gpu10_to_4
	l3_send_gpu10_to_4 -> l3_recv_gpu10_to_4
	l3_recv_gpu10_to_4 -> l3_local_tokens_gpu4
	l3_token_split_gpu10 -> l3_send_gpu10_to_5
	l3_send_gpu10_to_5 -> l3_recv_gpu10_to_5
	l3_recv_gpu10_to_5 -> l3_local_tokens_gpu5
	l3_token_split_gpu10 -> l3_send_gpu10_to_6
	l3_send_gpu10_to_6 -> l3_recv_gpu10_to_6
	l3_recv_gpu10_to_6 -> l3_local_tokens_gpu6
	l3_token_split_gpu10 -> l3_send_gpu10_to_7
	l3_send_gpu10_to_7 -> l3_recv_gpu10_to_7
	l3_recv_gpu10_to_7 -> l3_local_tokens_gpu7
	l3_token_split_gpu10 -> l3_send_gpu10_to_8
	l3_send_gpu10_to_8 -> l3_recv_gpu10_to_8
	l3_recv_gpu10_to_8 -> l3_local_tokens_gpu8
	l3_token_split_gpu10 -> l3_send_gpu10_to_9
	l3_send_gpu10_to_9 -> l3_recv_gpu10_to_9
	l3_recv_gpu10_to_9 -> l3_local_tokens_gpu9
	l3_token_split_gpu10 -> l3_send_gpu10_to_11
	l3_send_gpu10_to_11 -> l3_recv_gpu10_to_11
	l3_recv_gpu10_to_11 -> l3_local_tokens_gpu11
	l3_token_split_gpu10 -> l3_send_gpu10_to_12
	l3_send_gpu10_to_12 -> l3_recv_gpu10_to_12
	l3_recv_gpu10_to_12 -> l3_local_tokens_gpu12
	l3_token_split_gpu10 -> l3_send_gpu10_to_13
	l3_send_gpu10_to_13 -> l3_recv_gpu10_to_13
	l3_recv_gpu10_to_13 -> l3_local_tokens_gpu13
	l3_token_split_gpu10 -> l3_send_gpu10_to_14
	l3_send_gpu10_to_14 -> l3_recv_gpu10_to_14
	l3_recv_gpu10_to_14 -> l3_local_tokens_gpu14
	l3_token_split_gpu10 -> l3_send_gpu10_to_15
	l3_send_gpu10_to_15 -> l3_recv_gpu10_to_15
	l3_recv_gpu10_to_15 -> l3_local_tokens_gpu15
	l3_token_split_gpu10 -> l3_local_tokens_gpu10
	l3_local_tokens_gpu10 -> l3_expert_gpu10
	l3_expert_gpu0 -> l3_expert_agg_gpu10
	l3_expert_gpu1 -> l3_expert_agg_gpu10
	l3_expert_gpu2 -> l3_expert_agg_gpu10
	l3_expert_gpu3 -> l3_expert_agg_gpu10
	l3_expert_gpu4 -> l3_expert_agg_gpu10
	l3_expert_gpu5 -> l3_expert_agg_gpu10
	l3_expert_gpu6 -> l3_expert_agg_gpu10
	l3_expert_gpu7 -> l3_expert_agg_gpu10
	l3_expert_gpu8 -> l3_expert_agg_gpu10
	l3_expert_gpu9 -> l3_expert_agg_gpu10
	l3_expert_gpu10 -> l3_expert_agg_gpu10
	l3_expert_gpu11 -> l3_expert_agg_gpu10
	l3_expert_gpu12 -> l3_expert_agg_gpu10
	l3_expert_gpu13 -> l3_expert_agg_gpu10
	l3_expert_gpu14 -> l3_expert_agg_gpu10
	l3_expert_gpu15 -> l3_expert_agg_gpu10
	l3_attn_residual_gpu10 -> l3_final_residual_gpu10
	l3_expert_agg_gpu10 -> l3_final_residual_gpu10
	l3_qkv_gpu11 -> l3_attn_gpu11
	l3_attn_gpu11 -> l3_out_proj_gpu11
	l3_out_proj_gpu11 -> l3_attn_residual_gpu11
	l2_final_residual_gpu11 -> l3_attn_residual_gpu11
	l3_attn_residual_gpu11 -> l3_gate_gpu11
	l3_attn_residual_gpu11 -> l3_token_split_gpu11
	l3_gate_gpu11 -> l3_token_split_gpu11 [style=dashed]
	l3_token_split_gpu11 -> l3_send_gpu11_to_0
	l3_send_gpu11_to_0 -> l3_recv_gpu11_to_0
	l3_recv_gpu11_to_0 -> l3_local_tokens_gpu0
	l3_token_split_gpu11 -> l3_send_gpu11_to_1
	l3_send_gpu11_to_1 -> l3_recv_gpu11_to_1
	l3_recv_gpu11_to_1 -> l3_local_tokens_gpu1
	l3_token_split_gpu11 -> l3_send_gpu11_to_2
	l3_send_gpu11_to_2 -> l3_recv_gpu11_to_2
	l3_recv_gpu11_to_2 -> l3_local_tokens_gpu2
	l3_token_split_gpu11 -> l3_send_gpu11_to_3
	l3_send_gpu11_to_3 -> l3_recv_gpu11_to_3
	l3_recv_gpu11_to_3 -> l3_local_tokens_gpu3
	l3_token_split_gpu11 -> l3_send_gpu11_to_4
	l3_send_gpu11_to_4 -> l3_recv_gpu11_to_4
	l3_recv_gpu11_to_4 -> l3_local_tokens_gpu4
	l3_token_split_gpu11 -> l3_send_gpu11_to_5
	l3_send_gpu11_to_5 -> l3_recv_gpu11_to_5
	l3_recv_gpu11_to_5 -> l3_local_tokens_gpu5
	l3_token_split_gpu11 -> l3_send_gpu11_to_6
	l3_send_gpu11_to_6 -> l3_recv_gpu11_to_6
	l3_recv_gpu11_to_6 -> l3_local_tokens_gpu6
	l3_token_split_gpu11 -> l3_send_gpu11_to_7
	l3_send_gpu11_to_7 -> l3_recv_gpu11_to_7
	l3_recv_gpu11_to_7 -> l3_local_tokens_gpu7
	l3_token_split_gpu11 -> l3_send_gpu11_to_8
	l3_send_gpu11_to_8 -> l3_recv_gpu11_to_8
	l3_recv_gpu11_to_8 -> l3_local_tokens_gpu8
	l3_token_split_gpu11 -> l3_send_gpu11_to_9
	l3_send_gpu11_to_9 -> l3_recv_gpu11_to_9
	l3_recv_gpu11_to_9 -> l3_local_tokens_gpu9
	l3_token_split_gpu11 -> l3_send_gpu11_to_10
	l3_send_gpu11_to_10 -> l3_recv_gpu11_to_10
	l3_recv_gpu11_to_10 -> l3_local_tokens_gpu10
	l3_token_split_gpu11 -> l3_send_gpu11_to_12
	l3_send_gpu11_to_12 -> l3_recv_gpu11_to_12
	l3_recv_gpu11_to_12 -> l3_local_tokens_gpu12
	l3_token_split_gpu11 -> l3_send_gpu11_to_13
	l3_send_gpu11_to_13 -> l3_recv_gpu11_to_13
	l3_recv_gpu11_to_13 -> l3_local_tokens_gpu13
	l3_token_split_gpu11 -> l3_send_gpu11_to_14
	l3_send_gpu11_to_14 -> l3_recv_gpu11_to_14
	l3_recv_gpu11_to_14 -> l3_local_tokens_gpu14
	l3_token_split_gpu11 -> l3_send_gpu11_to_15
	l3_send_gpu11_to_15 -> l3_recv_gpu11_to_15
	l3_recv_gpu11_to_15 -> l3_local_tokens_gpu15
	l3_token_split_gpu11 -> l3_local_tokens_gpu11
	l3_local_tokens_gpu11 -> l3_expert_gpu11
	l3_expert_gpu0 -> l3_expert_agg_gpu11
	l3_expert_gpu1 -> l3_expert_agg_gpu11
	l3_expert_gpu2 -> l3_expert_agg_gpu11
	l3_expert_gpu3 -> l3_expert_agg_gpu11
	l3_expert_gpu4 -> l3_expert_agg_gpu11
	l3_expert_gpu5 -> l3_expert_agg_gpu11
	l3_expert_gpu6 -> l3_expert_agg_gpu11
	l3_expert_gpu7 -> l3_expert_agg_gpu11
	l3_expert_gpu8 -> l3_expert_agg_gpu11
	l3_expert_gpu9 -> l3_expert_agg_gpu11
	l3_expert_gpu10 -> l3_expert_agg_gpu11
	l3_expert_gpu11 -> l3_expert_agg_gpu11
	l3_expert_gpu12 -> l3_expert_agg_gpu11
	l3_expert_gpu13 -> l3_expert_agg_gpu11
	l3_expert_gpu14 -> l3_expert_agg_gpu11
	l3_expert_gpu15 -> l3_expert_agg_gpu11
	l3_attn_residual_gpu11 -> l3_final_residual_gpu11
	l3_expert_agg_gpu11 -> l3_final_residual_gpu11
	l3_qkv_gpu12 -> l3_attn_gpu12
	l3_attn_gpu12 -> l3_out_proj_gpu12
	l3_out_proj_gpu12 -> l3_attn_residual_gpu12
	l2_final_residual_gpu12 -> l3_attn_residual_gpu12
	l3_attn_residual_gpu12 -> l3_gate_gpu12
	l3_attn_residual_gpu12 -> l3_token_split_gpu12
	l3_gate_gpu12 -> l3_token_split_gpu12 [style=dashed]
	l3_token_split_gpu12 -> l3_send_gpu12_to_0
	l3_send_gpu12_to_0 -> l3_recv_gpu12_to_0
	l3_recv_gpu12_to_0 -> l3_local_tokens_gpu0
	l3_token_split_gpu12 -> l3_send_gpu12_to_1
	l3_send_gpu12_to_1 -> l3_recv_gpu12_to_1
	l3_recv_gpu12_to_1 -> l3_local_tokens_gpu1
	l3_token_split_gpu12 -> l3_send_gpu12_to_2
	l3_send_gpu12_to_2 -> l3_recv_gpu12_to_2
	l3_recv_gpu12_to_2 -> l3_local_tokens_gpu2
	l3_token_split_gpu12 -> l3_send_gpu12_to_3
	l3_send_gpu12_to_3 -> l3_recv_gpu12_to_3
	l3_recv_gpu12_to_3 -> l3_local_tokens_gpu3
	l3_token_split_gpu12 -> l3_send_gpu12_to_4
	l3_send_gpu12_to_4 -> l3_recv_gpu12_to_4
	l3_recv_gpu12_to_4 -> l3_local_tokens_gpu4
	l3_token_split_gpu12 -> l3_send_gpu12_to_5
	l3_send_gpu12_to_5 -> l3_recv_gpu12_to_5
	l3_recv_gpu12_to_5 -> l3_local_tokens_gpu5
	l3_token_split_gpu12 -> l3_send_gpu12_to_6
	l3_send_gpu12_to_6 -> l3_recv_gpu12_to_6
	l3_recv_gpu12_to_6 -> l3_local_tokens_gpu6
	l3_token_split_gpu12 -> l3_send_gpu12_to_7
	l3_send_gpu12_to_7 -> l3_recv_gpu12_to_7
	l3_recv_gpu12_to_7 -> l3_local_tokens_gpu7
	l3_token_split_gpu12 -> l3_send_gpu12_to_8
	l3_send_gpu12_to_8 -> l3_recv_gpu12_to_8
	l3_recv_gpu12_to_8 -> l3_local_tokens_gpu8
	l3_token_split_gpu12 -> l3_send_gpu12_to_9
	l3_send_gpu12_to_9 -> l3_recv_gpu12_to_9
	l3_recv_gpu12_to_9 -> l3_local_tokens_gpu9
	l3_token_split_gpu12 -> l3_send_gpu12_to_10
	l3_send_gpu12_to_10 -> l3_recv_gpu12_to_10
	l3_recv_gpu12_to_10 -> l3_local_tokens_gpu10
	l3_token_split_gpu12 -> l3_send_gpu12_to_11
	l3_send_gpu12_to_11 -> l3_recv_gpu12_to_11
	l3_recv_gpu12_to_11 -> l3_local_tokens_gpu11
	l3_token_split_gpu12 -> l3_send_gpu12_to_13
	l3_send_gpu12_to_13 -> l3_recv_gpu12_to_13
	l3_recv_gpu12_to_13 -> l3_local_tokens_gpu13
	l3_token_split_gpu12 -> l3_send_gpu12_to_14
	l3_send_gpu12_to_14 -> l3_recv_gpu12_to_14
	l3_recv_gpu12_to_14 -> l3_local_tokens_gpu14
	l3_token_split_gpu12 -> l3_send_gpu12_to_15
	l3_send_gpu12_to_15 -> l3_recv_gpu12_to_15
	l3_recv_gpu12_to_15 -> l3_local_tokens_gpu15
	l3_token_split_gpu12 -> l3_local_tokens_gpu12
	l3_local_tokens_gpu12 -> l3_expert_gpu12
	l3_expert_gpu0 -> l3_expert_agg_gpu12
	l3_expert_gpu1 -> l3_expert_agg_gpu12
	l3_expert_gpu2 -> l3_expert_agg_gpu12
	l3_expert_gpu3 -> l3_expert_agg_gpu12
	l3_expert_gpu4 -> l3_expert_agg_gpu12
	l3_expert_gpu5 -> l3_expert_agg_gpu12
	l3_expert_gpu6 -> l3_expert_agg_gpu12
	l3_expert_gpu7 -> l3_expert_agg_gpu12
	l3_expert_gpu8 -> l3_expert_agg_gpu12
	l3_expert_gpu9 -> l3_expert_agg_gpu12
	l3_expert_gpu10 -> l3_expert_agg_gpu12
	l3_expert_gpu11 -> l3_expert_agg_gpu12
	l3_expert_gpu12 -> l3_expert_agg_gpu12
	l3_expert_gpu13 -> l3_expert_agg_gpu12
	l3_expert_gpu14 -> l3_expert_agg_gpu12
	l3_expert_gpu15 -> l3_expert_agg_gpu12
	l3_attn_residual_gpu12 -> l3_final_residual_gpu12
	l3_expert_agg_gpu12 -> l3_final_residual_gpu12
	l3_qkv_gpu13 -> l3_attn_gpu13
	l3_attn_gpu13 -> l3_out_proj_gpu13
	l3_out_proj_gpu13 -> l3_attn_residual_gpu13
	l2_final_residual_gpu13 -> l3_attn_residual_gpu13
	l3_attn_residual_gpu13 -> l3_gate_gpu13
	l3_attn_residual_gpu13 -> l3_token_split_gpu13
	l3_gate_gpu13 -> l3_token_split_gpu13 [style=dashed]
	l3_token_split_gpu13 -> l3_send_gpu13_to_0
	l3_send_gpu13_to_0 -> l3_recv_gpu13_to_0
	l3_recv_gpu13_to_0 -> l3_local_tokens_gpu0
	l3_token_split_gpu13 -> l3_send_gpu13_to_1
	l3_send_gpu13_to_1 -> l3_recv_gpu13_to_1
	l3_recv_gpu13_to_1 -> l3_local_tokens_gpu1
	l3_token_split_gpu13 -> l3_send_gpu13_to_2
	l3_send_gpu13_to_2 -> l3_recv_gpu13_to_2
	l3_recv_gpu13_to_2 -> l3_local_tokens_gpu2
	l3_token_split_gpu13 -> l3_send_gpu13_to_3
	l3_send_gpu13_to_3 -> l3_recv_gpu13_to_3
	l3_recv_gpu13_to_3 -> l3_local_tokens_gpu3
	l3_token_split_gpu13 -> l3_send_gpu13_to_4
	l3_send_gpu13_to_4 -> l3_recv_gpu13_to_4
	l3_recv_gpu13_to_4 -> l3_local_tokens_gpu4
	l3_token_split_gpu13 -> l3_send_gpu13_to_5
	l3_send_gpu13_to_5 -> l3_recv_gpu13_to_5
	l3_recv_gpu13_to_5 -> l3_local_tokens_gpu5
	l3_token_split_gpu13 -> l3_send_gpu13_to_6
	l3_send_gpu13_to_6 -> l3_recv_gpu13_to_6
	l3_recv_gpu13_to_6 -> l3_local_tokens_gpu6
	l3_token_split_gpu13 -> l3_send_gpu13_to_7
	l3_send_gpu13_to_7 -> l3_recv_gpu13_to_7
	l3_recv_gpu13_to_7 -> l3_local_tokens_gpu7
	l3_token_split_gpu13 -> l3_send_gpu13_to_8
	l3_send_gpu13_to_8 -> l3_recv_gpu13_to_8
	l3_recv_gpu13_to_8 -> l3_local_tokens_gpu8
	l3_token_split_gpu13 -> l3_send_gpu13_to_9
	l3_send_gpu13_to_9 -> l3_recv_gpu13_to_9
	l3_recv_gpu13_to_9 -> l3_local_tokens_gpu9
	l3_token_split_gpu13 -> l3_send_gpu13_to_10
	l3_send_gpu13_to_10 -> l3_recv_gpu13_to_10
	l3_recv_gpu13_to_10 -> l3_local_tokens_gpu10
	l3_token_split_gpu13 -> l3_send_gpu13_to_11
	l3_send_gpu13_to_11 -> l3_recv_gpu13_to_11
	l3_recv_gpu13_to_11 -> l3_local_tokens_gpu11
	l3_token_split_gpu13 -> l3_send_gpu13_to_12
	l3_send_gpu13_to_12 -> l3_recv_gpu13_to_12
	l3_recv_gpu13_to_12 -> l3_local_tokens_gpu12
	l3_token_split_gpu13 -> l3_send_gpu13_to_14
	l3_send_gpu13_to_14 -> l3_recv_gpu13_to_14
	l3_recv_gpu13_to_14 -> l3_local_tokens_gpu14
	l3_token_split_gpu13 -> l3_send_gpu13_to_15
	l3_send_gpu13_to_15 -> l3_recv_gpu13_to_15
	l3_recv_gpu13_to_15 -> l3_local_tokens_gpu15
	l3_token_split_gpu13 -> l3_local_tokens_gpu13
	l3_local_tokens_gpu13 -> l3_expert_gpu13
	l3_expert_gpu0 -> l3_expert_agg_gpu13
	l3_expert_gpu1 -> l3_expert_agg_gpu13
	l3_expert_gpu2 -> l3_expert_agg_gpu13
	l3_expert_gpu3 -> l3_expert_agg_gpu13
	l3_expert_gpu4 -> l3_expert_agg_gpu13
	l3_expert_gpu5 -> l3_expert_agg_gpu13
	l3_expert_gpu6 -> l3_expert_agg_gpu13
	l3_expert_gpu7 -> l3_expert_agg_gpu13
	l3_expert_gpu8 -> l3_expert_agg_gpu13
	l3_expert_gpu9 -> l3_expert_agg_gpu13
	l3_expert_gpu10 -> l3_expert_agg_gpu13
	l3_expert_gpu11 -> l3_expert_agg_gpu13
	l3_expert_gpu12 -> l3_expert_agg_gpu13
	l3_expert_gpu13 -> l3_expert_agg_gpu13
	l3_expert_gpu14 -> l3_expert_agg_gpu13
	l3_expert_gpu15 -> l3_expert_agg_gpu13
	l3_attn_residual_gpu13 -> l3_final_residual_gpu13
	l3_expert_agg_gpu13 -> l3_final_residual_gpu13
	l3_qkv_gpu14 -> l3_attn_gpu14
	l3_attn_gpu14 -> l3_out_proj_gpu14
	l3_out_proj_gpu14 -> l3_attn_residual_gpu14
	l2_final_residual_gpu14 -> l3_attn_residual_gpu14
	l3_attn_residual_gpu14 -> l3_gate_gpu14
	l3_attn_residual_gpu14 -> l3_token_split_gpu14
	l3_gate_gpu14 -> l3_token_split_gpu14 [style=dashed]
	l3_token_split_gpu14 -> l3_send_gpu14_to_0
	l3_send_gpu14_to_0 -> l3_recv_gpu14_to_0
	l3_recv_gpu14_to_0 -> l3_local_tokens_gpu0
	l3_token_split_gpu14 -> l3_send_gpu14_to_1
	l3_send_gpu14_to_1 -> l3_recv_gpu14_to_1
	l3_recv_gpu14_to_1 -> l3_local_tokens_gpu1
	l3_token_split_gpu14 -> l3_send_gpu14_to_2
	l3_send_gpu14_to_2 -> l3_recv_gpu14_to_2
	l3_recv_gpu14_to_2 -> l3_local_tokens_gpu2
	l3_token_split_gpu14 -> l3_send_gpu14_to_3
	l3_send_gpu14_to_3 -> l3_recv_gpu14_to_3
	l3_recv_gpu14_to_3 -> l3_local_tokens_gpu3
	l3_token_split_gpu14 -> l3_send_gpu14_to_4
	l3_send_gpu14_to_4 -> l3_recv_gpu14_to_4
	l3_recv_gpu14_to_4 -> l3_local_tokens_gpu4
	l3_token_split_gpu14 -> l3_send_gpu14_to_5
	l3_send_gpu14_to_5 -> l3_recv_gpu14_to_5
	l3_recv_gpu14_to_5 -> l3_local_tokens_gpu5
	l3_token_split_gpu14 -> l3_send_gpu14_to_6
	l3_send_gpu14_to_6 -> l3_recv_gpu14_to_6
	l3_recv_gpu14_to_6 -> l3_local_tokens_gpu6
	l3_token_split_gpu14 -> l3_send_gpu14_to_7
	l3_send_gpu14_to_7 -> l3_recv_gpu14_to_7
	l3_recv_gpu14_to_7 -> l3_local_tokens_gpu7
	l3_token_split_gpu14 -> l3_send_gpu14_to_8
	l3_send_gpu14_to_8 -> l3_recv_gpu14_to_8
	l3_recv_gpu14_to_8 -> l3_local_tokens_gpu8
	l3_token_split_gpu14 -> l3_send_gpu14_to_9
	l3_send_gpu14_to_9 -> l3_recv_gpu14_to_9
	l3_recv_gpu14_to_9 -> l3_local_tokens_gpu9
	l3_token_split_gpu14 -> l3_send_gpu14_to_10
	l3_send_gpu14_to_10 -> l3_recv_gpu14_to_10
	l3_recv_gpu14_to_10 -> l3_local_tokens_gpu10
	l3_token_split_gpu14 -> l3_send_gpu14_to_11
	l3_send_gpu14_to_11 -> l3_recv_gpu14_to_11
	l3_recv_gpu14_to_11 -> l3_local_tokens_gpu11
	l3_token_split_gpu14 -> l3_send_gpu14_to_12
	l3_send_gpu14_to_12 -> l3_recv_gpu14_to_12
	l3_recv_gpu14_to_12 -> l3_local_tokens_gpu12
	l3_token_split_gpu14 -> l3_send_gpu14_to_13
	l3_send_gpu14_to_13 -> l3_recv_gpu14_to_13
	l3_recv_gpu14_to_13 -> l3_local_tokens_gpu13
	l3_token_split_gpu14 -> l3_send_gpu14_to_15
	l3_send_gpu14_to_15 -> l3_recv_gpu14_to_15
	l3_recv_gpu14_to_15 -> l3_local_tokens_gpu15
	l3_token_split_gpu14 -> l3_local_tokens_gpu14
	l3_local_tokens_gpu14 -> l3_expert_gpu14
	l3_expert_gpu0 -> l3_expert_agg_gpu14
	l3_expert_gpu1 -> l3_expert_agg_gpu14
	l3_expert_gpu2 -> l3_expert_agg_gpu14
	l3_expert_gpu3 -> l3_expert_agg_gpu14
	l3_expert_gpu4 -> l3_expert_agg_gpu14
	l3_expert_gpu5 -> l3_expert_agg_gpu14
	l3_expert_gpu6 -> l3_expert_agg_gpu14
	l3_expert_gpu7 -> l3_expert_agg_gpu14
	l3_expert_gpu8 -> l3_expert_agg_gpu14
	l3_expert_gpu9 -> l3_expert_agg_gpu14
	l3_expert_gpu10 -> l3_expert_agg_gpu14
	l3_expert_gpu11 -> l3_expert_agg_gpu14
	l3_expert_gpu12 -> l3_expert_agg_gpu14
	l3_expert_gpu13 -> l3_expert_agg_gpu14
	l3_expert_gpu14 -> l3_expert_agg_gpu14
	l3_expert_gpu15 -> l3_expert_agg_gpu14
	l3_attn_residual_gpu14 -> l3_final_residual_gpu14
	l3_expert_agg_gpu14 -> l3_final_residual_gpu14
	l3_qkv_gpu15 -> l3_attn_gpu15
	l3_attn_gpu15 -> l3_out_proj_gpu15
	l3_out_proj_gpu15 -> l3_attn_residual_gpu15
	l2_final_residual_gpu15 -> l3_attn_residual_gpu15
	l3_attn_residual_gpu15 -> l3_gate_gpu15
	l3_attn_residual_gpu15 -> l3_token_split_gpu15
	l3_gate_gpu15 -> l3_token_split_gpu15 [style=dashed]
	l3_token_split_gpu15 -> l3_send_gpu15_to_0
	l3_send_gpu15_to_0 -> l3_recv_gpu15_to_0
	l3_recv_gpu15_to_0 -> l3_local_tokens_gpu0
	l3_token_split_gpu15 -> l3_send_gpu15_to_1
	l3_send_gpu15_to_1 -> l3_recv_gpu15_to_1
	l3_recv_gpu15_to_1 -> l3_local_tokens_gpu1
	l3_token_split_gpu15 -> l3_send_gpu15_to_2
	l3_send_gpu15_to_2 -> l3_recv_gpu15_to_2
	l3_recv_gpu15_to_2 -> l3_local_tokens_gpu2
	l3_token_split_gpu15 -> l3_send_gpu15_to_3
	l3_send_gpu15_to_3 -> l3_recv_gpu15_to_3
	l3_recv_gpu15_to_3 -> l3_local_tokens_gpu3
	l3_token_split_gpu15 -> l3_send_gpu15_to_4
	l3_send_gpu15_to_4 -> l3_recv_gpu15_to_4
	l3_recv_gpu15_to_4 -> l3_local_tokens_gpu4
	l3_token_split_gpu15 -> l3_send_gpu15_to_5
	l3_send_gpu15_to_5 -> l3_recv_gpu15_to_5
	l3_recv_gpu15_to_5 -> l3_local_tokens_gpu5
	l3_token_split_gpu15 -> l3_send_gpu15_to_6
	l3_send_gpu15_to_6 -> l3_recv_gpu15_to_6
	l3_recv_gpu15_to_6 -> l3_local_tokens_gpu6
	l3_token_split_gpu15 -> l3_send_gpu15_to_7
	l3_send_gpu15_to_7 -> l3_recv_gpu15_to_7
	l3_recv_gpu15_to_7 -> l3_local_tokens_gpu7
	l3_token_split_gpu15 -> l3_send_gpu15_to_8
	l3_send_gpu15_to_8 -> l3_recv_gpu15_to_8
	l3_recv_gpu15_to_8 -> l3_local_tokens_gpu8
	l3_token_split_gpu15 -> l3_send_gpu15_to_9
	l3_send_gpu15_to_9 -> l3_recv_gpu15_to_9
	l3_recv_gpu15_to_9 -> l3_local_tokens_gpu9
	l3_token_split_gpu15 -> l3_send_gpu15_to_10
	l3_send_gpu15_to_10 -> l3_recv_gpu15_to_10
	l3_recv_gpu15_to_10 -> l3_local_tokens_gpu10
	l3_token_split_gpu15 -> l3_send_gpu15_to_11
	l3_send_gpu15_to_11 -> l3_recv_gpu15_to_11
	l3_recv_gpu15_to_11 -> l3_local_tokens_gpu11
	l3_token_split_gpu15 -> l3_send_gpu15_to_12
	l3_send_gpu15_to_12 -> l3_recv_gpu15_to_12
	l3_recv_gpu15_to_12 -> l3_local_tokens_gpu12
	l3_token_split_gpu15 -> l3_send_gpu15_to_13
	l3_send_gpu15_to_13 -> l3_recv_gpu15_to_13
	l3_recv_gpu15_to_13 -> l3_local_tokens_gpu13
	l3_token_split_gpu15 -> l3_send_gpu15_to_14
	l3_send_gpu15_to_14 -> l3_recv_gpu15_to_14
	l3_recv_gpu15_to_14 -> l3_local_tokens_gpu14
	l3_token_split_gpu15 -> l3_local_tokens_gpu15
	l3_local_tokens_gpu15 -> l3_expert_gpu15
	l3_expert_gpu0 -> l3_expert_agg_gpu15
	l3_expert_gpu1 -> l3_expert_agg_gpu15
	l3_expert_gpu2 -> l3_expert_agg_gpu15
	l3_expert_gpu3 -> l3_expert_agg_gpu15
	l3_expert_gpu4 -> l3_expert_agg_gpu15
	l3_expert_gpu5 -> l3_expert_agg_gpu15
	l3_expert_gpu6 -> l3_expert_agg_gpu15
	l3_expert_gpu7 -> l3_expert_agg_gpu15
	l3_expert_gpu8 -> l3_expert_agg_gpu15
	l3_expert_gpu9 -> l3_expert_agg_gpu15
	l3_expert_gpu10 -> l3_expert_agg_gpu15
	l3_expert_gpu11 -> l3_expert_agg_gpu15
	l3_expert_gpu12 -> l3_expert_agg_gpu15
	l3_expert_gpu13 -> l3_expert_agg_gpu15
	l3_expert_gpu14 -> l3_expert_agg_gpu15
	l3_expert_gpu15 -> l3_expert_agg_gpu15
	l3_attn_residual_gpu15 -> l3_final_residual_gpu15
	l3_expert_agg_gpu15 -> l3_final_residual_gpu15
	l3_final_residual_gpu0 -> output
	l3_final_residual_gpu1 -> output
	l3_final_residual_gpu2 -> output
	l3_final_residual_gpu3 -> output
	l3_final_residual_gpu4 -> output
	l3_final_residual_gpu5 -> output
	l3_final_residual_gpu6 -> output
	l3_final_residual_gpu7 -> output
	l3_final_residual_gpu8 -> output
	l3_final_residual_gpu9 -> output
	l3_final_residual_gpu10 -> output
	l3_final_residual_gpu11 -> output
	l3_final_residual_gpu12 -> output
	l3_final_residual_gpu13 -> output
	l3_final_residual_gpu14 -> output
	l3_final_residual_gpu15 -> output
}
