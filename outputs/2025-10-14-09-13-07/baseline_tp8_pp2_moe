// Baseline MoE TP=8 PP=2 Deployment
digraph baseline_tp8_pp2_moe {
	rankdir=TB size="20,30"
	node [fillcolor=lightblue shape=ellipse style=filled]
	node [fillcolor=lightgreen shape=rectangle style=filled]
	node [fillcolor=lightyellow shape=parallelogram style=filled]
	input [label="Input\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nGPU: all GPUs" fillcolor=lightblue shape=ellipse]
	subgraph cluster_stage0 {
		label="Pipeline Stage 0 (Layers 0-1)\nGPUs 0-7" style=dashed
		l0_qkv_tp0 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l0_attn_tp0 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_tp0 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l0_residual_tp0 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_tp1 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l0_attn_tp1 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_tp1 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l0_residual_tp1 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_tp2 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l0_attn_tp2 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_tp2 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l0_residual_tp2 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_tp3 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l0_attn_tp3 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_tp3 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l0_residual_tp3 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_tp4 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l0_attn_tp4 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_tp4 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l0_residual_tp4 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_tp5 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l0_attn_tp5 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_tp5 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l0_residual_tp5 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_tp6 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l0_attn_tp6 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_tp6 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l0_residual_tp6 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l0_qkv_tp7 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l0_attn_tp7 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l0_out_proj_tp7 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l0_residual_tp7 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l0_gate_tp0 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l0_gate_tp1 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l0_gate_tp2 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l0_gate_tp3 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l0_gate_tp4 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l0_gate_tp5 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l0_gate_tp6 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l0_gate_tp7 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l0_exp0_gpu0 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l0_exp1_gpu0 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l0_exp2_gpu0 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l0_exp3_gpu0 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l0_exp4_gpu0 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l0_exp5_gpu0 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l0_exp6_gpu0 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l0_exp7_gpu0 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l0_exp_agg_tp0 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l0_final_res_tp0 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l0_exp0_gpu1 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l0_exp1_gpu1 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l0_exp2_gpu1 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l0_exp3_gpu1 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l0_exp4_gpu1 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l0_exp5_gpu1 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l0_exp6_gpu1 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l0_exp7_gpu1 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l0_exp_agg_tp1 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l0_final_res_tp1 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l0_exp0_gpu2 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l0_exp1_gpu2 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l0_exp2_gpu2 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l0_exp3_gpu2 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l0_exp4_gpu2 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l0_exp5_gpu2 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l0_exp6_gpu2 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l0_exp7_gpu2 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l0_exp_agg_tp2 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l0_final_res_tp2 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l0_exp0_gpu3 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l0_exp1_gpu3 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l0_exp2_gpu3 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l0_exp3_gpu3 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l0_exp4_gpu3 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l0_exp5_gpu3 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l0_exp6_gpu3 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l0_exp7_gpu3 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l0_exp_agg_tp3 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l0_final_res_tp3 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l0_exp0_gpu4 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l0_exp1_gpu4 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l0_exp2_gpu4 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l0_exp3_gpu4 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l0_exp4_gpu4 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l0_exp5_gpu4 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l0_exp6_gpu4 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l0_exp7_gpu4 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l0_exp_agg_tp4 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l0_final_res_tp4 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l0_exp0_gpu5 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l0_exp1_gpu5 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l0_exp2_gpu5 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l0_exp3_gpu5 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l0_exp4_gpu5 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l0_exp5_gpu5 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l0_exp6_gpu5 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l0_exp7_gpu5 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l0_exp_agg_tp5 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l0_final_res_tp5 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l0_exp0_gpu6 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l0_exp1_gpu6 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l0_exp2_gpu6 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l0_exp3_gpu6 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l0_exp4_gpu6 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l0_exp5_gpu6 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l0_exp6_gpu6 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l0_exp7_gpu6 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l0_exp_agg_tp6 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l0_final_res_tp6 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l0_exp0_gpu7 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l0_exp1_gpu7 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l0_exp2_gpu7 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l0_exp3_gpu7 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l0_exp4_gpu7 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l0_exp5_gpu7 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l0_exp6_gpu7 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l0_exp7_gpu7 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l0_exp_agg_tp7 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l0_final_res_tp7 [label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		subgraph cluster_layer0 {
			label="Layer 0" style=dotted
		}
		l1_qkv_tp0 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l1_attn_tp0 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_tp0 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l1_residual_tp0 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l1_gate_tp0 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l1_exp0_gpu0 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l1_exp1_gpu0 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l1_exp2_gpu0 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l1_exp3_gpu0 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l1_exp4_gpu0 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l1_exp5_gpu0 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l1_exp6_gpu0 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l1_exp7_gpu0 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
		l1_exp_agg_tp0 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l1_final_res_tp0 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_tp1 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l1_attn_tp1 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_tp1 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l1_residual_tp1 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l1_gate_tp1 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l1_exp0_gpu1 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l1_exp1_gpu1 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l1_exp2_gpu1 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l1_exp3_gpu1 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l1_exp4_gpu1 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l1_exp5_gpu1 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l1_exp6_gpu1 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l1_exp7_gpu1 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
		l1_exp_agg_tp1 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l1_final_res_tp1 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_tp2 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l1_attn_tp2 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_tp2 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l1_residual_tp2 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l1_gate_tp2 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l1_exp0_gpu2 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l1_exp1_gpu2 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l1_exp2_gpu2 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l1_exp3_gpu2 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l1_exp4_gpu2 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l1_exp5_gpu2 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l1_exp6_gpu2 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l1_exp7_gpu2 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
		l1_exp_agg_tp2 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l1_final_res_tp2 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_tp3 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l1_attn_tp3 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_tp3 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l1_residual_tp3 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l1_gate_tp3 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l1_exp0_gpu3 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l1_exp1_gpu3 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l1_exp2_gpu3 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l1_exp3_gpu3 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l1_exp4_gpu3 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l1_exp5_gpu3 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l1_exp6_gpu3 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l1_exp7_gpu3 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
		l1_exp_agg_tp3 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l1_final_res_tp3 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_tp4 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l1_attn_tp4 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_tp4 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l1_residual_tp4 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l1_gate_tp4 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l1_exp0_gpu4 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l1_exp1_gpu4 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l1_exp2_gpu4 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l1_exp3_gpu4 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l1_exp4_gpu4 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l1_exp5_gpu4 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l1_exp6_gpu4 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l1_exp7_gpu4 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
		l1_exp_agg_tp4 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l1_final_res_tp4 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_tp5 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l1_attn_tp5 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_tp5 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l1_residual_tp5 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l1_gate_tp5 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l1_exp0_gpu5 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l1_exp1_gpu5 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l1_exp2_gpu5 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l1_exp3_gpu5 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l1_exp4_gpu5 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l1_exp5_gpu5 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l1_exp6_gpu5 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l1_exp7_gpu5 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
		l1_exp_agg_tp5 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l1_final_res_tp5 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_tp6 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l1_attn_tp6 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_tp6 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l1_residual_tp6 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l1_gate_tp6 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l1_exp0_gpu6 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l1_exp1_gpu6 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l1_exp2_gpu6 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l1_exp3_gpu6 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l1_exp4_gpu6 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l1_exp5_gpu6 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l1_exp6_gpu6 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l1_exp7_gpu6 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
		l1_exp_agg_tp6 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l1_final_res_tp6 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
		l1_qkv_tp7 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l1_attn_tp7 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l1_out_proj_tp7 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l1_residual_tp7 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l1_gate_tp7 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l1_exp0_gpu7 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l1_exp1_gpu7 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l1_exp2_gpu7 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l1_exp3_gpu7 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l1_exp4_gpu7 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l1_exp5_gpu7 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l1_exp6_gpu7 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l1_exp7_gpu7 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
		l1_exp_agg_tp7 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		l1_final_res_tp7 [label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
		subgraph cluster_layer1 {
			label="Layer 1" style=dotted
		}
	}
	subgraph cluster_stage1 {
		label="Pipeline Stage 1 (Layers 2-3)\nGPUs 8-15" style=dashed
		l2_qkv_tp0 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l2_attn_tp0 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_tp0 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l2_residual_tp0 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l2_gate_tp0 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l2_exp0_gpu8 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l2_exp1_gpu8 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l2_exp2_gpu8 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l2_exp3_gpu8 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l2_exp4_gpu8 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l2_exp5_gpu8 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l2_exp6_gpu8 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l2_exp7_gpu8 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l2_exp_agg_tp0 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l2_final_res_tp0 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_tp1 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l2_attn_tp1 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_tp1 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l2_residual_tp1 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l2_gate_tp1 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l2_exp0_gpu9 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l2_exp1_gpu9 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l2_exp2_gpu9 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l2_exp3_gpu9 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l2_exp4_gpu9 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l2_exp5_gpu9 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l2_exp6_gpu9 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l2_exp7_gpu9 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l2_exp_agg_tp1 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l2_final_res_tp1 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_tp2 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l2_attn_tp2 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_tp2 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l2_residual_tp2 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l2_gate_tp2 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l2_exp0_gpu10 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l2_exp1_gpu10 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l2_exp2_gpu10 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l2_exp3_gpu10 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l2_exp4_gpu10 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l2_exp5_gpu10 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l2_exp6_gpu10 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l2_exp7_gpu10 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l2_exp_agg_tp2 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l2_final_res_tp2 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_tp3 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l2_attn_tp3 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_tp3 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l2_residual_tp3 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l2_gate_tp3 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l2_exp0_gpu11 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l2_exp1_gpu11 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l2_exp2_gpu11 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l2_exp3_gpu11 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l2_exp4_gpu11 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l2_exp5_gpu11 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l2_exp6_gpu11 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l2_exp7_gpu11 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l2_exp_agg_tp3 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l2_final_res_tp3 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_tp4 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l2_attn_tp4 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_tp4 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l2_residual_tp4 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l2_gate_tp4 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l2_exp0_gpu12 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l2_exp1_gpu12 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l2_exp2_gpu12 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l2_exp3_gpu12 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l2_exp4_gpu12 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l2_exp5_gpu12 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l2_exp6_gpu12 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l2_exp7_gpu12 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l2_exp_agg_tp4 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l2_final_res_tp4 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_tp5 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l2_attn_tp5 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_tp5 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l2_residual_tp5 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l2_gate_tp5 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l2_exp0_gpu13 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l2_exp1_gpu13 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l2_exp2_gpu13 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l2_exp3_gpu13 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l2_exp4_gpu13 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l2_exp5_gpu13 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l2_exp6_gpu13 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l2_exp7_gpu13 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l2_exp_agg_tp5 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l2_final_res_tp5 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_tp6 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l2_attn_tp6 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_tp6 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l2_residual_tp6 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l2_gate_tp6 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l2_exp0_gpu14 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l2_exp1_gpu14 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l2_exp2_gpu14 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l2_exp3_gpu14 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l2_exp4_gpu14 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l2_exp5_gpu14 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l2_exp6_gpu14 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l2_exp7_gpu14 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l2_exp_agg_tp6 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l2_final_res_tp6 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l2_qkv_tp7 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l2_attn_tp7 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l2_out_proj_tp7 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l2_residual_tp7 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l2_gate_tp7 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l2_exp0_gpu15 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l2_exp1_gpu15 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l2_exp2_gpu15 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l2_exp3_gpu15 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l2_exp4_gpu15 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l2_exp5_gpu15 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l2_exp6_gpu15 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l2_exp7_gpu15 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l2_exp_agg_tp7 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l2_final_res_tp7 [label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		subgraph cluster_layer2 {
			label="Layer 2" style=dotted
		}
		l3_qkv_tp0 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l3_attn_tp0 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_tp0 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l3_residual_tp0 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l3_gate_tp0 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l3_exp0_gpu8 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l3_exp1_gpu8 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l3_exp2_gpu8 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l3_exp3_gpu8 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l3_exp4_gpu8 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l3_exp5_gpu8 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l3_exp6_gpu8 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l3_exp7_gpu8 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8" fillcolor=lightgreen shape=rectangle]
		l3_exp_agg_tp0 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l3_final_res_tp0 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_tp1 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l3_attn_tp1 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_tp1 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l3_residual_tp1 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l3_gate_tp1 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l3_exp0_gpu9 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l3_exp1_gpu9 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l3_exp2_gpu9 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l3_exp3_gpu9 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l3_exp4_gpu9 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l3_exp5_gpu9 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l3_exp6_gpu9 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l3_exp7_gpu9 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9" fillcolor=lightgreen shape=rectangle]
		l3_exp_agg_tp1 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l3_final_res_tp1 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_tp2 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l3_attn_tp2 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_tp2 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l3_residual_tp2 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l3_gate_tp2 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l3_exp0_gpu10 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l3_exp1_gpu10 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l3_exp2_gpu10 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l3_exp3_gpu10 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l3_exp4_gpu10 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l3_exp5_gpu10 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l3_exp6_gpu10 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l3_exp7_gpu10 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10" fillcolor=lightgreen shape=rectangle]
		l3_exp_agg_tp2 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l3_final_res_tp2 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_tp3 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l3_attn_tp3 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_tp3 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l3_residual_tp3 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l3_gate_tp3 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l3_exp0_gpu11 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l3_exp1_gpu11 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l3_exp2_gpu11 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l3_exp3_gpu11 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l3_exp4_gpu11 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l3_exp5_gpu11 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l3_exp6_gpu11 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l3_exp7_gpu11 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11" fillcolor=lightgreen shape=rectangle]
		l3_exp_agg_tp3 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l3_final_res_tp3 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_tp4 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l3_attn_tp4 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_tp4 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l3_residual_tp4 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l3_gate_tp4 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l3_exp0_gpu12 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l3_exp1_gpu12 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l3_exp2_gpu12 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l3_exp3_gpu12 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l3_exp4_gpu12 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l3_exp5_gpu12 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l3_exp6_gpu12 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l3_exp7_gpu12 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12" fillcolor=lightgreen shape=rectangle]
		l3_exp_agg_tp4 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l3_final_res_tp4 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_tp5 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l3_attn_tp5 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_tp5 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l3_residual_tp5 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l3_gate_tp5 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l3_exp0_gpu13 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l3_exp1_gpu13 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l3_exp2_gpu13 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l3_exp3_gpu13 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l3_exp4_gpu13 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l3_exp5_gpu13 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l3_exp6_gpu13 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l3_exp7_gpu13 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13" fillcolor=lightgreen shape=rectangle]
		l3_exp_agg_tp5 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l3_final_res_tp5 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_tp6 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l3_attn_tp6 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_tp6 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l3_residual_tp6 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l3_gate_tp6 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l3_exp0_gpu14 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l3_exp1_gpu14 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l3_exp2_gpu14 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l3_exp3_gpu14 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l3_exp4_gpu14 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l3_exp5_gpu14 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l3_exp6_gpu14 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l3_exp7_gpu14 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14" fillcolor=lightgreen shape=rectangle]
		l3_exp_agg_tp6 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l3_final_res_tp6 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14" fillcolor=lightyellow shape=parallelogram]
		l3_qkv_tp7 [label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l3_attn_tp7 [label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l3_out_proj_tp7 [label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l3_residual_tp7 [label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l3_gate_tp7 [label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l3_exp0_gpu15 [label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l3_exp1_gpu15 [label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l3_exp2_gpu15 [label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l3_exp3_gpu15 [label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l3_exp4_gpu15 [label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l3_exp5_gpu15 [label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l3_exp6_gpu15 [label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l3_exp7_gpu15 [label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15" fillcolor=lightgreen shape=rectangle]
		l3_exp_agg_tp7 [label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		l3_final_res_tp7 [label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15" fillcolor=lightyellow shape=parallelogram]
		subgraph cluster_layer3 {
			label="Layer 3" style=dotted
		}
	}
	output [label="Output\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: all GPUs" fillcolor=lightblue shape=ellipse]
	input -> l0_qkv_tp0
	l0_qkv_tp0 -> l0_attn_tp0
	l0_attn_tp0 -> l0_out_proj_tp0
	l0_out_proj_tp0 -> l0_residual_tp0
	input -> l0_residual_tp0
	l0_residual_tp0 -> l0_gate_tp0
	l0_gate_tp0 -> l0_exp0_gpu0 [style=dashed]
	l0_residual_tp0 -> l0_exp0_gpu0
	l0_exp0_gpu0 -> l0_exp_agg_tp0
	l0_gate_tp0 -> l0_exp1_gpu0 [style=dashed]
	l0_residual_tp0 -> l0_exp1_gpu0
	l0_exp1_gpu0 -> l0_exp_agg_tp0
	l0_gate_tp0 -> l0_exp2_gpu0 [style=dashed]
	l0_residual_tp0 -> l0_exp2_gpu0
	l0_exp2_gpu0 -> l0_exp_agg_tp0
	l0_gate_tp0 -> l0_exp3_gpu0 [style=dashed]
	l0_residual_tp0 -> l0_exp3_gpu0
	l0_exp3_gpu0 -> l0_exp_agg_tp0
	l0_gate_tp0 -> l0_exp4_gpu0 [style=dashed]
	l0_residual_tp0 -> l0_exp4_gpu0
	l0_exp4_gpu0 -> l0_exp_agg_tp0
	l0_gate_tp0 -> l0_exp5_gpu0 [style=dashed]
	l0_residual_tp0 -> l0_exp5_gpu0
	l0_exp5_gpu0 -> l0_exp_agg_tp0
	l0_gate_tp0 -> l0_exp6_gpu0 [style=dashed]
	l0_residual_tp0 -> l0_exp6_gpu0
	l0_exp6_gpu0 -> l0_exp_agg_tp0
	l0_gate_tp0 -> l0_exp7_gpu0 [style=dashed]
	l0_residual_tp0 -> l0_exp7_gpu0
	l0_exp7_gpu0 -> l0_exp_agg_tp0
	l0_exp_agg_tp0 -> l0_final_res_tp0
	l0_residual_tp0 -> l0_final_res_tp0
	input -> l0_qkv_tp1
	l0_qkv_tp1 -> l0_attn_tp1
	l0_attn_tp1 -> l0_out_proj_tp1
	l0_out_proj_tp1 -> l0_residual_tp1
	input -> l0_residual_tp1
	l0_residual_tp1 -> l0_gate_tp1
	l0_gate_tp1 -> l0_exp0_gpu1 [style=dashed]
	l0_residual_tp1 -> l0_exp0_gpu1
	l0_exp0_gpu1 -> l0_exp_agg_tp1
	l0_gate_tp1 -> l0_exp1_gpu1 [style=dashed]
	l0_residual_tp1 -> l0_exp1_gpu1
	l0_exp1_gpu1 -> l0_exp_agg_tp1
	l0_gate_tp1 -> l0_exp2_gpu1 [style=dashed]
	l0_residual_tp1 -> l0_exp2_gpu1
	l0_exp2_gpu1 -> l0_exp_agg_tp1
	l0_gate_tp1 -> l0_exp3_gpu1 [style=dashed]
	l0_residual_tp1 -> l0_exp3_gpu1
	l0_exp3_gpu1 -> l0_exp_agg_tp1
	l0_gate_tp1 -> l0_exp4_gpu1 [style=dashed]
	l0_residual_tp1 -> l0_exp4_gpu1
	l0_exp4_gpu1 -> l0_exp_agg_tp1
	l0_gate_tp1 -> l0_exp5_gpu1 [style=dashed]
	l0_residual_tp1 -> l0_exp5_gpu1
	l0_exp5_gpu1 -> l0_exp_agg_tp1
	l0_gate_tp1 -> l0_exp6_gpu1 [style=dashed]
	l0_residual_tp1 -> l0_exp6_gpu1
	l0_exp6_gpu1 -> l0_exp_agg_tp1
	l0_gate_tp1 -> l0_exp7_gpu1 [style=dashed]
	l0_residual_tp1 -> l0_exp7_gpu1
	l0_exp7_gpu1 -> l0_exp_agg_tp1
	l0_exp_agg_tp1 -> l0_final_res_tp1
	l0_residual_tp1 -> l0_final_res_tp1
	input -> l0_qkv_tp2
	l0_qkv_tp2 -> l0_attn_tp2
	l0_attn_tp2 -> l0_out_proj_tp2
	l0_out_proj_tp2 -> l0_residual_tp2
	input -> l0_residual_tp2
	l0_residual_tp2 -> l0_gate_tp2
	l0_gate_tp2 -> l0_exp0_gpu2 [style=dashed]
	l0_residual_tp2 -> l0_exp0_gpu2
	l0_exp0_gpu2 -> l0_exp_agg_tp2
	l0_gate_tp2 -> l0_exp1_gpu2 [style=dashed]
	l0_residual_tp2 -> l0_exp1_gpu2
	l0_exp1_gpu2 -> l0_exp_agg_tp2
	l0_gate_tp2 -> l0_exp2_gpu2 [style=dashed]
	l0_residual_tp2 -> l0_exp2_gpu2
	l0_exp2_gpu2 -> l0_exp_agg_tp2
	l0_gate_tp2 -> l0_exp3_gpu2 [style=dashed]
	l0_residual_tp2 -> l0_exp3_gpu2
	l0_exp3_gpu2 -> l0_exp_agg_tp2
	l0_gate_tp2 -> l0_exp4_gpu2 [style=dashed]
	l0_residual_tp2 -> l0_exp4_gpu2
	l0_exp4_gpu2 -> l0_exp_agg_tp2
	l0_gate_tp2 -> l0_exp5_gpu2 [style=dashed]
	l0_residual_tp2 -> l0_exp5_gpu2
	l0_exp5_gpu2 -> l0_exp_agg_tp2
	l0_gate_tp2 -> l0_exp6_gpu2 [style=dashed]
	l0_residual_tp2 -> l0_exp6_gpu2
	l0_exp6_gpu2 -> l0_exp_agg_tp2
	l0_gate_tp2 -> l0_exp7_gpu2 [style=dashed]
	l0_residual_tp2 -> l0_exp7_gpu2
	l0_exp7_gpu2 -> l0_exp_agg_tp2
	l0_exp_agg_tp2 -> l0_final_res_tp2
	l0_residual_tp2 -> l0_final_res_tp2
	input -> l0_qkv_tp3
	l0_qkv_tp3 -> l0_attn_tp3
	l0_attn_tp3 -> l0_out_proj_tp3
	l0_out_proj_tp3 -> l0_residual_tp3
	input -> l0_residual_tp3
	l0_residual_tp3 -> l0_gate_tp3
	l0_gate_tp3 -> l0_exp0_gpu3 [style=dashed]
	l0_residual_tp3 -> l0_exp0_gpu3
	l0_exp0_gpu3 -> l0_exp_agg_tp3
	l0_gate_tp3 -> l0_exp1_gpu3 [style=dashed]
	l0_residual_tp3 -> l0_exp1_gpu3
	l0_exp1_gpu3 -> l0_exp_agg_tp3
	l0_gate_tp3 -> l0_exp2_gpu3 [style=dashed]
	l0_residual_tp3 -> l0_exp2_gpu3
	l0_exp2_gpu3 -> l0_exp_agg_tp3
	l0_gate_tp3 -> l0_exp3_gpu3 [style=dashed]
	l0_residual_tp3 -> l0_exp3_gpu3
	l0_exp3_gpu3 -> l0_exp_agg_tp3
	l0_gate_tp3 -> l0_exp4_gpu3 [style=dashed]
	l0_residual_tp3 -> l0_exp4_gpu3
	l0_exp4_gpu3 -> l0_exp_agg_tp3
	l0_gate_tp3 -> l0_exp5_gpu3 [style=dashed]
	l0_residual_tp3 -> l0_exp5_gpu3
	l0_exp5_gpu3 -> l0_exp_agg_tp3
	l0_gate_tp3 -> l0_exp6_gpu3 [style=dashed]
	l0_residual_tp3 -> l0_exp6_gpu3
	l0_exp6_gpu3 -> l0_exp_agg_tp3
	l0_gate_tp3 -> l0_exp7_gpu3 [style=dashed]
	l0_residual_tp3 -> l0_exp7_gpu3
	l0_exp7_gpu3 -> l0_exp_agg_tp3
	l0_exp_agg_tp3 -> l0_final_res_tp3
	l0_residual_tp3 -> l0_final_res_tp3
	input -> l0_qkv_tp4
	l0_qkv_tp4 -> l0_attn_tp4
	l0_attn_tp4 -> l0_out_proj_tp4
	l0_out_proj_tp4 -> l0_residual_tp4
	input -> l0_residual_tp4
	l0_residual_tp4 -> l0_gate_tp4
	l0_gate_tp4 -> l0_exp0_gpu4 [style=dashed]
	l0_residual_tp4 -> l0_exp0_gpu4
	l0_exp0_gpu4 -> l0_exp_agg_tp4
	l0_gate_tp4 -> l0_exp1_gpu4 [style=dashed]
	l0_residual_tp4 -> l0_exp1_gpu4
	l0_exp1_gpu4 -> l0_exp_agg_tp4
	l0_gate_tp4 -> l0_exp2_gpu4 [style=dashed]
	l0_residual_tp4 -> l0_exp2_gpu4
	l0_exp2_gpu4 -> l0_exp_agg_tp4
	l0_gate_tp4 -> l0_exp3_gpu4 [style=dashed]
	l0_residual_tp4 -> l0_exp3_gpu4
	l0_exp3_gpu4 -> l0_exp_agg_tp4
	l0_gate_tp4 -> l0_exp4_gpu4 [style=dashed]
	l0_residual_tp4 -> l0_exp4_gpu4
	l0_exp4_gpu4 -> l0_exp_agg_tp4
	l0_gate_tp4 -> l0_exp5_gpu4 [style=dashed]
	l0_residual_tp4 -> l0_exp5_gpu4
	l0_exp5_gpu4 -> l0_exp_agg_tp4
	l0_gate_tp4 -> l0_exp6_gpu4 [style=dashed]
	l0_residual_tp4 -> l0_exp6_gpu4
	l0_exp6_gpu4 -> l0_exp_agg_tp4
	l0_gate_tp4 -> l0_exp7_gpu4 [style=dashed]
	l0_residual_tp4 -> l0_exp7_gpu4
	l0_exp7_gpu4 -> l0_exp_agg_tp4
	l0_exp_agg_tp4 -> l0_final_res_tp4
	l0_residual_tp4 -> l0_final_res_tp4
	input -> l0_qkv_tp5
	l0_qkv_tp5 -> l0_attn_tp5
	l0_attn_tp5 -> l0_out_proj_tp5
	l0_out_proj_tp5 -> l0_residual_tp5
	input -> l0_residual_tp5
	l0_residual_tp5 -> l0_gate_tp5
	l0_gate_tp5 -> l0_exp0_gpu5 [style=dashed]
	l0_residual_tp5 -> l0_exp0_gpu5
	l0_exp0_gpu5 -> l0_exp_agg_tp5
	l0_gate_tp5 -> l0_exp1_gpu5 [style=dashed]
	l0_residual_tp5 -> l0_exp1_gpu5
	l0_exp1_gpu5 -> l0_exp_agg_tp5
	l0_gate_tp5 -> l0_exp2_gpu5 [style=dashed]
	l0_residual_tp5 -> l0_exp2_gpu5
	l0_exp2_gpu5 -> l0_exp_agg_tp5
	l0_gate_tp5 -> l0_exp3_gpu5 [style=dashed]
	l0_residual_tp5 -> l0_exp3_gpu5
	l0_exp3_gpu5 -> l0_exp_agg_tp5
	l0_gate_tp5 -> l0_exp4_gpu5 [style=dashed]
	l0_residual_tp5 -> l0_exp4_gpu5
	l0_exp4_gpu5 -> l0_exp_agg_tp5
	l0_gate_tp5 -> l0_exp5_gpu5 [style=dashed]
	l0_residual_tp5 -> l0_exp5_gpu5
	l0_exp5_gpu5 -> l0_exp_agg_tp5
	l0_gate_tp5 -> l0_exp6_gpu5 [style=dashed]
	l0_residual_tp5 -> l0_exp6_gpu5
	l0_exp6_gpu5 -> l0_exp_agg_tp5
	l0_gate_tp5 -> l0_exp7_gpu5 [style=dashed]
	l0_residual_tp5 -> l0_exp7_gpu5
	l0_exp7_gpu5 -> l0_exp_agg_tp5
	l0_exp_agg_tp5 -> l0_final_res_tp5
	l0_residual_tp5 -> l0_final_res_tp5
	input -> l0_qkv_tp6
	l0_qkv_tp6 -> l0_attn_tp6
	l0_attn_tp6 -> l0_out_proj_tp6
	l0_out_proj_tp6 -> l0_residual_tp6
	input -> l0_residual_tp6
	l0_residual_tp6 -> l0_gate_tp6
	l0_gate_tp6 -> l0_exp0_gpu6 [style=dashed]
	l0_residual_tp6 -> l0_exp0_gpu6
	l0_exp0_gpu6 -> l0_exp_agg_tp6
	l0_gate_tp6 -> l0_exp1_gpu6 [style=dashed]
	l0_residual_tp6 -> l0_exp1_gpu6
	l0_exp1_gpu6 -> l0_exp_agg_tp6
	l0_gate_tp6 -> l0_exp2_gpu6 [style=dashed]
	l0_residual_tp6 -> l0_exp2_gpu6
	l0_exp2_gpu6 -> l0_exp_agg_tp6
	l0_gate_tp6 -> l0_exp3_gpu6 [style=dashed]
	l0_residual_tp6 -> l0_exp3_gpu6
	l0_exp3_gpu6 -> l0_exp_agg_tp6
	l0_gate_tp6 -> l0_exp4_gpu6 [style=dashed]
	l0_residual_tp6 -> l0_exp4_gpu6
	l0_exp4_gpu6 -> l0_exp_agg_tp6
	l0_gate_tp6 -> l0_exp5_gpu6 [style=dashed]
	l0_residual_tp6 -> l0_exp5_gpu6
	l0_exp5_gpu6 -> l0_exp_agg_tp6
	l0_gate_tp6 -> l0_exp6_gpu6 [style=dashed]
	l0_residual_tp6 -> l0_exp6_gpu6
	l0_exp6_gpu6 -> l0_exp_agg_tp6
	l0_gate_tp6 -> l0_exp7_gpu6 [style=dashed]
	l0_residual_tp6 -> l0_exp7_gpu6
	l0_exp7_gpu6 -> l0_exp_agg_tp6
	l0_exp_agg_tp6 -> l0_final_res_tp6
	l0_residual_tp6 -> l0_final_res_tp6
	input -> l0_qkv_tp7
	l0_qkv_tp7 -> l0_attn_tp7
	l0_attn_tp7 -> l0_out_proj_tp7
	l0_out_proj_tp7 -> l0_residual_tp7
	input -> l0_residual_tp7
	l0_residual_tp7 -> l0_gate_tp7
	l0_gate_tp7 -> l0_exp0_gpu7 [style=dashed]
	l0_residual_tp7 -> l0_exp0_gpu7
	l0_exp0_gpu7 -> l0_exp_agg_tp7
	l0_gate_tp7 -> l0_exp1_gpu7 [style=dashed]
	l0_residual_tp7 -> l0_exp1_gpu7
	l0_exp1_gpu7 -> l0_exp_agg_tp7
	l0_gate_tp7 -> l0_exp2_gpu7 [style=dashed]
	l0_residual_tp7 -> l0_exp2_gpu7
	l0_exp2_gpu7 -> l0_exp_agg_tp7
	l0_gate_tp7 -> l0_exp3_gpu7 [style=dashed]
	l0_residual_tp7 -> l0_exp3_gpu7
	l0_exp3_gpu7 -> l0_exp_agg_tp7
	l0_gate_tp7 -> l0_exp4_gpu7 [style=dashed]
	l0_residual_tp7 -> l0_exp4_gpu7
	l0_exp4_gpu7 -> l0_exp_agg_tp7
	l0_gate_tp7 -> l0_exp5_gpu7 [style=dashed]
	l0_residual_tp7 -> l0_exp5_gpu7
	l0_exp5_gpu7 -> l0_exp_agg_tp7
	l0_gate_tp7 -> l0_exp6_gpu7 [style=dashed]
	l0_residual_tp7 -> l0_exp6_gpu7
	l0_exp6_gpu7 -> l0_exp_agg_tp7
	l0_gate_tp7 -> l0_exp7_gpu7 [style=dashed]
	l0_residual_tp7 -> l0_exp7_gpu7
	l0_exp7_gpu7 -> l0_exp_agg_tp7
	l0_exp_agg_tp7 -> l0_final_res_tp7
	l0_residual_tp7 -> l0_final_res_tp7
	l0_final_res_tp0 -> l1_qkv_tp0
	l1_qkv_tp0 -> l1_attn_tp0
	l1_attn_tp0 -> l1_out_proj_tp0
	l1_out_proj_tp0 -> l1_residual_tp0
	l0_final_res_tp0 -> l1_residual_tp0
	l1_residual_tp0 -> l1_gate_tp0
	l1_gate_tp0 -> l1_exp0_gpu0 [style=dashed]
	l1_residual_tp0 -> l1_exp0_gpu0
	l1_exp0_gpu0 -> l1_exp_agg_tp0
	l1_gate_tp0 -> l1_exp1_gpu0 [style=dashed]
	l1_residual_tp0 -> l1_exp1_gpu0
	l1_exp1_gpu0 -> l1_exp_agg_tp0
	l1_gate_tp0 -> l1_exp2_gpu0 [style=dashed]
	l1_residual_tp0 -> l1_exp2_gpu0
	l1_exp2_gpu0 -> l1_exp_agg_tp0
	l1_gate_tp0 -> l1_exp3_gpu0 [style=dashed]
	l1_residual_tp0 -> l1_exp3_gpu0
	l1_exp3_gpu0 -> l1_exp_agg_tp0
	l1_gate_tp0 -> l1_exp4_gpu0 [style=dashed]
	l1_residual_tp0 -> l1_exp4_gpu0
	l1_exp4_gpu0 -> l1_exp_agg_tp0
	l1_gate_tp0 -> l1_exp5_gpu0 [style=dashed]
	l1_residual_tp0 -> l1_exp5_gpu0
	l1_exp5_gpu0 -> l1_exp_agg_tp0
	l1_gate_tp0 -> l1_exp6_gpu0 [style=dashed]
	l1_residual_tp0 -> l1_exp6_gpu0
	l1_exp6_gpu0 -> l1_exp_agg_tp0
	l1_gate_tp0 -> l1_exp7_gpu0 [style=dashed]
	l1_residual_tp0 -> l1_exp7_gpu0
	l1_exp7_gpu0 -> l1_exp_agg_tp0
	l1_exp_agg_tp0 -> l1_final_res_tp0
	l1_residual_tp0 -> l1_final_res_tp0
	l0_final_res_tp1 -> l1_qkv_tp1
	l1_qkv_tp1 -> l1_attn_tp1
	l1_attn_tp1 -> l1_out_proj_tp1
	l1_out_proj_tp1 -> l1_residual_tp1
	l0_final_res_tp1 -> l1_residual_tp1
	l1_residual_tp1 -> l1_gate_tp1
	l1_gate_tp1 -> l1_exp0_gpu1 [style=dashed]
	l1_residual_tp1 -> l1_exp0_gpu1
	l1_exp0_gpu1 -> l1_exp_agg_tp1
	l1_gate_tp1 -> l1_exp1_gpu1 [style=dashed]
	l1_residual_tp1 -> l1_exp1_gpu1
	l1_exp1_gpu1 -> l1_exp_agg_tp1
	l1_gate_tp1 -> l1_exp2_gpu1 [style=dashed]
	l1_residual_tp1 -> l1_exp2_gpu1
	l1_exp2_gpu1 -> l1_exp_agg_tp1
	l1_gate_tp1 -> l1_exp3_gpu1 [style=dashed]
	l1_residual_tp1 -> l1_exp3_gpu1
	l1_exp3_gpu1 -> l1_exp_agg_tp1
	l1_gate_tp1 -> l1_exp4_gpu1 [style=dashed]
	l1_residual_tp1 -> l1_exp4_gpu1
	l1_exp4_gpu1 -> l1_exp_agg_tp1
	l1_gate_tp1 -> l1_exp5_gpu1 [style=dashed]
	l1_residual_tp1 -> l1_exp5_gpu1
	l1_exp5_gpu1 -> l1_exp_agg_tp1
	l1_gate_tp1 -> l1_exp6_gpu1 [style=dashed]
	l1_residual_tp1 -> l1_exp6_gpu1
	l1_exp6_gpu1 -> l1_exp_agg_tp1
	l1_gate_tp1 -> l1_exp7_gpu1 [style=dashed]
	l1_residual_tp1 -> l1_exp7_gpu1
	l1_exp7_gpu1 -> l1_exp_agg_tp1
	l1_exp_agg_tp1 -> l1_final_res_tp1
	l1_residual_tp1 -> l1_final_res_tp1
	l0_final_res_tp2 -> l1_qkv_tp2
	l1_qkv_tp2 -> l1_attn_tp2
	l1_attn_tp2 -> l1_out_proj_tp2
	l1_out_proj_tp2 -> l1_residual_tp2
	l0_final_res_tp2 -> l1_residual_tp2
	l1_residual_tp2 -> l1_gate_tp2
	l1_gate_tp2 -> l1_exp0_gpu2 [style=dashed]
	l1_residual_tp2 -> l1_exp0_gpu2
	l1_exp0_gpu2 -> l1_exp_agg_tp2
	l1_gate_tp2 -> l1_exp1_gpu2 [style=dashed]
	l1_residual_tp2 -> l1_exp1_gpu2
	l1_exp1_gpu2 -> l1_exp_agg_tp2
	l1_gate_tp2 -> l1_exp2_gpu2 [style=dashed]
	l1_residual_tp2 -> l1_exp2_gpu2
	l1_exp2_gpu2 -> l1_exp_agg_tp2
	l1_gate_tp2 -> l1_exp3_gpu2 [style=dashed]
	l1_residual_tp2 -> l1_exp3_gpu2
	l1_exp3_gpu2 -> l1_exp_agg_tp2
	l1_gate_tp2 -> l1_exp4_gpu2 [style=dashed]
	l1_residual_tp2 -> l1_exp4_gpu2
	l1_exp4_gpu2 -> l1_exp_agg_tp2
	l1_gate_tp2 -> l1_exp5_gpu2 [style=dashed]
	l1_residual_tp2 -> l1_exp5_gpu2
	l1_exp5_gpu2 -> l1_exp_agg_tp2
	l1_gate_tp2 -> l1_exp6_gpu2 [style=dashed]
	l1_residual_tp2 -> l1_exp6_gpu2
	l1_exp6_gpu2 -> l1_exp_agg_tp2
	l1_gate_tp2 -> l1_exp7_gpu2 [style=dashed]
	l1_residual_tp2 -> l1_exp7_gpu2
	l1_exp7_gpu2 -> l1_exp_agg_tp2
	l1_exp_agg_tp2 -> l1_final_res_tp2
	l1_residual_tp2 -> l1_final_res_tp2
	l0_final_res_tp3 -> l1_qkv_tp3
	l1_qkv_tp3 -> l1_attn_tp3
	l1_attn_tp3 -> l1_out_proj_tp3
	l1_out_proj_tp3 -> l1_residual_tp3
	l0_final_res_tp3 -> l1_residual_tp3
	l1_residual_tp3 -> l1_gate_tp3
	l1_gate_tp3 -> l1_exp0_gpu3 [style=dashed]
	l1_residual_tp3 -> l1_exp0_gpu3
	l1_exp0_gpu3 -> l1_exp_agg_tp3
	l1_gate_tp3 -> l1_exp1_gpu3 [style=dashed]
	l1_residual_tp3 -> l1_exp1_gpu3
	l1_exp1_gpu3 -> l1_exp_agg_tp3
	l1_gate_tp3 -> l1_exp2_gpu3 [style=dashed]
	l1_residual_tp3 -> l1_exp2_gpu3
	l1_exp2_gpu3 -> l1_exp_agg_tp3
	l1_gate_tp3 -> l1_exp3_gpu3 [style=dashed]
	l1_residual_tp3 -> l1_exp3_gpu3
	l1_exp3_gpu3 -> l1_exp_agg_tp3
	l1_gate_tp3 -> l1_exp4_gpu3 [style=dashed]
	l1_residual_tp3 -> l1_exp4_gpu3
	l1_exp4_gpu3 -> l1_exp_agg_tp3
	l1_gate_tp3 -> l1_exp5_gpu3 [style=dashed]
	l1_residual_tp3 -> l1_exp5_gpu3
	l1_exp5_gpu3 -> l1_exp_agg_tp3
	l1_gate_tp3 -> l1_exp6_gpu3 [style=dashed]
	l1_residual_tp3 -> l1_exp6_gpu3
	l1_exp6_gpu3 -> l1_exp_agg_tp3
	l1_gate_tp3 -> l1_exp7_gpu3 [style=dashed]
	l1_residual_tp3 -> l1_exp7_gpu3
	l1_exp7_gpu3 -> l1_exp_agg_tp3
	l1_exp_agg_tp3 -> l1_final_res_tp3
	l1_residual_tp3 -> l1_final_res_tp3
	l0_final_res_tp4 -> l1_qkv_tp4
	l1_qkv_tp4 -> l1_attn_tp4
	l1_attn_tp4 -> l1_out_proj_tp4
	l1_out_proj_tp4 -> l1_residual_tp4
	l0_final_res_tp4 -> l1_residual_tp4
	l1_residual_tp4 -> l1_gate_tp4
	l1_gate_tp4 -> l1_exp0_gpu4 [style=dashed]
	l1_residual_tp4 -> l1_exp0_gpu4
	l1_exp0_gpu4 -> l1_exp_agg_tp4
	l1_gate_tp4 -> l1_exp1_gpu4 [style=dashed]
	l1_residual_tp4 -> l1_exp1_gpu4
	l1_exp1_gpu4 -> l1_exp_agg_tp4
	l1_gate_tp4 -> l1_exp2_gpu4 [style=dashed]
	l1_residual_tp4 -> l1_exp2_gpu4
	l1_exp2_gpu4 -> l1_exp_agg_tp4
	l1_gate_tp4 -> l1_exp3_gpu4 [style=dashed]
	l1_residual_tp4 -> l1_exp3_gpu4
	l1_exp3_gpu4 -> l1_exp_agg_tp4
	l1_gate_tp4 -> l1_exp4_gpu4 [style=dashed]
	l1_residual_tp4 -> l1_exp4_gpu4
	l1_exp4_gpu4 -> l1_exp_agg_tp4
	l1_gate_tp4 -> l1_exp5_gpu4 [style=dashed]
	l1_residual_tp4 -> l1_exp5_gpu4
	l1_exp5_gpu4 -> l1_exp_agg_tp4
	l1_gate_tp4 -> l1_exp6_gpu4 [style=dashed]
	l1_residual_tp4 -> l1_exp6_gpu4
	l1_exp6_gpu4 -> l1_exp_agg_tp4
	l1_gate_tp4 -> l1_exp7_gpu4 [style=dashed]
	l1_residual_tp4 -> l1_exp7_gpu4
	l1_exp7_gpu4 -> l1_exp_agg_tp4
	l1_exp_agg_tp4 -> l1_final_res_tp4
	l1_residual_tp4 -> l1_final_res_tp4
	l0_final_res_tp5 -> l1_qkv_tp5
	l1_qkv_tp5 -> l1_attn_tp5
	l1_attn_tp5 -> l1_out_proj_tp5
	l1_out_proj_tp5 -> l1_residual_tp5
	l0_final_res_tp5 -> l1_residual_tp5
	l1_residual_tp5 -> l1_gate_tp5
	l1_gate_tp5 -> l1_exp0_gpu5 [style=dashed]
	l1_residual_tp5 -> l1_exp0_gpu5
	l1_exp0_gpu5 -> l1_exp_agg_tp5
	l1_gate_tp5 -> l1_exp1_gpu5 [style=dashed]
	l1_residual_tp5 -> l1_exp1_gpu5
	l1_exp1_gpu5 -> l1_exp_agg_tp5
	l1_gate_tp5 -> l1_exp2_gpu5 [style=dashed]
	l1_residual_tp5 -> l1_exp2_gpu5
	l1_exp2_gpu5 -> l1_exp_agg_tp5
	l1_gate_tp5 -> l1_exp3_gpu5 [style=dashed]
	l1_residual_tp5 -> l1_exp3_gpu5
	l1_exp3_gpu5 -> l1_exp_agg_tp5
	l1_gate_tp5 -> l1_exp4_gpu5 [style=dashed]
	l1_residual_tp5 -> l1_exp4_gpu5
	l1_exp4_gpu5 -> l1_exp_agg_tp5
	l1_gate_tp5 -> l1_exp5_gpu5 [style=dashed]
	l1_residual_tp5 -> l1_exp5_gpu5
	l1_exp5_gpu5 -> l1_exp_agg_tp5
	l1_gate_tp5 -> l1_exp6_gpu5 [style=dashed]
	l1_residual_tp5 -> l1_exp6_gpu5
	l1_exp6_gpu5 -> l1_exp_agg_tp5
	l1_gate_tp5 -> l1_exp7_gpu5 [style=dashed]
	l1_residual_tp5 -> l1_exp7_gpu5
	l1_exp7_gpu5 -> l1_exp_agg_tp5
	l1_exp_agg_tp5 -> l1_final_res_tp5
	l1_residual_tp5 -> l1_final_res_tp5
	l0_final_res_tp6 -> l1_qkv_tp6
	l1_qkv_tp6 -> l1_attn_tp6
	l1_attn_tp6 -> l1_out_proj_tp6
	l1_out_proj_tp6 -> l1_residual_tp6
	l0_final_res_tp6 -> l1_residual_tp6
	l1_residual_tp6 -> l1_gate_tp6
	l1_gate_tp6 -> l1_exp0_gpu6 [style=dashed]
	l1_residual_tp6 -> l1_exp0_gpu6
	l1_exp0_gpu6 -> l1_exp_agg_tp6
	l1_gate_tp6 -> l1_exp1_gpu6 [style=dashed]
	l1_residual_tp6 -> l1_exp1_gpu6
	l1_exp1_gpu6 -> l1_exp_agg_tp6
	l1_gate_tp6 -> l1_exp2_gpu6 [style=dashed]
	l1_residual_tp6 -> l1_exp2_gpu6
	l1_exp2_gpu6 -> l1_exp_agg_tp6
	l1_gate_tp6 -> l1_exp3_gpu6 [style=dashed]
	l1_residual_tp6 -> l1_exp3_gpu6
	l1_exp3_gpu6 -> l1_exp_agg_tp6
	l1_gate_tp6 -> l1_exp4_gpu6 [style=dashed]
	l1_residual_tp6 -> l1_exp4_gpu6
	l1_exp4_gpu6 -> l1_exp_agg_tp6
	l1_gate_tp6 -> l1_exp5_gpu6 [style=dashed]
	l1_residual_tp6 -> l1_exp5_gpu6
	l1_exp5_gpu6 -> l1_exp_agg_tp6
	l1_gate_tp6 -> l1_exp6_gpu6 [style=dashed]
	l1_residual_tp6 -> l1_exp6_gpu6
	l1_exp6_gpu6 -> l1_exp_agg_tp6
	l1_gate_tp6 -> l1_exp7_gpu6 [style=dashed]
	l1_residual_tp6 -> l1_exp7_gpu6
	l1_exp7_gpu6 -> l1_exp_agg_tp6
	l1_exp_agg_tp6 -> l1_final_res_tp6
	l1_residual_tp6 -> l1_final_res_tp6
	l0_final_res_tp7 -> l1_qkv_tp7
	l1_qkv_tp7 -> l1_attn_tp7
	l1_attn_tp7 -> l1_out_proj_tp7
	l1_out_proj_tp7 -> l1_residual_tp7
	l0_final_res_tp7 -> l1_residual_tp7
	l1_residual_tp7 -> l1_gate_tp7
	l1_gate_tp7 -> l1_exp0_gpu7 [style=dashed]
	l1_residual_tp7 -> l1_exp0_gpu7
	l1_exp0_gpu7 -> l1_exp_agg_tp7
	l1_gate_tp7 -> l1_exp1_gpu7 [style=dashed]
	l1_residual_tp7 -> l1_exp1_gpu7
	l1_exp1_gpu7 -> l1_exp_agg_tp7
	l1_gate_tp7 -> l1_exp2_gpu7 [style=dashed]
	l1_residual_tp7 -> l1_exp2_gpu7
	l1_exp2_gpu7 -> l1_exp_agg_tp7
	l1_gate_tp7 -> l1_exp3_gpu7 [style=dashed]
	l1_residual_tp7 -> l1_exp3_gpu7
	l1_exp3_gpu7 -> l1_exp_agg_tp7
	l1_gate_tp7 -> l1_exp4_gpu7 [style=dashed]
	l1_residual_tp7 -> l1_exp4_gpu7
	l1_exp4_gpu7 -> l1_exp_agg_tp7
	l1_gate_tp7 -> l1_exp5_gpu7 [style=dashed]
	l1_residual_tp7 -> l1_exp5_gpu7
	l1_exp5_gpu7 -> l1_exp_agg_tp7
	l1_gate_tp7 -> l1_exp6_gpu7 [style=dashed]
	l1_residual_tp7 -> l1_exp6_gpu7
	l1_exp6_gpu7 -> l1_exp_agg_tp7
	l1_gate_tp7 -> l1_exp7_gpu7 [style=dashed]
	l1_residual_tp7 -> l1_exp7_gpu7
	l1_exp7_gpu7 -> l1_exp_agg_tp7
	l1_exp_agg_tp7 -> l1_final_res_tp7
	l1_residual_tp7 -> l1_final_res_tp7
	l1_final_res_tp0 -> l2_qkv_tp0 [label="Pipeline P2P\nGPU 0 → GPU 8"]
	l1_final_res_tp1 -> l2_qkv_tp1 [label="Pipeline P2P\nGPU 1 → GPU 9"]
	l1_final_res_tp2 -> l2_qkv_tp2 [label="Pipeline P2P\nGPU 2 → GPU 10"]
	l1_final_res_tp3 -> l2_qkv_tp3 [label="Pipeline P2P\nGPU 3 → GPU 11"]
	l1_final_res_tp4 -> l2_qkv_tp4 [label="Pipeline P2P\nGPU 4 → GPU 12"]
	l1_final_res_tp5 -> l2_qkv_tp5 [label="Pipeline P2P\nGPU 5 → GPU 13"]
	l1_final_res_tp6 -> l2_qkv_tp6 [label="Pipeline P2P\nGPU 6 → GPU 14"]
	l1_final_res_tp7 -> l2_qkv_tp7 [label="Pipeline P2P\nGPU 7 → GPU 15"]
	l2_qkv_tp0 -> l2_attn_tp0
	l2_attn_tp0 -> l2_out_proj_tp0
	l2_out_proj_tp0 -> l2_residual_tp0
	l2_qkv_tp0 -> l2_residual_tp0
	l2_residual_tp0 -> l2_gate_tp0
	l2_gate_tp0 -> l2_exp0_gpu8 [style=dashed]
	l2_residual_tp0 -> l2_exp0_gpu8
	l2_exp0_gpu8 -> l2_exp_agg_tp0
	l2_gate_tp0 -> l2_exp1_gpu8 [style=dashed]
	l2_residual_tp0 -> l2_exp1_gpu8
	l2_exp1_gpu8 -> l2_exp_agg_tp0
	l2_gate_tp0 -> l2_exp2_gpu8 [style=dashed]
	l2_residual_tp0 -> l2_exp2_gpu8
	l2_exp2_gpu8 -> l2_exp_agg_tp0
	l2_gate_tp0 -> l2_exp3_gpu8 [style=dashed]
	l2_residual_tp0 -> l2_exp3_gpu8
	l2_exp3_gpu8 -> l2_exp_agg_tp0
	l2_gate_tp0 -> l2_exp4_gpu8 [style=dashed]
	l2_residual_tp0 -> l2_exp4_gpu8
	l2_exp4_gpu8 -> l2_exp_agg_tp0
	l2_gate_tp0 -> l2_exp5_gpu8 [style=dashed]
	l2_residual_tp0 -> l2_exp5_gpu8
	l2_exp5_gpu8 -> l2_exp_agg_tp0
	l2_gate_tp0 -> l2_exp6_gpu8 [style=dashed]
	l2_residual_tp0 -> l2_exp6_gpu8
	l2_exp6_gpu8 -> l2_exp_agg_tp0
	l2_gate_tp0 -> l2_exp7_gpu8 [style=dashed]
	l2_residual_tp0 -> l2_exp7_gpu8
	l2_exp7_gpu8 -> l2_exp_agg_tp0
	l2_exp_agg_tp0 -> l2_final_res_tp0
	l2_residual_tp0 -> l2_final_res_tp0
	l2_qkv_tp1 -> l2_attn_tp1
	l2_attn_tp1 -> l2_out_proj_tp1
	l2_out_proj_tp1 -> l2_residual_tp1
	l2_qkv_tp1 -> l2_residual_tp1
	l2_residual_tp1 -> l2_gate_tp1
	l2_gate_tp1 -> l2_exp0_gpu9 [style=dashed]
	l2_residual_tp1 -> l2_exp0_gpu9
	l2_exp0_gpu9 -> l2_exp_agg_tp1
	l2_gate_tp1 -> l2_exp1_gpu9 [style=dashed]
	l2_residual_tp1 -> l2_exp1_gpu9
	l2_exp1_gpu9 -> l2_exp_agg_tp1
	l2_gate_tp1 -> l2_exp2_gpu9 [style=dashed]
	l2_residual_tp1 -> l2_exp2_gpu9
	l2_exp2_gpu9 -> l2_exp_agg_tp1
	l2_gate_tp1 -> l2_exp3_gpu9 [style=dashed]
	l2_residual_tp1 -> l2_exp3_gpu9
	l2_exp3_gpu9 -> l2_exp_agg_tp1
	l2_gate_tp1 -> l2_exp4_gpu9 [style=dashed]
	l2_residual_tp1 -> l2_exp4_gpu9
	l2_exp4_gpu9 -> l2_exp_agg_tp1
	l2_gate_tp1 -> l2_exp5_gpu9 [style=dashed]
	l2_residual_tp1 -> l2_exp5_gpu9
	l2_exp5_gpu9 -> l2_exp_agg_tp1
	l2_gate_tp1 -> l2_exp6_gpu9 [style=dashed]
	l2_residual_tp1 -> l2_exp6_gpu9
	l2_exp6_gpu9 -> l2_exp_agg_tp1
	l2_gate_tp1 -> l2_exp7_gpu9 [style=dashed]
	l2_residual_tp1 -> l2_exp7_gpu9
	l2_exp7_gpu9 -> l2_exp_agg_tp1
	l2_exp_agg_tp1 -> l2_final_res_tp1
	l2_residual_tp1 -> l2_final_res_tp1
	l2_qkv_tp2 -> l2_attn_tp2
	l2_attn_tp2 -> l2_out_proj_tp2
	l2_out_proj_tp2 -> l2_residual_tp2
	l2_qkv_tp2 -> l2_residual_tp2
	l2_residual_tp2 -> l2_gate_tp2
	l2_gate_tp2 -> l2_exp0_gpu10 [style=dashed]
	l2_residual_tp2 -> l2_exp0_gpu10
	l2_exp0_gpu10 -> l2_exp_agg_tp2
	l2_gate_tp2 -> l2_exp1_gpu10 [style=dashed]
	l2_residual_tp2 -> l2_exp1_gpu10
	l2_exp1_gpu10 -> l2_exp_agg_tp2
	l2_gate_tp2 -> l2_exp2_gpu10 [style=dashed]
	l2_residual_tp2 -> l2_exp2_gpu10
	l2_exp2_gpu10 -> l2_exp_agg_tp2
	l2_gate_tp2 -> l2_exp3_gpu10 [style=dashed]
	l2_residual_tp2 -> l2_exp3_gpu10
	l2_exp3_gpu10 -> l2_exp_agg_tp2
	l2_gate_tp2 -> l2_exp4_gpu10 [style=dashed]
	l2_residual_tp2 -> l2_exp4_gpu10
	l2_exp4_gpu10 -> l2_exp_agg_tp2
	l2_gate_tp2 -> l2_exp5_gpu10 [style=dashed]
	l2_residual_tp2 -> l2_exp5_gpu10
	l2_exp5_gpu10 -> l2_exp_agg_tp2
	l2_gate_tp2 -> l2_exp6_gpu10 [style=dashed]
	l2_residual_tp2 -> l2_exp6_gpu10
	l2_exp6_gpu10 -> l2_exp_agg_tp2
	l2_gate_tp2 -> l2_exp7_gpu10 [style=dashed]
	l2_residual_tp2 -> l2_exp7_gpu10
	l2_exp7_gpu10 -> l2_exp_agg_tp2
	l2_exp_agg_tp2 -> l2_final_res_tp2
	l2_residual_tp2 -> l2_final_res_tp2
	l2_qkv_tp3 -> l2_attn_tp3
	l2_attn_tp3 -> l2_out_proj_tp3
	l2_out_proj_tp3 -> l2_residual_tp3
	l2_qkv_tp3 -> l2_residual_tp3
	l2_residual_tp3 -> l2_gate_tp3
	l2_gate_tp3 -> l2_exp0_gpu11 [style=dashed]
	l2_residual_tp3 -> l2_exp0_gpu11
	l2_exp0_gpu11 -> l2_exp_agg_tp3
	l2_gate_tp3 -> l2_exp1_gpu11 [style=dashed]
	l2_residual_tp3 -> l2_exp1_gpu11
	l2_exp1_gpu11 -> l2_exp_agg_tp3
	l2_gate_tp3 -> l2_exp2_gpu11 [style=dashed]
	l2_residual_tp3 -> l2_exp2_gpu11
	l2_exp2_gpu11 -> l2_exp_agg_tp3
	l2_gate_tp3 -> l2_exp3_gpu11 [style=dashed]
	l2_residual_tp3 -> l2_exp3_gpu11
	l2_exp3_gpu11 -> l2_exp_agg_tp3
	l2_gate_tp3 -> l2_exp4_gpu11 [style=dashed]
	l2_residual_tp3 -> l2_exp4_gpu11
	l2_exp4_gpu11 -> l2_exp_agg_tp3
	l2_gate_tp3 -> l2_exp5_gpu11 [style=dashed]
	l2_residual_tp3 -> l2_exp5_gpu11
	l2_exp5_gpu11 -> l2_exp_agg_tp3
	l2_gate_tp3 -> l2_exp6_gpu11 [style=dashed]
	l2_residual_tp3 -> l2_exp6_gpu11
	l2_exp6_gpu11 -> l2_exp_agg_tp3
	l2_gate_tp3 -> l2_exp7_gpu11 [style=dashed]
	l2_residual_tp3 -> l2_exp7_gpu11
	l2_exp7_gpu11 -> l2_exp_agg_tp3
	l2_exp_agg_tp3 -> l2_final_res_tp3
	l2_residual_tp3 -> l2_final_res_tp3
	l2_qkv_tp4 -> l2_attn_tp4
	l2_attn_tp4 -> l2_out_proj_tp4
	l2_out_proj_tp4 -> l2_residual_tp4
	l2_qkv_tp4 -> l2_residual_tp4
	l2_residual_tp4 -> l2_gate_tp4
	l2_gate_tp4 -> l2_exp0_gpu12 [style=dashed]
	l2_residual_tp4 -> l2_exp0_gpu12
	l2_exp0_gpu12 -> l2_exp_agg_tp4
	l2_gate_tp4 -> l2_exp1_gpu12 [style=dashed]
	l2_residual_tp4 -> l2_exp1_gpu12
	l2_exp1_gpu12 -> l2_exp_agg_tp4
	l2_gate_tp4 -> l2_exp2_gpu12 [style=dashed]
	l2_residual_tp4 -> l2_exp2_gpu12
	l2_exp2_gpu12 -> l2_exp_agg_tp4
	l2_gate_tp4 -> l2_exp3_gpu12 [style=dashed]
	l2_residual_tp4 -> l2_exp3_gpu12
	l2_exp3_gpu12 -> l2_exp_agg_tp4
	l2_gate_tp4 -> l2_exp4_gpu12 [style=dashed]
	l2_residual_tp4 -> l2_exp4_gpu12
	l2_exp4_gpu12 -> l2_exp_agg_tp4
	l2_gate_tp4 -> l2_exp5_gpu12 [style=dashed]
	l2_residual_tp4 -> l2_exp5_gpu12
	l2_exp5_gpu12 -> l2_exp_agg_tp4
	l2_gate_tp4 -> l2_exp6_gpu12 [style=dashed]
	l2_residual_tp4 -> l2_exp6_gpu12
	l2_exp6_gpu12 -> l2_exp_agg_tp4
	l2_gate_tp4 -> l2_exp7_gpu12 [style=dashed]
	l2_residual_tp4 -> l2_exp7_gpu12
	l2_exp7_gpu12 -> l2_exp_agg_tp4
	l2_exp_agg_tp4 -> l2_final_res_tp4
	l2_residual_tp4 -> l2_final_res_tp4
	l2_qkv_tp5 -> l2_attn_tp5
	l2_attn_tp5 -> l2_out_proj_tp5
	l2_out_proj_tp5 -> l2_residual_tp5
	l2_qkv_tp5 -> l2_residual_tp5
	l2_residual_tp5 -> l2_gate_tp5
	l2_gate_tp5 -> l2_exp0_gpu13 [style=dashed]
	l2_residual_tp5 -> l2_exp0_gpu13
	l2_exp0_gpu13 -> l2_exp_agg_tp5
	l2_gate_tp5 -> l2_exp1_gpu13 [style=dashed]
	l2_residual_tp5 -> l2_exp1_gpu13
	l2_exp1_gpu13 -> l2_exp_agg_tp5
	l2_gate_tp5 -> l2_exp2_gpu13 [style=dashed]
	l2_residual_tp5 -> l2_exp2_gpu13
	l2_exp2_gpu13 -> l2_exp_agg_tp5
	l2_gate_tp5 -> l2_exp3_gpu13 [style=dashed]
	l2_residual_tp5 -> l2_exp3_gpu13
	l2_exp3_gpu13 -> l2_exp_agg_tp5
	l2_gate_tp5 -> l2_exp4_gpu13 [style=dashed]
	l2_residual_tp5 -> l2_exp4_gpu13
	l2_exp4_gpu13 -> l2_exp_agg_tp5
	l2_gate_tp5 -> l2_exp5_gpu13 [style=dashed]
	l2_residual_tp5 -> l2_exp5_gpu13
	l2_exp5_gpu13 -> l2_exp_agg_tp5
	l2_gate_tp5 -> l2_exp6_gpu13 [style=dashed]
	l2_residual_tp5 -> l2_exp6_gpu13
	l2_exp6_gpu13 -> l2_exp_agg_tp5
	l2_gate_tp5 -> l2_exp7_gpu13 [style=dashed]
	l2_residual_tp5 -> l2_exp7_gpu13
	l2_exp7_gpu13 -> l2_exp_agg_tp5
	l2_exp_agg_tp5 -> l2_final_res_tp5
	l2_residual_tp5 -> l2_final_res_tp5
	l2_qkv_tp6 -> l2_attn_tp6
	l2_attn_tp6 -> l2_out_proj_tp6
	l2_out_proj_tp6 -> l2_residual_tp6
	l2_qkv_tp6 -> l2_residual_tp6
	l2_residual_tp6 -> l2_gate_tp6
	l2_gate_tp6 -> l2_exp0_gpu14 [style=dashed]
	l2_residual_tp6 -> l2_exp0_gpu14
	l2_exp0_gpu14 -> l2_exp_agg_tp6
	l2_gate_tp6 -> l2_exp1_gpu14 [style=dashed]
	l2_residual_tp6 -> l2_exp1_gpu14
	l2_exp1_gpu14 -> l2_exp_agg_tp6
	l2_gate_tp6 -> l2_exp2_gpu14 [style=dashed]
	l2_residual_tp6 -> l2_exp2_gpu14
	l2_exp2_gpu14 -> l2_exp_agg_tp6
	l2_gate_tp6 -> l2_exp3_gpu14 [style=dashed]
	l2_residual_tp6 -> l2_exp3_gpu14
	l2_exp3_gpu14 -> l2_exp_agg_tp6
	l2_gate_tp6 -> l2_exp4_gpu14 [style=dashed]
	l2_residual_tp6 -> l2_exp4_gpu14
	l2_exp4_gpu14 -> l2_exp_agg_tp6
	l2_gate_tp6 -> l2_exp5_gpu14 [style=dashed]
	l2_residual_tp6 -> l2_exp5_gpu14
	l2_exp5_gpu14 -> l2_exp_agg_tp6
	l2_gate_tp6 -> l2_exp6_gpu14 [style=dashed]
	l2_residual_tp6 -> l2_exp6_gpu14
	l2_exp6_gpu14 -> l2_exp_agg_tp6
	l2_gate_tp6 -> l2_exp7_gpu14 [style=dashed]
	l2_residual_tp6 -> l2_exp7_gpu14
	l2_exp7_gpu14 -> l2_exp_agg_tp6
	l2_exp_agg_tp6 -> l2_final_res_tp6
	l2_residual_tp6 -> l2_final_res_tp6
	l2_qkv_tp7 -> l2_attn_tp7
	l2_attn_tp7 -> l2_out_proj_tp7
	l2_out_proj_tp7 -> l2_residual_tp7
	l2_qkv_tp7 -> l2_residual_tp7
	l2_residual_tp7 -> l2_gate_tp7
	l2_gate_tp7 -> l2_exp0_gpu15 [style=dashed]
	l2_residual_tp7 -> l2_exp0_gpu15
	l2_exp0_gpu15 -> l2_exp_agg_tp7
	l2_gate_tp7 -> l2_exp1_gpu15 [style=dashed]
	l2_residual_tp7 -> l2_exp1_gpu15
	l2_exp1_gpu15 -> l2_exp_agg_tp7
	l2_gate_tp7 -> l2_exp2_gpu15 [style=dashed]
	l2_residual_tp7 -> l2_exp2_gpu15
	l2_exp2_gpu15 -> l2_exp_agg_tp7
	l2_gate_tp7 -> l2_exp3_gpu15 [style=dashed]
	l2_residual_tp7 -> l2_exp3_gpu15
	l2_exp3_gpu15 -> l2_exp_agg_tp7
	l2_gate_tp7 -> l2_exp4_gpu15 [style=dashed]
	l2_residual_tp7 -> l2_exp4_gpu15
	l2_exp4_gpu15 -> l2_exp_agg_tp7
	l2_gate_tp7 -> l2_exp5_gpu15 [style=dashed]
	l2_residual_tp7 -> l2_exp5_gpu15
	l2_exp5_gpu15 -> l2_exp_agg_tp7
	l2_gate_tp7 -> l2_exp6_gpu15 [style=dashed]
	l2_residual_tp7 -> l2_exp6_gpu15
	l2_exp6_gpu15 -> l2_exp_agg_tp7
	l2_gate_tp7 -> l2_exp7_gpu15 [style=dashed]
	l2_residual_tp7 -> l2_exp7_gpu15
	l2_exp7_gpu15 -> l2_exp_agg_tp7
	l2_exp_agg_tp7 -> l2_final_res_tp7
	l2_residual_tp7 -> l2_final_res_tp7
	l2_final_res_tp0 -> l3_qkv_tp0
	l3_qkv_tp0 -> l3_attn_tp0
	l3_attn_tp0 -> l3_out_proj_tp0
	l3_out_proj_tp0 -> l3_residual_tp0
	l2_final_res_tp0 -> l3_residual_tp0
	l3_residual_tp0 -> l3_gate_tp0
	l3_gate_tp0 -> l3_exp0_gpu8 [style=dashed]
	l3_residual_tp0 -> l3_exp0_gpu8
	l3_exp0_gpu8 -> l3_exp_agg_tp0
	l3_gate_tp0 -> l3_exp1_gpu8 [style=dashed]
	l3_residual_tp0 -> l3_exp1_gpu8
	l3_exp1_gpu8 -> l3_exp_agg_tp0
	l3_gate_tp0 -> l3_exp2_gpu8 [style=dashed]
	l3_residual_tp0 -> l3_exp2_gpu8
	l3_exp2_gpu8 -> l3_exp_agg_tp0
	l3_gate_tp0 -> l3_exp3_gpu8 [style=dashed]
	l3_residual_tp0 -> l3_exp3_gpu8
	l3_exp3_gpu8 -> l3_exp_agg_tp0
	l3_gate_tp0 -> l3_exp4_gpu8 [style=dashed]
	l3_residual_tp0 -> l3_exp4_gpu8
	l3_exp4_gpu8 -> l3_exp_agg_tp0
	l3_gate_tp0 -> l3_exp5_gpu8 [style=dashed]
	l3_residual_tp0 -> l3_exp5_gpu8
	l3_exp5_gpu8 -> l3_exp_agg_tp0
	l3_gate_tp0 -> l3_exp6_gpu8 [style=dashed]
	l3_residual_tp0 -> l3_exp6_gpu8
	l3_exp6_gpu8 -> l3_exp_agg_tp0
	l3_gate_tp0 -> l3_exp7_gpu8 [style=dashed]
	l3_residual_tp0 -> l3_exp7_gpu8
	l3_exp7_gpu8 -> l3_exp_agg_tp0
	l3_exp_agg_tp0 -> l3_final_res_tp0
	l3_residual_tp0 -> l3_final_res_tp0
	l3_final_res_tp0 -> output
	l2_final_res_tp1 -> l3_qkv_tp1
	l3_qkv_tp1 -> l3_attn_tp1
	l3_attn_tp1 -> l3_out_proj_tp1
	l3_out_proj_tp1 -> l3_residual_tp1
	l2_final_res_tp1 -> l3_residual_tp1
	l3_residual_tp1 -> l3_gate_tp1
	l3_gate_tp1 -> l3_exp0_gpu9 [style=dashed]
	l3_residual_tp1 -> l3_exp0_gpu9
	l3_exp0_gpu9 -> l3_exp_agg_tp1
	l3_gate_tp1 -> l3_exp1_gpu9 [style=dashed]
	l3_residual_tp1 -> l3_exp1_gpu9
	l3_exp1_gpu9 -> l3_exp_agg_tp1
	l3_gate_tp1 -> l3_exp2_gpu9 [style=dashed]
	l3_residual_tp1 -> l3_exp2_gpu9
	l3_exp2_gpu9 -> l3_exp_agg_tp1
	l3_gate_tp1 -> l3_exp3_gpu9 [style=dashed]
	l3_residual_tp1 -> l3_exp3_gpu9
	l3_exp3_gpu9 -> l3_exp_agg_tp1
	l3_gate_tp1 -> l3_exp4_gpu9 [style=dashed]
	l3_residual_tp1 -> l3_exp4_gpu9
	l3_exp4_gpu9 -> l3_exp_agg_tp1
	l3_gate_tp1 -> l3_exp5_gpu9 [style=dashed]
	l3_residual_tp1 -> l3_exp5_gpu9
	l3_exp5_gpu9 -> l3_exp_agg_tp1
	l3_gate_tp1 -> l3_exp6_gpu9 [style=dashed]
	l3_residual_tp1 -> l3_exp6_gpu9
	l3_exp6_gpu9 -> l3_exp_agg_tp1
	l3_gate_tp1 -> l3_exp7_gpu9 [style=dashed]
	l3_residual_tp1 -> l3_exp7_gpu9
	l3_exp7_gpu9 -> l3_exp_agg_tp1
	l3_exp_agg_tp1 -> l3_final_res_tp1
	l3_residual_tp1 -> l3_final_res_tp1
	l3_final_res_tp1 -> output
	l2_final_res_tp2 -> l3_qkv_tp2
	l3_qkv_tp2 -> l3_attn_tp2
	l3_attn_tp2 -> l3_out_proj_tp2
	l3_out_proj_tp2 -> l3_residual_tp2
	l2_final_res_tp2 -> l3_residual_tp2
	l3_residual_tp2 -> l3_gate_tp2
	l3_gate_tp2 -> l3_exp0_gpu10 [style=dashed]
	l3_residual_tp2 -> l3_exp0_gpu10
	l3_exp0_gpu10 -> l3_exp_agg_tp2
	l3_gate_tp2 -> l3_exp1_gpu10 [style=dashed]
	l3_residual_tp2 -> l3_exp1_gpu10
	l3_exp1_gpu10 -> l3_exp_agg_tp2
	l3_gate_tp2 -> l3_exp2_gpu10 [style=dashed]
	l3_residual_tp2 -> l3_exp2_gpu10
	l3_exp2_gpu10 -> l3_exp_agg_tp2
	l3_gate_tp2 -> l3_exp3_gpu10 [style=dashed]
	l3_residual_tp2 -> l3_exp3_gpu10
	l3_exp3_gpu10 -> l3_exp_agg_tp2
	l3_gate_tp2 -> l3_exp4_gpu10 [style=dashed]
	l3_residual_tp2 -> l3_exp4_gpu10
	l3_exp4_gpu10 -> l3_exp_agg_tp2
	l3_gate_tp2 -> l3_exp5_gpu10 [style=dashed]
	l3_residual_tp2 -> l3_exp5_gpu10
	l3_exp5_gpu10 -> l3_exp_agg_tp2
	l3_gate_tp2 -> l3_exp6_gpu10 [style=dashed]
	l3_residual_tp2 -> l3_exp6_gpu10
	l3_exp6_gpu10 -> l3_exp_agg_tp2
	l3_gate_tp2 -> l3_exp7_gpu10 [style=dashed]
	l3_residual_tp2 -> l3_exp7_gpu10
	l3_exp7_gpu10 -> l3_exp_agg_tp2
	l3_exp_agg_tp2 -> l3_final_res_tp2
	l3_residual_tp2 -> l3_final_res_tp2
	l3_final_res_tp2 -> output
	l2_final_res_tp3 -> l3_qkv_tp3
	l3_qkv_tp3 -> l3_attn_tp3
	l3_attn_tp3 -> l3_out_proj_tp3
	l3_out_proj_tp3 -> l3_residual_tp3
	l2_final_res_tp3 -> l3_residual_tp3
	l3_residual_tp3 -> l3_gate_tp3
	l3_gate_tp3 -> l3_exp0_gpu11 [style=dashed]
	l3_residual_tp3 -> l3_exp0_gpu11
	l3_exp0_gpu11 -> l3_exp_agg_tp3
	l3_gate_tp3 -> l3_exp1_gpu11 [style=dashed]
	l3_residual_tp3 -> l3_exp1_gpu11
	l3_exp1_gpu11 -> l3_exp_agg_tp3
	l3_gate_tp3 -> l3_exp2_gpu11 [style=dashed]
	l3_residual_tp3 -> l3_exp2_gpu11
	l3_exp2_gpu11 -> l3_exp_agg_tp3
	l3_gate_tp3 -> l3_exp3_gpu11 [style=dashed]
	l3_residual_tp3 -> l3_exp3_gpu11
	l3_exp3_gpu11 -> l3_exp_agg_tp3
	l3_gate_tp3 -> l3_exp4_gpu11 [style=dashed]
	l3_residual_tp3 -> l3_exp4_gpu11
	l3_exp4_gpu11 -> l3_exp_agg_tp3
	l3_gate_tp3 -> l3_exp5_gpu11 [style=dashed]
	l3_residual_tp3 -> l3_exp5_gpu11
	l3_exp5_gpu11 -> l3_exp_agg_tp3
	l3_gate_tp3 -> l3_exp6_gpu11 [style=dashed]
	l3_residual_tp3 -> l3_exp6_gpu11
	l3_exp6_gpu11 -> l3_exp_agg_tp3
	l3_gate_tp3 -> l3_exp7_gpu11 [style=dashed]
	l3_residual_tp3 -> l3_exp7_gpu11
	l3_exp7_gpu11 -> l3_exp_agg_tp3
	l3_exp_agg_tp3 -> l3_final_res_tp3
	l3_residual_tp3 -> l3_final_res_tp3
	l3_final_res_tp3 -> output
	l2_final_res_tp4 -> l3_qkv_tp4
	l3_qkv_tp4 -> l3_attn_tp4
	l3_attn_tp4 -> l3_out_proj_tp4
	l3_out_proj_tp4 -> l3_residual_tp4
	l2_final_res_tp4 -> l3_residual_tp4
	l3_residual_tp4 -> l3_gate_tp4
	l3_gate_tp4 -> l3_exp0_gpu12 [style=dashed]
	l3_residual_tp4 -> l3_exp0_gpu12
	l3_exp0_gpu12 -> l3_exp_agg_tp4
	l3_gate_tp4 -> l3_exp1_gpu12 [style=dashed]
	l3_residual_tp4 -> l3_exp1_gpu12
	l3_exp1_gpu12 -> l3_exp_agg_tp4
	l3_gate_tp4 -> l3_exp2_gpu12 [style=dashed]
	l3_residual_tp4 -> l3_exp2_gpu12
	l3_exp2_gpu12 -> l3_exp_agg_tp4
	l3_gate_tp4 -> l3_exp3_gpu12 [style=dashed]
	l3_residual_tp4 -> l3_exp3_gpu12
	l3_exp3_gpu12 -> l3_exp_agg_tp4
	l3_gate_tp4 -> l3_exp4_gpu12 [style=dashed]
	l3_residual_tp4 -> l3_exp4_gpu12
	l3_exp4_gpu12 -> l3_exp_agg_tp4
	l3_gate_tp4 -> l3_exp5_gpu12 [style=dashed]
	l3_residual_tp4 -> l3_exp5_gpu12
	l3_exp5_gpu12 -> l3_exp_agg_tp4
	l3_gate_tp4 -> l3_exp6_gpu12 [style=dashed]
	l3_residual_tp4 -> l3_exp6_gpu12
	l3_exp6_gpu12 -> l3_exp_agg_tp4
	l3_gate_tp4 -> l3_exp7_gpu12 [style=dashed]
	l3_residual_tp4 -> l3_exp7_gpu12
	l3_exp7_gpu12 -> l3_exp_agg_tp4
	l3_exp_agg_tp4 -> l3_final_res_tp4
	l3_residual_tp4 -> l3_final_res_tp4
	l3_final_res_tp4 -> output
	l2_final_res_tp5 -> l3_qkv_tp5
	l3_qkv_tp5 -> l3_attn_tp5
	l3_attn_tp5 -> l3_out_proj_tp5
	l3_out_proj_tp5 -> l3_residual_tp5
	l2_final_res_tp5 -> l3_residual_tp5
	l3_residual_tp5 -> l3_gate_tp5
	l3_gate_tp5 -> l3_exp0_gpu13 [style=dashed]
	l3_residual_tp5 -> l3_exp0_gpu13
	l3_exp0_gpu13 -> l3_exp_agg_tp5
	l3_gate_tp5 -> l3_exp1_gpu13 [style=dashed]
	l3_residual_tp5 -> l3_exp1_gpu13
	l3_exp1_gpu13 -> l3_exp_agg_tp5
	l3_gate_tp5 -> l3_exp2_gpu13 [style=dashed]
	l3_residual_tp5 -> l3_exp2_gpu13
	l3_exp2_gpu13 -> l3_exp_agg_tp5
	l3_gate_tp5 -> l3_exp3_gpu13 [style=dashed]
	l3_residual_tp5 -> l3_exp3_gpu13
	l3_exp3_gpu13 -> l3_exp_agg_tp5
	l3_gate_tp5 -> l3_exp4_gpu13 [style=dashed]
	l3_residual_tp5 -> l3_exp4_gpu13
	l3_exp4_gpu13 -> l3_exp_agg_tp5
	l3_gate_tp5 -> l3_exp5_gpu13 [style=dashed]
	l3_residual_tp5 -> l3_exp5_gpu13
	l3_exp5_gpu13 -> l3_exp_agg_tp5
	l3_gate_tp5 -> l3_exp6_gpu13 [style=dashed]
	l3_residual_tp5 -> l3_exp6_gpu13
	l3_exp6_gpu13 -> l3_exp_agg_tp5
	l3_gate_tp5 -> l3_exp7_gpu13 [style=dashed]
	l3_residual_tp5 -> l3_exp7_gpu13
	l3_exp7_gpu13 -> l3_exp_agg_tp5
	l3_exp_agg_tp5 -> l3_final_res_tp5
	l3_residual_tp5 -> l3_final_res_tp5
	l3_final_res_tp5 -> output
	l2_final_res_tp6 -> l3_qkv_tp6
	l3_qkv_tp6 -> l3_attn_tp6
	l3_attn_tp6 -> l3_out_proj_tp6
	l3_out_proj_tp6 -> l3_residual_tp6
	l2_final_res_tp6 -> l3_residual_tp6
	l3_residual_tp6 -> l3_gate_tp6
	l3_gate_tp6 -> l3_exp0_gpu14 [style=dashed]
	l3_residual_tp6 -> l3_exp0_gpu14
	l3_exp0_gpu14 -> l3_exp_agg_tp6
	l3_gate_tp6 -> l3_exp1_gpu14 [style=dashed]
	l3_residual_tp6 -> l3_exp1_gpu14
	l3_exp1_gpu14 -> l3_exp_agg_tp6
	l3_gate_tp6 -> l3_exp2_gpu14 [style=dashed]
	l3_residual_tp6 -> l3_exp2_gpu14
	l3_exp2_gpu14 -> l3_exp_agg_tp6
	l3_gate_tp6 -> l3_exp3_gpu14 [style=dashed]
	l3_residual_tp6 -> l3_exp3_gpu14
	l3_exp3_gpu14 -> l3_exp_agg_tp6
	l3_gate_tp6 -> l3_exp4_gpu14 [style=dashed]
	l3_residual_tp6 -> l3_exp4_gpu14
	l3_exp4_gpu14 -> l3_exp_agg_tp6
	l3_gate_tp6 -> l3_exp5_gpu14 [style=dashed]
	l3_residual_tp6 -> l3_exp5_gpu14
	l3_exp5_gpu14 -> l3_exp_agg_tp6
	l3_gate_tp6 -> l3_exp6_gpu14 [style=dashed]
	l3_residual_tp6 -> l3_exp6_gpu14
	l3_exp6_gpu14 -> l3_exp_agg_tp6
	l3_gate_tp6 -> l3_exp7_gpu14 [style=dashed]
	l3_residual_tp6 -> l3_exp7_gpu14
	l3_exp7_gpu14 -> l3_exp_agg_tp6
	l3_exp_agg_tp6 -> l3_final_res_tp6
	l3_residual_tp6 -> l3_final_res_tp6
	l3_final_res_tp6 -> output
	l2_final_res_tp7 -> l3_qkv_tp7
	l3_qkv_tp7 -> l3_attn_tp7
	l3_attn_tp7 -> l3_out_proj_tp7
	l3_out_proj_tp7 -> l3_residual_tp7
	l2_final_res_tp7 -> l3_residual_tp7
	l3_residual_tp7 -> l3_gate_tp7
	l3_gate_tp7 -> l3_exp0_gpu15 [style=dashed]
	l3_residual_tp7 -> l3_exp0_gpu15
	l3_exp0_gpu15 -> l3_exp_agg_tp7
	l3_gate_tp7 -> l3_exp1_gpu15 [style=dashed]
	l3_residual_tp7 -> l3_exp1_gpu15
	l3_exp1_gpu15 -> l3_exp_agg_tp7
	l3_gate_tp7 -> l3_exp2_gpu15 [style=dashed]
	l3_residual_tp7 -> l3_exp2_gpu15
	l3_exp2_gpu15 -> l3_exp_agg_tp7
	l3_gate_tp7 -> l3_exp3_gpu15 [style=dashed]
	l3_residual_tp7 -> l3_exp3_gpu15
	l3_exp3_gpu15 -> l3_exp_agg_tp7
	l3_gate_tp7 -> l3_exp4_gpu15 [style=dashed]
	l3_residual_tp7 -> l3_exp4_gpu15
	l3_exp4_gpu15 -> l3_exp_agg_tp7
	l3_gate_tp7 -> l3_exp5_gpu15 [style=dashed]
	l3_residual_tp7 -> l3_exp5_gpu15
	l3_exp5_gpu15 -> l3_exp_agg_tp7
	l3_gate_tp7 -> l3_exp6_gpu15 [style=dashed]
	l3_residual_tp7 -> l3_exp6_gpu15
	l3_exp6_gpu15 -> l3_exp_agg_tp7
	l3_gate_tp7 -> l3_exp7_gpu15 [style=dashed]
	l3_residual_tp7 -> l3_exp7_gpu15
	l3_exp7_gpu15 -> l3_exp_agg_tp7
	l3_exp_agg_tp7 -> l3_final_res_tp7
	l3_residual_tp7 -> l3_final_res_tp7
	l3_final_res_tp7 -> output
}
