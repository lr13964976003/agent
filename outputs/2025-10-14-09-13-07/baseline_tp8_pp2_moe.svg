<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_tp8_pp2_moe Pages: 1 -->
<svg width="1440pt" height="540pt"
 viewBox="0.00 0.00 1440.00 539.66" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.11 0.11) rotate(0) translate(4 4761.12)">
<title>baseline_tp8_pp2_moe</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-4761.12 12711,-4761.12 12711,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-2414.17 8,-4655.17 12454,-4655.17 12454,-2414.17 8,-2414.17"/>
<text text-anchor="middle" x="6231" y="-4639.97" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (Layers 0&#45;1)</text>
<text text-anchor="middle" x="6231" y="-4624.97" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="253,-125.17 253,-2366.17 12699,-2366.17 12699,-125.17 253,-125.17"/>
<text text-anchor="middle" x="6476" y="-2350.97" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (Layers 2&#45;3)</text>
<text text-anchor="middle" x="6476" y="-2335.97" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="6706" cy="-4719.64" rx="298.3" ry="37.45"/>
<text text-anchor="middle" x="6706" y="-4730.94" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="6706" y="-4715.94" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6706" y="-4700.94" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- l0_qkv_tp0 -->
<g id="node2" class="node">
<title>l0_qkv_tp0</title>
<polygon fill="lightgreen" stroke="black" points="4354,-4609.17 4128,-4609.17 4128,-4541.17 4354,-4541.17 4354,-4609.17"/>
<text text-anchor="middle" x="4241" y="-4593.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4241" y="-4578.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="4241" y="-4563.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="4241" y="-4548.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;l0_qkv_tp0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;l0_qkv_tp0</title>
<path fill="none" stroke="black" d="M6409.5,-4714.95C5927.84,-4708 4996.21,-4690.43 4668,-4655.17 4564.71,-4644.07 4448.9,-4622.03 4363.98,-4604.04"/>
<polygon fill="black" stroke="black" points="4364.55,-4600.59 4354.04,-4601.93 4363.09,-4607.43 4364.55,-4600.59"/>
</g>
<!-- l0_residual_tp0 -->
<g id="node5" class="node">
<title>l0_residual_tp0</title>
<polygon fill="lightyellow" stroke="black" points="1451.93,-4294.17 880.95,-4294.17 734.07,-4158.17 1305.05,-4158.17 1451.93,-4294.17"/>
<text text-anchor="middle" x="1093" y="-4244.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1093" y="-4229.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="1093" y="-4214.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="1093" y="-4199.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;l0_residual_tp0 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;l0_residual_tp0</title>
<path fill="none" stroke="black" d="M6720.54,-4682.08C6730.53,-4653.67 6742,-4613.03 6742,-4576.17 6742,-4576.17 6742,-4576.17 6742,-4364.17 6742,-4347.02 6736.91,-4339.65 6722,-4331.17 6668.55,-4300.77 2356.46,-4296.14 2295,-4294.17 1995.6,-4284.58 1654.68,-4264.72 1412.58,-4249.11"/>
<polygon fill="black" stroke="black" points="1412.77,-4245.61 1402.57,-4248.46 1412.32,-4252.6 1412.77,-4245.61"/>
</g>
<!-- l0_qkv_tp1 -->
<g id="node6" class="node">
<title>l0_qkv_tp1</title>
<polygon fill="lightgreen" stroke="black" points="4903,-4609.17 4677,-4609.17 4677,-4541.17 4903,-4541.17 4903,-4609.17"/>
<text text-anchor="middle" x="4790" y="-4593.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4790" y="-4578.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="4790" y="-4563.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="4790" y="-4548.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- input&#45;&gt;l0_qkv_tp1 -->
<g id="edge33" class="edge">
<title>input&#45;&gt;l0_qkv_tp1</title>
<path fill="none" stroke="black" d="M6408.28,-4717.03C6111.86,-4712.76 5644.3,-4698.86 5242,-4655.17 5129.98,-4643 5003.76,-4620.16 4913.23,-4602.16"/>
<polygon fill="black" stroke="black" points="4913.69,-4598.68 4903.2,-4600.15 4912.32,-4605.54 4913.69,-4598.68"/>
</g>
<!-- l0_residual_tp1 -->
<g id="node9" class="node">
<title>l0_residual_tp1</title>
<polygon fill="lightyellow" stroke="black" points="3021.93,-4294.17 2450.95,-4294.17 2304.07,-4158.17 2875.05,-4158.17 3021.93,-4294.17"/>
<text text-anchor="middle" x="2663" y="-4244.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2663" y="-4229.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="2663" y="-4214.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="2663" y="-4199.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- input&#45;&gt;l0_residual_tp1 -->
<g id="edge37" class="edge">
<title>input&#45;&gt;l0_residual_tp1</title>
<path fill="none" stroke="black" d="M6743.51,-4682.37C6748.18,-4676.61 6752.53,-4670.46 6756,-4664.17 6775.59,-4628.68 6780,-4616.71 6780,-4576.17 6780,-4576.17 6780,-4576.17 6780,-4364.17 6780,-4338.71 6777.4,-4325.95 6756,-4312.17 6721.91,-4290.2 3876.54,-4295.45 3836,-4294.17 3547.46,-4285.04 3219.43,-4265.53 2983.78,-4249.9"/>
<polygon fill="black" stroke="black" points="2983.89,-4246.4 2973.68,-4249.23 2983.43,-4253.39 2983.89,-4246.4"/>
</g>
<!-- l0_qkv_tp2 -->
<g id="node10" class="node">
<title>l0_qkv_tp2</title>
<polygon fill="lightgreen" stroke="black" points="5477,-4609.17 5251,-4609.17 5251,-4541.17 5477,-4541.17 5477,-4609.17"/>
<text text-anchor="middle" x="5364" y="-4593.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5364" y="-4578.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="5364" y="-4563.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="5364" y="-4548.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- input&#45;&gt;l0_qkv_tp2 -->
<g id="edge65" class="edge">
<title>input&#45;&gt;l0_qkv_tp2</title>
<path fill="none" stroke="black" d="M6438.38,-4702.99C6234.62,-4691.31 5947.18,-4675.34 5695,-4663.17 5652.35,-4661.11 5544.05,-4666.94 5503,-4655.17 5473.05,-4646.58 5442.63,-4630.33 5417.92,-4614.79"/>
<polygon fill="black" stroke="black" points="5419.74,-4611.8 5409.43,-4609.34 5415.95,-4617.69 5419.74,-4611.8"/>
</g>
<!-- l0_residual_tp2 -->
<g id="node13" class="node">
<title>l0_residual_tp2</title>
<polygon fill="lightyellow" stroke="black" points="4562.93,-4294.17 3991.95,-4294.17 3845.07,-4158.17 4416.05,-4158.17 4562.93,-4294.17"/>
<text text-anchor="middle" x="4204" y="-4244.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4204" y="-4229.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="4204" y="-4214.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="4204" y="-4199.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- input&#45;&gt;l0_residual_tp2 -->
<g id="edge69" class="edge">
<title>input&#45;&gt;l0_residual_tp2</title>
<path fill="none" stroke="black" d="M6775.66,-4682.88C6782.52,-4677.31 6788.84,-4671.08 6794,-4664.17 6818.25,-4631.68 6818,-4616.71 6818,-4576.17 6818,-4576.17 6818,-4576.17 6818,-4364.17 6818,-4338.71 6815.36,-4326.01 6794,-4312.17 6759.25,-4289.63 5344.39,-4295.68 5303,-4294.17 5041.14,-4284.61 4744.6,-4266.08 4525.61,-4250.92"/>
<polygon fill="black" stroke="black" points="4525.78,-4247.42 4515.56,-4250.22 4525.3,-4254.41 4525.78,-4247.42"/>
</g>
<!-- l0_qkv_tp3 -->
<g id="node14" class="node">
<title>l0_qkv_tp3</title>
<polygon fill="lightgreen" stroke="black" points="5738,-4609.17 5512,-4609.17 5512,-4541.17 5738,-4541.17 5738,-4609.17"/>
<text text-anchor="middle" x="5625" y="-4593.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5625" y="-4578.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="5625" y="-4563.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="5625" y="-4548.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- input&#45;&gt;l0_qkv_tp3 -->
<g id="edge97" class="edge">
<title>input&#45;&gt;l0_qkv_tp3</title>
<path fill="none" stroke="black" d="M6439.85,-4702.64C6161.78,-4685.69 5763.43,-4660.62 5747,-4655.17 5720.57,-4646.4 5694.26,-4630.51 5672.87,-4615.27"/>
<polygon fill="black" stroke="black" points="5674.77,-4612.32 5664.63,-4609.25 5670.64,-4617.97 5674.77,-4612.32"/>
</g>
<!-- l0_residual_tp3 -->
<g id="node17" class="node">
<title>l0_residual_tp3</title>
<polygon fill="lightyellow" stroke="black" points="6029.93,-4294.17 5458.95,-4294.17 5312.07,-4158.17 5883.05,-4158.17 6029.93,-4294.17"/>
<text text-anchor="middle" x="5671" y="-4244.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5671" y="-4229.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="5671" y="-4214.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5671" y="-4199.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- input&#45;&gt;l0_residual_tp3 -->
<g id="edge101" class="edge">
<title>input&#45;&gt;l0_residual_tp3</title>
<path fill="none" stroke="black" d="M6808.58,-4684.34C6817.27,-4678.59 6825.29,-4671.91 6832,-4664.17 6858.56,-4633.54 6856,-4616.71 6856,-4576.17 6856,-4576.17 6856,-4576.17 6856,-4364.17 6856,-4338.71 6853.04,-4326.5 6832,-4312.17 6803.4,-4292.68 6555.53,-4296.53 6521,-4294.17 6347.77,-4282.33 6154.83,-4267.27 5996.62,-4254.43"/>
<polygon fill="black" stroke="black" points="5996.5,-4250.91 5986.24,-4253.59 5995.93,-4257.89 5996.5,-4250.91"/>
</g>
<!-- l0_qkv_tp4 -->
<g id="node18" class="node">
<title>l0_qkv_tp4</title>
<polygon fill="lightgreen" stroke="black" points="5982,-4609.17 5756,-4609.17 5756,-4541.17 5982,-4541.17 5982,-4609.17"/>
<text text-anchor="middle" x="5869" y="-4593.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5869" y="-4578.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="5869" y="-4563.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="5869" y="-4548.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- input&#45;&gt;l0_qkv_tp4 -->
<g id="edge129" class="edge">
<title>input&#45;&gt;l0_qkv_tp4</title>
<path fill="none" stroke="black" d="M6423.7,-4707.45C6259.28,-4698.23 6069.36,-4682.15 5991,-4655.17 5964.78,-4646.14 5938.58,-4630.3 5917.23,-4615.16"/>
<polygon fill="black" stroke="black" points="5919.14,-4612.23 5908.99,-4609.19 5915.03,-4617.89 5919.14,-4612.23"/>
</g>
<!-- l0_residual_tp4 -->
<g id="node21" class="node">
<title>l0_residual_tp4</title>
<polygon fill="lightyellow" stroke="black" points="7247.93,-4294.17 6676.95,-4294.17 6530.07,-4158.17 7101.05,-4158.17 7247.93,-4294.17"/>
<text text-anchor="middle" x="6889" y="-4244.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6889" y="-4229.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="6889" y="-4214.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="6889" y="-4199.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- input&#45;&gt;l0_residual_tp4 -->
<g id="edge133" class="edge">
<title>input&#45;&gt;l0_residual_tp4</title>
<path fill="none" stroke="black" d="M6842.01,-4686.12C6852.31,-4680.02 6861.85,-4672.77 6870,-4664.17 6897.87,-4634.73 6894,-4616.71 6894,-4576.17 6894,-4576.17 6894,-4576.17 6894,-4364.17 6894,-4344.81 6893.5,-4323.93 6892.81,-4304.44"/>
<polygon fill="black" stroke="black" points="6896.3,-4304.25 6892.43,-4294.39 6889.31,-4304.52 6896.3,-4304.25"/>
</g>
<!-- l0_qkv_tp5 -->
<g id="node22" class="node">
<title>l0_qkv_tp5</title>
<polygon fill="lightgreen" stroke="black" points="6226,-4609.17 6000,-4609.17 6000,-4541.17 6226,-4541.17 6226,-4609.17"/>
<text text-anchor="middle" x="6113" y="-4593.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6113" y="-4578.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="6113" y="-4563.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="6113" y="-4548.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- input&#45;&gt;l0_qkv_tp5 -->
<g id="edge161" class="edge">
<title>input&#45;&gt;l0_qkv_tp5</title>
<path fill="none" stroke="black" d="M6489.4,-4693.81C6377.74,-4680.23 6259.79,-4664.34 6235,-4655.17 6209.3,-4645.66 6183.45,-4630.01 6162.21,-4615.13"/>
<polygon fill="black" stroke="black" points="6164.17,-4612.23 6154,-4609.26 6160.1,-4617.92 6164.17,-4612.23"/>
</g>
<!-- l0_residual_tp5 -->
<g id="node25" class="node">
<title>l0_residual_tp5</title>
<polygon fill="lightyellow" stroke="black" points="8704.93,-4294.17 8133.95,-4294.17 7987.07,-4158.17 8558.05,-4158.17 8704.93,-4294.17"/>
<text text-anchor="middle" x="8346" y="-4244.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8346" y="-4229.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="8346" y="-4214.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="8346" y="-4199.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- input&#45;&gt;l0_residual_tp5 -->
<g id="edge165" class="edge">
<title>input&#45;&gt;l0_residual_tp5</title>
<path fill="none" stroke="black" d="M6980.14,-4704.73C7268.83,-4686.3 7682,-4647.47 7682,-4576.17 7682,-4576.17 7682,-4576.17 7682,-4364.17 7682,-4282 7879.48,-4248.71 8059.05,-4235.42"/>
<polygon fill="black" stroke="black" points="8059.49,-4238.9 8069.21,-4234.69 8058.99,-4231.92 8059.49,-4238.9"/>
</g>
<!-- l0_qkv_tp6 -->
<g id="node26" class="node">
<title>l0_qkv_tp6</title>
<polygon fill="lightgreen" stroke="black" points="6470,-4609.17 6244,-4609.17 6244,-4541.17 6470,-4541.17 6470,-4609.17"/>
<text text-anchor="middle" x="6357" y="-4593.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6357" y="-4578.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="6357" y="-4563.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="6357" y="-4548.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- input&#45;&gt;l0_qkv_tp6 -->
<g id="edge193" class="edge">
<title>input&#45;&gt;l0_qkv_tp6</title>
<path fill="none" stroke="black" d="M6565.59,-4686.53C6536.39,-4677.89 6506.23,-4667.45 6479,-4655.17 6454.94,-4644.32 6430.18,-4629.15 6409.3,-4615"/>
<polygon fill="black" stroke="black" points="6411.13,-4612 6400.9,-4609.22 6407.16,-4617.77 6411.13,-4612"/>
</g>
<!-- l0_residual_tp6 -->
<g id="node29" class="node">
<title>l0_residual_tp6</title>
<polygon fill="lightyellow" stroke="black" points="10295.93,-4294.17 9724.95,-4294.17 9578.07,-4158.17 10149.05,-4158.17 10295.93,-4294.17"/>
<text text-anchor="middle" x="9937" y="-4244.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9937" y="-4229.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="9937" y="-4214.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="9937" y="-4199.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- input&#45;&gt;l0_residual_tp6 -->
<g id="edge197" class="edge">
<title>input&#45;&gt;l0_residual_tp6</title>
<path fill="none" stroke="black" d="M7003.76,-4716.96C7669.61,-4711.23 9221,-4686.08 9221,-4576.17 9221,-4576.17 9221,-4576.17 9221,-4364.17 9221,-4316.73 9466.56,-4277.87 9670.06,-4253.81"/>
<polygon fill="black" stroke="black" points="9670.5,-4257.28 9680.02,-4252.64 9669.68,-4250.33 9670.5,-4257.28"/>
</g>
<!-- l0_qkv_tp7 -->
<g id="node30" class="node">
<title>l0_qkv_tp7</title>
<polygon fill="lightgreen" stroke="black" points="6714,-4609.17 6488,-4609.17 6488,-4541.17 6714,-4541.17 6714,-4609.17"/>
<text text-anchor="middle" x="6601" y="-4593.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6601" y="-4578.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="6601" y="-4563.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="6601" y="-4548.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- input&#45;&gt;l0_qkv_tp7 -->
<g id="edge225" class="edge">
<title>input&#45;&gt;l0_qkv_tp7</title>
<path fill="none" stroke="black" d="M6678.96,-4681.95C6664.43,-4662.24 6646.48,-4637.87 6631.46,-4617.5"/>
<polygon fill="black" stroke="black" points="6634.19,-4615.3 6625.44,-4609.32 6628.55,-4619.45 6634.19,-4615.3"/>
</g>
<!-- l0_residual_tp7 -->
<g id="node33" class="node">
<title>l0_residual_tp7</title>
<polygon fill="lightyellow" stroke="black" points="11816.93,-4294.17 11245.95,-4294.17 11099.07,-4158.17 11670.05,-4158.17 11816.93,-4294.17"/>
<text text-anchor="middle" x="11458" y="-4244.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11458" y="-4229.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="11458" y="-4214.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="11458" y="-4199.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- input&#45;&gt;l0_residual_tp7 -->
<g id="edge229" class="edge">
<title>input&#45;&gt;l0_residual_tp7</title>
<path fill="none" stroke="black" d="M7003.34,-4716.12C7949.57,-4707.14 10829,-4671.93 10829,-4576.17 10829,-4576.17 10829,-4576.17 10829,-4364.17 10829,-4287.8 11008.23,-4253.93 11175.34,-4238.94"/>
<polygon fill="black" stroke="black" points="11175.66,-4242.43 11185.31,-4238.07 11175.05,-4235.45 11175.66,-4242.43"/>
</g>
<!-- l0_attn_tp0 -->
<g id="node3" class="node">
<title>l0_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="3751,-4504.17 3537,-4504.17 3537,-4436.17 3751,-4436.17 3751,-4504.17"/>
<text text-anchor="middle" x="3644" y="-4488.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3644" y="-4473.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="3644" y="-4458.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="3644" y="-4443.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_qkv_tp0&#45;&gt;l0_attn_tp0 -->
<g id="edge2" class="edge">
<title>l0_qkv_tp0&#45;&gt;l0_attn_tp0</title>
<path fill="none" stroke="black" d="M4127.66,-4554.61C4022.82,-4536.52 3867.63,-4509.75 3761.49,-4491.44"/>
<polygon fill="black" stroke="black" points="3761.83,-4487.94 3751.38,-4489.69 3760.64,-4494.84 3761.83,-4487.94"/>
</g>
<!-- l0_out_proj_tp0 -->
<g id="node4" class="node">
<title>l0_out_proj_tp0</title>
<polygon fill="lightgreen" stroke="black" points="3039,-4399.17 2827,-4399.17 2827,-4331.17 3039,-4331.17 3039,-4399.17"/>
<text text-anchor="middle" x="2933" y="-4383.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2933" y="-4368.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="2933" y="-4353.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="2933" y="-4338.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_attn_tp0&#45;&gt;l0_out_proj_tp0 -->
<g id="edge3" class="edge">
<title>l0_attn_tp0&#45;&gt;l0_out_proj_tp0</title>
<path fill="none" stroke="black" d="M3536.79,-4453.63C3405.55,-4434.62 3184.16,-4402.55 3049.03,-4382.98"/>
<polygon fill="black" stroke="black" points="3049.45,-4379.5 3039.05,-4381.53 3048.45,-4386.43 3049.45,-4379.5"/>
</g>
<!-- l0_out_proj_tp0&#45;&gt;l0_residual_tp0 -->
<g id="edge4" class="edge">
<title>l0_out_proj_tp0&#45;&gt;l0_residual_tp0</title>
<path fill="none" stroke="black" d="M2826.79,-4356.26C2557.2,-4336.19 1837.86,-4282.63 1415.25,-4251.16"/>
<polygon fill="black" stroke="black" points="1415.25,-4247.65 1405.01,-4250.4 1414.73,-4254.63 1415.25,-4247.65"/>
</g>
<!-- l0_gate_tp0 -->
<g id="node34" class="node">
<title>l0_gate_tp0</title>
<polygon fill="lightyellow" stroke="black" points="1132.2,-4121.17 802.59,-4121.17 717.8,-3985.17 1047.41,-3985.17 1132.2,-4121.17"/>
<text text-anchor="middle" x="925" y="-4071.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="925" y="-4056.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="925" y="-4041.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="925" y="-4026.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_residual_tp0&#45;&gt;l0_gate_tp0 -->
<g id="edge6" class="edge">
<title>l0_residual_tp0&#45;&gt;l0_gate_tp0</title>
<path fill="none" stroke="black" d="M1027.08,-4158.07C1017.63,-4148.46 1007.86,-4138.51 998.28,-4128.76"/>
<polygon fill="black" stroke="black" points="1000.51,-4126.03 991,-4121.35 995.51,-4130.93 1000.51,-4126.03"/>
</g>
<!-- l0_exp0_gpu0 -->
<g id="node42" class="node">
<title>l0_exp0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="958,-3948.17 784,-3948.17 784,-3880.17 958,-3880.17 958,-3948.17"/>
<text text-anchor="middle" x="871" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="871" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="871" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="871" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_residual_tp0&#45;&gt;l0_exp0_gpu0 -->
<g id="edge8" class="edge">
<title>l0_residual_tp0&#45;&gt;l0_exp0_gpu0</title>
<path fill="none" stroke="black" d="M767.61,-4158.16C740.54,-4147.2 719.49,-4134.88 709,-4121.17 690.63,-4097.16 692.4,-4010.42 709,-3985.17 713.48,-3978.35 742.26,-3965.09 774.36,-3951.93"/>
<polygon fill="black" stroke="black" points="775.99,-3955.05 783.94,-3948.04 773.36,-3948.56 775.99,-3955.05"/>
</g>
<!-- l0_exp1_gpu0 -->
<g id="node43" class="node">
<title>l0_exp1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="766,-3948.17 592,-3948.17 592,-3880.17 766,-3880.17 766,-3948.17"/>
<text text-anchor="middle" x="679" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="679" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="679" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="679" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_residual_tp0&#45;&gt;l0_exp1_gpu0 -->
<g id="edge11" class="edge">
<title>l0_residual_tp0&#45;&gt;l0_exp1_gpu0</title>
<path fill="none" stroke="black" d="M742.98,-4158.01C718.49,-4147.27 699.92,-4135.03 691,-4121.17 659.62,-4072.39 663.13,-4002.93 669.95,-3958.44"/>
<polygon fill="black" stroke="black" points="673.41,-3958.96 671.59,-3948.52 666.51,-3957.82 673.41,-3958.96"/>
</g>
<!-- l0_exp2_gpu0 -->
<g id="node44" class="node">
<title>l0_exp2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="190,-3948.17 16,-3948.17 16,-3880.17 190,-3880.17 190,-3948.17"/>
<text text-anchor="middle" x="103" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="103" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="103" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="103" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_residual_tp0&#45;&gt;l0_exp2_gpu0 -->
<g id="edge14" class="edge">
<title>l0_residual_tp0&#45;&gt;l0_exp2_gpu0</title>
<path fill="none" stroke="black" d="M777.12,-4198.07C611.52,-4180.46 427.7,-4154.55 352,-4121.17 264.53,-4082.6 183.19,-4004.12 138.57,-3955.93"/>
<polygon fill="black" stroke="black" points="141.07,-3953.48 131.73,-3948.47 135.91,-3958.21 141.07,-3953.48"/>
</g>
<!-- l0_exp3_gpu0 -->
<g id="node45" class="node">
<title>l0_exp3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="382,-3948.17 208,-3948.17 208,-3880.17 382,-3880.17 382,-3948.17"/>
<text text-anchor="middle" x="295" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="295" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="295" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="295" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_residual_tp0&#45;&gt;l0_exp3_gpu0 -->
<g id="edge17" class="edge">
<title>l0_residual_tp0&#45;&gt;l0_exp3_gpu0</title>
<path fill="none" stroke="black" d="M776.03,-4197.13C693.13,-4181.71 605.81,-4157.9 530,-4121.17 447.21,-4081.05 371,-4003.7 328.97,-3956.04"/>
<polygon fill="black" stroke="black" points="331.48,-3953.6 322.27,-3948.37 326.21,-3958.21 331.48,-3953.6"/>
</g>
<!-- l0_exp4_gpu0 -->
<g id="node46" class="node">
<title>l0_exp4_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="574,-3948.17 400,-3948.17 400,-3880.17 574,-3880.17 574,-3948.17"/>
<text text-anchor="middle" x="487" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="487" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="487" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="487" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_residual_tp0&#45;&gt;l0_exp4_gpu0 -->
<g id="edge20" class="edge">
<title>l0_residual_tp0&#45;&gt;l0_exp4_gpu0</title>
<path fill="none" stroke="black" d="M745.25,-4168.55C715.26,-4155.78 686.63,-4140.19 661,-4121.17 598.67,-4074.9 544.09,-4002.15 513.36,-3956.63"/>
<polygon fill="black" stroke="black" points="516.19,-3954.55 507.72,-3948.18 510.36,-3958.44 516.19,-3954.55"/>
</g>
<!-- l0_exp5_gpu0 -->
<g id="node47" class="node">
<title>l0_exp5_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1342,-3948.17 1168,-3948.17 1168,-3880.17 1342,-3880.17 1342,-3948.17"/>
<text text-anchor="middle" x="1255" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="1255" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1255" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1255" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_residual_tp0&#45;&gt;l0_exp5_gpu0 -->
<g id="edge23" class="edge">
<title>l0_residual_tp0&#45;&gt;l0_exp5_gpu0</title>
<path fill="none" stroke="black" d="M1132.52,-4158.1C1139.48,-4145.89 1146.56,-4133.2 1153,-4121.17 1182.94,-4065.23 1215.03,-3999.33 1235.06,-3957.4"/>
<polygon fill="black" stroke="black" points="1238.24,-3958.85 1239.38,-3948.32 1231.92,-3955.84 1238.24,-3958.85"/>
</g>
<!-- l0_exp6_gpu0 -->
<g id="node48" class="node">
<title>l0_exp6_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1534,-3948.17 1360,-3948.17 1360,-3880.17 1534,-3880.17 1534,-3948.17"/>
<text text-anchor="middle" x="1447" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1447" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1447" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1447" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_residual_tp0&#45;&gt;l0_exp6_gpu0 -->
<g id="edge26" class="edge">
<title>l0_residual_tp0&#45;&gt;l0_exp6_gpu0</title>
<path fill="none" stroke="black" d="M1169.81,-4157.9C1240.46,-4096.04 1342.85,-4006.37 1401.38,-3955.12"/>
<polygon fill="black" stroke="black" points="1403.78,-3957.67 1408.99,-3948.45 1399.16,-3952.4 1403.78,-3957.67"/>
</g>
<!-- l0_exp7_gpu0 -->
<g id="node49" class="node">
<title>l0_exp7_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1150,-3948.17 976,-3948.17 976,-3880.17 1150,-3880.17 1150,-3948.17"/>
<text text-anchor="middle" x="1063" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="1063" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1063" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1063" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_residual_tp0&#45;&gt;l0_exp7_gpu0 -->
<g id="edge29" class="edge">
<title>l0_residual_tp0&#45;&gt;l0_exp7_gpu0</title>
<path fill="none" stroke="black" d="M1129.01,-4158.11C1133.97,-4146.11 1138.29,-4133.5 1141,-4121.17 1153.97,-4062.13 1165.63,-4040.37 1141,-3985.17 1136.08,-3974.13 1128.46,-3964.11 1119.88,-3955.32"/>
<polygon fill="black" stroke="black" points="1122.12,-3952.63 1112.48,-3948.23 1117.28,-3957.68 1122.12,-3952.63"/>
</g>
<!-- l0_final_res_tp0 -->
<g id="node51" class="node">
<title>l0_final_res_tp0</title>
<polygon fill="lightyellow" stroke="black" points="1233.93,-3670.17 662.95,-3670.17 516.07,-3534.17 1087.05,-3534.17 1233.93,-3670.17"/>
<text text-anchor="middle" x="875" y="-3620.97" font-family="Times,serif" font-size="14.00">Layer 0 Final Residual</text>
<text text-anchor="middle" x="875" y="-3605.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="875" y="-3590.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="875" y="-3575.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_residual_tp0&#45;&gt;l0_final_res_tp0 -->
<g id="edge32" class="edge">
<title>l0_residual_tp0&#45;&gt;l0_final_res_tp0</title>
<path fill="none" stroke="black" d="M1328.05,-4179.27C1441.34,-4150.19 1553,-4107.9 1553,-4054.17 1553,-4054.17 1553,-4054.17 1553,-3774.17 1553,-3693.93 1372.24,-3650.97 1197.38,-3628.17"/>
<polygon fill="black" stroke="black" points="1197.57,-3624.67 1187.21,-3626.87 1196.68,-3631.61 1197.57,-3624.67"/>
</g>
<!-- l0_attn_tp1 -->
<g id="node7" class="node">
<title>l0_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="4068,-4504.17 3854,-4504.17 3854,-4436.17 4068,-4436.17 4068,-4504.17"/>
<text text-anchor="middle" x="3961" y="-4488.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3961" y="-4473.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="3961" y="-4458.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="3961" y="-4443.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_qkv_tp1&#45;&gt;l0_attn_tp1 -->
<g id="edge34" class="edge">
<title>l0_qkv_tp1&#45;&gt;l0_attn_tp1</title>
<path fill="none" stroke="black" d="M4676.9,-4560.11C4519.96,-4540.61 4237.51,-4505.52 4078.34,-4485.75"/>
<polygon fill="black" stroke="black" points="4078.39,-4482.23 4068.04,-4484.47 4077.53,-4489.17 4078.39,-4482.23"/>
</g>
<!-- l0_out_proj_tp1 -->
<g id="node8" class="node">
<title>l0_out_proj_tp1</title>
<polygon fill="lightgreen" stroke="black" points="3410,-4399.17 3198,-4399.17 3198,-4331.17 3410,-4331.17 3410,-4399.17"/>
<text text-anchor="middle" x="3304" y="-4383.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3304" y="-4368.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="3304" y="-4353.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="3304" y="-4338.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_attn_tp1&#45;&gt;l0_out_proj_tp1 -->
<g id="edge35" class="edge">
<title>l0_attn_tp1&#45;&gt;l0_out_proj_tp1</title>
<path fill="none" stroke="black" d="M3853.85,-4451.36C3823.52,-4446.38 3790.47,-4441.01 3760,-4436.17 3644.37,-4417.8 3512.12,-4397.59 3419.93,-4383.62"/>
<polygon fill="black" stroke="black" points="3420.42,-4380.16 3410.01,-4382.12 3419.37,-4387.08 3420.42,-4380.16"/>
</g>
<!-- l0_out_proj_tp1&#45;&gt;l0_residual_tp1 -->
<g id="edge36" class="edge">
<title>l0_out_proj_tp1&#45;&gt;l0_residual_tp1</title>
<path fill="none" stroke="black" d="M3197.79,-4341.47C3139.19,-4328.94 3062.95,-4312.65 2986.48,-4296.3"/>
<polygon fill="black" stroke="black" points="2987.18,-4292.87 2976.67,-4294.21 2985.72,-4299.72 2987.18,-4292.87"/>
</g>
<!-- l0_gate_tp1 -->
<g id="node35" class="node">
<title>l0_gate_tp1</title>
<polygon fill="lightyellow" stroke="black" points="2634.2,-4121.17 2304.59,-4121.17 2219.8,-3985.17 2549.41,-3985.17 2634.2,-4121.17"/>
<text text-anchor="middle" x="2427" y="-4071.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="2427" y="-4056.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="2427" y="-4041.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="2427" y="-4026.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_residual_tp1&#45;&gt;l0_gate_tp1 -->
<g id="edge38" class="edge">
<title>l0_residual_tp1&#45;&gt;l0_gate_tp1</title>
<path fill="none" stroke="black" d="M2570.4,-4158.07C2556.48,-4147.98 2542.06,-4137.53 2527.97,-4127.33"/>
<polygon fill="black" stroke="black" points="2529.87,-4124.38 2519.72,-4121.35 2525.76,-4130.05 2529.87,-4124.38"/>
</g>
<!-- l0_exp0_gpu1 -->
<g id="node52" class="node">
<title>l0_exp0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2322,-3948.17 2148,-3948.17 2148,-3880.17 2322,-3880.17 2322,-3948.17"/>
<text text-anchor="middle" x="2235" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="2235" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2235" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2235" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_residual_tp1&#45;&gt;l0_exp0_gpu1 -->
<g id="edge40" class="edge">
<title>l0_residual_tp1&#45;&gt;l0_exp0_gpu1</title>
<path fill="none" stroke="black" d="M2322.53,-4175.39C2270.75,-4161.17 2228.65,-4143.33 2211,-4121.17 2174.15,-4074.88 2194.49,-4003.15 2213.79,-3957.7"/>
<polygon fill="black" stroke="black" points="2217.05,-3958.98 2217.87,-3948.42 2210.64,-3956.16 2217.05,-3958.98"/>
</g>
<!-- l0_exp1_gpu1 -->
<g id="node53" class="node">
<title>l0_exp1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2898,-3948.17 2724,-3948.17 2724,-3880.17 2898,-3880.17 2898,-3948.17"/>
<text text-anchor="middle" x="2811" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2811" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2811" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2811" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_residual_tp1&#45;&gt;l0_exp1_gpu1 -->
<g id="edge43" class="edge">
<title>l0_residual_tp1&#45;&gt;l0_exp1_gpu1</title>
<path fill="none" stroke="black" d="M2695.11,-4157.9C2724.17,-4097.05 2766.06,-4009.29 2790.71,-3957.66"/>
<polygon fill="black" stroke="black" points="2793.96,-3958.98 2795.11,-3948.45 2787.64,-3955.97 2793.96,-3958.98"/>
</g>
<!-- l0_exp2_gpu1 -->
<g id="node54" class="node">
<title>l0_exp2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2130,-3948.17 1956,-3948.17 1956,-3880.17 2130,-3880.17 2130,-3948.17"/>
<text text-anchor="middle" x="2043" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2043" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2043" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2043" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_residual_tp1&#45;&gt;l0_exp2_gpu1 -->
<g id="edge46" class="edge">
<title>l0_residual_tp1&#45;&gt;l0_exp2_gpu1</title>
<path fill="none" stroke="black" d="M2319.5,-4172.55C2260.42,-4158.3 2210.23,-4141.16 2186,-4121.17 2130.56,-4075.41 2087.14,-4002.97 2063.31,-3957.31"/>
<polygon fill="black" stroke="black" points="2066.35,-3955.57 2058.66,-3948.28 2060.12,-3958.77 2066.35,-3955.57"/>
</g>
<!-- l0_exp3_gpu1 -->
<g id="node55" class="node">
<title>l0_exp3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1938,-3948.17 1764,-3948.17 1764,-3880.17 1938,-3880.17 1938,-3948.17"/>
<text text-anchor="middle" x="1851" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1851" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1851" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1851" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_residual_tp1&#45;&gt;l0_exp3_gpu1 -->
<g id="edge49" class="edge">
<title>l0_residual_tp1&#45;&gt;l0_exp3_gpu1</title>
<path fill="none" stroke="black" d="M2353.67,-4204.18C2260.28,-4189.11 2159.82,-4163.72 2074,-4121.17 1994.1,-4081.55 1922.4,-4004.31 1882.96,-3956.48"/>
<polygon fill="black" stroke="black" points="1885.48,-3954.03 1876.45,-3948.49 1880.05,-3958.45 1885.48,-3954.03"/>
</g>
<!-- l0_exp4_gpu1 -->
<g id="node56" class="node">
<title>l0_exp4_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1746,-3948.17 1572,-3948.17 1572,-3880.17 1746,-3880.17 1746,-3948.17"/>
<text text-anchor="middle" x="1659" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1659" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1659" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1659" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_residual_tp1&#45;&gt;l0_exp4_gpu1 -->
<g id="edge52" class="edge">
<title>l0_residual_tp1&#45;&gt;l0_exp4_gpu1</title>
<path fill="none" stroke="black" d="M2348.89,-4199.91C2176.46,-4182.57 1982.01,-4156.32 1903,-4121.17 1816.69,-4082.77 1737.19,-4004.23 1693.66,-3955.99"/>
<polygon fill="black" stroke="black" points="1696.26,-3953.65 1686.99,-3948.52 1691.04,-3958.31 1696.26,-3953.65"/>
</g>
<!-- l0_exp5_gpu1 -->
<g id="node57" class="node">
<title>l0_exp5_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3090,-3948.17 2916,-3948.17 2916,-3880.17 3090,-3880.17 3090,-3948.17"/>
<text text-anchor="middle" x="3003" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3003" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3003" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3003" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_residual_tp1&#45;&gt;l0_exp5_gpu1 -->
<g id="edge55" class="edge">
<title>l0_residual_tp1&#45;&gt;l0_exp5_gpu1</title>
<path fill="none" stroke="black" d="M2736.77,-4157.9C2804.49,-4096.16 2902.57,-4006.74 2958.84,-3955.43"/>
<polygon fill="black" stroke="black" points="2961.46,-3957.77 2966.5,-3948.45 2956.75,-3952.6 2961.46,-3957.77"/>
</g>
<!-- l0_exp6_gpu1 -->
<g id="node58" class="node">
<title>l0_exp6_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2706,-3948.17 2532,-3948.17 2532,-3880.17 2706,-3880.17 2706,-3948.17"/>
<text text-anchor="middle" x="2619" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2619" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2619" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2619" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_residual_tp1&#45;&gt;l0_exp6_gpu1 -->
<g id="edge58" class="edge">
<title>l0_residual_tp1&#45;&gt;l0_exp6_gpu1</title>
<path fill="none" stroke="black" d="M2672.94,-4157.96C2678.22,-4104.46 2679.77,-4028.47 2658,-3966.17 2656.92,-3963.06 2655.56,-3960 2654.02,-3957"/>
<polygon fill="black" stroke="black" points="2656.97,-3955.11 2648.89,-3948.26 2650.93,-3958.65 2656.97,-3955.11"/>
</g>
<!-- l0_exp7_gpu1 -->
<g id="node59" class="node">
<title>l0_exp7_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2514,-3948.17 2340,-3948.17 2340,-3880.17 2514,-3880.17 2514,-3948.17"/>
<text text-anchor="middle" x="2427" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2427" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2427" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2427" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_residual_tp1&#45;&gt;l0_exp7_gpu1 -->
<g id="edge61" class="edge">
<title>l0_residual_tp1&#45;&gt;l0_exp7_gpu1</title>
<path fill="none" stroke="black" d="M2661.22,-4158.11C2658.85,-4091.82 2653.66,-3998.42 2643,-3985.17 2609.93,-3944.06 2579.57,-3963.06 2523.99,-3948.18"/>
<polygon fill="black" stroke="black" points="2524.66,-3944.73 2514.08,-3945.24 2522.67,-3951.44 2524.66,-3944.73"/>
</g>
<!-- l0_final_res_tp1 -->
<g id="node61" class="node">
<title>l0_final_res_tp1</title>
<polygon fill="lightyellow" stroke="black" points="2897.93,-3670.17 2326.95,-3670.17 2180.07,-3534.17 2751.05,-3534.17 2897.93,-3670.17"/>
<text text-anchor="middle" x="2539" y="-3620.97" font-family="Times,serif" font-size="14.00">Layer 0 Final Residual</text>
<text text-anchor="middle" x="2539" y="-3605.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="2539" y="-3590.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="2539" y="-3575.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_residual_tp1&#45;&gt;l0_final_res_tp1 -->
<g id="edge64" class="edge">
<title>l0_residual_tp1&#45;&gt;l0_final_res_tp1</title>
<path fill="none" stroke="black" d="M2895.47,-4176.93C3003.73,-4147.56 3109,-4105.74 3109,-4054.17 3109,-4054.17 3109,-4054.17 3109,-3774.17 3109,-3717.64 3004.86,-3678.2 2885.61,-3651.56"/>
<polygon fill="black" stroke="black" points="2886.03,-3648.07 2875.51,-3649.34 2884.53,-3654.9 2886.03,-3648.07"/>
</g>
<!-- l0_attn_tp2 -->
<g id="node11" class="node">
<title>l0_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="5091,-4504.17 4877,-4504.17 4877,-4436.17 5091,-4436.17 5091,-4504.17"/>
<text text-anchor="middle" x="4984" y="-4488.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="4984" y="-4473.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="4984" y="-4458.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="4984" y="-4443.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_qkv_tp2&#45;&gt;l0_attn_tp2 -->
<g id="edge66" class="edge">
<title>l0_qkv_tp2&#45;&gt;l0_attn_tp2</title>
<path fill="none" stroke="black" d="M5250.76,-4543.47C5203.49,-4530.66 5148.6,-4515.78 5100.94,-4502.86"/>
<polygon fill="black" stroke="black" points="5101.76,-4499.46 5091.2,-4500.22 5099.93,-4506.22 5101.76,-4499.46"/>
</g>
<!-- l0_out_proj_tp2 -->
<g id="node12" class="node">
<title>l0_out_proj_tp2</title>
<polygon fill="lightgreen" stroke="black" points="4592,-4399.17 4380,-4399.17 4380,-4331.17 4592,-4331.17 4592,-4399.17"/>
<text text-anchor="middle" x="4486" y="-4383.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4486" y="-4368.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="4486" y="-4353.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="4486" y="-4338.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_attn_tp2&#45;&gt;l0_out_proj_tp2 -->
<g id="edge67" class="edge">
<title>l0_attn_tp2&#45;&gt;l0_out_proj_tp2</title>
<path fill="none" stroke="black" d="M4876.86,-4447.01C4795.96,-4430.28 4685.08,-4407.34 4602.08,-4390.17"/>
<polygon fill="black" stroke="black" points="4602.6,-4386.71 4592.1,-4388.11 4601.18,-4393.56 4602.6,-4386.71"/>
</g>
<!-- l0_out_proj_tp2&#45;&gt;l0_residual_tp2 -->
<g id="edge68" class="edge">
<title>l0_out_proj_tp2&#45;&gt;l0_residual_tp2</title>
<path fill="none" stroke="black" d="M4417.74,-4331C4397.52,-4321.18 4374.55,-4310.02 4351.36,-4298.75"/>
<polygon fill="black" stroke="black" points="4352.64,-4295.49 4342.11,-4294.26 4349.58,-4301.78 4352.64,-4295.49"/>
</g>
<!-- l0_gate_tp2 -->
<g id="node36" class="node">
<title>l0_gate_tp2</title>
<polygon fill="lightyellow" stroke="black" points="4244.2,-4121.17 3914.59,-4121.17 3829.8,-3985.17 4159.41,-3985.17 4244.2,-4121.17"/>
<text text-anchor="middle" x="4037" y="-4071.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="4037" y="-4056.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="4037" y="-4041.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="4037" y="-4026.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_residual_tp2&#45;&gt;l0_gate_tp2 -->
<g id="edge70" class="edge">
<title>l0_residual_tp2&#45;&gt;l0_gate_tp2</title>
<path fill="none" stroke="black" d="M4138.48,-4158.07C4129.08,-4148.46 4119.37,-4138.51 4109.85,-4128.76"/>
<polygon fill="black" stroke="black" points="4112.1,-4126.06 4102.61,-4121.35 4107.09,-4130.95 4112.1,-4126.06"/>
</g>
<!-- l0_exp0_gpu2 -->
<g id="node62" class="node">
<title>l0_exp0_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="3302,-3948.17 3128,-3948.17 3128,-3880.17 3302,-3880.17 3302,-3948.17"/>
<text text-anchor="middle" x="3215" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="3215" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3215" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3215" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_residual_tp2&#45;&gt;l0_exp0_gpu2 -->
<g id="edge72" class="edge">
<title>l0_residual_tp2&#45;&gt;l0_exp0_gpu2</title>
<path fill="none" stroke="black" d="M3888.09,-4198.12C3722.48,-4180.53 3538.67,-4154.62 3463,-4121.17 3375.78,-4082.6 3294.8,-4004.12 3250.39,-3955.94"/>
<polygon fill="black" stroke="black" points="3252.91,-3953.5 3243.59,-3948.47 3247.74,-3958.22 3252.91,-3953.5"/>
</g>
<!-- l0_exp1_gpu2 -->
<g id="node63" class="node">
<title>l0_exp1_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="3878,-3948.17 3704,-3948.17 3704,-3880.17 3878,-3880.17 3878,-3948.17"/>
<text text-anchor="middle" x="3791" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3791" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3791" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3791" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_residual_tp2&#45;&gt;l0_exp1_gpu2 -->
<g id="edge75" class="edge">
<title>l0_residual_tp2&#45;&gt;l0_exp1_gpu2</title>
<path fill="none" stroke="black" d="M3855.26,-4158.12C3830.63,-4147.35 3811.95,-4135.08 3803,-4121.17 3771.62,-4072.39 3775.13,-4002.93 3781.95,-3958.44"/>
<polygon fill="black" stroke="black" points="3785.41,-3958.96 3783.59,-3948.52 3778.51,-3957.82 3785.41,-3958.96"/>
</g>
<!-- l0_exp2_gpu2 -->
<g id="node64" class="node">
<title>l0_exp2_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="4070,-3948.17 3896,-3948.17 3896,-3880.17 4070,-3880.17 4070,-3948.17"/>
<text text-anchor="middle" x="3983" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3983" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3983" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3983" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_residual_tp2&#45;&gt;l0_exp2_gpu2 -->
<g id="edge78" class="edge">
<title>l0_residual_tp2&#45;&gt;l0_exp2_gpu2</title>
<path fill="none" stroke="black" d="M3879.45,-4158.1C3852.45,-4147.16 3831.46,-4134.85 3821,-4121.17 3802.64,-4097.16 3804.4,-4010.42 3821,-3985.17 3825.48,-3978.35 3854.26,-3965.09 3886.36,-3951.93"/>
<polygon fill="black" stroke="black" points="3887.99,-3955.05 3895.94,-3948.04 3885.36,-3948.56 3887.99,-3955.05"/>
</g>
<!-- l0_exp3_gpu2 -->
<g id="node65" class="node">
<title>l0_exp3_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="3494,-3948.17 3320,-3948.17 3320,-3880.17 3494,-3880.17 3494,-3948.17"/>
<text text-anchor="middle" x="3407" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3407" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3407" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3407" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_residual_tp2&#45;&gt;l0_exp3_gpu2 -->
<g id="edge81" class="edge">
<title>l0_residual_tp2&#45;&gt;l0_exp3_gpu2</title>
<path fill="none" stroke="black" d="M3886.97,-4197.23C3804.07,-4181.82 3716.77,-4157.98 3641,-4121.17 3558.45,-4081.06 3482.6,-4003.71 3440.79,-3956.05"/>
<polygon fill="black" stroke="black" points="3443.32,-3953.63 3434.12,-3948.37 3438.04,-3958.22 3443.32,-3953.63"/>
</g>
<!-- l0_exp4_gpu2 -->
<g id="node66" class="node">
<title>l0_exp4_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="3686,-3948.17 3512,-3948.17 3512,-3880.17 3686,-3880.17 3686,-3948.17"/>
<text text-anchor="middle" x="3599" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3599" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3599" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3599" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_residual_tp2&#45;&gt;l0_exp4_gpu2 -->
<g id="edge84" class="edge">
<title>l0_residual_tp2&#45;&gt;l0_exp4_gpu2</title>
<path fill="none" stroke="black" d="M3855.43,-4167.77C3826.1,-4155.15 3798.11,-4139.8 3773,-4121.17 3710.67,-4074.9 3656.09,-4002.15 3625.36,-3956.63"/>
<polygon fill="black" stroke="black" points="3628.19,-3954.55 3619.72,-3948.18 3622.36,-3958.44 3628.19,-3954.55"/>
</g>
<!-- l0_exp5_gpu2 -->
<g id="node67" class="node">
<title>l0_exp5_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="4262,-3948.17 4088,-3948.17 4088,-3880.17 4262,-3880.17 4262,-3948.17"/>
<text text-anchor="middle" x="4175" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4175" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4175" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4175" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_residual_tp2&#45;&gt;l0_exp5_gpu2 -->
<g id="edge87" class="edge">
<title>l0_residual_tp2&#45;&gt;l0_exp5_gpu2</title>
<path fill="none" stroke="black" d="M4240.88,-4157.89C4245.89,-4145.97 4250.25,-4133.44 4253,-4121.17 4266.2,-4062.18 4277.63,-4040.37 4253,-3985.17 4248.08,-3974.13 4240.46,-3964.11 4231.88,-3955.32"/>
<polygon fill="black" stroke="black" points="4234.12,-3952.63 4224.48,-3948.23 4229.28,-3957.68 4234.12,-3952.63"/>
</g>
<!-- l0_exp6_gpu2 -->
<g id="node68" class="node">
<title>l0_exp6_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="4646,-3948.17 4472,-3948.17 4472,-3880.17 4646,-3880.17 4646,-3948.17"/>
<text text-anchor="middle" x="4559" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="4559" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4559" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4559" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_residual_tp2&#45;&gt;l0_exp6_gpu2 -->
<g id="edge90" class="edge">
<title>l0_residual_tp2&#45;&gt;l0_exp6_gpu2</title>
<path fill="none" stroke="black" d="M4281.03,-4157.9C4351.87,-4096.04 4454.55,-4006.37 4513.25,-3955.12"/>
<polygon fill="black" stroke="black" points="4515.65,-3957.66 4520.89,-3948.45 4511.05,-3952.39 4515.65,-3957.66"/>
</g>
<!-- l0_exp7_gpu2 -->
<g id="node69" class="node">
<title>l0_exp7_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="4454,-3948.17 4280,-3948.17 4280,-3880.17 4454,-3880.17 4454,-3948.17"/>
<text text-anchor="middle" x="4367" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="4367" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4367" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4367" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_residual_tp2&#45;&gt;l0_exp7_gpu2 -->
<g id="edge93" class="edge">
<title>l0_residual_tp2&#45;&gt;l0_exp7_gpu2</title>
<path fill="none" stroke="black" d="M4244.24,-4158.15C4251.31,-4145.93 4258.49,-4133.23 4265,-4121.17 4295.14,-4065.34 4327.18,-3999.41 4347.14,-3957.45"/>
<polygon fill="black" stroke="black" points="4350.33,-3958.89 4351.46,-3948.36 4344.01,-3955.89 4350.33,-3958.89"/>
</g>
<!-- l0_final_res_tp2 -->
<g id="node71" class="node">
<title>l0_final_res_tp2</title>
<polygon fill="lightyellow" stroke="black" points="4356.93,-3670.17 3785.95,-3670.17 3639.07,-3534.17 4210.05,-3534.17 4356.93,-3670.17"/>
<text text-anchor="middle" x="3998" y="-3620.97" font-family="Times,serif" font-size="14.00">Layer 0 Final Residual</text>
<text text-anchor="middle" x="3998" y="-3605.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="3998" y="-3590.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="3998" y="-3575.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_residual_tp2&#45;&gt;l0_final_res_tp2 -->
<g id="edge96" class="edge">
<title>l0_residual_tp2&#45;&gt;l0_final_res_tp2</title>
<path fill="none" stroke="black" d="M4439.23,-4179.44C4552.88,-4150.38 4665,-4108.05 4665,-4054.17 4665,-4054.17 4665,-4054.17 4665,-3774.17 4665,-3696.3 4492.26,-3653.4 4322.59,-3630.04"/>
<polygon fill="black" stroke="black" points="4322.84,-3626.54 4312.46,-3628.67 4321.9,-3633.48 4322.84,-3626.54"/>
</g>
<!-- l0_attn_tp3 -->
<g id="node15" class="node">
<title>l0_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="5760,-4504.17 5546,-4504.17 5546,-4436.17 5760,-4436.17 5760,-4504.17"/>
<text text-anchor="middle" x="5653" y="-4488.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5653" y="-4473.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="5653" y="-4458.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5653" y="-4443.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_qkv_tp3&#45;&gt;l0_attn_tp3 -->
<g id="edge98" class="edge">
<title>l0_qkv_tp3&#45;&gt;l0_attn_tp3</title>
<path fill="none" stroke="black" d="M5634.01,-4541.01C5636.34,-4532.46 5638.87,-4523.14 5641.31,-4514.18"/>
<polygon fill="black" stroke="black" points="5644.76,-4514.83 5644,-4504.26 5638,-4512.99 5644.76,-4514.83"/>
</g>
<!-- l0_out_proj_tp3 -->
<g id="node16" class="node">
<title>l0_out_proj_tp3</title>
<polygon fill="lightgreen" stroke="black" points="5761,-4399.17 5549,-4399.17 5549,-4331.17 5761,-4331.17 5761,-4399.17"/>
<text text-anchor="middle" x="5655" y="-4383.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5655" y="-4368.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="5655" y="-4353.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5655" y="-4338.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_attn_tp3&#45;&gt;l0_out_proj_tp3 -->
<g id="edge99" class="edge">
<title>l0_attn_tp3&#45;&gt;l0_out_proj_tp3</title>
<path fill="none" stroke="black" d="M5653.64,-4436.01C5653.81,-4427.56 5653.99,-4418.34 5654.16,-4409.47"/>
<polygon fill="black" stroke="black" points="5657.66,-4409.33 5654.36,-4399.26 5650.66,-4409.19 5657.66,-4409.33"/>
</g>
<!-- l0_out_proj_tp3&#45;&gt;l0_residual_tp3 -->
<g id="edge100" class="edge">
<title>l0_out_proj_tp3&#45;&gt;l0_residual_tp3</title>
<path fill="none" stroke="black" d="M5658.87,-4331C5659.82,-4322.86 5660.88,-4313.8 5661.97,-4304.52"/>
<polygon fill="black" stroke="black" points="5665.46,-4304.74 5663.15,-4294.4 5658.51,-4303.93 5665.46,-4304.74"/>
</g>
<!-- l0_gate_tp3 -->
<g id="node37" class="node">
<title>l0_gate_tp3</title>
<polygon fill="lightyellow" stroke="black" points="5692.2,-4121.17 5362.59,-4121.17 5277.8,-3985.17 5607.41,-3985.17 5692.2,-4121.17"/>
<text text-anchor="middle" x="5485" y="-4071.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="5485" y="-4056.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="5485" y="-4041.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="5485" y="-4026.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_residual_tp3&#45;&gt;l0_gate_tp3 -->
<g id="edge102" class="edge">
<title>l0_residual_tp3&#45;&gt;l0_gate_tp3</title>
<path fill="none" stroke="black" d="M5598.02,-4158.07C5587.35,-4148.27 5576.32,-4138.12 5565.51,-4128.18"/>
<polygon fill="black" stroke="black" points="5567.8,-4125.54 5558.07,-4121.35 5563.07,-4130.69 5567.8,-4125.54"/>
</g>
<!-- l0_exp0_gpu3 -->
<g id="node72" class="node">
<title>l0_exp0_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="5050,-3948.17 4876,-3948.17 4876,-3880.17 5050,-3880.17 5050,-3948.17"/>
<text text-anchor="middle" x="4963" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="4963" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4963" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4963" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_residual_tp3&#45;&gt;l0_exp0_gpu3 -->
<g id="edge104" class="edge">
<title>l0_residual_tp3&#45;&gt;l0_exp0_gpu3</title>
<path fill="none" stroke="black" d="M5343.44,-4187.41C5281.81,-4172.21 5219.63,-4150.94 5165,-4121.17 5090.73,-4080.69 5026.55,-4003.98 4991.46,-3956.45"/>
<polygon fill="black" stroke="black" points="4994.18,-3954.24 4985.46,-3948.22 4988.53,-3958.36 4994.18,-3954.24"/>
</g>
<!-- l0_exp1_gpu3 -->
<g id="node73" class="node">
<title>l0_exp1_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="4858,-3948.17 4684,-3948.17 4684,-3880.17 4858,-3880.17 4858,-3948.17"/>
<text text-anchor="middle" x="4771" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4771" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4771" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4771" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_residual_tp3&#45;&gt;l0_exp1_gpu3 -->
<g id="edge107" class="edge">
<title>l0_residual_tp3&#45;&gt;l0_exp1_gpu3</title>
<path fill="none" stroke="black" d="M5347.25,-4191.05C5211.37,-4173.28 5070.88,-4149.36 5010,-4121.17 4925.48,-4082.02 4847.8,-4004 4805.16,-3956.01"/>
<polygon fill="black" stroke="black" points="4807.6,-3953.49 4798.37,-3948.29 4802.34,-3958.11 4807.6,-3953.49"/>
</g>
<!-- l0_exp2_gpu3 -->
<g id="node74" class="node">
<title>l0_exp2_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="6202,-3948.17 6028,-3948.17 6028,-3880.17 6202,-3880.17 6202,-3948.17"/>
<text text-anchor="middle" x="6115" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="6115" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6115" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6115" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_residual_tp3&#45;&gt;l0_exp2_gpu3 -->
<g id="edge110" class="edge">
<title>l0_residual_tp3&#45;&gt;l0_exp2_gpu3</title>
<path fill="none" stroke="black" d="M5767.07,-4158.09C5856.32,-4095.78 5986.14,-4005.14 6059.36,-3954.02"/>
<polygon fill="black" stroke="black" points="6061.37,-3956.88 6067.56,-3948.29 6057.36,-3951.14 6061.37,-3956.88"/>
</g>
<!-- l0_exp3_gpu3 -->
<g id="node75" class="node">
<title>l0_exp3_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="5818,-3948.17 5644,-3948.17 5644,-3880.17 5818,-3880.17 5818,-3948.17"/>
<text text-anchor="middle" x="5731" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="5731" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5731" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5731" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_residual_tp3&#45;&gt;l0_exp3_gpu3 -->
<g id="edge113" class="edge">
<title>l0_residual_tp3&#45;&gt;l0_exp3_gpu3</title>
<path fill="none" stroke="black" d="M5709.75,-4158.03C5712.17,-4152.11 5714.31,-4146.11 5716,-4140.17 5733.42,-4078.85 5734.75,-4004.52 5733.41,-3958.52"/>
<polygon fill="black" stroke="black" points="5736.9,-3958.19 5733.05,-3948.31 5729.9,-3958.43 5736.9,-3958.19"/>
</g>
<!-- l0_exp4_gpu3 -->
<g id="node76" class="node">
<title>l0_exp4_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="5242,-3948.17 5068,-3948.17 5068,-3880.17 5242,-3880.17 5242,-3948.17"/>
<text text-anchor="middle" x="5155" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="5155" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5155" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5155" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_residual_tp3&#45;&gt;l0_exp4_gpu3 -->
<g id="edge116" class="edge">
<title>l0_residual_tp3&#45;&gt;l0_exp4_gpu3</title>
<path fill="none" stroke="black" d="M5312.45,-4158.76C5280.45,-4147.64 5254.89,-4135.11 5241,-4121.17 5196.12,-4076.11 5173.44,-4004.18 5162.94,-3958.34"/>
<polygon fill="black" stroke="black" points="5166.33,-3957.42 5160.76,-3948.41 5159.49,-3958.92 5166.33,-3957.42"/>
</g>
<!-- l0_exp5_gpu3 -->
<g id="node77" class="node">
<title>l0_exp5_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="5434,-3948.17 5260,-3948.17 5260,-3880.17 5434,-3880.17 5434,-3948.17"/>
<text text-anchor="middle" x="5347" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="5347" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5347" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5347" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_residual_tp3&#45;&gt;l0_exp5_gpu3 -->
<g id="edge119" class="edge">
<title>l0_residual_tp3&#45;&gt;l0_exp5_gpu3</title>
<path fill="none" stroke="black" d="M5327.49,-4158.03C5300.56,-4147.18 5279.65,-4134.92 5269,-4121.17 5232,-4073.37 5244.37,-4040.37 5269,-3985.17 5273.92,-3974.13 5281.54,-3964.11 5290.12,-3955.32"/>
<polygon fill="black" stroke="black" points="5292.72,-3957.68 5297.52,-3948.23 5287.88,-3952.63 5292.72,-3957.68"/>
</g>
<!-- l0_exp6_gpu3 -->
<g id="node78" class="node">
<title>l0_exp6_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="6010,-3948.17 5836,-3948.17 5836,-3880.17 6010,-3880.17 6010,-3948.17"/>
<text text-anchor="middle" x="5923" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5923" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5923" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5923" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_residual_tp3&#45;&gt;l0_exp6_gpu3 -->
<g id="edge122" class="edge">
<title>l0_residual_tp3&#45;&gt;l0_exp6_gpu3</title>
<path fill="none" stroke="black" d="M5725.68,-4157.9C5775.56,-4096.54 5847.67,-4007.84 5889.5,-3956.38"/>
<polygon fill="black" stroke="black" points="5892.35,-3958.42 5895.94,-3948.45 5886.92,-3954 5892.35,-3958.42"/>
</g>
<!-- l0_exp7_gpu3 -->
<g id="node79" class="node">
<title>l0_exp7_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="5626,-3948.17 5452,-3948.17 5452,-3880.17 5626,-3880.17 5626,-3948.17"/>
<text text-anchor="middle" x="5539" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5539" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5539" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5539" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_residual_tp3&#45;&gt;l0_exp7_gpu3 -->
<g id="edge125" class="edge">
<title>l0_residual_tp3&#45;&gt;l0_exp7_gpu3</title>
<path fill="none" stroke="black" d="M5693.33,-4158.07C5696.52,-4145.92 5699.29,-4133.26 5701,-4121.17 5705.23,-4091.24 5717.6,-4010.42 5701,-3985.17 5696.52,-3978.35 5667.74,-3965.09 5635.64,-3951.93"/>
<polygon fill="black" stroke="black" points="5636.64,-3948.56 5626.06,-3948.04 5634.01,-3955.05 5636.64,-3948.56"/>
</g>
<!-- l0_final_res_tp3 -->
<g id="node81" class="node">
<title>l0_final_res_tp3</title>
<polygon fill="lightyellow" stroke="black" points="6008.93,-3670.17 5437.95,-3670.17 5291.07,-3534.17 5862.05,-3534.17 6008.93,-3670.17"/>
<text text-anchor="middle" x="5650" y="-3620.97" font-family="Times,serif" font-size="14.00">Layer 0 Final Residual</text>
<text text-anchor="middle" x="5650" y="-3605.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="5650" y="-3590.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5650" y="-3575.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_residual_tp3&#45;&gt;l0_final_res_tp3 -->
<g id="edge128" class="edge">
<title>l0_residual_tp3&#45;&gt;l0_final_res_tp3</title>
<path fill="none" stroke="black" d="M5920.25,-4192.49C6065.78,-4166.17 6221,-4122.16 6221,-4054.17 6221,-4054.17 6221,-4054.17 6221,-3774.17 6221,-3717.37 6116,-3677.84 5996.06,-3651.21"/>
<polygon fill="black" stroke="black" points="5996.8,-3647.79 5986.28,-3649.07 5995.3,-3654.63 5996.8,-3647.79"/>
</g>
<!-- l0_attn_tp4 -->
<g id="node19" class="node">
<title>l0_attn_tp4</title>
<polygon fill="lightgreen" stroke="black" points="5995,-4504.17 5781,-4504.17 5781,-4436.17 5995,-4436.17 5995,-4504.17"/>
<text text-anchor="middle" x="5888" y="-4488.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5888" y="-4473.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="5888" y="-4458.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5888" y="-4443.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l0_qkv_tp4&#45;&gt;l0_attn_tp4 -->
<g id="edge130" class="edge">
<title>l0_qkv_tp4&#45;&gt;l0_attn_tp4</title>
<path fill="none" stroke="black" d="M5875.12,-4541.01C5876.69,-4532.46 5878.41,-4523.14 5880.07,-4514.18"/>
<polygon fill="black" stroke="black" points="5883.52,-4514.73 5881.9,-4504.26 5876.64,-4513.46 5883.52,-4514.73"/>
</g>
<!-- l0_out_proj_tp4 -->
<g id="node20" class="node">
<title>l0_out_proj_tp4</title>
<polygon fill="lightgreen" stroke="black" points="6008,-4399.17 5796,-4399.17 5796,-4331.17 6008,-4331.17 6008,-4399.17"/>
<text text-anchor="middle" x="5902" y="-4383.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5902" y="-4368.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="5902" y="-4353.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5902" y="-4338.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l0_attn_tp4&#45;&gt;l0_out_proj_tp4 -->
<g id="edge131" class="edge">
<title>l0_attn_tp4&#45;&gt;l0_out_proj_tp4</title>
<path fill="none" stroke="black" d="M5892.51,-4436.01C5893.67,-4427.46 5894.94,-4418.14 5896.15,-4409.18"/>
<polygon fill="black" stroke="black" points="5899.62,-4409.64 5897.5,-4399.26 5892.69,-4408.7 5899.62,-4409.64"/>
</g>
<!-- l0_out_proj_tp4&#45;&gt;l0_residual_tp4 -->
<g id="edge132" class="edge">
<title>l0_out_proj_tp4&#45;&gt;l0_residual_tp4</title>
<path fill="none" stroke="black" d="M6008.31,-4334.84C6014.28,-4333.52 6020.2,-4332.28 6026,-4331.17 6222.52,-4293.37 6447.01,-4266.82 6617.76,-4250.02"/>
<polygon fill="black" stroke="black" points="6618.29,-4253.48 6627.9,-4249.02 6617.61,-4246.51 6618.29,-4253.48"/>
</g>
<!-- l0_gate_tp4 -->
<g id="node38" class="node">
<title>l0_gate_tp4</title>
<polygon fill="lightyellow" stroke="black" points="7302.2,-4121.17 6972.59,-4121.17 6887.8,-3985.17 7217.41,-3985.17 7302.2,-4121.17"/>
<text text-anchor="middle" x="7095" y="-4071.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="7095" y="-4056.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="7095" y="-4041.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="7095" y="-4026.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l0_residual_tp4&#45;&gt;l0_gate_tp4 -->
<g id="edge134" class="edge">
<title>l0_residual_tp4&#45;&gt;l0_gate_tp4</title>
<path fill="none" stroke="black" d="M6969.83,-4158.07C6981.75,-4148.17 6994.1,-4137.93 7006.18,-4127.9"/>
<polygon fill="black" stroke="black" points="7008.61,-4130.43 7014.07,-4121.35 7004.14,-4125.04 7008.61,-4130.43"/>
</g>
<!-- l0_exp0_gpu4 -->
<g id="node82" class="node">
<title>l0_exp0_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="6990,-3948.17 6816,-3948.17 6816,-3880.17 6990,-3880.17 6990,-3948.17"/>
<text text-anchor="middle" x="6903" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="6903" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6903" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6903" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l0_residual_tp4&#45;&gt;l0_exp0_gpu4 -->
<g id="edge136" class="edge">
<title>l0_residual_tp4&#45;&gt;l0_exp0_gpu4</title>
<path fill="none" stroke="black" d="M6867.54,-4157.95C6854.03,-4104.61 6842.78,-4028.85 6864,-3966.17 6865.05,-3963.05 6866.38,-3959.98 6867.91,-3956.98"/>
<polygon fill="black" stroke="black" points="6871,-3958.63 6873.01,-3948.22 6864.95,-3955.1 6871,-3958.63"/>
</g>
<!-- l0_exp1_gpu4 -->
<g id="node83" class="node">
<title>l0_exp1_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="6414,-3948.17 6240,-3948.17 6240,-3880.17 6414,-3880.17 6414,-3948.17"/>
<text text-anchor="middle" x="6327" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="6327" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6327" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6327" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l0_residual_tp4&#45;&gt;l0_exp1_gpu4 -->
<g id="edge139" class="edge">
<title>l0_residual_tp4&#45;&gt;l0_exp1_gpu4</title>
<path fill="none" stroke="black" d="M6668.23,-4158.16C6640.94,-4147.12 6613.91,-4134.78 6589,-4121.17 6503.93,-4074.69 6417.99,-4000.82 6368.76,-3955.31"/>
<polygon fill="black" stroke="black" points="6370.88,-3952.51 6361.18,-3948.26 6366.12,-3957.63 6370.88,-3952.51"/>
</g>
<!-- l0_exp2_gpu4 -->
<g id="node84" class="node">
<title>l0_exp2_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="7182,-3948.17 7008,-3948.17 7008,-3880.17 7182,-3880.17 7182,-3948.17"/>
<text text-anchor="middle" x="7095" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="7095" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7095" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7095" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l0_residual_tp4&#45;&gt;l0_exp2_gpu4 -->
<g id="edge142" class="edge">
<title>l0_residual_tp4&#45;&gt;l0_exp2_gpu4</title>
<path fill="none" stroke="black" d="M6877.08,-4157.94C6867.8,-4096.61 6859.47,-4011.63 6879,-3985.17 6910.33,-3942.72 6942.24,-3962.92 6998,-3948.17"/>
<polygon fill="black" stroke="black" points="6999.32,-3951.43 7007.92,-3945.24 6997.34,-3944.71 6999.32,-3951.43"/>
</g>
<!-- l0_exp3_gpu4 -->
<g id="node85" class="node">
<title>l0_exp3_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="7566,-3948.17 7392,-3948.17 7392,-3880.17 7566,-3880.17 7566,-3948.17"/>
<text text-anchor="middle" x="7479" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7479" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7479" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7479" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l0_residual_tp4&#45;&gt;l0_exp3_gpu4 -->
<g id="edge145" class="edge">
<title>l0_residual_tp4&#45;&gt;l0_exp3_gpu4</title>
<path fill="none" stroke="black" d="M7133.64,-4188.27C7216.47,-4171.37 7295.72,-4148.87 7326,-4121.17 7379.82,-4071.94 7427.38,-4001.42 7454.67,-3956.98"/>
<polygon fill="black" stroke="black" points="7457.81,-3958.54 7460.02,-3948.18 7451.83,-3954.91 7457.81,-3958.54"/>
</g>
<!-- l0_exp4_gpu4 -->
<g id="node86" class="node">
<title>l0_exp4_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="7374,-3948.17 7200,-3948.17 7200,-3880.17 7374,-3880.17 7374,-3948.17"/>
<text text-anchor="middle" x="7287" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="7287" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7287" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7287" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l0_residual_tp4&#45;&gt;l0_exp4_gpu4 -->
<g id="edge148" class="edge">
<title>l0_residual_tp4&#45;&gt;l0_exp4_gpu4</title>
<path fill="none" stroke="black" d="M7136.49,-4190.67C7214.75,-4174.34 7287.15,-4151.61 7311,-4121.17 7347.49,-4074.6 7327.25,-4002.94 7308.07,-3957.59"/>
<polygon fill="black" stroke="black" points="7311.23,-3956.09 7304.02,-3948.33 7304.82,-3958.89 7311.23,-3956.09"/>
</g>
<!-- l0_exp5_gpu4 -->
<g id="node87" class="node">
<title>l0_exp5_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="6606,-3948.17 6432,-3948.17 6432,-3880.17 6606,-3880.17 6606,-3948.17"/>
<text text-anchor="middle" x="6519" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="6519" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6519" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6519" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l0_residual_tp4&#45;&gt;l0_exp5_gpu4 -->
<g id="edge151" class="edge">
<title>l0_residual_tp4&#45;&gt;l0_exp5_gpu4</title>
<path fill="none" stroke="black" d="M6794.4,-4157.97C6778.36,-4145.99 6762.05,-4133.42 6747,-4121.17 6679.74,-4066.39 6605.95,-3998.1 6561.05,-3955.55"/>
<polygon fill="black" stroke="black" points="6563.21,-3952.78 6553.55,-3948.43 6558.39,-3957.86 6563.21,-3952.78"/>
</g>
<!-- l0_exp6_gpu4 -->
<g id="node88" class="node">
<title>l0_exp6_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="6798,-3948.17 6624,-3948.17 6624,-3880.17 6798,-3880.17 6798,-3948.17"/>
<text text-anchor="middle" x="6711" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="6711" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6711" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6711" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l0_residual_tp4&#45;&gt;l0_exp6_gpu4 -->
<g id="edge154" class="edge">
<title>l0_residual_tp4&#45;&gt;l0_exp6_gpu4</title>
<path fill="none" stroke="black" d="M6850.38,-4157.9C6815.36,-4096.92 6764.84,-4008.93 6735.21,-3957.34"/>
<polygon fill="black" stroke="black" points="6738.13,-3955.38 6730.11,-3948.45 6732.06,-3958.86 6738.13,-3955.38"/>
</g>
<!-- l0_exp7_gpu4 -->
<g id="node89" class="node">
<title>l0_exp7_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="7758,-3948.17 7584,-3948.17 7584,-3880.17 7758,-3880.17 7758,-3948.17"/>
<text text-anchor="middle" x="7671" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="7671" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7671" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7671" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l0_residual_tp4&#45;&gt;l0_exp7_gpu4 -->
<g id="edge157" class="edge">
<title>l0_residual_tp4&#45;&gt;l0_exp7_gpu4</title>
<path fill="none" stroke="black" d="M7140.41,-4194.36C7220.9,-4178.8 7308.84,-4155.6 7385,-4121.17 7479.6,-4078.4 7574.42,-4001.84 7627.63,-3955.06"/>
<polygon fill="black" stroke="black" points="7630,-3957.64 7635.17,-3948.39 7625.36,-3952.4 7630,-3957.64"/>
</g>
<!-- l0_final_res_tp4 -->
<g id="node91" class="node">
<title>l0_final_res_tp4</title>
<polygon fill="lightyellow" stroke="black" points="7486.93,-3670.17 6915.95,-3670.17 6769.07,-3534.17 7340.05,-3534.17 7486.93,-3670.17"/>
<text text-anchor="middle" x="7128" y="-3620.97" font-family="Times,serif" font-size="14.00">Layer 0 Final Residual</text>
<text text-anchor="middle" x="7128" y="-3605.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="7128" y="-3590.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="7128" y="-3575.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l0_residual_tp4&#45;&gt;l0_final_res_tp4 -->
<g id="edge160" class="edge">
<title>l0_residual_tp4&#45;&gt;l0_final_res_tp4</title>
<path fill="none" stroke="black" d="M7146.44,-4200.19C7408.67,-4171.17 7777,-4118.88 7777,-4054.17 7777,-4054.17 7777,-4054.17 7777,-3774.17 7777,-3700.13 7617.05,-3657.45 7455.96,-3633.25"/>
<polygon fill="black" stroke="black" points="7456.25,-3629.76 7445.85,-3631.76 7455.23,-3636.68 7456.25,-3629.76"/>
</g>
<!-- l0_attn_tp5 -->
<g id="node23" class="node">
<title>l0_attn_tp5</title>
<polygon fill="lightgreen" stroke="black" points="6237,-4504.17 6023,-4504.17 6023,-4436.17 6237,-4436.17 6237,-4504.17"/>
<text text-anchor="middle" x="6130" y="-4488.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="6130" y="-4473.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="6130" y="-4458.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="6130" y="-4443.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l0_qkv_tp5&#45;&gt;l0_attn_tp5 -->
<g id="edge162" class="edge">
<title>l0_qkv_tp5&#45;&gt;l0_attn_tp5</title>
<path fill="none" stroke="black" d="M6118.47,-4541.01C6119.88,-4532.46 6121.42,-4523.14 6122.9,-4514.18"/>
<polygon fill="black" stroke="black" points="6126.36,-4514.7 6124.54,-4504.26 6119.46,-4513.56 6126.36,-4514.7"/>
</g>
<!-- l0_out_proj_tp5 -->
<g id="node24" class="node">
<title>l0_out_proj_tp5</title>
<polygon fill="lightgreen" stroke="black" points="6247,-4399.17 6035,-4399.17 6035,-4331.17 6247,-4331.17 6247,-4399.17"/>
<text text-anchor="middle" x="6141" y="-4383.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6141" y="-4368.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="6141" y="-4353.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="6141" y="-4338.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l0_attn_tp5&#45;&gt;l0_out_proj_tp5 -->
<g id="edge163" class="edge">
<title>l0_attn_tp5&#45;&gt;l0_out_proj_tp5</title>
<path fill="none" stroke="black" d="M6133.54,-4436.01C6134.44,-4427.56 6135.43,-4418.34 6136.38,-4409.47"/>
<polygon fill="black" stroke="black" points="6139.88,-4409.58 6137.47,-4399.26 6132.92,-4408.83 6139.88,-4409.58"/>
</g>
<!-- l0_out_proj_tp5&#45;&gt;l0_residual_tp5 -->
<g id="edge164" class="edge">
<title>l0_out_proj_tp5&#45;&gt;l0_residual_tp5</title>
<path fill="none" stroke="black" d="M6247.17,-4333.67C6251.49,-4332.77 6255.78,-4331.93 6260,-4331.17 6357.46,-4313.64 6383.12,-4317.54 6482,-4312.17 6826.03,-4293.47 6912.77,-4308.75 7257,-4294.17 7534.71,-4282.4 7851.87,-4262.11 8072,-4246.93"/>
<polygon fill="black" stroke="black" points="8072.35,-4250.42 8082.08,-4246.24 8071.86,-4243.43 8072.35,-4250.42"/>
</g>
<!-- l0_gate_tp5 -->
<g id="node39" class="node">
<title>l0_gate_tp5</title>
<polygon fill="lightyellow" stroke="black" points="8720.2,-4121.17 8390.59,-4121.17 8305.8,-3985.17 8635.41,-3985.17 8720.2,-4121.17"/>
<text text-anchor="middle" x="8513" y="-4071.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="8513" y="-4056.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="8513" y="-4041.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="8513" y="-4026.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l0_residual_tp5&#45;&gt;l0_gate_tp5 -->
<g id="edge166" class="edge">
<title>l0_residual_tp5&#45;&gt;l0_gate_tp5</title>
<path fill="none" stroke="black" d="M8411.52,-4158.07C8420.92,-4148.46 8430.63,-4138.51 8440.15,-4128.76"/>
<polygon fill="black" stroke="black" points="8442.91,-4130.95 8447.39,-4121.35 8437.9,-4126.06 8442.91,-4130.95"/>
</g>
<!-- l0_exp0_gpu5 -->
<g id="node92" class="node">
<title>l0_exp0_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="8354,-3948.17 8180,-3948.17 8180,-3880.17 8354,-3880.17 8354,-3948.17"/>
<text text-anchor="middle" x="8267" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8267" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8267" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8267" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l0_residual_tp5&#45;&gt;l0_exp0_gpu5 -->
<g id="edge168" class="edge">
<title>l0_residual_tp5&#45;&gt;l0_exp0_gpu5</title>
<path fill="none" stroke="black" d="M8290.3,-4158.05C8287.09,-4152.22 8284.25,-4146.23 8282,-4140.17 8259.68,-4080.12 8259.76,-4004.92 8262.73,-3958.46"/>
<polygon fill="black" stroke="black" points="8266.22,-3958.65 8263.44,-3948.43 8259.24,-3958.16 8266.22,-3958.65"/>
</g>
<!-- l0_exp1_gpu5 -->
<g id="node93" class="node">
<title>l0_exp1_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="8162,-3948.17 7988,-3948.17 7988,-3880.17 8162,-3880.17 8162,-3948.17"/>
<text text-anchor="middle" x="8075" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="8075" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8075" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8075" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l0_residual_tp5&#45;&gt;l0_exp1_gpu5 -->
<g id="edge171" class="edge">
<title>l0_residual_tp5&#45;&gt;l0_exp1_gpu5</title>
<path fill="none" stroke="black" d="M8287.2,-4157.9C8233.45,-4096.42 8155.69,-4007.47 8110.75,-3956.06"/>
<polygon fill="black" stroke="black" points="8113.31,-3953.68 8104.1,-3948.45 8108.04,-3958.28 8113.31,-3953.68"/>
</g>
<!-- l0_exp2_gpu5 -->
<g id="node94" class="node">
<title>l0_exp2_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="8546,-3948.17 8372,-3948.17 8372,-3880.17 8546,-3880.17 8546,-3948.17"/>
<text text-anchor="middle" x="8459" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="8459" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8459" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8459" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l0_residual_tp5&#45;&gt;l0_exp2_gpu5 -->
<g id="edge174" class="edge">
<title>l0_residual_tp5&#45;&gt;l0_exp2_gpu5</title>
<path fill="none" stroke="black" d="M8307.25,-4158C8283.35,-4106.85 8263.13,-4036.7 8297,-3985.17 8301.48,-3978.35 8330.26,-3965.09 8362.36,-3951.93"/>
<polygon fill="black" stroke="black" points="8363.99,-3955.05 8371.94,-3948.04 8361.36,-3948.56 8363.99,-3955.05"/>
</g>
<!-- l0_exp3_gpu5 -->
<g id="node95" class="node">
<title>l0_exp3_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="9122,-3948.17 8948,-3948.17 8948,-3880.17 9122,-3880.17 9122,-3948.17"/>
<text text-anchor="middle" x="9035" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9035" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9035" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9035" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l0_residual_tp5&#45;&gt;l0_exp3_gpu5 -->
<g id="edge177" class="edge">
<title>l0_residual_tp5&#45;&gt;l0_exp3_gpu5</title>
<path fill="none" stroke="black" d="M8593.48,-4190.88C8659.25,-4175.47 8728.48,-4153.22 8788,-4121.17 8870.6,-4076.68 8951.17,-4001.86 8996.79,-3955.68"/>
<polygon fill="black" stroke="black" points="8999.31,-3958.11 9003.81,-3948.52 8994.31,-3953.21 8999.31,-3958.11"/>
</g>
<!-- l0_exp4_gpu5 -->
<g id="node96" class="node">
<title>l0_exp4_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="8930,-3948.17 8756,-3948.17 8756,-3880.17 8930,-3880.17 8930,-3948.17"/>
<text text-anchor="middle" x="8843" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="8843" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8843" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8843" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l0_residual_tp5&#45;&gt;l0_exp4_gpu5 -->
<g id="edge180" class="edge">
<title>l0_residual_tp5&#45;&gt;l0_exp4_gpu5</title>
<path fill="none" stroke="black" d="M8586.68,-4184.54C8656.77,-4168.06 8720.99,-4146.8 8745,-4121.17 8789.17,-4074 8816.85,-4003.28 8831.11,-3958.19"/>
<polygon fill="black" stroke="black" points="8834.52,-3959 8834.12,-3948.41 8827.83,-3956.94 8834.52,-3959"/>
</g>
<!-- l0_exp5_gpu5 -->
<g id="node97" class="node">
<title>l0_exp5_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="8738,-3948.17 8564,-3948.17 8564,-3880.17 8738,-3880.17 8738,-3948.17"/>
<text text-anchor="middle" x="8651" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="8651" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8651" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8651" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l0_residual_tp5&#45;&gt;l0_exp5_gpu5 -->
<g id="edge183" class="edge">
<title>l0_residual_tp5&#45;&gt;l0_exp5_gpu5</title>
<path fill="none" stroke="black" d="M8586.58,-4184.29C8651.4,-4168.13 8709.15,-4147.13 8729,-4121.17 8765.72,-4073.15 8753.63,-4040.37 8729,-3985.17 8724.08,-3974.13 8716.46,-3964.11 8707.88,-3955.32"/>
<polygon fill="black" stroke="black" points="8710.12,-3952.63 8700.48,-3948.23 8705.28,-3957.68 8710.12,-3952.63"/>
</g>
<!-- l0_exp6_gpu5 -->
<g id="node98" class="node">
<title>l0_exp6_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="7970,-3948.17 7796,-3948.17 7796,-3880.17 7970,-3880.17 7970,-3948.17"/>
<text text-anchor="middle" x="7883" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="7883" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7883" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7883" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l0_residual_tp5&#45;&gt;l0_exp6_gpu5 -->
<g id="edge186" class="edge">
<title>l0_residual_tp5&#45;&gt;l0_exp6_gpu5</title>
<path fill="none" stroke="black" d="M8196.13,-4158.03C8174.15,-4146.56 8152.15,-4134.13 8132,-4121.17 8053.85,-4070.88 7972.59,-3999.43 7924.96,-3955.25"/>
<polygon fill="black" stroke="black" points="7927.31,-3952.66 7917.61,-3948.4 7922.54,-3957.78 7927.31,-3952.66"/>
</g>
<!-- l0_exp7_gpu5 -->
<g id="node99" class="node">
<title>l0_exp7_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="9314,-3948.17 9140,-3948.17 9140,-3880.17 9314,-3880.17 9314,-3948.17"/>
<text text-anchor="middle" x="9227" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="9227" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9227" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9227" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l0_residual_tp5&#45;&gt;l0_exp7_gpu5 -->
<g id="edge189" class="edge">
<title>l0_residual_tp5&#45;&gt;l0_exp7_gpu5</title>
<path fill="none" stroke="black" d="M8597.83,-4194.77C8689.26,-4178.96 8792.12,-4155.51 8882,-4121.17 8993.17,-4078.69 9109.37,-4001.35 9174.54,-3954.47"/>
<polygon fill="black" stroke="black" points="9176.95,-3957.05 9183,-3948.35 9172.85,-3951.37 9176.95,-3957.05"/>
</g>
<!-- l0_final_res_tp5 -->
<g id="node101" class="node">
<title>l0_final_res_tp5</title>
<polygon fill="lightyellow" stroke="black" points="9130.93,-3670.17 8559.95,-3670.17 8413.07,-3534.17 8984.05,-3534.17 9130.93,-3670.17"/>
<text text-anchor="middle" x="8772" y="-3620.97" font-family="Times,serif" font-size="14.00">Layer 0 Final Residual</text>
<text text-anchor="middle" x="8772" y="-3605.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="8772" y="-3590.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="8772" y="-3575.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l0_residual_tp5&#45;&gt;l0_final_res_tp5 -->
<g id="edge192" class="edge">
<title>l0_residual_tp5&#45;&gt;l0_final_res_tp5</title>
<path fill="none" stroke="black" d="M8608.88,-4204.94C8901.27,-4178.82 9333,-4127.78 9333,-4054.17 9333,-4054.17 9333,-4054.17 9333,-3774.17 9333,-3719.75 9235.21,-3680.97 9121.28,-3654.24"/>
<polygon fill="black" stroke="black" points="9121.81,-3650.78 9111.28,-3651.94 9120.24,-3657.6 9121.81,-3650.78"/>
</g>
<!-- l0_attn_tp6 -->
<g id="node27" class="node">
<title>l0_attn_tp6</title>
<polygon fill="lightgreen" stroke="black" points="6476,-4504.17 6262,-4504.17 6262,-4436.17 6476,-4436.17 6476,-4504.17"/>
<text text-anchor="middle" x="6369" y="-4488.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="6369" y="-4473.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="6369" y="-4458.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="6369" y="-4443.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l0_qkv_tp6&#45;&gt;l0_attn_tp6 -->
<g id="edge194" class="edge">
<title>l0_qkv_tp6&#45;&gt;l0_attn_tp6</title>
<path fill="none" stroke="black" d="M6360.86,-4541.01C6361.85,-4532.56 6362.92,-4523.34 6363.96,-4514.47"/>
<polygon fill="black" stroke="black" points="6367.46,-4514.6 6365.14,-4504.26 6360.51,-4513.79 6367.46,-4514.6"/>
</g>
<!-- l0_out_proj_tp6 -->
<g id="node28" class="node">
<title>l0_out_proj_tp6</title>
<polygon fill="lightgreen" stroke="black" points="6481,-4399.17 6269,-4399.17 6269,-4331.17 6481,-4331.17 6481,-4399.17"/>
<text text-anchor="middle" x="6375" y="-4383.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6375" y="-4368.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="6375" y="-4353.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="6375" y="-4338.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l0_attn_tp6&#45;&gt;l0_out_proj_tp6 -->
<g id="edge195" class="edge">
<title>l0_attn_tp6&#45;&gt;l0_out_proj_tp6</title>
<path fill="none" stroke="black" d="M6370.93,-4436.01C6371.42,-4427.56 6371.96,-4418.34 6372.48,-4409.47"/>
<polygon fill="black" stroke="black" points="6375.98,-4409.45 6373.07,-4399.26 6369,-4409.04 6375.98,-4409.45"/>
</g>
<!-- l0_out_proj_tp6&#45;&gt;l0_residual_tp6 -->
<g id="edge196" class="edge">
<title>l0_out_proj_tp6&#45;&gt;l0_residual_tp6</title>
<path fill="none" stroke="black" d="M6481.31,-4333.39C6484.91,-4332.6 6488.48,-4331.86 6492,-4331.17 6566.17,-4316.64 6585.55,-4316.73 6661,-4312.17 7116.41,-4284.64 8257.99,-4308.65 8714,-4294.17 9039.85,-4283.82 9414.04,-4261.83 9661.81,-4245.86"/>
<polygon fill="black" stroke="black" points="9662.29,-4249.34 9672.04,-4245.2 9661.84,-4242.35 9662.29,-4249.34"/>
</g>
<!-- l0_gate_tp6 -->
<g id="node40" class="node">
<title>l0_gate_tp6</title>
<polygon fill="lightyellow" stroke="black" points="10380.2,-4121.17 10050.59,-4121.17 9965.8,-3985.17 10295.41,-3985.17 10380.2,-4121.17"/>
<text text-anchor="middle" x="10173" y="-4071.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="10173" y="-4056.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="10173" y="-4041.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="10173" y="-4026.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l0_residual_tp6&#45;&gt;l0_gate_tp6 -->
<g id="edge198" class="edge">
<title>l0_residual_tp6&#45;&gt;l0_gate_tp6</title>
<path fill="none" stroke="black" d="M10029.6,-4158.07C10043.52,-4147.98 10057.94,-4137.53 10072.03,-4127.33"/>
<polygon fill="black" stroke="black" points="10074.24,-4130.05 10080.28,-4121.35 10070.13,-4124.38 10074.24,-4130.05"/>
</g>
<!-- l0_exp0_gpu6 -->
<g id="node102" class="node">
<title>l0_exp0_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="9718,-3948.17 9544,-3948.17 9544,-3880.17 9718,-3880.17 9718,-3948.17"/>
<text text-anchor="middle" x="9631" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="9631" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9631" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9631" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l0_residual_tp6&#45;&gt;l0_exp0_gpu6 -->
<g id="edge200" class="edge">
<title>l0_residual_tp6&#45;&gt;l0_exp0_gpu6</title>
<path fill="none" stroke="black" d="M9870.6,-4157.9C9809.79,-4096.29 9721.75,-4007.1 9671.06,-3955.75"/>
<polygon fill="black" stroke="black" points="9673.37,-3953.11 9663.85,-3948.45 9668.39,-3958.03 9673.37,-3953.11"/>
</g>
<!-- l0_exp1_gpu6 -->
<g id="node103" class="node">
<title>l0_exp1_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="9910,-3948.17 9736,-3948.17 9736,-3880.17 9910,-3880.17 9910,-3948.17"/>
<text text-anchor="middle" x="9823" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="9823" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9823" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9823" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l0_residual_tp6&#45;&gt;l0_exp1_gpu6 -->
<g id="edge203" class="edge">
<title>l0_residual_tp6&#45;&gt;l0_exp1_gpu6</title>
<path fill="none" stroke="black" d="M9912.26,-4157.9C9889.93,-4097.17 9857.75,-4009.66 9838.74,-3957.98"/>
<polygon fill="black" stroke="black" points="9841.98,-3956.63 9835.24,-3948.45 9835.41,-3959.04 9841.98,-3956.63"/>
</g>
<!-- l0_exp2_gpu6 -->
<g id="node104" class="node">
<title>l0_exp2_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="9526,-3948.17 9352,-3948.17 9352,-3880.17 9526,-3880.17 9526,-3948.17"/>
<text text-anchor="middle" x="9439" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="9439" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9439" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9439" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l0_residual_tp6&#45;&gt;l0_exp2_gpu6 -->
<g id="edge206" class="edge">
<title>l0_residual_tp6&#45;&gt;l0_exp2_gpu6</title>
<path fill="none" stroke="black" d="M9765.91,-4158.16C9741.91,-4146.81 9717.97,-4134.38 9696,-4121.17 9614.6,-4072.2 9530.63,-4000.05 9481.7,-3955.41"/>
<polygon fill="black" stroke="black" points="9483.89,-3952.67 9474.15,-3948.49 9479.16,-3957.83 9483.89,-3952.67"/>
</g>
<!-- l0_exp3_gpu6 -->
<g id="node105" class="node">
<title>l0_exp3_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="10102,-3948.17 9928,-3948.17 9928,-3880.17 10102,-3880.17 10102,-3948.17"/>
<text text-anchor="middle" x="10015" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="10015" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10015" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10015" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l0_residual_tp6&#45;&gt;l0_exp3_gpu6 -->
<g id="edge209" class="edge">
<title>l0_residual_tp6&#45;&gt;l0_exp3_gpu6</title>
<path fill="none" stroke="black" d="M9922.32,-4157.96C9913.92,-4103.07 9910.51,-4025.19 9942,-3966.17 9944.01,-3962.41 9946.43,-3958.87 9949.15,-3955.54"/>
<polygon fill="black" stroke="black" points="9951.75,-3957.88 9955.99,-3948.17 9946.63,-3953.11 9951.75,-3957.88"/>
</g>
<!-- l0_exp4_gpu6 -->
<g id="node106" class="node">
<title>l0_exp4_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="10870,-3948.17 10696,-3948.17 10696,-3880.17 10870,-3880.17 10870,-3948.17"/>
<text text-anchor="middle" x="10783" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="10783" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10783" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10783" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l0_residual_tp6&#45;&gt;l0_exp4_gpu6 -->
<g id="edge212" class="edge">
<title>l0_residual_tp6&#45;&gt;l0_exp4_gpu6</title>
<path fill="none" stroke="black" d="M10191.93,-4197.83C10284.41,-4182.34 10388.17,-4158.3 10478,-4121.17 10578.67,-4079.55 10680.52,-4002.01 10737.33,-3954.84"/>
<polygon fill="black" stroke="black" points="10739.62,-3957.49 10745.05,-3948.39 10735.13,-3952.12 10739.62,-3957.49"/>
</g>
<!-- l0_exp5_gpu6 -->
<g id="node107" class="node">
<title>l0_exp5_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="10294,-3948.17 10120,-3948.17 10120,-3880.17 10294,-3880.17 10294,-3948.17"/>
<text text-anchor="middle" x="10207" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10207" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10207" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10207" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l0_residual_tp6&#45;&gt;l0_exp5_gpu6 -->
<g id="edge215" class="edge">
<title>l0_residual_tp6&#45;&gt;l0_exp5_gpu6</title>
<path fill="none" stroke="black" d="M9934.1,-4157.9C9932.91,-4096.05 9935.46,-4010.28 9957,-3985.17 10000.87,-3934.04 10039.92,-3964.91 10110.32,-3948.05"/>
<polygon fill="black" stroke="black" points="10111.23,-3951.43 10119.99,-3945.48 10109.43,-3944.67 10111.23,-3951.43"/>
</g>
<!-- l0_exp6_gpu6 -->
<g id="node108" class="node">
<title>l0_exp6_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="10678,-3948.17 10504,-3948.17 10504,-3880.17 10678,-3880.17 10678,-3948.17"/>
<text text-anchor="middle" x="10591" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="10591" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10591" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10591" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l0_residual_tp6&#45;&gt;l0_exp6_gpu6 -->
<g id="edge218" class="edge">
<title>l0_residual_tp6&#45;&gt;l0_exp6_gpu6</title>
<path fill="none" stroke="black" d="M10183.79,-4190.27C10277.84,-4172.97 10371.27,-4149.64 10408,-4121.17 10470.34,-4072.84 10528.28,-4001.32 10561.64,-3956.52"/>
<polygon fill="black" stroke="black" points="10564.66,-3958.33 10567.78,-3948.21 10559.02,-3954.17 10564.66,-3958.33"/>
</g>
<!-- l0_exp7_gpu6 -->
<g id="node109" class="node">
<title>l0_exp7_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="10486,-3948.17 10312,-3948.17 10312,-3880.17 10486,-3880.17 10486,-3948.17"/>
<text text-anchor="middle" x="10399" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="10399" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10399" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10399" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l0_residual_tp6&#45;&gt;l0_exp7_gpu6 -->
<g id="edge221" class="edge">
<title>l0_residual_tp6&#45;&gt;l0_exp7_gpu6</title>
<path fill="none" stroke="black" d="M10188.49,-4194.35C10276.88,-4178.08 10361.2,-4154.4 10389,-4121.17 10426.7,-4076.1 10420.18,-4004.17 10410.64,-3958.33"/>
<polygon fill="black" stroke="black" points="10414.02,-3957.41 10408.44,-3948.4 10407.18,-3958.92 10414.02,-3957.41"/>
</g>
<!-- l0_final_res_tp6 -->
<g id="node111" class="node">
<title>l0_final_res_tp6</title>
<polygon fill="lightyellow" stroke="black" points="10581.93,-3670.17 10010.95,-3670.17 9864.07,-3534.17 10435.05,-3534.17 10581.93,-3670.17"/>
<text text-anchor="middle" x="10223" y="-3620.97" font-family="Times,serif" font-size="14.00">Layer 0 Final Residual</text>
<text text-anchor="middle" x="10223" y="-3605.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="10223" y="-3590.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="10223" y="-3575.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l0_residual_tp6&#45;&gt;l0_final_res_tp6 -->
<g id="edge224" class="edge">
<title>l0_residual_tp6&#45;&gt;l0_final_res_tp6</title>
<path fill="none" stroke="black" d="M10198.08,-4203.35C10479.92,-4176.18 10889,-4124.62 10889,-4054.17 10889,-4054.17 10889,-4054.17 10889,-3774.17 10889,-3696.48 10716.84,-3653.58 10547.58,-3630.19"/>
<polygon fill="black" stroke="black" points="10547.85,-3626.69 10537.47,-3628.81 10546.91,-3633.63 10547.85,-3626.69"/>
</g>
<!-- l0_attn_tp7 -->
<g id="node31" class="node">
<title>l0_attn_tp7</title>
<polygon fill="lightgreen" stroke="black" points="6712,-4504.17 6498,-4504.17 6498,-4436.17 6712,-4436.17 6712,-4504.17"/>
<text text-anchor="middle" x="6605" y="-4488.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="6605" y="-4473.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="6605" y="-4458.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="6605" y="-4443.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l0_qkv_tp7&#45;&gt;l0_attn_tp7 -->
<g id="edge226" class="edge">
<title>l0_qkv_tp7&#45;&gt;l0_attn_tp7</title>
<path fill="none" stroke="black" d="M6602.29,-4541.01C6602.62,-4532.56 6602.97,-4523.34 6603.32,-4514.47"/>
<polygon fill="black" stroke="black" points="6606.82,-4514.39 6603.71,-4504.26 6599.83,-4514.12 6606.82,-4514.39"/>
</g>
<!-- l0_out_proj_tp7 -->
<g id="node32" class="node">
<title>l0_out_proj_tp7</title>
<polygon fill="lightgreen" stroke="black" points="6713,-4399.17 6501,-4399.17 6501,-4331.17 6713,-4331.17 6713,-4399.17"/>
<text text-anchor="middle" x="6607" y="-4383.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6607" y="-4368.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="6607" y="-4353.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="6607" y="-4338.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l0_attn_tp7&#45;&gt;l0_out_proj_tp7 -->
<g id="edge227" class="edge">
<title>l0_attn_tp7&#45;&gt;l0_out_proj_tp7</title>
<path fill="none" stroke="black" d="M6605.64,-4436.01C6605.81,-4427.56 6605.99,-4418.34 6606.16,-4409.47"/>
<polygon fill="black" stroke="black" points="6609.66,-4409.33 6606.36,-4399.26 6602.66,-4409.19 6609.66,-4409.33"/>
</g>
<!-- l0_out_proj_tp7&#45;&gt;l0_residual_tp7 -->
<g id="edge228" class="edge">
<title>l0_out_proj_tp7&#45;&gt;l0_residual_tp7</title>
<path fill="none" stroke="black" d="M6713.32,-4363.67C7154.47,-4361.31 8884.14,-4348.88 10305,-4294.17 10605.49,-4282.6 10949.61,-4261.59 11183.11,-4246.17"/>
<polygon fill="black" stroke="black" points="11183.36,-4249.66 11193.11,-4245.51 11182.9,-4242.68 11183.36,-4249.66"/>
</g>
<!-- l0_gate_tp7 -->
<g id="node41" class="node">
<title>l0_gate_tp7</title>
<polygon fill="lightyellow" stroke="black" points="11832.2,-4121.17 11502.59,-4121.17 11417.8,-3985.17 11747.41,-3985.17 11832.2,-4121.17"/>
<text text-anchor="middle" x="11625" y="-4071.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="11625" y="-4056.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="11625" y="-4041.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="11625" y="-4026.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l0_residual_tp7&#45;&gt;l0_gate_tp7 -->
<g id="edge230" class="edge">
<title>l0_residual_tp7&#45;&gt;l0_gate_tp7</title>
<path fill="none" stroke="black" d="M11523.52,-4158.07C11532.92,-4148.46 11542.63,-4138.51 11552.15,-4128.76"/>
<polygon fill="black" stroke="black" points="11554.91,-4130.95 11559.39,-4121.35 11549.9,-4126.06 11554.91,-4130.95"/>
</g>
<!-- l0_exp0_gpu7 -->
<g id="node112" class="node">
<title>l0_exp0_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="11466,-3948.17 11292,-3948.17 11292,-3880.17 11466,-3880.17 11466,-3948.17"/>
<text text-anchor="middle" x="11379" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="11379" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11379" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11379" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l0_residual_tp7&#45;&gt;l0_exp0_gpu7 -->
<g id="edge232" class="edge">
<title>l0_residual_tp7&#45;&gt;l0_exp0_gpu7</title>
<path fill="none" stroke="black" d="M11402.3,-4158.05C11399.09,-4152.22 11396.25,-4146.23 11394,-4140.17 11371.68,-4080.12 11371.76,-4004.92 11374.73,-3958.46"/>
<polygon fill="black" stroke="black" points="11378.22,-3958.65 11375.44,-3948.43 11371.24,-3958.16 11378.22,-3958.65"/>
</g>
<!-- l0_exp1_gpu7 -->
<g id="node113" class="node">
<title>l0_exp1_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="11274,-3948.17 11100,-3948.17 11100,-3880.17 11274,-3880.17 11274,-3948.17"/>
<text text-anchor="middle" x="11187" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="11187" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11187" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11187" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l0_residual_tp7&#45;&gt;l0_exp1_gpu7 -->
<g id="edge235" class="edge">
<title>l0_residual_tp7&#45;&gt;l0_exp1_gpu7</title>
<path fill="none" stroke="black" d="M11399.2,-4157.9C11345.45,-4096.42 11267.69,-4007.47 11222.75,-3956.06"/>
<polygon fill="black" stroke="black" points="11225.31,-3953.68 11216.1,-3948.45 11220.04,-3958.28 11225.31,-3953.68"/>
</g>
<!-- l0_exp2_gpu7 -->
<g id="node114" class="node">
<title>l0_exp2_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="11082,-3948.17 10908,-3948.17 10908,-3880.17 11082,-3880.17 11082,-3948.17"/>
<text text-anchor="middle" x="10995" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="10995" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10995" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10995" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l0_residual_tp7&#45;&gt;l0_exp2_gpu7 -->
<g id="edge238" class="edge">
<title>l0_residual_tp7&#45;&gt;l0_exp2_gpu7</title>
<path fill="none" stroke="black" d="M11308.13,-4158.03C11286.15,-4146.56 11264.15,-4134.13 11244,-4121.17 11165.85,-4070.88 11084.59,-3999.43 11036.96,-3955.25"/>
<polygon fill="black" stroke="black" points="11039.31,-3952.66 11029.61,-3948.4 11034.54,-3957.78 11039.31,-3952.66"/>
</g>
<!-- l0_exp3_gpu7 -->
<g id="node115" class="node">
<title>l0_exp3_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="11658,-3948.17 11484,-3948.17 11484,-3880.17 11658,-3880.17 11658,-3948.17"/>
<text text-anchor="middle" x="11571" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="11571" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11571" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11571" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l0_residual_tp7&#45;&gt;l0_exp3_gpu7 -->
<g id="edge241" class="edge">
<title>l0_residual_tp7&#45;&gt;l0_exp3_gpu7</title>
<path fill="none" stroke="black" d="M11419.25,-4158C11395.35,-4106.85 11375.13,-4036.7 11409,-3985.17 11413.48,-3978.35 11442.26,-3965.09 11474.36,-3951.93"/>
<polygon fill="black" stroke="black" points="11475.99,-3955.05 11483.94,-3948.04 11473.36,-3948.56 11475.99,-3955.05"/>
</g>
<!-- l0_exp4_gpu7 -->
<g id="node116" class="node">
<title>l0_exp4_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="12234,-3948.17 12060,-3948.17 12060,-3880.17 12234,-3880.17 12234,-3948.17"/>
<text text-anchor="middle" x="12147" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="12147" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="12147" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="12147" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l0_residual_tp7&#45;&gt;l0_exp4_gpu7 -->
<g id="edge244" class="edge">
<title>l0_residual_tp7&#45;&gt;l0_exp4_gpu7</title>
<path fill="none" stroke="black" d="M11705.48,-4190.88C11771.25,-4175.47 11840.48,-4153.22 11900,-4121.17 11982.6,-4076.68 12063.17,-4001.86 12108.79,-3955.68"/>
<polygon fill="black" stroke="black" points="12111.31,-3958.11 12115.81,-3948.52 12106.31,-3953.21 12111.31,-3958.11"/>
</g>
<!-- l0_exp5_gpu7 -->
<g id="node117" class="node">
<title>l0_exp5_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="12426,-3948.17 12252,-3948.17 12252,-3880.17 12426,-3880.17 12426,-3948.17"/>
<text text-anchor="middle" x="12339" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="12339" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="12339" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="12339" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l0_residual_tp7&#45;&gt;l0_exp5_gpu7 -->
<g id="edge247" class="edge">
<title>l0_residual_tp7&#45;&gt;l0_exp5_gpu7</title>
<path fill="none" stroke="black" d="M11709.83,-4194.77C11801.26,-4178.96 11904.12,-4155.51 11994,-4121.17 12105.17,-4078.69 12221.37,-4001.35 12286.54,-3954.47"/>
<polygon fill="black" stroke="black" points="12288.95,-3957.05 12295,-3948.35 12284.85,-3951.37 12288.95,-3957.05"/>
</g>
<!-- l0_exp6_gpu7 -->
<g id="node118" class="node">
<title>l0_exp6_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="12042,-3948.17 11868,-3948.17 11868,-3880.17 12042,-3880.17 12042,-3948.17"/>
<text text-anchor="middle" x="11955" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="11955" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11955" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11955" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l0_residual_tp7&#45;&gt;l0_exp6_gpu7 -->
<g id="edge250" class="edge">
<title>l0_residual_tp7&#45;&gt;l0_exp6_gpu7</title>
<path fill="none" stroke="black" d="M11698.68,-4184.54C11768.77,-4168.06 11832.99,-4146.8 11857,-4121.17 11901.17,-4074 11928.85,-4003.28 11943.11,-3958.19"/>
<polygon fill="black" stroke="black" points="11946.52,-3959 11946.12,-3948.41 11939.83,-3956.94 11946.52,-3959"/>
</g>
<!-- l0_exp7_gpu7 -->
<g id="node119" class="node">
<title>l0_exp7_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="11850,-3948.17 11676,-3948.17 11676,-3880.17 11850,-3880.17 11850,-3948.17"/>
<text text-anchor="middle" x="11763" y="-3932.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="11763" y="-3917.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11763" y="-3902.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11763" y="-3887.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l0_residual_tp7&#45;&gt;l0_exp7_gpu7 -->
<g id="edge253" class="edge">
<title>l0_residual_tp7&#45;&gt;l0_exp7_gpu7</title>
<path fill="none" stroke="black" d="M11698.58,-4184.29C11763.4,-4168.13 11821.15,-4147.13 11841,-4121.17 11877.72,-4073.15 11865.63,-4040.37 11841,-3985.17 11836.08,-3974.13 11828.46,-3964.11 11819.88,-3955.32"/>
<polygon fill="black" stroke="black" points="11822.12,-3952.63 11812.48,-3948.23 11817.28,-3957.68 11822.12,-3952.63"/>
</g>
<!-- l0_final_res_tp7 -->
<g id="node121" class="node">
<title>l0_final_res_tp7</title>
<polygon fill="lightyellow" stroke="black" points="12235.93,-3670.17 11664.95,-3670.17 11518.07,-3534.17 12089.05,-3534.17 12235.93,-3670.17"/>
<text text-anchor="middle" x="11877" y="-3620.97" font-family="Times,serif" font-size="14.00">Layer 0 Final Residual</text>
<text text-anchor="middle" x="11877" y="-3605.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="11877" y="-3590.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="11877" y="-3575.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l0_residual_tp7&#45;&gt;l0_final_res_tp7 -->
<g id="edge256" class="edge">
<title>l0_residual_tp7&#45;&gt;l0_final_res_tp7</title>
<path fill="none" stroke="black" d="M11720.88,-4204.94C12013.27,-4178.82 12445,-4127.78 12445,-4054.17 12445,-4054.17 12445,-4054.17 12445,-3774.17 12445,-3718.14 12342.37,-3678.84 12224.37,-3652.18"/>
<polygon fill="black" stroke="black" points="12224.9,-3648.71 12214.38,-3649.96 12223.39,-3655.55 12224.9,-3648.71"/>
</g>
<!-- l0_gate_tp0&#45;&gt;l0_exp0_gpu0 -->
<g id="edge7" class="edge">
<title>l0_gate_tp0&#45;&gt;l0_exp0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M898.47,-3984.87C894.83,-3975.63 891.18,-3966.35 887.78,-3957.73"/>
<polygon fill="black" stroke="black" points="890.98,-3956.31 884.06,-3948.29 884.47,-3958.88 890.98,-3956.31"/>
</g>
<!-- l0_gate_tp0&#45;&gt;l0_exp1_gpu0 -->
<g id="edge10" class="edge">
<title>l0_gate_tp0&#45;&gt;l0_exp1_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M804.52,-3985.07C784.93,-3974.16 765.25,-3963.2 747.48,-3953.3"/>
<polygon fill="black" stroke="black" points="748.81,-3950.04 738.37,-3948.23 745.4,-3956.15 748.81,-3950.04"/>
</g>
<!-- l0_gate_tp0&#45;&gt;l0_exp2_gpu0 -->
<g id="edge13" class="edge">
<title>l0_gate_tp0&#45;&gt;l0_exp2_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M749.42,-4036.4C603.82,-4021.13 391.75,-3993.83 200.15,-3948.3"/>
<polygon fill="black" stroke="black" points="200.71,-3944.84 190.17,-3945.91 199.08,-3951.65 200.71,-3944.84"/>
</g>
<!-- l0_gate_tp0&#45;&gt;l0_exp3_gpu0 -->
<g id="edge16" class="edge">
<title>l0_gate_tp0&#45;&gt;l0_exp3_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M736.51,-4015.5C600.6,-3989.05 434.91,-3956.8 392.23,-3947.92"/>
<polygon fill="black" stroke="black" points="392.74,-3944.45 382.22,-3945.72 391.24,-3951.28 392.74,-3944.45"/>
</g>
<!-- l0_gate_tp0&#45;&gt;l0_exp4_gpu0 -->
<g id="edge19" class="edge">
<title>l0_gate_tp0&#45;&gt;l0_exp4_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M721.63,-3991.63C678.69,-3978.51 633.55,-3964.46 583.76,-3948.39"/>
<polygon fill="black" stroke="black" points="584.67,-3945 574.08,-3945.25 582.51,-3951.66 584.67,-3945"/>
</g>
<!-- l0_gate_tp0&#45;&gt;l0_exp5_gpu0 -->
<g id="edge22" class="edge">
<title>l0_gate_tp0&#45;&gt;l0_exp5_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1055.42,-3998.02C1092.48,-3982.64 1131.96,-3966.25 1165.95,-3952.13"/>
<polygon fill="black" stroke="black" points="1167.49,-3955.29 1175.39,-3948.22 1164.81,-3948.82 1167.49,-3955.29"/>
</g>
<!-- l0_gate_tp0&#45;&gt;l0_exp6_gpu0 -->
<g id="edge25" class="edge">
<title>l0_gate_tp0&#45;&gt;l0_exp6_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1069.82,-4020.28C1149.99,-4001.8 1251.44,-3977.03 1350.14,-3948.34"/>
<polygon fill="black" stroke="black" points="1351.37,-3951.63 1359.99,-3945.46 1349.41,-3944.91 1351.37,-3951.63"/>
</g>
<!-- l0_gate_tp0&#45;&gt;l0_exp7_gpu0 -->
<g id="edge28" class="edge">
<title>l0_gate_tp0&#45;&gt;l0_exp7_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M992.79,-3984.87C1002.9,-3974.83 1013.05,-3964.76 1022.36,-3955.51"/>
<polygon fill="black" stroke="black" points="1025,-3957.82 1029.63,-3948.29 1020.07,-3952.86 1025,-3957.82"/>
</g>
<!-- l0_gate_tp1&#45;&gt;l0_exp0_gpu1 -->
<g id="edge39" class="edge">
<title>l0_gate_tp1&#45;&gt;l0_exp0_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2341.04,-3984.97C2332.32,-3978.51 2323.53,-3972.15 2315,-3966.17 2309.16,-3962.07 2303,-3957.9 2296.81,-3953.8"/>
<polygon fill="black" stroke="black" points="2298.64,-3950.82 2288.36,-3948.27 2294.8,-3956.68 2298.64,-3950.82"/>
</g>
<!-- l0_gate_tp1&#45;&gt;l0_exp1_gpu1 -->
<g id="edge42" class="edge">
<title>l0_gate_tp1&#45;&gt;l0_exp1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2561.57,-4004.15C2611.83,-3986.22 2667.87,-3966.23 2714.08,-3949.74"/>
<polygon fill="black" stroke="black" points="2715.54,-3952.94 2723.79,-3946.28 2713.19,-3946.35 2715.54,-3952.94"/>
</g>
<!-- l0_gate_tp1&#45;&gt;l0_exp2_gpu1 -->
<g id="edge45" class="edge">
<title>l0_gate_tp1&#45;&gt;l0_exp2_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2238.94,-3985.07C2204.64,-3972.84 2170.18,-3960.54 2139.93,-3949.75"/>
<polygon fill="black" stroke="black" points="2140.86,-3946.36 2130.26,-3946.3 2138.51,-3952.96 2140.86,-3946.36"/>
</g>
<!-- l0_gate_tp1&#45;&gt;l0_exp3_gpu1 -->
<g id="edge48" class="edge">
<title>l0_gate_tp1&#45;&gt;l0_exp3_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2230.28,-4002.53C2176.54,-3989.8 2118.19,-3976.74 2064,-3966.17 2015.29,-3956.66 1999.82,-3960.29 1947.93,-3948.22"/>
<polygon fill="black" stroke="black" points="1948.72,-3944.81 1938.18,-3945.87 1947.08,-3951.62 1948.72,-3944.81"/>
</g>
<!-- l0_gate_tp1&#45;&gt;l0_exp4_gpu1 -->
<g id="edge51" class="edge">
<title>l0_gate_tp1&#45;&gt;l0_exp4_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2249.86,-4033.46C2115.9,-4017.27 1927.74,-3990.13 1755.91,-3948.26"/>
<polygon fill="black" stroke="black" points="1756.73,-3944.86 1746.18,-3945.87 1755.06,-3951.65 1756.73,-3944.86"/>
</g>
<!-- l0_gate_tp1&#45;&gt;l0_exp5_gpu1 -->
<g id="edge54" class="edge">
<title>l0_gate_tp1&#45;&gt;l0_exp5_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2574.36,-4024.91C2667.28,-4006.61 2789.73,-3980.45 2905.97,-3948.36"/>
<polygon fill="black" stroke="black" points="2907.06,-3951.69 2915.76,-3945.64 2905.19,-3944.95 2907.06,-3951.69"/>
</g>
<!-- l0_gate_tp1&#45;&gt;l0_exp6_gpu1 -->
<g id="edge57" class="edge">
<title>l0_gate_tp1&#45;&gt;l0_exp6_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2521.03,-3985.07C2535.82,-3974.52 2550.68,-3963.92 2564.19,-3954.28"/>
<polygon fill="black" stroke="black" points="2566.31,-3957.06 2572.42,-3948.41 2562.24,-3951.36 2566.31,-3957.06"/>
</g>
<!-- l0_gate_tp1&#45;&gt;l0_exp7_gpu1 -->
<g id="edge60" class="edge">
<title>l0_gate_tp1&#45;&gt;l0_exp7_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2427,-3984.87C2427,-3975.93 2427,-3966.95 2427,-3958.56"/>
<polygon fill="black" stroke="black" points="2430.5,-3958.29 2427,-3948.29 2423.5,-3958.29 2430.5,-3958.29"/>
</g>
<!-- l0_gate_tp2&#45;&gt;l0_exp0_gpu2 -->
<g id="edge71" class="edge">
<title>l0_gate_tp2&#45;&gt;l0_exp0_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3861.42,-4036.4C3715.82,-4021.13 3503.75,-3993.83 3312.15,-3948.3"/>
<polygon fill="black" stroke="black" points="3312.71,-3944.84 3302.17,-3945.91 3311.08,-3951.65 3312.71,-3944.84"/>
</g>
<!-- l0_gate_tp2&#45;&gt;l0_exp1_gpu2 -->
<g id="edge74" class="edge">
<title>l0_gate_tp2&#45;&gt;l0_exp1_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3916.52,-3985.07C3896.93,-3974.16 3877.25,-3963.2 3859.48,-3953.3"/>
<polygon fill="black" stroke="black" points="3860.81,-3950.04 3850.37,-3948.23 3857.4,-3956.15 3860.81,-3950.04"/>
</g>
<!-- l0_gate_tp2&#45;&gt;l0_exp2_gpu2 -->
<g id="edge77" class="edge">
<title>l0_gate_tp2&#45;&gt;l0_exp2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4010.47,-3984.87C4006.83,-3975.63 4003.18,-3966.35 3999.78,-3957.73"/>
<polygon fill="black" stroke="black" points="4002.98,-3956.31 3996.06,-3948.29 3996.47,-3958.88 4002.98,-3956.31"/>
</g>
<!-- l0_gate_tp2&#45;&gt;l0_exp3_gpu2 -->
<g id="edge80" class="edge">
<title>l0_gate_tp2&#45;&gt;l0_exp3_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3838.41,-3999.13C3787.39,-3986.9 3732.4,-3974.93 3681,-3966.17 3605.68,-3953.32 3582.47,-3964.27 3503.99,-3948.17"/>
<polygon fill="black" stroke="black" points="3504.64,-3944.73 3494.13,-3946.07 3503.18,-3951.58 3504.64,-3944.73"/>
</g>
<!-- l0_gate_tp2&#45;&gt;l0_exp4_gpu2 -->
<g id="edge83" class="edge">
<title>l0_gate_tp2&#45;&gt;l0_exp4_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3850.42,-3985.15C3828.83,-3978.31 3807.02,-3971.82 3786,-3966.17 3748.99,-3956.21 3736.55,-3958.48 3695.94,-3948.26"/>
<polygon fill="black" stroke="black" points="3696.78,-3944.86 3686.22,-3945.71 3695.01,-3951.63 3696.78,-3944.86"/>
</g>
<!-- l0_gate_tp2&#45;&gt;l0_exp5_gpu2 -->
<g id="edge86" class="edge">
<title>l0_gate_tp2&#45;&gt;l0_exp5_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4104.79,-3984.87C4114.9,-3974.83 4125.05,-3964.76 4134.36,-3955.51"/>
<polygon fill="black" stroke="black" points="4137,-3957.82 4141.63,-3948.29 4132.07,-3952.86 4137,-3957.82"/>
</g>
<!-- l0_gate_tp2&#45;&gt;l0_exp6_gpu2 -->
<g id="edge89" class="edge">
<title>l0_gate_tp2&#45;&gt;l0_exp6_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4181.82,-4020.28C4261.99,-4001.8 4363.44,-3977.03 4462.14,-3948.34"/>
<polygon fill="black" stroke="black" points="4463.37,-3951.63 4471.99,-3945.46 4461.41,-3944.91 4463.37,-3951.63"/>
</g>
<!-- l0_gate_tp2&#45;&gt;l0_exp7_gpu2 -->
<g id="edge92" class="edge">
<title>l0_gate_tp2&#45;&gt;l0_exp7_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4167.42,-3998.02C4204.48,-3982.64 4243.96,-3966.25 4277.95,-3952.13"/>
<polygon fill="black" stroke="black" points="4279.49,-3955.29 4287.39,-3948.22 4276.81,-3948.82 4279.49,-3955.29"/>
</g>
<!-- l0_gate_tp3&#45;&gt;l0_exp0_gpu3 -->
<g id="edge103" class="edge">
<title>l0_gate_tp3&#45;&gt;l0_exp0_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5286.16,-3999.17C5241.48,-3987.8 5194.21,-3976.21 5150,-3966.17 5112.62,-3957.68 5100.5,-3958.69 5059.94,-3948.28"/>
<polygon fill="black" stroke="black" points="5060.78,-3944.88 5050.22,-3945.71 5059,-3951.65 5060.78,-3944.88"/>
</g>
<!-- l0_gate_tp3&#45;&gt;l0_exp1_gpu3 -->
<g id="edge106" class="edge">
<title>l0_gate_tp3&#45;&gt;l0_exp1_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5305.56,-4029.92C5184.01,-4012.96 5020,-3986.39 4868.18,-3948.34"/>
<polygon fill="black" stroke="black" points="4868.75,-3944.88 4858.19,-3945.82 4867.03,-3951.66 4868.75,-3944.88"/>
</g>
<!-- l0_gate_tp3&#45;&gt;l0_exp2_gpu3 -->
<g id="edge109" class="edge">
<title>l0_gate_tp3&#45;&gt;l0_exp2_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5634.74,-4028.73C5739.86,-4010.92 5883.6,-3983.86 6017.73,-3948.4"/>
<polygon fill="black" stroke="black" points="6019.02,-3951.68 6027.78,-3945.72 6017.22,-3944.91 6019.02,-3951.68"/>
</g>
<!-- l0_gate_tp3&#45;&gt;l0_exp3_gpu3 -->
<g id="edge112" class="edge">
<title>l0_gate_tp3&#45;&gt;l0_exp3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5605.48,-3985.07C5625.07,-3974.16 5644.75,-3963.2 5662.52,-3953.3"/>
<polygon fill="black" stroke="black" points="5664.6,-3956.15 5671.63,-3948.23 5661.19,-3950.04 5664.6,-3956.15"/>
</g>
<!-- l0_gate_tp3&#45;&gt;l0_exp4_gpu3 -->
<g id="edge115" class="edge">
<title>l0_gate_tp3&#45;&gt;l0_exp4_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5323.38,-3985.07C5296.02,-3973.71 5268.52,-3962.3 5243.92,-3952.08"/>
<polygon fill="black" stroke="black" points="5245.22,-3948.83 5234.64,-3948.23 5242.53,-3955.3 5245.22,-3948.83"/>
</g>
<!-- l0_gate_tp3&#45;&gt;l0_exp5_gpu3 -->
<g id="edge118" class="edge">
<title>l0_gate_tp3&#45;&gt;l0_exp5_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5417.21,-3984.87C5407.1,-3974.83 5396.95,-3964.76 5387.64,-3955.51"/>
<polygon fill="black" stroke="black" points="5389.93,-3952.86 5380.37,-3948.29 5385,-3957.82 5389.93,-3952.86"/>
</g>
<!-- l0_gate_tp3&#45;&gt;l0_exp6_gpu3 -->
<g id="edge121" class="edge">
<title>l0_gate_tp3&#45;&gt;l0_exp6_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5623.88,-4011.17C5683.48,-3993.27 5754.07,-3971.67 5826.2,-3948.4"/>
<polygon fill="black" stroke="black" points="5827.49,-3951.66 5835.92,-3945.25 5825.33,-3945 5827.49,-3951.66"/>
</g>
<!-- l0_gate_tp3&#45;&gt;l0_exp7_gpu3 -->
<g id="edge124" class="edge">
<title>l0_gate_tp3&#45;&gt;l0_exp7_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5511.53,-3984.87C5515.17,-3975.63 5518.82,-3966.35 5522.22,-3957.73"/>
<polygon fill="black" stroke="black" points="5525.53,-3958.88 5525.94,-3948.29 5519.02,-3956.31 5525.53,-3958.88"/>
</g>
<!-- l0_gate_tp4&#45;&gt;l0_exp0_gpu4 -->
<g id="edge135" class="edge">
<title>l0_gate_tp4&#45;&gt;l0_exp0_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7000.97,-3985.07C6986.18,-3974.52 6971.32,-3963.92 6957.81,-3954.28"/>
<polygon fill="black" stroke="black" points="6959.76,-3951.36 6949.58,-3948.41 6955.69,-3957.06 6959.76,-3951.36"/>
</g>
<!-- l0_gate_tp4&#45;&gt;l0_exp1_gpu4 -->
<g id="edge138" class="edge">
<title>l0_gate_tp4&#45;&gt;l0_exp1_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6917.86,-4033.46C6783.9,-4017.27 6595.74,-3990.13 6423.91,-3948.26"/>
<polygon fill="black" stroke="black" points="6424.73,-3944.86 6414.18,-3945.87 6423.06,-3951.65 6424.73,-3944.86"/>
</g>
<!-- l0_gate_tp4&#45;&gt;l0_exp2_gpu4 -->
<g id="edge141" class="edge">
<title>l0_gate_tp4&#45;&gt;l0_exp2_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7095,-3984.87C7095,-3975.93 7095,-3966.95 7095,-3958.56"/>
<polygon fill="black" stroke="black" points="7098.5,-3958.29 7095,-3948.29 7091.5,-3958.29 7098.5,-3958.29"/>
</g>
<!-- l0_gate_tp4&#45;&gt;l0_exp3_gpu4 -->
<g id="edge144" class="edge">
<title>l0_gate_tp4&#45;&gt;l0_exp3_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7229.57,-4004.15C7279.83,-3986.22 7335.87,-3966.23 7382.08,-3949.74"/>
<polygon fill="black" stroke="black" points="7383.54,-3952.94 7391.79,-3946.28 7381.19,-3946.35 7383.54,-3952.94"/>
</g>
<!-- l0_gate_tp4&#45;&gt;l0_exp4_gpu4 -->
<g id="edge147" class="edge">
<title>l0_gate_tp4&#45;&gt;l0_exp4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7189.03,-3985.07C7203.82,-3974.52 7218.68,-3963.92 7232.19,-3954.28"/>
<polygon fill="black" stroke="black" points="7234.31,-3957.06 7240.42,-3948.41 7230.24,-3951.36 7234.31,-3957.06"/>
</g>
<!-- l0_gate_tp4&#45;&gt;l0_exp5_gpu4 -->
<g id="edge150" class="edge">
<title>l0_gate_tp4&#45;&gt;l0_exp5_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6899.53,-4004.58C6842.75,-3991.41 6780.54,-3977.6 6723,-3966.17 6678.16,-3957.26 6663.89,-3959.75 6615.91,-3948.23"/>
<polygon fill="black" stroke="black" points="6616.74,-3944.83 6606.19,-3945.83 6615.06,-3951.63 6616.74,-3944.83"/>
</g>
<!-- l0_gate_tp4&#45;&gt;l0_exp6_gpu4 -->
<g id="edge153" class="edge">
<title>l0_gate_tp4&#45;&gt;l0_exp6_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6906.94,-3985.07C6872.64,-3972.84 6838.18,-3960.54 6807.93,-3949.75"/>
<polygon fill="black" stroke="black" points="6808.86,-3946.36 6798.26,-3946.3 6806.51,-3952.96 6808.86,-3946.36"/>
</g>
<!-- l0_gate_tp4&#45;&gt;l0_exp7_gpu4 -->
<g id="edge156" class="edge">
<title>l0_gate_tp4&#45;&gt;l0_exp7_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7242.36,-4024.91C7335.28,-4006.61 7457.73,-3980.45 7573.97,-3948.36"/>
<polygon fill="black" stroke="black" points="7575.06,-3951.69 7583.76,-3945.64 7573.19,-3944.95 7575.06,-3951.69"/>
</g>
<!-- l0_gate_tp5&#45;&gt;l0_exp0_gpu5 -->
<g id="edge167" class="edge">
<title>l0_gate_tp5&#45;&gt;l0_exp0_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8392.52,-3985.07C8372.93,-3974.16 8353.25,-3963.2 8335.48,-3953.3"/>
<polygon fill="black" stroke="black" points="8336.81,-3950.04 8326.37,-3948.23 8333.4,-3956.15 8336.81,-3950.04"/>
</g>
<!-- l0_gate_tp5&#45;&gt;l0_exp1_gpu5 -->
<g id="edge170" class="edge">
<title>l0_gate_tp5&#45;&gt;l0_exp1_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8309.63,-3991.63C8266.69,-3978.51 8221.55,-3964.46 8171.76,-3948.39"/>
<polygon fill="black" stroke="black" points="8172.67,-3945 8162.08,-3945.25 8170.51,-3951.66 8172.67,-3945"/>
</g>
<!-- l0_gate_tp5&#45;&gt;l0_exp2_gpu5 -->
<g id="edge173" class="edge">
<title>l0_gate_tp5&#45;&gt;l0_exp2_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8486.47,-3984.87C8482.83,-3975.63 8479.18,-3966.35 8475.78,-3957.73"/>
<polygon fill="black" stroke="black" points="8478.98,-3956.31 8472.06,-3948.29 8472.47,-3958.88 8478.98,-3956.31"/>
</g>
<!-- l0_gate_tp5&#45;&gt;l0_exp3_gpu5 -->
<g id="edge176" class="edge">
<title>l0_gate_tp5&#45;&gt;l0_exp3_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8654.01,-4014.3C8713.95,-3998.66 8784.71,-3980.81 8849,-3966.17 8885.9,-3957.76 8897.9,-3958.63 8937.9,-3948.32"/>
<polygon fill="black" stroke="black" points="8939.01,-3951.65 8947.78,-3945.7 8937.21,-3944.88 8939.01,-3951.65"/>
</g>
<!-- l0_gate_tp5&#45;&gt;l0_exp4_gpu5 -->
<g id="edge179" class="edge">
<title>l0_gate_tp5&#45;&gt;l0_exp4_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8643.42,-3998.02C8680.48,-3982.64 8719.96,-3966.25 8753.95,-3952.13"/>
<polygon fill="black" stroke="black" points="8755.49,-3955.29 8763.39,-3948.22 8752.81,-3948.82 8755.49,-3955.29"/>
</g>
<!-- l0_gate_tp5&#45;&gt;l0_exp5_gpu5 -->
<g id="edge182" class="edge">
<title>l0_gate_tp5&#45;&gt;l0_exp5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8580.79,-3984.87C8590.9,-3974.83 8601.05,-3964.76 8610.36,-3955.51"/>
<polygon fill="black" stroke="black" points="8613,-3957.82 8617.63,-3948.29 8608.07,-3952.86 8613,-3957.82"/>
</g>
<!-- l0_gate_tp5&#45;&gt;l0_exp6_gpu5 -->
<g id="edge185" class="edge">
<title>l0_gate_tp5&#45;&gt;l0_exp6_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8329.29,-4022.88C8228.37,-4005.21 8101.1,-3980.37 7980.04,-3948.34"/>
<polygon fill="black" stroke="black" points="7980.78,-3944.92 7970.22,-3945.72 7978.98,-3951.68 7980.78,-3944.92"/>
</g>
<!-- l0_gate_tp5&#45;&gt;l0_exp7_gpu5 -->
<g id="edge188" class="edge">
<title>l0_gate_tp5&#45;&gt;l0_exp7_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8663.34,-4029.77C8811.87,-4007.14 9029.81,-3972.46 9129.92,-3948.27"/>
<polygon fill="black" stroke="black" points="9130.94,-3951.62 9139.81,-3945.82 9129.26,-3944.83 9130.94,-3951.62"/>
</g>
<!-- l0_gate_tp6&#45;&gt;l0_exp0_gpu6 -->
<g id="edge199" class="edge">
<title>l0_gate_tp6&#45;&gt;l0_exp0_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9978.78,-4006.42C9923.01,-3993.35 9862.11,-3979.13 9806,-3966.17 9773.79,-3958.72 9763.33,-3958.09 9728.27,-3948.42"/>
<polygon fill="black" stroke="black" points="9728.83,-3944.94 9718.25,-3945.6 9726.93,-3951.68 9728.83,-3944.94"/>
</g>
<!-- l0_gate_tp6&#45;&gt;l0_exp1_gpu6 -->
<g id="edge202" class="edge">
<title>l0_gate_tp6&#45;&gt;l0_exp1_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10001.59,-3985.07C9972.43,-3973.66 9943.15,-3962.2 9916.96,-3951.95"/>
<polygon fill="black" stroke="black" points="9918.05,-3948.61 9907.46,-3948.23 9915.5,-3955.13 9918.05,-3948.61"/>
</g>
<!-- l0_gate_tp6&#45;&gt;l0_exp2_gpu6 -->
<g id="edge205" class="edge">
<title>l0_gate_tp6&#45;&gt;l0_exp2_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9994.31,-4031.29C9868.11,-4014.59 9695.31,-3987.78 9536.17,-3948.33"/>
<polygon fill="black" stroke="black" points="9536.74,-3944.87 9526.19,-3945.84 9535.04,-3951.66 9536.74,-3944.87"/>
</g>
<!-- l0_gate_tp6&#45;&gt;l0_exp3_gpu6 -->
<g id="edge208" class="edge">
<title>l0_gate_tp6&#45;&gt;l0_exp3_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10095.39,-3984.87C10083.58,-3974.63 10071.73,-3964.36 10060.9,-3954.97"/>
<polygon fill="black" stroke="black" points="10063.05,-3952.2 10053.21,-3948.29 10058.47,-3957.49 10063.05,-3952.2"/>
</g>
<!-- l0_gate_tp6&#45;&gt;l0_exp4_gpu6 -->
<g id="edge211" class="edge">
<title>l0_gate_tp6&#45;&gt;l0_exp4_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10321.82,-4027.4C10422.48,-4009.38 10558.33,-3982.61 10685.83,-3948.38"/>
<polygon fill="black" stroke="black" points="10687.03,-3951.68 10695.77,-3945.69 10685.21,-3944.93 10687.03,-3951.68"/>
</g>
<!-- l0_gate_tp6&#45;&gt;l0_exp5_gpu6 -->
<g id="edge214" class="edge">
<title>l0_gate_tp6&#45;&gt;l0_exp5_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10189.7,-3984.87C10191.97,-3975.73 10194.25,-3966.55 10196.37,-3958.01"/>
<polygon fill="black" stroke="black" points="10199.77,-3958.84 10198.78,-3948.29 10192.97,-3957.16 10199.77,-3958.84"/>
</g>
<!-- l0_gate_tp6&#45;&gt;l0_exp6_gpu6 -->
<g id="edge217" class="edge">
<title>l0_gate_tp6&#45;&gt;l0_exp6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10310.28,-4008.45C10364.8,-3990.94 10428.27,-3970.35 10494.16,-3948.43"/>
<polygon fill="black" stroke="black" points="10495.52,-3951.67 10503.9,-3945.19 10493.31,-3945.03 10495.52,-3951.67"/>
</g>
<!-- l0_gate_tp6&#45;&gt;l0_exp7_gpu6 -->
<g id="edge220" class="edge">
<title>l0_gate_tp6&#45;&gt;l0_exp7_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10283.68,-3985.07C10301.52,-3974.26 10319.43,-3963.4 10335.64,-3953.57"/>
<polygon fill="black" stroke="black" points="10337.72,-3956.41 10344.46,-3948.23 10334.09,-3950.42 10337.72,-3956.41"/>
</g>
<!-- l0_gate_tp7&#45;&gt;l0_exp0_gpu7 -->
<g id="edge231" class="edge">
<title>l0_gate_tp7&#45;&gt;l0_exp0_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11504.52,-3985.07C11484.93,-3974.16 11465.25,-3963.2 11447.48,-3953.3"/>
<polygon fill="black" stroke="black" points="11448.81,-3950.04 11438.37,-3948.23 11445.4,-3956.15 11448.81,-3950.04"/>
</g>
<!-- l0_gate_tp7&#45;&gt;l0_exp1_gpu7 -->
<g id="edge234" class="edge">
<title>l0_gate_tp7&#45;&gt;l0_exp1_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11421.63,-3991.63C11378.69,-3978.51 11333.55,-3964.46 11283.76,-3948.39"/>
<polygon fill="black" stroke="black" points="11284.67,-3945 11274.08,-3945.25 11282.51,-3951.66 11284.67,-3945"/>
</g>
<!-- l0_gate_tp7&#45;&gt;l0_exp2_gpu7 -->
<g id="edge237" class="edge">
<title>l0_gate_tp7&#45;&gt;l0_exp2_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11441.29,-4022.88C11340.37,-4005.21 11213.1,-3980.37 11092.04,-3948.34"/>
<polygon fill="black" stroke="black" points="11092.78,-3944.92 11082.22,-3945.72 11090.98,-3951.68 11092.78,-3944.92"/>
</g>
<!-- l0_gate_tp7&#45;&gt;l0_exp3_gpu7 -->
<g id="edge240" class="edge">
<title>l0_gate_tp7&#45;&gt;l0_exp3_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11598.47,-3984.87C11594.83,-3975.63 11591.18,-3966.35 11587.78,-3957.73"/>
<polygon fill="black" stroke="black" points="11590.98,-3956.31 11584.06,-3948.29 11584.47,-3958.88 11590.98,-3956.31"/>
</g>
<!-- l0_gate_tp7&#45;&gt;l0_exp4_gpu7 -->
<g id="edge243" class="edge">
<title>l0_gate_tp7&#45;&gt;l0_exp4_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11767.09,-4016.31C11829.84,-4000.64 11904.52,-3982.21 11972,-3966.17 12004.16,-3958.52 12014.66,-3958.06 12049.73,-3948.42"/>
<polygon fill="black" stroke="black" points="12051.07,-3951.68 12059.75,-3945.6 12049.17,-3944.94 12051.07,-3951.68"/>
</g>
<!-- l0_gate_tp7&#45;&gt;l0_exp5_gpu7 -->
<g id="edge246" class="edge">
<title>l0_gate_tp7&#45;&gt;l0_exp5_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11777.88,-4033.56C11901.39,-4016.87 12079.43,-3989.05 12242.1,-3948.27"/>
<polygon fill="black" stroke="black" points="12242.97,-3951.66 12251.81,-3945.82 12241.25,-3944.88 12242.97,-3951.66"/>
</g>
<!-- l0_gate_tp7&#45;&gt;l0_exp6_gpu7 -->
<g id="edge249" class="edge">
<title>l0_gate_tp7&#45;&gt;l0_exp6_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11755.42,-3998.02C11792.48,-3982.64 11831.96,-3966.25 11865.95,-3952.13"/>
<polygon fill="black" stroke="black" points="11867.49,-3955.29 11875.39,-3948.22 11864.81,-3948.82 11867.49,-3955.29"/>
</g>
<!-- l0_gate_tp7&#45;&gt;l0_exp7_gpu7 -->
<g id="edge252" class="edge">
<title>l0_gate_tp7&#45;&gt;l0_exp7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11692.79,-3984.87C11702.9,-3974.83 11713.05,-3964.76 11722.36,-3955.51"/>
<polygon fill="black" stroke="black" points="11725,-3957.82 11729.63,-3948.29 11720.07,-3952.86 11725,-3957.82"/>
</g>
<!-- l0_exp_agg_tp0 -->
<g id="node50" class="node">
<title>l0_exp_agg_tp0</title>
<polygon fill="lightyellow" stroke="black" points="1090.58,-3843.17 741.28,-3843.17 651.42,-3707.17 1000.72,-3707.17 1090.58,-3843.17"/>
<text text-anchor="middle" x="871" y="-3793.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="871" y="-3778.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="871" y="-3763.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="871" y="-3748.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_exp0_gpu0&#45;&gt;l0_exp_agg_tp0 -->
<g id="edge9" class="edge">
<title>l0_exp0_gpu0&#45;&gt;l0_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M871,-3880C871,-3871.86 871,-3862.8 871,-3853.52"/>
<polygon fill="black" stroke="black" points="874.5,-3853.4 871,-3843.4 867.5,-3853.4 874.5,-3853.4"/>
</g>
<!-- l0_exp1_gpu0&#45;&gt;l0_exp_agg_tp0 -->
<g id="edge12" class="edge">
<title>l0_exp1_gpu0&#45;&gt;l0_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M725.48,-3880C738.59,-3870.65 753.39,-3860.08 768.42,-3849.36"/>
<polygon fill="black" stroke="black" points="770.67,-3852.06 776.78,-3843.4 766.6,-3846.36 770.67,-3852.06"/>
</g>
<!-- l0_exp2_gpu0&#45;&gt;l0_exp_agg_tp0 -->
<g id="edge15" class="edge">
<title>l0_exp2_gpu0&#45;&gt;l0_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M190.18,-3882.46C193.15,-3881.65 196.09,-3880.89 199,-3880.17 366.29,-3838.82 561.29,-3810.81 698.01,-3794.37"/>
<polygon fill="black" stroke="black" points="698.65,-3797.82 708.16,-3793.16 697.82,-3790.87 698.65,-3797.82"/>
</g>
<!-- l0_exp3_gpu0&#45;&gt;l0_exp_agg_tp0 -->
<g id="edge18" class="edge">
<title>l0_exp3_gpu0&#45;&gt;l0_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M382.24,-3882.69C385.19,-3881.82 388.11,-3880.97 391,-3880.17 494.61,-3851.24 612.66,-3825.57 705.77,-3806.97"/>
<polygon fill="black" stroke="black" points="706.72,-3810.35 715.85,-3804.96 705.35,-3803.48 706.72,-3810.35"/>
</g>
<!-- l0_exp4_gpu0&#45;&gt;l0_exp_agg_tp0 -->
<g id="edge21" class="edge">
<title>l0_exp4_gpu0&#45;&gt;l0_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M574.14,-3882.08C617.38,-3866.65 670.85,-3847.57 720.45,-3829.88"/>
<polygon fill="black" stroke="black" points="721.75,-3833.13 729.99,-3826.48 719.39,-3826.54 721.75,-3833.13"/>
</g>
<!-- l0_exp5_gpu0&#45;&gt;l0_exp_agg_tp0 -->
<g id="edge24" class="edge">
<title>l0_exp5_gpu0&#45;&gt;l0_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M1167.86,-3882.08C1138.13,-3871.47 1103.56,-3859.14 1068.73,-3846.71"/>
<polygon fill="black" stroke="black" points="1069.5,-3843.27 1058.91,-3843.21 1067.15,-3849.86 1069.5,-3843.27"/>
</g>
<!-- l0_exp6_gpu0&#45;&gt;l0_exp_agg_tp0 -->
<g id="edge27" class="edge">
<title>l0_exp6_gpu0&#45;&gt;l0_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M1359.76,-3882.69C1356.81,-3881.82 1353.89,-3880.97 1351,-3880.17 1263.51,-3855.74 1165.71,-3833.64 1081.34,-3816.15"/>
<polygon fill="black" stroke="black" points="1081.88,-3812.69 1071.38,-3814.09 1080.47,-3819.54 1081.88,-3812.69"/>
</g>
<!-- l0_exp7_gpu0&#45;&gt;l0_exp_agg_tp0 -->
<g id="edge30" class="edge">
<title>l0_exp7_gpu0&#45;&gt;l0_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M1016.52,-3880C1003.41,-3870.65 988.61,-3860.08 973.58,-3849.36"/>
<polygon fill="black" stroke="black" points="975.4,-3846.36 965.22,-3843.4 971.33,-3852.06 975.4,-3846.36"/>
</g>
<!-- l0_exp_agg_tp0&#45;&gt;l0_final_res_tp0 -->
<g id="edge31" class="edge">
<title>l0_exp_agg_tp0&#45;&gt;l0_final_res_tp0</title>
<path fill="none" stroke="black" d="M872.57,-3707.07C872.77,-3698.4 872.98,-3689.46 873.19,-3680.63"/>
<polygon fill="black" stroke="black" points="876.69,-3680.43 873.43,-3670.35 869.7,-3680.26 876.69,-3680.43"/>
</g>
<!-- l1_qkv_tp0 -->
<g id="node122" class="node">
<title>l1_qkv_tp0</title>
<polygon fill="lightgreen" stroke="black" points="860,-3497.17 634,-3497.17 634,-3429.17 860,-3429.17 860,-3497.17"/>
<text text-anchor="middle" x="747" y="-3481.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="747" y="-3466.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="747" y="-3451.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="747" y="-3436.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_final_res_tp0&#45;&gt;l1_qkv_tp0 -->
<g id="edge257" class="edge">
<title>l0_final_res_tp0&#45;&gt;l1_qkv_tp0</title>
<path fill="none" stroke="black" d="M812.12,-3533.87C802.84,-3523.93 793.52,-3513.96 784.95,-3504.79"/>
<polygon fill="black" stroke="black" points="787.34,-3502.21 777.95,-3497.29 782.22,-3506.99 787.34,-3502.21"/>
</g>
<!-- l1_residual_tp0 -->
<g id="node125" class="node">
<title>l1_residual_tp0</title>
<polygon fill="lightyellow" stroke="black" points="1135.93,-3182.17 564.95,-3182.17 418.07,-3046.17 989.05,-3046.17 1135.93,-3182.17"/>
<text text-anchor="middle" x="777" y="-3132.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="777" y="-3117.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="777" y="-3102.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="777" y="-3087.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_final_res_tp0&#45;&gt;l1_residual_tp0 -->
<g id="edge261" class="edge">
<title>l0_final_res_tp0&#45;&gt;l1_residual_tp0</title>
<path fill="none" stroke="black" d="M877.75,-3533.93C878.44,-3511.73 879,-3486.89 879,-3464.17 879,-3464.17 879,-3464.17 879,-3252.17 879,-3230.05 870.34,-3209.2 858.07,-3190.74"/>
<polygon fill="black" stroke="black" points="860.83,-3188.58 852.2,-3182.43 855.12,-3192.62 860.83,-3188.58"/>
</g>
<!-- l0_exp_agg_tp1 -->
<g id="node60" class="node">
<title>l0_exp_agg_tp1</title>
<polygon fill="lightyellow" stroke="black" points="2646.58,-3843.17 2297.28,-3843.17 2207.42,-3707.17 2556.72,-3707.17 2646.58,-3843.17"/>
<text text-anchor="middle" x="2427" y="-3793.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2427" y="-3778.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="2427" y="-3763.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="2427" y="-3748.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_exp0_gpu1&#45;&gt;l0_exp_agg_tp1 -->
<g id="edge41" class="edge">
<title>l0_exp0_gpu1&#45;&gt;l0_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2281.48,-3880C2294.59,-3870.65 2309.39,-3860.08 2324.42,-3849.36"/>
<polygon fill="black" stroke="black" points="2326.67,-3852.06 2332.78,-3843.4 2322.6,-3846.36 2326.67,-3852.06"/>
</g>
<!-- l0_exp1_gpu1&#45;&gt;l0_exp_agg_tp1 -->
<g id="edge44" class="edge">
<title>l0_exp1_gpu1&#45;&gt;l0_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2723.86,-3882.08C2694.13,-3871.47 2659.56,-3859.14 2624.73,-3846.71"/>
<polygon fill="black" stroke="black" points="2625.5,-3843.27 2614.91,-3843.21 2623.15,-3849.86 2625.5,-3843.27"/>
</g>
<!-- l0_exp2_gpu1&#45;&gt;l0_exp_agg_tp1 -->
<g id="edge47" class="edge">
<title>l0_exp2_gpu1&#45;&gt;l0_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2130.14,-3882.08C2173.38,-3866.65 2226.85,-3847.57 2276.45,-3829.88"/>
<polygon fill="black" stroke="black" points="2277.75,-3833.13 2285.99,-3826.48 2275.39,-3826.54 2277.75,-3833.13"/>
</g>
<!-- l0_exp3_gpu1&#45;&gt;l0_exp_agg_tp1 -->
<g id="edge50" class="edge">
<title>l0_exp3_gpu1&#45;&gt;l0_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M1938.24,-3882.69C1941.19,-3881.82 1944.11,-3880.97 1947,-3880.17 2050.61,-3851.24 2168.66,-3825.57 2261.77,-3806.97"/>
<polygon fill="black" stroke="black" points="2262.72,-3810.35 2271.85,-3804.96 2261.35,-3803.48 2262.72,-3810.35"/>
</g>
<!-- l0_exp4_gpu1&#45;&gt;l0_exp_agg_tp1 -->
<g id="edge53" class="edge">
<title>l0_exp4_gpu1&#45;&gt;l0_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M1746.18,-3882.46C1749.15,-3881.65 1752.09,-3880.89 1755,-3880.17 1922.29,-3838.82 2117.29,-3810.81 2254.01,-3794.37"/>
<polygon fill="black" stroke="black" points="2254.65,-3797.82 2264.16,-3793.16 2253.82,-3790.87 2254.65,-3797.82"/>
</g>
<!-- l0_exp5_gpu1&#45;&gt;l0_exp_agg_tp1 -->
<g id="edge56" class="edge">
<title>l0_exp5_gpu1&#45;&gt;l0_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2915.76,-3882.69C2912.81,-3881.82 2909.89,-3880.97 2907,-3880.17 2819.51,-3855.74 2721.71,-3833.64 2637.34,-3816.15"/>
<polygon fill="black" stroke="black" points="2637.88,-3812.69 2627.38,-3814.09 2636.47,-3819.54 2637.88,-3812.69"/>
</g>
<!-- l0_exp6_gpu1&#45;&gt;l0_exp_agg_tp1 -->
<g id="edge59" class="edge">
<title>l0_exp6_gpu1&#45;&gt;l0_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2572.52,-3880C2559.41,-3870.65 2544.61,-3860.08 2529.58,-3849.36"/>
<polygon fill="black" stroke="black" points="2531.4,-3846.36 2521.22,-3843.4 2527.33,-3852.06 2531.4,-3846.36"/>
</g>
<!-- l0_exp7_gpu1&#45;&gt;l0_exp_agg_tp1 -->
<g id="edge62" class="edge">
<title>l0_exp7_gpu1&#45;&gt;l0_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2427,-3880C2427,-3871.86 2427,-3862.8 2427,-3853.52"/>
<polygon fill="black" stroke="black" points="2430.5,-3853.4 2427,-3843.4 2423.5,-3853.4 2430.5,-3853.4"/>
</g>
<!-- l0_exp_agg_tp1&#45;&gt;l0_final_res_tp1 -->
<g id="edge63" class="edge">
<title>l0_exp_agg_tp1&#45;&gt;l0_final_res_tp1</title>
<path fill="none" stroke="black" d="M2470.94,-3707.07C2477,-3697.83 2483.25,-3688.29 2489.39,-3678.91"/>
<polygon fill="black" stroke="black" points="2492.45,-3680.63 2495,-3670.35 2486.59,-3676.79 2492.45,-3680.63"/>
</g>
<!-- l1_qkv_tp1 -->
<g id="node137" class="node">
<title>l1_qkv_tp1</title>
<polygon fill="lightgreen" stroke="black" points="2555,-3497.17 2329,-3497.17 2329,-3429.17 2555,-3429.17 2555,-3497.17"/>
<text text-anchor="middle" x="2442" y="-3481.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2442" y="-3466.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="2442" y="-3451.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="2442" y="-3436.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_final_res_tp1&#45;&gt;l1_qkv_tp1 -->
<g id="edge289" class="edge">
<title>l0_final_res_tp1&#45;&gt;l1_qkv_tp1</title>
<path fill="none" stroke="black" d="M2491.35,-3533.87C2484.53,-3524.23 2477.68,-3514.56 2471.35,-3505.62"/>
<polygon fill="black" stroke="black" points="2474.09,-3503.43 2465.46,-3497.29 2468.38,-3507.48 2474.09,-3503.43"/>
</g>
<!-- l1_residual_tp1 -->
<g id="node140" class="node">
<title>l1_residual_tp1</title>
<polygon fill="lightyellow" stroke="black" points="2899.93,-3182.17 2328.95,-3182.17 2182.07,-3046.17 2753.05,-3046.17 2899.93,-3182.17"/>
<text text-anchor="middle" x="2541" y="-3132.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2541" y="-3117.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="2541" y="-3102.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="2541" y="-3087.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_final_res_tp1&#45;&gt;l1_residual_tp1 -->
<g id="edge293" class="edge">
<title>l0_final_res_tp1&#45;&gt;l1_residual_tp1</title>
<path fill="none" stroke="black" d="M2563.21,-3534.09C2569.23,-3512.1 2574,-3487.36 2574,-3464.17 2574,-3464.17 2574,-3464.17 2574,-3252.17 2574,-3232.48 2570.74,-3211.63 2566.27,-3192.3"/>
<polygon fill="black" stroke="black" points="2569.61,-3191.22 2563.83,-3182.34 2562.81,-3192.89 2569.61,-3191.22"/>
</g>
<!-- l0_exp_agg_tp2 -->
<g id="node70" class="node">
<title>l0_exp_agg_tp2</title>
<polygon fill="lightyellow" stroke="black" points="4202.58,-3843.17 3853.28,-3843.17 3763.42,-3707.17 4112.72,-3707.17 4202.58,-3843.17"/>
<text text-anchor="middle" x="3983" y="-3793.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3983" y="-3778.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="3983" y="-3763.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="3983" y="-3748.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_exp0_gpu2&#45;&gt;l0_exp_agg_tp2 -->
<g id="edge73" class="edge">
<title>l0_exp0_gpu2&#45;&gt;l0_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M3302.18,-3882.46C3305.15,-3881.65 3308.09,-3880.89 3311,-3880.17 3478.29,-3838.82 3673.29,-3810.81 3810.01,-3794.37"/>
<polygon fill="black" stroke="black" points="3810.65,-3797.82 3820.16,-3793.16 3809.82,-3790.87 3810.65,-3797.82"/>
</g>
<!-- l0_exp1_gpu2&#45;&gt;l0_exp_agg_tp2 -->
<g id="edge76" class="edge">
<title>l0_exp1_gpu2&#45;&gt;l0_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M3837.48,-3880C3850.59,-3870.65 3865.39,-3860.08 3880.42,-3849.36"/>
<polygon fill="black" stroke="black" points="3882.67,-3852.06 3888.78,-3843.4 3878.6,-3846.36 3882.67,-3852.06"/>
</g>
<!-- l0_exp2_gpu2&#45;&gt;l0_exp_agg_tp2 -->
<g id="edge79" class="edge">
<title>l0_exp2_gpu2&#45;&gt;l0_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M3983,-3880C3983,-3871.86 3983,-3862.8 3983,-3853.52"/>
<polygon fill="black" stroke="black" points="3986.5,-3853.4 3983,-3843.4 3979.5,-3853.4 3986.5,-3853.4"/>
</g>
<!-- l0_exp3_gpu2&#45;&gt;l0_exp_agg_tp2 -->
<g id="edge82" class="edge">
<title>l0_exp3_gpu2&#45;&gt;l0_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M3494.24,-3882.69C3497.19,-3881.82 3500.11,-3880.97 3503,-3880.17 3606.61,-3851.24 3724.66,-3825.57 3817.77,-3806.97"/>
<polygon fill="black" stroke="black" points="3818.72,-3810.35 3827.85,-3804.96 3817.35,-3803.48 3818.72,-3810.35"/>
</g>
<!-- l0_exp4_gpu2&#45;&gt;l0_exp_agg_tp2 -->
<g id="edge85" class="edge">
<title>l0_exp4_gpu2&#45;&gt;l0_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M3686.14,-3882.08C3729.38,-3866.65 3782.85,-3847.57 3832.45,-3829.88"/>
<polygon fill="black" stroke="black" points="3833.75,-3833.13 3841.99,-3826.48 3831.39,-3826.54 3833.75,-3833.13"/>
</g>
<!-- l0_exp5_gpu2&#45;&gt;l0_exp_agg_tp2 -->
<g id="edge88" class="edge">
<title>l0_exp5_gpu2&#45;&gt;l0_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M4128.52,-3880C4115.41,-3870.65 4100.61,-3860.08 4085.58,-3849.36"/>
<polygon fill="black" stroke="black" points="4087.4,-3846.36 4077.22,-3843.4 4083.33,-3852.06 4087.4,-3846.36"/>
</g>
<!-- l0_exp6_gpu2&#45;&gt;l0_exp_agg_tp2 -->
<g id="edge91" class="edge">
<title>l0_exp6_gpu2&#45;&gt;l0_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M4471.76,-3882.69C4468.81,-3881.82 4465.89,-3880.97 4463,-3880.17 4375.51,-3855.74 4277.71,-3833.64 4193.34,-3816.15"/>
<polygon fill="black" stroke="black" points="4193.88,-3812.69 4183.38,-3814.09 4192.47,-3819.54 4193.88,-3812.69"/>
</g>
<!-- l0_exp7_gpu2&#45;&gt;l0_exp_agg_tp2 -->
<g id="edge94" class="edge">
<title>l0_exp7_gpu2&#45;&gt;l0_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M4279.86,-3882.08C4250.13,-3871.47 4215.56,-3859.14 4180.73,-3846.71"/>
<polygon fill="black" stroke="black" points="4181.5,-3843.27 4170.91,-3843.21 4179.15,-3849.86 4181.5,-3843.27"/>
</g>
<!-- l0_exp_agg_tp2&#45;&gt;l0_final_res_tp2 -->
<g id="edge95" class="edge">
<title>l0_exp_agg_tp2&#45;&gt;l0_final_res_tp2</title>
<path fill="none" stroke="black" d="M3988.89,-3707.07C3989.65,-3698.3 3990.45,-3689.26 3991.23,-3680.34"/>
<polygon fill="black" stroke="black" points="3994.72,-3680.61 3992.11,-3670.35 3987.75,-3680 3994.72,-3680.61"/>
</g>
<!-- l1_qkv_tp2 -->
<g id="node152" class="node">
<title>l1_qkv_tp2</title>
<polygon fill="lightgreen" stroke="black" points="3995,-3497.17 3769,-3497.17 3769,-3429.17 3995,-3429.17 3995,-3497.17"/>
<text text-anchor="middle" x="3882" y="-3481.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3882" y="-3466.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="3882" y="-3451.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="3882" y="-3436.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_final_res_tp2&#45;&gt;l1_qkv_tp2 -->
<g id="edge321" class="edge">
<title>l0_final_res_tp2&#45;&gt;l1_qkv_tp2</title>
<path fill="none" stroke="black" d="M3941.02,-3533.87C3932.69,-3524.03 3924.33,-3514.16 3916.63,-3505.07"/>
<polygon fill="black" stroke="black" points="3919.18,-3502.66 3910.05,-3497.29 3913.84,-3507.19 3919.18,-3502.66"/>
</g>
<!-- l1_residual_tp2 -->
<g id="node155" class="node">
<title>l1_residual_tp2</title>
<polygon fill="lightyellow" stroke="black" points="4310.93,-3182.17 3739.95,-3182.17 3593.07,-3046.17 4164.05,-3046.17 4310.93,-3182.17"/>
<text text-anchor="middle" x="3952" y="-3132.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3952" y="-3117.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="3952" y="-3102.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="3952" y="-3087.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_final_res_tp2&#45;&gt;l1_residual_tp2 -->
<g id="edge325" class="edge">
<title>l0_final_res_tp2&#45;&gt;l1_residual_tp2</title>
<path fill="none" stroke="black" d="M4008.98,-3534.11C4011.77,-3511.91 4014,-3487.04 4014,-3464.17 4014,-3464.17 4014,-3464.17 4014,-3252.17 4014,-3231.53 4008.09,-3210.57 3999.91,-3191.46"/>
<polygon fill="black" stroke="black" points="4003.05,-3189.9 3995.73,-3182.23 3996.67,-3192.78 4003.05,-3189.9"/>
</g>
<!-- l0_exp_agg_tp3 -->
<g id="node80" class="node">
<title>l0_exp_agg_tp3</title>
<polygon fill="lightyellow" stroke="black" points="5758.58,-3843.17 5409.28,-3843.17 5319.42,-3707.17 5668.72,-3707.17 5758.58,-3843.17"/>
<text text-anchor="middle" x="5539" y="-3793.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5539" y="-3778.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="5539" y="-3763.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5539" y="-3748.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_exp0_gpu3&#45;&gt;l0_exp_agg_tp3 -->
<g id="edge105" class="edge">
<title>l0_exp0_gpu3&#45;&gt;l0_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5050.24,-3882.69C5053.19,-3881.82 5056.11,-3880.97 5059,-3880.17 5162.61,-3851.24 5280.66,-3825.57 5373.77,-3806.97"/>
<polygon fill="black" stroke="black" points="5374.72,-3810.35 5383.85,-3804.96 5373.35,-3803.48 5374.72,-3810.35"/>
</g>
<!-- l0_exp1_gpu3&#45;&gt;l0_exp_agg_tp3 -->
<g id="edge108" class="edge">
<title>l0_exp1_gpu3&#45;&gt;l0_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M4858.18,-3882.46C4861.15,-3881.65 4864.09,-3880.89 4867,-3880.17 5034.29,-3838.82 5229.29,-3810.81 5366.01,-3794.37"/>
<polygon fill="black" stroke="black" points="5366.65,-3797.82 5376.16,-3793.16 5365.82,-3790.87 5366.65,-3797.82"/>
</g>
<!-- l0_exp2_gpu3&#45;&gt;l0_exp_agg_tp3 -->
<g id="edge111" class="edge">
<title>l0_exp2_gpu3&#45;&gt;l0_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M6027.76,-3882.69C6024.81,-3881.82 6021.89,-3880.97 6019,-3880.17 5931.51,-3855.74 5833.71,-3833.64 5749.34,-3816.15"/>
<polygon fill="black" stroke="black" points="5749.88,-3812.69 5739.38,-3814.09 5748.47,-3819.54 5749.88,-3812.69"/>
</g>
<!-- l0_exp3_gpu3&#45;&gt;l0_exp_agg_tp3 -->
<g id="edge114" class="edge">
<title>l0_exp3_gpu3&#45;&gt;l0_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5684.52,-3880C5671.41,-3870.65 5656.61,-3860.08 5641.58,-3849.36"/>
<polygon fill="black" stroke="black" points="5643.4,-3846.36 5633.22,-3843.4 5639.33,-3852.06 5643.4,-3846.36"/>
</g>
<!-- l0_exp4_gpu3&#45;&gt;l0_exp_agg_tp3 -->
<g id="edge117" class="edge">
<title>l0_exp4_gpu3&#45;&gt;l0_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5242.14,-3882.08C5285.38,-3866.65 5338.85,-3847.57 5388.45,-3829.88"/>
<polygon fill="black" stroke="black" points="5389.75,-3833.13 5397.99,-3826.48 5387.39,-3826.54 5389.75,-3833.13"/>
</g>
<!-- l0_exp5_gpu3&#45;&gt;l0_exp_agg_tp3 -->
<g id="edge120" class="edge">
<title>l0_exp5_gpu3&#45;&gt;l0_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5393.48,-3880C5406.59,-3870.65 5421.39,-3860.08 5436.42,-3849.36"/>
<polygon fill="black" stroke="black" points="5438.67,-3852.06 5444.78,-3843.4 5434.6,-3846.36 5438.67,-3852.06"/>
</g>
<!-- l0_exp6_gpu3&#45;&gt;l0_exp_agg_tp3 -->
<g id="edge123" class="edge">
<title>l0_exp6_gpu3&#45;&gt;l0_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5835.86,-3882.08C5806.13,-3871.47 5771.56,-3859.14 5736.73,-3846.71"/>
<polygon fill="black" stroke="black" points="5737.5,-3843.27 5726.91,-3843.21 5735.15,-3849.86 5737.5,-3843.27"/>
</g>
<!-- l0_exp7_gpu3&#45;&gt;l0_exp_agg_tp3 -->
<g id="edge126" class="edge">
<title>l0_exp7_gpu3&#45;&gt;l0_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5539,-3880C5539,-3871.86 5539,-3862.8 5539,-3853.52"/>
<polygon fill="black" stroke="black" points="5542.5,-3853.4 5539,-3843.4 5535.5,-3853.4 5542.5,-3853.4"/>
</g>
<!-- l0_exp_agg_tp3&#45;&gt;l0_final_res_tp3 -->
<g id="edge127" class="edge">
<title>l0_exp_agg_tp3&#45;&gt;l0_final_res_tp3</title>
<path fill="none" stroke="black" d="M5582.55,-3707.07C5588.55,-3697.83 5594.74,-3688.29 5600.84,-3678.91"/>
<polygon fill="black" stroke="black" points="5603.88,-3680.64 5606.39,-3670.35 5598.01,-3676.83 5603.88,-3680.64"/>
</g>
<!-- l1_qkv_tp3 -->
<g id="node167" class="node">
<title>l1_qkv_tp3</title>
<polygon fill="lightgreen" stroke="black" points="5666,-3497.17 5440,-3497.17 5440,-3429.17 5666,-3429.17 5666,-3497.17"/>
<text text-anchor="middle" x="5553" y="-3481.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5553" y="-3466.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="5553" y="-3451.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="5553" y="-3436.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_final_res_tp3&#45;&gt;l1_qkv_tp3 -->
<g id="edge353" class="edge">
<title>l0_final_res_tp3&#45;&gt;l1_qkv_tp3</title>
<path fill="none" stroke="black" d="M5602.35,-3533.87C5595.53,-3524.23 5588.68,-3514.56 5582.35,-3505.62"/>
<polygon fill="black" stroke="black" points="5585.09,-3503.43 5576.46,-3497.29 5579.38,-3507.48 5585.09,-3503.43"/>
</g>
<!-- l1_residual_tp3 -->
<g id="node170" class="node">
<title>l1_residual_tp3</title>
<polygon fill="lightyellow" stroke="black" points="6011.93,-3182.17 5440.95,-3182.17 5294.07,-3046.17 5865.05,-3046.17 6011.93,-3182.17"/>
<text text-anchor="middle" x="5653" y="-3132.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5653" y="-3117.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="5653" y="-3102.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5653" y="-3087.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_final_res_tp3&#45;&gt;l1_residual_tp3 -->
<g id="edge357" class="edge">
<title>l0_final_res_tp3&#45;&gt;l1_residual_tp3</title>
<path fill="none" stroke="black" d="M5674.21,-3534.09C5680.23,-3512.1 5685,-3487.36 5685,-3464.17 5685,-3464.17 5685,-3464.17 5685,-3252.17 5685,-3232.51 5681.84,-3211.68 5677.5,-3192.34"/>
<polygon fill="black" stroke="black" points="5680.85,-3191.31 5675.14,-3182.39 5674.04,-3192.92 5680.85,-3191.31"/>
</g>
<!-- l0_exp_agg_tp4 -->
<g id="node90" class="node">
<title>l0_exp_agg_tp4</title>
<polygon fill="lightyellow" stroke="black" points="7314.58,-3843.17 6965.28,-3843.17 6875.42,-3707.17 7224.72,-3707.17 7314.58,-3843.17"/>
<text text-anchor="middle" x="7095" y="-3793.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7095" y="-3778.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="7095" y="-3763.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="7095" y="-3748.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l0_exp0_gpu4&#45;&gt;l0_exp_agg_tp4 -->
<g id="edge137" class="edge">
<title>l0_exp0_gpu4&#45;&gt;l0_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M6949.48,-3880C6962.59,-3870.65 6977.39,-3860.08 6992.42,-3849.36"/>
<polygon fill="black" stroke="black" points="6994.67,-3852.06 7000.78,-3843.4 6990.6,-3846.36 6994.67,-3852.06"/>
</g>
<!-- l0_exp1_gpu4&#45;&gt;l0_exp_agg_tp4 -->
<g id="edge140" class="edge">
<title>l0_exp1_gpu4&#45;&gt;l0_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M6414.18,-3882.46C6417.15,-3881.65 6420.09,-3880.89 6423,-3880.17 6590.29,-3838.82 6785.29,-3810.81 6922.01,-3794.37"/>
<polygon fill="black" stroke="black" points="6922.65,-3797.82 6932.16,-3793.16 6921.82,-3790.87 6922.65,-3797.82"/>
</g>
<!-- l0_exp2_gpu4&#45;&gt;l0_exp_agg_tp4 -->
<g id="edge143" class="edge">
<title>l0_exp2_gpu4&#45;&gt;l0_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7095,-3880C7095,-3871.86 7095,-3862.8 7095,-3853.52"/>
<polygon fill="black" stroke="black" points="7098.5,-3853.4 7095,-3843.4 7091.5,-3853.4 7098.5,-3853.4"/>
</g>
<!-- l0_exp3_gpu4&#45;&gt;l0_exp_agg_tp4 -->
<g id="edge146" class="edge">
<title>l0_exp3_gpu4&#45;&gt;l0_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7391.86,-3882.08C7362.13,-3871.47 7327.56,-3859.14 7292.73,-3846.71"/>
<polygon fill="black" stroke="black" points="7293.5,-3843.27 7282.91,-3843.21 7291.15,-3849.86 7293.5,-3843.27"/>
</g>
<!-- l0_exp4_gpu4&#45;&gt;l0_exp_agg_tp4 -->
<g id="edge149" class="edge">
<title>l0_exp4_gpu4&#45;&gt;l0_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7240.52,-3880C7227.41,-3870.65 7212.61,-3860.08 7197.58,-3849.36"/>
<polygon fill="black" stroke="black" points="7199.4,-3846.36 7189.22,-3843.4 7195.33,-3852.06 7199.4,-3846.36"/>
</g>
<!-- l0_exp5_gpu4&#45;&gt;l0_exp_agg_tp4 -->
<g id="edge152" class="edge">
<title>l0_exp5_gpu4&#45;&gt;l0_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M6606.24,-3882.69C6609.19,-3881.82 6612.11,-3880.97 6615,-3880.17 6718.61,-3851.24 6836.66,-3825.57 6929.77,-3806.97"/>
<polygon fill="black" stroke="black" points="6930.72,-3810.35 6939.85,-3804.96 6929.35,-3803.48 6930.72,-3810.35"/>
</g>
<!-- l0_exp6_gpu4&#45;&gt;l0_exp_agg_tp4 -->
<g id="edge155" class="edge">
<title>l0_exp6_gpu4&#45;&gt;l0_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M6798.14,-3882.08C6841.38,-3866.65 6894.85,-3847.57 6944.45,-3829.88"/>
<polygon fill="black" stroke="black" points="6945.75,-3833.13 6953.99,-3826.48 6943.39,-3826.54 6945.75,-3833.13"/>
</g>
<!-- l0_exp7_gpu4&#45;&gt;l0_exp_agg_tp4 -->
<g id="edge158" class="edge">
<title>l0_exp7_gpu4&#45;&gt;l0_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7583.76,-3882.69C7580.81,-3881.82 7577.89,-3880.97 7575,-3880.17 7487.51,-3855.74 7389.71,-3833.64 7305.34,-3816.15"/>
<polygon fill="black" stroke="black" points="7305.88,-3812.69 7295.38,-3814.09 7304.47,-3819.54 7305.88,-3812.69"/>
</g>
<!-- l0_exp_agg_tp4&#45;&gt;l0_final_res_tp4 -->
<g id="edge159" class="edge">
<title>l0_exp_agg_tp4&#45;&gt;l0_final_res_tp4</title>
<path fill="none" stroke="black" d="M7107.95,-3707.07C7109.64,-3698.3 7111.38,-3689.26 7113.11,-3680.34"/>
<polygon fill="black" stroke="black" points="7116.58,-3680.83 7115.04,-3670.35 7109.7,-3679.5 7116.58,-3680.83"/>
</g>
<!-- l1_qkv_tp4 -->
<g id="node182" class="node">
<title>l1_qkv_tp4</title>
<polygon fill="lightgreen" stroke="black" points="7109,-3497.17 6883,-3497.17 6883,-3429.17 7109,-3429.17 7109,-3497.17"/>
<text text-anchor="middle" x="6996" y="-3481.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6996" y="-3466.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="6996" y="-3451.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="6996" y="-3436.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l0_final_res_tp4&#45;&gt;l1_qkv_tp4 -->
<g id="edge385" class="edge">
<title>l0_final_res_tp4&#45;&gt;l1_qkv_tp4</title>
<path fill="none" stroke="black" d="M7063.16,-3533.87C7053.49,-3523.83 7043.78,-3513.76 7034.88,-3504.51"/>
<polygon fill="black" stroke="black" points="7037.38,-3502.07 7027.92,-3497.29 7032.34,-3506.92 7037.38,-3502.07"/>
</g>
<!-- l1_residual_tp4 -->
<g id="node185" class="node">
<title>l1_residual_tp4</title>
<polygon fill="lightyellow" stroke="black" points="7453.93,-3182.17 6882.95,-3182.17 6736.07,-3046.17 7307.05,-3046.17 7453.93,-3182.17"/>
<text text-anchor="middle" x="7095" y="-3132.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7095" y="-3117.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="7095" y="-3102.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="7095" y="-3087.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l0_final_res_tp4&#45;&gt;l1_residual_tp4 -->
<g id="edge389" class="edge">
<title>l0_final_res_tp4&#45;&gt;l1_residual_tp4</title>
<path fill="none" stroke="black" d="M7128,-3533.92C7128,-3511.71 7128,-3486.88 7128,-3464.17 7128,-3464.17 7128,-3464.17 7128,-3252.17 7128,-3232.48 7124.74,-3211.63 7120.27,-3192.3"/>
<polygon fill="black" stroke="black" points="7123.61,-3191.22 7117.83,-3182.34 7116.81,-3192.89 7123.61,-3191.22"/>
</g>
<!-- l0_exp_agg_tp5 -->
<g id="node100" class="node">
<title>l0_exp_agg_tp5</title>
<polygon fill="lightyellow" stroke="black" points="8870.58,-3843.17 8521.28,-3843.17 8431.42,-3707.17 8780.72,-3707.17 8870.58,-3843.17"/>
<text text-anchor="middle" x="8651" y="-3793.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8651" y="-3778.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="8651" y="-3763.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="8651" y="-3748.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l0_exp0_gpu5&#45;&gt;l0_exp_agg_tp5 -->
<g id="edge169" class="edge">
<title>l0_exp0_gpu5&#45;&gt;l0_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8354.14,-3882.08C8397.38,-3866.65 8450.85,-3847.57 8500.45,-3829.88"/>
<polygon fill="black" stroke="black" points="8501.75,-3833.13 8509.99,-3826.48 8499.39,-3826.54 8501.75,-3833.13"/>
</g>
<!-- l0_exp1_gpu5&#45;&gt;l0_exp_agg_tp5 -->
<g id="edge172" class="edge">
<title>l0_exp1_gpu5&#45;&gt;l0_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8162.24,-3882.69C8165.19,-3881.82 8168.11,-3880.97 8171,-3880.17 8274.61,-3851.24 8392.66,-3825.57 8485.77,-3806.97"/>
<polygon fill="black" stroke="black" points="8486.72,-3810.35 8495.85,-3804.96 8485.35,-3803.48 8486.72,-3810.35"/>
</g>
<!-- l0_exp2_gpu5&#45;&gt;l0_exp_agg_tp5 -->
<g id="edge175" class="edge">
<title>l0_exp2_gpu5&#45;&gt;l0_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8505.48,-3880C8518.59,-3870.65 8533.39,-3860.08 8548.42,-3849.36"/>
<polygon fill="black" stroke="black" points="8550.67,-3852.06 8556.78,-3843.4 8546.6,-3846.36 8550.67,-3852.06"/>
</g>
<!-- l0_exp3_gpu5&#45;&gt;l0_exp_agg_tp5 -->
<g id="edge178" class="edge">
<title>l0_exp3_gpu5&#45;&gt;l0_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8947.86,-3882.08C8918.13,-3871.47 8883.56,-3859.14 8848.73,-3846.71"/>
<polygon fill="black" stroke="black" points="8849.5,-3843.27 8838.91,-3843.21 8847.15,-3849.86 8849.5,-3843.27"/>
</g>
<!-- l0_exp4_gpu5&#45;&gt;l0_exp_agg_tp5 -->
<g id="edge181" class="edge">
<title>l0_exp4_gpu5&#45;&gt;l0_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8796.52,-3880C8783.41,-3870.65 8768.61,-3860.08 8753.58,-3849.36"/>
<polygon fill="black" stroke="black" points="8755.4,-3846.36 8745.22,-3843.4 8751.33,-3852.06 8755.4,-3846.36"/>
</g>
<!-- l0_exp5_gpu5&#45;&gt;l0_exp_agg_tp5 -->
<g id="edge184" class="edge">
<title>l0_exp5_gpu5&#45;&gt;l0_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8651,-3880C8651,-3871.86 8651,-3862.8 8651,-3853.52"/>
<polygon fill="black" stroke="black" points="8654.5,-3853.4 8651,-3843.4 8647.5,-3853.4 8654.5,-3853.4"/>
</g>
<!-- l0_exp6_gpu5&#45;&gt;l0_exp_agg_tp5 -->
<g id="edge187" class="edge">
<title>l0_exp6_gpu5&#45;&gt;l0_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M7970.18,-3882.46C7973.15,-3881.65 7976.09,-3880.89 7979,-3880.17 8146.29,-3838.82 8341.29,-3810.81 8478.01,-3794.37"/>
<polygon fill="black" stroke="black" points="8478.65,-3797.82 8488.16,-3793.16 8477.82,-3790.87 8478.65,-3797.82"/>
</g>
<!-- l0_exp7_gpu5&#45;&gt;l0_exp_agg_tp5 -->
<g id="edge190" class="edge">
<title>l0_exp7_gpu5&#45;&gt;l0_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M9139.76,-3882.69C9136.81,-3881.82 9133.89,-3880.97 9131,-3880.17 9043.51,-3855.74 8945.71,-3833.64 8861.34,-3816.15"/>
<polygon fill="black" stroke="black" points="8861.88,-3812.69 8851.38,-3814.09 8860.47,-3819.54 8861.88,-3812.69"/>
</g>
<!-- l0_exp_agg_tp5&#45;&gt;l0_final_res_tp5 -->
<g id="edge191" class="edge">
<title>l0_exp_agg_tp5&#45;&gt;l0_final_res_tp5</title>
<path fill="none" stroke="black" d="M8698.48,-3707.07C8705.08,-3697.74 8711.9,-3688.1 8718.61,-3678.62"/>
<polygon fill="black" stroke="black" points="8721.54,-3680.53 8724.46,-3670.35 8715.83,-3676.49 8721.54,-3680.53"/>
</g>
<!-- l1_qkv_tp5 -->
<g id="node197" class="node">
<title>l1_qkv_tp5</title>
<polygon fill="lightgreen" stroke="black" points="8791,-3497.17 8565,-3497.17 8565,-3429.17 8791,-3429.17 8791,-3497.17"/>
<text text-anchor="middle" x="8678" y="-3481.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8678" y="-3466.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="8678" y="-3451.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="8678" y="-3436.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l0_final_res_tp5&#45;&gt;l1_qkv_tp5 -->
<g id="edge417" class="edge">
<title>l0_final_res_tp5&#45;&gt;l1_qkv_tp5</title>
<path fill="none" stroke="black" d="M8725.83,-3533.87C8719.21,-3524.23 8712.57,-3514.56 8706.44,-3505.62"/>
<polygon fill="black" stroke="black" points="8709.27,-3503.56 8700.73,-3497.29 8703.5,-3507.52 8709.27,-3503.56"/>
</g>
<!-- l1_residual_tp5 -->
<g id="node200" class="node">
<title>l1_residual_tp5</title>
<polygon fill="lightyellow" stroke="black" points="9112.93,-3182.17 8541.95,-3182.17 8395.07,-3046.17 8966.05,-3046.17 9112.93,-3182.17"/>
<text text-anchor="middle" x="8754" y="-3132.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8754" y="-3117.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="8754" y="-3102.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="8754" y="-3087.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l0_final_res_tp5&#45;&gt;l1_residual_tp5 -->
<g id="edge421" class="edge">
<title>l0_final_res_tp5&#45;&gt;l1_residual_tp5</title>
<path fill="none" stroke="black" d="M8798.39,-3533.89C8804.88,-3512 8810,-3487.37 8810,-3464.17 8810,-3464.17 8810,-3464.17 8810,-3252.17 8810,-3231.74 8804.6,-3210.79 8797.15,-3191.61"/>
<polygon fill="black" stroke="black" points="8800.39,-3190.27 8793.35,-3182.35 8793.91,-3192.93 8800.39,-3190.27"/>
</g>
<!-- l0_exp_agg_tp6 -->
<g id="node110" class="node">
<title>l0_exp_agg_tp6</title>
<polygon fill="lightyellow" stroke="black" points="10426.58,-3843.17 10077.28,-3843.17 9987.42,-3707.17 10336.72,-3707.17 10426.58,-3843.17"/>
<text text-anchor="middle" x="10207" y="-3793.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10207" y="-3778.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="10207" y="-3763.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="10207" y="-3748.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l0_exp0_gpu6&#45;&gt;l0_exp_agg_tp6 -->
<g id="edge201" class="edge">
<title>l0_exp0_gpu6&#45;&gt;l0_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M9718.24,-3882.69C9721.19,-3881.82 9724.11,-3880.97 9727,-3880.17 9830.61,-3851.24 9948.66,-3825.57 10041.77,-3806.97"/>
<polygon fill="black" stroke="black" points="10042.72,-3810.35 10051.85,-3804.96 10041.35,-3803.48 10042.72,-3810.35"/>
</g>
<!-- l0_exp1_gpu6&#45;&gt;l0_exp_agg_tp6 -->
<g id="edge204" class="edge">
<title>l0_exp1_gpu6&#45;&gt;l0_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M9910.14,-3882.08C9953.38,-3866.65 10006.85,-3847.57 10056.45,-3829.88"/>
<polygon fill="black" stroke="black" points="10057.75,-3833.13 10065.99,-3826.48 10055.39,-3826.54 10057.75,-3833.13"/>
</g>
<!-- l0_exp2_gpu6&#45;&gt;l0_exp_agg_tp6 -->
<g id="edge207" class="edge">
<title>l0_exp2_gpu6&#45;&gt;l0_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M9526.18,-3882.46C9529.15,-3881.65 9532.09,-3880.89 9535,-3880.17 9702.29,-3838.82 9897.29,-3810.81 10034.01,-3794.37"/>
<polygon fill="black" stroke="black" points="10034.65,-3797.82 10044.16,-3793.16 10033.82,-3790.87 10034.65,-3797.82"/>
</g>
<!-- l0_exp3_gpu6&#45;&gt;l0_exp_agg_tp6 -->
<g id="edge210" class="edge">
<title>l0_exp3_gpu6&#45;&gt;l0_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10061.48,-3880C10074.59,-3870.65 10089.39,-3860.08 10104.42,-3849.36"/>
<polygon fill="black" stroke="black" points="10106.67,-3852.06 10112.78,-3843.4 10102.6,-3846.36 10106.67,-3852.06"/>
</g>
<!-- l0_exp4_gpu6&#45;&gt;l0_exp_agg_tp6 -->
<g id="edge213" class="edge">
<title>l0_exp4_gpu6&#45;&gt;l0_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10695.76,-3882.69C10692.81,-3881.82 10689.89,-3880.97 10687,-3880.17 10599.51,-3855.74 10501.71,-3833.64 10417.34,-3816.15"/>
<polygon fill="black" stroke="black" points="10417.88,-3812.69 10407.38,-3814.09 10416.47,-3819.54 10417.88,-3812.69"/>
</g>
<!-- l0_exp5_gpu6&#45;&gt;l0_exp_agg_tp6 -->
<g id="edge216" class="edge">
<title>l0_exp5_gpu6&#45;&gt;l0_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10207,-3880C10207,-3871.86 10207,-3862.8 10207,-3853.52"/>
<polygon fill="black" stroke="black" points="10210.5,-3853.4 10207,-3843.4 10203.5,-3853.4 10210.5,-3853.4"/>
</g>
<!-- l0_exp6_gpu6&#45;&gt;l0_exp_agg_tp6 -->
<g id="edge219" class="edge">
<title>l0_exp6_gpu6&#45;&gt;l0_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10503.86,-3882.08C10474.13,-3871.47 10439.56,-3859.14 10404.73,-3846.71"/>
<polygon fill="black" stroke="black" points="10405.5,-3843.27 10394.91,-3843.21 10403.15,-3849.86 10405.5,-3843.27"/>
</g>
<!-- l0_exp7_gpu6&#45;&gt;l0_exp_agg_tp6 -->
<g id="edge222" class="edge">
<title>l0_exp7_gpu6&#45;&gt;l0_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10352.52,-3880C10339.41,-3870.65 10324.61,-3860.08 10309.58,-3849.36"/>
<polygon fill="black" stroke="black" points="10311.4,-3846.36 10301.22,-3843.4 10307.33,-3852.06 10311.4,-3846.36"/>
</g>
<!-- l0_exp_agg_tp6&#45;&gt;l0_final_res_tp6 -->
<g id="edge223" class="edge">
<title>l0_exp_agg_tp6&#45;&gt;l0_final_res_tp6</title>
<path fill="none" stroke="black" d="M10213.28,-3707.07C10214.1,-3698.3 10214.94,-3689.26 10215.78,-3680.34"/>
<polygon fill="black" stroke="black" points="10219.27,-3680.63 10216.71,-3670.35 10212.3,-3679.98 10219.27,-3680.63"/>
</g>
<!-- l1_qkv_tp6 -->
<g id="node212" class="node">
<title>l1_qkv_tp6</title>
<polygon fill="lightgreen" stroke="black" points="10221,-3497.17 9995,-3497.17 9995,-3429.17 10221,-3429.17 10221,-3497.17"/>
<text text-anchor="middle" x="10108" y="-3481.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10108" y="-3466.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="10108" y="-3451.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="10108" y="-3436.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l0_final_res_tp6&#45;&gt;l1_qkv_tp6 -->
<g id="edge449" class="edge">
<title>l0_final_res_tp6&#45;&gt;l1_qkv_tp6</title>
<path fill="none" stroke="black" d="M10166.51,-3533.87C10158.25,-3524.03 10149.96,-3514.16 10142.33,-3505.07"/>
<polygon fill="black" stroke="black" points="10144.92,-3502.7 10135.81,-3497.29 10139.56,-3507.2 10144.92,-3502.7"/>
</g>
<!-- l1_residual_tp6 -->
<g id="node215" class="node">
<title>l1_residual_tp6</title>
<polygon fill="lightyellow" stroke="black" points="10565.93,-3182.17 9994.95,-3182.17 9848.07,-3046.17 10419.05,-3046.17 10565.93,-3182.17"/>
<text text-anchor="middle" x="10207" y="-3132.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10207" y="-3117.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="10207" y="-3102.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="10207" y="-3087.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l0_final_res_tp6&#45;&gt;l1_residual_tp6 -->
<g id="edge453" class="edge">
<title>l0_final_res_tp6&#45;&gt;l1_residual_tp6</title>
<path fill="none" stroke="black" d="M10234.67,-3534.13C10237.63,-3511.93 10240,-3487.06 10240,-3464.17 10240,-3464.17 10240,-3464.17 10240,-3252.17 10240,-3232.48 10236.74,-3211.63 10232.27,-3192.3"/>
<polygon fill="black" stroke="black" points="10235.61,-3191.22 10229.83,-3182.34 10228.81,-3192.89 10235.61,-3191.22"/>
</g>
<!-- l0_exp_agg_tp7 -->
<g id="node120" class="node">
<title>l0_exp_agg_tp7</title>
<polygon fill="lightyellow" stroke="black" points="11982.58,-3843.17 11633.28,-3843.17 11543.42,-3707.17 11892.72,-3707.17 11982.58,-3843.17"/>
<text text-anchor="middle" x="11763" y="-3793.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11763" y="-3778.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="11763" y="-3763.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="11763" y="-3748.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l0_exp0_gpu7&#45;&gt;l0_exp_agg_tp7 -->
<g id="edge233" class="edge">
<title>l0_exp0_gpu7&#45;&gt;l0_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11466.14,-3882.08C11509.38,-3866.65 11562.85,-3847.57 11612.45,-3829.88"/>
<polygon fill="black" stroke="black" points="11613.75,-3833.13 11621.99,-3826.48 11611.39,-3826.54 11613.75,-3833.13"/>
</g>
<!-- l0_exp1_gpu7&#45;&gt;l0_exp_agg_tp7 -->
<g id="edge236" class="edge">
<title>l0_exp1_gpu7&#45;&gt;l0_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11274.24,-3882.69C11277.19,-3881.82 11280.11,-3880.97 11283,-3880.17 11386.61,-3851.24 11504.66,-3825.57 11597.77,-3806.97"/>
<polygon fill="black" stroke="black" points="11598.72,-3810.35 11607.85,-3804.96 11597.35,-3803.48 11598.72,-3810.35"/>
</g>
<!-- l0_exp2_gpu7&#45;&gt;l0_exp_agg_tp7 -->
<g id="edge239" class="edge">
<title>l0_exp2_gpu7&#45;&gt;l0_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11082.18,-3882.46C11085.15,-3881.65 11088.09,-3880.89 11091,-3880.17 11258.29,-3838.82 11453.29,-3810.81 11590.01,-3794.37"/>
<polygon fill="black" stroke="black" points="11590.65,-3797.82 11600.16,-3793.16 11589.82,-3790.87 11590.65,-3797.82"/>
</g>
<!-- l0_exp3_gpu7&#45;&gt;l0_exp_agg_tp7 -->
<g id="edge242" class="edge">
<title>l0_exp3_gpu7&#45;&gt;l0_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11617.48,-3880C11630.59,-3870.65 11645.39,-3860.08 11660.42,-3849.36"/>
<polygon fill="black" stroke="black" points="11662.67,-3852.06 11668.78,-3843.4 11658.6,-3846.36 11662.67,-3852.06"/>
</g>
<!-- l0_exp4_gpu7&#45;&gt;l0_exp_agg_tp7 -->
<g id="edge245" class="edge">
<title>l0_exp4_gpu7&#45;&gt;l0_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M12059.86,-3882.08C12030.13,-3871.47 11995.56,-3859.14 11960.73,-3846.71"/>
<polygon fill="black" stroke="black" points="11961.5,-3843.27 11950.91,-3843.21 11959.15,-3849.86 11961.5,-3843.27"/>
</g>
<!-- l0_exp5_gpu7&#45;&gt;l0_exp_agg_tp7 -->
<g id="edge248" class="edge">
<title>l0_exp5_gpu7&#45;&gt;l0_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M12251.76,-3882.69C12248.81,-3881.82 12245.89,-3880.97 12243,-3880.17 12155.51,-3855.74 12057.71,-3833.64 11973.34,-3816.15"/>
<polygon fill="black" stroke="black" points="11973.88,-3812.69 11963.38,-3814.09 11972.47,-3819.54 11973.88,-3812.69"/>
</g>
<!-- l0_exp6_gpu7&#45;&gt;l0_exp_agg_tp7 -->
<g id="edge251" class="edge">
<title>l0_exp6_gpu7&#45;&gt;l0_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11908.52,-3880C11895.41,-3870.65 11880.61,-3860.08 11865.58,-3849.36"/>
<polygon fill="black" stroke="black" points="11867.4,-3846.36 11857.22,-3843.4 11863.33,-3852.06 11867.4,-3846.36"/>
</g>
<!-- l0_exp7_gpu7&#45;&gt;l0_exp_agg_tp7 -->
<g id="edge254" class="edge">
<title>l0_exp7_gpu7&#45;&gt;l0_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11763,-3880C11763,-3871.86 11763,-3862.8 11763,-3853.52"/>
<polygon fill="black" stroke="black" points="11766.5,-3853.4 11763,-3843.4 11759.5,-3853.4 11766.5,-3853.4"/>
</g>
<!-- l0_exp_agg_tp7&#45;&gt;l0_final_res_tp7 -->
<g id="edge255" class="edge">
<title>l0_exp_agg_tp7&#45;&gt;l0_final_res_tp7</title>
<path fill="none" stroke="black" d="M11807.73,-3707.07C11813.89,-3697.83 11820.25,-3688.29 11826.51,-3678.91"/>
<polygon fill="black" stroke="black" points="11829.58,-3680.61 11832.21,-3670.35 11823.75,-3676.73 11829.58,-3680.61"/>
</g>
<!-- l1_qkv_tp7 -->
<g id="node227" class="node">
<title>l1_qkv_tp7</title>
<polygon fill="lightgreen" stroke="black" points="11893,-3497.17 11667,-3497.17 11667,-3429.17 11893,-3429.17 11893,-3497.17"/>
<text text-anchor="middle" x="11780" y="-3481.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11780" y="-3466.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="11780" y="-3451.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="11780" y="-3436.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l0_final_res_tp7&#45;&gt;l1_qkv_tp7 -->
<g id="edge481" class="edge">
<title>l0_final_res_tp7&#45;&gt;l1_qkv_tp7</title>
<path fill="none" stroke="black" d="M11829.35,-3533.87C11822.53,-3524.23 11815.68,-3514.56 11809.35,-3505.62"/>
<polygon fill="black" stroke="black" points="11812.09,-3503.43 11803.46,-3497.29 11806.38,-3507.48 11812.09,-3503.43"/>
</g>
<!-- l1_residual_tp7 -->
<g id="node230" class="node">
<title>l1_residual_tp7</title>
<polygon fill="lightyellow" stroke="black" points="12255.93,-3182.17 11684.95,-3182.17 11538.07,-3046.17 12109.05,-3046.17 12255.93,-3182.17"/>
<text text-anchor="middle" x="11897" y="-3132.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11897" y="-3117.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="11897" y="-3102.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="11897" y="-3087.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l0_final_res_tp7&#45;&gt;l1_residual_tp7 -->
<g id="edge485" class="edge">
<title>l0_final_res_tp7&#45;&gt;l1_residual_tp7</title>
<path fill="none" stroke="black" d="M11901.21,-3534.09C11907.23,-3512.1 11912,-3487.36 11912,-3464.17 11912,-3464.17 11912,-3464.17 11912,-3252.17 11912,-3232.71 11910.49,-3211.79 11908.42,-3192.3"/>
<polygon fill="black" stroke="black" points="11911.89,-3191.8 11907.3,-3182.25 11904.93,-3192.58 11911.89,-3191.8"/>
</g>
<!-- l1_attn_tp0 -->
<g id="node123" class="node">
<title>l1_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="857,-3392.17 643,-3392.17 643,-3324.17 857,-3324.17 857,-3392.17"/>
<text text-anchor="middle" x="750" y="-3376.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="750" y="-3361.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="750" y="-3346.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="750" y="-3331.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_qkv_tp0&#45;&gt;l1_attn_tp0 -->
<g id="edge258" class="edge">
<title>l1_qkv_tp0&#45;&gt;l1_attn_tp0</title>
<path fill="none" stroke="black" d="M747.97,-3429.01C748.21,-3420.56 748.48,-3411.34 748.74,-3402.47"/>
<polygon fill="black" stroke="black" points="752.24,-3402.36 749.04,-3392.26 745.25,-3402.16 752.24,-3402.36"/>
</g>
<!-- l1_out_proj_tp0 -->
<g id="node124" class="node">
<title>l1_out_proj_tp0</title>
<polygon fill="lightgreen" stroke="black" points="859,-3287.17 647,-3287.17 647,-3219.17 859,-3219.17 859,-3287.17"/>
<text text-anchor="middle" x="753" y="-3271.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="753" y="-3256.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="753" y="-3241.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="753" y="-3226.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_attn_tp0&#45;&gt;l1_out_proj_tp0 -->
<g id="edge259" class="edge">
<title>l1_attn_tp0&#45;&gt;l1_out_proj_tp0</title>
<path fill="none" stroke="black" d="M750.97,-3324.01C751.21,-3315.56 751.48,-3306.34 751.74,-3297.47"/>
<polygon fill="black" stroke="black" points="755.24,-3297.36 752.04,-3287.26 748.25,-3297.16 755.24,-3297.36"/>
</g>
<!-- l1_out_proj_tp0&#45;&gt;l1_residual_tp0 -->
<g id="edge260" class="edge">
<title>l1_out_proj_tp0&#45;&gt;l1_residual_tp0</title>
<path fill="none" stroke="black" d="M758.81,-3219C760.24,-3210.86 761.82,-3201.8 763.45,-3192.52"/>
<polygon fill="black" stroke="black" points="766.94,-3192.85 765.22,-3182.4 760.05,-3191.65 766.94,-3192.85"/>
</g>
<!-- l1_gate_tp0 -->
<g id="node126" class="node">
<title>l1_gate_tp0</title>
<polygon fill="lightyellow" stroke="black" points="1078.2,-3009.17 748.59,-3009.17 663.8,-2873.17 993.41,-2873.17 1078.2,-3009.17"/>
<text text-anchor="middle" x="871" y="-2959.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="871" y="-2944.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="871" y="-2929.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="871" y="-2914.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_residual_tp0&#45;&gt;l1_gate_tp0 -->
<g id="edge262" class="edge">
<title>l1_residual_tp0&#45;&gt;l1_gate_tp0</title>
<path fill="none" stroke="black" d="M813.88,-3046.07C818.91,-3036.93 824.1,-3027.48 829.21,-3018.19"/>
<polygon fill="black" stroke="black" points="832.32,-3019.8 834.07,-3009.35 826.19,-3016.42 832.32,-3019.8"/>
</g>
<!-- l1_exp0_gpu0 -->
<g id="node127" class="node">
<title>l1_exp0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="958,-2836.17 784,-2836.17 784,-2768.17 958,-2768.17 958,-2836.17"/>
<text text-anchor="middle" x="871" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="871" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="871" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="871" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_residual_tp0&#45;&gt;l1_exp0_gpu0 -->
<g id="edge264" class="edge">
<title>l1_residual_tp0&#45;&gt;l1_exp0_gpu0</title>
<path fill="none" stroke="black" d="M680.18,-3045.96C670.03,-3034.86 661.18,-3022.56 655,-3009.17 629.67,-2954.29 619.1,-2921.8 655,-2873.17 686.33,-2830.72 718.24,-2850.92 774,-2836.17"/>
<polygon fill="black" stroke="black" points="775.32,-2839.43 783.92,-2833.24 773.34,-2832.71 775.32,-2839.43"/>
</g>
<!-- l1_exp1_gpu0 -->
<g id="node128" class="node">
<title>l1_exp1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="766,-2836.17 592,-2836.17 592,-2768.17 766,-2768.17 766,-2836.17"/>
<text text-anchor="middle" x="679" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="679" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="679" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="679" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_residual_tp0&#45;&gt;l1_exp1_gpu0 -->
<g id="edge267" class="edge">
<title>l1_residual_tp0&#45;&gt;l1_exp1_gpu0</title>
<path fill="none" stroke="black" d="M658.25,-3046.16C646.97,-3035.23 637.11,-3022.91 630,-3009.17 602.22,-2955.48 611.83,-2930.81 630,-2873.17 633.08,-2863.4 638.06,-2853.82 643.69,-2845.03"/>
<polygon fill="black" stroke="black" points="646.75,-2846.75 649.49,-2836.52 640.96,-2842.81 646.75,-2846.75"/>
</g>
<!-- l1_exp2_gpu0 -->
<g id="node129" class="node">
<title>l1_exp2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="190,-2836.17 16,-2836.17 16,-2768.17 190,-2768.17 190,-2836.17"/>
<text text-anchor="middle" x="103" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="103" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="103" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="103" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_residual_tp0&#45;&gt;l1_exp2_gpu0 -->
<g id="edge270" class="edge">
<title>l1_residual_tp0&#45;&gt;l1_exp2_gpu0</title>
<path fill="none" stroke="black" d="M441.75,-3046.08C411.08,-3035.46 381.03,-3023.23 353,-3009.17 268.06,-2966.57 186.34,-2890.46 140.59,-2843.64"/>
<polygon fill="black" stroke="black" points="143.03,-2841.13 133.56,-2836.39 138.01,-2846 143.03,-2841.13"/>
</g>
<!-- l1_exp3_gpu0 -->
<g id="node130" class="node">
<title>l1_exp3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="382,-2836.17 208,-2836.17 208,-2768.17 382,-2768.17 382,-2836.17"/>
<text text-anchor="middle" x="295" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="295" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="295" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="295" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_residual_tp0&#45;&gt;l1_exp3_gpu0 -->
<g id="edge273" class="edge">
<title>l1_residual_tp0&#45;&gt;l1_exp3_gpu0</title>
<path fill="none" stroke="black" d="M582.52,-3046.05C558.75,-3035.03 535.35,-3022.72 514,-3009.17 440.68,-2962.62 370.17,-2889.56 329.77,-2844.12"/>
<polygon fill="black" stroke="black" points="332.31,-2841.7 323.07,-2836.52 327.06,-2846.33 332.31,-2841.7"/>
</g>
<!-- l1_exp4_gpu0 -->
<g id="node131" class="node">
<title>l1_exp4_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="574,-2836.17 400,-2836.17 400,-2768.17 574,-2768.17 574,-2836.17"/>
<text text-anchor="middle" x="487" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="487" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="487" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="487" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_residual_tp0&#45;&gt;l1_exp4_gpu0 -->
<g id="edge276" class="edge">
<title>l1_residual_tp0&#45;&gt;l1_exp4_gpu0</title>
<path fill="none" stroke="black" d="M650.92,-3045.95C635.49,-3034.83 620.71,-3022.51 608,-3009.17 561.37,-2960.19 525.05,-2890.05 504.83,-2845.56"/>
<polygon fill="black" stroke="black" points="507.92,-2843.9 500.64,-2836.2 501.53,-2846.76 507.92,-2843.9"/>
</g>
<!-- l1_exp5_gpu0 -->
<g id="node132" class="node">
<title>l1_exp5_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1342,-2836.17 1168,-2836.17 1168,-2768.17 1342,-2768.17 1342,-2836.17"/>
<text text-anchor="middle" x="1255" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="1255" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1255" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1255" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_residual_tp0&#45;&gt;l1_exp5_gpu0 -->
<g id="edge279" class="edge">
<title>l1_residual_tp0&#45;&gt;l1_exp5_gpu0</title>
<path fill="none" stroke="black" d="M1002.91,-3058.8C1028.09,-3049.86 1052.95,-3039.69 1076,-3028.17 1153.72,-2989.33 1208.5,-2899.3 1235.61,-2845.64"/>
<polygon fill="black" stroke="black" points="1238.89,-2846.9 1240.19,-2836.38 1232.61,-2843.79 1238.89,-2846.9"/>
</g>
<!-- l1_exp6_gpu0 -->
<g id="node133" class="node">
<title>l1_exp6_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1534,-2836.17 1360,-2836.17 1360,-2768.17 1534,-2768.17 1534,-2836.17"/>
<text text-anchor="middle" x="1447" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1447" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1447" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1447" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_residual_tp0&#45;&gt;l1_exp6_gpu0 -->
<g id="edge282" class="edge">
<title>l1_residual_tp0&#45;&gt;l1_exp6_gpu0</title>
<path fill="none" stroke="black" d="M1011.26,-3066.5C1064.5,-3051.7 1119.83,-3032.83 1169,-3009.17 1260.39,-2965.19 1352.15,-2889.62 1404.04,-2843.26"/>
<polygon fill="black" stroke="black" points="1406.62,-2845.64 1411.71,-2836.35 1401.94,-2840.44 1406.62,-2845.64"/>
</g>
<!-- l1_exp7_gpu0 -->
<g id="node134" class="node">
<title>l1_exp7_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1150,-2836.17 976,-2836.17 976,-2768.17 1150,-2768.17 1150,-2836.17"/>
<text text-anchor="middle" x="1063" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="1063" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1063" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1063" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_residual_tp0&#45;&gt;l1_exp7_gpu0 -->
<g id="edge285" class="edge">
<title>l1_residual_tp0&#45;&gt;l1_exp7_gpu0</title>
<path fill="none" stroke="black" d="M1014.62,-3069.37C1042.94,-3054.64 1068.35,-3035.09 1087,-3009.17 1121.38,-2961.38 1102.05,-2890.6 1083.6,-2845.69"/>
<polygon fill="black" stroke="black" points="1086.71,-2844.07 1079.57,-2836.25 1080.27,-2846.82 1086.71,-2844.07"/>
</g>
<!-- l1_final_res_tp0 -->
<g id="node136" class="node">
<title>l1_final_res_tp0</title>
<polygon fill="lightyellow" stroke="black" points="1306.93,-2558.17 735.95,-2558.17 589.07,-2422.17 1160.05,-2422.17 1306.93,-2558.17"/>
<text text-anchor="middle" x="948" y="-2508.97" font-family="Times,serif" font-size="14.00">Layer 1 Final Residual</text>
<text text-anchor="middle" x="948" y="-2493.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="948" y="-2478.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="948" y="-2463.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_residual_tp0&#45;&gt;l1_final_res_tp0 -->
<g id="edge288" class="edge">
<title>l1_residual_tp0&#45;&gt;l1_final_res_tp0</title>
<path fill="none" stroke="black" d="M1051.41,-3103.74C1274.68,-3088.33 1553,-3047.92 1553,-2942.17 1553,-2942.17 1553,-2942.17 1553,-2662.17 1553,-2597.68 1424.1,-2556.29 1285.3,-2530.42"/>
<polygon fill="black" stroke="black" points="1285.76,-2526.94 1275.29,-2528.58 1284.49,-2533.83 1285.76,-2526.94"/>
</g>
<!-- l1_gate_tp0&#45;&gt;l1_exp0_gpu0 -->
<g id="edge263" class="edge">
<title>l1_gate_tp0&#45;&gt;l1_exp0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M871,-2872.87C871,-2863.93 871,-2854.95 871,-2846.56"/>
<polygon fill="black" stroke="black" points="874.5,-2846.29 871,-2836.29 867.5,-2846.29 874.5,-2846.29"/>
</g>
<!-- l1_gate_tp0&#45;&gt;l1_exp1_gpu0 -->
<g id="edge266" class="edge">
<title>l1_gate_tp0&#45;&gt;l1_exp1_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M776.97,-2873.07C762.18,-2862.52 747.32,-2851.92 733.81,-2842.28"/>
<polygon fill="black" stroke="black" points="735.76,-2839.36 725.58,-2836.41 731.69,-2845.06 735.76,-2839.36"/>
</g>
<!-- l1_gate_tp0&#45;&gt;l1_exp2_gpu0 -->
<g id="edge269" class="edge">
<title>l1_gate_tp0&#45;&gt;l1_exp2_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M693.86,-2921.46C559.9,-2905.27 371.74,-2878.13 199.91,-2836.26"/>
<polygon fill="black" stroke="black" points="200.73,-2832.86 190.18,-2833.87 199.06,-2839.65 200.73,-2832.86"/>
</g>
<!-- l1_gate_tp0&#45;&gt;l1_exp3_gpu0 -->
<g id="edge272" class="edge">
<title>l1_gate_tp0&#45;&gt;l1_exp3_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M677.82,-2896.14C615.98,-2882.34 547.17,-2867.3 484,-2854.17 445.68,-2846.2 433.38,-2846.88 392.1,-2836.32"/>
<polygon fill="black" stroke="black" points="392.78,-2832.88 382.22,-2833.73 391,-2839.65 392.78,-2832.88"/>
</g>
<!-- l1_gate_tp0&#45;&gt;l1_exp4_gpu0 -->
<g id="edge275" class="edge">
<title>l1_gate_tp0&#45;&gt;l1_exp4_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M682.94,-2873.07C648.64,-2860.84 614.18,-2848.54 583.93,-2837.75"/>
<polygon fill="black" stroke="black" points="584.86,-2834.36 574.26,-2834.3 582.51,-2840.96 584.86,-2834.36"/>
</g>
<!-- l1_gate_tp0&#45;&gt;l1_exp5_gpu0 -->
<g id="edge278" class="edge">
<title>l1_gate_tp0&#45;&gt;l1_exp5_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1005.57,-2892.15C1055.83,-2874.22 1111.87,-2854.23 1158.08,-2837.74"/>
<polygon fill="black" stroke="black" points="1159.54,-2840.94 1167.79,-2834.28 1157.19,-2834.35 1159.54,-2840.94"/>
</g>
<!-- l1_gate_tp0&#45;&gt;l1_exp6_gpu0 -->
<g id="edge281" class="edge">
<title>l1_gate_tp0&#45;&gt;l1_exp6_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1018.36,-2912.91C1111.28,-2894.61 1233.73,-2868.45 1349.97,-2836.36"/>
<polygon fill="black" stroke="black" points="1351.06,-2839.69 1359.76,-2833.64 1349.19,-2832.95 1351.06,-2839.69"/>
</g>
<!-- l1_gate_tp0&#45;&gt;l1_exp7_gpu0 -->
<g id="edge284" class="edge">
<title>l1_gate_tp0&#45;&gt;l1_exp7_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M956.96,-2872.97C965.68,-2866.51 974.47,-2860.15 983,-2854.17 988.84,-2850.07 995,-2845.9 1001.19,-2841.8"/>
<polygon fill="black" stroke="black" points="1003.2,-2844.68 1009.64,-2836.27 999.36,-2838.82 1003.2,-2844.68"/>
</g>
<!-- l1_exp_agg_tp0 -->
<g id="node135" class="node">
<title>l1_exp_agg_tp0</title>
<polygon fill="lightyellow" stroke="black" points="1090.58,-2731.17 741.28,-2731.17 651.42,-2595.17 1000.72,-2595.17 1090.58,-2731.17"/>
<text text-anchor="middle" x="871" y="-2681.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="871" y="-2666.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="871" y="-2651.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="871" y="-2636.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_exp0_gpu0&#45;&gt;l1_exp_agg_tp0 -->
<g id="edge265" class="edge">
<title>l1_exp0_gpu0&#45;&gt;l1_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M871,-2768C871,-2759.86 871,-2750.8 871,-2741.52"/>
<polygon fill="black" stroke="black" points="874.5,-2741.4 871,-2731.4 867.5,-2741.4 874.5,-2741.4"/>
</g>
<!-- l1_exp1_gpu0&#45;&gt;l1_exp_agg_tp0 -->
<g id="edge268" class="edge">
<title>l1_exp1_gpu0&#45;&gt;l1_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M725.48,-2768C738.59,-2758.65 753.39,-2748.08 768.42,-2737.36"/>
<polygon fill="black" stroke="black" points="770.67,-2740.06 776.78,-2731.4 766.6,-2734.36 770.67,-2740.06"/>
</g>
<!-- l1_exp2_gpu0&#45;&gt;l1_exp_agg_tp0 -->
<g id="edge271" class="edge">
<title>l1_exp2_gpu0&#45;&gt;l1_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M190.18,-2770.46C193.15,-2769.65 196.09,-2768.89 199,-2768.17 366.29,-2726.82 561.29,-2698.81 698.01,-2682.37"/>
<polygon fill="black" stroke="black" points="698.65,-2685.82 708.16,-2681.16 697.82,-2678.87 698.65,-2685.82"/>
</g>
<!-- l1_exp3_gpu0&#45;&gt;l1_exp_agg_tp0 -->
<g id="edge274" class="edge">
<title>l1_exp3_gpu0&#45;&gt;l1_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M382.24,-2770.69C385.19,-2769.82 388.11,-2768.97 391,-2768.17 494.61,-2739.24 612.66,-2713.57 705.77,-2694.97"/>
<polygon fill="black" stroke="black" points="706.72,-2698.35 715.85,-2692.96 705.35,-2691.48 706.72,-2698.35"/>
</g>
<!-- l1_exp4_gpu0&#45;&gt;l1_exp_agg_tp0 -->
<g id="edge277" class="edge">
<title>l1_exp4_gpu0&#45;&gt;l1_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M574.14,-2770.08C617.38,-2754.65 670.85,-2735.57 720.45,-2717.88"/>
<polygon fill="black" stroke="black" points="721.75,-2721.13 729.99,-2714.48 719.39,-2714.54 721.75,-2721.13"/>
</g>
<!-- l1_exp5_gpu0&#45;&gt;l1_exp_agg_tp0 -->
<g id="edge280" class="edge">
<title>l1_exp5_gpu0&#45;&gt;l1_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M1167.86,-2770.08C1138.13,-2759.47 1103.56,-2747.14 1068.73,-2734.71"/>
<polygon fill="black" stroke="black" points="1069.5,-2731.27 1058.91,-2731.21 1067.15,-2737.86 1069.5,-2731.27"/>
</g>
<!-- l1_exp6_gpu0&#45;&gt;l1_exp_agg_tp0 -->
<g id="edge283" class="edge">
<title>l1_exp6_gpu0&#45;&gt;l1_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M1359.76,-2770.69C1356.81,-2769.82 1353.89,-2768.97 1351,-2768.17 1263.51,-2743.74 1165.71,-2721.64 1081.34,-2704.15"/>
<polygon fill="black" stroke="black" points="1081.88,-2700.69 1071.38,-2702.09 1080.47,-2707.54 1081.88,-2700.69"/>
</g>
<!-- l1_exp7_gpu0&#45;&gt;l1_exp_agg_tp0 -->
<g id="edge286" class="edge">
<title>l1_exp7_gpu0&#45;&gt;l1_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M1016.52,-2768C1003.41,-2758.65 988.61,-2748.08 973.58,-2737.36"/>
<polygon fill="black" stroke="black" points="975.4,-2734.36 965.22,-2731.4 971.33,-2740.06 975.4,-2734.36"/>
</g>
<!-- l1_exp_agg_tp0&#45;&gt;l1_final_res_tp0 -->
<g id="edge287" class="edge">
<title>l1_exp_agg_tp0&#45;&gt;l1_final_res_tp0</title>
<path fill="none" stroke="black" d="M901.21,-2595.07C905.29,-2586.02 909.49,-2576.68 913.64,-2567.48"/>
<polygon fill="black" stroke="black" points="916.83,-2568.9 917.75,-2558.35 910.45,-2566.03 916.83,-2568.9"/>
</g>
<!-- l2_qkv_tp0 -->
<g id="node242" class="node">
<title>l2_qkv_tp0</title>
<polygon fill="lightgreen" stroke="black" points="1061,-2320.17 835,-2320.17 835,-2252.17 1061,-2252.17 1061,-2320.17"/>
<text text-anchor="middle" x="948" y="-2304.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="948" y="-2289.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="948" y="-2274.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="948" y="-2259.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l1_final_res_tp0&#45;&gt;l2_qkv_tp0 -->
<g id="edge513" class="edge">
<title>l1_final_res_tp0&#45;&gt;l2_qkv_tp0</title>
<path fill="none" stroke="black" d="M948,-2421.9C948,-2391.71 948,-2356.97 948,-2330.33"/>
<polygon fill="black" stroke="black" points="951.5,-2330.18 948,-2320.18 944.5,-2330.18 951.5,-2330.18"/>
<text text-anchor="middle" x="1004.5" y="-2392.97" font-family="Times,serif" font-size="14.00">Pipeline P2P</text>
<text text-anchor="middle" x="1004.5" y="-2377.97" font-family="Times,serif" font-size="14.00">GPU 0  GPU 8</text>
</g>
<!-- l1_attn_tp1 -->
<g id="node138" class="node">
<title>l1_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="2552,-3392.17 2338,-3392.17 2338,-3324.17 2552,-3324.17 2552,-3392.17"/>
<text text-anchor="middle" x="2445" y="-3376.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2445" y="-3361.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="2445" y="-3346.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="2445" y="-3331.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_qkv_tp1&#45;&gt;l1_attn_tp1 -->
<g id="edge290" class="edge">
<title>l1_qkv_tp1&#45;&gt;l1_attn_tp1</title>
<path fill="none" stroke="black" d="M2442.97,-3429.01C2443.21,-3420.56 2443.48,-3411.34 2443.74,-3402.47"/>
<polygon fill="black" stroke="black" points="2447.24,-3402.36 2444.04,-3392.26 2440.25,-3402.16 2447.24,-3402.36"/>
</g>
<!-- l1_out_proj_tp1 -->
<g id="node139" class="node">
<title>l1_out_proj_tp1</title>
<polygon fill="lightgreen" stroke="black" points="2554,-3287.17 2342,-3287.17 2342,-3219.17 2554,-3219.17 2554,-3287.17"/>
<text text-anchor="middle" x="2448" y="-3271.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2448" y="-3256.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="2448" y="-3241.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="2448" y="-3226.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_attn_tp1&#45;&gt;l1_out_proj_tp1 -->
<g id="edge291" class="edge">
<title>l1_attn_tp1&#45;&gt;l1_out_proj_tp1</title>
<path fill="none" stroke="black" d="M2445.97,-3324.01C2446.21,-3315.56 2446.48,-3306.34 2446.74,-3297.47"/>
<polygon fill="black" stroke="black" points="2450.24,-3297.36 2447.04,-3287.26 2443.25,-3297.16 2450.24,-3297.36"/>
</g>
<!-- l1_out_proj_tp1&#45;&gt;l1_residual_tp1 -->
<g id="edge292" class="edge">
<title>l1_out_proj_tp1&#45;&gt;l1_residual_tp1</title>
<path fill="none" stroke="black" d="M2470.51,-3219C2476.39,-3210.34 2482.98,-3200.64 2489.7,-3190.74"/>
<polygon fill="black" stroke="black" points="2492.64,-3192.64 2495.36,-3182.4 2486.85,-3188.71 2492.64,-3192.64"/>
</g>
<!-- l1_gate_tp1 -->
<g id="node141" class="node">
<title>l1_gate_tp1</title>
<polygon fill="lightyellow" stroke="black" points="2580.2,-3009.17 2250.59,-3009.17 2165.8,-2873.17 2495.41,-2873.17 2580.2,-3009.17"/>
<text text-anchor="middle" x="2373" y="-2959.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="2373" y="-2944.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="2373" y="-2929.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="2373" y="-2914.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_residual_tp1&#45;&gt;l1_gate_tp1 -->
<g id="edge294" class="edge">
<title>l1_residual_tp1&#45;&gt;l1_gate_tp1</title>
<path fill="none" stroke="black" d="M2475.08,-3046.07C2465.63,-3036.46 2455.86,-3026.51 2446.28,-3016.76"/>
<polygon fill="black" stroke="black" points="2448.51,-3014.03 2439,-3009.35 2443.51,-3018.93 2448.51,-3014.03"/>
</g>
<!-- l1_exp0_gpu1 -->
<g id="node142" class="node">
<title>l1_exp0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2322,-2836.17 2148,-2836.17 2148,-2768.17 2322,-2768.17 2322,-2836.17"/>
<text text-anchor="middle" x="2235" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="2235" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2235" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2235" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_residual_tp1&#45;&gt;l1_exp0_gpu1 -->
<g id="edge296" class="edge">
<title>l1_residual_tp1&#45;&gt;l1_exp0_gpu1</title>
<path fill="none" stroke="black" d="M2215.61,-3046.16C2188.54,-3035.2 2167.49,-3022.88 2157,-3009.17 2120.27,-2961.16 2132.37,-2928.37 2157,-2873.17 2161.92,-2862.13 2169.54,-2852.11 2178.12,-2843.32"/>
<polygon fill="black" stroke="black" points="2180.72,-2845.68 2185.52,-2836.23 2175.88,-2840.63 2180.72,-2845.68"/>
</g>
<!-- l1_exp1_gpu1 -->
<g id="node143" class="node">
<title>l1_exp1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2898,-2836.17 2724,-2836.17 2724,-2768.17 2898,-2768.17 2898,-2836.17"/>
<text text-anchor="middle" x="2811" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2811" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2811" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2811" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_residual_tp1&#45;&gt;l1_exp1_gpu1 -->
<g id="edge299" class="edge">
<title>l1_residual_tp1&#45;&gt;l1_exp1_gpu1</title>
<path fill="none" stroke="black" d="M2599.59,-3045.9C2653.14,-2984.42 2730.61,-2895.47 2775.38,-2844.06"/>
<polygon fill="black" stroke="black" points="2778.08,-2846.29 2782.01,-2836.45 2772.8,-2841.69 2778.08,-2846.29"/>
</g>
<!-- l1_exp2_gpu1 -->
<g id="node144" class="node">
<title>l1_exp2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2130,-2836.17 1956,-2836.17 1956,-2768.17 2130,-2768.17 2130,-2836.17"/>
<text text-anchor="middle" x="2043" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2043" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2043" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2043" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_residual_tp1&#45;&gt;l1_exp2_gpu1 -->
<g id="edge302" class="edge">
<title>l1_residual_tp1&#45;&gt;l1_exp2_gpu1</title>
<path fill="none" stroke="black" d="M2198.98,-3046.08C2167.66,-3035.03 2142.59,-3022.7 2129,-3009.17 2083.95,-2964.28 2061.32,-2892.3 2050.87,-2846.4"/>
<polygon fill="black" stroke="black" points="2054.26,-2845.49 2048.71,-2836.46 2047.42,-2846.98 2054.26,-2845.49"/>
</g>
<!-- l1_exp3_gpu1 -->
<g id="node145" class="node">
<title>l1_exp3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1938,-2836.17 1764,-2836.17 1764,-2768.17 1938,-2768.17 1938,-2836.17"/>
<text text-anchor="middle" x="1851" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1851" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1851" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1851" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_residual_tp1&#45;&gt;l1_exp3_gpu1 -->
<g id="edge305" class="edge">
<title>l1_residual_tp1&#45;&gt;l1_exp3_gpu1</title>
<path fill="none" stroke="black" d="M2207.06,-3069.35C2153.6,-3054.71 2100.35,-3035.19 2053,-3009.17 1979.09,-2968.54 1915.01,-2892.23 1879.81,-2844.76"/>
<polygon fill="black" stroke="black" points="1882.52,-2842.53 1873.79,-2836.53 1876.87,-2846.67 1882.52,-2842.53"/>
</g>
<!-- l1_exp4_gpu1 -->
<g id="node146" class="node">
<title>l1_exp4_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1746,-2836.17 1572,-2836.17 1572,-2768.17 1746,-2768.17 1746,-2836.17"/>
<text text-anchor="middle" x="1659" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1659" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1659" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1659" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_residual_tp1&#45;&gt;l1_exp4_gpu1 -->
<g id="edge308" class="edge">
<title>l1_residual_tp1&#45;&gt;l1_exp4_gpu1</title>
<path fill="none" stroke="black" d="M2238.43,-3098.67C2127.39,-3084.59 2003.2,-3058.16 1898,-3009.17 1813.57,-2969.84 1735.86,-2891.88 1693.19,-2843.95"/>
<polygon fill="black" stroke="black" points="1695.63,-2841.43 1686.39,-2836.24 1690.38,-2846.05 1695.63,-2841.43"/>
</g>
<!-- l1_exp5_gpu1 -->
<g id="node147" class="node">
<title>l1_exp5_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3090,-2836.17 2916,-2836.17 2916,-2768.17 3090,-2768.17 3090,-2836.17"/>
<text text-anchor="middle" x="3003" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3003" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3003" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3003" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_residual_tp1&#45;&gt;l1_exp5_gpu1 -->
<g id="edge311" class="edge">
<title>l1_residual_tp1&#45;&gt;l1_exp5_gpu1</title>
<path fill="none" stroke="black" d="M2640.96,-3046.09C2733.83,-2983.78 2868.92,-2893.14 2945.1,-2842.02"/>
<polygon fill="black" stroke="black" points="2947.29,-2844.77 2953.64,-2836.29 2943.39,-2838.95 2947.29,-2844.77"/>
</g>
<!-- l1_exp6_gpu1 -->
<g id="node148" class="node">
<title>l1_exp6_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2706,-2836.17 2532,-2836.17 2532,-2768.17 2706,-2768.17 2706,-2836.17"/>
<text text-anchor="middle" x="2619" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2619" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2619" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2619" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_residual_tp1&#45;&gt;l1_exp6_gpu1 -->
<g id="edge314" class="edge">
<title>l1_residual_tp1&#45;&gt;l1_exp6_gpu1</title>
<path fill="none" stroke="black" d="M2595.83,-3045.99C2598.99,-3040.17 2601.78,-3034.2 2604,-3028.17 2626.1,-2968.04 2626.08,-2892.86 2623.18,-2846.43"/>
<polygon fill="black" stroke="black" points="2626.67,-2846.14 2622.48,-2836.4 2619.69,-2846.62 2626.67,-2846.14"/>
</g>
<!-- l1_exp7_gpu1 -->
<g id="node149" class="node">
<title>l1_exp7_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2514,-2836.17 2340,-2836.17 2340,-2768.17 2514,-2768.17 2514,-2836.17"/>
<text text-anchor="middle" x="2427" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2427" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2427" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2427" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_residual_tp1&#45;&gt;l1_exp7_gpu1 -->
<g id="edge317" class="edge">
<title>l1_residual_tp1&#45;&gt;l1_exp7_gpu1</title>
<path fill="none" stroke="black" d="M2577.01,-3046.11C2581.97,-3034.11 2586.29,-3021.5 2589,-3009.17 2595.48,-2979.65 2605.6,-2898.42 2589,-2873.17 2584.52,-2866.35 2555.74,-2853.09 2523.64,-2839.93"/>
<polygon fill="black" stroke="black" points="2524.64,-2836.56 2514.06,-2836.04 2522.01,-2843.05 2524.64,-2836.56"/>
</g>
<!-- l1_final_res_tp1 -->
<g id="node151" class="node">
<title>l1_final_res_tp1</title>
<polygon fill="lightyellow" stroke="black" points="3173.93,-2558.17 2602.95,-2558.17 2456.07,-2422.17 3027.05,-2422.17 3173.93,-2558.17"/>
<text text-anchor="middle" x="2815" y="-2508.97" font-family="Times,serif" font-size="14.00">Layer 1 Final Residual</text>
<text text-anchor="middle" x="2815" y="-2493.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="2815" y="-2478.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="2815" y="-2463.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_residual_tp1&#45;&gt;l1_final_res_tp1 -->
<g id="edge320" class="edge">
<title>l1_residual_tp1&#45;&gt;l1_final_res_tp1</title>
<path fill="none" stroke="black" d="M2793.03,-3082.75C2944.84,-3057.12 3109,-3013.03 3109,-2942.17 3109,-2942.17 3109,-2942.17 3109,-2662.17 3109,-2620.25 3086.4,-2588.43 3053.72,-2564.34"/>
<polygon fill="black" stroke="black" points="3055.41,-2561.24 3045.21,-2558.38 3051.39,-2566.98 3055.41,-2561.24"/>
</g>
<!-- l1_gate_tp1&#45;&gt;l1_exp0_gpu1 -->
<g id="edge295" class="edge">
<title>l1_gate_tp1&#45;&gt;l1_exp0_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2305.21,-2872.87C2295.1,-2862.83 2284.95,-2852.76 2275.64,-2843.51"/>
<polygon fill="black" stroke="black" points="2277.93,-2840.86 2268.37,-2836.29 2273,-2845.82 2277.93,-2840.86"/>
</g>
<!-- l1_gate_tp1&#45;&gt;l1_exp1_gpu1 -->
<g id="edge298" class="edge">
<title>l1_gate_tp1&#45;&gt;l1_exp1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2506.46,-2890.71C2544.15,-2877.76 2585.41,-2864.54 2624,-2854.17 2661.01,-2844.21 2673.45,-2846.48 2714.06,-2836.26"/>
<polygon fill="black" stroke="black" points="2714.99,-2839.63 2723.78,-2833.71 2713.22,-2832.86 2714.99,-2839.63"/>
</g>
<!-- l1_gate_tp1&#45;&gt;l1_exp2_gpu1 -->
<g id="edge301" class="edge">
<title>l1_gate_tp1&#45;&gt;l1_exp2_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2211.38,-2873.07C2184.02,-2861.71 2156.52,-2850.3 2131.92,-2840.08"/>
<polygon fill="black" stroke="black" points="2133.22,-2836.83 2122.64,-2836.23 2130.53,-2843.3 2133.22,-2836.83"/>
</g>
<!-- l1_gate_tp1&#45;&gt;l1_exp3_gpu1 -->
<g id="edge304" class="edge">
<title>l1_gate_tp1&#45;&gt;l1_exp3_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2178.42,-2893.52C2085.98,-2871.22 1988.38,-2847.42 1947.71,-2836.22"/>
<polygon fill="black" stroke="black" points="1948.58,-2832.83 1938.01,-2833.46 1946.67,-2839.56 1948.58,-2832.83"/>
</g>
<!-- l1_gate_tp1&#45;&gt;l1_exp4_gpu1 -->
<g id="edge307" class="edge">
<title>l1_gate_tp1&#45;&gt;l1_exp4_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2193.56,-2917.92C2072.01,-2900.96 1908,-2874.39 1756.18,-2836.34"/>
<polygon fill="black" stroke="black" points="1756.75,-2832.88 1746.19,-2833.82 1755.03,-2839.66 1756.75,-2832.88"/>
</g>
<!-- l1_gate_tp1&#45;&gt;l1_exp5_gpu1 -->
<g id="edge310" class="edge">
<title>l1_gate_tp1&#45;&gt;l1_exp5_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2520.17,-2912.59C2656.3,-2886.92 2845.37,-2850.79 2905.76,-2836.25"/>
<polygon fill="black" stroke="black" points="2906.94,-2839.57 2915.78,-2833.72 2905.23,-2832.78 2906.94,-2839.57"/>
</g>
<!-- l1_gate_tp1&#45;&gt;l1_exp6_gpu1 -->
<g id="edge313" class="edge">
<title>l1_gate_tp1&#45;&gt;l1_exp6_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2493.48,-2873.07C2513.07,-2862.16 2532.75,-2851.2 2550.52,-2841.3"/>
<polygon fill="black" stroke="black" points="2552.6,-2844.15 2559.63,-2836.23 2549.19,-2838.04 2552.6,-2844.15"/>
</g>
<!-- l1_gate_tp1&#45;&gt;l1_exp7_gpu1 -->
<g id="edge316" class="edge">
<title>l1_gate_tp1&#45;&gt;l1_exp7_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2399.53,-2872.87C2403.17,-2863.63 2406.82,-2854.35 2410.22,-2845.73"/>
<polygon fill="black" stroke="black" points="2413.53,-2846.88 2413.94,-2836.29 2407.02,-2844.31 2413.53,-2846.88"/>
</g>
<!-- l1_exp_agg_tp1 -->
<g id="node150" class="node">
<title>l1_exp_agg_tp1</title>
<polygon fill="lightyellow" stroke="black" points="2646.58,-2731.17 2297.28,-2731.17 2207.42,-2595.17 2556.72,-2595.17 2646.58,-2731.17"/>
<text text-anchor="middle" x="2427" y="-2681.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2427" y="-2666.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="2427" y="-2651.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="2427" y="-2636.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_exp0_gpu1&#45;&gt;l1_exp_agg_tp1 -->
<g id="edge297" class="edge">
<title>l1_exp0_gpu1&#45;&gt;l1_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2281.48,-2768C2294.59,-2758.65 2309.39,-2748.08 2324.42,-2737.36"/>
<polygon fill="black" stroke="black" points="2326.67,-2740.06 2332.78,-2731.4 2322.6,-2734.36 2326.67,-2740.06"/>
</g>
<!-- l1_exp1_gpu1&#45;&gt;l1_exp_agg_tp1 -->
<g id="edge300" class="edge">
<title>l1_exp1_gpu1&#45;&gt;l1_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2723.86,-2770.08C2694.13,-2759.47 2659.56,-2747.14 2624.73,-2734.71"/>
<polygon fill="black" stroke="black" points="2625.5,-2731.27 2614.91,-2731.21 2623.15,-2737.86 2625.5,-2731.27"/>
</g>
<!-- l1_exp2_gpu1&#45;&gt;l1_exp_agg_tp1 -->
<g id="edge303" class="edge">
<title>l1_exp2_gpu1&#45;&gt;l1_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2130.14,-2770.08C2173.38,-2754.65 2226.85,-2735.57 2276.45,-2717.88"/>
<polygon fill="black" stroke="black" points="2277.75,-2721.13 2285.99,-2714.48 2275.39,-2714.54 2277.75,-2721.13"/>
</g>
<!-- l1_exp3_gpu1&#45;&gt;l1_exp_agg_tp1 -->
<g id="edge306" class="edge">
<title>l1_exp3_gpu1&#45;&gt;l1_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M1938.24,-2770.69C1941.19,-2769.82 1944.11,-2768.97 1947,-2768.17 2050.61,-2739.24 2168.66,-2713.57 2261.77,-2694.97"/>
<polygon fill="black" stroke="black" points="2262.72,-2698.35 2271.85,-2692.96 2261.35,-2691.48 2262.72,-2698.35"/>
</g>
<!-- l1_exp4_gpu1&#45;&gt;l1_exp_agg_tp1 -->
<g id="edge309" class="edge">
<title>l1_exp4_gpu1&#45;&gt;l1_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M1746.18,-2770.46C1749.15,-2769.65 1752.09,-2768.89 1755,-2768.17 1922.29,-2726.82 2117.29,-2698.81 2254.01,-2682.37"/>
<polygon fill="black" stroke="black" points="2254.65,-2685.82 2264.16,-2681.16 2253.82,-2678.87 2254.65,-2685.82"/>
</g>
<!-- l1_exp5_gpu1&#45;&gt;l1_exp_agg_tp1 -->
<g id="edge312" class="edge">
<title>l1_exp5_gpu1&#45;&gt;l1_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2915.76,-2770.69C2912.81,-2769.82 2909.89,-2768.97 2907,-2768.17 2819.51,-2743.74 2721.71,-2721.64 2637.34,-2704.15"/>
<polygon fill="black" stroke="black" points="2637.88,-2700.69 2627.38,-2702.09 2636.47,-2707.54 2637.88,-2700.69"/>
</g>
<!-- l1_exp6_gpu1&#45;&gt;l1_exp_agg_tp1 -->
<g id="edge315" class="edge">
<title>l1_exp6_gpu1&#45;&gt;l1_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2572.52,-2768C2559.41,-2758.65 2544.61,-2748.08 2529.58,-2737.36"/>
<polygon fill="black" stroke="black" points="2531.4,-2734.36 2521.22,-2731.4 2527.33,-2740.06 2531.4,-2734.36"/>
</g>
<!-- l1_exp7_gpu1&#45;&gt;l1_exp_agg_tp1 -->
<g id="edge318" class="edge">
<title>l1_exp7_gpu1&#45;&gt;l1_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2427,-2768C2427,-2759.86 2427,-2750.8 2427,-2741.52"/>
<polygon fill="black" stroke="black" points="2430.5,-2741.4 2427,-2731.4 2423.5,-2741.4 2430.5,-2741.4"/>
</g>
<!-- l1_exp_agg_tp1&#45;&gt;l1_final_res_tp1 -->
<g id="edge319" class="edge">
<title>l1_exp_agg_tp1&#45;&gt;l1_final_res_tp1</title>
<path fill="none" stroke="black" d="M2561.89,-2602.72C2591.43,-2589.7 2623,-2575.79 2653.46,-2562.36"/>
<polygon fill="black" stroke="black" points="2655.14,-2565.45 2662.88,-2558.21 2652.32,-2559.04 2655.14,-2565.45"/>
</g>
<!-- l2_qkv_tp1 -->
<g id="node257" class="node">
<title>l2_qkv_tp1</title>
<polygon fill="lightgreen" stroke="black" points="2928,-2320.17 2702,-2320.17 2702,-2252.17 2928,-2252.17 2928,-2320.17"/>
<text text-anchor="middle" x="2815" y="-2304.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2815" y="-2289.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="2815" y="-2274.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="2815" y="-2259.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l1_final_res_tp1&#45;&gt;l2_qkv_tp1 -->
<g id="edge514" class="edge">
<title>l1_final_res_tp1&#45;&gt;l2_qkv_tp1</title>
<path fill="none" stroke="black" d="M2815,-2421.9C2815,-2391.71 2815,-2356.97 2815,-2330.33"/>
<polygon fill="black" stroke="black" points="2818.5,-2330.18 2815,-2320.18 2811.5,-2330.18 2818.5,-2330.18"/>
<text text-anchor="middle" x="2871.5" y="-2392.97" font-family="Times,serif" font-size="14.00">Pipeline P2P</text>
<text text-anchor="middle" x="2871.5" y="-2377.97" font-family="Times,serif" font-size="14.00">GPU 1  GPU 9</text>
</g>
<!-- l1_attn_tp2 -->
<g id="node153" class="node">
<title>l1_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="3994,-3392.17 3780,-3392.17 3780,-3324.17 3994,-3324.17 3994,-3392.17"/>
<text text-anchor="middle" x="3887" y="-3376.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3887" y="-3361.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="3887" y="-3346.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="3887" y="-3331.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_qkv_tp2&#45;&gt;l1_attn_tp2 -->
<g id="edge322" class="edge">
<title>l1_qkv_tp2&#45;&gt;l1_attn_tp2</title>
<path fill="none" stroke="black" d="M3883.61,-3429.01C3884.02,-3420.56 3884.47,-3411.34 3884.9,-3402.47"/>
<polygon fill="black" stroke="black" points="3888.4,-3402.42 3885.39,-3392.26 3881.41,-3402.08 3888.4,-3402.42"/>
</g>
<!-- l1_out_proj_tp2 -->
<g id="node154" class="node">
<title>l1_out_proj_tp2</title>
<polygon fill="lightgreen" stroke="black" points="3995,-3287.17 3783,-3287.17 3783,-3219.17 3995,-3219.17 3995,-3287.17"/>
<text text-anchor="middle" x="3889" y="-3271.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3889" y="-3256.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="3889" y="-3241.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="3889" y="-3226.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_attn_tp2&#45;&gt;l1_out_proj_tp2 -->
<g id="edge323" class="edge">
<title>l1_attn_tp2&#45;&gt;l1_out_proj_tp2</title>
<path fill="none" stroke="black" d="M3887.64,-3324.01C3887.81,-3315.56 3887.99,-3306.34 3888.16,-3297.47"/>
<polygon fill="black" stroke="black" points="3891.66,-3297.33 3888.36,-3287.26 3884.66,-3297.19 3891.66,-3297.33"/>
</g>
<!-- l1_out_proj_tp2&#45;&gt;l1_residual_tp2 -->
<g id="edge324" class="edge">
<title>l1_out_proj_tp2&#45;&gt;l1_residual_tp2</title>
<path fill="none" stroke="black" d="M3904.25,-3219C3908.11,-3210.6 3912.43,-3201.22 3916.84,-3191.63"/>
<polygon fill="black" stroke="black" points="3920.08,-3192.95 3921.08,-3182.4 3913.72,-3190.02 3920.08,-3192.95"/>
</g>
<!-- l1_gate_tp2 -->
<g id="node156" class="node">
<title>l1_gate_tp2</title>
<polygon fill="lightyellow" stroke="black" points="4190.2,-3009.17 3860.59,-3009.17 3775.8,-2873.17 4105.41,-2873.17 4190.2,-3009.17"/>
<text text-anchor="middle" x="3983" y="-2959.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="3983" y="-2944.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="3983" y="-2929.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="3983" y="-2914.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_residual_tp2&#45;&gt;l1_gate_tp2 -->
<g id="edge326" class="edge">
<title>l1_residual_tp2&#45;&gt;l1_gate_tp2</title>
<path fill="none" stroke="black" d="M3964.16,-3046.07C3965.75,-3037.3 3967.39,-3028.26 3969.01,-3019.34"/>
<polygon fill="black" stroke="black" points="3972.48,-3019.81 3970.82,-3009.35 3965.59,-3018.56 3972.48,-3019.81"/>
</g>
<!-- l1_exp0_gpu2 -->
<g id="node157" class="node">
<title>l1_exp0_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="3302,-2836.17 3128,-2836.17 3128,-2768.17 3302,-2768.17 3302,-2836.17"/>
<text text-anchor="middle" x="3215" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="3215" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3215" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3215" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_residual_tp2&#45;&gt;l1_exp0_gpu2 -->
<g id="edge328" class="edge">
<title>l1_residual_tp2&#45;&gt;l1_exp0_gpu2</title>
<path fill="none" stroke="black" d="M3611.7,-3063.45C3560.14,-3049.56 3508.64,-3031.82 3462,-3009.17 3376.9,-2967.83 3296.25,-2890.97 3251.43,-2843.72"/>
<polygon fill="black" stroke="black" points="3253.95,-2841.29 3244.55,-2836.4 3248.85,-2846.09 3253.95,-2841.29"/>
</g>
<!-- l1_exp1_gpu2 -->
<g id="node158" class="node">
<title>l1_exp1_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="3878,-2836.17 3704,-2836.17 3704,-2768.17 3878,-2768.17 3878,-2836.17"/>
<text text-anchor="middle" x="3791" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3791" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3791" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3791" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_residual_tp2&#45;&gt;l1_exp1_gpu2 -->
<g id="edge331" class="edge">
<title>l1_residual_tp2&#45;&gt;l1_exp1_gpu2</title>
<path fill="none" stroke="black" d="M3773.37,-3045.97C3761.02,-3035.39 3750.24,-3023.2 3742,-3009.17 3711.41,-2957.03 3723.83,-2930.81 3742,-2873.17 3745.08,-2863.4 3750.06,-2853.82 3755.69,-2845.03"/>
<polygon fill="black" stroke="black" points="3758.75,-2846.75 3761.49,-2836.52 3752.96,-2842.81 3758.75,-2846.75"/>
</g>
<!-- l1_exp2_gpu2 -->
<g id="node159" class="node">
<title>l1_exp2_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="4070,-2836.17 3896,-2836.17 3896,-2768.17 4070,-2768.17 4070,-2836.17"/>
<text text-anchor="middle" x="3983" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3983" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3983" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3983" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_residual_tp2&#45;&gt;l1_exp2_gpu2 -->
<g id="edge334" class="edge">
<title>l1_residual_tp2&#45;&gt;l1_exp2_gpu2</title>
<path fill="none" stroke="black" d="M3798.36,-3046.12C3786.02,-3035.42 3775.19,-3023.16 3767,-3009.17 3736.48,-2956.99 3731.1,-2921.8 3767,-2873.17 3798.33,-2830.72 3830.24,-2850.92 3886,-2836.17"/>
<polygon fill="black" stroke="black" points="3887.32,-2839.43 3895.92,-2833.24 3885.34,-2832.71 3887.32,-2839.43"/>
</g>
<!-- l1_exp3_gpu2 -->
<g id="node160" class="node">
<title>l1_exp3_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="3494,-2836.17 3320,-2836.17 3320,-2768.17 3494,-2768.17 3494,-2836.17"/>
<text text-anchor="middle" x="3407" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3407" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3407" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3407" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_residual_tp2&#45;&gt;l1_exp3_gpu2 -->
<g id="edge337" class="edge">
<title>l1_residual_tp2&#45;&gt;l1_exp3_gpu2</title>
<path fill="none" stroke="black" d="M3700.54,-3046.12C3674.29,-3035.35 3648.61,-3023.08 3625,-3009.17 3549.94,-2964.93 3479.87,-2890.52 3440.33,-2844.27"/>
<polygon fill="black" stroke="black" points="3442.92,-2841.91 3433.78,-2836.54 3437.58,-2846.44 3442.92,-2841.91"/>
</g>
<!-- l1_exp4_gpu2 -->
<g id="node161" class="node">
<title>l1_exp4_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="3686,-2836.17 3512,-2836.17 3512,-2768.17 3686,-2768.17 3686,-2836.17"/>
<text text-anchor="middle" x="3599" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3599" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3599" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3599" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_residual_tp2&#45;&gt;l1_exp4_gpu2 -->
<g id="edge340" class="edge">
<title>l1_residual_tp2&#45;&gt;l1_exp4_gpu2</title>
<path fill="none" stroke="black" d="M3765.32,-3046C3748.45,-3035.32 3732.63,-3023.1 3719,-3009.17 3671.82,-2960.92 3636.06,-2890.57 3616.32,-2845.85"/>
<polygon fill="black" stroke="black" points="3619.42,-2844.21 3612.23,-2836.43 3613,-2847 3619.42,-2844.21"/>
</g>
<!-- l1_exp5_gpu2 -->
<g id="node162" class="node">
<title>l1_exp5_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="4262,-2836.17 4088,-2836.17 4088,-2768.17 4262,-2768.17 4262,-2836.17"/>
<text text-anchor="middle" x="4175" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4175" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4175" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4175" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_residual_tp2&#45;&gt;l1_exp5_gpu2 -->
<g id="edge343" class="edge">
<title>l1_residual_tp2&#45;&gt;l1_exp5_gpu2</title>
<path fill="none" stroke="black" d="M4164.38,-3046.33C4177.71,-3035.71 4189.54,-3023.41 4199,-3009.17 4231.47,-2960.26 4212.85,-2890.1 4195.04,-2845.59"/>
<polygon fill="black" stroke="black" points="4198.22,-2844.11 4191.16,-2836.22 4191.76,-2846.8 4198.22,-2844.11"/>
</g>
<!-- l1_exp6_gpu2 -->
<g id="node163" class="node">
<title>l1_exp6_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="4646,-2836.17 4472,-2836.17 4472,-2768.17 4646,-2768.17 4646,-2836.17"/>
<text text-anchor="middle" x="4559" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="4559" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4559" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4559" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_residual_tp2&#45;&gt;l1_exp6_gpu2 -->
<g id="edge346" class="edge">
<title>l1_residual_tp2&#45;&gt;l1_exp6_gpu2</title>
<path fill="none" stroke="black" d="M4173.01,-3054.11C4209.58,-3041.24 4246.47,-3026.26 4280,-3009.17 4370.05,-2963.25 4461.98,-2888.96 4514.6,-2843.27"/>
<polygon fill="black" stroke="black" points="4517.16,-2845.68 4522.38,-2836.46 4512.55,-2840.41 4517.16,-2845.68"/>
</g>
<!-- l1_exp7_gpu2 -->
<g id="node164" class="node">
<title>l1_exp7_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="4454,-2836.17 4280,-2836.17 4280,-2768.17 4454,-2768.17 4454,-2836.17"/>
<text text-anchor="middle" x="4367" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="4367" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4367" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4367" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_residual_tp2&#45;&gt;l1_exp7_gpu2 -->
<g id="edge349" class="edge">
<title>l1_residual_tp2&#45;&gt;l1_exp7_gpu2</title>
<path fill="none" stroke="black" d="M4154.27,-3046.13C4166.22,-3040.48 4177.89,-3034.49 4189,-3028.17 4263.94,-2985.52 4318.92,-2897.67 4346.67,-2845.25"/>
<polygon fill="black" stroke="black" points="4349.86,-2846.69 4351.37,-2836.21 4343.65,-2843.46 4349.86,-2846.69"/>
</g>
<!-- l1_final_res_tp2 -->
<g id="node166" class="node">
<title>l1_final_res_tp2</title>
<polygon fill="lightyellow" stroke="black" points="4390.93,-2558.17 3819.95,-2558.17 3673.07,-2422.17 4244.05,-2422.17 4390.93,-2558.17"/>
<text text-anchor="middle" x="4032" y="-2508.97" font-family="Times,serif" font-size="14.00">Layer 1 Final Residual</text>
<text text-anchor="middle" x="4032" y="-2493.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="4032" y="-2478.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="4032" y="-2463.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_residual_tp2&#45;&gt;l1_final_res_tp2 -->
<g id="edge352" class="edge">
<title>l1_residual_tp2&#45;&gt;l1_final_res_tp2</title>
<path fill="none" stroke="black" d="M4220.54,-3098.32C4422.65,-3079.51 4665,-3037.16 4665,-2942.17 4665,-2942.17 4665,-2942.17 4665,-2662.17 4665,-2591.5 4516.13,-2549.16 4362.78,-2524.29"/>
<polygon fill="black" stroke="black" points="4363.1,-2520.8 4352.67,-2522.68 4362,-2527.71 4363.1,-2520.8"/>
</g>
<!-- l1_gate_tp2&#45;&gt;l1_exp0_gpu2 -->
<g id="edge327" class="edge">
<title>l1_gate_tp2&#45;&gt;l1_exp0_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3805.86,-2921.46C3671.9,-2905.27 3483.74,-2878.13 3311.91,-2836.26"/>
<polygon fill="black" stroke="black" points="3312.73,-2832.86 3302.18,-2833.87 3311.06,-2839.65 3312.73,-2832.86"/>
</g>
<!-- l1_gate_tp2&#45;&gt;l1_exp1_gpu2 -->
<g id="edge330" class="edge">
<title>l1_gate_tp2&#45;&gt;l1_exp1_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3888.97,-2873.07C3874.18,-2862.52 3859.32,-2851.92 3845.81,-2842.28"/>
<polygon fill="black" stroke="black" points="3847.76,-2839.36 3837.58,-2836.41 3843.69,-2845.06 3847.76,-2839.36"/>
</g>
<!-- l1_gate_tp2&#45;&gt;l1_exp2_gpu2 -->
<g id="edge333" class="edge">
<title>l1_gate_tp2&#45;&gt;l1_exp2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3983,-2872.87C3983,-2863.93 3983,-2854.95 3983,-2846.56"/>
<polygon fill="black" stroke="black" points="3986.5,-2846.29 3983,-2836.29 3979.5,-2846.29 3986.5,-2846.29"/>
</g>
<!-- l1_gate_tp2&#45;&gt;l1_exp3_gpu2 -->
<g id="edge336" class="edge">
<title>l1_gate_tp2&#45;&gt;l1_exp3_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3789.82,-2896.14C3727.98,-2882.34 3659.17,-2867.3 3596,-2854.17 3557.68,-2846.2 3545.38,-2846.88 3504.1,-2836.32"/>
<polygon fill="black" stroke="black" points="3504.78,-2832.88 3494.22,-2833.73 3503,-2839.65 3504.78,-2832.88"/>
</g>
<!-- l1_gate_tp2&#45;&gt;l1_exp4_gpu2 -->
<g id="edge339" class="edge">
<title>l1_gate_tp2&#45;&gt;l1_exp4_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3794.94,-2873.07C3760.64,-2860.84 3726.18,-2848.54 3695.93,-2837.75"/>
<polygon fill="black" stroke="black" points="3696.86,-2834.36 3686.26,-2834.3 3694.51,-2840.96 3696.86,-2834.36"/>
</g>
<!-- l1_gate_tp2&#45;&gt;l1_exp5_gpu2 -->
<g id="edge342" class="edge">
<title>l1_gate_tp2&#45;&gt;l1_exp5_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4077.03,-2873.07C4091.82,-2862.52 4106.68,-2851.92 4120.19,-2842.28"/>
<polygon fill="black" stroke="black" points="4122.31,-2845.06 4128.42,-2836.41 4118.24,-2839.36 4122.31,-2845.06"/>
</g>
<!-- l1_gate_tp2&#45;&gt;l1_exp6_gpu2 -->
<g id="edge345" class="edge">
<title>l1_gate_tp2&#45;&gt;l1_exp6_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4130.36,-2912.91C4223.28,-2894.61 4345.73,-2868.45 4461.97,-2836.36"/>
<polygon fill="black" stroke="black" points="4463.06,-2839.69 4471.76,-2833.64 4461.19,-2832.95 4463.06,-2839.69"/>
</g>
<!-- l1_gate_tp2&#45;&gt;l1_exp7_gpu2 -->
<g id="edge348" class="edge">
<title>l1_gate_tp2&#45;&gt;l1_exp7_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4117.57,-2892.15C4167.83,-2874.22 4223.87,-2854.23 4270.08,-2837.74"/>
<polygon fill="black" stroke="black" points="4271.54,-2840.94 4279.79,-2834.28 4269.19,-2834.35 4271.54,-2840.94"/>
</g>
<!-- l1_exp_agg_tp2 -->
<g id="node165" class="node">
<title>l1_exp_agg_tp2</title>
<polygon fill="lightyellow" stroke="black" points="4202.58,-2731.17 3853.28,-2731.17 3763.42,-2595.17 4112.72,-2595.17 4202.58,-2731.17"/>
<text text-anchor="middle" x="3983" y="-2681.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3983" y="-2666.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="3983" y="-2651.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="3983" y="-2636.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_exp0_gpu2&#45;&gt;l1_exp_agg_tp2 -->
<g id="edge329" class="edge">
<title>l1_exp0_gpu2&#45;&gt;l1_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M3302.18,-2770.46C3305.15,-2769.65 3308.09,-2768.89 3311,-2768.17 3478.29,-2726.82 3673.29,-2698.81 3810.01,-2682.37"/>
<polygon fill="black" stroke="black" points="3810.65,-2685.82 3820.16,-2681.16 3809.82,-2678.87 3810.65,-2685.82"/>
</g>
<!-- l1_exp1_gpu2&#45;&gt;l1_exp_agg_tp2 -->
<g id="edge332" class="edge">
<title>l1_exp1_gpu2&#45;&gt;l1_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M3837.48,-2768C3850.59,-2758.65 3865.39,-2748.08 3880.42,-2737.36"/>
<polygon fill="black" stroke="black" points="3882.67,-2740.06 3888.78,-2731.4 3878.6,-2734.36 3882.67,-2740.06"/>
</g>
<!-- l1_exp2_gpu2&#45;&gt;l1_exp_agg_tp2 -->
<g id="edge335" class="edge">
<title>l1_exp2_gpu2&#45;&gt;l1_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M3983,-2768C3983,-2759.86 3983,-2750.8 3983,-2741.52"/>
<polygon fill="black" stroke="black" points="3986.5,-2741.4 3983,-2731.4 3979.5,-2741.4 3986.5,-2741.4"/>
</g>
<!-- l1_exp3_gpu2&#45;&gt;l1_exp_agg_tp2 -->
<g id="edge338" class="edge">
<title>l1_exp3_gpu2&#45;&gt;l1_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M3494.24,-2770.69C3497.19,-2769.82 3500.11,-2768.97 3503,-2768.17 3606.61,-2739.24 3724.66,-2713.57 3817.77,-2694.97"/>
<polygon fill="black" stroke="black" points="3818.72,-2698.35 3827.85,-2692.96 3817.35,-2691.48 3818.72,-2698.35"/>
</g>
<!-- l1_exp4_gpu2&#45;&gt;l1_exp_agg_tp2 -->
<g id="edge341" class="edge">
<title>l1_exp4_gpu2&#45;&gt;l1_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M3686.14,-2770.08C3729.38,-2754.65 3782.85,-2735.57 3832.45,-2717.88"/>
<polygon fill="black" stroke="black" points="3833.75,-2721.13 3841.99,-2714.48 3831.39,-2714.54 3833.75,-2721.13"/>
</g>
<!-- l1_exp5_gpu2&#45;&gt;l1_exp_agg_tp2 -->
<g id="edge344" class="edge">
<title>l1_exp5_gpu2&#45;&gt;l1_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M4128.52,-2768C4115.41,-2758.65 4100.61,-2748.08 4085.58,-2737.36"/>
<polygon fill="black" stroke="black" points="4087.4,-2734.36 4077.22,-2731.4 4083.33,-2740.06 4087.4,-2734.36"/>
</g>
<!-- l1_exp6_gpu2&#45;&gt;l1_exp_agg_tp2 -->
<g id="edge347" class="edge">
<title>l1_exp6_gpu2&#45;&gt;l1_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M4471.76,-2770.69C4468.81,-2769.82 4465.89,-2768.97 4463,-2768.17 4375.51,-2743.74 4277.71,-2721.64 4193.34,-2704.15"/>
<polygon fill="black" stroke="black" points="4193.88,-2700.69 4183.38,-2702.09 4192.47,-2707.54 4193.88,-2700.69"/>
</g>
<!-- l1_exp7_gpu2&#45;&gt;l1_exp_agg_tp2 -->
<g id="edge350" class="edge">
<title>l1_exp7_gpu2&#45;&gt;l1_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M4279.86,-2770.08C4250.13,-2759.47 4215.56,-2747.14 4180.73,-2734.71"/>
<polygon fill="black" stroke="black" points="4181.5,-2731.27 4170.91,-2731.21 4179.15,-2737.86 4181.5,-2731.27"/>
</g>
<!-- l1_exp_agg_tp2&#45;&gt;l1_final_res_tp2 -->
<g id="edge351" class="edge">
<title>l1_exp_agg_tp2&#45;&gt;l1_final_res_tp2</title>
<path fill="none" stroke="black" d="M4002.23,-2595.07C4004.77,-2586.21 4007.38,-2577.07 4009.97,-2568.06"/>
<polygon fill="black" stroke="black" points="4013.36,-2568.92 4012.75,-2558.35 4006.63,-2567 4013.36,-2568.92"/>
</g>
<!-- l2_qkv_tp2 -->
<g id="node272" class="node">
<title>l2_qkv_tp2</title>
<polygon fill="lightgreen" stroke="black" points="4145,-2320.17 3919,-2320.17 3919,-2252.17 4145,-2252.17 4145,-2320.17"/>
<text text-anchor="middle" x="4032" y="-2304.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4032" y="-2289.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="4032" y="-2274.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="4032" y="-2259.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l1_final_res_tp2&#45;&gt;l2_qkv_tp2 -->
<g id="edge515" class="edge">
<title>l1_final_res_tp2&#45;&gt;l2_qkv_tp2</title>
<path fill="none" stroke="black" d="M4032,-2421.9C4032,-2391.71 4032,-2356.97 4032,-2330.33"/>
<polygon fill="black" stroke="black" points="4035.5,-2330.18 4032,-2320.18 4028.5,-2330.18 4035.5,-2330.18"/>
<text text-anchor="middle" x="4093" y="-2392.97" font-family="Times,serif" font-size="14.00">Pipeline P2P</text>
<text text-anchor="middle" x="4093" y="-2377.97" font-family="Times,serif" font-size="14.00">GPU 2  GPU 10</text>
</g>
<!-- l1_attn_tp3 -->
<g id="node168" class="node">
<title>l1_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="5665,-3392.17 5451,-3392.17 5451,-3324.17 5665,-3324.17 5665,-3392.17"/>
<text text-anchor="middle" x="5558" y="-3376.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5558" y="-3361.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="5558" y="-3346.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5558" y="-3331.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_qkv_tp3&#45;&gt;l1_attn_tp3 -->
<g id="edge354" class="edge">
<title>l1_qkv_tp3&#45;&gt;l1_attn_tp3</title>
<path fill="none" stroke="black" d="M5554.61,-3429.01C5555.02,-3420.56 5555.47,-3411.34 5555.9,-3402.47"/>
<polygon fill="black" stroke="black" points="5559.4,-3402.42 5556.39,-3392.26 5552.41,-3402.08 5559.4,-3402.42"/>
</g>
<!-- l1_out_proj_tp3 -->
<g id="node169" class="node">
<title>l1_out_proj_tp3</title>
<polygon fill="lightgreen" stroke="black" points="5665,-3287.17 5453,-3287.17 5453,-3219.17 5665,-3219.17 5665,-3287.17"/>
<text text-anchor="middle" x="5559" y="-3271.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5559" y="-3256.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="5559" y="-3241.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5559" y="-3226.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_attn_tp3&#45;&gt;l1_out_proj_tp3 -->
<g id="edge355" class="edge">
<title>l1_attn_tp3&#45;&gt;l1_out_proj_tp3</title>
<path fill="none" stroke="black" d="M5558.32,-3324.01C5558.4,-3315.56 5558.49,-3306.34 5558.58,-3297.47"/>
<polygon fill="black" stroke="black" points="5562.08,-3297.29 5558.68,-3287.26 5555.08,-3297.23 5562.08,-3297.29"/>
</g>
<!-- l1_out_proj_tp3&#45;&gt;l1_residual_tp3 -->
<g id="edge356" class="edge">
<title>l1_out_proj_tp3&#45;&gt;l1_residual_tp3</title>
<path fill="none" stroke="black" d="M5581.75,-3219C5587.7,-3210.34 5594.35,-3200.64 5601.14,-3190.74"/>
<polygon fill="black" stroke="black" points="5604.1,-3192.63 5606.87,-3182.4 5598.33,-3188.67 5604.1,-3192.63"/>
</g>
<!-- l1_gate_tp3 -->
<g id="node171" class="node">
<title>l1_gate_tp3</title>
<polygon fill="lightyellow" stroke="black" points="5692.2,-3009.17 5362.59,-3009.17 5277.8,-2873.17 5607.41,-2873.17 5692.2,-3009.17"/>
<text text-anchor="middle" x="5485" y="-2959.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="5485" y="-2944.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="5485" y="-2929.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="5485" y="-2914.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_residual_tp3&#45;&gt;l1_gate_tp3 -->
<g id="edge358" class="edge">
<title>l1_residual_tp3&#45;&gt;l1_gate_tp3</title>
<path fill="none" stroke="black" d="M5587.08,-3046.07C5577.63,-3036.46 5567.86,-3026.51 5558.28,-3016.76"/>
<polygon fill="black" stroke="black" points="5560.51,-3014.03 5551,-3009.35 5555.51,-3018.93 5560.51,-3014.03"/>
</g>
<!-- l1_exp0_gpu3 -->
<g id="node172" class="node">
<title>l1_exp0_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="5050,-2836.17 4876,-2836.17 4876,-2768.17 5050,-2768.17 5050,-2836.17"/>
<text text-anchor="middle" x="4963" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="4963" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4963" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4963" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_residual_tp3&#45;&gt;l1_exp0_gpu3 -->
<g id="edge360" class="edge">
<title>l1_residual_tp3&#45;&gt;l1_exp0_gpu3</title>
<path fill="none" stroke="black" d="M5319.06,-3069.35C5265.6,-3054.71 5212.35,-3035.19 5165,-3009.17 5091.09,-2968.54 5027.01,-2892.23 4991.81,-2844.76"/>
<polygon fill="black" stroke="black" points="4994.52,-2842.53 4985.79,-2836.53 4988.87,-2846.67 4994.52,-2842.53"/>
</g>
<!-- l1_exp1_gpu3 -->
<g id="node173" class="node">
<title>l1_exp1_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="4858,-2836.17 4684,-2836.17 4684,-2768.17 4858,-2768.17 4858,-2836.17"/>
<text text-anchor="middle" x="4771" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4771" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4771" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4771" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_residual_tp3&#45;&gt;l1_exp1_gpu3 -->
<g id="edge363" class="edge">
<title>l1_residual_tp3&#45;&gt;l1_exp1_gpu3</title>
<path fill="none" stroke="black" d="M5350.43,-3098.67C5239.39,-3084.59 5115.2,-3058.16 5010,-3009.17 4925.57,-2969.84 4847.86,-2891.88 4805.19,-2843.95"/>
<polygon fill="black" stroke="black" points="4807.63,-2841.43 4798.39,-2836.24 4802.38,-2846.05 4807.63,-2841.43"/>
</g>
<!-- l1_exp2_gpu3 -->
<g id="node174" class="node">
<title>l1_exp2_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="6202,-2836.17 6028,-2836.17 6028,-2768.17 6202,-2768.17 6202,-2836.17"/>
<text text-anchor="middle" x="6115" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="6115" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6115" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6115" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_residual_tp3&#45;&gt;l1_exp2_gpu3 -->
<g id="edge366" class="edge">
<title>l1_residual_tp3&#45;&gt;l1_exp2_gpu3</title>
<path fill="none" stroke="black" d="M5752.96,-3046.09C5845.83,-2983.78 5980.92,-2893.14 6057.1,-2842.02"/>
<polygon fill="black" stroke="black" points="6059.29,-2844.77 6065.64,-2836.29 6055.39,-2838.95 6059.29,-2844.77"/>
</g>
<!-- l1_exp3_gpu3 -->
<g id="node175" class="node">
<title>l1_exp3_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="5818,-2836.17 5644,-2836.17 5644,-2768.17 5818,-2768.17 5818,-2836.17"/>
<text text-anchor="middle" x="5731" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="5731" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5731" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5731" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_residual_tp3&#45;&gt;l1_exp3_gpu3 -->
<g id="edge369" class="edge">
<title>l1_residual_tp3&#45;&gt;l1_exp3_gpu3</title>
<path fill="none" stroke="black" d="M5707.83,-3045.99C5710.99,-3040.17 5713.78,-3034.2 5716,-3028.17 5738.1,-2968.04 5738.08,-2892.86 5735.18,-2846.43"/>
<polygon fill="black" stroke="black" points="5738.67,-2846.14 5734.48,-2836.4 5731.69,-2846.62 5738.67,-2846.14"/>
</g>
<!-- l1_exp4_gpu3 -->
<g id="node176" class="node">
<title>l1_exp4_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="5242,-2836.17 5068,-2836.17 5068,-2768.17 5242,-2768.17 5242,-2836.17"/>
<text text-anchor="middle" x="5155" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="5155" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5155" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5155" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_residual_tp3&#45;&gt;l1_exp4_gpu3 -->
<g id="edge372" class="edge">
<title>l1_residual_tp3&#45;&gt;l1_exp4_gpu3</title>
<path fill="none" stroke="black" d="M5310.98,-3046.08C5279.66,-3035.03 5254.59,-3022.7 5241,-3009.17 5195.95,-2964.28 5173.32,-2892.3 5162.87,-2846.4"/>
<polygon fill="black" stroke="black" points="5166.26,-2845.49 5160.71,-2836.46 5159.42,-2846.98 5166.26,-2845.49"/>
</g>
<!-- l1_exp5_gpu3 -->
<g id="node177" class="node">
<title>l1_exp5_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="5434,-2836.17 5260,-2836.17 5260,-2768.17 5434,-2768.17 5434,-2836.17"/>
<text text-anchor="middle" x="5347" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="5347" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5347" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5347" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_residual_tp3&#45;&gt;l1_exp5_gpu3 -->
<g id="edge375" class="edge">
<title>l1_residual_tp3&#45;&gt;l1_exp5_gpu3</title>
<path fill="none" stroke="black" d="M5327.61,-3046.16C5300.54,-3035.2 5279.49,-3022.88 5269,-3009.17 5232.27,-2961.16 5244.37,-2928.37 5269,-2873.17 5273.92,-2862.13 5281.54,-2852.11 5290.12,-2843.32"/>
<polygon fill="black" stroke="black" points="5292.72,-2845.68 5297.52,-2836.23 5287.88,-2840.63 5292.72,-2845.68"/>
</g>
<!-- l1_exp6_gpu3 -->
<g id="node178" class="node">
<title>l1_exp6_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="6010,-2836.17 5836,-2836.17 5836,-2768.17 6010,-2768.17 6010,-2836.17"/>
<text text-anchor="middle" x="5923" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5923" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5923" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5923" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_residual_tp3&#45;&gt;l1_exp6_gpu3 -->
<g id="edge378" class="edge">
<title>l1_residual_tp3&#45;&gt;l1_exp6_gpu3</title>
<path fill="none" stroke="black" d="M5711.59,-3045.9C5765.14,-2984.42 5842.61,-2895.47 5887.38,-2844.06"/>
<polygon fill="black" stroke="black" points="5890.08,-2846.29 5894.01,-2836.45 5884.8,-2841.69 5890.08,-2846.29"/>
</g>
<!-- l1_exp7_gpu3 -->
<g id="node179" class="node">
<title>l1_exp7_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="5626,-2836.17 5452,-2836.17 5452,-2768.17 5626,-2768.17 5626,-2836.17"/>
<text text-anchor="middle" x="5539" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5539" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5539" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5539" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_residual_tp3&#45;&gt;l1_exp7_gpu3 -->
<g id="edge381" class="edge">
<title>l1_residual_tp3&#45;&gt;l1_exp7_gpu3</title>
<path fill="none" stroke="black" d="M5689.01,-3046.11C5693.97,-3034.11 5698.29,-3021.5 5701,-3009.17 5707.48,-2979.65 5717.6,-2898.42 5701,-2873.17 5696.52,-2866.35 5667.74,-2853.09 5635.64,-2839.93"/>
<polygon fill="black" stroke="black" points="5636.64,-2836.56 5626.06,-2836.04 5634.01,-2843.05 5636.64,-2836.56"/>
</g>
<!-- l1_final_res_tp3 -->
<g id="node181" class="node">
<title>l1_final_res_tp3</title>
<polygon fill="lightyellow" stroke="black" points="6242.93,-2558.17 5671.95,-2558.17 5525.07,-2422.17 6096.05,-2422.17 6242.93,-2558.17"/>
<text text-anchor="middle" x="5884" y="-2508.97" font-family="Times,serif" font-size="14.00">Layer 1 Final Residual</text>
<text text-anchor="middle" x="5884" y="-2493.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="5884" y="-2478.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5884" y="-2463.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_residual_tp3&#45;&gt;l1_final_res_tp3 -->
<g id="edge384" class="edge">
<title>l1_residual_tp3&#45;&gt;l1_final_res_tp3</title>
<path fill="none" stroke="black" d="M5905.03,-3082.75C6056.84,-3057.12 6221,-3013.03 6221,-2942.17 6221,-2942.17 6221,-2942.17 6221,-2662.17 6221,-2619.98 6199.74,-2588.2 6167.9,-2564.25"/>
<polygon fill="black" stroke="black" points="6169.76,-2561.28 6159.58,-2558.33 6165.7,-2566.99 6169.76,-2561.28"/>
</g>
<!-- l1_gate_tp3&#45;&gt;l1_exp0_gpu3 -->
<g id="edge359" class="edge">
<title>l1_gate_tp3&#45;&gt;l1_exp0_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5290.42,-2893.52C5197.98,-2871.22 5100.38,-2847.42 5059.71,-2836.22"/>
<polygon fill="black" stroke="black" points="5060.58,-2832.83 5050.01,-2833.46 5058.67,-2839.56 5060.58,-2832.83"/>
</g>
<!-- l1_gate_tp3&#45;&gt;l1_exp1_gpu3 -->
<g id="edge362" class="edge">
<title>l1_gate_tp3&#45;&gt;l1_exp1_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5305.56,-2917.92C5184.01,-2900.96 5020,-2874.39 4868.18,-2836.34"/>
<polygon fill="black" stroke="black" points="4868.75,-2832.88 4858.19,-2833.82 4867.03,-2839.66 4868.75,-2832.88"/>
</g>
<!-- l1_gate_tp3&#45;&gt;l1_exp2_gpu3 -->
<g id="edge365" class="edge">
<title>l1_gate_tp3&#45;&gt;l1_exp2_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5634.74,-2916.73C5739.86,-2898.92 5883.6,-2871.86 6017.73,-2836.4"/>
<polygon fill="black" stroke="black" points="6019.02,-2839.68 6027.78,-2833.72 6017.22,-2832.91 6019.02,-2839.68"/>
</g>
<!-- l1_gate_tp3&#45;&gt;l1_exp3_gpu3 -->
<g id="edge368" class="edge">
<title>l1_gate_tp3&#45;&gt;l1_exp3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5605.48,-2873.07C5625.07,-2862.16 5644.75,-2851.2 5662.52,-2841.3"/>
<polygon fill="black" stroke="black" points="5664.6,-2844.15 5671.63,-2836.23 5661.19,-2838.04 5664.6,-2844.15"/>
</g>
<!-- l1_gate_tp3&#45;&gt;l1_exp4_gpu3 -->
<g id="edge371" class="edge">
<title>l1_gate_tp3&#45;&gt;l1_exp4_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5323.38,-2873.07C5296.02,-2861.71 5268.52,-2850.3 5243.92,-2840.08"/>
<polygon fill="black" stroke="black" points="5245.22,-2836.83 5234.64,-2836.23 5242.53,-2843.3 5245.22,-2836.83"/>
</g>
<!-- l1_gate_tp3&#45;&gt;l1_exp5_gpu3 -->
<g id="edge374" class="edge">
<title>l1_gate_tp3&#45;&gt;l1_exp5_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5417.21,-2872.87C5407.1,-2862.83 5396.95,-2852.76 5387.64,-2843.51"/>
<polygon fill="black" stroke="black" points="5389.93,-2840.86 5380.37,-2836.29 5385,-2845.82 5389.93,-2840.86"/>
</g>
<!-- l1_gate_tp3&#45;&gt;l1_exp6_gpu3 -->
<g id="edge377" class="edge">
<title>l1_gate_tp3&#45;&gt;l1_exp6_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5623.88,-2899.17C5683.48,-2881.27 5754.07,-2859.67 5826.2,-2836.4"/>
<polygon fill="black" stroke="black" points="5827.49,-2839.66 5835.92,-2833.25 5825.33,-2833 5827.49,-2839.66"/>
</g>
<!-- l1_gate_tp3&#45;&gt;l1_exp7_gpu3 -->
<g id="edge380" class="edge">
<title>l1_gate_tp3&#45;&gt;l1_exp7_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5511.53,-2872.87C5515.17,-2863.63 5518.82,-2854.35 5522.22,-2845.73"/>
<polygon fill="black" stroke="black" points="5525.53,-2846.88 5525.94,-2836.29 5519.02,-2844.31 5525.53,-2846.88"/>
</g>
<!-- l1_exp_agg_tp3 -->
<g id="node180" class="node">
<title>l1_exp_agg_tp3</title>
<polygon fill="lightyellow" stroke="black" points="5758.58,-2731.17 5409.28,-2731.17 5319.42,-2595.17 5668.72,-2595.17 5758.58,-2731.17"/>
<text text-anchor="middle" x="5539" y="-2681.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5539" y="-2666.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="5539" y="-2651.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5539" y="-2636.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_exp0_gpu3&#45;&gt;l1_exp_agg_tp3 -->
<g id="edge361" class="edge">
<title>l1_exp0_gpu3&#45;&gt;l1_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5050.24,-2770.69C5053.19,-2769.82 5056.11,-2768.97 5059,-2768.17 5162.61,-2739.24 5280.66,-2713.57 5373.77,-2694.97"/>
<polygon fill="black" stroke="black" points="5374.72,-2698.35 5383.85,-2692.96 5373.35,-2691.48 5374.72,-2698.35"/>
</g>
<!-- l1_exp1_gpu3&#45;&gt;l1_exp_agg_tp3 -->
<g id="edge364" class="edge">
<title>l1_exp1_gpu3&#45;&gt;l1_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M4858.18,-2770.46C4861.15,-2769.65 4864.09,-2768.89 4867,-2768.17 5034.29,-2726.82 5229.29,-2698.81 5366.01,-2682.37"/>
<polygon fill="black" stroke="black" points="5366.65,-2685.82 5376.16,-2681.16 5365.82,-2678.87 5366.65,-2685.82"/>
</g>
<!-- l1_exp2_gpu3&#45;&gt;l1_exp_agg_tp3 -->
<g id="edge367" class="edge">
<title>l1_exp2_gpu3&#45;&gt;l1_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M6027.76,-2770.69C6024.81,-2769.82 6021.89,-2768.97 6019,-2768.17 5931.51,-2743.74 5833.71,-2721.64 5749.34,-2704.15"/>
<polygon fill="black" stroke="black" points="5749.88,-2700.69 5739.38,-2702.09 5748.47,-2707.54 5749.88,-2700.69"/>
</g>
<!-- l1_exp3_gpu3&#45;&gt;l1_exp_agg_tp3 -->
<g id="edge370" class="edge">
<title>l1_exp3_gpu3&#45;&gt;l1_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5684.52,-2768C5671.41,-2758.65 5656.61,-2748.08 5641.58,-2737.36"/>
<polygon fill="black" stroke="black" points="5643.4,-2734.36 5633.22,-2731.4 5639.33,-2740.06 5643.4,-2734.36"/>
</g>
<!-- l1_exp4_gpu3&#45;&gt;l1_exp_agg_tp3 -->
<g id="edge373" class="edge">
<title>l1_exp4_gpu3&#45;&gt;l1_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5242.14,-2770.08C5285.38,-2754.65 5338.85,-2735.57 5388.45,-2717.88"/>
<polygon fill="black" stroke="black" points="5389.75,-2721.13 5397.99,-2714.48 5387.39,-2714.54 5389.75,-2721.13"/>
</g>
<!-- l1_exp5_gpu3&#45;&gt;l1_exp_agg_tp3 -->
<g id="edge376" class="edge">
<title>l1_exp5_gpu3&#45;&gt;l1_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5393.48,-2768C5406.59,-2758.65 5421.39,-2748.08 5436.42,-2737.36"/>
<polygon fill="black" stroke="black" points="5438.67,-2740.06 5444.78,-2731.4 5434.6,-2734.36 5438.67,-2740.06"/>
</g>
<!-- l1_exp6_gpu3&#45;&gt;l1_exp_agg_tp3 -->
<g id="edge379" class="edge">
<title>l1_exp6_gpu3&#45;&gt;l1_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5835.86,-2770.08C5806.13,-2759.47 5771.56,-2747.14 5736.73,-2734.71"/>
<polygon fill="black" stroke="black" points="5737.5,-2731.27 5726.91,-2731.21 5735.15,-2737.86 5737.5,-2731.27"/>
</g>
<!-- l1_exp7_gpu3&#45;&gt;l1_exp_agg_tp3 -->
<g id="edge382" class="edge">
<title>l1_exp7_gpu3&#45;&gt;l1_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5539,-2768C5539,-2759.86 5539,-2750.8 5539,-2741.52"/>
<polygon fill="black" stroke="black" points="5542.5,-2741.4 5539,-2731.4 5535.5,-2741.4 5542.5,-2741.4"/>
</g>
<!-- l1_exp_agg_tp3&#45;&gt;l1_final_res_tp3 -->
<g id="edge383" class="edge">
<title>l1_exp_agg_tp3&#45;&gt;l1_final_res_tp3</title>
<path fill="none" stroke="black" d="M5670.41,-2597.03C5693.02,-2585.82 5716.63,-2574.12 5739.57,-2562.76"/>
<polygon fill="black" stroke="black" points="5741.25,-2565.83 5748.66,-2558.25 5738.14,-2559.55 5741.25,-2565.83"/>
</g>
<!-- l2_qkv_tp3 -->
<g id="node287" class="node">
<title>l2_qkv_tp3</title>
<polygon fill="lightgreen" stroke="black" points="5997,-2320.17 5771,-2320.17 5771,-2252.17 5997,-2252.17 5997,-2320.17"/>
<text text-anchor="middle" x="5884" y="-2304.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5884" y="-2289.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="5884" y="-2274.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="5884" y="-2259.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l1_final_res_tp3&#45;&gt;l2_qkv_tp3 -->
<g id="edge516" class="edge">
<title>l1_final_res_tp3&#45;&gt;l2_qkv_tp3</title>
<path fill="none" stroke="black" d="M5884,-2421.9C5884,-2391.71 5884,-2356.97 5884,-2330.33"/>
<polygon fill="black" stroke="black" points="5887.5,-2330.18 5884,-2320.18 5880.5,-2330.18 5887.5,-2330.18"/>
<text text-anchor="middle" x="5945" y="-2392.97" font-family="Times,serif" font-size="14.00">Pipeline P2P</text>
<text text-anchor="middle" x="5945" y="-2377.97" font-family="Times,serif" font-size="14.00">GPU 3  GPU 11</text>
</g>
<!-- l1_attn_tp4 -->
<g id="node183" class="node">
<title>l1_attn_tp4</title>
<polygon fill="lightgreen" stroke="black" points="7108,-3392.17 6894,-3392.17 6894,-3324.17 7108,-3324.17 7108,-3392.17"/>
<text text-anchor="middle" x="7001" y="-3376.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="7001" y="-3361.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="7001" y="-3346.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="7001" y="-3331.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_qkv_tp4&#45;&gt;l1_attn_tp4 -->
<g id="edge386" class="edge">
<title>l1_qkv_tp4&#45;&gt;l1_attn_tp4</title>
<path fill="none" stroke="black" d="M6997.61,-3429.01C6998.02,-3420.56 6998.47,-3411.34 6998.9,-3402.47"/>
<polygon fill="black" stroke="black" points="7002.4,-3402.42 6999.39,-3392.26 6995.41,-3402.08 7002.4,-3402.42"/>
</g>
<!-- l1_out_proj_tp4 -->
<g id="node184" class="node">
<title>l1_out_proj_tp4</title>
<polygon fill="lightgreen" stroke="black" points="7109,-3287.17 6897,-3287.17 6897,-3219.17 7109,-3219.17 7109,-3287.17"/>
<text text-anchor="middle" x="7003" y="-3271.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7003" y="-3256.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="7003" y="-3241.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="7003" y="-3226.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_attn_tp4&#45;&gt;l1_out_proj_tp4 -->
<g id="edge387" class="edge">
<title>l1_attn_tp4&#45;&gt;l1_out_proj_tp4</title>
<path fill="none" stroke="black" d="M7001.64,-3324.01C7001.81,-3315.56 7001.99,-3306.34 7002.16,-3297.47"/>
<polygon fill="black" stroke="black" points="7005.66,-3297.33 7002.36,-3287.26 6998.66,-3297.19 7005.66,-3297.33"/>
</g>
<!-- l1_out_proj_tp4&#45;&gt;l1_residual_tp4 -->
<g id="edge388" class="edge">
<title>l1_out_proj_tp4&#45;&gt;l1_residual_tp4</title>
<path fill="none" stroke="black" d="M7025.27,-3219C7031.09,-3210.34 7037.6,-3200.64 7044.25,-3190.74"/>
<polygon fill="black" stroke="black" points="7047.18,-3192.65 7049.85,-3182.4 7041.37,-3188.75 7047.18,-3192.65"/>
</g>
<!-- l1_gate_tp4 -->
<g id="node186" class="node">
<title>l1_gate_tp4</title>
<polygon fill="lightyellow" stroke="black" points="7302.2,-3009.17 6972.59,-3009.17 6887.8,-2873.17 7217.41,-2873.17 7302.2,-3009.17"/>
<text text-anchor="middle" x="7095" y="-2959.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="7095" y="-2944.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="7095" y="-2929.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="7095" y="-2914.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_residual_tp4&#45;&gt;l1_gate_tp4 -->
<g id="edge390" class="edge">
<title>l1_residual_tp4&#45;&gt;l1_gate_tp4</title>
<path fill="none" stroke="black" d="M7095,-3046.07C7095,-3037.4 7095,-3028.46 7095,-3019.63"/>
<polygon fill="black" stroke="black" points="7098.5,-3019.35 7095,-3009.35 7091.5,-3019.35 7098.5,-3019.35"/>
</g>
<!-- l1_exp0_gpu4 -->
<g id="node187" class="node">
<title>l1_exp0_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="6990,-2836.17 6816,-2836.17 6816,-2768.17 6990,-2768.17 6990,-2836.17"/>
<text text-anchor="middle" x="6903" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="6903" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6903" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6903" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_residual_tp4&#45;&gt;l1_exp0_gpu4 -->
<g id="edge392" class="edge">
<title>l1_residual_tp4&#45;&gt;l1_exp0_gpu4</title>
<path fill="none" stroke="black" d="M6890.05,-3045.82C6878.75,-3035.32 6869.12,-3023.19 6862,-3009.17 6834.63,-2955.27 6846.17,-2931.5 6862,-2873.17 6864.57,-2863.68 6868.79,-2854.17 6873.56,-2845.35"/>
<polygon fill="black" stroke="black" points="6876.74,-2846.85 6878.69,-2836.43 6870.67,-2843.36 6876.74,-2846.85"/>
</g>
<!-- l1_exp1_gpu4 -->
<g id="node188" class="node">
<title>l1_exp1_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="6414,-2836.17 6240,-2836.17 6240,-2768.17 6414,-2768.17 6414,-2836.17"/>
<text text-anchor="middle" x="6327" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="6327" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6327" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6327" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_residual_tp4&#45;&gt;l1_exp1_gpu4 -->
<g id="edge395" class="edge">
<title>l1_residual_tp4&#45;&gt;l1_exp1_gpu4</title>
<path fill="none" stroke="black" d="M6764.9,-3073.07C6699.7,-3058.07 6633.18,-3037.47 6574,-3009.17 6488.65,-2968.35 6408.08,-2891.32 6363.35,-2843.9"/>
<polygon fill="black" stroke="black" points="6365.87,-2841.47 6356.48,-2836.55 6360.75,-2846.25 6365.87,-2841.47"/>
</g>
<!-- l1_exp2_gpu4 -->
<g id="node189" class="node">
<title>l1_exp2_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="7182,-2836.17 7008,-2836.17 7008,-2768.17 7182,-2768.17 7182,-2836.17"/>
<text text-anchor="middle" x="7095" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="7095" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7095" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7095" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_residual_tp4&#45;&gt;l1_exp2_gpu4 -->
<g id="edge398" class="edge">
<title>l1_residual_tp4&#45;&gt;l1_exp2_gpu4</title>
<path fill="none" stroke="black" d="M6912.09,-3046.1C6899.22,-3035.49 6887.86,-3023.26 6879,-3009.17 6862.92,-2983.58 6861.05,-2897.48 6879,-2873.17 6910.33,-2830.72 6942.24,-2850.92 6998,-2836.17"/>
<polygon fill="black" stroke="black" points="6999.32,-2839.43 7007.92,-2833.24 6997.34,-2832.71 6999.32,-2839.43"/>
</g>
<!-- l1_exp3_gpu4 -->
<g id="node190" class="node">
<title>l1_exp3_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="7566,-2836.17 7392,-2836.17 7392,-2768.17 7566,-2768.17 7566,-2836.17"/>
<text text-anchor="middle" x="7479" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7479" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7479" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7479" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_residual_tp4&#45;&gt;l1_exp3_gpu4 -->
<g id="edge401" class="edge">
<title>l1_residual_tp4&#45;&gt;l1_exp3_gpu4</title>
<path fill="none" stroke="black" d="M7270.12,-3046.08C7281.1,-3040.4 7291.82,-3034.42 7302,-3028.17 7374.9,-2983.37 7429.8,-2897.06 7457.94,-2845.34"/>
<polygon fill="black" stroke="black" points="7461.08,-2846.88 7462.72,-2836.41 7454.91,-2843.58 7461.08,-2846.88"/>
</g>
<!-- l1_exp4_gpu4 -->
<g id="node191" class="node">
<title>l1_exp4_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="7374,-2836.17 7200,-2836.17 7200,-2768.17 7374,-2768.17 7374,-2836.17"/>
<text text-anchor="middle" x="7287" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="7287" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7287" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7287" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_residual_tp4&#45;&gt;l1_exp4_gpu4 -->
<g id="edge404" class="edge">
<title>l1_residual_tp4&#45;&gt;l1_exp4_gpu4</title>
<path fill="none" stroke="black" d="M7277.91,-3046.1C7290.78,-3035.49 7302.14,-3023.26 7311,-3009.17 7342.14,-2959.6 7324.05,-2889.91 7306.7,-2845.65"/>
<polygon fill="black" stroke="black" points="7309.92,-2844.28 7302.91,-2836.33 7303.44,-2846.92 7309.92,-2844.28"/>
</g>
<!-- l1_exp5_gpu4 -->
<g id="node192" class="node">
<title>l1_exp5_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="6606,-2836.17 6432,-2836.17 6432,-2768.17 6606,-2768.17 6606,-2836.17"/>
<text text-anchor="middle" x="6519" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="6519" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6519" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6519" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_residual_tp4&#45;&gt;l1_exp5_gpu4 -->
<g id="edge407" class="edge">
<title>l1_residual_tp4&#45;&gt;l1_exp5_gpu4</title>
<path fill="none" stroke="black" d="M6819.65,-3046.16C6792.34,-3035.45 6765.64,-3023.17 6741,-3009.17 6664.3,-2965.57 6592.77,-2890.62 6552.59,-2844.15"/>
<polygon fill="black" stroke="black" points="6555.1,-2841.7 6545.93,-2836.39 6549.78,-2846.26 6555.1,-2841.7"/>
</g>
<!-- l1_exp6_gpu4 -->
<g id="node193" class="node">
<title>l1_exp6_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="6798,-2836.17 6624,-2836.17 6624,-2768.17 6798,-2768.17 6798,-2836.17"/>
<text text-anchor="middle" x="6711" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="6711" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6711" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6711" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_residual_tp4&#45;&gt;l1_exp6_gpu4 -->
<g id="edge410" class="edge">
<title>l1_residual_tp4&#45;&gt;l1_exp6_gpu4</title>
<path fill="none" stroke="black" d="M6887.2,-3046.03C6870.33,-3035.42 6854.58,-3023.21 6841,-3009.17 6793.1,-2959.65 6753.52,-2889.73 6731.07,-2845.43"/>
<polygon fill="black" stroke="black" points="6734.14,-2843.76 6726.54,-2836.38 6727.88,-2846.89 6734.14,-2843.76"/>
</g>
<!-- l1_exp7_gpu4 -->
<g id="node194" class="node">
<title>l1_exp7_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="7758,-2836.17 7584,-2836.17 7584,-2768.17 7758,-2768.17 7758,-2836.17"/>
<text text-anchor="middle" x="7671" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="7671" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7671" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7671" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_residual_tp4&#45;&gt;l1_exp7_gpu4 -->
<g id="edge413" class="edge">
<title>l1_residual_tp4&#45;&gt;l1_exp7_gpu4</title>
<path fill="none" stroke="black" d="M7307.72,-3046.67C7335.95,-3035.4 7364.07,-3022.86 7390,-3009.17 7479.55,-2961.89 7572.14,-2888.35 7625.51,-2843.12"/>
<polygon fill="black" stroke="black" points="7628.07,-2845.53 7633.41,-2836.38 7623.53,-2840.21 7628.07,-2845.53"/>
</g>
<!-- l1_final_res_tp4 -->
<g id="node196" class="node">
<title>l1_final_res_tp4</title>
<polygon fill="lightyellow" stroke="black" points="7531.93,-2558.17 6960.95,-2558.17 6814.07,-2422.17 7385.05,-2422.17 7531.93,-2558.17"/>
<text text-anchor="middle" x="7173" y="-2508.97" font-family="Times,serif" font-size="14.00">Layer 1 Final Residual</text>
<text text-anchor="middle" x="7173" y="-2493.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="7173" y="-2478.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="7173" y="-2463.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_residual_tp4&#45;&gt;l1_final_res_tp4 -->
<g id="edge416" class="edge">
<title>l1_residual_tp4&#45;&gt;l1_final_res_tp4</title>
<path fill="none" stroke="black" d="M7360.63,-3095.36C7552.13,-3074.95 7777,-3031.89 7777,-2942.17 7777,-2942.17 7777,-2942.17 7777,-2662.17 7777,-2597.84 7648.58,-2556.48 7510.17,-2530.58"/>
<polygon fill="black" stroke="black" points="7510.66,-2527.11 7500.19,-2528.75 7509.39,-2534 7510.66,-2527.11"/>
</g>
<!-- l1_gate_tp4&#45;&gt;l1_exp0_gpu4 -->
<g id="edge391" class="edge">
<title>l1_gate_tp4&#45;&gt;l1_exp0_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7000.97,-2873.07C6986.18,-2862.52 6971.32,-2851.92 6957.81,-2842.28"/>
<polygon fill="black" stroke="black" points="6959.76,-2839.36 6949.58,-2836.41 6955.69,-2845.06 6959.76,-2839.36"/>
</g>
<!-- l1_gate_tp4&#45;&gt;l1_exp1_gpu4 -->
<g id="edge394" class="edge">
<title>l1_gate_tp4&#45;&gt;l1_exp1_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6917.86,-2921.46C6783.9,-2905.27 6595.74,-2878.13 6423.91,-2836.26"/>
<polygon fill="black" stroke="black" points="6424.73,-2832.86 6414.18,-2833.87 6423.06,-2839.65 6424.73,-2832.86"/>
</g>
<!-- l1_gate_tp4&#45;&gt;l1_exp2_gpu4 -->
<g id="edge397" class="edge">
<title>l1_gate_tp4&#45;&gt;l1_exp2_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7095,-2872.87C7095,-2863.93 7095,-2854.95 7095,-2846.56"/>
<polygon fill="black" stroke="black" points="7098.5,-2846.29 7095,-2836.29 7091.5,-2846.29 7098.5,-2846.29"/>
</g>
<!-- l1_gate_tp4&#45;&gt;l1_exp3_gpu4 -->
<g id="edge400" class="edge">
<title>l1_gate_tp4&#45;&gt;l1_exp3_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7229.57,-2892.15C7279.83,-2874.22 7335.87,-2854.23 7382.08,-2837.74"/>
<polygon fill="black" stroke="black" points="7383.54,-2840.94 7391.79,-2834.28 7381.19,-2834.35 7383.54,-2840.94"/>
</g>
<!-- l1_gate_tp4&#45;&gt;l1_exp4_gpu4 -->
<g id="edge403" class="edge">
<title>l1_gate_tp4&#45;&gt;l1_exp4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7189.03,-2873.07C7203.82,-2862.52 7218.68,-2851.92 7232.19,-2842.28"/>
<polygon fill="black" stroke="black" points="7234.31,-2845.06 7240.42,-2836.41 7230.24,-2839.36 7234.31,-2845.06"/>
</g>
<!-- l1_gate_tp4&#45;&gt;l1_exp5_gpu4 -->
<g id="edge406" class="edge">
<title>l1_gate_tp4&#45;&gt;l1_exp5_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6901.82,-2896.14C6839.98,-2882.34 6771.17,-2867.3 6708,-2854.17 6669.68,-2846.2 6657.38,-2846.88 6616.1,-2836.32"/>
<polygon fill="black" stroke="black" points="6616.78,-2832.88 6606.22,-2833.73 6615,-2839.65 6616.78,-2832.88"/>
</g>
<!-- l1_gate_tp4&#45;&gt;l1_exp6_gpu4 -->
<g id="edge409" class="edge">
<title>l1_gate_tp4&#45;&gt;l1_exp6_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6906.94,-2873.07C6872.64,-2860.84 6838.18,-2848.54 6807.93,-2837.75"/>
<polygon fill="black" stroke="black" points="6808.86,-2834.36 6798.26,-2834.3 6806.51,-2840.96 6808.86,-2834.36"/>
</g>
<!-- l1_gate_tp4&#45;&gt;l1_exp7_gpu4 -->
<g id="edge412" class="edge">
<title>l1_gate_tp4&#45;&gt;l1_exp7_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7242.36,-2912.91C7335.28,-2894.61 7457.73,-2868.45 7573.97,-2836.36"/>
<polygon fill="black" stroke="black" points="7575.06,-2839.69 7583.76,-2833.64 7573.19,-2832.95 7575.06,-2839.69"/>
</g>
<!-- l1_exp_agg_tp4 -->
<g id="node195" class="node">
<title>l1_exp_agg_tp4</title>
<polygon fill="lightyellow" stroke="black" points="7314.58,-2731.17 6965.28,-2731.17 6875.42,-2595.17 7224.72,-2595.17 7314.58,-2731.17"/>
<text text-anchor="middle" x="7095" y="-2681.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7095" y="-2666.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="7095" y="-2651.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="7095" y="-2636.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_exp0_gpu4&#45;&gt;l1_exp_agg_tp4 -->
<g id="edge393" class="edge">
<title>l1_exp0_gpu4&#45;&gt;l1_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M6949.48,-2768C6962.59,-2758.65 6977.39,-2748.08 6992.42,-2737.36"/>
<polygon fill="black" stroke="black" points="6994.67,-2740.06 7000.78,-2731.4 6990.6,-2734.36 6994.67,-2740.06"/>
</g>
<!-- l1_exp1_gpu4&#45;&gt;l1_exp_agg_tp4 -->
<g id="edge396" class="edge">
<title>l1_exp1_gpu4&#45;&gt;l1_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M6414.18,-2770.46C6417.15,-2769.65 6420.09,-2768.89 6423,-2768.17 6590.29,-2726.82 6785.29,-2698.81 6922.01,-2682.37"/>
<polygon fill="black" stroke="black" points="6922.65,-2685.82 6932.16,-2681.16 6921.82,-2678.87 6922.65,-2685.82"/>
</g>
<!-- l1_exp2_gpu4&#45;&gt;l1_exp_agg_tp4 -->
<g id="edge399" class="edge">
<title>l1_exp2_gpu4&#45;&gt;l1_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7095,-2768C7095,-2759.86 7095,-2750.8 7095,-2741.52"/>
<polygon fill="black" stroke="black" points="7098.5,-2741.4 7095,-2731.4 7091.5,-2741.4 7098.5,-2741.4"/>
</g>
<!-- l1_exp3_gpu4&#45;&gt;l1_exp_agg_tp4 -->
<g id="edge402" class="edge">
<title>l1_exp3_gpu4&#45;&gt;l1_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7391.86,-2770.08C7362.13,-2759.47 7327.56,-2747.14 7292.73,-2734.71"/>
<polygon fill="black" stroke="black" points="7293.5,-2731.27 7282.91,-2731.21 7291.15,-2737.86 7293.5,-2731.27"/>
</g>
<!-- l1_exp4_gpu4&#45;&gt;l1_exp_agg_tp4 -->
<g id="edge405" class="edge">
<title>l1_exp4_gpu4&#45;&gt;l1_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7240.52,-2768C7227.41,-2758.65 7212.61,-2748.08 7197.58,-2737.36"/>
<polygon fill="black" stroke="black" points="7199.4,-2734.36 7189.22,-2731.4 7195.33,-2740.06 7199.4,-2734.36"/>
</g>
<!-- l1_exp5_gpu4&#45;&gt;l1_exp_agg_tp4 -->
<g id="edge408" class="edge">
<title>l1_exp5_gpu4&#45;&gt;l1_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M6606.24,-2770.69C6609.19,-2769.82 6612.11,-2768.97 6615,-2768.17 6718.61,-2739.24 6836.66,-2713.57 6929.77,-2694.97"/>
<polygon fill="black" stroke="black" points="6930.72,-2698.35 6939.85,-2692.96 6929.35,-2691.48 6930.72,-2698.35"/>
</g>
<!-- l1_exp6_gpu4&#45;&gt;l1_exp_agg_tp4 -->
<g id="edge411" class="edge">
<title>l1_exp6_gpu4&#45;&gt;l1_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M6798.14,-2770.08C6841.38,-2754.65 6894.85,-2735.57 6944.45,-2717.88"/>
<polygon fill="black" stroke="black" points="6945.75,-2721.13 6953.99,-2714.48 6943.39,-2714.54 6945.75,-2721.13"/>
</g>
<!-- l1_exp7_gpu4&#45;&gt;l1_exp_agg_tp4 -->
<g id="edge414" class="edge">
<title>l1_exp7_gpu4&#45;&gt;l1_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7583.76,-2770.69C7580.81,-2769.82 7577.89,-2768.97 7575,-2768.17 7487.51,-2743.74 7389.71,-2721.64 7305.34,-2704.15"/>
<polygon fill="black" stroke="black" points="7305.88,-2700.69 7295.38,-2702.09 7304.47,-2707.54 7305.88,-2700.69"/>
</g>
<!-- l1_exp_agg_tp4&#45;&gt;l1_final_res_tp4 -->
<g id="edge415" class="edge">
<title>l1_exp_agg_tp4&#45;&gt;l1_final_res_tp4</title>
<path fill="none" stroke="black" d="M7125.6,-2595.07C7129.73,-2586.02 7133.99,-2576.68 7138.19,-2567.48"/>
<polygon fill="black" stroke="black" points="7141.39,-2568.9 7142.36,-2558.35 7135.02,-2565.99 7141.39,-2568.9"/>
</g>
<!-- l2_qkv_tp4 -->
<g id="node302" class="node">
<title>l2_qkv_tp4</title>
<polygon fill="lightgreen" stroke="black" points="7286,-2320.17 7060,-2320.17 7060,-2252.17 7286,-2252.17 7286,-2320.17"/>
<text text-anchor="middle" x="7173" y="-2304.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7173" y="-2289.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="7173" y="-2274.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="7173" y="-2259.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l1_final_res_tp4&#45;&gt;l2_qkv_tp4 -->
<g id="edge517" class="edge">
<title>l1_final_res_tp4&#45;&gt;l2_qkv_tp4</title>
<path fill="none" stroke="black" d="M7173,-2421.9C7173,-2391.71 7173,-2356.97 7173,-2330.33"/>
<polygon fill="black" stroke="black" points="7176.5,-2330.18 7173,-2320.18 7169.5,-2330.18 7176.5,-2330.18"/>
<text text-anchor="middle" x="7234" y="-2392.97" font-family="Times,serif" font-size="14.00">Pipeline P2P</text>
<text text-anchor="middle" x="7234" y="-2377.97" font-family="Times,serif" font-size="14.00">GPU 4  GPU 12</text>
</g>
<!-- l1_attn_tp5 -->
<g id="node198" class="node">
<title>l1_attn_tp5</title>
<polygon fill="lightgreen" stroke="black" points="8788,-3392.17 8574,-3392.17 8574,-3324.17 8788,-3324.17 8788,-3392.17"/>
<text text-anchor="middle" x="8681" y="-3376.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="8681" y="-3361.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="8681" y="-3346.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="8681" y="-3331.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_qkv_tp5&#45;&gt;l1_attn_tp5 -->
<g id="edge418" class="edge">
<title>l1_qkv_tp5&#45;&gt;l1_attn_tp5</title>
<path fill="none" stroke="black" d="M8678.97,-3429.01C8679.21,-3420.56 8679.48,-3411.34 8679.74,-3402.47"/>
<polygon fill="black" stroke="black" points="8683.24,-3402.36 8680.04,-3392.26 8676.25,-3402.16 8683.24,-3402.36"/>
</g>
<!-- l1_out_proj_tp5 -->
<g id="node199" class="node">
<title>l1_out_proj_tp5</title>
<polygon fill="lightgreen" stroke="black" points="8790,-3287.17 8578,-3287.17 8578,-3219.17 8790,-3219.17 8790,-3287.17"/>
<text text-anchor="middle" x="8684" y="-3271.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8684" y="-3256.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="8684" y="-3241.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="8684" y="-3226.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_attn_tp5&#45;&gt;l1_out_proj_tp5 -->
<g id="edge419" class="edge">
<title>l1_attn_tp5&#45;&gt;l1_out_proj_tp5</title>
<path fill="none" stroke="black" d="M8681.97,-3324.01C8682.21,-3315.56 8682.48,-3306.34 8682.74,-3297.47"/>
<polygon fill="black" stroke="black" points="8686.24,-3297.36 8683.04,-3287.26 8679.25,-3297.16 8686.24,-3297.36"/>
</g>
<!-- l1_out_proj_tp5&#45;&gt;l1_residual_tp5 -->
<g id="edge420" class="edge">
<title>l1_out_proj_tp5&#45;&gt;l1_residual_tp5</title>
<path fill="none" stroke="black" d="M8700.95,-3219C8705.28,-3210.51 8710.13,-3201.03 8715.08,-3191.34"/>
<polygon fill="black" stroke="black" points="8718.21,-3192.9 8719.65,-3182.4 8711.98,-3189.71 8718.21,-3192.9"/>
</g>
<!-- l1_gate_tp5 -->
<g id="node201" class="node">
<title>l1_gate_tp5</title>
<polygon fill="lightyellow" stroke="black" points="8804.2,-3009.17 8474.59,-3009.17 8389.8,-2873.17 8719.41,-2873.17 8804.2,-3009.17"/>
<text text-anchor="middle" x="8597" y="-2959.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="8597" y="-2944.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="8597" y="-2929.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="8597" y="-2914.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_residual_tp5&#45;&gt;l1_gate_tp5 -->
<g id="edge422" class="edge">
<title>l1_residual_tp5&#45;&gt;l1_gate_tp5</title>
<path fill="none" stroke="black" d="M8692.4,-3046.07C8683.57,-3036.46 8674.44,-3026.51 8665.48,-3016.76"/>
<polygon fill="black" stroke="black" points="8668.02,-3014.35 8658.68,-3009.35 8662.86,-3019.08 8668.02,-3014.35"/>
</g>
<!-- l1_exp0_gpu5 -->
<g id="node202" class="node">
<title>l1_exp0_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="8354,-2836.17 8180,-2836.17 8180,-2768.17 8354,-2768.17 8354,-2836.17"/>
<text text-anchor="middle" x="8267" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8267" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8267" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8267" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_residual_tp5&#45;&gt;l1_exp0_gpu5 -->
<g id="edge424" class="edge">
<title>l1_residual_tp5&#45;&gt;l1_exp0_gpu5</title>
<path fill="none" stroke="black" d="M8422.38,-3046.01C8391.28,-3034.92 8366.39,-3022.61 8353,-3009.17 8308.12,-2964.11 8285.44,-2892.18 8274.94,-2846.34"/>
<polygon fill="black" stroke="black" points="8278.33,-2845.42 8272.76,-2836.41 8271.49,-2846.92 8278.33,-2845.42"/>
</g>
<!-- l1_exp1_gpu5 -->
<g id="node203" class="node">
<title>l1_exp1_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="8162,-2836.17 7988,-2836.17 7988,-2768.17 8162,-2768.17 8162,-2836.17"/>
<text text-anchor="middle" x="8075" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="8075" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8075" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8075" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_residual_tp5&#45;&gt;l1_exp1_gpu5 -->
<g id="edge427" class="edge">
<title>l1_residual_tp5&#45;&gt;l1_exp1_gpu5</title>
<path fill="none" stroke="black" d="M8415.32,-3065.07C8367.21,-3050.97 8319.65,-3032.74 8277,-3009.17 8203.18,-2968.36 8139.08,-2892.11 8103.84,-2844.7"/>
<polygon fill="black" stroke="black" points="8106.55,-2842.47 8097.81,-2836.48 8100.91,-2846.61 8106.55,-2842.47"/>
</g>
<!-- l1_exp2_gpu5 -->
<g id="node204" class="node">
<title>l1_exp2_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="8546,-2836.17 8372,-2836.17 8372,-2768.17 8546,-2768.17 8546,-2836.17"/>
<text text-anchor="middle" x="8459" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="8459" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8459" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8459" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_residual_tp5&#45;&gt;l1_exp2_gpu5 -->
<g id="edge430" class="edge">
<title>l1_residual_tp5&#45;&gt;l1_exp2_gpu5</title>
<path fill="none" stroke="black" d="M8439.06,-3046.01C8412.2,-3035.04 8391.32,-3022.75 8381,-3009.17 8344.45,-2961.03 8356.37,-2928.37 8381,-2873.17 8385.92,-2862.13 8393.54,-2852.11 8402.12,-2843.32"/>
<polygon fill="black" stroke="black" points="8404.72,-2845.68 8409.52,-2836.23 8399.88,-2840.63 8404.72,-2845.68"/>
</g>
<!-- l1_exp3_gpu5 -->
<g id="node205" class="node">
<title>l1_exp3_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="9122,-2836.17 8948,-2836.17 8948,-2768.17 9122,-2768.17 9122,-2836.17"/>
<text text-anchor="middle" x="9035" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9035" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9035" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9035" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_residual_tp5&#45;&gt;l1_exp3_gpu5 -->
<g id="edge433" class="edge">
<title>l1_residual_tp5&#45;&gt;l1_exp3_gpu5</title>
<path fill="none" stroke="black" d="M8816.64,-3045.99C8822.18,-3039.97 8827.7,-3033.97 8833,-3028.17 8891.4,-2964.23 8958.41,-2889.27 8998.69,-2844.04"/>
<polygon fill="black" stroke="black" points="9001.37,-2846.29 9005.4,-2836.49 8996.14,-2841.64 9001.37,-2846.29"/>
</g>
<!-- l1_exp4_gpu5 -->
<g id="node206" class="node">
<title>l1_exp4_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="8930,-2836.17 8756,-2836.17 8756,-2768.17 8930,-2768.17 8930,-2836.17"/>
<text text-anchor="middle" x="8843" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="8843" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8843" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8843" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_residual_tp5&#45;&gt;l1_exp4_gpu5 -->
<g id="edge436" class="edge">
<title>l1_residual_tp5&#45;&gt;l1_exp4_gpu5</title>
<path fill="none" stroke="black" d="M8818.7,-3046.14C8822.29,-3040.33 8825.46,-3034.32 8828,-3028.17 8852.51,-2968.79 8851.76,-2893.09 8848.07,-2846.39"/>
<polygon fill="black" stroke="black" points="8851.54,-2845.96 8847.19,-2836.31 8844.57,-2846.57 8851.54,-2845.96"/>
</g>
<!-- l1_exp5_gpu5 -->
<g id="node207" class="node">
<title>l1_exp5_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="8738,-2836.17 8564,-2836.17 8564,-2768.17 8738,-2768.17 8738,-2836.17"/>
<text text-anchor="middle" x="8651" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="8651" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8651" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8651" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_residual_tp5&#45;&gt;l1_exp5_gpu5 -->
<g id="edge439" class="edge">
<title>l1_residual_tp5&#45;&gt;l1_exp5_gpu5</title>
<path fill="none" stroke="black" d="M8798.64,-3045.95C8804.56,-3034.13 8809.72,-3021.61 8813,-3009.17 8820.71,-2979.94 8829.6,-2898.42 8813,-2873.17 8808.52,-2866.35 8779.74,-2853.09 8747.64,-2839.93"/>
<polygon fill="black" stroke="black" points="8748.64,-2836.56 8738.06,-2836.04 8746.01,-2843.05 8748.64,-2836.56"/>
</g>
<!-- l1_exp6_gpu5 -->
<g id="node208" class="node">
<title>l1_exp6_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="7970,-2836.17 7796,-2836.17 7796,-2768.17 7970,-2768.17 7970,-2836.17"/>
<text text-anchor="middle" x="7883" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="7883" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7883" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7883" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_residual_tp5&#45;&gt;l1_exp6_gpu5 -->
<g id="edge442" class="edge">
<title>l1_residual_tp5&#45;&gt;l1_exp6_gpu5</title>
<path fill="none" stroke="black" d="M8449.79,-3097.05C8342.39,-3082.68 8223.24,-3056.49 8122,-3009.17 8037.62,-2969.73 7959.89,-2891.8 7917.21,-2843.91"/>
<polygon fill="black" stroke="black" points="7919.65,-2841.39 7910.41,-2836.2 7914.4,-2846.02 7919.65,-2841.39"/>
</g>
<!-- l1_exp7_gpu5 -->
<g id="node209" class="node">
<title>l1_exp7_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="9314,-2836.17 9140,-2836.17 9140,-2768.17 9314,-2768.17 9314,-2836.17"/>
<text text-anchor="middle" x="9227" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="9227" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9227" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9227" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_residual_tp5&#45;&gt;l1_exp7_gpu5 -->
<g id="edge445" class="edge">
<title>l1_residual_tp5&#45;&gt;l1_exp7_gpu5</title>
<path fill="none" stroke="black" d="M8859.15,-3045.97C8878.1,-3033.77 8897.66,-3021.12 8916,-3009.17 9004.6,-2951.39 9106.73,-2883.49 9169.06,-2841.9"/>
<polygon fill="black" stroke="black" points="9171.21,-2844.67 9177.59,-2836.21 9167.33,-2838.85 9171.21,-2844.67"/>
</g>
<!-- l1_final_res_tp5 -->
<g id="node211" class="node">
<title>l1_final_res_tp5</title>
<polygon fill="lightyellow" stroke="black" points="9370.93,-2558.17 8799.95,-2558.17 8653.07,-2422.17 9224.05,-2422.17 9370.93,-2558.17"/>
<text text-anchor="middle" x="9012" y="-2508.97" font-family="Times,serif" font-size="14.00">Layer 1 Final Residual</text>
<text text-anchor="middle" x="9012" y="-2493.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="9012" y="-2478.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="9012" y="-2463.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_residual_tp5&#45;&gt;l1_final_res_tp5 -->
<g id="edge448" class="edge">
<title>l1_residual_tp5&#45;&gt;l1_final_res_tp5</title>
<path fill="none" stroke="black" d="M9007.12,-3084.17C9162.92,-3059.01 9333,-3014.88 9333,-2942.17 9333,-2942.17 9333,-2942.17 9333,-2662.17 9333,-2619.96 9311.12,-2588.14 9278.79,-2564.16"/>
<polygon fill="black" stroke="black" points="9280.54,-2561.11 9270.35,-2558.23 9276.52,-2566.84 9280.54,-2561.11"/>
</g>
<!-- l1_gate_tp5&#45;&gt;l1_exp0_gpu5 -->
<g id="edge423" class="edge">
<title>l1_gate_tp5&#45;&gt;l1_exp0_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8435.38,-2873.07C8408.02,-2861.71 8380.52,-2850.3 8355.92,-2840.08"/>
<polygon fill="black" stroke="black" points="8357.22,-2836.83 8346.64,-2836.23 8354.53,-2843.3 8357.22,-2836.83"/>
</g>
<!-- l1_gate_tp5&#45;&gt;l1_exp1_gpu5 -->
<g id="edge426" class="edge">
<title>l1_gate_tp5&#45;&gt;l1_exp1_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8400.17,-2890.18C8351.78,-2878.14 8300.07,-2865.5 8252,-2854.17 8218.91,-2846.37 8208.16,-2846.16 8172.01,-2836.34"/>
<polygon fill="black" stroke="black" points="8172.82,-2832.93 8162.25,-2833.62 8170.94,-2839.67 8172.82,-2832.93"/>
</g>
<!-- l1_gate_tp5&#45;&gt;l1_exp2_gpu5 -->
<g id="edge429" class="edge">
<title>l1_gate_tp5&#45;&gt;l1_exp2_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8529.21,-2872.87C8519.1,-2862.83 8508.95,-2852.76 8499.64,-2843.51"/>
<polygon fill="black" stroke="black" points="8501.93,-2840.86 8492.37,-2836.29 8497,-2845.82 8501.93,-2840.86"/>
</g>
<!-- l1_gate_tp5&#45;&gt;l1_exp3_gpu5 -->
<g id="edge432" class="edge">
<title>l1_gate_tp5&#45;&gt;l1_exp3_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8730.46,-2890.71C8768.15,-2877.76 8809.41,-2864.54 8848,-2854.17 8885.01,-2844.21 8897.45,-2846.48 8938.06,-2836.26"/>
<polygon fill="black" stroke="black" points="8938.99,-2839.63 8947.78,-2833.71 8937.22,-2832.86 8938.99,-2839.63"/>
</g>
<!-- l1_gate_tp5&#45;&gt;l1_exp4_gpu5 -->
<g id="edge435" class="edge">
<title>l1_gate_tp5&#45;&gt;l1_exp4_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8717.48,-2873.07C8737.07,-2862.16 8756.75,-2851.2 8774.52,-2841.3"/>
<polygon fill="black" stroke="black" points="8776.6,-2844.15 8783.63,-2836.23 8773.19,-2838.04 8776.6,-2844.15"/>
</g>
<!-- l1_gate_tp5&#45;&gt;l1_exp5_gpu5 -->
<g id="edge438" class="edge">
<title>l1_gate_tp5&#45;&gt;l1_exp5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8623.53,-2872.87C8627.17,-2863.63 8630.82,-2854.35 8634.22,-2845.73"/>
<polygon fill="black" stroke="black" points="8637.53,-2846.88 8637.94,-2836.29 8631.02,-2844.31 8637.53,-2846.88"/>
</g>
<!-- l1_gate_tp5&#45;&gt;l1_exp6_gpu5 -->
<g id="edge441" class="edge">
<title>l1_gate_tp5&#45;&gt;l1_exp6_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8417.56,-2917.92C8296.01,-2900.96 8132,-2874.39 7980.18,-2836.34"/>
<polygon fill="black" stroke="black" points="7980.75,-2832.88 7970.19,-2833.82 7979.03,-2839.66 7980.75,-2832.88"/>
</g>
<!-- l1_gate_tp5&#45;&gt;l1_exp7_gpu5 -->
<g id="edge444" class="edge">
<title>l1_gate_tp5&#45;&gt;l1_exp7_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8746.74,-2916.73C8851.86,-2898.92 8995.6,-2871.86 9129.73,-2836.4"/>
<polygon fill="black" stroke="black" points="9131.02,-2839.68 9139.78,-2833.72 9129.22,-2832.91 9131.02,-2839.68"/>
</g>
<!-- l1_exp_agg_tp5 -->
<g id="node210" class="node">
<title>l1_exp_agg_tp5</title>
<polygon fill="lightyellow" stroke="black" points="8870.58,-2731.17 8521.28,-2731.17 8431.42,-2595.17 8780.72,-2595.17 8870.58,-2731.17"/>
<text text-anchor="middle" x="8651" y="-2681.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8651" y="-2666.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="8651" y="-2651.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="8651" y="-2636.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_exp0_gpu5&#45;&gt;l1_exp_agg_tp5 -->
<g id="edge425" class="edge">
<title>l1_exp0_gpu5&#45;&gt;l1_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8354.14,-2770.08C8397.38,-2754.65 8450.85,-2735.57 8500.45,-2717.88"/>
<polygon fill="black" stroke="black" points="8501.75,-2721.13 8509.99,-2714.48 8499.39,-2714.54 8501.75,-2721.13"/>
</g>
<!-- l1_exp1_gpu5&#45;&gt;l1_exp_agg_tp5 -->
<g id="edge428" class="edge">
<title>l1_exp1_gpu5&#45;&gt;l1_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8162.24,-2770.69C8165.19,-2769.82 8168.11,-2768.97 8171,-2768.17 8274.61,-2739.24 8392.66,-2713.57 8485.77,-2694.97"/>
<polygon fill="black" stroke="black" points="8486.72,-2698.35 8495.85,-2692.96 8485.35,-2691.48 8486.72,-2698.35"/>
</g>
<!-- l1_exp2_gpu5&#45;&gt;l1_exp_agg_tp5 -->
<g id="edge431" class="edge">
<title>l1_exp2_gpu5&#45;&gt;l1_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8505.48,-2768C8518.59,-2758.65 8533.39,-2748.08 8548.42,-2737.36"/>
<polygon fill="black" stroke="black" points="8550.67,-2740.06 8556.78,-2731.4 8546.6,-2734.36 8550.67,-2740.06"/>
</g>
<!-- l1_exp3_gpu5&#45;&gt;l1_exp_agg_tp5 -->
<g id="edge434" class="edge">
<title>l1_exp3_gpu5&#45;&gt;l1_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8947.86,-2770.08C8918.13,-2759.47 8883.56,-2747.14 8848.73,-2734.71"/>
<polygon fill="black" stroke="black" points="8849.5,-2731.27 8838.91,-2731.21 8847.15,-2737.86 8849.5,-2731.27"/>
</g>
<!-- l1_exp4_gpu5&#45;&gt;l1_exp_agg_tp5 -->
<g id="edge437" class="edge">
<title>l1_exp4_gpu5&#45;&gt;l1_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8796.52,-2768C8783.41,-2758.65 8768.61,-2748.08 8753.58,-2737.36"/>
<polygon fill="black" stroke="black" points="8755.4,-2734.36 8745.22,-2731.4 8751.33,-2740.06 8755.4,-2734.36"/>
</g>
<!-- l1_exp5_gpu5&#45;&gt;l1_exp_agg_tp5 -->
<g id="edge440" class="edge">
<title>l1_exp5_gpu5&#45;&gt;l1_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8651,-2768C8651,-2759.86 8651,-2750.8 8651,-2741.52"/>
<polygon fill="black" stroke="black" points="8654.5,-2741.4 8651,-2731.4 8647.5,-2741.4 8654.5,-2741.4"/>
</g>
<!-- l1_exp6_gpu5&#45;&gt;l1_exp_agg_tp5 -->
<g id="edge443" class="edge">
<title>l1_exp6_gpu5&#45;&gt;l1_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M7970.18,-2770.46C7973.15,-2769.65 7976.09,-2768.89 7979,-2768.17 8146.29,-2726.82 8341.29,-2698.81 8478.01,-2682.37"/>
<polygon fill="black" stroke="black" points="8478.65,-2685.82 8488.16,-2681.16 8477.82,-2678.87 8478.65,-2685.82"/>
</g>
<!-- l1_exp7_gpu5&#45;&gt;l1_exp_agg_tp5 -->
<g id="edge446" class="edge">
<title>l1_exp7_gpu5&#45;&gt;l1_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M9139.76,-2770.69C9136.81,-2769.82 9133.89,-2768.97 9131,-2768.17 9043.51,-2743.74 8945.71,-2721.64 8861.34,-2704.15"/>
<polygon fill="black" stroke="black" points="8861.88,-2700.69 8851.38,-2702.09 8860.47,-2707.54 8861.88,-2700.69"/>
</g>
<!-- l1_exp_agg_tp5&#45;&gt;l1_final_res_tp5 -->
<g id="edge447" class="edge">
<title>l1_exp_agg_tp5&#45;&gt;l1_final_res_tp5</title>
<path fill="none" stroke="black" d="M8783.63,-2599.34C8808.91,-2587.37 8835.54,-2574.75 8861.33,-2562.54"/>
<polygon fill="black" stroke="black" points="8862.88,-2565.68 8870.42,-2558.23 8859.88,-2559.35 8862.88,-2565.68"/>
</g>
<!-- l2_qkv_tp5 -->
<g id="node317" class="node">
<title>l2_qkv_tp5</title>
<polygon fill="lightgreen" stroke="black" points="9125,-2320.17 8899,-2320.17 8899,-2252.17 9125,-2252.17 9125,-2320.17"/>
<text text-anchor="middle" x="9012" y="-2304.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9012" y="-2289.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="9012" y="-2274.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="9012" y="-2259.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l1_final_res_tp5&#45;&gt;l2_qkv_tp5 -->
<g id="edge518" class="edge">
<title>l1_final_res_tp5&#45;&gt;l2_qkv_tp5</title>
<path fill="none" stroke="black" d="M9012,-2421.9C9012,-2391.71 9012,-2356.97 9012,-2330.33"/>
<polygon fill="black" stroke="black" points="9015.5,-2330.18 9012,-2320.18 9008.5,-2330.18 9015.5,-2330.18"/>
<text text-anchor="middle" x="9073" y="-2392.97" font-family="Times,serif" font-size="14.00">Pipeline P2P</text>
<text text-anchor="middle" x="9073" y="-2377.97" font-family="Times,serif" font-size="14.00">GPU 5  GPU 13</text>
</g>
<!-- l1_attn_tp6 -->
<g id="node213" class="node">
<title>l1_attn_tp6</title>
<polygon fill="lightgreen" stroke="black" points="10219,-3392.17 10005,-3392.17 10005,-3324.17 10219,-3324.17 10219,-3392.17"/>
<text text-anchor="middle" x="10112" y="-3376.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="10112" y="-3361.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="10112" y="-3346.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="10112" y="-3331.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_qkv_tp6&#45;&gt;l1_attn_tp6 -->
<g id="edge450" class="edge">
<title>l1_qkv_tp6&#45;&gt;l1_attn_tp6</title>
<path fill="none" stroke="black" d="M10109.29,-3429.01C10109.62,-3420.56 10109.97,-3411.34 10110.32,-3402.47"/>
<polygon fill="black" stroke="black" points="10113.82,-3402.39 10110.71,-3392.26 10106.83,-3402.12 10113.82,-3402.39"/>
</g>
<!-- l1_out_proj_tp6 -->
<g id="node214" class="node">
<title>l1_out_proj_tp6</title>
<polygon fill="lightgreen" stroke="black" points="10220,-3287.17 10008,-3287.17 10008,-3219.17 10220,-3219.17 10220,-3287.17"/>
<text text-anchor="middle" x="10114" y="-3271.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10114" y="-3256.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="10114" y="-3241.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="10114" y="-3226.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_attn_tp6&#45;&gt;l1_out_proj_tp6 -->
<g id="edge451" class="edge">
<title>l1_attn_tp6&#45;&gt;l1_out_proj_tp6</title>
<path fill="none" stroke="black" d="M10112.64,-3324.01C10112.81,-3315.56 10112.99,-3306.34 10113.16,-3297.47"/>
<polygon fill="black" stroke="black" points="10116.66,-3297.33 10113.36,-3287.26 10109.66,-3297.19 10116.66,-3297.33"/>
</g>
<!-- l1_out_proj_tp6&#45;&gt;l1_residual_tp6 -->
<g id="edge452" class="edge">
<title>l1_out_proj_tp6&#45;&gt;l1_residual_tp6</title>
<path fill="none" stroke="black" d="M10136.51,-3219C10142.39,-3210.34 10148.98,-3200.64 10155.7,-3190.74"/>
<polygon fill="black" stroke="black" points="10158.64,-3192.64 10161.36,-3182.4 10152.85,-3188.71 10158.64,-3192.64"/>
</g>
<!-- l1_gate_tp6 -->
<g id="node216" class="node">
<title>l1_gate_tp6</title>
<polygon fill="lightyellow" stroke="black" points="10414.2,-3009.17 10084.59,-3009.17 9999.8,-2873.17 10329.41,-2873.17 10414.2,-3009.17"/>
<text text-anchor="middle" x="10207" y="-2959.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="10207" y="-2944.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="10207" y="-2929.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="10207" y="-2914.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_residual_tp6&#45;&gt;l1_gate_tp6 -->
<g id="edge454" class="edge">
<title>l1_residual_tp6&#45;&gt;l1_gate_tp6</title>
<path fill="none" stroke="black" d="M10207,-3046.07C10207,-3037.4 10207,-3028.46 10207,-3019.63"/>
<polygon fill="black" stroke="black" points="10210.5,-3019.35 10207,-3009.35 10203.5,-3019.35 10210.5,-3019.35"/>
</g>
<!-- l1_exp0_gpu6 -->
<g id="node217" class="node">
<title>l1_exp0_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="9718,-2836.17 9544,-2836.17 9544,-2768.17 9718,-2768.17 9718,-2836.17"/>
<text text-anchor="middle" x="9631" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="9631" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9631" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9631" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_residual_tp6&#45;&gt;l1_exp0_gpu6 -->
<g id="edge456" class="edge">
<title>l1_residual_tp6&#45;&gt;l1_exp0_gpu6</title>
<path fill="none" stroke="black" d="M9931.65,-3046.16C9904.34,-3035.45 9877.64,-3023.17 9853,-3009.17 9776.3,-2965.57 9704.77,-2890.62 9664.59,-2844.15"/>
<polygon fill="black" stroke="black" points="9667.1,-2841.7 9657.93,-2836.39 9661.78,-2846.26 9667.1,-2841.7"/>
</g>
<!-- l1_exp1_gpu6 -->
<g id="node218" class="node">
<title>l1_exp1_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="9910,-2836.17 9736,-2836.17 9736,-2768.17 9910,-2768.17 9910,-2836.17"/>
<text text-anchor="middle" x="9823" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="9823" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9823" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9823" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_residual_tp6&#45;&gt;l1_exp1_gpu6 -->
<g id="edge459" class="edge">
<title>l1_residual_tp6&#45;&gt;l1_exp1_gpu6</title>
<path fill="none" stroke="black" d="M9999.2,-3046.03C9982.33,-3035.42 9966.58,-3023.21 9953,-3009.17 9905.1,-2959.65 9865.52,-2889.73 9843.07,-2845.43"/>
<polygon fill="black" stroke="black" points="9846.14,-2843.76 9838.54,-2836.38 9839.88,-2846.89 9846.14,-2843.76"/>
</g>
<!-- l1_exp2_gpu6 -->
<g id="node219" class="node">
<title>l1_exp2_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="9526,-2836.17 9352,-2836.17 9352,-2768.17 9526,-2768.17 9526,-2836.17"/>
<text text-anchor="middle" x="9439" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="9439" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9439" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9439" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_residual_tp6&#45;&gt;l1_exp2_gpu6 -->
<g id="edge462" class="edge">
<title>l1_residual_tp6&#45;&gt;l1_exp2_gpu6</title>
<path fill="none" stroke="black" d="M9876.9,-3073.07C9811.7,-3058.07 9745.18,-3037.47 9686,-3009.17 9600.65,-2968.35 9520.08,-2891.32 9475.35,-2843.9"/>
<polygon fill="black" stroke="black" points="9477.87,-2841.47 9468.48,-2836.55 9472.75,-2846.25 9477.87,-2841.47"/>
</g>
<!-- l1_exp3_gpu6 -->
<g id="node220" class="node">
<title>l1_exp3_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="10102,-2836.17 9928,-2836.17 9928,-2768.17 10102,-2768.17 10102,-2836.17"/>
<text text-anchor="middle" x="10015" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="10015" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10015" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10015" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_residual_tp6&#45;&gt;l1_exp3_gpu6 -->
<g id="edge465" class="edge">
<title>l1_residual_tp6&#45;&gt;l1_exp3_gpu6</title>
<path fill="none" stroke="black" d="M10002.05,-3045.82C9990.75,-3035.32 9981.12,-3023.19 9974,-3009.17 9946.63,-2955.27 9958.17,-2931.5 9974,-2873.17 9976.57,-2863.68 9980.79,-2854.17 9985.56,-2845.35"/>
<polygon fill="black" stroke="black" points="9988.74,-2846.85 9990.69,-2836.43 9982.67,-2843.36 9988.74,-2846.85"/>
</g>
<!-- l1_exp4_gpu6 -->
<g id="node221" class="node">
<title>l1_exp4_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="10870,-2836.17 10696,-2836.17 10696,-2768.17 10870,-2768.17 10870,-2836.17"/>
<text text-anchor="middle" x="10783" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="10783" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10783" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10783" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_residual_tp6&#45;&gt;l1_exp4_gpu6 -->
<g id="edge468" class="edge">
<title>l1_residual_tp6&#45;&gt;l1_exp4_gpu6</title>
<path fill="none" stroke="black" d="M10419.72,-3046.67C10447.95,-3035.4 10476.07,-3022.86 10502,-3009.17 10591.55,-2961.89 10684.14,-2888.35 10737.51,-2843.12"/>
<polygon fill="black" stroke="black" points="10740.07,-2845.53 10745.41,-2836.38 10735.53,-2840.21 10740.07,-2845.53"/>
</g>
<!-- l1_exp5_gpu6 -->
<g id="node222" class="node">
<title>l1_exp5_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="10294,-2836.17 10120,-2836.17 10120,-2768.17 10294,-2768.17 10294,-2836.17"/>
<text text-anchor="middle" x="10207" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10207" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10207" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10207" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_residual_tp6&#45;&gt;l1_exp5_gpu6 -->
<g id="edge471" class="edge">
<title>l1_residual_tp6&#45;&gt;l1_exp5_gpu6</title>
<path fill="none" stroke="black" d="M10024.09,-3046.1C10011.22,-3035.49 9999.86,-3023.26 9991,-3009.17 9974.92,-2983.58 9973.05,-2897.48 9991,-2873.17 10022.33,-2830.72 10054.24,-2850.92 10110,-2836.17"/>
<polygon fill="black" stroke="black" points="10111.32,-2839.43 10119.92,-2833.24 10109.34,-2832.71 10111.32,-2839.43"/>
</g>
<!-- l1_exp6_gpu6 -->
<g id="node223" class="node">
<title>l1_exp6_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="10678,-2836.17 10504,-2836.17 10504,-2768.17 10678,-2768.17 10678,-2836.17"/>
<text text-anchor="middle" x="10591" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="10591" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10591" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10591" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_residual_tp6&#45;&gt;l1_exp6_gpu6 -->
<g id="edge474" class="edge">
<title>l1_residual_tp6&#45;&gt;l1_exp6_gpu6</title>
<path fill="none" stroke="black" d="M10382.12,-3046.08C10393.1,-3040.4 10403.82,-3034.42 10414,-3028.17 10486.9,-2983.37 10541.8,-2897.06 10569.94,-2845.34"/>
<polygon fill="black" stroke="black" points="10573.08,-2846.88 10574.72,-2836.41 10566.91,-2843.58 10573.08,-2846.88"/>
</g>
<!-- l1_exp7_gpu6 -->
<g id="node224" class="node">
<title>l1_exp7_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="10486,-2836.17 10312,-2836.17 10312,-2768.17 10486,-2768.17 10486,-2836.17"/>
<text text-anchor="middle" x="10399" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="10399" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10399" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10399" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_residual_tp6&#45;&gt;l1_exp7_gpu6 -->
<g id="edge477" class="edge">
<title>l1_residual_tp6&#45;&gt;l1_exp7_gpu6</title>
<path fill="none" stroke="black" d="M10389.91,-3046.1C10402.78,-3035.49 10414.14,-3023.26 10423,-3009.17 10454.14,-2959.6 10436.05,-2889.91 10418.7,-2845.65"/>
<polygon fill="black" stroke="black" points="10421.92,-2844.28 10414.91,-2836.33 10415.44,-2846.92 10421.92,-2844.28"/>
</g>
<!-- l1_final_res_tp6 -->
<g id="node226" class="node">
<title>l1_final_res_tp6</title>
<polygon fill="lightyellow" stroke="black" points="10642.93,-2558.17 10071.95,-2558.17 9925.07,-2422.17 10496.05,-2422.17 10642.93,-2558.17"/>
<text text-anchor="middle" x="10284" y="-2508.97" font-family="Times,serif" font-size="14.00">Layer 1 Final Residual</text>
<text text-anchor="middle" x="10284" y="-2493.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="10284" y="-2478.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="10284" y="-2463.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_residual_tp6&#45;&gt;l1_final_res_tp6 -->
<g id="edge480" class="edge">
<title>l1_residual_tp6&#45;&gt;l1_final_res_tp6</title>
<path fill="none" stroke="black" d="M10472.63,-3095.36C10664.13,-3074.95 10889,-3031.89 10889,-2942.17 10889,-2942.17 10889,-2942.17 10889,-2662.17 10889,-2597.68 10760.1,-2556.29 10621.3,-2530.42"/>
<polygon fill="black" stroke="black" points="10621.76,-2526.94 10611.29,-2528.58 10620.49,-2533.83 10621.76,-2526.94"/>
</g>
<!-- l1_gate_tp6&#45;&gt;l1_exp0_gpu6 -->
<g id="edge455" class="edge">
<title>l1_gate_tp6&#45;&gt;l1_exp0_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10015.9,-2899.3C9900.39,-2874.52 9768.98,-2846.15 9727.95,-2836.14"/>
<polygon fill="black" stroke="black" points="9728.8,-2832.74 9718.24,-2833.64 9727.06,-2839.52 9728.8,-2832.74"/>
</g>
<!-- l1_gate_tp6&#45;&gt;l1_exp1_gpu6 -->
<g id="edge458" class="edge">
<title>l1_gate_tp6&#45;&gt;l1_exp1_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10018.94,-2873.07C9984.64,-2860.84 9950.18,-2848.54 9919.93,-2837.75"/>
<polygon fill="black" stroke="black" points="9920.86,-2834.36 9910.26,-2834.3 9918.51,-2840.96 9920.86,-2834.36"/>
</g>
<!-- l1_gate_tp6&#45;&gt;l1_exp2_gpu6 -->
<g id="edge461" class="edge">
<title>l1_gate_tp6&#45;&gt;l1_exp2_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10029.86,-2921.46C9895.9,-2905.27 9707.74,-2878.13 9535.91,-2836.26"/>
<polygon fill="black" stroke="black" points="9536.73,-2832.86 9526.18,-2833.87 9535.06,-2839.65 9536.73,-2832.86"/>
</g>
<!-- l1_gate_tp6&#45;&gt;l1_exp3_gpu6 -->
<g id="edge464" class="edge">
<title>l1_gate_tp6&#45;&gt;l1_exp3_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10112.97,-2873.07C10098.18,-2862.52 10083.32,-2851.92 10069.81,-2842.28"/>
<polygon fill="black" stroke="black" points="10071.76,-2839.36 10061.58,-2836.41 10067.69,-2845.06 10071.76,-2839.36"/>
</g>
<!-- l1_gate_tp6&#45;&gt;l1_exp4_gpu6 -->
<g id="edge467" class="edge">
<title>l1_gate_tp6&#45;&gt;l1_exp4_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10354.36,-2912.91C10447.28,-2894.61 10569.73,-2868.45 10685.97,-2836.36"/>
<polygon fill="black" stroke="black" points="10687.06,-2839.69 10695.76,-2833.64 10685.19,-2832.95 10687.06,-2839.69"/>
</g>
<!-- l1_gate_tp6&#45;&gt;l1_exp5_gpu6 -->
<g id="edge470" class="edge">
<title>l1_gate_tp6&#45;&gt;l1_exp5_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10207,-2872.87C10207,-2863.93 10207,-2854.95 10207,-2846.56"/>
<polygon fill="black" stroke="black" points="10210.5,-2846.29 10207,-2836.29 10203.5,-2846.29 10210.5,-2846.29"/>
</g>
<!-- l1_gate_tp6&#45;&gt;l1_exp6_gpu6 -->
<g id="edge473" class="edge">
<title>l1_gate_tp6&#45;&gt;l1_exp6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10341.57,-2892.15C10391.83,-2874.22 10447.87,-2854.23 10494.08,-2837.74"/>
<polygon fill="black" stroke="black" points="10495.54,-2840.94 10503.79,-2834.28 10493.19,-2834.35 10495.54,-2840.94"/>
</g>
<!-- l1_gate_tp6&#45;&gt;l1_exp7_gpu6 -->
<g id="edge476" class="edge">
<title>l1_gate_tp6&#45;&gt;l1_exp7_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10301.03,-2873.07C10315.82,-2862.52 10330.68,-2851.92 10344.19,-2842.28"/>
<polygon fill="black" stroke="black" points="10346.31,-2845.06 10352.42,-2836.41 10342.24,-2839.36 10346.31,-2845.06"/>
</g>
<!-- l1_exp_agg_tp6 -->
<g id="node225" class="node">
<title>l1_exp_agg_tp6</title>
<polygon fill="lightyellow" stroke="black" points="10426.58,-2731.17 10077.28,-2731.17 9987.42,-2595.17 10336.72,-2595.17 10426.58,-2731.17"/>
<text text-anchor="middle" x="10207" y="-2681.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10207" y="-2666.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="10207" y="-2651.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="10207" y="-2636.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_exp0_gpu6&#45;&gt;l1_exp_agg_tp6 -->
<g id="edge457" class="edge">
<title>l1_exp0_gpu6&#45;&gt;l1_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M9718.24,-2770.69C9721.19,-2769.82 9724.11,-2768.97 9727,-2768.17 9830.61,-2739.24 9948.66,-2713.57 10041.77,-2694.97"/>
<polygon fill="black" stroke="black" points="10042.72,-2698.35 10051.85,-2692.96 10041.35,-2691.48 10042.72,-2698.35"/>
</g>
<!-- l1_exp1_gpu6&#45;&gt;l1_exp_agg_tp6 -->
<g id="edge460" class="edge">
<title>l1_exp1_gpu6&#45;&gt;l1_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M9910.14,-2770.08C9953.38,-2754.65 10006.85,-2735.57 10056.45,-2717.88"/>
<polygon fill="black" stroke="black" points="10057.75,-2721.13 10065.99,-2714.48 10055.39,-2714.54 10057.75,-2721.13"/>
</g>
<!-- l1_exp2_gpu6&#45;&gt;l1_exp_agg_tp6 -->
<g id="edge463" class="edge">
<title>l1_exp2_gpu6&#45;&gt;l1_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M9526.18,-2770.46C9529.15,-2769.65 9532.09,-2768.89 9535,-2768.17 9702.29,-2726.82 9897.29,-2698.81 10034.01,-2682.37"/>
<polygon fill="black" stroke="black" points="10034.65,-2685.82 10044.16,-2681.16 10033.82,-2678.87 10034.65,-2685.82"/>
</g>
<!-- l1_exp3_gpu6&#45;&gt;l1_exp_agg_tp6 -->
<g id="edge466" class="edge">
<title>l1_exp3_gpu6&#45;&gt;l1_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10061.48,-2768C10074.59,-2758.65 10089.39,-2748.08 10104.42,-2737.36"/>
<polygon fill="black" stroke="black" points="10106.67,-2740.06 10112.78,-2731.4 10102.6,-2734.36 10106.67,-2740.06"/>
</g>
<!-- l1_exp4_gpu6&#45;&gt;l1_exp_agg_tp6 -->
<g id="edge469" class="edge">
<title>l1_exp4_gpu6&#45;&gt;l1_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10695.76,-2770.69C10692.81,-2769.82 10689.89,-2768.97 10687,-2768.17 10599.51,-2743.74 10501.71,-2721.64 10417.34,-2704.15"/>
<polygon fill="black" stroke="black" points="10417.88,-2700.69 10407.38,-2702.09 10416.47,-2707.54 10417.88,-2700.69"/>
</g>
<!-- l1_exp5_gpu6&#45;&gt;l1_exp_agg_tp6 -->
<g id="edge472" class="edge">
<title>l1_exp5_gpu6&#45;&gt;l1_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10207,-2768C10207,-2759.86 10207,-2750.8 10207,-2741.52"/>
<polygon fill="black" stroke="black" points="10210.5,-2741.4 10207,-2731.4 10203.5,-2741.4 10210.5,-2741.4"/>
</g>
<!-- l1_exp6_gpu6&#45;&gt;l1_exp_agg_tp6 -->
<g id="edge475" class="edge">
<title>l1_exp6_gpu6&#45;&gt;l1_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10503.86,-2770.08C10474.13,-2759.47 10439.56,-2747.14 10404.73,-2734.71"/>
<polygon fill="black" stroke="black" points="10405.5,-2731.27 10394.91,-2731.21 10403.15,-2737.86 10405.5,-2731.27"/>
</g>
<!-- l1_exp7_gpu6&#45;&gt;l1_exp_agg_tp6 -->
<g id="edge478" class="edge">
<title>l1_exp7_gpu6&#45;&gt;l1_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10352.52,-2768C10339.41,-2758.65 10324.61,-2748.08 10309.58,-2737.36"/>
<polygon fill="black" stroke="black" points="10311.4,-2734.36 10301.22,-2731.4 10307.33,-2740.06 10311.4,-2734.36"/>
</g>
<!-- l1_exp_agg_tp6&#45;&gt;l1_final_res_tp6 -->
<g id="edge479" class="edge">
<title>l1_exp_agg_tp6&#45;&gt;l1_final_res_tp6</title>
<path fill="none" stroke="black" d="M10237.21,-2595.07C10241.29,-2586.02 10245.49,-2576.68 10249.64,-2567.48"/>
<polygon fill="black" stroke="black" points="10252.83,-2568.9 10253.75,-2558.35 10246.45,-2566.03 10252.83,-2568.9"/>
</g>
<!-- l2_qkv_tp6 -->
<g id="node332" class="node">
<title>l2_qkv_tp6</title>
<polygon fill="lightgreen" stroke="black" points="10397,-2320.17 10171,-2320.17 10171,-2252.17 10397,-2252.17 10397,-2320.17"/>
<text text-anchor="middle" x="10284" y="-2304.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10284" y="-2289.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="10284" y="-2274.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="10284" y="-2259.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l1_final_res_tp6&#45;&gt;l2_qkv_tp6 -->
<g id="edge519" class="edge">
<title>l1_final_res_tp6&#45;&gt;l2_qkv_tp6</title>
<path fill="none" stroke="black" d="M10284,-2421.9C10284,-2391.71 10284,-2356.97 10284,-2330.33"/>
<polygon fill="black" stroke="black" points="10287.5,-2330.18 10284,-2320.18 10280.5,-2330.18 10287.5,-2330.18"/>
<text text-anchor="middle" x="10345" y="-2392.97" font-family="Times,serif" font-size="14.00">Pipeline P2P</text>
<text text-anchor="middle" x="10345" y="-2377.97" font-family="Times,serif" font-size="14.00">GPU 6  GPU 14</text>
</g>
<!-- l1_attn_tp7 -->
<g id="node228" class="node">
<title>l1_attn_tp7</title>
<polygon fill="lightgreen" stroke="black" points="11892,-3392.17 11678,-3392.17 11678,-3324.17 11892,-3324.17 11892,-3392.17"/>
<text text-anchor="middle" x="11785" y="-3376.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="11785" y="-3361.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="11785" y="-3346.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="11785" y="-3331.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_qkv_tp7&#45;&gt;l1_attn_tp7 -->
<g id="edge482" class="edge">
<title>l1_qkv_tp7&#45;&gt;l1_attn_tp7</title>
<path fill="none" stroke="black" d="M11781.61,-3429.01C11782.02,-3420.56 11782.47,-3411.34 11782.9,-3402.47"/>
<polygon fill="black" stroke="black" points="11786.4,-3402.42 11783.39,-3392.26 11779.41,-3402.08 11786.4,-3402.42"/>
</g>
<!-- l1_out_proj_tp7 -->
<g id="node229" class="node">
<title>l1_out_proj_tp7</title>
<polygon fill="lightgreen" stroke="black" points="11892,-3287.17 11680,-3287.17 11680,-3219.17 11892,-3219.17 11892,-3287.17"/>
<text text-anchor="middle" x="11786" y="-3271.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11786" y="-3256.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="11786" y="-3241.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="11786" y="-3226.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_attn_tp7&#45;&gt;l1_out_proj_tp7 -->
<g id="edge483" class="edge">
<title>l1_attn_tp7&#45;&gt;l1_out_proj_tp7</title>
<path fill="none" stroke="black" d="M11785.32,-3324.01C11785.4,-3315.56 11785.49,-3306.34 11785.58,-3297.47"/>
<polygon fill="black" stroke="black" points="11789.08,-3297.29 11785.68,-3287.26 11782.08,-3297.23 11789.08,-3297.29"/>
</g>
<!-- l1_out_proj_tp7&#45;&gt;l1_residual_tp7 -->
<g id="edge484" class="edge">
<title>l1_out_proj_tp7&#45;&gt;l1_residual_tp7</title>
<path fill="none" stroke="black" d="M11812.87,-3219C11819.96,-3210.25 11827.9,-3200.45 11836.01,-3190.45"/>
<polygon fill="black" stroke="black" points="11838.95,-3192.37 11842.53,-3182.4 11833.51,-3187.97 11838.95,-3192.37"/>
</g>
<!-- l1_gate_tp7 -->
<g id="node231" class="node">
<title>l1_gate_tp7</title>
<polygon fill="lightyellow" stroke="black" points="11916.2,-3009.17 11586.59,-3009.17 11501.8,-2873.17 11831.41,-2873.17 11916.2,-3009.17"/>
<text text-anchor="middle" x="11709" y="-2959.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="11709" y="-2944.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="11709" y="-2929.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="11709" y="-2914.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_residual_tp7&#45;&gt;l1_gate_tp7 -->
<g id="edge486" class="edge">
<title>l1_residual_tp7&#45;&gt;l1_gate_tp7</title>
<path fill="none" stroke="black" d="M11823.24,-3046.07C11812.45,-3036.27 11801.3,-3026.12 11790.38,-3016.18"/>
<polygon fill="black" stroke="black" points="11792.61,-3013.49 11782.86,-3009.35 11787.9,-3018.66 11792.61,-3013.49"/>
</g>
<!-- l1_exp0_gpu7 -->
<g id="node232" class="node">
<title>l1_exp0_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="11466,-2836.17 11292,-2836.17 11292,-2768.17 11466,-2768.17 11466,-2836.17"/>
<text text-anchor="middle" x="11379" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="11379" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11379" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11379" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_residual_tp7&#45;&gt;l1_exp0_gpu7 -->
<g id="edge488" class="edge">
<title>l1_residual_tp7&#45;&gt;l1_exp0_gpu7</title>
<path fill="none" stroke="black" d="M11539.62,-3047.86C11506.14,-3036.47 11479.36,-3023.58 11465,-3009.17 11420.12,-2964.11 11397.44,-2892.18 11386.94,-2846.34"/>
<polygon fill="black" stroke="black" points="11390.33,-2845.42 11384.76,-2836.41 11383.49,-2846.92 11390.33,-2845.42"/>
</g>
<!-- l1_exp1_gpu7 -->
<g id="node233" class="node">
<title>l1_exp1_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="11274,-2836.17 11100,-2836.17 11100,-2768.17 11274,-2768.17 11274,-2836.17"/>
<text text-anchor="middle" x="11187" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="11187" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11187" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11187" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_residual_tp7&#45;&gt;l1_exp1_gpu7 -->
<g id="edge491" class="edge">
<title>l1_residual_tp7&#45;&gt;l1_exp1_gpu7</title>
<path fill="none" stroke="black" d="M11570.16,-3076.04C11507.63,-3060.81 11444.44,-3039.35 11389,-3009.17 11314.72,-2968.72 11250.54,-2892 11215.46,-2844.46"/>
<polygon fill="black" stroke="black" points="11218.18,-2842.25 11209.46,-2836.23 11212.52,-2846.37 11218.18,-2842.25"/>
</g>
<!-- l1_exp2_gpu7 -->
<g id="node234" class="node">
<title>l1_exp2_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="11082,-2836.17 10908,-2836.17 10908,-2768.17 11082,-2768.17 11082,-2836.17"/>
<text text-anchor="middle" x="10995" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="10995" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10995" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10995" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_residual_tp7&#45;&gt;l1_exp2_gpu7 -->
<g id="edge494" class="edge">
<title>l1_residual_tp7&#45;&gt;l1_exp2_gpu7</title>
<path fill="none" stroke="black" d="M11573.6,-3079.29C11436.9,-3061.51 11295.26,-3037.52 11234,-3009.17 11149.47,-2970.04 11071.79,-2892.01 11029.16,-2844.02"/>
<polygon fill="black" stroke="black" points="11031.6,-2841.49 11022.37,-2836.29 11026.34,-2846.12 11031.6,-2841.49"/>
</g>
<!-- l1_exp3_gpu7 -->
<g id="node235" class="node">
<title>l1_exp3_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="11658,-2836.17 11484,-2836.17 11484,-2768.17 11658,-2768.17 11658,-2836.17"/>
<text text-anchor="middle" x="11571" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="11571" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11571" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11571" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_residual_tp7&#45;&gt;l1_exp3_gpu7 -->
<g id="edge497" class="edge">
<title>l1_residual_tp7&#45;&gt;l1_exp3_gpu7</title>
<path fill="none" stroke="black" d="M11551.79,-3046.14C11524.73,-3035.27 11503.7,-3022.98 11493,-3009.17 11455.97,-2961.39 11468.37,-2928.37 11493,-2873.17 11497.92,-2862.13 11505.54,-2852.11 11514.12,-2843.32"/>
<polygon fill="black" stroke="black" points="11516.72,-2845.68 11521.52,-2836.23 11511.88,-2840.63 11516.72,-2845.68"/>
</g>
<!-- l1_exp4_gpu7 -->
<g id="node236" class="node">
<title>l1_exp4_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="12234,-2836.17 12060,-2836.17 12060,-2768.17 12234,-2768.17 12234,-2836.17"/>
<text text-anchor="middle" x="12147" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="12147" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="12147" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="12147" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_residual_tp7&#45;&gt;l1_exp4_gpu7 -->
<g id="edge500" class="edge">
<title>l1_residual_tp7&#45;&gt;l1_exp4_gpu7</title>
<path fill="none" stroke="black" d="M11951.25,-3045.9C12000.73,-2984.54 12072.27,-2895.84 12113.76,-2844.38"/>
<polygon fill="black" stroke="black" points="12116.61,-2846.43 12120.16,-2836.45 12111.16,-2842.04 12116.61,-2846.43"/>
</g>
<!-- l1_exp5_gpu7 -->
<g id="node237" class="node">
<title>l1_exp5_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="12426,-2836.17 12252,-2836.17 12252,-2768.17 12426,-2768.17 12426,-2836.17"/>
<text text-anchor="middle" x="12339" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="12339" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="12339" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="12339" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_residual_tp7&#45;&gt;l1_exp5_gpu7 -->
<g id="edge503" class="edge">
<title>l1_residual_tp7&#45;&gt;l1_exp5_gpu7</title>
<path fill="none" stroke="black" d="M11992.64,-3046.09C12081.3,-2983.91 12210.2,-2893.5 12283.16,-2842.33"/>
<polygon fill="black" stroke="black" points="12285.6,-2844.89 12291.78,-2836.29 12281.58,-2839.16 12285.6,-2844.89"/>
</g>
<!-- l1_exp6_gpu7 -->
<g id="node238" class="node">
<title>l1_exp6_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="12042,-2836.17 11868,-2836.17 11868,-2768.17 12042,-2768.17 12042,-2836.17"/>
<text text-anchor="middle" x="11955" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="11955" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11955" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11955" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_residual_tp7&#45;&gt;l1_exp6_gpu7 -->
<g id="edge506" class="edge">
<title>l1_residual_tp7&#45;&gt;l1_exp6_gpu7</title>
<path fill="none" stroke="black" d="M11934.01,-3045.94C11936.33,-3040.04 11938.38,-3034.07 11940,-3028.17 11956.85,-2966.69 11958.33,-2892.4 11957.18,-2846.46"/>
<polygon fill="black" stroke="black" points="11960.67,-2846.15 11956.87,-2836.26 11953.68,-2846.36 11960.67,-2846.15"/>
</g>
<!-- l1_exp7_gpu7 -->
<g id="node239" class="node">
<title>l1_exp7_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="11850,-2836.17 11676,-2836.17 11676,-2768.17 11850,-2768.17 11850,-2836.17"/>
<text text-anchor="middle" x="11763" y="-2820.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="11763" y="-2805.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11763" y="-2790.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11763" y="-2775.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_residual_tp7&#45;&gt;l1_exp7_gpu7 -->
<g id="edge509" class="edge">
<title>l1_residual_tp7&#45;&gt;l1_exp7_gpu7</title>
<path fill="none" stroke="black" d="M11917.84,-3046C11920.82,-3033.85 11923.41,-3021.22 11925,-3009.17 11928.96,-2979.21 11941.6,-2898.42 11925,-2873.17 11920.52,-2866.35 11891.74,-2853.09 11859.64,-2839.93"/>
<polygon fill="black" stroke="black" points="11860.64,-2836.56 11850.06,-2836.04 11858.01,-2843.05 11860.64,-2836.56"/>
</g>
<!-- l1_final_res_tp7 -->
<g id="node241" class="node">
<title>l1_final_res_tp7</title>
<polygon fill="lightyellow" stroke="black" points="12388.93,-2558.17 11817.95,-2558.17 11671.07,-2422.17 12242.05,-2422.17 12388.93,-2558.17"/>
<text text-anchor="middle" x="12030" y="-2508.97" font-family="Times,serif" font-size="14.00">Layer 1 Final Residual</text>
<text text-anchor="middle" x="12030" y="-2493.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="12030" y="-2478.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="12030" y="-2463.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_residual_tp7&#45;&gt;l1_final_res_tp7 -->
<g id="edge512" class="edge">
<title>l1_residual_tp7&#45;&gt;l1_final_res_tp7</title>
<path fill="none" stroke="black" d="M12146.15,-3080.2C12290.91,-3053.8 12445,-3009.81 12445,-2942.17 12445,-2942.17 12445,-2942.17 12445,-2662.17 12445,-2623.59 12382.92,-2589.27 12306.78,-2561.69"/>
<polygon fill="black" stroke="black" points="12307.53,-2558.24 12296.93,-2558.19 12305.18,-2564.84 12307.53,-2558.24"/>
</g>
<!-- l1_gate_tp7&#45;&gt;l1_exp0_gpu7 -->
<g id="edge487" class="edge">
<title>l1_gate_tp7&#45;&gt;l1_exp0_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11547.38,-2873.07C11520.02,-2861.71 11492.52,-2850.3 11467.92,-2840.08"/>
<polygon fill="black" stroke="black" points="11469.22,-2836.83 11458.64,-2836.23 11466.53,-2843.3 11469.22,-2836.83"/>
</g>
<!-- l1_gate_tp7&#45;&gt;l1_exp1_gpu7 -->
<g id="edge490" class="edge">
<title>l1_gate_tp7&#45;&gt;l1_exp1_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11516.62,-2897.15C11445.99,-2880.37 11365.36,-2860.05 11283.94,-2836.37"/>
<polygon fill="black" stroke="black" points="11284.59,-2832.91 11274.01,-2833.46 11282.62,-2839.63 11284.59,-2832.91"/>
</g>
<!-- l1_gate_tp7&#45;&gt;l1_exp2_gpu7 -->
<g id="edge493" class="edge">
<title>l1_gate_tp7&#45;&gt;l1_exp2_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11529.56,-2917.92C11408.01,-2900.96 11244,-2874.39 11092.18,-2836.34"/>
<polygon fill="black" stroke="black" points="11092.75,-2832.88 11082.19,-2833.82 11091.03,-2839.66 11092.75,-2832.88"/>
</g>
<!-- l1_gate_tp7&#45;&gt;l1_exp3_gpu7 -->
<g id="edge496" class="edge">
<title>l1_gate_tp7&#45;&gt;l1_exp3_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11641.21,-2872.87C11631.1,-2862.83 11620.95,-2852.76 11611.64,-2843.51"/>
<polygon fill="black" stroke="black" points="11613.93,-2840.86 11604.37,-2836.29 11609,-2845.82 11613.93,-2840.86"/>
</g>
<!-- l1_gate_tp7&#45;&gt;l1_exp4_gpu7 -->
<g id="edge499" class="edge">
<title>l1_gate_tp7&#45;&gt;l1_exp4_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11847.88,-2899.17C11907.48,-2881.27 11978.07,-2859.67 12050.2,-2836.4"/>
<polygon fill="black" stroke="black" points="12051.49,-2839.66 12059.92,-2833.25 12049.33,-2833 12051.49,-2839.66"/>
</g>
<!-- l1_gate_tp7&#45;&gt;l1_exp5_gpu7 -->
<g id="edge502" class="edge">
<title>l1_gate_tp7&#45;&gt;l1_exp5_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11858.74,-2916.73C11963.86,-2898.92 12107.6,-2871.86 12241.73,-2836.4"/>
<polygon fill="black" stroke="black" points="12243.02,-2839.68 12251.78,-2833.72 12241.22,-2832.91 12243.02,-2839.68"/>
</g>
<!-- l1_gate_tp7&#45;&gt;l1_exp6_gpu7 -->
<g id="edge505" class="edge">
<title>l1_gate_tp7&#45;&gt;l1_exp6_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11829.48,-2873.07C11849.07,-2862.16 11868.75,-2851.2 11886.52,-2841.3"/>
<polygon fill="black" stroke="black" points="11888.6,-2844.15 11895.63,-2836.23 11885.19,-2838.04 11888.6,-2844.15"/>
</g>
<!-- l1_gate_tp7&#45;&gt;l1_exp7_gpu7 -->
<g id="edge508" class="edge">
<title>l1_gate_tp7&#45;&gt;l1_exp7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11735.53,-2872.87C11739.17,-2863.63 11742.82,-2854.35 11746.22,-2845.73"/>
<polygon fill="black" stroke="black" points="11749.53,-2846.88 11749.94,-2836.29 11743.02,-2844.31 11749.53,-2846.88"/>
</g>
<!-- l1_exp_agg_tp7 -->
<g id="node240" class="node">
<title>l1_exp_agg_tp7</title>
<polygon fill="lightyellow" stroke="black" points="11982.58,-2731.17 11633.28,-2731.17 11543.42,-2595.17 11892.72,-2595.17 11982.58,-2731.17"/>
<text text-anchor="middle" x="11763" y="-2681.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11763" y="-2666.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="11763" y="-2651.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="11763" y="-2636.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_exp0_gpu7&#45;&gt;l1_exp_agg_tp7 -->
<g id="edge489" class="edge">
<title>l1_exp0_gpu7&#45;&gt;l1_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11466.14,-2770.08C11509.38,-2754.65 11562.85,-2735.57 11612.45,-2717.88"/>
<polygon fill="black" stroke="black" points="11613.75,-2721.13 11621.99,-2714.48 11611.39,-2714.54 11613.75,-2721.13"/>
</g>
<!-- l1_exp1_gpu7&#45;&gt;l1_exp_agg_tp7 -->
<g id="edge492" class="edge">
<title>l1_exp1_gpu7&#45;&gt;l1_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11274.24,-2770.69C11277.19,-2769.82 11280.11,-2768.97 11283,-2768.17 11386.61,-2739.24 11504.66,-2713.57 11597.77,-2694.97"/>
<polygon fill="black" stroke="black" points="11598.72,-2698.35 11607.85,-2692.96 11597.35,-2691.48 11598.72,-2698.35"/>
</g>
<!-- l1_exp2_gpu7&#45;&gt;l1_exp_agg_tp7 -->
<g id="edge495" class="edge">
<title>l1_exp2_gpu7&#45;&gt;l1_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11082.18,-2770.46C11085.15,-2769.65 11088.09,-2768.89 11091,-2768.17 11258.29,-2726.82 11453.29,-2698.81 11590.01,-2682.37"/>
<polygon fill="black" stroke="black" points="11590.65,-2685.82 11600.16,-2681.16 11589.82,-2678.87 11590.65,-2685.82"/>
</g>
<!-- l1_exp3_gpu7&#45;&gt;l1_exp_agg_tp7 -->
<g id="edge498" class="edge">
<title>l1_exp3_gpu7&#45;&gt;l1_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11617.48,-2768C11630.59,-2758.65 11645.39,-2748.08 11660.42,-2737.36"/>
<polygon fill="black" stroke="black" points="11662.67,-2740.06 11668.78,-2731.4 11658.6,-2734.36 11662.67,-2740.06"/>
</g>
<!-- l1_exp4_gpu7&#45;&gt;l1_exp_agg_tp7 -->
<g id="edge501" class="edge">
<title>l1_exp4_gpu7&#45;&gt;l1_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M12059.86,-2770.08C12030.13,-2759.47 11995.56,-2747.14 11960.73,-2734.71"/>
<polygon fill="black" stroke="black" points="11961.5,-2731.27 11950.91,-2731.21 11959.15,-2737.86 11961.5,-2731.27"/>
</g>
<!-- l1_exp5_gpu7&#45;&gt;l1_exp_agg_tp7 -->
<g id="edge504" class="edge">
<title>l1_exp5_gpu7&#45;&gt;l1_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M12251.76,-2770.69C12248.81,-2769.82 12245.89,-2768.97 12243,-2768.17 12155.51,-2743.74 12057.71,-2721.64 11973.34,-2704.15"/>
<polygon fill="black" stroke="black" points="11973.88,-2700.69 11963.38,-2702.09 11972.47,-2707.54 11973.88,-2700.69"/>
</g>
<!-- l1_exp6_gpu7&#45;&gt;l1_exp_agg_tp7 -->
<g id="edge507" class="edge">
<title>l1_exp6_gpu7&#45;&gt;l1_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11908.52,-2768C11895.41,-2758.65 11880.61,-2748.08 11865.58,-2737.36"/>
<polygon fill="black" stroke="black" points="11867.4,-2734.36 11857.22,-2731.4 11863.33,-2740.06 11867.4,-2734.36"/>
</g>
<!-- l1_exp7_gpu7&#45;&gt;l1_exp_agg_tp7 -->
<g id="edge510" class="edge">
<title>l1_exp7_gpu7&#45;&gt;l1_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11763,-2768C11763,-2759.86 11763,-2750.8 11763,-2741.52"/>
<polygon fill="black" stroke="black" points="11766.5,-2741.4 11763,-2731.4 11759.5,-2741.4 11766.5,-2741.4"/>
</g>
<!-- l1_exp_agg_tp7&#45;&gt;l1_final_res_tp7 -->
<g id="edge511" class="edge">
<title>l1_exp_agg_tp7&#45;&gt;l1_final_res_tp7</title>
<path fill="none" stroke="black" d="M11867.76,-2595.07C11883.81,-2584.8 11900.44,-2574.14 11916.66,-2563.75"/>
<polygon fill="black" stroke="black" points="11918.57,-2566.69 11925.1,-2558.35 11914.8,-2560.79 11918.57,-2566.69"/>
</g>
<!-- l2_qkv_tp7 -->
<g id="node347" class="node">
<title>l2_qkv_tp7</title>
<polygon fill="lightgreen" stroke="black" points="12143,-2320.17 11917,-2320.17 11917,-2252.17 12143,-2252.17 12143,-2320.17"/>
<text text-anchor="middle" x="12030" y="-2304.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12030" y="-2289.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="12030" y="-2274.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="12030" y="-2259.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l1_final_res_tp7&#45;&gt;l2_qkv_tp7 -->
<g id="edge520" class="edge">
<title>l1_final_res_tp7&#45;&gt;l2_qkv_tp7</title>
<path fill="none" stroke="black" d="M12030,-2421.9C12030,-2391.71 12030,-2356.97 12030,-2330.33"/>
<polygon fill="black" stroke="black" points="12033.5,-2330.18 12030,-2320.18 12026.5,-2330.18 12033.5,-2330.18"/>
<text text-anchor="middle" x="12091" y="-2392.97" font-family="Times,serif" font-size="14.00">Pipeline P2P</text>
<text text-anchor="middle" x="12091" y="-2377.97" font-family="Times,serif" font-size="14.00">GPU 7  GPU 15</text>
</g>
<!-- l2_attn_tp0 -->
<g id="node243" class="node">
<title>l2_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="962,-2215.17 748,-2215.17 748,-2147.17 962,-2147.17 962,-2215.17"/>
<text text-anchor="middle" x="855" y="-2199.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="855" y="-2184.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="855" y="-2169.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="855" y="-2154.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_qkv_tp0&#45;&gt;l2_attn_tp0 -->
<g id="edge521" class="edge">
<title>l2_qkv_tp0&#45;&gt;l2_attn_tp0</title>
<path fill="none" stroke="black" d="M918.06,-2252.01C909.68,-2242.73 900.48,-2232.53 891.75,-2222.87"/>
<polygon fill="black" stroke="black" points="894.18,-2220.34 884.88,-2215.26 888.99,-2225.03 894.18,-2220.34"/>
</g>
<!-- l2_residual_tp0 -->
<g id="node245" class="node">
<title>l2_residual_tp0</title>
<polygon fill="lightyellow" stroke="black" points="1305.93,-2005.17 734.95,-2005.17 588.07,-1869.17 1159.05,-1869.17 1305.93,-2005.17"/>
<text text-anchor="middle" x="947" y="-1955.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="947" y="-1940.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="947" y="-1925.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="947" y="-1910.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_qkv_tp0&#45;&gt;l2_residual_tp0 -->
<g id="edge524" class="edge">
<title>l2_qkv_tp0&#45;&gt;l2_residual_tp0</title>
<path fill="none" stroke="black" d="M961.33,-2251.88C965.26,-2240.44 969.04,-2227.42 971,-2215.17 973.42,-2200.06 972.11,-2060.69 970,-2042.17 969,-2033.42 967.58,-2024.34 965.93,-2015.34"/>
<polygon fill="black" stroke="black" points="969.31,-2014.39 963.97,-2005.23 962.44,-2015.72 969.31,-2014.39"/>
</g>
<!-- l2_out_proj_tp0 -->
<g id="node244" class="node">
<title>l2_out_proj_tp0</title>
<polygon fill="lightgreen" stroke="black" points="961,-2110.17 749,-2110.17 749,-2042.17 961,-2042.17 961,-2110.17"/>
<text text-anchor="middle" x="855" y="-2094.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="855" y="-2079.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="855" y="-2064.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="855" y="-2049.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_attn_tp0&#45;&gt;l2_out_proj_tp0 -->
<g id="edge522" class="edge">
<title>l2_attn_tp0&#45;&gt;l2_out_proj_tp0</title>
<path fill="none" stroke="black" d="M855,-2147.01C855,-2138.56 855,-2129.34 855,-2120.47"/>
<polygon fill="black" stroke="black" points="858.5,-2120.26 855,-2110.26 851.5,-2120.26 858.5,-2120.26"/>
</g>
<!-- l2_out_proj_tp0&#45;&gt;l2_residual_tp0 -->
<g id="edge523" class="edge">
<title>l2_out_proj_tp0&#45;&gt;l2_residual_tp0</title>
<path fill="none" stroke="black" d="M877.27,-2042C883.09,-2033.34 889.6,-2023.64 896.25,-2013.74"/>
<polygon fill="black" stroke="black" points="899.18,-2015.65 901.85,-2005.4 893.37,-2011.75 899.18,-2015.65"/>
</g>
<!-- l2_gate_tp0 -->
<g id="node246" class="node">
<title>l2_gate_tp0</title>
<polygon fill="lightyellow" stroke="black" points="1323.2,-1832.17 993.59,-1832.17 908.8,-1696.17 1238.41,-1696.17 1323.2,-1832.17"/>
<text text-anchor="middle" x="1116" y="-1782.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="1116" y="-1767.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="1116" y="-1752.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="1116" y="-1737.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_residual_tp0&#45;&gt;l2_gate_tp0 -->
<g id="edge525" class="edge">
<title>l2_residual_tp0&#45;&gt;l2_gate_tp0</title>
<path fill="none" stroke="black" d="M1013.31,-1869.07C1022.91,-1859.36 1032.84,-1849.32 1042.56,-1839.47"/>
<polygon fill="black" stroke="black" points="1045.07,-1841.92 1049.61,-1832.35 1040.09,-1837 1045.07,-1841.92"/>
</g>
<!-- l2_exp0_gpu8 -->
<g id="node247" class="node">
<title>l2_exp0_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="1203,-1659.17 1029,-1659.17 1029,-1591.17 1203,-1591.17 1203,-1659.17"/>
<text text-anchor="middle" x="1116" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1116" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1116" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1116" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_residual_tp0&#45;&gt;l2_exp0_gpu8 -->
<g id="edge527" class="edge">
<title>l2_residual_tp0&#45;&gt;l2_exp0_gpu8</title>
<path fill="none" stroke="black" d="M908.03,-1868.94C883.65,-1817.09 863.19,-1746.04 900,-1696.17 931.33,-1653.72 963.24,-1673.92 1019,-1659.17"/>
<polygon fill="black" stroke="black" points="1020.32,-1662.43 1028.92,-1656.24 1018.34,-1655.71 1020.32,-1662.43"/>
</g>
<!-- l2_exp1_gpu8 -->
<g id="node248" class="node">
<title>l2_exp1_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="1011,-1659.17 837,-1659.17 837,-1591.17 1011,-1591.17 1011,-1659.17"/>
<text text-anchor="middle" x="924" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="924" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="924" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="924" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_residual_tp0&#45;&gt;l2_exp1_gpu8 -->
<g id="edge530" class="edge">
<title>l2_residual_tp0&#45;&gt;l2_exp1_gpu8</title>
<path fill="none" stroke="black" d="M892.59,-1869.09C889.58,-1863.25 886.98,-1857.24 885,-1851.17 861.03,-1777.64 860.2,-1750.42 885,-1677.17 886.05,-1674.05 887.38,-1670.98 888.91,-1667.98"/>
<polygon fill="black" stroke="black" points="892,-1669.63 894.01,-1659.22 885.95,-1666.1 892,-1669.63"/>
</g>
<!-- l2_exp2_gpu8 -->
<g id="node249" class="node">
<title>l2_exp2_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="435,-1659.17 261,-1659.17 261,-1591.17 435,-1591.17 435,-1659.17"/>
<text text-anchor="middle" x="348" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="348" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="348" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="348" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_residual_tp0&#45;&gt;l2_exp2_gpu8 -->
<g id="edge533" class="edge">
<title>l2_residual_tp0&#45;&gt;l2_exp2_gpu8</title>
<path fill="none" stroke="black" d="M690.31,-1869.09C661.56,-1858.24 633.22,-1845.96 607,-1832.17 521.58,-1787.22 436.72,-1712.54 388.48,-1666.51"/>
<polygon fill="black" stroke="black" points="390.7,-1663.79 381.06,-1659.38 385.85,-1668.83 390.7,-1663.79"/>
</g>
<!-- l2_exp3_gpu8 -->
<g id="node250" class="node">
<title>l2_exp3_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="627,-1659.17 453,-1659.17 453,-1591.17 627,-1591.17 627,-1659.17"/>
<text text-anchor="middle" x="540" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="540" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="540" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="540" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_residual_tp0&#45;&gt;l2_exp3_gpu8 -->
<g id="edge536" class="edge">
<title>l2_residual_tp0&#45;&gt;l2_exp3_gpu8</title>
<path fill="none" stroke="black" d="M824.25,-1868.9C805.34,-1857.27 786.34,-1844.83 769,-1832.17 698.17,-1780.45 624.1,-1710.44 580.02,-1666.81"/>
<polygon fill="black" stroke="black" points="582.23,-1664.08 572.67,-1659.51 577.3,-1669.05 582.23,-1664.08"/>
</g>
<!-- l2_exp4_gpu8 -->
<g id="node251" class="node">
<title>l2_exp4_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="819,-1659.17 645,-1659.17 645,-1591.17 819,-1591.17 819,-1659.17"/>
<text text-anchor="middle" x="732" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="732" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="732" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="732" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_residual_tp0&#45;&gt;l2_exp4_gpu8 -->
<g id="edge539" class="edge">
<title>l2_residual_tp0&#45;&gt;l2_exp4_gpu8</title>
<path fill="none" stroke="black" d="M890.22,-1869.14C880.55,-1857.03 870.79,-1844.37 862,-1832.17 822.43,-1777.22 781.51,-1710.42 756.4,-1668.09"/>
<polygon fill="black" stroke="black" points="759.39,-1666.27 751.29,-1659.44 753.36,-1669.83 759.39,-1666.27"/>
</g>
<!-- l2_exp5_gpu8 -->
<g id="node252" class="node">
<title>l2_exp5_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="1587,-1659.17 1413,-1659.17 1413,-1591.17 1587,-1591.17 1587,-1659.17"/>
<text text-anchor="middle" x="1500" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="1500" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1500" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1500" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_residual_tp0&#45;&gt;l2_exp5_gpu8 -->
<g id="edge542" class="edge">
<title>l2_residual_tp0&#45;&gt;l2_exp5_gpu8</title>
<path fill="none" stroke="black" d="M1201.38,-1908.17C1253.94,-1892.49 1305.54,-1868.54 1346,-1832.17 1400.48,-1783.19 1448.38,-1712.38 1475.76,-1667.84"/>
<polygon fill="black" stroke="black" points="1478.75,-1669.66 1480.96,-1659.29 1472.77,-1666.02 1478.75,-1669.66"/>
</g>
<!-- l2_exp6_gpu8 -->
<g id="node253" class="node">
<title>l2_exp6_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="1779,-1659.17 1605,-1659.17 1605,-1591.17 1779,-1591.17 1779,-1659.17"/>
<text text-anchor="middle" x="1692" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1692" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1692" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1692" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_residual_tp0&#45;&gt;l2_exp6_gpu8 -->
<g id="edge545" class="edge">
<title>l2_residual_tp0&#45;&gt;l2_exp6_gpu8</title>
<path fill="none" stroke="black" d="M1192.63,-1900.23C1263.5,-1884.67 1339.58,-1862.76 1406,-1832.17 1500.3,-1788.74 1595.22,-1712.4 1648.52,-1665.84"/>
<polygon fill="black" stroke="black" points="1650.88,-1668.43 1656.08,-1659.2 1646.26,-1663.17 1650.88,-1668.43"/>
</g>
<!-- l2_exp7_gpu8 -->
<g id="node254" class="node">
<title>l2_exp7_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="1395,-1659.17 1221,-1659.17 1221,-1591.17 1395,-1591.17 1395,-1659.17"/>
<text text-anchor="middle" x="1308" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="1308" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1308" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1308" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_residual_tp0&#45;&gt;l2_exp7_gpu8 -->
<g id="edge548" class="edge">
<title>l2_residual_tp0&#45;&gt;l2_exp7_gpu8</title>
<path fill="none" stroke="black" d="M1187.8,-1895.68C1253.37,-1879.5 1311.93,-1858.38 1332,-1832.17 1367.97,-1785.19 1347.88,-1713.65 1328.87,-1668.44"/>
<polygon fill="black" stroke="black" points="1332.05,-1666.98 1324.85,-1659.2 1325.64,-1669.77 1332.05,-1666.98"/>
</g>
<!-- l2_final_res_tp0 -->
<g id="node256" class="node">
<title>l2_final_res_tp0</title>
<polygon fill="lightyellow" stroke="black" points="1478.93,-1381.17 907.95,-1381.17 761.07,-1245.17 1332.05,-1245.17 1478.93,-1381.17"/>
<text text-anchor="middle" x="1120" y="-1331.97" font-family="Times,serif" font-size="14.00">Layer 2 Final Residual</text>
<text text-anchor="middle" x="1120" y="-1316.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="1120" y="-1301.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="1120" y="-1286.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_residual_tp0&#45;&gt;l2_final_res_tp0 -->
<g id="edge551" class="edge">
<title>l2_residual_tp0&#45;&gt;l2_final_res_tp0</title>
<path fill="none" stroke="black" d="M1227.42,-1932.43C1475.37,-1921.27 1798,-1883.93 1798,-1765.17 1798,-1765.17 1798,-1765.17 1798,-1485.17 1798,-1404.93 1617.24,-1361.97 1442.38,-1339.17"/>
<polygon fill="black" stroke="black" points="1442.57,-1335.67 1432.21,-1337.87 1441.68,-1342.61 1442.57,-1335.67"/>
</g>
<!-- l2_gate_tp0&#45;&gt;l2_exp0_gpu8 -->
<g id="edge526" class="edge">
<title>l2_gate_tp0&#45;&gt;l2_exp0_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1116,-1695.87C1116,-1686.93 1116,-1677.95 1116,-1669.56"/>
<polygon fill="black" stroke="black" points="1119.5,-1669.29 1116,-1659.29 1112.5,-1669.29 1119.5,-1669.29"/>
</g>
<!-- l2_gate_tp0&#45;&gt;l2_exp1_gpu8 -->
<g id="edge529" class="edge">
<title>l2_gate_tp0&#45;&gt;l2_exp1_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1021.97,-1696.07C1007.18,-1685.52 992.32,-1674.92 978.81,-1665.28"/>
<polygon fill="black" stroke="black" points="980.76,-1662.36 970.58,-1659.41 976.69,-1668.06 980.76,-1662.36"/>
</g>
<!-- l2_gate_tp0&#45;&gt;l2_exp2_gpu8 -->
<g id="edge532" class="edge">
<title>l2_gate_tp0&#45;&gt;l2_exp2_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M938.86,-1744.46C804.9,-1728.27 616.74,-1701.13 444.91,-1659.26"/>
<polygon fill="black" stroke="black" points="445.73,-1655.86 435.18,-1656.87 444.06,-1662.65 445.73,-1655.86"/>
</g>
<!-- l2_gate_tp0&#45;&gt;l2_exp3_gpu8 -->
<g id="edge535" class="edge">
<title>l2_gate_tp0&#45;&gt;l2_exp3_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M924.9,-1722.3C809.39,-1697.52 677.98,-1669.15 636.95,-1659.14"/>
<polygon fill="black" stroke="black" points="637.8,-1655.74 627.24,-1656.64 636.06,-1662.52 637.8,-1655.74"/>
</g>
<!-- l2_gate_tp0&#45;&gt;l2_exp4_gpu8 -->
<g id="edge538" class="edge">
<title>l2_gate_tp0&#45;&gt;l2_exp4_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M927.94,-1696.07C893.64,-1683.84 859.18,-1671.54 828.93,-1660.75"/>
<polygon fill="black" stroke="black" points="829.86,-1657.36 819.26,-1657.3 827.51,-1663.96 829.86,-1657.36"/>
</g>
<!-- l2_gate_tp0&#45;&gt;l2_exp5_gpu8 -->
<g id="edge541" class="edge">
<title>l2_gate_tp0&#45;&gt;l2_exp5_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1250.57,-1715.15C1300.83,-1697.22 1356.87,-1677.23 1403.08,-1660.74"/>
<polygon fill="black" stroke="black" points="1404.54,-1663.94 1412.79,-1657.28 1402.19,-1657.35 1404.54,-1663.94"/>
</g>
<!-- l2_gate_tp0&#45;&gt;l2_exp6_gpu8 -->
<g id="edge544" class="edge">
<title>l2_gate_tp0&#45;&gt;l2_exp6_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1263.36,-1735.91C1356.28,-1717.61 1478.73,-1691.45 1594.97,-1659.36"/>
<polygon fill="black" stroke="black" points="1596.06,-1662.69 1604.76,-1656.64 1594.19,-1655.95 1596.06,-1662.69"/>
</g>
<!-- l2_gate_tp0&#45;&gt;l2_exp7_gpu8 -->
<g id="edge547" class="edge">
<title>l2_gate_tp0&#45;&gt;l2_exp7_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1210.03,-1696.07C1224.82,-1685.52 1239.68,-1674.92 1253.19,-1665.28"/>
<polygon fill="black" stroke="black" points="1255.31,-1668.06 1261.42,-1659.41 1251.24,-1662.36 1255.31,-1668.06"/>
</g>
<!-- l2_exp_agg_tp0 -->
<g id="node255" class="node">
<title>l2_exp_agg_tp0</title>
<polygon fill="lightyellow" stroke="black" points="1335.58,-1554.17 986.28,-1554.17 896.42,-1418.17 1245.72,-1418.17 1335.58,-1554.17"/>
<text text-anchor="middle" x="1116" y="-1504.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1116" y="-1489.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="1116" y="-1474.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="1116" y="-1459.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_exp0_gpu8&#45;&gt;l2_exp_agg_tp0 -->
<g id="edge528" class="edge">
<title>l2_exp0_gpu8&#45;&gt;l2_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M1116,-1591C1116,-1582.86 1116,-1573.8 1116,-1564.52"/>
<polygon fill="black" stroke="black" points="1119.5,-1564.4 1116,-1554.4 1112.5,-1564.4 1119.5,-1564.4"/>
</g>
<!-- l2_exp1_gpu8&#45;&gt;l2_exp_agg_tp0 -->
<g id="edge531" class="edge">
<title>l2_exp1_gpu8&#45;&gt;l2_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M970.48,-1591C983.59,-1581.65 998.39,-1571.08 1013.42,-1560.36"/>
<polygon fill="black" stroke="black" points="1015.67,-1563.06 1021.78,-1554.4 1011.6,-1557.36 1015.67,-1563.06"/>
</g>
<!-- l2_exp2_gpu8&#45;&gt;l2_exp_agg_tp0 -->
<g id="edge534" class="edge">
<title>l2_exp2_gpu8&#45;&gt;l2_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M435.18,-1593.46C438.15,-1592.65 441.09,-1591.89 444,-1591.17 611.29,-1549.82 806.29,-1521.81 943.01,-1505.37"/>
<polygon fill="black" stroke="black" points="943.65,-1508.82 953.16,-1504.16 942.82,-1501.87 943.65,-1508.82"/>
</g>
<!-- l2_exp3_gpu8&#45;&gt;l2_exp_agg_tp0 -->
<g id="edge537" class="edge">
<title>l2_exp3_gpu8&#45;&gt;l2_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M627.24,-1593.69C630.19,-1592.82 633.11,-1591.97 636,-1591.17 739.61,-1562.24 857.66,-1536.57 950.77,-1517.97"/>
<polygon fill="black" stroke="black" points="951.72,-1521.35 960.85,-1515.96 950.35,-1514.48 951.72,-1521.35"/>
</g>
<!-- l2_exp4_gpu8&#45;&gt;l2_exp_agg_tp0 -->
<g id="edge540" class="edge">
<title>l2_exp4_gpu8&#45;&gt;l2_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M819.14,-1593.08C862.38,-1577.65 915.85,-1558.57 965.45,-1540.88"/>
<polygon fill="black" stroke="black" points="966.75,-1544.13 974.99,-1537.48 964.39,-1537.54 966.75,-1544.13"/>
</g>
<!-- l2_exp5_gpu8&#45;&gt;l2_exp_agg_tp0 -->
<g id="edge543" class="edge">
<title>l2_exp5_gpu8&#45;&gt;l2_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M1412.86,-1593.08C1383.13,-1582.47 1348.56,-1570.14 1313.73,-1557.71"/>
<polygon fill="black" stroke="black" points="1314.5,-1554.27 1303.91,-1554.21 1312.15,-1560.86 1314.5,-1554.27"/>
</g>
<!-- l2_exp6_gpu8&#45;&gt;l2_exp_agg_tp0 -->
<g id="edge546" class="edge">
<title>l2_exp6_gpu8&#45;&gt;l2_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M1604.76,-1593.69C1601.81,-1592.82 1598.89,-1591.97 1596,-1591.17 1508.51,-1566.74 1410.71,-1544.64 1326.34,-1527.15"/>
<polygon fill="black" stroke="black" points="1326.88,-1523.69 1316.38,-1525.09 1325.47,-1530.54 1326.88,-1523.69"/>
</g>
<!-- l2_exp7_gpu8&#45;&gt;l2_exp_agg_tp0 -->
<g id="edge549" class="edge">
<title>l2_exp7_gpu8&#45;&gt;l2_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M1261.52,-1591C1248.41,-1581.65 1233.61,-1571.08 1218.58,-1560.36"/>
<polygon fill="black" stroke="black" points="1220.4,-1557.36 1210.22,-1554.4 1216.33,-1563.06 1220.4,-1557.36"/>
</g>
<!-- l2_exp_agg_tp0&#45;&gt;l2_final_res_tp0 -->
<g id="edge550" class="edge">
<title>l2_exp_agg_tp0&#45;&gt;l2_final_res_tp0</title>
<path fill="none" stroke="black" d="M1117.57,-1418.07C1117.77,-1409.4 1117.98,-1400.46 1118.19,-1391.63"/>
<polygon fill="black" stroke="black" points="1121.69,-1391.43 1118.43,-1381.35 1114.7,-1391.26 1121.69,-1391.43"/>
</g>
<!-- l3_qkv_tp0 -->
<g id="node362" class="node">
<title>l3_qkv_tp0</title>
<polygon fill="lightgreen" stroke="black" points="1164,-1208.17 938,-1208.17 938,-1140.17 1164,-1140.17 1164,-1208.17"/>
<text text-anchor="middle" x="1051" y="-1192.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1051" y="-1177.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="1051" y="-1162.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="1051" y="-1147.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_final_res_tp0&#45;&gt;l3_qkv_tp0 -->
<g id="edge769" class="edge">
<title>l2_final_res_tp0&#45;&gt;l3_qkv_tp0</title>
<path fill="none" stroke="black" d="M1086.11,-1244.87C1081.4,-1235.53 1076.68,-1226.16 1072.3,-1217.45"/>
<polygon fill="black" stroke="black" points="1075.31,-1215.65 1067.69,-1208.29 1069.06,-1218.8 1075.31,-1215.65"/>
</g>
<!-- l3_residual_tp0 -->
<g id="node365" class="node">
<title>l3_residual_tp0</title>
<polygon fill="lightyellow" stroke="black" points="1439.93,-893.17 868.95,-893.17 722.07,-757.17 1293.05,-757.17 1439.93,-893.17"/>
<text text-anchor="middle" x="1081" y="-843.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1081" y="-828.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="1081" y="-813.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="1081" y="-798.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_final_res_tp0&#45;&gt;l3_residual_tp0 -->
<g id="edge773" class="edge">
<title>l2_final_res_tp0&#45;&gt;l3_residual_tp0</title>
<path fill="none" stroke="black" d="M1164.61,-1244.83C1174.95,-1223.45 1183,-1199.12 1183,-1175.17 1183,-1175.17 1183,-1175.17 1183,-963.17 1183,-941.05 1174.34,-920.2 1162.07,-901.74"/>
<polygon fill="black" stroke="black" points="1164.83,-899.58 1156.2,-893.43 1159.12,-903.62 1164.83,-899.58"/>
</g>
<!-- l2_attn_tp1 -->
<g id="node258" class="node">
<title>l2_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="2828,-2215.17 2614,-2215.17 2614,-2147.17 2828,-2147.17 2828,-2215.17"/>
<text text-anchor="middle" x="2721" y="-2199.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2721" y="-2184.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="2721" y="-2169.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="2721" y="-2154.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_qkv_tp1&#45;&gt;l2_attn_tp1 -->
<g id="edge552" class="edge">
<title>l2_qkv_tp1&#45;&gt;l2_attn_tp1</title>
<path fill="none" stroke="black" d="M2784.74,-2252.01C2776.27,-2242.73 2766.97,-2232.53 2758.15,-2222.87"/>
<polygon fill="black" stroke="black" points="2760.53,-2220.29 2751.2,-2215.26 2755.36,-2225.01 2760.53,-2220.29"/>
</g>
<!-- l2_residual_tp1 -->
<g id="node260" class="node">
<title>l2_residual_tp1</title>
<polygon fill="lightyellow" stroke="black" points="3143.93,-2005.17 2572.95,-2005.17 2426.07,-1869.17 2997.05,-1869.17 3143.93,-2005.17"/>
<text text-anchor="middle" x="2785" y="-1955.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2785" y="-1940.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="2785" y="-1925.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="2785" y="-1910.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_qkv_tp1&#45;&gt;l2_residual_tp1 -->
<g id="edge555" class="edge">
<title>l2_qkv_tp1&#45;&gt;l2_residual_tp1</title>
<path fill="none" stroke="black" d="M2827.75,-2251.83C2831.51,-2240.39 2835.13,-2227.38 2837,-2215.17 2848.66,-2139.17 2854.67,-2117 2837,-2042.17 2834.83,-2032.98 2831.72,-2023.68 2828.08,-2014.61"/>
<polygon fill="black" stroke="black" points="2831.25,-2013.11 2824.12,-2005.27 2824.8,-2015.84 2831.25,-2013.11"/>
</g>
<!-- l2_out_proj_tp1 -->
<g id="node259" class="node">
<title>l2_out_proj_tp1</title>
<polygon fill="lightgreen" stroke="black" points="2828,-2110.17 2616,-2110.17 2616,-2042.17 2828,-2042.17 2828,-2110.17"/>
<text text-anchor="middle" x="2722" y="-2094.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2722" y="-2079.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="2722" y="-2064.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="2722" y="-2049.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_attn_tp1&#45;&gt;l2_out_proj_tp1 -->
<g id="edge553" class="edge">
<title>l2_attn_tp1&#45;&gt;l2_out_proj_tp1</title>
<path fill="none" stroke="black" d="M2721.32,-2147.01C2721.4,-2138.56 2721.49,-2129.34 2721.58,-2120.47"/>
<polygon fill="black" stroke="black" points="2725.08,-2120.29 2721.68,-2110.26 2718.08,-2120.23 2725.08,-2120.29"/>
</g>
<!-- l2_out_proj_tp1&#45;&gt;l2_residual_tp1 -->
<g id="edge554" class="edge">
<title>l2_out_proj_tp1&#45;&gt;l2_residual_tp1</title>
<path fill="none" stroke="black" d="M2737.25,-2042C2741.11,-2033.6 2745.43,-2024.22 2749.84,-2014.63"/>
<polygon fill="black" stroke="black" points="2753.08,-2015.95 2754.08,-2005.4 2746.72,-2013.02 2753.08,-2015.95"/>
</g>
<!-- l2_gate_tp1 -->
<g id="node261" class="node">
<title>l2_gate_tp1</title>
<polygon fill="lightyellow" stroke="black" points="2825.2,-1832.17 2495.59,-1832.17 2410.8,-1696.17 2740.41,-1696.17 2825.2,-1832.17"/>
<text text-anchor="middle" x="2618" y="-1782.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="2618" y="-1767.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="2618" y="-1752.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="2618" y="-1737.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_residual_tp1&#45;&gt;l2_gate_tp1 -->
<g id="edge556" class="edge">
<title>l2_residual_tp1&#45;&gt;l2_gate_tp1</title>
<path fill="none" stroke="black" d="M2719.48,-1869.07C2710.08,-1859.46 2700.37,-1849.51 2690.85,-1839.76"/>
<polygon fill="black" stroke="black" points="2693.1,-1837.06 2683.61,-1832.35 2688.09,-1841.95 2693.1,-1837.06"/>
</g>
<!-- l2_exp0_gpu9 -->
<g id="node262" class="node">
<title>l2_exp0_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2567,-1659.17 2393,-1659.17 2393,-1591.17 2567,-1591.17 2567,-1659.17"/>
<text text-anchor="middle" x="2480" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="2480" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2480" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2480" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_residual_tp1&#45;&gt;l2_exp0_gpu9 -->
<g id="edge558" class="edge">
<title>l2_residual_tp1&#45;&gt;l2_exp0_gpu9</title>
<path fill="none" stroke="black" d="M2460.45,-1869.1C2433.45,-1858.16 2412.46,-1845.85 2402,-1832.17 2365.28,-1784.15 2377.37,-1751.37 2402,-1696.17 2406.92,-1685.13 2414.54,-1675.11 2423.12,-1666.32"/>
<polygon fill="black" stroke="black" points="2425.72,-1668.68 2430.52,-1659.23 2420.88,-1663.63 2425.72,-1668.68"/>
</g>
<!-- l2_exp1_gpu9 -->
<g id="node263" class="node">
<title>l2_exp1_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="3143,-1659.17 2969,-1659.17 2969,-1591.17 3143,-1591.17 3143,-1659.17"/>
<text text-anchor="middle" x="3056" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3056" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3056" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3056" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_residual_tp1&#45;&gt;l2_exp1_gpu9 -->
<g id="edge561" class="edge">
<title>l2_residual_tp1&#45;&gt;l2_exp1_gpu9</title>
<path fill="none" stroke="black" d="M2843.8,-1868.9C2897.55,-1807.42 2975.31,-1718.47 3020.25,-1667.06"/>
<polygon fill="black" stroke="black" points="3022.96,-1669.28 3026.9,-1659.45 3017.69,-1664.68 3022.96,-1669.28"/>
</g>
<!-- l2_exp2_gpu9 -->
<g id="node264" class="node">
<title>l2_exp2_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2375,-1659.17 2201,-1659.17 2201,-1591.17 2375,-1591.17 2375,-1659.17"/>
<text text-anchor="middle" x="2288" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2288" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2288" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2288" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_residual_tp1&#45;&gt;l2_exp2_gpu9 -->
<g id="edge564" class="edge">
<title>l2_residual_tp1&#45;&gt;l2_exp2_gpu9</title>
<path fill="none" stroke="black" d="M2443.81,-1869.03C2412.56,-1857.98 2387.56,-1845.67 2374,-1832.17 2328.95,-1787.28 2306.32,-1715.3 2295.87,-1669.4"/>
<polygon fill="black" stroke="black" points="2299.26,-1668.49 2293.71,-1659.46 2292.42,-1669.98 2299.26,-1668.49"/>
</g>
<!-- l2_exp3_gpu9 -->
<g id="node265" class="node">
<title>l2_exp3_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2183,-1659.17 2009,-1659.17 2009,-1591.17 2183,-1591.17 2183,-1659.17"/>
<text text-anchor="middle" x="2096" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2096" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2096" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2096" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_residual_tp1&#45;&gt;l2_exp3_gpu9 -->
<g id="edge567" class="edge">
<title>l2_residual_tp1&#45;&gt;l2_exp3_gpu9</title>
<path fill="none" stroke="black" d="M2450.46,-1891.92C2397.54,-1877.34 2344.87,-1857.94 2298,-1832.17 2224.09,-1791.52 2160.02,-1715.22 2124.81,-1667.75"/>
<polygon fill="black" stroke="black" points="2127.52,-1665.53 2118.79,-1659.53 2121.88,-1669.66 2127.52,-1665.53"/>
</g>
<!-- l2_exp4_gpu9 -->
<g id="node266" class="node">
<title>l2_exp4_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="1991,-1659.17 1817,-1659.17 1817,-1591.17 1991,-1591.17 1991,-1659.17"/>
<text text-anchor="middle" x="1904" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1904" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1904" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1904" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_residual_tp1&#45;&gt;l2_exp4_gpu9 -->
<g id="edge570" class="edge">
<title>l2_residual_tp1&#45;&gt;l2_exp4_gpu9</title>
<path fill="none" stroke="black" d="M2482.5,-1921.55C2371.73,-1907.45 2247.91,-1881.04 2143,-1832.17 2058.57,-1792.83 1980.86,-1714.87 1938.19,-1666.95"/>
<polygon fill="black" stroke="black" points="1940.63,-1664.42 1931.39,-1659.23 1935.38,-1669.05 1940.63,-1664.42"/>
</g>
<!-- l2_exp5_gpu9 -->
<g id="node267" class="node">
<title>l2_exp5_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="3335,-1659.17 3161,-1659.17 3161,-1591.17 3335,-1591.17 3335,-1659.17"/>
<text text-anchor="middle" x="3248" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3248" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3248" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3248" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_residual_tp1&#45;&gt;l2_exp5_gpu9 -->
<g id="edge573" class="edge">
<title>l2_residual_tp1&#45;&gt;l2_exp5_gpu9</title>
<path fill="none" stroke="black" d="M2885.18,-1869.09C2978.25,-1806.78 3113.63,-1716.14 3189.97,-1665.02"/>
<polygon fill="black" stroke="black" points="3192.17,-1667.76 3198.53,-1659.29 3188.28,-1661.94 3192.17,-1667.76"/>
</g>
<!-- l2_exp6_gpu9 -->
<g id="node268" class="node">
<title>l2_exp6_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2951,-1659.17 2777,-1659.17 2777,-1591.17 2951,-1591.17 2951,-1659.17"/>
<text text-anchor="middle" x="2864" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2864" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2864" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2864" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_residual_tp1&#45;&gt;l2_exp6_gpu9 -->
<g id="edge576" class="edge">
<title>l2_residual_tp1&#45;&gt;l2_exp6_gpu9</title>
<path fill="none" stroke="black" d="M2840.7,-1869.05C2843.91,-1863.22 2846.75,-1857.23 2849,-1851.17 2871.32,-1791.12 2871.24,-1715.92 2868.27,-1669.46"/>
<polygon fill="black" stroke="black" points="2871.76,-1669.16 2867.56,-1659.43 2864.78,-1669.65 2871.76,-1669.16"/>
</g>
<!-- l2_exp7_gpu9 -->
<g id="node269" class="node">
<title>l2_exp7_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2759,-1659.17 2585,-1659.17 2585,-1591.17 2759,-1591.17 2759,-1659.17"/>
<text text-anchor="middle" x="2672" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2672" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2672" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2672" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_residual_tp1&#45;&gt;l2_exp7_gpu9 -->
<g id="edge579" class="edge">
<title>l2_residual_tp1&#45;&gt;l2_exp7_gpu9</title>
<path fill="none" stroke="black" d="M2821.88,-1868.89C2826.89,-1856.97 2831.25,-1844.44 2834,-1832.17 2840.6,-1802.67 2850.6,-1721.42 2834,-1696.17 2829.52,-1689.35 2800.74,-1676.09 2768.64,-1662.93"/>
<polygon fill="black" stroke="black" points="2769.64,-1659.56 2759.06,-1659.04 2767.01,-1666.05 2769.64,-1659.56"/>
</g>
<!-- l2_final_res_tp1 -->
<g id="node271" class="node">
<title>l2_final_res_tp1</title>
<polygon fill="lightyellow" stroke="black" points="3109.93,-1381.17 2538.95,-1381.17 2392.07,-1245.17 2963.05,-1245.17 3109.93,-1381.17"/>
<text text-anchor="middle" x="2751" y="-1331.97" font-family="Times,serif" font-size="14.00">Layer 2 Final Residual</text>
<text text-anchor="middle" x="2751" y="-1316.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="2751" y="-1301.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="2751" y="-1286.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_residual_tp1&#45;&gt;l2_final_res_tp1 -->
<g id="edge582" class="edge">
<title>l2_residual_tp1&#45;&gt;l2_final_res_tp1</title>
<path fill="none" stroke="black" d="M3037.06,-1905.89C3189.25,-1880.31 3354,-1836.21 3354,-1765.17 3354,-1765.17 3354,-1765.17 3354,-1485.17 3354,-1421.08 3226.32,-1379.76 3088.47,-1353.83"/>
<polygon fill="black" stroke="black" points="3089,-1350.37 3078.53,-1351.99 3087.72,-1357.25 3089,-1350.37"/>
</g>
<!-- l2_gate_tp1&#45;&gt;l2_exp0_gpu9 -->
<g id="edge557" class="edge">
<title>l2_gate_tp1&#45;&gt;l2_exp0_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2550.21,-1695.87C2540.1,-1685.83 2529.95,-1675.76 2520.64,-1666.51"/>
<polygon fill="black" stroke="black" points="2522.93,-1663.86 2513.37,-1659.29 2518,-1668.82 2522.93,-1663.86"/>
</g>
<!-- l2_gate_tp1&#45;&gt;l2_exp1_gpu9 -->
<g id="edge560" class="edge">
<title>l2_gate_tp1&#45;&gt;l2_exp1_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2756.88,-1722.17C2816.48,-1704.27 2887.07,-1682.67 2959.2,-1659.4"/>
<polygon fill="black" stroke="black" points="2960.49,-1662.66 2968.92,-1656.25 2958.33,-1656 2960.49,-1662.66"/>
</g>
<!-- l2_gate_tp1&#45;&gt;l2_exp2_gpu9 -->
<g id="edge563" class="edge">
<title>l2_gate_tp1&#45;&gt;l2_exp2_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2456.38,-1696.07C2429.02,-1684.71 2401.52,-1673.3 2376.92,-1663.08"/>
<polygon fill="black" stroke="black" points="2378.22,-1659.83 2367.64,-1659.23 2375.53,-1666.3 2378.22,-1659.83"/>
</g>
<!-- l2_gate_tp1&#45;&gt;l2_exp3_gpu9 -->
<g id="edge566" class="edge">
<title>l2_gate_tp1&#45;&gt;l2_exp3_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2421.17,-1713.18C2372.78,-1701.14 2321.07,-1688.5 2273,-1677.17 2239.91,-1669.37 2229.16,-1669.16 2193.01,-1659.34"/>
<polygon fill="black" stroke="black" points="2193.82,-1655.93 2183.25,-1656.62 2191.94,-1662.67 2193.82,-1655.93"/>
</g>
<!-- l2_gate_tp1&#45;&gt;l2_exp4_gpu9 -->
<g id="edge569" class="edge">
<title>l2_gate_tp1&#45;&gt;l2_exp4_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2438.56,-1740.92C2317.01,-1723.96 2153,-1697.39 2001.18,-1659.34"/>
<polygon fill="black" stroke="black" points="2001.75,-1655.88 1991.19,-1656.82 2000.03,-1662.66 2001.75,-1655.88"/>
</g>
<!-- l2_gate_tp1&#45;&gt;l2_exp5_gpu9 -->
<g id="edge572" class="edge">
<title>l2_gate_tp1&#45;&gt;l2_exp5_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2767.74,-1739.73C2872.86,-1721.92 3016.6,-1694.86 3150.73,-1659.4"/>
<polygon fill="black" stroke="black" points="3152.02,-1662.68 3160.78,-1656.72 3150.22,-1655.91 3152.02,-1662.68"/>
</g>
<!-- l2_gate_tp1&#45;&gt;l2_exp6_gpu9 -->
<g id="edge575" class="edge">
<title>l2_gate_tp1&#45;&gt;l2_exp6_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2738.48,-1696.07C2758.07,-1685.16 2777.75,-1674.2 2795.52,-1664.3"/>
<polygon fill="black" stroke="black" points="2797.6,-1667.15 2804.63,-1659.23 2794.19,-1661.04 2797.6,-1667.15"/>
</g>
<!-- l2_gate_tp1&#45;&gt;l2_exp7_gpu9 -->
<g id="edge578" class="edge">
<title>l2_gate_tp1&#45;&gt;l2_exp7_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2644.53,-1695.87C2648.17,-1686.63 2651.82,-1677.35 2655.22,-1668.73"/>
<polygon fill="black" stroke="black" points="2658.53,-1669.88 2658.94,-1659.29 2652.02,-1667.31 2658.53,-1669.88"/>
</g>
<!-- l2_exp_agg_tp1 -->
<g id="node270" class="node">
<title>l2_exp_agg_tp1</title>
<polygon fill="lightyellow" stroke="black" points="2891.58,-1554.17 2542.28,-1554.17 2452.42,-1418.17 2801.72,-1418.17 2891.58,-1554.17"/>
<text text-anchor="middle" x="2672" y="-1504.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2672" y="-1489.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="2672" y="-1474.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="2672" y="-1459.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_exp0_gpu9&#45;&gt;l2_exp_agg_tp1 -->
<g id="edge559" class="edge">
<title>l2_exp0_gpu9&#45;&gt;l2_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2526.48,-1591C2539.59,-1581.65 2554.39,-1571.08 2569.42,-1560.36"/>
<polygon fill="black" stroke="black" points="2571.67,-1563.06 2577.78,-1554.4 2567.6,-1557.36 2571.67,-1563.06"/>
</g>
<!-- l2_exp1_gpu9&#45;&gt;l2_exp_agg_tp1 -->
<g id="edge562" class="edge">
<title>l2_exp1_gpu9&#45;&gt;l2_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2968.86,-1593.08C2939.13,-1582.47 2904.56,-1570.14 2869.73,-1557.71"/>
<polygon fill="black" stroke="black" points="2870.5,-1554.27 2859.91,-1554.21 2868.15,-1560.86 2870.5,-1554.27"/>
</g>
<!-- l2_exp2_gpu9&#45;&gt;l2_exp_agg_tp1 -->
<g id="edge565" class="edge">
<title>l2_exp2_gpu9&#45;&gt;l2_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2375.14,-1593.08C2418.38,-1577.65 2471.85,-1558.57 2521.45,-1540.88"/>
<polygon fill="black" stroke="black" points="2522.75,-1544.13 2530.99,-1537.48 2520.39,-1537.54 2522.75,-1544.13"/>
</g>
<!-- l2_exp3_gpu9&#45;&gt;l2_exp_agg_tp1 -->
<g id="edge568" class="edge">
<title>l2_exp3_gpu9&#45;&gt;l2_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2183.24,-1593.69C2186.19,-1592.82 2189.11,-1591.97 2192,-1591.17 2295.61,-1562.24 2413.66,-1536.57 2506.77,-1517.97"/>
<polygon fill="black" stroke="black" points="2507.72,-1521.35 2516.85,-1515.96 2506.35,-1514.48 2507.72,-1521.35"/>
</g>
<!-- l2_exp4_gpu9&#45;&gt;l2_exp_agg_tp1 -->
<g id="edge571" class="edge">
<title>l2_exp4_gpu9&#45;&gt;l2_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M1991.18,-1593.46C1994.15,-1592.65 1997.09,-1591.89 2000,-1591.17 2167.29,-1549.82 2362.29,-1521.81 2499.01,-1505.37"/>
<polygon fill="black" stroke="black" points="2499.65,-1508.82 2509.16,-1504.16 2498.82,-1501.87 2499.65,-1508.82"/>
</g>
<!-- l2_exp5_gpu9&#45;&gt;l2_exp_agg_tp1 -->
<g id="edge574" class="edge">
<title>l2_exp5_gpu9&#45;&gt;l2_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M3160.76,-1593.69C3157.81,-1592.82 3154.89,-1591.97 3152,-1591.17 3064.51,-1566.74 2966.71,-1544.64 2882.34,-1527.15"/>
<polygon fill="black" stroke="black" points="2882.88,-1523.69 2872.38,-1525.09 2881.47,-1530.54 2882.88,-1523.69"/>
</g>
<!-- l2_exp6_gpu9&#45;&gt;l2_exp_agg_tp1 -->
<g id="edge577" class="edge">
<title>l2_exp6_gpu9&#45;&gt;l2_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2817.52,-1591C2804.41,-1581.65 2789.61,-1571.08 2774.58,-1560.36"/>
<polygon fill="black" stroke="black" points="2776.4,-1557.36 2766.22,-1554.4 2772.33,-1563.06 2776.4,-1557.36"/>
</g>
<!-- l2_exp7_gpu9&#45;&gt;l2_exp_agg_tp1 -->
<g id="edge580" class="edge">
<title>l2_exp7_gpu9&#45;&gt;l2_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2672,-1591C2672,-1582.86 2672,-1573.8 2672,-1564.52"/>
<polygon fill="black" stroke="black" points="2675.5,-1564.4 2672,-1554.4 2668.5,-1564.4 2675.5,-1564.4"/>
</g>
<!-- l2_exp_agg_tp1&#45;&gt;l2_final_res_tp1 -->
<g id="edge581" class="edge">
<title>l2_exp_agg_tp1&#45;&gt;l2_final_res_tp1</title>
<path fill="none" stroke="black" d="M2703,-1418.07C2707.18,-1409.02 2711.49,-1399.68 2715.74,-1390.48"/>
<polygon fill="black" stroke="black" points="2718.95,-1391.89 2719.96,-1381.35 2712.59,-1388.96 2718.95,-1391.89"/>
</g>
<!-- l3_qkv_tp1 -->
<g id="node377" class="node">
<title>l3_qkv_tp1</title>
<polygon fill="lightgreen" stroke="black" points="2798,-1208.17 2572,-1208.17 2572,-1140.17 2798,-1140.17 2798,-1208.17"/>
<text text-anchor="middle" x="2685" y="-1192.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2685" y="-1177.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="2685" y="-1162.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="2685" y="-1147.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_final_res_tp1&#45;&gt;l3_qkv_tp1 -->
<g id="edge802" class="edge">
<title>l2_final_res_tp1&#45;&gt;l3_qkv_tp1</title>
<path fill="none" stroke="black" d="M2718.58,-1244.87C2714.08,-1235.53 2709.56,-1226.16 2705.37,-1217.45"/>
<polygon fill="black" stroke="black" points="2708.45,-1215.78 2700.96,-1208.29 2702.15,-1218.82 2708.45,-1215.78"/>
</g>
<!-- l3_residual_tp1 -->
<g id="node380" class="node">
<title>l3_residual_tp1</title>
<polygon fill="lightyellow" stroke="black" points="3144.93,-893.17 2573.95,-893.17 2427.07,-757.17 2998.05,-757.17 3144.93,-893.17"/>
<text text-anchor="middle" x="2786" y="-843.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2786" y="-828.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="2786" y="-813.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="2786" y="-798.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_final_res_tp1&#45;&gt;l3_residual_tp1 -->
<g id="edge806" class="edge">
<title>l2_final_res_tp1&#45;&gt;l3_residual_tp1</title>
<path fill="none" stroke="black" d="M2797.73,-1245.08C2808.57,-1223.71 2817,-1199.32 2817,-1175.17 2817,-1175.17 2817,-1175.17 2817,-963.17 2817,-943.54 2813.94,-922.72 2809.74,-903.39"/>
<polygon fill="black" stroke="black" points="2813.1,-902.39 2807.45,-893.43 2806.28,-903.96 2813.1,-902.39"/>
</g>
<!-- l2_attn_tp2 -->
<g id="node273" class="node">
<title>l2_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="4076,-2215.17 3862,-2215.17 3862,-2147.17 4076,-2147.17 4076,-2215.17"/>
<text text-anchor="middle" x="3969" y="-2199.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3969" y="-2184.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="3969" y="-2169.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="3969" y="-2154.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_qkv_tp2&#45;&gt;l2_attn_tp2 -->
<g id="edge583" class="edge">
<title>l2_qkv_tp2&#45;&gt;l2_attn_tp2</title>
<path fill="none" stroke="black" d="M4011.72,-2252.01C4006.27,-2243.1 4000.3,-2233.34 3994.6,-2224.02"/>
<polygon fill="black" stroke="black" points="3997.45,-2221.97 3989.24,-2215.26 3991.47,-2225.62 3997.45,-2221.97"/>
</g>
<!-- l2_residual_tp2 -->
<g id="node275" class="node">
<title>l2_residual_tp2</title>
<polygon fill="lightyellow" stroke="black" points="4419.93,-2005.17 3848.95,-2005.17 3702.07,-1869.17 4273.05,-1869.17 4419.93,-2005.17"/>
<text text-anchor="middle" x="4061" y="-1955.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4061" y="-1940.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="4061" y="-1925.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="4061" y="-1910.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_qkv_tp2&#45;&gt;l2_residual_tp2 -->
<g id="edge586" class="edge">
<title>l2_qkv_tp2&#45;&gt;l2_residual_tp2</title>
<path fill="none" stroke="black" d="M4063.89,-2252.16C4072.43,-2241.24 4080.54,-2228.46 4085,-2215.17 4106.82,-2150.2 4097.06,-2072.1 4084.03,-2015.41"/>
<polygon fill="black" stroke="black" points="4087.38,-2014.35 4081.65,-2005.44 4080.57,-2015.98 4087.38,-2014.35"/>
</g>
<!-- l2_out_proj_tp2 -->
<g id="node274" class="node">
<title>l2_out_proj_tp2</title>
<polygon fill="lightgreen" stroke="black" points="4075,-2110.17 3863,-2110.17 3863,-2042.17 4075,-2042.17 4075,-2110.17"/>
<text text-anchor="middle" x="3969" y="-2094.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3969" y="-2079.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="3969" y="-2064.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="3969" y="-2049.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_attn_tp2&#45;&gt;l2_out_proj_tp2 -->
<g id="edge584" class="edge">
<title>l2_attn_tp2&#45;&gt;l2_out_proj_tp2</title>
<path fill="none" stroke="black" d="M3969,-2147.01C3969,-2138.56 3969,-2129.34 3969,-2120.47"/>
<polygon fill="black" stroke="black" points="3972.5,-2120.26 3969,-2110.26 3965.5,-2120.26 3972.5,-2120.26"/>
</g>
<!-- l2_out_proj_tp2&#45;&gt;l2_residual_tp2 -->
<g id="edge585" class="edge">
<title>l2_out_proj_tp2&#45;&gt;l2_residual_tp2</title>
<path fill="none" stroke="black" d="M3991.27,-2042C3997.09,-2033.34 4003.6,-2023.64 4010.25,-2013.74"/>
<polygon fill="black" stroke="black" points="4013.18,-2015.65 4015.85,-2005.4 4007.37,-2011.75 4013.18,-2015.65"/>
</g>
<!-- l2_gate_tp2 -->
<g id="node276" class="node">
<title>l2_gate_tp2</title>
<polygon fill="lightyellow" stroke="black" points="4435.2,-1832.17 4105.59,-1832.17 4020.8,-1696.17 4350.41,-1696.17 4435.2,-1832.17"/>
<text text-anchor="middle" x="4228" y="-1782.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="4228" y="-1767.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="4228" y="-1752.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="4228" y="-1737.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_residual_tp2&#45;&gt;l2_gate_tp2 -->
<g id="edge587" class="edge">
<title>l2_residual_tp2&#45;&gt;l2_gate_tp2</title>
<path fill="none" stroke="black" d="M4126.52,-1869.07C4135.92,-1859.46 4145.63,-1849.51 4155.15,-1839.76"/>
<polygon fill="black" stroke="black" points="4157.91,-1841.95 4162.39,-1832.35 4152.9,-1837.06 4157.91,-1841.95"/>
</g>
<!-- l2_exp0_gpu10 -->
<g id="node277" class="node">
<title>l2_exp0_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="3547,-1659.17 3373,-1659.17 3373,-1591.17 3547,-1591.17 3547,-1659.17"/>
<text text-anchor="middle" x="3460" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="3460" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3460" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3460" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_residual_tp2&#45;&gt;l2_exp0_gpu10 -->
<g id="edge589" class="edge">
<title>l2_residual_tp2&#45;&gt;l2_exp0_gpu10</title>
<path fill="none" stroke="black" d="M3801.56,-1869.12C3772.72,-1858.28 3744.3,-1846 3718,-1832.17 3632.76,-1787.35 3548.28,-1712.63 3500.28,-1666.56"/>
<polygon fill="black" stroke="black" points="3502.51,-1663.85 3492.89,-1659.42 3497.65,-1668.89 3502.51,-1663.85"/>
</g>
<!-- l2_exp1_gpu10 -->
<g id="node278" class="node">
<title>l2_exp1_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="4123,-1659.17 3949,-1659.17 3949,-1591.17 4123,-1591.17 4123,-1659.17"/>
<text text-anchor="middle" x="4036" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4036" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4036" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4036" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_residual_tp2&#45;&gt;l2_exp1_gpu10 -->
<g id="edge592" class="edge">
<title>l2_residual_tp2&#45;&gt;l2_exp1_gpu10</title>
<path fill="none" stroke="black" d="M4004.71,-1868.96C4001.66,-1863.17 3999.02,-1857.21 3997,-1851.17 3972.48,-1777.82 3972.2,-1750.42 3997,-1677.17 3998.05,-1674.05 3999.38,-1670.98 4000.91,-1667.98"/>
<polygon fill="black" stroke="black" points="4004,-1669.63 4006.01,-1659.22 3997.95,-1666.1 4004,-1669.63"/>
</g>
<!-- l2_exp2_gpu10 -->
<g id="node279" class="node">
<title>l2_exp2_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="4315,-1659.17 4141,-1659.17 4141,-1591.17 4315,-1591.17 4315,-1659.17"/>
<text text-anchor="middle" x="4228" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4228" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4228" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4228" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_residual_tp2&#45;&gt;l2_exp2_gpu10 -->
<g id="edge595" class="edge">
<title>l2_residual_tp2&#45;&gt;l2_exp2_gpu10</title>
<path fill="none" stroke="black" d="M4021.21,-1868.98C3996.25,-1817.16 3975.13,-1746.12 4012,-1696.17 4043.33,-1653.72 4075.24,-1673.92 4131,-1659.17"/>
<polygon fill="black" stroke="black" points="4132.32,-1662.43 4140.92,-1656.24 4130.34,-1655.71 4132.32,-1662.43"/>
</g>
<!-- l2_exp3_gpu10 -->
<g id="node280" class="node">
<title>l2_exp3_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="3739,-1659.17 3565,-1659.17 3565,-1591.17 3739,-1591.17 3739,-1659.17"/>
<text text-anchor="middle" x="3652" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3652" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3652" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3652" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_residual_tp2&#45;&gt;l2_exp3_gpu10 -->
<g id="edge598" class="edge">
<title>l2_residual_tp2&#45;&gt;l2_exp3_gpu10</title>
<path fill="none" stroke="black" d="M3936.84,-1869.01C3917.72,-1857.37 3898.52,-1844.89 3881,-1832.17 3809.84,-1780.47 3735.58,-1710.16 3691.59,-1666.5"/>
<polygon fill="black" stroke="black" points="3693.82,-1663.78 3684.26,-1659.2 3688.87,-1668.74 3693.82,-1663.78"/>
</g>
<!-- l2_exp4_gpu10 -->
<g id="node281" class="node">
<title>l2_exp4_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="3931,-1659.17 3757,-1659.17 3757,-1591.17 3931,-1591.17 3931,-1659.17"/>
<text text-anchor="middle" x="3844" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3844" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3844" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3844" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_residual_tp2&#45;&gt;l2_exp4_gpu10 -->
<g id="edge601" class="edge">
<title>l2_residual_tp2&#45;&gt;l2_exp4_gpu10</title>
<path fill="none" stroke="black" d="M4002.57,-1868.96C3992.75,-1856.93 3982.87,-1844.34 3974,-1832.17 3934.12,-1777.45 3893.27,-1710.59 3868.27,-1668.19"/>
<polygon fill="black" stroke="black" points="3871.26,-1666.37 3863.18,-1659.52 3865.23,-1669.92 3871.26,-1666.37"/>
</g>
<!-- l2_exp5_gpu10 -->
<g id="node282" class="node">
<title>l2_exp5_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="4507,-1659.17 4333,-1659.17 4333,-1591.17 4507,-1591.17 4507,-1659.17"/>
<text text-anchor="middle" x="4420" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4420" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4420" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4420" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_residual_tp2&#45;&gt;l2_exp5_gpu10 -->
<g id="edge604" class="edge">
<title>l2_residual_tp2&#45;&gt;l2_exp5_gpu10</title>
<path fill="none" stroke="black" d="M4301.58,-1895.29C4366.4,-1879.13 4424.15,-1858.13 4444,-1832.17 4479.94,-1785.17 4459.85,-1713.64 4440.86,-1668.43"/>
<polygon fill="black" stroke="black" points="4444.04,-1666.97 4436.84,-1659.2 4437.62,-1669.76 4444.04,-1666.97"/>
</g>
<!-- l2_exp6_gpu10 -->
<g id="node283" class="node">
<title>l2_exp6_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="4891,-1659.17 4717,-1659.17 4717,-1591.17 4891,-1591.17 4891,-1659.17"/>
<text text-anchor="middle" x="4804" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="4804" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4804" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4804" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_residual_tp2&#45;&gt;l2_exp6_gpu10 -->
<g id="edge607" class="edge">
<title>l2_residual_tp2&#45;&gt;l2_exp6_gpu10</title>
<path fill="none" stroke="black" d="M4306.43,-1899.87C4376.73,-1884.32 4452.13,-1862.5 4518,-1832.17 4612.3,-1788.74 4707.22,-1712.4 4760.52,-1665.84"/>
<polygon fill="black" stroke="black" points="4762.88,-1668.43 4768.08,-1659.2 4758.26,-1663.17 4762.88,-1668.43"/>
</g>
<!-- l2_exp7_gpu10 -->
<g id="node284" class="node">
<title>l2_exp7_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="4699,-1659.17 4525,-1659.17 4525,-1591.17 4699,-1591.17 4699,-1659.17"/>
<text text-anchor="middle" x="4612" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="4612" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4612" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4612" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_residual_tp2&#45;&gt;l2_exp7_gpu10 -->
<g id="edge610" class="edge">
<title>l2_residual_tp2&#45;&gt;l2_exp7_gpu10</title>
<path fill="none" stroke="black" d="M4314.86,-1907.69C4366.89,-1892.01 4417.93,-1868.19 4458,-1832.17 4512.48,-1783.19 4560.38,-1712.38 4587.76,-1667.84"/>
<polygon fill="black" stroke="black" points="4590.75,-1669.66 4592.96,-1659.29 4584.77,-1666.02 4590.75,-1669.66"/>
</g>
<!-- l2_final_res_tp2 -->
<g id="node286" class="node">
<title>l2_final_res_tp2</title>
<polygon fill="lightyellow" stroke="black" points="4590.93,-1381.17 4019.95,-1381.17 3873.07,-1245.17 4444.05,-1245.17 4590.93,-1381.17"/>
<text text-anchor="middle" x="4232" y="-1331.97" font-family="Times,serif" font-size="14.00">Layer 2 Final Residual</text>
<text text-anchor="middle" x="4232" y="-1316.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="4232" y="-1301.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="4232" y="-1286.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_residual_tp2&#45;&gt;l2_final_res_tp2 -->
<g id="edge613" class="edge">
<title>l2_residual_tp2&#45;&gt;l2_final_res_tp2</title>
<path fill="none" stroke="black" d="M4341.35,-1932.29C4588.64,-1921.01 4910,-1883.57 4910,-1765.17 4910,-1765.17 4910,-1765.17 4910,-1485.17 4910,-1404.93 4729.24,-1361.97 4554.38,-1339.17"/>
<polygon fill="black" stroke="black" points="4554.57,-1335.67 4544.21,-1337.87 4553.68,-1342.61 4554.57,-1335.67"/>
</g>
<!-- l2_gate_tp2&#45;&gt;l2_exp0_gpu10 -->
<g id="edge588" class="edge">
<title>l2_gate_tp2&#45;&gt;l2_exp0_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4050.86,-1744.46C3916.9,-1728.27 3728.74,-1701.13 3556.91,-1659.26"/>
<polygon fill="black" stroke="black" points="3557.73,-1655.86 3547.18,-1656.87 3556.06,-1662.65 3557.73,-1655.86"/>
</g>
<!-- l2_gate_tp2&#45;&gt;l2_exp1_gpu10 -->
<g id="edge591" class="edge">
<title>l2_gate_tp2&#45;&gt;l2_exp1_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4133.97,-1696.07C4119.18,-1685.52 4104.32,-1674.92 4090.81,-1665.28"/>
<polygon fill="black" stroke="black" points="4092.76,-1662.36 4082.58,-1659.41 4088.69,-1668.06 4092.76,-1662.36"/>
</g>
<!-- l2_gate_tp2&#45;&gt;l2_exp2_gpu10 -->
<g id="edge594" class="edge">
<title>l2_gate_tp2&#45;&gt;l2_exp2_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4228,-1695.87C4228,-1686.93 4228,-1677.95 4228,-1669.56"/>
<polygon fill="black" stroke="black" points="4231.5,-1669.29 4228,-1659.29 4224.5,-1669.29 4231.5,-1669.29"/>
</g>
<!-- l2_gate_tp2&#45;&gt;l2_exp3_gpu10 -->
<g id="edge597" class="edge">
<title>l2_gate_tp2&#45;&gt;l2_exp3_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4040.4,-1727.85C3954,-1710.28 3850.19,-1687.31 3749.02,-1659.36"/>
<polygon fill="black" stroke="black" points="3749.81,-1655.95 3739.24,-1656.64 3747.94,-1662.69 3749.81,-1655.95"/>
</g>
<!-- l2_gate_tp2&#45;&gt;l2_exp4_gpu10 -->
<g id="edge600" class="edge">
<title>l2_gate_tp2&#45;&gt;l2_exp4_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4039.94,-1696.07C4005.64,-1683.84 3971.18,-1671.54 3940.93,-1660.75"/>
<polygon fill="black" stroke="black" points="3941.86,-1657.36 3931.26,-1657.3 3939.51,-1663.96 3941.86,-1657.36"/>
</g>
<!-- l2_gate_tp2&#45;&gt;l2_exp5_gpu10 -->
<g id="edge603" class="edge">
<title>l2_gate_tp2&#45;&gt;l2_exp5_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4322.03,-1696.07C4336.82,-1685.52 4351.68,-1674.92 4365.19,-1665.28"/>
<polygon fill="black" stroke="black" points="4367.31,-1668.06 4373.42,-1659.41 4363.24,-1662.36 4367.31,-1668.06"/>
</g>
<!-- l2_gate_tp2&#45;&gt;l2_exp6_gpu10 -->
<g id="edge606" class="edge">
<title>l2_gate_tp2&#45;&gt;l2_exp6_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4375.36,-1735.91C4468.28,-1717.61 4590.73,-1691.45 4706.97,-1659.36"/>
<polygon fill="black" stroke="black" points="4708.06,-1662.69 4716.76,-1656.64 4706.19,-1655.95 4708.06,-1662.69"/>
</g>
<!-- l2_gate_tp2&#45;&gt;l2_exp7_gpu10 -->
<g id="edge609" class="edge">
<title>l2_gate_tp2&#45;&gt;l2_exp7_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4362.57,-1715.15C4412.83,-1697.22 4468.87,-1677.23 4515.08,-1660.74"/>
<polygon fill="black" stroke="black" points="4516.54,-1663.94 4524.79,-1657.28 4514.19,-1657.35 4516.54,-1663.94"/>
</g>
<!-- l2_exp_agg_tp2 -->
<g id="node285" class="node">
<title>l2_exp_agg_tp2</title>
<polygon fill="lightyellow" stroke="black" points="4447.58,-1554.17 4098.28,-1554.17 4008.42,-1418.17 4357.72,-1418.17 4447.58,-1554.17"/>
<text text-anchor="middle" x="4228" y="-1504.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4228" y="-1489.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="4228" y="-1474.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="4228" y="-1459.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_exp0_gpu10&#45;&gt;l2_exp_agg_tp2 -->
<g id="edge590" class="edge">
<title>l2_exp0_gpu10&#45;&gt;l2_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M3547.18,-1593.46C3550.15,-1592.65 3553.09,-1591.89 3556,-1591.17 3723.29,-1549.82 3918.29,-1521.81 4055.01,-1505.37"/>
<polygon fill="black" stroke="black" points="4055.65,-1508.82 4065.16,-1504.16 4054.82,-1501.87 4055.65,-1508.82"/>
</g>
<!-- l2_exp1_gpu10&#45;&gt;l2_exp_agg_tp2 -->
<g id="edge593" class="edge">
<title>l2_exp1_gpu10&#45;&gt;l2_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M4082.48,-1591C4095.59,-1581.65 4110.39,-1571.08 4125.42,-1560.36"/>
<polygon fill="black" stroke="black" points="4127.67,-1563.06 4133.78,-1554.4 4123.6,-1557.36 4127.67,-1563.06"/>
</g>
<!-- l2_exp2_gpu10&#45;&gt;l2_exp_agg_tp2 -->
<g id="edge596" class="edge">
<title>l2_exp2_gpu10&#45;&gt;l2_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M4228,-1591C4228,-1582.86 4228,-1573.8 4228,-1564.52"/>
<polygon fill="black" stroke="black" points="4231.5,-1564.4 4228,-1554.4 4224.5,-1564.4 4231.5,-1564.4"/>
</g>
<!-- l2_exp3_gpu10&#45;&gt;l2_exp_agg_tp2 -->
<g id="edge599" class="edge">
<title>l2_exp3_gpu10&#45;&gt;l2_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M3739.24,-1593.69C3742.19,-1592.82 3745.11,-1591.97 3748,-1591.17 3851.61,-1562.24 3969.66,-1536.57 4062.77,-1517.97"/>
<polygon fill="black" stroke="black" points="4063.72,-1521.35 4072.85,-1515.96 4062.35,-1514.48 4063.72,-1521.35"/>
</g>
<!-- l2_exp4_gpu10&#45;&gt;l2_exp_agg_tp2 -->
<g id="edge602" class="edge">
<title>l2_exp4_gpu10&#45;&gt;l2_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M3931.14,-1593.08C3974.38,-1577.65 4027.85,-1558.57 4077.45,-1540.88"/>
<polygon fill="black" stroke="black" points="4078.75,-1544.13 4086.99,-1537.48 4076.39,-1537.54 4078.75,-1544.13"/>
</g>
<!-- l2_exp5_gpu10&#45;&gt;l2_exp_agg_tp2 -->
<g id="edge605" class="edge">
<title>l2_exp5_gpu10&#45;&gt;l2_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M4373.52,-1591C4360.41,-1581.65 4345.61,-1571.08 4330.58,-1560.36"/>
<polygon fill="black" stroke="black" points="4332.4,-1557.36 4322.22,-1554.4 4328.33,-1563.06 4332.4,-1557.36"/>
</g>
<!-- l2_exp6_gpu10&#45;&gt;l2_exp_agg_tp2 -->
<g id="edge608" class="edge">
<title>l2_exp6_gpu10&#45;&gt;l2_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M4716.76,-1593.69C4713.81,-1592.82 4710.89,-1591.97 4708,-1591.17 4620.51,-1566.74 4522.71,-1544.64 4438.34,-1527.15"/>
<polygon fill="black" stroke="black" points="4438.88,-1523.69 4428.38,-1525.09 4437.47,-1530.54 4438.88,-1523.69"/>
</g>
<!-- l2_exp7_gpu10&#45;&gt;l2_exp_agg_tp2 -->
<g id="edge611" class="edge">
<title>l2_exp7_gpu10&#45;&gt;l2_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M4524.86,-1593.08C4495.13,-1582.47 4460.56,-1570.14 4425.73,-1557.71"/>
<polygon fill="black" stroke="black" points="4426.5,-1554.27 4415.91,-1554.21 4424.15,-1560.86 4426.5,-1554.27"/>
</g>
<!-- l2_exp_agg_tp2&#45;&gt;l2_final_res_tp2 -->
<g id="edge612" class="edge">
<title>l2_exp_agg_tp2&#45;&gt;l2_final_res_tp2</title>
<path fill="none" stroke="black" d="M4229.57,-1418.07C4229.77,-1409.4 4229.98,-1400.46 4230.19,-1391.63"/>
<polygon fill="black" stroke="black" points="4233.69,-1391.43 4230.43,-1381.35 4226.7,-1391.26 4233.69,-1391.43"/>
</g>
<!-- l3_qkv_tp2 -->
<g id="node392" class="node">
<title>l3_qkv_tp2</title>
<polygon fill="lightgreen" stroke="black" points="4275,-1208.17 4049,-1208.17 4049,-1140.17 4275,-1140.17 4275,-1208.17"/>
<text text-anchor="middle" x="4162" y="-1192.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4162" y="-1177.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="4162" y="-1162.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="4162" y="-1147.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_final_res_tp2&#45;&gt;l3_qkv_tp2 -->
<g id="edge835" class="edge">
<title>l2_final_res_tp2&#45;&gt;l3_qkv_tp2</title>
<path fill="none" stroke="black" d="M4197.62,-1244.87C4192.84,-1235.53 4188.05,-1226.16 4183.6,-1217.45"/>
<polygon fill="black" stroke="black" points="4186.59,-1215.61 4178.93,-1208.29 4180.36,-1218.79 4186.59,-1215.61"/>
</g>
<!-- l3_residual_tp2 -->
<g id="node395" class="node">
<title>l3_residual_tp2</title>
<polygon fill="lightyellow" stroke="black" points="4538.93,-893.17 3967.95,-893.17 3821.07,-757.17 4392.05,-757.17 4538.93,-893.17"/>
<text text-anchor="middle" x="4180" y="-843.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4180" y="-828.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="4180" y="-813.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="4180" y="-798.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_final_res_tp2&#45;&gt;l3_residual_tp2 -->
<g id="edge839" class="edge">
<title>l2_final_res_tp2&#45;&gt;l3_residual_tp2</title>
<path fill="none" stroke="black" d="M4275.73,-1245.1C4285.99,-1223.63 4294,-1199.18 4294,-1175.17 4294,-1175.17 4294,-1175.17 4294,-963.17 4294,-940.63 4284.77,-919.82 4271.56,-901.59"/>
<polygon fill="black" stroke="black" points="4274.12,-899.17 4265.23,-893.4 4268.58,-903.45 4274.12,-899.17"/>
</g>
<!-- l2_attn_tp3 -->
<g id="node288" class="node">
<title>l2_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="5928,-2215.17 5714,-2215.17 5714,-2147.17 5928,-2147.17 5928,-2215.17"/>
<text text-anchor="middle" x="5821" y="-2199.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5821" y="-2184.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="5821" y="-2169.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5821" y="-2154.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_qkv_tp3&#45;&gt;l2_attn_tp3 -->
<g id="edge614" class="edge">
<title>l2_qkv_tp3&#45;&gt;l2_attn_tp3</title>
<path fill="none" stroke="black" d="M5863.72,-2252.01C5858.27,-2243.1 5852.3,-2233.34 5846.6,-2224.02"/>
<polygon fill="black" stroke="black" points="5849.45,-2221.97 5841.24,-2215.26 5843.47,-2225.62 5849.45,-2221.97"/>
</g>
<!-- l2_residual_tp3 -->
<g id="node290" class="node">
<title>l2_residual_tp3</title>
<polygon fill="lightyellow" stroke="black" points="6301.93,-2005.17 5730.95,-2005.17 5584.07,-1869.17 6155.05,-1869.17 6301.93,-2005.17"/>
<text text-anchor="middle" x="5943" y="-1955.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5943" y="-1940.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="5943" y="-1925.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5943" y="-1910.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_qkv_tp3&#45;&gt;l2_residual_tp3 -->
<g id="edge617" class="edge">
<title>l2_qkv_tp3&#45;&gt;l2_residual_tp3</title>
<path fill="none" stroke="black" d="M5915.71,-2252.1C5924.25,-2241.18 5932.39,-2228.41 5937,-2215.17 5959.48,-2150.56 5958.84,-2072.25 5953.82,-2015.4"/>
<polygon fill="black" stroke="black" points="5957.3,-2015.03 5952.88,-2005.4 5950.33,-2015.69 5957.3,-2015.03"/>
</g>
<!-- l2_out_proj_tp3 -->
<g id="node289" class="node">
<title>l2_out_proj_tp3</title>
<polygon fill="lightgreen" stroke="black" points="5928,-2110.17 5716,-2110.17 5716,-2042.17 5928,-2042.17 5928,-2110.17"/>
<text text-anchor="middle" x="5822" y="-2094.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5822" y="-2079.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="5822" y="-2064.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5822" y="-2049.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_attn_tp3&#45;&gt;l2_out_proj_tp3 -->
<g id="edge615" class="edge">
<title>l2_attn_tp3&#45;&gt;l2_out_proj_tp3</title>
<path fill="none" stroke="black" d="M5821.32,-2147.01C5821.4,-2138.56 5821.49,-2129.34 5821.58,-2120.47"/>
<polygon fill="black" stroke="black" points="5825.08,-2120.29 5821.68,-2110.26 5818.08,-2120.23 5825.08,-2120.29"/>
</g>
<!-- l2_out_proj_tp3&#45;&gt;l2_residual_tp3 -->
<g id="edge616" class="edge">
<title>l2_out_proj_tp3&#45;&gt;l2_residual_tp3</title>
<path fill="none" stroke="black" d="M5851.29,-2042C5859.09,-2033.17 5867.85,-2023.25 5876.77,-2013.15"/>
<polygon fill="black" stroke="black" points="5879.62,-2015.21 5883.62,-2005.4 5874.38,-2010.58 5879.62,-2015.21"/>
</g>
<!-- l2_gate_tp3 -->
<g id="node291" class="node">
<title>l2_gate_tp3</title>
<polygon fill="lightyellow" stroke="black" points="5937.2,-1832.17 5607.59,-1832.17 5522.8,-1696.17 5852.41,-1696.17 5937.2,-1832.17"/>
<text text-anchor="middle" x="5730" y="-1782.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="5730" y="-1767.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="5730" y="-1752.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="5730" y="-1737.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_residual_tp3&#45;&gt;l2_gate_tp3 -->
<g id="edge618" class="edge">
<title>l2_residual_tp3&#45;&gt;l2_gate_tp3</title>
<path fill="none" stroke="black" d="M5859.43,-1869.07C5846.98,-1859.08 5834.09,-1848.73 5821.48,-1838.61"/>
<polygon fill="black" stroke="black" points="5823.67,-1835.88 5813.68,-1832.35 5819.29,-1841.34 5823.67,-1835.88"/>
</g>
<!-- l2_exp0_gpu11 -->
<g id="node292" class="node">
<title>l2_exp0_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="5295,-1659.17 5121,-1659.17 5121,-1591.17 5295,-1591.17 5295,-1659.17"/>
<text text-anchor="middle" x="5208" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="5208" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5208" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5208" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_residual_tp3&#45;&gt;l2_exp0_gpu11 -->
<g id="edge620" class="edge">
<title>l2_residual_tp3&#45;&gt;l2_exp0_gpu11</title>
<path fill="none" stroke="black" d="M5623.93,-1906.22C5550.7,-1890.71 5475.25,-1867.33 5410,-1832.17 5335.54,-1792.04 5271.42,-1715.22 5236.4,-1667.57"/>
<polygon fill="black" stroke="black" points="5239.12,-1665.36 5230.41,-1659.32 5233.45,-1669.47 5239.12,-1665.36"/>
</g>
<!-- l2_exp1_gpu11 -->
<g id="node293" class="node">
<title>l2_exp1_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="5103,-1659.17 4929,-1659.17 4929,-1591.17 5103,-1591.17 5103,-1659.17"/>
<text text-anchor="middle" x="5016" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="5016" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5016" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5016" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_residual_tp3&#45;&gt;l2_exp1_gpu11 -->
<g id="edge623" class="edge">
<title>l2_residual_tp3&#45;&gt;l2_exp1_gpu11</title>
<path fill="none" stroke="black" d="M5622.52,-1905.06C5475.76,-1887.33 5320,-1862.56 5254,-1832.17 5169.6,-1793.29 5092.32,-1715.18 5049.94,-1667.1"/>
<polygon fill="black" stroke="black" points="5052.4,-1664.6 5043.19,-1659.37 5047.12,-1669.2 5052.4,-1664.6"/>
</g>
<!-- l2_exp2_gpu11 -->
<g id="node294" class="node">
<title>l2_exp2_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="6447,-1659.17 6273,-1659.17 6273,-1591.17 6447,-1591.17 6447,-1659.17"/>
<text text-anchor="middle" x="6360" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="6360" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6360" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6360" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_residual_tp3&#45;&gt;l2_exp2_gpu11 -->
<g id="edge626" class="edge">
<title>l2_residual_tp3&#45;&gt;l2_exp2_gpu11</title>
<path fill="none" stroke="black" d="M6033.23,-1869.09C6116.88,-1806.91 6238.48,-1716.5 6307.32,-1665.33"/>
<polygon fill="black" stroke="black" points="6309.51,-1668.06 6315.45,-1659.29 6305.33,-1662.44 6309.51,-1668.06"/>
</g>
<!-- l2_exp3_gpu11 -->
<g id="node295" class="node">
<title>l2_exp3_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="6063,-1659.17 5889,-1659.17 5889,-1591.17 6063,-1591.17 6063,-1659.17"/>
<text text-anchor="middle" x="5976" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="5976" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5976" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5976" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_residual_tp3&#45;&gt;l2_exp3_gpu11 -->
<g id="edge629" class="edge">
<title>l2_residual_tp3&#45;&gt;l2_exp3_gpu11</title>
<path fill="none" stroke="black" d="M5958.13,-1869.04C5959.21,-1863.02 5960.19,-1856.99 5961,-1851.17 5969.69,-1788.39 5973.39,-1715.03 5974.93,-1669.58"/>
<polygon fill="black" stroke="black" points="5978.44,-1669.59 5975.26,-1659.48 5971.44,-1669.37 5978.44,-1669.59"/>
</g>
<!-- l2_exp4_gpu11 -->
<g id="node296" class="node">
<title>l2_exp4_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="5487,-1659.17 5313,-1659.17 5313,-1591.17 5487,-1591.17 5487,-1659.17"/>
<text text-anchor="middle" x="5400" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="5400" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5400" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5400" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_residual_tp3&#45;&gt;l2_exp4_gpu11 -->
<g id="edge632" class="edge">
<title>l2_residual_tp3&#45;&gt;l2_exp4_gpu11</title>
<path fill="none" stroke="black" d="M5598.02,-1882.22C5547.38,-1868.48 5505.63,-1851.88 5486,-1832.17 5441.12,-1787.11 5418.44,-1715.18 5407.94,-1669.34"/>
<polygon fill="black" stroke="black" points="5411.33,-1668.42 5405.76,-1659.41 5404.49,-1669.92 5411.33,-1668.42"/>
</g>
<!-- l2_exp5_gpu11 -->
<g id="node297" class="node">
<title>l2_exp5_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="5679,-1659.17 5505,-1659.17 5505,-1591.17 5679,-1591.17 5679,-1659.17"/>
<text text-anchor="middle" x="5592" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="5592" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5592" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5592" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_residual_tp3&#45;&gt;l2_exp5_gpu11 -->
<g id="edge635" class="edge">
<title>l2_residual_tp3&#45;&gt;l2_exp5_gpu11</title>
<path fill="none" stroke="black" d="M5591.37,-1875.97C5555.51,-1863.63 5527.33,-1849.11 5514,-1832.17 5476.63,-1784.66 5489.37,-1751.37 5514,-1696.17 5518.92,-1685.13 5526.54,-1675.11 5535.12,-1666.32"/>
<polygon fill="black" stroke="black" points="5537.72,-1668.68 5542.52,-1659.23 5532.88,-1663.63 5537.72,-1668.68"/>
</g>
<!-- l2_exp6_gpu11 -->
<g id="node298" class="node">
<title>l2_exp6_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="6255,-1659.17 6081,-1659.17 6081,-1591.17 6255,-1591.17 6255,-1659.17"/>
<text text-anchor="middle" x="6168" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="6168" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6168" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6168" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_residual_tp3&#45;&gt;l2_exp6_gpu11 -->
<g id="edge638" class="edge">
<title>l2_residual_tp3&#45;&gt;l2_exp6_gpu11</title>
<path fill="none" stroke="black" d="M5991.82,-1868.9C6036.26,-1807.67 6100.48,-1719.2 6137.86,-1667.7"/>
<polygon fill="black" stroke="black" points="6140.8,-1669.6 6143.84,-1659.45 6135.14,-1665.49 6140.8,-1669.6"/>
</g>
<!-- l2_exp7_gpu11 -->
<g id="node299" class="node">
<title>l2_exp7_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="5871,-1659.17 5697,-1659.17 5697,-1591.17 5871,-1591.17 5871,-1659.17"/>
<text text-anchor="middle" x="5784" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5784" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5784" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5784" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_residual_tp3&#45;&gt;l2_exp7_gpu11 -->
<g id="edge641" class="edge">
<title>l2_residual_tp3&#45;&gt;l2_exp7_gpu11</title>
<path fill="none" stroke="black" d="M5952,-1869.1C5958.73,-1808.11 5964.02,-1723.59 5946,-1696.17 5941.52,-1689.35 5912.74,-1676.09 5880.64,-1662.93"/>
<polygon fill="black" stroke="black" points="5881.64,-1659.56 5871.06,-1659.04 5879.01,-1666.05 5881.64,-1659.56"/>
</g>
<!-- l2_final_res_tp3 -->
<g id="node301" class="node">
<title>l2_final_res_tp3</title>
<polygon fill="lightyellow" stroke="black" points="6284.93,-1381.17 5713.95,-1381.17 5567.07,-1245.17 6138.05,-1245.17 6284.93,-1381.17"/>
<text text-anchor="middle" x="5926" y="-1331.97" font-family="Times,serif" font-size="14.00">Layer 2 Final Residual</text>
<text text-anchor="middle" x="5926" y="-1316.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="5926" y="-1301.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5926" y="-1286.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_residual_tp3&#45;&gt;l2_final_res_tp3 -->
<g id="edge644" class="edge">
<title>l2_residual_tp3&#45;&gt;l2_final_res_tp3</title>
<path fill="none" stroke="black" d="M6188.42,-1899.82C6324.3,-1872.53 6466,-1828.81 6466,-1765.17 6466,-1765.17 6466,-1765.17 6466,-1485.17 6466,-1435.93 6383.36,-1399.04 6282.75,-1372.38"/>
<polygon fill="black" stroke="black" points="6283.51,-1368.97 6272.95,-1369.84 6281.75,-1375.74 6283.51,-1368.97"/>
</g>
<!-- l2_gate_tp3&#45;&gt;l2_exp0_gpu11 -->
<g id="edge619" class="edge">
<title>l2_gate_tp3&#45;&gt;l2_exp0_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5533.17,-1713.18C5484.78,-1701.14 5433.07,-1688.5 5385,-1677.17 5351.91,-1669.37 5341.16,-1669.16 5305.01,-1659.34"/>
<polygon fill="black" stroke="black" points="5305.82,-1655.93 5295.25,-1656.62 5303.94,-1662.67 5305.82,-1655.93"/>
</g>
<!-- l2_gate_tp3&#45;&gt;l2_exp1_gpu11 -->
<g id="edge622" class="edge">
<title>l2_gate_tp3&#45;&gt;l2_exp1_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5550.56,-1740.92C5429.01,-1723.96 5265,-1697.39 5113.18,-1659.34"/>
<polygon fill="black" stroke="black" points="5113.75,-1655.88 5103.19,-1656.82 5112.03,-1662.66 5113.75,-1655.88"/>
</g>
<!-- l2_gate_tp3&#45;&gt;l2_exp2_gpu11 -->
<g id="edge625" class="edge">
<title>l2_gate_tp3&#45;&gt;l2_exp2_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5879.74,-1739.73C5984.86,-1721.92 6128.6,-1694.86 6262.73,-1659.4"/>
<polygon fill="black" stroke="black" points="6264.02,-1662.68 6272.78,-1656.72 6262.22,-1655.91 6264.02,-1662.68"/>
</g>
<!-- l2_gate_tp3&#45;&gt;l2_exp3_gpu11 -->
<g id="edge628" class="edge">
<title>l2_gate_tp3&#45;&gt;l2_exp3_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5850.48,-1696.07C5870.07,-1685.16 5889.75,-1674.2 5907.52,-1664.3"/>
<polygon fill="black" stroke="black" points="5909.6,-1667.15 5916.63,-1659.23 5906.19,-1661.04 5909.6,-1667.15"/>
</g>
<!-- l2_gate_tp3&#45;&gt;l2_exp4_gpu11 -->
<g id="edge631" class="edge">
<title>l2_gate_tp3&#45;&gt;l2_exp4_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5568.38,-1696.07C5541.02,-1684.71 5513.52,-1673.3 5488.92,-1663.08"/>
<polygon fill="black" stroke="black" points="5490.22,-1659.83 5479.64,-1659.23 5487.53,-1666.3 5490.22,-1659.83"/>
</g>
<!-- l2_gate_tp3&#45;&gt;l2_exp5_gpu11 -->
<g id="edge634" class="edge">
<title>l2_gate_tp3&#45;&gt;l2_exp5_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5662.21,-1695.87C5652.1,-1685.83 5641.95,-1675.76 5632.64,-1666.51"/>
<polygon fill="black" stroke="black" points="5634.93,-1663.86 5625.37,-1659.29 5630,-1668.82 5634.93,-1663.86"/>
</g>
<!-- l2_gate_tp3&#45;&gt;l2_exp6_gpu11 -->
<g id="edge637" class="edge">
<title>l2_gate_tp3&#45;&gt;l2_exp6_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5868.88,-1722.17C5928.48,-1704.27 5999.07,-1682.67 6071.2,-1659.4"/>
<polygon fill="black" stroke="black" points="6072.49,-1662.66 6080.92,-1656.25 6070.33,-1656 6072.49,-1662.66"/>
</g>
<!-- l2_gate_tp3&#45;&gt;l2_exp7_gpu11 -->
<g id="edge640" class="edge">
<title>l2_gate_tp3&#45;&gt;l2_exp7_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5756.53,-1695.87C5760.17,-1686.63 5763.82,-1677.35 5767.22,-1668.73"/>
<polygon fill="black" stroke="black" points="5770.53,-1669.88 5770.94,-1659.29 5764.02,-1667.31 5770.53,-1669.88"/>
</g>
<!-- l2_exp_agg_tp3 -->
<g id="node300" class="node">
<title>l2_exp_agg_tp3</title>
<polygon fill="lightyellow" stroke="black" points="6003.58,-1554.17 5654.28,-1554.17 5564.42,-1418.17 5913.72,-1418.17 6003.58,-1554.17"/>
<text text-anchor="middle" x="5784" y="-1504.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5784" y="-1489.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="5784" y="-1474.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5784" y="-1459.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_exp0_gpu11&#45;&gt;l2_exp_agg_tp3 -->
<g id="edge621" class="edge">
<title>l2_exp0_gpu11&#45;&gt;l2_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5295.24,-1593.69C5298.19,-1592.82 5301.11,-1591.97 5304,-1591.17 5407.61,-1562.24 5525.66,-1536.57 5618.77,-1517.97"/>
<polygon fill="black" stroke="black" points="5619.72,-1521.35 5628.85,-1515.96 5618.35,-1514.48 5619.72,-1521.35"/>
</g>
<!-- l2_exp1_gpu11&#45;&gt;l2_exp_agg_tp3 -->
<g id="edge624" class="edge">
<title>l2_exp1_gpu11&#45;&gt;l2_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5103.18,-1593.46C5106.15,-1592.65 5109.09,-1591.89 5112,-1591.17 5279.29,-1549.82 5474.29,-1521.81 5611.01,-1505.37"/>
<polygon fill="black" stroke="black" points="5611.65,-1508.82 5621.16,-1504.16 5610.82,-1501.87 5611.65,-1508.82"/>
</g>
<!-- l2_exp2_gpu11&#45;&gt;l2_exp_agg_tp3 -->
<g id="edge627" class="edge">
<title>l2_exp2_gpu11&#45;&gt;l2_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M6272.76,-1593.69C6269.81,-1592.82 6266.89,-1591.97 6264,-1591.17 6176.51,-1566.74 6078.71,-1544.64 5994.34,-1527.15"/>
<polygon fill="black" stroke="black" points="5994.88,-1523.69 5984.38,-1525.09 5993.47,-1530.54 5994.88,-1523.69"/>
</g>
<!-- l2_exp3_gpu11&#45;&gt;l2_exp_agg_tp3 -->
<g id="edge630" class="edge">
<title>l2_exp3_gpu11&#45;&gt;l2_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5929.52,-1591C5916.41,-1581.65 5901.61,-1571.08 5886.58,-1560.36"/>
<polygon fill="black" stroke="black" points="5888.4,-1557.36 5878.22,-1554.4 5884.33,-1563.06 5888.4,-1557.36"/>
</g>
<!-- l2_exp4_gpu11&#45;&gt;l2_exp_agg_tp3 -->
<g id="edge633" class="edge">
<title>l2_exp4_gpu11&#45;&gt;l2_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5487.14,-1593.08C5530.38,-1577.65 5583.85,-1558.57 5633.45,-1540.88"/>
<polygon fill="black" stroke="black" points="5634.75,-1544.13 5642.99,-1537.48 5632.39,-1537.54 5634.75,-1544.13"/>
</g>
<!-- l2_exp5_gpu11&#45;&gt;l2_exp_agg_tp3 -->
<g id="edge636" class="edge">
<title>l2_exp5_gpu11&#45;&gt;l2_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5638.48,-1591C5651.59,-1581.65 5666.39,-1571.08 5681.42,-1560.36"/>
<polygon fill="black" stroke="black" points="5683.67,-1563.06 5689.78,-1554.4 5679.6,-1557.36 5683.67,-1563.06"/>
</g>
<!-- l2_exp6_gpu11&#45;&gt;l2_exp_agg_tp3 -->
<g id="edge639" class="edge">
<title>l2_exp6_gpu11&#45;&gt;l2_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M6080.86,-1593.08C6051.13,-1582.47 6016.56,-1570.14 5981.73,-1557.71"/>
<polygon fill="black" stroke="black" points="5982.5,-1554.27 5971.91,-1554.21 5980.15,-1560.86 5982.5,-1554.27"/>
</g>
<!-- l2_exp7_gpu11&#45;&gt;l2_exp_agg_tp3 -->
<g id="edge642" class="edge">
<title>l2_exp7_gpu11&#45;&gt;l2_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5784,-1591C5784,-1582.86 5784,-1573.8 5784,-1564.52"/>
<polygon fill="black" stroke="black" points="5787.5,-1564.4 5784,-1554.4 5780.5,-1564.4 5787.5,-1564.4"/>
</g>
<!-- l2_exp_agg_tp3&#45;&gt;l2_final_res_tp3 -->
<g id="edge643" class="edge">
<title>l2_exp_agg_tp3&#45;&gt;l2_final_res_tp3</title>
<path fill="none" stroke="black" d="M5839.71,-1418.07C5847.62,-1408.55 5855.8,-1398.71 5863.82,-1389.05"/>
<polygon fill="black" stroke="black" points="5866.52,-1391.28 5870.21,-1381.35 5861.13,-1386.8 5866.52,-1391.28"/>
</g>
<!-- l3_qkv_tp3 -->
<g id="node407" class="node">
<title>l3_qkv_tp3</title>
<polygon fill="lightgreen" stroke="black" points="5942,-1208.17 5716,-1208.17 5716,-1140.17 5942,-1140.17 5942,-1208.17"/>
<text text-anchor="middle" x="5829" y="-1192.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5829" y="-1177.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="5829" y="-1162.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="5829" y="-1147.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_final_res_tp3&#45;&gt;l3_qkv_tp3 -->
<g id="edge868" class="edge">
<title>l2_final_res_tp3&#45;&gt;l3_qkv_tp3</title>
<path fill="none" stroke="black" d="M5878.35,-1244.87C5871.53,-1235.23 5864.68,-1225.56 5858.35,-1216.62"/>
<polygon fill="black" stroke="black" points="5861.09,-1214.43 5852.46,-1208.29 5855.38,-1218.48 5861.09,-1214.43"/>
</g>
<!-- l3_residual_tp3 -->
<g id="node410" class="node">
<title>l3_residual_tp3</title>
<polygon fill="lightyellow" stroke="black" points="6255.93,-893.17 5684.95,-893.17 5538.07,-757.17 6109.05,-757.17 6255.93,-893.17"/>
<text text-anchor="middle" x="5897" y="-843.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5897" y="-828.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="5897" y="-813.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5897" y="-798.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_final_res_tp3&#45;&gt;l3_residual_tp3 -->
<g id="edge872" class="edge">
<title>l2_final_res_tp3&#45;&gt;l3_residual_tp3</title>
<path fill="none" stroke="black" d="M5950.21,-1245.09C5956.23,-1223.1 5961,-1198.36 5961,-1175.17 5961,-1175.17 5961,-1175.17 5961,-963.17 5961,-942.52 5954.96,-921.64 5946.59,-902.6"/>
<polygon fill="black" stroke="black" points="5949.71,-901 5942.32,-893.42 5943.37,-903.96 5949.71,-901"/>
</g>
<!-- l2_attn_tp4 -->
<g id="node303" class="node">
<title>l2_attn_tp4</title>
<polygon fill="lightgreen" stroke="black" points="7187,-2215.17 6973,-2215.17 6973,-2147.17 7187,-2147.17 7187,-2215.17"/>
<text text-anchor="middle" x="7080" y="-2199.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="7080" y="-2184.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="7080" y="-2169.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="7080" y="-2154.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l2_qkv_tp4&#45;&gt;l2_attn_tp4 -->
<g id="edge645" class="edge">
<title>l2_qkv_tp4&#45;&gt;l2_attn_tp4</title>
<path fill="none" stroke="black" d="M7143.06,-2252.01C7134.68,-2242.73 7125.48,-2232.53 7116.75,-2222.87"/>
<polygon fill="black" stroke="black" points="7119.18,-2220.34 7109.88,-2215.26 7113.99,-2225.03 7119.18,-2220.34"/>
</g>
<!-- l2_residual_tp4 -->
<g id="node305" class="node">
<title>l2_residual_tp4</title>
<polygon fill="lightyellow" stroke="black" points="7530.93,-2005.17 6959.95,-2005.17 6813.07,-1869.17 7384.05,-1869.17 7530.93,-2005.17"/>
<text text-anchor="middle" x="7172" y="-1955.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7172" y="-1940.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="7172" y="-1925.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="7172" y="-1910.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l2_qkv_tp4&#45;&gt;l2_residual_tp4 -->
<g id="edge648" class="edge">
<title>l2_qkv_tp4&#45;&gt;l2_residual_tp4</title>
<path fill="none" stroke="black" d="M7186.33,-2251.88C7190.26,-2240.44 7194.04,-2227.42 7196,-2215.17 7198.42,-2200.06 7197.11,-2060.69 7195,-2042.17 7194,-2033.42 7192.58,-2024.34 7190.93,-2015.34"/>
<polygon fill="black" stroke="black" points="7194.31,-2014.39 7188.97,-2005.23 7187.44,-2015.72 7194.31,-2014.39"/>
</g>
<!-- l2_out_proj_tp4 -->
<g id="node304" class="node">
<title>l2_out_proj_tp4</title>
<polygon fill="lightgreen" stroke="black" points="7186,-2110.17 6974,-2110.17 6974,-2042.17 7186,-2042.17 7186,-2110.17"/>
<text text-anchor="middle" x="7080" y="-2094.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7080" y="-2079.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="7080" y="-2064.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="7080" y="-2049.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l2_attn_tp4&#45;&gt;l2_out_proj_tp4 -->
<g id="edge646" class="edge">
<title>l2_attn_tp4&#45;&gt;l2_out_proj_tp4</title>
<path fill="none" stroke="black" d="M7080,-2147.01C7080,-2138.56 7080,-2129.34 7080,-2120.47"/>
<polygon fill="black" stroke="black" points="7083.5,-2120.26 7080,-2110.26 7076.5,-2120.26 7083.5,-2120.26"/>
</g>
<!-- l2_out_proj_tp4&#45;&gt;l2_residual_tp4 -->
<g id="edge647" class="edge">
<title>l2_out_proj_tp4&#45;&gt;l2_residual_tp4</title>
<path fill="none" stroke="black" d="M7102.27,-2042C7108.09,-2033.34 7114.6,-2023.64 7121.25,-2013.74"/>
<polygon fill="black" stroke="black" points="7124.18,-2015.65 7126.85,-2005.4 7118.37,-2011.75 7124.18,-2015.65"/>
</g>
<!-- l2_gate_tp4 -->
<g id="node306" class="node">
<title>l2_gate_tp4</title>
<polygon fill="lightyellow" stroke="black" points="7547.2,-1832.17 7217.59,-1832.17 7132.8,-1696.17 7462.41,-1696.17 7547.2,-1832.17"/>
<text text-anchor="middle" x="7340" y="-1782.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="7340" y="-1767.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="7340" y="-1752.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="7340" y="-1737.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l2_residual_tp4&#45;&gt;l2_gate_tp4 -->
<g id="edge649" class="edge">
<title>l2_residual_tp4&#45;&gt;l2_gate_tp4</title>
<path fill="none" stroke="black" d="M7237.92,-1869.07C7247.37,-1859.46 7257.14,-1849.51 7266.72,-1839.76"/>
<polygon fill="black" stroke="black" points="7269.49,-1841.93 7274,-1832.35 7264.49,-1837.03 7269.49,-1841.93"/>
</g>
<!-- l2_exp0_gpu12 -->
<g id="node307" class="node">
<title>l2_exp0_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="7235,-1659.17 7061,-1659.17 7061,-1591.17 7235,-1591.17 7235,-1659.17"/>
<text text-anchor="middle" x="7148" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="7148" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7148" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7148" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l2_residual_tp4&#45;&gt;l2_exp0_gpu12 -->
<g id="edge651" class="edge">
<title>l2_residual_tp4&#45;&gt;l2_exp0_gpu12</title>
<path fill="none" stroke="black" d="M7116.72,-1869.15C7113.66,-1863.3 7111.02,-1857.27 7109,-1851.17 7084.75,-1777.73 7084.2,-1750.42 7109,-1677.17 7110.05,-1674.05 7111.38,-1670.98 7112.91,-1667.98"/>
<polygon fill="black" stroke="black" points="7116,-1669.63 7118.01,-1659.22 7109.95,-1666.1 7116,-1669.63"/>
</g>
<!-- l2_exp1_gpu12 -->
<g id="node308" class="node">
<title>l2_exp1_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="6659,-1659.17 6485,-1659.17 6485,-1591.17 6659,-1591.17 6659,-1659.17"/>
<text text-anchor="middle" x="6572" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="6572" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6572" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6572" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l2_residual_tp4&#45;&gt;l2_exp1_gpu12 -->
<g id="edge654" class="edge">
<title>l2_residual_tp4&#45;&gt;l2_exp1_gpu12</title>
<path fill="none" stroke="black" d="M6913.32,-1869.07C6884.56,-1858.24 6856.22,-1845.97 6830,-1832.17 6744.78,-1787.31 6660.29,-1712.6 6612.28,-1666.55"/>
<polygon fill="black" stroke="black" points="6614.52,-1663.84 6604.9,-1659.41 6609.66,-1668.88 6614.52,-1663.84"/>
</g>
<!-- l2_exp2_gpu12 -->
<g id="node309" class="node">
<title>l2_exp2_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="7427,-1659.17 7253,-1659.17 7253,-1591.17 7427,-1591.17 7427,-1659.17"/>
<text text-anchor="middle" x="7340" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="7340" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7340" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7340" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l2_residual_tp4&#45;&gt;l2_exp2_gpu12 -->
<g id="edge657" class="edge">
<title>l2_residual_tp4&#45;&gt;l2_exp2_gpu12</title>
<path fill="none" stroke="black" d="M7132.62,-1868.96C7107.95,-1817.12 7087.16,-1746.08 7124,-1696.17 7155.33,-1653.72 7187.24,-1673.92 7243,-1659.17"/>
<polygon fill="black" stroke="black" points="7244.32,-1662.43 7252.92,-1656.24 7242.34,-1655.71 7244.32,-1662.43"/>
</g>
<!-- l2_exp3_gpu12 -->
<g id="node310" class="node">
<title>l2_exp3_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="7811,-1659.17 7637,-1659.17 7637,-1591.17 7811,-1591.17 7811,-1659.17"/>
<text text-anchor="middle" x="7724" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7724" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7724" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7724" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l2_residual_tp4&#45;&gt;l2_exp3_gpu12 -->
<g id="edge660" class="edge">
<title>l2_residual_tp4&#45;&gt;l2_exp3_gpu12</title>
<path fill="none" stroke="black" d="M7425.99,-1907.97C7478.33,-1892.29 7529.7,-1868.4 7570,-1832.17 7624.48,-1783.19 7672.38,-1712.38 7699.76,-1667.84"/>
<polygon fill="black" stroke="black" points="7702.75,-1669.66 7704.96,-1659.29 7696.77,-1666.02 7702.75,-1669.66"/>
</g>
<!-- l2_exp4_gpu12 -->
<g id="node311" class="node">
<title>l2_exp4_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="7619,-1659.17 7445,-1659.17 7445,-1591.17 7619,-1591.17 7619,-1659.17"/>
<text text-anchor="middle" x="7532" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="7532" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7532" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7532" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l2_residual_tp4&#45;&gt;l2_exp4_gpu12 -->
<g id="edge663" class="edge">
<title>l2_residual_tp4&#45;&gt;l2_exp4_gpu12</title>
<path fill="none" stroke="black" d="M7412.69,-1895.48C7477.89,-1879.32 7536.04,-1858.26 7556,-1832.17 7591.95,-1785.18 7571.87,-1713.65 7552.87,-1668.43"/>
<polygon fill="black" stroke="black" points="7556.05,-1666.97 7548.85,-1659.2 7549.63,-1669.77 7556.05,-1666.97"/>
</g>
<!-- l2_exp5_gpu12 -->
<g id="node312" class="node">
<title>l2_exp5_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="6851,-1659.17 6677,-1659.17 6677,-1591.17 6851,-1591.17 6851,-1659.17"/>
<text text-anchor="middle" x="6764" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="6764" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6764" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6764" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l2_residual_tp4&#45;&gt;l2_exp5_gpu12 -->
<g id="edge666" class="edge">
<title>l2_residual_tp4&#45;&gt;l2_exp5_gpu12</title>
<path fill="none" stroke="black" d="M7048.54,-1868.95C7029.52,-1857.32 7010.43,-1844.86 6993,-1832.17 6921.9,-1780.38 6847.63,-1710.1 6803.61,-1666.47"/>
<polygon fill="black" stroke="black" points="6805.84,-1663.75 6796.28,-1659.17 6800.9,-1668.71 6805.84,-1663.75"/>
</g>
<!-- l2_exp6_gpu12 -->
<g id="node313" class="node">
<title>l2_exp6_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="7043,-1659.17 6869,-1659.17 6869,-1591.17 7043,-1591.17 7043,-1659.17"/>
<text text-anchor="middle" x="6956" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="6956" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6956" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6956" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l2_residual_tp4&#45;&gt;l2_exp6_gpu12 -->
<g id="edge669" class="edge">
<title>l2_residual_tp4&#45;&gt;l2_exp6_gpu12</title>
<path fill="none" stroke="black" d="M7114.28,-1868.91C7104.57,-1856.88 7094.8,-1844.31 7086,-1832.17 7046.28,-1777.33 7005.39,-1710.51 6980.33,-1668.14"/>
<polygon fill="black" stroke="black" points="6983.33,-1666.32 6975.23,-1659.48 6977.29,-1669.88 6983.33,-1666.32"/>
</g>
<!-- l2_exp7_gpu12 -->
<g id="node314" class="node">
<title>l2_exp7_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="8003,-1659.17 7829,-1659.17 7829,-1591.17 8003,-1591.17 8003,-1659.17"/>
<text text-anchor="middle" x="7916" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="7916" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7916" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7916" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l2_residual_tp4&#45;&gt;l2_exp7_gpu12 -->
<g id="edge672" class="edge">
<title>l2_residual_tp4&#45;&gt;l2_exp7_gpu12</title>
<path fill="none" stroke="black" d="M7417.68,-1900.02C7488.22,-1884.46 7563.9,-1862.61 7630,-1832.17 7724.3,-1788.74 7819.22,-1712.4 7872.52,-1665.84"/>
<polygon fill="black" stroke="black" points="7874.88,-1668.43 7880.08,-1659.2 7870.26,-1663.17 7874.88,-1668.43"/>
</g>
<!-- l2_final_res_tp4 -->
<g id="node316" class="node">
<title>l2_final_res_tp4</title>
<polygon fill="lightyellow" stroke="black" points="7702.93,-1381.17 7131.95,-1381.17 6985.07,-1245.17 7556.05,-1245.17 7702.93,-1381.17"/>
<text text-anchor="middle" x="7344" y="-1331.97" font-family="Times,serif" font-size="14.00">Layer 2 Final Residual</text>
<text text-anchor="middle" x="7344" y="-1316.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="7344" y="-1301.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="7344" y="-1286.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l2_residual_tp4&#45;&gt;l2_final_res_tp4 -->
<g id="edge675" class="edge">
<title>l2_residual_tp4&#45;&gt;l2_final_res_tp4</title>
<path fill="none" stroke="black" d="M7452.38,-1932.36C7700.01,-1921.14 8022,-1883.75 8022,-1765.17 8022,-1765.17 8022,-1765.17 8022,-1485.17 8022,-1404.93 7841.24,-1361.97 7666.38,-1339.17"/>
<polygon fill="black" stroke="black" points="7666.57,-1335.67 7656.21,-1337.87 7665.68,-1342.61 7666.57,-1335.67"/>
</g>
<!-- l2_gate_tp4&#45;&gt;l2_exp0_gpu12 -->
<g id="edge650" class="edge">
<title>l2_gate_tp4&#45;&gt;l2_exp0_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7245.97,-1696.07C7231.18,-1685.52 7216.32,-1674.92 7202.81,-1665.28"/>
<polygon fill="black" stroke="black" points="7204.76,-1662.36 7194.58,-1659.41 7200.69,-1668.06 7204.76,-1662.36"/>
</g>
<!-- l2_gate_tp4&#45;&gt;l2_exp1_gpu12 -->
<g id="edge653" class="edge">
<title>l2_gate_tp4&#45;&gt;l2_exp1_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7162.86,-1744.46C7028.9,-1728.27 6840.74,-1701.13 6668.91,-1659.26"/>
<polygon fill="black" stroke="black" points="6669.73,-1655.86 6659.18,-1656.87 6668.06,-1662.65 6669.73,-1655.86"/>
</g>
<!-- l2_gate_tp4&#45;&gt;l2_exp2_gpu12 -->
<g id="edge656" class="edge">
<title>l2_gate_tp4&#45;&gt;l2_exp2_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7340,-1695.87C7340,-1686.93 7340,-1677.95 7340,-1669.56"/>
<polygon fill="black" stroke="black" points="7343.5,-1669.29 7340,-1659.29 7336.5,-1669.29 7343.5,-1669.29"/>
</g>
<!-- l2_gate_tp4&#45;&gt;l2_exp3_gpu12 -->
<g id="edge659" class="edge">
<title>l2_gate_tp4&#45;&gt;l2_exp3_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7474.57,-1715.15C7524.83,-1697.22 7580.87,-1677.23 7627.08,-1660.74"/>
<polygon fill="black" stroke="black" points="7628.54,-1663.94 7636.79,-1657.28 7626.19,-1657.35 7628.54,-1663.94"/>
</g>
<!-- l2_gate_tp4&#45;&gt;l2_exp4_gpu12 -->
<g id="edge662" class="edge">
<title>l2_gate_tp4&#45;&gt;l2_exp4_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7434.03,-1696.07C7448.82,-1685.52 7463.68,-1674.92 7477.19,-1665.28"/>
<polygon fill="black" stroke="black" points="7479.31,-1668.06 7485.42,-1659.41 7475.24,-1662.36 7479.31,-1668.06"/>
</g>
<!-- l2_gate_tp4&#45;&gt;l2_exp5_gpu12 -->
<g id="edge665" class="edge">
<title>l2_gate_tp4&#45;&gt;l2_exp5_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7148.9,-1722.3C7033.39,-1697.52 6901.98,-1669.15 6860.95,-1659.14"/>
<polygon fill="black" stroke="black" points="6861.8,-1655.74 6851.24,-1656.64 6860.06,-1662.52 6861.8,-1655.74"/>
</g>
<!-- l2_gate_tp4&#45;&gt;l2_exp6_gpu12 -->
<g id="edge668" class="edge">
<title>l2_gate_tp4&#45;&gt;l2_exp6_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7151.94,-1696.07C7117.64,-1683.84 7083.18,-1671.54 7052.93,-1660.75"/>
<polygon fill="black" stroke="black" points="7053.86,-1657.36 7043.26,-1657.3 7051.51,-1663.96 7053.86,-1657.36"/>
</g>
<!-- l2_gate_tp4&#45;&gt;l2_exp7_gpu12 -->
<g id="edge671" class="edge">
<title>l2_gate_tp4&#45;&gt;l2_exp7_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7487.36,-1735.91C7580.28,-1717.61 7702.73,-1691.45 7818.97,-1659.36"/>
<polygon fill="black" stroke="black" points="7820.06,-1662.69 7828.76,-1656.64 7818.19,-1655.95 7820.06,-1662.69"/>
</g>
<!-- l2_exp_agg_tp4 -->
<g id="node315" class="node">
<title>l2_exp_agg_tp4</title>
<polygon fill="lightyellow" stroke="black" points="7559.58,-1554.17 7210.28,-1554.17 7120.42,-1418.17 7469.72,-1418.17 7559.58,-1554.17"/>
<text text-anchor="middle" x="7340" y="-1504.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7340" y="-1489.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="7340" y="-1474.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="7340" y="-1459.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l2_exp0_gpu12&#45;&gt;l2_exp_agg_tp4 -->
<g id="edge652" class="edge">
<title>l2_exp0_gpu12&#45;&gt;l2_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7194.48,-1591C7207.59,-1581.65 7222.39,-1571.08 7237.42,-1560.36"/>
<polygon fill="black" stroke="black" points="7239.67,-1563.06 7245.78,-1554.4 7235.6,-1557.36 7239.67,-1563.06"/>
</g>
<!-- l2_exp1_gpu12&#45;&gt;l2_exp_agg_tp4 -->
<g id="edge655" class="edge">
<title>l2_exp1_gpu12&#45;&gt;l2_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M6659.18,-1593.46C6662.15,-1592.65 6665.09,-1591.89 6668,-1591.17 6835.29,-1549.82 7030.29,-1521.81 7167.01,-1505.37"/>
<polygon fill="black" stroke="black" points="7167.65,-1508.82 7177.16,-1504.16 7166.82,-1501.87 7167.65,-1508.82"/>
</g>
<!-- l2_exp2_gpu12&#45;&gt;l2_exp_agg_tp4 -->
<g id="edge658" class="edge">
<title>l2_exp2_gpu12&#45;&gt;l2_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7340,-1591C7340,-1582.86 7340,-1573.8 7340,-1564.52"/>
<polygon fill="black" stroke="black" points="7343.5,-1564.4 7340,-1554.4 7336.5,-1564.4 7343.5,-1564.4"/>
</g>
<!-- l2_exp3_gpu12&#45;&gt;l2_exp_agg_tp4 -->
<g id="edge661" class="edge">
<title>l2_exp3_gpu12&#45;&gt;l2_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7636.86,-1593.08C7607.13,-1582.47 7572.56,-1570.14 7537.73,-1557.71"/>
<polygon fill="black" stroke="black" points="7538.5,-1554.27 7527.91,-1554.21 7536.15,-1560.86 7538.5,-1554.27"/>
</g>
<!-- l2_exp4_gpu12&#45;&gt;l2_exp_agg_tp4 -->
<g id="edge664" class="edge">
<title>l2_exp4_gpu12&#45;&gt;l2_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7485.52,-1591C7472.41,-1581.65 7457.61,-1571.08 7442.58,-1560.36"/>
<polygon fill="black" stroke="black" points="7444.4,-1557.36 7434.22,-1554.4 7440.33,-1563.06 7444.4,-1557.36"/>
</g>
<!-- l2_exp5_gpu12&#45;&gt;l2_exp_agg_tp4 -->
<g id="edge667" class="edge">
<title>l2_exp5_gpu12&#45;&gt;l2_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M6851.24,-1593.69C6854.19,-1592.82 6857.11,-1591.97 6860,-1591.17 6963.61,-1562.24 7081.66,-1536.57 7174.77,-1517.97"/>
<polygon fill="black" stroke="black" points="7175.72,-1521.35 7184.85,-1515.96 7174.35,-1514.48 7175.72,-1521.35"/>
</g>
<!-- l2_exp6_gpu12&#45;&gt;l2_exp_agg_tp4 -->
<g id="edge670" class="edge">
<title>l2_exp6_gpu12&#45;&gt;l2_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7043.14,-1593.08C7086.38,-1577.65 7139.85,-1558.57 7189.45,-1540.88"/>
<polygon fill="black" stroke="black" points="7190.75,-1544.13 7198.99,-1537.48 7188.39,-1537.54 7190.75,-1544.13"/>
</g>
<!-- l2_exp7_gpu12&#45;&gt;l2_exp_agg_tp4 -->
<g id="edge673" class="edge">
<title>l2_exp7_gpu12&#45;&gt;l2_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7828.76,-1593.69C7825.81,-1592.82 7822.89,-1591.97 7820,-1591.17 7732.51,-1566.74 7634.71,-1544.64 7550.34,-1527.15"/>
<polygon fill="black" stroke="black" points="7550.88,-1523.69 7540.38,-1525.09 7549.47,-1530.54 7550.88,-1523.69"/>
</g>
<!-- l2_exp_agg_tp4&#45;&gt;l2_final_res_tp4 -->
<g id="edge674" class="edge">
<title>l2_exp_agg_tp4&#45;&gt;l2_final_res_tp4</title>
<path fill="none" stroke="black" d="M7341.57,-1418.07C7341.77,-1409.4 7341.98,-1400.46 7342.19,-1391.63"/>
<polygon fill="black" stroke="black" points="7345.69,-1391.43 7342.43,-1381.35 7338.7,-1391.26 7345.69,-1391.43"/>
</g>
<!-- l3_qkv_tp4 -->
<g id="node422" class="node">
<title>l3_qkv_tp4</title>
<polygon fill="lightgreen" stroke="black" points="7329,-1208.17 7103,-1208.17 7103,-1140.17 7329,-1140.17 7329,-1208.17"/>
<text text-anchor="middle" x="7216" y="-1192.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7216" y="-1177.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="7216" y="-1162.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="7216" y="-1147.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l2_final_res_tp4&#45;&gt;l3_qkv_tp4 -->
<g id="edge901" class="edge">
<title>l2_final_res_tp4&#45;&gt;l3_qkv_tp4</title>
<path fill="none" stroke="black" d="M7281.12,-1244.87C7271.84,-1234.93 7262.52,-1224.96 7253.95,-1215.79"/>
<polygon fill="black" stroke="black" points="7256.34,-1213.21 7246.95,-1208.29 7251.22,-1217.99 7256.34,-1213.21"/>
</g>
<!-- l3_residual_tp4 -->
<g id="node425" class="node">
<title>l3_residual_tp4</title>
<polygon fill="lightyellow" stroke="black" points="7648.93,-893.17 7077.95,-893.17 6931.07,-757.17 7502.05,-757.17 7648.93,-893.17"/>
<text text-anchor="middle" x="7290" y="-843.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7290" y="-828.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="7290" y="-813.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="7290" y="-798.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l2_final_res_tp4&#45;&gt;l3_residual_tp4 -->
<g id="edge905" class="edge">
<title>l2_final_res_tp4&#45;&gt;l3_residual_tp4</title>
<path fill="none" stroke="black" d="M7346.75,-1244.93C7347.44,-1222.73 7348,-1197.89 7348,-1175.17 7348,-1175.17 7348,-1175.17 7348,-963.17 7348,-942.63 7342.41,-921.64 7334.7,-902.46"/>
<polygon fill="black" stroke="black" points="7337.89,-901.03 7330.76,-893.2 7331.45,-903.77 7337.89,-901.03"/>
</g>
<!-- l2_attn_tp5 -->
<g id="node318" class="node">
<title>l2_attn_tp5</title>
<polygon fill="lightgreen" stroke="black" points="9025,-2215.17 8811,-2215.17 8811,-2147.17 9025,-2147.17 9025,-2215.17"/>
<text text-anchor="middle" x="8918" y="-2199.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="8918" y="-2184.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="8918" y="-2169.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="8918" y="-2154.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l2_qkv_tp5&#45;&gt;l2_attn_tp5 -->
<g id="edge676" class="edge">
<title>l2_qkv_tp5&#45;&gt;l2_attn_tp5</title>
<path fill="none" stroke="black" d="M8981.74,-2252.01C8973.27,-2242.73 8963.97,-2232.53 8955.15,-2222.87"/>
<polygon fill="black" stroke="black" points="8957.53,-2220.29 8948.2,-2215.26 8952.36,-2225.01 8957.53,-2220.29"/>
</g>
<!-- l2_residual_tp5 -->
<g id="node320" class="node">
<title>l2_residual_tp5</title>
<polygon fill="lightyellow" stroke="black" points="9368.93,-2005.17 8797.95,-2005.17 8651.07,-1869.17 9222.05,-1869.17 9368.93,-2005.17"/>
<text text-anchor="middle" x="9010" y="-1955.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9010" y="-1940.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="9010" y="-1925.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="9010" y="-1910.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l2_qkv_tp5&#45;&gt;l2_residual_tp5 -->
<g id="edge679" class="edge">
<title>l2_qkv_tp5&#45;&gt;l2_residual_tp5</title>
<path fill="none" stroke="black" d="M9024.75,-2251.83C9028.51,-2240.39 9032.13,-2227.38 9034,-2215.17 9036.38,-2199.69 9035.05,-2060.11 9033,-2042.17 9032,-2033.42 9030.58,-2024.34 9028.93,-2015.34"/>
<polygon fill="black" stroke="black" points="9032.31,-2014.39 9026.97,-2005.23 9025.44,-2015.72 9032.31,-2014.39"/>
</g>
<!-- l2_out_proj_tp5 -->
<g id="node319" class="node">
<title>l2_out_proj_tp5</title>
<polygon fill="lightgreen" stroke="black" points="9024,-2110.17 8812,-2110.17 8812,-2042.17 9024,-2042.17 9024,-2110.17"/>
<text text-anchor="middle" x="8918" y="-2094.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8918" y="-2079.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="8918" y="-2064.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="8918" y="-2049.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l2_attn_tp5&#45;&gt;l2_out_proj_tp5 -->
<g id="edge677" class="edge">
<title>l2_attn_tp5&#45;&gt;l2_out_proj_tp5</title>
<path fill="none" stroke="black" d="M8918,-2147.01C8918,-2138.56 8918,-2129.34 8918,-2120.47"/>
<polygon fill="black" stroke="black" points="8921.5,-2120.26 8918,-2110.26 8914.5,-2120.26 8921.5,-2120.26"/>
</g>
<!-- l2_out_proj_tp5&#45;&gt;l2_residual_tp5 -->
<g id="edge678" class="edge">
<title>l2_out_proj_tp5&#45;&gt;l2_residual_tp5</title>
<path fill="none" stroke="black" d="M8940.27,-2042C8946.09,-2033.34 8952.6,-2023.64 8959.25,-2013.74"/>
<polygon fill="black" stroke="black" points="8962.18,-2015.65 8964.85,-2005.4 8956.37,-2011.75 8962.18,-2015.65"/>
</g>
<!-- l2_gate_tp5 -->
<g id="node321" class="node">
<title>l2_gate_tp5</title>
<polygon fill="lightyellow" stroke="black" points="9049.2,-1832.17 8719.59,-1832.17 8634.8,-1696.17 8964.41,-1696.17 9049.2,-1832.17"/>
<text text-anchor="middle" x="8842" y="-1782.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="8842" y="-1767.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="8842" y="-1752.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="8842" y="-1737.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l2_residual_tp5&#45;&gt;l2_gate_tp5 -->
<g id="edge680" class="edge">
<title>l2_residual_tp5&#45;&gt;l2_gate_tp5</title>
<path fill="none" stroke="black" d="M8944.08,-1869.07C8934.63,-1859.46 8924.86,-1849.51 8915.28,-1839.76"/>
<polygon fill="black" stroke="black" points="8917.51,-1837.03 8908,-1832.35 8912.51,-1841.93 8917.51,-1837.03"/>
</g>
<!-- l2_exp0_gpu13 -->
<g id="node322" class="node">
<title>l2_exp0_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="8599,-1659.17 8425,-1659.17 8425,-1591.17 8599,-1591.17 8599,-1659.17"/>
<text text-anchor="middle" x="8512" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8512" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8512" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8512" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l2_residual_tp5&#45;&gt;l2_exp0_gpu13 -->
<g id="edge682" class="edge">
<title>l2_residual_tp5&#45;&gt;l2_exp0_gpu13</title>
<path fill="none" stroke="black" d="M8667.98,-1869.08C8636.66,-1858.03 8611.59,-1845.7 8598,-1832.17 8552.95,-1787.28 8530.32,-1715.3 8519.87,-1669.4"/>
<polygon fill="black" stroke="black" points="8523.26,-1668.49 8517.71,-1659.46 8516.42,-1669.98 8523.26,-1668.49"/>
</g>
<!-- l2_exp1_gpu13 -->
<g id="node323" class="node">
<title>l2_exp1_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="8407,-1659.17 8233,-1659.17 8233,-1591.17 8407,-1591.17 8407,-1659.17"/>
<text text-anchor="middle" x="8320" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="8320" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8320" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8320" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l2_residual_tp5&#45;&gt;l2_exp1_gpu13 -->
<g id="edge685" class="edge">
<title>l2_residual_tp5&#45;&gt;l2_exp1_gpu13</title>
<path fill="none" stroke="black" d="M8676.06,-1892.35C8622.6,-1877.71 8569.35,-1858.19 8522,-1832.17 8448.09,-1791.54 8384.01,-1715.23 8348.81,-1667.76"/>
<polygon fill="black" stroke="black" points="8351.52,-1665.53 8342.79,-1659.53 8345.87,-1669.67 8351.52,-1665.53"/>
</g>
<!-- l2_exp2_gpu13 -->
<g id="node324" class="node">
<title>l2_exp2_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="8791,-1659.17 8617,-1659.17 8617,-1591.17 8791,-1591.17 8791,-1659.17"/>
<text text-anchor="middle" x="8704" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="8704" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8704" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8704" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l2_residual_tp5&#45;&gt;l2_exp2_gpu13 -->
<g id="edge688" class="edge">
<title>l2_residual_tp5&#45;&gt;l2_exp2_gpu13</title>
<path fill="none" stroke="black" d="M8684.61,-1869.16C8657.54,-1858.2 8636.49,-1845.88 8626,-1832.17 8589.27,-1784.16 8601.37,-1751.37 8626,-1696.17 8630.92,-1685.13 8638.54,-1675.11 8647.12,-1666.32"/>
<polygon fill="black" stroke="black" points="8649.72,-1668.68 8654.52,-1659.23 8644.88,-1663.63 8649.72,-1668.68"/>
</g>
<!-- l2_exp3_gpu13 -->
<g id="node325" class="node">
<title>l2_exp3_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="9367,-1659.17 9193,-1659.17 9193,-1591.17 9367,-1591.17 9367,-1659.17"/>
<text text-anchor="middle" x="9280" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9280" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9280" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9280" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l2_residual_tp5&#45;&gt;l2_exp3_gpu13 -->
<g id="edge691" class="edge">
<title>l2_residual_tp5&#45;&gt;l2_exp3_gpu13</title>
<path fill="none" stroke="black" d="M9068.59,-1868.9C9122.14,-1807.42 9199.61,-1718.47 9244.38,-1667.06"/>
<polygon fill="black" stroke="black" points="9247.08,-1669.29 9251.01,-1659.45 9241.8,-1664.69 9247.08,-1669.29"/>
</g>
<!-- l2_exp4_gpu13 -->
<g id="node326" class="node">
<title>l2_exp4_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="9175,-1659.17 9001,-1659.17 9001,-1591.17 9175,-1591.17 9175,-1659.17"/>
<text text-anchor="middle" x="9088" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="9088" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9088" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9088" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l2_residual_tp5&#45;&gt;l2_exp4_gpu13 -->
<g id="edge694" class="edge">
<title>l2_residual_tp5&#45;&gt;l2_exp4_gpu13</title>
<path fill="none" stroke="black" d="M9064.83,-1868.99C9067.99,-1863.17 9070.78,-1857.2 9073,-1851.17 9095.1,-1791.04 9095.08,-1715.86 9092.18,-1669.43"/>
<polygon fill="black" stroke="black" points="9095.67,-1669.14 9091.48,-1659.4 9088.69,-1669.62 9095.67,-1669.14"/>
</g>
<!-- l2_exp5_gpu13 -->
<g id="node327" class="node">
<title>l2_exp5_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="8983,-1659.17 8809,-1659.17 8809,-1591.17 8983,-1591.17 8983,-1659.17"/>
<text text-anchor="middle" x="8896" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="8896" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8896" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8896" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l2_residual_tp5&#45;&gt;l2_exp5_gpu13 -->
<g id="edge697" class="edge">
<title>l2_residual_tp5&#45;&gt;l2_exp5_gpu13</title>
<path fill="none" stroke="black" d="M9046.01,-1869.11C9050.97,-1857.11 9055.29,-1844.5 9058,-1832.17 9064.48,-1802.65 9074.6,-1721.42 9058,-1696.17 9053.52,-1689.35 9024.74,-1676.09 8992.64,-1662.93"/>
<polygon fill="black" stroke="black" points="8993.64,-1659.56 8983.06,-1659.04 8991.01,-1666.05 8993.64,-1659.56"/>
</g>
<!-- l2_exp6_gpu13 -->
<g id="node328" class="node">
<title>l2_exp6_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="8215,-1659.17 8041,-1659.17 8041,-1591.17 8215,-1591.17 8215,-1659.17"/>
<text text-anchor="middle" x="8128" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="8128" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8128" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8128" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l2_residual_tp5&#45;&gt;l2_exp6_gpu13 -->
<g id="edge700" class="edge">
<title>l2_residual_tp5&#45;&gt;l2_exp6_gpu13</title>
<path fill="none" stroke="black" d="M8707.43,-1921.67C8596.39,-1907.59 8472.2,-1881.16 8367,-1832.17 8282.57,-1792.84 8204.86,-1714.88 8162.19,-1666.95"/>
<polygon fill="black" stroke="black" points="8164.63,-1664.43 8155.39,-1659.24 8159.38,-1669.05 8164.63,-1664.43"/>
</g>
<!-- l2_exp7_gpu13 -->
<g id="node329" class="node">
<title>l2_exp7_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="9559,-1659.17 9385,-1659.17 9385,-1591.17 9559,-1591.17 9559,-1659.17"/>
<text text-anchor="middle" x="9472" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="9472" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9472" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9472" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l2_residual_tp5&#45;&gt;l2_exp7_gpu13 -->
<g id="edge703" class="edge">
<title>l2_residual_tp5&#45;&gt;l2_exp7_gpu13</title>
<path fill="none" stroke="black" d="M9109.96,-1869.09C9202.83,-1806.78 9337.92,-1716.14 9414.1,-1665.02"/>
<polygon fill="black" stroke="black" points="9416.29,-1667.77 9422.64,-1659.29 9412.39,-1661.95 9416.29,-1667.77"/>
</g>
<!-- l2_final_res_tp5 -->
<g id="node331" class="node">
<title>l2_final_res_tp5</title>
<polygon fill="lightyellow" stroke="black" points="9365.93,-1381.17 8794.95,-1381.17 8648.07,-1245.17 9219.05,-1245.17 9365.93,-1381.17"/>
<text text-anchor="middle" x="9007" y="-1331.97" font-family="Times,serif" font-size="14.00">Layer 2 Final Residual</text>
<text text-anchor="middle" x="9007" y="-1316.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="9007" y="-1301.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="9007" y="-1286.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l2_residual_tp5&#45;&gt;l2_final_res_tp5 -->
<g id="edge706" class="edge">
<title>l2_residual_tp5&#45;&gt;l2_final_res_tp5</title>
<path fill="none" stroke="black" d="M9262.03,-1905.75C9413.84,-1880.12 9578,-1836.03 9578,-1765.17 9578,-1765.17 9578,-1765.17 9578,-1485.17 9578,-1428.37 9473,-1388.84 9353.06,-1362.21"/>
<polygon fill="black" stroke="black" points="9353.8,-1358.79 9343.28,-1360.07 9352.3,-1365.63 9353.8,-1358.79"/>
</g>
<!-- l2_gate_tp5&#45;&gt;l2_exp0_gpu13 -->
<g id="edge681" class="edge">
<title>l2_gate_tp5&#45;&gt;l2_exp0_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8680.38,-1696.07C8653.02,-1684.71 8625.52,-1673.3 8600.92,-1663.08"/>
<polygon fill="black" stroke="black" points="8602.22,-1659.83 8591.64,-1659.23 8599.53,-1666.3 8602.22,-1659.83"/>
</g>
<!-- l2_gate_tp5&#45;&gt;l2_exp1_gpu13 -->
<g id="edge684" class="edge">
<title>l2_gate_tp5&#45;&gt;l2_exp1_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8643.16,-1710.17C8598.48,-1698.8 8551.21,-1687.21 8507,-1677.17 8469.62,-1668.68 8457.5,-1669.69 8416.94,-1659.28"/>
<polygon fill="black" stroke="black" points="8417.78,-1655.88 8407.22,-1656.71 8416,-1662.65 8417.78,-1655.88"/>
</g>
<!-- l2_gate_tp5&#45;&gt;l2_exp2_gpu13 -->
<g id="edge687" class="edge">
<title>l2_gate_tp5&#45;&gt;l2_exp2_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8774.21,-1695.87C8764.1,-1685.83 8753.95,-1675.76 8744.64,-1666.51"/>
<polygon fill="black" stroke="black" points="8746.93,-1663.86 8737.37,-1659.29 8742,-1668.82 8746.93,-1663.86"/>
</g>
<!-- l2_gate_tp5&#45;&gt;l2_exp3_gpu13 -->
<g id="edge690" class="edge">
<title>l2_gate_tp5&#45;&gt;l2_exp3_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8980.88,-1722.17C9040.48,-1704.27 9111.07,-1682.67 9183.2,-1659.4"/>
<polygon fill="black" stroke="black" points="9184.49,-1662.66 9192.92,-1656.25 9182.33,-1656 9184.49,-1662.66"/>
</g>
<!-- l2_gate_tp5&#45;&gt;l2_exp4_gpu13 -->
<g id="edge693" class="edge">
<title>l2_gate_tp5&#45;&gt;l2_exp4_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8962.48,-1696.07C8982.07,-1685.16 9001.75,-1674.2 9019.52,-1664.3"/>
<polygon fill="black" stroke="black" points="9021.6,-1667.15 9028.63,-1659.23 9018.19,-1661.04 9021.6,-1667.15"/>
</g>
<!-- l2_gate_tp5&#45;&gt;l2_exp5_gpu13 -->
<g id="edge696" class="edge">
<title>l2_gate_tp5&#45;&gt;l2_exp5_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8868.53,-1695.87C8872.17,-1686.63 8875.82,-1677.35 8879.22,-1668.73"/>
<polygon fill="black" stroke="black" points="8882.53,-1669.88 8882.94,-1659.29 8876.02,-1667.31 8882.53,-1669.88"/>
</g>
<!-- l2_gate_tp5&#45;&gt;l2_exp6_gpu13 -->
<g id="edge699" class="edge">
<title>l2_gate_tp5&#45;&gt;l2_exp6_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8662.56,-1740.92C8541.01,-1723.96 8377,-1697.39 8225.18,-1659.34"/>
<polygon fill="black" stroke="black" points="8225.75,-1655.88 8215.19,-1656.82 8224.03,-1662.66 8225.75,-1655.88"/>
</g>
<!-- l2_gate_tp5&#45;&gt;l2_exp7_gpu13 -->
<g id="edge702" class="edge">
<title>l2_gate_tp5&#45;&gt;l2_exp7_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8991.74,-1739.73C9096.86,-1721.92 9240.6,-1694.86 9374.73,-1659.4"/>
<polygon fill="black" stroke="black" points="9376.02,-1662.68 9384.78,-1656.72 9374.22,-1655.91 9376.02,-1662.68"/>
</g>
<!-- l2_exp_agg_tp5 -->
<g id="node330" class="node">
<title>l2_exp_agg_tp5</title>
<polygon fill="lightyellow" stroke="black" points="9115.58,-1554.17 8766.28,-1554.17 8676.42,-1418.17 9025.72,-1418.17 9115.58,-1554.17"/>
<text text-anchor="middle" x="8896" y="-1504.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8896" y="-1489.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="8896" y="-1474.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="8896" y="-1459.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l2_exp0_gpu13&#45;&gt;l2_exp_agg_tp5 -->
<g id="edge683" class="edge">
<title>l2_exp0_gpu13&#45;&gt;l2_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8599.14,-1593.08C8642.38,-1577.65 8695.85,-1558.57 8745.45,-1540.88"/>
<polygon fill="black" stroke="black" points="8746.75,-1544.13 8754.99,-1537.48 8744.39,-1537.54 8746.75,-1544.13"/>
</g>
<!-- l2_exp1_gpu13&#45;&gt;l2_exp_agg_tp5 -->
<g id="edge686" class="edge">
<title>l2_exp1_gpu13&#45;&gt;l2_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8407.24,-1593.69C8410.19,-1592.82 8413.11,-1591.97 8416,-1591.17 8519.61,-1562.24 8637.66,-1536.57 8730.77,-1517.97"/>
<polygon fill="black" stroke="black" points="8731.72,-1521.35 8740.85,-1515.96 8730.35,-1514.48 8731.72,-1521.35"/>
</g>
<!-- l2_exp2_gpu13&#45;&gt;l2_exp_agg_tp5 -->
<g id="edge689" class="edge">
<title>l2_exp2_gpu13&#45;&gt;l2_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8750.48,-1591C8763.59,-1581.65 8778.39,-1571.08 8793.42,-1560.36"/>
<polygon fill="black" stroke="black" points="8795.67,-1563.06 8801.78,-1554.4 8791.6,-1557.36 8795.67,-1563.06"/>
</g>
<!-- l2_exp3_gpu13&#45;&gt;l2_exp_agg_tp5 -->
<g id="edge692" class="edge">
<title>l2_exp3_gpu13&#45;&gt;l2_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M9192.86,-1593.08C9163.13,-1582.47 9128.56,-1570.14 9093.73,-1557.71"/>
<polygon fill="black" stroke="black" points="9094.5,-1554.27 9083.91,-1554.21 9092.15,-1560.86 9094.5,-1554.27"/>
</g>
<!-- l2_exp4_gpu13&#45;&gt;l2_exp_agg_tp5 -->
<g id="edge695" class="edge">
<title>l2_exp4_gpu13&#45;&gt;l2_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M9041.52,-1591C9028.41,-1581.65 9013.61,-1571.08 8998.58,-1560.36"/>
<polygon fill="black" stroke="black" points="9000.4,-1557.36 8990.22,-1554.4 8996.33,-1563.06 9000.4,-1557.36"/>
</g>
<!-- l2_exp5_gpu13&#45;&gt;l2_exp_agg_tp5 -->
<g id="edge698" class="edge">
<title>l2_exp5_gpu13&#45;&gt;l2_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8896,-1591C8896,-1582.86 8896,-1573.8 8896,-1564.52"/>
<polygon fill="black" stroke="black" points="8899.5,-1564.4 8896,-1554.4 8892.5,-1564.4 8899.5,-1564.4"/>
</g>
<!-- l2_exp6_gpu13&#45;&gt;l2_exp_agg_tp5 -->
<g id="edge701" class="edge">
<title>l2_exp6_gpu13&#45;&gt;l2_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8215.18,-1593.46C8218.15,-1592.65 8221.09,-1591.89 8224,-1591.17 8391.29,-1549.82 8586.29,-1521.81 8723.01,-1505.37"/>
<polygon fill="black" stroke="black" points="8723.65,-1508.82 8733.16,-1504.16 8722.82,-1501.87 8723.65,-1508.82"/>
</g>
<!-- l2_exp7_gpu13&#45;&gt;l2_exp_agg_tp5 -->
<g id="edge704" class="edge">
<title>l2_exp7_gpu13&#45;&gt;l2_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M9384.76,-1593.69C9381.81,-1592.82 9378.89,-1591.97 9376,-1591.17 9288.51,-1566.74 9190.71,-1544.64 9106.34,-1527.15"/>
<polygon fill="black" stroke="black" points="9106.88,-1523.69 9096.38,-1525.09 9105.47,-1530.54 9106.88,-1523.69"/>
</g>
<!-- l2_exp_agg_tp5&#45;&gt;l2_final_res_tp5 -->
<g id="edge705" class="edge">
<title>l2_exp_agg_tp5&#45;&gt;l2_final_res_tp5</title>
<path fill="none" stroke="black" d="M8939.55,-1418.07C8945.55,-1408.83 8951.74,-1399.29 8957.84,-1389.91"/>
<polygon fill="black" stroke="black" points="8960.88,-1391.64 8963.39,-1381.35 8955.01,-1387.83 8960.88,-1391.64"/>
</g>
<!-- l3_qkv_tp5 -->
<g id="node437" class="node">
<title>l3_qkv_tp5</title>
<polygon fill="lightgreen" stroke="black" points="9023,-1208.17 8797,-1208.17 8797,-1140.17 9023,-1140.17 9023,-1208.17"/>
<text text-anchor="middle" x="8910" y="-1192.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8910" y="-1177.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="8910" y="-1162.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="8910" y="-1147.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l2_final_res_tp5&#45;&gt;l3_qkv_tp5 -->
<g id="edge934" class="edge">
<title>l2_final_res_tp5&#45;&gt;l3_qkv_tp5</title>
<path fill="none" stroke="black" d="M8959.35,-1244.87C8952.53,-1235.23 8945.68,-1225.56 8939.35,-1216.62"/>
<polygon fill="black" stroke="black" points="8942.09,-1214.43 8933.46,-1208.29 8936.38,-1218.48 8942.09,-1214.43"/>
</g>
<!-- l3_residual_tp5 -->
<g id="node440" class="node">
<title>l3_residual_tp5</title>
<polygon fill="lightyellow" stroke="black" points="9368.93,-893.17 8797.95,-893.17 8651.07,-757.17 9222.05,-757.17 9368.93,-893.17"/>
<text text-anchor="middle" x="9010" y="-843.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9010" y="-828.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="9010" y="-813.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="9010" y="-798.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l2_final_res_tp5&#45;&gt;l3_residual_tp5 -->
<g id="edge938" class="edge">
<title>l2_final_res_tp5&#45;&gt;l3_residual_tp5</title>
<path fill="none" stroke="black" d="M9031.21,-1245.09C9037.23,-1223.1 9042,-1198.36 9042,-1175.17 9042,-1175.17 9042,-1175.17 9042,-963.17 9042,-943.51 9038.84,-922.68 9034.5,-903.34"/>
<polygon fill="black" stroke="black" points="9037.85,-902.31 9032.14,-893.39 9031.04,-903.92 9037.85,-902.31"/>
</g>
<!-- l2_attn_tp6 -->
<g id="node333" class="node">
<title>l2_attn_tp6</title>
<polygon fill="lightgreen" stroke="black" points="10298,-2215.17 10084,-2215.17 10084,-2147.17 10298,-2147.17 10298,-2215.17"/>
<text text-anchor="middle" x="10191" y="-2199.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="10191" y="-2184.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="10191" y="-2169.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="10191" y="-2154.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l2_qkv_tp6&#45;&gt;l2_attn_tp6 -->
<g id="edge707" class="edge">
<title>l2_qkv_tp6&#45;&gt;l2_attn_tp6</title>
<path fill="none" stroke="black" d="M10254.06,-2252.01C10245.68,-2242.73 10236.48,-2232.53 10227.75,-2222.87"/>
<polygon fill="black" stroke="black" points="10230.18,-2220.34 10220.88,-2215.26 10224.99,-2225.03 10230.18,-2220.34"/>
</g>
<!-- l2_residual_tp6 -->
<g id="node335" class="node">
<title>l2_residual_tp6</title>
<polygon fill="lightyellow" stroke="black" points="10643.93,-2005.17 10072.95,-2005.17 9926.07,-1869.17 10497.05,-1869.17 10643.93,-2005.17"/>
<text text-anchor="middle" x="10285" y="-1955.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10285" y="-1940.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="10285" y="-1925.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="10285" y="-1910.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l2_qkv_tp6&#45;&gt;l2_residual_tp6 -->
<g id="edge710" class="edge">
<title>l2_qkv_tp6&#45;&gt;l2_residual_tp6</title>
<path fill="none" stroke="black" d="M10297.33,-2251.88C10301.26,-2240.44 10305.04,-2227.42 10307,-2215.17 10309.35,-2200.48 10308.01,-2061.34 10306,-2042.17 10305.09,-2033.45 10303.79,-2024.38 10302.28,-2015.39"/>
<polygon fill="black" stroke="black" points="10305.68,-2014.53 10300.49,-2005.29 10298.79,-2015.75 10305.68,-2014.53"/>
</g>
<!-- l2_out_proj_tp6 -->
<g id="node334" class="node">
<title>l2_out_proj_tp6</title>
<polygon fill="lightgreen" stroke="black" points="10297,-2110.17 10085,-2110.17 10085,-2042.17 10297,-2042.17 10297,-2110.17"/>
<text text-anchor="middle" x="10191" y="-2094.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10191" y="-2079.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="10191" y="-2064.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="10191" y="-2049.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l2_attn_tp6&#45;&gt;l2_out_proj_tp6 -->
<g id="edge708" class="edge">
<title>l2_attn_tp6&#45;&gt;l2_out_proj_tp6</title>
<path fill="none" stroke="black" d="M10191,-2147.01C10191,-2138.56 10191,-2129.34 10191,-2120.47"/>
<polygon fill="black" stroke="black" points="10194.5,-2120.26 10191,-2110.26 10187.5,-2120.26 10194.5,-2120.26"/>
</g>
<!-- l2_out_proj_tp6&#45;&gt;l2_residual_tp6 -->
<g id="edge709" class="edge">
<title>l2_out_proj_tp6&#45;&gt;l2_residual_tp6</title>
<path fill="none" stroke="black" d="M10213.75,-2042C10219.7,-2033.34 10226.35,-2023.64 10233.14,-2013.74"/>
<polygon fill="black" stroke="black" points="10236.1,-2015.63 10238.87,-2005.4 10230.33,-2011.67 10236.1,-2015.63"/>
</g>
<!-- l2_gate_tp6 -->
<g id="node336" class="node">
<title>l2_gate_tp6</title>
<polygon fill="lightyellow" stroke="black" points="10659.2,-1832.17 10329.59,-1832.17 10244.8,-1696.17 10574.41,-1696.17 10659.2,-1832.17"/>
<text text-anchor="middle" x="10452" y="-1782.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="10452" y="-1767.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="10452" y="-1752.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="10452" y="-1737.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l2_residual_tp6&#45;&gt;l2_gate_tp6 -->
<g id="edge711" class="edge">
<title>l2_residual_tp6&#45;&gt;l2_gate_tp6</title>
<path fill="none" stroke="black" d="M10350.52,-1869.07C10359.92,-1859.46 10369.63,-1849.51 10379.15,-1839.76"/>
<polygon fill="black" stroke="black" points="10381.91,-1841.95 10386.39,-1832.35 10376.9,-1837.06 10381.91,-1841.95"/>
</g>
<!-- l2_exp0_gpu14 -->
<g id="node337" class="node">
<title>l2_exp0_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="9963,-1659.17 9789,-1659.17 9789,-1591.17 9963,-1591.17 9963,-1659.17"/>
<text text-anchor="middle" x="9876" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="9876" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9876" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9876" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l2_residual_tp6&#45;&gt;l2_exp0_gpu14 -->
<g id="edge713" class="edge">
<title>l2_residual_tp6&#45;&gt;l2_exp0_gpu14</title>
<path fill="none" stroke="black" d="M10160.84,-1869.01C10141.72,-1857.37 10122.52,-1844.89 10105,-1832.17 10033.84,-1780.47 9959.58,-1710.16 9915.59,-1666.5"/>
<polygon fill="black" stroke="black" points="9917.82,-1663.78 9908.26,-1659.2 9912.87,-1668.74 9917.82,-1663.78"/>
</g>
<!-- l2_exp1_gpu14 -->
<g id="node338" class="node">
<title>l2_exp1_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="10155,-1659.17 9981,-1659.17 9981,-1591.17 10155,-1591.17 10155,-1659.17"/>
<text text-anchor="middle" x="10068" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="10068" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10068" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10068" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l2_residual_tp6&#45;&gt;l2_exp1_gpu14 -->
<g id="edge716" class="edge">
<title>l2_residual_tp6&#45;&gt;l2_exp1_gpu14</title>
<path fill="none" stroke="black" d="M10226.57,-1868.96C10216.75,-1856.93 10206.87,-1844.34 10198,-1832.17 10158.12,-1777.45 10117.27,-1710.59 10092.27,-1668.19"/>
<polygon fill="black" stroke="black" points="10095.26,-1666.37 10087.18,-1659.52 10089.23,-1669.92 10095.26,-1666.37"/>
</g>
<!-- l2_exp2_gpu14 -->
<g id="node339" class="node">
<title>l2_exp2_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="9771,-1659.17 9597,-1659.17 9597,-1591.17 9771,-1591.17 9771,-1659.17"/>
<text text-anchor="middle" x="9684" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="9684" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9684" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9684" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l2_residual_tp6&#45;&gt;l2_exp2_gpu14 -->
<g id="edge719" class="edge">
<title>l2_residual_tp6&#45;&gt;l2_exp2_gpu14</title>
<path fill="none" stroke="black" d="M10025.56,-1869.12C9996.72,-1858.28 9968.3,-1846 9942,-1832.17 9856.76,-1787.35 9772.28,-1712.63 9724.28,-1666.56"/>
<polygon fill="black" stroke="black" points="9726.51,-1663.85 9716.89,-1659.42 9721.65,-1668.89 9726.51,-1663.85"/>
</g>
<!-- l2_exp3_gpu14 -->
<g id="node340" class="node">
<title>l2_exp3_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="10347,-1659.17 10173,-1659.17 10173,-1591.17 10347,-1591.17 10347,-1659.17"/>
<text text-anchor="middle" x="10260" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="10260" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10260" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10260" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l2_residual_tp6&#45;&gt;l2_exp3_gpu14 -->
<g id="edge722" class="edge">
<title>l2_residual_tp6&#45;&gt;l2_exp3_gpu14</title>
<path fill="none" stroke="black" d="M10228.71,-1868.96C10225.66,-1863.17 10223.02,-1857.21 10221,-1851.17 10196.48,-1777.82 10196.2,-1750.42 10221,-1677.17 10222.05,-1674.05 10223.38,-1670.98 10224.91,-1667.98"/>
<polygon fill="black" stroke="black" points="10228,-1669.63 10230.01,-1659.22 10221.95,-1666.1 10228,-1669.63"/>
</g>
<!-- l2_exp4_gpu14 -->
<g id="node341" class="node">
<title>l2_exp4_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="11115,-1659.17 10941,-1659.17 10941,-1591.17 11115,-1591.17 11115,-1659.17"/>
<text text-anchor="middle" x="11028" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="11028" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11028" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11028" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l2_residual_tp6&#45;&gt;l2_exp4_gpu14 -->
<g id="edge725" class="edge">
<title>l2_residual_tp6&#45;&gt;l2_exp4_gpu14</title>
<path fill="none" stroke="black" d="M10530.43,-1899.87C10600.73,-1884.32 10676.13,-1862.5 10742,-1832.17 10836.3,-1788.74 10931.22,-1712.4 10984.52,-1665.84"/>
<polygon fill="black" stroke="black" points="10986.88,-1668.43 10992.08,-1659.2 10982.26,-1663.17 10986.88,-1668.43"/>
</g>
<!-- l2_exp5_gpu14 -->
<g id="node342" class="node">
<title>l2_exp5_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="10539,-1659.17 10365,-1659.17 10365,-1591.17 10539,-1591.17 10539,-1659.17"/>
<text text-anchor="middle" x="10452" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10452" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10452" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10452" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l2_residual_tp6&#45;&gt;l2_exp5_gpu14 -->
<g id="edge728" class="edge">
<title>l2_residual_tp6&#45;&gt;l2_exp5_gpu14</title>
<path fill="none" stroke="black" d="M10245.21,-1868.98C10220.25,-1817.16 10199.13,-1746.12 10236,-1696.17 10267.33,-1653.72 10299.24,-1673.92 10355,-1659.17"/>
<polygon fill="black" stroke="black" points="10356.32,-1662.43 10364.92,-1656.24 10354.34,-1655.71 10356.32,-1662.43"/>
</g>
<!-- l2_exp6_gpu14 -->
<g id="node343" class="node">
<title>l2_exp6_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="10923,-1659.17 10749,-1659.17 10749,-1591.17 10923,-1591.17 10923,-1659.17"/>
<text text-anchor="middle" x="10836" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="10836" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10836" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10836" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l2_residual_tp6&#45;&gt;l2_exp6_gpu14 -->
<g id="edge731" class="edge">
<title>l2_residual_tp6&#45;&gt;l2_exp6_gpu14</title>
<path fill="none" stroke="black" d="M10538.86,-1907.69C10590.89,-1892.01 10641.93,-1868.19 10682,-1832.17 10736.48,-1783.19 10784.38,-1712.38 10811.76,-1667.84"/>
<polygon fill="black" stroke="black" points="10814.75,-1669.66 10816.96,-1659.29 10808.77,-1666.02 10814.75,-1669.66"/>
</g>
<!-- l2_exp7_gpu14 -->
<g id="node344" class="node">
<title>l2_exp7_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="10731,-1659.17 10557,-1659.17 10557,-1591.17 10731,-1591.17 10731,-1659.17"/>
<text text-anchor="middle" x="10644" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="10644" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10644" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10644" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l2_residual_tp6&#45;&gt;l2_exp7_gpu14 -->
<g id="edge734" class="edge">
<title>l2_residual_tp6&#45;&gt;l2_exp7_gpu14</title>
<path fill="none" stroke="black" d="M10525.58,-1895.29C10590.4,-1879.13 10648.15,-1858.13 10668,-1832.17 10703.94,-1785.17 10683.85,-1713.64 10664.86,-1668.43"/>
<polygon fill="black" stroke="black" points="10668.04,-1666.97 10660.84,-1659.2 10661.62,-1669.76 10668.04,-1666.97"/>
</g>
<!-- l2_final_res_tp6 -->
<g id="node346" class="node">
<title>l2_final_res_tp6</title>
<polygon fill="lightyellow" stroke="black" points="10812.93,-1381.17 10241.95,-1381.17 10095.07,-1245.17 10666.05,-1245.17 10812.93,-1381.17"/>
<text text-anchor="middle" x="10454" y="-1331.97" font-family="Times,serif" font-size="14.00">Layer 2 Final Residual</text>
<text text-anchor="middle" x="10454" y="-1316.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="10454" y="-1301.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="10454" y="-1286.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l2_residual_tp6&#45;&gt;l2_final_res_tp6 -->
<g id="edge737" class="edge">
<title>l2_residual_tp6&#45;&gt;l2_final_res_tp6</title>
<path fill="none" stroke="black" d="M10565.35,-1932.29C10812.64,-1921.01 11134,-1883.57 11134,-1765.17 11134,-1765.17 11134,-1765.17 11134,-1485.17 11134,-1404.52 10951.85,-1361.55 10776.1,-1338.86"/>
<polygon fill="black" stroke="black" points="10776.5,-1335.38 10766.14,-1337.59 10775.62,-1342.32 10776.5,-1335.38"/>
</g>
<!-- l2_gate_tp6&#45;&gt;l2_exp0_gpu14 -->
<g id="edge712" class="edge">
<title>l2_gate_tp6&#45;&gt;l2_exp0_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10260.9,-1722.3C10145.39,-1697.52 10013.98,-1669.15 9972.95,-1659.14"/>
<polygon fill="black" stroke="black" points="9973.8,-1655.74 9963.24,-1656.64 9972.06,-1662.52 9973.8,-1655.74"/>
</g>
<!-- l2_gate_tp6&#45;&gt;l2_exp1_gpu14 -->
<g id="edge715" class="edge">
<title>l2_gate_tp6&#45;&gt;l2_exp1_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10263.94,-1696.07C10229.64,-1683.84 10195.18,-1671.54 10164.93,-1660.75"/>
<polygon fill="black" stroke="black" points="10165.86,-1657.36 10155.26,-1657.3 10163.51,-1663.96 10165.86,-1657.36"/>
</g>
<!-- l2_gate_tp6&#45;&gt;l2_exp2_gpu14 -->
<g id="edge718" class="edge">
<title>l2_gate_tp6&#45;&gt;l2_exp2_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10274.86,-1744.46C10140.9,-1728.27 9952.74,-1701.13 9780.91,-1659.26"/>
<polygon fill="black" stroke="black" points="9781.73,-1655.86 9771.18,-1656.87 9780.06,-1662.65 9781.73,-1655.86"/>
</g>
<!-- l2_gate_tp6&#45;&gt;l2_exp3_gpu14 -->
<g id="edge721" class="edge">
<title>l2_gate_tp6&#45;&gt;l2_exp3_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10357.97,-1696.07C10343.18,-1685.52 10328.32,-1674.92 10314.81,-1665.28"/>
<polygon fill="black" stroke="black" points="10316.76,-1662.36 10306.58,-1659.41 10312.69,-1668.06 10316.76,-1662.36"/>
</g>
<!-- l2_gate_tp6&#45;&gt;l2_exp4_gpu14 -->
<g id="edge724" class="edge">
<title>l2_gate_tp6&#45;&gt;l2_exp4_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10599.36,-1735.91C10692.28,-1717.61 10814.73,-1691.45 10930.97,-1659.36"/>
<polygon fill="black" stroke="black" points="10932.06,-1662.69 10940.76,-1656.64 10930.19,-1655.95 10932.06,-1662.69"/>
</g>
<!-- l2_gate_tp6&#45;&gt;l2_exp5_gpu14 -->
<g id="edge727" class="edge">
<title>l2_gate_tp6&#45;&gt;l2_exp5_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10452,-1695.87C10452,-1686.93 10452,-1677.95 10452,-1669.56"/>
<polygon fill="black" stroke="black" points="10455.5,-1669.29 10452,-1659.29 10448.5,-1669.29 10455.5,-1669.29"/>
</g>
<!-- l2_gate_tp6&#45;&gt;l2_exp6_gpu14 -->
<g id="edge730" class="edge">
<title>l2_gate_tp6&#45;&gt;l2_exp6_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10586.57,-1715.15C10636.83,-1697.22 10692.87,-1677.23 10739.08,-1660.74"/>
<polygon fill="black" stroke="black" points="10740.54,-1663.94 10748.79,-1657.28 10738.19,-1657.35 10740.54,-1663.94"/>
</g>
<!-- l2_gate_tp6&#45;&gt;l2_exp7_gpu14 -->
<g id="edge733" class="edge">
<title>l2_gate_tp6&#45;&gt;l2_exp7_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10546.03,-1696.07C10560.82,-1685.52 10575.68,-1674.92 10589.19,-1665.28"/>
<polygon fill="black" stroke="black" points="10591.31,-1668.06 10597.42,-1659.41 10587.24,-1662.36 10591.31,-1668.06"/>
</g>
<!-- l2_exp_agg_tp6 -->
<g id="node345" class="node">
<title>l2_exp_agg_tp6</title>
<polygon fill="lightyellow" stroke="black" points="10671.58,-1554.17 10322.28,-1554.17 10232.42,-1418.17 10581.72,-1418.17 10671.58,-1554.17"/>
<text text-anchor="middle" x="10452" y="-1504.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10452" y="-1489.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="10452" y="-1474.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="10452" y="-1459.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l2_exp0_gpu14&#45;&gt;l2_exp_agg_tp6 -->
<g id="edge714" class="edge">
<title>l2_exp0_gpu14&#45;&gt;l2_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M9963.24,-1593.69C9966.19,-1592.82 9969.11,-1591.97 9972,-1591.17 10075.61,-1562.24 10193.66,-1536.57 10286.77,-1517.97"/>
<polygon fill="black" stroke="black" points="10287.72,-1521.35 10296.85,-1515.96 10286.35,-1514.48 10287.72,-1521.35"/>
</g>
<!-- l2_exp1_gpu14&#45;&gt;l2_exp_agg_tp6 -->
<g id="edge717" class="edge">
<title>l2_exp1_gpu14&#45;&gt;l2_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10155.14,-1593.08C10198.38,-1577.65 10251.85,-1558.57 10301.45,-1540.88"/>
<polygon fill="black" stroke="black" points="10302.75,-1544.13 10310.99,-1537.48 10300.39,-1537.54 10302.75,-1544.13"/>
</g>
<!-- l2_exp2_gpu14&#45;&gt;l2_exp_agg_tp6 -->
<g id="edge720" class="edge">
<title>l2_exp2_gpu14&#45;&gt;l2_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M9771.18,-1593.46C9774.15,-1592.65 9777.09,-1591.89 9780,-1591.17 9947.29,-1549.82 10142.29,-1521.81 10279.01,-1505.37"/>
<polygon fill="black" stroke="black" points="10279.65,-1508.82 10289.16,-1504.16 10278.82,-1501.87 10279.65,-1508.82"/>
</g>
<!-- l2_exp3_gpu14&#45;&gt;l2_exp_agg_tp6 -->
<g id="edge723" class="edge">
<title>l2_exp3_gpu14&#45;&gt;l2_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10306.48,-1591C10319.59,-1581.65 10334.39,-1571.08 10349.42,-1560.36"/>
<polygon fill="black" stroke="black" points="10351.67,-1563.06 10357.78,-1554.4 10347.6,-1557.36 10351.67,-1563.06"/>
</g>
<!-- l2_exp4_gpu14&#45;&gt;l2_exp_agg_tp6 -->
<g id="edge726" class="edge">
<title>l2_exp4_gpu14&#45;&gt;l2_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10940.76,-1593.69C10937.81,-1592.82 10934.89,-1591.97 10932,-1591.17 10844.51,-1566.74 10746.71,-1544.64 10662.34,-1527.15"/>
<polygon fill="black" stroke="black" points="10662.88,-1523.69 10652.38,-1525.09 10661.47,-1530.54 10662.88,-1523.69"/>
</g>
<!-- l2_exp5_gpu14&#45;&gt;l2_exp_agg_tp6 -->
<g id="edge729" class="edge">
<title>l2_exp5_gpu14&#45;&gt;l2_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10452,-1591C10452,-1582.86 10452,-1573.8 10452,-1564.52"/>
<polygon fill="black" stroke="black" points="10455.5,-1564.4 10452,-1554.4 10448.5,-1564.4 10455.5,-1564.4"/>
</g>
<!-- l2_exp6_gpu14&#45;&gt;l2_exp_agg_tp6 -->
<g id="edge732" class="edge">
<title>l2_exp6_gpu14&#45;&gt;l2_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10748.86,-1593.08C10719.13,-1582.47 10684.56,-1570.14 10649.73,-1557.71"/>
<polygon fill="black" stroke="black" points="10650.5,-1554.27 10639.91,-1554.21 10648.15,-1560.86 10650.5,-1554.27"/>
</g>
<!-- l2_exp7_gpu14&#45;&gt;l2_exp_agg_tp6 -->
<g id="edge735" class="edge">
<title>l2_exp7_gpu14&#45;&gt;l2_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10597.52,-1591C10584.41,-1581.65 10569.61,-1571.08 10554.58,-1560.36"/>
<polygon fill="black" stroke="black" points="10556.4,-1557.36 10546.22,-1554.4 10552.33,-1563.06 10556.4,-1557.36"/>
</g>
<!-- l2_exp_agg_tp6&#45;&gt;l2_final_res_tp6 -->
<g id="edge736" class="edge">
<title>l2_exp_agg_tp6&#45;&gt;l2_final_res_tp6</title>
<path fill="none" stroke="black" d="M10452.78,-1418.07C10452.89,-1409.4 10452.99,-1400.46 10453.09,-1391.63"/>
<polygon fill="black" stroke="black" points="10456.6,-1391.39 10453.21,-1381.35 10449.6,-1391.3 10456.6,-1391.39"/>
</g>
<!-- l3_qkv_tp6 -->
<g id="node452" class="node">
<title>l3_qkv_tp6</title>
<polygon fill="lightgreen" stroke="black" points="10563,-1208.17 10337,-1208.17 10337,-1140.17 10563,-1140.17 10563,-1208.17"/>
<text text-anchor="middle" x="10450" y="-1192.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10450" y="-1177.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="10450" y="-1162.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="10450" y="-1147.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l2_final_res_tp6&#45;&gt;l3_qkv_tp6 -->
<g id="edge967" class="edge">
<title>l2_final_res_tp6&#45;&gt;l3_qkv_tp6</title>
<path fill="none" stroke="black" d="M10452.04,-1244.87C10451.77,-1235.93 10451.51,-1226.95 10451.27,-1218.56"/>
<polygon fill="black" stroke="black" points="10454.76,-1218.19 10450.97,-1208.29 10447.76,-1218.39 10454.76,-1218.19"/>
</g>
<!-- l3_residual_tp6 -->
<g id="node455" class="node">
<title>l3_residual_tp6</title>
<polygon fill="lightyellow" stroke="black" points="10810.93,-893.17 10239.95,-893.17 10093.07,-757.17 10664.05,-757.17 10810.93,-893.17"/>
<text text-anchor="middle" x="10452" y="-843.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10452" y="-828.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="10452" y="-813.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="10452" y="-798.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l2_final_res_tp6&#45;&gt;l3_residual_tp6 -->
<g id="edge971" class="edge">
<title>l2_final_res_tp6&#45;&gt;l3_residual_tp6</title>
<path fill="none" stroke="black" d="M10551.34,-1244.96C10569.03,-1225.22 10582,-1201.7 10582,-1175.17 10582,-1175.17 10582,-1175.17 10582,-963.17 10582,-940.14 10572.21,-919.43 10558.01,-901.5"/>
<polygon fill="black" stroke="black" points="10560.33,-898.83 10551.19,-893.47 10554.99,-903.36 10560.33,-898.83"/>
</g>
<!-- l2_attn_tp7 -->
<g id="node348" class="node">
<title>l2_attn_tp7</title>
<polygon fill="lightgreen" stroke="black" points="12128,-2215.17 11914,-2215.17 11914,-2147.17 12128,-2147.17 12128,-2215.17"/>
<text text-anchor="middle" x="12021" y="-2199.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="12021" y="-2184.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="12021" y="-2169.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="12021" y="-2154.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l2_qkv_tp7&#45;&gt;l2_attn_tp7 -->
<g id="edge738" class="edge">
<title>l2_qkv_tp7&#45;&gt;l2_attn_tp7</title>
<path fill="none" stroke="black" d="M12027.1,-2252.01C12026.36,-2243.56 12025.56,-2234.34 12024.78,-2225.47"/>
<polygon fill="black" stroke="black" points="12028.25,-2224.92 12023.89,-2215.26 12021.28,-2225.53 12028.25,-2224.92"/>
</g>
<!-- l2_residual_tp7 -->
<g id="node350" class="node">
<title>l2_residual_tp7</title>
<polygon fill="lightyellow" stroke="black" points="12479.93,-2005.17 11908.95,-2005.17 11762.07,-1869.17 12333.05,-1869.17 12479.93,-2005.17"/>
<text text-anchor="middle" x="12121" y="-1955.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12121" y="-1940.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="12121" y="-1925.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="12121" y="-1910.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l2_qkv_tp7&#45;&gt;l2_residual_tp7 -->
<g id="edge741" class="edge">
<title>l2_qkv_tp7&#45;&gt;l2_residual_tp7</title>
<path fill="none" stroke="black" d="M12102.41,-2252.02C12116.28,-2242.2 12128.97,-2230.01 12137,-2215.17 12170.09,-2153.98 12160.76,-2073.69 12146.34,-2015.32"/>
<polygon fill="black" stroke="black" points="12149.67,-2014.23 12143.79,-2005.41 12142.89,-2015.97 12149.67,-2014.23"/>
</g>
<!-- l2_out_proj_tp7 -->
<g id="node349" class="node">
<title>l2_out_proj_tp7</title>
<polygon fill="lightgreen" stroke="black" points="12128,-2110.17 11916,-2110.17 11916,-2042.17 12128,-2042.17 12128,-2110.17"/>
<text text-anchor="middle" x="12022" y="-2094.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12022" y="-2079.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="12022" y="-2064.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="12022" y="-2049.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l2_attn_tp7&#45;&gt;l2_out_proj_tp7 -->
<g id="edge739" class="edge">
<title>l2_attn_tp7&#45;&gt;l2_out_proj_tp7</title>
<path fill="none" stroke="black" d="M12021.32,-2147.01C12021.4,-2138.56 12021.49,-2129.34 12021.58,-2120.47"/>
<polygon fill="black" stroke="black" points="12025.08,-2120.29 12021.68,-2110.26 12018.08,-2120.23 12025.08,-2120.29"/>
</g>
<!-- l2_out_proj_tp7&#45;&gt;l2_residual_tp7 -->
<g id="edge740" class="edge">
<title>l2_out_proj_tp7&#45;&gt;l2_residual_tp7</title>
<path fill="none" stroke="black" d="M12045.97,-2042C12052.22,-2033.34 12059.23,-2023.64 12066.39,-2013.74"/>
<polygon fill="black" stroke="black" points="12069.4,-2015.56 12072.42,-2005.4 12063.72,-2011.46 12069.4,-2015.56"/>
</g>
<!-- l2_gate_tp7 -->
<g id="node351" class="node">
<title>l2_gate_tp7</title>
<polygon fill="lightyellow" stroke="black" points="12161.2,-1832.17 11831.59,-1832.17 11746.8,-1696.17 12076.41,-1696.17 12161.2,-1832.17"/>
<text text-anchor="middle" x="11954" y="-1782.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="11954" y="-1767.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="11954" y="-1752.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="11954" y="-1737.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l2_residual_tp7&#45;&gt;l2_gate_tp7 -->
<g id="edge742" class="edge">
<title>l2_residual_tp7&#45;&gt;l2_gate_tp7</title>
<path fill="none" stroke="black" d="M12055.48,-1869.07C12046.08,-1859.46 12036.37,-1849.51 12026.85,-1839.76"/>
<polygon fill="black" stroke="black" points="12029.1,-1837.06 12019.61,-1832.35 12024.09,-1841.95 12029.1,-1837.06"/>
</g>
<!-- l2_exp0_gpu15 -->
<g id="node352" class="node">
<title>l2_exp0_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="11711,-1659.17 11537,-1659.17 11537,-1591.17 11711,-1591.17 11711,-1659.17"/>
<text text-anchor="middle" x="11624" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="11624" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11624" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11624" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l2_residual_tp7&#45;&gt;l2_exp0_gpu15 -->
<g id="edge744" class="edge">
<title>l2_residual_tp7&#45;&gt;l2_exp0_gpu15</title>
<path fill="none" stroke="black" d="M11779.81,-1869.03C11748.56,-1857.98 11723.56,-1845.67 11710,-1832.17 11664.95,-1787.28 11642.32,-1715.3 11631.87,-1669.4"/>
<polygon fill="black" stroke="black" points="11635.26,-1668.49 11629.71,-1659.46 11628.42,-1669.98 11635.26,-1668.49"/>
</g>
<!-- l2_exp1_gpu15 -->
<g id="node353" class="node">
<title>l2_exp1_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="11519,-1659.17 11345,-1659.17 11345,-1591.17 11519,-1591.17 11519,-1659.17"/>
<text text-anchor="middle" x="11432" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="11432" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11432" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11432" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l2_residual_tp7&#45;&gt;l2_exp1_gpu15 -->
<g id="edge747" class="edge">
<title>l2_residual_tp7&#45;&gt;l2_exp1_gpu15</title>
<path fill="none" stroke="black" d="M11786.46,-1891.92C11733.54,-1877.34 11680.87,-1857.94 11634,-1832.17 11560.09,-1791.52 11496.02,-1715.22 11460.81,-1667.75"/>
<polygon fill="black" stroke="black" points="11463.52,-1665.53 11454.79,-1659.53 11457.88,-1669.66 11463.52,-1665.53"/>
</g>
<!-- l2_exp2_gpu15 -->
<g id="node354" class="node">
<title>l2_exp2_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="11327,-1659.17 11153,-1659.17 11153,-1591.17 11327,-1591.17 11327,-1659.17"/>
<text text-anchor="middle" x="11240" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="11240" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11240" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11240" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l2_residual_tp7&#45;&gt;l2_exp2_gpu15 -->
<g id="edge750" class="edge">
<title>l2_residual_tp7&#45;&gt;l2_exp2_gpu15</title>
<path fill="none" stroke="black" d="M11818.5,-1921.55C11707.73,-1907.45 11583.91,-1881.04 11479,-1832.17 11394.57,-1792.83 11316.86,-1714.87 11274.19,-1666.95"/>
<polygon fill="black" stroke="black" points="11276.63,-1664.42 11267.39,-1659.23 11271.38,-1669.05 11276.63,-1664.42"/>
</g>
<!-- l2_exp3_gpu15 -->
<g id="node355" class="node">
<title>l2_exp3_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="11903,-1659.17 11729,-1659.17 11729,-1591.17 11903,-1591.17 11903,-1659.17"/>
<text text-anchor="middle" x="11816" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="11816" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11816" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11816" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l2_residual_tp7&#45;&gt;l2_exp3_gpu15 -->
<g id="edge753" class="edge">
<title>l2_residual_tp7&#45;&gt;l2_exp3_gpu15</title>
<path fill="none" stroke="black" d="M11796.45,-1869.1C11769.45,-1858.16 11748.46,-1845.85 11738,-1832.17 11701.28,-1784.15 11713.37,-1751.37 11738,-1696.17 11742.92,-1685.13 11750.54,-1675.11 11759.12,-1666.32"/>
<polygon fill="black" stroke="black" points="11761.72,-1668.68 11766.52,-1659.23 11756.88,-1663.63 11761.72,-1668.68"/>
</g>
<!-- l2_exp4_gpu15 -->
<g id="node356" class="node">
<title>l2_exp4_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="12479,-1659.17 12305,-1659.17 12305,-1591.17 12479,-1591.17 12479,-1659.17"/>
<text text-anchor="middle" x="12392" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="12392" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="12392" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="12392" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l2_residual_tp7&#45;&gt;l2_exp4_gpu15 -->
<g id="edge756" class="edge">
<title>l2_residual_tp7&#45;&gt;l2_exp4_gpu15</title>
<path fill="none" stroke="black" d="M12179.8,-1868.9C12233.55,-1807.42 12311.31,-1718.47 12356.25,-1667.06"/>
<polygon fill="black" stroke="black" points="12358.96,-1669.28 12362.9,-1659.45 12353.69,-1664.68 12358.96,-1669.28"/>
</g>
<!-- l2_exp5_gpu15 -->
<g id="node357" class="node">
<title>l2_exp5_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="12671,-1659.17 12497,-1659.17 12497,-1591.17 12671,-1591.17 12671,-1659.17"/>
<text text-anchor="middle" x="12584" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="12584" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="12584" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="12584" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l2_residual_tp7&#45;&gt;l2_exp5_gpu15 -->
<g id="edge759" class="edge">
<title>l2_residual_tp7&#45;&gt;l2_exp5_gpu15</title>
<path fill="none" stroke="black" d="M12221.18,-1869.09C12314.25,-1806.78 12449.63,-1716.14 12525.97,-1665.02"/>
<polygon fill="black" stroke="black" points="12528.17,-1667.76 12534.53,-1659.29 12524.28,-1661.94 12528.17,-1667.76"/>
</g>
<!-- l2_exp6_gpu15 -->
<g id="node358" class="node">
<title>l2_exp6_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="12287,-1659.17 12113,-1659.17 12113,-1591.17 12287,-1591.17 12287,-1659.17"/>
<text text-anchor="middle" x="12200" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="12200" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="12200" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="12200" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l2_residual_tp7&#45;&gt;l2_exp6_gpu15 -->
<g id="edge762" class="edge">
<title>l2_residual_tp7&#45;&gt;l2_exp6_gpu15</title>
<path fill="none" stroke="black" d="M12176.7,-1869.05C12179.91,-1863.22 12182.75,-1857.23 12185,-1851.17 12207.32,-1791.12 12207.24,-1715.92 12204.27,-1669.46"/>
<polygon fill="black" stroke="black" points="12207.76,-1669.16 12203.56,-1659.43 12200.78,-1669.65 12207.76,-1669.16"/>
</g>
<!-- l2_exp7_gpu15 -->
<g id="node359" class="node">
<title>l2_exp7_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="12095,-1659.17 11921,-1659.17 11921,-1591.17 12095,-1591.17 12095,-1659.17"/>
<text text-anchor="middle" x="12008" y="-1643.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="12008" y="-1628.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="12008" y="-1613.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="12008" y="-1598.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l2_residual_tp7&#45;&gt;l2_exp7_gpu15 -->
<g id="edge765" class="edge">
<title>l2_residual_tp7&#45;&gt;l2_exp7_gpu15</title>
<path fill="none" stroke="black" d="M12157.88,-1868.89C12162.89,-1856.97 12167.25,-1844.44 12170,-1832.17 12176.6,-1802.67 12186.6,-1721.42 12170,-1696.17 12165.52,-1689.35 12136.74,-1676.09 12104.64,-1662.93"/>
<polygon fill="black" stroke="black" points="12105.64,-1659.56 12095.06,-1659.04 12103.01,-1666.05 12105.64,-1659.56"/>
</g>
<!-- l2_final_res_tp7 -->
<g id="node361" class="node">
<title>l2_final_res_tp7</title>
<polygon fill="lightyellow" stroke="black" points="12387.93,-1381.17 11816.95,-1381.17 11670.07,-1245.17 12241.05,-1245.17 12387.93,-1381.17"/>
<text text-anchor="middle" x="12029" y="-1331.97" font-family="Times,serif" font-size="14.00">Layer 2 Final Residual</text>
<text text-anchor="middle" x="12029" y="-1316.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="12029" y="-1301.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="12029" y="-1286.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l2_residual_tp7&#45;&gt;l2_final_res_tp7 -->
<g id="edge768" class="edge">
<title>l2_residual_tp7&#45;&gt;l2_final_res_tp7</title>
<path fill="none" stroke="black" d="M12373.06,-1905.89C12525.25,-1880.31 12690,-1836.21 12690,-1765.17 12690,-1765.17 12690,-1765.17 12690,-1485.17 12690,-1408.53 12521.38,-1365.69 12354.47,-1342.05"/>
<polygon fill="black" stroke="black" points="12354.88,-1338.58 12344.5,-1340.66 12353.92,-1345.51 12354.88,-1338.58"/>
</g>
<!-- l2_gate_tp7&#45;&gt;l2_exp0_gpu15 -->
<g id="edge743" class="edge">
<title>l2_gate_tp7&#45;&gt;l2_exp0_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11792.38,-1696.07C11765.02,-1684.71 11737.52,-1673.3 11712.92,-1663.08"/>
<polygon fill="black" stroke="black" points="11714.22,-1659.83 11703.64,-1659.23 11711.53,-1666.3 11714.22,-1659.83"/>
</g>
<!-- l2_gate_tp7&#45;&gt;l2_exp1_gpu15 -->
<g id="edge746" class="edge">
<title>l2_gate_tp7&#45;&gt;l2_exp1_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11757.17,-1713.18C11708.78,-1701.14 11657.07,-1688.5 11609,-1677.17 11575.91,-1669.37 11565.16,-1669.16 11529.01,-1659.34"/>
<polygon fill="black" stroke="black" points="11529.82,-1655.93 11519.25,-1656.62 11527.94,-1662.67 11529.82,-1655.93"/>
</g>
<!-- l2_gate_tp7&#45;&gt;l2_exp2_gpu15 -->
<g id="edge749" class="edge">
<title>l2_gate_tp7&#45;&gt;l2_exp2_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11774.56,-1740.92C11653.01,-1723.96 11489,-1697.39 11337.18,-1659.34"/>
<polygon fill="black" stroke="black" points="11337.75,-1655.88 11327.19,-1656.82 11336.03,-1662.66 11337.75,-1655.88"/>
</g>
<!-- l2_gate_tp7&#45;&gt;l2_exp3_gpu15 -->
<g id="edge752" class="edge">
<title>l2_gate_tp7&#45;&gt;l2_exp3_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11886.21,-1695.87C11876.1,-1685.83 11865.95,-1675.76 11856.64,-1666.51"/>
<polygon fill="black" stroke="black" points="11858.93,-1663.86 11849.37,-1659.29 11854,-1668.82 11858.93,-1663.86"/>
</g>
<!-- l2_gate_tp7&#45;&gt;l2_exp4_gpu15 -->
<g id="edge755" class="edge">
<title>l2_gate_tp7&#45;&gt;l2_exp4_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12092.88,-1722.17C12152.48,-1704.27 12223.07,-1682.67 12295.2,-1659.4"/>
<polygon fill="black" stroke="black" points="12296.49,-1662.66 12304.92,-1656.25 12294.33,-1656 12296.49,-1662.66"/>
</g>
<!-- l2_gate_tp7&#45;&gt;l2_exp5_gpu15 -->
<g id="edge758" class="edge">
<title>l2_gate_tp7&#45;&gt;l2_exp5_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12103.74,-1739.73C12208.86,-1721.92 12352.6,-1694.86 12486.73,-1659.4"/>
<polygon fill="black" stroke="black" points="12488.02,-1662.68 12496.78,-1656.72 12486.22,-1655.91 12488.02,-1662.68"/>
</g>
<!-- l2_gate_tp7&#45;&gt;l2_exp6_gpu15 -->
<g id="edge761" class="edge">
<title>l2_gate_tp7&#45;&gt;l2_exp6_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12074.48,-1696.07C12094.07,-1685.16 12113.75,-1674.2 12131.52,-1664.3"/>
<polygon fill="black" stroke="black" points="12133.6,-1667.15 12140.63,-1659.23 12130.19,-1661.04 12133.6,-1667.15"/>
</g>
<!-- l2_gate_tp7&#45;&gt;l2_exp7_gpu15 -->
<g id="edge764" class="edge">
<title>l2_gate_tp7&#45;&gt;l2_exp7_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11980.53,-1695.87C11984.17,-1686.63 11987.82,-1677.35 11991.22,-1668.73"/>
<polygon fill="black" stroke="black" points="11994.53,-1669.88 11994.94,-1659.29 11988.02,-1667.31 11994.53,-1669.88"/>
</g>
<!-- l2_exp_agg_tp7 -->
<g id="node360" class="node">
<title>l2_exp_agg_tp7</title>
<polygon fill="lightyellow" stroke="black" points="12227.58,-1554.17 11878.28,-1554.17 11788.42,-1418.17 12137.72,-1418.17 12227.58,-1554.17"/>
<text text-anchor="middle" x="12008" y="-1504.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12008" y="-1489.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="12008" y="-1474.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="12008" y="-1459.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l2_exp0_gpu15&#45;&gt;l2_exp_agg_tp7 -->
<g id="edge745" class="edge">
<title>l2_exp0_gpu15&#45;&gt;l2_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11711.14,-1593.08C11754.38,-1577.65 11807.85,-1558.57 11857.45,-1540.88"/>
<polygon fill="black" stroke="black" points="11858.75,-1544.13 11866.99,-1537.48 11856.39,-1537.54 11858.75,-1544.13"/>
</g>
<!-- l2_exp1_gpu15&#45;&gt;l2_exp_agg_tp7 -->
<g id="edge748" class="edge">
<title>l2_exp1_gpu15&#45;&gt;l2_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11519.24,-1593.69C11522.19,-1592.82 11525.11,-1591.97 11528,-1591.17 11631.61,-1562.24 11749.66,-1536.57 11842.77,-1517.97"/>
<polygon fill="black" stroke="black" points="11843.72,-1521.35 11852.85,-1515.96 11842.35,-1514.48 11843.72,-1521.35"/>
</g>
<!-- l2_exp2_gpu15&#45;&gt;l2_exp_agg_tp7 -->
<g id="edge751" class="edge">
<title>l2_exp2_gpu15&#45;&gt;l2_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11327.18,-1593.46C11330.15,-1592.65 11333.09,-1591.89 11336,-1591.17 11503.29,-1549.82 11698.29,-1521.81 11835.01,-1505.37"/>
<polygon fill="black" stroke="black" points="11835.65,-1508.82 11845.16,-1504.16 11834.82,-1501.87 11835.65,-1508.82"/>
</g>
<!-- l2_exp3_gpu15&#45;&gt;l2_exp_agg_tp7 -->
<g id="edge754" class="edge">
<title>l2_exp3_gpu15&#45;&gt;l2_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11862.48,-1591C11875.59,-1581.65 11890.39,-1571.08 11905.42,-1560.36"/>
<polygon fill="black" stroke="black" points="11907.67,-1563.06 11913.78,-1554.4 11903.6,-1557.36 11907.67,-1563.06"/>
</g>
<!-- l2_exp4_gpu15&#45;&gt;l2_exp_agg_tp7 -->
<g id="edge757" class="edge">
<title>l2_exp4_gpu15&#45;&gt;l2_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M12304.86,-1593.08C12275.13,-1582.47 12240.56,-1570.14 12205.73,-1557.71"/>
<polygon fill="black" stroke="black" points="12206.5,-1554.27 12195.91,-1554.21 12204.15,-1560.86 12206.5,-1554.27"/>
</g>
<!-- l2_exp5_gpu15&#45;&gt;l2_exp_agg_tp7 -->
<g id="edge760" class="edge">
<title>l2_exp5_gpu15&#45;&gt;l2_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M12496.76,-1593.69C12493.81,-1592.82 12490.89,-1591.97 12488,-1591.17 12400.51,-1566.74 12302.71,-1544.64 12218.34,-1527.15"/>
<polygon fill="black" stroke="black" points="12218.88,-1523.69 12208.38,-1525.09 12217.47,-1530.54 12218.88,-1523.69"/>
</g>
<!-- l2_exp6_gpu15&#45;&gt;l2_exp_agg_tp7 -->
<g id="edge763" class="edge">
<title>l2_exp6_gpu15&#45;&gt;l2_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M12153.52,-1591C12140.41,-1581.65 12125.61,-1571.08 12110.58,-1560.36"/>
<polygon fill="black" stroke="black" points="12112.4,-1557.36 12102.22,-1554.4 12108.33,-1563.06 12112.4,-1557.36"/>
</g>
<!-- l2_exp7_gpu15&#45;&gt;l2_exp_agg_tp7 -->
<g id="edge766" class="edge">
<title>l2_exp7_gpu15&#45;&gt;l2_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M12008,-1591C12008,-1582.86 12008,-1573.8 12008,-1564.52"/>
<polygon fill="black" stroke="black" points="12011.5,-1564.4 12008,-1554.4 12004.5,-1564.4 12011.5,-1564.4"/>
</g>
<!-- l2_exp_agg_tp7&#45;&gt;l2_final_res_tp7 -->
<g id="edge767" class="edge">
<title>l2_exp_agg_tp7&#45;&gt;l2_final_res_tp7</title>
<path fill="none" stroke="black" d="M12016.24,-1418.07C12017.32,-1409.3 12018.43,-1400.26 12019.52,-1391.34"/>
<polygon fill="black" stroke="black" points="12023,-1391.7 12020.75,-1381.35 12016.06,-1390.85 12023,-1391.7"/>
</g>
<!-- l3_qkv_tp7 -->
<g id="node467" class="node">
<title>l3_qkv_tp7</title>
<polygon fill="lightgreen" stroke="black" points="12038,-1208.17 11812,-1208.17 11812,-1140.17 12038,-1140.17 12038,-1208.17"/>
<text text-anchor="middle" x="11925" y="-1192.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11925" y="-1177.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="11925" y="-1162.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16,512]</text>
<text text-anchor="middle" x="11925" y="-1147.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l2_final_res_tp7&#45;&gt;l3_qkv_tp7 -->
<g id="edge1000" class="edge">
<title>l2_final_res_tp7&#45;&gt;l3_qkv_tp7</title>
<path fill="none" stroke="black" d="M11977.91,-1244.87C11970.52,-1235.13 11963.1,-1225.36 11956.26,-1216.34"/>
<polygon fill="black" stroke="black" points="11958.98,-1214.14 11950.15,-1208.29 11953.41,-1218.38 11958.98,-1214.14"/>
</g>
<!-- l3_residual_tp7 -->
<g id="node470" class="node">
<title>l3_residual_tp7</title>
<polygon fill="lightyellow" stroke="black" points="12352.93,-893.17 11781.95,-893.17 11635.07,-757.17 12206.05,-757.17 12352.93,-893.17"/>
<text text-anchor="middle" x="11994" y="-843.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11994" y="-828.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="11994" y="-813.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="11994" y="-798.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l2_final_res_tp7&#45;&gt;l3_residual_tp7 -->
<g id="edge1004" class="edge">
<title>l2_final_res_tp7&#45;&gt;l3_residual_tp7</title>
<path fill="none" stroke="black" d="M12048.29,-1245.13C12053.14,-1223.04 12057,-1198.23 12057,-1175.17 12057,-1175.17 12057,-1175.17 12057,-963.17 12057,-942.58 12051.06,-921.72 12042.82,-902.69"/>
<polygon fill="black" stroke="black" points="12045.96,-901.13 12038.61,-893.5 12039.59,-904.05 12045.96,-901.13"/>
</g>
<!-- l3_attn_tp0 -->
<g id="node363" class="node">
<title>l3_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="1161,-1103.17 947,-1103.17 947,-1035.17 1161,-1035.17 1161,-1103.17"/>
<text text-anchor="middle" x="1054" y="-1087.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1054" y="-1072.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="1054" y="-1057.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="1054" y="-1042.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l3_qkv_tp0&#45;&gt;l3_attn_tp0 -->
<g id="edge770" class="edge">
<title>l3_qkv_tp0&#45;&gt;l3_attn_tp0</title>
<path fill="none" stroke="black" d="M1051.97,-1140.01C1052.21,-1131.56 1052.48,-1122.34 1052.74,-1113.47"/>
<polygon fill="black" stroke="black" points="1056.24,-1113.36 1053.04,-1103.26 1049.25,-1113.16 1056.24,-1113.36"/>
</g>
<!-- l3_out_proj_tp0 -->
<g id="node364" class="node">
<title>l3_out_proj_tp0</title>
<polygon fill="lightgreen" stroke="black" points="1163,-998.17 951,-998.17 951,-930.17 1163,-930.17 1163,-998.17"/>
<text text-anchor="middle" x="1057" y="-982.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1057" y="-967.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="1057" y="-952.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="1057" y="-937.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l3_attn_tp0&#45;&gt;l3_out_proj_tp0 -->
<g id="edge771" class="edge">
<title>l3_attn_tp0&#45;&gt;l3_out_proj_tp0</title>
<path fill="none" stroke="black" d="M1054.97,-1035.01C1055.21,-1026.56 1055.48,-1017.34 1055.74,-1008.47"/>
<polygon fill="black" stroke="black" points="1059.24,-1008.36 1056.04,-998.26 1052.25,-1008.16 1059.24,-1008.36"/>
</g>
<!-- l3_out_proj_tp0&#45;&gt;l3_residual_tp0 -->
<g id="edge772" class="edge">
<title>l3_out_proj_tp0&#45;&gt;l3_residual_tp0</title>
<path fill="none" stroke="black" d="M1062.81,-930C1064.24,-921.86 1065.82,-912.8 1067.45,-903.52"/>
<polygon fill="black" stroke="black" points="1070.94,-903.85 1069.22,-893.4 1064.05,-902.65 1070.94,-903.85"/>
</g>
<!-- l3_gate_tp0 -->
<g id="node366" class="node">
<title>l3_gate_tp0</title>
<polygon fill="lightyellow" stroke="black" points="1323.2,-720.17 993.59,-720.17 908.8,-584.17 1238.41,-584.17 1323.2,-720.17"/>
<text text-anchor="middle" x="1116" y="-670.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="1116" y="-655.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="1116" y="-640.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="1116" y="-625.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l3_residual_tp0&#45;&gt;l3_gate_tp0 -->
<g id="edge774" class="edge">
<title>l3_residual_tp0&#45;&gt;l3_gate_tp0</title>
<path fill="none" stroke="black" d="M1094.73,-757.07C1096.53,-748.3 1098.38,-739.26 1100.2,-730.34"/>
<polygon fill="black" stroke="black" points="1103.67,-730.85 1102.25,-720.35 1096.82,-729.44 1103.67,-730.85"/>
</g>
<!-- l3_exp0_gpu8 -->
<g id="node367" class="node">
<title>l3_exp0_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="1203,-547.17 1029,-547.17 1029,-479.17 1203,-479.17 1203,-547.17"/>
<text text-anchor="middle" x="1116" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1116" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1116" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1116" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l3_residual_tp0&#45;&gt;l3_exp0_gpu8 -->
<g id="edge776" class="edge">
<title>l3_residual_tp0&#45;&gt;l3_exp0_gpu8</title>
<path fill="none" stroke="black" d="M931.05,-757.08C918.82,-746.37 908.08,-734.12 900,-720.17 869.72,-667.85 864.1,-632.8 900,-584.17 931.33,-541.72 963.24,-561.92 1019,-547.17"/>
<polygon fill="black" stroke="black" points="1020.32,-550.43 1028.92,-544.24 1018.34,-543.71 1020.32,-550.43"/>
</g>
<!-- l3_exp1_gpu8 -->
<g id="node368" class="node">
<title>l3_exp1_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="1011,-547.17 837,-547.17 837,-479.17 1011,-479.17 1011,-547.17"/>
<text text-anchor="middle" x="924" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="924" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="924" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="924" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l3_residual_tp0&#45;&gt;l3_exp1_gpu8 -->
<g id="edge779" class="edge">
<title>l3_residual_tp0&#45;&gt;l3_exp1_gpu8</title>
<path fill="none" stroke="black" d="M906.29,-756.9C893.98,-746.33 883.21,-734.16 875,-720.17 844.41,-668.03 856.83,-641.81 875,-584.17 878.08,-574.4 883.06,-564.82 888.69,-556.03"/>
<polygon fill="black" stroke="black" points="891.75,-557.75 894.49,-547.52 885.96,-553.81 891.75,-557.75"/>
</g>
<!-- l3_exp2_gpu8 -->
<g id="node369" class="node">
<title>l3_exp2_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="435,-547.17 261,-547.17 261,-479.17 435,-479.17 435,-547.17"/>
<text text-anchor="middle" x="348" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="348" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="348" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="348" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l3_residual_tp0&#45;&gt;l3_exp2_gpu8 -->
<g id="edge782" class="edge">
<title>l3_residual_tp0&#45;&gt;l3_exp2_gpu8</title>
<path fill="none" stroke="black" d="M738.97,-772.98C689.34,-759.31 639.9,-742.02 595,-720.17 509.93,-678.76 429.27,-601.93 384.45,-554.7"/>
<polygon fill="black" stroke="black" points="386.97,-552.27 377.56,-547.38 381.87,-557.06 386.97,-552.27"/>
</g>
<!-- l3_exp3_gpu8 -->
<g id="node370" class="node">
<title>l3_exp3_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="627,-547.17 453,-547.17 453,-479.17 627,-479.17 627,-547.17"/>
<text text-anchor="middle" x="540" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="540" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="540" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="540" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l3_residual_tp0&#45;&gt;l3_exp3_gpu8 -->
<g id="edge785" class="edge">
<title>l3_residual_tp0&#45;&gt;l3_exp3_gpu8</title>
<path fill="none" stroke="black" d="M833.04,-757.07C806.97,-746.3 781.45,-734.04 758,-720.17 683.02,-675.8 612.92,-601.43 573.36,-555.23"/>
<polygon fill="black" stroke="black" points="575.95,-552.86 566.81,-547.5 570.61,-557.39 575.95,-552.86"/>
</g>
<!-- l3_exp4_gpu8 -->
<g id="node371" class="node">
<title>l3_exp4_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="819,-547.17 645,-547.17 645,-479.17 819,-479.17 819,-547.17"/>
<text text-anchor="middle" x="732" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="732" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="732" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="732" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l3_residual_tp0&#45;&gt;l3_exp4_gpu8 -->
<g id="edge788" class="edge">
<title>l3_residual_tp0&#45;&gt;l3_exp4_gpu8</title>
<path fill="none" stroke="black" d="M898.45,-757.13C881.54,-746.4 865.66,-734.14 852,-720.17 804.82,-671.92 769.06,-601.57 749.32,-556.85"/>
<polygon fill="black" stroke="black" points="752.42,-555.21 745.23,-547.43 746,-558 752.42,-555.21"/>
</g>
<!-- l3_exp5_gpu8 -->
<g id="node372" class="node">
<title>l3_exp5_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="1587,-547.17 1413,-547.17 1413,-479.17 1587,-479.17 1587,-547.17"/>
<text text-anchor="middle" x="1500" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="1500" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1500" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1500" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l3_residual_tp0&#45;&gt;l3_exp5_gpu8 -->
<g id="edge791" class="edge">
<title>l3_residual_tp0&#45;&gt;l3_exp5_gpu8</title>
<path fill="none" stroke="black" d="M1287.01,-757.13C1299.05,-751.49 1310.8,-745.5 1322,-739.17 1397.05,-696.72 1451.99,-608.8 1479.7,-556.31"/>
<polygon fill="black" stroke="black" points="1482.9,-557.74 1484.4,-547.26 1476.69,-554.52 1482.9,-557.74"/>
</g>
<!-- l3_exp6_gpu8 -->
<g id="node373" class="node">
<title>l3_exp6_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="1779,-547.17 1605,-547.17 1605,-479.17 1779,-479.17 1779,-547.17"/>
<text text-anchor="middle" x="1692" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1692" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1692" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1692" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l3_residual_tp0&#45;&gt;l3_exp6_gpu8 -->
<g id="edge794" class="edge">
<title>l3_residual_tp0&#45;&gt;l3_exp6_gpu8</title>
<path fill="none" stroke="black" d="M1302.96,-765.95C1340.55,-752.92 1378.53,-737.67 1413,-720.17 1503.13,-674.41 1595.03,-600.07 1647.62,-554.32"/>
<polygon fill="black" stroke="black" points="1650.19,-556.73 1655.41,-547.51 1645.58,-551.46 1650.19,-556.73"/>
</g>
<!-- l3_exp7_gpu8 -->
<g id="node374" class="node">
<title>l3_exp7_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="1395,-547.17 1221,-547.17 1221,-479.17 1395,-479.17 1395,-547.17"/>
<text text-anchor="middle" x="1308" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="1308" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1308" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1308" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l3_residual_tp0&#45;&gt;l3_exp7_gpu8 -->
<g id="edge797" class="edge">
<title>l3_residual_tp0&#45;&gt;l3_exp7_gpu8</title>
<path fill="none" stroke="black" d="M1295.11,-759C1309.35,-748.01 1321.98,-735.17 1332,-720.17 1364.61,-671.36 1345.95,-601.16 1328.1,-556.62"/>
<polygon fill="black" stroke="black" points="1331.27,-555.14 1324.2,-547.25 1324.81,-557.83 1331.27,-555.14"/>
</g>
<!-- l3_final_res_tp0 -->
<g id="node376" class="node">
<title>l3_final_res_tp0</title>
<polygon fill="lightyellow" stroke="black" points="2156.93,-269.17 1585.95,-269.17 1439.07,-133.17 2010.05,-133.17 2156.93,-269.17"/>
<text text-anchor="middle" x="1798" y="-219.97" font-family="Times,serif" font-size="14.00">Layer 3 Final Residual</text>
<text text-anchor="middle" x="1798" y="-204.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="1798" y="-189.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="1798" y="-174.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l3_residual_tp0&#45;&gt;l3_final_res_tp0 -->
<g id="edge800" class="edge">
<title>l3_residual_tp0&#45;&gt;l3_final_res_tp0</title>
<path fill="none" stroke="black" d="M1350.02,-809.67C1553.48,-791.07 1798,-748.82 1798,-653.17 1798,-653.17 1798,-653.17 1798,-373.17 1798,-342.63 1798,-309.02 1798,-279.74"/>
<polygon fill="black" stroke="black" points="1801.5,-279.58 1798,-269.58 1794.5,-279.58 1801.5,-279.58"/>
</g>
<!-- l3_gate_tp0&#45;&gt;l3_exp0_gpu8 -->
<g id="edge775" class="edge">
<title>l3_gate_tp0&#45;&gt;l3_exp0_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1116,-583.87C1116,-574.93 1116,-565.95 1116,-557.56"/>
<polygon fill="black" stroke="black" points="1119.5,-557.29 1116,-547.29 1112.5,-557.29 1119.5,-557.29"/>
</g>
<!-- l3_gate_tp0&#45;&gt;l3_exp1_gpu8 -->
<g id="edge778" class="edge">
<title>l3_gate_tp0&#45;&gt;l3_exp1_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1021.97,-584.07C1007.18,-573.52 992.32,-562.92 978.81,-553.28"/>
<polygon fill="black" stroke="black" points="980.76,-550.36 970.58,-547.41 976.69,-556.06 980.76,-550.36"/>
</g>
<!-- l3_gate_tp0&#45;&gt;l3_exp2_gpu8 -->
<g id="edge781" class="edge">
<title>l3_gate_tp0&#45;&gt;l3_exp2_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M938.86,-632.46C804.9,-616.27 616.74,-589.13 444.91,-547.26"/>
<polygon fill="black" stroke="black" points="445.73,-543.86 435.18,-544.87 444.06,-550.65 445.73,-543.86"/>
</g>
<!-- l3_gate_tp0&#45;&gt;l3_exp3_gpu8 -->
<g id="edge784" class="edge">
<title>l3_gate_tp0&#45;&gt;l3_exp3_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M916.59,-596.86C870.02,-585.34 820.46,-574.01 774,-565.17 716.2,-554.17 697.98,-560.59 636.91,-547.19"/>
<polygon fill="black" stroke="black" points="637.69,-543.77 627.16,-544.96 636.13,-550.6 637.69,-543.77"/>
</g>
<!-- l3_gate_tp0&#45;&gt;l3_exp4_gpu8 -->
<g id="edge787" class="edge">
<title>l3_gate_tp0&#45;&gt;l3_exp4_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M927.94,-584.07C893.64,-571.84 859.18,-559.54 828.93,-548.75"/>
<polygon fill="black" stroke="black" points="829.86,-545.36 819.26,-545.3 827.51,-551.96 829.86,-545.36"/>
</g>
<!-- l3_gate_tp0&#45;&gt;l3_exp5_gpu8 -->
<g id="edge790" class="edge">
<title>l3_gate_tp0&#45;&gt;l3_exp5_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1250.57,-603.15C1300.83,-585.22 1356.87,-565.23 1403.08,-548.74"/>
<polygon fill="black" stroke="black" points="1404.54,-551.94 1412.79,-545.28 1402.19,-545.35 1404.54,-551.94"/>
</g>
<!-- l3_gate_tp0&#45;&gt;l3_exp6_gpu8 -->
<g id="edge793" class="edge">
<title>l3_gate_tp0&#45;&gt;l3_exp6_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1263.36,-623.91C1356.28,-605.61 1478.73,-579.45 1594.97,-547.36"/>
<polygon fill="black" stroke="black" points="1596.06,-550.69 1604.76,-544.64 1594.19,-543.95 1596.06,-550.69"/>
</g>
<!-- l3_gate_tp0&#45;&gt;l3_exp7_gpu8 -->
<g id="edge796" class="edge">
<title>l3_gate_tp0&#45;&gt;l3_exp7_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1210.03,-584.07C1224.82,-573.52 1239.68,-562.92 1253.19,-553.28"/>
<polygon fill="black" stroke="black" points="1255.31,-556.06 1261.42,-547.41 1251.24,-550.36 1255.31,-556.06"/>
</g>
<!-- l3_exp_agg_tp0 -->
<g id="node375" class="node">
<title>l3_exp_agg_tp0</title>
<polygon fill="lightyellow" stroke="black" points="1335.58,-442.17 986.28,-442.17 896.42,-306.17 1245.72,-306.17 1335.58,-442.17"/>
<text text-anchor="middle" x="1116" y="-392.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1116" y="-377.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="1116" y="-362.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="1116" y="-347.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l3_exp0_gpu8&#45;&gt;l3_exp_agg_tp0 -->
<g id="edge777" class="edge">
<title>l3_exp0_gpu8&#45;&gt;l3_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M1116,-479C1116,-470.86 1116,-461.8 1116,-452.52"/>
<polygon fill="black" stroke="black" points="1119.5,-452.4 1116,-442.4 1112.5,-452.4 1119.5,-452.4"/>
</g>
<!-- l3_exp1_gpu8&#45;&gt;l3_exp_agg_tp0 -->
<g id="edge780" class="edge">
<title>l3_exp1_gpu8&#45;&gt;l3_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M970.48,-479C983.59,-469.65 998.39,-459.08 1013.42,-448.36"/>
<polygon fill="black" stroke="black" points="1015.67,-451.06 1021.78,-442.4 1011.6,-445.36 1015.67,-451.06"/>
</g>
<!-- l3_exp2_gpu8&#45;&gt;l3_exp_agg_tp0 -->
<g id="edge783" class="edge">
<title>l3_exp2_gpu8&#45;&gt;l3_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M435.18,-481.46C438.15,-480.65 441.09,-479.89 444,-479.17 611.29,-437.82 806.29,-409.81 943.01,-393.37"/>
<polygon fill="black" stroke="black" points="943.65,-396.82 953.16,-392.16 942.82,-389.87 943.65,-396.82"/>
</g>
<!-- l3_exp3_gpu8&#45;&gt;l3_exp_agg_tp0 -->
<g id="edge786" class="edge">
<title>l3_exp3_gpu8&#45;&gt;l3_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M627.24,-481.69C630.19,-480.82 633.11,-479.97 636,-479.17 739.61,-450.24 857.66,-424.57 950.77,-405.97"/>
<polygon fill="black" stroke="black" points="951.72,-409.35 960.85,-403.96 950.35,-402.48 951.72,-409.35"/>
</g>
<!-- l3_exp4_gpu8&#45;&gt;l3_exp_agg_tp0 -->
<g id="edge789" class="edge">
<title>l3_exp4_gpu8&#45;&gt;l3_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M819.14,-481.08C862.38,-465.65 915.85,-446.57 965.45,-428.88"/>
<polygon fill="black" stroke="black" points="966.75,-432.13 974.99,-425.48 964.39,-425.54 966.75,-432.13"/>
</g>
<!-- l3_exp5_gpu8&#45;&gt;l3_exp_agg_tp0 -->
<g id="edge792" class="edge">
<title>l3_exp5_gpu8&#45;&gt;l3_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M1412.86,-481.08C1383.13,-470.47 1348.56,-458.14 1313.73,-445.71"/>
<polygon fill="black" stroke="black" points="1314.5,-442.27 1303.91,-442.21 1312.15,-448.86 1314.5,-442.27"/>
</g>
<!-- l3_exp6_gpu8&#45;&gt;l3_exp_agg_tp0 -->
<g id="edge795" class="edge">
<title>l3_exp6_gpu8&#45;&gt;l3_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M1604.76,-481.69C1601.81,-480.82 1598.89,-479.97 1596,-479.17 1508.51,-454.74 1410.71,-432.64 1326.34,-415.15"/>
<polygon fill="black" stroke="black" points="1326.88,-411.69 1316.38,-413.09 1325.47,-418.54 1326.88,-411.69"/>
</g>
<!-- l3_exp7_gpu8&#45;&gt;l3_exp_agg_tp0 -->
<g id="edge798" class="edge">
<title>l3_exp7_gpu8&#45;&gt;l3_exp_agg_tp0</title>
<path fill="none" stroke="black" d="M1261.52,-479C1248.41,-469.65 1233.61,-459.08 1218.58,-448.36"/>
<polygon fill="black" stroke="black" points="1220.4,-445.36 1210.22,-442.4 1216.33,-451.06 1220.4,-445.36"/>
</g>
<!-- l3_exp_agg_tp0&#45;&gt;l3_final_res_tp0 -->
<g id="edge799" class="edge">
<title>l3_exp_agg_tp0&#45;&gt;l3_final_res_tp0</title>
<path fill="none" stroke="black" d="M1265.67,-335.64C1353.14,-313.71 1465.44,-285.55 1564.33,-260.76"/>
<polygon fill="black" stroke="black" points="1565.31,-264.12 1574.16,-258.29 1563.61,-257.33 1565.31,-264.12"/>
</g>
<!-- output -->
<g id="node482" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="6868" cy="-48.08" rx="149.81" ry="48.17"/>
<text text-anchor="middle" x="6868" y="-66.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="6868" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="6868" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="6868" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- l3_final_res_tp0&#45;&gt;output -->
<g id="edge801" class="edge">
<title>l3_final_res_tp0&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2061.18,-180.26C2301.81,-162.84 2667.63,-138.33 2986,-125.17 4429.88,-65.47 6177.84,-52.4 6708.04,-49.73"/>
<polygon fill="black" stroke="black" points="6708.07,-53.23 6718.05,-49.68 6708.03,-46.23 6708.07,-53.23"/>
</g>
<!-- l3_attn_tp1 -->
<g id="node378" class="node">
<title>l3_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="2795,-1103.17 2581,-1103.17 2581,-1035.17 2795,-1035.17 2795,-1103.17"/>
<text text-anchor="middle" x="2688" y="-1087.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2688" y="-1072.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="2688" y="-1057.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="2688" y="-1042.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l3_qkv_tp1&#45;&gt;l3_attn_tp1 -->
<g id="edge803" class="edge">
<title>l3_qkv_tp1&#45;&gt;l3_attn_tp1</title>
<path fill="none" stroke="black" d="M2685.97,-1140.01C2686.21,-1131.56 2686.48,-1122.34 2686.74,-1113.47"/>
<polygon fill="black" stroke="black" points="2690.24,-1113.36 2687.04,-1103.26 2683.25,-1113.16 2690.24,-1113.36"/>
</g>
<!-- l3_out_proj_tp1 -->
<g id="node379" class="node">
<title>l3_out_proj_tp1</title>
<polygon fill="lightgreen" stroke="black" points="2797,-998.17 2585,-998.17 2585,-930.17 2797,-930.17 2797,-998.17"/>
<text text-anchor="middle" x="2691" y="-982.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2691" y="-967.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="2691" y="-952.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="2691" y="-937.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l3_attn_tp1&#45;&gt;l3_out_proj_tp1 -->
<g id="edge804" class="edge">
<title>l3_attn_tp1&#45;&gt;l3_out_proj_tp1</title>
<path fill="none" stroke="black" d="M2688.97,-1035.01C2689.21,-1026.56 2689.48,-1017.34 2689.74,-1008.47"/>
<polygon fill="black" stroke="black" points="2693.24,-1008.36 2690.04,-998.26 2686.25,-1008.16 2693.24,-1008.36"/>
</g>
<!-- l3_out_proj_tp1&#45;&gt;l3_residual_tp1 -->
<g id="edge805" class="edge">
<title>l3_out_proj_tp1&#45;&gt;l3_residual_tp1</title>
<path fill="none" stroke="black" d="M2714,-930C2720,-921.34 2726.73,-911.64 2733.59,-901.74"/>
<polygon fill="black" stroke="black" points="2736.56,-903.61 2739.38,-893.4 2730.8,-899.62 2736.56,-903.61"/>
</g>
<!-- l3_gate_tp1 -->
<g id="node381" class="node">
<title>l3_gate_tp1</title>
<polygon fill="lightyellow" stroke="black" points="2825.2,-720.17 2495.59,-720.17 2410.8,-584.17 2740.41,-584.17 2825.2,-720.17"/>
<text text-anchor="middle" x="2618" y="-670.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="2618" y="-655.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="2618" y="-640.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="2618" y="-625.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l3_residual_tp1&#45;&gt;l3_gate_tp1 -->
<g id="edge807" class="edge">
<title>l3_residual_tp1&#45;&gt;l3_gate_tp1</title>
<path fill="none" stroke="black" d="M2720.08,-757.07C2710.63,-747.46 2700.86,-737.51 2691.28,-727.76"/>
<polygon fill="black" stroke="black" points="2693.51,-725.03 2684,-720.35 2688.51,-729.93 2693.51,-725.03"/>
</g>
<!-- l3_exp0_gpu9 -->
<g id="node382" class="node">
<title>l3_exp0_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2567,-547.17 2393,-547.17 2393,-479.17 2567,-479.17 2567,-547.17"/>
<text text-anchor="middle" x="2480" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="2480" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2480" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2480" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l3_residual_tp1&#45;&gt;l3_exp0_gpu9 -->
<g id="edge809" class="edge">
<title>l3_residual_tp1&#45;&gt;l3_exp0_gpu9</title>
<path fill="none" stroke="black" d="M2460.61,-757.16C2433.54,-746.2 2412.49,-733.88 2402,-720.17 2365.27,-672.16 2377.37,-639.37 2402,-584.17 2406.92,-573.13 2414.54,-563.11 2423.12,-554.32"/>
<polygon fill="black" stroke="black" points="2425.72,-556.68 2430.52,-547.23 2420.88,-551.63 2425.72,-556.68"/>
</g>
<!-- l3_exp1_gpu9 -->
<g id="node383" class="node">
<title>l3_exp1_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="3143,-547.17 2969,-547.17 2969,-479.17 3143,-479.17 3143,-547.17"/>
<text text-anchor="middle" x="3056" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3056" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3056" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3056" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l3_residual_tp1&#45;&gt;l3_exp1_gpu9 -->
<g id="edge812" class="edge">
<title>l3_residual_tp1&#45;&gt;l3_exp1_gpu9</title>
<path fill="none" stroke="black" d="M2844.59,-756.9C2898.14,-695.42 2975.61,-606.47 3020.38,-555.06"/>
<polygon fill="black" stroke="black" points="3023.08,-557.29 3027.01,-547.45 3017.8,-552.69 3023.08,-557.29"/>
</g>
<!-- l3_exp2_gpu9 -->
<g id="node384" class="node">
<title>l3_exp2_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2375,-547.17 2201,-547.17 2201,-479.17 2375,-479.17 2375,-547.17"/>
<text text-anchor="middle" x="2288" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2288" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2288" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2288" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l3_residual_tp1&#45;&gt;l3_exp2_gpu9 -->
<g id="edge815" class="edge">
<title>l3_residual_tp1&#45;&gt;l3_exp2_gpu9</title>
<path fill="none" stroke="black" d="M2443.98,-757.08C2412.66,-746.03 2387.59,-733.7 2374,-720.17 2328.95,-675.28 2306.32,-603.3 2295.87,-557.4"/>
<polygon fill="black" stroke="black" points="2299.26,-556.49 2293.71,-547.46 2292.42,-557.98 2299.26,-556.49"/>
</g>
<!-- l3_exp3_gpu9 -->
<g id="node385" class="node">
<title>l3_exp3_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2183,-547.17 2009,-547.17 2009,-479.17 2183,-479.17 2183,-547.17"/>
<text text-anchor="middle" x="2096" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2096" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2096" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2096" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l3_residual_tp1&#45;&gt;l3_exp3_gpu9 -->
<g id="edge818" class="edge">
<title>l3_residual_tp1&#45;&gt;l3_exp3_gpu9</title>
<path fill="none" stroke="black" d="M2452.06,-780.35C2398.6,-765.71 2345.35,-746.19 2298,-720.17 2224.09,-679.54 2160.01,-603.23 2124.81,-555.76"/>
<polygon fill="black" stroke="black" points="2127.52,-553.53 2118.79,-547.53 2121.87,-557.67 2127.52,-553.53"/>
</g>
<!-- l3_exp4_gpu9 -->
<g id="node386" class="node">
<title>l3_exp4_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="1991,-547.17 1817,-547.17 1817,-479.17 1991,-479.17 1991,-547.17"/>
<text text-anchor="middle" x="1904" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1904" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="1904" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="1904" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l3_residual_tp1&#45;&gt;l3_exp4_gpu9 -->
<g id="edge821" class="edge">
<title>l3_residual_tp1&#45;&gt;l3_exp4_gpu9</title>
<path fill="none" stroke="black" d="M2483.43,-809.67C2372.39,-795.59 2248.2,-769.16 2143,-720.17 2058.57,-680.84 1980.86,-602.88 1938.19,-554.95"/>
<polygon fill="black" stroke="black" points="1940.63,-552.43 1931.39,-547.24 1935.38,-557.05 1940.63,-552.43"/>
</g>
<!-- l3_exp5_gpu9 -->
<g id="node387" class="node">
<title>l3_exp5_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="3335,-547.17 3161,-547.17 3161,-479.17 3335,-479.17 3335,-547.17"/>
<text text-anchor="middle" x="3248" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3248" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3248" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3248" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l3_residual_tp1&#45;&gt;l3_exp5_gpu9 -->
<g id="edge824" class="edge">
<title>l3_residual_tp1&#45;&gt;l3_exp5_gpu9</title>
<path fill="none" stroke="black" d="M2885.96,-757.09C2978.83,-694.78 3113.92,-604.14 3190.1,-553.02"/>
<polygon fill="black" stroke="black" points="3192.29,-555.77 3198.64,-547.29 3188.39,-549.95 3192.29,-555.77"/>
</g>
<!-- l3_exp6_gpu9 -->
<g id="node388" class="node">
<title>l3_exp6_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2951,-547.17 2777,-547.17 2777,-479.17 2951,-479.17 2951,-547.17"/>
<text text-anchor="middle" x="2864" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2864" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2864" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2864" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l3_residual_tp1&#45;&gt;l3_exp6_gpu9 -->
<g id="edge827" class="edge">
<title>l3_residual_tp1&#45;&gt;l3_exp6_gpu9</title>
<path fill="none" stroke="black" d="M2840.83,-756.99C2843.99,-751.17 2846.78,-745.2 2849,-739.17 2871.1,-679.04 2871.08,-603.86 2868.18,-557.43"/>
<polygon fill="black" stroke="black" points="2871.67,-557.14 2867.48,-547.4 2864.69,-557.62 2871.67,-557.14"/>
</g>
<!-- l3_exp7_gpu9 -->
<g id="node389" class="node">
<title>l3_exp7_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2759,-547.17 2585,-547.17 2585,-479.17 2759,-479.17 2759,-547.17"/>
<text text-anchor="middle" x="2672" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2672" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="2672" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="2672" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l3_residual_tp1&#45;&gt;l3_exp7_gpu9 -->
<g id="edge830" class="edge">
<title>l3_residual_tp1&#45;&gt;l3_exp7_gpu9</title>
<path fill="none" stroke="black" d="M2822.01,-757.11C2826.97,-745.11 2831.29,-732.5 2834,-720.17 2840.48,-690.65 2850.6,-609.42 2834,-584.17 2829.52,-577.35 2800.74,-564.09 2768.64,-550.93"/>
<polygon fill="black" stroke="black" points="2769.64,-547.56 2759.06,-547.04 2767.01,-554.05 2769.64,-547.56"/>
</g>
<!-- l3_final_res_tp1 -->
<g id="node391" class="node">
<title>l3_final_res_tp1</title>
<polygon fill="lightyellow" stroke="black" points="3712.93,-269.17 3141.95,-269.17 2995.07,-133.17 3566.05,-133.17 3712.93,-269.17"/>
<text text-anchor="middle" x="3354" y="-219.97" font-family="Times,serif" font-size="14.00">Layer 3 Final Residual</text>
<text text-anchor="middle" x="3354" y="-204.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="3354" y="-189.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="3354" y="-174.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l3_residual_tp1&#45;&gt;l3_final_res_tp1 -->
<g id="edge833" class="edge">
<title>l3_residual_tp1&#45;&gt;l3_final_res_tp1</title>
<path fill="none" stroke="black" d="M3038.03,-793.75C3189.84,-768.12 3354,-724.03 3354,-653.17 3354,-653.17 3354,-653.17 3354,-373.17 3354,-342.63 3354,-309.02 3354,-279.74"/>
<polygon fill="black" stroke="black" points="3357.5,-279.58 3354,-269.58 3350.5,-279.58 3357.5,-279.58"/>
</g>
<!-- l3_gate_tp1&#45;&gt;l3_exp0_gpu9 -->
<g id="edge808" class="edge">
<title>l3_gate_tp1&#45;&gt;l3_exp0_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2550.21,-583.87C2540.1,-573.83 2529.95,-563.76 2520.64,-554.51"/>
<polygon fill="black" stroke="black" points="2522.93,-551.86 2513.37,-547.29 2518,-556.82 2522.93,-551.86"/>
</g>
<!-- l3_gate_tp1&#45;&gt;l3_exp1_gpu9 -->
<g id="edge811" class="edge">
<title>l3_gate_tp1&#45;&gt;l3_exp1_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2756.88,-610.17C2816.48,-592.27 2887.07,-570.67 2959.2,-547.4"/>
<polygon fill="black" stroke="black" points="2960.49,-550.66 2968.92,-544.25 2958.33,-544 2960.49,-550.66"/>
</g>
<!-- l3_gate_tp1&#45;&gt;l3_exp2_gpu9 -->
<g id="edge814" class="edge">
<title>l3_gate_tp1&#45;&gt;l3_exp2_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2456.38,-584.07C2429.02,-572.71 2401.52,-561.3 2376.92,-551.08"/>
<polygon fill="black" stroke="black" points="2378.22,-547.83 2367.64,-547.23 2375.53,-554.3 2378.22,-547.83"/>
</g>
<!-- l3_gate_tp1&#45;&gt;l3_exp3_gpu9 -->
<g id="edge817" class="edge">
<title>l3_gate_tp1&#45;&gt;l3_exp3_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2425.62,-608.15C2354.99,-591.37 2274.36,-571.05 2192.94,-547.37"/>
<polygon fill="black" stroke="black" points="2193.59,-543.91 2183.01,-544.46 2191.62,-550.63 2193.59,-543.91"/>
</g>
<!-- l3_gate_tp1&#45;&gt;l3_exp4_gpu9 -->
<g id="edge820" class="edge">
<title>l3_gate_tp1&#45;&gt;l3_exp4_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2438.56,-628.92C2317.01,-611.96 2153,-585.39 2001.18,-547.34"/>
<polygon fill="black" stroke="black" points="2001.75,-543.88 1991.19,-544.82 2000.03,-550.66 2001.75,-543.88"/>
</g>
<!-- l3_gate_tp1&#45;&gt;l3_exp5_gpu9 -->
<g id="edge823" class="edge">
<title>l3_gate_tp1&#45;&gt;l3_exp5_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2767.74,-627.73C2872.86,-609.92 3016.6,-582.86 3150.73,-547.4"/>
<polygon fill="black" stroke="black" points="3152.02,-550.68 3160.78,-544.72 3150.22,-543.91 3152.02,-550.68"/>
</g>
<!-- l3_gate_tp1&#45;&gt;l3_exp6_gpu9 -->
<g id="edge826" class="edge">
<title>l3_gate_tp1&#45;&gt;l3_exp6_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2738.48,-584.07C2758.07,-573.16 2777.75,-562.2 2795.52,-552.3"/>
<polygon fill="black" stroke="black" points="2797.6,-555.15 2804.63,-547.23 2794.19,-549.04 2797.6,-555.15"/>
</g>
<!-- l3_gate_tp1&#45;&gt;l3_exp7_gpu9 -->
<g id="edge829" class="edge">
<title>l3_gate_tp1&#45;&gt;l3_exp7_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2644.53,-583.87C2648.17,-574.63 2651.82,-565.35 2655.22,-556.73"/>
<polygon fill="black" stroke="black" points="2658.53,-557.88 2658.94,-547.29 2652.02,-555.31 2658.53,-557.88"/>
</g>
<!-- l3_exp_agg_tp1 -->
<g id="node390" class="node">
<title>l3_exp_agg_tp1</title>
<polygon fill="lightyellow" stroke="black" points="2891.58,-442.17 2542.28,-442.17 2452.42,-306.17 2801.72,-306.17 2891.58,-442.17"/>
<text text-anchor="middle" x="2672" y="-392.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2672" y="-377.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="2672" y="-362.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="2672" y="-347.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l3_exp0_gpu9&#45;&gt;l3_exp_agg_tp1 -->
<g id="edge810" class="edge">
<title>l3_exp0_gpu9&#45;&gt;l3_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2526.48,-479C2539.59,-469.65 2554.39,-459.08 2569.42,-448.36"/>
<polygon fill="black" stroke="black" points="2571.67,-451.06 2577.78,-442.4 2567.6,-445.36 2571.67,-451.06"/>
</g>
<!-- l3_exp1_gpu9&#45;&gt;l3_exp_agg_tp1 -->
<g id="edge813" class="edge">
<title>l3_exp1_gpu9&#45;&gt;l3_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2968.86,-481.08C2939.13,-470.47 2904.56,-458.14 2869.73,-445.71"/>
<polygon fill="black" stroke="black" points="2870.5,-442.27 2859.91,-442.21 2868.15,-448.86 2870.5,-442.27"/>
</g>
<!-- l3_exp2_gpu9&#45;&gt;l3_exp_agg_tp1 -->
<g id="edge816" class="edge">
<title>l3_exp2_gpu9&#45;&gt;l3_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2375.14,-481.08C2418.38,-465.65 2471.85,-446.57 2521.45,-428.88"/>
<polygon fill="black" stroke="black" points="2522.75,-432.13 2530.99,-425.48 2520.39,-425.54 2522.75,-432.13"/>
</g>
<!-- l3_exp3_gpu9&#45;&gt;l3_exp_agg_tp1 -->
<g id="edge819" class="edge">
<title>l3_exp3_gpu9&#45;&gt;l3_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2183.24,-481.69C2186.19,-480.82 2189.11,-479.97 2192,-479.17 2295.61,-450.24 2413.66,-424.57 2506.77,-405.97"/>
<polygon fill="black" stroke="black" points="2507.72,-409.35 2516.85,-403.96 2506.35,-402.48 2507.72,-409.35"/>
</g>
<!-- l3_exp4_gpu9&#45;&gt;l3_exp_agg_tp1 -->
<g id="edge822" class="edge">
<title>l3_exp4_gpu9&#45;&gt;l3_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M1991.18,-481.46C1994.15,-480.65 1997.09,-479.89 2000,-479.17 2167.29,-437.82 2362.29,-409.81 2499.01,-393.37"/>
<polygon fill="black" stroke="black" points="2499.65,-396.82 2509.16,-392.16 2498.82,-389.87 2499.65,-396.82"/>
</g>
<!-- l3_exp5_gpu9&#45;&gt;l3_exp_agg_tp1 -->
<g id="edge825" class="edge">
<title>l3_exp5_gpu9&#45;&gt;l3_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M3160.76,-481.69C3157.81,-480.82 3154.89,-479.97 3152,-479.17 3064.51,-454.74 2966.71,-432.64 2882.34,-415.15"/>
<polygon fill="black" stroke="black" points="2882.88,-411.69 2872.38,-413.09 2881.47,-418.54 2882.88,-411.69"/>
</g>
<!-- l3_exp6_gpu9&#45;&gt;l3_exp_agg_tp1 -->
<g id="edge828" class="edge">
<title>l3_exp6_gpu9&#45;&gt;l3_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2817.52,-479C2804.41,-469.65 2789.61,-459.08 2774.58,-448.36"/>
<polygon fill="black" stroke="black" points="2776.4,-445.36 2766.22,-442.4 2772.33,-451.06 2776.4,-445.36"/>
</g>
<!-- l3_exp7_gpu9&#45;&gt;l3_exp_agg_tp1 -->
<g id="edge831" class="edge">
<title>l3_exp7_gpu9&#45;&gt;l3_exp_agg_tp1</title>
<path fill="none" stroke="black" d="M2672,-479C2672,-470.86 2672,-461.8 2672,-452.52"/>
<polygon fill="black" stroke="black" points="2675.5,-452.4 2672,-442.4 2668.5,-452.4 2675.5,-452.4"/>
</g>
<!-- l3_exp_agg_tp1&#45;&gt;l3_final_res_tp1 -->
<g id="edge832" class="edge">
<title>l3_exp_agg_tp1&#45;&gt;l3_final_res_tp1</title>
<path fill="none" stroke="black" d="M2821.67,-335.64C2909.14,-313.71 3021.44,-285.55 3120.33,-260.76"/>
<polygon fill="black" stroke="black" points="3121.31,-264.12 3130.16,-258.29 3119.61,-257.33 3121.31,-264.12"/>
</g>
<!-- l3_final_res_tp1&#45;&gt;output -->
<g id="edge834" class="edge">
<title>l3_final_res_tp1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3618.11,-181.19C3858.77,-164.44 4224.11,-140.4 4542,-125.17 5356.1,-86.16 6331.46,-61.39 6708.45,-52.63"/>
<polygon fill="black" stroke="black" points="6708.69,-56.13 6718.61,-52.4 6708.53,-49.13 6708.69,-56.13"/>
</g>
<!-- l3_attn_tp2 -->
<g id="node393" class="node">
<title>l3_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="4274,-1103.17 4060,-1103.17 4060,-1035.17 4274,-1035.17 4274,-1103.17"/>
<text text-anchor="middle" x="4167" y="-1087.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="4167" y="-1072.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="4167" y="-1057.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="4167" y="-1042.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l3_qkv_tp2&#45;&gt;l3_attn_tp2 -->
<g id="edge836" class="edge">
<title>l3_qkv_tp2&#45;&gt;l3_attn_tp2</title>
<path fill="none" stroke="black" d="M4163.61,-1140.01C4164.02,-1131.56 4164.47,-1122.34 4164.9,-1113.47"/>
<polygon fill="black" stroke="black" points="4168.4,-1113.42 4165.39,-1103.26 4161.41,-1113.08 4168.4,-1113.42"/>
</g>
<!-- l3_out_proj_tp2 -->
<g id="node394" class="node">
<title>l3_out_proj_tp2</title>
<polygon fill="lightgreen" stroke="black" points="4274,-998.17 4062,-998.17 4062,-930.17 4274,-930.17 4274,-998.17"/>
<text text-anchor="middle" x="4168" y="-982.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4168" y="-967.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="4168" y="-952.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="4168" y="-937.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l3_attn_tp2&#45;&gt;l3_out_proj_tp2 -->
<g id="edge837" class="edge">
<title>l3_attn_tp2&#45;&gt;l3_out_proj_tp2</title>
<path fill="none" stroke="black" d="M4167.32,-1035.01C4167.4,-1026.56 4167.49,-1017.34 4167.58,-1008.47"/>
<polygon fill="black" stroke="black" points="4171.08,-1008.29 4167.68,-998.26 4164.08,-1008.23 4171.08,-1008.29"/>
</g>
<!-- l3_out_proj_tp2&#45;&gt;l3_residual_tp2 -->
<g id="edge838" class="edge">
<title>l3_out_proj_tp2&#45;&gt;l3_residual_tp2</title>
<path fill="none" stroke="black" d="M4170.9,-930C4171.62,-921.86 4172.41,-912.8 4173.22,-903.52"/>
<polygon fill="black" stroke="black" points="4176.72,-903.67 4174.11,-893.4 4169.75,-903.06 4176.72,-903.67"/>
</g>
<!-- l3_gate_tp2 -->
<g id="node396" class="node">
<title>l3_gate_tp2</title>
<polygon fill="lightyellow" stroke="black" points="4435.2,-720.17 4105.59,-720.17 4020.8,-584.17 4350.41,-584.17 4435.2,-720.17"/>
<text text-anchor="middle" x="4228" y="-670.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="4228" y="-655.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="4228" y="-640.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="4228" y="-625.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l3_residual_tp2&#45;&gt;l3_gate_tp2 -->
<g id="edge840" class="edge">
<title>l3_residual_tp2&#45;&gt;l3_gate_tp2</title>
<path fill="none" stroke="black" d="M4198.83,-757.07C4201.32,-748.21 4203.89,-739.07 4206.42,-730.06"/>
<polygon fill="black" stroke="black" points="4209.81,-730.92 4209.14,-720.35 4203.07,-729.03 4209.81,-730.92"/>
</g>
<!-- l3_exp0_gpu10 -->
<g id="node397" class="node">
<title>l3_exp0_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="3547,-547.17 3373,-547.17 3373,-479.17 3547,-479.17 3547,-547.17"/>
<text text-anchor="middle" x="3460" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="3460" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3460" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3460" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l3_residual_tp2&#45;&gt;l3_exp0_gpu10 -->
<g id="edge842" class="edge">
<title>l3_residual_tp2&#45;&gt;l3_exp0_gpu10</title>
<path fill="none" stroke="black" d="M3832.72,-768.05C3789.29,-755.2 3746.35,-739.46 3707,-720.17 3622.05,-678.52 3541.35,-601.76 3496.49,-554.61"/>
<polygon fill="black" stroke="black" points="3499.01,-552.19 3489.6,-547.31 3493.91,-556.99 3499.01,-552.19"/>
</g>
<!-- l3_exp1_gpu10 -->
<g id="node398" class="node">
<title>l3_exp1_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="4123,-547.17 3949,-547.17 3949,-479.17 4123,-479.17 4123,-547.17"/>
<text text-anchor="middle" x="4036" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4036" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4036" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4036" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l3_residual_tp2&#45;&gt;l3_exp1_gpu10 -->
<g id="edge845" class="edge">
<title>l3_residual_tp2&#45;&gt;l3_exp1_gpu10</title>
<path fill="none" stroke="black" d="M4018.09,-757.04C4005.82,-746.39 3995.1,-734.17 3987,-720.17 3956.75,-667.84 3968.83,-641.81 3987,-584.17 3990.08,-574.4 3995.06,-564.82 4000.69,-556.03"/>
<polygon fill="black" stroke="black" points="4003.75,-557.75 4006.49,-547.52 3997.96,-553.81 4003.75,-557.75"/>
</g>
<!-- l3_exp2_gpu10 -->
<g id="node399" class="node">
<title>l3_exp2_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="4315,-547.17 4141,-547.17 4141,-479.17 4315,-479.17 4315,-547.17"/>
<text text-anchor="middle" x="4228" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4228" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4228" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4228" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l3_residual_tp2&#45;&gt;l3_exp2_gpu10 -->
<g id="edge848" class="edge">
<title>l3_residual_tp2&#45;&gt;l3_exp2_gpu10</title>
<path fill="none" stroke="black" d="M4041.83,-756.86C4030.02,-746.14 4019.68,-733.95 4012,-720.17 3982.59,-667.36 3976.1,-632.8 4012,-584.17 4043.33,-541.72 4075.24,-561.92 4131,-547.17"/>
<polygon fill="black" stroke="black" points="4132.32,-550.43 4140.92,-544.24 4130.34,-543.71 4132.32,-550.43"/>
</g>
<!-- l3_exp3_gpu10 -->
<g id="node400" class="node">
<title>l3_exp3_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="3739,-547.17 3565,-547.17 3565,-479.17 3739,-479.17 3739,-547.17"/>
<text text-anchor="middle" x="3652" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3652" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3652" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3652" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l3_residual_tp2&#45;&gt;l3_exp3_gpu10 -->
<g id="edge851" class="edge">
<title>l3_residual_tp2&#45;&gt;l3_exp3_gpu10</title>
<path fill="none" stroke="black" d="M3943.66,-757.01C3918.07,-746.21 3893,-733.97 3870,-720.17 3795.29,-675.34 3725.11,-601.11 3685.46,-555.06"/>
<polygon fill="black" stroke="black" points="3688.04,-552.7 3678.89,-547.36 3682.72,-557.24 3688.04,-552.7"/>
</g>
<!-- l3_exp4_gpu10 -->
<g id="node401" class="node">
<title>l3_exp4_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="3931,-547.17 3757,-547.17 3757,-479.17 3931,-479.17 3931,-547.17"/>
<text text-anchor="middle" x="3844" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3844" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="3844" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="3844" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l3_residual_tp2&#45;&gt;l3_exp4_gpu10 -->
<g id="edge854" class="edge">
<title>l3_residual_tp2&#45;&gt;l3_exp4_gpu10</title>
<path fill="none" stroke="black" d="M4009.98,-757.01C3993.27,-746.25 3977.53,-734 3964,-720.17 3916.82,-671.92 3881.06,-601.57 3861.32,-556.85"/>
<polygon fill="black" stroke="black" points="3864.42,-555.21 3857.23,-547.43 3858,-558 3864.42,-555.21"/>
</g>
<!-- l3_exp5_gpu10 -->
<g id="node402" class="node">
<title>l3_exp5_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="4507,-547.17 4333,-547.17 4333,-479.17 4507,-479.17 4507,-547.17"/>
<text text-anchor="middle" x="4420" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4420" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4420" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4420" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l3_residual_tp2&#45;&gt;l3_exp5_gpu10 -->
<g id="edge857" class="edge">
<title>l3_residual_tp2&#45;&gt;l3_exp5_gpu10</title>
<path fill="none" stroke="black" d="M4399.7,-764.14C4416.89,-752.07 4432.15,-737.57 4444,-720.17 4477.04,-671.64 4458.26,-601.37 4440.27,-556.74"/>
<polygon fill="black" stroke="black" points="4443.43,-555.22 4436.34,-547.34 4436.97,-557.92 4443.43,-555.22"/>
</g>
<!-- l3_exp6_gpu10 -->
<g id="node403" class="node">
<title>l3_exp6_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="4891,-547.17 4717,-547.17 4717,-479.17 4891,-479.17 4891,-547.17"/>
<text text-anchor="middle" x="4804" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="4804" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4804" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4804" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l3_residual_tp2&#45;&gt;l3_exp6_gpu10 -->
<g id="edge860" class="edge">
<title>l3_residual_tp2&#45;&gt;l3_exp6_gpu10</title>
<path fill="none" stroke="black" d="M4404.74,-768.66C4445.72,-755.13 4487.39,-739.01 4525,-720.17 4615.63,-674.77 4707.72,-599.99 4760.16,-554.1"/>
<polygon fill="black" stroke="black" points="4762.72,-556.51 4767.91,-547.27 4758.09,-551.26 4762.72,-556.51"/>
</g>
<!-- l3_exp7_gpu10 -->
<g id="node404" class="node">
<title>l3_exp7_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="4699,-547.17 4525,-547.17 4525,-479.17 4699,-479.17 4699,-547.17"/>
<text text-anchor="middle" x="4612" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="4612" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="4612" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="4612" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l3_residual_tp2&#45;&gt;l3_exp7_gpu10 -->
<g id="edge863" class="edge">
<title>l3_residual_tp2&#45;&gt;l3_exp7_gpu10</title>
<path fill="none" stroke="black" d="M4393.35,-758.18C4406.98,-752.23 4420.31,-745.89 4433,-739.17 4509.57,-698.62 4564.6,-609.62 4592.09,-556.51"/>
<polygon fill="black" stroke="black" points="4595.34,-557.85 4596.75,-547.35 4589.1,-554.68 4595.34,-557.85"/>
</g>
<!-- l3_final_res_tp2 -->
<g id="node406" class="node">
<title>l3_final_res_tp2</title>
<polygon fill="lightyellow" stroke="black" points="5268.93,-269.17 4697.95,-269.17 4551.07,-133.17 5122.05,-133.17 5268.93,-269.17"/>
<text text-anchor="middle" x="4910" y="-219.97" font-family="Times,serif" font-size="14.00">Layer 3 Final Residual</text>
<text text-anchor="middle" x="4910" y="-204.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="4910" y="-189.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="4910" y="-174.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l3_residual_tp2&#45;&gt;l3_final_res_tp2 -->
<g id="edge866" class="edge">
<title>l3_residual_tp2&#45;&gt;l3_final_res_tp2</title>
<path fill="none" stroke="black" d="M4450.27,-810.84C4658.12,-792.93 4910,-751.04 4910,-653.17 4910,-653.17 4910,-653.17 4910,-373.17 4910,-342.63 4910,-309.02 4910,-279.74"/>
<polygon fill="black" stroke="black" points="4913.5,-279.58 4910,-269.58 4906.5,-279.58 4913.5,-279.58"/>
</g>
<!-- l3_gate_tp2&#45;&gt;l3_exp0_gpu10 -->
<g id="edge841" class="edge">
<title>l3_gate_tp2&#45;&gt;l3_exp0_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4050.86,-632.46C3916.9,-616.27 3728.74,-589.13 3556.91,-547.26"/>
<polygon fill="black" stroke="black" points="3557.73,-543.86 3547.18,-544.87 3556.06,-550.65 3557.73,-543.86"/>
</g>
<!-- l3_gate_tp2&#45;&gt;l3_exp1_gpu10 -->
<g id="edge844" class="edge">
<title>l3_gate_tp2&#45;&gt;l3_exp1_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4133.97,-584.07C4119.18,-573.52 4104.32,-562.92 4090.81,-553.28"/>
<polygon fill="black" stroke="black" points="4092.76,-550.36 4082.58,-547.41 4088.69,-556.06 4092.76,-550.36"/>
</g>
<!-- l3_gate_tp2&#45;&gt;l3_exp2_gpu10 -->
<g id="edge847" class="edge">
<title>l3_gate_tp2&#45;&gt;l3_exp2_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4228,-583.87C4228,-574.93 4228,-565.95 4228,-557.56"/>
<polygon fill="black" stroke="black" points="4231.5,-557.29 4228,-547.29 4224.5,-557.29 4231.5,-557.29"/>
</g>
<!-- l3_gate_tp2&#45;&gt;l3_exp3_gpu10 -->
<g id="edge850" class="edge">
<title>l3_gate_tp2&#45;&gt;l3_exp3_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4037.4,-610.98C3925.1,-587.13 3797.2,-559.59 3749.2,-547.3"/>
<polygon fill="black" stroke="black" points="3749.8,-543.84 3739.24,-544.64 3748,-550.6 3749.8,-543.84"/>
</g>
<!-- l3_gate_tp2&#45;&gt;l3_exp4_gpu10 -->
<g id="edge853" class="edge">
<title>l3_gate_tp2&#45;&gt;l3_exp4_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4039.94,-584.07C4005.64,-571.84 3971.18,-559.54 3940.93,-548.75"/>
<polygon fill="black" stroke="black" points="3941.86,-545.36 3931.26,-545.3 3939.51,-551.96 3941.86,-545.36"/>
</g>
<!-- l3_gate_tp2&#45;&gt;l3_exp5_gpu10 -->
<g id="edge856" class="edge">
<title>l3_gate_tp2&#45;&gt;l3_exp5_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4313.96,-583.97C4322.68,-577.51 4331.47,-571.15 4340,-565.17 4345.84,-561.07 4352,-556.9 4358.19,-552.8"/>
<polygon fill="black" stroke="black" points="4360.2,-555.68 4366.64,-547.27 4356.36,-549.82 4360.2,-555.68"/>
</g>
<!-- l3_gate_tp2&#45;&gt;l3_exp6_gpu10 -->
<g id="edge859" class="edge">
<title>l3_gate_tp2&#45;&gt;l3_exp6_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4375.36,-623.91C4468.28,-605.61 4590.73,-579.45 4706.97,-547.36"/>
<polygon fill="black" stroke="black" points="4708.06,-550.69 4716.76,-544.64 4706.19,-543.95 4708.06,-550.69"/>
</g>
<!-- l3_gate_tp2&#45;&gt;l3_exp7_gpu10 -->
<g id="edge862" class="edge">
<title>l3_gate_tp2&#45;&gt;l3_exp7_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4362.57,-603.15C4412.83,-585.22 4468.87,-565.23 4515.08,-548.74"/>
<polygon fill="black" stroke="black" points="4516.54,-551.94 4524.79,-545.28 4514.19,-545.35 4516.54,-551.94"/>
</g>
<!-- l3_exp_agg_tp2 -->
<g id="node405" class="node">
<title>l3_exp_agg_tp2</title>
<polygon fill="lightyellow" stroke="black" points="4447.58,-442.17 4098.28,-442.17 4008.42,-306.17 4357.72,-306.17 4447.58,-442.17"/>
<text text-anchor="middle" x="4228" y="-392.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4228" y="-377.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="4228" y="-362.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="4228" y="-347.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l3_exp0_gpu10&#45;&gt;l3_exp_agg_tp2 -->
<g id="edge843" class="edge">
<title>l3_exp0_gpu10&#45;&gt;l3_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M3547.18,-481.46C3550.15,-480.65 3553.09,-479.89 3556,-479.17 3723.29,-437.82 3918.29,-409.81 4055.01,-393.37"/>
<polygon fill="black" stroke="black" points="4055.65,-396.82 4065.16,-392.16 4054.82,-389.87 4055.65,-396.82"/>
</g>
<!-- l3_exp1_gpu10&#45;&gt;l3_exp_agg_tp2 -->
<g id="edge846" class="edge">
<title>l3_exp1_gpu10&#45;&gt;l3_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M4082.48,-479C4095.59,-469.65 4110.39,-459.08 4125.42,-448.36"/>
<polygon fill="black" stroke="black" points="4127.67,-451.06 4133.78,-442.4 4123.6,-445.36 4127.67,-451.06"/>
</g>
<!-- l3_exp2_gpu10&#45;&gt;l3_exp_agg_tp2 -->
<g id="edge849" class="edge">
<title>l3_exp2_gpu10&#45;&gt;l3_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M4228,-479C4228,-470.86 4228,-461.8 4228,-452.52"/>
<polygon fill="black" stroke="black" points="4231.5,-452.4 4228,-442.4 4224.5,-452.4 4231.5,-452.4"/>
</g>
<!-- l3_exp3_gpu10&#45;&gt;l3_exp_agg_tp2 -->
<g id="edge852" class="edge">
<title>l3_exp3_gpu10&#45;&gt;l3_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M3739.24,-481.69C3742.19,-480.82 3745.11,-479.97 3748,-479.17 3851.61,-450.24 3969.66,-424.57 4062.77,-405.97"/>
<polygon fill="black" stroke="black" points="4063.72,-409.35 4072.85,-403.96 4062.35,-402.48 4063.72,-409.35"/>
</g>
<!-- l3_exp4_gpu10&#45;&gt;l3_exp_agg_tp2 -->
<g id="edge855" class="edge">
<title>l3_exp4_gpu10&#45;&gt;l3_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M3931.14,-481.08C3974.38,-465.65 4027.85,-446.57 4077.45,-428.88"/>
<polygon fill="black" stroke="black" points="4078.75,-432.13 4086.99,-425.48 4076.39,-425.54 4078.75,-432.13"/>
</g>
<!-- l3_exp5_gpu10&#45;&gt;l3_exp_agg_tp2 -->
<g id="edge858" class="edge">
<title>l3_exp5_gpu10&#45;&gt;l3_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M4373.52,-479C4360.41,-469.65 4345.61,-459.08 4330.58,-448.36"/>
<polygon fill="black" stroke="black" points="4332.4,-445.36 4322.22,-442.4 4328.33,-451.06 4332.4,-445.36"/>
</g>
<!-- l3_exp6_gpu10&#45;&gt;l3_exp_agg_tp2 -->
<g id="edge861" class="edge">
<title>l3_exp6_gpu10&#45;&gt;l3_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M4716.76,-481.69C4713.81,-480.82 4710.89,-479.97 4708,-479.17 4620.51,-454.74 4522.71,-432.64 4438.34,-415.15"/>
<polygon fill="black" stroke="black" points="4438.88,-411.69 4428.38,-413.09 4437.47,-418.54 4438.88,-411.69"/>
</g>
<!-- l3_exp7_gpu10&#45;&gt;l3_exp_agg_tp2 -->
<g id="edge864" class="edge">
<title>l3_exp7_gpu10&#45;&gt;l3_exp_agg_tp2</title>
<path fill="none" stroke="black" d="M4524.86,-481.08C4495.13,-470.47 4460.56,-458.14 4425.73,-445.71"/>
<polygon fill="black" stroke="black" points="4426.5,-442.27 4415.91,-442.21 4424.15,-448.86 4426.5,-442.27"/>
</g>
<!-- l3_exp_agg_tp2&#45;&gt;l3_final_res_tp2 -->
<g id="edge865" class="edge">
<title>l3_exp_agg_tp2&#45;&gt;l3_final_res_tp2</title>
<path fill="none" stroke="black" d="M4377.67,-335.64C4465.14,-313.71 4577.44,-285.55 4676.33,-260.76"/>
<polygon fill="black" stroke="black" points="4677.31,-264.12 4686.16,-258.29 4675.61,-257.33 4677.31,-264.12"/>
</g>
<!-- l3_final_res_tp2&#45;&gt;output -->
<g id="edge867" class="edge">
<title>l3_final_res_tp2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M5172.54,-179.91C5586.43,-147.97 6377.87,-86.9 6712.49,-61.08"/>
<polygon fill="black" stroke="black" points="6713.04,-64.55 6722.74,-60.29 6712.5,-57.57 6713.04,-64.55"/>
</g>
<!-- l3_attn_tp3 -->
<g id="node408" class="node">
<title>l3_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="5939,-1103.17 5725,-1103.17 5725,-1035.17 5939,-1035.17 5939,-1103.17"/>
<text text-anchor="middle" x="5832" y="-1087.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5832" y="-1072.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="5832" y="-1057.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5832" y="-1042.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l3_qkv_tp3&#45;&gt;l3_attn_tp3 -->
<g id="edge869" class="edge">
<title>l3_qkv_tp3&#45;&gt;l3_attn_tp3</title>
<path fill="none" stroke="black" d="M5829.97,-1140.01C5830.21,-1131.56 5830.48,-1122.34 5830.74,-1113.47"/>
<polygon fill="black" stroke="black" points="5834.24,-1113.36 5831.04,-1103.26 5827.25,-1113.16 5834.24,-1113.36"/>
</g>
<!-- l3_out_proj_tp3 -->
<g id="node409" class="node">
<title>l3_out_proj_tp3</title>
<polygon fill="lightgreen" stroke="black" points="5940,-998.17 5728,-998.17 5728,-930.17 5940,-930.17 5940,-998.17"/>
<text text-anchor="middle" x="5834" y="-982.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5834" y="-967.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="5834" y="-952.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5834" y="-937.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l3_attn_tp3&#45;&gt;l3_out_proj_tp3 -->
<g id="edge870" class="edge">
<title>l3_attn_tp3&#45;&gt;l3_out_proj_tp3</title>
<path fill="none" stroke="black" d="M5832.64,-1035.01C5832.81,-1026.56 5832.99,-1017.34 5833.16,-1008.47"/>
<polygon fill="black" stroke="black" points="5836.66,-1008.33 5833.36,-998.26 5829.66,-1008.19 5836.66,-1008.33"/>
</g>
<!-- l3_out_proj_tp3&#45;&gt;l3_residual_tp3 -->
<g id="edge871" class="edge">
<title>l3_out_proj_tp3&#45;&gt;l3_residual_tp3</title>
<path fill="none" stroke="black" d="M5849.25,-930C5853.11,-921.6 5857.43,-912.22 5861.84,-902.63"/>
<polygon fill="black" stroke="black" points="5865.08,-903.95 5866.08,-893.4 5858.72,-901.02 5865.08,-903.95"/>
</g>
<!-- l3_gate_tp3 -->
<g id="node411" class="node">
<title>l3_gate_tp3</title>
<polygon fill="lightyellow" stroke="black" points="5937.2,-720.17 5607.59,-720.17 5522.8,-584.17 5852.41,-584.17 5937.2,-720.17"/>
<text text-anchor="middle" x="5730" y="-670.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="5730" y="-655.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="5730" y="-640.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="5730" y="-625.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l3_residual_tp3&#45;&gt;l3_gate_tp3 -->
<g id="edge873" class="edge">
<title>l3_residual_tp3&#45;&gt;l3_gate_tp3</title>
<path fill="none" stroke="black" d="M5831.48,-757.07C5822.08,-747.46 5812.37,-737.51 5802.85,-727.76"/>
<polygon fill="black" stroke="black" points="5805.1,-725.06 5795.61,-720.35 5800.09,-729.95 5805.1,-725.06"/>
</g>
<!-- l3_exp0_gpu11 -->
<g id="node412" class="node">
<title>l3_exp0_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="5295,-547.17 5121,-547.17 5121,-479.17 5295,-479.17 5295,-547.17"/>
<text text-anchor="middle" x="5208" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="5208" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5208" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5208" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l3_residual_tp3&#45;&gt;l3_exp0_gpu11 -->
<g id="edge875" class="edge">
<title>l3_residual_tp3&#45;&gt;l3_exp0_gpu11</title>
<path fill="none" stroke="black" d="M5562.46,-779.92C5509.54,-765.34 5456.87,-745.94 5410,-720.17 5336.09,-679.52 5272.02,-603.22 5236.81,-555.75"/>
<polygon fill="black" stroke="black" points="5239.52,-553.53 5230.79,-547.53 5233.88,-557.66 5239.52,-553.53"/>
</g>
<!-- l3_exp1_gpu11 -->
<g id="node413" class="node">
<title>l3_exp1_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="5103,-547.17 4929,-547.17 4929,-479.17 5103,-479.17 5103,-547.17"/>
<text text-anchor="middle" x="5016" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="5016" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5016" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5016" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l3_residual_tp3&#45;&gt;l3_exp1_gpu11 -->
<g id="edge878" class="edge">
<title>l3_residual_tp3&#45;&gt;l3_exp1_gpu11</title>
<path fill="none" stroke="black" d="M5594.5,-809.55C5483.73,-795.45 5359.91,-769.04 5255,-720.17 5170.57,-680.83 5092.86,-602.87 5050.19,-554.95"/>
<polygon fill="black" stroke="black" points="5052.63,-552.42 5043.39,-547.23 5047.38,-557.05 5052.63,-552.42"/>
</g>
<!-- l3_exp2_gpu11 -->
<g id="node414" class="node">
<title>l3_exp2_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="6447,-547.17 6273,-547.17 6273,-479.17 6447,-479.17 6447,-547.17"/>
<text text-anchor="middle" x="6360" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="6360" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6360" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6360" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l3_residual_tp3&#45;&gt;l3_exp2_gpu11 -->
<g id="edge881" class="edge">
<title>l3_residual_tp3&#45;&gt;l3_exp2_gpu11</title>
<path fill="none" stroke="black" d="M5997.18,-757.09C6090.25,-694.78 6225.63,-604.14 6301.97,-553.02"/>
<polygon fill="black" stroke="black" points="6304.17,-555.76 6310.53,-547.29 6300.28,-549.94 6304.17,-555.76"/>
</g>
<!-- l3_exp3_gpu11 -->
<g id="node415" class="node">
<title>l3_exp3_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="6063,-547.17 5889,-547.17 5889,-479.17 6063,-479.17 6063,-547.17"/>
<text text-anchor="middle" x="5976" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="5976" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5976" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5976" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l3_residual_tp3&#45;&gt;l3_exp3_gpu11 -->
<g id="edge884" class="edge">
<title>l3_residual_tp3&#45;&gt;l3_exp3_gpu11</title>
<path fill="none" stroke="black" d="M5952.7,-757.05C5955.91,-751.22 5958.75,-745.23 5961,-739.17 5983.32,-679.12 5983.24,-603.92 5980.27,-557.46"/>
<polygon fill="black" stroke="black" points="5983.76,-557.16 5979.56,-547.43 5976.78,-557.65 5983.76,-557.16"/>
</g>
<!-- l3_exp4_gpu11 -->
<g id="node416" class="node">
<title>l3_exp4_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="5487,-547.17 5313,-547.17 5313,-479.17 5487,-479.17 5487,-547.17"/>
<text text-anchor="middle" x="5400" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="5400" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5400" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5400" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l3_residual_tp3&#45;&gt;l3_exp4_gpu11 -->
<g id="edge887" class="edge">
<title>l3_residual_tp3&#45;&gt;l3_exp4_gpu11</title>
<path fill="none" stroke="black" d="M5555.81,-757.03C5524.56,-745.98 5499.56,-733.67 5486,-720.17 5440.95,-675.28 5418.32,-603.3 5407.87,-557.4"/>
<polygon fill="black" stroke="black" points="5411.26,-556.49 5405.71,-547.46 5404.42,-557.98 5411.26,-556.49"/>
</g>
<!-- l3_exp5_gpu11 -->
<g id="node417" class="node">
<title>l3_exp5_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="5679,-547.17 5505,-547.17 5505,-479.17 5679,-479.17 5679,-547.17"/>
<text text-anchor="middle" x="5592" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="5592" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5592" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5592" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l3_residual_tp3&#45;&gt;l3_exp5_gpu11 -->
<g id="edge890" class="edge">
<title>l3_residual_tp3&#45;&gt;l3_exp5_gpu11</title>
<path fill="none" stroke="black" d="M5572.45,-757.1C5545.45,-746.16 5524.46,-733.85 5514,-720.17 5477.28,-672.15 5489.37,-639.37 5514,-584.17 5518.92,-573.13 5526.54,-563.11 5535.12,-554.32"/>
<polygon fill="black" stroke="black" points="5537.72,-556.68 5542.52,-547.23 5532.88,-551.63 5537.72,-556.68"/>
</g>
<!-- l3_exp6_gpu11 -->
<g id="node418" class="node">
<title>l3_exp6_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="6255,-547.17 6081,-547.17 6081,-479.17 6255,-479.17 6255,-547.17"/>
<text text-anchor="middle" x="6168" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="6168" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6168" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6168" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l3_residual_tp3&#45;&gt;l3_exp6_gpu11 -->
<g id="edge893" class="edge">
<title>l3_residual_tp3&#45;&gt;l3_exp6_gpu11</title>
<path fill="none" stroke="black" d="M5955.8,-756.9C6009.55,-695.42 6087.31,-606.47 6132.25,-555.06"/>
<polygon fill="black" stroke="black" points="6134.96,-557.28 6138.9,-547.45 6129.69,-552.68 6134.96,-557.28"/>
</g>
<!-- l3_exp7_gpu11 -->
<g id="node419" class="node">
<title>l3_exp7_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="5871,-547.17 5697,-547.17 5697,-479.17 5871,-479.17 5871,-547.17"/>
<text text-anchor="middle" x="5784" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5784" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="5784" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="5784" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l3_residual_tp3&#45;&gt;l3_exp7_gpu11 -->
<g id="edge896" class="edge">
<title>l3_residual_tp3&#45;&gt;l3_exp7_gpu11</title>
<path fill="none" stroke="black" d="M5933.88,-756.89C5938.89,-744.97 5943.25,-732.44 5946,-720.17 5952.6,-690.67 5962.6,-609.42 5946,-584.17 5941.52,-577.35 5912.74,-564.09 5880.64,-550.93"/>
<polygon fill="black" stroke="black" points="5881.64,-547.56 5871.06,-547.04 5879.01,-554.05 5881.64,-547.56"/>
</g>
<!-- l3_final_res_tp3 -->
<g id="node421" class="node">
<title>l3_final_res_tp3</title>
<polygon fill="lightyellow" stroke="black" points="6824.93,-269.17 6253.95,-269.17 6107.07,-133.17 6678.05,-133.17 6824.93,-269.17"/>
<text text-anchor="middle" x="6466" y="-219.97" font-family="Times,serif" font-size="14.00">Layer 3 Final Residual</text>
<text text-anchor="middle" x="6466" y="-204.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="6466" y="-189.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="6466" y="-174.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l3_residual_tp3&#45;&gt;l3_final_res_tp3 -->
<g id="edge899" class="edge">
<title>l3_residual_tp3&#45;&gt;l3_final_res_tp3</title>
<path fill="none" stroke="black" d="M6149.06,-793.89C6301.25,-768.31 6466,-724.21 6466,-653.17 6466,-653.17 6466,-653.17 6466,-373.17 6466,-342.63 6466,-309.02 6466,-279.74"/>
<polygon fill="black" stroke="black" points="6469.5,-279.58 6466,-269.58 6462.5,-279.58 6469.5,-279.58"/>
</g>
<!-- l3_gate_tp3&#45;&gt;l3_exp0_gpu11 -->
<g id="edge874" class="edge">
<title>l3_gate_tp3&#45;&gt;l3_exp0_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5537.62,-608.15C5466.99,-591.37 5386.36,-571.05 5304.94,-547.37"/>
<polygon fill="black" stroke="black" points="5305.59,-543.91 5295.01,-544.46 5303.62,-550.63 5305.59,-543.91"/>
</g>
<!-- l3_gate_tp3&#45;&gt;l3_exp1_gpu11 -->
<g id="edge877" class="edge">
<title>l3_gate_tp3&#45;&gt;l3_exp1_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5550.56,-628.92C5429.01,-611.96 5265,-585.39 5113.18,-547.34"/>
<polygon fill="black" stroke="black" points="5113.75,-543.88 5103.19,-544.82 5112.03,-550.66 5113.75,-543.88"/>
</g>
<!-- l3_gate_tp3&#45;&gt;l3_exp2_gpu11 -->
<g id="edge880" class="edge">
<title>l3_gate_tp3&#45;&gt;l3_exp2_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5879.74,-627.73C5984.86,-609.92 6128.6,-582.86 6262.73,-547.4"/>
<polygon fill="black" stroke="black" points="6264.02,-550.68 6272.78,-544.72 6262.22,-543.91 6264.02,-550.68"/>
</g>
<!-- l3_gate_tp3&#45;&gt;l3_exp3_gpu11 -->
<g id="edge883" class="edge">
<title>l3_gate_tp3&#45;&gt;l3_exp3_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5850.48,-584.07C5870.07,-573.16 5889.75,-562.2 5907.52,-552.3"/>
<polygon fill="black" stroke="black" points="5909.6,-555.15 5916.63,-547.23 5906.19,-549.04 5909.6,-555.15"/>
</g>
<!-- l3_gate_tp3&#45;&gt;l3_exp4_gpu11 -->
<g id="edge886" class="edge">
<title>l3_gate_tp3&#45;&gt;l3_exp4_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5568.38,-584.07C5541.02,-572.71 5513.52,-561.3 5488.92,-551.08"/>
<polygon fill="black" stroke="black" points="5490.22,-547.83 5479.64,-547.23 5487.53,-554.3 5490.22,-547.83"/>
</g>
<!-- l3_gate_tp3&#45;&gt;l3_exp5_gpu11 -->
<g id="edge889" class="edge">
<title>l3_gate_tp3&#45;&gt;l3_exp5_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5662.21,-583.87C5652.1,-573.83 5641.95,-563.76 5632.64,-554.51"/>
<polygon fill="black" stroke="black" points="5634.93,-551.86 5625.37,-547.29 5630,-556.82 5634.93,-551.86"/>
</g>
<!-- l3_gate_tp3&#45;&gt;l3_exp6_gpu11 -->
<g id="edge892" class="edge">
<title>l3_gate_tp3&#45;&gt;l3_exp6_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5868.88,-610.17C5928.48,-592.27 5999.07,-570.67 6071.2,-547.4"/>
<polygon fill="black" stroke="black" points="6072.49,-550.66 6080.92,-544.25 6070.33,-544 6072.49,-550.66"/>
</g>
<!-- l3_gate_tp3&#45;&gt;l3_exp7_gpu11 -->
<g id="edge895" class="edge">
<title>l3_gate_tp3&#45;&gt;l3_exp7_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5756.53,-583.87C5760.17,-574.63 5763.82,-565.35 5767.22,-556.73"/>
<polygon fill="black" stroke="black" points="5770.53,-557.88 5770.94,-547.29 5764.02,-555.31 5770.53,-557.88"/>
</g>
<!-- l3_exp_agg_tp3 -->
<g id="node420" class="node">
<title>l3_exp_agg_tp3</title>
<polygon fill="lightyellow" stroke="black" points="6003.58,-442.17 5654.28,-442.17 5564.42,-306.17 5913.72,-306.17 6003.58,-442.17"/>
<text text-anchor="middle" x="5784" y="-392.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5784" y="-377.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="5784" y="-362.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="5784" y="-347.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l3_exp0_gpu11&#45;&gt;l3_exp_agg_tp3 -->
<g id="edge876" class="edge">
<title>l3_exp0_gpu11&#45;&gt;l3_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5295.24,-481.69C5298.19,-480.82 5301.11,-479.97 5304,-479.17 5407.61,-450.24 5525.66,-424.57 5618.77,-405.97"/>
<polygon fill="black" stroke="black" points="5619.72,-409.35 5628.85,-403.96 5618.35,-402.48 5619.72,-409.35"/>
</g>
<!-- l3_exp1_gpu11&#45;&gt;l3_exp_agg_tp3 -->
<g id="edge879" class="edge">
<title>l3_exp1_gpu11&#45;&gt;l3_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5103.18,-481.46C5106.15,-480.65 5109.09,-479.89 5112,-479.17 5279.29,-437.82 5474.29,-409.81 5611.01,-393.37"/>
<polygon fill="black" stroke="black" points="5611.65,-396.82 5621.16,-392.16 5610.82,-389.87 5611.65,-396.82"/>
</g>
<!-- l3_exp2_gpu11&#45;&gt;l3_exp_agg_tp3 -->
<g id="edge882" class="edge">
<title>l3_exp2_gpu11&#45;&gt;l3_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M6272.76,-481.69C6269.81,-480.82 6266.89,-479.97 6264,-479.17 6176.51,-454.74 6078.71,-432.64 5994.34,-415.15"/>
<polygon fill="black" stroke="black" points="5994.88,-411.69 5984.38,-413.09 5993.47,-418.54 5994.88,-411.69"/>
</g>
<!-- l3_exp3_gpu11&#45;&gt;l3_exp_agg_tp3 -->
<g id="edge885" class="edge">
<title>l3_exp3_gpu11&#45;&gt;l3_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5929.52,-479C5916.41,-469.65 5901.61,-459.08 5886.58,-448.36"/>
<polygon fill="black" stroke="black" points="5888.4,-445.36 5878.22,-442.4 5884.33,-451.06 5888.4,-445.36"/>
</g>
<!-- l3_exp4_gpu11&#45;&gt;l3_exp_agg_tp3 -->
<g id="edge888" class="edge">
<title>l3_exp4_gpu11&#45;&gt;l3_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5487.14,-481.08C5530.38,-465.65 5583.85,-446.57 5633.45,-428.88"/>
<polygon fill="black" stroke="black" points="5634.75,-432.13 5642.99,-425.48 5632.39,-425.54 5634.75,-432.13"/>
</g>
<!-- l3_exp5_gpu11&#45;&gt;l3_exp_agg_tp3 -->
<g id="edge891" class="edge">
<title>l3_exp5_gpu11&#45;&gt;l3_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5638.48,-479C5651.59,-469.65 5666.39,-459.08 5681.42,-448.36"/>
<polygon fill="black" stroke="black" points="5683.67,-451.06 5689.78,-442.4 5679.6,-445.36 5683.67,-451.06"/>
</g>
<!-- l3_exp6_gpu11&#45;&gt;l3_exp_agg_tp3 -->
<g id="edge894" class="edge">
<title>l3_exp6_gpu11&#45;&gt;l3_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M6080.86,-481.08C6051.13,-470.47 6016.56,-458.14 5981.73,-445.71"/>
<polygon fill="black" stroke="black" points="5982.5,-442.27 5971.91,-442.21 5980.15,-448.86 5982.5,-442.27"/>
</g>
<!-- l3_exp7_gpu11&#45;&gt;l3_exp_agg_tp3 -->
<g id="edge897" class="edge">
<title>l3_exp7_gpu11&#45;&gt;l3_exp_agg_tp3</title>
<path fill="none" stroke="black" d="M5784,-479C5784,-470.86 5784,-461.8 5784,-452.52"/>
<polygon fill="black" stroke="black" points="5787.5,-452.4 5784,-442.4 5780.5,-452.4 5787.5,-452.4"/>
</g>
<!-- l3_exp_agg_tp3&#45;&gt;l3_final_res_tp3 -->
<g id="edge898" class="edge">
<title>l3_exp_agg_tp3&#45;&gt;l3_final_res_tp3</title>
<path fill="none" stroke="black" d="M5933.67,-335.64C6021.14,-313.71 6133.44,-285.55 6232.33,-260.76"/>
<polygon fill="black" stroke="black" points="6233.31,-264.12 6242.16,-258.29 6231.61,-257.33 6233.31,-264.12"/>
</g>
<!-- l3_final_res_tp3&#45;&gt;output -->
<g id="edge900" class="edge">
<title>l3_final_res_tp3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M6644.37,-133.13C6684.73,-117.96 6726.32,-102.33 6762.52,-88.72"/>
<polygon fill="black" stroke="black" points="6763.97,-91.92 6772.1,-85.13 6761.5,-85.37 6763.97,-91.92"/>
</g>
<!-- l3_attn_tp4 -->
<g id="node423" class="node">
<title>l3_attn_tp4</title>
<polygon fill="lightgreen" stroke="black" points="7326,-1103.17 7112,-1103.17 7112,-1035.17 7326,-1035.17 7326,-1103.17"/>
<text text-anchor="middle" x="7219" y="-1087.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="7219" y="-1072.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="7219" y="-1057.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="7219" y="-1042.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_qkv_tp4&#45;&gt;l3_attn_tp4 -->
<g id="edge902" class="edge">
<title>l3_qkv_tp4&#45;&gt;l3_attn_tp4</title>
<path fill="none" stroke="black" d="M7216.97,-1140.01C7217.21,-1131.56 7217.48,-1122.34 7217.74,-1113.47"/>
<polygon fill="black" stroke="black" points="7221.24,-1113.36 7218.04,-1103.26 7214.25,-1113.16 7221.24,-1113.36"/>
</g>
<!-- l3_out_proj_tp4 -->
<g id="node424" class="node">
<title>l3_out_proj_tp4</title>
<polygon fill="lightgreen" stroke="black" points="7328,-998.17 7116,-998.17 7116,-930.17 7328,-930.17 7328,-998.17"/>
<text text-anchor="middle" x="7222" y="-982.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7222" y="-967.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="7222" y="-952.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="7222" y="-937.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_attn_tp4&#45;&gt;l3_out_proj_tp4 -->
<g id="edge903" class="edge">
<title>l3_attn_tp4&#45;&gt;l3_out_proj_tp4</title>
<path fill="none" stroke="black" d="M7219.97,-1035.01C7220.21,-1026.56 7220.48,-1017.34 7220.74,-1008.47"/>
<polygon fill="black" stroke="black" points="7224.24,-1008.36 7221.04,-998.26 7217.25,-1008.16 7224.24,-1008.36"/>
</g>
<!-- l3_out_proj_tp4&#45;&gt;l3_residual_tp4 -->
<g id="edge904" class="edge">
<title>l3_out_proj_tp4&#45;&gt;l3_residual_tp4</title>
<path fill="none" stroke="black" d="M7238.46,-930C7242.63,-921.6 7247.29,-912.22 7252.05,-902.63"/>
<polygon fill="black" stroke="black" points="7255.32,-903.91 7256.63,-893.4 7249.05,-900.8 7255.32,-903.91"/>
</g>
<!-- l3_gate_tp4 -->
<g id="node426" class="node">
<title>l3_gate_tp4</title>
<polygon fill="lightyellow" stroke="black" points="7547.2,-720.17 7217.59,-720.17 7132.8,-584.17 7462.41,-584.17 7547.2,-720.17"/>
<text text-anchor="middle" x="7340" y="-670.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="7340" y="-655.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="7340" y="-640.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="7340" y="-625.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_residual_tp4&#45;&gt;l3_gate_tp4 -->
<g id="edge906" class="edge">
<title>l3_residual_tp4&#45;&gt;l3_gate_tp4</title>
<path fill="none" stroke="black" d="M7309.62,-757.07C7312.21,-748.21 7314.88,-739.07 7317.52,-730.06"/>
<polygon fill="black" stroke="black" points="7320.91,-730.93 7320.36,-720.35 7314.19,-728.96 7320.91,-730.93"/>
</g>
<!-- l3_exp0_gpu12 -->
<g id="node427" class="node">
<title>l3_exp0_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="7235,-547.17 7061,-547.17 7061,-479.17 7235,-479.17 7235,-547.17"/>
<text text-anchor="middle" x="7148" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="7148" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7148" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7148" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_residual_tp4&#45;&gt;l3_exp0_gpu12 -->
<g id="edge908" class="edge">
<title>l3_residual_tp4&#45;&gt;l3_exp0_gpu12</title>
<path fill="none" stroke="black" d="M7129.8,-756.8C7117.66,-746.2 7107.03,-734.06 7099,-720.17 7068.75,-667.84 7080.83,-641.81 7099,-584.17 7102.08,-574.4 7107.06,-564.82 7112.69,-556.03"/>
<polygon fill="black" stroke="black" points="7115.75,-557.75 7118.49,-547.52 7109.96,-553.81 7115.75,-557.75"/>
</g>
<!-- l3_exp1_gpu12 -->
<g id="node428" class="node">
<title>l3_exp1_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="6659,-547.17 6485,-547.17 6485,-479.17 6659,-479.17 6659,-547.17"/>
<text text-anchor="middle" x="6572" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="6572" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6572" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6572" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_residual_tp4&#45;&gt;l3_exp1_gpu12 -->
<g id="edge911" class="edge">
<title>l3_residual_tp4&#45;&gt;l3_exp1_gpu12</title>
<path fill="none" stroke="black" d="M6941.7,-767.19C6899.3,-754.5 6857.43,-739.03 6819,-720.17 6734.07,-678.48 6653.36,-601.74 6608.49,-554.6"/>
<polygon fill="black" stroke="black" points="6611.01,-552.17 6601.6,-547.3 6605.92,-556.98 6611.01,-552.17"/>
</g>
<!-- l3_exp2_gpu12 -->
<g id="node429" class="node">
<title>l3_exp2_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="7427,-547.17 7253,-547.17 7253,-479.17 7427,-479.17 7427,-547.17"/>
<text text-anchor="middle" x="7340" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="7340" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7340" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7340" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_residual_tp4&#45;&gt;l3_exp2_gpu12 -->
<g id="edge914" class="edge">
<title>l3_residual_tp4&#45;&gt;l3_exp2_gpu12</title>
<path fill="none" stroke="black" d="M7153.83,-757.01C7142.01,-746.24 7131.66,-734 7124,-720.17 7094.73,-667.28 7088.1,-632.8 7124,-584.17 7155.33,-541.72 7187.24,-561.92 7243,-547.17"/>
<polygon fill="black" stroke="black" points="7244.32,-550.43 7252.92,-544.24 7242.34,-543.71 7244.32,-550.43"/>
</g>
<!-- l3_exp3_gpu12 -->
<g id="node430" class="node">
<title>l3_exp3_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="7811,-547.17 7637,-547.17 7637,-479.17 7811,-479.17 7811,-547.17"/>
<text text-anchor="middle" x="7724" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7724" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7724" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7724" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_residual_tp4&#45;&gt;l3_exp3_gpu12 -->
<g id="edge917" class="edge">
<title>l3_residual_tp4&#45;&gt;l3_exp3_gpu12</title>
<path fill="none" stroke="black" d="M7504.38,-759.32C7518.71,-753.06 7532.71,-746.34 7546,-739.17 7622.07,-698.09 7676.82,-609.27 7704.18,-556.34"/>
<polygon fill="black" stroke="black" points="7707.41,-557.72 7708.82,-547.22 7701.17,-554.55 7707.41,-557.72"/>
</g>
<!-- l3_exp4_gpu12 -->
<g id="node431" class="node">
<title>l3_exp4_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="7619,-547.17 7445,-547.17 7445,-479.17 7619,-479.17 7619,-547.17"/>
<text text-anchor="middle" x="7532" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="7532" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7532" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7532" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_residual_tp4&#45;&gt;l3_exp4_gpu12 -->
<g id="edge920" class="edge">
<title>l3_residual_tp4&#45;&gt;l3_exp4_gpu12</title>
<path fill="none" stroke="black" d="M7510.73,-764.77C7528.31,-752.57 7543.91,-737.88 7556,-720.17 7589.1,-671.69 7570.31,-601.4 7552.29,-556.75"/>
<polygon fill="black" stroke="black" points="7555.45,-555.23 7548.36,-547.36 7548.99,-557.93 7555.45,-555.23"/>
</g>
<!-- l3_exp5_gpu12 -->
<g id="node432" class="node">
<title>l3_exp5_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="6851,-547.17 6677,-547.17 6677,-479.17 6851,-479.17 6851,-547.17"/>
<text text-anchor="middle" x="6764" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="6764" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6764" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6764" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_residual_tp4&#45;&gt;l3_exp5_gpu12 -->
<g id="edge923" class="edge">
<title>l3_residual_tp4&#45;&gt;l3_exp5_gpu12</title>
<path fill="none" stroke="black" d="M7055.6,-757.07C7030.03,-746.25 7004.97,-733.98 6982,-720.17 6907.33,-675.27 6837.14,-601.06 6797.47,-555.04"/>
<polygon fill="black" stroke="black" points="6800.06,-552.67 6790.9,-547.34 6794.74,-557.22 6800.06,-552.67"/>
</g>
<!-- l3_exp6_gpu12 -->
<g id="node433" class="node">
<title>l3_exp6_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="7043,-547.17 6869,-547.17 6869,-479.17 7043,-479.17 7043,-547.17"/>
<text text-anchor="middle" x="6956" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="6956" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="6956" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="6956" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_residual_tp4&#45;&gt;l3_exp6_gpu12 -->
<g id="edge926" class="edge">
<title>l3_residual_tp4&#45;&gt;l3_exp6_gpu12</title>
<path fill="none" stroke="black" d="M7122.13,-757.15C7105.38,-746.34 7089.57,-734.05 7076,-720.17 7028.82,-671.92 6993.06,-601.57 6973.32,-556.85"/>
<polygon fill="black" stroke="black" points="6976.42,-555.21 6969.23,-547.43 6970,-558 6976.42,-555.21"/>
</g>
<!-- l3_exp7_gpu12 -->
<g id="node434" class="node">
<title>l3_exp7_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="8003,-547.17 7829,-547.17 7829,-479.17 8003,-479.17 8003,-547.17"/>
<text text-anchor="middle" x="7916" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="7916" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="7916" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="7916" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_residual_tp4&#45;&gt;l3_exp7_gpu12 -->
<g id="edge929" class="edge">
<title>l3_residual_tp4&#45;&gt;l3_exp7_gpu12</title>
<path fill="none" stroke="black" d="M7515.13,-769.07C7556.65,-755.47 7598.89,-739.22 7637,-720.17 7727.67,-674.84 7819.75,-600.03 7872.17,-554.13"/>
<polygon fill="black" stroke="black" points="7874.74,-556.53 7879.92,-547.3 7870.11,-551.28 7874.74,-556.53"/>
</g>
<!-- l3_final_res_tp4 -->
<g id="node436" class="node">
<title>l3_final_res_tp4</title>
<polygon fill="lightyellow" stroke="black" points="7594.93,-269.17 7023.95,-269.17 6877.07,-133.17 7448.05,-133.17 7594.93,-269.17"/>
<text text-anchor="middle" x="7236" y="-219.97" font-family="Times,serif" font-size="14.00">Layer 3 Final Residual</text>
<text text-anchor="middle" x="7236" y="-204.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="7236" y="-189.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="7236" y="-174.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_residual_tp4&#45;&gt;l3_final_res_tp4 -->
<g id="edge932" class="edge">
<title>l3_residual_tp4&#45;&gt;l3_final_res_tp4</title>
<path fill="none" stroke="black" d="M7560.23,-811.04C7768.8,-793.24 8022,-751.41 8022,-653.17 8022,-653.17 8022,-653.17 8022,-373.17 8022,-270.79 7764.17,-229.59 7543.84,-213.07"/>
<polygon fill="black" stroke="black" points="7543.94,-209.57 7533.71,-212.33 7543.43,-216.55 7543.94,-209.57"/>
</g>
<!-- l3_gate_tp4&#45;&gt;l3_exp0_gpu12 -->
<g id="edge907" class="edge">
<title>l3_gate_tp4&#45;&gt;l3_exp0_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7245.97,-584.07C7231.18,-573.52 7216.32,-562.92 7202.81,-553.28"/>
<polygon fill="black" stroke="black" points="7204.76,-550.36 7194.58,-547.41 7200.69,-556.06 7204.76,-550.36"/>
</g>
<!-- l3_gate_tp4&#45;&gt;l3_exp1_gpu12 -->
<g id="edge910" class="edge">
<title>l3_gate_tp4&#45;&gt;l3_exp1_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7162.86,-632.46C7028.9,-616.27 6840.74,-589.13 6668.91,-547.26"/>
<polygon fill="black" stroke="black" points="6669.73,-543.86 6659.18,-544.87 6668.06,-550.65 6669.73,-543.86"/>
</g>
<!-- l3_gate_tp4&#45;&gt;l3_exp2_gpu12 -->
<g id="edge913" class="edge">
<title>l3_gate_tp4&#45;&gt;l3_exp2_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7340,-583.87C7340,-574.93 7340,-565.95 7340,-557.56"/>
<polygon fill="black" stroke="black" points="7343.5,-557.29 7340,-547.29 7336.5,-557.29 7343.5,-557.29"/>
</g>
<!-- l3_gate_tp4&#45;&gt;l3_exp3_gpu12 -->
<g id="edge916" class="edge">
<title>l3_gate_tp4&#45;&gt;l3_exp3_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7474.57,-603.15C7524.83,-585.22 7580.87,-565.23 7627.08,-548.74"/>
<polygon fill="black" stroke="black" points="7628.54,-551.94 7636.79,-545.28 7626.19,-545.35 7628.54,-551.94"/>
</g>
<!-- l3_gate_tp4&#45;&gt;l3_exp4_gpu12 -->
<g id="edge919" class="edge">
<title>l3_gate_tp4&#45;&gt;l3_exp4_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7434.03,-584.07C7448.82,-573.52 7463.68,-562.92 7477.19,-553.28"/>
<polygon fill="black" stroke="black" points="7479.31,-556.06 7485.42,-547.41 7475.24,-550.36 7479.31,-556.06"/>
</g>
<!-- l3_gate_tp4&#45;&gt;l3_exp5_gpu12 -->
<g id="edge922" class="edge">
<title>l3_gate_tp4&#45;&gt;l3_exp5_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7152.4,-615.85C7066,-598.28 6962.19,-575.31 6861.02,-547.36"/>
<polygon fill="black" stroke="black" points="6861.81,-543.95 6851.24,-544.64 6859.94,-550.69 6861.81,-543.95"/>
</g>
<!-- l3_gate_tp4&#45;&gt;l3_exp6_gpu12 -->
<g id="edge925" class="edge">
<title>l3_gate_tp4&#45;&gt;l3_exp6_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7151.94,-584.07C7117.64,-571.84 7083.18,-559.54 7052.93,-548.75"/>
<polygon fill="black" stroke="black" points="7053.86,-545.36 7043.26,-545.3 7051.51,-551.96 7053.86,-545.36"/>
</g>
<!-- l3_gate_tp4&#45;&gt;l3_exp7_gpu12 -->
<g id="edge928" class="edge">
<title>l3_gate_tp4&#45;&gt;l3_exp7_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7487.36,-623.91C7580.28,-605.61 7702.73,-579.45 7818.97,-547.36"/>
<polygon fill="black" stroke="black" points="7820.06,-550.69 7828.76,-544.64 7818.19,-543.95 7820.06,-550.69"/>
</g>
<!-- l3_exp_agg_tp4 -->
<g id="node435" class="node">
<title>l3_exp_agg_tp4</title>
<polygon fill="lightyellow" stroke="black" points="7455.58,-442.17 7106.28,-442.17 7016.42,-306.17 7365.72,-306.17 7455.58,-442.17"/>
<text text-anchor="middle" x="7236" y="-392.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7236" y="-377.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="7236" y="-362.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="7236" y="-347.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_exp0_gpu12&#45;&gt;l3_exp_agg_tp4 -->
<g id="edge909" class="edge">
<title>l3_exp0_gpu12&#45;&gt;l3_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7169.3,-479C7174.81,-470.43 7180.97,-460.84 7187.26,-451.04"/>
<polygon fill="black" stroke="black" points="7190.35,-452.71 7192.81,-442.4 7184.46,-448.92 7190.35,-452.71"/>
</g>
<!-- l3_exp1_gpu12&#45;&gt;l3_exp_agg_tp4 -->
<g id="edge912" class="edge">
<title>l3_exp1_gpu12&#45;&gt;l3_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M6659.21,-481.57C6662.16,-480.73 6665.1,-479.93 6668,-479.17 6800.27,-444.53 6952.81,-417.28 7066.49,-399.38"/>
<polygon fill="black" stroke="black" points="7067.34,-402.79 7076.68,-397.79 7066.26,-395.88 7067.34,-402.79"/>
</g>
<!-- l3_exp2_gpu12&#45;&gt;l3_exp_agg_tp4 -->
<g id="edge915" class="edge">
<title>l3_exp2_gpu12&#45;&gt;l3_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7314.82,-479C7308.18,-470.25 7300.74,-460.45 7293.15,-450.45"/>
<polygon fill="black" stroke="black" points="7295.87,-448.25 7287.04,-442.4 7290.3,-452.48 7295.87,-448.25"/>
</g>
<!-- l3_exp3_gpu12&#45;&gt;l3_exp_agg_tp4 -->
<g id="edge918" class="edge">
<title>l3_exp3_gpu12&#45;&gt;l3_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7636.97,-481.94C7633.95,-480.99 7630.95,-480.06 7628,-479.17 7572.6,-462.32 7512.34,-445.56 7456.05,-430.58"/>
<polygon fill="black" stroke="black" points="7456.89,-427.18 7446.33,-428 7455.09,-433.94 7456.89,-427.18"/>
</g>
<!-- l3_exp4_gpu12&#45;&gt;l3_exp_agg_tp4 -->
<g id="edge921" class="edge">
<title>l3_exp4_gpu12&#45;&gt;l3_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7460.35,-479C7439.03,-469.14 7414.8,-457.92 7390.35,-446.6"/>
<polygon fill="black" stroke="black" points="7391.51,-443.29 7380.97,-442.26 7388.57,-449.64 7391.51,-443.29"/>
</g>
<!-- l3_exp5_gpu12&#45;&gt;l3_exp_agg_tp4 -->
<g id="edge924" class="edge">
<title>l3_exp5_gpu12&#45;&gt;l3_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M6851.04,-481.98C6854.06,-481.02 6857.05,-480.08 6860,-479.17 6931.07,-457.15 7010.37,-434.88 7077.76,-416.62"/>
<polygon fill="black" stroke="black" points="7078.88,-419.95 7087.62,-413.96 7077.05,-413.19 7078.88,-419.95"/>
</g>
<!-- l3_exp6_gpu12&#45;&gt;l3_exp_agg_tp4 -->
<g id="edge927" class="edge">
<title>l3_exp6_gpu12&#45;&gt;l3_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7023.78,-479C7045.47,-468.39 7070.35,-456.21 7095.27,-444.03"/>
<polygon fill="black" stroke="black" points="7096.99,-447.08 7104.44,-439.54 7093.92,-440.79 7096.99,-447.08"/>
</g>
<!-- l3_exp7_gpu12&#45;&gt;l3_exp_agg_tp4 -->
<g id="edge930" class="edge">
<title>l3_exp7_gpu12&#45;&gt;l3_exp_agg_tp4</title>
<path fill="none" stroke="black" d="M7828.8,-481.55C7825.84,-480.72 7822.9,-479.92 7820,-479.17 7694.93,-446.74 7552.18,-421.12 7439.12,-403.42"/>
<polygon fill="black" stroke="black" points="7439.38,-399.92 7428.97,-401.84 7438.31,-406.84 7439.38,-399.92"/>
</g>
<!-- l3_exp_agg_tp4&#45;&gt;l3_final_res_tp4 -->
<g id="edge931" class="edge">
<title>l3_exp_agg_tp4&#45;&gt;l3_final_res_tp4</title>
<path fill="none" stroke="black" d="M7236,-306.07C7236,-297.4 7236,-288.46 7236,-279.63"/>
<polygon fill="black" stroke="black" points="7239.5,-279.35 7236,-269.35 7232.5,-279.35 7239.5,-279.35"/>
</g>
<!-- l3_final_res_tp4&#45;&gt;output -->
<g id="edge933" class="edge">
<title>l3_final_res_tp4&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7072.71,-133.13C7037.13,-118.52 7000.51,-103.48 6968.24,-90.24"/>
<polygon fill="black" stroke="black" points="6969.4,-86.93 6958.82,-86.37 6966.74,-93.41 6969.4,-86.93"/>
</g>
<!-- l3_attn_tp5 -->
<g id="node438" class="node">
<title>l3_attn_tp5</title>
<polygon fill="lightgreen" stroke="black" points="9020,-1103.17 8806,-1103.17 8806,-1035.17 9020,-1035.17 9020,-1103.17"/>
<text text-anchor="middle" x="8913" y="-1087.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="8913" y="-1072.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="8913" y="-1057.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="8913" y="-1042.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_qkv_tp5&#45;&gt;l3_attn_tp5 -->
<g id="edge935" class="edge">
<title>l3_qkv_tp5&#45;&gt;l3_attn_tp5</title>
<path fill="none" stroke="black" d="M8910.97,-1140.01C8911.21,-1131.56 8911.48,-1122.34 8911.74,-1113.47"/>
<polygon fill="black" stroke="black" points="8915.24,-1113.36 8912.04,-1103.26 8908.25,-1113.16 8915.24,-1113.36"/>
</g>
<!-- l3_out_proj_tp5 -->
<g id="node439" class="node">
<title>l3_out_proj_tp5</title>
<polygon fill="lightgreen" stroke="black" points="9022,-998.17 8810,-998.17 8810,-930.17 9022,-930.17 9022,-998.17"/>
<text text-anchor="middle" x="8916" y="-982.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8916" y="-967.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="8916" y="-952.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="8916" y="-937.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_attn_tp5&#45;&gt;l3_out_proj_tp5 -->
<g id="edge936" class="edge">
<title>l3_attn_tp5&#45;&gt;l3_out_proj_tp5</title>
<path fill="none" stroke="black" d="M8913.97,-1035.01C8914.21,-1026.56 8914.48,-1017.34 8914.74,-1008.47"/>
<polygon fill="black" stroke="black" points="8918.24,-1008.36 8915.04,-998.26 8911.25,-1008.16 8918.24,-1008.36"/>
</g>
<!-- l3_out_proj_tp5&#45;&gt;l3_residual_tp5 -->
<g id="edge937" class="edge">
<title>l3_out_proj_tp5&#45;&gt;l3_residual_tp5</title>
<path fill="none" stroke="black" d="M8938.75,-930C8944.7,-921.34 8951.35,-911.64 8958.14,-901.74"/>
<polygon fill="black" stroke="black" points="8961.1,-903.63 8963.87,-893.4 8955.33,-899.67 8961.1,-903.63"/>
</g>
<!-- l3_gate_tp5 -->
<g id="node441" class="node">
<title>l3_gate_tp5</title>
<polygon fill="lightyellow" stroke="black" points="9049.2,-720.17 8719.59,-720.17 8634.8,-584.17 8964.41,-584.17 9049.2,-720.17"/>
<text text-anchor="middle" x="8842" y="-670.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="8842" y="-655.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="8842" y="-640.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="8842" y="-625.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_residual_tp5&#45;&gt;l3_gate_tp5 -->
<g id="edge939" class="edge">
<title>l3_residual_tp5&#45;&gt;l3_gate_tp5</title>
<path fill="none" stroke="black" d="M8944.08,-757.07C8934.63,-747.46 8924.86,-737.51 8915.28,-727.76"/>
<polygon fill="black" stroke="black" points="8917.51,-725.03 8908,-720.35 8912.51,-729.93 8917.51,-725.03"/>
</g>
<!-- l3_exp0_gpu13 -->
<g id="node442" class="node">
<title>l3_exp0_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="8599,-547.17 8425,-547.17 8425,-479.17 8599,-479.17 8599,-547.17"/>
<text text-anchor="middle" x="8512" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8512" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8512" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8512" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_residual_tp5&#45;&gt;l3_exp0_gpu13 -->
<g id="edge941" class="edge">
<title>l3_residual_tp5&#45;&gt;l3_exp0_gpu13</title>
<path fill="none" stroke="black" d="M8667.98,-757.08C8636.66,-746.03 8611.59,-733.7 8598,-720.17 8552.95,-675.28 8530.32,-603.3 8519.87,-557.4"/>
<polygon fill="black" stroke="black" points="8523.26,-556.49 8517.71,-547.46 8516.42,-557.98 8523.26,-556.49"/>
</g>
<!-- l3_exp1_gpu13 -->
<g id="node443" class="node">
<title>l3_exp1_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="8407,-547.17 8233,-547.17 8233,-479.17 8407,-479.17 8407,-547.17"/>
<text text-anchor="middle" x="8320" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="8320" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8320" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8320" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_residual_tp5&#45;&gt;l3_exp1_gpu13 -->
<g id="edge944" class="edge">
<title>l3_residual_tp5&#45;&gt;l3_exp1_gpu13</title>
<path fill="none" stroke="black" d="M8676.06,-780.35C8622.6,-765.71 8569.35,-746.19 8522,-720.17 8448.09,-679.54 8384.01,-603.23 8348.81,-555.76"/>
<polygon fill="black" stroke="black" points="8351.52,-553.53 8342.79,-547.53 8345.87,-557.67 8351.52,-553.53"/>
</g>
<!-- l3_exp2_gpu13 -->
<g id="node444" class="node">
<title>l3_exp2_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="8791,-547.17 8617,-547.17 8617,-479.17 8791,-479.17 8791,-547.17"/>
<text text-anchor="middle" x="8704" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="8704" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8704" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8704" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_residual_tp5&#45;&gt;l3_exp2_gpu13 -->
<g id="edge947" class="edge">
<title>l3_residual_tp5&#45;&gt;l3_exp2_gpu13</title>
<path fill="none" stroke="black" d="M8684.61,-757.16C8657.54,-746.2 8636.49,-733.88 8626,-720.17 8589.27,-672.16 8601.37,-639.37 8626,-584.17 8630.92,-573.13 8638.54,-563.11 8647.12,-554.32"/>
<polygon fill="black" stroke="black" points="8649.72,-556.68 8654.52,-547.23 8644.88,-551.63 8649.72,-556.68"/>
</g>
<!-- l3_exp3_gpu13 -->
<g id="node445" class="node">
<title>l3_exp3_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="9367,-547.17 9193,-547.17 9193,-479.17 9367,-479.17 9367,-547.17"/>
<text text-anchor="middle" x="9280" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9280" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9280" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9280" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_residual_tp5&#45;&gt;l3_exp3_gpu13 -->
<g id="edge950" class="edge">
<title>l3_residual_tp5&#45;&gt;l3_exp3_gpu13</title>
<path fill="none" stroke="black" d="M9068.59,-756.9C9122.14,-695.42 9199.61,-606.47 9244.38,-555.06"/>
<polygon fill="black" stroke="black" points="9247.08,-557.29 9251.01,-547.45 9241.8,-552.69 9247.08,-557.29"/>
</g>
<!-- l3_exp4_gpu13 -->
<g id="node446" class="node">
<title>l3_exp4_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="9175,-547.17 9001,-547.17 9001,-479.17 9175,-479.17 9175,-547.17"/>
<text text-anchor="middle" x="9088" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="9088" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9088" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9088" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_residual_tp5&#45;&gt;l3_exp4_gpu13 -->
<g id="edge953" class="edge">
<title>l3_residual_tp5&#45;&gt;l3_exp4_gpu13</title>
<path fill="none" stroke="black" d="M9064.83,-756.99C9067.99,-751.17 9070.78,-745.2 9073,-739.17 9095.1,-679.04 9095.08,-603.86 9092.18,-557.43"/>
<polygon fill="black" stroke="black" points="9095.67,-557.14 9091.48,-547.4 9088.69,-557.62 9095.67,-557.14"/>
</g>
<!-- l3_exp5_gpu13 -->
<g id="node447" class="node">
<title>l3_exp5_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="8983,-547.17 8809,-547.17 8809,-479.17 8983,-479.17 8983,-547.17"/>
<text text-anchor="middle" x="8896" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="8896" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8896" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8896" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_residual_tp5&#45;&gt;l3_exp5_gpu13 -->
<g id="edge956" class="edge">
<title>l3_residual_tp5&#45;&gt;l3_exp5_gpu13</title>
<path fill="none" stroke="black" d="M9046.01,-757.11C9050.97,-745.11 9055.29,-732.5 9058,-720.17 9064.48,-690.65 9074.6,-609.42 9058,-584.17 9053.52,-577.35 9024.74,-564.09 8992.64,-550.93"/>
<polygon fill="black" stroke="black" points="8993.64,-547.56 8983.06,-547.04 8991.01,-554.05 8993.64,-547.56"/>
</g>
<!-- l3_exp6_gpu13 -->
<g id="node448" class="node">
<title>l3_exp6_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="8215,-547.17 8041,-547.17 8041,-479.17 8215,-479.17 8215,-547.17"/>
<text text-anchor="middle" x="8128" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="8128" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="8128" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="8128" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_residual_tp5&#45;&gt;l3_exp6_gpu13 -->
<g id="edge959" class="edge">
<title>l3_residual_tp5&#45;&gt;l3_exp6_gpu13</title>
<path fill="none" stroke="black" d="M8707.43,-809.67C8596.39,-795.59 8472.2,-769.16 8367,-720.17 8282.57,-680.84 8204.86,-602.88 8162.19,-554.95"/>
<polygon fill="black" stroke="black" points="8164.63,-552.43 8155.39,-547.24 8159.38,-557.05 8164.63,-552.43"/>
</g>
<!-- l3_exp7_gpu13 -->
<g id="node449" class="node">
<title>l3_exp7_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="9559,-547.17 9385,-547.17 9385,-479.17 9559,-479.17 9559,-547.17"/>
<text text-anchor="middle" x="9472" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="9472" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9472" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9472" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_residual_tp5&#45;&gt;l3_exp7_gpu13 -->
<g id="edge962" class="edge">
<title>l3_residual_tp5&#45;&gt;l3_exp7_gpu13</title>
<path fill="none" stroke="black" d="M9109.96,-757.09C9202.83,-694.78 9337.92,-604.14 9414.1,-553.02"/>
<polygon fill="black" stroke="black" points="9416.29,-555.77 9422.64,-547.29 9412.39,-549.95 9416.29,-555.77"/>
</g>
<!-- l3_final_res_tp5 -->
<g id="node451" class="node">
<title>l3_final_res_tp5</title>
<polygon fill="lightyellow" stroke="black" points="9134.93,-269.17 8563.95,-269.17 8417.07,-133.17 8988.05,-133.17 9134.93,-269.17"/>
<text text-anchor="middle" x="8776" y="-219.97" font-family="Times,serif" font-size="14.00">Layer 3 Final Residual</text>
<text text-anchor="middle" x="8776" y="-204.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="8776" y="-189.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="8776" y="-174.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_residual_tp5&#45;&gt;l3_final_res_tp5 -->
<g id="edge965" class="edge">
<title>l3_residual_tp5&#45;&gt;l3_final_res_tp5</title>
<path fill="none" stroke="black" d="M9262.03,-793.75C9413.84,-768.12 9578,-724.03 9578,-653.17 9578,-653.17 9578,-653.17 9578,-373.17 9578,-267.56 9308.65,-226.93 9082.14,-211.43"/>
<polygon fill="black" stroke="black" points="9082.28,-207.93 9072.07,-210.75 9081.82,-214.91 9082.28,-207.93"/>
</g>
<!-- l3_gate_tp5&#45;&gt;l3_exp0_gpu13 -->
<g id="edge940" class="edge">
<title>l3_gate_tp5&#45;&gt;l3_exp0_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8680.38,-584.07C8653.02,-572.71 8625.52,-561.3 8600.92,-551.08"/>
<polygon fill="black" stroke="black" points="8602.22,-547.83 8591.64,-547.23 8599.53,-554.3 8602.22,-547.83"/>
</g>
<!-- l3_gate_tp5&#45;&gt;l3_exp1_gpu13 -->
<g id="edge943" class="edge">
<title>l3_gate_tp5&#45;&gt;l3_exp1_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8647.42,-604.52C8554.98,-582.22 8457.38,-558.42 8416.71,-547.22"/>
<polygon fill="black" stroke="black" points="8417.58,-543.83 8407.01,-544.46 8415.67,-550.56 8417.58,-543.83"/>
</g>
<!-- l3_gate_tp5&#45;&gt;l3_exp2_gpu13 -->
<g id="edge946" class="edge">
<title>l3_gate_tp5&#45;&gt;l3_exp2_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8774.21,-583.87C8764.1,-573.83 8753.95,-563.76 8744.64,-554.51"/>
<polygon fill="black" stroke="black" points="8746.93,-551.86 8737.37,-547.29 8742,-556.82 8746.93,-551.86"/>
</g>
<!-- l3_gate_tp5&#45;&gt;l3_exp3_gpu13 -->
<g id="edge949" class="edge">
<title>l3_gate_tp5&#45;&gt;l3_exp3_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8980.88,-610.17C9040.48,-592.27 9111.07,-570.67 9183.2,-547.4"/>
<polygon fill="black" stroke="black" points="9184.49,-550.66 9192.92,-544.25 9182.33,-544 9184.49,-550.66"/>
</g>
<!-- l3_gate_tp5&#45;&gt;l3_exp4_gpu13 -->
<g id="edge952" class="edge">
<title>l3_gate_tp5&#45;&gt;l3_exp4_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8962.48,-584.07C8982.07,-573.16 9001.75,-562.2 9019.52,-552.3"/>
<polygon fill="black" stroke="black" points="9021.6,-555.15 9028.63,-547.23 9018.19,-549.04 9021.6,-555.15"/>
</g>
<!-- l3_gate_tp5&#45;&gt;l3_exp5_gpu13 -->
<g id="edge955" class="edge">
<title>l3_gate_tp5&#45;&gt;l3_exp5_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8868.53,-583.87C8872.17,-574.63 8875.82,-565.35 8879.22,-556.73"/>
<polygon fill="black" stroke="black" points="8882.53,-557.88 8882.94,-547.29 8876.02,-555.31 8882.53,-557.88"/>
</g>
<!-- l3_gate_tp5&#45;&gt;l3_exp6_gpu13 -->
<g id="edge958" class="edge">
<title>l3_gate_tp5&#45;&gt;l3_exp6_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8662.56,-628.92C8541.01,-611.96 8377,-585.39 8225.18,-547.34"/>
<polygon fill="black" stroke="black" points="8225.75,-543.88 8215.19,-544.82 8224.03,-550.66 8225.75,-543.88"/>
</g>
<!-- l3_gate_tp5&#45;&gt;l3_exp7_gpu13 -->
<g id="edge961" class="edge">
<title>l3_gate_tp5&#45;&gt;l3_exp7_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8989.17,-623.59C9125.3,-597.92 9314.37,-561.79 9374.76,-547.25"/>
<polygon fill="black" stroke="black" points="9375.94,-550.57 9384.78,-544.72 9374.23,-543.78 9375.94,-550.57"/>
</g>
<!-- l3_exp_agg_tp5 -->
<g id="node450" class="node">
<title>l3_exp_agg_tp5</title>
<polygon fill="lightyellow" stroke="black" points="8995.58,-442.17 8646.28,-442.17 8556.42,-306.17 8905.72,-306.17 8995.58,-442.17"/>
<text text-anchor="middle" x="8776" y="-392.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8776" y="-377.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="8776" y="-362.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="8776" y="-347.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_exp0_gpu13&#45;&gt;l3_exp_agg_tp5 -->
<g id="edge942" class="edge">
<title>l3_exp0_gpu13&#45;&gt;l3_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8575.91,-479C8594.75,-469.22 8616.14,-458.12 8637.76,-446.9"/>
<polygon fill="black" stroke="black" points="8639.44,-449.98 8646.7,-442.26 8636.22,-443.76 8639.44,-449.98"/>
</g>
<!-- l3_exp1_gpu13&#45;&gt;l3_exp_agg_tp5 -->
<g id="edge945" class="edge">
<title>l3_exp1_gpu13&#45;&gt;l3_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8407.06,-482.03C8410.07,-481.05 8413.06,-480.1 8416,-479.17 8482.23,-458.23 8555.83,-436.67 8619.14,-418.64"/>
<polygon fill="black" stroke="black" points="8620.15,-422 8628.81,-415.9 8618.23,-415.26 8620.15,-422"/>
</g>
<!-- l3_exp2_gpu13&#45;&gt;l3_exp_agg_tp5 -->
<g id="edge948" class="edge">
<title>l3_exp2_gpu13&#45;&gt;l3_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8721.43,-479C8725.89,-470.51 8730.88,-461.03 8735.97,-451.34"/>
<polygon fill="black" stroke="black" points="8739.11,-452.88 8740.67,-442.4 8732.92,-449.62 8739.11,-452.88"/>
</g>
<!-- l3_exp3_gpu13&#45;&gt;l3_exp_agg_tp5 -->
<g id="edge951" class="edge">
<title>l3_exp3_gpu13&#45;&gt;l3_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M9192.98,-481.91C9189.95,-480.97 9186.96,-480.05 9184,-479.17 9122.75,-460.87 9055.74,-442.93 8994.05,-427.25"/>
<polygon fill="black" stroke="black" points="8994.75,-423.82 8984.2,-424.76 8993.03,-430.61 8994.75,-423.82"/>
</g>
<!-- l3_exp4_gpu13&#45;&gt;l3_exp_agg_tp5 -->
<g id="edge954" class="edge">
<title>l3_exp4_gpu13&#45;&gt;l3_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M9012.47,-479C8989.81,-469.05 8964.02,-457.73 8938.01,-446.31"/>
<polygon fill="black" stroke="black" points="8939.37,-443.08 8928.8,-442.26 8936.55,-449.49 8939.37,-443.08"/>
</g>
<!-- l3_exp5_gpu13&#45;&gt;l3_exp_agg_tp5 -->
<g id="edge957" class="edge">
<title>l3_exp5_gpu13&#45;&gt;l3_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8866.95,-479C8859.21,-470.17 8850.53,-460.25 8841.68,-450.15"/>
<polygon fill="black" stroke="black" points="8844.11,-447.62 8834.89,-442.4 8838.85,-452.23 8844.11,-447.62"/>
</g>
<!-- l3_exp6_gpu13&#45;&gt;l3_exp_agg_tp5 -->
<g id="edge960" class="edge">
<title>l3_exp6_gpu13&#45;&gt;l3_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M8215.21,-481.59C8218.17,-480.74 8221.1,-479.93 8224,-479.17 8350.96,-445.57 8497.1,-418.54 8607.11,-400.47"/>
<polygon fill="black" stroke="black" points="8608,-403.87 8617.31,-398.8 8606.87,-396.96 8608,-403.87"/>
</g>
<!-- l3_exp7_gpu13&#45;&gt;l3_exp_agg_tp5 -->
<g id="edge963" class="edge">
<title>l3_exp7_gpu13&#45;&gt;l3_exp_agg_tp5</title>
<path fill="none" stroke="black" d="M9384.8,-481.53C9381.84,-480.7 9378.9,-479.91 9376,-479.17 9245.16,-445.57 9095.46,-419.6 8978.31,-402.02"/>
<polygon fill="black" stroke="black" points="8978.56,-398.51 8968.16,-400.5 8977.53,-405.44 8978.56,-398.51"/>
</g>
<!-- l3_exp_agg_tp5&#45;&gt;l3_final_res_tp5 -->
<g id="edge964" class="edge">
<title>l3_exp_agg_tp5&#45;&gt;l3_final_res_tp5</title>
<path fill="none" stroke="black" d="M8776,-306.07C8776,-297.4 8776,-288.46 8776,-279.63"/>
<polygon fill="black" stroke="black" points="8779.5,-279.35 8776,-269.35 8772.5,-279.35 8779.5,-279.35"/>
</g>
<!-- l3_final_res_tp5&#45;&gt;output -->
<g id="edge966" class="edge">
<title>l3_final_res_tp5&#45;&gt;output</title>
<path fill="none" stroke="black" d="M8462.54,-175.35C8048.65,-142.57 7335.8,-86.13 7022.89,-61.35"/>
<polygon fill="black" stroke="black" points="7023.09,-57.85 7012.84,-60.55 7022.53,-64.83 7023.09,-57.85"/>
</g>
<!-- l3_attn_tp6 -->
<g id="node453" class="node">
<title>l3_attn_tp6</title>
<polygon fill="lightgreen" stroke="black" points="10559,-1103.17 10345,-1103.17 10345,-1035.17 10559,-1035.17 10559,-1103.17"/>
<text text-anchor="middle" x="10452" y="-1087.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="10452" y="-1072.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="10452" y="-1057.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="10452" y="-1042.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_qkv_tp6&#45;&gt;l3_attn_tp6 -->
<g id="edge968" class="edge">
<title>l3_qkv_tp6&#45;&gt;l3_attn_tp6</title>
<path fill="none" stroke="black" d="M10450.64,-1140.01C10450.81,-1131.56 10450.99,-1122.34 10451.16,-1113.47"/>
<polygon fill="black" stroke="black" points="10454.66,-1113.33 10451.36,-1103.26 10447.66,-1113.19 10454.66,-1113.33"/>
</g>
<!-- l3_out_proj_tp6 -->
<g id="node454" class="node">
<title>l3_out_proj_tp6</title>
<polygon fill="lightgreen" stroke="black" points="10558,-998.17 10346,-998.17 10346,-930.17 10558,-930.17 10558,-998.17"/>
<text text-anchor="middle" x="10452" y="-982.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10452" y="-967.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="10452" y="-952.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="10452" y="-937.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_attn_tp6&#45;&gt;l3_out_proj_tp6 -->
<g id="edge969" class="edge">
<title>l3_attn_tp6&#45;&gt;l3_out_proj_tp6</title>
<path fill="none" stroke="black" d="M10452,-1035.01C10452,-1026.56 10452,-1017.34 10452,-1008.47"/>
<polygon fill="black" stroke="black" points="10455.5,-1008.26 10452,-998.26 10448.5,-1008.26 10455.5,-1008.26"/>
</g>
<!-- l3_out_proj_tp6&#45;&gt;l3_residual_tp6 -->
<g id="edge970" class="edge">
<title>l3_out_proj_tp6&#45;&gt;l3_residual_tp6</title>
<path fill="none" stroke="black" d="M10452,-930C10452,-921.86 10452,-912.8 10452,-903.52"/>
<polygon fill="black" stroke="black" points="10455.5,-903.4 10452,-893.4 10448.5,-903.4 10455.5,-903.4"/>
</g>
<!-- l3_gate_tp6 -->
<g id="node456" class="node">
<title>l3_gate_tp6</title>
<polygon fill="lightyellow" stroke="black" points="10659.2,-720.17 10329.59,-720.17 10244.8,-584.17 10574.41,-584.17 10659.2,-720.17"/>
<text text-anchor="middle" x="10452" y="-670.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="10452" y="-655.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="10452" y="-640.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="10452" y="-625.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_residual_tp6&#45;&gt;l3_gate_tp6 -->
<g id="edge972" class="edge">
<title>l3_residual_tp6&#45;&gt;l3_gate_tp6</title>
<path fill="none" stroke="black" d="M10452,-757.07C10452,-748.4 10452,-739.46 10452,-730.63"/>
<polygon fill="black" stroke="black" points="10455.5,-730.35 10452,-720.35 10448.5,-730.35 10455.5,-730.35"/>
</g>
<!-- l3_exp0_gpu14 -->
<g id="node457" class="node">
<title>l3_exp0_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="9963,-547.17 9789,-547.17 9789,-479.17 9963,-479.17 9963,-547.17"/>
<text text-anchor="middle" x="9876" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="9876" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9876" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9876" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_residual_tp6&#45;&gt;l3_exp0_gpu14 -->
<g id="edge974" class="edge">
<title>l3_residual_tp6&#45;&gt;l3_exp0_gpu14</title>
<path fill="none" stroke="black" d="M10176.65,-757.16C10149.34,-746.45 10122.64,-734.17 10098,-720.17 10021.3,-676.57 9949.77,-601.62 9909.59,-555.15"/>
<polygon fill="black" stroke="black" points="9912.1,-552.7 9902.93,-547.39 9906.78,-557.26 9912.1,-552.7"/>
</g>
<!-- l3_exp1_gpu14 -->
<g id="node458" class="node">
<title>l3_exp1_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="10155,-547.17 9981,-547.17 9981,-479.17 10155,-479.17 10155,-547.17"/>
<text text-anchor="middle" x="10068" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="10068" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10068" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10068" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_residual_tp6&#45;&gt;l3_exp1_gpu14 -->
<g id="edge977" class="edge">
<title>l3_residual_tp6&#45;&gt;l3_exp1_gpu14</title>
<path fill="none" stroke="black" d="M10244.2,-757.03C10227.33,-746.42 10211.58,-734.21 10198,-720.17 10150.1,-670.65 10110.52,-600.73 10088.07,-556.43"/>
<polygon fill="black" stroke="black" points="10091.14,-554.76 10083.54,-547.38 10084.88,-557.89 10091.14,-554.76"/>
</g>
<!-- l3_exp2_gpu14 -->
<g id="node459" class="node">
<title>l3_exp2_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="9771,-547.17 9597,-547.17 9597,-479.17 9771,-479.17 9771,-547.17"/>
<text text-anchor="middle" x="9684" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="9684" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="9684" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="9684" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_residual_tp6&#45;&gt;l3_exp2_gpu14 -->
<g id="edge980" class="edge">
<title>l3_residual_tp6&#45;&gt;l3_exp2_gpu14</title>
<path fill="none" stroke="black" d="M10121.9,-784.07C10056.7,-769.07 9990.18,-748.47 9931,-720.17 9845.65,-679.35 9765.08,-602.32 9720.35,-554.9"/>
<polygon fill="black" stroke="black" points="9722.87,-552.47 9713.48,-547.55 9717.75,-557.25 9722.87,-552.47"/>
</g>
<!-- l3_exp3_gpu14 -->
<g id="node460" class="node">
<title>l3_exp3_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="10347,-547.17 10173,-547.17 10173,-479.17 10347,-479.17 10347,-547.17"/>
<text text-anchor="middle" x="10260" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="10260" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10260" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10260" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_residual_tp6&#45;&gt;l3_exp3_gpu14 -->
<g id="edge983" class="edge">
<title>l3_residual_tp6&#45;&gt;l3_exp3_gpu14</title>
<path fill="none" stroke="black" d="M10247.05,-756.82C10235.75,-746.32 10226.12,-734.19 10219,-720.17 10191.63,-666.27 10203.17,-642.5 10219,-584.17 10221.57,-574.68 10225.79,-565.17 10230.56,-556.35"/>
<polygon fill="black" stroke="black" points="10233.74,-557.85 10235.69,-547.43 10227.67,-554.36 10233.74,-557.85"/>
</g>
<!-- l3_exp4_gpu14 -->
<g id="node461" class="node">
<title>l3_exp4_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="11115,-547.17 10941,-547.17 10941,-479.17 11115,-479.17 11115,-547.17"/>
<text text-anchor="middle" x="11028" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="11028" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11028" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11028" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_residual_tp6&#45;&gt;l3_exp4_gpu14 -->
<g id="edge986" class="edge">
<title>l3_residual_tp6&#45;&gt;l3_exp4_gpu14</title>
<path fill="none" stroke="black" d="M10664.72,-757.67C10692.95,-746.4 10721.07,-733.86 10747,-720.17 10836.55,-672.89 10929.14,-599.35 10982.51,-554.12"/>
<polygon fill="black" stroke="black" points="10985.07,-556.53 10990.41,-547.38 10980.53,-551.21 10985.07,-556.53"/>
</g>
<!-- l3_exp5_gpu14 -->
<g id="node462" class="node">
<title>l3_exp5_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="10539,-547.17 10365,-547.17 10365,-479.17 10539,-479.17 10539,-547.17"/>
<text text-anchor="middle" x="10452" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10452" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10452" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10452" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_residual_tp6&#45;&gt;l3_exp5_gpu14 -->
<g id="edge989" class="edge">
<title>l3_residual_tp6&#45;&gt;l3_exp5_gpu14</title>
<path fill="none" stroke="black" d="M10269.09,-757.1C10256.22,-746.49 10244.86,-734.26 10236,-720.17 10219.92,-694.58 10218.05,-608.48 10236,-584.17 10267.33,-541.72 10299.24,-561.92 10355,-547.17"/>
<polygon fill="black" stroke="black" points="10356.32,-550.43 10364.92,-544.24 10354.34,-543.71 10356.32,-550.43"/>
</g>
<!-- l3_exp6_gpu14 -->
<g id="node463" class="node">
<title>l3_exp6_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="10923,-547.17 10749,-547.17 10749,-479.17 10923,-479.17 10923,-547.17"/>
<text text-anchor="middle" x="10836" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="10836" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10836" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10836" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_residual_tp6&#45;&gt;l3_exp6_gpu14 -->
<g id="edge992" class="edge">
<title>l3_residual_tp6&#45;&gt;l3_exp6_gpu14</title>
<path fill="none" stroke="black" d="M10627.12,-757.08C10638.1,-751.4 10648.82,-745.42 10659,-739.17 10731.9,-694.37 10786.8,-608.06 10814.94,-556.34"/>
<polygon fill="black" stroke="black" points="10818.08,-557.88 10819.72,-547.41 10811.91,-554.58 10818.08,-557.88"/>
</g>
<!-- l3_exp7_gpu14 -->
<g id="node464" class="node">
<title>l3_exp7_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="10731,-547.17 10557,-547.17 10557,-479.17 10731,-479.17 10731,-547.17"/>
<text text-anchor="middle" x="10644" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="10644" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="10644" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="10644" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_residual_tp6&#45;&gt;l3_exp7_gpu14 -->
<g id="edge995" class="edge">
<title>l3_residual_tp6&#45;&gt;l3_exp7_gpu14</title>
<path fill="none" stroke="black" d="M10634.91,-757.1C10647.78,-746.49 10659.14,-734.26 10668,-720.17 10699.14,-670.6 10681.05,-600.91 10663.7,-556.65"/>
<polygon fill="black" stroke="black" points="10666.92,-555.28 10659.91,-547.33 10660.44,-557.92 10666.92,-555.28"/>
</g>
<!-- l3_final_res_tp6 -->
<g id="node466" class="node">
<title>l3_final_res_tp6</title>
<polygon fill="lightyellow" stroke="black" points="10715.93,-269.17 10144.95,-269.17 9998.07,-133.17 10569.05,-133.17 10715.93,-269.17"/>
<text text-anchor="middle" x="10357" y="-219.97" font-family="Times,serif" font-size="14.00">Layer 3 Final Residual</text>
<text text-anchor="middle" x="10357" y="-204.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="10357" y="-189.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="10357" y="-174.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_residual_tp6&#45;&gt;l3_final_res_tp6 -->
<g id="edge998" class="edge">
<title>l3_residual_tp6&#45;&gt;l3_final_res_tp6</title>
<path fill="none" stroke="black" d="M10717.63,-806.36C10909.13,-785.95 11134,-742.89 11134,-653.17 11134,-653.17 11134,-653.17 11134,-373.17 11134,-272.59 10882.53,-231.1 10665.71,-214.03"/>
<polygon fill="black" stroke="black" points="10665.98,-210.54 10655.74,-213.26 10665.44,-217.52 10665.98,-210.54"/>
</g>
<!-- l3_gate_tp6&#45;&gt;l3_exp0_gpu14 -->
<g id="edge973" class="edge">
<title>l3_gate_tp6&#45;&gt;l3_exp0_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10258.82,-607.14C10196.98,-593.34 10128.17,-578.3 10065,-565.17 10026.68,-557.2 10014.38,-557.88 9973.1,-547.32"/>
<polygon fill="black" stroke="black" points="9973.78,-543.88 9963.22,-544.73 9972,-550.65 9973.78,-543.88"/>
</g>
<!-- l3_gate_tp6&#45;&gt;l3_exp1_gpu14 -->
<g id="edge976" class="edge">
<title>l3_gate_tp6&#45;&gt;l3_exp1_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10263.94,-584.07C10229.64,-571.84 10195.18,-559.54 10164.93,-548.75"/>
<polygon fill="black" stroke="black" points="10165.86,-545.36 10155.26,-545.3 10163.51,-551.96 10165.86,-545.36"/>
</g>
<!-- l3_gate_tp6&#45;&gt;l3_exp2_gpu14 -->
<g id="edge979" class="edge">
<title>l3_gate_tp6&#45;&gt;l3_exp2_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10274.86,-632.46C10140.9,-616.27 9952.74,-589.13 9780.91,-547.26"/>
<polygon fill="black" stroke="black" points="9781.73,-543.86 9771.18,-544.87 9780.06,-550.65 9781.73,-543.86"/>
</g>
<!-- l3_gate_tp6&#45;&gt;l3_exp3_gpu14 -->
<g id="edge982" class="edge">
<title>l3_gate_tp6&#45;&gt;l3_exp3_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10357.97,-584.07C10343.18,-573.52 10328.32,-562.92 10314.81,-553.28"/>
<polygon fill="black" stroke="black" points="10316.76,-550.36 10306.58,-547.41 10312.69,-556.06 10316.76,-550.36"/>
</g>
<!-- l3_gate_tp6&#45;&gt;l3_exp4_gpu14 -->
<g id="edge985" class="edge">
<title>l3_gate_tp6&#45;&gt;l3_exp4_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10599.36,-623.91C10692.28,-605.61 10814.73,-579.45 10930.97,-547.36"/>
<polygon fill="black" stroke="black" points="10932.06,-550.69 10940.76,-544.64 10930.19,-543.95 10932.06,-550.69"/>
</g>
<!-- l3_gate_tp6&#45;&gt;l3_exp5_gpu14 -->
<g id="edge988" class="edge">
<title>l3_gate_tp6&#45;&gt;l3_exp5_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10452,-583.87C10452,-574.93 10452,-565.95 10452,-557.56"/>
<polygon fill="black" stroke="black" points="10455.5,-557.29 10452,-547.29 10448.5,-557.29 10455.5,-557.29"/>
</g>
<!-- l3_gate_tp6&#45;&gt;l3_exp6_gpu14 -->
<g id="edge991" class="edge">
<title>l3_gate_tp6&#45;&gt;l3_exp6_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10586.57,-603.15C10636.83,-585.22 10692.87,-565.23 10739.08,-548.74"/>
<polygon fill="black" stroke="black" points="10740.54,-551.94 10748.79,-545.28 10738.19,-545.35 10740.54,-551.94"/>
</g>
<!-- l3_gate_tp6&#45;&gt;l3_exp7_gpu14 -->
<g id="edge994" class="edge">
<title>l3_gate_tp6&#45;&gt;l3_exp7_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10546.03,-584.07C10560.82,-573.52 10575.68,-562.92 10589.19,-553.28"/>
<polygon fill="black" stroke="black" points="10591.31,-556.06 10597.42,-547.41 10587.24,-550.36 10591.31,-556.06"/>
</g>
<!-- l3_exp_agg_tp6 -->
<g id="node465" class="node">
<title>l3_exp_agg_tp6</title>
<polygon fill="lightyellow" stroke="black" points="10576.58,-442.17 10227.28,-442.17 10137.42,-306.17 10486.72,-306.17 10576.58,-442.17"/>
<text text-anchor="middle" x="10357" y="-392.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10357" y="-377.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="10357" y="-362.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="10357" y="-347.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_exp0_gpu14&#45;&gt;l3_exp_agg_tp6 -->
<g id="edge975" class="edge">
<title>l3_exp0_gpu14&#45;&gt;l3_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M9963.04,-481.96C9966.06,-481.01 9969.05,-480.07 9972,-479.17 10045.81,-456.54 10128.36,-433.89 10198.04,-415.54"/>
<polygon fill="black" stroke="black" points="10199,-418.9 10207.79,-412.97 10197.22,-412.13 10199,-418.9"/>
</g>
<!-- l3_exp1_gpu14&#45;&gt;l3_exp_agg_tp6 -->
<g id="edge978" class="edge">
<title>l3_exp1_gpu14&#45;&gt;l3_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10137.96,-479C10161.37,-467.9 10188.38,-455.1 10215.26,-442.36"/>
<polygon fill="black" stroke="black" points="10216.83,-445.49 10224.37,-438.04 10213.83,-439.16 10216.83,-445.49"/>
</g>
<!-- l3_exp2_gpu14&#45;&gt;l3_exp_agg_tp6 -->
<g id="edge981" class="edge">
<title>l3_exp2_gpu14&#45;&gt;l3_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M9771.2,-481.56C9774.16,-480.72 9777.1,-479.92 9780,-479.17 9915.32,-443.93 10071.55,-416.57 10187.3,-398.77"/>
<polygon fill="black" stroke="black" points="10187.96,-402.21 10197.31,-397.24 10186.9,-395.29 10187.96,-402.21"/>
</g>
<!-- l3_exp3_gpu14&#45;&gt;l3_exp_agg_tp6 -->
<g id="edge984" class="edge">
<title>l3_exp3_gpu14&#45;&gt;l3_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10283.48,-479C10289.61,-470.34 10296.48,-460.64 10303.49,-450.74"/>
<polygon fill="black" stroke="black" points="10306.47,-452.58 10309.4,-442.4 10300.76,-448.54 10306.47,-452.58"/>
</g>
<!-- l3_exp4_gpu14&#45;&gt;l3_exp_agg_tp6 -->
<g id="edge987" class="edge">
<title>l3_exp4_gpu14&#45;&gt;l3_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10940.79,-481.56C10937.84,-480.72 10934.9,-479.92 10932,-479.17 10810.15,-447.4 10671.28,-421.99 10560.54,-404.24"/>
<polygon fill="black" stroke="black" points="10561.02,-400.77 10550.59,-402.65 10559.91,-407.68 10561.02,-400.77"/>
</g>
<!-- l3_exp5_gpu14&#45;&gt;l3_exp_agg_tp6 -->
<g id="edge990" class="edge">
<title>l3_exp5_gpu14&#45;&gt;l3_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10429,-479C10423,-470.34 10416.27,-460.64 10409.41,-450.74"/>
<polygon fill="black" stroke="black" points="10412.2,-448.62 10403.62,-442.4 10406.44,-452.61 10412.2,-448.62"/>
</g>
<!-- l3_exp6_gpu14&#45;&gt;l3_exp_agg_tp6 -->
<g id="edge993" class="edge">
<title>l3_exp6_gpu14&#45;&gt;l3_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10748.96,-481.97C10745.94,-481.01 10742.95,-480.07 10740,-479.17 10688,-463.19 10631.63,-447.17 10578.55,-432.66"/>
<polygon fill="black" stroke="black" points="10579.25,-429.22 10568.68,-429.97 10577.41,-435.98 10579.25,-429.22"/>
</g>
<!-- l3_exp7_gpu14&#45;&gt;l3_exp_agg_tp6 -->
<g id="edge996" class="edge">
<title>l3_exp7_gpu14&#45;&gt;l3_exp_agg_tp6</title>
<path fill="none" stroke="black" d="M10574.53,-479C10553.86,-469.14 10530.37,-457.92 10506.65,-446.6"/>
<polygon fill="black" stroke="black" points="10508.09,-443.41 10497.56,-442.26 10505.08,-449.73 10508.09,-443.41"/>
</g>
<!-- l3_exp_agg_tp6&#45;&gt;l3_final_res_tp6 -->
<g id="edge997" class="edge">
<title>l3_exp_agg_tp6&#45;&gt;l3_final_res_tp6</title>
<path fill="none" stroke="black" d="M10357,-306.07C10357,-297.4 10357,-288.46 10357,-279.63"/>
<polygon fill="black" stroke="black" points="10360.5,-279.35 10357,-269.35 10353.5,-279.35 10360.5,-279.35"/>
</g>
<!-- l3_final_res_tp6&#45;&gt;output -->
<g id="edge999" class="edge">
<title>l3_final_res_tp6&#45;&gt;output</title>
<path fill="none" stroke="black" d="M10047.08,-178.58C9802.06,-162.1 9451.31,-139.8 9144,-125.17 8349.81,-87.35 7398.85,-62 7027.53,-52.86"/>
<polygon fill="black" stroke="black" points="7027.6,-49.36 7017.52,-52.62 7027.43,-56.36 7027.6,-49.36"/>
</g>
<!-- l3_attn_tp7 -->
<g id="node468" class="node">
<title>l3_attn_tp7</title>
<polygon fill="lightgreen" stroke="black" points="12035,-1103.17 11821,-1103.17 11821,-1035.17 12035,-1035.17 12035,-1103.17"/>
<text text-anchor="middle" x="11928" y="-1087.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="11928" y="-1072.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,16,512]</text>
<text text-anchor="middle" x="11928" y="-1057.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="11928" y="-1042.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_qkv_tp7&#45;&gt;l3_attn_tp7 -->
<g id="edge1001" class="edge">
<title>l3_qkv_tp7&#45;&gt;l3_attn_tp7</title>
<path fill="none" stroke="black" d="M11925.97,-1140.01C11926.21,-1131.56 11926.48,-1122.34 11926.74,-1113.47"/>
<polygon fill="black" stroke="black" points="11930.24,-1113.36 11927.04,-1103.26 11923.25,-1113.16 11930.24,-1113.36"/>
</g>
<!-- l3_out_proj_tp7 -->
<g id="node469" class="node">
<title>l3_out_proj_tp7</title>
<polygon fill="lightgreen" stroke="black" points="12036,-998.17 11824,-998.17 11824,-930.17 12036,-930.17 12036,-998.17"/>
<text text-anchor="middle" x="11930" y="-982.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11930" y="-967.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="11930" y="-952.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="11930" y="-937.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_attn_tp7&#45;&gt;l3_out_proj_tp7 -->
<g id="edge1002" class="edge">
<title>l3_attn_tp7&#45;&gt;l3_out_proj_tp7</title>
<path fill="none" stroke="black" d="M11928.64,-1035.01C11928.81,-1026.56 11928.99,-1017.34 11929.16,-1008.47"/>
<polygon fill="black" stroke="black" points="11932.66,-1008.33 11929.36,-998.26 11925.66,-1008.19 11932.66,-1008.33"/>
</g>
<!-- l3_out_proj_tp7&#45;&gt;l3_residual_tp7 -->
<g id="edge1003" class="edge">
<title>l3_out_proj_tp7&#45;&gt;l3_residual_tp7</title>
<path fill="none" stroke="black" d="M11945.49,-930C11949.42,-921.6 11953.8,-912.22 11958.28,-902.63"/>
<polygon fill="black" stroke="black" points="11961.53,-903.94 11962.59,-893.4 11955.19,-900.98 11961.53,-903.94"/>
</g>
<!-- l3_gate_tp7 -->
<g id="node471" class="node">
<title>l3_gate_tp7</title>
<polygon fill="lightyellow" stroke="black" points="12161.2,-720.17 11831.59,-720.17 11746.8,-584.17 12076.41,-584.17 12161.2,-720.17"/>
<text text-anchor="middle" x="11954" y="-670.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="11954" y="-655.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192]</text>
<text text-anchor="middle" x="11954" y="-640.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,16]</text>
<text text-anchor="middle" x="11954" y="-625.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_residual_tp7&#45;&gt;l3_gate_tp7 -->
<g id="edge1005" class="edge">
<title>l3_residual_tp7&#45;&gt;l3_gate_tp7</title>
<path fill="none" stroke="black" d="M11978.31,-757.07C11976.25,-748.3 11974.14,-739.26 11972.05,-730.34"/>
<polygon fill="black" stroke="black" points="11975.4,-729.29 11969.71,-720.35 11968.58,-730.88 11975.4,-729.29"/>
</g>
<!-- l3_exp0_gpu15 -->
<g id="node472" class="node">
<title>l3_exp0_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="11711,-547.17 11537,-547.17 11537,-479.17 11711,-479.17 11711,-547.17"/>
<text text-anchor="middle" x="11624" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="11624" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11624" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11624" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_residual_tp7&#45;&gt;l3_exp0_gpu15 -->
<g id="edge1007" class="edge">
<title>l3_residual_tp7&#45;&gt;l3_exp0_gpu15</title>
<path fill="none" stroke="black" d="M11755.61,-757.01C11739.24,-746.46 11724.08,-734.27 11711,-720.17 11667.79,-673.6 11644.28,-602.4 11632.93,-557.09"/>
<polygon fill="black" stroke="black" points="11636.31,-556.17 11630.56,-547.27 11629.51,-557.81 11636.31,-556.17"/>
</g>
<!-- l3_exp1_gpu15 -->
<g id="node473" class="node">
<title>l3_exp1_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="11519,-547.17 11345,-547.17 11345,-479.17 11519,-479.17 11519,-547.17"/>
<text text-anchor="middle" x="11432" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="11432" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11432" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11432" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_residual_tp7&#45;&gt;l3_exp1_gpu15 -->
<g id="edge1010" class="edge">
<title>l3_residual_tp7&#45;&gt;l3_exp1_gpu15</title>
<path fill="none" stroke="black" d="M11711.66,-757.15C11685.3,-746.48 11659.64,-734.23 11636,-720.17 11563.56,-677.09 11498.61,-602.23 11462.34,-555.6"/>
<polygon fill="black" stroke="black" points="11464.99,-553.31 11456.12,-547.52 11459.44,-557.58 11464.99,-553.31"/>
</g>
<!-- l3_exp2_gpu15 -->
<g id="node474" class="node">
<title>l3_exp2_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="11327,-547.17 11153,-547.17 11153,-479.17 11327,-479.17 11327,-547.17"/>
<text text-anchor="middle" x="11240" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="11240" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11240" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11240" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_residual_tp7&#45;&gt;l3_exp2_gpu15 -->
<g id="edge1013" class="edge">
<title>l3_residual_tp7&#45;&gt;l3_exp2_gpu15</title>
<path fill="none" stroke="black" d="M11662.6,-782.67C11600.38,-767.79 11537.26,-747.6 11481,-720.17 11397.34,-679.38 11319.06,-602.6 11275.55,-555.17"/>
<polygon fill="black" stroke="black" points="11277.92,-552.58 11268.61,-547.54 11272.74,-557.29 11277.92,-552.58"/>
</g>
<!-- l3_exp3_gpu15 -->
<g id="node475" class="node">
<title>l3_exp3_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="11903,-547.17 11729,-547.17 11729,-479.17 11903,-479.17 11903,-547.17"/>
<text text-anchor="middle" x="11816" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="11816" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="11816" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="11816" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_residual_tp7&#45;&gt;l3_exp3_gpu15 -->
<g id="edge1016" class="edge">
<title>l3_residual_tp7&#45;&gt;l3_exp3_gpu15</title>
<path fill="none" stroke="black" d="M11772.57,-757.05C11759.3,-746.5 11747.51,-734.29 11738,-720.17 11704.25,-670.02 11713.37,-639.37 11738,-584.17 11742.92,-573.13 11750.54,-563.11 11759.12,-554.32"/>
<polygon fill="black" stroke="black" points="11761.72,-556.68 11766.52,-547.23 11756.88,-551.63 11761.72,-556.68"/>
</g>
<!-- l3_exp4_gpu15 -->
<g id="node476" class="node">
<title>l3_exp4_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="12479,-547.17 12305,-547.17 12305,-479.17 12479,-479.17 12479,-547.17"/>
<text text-anchor="middle" x="12392" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="12392" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="12392" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="12392" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_residual_tp7&#45;&gt;l3_exp4_gpu15 -->
<g id="edge1019" class="edge">
<title>l3_residual_tp7&#45;&gt;l3_exp4_gpu15</title>
<path fill="none" stroke="black" d="M12146.61,-757.14C12157.39,-751.35 12167.96,-745.34 12178,-739.17 12256.96,-690.63 12326.38,-605.8 12363.47,-555.32"/>
<polygon fill="black" stroke="black" points="12366.31,-557.37 12369.36,-547.22 12360.64,-553.25 12366.31,-557.37"/>
</g>
<!-- l3_exp5_gpu15 -->
<g id="node477" class="node">
<title>l3_exp5_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="12671,-547.17 12497,-547.17 12497,-479.17 12671,-479.17 12671,-547.17"/>
<text text-anchor="middle" x="12584" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="12584" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="12584" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="12584" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_residual_tp7&#45;&gt;l3_exp5_gpu15 -->
<g id="edge1022" class="edge">
<title>l3_residual_tp7&#45;&gt;l3_exp5_gpu15</title>
<path fill="none" stroke="black" d="M12197.09,-757.02C12225.07,-745.76 12253.08,-733.4 12279,-720.17 12374.39,-671.47 12475.62,-598.23 12534.15,-553.46"/>
<polygon fill="black" stroke="black" points="12536.32,-556.21 12542.12,-547.34 12532.06,-550.66 12536.32,-556.21"/>
</g>
<!-- l3_exp6_gpu15 -->
<g id="node478" class="node">
<title>l3_exp6_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="12287,-547.17 12113,-547.17 12113,-479.17 12287,-479.17 12287,-547.17"/>
<text text-anchor="middle" x="12200" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="12200" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="12200" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="12200" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_residual_tp7&#45;&gt;l3_exp6_gpu15 -->
<g id="edge1025" class="edge">
<title>l3_residual_tp7&#45;&gt;l3_exp6_gpu15</title>
<path fill="none" stroke="black" d="M12157.07,-756.8C12168.67,-746.23 12178.67,-734.09 12186,-720.17 12212.82,-669.22 12211.49,-601.1 12206.79,-557.43"/>
<polygon fill="black" stroke="black" points="12210.25,-556.93 12205.6,-547.41 12203.3,-557.75 12210.25,-556.93"/>
</g>
<!-- l3_exp7_gpu15 -->
<g id="node479" class="node">
<title>l3_exp7_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="12095,-547.17 11921,-547.17 11921,-479.17 12095,-479.17 12095,-547.17"/>
<text text-anchor="middle" x="12008" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="12008" y="-516.97" font-family="Times,serif" font-size="14.00">Input: [tokens,8192]</text>
<text text-anchor="middle" x="12008" y="-501.97" font-family="Times,serif" font-size="14.00">Output: [tokens,8192]</text>
<text text-anchor="middle" x="12008" y="-486.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_residual_tp7&#45;&gt;l3_exp7_gpu15 -->
<g id="edge1028" class="edge">
<title>l3_residual_tp7&#45;&gt;l3_exp7_gpu15</title>
<path fill="none" stroke="black" d="M12139.47,-756.95C12151.51,-746.25 12162.08,-734.04 12170,-720.17 12199.96,-667.67 12203.2,-634.68 12170,-584.17 12165.52,-577.35 12136.74,-564.09 12104.64,-550.93"/>
<polygon fill="black" stroke="black" points="12105.64,-547.56 12095.06,-547.04 12103.01,-554.05 12105.64,-547.56"/>
</g>
<!-- l3_final_res_tp7 -->
<g id="node481" class="node">
<title>l3_final_res_tp7</title>
<polygon fill="lightyellow" stroke="black" points="12224.93,-269.17 11653.95,-269.17 11507.07,-133.17 12078.05,-133.17 12224.93,-269.17"/>
<text text-anchor="middle" x="11866" y="-219.97" font-family="Times,serif" font-size="14.00">Layer 3 Final Residual</text>
<text text-anchor="middle" x="11866" y="-204.97" font-family="Times,serif" font-size="14.00">Input: [1024,10000,8192], [1024,10000,8192]</text>
<text text-anchor="middle" x="11866" y="-189.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="11866" y="-174.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_residual_tp7&#45;&gt;l3_final_res_tp7 -->
<g id="edge1031" class="edge">
<title>l3_residual_tp7&#45;&gt;l3_final_res_tp7</title>
<path fill="none" stroke="black" d="M12261.1,-807.71C12457.38,-788.01 12690,-745.24 12690,-653.17 12690,-653.17 12690,-653.17 12690,-373.17 12690,-263.12 12404.65,-223.37 12169.79,-209.3"/>
<polygon fill="black" stroke="black" points="12169.89,-205.8 12159.7,-208.71 12169.48,-212.78 12169.89,-205.8"/>
</g>
<!-- l3_gate_tp7&#45;&gt;l3_exp0_gpu15 -->
<g id="edge1006" class="edge">
<title>l3_gate_tp7&#45;&gt;l3_exp0_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11792.38,-584.07C11765.02,-572.71 11737.52,-561.3 11712.92,-551.08"/>
<polygon fill="black" stroke="black" points="11714.22,-547.83 11703.64,-547.23 11711.53,-554.3 11714.22,-547.83"/>
</g>
<!-- l3_gate_tp7&#45;&gt;l3_exp1_gpu15 -->
<g id="edge1009" class="edge">
<title>l3_gate_tp7&#45;&gt;l3_exp1_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11761.62,-608.15C11690.99,-591.37 11610.36,-571.05 11528.94,-547.37"/>
<polygon fill="black" stroke="black" points="11529.59,-543.91 11519.01,-544.46 11527.62,-550.63 11529.59,-543.91"/>
</g>
<!-- l3_gate_tp7&#45;&gt;l3_exp2_gpu15 -->
<g id="edge1012" class="edge">
<title>l3_gate_tp7&#45;&gt;l3_exp2_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11774.56,-628.92C11653.01,-611.96 11489,-585.39 11337.18,-547.34"/>
<polygon fill="black" stroke="black" points="11337.75,-543.88 11327.19,-544.82 11336.03,-550.66 11337.75,-543.88"/>
</g>
<!-- l3_gate_tp7&#45;&gt;l3_exp3_gpu15 -->
<g id="edge1015" class="edge">
<title>l3_gate_tp7&#45;&gt;l3_exp3_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11886.21,-583.87C11876.1,-573.83 11865.95,-563.76 11856.64,-554.51"/>
<polygon fill="black" stroke="black" points="11858.93,-551.86 11849.37,-547.29 11854,-556.82 11858.93,-551.86"/>
</g>
<!-- l3_gate_tp7&#45;&gt;l3_exp4_gpu15 -->
<g id="edge1018" class="edge">
<title>l3_gate_tp7&#45;&gt;l3_exp4_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12092.88,-610.17C12152.48,-592.27 12223.07,-570.67 12295.2,-547.4"/>
<polygon fill="black" stroke="black" points="12296.49,-550.66 12304.92,-544.25 12294.33,-544 12296.49,-550.66"/>
</g>
<!-- l3_gate_tp7&#45;&gt;l3_exp5_gpu15 -->
<g id="edge1021" class="edge">
<title>l3_gate_tp7&#45;&gt;l3_exp5_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12103.74,-627.73C12208.86,-609.92 12352.6,-582.86 12486.73,-547.4"/>
<polygon fill="black" stroke="black" points="12488.02,-550.68 12496.78,-544.72 12486.22,-543.91 12488.02,-550.68"/>
</g>
<!-- l3_gate_tp7&#45;&gt;l3_exp6_gpu15 -->
<g id="edge1024" class="edge">
<title>l3_gate_tp7&#45;&gt;l3_exp6_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12074.48,-584.07C12094.07,-573.16 12113.75,-562.2 12131.52,-552.3"/>
<polygon fill="black" stroke="black" points="12133.6,-555.15 12140.63,-547.23 12130.19,-549.04 12133.6,-555.15"/>
</g>
<!-- l3_gate_tp7&#45;&gt;l3_exp7_gpu15 -->
<g id="edge1027" class="edge">
<title>l3_gate_tp7&#45;&gt;l3_exp7_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11980.53,-583.87C11984.17,-574.63 11987.82,-565.35 11991.22,-556.73"/>
<polygon fill="black" stroke="black" points="11994.53,-557.88 11994.94,-547.29 11988.02,-555.31 11994.53,-557.88"/>
</g>
<!-- l3_exp_agg_tp7 -->
<g id="node480" class="node">
<title>l3_exp_agg_tp7</title>
<polygon fill="lightyellow" stroke="black" points="12085.58,-442.17 11736.28,-442.17 11646.42,-306.17 11995.72,-306.17 12085.58,-442.17"/>
<text text-anchor="middle" x="11866" y="-392.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11866" y="-377.97" font-family="Times,serif" font-size="14.00">Input: [16,tokens,8192]</text>
<text text-anchor="middle" x="11866" y="-362.97" font-family="Times,serif" font-size="14.00">Output: [1024,10000,8192]</text>
<text text-anchor="middle" x="11866" y="-347.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_exp0_gpu15&#45;&gt;l3_exp_agg_tp7 -->
<g id="edge1008" class="edge">
<title>l3_exp0_gpu15&#45;&gt;l3_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11682.58,-479C11699.56,-469.39 11718.81,-458.5 11738.28,-447.47"/>
<polygon fill="black" stroke="black" points="11740.26,-450.37 11747.24,-442.4 11736.81,-444.28 11740.26,-450.37"/>
</g>
<!-- l3_exp1_gpu15&#45;&gt;l3_exp_agg_tp7 -->
<g id="edge1011" class="edge">
<title>l3_exp1_gpu15&#45;&gt;l3_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11519.08,-482.09C11522.09,-481.1 11525.07,-480.12 11528,-479.17 11587.46,-459.8 11653.12,-439.39 11710.62,-421.82"/>
<polygon fill="black" stroke="black" points="11711.97,-425.06 11720.52,-418.8 11709.93,-418.37 11711.97,-425.06"/>
</g>
<!-- l3_exp2_gpu15&#45;&gt;l3_exp_agg_tp7 -->
<g id="edge1014" class="edge">
<title>l3_exp2_gpu15&#45;&gt;l3_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11327.22,-481.62C11330.17,-480.76 11333.11,-479.94 11336,-479.17 11455.86,-446.97 11593.45,-420.27 11698.4,-401.98"/>
<polygon fill="black" stroke="black" points="11699.2,-405.39 11708.45,-400.24 11698,-398.5 11699.2,-405.39"/>
</g>
<!-- l3_exp3_gpu15&#45;&gt;l3_exp_agg_tp7 -->
<g id="edge1017" class="edge">
<title>l3_exp3_gpu15&#45;&gt;l3_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11828.1,-479C11831.14,-470.69 11834.52,-461.42 11837.98,-451.93"/>
<polygon fill="black" stroke="black" points="11841.32,-452.99 11841.46,-442.4 11834.75,-450.59 11841.32,-452.99"/>
</g>
<!-- l3_exp4_gpu15&#45;&gt;l3_exp_agg_tp7 -->
<g id="edge1020" class="edge">
<title>l3_exp4_gpu15&#45;&gt;l3_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M12304.99,-481.86C12301.96,-480.93 12298.96,-480.03 12296,-479.17 12226.79,-458.95 12150.51,-439.57 12081.65,-423.14"/>
<polygon fill="black" stroke="black" points="12082.09,-419.65 12071.55,-420.74 12080.47,-426.46 12082.09,-419.65"/>
</g>
<!-- l3_exp5_gpu15&#45;&gt;l3_exp_agg_tp7 -->
<g id="edge1023" class="edge">
<title>l3_exp5_gpu15&#45;&gt;l3_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M12496.81,-481.51C12493.85,-480.69 12490.9,-479.9 12488,-479.17 12349.29,-443.99 12190.09,-417.62 12067.47,-400.24"/>
<polygon fill="black" stroke="black" points="12067.61,-396.72 12057.22,-398.79 12066.63,-403.65 12067.61,-396.72"/>
</g>
<!-- l3_exp6_gpu15&#45;&gt;l3_exp_agg_tp7 -->
<g id="edge1026" class="edge">
<title>l3_exp6_gpu15&#45;&gt;l3_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M12119.15,-479C12094.78,-469.01 12067.04,-457.63 12039.07,-446.16"/>
<polygon fill="black" stroke="black" points="12040.16,-442.82 12029.58,-442.26 12037.5,-449.3 12040.16,-442.82"/>
</g>
<!-- l3_exp7_gpu15&#45;&gt;l3_exp_agg_tp7 -->
<g id="edge1029" class="edge">
<title>l3_exp7_gpu15&#45;&gt;l3_exp_agg_tp7</title>
<path fill="none" stroke="black" d="M11973.63,-479C11964.29,-469.99 11953.79,-459.86 11943.1,-449.55"/>
<polygon fill="black" stroke="black" points="11945.31,-446.82 11935.69,-442.4 11940.45,-451.86 11945.31,-446.82"/>
</g>
<!-- l3_exp_agg_tp7&#45;&gt;l3_final_res_tp7 -->
<g id="edge1030" class="edge">
<title>l3_exp_agg_tp7&#45;&gt;l3_final_res_tp7</title>
<path fill="none" stroke="black" d="M11866,-306.07C11866,-297.4 11866,-288.46 11866,-279.63"/>
<polygon fill="black" stroke="black" points="11869.5,-279.35 11866,-269.35 11862.5,-279.35 11869.5,-279.35"/>
</g>
<!-- l3_final_res_tp7&#45;&gt;output -->
<g id="edge1032" class="edge">
<title>l3_final_res_tp7&#45;&gt;output</title>
<path fill="none" stroke="black" d="M11552.94,-175.7C11323.79,-158.74 11005.27,-137.14 10725,-125.17 9291.68,-63.95 7556.6,-51.91 7028.25,-49.61"/>
<polygon fill="black" stroke="black" points="7027.9,-46.11 7017.89,-49.57 7027.87,-53.11 7027.9,-46.11"/>
</g>
</g>
</svg>
