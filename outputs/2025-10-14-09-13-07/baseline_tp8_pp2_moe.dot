digraph baseline_tp8_pp2_moe {
	graph [bb="0,0,12707,4757.1",
		rankdir=TB,
		size="20,30"
	];
	node [fillcolor=lightyellow,
		label="\N",
		shape=parallelogram,
		style=filled
	];
	subgraph cluster_stage0 {
		graph [bb="8,2414.2,12454,4655.2",
			label="Pipeline Stage 0 (Layers 0-1)\nGPUs 0-7",
			lheight=0.42,
			lp="6231,4636.2",
			lwidth=2.89,
			style=dashed
		];
		subgraph cluster_layer0 {
			graph [label="Layer 0",
				style=dotted
			];
		}
		subgraph cluster_layer1 {
			graph [label="Layer 1",
				style=dotted
			];
		}
		l0_qkv_tp0	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 0",
			pos="4241,4575.2",
			shape=rectangle,
			width=3.1389];
		l0_attn_tp0	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 0",
			pos="3644,4470.2",
			shape=rectangle,
			width=2.9722];
		l0_qkv_tp0 -> l0_attn_tp0	[pos="e,3751.4,4489.7 4127.7,4554.6 4022.8,4536.5 3867.6,4509.7 3761.5,4491.4"];
		l0_out_proj_tp0	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0",
			pos="2933,4365.2",
			shape=rectangle,
			width=2.9444];
		l0_attn_tp0 -> l0_out_proj_tp0	[pos="e,3039.1,4381.5 3536.8,4453.6 3405.6,4434.6 3184.2,4402.6 3049,4383"];
		l0_residual_tp0	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0",
			pos="1093,4226.2",
			width=9.9643];
		l0_out_proj_tp0 -> l0_residual_tp0	[pos="e,1405,4250.4 2826.8,4356.3 2557.2,4336.2 1837.9,4282.6 1415.3,4251.2"];
		l0_gate_tp0	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 0",
			pos="925,4053.2",
			width=5.7597];
		l0_residual_tp0 -> l0_gate_tp0	[pos="e,991,4121.3 1027.1,4158.1 1017.6,4148.5 1007.9,4138.5 998.28,4128.8"];
		l0_exp0_gpu0	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0",
			pos="871,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp0 -> l0_exp0_gpu0	[pos="e,783.94,3948 767.61,4158.2 740.54,4147.2 719.49,4134.9 709,4121.2 690.63,4097.2 692.4,4010.4 709,3985.2 713.48,3978.4 742.26,3965.1 \
774.36,3951.9"];
		l0_exp1_gpu0	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0",
			pos="679,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp0 -> l0_exp1_gpu0	[pos="e,671.59,3948.5 742.98,4158 718.49,4147.3 699.92,4135 691,4121.2 659.62,4072.4 663.13,4002.9 669.95,3958.4"];
		l0_exp2_gpu0	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0",
			pos="103,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp0 -> l0_exp2_gpu0	[pos="e,131.73,3948.5 777.12,4198.1 611.52,4180.5 427.7,4154.5 352,4121.2 264.53,4082.6 183.19,4004.1 138.57,3955.9"];
		l0_exp3_gpu0	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0",
			pos="295,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp0 -> l0_exp3_gpu0	[pos="e,322.27,3948.4 776.03,4197.1 693.13,4181.7 605.81,4157.9 530,4121.2 447.21,4081.1 371,4003.7 328.97,3956"];
		l0_exp4_gpu0	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0",
			pos="487,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp0 -> l0_exp4_gpu0	[pos="e,507.72,3948.2 745.25,4168.6 715.26,4155.8 686.63,4140.2 661,4121.2 598.67,4074.9 544.09,4002.1 513.36,3956.6"];
		l0_exp5_gpu0	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0",
			pos="1255,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp0 -> l0_exp5_gpu0	[pos="e,1239.4,3948.3 1132.5,4158.1 1139.5,4145.9 1146.6,4133.2 1153,4121.2 1182.9,4065.2 1215,3999.3 1235.1,3957.4"];
		l0_exp6_gpu0	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0",
			pos="1447,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp0 -> l0_exp6_gpu0	[pos="e,1409,3948.4 1169.8,4157.9 1240.5,4096 1342.8,4006.4 1401.4,3955.1"];
		l0_exp7_gpu0	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0",
			pos="1063,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp0 -> l0_exp7_gpu0	[pos="e,1112.5,3948.2 1129,4158.1 1134,4146.1 1138.3,4133.5 1141,4121.2 1154,4062.1 1165.6,4040.4 1141,3985.2 1136.1,3974.1 1128.5,3964.1 \
1119.9,3955.3"];
		l0_final_res_tp0	[height=1.8889,
			label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0",
			pos="875,3602.2",
			width=9.9643];
		l0_residual_tp0 -> l0_final_res_tp0	[pos="e,1187.2,3626.9 1328.1,4179.3 1441.3,4150.2 1553,4107.9 1553,4054.2 1553,4054.2 1553,4054.2 1553,3774.2 1553,3693.9 1372.2,3651 \
1197.4,3628.2"];
		l0_qkv_tp1	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 1",
			pos="4790,4575.2",
			shape=rectangle,
			width=3.1389];
		l0_attn_tp1	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 1",
			pos="3961,4470.2",
			shape=rectangle,
			width=2.9722];
		l0_qkv_tp1 -> l0_attn_tp1	[pos="e,4068,4484.5 4676.9,4560.1 4520,4540.6 4237.5,4505.5 4078.3,4485.7"];
		l0_out_proj_tp1	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1",
			pos="3304,4365.2",
			shape=rectangle,
			width=2.9444];
		l0_attn_tp1 -> l0_out_proj_tp1	[pos="e,3410,4382.1 3853.9,4451.4 3823.5,4446.4 3790.5,4441 3760,4436.2 3644.4,4417.8 3512.1,4397.6 3419.9,4383.6"];
		l0_residual_tp1	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1",
			pos="2663,4226.2",
			width=9.9643];
		l0_out_proj_tp1 -> l0_residual_tp1	[pos="e,2976.7,4294.2 3197.8,4341.5 3139.2,4328.9 3062.9,4312.6 2986.5,4296.3"];
		l0_gate_tp1	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 1",
			pos="2427,4053.2",
			width=5.7597];
		l0_residual_tp1 -> l0_gate_tp1	[pos="e,2519.7,4121.3 2570.4,4158.1 2556.5,4148 2542.1,4137.5 2528,4127.3"];
		l0_exp0_gpu1	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1",
			pos="2235,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp1 -> l0_exp0_gpu1	[pos="e,2217.9,3948.4 2322.5,4175.4 2270.7,4161.2 2228.6,4143.3 2211,4121.2 2174.2,4074.9 2194.5,4003.1 2213.8,3957.7"];
		l0_exp1_gpu1	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1",
			pos="2811,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp1 -> l0_exp1_gpu1	[pos="e,2795.1,3948.4 2695.1,4157.9 2724.2,4097 2766.1,4009.3 2790.7,3957.7"];
		l0_exp2_gpu1	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1",
			pos="2043,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp1 -> l0_exp2_gpu1	[pos="e,2058.7,3948.3 2319.5,4172.6 2260.4,4158.3 2210.2,4141.2 2186,4121.2 2130.6,4075.4 2087.1,4003 2063.3,3957.3"];
		l0_exp3_gpu1	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1",
			pos="1851,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp1 -> l0_exp3_gpu1	[pos="e,1876.4,3948.5 2353.7,4204.2 2260.3,4189.1 2159.8,4163.7 2074,4121.2 1994.1,4081.6 1922.4,4004.3 1883,3956.5"];
		l0_exp4_gpu1	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1",
			pos="1659,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp1 -> l0_exp4_gpu1	[pos="e,1687,3948.5 2348.9,4199.9 2176.5,4182.6 1982,4156.3 1903,4121.2 1816.7,4082.8 1737.2,4004.2 1693.7,3956"];
		l0_exp5_gpu1	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1",
			pos="3003,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp1 -> l0_exp5_gpu1	[pos="e,2966.5,3948.4 2736.8,4157.9 2804.5,4096.2 2902.6,4006.7 2958.8,3955.4"];
		l0_exp6_gpu1	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1",
			pos="2619,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp1 -> l0_exp6_gpu1	[pos="e,2648.9,3948.3 2672.9,4158 2678.2,4104.5 2679.8,4028.5 2658,3966.2 2656.9,3963.1 2655.6,3960 2654,3957"];
		l0_exp7_gpu1	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1",
			pos="2427,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp1 -> l0_exp7_gpu1	[pos="e,2514.1,3945.2 2661.2,4158.1 2658.9,4091.8 2653.7,3998.4 2643,3985.2 2609.9,3944.1 2579.6,3963.1 2524,3948.2"];
		l0_final_res_tp1	[height=1.8889,
			label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1",
			pos="2539,3602.2",
			width=9.9643];
		l0_residual_tp1 -> l0_final_res_tp1	[pos="e,2875.5,3649.3 2895.5,4176.9 3003.7,4147.6 3109,4105.7 3109,4054.2 3109,4054.2 3109,4054.2 3109,3774.2 3109,3717.6 3004.9,3678.2 \
2885.6,3651.6"];
		l0_qkv_tp2	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 2",
			pos="5364,4575.2",
			shape=rectangle,
			width=3.1389];
		l0_attn_tp2	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 2",
			pos="4984,4470.2",
			shape=rectangle,
			width=2.9722];
		l0_qkv_tp2 -> l0_attn_tp2	[pos="e,5091.2,4500.2 5250.8,4543.5 5203.5,4530.7 5148.6,4515.8 5100.9,4502.9"];
		l0_out_proj_tp2	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2",
			pos="4486,4365.2",
			shape=rectangle,
			width=2.9444];
		l0_attn_tp2 -> l0_out_proj_tp2	[pos="e,4592.1,4388.1 4876.9,4447 4796,4430.3 4685.1,4407.3 4602.1,4390.2"];
		l0_residual_tp2	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2",
			pos="4204,4226.2",
			width=9.9643];
		l0_out_proj_tp2 -> l0_residual_tp2	[pos="e,4342.1,4294.3 4417.7,4331 4397.5,4321.2 4374.6,4310 4351.4,4298.8"];
		l0_gate_tp2	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 2",
			pos="4037,4053.2",
			width=5.7597];
		l0_residual_tp2 -> l0_gate_tp2	[pos="e,4102.6,4121.3 4138.5,4158.1 4129.1,4148.5 4119.4,4138.5 4109.8,4128.8"];
		l0_exp0_gpu2	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2",
			pos="3215,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp2 -> l0_exp0_gpu2	[pos="e,3243.6,3948.5 3888.1,4198.1 3722.5,4180.5 3538.7,4154.6 3463,4121.2 3375.8,4082.6 3294.8,4004.1 3250.4,3955.9"];
		l0_exp1_gpu2	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2",
			pos="3791,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp2 -> l0_exp1_gpu2	[pos="e,3783.6,3948.5 3855.3,4158.1 3830.6,4147.3 3811.9,4135.1 3803,4121.2 3771.6,4072.4 3775.1,4002.9 3782,3958.4"];
		l0_exp2_gpu2	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2",
			pos="3983,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp2 -> l0_exp2_gpu2	[pos="e,3895.9,3948 3879.4,4158.1 3852.4,4147.2 3831.5,4134.8 3821,4121.2 3802.6,4097.2 3804.4,4010.4 3821,3985.2 3825.5,3978.4 3854.3,\
3965.1 3886.4,3951.9"];
		l0_exp3_gpu2	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2",
			pos="3407,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp2 -> l0_exp3_gpu2	[pos="e,3434.1,3948.4 3887,4197.2 3804.1,4181.8 3716.8,4158 3641,4121.2 3558.5,4081.1 3482.6,4003.7 3440.8,3956"];
		l0_exp4_gpu2	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2",
			pos="3599,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp2 -> l0_exp4_gpu2	[pos="e,3619.7,3948.2 3855.4,4167.8 3826.1,4155.1 3798.1,4139.8 3773,4121.2 3710.7,4074.9 3656.1,4002.1 3625.4,3956.6"];
		l0_exp5_gpu2	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2",
			pos="4175,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp2 -> l0_exp5_gpu2	[pos="e,4224.5,3948.2 4240.9,4157.9 4245.9,4146 4250.3,4133.4 4253,4121.2 4266.2,4062.2 4277.6,4040.4 4253,3985.2 4248.1,3974.1 4240.5,\
3964.1 4231.9,3955.3"];
		l0_exp6_gpu2	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2",
			pos="4559,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp2 -> l0_exp6_gpu2	[pos="e,4520.9,3948.4 4281,4157.9 4351.9,4096 4454.6,4006.4 4513.3,3955.1"];
		l0_exp7_gpu2	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2",
			pos="4367,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp2 -> l0_exp7_gpu2	[pos="e,4351.5,3948.4 4244.2,4158.1 4251.3,4145.9 4258.5,4133.2 4265,4121.2 4295.1,4065.3 4327.2,3999.4 4347.1,3957.5"];
		l0_final_res_tp2	[height=1.8889,
			label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2",
			pos="3998,3602.2",
			width=9.9643];
		l0_residual_tp2 -> l0_final_res_tp2	[pos="e,4312.5,3628.7 4439.2,4179.4 4552.9,4150.4 4665,4108.1 4665,4054.2 4665,4054.2 4665,4054.2 4665,3774.2 4665,3696.3 4492.3,3653.4 \
4322.6,3630"];
		l0_qkv_tp3	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 3",
			pos="5625,4575.2",
			shape=rectangle,
			width=3.1389];
		l0_attn_tp3	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 3",
			pos="5653,4470.2",
			shape=rectangle,
			width=2.9722];
		l0_qkv_tp3 -> l0_attn_tp3	[pos="e,5644,4504.3 5634,4541 5636.3,4532.5 5638.9,4523.1 5641.3,4514.2"];
		l0_out_proj_tp3	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3",
			pos="5655,4365.2",
			shape=rectangle,
			width=2.9444];
		l0_attn_tp3 -> l0_out_proj_tp3	[pos="e,5654.4,4399.3 5653.6,4436 5653.8,4427.6 5654,4418.3 5654.2,4409.5"];
		l0_residual_tp3	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3",
			pos="5671,4226.2",
			width=9.9643];
		l0_out_proj_tp3 -> l0_residual_tp3	[pos="e,5663.1,4294.4 5658.9,4331 5659.8,4322.9 5660.9,4313.8 5662,4304.5"];
		l0_gate_tp3	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 3",
			pos="5485,4053.2",
			width=5.7597];
		l0_residual_tp3 -> l0_gate_tp3	[pos="e,5558.1,4121.3 5598,4158.1 5587.4,4148.3 5576.3,4138.1 5565.5,4128.2"];
		l0_exp0_gpu3	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3",
			pos="4963,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp3 -> l0_exp0_gpu3	[pos="e,4985.5,3948.2 5343.4,4187.4 5281.8,4172.2 5219.6,4150.9 5165,4121.2 5090.7,4080.7 5026.6,4004 4991.5,3956.5"];
		l0_exp1_gpu3	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3",
			pos="4771,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp3 -> l0_exp1_gpu3	[pos="e,4798.4,3948.3 5347.3,4191.1 5211.4,4173.3 5070.9,4149.4 5010,4121.2 4925.5,4082 4847.8,4004 4805.2,3956"];
		l0_exp2_gpu3	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3",
			pos="6115,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp3 -> l0_exp2_gpu3	[pos="e,6067.6,3948.3 5767.1,4158.1 5856.3,4095.8 5986.1,4005.1 6059.4,3954"];
		l0_exp3_gpu3	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3",
			pos="5731,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp3 -> l0_exp3_gpu3	[pos="e,5733.1,3948.3 5709.7,4158 5712.2,4152.1 5714.3,4146.1 5716,4140.2 5733.4,4078.8 5734.7,4004.5 5733.4,3958.5"];
		l0_exp4_gpu3	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3",
			pos="5155,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp3 -> l0_exp4_gpu3	[pos="e,5160.8,3948.4 5312.5,4158.8 5280.5,4147.6 5254.9,4135.1 5241,4121.2 5196.1,4076.1 5173.4,4004.2 5162.9,3958.3"];
		l0_exp5_gpu3	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3",
			pos="5347,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp3 -> l0_exp5_gpu3	[pos="e,5297.5,3948.2 5327.5,4158 5300.6,4147.2 5279.6,4134.9 5269,4121.2 5232,4073.4 5244.4,4040.4 5269,3985.2 5273.9,3974.1 5281.5,3964.1 \
5290.1,3955.3"];
		l0_exp6_gpu3	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3",
			pos="5923,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp3 -> l0_exp6_gpu3	[pos="e,5895.9,3948.4 5725.7,4157.9 5775.6,4096.5 5847.7,4007.8 5889.5,3956.4"];
		l0_exp7_gpu3	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3",
			pos="5539,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp3 -> l0_exp7_gpu3	[pos="e,5626.1,3948 5693.3,4158.1 5696.5,4145.9 5699.3,4133.3 5701,4121.2 5705.2,4091.2 5717.6,4010.4 5701,3985.2 5696.5,3978.4 5667.7,\
3965.1 5635.6,3951.9"];
		l0_final_res_tp3	[height=1.8889,
			label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3",
			pos="5650,3602.2",
			width=9.9643];
		l0_residual_tp3 -> l0_final_res_tp3	[pos="e,5986.3,3649.1 5920.3,4192.5 6065.8,4166.2 6221,4122.2 6221,4054.2 6221,4054.2 6221,4054.2 6221,3774.2 6221,3717.4 6116,3677.8 \
5996.1,3651.2"];
		l0_qkv_tp4	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 4",
			pos="5869,4575.2",
			shape=rectangle,
			width=3.1389];
		l0_attn_tp4	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 4",
			pos="5888,4470.2",
			shape=rectangle,
			width=2.9722];
		l0_qkv_tp4 -> l0_attn_tp4	[pos="e,5881.9,4504.3 5875.1,4541 5876.7,4532.5 5878.4,4523.1 5880.1,4514.2"];
		l0_out_proj_tp4	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4",
			pos="5902,4365.2",
			shape=rectangle,
			width=2.9444];
		l0_attn_tp4 -> l0_out_proj_tp4	[pos="e,5897.5,4399.3 5892.5,4436 5893.7,4427.5 5894.9,4418.1 5896.2,4409.2"];
		l0_residual_tp4	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4",
			pos="6889,4226.2",
			width=9.9643];
		l0_out_proj_tp4 -> l0_residual_tp4	[pos="e,6627.9,4249 6008.3,4334.8 6014.3,4333.5 6020.2,4332.3 6026,4331.2 6222.5,4293.4 6447,4266.8 6617.8,4250"];
		l0_gate_tp4	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 4",
			pos="7095,4053.2",
			width=5.7597];
		l0_residual_tp4 -> l0_gate_tp4	[pos="e,7014.1,4121.3 6969.8,4158.1 6981.8,4148.2 6994.1,4137.9 7006.2,4127.9"];
		l0_exp0_gpu4	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4",
			pos="6903,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp4 -> l0_exp0_gpu4	[pos="e,6873,3948.2 6867.5,4158 6854,4104.6 6842.8,4028.9 6864,3966.2 6865.1,3963.1 6866.4,3960 6867.9,3957"];
		l0_exp1_gpu4	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4",
			pos="6327,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp4 -> l0_exp1_gpu4	[pos="e,6361.2,3948.3 6668.2,4158.2 6640.9,4147.1 6613.9,4134.8 6589,4121.2 6503.9,4074.7 6418,4000.8 6368.8,3955.3"];
		l0_exp2_gpu4	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4",
			pos="7095,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp4 -> l0_exp2_gpu4	[pos="e,7007.9,3945.2 6877.1,4157.9 6867.8,4096.6 6859.5,4011.6 6879,3985.2 6910.3,3942.7 6942.2,3962.9 6998,3948.2"];
		l0_exp3_gpu4	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4",
			pos="7479,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp4 -> l0_exp3_gpu4	[pos="e,7460,3948.2 7133.6,4188.3 7216.5,4171.4 7295.7,4148.9 7326,4121.2 7379.8,4071.9 7427.4,4001.4 7454.7,3957"];
		l0_exp4_gpu4	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4",
			pos="7287,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp4 -> l0_exp4_gpu4	[pos="e,7304,3948.3 7136.5,4190.7 7214.7,4174.3 7287.2,4151.6 7311,4121.2 7347.5,4074.6 7327.2,4002.9 7308.1,3957.6"];
		l0_exp5_gpu4	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4",
			pos="6519,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp4 -> l0_exp5_gpu4	[pos="e,6553.6,3948.4 6794.4,4158 6778.4,4146 6762,4133.4 6747,4121.2 6679.7,4066.4 6605.9,3998.1 6561,3955.6"];
		l0_exp6_gpu4	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4",
			pos="6711,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp4 -> l0_exp6_gpu4	[pos="e,6730.1,3948.4 6850.4,4157.9 6815.4,4096.9 6764.8,4008.9 6735.2,3957.3"];
		l0_exp7_gpu4	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4",
			pos="7671,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp4 -> l0_exp7_gpu4	[pos="e,7635.2,3948.4 7140.4,4194.4 7220.9,4178.8 7308.8,4155.6 7385,4121.2 7479.6,4078.4 7574.4,4001.8 7627.6,3955.1"];
		l0_final_res_tp4	[height=1.8889,
			label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4",
			pos="7128,3602.2",
			width=9.9643];
		l0_residual_tp4 -> l0_final_res_tp4	[pos="e,7445.8,3631.8 7146.4,4200.2 7408.7,4171.2 7777,4118.9 7777,4054.2 7777,4054.2 7777,4054.2 7777,3774.2 7777,3700.1 7617.1,3657.5 \
7456,3633.3"];
		l0_qkv_tp5	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 5",
			pos="6113,4575.2",
			shape=rectangle,
			width=3.1389];
		l0_attn_tp5	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 5",
			pos="6130,4470.2",
			shape=rectangle,
			width=2.9722];
		l0_qkv_tp5 -> l0_attn_tp5	[pos="e,6124.5,4504.3 6118.5,4541 6119.9,4532.5 6121.4,4523.1 6122.9,4514.2"];
		l0_out_proj_tp5	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5",
			pos="6141,4365.2",
			shape=rectangle,
			width=2.9444];
		l0_attn_tp5 -> l0_out_proj_tp5	[pos="e,6137.5,4399.3 6133.5,4436 6134.4,4427.6 6135.4,4418.3 6136.4,4409.5"];
		l0_residual_tp5	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5",
			pos="8346,4226.2",
			width=9.9643];
		l0_out_proj_tp5 -> l0_residual_tp5	[pos="e,8082.1,4246.2 6247.2,4333.7 6251.5,4332.8 6255.8,4331.9 6260,4331.2 6357.5,4313.6 6383.1,4317.5 6482,4312.2 6826,4293.5 6912.8,\
4308.7 7257,4294.2 7534.7,4282.4 7851.9,4262.1 8072,4246.9"];
		l0_gate_tp5	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 5",
			pos="8513,4053.2",
			width=5.7597];
		l0_residual_tp5 -> l0_gate_tp5	[pos="e,8447.4,4121.3 8411.5,4158.1 8420.9,4148.5 8430.6,4138.5 8440.2,4128.8"];
		l0_exp0_gpu5	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5",
			pos="8267,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp5 -> l0_exp0_gpu5	[pos="e,8263.4,3948.4 8290.3,4158 8287.1,4152.2 8284.3,4146.2 8282,4140.2 8259.7,4080.1 8259.8,4004.9 8262.7,3958.5"];
		l0_exp1_gpu5	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5",
			pos="8075,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp5 -> l0_exp1_gpu5	[pos="e,8104.1,3948.4 8287.2,4157.9 8233.4,4096.4 8155.7,4007.5 8110.8,3956.1"];
		l0_exp2_gpu5	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5",
			pos="8459,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp5 -> l0_exp2_gpu5	[pos="e,8371.9,3948 8307.3,4158 8283.3,4106.8 8263.1,4036.7 8297,3985.2 8301.5,3978.4 8330.3,3965.1 8362.4,3951.9"];
		l0_exp3_gpu5	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5",
			pos="9035,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp5 -> l0_exp3_gpu5	[pos="e,9003.8,3948.5 8593.5,4190.9 8659.2,4175.5 8728.5,4153.2 8788,4121.2 8870.6,4076.7 8951.2,4001.9 8996.8,3955.7"];
		l0_exp4_gpu5	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5",
			pos="8843,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp5 -> l0_exp4_gpu5	[pos="e,8834.1,3948.4 8586.7,4184.5 8656.8,4168.1 8721,4146.8 8745,4121.2 8789.2,4074 8816.8,4003.3 8831.1,3958.2"];
		l0_exp5_gpu5	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5",
			pos="8651,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp5 -> l0_exp5_gpu5	[pos="e,8700.5,3948.2 8586.6,4184.3 8651.4,4168.1 8709.1,4147.1 8729,4121.2 8765.7,4073.2 8753.6,4040.4 8729,3985.2 8724.1,3974.1 8716.5,\
3964.1 8707.9,3955.3"];
		l0_exp6_gpu5	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5",
			pos="7883,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp5 -> l0_exp6_gpu5	[pos="e,7917.6,3948.4 8196.1,4158 8174.2,4146.6 8152.1,4134.1 8132,4121.2 8053.8,4070.9 7972.6,3999.4 7925,3955.2"];
		l0_exp7_gpu5	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5",
			pos="9227,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp5 -> l0_exp7_gpu5	[pos="e,9183,3948.3 8597.8,4194.8 8689.3,4179 8792.1,4155.5 8882,4121.2 8993.2,4078.7 9109.4,4001.4 9174.5,3954.5"];
		l0_final_res_tp5	[height=1.8889,
			label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5",
			pos="8772,3602.2",
			width=9.9643];
		l0_residual_tp5 -> l0_final_res_tp5	[pos="e,9111.3,3651.9 8608.9,4204.9 8901.3,4178.8 9333,4127.8 9333,4054.2 9333,4054.2 9333,4054.2 9333,3774.2 9333,3719.8 9235.2,3681 \
9121.3,3654.2"];
		l0_qkv_tp6	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 6",
			pos="6357,4575.2",
			shape=rectangle,
			width=3.1389];
		l0_attn_tp6	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 6",
			pos="6369,4470.2",
			shape=rectangle,
			width=2.9722];
		l0_qkv_tp6 -> l0_attn_tp6	[pos="e,6365.1,4504.3 6360.9,4541 6361.8,4532.6 6362.9,4523.3 6364,4514.5"];
		l0_out_proj_tp6	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6",
			pos="6375,4365.2",
			shape=rectangle,
			width=2.9444];
		l0_attn_tp6 -> l0_out_proj_tp6	[pos="e,6373.1,4399.3 6370.9,4436 6371.4,4427.6 6372,4418.3 6372.5,4409.5"];
		l0_residual_tp6	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6",
			pos="9937,4226.2",
			width=9.9643];
		l0_out_proj_tp6 -> l0_residual_tp6	[pos="e,9672,4245.2 6481.3,4333.4 6484.9,4332.6 6488.5,4331.9 6492,4331.2 6566.2,4316.6 6585.6,4316.7 6661,4312.2 7116.4,4284.6 8258,4308.6 \
8714,4294.2 9039.8,4283.8 9414,4261.8 9661.8,4245.9"];
		l0_gate_tp6	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 6",
			pos="10173,4053.2",
			width=5.7597];
		l0_residual_tp6 -> l0_gate_tp6	[pos="e,10080,4121.3 10030,4158.1 10044,4148 10058,4137.5 10072,4127.3"];
		l0_exp0_gpu6	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6",
			pos="9631,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp6 -> l0_exp0_gpu6	[pos="e,9663.9,3948.4 9870.6,4157.9 9809.8,4096.3 9721.8,4007.1 9671.1,3955.7"];
		l0_exp1_gpu6	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6",
			pos="9823,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp6 -> l0_exp1_gpu6	[pos="e,9835.2,3948.4 9912.3,4157.9 9889.9,4097.2 9857.7,4009.7 9838.7,3958"];
		l0_exp2_gpu6	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6",
			pos="9439,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp6 -> l0_exp2_gpu6	[pos="e,9474.2,3948.5 9765.9,4158.2 9741.9,4146.8 9718,4134.4 9696,4121.2 9614.6,4072.2 9530.6,4000 9481.7,3955.4"];
		l0_exp3_gpu6	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6",
			pos="10015,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp6 -> l0_exp3_gpu6	[pos="e,9956,3948.2 9922.3,4158 9913.9,4103.1 9910.5,4025.2 9942,3966.2 9944,3962.4 9946.4,3958.9 9949.1,3955.5"];
		l0_exp4_gpu6	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6",
			pos="10783,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp6 -> l0_exp4_gpu6	[pos="e,10745,3948.4 10192,4197.8 10284,4182.3 10388,4158.3 10478,4121.2 10579,4079.6 10681,4002 10737,3954.8"];
		l0_exp5_gpu6	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6",
			pos="10207,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp6 -> l0_exp5_gpu6	[pos="e,10120,3945.5 9934.1,4157.9 9932.9,4096.1 9935.5,4010.3 9957,3985.2 10001,3934 10040,3964.9 10110,3948.1"];
		l0_exp6_gpu6	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6",
			pos="10591,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp6 -> l0_exp6_gpu6	[pos="e,10568,3948.2 10184,4190.3 10278,4173 10371,4149.6 10408,4121.2 10470,4072.8 10528,4001.3 10562,3956.5"];
		l0_exp7_gpu6	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6",
			pos="10399,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp6 -> l0_exp7_gpu6	[pos="e,10408,3948.4 10188,4194.4 10277,4178.1 10361,4154.4 10389,4121.2 10427,4076.1 10420,4004.2 10411,3958.3"];
		l0_final_res_tp6	[height=1.8889,
			label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6",
			pos="10223,3602.2",
			width=9.9643];
		l0_residual_tp6 -> l0_final_res_tp6	[pos="e,10537,3628.8 10198,4203.4 10480,4176.2 10889,4124.6 10889,4054.2 10889,4054.2 10889,4054.2 10889,3774.2 10889,3696.5 10717,3653.6 \
10548,3630.2"];
		l0_qkv_tp7	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 7",
			pos="6601,4575.2",
			shape=rectangle,
			width=3.1389];
		l0_attn_tp7	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 7",
			pos="6605,4470.2",
			shape=rectangle,
			width=2.9722];
		l0_qkv_tp7 -> l0_attn_tp7	[pos="e,6603.7,4504.3 6602.3,4541 6602.6,4532.6 6603,4523.3 6603.3,4514.5"];
		l0_out_proj_tp7	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7",
			pos="6607,4365.2",
			shape=rectangle,
			width=2.9444];
		l0_attn_tp7 -> l0_out_proj_tp7	[pos="e,6606.4,4399.3 6605.6,4436 6605.8,4427.6 6606,4418.3 6606.2,4409.5"];
		l0_residual_tp7	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7",
			pos="11458,4226.2",
			width=9.9643];
		l0_out_proj_tp7 -> l0_residual_tp7	[pos="e,11193,4245.5 6713.3,4363.7 7154.5,4361.3 8884.1,4348.9 10305,4294.2 10605,4282.6 10950,4261.6 11183,4246.2"];
		l0_gate_tp7	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 7",
			pos="11625,4053.2",
			width=5.7597];
		l0_residual_tp7 -> l0_gate_tp7	[pos="e,11559,4121.3 11524,4158.1 11533,4148.5 11543,4138.5 11552,4128.8"];
		l0_exp0_gpu7	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7",
			pos="11379,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp7 -> l0_exp0_gpu7	[pos="e,11375,3948.4 11402,4158 11399,4152.2 11396,4146.2 11394,4140.2 11372,4080.1 11372,4004.9 11375,3958.5"];
		l0_exp1_gpu7	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7",
			pos="11187,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp7 -> l0_exp1_gpu7	[pos="e,11216,3948.4 11399,4157.9 11345,4096.4 11268,4007.5 11223,3956.1"];
		l0_exp2_gpu7	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7",
			pos="10995,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp7 -> l0_exp2_gpu7	[pos="e,11030,3948.4 11308,4158 11286,4146.6 11264,4134.1 11244,4121.2 11166,4070.9 11085,3999.4 11037,3955.2"];
		l0_exp3_gpu7	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7",
			pos="11571,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp7 -> l0_exp3_gpu7	[pos="e,11484,3948 11419,4158 11395,4106.8 11375,4036.7 11409,3985.2 11413,3978.4 11442,3965.1 11474,3951.9"];
		l0_exp4_gpu7	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7",
			pos="12147,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp7 -> l0_exp4_gpu7	[pos="e,12116,3948.5 11705,4190.9 11771,4175.5 11840,4153.2 11900,4121.2 11983,4076.7 12063,4001.9 12109,3955.7"];
		l0_exp5_gpu7	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7",
			pos="12339,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp7 -> l0_exp5_gpu7	[pos="e,12295,3948.3 11710,4194.8 11801,4179 11904,4155.5 11994,4121.2 12105,4078.7 12221,4001.4 12287,3954.5"];
		l0_exp6_gpu7	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7",
			pos="11955,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp7 -> l0_exp6_gpu7	[pos="e,11946,3948.4 11699,4184.5 11769,4168.1 11833,4146.8 11857,4121.2 11901,4074 11929,4003.3 11943,3958.2"];
		l0_exp7_gpu7	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7",
			pos="11763,3914.2",
			shape=rectangle,
			width=2.4167];
		l0_residual_tp7 -> l0_exp7_gpu7	[pos="e,11812,3948.2 11699,4184.3 11763,4168.1 11821,4147.1 11841,4121.2 11878,4073.2 11866,4040.4 11841,3985.2 11836,3974.1 11828,3964.1 \
11820,3955.3"];
		l0_final_res_tp7	[height=1.8889,
			label="Layer 0 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7",
			pos="11877,3602.2",
			width=9.9643];
		l0_residual_tp7 -> l0_final_res_tp7	[pos="e,12214,3650 11721,4204.9 12013,4178.8 12445,4127.8 12445,4054.2 12445,4054.2 12445,4054.2 12445,3774.2 12445,3718.1 12342,3678.8 \
12224,3652.2"];
		l0_gate_tp0 -> l0_exp0_gpu0	[pos="e,884.06,3948.3 898.47,3984.9 894.83,3975.6 891.18,3966.4 887.78,3957.7",
			style=dashed];
		l0_gate_tp0 -> l0_exp1_gpu0	[pos="e,738.37,3948.2 804.52,3985.1 784.93,3974.2 765.25,3963.2 747.48,3953.3",
			style=dashed];
		l0_gate_tp0 -> l0_exp2_gpu0	[pos="e,190.17,3945.9 749.42,4036.4 603.82,4021.1 391.75,3993.8 200.15,3948.3",
			style=dashed];
		l0_gate_tp0 -> l0_exp3_gpu0	[pos="e,382.22,3945.7 736.51,4015.5 600.6,3989 434.91,3956.8 392.23,3947.9",
			style=dashed];
		l0_gate_tp0 -> l0_exp4_gpu0	[pos="e,574.08,3945.3 721.63,3991.6 678.69,3978.5 633.55,3964.5 583.76,3948.4",
			style=dashed];
		l0_gate_tp0 -> l0_exp5_gpu0	[pos="e,1175.4,3948.2 1055.4,3998 1092.5,3982.6 1132,3966.2 1166,3952.1",
			style=dashed];
		l0_gate_tp0 -> l0_exp6_gpu0	[pos="e,1360,3945.5 1069.8,4020.3 1150,4001.8 1251.4,3977 1350.1,3948.3",
			style=dashed];
		l0_gate_tp0 -> l0_exp7_gpu0	[pos="e,1029.6,3948.3 992.79,3984.9 1002.9,3974.8 1013,3964.8 1022.4,3955.5",
			style=dashed];
		l0_gate_tp1 -> l0_exp0_gpu1	[pos="e,2288.4,3948.3 2341,3985 2332.3,3978.5 2323.5,3972.1 2315,3966.2 2309.2,3962.1 2303,3957.9 2296.8,3953.8",
			style=dashed];
		l0_gate_tp1 -> l0_exp1_gpu1	[pos="e,2723.8,3946.3 2561.6,4004.2 2611.8,3986.2 2667.9,3966.2 2714.1,3949.7",
			style=dashed];
		l0_gate_tp1 -> l0_exp2_gpu1	[pos="e,2130.3,3946.3 2238.9,3985.1 2204.6,3972.8 2170.2,3960.5 2139.9,3949.7",
			style=dashed];
		l0_gate_tp1 -> l0_exp3_gpu1	[pos="e,1938.2,3945.9 2230.3,4002.5 2176.5,3989.8 2118.2,3976.7 2064,3966.2 2015.3,3956.7 1999.8,3960.3 1947.9,3948.2",
			style=dashed];
		l0_gate_tp1 -> l0_exp4_gpu1	[pos="e,1746.2,3945.9 2249.9,4033.5 2115.9,4017.3 1927.7,3990.1 1755.9,3948.3",
			style=dashed];
		l0_gate_tp1 -> l0_exp5_gpu1	[pos="e,2915.8,3945.6 2574.4,4024.9 2667.3,4006.6 2789.7,3980.5 2906,3948.4",
			style=dashed];
		l0_gate_tp1 -> l0_exp6_gpu1	[pos="e,2572.4,3948.4 2521,3985.1 2535.8,3974.5 2550.7,3963.9 2564.2,3954.3",
			style=dashed];
		l0_gate_tp1 -> l0_exp7_gpu1	[pos="e,2427,3948.3 2427,3984.9 2427,3975.9 2427,3967 2427,3958.6",
			style=dashed];
		l0_gate_tp2 -> l0_exp0_gpu2	[pos="e,3302.2,3945.9 3861.4,4036.4 3715.8,4021.1 3503.8,3993.8 3312.1,3948.3",
			style=dashed];
		l0_gate_tp2 -> l0_exp1_gpu2	[pos="e,3850.4,3948.2 3916.5,3985.1 3896.9,3974.2 3877.3,3963.2 3859.5,3953.3",
			style=dashed];
		l0_gate_tp2 -> l0_exp2_gpu2	[pos="e,3996.1,3948.3 4010.5,3984.9 4006.8,3975.6 4003.2,3966.4 3999.8,3957.7",
			style=dashed];
		l0_gate_tp2 -> l0_exp3_gpu2	[pos="e,3494.1,3946.1 3838.4,3999.1 3787.4,3986.9 3732.4,3974.9 3681,3966.2 3605.7,3953.3 3582.5,3964.3 3504,3948.2",
			style=dashed];
		l0_gate_tp2 -> l0_exp4_gpu2	[pos="e,3686.2,3945.7 3850.4,3985.1 3828.8,3978.3 3807,3971.8 3786,3966.2 3749,3956.2 3736.5,3958.5 3695.9,3948.3",
			style=dashed];
		l0_gate_tp2 -> l0_exp5_gpu2	[pos="e,4141.6,3948.3 4104.8,3984.9 4114.9,3974.8 4125,3964.8 4134.4,3955.5",
			style=dashed];
		l0_gate_tp2 -> l0_exp6_gpu2	[pos="e,4472,3945.5 4181.8,4020.3 4262,4001.8 4363.4,3977 4462.1,3948.3",
			style=dashed];
		l0_gate_tp2 -> l0_exp7_gpu2	[pos="e,4287.4,3948.2 4167.4,3998 4204.5,3982.6 4244,3966.2 4278,3952.1",
			style=dashed];
		l0_gate_tp3 -> l0_exp0_gpu3	[pos="e,5050.2,3945.7 5286.2,3999.2 5241.5,3987.8 5194.2,3976.2 5150,3966.2 5112.6,3957.7 5100.5,3958.7 5059.9,3948.3",
			style=dashed];
		l0_gate_tp3 -> l0_exp1_gpu3	[pos="e,4858.2,3945.8 5305.6,4029.9 5184,4013 5020,3986.4 4868.2,3948.3",
			style=dashed];
		l0_gate_tp3 -> l0_exp2_gpu3	[pos="e,6027.8,3945.7 5634.7,4028.7 5739.9,4010.9 5883.6,3983.9 6017.7,3948.4",
			style=dashed];
		l0_gate_tp3 -> l0_exp3_gpu3	[pos="e,5671.6,3948.2 5605.5,3985.1 5625.1,3974.2 5644.7,3963.2 5662.5,3953.3",
			style=dashed];
		l0_gate_tp3 -> l0_exp4_gpu3	[pos="e,5234.6,3948.2 5323.4,3985.1 5296,3973.7 5268.5,3962.3 5243.9,3952.1",
			style=dashed];
		l0_gate_tp3 -> l0_exp5_gpu3	[pos="e,5380.4,3948.3 5417.2,3984.9 5407.1,3974.8 5397,3964.8 5387.6,3955.5",
			style=dashed];
		l0_gate_tp3 -> l0_exp6_gpu3	[pos="e,5835.9,3945.3 5623.9,4011.2 5683.5,3993.3 5754.1,3971.7 5826.2,3948.4",
			style=dashed];
		l0_gate_tp3 -> l0_exp7_gpu3	[pos="e,5525.9,3948.3 5511.5,3984.9 5515.2,3975.6 5518.8,3966.4 5522.2,3957.7",
			style=dashed];
		l0_gate_tp4 -> l0_exp0_gpu4	[pos="e,6949.6,3948.4 7001,3985.1 6986.2,3974.5 6971.3,3963.9 6957.8,3954.3",
			style=dashed];
		l0_gate_tp4 -> l0_exp1_gpu4	[pos="e,6414.2,3945.9 6917.9,4033.5 6783.9,4017.3 6595.7,3990.1 6423.9,3948.3",
			style=dashed];
		l0_gate_tp4 -> l0_exp2_gpu4	[pos="e,7095,3948.3 7095,3984.9 7095,3975.9 7095,3967 7095,3958.6",
			style=dashed];
		l0_gate_tp4 -> l0_exp3_gpu4	[pos="e,7391.8,3946.3 7229.6,4004.2 7279.8,3986.2 7335.9,3966.2 7382.1,3949.7",
			style=dashed];
		l0_gate_tp4 -> l0_exp4_gpu4	[pos="e,7240.4,3948.4 7189,3985.1 7203.8,3974.5 7218.7,3963.9 7232.2,3954.3",
			style=dashed];
		l0_gate_tp4 -> l0_exp5_gpu4	[pos="e,6606.2,3945.8 6899.5,4004.6 6842.8,3991.4 6780.5,3977.6 6723,3966.2 6678.2,3957.3 6663.9,3959.7 6615.9,3948.2",
			style=dashed];
		l0_gate_tp4 -> l0_exp6_gpu4	[pos="e,6798.3,3946.3 6906.9,3985.1 6872.6,3972.8 6838.2,3960.5 6807.9,3949.7",
			style=dashed];
		l0_gate_tp4 -> l0_exp7_gpu4	[pos="e,7583.8,3945.6 7242.4,4024.9 7335.3,4006.6 7457.7,3980.5 7574,3948.4",
			style=dashed];
		l0_gate_tp5 -> l0_exp0_gpu5	[pos="e,8326.4,3948.2 8392.5,3985.1 8372.9,3974.2 8353.3,3963.2 8335.5,3953.3",
			style=dashed];
		l0_gate_tp5 -> l0_exp1_gpu5	[pos="e,8162.1,3945.3 8309.6,3991.6 8266.7,3978.5 8221.6,3964.5 8171.8,3948.4",
			style=dashed];
		l0_gate_tp5 -> l0_exp2_gpu5	[pos="e,8472.1,3948.3 8486.5,3984.9 8482.8,3975.6 8479.2,3966.4 8475.8,3957.7",
			style=dashed];
		l0_gate_tp5 -> l0_exp3_gpu5	[pos="e,8947.8,3945.7 8654,4014.3 8713.9,3998.7 8784.7,3980.8 8849,3966.2 8885.9,3957.8 8897.9,3958.6 8937.9,3948.3",
			style=dashed];
		l0_gate_tp5 -> l0_exp4_gpu5	[pos="e,8763.4,3948.2 8643.4,3998 8680.5,3982.6 8720,3966.2 8754,3952.1",
			style=dashed];
		l0_gate_tp5 -> l0_exp5_gpu5	[pos="e,8617.6,3948.3 8580.8,3984.9 8590.9,3974.8 8601,3964.8 8610.4,3955.5",
			style=dashed];
		l0_gate_tp5 -> l0_exp6_gpu5	[pos="e,7970.2,3945.7 8329.3,4022.9 8228.4,4005.2 8101.1,3980.4 7980,3948.3",
			style=dashed];
		l0_gate_tp5 -> l0_exp7_gpu5	[pos="e,9139.8,3945.8 8663.3,4029.8 8811.9,4007.1 9029.8,3972.5 9129.9,3948.3",
			style=dashed];
		l0_gate_tp6 -> l0_exp0_gpu6	[pos="e,9718.3,3945.6 9978.8,4006.4 9923,3993.3 9862.1,3979.1 9806,3966.2 9773.8,3958.7 9763.3,3958.1 9728.3,3948.4",
			style=dashed];
		l0_gate_tp6 -> l0_exp1_gpu6	[pos="e,9907.5,3948.2 10002,3985.1 9972.4,3973.7 9943.1,3962.2 9917,3951.9",
			style=dashed];
		l0_gate_tp6 -> l0_exp2_gpu6	[pos="e,9526.2,3945.8 9994.3,4031.3 9868.1,4014.6 9695.3,3987.8 9536.2,3948.3",
			style=dashed];
		l0_gate_tp6 -> l0_exp3_gpu6	[pos="e,10053,3948.3 10095,3984.9 10084,3974.6 10072,3964.4 10061,3955",
			style=dashed];
		l0_gate_tp6 -> l0_exp4_gpu6	[pos="e,10696,3945.7 10322,4027.4 10422,4009.4 10558,3982.6 10686,3948.4",
			style=dashed];
		l0_gate_tp6 -> l0_exp5_gpu6	[pos="e,10199,3948.3 10190,3984.9 10192,3975.7 10194,3966.6 10196,3958",
			style=dashed];
		l0_gate_tp6 -> l0_exp6_gpu6	[pos="e,10504,3945.2 10310,4008.4 10365,3990.9 10428,3970.4 10494,3948.4",
			style=dashed];
		l0_gate_tp6 -> l0_exp7_gpu6	[pos="e,10344,3948.2 10284,3985.1 10302,3974.3 10319,3963.4 10336,3953.6",
			style=dashed];
		l0_gate_tp7 -> l0_exp0_gpu7	[pos="e,11438,3948.2 11505,3985.1 11485,3974.2 11465,3963.2 11447,3953.3",
			style=dashed];
		l0_gate_tp7 -> l0_exp1_gpu7	[pos="e,11274,3945.3 11422,3991.6 11379,3978.5 11334,3964.5 11284,3948.4",
			style=dashed];
		l0_gate_tp7 -> l0_exp2_gpu7	[pos="e,11082,3945.7 11441,4022.9 11340,4005.2 11213,3980.4 11092,3948.3",
			style=dashed];
		l0_gate_tp7 -> l0_exp3_gpu7	[pos="e,11584,3948.3 11598,3984.9 11595,3975.6 11591,3966.4 11588,3957.7",
			style=dashed];
		l0_gate_tp7 -> l0_exp4_gpu7	[pos="e,12060,3945.6 11767,4016.3 11830,4000.6 11905,3982.2 11972,3966.2 12004,3958.5 12015,3958.1 12050,3948.4",
			style=dashed];
		l0_gate_tp7 -> l0_exp5_gpu7	[pos="e,12252,3945.8 11778,4033.6 11901,4016.9 12079,3989 12242,3948.3",
			style=dashed];
		l0_gate_tp7 -> l0_exp6_gpu7	[pos="e,11875,3948.2 11755,3998 11792,3982.6 11832,3966.2 11866,3952.1",
			style=dashed];
		l0_gate_tp7 -> l0_exp7_gpu7	[pos="e,11730,3948.3 11693,3984.9 11703,3974.8 11713,3964.8 11722,3955.5",
			style=dashed];
		l0_exp_agg_tp0	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 0",
			pos="871,3775.2",
			width=6.1053];
		l0_exp0_gpu0 -> l0_exp_agg_tp0	[pos="e,871,3843.4 871,3880 871,3871.9 871,3862.8 871,3853.5"];
		l0_exp1_gpu0 -> l0_exp_agg_tp0	[pos="e,776.78,3843.4 725.48,3880 738.59,3870.6 753.39,3860.1 768.42,3849.4"];
		l0_exp2_gpu0 -> l0_exp_agg_tp0	[pos="e,708.16,3793.2 190.18,3882.5 193.15,3881.7 196.09,3880.9 199,3880.2 366.29,3838.8 561.29,3810.8 698.01,3794.4"];
		l0_exp3_gpu0 -> l0_exp_agg_tp0	[pos="e,715.85,3805 382.24,3882.7 385.19,3881.8 388.11,3881 391,3880.2 494.61,3851.2 612.66,3825.6 705.77,3807"];
		l0_exp4_gpu0 -> l0_exp_agg_tp0	[pos="e,729.99,3826.5 574.14,3882.1 617.38,3866.7 670.85,3847.6 720.45,3829.9"];
		l0_exp5_gpu0 -> l0_exp_agg_tp0	[pos="e,1058.9,3843.2 1167.9,3882.1 1138.1,3871.5 1103.6,3859.1 1068.7,3846.7"];
		l0_exp6_gpu0 -> l0_exp_agg_tp0	[pos="e,1071.4,3814.1 1359.8,3882.7 1356.8,3881.8 1353.9,3881 1351,3880.2 1263.5,3855.7 1165.7,3833.6 1081.3,3816.1"];
		l0_exp7_gpu0 -> l0_exp_agg_tp0	[pos="e,965.22,3843.4 1016.5,3880 1003.4,3870.6 988.61,3860.1 973.58,3849.4"];
		l0_exp_agg_tp0 -> l0_final_res_tp0	[pos="e,873.43,3670.3 872.57,3707.1 872.77,3698.4 872.98,3689.5 873.19,3680.6"];
		l1_qkv_tp0	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 0",
			pos="747,3463.2",
			shape=rectangle,
			width=3.1389];
		l0_final_res_tp0 -> l1_qkv_tp0	[pos="e,777.95,3497.3 812.12,3533.9 802.84,3523.9 793.52,3514 784.95,3504.8"];
		l1_residual_tp0	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0",
			pos="777,3114.2",
			width=9.9643];
		l0_final_res_tp0 -> l1_residual_tp0	[pos="e,852.2,3182.4 877.75,3533.9 878.44,3511.7 879,3486.9 879,3464.2 879,3464.2 879,3464.2 879,3252.2 879,3230.1 870.34,3209.2 858.07,\
3190.7"];
		l0_exp_agg_tp1	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 1",
			pos="2427,3775.2",
			width=6.1053];
		l0_exp0_gpu1 -> l0_exp_agg_tp1	[pos="e,2332.8,3843.4 2281.5,3880 2294.6,3870.6 2309.4,3860.1 2324.4,3849.4"];
		l0_exp1_gpu1 -> l0_exp_agg_tp1	[pos="e,2614.9,3843.2 2723.9,3882.1 2694.1,3871.5 2659.6,3859.1 2624.7,3846.7"];
		l0_exp2_gpu1 -> l0_exp_agg_tp1	[pos="e,2286,3826.5 2130.1,3882.1 2173.4,3866.7 2226.9,3847.6 2276.5,3829.9"];
		l0_exp3_gpu1 -> l0_exp_agg_tp1	[pos="e,2271.8,3805 1938.2,3882.7 1941.2,3881.8 1944.1,3881 1947,3880.2 2050.6,3851.2 2168.7,3825.6 2261.8,3807"];
		l0_exp4_gpu1 -> l0_exp_agg_tp1	[pos="e,2264.2,3793.2 1746.2,3882.5 1749.1,3881.7 1752.1,3880.9 1755,3880.2 1922.3,3838.8 2117.3,3810.8 2254,3794.4"];
		l0_exp5_gpu1 -> l0_exp_agg_tp1	[pos="e,2627.4,3814.1 2915.8,3882.7 2912.8,3881.8 2909.9,3881 2907,3880.2 2819.5,3855.7 2721.7,3833.6 2637.3,3816.1"];
		l0_exp6_gpu1 -> l0_exp_agg_tp1	[pos="e,2521.2,3843.4 2572.5,3880 2559.4,3870.6 2544.6,3860.1 2529.6,3849.4"];
		l0_exp7_gpu1 -> l0_exp_agg_tp1	[pos="e,2427,3843.4 2427,3880 2427,3871.9 2427,3862.8 2427,3853.5"];
		l0_exp_agg_tp1 -> l0_final_res_tp1	[pos="e,2495,3670.3 2470.9,3707.1 2477,3697.8 2483.2,3688.3 2489.4,3678.9"];
		l1_qkv_tp1	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 1",
			pos="2442,3463.2",
			shape=rectangle,
			width=3.1389];
		l0_final_res_tp1 -> l1_qkv_tp1	[pos="e,2465.5,3497.3 2491.4,3533.9 2484.5,3524.2 2477.7,3514.6 2471.3,3505.6"];
		l1_residual_tp1	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1",
			pos="2541,3114.2",
			width=9.9643];
		l0_final_res_tp1 -> l1_residual_tp1	[pos="e,2563.8,3182.3 2563.2,3534.1 2569.2,3512.1 2574,3487.4 2574,3464.2 2574,3464.2 2574,3464.2 2574,3252.2 2574,3232.5 2570.7,3211.6 \
2566.3,3192.3"];
		l0_exp_agg_tp2	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 2",
			pos="3983,3775.2",
			width=6.1053];
		l0_exp0_gpu2 -> l0_exp_agg_tp2	[pos="e,3820.2,3793.2 3302.2,3882.5 3305.1,3881.7 3308.1,3880.9 3311,3880.2 3478.3,3838.8 3673.3,3810.8 3810,3794.4"];
		l0_exp1_gpu2 -> l0_exp_agg_tp2	[pos="e,3888.8,3843.4 3837.5,3880 3850.6,3870.6 3865.4,3860.1 3880.4,3849.4"];
		l0_exp2_gpu2 -> l0_exp_agg_tp2	[pos="e,3983,3843.4 3983,3880 3983,3871.9 3983,3862.8 3983,3853.5"];
		l0_exp3_gpu2 -> l0_exp_agg_tp2	[pos="e,3827.8,3805 3494.2,3882.7 3497.2,3881.8 3500.1,3881 3503,3880.2 3606.6,3851.2 3724.7,3825.6 3817.8,3807"];
		l0_exp4_gpu2 -> l0_exp_agg_tp2	[pos="e,3842,3826.5 3686.1,3882.1 3729.4,3866.7 3782.9,3847.6 3832.5,3829.9"];
		l0_exp5_gpu2 -> l0_exp_agg_tp2	[pos="e,4077.2,3843.4 4128.5,3880 4115.4,3870.6 4100.6,3860.1 4085.6,3849.4"];
		l0_exp6_gpu2 -> l0_exp_agg_tp2	[pos="e,4183.4,3814.1 4471.8,3882.7 4468.8,3881.8 4465.9,3881 4463,3880.2 4375.5,3855.7 4277.7,3833.6 4193.3,3816.1"];
		l0_exp7_gpu2 -> l0_exp_agg_tp2	[pos="e,4170.9,3843.2 4279.9,3882.1 4250.1,3871.5 4215.6,3859.1 4180.7,3846.7"];
		l0_exp_agg_tp2 -> l0_final_res_tp2	[pos="e,3992.1,3670.3 3988.9,3707.1 3989.7,3698.3 3990.4,3689.3 3991.2,3680.3"];
		l1_qkv_tp2	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 2",
			pos="3882,3463.2",
			shape=rectangle,
			width=3.1389];
		l0_final_res_tp2 -> l1_qkv_tp2	[pos="e,3910.1,3497.3 3941,3533.9 3932.7,3524 3924.3,3514.2 3916.6,3505.1"];
		l1_residual_tp2	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2",
			pos="3952,3114.2",
			width=9.9643];
		l0_final_res_tp2 -> l1_residual_tp2	[pos="e,3995.7,3182.2 4009,3534.1 4011.8,3511.9 4014,3487 4014,3464.2 4014,3464.2 4014,3464.2 4014,3252.2 4014,3231.5 4008.1,3210.6 3999.9,\
3191.5"];
		l0_exp_agg_tp3	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 3",
			pos="5539,3775.2",
			width=6.1053];
		l0_exp0_gpu3 -> l0_exp_agg_tp3	[pos="e,5383.8,3805 5050.2,3882.7 5053.2,3881.8 5056.1,3881 5059,3880.2 5162.6,3851.2 5280.7,3825.6 5373.8,3807"];
		l0_exp1_gpu3 -> l0_exp_agg_tp3	[pos="e,5376.2,3793.2 4858.2,3882.5 4861.1,3881.7 4864.1,3880.9 4867,3880.2 5034.3,3838.8 5229.3,3810.8 5366,3794.4"];
		l0_exp2_gpu3 -> l0_exp_agg_tp3	[pos="e,5739.4,3814.1 6027.8,3882.7 6024.8,3881.8 6021.9,3881 6019,3880.2 5931.5,3855.7 5833.7,3833.6 5749.3,3816.1"];
		l0_exp3_gpu3 -> l0_exp_agg_tp3	[pos="e,5633.2,3843.4 5684.5,3880 5671.4,3870.6 5656.6,3860.1 5641.6,3849.4"];
		l0_exp4_gpu3 -> l0_exp_agg_tp3	[pos="e,5398,3826.5 5242.1,3882.1 5285.4,3866.7 5338.9,3847.6 5388.5,3829.9"];
		l0_exp5_gpu3 -> l0_exp_agg_tp3	[pos="e,5444.8,3843.4 5393.5,3880 5406.6,3870.6 5421.4,3860.1 5436.4,3849.4"];
		l0_exp6_gpu3 -> l0_exp_agg_tp3	[pos="e,5726.9,3843.2 5835.9,3882.1 5806.1,3871.5 5771.6,3859.1 5736.7,3846.7"];
		l0_exp7_gpu3 -> l0_exp_agg_tp3	[pos="e,5539,3843.4 5539,3880 5539,3871.9 5539,3862.8 5539,3853.5"];
		l0_exp_agg_tp3 -> l0_final_res_tp3	[pos="e,5606.4,3670.3 5582.6,3707.1 5588.6,3697.8 5594.7,3688.3 5600.8,3678.9"];
		l1_qkv_tp3	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 3",
			pos="5553,3463.2",
			shape=rectangle,
			width=3.1389];
		l0_final_res_tp3 -> l1_qkv_tp3	[pos="e,5576.5,3497.3 5602.4,3533.9 5595.5,3524.2 5588.7,3514.6 5582.3,3505.6"];
		l1_residual_tp3	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3",
			pos="5653,3114.2",
			width=9.9643];
		l0_final_res_tp3 -> l1_residual_tp3	[pos="e,5675.1,3182.4 5674.2,3534.1 5680.2,3512.1 5685,3487.4 5685,3464.2 5685,3464.2 5685,3464.2 5685,3252.2 5685,3232.5 5681.8,3211.7 \
5677.5,3192.3"];
		l0_exp_agg_tp4	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 4",
			pos="7095,3775.2",
			width=6.1053];
		l0_exp0_gpu4 -> l0_exp_agg_tp4	[pos="e,7000.8,3843.4 6949.5,3880 6962.6,3870.6 6977.4,3860.1 6992.4,3849.4"];
		l0_exp1_gpu4 -> l0_exp_agg_tp4	[pos="e,6932.2,3793.2 6414.2,3882.5 6417.1,3881.7 6420.1,3880.9 6423,3880.2 6590.3,3838.8 6785.3,3810.8 6922,3794.4"];
		l0_exp2_gpu4 -> l0_exp_agg_tp4	[pos="e,7095,3843.4 7095,3880 7095,3871.9 7095,3862.8 7095,3853.5"];
		l0_exp3_gpu4 -> l0_exp_agg_tp4	[pos="e,7282.9,3843.2 7391.9,3882.1 7362.1,3871.5 7327.6,3859.1 7292.7,3846.7"];
		l0_exp4_gpu4 -> l0_exp_agg_tp4	[pos="e,7189.2,3843.4 7240.5,3880 7227.4,3870.6 7212.6,3860.1 7197.6,3849.4"];
		l0_exp5_gpu4 -> l0_exp_agg_tp4	[pos="e,6939.8,3805 6606.2,3882.7 6609.2,3881.8 6612.1,3881 6615,3880.2 6718.6,3851.2 6836.7,3825.6 6929.8,3807"];
		l0_exp6_gpu4 -> l0_exp_agg_tp4	[pos="e,6954,3826.5 6798.1,3882.1 6841.4,3866.7 6894.9,3847.6 6944.5,3829.9"];
		l0_exp7_gpu4 -> l0_exp_agg_tp4	[pos="e,7295.4,3814.1 7583.8,3882.7 7580.8,3881.8 7577.9,3881 7575,3880.2 7487.5,3855.7 7389.7,3833.6 7305.3,3816.1"];
		l0_exp_agg_tp4 -> l0_final_res_tp4	[pos="e,7115,3670.3 7107.9,3707.1 7109.6,3698.3 7111.4,3689.3 7113.1,3680.3"];
		l1_qkv_tp4	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 4",
			pos="6996,3463.2",
			shape=rectangle,
			width=3.1389];
		l0_final_res_tp4 -> l1_qkv_tp4	[pos="e,7027.9,3497.3 7063.2,3533.9 7053.5,3523.8 7043.8,3513.8 7034.9,3504.5"];
		l1_residual_tp4	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4",
			pos="7095,3114.2",
			width=9.9643];
		l0_final_res_tp4 -> l1_residual_tp4	[pos="e,7117.8,3182.3 7128,3533.9 7128,3511.7 7128,3486.9 7128,3464.2 7128,3464.2 7128,3464.2 7128,3252.2 7128,3232.5 7124.7,3211.6 7120.3,\
3192.3"];
		l0_exp_agg_tp5	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 5",
			pos="8651,3775.2",
			width=6.1053];
		l0_exp0_gpu5 -> l0_exp_agg_tp5	[pos="e,8510,3826.5 8354.1,3882.1 8397.4,3866.7 8450.9,3847.6 8500.5,3829.9"];
		l0_exp1_gpu5 -> l0_exp_agg_tp5	[pos="e,8495.8,3805 8162.2,3882.7 8165.2,3881.8 8168.1,3881 8171,3880.2 8274.6,3851.2 8392.7,3825.6 8485.8,3807"];
		l0_exp2_gpu5 -> l0_exp_agg_tp5	[pos="e,8556.8,3843.4 8505.5,3880 8518.6,3870.6 8533.4,3860.1 8548.4,3849.4"];
		l0_exp3_gpu5 -> l0_exp_agg_tp5	[pos="e,8838.9,3843.2 8947.9,3882.1 8918.1,3871.5 8883.6,3859.1 8848.7,3846.7"];
		l0_exp4_gpu5 -> l0_exp_agg_tp5	[pos="e,8745.2,3843.4 8796.5,3880 8783.4,3870.6 8768.6,3860.1 8753.6,3849.4"];
		l0_exp5_gpu5 -> l0_exp_agg_tp5	[pos="e,8651,3843.4 8651,3880 8651,3871.9 8651,3862.8 8651,3853.5"];
		l0_exp6_gpu5 -> l0_exp_agg_tp5	[pos="e,8488.2,3793.2 7970.2,3882.5 7973.1,3881.7 7976.1,3880.9 7979,3880.2 8146.3,3838.8 8341.3,3810.8 8478,3794.4"];
		l0_exp7_gpu5 -> l0_exp_agg_tp5	[pos="e,8851.4,3814.1 9139.8,3882.7 9136.8,3881.8 9133.9,3881 9131,3880.2 9043.5,3855.7 8945.7,3833.6 8861.3,3816.1"];
		l0_exp_agg_tp5 -> l0_final_res_tp5	[pos="e,8724.5,3670.3 8698.5,3707.1 8705.1,3697.7 8711.9,3688.1 8718.6,3678.6"];
		l1_qkv_tp5	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 5",
			pos="8678,3463.2",
			shape=rectangle,
			width=3.1389];
		l0_final_res_tp5 -> l1_qkv_tp5	[pos="e,8700.7,3497.3 8725.8,3533.9 8719.2,3524.2 8712.6,3514.6 8706.4,3505.6"];
		l1_residual_tp5	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5",
			pos="8754,3114.2",
			width=9.9643];
		l0_final_res_tp5 -> l1_residual_tp5	[pos="e,8793.3,3182.3 8798.4,3533.9 8804.9,3512 8810,3487.4 8810,3464.2 8810,3464.2 8810,3464.2 8810,3252.2 8810,3231.7 8804.6,3210.8 \
8797.2,3191.6"];
		l0_exp_agg_tp6	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 6",
			pos="10207,3775.2",
			width=6.1053];
		l0_exp0_gpu6 -> l0_exp_agg_tp6	[pos="e,10052,3805 9718.2,3882.7 9721.2,3881.8 9724.1,3881 9727,3880.2 9830.6,3851.2 9948.7,3825.6 10042,3807"];
		l0_exp1_gpu6 -> l0_exp_agg_tp6	[pos="e,10066,3826.5 9910.1,3882.1 9953.4,3866.7 10007,3847.6 10056,3829.9"];
		l0_exp2_gpu6 -> l0_exp_agg_tp6	[pos="e,10044,3793.2 9526.2,3882.5 9529.1,3881.7 9532.1,3880.9 9535,3880.2 9702.3,3838.8 9897.3,3810.8 10034,3794.4"];
		l0_exp3_gpu6 -> l0_exp_agg_tp6	[pos="e,10113,3843.4 10061,3880 10075,3870.6 10089,3860.1 10104,3849.4"];
		l0_exp4_gpu6 -> l0_exp_agg_tp6	[pos="e,10407,3814.1 10696,3882.7 10693,3881.8 10690,3881 10687,3880.2 10600,3855.7 10502,3833.6 10417,3816.1"];
		l0_exp5_gpu6 -> l0_exp_agg_tp6	[pos="e,10207,3843.4 10207,3880 10207,3871.9 10207,3862.8 10207,3853.5"];
		l0_exp6_gpu6 -> l0_exp_agg_tp6	[pos="e,10395,3843.2 10504,3882.1 10474,3871.5 10440,3859.1 10405,3846.7"];
		l0_exp7_gpu6 -> l0_exp_agg_tp6	[pos="e,10301,3843.4 10353,3880 10339,3870.6 10325,3860.1 10310,3849.4"];
		l0_exp_agg_tp6 -> l0_final_res_tp6	[pos="e,10217,3670.3 10213,3707.1 10214,3698.3 10215,3689.3 10216,3680.3"];
		l1_qkv_tp6	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 6",
			pos="10108,3463.2",
			shape=rectangle,
			width=3.1389];
		l0_final_res_tp6 -> l1_qkv_tp6	[pos="e,10136,3497.3 10167,3533.9 10158,3524 10150,3514.2 10142,3505.1"];
		l1_residual_tp6	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6",
			pos="10207,3114.2",
			width=9.9643];
		l0_final_res_tp6 -> l1_residual_tp6	[pos="e,10230,3182.3 10235,3534.1 10238,3511.9 10240,3487.1 10240,3464.2 10240,3464.2 10240,3464.2 10240,3252.2 10240,3232.5 10237,3211.6 \
10232,3192.3"];
		l0_exp_agg_tp7	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 7",
			pos="11763,3775.2",
			width=6.1053];
		l0_exp0_gpu7 -> l0_exp_agg_tp7	[pos="e,11622,3826.5 11466,3882.1 11509,3866.7 11563,3847.6 11612,3829.9"];
		l0_exp1_gpu7 -> l0_exp_agg_tp7	[pos="e,11608,3805 11274,3882.7 11277,3881.8 11280,3881 11283,3880.2 11387,3851.2 11505,3825.6 11598,3807"];
		l0_exp2_gpu7 -> l0_exp_agg_tp7	[pos="e,11600,3793.2 11082,3882.5 11085,3881.7 11088,3880.9 11091,3880.2 11258,3838.8 11453,3810.8 11590,3794.4"];
		l0_exp3_gpu7 -> l0_exp_agg_tp7	[pos="e,11669,3843.4 11617,3880 11631,3870.6 11645,3860.1 11660,3849.4"];
		l0_exp4_gpu7 -> l0_exp_agg_tp7	[pos="e,11951,3843.2 12060,3882.1 12030,3871.5 11996,3859.1 11961,3846.7"];
		l0_exp5_gpu7 -> l0_exp_agg_tp7	[pos="e,11963,3814.1 12252,3882.7 12249,3881.8 12246,3881 12243,3880.2 12156,3855.7 12058,3833.6 11973,3816.1"];
		l0_exp6_gpu7 -> l0_exp_agg_tp7	[pos="e,11857,3843.4 11909,3880 11895,3870.6 11881,3860.1 11866,3849.4"];
		l0_exp7_gpu7 -> l0_exp_agg_tp7	[pos="e,11763,3843.4 11763,3880 11763,3871.9 11763,3862.8 11763,3853.5"];
		l0_exp_agg_tp7 -> l0_final_res_tp7	[pos="e,11832,3670.3 11808,3707.1 11814,3697.8 11820,3688.3 11827,3678.9"];
		l1_qkv_tp7	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 7",
			pos="11780,3463.2",
			shape=rectangle,
			width=3.1389];
		l0_final_res_tp7 -> l1_qkv_tp7	[pos="e,11803,3497.3 11829,3533.9 11823,3524.2 11816,3514.6 11809,3505.6"];
		l1_residual_tp7	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7",
			pos="11897,3114.2",
			width=9.9643];
		l0_final_res_tp7 -> l1_residual_tp7	[pos="e,11907,3182.2 11901,3534.1 11907,3512.1 11912,3487.4 11912,3464.2 11912,3464.2 11912,3464.2 11912,3252.2 11912,3232.7 11910,3211.8 \
11908,3192.3"];
		l1_attn_tp0	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 0",
			pos="750,3358.2",
			shape=rectangle,
			width=2.9722];
		l1_qkv_tp0 -> l1_attn_tp0	[pos="e,749.04,3392.3 747.97,3429 748.21,3420.6 748.48,3411.3 748.74,3402.5"];
		l1_out_proj_tp0	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0",
			pos="753,3253.2",
			shape=rectangle,
			width=2.9444];
		l1_attn_tp0 -> l1_out_proj_tp0	[pos="e,752.04,3287.3 750.97,3324 751.21,3315.6 751.48,3306.3 751.74,3297.5"];
		l1_out_proj_tp0 -> l1_residual_tp0	[pos="e,765.22,3182.4 758.81,3219 760.24,3210.9 761.82,3201.8 763.45,3192.5"];
		l1_gate_tp0	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 0",
			pos="871,2941.2",
			width=5.7597];
		l1_residual_tp0 -> l1_gate_tp0	[pos="e,834.07,3009.3 813.88,3046.1 818.91,3036.9 824.1,3027.5 829.21,3018.2"];
		l1_exp0_gpu0	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0",
			pos="871,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp0 -> l1_exp0_gpu0	[pos="e,783.92,2833.2 680.18,3046 670.03,3034.9 661.18,3022.6 655,3009.2 629.67,2954.3 619.1,2921.8 655,2873.2 686.33,2830.7 718.24,2850.9 \
774,2836.2"];
		l1_exp1_gpu0	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0",
			pos="679,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp0 -> l1_exp1_gpu0	[pos="e,649.49,2836.5 658.25,3046.2 646.97,3035.2 637.11,3022.9 630,3009.2 602.22,2955.5 611.83,2930.8 630,2873.2 633.08,2863.4 638.06,\
2853.8 643.69,2845"];
		l1_exp2_gpu0	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0",
			pos="103,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp0 -> l1_exp2_gpu0	[pos="e,133.56,2836.4 441.75,3046.1 411.08,3035.5 381.03,3023.2 353,3009.2 268.06,2966.6 186.34,2890.5 140.59,2843.6"];
		l1_exp3_gpu0	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0",
			pos="295,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp0 -> l1_exp3_gpu0	[pos="e,323.07,2836.5 582.52,3046 558.75,3035 535.35,3022.7 514,3009.2 440.68,2962.6 370.17,2889.6 329.77,2844.1"];
		l1_exp4_gpu0	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0",
			pos="487,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp0 -> l1_exp4_gpu0	[pos="e,500.64,2836.2 650.92,3045.9 635.49,3034.8 620.71,3022.5 608,3009.2 561.37,2960.2 525.05,2890 504.83,2845.6"];
		l1_exp5_gpu0	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0",
			pos="1255,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp0 -> l1_exp5_gpu0	[pos="e,1240.2,2836.4 1002.9,3058.8 1028.1,3049.9 1052.9,3039.7 1076,3028.2 1153.7,2989.3 1208.5,2899.3 1235.6,2845.6"];
		l1_exp6_gpu0	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0",
			pos="1447,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp0 -> l1_exp6_gpu0	[pos="e,1411.7,2836.4 1011.3,3066.5 1064.5,3051.7 1119.8,3032.8 1169,3009.2 1260.4,2965.2 1352.1,2889.6 1404,2843.3"];
		l1_exp7_gpu0	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 0",
			pos="1063,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp0 -> l1_exp7_gpu0	[pos="e,1079.6,2836.2 1014.6,3069.4 1042.9,3054.6 1068.4,3035.1 1087,3009.2 1121.4,2961.4 1102.1,2890.6 1083.6,2845.7"];
		l1_final_res_tp0	[height=1.8889,
			label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 0",
			pos="948,2490.2",
			width=9.9643];
		l1_residual_tp0 -> l1_final_res_tp0	[pos="e,1275.3,2528.6 1051.4,3103.7 1274.7,3088.3 1553,3047.9 1553,2942.2 1553,2942.2 1553,2942.2 1553,2662.2 1553,2597.7 1424.1,2556.3 \
1285.3,2530.4"];
		l1_gate_tp0 -> l1_exp0_gpu0	[pos="e,871,2836.3 871,2872.9 871,2863.9 871,2855 871,2846.6",
			style=dashed];
		l1_gate_tp0 -> l1_exp1_gpu0	[pos="e,725.58,2836.4 776.97,2873.1 762.18,2862.5 747.32,2851.9 733.81,2842.3",
			style=dashed];
		l1_gate_tp0 -> l1_exp2_gpu0	[pos="e,190.18,2833.9 693.86,2921.5 559.9,2905.3 371.74,2878.1 199.91,2836.3",
			style=dashed];
		l1_gate_tp0 -> l1_exp3_gpu0	[pos="e,382.22,2833.7 677.82,2896.1 615.98,2882.3 547.17,2867.3 484,2854.2 445.68,2846.2 433.38,2846.9 392.1,2836.3",
			style=dashed];
		l1_gate_tp0 -> l1_exp4_gpu0	[pos="e,574.26,2834.3 682.94,2873.1 648.64,2860.8 614.18,2848.5 583.93,2837.7",
			style=dashed];
		l1_gate_tp0 -> l1_exp5_gpu0	[pos="e,1167.8,2834.3 1005.6,2892.2 1055.8,2874.2 1111.9,2854.2 1158.1,2837.7",
			style=dashed];
		l1_gate_tp0 -> l1_exp6_gpu0	[pos="e,1359.8,2833.6 1018.4,2912.9 1111.3,2894.6 1233.7,2868.5 1350,2836.4",
			style=dashed];
		l1_gate_tp0 -> l1_exp7_gpu0	[pos="e,1009.6,2836.3 956.96,2873 965.68,2866.5 974.47,2860.1 983,2854.2 988.84,2850.1 995,2845.9 1001.2,2841.8",
			style=dashed];
		l1_exp_agg_tp0	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 0",
			pos="871,2663.2",
			width=6.1053];
		l1_exp0_gpu0 -> l1_exp_agg_tp0	[pos="e,871,2731.4 871,2768 871,2759.9 871,2750.8 871,2741.5"];
		l1_exp1_gpu0 -> l1_exp_agg_tp0	[pos="e,776.78,2731.4 725.48,2768 738.59,2758.6 753.39,2748.1 768.42,2737.4"];
		l1_exp2_gpu0 -> l1_exp_agg_tp0	[pos="e,708.16,2681.2 190.18,2770.5 193.15,2769.7 196.09,2768.9 199,2768.2 366.29,2726.8 561.29,2698.8 698.01,2682.4"];
		l1_exp3_gpu0 -> l1_exp_agg_tp0	[pos="e,715.85,2693 382.24,2770.7 385.19,2769.8 388.11,2769 391,2768.2 494.61,2739.2 612.66,2713.6 705.77,2695"];
		l1_exp4_gpu0 -> l1_exp_agg_tp0	[pos="e,729.99,2714.5 574.14,2770.1 617.38,2754.7 670.85,2735.6 720.45,2717.9"];
		l1_exp5_gpu0 -> l1_exp_agg_tp0	[pos="e,1058.9,2731.2 1167.9,2770.1 1138.1,2759.5 1103.6,2747.1 1068.7,2734.7"];
		l1_exp6_gpu0 -> l1_exp_agg_tp0	[pos="e,1071.4,2702.1 1359.8,2770.7 1356.8,2769.8 1353.9,2769 1351,2768.2 1263.5,2743.7 1165.7,2721.6 1081.3,2704.1"];
		l1_exp7_gpu0 -> l1_exp_agg_tp0	[pos="e,965.22,2731.4 1016.5,2768 1003.4,2758.6 988.61,2748.1 973.58,2737.4"];
		l1_exp_agg_tp0 -> l1_final_res_tp0	[pos="e,917.75,2558.3 901.21,2595.1 905.29,2586 909.49,2576.7 913.64,2567.5"];
		l1_attn_tp1	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 1",
			pos="2445,3358.2",
			shape=rectangle,
			width=2.9722];
		l1_qkv_tp1 -> l1_attn_tp1	[pos="e,2444,3392.3 2443,3429 2443.2,3420.6 2443.5,3411.3 2443.7,3402.5"];
		l1_out_proj_tp1	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1",
			pos="2448,3253.2",
			shape=rectangle,
			width=2.9444];
		l1_attn_tp1 -> l1_out_proj_tp1	[pos="e,2447,3287.3 2446,3324 2446.2,3315.6 2446.5,3306.3 2446.7,3297.5"];
		l1_out_proj_tp1 -> l1_residual_tp1	[pos="e,2495.4,3182.4 2470.5,3219 2476.4,3210.3 2483,3200.6 2489.7,3190.7"];
		l1_gate_tp1	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 1",
			pos="2373,2941.2",
			width=5.7597];
		l1_residual_tp1 -> l1_gate_tp1	[pos="e,2439,3009.3 2475.1,3046.1 2465.6,3036.5 2455.9,3026.5 2446.3,3016.8"];
		l1_exp0_gpu1	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1",
			pos="2235,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp1 -> l1_exp0_gpu1	[pos="e,2185.5,2836.2 2215.6,3046.2 2188.5,3035.2 2167.5,3022.9 2157,3009.2 2120.3,2961.2 2132.4,2928.4 2157,2873.2 2161.9,2862.1 2169.5,\
2852.1 2178.1,2843.3"];
		l1_exp1_gpu1	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1",
			pos="2811,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp1 -> l1_exp1_gpu1	[pos="e,2782,2836.4 2599.6,3045.9 2653.1,2984.4 2730.6,2895.5 2775.4,2844.1"];
		l1_exp2_gpu1	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1",
			pos="2043,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp1 -> l1_exp2_gpu1	[pos="e,2048.7,2836.5 2199,3046.1 2167.7,3035 2142.6,3022.7 2129,3009.2 2083.9,2964.3 2061.3,2892.3 2050.9,2846.4"];
		l1_exp3_gpu1	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1",
			pos="1851,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp1 -> l1_exp3_gpu1	[pos="e,1873.8,2836.5 2207.1,3069.3 2153.6,3054.7 2100.4,3035.2 2053,3009.2 1979.1,2968.5 1915,2892.2 1879.8,2844.8"];
		l1_exp4_gpu1	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1",
			pos="1659,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp1 -> l1_exp4_gpu1	[pos="e,1686.4,2836.2 2238.4,3098.7 2127.4,3084.6 2003.2,3058.2 1898,3009.2 1813.6,2969.8 1735.9,2891.9 1693.2,2844"];
		l1_exp5_gpu1	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1",
			pos="3003,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp1 -> l1_exp5_gpu1	[pos="e,2953.6,2836.3 2641,3046.1 2733.8,2983.8 2868.9,2893.1 2945.1,2842"];
		l1_exp6_gpu1	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1",
			pos="2619,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp1 -> l1_exp6_gpu1	[pos="e,2622.5,2836.4 2595.8,3046 2599,3040.2 2601.8,3034.2 2604,3028.2 2626.1,2968 2626.1,2892.9 2623.2,2846.4"];
		l1_exp7_gpu1	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 1",
			pos="2427,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp1 -> l1_exp7_gpu1	[pos="e,2514.1,2836 2577,3046.1 2582,3034.1 2586.3,3021.5 2589,3009.2 2595.5,2979.6 2605.6,2898.4 2589,2873.2 2584.5,2866.4 2555.7,2853.1 \
2523.6,2839.9"];
		l1_final_res_tp1	[height=1.8889,
			label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 1",
			pos="2815,2490.2",
			width=9.9643];
		l1_residual_tp1 -> l1_final_res_tp1	[pos="e,3045.2,2558.4 2793,3082.7 2944.8,3057.1 3109,3013 3109,2942.2 3109,2942.2 3109,2942.2 3109,2662.2 3109,2620.3 3086.4,2588.4 3053.7,\
2564.3"];
		l1_gate_tp1 -> l1_exp0_gpu1	[pos="e,2268.4,2836.3 2305.2,2872.9 2295.1,2862.8 2285,2852.8 2275.6,2843.5",
			style=dashed];
		l1_gate_tp1 -> l1_exp1_gpu1	[pos="e,2723.8,2833.7 2506.5,2890.7 2544.2,2877.8 2585.4,2864.5 2624,2854.2 2661,2844.2 2673.5,2846.5 2714.1,2836.3",
			style=dashed];
		l1_gate_tp1 -> l1_exp2_gpu1	[pos="e,2122.6,2836.2 2211.4,2873.1 2184,2861.7 2156.5,2850.3 2131.9,2840.1",
			style=dashed];
		l1_gate_tp1 -> l1_exp3_gpu1	[pos="e,1938,2833.5 2178.4,2893.5 2086,2871.2 1988.4,2847.4 1947.7,2836.2",
			style=dashed];
		l1_gate_tp1 -> l1_exp4_gpu1	[pos="e,1746.2,2833.8 2193.6,2917.9 2072,2901 1908,2874.4 1756.2,2836.3",
			style=dashed];
		l1_gate_tp1 -> l1_exp5_gpu1	[pos="e,2915.8,2833.7 2520.2,2912.6 2656.3,2886.9 2845.4,2850.8 2905.8,2836.3",
			style=dashed];
		l1_gate_tp1 -> l1_exp6_gpu1	[pos="e,2559.6,2836.2 2493.5,2873.1 2513.1,2862.2 2532.7,2851.2 2550.5,2841.3",
			style=dashed];
		l1_gate_tp1 -> l1_exp7_gpu1	[pos="e,2413.9,2836.3 2399.5,2872.9 2403.2,2863.6 2406.8,2854.4 2410.2,2845.7",
			style=dashed];
		l1_exp_agg_tp1	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 1",
			pos="2427,2663.2",
			width=6.1053];
		l1_exp0_gpu1 -> l1_exp_agg_tp1	[pos="e,2332.8,2731.4 2281.5,2768 2294.6,2758.6 2309.4,2748.1 2324.4,2737.4"];
		l1_exp1_gpu1 -> l1_exp_agg_tp1	[pos="e,2614.9,2731.2 2723.9,2770.1 2694.1,2759.5 2659.6,2747.1 2624.7,2734.7"];
		l1_exp2_gpu1 -> l1_exp_agg_tp1	[pos="e,2286,2714.5 2130.1,2770.1 2173.4,2754.7 2226.9,2735.6 2276.5,2717.9"];
		l1_exp3_gpu1 -> l1_exp_agg_tp1	[pos="e,2271.8,2693 1938.2,2770.7 1941.2,2769.8 1944.1,2769 1947,2768.2 2050.6,2739.2 2168.7,2713.6 2261.8,2695"];
		l1_exp4_gpu1 -> l1_exp_agg_tp1	[pos="e,2264.2,2681.2 1746.2,2770.5 1749.1,2769.7 1752.1,2768.9 1755,2768.2 1922.3,2726.8 2117.3,2698.8 2254,2682.4"];
		l1_exp5_gpu1 -> l1_exp_agg_tp1	[pos="e,2627.4,2702.1 2915.8,2770.7 2912.8,2769.8 2909.9,2769 2907,2768.2 2819.5,2743.7 2721.7,2721.6 2637.3,2704.1"];
		l1_exp6_gpu1 -> l1_exp_agg_tp1	[pos="e,2521.2,2731.4 2572.5,2768 2559.4,2758.6 2544.6,2748.1 2529.6,2737.4"];
		l1_exp7_gpu1 -> l1_exp_agg_tp1	[pos="e,2427,2731.4 2427,2768 2427,2759.9 2427,2750.8 2427,2741.5"];
		l1_exp_agg_tp1 -> l1_final_res_tp1	[pos="e,2662.9,2558.2 2561.9,2602.7 2591.4,2589.7 2623,2575.8 2653.5,2562.4"];
		l1_attn_tp2	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 2",
			pos="3887,3358.2",
			shape=rectangle,
			width=2.9722];
		l1_qkv_tp2 -> l1_attn_tp2	[pos="e,3885.4,3392.3 3883.6,3429 3884,3420.6 3884.5,3411.3 3884.9,3402.5"];
		l1_out_proj_tp2	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2",
			pos="3889,3253.2",
			shape=rectangle,
			width=2.9444];
		l1_attn_tp2 -> l1_out_proj_tp2	[pos="e,3888.4,3287.3 3887.6,3324 3887.8,3315.6 3888,3306.3 3888.2,3297.5"];
		l1_out_proj_tp2 -> l1_residual_tp2	[pos="e,3921.1,3182.4 3904.3,3219 3908.1,3210.6 3912.4,3201.2 3916.8,3191.6"];
		l1_gate_tp2	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 2",
			pos="3983,2941.2",
			width=5.7597];
		l1_residual_tp2 -> l1_gate_tp2	[pos="e,3970.8,3009.3 3964.2,3046.1 3965.8,3037.3 3967.4,3028.3 3969,3019.3"];
		l1_exp0_gpu2	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2",
			pos="3215,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp2 -> l1_exp0_gpu2	[pos="e,3244.6,2836.4 3611.7,3063.5 3560.1,3049.6 3508.6,3031.8 3462,3009.2 3376.9,2967.8 3296.2,2891 3251.4,2843.7"];
		l1_exp1_gpu2	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2",
			pos="3791,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp2 -> l1_exp1_gpu2	[pos="e,3761.5,2836.5 3773.4,3046 3761,3035.4 3750.2,3023.2 3742,3009.2 3711.4,2957 3723.8,2930.8 3742,2873.2 3745.1,2863.4 3750.1,2853.8 \
3755.7,2845"];
		l1_exp2_gpu2	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2",
			pos="3983,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp2 -> l1_exp2_gpu2	[pos="e,3895.9,2833.2 3798.4,3046.1 3786,3035.4 3775.2,3023.2 3767,3009.2 3736.5,2957 3731.1,2921.8 3767,2873.2 3798.3,2830.7 3830.2,2850.9 \
3886,2836.2"];
		l1_exp3_gpu2	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2",
			pos="3407,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp2 -> l1_exp3_gpu2	[pos="e,3433.8,2836.5 3700.5,3046.1 3674.3,3035.4 3648.6,3023.1 3625,3009.2 3549.9,2964.9 3479.9,2890.5 3440.3,2844.3"];
		l1_exp4_gpu2	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2",
			pos="3599,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp2 -> l1_exp4_gpu2	[pos="e,3612.2,2836.4 3765.3,3046 3748.5,3035.3 3732.6,3023.1 3719,3009.2 3671.8,2960.9 3636.1,2890.6 3616.3,2845.8"];
		l1_exp5_gpu2	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2",
			pos="4175,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp2 -> l1_exp5_gpu2	[pos="e,4191.2,2836.2 4164.4,3046.3 4177.7,3035.7 4189.5,3023.4 4199,3009.2 4231.5,2960.3 4212.8,2890.1 4195,2845.6"];
		l1_exp6_gpu2	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2",
			pos="4559,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp2 -> l1_exp6_gpu2	[pos="e,4522.4,2836.5 4173,3054.1 4209.6,3041.2 4246.5,3026.3 4280,3009.2 4370.1,2963.3 4462,2889 4514.6,2843.3"];
		l1_exp7_gpu2	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 2",
			pos="4367,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp2 -> l1_exp7_gpu2	[pos="e,4351.4,2836.2 4154.3,3046.1 4166.2,3040.5 4177.9,3034.5 4189,3028.2 4263.9,2985.5 4318.9,2897.7 4346.7,2845.2"];
		l1_final_res_tp2	[height=1.8889,
			label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 2",
			pos="4032,2490.2",
			width=9.9643];
		l1_residual_tp2 -> l1_final_res_tp2	[pos="e,4352.7,2522.7 4220.5,3098.3 4422.7,3079.5 4665,3037.2 4665,2942.2 4665,2942.2 4665,2942.2 4665,2662.2 4665,2591.5 4516.1,2549.2 \
4362.8,2524.3"];
		l1_gate_tp2 -> l1_exp0_gpu2	[pos="e,3302.2,2833.9 3805.9,2921.5 3671.9,2905.3 3483.7,2878.1 3311.9,2836.3",
			style=dashed];
		l1_gate_tp2 -> l1_exp1_gpu2	[pos="e,3837.6,2836.4 3889,2873.1 3874.2,2862.5 3859.3,2851.9 3845.8,2842.3",
			style=dashed];
		l1_gate_tp2 -> l1_exp2_gpu2	[pos="e,3983,2836.3 3983,2872.9 3983,2863.9 3983,2855 3983,2846.6",
			style=dashed];
		l1_gate_tp2 -> l1_exp3_gpu2	[pos="e,3494.2,2833.7 3789.8,2896.1 3728,2882.3 3659.2,2867.3 3596,2854.2 3557.7,2846.2 3545.4,2846.9 3504.1,2836.3",
			style=dashed];
		l1_gate_tp2 -> l1_exp4_gpu2	[pos="e,3686.3,2834.3 3794.9,2873.1 3760.6,2860.8 3726.2,2848.5 3695.9,2837.7",
			style=dashed];
		l1_gate_tp2 -> l1_exp5_gpu2	[pos="e,4128.4,2836.4 4077,2873.1 4091.8,2862.5 4106.7,2851.9 4120.2,2842.3",
			style=dashed];
		l1_gate_tp2 -> l1_exp6_gpu2	[pos="e,4471.8,2833.6 4130.4,2912.9 4223.3,2894.6 4345.7,2868.5 4462,2836.4",
			style=dashed];
		l1_gate_tp2 -> l1_exp7_gpu2	[pos="e,4279.8,2834.3 4117.6,2892.2 4167.8,2874.2 4223.9,2854.2 4270.1,2837.7",
			style=dashed];
		l1_exp_agg_tp2	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 2",
			pos="3983,2663.2",
			width=6.1053];
		l1_exp0_gpu2 -> l1_exp_agg_tp2	[pos="e,3820.2,2681.2 3302.2,2770.5 3305.1,2769.7 3308.1,2768.9 3311,2768.2 3478.3,2726.8 3673.3,2698.8 3810,2682.4"];
		l1_exp1_gpu2 -> l1_exp_agg_tp2	[pos="e,3888.8,2731.4 3837.5,2768 3850.6,2758.6 3865.4,2748.1 3880.4,2737.4"];
		l1_exp2_gpu2 -> l1_exp_agg_tp2	[pos="e,3983,2731.4 3983,2768 3983,2759.9 3983,2750.8 3983,2741.5"];
		l1_exp3_gpu2 -> l1_exp_agg_tp2	[pos="e,3827.8,2693 3494.2,2770.7 3497.2,2769.8 3500.1,2769 3503,2768.2 3606.6,2739.2 3724.7,2713.6 3817.8,2695"];
		l1_exp4_gpu2 -> l1_exp_agg_tp2	[pos="e,3842,2714.5 3686.1,2770.1 3729.4,2754.7 3782.9,2735.6 3832.5,2717.9"];
		l1_exp5_gpu2 -> l1_exp_agg_tp2	[pos="e,4077.2,2731.4 4128.5,2768 4115.4,2758.6 4100.6,2748.1 4085.6,2737.4"];
		l1_exp6_gpu2 -> l1_exp_agg_tp2	[pos="e,4183.4,2702.1 4471.8,2770.7 4468.8,2769.8 4465.9,2769 4463,2768.2 4375.5,2743.7 4277.7,2721.6 4193.3,2704.1"];
		l1_exp7_gpu2 -> l1_exp_agg_tp2	[pos="e,4170.9,2731.2 4279.9,2770.1 4250.1,2759.5 4215.6,2747.1 4180.7,2734.7"];
		l1_exp_agg_tp2 -> l1_final_res_tp2	[pos="e,4012.7,2558.3 4002.2,2595.1 4004.8,2586.2 4007.4,2577.1 4010,2568.1"];
		l1_attn_tp3	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 3",
			pos="5558,3358.2",
			shape=rectangle,
			width=2.9722];
		l1_qkv_tp3 -> l1_attn_tp3	[pos="e,5556.4,3392.3 5554.6,3429 5555,3420.6 5555.5,3411.3 5555.9,3402.5"];
		l1_out_proj_tp3	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3",
			pos="5559,3253.2",
			shape=rectangle,
			width=2.9444];
		l1_attn_tp3 -> l1_out_proj_tp3	[pos="e,5558.7,3287.3 5558.3,3324 5558.4,3315.6 5558.5,3306.3 5558.6,3297.5"];
		l1_out_proj_tp3 -> l1_residual_tp3	[pos="e,5606.9,3182.4 5581.8,3219 5587.7,3210.3 5594.4,3200.6 5601.1,3190.7"];
		l1_gate_tp3	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 3",
			pos="5485,2941.2",
			width=5.7597];
		l1_residual_tp3 -> l1_gate_tp3	[pos="e,5551,3009.3 5587.1,3046.1 5577.6,3036.5 5567.9,3026.5 5558.3,3016.8"];
		l1_exp0_gpu3	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3",
			pos="4963,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp3 -> l1_exp0_gpu3	[pos="e,4985.8,2836.5 5319.1,3069.3 5265.6,3054.7 5212.4,3035.2 5165,3009.2 5091.1,2968.5 5027,2892.2 4991.8,2844.8"];
		l1_exp1_gpu3	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3",
			pos="4771,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp3 -> l1_exp1_gpu3	[pos="e,4798.4,2836.2 5350.4,3098.7 5239.4,3084.6 5115.2,3058.2 5010,3009.2 4925.6,2969.8 4847.9,2891.9 4805.2,2844"];
		l1_exp2_gpu3	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3",
			pos="6115,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp3 -> l1_exp2_gpu3	[pos="e,6065.6,2836.3 5753,3046.1 5845.8,2983.8 5980.9,2893.1 6057.1,2842"];
		l1_exp3_gpu3	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3",
			pos="5731,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp3 -> l1_exp3_gpu3	[pos="e,5734.5,2836.4 5707.8,3046 5711,3040.2 5713.8,3034.2 5716,3028.2 5738.1,2968 5738.1,2892.9 5735.2,2846.4"];
		l1_exp4_gpu3	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3",
			pos="5155,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp3 -> l1_exp4_gpu3	[pos="e,5160.7,2836.5 5311,3046.1 5279.7,3035 5254.6,3022.7 5241,3009.2 5195.9,2964.3 5173.3,2892.3 5162.9,2846.4"];
		l1_exp5_gpu3	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3",
			pos="5347,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp3 -> l1_exp5_gpu3	[pos="e,5297.5,2836.2 5327.6,3046.2 5300.5,3035.2 5279.5,3022.9 5269,3009.2 5232.3,2961.2 5244.4,2928.4 5269,2873.2 5273.9,2862.1 5281.5,\
2852.1 5290.1,2843.3"];
		l1_exp6_gpu3	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3",
			pos="5923,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp3 -> l1_exp6_gpu3	[pos="e,5894,2836.4 5711.6,3045.9 5765.1,2984.4 5842.6,2895.5 5887.4,2844.1"];
		l1_exp7_gpu3	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 3",
			pos="5539,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp3 -> l1_exp7_gpu3	[pos="e,5626.1,2836 5689,3046.1 5694,3034.1 5698.3,3021.5 5701,3009.2 5707.5,2979.6 5717.6,2898.4 5701,2873.2 5696.5,2866.4 5667.7,2853.1 \
5635.6,2839.9"];
		l1_final_res_tp3	[height=1.8889,
			label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 3",
			pos="5884,2490.2",
			width=9.9643];
		l1_residual_tp3 -> l1_final_res_tp3	[pos="e,6159.6,2558.3 5905,3082.7 6056.8,3057.1 6221,3013 6221,2942.2 6221,2942.2 6221,2942.2 6221,2662.2 6221,2620 6199.7,2588.2 6167.9,\
2564.3"];
		l1_gate_tp3 -> l1_exp0_gpu3	[pos="e,5050,2833.5 5290.4,2893.5 5198,2871.2 5100.4,2847.4 5059.7,2836.2",
			style=dashed];
		l1_gate_tp3 -> l1_exp1_gpu3	[pos="e,4858.2,2833.8 5305.6,2917.9 5184,2901 5020,2874.4 4868.2,2836.3",
			style=dashed];
		l1_gate_tp3 -> l1_exp2_gpu3	[pos="e,6027.8,2833.7 5634.7,2916.7 5739.9,2898.9 5883.6,2871.9 6017.7,2836.4",
			style=dashed];
		l1_gate_tp3 -> l1_exp3_gpu3	[pos="e,5671.6,2836.2 5605.5,2873.1 5625.1,2862.2 5644.7,2851.2 5662.5,2841.3",
			style=dashed];
		l1_gate_tp3 -> l1_exp4_gpu3	[pos="e,5234.6,2836.2 5323.4,2873.1 5296,2861.7 5268.5,2850.3 5243.9,2840.1",
			style=dashed];
		l1_gate_tp3 -> l1_exp5_gpu3	[pos="e,5380.4,2836.3 5417.2,2872.9 5407.1,2862.8 5397,2852.8 5387.6,2843.5",
			style=dashed];
		l1_gate_tp3 -> l1_exp6_gpu3	[pos="e,5835.9,2833.3 5623.9,2899.2 5683.5,2881.3 5754.1,2859.7 5826.2,2836.4",
			style=dashed];
		l1_gate_tp3 -> l1_exp7_gpu3	[pos="e,5525.9,2836.3 5511.5,2872.9 5515.2,2863.6 5518.8,2854.4 5522.2,2845.7",
			style=dashed];
		l1_exp_agg_tp3	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 3",
			pos="5539,2663.2",
			width=6.1053];
		l1_exp0_gpu3 -> l1_exp_agg_tp3	[pos="e,5383.8,2693 5050.2,2770.7 5053.2,2769.8 5056.1,2769 5059,2768.2 5162.6,2739.2 5280.7,2713.6 5373.8,2695"];
		l1_exp1_gpu3 -> l1_exp_agg_tp3	[pos="e,5376.2,2681.2 4858.2,2770.5 4861.1,2769.7 4864.1,2768.9 4867,2768.2 5034.3,2726.8 5229.3,2698.8 5366,2682.4"];
		l1_exp2_gpu3 -> l1_exp_agg_tp3	[pos="e,5739.4,2702.1 6027.8,2770.7 6024.8,2769.8 6021.9,2769 6019,2768.2 5931.5,2743.7 5833.7,2721.6 5749.3,2704.1"];
		l1_exp3_gpu3 -> l1_exp_agg_tp3	[pos="e,5633.2,2731.4 5684.5,2768 5671.4,2758.6 5656.6,2748.1 5641.6,2737.4"];
		l1_exp4_gpu3 -> l1_exp_agg_tp3	[pos="e,5398,2714.5 5242.1,2770.1 5285.4,2754.7 5338.9,2735.6 5388.5,2717.9"];
		l1_exp5_gpu3 -> l1_exp_agg_tp3	[pos="e,5444.8,2731.4 5393.5,2768 5406.6,2758.6 5421.4,2748.1 5436.4,2737.4"];
		l1_exp6_gpu3 -> l1_exp_agg_tp3	[pos="e,5726.9,2731.2 5835.9,2770.1 5806.1,2759.5 5771.6,2747.1 5736.7,2734.7"];
		l1_exp7_gpu3 -> l1_exp_agg_tp3	[pos="e,5539,2731.4 5539,2768 5539,2759.9 5539,2750.8 5539,2741.5"];
		l1_exp_agg_tp3 -> l1_final_res_tp3	[pos="e,5748.7,2558.2 5670.4,2597 5693,2585.8 5716.6,2574.1 5739.6,2562.8"];
		l1_attn_tp4	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 4",
			pos="7001,3358.2",
			shape=rectangle,
			width=2.9722];
		l1_qkv_tp4 -> l1_attn_tp4	[pos="e,6999.4,3392.3 6997.6,3429 6998,3420.6 6998.5,3411.3 6998.9,3402.5"];
		l1_out_proj_tp4	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4",
			pos="7003,3253.2",
			shape=rectangle,
			width=2.9444];
		l1_attn_tp4 -> l1_out_proj_tp4	[pos="e,7002.4,3287.3 7001.6,3324 7001.8,3315.6 7002,3306.3 7002.2,3297.5"];
		l1_out_proj_tp4 -> l1_residual_tp4	[pos="e,7049.9,3182.4 7025.3,3219 7031.1,3210.3 7037.6,3200.6 7044.2,3190.7"];
		l1_gate_tp4	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 4",
			pos="7095,2941.2",
			width=5.7597];
		l1_residual_tp4 -> l1_gate_tp4	[pos="e,7095,3009.3 7095,3046.1 7095,3037.4 7095,3028.5 7095,3019.6"];
		l1_exp0_gpu4	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4",
			pos="6903,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp4 -> l1_exp0_gpu4	[pos="e,6878.7,2836.4 6890,3045.8 6878.7,3035.3 6869.1,3023.2 6862,3009.2 6834.6,2955.3 6846.2,2931.5 6862,2873.2 6864.6,2863.7 6868.8,\
2854.2 6873.6,2845.3"];
		l1_exp1_gpu4	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4",
			pos="6327,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp4 -> l1_exp1_gpu4	[pos="e,6356.5,2836.6 6764.9,3073.1 6699.7,3058.1 6633.2,3037.5 6574,3009.2 6488.6,2968.3 6408.1,2891.3 6363.3,2843.9"];
		l1_exp2_gpu4	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4",
			pos="7095,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp4 -> l1_exp2_gpu4	[pos="e,7007.9,2833.2 6912.1,3046.1 6899.2,3035.5 6887.9,3023.3 6879,3009.2 6862.9,2983.6 6861.1,2897.5 6879,2873.2 6910.3,2830.7 6942.2,\
2850.9 6998,2836.2"];
		l1_exp3_gpu4	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4",
			pos="7479,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp4 -> l1_exp3_gpu4	[pos="e,7462.7,2836.4 7270.1,3046.1 7281.1,3040.4 7291.8,3034.4 7302,3028.2 7374.9,2983.4 7429.8,2897.1 7457.9,2845.3"];
		l1_exp4_gpu4	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4",
			pos="7287,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp4 -> l1_exp4_gpu4	[pos="e,7302.9,2836.3 7277.9,3046.1 7290.8,3035.5 7302.1,3023.3 7311,3009.2 7342.1,2959.6 7324.1,2889.9 7306.7,2845.6"];
		l1_exp5_gpu4	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4",
			pos="6519,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp4 -> l1_exp5_gpu4	[pos="e,6545.9,2836.4 6819.7,3046.2 6792.3,3035.4 6765.6,3023.2 6741,3009.2 6664.3,2965.6 6592.8,2890.6 6552.6,2844.2"];
		l1_exp6_gpu4	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4",
			pos="6711,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp4 -> l1_exp6_gpu4	[pos="e,6726.5,2836.4 6887.2,3046 6870.3,3035.4 6854.6,3023.2 6841,3009.2 6793.1,2959.6 6753.5,2889.7 6731.1,2845.4"];
		l1_exp7_gpu4	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 4",
			pos="7671,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp4 -> l1_exp7_gpu4	[pos="e,7633.4,2836.4 7307.7,3046.7 7335.9,3035.4 7364.1,3022.9 7390,3009.2 7479.5,2961.9 7572.1,2888.4 7625.5,2843.1"];
		l1_final_res_tp4	[height=1.8889,
			label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 4",
			pos="7173,2490.2",
			width=9.9643];
		l1_residual_tp4 -> l1_final_res_tp4	[pos="e,7500.2,2528.7 7360.6,3095.4 7552.1,3075 7777,3031.9 7777,2942.2 7777,2942.2 7777,2942.2 7777,2662.2 7777,2597.8 7648.6,2556.5 \
7510.2,2530.6"];
		l1_gate_tp4 -> l1_exp0_gpu4	[pos="e,6949.6,2836.4 7001,2873.1 6986.2,2862.5 6971.3,2851.9 6957.8,2842.3",
			style=dashed];
		l1_gate_tp4 -> l1_exp1_gpu4	[pos="e,6414.2,2833.9 6917.9,2921.5 6783.9,2905.3 6595.7,2878.1 6423.9,2836.3",
			style=dashed];
		l1_gate_tp4 -> l1_exp2_gpu4	[pos="e,7095,2836.3 7095,2872.9 7095,2863.9 7095,2855 7095,2846.6",
			style=dashed];
		l1_gate_tp4 -> l1_exp3_gpu4	[pos="e,7391.8,2834.3 7229.6,2892.2 7279.8,2874.2 7335.9,2854.2 7382.1,2837.7",
			style=dashed];
		l1_gate_tp4 -> l1_exp4_gpu4	[pos="e,7240.4,2836.4 7189,2873.1 7203.8,2862.5 7218.7,2851.9 7232.2,2842.3",
			style=dashed];
		l1_gate_tp4 -> l1_exp5_gpu4	[pos="e,6606.2,2833.7 6901.8,2896.1 6840,2882.3 6771.2,2867.3 6708,2854.2 6669.7,2846.2 6657.4,2846.9 6616.1,2836.3",
			style=dashed];
		l1_gate_tp4 -> l1_exp6_gpu4	[pos="e,6798.3,2834.3 6906.9,2873.1 6872.6,2860.8 6838.2,2848.5 6807.9,2837.7",
			style=dashed];
		l1_gate_tp4 -> l1_exp7_gpu4	[pos="e,7583.8,2833.6 7242.4,2912.9 7335.3,2894.6 7457.7,2868.5 7574,2836.4",
			style=dashed];
		l1_exp_agg_tp4	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 4",
			pos="7095,2663.2",
			width=6.1053];
		l1_exp0_gpu4 -> l1_exp_agg_tp4	[pos="e,7000.8,2731.4 6949.5,2768 6962.6,2758.6 6977.4,2748.1 6992.4,2737.4"];
		l1_exp1_gpu4 -> l1_exp_agg_tp4	[pos="e,6932.2,2681.2 6414.2,2770.5 6417.1,2769.7 6420.1,2768.9 6423,2768.2 6590.3,2726.8 6785.3,2698.8 6922,2682.4"];
		l1_exp2_gpu4 -> l1_exp_agg_tp4	[pos="e,7095,2731.4 7095,2768 7095,2759.9 7095,2750.8 7095,2741.5"];
		l1_exp3_gpu4 -> l1_exp_agg_tp4	[pos="e,7282.9,2731.2 7391.9,2770.1 7362.1,2759.5 7327.6,2747.1 7292.7,2734.7"];
		l1_exp4_gpu4 -> l1_exp_agg_tp4	[pos="e,7189.2,2731.4 7240.5,2768 7227.4,2758.6 7212.6,2748.1 7197.6,2737.4"];
		l1_exp5_gpu4 -> l1_exp_agg_tp4	[pos="e,6939.8,2693 6606.2,2770.7 6609.2,2769.8 6612.1,2769 6615,2768.2 6718.6,2739.2 6836.7,2713.6 6929.8,2695"];
		l1_exp6_gpu4 -> l1_exp_agg_tp4	[pos="e,6954,2714.5 6798.1,2770.1 6841.4,2754.7 6894.9,2735.6 6944.5,2717.9"];
		l1_exp7_gpu4 -> l1_exp_agg_tp4	[pos="e,7295.4,2702.1 7583.8,2770.7 7580.8,2769.8 7577.9,2769 7575,2768.2 7487.5,2743.7 7389.7,2721.6 7305.3,2704.1"];
		l1_exp_agg_tp4 -> l1_final_res_tp4	[pos="e,7142.4,2558.3 7125.6,2595.1 7129.7,2586 7134,2576.7 7138.2,2567.5"];
		l1_attn_tp5	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 5",
			pos="8681,3358.2",
			shape=rectangle,
			width=2.9722];
		l1_qkv_tp5 -> l1_attn_tp5	[pos="e,8680,3392.3 8679,3429 8679.2,3420.6 8679.5,3411.3 8679.7,3402.5"];
		l1_out_proj_tp5	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5",
			pos="8684,3253.2",
			shape=rectangle,
			width=2.9444];
		l1_attn_tp5 -> l1_out_proj_tp5	[pos="e,8683,3287.3 8682,3324 8682.2,3315.6 8682.5,3306.3 8682.7,3297.5"];
		l1_out_proj_tp5 -> l1_residual_tp5	[pos="e,8719.6,3182.4 8700.9,3219 8705.3,3210.5 8710.1,3201 8715.1,3191.3"];
		l1_gate_tp5	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 5",
			pos="8597,2941.2",
			width=5.7597];
		l1_residual_tp5 -> l1_gate_tp5	[pos="e,8658.7,3009.3 8692.4,3046.1 8683.6,3036.5 8674.4,3026.5 8665.5,3016.8"];
		l1_exp0_gpu5	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5",
			pos="8267,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp5 -> l1_exp0_gpu5	[pos="e,8272.8,2836.4 8422.4,3046 8391.3,3034.9 8366.4,3022.6 8353,3009.2 8308.1,2964.1 8285.4,2892.2 8274.9,2846.3"];
		l1_exp1_gpu5	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5",
			pos="8075,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp5 -> l1_exp1_gpu5	[pos="e,8097.8,2836.5 8415.3,3065.1 8367.2,3051 8319.7,3032.7 8277,3009.2 8203.2,2968.4 8139.1,2892.1 8103.8,2844.7"];
		l1_exp2_gpu5	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5",
			pos="8459,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp5 -> l1_exp2_gpu5	[pos="e,8409.5,2836.2 8439.1,3046 8412.2,3035 8391.3,3022.8 8381,3009.2 8344.4,2961 8356.4,2928.4 8381,2873.2 8385.9,2862.1 8393.5,2852.1 \
8402.1,2843.3"];
		l1_exp3_gpu5	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5",
			pos="9035,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp5 -> l1_exp3_gpu5	[pos="e,9005.4,2836.5 8816.6,3046 8822.2,3040 8827.7,3034 8833,3028.2 8891.4,2964.2 8958.4,2889.3 8998.7,2844"];
		l1_exp4_gpu5	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5",
			pos="8843,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp5 -> l1_exp4_gpu5	[pos="e,8847.2,2836.3 8818.7,3046.1 8822.3,3040.3 8825.5,3034.3 8828,3028.2 8852.5,2968.8 8851.8,2893.1 8848.1,2846.4"];
		l1_exp5_gpu5	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5",
			pos="8651,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp5 -> l1_exp5_gpu5	[pos="e,8738.1,2836 8798.6,3046 8804.6,3034.1 8809.7,3021.6 8813,3009.2 8820.7,2979.9 8829.6,2898.4 8813,2873.2 8808.5,2866.4 8779.7,2853.1 \
8747.6,2839.9"];
		l1_exp6_gpu5	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5",
			pos="7883,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp5 -> l1_exp6_gpu5	[pos="e,7910.4,2836.2 8449.8,3097 8342.4,3082.7 8223.2,3056.5 8122,3009.2 8037.6,2969.7 7959.9,2891.8 7917.2,2843.9"];
		l1_exp7_gpu5	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 5",
			pos="9227,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp5 -> l1_exp7_gpu5	[pos="e,9177.6,2836.2 8859.1,3046 8878.1,3033.8 8897.7,3021.1 8916,3009.2 9004.6,2951.4 9106.7,2883.5 9169.1,2841.9"];
		l1_final_res_tp5	[height=1.8889,
			label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 5",
			pos="9012,2490.2",
			width=9.9643];
		l1_residual_tp5 -> l1_final_res_tp5	[pos="e,9270.3,2558.2 9007.1,3084.2 9162.9,3059 9333,3014.9 9333,2942.2 9333,2942.2 9333,2942.2 9333,2662.2 9333,2620 9311.1,2588.1 9278.8,\
2564.2"];
		l1_gate_tp5 -> l1_exp0_gpu5	[pos="e,8346.6,2836.2 8435.4,2873.1 8408,2861.7 8380.5,2850.3 8355.9,2840.1",
			style=dashed];
		l1_gate_tp5 -> l1_exp1_gpu5	[pos="e,8162.2,2833.6 8400.2,2890.2 8351.8,2878.1 8300.1,2865.5 8252,2854.2 8218.9,2846.4 8208.2,2846.2 8172,2836.3",
			style=dashed];
		l1_gate_tp5 -> l1_exp2_gpu5	[pos="e,8492.4,2836.3 8529.2,2872.9 8519.1,2862.8 8509,2852.8 8499.6,2843.5",
			style=dashed];
		l1_gate_tp5 -> l1_exp3_gpu5	[pos="e,8947.8,2833.7 8730.5,2890.7 8768.2,2877.8 8809.4,2864.5 8848,2854.2 8885,2844.2 8897.5,2846.5 8938.1,2836.3",
			style=dashed];
		l1_gate_tp5 -> l1_exp4_gpu5	[pos="e,8783.6,2836.2 8717.5,2873.1 8737.1,2862.2 8756.7,2851.2 8774.5,2841.3",
			style=dashed];
		l1_gate_tp5 -> l1_exp5_gpu5	[pos="e,8637.9,2836.3 8623.5,2872.9 8627.2,2863.6 8630.8,2854.4 8634.2,2845.7",
			style=dashed];
		l1_gate_tp5 -> l1_exp6_gpu5	[pos="e,7970.2,2833.8 8417.6,2917.9 8296,2901 8132,2874.4 7980.2,2836.3",
			style=dashed];
		l1_gate_tp5 -> l1_exp7_gpu5	[pos="e,9139.8,2833.7 8746.7,2916.7 8851.9,2898.9 8995.6,2871.9 9129.7,2836.4",
			style=dashed];
		l1_exp_agg_tp5	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 5",
			pos="8651,2663.2",
			width=6.1053];
		l1_exp0_gpu5 -> l1_exp_agg_tp5	[pos="e,8510,2714.5 8354.1,2770.1 8397.4,2754.7 8450.9,2735.6 8500.5,2717.9"];
		l1_exp1_gpu5 -> l1_exp_agg_tp5	[pos="e,8495.8,2693 8162.2,2770.7 8165.2,2769.8 8168.1,2769 8171,2768.2 8274.6,2739.2 8392.7,2713.6 8485.8,2695"];
		l1_exp2_gpu5 -> l1_exp_agg_tp5	[pos="e,8556.8,2731.4 8505.5,2768 8518.6,2758.6 8533.4,2748.1 8548.4,2737.4"];
		l1_exp3_gpu5 -> l1_exp_agg_tp5	[pos="e,8838.9,2731.2 8947.9,2770.1 8918.1,2759.5 8883.6,2747.1 8848.7,2734.7"];
		l1_exp4_gpu5 -> l1_exp_agg_tp5	[pos="e,8745.2,2731.4 8796.5,2768 8783.4,2758.6 8768.6,2748.1 8753.6,2737.4"];
		l1_exp5_gpu5 -> l1_exp_agg_tp5	[pos="e,8651,2731.4 8651,2768 8651,2759.9 8651,2750.8 8651,2741.5"];
		l1_exp6_gpu5 -> l1_exp_agg_tp5	[pos="e,8488.2,2681.2 7970.2,2770.5 7973.1,2769.7 7976.1,2768.9 7979,2768.2 8146.3,2726.8 8341.3,2698.8 8478,2682.4"];
		l1_exp7_gpu5 -> l1_exp_agg_tp5	[pos="e,8851.4,2702.1 9139.8,2770.7 9136.8,2769.8 9133.9,2769 9131,2768.2 9043.5,2743.7 8945.7,2721.6 8861.3,2704.1"];
		l1_exp_agg_tp5 -> l1_final_res_tp5	[pos="e,8870.4,2558.2 8783.6,2599.3 8808.9,2587.4 8835.5,2574.8 8861.3,2562.5"];
		l1_attn_tp6	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 6",
			pos="10112,3358.2",
			shape=rectangle,
			width=2.9722];
		l1_qkv_tp6 -> l1_attn_tp6	[pos="e,10111,3392.3 10109,3429 10110,3420.6 10110,3411.3 10110,3402.5"];
		l1_out_proj_tp6	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6",
			pos="10114,3253.2",
			shape=rectangle,
			width=2.9444];
		l1_attn_tp6 -> l1_out_proj_tp6	[pos="e,10113,3287.3 10113,3324 10113,3315.6 10113,3306.3 10113,3297.5"];
		l1_out_proj_tp6 -> l1_residual_tp6	[pos="e,10161,3182.4 10137,3219 10142,3210.3 10149,3200.6 10156,3190.7"];
		l1_gate_tp6	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 6",
			pos="10207,2941.2",
			width=5.7597];
		l1_residual_tp6 -> l1_gate_tp6	[pos="e,10207,3009.3 10207,3046.1 10207,3037.4 10207,3028.5 10207,3019.6"];
		l1_exp0_gpu6	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6",
			pos="9631,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp6 -> l1_exp0_gpu6	[pos="e,9657.9,2836.4 9931.7,3046.2 9904.3,3035.4 9877.6,3023.2 9853,3009.2 9776.3,2965.6 9704.8,2890.6 9664.6,2844.2"];
		l1_exp1_gpu6	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6",
			pos="9823,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp6 -> l1_exp1_gpu6	[pos="e,9838.5,2836.4 9999.2,3046 9982.3,3035.4 9966.6,3023.2 9953,3009.2 9905.1,2959.6 9865.5,2889.7 9843.1,2845.4"];
		l1_exp2_gpu6	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6",
			pos="9439,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp6 -> l1_exp2_gpu6	[pos="e,9468.5,2836.6 9876.9,3073.1 9811.7,3058.1 9745.2,3037.5 9686,3009.2 9600.6,2968.3 9520.1,2891.3 9475.3,2843.9"];
		l1_exp3_gpu6	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6",
			pos="10015,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp6 -> l1_exp3_gpu6	[pos="e,9990.7,2836.4 10002,3045.8 9990.7,3035.3 9981.1,3023.2 9974,3009.2 9946.6,2955.3 9958.2,2931.5 9974,2873.2 9976.6,2863.7 9980.8,\
2854.2 9985.6,2845.3"];
		l1_exp4_gpu6	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6",
			pos="10783,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp6 -> l1_exp4_gpu6	[pos="e,10745,2836.4 10420,3046.7 10448,3035.4 10476,3022.9 10502,3009.2 10592,2961.9 10684,2888.4 10738,2843.1"];
		l1_exp5_gpu6	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6",
			pos="10207,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp6 -> l1_exp5_gpu6	[pos="e,10120,2833.2 10024,3046.1 10011,3035.5 9999.9,3023.3 9991,3009.2 9974.9,2983.6 9973.1,2897.5 9991,2873.2 10022,2830.7 10054,2850.9 \
10110,2836.2"];
		l1_exp6_gpu6	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6",
			pos="10591,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp6 -> l1_exp6_gpu6	[pos="e,10575,2836.4 10382,3046.1 10393,3040.4 10404,3034.4 10414,3028.2 10487,2983.4 10542,2897.1 10570,2845.3"];
		l1_exp7_gpu6	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 6",
			pos="10399,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp6 -> l1_exp7_gpu6	[pos="e,10415,2836.3 10390,3046.1 10403,3035.5 10414,3023.3 10423,3009.2 10454,2959.6 10436,2889.9 10419,2845.6"];
		l1_final_res_tp6	[height=1.8889,
			label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 6",
			pos="10284,2490.2",
			width=9.9643];
		l1_residual_tp6 -> l1_final_res_tp6	[pos="e,10611,2528.6 10473,3095.4 10664,3075 10889,3031.9 10889,2942.2 10889,2942.2 10889,2942.2 10889,2662.2 10889,2597.7 10760,2556.3 \
10621,2530.4"];
		l1_gate_tp6 -> l1_exp0_gpu6	[pos="e,9718.2,2833.6 10016,2899.3 9900.4,2874.5 9769,2846.2 9728,2836.1",
			style=dashed];
		l1_gate_tp6 -> l1_exp1_gpu6	[pos="e,9910.3,2834.3 10019,2873.1 9984.6,2860.8 9950.2,2848.5 9919.9,2837.7",
			style=dashed];
		l1_gate_tp6 -> l1_exp2_gpu6	[pos="e,9526.2,2833.9 10030,2921.5 9895.9,2905.3 9707.7,2878.1 9535.9,2836.3",
			style=dashed];
		l1_gate_tp6 -> l1_exp3_gpu6	[pos="e,10062,2836.4 10113,2873.1 10098,2862.5 10083,2851.9 10070,2842.3",
			style=dashed];
		l1_gate_tp6 -> l1_exp4_gpu6	[pos="e,10696,2833.6 10354,2912.9 10447,2894.6 10570,2868.5 10686,2836.4",
			style=dashed];
		l1_gate_tp6 -> l1_exp5_gpu6	[pos="e,10207,2836.3 10207,2872.9 10207,2863.9 10207,2855 10207,2846.6",
			style=dashed];
		l1_gate_tp6 -> l1_exp6_gpu6	[pos="e,10504,2834.3 10342,2892.2 10392,2874.2 10448,2854.2 10494,2837.7",
			style=dashed];
		l1_gate_tp6 -> l1_exp7_gpu6	[pos="e,10352,2836.4 10301,2873.1 10316,2862.5 10331,2851.9 10344,2842.3",
			style=dashed];
		l1_exp_agg_tp6	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 6",
			pos="10207,2663.2",
			width=6.1053];
		l1_exp0_gpu6 -> l1_exp_agg_tp6	[pos="e,10052,2693 9718.2,2770.7 9721.2,2769.8 9724.1,2769 9727,2768.2 9830.6,2739.2 9948.7,2713.6 10042,2695"];
		l1_exp1_gpu6 -> l1_exp_agg_tp6	[pos="e,10066,2714.5 9910.1,2770.1 9953.4,2754.7 10007,2735.6 10056,2717.9"];
		l1_exp2_gpu6 -> l1_exp_agg_tp6	[pos="e,10044,2681.2 9526.2,2770.5 9529.1,2769.7 9532.1,2768.9 9535,2768.2 9702.3,2726.8 9897.3,2698.8 10034,2682.4"];
		l1_exp3_gpu6 -> l1_exp_agg_tp6	[pos="e,10113,2731.4 10061,2768 10075,2758.6 10089,2748.1 10104,2737.4"];
		l1_exp4_gpu6 -> l1_exp_agg_tp6	[pos="e,10407,2702.1 10696,2770.7 10693,2769.8 10690,2769 10687,2768.2 10600,2743.7 10502,2721.6 10417,2704.1"];
		l1_exp5_gpu6 -> l1_exp_agg_tp6	[pos="e,10207,2731.4 10207,2768 10207,2759.9 10207,2750.8 10207,2741.5"];
		l1_exp6_gpu6 -> l1_exp_agg_tp6	[pos="e,10395,2731.2 10504,2770.1 10474,2759.5 10440,2747.1 10405,2734.7"];
		l1_exp7_gpu6 -> l1_exp_agg_tp6	[pos="e,10301,2731.4 10353,2768 10339,2758.6 10325,2748.1 10310,2737.4"];
		l1_exp_agg_tp6 -> l1_final_res_tp6	[pos="e,10254,2558.3 10237,2595.1 10241,2586 10245,2576.7 10250,2567.5"];
		l1_attn_tp7	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 7",
			pos="11785,3358.2",
			shape=rectangle,
			width=2.9722];
		l1_qkv_tp7 -> l1_attn_tp7	[pos="e,11783,3392.3 11782,3429 11782,3420.6 11782,3411.3 11783,3402.5"];
		l1_out_proj_tp7	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7",
			pos="11786,3253.2",
			shape=rectangle,
			width=2.9444];
		l1_attn_tp7 -> l1_out_proj_tp7	[pos="e,11786,3287.3 11785,3324 11785,3315.6 11785,3306.3 11786,3297.5"];
		l1_out_proj_tp7 -> l1_residual_tp7	[pos="e,11843,3182.4 11813,3219 11820,3210.3 11828,3200.4 11836,3190.4"];
		l1_gate_tp7	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 7",
			pos="11709,2941.2",
			width=5.7597];
		l1_residual_tp7 -> l1_gate_tp7	[pos="e,11783,3009.3 11823,3046.1 11812,3036.3 11801,3026.1 11790,3016.2"];
		l1_exp0_gpu7	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7",
			pos="11379,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp7 -> l1_exp0_gpu7	[pos="e,11385,2836.4 11540,3047.9 11506,3036.5 11479,3023.6 11465,3009.2 11420,2964.1 11397,2892.2 11387,2846.3"];
		l1_exp1_gpu7	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7",
			pos="11187,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp7 -> l1_exp1_gpu7	[pos="e,11209,2836.2 11570,3076 11508,3060.8 11444,3039.4 11389,3009.2 11315,2968.7 11251,2892 11215,2844.5"];
		l1_exp2_gpu7	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7",
			pos="10995,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp7 -> l1_exp2_gpu7	[pos="e,11022,2836.3 11574,3079.3 11437,3061.5 11295,3037.5 11234,3009.2 11149,2970 11072,2892 11029,2844"];
		l1_exp3_gpu7	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7",
			pos="11571,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp7 -> l1_exp3_gpu7	[pos="e,11522,2836.2 11552,3046.1 11525,3035.3 11504,3023 11493,3009.2 11456,2961.4 11468,2928.4 11493,2873.2 11498,2862.1 11506,2852.1 \
11514,2843.3"];
		l1_exp4_gpu7	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7",
			pos="12147,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp7 -> l1_exp4_gpu7	[pos="e,12120,2836.4 11951,3045.9 12001,2984.5 12072,2895.8 12114,2844.4"];
		l1_exp5_gpu7	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7",
			pos="12339,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp7 -> l1_exp5_gpu7	[pos="e,12292,2836.3 11993,3046.1 12081,2983.9 12210,2893.5 12283,2842.3"];
		l1_exp6_gpu7	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7",
			pos="11955,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp7 -> l1_exp6_gpu7	[pos="e,11957,2836.3 11934,3045.9 11936,3040 11938,3034.1 11940,3028.2 11957,2966.7 11958,2892.4 11957,2846.5"];
		l1_exp7_gpu7	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 7",
			pos="11763,2802.2",
			shape=rectangle,
			width=2.4167];
		l1_residual_tp7 -> l1_exp7_gpu7	[pos="e,11850,2836 11918,3046 11921,3033.9 11923,3021.2 11925,3009.2 11929,2979.2 11942,2898.4 11925,2873.2 11921,2866.4 11892,2853.1 \
11860,2839.9"];
		l1_final_res_tp7	[height=1.8889,
			label="Layer 1 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 7",
			pos="12030,2490.2",
			width=9.9643];
		l1_residual_tp7 -> l1_final_res_tp7	[pos="e,12297,2558.2 12146,3080.2 12291,3053.8 12445,3009.8 12445,2942.2 12445,2942.2 12445,2942.2 12445,2662.2 12445,2623.6 12383,2589.3 \
12307,2561.7"];
		l1_gate_tp7 -> l1_exp0_gpu7	[pos="e,11459,2836.2 11547,2873.1 11520,2861.7 11493,2850.3 11468,2840.1",
			style=dashed];
		l1_gate_tp7 -> l1_exp1_gpu7	[pos="e,11274,2833.5 11517,2897.2 11446,2880.4 11365,2860.1 11284,2836.4",
			style=dashed];
		l1_gate_tp7 -> l1_exp2_gpu7	[pos="e,11082,2833.8 11530,2917.9 11408,2901 11244,2874.4 11092,2836.3",
			style=dashed];
		l1_gate_tp7 -> l1_exp3_gpu7	[pos="e,11604,2836.3 11641,2872.9 11631,2862.8 11621,2852.8 11612,2843.5",
			style=dashed];
		l1_gate_tp7 -> l1_exp4_gpu7	[pos="e,12060,2833.3 11848,2899.2 11907,2881.3 11978,2859.7 12050,2836.4",
			style=dashed];
		l1_gate_tp7 -> l1_exp5_gpu7	[pos="e,12252,2833.7 11859,2916.7 11964,2898.9 12108,2871.9 12242,2836.4",
			style=dashed];
		l1_gate_tp7 -> l1_exp6_gpu7	[pos="e,11896,2836.2 11829,2873.1 11849,2862.2 11869,2851.2 11887,2841.3",
			style=dashed];
		l1_gate_tp7 -> l1_exp7_gpu7	[pos="e,11750,2836.3 11736,2872.9 11739,2863.6 11743,2854.4 11746,2845.7",
			style=dashed];
		l1_exp_agg_tp7	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 7",
			pos="11763,2663.2",
			width=6.1053];
		l1_exp0_gpu7 -> l1_exp_agg_tp7	[pos="e,11622,2714.5 11466,2770.1 11509,2754.7 11563,2735.6 11612,2717.9"];
		l1_exp1_gpu7 -> l1_exp_agg_tp7	[pos="e,11608,2693 11274,2770.7 11277,2769.8 11280,2769 11283,2768.2 11387,2739.2 11505,2713.6 11598,2695"];
		l1_exp2_gpu7 -> l1_exp_agg_tp7	[pos="e,11600,2681.2 11082,2770.5 11085,2769.7 11088,2768.9 11091,2768.2 11258,2726.8 11453,2698.8 11590,2682.4"];
		l1_exp3_gpu7 -> l1_exp_agg_tp7	[pos="e,11669,2731.4 11617,2768 11631,2758.6 11645,2748.1 11660,2737.4"];
		l1_exp4_gpu7 -> l1_exp_agg_tp7	[pos="e,11951,2731.2 12060,2770.1 12030,2759.5 11996,2747.1 11961,2734.7"];
		l1_exp5_gpu7 -> l1_exp_agg_tp7	[pos="e,11963,2702.1 12252,2770.7 12249,2769.8 12246,2769 12243,2768.2 12156,2743.7 12058,2721.6 11973,2704.1"];
		l1_exp6_gpu7 -> l1_exp_agg_tp7	[pos="e,11857,2731.4 11909,2768 11895,2758.6 11881,2748.1 11866,2737.4"];
		l1_exp7_gpu7 -> l1_exp_agg_tp7	[pos="e,11763,2731.4 11763,2768 11763,2759.9 11763,2750.8 11763,2741.5"];
		l1_exp_agg_tp7 -> l1_final_res_tp7	[pos="e,11925,2558.3 11868,2595.1 11884,2584.8 11900,2574.1 11917,2563.8"];
	}
	subgraph cluster_stage1 {
		graph [bb="253,125.17,12699,2366.2",
			label="Pipeline Stage 1 (Layers 2-3)\nGPUs 8-15",
			lheight=0.42,
			lp="6476,2347.2",
			lwidth=2.89,
			style=dashed
		];
		subgraph cluster_layer2 {
			graph [label="Layer 2",
				style=dotted
			];
		}
		subgraph cluster_layer3 {
			graph [label="Layer 3",
				style=dotted
			];
		}
		l2_qkv_tp0	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 8",
			pos="948,2286.2",
			shape=rectangle,
			width=3.1389];
		l2_attn_tp0	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 8",
			pos="855,2181.2",
			shape=rectangle,
			width=2.9722];
		l2_qkv_tp0 -> l2_attn_tp0	[pos="e,884.88,2215.3 918.06,2252 909.68,2242.7 900.48,2232.5 891.75,2222.9"];
		l2_residual_tp0	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8",
			pos="947,1937.2",
			width=9.9643];
		l2_qkv_tp0 -> l2_residual_tp0	[pos="e,963.97,2005.2 961.33,2251.9 965.26,2240.4 969.04,2227.4 971,2215.2 973.42,2200.1 972.11,2060.7 970,2042.2 969,2033.4 967.58,2024.3 \
965.93,2015.3"];
		l2_out_proj_tp0	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8",
			pos="855,2076.2",
			shape=rectangle,
			width=2.9444];
		l2_attn_tp0 -> l2_out_proj_tp0	[pos="e,855,2110.3 855,2147 855,2138.6 855,2129.3 855,2120.5"];
		l2_out_proj_tp0 -> l2_residual_tp0	[pos="e,901.85,2005.4 877.27,2042 883.09,2033.3 889.6,2023.6 896.25,2013.7"];
		l2_gate_tp0	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 8",
			pos="1116,1764.2",
			width=5.7597];
		l2_residual_tp0 -> l2_gate_tp0	[pos="e,1049.6,1832.3 1013.3,1869.1 1022.9,1859.4 1032.8,1849.3 1042.6,1839.5"];
		l2_exp0_gpu8	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8",
			pos="1116,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp0 -> l2_exp0_gpu8	[pos="e,1028.9,1656.2 908.03,1868.9 883.65,1817.1 863.19,1746 900,1696.2 931.33,1653.7 963.24,1673.9 1019,1659.2"];
		l2_exp1_gpu8	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8",
			pos="924,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp0 -> l2_exp1_gpu8	[pos="e,894.01,1659.2 892.59,1869.1 889.58,1863.2 886.98,1857.2 885,1851.2 861.03,1777.6 860.2,1750.4 885,1677.2 886.05,1674.1 887.38,\
1671 888.91,1668"];
		l2_exp2_gpu8	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8",
			pos="348,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp0 -> l2_exp2_gpu8	[pos="e,381.06,1659.4 690.31,1869.1 661.56,1858.2 633.22,1846 607,1832.2 521.58,1787.2 436.72,1712.5 388.48,1666.5"];
		l2_exp3_gpu8	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8",
			pos="540,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp0 -> l2_exp3_gpu8	[pos="e,572.67,1659.5 824.25,1868.9 805.34,1857.3 786.34,1844.8 769,1832.2 698.17,1780.4 624.1,1710.4 580.02,1666.8"];
		l2_exp4_gpu8	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8",
			pos="732,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp0 -> l2_exp4_gpu8	[pos="e,751.29,1659.4 890.22,1869.1 880.55,1857 870.79,1844.4 862,1832.2 822.43,1777.2 781.51,1710.4 756.4,1668.1"];
		l2_exp5_gpu8	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8",
			pos="1500,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp0 -> l2_exp5_gpu8	[pos="e,1481,1659.3 1201.4,1908.2 1253.9,1892.5 1305.5,1868.5 1346,1832.2 1400.5,1783.2 1448.4,1712.4 1475.8,1667.8"];
		l2_exp6_gpu8	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8",
			pos="1692,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp0 -> l2_exp6_gpu8	[pos="e,1656.1,1659.2 1192.6,1900.2 1263.5,1884.7 1339.6,1862.8 1406,1832.2 1500.3,1788.7 1595.2,1712.4 1648.5,1665.8"];
		l2_exp7_gpu8	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8",
			pos="1308,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp0 -> l2_exp7_gpu8	[pos="e,1324.9,1659.2 1187.8,1895.7 1253.4,1879.5 1311.9,1858.4 1332,1832.2 1368,1785.2 1347.9,1713.7 1328.9,1668.4"];
		l2_final_res_tp0	[height=1.8889,
			label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8",
			pos="1120,1313.2",
			width=9.9643];
		l2_residual_tp0 -> l2_final_res_tp0	[pos="e,1432.2,1337.9 1227.4,1932.4 1475.4,1921.3 1798,1883.9 1798,1765.2 1798,1765.2 1798,1765.2 1798,1485.2 1798,1404.9 1617.2,1362 \
1442.4,1339.2"];
		l2_gate_tp0 -> l2_exp0_gpu8	[pos="e,1116,1659.3 1116,1695.9 1116,1686.9 1116,1678 1116,1669.6",
			style=dashed];
		l2_gate_tp0 -> l2_exp1_gpu8	[pos="e,970.58,1659.4 1022,1696.1 1007.2,1685.5 992.32,1674.9 978.81,1665.3",
			style=dashed];
		l2_gate_tp0 -> l2_exp2_gpu8	[pos="e,435.18,1656.9 938.86,1744.5 804.9,1728.3 616.74,1701.1 444.91,1659.3",
			style=dashed];
		l2_gate_tp0 -> l2_exp3_gpu8	[pos="e,627.24,1656.6 924.9,1722.3 809.39,1697.5 677.98,1669.2 636.95,1659.1",
			style=dashed];
		l2_gate_tp0 -> l2_exp4_gpu8	[pos="e,819.26,1657.3 927.94,1696.1 893.64,1683.8 859.18,1671.5 828.93,1660.7",
			style=dashed];
		l2_gate_tp0 -> l2_exp5_gpu8	[pos="e,1412.8,1657.3 1250.6,1715.2 1300.8,1697.2 1356.9,1677.2 1403.1,1660.7",
			style=dashed];
		l2_gate_tp0 -> l2_exp6_gpu8	[pos="e,1604.8,1656.6 1263.4,1735.9 1356.3,1717.6 1478.7,1691.5 1595,1659.4",
			style=dashed];
		l2_gate_tp0 -> l2_exp7_gpu8	[pos="e,1261.4,1659.4 1210,1696.1 1224.8,1685.5 1239.7,1674.9 1253.2,1665.3",
			style=dashed];
		l2_exp_agg_tp0	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 8",
			pos="1116,1486.2",
			width=6.1053];
		l2_exp0_gpu8 -> l2_exp_agg_tp0	[pos="e,1116,1554.4 1116,1591 1116,1582.9 1116,1573.8 1116,1564.5"];
		l2_exp1_gpu8 -> l2_exp_agg_tp0	[pos="e,1021.8,1554.4 970.48,1591 983.59,1581.6 998.39,1571.1 1013.4,1560.4"];
		l2_exp2_gpu8 -> l2_exp_agg_tp0	[pos="e,953.16,1504.2 435.18,1593.5 438.15,1592.7 441.09,1591.9 444,1591.2 611.29,1549.8 806.29,1521.8 943.01,1505.4"];
		l2_exp3_gpu8 -> l2_exp_agg_tp0	[pos="e,960.85,1516 627.24,1593.7 630.19,1592.8 633.11,1592 636,1591.2 739.61,1562.2 857.66,1536.6 950.77,1518"];
		l2_exp4_gpu8 -> l2_exp_agg_tp0	[pos="e,974.99,1537.5 819.14,1593.1 862.38,1577.7 915.85,1558.6 965.45,1540.9"];
		l2_exp5_gpu8 -> l2_exp_agg_tp0	[pos="e,1303.9,1554.2 1412.9,1593.1 1383.1,1582.5 1348.6,1570.1 1313.7,1557.7"];
		l2_exp6_gpu8 -> l2_exp_agg_tp0	[pos="e,1316.4,1525.1 1604.8,1593.7 1601.8,1592.8 1598.9,1592 1596,1591.2 1508.5,1566.7 1410.7,1544.6 1326.3,1527.1"];
		l2_exp7_gpu8 -> l2_exp_agg_tp0	[pos="e,1210.2,1554.4 1261.5,1591 1248.4,1581.6 1233.6,1571.1 1218.6,1560.4"];
		l2_exp_agg_tp0 -> l2_final_res_tp0	[pos="e,1118.4,1381.3 1117.6,1418.1 1117.8,1409.4 1118,1400.5 1118.2,1391.6"];
		l3_qkv_tp0	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 8",
			pos="1051,1174.2",
			shape=rectangle,
			width=3.1389];
		l2_final_res_tp0 -> l3_qkv_tp0	[pos="e,1067.7,1208.3 1086.1,1244.9 1081.4,1235.5 1076.7,1226.2 1072.3,1217.4"];
		l3_residual_tp0	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8",
			pos="1081,825.17",
			width=9.9643];
		l2_final_res_tp0 -> l3_residual_tp0	[pos="e,1156.2,893.43 1164.6,1244.8 1175,1223.5 1183,1199.1 1183,1175.2 1183,1175.2 1183,1175.2 1183,963.17 1183,941.05 1174.3,920.2 1162.1,\
901.74"];
		l2_qkv_tp1	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 9",
			pos="2815,2286.2",
			shape=rectangle,
			width=3.1389];
		l2_attn_tp1	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 9",
			pos="2721,2181.2",
			shape=rectangle,
			width=2.9722];
		l2_qkv_tp1 -> l2_attn_tp1	[pos="e,2751.2,2215.3 2784.7,2252 2776.3,2242.7 2767,2232.5 2758.1,2222.9"];
		l2_residual_tp1	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9",
			pos="2785,1937.2",
			width=9.9643];
		l2_qkv_tp1 -> l2_residual_tp1	[pos="e,2824.1,2005.3 2827.7,2251.8 2831.5,2240.4 2835.1,2227.4 2837,2215.2 2848.7,2139.2 2854.7,2117 2837,2042.2 2834.8,2033 2831.7,2023.7 \
2828.1,2014.6"];
		l2_out_proj_tp1	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9",
			pos="2722,2076.2",
			shape=rectangle,
			width=2.9444];
		l2_attn_tp1 -> l2_out_proj_tp1	[pos="e,2721.7,2110.3 2721.3,2147 2721.4,2138.6 2721.5,2129.3 2721.6,2120.5"];
		l2_out_proj_tp1 -> l2_residual_tp1	[pos="e,2754.1,2005.4 2737.3,2042 2741.1,2033.6 2745.4,2024.2 2749.8,2014.6"];
		l2_gate_tp1	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 9",
			pos="2618,1764.2",
			width=5.7597];
		l2_residual_tp1 -> l2_gate_tp1	[pos="e,2683.6,1832.3 2719.5,1869.1 2710.1,1859.5 2700.4,1849.5 2690.8,1839.8"];
		l2_exp0_gpu9	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9",
			pos="2480,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp1 -> l2_exp0_gpu9	[pos="e,2430.5,1659.2 2460.4,1869.1 2433.4,1858.2 2412.5,1845.8 2402,1832.2 2365.3,1784.2 2377.4,1751.4 2402,1696.2 2406.9,1685.1 2414.5,\
1675.1 2423.1,1666.3"];
		l2_exp1_gpu9	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9",
			pos="3056,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp1 -> l2_exp1_gpu9	[pos="e,3026.9,1659.4 2843.8,1868.9 2897.6,1807.4 2975.3,1718.5 3020.2,1667.1"];
		l2_exp2_gpu9	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9",
			pos="2288,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp1 -> l2_exp2_gpu9	[pos="e,2293.7,1659.5 2443.8,1869 2412.6,1858 2387.6,1845.7 2374,1832.2 2328.9,1787.3 2306.3,1715.3 2295.9,1669.4"];
		l2_exp3_gpu9	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9",
			pos="2096,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp1 -> l2_exp3_gpu9	[pos="e,2118.8,1659.5 2450.5,1891.9 2397.5,1877.3 2344.9,1857.9 2298,1832.2 2224.1,1791.5 2160,1715.2 2124.8,1667.8"];
		l2_exp4_gpu9	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9",
			pos="1904,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp1 -> l2_exp4_gpu9	[pos="e,1931.4,1659.2 2482.5,1921.5 2371.7,1907.5 2247.9,1881 2143,1832.2 2058.6,1792.8 1980.9,1714.9 1938.2,1666.9"];
		l2_exp5_gpu9	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9",
			pos="3248,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp1 -> l2_exp5_gpu9	[pos="e,3198.5,1659.3 2885.2,1869.1 2978.2,1806.8 3113.6,1716.1 3190,1665"];
		l2_exp6_gpu9	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9",
			pos="2864,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp1 -> l2_exp6_gpu9	[pos="e,2867.6,1659.4 2840.7,1869 2843.9,1863.2 2846.7,1857.2 2849,1851.2 2871.3,1791.1 2871.2,1715.9 2868.3,1669.5"];
		l2_exp7_gpu9	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9",
			pos="2672,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp1 -> l2_exp7_gpu9	[pos="e,2759.1,1659 2821.9,1868.9 2826.9,1857 2831.3,1844.4 2834,1832.2 2840.6,1802.7 2850.6,1721.4 2834,1696.2 2829.5,1689.4 2800.7,1676.1 \
2768.6,1662.9"];
		l2_final_res_tp1	[height=1.8889,
			label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9",
			pos="2751,1313.2",
			width=9.9643];
		l2_residual_tp1 -> l2_final_res_tp1	[pos="e,3078.5,1352 3037.1,1905.9 3189.3,1880.3 3354,1836.2 3354,1765.2 3354,1765.2 3354,1765.2 3354,1485.2 3354,1421.1 3226.3,1379.8 \
3088.5,1353.8"];
		l2_gate_tp1 -> l2_exp0_gpu9	[pos="e,2513.4,1659.3 2550.2,1695.9 2540.1,1685.8 2530,1675.8 2520.6,1666.5",
			style=dashed];
		l2_gate_tp1 -> l2_exp1_gpu9	[pos="e,2968.9,1656.3 2756.9,1722.2 2816.5,1704.3 2887.1,1682.7 2959.2,1659.4",
			style=dashed];
		l2_gate_tp1 -> l2_exp2_gpu9	[pos="e,2367.6,1659.2 2456.4,1696.1 2429,1684.7 2401.5,1673.3 2376.9,1663.1",
			style=dashed];
		l2_gate_tp1 -> l2_exp3_gpu9	[pos="e,2183.2,1656.6 2421.2,1713.2 2372.8,1701.1 2321.1,1688.5 2273,1677.2 2239.9,1669.4 2229.2,1669.2 2193,1659.3",
			style=dashed];
		l2_gate_tp1 -> l2_exp4_gpu9	[pos="e,1991.2,1656.8 2438.6,1740.9 2317,1724 2153,1697.4 2001.2,1659.3",
			style=dashed];
		l2_gate_tp1 -> l2_exp5_gpu9	[pos="e,3160.8,1656.7 2767.7,1739.7 2872.9,1721.9 3016.6,1694.9 3150.7,1659.4",
			style=dashed];
		l2_gate_tp1 -> l2_exp6_gpu9	[pos="e,2804.6,1659.2 2738.5,1696.1 2758.1,1685.2 2777.7,1674.2 2795.5,1664.3",
			style=dashed];
		l2_gate_tp1 -> l2_exp7_gpu9	[pos="e,2658.9,1659.3 2644.5,1695.9 2648.2,1686.6 2651.8,1677.4 2655.2,1668.7",
			style=dashed];
		l2_exp_agg_tp1	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 9",
			pos="2672,1486.2",
			width=6.1053];
		l2_exp0_gpu9 -> l2_exp_agg_tp1	[pos="e,2577.8,1554.4 2526.5,1591 2539.6,1581.6 2554.4,1571.1 2569.4,1560.4"];
		l2_exp1_gpu9 -> l2_exp_agg_tp1	[pos="e,2859.9,1554.2 2968.9,1593.1 2939.1,1582.5 2904.6,1570.1 2869.7,1557.7"];
		l2_exp2_gpu9 -> l2_exp_agg_tp1	[pos="e,2531,1537.5 2375.1,1593.1 2418.4,1577.7 2471.9,1558.6 2521.5,1540.9"];
		l2_exp3_gpu9 -> l2_exp_agg_tp1	[pos="e,2516.8,1516 2183.2,1593.7 2186.2,1592.8 2189.1,1592 2192,1591.2 2295.6,1562.2 2413.7,1536.6 2506.8,1518"];
		l2_exp4_gpu9 -> l2_exp_agg_tp1	[pos="e,2509.2,1504.2 1991.2,1593.5 1994.1,1592.7 1997.1,1591.9 2000,1591.2 2167.3,1549.8 2362.3,1521.8 2499,1505.4"];
		l2_exp5_gpu9 -> l2_exp_agg_tp1	[pos="e,2872.4,1525.1 3160.8,1593.7 3157.8,1592.8 3154.9,1592 3152,1591.2 3064.5,1566.7 2966.7,1544.6 2882.3,1527.1"];
		l2_exp6_gpu9 -> l2_exp_agg_tp1	[pos="e,2766.2,1554.4 2817.5,1591 2804.4,1581.6 2789.6,1571.1 2774.6,1560.4"];
		l2_exp7_gpu9 -> l2_exp_agg_tp1	[pos="e,2672,1554.4 2672,1591 2672,1582.9 2672,1573.8 2672,1564.5"];
		l2_exp_agg_tp1 -> l2_final_res_tp1	[pos="e,2720,1381.3 2703,1418.1 2707.2,1409 2711.5,1399.7 2715.7,1390.5"];
		l3_qkv_tp1	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 9",
			pos="2685,1174.2",
			shape=rectangle,
			width=3.1389];
		l2_final_res_tp1 -> l3_qkv_tp1	[pos="e,2701,1208.3 2718.6,1244.9 2714.1,1235.5 2709.6,1226.2 2705.4,1217.4"];
		l3_residual_tp1	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9",
			pos="2786,825.17",
			width=9.9643];
		l2_final_res_tp1 -> l3_residual_tp1	[pos="e,2807.4,893.43 2797.7,1245.1 2808.6,1223.7 2817,1199.3 2817,1175.2 2817,1175.2 2817,1175.2 2817,963.17 2817,943.54 2813.9,922.72 \
2809.7,903.39"];
		l2_qkv_tp2	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 10",
			pos="4032,2286.2",
			shape=rectangle,
			width=3.1389];
		l2_attn_tp2	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 10",
			pos="3969,2181.2",
			shape=rectangle,
			width=2.9722];
		l2_qkv_tp2 -> l2_attn_tp2	[pos="e,3989.2,2215.3 4011.7,2252 4006.3,2243.1 4000.3,2233.3 3994.6,2224"];
		l2_residual_tp2	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10",
			pos="4061,1937.2",
			width=9.9643];
		l2_qkv_tp2 -> l2_residual_tp2	[pos="e,4081.7,2005.4 4063.9,2252.2 4072.4,2241.2 4080.5,2228.5 4085,2215.2 4106.8,2150.2 4097.1,2072.1 4084,2015.4"];
		l2_out_proj_tp2	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10",
			pos="3969,2076.2",
			shape=rectangle,
			width=2.9444];
		l2_attn_tp2 -> l2_out_proj_tp2	[pos="e,3969,2110.3 3969,2147 3969,2138.6 3969,2129.3 3969,2120.5"];
		l2_out_proj_tp2 -> l2_residual_tp2	[pos="e,4015.9,2005.4 3991.3,2042 3997.1,2033.3 4003.6,2023.6 4010.2,2013.7"];
		l2_gate_tp2	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 10",
			pos="4228,1764.2",
			width=5.7597];
		l2_residual_tp2 -> l2_gate_tp2	[pos="e,4162.4,1832.3 4126.5,1869.1 4135.9,1859.5 4145.6,1849.5 4155.2,1839.8"];
		l2_exp0_gpu10	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10",
			pos="3460,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp2 -> l2_exp0_gpu10	[pos="e,3492.9,1659.4 3801.6,1869.1 3772.7,1858.3 3744.3,1846 3718,1832.2 3632.8,1787.3 3548.3,1712.6 3500.3,1666.6"];
		l2_exp1_gpu10	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10",
			pos="4036,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp2 -> l2_exp1_gpu10	[pos="e,4006,1659.2 4004.7,1869 4001.7,1863.2 3999,1857.2 3997,1851.2 3972.5,1777.8 3972.2,1750.4 3997,1677.2 3998.1,1674.1 3999.4,1671 \
4000.9,1668"];
		l2_exp2_gpu10	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10",
			pos="4228,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp2 -> l2_exp2_gpu10	[pos="e,4140.9,1656.2 4021.2,1869 3996.3,1817.2 3975.1,1746.1 4012,1696.2 4043.3,1653.7 4075.2,1673.9 4131,1659.2"];
		l2_exp3_gpu10	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10",
			pos="3652,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp2 -> l2_exp3_gpu10	[pos="e,3684.3,1659.2 3936.8,1869 3917.7,1857.4 3898.5,1844.9 3881,1832.2 3809.8,1780.5 3735.6,1710.2 3691.6,1666.5"];
		l2_exp4_gpu10	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10",
			pos="3844,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp2 -> l2_exp4_gpu10	[pos="e,3863.2,1659.5 4002.6,1869 3992.7,1856.9 3982.9,1844.3 3974,1832.2 3934.1,1777.4 3893.3,1710.6 3868.3,1668.2"];
		l2_exp5_gpu10	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10",
			pos="4420,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp2 -> l2_exp5_gpu10	[pos="e,4436.8,1659.2 4301.6,1895.3 4366.4,1879.1 4424.1,1858.1 4444,1832.2 4479.9,1785.2 4459.9,1713.6 4440.9,1668.4"];
		l2_exp6_gpu10	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10",
			pos="4804,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp2 -> l2_exp6_gpu10	[pos="e,4768.1,1659.2 4306.4,1899.9 4376.7,1884.3 4452.1,1862.5 4518,1832.2 4612.3,1788.7 4707.2,1712.4 4760.5,1665.8"];
		l2_exp7_gpu10	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10",
			pos="4612,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp2 -> l2_exp7_gpu10	[pos="e,4593,1659.3 4314.9,1907.7 4366.9,1892 4417.9,1868.2 4458,1832.2 4512.5,1783.2 4560.4,1712.4 4587.8,1667.8"];
		l2_final_res_tp2	[height=1.8889,
			label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10",
			pos="4232,1313.2",
			width=9.9643];
		l2_residual_tp2 -> l2_final_res_tp2	[pos="e,4544.2,1337.9 4341.3,1932.3 4588.6,1921 4910,1883.6 4910,1765.2 4910,1765.2 4910,1765.2 4910,1485.2 4910,1404.9 4729.2,1362 4554.4,\
1339.2"];
		l2_gate_tp2 -> l2_exp0_gpu10	[pos="e,3547.2,1656.9 4050.9,1744.5 3916.9,1728.3 3728.7,1701.1 3556.9,1659.3",
			style=dashed];
		l2_gate_tp2 -> l2_exp1_gpu10	[pos="e,4082.6,1659.4 4134,1696.1 4119.2,1685.5 4104.3,1674.9 4090.8,1665.3",
			style=dashed];
		l2_gate_tp2 -> l2_exp2_gpu10	[pos="e,4228,1659.3 4228,1695.9 4228,1686.9 4228,1678 4228,1669.6",
			style=dashed];
		l2_gate_tp2 -> l2_exp3_gpu10	[pos="e,3739.2,1656.6 4040.4,1727.9 3954,1710.3 3850.2,1687.3 3749,1659.4",
			style=dashed];
		l2_gate_tp2 -> l2_exp4_gpu10	[pos="e,3931.3,1657.3 4039.9,1696.1 4005.6,1683.8 3971.2,1671.5 3940.9,1660.7",
			style=dashed];
		l2_gate_tp2 -> l2_exp5_gpu10	[pos="e,4373.4,1659.4 4322,1696.1 4336.8,1685.5 4351.7,1674.9 4365.2,1665.3",
			style=dashed];
		l2_gate_tp2 -> l2_exp6_gpu10	[pos="e,4716.8,1656.6 4375.4,1735.9 4468.3,1717.6 4590.7,1691.5 4707,1659.4",
			style=dashed];
		l2_gate_tp2 -> l2_exp7_gpu10	[pos="e,4524.8,1657.3 4362.6,1715.2 4412.8,1697.2 4468.9,1677.2 4515.1,1660.7",
			style=dashed];
		l2_exp_agg_tp2	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 10",
			pos="4228,1486.2",
			width=6.1053];
		l2_exp0_gpu10 -> l2_exp_agg_tp2	[pos="e,4065.2,1504.2 3547.2,1593.5 3550.1,1592.7 3553.1,1591.9 3556,1591.2 3723.3,1549.8 3918.3,1521.8 4055,1505.4"];
		l2_exp1_gpu10 -> l2_exp_agg_tp2	[pos="e,4133.8,1554.4 4082.5,1591 4095.6,1581.6 4110.4,1571.1 4125.4,1560.4"];
		l2_exp2_gpu10 -> l2_exp_agg_tp2	[pos="e,4228,1554.4 4228,1591 4228,1582.9 4228,1573.8 4228,1564.5"];
		l2_exp3_gpu10 -> l2_exp_agg_tp2	[pos="e,4072.8,1516 3739.2,1593.7 3742.2,1592.8 3745.1,1592 3748,1591.2 3851.6,1562.2 3969.7,1536.6 4062.8,1518"];
		l2_exp4_gpu10 -> l2_exp_agg_tp2	[pos="e,4087,1537.5 3931.1,1593.1 3974.4,1577.7 4027.9,1558.6 4077.5,1540.9"];
		l2_exp5_gpu10 -> l2_exp_agg_tp2	[pos="e,4322.2,1554.4 4373.5,1591 4360.4,1581.6 4345.6,1571.1 4330.6,1560.4"];
		l2_exp6_gpu10 -> l2_exp_agg_tp2	[pos="e,4428.4,1525.1 4716.8,1593.7 4713.8,1592.8 4710.9,1592 4708,1591.2 4620.5,1566.7 4522.7,1544.6 4438.3,1527.1"];
		l2_exp7_gpu10 -> l2_exp_agg_tp2	[pos="e,4415.9,1554.2 4524.9,1593.1 4495.1,1582.5 4460.6,1570.1 4425.7,1557.7"];
		l2_exp_agg_tp2 -> l2_final_res_tp2	[pos="e,4230.4,1381.3 4229.6,1418.1 4229.8,1409.4 4230,1400.5 4230.2,1391.6"];
		l3_qkv_tp2	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 10",
			pos="4162,1174.2",
			shape=rectangle,
			width=3.1389];
		l2_final_res_tp2 -> l3_qkv_tp2	[pos="e,4178.9,1208.3 4197.6,1244.9 4192.8,1235.5 4188.1,1226.2 4183.6,1217.4"];
		l3_residual_tp2	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10",
			pos="4180,825.17",
			width=9.9643];
		l2_final_res_tp2 -> l3_residual_tp2	[pos="e,4265.2,893.4 4275.7,1245.1 4286,1223.6 4294,1199.2 4294,1175.2 4294,1175.2 4294,1175.2 4294,963.17 4294,940.63 4284.8,919.82 4271.6,\
901.59"];
		l2_qkv_tp3	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 11",
			pos="5884,2286.2",
			shape=rectangle,
			width=3.1389];
		l2_attn_tp3	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 11",
			pos="5821,2181.2",
			shape=rectangle,
			width=2.9722];
		l2_qkv_tp3 -> l2_attn_tp3	[pos="e,5841.2,2215.3 5863.7,2252 5858.3,2243.1 5852.3,2233.3 5846.6,2224"];
		l2_residual_tp3	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11",
			pos="5943,1937.2",
			width=9.9643];
		l2_qkv_tp3 -> l2_residual_tp3	[pos="e,5952.9,2005.4 5915.7,2252.1 5924.3,2241.2 5932.4,2228.4 5937,2215.2 5959.5,2150.6 5958.8,2072.3 5953.8,2015.4"];
		l2_out_proj_tp3	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11",
			pos="5822,2076.2",
			shape=rectangle,
			width=2.9444];
		l2_attn_tp3 -> l2_out_proj_tp3	[pos="e,5821.7,2110.3 5821.3,2147 5821.4,2138.6 5821.5,2129.3 5821.6,2120.5"];
		l2_out_proj_tp3 -> l2_residual_tp3	[pos="e,5883.6,2005.4 5851.3,2042 5859.1,2033.2 5867.9,2023.3 5876.8,2013.1"];
		l2_gate_tp3	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 11",
			pos="5730,1764.2",
			width=5.7597];
		l2_residual_tp3 -> l2_gate_tp3	[pos="e,5813.7,1832.3 5859.4,1869.1 5847,1859.1 5834.1,1848.7 5821.5,1838.6"];
		l2_exp0_gpu11	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11",
			pos="5208,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp3 -> l2_exp0_gpu11	[pos="e,5230.4,1659.3 5623.9,1906.2 5550.7,1890.7 5475.3,1867.3 5410,1832.2 5335.5,1792 5271.4,1715.2 5236.4,1667.6"];
		l2_exp1_gpu11	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11",
			pos="5016,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp3 -> l2_exp1_gpu11	[pos="e,5043.2,1659.4 5622.5,1905.1 5475.8,1887.3 5320,1862.6 5254,1832.2 5169.6,1793.3 5092.3,1715.2 5049.9,1667.1"];
		l2_exp2_gpu11	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11",
			pos="6360,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp3 -> l2_exp2_gpu11	[pos="e,6315.4,1659.3 6033.2,1869.1 6116.9,1806.9 6238.5,1716.5 6307.3,1665.3"];
		l2_exp3_gpu11	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11",
			pos="5976,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp3 -> l2_exp3_gpu11	[pos="e,5975.3,1659.5 5958.1,1869 5959.2,1863 5960.2,1857 5961,1851.2 5969.7,1788.4 5973.4,1715 5974.9,1669.6"];
		l2_exp4_gpu11	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11",
			pos="5400,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp3 -> l2_exp4_gpu11	[pos="e,5405.8,1659.4 5598,1882.2 5547.4,1868.5 5505.6,1851.9 5486,1832.2 5441.1,1787.1 5418.4,1715.2 5407.9,1669.3"];
		l2_exp5_gpu11	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11",
			pos="5592,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp3 -> l2_exp5_gpu11	[pos="e,5542.5,1659.2 5591.4,1876 5555.5,1863.6 5527.3,1849.1 5514,1832.2 5476.6,1784.7 5489.4,1751.4 5514,1696.2 5518.9,1685.1 5526.5,\
1675.1 5535.1,1666.3"];
		l2_exp6_gpu11	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11",
			pos="6168,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp3 -> l2_exp6_gpu11	[pos="e,6143.8,1659.4 5991.8,1868.9 6036.3,1807.7 6100.5,1719.2 6137.9,1667.7"];
		l2_exp7_gpu11	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11",
			pos="5784,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp3 -> l2_exp7_gpu11	[pos="e,5871.1,1659 5952,1869.1 5958.7,1808.1 5964,1723.6 5946,1696.2 5941.5,1689.4 5912.7,1676.1 5880.6,1662.9"];
		l2_final_res_tp3	[height=1.8889,
			label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11",
			pos="5926,1313.2",
			width=9.9643];
		l2_residual_tp3 -> l2_final_res_tp3	[pos="e,6273,1369.8 6188.4,1899.8 6324.3,1872.5 6466,1828.8 6466,1765.2 6466,1765.2 6466,1765.2 6466,1485.2 6466,1435.9 6383.4,1399 6282.7,\
1372.4"];
		l2_gate_tp3 -> l2_exp0_gpu11	[pos="e,5295.2,1656.6 5533.2,1713.2 5484.8,1701.1 5433.1,1688.5 5385,1677.2 5351.9,1669.4 5341.2,1669.2 5305,1659.3",
			style=dashed];
		l2_gate_tp3 -> l2_exp1_gpu11	[pos="e,5103.2,1656.8 5550.6,1740.9 5429,1724 5265,1697.4 5113.2,1659.3",
			style=dashed];
		l2_gate_tp3 -> l2_exp2_gpu11	[pos="e,6272.8,1656.7 5879.7,1739.7 5984.9,1721.9 6128.6,1694.9 6262.7,1659.4",
			style=dashed];
		l2_gate_tp3 -> l2_exp3_gpu11	[pos="e,5916.6,1659.2 5850.5,1696.1 5870.1,1685.2 5889.7,1674.2 5907.5,1664.3",
			style=dashed];
		l2_gate_tp3 -> l2_exp4_gpu11	[pos="e,5479.6,1659.2 5568.4,1696.1 5541,1684.7 5513.5,1673.3 5488.9,1663.1",
			style=dashed];
		l2_gate_tp3 -> l2_exp5_gpu11	[pos="e,5625.4,1659.3 5662.2,1695.9 5652.1,1685.8 5642,1675.8 5632.6,1666.5",
			style=dashed];
		l2_gate_tp3 -> l2_exp6_gpu11	[pos="e,6080.9,1656.3 5868.9,1722.2 5928.5,1704.3 5999.1,1682.7 6071.2,1659.4",
			style=dashed];
		l2_gate_tp3 -> l2_exp7_gpu11	[pos="e,5770.9,1659.3 5756.5,1695.9 5760.2,1686.6 5763.8,1677.4 5767.2,1668.7",
			style=dashed];
		l2_exp_agg_tp3	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 11",
			pos="5784,1486.2",
			width=6.1053];
		l2_exp0_gpu11 -> l2_exp_agg_tp3	[pos="e,5628.8,1516 5295.2,1593.7 5298.2,1592.8 5301.1,1592 5304,1591.2 5407.6,1562.2 5525.7,1536.6 5618.8,1518"];
		l2_exp1_gpu11 -> l2_exp_agg_tp3	[pos="e,5621.2,1504.2 5103.2,1593.5 5106.1,1592.7 5109.1,1591.9 5112,1591.2 5279.3,1549.8 5474.3,1521.8 5611,1505.4"];
		l2_exp2_gpu11 -> l2_exp_agg_tp3	[pos="e,5984.4,1525.1 6272.8,1593.7 6269.8,1592.8 6266.9,1592 6264,1591.2 6176.5,1566.7 6078.7,1544.6 5994.3,1527.1"];
		l2_exp3_gpu11 -> l2_exp_agg_tp3	[pos="e,5878.2,1554.4 5929.5,1591 5916.4,1581.6 5901.6,1571.1 5886.6,1560.4"];
		l2_exp4_gpu11 -> l2_exp_agg_tp3	[pos="e,5643,1537.5 5487.1,1593.1 5530.4,1577.7 5583.9,1558.6 5633.5,1540.9"];
		l2_exp5_gpu11 -> l2_exp_agg_tp3	[pos="e,5689.8,1554.4 5638.5,1591 5651.6,1581.6 5666.4,1571.1 5681.4,1560.4"];
		l2_exp6_gpu11 -> l2_exp_agg_tp3	[pos="e,5971.9,1554.2 6080.9,1593.1 6051.1,1582.5 6016.6,1570.1 5981.7,1557.7"];
		l2_exp7_gpu11 -> l2_exp_agg_tp3	[pos="e,5784,1554.4 5784,1591 5784,1582.9 5784,1573.8 5784,1564.5"];
		l2_exp_agg_tp3 -> l2_final_res_tp3	[pos="e,5870.2,1381.3 5839.7,1418.1 5847.6,1408.5 5855.8,1398.7 5863.8,1389"];
		l3_qkv_tp3	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 11",
			pos="5829,1174.2",
			shape=rectangle,
			width=3.1389];
		l2_final_res_tp3 -> l3_qkv_tp3	[pos="e,5852.5,1208.3 5878.4,1244.9 5871.5,1235.2 5864.7,1225.6 5858.3,1216.6"];
		l3_residual_tp3	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11",
			pos="5897,825.17",
			width=9.9643];
		l2_final_res_tp3 -> l3_residual_tp3	[pos="e,5942.3,893.42 5950.2,1245.1 5956.2,1223.1 5961,1198.4 5961,1175.2 5961,1175.2 5961,1175.2 5961,963.17 5961,942.52 5955,921.64 \
5946.6,902.6"];
		l2_qkv_tp4	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 12",
			pos="7173,2286.2",
			shape=rectangle,
			width=3.1389];
		l2_attn_tp4	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 12",
			pos="7080,2181.2",
			shape=rectangle,
			width=2.9722];
		l2_qkv_tp4 -> l2_attn_tp4	[pos="e,7109.9,2215.3 7143.1,2252 7134.7,2242.7 7125.5,2232.5 7116.8,2222.9"];
		l2_residual_tp4	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12",
			pos="7172,1937.2",
			width=9.9643];
		l2_qkv_tp4 -> l2_residual_tp4	[pos="e,7189,2005.2 7186.3,2251.9 7190.3,2240.4 7194,2227.4 7196,2215.2 7198.4,2200.1 7197.1,2060.7 7195,2042.2 7194,2033.4 7192.6,2024.3 \
7190.9,2015.3"];
		l2_out_proj_tp4	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12",
			pos="7080,2076.2",
			shape=rectangle,
			width=2.9444];
		l2_attn_tp4 -> l2_out_proj_tp4	[pos="e,7080,2110.3 7080,2147 7080,2138.6 7080,2129.3 7080,2120.5"];
		l2_out_proj_tp4 -> l2_residual_tp4	[pos="e,7126.9,2005.4 7102.3,2042 7108.1,2033.3 7114.6,2023.6 7121.2,2013.7"];
		l2_gate_tp4	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 12",
			pos="7340,1764.2",
			width=5.7597];
		l2_residual_tp4 -> l2_gate_tp4	[pos="e,7274,1832.3 7237.9,1869.1 7247.4,1859.5 7257.1,1849.5 7266.7,1839.8"];
		l2_exp0_gpu12	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12",
			pos="7148,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp4 -> l2_exp0_gpu12	[pos="e,7118,1659.2 7116.7,1869.1 7113.7,1863.3 7111,1857.3 7109,1851.2 7084.8,1777.7 7084.2,1750.4 7109,1677.2 7110.1,1674.1 7111.4,1671 \
7112.9,1668"];
		l2_exp1_gpu12	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12",
			pos="6572,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp4 -> l2_exp1_gpu12	[pos="e,6604.9,1659.4 6913.3,1869.1 6884.6,1858.2 6856.2,1846 6830,1832.2 6744.8,1787.3 6660.3,1712.6 6612.3,1666.5"];
		l2_exp2_gpu12	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12",
			pos="7340,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp4 -> l2_exp2_gpu12	[pos="e,7252.9,1656.2 7132.6,1869 7108,1817.1 7087.2,1746.1 7124,1696.2 7155.3,1653.7 7187.2,1673.9 7243,1659.2"];
		l2_exp3_gpu12	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12",
			pos="7724,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp4 -> l2_exp3_gpu12	[pos="e,7705,1659.3 7426,1908 7478.3,1892.3 7529.7,1868.4 7570,1832.2 7624.5,1783.2 7672.4,1712.4 7699.8,1667.8"];
		l2_exp4_gpu12	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12",
			pos="7532,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp4 -> l2_exp4_gpu12	[pos="e,7548.8,1659.2 7412.7,1895.5 7477.9,1879.3 7536,1858.3 7556,1832.2 7592,1785.2 7571.9,1713.6 7552.9,1668.4"];
		l2_exp5_gpu12	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12",
			pos="6764,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp4 -> l2_exp5_gpu12	[pos="e,6796.3,1659.2 7048.5,1869 7029.5,1857.3 7010.4,1844.9 6993,1832.2 6921.9,1780.4 6847.6,1710.1 6803.6,1666.5"];
		l2_exp6_gpu12	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12",
			pos="6956,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp4 -> l2_exp6_gpu12	[pos="e,6975.2,1659.5 7114.3,1868.9 7104.6,1856.9 7094.8,1844.3 7086,1832.2 7046.3,1777.3 7005.4,1710.5 6980.3,1668.1"];
		l2_exp7_gpu12	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12",
			pos="7916,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp4 -> l2_exp7_gpu12	[pos="e,7880.1,1659.2 7417.7,1900 7488.2,1884.5 7563.9,1862.6 7630,1832.2 7724.3,1788.7 7819.2,1712.4 7872.5,1665.8"];
		l2_final_res_tp4	[height=1.8889,
			label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12",
			pos="7344,1313.2",
			width=9.9643];
		l2_residual_tp4 -> l2_final_res_tp4	[pos="e,7656.2,1337.9 7452.4,1932.4 7700,1921.1 8022,1883.8 8022,1765.2 8022,1765.2 8022,1765.2 8022,1485.2 8022,1404.9 7841.2,1362 7666.4,\
1339.2"];
		l2_gate_tp4 -> l2_exp0_gpu12	[pos="e,7194.6,1659.4 7246,1696.1 7231.2,1685.5 7216.3,1674.9 7202.8,1665.3",
			style=dashed];
		l2_gate_tp4 -> l2_exp1_gpu12	[pos="e,6659.2,1656.9 7162.9,1744.5 7028.9,1728.3 6840.7,1701.1 6668.9,1659.3",
			style=dashed];
		l2_gate_tp4 -> l2_exp2_gpu12	[pos="e,7340,1659.3 7340,1695.9 7340,1686.9 7340,1678 7340,1669.6",
			style=dashed];
		l2_gate_tp4 -> l2_exp3_gpu12	[pos="e,7636.8,1657.3 7474.6,1715.2 7524.8,1697.2 7580.9,1677.2 7627.1,1660.7",
			style=dashed];
		l2_gate_tp4 -> l2_exp4_gpu12	[pos="e,7485.4,1659.4 7434,1696.1 7448.8,1685.5 7463.7,1674.9 7477.2,1665.3",
			style=dashed];
		l2_gate_tp4 -> l2_exp5_gpu12	[pos="e,6851.2,1656.6 7148.9,1722.3 7033.4,1697.5 6902,1669.2 6861,1659.1",
			style=dashed];
		l2_gate_tp4 -> l2_exp6_gpu12	[pos="e,7043.3,1657.3 7151.9,1696.1 7117.6,1683.8 7083.2,1671.5 7052.9,1660.7",
			style=dashed];
		l2_gate_tp4 -> l2_exp7_gpu12	[pos="e,7828.8,1656.6 7487.4,1735.9 7580.3,1717.6 7702.7,1691.5 7819,1659.4",
			style=dashed];
		l2_exp_agg_tp4	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 12",
			pos="7340,1486.2",
			width=6.1053];
		l2_exp0_gpu12 -> l2_exp_agg_tp4	[pos="e,7245.8,1554.4 7194.5,1591 7207.6,1581.6 7222.4,1571.1 7237.4,1560.4"];
		l2_exp1_gpu12 -> l2_exp_agg_tp4	[pos="e,7177.2,1504.2 6659.2,1593.5 6662.1,1592.7 6665.1,1591.9 6668,1591.2 6835.3,1549.8 7030.3,1521.8 7167,1505.4"];
		l2_exp2_gpu12 -> l2_exp_agg_tp4	[pos="e,7340,1554.4 7340,1591 7340,1582.9 7340,1573.8 7340,1564.5"];
		l2_exp3_gpu12 -> l2_exp_agg_tp4	[pos="e,7527.9,1554.2 7636.9,1593.1 7607.1,1582.5 7572.6,1570.1 7537.7,1557.7"];
		l2_exp4_gpu12 -> l2_exp_agg_tp4	[pos="e,7434.2,1554.4 7485.5,1591 7472.4,1581.6 7457.6,1571.1 7442.6,1560.4"];
		l2_exp5_gpu12 -> l2_exp_agg_tp4	[pos="e,7184.8,1516 6851.2,1593.7 6854.2,1592.8 6857.1,1592 6860,1591.2 6963.6,1562.2 7081.7,1536.6 7174.8,1518"];
		l2_exp6_gpu12 -> l2_exp_agg_tp4	[pos="e,7199,1537.5 7043.1,1593.1 7086.4,1577.7 7139.9,1558.6 7189.5,1540.9"];
		l2_exp7_gpu12 -> l2_exp_agg_tp4	[pos="e,7540.4,1525.1 7828.8,1593.7 7825.8,1592.8 7822.9,1592 7820,1591.2 7732.5,1566.7 7634.7,1544.6 7550.3,1527.1"];
		l2_exp_agg_tp4 -> l2_final_res_tp4	[pos="e,7342.4,1381.3 7341.6,1418.1 7341.8,1409.4 7342,1400.5 7342.2,1391.6"];
		l3_qkv_tp4	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 12",
			pos="7216,1174.2",
			shape=rectangle,
			width=3.1389];
		l2_final_res_tp4 -> l3_qkv_tp4	[pos="e,7247,1208.3 7281.1,1244.9 7271.8,1234.9 7262.5,1225 7254,1215.8"];
		l3_residual_tp4	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12",
			pos="7290,825.17",
			width=9.9643];
		l2_final_res_tp4 -> l3_residual_tp4	[pos="e,7330.8,893.2 7346.7,1244.9 7347.4,1222.7 7348,1197.9 7348,1175.2 7348,1175.2 7348,1175.2 7348,963.17 7348,942.63 7342.4,921.64 \
7334.7,902.46"];
		l2_qkv_tp5	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 13",
			pos="9012,2286.2",
			shape=rectangle,
			width=3.1389];
		l2_attn_tp5	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 13",
			pos="8918,2181.2",
			shape=rectangle,
			width=2.9722];
		l2_qkv_tp5 -> l2_attn_tp5	[pos="e,8948.2,2215.3 8981.7,2252 8973.3,2242.7 8964,2232.5 8955.1,2222.9"];
		l2_residual_tp5	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13",
			pos="9010,1937.2",
			width=9.9643];
		l2_qkv_tp5 -> l2_residual_tp5	[pos="e,9027,2005.2 9024.7,2251.8 9028.5,2240.4 9032.1,2227.4 9034,2215.2 9036.4,2199.7 9035,2060.1 9033,2042.2 9032,2033.4 9030.6,2024.3 \
9028.9,2015.3"];
		l2_out_proj_tp5	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13",
			pos="8918,2076.2",
			shape=rectangle,
			width=2.9444];
		l2_attn_tp5 -> l2_out_proj_tp5	[pos="e,8918,2110.3 8918,2147 8918,2138.6 8918,2129.3 8918,2120.5"];
		l2_out_proj_tp5 -> l2_residual_tp5	[pos="e,8964.9,2005.4 8940.3,2042 8946.1,2033.3 8952.6,2023.6 8959.2,2013.7"];
		l2_gate_tp5	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 13",
			pos="8842,1764.2",
			width=5.7597];
		l2_residual_tp5 -> l2_gate_tp5	[pos="e,8908,1832.3 8944.1,1869.1 8934.6,1859.5 8924.9,1849.5 8915.3,1839.8"];
		l2_exp0_gpu13	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13",
			pos="8512,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp5 -> l2_exp0_gpu13	[pos="e,8517.7,1659.5 8668,1869.1 8636.7,1858 8611.6,1845.7 8598,1832.2 8552.9,1787.3 8530.3,1715.3 8519.9,1669.4"];
		l2_exp1_gpu13	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13",
			pos="8320,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp5 -> l2_exp1_gpu13	[pos="e,8342.8,1659.5 8676.1,1892.3 8622.6,1877.7 8569.4,1858.2 8522,1832.2 8448.1,1791.5 8384,1715.2 8348.8,1667.8"];
		l2_exp2_gpu13	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13",
			pos="8704,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp5 -> l2_exp2_gpu13	[pos="e,8654.5,1659.2 8684.6,1869.2 8657.5,1858.2 8636.5,1845.9 8626,1832.2 8589.3,1784.2 8601.4,1751.4 8626,1696.2 8630.9,1685.1 8638.5,\
1675.1 8647.1,1666.3"];
		l2_exp3_gpu13	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13",
			pos="9280,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp5 -> l2_exp3_gpu13	[pos="e,9251,1659.4 9068.6,1868.9 9122.1,1807.4 9199.6,1718.5 9244.4,1667.1"];
		l2_exp4_gpu13	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13",
			pos="9088,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp5 -> l2_exp4_gpu13	[pos="e,9091.5,1659.4 9064.8,1869 9068,1863.2 9070.8,1857.2 9073,1851.2 9095.1,1791 9095.1,1715.9 9092.2,1669.4"];
		l2_exp5_gpu13	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13",
			pos="8896,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp5 -> l2_exp5_gpu13	[pos="e,8983.1,1659 9046,1869.1 9051,1857.1 9055.3,1844.5 9058,1832.2 9064.5,1802.6 9074.6,1721.4 9058,1696.2 9053.5,1689.4 9024.7,1676.1 \
8992.6,1662.9"];
		l2_exp6_gpu13	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13",
			pos="8128,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp5 -> l2_exp6_gpu13	[pos="e,8155.4,1659.2 8707.4,1921.7 8596.4,1907.6 8472.2,1881.2 8367,1832.2 8282.6,1792.8 8204.9,1714.9 8162.2,1667"];
		l2_exp7_gpu13	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13",
			pos="9472,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp5 -> l2_exp7_gpu13	[pos="e,9422.6,1659.3 9110,1869.1 9202.8,1806.8 9337.9,1716.1 9414.1,1665"];
		l2_final_res_tp5	[height=1.8889,
			label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13",
			pos="9007,1313.2",
			width=9.9643];
		l2_residual_tp5 -> l2_final_res_tp5	[pos="e,9343.3,1360.1 9262,1905.7 9413.8,1880.1 9578,1836 9578,1765.2 9578,1765.2 9578,1765.2 9578,1485.2 9578,1428.4 9473,1388.8 9353.1,\
1362.2"];
		l2_gate_tp5 -> l2_exp0_gpu13	[pos="e,8591.6,1659.2 8680.4,1696.1 8653,1684.7 8625.5,1673.3 8600.9,1663.1",
			style=dashed];
		l2_gate_tp5 -> l2_exp1_gpu13	[pos="e,8407.2,1656.7 8643.2,1710.2 8598.5,1698.8 8551.2,1687.2 8507,1677.2 8469.6,1668.7 8457.5,1669.7 8416.9,1659.3",
			style=dashed];
		l2_gate_tp5 -> l2_exp2_gpu13	[pos="e,8737.4,1659.3 8774.2,1695.9 8764.1,1685.8 8754,1675.8 8744.6,1666.5",
			style=dashed];
		l2_gate_tp5 -> l2_exp3_gpu13	[pos="e,9192.9,1656.3 8980.9,1722.2 9040.5,1704.3 9111.1,1682.7 9183.2,1659.4",
			style=dashed];
		l2_gate_tp5 -> l2_exp4_gpu13	[pos="e,9028.6,1659.2 8962.5,1696.1 8982.1,1685.2 9001.7,1674.2 9019.5,1664.3",
			style=dashed];
		l2_gate_tp5 -> l2_exp5_gpu13	[pos="e,8882.9,1659.3 8868.5,1695.9 8872.2,1686.6 8875.8,1677.4 8879.2,1668.7",
			style=dashed];
		l2_gate_tp5 -> l2_exp6_gpu13	[pos="e,8215.2,1656.8 8662.6,1740.9 8541,1724 8377,1697.4 8225.2,1659.3",
			style=dashed];
		l2_gate_tp5 -> l2_exp7_gpu13	[pos="e,9384.8,1656.7 8991.7,1739.7 9096.9,1721.9 9240.6,1694.9 9374.7,1659.4",
			style=dashed];
		l2_exp_agg_tp5	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 13",
			pos="8896,1486.2",
			width=6.1053];
		l2_exp0_gpu13 -> l2_exp_agg_tp5	[pos="e,8755,1537.5 8599.1,1593.1 8642.4,1577.7 8695.9,1558.6 8745.5,1540.9"];
		l2_exp1_gpu13 -> l2_exp_agg_tp5	[pos="e,8740.8,1516 8407.2,1593.7 8410.2,1592.8 8413.1,1592 8416,1591.2 8519.6,1562.2 8637.7,1536.6 8730.8,1518"];
		l2_exp2_gpu13 -> l2_exp_agg_tp5	[pos="e,8801.8,1554.4 8750.5,1591 8763.6,1581.6 8778.4,1571.1 8793.4,1560.4"];
		l2_exp3_gpu13 -> l2_exp_agg_tp5	[pos="e,9083.9,1554.2 9192.9,1593.1 9163.1,1582.5 9128.6,1570.1 9093.7,1557.7"];
		l2_exp4_gpu13 -> l2_exp_agg_tp5	[pos="e,8990.2,1554.4 9041.5,1591 9028.4,1581.6 9013.6,1571.1 8998.6,1560.4"];
		l2_exp5_gpu13 -> l2_exp_agg_tp5	[pos="e,8896,1554.4 8896,1591 8896,1582.9 8896,1573.8 8896,1564.5"];
		l2_exp6_gpu13 -> l2_exp_agg_tp5	[pos="e,8733.2,1504.2 8215.2,1593.5 8218.1,1592.7 8221.1,1591.9 8224,1591.2 8391.3,1549.8 8586.3,1521.8 8723,1505.4"];
		l2_exp7_gpu13 -> l2_exp_agg_tp5	[pos="e,9096.4,1525.1 9384.8,1593.7 9381.8,1592.8 9378.9,1592 9376,1591.2 9288.5,1566.7 9190.7,1544.6 9106.3,1527.1"];
		l2_exp_agg_tp5 -> l2_final_res_tp5	[pos="e,8963.4,1381.3 8939.6,1418.1 8945.6,1408.8 8951.7,1399.3 8957.8,1389.9"];
		l3_qkv_tp5	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 13",
			pos="8910,1174.2",
			shape=rectangle,
			width=3.1389];
		l2_final_res_tp5 -> l3_qkv_tp5	[pos="e,8933.5,1208.3 8959.4,1244.9 8952.5,1235.2 8945.7,1225.6 8939.3,1216.6"];
		l3_residual_tp5	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13",
			pos="9010,825.17",
			width=9.9643];
		l2_final_res_tp5 -> l3_residual_tp5	[pos="e,9032.1,893.39 9031.2,1245.1 9037.2,1223.1 9042,1198.4 9042,1175.2 9042,1175.2 9042,1175.2 9042,963.17 9042,943.51 9038.8,922.68 \
9034.5,903.34"];
		l2_qkv_tp6	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 14",
			pos="10284,2286.2",
			shape=rectangle,
			width=3.1389];
		l2_attn_tp6	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 14",
			pos="10191,2181.2",
			shape=rectangle,
			width=2.9722];
		l2_qkv_tp6 -> l2_attn_tp6	[pos="e,10221,2215.3 10254,2252 10246,2242.7 10236,2232.5 10228,2222.9"];
		l2_residual_tp6	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14",
			pos="10285,1937.2",
			width=9.9643];
		l2_qkv_tp6 -> l2_residual_tp6	[pos="e,10300,2005.3 10297,2251.9 10301,2240.4 10305,2227.4 10307,2215.2 10309,2200.5 10308,2061.3 10306,2042.2 10305,2033.4 10304,2024.4 \
10302,2015.4"];
		l2_out_proj_tp6	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14",
			pos="10191,2076.2",
			shape=rectangle,
			width=2.9444];
		l2_attn_tp6 -> l2_out_proj_tp6	[pos="e,10191,2110.3 10191,2147 10191,2138.6 10191,2129.3 10191,2120.5"];
		l2_out_proj_tp6 -> l2_residual_tp6	[pos="e,10239,2005.4 10214,2042 10220,2033.3 10226,2023.6 10233,2013.7"];
		l2_gate_tp6	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 14",
			pos="10452,1764.2",
			width=5.7597];
		l2_residual_tp6 -> l2_gate_tp6	[pos="e,10386,1832.3 10351,1869.1 10360,1859.5 10370,1849.5 10379,1839.8"];
		l2_exp0_gpu14	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14",
			pos="9876,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp6 -> l2_exp0_gpu14	[pos="e,9908.3,1659.2 10161,1869 10142,1857.4 10123,1844.9 10105,1832.2 10034,1780.5 9959.6,1710.2 9915.6,1666.5"];
		l2_exp1_gpu14	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14",
			pos="10068,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp6 -> l2_exp1_gpu14	[pos="e,10087,1659.5 10227,1869 10217,1856.9 10207,1844.3 10198,1832.2 10158,1777.4 10117,1710.6 10092,1668.2"];
		l2_exp2_gpu14	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14",
			pos="9684,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp6 -> l2_exp2_gpu14	[pos="e,9716.9,1659.4 10026,1869.1 9996.7,1858.3 9968.3,1846 9942,1832.2 9856.8,1787.3 9772.3,1712.6 9724.3,1666.6"];
		l2_exp3_gpu14	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14",
			pos="10260,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp6 -> l2_exp3_gpu14	[pos="e,10230,1659.2 10229,1869 10226,1863.2 10223,1857.2 10221,1851.2 10196,1777.8 10196,1750.4 10221,1677.2 10222,1674.1 10223,1671 \
10225,1668"];
		l2_exp4_gpu14	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14",
			pos="11028,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp6 -> l2_exp4_gpu14	[pos="e,10992,1659.2 10530,1899.9 10601,1884.3 10676,1862.5 10742,1832.2 10836,1788.7 10931,1712.4 10985,1665.8"];
		l2_exp5_gpu14	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14",
			pos="10452,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp6 -> l2_exp5_gpu14	[pos="e,10365,1656.2 10245,1869 10220,1817.2 10199,1746.1 10236,1696.2 10267,1653.7 10299,1673.9 10355,1659.2"];
		l2_exp6_gpu14	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14",
			pos="10836,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp6 -> l2_exp6_gpu14	[pos="e,10817,1659.3 10539,1907.7 10591,1892 10642,1868.2 10682,1832.2 10736,1783.2 10784,1712.4 10812,1667.8"];
		l2_exp7_gpu14	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14",
			pos="10644,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp6 -> l2_exp7_gpu14	[pos="e,10661,1659.2 10526,1895.3 10590,1879.1 10648,1858.1 10668,1832.2 10704,1785.2 10684,1713.6 10665,1668.4"];
		l2_final_res_tp6	[height=1.8889,
			label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14",
			pos="10454,1313.2",
			width=9.9643];
		l2_residual_tp6 -> l2_final_res_tp6	[pos="e,10766,1337.6 10565,1932.3 10813,1921 11134,1883.6 11134,1765.2 11134,1765.2 11134,1765.2 11134,1485.2 11134,1404.5 10952,1361.5 \
10776,1338.9"];
		l2_gate_tp6 -> l2_exp0_gpu14	[pos="e,9963.2,1656.6 10261,1722.3 10145,1697.5 10014,1669.2 9973,1659.1",
			style=dashed];
		l2_gate_tp6 -> l2_exp1_gpu14	[pos="e,10155,1657.3 10264,1696.1 10230,1683.8 10195,1671.5 10165,1660.7",
			style=dashed];
		l2_gate_tp6 -> l2_exp2_gpu14	[pos="e,9771.2,1656.9 10275,1744.5 10141,1728.3 9952.7,1701.1 9780.9,1659.3",
			style=dashed];
		l2_gate_tp6 -> l2_exp3_gpu14	[pos="e,10307,1659.4 10358,1696.1 10343,1685.5 10328,1674.9 10315,1665.3",
			style=dashed];
		l2_gate_tp6 -> l2_exp4_gpu14	[pos="e,10941,1656.6 10599,1735.9 10692,1717.6 10815,1691.5 10931,1659.4",
			style=dashed];
		l2_gate_tp6 -> l2_exp5_gpu14	[pos="e,10452,1659.3 10452,1695.9 10452,1686.9 10452,1678 10452,1669.6",
			style=dashed];
		l2_gate_tp6 -> l2_exp6_gpu14	[pos="e,10749,1657.3 10587,1715.2 10637,1697.2 10693,1677.2 10739,1660.7",
			style=dashed];
		l2_gate_tp6 -> l2_exp7_gpu14	[pos="e,10597,1659.4 10546,1696.1 10561,1685.5 10576,1674.9 10589,1665.3",
			style=dashed];
		l2_exp_agg_tp6	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 14",
			pos="10452,1486.2",
			width=6.1053];
		l2_exp0_gpu14 -> l2_exp_agg_tp6	[pos="e,10297,1516 9963.2,1593.7 9966.2,1592.8 9969.1,1592 9972,1591.2 10076,1562.2 10194,1536.6 10287,1518"];
		l2_exp1_gpu14 -> l2_exp_agg_tp6	[pos="e,10311,1537.5 10155,1593.1 10198,1577.7 10252,1558.6 10301,1540.9"];
		l2_exp2_gpu14 -> l2_exp_agg_tp6	[pos="e,10289,1504.2 9771.2,1593.5 9774.1,1592.7 9777.1,1591.9 9780,1591.2 9947.3,1549.8 10142,1521.8 10279,1505.4"];
		l2_exp3_gpu14 -> l2_exp_agg_tp6	[pos="e,10358,1554.4 10306,1591 10320,1581.6 10334,1571.1 10349,1560.4"];
		l2_exp4_gpu14 -> l2_exp_agg_tp6	[pos="e,10652,1525.1 10941,1593.7 10938,1592.8 10935,1592 10932,1591.2 10845,1566.7 10747,1544.6 10662,1527.1"];
		l2_exp5_gpu14 -> l2_exp_agg_tp6	[pos="e,10452,1554.4 10452,1591 10452,1582.9 10452,1573.8 10452,1564.5"];
		l2_exp6_gpu14 -> l2_exp_agg_tp6	[pos="e,10640,1554.2 10749,1593.1 10719,1582.5 10685,1570.1 10650,1557.7"];
		l2_exp7_gpu14 -> l2_exp_agg_tp6	[pos="e,10546,1554.4 10598,1591 10584,1581.6 10570,1571.1 10555,1560.4"];
		l2_exp_agg_tp6 -> l2_final_res_tp6	[pos="e,10453,1381.3 10453,1418.1 10453,1409.4 10453,1400.5 10453,1391.6"];
		l3_qkv_tp6	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 14",
			pos="10450,1174.2",
			shape=rectangle,
			width=3.1389];
		l2_final_res_tp6 -> l3_qkv_tp6	[pos="e,10451,1208.3 10452,1244.9 10452,1235.9 10452,1227 10451,1218.6"];
		l3_residual_tp6	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14",
			pos="10452,825.17",
			width=9.9643];
		l2_final_res_tp6 -> l3_residual_tp6	[pos="e,10551,893.47 10551,1245 10569,1225.2 10582,1201.7 10582,1175.2 10582,1175.2 10582,1175.2 10582,963.17 10582,940.14 10572,919.43 \
10558,901.5"];
		l2_qkv_tp7	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 15",
			pos="12030,2286.2",
			shape=rectangle,
			width=3.1389];
		l2_attn_tp7	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 15",
			pos="12021,2181.2",
			shape=rectangle,
			width=2.9722];
		l2_qkv_tp7 -> l2_attn_tp7	[pos="e,12024,2215.3 12027,2252 12026,2243.6 12026,2234.3 12025,2225.5"];
		l2_residual_tp7	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15",
			pos="12121,1937.2",
			width=9.9643];
		l2_qkv_tp7 -> l2_residual_tp7	[pos="e,12144,2005.4 12102,2252 12116,2242.2 12129,2230 12137,2215.2 12170,2154 12161,2073.7 12146,2015.3"];
		l2_out_proj_tp7	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15",
			pos="12022,2076.2",
			shape=rectangle,
			width=2.9444];
		l2_attn_tp7 -> l2_out_proj_tp7	[pos="e,12022,2110.3 12021,2147 12021,2138.6 12021,2129.3 12022,2120.5"];
		l2_out_proj_tp7 -> l2_residual_tp7	[pos="e,12072,2005.4 12046,2042 12052,2033.3 12059,2023.6 12066,2013.7"];
		l2_gate_tp7	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 15",
			pos="11954,1764.2",
			width=5.7597];
		l2_residual_tp7 -> l2_gate_tp7	[pos="e,12020,1832.3 12055,1869.1 12046,1859.5 12036,1849.5 12027,1839.8"];
		l2_exp0_gpu15	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15",
			pos="11624,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp7 -> l2_exp0_gpu15	[pos="e,11630,1659.5 11780,1869 11749,1858 11724,1845.7 11710,1832.2 11665,1787.3 11642,1715.3 11632,1669.4"];
		l2_exp1_gpu15	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15",
			pos="11432,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp7 -> l2_exp1_gpu15	[pos="e,11455,1659.5 11786,1891.9 11734,1877.3 11681,1857.9 11634,1832.2 11560,1791.5 11496,1715.2 11461,1667.8"];
		l2_exp2_gpu15	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15",
			pos="11240,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp7 -> l2_exp2_gpu15	[pos="e,11267,1659.2 11818,1921.5 11708,1907.5 11584,1881 11479,1832.2 11395,1792.8 11317,1714.9 11274,1666.9"];
		l2_exp3_gpu15	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15",
			pos="11816,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp7 -> l2_exp3_gpu15	[pos="e,11767,1659.2 11796,1869.1 11769,1858.2 11748,1845.8 11738,1832.2 11701,1784.2 11713,1751.4 11738,1696.2 11743,1685.1 11751,1675.1 \
11759,1666.3"];
		l2_exp4_gpu15	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15",
			pos="12392,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp7 -> l2_exp4_gpu15	[pos="e,12363,1659.4 12180,1868.9 12234,1807.4 12311,1718.5 12356,1667.1"];
		l2_exp5_gpu15	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15",
			pos="12584,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp7 -> l2_exp5_gpu15	[pos="e,12535,1659.3 12221,1869.1 12314,1806.8 12450,1716.1 12526,1665"];
		l2_exp6_gpu15	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15",
			pos="12200,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp7 -> l2_exp6_gpu15	[pos="e,12204,1659.4 12177,1869 12180,1863.2 12183,1857.2 12185,1851.2 12207,1791.1 12207,1715.9 12204,1669.5"];
		l2_exp7_gpu15	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15",
			pos="12008,1625.2",
			shape=rectangle,
			width=2.4167];
		l2_residual_tp7 -> l2_exp7_gpu15	[pos="e,12095,1659 12158,1868.9 12163,1857 12167,1844.4 12170,1832.2 12177,1802.7 12187,1721.4 12170,1696.2 12166,1689.4 12137,1676.1 \
12105,1662.9"];
		l2_final_res_tp7	[height=1.8889,
			label="Layer 2 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15",
			pos="12029,1313.2",
			width=9.9643];
		l2_residual_tp7 -> l2_final_res_tp7	[pos="e,12344,1340.7 12373,1905.9 12525,1880.3 12690,1836.2 12690,1765.2 12690,1765.2 12690,1765.2 12690,1485.2 12690,1408.5 12521,1365.7 \
12354,1342.1"];
		l2_gate_tp7 -> l2_exp0_gpu15	[pos="e,11704,1659.2 11792,1696.1 11765,1684.7 11738,1673.3 11713,1663.1",
			style=dashed];
		l2_gate_tp7 -> l2_exp1_gpu15	[pos="e,11519,1656.6 11757,1713.2 11709,1701.1 11657,1688.5 11609,1677.2 11576,1669.4 11565,1669.2 11529,1659.3",
			style=dashed];
		l2_gate_tp7 -> l2_exp2_gpu15	[pos="e,11327,1656.8 11775,1740.9 11653,1724 11489,1697.4 11337,1659.3",
			style=dashed];
		l2_gate_tp7 -> l2_exp3_gpu15	[pos="e,11849,1659.3 11886,1695.9 11876,1685.8 11866,1675.8 11857,1666.5",
			style=dashed];
		l2_gate_tp7 -> l2_exp4_gpu15	[pos="e,12305,1656.3 12093,1722.2 12152,1704.3 12223,1682.7 12295,1659.4",
			style=dashed];
		l2_gate_tp7 -> l2_exp5_gpu15	[pos="e,12497,1656.7 12104,1739.7 12209,1721.9 12353,1694.9 12487,1659.4",
			style=dashed];
		l2_gate_tp7 -> l2_exp6_gpu15	[pos="e,12141,1659.2 12074,1696.1 12094,1685.2 12114,1674.2 12132,1664.3",
			style=dashed];
		l2_gate_tp7 -> l2_exp7_gpu15	[pos="e,11995,1659.3 11981,1695.9 11984,1686.6 11988,1677.4 11991,1668.7",
			style=dashed];
		l2_exp_agg_tp7	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 15",
			pos="12008,1486.2",
			width=6.1053];
		l2_exp0_gpu15 -> l2_exp_agg_tp7	[pos="e,11867,1537.5 11711,1593.1 11754,1577.7 11808,1558.6 11857,1540.9"];
		l2_exp1_gpu15 -> l2_exp_agg_tp7	[pos="e,11853,1516 11519,1593.7 11522,1592.8 11525,1592 11528,1591.2 11632,1562.2 11750,1536.6 11843,1518"];
		l2_exp2_gpu15 -> l2_exp_agg_tp7	[pos="e,11845,1504.2 11327,1593.5 11330,1592.7 11333,1591.9 11336,1591.2 11503,1549.8 11698,1521.8 11835,1505.4"];
		l2_exp3_gpu15 -> l2_exp_agg_tp7	[pos="e,11914,1554.4 11862,1591 11876,1581.6 11890,1571.1 11905,1560.4"];
		l2_exp4_gpu15 -> l2_exp_agg_tp7	[pos="e,12196,1554.2 12305,1593.1 12275,1582.5 12241,1570.1 12206,1557.7"];
		l2_exp5_gpu15 -> l2_exp_agg_tp7	[pos="e,12208,1525.1 12497,1593.7 12494,1592.8 12491,1592 12488,1591.2 12401,1566.7 12303,1544.6 12218,1527.1"];
		l2_exp6_gpu15 -> l2_exp_agg_tp7	[pos="e,12102,1554.4 12154,1591 12140,1581.6 12126,1571.1 12111,1560.4"];
		l2_exp7_gpu15 -> l2_exp_agg_tp7	[pos="e,12008,1554.4 12008,1591 12008,1582.9 12008,1573.8 12008,1564.5"];
		l2_exp_agg_tp7 -> l2_final_res_tp7	[pos="e,12021,1381.3 12016,1418.1 12017,1409.3 12018,1400.3 12020,1391.3"];
		l3_qkv_tp7	[fillcolor=lightgreen,
			height=0.94444,
			label="QKV Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,16,512]\nGPU: 15",
			pos="11925,1174.2",
			shape=rectangle,
			width=3.1389];
		l2_final_res_tp7 -> l3_qkv_tp7	[pos="e,11950,1208.3 11978,1244.9 11971,1235.1 11963,1225.4 11956,1216.3"];
		l3_residual_tp7	[height=1.8889,
			label="Residual Add\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15",
			pos="11994,825.17",
			width=9.9643];
		l2_final_res_tp7 -> l3_residual_tp7	[pos="e,12039,893.5 12048,1245.1 12053,1223 12057,1198.2 12057,1175.2 12057,1175.2 12057,1175.2 12057,963.17 12057,942.58 12051,921.72 \
12043,902.69"];
		l3_attn_tp0	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 8",
			pos="1054,1069.2",
			shape=rectangle,
			width=2.9722];
		l3_qkv_tp0 -> l3_attn_tp0	[pos="e,1053,1103.3 1052,1140 1052.2,1131.6 1052.5,1122.3 1052.7,1113.5"];
		l3_out_proj_tp0	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8",
			pos="1057,964.17",
			shape=rectangle,
			width=2.9444];
		l3_attn_tp0 -> l3_out_proj_tp0	[pos="e,1056,998.26 1055,1035 1055.2,1026.6 1055.5,1017.3 1055.7,1008.5"];
		l3_out_proj_tp0 -> l3_residual_tp0	[pos="e,1069.2,893.4 1062.8,930 1064.2,921.86 1065.8,912.8 1067.4,903.52"];
		l3_gate_tp0	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 8",
			pos="1116,652.17",
			width=5.7597];
		l3_residual_tp0 -> l3_gate_tp0	[pos="e,1102.2,720.35 1094.7,757.07 1096.5,748.3 1098.4,739.26 1100.2,730.34"];
		l3_exp0_gpu8	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8",
			pos="1116,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp0 -> l3_exp0_gpu8	[pos="e,1028.9,544.24 931.05,757.08 918.82,746.37 908.08,734.12 900,720.17 869.72,667.85 864.1,632.8 900,584.17 931.33,541.72 963.24,561.92 \
1019,547.17"];
		l3_exp1_gpu8	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8",
			pos="924,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp0 -> l3_exp1_gpu8	[pos="e,894.49,547.52 906.29,756.9 893.98,746.33 883.21,734.16 875,720.17 844.41,668.03 856.83,641.81 875,584.17 878.08,574.4 883.06,564.82 \
888.69,556.03"];
		l3_exp2_gpu8	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8",
			pos="348,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp0 -> l3_exp2_gpu8	[pos="e,377.56,547.38 738.97,772.98 689.34,759.31 639.9,742.02 595,720.17 509.93,678.76 429.27,601.93 384.45,554.7"];
		l3_exp3_gpu8	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8",
			pos="540,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp0 -> l3_exp3_gpu8	[pos="e,566.81,547.5 833.04,757.07 806.97,746.3 781.45,734.04 758,720.17 683.02,675.8 612.92,601.43 573.36,555.23"];
		l3_exp4_gpu8	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8",
			pos="732,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp0 -> l3_exp4_gpu8	[pos="e,745.23,547.43 898.45,757.13 881.54,746.4 865.66,734.14 852,720.17 804.82,671.92 769.06,601.57 749.32,556.85"];
		l3_exp5_gpu8	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8",
			pos="1500,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp0 -> l3_exp5_gpu8	[pos="e,1484.4,547.26 1287,757.13 1299,751.49 1310.8,745.5 1322,739.17 1397,696.72 1452,608.8 1479.7,556.31"];
		l3_exp6_gpu8	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8",
			pos="1692,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp0 -> l3_exp6_gpu8	[pos="e,1655.4,547.51 1303,765.95 1340.5,752.92 1378.5,737.67 1413,720.17 1503.1,674.41 1595,600.07 1647.6,554.32"];
		l3_exp7_gpu8	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 8",
			pos="1308,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp0 -> l3_exp7_gpu8	[pos="e,1324.2,547.25 1295.1,759 1309.3,748.01 1322,735.17 1332,720.17 1364.6,671.36 1346,601.16 1328.1,556.62"];
		l3_final_res_tp0	[height=1.8889,
			label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 8",
			pos="1798,201.17",
			width=9.9643];
		l3_residual_tp0 -> l3_final_res_tp0	[pos="e,1798,269.58 1350,809.67 1553.5,791.07 1798,748.82 1798,653.17 1798,653.17 1798,653.17 1798,373.17 1798,342.63 1798,309.02 1798,\
279.74"];
		l3_gate_tp0 -> l3_exp0_gpu8	[pos="e,1116,547.29 1116,583.87 1116,574.93 1116,565.95 1116,557.56",
			style=dashed];
		l3_gate_tp0 -> l3_exp1_gpu8	[pos="e,970.58,547.41 1022,584.07 1007.2,573.52 992.32,562.92 978.81,553.28",
			style=dashed];
		l3_gate_tp0 -> l3_exp2_gpu8	[pos="e,435.18,544.87 938.86,632.46 804.9,616.27 616.74,589.13 444.91,547.26",
			style=dashed];
		l3_gate_tp0 -> l3_exp3_gpu8	[pos="e,627.16,544.96 916.59,596.86 870.02,585.34 820.46,574.01 774,565.17 716.2,554.17 697.98,560.59 636.91,547.19",
			style=dashed];
		l3_gate_tp0 -> l3_exp4_gpu8	[pos="e,819.26,545.3 927.94,584.07 893.64,571.84 859.18,559.54 828.93,548.75",
			style=dashed];
		l3_gate_tp0 -> l3_exp5_gpu8	[pos="e,1412.8,545.28 1250.6,603.15 1300.8,585.22 1356.9,565.23 1403.1,548.74",
			style=dashed];
		l3_gate_tp0 -> l3_exp6_gpu8	[pos="e,1604.8,544.64 1263.4,623.91 1356.3,605.61 1478.7,579.45 1595,547.36",
			style=dashed];
		l3_gate_tp0 -> l3_exp7_gpu8	[pos="e,1261.4,547.41 1210,584.07 1224.8,573.52 1239.7,562.92 1253.2,553.28",
			style=dashed];
		l3_exp_agg_tp0	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 8",
			pos="1116,374.17",
			width=6.1053];
		l3_exp0_gpu8 -> l3_exp_agg_tp0	[pos="e,1116,442.4 1116,479 1116,470.86 1116,461.8 1116,452.52"];
		l3_exp1_gpu8 -> l3_exp_agg_tp0	[pos="e,1021.8,442.4 970.48,479 983.59,469.65 998.39,459.08 1013.4,448.36"];
		l3_exp2_gpu8 -> l3_exp_agg_tp0	[pos="e,953.16,392.16 435.18,481.46 438.15,480.65 441.09,479.89 444,479.17 611.29,437.82 806.29,409.81 943.01,393.37"];
		l3_exp3_gpu8 -> l3_exp_agg_tp0	[pos="e,960.85,403.96 627.24,481.69 630.19,480.82 633.11,479.97 636,479.17 739.61,450.24 857.66,424.57 950.77,405.97"];
		l3_exp4_gpu8 -> l3_exp_agg_tp0	[pos="e,974.99,425.48 819.14,481.08 862.38,465.65 915.85,446.57 965.45,428.88"];
		l3_exp5_gpu8 -> l3_exp_agg_tp0	[pos="e,1303.9,442.21 1412.9,481.08 1383.1,470.47 1348.6,458.14 1313.7,445.71"];
		l3_exp6_gpu8 -> l3_exp_agg_tp0	[pos="e,1316.4,413.09 1604.8,481.69 1601.8,480.82 1598.9,479.97 1596,479.17 1508.5,454.74 1410.7,432.64 1326.3,415.15"];
		l3_exp7_gpu8 -> l3_exp_agg_tp0	[pos="e,1210.2,442.4 1261.5,479 1248.4,469.65 1233.6,459.08 1218.6,448.36"];
		l3_exp_agg_tp0 -> l3_final_res_tp0	[pos="e,1574.2,258.29 1265.7,335.64 1353.1,313.71 1465.4,285.55 1564.3,260.76"];
		l3_attn_tp1	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 9",
			pos="2688,1069.2",
			shape=rectangle,
			width=2.9722];
		l3_qkv_tp1 -> l3_attn_tp1	[pos="e,2687,1103.3 2686,1140 2686.2,1131.6 2686.5,1122.3 2686.7,1113.5"];
		l3_out_proj_tp1	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9",
			pos="2691,964.17",
			shape=rectangle,
			width=2.9444];
		l3_attn_tp1 -> l3_out_proj_tp1	[pos="e,2690,998.26 2689,1035 2689.2,1026.6 2689.5,1017.3 2689.7,1008.5"];
		l3_out_proj_tp1 -> l3_residual_tp1	[pos="e,2739.4,893.4 2714,930 2720,921.34 2726.7,911.64 2733.6,901.74"];
		l3_gate_tp1	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 9",
			pos="2618,652.17",
			width=5.7597];
		l3_residual_tp1 -> l3_gate_tp1	[pos="e,2684,720.35 2720.1,757.07 2710.6,747.46 2700.9,737.51 2691.3,727.76"];
		l3_exp0_gpu9	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9",
			pos="2480,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp1 -> l3_exp0_gpu9	[pos="e,2430.5,547.23 2460.6,757.16 2433.5,746.2 2412.5,733.88 2402,720.17 2365.3,672.16 2377.4,639.37 2402,584.17 2406.9,573.13 2414.5,\
563.11 2423.1,554.32"];
		l3_exp1_gpu9	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9",
			pos="3056,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp1 -> l3_exp1_gpu9	[pos="e,3027,547.45 2844.6,756.9 2898.1,695.42 2975.6,606.47 3020.4,555.06"];
		l3_exp2_gpu9	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9",
			pos="2288,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp1 -> l3_exp2_gpu9	[pos="e,2293.7,547.46 2444,757.08 2412.7,746.03 2387.6,733.7 2374,720.17 2328.9,675.28 2306.3,603.3 2295.9,557.4"];
		l3_exp3_gpu9	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9",
			pos="2096,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp1 -> l3_exp3_gpu9	[pos="e,2118.8,547.53 2452.1,780.35 2398.6,765.71 2345.4,746.19 2298,720.17 2224.1,679.54 2160,603.23 2124.8,555.76"];
		l3_exp4_gpu9	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9",
			pos="1904,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp1 -> l3_exp4_gpu9	[pos="e,1931.4,547.24 2483.4,809.67 2372.4,795.59 2248.2,769.16 2143,720.17 2058.6,680.84 1980.9,602.88 1938.2,554.95"];
		l3_exp5_gpu9	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9",
			pos="3248,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp1 -> l3_exp5_gpu9	[pos="e,3198.6,547.29 2886,757.09 2978.8,694.78 3113.9,604.14 3190.1,553.02"];
		l3_exp6_gpu9	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9",
			pos="2864,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp1 -> l3_exp6_gpu9	[pos="e,2867.5,547.4 2840.8,756.99 2844,751.17 2846.8,745.2 2849,739.17 2871.1,679.04 2871.1,603.86 2868.2,557.43"];
		l3_exp7_gpu9	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 9",
			pos="2672,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp1 -> l3_exp7_gpu9	[pos="e,2759.1,547.04 2822,757.11 2827,745.11 2831.3,732.5 2834,720.17 2840.5,690.65 2850.6,609.42 2834,584.17 2829.5,577.35 2800.7,564.09 \
2768.6,550.93"];
		l3_final_res_tp1	[height=1.8889,
			label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 9",
			pos="3354,201.17",
			width=9.9643];
		l3_residual_tp1 -> l3_final_res_tp1	[pos="e,3354,269.58 3038,793.75 3189.8,768.12 3354,724.03 3354,653.17 3354,653.17 3354,653.17 3354,373.17 3354,342.63 3354,309.02 3354,\
279.74"];
		l3_gate_tp1 -> l3_exp0_gpu9	[pos="e,2513.4,547.29 2550.2,583.87 2540.1,573.83 2530,563.76 2520.6,554.51",
			style=dashed];
		l3_gate_tp1 -> l3_exp1_gpu9	[pos="e,2968.9,544.25 2756.9,610.17 2816.5,592.27 2887.1,570.67 2959.2,547.4",
			style=dashed];
		l3_gate_tp1 -> l3_exp2_gpu9	[pos="e,2367.6,547.23 2456.4,584.07 2429,572.71 2401.5,561.3 2376.9,551.08",
			style=dashed];
		l3_gate_tp1 -> l3_exp3_gpu9	[pos="e,2183,544.46 2425.6,608.15 2355,591.37 2274.4,571.05 2192.9,547.37",
			style=dashed];
		l3_gate_tp1 -> l3_exp4_gpu9	[pos="e,1991.2,544.82 2438.6,628.92 2317,611.96 2153,585.39 2001.2,547.34",
			style=dashed];
		l3_gate_tp1 -> l3_exp5_gpu9	[pos="e,3160.8,544.72 2767.7,627.73 2872.9,609.92 3016.6,582.86 3150.7,547.4",
			style=dashed];
		l3_gate_tp1 -> l3_exp6_gpu9	[pos="e,2804.6,547.23 2738.5,584.07 2758.1,573.16 2777.7,562.2 2795.5,552.3",
			style=dashed];
		l3_gate_tp1 -> l3_exp7_gpu9	[pos="e,2658.9,547.29 2644.5,583.87 2648.2,574.63 2651.8,565.35 2655.2,556.73",
			style=dashed];
		l3_exp_agg_tp1	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 9",
			pos="2672,374.17",
			width=6.1053];
		l3_exp0_gpu9 -> l3_exp_agg_tp1	[pos="e,2577.8,442.4 2526.5,479 2539.6,469.65 2554.4,459.08 2569.4,448.36"];
		l3_exp1_gpu9 -> l3_exp_agg_tp1	[pos="e,2859.9,442.21 2968.9,481.08 2939.1,470.47 2904.6,458.14 2869.7,445.71"];
		l3_exp2_gpu9 -> l3_exp_agg_tp1	[pos="e,2531,425.48 2375.1,481.08 2418.4,465.65 2471.9,446.57 2521.5,428.88"];
		l3_exp3_gpu9 -> l3_exp_agg_tp1	[pos="e,2516.8,403.96 2183.2,481.69 2186.2,480.82 2189.1,479.97 2192,479.17 2295.6,450.24 2413.7,424.57 2506.8,405.97"];
		l3_exp4_gpu9 -> l3_exp_agg_tp1	[pos="e,2509.2,392.16 1991.2,481.46 1994.1,480.65 1997.1,479.89 2000,479.17 2167.3,437.82 2362.3,409.81 2499,393.37"];
		l3_exp5_gpu9 -> l3_exp_agg_tp1	[pos="e,2872.4,413.09 3160.8,481.69 3157.8,480.82 3154.9,479.97 3152,479.17 3064.5,454.74 2966.7,432.64 2882.3,415.15"];
		l3_exp6_gpu9 -> l3_exp_agg_tp1	[pos="e,2766.2,442.4 2817.5,479 2804.4,469.65 2789.6,459.08 2774.6,448.36"];
		l3_exp7_gpu9 -> l3_exp_agg_tp1	[pos="e,2672,442.4 2672,479 2672,470.86 2672,461.8 2672,452.52"];
		l3_exp_agg_tp1 -> l3_final_res_tp1	[pos="e,3130.2,258.29 2821.7,335.64 2909.1,313.71 3021.4,285.55 3120.3,260.76"];
		l3_attn_tp2	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 10",
			pos="4167,1069.2",
			shape=rectangle,
			width=2.9722];
		l3_qkv_tp2 -> l3_attn_tp2	[pos="e,4165.4,1103.3 4163.6,1140 4164,1131.6 4164.5,1122.3 4164.9,1113.5"];
		l3_out_proj_tp2	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10",
			pos="4168,964.17",
			shape=rectangle,
			width=2.9444];
		l3_attn_tp2 -> l3_out_proj_tp2	[pos="e,4167.7,998.26 4167.3,1035 4167.4,1026.6 4167.5,1017.3 4167.6,1008.5"];
		l3_out_proj_tp2 -> l3_residual_tp2	[pos="e,4174.1,893.4 4170.9,930 4171.6,921.86 4172.4,912.8 4173.2,903.52"];
		l3_gate_tp2	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 10",
			pos="4228,652.17",
			width=5.7597];
		l3_residual_tp2 -> l3_gate_tp2	[pos="e,4209.1,720.35 4198.8,757.07 4201.3,748.21 4203.9,739.07 4206.4,730.06"];
		l3_exp0_gpu10	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10",
			pos="3460,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp2 -> l3_exp0_gpu10	[pos="e,3489.6,547.31 3832.7,768.05 3789.3,755.2 3746.4,739.46 3707,720.17 3622,678.52 3541.3,601.76 3496.5,554.61"];
		l3_exp1_gpu10	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10",
			pos="4036,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp2 -> l3_exp1_gpu10	[pos="e,4006.5,547.52 4018.1,757.04 4005.8,746.39 3995.1,734.17 3987,720.17 3956.7,667.84 3968.8,641.81 3987,584.17 3990.1,574.4 3995.1,\
564.82 4000.7,556.03"];
		l3_exp2_gpu10	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10",
			pos="4228,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp2 -> l3_exp2_gpu10	[pos="e,4140.9,544.24 4041.8,756.86 4030,746.14 4019.7,733.95 4012,720.17 3982.6,667.36 3976.1,632.8 4012,584.17 4043.3,541.72 4075.2,\
561.92 4131,547.17"];
		l3_exp3_gpu10	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10",
			pos="3652,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp2 -> l3_exp3_gpu10	[pos="e,3678.9,547.36 3943.7,757.01 3918.1,746.21 3893,733.97 3870,720.17 3795.3,675.34 3725.1,601.11 3685.5,555.06"];
		l3_exp4_gpu10	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10",
			pos="3844,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp2 -> l3_exp4_gpu10	[pos="e,3857.2,547.43 4010,757.01 3993.3,746.25 3977.5,734 3964,720.17 3916.8,671.92 3881.1,601.57 3861.3,556.85"];
		l3_exp5_gpu10	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10",
			pos="4420,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp2 -> l3_exp5_gpu10	[pos="e,4436.3,547.34 4399.7,764.14 4416.9,752.07 4432.1,737.57 4444,720.17 4477,671.64 4458.3,601.37 4440.3,556.74"];
		l3_exp6_gpu10	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10",
			pos="4804,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp2 -> l3_exp6_gpu10	[pos="e,4767.9,547.27 4404.7,768.66 4445.7,755.13 4487.4,739.01 4525,720.17 4615.6,674.77 4707.7,599.99 4760.2,554.1"];
		l3_exp7_gpu10	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 10",
			pos="4612,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp2 -> l3_exp7_gpu10	[pos="e,4596.7,547.35 4393.4,758.18 4407,752.23 4420.3,745.89 4433,739.17 4509.6,698.62 4564.6,609.62 4592.1,556.51"];
		l3_final_res_tp2	[height=1.8889,
			label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 10",
			pos="4910,201.17",
			width=9.9643];
		l3_residual_tp2 -> l3_final_res_tp2	[pos="e,4910,269.58 4450.3,810.84 4658.1,792.93 4910,751.04 4910,653.17 4910,653.17 4910,653.17 4910,373.17 4910,342.63 4910,309.02 4910,\
279.74"];
		l3_gate_tp2 -> l3_exp0_gpu10	[pos="e,3547.2,544.87 4050.9,632.46 3916.9,616.27 3728.7,589.13 3556.9,547.26",
			style=dashed];
		l3_gate_tp2 -> l3_exp1_gpu10	[pos="e,4082.6,547.41 4134,584.07 4119.2,573.52 4104.3,562.92 4090.8,553.28",
			style=dashed];
		l3_gate_tp2 -> l3_exp2_gpu10	[pos="e,4228,547.29 4228,583.87 4228,574.93 4228,565.95 4228,557.56",
			style=dashed];
		l3_gate_tp2 -> l3_exp3_gpu10	[pos="e,3739.2,544.64 4037.4,610.98 3925.1,587.13 3797.2,559.59 3749.2,547.3",
			style=dashed];
		l3_gate_tp2 -> l3_exp4_gpu10	[pos="e,3931.3,545.3 4039.9,584.07 4005.6,571.84 3971.2,559.54 3940.9,548.75",
			style=dashed];
		l3_gate_tp2 -> l3_exp5_gpu10	[pos="e,4366.6,547.27 4314,583.97 4322.7,577.51 4331.5,571.15 4340,565.17 4345.8,561.07 4352,556.9 4358.2,552.8",
			style=dashed];
		l3_gate_tp2 -> l3_exp6_gpu10	[pos="e,4716.8,544.64 4375.4,623.91 4468.3,605.61 4590.7,579.45 4707,547.36",
			style=dashed];
		l3_gate_tp2 -> l3_exp7_gpu10	[pos="e,4524.8,545.28 4362.6,603.15 4412.8,585.22 4468.9,565.23 4515.1,548.74",
			style=dashed];
		l3_exp_agg_tp2	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 10",
			pos="4228,374.17",
			width=6.1053];
		l3_exp0_gpu10 -> l3_exp_agg_tp2	[pos="e,4065.2,392.16 3547.2,481.46 3550.1,480.65 3553.1,479.89 3556,479.17 3723.3,437.82 3918.3,409.81 4055,393.37"];
		l3_exp1_gpu10 -> l3_exp_agg_tp2	[pos="e,4133.8,442.4 4082.5,479 4095.6,469.65 4110.4,459.08 4125.4,448.36"];
		l3_exp2_gpu10 -> l3_exp_agg_tp2	[pos="e,4228,442.4 4228,479 4228,470.86 4228,461.8 4228,452.52"];
		l3_exp3_gpu10 -> l3_exp_agg_tp2	[pos="e,4072.8,403.96 3739.2,481.69 3742.2,480.82 3745.1,479.97 3748,479.17 3851.6,450.24 3969.7,424.57 4062.8,405.97"];
		l3_exp4_gpu10 -> l3_exp_agg_tp2	[pos="e,4087,425.48 3931.1,481.08 3974.4,465.65 4027.9,446.57 4077.5,428.88"];
		l3_exp5_gpu10 -> l3_exp_agg_tp2	[pos="e,4322.2,442.4 4373.5,479 4360.4,469.65 4345.6,459.08 4330.6,448.36"];
		l3_exp6_gpu10 -> l3_exp_agg_tp2	[pos="e,4428.4,413.09 4716.8,481.69 4713.8,480.82 4710.9,479.97 4708,479.17 4620.5,454.74 4522.7,432.64 4438.3,415.15"];
		l3_exp7_gpu10 -> l3_exp_agg_tp2	[pos="e,4415.9,442.21 4524.9,481.08 4495.1,470.47 4460.6,458.14 4425.7,445.71"];
		l3_exp_agg_tp2 -> l3_final_res_tp2	[pos="e,4686.2,258.29 4377.7,335.64 4465.1,313.71 4577.4,285.55 4676.3,260.76"];
		l3_attn_tp3	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 11",
			pos="5832,1069.2",
			shape=rectangle,
			width=2.9722];
		l3_qkv_tp3 -> l3_attn_tp3	[pos="e,5831,1103.3 5830,1140 5830.2,1131.6 5830.5,1122.3 5830.7,1113.5"];
		l3_out_proj_tp3	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11",
			pos="5834,964.17",
			shape=rectangle,
			width=2.9444];
		l3_attn_tp3 -> l3_out_proj_tp3	[pos="e,5833.4,998.26 5832.6,1035 5832.8,1026.6 5833,1017.3 5833.2,1008.5"];
		l3_out_proj_tp3 -> l3_residual_tp3	[pos="e,5866.1,893.4 5849.3,930 5853.1,921.6 5857.4,912.22 5861.8,902.63"];
		l3_gate_tp3	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 11",
			pos="5730,652.17",
			width=5.7597];
		l3_residual_tp3 -> l3_gate_tp3	[pos="e,5795.6,720.35 5831.5,757.07 5822.1,747.46 5812.4,737.51 5802.8,727.76"];
		l3_exp0_gpu11	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11",
			pos="5208,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp3 -> l3_exp0_gpu11	[pos="e,5230.8,547.53 5562.5,779.92 5509.5,765.34 5456.9,745.94 5410,720.17 5336.1,679.52 5272,603.22 5236.8,555.75"];
		l3_exp1_gpu11	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11",
			pos="5016,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp3 -> l3_exp1_gpu11	[pos="e,5043.4,547.23 5594.5,809.55 5483.7,795.45 5359.9,769.04 5255,720.17 5170.6,680.83 5092.9,602.87 5050.2,554.95"];
		l3_exp2_gpu11	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11",
			pos="6360,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp3 -> l3_exp2_gpu11	[pos="e,6310.5,547.29 5997.2,757.09 6090.2,694.78 6225.6,604.14 6302,553.02"];
		l3_exp3_gpu11	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11",
			pos="5976,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp3 -> l3_exp3_gpu11	[pos="e,5979.6,547.43 5952.7,757.05 5955.9,751.22 5958.7,745.23 5961,739.17 5983.3,679.12 5983.2,603.92 5980.3,557.46"];
		l3_exp4_gpu11	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11",
			pos="5400,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp3 -> l3_exp4_gpu11	[pos="e,5405.7,547.46 5555.8,757.03 5524.6,745.98 5499.6,733.67 5486,720.17 5440.9,675.28 5418.3,603.3 5407.9,557.4"];
		l3_exp5_gpu11	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11",
			pos="5592,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp3 -> l3_exp5_gpu11	[pos="e,5542.5,547.23 5572.4,757.1 5545.4,746.16 5524.5,733.85 5514,720.17 5477.3,672.15 5489.4,639.37 5514,584.17 5518.9,573.13 5526.5,\
563.11 5535.1,554.32"];
		l3_exp6_gpu11	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11",
			pos="6168,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp3 -> l3_exp6_gpu11	[pos="e,6138.9,547.45 5955.8,756.9 6009.6,695.42 6087.3,606.47 6132.2,555.06"];
		l3_exp7_gpu11	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 11",
			pos="5784,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp3 -> l3_exp7_gpu11	[pos="e,5871.1,547.04 5933.9,756.89 5938.9,744.97 5943.3,732.44 5946,720.17 5952.6,690.67 5962.6,609.42 5946,584.17 5941.5,577.35 5912.7,\
564.09 5880.6,550.93"];
		l3_final_res_tp3	[height=1.8889,
			label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 11",
			pos="6466,201.17",
			width=9.9643];
		l3_residual_tp3 -> l3_final_res_tp3	[pos="e,6466,269.58 6149.1,793.89 6301.3,768.31 6466,724.21 6466,653.17 6466,653.17 6466,653.17 6466,373.17 6466,342.63 6466,309.02 6466,\
279.74"];
		l3_gate_tp3 -> l3_exp0_gpu11	[pos="e,5295,544.46 5537.6,608.15 5467,591.37 5386.4,571.05 5304.9,547.37",
			style=dashed];
		l3_gate_tp3 -> l3_exp1_gpu11	[pos="e,5103.2,544.82 5550.6,628.92 5429,611.96 5265,585.39 5113.2,547.34",
			style=dashed];
		l3_gate_tp3 -> l3_exp2_gpu11	[pos="e,6272.8,544.72 5879.7,627.73 5984.9,609.92 6128.6,582.86 6262.7,547.4",
			style=dashed];
		l3_gate_tp3 -> l3_exp3_gpu11	[pos="e,5916.6,547.23 5850.5,584.07 5870.1,573.16 5889.7,562.2 5907.5,552.3",
			style=dashed];
		l3_gate_tp3 -> l3_exp4_gpu11	[pos="e,5479.6,547.23 5568.4,584.07 5541,572.71 5513.5,561.3 5488.9,551.08",
			style=dashed];
		l3_gate_tp3 -> l3_exp5_gpu11	[pos="e,5625.4,547.29 5662.2,583.87 5652.1,573.83 5642,563.76 5632.6,554.51",
			style=dashed];
		l3_gate_tp3 -> l3_exp6_gpu11	[pos="e,6080.9,544.25 5868.9,610.17 5928.5,592.27 5999.1,570.67 6071.2,547.4",
			style=dashed];
		l3_gate_tp3 -> l3_exp7_gpu11	[pos="e,5770.9,547.29 5756.5,583.87 5760.2,574.63 5763.8,565.35 5767.2,556.73",
			style=dashed];
		l3_exp_agg_tp3	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 11",
			pos="5784,374.17",
			width=6.1053];
		l3_exp0_gpu11 -> l3_exp_agg_tp3	[pos="e,5628.8,403.96 5295.2,481.69 5298.2,480.82 5301.1,479.97 5304,479.17 5407.6,450.24 5525.7,424.57 5618.8,405.97"];
		l3_exp1_gpu11 -> l3_exp_agg_tp3	[pos="e,5621.2,392.16 5103.2,481.46 5106.1,480.65 5109.1,479.89 5112,479.17 5279.3,437.82 5474.3,409.81 5611,393.37"];
		l3_exp2_gpu11 -> l3_exp_agg_tp3	[pos="e,5984.4,413.09 6272.8,481.69 6269.8,480.82 6266.9,479.97 6264,479.17 6176.5,454.74 6078.7,432.64 5994.3,415.15"];
		l3_exp3_gpu11 -> l3_exp_agg_tp3	[pos="e,5878.2,442.4 5929.5,479 5916.4,469.65 5901.6,459.08 5886.6,448.36"];
		l3_exp4_gpu11 -> l3_exp_agg_tp3	[pos="e,5643,425.48 5487.1,481.08 5530.4,465.65 5583.9,446.57 5633.5,428.88"];
		l3_exp5_gpu11 -> l3_exp_agg_tp3	[pos="e,5689.8,442.4 5638.5,479 5651.6,469.65 5666.4,459.08 5681.4,448.36"];
		l3_exp6_gpu11 -> l3_exp_agg_tp3	[pos="e,5971.9,442.21 6080.9,481.08 6051.1,470.47 6016.6,458.14 5981.7,445.71"];
		l3_exp7_gpu11 -> l3_exp_agg_tp3	[pos="e,5784,442.4 5784,479 5784,470.86 5784,461.8 5784,452.52"];
		l3_exp_agg_tp3 -> l3_final_res_tp3	[pos="e,6242.2,258.29 5933.7,335.64 6021.1,313.71 6133.4,285.55 6232.3,260.76"];
		l3_attn_tp4	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 12",
			pos="7219,1069.2",
			shape=rectangle,
			width=2.9722];
		l3_qkv_tp4 -> l3_attn_tp4	[pos="e,7218,1103.3 7217,1140 7217.2,1131.6 7217.5,1122.3 7217.7,1113.5"];
		l3_out_proj_tp4	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12",
			pos="7222,964.17",
			shape=rectangle,
			width=2.9444];
		l3_attn_tp4 -> l3_out_proj_tp4	[pos="e,7221,998.26 7220,1035 7220.2,1026.6 7220.5,1017.3 7220.7,1008.5"];
		l3_out_proj_tp4 -> l3_residual_tp4	[pos="e,7256.6,893.4 7238.5,930 7242.6,921.6 7247.3,912.22 7252,902.63"];
		l3_gate_tp4	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 12",
			pos="7340,652.17",
			width=5.7597];
		l3_residual_tp4 -> l3_gate_tp4	[pos="e,7320.4,720.35 7309.6,757.07 7312.2,748.21 7314.9,739.07 7317.5,730.06"];
		l3_exp0_gpu12	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12",
			pos="7148,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp4 -> l3_exp0_gpu12	[pos="e,7118.5,547.52 7129.8,756.8 7117.7,746.2 7107,734.06 7099,720.17 7068.7,667.84 7080.8,641.81 7099,584.17 7102.1,574.4 7107.1,564.82 \
7112.7,556.03"];
		l3_exp1_gpu12	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12",
			pos="6572,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp4 -> l3_exp1_gpu12	[pos="e,6601.6,547.3 6941.7,767.19 6899.3,754.5 6857.4,739.03 6819,720.17 6734.1,678.48 6653.4,601.74 6608.5,554.6"];
		l3_exp2_gpu12	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12",
			pos="7340,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp4 -> l3_exp2_gpu12	[pos="e,7252.9,544.24 7153.8,757.01 7142,746.24 7131.7,734 7124,720.17 7094.7,667.28 7088.1,632.8 7124,584.17 7155.3,541.72 7187.2,561.92 \
7243,547.17"];
		l3_exp3_gpu12	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12",
			pos="7724,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp4 -> l3_exp3_gpu12	[pos="e,7708.8,547.22 7504.4,759.32 7518.7,753.06 7532.7,746.34 7546,739.17 7622.1,698.09 7676.8,609.27 7704.2,556.34"];
		l3_exp4_gpu12	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12",
			pos="7532,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp4 -> l3_exp4_gpu12	[pos="e,7548.4,547.36 7510.7,764.77 7528.3,752.57 7543.9,737.88 7556,720.17 7589.1,671.69 7570.3,601.4 7552.3,556.75"];
		l3_exp5_gpu12	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12",
			pos="6764,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp4 -> l3_exp5_gpu12	[pos="e,6790.9,547.34 7055.6,757.07 7030,746.25 7005,733.98 6982,720.17 6907.3,675.27 6837.1,601.06 6797.5,555.04"];
		l3_exp6_gpu12	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12",
			pos="6956,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp4 -> l3_exp6_gpu12	[pos="e,6969.2,547.43 7122.1,757.15 7105.4,746.34 7089.6,734.05 7076,720.17 7028.8,671.92 6993.1,601.57 6973.3,556.85"];
		l3_exp7_gpu12	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 12",
			pos="7916,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp4 -> l3_exp7_gpu12	[pos="e,7879.9,547.3 7515.1,769.07 7556.6,755.47 7598.9,739.22 7637,720.17 7727.7,674.84 7819.7,600.03 7872.2,554.13"];
		l3_final_res_tp4	[height=1.8889,
			label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 12",
			pos="7236,201.17",
			width=9.9643];
		l3_residual_tp4 -> l3_final_res_tp4	[pos="e,7533.7,212.33 7560.2,811.04 7768.8,793.24 8022,751.41 8022,653.17 8022,653.17 8022,653.17 8022,373.17 8022,270.79 7764.2,229.59 \
7543.8,213.07"];
		l3_gate_tp4 -> l3_exp0_gpu12	[pos="e,7194.6,547.41 7246,584.07 7231.2,573.52 7216.3,562.92 7202.8,553.28",
			style=dashed];
		l3_gate_tp4 -> l3_exp1_gpu12	[pos="e,6659.2,544.87 7162.9,632.46 7028.9,616.27 6840.7,589.13 6668.9,547.26",
			style=dashed];
		l3_gate_tp4 -> l3_exp2_gpu12	[pos="e,7340,547.29 7340,583.87 7340,574.93 7340,565.95 7340,557.56",
			style=dashed];
		l3_gate_tp4 -> l3_exp3_gpu12	[pos="e,7636.8,545.28 7474.6,603.15 7524.8,585.22 7580.9,565.23 7627.1,548.74",
			style=dashed];
		l3_gate_tp4 -> l3_exp4_gpu12	[pos="e,7485.4,547.41 7434,584.07 7448.8,573.52 7463.7,562.92 7477.2,553.28",
			style=dashed];
		l3_gate_tp4 -> l3_exp5_gpu12	[pos="e,6851.2,544.64 7152.4,615.85 7066,598.28 6962.2,575.31 6861,547.36",
			style=dashed];
		l3_gate_tp4 -> l3_exp6_gpu12	[pos="e,7043.3,545.3 7151.9,584.07 7117.6,571.84 7083.2,559.54 7052.9,548.75",
			style=dashed];
		l3_gate_tp4 -> l3_exp7_gpu12	[pos="e,7828.8,544.64 7487.4,623.91 7580.3,605.61 7702.7,579.45 7819,547.36",
			style=dashed];
		l3_exp_agg_tp4	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 12",
			pos="7236,374.17",
			width=6.1053];
		l3_exp0_gpu12 -> l3_exp_agg_tp4	[pos="e,7192.8,442.4 7169.3,479 7174.8,470.43 7181,460.84 7187.3,451.04"];
		l3_exp1_gpu12 -> l3_exp_agg_tp4	[pos="e,7076.7,397.79 6659.2,481.57 6662.2,480.73 6665.1,479.93 6668,479.17 6800.3,444.53 6952.8,417.28 7066.5,399.38"];
		l3_exp2_gpu12 -> l3_exp_agg_tp4	[pos="e,7287,442.4 7314.8,479 7308.2,470.25 7300.7,460.45 7293.1,450.45"];
		l3_exp3_gpu12 -> l3_exp_agg_tp4	[pos="e,7446.3,428 7637,481.94 7633.9,480.99 7631,480.06 7628,479.17 7572.6,462.32 7512.3,445.56 7456.1,430.58"];
		l3_exp4_gpu12 -> l3_exp_agg_tp4	[pos="e,7381,442.26 7460.3,479 7439,469.14 7414.8,457.92 7390.3,446.6"];
		l3_exp5_gpu12 -> l3_exp_agg_tp4	[pos="e,7087.6,413.96 6851,481.98 6854.1,481.02 6857.1,480.08 6860,479.17 6931.1,457.15 7010.4,434.88 7077.8,416.62"];
		l3_exp6_gpu12 -> l3_exp_agg_tp4	[pos="e,7104.4,439.54 7023.8,479 7045.5,468.39 7070.4,456.21 7095.3,444.03"];
		l3_exp7_gpu12 -> l3_exp_agg_tp4	[pos="e,7429,401.84 7828.8,481.55 7825.8,480.72 7822.9,479.92 7820,479.17 7694.9,446.74 7552.2,421.12 7439.1,403.42"];
		l3_exp_agg_tp4 -> l3_final_res_tp4	[pos="e,7236,269.35 7236,306.07 7236,297.4 7236,288.46 7236,279.63"];
		l3_attn_tp5	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 13",
			pos="8913,1069.2",
			shape=rectangle,
			width=2.9722];
		l3_qkv_tp5 -> l3_attn_tp5	[pos="e,8912,1103.3 8911,1140 8911.2,1131.6 8911.5,1122.3 8911.7,1113.5"];
		l3_out_proj_tp5	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13",
			pos="8916,964.17",
			shape=rectangle,
			width=2.9444];
		l3_attn_tp5 -> l3_out_proj_tp5	[pos="e,8915,998.26 8914,1035 8914.2,1026.6 8914.5,1017.3 8914.7,1008.5"];
		l3_out_proj_tp5 -> l3_residual_tp5	[pos="e,8963.9,893.4 8938.8,930 8944.7,921.34 8951.4,911.64 8958.1,901.74"];
		l3_gate_tp5	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 13",
			pos="8842,652.17",
			width=5.7597];
		l3_residual_tp5 -> l3_gate_tp5	[pos="e,8908,720.35 8944.1,757.07 8934.6,747.46 8924.9,737.51 8915.3,727.76"];
		l3_exp0_gpu13	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13",
			pos="8512,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp5 -> l3_exp0_gpu13	[pos="e,8517.7,547.46 8668,757.08 8636.7,746.03 8611.6,733.7 8598,720.17 8552.9,675.28 8530.3,603.3 8519.9,557.4"];
		l3_exp1_gpu13	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13",
			pos="8320,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp5 -> l3_exp1_gpu13	[pos="e,8342.8,547.53 8676.1,780.35 8622.6,765.71 8569.4,746.19 8522,720.17 8448.1,679.54 8384,603.23 8348.8,555.76"];
		l3_exp2_gpu13	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13",
			pos="8704,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp5 -> l3_exp2_gpu13	[pos="e,8654.5,547.23 8684.6,757.16 8657.5,746.2 8636.5,733.88 8626,720.17 8589.3,672.16 8601.4,639.37 8626,584.17 8630.9,573.13 8638.5,\
563.11 8647.1,554.32"];
		l3_exp3_gpu13	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13",
			pos="9280,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp5 -> l3_exp3_gpu13	[pos="e,9251,547.45 9068.6,756.9 9122.1,695.42 9199.6,606.47 9244.4,555.06"];
		l3_exp4_gpu13	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13",
			pos="9088,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp5 -> l3_exp4_gpu13	[pos="e,9091.5,547.4 9064.8,756.99 9068,751.17 9070.8,745.2 9073,739.17 9095.1,679.04 9095.1,603.86 9092.2,557.43"];
		l3_exp5_gpu13	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13",
			pos="8896,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp5 -> l3_exp5_gpu13	[pos="e,8983.1,547.04 9046,757.11 9051,745.11 9055.3,732.5 9058,720.17 9064.5,690.65 9074.6,609.42 9058,584.17 9053.5,577.35 9024.7,564.09 \
8992.6,550.93"];
		l3_exp6_gpu13	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13",
			pos="8128,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp5 -> l3_exp6_gpu13	[pos="e,8155.4,547.24 8707.4,809.67 8596.4,795.59 8472.2,769.16 8367,720.17 8282.6,680.84 8204.9,602.88 8162.2,554.95"];
		l3_exp7_gpu13	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 13",
			pos="9472,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp5 -> l3_exp7_gpu13	[pos="e,9422.6,547.29 9110,757.09 9202.8,694.78 9337.9,604.14 9414.1,553.02"];
		l3_final_res_tp5	[height=1.8889,
			label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 13",
			pos="8776,201.17",
			width=9.9643];
		l3_residual_tp5 -> l3_final_res_tp5	[pos="e,9072.1,210.75 9262,793.75 9413.8,768.12 9578,724.03 9578,653.17 9578,653.17 9578,653.17 9578,373.17 9578,267.56 9308.7,226.93 \
9082.1,211.43"];
		l3_gate_tp5 -> l3_exp0_gpu13	[pos="e,8591.6,547.23 8680.4,584.07 8653,572.71 8625.5,561.3 8600.9,551.08",
			style=dashed];
		l3_gate_tp5 -> l3_exp1_gpu13	[pos="e,8407,544.46 8647.4,604.52 8555,582.22 8457.4,558.42 8416.7,547.22",
			style=dashed];
		l3_gate_tp5 -> l3_exp2_gpu13	[pos="e,8737.4,547.29 8774.2,583.87 8764.1,573.83 8754,563.76 8744.6,554.51",
			style=dashed];
		l3_gate_tp5 -> l3_exp3_gpu13	[pos="e,9192.9,544.25 8980.9,610.17 9040.5,592.27 9111.1,570.67 9183.2,547.4",
			style=dashed];
		l3_gate_tp5 -> l3_exp4_gpu13	[pos="e,9028.6,547.23 8962.5,584.07 8982.1,573.16 9001.7,562.2 9019.5,552.3",
			style=dashed];
		l3_gate_tp5 -> l3_exp5_gpu13	[pos="e,8882.9,547.29 8868.5,583.87 8872.2,574.63 8875.8,565.35 8879.2,556.73",
			style=dashed];
		l3_gate_tp5 -> l3_exp6_gpu13	[pos="e,8215.2,544.82 8662.6,628.92 8541,611.96 8377,585.39 8225.2,547.34",
			style=dashed];
		l3_gate_tp5 -> l3_exp7_gpu13	[pos="e,9384.8,544.72 8989.2,623.59 9125.3,597.92 9314.4,561.79 9374.8,547.25",
			style=dashed];
		l3_exp_agg_tp5	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 13",
			pos="8776,374.17",
			width=6.1053];
		l3_exp0_gpu13 -> l3_exp_agg_tp5	[pos="e,8646.7,442.26 8575.9,479 8594.8,469.22 8616.1,458.12 8637.8,446.9"];
		l3_exp1_gpu13 -> l3_exp_agg_tp5	[pos="e,8628.8,415.9 8407.1,482.03 8410.1,481.05 8413.1,480.1 8416,479.17 8482.2,458.23 8555.8,436.67 8619.1,418.64"];
		l3_exp2_gpu13 -> l3_exp_agg_tp5	[pos="e,8740.7,442.4 8721.4,479 8725.9,470.51 8730.9,461.03 8736,451.34"];
		l3_exp3_gpu13 -> l3_exp_agg_tp5	[pos="e,8984.2,424.76 9193,481.91 9190,480.97 9187,480.05 9184,479.17 9122.8,460.87 9055.7,442.93 8994.1,427.25"];
		l3_exp4_gpu13 -> l3_exp_agg_tp5	[pos="e,8928.8,442.26 9012.5,479 8989.8,469.05 8964,457.73 8938,446.31"];
		l3_exp5_gpu13 -> l3_exp_agg_tp5	[pos="e,8834.9,442.4 8867,479 8859.2,470.17 8850.5,460.25 8841.7,450.15"];
		l3_exp6_gpu13 -> l3_exp_agg_tp5	[pos="e,8617.3,398.8 8215.2,481.59 8218.2,480.74 8221.1,479.93 8224,479.17 8351,445.57 8497.1,418.54 8607.1,400.47"];
		l3_exp7_gpu13 -> l3_exp_agg_tp5	[pos="e,8968.2,400.5 9384.8,481.53 9381.8,480.7 9378.9,479.91 9376,479.17 9245.2,445.57 9095.5,419.6 8978.3,402.02"];
		l3_exp_agg_tp5 -> l3_final_res_tp5	[pos="e,8776,269.35 8776,306.07 8776,297.4 8776,288.46 8776,279.63"];
		l3_attn_tp6	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 14",
			pos="10452,1069.2",
			shape=rectangle,
			width=2.9722];
		l3_qkv_tp6 -> l3_attn_tp6	[pos="e,10451,1103.3 10451,1140 10451,1131.6 10451,1122.3 10451,1113.5"];
		l3_out_proj_tp6	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14",
			pos="10452,964.17",
			shape=rectangle,
			width=2.9444];
		l3_attn_tp6 -> l3_out_proj_tp6	[pos="e,10452,998.26 10452,1035 10452,1026.6 10452,1017.3 10452,1008.5"];
		l3_out_proj_tp6 -> l3_residual_tp6	[pos="e,10452,893.4 10452,930 10452,921.86 10452,912.8 10452,903.52"];
		l3_gate_tp6	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 14",
			pos="10452,652.17",
			width=5.7597];
		l3_residual_tp6 -> l3_gate_tp6	[pos="e,10452,720.35 10452,757.07 10452,748.4 10452,739.46 10452,730.63"];
		l3_exp0_gpu14	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14",
			pos="9876,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp6 -> l3_exp0_gpu14	[pos="e,9902.9,547.39 10177,757.16 10149,746.45 10123,734.17 10098,720.17 10021,676.57 9949.8,601.62 9909.6,555.15"];
		l3_exp1_gpu14	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14",
			pos="10068,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp6 -> l3_exp1_gpu14	[pos="e,10084,547.38 10244,757.03 10227,746.42 10212,734.21 10198,720.17 10150,670.65 10111,600.73 10088,556.43"];
		l3_exp2_gpu14	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14",
			pos="9684,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp6 -> l3_exp2_gpu14	[pos="e,9713.5,547.55 10122,784.07 10057,769.07 9990.2,748.47 9931,720.17 9845.6,679.35 9765.1,602.32 9720.3,554.9"];
		l3_exp3_gpu14	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14",
			pos="10260,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp6 -> l3_exp3_gpu14	[pos="e,10236,547.43 10247,756.82 10236,746.32 10226,734.19 10219,720.17 10192,666.27 10203,642.5 10219,584.17 10222,574.68 10226,565.17 \
10231,556.35"];
		l3_exp4_gpu14	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14",
			pos="11028,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp6 -> l3_exp4_gpu14	[pos="e,10990,547.38 10665,757.67 10693,746.4 10721,733.86 10747,720.17 10837,672.89 10929,599.35 10983,554.12"];
		l3_exp5_gpu14	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14",
			pos="10452,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp6 -> l3_exp5_gpu14	[pos="e,10365,544.24 10269,757.1 10256,746.49 10245,734.26 10236,720.17 10220,694.58 10218,608.48 10236,584.17 10267,541.72 10299,561.92 \
10355,547.17"];
		l3_exp6_gpu14	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14",
			pos="10836,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp6 -> l3_exp6_gpu14	[pos="e,10820,547.41 10627,757.08 10638,751.4 10649,745.42 10659,739.17 10732,694.37 10787,608.06 10815,556.34"];
		l3_exp7_gpu14	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 14",
			pos="10644,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp6 -> l3_exp7_gpu14	[pos="e,10660,547.33 10635,757.1 10648,746.49 10659,734.26 10668,720.17 10699,670.6 10681,600.91 10664,556.65"];
		l3_final_res_tp6	[height=1.8889,
			label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 14",
			pos="10357,201.17",
			width=9.9643];
		l3_residual_tp6 -> l3_final_res_tp6	[pos="e,10656,213.26 10718,806.36 10909,785.95 11134,742.89 11134,653.17 11134,653.17 11134,653.17 11134,373.17 11134,272.59 10883,231.1 \
10666,214.03"];
		l3_gate_tp6 -> l3_exp0_gpu14	[pos="e,9963.2,544.73 10259,607.14 10197,593.34 10128,578.3 10065,565.17 10027,557.2 10014,557.88 9973.1,547.32",
			style=dashed];
		l3_gate_tp6 -> l3_exp1_gpu14	[pos="e,10155,545.3 10264,584.07 10230,571.84 10195,559.54 10165,548.75",
			style=dashed];
		l3_gate_tp6 -> l3_exp2_gpu14	[pos="e,9771.2,544.87 10275,632.46 10141,616.27 9952.7,589.13 9780.9,547.26",
			style=dashed];
		l3_gate_tp6 -> l3_exp3_gpu14	[pos="e,10307,547.41 10358,584.07 10343,573.52 10328,562.92 10315,553.28",
			style=dashed];
		l3_gate_tp6 -> l3_exp4_gpu14	[pos="e,10941,544.64 10599,623.91 10692,605.61 10815,579.45 10931,547.36",
			style=dashed];
		l3_gate_tp6 -> l3_exp5_gpu14	[pos="e,10452,547.29 10452,583.87 10452,574.93 10452,565.95 10452,557.56",
			style=dashed];
		l3_gate_tp6 -> l3_exp6_gpu14	[pos="e,10749,545.28 10587,603.15 10637,585.22 10693,565.23 10739,548.74",
			style=dashed];
		l3_gate_tp6 -> l3_exp7_gpu14	[pos="e,10597,547.41 10546,584.07 10561,573.52 10576,562.92 10589,553.28",
			style=dashed];
		l3_exp_agg_tp6	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 14",
			pos="10357,374.17",
			width=6.1053];
		l3_exp0_gpu14 -> l3_exp_agg_tp6	[pos="e,10208,412.97 9963,481.96 9966.1,481.01 9969.1,480.07 9972,479.17 10046,456.54 10128,433.89 10198,415.54"];
		l3_exp1_gpu14 -> l3_exp_agg_tp6	[pos="e,10224,438.04 10138,479 10161,467.9 10188,455.1 10215,442.36"];
		l3_exp2_gpu14 -> l3_exp_agg_tp6	[pos="e,10197,397.24 9771.2,481.56 9774.2,480.72 9777.1,479.92 9780,479.17 9915.3,443.93 10072,416.57 10187,398.77"];
		l3_exp3_gpu14 -> l3_exp_agg_tp6	[pos="e,10309,442.4 10283,479 10290,470.34 10296,460.64 10303,450.74"];
		l3_exp4_gpu14 -> l3_exp_agg_tp6	[pos="e,10551,402.65 10941,481.56 10938,480.72 10935,479.92 10932,479.17 10810,447.4 10671,421.99 10561,404.24"];
		l3_exp5_gpu14 -> l3_exp_agg_tp6	[pos="e,10404,442.4 10429,479 10423,470.34 10416,460.64 10409,450.74"];
		l3_exp6_gpu14 -> l3_exp_agg_tp6	[pos="e,10569,429.97 10749,481.97 10746,481.01 10743,480.07 10740,479.17 10688,463.19 10632,447.17 10579,432.66"];
		l3_exp7_gpu14 -> l3_exp_agg_tp6	[pos="e,10498,442.26 10575,479 10554,469.14 10530,457.92 10507,446.6"];
		l3_exp_agg_tp6 -> l3_final_res_tp6	[pos="e,10357,269.35 10357,306.07 10357,297.4 10357,288.46 10357,279.63"];
		l3_attn_tp7	[fillcolor=lightgreen,
			height=0.94444,
			label="Multi-Head Attention\nInput: [1024,10000,16,512]\nOutput: [1024,10000,8192]\nGPU: 15",
			pos="11928,1069.2",
			shape=rectangle,
			width=2.9722];
		l3_qkv_tp7 -> l3_attn_tp7	[pos="e,11927,1103.3 11926,1140 11926,1131.6 11926,1122.3 11927,1113.5"];
		l3_out_proj_tp7	[fillcolor=lightgreen,
			height=0.94444,
			label="Output Projection\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15",
			pos="11930,964.17",
			shape=rectangle,
			width=2.9444];
		l3_attn_tp7 -> l3_out_proj_tp7	[pos="e,11929,998.26 11929,1035 11929,1026.6 11929,1017.3 11929,1008.5"];
		l3_out_proj_tp7 -> l3_residual_tp7	[pos="e,11963,893.4 11945,930 11949,921.6 11954,912.22 11958,902.63"];
		l3_gate_tp7	[height=1.8889,
			label="Gate Network\nInput: [1024,10000,8192]\nOutput: [1024,10000,16]\nGPU: 15",
			pos="11954,652.17",
			width=5.7597];
		l3_residual_tp7 -> l3_gate_tp7	[pos="e,11970,720.35 11978,757.07 11976,748.3 11974,739.26 11972,730.34"];
		l3_exp0_gpu15	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 0\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15",
			pos="11624,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp7 -> l3_exp0_gpu15	[pos="e,11631,547.27 11756,757.01 11739,746.46 11724,734.27 11711,720.17 11668,673.6 11644,602.4 11633,557.09"];
		l3_exp1_gpu15	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 1\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15",
			pos="11432,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp7 -> l3_exp1_gpu15	[pos="e,11456,547.52 11712,757.15 11685,746.48 11660,734.23 11636,720.17 11564,677.09 11499,602.23 11462,555.6"];
		l3_exp2_gpu15	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 2\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15",
			pos="11240,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp7 -> l3_exp2_gpu15	[pos="e,11269,547.54 11663,782.67 11600,767.79 11537,747.6 11481,720.17 11397,679.38 11319,602.6 11276,555.17"];
		l3_exp3_gpu15	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 3\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15",
			pos="11816,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp7 -> l3_exp3_gpu15	[pos="e,11767,547.23 11773,757.05 11759,746.5 11748,734.29 11738,720.17 11704,670.02 11713,639.37 11738,584.17 11743,573.13 11751,563.11 \
11759,554.32"];
		l3_exp4_gpu15	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 4\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15",
			pos="12392,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp7 -> l3_exp4_gpu15	[pos="e,12369,547.22 12147,757.14 12157,751.35 12168,745.34 12178,739.17 12257,690.63 12326,605.8 12363,555.32"];
		l3_exp5_gpu15	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 5\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15",
			pos="12584,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp7 -> l3_exp5_gpu15	[pos="e,12542,547.34 12197,757.02 12225,745.76 12253,733.4 12279,720.17 12374,671.47 12476,598.23 12534,553.46"];
		l3_exp6_gpu15	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 6\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15",
			pos="12200,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp7 -> l3_exp6_gpu15	[pos="e,12206,547.41 12157,756.8 12169,746.23 12179,734.09 12186,720.17 12213,669.22 12211,601.1 12207,557.43"];
		l3_exp7_gpu15	[fillcolor=lightgreen,
			height=0.94444,
			label="Expert 7\nInput: [tokens,8192]\nOutput: [tokens,8192]\nGPU: 15",
			pos="12008,513.17",
			shape=rectangle,
			width=2.4167];
		l3_residual_tp7 -> l3_exp7_gpu15	[pos="e,12095,547.04 12139,756.95 12152,746.25 12162,734.04 12170,720.17 12200,667.67 12203,634.68 12170,584.17 12166,577.35 12137,564.09 \
12105,550.93"];
		l3_final_res_tp7	[height=1.8889,
			label="Layer 3 Final Residual\nInput: [1024,10000,8192], [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: 15",
			pos="11866,201.17",
			width=9.9643];
		l3_residual_tp7 -> l3_final_res_tp7	[pos="e,12160,208.71 12261,807.71 12457,788.01 12690,745.24 12690,653.17 12690,653.17 12690,653.17 12690,373.17 12690,263.12 12405,223.37 \
12170,209.3"];
		l3_gate_tp7 -> l3_exp0_gpu15	[pos="e,11704,547.23 11792,584.07 11765,572.71 11738,561.3 11713,551.08",
			style=dashed];
		l3_gate_tp7 -> l3_exp1_gpu15	[pos="e,11519,544.46 11762,608.15 11691,591.37 11610,571.05 11529,547.37",
			style=dashed];
		l3_gate_tp7 -> l3_exp2_gpu15	[pos="e,11327,544.82 11775,628.92 11653,611.96 11489,585.39 11337,547.34",
			style=dashed];
		l3_gate_tp7 -> l3_exp3_gpu15	[pos="e,11849,547.29 11886,583.87 11876,573.83 11866,563.76 11857,554.51",
			style=dashed];
		l3_gate_tp7 -> l3_exp4_gpu15	[pos="e,12305,544.25 12093,610.17 12152,592.27 12223,570.67 12295,547.4",
			style=dashed];
		l3_gate_tp7 -> l3_exp5_gpu15	[pos="e,12497,544.72 12104,627.73 12209,609.92 12353,582.86 12487,547.4",
			style=dashed];
		l3_gate_tp7 -> l3_exp6_gpu15	[pos="e,12141,547.23 12074,584.07 12094,573.16 12114,562.2 12132,552.3",
			style=dashed];
		l3_gate_tp7 -> l3_exp7_gpu15	[pos="e,11995,547.29 11981,583.87 11984,574.63 11988,565.35 11991,556.73",
			style=dashed];
		l3_exp_agg_tp7	[height=1.8889,
			label="Expert Aggregation\nInput: [16,tokens,8192]\nOutput: [1024,10000,8192]\nGPU: 15",
			pos="11866,374.17",
			width=6.1053];
		l3_exp0_gpu15 -> l3_exp_agg_tp7	[pos="e,11747,442.4 11683,479 11700,469.39 11719,458.5 11738,447.47"];
		l3_exp1_gpu15 -> l3_exp_agg_tp7	[pos="e,11721,418.8 11519,482.09 11522,481.1 11525,480.12 11528,479.17 11587,459.8 11653,439.39 11711,421.82"];
		l3_exp2_gpu15 -> l3_exp_agg_tp7	[pos="e,11708,400.24 11327,481.62 11330,480.76 11333,479.94 11336,479.17 11456,446.97 11593,420.27 11698,401.98"];
		l3_exp3_gpu15 -> l3_exp_agg_tp7	[pos="e,11841,442.4 11828,479 11831,470.69 11835,461.42 11838,451.93"];
		l3_exp4_gpu15 -> l3_exp_agg_tp7	[pos="e,12072,420.74 12305,481.86 12302,480.93 12299,480.03 12296,479.17 12227,458.95 12151,439.57 12082,423.14"];
		l3_exp5_gpu15 -> l3_exp_agg_tp7	[pos="e,12057,398.79 12497,481.51 12494,480.69 12491,479.9 12488,479.17 12349,443.99 12190,417.62 12067,400.24"];
		l3_exp6_gpu15 -> l3_exp_agg_tp7	[pos="e,12030,442.26 12119,479 12095,469.01 12067,457.63 12039,446.16"];
		l3_exp7_gpu15 -> l3_exp_agg_tp7	[pos="e,11936,442.4 11974,479 11964,469.99 11954,459.86 11943,449.55"];
		l3_exp_agg_tp7 -> l3_final_res_tp7	[pos="e,11866,269.35 11866,306.07 11866,297.4 11866,288.46 11866,279.63"];
	}
	input	[fillcolor=lightblue,
		height=1.041,
		label="Input\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nGPU: all GPUs",
		pos="6706,4719.6",
		shape=ellipse,
		width=8.2889];
	input -> l0_qkv_tp0	[pos="e,4354,4601.9 6409.5,4714.9 5927.8,4708 4996.2,4690.4 4668,4655.2 4564.7,4644.1 4448.9,4622 4364,4604"];
	input -> l0_residual_tp0	[pos="e,1402.6,4248.5 6720.5,4682.1 6730.5,4653.7 6742,4613 6742,4576.2 6742,4576.2 6742,4576.2 6742,4364.2 6742,4347 6736.9,4339.6 6722,\
4331.2 6668.6,4300.8 2356.5,4296.1 2295,4294.2 1995.6,4284.6 1654.7,4264.7 1412.6,4249.1"];
	input -> l0_qkv_tp1	[pos="e,4903.2,4600.2 6408.3,4717 6111.9,4712.8 5644.3,4698.9 5242,4655.2 5130,4643 5003.8,4620.2 4913.2,4602.2"];
	input -> l0_residual_tp1	[pos="e,2973.7,4249.2 6743.5,4682.4 6748.2,4676.6 6752.5,4670.5 6756,4664.2 6775.6,4628.7 6780,4616.7 6780,4576.2 6780,4576.2 6780,4576.2 \
6780,4364.2 6780,4338.7 6777.4,4326 6756,4312.2 6721.9,4290.2 3876.5,4295.4 3836,4294.2 3547.5,4285 3219.4,4265.5 2983.8,4249.9"];
	input -> l0_qkv_tp2	[pos="e,5409.4,4609.3 6438.4,4703 6234.6,4691.3 5947.2,4675.3 5695,4663.2 5652.3,4661.1 5544,4666.9 5503,4655.2 5473,4646.6 5442.6,4630.3 \
5417.9,4614.8"];
	input -> l0_residual_tp2	[pos="e,4515.6,4250.2 6775.7,4682.9 6782.5,4677.3 6788.8,4671.1 6794,4664.2 6818.3,4631.7 6818,4616.7 6818,4576.2 6818,4576.2 6818,4576.2 \
6818,4364.2 6818,4338.7 6815.4,4326 6794,4312.2 6759.2,4289.6 5344.4,4295.7 5303,4294.2 5041.1,4284.6 4744.6,4266.1 4525.6,4250.9"];
	input -> l0_qkv_tp3	[pos="e,5664.6,4609.3 6439.8,4702.6 6161.8,4685.7 5763.4,4660.6 5747,4655.2 5720.6,4646.4 5694.3,4630.5 5672.9,4615.3"];
	input -> l0_residual_tp3	[pos="e,5986.2,4253.6 6808.6,4684.3 6817.3,4678.6 6825.3,4671.9 6832,4664.2 6858.6,4633.5 6856,4616.7 6856,4576.2 6856,4576.2 6856,4576.2 \
6856,4364.2 6856,4338.7 6853,4326.5 6832,4312.2 6803.4,4292.7 6555.5,4296.5 6521,4294.2 6347.8,4282.3 6154.8,4267.3 5996.6,4254.4"];
	input -> l0_qkv_tp4	[pos="e,5909,4609.2 6423.7,4707.4 6259.3,4698.2 6069.4,4682.1 5991,4655.2 5964.8,4646.1 5938.6,4630.3 5917.2,4615.2"];
	input -> l0_residual_tp4	[pos="e,6892.4,4294.4 6842,4686.1 6852.3,4680 6861.9,4672.8 6870,4664.2 6897.9,4634.7 6894,4616.7 6894,4576.2 6894,4576.2 6894,4576.2 \
6894,4364.2 6894,4344.8 6893.5,4323.9 6892.8,4304.4"];
	input -> l0_qkv_tp5	[pos="e,6154,4609.3 6489.4,4693.8 6377.7,4680.2 6259.8,4664.3 6235,4655.2 6209.3,4645.7 6183.5,4630 6162.2,4615.1"];
	input -> l0_residual_tp5	[pos="e,8069.2,4234.7 6980.1,4704.7 7268.8,4686.3 7682,4647.5 7682,4576.2 7682,4576.2 7682,4576.2 7682,4364.2 7682,4282 7879.5,4248.7 \
8059,4235.4"];
	input -> l0_qkv_tp6	[pos="e,6400.9,4609.2 6565.6,4686.5 6536.4,4677.9 6506.2,4667.4 6479,4655.2 6454.9,4644.3 6430.2,4629.1 6409.3,4615"];
	input -> l0_residual_tp6	[pos="e,9680,4252.6 7003.8,4717 7669.6,4711.2 9221,4686.1 9221,4576.2 9221,4576.2 9221,4576.2 9221,4364.2 9221,4316.7 9466.6,4277.9 9670.1,\
4253.8"];
	input -> l0_qkv_tp7	[pos="e,6625.4,4609.3 6679,4682 6664.4,4662.2 6646.5,4637.9 6631.5,4617.5"];
	input -> l0_residual_tp7	[pos="e,11185,4238.1 7003.3,4716.1 7949.6,4707.1 10829,4671.9 10829,4576.2 10829,4576.2 10829,4576.2 10829,4364.2 10829,4287.8 11008,4253.9 \
11175,4238.9"];
	l1_final_res_tp0 -> l2_qkv_tp0	[label="Pipeline P2P\nGPU 0  GPU 8",
		lp="1004.5,2389.2",
		pos="e,948,2320.2 948,2421.9 948,2391.7 948,2357 948,2330.3"];
	l1_final_res_tp1 -> l2_qkv_tp1	[label="Pipeline P2P\nGPU 1  GPU 9",
		lp="2871.5,2389.2",
		pos="e,2815,2320.2 2815,2421.9 2815,2391.7 2815,2357 2815,2330.3"];
	l1_final_res_tp2 -> l2_qkv_tp2	[label="Pipeline P2P\nGPU 2  GPU 10",
		lp="4093,2389.2",
		pos="e,4032,2320.2 4032,2421.9 4032,2391.7 4032,2357 4032,2330.3"];
	l1_final_res_tp3 -> l2_qkv_tp3	[label="Pipeline P2P\nGPU 3  GPU 11",
		lp="5945,2389.2",
		pos="e,5884,2320.2 5884,2421.9 5884,2391.7 5884,2357 5884,2330.3"];
	l1_final_res_tp4 -> l2_qkv_tp4	[label="Pipeline P2P\nGPU 4  GPU 12",
		lp="7234,2389.2",
		pos="e,7173,2320.2 7173,2421.9 7173,2391.7 7173,2357 7173,2330.3"];
	l1_final_res_tp5 -> l2_qkv_tp5	[label="Pipeline P2P\nGPU 5  GPU 13",
		lp="9073,2389.2",
		pos="e,9012,2320.2 9012,2421.9 9012,2391.7 9012,2357 9012,2330.3"];
	l1_final_res_tp6 -> l2_qkv_tp6	[label="Pipeline P2P\nGPU 6  GPU 14",
		lp="10345,2389.2",
		pos="e,10284,2320.2 10284,2421.9 10284,2391.7 10284,2357 10284,2330.3"];
	l1_final_res_tp7 -> l2_qkv_tp7	[label="Pipeline P2P\nGPU 7  GPU 15",
		lp="12091,2389.2",
		pos="e,12030,2320.2 12030,2421.9 12030,2391.7 12030,2357 12030,2330.3"];
	output	[fillcolor=lightblue,
		height=1.3356,
		label="Output\nInput: [1024,10000,8192]\nOutput: [1024,10000,8192]\nGPU: all GPUs",
		pos="6868,48.083",
		shape=ellipse,
		width=4.1641];
	l3_final_res_tp0 -> output	[pos="e,6718,49.679 2061.2,180.26 2301.8,162.84 2667.6,138.33 2986,125.17 4429.9,65.468 6177.8,52.4 6708,49.729"];
	l3_final_res_tp1 -> output	[pos="e,6718.6,52.398 3618.1,181.19 3858.8,164.44 4224.1,140.4 4542,125.17 5356.1,86.163 6331.5,61.386 6708.5,52.633"];
	l3_final_res_tp2 -> output	[pos="e,6722.7,60.292 5172.5,179.91 5586.4,147.97 6377.9,86.903 6712.5,61.083"];
	l3_final_res_tp3 -> output	[pos="e,6772.1,85.127 6644.4,133.13 6684.7,117.96 6726.3,102.33 6762.5,88.724"];
	l3_final_res_tp4 -> output	[pos="e,6958.8,86.371 7072.7,133.13 7037.1,118.52 7000.5,103.48 6968.2,90.239"];
	l3_final_res_tp5 -> output	[pos="e,7012.8,60.552 8462.5,175.35 8048.6,142.57 7335.8,86.126 7022.9,61.348"];
	l3_final_res_tp6 -> output	[pos="e,7017.5,52.616 10047,178.58 9802.1,162.1 9451.3,139.8 9144,125.17 8349.8,87.348 7398.9,61.995 7027.5,52.861"];
	l3_final_res_tp7 -> output	[pos="e,7017.9,49.566 11553,175.7 11324,158.74 11005,137.14 10725,125.17 9291.7,63.955 7556.6,51.911 7028.2,49.61"];
}
