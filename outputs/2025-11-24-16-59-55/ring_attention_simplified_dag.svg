<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: ring_attention_sp_simplified Pages: 1 -->
<svg width="2667pt" height="3138pt"
 viewBox="0.00 0.00 2666.91 3138.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3134)">
<title>ring_attention_sp_simplified</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3134 2662.91,-3134 2662.91,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_device_0</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="743.22,-2174 743.22,-3122 2387.22,-3122 2387.22,-2174 743.22,-2174"/>
<text text-anchor="middle" x="1565.22" y="-3106.8" font-family="Times,serif" font-size="14.00">Device 0</text>
<text text-anchor="middle" x="1565.22" y="-3091.8" font-family="Times,serif" font-size="14.00">Tokens: 0&#45;6249</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_device_1</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="743.22,-1066 743.22,-2014 2387.22,-2014 2387.22,-1066 743.22,-1066"/>
<text text-anchor="middle" x="1565.22" y="-1998.8" font-family="Times,serif" font-size="14.00">Device 1</text>
<text text-anchor="middle" x="1565.22" y="-1983.8" font-family="Times,serif" font-size="14.00">Tokens: 6250&#45;12499</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_device_2</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="738.72,-100 738.72,-1048 2387.22,-1048 2387.22,-100 738.72,-100"/>
<text text-anchor="middle" x="1562.97" y="-1032.8" font-family="Times,serif" font-size="14.00">Device 2</text>
<text text-anchor="middle" x="1562.97" y="-1017.8" font-family="Times,serif" font-size="14.00">Tokens: 12500&#45;18749</text>
</g>
<!-- input_split -->
<g id="node1" class="node">
<title>input_split</title>
<ellipse fill="lightblue" stroke="black" cx="543.84" cy="-1236" rx="113.69" ry="26.74"/>
<text text-anchor="middle" x="543.84" y="-1239.8" font-family="Times,serif" font-size="14.00">Input Sequence</text>
<text text-anchor="middle" x="543.84" y="-1224.8" font-family="Times,serif" font-size="14.00">Split (100k → 6.25k)</text>
<text text-anchor="middle" x="215" y="-1197.93" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100k, d_model=4096]</text>
<text text-anchor="middle" x="215" y="-1182.93" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=6.25k, d_model=4096] per device</text>
</g>
<!-- d0_l0_qkv -->
<g id="node2" class="node">
<title>d0_l0_qkv</title>
<polygon fill="lightgreen" stroke="black" points="842.22,-3075.5 760.22,-3075.5 760.22,-3022.5 842.22,-3022.5 842.22,-3075.5"/>
<text text-anchor="middle" x="801.22" y="-3060.3" font-family="Times,serif" font-size="14.00">D0</text>
<text text-anchor="middle" x="801.22" y="-3045.3" font-family="Times,serif" font-size="14.00">L0</text>
<text text-anchor="middle" x="801.22" y="-3030.3" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="658.72" y="-3011.3" font-family="Times,serif" font-size="14.00">Input: [128, 6250, 4096]</text>
<text text-anchor="middle" x="658.72" y="-2996.3" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 32*128]</text>
</g>
<!-- input_split&#45;&gt;d0_l0_qkv -->
<g id="edge1" class="edge">
<title>input_split&#45;&gt;d0_l0_qkv</title>
<path fill="none" stroke="black" d="M611.61,-1257.61C630.84,-1267.19 649.71,-1280.59 661.22,-1299 710.97,-1378.53 695.46,-2900.57 734.22,-2986 739.18,-2996.93 746.99,-3006.91 755.52,-3015.55"/>
<polygon fill="black" stroke="black" points="753.16,-3018.12 762.82,-3022.47 757.98,-3013.05 753.16,-3018.12"/>
</g>
<!-- d1_l0_qkv -->
<g id="node17" class="node">
<title>d1_l0_qkv</title>
<polygon fill="lightgreen" stroke="black" points="842.22,-1967.5 760.22,-1967.5 760.22,-1914.5 842.22,-1914.5 842.22,-1967.5"/>
<text text-anchor="middle" x="801.22" y="-1952.3" font-family="Times,serif" font-size="14.00">D1</text>
<text text-anchor="middle" x="801.22" y="-1937.3" font-family="Times,serif" font-size="14.00">L0</text>
<text text-anchor="middle" x="801.22" y="-1922.3" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="658.72" y="-1903.3" font-family="Times,serif" font-size="14.00">Input: [128, 6250, 4096]</text>
<text text-anchor="middle" x="658.72" y="-1888.3" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 32*128]</text>
</g>
<!-- input_split&#45;&gt;d1_l0_qkv -->
<g id="edge12" class="edge">
<title>input_split&#45;&gt;d1_l0_qkv</title>
<path fill="none" stroke="black" d="M610.11,-1257.89C629.49,-1267.53 648.83,-1280.89 661.22,-1299 807.68,-1513.06 617.45,-1646.41 734.22,-1878 739.68,-1888.83 747.78,-1898.82 756.45,-1907.5"/>
<polygon fill="black" stroke="black" points="754.15,-1910.14 763.82,-1914.47 758.96,-1905.05 754.15,-1910.14"/>
</g>
<!-- d2_l0_qkv -->
<g id="node32" class="node">
<title>d2_l0_qkv</title>
<polygon fill="lightgreen" stroke="black" points="842.22,-1001.5 760.22,-1001.5 760.22,-948.5 842.22,-948.5 842.22,-1001.5"/>
<text text-anchor="middle" x="801.22" y="-986.3" font-family="Times,serif" font-size="14.00">D2</text>
<text text-anchor="middle" x="801.22" y="-971.3" font-family="Times,serif" font-size="14.00">L0</text>
<text text-anchor="middle" x="801.22" y="-956.3" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="658.72" y="-937.3" font-family="Times,serif" font-size="14.00">Input: [128, 6250, 4096]</text>
<text text-anchor="middle" x="658.72" y="-922.3" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 32*128]</text>
</g>
<!-- input_split&#45;&gt;d2_l0_qkv -->
<g id="edge23" class="edge">
<title>input_split&#45;&gt;d2_l0_qkv</title>
<path fill="none" stroke="black" d="M570.74,-1209.54C617.39,-1161.86 715.49,-1061.6 767.01,-1008.94"/>
<polygon fill="black" stroke="black" points="769.77,-1011.13 774.26,-1001.53 764.77,-1006.23 769.77,-1011.13"/>
</g>
<!-- cluster_device_0 -->
<g id="node51" class="node">
<title>cluster_device_0</title>
<polygon fill="lightgrey" stroke="black" points="868.22,-36 734.22,-36 734.22,0 868.22,0 868.22,-36"/>
<text text-anchor="middle" x="801.22" y="-14.3" font-family="Times,serif" font-size="14.00">cluster_device_0</text>
</g>
<!-- input_split&#45;&gt;cluster_device_0 -->
<!-- d0_l0_ring_stage_0 -->
<g id="node3" class="node">
<title>d0_l0_ring_stage_0</title>
<polygon fill="yellow" stroke="black" points="1058.22,-2299 958.22,-2299 958.22,-2231 1058.22,-2231 1058.22,-2299"/>
<text text-anchor="middle" x="1008.22" y="-2283.8" font-family="Times,serif" font-size="14.00">D0</text>
<text text-anchor="middle" x="1008.22" y="-2268.8" font-family="Times,serif" font-size="14.00">L0</text>
<text text-anchor="middle" x="1008.22" y="-2253.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="1008.22" y="-2238.8" font-family="Times,serif" font-size="14.00">KV from D0</text>
<text text-anchor="middle" x="964.72" y="-2219.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="964.72" y="-2204.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="964.72" y="-2189.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d0_l0_qkv&#45;&gt;d0_l0_ring_stage_0 -->
<g id="edge2" class="edge">
<title>d0_l0_qkv&#45;&gt;d0_l0_ring_stage_0</title>
<path fill="none" stroke="black" d="M838.12,-3022.2C849.37,-3012.05 860.79,-2999.63 868.22,-2986 994.48,-2754.63 1007.47,-2426.68 1007.79,-2309.08"/>
<polygon fill="black" stroke="black" points="1011.29,-2309.02 1007.79,-2299.02 1004.29,-2309.02 1011.29,-2309.02"/>
</g>
<!-- d0_l0_mlp -->
<g id="node6" class="node">
<title>d0_l0_mlp</title>
<polygon fill="lightcoral" stroke="black" points="1352.72,-2291.5 1259.72,-2291.5 1259.72,-2238.5 1352.72,-2238.5 1352.72,-2291.5"/>
<text text-anchor="middle" x="1306.22" y="-2276.3" font-family="Times,serif" font-size="14.00">D0</text>
<text text-anchor="middle" x="1306.22" y="-2261.3" font-family="Times,serif" font-size="14.00">L0</text>
<text text-anchor="middle" x="1306.22" y="-2246.3" font-family="Times,serif" font-size="14.00">MLP Block</text>
<text text-anchor="middle" x="1166.22" y="-2257.3" font-family="Times,serif" font-size="14.00">Input: [128, 6250, 4096]</text>
<text text-anchor="middle" x="1166.22" y="-2242.3" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d0_l0_ring_stage_0&#45;&gt;d0_l0_mlp -->
<g id="edge3" class="edge">
<title>d0_l0_ring_stage_0&#45;&gt;d0_l0_mlp</title>
<path fill="none" stroke="black" d="M1058.43,-2265C1110.94,-2265 1193.99,-2265 1249.03,-2265"/>
<polygon fill="black" stroke="black" points="1249.31,-2268.5 1259.31,-2265 1249.31,-2261.5 1249.31,-2268.5"/>
</g>
<!-- d1_l0_ring_stage_1 -->
<g id="node49" class="node">
<title>d1_l0_ring_stage_1</title>
<polygon fill="lightgrey" stroke="black" points="1382.22,-2166 1230.22,-2166 1230.22,-2130 1382.22,-2130 1382.22,-2166"/>
<text text-anchor="middle" x="1306.22" y="-2144.3" font-family="Times,serif" font-size="14.00">d1_l0_ring_stage_1</text>
</g>
<!-- d0_l0_ring_stage_0&#45;&gt;d1_l0_ring_stage_1 -->
<g id="edge4" class="edge">
<title>d0_l0_ring_stage_0&#45;&gt;d1_l0_ring_stage_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1058.57,-2241.75C1102.91,-2221.35 1170.11,-2191.65 1230.22,-2170 1230.8,-2169.79 1231.38,-2169.58 1231.97,-2169.38"/>
<polygon fill="black" stroke="black" points="1233.3,-2172.62 1241.63,-2166.07 1231.03,-2166 1233.3,-2172.62"/>
<text text-anchor="middle" x="1152.72" y="-2219.8" font-family="Times,serif" font-size="14.00">KV transfer</text>
</g>
<!-- d0_l0_ring_stage_8 -->
<g id="node4" class="node">
<title>d0_l0_ring_stage_8</title>
<polygon fill="yellow" stroke="black" points="851.22,-2950 751.22,-2950 751.22,-2882 851.22,-2882 851.22,-2950"/>
<text text-anchor="middle" x="801.22" y="-2934.8" font-family="Times,serif" font-size="14.00">D0</text>
<text text-anchor="middle" x="801.22" y="-2919.8" font-family="Times,serif" font-size="14.00">L0</text>
<text text-anchor="middle" x="801.22" y="-2904.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="801.22" y="-2889.8" font-family="Times,serif" font-size="14.00">KV from D8</text>
<text text-anchor="middle" x="657.72" y="-2870.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-2855.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-2840.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d0_l0_ring_stage_15 -->
<g id="node5" class="node">
<title>d0_l0_ring_stage_15</title>
<polygon fill="yellow" stroke="black" points="851.22,-2810 751.22,-2810 751.22,-2742 851.22,-2742 851.22,-2810"/>
<text text-anchor="middle" x="801.22" y="-2794.8" font-family="Times,serif" font-size="14.00">D0</text>
<text text-anchor="middle" x="801.22" y="-2779.8" font-family="Times,serif" font-size="14.00">L0</text>
<text text-anchor="middle" x="801.22" y="-2764.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="801.22" y="-2749.8" font-family="Times,serif" font-size="14.00">KV from D1</text>
<text text-anchor="middle" x="657.72" y="-2730.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-2715.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-2700.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d0_l8_qkv -->
<g id="node7" class="node">
<title>d0_l8_qkv</title>
<polygon fill="lightgreen" stroke="black" points="1537.22,-2290.5 1455.22,-2290.5 1455.22,-2237.5 1537.22,-2237.5 1537.22,-2290.5"/>
<text text-anchor="middle" x="1496.22" y="-2275.3" font-family="Times,serif" font-size="14.00">D0</text>
<text text-anchor="middle" x="1496.22" y="-2260.3" font-family="Times,serif" font-size="14.00">L8</text>
<text text-anchor="middle" x="1496.22" y="-2245.3" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="1353.72" y="-2226.3" font-family="Times,serif" font-size="14.00">Input: [128, 6250, 4096]</text>
<text text-anchor="middle" x="1353.72" y="-2211.3" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 32*128]</text>
</g>
<!-- d0_l0_mlp&#45;&gt;d0_l8_qkv -->
<g id="edge5" class="edge">
<title>d0_l0_mlp&#45;&gt;d0_l8_qkv</title>
<path fill="none" stroke="black" d="M1352.73,-2264.76C1380.51,-2264.61 1416.07,-2264.42 1444.71,-2264.27"/>
<polygon fill="black" stroke="black" points="1444.94,-2267.77 1454.93,-2264.21 1444.91,-2260.77 1444.94,-2267.77"/>
</g>
<!-- d0_l8_ring_stage_8 -->
<g id="node9" class="node">
<title>d0_l8_ring_stage_8</title>
<polygon fill="yellow" stroke="black" points="1714.72,-2274 1614.72,-2274 1614.72,-2206 1714.72,-2206 1714.72,-2274"/>
<text text-anchor="middle" x="1664.72" y="-2258.8" font-family="Times,serif" font-size="14.00">D0</text>
<text text-anchor="middle" x="1664.72" y="-2243.8" font-family="Times,serif" font-size="14.00">L8</text>
<text text-anchor="middle" x="1664.72" y="-2228.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="1664.72" y="-2213.8" font-family="Times,serif" font-size="14.00">KV from D8</text>
<text text-anchor="middle" x="1521.22" y="-2194.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="1521.22" y="-2179.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="1521.22" y="-2164.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d0_l8_qkv&#45;&gt;d0_l8_ring_stage_8 -->
<g id="edge6" class="edge">
<title>d0_l8_qkv&#45;&gt;d0_l8_ring_stage_8</title>
<path fill="none" stroke="black" d="M1537.53,-2258.19C1557.64,-2255.29 1582.36,-2251.73 1604.58,-2248.53"/>
<polygon fill="black" stroke="black" points="1605.18,-2251.97 1614.58,-2247.08 1604.18,-2245.05 1605.18,-2251.97"/>
</g>
<!-- d0_l8_ring_stage_0 -->
<g id="node8" class="node">
<title>d0_l8_ring_stage_0</title>
<polygon fill="yellow" stroke="black" points="851.22,-2670 751.22,-2670 751.22,-2602 851.22,-2602 851.22,-2670"/>
<text text-anchor="middle" x="801.22" y="-2654.8" font-family="Times,serif" font-size="14.00">D0</text>
<text text-anchor="middle" x="801.22" y="-2639.8" font-family="Times,serif" font-size="14.00">L8</text>
<text text-anchor="middle" x="801.22" y="-2624.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="801.22" y="-2609.8" font-family="Times,serif" font-size="14.00">KV from D0</text>
<text text-anchor="middle" x="657.72" y="-2590.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-2575.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-2560.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d0_l8_mlp -->
<g id="node11" class="node">
<title>d0_l8_mlp</title>
<polygon fill="lightcoral" stroke="black" points="1885.22,-2254.5 1792.22,-2254.5 1792.22,-2201.5 1885.22,-2201.5 1885.22,-2254.5"/>
<text text-anchor="middle" x="1838.72" y="-2239.3" font-family="Times,serif" font-size="14.00">D0</text>
<text text-anchor="middle" x="1838.72" y="-2224.3" font-family="Times,serif" font-size="14.00">L8</text>
<text text-anchor="middle" x="1838.72" y="-2209.3" font-family="Times,serif" font-size="14.00">MLP Block</text>
<text text-anchor="middle" x="1791.72" y="-2190.3" font-family="Times,serif" font-size="14.00">Input: [128, 6250, 4096]</text>
<text text-anchor="middle" x="1791.72" y="-2175.3" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d0_l8_ring_stage_8&#45;&gt;d0_l8_mlp -->
<g id="edge7" class="edge">
<title>d0_l8_ring_stage_8&#45;&gt;d0_l8_mlp</title>
<path fill="none" stroke="black" d="M1715.01,-2236.56C1735.92,-2235.1 1760.4,-2233.39 1781.96,-2231.89"/>
<polygon fill="black" stroke="black" points="1782.23,-2235.38 1791.97,-2231.19 1781.75,-2228.4 1782.23,-2235.38"/>
</g>
<!-- d0_l8_ring_stage_15 -->
<g id="node10" class="node">
<title>d0_l8_ring_stage_15</title>
<polygon fill="yellow" stroke="black" points="851.22,-2530 751.22,-2530 751.22,-2462 851.22,-2462 851.22,-2530"/>
<text text-anchor="middle" x="801.22" y="-2514.8" font-family="Times,serif" font-size="14.00">D0</text>
<text text-anchor="middle" x="801.22" y="-2499.8" font-family="Times,serif" font-size="14.00">L8</text>
<text text-anchor="middle" x="801.22" y="-2484.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="801.22" y="-2469.8" font-family="Times,serif" font-size="14.00">KV from D1</text>
<text text-anchor="middle" x="657.72" y="-2450.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-2435.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-2420.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d0_l15_qkv -->
<g id="node12" class="node">
<title>d0_l15_qkv</title>
<polygon fill="lightgreen" stroke="black" points="2040.22,-2248.5 1958.22,-2248.5 1958.22,-2195.5 2040.22,-2195.5 2040.22,-2248.5"/>
<text text-anchor="middle" x="1999.22" y="-2233.3" font-family="Times,serif" font-size="14.00">D0</text>
<text text-anchor="middle" x="1999.22" y="-2218.3" font-family="Times,serif" font-size="14.00">L15</text>
<text text-anchor="middle" x="1999.22" y="-2203.3" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="1938.72" y="-2267.3" font-family="Times,serif" font-size="14.00">Input: [128, 6250, 4096]</text>
<text text-anchor="middle" x="1938.72" y="-2252.3" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 32*128]</text>
</g>
<!-- d0_l8_mlp&#45;&gt;d0_l15_qkv -->
<g id="edge8" class="edge">
<title>d0_l8_mlp&#45;&gt;d0_l15_qkv</title>
<path fill="none" stroke="black" d="M1885.57,-2226.26C1905.11,-2225.52 1927.97,-2224.66 1947.97,-2223.9"/>
<polygon fill="black" stroke="black" points="1948.28,-2227.39 1958.14,-2223.52 1948.01,-2220.4 1948.28,-2227.39"/>
</g>
<!-- d0_l15_ring_stage_15 -->
<g id="node15" class="node">
<title>d0_l15_ring_stage_15</title>
<polygon fill="yellow" stroke="black" points="2213.22,-2252 2113.22,-2252 2113.22,-2184 2213.22,-2184 2213.22,-2252"/>
<text text-anchor="middle" x="2163.22" y="-2236.8" font-family="Times,serif" font-size="14.00">D0</text>
<text text-anchor="middle" x="2163.22" y="-2221.8" font-family="Times,serif" font-size="14.00">L15</text>
<text text-anchor="middle" x="2163.22" y="-2206.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="2163.22" y="-2191.8" font-family="Times,serif" font-size="14.00">KV from D1</text>
<text text-anchor="middle" x="2019.72" y="-2172.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="2019.72" y="-2157.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="2019.72" y="-2142.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d0_l15_qkv&#45;&gt;d0_l15_ring_stage_15 -->
<g id="edge9" class="edge">
<title>d0_l15_qkv&#45;&gt;d0_l15_ring_stage_15</title>
<path fill="none" stroke="black" d="M2040.27,-2221.01C2059.19,-2220.54 2082.16,-2219.98 2103.04,-2219.46"/>
<polygon fill="black" stroke="black" points="2103.18,-2222.96 2113.09,-2219.21 2103.01,-2215.96 2103.18,-2222.96"/>
</g>
<!-- d0_l15_ring_stage_0 -->
<g id="node13" class="node">
<title>d0_l15_ring_stage_0</title>
<polygon fill="yellow" stroke="black" points="851.22,-2390 751.22,-2390 751.22,-2322 851.22,-2322 851.22,-2390"/>
<text text-anchor="middle" x="801.22" y="-2374.8" font-family="Times,serif" font-size="14.00">D0</text>
<text text-anchor="middle" x="801.22" y="-2359.8" font-family="Times,serif" font-size="14.00">L15</text>
<text text-anchor="middle" x="801.22" y="-2344.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="801.22" y="-2329.8" font-family="Times,serif" font-size="14.00">KV from D0</text>
<text text-anchor="middle" x="657.72" y="-2310.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-2295.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-2280.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d0_l15_ring_stage_8 -->
<g id="node14" class="node">
<title>d0_l15_ring_stage_8</title>
<polygon fill="yellow" stroke="black" points="851.22,-2250 751.22,-2250 751.22,-2182 851.22,-2182 851.22,-2250"/>
<text text-anchor="middle" x="801.22" y="-2234.8" font-family="Times,serif" font-size="14.00">D0</text>
<text text-anchor="middle" x="801.22" y="-2219.8" font-family="Times,serif" font-size="14.00">L15</text>
<text text-anchor="middle" x="801.22" y="-2204.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="801.22" y="-2189.8" font-family="Times,serif" font-size="14.00">KV from D8</text>
<text text-anchor="middle" x="657.72" y="-2170.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-2155.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-2140.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d0_l15_mlp -->
<g id="node16" class="node">
<title>d0_l15_mlp</title>
<polygon fill="lightcoral" stroke="black" points="2379.22,-2239.5 2286.22,-2239.5 2286.22,-2186.5 2379.22,-2186.5 2379.22,-2239.5"/>
<text text-anchor="middle" x="2332.72" y="-2224.3" font-family="Times,serif" font-size="14.00">D0</text>
<text text-anchor="middle" x="2332.72" y="-2209.3" font-family="Times,serif" font-size="14.00">L15</text>
<text text-anchor="middle" x="2332.72" y="-2194.3" font-family="Times,serif" font-size="14.00">MLP Block</text>
<text text-anchor="middle" x="2472.72" y="-2175.3" font-family="Times,serif" font-size="14.00">Input: [128, 6250, 4096]</text>
<text text-anchor="middle" x="2472.72" y="-2160.3" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d0_l15_ring_stage_15&#45;&gt;d0_l15_mlp -->
<g id="edge10" class="edge">
<title>d0_l15_ring_stage_15&#45;&gt;d0_l15_mlp</title>
<path fill="none" stroke="black" d="M2213.57,-2216.53C2233.22,-2215.94 2255.93,-2215.26 2276.15,-2214.66"/>
<polygon fill="black" stroke="black" points="2276.27,-2218.16 2286.16,-2214.36 2276.06,-2211.16 2276.27,-2218.16"/>
</g>
<!-- output_agg -->
<g id="node48" class="node">
<title>output_agg</title>
<ellipse fill="lightgreen" stroke="black" cx="2555.56" cy="-1127" rx="103.18" ry="18"/>
<text text-anchor="middle" x="2555.56" y="-1123.3" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="2326.22" y="-1097.8" font-family="Times,serif" font-size="14.00">Concatenate 16×[128, 6250, 4096]</text>
<text text-anchor="middle" x="2326.22" y="-1082.8" font-family="Times,serif" font-size="14.00">→ [128, 100k, 4096]</text>
</g>
<!-- d0_l15_mlp&#45;&gt;output_agg -->
<g id="edge11" class="edge">
<title>d0_l15_mlp&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M2342.59,-2186.25C2354,-2151.14 2373.94,-2087.45 2387.22,-2032 2469.18,-1689.89 2533.94,-1266.84 2550.46,-1155.12"/>
<polygon fill="black" stroke="black" points="2553.96,-1155.41 2551.95,-1145.01 2547.03,-1154.39 2553.96,-1155.41"/>
</g>
<!-- d1_l0_ring_stage_0 -->
<g id="node18" class="node">
<title>d1_l0_ring_stage_0</title>
<polygon fill="yellow" stroke="black" points="1058.22,-1968 958.22,-1968 958.22,-1900 1058.22,-1900 1058.22,-1968"/>
<text text-anchor="middle" x="1008.22" y="-1952.8" font-family="Times,serif" font-size="14.00">D1</text>
<text text-anchor="middle" x="1008.22" y="-1937.8" font-family="Times,serif" font-size="14.00">L0</text>
<text text-anchor="middle" x="1008.22" y="-1922.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="1008.22" y="-1907.8" font-family="Times,serif" font-size="14.00">KV from D1</text>
<text text-anchor="middle" x="864.72" y="-1888.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="864.72" y="-1873.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="864.72" y="-1858.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d1_l0_qkv&#45;&gt;d1_l0_ring_stage_0 -->
<g id="edge13" class="edge">
<title>d1_l0_qkv&#45;&gt;d1_l0_ring_stage_0</title>
<path fill="none" stroke="black" d="M842.24,-1939.63C872.23,-1938.61 913.76,-1937.19 947.65,-1936.03"/>
<polygon fill="black" stroke="black" points="948.02,-1939.52 957.9,-1935.68 947.78,-1932.53 948.02,-1939.52"/>
</g>
<!-- d1_l0_mlp -->
<g id="node21" class="node">
<title>d1_l0_mlp</title>
<polygon fill="lightcoral" stroke="black" points="1352.72,-1745.5 1259.72,-1745.5 1259.72,-1692.5 1352.72,-1692.5 1352.72,-1745.5"/>
<text text-anchor="middle" x="1306.22" y="-1730.3" font-family="Times,serif" font-size="14.00">D1</text>
<text text-anchor="middle" x="1306.22" y="-1715.3" font-family="Times,serif" font-size="14.00">L0</text>
<text text-anchor="middle" x="1306.22" y="-1700.3" font-family="Times,serif" font-size="14.00">MLP Block</text>
<text text-anchor="middle" x="1166.22" y="-1681.3" font-family="Times,serif" font-size="14.00">Input: [128, 6250, 4096]</text>
<text text-anchor="middle" x="1166.22" y="-1666.3" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d1_l0_ring_stage_0&#45;&gt;d1_l0_mlp -->
<g id="edge14" class="edge">
<title>d1_l0_ring_stage_0&#45;&gt;d1_l0_mlp</title>
<path fill="none" stroke="black" d="M1056.13,-1899.93C1112.1,-1859.27 1205.03,-1791.77 1260.18,-1751.72"/>
<polygon fill="black" stroke="black" points="1262.33,-1754.48 1268.36,-1745.78 1258.21,-1748.82 1262.33,-1754.48"/>
</g>
<!-- d2_l0_ring_stage_1 -->
<g id="node50" class="node">
<title>d2_l0_ring_stage_1</title>
<polygon fill="lightgrey" stroke="black" points="1382.22,-2058 1230.22,-2058 1230.22,-2022 1382.22,-2022 1382.22,-2058"/>
<text text-anchor="middle" x="1306.22" y="-2036.3" font-family="Times,serif" font-size="14.00">d2_l0_ring_stage_1</text>
</g>
<!-- d1_l0_ring_stage_0&#45;&gt;d2_l0_ring_stage_1 -->
<g id="edge15" class="edge">
<title>d1_l0_ring_stage_0&#45;&gt;d2_l0_ring_stage_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1058.42,-1953.96C1102.94,-1971.72 1170.5,-1997.92 1230.22,-2018 1231.1,-2018.29 1231.97,-2018.59 1232.86,-2018.88"/>
<polygon fill="black" stroke="black" points="1231.91,-2022.25 1242.5,-2022 1234.06,-2015.59 1231.91,-2022.25"/>
<text text-anchor="middle" x="1152.72" y="-2008.8" font-family="Times,serif" font-size="14.00">KV transfer</text>
</g>
<!-- d1_l0_ring_stage_8 -->
<g id="node19" class="node">
<title>d1_l0_ring_stage_8</title>
<polygon fill="yellow" stroke="black" points="851.22,-1842 751.22,-1842 751.22,-1774 851.22,-1774 851.22,-1842"/>
<text text-anchor="middle" x="801.22" y="-1826.8" font-family="Times,serif" font-size="14.00">D1</text>
<text text-anchor="middle" x="801.22" y="-1811.8" font-family="Times,serif" font-size="14.00">L0</text>
<text text-anchor="middle" x="801.22" y="-1796.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="801.22" y="-1781.8" font-family="Times,serif" font-size="14.00">KV from D9</text>
<text text-anchor="middle" x="657.72" y="-1762.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-1747.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-1732.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d1_l0_ring_stage_15 -->
<g id="node20" class="node">
<title>d1_l0_ring_stage_15</title>
<polygon fill="yellow" stroke="black" points="851.22,-1702 751.22,-1702 751.22,-1634 851.22,-1634 851.22,-1702"/>
<text text-anchor="middle" x="801.22" y="-1686.8" font-family="Times,serif" font-size="14.00">D1</text>
<text text-anchor="middle" x="801.22" y="-1671.8" font-family="Times,serif" font-size="14.00">L0</text>
<text text-anchor="middle" x="801.22" y="-1656.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="801.22" y="-1641.8" font-family="Times,serif" font-size="14.00">KV from D2</text>
<text text-anchor="middle" x="657.72" y="-1622.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-1607.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-1592.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d1_l8_qkv -->
<g id="node22" class="node">
<title>d1_l8_qkv</title>
<polygon fill="lightgreen" stroke="black" points="1537.22,-1744.5 1455.22,-1744.5 1455.22,-1691.5 1537.22,-1691.5 1537.22,-1744.5"/>
<text text-anchor="middle" x="1496.22" y="-1729.3" font-family="Times,serif" font-size="14.00">D1</text>
<text text-anchor="middle" x="1496.22" y="-1714.3" font-family="Times,serif" font-size="14.00">L8</text>
<text text-anchor="middle" x="1496.22" y="-1699.3" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="1435.72" y="-1680.3" font-family="Times,serif" font-size="14.00">Input: [128, 6250, 4096]</text>
<text text-anchor="middle" x="1435.72" y="-1665.3" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 32*128]</text>
</g>
<!-- d1_l0_mlp&#45;&gt;d1_l8_qkv -->
<g id="edge16" class="edge">
<title>d1_l0_mlp&#45;&gt;d1_l8_qkv</title>
<path fill="none" stroke="black" d="M1352.73,-1718.76C1380.51,-1718.61 1416.07,-1718.42 1444.71,-1718.27"/>
<polygon fill="black" stroke="black" points="1444.94,-1721.77 1454.93,-1718.21 1444.91,-1714.77 1444.94,-1721.77"/>
</g>
<!-- d1_l8_ring_stage_8 -->
<g id="node24" class="node">
<title>d1_l8_ring_stage_8</title>
<polygon fill="yellow" stroke="black" points="1714.72,-1649 1614.72,-1649 1614.72,-1581 1714.72,-1581 1714.72,-1649"/>
<text text-anchor="middle" x="1664.72" y="-1633.8" font-family="Times,serif" font-size="14.00">D1</text>
<text text-anchor="middle" x="1664.72" y="-1618.8" font-family="Times,serif" font-size="14.00">L8</text>
<text text-anchor="middle" x="1664.72" y="-1603.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="1664.72" y="-1588.8" font-family="Times,serif" font-size="14.00">KV from D9</text>
<text text-anchor="middle" x="1521.22" y="-1569.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="1521.22" y="-1554.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="1521.22" y="-1539.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d1_l8_qkv&#45;&gt;d1_l8_ring_stage_8 -->
<g id="edge17" class="edge">
<title>d1_l8_qkv&#45;&gt;d1_l8_ring_stage_8</title>
<path fill="none" stroke="black" d="M1537.53,-1693.07C1558.1,-1680.34 1583.48,-1664.64 1606.07,-1650.66"/>
<polygon fill="black" stroke="black" points="1607.92,-1653.64 1614.58,-1645.4 1604.24,-1647.69 1607.92,-1653.64"/>
</g>
<!-- d1_l8_ring_stage_0 -->
<g id="node23" class="node">
<title>d1_l8_ring_stage_0</title>
<polygon fill="yellow" stroke="black" points="851.22,-1562 751.22,-1562 751.22,-1494 851.22,-1494 851.22,-1562"/>
<text text-anchor="middle" x="801.22" y="-1546.8" font-family="Times,serif" font-size="14.00">D1</text>
<text text-anchor="middle" x="801.22" y="-1531.8" font-family="Times,serif" font-size="14.00">L8</text>
<text text-anchor="middle" x="801.22" y="-1516.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="801.22" y="-1501.8" font-family="Times,serif" font-size="14.00">KV from D1</text>
<text text-anchor="middle" x="657.72" y="-1482.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-1467.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-1452.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d1_l8_mlp -->
<g id="node26" class="node">
<title>d1_l8_mlp</title>
<polygon fill="lightcoral" stroke="black" points="1885.22,-1588.5 1792.22,-1588.5 1792.22,-1535.5 1885.22,-1535.5 1885.22,-1588.5"/>
<text text-anchor="middle" x="1838.72" y="-1573.3" font-family="Times,serif" font-size="14.00">D1</text>
<text text-anchor="middle" x="1838.72" y="-1558.3" font-family="Times,serif" font-size="14.00">L8</text>
<text text-anchor="middle" x="1838.72" y="-1543.3" font-family="Times,serif" font-size="14.00">MLP Block</text>
<text text-anchor="middle" x="1698.72" y="-1524.3" font-family="Times,serif" font-size="14.00">Input: [128, 6250, 4096]</text>
<text text-anchor="middle" x="1698.72" y="-1509.3" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d1_l8_ring_stage_8&#45;&gt;d1_l8_mlp -->
<g id="edge18" class="edge">
<title>d1_l8_ring_stage_8&#45;&gt;d1_l8_mlp</title>
<path fill="none" stroke="black" d="M1715.01,-1599.81C1736.02,-1593.34 1760.62,-1585.76 1782.26,-1579.09"/>
<polygon fill="black" stroke="black" points="1783.44,-1582.39 1791.97,-1576.1 1781.38,-1575.7 1783.44,-1582.39"/>
</g>
<!-- d1_l8_ring_stage_15 -->
<g id="node25" class="node">
<title>d1_l8_ring_stage_15</title>
<polygon fill="yellow" stroke="black" points="851.22,-1422 751.22,-1422 751.22,-1354 851.22,-1354 851.22,-1422"/>
<text text-anchor="middle" x="801.22" y="-1406.8" font-family="Times,serif" font-size="14.00">D1</text>
<text text-anchor="middle" x="801.22" y="-1391.8" font-family="Times,serif" font-size="14.00">L8</text>
<text text-anchor="middle" x="801.22" y="-1376.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="801.22" y="-1361.8" font-family="Times,serif" font-size="14.00">KV from D2</text>
<text text-anchor="middle" x="757.72" y="-1342.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="757.72" y="-1327.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="757.72" y="-1312.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d1_l15_qkv -->
<g id="node27" class="node">
<title>d1_l15_qkv</title>
<polygon fill="lightgreen" stroke="black" points="2040.22,-1560.5 1958.22,-1560.5 1958.22,-1507.5 2040.22,-1507.5 2040.22,-1560.5"/>
<text text-anchor="middle" x="1999.22" y="-1545.3" font-family="Times,serif" font-size="14.00">D1</text>
<text text-anchor="middle" x="1999.22" y="-1530.3" font-family="Times,serif" font-size="14.00">L15</text>
<text text-anchor="middle" x="1999.22" y="-1515.3" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="1938.72" y="-1496.3" font-family="Times,serif" font-size="14.00">Input: [128, 6250, 4096]</text>
<text text-anchor="middle" x="1938.72" y="-1481.3" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 32*128]</text>
</g>
<!-- d1_l8_mlp&#45;&gt;d1_l15_qkv -->
<g id="edge19" class="edge">
<title>d1_l8_mlp&#45;&gt;d1_l15_qkv</title>
<path fill="none" stroke="black" d="M1885.57,-1553.9C1905.2,-1550.43 1928.18,-1546.37 1948.25,-1542.83"/>
<polygon fill="black" stroke="black" points="1948.9,-1546.27 1958.14,-1541.08 1947.68,-1539.37 1948.9,-1546.27"/>
</g>
<!-- d1_l15_ring_stage_15 -->
<g id="node30" class="node">
<title>d1_l15_ring_stage_15</title>
<polygon fill="yellow" stroke="black" points="2213.22,-1549 2113.22,-1549 2113.22,-1481 2213.22,-1481 2213.22,-1549"/>
<text text-anchor="middle" x="2163.22" y="-1533.8" font-family="Times,serif" font-size="14.00">D1</text>
<text text-anchor="middle" x="2163.22" y="-1518.8" font-family="Times,serif" font-size="14.00">L15</text>
<text text-anchor="middle" x="2163.22" y="-1503.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="2163.22" y="-1488.8" font-family="Times,serif" font-size="14.00">KV from D2</text>
<text text-anchor="middle" x="2306.72" y="-1469.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="2306.72" y="-1454.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="2306.72" y="-1439.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d1_l15_qkv&#45;&gt;d1_l15_ring_stage_15 -->
<g id="edge20" class="edge">
<title>d1_l15_qkv&#45;&gt;d1_l15_ring_stage_15</title>
<path fill="none" stroke="black" d="M2040.27,-1529.3C2059.19,-1527.08 2082.16,-1524.39 2103.04,-1521.94"/>
<polygon fill="black" stroke="black" points="2103.57,-1525.4 2113.09,-1520.76 2102.76,-1518.45 2103.57,-1525.4"/>
</g>
<!-- d1_l15_ring_stage_0 -->
<g id="node28" class="node">
<title>d1_l15_ring_stage_0</title>
<polygon fill="yellow" stroke="black" points="851.22,-1282 751.22,-1282 751.22,-1214 851.22,-1214 851.22,-1282"/>
<text text-anchor="middle" x="801.22" y="-1266.8" font-family="Times,serif" font-size="14.00">D1</text>
<text text-anchor="middle" x="801.22" y="-1251.8" font-family="Times,serif" font-size="14.00">L15</text>
<text text-anchor="middle" x="801.22" y="-1236.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="801.22" y="-1221.8" font-family="Times,serif" font-size="14.00">KV from D1</text>
<text text-anchor="middle" x="757.72" y="-1202.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="757.72" y="-1187.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="757.72" y="-1172.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d1_l15_ring_stage_8 -->
<g id="node29" class="node">
<title>d1_l15_ring_stage_8</title>
<polygon fill="yellow" stroke="black" points="851.22,-1142 751.22,-1142 751.22,-1074 851.22,-1074 851.22,-1142"/>
<text text-anchor="middle" x="801.22" y="-1126.8" font-family="Times,serif" font-size="14.00">D1</text>
<text text-anchor="middle" x="801.22" y="-1111.8" font-family="Times,serif" font-size="14.00">L15</text>
<text text-anchor="middle" x="801.22" y="-1096.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="801.22" y="-1081.8" font-family="Times,serif" font-size="14.00">KV from D9</text>
<text text-anchor="middle" x="657.72" y="-1062.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-1047.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-1032.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d1_l15_mlp -->
<g id="node31" class="node">
<title>d1_l15_mlp</title>
<polygon fill="lightcoral" stroke="black" points="2379.22,-1334.5 2286.22,-1334.5 2286.22,-1281.5 2379.22,-1281.5 2379.22,-1334.5"/>
<text text-anchor="middle" x="2332.72" y="-1319.3" font-family="Times,serif" font-size="14.00">D1</text>
<text text-anchor="middle" x="2332.72" y="-1304.3" font-family="Times,serif" font-size="14.00">L15</text>
<text text-anchor="middle" x="2332.72" y="-1289.3" font-family="Times,serif" font-size="14.00">MLP Block</text>
<text text-anchor="middle" x="2192.72" y="-1270.3" font-family="Times,serif" font-size="14.00">Input: [128, 6250, 4096]</text>
<text text-anchor="middle" x="2192.72" y="-1255.3" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d1_l15_ring_stage_15&#45;&gt;d1_l15_mlp -->
<g id="edge21" class="edge">
<title>d1_l15_ring_stage_15&#45;&gt;d1_l15_mlp</title>
<path fill="none" stroke="black" d="M2191.88,-1480.82C2222.85,-1442.55 2272.76,-1380.87 2303.83,-1342.48"/>
<polygon fill="black" stroke="black" points="2306.59,-1344.63 2310.16,-1334.65 2301.14,-1340.23 2306.59,-1344.63"/>
</g>
<!-- d1_l15_mlp&#45;&gt;output_agg -->
<g id="edge22" class="edge">
<title>d1_l15_mlp&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M2366.31,-1281.29C2409.17,-1246.17 2483.85,-1184.96 2525.09,-1151.15"/>
<polygon fill="black" stroke="black" points="2527.36,-1153.82 2532.88,-1144.78 2522.92,-1148.41 2527.36,-1153.82"/>
</g>
<!-- d2_l0_ring_stage_0 -->
<g id="node33" class="node">
<title>d2_l0_ring_stage_0</title>
<polygon fill="yellow" stroke="black" points="1058.22,-1002 958.22,-1002 958.22,-934 1058.22,-934 1058.22,-1002"/>
<text text-anchor="middle" x="1008.22" y="-986.8" font-family="Times,serif" font-size="14.00">D2</text>
<text text-anchor="middle" x="1008.22" y="-971.8" font-family="Times,serif" font-size="14.00">L0</text>
<text text-anchor="middle" x="1008.22" y="-956.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="1008.22" y="-941.8" font-family="Times,serif" font-size="14.00">KV from D2</text>
<text text-anchor="middle" x="864.72" y="-922.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="864.72" y="-907.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="864.72" y="-892.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d2_l0_qkv&#45;&gt;d2_l0_ring_stage_0 -->
<g id="edge24" class="edge">
<title>d2_l0_qkv&#45;&gt;d2_l0_ring_stage_0</title>
<path fill="none" stroke="black" d="M842.24,-973.63C872.23,-972.61 913.76,-971.19 947.65,-970.03"/>
<polygon fill="black" stroke="black" points="948.02,-973.52 957.9,-969.68 947.78,-966.53 948.02,-973.52"/>
</g>
<!-- d2_l0_mlp -->
<g id="node36" class="node">
<title>d2_l0_mlp</title>
<polygon fill="lightcoral" stroke="black" points="1352.72,-994.5 1259.72,-994.5 1259.72,-941.5 1352.72,-941.5 1352.72,-994.5"/>
<text text-anchor="middle" x="1306.22" y="-979.3" font-family="Times,serif" font-size="14.00">D2</text>
<text text-anchor="middle" x="1306.22" y="-964.3" font-family="Times,serif" font-size="14.00">L0</text>
<text text-anchor="middle" x="1306.22" y="-949.3" font-family="Times,serif" font-size="14.00">MLP Block</text>
<text text-anchor="middle" x="1166.22" y="-930.3" font-family="Times,serif" font-size="14.00">Input: [128, 6250, 4096]</text>
<text text-anchor="middle" x="1166.22" y="-915.3" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d2_l0_ring_stage_0&#45;&gt;d2_l0_mlp -->
<g id="edge25" class="edge">
<title>d2_l0_ring_stage_0&#45;&gt;d2_l0_mlp</title>
<path fill="none" stroke="black" d="M1058.43,-968C1110.94,-968 1193.99,-968 1249.03,-968"/>
<polygon fill="black" stroke="black" points="1249.31,-971.5 1259.31,-968 1249.31,-964.5 1249.31,-971.5"/>
</g>
<!-- d2_l0_ring_stage_8 -->
<g id="node34" class="node">
<title>d2_l0_ring_stage_8</title>
<polygon fill="yellow" stroke="black" points="855.72,-876 746.72,-876 746.72,-808 855.72,-808 855.72,-876"/>
<text text-anchor="middle" x="801.22" y="-860.8" font-family="Times,serif" font-size="14.00">D2</text>
<text text-anchor="middle" x="801.22" y="-845.8" font-family="Times,serif" font-size="14.00">L0</text>
<text text-anchor="middle" x="801.22" y="-830.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="801.22" y="-815.8" font-family="Times,serif" font-size="14.00">KV from D10</text>
<text text-anchor="middle" x="653.22" y="-796.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="653.22" y="-781.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="653.22" y="-766.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d2_l0_ring_stage_15 -->
<g id="node35" class="node">
<title>d2_l0_ring_stage_15</title>
<polygon fill="yellow" stroke="black" points="851.22,-736 751.22,-736 751.22,-668 851.22,-668 851.22,-736"/>
<text text-anchor="middle" x="801.22" y="-720.8" font-family="Times,serif" font-size="14.00">D2</text>
<text text-anchor="middle" x="801.22" y="-705.8" font-family="Times,serif" font-size="14.00">L0</text>
<text text-anchor="middle" x="801.22" y="-690.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="801.22" y="-675.8" font-family="Times,serif" font-size="14.00">KV from D3</text>
<text text-anchor="middle" x="657.72" y="-656.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-641.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-626.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d2_l8_qkv -->
<g id="node37" class="node">
<title>d2_l8_qkv</title>
<polygon fill="lightgreen" stroke="black" points="1537.22,-994.5 1455.22,-994.5 1455.22,-941.5 1537.22,-941.5 1537.22,-994.5"/>
<text text-anchor="middle" x="1496.22" y="-979.3" font-family="Times,serif" font-size="14.00">D2</text>
<text text-anchor="middle" x="1496.22" y="-964.3" font-family="Times,serif" font-size="14.00">L8</text>
<text text-anchor="middle" x="1496.22" y="-949.3" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="1435.72" y="-930.3" font-family="Times,serif" font-size="14.00">Input: [128, 6250, 4096]</text>
<text text-anchor="middle" x="1435.72" y="-915.3" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 32*128]</text>
</g>
<!-- d2_l0_mlp&#45;&gt;d2_l8_qkv -->
<g id="edge26" class="edge">
<title>d2_l0_mlp&#45;&gt;d2_l8_qkv</title>
<path fill="none" stroke="black" d="M1352.73,-968C1380.51,-968 1416.07,-968 1444.71,-968"/>
<polygon fill="black" stroke="black" points="1444.93,-971.5 1454.93,-968 1444.93,-964.5 1444.93,-971.5"/>
</g>
<!-- d2_l8_ring_stage_8 -->
<g id="node39" class="node">
<title>d2_l8_ring_stage_8</title>
<polygon fill="yellow" stroke="black" points="1719.22,-1002 1610.22,-1002 1610.22,-934 1719.22,-934 1719.22,-1002"/>
<text text-anchor="middle" x="1664.72" y="-986.8" font-family="Times,serif" font-size="14.00">D2</text>
<text text-anchor="middle" x="1664.72" y="-971.8" font-family="Times,serif" font-size="14.00">L8</text>
<text text-anchor="middle" x="1664.72" y="-956.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="1664.72" y="-941.8" font-family="Times,serif" font-size="14.00">KV from D10</text>
<text text-anchor="middle" x="1812.72" y="-922.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="1812.72" y="-907.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="1812.72" y="-892.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d2_l8_qkv&#45;&gt;d2_l8_ring_stage_8 -->
<g id="edge27" class="edge">
<title>d2_l8_qkv&#45;&gt;d2_l8_ring_stage_8</title>
<path fill="none" stroke="black" d="M1537.53,-968C1556.22,-968 1578.89,-968 1599.83,-968"/>
<polygon fill="black" stroke="black" points="1599.95,-971.5 1609.95,-968 1599.95,-964.5 1599.95,-971.5"/>
</g>
<!-- d2_l8_ring_stage_0 -->
<g id="node38" class="node">
<title>d2_l8_ring_stage_0</title>
<polygon fill="yellow" stroke="black" points="851.22,-596 751.22,-596 751.22,-528 851.22,-528 851.22,-596"/>
<text text-anchor="middle" x="801.22" y="-580.8" font-family="Times,serif" font-size="14.00">D2</text>
<text text-anchor="middle" x="801.22" y="-565.8" font-family="Times,serif" font-size="14.00">L8</text>
<text text-anchor="middle" x="801.22" y="-550.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="801.22" y="-535.8" font-family="Times,serif" font-size="14.00">KV from D2</text>
<text text-anchor="middle" x="657.72" y="-516.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-501.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-486.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d2_l8_mlp -->
<g id="node41" class="node">
<title>d2_l8_mlp</title>
<polygon fill="lightcoral" stroke="black" points="1885.22,-994.5 1792.22,-994.5 1792.22,-941.5 1885.22,-941.5 1885.22,-994.5"/>
<text text-anchor="middle" x="1838.72" y="-979.3" font-family="Times,serif" font-size="14.00">D2</text>
<text text-anchor="middle" x="1838.72" y="-964.3" font-family="Times,serif" font-size="14.00">L8</text>
<text text-anchor="middle" x="1838.72" y="-949.3" font-family="Times,serif" font-size="14.00">MLP Block</text>
<text text-anchor="middle" x="1978.72" y="-1013.3" font-family="Times,serif" font-size="14.00">Input: [128, 6250, 4096]</text>
<text text-anchor="middle" x="1978.72" y="-998.3" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d2_l8_ring_stage_8&#45;&gt;d2_l8_mlp -->
<g id="edge28" class="edge">
<title>d2_l8_ring_stage_8&#45;&gt;d2_l8_mlp</title>
<path fill="none" stroke="black" d="M1719.67,-968C1739.47,-968 1761.92,-968 1781.88,-968"/>
<polygon fill="black" stroke="black" points="1782.07,-971.5 1792.07,-968 1782.06,-964.5 1782.07,-971.5"/>
</g>
<!-- d2_l8_ring_stage_15 -->
<g id="node40" class="node">
<title>d2_l8_ring_stage_15</title>
<polygon fill="yellow" stroke="black" points="851.22,-456 751.22,-456 751.22,-388 851.22,-388 851.22,-456"/>
<text text-anchor="middle" x="801.22" y="-440.8" font-family="Times,serif" font-size="14.00">D2</text>
<text text-anchor="middle" x="801.22" y="-425.8" font-family="Times,serif" font-size="14.00">L8</text>
<text text-anchor="middle" x="801.22" y="-410.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="801.22" y="-395.8" font-family="Times,serif" font-size="14.00">KV from D3</text>
<text text-anchor="middle" x="657.72" y="-376.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-361.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-346.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d2_l15_qkv -->
<g id="node42" class="node">
<title>d2_l15_qkv</title>
<polygon fill="lightgreen" stroke="black" points="2040.22,-994.5 1958.22,-994.5 1958.22,-941.5 2040.22,-941.5 2040.22,-994.5"/>
<text text-anchor="middle" x="1999.22" y="-979.3" font-family="Times,serif" font-size="14.00">D2</text>
<text text-anchor="middle" x="1999.22" y="-964.3" font-family="Times,serif" font-size="14.00">L15</text>
<text text-anchor="middle" x="1999.22" y="-949.3" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="2141.72" y="-930.3" font-family="Times,serif" font-size="14.00">Input: [128, 6250, 4096]</text>
<text text-anchor="middle" x="2141.72" y="-915.3" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 32*128]</text>
</g>
<!-- d2_l8_mlp&#45;&gt;d2_l15_qkv -->
<g id="edge29" class="edge">
<title>d2_l8_mlp&#45;&gt;d2_l15_qkv</title>
<path fill="none" stroke="black" d="M1885.57,-968C1905.11,-968 1927.97,-968 1947.97,-968"/>
<polygon fill="black" stroke="black" points="1948.14,-971.5 1958.14,-968 1948.14,-964.5 1948.14,-971.5"/>
</g>
<!-- d2_l15_ring_stage_15 -->
<g id="node45" class="node">
<title>d2_l15_ring_stage_15</title>
<polygon fill="yellow" stroke="black" points="2213.22,-1002 2113.22,-1002 2113.22,-934 2213.22,-934 2213.22,-1002"/>
<text text-anchor="middle" x="2163.22" y="-986.8" font-family="Times,serif" font-size="14.00">D2</text>
<text text-anchor="middle" x="2163.22" y="-971.8" font-family="Times,serif" font-size="14.00">L15</text>
<text text-anchor="middle" x="2163.22" y="-956.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="2163.22" y="-941.8" font-family="Times,serif" font-size="14.00">KV from D3</text>
<text text-anchor="middle" x="2306.72" y="-1035.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="2306.72" y="-1020.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="2306.72" y="-1005.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d2_l15_qkv&#45;&gt;d2_l15_ring_stage_15 -->
<g id="edge30" class="edge">
<title>d2_l15_qkv&#45;&gt;d2_l15_ring_stage_15</title>
<path fill="none" stroke="black" d="M2040.27,-968C2059.19,-968 2082.16,-968 2103.04,-968"/>
<polygon fill="black" stroke="black" points="2103.09,-971.5 2113.09,-968 2103.09,-964.5 2103.09,-971.5"/>
</g>
<!-- d2_l15_ring_stage_0 -->
<g id="node43" class="node">
<title>d2_l15_ring_stage_0</title>
<polygon fill="yellow" stroke="black" points="851.22,-316 751.22,-316 751.22,-248 851.22,-248 851.22,-316"/>
<text text-anchor="middle" x="801.22" y="-300.8" font-family="Times,serif" font-size="14.00">D2</text>
<text text-anchor="middle" x="801.22" y="-285.8" font-family="Times,serif" font-size="14.00">L15</text>
<text text-anchor="middle" x="801.22" y="-270.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="801.22" y="-255.8" font-family="Times,serif" font-size="14.00">KV from D2</text>
<text text-anchor="middle" x="657.72" y="-236.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-221.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="657.72" y="-206.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d2_l15_ring_stage_8 -->
<g id="node44" class="node">
<title>d2_l15_ring_stage_8</title>
<polygon fill="yellow" stroke="black" points="855.72,-176 746.72,-176 746.72,-108 855.72,-108 855.72,-176"/>
<text text-anchor="middle" x="801.22" y="-160.8" font-family="Times,serif" font-size="14.00">D2</text>
<text text-anchor="middle" x="801.22" y="-145.8" font-family="Times,serif" font-size="14.00">L15</text>
<text text-anchor="middle" x="801.22" y="-130.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="801.22" y="-115.8" font-family="Times,serif" font-size="14.00">KV from D10</text>
<text text-anchor="middle" x="653.22" y="-96.8" font-family="Times,serif" font-size="14.00">Q: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="653.22" y="-81.8" font-family="Times,serif" font-size="14.00">K,V: [128, 6250, 32, 128]</text>
<text text-anchor="middle" x="653.22" y="-66.8" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d2_l15_mlp -->
<g id="node46" class="node">
<title>d2_l15_mlp</title>
<polygon fill="lightcoral" stroke="black" points="2379.22,-999.5 2286.22,-999.5 2286.22,-946.5 2379.22,-946.5 2379.22,-999.5"/>
<text text-anchor="middle" x="2332.72" y="-984.3" font-family="Times,serif" font-size="14.00">D2</text>
<text text-anchor="middle" x="2332.72" y="-969.3" font-family="Times,serif" font-size="14.00">L15</text>
<text text-anchor="middle" x="2332.72" y="-954.3" font-family="Times,serif" font-size="14.00">MLP Block</text>
<text text-anchor="middle" x="2472.72" y="-935.3" font-family="Times,serif" font-size="14.00">Input: [128, 6250, 4096]</text>
<text text-anchor="middle" x="2472.72" y="-920.3" font-family="Times,serif" font-size="14.00">Output: [128, 6250, 4096]</text>
</g>
<!-- d2_l15_ring_stage_15&#45;&gt;d2_l15_mlp -->
<g id="edge31" class="edge">
<title>d2_l15_ring_stage_15&#45;&gt;d2_l15_mlp</title>
<path fill="none" stroke="black" d="M2213.57,-969.47C2233.22,-970.06 2255.93,-970.74 2276.15,-971.34"/>
<polygon fill="black" stroke="black" points="2276.06,-974.84 2286.16,-971.64 2276.27,-967.84 2276.06,-974.84"/>
</g>
<!-- d2_l15_mlp&#45;&gt;output_agg -->
<g id="edge32" class="edge">
<title>d2_l15_mlp&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M2371.94,-999.65C2414.03,-1029 2481.06,-1075.74 2521.14,-1103.69"/>
<polygon fill="black" stroke="black" points="2519.3,-1106.68 2529.51,-1109.53 2523.31,-1100.93 2519.3,-1106.68"/>
</g>
<!-- ring_comm -->
<g id="node47" class="node">
<title>ring_comm</title>
<ellipse fill="orange" stroke="black" cx="543.84" cy="-1362" rx="117.26" ry="26.74"/>
<text text-anchor="middle" x="543.84" y="-1365.8" font-family="Times,serif" font-size="14.00">Ring Communication</text>
<text text-anchor="middle" x="543.84" y="-1350.8" font-family="Times,serif" font-size="14.00">Pattern</text>
<text text-anchor="middle" x="356.96" y="-1323.93" font-family="Times,serif" font-size="14.00">P2P Send/Recv</text>
<text text-anchor="middle" x="356.96" y="-1308.93" font-family="Times,serif" font-size="14.00">KV blocks</text>
<text text-anchor="middle" x="356.96" y="-1293.93" font-family="Times,serif" font-size="14.00">Each → next device</text>
</g>
<!-- cluster_device_1 -->
<g id="node52" class="node">
<title>cluster_device_1</title>
<polygon fill="lightgrey" stroke="black" points="1075.22,-63 941.22,-63 941.22,-27 1075.22,-27 1075.22,-63"/>
<text text-anchor="middle" x="1008.22" y="-41.3" font-family="Times,serif" font-size="14.00">cluster_device_1</text>
</g>
<!-- cluster_device_0&#45;&gt;cluster_device_1 -->
<!-- cluster_device_2 -->
<g id="node53" class="node">
<title>cluster_device_2</title>
<polygon fill="lightgrey" stroke="black" points="1373.22,-70 1239.22,-70 1239.22,-34 1373.22,-34 1373.22,-70"/>
<text text-anchor="middle" x="1306.22" y="-48.3" font-family="Times,serif" font-size="14.00">cluster_device_2</text>
</g>
<!-- cluster_device_1&#45;&gt;cluster_device_2 -->
<!-- cluster_device_2&#45;&gt;output_agg -->
</g>
</svg>
