<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_tp_pp Pages: 1 -->
<svg width="1496pt" height="10923pt"
 viewBox="0.00 0.00 1496.44 10922.74" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 10918.74)">
<title>baseline_tp_pp</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-10918.74 1492.44,-10918.74 1492.44,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_pipeline_0</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="412.44,-128 412.44,-10770 750.44,-10770 750.44,-128 412.44,-128"/>
<text text-anchor="middle" x="581.44" y="-10754.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (Devices 0&#45;7)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_mha_0</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M471.44,-10141C471.44,-10141 691.44,-10141 691.44,-10141 697.44,-10141 703.44,-10147 703.44,-10153 703.44,-10153 703.44,-10727 703.44,-10727 703.44,-10733 697.44,-10739 691.44,-10739 691.44,-10739 471.44,-10739 471.44,-10739 465.44,-10739 459.44,-10733 459.44,-10727 459.44,-10727 459.44,-10153 459.44,-10153 459.44,-10147 465.44,-10141 471.44,-10141"/>
<text text-anchor="middle" x="581.44" y="-10723.8" font-family="Times,serif" font-size="14.00">Layer 0 &#45; MHA Block</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_mlp_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M432.44,-9474C432.44,-9474 730.44,-9474 730.44,-9474 736.44,-9474 742.44,-9480 742.44,-9486 742.44,-9486 742.44,-10060 742.44,-10060 742.44,-10066 736.44,-10072 730.44,-10072 730.44,-10072 432.44,-10072 432.44,-10072 426.44,-10072 420.44,-10066 420.44,-10060 420.44,-10060 420.44,-9486 420.44,-9486 420.44,-9480 426.44,-9474 432.44,-9474"/>
<text text-anchor="middle" x="581.44" y="-10056.8" font-family="Times,serif" font-size="14.00">Layer 0 &#45; MLP Block</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_mha_1</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M471.44,-8807C471.44,-8807 691.44,-8807 691.44,-8807 697.44,-8807 703.44,-8813 703.44,-8819 703.44,-8819 703.44,-9393 703.44,-9393 703.44,-9399 697.44,-9405 691.44,-9405 691.44,-9405 471.44,-9405 471.44,-9405 465.44,-9405 459.44,-9399 459.44,-9393 459.44,-9393 459.44,-8819 459.44,-8819 459.44,-8813 465.44,-8807 471.44,-8807"/>
<text text-anchor="middle" x="581.44" y="-9389.8" font-family="Times,serif" font-size="14.00">Layer 1 &#45; MHA Block</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_mlp_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M432.44,-8140C432.44,-8140 730.44,-8140 730.44,-8140 736.44,-8140 742.44,-8146 742.44,-8152 742.44,-8152 742.44,-8726 742.44,-8726 742.44,-8732 736.44,-8738 730.44,-8738 730.44,-8738 432.44,-8738 432.44,-8738 426.44,-8738 420.44,-8732 420.44,-8726 420.44,-8726 420.44,-8152 420.44,-8152 420.44,-8146 426.44,-8140 432.44,-8140"/>
<text text-anchor="middle" x="581.44" y="-8722.8" font-family="Times,serif" font-size="14.00">Layer 1 &#45; MLP Block</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_mha_2</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M471.44,-7473C471.44,-7473 691.44,-7473 691.44,-7473 697.44,-7473 703.44,-7479 703.44,-7485 703.44,-7485 703.44,-8059 703.44,-8059 703.44,-8065 697.44,-8071 691.44,-8071 691.44,-8071 471.44,-8071 471.44,-8071 465.44,-8071 459.44,-8065 459.44,-8059 459.44,-8059 459.44,-7485 459.44,-7485 459.44,-7479 465.44,-7473 471.44,-7473"/>
<text text-anchor="middle" x="581.44" y="-8055.8" font-family="Times,serif" font-size="14.00">Layer 2 &#45; MHA Block</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_mlp_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M432.44,-6806C432.44,-6806 730.44,-6806 730.44,-6806 736.44,-6806 742.44,-6812 742.44,-6818 742.44,-6818 742.44,-7392 742.44,-7392 742.44,-7398 736.44,-7404 730.44,-7404 730.44,-7404 432.44,-7404 432.44,-7404 426.44,-7404 420.44,-7398 420.44,-7392 420.44,-7392 420.44,-6818 420.44,-6818 420.44,-6812 426.44,-6806 432.44,-6806"/>
<text text-anchor="middle" x="581.44" y="-7388.8" font-family="Times,serif" font-size="14.00">Layer 2 &#45; MLP Block</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_mha_3</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M471.44,-6139C471.44,-6139 691.44,-6139 691.44,-6139 697.44,-6139 703.44,-6145 703.44,-6151 703.44,-6151 703.44,-6725 703.44,-6725 703.44,-6731 697.44,-6737 691.44,-6737 691.44,-6737 471.44,-6737 471.44,-6737 465.44,-6737 459.44,-6731 459.44,-6725 459.44,-6725 459.44,-6151 459.44,-6151 459.44,-6145 465.44,-6139 471.44,-6139"/>
<text text-anchor="middle" x="581.44" y="-6721.8" font-family="Times,serif" font-size="14.00">Layer 3 &#45; MHA Block</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_mlp_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M432.44,-5472C432.44,-5472 730.44,-5472 730.44,-5472 736.44,-5472 742.44,-5478 742.44,-5484 742.44,-5484 742.44,-6058 742.44,-6058 742.44,-6064 736.44,-6070 730.44,-6070 730.44,-6070 432.44,-6070 432.44,-6070 426.44,-6070 420.44,-6064 420.44,-6058 420.44,-6058 420.44,-5484 420.44,-5484 420.44,-5478 426.44,-5472 432.44,-5472"/>
<text text-anchor="middle" x="581.44" y="-6054.8" font-family="Times,serif" font-size="14.00">Layer 3 &#45; MLP Block</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_mha_4</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M471.44,-4805C471.44,-4805 691.44,-4805 691.44,-4805 697.44,-4805 703.44,-4811 703.44,-4817 703.44,-4817 703.44,-5391 703.44,-5391 703.44,-5397 697.44,-5403 691.44,-5403 691.44,-5403 471.44,-5403 471.44,-5403 465.44,-5403 459.44,-5397 459.44,-5391 459.44,-5391 459.44,-4817 459.44,-4817 459.44,-4811 465.44,-4805 471.44,-4805"/>
<text text-anchor="middle" x="581.44" y="-5387.8" font-family="Times,serif" font-size="14.00">Layer 4 &#45; MHA Block</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_mlp_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M432.44,-4138C432.44,-4138 730.44,-4138 730.44,-4138 736.44,-4138 742.44,-4144 742.44,-4150 742.44,-4150 742.44,-4724 742.44,-4724 742.44,-4730 736.44,-4736 730.44,-4736 730.44,-4736 432.44,-4736 432.44,-4736 426.44,-4736 420.44,-4730 420.44,-4724 420.44,-4724 420.44,-4150 420.44,-4150 420.44,-4144 426.44,-4138 432.44,-4138"/>
<text text-anchor="middle" x="581.44" y="-4720.8" font-family="Times,serif" font-size="14.00">Layer 4 &#45; MLP Block</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_mha_5</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M471.44,-3471C471.44,-3471 691.44,-3471 691.44,-3471 697.44,-3471 703.44,-3477 703.44,-3483 703.44,-3483 703.44,-4057 703.44,-4057 703.44,-4063 697.44,-4069 691.44,-4069 691.44,-4069 471.44,-4069 471.44,-4069 465.44,-4069 459.44,-4063 459.44,-4057 459.44,-4057 459.44,-3483 459.44,-3483 459.44,-3477 465.44,-3471 471.44,-3471"/>
<text text-anchor="middle" x="581.44" y="-4053.8" font-family="Times,serif" font-size="14.00">Layer 5 &#45; MHA Block</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_mlp_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M432.44,-2804C432.44,-2804 730.44,-2804 730.44,-2804 736.44,-2804 742.44,-2810 742.44,-2816 742.44,-2816 742.44,-3390 742.44,-3390 742.44,-3396 736.44,-3402 730.44,-3402 730.44,-3402 432.44,-3402 432.44,-3402 426.44,-3402 420.44,-3396 420.44,-3390 420.44,-3390 420.44,-2816 420.44,-2816 420.44,-2810 426.44,-2804 432.44,-2804"/>
<text text-anchor="middle" x="581.44" y="-3386.8" font-family="Times,serif" font-size="14.00">Layer 5 &#45; MLP Block</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_mha_6</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M471.44,-2137C471.44,-2137 691.44,-2137 691.44,-2137 697.44,-2137 703.44,-2143 703.44,-2149 703.44,-2149 703.44,-2723 703.44,-2723 703.44,-2729 697.44,-2735 691.44,-2735 691.44,-2735 471.44,-2735 471.44,-2735 465.44,-2735 459.44,-2729 459.44,-2723 459.44,-2723 459.44,-2149 459.44,-2149 459.44,-2143 465.44,-2137 471.44,-2137"/>
<text text-anchor="middle" x="581.44" y="-2719.8" font-family="Times,serif" font-size="14.00">Layer 6 &#45; MHA Block</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_mlp_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M432.44,-1470C432.44,-1470 730.44,-1470 730.44,-1470 736.44,-1470 742.44,-1476 742.44,-1482 742.44,-1482 742.44,-2056 742.44,-2056 742.44,-2062 736.44,-2068 730.44,-2068 730.44,-2068 432.44,-2068 432.44,-2068 426.44,-2068 420.44,-2062 420.44,-2056 420.44,-2056 420.44,-1482 420.44,-1482 420.44,-1476 426.44,-1470 432.44,-1470"/>
<text text-anchor="middle" x="581.44" y="-2052.8" font-family="Times,serif" font-size="14.00">Layer 6 &#45; MLP Block</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_mha_7</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M471.44,-803C471.44,-803 691.44,-803 691.44,-803 697.44,-803 703.44,-809 703.44,-815 703.44,-815 703.44,-1389 703.44,-1389 703.44,-1395 697.44,-1401 691.44,-1401 691.44,-1401 471.44,-1401 471.44,-1401 465.44,-1401 459.44,-1395 459.44,-1389 459.44,-1389 459.44,-815 459.44,-815 459.44,-809 465.44,-803 471.44,-803"/>
<text text-anchor="middle" x="581.44" y="-1385.8" font-family="Times,serif" font-size="14.00">Layer 7 &#45; MHA Block</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_mlp_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M432.44,-136C432.44,-136 730.44,-136 730.44,-136 736.44,-136 742.44,-142 742.44,-148 742.44,-148 742.44,-722 742.44,-722 742.44,-728 736.44,-734 730.44,-734 730.44,-734 432.44,-734 432.44,-734 426.44,-734 420.44,-728 420.44,-722 420.44,-722 420.44,-148 420.44,-148 420.44,-142 426.44,-136 432.44,-136"/>
<text text-anchor="middle" x="581.44" y="-718.8" font-family="Times,serif" font-size="14.00">Layer 7 &#45; MLP Block</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_pipeline_1</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="777.44,-1462 777.44,-10770 1480.44,-10770 1480.44,-1462 777.44,-1462"/>
<text text-anchor="middle" x="1128.94" y="-10754.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (Devices 8&#45;15)</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_mha_8</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1201.44,-10141C1201.44,-10141 1421.44,-10141 1421.44,-10141 1427.44,-10141 1433.44,-10147 1433.44,-10153 1433.44,-10153 1433.44,-10727 1433.44,-10727 1433.44,-10733 1427.44,-10739 1421.44,-10739 1421.44,-10739 1201.44,-10739 1201.44,-10739 1195.44,-10739 1189.44,-10733 1189.44,-10727 1189.44,-10727 1189.44,-10153 1189.44,-10153 1189.44,-10147 1195.44,-10141 1201.44,-10141"/>
<text text-anchor="middle" x="1311.44" y="-10723.8" font-family="Times,serif" font-size="14.00">Layer 8 &#45; MHA Block</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_mlp_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1162.44,-9474C1162.44,-9474 1460.44,-9474 1460.44,-9474 1466.44,-9474 1472.44,-9480 1472.44,-9486 1472.44,-9486 1472.44,-10060 1472.44,-10060 1472.44,-10066 1466.44,-10072 1460.44,-10072 1460.44,-10072 1162.44,-10072 1162.44,-10072 1156.44,-10072 1150.44,-10066 1150.44,-10060 1150.44,-10060 1150.44,-9486 1150.44,-9486 1150.44,-9480 1156.44,-9474 1162.44,-9474"/>
<text text-anchor="middle" x="1311.44" y="-10056.8" font-family="Times,serif" font-size="14.00">Layer 8 &#45; MLP Block</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_mha_9</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M836.44,-10141C836.44,-10141 1056.44,-10141 1056.44,-10141 1062.44,-10141 1068.44,-10147 1068.44,-10153 1068.44,-10153 1068.44,-10727 1068.44,-10727 1068.44,-10733 1062.44,-10739 1056.44,-10739 1056.44,-10739 836.44,-10739 836.44,-10739 830.44,-10739 824.44,-10733 824.44,-10727 824.44,-10727 824.44,-10153 824.44,-10153 824.44,-10147 830.44,-10141 836.44,-10141"/>
<text text-anchor="middle" x="946.44" y="-10723.8" font-family="Times,serif" font-size="14.00">Layer 9 &#45; MHA Block</text>
</g>
<g id="clust22" class="cluster">
<title>cluster_mlp_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M797.44,-9474C797.44,-9474 1095.44,-9474 1095.44,-9474 1101.44,-9474 1107.44,-9480 1107.44,-9486 1107.44,-9486 1107.44,-10060 1107.44,-10060 1107.44,-10066 1101.44,-10072 1095.44,-10072 1095.44,-10072 797.44,-10072 797.44,-10072 791.44,-10072 785.44,-10066 785.44,-10060 785.44,-10060 785.44,-9486 785.44,-9486 785.44,-9480 791.44,-9474 797.44,-9474"/>
<text text-anchor="middle" x="946.44" y="-10056.8" font-family="Times,serif" font-size="14.00">Layer 9 &#45; MLP Block</text>
</g>
<g id="clust23" class="cluster">
<title>cluster_mha_10</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M836.44,-8807C836.44,-8807 1056.44,-8807 1056.44,-8807 1062.44,-8807 1068.44,-8813 1068.44,-8819 1068.44,-8819 1068.44,-9393 1068.44,-9393 1068.44,-9399 1062.44,-9405 1056.44,-9405 1056.44,-9405 836.44,-9405 836.44,-9405 830.44,-9405 824.44,-9399 824.44,-9393 824.44,-9393 824.44,-8819 824.44,-8819 824.44,-8813 830.44,-8807 836.44,-8807"/>
<text text-anchor="middle" x="946.44" y="-9389.8" font-family="Times,serif" font-size="14.00">Layer 10 &#45; MHA Block</text>
</g>
<g id="clust24" class="cluster">
<title>cluster_mlp_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M797.44,-8140C797.44,-8140 1095.44,-8140 1095.44,-8140 1101.44,-8140 1107.44,-8146 1107.44,-8152 1107.44,-8152 1107.44,-8726 1107.44,-8726 1107.44,-8732 1101.44,-8738 1095.44,-8738 1095.44,-8738 797.44,-8738 797.44,-8738 791.44,-8738 785.44,-8732 785.44,-8726 785.44,-8726 785.44,-8152 785.44,-8152 785.44,-8146 791.44,-8140 797.44,-8140"/>
<text text-anchor="middle" x="946.44" y="-8722.8" font-family="Times,serif" font-size="14.00">Layer 10 &#45; MLP Block</text>
</g>
<g id="clust25" class="cluster">
<title>cluster_mha_11</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M836.44,-7473C836.44,-7473 1056.44,-7473 1056.44,-7473 1062.44,-7473 1068.44,-7479 1068.44,-7485 1068.44,-7485 1068.44,-8059 1068.44,-8059 1068.44,-8065 1062.44,-8071 1056.44,-8071 1056.44,-8071 836.44,-8071 836.44,-8071 830.44,-8071 824.44,-8065 824.44,-8059 824.44,-8059 824.44,-7485 824.44,-7485 824.44,-7479 830.44,-7473 836.44,-7473"/>
<text text-anchor="middle" x="946.44" y="-8055.8" font-family="Times,serif" font-size="14.00">Layer 11 &#45; MHA Block</text>
</g>
<g id="clust26" class="cluster">
<title>cluster_mlp_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M797.44,-6806C797.44,-6806 1095.44,-6806 1095.44,-6806 1101.44,-6806 1107.44,-6812 1107.44,-6818 1107.44,-6818 1107.44,-7392 1107.44,-7392 1107.44,-7398 1101.44,-7404 1095.44,-7404 1095.44,-7404 797.44,-7404 797.44,-7404 791.44,-7404 785.44,-7398 785.44,-7392 785.44,-7392 785.44,-6818 785.44,-6818 785.44,-6812 791.44,-6806 797.44,-6806"/>
<text text-anchor="middle" x="946.44" y="-7388.8" font-family="Times,serif" font-size="14.00">Layer 11 &#45; MLP Block</text>
</g>
<g id="clust27" class="cluster">
<title>cluster_mha_12</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M836.44,-6139C836.44,-6139 1056.44,-6139 1056.44,-6139 1062.44,-6139 1068.44,-6145 1068.44,-6151 1068.44,-6151 1068.44,-6725 1068.44,-6725 1068.44,-6731 1062.44,-6737 1056.44,-6737 1056.44,-6737 836.44,-6737 836.44,-6737 830.44,-6737 824.44,-6731 824.44,-6725 824.44,-6725 824.44,-6151 824.44,-6151 824.44,-6145 830.44,-6139 836.44,-6139"/>
<text text-anchor="middle" x="946.44" y="-6721.8" font-family="Times,serif" font-size="14.00">Layer 12 &#45; MHA Block</text>
</g>
<g id="clust28" class="cluster">
<title>cluster_mlp_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M797.44,-5472C797.44,-5472 1095.44,-5472 1095.44,-5472 1101.44,-5472 1107.44,-5478 1107.44,-5484 1107.44,-5484 1107.44,-6058 1107.44,-6058 1107.44,-6064 1101.44,-6070 1095.44,-6070 1095.44,-6070 797.44,-6070 797.44,-6070 791.44,-6070 785.44,-6064 785.44,-6058 785.44,-6058 785.44,-5484 785.44,-5484 785.44,-5478 791.44,-5472 797.44,-5472"/>
<text text-anchor="middle" x="946.44" y="-6054.8" font-family="Times,serif" font-size="14.00">Layer 12 &#45; MLP Block</text>
</g>
<g id="clust29" class="cluster">
<title>cluster_mha_13</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M836.44,-4805C836.44,-4805 1056.44,-4805 1056.44,-4805 1062.44,-4805 1068.44,-4811 1068.44,-4817 1068.44,-4817 1068.44,-5391 1068.44,-5391 1068.44,-5397 1062.44,-5403 1056.44,-5403 1056.44,-5403 836.44,-5403 836.44,-5403 830.44,-5403 824.44,-5397 824.44,-5391 824.44,-5391 824.44,-4817 824.44,-4817 824.44,-4811 830.44,-4805 836.44,-4805"/>
<text text-anchor="middle" x="946.44" y="-5387.8" font-family="Times,serif" font-size="14.00">Layer 13 &#45; MHA Block</text>
</g>
<g id="clust30" class="cluster">
<title>cluster_mlp_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M797.44,-4138C797.44,-4138 1095.44,-4138 1095.44,-4138 1101.44,-4138 1107.44,-4144 1107.44,-4150 1107.44,-4150 1107.44,-4724 1107.44,-4724 1107.44,-4730 1101.44,-4736 1095.44,-4736 1095.44,-4736 797.44,-4736 797.44,-4736 791.44,-4736 785.44,-4730 785.44,-4724 785.44,-4724 785.44,-4150 785.44,-4150 785.44,-4144 791.44,-4138 797.44,-4138"/>
<text text-anchor="middle" x="946.44" y="-4720.8" font-family="Times,serif" font-size="14.00">Layer 13 &#45; MLP Block</text>
</g>
<g id="clust31" class="cluster">
<title>cluster_mha_14</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M836.44,-3471C836.44,-3471 1056.44,-3471 1056.44,-3471 1062.44,-3471 1068.44,-3477 1068.44,-3483 1068.44,-3483 1068.44,-4057 1068.44,-4057 1068.44,-4063 1062.44,-4069 1056.44,-4069 1056.44,-4069 836.44,-4069 836.44,-4069 830.44,-4069 824.44,-4063 824.44,-4057 824.44,-4057 824.44,-3483 824.44,-3483 824.44,-3477 830.44,-3471 836.44,-3471"/>
<text text-anchor="middle" x="946.44" y="-4053.8" font-family="Times,serif" font-size="14.00">Layer 14 &#45; MHA Block</text>
</g>
<g id="clust32" class="cluster">
<title>cluster_mlp_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M797.44,-2804C797.44,-2804 1095.44,-2804 1095.44,-2804 1101.44,-2804 1107.44,-2810 1107.44,-2816 1107.44,-2816 1107.44,-3390 1107.44,-3390 1107.44,-3396 1101.44,-3402 1095.44,-3402 1095.44,-3402 797.44,-3402 797.44,-3402 791.44,-3402 785.44,-3396 785.44,-3390 785.44,-3390 785.44,-2816 785.44,-2816 785.44,-2810 791.44,-2804 797.44,-2804"/>
<text text-anchor="middle" x="946.44" y="-3386.8" font-family="Times,serif" font-size="14.00">Layer 14 &#45; MLP Block</text>
</g>
<g id="clust33" class="cluster">
<title>cluster_mha_15</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M836.44,-2137C836.44,-2137 1056.44,-2137 1056.44,-2137 1062.44,-2137 1068.44,-2143 1068.44,-2149 1068.44,-2149 1068.44,-2723 1068.44,-2723 1068.44,-2729 1062.44,-2735 1056.44,-2735 1056.44,-2735 836.44,-2735 836.44,-2735 830.44,-2735 824.44,-2729 824.44,-2723 824.44,-2723 824.44,-2149 824.44,-2149 824.44,-2143 830.44,-2137 836.44,-2137"/>
<text text-anchor="middle" x="946.44" y="-2719.8" font-family="Times,serif" font-size="14.00">Layer 15 &#45; MHA Block</text>
</g>
<g id="clust34" class="cluster">
<title>cluster_mlp_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M797.44,-1470C797.44,-1470 1095.44,-1470 1095.44,-1470 1101.44,-1470 1107.44,-1476 1107.44,-1482 1107.44,-1482 1107.44,-2056 1107.44,-2056 1107.44,-2062 1101.44,-2068 1095.44,-2068 1095.44,-2068 797.44,-2068 797.44,-2068 791.44,-2068 785.44,-2062 785.44,-2056 785.44,-2056 785.44,-1482 785.44,-1482 785.44,-1476 791.44,-1470 797.44,-1470"/>
<text text-anchor="middle" x="946.44" y="-2052.8" font-family="Times,serif" font-size="14.00">Layer 15 &#45; MLP Block</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="581.44" cy="-10842.87" rx="91.78" ry="18"/>
<text text-anchor="middle" x="581.44" y="-10839.17" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="275.8" y="-10879.67" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="275.8" y="-10864.67" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_0_qkv -->
<g id="node2" class="node">
<title>layer_0_qkv</title>
<polygon fill="lightgreen" stroke="black" points="651.44,-10708 511.44,-10708 511.44,-10655 651.44,-10655 651.44,-10708"/>
<text text-anchor="middle" x="581.44" y="-10692.8" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="581.44" y="-10677.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="581.44" y="-10662.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="261.44" y="-10688.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="261.44" y="-10673.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="261.44" y="-10658.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- input&#45;&gt;layer_0_qkv -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_0_qkv</title>
<path fill="none" stroke="black" d="M581.44,-10824.81C581.44,-10799.53 581.44,-10751.51 581.44,-10718.29"/>
<polygon fill="black" stroke="black" points="584.94,-10718.07 581.44,-10708.07 577.94,-10718.07 584.94,-10718.07"/>
</g>
<!-- layer_0_attn -->
<g id="node3" class="node">
<title>layer_0_attn</title>
<polygon fill="yellow" stroke="black" points="665.44,-10547 497.44,-10547 497.44,-10494 665.44,-10494 665.44,-10547"/>
<text text-anchor="middle" x="581.44" y="-10531.8" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="581.44" y="-10516.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="581.44" y="-10501.8" font-family="Times,serif" font-size="14.00">(All Devices)</text>
<text text-anchor="middle" x="253.44" y="-10580.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="253.44" y="-10565.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.44" y="-10550.8" font-family="Times,serif" font-size="14.00">All GPUs: 0&#45;7</text>
</g>
<!-- layer_0_qkv&#45;&gt;layer_0_attn -->
<g id="edge2" class="edge">
<title>layer_0_qkv&#45;&gt;layer_0_attn</title>
<path fill="none" stroke="black" d="M581.44,-10654.95C581.44,-10628.61 581.44,-10587.29 581.44,-10557.61"/>
<polygon fill="black" stroke="black" points="584.94,-10557.25 581.44,-10547.25 577.94,-10557.25 584.94,-10557.25"/>
</g>
<!-- layer_0_attn_out -->
<g id="node4" class="node">
<title>layer_0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="650.44,-10386 512.44,-10386 512.44,-10333 650.44,-10333 650.44,-10386"/>
<text text-anchor="middle" x="581.44" y="-10370.8" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="581.44" y="-10355.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="581.44" y="-10340.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="298.44" y="-10419.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="298.44" y="-10404.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="298.44" y="-10389.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_0_attn&#45;&gt;layer_0_attn_out -->
<g id="edge3" class="edge">
<title>layer_0_attn&#45;&gt;layer_0_attn_out</title>
<path fill="none" stroke="black" d="M581.44,-10493.95C581.44,-10467.61 581.44,-10426.29 581.44,-10396.61"/>
<polygon fill="black" stroke="black" points="584.94,-10396.25 581.44,-10386.25 577.94,-10396.25 584.94,-10396.25"/>
</g>
<!-- layer_0_residual -->
<g id="node5" class="node">
<title>layer_0_residual</title>
<polygon fill="lightgray" stroke="black" points="695.53,-10225 514.04,-10225 467.35,-10149 648.84,-10149 695.53,-10225"/>
<text text-anchor="middle" x="581.44" y="-10190.8" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="581.44" y="-10175.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="253.4" y="-10258.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.4" y="-10243.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.4" y="-10228.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_0_attn_out&#45;&gt;layer_0_residual -->
<g id="edge4" class="edge">
<title>layer_0_attn_out&#45;&gt;layer_0_residual</title>
<path fill="none" stroke="black" d="M581.44,-10332.97C581.44,-10307.27 581.44,-10267 581.44,-10235.42"/>
<polygon fill="black" stroke="black" points="584.94,-10235.08 581.44,-10225.08 577.94,-10235.08 584.94,-10235.08"/>
</g>
<!-- layer_0_gate -->
<g id="node6" class="node">
<title>layer_0_gate</title>
<polygon fill="lightcoral" stroke="black" points="651.44,-10041 511.44,-10041 511.44,-9988 651.44,-9988 651.44,-10041"/>
<text text-anchor="middle" x="581.44" y="-10025.8" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="581.44" y="-10010.8" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="581.44" y="-9995.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="285.94" y="-10021.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="285.94" y="-10006.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="285.94" y="-9991.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_0_residual&#45;&gt;layer_0_gate -->
<g id="edge5" class="edge">
<title>layer_0_residual&#45;&gt;layer_0_gate</title>
<path fill="none" stroke="black" d="M581.44,-10148.58C581.44,-10119.73 581.44,-10080.05 581.44,-10051.55"/>
<polygon fill="black" stroke="black" points="584.94,-10051.21 581.44,-10041.21 577.94,-10051.21 584.94,-10051.21"/>
</g>
<!-- layer_0_up -->
<g id="node7" class="node">
<title>layer_0_up</title>
<polygon fill="lightcoral" stroke="black" points="651.44,-9880 511.44,-9880 511.44,-9827 651.44,-9827 651.44,-9880"/>
<text text-anchor="middle" x="581.44" y="-9864.8" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="581.44" y="-9849.8" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="581.44" y="-9834.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="285.94" y="-9913.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="285.94" y="-9898.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="285.94" y="-9883.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_up -->
<g id="edge6" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_up</title>
<path fill="none" stroke="black" d="M581.44,-9987.95C581.44,-9961.61 581.44,-9920.29 581.44,-9890.61"/>
<polygon fill="black" stroke="black" points="584.94,-9890.25 581.44,-9880.25 577.94,-9890.25 584.94,-9890.25"/>
</g>
<!-- layer_0_down -->
<g id="node8" class="node">
<title>layer_0_down</title>
<polygon fill="lightcoral" stroke="black" points="639.44,-9719 523.44,-9719 523.44,-9666 639.44,-9666 639.44,-9719"/>
<text text-anchor="middle" x="581.44" y="-9703.8" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="581.44" y="-9688.8" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="581.44" y="-9673.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="303.94" y="-9752.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="303.94" y="-9737.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="303.94" y="-9722.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_0_up&#45;&gt;layer_0_down -->
<g id="edge7" class="edge">
<title>layer_0_up&#45;&gt;layer_0_down</title>
<path fill="none" stroke="black" d="M581.44,-9826.95C581.44,-9800.61 581.44,-9759.29 581.44,-9729.61"/>
<polygon fill="black" stroke="black" points="584.94,-9729.25 581.44,-9719.25 577.94,-9729.25 584.94,-9729.25"/>
</g>
<!-- layer_0_mlp_residual -->
<g id="node9" class="node">
<title>layer_0_mlp_residual</title>
<polygon fill="lightgray" stroke="black" points="734.82,-9558 490.83,-9558 428.06,-9482 672.05,-9482 734.82,-9558"/>
<text text-anchor="middle" x="581.44" y="-9523.8" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="581.44" y="-9508.8" font-family="Times,serif" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="214" y="-9591.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="214" y="-9576.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="214" y="-9561.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_0_down&#45;&gt;layer_0_mlp_residual -->
<g id="edge8" class="edge">
<title>layer_0_down&#45;&gt;layer_0_mlp_residual</title>
<path fill="none" stroke="black" d="M581.44,-9665.97C581.44,-9640.27 581.44,-9600 581.44,-9568.42"/>
<polygon fill="black" stroke="black" points="584.94,-9568.08 581.44,-9558.08 577.94,-9568.08 584.94,-9568.08"/>
</g>
<!-- layer_1_qkv -->
<g id="node10" class="node">
<title>layer_1_qkv</title>
<polygon fill="lightgreen" stroke="black" points="651.44,-9374 511.44,-9374 511.44,-9321 651.44,-9321 651.44,-9374"/>
<text text-anchor="middle" x="581.44" y="-9358.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="581.44" y="-9343.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="581.44" y="-9328.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="261.44" y="-9354.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="261.44" y="-9339.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="261.44" y="-9324.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_0_mlp_residual&#45;&gt;layer_1_qkv -->
<g id="edge9" class="edge">
<title>layer_0_mlp_residual&#45;&gt;layer_1_qkv</title>
<path fill="none" stroke="black" d="M581.44,-9481.58C581.44,-9452.73 581.44,-9413.05 581.44,-9384.55"/>
<polygon fill="black" stroke="black" points="584.94,-9384.21 581.44,-9374.21 577.94,-9384.21 584.94,-9384.21"/>
</g>
<!-- layer_1_attn -->
<g id="node11" class="node">
<title>layer_1_attn</title>
<polygon fill="yellow" stroke="black" points="665.44,-9213 497.44,-9213 497.44,-9160 665.44,-9160 665.44,-9213"/>
<text text-anchor="middle" x="581.44" y="-9197.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="581.44" y="-9182.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="581.44" y="-9167.8" font-family="Times,serif" font-size="14.00">(All Devices)</text>
<text text-anchor="middle" x="253.44" y="-9246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="253.44" y="-9231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.44" y="-9216.8" font-family="Times,serif" font-size="14.00">All GPUs: 0&#45;7</text>
</g>
<!-- layer_1_qkv&#45;&gt;layer_1_attn -->
<g id="edge10" class="edge">
<title>layer_1_qkv&#45;&gt;layer_1_attn</title>
<path fill="none" stroke="black" d="M581.44,-9320.95C581.44,-9294.61 581.44,-9253.29 581.44,-9223.61"/>
<polygon fill="black" stroke="black" points="584.94,-9223.25 581.44,-9213.25 577.94,-9223.25 584.94,-9223.25"/>
</g>
<!-- layer_1_attn_out -->
<g id="node12" class="node">
<title>layer_1_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="650.44,-9052 512.44,-9052 512.44,-8999 650.44,-8999 650.44,-9052"/>
<text text-anchor="middle" x="581.44" y="-9036.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="581.44" y="-9021.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="581.44" y="-9006.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="298.44" y="-9085.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="298.44" y="-9070.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="298.44" y="-9055.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_1_attn&#45;&gt;layer_1_attn_out -->
<g id="edge11" class="edge">
<title>layer_1_attn&#45;&gt;layer_1_attn_out</title>
<path fill="none" stroke="black" d="M581.44,-9159.95C581.44,-9133.61 581.44,-9092.29 581.44,-9062.61"/>
<polygon fill="black" stroke="black" points="584.94,-9062.25 581.44,-9052.25 577.94,-9062.25 584.94,-9062.25"/>
</g>
<!-- layer_1_residual -->
<g id="node13" class="node">
<title>layer_1_residual</title>
<polygon fill="lightgray" stroke="black" points="695.53,-8891 514.04,-8891 467.35,-8815 648.84,-8815 695.53,-8891"/>
<text text-anchor="middle" x="581.44" y="-8856.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="581.44" y="-8841.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="253.4" y="-8924.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.4" y="-8909.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.4" y="-8894.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_1_attn_out&#45;&gt;layer_1_residual -->
<g id="edge12" class="edge">
<title>layer_1_attn_out&#45;&gt;layer_1_residual</title>
<path fill="none" stroke="black" d="M581.44,-8998.97C581.44,-8973.27 581.44,-8933 581.44,-8901.42"/>
<polygon fill="black" stroke="black" points="584.94,-8901.08 581.44,-8891.08 577.94,-8901.08 584.94,-8901.08"/>
</g>
<!-- layer_1_gate -->
<g id="node14" class="node">
<title>layer_1_gate</title>
<polygon fill="lightcoral" stroke="black" points="651.44,-8707 511.44,-8707 511.44,-8654 651.44,-8654 651.44,-8707"/>
<text text-anchor="middle" x="581.44" y="-8691.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="581.44" y="-8676.8" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="581.44" y="-8661.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="285.94" y="-8687.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="285.94" y="-8672.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="285.94" y="-8657.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_1_residual&#45;&gt;layer_1_gate -->
<g id="edge13" class="edge">
<title>layer_1_residual&#45;&gt;layer_1_gate</title>
<path fill="none" stroke="black" d="M581.44,-8814.58C581.44,-8785.73 581.44,-8746.05 581.44,-8717.55"/>
<polygon fill="black" stroke="black" points="584.94,-8717.21 581.44,-8707.21 577.94,-8717.21 584.94,-8717.21"/>
</g>
<!-- layer_1_up -->
<g id="node15" class="node">
<title>layer_1_up</title>
<polygon fill="lightcoral" stroke="black" points="651.44,-8546 511.44,-8546 511.44,-8493 651.44,-8493 651.44,-8546"/>
<text text-anchor="middle" x="581.44" y="-8530.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="581.44" y="-8515.8" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="581.44" y="-8500.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="285.94" y="-8579.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="285.94" y="-8564.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="285.94" y="-8549.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_up -->
<g id="edge14" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_up</title>
<path fill="none" stroke="black" d="M581.44,-8653.95C581.44,-8627.61 581.44,-8586.29 581.44,-8556.61"/>
<polygon fill="black" stroke="black" points="584.94,-8556.25 581.44,-8546.25 577.94,-8556.25 584.94,-8556.25"/>
</g>
<!-- layer_1_down -->
<g id="node16" class="node">
<title>layer_1_down</title>
<polygon fill="lightcoral" stroke="black" points="639.44,-8385 523.44,-8385 523.44,-8332 639.44,-8332 639.44,-8385"/>
<text text-anchor="middle" x="581.44" y="-8369.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="581.44" y="-8354.8" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="581.44" y="-8339.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="303.94" y="-8418.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="303.94" y="-8403.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="303.94" y="-8388.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_1_up&#45;&gt;layer_1_down -->
<g id="edge15" class="edge">
<title>layer_1_up&#45;&gt;layer_1_down</title>
<path fill="none" stroke="black" d="M581.44,-8492.95C581.44,-8466.61 581.44,-8425.29 581.44,-8395.61"/>
<polygon fill="black" stroke="black" points="584.94,-8395.25 581.44,-8385.25 577.94,-8395.25 584.94,-8395.25"/>
</g>
<!-- layer_1_mlp_residual -->
<g id="node17" class="node">
<title>layer_1_mlp_residual</title>
<polygon fill="lightgray" stroke="black" points="734.82,-8224 490.83,-8224 428.06,-8148 672.05,-8148 734.82,-8224"/>
<text text-anchor="middle" x="581.44" y="-8189.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="581.44" y="-8174.8" font-family="Times,serif" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="214" y="-8257.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="214" y="-8242.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="214" y="-8227.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_1_down&#45;&gt;layer_1_mlp_residual -->
<g id="edge16" class="edge">
<title>layer_1_down&#45;&gt;layer_1_mlp_residual</title>
<path fill="none" stroke="black" d="M581.44,-8331.97C581.44,-8306.27 581.44,-8266 581.44,-8234.42"/>
<polygon fill="black" stroke="black" points="584.94,-8234.08 581.44,-8224.08 577.94,-8234.08 584.94,-8234.08"/>
</g>
<!-- layer_2_qkv -->
<g id="node18" class="node">
<title>layer_2_qkv</title>
<polygon fill="lightgreen" stroke="black" points="651.44,-8040 511.44,-8040 511.44,-7987 651.44,-7987 651.44,-8040"/>
<text text-anchor="middle" x="581.44" y="-8024.8" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="581.44" y="-8009.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="581.44" y="-7994.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="261.44" y="-8020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="261.44" y="-8005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="261.44" y="-7990.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_1_mlp_residual&#45;&gt;layer_2_qkv -->
<g id="edge17" class="edge">
<title>layer_1_mlp_residual&#45;&gt;layer_2_qkv</title>
<path fill="none" stroke="black" d="M581.44,-8147.58C581.44,-8118.73 581.44,-8079.05 581.44,-8050.55"/>
<polygon fill="black" stroke="black" points="584.94,-8050.21 581.44,-8040.21 577.94,-8050.21 584.94,-8050.21"/>
</g>
<!-- layer_2_attn -->
<g id="node19" class="node">
<title>layer_2_attn</title>
<polygon fill="yellow" stroke="black" points="665.44,-7879 497.44,-7879 497.44,-7826 665.44,-7826 665.44,-7879"/>
<text text-anchor="middle" x="581.44" y="-7863.8" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="581.44" y="-7848.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="581.44" y="-7833.8" font-family="Times,serif" font-size="14.00">(All Devices)</text>
<text text-anchor="middle" x="253.44" y="-7912.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="253.44" y="-7897.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.44" y="-7882.8" font-family="Times,serif" font-size="14.00">All GPUs: 0&#45;7</text>
</g>
<!-- layer_2_qkv&#45;&gt;layer_2_attn -->
<g id="edge18" class="edge">
<title>layer_2_qkv&#45;&gt;layer_2_attn</title>
<path fill="none" stroke="black" d="M581.44,-7986.95C581.44,-7960.61 581.44,-7919.29 581.44,-7889.61"/>
<polygon fill="black" stroke="black" points="584.94,-7889.25 581.44,-7879.25 577.94,-7889.25 584.94,-7889.25"/>
</g>
<!-- layer_2_attn_out -->
<g id="node20" class="node">
<title>layer_2_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="650.44,-7718 512.44,-7718 512.44,-7665 650.44,-7665 650.44,-7718"/>
<text text-anchor="middle" x="581.44" y="-7702.8" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="581.44" y="-7687.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="581.44" y="-7672.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="298.44" y="-7751.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="298.44" y="-7736.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="298.44" y="-7721.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_2_attn&#45;&gt;layer_2_attn_out -->
<g id="edge19" class="edge">
<title>layer_2_attn&#45;&gt;layer_2_attn_out</title>
<path fill="none" stroke="black" d="M581.44,-7825.95C581.44,-7799.61 581.44,-7758.29 581.44,-7728.61"/>
<polygon fill="black" stroke="black" points="584.94,-7728.25 581.44,-7718.25 577.94,-7728.25 584.94,-7728.25"/>
</g>
<!-- layer_2_residual -->
<g id="node21" class="node">
<title>layer_2_residual</title>
<polygon fill="lightgray" stroke="black" points="695.53,-7557 514.04,-7557 467.35,-7481 648.84,-7481 695.53,-7557"/>
<text text-anchor="middle" x="581.44" y="-7522.8" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="581.44" y="-7507.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="253.4" y="-7590.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.4" y="-7575.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.4" y="-7560.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_2_attn_out&#45;&gt;layer_2_residual -->
<g id="edge20" class="edge">
<title>layer_2_attn_out&#45;&gt;layer_2_residual</title>
<path fill="none" stroke="black" d="M581.44,-7664.97C581.44,-7639.27 581.44,-7599 581.44,-7567.42"/>
<polygon fill="black" stroke="black" points="584.94,-7567.08 581.44,-7557.08 577.94,-7567.08 584.94,-7567.08"/>
</g>
<!-- layer_2_gate -->
<g id="node22" class="node">
<title>layer_2_gate</title>
<polygon fill="lightcoral" stroke="black" points="651.44,-7373 511.44,-7373 511.44,-7320 651.44,-7320 651.44,-7373"/>
<text text-anchor="middle" x="581.44" y="-7357.8" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="581.44" y="-7342.8" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="581.44" y="-7327.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="285.94" y="-7353.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="285.94" y="-7338.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="285.94" y="-7323.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_2_residual&#45;&gt;layer_2_gate -->
<g id="edge21" class="edge">
<title>layer_2_residual&#45;&gt;layer_2_gate</title>
<path fill="none" stroke="black" d="M581.44,-7480.58C581.44,-7451.73 581.44,-7412.05 581.44,-7383.55"/>
<polygon fill="black" stroke="black" points="584.94,-7383.21 581.44,-7373.21 577.94,-7383.21 584.94,-7383.21"/>
</g>
<!-- layer_2_up -->
<g id="node23" class="node">
<title>layer_2_up</title>
<polygon fill="lightcoral" stroke="black" points="651.44,-7212 511.44,-7212 511.44,-7159 651.44,-7159 651.44,-7212"/>
<text text-anchor="middle" x="581.44" y="-7196.8" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="581.44" y="-7181.8" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="581.44" y="-7166.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="285.94" y="-7245.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="285.94" y="-7230.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="285.94" y="-7215.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_up -->
<g id="edge22" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_up</title>
<path fill="none" stroke="black" d="M581.44,-7319.95C581.44,-7293.61 581.44,-7252.29 581.44,-7222.61"/>
<polygon fill="black" stroke="black" points="584.94,-7222.25 581.44,-7212.25 577.94,-7222.25 584.94,-7222.25"/>
</g>
<!-- layer_2_down -->
<g id="node24" class="node">
<title>layer_2_down</title>
<polygon fill="lightcoral" stroke="black" points="639.44,-7051 523.44,-7051 523.44,-6998 639.44,-6998 639.44,-7051"/>
<text text-anchor="middle" x="581.44" y="-7035.8" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="581.44" y="-7020.8" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="581.44" y="-7005.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="303.94" y="-7084.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="303.94" y="-7069.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="303.94" y="-7054.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_2_up&#45;&gt;layer_2_down -->
<g id="edge23" class="edge">
<title>layer_2_up&#45;&gt;layer_2_down</title>
<path fill="none" stroke="black" d="M581.44,-7158.95C581.44,-7132.61 581.44,-7091.29 581.44,-7061.61"/>
<polygon fill="black" stroke="black" points="584.94,-7061.25 581.44,-7051.25 577.94,-7061.25 584.94,-7061.25"/>
</g>
<!-- layer_2_mlp_residual -->
<g id="node25" class="node">
<title>layer_2_mlp_residual</title>
<polygon fill="lightgray" stroke="black" points="734.82,-6890 490.83,-6890 428.06,-6814 672.05,-6814 734.82,-6890"/>
<text text-anchor="middle" x="581.44" y="-6855.8" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="581.44" y="-6840.8" font-family="Times,serif" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="214" y="-6923.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="214" y="-6908.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="214" y="-6893.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_2_down&#45;&gt;layer_2_mlp_residual -->
<g id="edge24" class="edge">
<title>layer_2_down&#45;&gt;layer_2_mlp_residual</title>
<path fill="none" stroke="black" d="M581.44,-6997.97C581.44,-6972.27 581.44,-6932 581.44,-6900.42"/>
<polygon fill="black" stroke="black" points="584.94,-6900.08 581.44,-6890.08 577.94,-6900.08 584.94,-6900.08"/>
</g>
<!-- layer_3_qkv -->
<g id="node26" class="node">
<title>layer_3_qkv</title>
<polygon fill="lightgreen" stroke="black" points="651.44,-6706 511.44,-6706 511.44,-6653 651.44,-6653 651.44,-6706"/>
<text text-anchor="middle" x="581.44" y="-6690.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="581.44" y="-6675.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="581.44" y="-6660.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="261.44" y="-6686.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="261.44" y="-6671.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="261.44" y="-6656.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_2_mlp_residual&#45;&gt;layer_3_qkv -->
<g id="edge25" class="edge">
<title>layer_2_mlp_residual&#45;&gt;layer_3_qkv</title>
<path fill="none" stroke="black" d="M581.44,-6813.58C581.44,-6784.73 581.44,-6745.05 581.44,-6716.55"/>
<polygon fill="black" stroke="black" points="584.94,-6716.21 581.44,-6706.21 577.94,-6716.21 584.94,-6716.21"/>
</g>
<!-- layer_3_attn -->
<g id="node27" class="node">
<title>layer_3_attn</title>
<polygon fill="yellow" stroke="black" points="665.44,-6545 497.44,-6545 497.44,-6492 665.44,-6492 665.44,-6545"/>
<text text-anchor="middle" x="581.44" y="-6529.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="581.44" y="-6514.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="581.44" y="-6499.8" font-family="Times,serif" font-size="14.00">(All Devices)</text>
<text text-anchor="middle" x="253.44" y="-6578.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="253.44" y="-6563.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.44" y="-6548.8" font-family="Times,serif" font-size="14.00">All GPUs: 0&#45;7</text>
</g>
<!-- layer_3_qkv&#45;&gt;layer_3_attn -->
<g id="edge26" class="edge">
<title>layer_3_qkv&#45;&gt;layer_3_attn</title>
<path fill="none" stroke="black" d="M581.44,-6652.95C581.44,-6626.61 581.44,-6585.29 581.44,-6555.61"/>
<polygon fill="black" stroke="black" points="584.94,-6555.25 581.44,-6545.25 577.94,-6555.25 584.94,-6555.25"/>
</g>
<!-- layer_3_attn_out -->
<g id="node28" class="node">
<title>layer_3_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="650.44,-6384 512.44,-6384 512.44,-6331 650.44,-6331 650.44,-6384"/>
<text text-anchor="middle" x="581.44" y="-6368.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="581.44" y="-6353.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="581.44" y="-6338.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="298.44" y="-6417.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="298.44" y="-6402.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="298.44" y="-6387.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_3_attn&#45;&gt;layer_3_attn_out -->
<g id="edge27" class="edge">
<title>layer_3_attn&#45;&gt;layer_3_attn_out</title>
<path fill="none" stroke="black" d="M581.44,-6491.95C581.44,-6465.61 581.44,-6424.29 581.44,-6394.61"/>
<polygon fill="black" stroke="black" points="584.94,-6394.25 581.44,-6384.25 577.94,-6394.25 584.94,-6394.25"/>
</g>
<!-- layer_3_residual -->
<g id="node29" class="node">
<title>layer_3_residual</title>
<polygon fill="lightgray" stroke="black" points="695.53,-6223 514.04,-6223 467.35,-6147 648.84,-6147 695.53,-6223"/>
<text text-anchor="middle" x="581.44" y="-6188.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="581.44" y="-6173.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="253.4" y="-6256.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.4" y="-6241.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.4" y="-6226.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_3_attn_out&#45;&gt;layer_3_residual -->
<g id="edge28" class="edge">
<title>layer_3_attn_out&#45;&gt;layer_3_residual</title>
<path fill="none" stroke="black" d="M581.44,-6330.97C581.44,-6305.27 581.44,-6265 581.44,-6233.42"/>
<polygon fill="black" stroke="black" points="584.94,-6233.08 581.44,-6223.08 577.94,-6233.08 584.94,-6233.08"/>
</g>
<!-- layer_3_gate -->
<g id="node30" class="node">
<title>layer_3_gate</title>
<polygon fill="lightcoral" stroke="black" points="651.44,-6039 511.44,-6039 511.44,-5986 651.44,-5986 651.44,-6039"/>
<text text-anchor="middle" x="581.44" y="-6023.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="581.44" y="-6008.8" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="581.44" y="-5993.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="285.94" y="-6019.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="285.94" y="-6004.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="285.94" y="-5989.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_3_residual&#45;&gt;layer_3_gate -->
<g id="edge29" class="edge">
<title>layer_3_residual&#45;&gt;layer_3_gate</title>
<path fill="none" stroke="black" d="M581.44,-6146.58C581.44,-6117.73 581.44,-6078.05 581.44,-6049.55"/>
<polygon fill="black" stroke="black" points="584.94,-6049.21 581.44,-6039.21 577.94,-6049.21 584.94,-6049.21"/>
</g>
<!-- layer_3_up -->
<g id="node31" class="node">
<title>layer_3_up</title>
<polygon fill="lightcoral" stroke="black" points="651.44,-5878 511.44,-5878 511.44,-5825 651.44,-5825 651.44,-5878"/>
<text text-anchor="middle" x="581.44" y="-5862.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="581.44" y="-5847.8" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="581.44" y="-5832.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="285.94" y="-5911.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="285.94" y="-5896.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="285.94" y="-5881.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_up -->
<g id="edge30" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_up</title>
<path fill="none" stroke="black" d="M581.44,-5985.95C581.44,-5959.61 581.44,-5918.29 581.44,-5888.61"/>
<polygon fill="black" stroke="black" points="584.94,-5888.25 581.44,-5878.25 577.94,-5888.25 584.94,-5888.25"/>
</g>
<!-- layer_3_down -->
<g id="node32" class="node">
<title>layer_3_down</title>
<polygon fill="lightcoral" stroke="black" points="639.44,-5717 523.44,-5717 523.44,-5664 639.44,-5664 639.44,-5717"/>
<text text-anchor="middle" x="581.44" y="-5701.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="581.44" y="-5686.8" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="581.44" y="-5671.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="303.94" y="-5750.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="303.94" y="-5735.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="303.94" y="-5720.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_3_up&#45;&gt;layer_3_down -->
<g id="edge31" class="edge">
<title>layer_3_up&#45;&gt;layer_3_down</title>
<path fill="none" stroke="black" d="M581.44,-5824.95C581.44,-5798.61 581.44,-5757.29 581.44,-5727.61"/>
<polygon fill="black" stroke="black" points="584.94,-5727.25 581.44,-5717.25 577.94,-5727.25 584.94,-5727.25"/>
</g>
<!-- layer_3_mlp_residual -->
<g id="node33" class="node">
<title>layer_3_mlp_residual</title>
<polygon fill="lightgray" stroke="black" points="734.82,-5556 490.83,-5556 428.06,-5480 672.05,-5480 734.82,-5556"/>
<text text-anchor="middle" x="581.44" y="-5521.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="581.44" y="-5506.8" font-family="Times,serif" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="214" y="-5589.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="214" y="-5574.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="214" y="-5559.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_3_down&#45;&gt;layer_3_mlp_residual -->
<g id="edge32" class="edge">
<title>layer_3_down&#45;&gt;layer_3_mlp_residual</title>
<path fill="none" stroke="black" d="M581.44,-5663.97C581.44,-5638.27 581.44,-5598 581.44,-5566.42"/>
<polygon fill="black" stroke="black" points="584.94,-5566.08 581.44,-5556.08 577.94,-5566.08 584.94,-5566.08"/>
</g>
<!-- layer_4_qkv -->
<g id="node34" class="node">
<title>layer_4_qkv</title>
<polygon fill="lightgreen" stroke="black" points="651.44,-5372 511.44,-5372 511.44,-5319 651.44,-5319 651.44,-5372"/>
<text text-anchor="middle" x="581.44" y="-5356.8" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="581.44" y="-5341.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="581.44" y="-5326.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="261.44" y="-5352.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="261.44" y="-5337.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="261.44" y="-5322.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_3_mlp_residual&#45;&gt;layer_4_qkv -->
<g id="edge33" class="edge">
<title>layer_3_mlp_residual&#45;&gt;layer_4_qkv</title>
<path fill="none" stroke="black" d="M581.44,-5479.58C581.44,-5450.73 581.44,-5411.05 581.44,-5382.55"/>
<polygon fill="black" stroke="black" points="584.94,-5382.21 581.44,-5372.21 577.94,-5382.21 584.94,-5382.21"/>
</g>
<!-- layer_4_attn -->
<g id="node35" class="node">
<title>layer_4_attn</title>
<polygon fill="yellow" stroke="black" points="665.44,-5211 497.44,-5211 497.44,-5158 665.44,-5158 665.44,-5211"/>
<text text-anchor="middle" x="581.44" y="-5195.8" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="581.44" y="-5180.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="581.44" y="-5165.8" font-family="Times,serif" font-size="14.00">(All Devices)</text>
<text text-anchor="middle" x="253.44" y="-5244.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="253.44" y="-5229.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.44" y="-5214.8" font-family="Times,serif" font-size="14.00">All GPUs: 0&#45;7</text>
</g>
<!-- layer_4_qkv&#45;&gt;layer_4_attn -->
<g id="edge34" class="edge">
<title>layer_4_qkv&#45;&gt;layer_4_attn</title>
<path fill="none" stroke="black" d="M581.44,-5318.95C581.44,-5292.61 581.44,-5251.29 581.44,-5221.61"/>
<polygon fill="black" stroke="black" points="584.94,-5221.25 581.44,-5211.25 577.94,-5221.25 584.94,-5221.25"/>
</g>
<!-- layer_4_attn_out -->
<g id="node36" class="node">
<title>layer_4_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="650.44,-5050 512.44,-5050 512.44,-4997 650.44,-4997 650.44,-5050"/>
<text text-anchor="middle" x="581.44" y="-5034.8" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="581.44" y="-5019.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="581.44" y="-5004.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="298.44" y="-5083.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="298.44" y="-5068.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="298.44" y="-5053.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_4_attn&#45;&gt;layer_4_attn_out -->
<g id="edge35" class="edge">
<title>layer_4_attn&#45;&gt;layer_4_attn_out</title>
<path fill="none" stroke="black" d="M581.44,-5157.95C581.44,-5131.61 581.44,-5090.29 581.44,-5060.61"/>
<polygon fill="black" stroke="black" points="584.94,-5060.25 581.44,-5050.25 577.94,-5060.25 584.94,-5060.25"/>
</g>
<!-- layer_4_residual -->
<g id="node37" class="node">
<title>layer_4_residual</title>
<polygon fill="lightgray" stroke="black" points="695.53,-4889 514.04,-4889 467.35,-4813 648.84,-4813 695.53,-4889"/>
<text text-anchor="middle" x="581.44" y="-4854.8" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="581.44" y="-4839.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="253.4" y="-4922.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.4" y="-4907.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.4" y="-4892.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_4_attn_out&#45;&gt;layer_4_residual -->
<g id="edge36" class="edge">
<title>layer_4_attn_out&#45;&gt;layer_4_residual</title>
<path fill="none" stroke="black" d="M581.44,-4996.97C581.44,-4971.27 581.44,-4931 581.44,-4899.42"/>
<polygon fill="black" stroke="black" points="584.94,-4899.08 581.44,-4889.08 577.94,-4899.08 584.94,-4899.08"/>
</g>
<!-- layer_4_gate -->
<g id="node38" class="node">
<title>layer_4_gate</title>
<polygon fill="lightcoral" stroke="black" points="651.44,-4705 511.44,-4705 511.44,-4652 651.44,-4652 651.44,-4705"/>
<text text-anchor="middle" x="581.44" y="-4689.8" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="581.44" y="-4674.8" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="581.44" y="-4659.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="285.94" y="-4685.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="285.94" y="-4670.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="285.94" y="-4655.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_4_residual&#45;&gt;layer_4_gate -->
<g id="edge37" class="edge">
<title>layer_4_residual&#45;&gt;layer_4_gate</title>
<path fill="none" stroke="black" d="M581.44,-4812.58C581.44,-4783.73 581.44,-4744.05 581.44,-4715.55"/>
<polygon fill="black" stroke="black" points="584.94,-4715.21 581.44,-4705.21 577.94,-4715.21 584.94,-4715.21"/>
</g>
<!-- layer_4_up -->
<g id="node39" class="node">
<title>layer_4_up</title>
<polygon fill="lightcoral" stroke="black" points="651.44,-4544 511.44,-4544 511.44,-4491 651.44,-4491 651.44,-4544"/>
<text text-anchor="middle" x="581.44" y="-4528.8" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="581.44" y="-4513.8" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="581.44" y="-4498.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="285.94" y="-4577.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="285.94" y="-4562.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="285.94" y="-4547.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_up -->
<g id="edge38" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_up</title>
<path fill="none" stroke="black" d="M581.44,-4651.95C581.44,-4625.61 581.44,-4584.29 581.44,-4554.61"/>
<polygon fill="black" stroke="black" points="584.94,-4554.25 581.44,-4544.25 577.94,-4554.25 584.94,-4554.25"/>
</g>
<!-- layer_4_down -->
<g id="node40" class="node">
<title>layer_4_down</title>
<polygon fill="lightcoral" stroke="black" points="639.44,-4383 523.44,-4383 523.44,-4330 639.44,-4330 639.44,-4383"/>
<text text-anchor="middle" x="581.44" y="-4367.8" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="581.44" y="-4352.8" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="581.44" y="-4337.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="303.94" y="-4416.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="303.94" y="-4401.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="303.94" y="-4386.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_4_up&#45;&gt;layer_4_down -->
<g id="edge39" class="edge">
<title>layer_4_up&#45;&gt;layer_4_down</title>
<path fill="none" stroke="black" d="M581.44,-4490.95C581.44,-4464.61 581.44,-4423.29 581.44,-4393.61"/>
<polygon fill="black" stroke="black" points="584.94,-4393.25 581.44,-4383.25 577.94,-4393.25 584.94,-4393.25"/>
</g>
<!-- layer_4_mlp_residual -->
<g id="node41" class="node">
<title>layer_4_mlp_residual</title>
<polygon fill="lightgray" stroke="black" points="734.82,-4222 490.83,-4222 428.06,-4146 672.05,-4146 734.82,-4222"/>
<text text-anchor="middle" x="581.44" y="-4187.8" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="581.44" y="-4172.8" font-family="Times,serif" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="214" y="-4255.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="214" y="-4240.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="214" y="-4225.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_4_down&#45;&gt;layer_4_mlp_residual -->
<g id="edge40" class="edge">
<title>layer_4_down&#45;&gt;layer_4_mlp_residual</title>
<path fill="none" stroke="black" d="M581.44,-4329.97C581.44,-4304.27 581.44,-4264 581.44,-4232.42"/>
<polygon fill="black" stroke="black" points="584.94,-4232.08 581.44,-4222.08 577.94,-4232.08 584.94,-4232.08"/>
</g>
<!-- layer_5_qkv -->
<g id="node42" class="node">
<title>layer_5_qkv</title>
<polygon fill="lightgreen" stroke="black" points="651.44,-4038 511.44,-4038 511.44,-3985 651.44,-3985 651.44,-4038"/>
<text text-anchor="middle" x="581.44" y="-4022.8" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="581.44" y="-4007.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="581.44" y="-3992.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="261.44" y="-4018.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="261.44" y="-4003.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="261.44" y="-3988.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_4_mlp_residual&#45;&gt;layer_5_qkv -->
<g id="edge41" class="edge">
<title>layer_4_mlp_residual&#45;&gt;layer_5_qkv</title>
<path fill="none" stroke="black" d="M581.44,-4145.58C581.44,-4116.73 581.44,-4077.05 581.44,-4048.55"/>
<polygon fill="black" stroke="black" points="584.94,-4048.21 581.44,-4038.21 577.94,-4048.21 584.94,-4048.21"/>
</g>
<!-- layer_5_attn -->
<g id="node43" class="node">
<title>layer_5_attn</title>
<polygon fill="yellow" stroke="black" points="665.44,-3877 497.44,-3877 497.44,-3824 665.44,-3824 665.44,-3877"/>
<text text-anchor="middle" x="581.44" y="-3861.8" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="581.44" y="-3846.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="581.44" y="-3831.8" font-family="Times,serif" font-size="14.00">(All Devices)</text>
<text text-anchor="middle" x="253.44" y="-3910.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="253.44" y="-3895.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.44" y="-3880.8" font-family="Times,serif" font-size="14.00">All GPUs: 0&#45;7</text>
</g>
<!-- layer_5_qkv&#45;&gt;layer_5_attn -->
<g id="edge42" class="edge">
<title>layer_5_qkv&#45;&gt;layer_5_attn</title>
<path fill="none" stroke="black" d="M581.44,-3984.95C581.44,-3958.61 581.44,-3917.29 581.44,-3887.61"/>
<polygon fill="black" stroke="black" points="584.94,-3887.25 581.44,-3877.25 577.94,-3887.25 584.94,-3887.25"/>
</g>
<!-- layer_5_attn_out -->
<g id="node44" class="node">
<title>layer_5_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="650.44,-3716 512.44,-3716 512.44,-3663 650.44,-3663 650.44,-3716"/>
<text text-anchor="middle" x="581.44" y="-3700.8" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="581.44" y="-3685.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="581.44" y="-3670.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="298.44" y="-3749.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="298.44" y="-3734.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="298.44" y="-3719.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_5_attn&#45;&gt;layer_5_attn_out -->
<g id="edge43" class="edge">
<title>layer_5_attn&#45;&gt;layer_5_attn_out</title>
<path fill="none" stroke="black" d="M581.44,-3823.95C581.44,-3797.61 581.44,-3756.29 581.44,-3726.61"/>
<polygon fill="black" stroke="black" points="584.94,-3726.25 581.44,-3716.25 577.94,-3726.25 584.94,-3726.25"/>
</g>
<!-- layer_5_residual -->
<g id="node45" class="node">
<title>layer_5_residual</title>
<polygon fill="lightgray" stroke="black" points="695.53,-3555 514.04,-3555 467.35,-3479 648.84,-3479 695.53,-3555"/>
<text text-anchor="middle" x="581.44" y="-3520.8" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="581.44" y="-3505.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="253.4" y="-3588.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.4" y="-3573.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.4" y="-3558.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_5_attn_out&#45;&gt;layer_5_residual -->
<g id="edge44" class="edge">
<title>layer_5_attn_out&#45;&gt;layer_5_residual</title>
<path fill="none" stroke="black" d="M581.44,-3662.97C581.44,-3637.27 581.44,-3597 581.44,-3565.42"/>
<polygon fill="black" stroke="black" points="584.94,-3565.08 581.44,-3555.08 577.94,-3565.08 584.94,-3565.08"/>
</g>
<!-- layer_5_gate -->
<g id="node46" class="node">
<title>layer_5_gate</title>
<polygon fill="lightcoral" stroke="black" points="651.44,-3371 511.44,-3371 511.44,-3318 651.44,-3318 651.44,-3371"/>
<text text-anchor="middle" x="581.44" y="-3355.8" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="581.44" y="-3340.8" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="581.44" y="-3325.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="285.94" y="-3351.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="285.94" y="-3336.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="285.94" y="-3321.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_5_residual&#45;&gt;layer_5_gate -->
<g id="edge45" class="edge">
<title>layer_5_residual&#45;&gt;layer_5_gate</title>
<path fill="none" stroke="black" d="M581.44,-3478.58C581.44,-3449.73 581.44,-3410.05 581.44,-3381.55"/>
<polygon fill="black" stroke="black" points="584.94,-3381.21 581.44,-3371.21 577.94,-3381.21 584.94,-3381.21"/>
</g>
<!-- layer_5_up -->
<g id="node47" class="node">
<title>layer_5_up</title>
<polygon fill="lightcoral" stroke="black" points="651.44,-3210 511.44,-3210 511.44,-3157 651.44,-3157 651.44,-3210"/>
<text text-anchor="middle" x="581.44" y="-3194.8" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="581.44" y="-3179.8" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="581.44" y="-3164.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="285.94" y="-3243.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="285.94" y="-3228.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="285.94" y="-3213.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_up -->
<g id="edge46" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_up</title>
<path fill="none" stroke="black" d="M581.44,-3317.95C581.44,-3291.61 581.44,-3250.29 581.44,-3220.61"/>
<polygon fill="black" stroke="black" points="584.94,-3220.25 581.44,-3210.25 577.94,-3220.25 584.94,-3220.25"/>
</g>
<!-- layer_5_down -->
<g id="node48" class="node">
<title>layer_5_down</title>
<polygon fill="lightcoral" stroke="black" points="639.44,-3049 523.44,-3049 523.44,-2996 639.44,-2996 639.44,-3049"/>
<text text-anchor="middle" x="581.44" y="-3033.8" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="581.44" y="-3018.8" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="581.44" y="-3003.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="303.94" y="-3082.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="303.94" y="-3067.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="303.94" y="-3052.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_5_up&#45;&gt;layer_5_down -->
<g id="edge47" class="edge">
<title>layer_5_up&#45;&gt;layer_5_down</title>
<path fill="none" stroke="black" d="M581.44,-3156.95C581.44,-3130.61 581.44,-3089.29 581.44,-3059.61"/>
<polygon fill="black" stroke="black" points="584.94,-3059.25 581.44,-3049.25 577.94,-3059.25 584.94,-3059.25"/>
</g>
<!-- layer_5_mlp_residual -->
<g id="node49" class="node">
<title>layer_5_mlp_residual</title>
<polygon fill="lightgray" stroke="black" points="734.82,-2888 490.83,-2888 428.06,-2812 672.05,-2812 734.82,-2888"/>
<text text-anchor="middle" x="581.44" y="-2853.8" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="581.44" y="-2838.8" font-family="Times,serif" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="214" y="-2921.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="214" y="-2906.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="214" y="-2891.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_5_down&#45;&gt;layer_5_mlp_residual -->
<g id="edge48" class="edge">
<title>layer_5_down&#45;&gt;layer_5_mlp_residual</title>
<path fill="none" stroke="black" d="M581.44,-2995.97C581.44,-2970.27 581.44,-2930 581.44,-2898.42"/>
<polygon fill="black" stroke="black" points="584.94,-2898.08 581.44,-2888.08 577.94,-2898.08 584.94,-2898.08"/>
</g>
<!-- layer_6_qkv -->
<g id="node50" class="node">
<title>layer_6_qkv</title>
<polygon fill="lightgreen" stroke="black" points="651.44,-2704 511.44,-2704 511.44,-2651 651.44,-2651 651.44,-2704"/>
<text text-anchor="middle" x="581.44" y="-2688.8" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="581.44" y="-2673.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="581.44" y="-2658.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="261.44" y="-2684.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="261.44" y="-2669.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="261.44" y="-2654.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_5_mlp_residual&#45;&gt;layer_6_qkv -->
<g id="edge49" class="edge">
<title>layer_5_mlp_residual&#45;&gt;layer_6_qkv</title>
<path fill="none" stroke="black" d="M581.44,-2811.58C581.44,-2782.73 581.44,-2743.05 581.44,-2714.55"/>
<polygon fill="black" stroke="black" points="584.94,-2714.21 581.44,-2704.21 577.94,-2714.21 584.94,-2714.21"/>
</g>
<!-- layer_6_attn -->
<g id="node51" class="node">
<title>layer_6_attn</title>
<polygon fill="yellow" stroke="black" points="665.44,-2543 497.44,-2543 497.44,-2490 665.44,-2490 665.44,-2543"/>
<text text-anchor="middle" x="581.44" y="-2527.8" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="581.44" y="-2512.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="581.44" y="-2497.8" font-family="Times,serif" font-size="14.00">(All Devices)</text>
<text text-anchor="middle" x="253.44" y="-2576.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="253.44" y="-2561.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.44" y="-2546.8" font-family="Times,serif" font-size="14.00">All GPUs: 0&#45;7</text>
</g>
<!-- layer_6_qkv&#45;&gt;layer_6_attn -->
<g id="edge50" class="edge">
<title>layer_6_qkv&#45;&gt;layer_6_attn</title>
<path fill="none" stroke="black" d="M581.44,-2650.95C581.44,-2624.61 581.44,-2583.29 581.44,-2553.61"/>
<polygon fill="black" stroke="black" points="584.94,-2553.25 581.44,-2543.25 577.94,-2553.25 584.94,-2553.25"/>
</g>
<!-- layer_6_attn_out -->
<g id="node52" class="node">
<title>layer_6_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="650.44,-2382 512.44,-2382 512.44,-2329 650.44,-2329 650.44,-2382"/>
<text text-anchor="middle" x="581.44" y="-2366.8" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="581.44" y="-2351.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="581.44" y="-2336.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="298.44" y="-2415.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="298.44" y="-2400.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="298.44" y="-2385.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_6_attn&#45;&gt;layer_6_attn_out -->
<g id="edge51" class="edge">
<title>layer_6_attn&#45;&gt;layer_6_attn_out</title>
<path fill="none" stroke="black" d="M581.44,-2489.95C581.44,-2463.61 581.44,-2422.29 581.44,-2392.61"/>
<polygon fill="black" stroke="black" points="584.94,-2392.25 581.44,-2382.25 577.94,-2392.25 584.94,-2392.25"/>
</g>
<!-- layer_6_residual -->
<g id="node53" class="node">
<title>layer_6_residual</title>
<polygon fill="lightgray" stroke="black" points="695.53,-2221 514.04,-2221 467.35,-2145 648.84,-2145 695.53,-2221"/>
<text text-anchor="middle" x="581.44" y="-2186.8" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="581.44" y="-2171.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="253.4" y="-2254.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.4" y="-2239.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.4" y="-2224.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_6_attn_out&#45;&gt;layer_6_residual -->
<g id="edge52" class="edge">
<title>layer_6_attn_out&#45;&gt;layer_6_residual</title>
<path fill="none" stroke="black" d="M581.44,-2328.97C581.44,-2303.27 581.44,-2263 581.44,-2231.42"/>
<polygon fill="black" stroke="black" points="584.94,-2231.08 581.44,-2221.08 577.94,-2231.08 584.94,-2231.08"/>
</g>
<!-- layer_6_gate -->
<g id="node54" class="node">
<title>layer_6_gate</title>
<polygon fill="lightcoral" stroke="black" points="651.44,-2037 511.44,-2037 511.44,-1984 651.44,-1984 651.44,-2037"/>
<text text-anchor="middle" x="581.44" y="-2021.8" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="581.44" y="-2006.8" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="581.44" y="-1991.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="285.94" y="-2017.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="285.94" y="-2002.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="285.94" y="-1987.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_6_residual&#45;&gt;layer_6_gate -->
<g id="edge53" class="edge">
<title>layer_6_residual&#45;&gt;layer_6_gate</title>
<path fill="none" stroke="black" d="M581.44,-2144.58C581.44,-2115.73 581.44,-2076.05 581.44,-2047.55"/>
<polygon fill="black" stroke="black" points="584.94,-2047.21 581.44,-2037.21 577.94,-2047.21 584.94,-2047.21"/>
</g>
<!-- layer_6_up -->
<g id="node55" class="node">
<title>layer_6_up</title>
<polygon fill="lightcoral" stroke="black" points="651.44,-1876 511.44,-1876 511.44,-1823 651.44,-1823 651.44,-1876"/>
<text text-anchor="middle" x="581.44" y="-1860.8" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="581.44" y="-1845.8" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="581.44" y="-1830.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="285.94" y="-1909.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="285.94" y="-1894.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="285.94" y="-1879.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_up -->
<g id="edge54" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_up</title>
<path fill="none" stroke="black" d="M581.44,-1983.95C581.44,-1957.61 581.44,-1916.29 581.44,-1886.61"/>
<polygon fill="black" stroke="black" points="584.94,-1886.25 581.44,-1876.25 577.94,-1886.25 584.94,-1886.25"/>
</g>
<!-- layer_6_down -->
<g id="node56" class="node">
<title>layer_6_down</title>
<polygon fill="lightcoral" stroke="black" points="639.44,-1715 523.44,-1715 523.44,-1662 639.44,-1662 639.44,-1715"/>
<text text-anchor="middle" x="581.44" y="-1699.8" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="581.44" y="-1684.8" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="581.44" y="-1669.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="303.94" y="-1748.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="303.94" y="-1733.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="303.94" y="-1718.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_6_up&#45;&gt;layer_6_down -->
<g id="edge55" class="edge">
<title>layer_6_up&#45;&gt;layer_6_down</title>
<path fill="none" stroke="black" d="M581.44,-1822.95C581.44,-1796.61 581.44,-1755.29 581.44,-1725.61"/>
<polygon fill="black" stroke="black" points="584.94,-1725.25 581.44,-1715.25 577.94,-1725.25 584.94,-1725.25"/>
</g>
<!-- layer_6_mlp_residual -->
<g id="node57" class="node">
<title>layer_6_mlp_residual</title>
<polygon fill="lightgray" stroke="black" points="734.82,-1554 490.83,-1554 428.06,-1478 672.05,-1478 734.82,-1554"/>
<text text-anchor="middle" x="581.44" y="-1519.8" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="581.44" y="-1504.8" font-family="Times,serif" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="214" y="-1587.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="214" y="-1572.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="214" y="-1557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_6_down&#45;&gt;layer_6_mlp_residual -->
<g id="edge56" class="edge">
<title>layer_6_down&#45;&gt;layer_6_mlp_residual</title>
<path fill="none" stroke="black" d="M581.44,-1661.97C581.44,-1636.27 581.44,-1596 581.44,-1564.42"/>
<polygon fill="black" stroke="black" points="584.94,-1564.08 581.44,-1554.08 577.94,-1564.08 584.94,-1564.08"/>
</g>
<!-- layer_7_qkv -->
<g id="node58" class="node">
<title>layer_7_qkv</title>
<polygon fill="lightgreen" stroke="black" points="651.44,-1370 511.44,-1370 511.44,-1317 651.44,-1317 651.44,-1370"/>
<text text-anchor="middle" x="581.44" y="-1354.8" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="581.44" y="-1339.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="581.44" y="-1324.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="261.44" y="-1350.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="261.44" y="-1335.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="261.44" y="-1320.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_6_mlp_residual&#45;&gt;layer_7_qkv -->
<g id="edge57" class="edge">
<title>layer_6_mlp_residual&#45;&gt;layer_7_qkv</title>
<path fill="none" stroke="black" d="M581.44,-1477.58C581.44,-1448.73 581.44,-1409.05 581.44,-1380.55"/>
<polygon fill="black" stroke="black" points="584.94,-1380.21 581.44,-1370.21 577.94,-1380.21 584.94,-1380.21"/>
</g>
<!-- layer_7_attn -->
<g id="node59" class="node">
<title>layer_7_attn</title>
<polygon fill="yellow" stroke="black" points="665.44,-1209 497.44,-1209 497.44,-1156 665.44,-1156 665.44,-1209"/>
<text text-anchor="middle" x="581.44" y="-1193.8" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="581.44" y="-1178.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="581.44" y="-1163.8" font-family="Times,serif" font-size="14.00">(All Devices)</text>
<text text-anchor="middle" x="253.44" y="-1242.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="253.44" y="-1227.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.44" y="-1212.8" font-family="Times,serif" font-size="14.00">All GPUs: 0&#45;7</text>
</g>
<!-- layer_7_qkv&#45;&gt;layer_7_attn -->
<g id="edge58" class="edge">
<title>layer_7_qkv&#45;&gt;layer_7_attn</title>
<path fill="none" stroke="black" d="M581.44,-1316.95C581.44,-1290.61 581.44,-1249.29 581.44,-1219.61"/>
<polygon fill="black" stroke="black" points="584.94,-1219.25 581.44,-1209.25 577.94,-1219.25 584.94,-1219.25"/>
</g>
<!-- layer_7_attn_out -->
<g id="node60" class="node">
<title>layer_7_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="650.44,-1048 512.44,-1048 512.44,-995 650.44,-995 650.44,-1048"/>
<text text-anchor="middle" x="581.44" y="-1032.8" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="581.44" y="-1017.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="581.44" y="-1002.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="298.44" y="-1081.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="298.44" y="-1066.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="298.44" y="-1051.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_7_attn&#45;&gt;layer_7_attn_out -->
<g id="edge59" class="edge">
<title>layer_7_attn&#45;&gt;layer_7_attn_out</title>
<path fill="none" stroke="black" d="M581.44,-1155.95C581.44,-1129.61 581.44,-1088.29 581.44,-1058.61"/>
<polygon fill="black" stroke="black" points="584.94,-1058.25 581.44,-1048.25 577.94,-1058.25 584.94,-1058.25"/>
</g>
<!-- layer_7_residual -->
<g id="node61" class="node">
<title>layer_7_residual</title>
<polygon fill="lightgray" stroke="black" points="695.53,-887 514.04,-887 467.35,-811 648.84,-811 695.53,-887"/>
<text text-anchor="middle" x="581.44" y="-852.8" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="581.44" y="-837.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="253.4" y="-920.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.4" y="-905.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="253.4" y="-890.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_7_attn_out&#45;&gt;layer_7_residual -->
<g id="edge60" class="edge">
<title>layer_7_attn_out&#45;&gt;layer_7_residual</title>
<path fill="none" stroke="black" d="M581.44,-994.97C581.44,-969.27 581.44,-929 581.44,-897.42"/>
<polygon fill="black" stroke="black" points="584.94,-897.08 581.44,-887.08 577.94,-897.08 584.94,-897.08"/>
</g>
<!-- layer_7_gate -->
<g id="node62" class="node">
<title>layer_7_gate</title>
<polygon fill="lightcoral" stroke="black" points="651.44,-703 511.44,-703 511.44,-650 651.44,-650 651.44,-703"/>
<text text-anchor="middle" x="581.44" y="-687.8" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="581.44" y="-672.8" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="581.44" y="-657.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="285.94" y="-683.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="285.94" y="-668.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="285.94" y="-653.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_7_residual&#45;&gt;layer_7_gate -->
<g id="edge61" class="edge">
<title>layer_7_residual&#45;&gt;layer_7_gate</title>
<path fill="none" stroke="black" d="M581.44,-810.58C581.44,-781.73 581.44,-742.05 581.44,-713.55"/>
<polygon fill="black" stroke="black" points="584.94,-713.21 581.44,-703.21 577.94,-713.21 584.94,-713.21"/>
</g>
<!-- layer_7_up -->
<g id="node63" class="node">
<title>layer_7_up</title>
<polygon fill="lightcoral" stroke="black" points="651.44,-542 511.44,-542 511.44,-489 651.44,-489 651.44,-542"/>
<text text-anchor="middle" x="581.44" y="-526.8" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="581.44" y="-511.8" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="581.44" y="-496.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="285.94" y="-575.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="285.94" y="-560.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="285.94" y="-545.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_up -->
<g id="edge62" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_up</title>
<path fill="none" stroke="black" d="M581.44,-649.95C581.44,-623.61 581.44,-582.29 581.44,-552.61"/>
<polygon fill="black" stroke="black" points="584.94,-552.25 581.44,-542.25 577.94,-552.25 584.94,-552.25"/>
</g>
<!-- layer_7_down -->
<g id="node64" class="node">
<title>layer_7_down</title>
<polygon fill="lightcoral" stroke="black" points="639.44,-381 523.44,-381 523.44,-328 639.44,-328 639.44,-381"/>
<text text-anchor="middle" x="581.44" y="-365.8" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="581.44" y="-350.8" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="581.44" y="-335.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="303.94" y="-414.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="303.94" y="-399.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="303.94" y="-384.8" font-family="Times,serif" font-size="14.00">Devices: [0,1,2,3] vs [4,5,6,7]</text>
</g>
<!-- layer_7_up&#45;&gt;layer_7_down -->
<g id="edge63" class="edge">
<title>layer_7_up&#45;&gt;layer_7_down</title>
<path fill="none" stroke="black" d="M581.44,-488.95C581.44,-462.61 581.44,-421.29 581.44,-391.61"/>
<polygon fill="black" stroke="black" points="584.94,-391.25 581.44,-381.25 577.94,-391.25 584.94,-391.25"/>
</g>
<!-- layer_7_mlp_residual -->
<g id="node65" class="node">
<title>layer_7_mlp_residual</title>
<polygon fill="lightgray" stroke="black" points="734.82,-220 490.83,-220 428.06,-144 672.05,-144 734.82,-220"/>
<text text-anchor="middle" x="581.44" y="-185.8" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="581.44" y="-170.8" font-family="Times,serif" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="214" y="-253.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="214" y="-238.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="214" y="-223.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_7_down&#45;&gt;layer_7_mlp_residual -->
<g id="edge64" class="edge">
<title>layer_7_down&#45;&gt;layer_7_mlp_residual</title>
<path fill="none" stroke="black" d="M581.44,-327.97C581.44,-302.27 581.44,-262 581.44,-230.42"/>
<polygon fill="black" stroke="black" points="584.94,-230.08 581.44,-220.08 577.94,-230.08 584.94,-230.08"/>
</g>
<!-- pipeline_commulation -->
<g id="node132" class="node">
<title>pipeline_commulation</title>
<polygon fill="lightgrey" stroke="black" points="667.94,-36 494.94,-36 494.94,0 667.94,0 667.94,-36"/>
<text text-anchor="middle" x="581.44" y="-14.3" font-family="Times,serif" font-size="14.00">pipeline_commulation</text>
</g>
<!-- layer_7_mlp_residual&#45;&gt;pipeline_commulation -->
<g id="edge65" class="edge">
<title>layer_7_mlp_residual&#45;&gt;pipeline_commulation</title>
<path fill="none" stroke="black" d="M581.44,-143.83C581.44,-114.11 581.44,-73.12 581.44,-46.35"/>
<polygon fill="black" stroke="black" points="584.94,-46.16 581.44,-36.16 577.94,-46.16 584.94,-46.16"/>
</g>
<!-- layer_8_qkv -->
<g id="node66" class="node">
<title>layer_8_qkv</title>
<polygon fill="lightgreen" stroke="black" points="1381.44,-10708 1241.44,-10708 1241.44,-10655 1381.44,-10655 1381.44,-10708"/>
<text text-anchor="middle" x="1311.44" y="-10692.8" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="1311.44" y="-10677.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1311.44" y="-10662.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="991.44" y="-10643.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="991.44" y="-10628.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="991.44" y="-10613.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_8_attn -->
<g id="node67" class="node">
<title>layer_8_attn</title>
<polygon fill="yellow" stroke="black" points="1395.44,-10547 1227.44,-10547 1227.44,-10494 1395.44,-10494 1395.44,-10547"/>
<text text-anchor="middle" x="1311.44" y="-10531.8" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="1311.44" y="-10516.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1311.44" y="-10501.8" font-family="Times,serif" font-size="14.00">(All Devices)</text>
<text text-anchor="middle" x="983.44" y="-10580.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="983.44" y="-10565.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="983.44" y="-10550.8" font-family="Times,serif" font-size="14.00">All GPUs: 8&#45;15</text>
</g>
<!-- layer_8_qkv&#45;&gt;layer_8_attn -->
<g id="edge66" class="edge">
<title>layer_8_qkv&#45;&gt;layer_8_attn</title>
<path fill="none" stroke="black" d="M1311.44,-10654.95C1311.44,-10628.61 1311.44,-10587.29 1311.44,-10557.61"/>
<polygon fill="black" stroke="black" points="1314.94,-10557.25 1311.44,-10547.25 1307.94,-10557.25 1314.94,-10557.25"/>
</g>
<!-- layer_8_attn_out -->
<g id="node68" class="node">
<title>layer_8_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="1380.44,-10386 1242.44,-10386 1242.44,-10333 1380.44,-10333 1380.44,-10386"/>
<text text-anchor="middle" x="1311.44" y="-10370.8" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="1311.44" y="-10355.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1311.44" y="-10340.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="1028.44" y="-10419.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="1028.44" y="-10404.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="1028.44" y="-10389.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_8_attn&#45;&gt;layer_8_attn_out -->
<g id="edge67" class="edge">
<title>layer_8_attn&#45;&gt;layer_8_attn_out</title>
<path fill="none" stroke="black" d="M1311.44,-10493.95C1311.44,-10467.61 1311.44,-10426.29 1311.44,-10396.61"/>
<polygon fill="black" stroke="black" points="1314.94,-10396.25 1311.44,-10386.25 1307.94,-10396.25 1314.94,-10396.25"/>
</g>
<!-- layer_8_residual -->
<g id="node69" class="node">
<title>layer_8_residual</title>
<polygon fill="lightgray" stroke="black" points="1425.53,-10225 1244.04,-10225 1197.35,-10149 1378.84,-10149 1425.53,-10225"/>
<text text-anchor="middle" x="1311.44" y="-10190.8" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="1311.44" y="-10175.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="983.4" y="-10258.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="983.4" y="-10243.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="983.4" y="-10228.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_8_attn_out&#45;&gt;layer_8_residual -->
<g id="edge68" class="edge">
<title>layer_8_attn_out&#45;&gt;layer_8_residual</title>
<path fill="none" stroke="black" d="M1311.44,-10332.97C1311.44,-10307.27 1311.44,-10267 1311.44,-10235.42"/>
<polygon fill="black" stroke="black" points="1314.94,-10235.08 1311.44,-10225.08 1307.94,-10235.08 1314.94,-10235.08"/>
</g>
<!-- layer_8_gate -->
<g id="node70" class="node">
<title>layer_8_gate</title>
<polygon fill="lightcoral" stroke="black" points="1381.44,-10041 1241.44,-10041 1241.44,-9988 1381.44,-9988 1381.44,-10041"/>
<text text-anchor="middle" x="1311.44" y="-10025.8" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="1311.44" y="-10010.8" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="1311.44" y="-9995.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="1015.94" y="-9976.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="1015.94" y="-9961.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="1015.94" y="-9946.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_8_residual&#45;&gt;layer_8_gate -->
<g id="edge69" class="edge">
<title>layer_8_residual&#45;&gt;layer_8_gate</title>
<path fill="none" stroke="black" d="M1311.44,-10148.58C1311.44,-10119.73 1311.44,-10080.05 1311.44,-10051.55"/>
<polygon fill="black" stroke="black" points="1314.94,-10051.21 1311.44,-10041.21 1307.94,-10051.21 1314.94,-10051.21"/>
</g>
<!-- layer_8_up -->
<g id="node71" class="node">
<title>layer_8_up</title>
<polygon fill="lightcoral" stroke="black" points="1381.44,-9880 1241.44,-9880 1241.44,-9827 1381.44,-9827 1381.44,-9880"/>
<text text-anchor="middle" x="1311.44" y="-9864.8" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="1311.44" y="-9849.8" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="1311.44" y="-9834.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="1015.94" y="-9913.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="1015.94" y="-9898.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="1015.94" y="-9883.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_up -->
<g id="edge70" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_up</title>
<path fill="none" stroke="black" d="M1311.44,-9987.95C1311.44,-9961.61 1311.44,-9920.29 1311.44,-9890.61"/>
<polygon fill="black" stroke="black" points="1314.94,-9890.25 1311.44,-9880.25 1307.94,-9890.25 1314.94,-9890.25"/>
</g>
<!-- layer_8_down -->
<g id="node72" class="node">
<title>layer_8_down</title>
<polygon fill="lightcoral" stroke="black" points="1369.44,-9719 1253.44,-9719 1253.44,-9666 1369.44,-9666 1369.44,-9719"/>
<text text-anchor="middle" x="1311.44" y="-9703.8" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="1311.44" y="-9688.8" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="1311.44" y="-9673.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="1033.94" y="-9752.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="1033.94" y="-9737.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="1033.94" y="-9722.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_8_up&#45;&gt;layer_8_down -->
<g id="edge71" class="edge">
<title>layer_8_up&#45;&gt;layer_8_down</title>
<path fill="none" stroke="black" d="M1311.44,-9826.95C1311.44,-9800.61 1311.44,-9759.29 1311.44,-9729.61"/>
<polygon fill="black" stroke="black" points="1314.94,-9729.25 1311.44,-9719.25 1307.94,-9729.25 1314.94,-9729.25"/>
</g>
<!-- layer_8_mlp_residual -->
<g id="node73" class="node">
<title>layer_8_mlp_residual</title>
<polygon fill="lightgray" stroke="black" points="1464.82,-9558 1220.83,-9558 1158.06,-9482 1402.05,-9482 1464.82,-9558"/>
<text text-anchor="middle" x="1311.44" y="-9523.8" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="1311.44" y="-9508.8" font-family="Times,serif" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="944" y="-9591.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="944" y="-9576.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="944" y="-9561.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_8_down&#45;&gt;layer_8_mlp_residual -->
<g id="edge72" class="edge">
<title>layer_8_down&#45;&gt;layer_8_mlp_residual</title>
<path fill="none" stroke="black" d="M1311.44,-9665.97C1311.44,-9640.27 1311.44,-9600 1311.44,-9568.42"/>
<polygon fill="black" stroke="black" points="1314.94,-9568.08 1311.44,-9558.08 1307.94,-9568.08 1314.94,-9568.08"/>
</g>
<!-- layer_9_qkv -->
<g id="node74" class="node">
<title>layer_9_qkv</title>
<polygon fill="lightgreen" stroke="black" points="1016.44,-10708 876.44,-10708 876.44,-10655 1016.44,-10655 1016.44,-10708"/>
<text text-anchor="middle" x="946.44" y="-10692.8" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="946.44" y="-10677.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="946.44" y="-10662.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="626.44" y="-10741.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="626.44" y="-10726.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="626.44" y="-10711.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_9_attn -->
<g id="node75" class="node">
<title>layer_9_attn</title>
<polygon fill="yellow" stroke="black" points="1030.44,-10547 862.44,-10547 862.44,-10494 1030.44,-10494 1030.44,-10547"/>
<text text-anchor="middle" x="946.44" y="-10531.8" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="946.44" y="-10516.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="946.44" y="-10501.8" font-family="Times,serif" font-size="14.00">(All Devices)</text>
<text text-anchor="middle" x="618.44" y="-10482.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="618.44" y="-10467.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.44" y="-10452.8" font-family="Times,serif" font-size="14.00">All GPUs: 8&#45;15</text>
</g>
<!-- layer_9_qkv&#45;&gt;layer_9_attn -->
<g id="edge74" class="edge">
<title>layer_9_qkv&#45;&gt;layer_9_attn</title>
<path fill="none" stroke="black" d="M946.44,-10654.95C946.44,-10628.61 946.44,-10587.29 946.44,-10557.61"/>
<polygon fill="black" stroke="black" points="949.94,-10557.25 946.44,-10547.25 942.94,-10557.25 949.94,-10557.25"/>
</g>
<!-- layer_9_attn_out -->
<g id="node76" class="node">
<title>layer_9_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="1015.44,-10386 877.44,-10386 877.44,-10333 1015.44,-10333 1015.44,-10386"/>
<text text-anchor="middle" x="946.44" y="-10370.8" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="946.44" y="-10355.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="946.44" y="-10340.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="663.44" y="-10321.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="663.44" y="-10306.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="663.44" y="-10291.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_9_attn&#45;&gt;layer_9_attn_out -->
<g id="edge75" class="edge">
<title>layer_9_attn&#45;&gt;layer_9_attn_out</title>
<path fill="none" stroke="black" d="M946.44,-10493.95C946.44,-10467.61 946.44,-10426.29 946.44,-10396.61"/>
<polygon fill="black" stroke="black" points="949.94,-10396.25 946.44,-10386.25 942.94,-10396.25 949.94,-10396.25"/>
</g>
<!-- layer_9_residual -->
<g id="node77" class="node">
<title>layer_9_residual</title>
<polygon fill="lightgray" stroke="black" points="1060.53,-10225 879.04,-10225 832.35,-10149 1013.84,-10149 1060.53,-10225"/>
<text text-anchor="middle" x="946.44" y="-10190.8" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="946.44" y="-10175.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="618.4" y="-10137.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.4" y="-10122.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.4" y="-10107.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_9_attn_out&#45;&gt;layer_9_residual -->
<g id="edge76" class="edge">
<title>layer_9_attn_out&#45;&gt;layer_9_residual</title>
<path fill="none" stroke="black" d="M946.44,-10332.97C946.44,-10307.27 946.44,-10267 946.44,-10235.42"/>
<polygon fill="black" stroke="black" points="949.94,-10235.08 946.44,-10225.08 942.94,-10235.08 949.94,-10235.08"/>
</g>
<!-- layer_9_gate -->
<g id="node78" class="node">
<title>layer_9_gate</title>
<polygon fill="lightcoral" stroke="black" points="1016.44,-10041 876.44,-10041 876.44,-9988 1016.44,-9988 1016.44,-10041"/>
<text text-anchor="middle" x="946.44" y="-10025.8" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="946.44" y="-10010.8" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="946.44" y="-9995.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="1241.94" y="-10074.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="1241.94" y="-10059.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="1241.94" y="-10044.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_9_residual&#45;&gt;layer_9_gate -->
<g id="edge77" class="edge">
<title>layer_9_residual&#45;&gt;layer_9_gate</title>
<path fill="none" stroke="black" d="M946.44,-10148.58C946.44,-10119.73 946.44,-10080.05 946.44,-10051.55"/>
<polygon fill="black" stroke="black" points="949.94,-10051.21 946.44,-10041.21 942.94,-10051.21 949.94,-10051.21"/>
</g>
<!-- layer_9_up -->
<g id="node79" class="node">
<title>layer_9_up</title>
<polygon fill="lightcoral" stroke="black" points="1016.44,-9880 876.44,-9880 876.44,-9827 1016.44,-9827 1016.44,-9880"/>
<text text-anchor="middle" x="946.44" y="-9864.8" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="946.44" y="-9849.8" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="946.44" y="-9834.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="650.94" y="-9815.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="650.94" y="-9800.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="650.94" y="-9785.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_up -->
<g id="edge78" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_up</title>
<path fill="none" stroke="black" d="M946.44,-9987.95C946.44,-9961.61 946.44,-9920.29 946.44,-9890.61"/>
<polygon fill="black" stroke="black" points="949.94,-9890.25 946.44,-9880.25 942.94,-9890.25 949.94,-9890.25"/>
</g>
<!-- layer_9_down -->
<g id="node80" class="node">
<title>layer_9_down</title>
<polygon fill="lightcoral" stroke="black" points="1004.44,-9719 888.44,-9719 888.44,-9666 1004.44,-9666 1004.44,-9719"/>
<text text-anchor="middle" x="946.44" y="-9703.8" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="946.44" y="-9688.8" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="946.44" y="-9673.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="668.94" y="-9654.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="668.94" y="-9639.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="668.94" y="-9624.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_9_up&#45;&gt;layer_9_down -->
<g id="edge79" class="edge">
<title>layer_9_up&#45;&gt;layer_9_down</title>
<path fill="none" stroke="black" d="M946.44,-9826.95C946.44,-9800.61 946.44,-9759.29 946.44,-9729.61"/>
<polygon fill="black" stroke="black" points="949.94,-9729.25 946.44,-9719.25 942.94,-9729.25 949.94,-9729.25"/>
</g>
<!-- layer_9_mlp_residual -->
<g id="node81" class="node">
<title>layer_9_mlp_residual</title>
<polygon fill="lightgray" stroke="black" points="1099.82,-9558 855.83,-9558 793.06,-9482 1037.05,-9482 1099.82,-9558"/>
<text text-anchor="middle" x="946.44" y="-9523.8" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="946.44" y="-9508.8" font-family="Times,serif" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="579" y="-9470.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="579" y="-9455.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="579" y="-9440.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_9_down&#45;&gt;layer_9_mlp_residual -->
<g id="edge80" class="edge">
<title>layer_9_down&#45;&gt;layer_9_mlp_residual</title>
<path fill="none" stroke="black" d="M946.44,-9665.97C946.44,-9640.27 946.44,-9600 946.44,-9568.42"/>
<polygon fill="black" stroke="black" points="949.94,-9568.08 946.44,-9558.08 942.94,-9568.08 949.94,-9568.08"/>
</g>
<!-- layer_10_qkv -->
<g id="node82" class="node">
<title>layer_10_qkv</title>
<polygon fill="lightgreen" stroke="black" points="1016.44,-9374 876.44,-9374 876.44,-9321 1016.44,-9321 1016.44,-9374"/>
<text text-anchor="middle" x="946.44" y="-9358.8" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="946.44" y="-9343.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="946.44" y="-9328.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="626.44" y="-9309.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="626.44" y="-9294.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="626.44" y="-9279.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_9_mlp_residual&#45;&gt;layer_10_qkv -->
<g id="edge81" class="edge">
<title>layer_9_mlp_residual&#45;&gt;layer_10_qkv</title>
<path fill="none" stroke="black" d="M946.44,-9481.58C946.44,-9452.73 946.44,-9413.05 946.44,-9384.55"/>
<polygon fill="black" stroke="black" points="949.94,-9384.21 946.44,-9374.21 942.94,-9384.21 949.94,-9384.21"/>
</g>
<!-- layer_10_attn -->
<g id="node83" class="node">
<title>layer_10_attn</title>
<polygon fill="yellow" stroke="black" points="1030.44,-9213 862.44,-9213 862.44,-9160 1030.44,-9160 1030.44,-9213"/>
<text text-anchor="middle" x="946.44" y="-9197.8" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="946.44" y="-9182.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="946.44" y="-9167.8" font-family="Times,serif" font-size="14.00">(All Devices)</text>
<text text-anchor="middle" x="618.44" y="-9148.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="618.44" y="-9133.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.44" y="-9118.8" font-family="Times,serif" font-size="14.00">All GPUs: 8&#45;15</text>
</g>
<!-- layer_10_qkv&#45;&gt;layer_10_attn -->
<g id="edge82" class="edge">
<title>layer_10_qkv&#45;&gt;layer_10_attn</title>
<path fill="none" stroke="black" d="M946.44,-9320.95C946.44,-9294.61 946.44,-9253.29 946.44,-9223.61"/>
<polygon fill="black" stroke="black" points="949.94,-9223.25 946.44,-9213.25 942.94,-9223.25 949.94,-9223.25"/>
</g>
<!-- layer_10_attn_out -->
<g id="node84" class="node">
<title>layer_10_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="1015.44,-9052 877.44,-9052 877.44,-8999 1015.44,-8999 1015.44,-9052"/>
<text text-anchor="middle" x="946.44" y="-9036.8" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="946.44" y="-9021.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="946.44" y="-9006.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="663.44" y="-8987.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="663.44" y="-8972.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="663.44" y="-8957.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_10_attn&#45;&gt;layer_10_attn_out -->
<g id="edge83" class="edge">
<title>layer_10_attn&#45;&gt;layer_10_attn_out</title>
<path fill="none" stroke="black" d="M946.44,-9159.95C946.44,-9133.61 946.44,-9092.29 946.44,-9062.61"/>
<polygon fill="black" stroke="black" points="949.94,-9062.25 946.44,-9052.25 942.94,-9062.25 949.94,-9062.25"/>
</g>
<!-- layer_10_residual -->
<g id="node85" class="node">
<title>layer_10_residual</title>
<polygon fill="lightgray" stroke="black" points="1060.53,-8891 879.04,-8891 832.35,-8815 1013.84,-8815 1060.53,-8891"/>
<text text-anchor="middle" x="946.44" y="-8856.8" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="946.44" y="-8841.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="618.4" y="-8803.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.4" y="-8788.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.4" y="-8773.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_10_attn_out&#45;&gt;layer_10_residual -->
<g id="edge84" class="edge">
<title>layer_10_attn_out&#45;&gt;layer_10_residual</title>
<path fill="none" stroke="black" d="M946.44,-8998.97C946.44,-8973.27 946.44,-8933 946.44,-8901.42"/>
<polygon fill="black" stroke="black" points="949.94,-8901.08 946.44,-8891.08 942.94,-8901.08 949.94,-8901.08"/>
</g>
<!-- layer_10_gate -->
<g id="node86" class="node">
<title>layer_10_gate</title>
<polygon fill="lightcoral" stroke="black" points="1016.44,-8707 876.44,-8707 876.44,-8654 1016.44,-8654 1016.44,-8707"/>
<text text-anchor="middle" x="946.44" y="-8691.8" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="946.44" y="-8676.8" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="946.44" y="-8661.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="650.94" y="-8642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="650.94" y="-8627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="650.94" y="-8612.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_10_residual&#45;&gt;layer_10_gate -->
<g id="edge85" class="edge">
<title>layer_10_residual&#45;&gt;layer_10_gate</title>
<path fill="none" stroke="black" d="M946.44,-8814.58C946.44,-8785.73 946.44,-8746.05 946.44,-8717.55"/>
<polygon fill="black" stroke="black" points="949.94,-8717.21 946.44,-8707.21 942.94,-8717.21 949.94,-8717.21"/>
</g>
<!-- layer_10_up -->
<g id="node87" class="node">
<title>layer_10_up</title>
<polygon fill="lightcoral" stroke="black" points="1016.44,-8546 876.44,-8546 876.44,-8493 1016.44,-8493 1016.44,-8546"/>
<text text-anchor="middle" x="946.44" y="-8530.8" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="946.44" y="-8515.8" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="946.44" y="-8500.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="650.94" y="-8481.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="650.94" y="-8466.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="650.94" y="-8451.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_up -->
<g id="edge86" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_up</title>
<path fill="none" stroke="black" d="M946.44,-8653.95C946.44,-8627.61 946.44,-8586.29 946.44,-8556.61"/>
<polygon fill="black" stroke="black" points="949.94,-8556.25 946.44,-8546.25 942.94,-8556.25 949.94,-8556.25"/>
</g>
<!-- layer_10_down -->
<g id="node88" class="node">
<title>layer_10_down</title>
<polygon fill="lightcoral" stroke="black" points="1004.44,-8385 888.44,-8385 888.44,-8332 1004.44,-8332 1004.44,-8385"/>
<text text-anchor="middle" x="946.44" y="-8369.8" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="946.44" y="-8354.8" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="946.44" y="-8339.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="668.94" y="-8320.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="668.94" y="-8305.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="668.94" y="-8290.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_10_up&#45;&gt;layer_10_down -->
<g id="edge87" class="edge">
<title>layer_10_up&#45;&gt;layer_10_down</title>
<path fill="none" stroke="black" d="M946.44,-8492.95C946.44,-8466.61 946.44,-8425.29 946.44,-8395.61"/>
<polygon fill="black" stroke="black" points="949.94,-8395.25 946.44,-8385.25 942.94,-8395.25 949.94,-8395.25"/>
</g>
<!-- layer_10_mlp_residual -->
<g id="node89" class="node">
<title>layer_10_mlp_residual</title>
<polygon fill="lightgray" stroke="black" points="1099.82,-8224 855.83,-8224 793.06,-8148 1037.05,-8148 1099.82,-8224"/>
<text text-anchor="middle" x="946.44" y="-8189.8" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="946.44" y="-8174.8" font-family="Times,serif" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="579" y="-8136.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="579" y="-8121.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="579" y="-8106.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_10_down&#45;&gt;layer_10_mlp_residual -->
<g id="edge88" class="edge">
<title>layer_10_down&#45;&gt;layer_10_mlp_residual</title>
<path fill="none" stroke="black" d="M946.44,-8331.97C946.44,-8306.27 946.44,-8266 946.44,-8234.42"/>
<polygon fill="black" stroke="black" points="949.94,-8234.08 946.44,-8224.08 942.94,-8234.08 949.94,-8234.08"/>
</g>
<!-- layer_11_qkv -->
<g id="node90" class="node">
<title>layer_11_qkv</title>
<polygon fill="lightgreen" stroke="black" points="1016.44,-8040 876.44,-8040 876.44,-7987 1016.44,-7987 1016.44,-8040"/>
<text text-anchor="middle" x="946.44" y="-8024.8" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="946.44" y="-8009.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="946.44" y="-7994.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="626.44" y="-7975.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="626.44" y="-7960.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="626.44" y="-7945.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_10_mlp_residual&#45;&gt;layer_11_qkv -->
<g id="edge89" class="edge">
<title>layer_10_mlp_residual&#45;&gt;layer_11_qkv</title>
<path fill="none" stroke="black" d="M946.44,-8147.58C946.44,-8118.73 946.44,-8079.05 946.44,-8050.55"/>
<polygon fill="black" stroke="black" points="949.94,-8050.21 946.44,-8040.21 942.94,-8050.21 949.94,-8050.21"/>
</g>
<!-- layer_11_attn -->
<g id="node91" class="node">
<title>layer_11_attn</title>
<polygon fill="yellow" stroke="black" points="1030.44,-7879 862.44,-7879 862.44,-7826 1030.44,-7826 1030.44,-7879"/>
<text text-anchor="middle" x="946.44" y="-7863.8" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="946.44" y="-7848.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="946.44" y="-7833.8" font-family="Times,serif" font-size="14.00">(All Devices)</text>
<text text-anchor="middle" x="618.44" y="-7814.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="618.44" y="-7799.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.44" y="-7784.8" font-family="Times,serif" font-size="14.00">All GPUs: 8&#45;15</text>
</g>
<!-- layer_11_qkv&#45;&gt;layer_11_attn -->
<g id="edge90" class="edge">
<title>layer_11_qkv&#45;&gt;layer_11_attn</title>
<path fill="none" stroke="black" d="M946.44,-7986.95C946.44,-7960.61 946.44,-7919.29 946.44,-7889.61"/>
<polygon fill="black" stroke="black" points="949.94,-7889.25 946.44,-7879.25 942.94,-7889.25 949.94,-7889.25"/>
</g>
<!-- layer_11_attn_out -->
<g id="node92" class="node">
<title>layer_11_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="1015.44,-7718 877.44,-7718 877.44,-7665 1015.44,-7665 1015.44,-7718"/>
<text text-anchor="middle" x="946.44" y="-7702.8" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="946.44" y="-7687.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="946.44" y="-7672.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="663.44" y="-7653.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="663.44" y="-7638.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="663.44" y="-7623.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_11_attn&#45;&gt;layer_11_attn_out -->
<g id="edge91" class="edge">
<title>layer_11_attn&#45;&gt;layer_11_attn_out</title>
<path fill="none" stroke="black" d="M946.44,-7825.95C946.44,-7799.61 946.44,-7758.29 946.44,-7728.61"/>
<polygon fill="black" stroke="black" points="949.94,-7728.25 946.44,-7718.25 942.94,-7728.25 949.94,-7728.25"/>
</g>
<!-- layer_11_residual -->
<g id="node93" class="node">
<title>layer_11_residual</title>
<polygon fill="lightgray" stroke="black" points="1060.53,-7557 879.04,-7557 832.35,-7481 1013.84,-7481 1060.53,-7557"/>
<text text-anchor="middle" x="946.44" y="-7522.8" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="946.44" y="-7507.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="618.4" y="-7469.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.4" y="-7454.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.4" y="-7439.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_11_attn_out&#45;&gt;layer_11_residual -->
<g id="edge92" class="edge">
<title>layer_11_attn_out&#45;&gt;layer_11_residual</title>
<path fill="none" stroke="black" d="M946.44,-7664.97C946.44,-7639.27 946.44,-7599 946.44,-7567.42"/>
<polygon fill="black" stroke="black" points="949.94,-7567.08 946.44,-7557.08 942.94,-7567.08 949.94,-7567.08"/>
</g>
<!-- layer_11_gate -->
<g id="node94" class="node">
<title>layer_11_gate</title>
<polygon fill="lightcoral" stroke="black" points="1016.44,-7373 876.44,-7373 876.44,-7320 1016.44,-7320 1016.44,-7373"/>
<text text-anchor="middle" x="946.44" y="-7357.8" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="946.44" y="-7342.8" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="946.44" y="-7327.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="650.94" y="-7308.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="650.94" y="-7293.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="650.94" y="-7278.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_11_residual&#45;&gt;layer_11_gate -->
<g id="edge93" class="edge">
<title>layer_11_residual&#45;&gt;layer_11_gate</title>
<path fill="none" stroke="black" d="M946.44,-7480.58C946.44,-7451.73 946.44,-7412.05 946.44,-7383.55"/>
<polygon fill="black" stroke="black" points="949.94,-7383.21 946.44,-7373.21 942.94,-7383.21 949.94,-7383.21"/>
</g>
<!-- layer_11_up -->
<g id="node95" class="node">
<title>layer_11_up</title>
<polygon fill="lightcoral" stroke="black" points="1016.44,-7212 876.44,-7212 876.44,-7159 1016.44,-7159 1016.44,-7212"/>
<text text-anchor="middle" x="946.44" y="-7196.8" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="946.44" y="-7181.8" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="946.44" y="-7166.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="650.94" y="-7147.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="650.94" y="-7132.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="650.94" y="-7117.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_up -->
<g id="edge94" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_up</title>
<path fill="none" stroke="black" d="M946.44,-7319.95C946.44,-7293.61 946.44,-7252.29 946.44,-7222.61"/>
<polygon fill="black" stroke="black" points="949.94,-7222.25 946.44,-7212.25 942.94,-7222.25 949.94,-7222.25"/>
</g>
<!-- layer_11_down -->
<g id="node96" class="node">
<title>layer_11_down</title>
<polygon fill="lightcoral" stroke="black" points="1004.44,-7051 888.44,-7051 888.44,-6998 1004.44,-6998 1004.44,-7051"/>
<text text-anchor="middle" x="946.44" y="-7035.8" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="946.44" y="-7020.8" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="946.44" y="-7005.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="668.94" y="-6986.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="668.94" y="-6971.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="668.94" y="-6956.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_11_up&#45;&gt;layer_11_down -->
<g id="edge95" class="edge">
<title>layer_11_up&#45;&gt;layer_11_down</title>
<path fill="none" stroke="black" d="M946.44,-7158.95C946.44,-7132.61 946.44,-7091.29 946.44,-7061.61"/>
<polygon fill="black" stroke="black" points="949.94,-7061.25 946.44,-7051.25 942.94,-7061.25 949.94,-7061.25"/>
</g>
<!-- layer_11_mlp_residual -->
<g id="node97" class="node">
<title>layer_11_mlp_residual</title>
<polygon fill="lightgray" stroke="black" points="1099.82,-6890 855.83,-6890 793.06,-6814 1037.05,-6814 1099.82,-6890"/>
<text text-anchor="middle" x="946.44" y="-6855.8" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="946.44" y="-6840.8" font-family="Times,serif" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="579" y="-6802.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="579" y="-6787.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="579" y="-6772.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_11_down&#45;&gt;layer_11_mlp_residual -->
<g id="edge96" class="edge">
<title>layer_11_down&#45;&gt;layer_11_mlp_residual</title>
<path fill="none" stroke="black" d="M946.44,-6997.97C946.44,-6972.27 946.44,-6932 946.44,-6900.42"/>
<polygon fill="black" stroke="black" points="949.94,-6900.08 946.44,-6890.08 942.94,-6900.08 949.94,-6900.08"/>
</g>
<!-- layer_12_qkv -->
<g id="node98" class="node">
<title>layer_12_qkv</title>
<polygon fill="lightgreen" stroke="black" points="1016.44,-6706 876.44,-6706 876.44,-6653 1016.44,-6653 1016.44,-6706"/>
<text text-anchor="middle" x="946.44" y="-6690.8" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="946.44" y="-6675.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="946.44" y="-6660.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="626.44" y="-6641.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="626.44" y="-6626.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="626.44" y="-6611.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_11_mlp_residual&#45;&gt;layer_12_qkv -->
<g id="edge97" class="edge">
<title>layer_11_mlp_residual&#45;&gt;layer_12_qkv</title>
<path fill="none" stroke="black" d="M946.44,-6813.58C946.44,-6784.73 946.44,-6745.05 946.44,-6716.55"/>
<polygon fill="black" stroke="black" points="949.94,-6716.21 946.44,-6706.21 942.94,-6716.21 949.94,-6716.21"/>
</g>
<!-- layer_12_attn -->
<g id="node99" class="node">
<title>layer_12_attn</title>
<polygon fill="yellow" stroke="black" points="1030.44,-6545 862.44,-6545 862.44,-6492 1030.44,-6492 1030.44,-6545"/>
<text text-anchor="middle" x="946.44" y="-6529.8" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="946.44" y="-6514.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="946.44" y="-6499.8" font-family="Times,serif" font-size="14.00">(All Devices)</text>
<text text-anchor="middle" x="618.44" y="-6480.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="618.44" y="-6465.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.44" y="-6450.8" font-family="Times,serif" font-size="14.00">All GPUs: 8&#45;15</text>
</g>
<!-- layer_12_qkv&#45;&gt;layer_12_attn -->
<g id="edge98" class="edge">
<title>layer_12_qkv&#45;&gt;layer_12_attn</title>
<path fill="none" stroke="black" d="M946.44,-6652.95C946.44,-6626.61 946.44,-6585.29 946.44,-6555.61"/>
<polygon fill="black" stroke="black" points="949.94,-6555.25 946.44,-6545.25 942.94,-6555.25 949.94,-6555.25"/>
</g>
<!-- layer_12_attn_out -->
<g id="node100" class="node">
<title>layer_12_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="1015.44,-6384 877.44,-6384 877.44,-6331 1015.44,-6331 1015.44,-6384"/>
<text text-anchor="middle" x="946.44" y="-6368.8" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="946.44" y="-6353.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="946.44" y="-6338.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="663.44" y="-6319.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="663.44" y="-6304.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="663.44" y="-6289.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_12_attn&#45;&gt;layer_12_attn_out -->
<g id="edge99" class="edge">
<title>layer_12_attn&#45;&gt;layer_12_attn_out</title>
<path fill="none" stroke="black" d="M946.44,-6491.95C946.44,-6465.61 946.44,-6424.29 946.44,-6394.61"/>
<polygon fill="black" stroke="black" points="949.94,-6394.25 946.44,-6384.25 942.94,-6394.25 949.94,-6394.25"/>
</g>
<!-- layer_12_residual -->
<g id="node101" class="node">
<title>layer_12_residual</title>
<polygon fill="lightgray" stroke="black" points="1060.53,-6223 879.04,-6223 832.35,-6147 1013.84,-6147 1060.53,-6223"/>
<text text-anchor="middle" x="946.44" y="-6188.8" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="946.44" y="-6173.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="618.4" y="-6135.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.4" y="-6120.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.4" y="-6105.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_12_attn_out&#45;&gt;layer_12_residual -->
<g id="edge100" class="edge">
<title>layer_12_attn_out&#45;&gt;layer_12_residual</title>
<path fill="none" stroke="black" d="M946.44,-6330.97C946.44,-6305.27 946.44,-6265 946.44,-6233.42"/>
<polygon fill="black" stroke="black" points="949.94,-6233.08 946.44,-6223.08 942.94,-6233.08 949.94,-6233.08"/>
</g>
<!-- layer_12_gate -->
<g id="node102" class="node">
<title>layer_12_gate</title>
<polygon fill="lightcoral" stroke="black" points="1016.44,-6039 876.44,-6039 876.44,-5986 1016.44,-5986 1016.44,-6039"/>
<text text-anchor="middle" x="946.44" y="-6023.8" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="946.44" y="-6008.8" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="946.44" y="-5993.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="650.94" y="-5974.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="650.94" y="-5959.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="650.94" y="-5944.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_12_residual&#45;&gt;layer_12_gate -->
<g id="edge101" class="edge">
<title>layer_12_residual&#45;&gt;layer_12_gate</title>
<path fill="none" stroke="black" d="M946.44,-6146.58C946.44,-6117.73 946.44,-6078.05 946.44,-6049.55"/>
<polygon fill="black" stroke="black" points="949.94,-6049.21 946.44,-6039.21 942.94,-6049.21 949.94,-6049.21"/>
</g>
<!-- layer_12_up -->
<g id="node103" class="node">
<title>layer_12_up</title>
<polygon fill="lightcoral" stroke="black" points="1016.44,-5878 876.44,-5878 876.44,-5825 1016.44,-5825 1016.44,-5878"/>
<text text-anchor="middle" x="946.44" y="-5862.8" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="946.44" y="-5847.8" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="946.44" y="-5832.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="650.94" y="-5813.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="650.94" y="-5798.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="650.94" y="-5783.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_up -->
<g id="edge102" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_up</title>
<path fill="none" stroke="black" d="M946.44,-5985.95C946.44,-5959.61 946.44,-5918.29 946.44,-5888.61"/>
<polygon fill="black" stroke="black" points="949.94,-5888.25 946.44,-5878.25 942.94,-5888.25 949.94,-5888.25"/>
</g>
<!-- layer_12_down -->
<g id="node104" class="node">
<title>layer_12_down</title>
<polygon fill="lightcoral" stroke="black" points="1004.44,-5717 888.44,-5717 888.44,-5664 1004.44,-5664 1004.44,-5717"/>
<text text-anchor="middle" x="946.44" y="-5701.8" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="946.44" y="-5686.8" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="946.44" y="-5671.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="668.94" y="-5652.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="668.94" y="-5637.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="668.94" y="-5622.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_12_up&#45;&gt;layer_12_down -->
<g id="edge103" class="edge">
<title>layer_12_up&#45;&gt;layer_12_down</title>
<path fill="none" stroke="black" d="M946.44,-5824.95C946.44,-5798.61 946.44,-5757.29 946.44,-5727.61"/>
<polygon fill="black" stroke="black" points="949.94,-5727.25 946.44,-5717.25 942.94,-5727.25 949.94,-5727.25"/>
</g>
<!-- layer_12_mlp_residual -->
<g id="node105" class="node">
<title>layer_12_mlp_residual</title>
<polygon fill="lightgray" stroke="black" points="1099.82,-5556 855.83,-5556 793.06,-5480 1037.05,-5480 1099.82,-5556"/>
<text text-anchor="middle" x="946.44" y="-5521.8" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="946.44" y="-5506.8" font-family="Times,serif" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="579" y="-5468.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="579" y="-5453.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="579" y="-5438.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_12_down&#45;&gt;layer_12_mlp_residual -->
<g id="edge104" class="edge">
<title>layer_12_down&#45;&gt;layer_12_mlp_residual</title>
<path fill="none" stroke="black" d="M946.44,-5663.97C946.44,-5638.27 946.44,-5598 946.44,-5566.42"/>
<polygon fill="black" stroke="black" points="949.94,-5566.08 946.44,-5556.08 942.94,-5566.08 949.94,-5566.08"/>
</g>
<!-- layer_13_qkv -->
<g id="node106" class="node">
<title>layer_13_qkv</title>
<polygon fill="lightgreen" stroke="black" points="1016.44,-5372 876.44,-5372 876.44,-5319 1016.44,-5319 1016.44,-5372"/>
<text text-anchor="middle" x="946.44" y="-5356.8" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="946.44" y="-5341.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="946.44" y="-5326.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="626.44" y="-5307.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="626.44" y="-5292.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="626.44" y="-5277.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_12_mlp_residual&#45;&gt;layer_13_qkv -->
<g id="edge105" class="edge">
<title>layer_12_mlp_residual&#45;&gt;layer_13_qkv</title>
<path fill="none" stroke="black" d="M946.44,-5479.58C946.44,-5450.73 946.44,-5411.05 946.44,-5382.55"/>
<polygon fill="black" stroke="black" points="949.94,-5382.21 946.44,-5372.21 942.94,-5382.21 949.94,-5382.21"/>
</g>
<!-- layer_13_attn -->
<g id="node107" class="node">
<title>layer_13_attn</title>
<polygon fill="yellow" stroke="black" points="1030.44,-5211 862.44,-5211 862.44,-5158 1030.44,-5158 1030.44,-5211"/>
<text text-anchor="middle" x="946.44" y="-5195.8" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="946.44" y="-5180.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="946.44" y="-5165.8" font-family="Times,serif" font-size="14.00">(All Devices)</text>
<text text-anchor="middle" x="618.44" y="-5146.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="618.44" y="-5131.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.44" y="-5116.8" font-family="Times,serif" font-size="14.00">All GPUs: 8&#45;15</text>
</g>
<!-- layer_13_qkv&#45;&gt;layer_13_attn -->
<g id="edge106" class="edge">
<title>layer_13_qkv&#45;&gt;layer_13_attn</title>
<path fill="none" stroke="black" d="M946.44,-5318.95C946.44,-5292.61 946.44,-5251.29 946.44,-5221.61"/>
<polygon fill="black" stroke="black" points="949.94,-5221.25 946.44,-5211.25 942.94,-5221.25 949.94,-5221.25"/>
</g>
<!-- layer_13_attn_out -->
<g id="node108" class="node">
<title>layer_13_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="1015.44,-5050 877.44,-5050 877.44,-4997 1015.44,-4997 1015.44,-5050"/>
<text text-anchor="middle" x="946.44" y="-5034.8" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="946.44" y="-5019.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="946.44" y="-5004.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="663.44" y="-4985.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="663.44" y="-4970.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="663.44" y="-4955.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_13_attn&#45;&gt;layer_13_attn_out -->
<g id="edge107" class="edge">
<title>layer_13_attn&#45;&gt;layer_13_attn_out</title>
<path fill="none" stroke="black" d="M946.44,-5157.95C946.44,-5131.61 946.44,-5090.29 946.44,-5060.61"/>
<polygon fill="black" stroke="black" points="949.94,-5060.25 946.44,-5050.25 942.94,-5060.25 949.94,-5060.25"/>
</g>
<!-- layer_13_residual -->
<g id="node109" class="node">
<title>layer_13_residual</title>
<polygon fill="lightgray" stroke="black" points="1060.53,-4889 879.04,-4889 832.35,-4813 1013.84,-4813 1060.53,-4889"/>
<text text-anchor="middle" x="946.44" y="-4854.8" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="946.44" y="-4839.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="618.4" y="-4801.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.4" y="-4786.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.4" y="-4771.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_13_attn_out&#45;&gt;layer_13_residual -->
<g id="edge108" class="edge">
<title>layer_13_attn_out&#45;&gt;layer_13_residual</title>
<path fill="none" stroke="black" d="M946.44,-4996.97C946.44,-4971.27 946.44,-4931 946.44,-4899.42"/>
<polygon fill="black" stroke="black" points="949.94,-4899.08 946.44,-4889.08 942.94,-4899.08 949.94,-4899.08"/>
</g>
<!-- layer_13_gate -->
<g id="node110" class="node">
<title>layer_13_gate</title>
<polygon fill="lightcoral" stroke="black" points="1016.44,-4705 876.44,-4705 876.44,-4652 1016.44,-4652 1016.44,-4705"/>
<text text-anchor="middle" x="946.44" y="-4689.8" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="946.44" y="-4674.8" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="946.44" y="-4659.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="650.94" y="-4640.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="650.94" y="-4625.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="650.94" y="-4610.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_13_residual&#45;&gt;layer_13_gate -->
<g id="edge109" class="edge">
<title>layer_13_residual&#45;&gt;layer_13_gate</title>
<path fill="none" stroke="black" d="M946.44,-4812.58C946.44,-4783.73 946.44,-4744.05 946.44,-4715.55"/>
<polygon fill="black" stroke="black" points="949.94,-4715.21 946.44,-4705.21 942.94,-4715.21 949.94,-4715.21"/>
</g>
<!-- layer_13_up -->
<g id="node111" class="node">
<title>layer_13_up</title>
<polygon fill="lightcoral" stroke="black" points="1016.44,-4544 876.44,-4544 876.44,-4491 1016.44,-4491 1016.44,-4544"/>
<text text-anchor="middle" x="946.44" y="-4528.8" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="946.44" y="-4513.8" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="946.44" y="-4498.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="650.94" y="-4479.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="650.94" y="-4464.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="650.94" y="-4449.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_up -->
<g id="edge110" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_up</title>
<path fill="none" stroke="black" d="M946.44,-4651.95C946.44,-4625.61 946.44,-4584.29 946.44,-4554.61"/>
<polygon fill="black" stroke="black" points="949.94,-4554.25 946.44,-4544.25 942.94,-4554.25 949.94,-4554.25"/>
</g>
<!-- layer_13_down -->
<g id="node112" class="node">
<title>layer_13_down</title>
<polygon fill="lightcoral" stroke="black" points="1004.44,-4383 888.44,-4383 888.44,-4330 1004.44,-4330 1004.44,-4383"/>
<text text-anchor="middle" x="946.44" y="-4367.8" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="946.44" y="-4352.8" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="946.44" y="-4337.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="668.94" y="-4318.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="668.94" y="-4303.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="668.94" y="-4288.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_13_up&#45;&gt;layer_13_down -->
<g id="edge111" class="edge">
<title>layer_13_up&#45;&gt;layer_13_down</title>
<path fill="none" stroke="black" d="M946.44,-4490.95C946.44,-4464.61 946.44,-4423.29 946.44,-4393.61"/>
<polygon fill="black" stroke="black" points="949.94,-4393.25 946.44,-4383.25 942.94,-4393.25 949.94,-4393.25"/>
</g>
<!-- layer_13_mlp_residual -->
<g id="node113" class="node">
<title>layer_13_mlp_residual</title>
<polygon fill="lightgray" stroke="black" points="1099.82,-4222 855.83,-4222 793.06,-4146 1037.05,-4146 1099.82,-4222"/>
<text text-anchor="middle" x="946.44" y="-4187.8" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="946.44" y="-4172.8" font-family="Times,serif" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="579" y="-4134.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="579" y="-4119.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="579" y="-4104.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_13_down&#45;&gt;layer_13_mlp_residual -->
<g id="edge112" class="edge">
<title>layer_13_down&#45;&gt;layer_13_mlp_residual</title>
<path fill="none" stroke="black" d="M946.44,-4329.97C946.44,-4304.27 946.44,-4264 946.44,-4232.42"/>
<polygon fill="black" stroke="black" points="949.94,-4232.08 946.44,-4222.08 942.94,-4232.08 949.94,-4232.08"/>
</g>
<!-- layer_14_qkv -->
<g id="node114" class="node">
<title>layer_14_qkv</title>
<polygon fill="lightgreen" stroke="black" points="1016.44,-4038 876.44,-4038 876.44,-3985 1016.44,-3985 1016.44,-4038"/>
<text text-anchor="middle" x="946.44" y="-4022.8" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="946.44" y="-4007.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="946.44" y="-3992.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="626.44" y="-3973.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="626.44" y="-3958.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="626.44" y="-3943.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_13_mlp_residual&#45;&gt;layer_14_qkv -->
<g id="edge113" class="edge">
<title>layer_13_mlp_residual&#45;&gt;layer_14_qkv</title>
<path fill="none" stroke="black" d="M946.44,-4145.58C946.44,-4116.73 946.44,-4077.05 946.44,-4048.55"/>
<polygon fill="black" stroke="black" points="949.94,-4048.21 946.44,-4038.21 942.94,-4048.21 949.94,-4048.21"/>
</g>
<!-- layer_14_attn -->
<g id="node115" class="node">
<title>layer_14_attn</title>
<polygon fill="yellow" stroke="black" points="1030.44,-3877 862.44,-3877 862.44,-3824 1030.44,-3824 1030.44,-3877"/>
<text text-anchor="middle" x="946.44" y="-3861.8" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="946.44" y="-3846.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="946.44" y="-3831.8" font-family="Times,serif" font-size="14.00">(All Devices)</text>
<text text-anchor="middle" x="618.44" y="-3812.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="618.44" y="-3797.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.44" y="-3782.8" font-family="Times,serif" font-size="14.00">All GPUs: 8&#45;15</text>
</g>
<!-- layer_14_qkv&#45;&gt;layer_14_attn -->
<g id="edge114" class="edge">
<title>layer_14_qkv&#45;&gt;layer_14_attn</title>
<path fill="none" stroke="black" d="M946.44,-3984.95C946.44,-3958.61 946.44,-3917.29 946.44,-3887.61"/>
<polygon fill="black" stroke="black" points="949.94,-3887.25 946.44,-3877.25 942.94,-3887.25 949.94,-3887.25"/>
</g>
<!-- layer_14_attn_out -->
<g id="node116" class="node">
<title>layer_14_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="1015.44,-3716 877.44,-3716 877.44,-3663 1015.44,-3663 1015.44,-3716"/>
<text text-anchor="middle" x="946.44" y="-3700.8" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="946.44" y="-3685.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="946.44" y="-3670.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="663.44" y="-3651.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="663.44" y="-3636.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="663.44" y="-3621.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_14_attn&#45;&gt;layer_14_attn_out -->
<g id="edge115" class="edge">
<title>layer_14_attn&#45;&gt;layer_14_attn_out</title>
<path fill="none" stroke="black" d="M946.44,-3823.95C946.44,-3797.61 946.44,-3756.29 946.44,-3726.61"/>
<polygon fill="black" stroke="black" points="949.94,-3726.25 946.44,-3716.25 942.94,-3726.25 949.94,-3726.25"/>
</g>
<!-- layer_14_residual -->
<g id="node117" class="node">
<title>layer_14_residual</title>
<polygon fill="lightgray" stroke="black" points="1060.53,-3555 879.04,-3555 832.35,-3479 1013.84,-3479 1060.53,-3555"/>
<text text-anchor="middle" x="946.44" y="-3520.8" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="946.44" y="-3505.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="618.4" y="-3467.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.4" y="-3452.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.4" y="-3437.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_14_attn_out&#45;&gt;layer_14_residual -->
<g id="edge116" class="edge">
<title>layer_14_attn_out&#45;&gt;layer_14_residual</title>
<path fill="none" stroke="black" d="M946.44,-3662.97C946.44,-3637.27 946.44,-3597 946.44,-3565.42"/>
<polygon fill="black" stroke="black" points="949.94,-3565.08 946.44,-3555.08 942.94,-3565.08 949.94,-3565.08"/>
</g>
<!-- layer_14_gate -->
<g id="node118" class="node">
<title>layer_14_gate</title>
<polygon fill="lightcoral" stroke="black" points="1016.44,-3371 876.44,-3371 876.44,-3318 1016.44,-3318 1016.44,-3371"/>
<text text-anchor="middle" x="946.44" y="-3355.8" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="946.44" y="-3340.8" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="946.44" y="-3325.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="650.94" y="-3306.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="650.94" y="-3291.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="650.94" y="-3276.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_14_residual&#45;&gt;layer_14_gate -->
<g id="edge117" class="edge">
<title>layer_14_residual&#45;&gt;layer_14_gate</title>
<path fill="none" stroke="black" d="M946.44,-3478.58C946.44,-3449.73 946.44,-3410.05 946.44,-3381.55"/>
<polygon fill="black" stroke="black" points="949.94,-3381.21 946.44,-3371.21 942.94,-3381.21 949.94,-3381.21"/>
</g>
<!-- layer_14_up -->
<g id="node119" class="node">
<title>layer_14_up</title>
<polygon fill="lightcoral" stroke="black" points="1016.44,-3210 876.44,-3210 876.44,-3157 1016.44,-3157 1016.44,-3210"/>
<text text-anchor="middle" x="946.44" y="-3194.8" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="946.44" y="-3179.8" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="946.44" y="-3164.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="650.94" y="-3145.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="650.94" y="-3130.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="650.94" y="-3115.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_up -->
<g id="edge118" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_up</title>
<path fill="none" stroke="black" d="M946.44,-3317.95C946.44,-3291.61 946.44,-3250.29 946.44,-3220.61"/>
<polygon fill="black" stroke="black" points="949.94,-3220.25 946.44,-3210.25 942.94,-3220.25 949.94,-3220.25"/>
</g>
<!-- layer_14_down -->
<g id="node120" class="node">
<title>layer_14_down</title>
<polygon fill="lightcoral" stroke="black" points="1004.44,-3049 888.44,-3049 888.44,-2996 1004.44,-2996 1004.44,-3049"/>
<text text-anchor="middle" x="946.44" y="-3033.8" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="946.44" y="-3018.8" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="946.44" y="-3003.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="668.94" y="-2984.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="668.94" y="-2969.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="668.94" y="-2954.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_14_up&#45;&gt;layer_14_down -->
<g id="edge119" class="edge">
<title>layer_14_up&#45;&gt;layer_14_down</title>
<path fill="none" stroke="black" d="M946.44,-3156.95C946.44,-3130.61 946.44,-3089.29 946.44,-3059.61"/>
<polygon fill="black" stroke="black" points="949.94,-3059.25 946.44,-3049.25 942.94,-3059.25 949.94,-3059.25"/>
</g>
<!-- layer_14_mlp_residual -->
<g id="node121" class="node">
<title>layer_14_mlp_residual</title>
<polygon fill="lightgray" stroke="black" points="1099.82,-2888 855.83,-2888 793.06,-2812 1037.05,-2812 1099.82,-2888"/>
<text text-anchor="middle" x="946.44" y="-2853.8" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="946.44" y="-2838.8" font-family="Times,serif" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="579" y="-2800.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="579" y="-2785.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="579" y="-2770.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_14_down&#45;&gt;layer_14_mlp_residual -->
<g id="edge120" class="edge">
<title>layer_14_down&#45;&gt;layer_14_mlp_residual</title>
<path fill="none" stroke="black" d="M946.44,-2995.97C946.44,-2970.27 946.44,-2930 946.44,-2898.42"/>
<polygon fill="black" stroke="black" points="949.94,-2898.08 946.44,-2888.08 942.94,-2898.08 949.94,-2898.08"/>
</g>
<!-- layer_15_qkv -->
<g id="node122" class="node">
<title>layer_15_qkv</title>
<polygon fill="lightgreen" stroke="black" points="1016.44,-2704 876.44,-2704 876.44,-2651 1016.44,-2651 1016.44,-2704"/>
<text text-anchor="middle" x="946.44" y="-2688.8" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="946.44" y="-2673.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="946.44" y="-2658.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="626.44" y="-2639.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="626.44" y="-2624.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="626.44" y="-2609.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_14_mlp_residual&#45;&gt;layer_15_qkv -->
<g id="edge121" class="edge">
<title>layer_14_mlp_residual&#45;&gt;layer_15_qkv</title>
<path fill="none" stroke="black" d="M946.44,-2811.58C946.44,-2782.73 946.44,-2743.05 946.44,-2714.55"/>
<polygon fill="black" stroke="black" points="949.94,-2714.21 946.44,-2704.21 942.94,-2714.21 949.94,-2714.21"/>
</g>
<!-- layer_15_attn -->
<g id="node123" class="node">
<title>layer_15_attn</title>
<polygon fill="yellow" stroke="black" points="1030.44,-2543 862.44,-2543 862.44,-2490 1030.44,-2490 1030.44,-2543"/>
<text text-anchor="middle" x="946.44" y="-2527.8" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="946.44" y="-2512.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="946.44" y="-2497.8" font-family="Times,serif" font-size="14.00">(All Devices)</text>
<text text-anchor="middle" x="618.44" y="-2478.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, heads=32, qkv_dim=128]</text>
<text text-anchor="middle" x="618.44" y="-2463.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.44" y="-2448.8" font-family="Times,serif" font-size="14.00">All GPUs: 8&#45;15</text>
</g>
<!-- layer_15_qkv&#45;&gt;layer_15_attn -->
<g id="edge122" class="edge">
<title>layer_15_qkv&#45;&gt;layer_15_attn</title>
<path fill="none" stroke="black" d="M946.44,-2650.95C946.44,-2624.61 946.44,-2583.29 946.44,-2553.61"/>
<polygon fill="black" stroke="black" points="949.94,-2553.25 946.44,-2543.25 942.94,-2553.25 949.94,-2553.25"/>
</g>
<!-- layer_15_attn_out -->
<g id="node124" class="node">
<title>layer_15_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="1015.44,-2382 877.44,-2382 877.44,-2329 1015.44,-2329 1015.44,-2382"/>
<text text-anchor="middle" x="946.44" y="-2366.8" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="946.44" y="-2351.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="946.44" y="-2336.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="663.44" y="-2317.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="663.44" y="-2302.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="663.44" y="-2287.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_15_attn&#45;&gt;layer_15_attn_out -->
<g id="edge123" class="edge">
<title>layer_15_attn&#45;&gt;layer_15_attn_out</title>
<path fill="none" stroke="black" d="M946.44,-2489.95C946.44,-2463.61 946.44,-2422.29 946.44,-2392.61"/>
<polygon fill="black" stroke="black" points="949.94,-2392.25 946.44,-2382.25 942.94,-2392.25 949.94,-2392.25"/>
</g>
<!-- layer_15_residual -->
<g id="node125" class="node">
<title>layer_15_residual</title>
<polygon fill="lightgray" stroke="black" points="1060.53,-2221 879.04,-2221 832.35,-2145 1013.84,-2145 1060.53,-2221"/>
<text text-anchor="middle" x="946.44" y="-2186.8" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="946.44" y="-2171.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="618.4" y="-2133.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.4" y="-2118.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="618.4" y="-2103.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_15_attn_out&#45;&gt;layer_15_residual -->
<g id="edge124" class="edge">
<title>layer_15_attn_out&#45;&gt;layer_15_residual</title>
<path fill="none" stroke="black" d="M946.44,-2328.97C946.44,-2303.27 946.44,-2263 946.44,-2231.42"/>
<polygon fill="black" stroke="black" points="949.94,-2231.08 946.44,-2221.08 942.94,-2231.08 949.94,-2231.08"/>
</g>
<!-- layer_15_gate -->
<g id="node126" class="node">
<title>layer_15_gate</title>
<polygon fill="lightcoral" stroke="black" points="1016.44,-2037 876.44,-2037 876.44,-1984 1016.44,-1984 1016.44,-2037"/>
<text text-anchor="middle" x="946.44" y="-2021.8" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="946.44" y="-2006.8" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="946.44" y="-1991.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="650.94" y="-1972.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="650.94" y="-1957.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="650.94" y="-1942.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_15_residual&#45;&gt;layer_15_gate -->
<g id="edge125" class="edge">
<title>layer_15_residual&#45;&gt;layer_15_gate</title>
<path fill="none" stroke="black" d="M946.44,-2144.58C946.44,-2115.73 946.44,-2076.05 946.44,-2047.55"/>
<polygon fill="black" stroke="black" points="949.94,-2047.21 946.44,-2037.21 942.94,-2047.21 949.94,-2047.21"/>
</g>
<!-- layer_15_up -->
<g id="node127" class="node">
<title>layer_15_up</title>
<polygon fill="lightcoral" stroke="black" points="1016.44,-1876 876.44,-1876 876.44,-1823 1016.44,-1823 1016.44,-1876"/>
<text text-anchor="middle" x="946.44" y="-1860.8" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="946.44" y="-1845.8" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="946.44" y="-1830.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="650.94" y="-1811.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="650.94" y="-1796.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="650.94" y="-1781.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_up -->
<g id="edge126" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_up</title>
<path fill="none" stroke="black" d="M946.44,-1983.95C946.44,-1957.61 946.44,-1916.29 946.44,-1886.61"/>
<polygon fill="black" stroke="black" points="949.94,-1886.25 946.44,-1876.25 942.94,-1886.25 949.94,-1886.25"/>
</g>
<!-- layer_15_down -->
<g id="node128" class="node">
<title>layer_15_down</title>
<polygon fill="lightcoral" stroke="black" points="1004.44,-1715 888.44,-1715 888.44,-1662 1004.44,-1662 1004.44,-1715"/>
<text text-anchor="middle" x="946.44" y="-1699.8" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="946.44" y="-1684.8" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="946.44" y="-1669.8" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="668.94" y="-1650.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, mlp_hidden=8192]</text>
<text text-anchor="middle" x="668.94" y="-1635.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="668.94" y="-1620.8" font-family="Times,serif" font-size="14.00">Devices: [8,9,10,11] vs [12,13,14,15]</text>
</g>
<!-- layer_15_up&#45;&gt;layer_15_down -->
<g id="edge127" class="edge">
<title>layer_15_up&#45;&gt;layer_15_down</title>
<path fill="none" stroke="black" d="M946.44,-1822.95C946.44,-1796.61 946.44,-1755.29 946.44,-1725.61"/>
<polygon fill="black" stroke="black" points="949.94,-1725.25 946.44,-1715.25 942.94,-1725.25 949.94,-1725.25"/>
</g>
<!-- layer_15_mlp_residual -->
<g id="node129" class="node">
<title>layer_15_mlp_residual</title>
<polygon fill="lightgray" stroke="black" points="1099.82,-1554 855.83,-1554 793.06,-1478 1037.05,-1478 1099.82,-1554"/>
<text text-anchor="middle" x="946.44" y="-1519.8" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="946.44" y="-1504.8" font-family="Times,serif" font-size="14.00">MLP Residual Add</text>
<text text-anchor="middle" x="579" y="-1466.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="579" y="-1451.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="579" y="-1436.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- layer_15_down&#45;&gt;layer_15_mlp_residual -->
<g id="edge128" class="edge">
<title>layer_15_down&#45;&gt;layer_15_mlp_residual</title>
<path fill="none" stroke="black" d="M946.44,-1661.97C946.44,-1636.27 946.44,-1596 946.44,-1564.42"/>
<polygon fill="black" stroke="black" points="949.94,-1564.08 946.44,-1554.08 942.94,-1564.08 949.94,-1564.08"/>
</g>
<!-- output -->
<g id="node131" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="946.44" cy="-1343.5" rx="72.59" ry="18"/>
<text text-anchor="middle" x="946.44" y="-1339.8" font-family="Times,serif" font-size="14.00">Output Layer</text>
<text text-anchor="middle" x="1081.65" y="-1380.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=100000, d_model=4096]</text>
<text text-anchor="middle" x="1081.65" y="-1365.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=100000, vocab_size]</text>
</g>
<!-- layer_15_mlp_residual&#45;&gt;output -->
<g id="edge129" class="edge">
<title>layer_15_mlp_residual&#45;&gt;output</title>
<path fill="none" stroke="black" d="M946.44,-1477.58C946.44,-1445.6 946.44,-1400.32 946.44,-1371.69"/>
<polygon fill="black" stroke="black" points="949.94,-1371.6 946.44,-1361.6 942.94,-1371.6 949.94,-1371.6"/>
</g>
<!-- pipeline_communication -->
<g id="node130" class="node">
<title>pipeline_communication</title>
<ellipse fill="orange" stroke="black" cx="1311.44" cy="-10842.87" rx="135.11" ry="26.74"/>
<text text-anchor="middle" x="1311.44" y="-10846.67" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="1311.44" y="-10831.67" font-family="Times,serif" font-size="14.00">(Micro&#45;batch Transfer)</text>
<text text-anchor="middle" x="1088.38" y="-10903.54" font-family="Times,serif" font-size="14.00">Transfer micro&#45;batches</text>
<text text-anchor="middle" x="1088.38" y="-10888.54" font-family="Times,serif" font-size="14.00">From Stage 0 to Stage 1</text>
<text text-anchor="middle" x="1088.38" y="-10873.54" font-family="Times,serif" font-size="14.00">Devices: 0&#45;7  8&#45;15</text>
</g>
<!-- pipeline_communication&#45;&gt;layer_8_qkv -->
<g id="edge73" class="edge">
<title>pipeline_communication&#45;&gt;layer_8_qkv</title>
<path fill="none" stroke="black" d="M1311.44,-10815.91C1311.44,-10789.44 1311.44,-10748.16 1311.44,-10718.53"/>
<polygon fill="black" stroke="black" points="1314.94,-10718.19 1311.44,-10708.19 1307.94,-10718.19 1314.94,-10718.19"/>
</g>
</g>
</svg>
