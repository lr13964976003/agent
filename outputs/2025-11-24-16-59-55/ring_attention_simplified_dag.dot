digraph ring_attention_sp_simplified {
	graph [bb="0,0,2658.9,3130",
		nodesep=1.0,
		rankdir=LR,
		ranksep=1.0
	];
	node [label="\N",
		shape=rectangle,
		style=filled
	];
	subgraph cluster_device_0 {
		graph [bb="743.22,2174,2387.2,3122",
			color=blue,
			label="Device 0\nTokens: 0-6249",
			lheight=0.42,
			lp="1565.2,3103",
			lwidth=1.51,
			style=dashed
		];
		d0_l0_qkv	[fillcolor=lightgreen,
			height=0.73611,
			label="D0\nL0\nQKV Proj",
			pos="801.22,3049",
			width=1.1389,
			xlabel="Input: [128, 6250, 4096]\nOutput: [128, 6250, 32*128]",
			xlp="658.72,3007.5"];
		d0_l0_ring_stage_0	[fillcolor=yellow,
			height=0.94444,
			label="D0\nL0\nStage 0\nKV from D0",
			pos="1008.2,2265",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="964.72,2208.5"];
		d0_l0_qkv -> d0_l0_ring_stage_0	[pos="e,1007.8,2299 838.12,3022.2 849.37,3012.1 860.79,2999.6 868.22,2986 994.48,2754.6 1007.5,2426.7 1007.8,2309.1"];
		d0_l0_mlp	[fillcolor=lightcoral,
			height=0.73611,
			label="D0\nL0\nMLP Block",
			pos="1306.2,2265",
			width=1.2917,
			xlabel="Input: [128, 6250, 4096]\nOutput: [128, 6250, 4096]",
			xlp="1166.2,2253.5"];
		d0_l0_ring_stage_0 -> d0_l0_mlp	[pos="e,1259.3,2265 1058.4,2265 1110.9,2265 1194,2265 1249,2265"];
		d0_l0_ring_stage_8	[fillcolor=yellow,
			height=0.94444,
			label="D0\nL0\nStage 8\nKV from D8",
			pos="801.22,2916",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="657.72,2859.5"];
		d0_l0_ring_stage_15	[fillcolor=yellow,
			height=0.94444,
			label="D0\nL0\nStage 15\nKV from D1",
			pos="801.22,2776",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="657.72,2719.5"];
		d0_l8_qkv	[fillcolor=lightgreen,
			height=0.73611,
			label="D0\nL8\nQKV Proj",
			pos="1496.2,2264",
			width=1.1389,
			xlabel="Input: [128, 6250, 4096]\nOutput: [128, 6250, 32*128]",
			xlp="1353.7,2222.5"];
		d0_l0_mlp -> d0_l8_qkv	[pos="e,1454.9,2264.2 1352.7,2264.8 1380.5,2264.6 1416.1,2264.4 1444.7,2264.3"];
		d0_l8_ring_stage_8	[fillcolor=yellow,
			height=0.94444,
			label="D0\nL8\nStage 8\nKV from D8",
			pos="1664.7,2240",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="1521.2,2183.5"];
		d0_l8_qkv -> d0_l8_ring_stage_8	[pos="e,1614.6,2247.1 1537.5,2258.2 1557.6,2255.3 1582.4,2251.7 1604.6,2248.5"];
		d0_l8_ring_stage_0	[fillcolor=yellow,
			height=0.94444,
			label="D0\nL8\nStage 0\nKV from D0",
			pos="801.22,2636",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="657.72,2579.5"];
		d0_l8_mlp	[fillcolor=lightcoral,
			height=0.73611,
			label="D0\nL8\nMLP Block",
			pos="1838.7,2228",
			width=1.2917,
			xlabel="Input: [128, 6250, 4096]\nOutput: [128, 6250, 4096]",
			xlp="1791.7,2186.5"];
		d0_l8_ring_stage_8 -> d0_l8_mlp	[pos="e,1792,2231.2 1715,2236.6 1735.9,2235.1 1760.4,2233.4 1782,2231.9"];
		d0_l8_ring_stage_15	[fillcolor=yellow,
			height=0.94444,
			label="D0\nL8\nStage 15\nKV from D1",
			pos="801.22,2496",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="657.72,2439.5"];
		d0_l15_qkv	[fillcolor=lightgreen,
			height=0.73611,
			label="D0\nL15\nQKV Proj",
			pos="1999.2,2222",
			width=1.1389,
			xlabel="Input: [128, 6250, 4096]\nOutput: [128, 6250, 32*128]",
			xlp="1938.7,2263.5"];
		d0_l8_mlp -> d0_l15_qkv	[pos="e,1958.1,2223.5 1885.6,2226.3 1905.1,2225.5 1928,2224.7 1948,2223.9"];
		d0_l15_ring_stage_15	[fillcolor=yellow,
			height=0.94444,
			label="D0\nL15\nStage 15\nKV from D1",
			pos="2163.2,2218",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="2019.7,2161.5"];
		d0_l15_qkv -> d0_l15_ring_stage_15	[pos="e,2113.1,2219.2 2040.3,2221 2059.2,2220.5 2082.2,2220 2103,2219.5"];
		d0_l15_ring_stage_0	[fillcolor=yellow,
			height=0.94444,
			label="D0\nL15\nStage 0\nKV from D0",
			pos="801.22,2356",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="657.72,2299.5"];
		d0_l15_ring_stage_8	[fillcolor=yellow,
			height=0.94444,
			label="D0\nL15\nStage 8\nKV from D8",
			pos="801.22,2216",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="657.72,2159.5"];
		d0_l15_mlp	[fillcolor=lightcoral,
			height=0.73611,
			label="D0\nL15\nMLP Block",
			pos="2332.7,2213",
			width=1.2917,
			xlabel="Input: [128, 6250, 4096]\nOutput: [128, 6250, 4096]",
			xlp="2472.7,2171.5"];
		d0_l15_ring_stage_15 -> d0_l15_mlp	[pos="e,2286.2,2214.4 2213.6,2216.5 2233.2,2215.9 2255.9,2215.3 2276.1,2214.7"];
	}
	subgraph cluster_device_1 {
		graph [bb="743.22,1066,2387.2,2014",
			color=blue,
			label="Device 1\nTokens: 6250-12499",
			lheight=0.42,
			lp="1565.2,1995",
			lwidth=2.01,
			style=dashed
		];
		d1_l0_qkv	[fillcolor=lightgreen,
			height=0.73611,
			label="D1\nL0\nQKV Proj",
			pos="801.22,1941",
			width=1.1389,
			xlabel="Input: [128, 6250, 4096]\nOutput: [128, 6250, 32*128]",
			xlp="658.72,1899.5"];
		d1_l0_ring_stage_0	[fillcolor=yellow,
			height=0.94444,
			label="D1\nL0\nStage 0\nKV from D1",
			pos="1008.2,1934",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="864.72,1877.5"];
		d1_l0_qkv -> d1_l0_ring_stage_0	[pos="e,957.9,1935.7 842.24,1939.6 872.23,1938.6 913.76,1937.2 947.65,1936"];
		d1_l0_mlp	[fillcolor=lightcoral,
			height=0.73611,
			label="D1\nL0\nMLP Block",
			pos="1306.2,1719",
			width=1.2917,
			xlabel="Input: [128, 6250, 4096]\nOutput: [128, 6250, 4096]",
			xlp="1166.2,1677.5"];
		d1_l0_ring_stage_0 -> d1_l0_mlp	[pos="e,1268.4,1745.8 1056.1,1899.9 1112.1,1859.3 1205,1791.8 1260.2,1751.7"];
		d1_l0_ring_stage_8	[fillcolor=yellow,
			height=0.94444,
			label="D1\nL0\nStage 8\nKV from D9",
			pos="801.22,1808",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="657.72,1751.5"];
		d1_l0_ring_stage_15	[fillcolor=yellow,
			height=0.94444,
			label="D1\nL0\nStage 15\nKV from D2",
			pos="801.22,1668",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="657.72,1611.5"];
		d1_l8_qkv	[fillcolor=lightgreen,
			height=0.73611,
			label="D1\nL8\nQKV Proj",
			pos="1496.2,1718",
			width=1.1389,
			xlabel="Input: [128, 6250, 4096]\nOutput: [128, 6250, 32*128]",
			xlp="1435.7,1676.5"];
		d1_l0_mlp -> d1_l8_qkv	[pos="e,1454.9,1718.2 1352.7,1718.8 1380.5,1718.6 1416.1,1718.4 1444.7,1718.3"];
		d1_l8_ring_stage_8	[fillcolor=yellow,
			height=0.94444,
			label="D1\nL8\nStage 8\nKV from D9",
			pos="1664.7,1615",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="1521.2,1558.5"];
		d1_l8_qkv -> d1_l8_ring_stage_8	[pos="e,1614.6,1645.4 1537.5,1693.1 1558.1,1680.3 1583.5,1664.6 1606.1,1650.7"];
		d1_l8_ring_stage_0	[fillcolor=yellow,
			height=0.94444,
			label="D1\nL8\nStage 0\nKV from D1",
			pos="801.22,1528",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="657.72,1471.5"];
		d1_l8_mlp	[fillcolor=lightcoral,
			height=0.73611,
			label="D1\nL8\nMLP Block",
			pos="1838.7,1562",
			width=1.2917,
			xlabel="Input: [128, 6250, 4096]\nOutput: [128, 6250, 4096]",
			xlp="1698.7,1520.5"];
		d1_l8_ring_stage_8 -> d1_l8_mlp	[pos="e,1792,1576.1 1715,1599.8 1736,1593.3 1760.6,1585.8 1782.3,1579.1"];
		d1_l8_ring_stage_15	[fillcolor=yellow,
			height=0.94444,
			label="D1\nL8\nStage 15\nKV from D2",
			pos="801.22,1388",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="757.72,1331.5"];
		d1_l15_qkv	[fillcolor=lightgreen,
			height=0.73611,
			label="D1\nL15\nQKV Proj",
			pos="1999.2,1534",
			width=1.1389,
			xlabel="Input: [128, 6250, 4096]\nOutput: [128, 6250, 32*128]",
			xlp="1938.7,1492.5"];
		d1_l8_mlp -> d1_l15_qkv	[pos="e,1958.1,1541.1 1885.6,1553.9 1905.2,1550.4 1928.2,1546.4 1948.2,1542.8"];
		d1_l15_ring_stage_15	[fillcolor=yellow,
			height=0.94444,
			label="D1\nL15\nStage 15\nKV from D2",
			pos="2163.2,1515",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="2306.7,1458.5"];
		d1_l15_qkv -> d1_l15_ring_stage_15	[pos="e,2113.1,1520.8 2040.3,1529.3 2059.2,1527.1 2082.2,1524.4 2103,1521.9"];
		d1_l15_ring_stage_0	[fillcolor=yellow,
			height=0.94444,
			label="D1\nL15\nStage 0\nKV from D1",
			pos="801.22,1248",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="757.72,1191.5"];
		d1_l15_ring_stage_8	[fillcolor=yellow,
			height=0.94444,
			label="D1\nL15\nStage 8\nKV from D9",
			pos="801.22,1108",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="657.72,1051.5"];
		d1_l15_mlp	[fillcolor=lightcoral,
			height=0.73611,
			label="D1\nL15\nMLP Block",
			pos="2332.7,1308",
			width=1.2917,
			xlabel="Input: [128, 6250, 4096]\nOutput: [128, 6250, 4096]",
			xlp="2192.7,1266.5"];
		d1_l15_ring_stage_15 -> d1_l15_mlp	[pos="e,2310.2,1334.7 2191.9,1480.8 2222.9,1442.5 2272.8,1380.9 2303.8,1342.5"];
	}
	subgraph cluster_device_2 {
		graph [bb="738.72,100,2387.2,1048",
			color=blue,
			label="Device 2\nTokens: 12500-18749",
			lheight=0.42,
			lp="1563,1029",
			lwidth=2.14,
			style=dashed
		];
		d2_l0_qkv	[fillcolor=lightgreen,
			height=0.73611,
			label="D2\nL0\nQKV Proj",
			pos="801.22,975",
			width=1.1389,
			xlabel="Input: [128, 6250, 4096]\nOutput: [128, 6250, 32*128]",
			xlp="658.72,933.5"];
		d2_l0_ring_stage_0	[fillcolor=yellow,
			height=0.94444,
			label="D2\nL0\nStage 0\nKV from D2",
			pos="1008.2,968",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="864.72,911.5"];
		d2_l0_qkv -> d2_l0_ring_stage_0	[pos="e,957.9,969.68 842.24,973.63 872.23,972.61 913.76,971.19 947.65,970.03"];
		d2_l0_mlp	[fillcolor=lightcoral,
			height=0.73611,
			label="D2\nL0\nMLP Block",
			pos="1306.2,968",
			width=1.2917,
			xlabel="Input: [128, 6250, 4096]\nOutput: [128, 6250, 4096]",
			xlp="1166.2,926.5"];
		d2_l0_ring_stage_0 -> d2_l0_mlp	[pos="e,1259.3,968 1058.4,968 1110.9,968 1194,968 1249,968"];
		d2_l0_ring_stage_8	[fillcolor=yellow,
			height=0.94444,
			label="D2\nL0\nStage 8\nKV from D10",
			pos="801.22,842",
			width=1.5139,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="653.22,785.5"];
		d2_l0_ring_stage_15	[fillcolor=yellow,
			height=0.94444,
			label="D2\nL0\nStage 15\nKV from D3",
			pos="801.22,702",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="657.72,645.5"];
		d2_l8_qkv	[fillcolor=lightgreen,
			height=0.73611,
			label="D2\nL8\nQKV Proj",
			pos="1496.2,968",
			width=1.1389,
			xlabel="Input: [128, 6250, 4096]\nOutput: [128, 6250, 32*128]",
			xlp="1435.7,926.5"];
		d2_l0_mlp -> d2_l8_qkv	[pos="e,1454.9,968 1352.7,968 1380.5,968 1416.1,968 1444.7,968"];
		d2_l8_ring_stage_8	[fillcolor=yellow,
			height=0.94444,
			label="D2\nL8\nStage 8\nKV from D10",
			pos="1664.7,968",
			width=1.5139,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="1812.7,911.5"];
		d2_l8_qkv -> d2_l8_ring_stage_8	[pos="e,1609.9,968 1537.5,968 1556.2,968 1578.9,968 1599.8,968"];
		d2_l8_ring_stage_0	[fillcolor=yellow,
			height=0.94444,
			label="D2\nL8\nStage 0\nKV from D2",
			pos="801.22,562",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="657.72,505.5"];
		d2_l8_mlp	[fillcolor=lightcoral,
			height=0.73611,
			label="D2\nL8\nMLP Block",
			pos="1838.7,968",
			width=1.2917,
			xlabel="Input: [128, 6250, 4096]\nOutput: [128, 6250, 4096]",
			xlp="1978.7,1009.5"];
		d2_l8_ring_stage_8 -> d2_l8_mlp	[pos="e,1792.1,968 1719.7,968 1739.5,968 1761.9,968 1781.9,968"];
		d2_l8_ring_stage_15	[fillcolor=yellow,
			height=0.94444,
			label="D2\nL8\nStage 15\nKV from D3",
			pos="801.22,422",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="657.72,365.5"];
		d2_l15_qkv	[fillcolor=lightgreen,
			height=0.73611,
			label="D2\nL15\nQKV Proj",
			pos="1999.2,968",
			width=1.1389,
			xlabel="Input: [128, 6250, 4096]\nOutput: [128, 6250, 32*128]",
			xlp="2141.7,926.5"];
		d2_l8_mlp -> d2_l15_qkv	[pos="e,1958.1,968 1885.6,968 1905.1,968 1928,968 1948,968"];
		d2_l15_ring_stage_15	[fillcolor=yellow,
			height=0.94444,
			label="D2\nL15\nStage 15\nKV from D3",
			pos="2163.2,968",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="2306.7,1024.5"];
		d2_l15_qkv -> d2_l15_ring_stage_15	[pos="e,2113.1,968 2040.3,968 2059.2,968 2082.2,968 2103,968"];
		d2_l15_ring_stage_0	[fillcolor=yellow,
			height=0.94444,
			label="D2\nL15\nStage 0\nKV from D2",
			pos="801.22,282",
			width=1.3889,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="657.72,225.5"];
		d2_l15_ring_stage_8	[fillcolor=yellow,
			height=0.94444,
			label="D2\nL15\nStage 8\nKV from D10",
			pos="801.22,142",
			width=1.5139,
			xlabel="Q: [128, 6250, 32, 128]\nK,V: [128, 6250, 32, 128]\nOutput: [128, 6250, 4096]",
			xlp="653.22,85.5"];
		d2_l15_mlp	[fillcolor=lightcoral,
			height=0.73611,
			label="D2\nL15\nMLP Block",
			pos="2332.7,973",
			width=1.2917,
			xlabel="Input: [128, 6250, 4096]\nOutput: [128, 6250, 4096]",
			xlp="2472.7,931.5"];
		d2_l15_ring_stage_15 -> d2_l15_mlp	[pos="e,2286.2,971.64 2213.6,969.47 2233.2,970.06 2255.9,970.74 2276.1,971.34"];
	}
	input_split	[fillcolor=lightblue,
		height=0.74639,
		label="Input Sequence\nSplit (100k → 6.25k)",
		pos="543.84,1236",
		shape=ellipse,
		width=3.1623,
		xlabel="Input: [batch=128, seq=100k, d_model=4096]\nOutput: [batch=128, seq=6.25k, d_model=4096] per device",
		xlp="215,1194.1"];
	input_split -> d0_l0_qkv	[pos="e,762.82,3022.5 611.61,1257.6 630.84,1267.2 649.71,1280.6 661.22,1299 710.97,1378.5 695.46,2900.6 734.22,2986 739.18,2996.9 746.99,\
3006.9 755.52,3015.5"];
	input_split -> d1_l0_qkv	[pos="e,763.82,1914.5 610.11,1257.9 629.49,1267.5 648.83,1280.9 661.22,1299 807.68,1513.1 617.45,1646.4 734.22,1878 739.68,1888.8 747.78,\
1898.8 756.45,1907.5"];
	input_split -> d2_l0_qkv	[pos="e,774.26,1001.5 570.74,1209.5 617.39,1161.9 715.49,1061.6 767.01,1008.9"];
	cluster_device_0	[height=0.5,
		pos="801.22,18",
		width=1.8611];
	input_split -> cluster_device_0	[pos="e,774.65,36.153 546.96,1209.1 559.39,1055.5 626.05,288.91 734.22,82 742.05,67.032 754.68,53.503 766.81,42.781",
		style=invis];
	d1_l0_ring_stage_1	[height=0.5,
		pos="1306.2,2148",
		width=2.1111];
	d0_l0_ring_stage_0 -> d1_l0_ring_stage_1	[label="KV transfer",
		lp="1152.7,2223.5",
		pos="e,1241.6,2166.1 1058.6,2241.8 1102.9,2221.4 1170.1,2191.6 1230.2,2170 1230.8,2169.8 1231.4,2169.6 1232,2169.4",
		style=dashed];
	output_agg	[fillcolor=lightgreen,
		height=0.5,
		label="Output Aggregation",
		pos="2555.6,1127",
		shape=ellipse,
		width=2.8706,
		xlabel="Concatenate 16×[128, 6250, 4096]\n→ [128, 100k, 4096]",
		xlp="2326.2,1094"];
	d0_l15_mlp -> output_agg	[pos="e,2552,1145 2342.6,2186.3 2354,2151.1 2373.9,2087.4 2387.2,2032 2469.2,1689.9 2533.9,1266.8 2550.5,1155.1"];
	d2_l0_ring_stage_1	[height=0.5,
		pos="1306.2,2040",
		width=2.1111];
	d1_l0_ring_stage_0 -> d2_l0_ring_stage_1	[label="KV transfer",
		lp="1152.7,2012.5",
		pos="e,1242.5,2022 1058.4,1954 1102.9,1971.7 1170.5,1997.9 1230.2,2018 1231.1,2018.3 1232,2018.6 1232.9,2018.9",
		style=dashed];
	d1_l15_mlp -> output_agg	[pos="e,2532.9,1144.8 2366.3,1281.3 2409.2,1246.2 2483.8,1185 2525.1,1151.2"];
	d2_l15_mlp -> output_agg	[pos="e,2529.5,1109.5 2371.9,999.65 2414,1029 2481.1,1075.7 2521.1,1103.7"];
	ring_comm	[fillcolor=orange,
		height=0.74639,
		label="Ring Communication\nPattern",
		pos="543.84,1362",
		shape=ellipse,
		width=3.2605,
		xlabel="P2P Send/Recv\nKV blocks\nEach → next device",
		xlp="356.96,1312.6"];
	cluster_device_1	[height=0.5,
		pos="1008.2,45",
		width=1.8611];
	cluster_device_0 -> cluster_device_1	[pos="e,941.18,36.301 868.5,26.729 888.5,29.364 910.62,32.277 931.21,34.988",
		style=invis];
	cluster_device_2	[height=0.5,
		pos="1306.2,52",
		width=1.8611];
	cluster_device_1 -> cluster_device_2	[pos="e,1239.1,50.437 1075.3,46.562 1120.8,47.638 1181.3,49.07 1228.9,50.194",
		style=invis];
	cluster_device_2 -> output_agg	[pos="e,2554.8,1108.8 1373.3,52.523 1409.4,52.765 1454.8,53 1495.2,53 1495.2,53 1495.2,53 2333.7,53 2553.8,53 2556.5,928.8 2554.9,1098.7",
		style=invis];
}
