<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_tensor_pipeline_parallel Pages: 1 -->
<svg width="1440pt" height="992pt"
 viewBox="0.00 0.00 1440.00 992.47" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.47 0.47) rotate(0) translate(4 2129.12)">
<title>baseline_tensor_pipeline_parallel</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2129.12 3090.98,-2129.12 3090.98,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<polygon fill="none" stroke="black" points="2553.91,-537.17 2553.91,-2042.17 2831.91,-2042.17 2831.91,-537.17 2553.91,-537.17"/>
<text text-anchor="middle" x="2692.91" y="-2026.97" font-family="Times,serif" font-size="14.00">Pipeline Stage 0</text>
<text text-anchor="middle" x="2692.91" y="-2011.97" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7 (Tensor Parallel Group 0)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<polygon fill="none" stroke="black" points="35.91,-124.17 35.91,-365.17 2821.91,-365.17 2821.91,-124.17 35.91,-124.17"/>
<text text-anchor="middle" x="1428.91" y="-349.97" font-family="Times,serif" font-size="14.00">Pipeline Stage 1</text>
<text text-anchor="middle" x="1428.91" y="-334.97" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15 (Tensor Parallel Group 1)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="2770.91" cy="-2087.64" rx="316.15" ry="37.45"/>
<text text-anchor="middle" x="2770.91" y="-2098.94" font-family="Times,serif" font-size="14.00">Model Input</text>
<text text-anchor="middle" x="2770.91" y="-2083.94" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2770.91" y="-2068.94" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_norm1 -->
<g id="node2" class="node">
<title>layer1_norm1</title>
<polygon fill="lightyellow" stroke="black" points="2805.91,-1996.17 2593.91,-1996.17 2593.91,-1913.17 2805.91,-1913.17 2805.91,-1996.17"/>
<text text-anchor="middle" x="2699.91" y="-1980.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2699.91" y="-1965.97" font-family="Times,serif" font-size="14.00">Input Layer Norm</text>
<text text-anchor="middle" x="2699.91" y="-1950.97" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2699.91" y="-1935.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2699.91" y="-1920.97" font-family="Times,serif" font-size="14.00">All 8 GPUs</text>
</g>
<!-- input&#45;&gt;layer1_norm1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer1_norm1</title>
<path fill="none" stroke="black" d="M2751.13,-2050.16C2743.65,-2036.37 2735.01,-2020.43 2726.98,-2005.61"/>
<polygon fill="black" stroke="black" points="2729.92,-2003.69 2722.08,-1996.56 2723.77,-2007.02 2729.92,-2003.69"/>
</g>
<!-- layer1_residual1 -->
<g id="node7" class="node">
<title>layer1_residual1</title>
<polygon fill="lightgreen" stroke="black" points="2810.91,-1416.17 2598.91,-1416.17 2598.91,-1333.17 2810.91,-1333.17 2810.91,-1416.17"/>
<text text-anchor="middle" x="2704.91" y="-1400.97" font-family="Times,serif" font-size="14.00">Layer 1 Residual Add</text>
<text text-anchor="middle" x="2704.91" y="-1385.97" font-family="Times,serif" font-size="14.00">Input1: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2704.91" y="-1370.97" font-family="Times,serif" font-size="14.00">Input2: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2704.91" y="-1355.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2704.91" y="-1340.97" font-family="Times,serif" font-size="14.00">All 8 GPUs</text>
</g>
<!-- input&#45;&gt;layer1_residual1 -->
<g id="edge7" class="edge">
<title>input&#45;&gt;layer1_residual1</title>
<path fill="none" stroke="black" d="M2810.34,-2050.18C2812.06,-2047.59 2813.6,-2044.91 2814.91,-2042.17 2854.31,-1959.19 2836.91,-1928.52 2836.91,-1836.67 2836.91,-1836.67 2836.91,-1836.67 2836.91,-1611.67 2836.91,-1540.04 2851.41,-1513.19 2813.91,-1452.17 2807.15,-1441.18 2798.17,-1431.35 2788.25,-1422.69"/>
<polygon fill="black" stroke="black" points="2790.44,-1419.96 2780.5,-1416.3 2785.98,-1425.36 2790.44,-1419.96"/>
</g>
<!-- layer1_qkv_proj -->
<g id="node3" class="node">
<title>layer1_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="2803.91,-1877.17 2591.91,-1877.17 2591.91,-1794.17 2803.91,-1794.17 2803.91,-1877.17"/>
<text text-anchor="middle" x="2697.91" y="-1861.97" font-family="Times,serif" font-size="14.00">Layer 1 QKV Projection</text>
<text text-anchor="middle" x="2697.91" y="-1846.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2697.91" y="-1831.97" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2697.91" y="-1816.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 1536]</text>
<text text-anchor="middle" x="2697.91" y="-1801.97" font-family="Times,serif" font-size="14.00">Per GPU</text>
</g>
<!-- layer1_norm1&#45;&gt;layer1_qkv_proj -->
<g id="edge2" class="edge">
<title>layer1_norm1&#45;&gt;layer1_qkv_proj</title>
<path fill="none" stroke="black" d="M2699.21,-1913.07C2699.07,-1904.72 2698.92,-1895.84 2698.77,-1887.19"/>
<polygon fill="black" stroke="black" points="2702.27,-1887.13 2698.6,-1877.19 2695.27,-1887.25 2702.27,-1887.13"/>
</g>
<!-- layer1_attn -->
<g id="node4" class="node">
<title>layer1_attn</title>
<polygon fill="lightcoral" stroke="black" points="2808.91,-1758.17 2578.91,-1758.17 2578.91,-1690.17 2808.91,-1690.17 2808.91,-1758.17"/>
<text text-anchor="middle" x="2693.91" y="-1742.97" font-family="Times,serif" font-size="14.00">Layer 1 Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2693.91" y="-1727.97" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 32, 128]</text>
<text text-anchor="middle" x="2693.91" y="-1712.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 32, 128]</text>
<text text-anchor="middle" x="2693.91" y="-1697.97" font-family="Times,serif" font-size="14.00">All 8 GPUs</text>
</g>
<!-- layer1_qkv_proj&#45;&gt;layer1_attn -->
<g id="edge3" class="edge">
<title>layer1_qkv_proj&#45;&gt;layer1_attn</title>
<path fill="none" stroke="black" d="M2696.42,-1793.89C2696.12,-1785.68 2695.8,-1777.03 2695.5,-1768.73"/>
<polygon fill="black" stroke="black" points="2698.99,-1768.33 2695.12,-1758.47 2691.99,-1768.59 2698.99,-1768.33"/>
</g>
<!-- layer1_attn_out -->
<g id="node5" class="node">
<title>layer1_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="2797.41,-1654.17 2594.41,-1654.17 2594.41,-1571.17 2797.41,-1571.17 2797.41,-1654.17"/>
<text text-anchor="middle" x="2695.91" y="-1638.97" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output</text>
<text text-anchor="middle" x="2695.91" y="-1623.97" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2695.91" y="-1608.97" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2695.91" y="-1593.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 512]</text>
<text text-anchor="middle" x="2695.91" y="-1578.97" font-family="Times,serif" font-size="14.00">Per GPU</text>
</g>
<!-- layer1_attn&#45;&gt;layer1_attn_out -->
<g id="edge4" class="edge">
<title>layer1_attn&#45;&gt;layer1_attn_out</title>
<path fill="none" stroke="black" d="M2694.51,-1690.02C2694.66,-1681.96 2694.82,-1673.17 2694.98,-1664.5"/>
<polygon fill="black" stroke="black" points="2698.48,-1664.51 2695.16,-1654.44 2691.48,-1664.38 2698.48,-1664.51"/>
</g>
<!-- layer1_attn_allreduce -->
<g id="node6" class="node">
<title>layer1_attn_allreduce</title>
<polygon fill="#eedd82" stroke="black" points="2804.91,-1535.17 2592.91,-1535.17 2592.91,-1452.17 2804.91,-1452.17 2804.91,-1535.17"/>
<text text-anchor="middle" x="2698.91" y="-1519.97" font-family="Times,serif" font-size="14.00">Layer 1 All&#45;Reduce</text>
<text text-anchor="middle" x="2698.91" y="-1504.97" font-family="Times,serif" font-size="14.00">Sum Reduction</text>
<text text-anchor="middle" x="2698.91" y="-1489.97" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 512]</text>
<text text-anchor="middle" x="2698.91" y="-1474.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2698.91" y="-1459.97" font-family="Times,serif" font-size="14.00">All 8 GPUs</text>
</g>
<!-- layer1_attn_out&#45;&gt;layer1_attn_allreduce -->
<g id="edge5" class="edge">
<title>layer1_attn_out&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M2696.95,-1571.07C2697.16,-1562.72 2697.39,-1553.84 2697.61,-1545.19"/>
<polygon fill="black" stroke="black" points="2701.11,-1545.27 2697.87,-1535.19 2694.11,-1545.09 2701.11,-1545.27"/>
</g>
<!-- layer1_attn_allreduce&#45;&gt;layer1_residual1 -->
<g id="edge6" class="edge">
<title>layer1_attn_allreduce&#45;&gt;layer1_residual1</title>
<path fill="none" stroke="black" d="M2700.99,-1452.07C2701.42,-1443.72 2701.87,-1434.84 2702.32,-1426.19"/>
<polygon fill="black" stroke="black" points="2705.81,-1426.35 2702.83,-1416.19 2698.82,-1425.99 2705.81,-1426.35"/>
</g>
<!-- layer1_norm2 -->
<g id="node8" class="node">
<title>layer1_norm2</title>
<polygon fill="lightyellow" stroke="black" points="2798.91,-1297.17 2586.91,-1297.17 2586.91,-1229.17 2798.91,-1229.17 2798.91,-1297.17"/>
<text text-anchor="middle" x="2692.91" y="-1281.97" font-family="Times,serif" font-size="14.00">Layer 1 MLP Layer Norm</text>
<text text-anchor="middle" x="2692.91" y="-1266.97" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2692.91" y="-1251.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2692.91" y="-1236.97" font-family="Times,serif" font-size="14.00">All 8 GPUs</text>
</g>
<!-- layer1_residual1&#45;&gt;layer1_norm2 -->
<g id="edge8" class="edge">
<title>layer1_residual1&#45;&gt;layer1_norm2</title>
<path fill="none" stroke="black" d="M2700.44,-1332.89C2699.53,-1324.59 2698.57,-1315.83 2697.65,-1307.45"/>
<polygon fill="black" stroke="black" points="2701.12,-1307.03 2696.56,-1297.47 2694.17,-1307.79 2701.12,-1307.03"/>
</g>
<!-- layer1_residual2 -->
<g id="node13" class="node">
<title>layer1_residual2</title>
<polygon fill="lightgreen" stroke="black" points="2813.91,-732.17 2601.91,-732.17 2601.91,-649.17 2813.91,-649.17 2813.91,-732.17"/>
<text text-anchor="middle" x="2707.91" y="-716.97" font-family="Times,serif" font-size="14.00">Layer 1 Residual Add</text>
<text text-anchor="middle" x="2707.91" y="-701.97" font-family="Times,serif" font-size="14.00">Input1: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2707.91" y="-686.97" font-family="Times,serif" font-size="14.00">Input2: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2707.91" y="-671.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2707.91" y="-656.97" font-family="Times,serif" font-size="14.00">All 8 GPUs</text>
</g>
<!-- layer1_residual1&#45;&gt;layer1_residual2 -->
<g id="edge14" class="edge">
<title>layer1_residual1&#45;&gt;layer1_residual2</title>
<path fill="none" stroke="black" d="M2776.27,-1333.09C2788.67,-1322.91 2800.08,-1310.91 2807.91,-1297.17 2839.86,-1241.06 2822.91,-1217.23 2822.91,-1152.67 2822.91,-1152.67 2822.91,-1152.67 2822.91,-927.67 2822.91,-856.51 2843.34,-830.44 2808.91,-768.17 2802.94,-757.38 2794.75,-747.65 2785.6,-739.04"/>
<polygon fill="black" stroke="black" points="2787.88,-736.38 2778.07,-732.36 2783.23,-741.62 2787.88,-736.38"/>
</g>
<!-- layer1_mlp_gate_up -->
<g id="node9" class="node">
<title>layer1_mlp_gate_up</title>
<polygon fill="lightcyan" stroke="black" points="2793.91,-1193.17 2581.91,-1193.17 2581.91,-1110.17 2793.91,-1110.17 2793.91,-1193.17"/>
<text text-anchor="middle" x="2687.91" y="-1177.97" font-family="Times,serif" font-size="14.00">Layer 1 MLP Gate+Up</text>
<text text-anchor="middle" x="2687.91" y="-1162.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2687.91" y="-1147.97" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2687.91" y="-1132.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2687.91" y="-1117.97" font-family="Times,serif" font-size="14.00">Per GPU</text>
</g>
<!-- layer1_norm2&#45;&gt;layer1_mlp_gate_up -->
<g id="edge9" class="edge">
<title>layer1_norm2&#45;&gt;layer1_mlp_gate_up</title>
<path fill="none" stroke="black" d="M2691.39,-1229.02C2691.03,-1220.96 2690.62,-1212.17 2690.23,-1203.5"/>
<polygon fill="black" stroke="black" points="2693.72,-1203.27 2689.77,-1193.44 2686.73,-1203.59 2693.72,-1203.27"/>
</g>
<!-- layer1_mlp_activation -->
<g id="node10" class="node">
<title>layer1_mlp_activation</title>
<polygon fill="lightcyan" stroke="black" points="2803.91,-1074.17 2561.91,-1074.17 2561.91,-1006.17 2803.91,-1006.17 2803.91,-1074.17"/>
<text text-anchor="middle" x="2682.91" y="-1058.97" font-family="Times,serif" font-size="14.00">Layer 1 MLP Activation (GELU)</text>
<text text-anchor="middle" x="2682.91" y="-1043.97" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2682.91" y="-1028.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2682.91" y="-1013.97" font-family="Times,serif" font-size="14.00">All 8 GPUs</text>
</g>
<!-- layer1_mlp_gate_up&#45;&gt;layer1_mlp_activation -->
<g id="edge10" class="edge">
<title>layer1_mlp_gate_up&#45;&gt;layer1_mlp_activation</title>
<path fill="none" stroke="black" d="M2686.04,-1109.89C2685.67,-1101.68 2685.27,-1093.03 2684.9,-1084.73"/>
<polygon fill="black" stroke="black" points="2688.38,-1084.3 2684.43,-1074.47 2681.39,-1084.62 2688.38,-1084.3"/>
</g>
<!-- layer1_mlp_down -->
<g id="node11" class="node">
<title>layer1_mlp_down</title>
<polygon fill="lightcyan" stroke="black" points="2788.41,-970.17 2585.41,-970.17 2585.41,-887.17 2788.41,-887.17 2788.41,-970.17"/>
<text text-anchor="middle" x="2686.91" y="-954.97" font-family="Times,serif" font-size="14.00">Layer 1 MLP Down</text>
<text text-anchor="middle" x="2686.91" y="-939.97" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2686.91" y="-924.97" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2686.91" y="-909.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 512]</text>
<text text-anchor="middle" x="2686.91" y="-894.97" font-family="Times,serif" font-size="14.00">Per GPU</text>
</g>
<!-- layer1_mlp_activation&#45;&gt;layer1_mlp_down -->
<g id="edge11" class="edge">
<title>layer1_mlp_activation&#45;&gt;layer1_mlp_down</title>
<path fill="none" stroke="black" d="M2684.12,-1006.02C2684.41,-997.96 2684.73,-989.17 2685.05,-980.5"/>
<polygon fill="black" stroke="black" points="2688.55,-980.57 2685.42,-970.44 2681.55,-980.31 2688.55,-980.57"/>
</g>
<!-- layer1_mlp_allreduce -->
<g id="node12" class="node">
<title>layer1_mlp_allreduce</title>
<polygon fill="#eedd82" stroke="black" points="2799.91,-851.17 2587.91,-851.17 2587.91,-768.17 2799.91,-768.17 2799.91,-851.17"/>
<text text-anchor="middle" x="2693.91" y="-835.97" font-family="Times,serif" font-size="14.00">Layer 1 MLP All&#45;Reduce</text>
<text text-anchor="middle" x="2693.91" y="-820.97" font-family="Times,serif" font-size="14.00">Sum Reduction</text>
<text text-anchor="middle" x="2693.91" y="-805.97" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 512]</text>
<text text-anchor="middle" x="2693.91" y="-790.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2693.91" y="-775.97" font-family="Times,serif" font-size="14.00">All 8 GPUs</text>
</g>
<!-- layer1_mlp_down&#45;&gt;layer1_mlp_allreduce -->
<g id="edge12" class="edge">
<title>layer1_mlp_down&#45;&gt;layer1_mlp_allreduce</title>
<path fill="none" stroke="black" d="M2689.34,-887.07C2689.83,-878.72 2690.37,-869.84 2690.88,-861.19"/>
<polygon fill="black" stroke="black" points="2694.38,-861.38 2691.48,-851.19 2687.39,-860.96 2694.38,-861.38"/>
</g>
<!-- layer1_mlp_allreduce&#45;&gt;layer1_residual2 -->
<g id="edge13" class="edge">
<title>layer1_mlp_allreduce&#45;&gt;layer1_residual2</title>
<path fill="none" stroke="black" d="M2698.76,-768.07C2699.76,-759.72 2700.83,-750.84 2701.86,-742.19"/>
<polygon fill="black" stroke="black" points="2705.35,-742.53 2703.06,-732.19 2698.39,-741.7 2705.35,-742.53"/>
</g>
<!-- layers_2_to_8 -->
<g id="node14" class="node">
<title>layers_2_to_8</title>
<polygon fill="lightgray" stroke="black" points="2797.41,-613.17 2618.41,-613.17 2618.41,-545.17 2797.41,-545.17 2797.41,-613.17"/>
<text text-anchor="middle" x="2707.91" y="-597.97" font-family="Times,serif" font-size="14.00">Layers 2&#45;8</text>
<text text-anchor="middle" x="2707.91" y="-582.97" font-family="Times,serif" font-size="14.00">[Repeated Structure]</text>
<text text-anchor="middle" x="2707.91" y="-567.97" font-family="Times,serif" font-size="14.00">8 layers total</text>
<text text-anchor="middle" x="2707.91" y="-552.97" font-family="Times,serif" font-size="14.00">Each: Same as Layer 1</text>
</g>
<!-- layer1_residual2&#45;&gt;layers_2_to_8 -->
<g id="edge15" class="edge">
<title>layer1_residual2&#45;&gt;layers_2_to_8</title>
<path fill="none" stroke="black" d="M2707.91,-648.89C2707.91,-640.68 2707.91,-632.03 2707.91,-623.73"/>
<polygon fill="black" stroke="black" points="2711.41,-623.47 2707.91,-613.47 2704.41,-623.47 2711.41,-623.47"/>
</g>
<!-- pipeline_send_recv_1 -->
<g id="node15" class="node">
<title>pipeline_send_recv_1</title>
<polygon fill="lightpink" stroke="black" points="2950.61,-509.17 2564.52,-509.17 2465.21,-373.17 2851.29,-373.17 2950.61,-509.17"/>
<text text-anchor="middle" x="2707.91" y="-459.97" font-family="Times,serif" font-size="14.00">Pipeline Send/Recv</text>
<text text-anchor="middle" x="2707.91" y="-444.97" font-family="Times,serif" font-size="14.00">Between Stage 0 and 1</text>
<text text-anchor="middle" x="2707.91" y="-429.97" font-family="Times,serif" font-size="14.00">Activation: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2707.91" y="-414.97" font-family="Times,serif" font-size="14.00">Bandwidth: 900 Gbps</text>
</g>
<!-- layers_2_to_8&#45;&gt;pipeline_send_recv_1 -->
<g id="edge16" class="edge">
<title>layers_2_to_8&#45;&gt;pipeline_send_recv_1</title>
<path fill="none" stroke="black" d="M2707.91,-544.9C2707.91,-537.07 2707.91,-528.4 2707.91,-519.52"/>
<polygon fill="black" stroke="black" points="2711.41,-519.43 2707.91,-509.43 2704.41,-519.43 2711.41,-519.43"/>
</g>
<!-- layer9_norm1 -->
<g id="node16" class="node">
<title>layer9_norm1</title>
<polygon fill="lightyellow" stroke="black" points="2813.91,-319.17 2601.91,-319.17 2601.91,-236.17 2813.91,-236.17 2813.91,-319.17"/>
<text text-anchor="middle" x="2707.91" y="-303.97" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="2707.91" y="-288.97" font-family="Times,serif" font-size="14.00">Input Layer Norm</text>
<text text-anchor="middle" x="2707.91" y="-273.97" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2707.91" y="-258.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2707.91" y="-243.97" font-family="Times,serif" font-size="14.00">All 8 GPUs</text>
</g>
<!-- pipeline_send_recv_1&#45;&gt;layer9_norm1 -->
<g id="edge17" class="edge">
<title>pipeline_send_recv_1&#45;&gt;layer9_norm1</title>
<path fill="none" stroke="black" d="M2707.91,-373.08C2707.91,-358.58 2707.91,-343.47 2707.91,-329.7"/>
<polygon fill="black" stroke="black" points="2711.41,-329.46 2707.91,-319.46 2704.41,-329.46 2711.41,-329.46"/>
</g>
<!-- layer9_qkv_proj -->
<g id="node17" class="node">
<title>layer9_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="2583.91,-319.17 2371.91,-319.17 2371.91,-236.17 2583.91,-236.17 2583.91,-319.17"/>
<text text-anchor="middle" x="2477.91" y="-303.97" font-family="Times,serif" font-size="14.00">Layer 9 QKV Projection</text>
<text text-anchor="middle" x="2477.91" y="-288.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2477.91" y="-273.97" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2477.91" y="-258.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 1536]</text>
<text text-anchor="middle" x="2477.91" y="-243.97" font-family="Times,serif" font-size="14.00">Per GPU</text>
</g>
<!-- layer9_attn -->
<g id="node18" class="node">
<title>layer9_attn</title>
<polygon fill="lightcoral" stroke="black" points="2353.91,-311.67 2123.91,-311.67 2123.91,-243.67 2353.91,-243.67 2353.91,-311.67"/>
<text text-anchor="middle" x="2238.91" y="-296.47" font-family="Times,serif" font-size="14.00">Layer 9 Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2238.91" y="-281.47" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 32, 128]</text>
<text text-anchor="middle" x="2238.91" y="-266.47" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 32, 128]</text>
<text text-anchor="middle" x="2238.91" y="-251.47" font-family="Times,serif" font-size="14.00">All 8 GPUs</text>
</g>
<!-- layer9_attn_out -->
<g id="node19" class="node">
<title>layer9_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="2106.41,-319.17 1903.41,-319.17 1903.41,-236.17 2106.41,-236.17 2106.41,-319.17"/>
<text text-anchor="middle" x="2004.91" y="-303.97" font-family="Times,serif" font-size="14.00">Layer 9 Attention Output</text>
<text text-anchor="middle" x="2004.91" y="-288.97" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2004.91" y="-273.97" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2004.91" y="-258.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 512]</text>
<text text-anchor="middle" x="2004.91" y="-243.97" font-family="Times,serif" font-size="14.00">Per GPU</text>
</g>
<!-- layer9_attn_allreduce -->
<g id="node20" class="node">
<title>layer9_attn_allreduce</title>
<polygon fill="#eedd82" stroke="black" points="1885.91,-319.17 1673.91,-319.17 1673.91,-236.17 1885.91,-236.17 1885.91,-319.17"/>
<text text-anchor="middle" x="1779.91" y="-303.97" font-family="Times,serif" font-size="14.00">Layer 9 All&#45;Reduce</text>
<text text-anchor="middle" x="1779.91" y="-288.97" font-family="Times,serif" font-size="14.00">Sum Reduction</text>
<text text-anchor="middle" x="1779.91" y="-273.97" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 512]</text>
<text text-anchor="middle" x="1779.91" y="-258.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 4096]</text>
<text text-anchor="middle" x="1779.91" y="-243.97" font-family="Times,serif" font-size="14.00">All 8 GPUs</text>
</g>
<!-- layer9_residual1 -->
<g id="node21" class="node">
<title>layer9_residual1</title>
<polygon fill="lightgreen" stroke="black" points="1655.91,-319.17 1443.91,-319.17 1443.91,-236.17 1655.91,-236.17 1655.91,-319.17"/>
<text text-anchor="middle" x="1549.91" y="-303.97" font-family="Times,serif" font-size="14.00">Layer 9 Residual Add</text>
<text text-anchor="middle" x="1549.91" y="-288.97" font-family="Times,serif" font-size="14.00">Input1: [128, 10000, 4096]</text>
<text text-anchor="middle" x="1549.91" y="-273.97" font-family="Times,serif" font-size="14.00">Input2: [128, 10000, 4096]</text>
<text text-anchor="middle" x="1549.91" y="-258.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 4096]</text>
<text text-anchor="middle" x="1549.91" y="-243.97" font-family="Times,serif" font-size="14.00">All 8 GPUs</text>
</g>
<!-- layer9_norm2 -->
<g id="node22" class="node">
<title>layer9_norm2</title>
<polygon fill="lightyellow" stroke="black" points="1425.91,-311.67 1213.91,-311.67 1213.91,-243.67 1425.91,-243.67 1425.91,-311.67"/>
<text text-anchor="middle" x="1319.91" y="-296.47" font-family="Times,serif" font-size="14.00">Layer 9 MLP Layer Norm</text>
<text text-anchor="middle" x="1319.91" y="-281.47" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="1319.91" y="-266.47" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 4096]</text>
<text text-anchor="middle" x="1319.91" y="-251.47" font-family="Times,serif" font-size="14.00">All 8 GPUs</text>
</g>
<!-- layer9_mlp_gate_up -->
<g id="node23" class="node">
<title>layer9_mlp_gate_up</title>
<polygon fill="lightcyan" stroke="black" points="1195.91,-319.17 983.91,-319.17 983.91,-236.17 1195.91,-236.17 1195.91,-319.17"/>
<text text-anchor="middle" x="1089.91" y="-303.97" font-family="Times,serif" font-size="14.00">Layer 9 MLP Gate+Up</text>
<text text-anchor="middle" x="1089.91" y="-288.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1089.91" y="-273.97" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="1089.91" y="-258.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 4096]</text>
<text text-anchor="middle" x="1089.91" y="-243.97" font-family="Times,serif" font-size="14.00">Per GPU</text>
</g>
<!-- layer9_mlp_activation -->
<g id="node24" class="node">
<title>layer9_mlp_activation</title>
<polygon fill="lightcyan" stroke="black" points="965.91,-311.67 723.91,-311.67 723.91,-243.67 965.91,-243.67 965.91,-311.67"/>
<text text-anchor="middle" x="844.91" y="-296.47" font-family="Times,serif" font-size="14.00">Layer 9 MLP Activation (GELU)</text>
<text text-anchor="middle" x="844.91" y="-281.47" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="844.91" y="-266.47" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 4096]</text>
<text text-anchor="middle" x="844.91" y="-251.47" font-family="Times,serif" font-size="14.00">All 8 GPUs</text>
</g>
<!-- layer9_mlp_down -->
<g id="node25" class="node">
<title>layer9_mlp_down</title>
<polygon fill="lightcyan" stroke="black" points="706.41,-319.17 503.41,-319.17 503.41,-236.17 706.41,-236.17 706.41,-319.17"/>
<text text-anchor="middle" x="604.91" y="-303.97" font-family="Times,serif" font-size="14.00">Layer 9 MLP Down</text>
<text text-anchor="middle" x="604.91" y="-288.97" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="604.91" y="-273.97" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="604.91" y="-258.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 512]</text>
<text text-anchor="middle" x="604.91" y="-243.97" font-family="Times,serif" font-size="14.00">Per GPU</text>
</g>
<!-- layer9_mlp_allreduce -->
<g id="node26" class="node">
<title>layer9_mlp_allreduce</title>
<polygon fill="#eedd82" stroke="black" points="485.91,-319.17 273.91,-319.17 273.91,-236.17 485.91,-236.17 485.91,-319.17"/>
<text text-anchor="middle" x="379.91" y="-303.97" font-family="Times,serif" font-size="14.00">Layer 9 MLP All&#45;Reduce</text>
<text text-anchor="middle" x="379.91" y="-288.97" font-family="Times,serif" font-size="14.00">Sum Reduction</text>
<text text-anchor="middle" x="379.91" y="-273.97" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 512]</text>
<text text-anchor="middle" x="379.91" y="-258.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 4096]</text>
<text text-anchor="middle" x="379.91" y="-243.97" font-family="Times,serif" font-size="14.00">All 8 GPUs</text>
</g>
<!-- layer9_residual2 -->
<g id="node27" class="node">
<title>layer9_residual2</title>
<polygon fill="lightgreen" stroke="black" points="255.91,-319.17 43.91,-319.17 43.91,-236.17 255.91,-236.17 255.91,-319.17"/>
<text text-anchor="middle" x="149.91" y="-303.97" font-family="Times,serif" font-size="14.00">Layer 9 Residual Add</text>
<text text-anchor="middle" x="149.91" y="-288.97" font-family="Times,serif" font-size="14.00">Input1: [128, 10000, 4096]</text>
<text text-anchor="middle" x="149.91" y="-273.97" font-family="Times,serif" font-size="14.00">Input2: [128, 10000, 4096]</text>
<text text-anchor="middle" x="149.91" y="-258.97" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 4096]</text>
<text text-anchor="middle" x="149.91" y="-243.97" font-family="Times,serif" font-size="14.00">All 8 GPUs</text>
</g>
<!-- layers_10_to_16 -->
<g id="node28" class="node">
<title>layers_10_to_16</title>
<polygon fill="lightgray" stroke="black" points="239.41,-200.17 60.41,-200.17 60.41,-132.17 239.41,-132.17 239.41,-200.17"/>
<text text-anchor="middle" x="149.91" y="-184.97" font-family="Times,serif" font-size="14.00">Layers 10&#45;16</text>
<text text-anchor="middle" x="149.91" y="-169.97" font-family="Times,serif" font-size="14.00">[Repeated Structure]</text>
<text text-anchor="middle" x="149.91" y="-154.97" font-family="Times,serif" font-size="14.00">8 layers total</text>
<text text-anchor="middle" x="149.91" y="-139.97" font-family="Times,serif" font-size="14.00">Each: Same as Layer 9</text>
</g>
<!-- layer9_residual2&#45;&gt;layers_10_to_16 -->
<g id="edge18" class="edge">
<title>layer9_residual2&#45;&gt;layers_10_to_16</title>
<path fill="none" stroke="black" d="M149.91,-235.89C149.91,-227.68 149.91,-219.03 149.91,-210.73"/>
<polygon fill="black" stroke="black" points="153.41,-210.47 149.91,-200.47 146.41,-210.47 153.41,-210.47"/>
</g>
<!-- output -->
<g id="node29" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="149.91" cy="-48.08" rx="149.81" ry="48.17"/>
<text text-anchor="middle" x="149.91" y="-66.88" font-family="Times,serif" font-size="14.00">Model Output</text>
<text text-anchor="middle" x="149.91" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="149.91" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [128, 10000, 4096]</text>
<text text-anchor="middle" x="149.91" y="-21.88" font-family="Times,serif" font-size="14.00">All 8 GPUs</text>
</g>
<!-- layers_10_to_16&#45;&gt;output -->
<g id="edge19" class="edge">
<title>layers_10_to_16&#45;&gt;output</title>
<path fill="none" stroke="black" d="M149.91,-131.9C149.91,-123.91 149.91,-115.14 149.91,-106.4"/>
<polygon fill="black" stroke="black" points="153.41,-106.19 149.91,-96.19 146.41,-106.19 153.41,-106.19"/>
</g>
</g>
</svg>
