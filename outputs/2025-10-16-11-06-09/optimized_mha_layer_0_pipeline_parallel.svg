<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: optimized_mha_layer_0_pipeline_parallel Pages: 1 -->
<svg width="2520pt" height="491pt"
 viewBox="0.00 0.00 2520.00 491.35" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.43 0.43) rotate(0) translate(4 1146)">
<title>optimized_mha_layer_0_pipeline_parallel</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1146 5894,-1146 5894,4 -4,4"/>
<!-- mha_input -->
<g id="node1" class="node">
<title>mha_input</title>
<polygon fill="lightgreen" stroke="black" points="5004.95,-1142 4254.19,-1142 4061.05,-1036 4811.81,-1036 5004.95,-1142"/>
<text text-anchor="middle" x="4533" y="-1100.3" font-family="Times,serif" font-size="14.00">MHA Layer 0 Input</text>
<text text-anchor="middle" x="4533" y="-1085.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="4533" y="-1070.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ln -->
<g id="node3" class="node">
<title>ln</title>
<polygon fill="lightyellow" stroke="black" points="3409.5,-1000 2942.5,-1000 2942.5,-932 3409.5,-932 3409.5,-1000"/>
<text text-anchor="middle" x="3176" y="-984.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3176" y="-969.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="3176" y="-954.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="3176" y="-939.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- mha_input&#45;&gt;ln -->
<g id="edge1" class="edge">
<title>mha_input&#45;&gt;ln</title>
<path fill="none" stroke="black" d="M4082.55,-1047.83C3861.38,-1028.11 3603.62,-1005.13 3419.61,-988.72"/>
<polygon fill="black" stroke="black" points="3419.8,-985.23 3409.53,-987.82 3419.18,-992.2 3419.8,-985.23"/>
</g>
<!-- residual -->
<g id="node24" class="node">
<title>residual</title>
<polygon fill="lightgray" stroke="black" points="5261,-210 4785,-210 4785,-142 5261,-142 5261,-210"/>
<text text-anchor="middle" x="5023" y="-194.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5023" y="-179.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]Ã—2</text>
<text text-anchor="middle" x="5023" y="-164.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="5023" y="-149.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- mha_input&#45;&gt;residual -->
<g id="edge34" class="edge">
<title>mha_input&#45;&gt;residual</title>
<path fill="none" stroke="black" d="M4883.1,-1074.92C5226.06,-1055.66 5718.7,-1008.76 5871,-896 5886.98,-884.17 5890,-875.38 5890,-855.5 5890,-855.5 5890,-855.5 5890,-417 5890,-287.73 5527.48,-225.29 5271.27,-197.3"/>
<polygon fill="black" stroke="black" points="5271.38,-193.79 5261.06,-196.2 5270.62,-200.75 5271.38,-193.79"/>
</g>
<!-- mha_output -->
<g id="node2" class="node">
<title>mha_output</title>
<polygon fill="lightgreen" stroke="black" points="5507.33,-106 4736.87,-106 4538.67,0 5309.13,0 5507.33,-106"/>
<text text-anchor="middle" x="5023" y="-64.3" font-family="Times,serif" font-size="14.00">MHA Layer 0 Output</text>
<text text-anchor="middle" x="5023" y="-49.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="5023" y="-34.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- q_hg0_g0 -->
<g id="node4" class="node">
<title>q_hg0_g0</title>
<polygon fill="lightcoral" stroke="black" points="472,-896 0,-896 0,-813 472,-813 472,-896"/>
<text text-anchor="middle" x="236" y="-880.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="236" y="-865.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="236" y="-850.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="236" y="-835.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="236" y="-820.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;1</text>
</g>
<!-- ln&#45;&gt;q_hg0_g0 -->
<g id="edge2" class="edge">
<title>ln&#45;&gt;q_hg0_g0</title>
<path fill="none" stroke="black" d="M2942.27,-963.17C2382.28,-958.11 974.51,-941.27 482.29,-896.07"/>
<polygon fill="black" stroke="black" points="482.54,-892.58 472.26,-895.13 481.89,-899.55 482.54,-892.58"/>
</g>
<!-- k_hg0_g0 -->
<g id="node5" class="node">
<title>k_hg0_g0</title>
<polygon fill="lightcoral" stroke="black" points="962,-896 490,-896 490,-813 962,-813 962,-896"/>
<text text-anchor="middle" x="726" y="-880.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="726" y="-865.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="726" y="-850.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="726" y="-835.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="726" y="-820.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;1</text>
</g>
<!-- ln&#45;&gt;k_hg0_g0 -->
<g id="edge3" class="edge">
<title>ln&#45;&gt;k_hg0_g0</title>
<path fill="none" stroke="black" d="M2942.16,-961.61C2459.58,-953.97 1366.3,-933.2 972.29,-896.07"/>
<polygon fill="black" stroke="black" points="972.55,-892.58 962.26,-895.11 971.88,-899.55 972.55,-892.58"/>
</g>
<!-- v_hg0_g0 -->
<g id="node6" class="node">
<title>v_hg0_g0</title>
<polygon fill="lightcoral" stroke="black" points="1452,-896 980,-896 980,-813 1452,-813 1452,-896"/>
<text text-anchor="middle" x="1216" y="-880.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="1216" y="-865.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="1216" y="-850.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1216" y="-835.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="1216" y="-820.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;1</text>
</g>
<!-- ln&#45;&gt;v_hg0_g0 -->
<g id="edge4" class="edge">
<title>ln&#45;&gt;v_hg0_g0</title>
<path fill="none" stroke="black" d="M2942.34,-964.73C2613.77,-962.29 1996.55,-950.17 1462.49,-896.12"/>
<polygon fill="black" stroke="black" points="1462.57,-892.61 1452.27,-895.07 1461.86,-899.57 1462.57,-892.61"/>
</g>
<!-- q_hg1_g0 -->
<g id="node8" class="node">
<title>q_hg1_g0</title>
<polygon fill="lightcoral" stroke="black" points="1942,-896 1470,-896 1470,-813 1942,-813 1942,-896"/>
<text text-anchor="middle" x="1706" y="-880.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="1706" y="-865.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="1706" y="-850.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1706" y="-835.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="1706" y="-820.8" font-family="Times,serif" font-size="14.00">GPU: 2&#45;3</text>
</g>
<!-- ln&#45;&gt;q_hg1_g0 -->
<g id="edge5" class="edge">
<title>ln&#45;&gt;q_hg1_g0</title>
<path fill="none" stroke="black" d="M2942.25,-959.31C2697.64,-951.62 2302.4,-934.32 1952.35,-896.12"/>
<polygon fill="black" stroke="black" points="1952.59,-892.62 1942.27,-895.01 1951.83,-899.58 1952.59,-892.62"/>
</g>
<!-- k_hg1_g0 -->
<g id="node9" class="node">
<title>k_hg1_g0</title>
<polygon fill="lightcoral" stroke="black" points="2432,-896 1960,-896 1960,-813 2432,-813 2432,-896"/>
<text text-anchor="middle" x="2196" y="-880.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="2196" y="-865.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="2196" y="-850.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="2196" y="-835.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="2196" y="-820.8" font-family="Times,serif" font-size="14.00">GPU: 2&#45;3</text>
</g>
<!-- ln&#45;&gt;k_hg1_g0 -->
<g id="edge6" class="edge">
<title>ln&#45;&gt;k_hg1_g0</title>
<path fill="none" stroke="black" d="M2942.17,-947.26C2800.26,-935.48 2615.34,-918.3 2442.35,-896.15"/>
<polygon fill="black" stroke="black" points="2442.66,-892.66 2432.29,-894.85 2441.76,-899.6 2442.66,-892.66"/>
</g>
<!-- v_hg1_g0 -->
<g id="node10" class="node">
<title>v_hg1_g0</title>
<polygon fill="lightcoral" stroke="black" points="2922,-896 2450,-896 2450,-813 2922,-813 2922,-896"/>
<text text-anchor="middle" x="2686" y="-880.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="2686" y="-865.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="2686" y="-850.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="2686" y="-835.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="2686" y="-820.8" font-family="Times,serif" font-size="14.00">GPU: 2&#45;3</text>
</g>
<!-- ln&#45;&gt;v_hg1_g0 -->
<g id="edge7" class="edge">
<title>ln&#45;&gt;v_hg1_g0</title>
<path fill="none" stroke="black" d="M3028.32,-932C2980.9,-921.4 2927.67,-909.51 2877.58,-898.31"/>
<polygon fill="black" stroke="black" points="2878.12,-894.85 2867.6,-896.08 2876.6,-901.68 2878.12,-894.85"/>
</g>
<!-- q_hg2_g1 -->
<g id="node12" class="node">
<title>q_hg2_g1</title>
<polygon fill="lightcoral" stroke="black" points="3412,-896 2940,-896 2940,-813 3412,-813 3412,-896"/>
<text text-anchor="middle" x="3176" y="-880.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="3176" y="-865.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="3176" y="-850.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="3176" y="-835.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="3176" y="-820.8" font-family="Times,serif" font-size="14.00">GPU: 4&#45;5</text>
</g>
<!-- ln&#45;&gt;q_hg2_g1 -->
<g id="edge8" class="edge">
<title>ln&#45;&gt;q_hg2_g1</title>
<path fill="none" stroke="black" d="M3176,-931.85C3176,-923.8 3176,-915 3176,-906.34"/>
<polygon fill="black" stroke="black" points="3179.5,-906.28 3176,-896.28 3172.5,-906.28 3179.5,-906.28"/>
</g>
<!-- k_hg2_g1 -->
<g id="node13" class="node">
<title>k_hg2_g1</title>
<polygon fill="lightcoral" stroke="black" points="3902,-896 3430,-896 3430,-813 3902,-813 3902,-896"/>
<text text-anchor="middle" x="3666" y="-880.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="3666" y="-865.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="3666" y="-850.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="3666" y="-835.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="3666" y="-820.8" font-family="Times,serif" font-size="14.00">GPU: 4&#45;5</text>
</g>
<!-- ln&#45;&gt;k_hg2_g1 -->
<g id="edge9" class="edge">
<title>ln&#45;&gt;k_hg2_g1</title>
<path fill="none" stroke="black" d="M3323.68,-932C3371.1,-921.4 3424.33,-909.51 3474.42,-898.31"/>
<polygon fill="black" stroke="black" points="3475.4,-901.68 3484.4,-896.08 3473.88,-894.85 3475.4,-901.68"/>
</g>
<!-- v_hg2_g1 -->
<g id="node14" class="node">
<title>v_hg2_g1</title>
<polygon fill="lightcoral" stroke="black" points="4392,-896 3920,-896 3920,-813 4392,-813 4392,-896"/>
<text text-anchor="middle" x="4156" y="-880.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="4156" y="-865.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="4156" y="-850.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="4156" y="-835.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="4156" y="-820.8" font-family="Times,serif" font-size="14.00">GPU: 4&#45;5</text>
</g>
<!-- ln&#45;&gt;v_hg2_g1 -->
<g id="edge10" class="edge">
<title>ln&#45;&gt;v_hg2_g1</title>
<path fill="none" stroke="black" d="M3409.83,-947.26C3551.74,-935.48 3736.66,-918.3 3909.65,-896.15"/>
<polygon fill="black" stroke="black" points="3910.24,-899.6 3919.71,-894.85 3909.34,-892.66 3910.24,-899.6"/>
</g>
<!-- q_hg3_g1 -->
<g id="node16" class="node">
<title>q_hg3_g1</title>
<polygon fill="lightcoral" stroke="black" points="4882,-896 4410,-896 4410,-813 4882,-813 4882,-896"/>
<text text-anchor="middle" x="4646" y="-880.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="4646" y="-865.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="4646" y="-850.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="4646" y="-835.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="4646" y="-820.8" font-family="Times,serif" font-size="14.00">GPU: 6&#45;7</text>
</g>
<!-- ln&#45;&gt;q_hg3_g1 -->
<g id="edge11" class="edge">
<title>ln&#45;&gt;q_hg3_g1</title>
<path fill="none" stroke="black" d="M3409.75,-959.31C3654.36,-951.62 4049.6,-934.32 4399.65,-896.12"/>
<polygon fill="black" stroke="black" points="4400.17,-899.58 4409.73,-895.01 4399.41,-892.62 4400.17,-899.58"/>
</g>
<!-- k_hg3_g1 -->
<g id="node17" class="node">
<title>k_hg3_g1</title>
<polygon fill="lightcoral" stroke="black" points="5372,-896 4900,-896 4900,-813 5372,-813 5372,-896"/>
<text text-anchor="middle" x="5136" y="-880.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="5136" y="-865.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="5136" y="-850.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="5136" y="-835.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="5136" y="-820.8" font-family="Times,serif" font-size="14.00">GPU: 6&#45;7</text>
</g>
<!-- ln&#45;&gt;k_hg3_g1 -->
<g id="edge12" class="edge">
<title>ln&#45;&gt;k_hg3_g1</title>
<path fill="none" stroke="black" d="M3409.66,-964.73C3738.23,-962.29 4355.45,-950.17 4889.51,-896.12"/>
<polygon fill="black" stroke="black" points="4890.14,-899.57 4899.73,-895.07 4889.43,-892.61 4890.14,-899.57"/>
</g>
<!-- v_hg3_g1 -->
<g id="node18" class="node">
<title>v_hg3_g1</title>
<polygon fill="lightcoral" stroke="black" points="5862,-896 5390,-896 5390,-813 5862,-813 5862,-896"/>
<text text-anchor="middle" x="5626" y="-880.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="5626" y="-865.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="5626" y="-850.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="5626" y="-835.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="5626" y="-820.8" font-family="Times,serif" font-size="14.00">GPU: 6&#45;7</text>
</g>
<!-- ln&#45;&gt;v_hg3_g1 -->
<g id="edge13" class="edge">
<title>ln&#45;&gt;v_hg3_g1</title>
<path fill="none" stroke="black" d="M3409.84,-961.61C3892.42,-953.97 4985.7,-933.2 5379.71,-896.07"/>
<polygon fill="black" stroke="black" points="5380.12,-899.55 5389.74,-895.11 5379.45,-892.58 5380.12,-899.55"/>
</g>
<!-- attn_hg0_g0 -->
<g id="node7" class="node">
<title>attn_hg0_g0</title>
<polygon fill="lightpink" stroke="black" points="1207,-777 735,-777 735,-694 1207,-694 1207,-777"/>
<text text-anchor="middle" x="971" y="-761.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="971" y="-746.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="971" y="-731.8" font-family="Times,serif" font-size="14.00">Input: Q,K,V [8Ã—128]</text>
<text text-anchor="middle" x="971" y="-716.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="971" y="-701.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;1</text>
</g>
<!-- q_hg0_g0&#45;&gt;attn_hg0_g0 -->
<g id="edge14" class="edge">
<title>q_hg0_g0&#45;&gt;attn_hg0_g0</title>
<path fill="none" stroke="black" d="M472,-814.45C475.02,-813.96 478.02,-813.48 481,-813 560.28,-800.26 646.83,-786.65 724.83,-774.49"/>
<polygon fill="black" stroke="black" points="725.44,-777.94 734.78,-772.94 724.37,-771.02 725.44,-777.94"/>
</g>
<!-- k_hg0_g0&#45;&gt;attn_hg0_g0 -->
<g id="edge15" class="edge">
<title>k_hg0_g0&#45;&gt;attn_hg0_g0</title>
<path fill="none" stroke="black" d="M811,-812.91C832.29,-802.74 855.24,-791.78 876.94,-781.42"/>
<polygon fill="black" stroke="black" points="878.63,-784.49 886.15,-777.02 875.62,-778.17 878.63,-784.49"/>
</g>
<!-- v_hg0_g0&#45;&gt;attn_hg0_g0 -->
<g id="edge16" class="edge">
<title>v_hg0_g0&#45;&gt;attn_hg0_g0</title>
<path fill="none" stroke="black" d="M1131,-812.91C1109.71,-802.74 1086.76,-791.78 1065.06,-781.42"/>
<polygon fill="black" stroke="black" points="1066.38,-778.17 1055.85,-777.02 1063.37,-784.49 1066.38,-778.17"/>
</g>
<!-- concat_g0 -->
<g id="node20" class="node">
<title>concat_g0</title>
<polygon fill="lightsteelblue" stroke="black" points="2694.86,-658 1901.29,-658 1697.14,-522 2490.71,-522 2694.86,-658"/>
<text text-anchor="middle" x="2196" y="-608.8" font-family="Times,serif" font-size="14.00">Concatenate Group 0</text>
<text text-anchor="middle" x="2196" y="-593.8" font-family="Times,serif" font-size="14.00">Input: 2Ã—[batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="2196" y="-578.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_v=128]</text>
<text text-anchor="middle" x="2196" y="-563.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- attn_hg0_g0&#45;&gt;concat_g0 -->
<g id="edge26" class="edge">
<title>attn_hg0_g0&#45;&gt;concat_g0</title>
<path fill="none" stroke="black" d="M1207.19,-706.83C1389.49,-685.48 1644.41,-655.62 1849.75,-631.56"/>
<polygon fill="black" stroke="black" points="1850.27,-635.02 1859.8,-630.38 1849.46,-628.07 1850.27,-635.02"/>
</g>
<!-- attn_hg1_g0 -->
<g id="node11" class="node">
<title>attn_hg1_g0</title>
<polygon fill="lightpink" stroke="black" points="2432,-777 1960,-777 1960,-694 2432,-694 2432,-777"/>
<text text-anchor="middle" x="2196" y="-761.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="2196" y="-746.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="2196" y="-731.8" font-family="Times,serif" font-size="14.00">Input: Q,K,V [8Ã—128]</text>
<text text-anchor="middle" x="2196" y="-716.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="2196" y="-701.8" font-family="Times,serif" font-size="14.00">GPU: 2&#45;3</text>
</g>
<!-- q_hg1_g0&#45;&gt;attn_hg1_g0 -->
<g id="edge17" class="edge">
<title>q_hg1_g0&#45;&gt;attn_hg1_g0</title>
<path fill="none" stroke="black" d="M1875.66,-812.99C1921.1,-802.14 1970.36,-790.38 2016.32,-779.4"/>
<polygon fill="black" stroke="black" points="2017.16,-782.8 2026.07,-777.07 2015.53,-775.99 2017.16,-782.8"/>
</g>
<!-- k_hg1_g0&#45;&gt;attn_hg1_g0 -->
<g id="edge18" class="edge">
<title>k_hg1_g0&#45;&gt;attn_hg1_g0</title>
<path fill="none" stroke="black" d="M2196,-812.91C2196,-804.65 2196,-795.86 2196,-787.3"/>
<polygon fill="black" stroke="black" points="2199.5,-787.02 2196,-777.02 2192.5,-787.02 2199.5,-787.02"/>
</g>
<!-- v_hg1_g0&#45;&gt;attn_hg1_g0 -->
<g id="edge19" class="edge">
<title>v_hg1_g0&#45;&gt;attn_hg1_g0</title>
<path fill="none" stroke="black" d="M2516.34,-812.99C2470.9,-802.14 2421.64,-790.38 2375.68,-779.4"/>
<polygon fill="black" stroke="black" points="2376.47,-775.99 2365.93,-777.07 2374.84,-782.8 2376.47,-775.99"/>
</g>
<!-- attn_hg1_g0&#45;&gt;concat_g0 -->
<g id="edge27" class="edge">
<title>attn_hg1_g0&#45;&gt;concat_g0</title>
<path fill="none" stroke="black" d="M2196,-693.76C2196,-685.78 2196,-677.17 2196,-668.44"/>
<polygon fill="black" stroke="black" points="2199.5,-668.17 2196,-658.17 2192.5,-668.17 2199.5,-668.17"/>
</g>
<!-- attn_hg2_g1 -->
<g id="node15" class="node">
<title>attn_hg2_g1</title>
<polygon fill="lightpink" stroke="black" points="4269,-777 3797,-777 3797,-694 4269,-694 4269,-777"/>
<text text-anchor="middle" x="4033" y="-761.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4033" y="-746.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="4033" y="-731.8" font-family="Times,serif" font-size="14.00">Input: Q,K,V [8Ã—128]</text>
<text text-anchor="middle" x="4033" y="-716.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="4033" y="-701.8" font-family="Times,serif" font-size="14.00">GPU: 4&#45;5</text>
</g>
<!-- q_hg2_g1&#45;&gt;attn_hg2_g1 -->
<g id="edge20" class="edge">
<title>q_hg2_g1&#45;&gt;attn_hg2_g1</title>
<path fill="none" stroke="black" d="M3412.31,-814.27C3415.22,-813.84 3418.12,-813.42 3421,-813 3541.22,-795.56 3675.08,-778.55 3786.88,-765.02"/>
<polygon fill="black" stroke="black" points="3787.43,-768.48 3796.94,-763.8 3786.59,-761.53 3787.43,-768.48"/>
</g>
<!-- k_hg2_g1&#45;&gt;attn_hg2_g1 -->
<g id="edge21" class="edge">
<title>k_hg2_g1&#45;&gt;attn_hg2_g1</title>
<path fill="none" stroke="black" d="M3793.07,-812.99C3826.25,-802.41 3862.15,-790.97 3895.82,-780.23"/>
<polygon fill="black" stroke="black" points="3897.26,-783.45 3905.73,-777.07 3895.14,-776.78 3897.26,-783.45"/>
</g>
<!-- v_hg2_g1&#45;&gt;attn_hg2_g1 -->
<g id="edge22" class="edge">
<title>v_hg2_g1&#45;&gt;attn_hg2_g1</title>
<path fill="none" stroke="black" d="M4113.33,-812.91C4103.5,-803.56 4092.96,-793.54 4082.86,-783.93"/>
<polygon fill="black" stroke="black" points="4085.26,-781.38 4075.6,-777.02 4080.43,-786.45 4085.26,-781.38"/>
</g>
<!-- concat_g1 -->
<g id="node21" class="node">
<title>concat_g1</title>
<polygon fill="lightsteelblue" stroke="black" points="4776.86,-658 3983.29,-658 3779.14,-522 4572.71,-522 4776.86,-658"/>
<text text-anchor="middle" x="4278" y="-608.8" font-family="Times,serif" font-size="14.00">Concatenate Group 1</text>
<text text-anchor="middle" x="4278" y="-593.8" font-family="Times,serif" font-size="14.00">Input: 2Ã—[batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="4278" y="-578.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_v=128]</text>
<text text-anchor="middle" x="4278" y="-563.8" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- attn_hg2_g1&#45;&gt;concat_g1 -->
<g id="edge28" class="edge">
<title>attn_hg2_g1&#45;&gt;concat_g1</title>
<path fill="none" stroke="black" d="M4102.22,-693.95C4118.64,-684.34 4136.64,-673.79 4154.67,-663.24"/>
<polygon fill="black" stroke="black" points="4156.65,-666.13 4163.51,-658.06 4153.12,-660.09 4156.65,-666.13"/>
</g>
<!-- attn_hg3_g1 -->
<g id="node19" class="node">
<title>attn_hg3_g1</title>
<polygon fill="lightpink" stroke="black" points="5004,-777 4532,-777 4532,-694 5004,-694 5004,-777"/>
<text text-anchor="middle" x="4768" y="-761.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4768" y="-746.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="4768" y="-731.8" font-family="Times,serif" font-size="14.00">Input: Q,K,V [8Ã—128]</text>
<text text-anchor="middle" x="4768" y="-716.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="4768" y="-701.8" font-family="Times,serif" font-size="14.00">GPU: 6&#45;7</text>
</g>
<!-- q_hg3_g1&#45;&gt;attn_hg3_g1 -->
<g id="edge23" class="edge">
<title>q_hg3_g1&#45;&gt;attn_hg3_g1</title>
<path fill="none" stroke="black" d="M4688.33,-812.91C4697.98,-803.65 4708.32,-793.73 4718.25,-784.21"/>
<polygon fill="black" stroke="black" points="4720.95,-786.47 4725.75,-777.02 4716.11,-781.42 4720.95,-786.47"/>
</g>
<!-- k_hg3_g1&#45;&gt;attn_hg3_g1 -->
<g id="edge24" class="edge">
<title>k_hg3_g1&#45;&gt;attn_hg3_g1</title>
<path fill="none" stroke="black" d="M5008.58,-812.99C4975.32,-802.41 4939.32,-790.97 4905.55,-780.23"/>
<polygon fill="black" stroke="black" points="4906.21,-776.77 4895.62,-777.07 4904.09,-783.44 4906.21,-776.77"/>
</g>
<!-- v_hg3_g1&#45;&gt;attn_hg3_g1 -->
<g id="edge25" class="edge">
<title>v_hg3_g1&#45;&gt;attn_hg3_g1</title>
<path fill="none" stroke="black" d="M5389.69,-814.27C5386.78,-813.84 5383.88,-813.42 5381,-813 5260.46,-795.52 5126.22,-778.5 5014.16,-764.96"/>
<polygon fill="black" stroke="black" points="5014.43,-761.47 5004.08,-763.74 5013.59,-768.42 5014.43,-761.47"/>
</g>
<!-- attn_hg3_g1&#45;&gt;concat_g1 -->
<g id="edge29" class="edge">
<title>attn_hg3_g1&#45;&gt;concat_g1</title>
<path fill="none" stroke="black" d="M4629.55,-693.95C4594.33,-683.64 4555.46,-672.26 4516.8,-660.93"/>
<polygon fill="black" stroke="black" points="4517.55,-657.51 4506.97,-658.06 4515.59,-664.23 4517.55,-657.51"/>
</g>
<!-- final_concat -->
<g id="node22" class="node">
<title>final_concat</title>
<polygon fill="lightsteelblue" stroke="black" points="4786.02,-486 3977.88,-486 3769.98,-350 4578.12,-350 4786.02,-486"/>
<text text-anchor="middle" x="4278" y="-436.8" font-family="Times,serif" font-size="14.00">Final Concatenate</text>
<text text-anchor="middle" x="4278" y="-421.8" font-family="Times,serif" font-size="14.00">Input: 2Ã—[batch_size=1024, seq_len=10000, heads=16, d_v=128]</text>
<text text-anchor="middle" x="4278" y="-406.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="4278" y="-391.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- concat_g0&#45;&gt;final_concat -->
<g id="edge30" class="edge">
<title>concat_g0&#45;&gt;final_concat</title>
<path fill="none" stroke="black" d="M2548.3,-560.23C2926.63,-529.34 3525.07,-480.48 3909.54,-449.09"/>
<polygon fill="black" stroke="black" points="3910.03,-452.56 3919.71,-448.26 3909.46,-445.58 3910.03,-452.56"/>
</g>
<!-- concat_g1&#45;&gt;final_concat -->
<g id="edge31" class="edge">
<title>concat_g1&#45;&gt;final_concat</title>
<path fill="none" stroke="black" d="M4278,-521.81C4278,-513.5 4278,-504.95 4278,-496.49"/>
<polygon fill="black" stroke="black" points="4281.5,-496.26 4278,-486.26 4274.5,-496.26 4281.5,-496.26"/>
</g>
<!-- output_proj -->
<g id="node23" class="node">
<title>output_proj</title>
<polygon fill="lightcoral" stroke="black" points="5125.5,-314 4658.5,-314 4658.5,-246 5125.5,-246 5125.5,-314"/>
<text text-anchor="middle" x="4892" y="-298.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4892" y="-283.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="4892" y="-268.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="4892" y="-253.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- final_concat&#45;&gt;output_proj -->
<g id="edge32" class="edge">
<title>final_concat&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M4579.15,-350.29C4632.29,-338.52 4685.66,-326.7 4732.9,-316.24"/>
<polygon fill="black" stroke="black" points="4733.88,-319.61 4742.88,-314.03 4732.36,-312.77 4733.88,-319.61"/>
</g>
<!-- output_proj&#45;&gt;residual -->
<g id="edge33" class="edge">
<title>output_proj&#45;&gt;residual</title>
<path fill="none" stroke="black" d="M4934.53,-245.88C4946.54,-236.53 4959.74,-226.26 4972.18,-216.57"/>
<polygon fill="black" stroke="black" points="4974.49,-219.2 4980.23,-210.3 4970.19,-213.68 4974.49,-219.2"/>
</g>
<!-- residual&#45;&gt;mha_output -->
<g id="edge35" class="edge">
<title>residual&#45;&gt;mha_output</title>
<path fill="none" stroke="black" d="M5023,-141.94C5023,-133.9 5023,-125.05 5023,-116.15"/>
<polygon fill="black" stroke="black" points="5026.5,-116.13 5023,-106.13 5019.5,-116.13 5026.5,-116.13"/>
</g>
</g>
</svg>
