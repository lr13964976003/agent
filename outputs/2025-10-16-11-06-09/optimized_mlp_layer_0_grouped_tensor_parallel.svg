<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: optimized_mlp_layer_0_grouped_tensor_parallel Pages: 1 -->
<svg width="2217pt" height="1450pt"
 viewBox="0.00 0.00 2217.33 1450.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1446)">
<title>optimized_mlp_layer_0_grouped_tensor_parallel</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1446 2213.33,-1446 2213.33,4 -4,4"/>
<!-- mlp_input -->
<g id="node1" class="node">
<title>mlp_input</title>
<polygon fill="lightgreen" stroke="black" points="2191.11,-1442 1440.35,-1442 1247.22,-1336 1997.98,-1336 2191.11,-1442"/>
<text text-anchor="middle" x="1719.16" y="-1400.3" font-family="Times,serif" font-size="14.00">MLP Layer 0 Input</text>
<text text-anchor="middle" x="1719.16" y="-1385.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1719.16" y="-1370.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ln -->
<g id="node3" class="node">
<title>ln</title>
<polygon fill="lightyellow" stroke="black" points="1821.66,-1300 1354.66,-1300 1354.66,-1232 1821.66,-1232 1821.66,-1300"/>
<text text-anchor="middle" x="1588.16" y="-1284.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1588.16" y="-1269.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1588.16" y="-1254.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1588.16" y="-1239.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- mlp_input&#45;&gt;ln -->
<g id="edge1" class="edge">
<title>mlp_input&#45;&gt;ln</title>
<path fill="none" stroke="black" d="M1662.85,-1335.98C1652.35,-1326.28 1641.53,-1316.29 1631.49,-1307.02"/>
<polygon fill="black" stroke="black" points="1633.71,-1304.31 1623.99,-1300.09 1628.96,-1309.45 1633.71,-1304.31"/>
</g>
<!-- residual -->
<g id="node14" class="node">
<title>residual</title>
<polygon fill="lightgray" stroke="black" points="1963.16,-210 1487.16,-210 1487.16,-142 1963.16,-142 1963.16,-210"/>
<text text-anchor="middle" x="1725.16" y="-194.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1725.16" y="-179.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]×2</text>
<text text-anchor="middle" x="1725.16" y="-164.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1725.16" y="-149.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- mlp_input&#45;&gt;residual -->
<g id="edge14" class="edge">
<title>mlp_input&#45;&gt;residual</title>
<path fill="none" stroke="black" d="M1828.15,-1335.83C1901.98,-1292.08 1986.16,-1221.83 1986.16,-1129 1986.16,-1129 1986.16,-1129 1986.16,-500 1986.16,-386.8 2038.68,-333.75 1967.16,-246 1956.95,-233.47 1932.43,-222.42 1902.72,-213.04"/>
<polygon fill="black" stroke="black" points="1903.48,-209.62 1892.9,-210.05 1901.45,-216.31 1903.48,-209.62"/>
</g>
<!-- mlp_output -->
<g id="node2" class="node">
<title>mlp_output</title>
<polygon fill="lightgreen" stroke="black" points="2209.49,-106 1439.03,-106 1240.84,0 2011.29,0 2209.49,-106"/>
<text text-anchor="middle" x="1725.16" y="-64.3" font-family="Times,serif" font-size="14.00">MLP Layer 0 Output</text>
<text text-anchor="middle" x="1725.16" y="-49.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1725.16" y="-34.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- input_split -->
<g id="node4" class="node">
<title>input_split</title>
<polygon fill="lightsteelblue" stroke="black" points="1958.03,-1196 1153.31,-1196 946.29,-1060 1751.02,-1060 1958.03,-1196"/>
<text text-anchor="middle" x="1452.16" y="-1146.8" font-family="Times,serif" font-size="14.00">Split Input</text>
<text text-anchor="middle" x="1452.16" y="-1131.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1452.16" y="-1116.8" font-family="Times,serif" font-size="14.00">Output: 2×[batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1452.16" y="-1101.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ln&#45;&gt;input_split -->
<g id="edge2" class="edge">
<title>ln&#45;&gt;input_split</title>
<path fill="none" stroke="black" d="M1554.89,-1231.73C1546.23,-1223.06 1536.53,-1213.36 1526.64,-1203.48"/>
<polygon fill="black" stroke="black" points="1528.97,-1200.86 1519.43,-1196.26 1524.02,-1205.81 1528.97,-1200.86"/>
</g>
<!-- fc1_tg0 -->
<g id="node5" class="node">
<title>fc1_tg0</title>
<polygon fill="lightcoral" stroke="black" points="1207.66,-1024 740.66,-1024 740.66,-941 1207.66,-941 1207.66,-1024"/>
<text text-anchor="middle" x="974.16" y="-1008.8" font-family="Times,serif" font-size="14.00">FC1 Linear (Grouped Column Parallel)</text>
<text text-anchor="middle" x="974.16" y="-993.8" font-family="Times,serif" font-size="14.00">Tensor Group 0</text>
<text text-anchor="middle" x="974.16" y="-978.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="974.16" y="-963.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=8192]</text>
<text text-anchor="middle" x="974.16" y="-948.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- input_split&#45;&gt;fc1_tg0 -->
<g id="edge3" class="edge">
<title>input_split&#45;&gt;fc1_tg0</title>
<path fill="none" stroke="black" d="M1228.91,-1059.98C1191.56,-1048.77 1153.71,-1037.4 1119,-1026.98"/>
<polygon fill="black" stroke="black" points="1119.88,-1023.59 1109.3,-1024.07 1117.87,-1030.3 1119.88,-1023.59"/>
</g>
<!-- fc1_tg1 -->
<g id="node9" class="node">
<title>fc1_tg1</title>
<polygon fill="lightcoral" stroke="black" points="1692.66,-1024 1225.66,-1024 1225.66,-941 1692.66,-941 1692.66,-1024"/>
<text text-anchor="middle" x="1459.16" y="-1008.8" font-family="Times,serif" font-size="14.00">FC1 Linear (Grouped Column Parallel)</text>
<text text-anchor="middle" x="1459.16" y="-993.8" font-family="Times,serif" font-size="14.00">Tensor Group 1</text>
<text text-anchor="middle" x="1459.16" y="-978.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1459.16" y="-963.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=8192]</text>
<text text-anchor="middle" x="1459.16" y="-948.8" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- input_split&#45;&gt;fc1_tg1 -->
<g id="edge4" class="edge">
<title>input_split&#45;&gt;fc1_tg1</title>
<path fill="none" stroke="black" d="M1455.44,-1059.87C1455.86,-1051.26 1456.28,-1042.55 1456.69,-1034.25"/>
<polygon fill="black" stroke="black" points="1460.2,-1034.16 1457.19,-1024 1453.2,-1033.82 1460.2,-1034.16"/>
</g>
<!-- gelu_tg0 -->
<g id="node6" class="node">
<title>gelu_tg0</title>
<polygon fill="lightyellow" stroke="black" points="962.66,-905 495.66,-905 495.66,-822 962.66,-822 962.66,-905"/>
<text text-anchor="middle" x="729.16" y="-889.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="729.16" y="-874.8" font-family="Times,serif" font-size="14.00">Tensor Group 0</text>
<text text-anchor="middle" x="729.16" y="-859.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=8192]</text>
<text text-anchor="middle" x="729.16" y="-844.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=8192]</text>
<text text-anchor="middle" x="729.16" y="-829.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- fc1_tg0&#45;&gt;gelu_tg0 -->
<g id="edge5" class="edge">
<title>fc1_tg0&#45;&gt;gelu_tg0</title>
<path fill="none" stroke="black" d="M889.16,-940.91C867.88,-930.74 844.92,-919.78 823.23,-909.42"/>
<polygon fill="black" stroke="black" points="824.55,-906.17 814.01,-905.02 821.53,-912.49 824.55,-906.17"/>
</g>
<!-- fc2_split_tg0 -->
<g id="node7" class="node">
<title>fc2_split_tg0</title>
<polygon fill="lightsteelblue" stroke="black" points="968.49,-786 198.03,-786 -0.16,-620 770.29,-620 968.49,-786"/>
<text text-anchor="middle" x="484.16" y="-729.3" font-family="Times,serif" font-size="14.00">FC2 Split (Grouped Row Parallel)</text>
<text text-anchor="middle" x="484.16" y="-714.3" font-family="Times,serif" font-size="14.00">Tensor Group 0</text>
<text text-anchor="middle" x="484.16" y="-699.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=8192]</text>
<text text-anchor="middle" x="484.16" y="-684.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="484.16" y="-669.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- gelu_tg0&#45;&gt;fc2_split_tg0 -->
<g id="edge6" class="edge">
<title>gelu_tg0&#45;&gt;fc2_split_tg0</title>
<path fill="none" stroke="black" d="M666.39,-821.89C651.9,-812.52 635.94,-802.19 619.66,-791.66"/>
<polygon fill="black" stroke="black" points="621.43,-788.63 611.13,-786.14 617.63,-794.51 621.43,-788.63"/>
</g>
<!-- all_reduce_tg0 -->
<g id="node8" class="node">
<title>all_reduce_tg0</title>
<polygon fill="lightsteelblue" stroke="black" points="968.49,-584 198.03,-584 -0.16,-418 770.29,-418 968.49,-584"/>
<text text-anchor="middle" x="484.16" y="-527.3" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="484.16" y="-512.3" font-family="Times,serif" font-size="14.00">Tensor Group 0</text>
<text text-anchor="middle" x="484.16" y="-497.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="484.16" y="-482.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="484.16" y="-467.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- fc2_split_tg0&#45;&gt;all_reduce_tg0 -->
<g id="edge7" class="edge">
<title>fc2_split_tg0&#45;&gt;all_reduce_tg0</title>
<path fill="none" stroke="black" d="M484.16,-619.79C484.16,-611.44 484.16,-602.92 484.16,-594.47"/>
<polygon fill="black" stroke="black" points="487.66,-594.22 484.16,-584.22 480.66,-594.22 487.66,-594.22"/>
</g>
<!-- final_concat -->
<g id="node13" class="node">
<title>final_concat</title>
<polygon fill="lightsteelblue" stroke="black" points="1958.65,-382 1173.62,-382 971.67,-246 1756.71,-246 1958.65,-382"/>
<text text-anchor="middle" x="1465.16" y="-332.8" font-family="Times,serif" font-size="14.00">Final Concatenate</text>
<text text-anchor="middle" x="1465.16" y="-317.8" font-family="Times,serif" font-size="14.00">Input: 2×[batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="1465.16" y="-302.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1465.16" y="-287.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- all_reduce_tg0&#45;&gt;final_concat -->
<g id="edge8" class="edge">
<title>all_reduce_tg0&#45;&gt;final_concat</title>
<path fill="none" stroke="black" d="M797.93,-440.83C910.3,-419.64 1036.95,-395.75 1149.48,-374.53"/>
<polygon fill="black" stroke="black" points="1150.45,-377.91 1159.63,-372.62 1149.16,-371.03 1150.45,-377.91"/>
</g>
<!-- gelu_tg1 -->
<g id="node10" class="node">
<title>gelu_tg1</title>
<polygon fill="lightyellow" stroke="black" points="1692.66,-905 1225.66,-905 1225.66,-822 1692.66,-822 1692.66,-905"/>
<text text-anchor="middle" x="1459.16" y="-889.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="1459.16" y="-874.8" font-family="Times,serif" font-size="14.00">Tensor Group 1</text>
<text text-anchor="middle" x="1459.16" y="-859.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=8192]</text>
<text text-anchor="middle" x="1459.16" y="-844.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=8192]</text>
<text text-anchor="middle" x="1459.16" y="-829.8" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- fc1_tg1&#45;&gt;gelu_tg1 -->
<g id="edge9" class="edge">
<title>fc1_tg1&#45;&gt;gelu_tg1</title>
<path fill="none" stroke="black" d="M1459.16,-940.91C1459.16,-932.65 1459.16,-923.86 1459.16,-915.3"/>
<polygon fill="black" stroke="black" points="1462.66,-915.02 1459.16,-905.02 1455.66,-915.02 1462.66,-915.02"/>
</g>
<!-- fc2_split_tg1 -->
<g id="node11" class="node">
<title>fc2_split_tg1</title>
<polygon fill="lightsteelblue" stroke="black" points="1954.49,-786 1184.03,-786 985.84,-620 1756.29,-620 1954.49,-786"/>
<text text-anchor="middle" x="1470.16" y="-729.3" font-family="Times,serif" font-size="14.00">FC2 Split (Grouped Row Parallel)</text>
<text text-anchor="middle" x="1470.16" y="-714.3" font-family="Times,serif" font-size="14.00">Tensor Group 1</text>
<text text-anchor="middle" x="1470.16" y="-699.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=8192]</text>
<text text-anchor="middle" x="1470.16" y="-684.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="1470.16" y="-669.3" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- gelu_tg1&#45;&gt;fc2_split_tg1 -->
<g id="edge10" class="edge">
<title>gelu_tg1&#45;&gt;fc2_split_tg1</title>
<path fill="none" stroke="black" d="M1462,-821.68C1462.55,-813.75 1463.14,-805.14 1463.76,-796.31"/>
<polygon fill="black" stroke="black" points="1467.25,-796.49 1464.45,-786.27 1460.27,-796.01 1467.25,-796.49"/>
</g>
<!-- all_reduce_tg1 -->
<g id="node12" class="node">
<title>all_reduce_tg1</title>
<polygon fill="lightsteelblue" stroke="black" points="1954.49,-584 1184.03,-584 985.84,-418 1756.29,-418 1954.49,-584"/>
<text text-anchor="middle" x="1470.16" y="-527.3" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1470.16" y="-512.3" font-family="Times,serif" font-size="14.00">Tensor Group 1</text>
<text text-anchor="middle" x="1470.16" y="-497.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="1470.16" y="-482.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="1470.16" y="-467.3" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- fc2_split_tg1&#45;&gt;all_reduce_tg1 -->
<g id="edge11" class="edge">
<title>fc2_split_tg1&#45;&gt;all_reduce_tg1</title>
<path fill="none" stroke="black" d="M1470.16,-619.79C1470.16,-611.44 1470.16,-602.92 1470.16,-594.47"/>
<polygon fill="black" stroke="black" points="1473.66,-594.22 1470.16,-584.22 1466.66,-594.22 1473.66,-594.22"/>
</g>
<!-- all_reduce_tg1&#45;&gt;final_concat -->
<g id="edge12" class="edge">
<title>all_reduce_tg1&#45;&gt;final_concat</title>
<path fill="none" stroke="black" d="M1467.94,-417.78C1467.71,-409.34 1467.48,-400.79 1467.26,-392.4"/>
<polygon fill="black" stroke="black" points="1470.75,-392.18 1466.98,-382.28 1463.75,-392.37 1470.75,-392.18"/>
</g>
<!-- final_concat&#45;&gt;residual -->
<g id="edge13" class="edge">
<title>final_concat&#45;&gt;residual</title>
<path fill="none" stroke="black" d="M1593.26,-246C1613.75,-235.28 1634.3,-224.53 1652.88,-214.81"/>
<polygon fill="black" stroke="black" points="1654.59,-217.86 1661.83,-210.13 1651.35,-211.66 1654.59,-217.86"/>
</g>
<!-- residual&#45;&gt;mlp_output -->
<g id="edge15" class="edge">
<title>residual&#45;&gt;mlp_output</title>
<path fill="none" stroke="black" d="M1725.16,-141.94C1725.16,-133.9 1725.16,-125.05 1725.16,-116.15"/>
<polygon fill="black" stroke="black" points="1728.66,-116.13 1725.16,-106.13 1721.66,-116.13 1728.66,-116.13"/>
</g>
</g>
</svg>
