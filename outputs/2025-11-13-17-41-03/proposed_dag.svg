<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="1997pt" height="2210pt"
 viewBox="0.00 0.00 1997.42 2210.29" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2206.29)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2206.29 1993.42,-2206.29 1993.42,4 -4,4"/>
<text text-anchor="middle" x="994.71" y="-2179.09" font-family="Times,serif" font-size="24.00">Proposed: Ring Attention + Sequence Parallelism (16 devices)</text>
<g id="clust1" class="cluster">
<title>cluster_layer0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-407.17 8,-1913.33 1699,-1913.33 1699,-407.17 8,-407.17"/>
<text text-anchor="middle" x="853.5" y="-1890.13" font-family="Times,serif" font-size="24.00">Layer 0 (All Devices)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_device0</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="234,-415.17 234,-1871.33 1691,-1871.33 1691,-415.17 234,-415.17"/>
<text text-anchor="middle" x="962.5" y="-1848.13" font-family="Times,serif" font-size="24.00">GPU 0 (Seq 0&#45;624)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer1_all</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="651,-296.17 651,-399.17 1158,-399.17 1158,-296.17 651,-296.17"/>
<text text-anchor="middle" x="904.5" y="-375.97" font-family="Times,serif" font-size="24.00">Layer 1&#45;3 (All Devices &#45; Same Structure)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgrey" stroke="black" cx="442" cy="-2130.81" rx="253.7" ry="37.45"/>
<text text-anchor="middle" x="442" y="-2142.11" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="442" y="-2127.11" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="442" y="-2112.11" font-family="Times,serif" font-size="14.00">GPU: Host</text>
</g>
<!-- sequence_split -->
<g id="node2" class="node">
<title>sequence_split</title>
<polygon fill="lightgrey" stroke="black" points="844.02,-2057.33 204.5,-2057.33 39.98,-1921.33 679.5,-1921.33 844.02,-2057.33"/>
<text text-anchor="middle" x="442" y="-2008.13" font-family="Times,serif" font-size="14.00">Sequence Split</text>
<text text-anchor="middle" x="442" y="-1993.13" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="442" y="-1978.13" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=625, hidden=8192] x 16</text>
<text text-anchor="middle" x="442" y="-1963.13" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- input&#45;&gt;sequence_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;sequence_split</title>
<path fill="none" stroke="black" d="M442,-2093.16C442,-2085.19 442,-2076.46 442,-2067.57"/>
<polygon fill="black" stroke="black" points="445.5,-2067.49 442,-2057.49 438.5,-2067.49 445.5,-2067.49"/>
</g>
<!-- emb0 -->
<g id="node3" class="node">
<title>emb0</title>
<polygon fill="lightgrey" stroke="black" points="618.5,-1829.33 265.5,-1829.33 265.5,-1761.33 618.5,-1761.33 618.5,-1829.33"/>
<text text-anchor="middle" x="442" y="-1814.13" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="442" y="-1799.13" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="442" y="-1784.13" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="442" y="-1769.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- sequence_split&#45;&gt;emb0 -->
<g id="edge2" class="edge">
<title>sequence_split&#45;&gt;emb0</title>
<path fill="none" stroke="black" d="M442,-1921.18C442,-1894.15 442,-1863.75 442,-1839.71"/>
<polygon fill="black" stroke="black" points="445.5,-1839.49 442,-1829.49 438.5,-1839.49 445.5,-1839.49"/>
</g>
<!-- ln0_0 -->
<g id="node4" class="node">
<title>ln0_0</title>
<polygon fill="lightgrey" stroke="black" points="913.5,-1725.33 560.5,-1725.33 560.5,-1657.33 913.5,-1657.33 913.5,-1725.33"/>
<text text-anchor="middle" x="737" y="-1710.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="737" y="-1695.13" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="737" y="-1680.13" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="737" y="-1665.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- emb0&#45;&gt;ln0_0 -->
<g id="edge3" class="edge">
<title>emb0&#45;&gt;ln0_0</title>
<path fill="none" stroke="black" d="M537.78,-1761.22C567.76,-1750.85 601.01,-1739.35 631.61,-1728.77"/>
<polygon fill="black" stroke="black" points="633.14,-1731.95 641.45,-1725.37 630.86,-1725.33 633.14,-1731.95"/>
</g>
<!-- residual0_0 -->
<g id="node13" class="node">
<title>residual0_0</title>
<polygon fill="lightgrey" stroke="black" points="1085.11,-1147.17 488.39,-1147.17 334.89,-1011.17 931.61,-1011.17 1085.11,-1147.17"/>
<text text-anchor="middle" x="710" y="-1097.97" font-family="Times,serif" font-size="14.00">Add</text>
<text text-anchor="middle" x="710" y="-1082.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=625, hidden=8192] x2</text>
<text text-anchor="middle" x="710" y="-1067.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="710" y="-1052.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- emb0&#45;&gt;residual0_0 -->
<g id="edge14" class="edge">
<title>emb0&#45;&gt;residual0_0</title>
<path fill="none" stroke="black" d="M376.56,-1761.26C318.56,-1726.77 243,-1666.78 243,-1588.33 243,-1588.33 243,-1588.33 243,-1335.17 243,-1225.32 343.76,-1162.5 451.67,-1126.72"/>
<polygon fill="black" stroke="black" points="453.02,-1129.97 461.46,-1123.56 450.87,-1123.31 453.02,-1129.97"/>
</g>
<!-- q_proj0_0 -->
<g id="node5" class="node">
<title>q_proj0_0</title>
<polygon fill="lightgrey" stroke="black" points="669.5,-1621.33 316.5,-1621.33 316.5,-1553.33 669.5,-1553.33 669.5,-1621.33"/>
<text text-anchor="middle" x="493" y="-1606.13" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="493" y="-1591.13" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="493" y="-1576.13" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="493" y="-1561.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ln0_0&#45;&gt;q_proj0_0 -->
<g id="edge4" class="edge">
<title>ln0_0&#45;&gt;q_proj0_0</title>
<path fill="none" stroke="black" d="M657.78,-1657.22C633.47,-1647.06 606.57,-1635.81 581.67,-1625.4"/>
<polygon fill="black" stroke="black" points="582.82,-1622.09 572.24,-1621.46 580.12,-1628.54 582.82,-1622.09"/>
</g>
<!-- k_proj0_0 -->
<g id="node6" class="node">
<title>k_proj0_0</title>
<polygon fill="lightgrey" stroke="black" points="1158.5,-1621.33 805.5,-1621.33 805.5,-1553.33 1158.5,-1553.33 1158.5,-1621.33"/>
<text text-anchor="middle" x="982" y="-1606.13" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="982" y="-1591.13" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="982" y="-1576.13" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="982" y="-1561.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ln0_0&#45;&gt;k_proj0_0 -->
<g id="edge5" class="edge">
<title>ln0_0&#45;&gt;k_proj0_0</title>
<path fill="none" stroke="black" d="M816.54,-1657.22C840.95,-1647.06 867.96,-1635.81 892.96,-1625.4"/>
<polygon fill="black" stroke="black" points="894.55,-1628.53 902.44,-1621.46 891.86,-1622.07 894.55,-1628.53"/>
</g>
<!-- v_proj0_0 -->
<g id="node7" class="node">
<title>v_proj0_0</title>
<polygon fill="lightgrey" stroke="black" points="1588.5,-1621.33 1235.5,-1621.33 1235.5,-1553.33 1588.5,-1553.33 1588.5,-1621.33"/>
<text text-anchor="middle" x="1412" y="-1606.13" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1412" y="-1591.13" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="1412" y="-1576.13" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="1412" y="-1561.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ln0_0&#45;&gt;v_proj0_0 -->
<g id="edge6" class="edge">
<title>ln0_0&#45;&gt;v_proj0_0</title>
<path fill="none" stroke="black" d="M913.91,-1663.6C1009.73,-1649.12 1128.08,-1631.24 1225.37,-1616.53"/>
<polygon fill="black" stroke="black" points="1225.96,-1619.99 1235.32,-1615.03 1224.91,-1613.06 1225.96,-1619.99"/>
</g>
<!-- ring_attn0_0 -->
<g id="node8" class="node">
<title>ring_attn0_0</title>
<polygon fill="lightgrey" stroke="black" points="665.5,-1503.25 262.5,-1503.25 262.5,-1435.25 665.5,-1435.25 665.5,-1503.25"/>
<text text-anchor="middle" x="464" y="-1488.05" font-family="Times,serif" font-size="14.00">Local Q Computation</text>
<text text-anchor="middle" x="464" y="-1473.05" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="464" y="-1458.05" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=625, heads=16, dim=512]</text>
<text text-anchor="middle" x="464" y="-1443.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- q_proj0_0&#45;&gt;ring_attn0_0 -->
<g id="edge7" class="edge">
<title>q_proj0_0&#45;&gt;ring_attn0_0</title>
<path fill="none" stroke="black" d="M484.69,-1553.07C481.6,-1540.68 478.04,-1526.44 474.76,-1513.3"/>
<polygon fill="black" stroke="black" points="478.13,-1512.37 472.31,-1503.52 471.34,-1514.07 478.13,-1512.37"/>
</g>
<!-- kv_send0_0 -->
<g id="node9" class="node">
<title>kv_send0_0</title>
<ellipse fill="lightgrey" stroke="black" cx="1442" cy="-1469.25" rx="241.25" ry="48.17"/>
<text text-anchor="middle" x="1442" y="-1488.05" font-family="Times,serif" font-size="14.00">Send KV</text>
<text text-anchor="middle" x="1442" y="-1473.05" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="1442" y="-1458.05" font-family="Times,serif" font-size="14.00">Output: → GPU 1</text>
<text text-anchor="middle" x="1442" y="-1443.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- k_proj0_0&#45;&gt;kv_send0_0 -->
<g id="edge8" class="edge">
<title>k_proj0_0&#45;&gt;kv_send0_0</title>
<path fill="none" stroke="black" d="M1112.89,-1553.3C1166.39,-1539.8 1228.72,-1524.07 1284.66,-1509.95"/>
<polygon fill="black" stroke="black" points="1285.83,-1513.27 1294.67,-1507.43 1284.11,-1506.48 1285.83,-1513.27"/>
</g>
<!-- v_proj0_0&#45;&gt;kv_send0_0 -->
<g id="edge9" class="edge">
<title>v_proj0_0&#45;&gt;kv_send0_0</title>
<path fill="none" stroke="black" d="M1420.6,-1553.07C1422.69,-1544.99 1424.98,-1536.12 1427.26,-1527.28"/>
<polygon fill="black" stroke="black" points="1430.71,-1527.92 1429.83,-1517.36 1423.93,-1526.17 1430.71,-1527.92"/>
</g>
<!-- attn0_0 -->
<g id="node11" class="node">
<title>attn0_0</title>
<polygon fill="lightgrey" stroke="black" points="911.5,-1385.17 508.5,-1385.17 508.5,-1287.17 911.5,-1287.17 911.5,-1385.17"/>
<text text-anchor="middle" x="710" y="-1369.97" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="710" y="-1354.97" font-family="Times,serif" font-size="14.00">Input: Q[batch=1024, seq=625, heads=16, dim=512]</text>
<text text-anchor="middle" x="710" y="-1339.97" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;K[batch=1024, seq=625, heads=16, dim=512]</text>
<text text-anchor="middle" x="710" y="-1324.97" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;V[batch=1024, seq=625, heads=16, dim=512]</text>
<text text-anchor="middle" x="710" y="-1309.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=625, heads=16, dim=512]</text>
<text text-anchor="middle" x="710" y="-1294.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_attn0_0&#45;&gt;attn0_0 -->
<g id="edge11" class="edge">
<title>ring_attn0_0&#45;&gt;attn0_0</title>
<path fill="none" stroke="black" d="M526.08,-1435.17C551.63,-1421.55 581.89,-1405.43 610.4,-1390.24"/>
<polygon fill="black" stroke="black" points="612.41,-1393.13 619.59,-1385.34 609.12,-1386.96 612.41,-1393.13"/>
</g>
<!-- ring_topology -->
<g id="node21" class="node">
<title>ring_topology</title>
<ellipse fill="lightgrey" stroke="black" cx="1848" cy="-1336.17" rx="141.34" ry="37.45"/>
<text text-anchor="middle" x="1848" y="-1347.47" font-family="Times,serif" font-size="14.00">Ring Topology</text>
<text text-anchor="middle" x="1848" y="-1332.47" font-family="Times,serif" font-size="14.00">KV exchange in 16 stages</text>
<text text-anchor="middle" x="1848" y="-1317.47" font-family="Times,serif" font-size="14.00">GPU 0→1→2→...→15→0</text>
</g>
<!-- kv_send0_0&#45;&gt;ring_topology -->
<g id="edge26" class="edge">
<title>kv_send0_0&#45;&gt;ring_topology</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1566.57,-1428.03C1625.61,-1408.97 1695.11,-1386.53 1750.28,-1368.72"/>
<polygon fill="black" stroke="black" points="1751.61,-1371.97 1760.05,-1365.56 1749.46,-1365.3 1751.61,-1371.97"/>
</g>
<!-- kv_recv0_0 -->
<g id="node10" class="node">
<title>kv_recv0_0</title>
<ellipse fill="lightgrey" stroke="black" cx="933" cy="-1469.25" rx="249.72" ry="48.17"/>
<text text-anchor="middle" x="933" y="-1488.05" font-family="Times,serif" font-size="14.00">Recv KV</text>
<text text-anchor="middle" x="933" y="-1473.05" font-family="Times,serif" font-size="14.00">Input: ← GPU 15</text>
<text text-anchor="middle" x="933" y="-1458.05" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="933" y="-1443.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- kv_recv0_0&#45;&gt;attn0_0 -->
<g id="edge10" class="edge">
<title>kv_recv0_0&#45;&gt;attn0_0</title>
<path fill="none" stroke="black" d="M856.57,-1423.32C838.5,-1412.7 819.06,-1401.28 800.44,-1390.33"/>
<polygon fill="black" stroke="black" points="802.06,-1387.22 791.66,-1385.17 798.51,-1393.25 802.06,-1387.22"/>
</g>
<!-- out_proj0_0 -->
<g id="node12" class="node">
<title>out_proj0_0</title>
<polygon fill="lightgrey" stroke="black" points="905.5,-1251.17 514.5,-1251.17 514.5,-1183.17 905.5,-1183.17 905.5,-1251.17"/>
<text text-anchor="middle" x="710" y="-1235.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="710" y="-1220.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=625, heads=16, dim=512]</text>
<text text-anchor="middle" x="710" y="-1205.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="710" y="-1190.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- attn0_0&#45;&gt;out_proj0_0 -->
<g id="edge12" class="edge">
<title>attn0_0&#45;&gt;out_proj0_0</title>
<path fill="none" stroke="black" d="M710,-1286.9C710,-1278.49 710,-1269.79 710,-1261.53"/>
<polygon fill="black" stroke="black" points="713.5,-1261.34 710,-1251.34 706.5,-1261.34 713.5,-1261.34"/>
</g>
<!-- out_proj0_0&#45;&gt;residual0_0 -->
<g id="edge13" class="edge">
<title>out_proj0_0&#45;&gt;residual0_0</title>
<path fill="none" stroke="black" d="M710,-1182.9C710,-1175.07 710,-1166.4 710,-1157.52"/>
<polygon fill="black" stroke="black" points="713.5,-1157.43 710,-1147.43 706.5,-1157.43 713.5,-1157.43"/>
</g>
<!-- gate0_0 -->
<g id="node14" class="node">
<title>gate0_0</title>
<polygon fill="lightgrey" stroke="black" points="938,-975.17 576,-975.17 576,-907.17 938,-907.17 938,-975.17"/>
<text text-anchor="middle" x="757" y="-959.97" font-family="Times,serif" font-size="14.00">Gate Projection</text>
<text text-anchor="middle" x="757" y="-944.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="757" y="-929.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=625, hidden=32768]</text>
<text text-anchor="middle" x="757" y="-914.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- residual0_0&#45;&gt;gate0_0 -->
<g id="edge15" class="edge">
<title>residual0_0&#45;&gt;gate0_0</title>
<path fill="none" stroke="black" d="M733.22,-1010.96C736.32,-1002.02 739.41,-993.05 742.3,-984.69"/>
<polygon fill="black" stroke="black" points="745.63,-985.78 745.59,-975.18 739.02,-983.49 745.63,-985.78"/>
</g>
<!-- up0_0 -->
<g id="node15" class="node">
<title>up0_0</title>
<polygon fill="lightgrey" stroke="black" points="604,-871.17 242,-871.17 242,-803.17 604,-803.17 604,-871.17"/>
<text text-anchor="middle" x="423" y="-855.97" font-family="Times,serif" font-size="14.00">Up Projection</text>
<text text-anchor="middle" x="423" y="-840.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="423" y="-825.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=625, hidden=32768]</text>
<text text-anchor="middle" x="423" y="-810.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- residual0_0&#45;&gt;up0_0 -->
<g id="edge16" class="edge">
<title>residual0_0&#45;&gt;up0_0</title>
<path fill="none" stroke="black" d="M612.88,-1010.94C597.26,-999.36 581.48,-987.18 567,-975.17 530.06,-944.53 490.76,-906.75 462.56,-878.63"/>
<polygon fill="black" stroke="black" points="464.82,-875.94 455.28,-871.33 459.87,-880.88 464.82,-875.94"/>
</g>
<!-- residual_mlp0_0 -->
<g id="node19" class="node">
<title>residual_mlp0_0</title>
<polygon fill="lightgrey" stroke="black" points="1279.11,-559.17 682.39,-559.17 528.89,-423.17 1125.61,-423.17 1279.11,-559.17"/>
<text text-anchor="middle" x="904" y="-509.97" font-family="Times,serif" font-size="14.00">Add</text>
<text text-anchor="middle" x="904" y="-494.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=625, hidden=8192] x2</text>
<text text-anchor="middle" x="904" y="-479.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="904" y="-464.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- residual0_0&#45;&gt;residual_mlp0_0 -->
<g id="edge22" class="edge">
<title>residual0_0&#45;&gt;residual_mlp0_0</title>
<path fill="none" stroke="black" d="M900.76,-1011.15C917.54,-1000.7 933.31,-988.76 947,-975.17 993.66,-928.8 1003,-903.95 1003,-838.17 1003,-838.17 1003,-838.17 1003,-732.17 1003,-670.91 1011.66,-651.66 988,-595.17 984.05,-585.73 978.95,-576.47 973.21,-567.62"/>
<polygon fill="black" stroke="black" points="976.05,-565.56 967.53,-559.26 970.26,-569.5 976.05,-565.56"/>
</g>
<!-- silu0_0 -->
<g id="node16" class="node">
<title>silu0_0</title>
<polygon fill="lightgrey" stroke="black" points="984,-871.17 622,-871.17 622,-803.17 984,-803.17 984,-871.17"/>
<text text-anchor="middle" x="803" y="-855.97" font-family="Times,serif" font-size="14.00">SiLU</text>
<text text-anchor="middle" x="803" y="-840.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=625, hidden=32768]</text>
<text text-anchor="middle" x="803" y="-825.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=625, hidden=32768]</text>
<text text-anchor="middle" x="803" y="-810.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gate0_0&#45;&gt;silu0_0 -->
<g id="edge17" class="edge">
<title>gate0_0&#45;&gt;silu0_0</title>
<path fill="none" stroke="black" d="M771.93,-907.05C775.71,-898.68 779.82,-889.57 783.77,-880.8"/>
<polygon fill="black" stroke="black" points="787.06,-882.02 787.98,-871.47 780.68,-879.14 787.06,-882.02"/>
</g>
<!-- mul0_0 -->
<g id="node17" class="node">
<title>mul0_0</title>
<polygon fill="lightgrey" stroke="black" points="983.5,-767.17 612.5,-767.17 612.5,-699.17 983.5,-699.17 983.5,-767.17"/>
<text text-anchor="middle" x="798" y="-751.97" font-family="Times,serif" font-size="14.00">Elementwise Mul</text>
<text text-anchor="middle" x="798" y="-736.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=625, hidden=32768] x2</text>
<text text-anchor="middle" x="798" y="-721.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=625, hidden=32768]</text>
<text text-anchor="middle" x="798" y="-706.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- up0_0&#45;&gt;mul0_0 -->
<g id="edge18" class="edge">
<title>up0_0&#45;&gt;mul0_0</title>
<path fill="none" stroke="black" d="M544.49,-803.12C583.52,-792.5 626.93,-780.7 666.64,-769.9"/>
<polygon fill="black" stroke="black" points="667.65,-773.25 676.38,-767.25 665.81,-766.49 667.65,-773.25"/>
</g>
<!-- silu0_0&#45;&gt;mul0_0 -->
<g id="edge19" class="edge">
<title>silu0_0&#45;&gt;mul0_0</title>
<path fill="none" stroke="black" d="M801.38,-803.05C800.98,-794.94 800.55,-786.15 800.13,-777.64"/>
<polygon fill="black" stroke="black" points="803.62,-777.28 799.63,-767.47 796.63,-777.63 803.62,-777.28"/>
</g>
<!-- down0_0 -->
<g id="node18" class="node">
<title>down0_0</title>
<polygon fill="lightgrey" stroke="black" points="978.5,-663.17 625.5,-663.17 625.5,-595.17 978.5,-595.17 978.5,-663.17"/>
<text text-anchor="middle" x="802" y="-647.97" font-family="Times,serif" font-size="14.00">Down Projection</text>
<text text-anchor="middle" x="802" y="-632.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=625, hidden=32768]</text>
<text text-anchor="middle" x="802" y="-617.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=625, hidden=8192]</text>
<text text-anchor="middle" x="802" y="-602.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- mul0_0&#45;&gt;down0_0 -->
<g id="edge20" class="edge">
<title>mul0_0&#45;&gt;down0_0</title>
<path fill="none" stroke="black" d="M799.3,-699.05C799.62,-690.94 799.96,-682.15 800.3,-673.64"/>
<polygon fill="black" stroke="black" points="803.8,-673.6 800.69,-663.47 796.8,-673.32 803.8,-673.6"/>
</g>
<!-- down0_0&#45;&gt;residual_mlp0_0 -->
<g id="edge21" class="edge">
<title>down0_0&#45;&gt;residual_mlp0_0</title>
<path fill="none" stroke="black" d="M826.95,-594.9C833.26,-586.48 840.3,-577.09 847.49,-567.51"/>
<polygon fill="black" stroke="black" points="850.35,-569.53 853.55,-559.43 844.75,-565.33 850.35,-569.53"/>
</g>
<!-- layer1_rep -->
<g id="node22" class="node">
<title>layer1_rep</title>
<polygon fill="lightgrey" stroke="black" points="1013,-357.17 795,-357.17 795,-304.17 1013,-304.17 1013,-357.17"/>
<text text-anchor="middle" x="904" y="-341.97" font-family="Times,serif" font-size="14.00">Layers 1&#45;3</text>
<text text-anchor="middle" x="904" y="-326.97" font-family="Times,serif" font-size="14.00">Same structure repeated</text>
<text text-anchor="middle" x="904" y="-311.97" font-family="Times,serif" font-size="14.00">16 devices, 625 tokens each</text>
</g>
<!-- residual_mlp0_0&#45;&gt;layer1_rep -->
<g id="edge23" class="edge">
<title>residual_mlp0_0&#45;&gt;layer1_rep</title>
<path fill="none" stroke="black" d="M904,-422.95C904,-403.98 904,-384.08 904,-367.71"/>
<polygon fill="black" stroke="black" points="907.5,-367.52 904,-357.52 900.5,-367.52 907.5,-367.52"/>
</g>
<!-- device1_rep -->
<g id="node20" class="node">
<title>device1_rep</title>
<polygon fill="lightgrey" stroke="black" points="225.5,-1821.83 16.5,-1821.83 16.5,-1768.83 225.5,-1768.83 225.5,-1821.83"/>
<text text-anchor="middle" x="121" y="-1806.63" font-family="Times,serif" font-size="14.00">...</text>
<text text-anchor="middle" x="121" y="-1791.63" font-family="Times,serif" font-size="14.00">GPU 1&#45;15</text>
<text text-anchor="middle" x="121" y="-1776.63" font-family="Times,serif" font-size="14.00">(Same structure as GPU 0)</text>
</g>
<!-- ring_topology&#45;&gt;kv_recv0_0 -->
<g id="edge27" class="edge">
<title>ring_topology&#45;&gt;kv_recv0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1765.92,-1366.77C1743.21,-1373.9 1718.38,-1380.72 1695,-1385.17 1474.81,-1426.99 1414.36,-1393.08 1192,-1421.17 1166.97,-1424.33 1140.7,-1428.31 1114.87,-1432.62"/>
<polygon fill="black" stroke="black" points="1114.28,-1429.17 1105,-1434.29 1115.45,-1436.08 1114.28,-1429.17"/>
</g>
<!-- sequence_gather -->
<g id="node23" class="node">
<title>sequence_gather</title>
<polygon fill="lightgrey" stroke="black" points="1293.64,-268.17 673.81,-268.17 514.36,-132.17 1134.19,-132.17 1293.64,-268.17"/>
<text text-anchor="middle" x="904" y="-218.97" font-family="Times,serif" font-size="14.00">Sequence Gather</text>
<text text-anchor="middle" x="904" y="-203.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=625, hidden=8192] x 16</text>
<text text-anchor="middle" x="904" y="-188.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="904" y="-173.97" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer1_rep&#45;&gt;sequence_gather -->
<g id="edge24" class="edge">
<title>layer1_rep&#45;&gt;sequence_gather</title>
<path fill="none" stroke="black" d="M904,-303.97C904,-296.33 904,-287.54 904,-278.38"/>
<polygon fill="black" stroke="black" points="907.5,-278.34 904,-268.34 900.5,-278.34 907.5,-278.34"/>
</g>
<!-- output -->
<g id="node24" class="node">
<title>output</title>
<ellipse fill="lightgrey" stroke="black" cx="904" cy="-48.08" rx="253.7" ry="48.17"/>
<text text-anchor="middle" x="904" y="-66.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="904" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="904" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, vocab_size]</text>
<text text-anchor="middle" x="904" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- sequence_gather&#45;&gt;output -->
<g id="edge25" class="edge">
<title>sequence_gather&#45;&gt;output</title>
<path fill="none" stroke="black" d="M904,-132.03C904,-123.48 904,-114.8 904,-106.43"/>
<polygon fill="black" stroke="black" points="907.5,-106.4 904,-96.4 900.5,-106.4 907.5,-106.4"/>
</g>
</g>
</svg>
