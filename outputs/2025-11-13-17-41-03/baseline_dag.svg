<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="1410pt" height="5336pt"
 viewBox="0.00 0.00 1410.00 5336.07" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 5332.07)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-5332.07 1406,-5332.07 1406,4 -4,4"/>
<text text-anchor="middle" x="701" y="-5304.87" font-family="Times,serif" font-size="24.00">Baseline: Tensor Parallel (TP=8) + Pipeline Parallel (PP=2)</text>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="200,-2671.12 200,-5211.12 1394,-5211.12 1394,-2671.12 200,-2671.12"/>
<text text-anchor="middle" x="797" y="-5187.92" font-family="Times,serif" font-size="24.00">Pipeline Stage 0</text>
<text text-anchor="middle" x="797" y="-5161.92" font-family="Times,serif" font-size="24.00">GPUs 0&#45;7</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer0</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="208,-3877.12 208,-5067.12 1374,-5067.12 1374,-3877.12 208,-3877.12"/>
<text text-anchor="middle" x="791" y="-5043.92" font-family="Times,serif" font-size="24.00">Layer 0 (Stage 0)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer1</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="208,-2679.12 208,-3869.12 1374,-3869.12 1374,-2679.12 208,-2679.12"/>
<text text-anchor="middle" x="791" y="-3845.92" font-family="Times,serif" font-size="24.00">Layer 1 (Stage 0)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-116.17 8,-2663.12 1202,-2663.12 1202,-116.17 8,-116.17"/>
<text text-anchor="middle" x="605" y="-2639.92" font-family="Times,serif" font-size="24.00">Pipeline Stage 1</text>
<text text-anchor="middle" x="605" y="-2613.92" font-family="Times,serif" font-size="24.00">GPUs 8&#45;15</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer2</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="16,-1322.17 16,-2512.17 1182,-2512.17 1182,-1322.17 16,-1322.17"/>
<text text-anchor="middle" x="599" y="-2488.97" font-family="Times,serif" font-size="24.00">Layer 2 (Stage 1)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer3</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="16,-124.17 16,-1314.17 1182,-1314.17 1182,-124.17 16,-124.17"/>
<text text-anchor="middle" x="599" y="-1290.97" font-family="Times,serif" font-size="24.00">Layer 3 (Stage 1)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgrey" stroke="black" cx="1092" cy="-5256.6" rx="298.3" ry="37.45"/>
<text text-anchor="middle" x="1092" y="-5267.9" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1092" y="-5252.9" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1092" y="-5237.9" font-family="Times,serif" font-size="14.00">GPU: Host</text>
</g>
<!-- embedding -->
<g id="node2" class="node">
<title>embedding</title>
<polygon fill="lightgrey" stroke="black" points="1277.5,-5143.12 906.5,-5143.12 906.5,-5075.12 1277.5,-5075.12 1277.5,-5143.12"/>
<text text-anchor="middle" x="1092" y="-5127.92" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="1092" y="-5112.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="1092" y="-5097.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="1092" y="-5082.92" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;embedding -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embedding</title>
<path fill="none" stroke="black" d="M1092,-5218.89C1092,-5199.01 1092,-5174.34 1092,-5153.52"/>
<polygon fill="black" stroke="black" points="1095.5,-5153.34 1092,-5143.34 1088.5,-5153.34 1095.5,-5153.34"/>
</g>
<!-- ln0 -->
<g id="node3" class="node">
<title>ln0</title>
<polygon fill="lightgrey" stroke="black" points="1170.5,-5025.12 799.5,-5025.12 799.5,-4957.12 1170.5,-4957.12 1170.5,-5025.12"/>
<text text-anchor="middle" x="985" y="-5009.92" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="985" y="-4994.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="985" y="-4979.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="985" y="-4964.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- embedding&#45;&gt;ln0 -->
<g id="edge2" class="edge">
<title>embedding&#45;&gt;ln0</title>
<path fill="none" stroke="black" d="M1061.34,-5074.88C1049.25,-5061.77 1035.25,-5046.59 1022.56,-5032.84"/>
<polygon fill="black" stroke="black" points="1025.02,-5030.34 1015.67,-5025.37 1019.87,-5035.09 1025.02,-5030.34"/>
</g>
<!-- residual0 -->
<g id="node9" class="node">
<title>residual0</title>
<polygon fill="lightgrey" stroke="black" points="1320.93,-4609.12 694.27,-4609.12 533.07,-4473.12 1159.73,-4473.12 1320.93,-4609.12"/>
<text text-anchor="middle" x="927" y="-4559.92" font-family="Times,serif" font-size="14.00">Add</text>
<text text-anchor="middle" x="927" y="-4544.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192] x2</text>
<text text-anchor="middle" x="927" y="-4529.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="927" y="-4514.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- embedding&#45;&gt;residual0 -->
<g id="edge11" class="edge">
<title>embedding&#45;&gt;residual0</title>
<path fill="none" stroke="black" d="M1201.52,-5075.11C1284.74,-5042.47 1385,-4983.38 1385,-4888.12 1385,-4888.12 1385,-4888.12 1385,-4782.12 1385,-4702.49 1330.01,-4649.23 1258.14,-4613.62"/>
<polygon fill="black" stroke="black" points="1259.35,-4610.32 1248.82,-4609.15 1256.32,-4616.63 1259.35,-4610.32"/>
</g>
<!-- q_proj_0 -->
<g id="node4" class="node">
<title>q_proj_0</title>
<polygon fill="lightgrey" stroke="black" points="587.5,-4921.12 216.5,-4921.12 216.5,-4853.12 587.5,-4853.12 587.5,-4921.12"/>
<text text-anchor="middle" x="402" y="-4905.92" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="402" y="-4890.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="402" y="-4875.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="402" y="-4860.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (column split)</text>
</g>
<!-- ln0&#45;&gt;q_proj_0 -->
<g id="edge3" class="edge">
<title>ln0&#45;&gt;q_proj_0</title>
<path fill="none" stroke="black" d="M799.33,-4957.64C734.97,-4946.38 662.64,-4933.72 597.51,-4922.33"/>
<polygon fill="black" stroke="black" points="598,-4918.86 587.54,-4920.58 596.79,-4925.75 598,-4918.86"/>
</g>
<!-- k_proj_0 -->
<g id="node5" class="node">
<title>k_proj_0</title>
<polygon fill="lightgrey" stroke="black" points="976.5,-4921.12 605.5,-4921.12 605.5,-4853.12 976.5,-4853.12 976.5,-4921.12"/>
<text text-anchor="middle" x="791" y="-4905.92" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="791" y="-4890.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="791" y="-4875.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="791" y="-4860.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (column split)</text>
</g>
<!-- ln0&#45;&gt;k_proj_0 -->
<g id="edge4" class="edge">
<title>ln0&#45;&gt;k_proj_0</title>
<path fill="none" stroke="black" d="M922.01,-4957C903.2,-4947.11 882.43,-4936.19 863.08,-4926.02"/>
<polygon fill="black" stroke="black" points="864.48,-4922.8 854,-4921.24 861.22,-4929 864.48,-4922.8"/>
</g>
<!-- v_proj_0 -->
<g id="node6" class="node">
<title>v_proj_0</title>
<polygon fill="lightgrey" stroke="black" points="1365.5,-4921.12 994.5,-4921.12 994.5,-4853.12 1365.5,-4853.12 1365.5,-4921.12"/>
<text text-anchor="middle" x="1180" y="-4905.92" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1180" y="-4890.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="1180" y="-4875.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="1180" y="-4860.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (column split)</text>
</g>
<!-- ln0&#45;&gt;v_proj_0 -->
<g id="edge5" class="edge">
<title>ln0&#45;&gt;v_proj_0</title>
<path fill="none" stroke="black" d="M1048.31,-4957C1067.22,-4947.11 1088.1,-4936.19 1107.55,-4926.02"/>
<polygon fill="black" stroke="black" points="1109.43,-4928.98 1116.67,-4921.24 1106.19,-4922.78 1109.43,-4928.98"/>
</g>
<!-- mha_0 -->
<g id="node7" class="node">
<title>mha_0</title>
<polygon fill="lightgrey" stroke="black" points="1011,-4817.12 617,-4817.12 617,-4749.12 1011,-4749.12 1011,-4817.12"/>
<text text-anchor="middle" x="814" y="-4801.92" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="814" y="-4786.92" font-family="Times,serif" font-size="14.00">Input QKV: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="814" y="-4771.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="814" y="-4756.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- q_proj_0&#45;&gt;mha_0 -->
<g id="edge6" class="edge">
<title>q_proj_0&#45;&gt;mha_0</title>
<path fill="none" stroke="black" d="M535.48,-4853.07C578.64,-4842.39 626.66,-4830.5 670.51,-4819.64"/>
<polygon fill="black" stroke="black" points="671.51,-4823 680.38,-4817.2 669.83,-4816.21 671.51,-4823"/>
</g>
<!-- k_proj_0&#45;&gt;mha_0 -->
<g id="edge7" class="edge">
<title>k_proj_0&#45;&gt;mha_0</title>
<path fill="none" stroke="black" d="M798.47,-4853C800.32,-4844.81 802.32,-4835.91 804.26,-4827.31"/>
<polygon fill="black" stroke="black" points="807.71,-4827.94 806.49,-4817.42 800.88,-4826.4 807.71,-4827.94"/>
</g>
<!-- v_proj_0&#45;&gt;mha_0 -->
<g id="edge8" class="edge">
<title>v_proj_0&#45;&gt;mha_0</title>
<path fill="none" stroke="black" d="M1061.42,-4853.07C1023.41,-4842.48 981.14,-4830.7 942.46,-4819.92"/>
<polygon fill="black" stroke="black" points="943.27,-4816.51 932.7,-4817.2 941.39,-4823.26 943.27,-4816.51"/>
</g>
<!-- out_proj_0 -->
<g id="node8" class="node">
<title>out_proj_0</title>
<polygon fill="lightgrey" stroke="black" points="1022.5,-4713.12 651.5,-4713.12 651.5,-4645.12 1022.5,-4645.12 1022.5,-4713.12"/>
<text text-anchor="middle" x="837" y="-4697.92" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="837" y="-4682.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="837" y="-4667.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="837" y="-4652.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (row split)</text>
</g>
<!-- mha_0&#45;&gt;out_proj_0 -->
<g id="edge9" class="edge">
<title>mha_0&#45;&gt;out_proj_0</title>
<path fill="none" stroke="black" d="M821.47,-4749C823.32,-4740.81 825.32,-4731.91 827.26,-4723.31"/>
<polygon fill="black" stroke="black" points="830.71,-4723.94 829.49,-4713.42 823.88,-4722.4 830.71,-4723.94"/>
</g>
<!-- out_proj_0&#45;&gt;residual0 -->
<g id="edge10" class="edge">
<title>out_proj_0&#45;&gt;residual0</title>
<path fill="none" stroke="black" d="M859.02,-4644.85C864.53,-4636.52 870.67,-4627.23 876.95,-4617.75"/>
<polygon fill="black" stroke="black" points="879.89,-4619.65 882.49,-4609.38 874.05,-4615.79 879.89,-4619.65"/>
</g>
<!-- gate_proj_0 -->
<g id="node10" class="node">
<title>gate_proj_0</title>
<polygon fill="lightgrey" stroke="black" points="815.5,-4437.12 444.5,-4437.12 444.5,-4369.12 815.5,-4369.12 815.5,-4437.12"/>
<text text-anchor="middle" x="630" y="-4421.92" font-family="Times,serif" font-size="14.00">Gate Projection</text>
<text text-anchor="middle" x="630" y="-4406.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="630" y="-4391.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="630" y="-4376.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (column split)</text>
</g>
<!-- residual0&#45;&gt;gate_proj_0 -->
<g id="edge12" class="edge">
<title>residual0&#45;&gt;gate_proj_0</title>
<path fill="none" stroke="black" d="M780.68,-4473.12C756.95,-4462.25 733.15,-4451.36 711.7,-4441.53"/>
<polygon fill="black" stroke="black" points="712.89,-4438.23 702.34,-4437.25 709.98,-4444.59 712.89,-4438.23"/>
</g>
<!-- up_proj_0 -->
<g id="node11" class="node">
<title>up_proj_0</title>
<polygon fill="lightgrey" stroke="black" points="1112.5,-4333.12 741.5,-4333.12 741.5,-4265.12 1112.5,-4265.12 1112.5,-4333.12"/>
<text text-anchor="middle" x="927" y="-4317.92" font-family="Times,serif" font-size="14.00">Up Projection</text>
<text text-anchor="middle" x="927" y="-4302.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="927" y="-4287.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="927" y="-4272.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (column split)</text>
</g>
<!-- residual0&#45;&gt;up_proj_0 -->
<g id="edge13" class="edge">
<title>residual0&#45;&gt;up_proj_0</title>
<path fill="none" stroke="black" d="M927,-4472.95C927,-4431.55 927,-4379.67 927,-4343.61"/>
<polygon fill="black" stroke="black" points="930.5,-4343.42 927,-4333.42 923.5,-4343.42 930.5,-4343.42"/>
</g>
<!-- residual_mlp0 -->
<g id="node15" class="node">
<title>residual_mlp0</title>
<polygon fill="lightgrey" stroke="black" points="1363.93,-4021.12 737.27,-4021.12 576.07,-3885.12 1202.73,-3885.12 1363.93,-4021.12"/>
<text text-anchor="middle" x="970" y="-3971.92" font-family="Times,serif" font-size="14.00">Add</text>
<text text-anchor="middle" x="970" y="-3956.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192] x2</text>
<text text-anchor="middle" x="970" y="-3941.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="970" y="-3926.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual0&#45;&gt;residual_mlp0 -->
<g id="edge19" class="edge">
<title>residual0&#45;&gt;residual_mlp0</title>
<path fill="none" stroke="black" d="M1029.2,-4472.97C1080.55,-4430.5 1132,-4370.4 1132,-4300.12 1132,-4300.12 1132,-4300.12 1132,-4194.12 1132,-4132.96 1149.93,-4109.88 1119,-4057.12 1112.91,-4046.73 1105.31,-4037.15 1096.79,-4028.36"/>
<polygon fill="black" stroke="black" points="1099.02,-4025.66 1089.43,-4021.17 1094.13,-4030.66 1099.02,-4025.66"/>
</g>
<!-- silu_0 -->
<g id="node12" class="node">
<title>silu_0</title>
<polygon fill="lightgrey" stroke="black" points="723.5,-4333.12 352.5,-4333.12 352.5,-4265.12 723.5,-4265.12 723.5,-4333.12"/>
<text text-anchor="middle" x="538" y="-4317.92" font-family="Times,serif" font-size="14.00">SiLU</text>
<text text-anchor="middle" x="538" y="-4302.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="538" y="-4287.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="538" y="-4272.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- gate_proj_0&#45;&gt;silu_0 -->
<g id="edge14" class="edge">
<title>gate_proj_0&#45;&gt;silu_0</title>
<path fill="none" stroke="black" d="M600.13,-4369C592.1,-4360.1 583.31,-4350.36 574.94,-4341.08"/>
<polygon fill="black" stroke="black" points="577.33,-4338.5 568.03,-4333.42 572.13,-4343.19 577.33,-4338.5"/>
</g>
<!-- mul_0 -->
<g id="node13" class="node">
<title>mul_0</title>
<polygon fill="lightgrey" stroke="black" points="1113,-4229.12 733,-4229.12 733,-4161.12 1113,-4161.12 1113,-4229.12"/>
<text text-anchor="middle" x="923" y="-4213.92" font-family="Times,serif" font-size="14.00">Elementwise Mul</text>
<text text-anchor="middle" x="923" y="-4198.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=4096] x2</text>
<text text-anchor="middle" x="923" y="-4183.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="923" y="-4168.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- up_proj_0&#45;&gt;mul_0 -->
<g id="edge15" class="edge">
<title>up_proj_0&#45;&gt;mul_0</title>
<path fill="none" stroke="black" d="M925.7,-4265C925.38,-4256.9 925.04,-4248.1 924.7,-4239.59"/>
<polygon fill="black" stroke="black" points="928.2,-4239.27 924.31,-4229.42 921.2,-4239.55 928.2,-4239.27"/>
</g>
<!-- silu_0&#45;&gt;mul_0 -->
<g id="edge16" class="edge">
<title>silu_0&#45;&gt;mul_0</title>
<path fill="none" stroke="black" d="M662.73,-4265.07C702.89,-4254.43 747.56,-4242.6 788.39,-4231.78"/>
<polygon fill="black" stroke="black" points="789.37,-4235.14 798.14,-4229.2 787.57,-4228.38 789.37,-4235.14"/>
</g>
<!-- down_proj_0 -->
<g id="node14" class="node">
<title>down_proj_0</title>
<polygon fill="lightgrey" stroke="black" points="1109.5,-4125.12 738.5,-4125.12 738.5,-4057.12 1109.5,-4057.12 1109.5,-4125.12"/>
<text text-anchor="middle" x="924" y="-4109.92" font-family="Times,serif" font-size="14.00">Down Projection</text>
<text text-anchor="middle" x="924" y="-4094.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="924" y="-4079.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="924" y="-4064.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (row split)</text>
</g>
<!-- mul_0&#45;&gt;down_proj_0 -->
<g id="edge17" class="edge">
<title>mul_0&#45;&gt;down_proj_0</title>
<path fill="none" stroke="black" d="M923.32,-4161C923.4,-4152.9 923.49,-4144.1 923.57,-4135.59"/>
<polygon fill="black" stroke="black" points="927.08,-4135.45 923.67,-4125.42 920.08,-4135.38 927.08,-4135.45"/>
</g>
<!-- down_proj_0&#45;&gt;residual_mlp0 -->
<g id="edge18" class="edge">
<title>down_proj_0&#45;&gt;residual_mlp0</title>
<path fill="none" stroke="black" d="M935.25,-4056.85C937.96,-4048.85 940.96,-4039.98 944.03,-4030.9"/>
<polygon fill="black" stroke="black" points="947.36,-4031.98 947.25,-4021.38 940.73,-4029.73 947.36,-4031.98"/>
</g>
<!-- ln1 -->
<g id="node16" class="node">
<title>ln1</title>
<polygon fill="lightgrey" stroke="black" points="1065.5,-3827.12 694.5,-3827.12 694.5,-3759.12 1065.5,-3759.12 1065.5,-3827.12"/>
<text text-anchor="middle" x="880" y="-3811.92" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="880" y="-3796.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="880" y="-3781.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="880" y="-3766.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual_mlp0&#45;&gt;ln1 -->
<g id="edge20" class="edge">
<title>residual_mlp0&#45;&gt;ln1</title>
<path fill="none" stroke="black" d="M931.83,-3885.11C922.39,-3868.54 912.54,-3851.24 903.99,-3836.23"/>
<polygon fill="black" stroke="black" points="906.84,-3834.17 898.85,-3827.21 900.76,-3837.63 906.84,-3834.17"/>
</g>
<!-- residual1 -->
<g id="node22" class="node">
<title>residual1</title>
<polygon fill="lightgrey" stroke="black" points="1342.93,-3411.12 716.27,-3411.12 555.07,-3275.12 1181.73,-3275.12 1342.93,-3411.12"/>
<text text-anchor="middle" x="949" y="-3361.92" font-family="Times,serif" font-size="14.00">Add</text>
<text text-anchor="middle" x="949" y="-3346.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192] x2</text>
<text text-anchor="middle" x="949" y="-3331.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="949" y="-3316.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual_mlp0&#45;&gt;residual1 -->
<g id="edge29" class="edge">
<title>residual_mlp0&#45;&gt;residual1</title>
<path fill="none" stroke="black" d="M1209,-3890.41C1301.25,-3850.93 1385,-3788.11 1385,-3690.12 1385,-3690.12 1385,-3690.12 1385,-3584.12 1385,-3504.78 1328.91,-3451.48 1256.96,-3415.75"/>
<polygon fill="black" stroke="black" points="1258.17,-3412.44 1247.65,-3411.26 1255.13,-3418.75 1258.17,-3412.44"/>
</g>
<!-- q_proj_1 -->
<g id="node17" class="node">
<title>q_proj_1</title>
<polygon fill="lightgrey" stroke="black" points="587.5,-3723.12 216.5,-3723.12 216.5,-3655.12 587.5,-3655.12 587.5,-3723.12"/>
<text text-anchor="middle" x="402" y="-3707.92" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="402" y="-3692.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="402" y="-3677.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="402" y="-3662.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (column split)</text>
</g>
<!-- ln1&#45;&gt;q_proj_1 -->
<g id="edge21" class="edge">
<title>ln1&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M725.14,-3759.07C674.54,-3748.28 618.18,-3736.25 566.88,-3725.3"/>
<polygon fill="black" stroke="black" points="567.54,-3721.86 557.03,-3723.2 566.07,-3728.71 567.54,-3721.86"/>
</g>
<!-- k_proj_1 -->
<g id="node18" class="node">
<title>k_proj_1</title>
<polygon fill="lightgrey" stroke="black" points="976.5,-3723.12 605.5,-3723.12 605.5,-3655.12 976.5,-3655.12 976.5,-3723.12"/>
<text text-anchor="middle" x="791" y="-3707.92" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="791" y="-3692.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="791" y="-3677.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="791" y="-3662.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (column split)</text>
</g>
<!-- ln1&#45;&gt;k_proj_1 -->
<g id="edge22" class="edge">
<title>ln1&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M851.1,-3759C843.33,-3750.1 834.83,-3740.36 826.74,-3731.08"/>
<polygon fill="black" stroke="black" points="829.27,-3728.65 820.06,-3723.42 823.99,-3733.26 829.27,-3728.65"/>
</g>
<!-- v_proj_1 -->
<g id="node19" class="node">
<title>v_proj_1</title>
<polygon fill="lightgrey" stroke="black" points="1365.5,-3723.12 994.5,-3723.12 994.5,-3655.12 1365.5,-3655.12 1365.5,-3723.12"/>
<text text-anchor="middle" x="1180" y="-3707.92" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1180" y="-3692.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="1180" y="-3677.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="1180" y="-3662.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (column split)</text>
</g>
<!-- ln1&#45;&gt;v_proj_1 -->
<g id="edge23" class="edge">
<title>ln1&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M977.4,-3759C1008.02,-3748.59 1041.99,-3737.04 1073.23,-3726.42"/>
<polygon fill="black" stroke="black" points="1074.49,-3729.69 1082.83,-3723.16 1072.24,-3723.06 1074.49,-3729.69"/>
</g>
<!-- mha_1 -->
<g id="node20" class="node">
<title>mha_1</title>
<polygon fill="lightgrey" stroke="black" points="1011,-3619.12 617,-3619.12 617,-3551.12 1011,-3551.12 1011,-3619.12"/>
<text text-anchor="middle" x="814" y="-3603.92" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="814" y="-3588.92" font-family="Times,serif" font-size="14.00">Input QKV: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="814" y="-3573.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="814" y="-3558.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- q_proj_1&#45;&gt;mha_1 -->
<g id="edge24" class="edge">
<title>q_proj_1&#45;&gt;mha_1</title>
<path fill="none" stroke="black" d="M535.48,-3655.07C578.64,-3644.39 626.66,-3632.5 670.51,-3621.64"/>
<polygon fill="black" stroke="black" points="671.51,-3625 680.38,-3619.2 669.83,-3618.21 671.51,-3625"/>
</g>
<!-- k_proj_1&#45;&gt;mha_1 -->
<g id="edge25" class="edge">
<title>k_proj_1&#45;&gt;mha_1</title>
<path fill="none" stroke="black" d="M798.47,-3655C800.32,-3646.81 802.32,-3637.91 804.26,-3629.31"/>
<polygon fill="black" stroke="black" points="807.71,-3629.94 806.49,-3619.42 800.88,-3628.4 807.71,-3629.94"/>
</g>
<!-- v_proj_1&#45;&gt;mha_1 -->
<g id="edge26" class="edge">
<title>v_proj_1&#45;&gt;mha_1</title>
<path fill="none" stroke="black" d="M1061.42,-3655.07C1023.41,-3644.48 981.14,-3632.7 942.46,-3621.92"/>
<polygon fill="black" stroke="black" points="943.27,-3618.51 932.7,-3619.2 941.39,-3625.26 943.27,-3618.51"/>
</g>
<!-- out_proj_1 -->
<g id="node21" class="node">
<title>out_proj_1</title>
<polygon fill="lightgrey" stroke="black" points="1044.5,-3515.12 673.5,-3515.12 673.5,-3447.12 1044.5,-3447.12 1044.5,-3515.12"/>
<text text-anchor="middle" x="859" y="-3499.92" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="859" y="-3484.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="859" y="-3469.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="859" y="-3454.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (row split)</text>
</g>
<!-- mha_1&#45;&gt;out_proj_1 -->
<g id="edge27" class="edge">
<title>mha_1&#45;&gt;out_proj_1</title>
<path fill="none" stroke="black" d="M828.61,-3551C832.3,-3542.63 836.32,-3533.52 840.19,-3524.75"/>
<polygon fill="black" stroke="black" points="843.47,-3525.98 844.31,-3515.42 837.07,-3523.16 843.47,-3525.98"/>
</g>
<!-- out_proj_1&#45;&gt;residual1 -->
<g id="edge28" class="edge">
<title>out_proj_1&#45;&gt;residual1</title>
<path fill="none" stroke="black" d="M881.02,-3446.85C886.53,-3438.52 892.67,-3429.23 898.95,-3419.75"/>
<polygon fill="black" stroke="black" points="901.89,-3421.65 904.49,-3411.38 896.05,-3417.79 901.89,-3421.65"/>
</g>
<!-- gate_proj_1 -->
<g id="node23" class="node">
<title>gate_proj_1</title>
<polygon fill="lightgrey" stroke="black" points="837.5,-3239.12 466.5,-3239.12 466.5,-3171.12 837.5,-3171.12 837.5,-3239.12"/>
<text text-anchor="middle" x="652" y="-3223.92" font-family="Times,serif" font-size="14.00">Gate Projection</text>
<text text-anchor="middle" x="652" y="-3208.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="652" y="-3193.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="652" y="-3178.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (column split)</text>
</g>
<!-- residual1&#45;&gt;gate_proj_1 -->
<g id="edge30" class="edge">
<title>residual1&#45;&gt;gate_proj_1</title>
<path fill="none" stroke="black" d="M802.68,-3275.12C778.95,-3264.25 755.15,-3253.36 733.7,-3243.53"/>
<polygon fill="black" stroke="black" points="734.89,-3240.23 724.34,-3239.25 731.98,-3246.59 734.89,-3240.23"/>
</g>
<!-- up_proj_1 -->
<g id="node24" class="node">
<title>up_proj_1</title>
<polygon fill="lightgrey" stroke="black" points="1134.5,-3135.12 763.5,-3135.12 763.5,-3067.12 1134.5,-3067.12 1134.5,-3135.12"/>
<text text-anchor="middle" x="949" y="-3119.92" font-family="Times,serif" font-size="14.00">Up Projection</text>
<text text-anchor="middle" x="949" y="-3104.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="949" y="-3089.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="949" y="-3074.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (column split)</text>
</g>
<!-- residual1&#45;&gt;up_proj_1 -->
<g id="edge31" class="edge">
<title>residual1&#45;&gt;up_proj_1</title>
<path fill="none" stroke="black" d="M949,-3274.95C949,-3233.55 949,-3181.67 949,-3145.61"/>
<polygon fill="black" stroke="black" points="952.5,-3145.42 949,-3135.42 945.5,-3145.42 952.5,-3145.42"/>
</g>
<!-- residual_mlp1 -->
<g id="node28" class="node">
<title>residual_mlp1</title>
<polygon fill="lightgrey" stroke="black" points="1363.93,-2823.12 737.27,-2823.12 576.07,-2687.12 1202.73,-2687.12 1363.93,-2823.12"/>
<text text-anchor="middle" x="970" y="-2773.92" font-family="Times,serif" font-size="14.00">Add</text>
<text text-anchor="middle" x="970" y="-2758.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192] x2</text>
<text text-anchor="middle" x="970" y="-2743.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="970" y="-2728.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual1&#45;&gt;residual_mlp1 -->
<g id="edge37" class="edge">
<title>residual1&#45;&gt;residual_mlp1</title>
<path fill="none" stroke="black" d="M1051.2,-3274.97C1102.55,-3232.5 1154,-3172.4 1154,-3102.12 1154,-3102.12 1154,-3102.12 1154,-2996.12 1154,-2934.96 1173.57,-2910.89 1141,-2859.12 1134.37,-2848.59 1126.24,-2838.99 1117.16,-2830.26"/>
<polygon fill="black" stroke="black" points="1119.43,-2827.59 1109.68,-2823.44 1114.72,-2832.77 1119.43,-2827.59"/>
</g>
<!-- silu_1 -->
<g id="node25" class="node">
<title>silu_1</title>
<polygon fill="lightgrey" stroke="black" points="745.5,-3135.12 374.5,-3135.12 374.5,-3067.12 745.5,-3067.12 745.5,-3135.12"/>
<text text-anchor="middle" x="560" y="-3119.92" font-family="Times,serif" font-size="14.00">SiLU</text>
<text text-anchor="middle" x="560" y="-3104.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="560" y="-3089.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="560" y="-3074.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- gate_proj_1&#45;&gt;silu_1 -->
<g id="edge32" class="edge">
<title>gate_proj_1&#45;&gt;silu_1</title>
<path fill="none" stroke="black" d="M622.13,-3171C614.1,-3162.1 605.31,-3152.36 596.94,-3143.08"/>
<polygon fill="black" stroke="black" points="599.33,-3140.5 590.03,-3135.42 594.13,-3145.19 599.33,-3140.5"/>
</g>
<!-- mul_1 -->
<g id="node26" class="node">
<title>mul_1</title>
<polygon fill="lightgrey" stroke="black" points="1135,-3031.12 755,-3031.12 755,-2963.12 1135,-2963.12 1135,-3031.12"/>
<text text-anchor="middle" x="945" y="-3015.92" font-family="Times,serif" font-size="14.00">Elementwise Mul</text>
<text text-anchor="middle" x="945" y="-3000.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=4096] x2</text>
<text text-anchor="middle" x="945" y="-2985.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="945" y="-2970.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- up_proj_1&#45;&gt;mul_1 -->
<g id="edge33" class="edge">
<title>up_proj_1&#45;&gt;mul_1</title>
<path fill="none" stroke="black" d="M947.7,-3067C947.38,-3058.9 947.04,-3050.1 946.7,-3041.59"/>
<polygon fill="black" stroke="black" points="950.2,-3041.27 946.31,-3031.42 943.2,-3041.55 950.2,-3041.27"/>
</g>
<!-- silu_1&#45;&gt;mul_1 -->
<g id="edge34" class="edge">
<title>silu_1&#45;&gt;mul_1</title>
<path fill="none" stroke="black" d="M684.73,-3067.07C724.89,-3056.43 769.56,-3044.6 810.39,-3033.78"/>
<polygon fill="black" stroke="black" points="811.37,-3037.14 820.14,-3031.2 809.57,-3030.38 811.37,-3037.14"/>
</g>
<!-- down_proj_1 -->
<g id="node27" class="node">
<title>down_proj_1</title>
<polygon fill="lightgrey" stroke="black" points="1131.5,-2927.12 760.5,-2927.12 760.5,-2859.12 1131.5,-2859.12 1131.5,-2927.12"/>
<text text-anchor="middle" x="946" y="-2911.92" font-family="Times,serif" font-size="14.00">Down Projection</text>
<text text-anchor="middle" x="946" y="-2896.92" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="946" y="-2881.92" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="946" y="-2866.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (row split)</text>
</g>
<!-- mul_1&#45;&gt;down_proj_1 -->
<g id="edge35" class="edge">
<title>mul_1&#45;&gt;down_proj_1</title>
<path fill="none" stroke="black" d="M945.32,-2963C945.4,-2954.9 945.49,-2946.1 945.57,-2937.59"/>
<polygon fill="black" stroke="black" points="949.08,-2937.45 945.67,-2927.42 942.08,-2937.38 949.08,-2937.45"/>
</g>
<!-- down_proj_1&#45;&gt;residual_mlp1 -->
<g id="edge36" class="edge">
<title>down_proj_1&#45;&gt;residual_mlp1</title>
<path fill="none" stroke="black" d="M951.87,-2858.85C953.25,-2851.02 954.78,-2842.36 956.35,-2833.47"/>
<polygon fill="black" stroke="black" points="959.84,-2833.84 958.13,-2823.38 952.95,-2832.62 959.84,-2833.84"/>
</g>
<!-- pipeline_comm -->
<g id="node29" class="node">
<title>pipeline_comm</title>
<ellipse fill="lightgrey" stroke="black" cx="970" cy="-2557.64" rx="137.77" ry="37.45"/>
<text text-anchor="middle" x="970" y="-2568.94" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="970" y="-2553.94" font-family="Times,serif" font-size="14.00">Send/Receive activations</text>
<text text-anchor="middle" x="970" y="-2538.94" font-family="Times,serif" font-size="14.00">GPU 7 &#45;&gt; GPU 8</text>
</g>
<!-- residual_mlp1&#45;&gt;pipeline_comm -->
<g id="edge38" class="edge">
<title>residual_mlp1&#45;&gt;pipeline_comm</title>
<path fill="none" stroke="black" d="M970,-2686.85C970,-2659.98 970,-2629.71 970,-2605.33"/>
<polygon fill="black" stroke="black" points="973.5,-2605.26 970,-2595.26 966.5,-2605.26 973.5,-2605.26"/>
</g>
<!-- ln2 -->
<g id="node30" class="node">
<title>ln2</title>
<polygon fill="lightgrey" stroke="black" points="1069.5,-2470.17 698.5,-2470.17 698.5,-2402.17 1069.5,-2402.17 1069.5,-2470.17"/>
<text text-anchor="middle" x="884" y="-2454.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="884" y="-2439.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="884" y="-2424.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="884" y="-2409.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- pipeline_comm&#45;&gt;ln2 -->
<g id="edge39" class="edge">
<title>pipeline_comm&#45;&gt;ln2</title>
<path fill="none" stroke="black" d="M944.2,-2520.8C934.69,-2507.59 923.84,-2492.52 914,-2478.84"/>
<polygon fill="black" stroke="black" points="916.7,-2476.61 908.02,-2470.54 911.02,-2480.7 916.7,-2476.61"/>
</g>
<!-- residual2 -->
<g id="node36" class="node">
<title>residual2</title>
<polygon fill="lightgrey" stroke="black" points="1083.93,-2054.17 457.27,-2054.17 296.07,-1918.17 922.73,-1918.17 1083.93,-2054.17"/>
<text text-anchor="middle" x="690" y="-2004.97" font-family="Times,serif" font-size="14.00">Add</text>
<text text-anchor="middle" x="690" y="-1989.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192] x2</text>
<text text-anchor="middle" x="690" y="-1974.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="690" y="-1959.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- pipeline_comm&#45;&gt;residual2 -->
<g id="edge48" class="edge">
<title>pipeline_comm&#45;&gt;residual2</title>
<path fill="none" stroke="black" d="M1054.55,-2527.89C1063.21,-2523.29 1071.55,-2518.07 1079,-2512.17 1152.95,-2453.62 1193,-2427.49 1193,-2333.17 1193,-2333.17 1193,-2333.17 1193,-2227.17 1193,-2147.48 1140.95,-2094.23 1070.33,-2058.65"/>
<polygon fill="black" stroke="black" points="1071.69,-2055.42 1061.17,-2054.18 1068.62,-2061.71 1071.69,-2055.42"/>
</g>
<!-- q_proj_2 -->
<g id="node31" class="node">
<title>q_proj_2</title>
<polygon fill="lightgrey" stroke="black" points="395.5,-2366.17 24.5,-2366.17 24.5,-2298.17 395.5,-2298.17 395.5,-2366.17"/>
<text text-anchor="middle" x="210" y="-2350.97" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="210" y="-2335.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="210" y="-2320.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="210" y="-2305.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (column split)</text>
</g>
<!-- ln2&#45;&gt;q_proj_2 -->
<g id="edge40" class="edge">
<title>ln2&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M698.45,-2409.52C612.37,-2397.35 508.43,-2382.29 405.47,-2366.23"/>
<polygon fill="black" stroke="black" points="405.93,-2362.76 395.51,-2364.67 404.85,-2369.67 405.93,-2362.76"/>
</g>
<!-- k_proj_2 -->
<g id="node32" class="node">
<title>k_proj_2</title>
<polygon fill="lightgrey" stroke="black" points="784.5,-2366.17 413.5,-2366.17 413.5,-2298.17 784.5,-2298.17 784.5,-2366.17"/>
<text text-anchor="middle" x="599" y="-2350.97" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="599" y="-2335.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="599" y="-2320.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="599" y="-2305.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (column split)</text>
</g>
<!-- ln2&#45;&gt;k_proj_2 -->
<g id="edge41" class="edge">
<title>ln2&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M791.47,-2402.05C762.58,-2391.71 730.55,-2380.25 701.04,-2369.69"/>
<polygon fill="black" stroke="black" points="702.15,-2366.37 691.55,-2366.29 699.79,-2372.96 702.15,-2366.37"/>
</g>
<!-- v_proj_2 -->
<g id="node33" class="node">
<title>v_proj_2</title>
<polygon fill="lightgrey" stroke="black" points="1173.5,-2366.17 802.5,-2366.17 802.5,-2298.17 1173.5,-2298.17 1173.5,-2366.17"/>
<text text-anchor="middle" x="988" y="-2350.97" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="988" y="-2335.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="988" y="-2320.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="988" y="-2305.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (column split)</text>
</g>
<!-- ln2&#45;&gt;v_proj_2 -->
<g id="edge42" class="edge">
<title>ln2&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M917.77,-2402.05C927.03,-2392.96 937.18,-2383.01 946.81,-2373.57"/>
<polygon fill="black" stroke="black" points="949.36,-2375.97 954.05,-2366.47 944.46,-2370.97 949.36,-2375.97"/>
</g>
<!-- mha_2 -->
<g id="node34" class="node">
<title>mha_2</title>
<polygon fill="lightgrey" stroke="black" points="819,-2262.17 425,-2262.17 425,-2194.17 819,-2194.17 819,-2262.17"/>
<text text-anchor="middle" x="622" y="-2246.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="622" y="-2231.97" font-family="Times,serif" font-size="14.00">Input QKV: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="622" y="-2216.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="622" y="-2201.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- q_proj_2&#45;&gt;mha_2 -->
<g id="edge43" class="edge">
<title>q_proj_2&#45;&gt;mha_2</title>
<path fill="none" stroke="black" d="M343.48,-2298.12C386.64,-2287.44 434.66,-2275.55 478.51,-2264.69"/>
<polygon fill="black" stroke="black" points="479.51,-2268.05 488.38,-2262.25 477.83,-2261.25 479.51,-2268.05"/>
</g>
<!-- k_proj_2&#45;&gt;mha_2 -->
<g id="edge44" class="edge">
<title>k_proj_2&#45;&gt;mha_2</title>
<path fill="none" stroke="black" d="M606.47,-2298.05C608.32,-2289.86 610.32,-2280.96 612.26,-2272.36"/>
<polygon fill="black" stroke="black" points="615.71,-2272.99 614.49,-2262.47 608.88,-2271.45 615.71,-2272.99"/>
</g>
<!-- v_proj_2&#45;&gt;mha_2 -->
<g id="edge45" class="edge">
<title>v_proj_2&#45;&gt;mha_2</title>
<path fill="none" stroke="black" d="M869.42,-2298.12C831.41,-2287.53 789.14,-2275.75 750.46,-2264.97"/>
<polygon fill="black" stroke="black" points="751.27,-2261.56 740.7,-2262.25 749.39,-2268.3 751.27,-2261.56"/>
</g>
<!-- out_proj_2 -->
<g id="node35" class="node">
<title>out_proj_2</title>
<polygon fill="lightgrey" stroke="black" points="852.5,-2158.17 481.5,-2158.17 481.5,-2090.17 852.5,-2090.17 852.5,-2158.17"/>
<text text-anchor="middle" x="667" y="-2142.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="667" y="-2127.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="667" y="-2112.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="667" y="-2097.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (row split)</text>
</g>
<!-- mha_2&#45;&gt;out_proj_2 -->
<g id="edge46" class="edge">
<title>mha_2&#45;&gt;out_proj_2</title>
<path fill="none" stroke="black" d="M636.61,-2194.05C640.3,-2185.68 644.32,-2176.57 648.19,-2167.8"/>
<polygon fill="black" stroke="black" points="651.47,-2169.03 652.31,-2158.47 645.07,-2166.2 651.47,-2169.03"/>
</g>
<!-- out_proj_2&#45;&gt;residual2 -->
<g id="edge47" class="edge">
<title>out_proj_2&#45;&gt;residual2</title>
<path fill="none" stroke="black" d="M672.63,-2089.9C673.95,-2082.07 675.42,-2073.4 676.92,-2064.52"/>
<polygon fill="black" stroke="black" points="680.41,-2064.87 678.62,-2054.43 673.51,-2063.71 680.41,-2064.87"/>
</g>
<!-- gate_proj_2 -->
<g id="node37" class="node">
<title>gate_proj_2</title>
<polygon fill="lightgrey" stroke="black" points="578.5,-1882.17 207.5,-1882.17 207.5,-1814.17 578.5,-1814.17 578.5,-1882.17"/>
<text text-anchor="middle" x="393" y="-1866.97" font-family="Times,serif" font-size="14.00">Gate Projection</text>
<text text-anchor="middle" x="393" y="-1851.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="393" y="-1836.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="393" y="-1821.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (column split)</text>
</g>
<!-- residual2&#45;&gt;gate_proj_2 -->
<g id="edge49" class="edge">
<title>residual2&#45;&gt;gate_proj_2</title>
<path fill="none" stroke="black" d="M543.68,-1918.16C519.95,-1907.3 496.15,-1896.4 474.7,-1886.58"/>
<polygon fill="black" stroke="black" points="475.89,-1883.28 465.34,-1882.29 472.98,-1889.64 475.89,-1883.28"/>
</g>
<!-- up_proj_2 -->
<g id="node38" class="node">
<title>up_proj_2</title>
<polygon fill="lightgrey" stroke="black" points="875.5,-1778.17 504.5,-1778.17 504.5,-1710.17 875.5,-1710.17 875.5,-1778.17"/>
<text text-anchor="middle" x="690" y="-1762.97" font-family="Times,serif" font-size="14.00">Up Projection</text>
<text text-anchor="middle" x="690" y="-1747.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="690" y="-1732.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="690" y="-1717.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (column split)</text>
</g>
<!-- residual2&#45;&gt;up_proj_2 -->
<g id="edge50" class="edge">
<title>residual2&#45;&gt;up_proj_2</title>
<path fill="none" stroke="black" d="M690,-1917.99C690,-1876.6 690,-1824.72 690,-1788.65"/>
<polygon fill="black" stroke="black" points="693.5,-1788.46 690,-1778.46 686.5,-1788.46 693.5,-1788.46"/>
</g>
<!-- residual_mlp2 -->
<g id="node42" class="node">
<title>residual_mlp2</title>
<polygon fill="lightgrey" stroke="black" points="1171.93,-1466.17 545.27,-1466.17 384.07,-1330.17 1010.73,-1330.17 1171.93,-1466.17"/>
<text text-anchor="middle" x="778" y="-1416.97" font-family="Times,serif" font-size="14.00">Add</text>
<text text-anchor="middle" x="778" y="-1401.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192] x2</text>
<text text-anchor="middle" x="778" y="-1386.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="778" y="-1371.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- residual2&#45;&gt;residual_mlp2 -->
<g id="edge56" class="edge">
<title>residual2&#45;&gt;residual_mlp2</title>
<path fill="none" stroke="black" d="M792.2,-1918.02C843.55,-1875.54 895,-1815.44 895,-1745.17 895,-1745.17 895,-1745.17 895,-1639.17 895,-1578 908.19,-1557.44 882,-1502.17 877.38,-1492.41 871.42,-1483.05 864.71,-1474.23"/>
<polygon fill="black" stroke="black" points="867.33,-1471.9 858.34,-1466.29 861.86,-1476.28 867.33,-1471.9"/>
</g>
<!-- silu_2 -->
<g id="node39" class="node">
<title>silu_2</title>
<polygon fill="lightgrey" stroke="black" points="486.5,-1778.17 115.5,-1778.17 115.5,-1710.17 486.5,-1710.17 486.5,-1778.17"/>
<text text-anchor="middle" x="301" y="-1762.97" font-family="Times,serif" font-size="14.00">SiLU</text>
<text text-anchor="middle" x="301" y="-1747.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="301" y="-1732.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="301" y="-1717.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- gate_proj_2&#45;&gt;silu_2 -->
<g id="edge51" class="edge">
<title>gate_proj_2&#45;&gt;silu_2</title>
<path fill="none" stroke="black" d="M363.13,-1814.05C355.1,-1805.14 346.31,-1795.4 337.94,-1786.12"/>
<polygon fill="black" stroke="black" points="340.33,-1783.55 331.03,-1778.47 335.13,-1788.24 340.33,-1783.55"/>
</g>
<!-- mul_2 -->
<g id="node40" class="node">
<title>mul_2</title>
<polygon fill="lightgrey" stroke="black" points="876,-1674.17 496,-1674.17 496,-1606.17 876,-1606.17 876,-1674.17"/>
<text text-anchor="middle" x="686" y="-1658.97" font-family="Times,serif" font-size="14.00">Elementwise Mul</text>
<text text-anchor="middle" x="686" y="-1643.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=4096] x2</text>
<text text-anchor="middle" x="686" y="-1628.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="686" y="-1613.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- up_proj_2&#45;&gt;mul_2 -->
<g id="edge52" class="edge">
<title>up_proj_2&#45;&gt;mul_2</title>
<path fill="none" stroke="black" d="M688.7,-1710.05C688.38,-1701.94 688.04,-1693.15 687.7,-1684.64"/>
<polygon fill="black" stroke="black" points="691.2,-1684.32 687.31,-1674.47 684.2,-1684.6 691.2,-1684.32"/>
</g>
<!-- silu_2&#45;&gt;mul_2 -->
<g id="edge53" class="edge">
<title>silu_2&#45;&gt;mul_2</title>
<path fill="none" stroke="black" d="M425.73,-1710.12C465.89,-1699.48 510.56,-1687.65 551.39,-1676.83"/>
<polygon fill="black" stroke="black" points="552.37,-1680.19 561.14,-1674.25 550.57,-1673.43 552.37,-1680.19"/>
</g>
<!-- down_proj_2 -->
<g id="node41" class="node">
<title>down_proj_2</title>
<polygon fill="lightgrey" stroke="black" points="872.5,-1570.17 501.5,-1570.17 501.5,-1502.17 872.5,-1502.17 872.5,-1570.17"/>
<text text-anchor="middle" x="687" y="-1554.97" font-family="Times,serif" font-size="14.00">Down Projection</text>
<text text-anchor="middle" x="687" y="-1539.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="687" y="-1524.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="687" y="-1509.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (row split)</text>
</g>
<!-- mul_2&#45;&gt;down_proj_2 -->
<g id="edge54" class="edge">
<title>mul_2&#45;&gt;down_proj_2</title>
<path fill="none" stroke="black" d="M686.32,-1606.05C686.4,-1597.94 686.49,-1589.15 686.57,-1580.64"/>
<polygon fill="black" stroke="black" points="690.08,-1580.5 686.67,-1570.47 683.08,-1580.43 690.08,-1580.5"/>
</g>
<!-- down_proj_2&#45;&gt;residual_mlp2 -->
<g id="edge55" class="edge">
<title>down_proj_2&#45;&gt;residual_mlp2</title>
<path fill="none" stroke="black" d="M709.26,-1501.9C714.84,-1493.56 721.05,-1484.28 727.39,-1474.8"/>
<polygon fill="black" stroke="black" points="730.34,-1476.69 732.99,-1466.43 724.52,-1472.79 730.34,-1476.69"/>
</g>
<!-- ln3 -->
<g id="node43" class="node">
<title>ln3</title>
<polygon fill="lightgrey" stroke="black" points="874.5,-1272.17 503.5,-1272.17 503.5,-1204.17 874.5,-1204.17 874.5,-1272.17"/>
<text text-anchor="middle" x="689" y="-1256.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="689" y="-1241.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="689" y="-1226.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="689" y="-1211.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- residual_mlp2&#45;&gt;ln3 -->
<g id="edge57" class="edge">
<title>residual_mlp2&#45;&gt;ln3</title>
<path fill="none" stroke="black" d="M740.26,-1330.16C730.92,-1313.58 721.17,-1296.28 712.72,-1281.28"/>
<polygon fill="black" stroke="black" points="715.6,-1279.25 707.64,-1272.26 709.5,-1282.69 715.6,-1279.25"/>
</g>
<!-- residual3 -->
<g id="node49" class="node">
<title>residual3</title>
<polygon fill="lightgrey" stroke="black" points="1150.93,-856.17 524.27,-856.17 363.07,-720.17 989.73,-720.17 1150.93,-856.17"/>
<text text-anchor="middle" x="757" y="-806.97" font-family="Times,serif" font-size="14.00">Add</text>
<text text-anchor="middle" x="757" y="-791.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192] x2</text>
<text text-anchor="middle" x="757" y="-776.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="757" y="-761.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- residual_mlp2&#45;&gt;residual3 -->
<g id="edge66" class="edge">
<title>residual_mlp2&#45;&gt;residual3</title>
<path fill="none" stroke="black" d="M1017,-1335.45C1109.25,-1295.98 1193,-1233.15 1193,-1135.17 1193,-1135.17 1193,-1135.17 1193,-1029.17 1193,-949.83 1136.91,-896.53 1064.96,-860.79"/>
<polygon fill="black" stroke="black" points="1066.17,-857.49 1055.65,-856.3 1063.13,-863.8 1066.17,-857.49"/>
</g>
<!-- q_proj_3 -->
<g id="node44" class="node">
<title>q_proj_3</title>
<polygon fill="lightgrey" stroke="black" points="395.5,-1168.17 24.5,-1168.17 24.5,-1100.17 395.5,-1100.17 395.5,-1168.17"/>
<text text-anchor="middle" x="210" y="-1152.97" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="210" y="-1137.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="210" y="-1122.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="210" y="-1107.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (column split)</text>
</g>
<!-- ln3&#45;&gt;q_proj_3 -->
<g id="edge58" class="edge">
<title>ln3&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M533.81,-1204.12C483.11,-1193.32 426.63,-1181.3 375.22,-1170.35"/>
<polygon fill="black" stroke="black" points="375.86,-1166.91 365.35,-1168.25 374.4,-1173.75 375.86,-1166.91"/>
</g>
<!-- k_proj_3 -->
<g id="node45" class="node">
<title>k_proj_3</title>
<polygon fill="lightgrey" stroke="black" points="784.5,-1168.17 413.5,-1168.17 413.5,-1100.17 784.5,-1100.17 784.5,-1168.17"/>
<text text-anchor="middle" x="599" y="-1152.97" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="599" y="-1137.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="599" y="-1122.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="599" y="-1107.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (column split)</text>
</g>
<!-- ln3&#45;&gt;k_proj_3 -->
<g id="edge59" class="edge">
<title>ln3&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M659.78,-1204.05C651.92,-1195.14 643.33,-1185.4 635.14,-1176.12"/>
<polygon fill="black" stroke="black" points="637.62,-1173.65 628.38,-1168.47 632.37,-1178.28 637.62,-1173.65"/>
</g>
<!-- v_proj_3 -->
<g id="node46" class="node">
<title>v_proj_3</title>
<polygon fill="lightgrey" stroke="black" points="1173.5,-1168.17 802.5,-1168.17 802.5,-1100.17 1173.5,-1100.17 1173.5,-1168.17"/>
<text text-anchor="middle" x="988" y="-1152.97" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="988" y="-1137.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="988" y="-1122.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="988" y="-1107.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (column split)</text>
</g>
<!-- ln3&#45;&gt;v_proj_3 -->
<g id="edge60" class="edge">
<title>ln3&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M786.08,-1204.05C816.6,-1193.64 850.46,-1182.09 881.59,-1171.47"/>
<polygon fill="black" stroke="black" points="882.82,-1174.75 891.15,-1168.2 880.56,-1168.12 882.82,-1174.75"/>
</g>
<!-- mha_3 -->
<g id="node47" class="node">
<title>mha_3</title>
<polygon fill="lightgrey" stroke="black" points="819,-1064.17 425,-1064.17 425,-996.17 819,-996.17 819,-1064.17"/>
<text text-anchor="middle" x="622" y="-1048.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="622" y="-1033.97" font-family="Times,serif" font-size="14.00">Input QKV: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="622" y="-1018.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="622" y="-1003.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- q_proj_3&#45;&gt;mha_3 -->
<g id="edge61" class="edge">
<title>q_proj_3&#45;&gt;mha_3</title>
<path fill="none" stroke="black" d="M343.48,-1100.12C386.64,-1089.44 434.66,-1077.55 478.51,-1066.69"/>
<polygon fill="black" stroke="black" points="479.51,-1070.05 488.38,-1064.25 477.83,-1063.25 479.51,-1070.05"/>
</g>
<!-- k_proj_3&#45;&gt;mha_3 -->
<g id="edge62" class="edge">
<title>k_proj_3&#45;&gt;mha_3</title>
<path fill="none" stroke="black" d="M606.47,-1100.05C608.32,-1091.86 610.32,-1082.96 612.26,-1074.36"/>
<polygon fill="black" stroke="black" points="615.71,-1074.99 614.49,-1064.47 608.88,-1073.45 615.71,-1074.99"/>
</g>
<!-- v_proj_3&#45;&gt;mha_3 -->
<g id="edge63" class="edge">
<title>v_proj_3&#45;&gt;mha_3</title>
<path fill="none" stroke="black" d="M869.42,-1100.12C831.41,-1089.53 789.14,-1077.75 750.46,-1066.97"/>
<polygon fill="black" stroke="black" points="751.27,-1063.56 740.7,-1064.25 749.39,-1070.3 751.27,-1063.56"/>
</g>
<!-- out_proj_3 -->
<g id="node48" class="node">
<title>out_proj_3</title>
<polygon fill="lightgrey" stroke="black" points="897.5,-960.17 526.5,-960.17 526.5,-892.17 897.5,-892.17 897.5,-960.17"/>
<text text-anchor="middle" x="712" y="-944.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="712" y="-929.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=1024]</text>
<text text-anchor="middle" x="712" y="-914.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="712" y="-899.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (row split)</text>
</g>
<!-- mha_3&#45;&gt;out_proj_3 -->
<g id="edge64" class="edge">
<title>mha_3&#45;&gt;out_proj_3</title>
<path fill="none" stroke="black" d="M651.22,-996.05C659.08,-987.14 667.67,-977.4 675.86,-968.12"/>
<polygon fill="black" stroke="black" points="678.63,-970.28 682.62,-960.47 673.38,-965.65 678.63,-970.28"/>
</g>
<!-- out_proj_3&#45;&gt;residual3 -->
<g id="edge65" class="edge">
<title>out_proj_3&#45;&gt;residual3</title>
<path fill="none" stroke="black" d="M723.01,-891.9C725.65,-883.9 728.59,-875.03 731.6,-865.95"/>
<polygon fill="black" stroke="black" points="734.93,-867.02 734.74,-856.43 728.28,-864.82 734.93,-867.02"/>
</g>
<!-- gate_proj_3 -->
<g id="node50" class="node">
<title>gate_proj_3</title>
<polygon fill="lightgrey" stroke="black" points="645.5,-684.17 274.5,-684.17 274.5,-616.17 645.5,-616.17 645.5,-684.17"/>
<text text-anchor="middle" x="460" y="-668.97" font-family="Times,serif" font-size="14.00">Gate Projection</text>
<text text-anchor="middle" x="460" y="-653.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="460" y="-638.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="460" y="-623.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (column split)</text>
</g>
<!-- residual3&#45;&gt;gate_proj_3 -->
<g id="edge67" class="edge">
<title>residual3&#45;&gt;gate_proj_3</title>
<path fill="none" stroke="black" d="M610.68,-720.16C586.95,-709.3 563.15,-698.4 541.7,-688.58"/>
<polygon fill="black" stroke="black" points="542.89,-685.28 532.34,-684.29 539.98,-691.64 542.89,-685.28"/>
</g>
<!-- up_proj_3 -->
<g id="node51" class="node">
<title>up_proj_3</title>
<polygon fill="lightgrey" stroke="black" points="942.5,-580.17 571.5,-580.17 571.5,-512.17 942.5,-512.17 942.5,-580.17"/>
<text text-anchor="middle" x="757" y="-564.97" font-family="Times,serif" font-size="14.00">Up Projection</text>
<text text-anchor="middle" x="757" y="-549.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="757" y="-534.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="757" y="-519.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (column split)</text>
</g>
<!-- residual3&#45;&gt;up_proj_3 -->
<g id="edge68" class="edge">
<title>residual3&#45;&gt;up_proj_3</title>
<path fill="none" stroke="black" d="M757,-719.99C757,-678.6 757,-626.72 757,-590.65"/>
<polygon fill="black" stroke="black" points="760.5,-590.46 757,-580.46 753.5,-590.46 760.5,-590.46"/>
</g>
<!-- residual_mlp3 -->
<g id="node55" class="node">
<title>residual_mlp3</title>
<polygon fill="lightgrey" stroke="black" points="1149.93,-268.17 523.27,-268.17 362.07,-132.17 988.73,-132.17 1149.93,-268.17"/>
<text text-anchor="middle" x="756" y="-218.97" font-family="Times,serif" font-size="14.00">Add</text>
<text text-anchor="middle" x="756" y="-203.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192] x2</text>
<text text-anchor="middle" x="756" y="-188.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="756" y="-173.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- residual3&#45;&gt;residual_mlp3 -->
<g id="edge74" class="edge">
<title>residual3&#45;&gt;residual_mlp3</title>
<path fill="none" stroke="black" d="M859.2,-720.02C910.55,-677.54 962,-617.44 962,-547.17 962,-547.17 962,-547.17 962,-441.17 962,-380 982.91,-355.07 949,-304.17 941.79,-293.34 933.04,-283.56 923.32,-274.75"/>
<polygon fill="black" stroke="black" points="925.56,-272.06 915.69,-268.2 920.99,-277.37 925.56,-272.06"/>
</g>
<!-- silu_3 -->
<g id="node52" class="node">
<title>silu_3</title>
<polygon fill="lightgrey" stroke="black" points="553.5,-580.17 182.5,-580.17 182.5,-512.17 553.5,-512.17 553.5,-580.17"/>
<text text-anchor="middle" x="368" y="-564.97" font-family="Times,serif" font-size="14.00">SiLU</text>
<text text-anchor="middle" x="368" y="-549.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="368" y="-534.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="368" y="-519.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- gate_proj_3&#45;&gt;silu_3 -->
<g id="edge69" class="edge">
<title>gate_proj_3&#45;&gt;silu_3</title>
<path fill="none" stroke="black" d="M430.13,-616.05C422.1,-607.14 413.31,-597.4 404.94,-588.12"/>
<polygon fill="black" stroke="black" points="407.33,-585.55 398.03,-580.47 402.13,-590.24 407.33,-585.55"/>
</g>
<!-- mul_3 -->
<g id="node53" class="node">
<title>mul_3</title>
<polygon fill="lightgrey" stroke="black" points="943,-476.17 563,-476.17 563,-408.17 943,-408.17 943,-476.17"/>
<text text-anchor="middle" x="753" y="-460.97" font-family="Times,serif" font-size="14.00">Elementwise Mul</text>
<text text-anchor="middle" x="753" y="-445.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=4096] x2</text>
<text text-anchor="middle" x="753" y="-430.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="753" y="-415.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- up_proj_3&#45;&gt;mul_3 -->
<g id="edge70" class="edge">
<title>up_proj_3&#45;&gt;mul_3</title>
<path fill="none" stroke="black" d="M755.7,-512.05C755.38,-503.94 755.04,-495.15 754.7,-486.64"/>
<polygon fill="black" stroke="black" points="758.2,-486.32 754.31,-476.47 751.2,-486.6 758.2,-486.32"/>
</g>
<!-- silu_3&#45;&gt;mul_3 -->
<g id="edge71" class="edge">
<title>silu_3&#45;&gt;mul_3</title>
<path fill="none" stroke="black" d="M492.73,-512.12C532.89,-501.48 577.56,-489.65 618.39,-478.83"/>
<polygon fill="black" stroke="black" points="619.37,-482.19 628.14,-476.25 617.57,-475.43 619.37,-482.19"/>
</g>
<!-- down_proj_3 -->
<g id="node54" class="node">
<title>down_proj_3</title>
<polygon fill="lightgrey" stroke="black" points="939.5,-372.17 568.5,-372.17 568.5,-304.17 939.5,-304.17 939.5,-372.17"/>
<text text-anchor="middle" x="754" y="-356.97" font-family="Times,serif" font-size="14.00">Down Projection</text>
<text text-anchor="middle" x="754" y="-341.97" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="754" y="-326.97" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="754" y="-311.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (row split)</text>
</g>
<!-- mul_3&#45;&gt;down_proj_3 -->
<g id="edge72" class="edge">
<title>mul_3&#45;&gt;down_proj_3</title>
<path fill="none" stroke="black" d="M753.32,-408.05C753.4,-399.94 753.49,-391.15 753.57,-382.64"/>
<polygon fill="black" stroke="black" points="757.08,-382.5 753.67,-372.47 750.08,-382.43 757.08,-382.5"/>
</g>
<!-- down_proj_3&#45;&gt;residual_mlp3 -->
<g id="edge73" class="edge">
<title>down_proj_3&#45;&gt;residual_mlp3</title>
<path fill="none" stroke="black" d="M754.49,-303.9C754.6,-296.07 754.73,-287.4 754.86,-278.52"/>
<polygon fill="black" stroke="black" points="758.36,-278.48 755.01,-268.43 751.36,-278.38 758.36,-278.48"/>
</g>
<!-- output -->
<g id="node56" class="node">
<title>output</title>
<ellipse fill="lightgrey" stroke="black" cx="756" cy="-48.08" rx="253.7" ry="48.17"/>
<text text-anchor="middle" x="756" y="-66.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="756" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="756" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch=1024, seq=10000, vocab_size]</text>
<text text-anchor="middle" x="756" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- residual_mlp3&#45;&gt;output -->
<g id="edge75" class="edge">
<title>residual_mlp3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M756,-132.03C756,-123.48 756,-114.8 756,-106.43"/>
<polygon fill="black" stroke="black" points="759.5,-106.4 756,-96.4 752.5,-106.4 759.5,-106.4"/>
</g>
</g>
</svg>
