// 30B-MoE Model Deployment DAG
digraph {
	fontsize=10 rankdir=TB splines=ortho
	node [fillcolor=lightblue shape=rectangle style=filled]
	node [fillcolor=lightgreen shape=ellipse style=filled]
	node [fillcolor=lightyellow shape=parallelogram style=filled]
	input [label="GPU 0\nInput\nInput: [batch_size=128, seq_len=10240, hidden=1024]\nOutput: [batch_size=128, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_0_attn [label="GPU 0\nLayer 0 Self-Attention\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	input -> layer_0_attn [style=solid]
	layer_0_moe [label="GPU 0\nLayer 0 MoE Layer\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_0_attn -> layer_0_moe [style=solid]
	layer_0_gate [label="GPU 0\nExpert Gate (Top-2)\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, experts=2]" shape=parallelogram]
	layer_0_attn -> layer_0_gate [style=solid]
	layer_0_expert_0 [label="GPU 0\nExpert 0 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_0 [style=dashed]
	layer_0_expert_1 [label="GPU 0\nExpert 1 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_1 [style=dashed]
	layer_0_expert_2 [label="GPU 0\nExpert 2 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_2 [style=dashed]
	layer_0_expert_3 [label="GPU 0\nExpert 3 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_3 [style=dashed]
	layer_0_expert_4 [label="GPU 8\nExpert 4 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_4 [style=dashed]
	layer_0_expert_4_comm [label="GPU 8\nExpert Communication" shape=ellipse]
	layer_0_expert_4_comm -> layer_0_expert_4 [style=solid]
	layer_0_expert_5 [label="GPU 8\nExpert 5 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_5 [style=dashed]
	layer_0_expert_5_comm [label="GPU 8\nExpert Communication" shape=ellipse]
	layer_0_expert_5_comm -> layer_0_expert_5 [style=solid]
	layer_0_expert_6 [label="GPU 8\nExpert 6 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_6 [style=dashed]
	layer_0_expert_6_comm [label="GPU 8\nExpert Communication" shape=ellipse]
	layer_0_expert_6_comm -> layer_0_expert_6 [style=solid]
	layer_0_expert_7 [label="GPU 8\nExpert 7 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_7 [style=dashed]
	layer_0_expert_7_comm [label="GPU 8\nExpert Communication" shape=ellipse]
	layer_0_expert_7_comm -> layer_0_expert_7 [style=solid]
	layer_0_expert_8 [label="GPU 16\nExpert 8 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_8 [style=dashed]
	layer_0_expert_8_comm [label="GPU 16\nExpert Communication" shape=ellipse]
	layer_0_expert_8_comm -> layer_0_expert_8 [style=solid]
	layer_0_expert_9 [label="GPU 16\nExpert 9 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_9 [style=dashed]
	layer_0_expert_9_comm [label="GPU 16\nExpert Communication" shape=ellipse]
	layer_0_expert_9_comm -> layer_0_expert_9 [style=solid]
	layer_0_expert_10 [label="GPU 16\nExpert 10 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_10 [style=dashed]
	layer_0_expert_10_comm [label="GPU 16\nExpert Communication" shape=ellipse]
	layer_0_expert_10_comm -> layer_0_expert_10 [style=solid]
	layer_0_expert_11 [label="GPU 16\nExpert 11 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_11 [style=dashed]
	layer_0_expert_11_comm [label="GPU 16\nExpert Communication" shape=ellipse]
	layer_0_expert_11_comm -> layer_0_expert_11 [style=solid]
	layer_0_expert_12 [label="GPU 24\nExpert 12 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_12 [style=dashed]
	layer_0_expert_12_comm [label="GPU 24\nExpert Communication" shape=ellipse]
	layer_0_expert_12_comm -> layer_0_expert_12 [style=solid]
	layer_0_expert_13 [label="GPU 24\nExpert 13 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_13 [style=dashed]
	layer_0_expert_13_comm [label="GPU 24\nExpert Communication" shape=ellipse]
	layer_0_expert_13_comm -> layer_0_expert_13 [style=solid]
	layer_0_expert_14 [label="GPU 24\nExpert 14 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_14 [style=dashed]
	layer_0_expert_14_comm [label="GPU 24\nExpert Communication" shape=ellipse]
	layer_0_expert_14_comm -> layer_0_expert_14 [style=solid]
	layer_0_expert_15 [label="GPU 24\nExpert 15 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_15 [style=dashed]
	layer_0_expert_15_comm [label="GPU 24\nExpert Communication" shape=ellipse]
	layer_0_expert_15_comm -> layer_0_expert_15 [style=solid]
	layer_0_expert_16 [label="GPU 32\nExpert 16 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_16 [style=dashed]
	layer_0_expert_16_comm [label="GPU 32\nExpert Communication" shape=ellipse]
	layer_0_expert_16_comm -> layer_0_expert_16 [style=solid]
	layer_0_expert_17 [label="GPU 32\nExpert 17 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_17 [style=dashed]
	layer_0_expert_17_comm [label="GPU 32\nExpert Communication" shape=ellipse]
	layer_0_expert_17_comm -> layer_0_expert_17 [style=solid]
	layer_0_expert_18 [label="GPU 32\nExpert 18 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_18 [style=dashed]
	layer_0_expert_18_comm [label="GPU 32\nExpert Communication" shape=ellipse]
	layer_0_expert_18_comm -> layer_0_expert_18 [style=solid]
	layer_0_expert_19 [label="GPU 32\nExpert 19 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_19 [style=dashed]
	layer_0_expert_19_comm [label="GPU 32\nExpert Communication" shape=ellipse]
	layer_0_expert_19_comm -> layer_0_expert_19 [style=solid]
	layer_0_expert_20 [label="GPU 40\nExpert 20 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_20 [style=dashed]
	layer_0_expert_20_comm [label="GPU 40\nExpert Communication" shape=ellipse]
	layer_0_expert_20_comm -> layer_0_expert_20 [style=solid]
	layer_0_expert_21 [label="GPU 40\nExpert 21 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_21 [style=dashed]
	layer_0_expert_21_comm [label="GPU 40\nExpert Communication" shape=ellipse]
	layer_0_expert_21_comm -> layer_0_expert_21 [style=solid]
	layer_0_expert_22 [label="GPU 40\nExpert 22 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_22 [style=dashed]
	layer_0_expert_22_comm [label="GPU 40\nExpert Communication" shape=ellipse]
	layer_0_expert_22_comm -> layer_0_expert_22 [style=solid]
	layer_0_expert_23 [label="GPU 40\nExpert 23 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_23 [style=dashed]
	layer_0_expert_23_comm [label="GPU 40\nExpert Communication" shape=ellipse]
	layer_0_expert_23_comm -> layer_0_expert_23 [style=solid]
	layer_0_expert_24 [label="GPU 48\nExpert 24 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_24 [style=dashed]
	layer_0_expert_24_comm [label="GPU 48\nExpert Communication" shape=ellipse]
	layer_0_expert_24_comm -> layer_0_expert_24 [style=solid]
	layer_0_expert_25 [label="GPU 48\nExpert 25 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_25 [style=dashed]
	layer_0_expert_25_comm [label="GPU 48\nExpert Communication" shape=ellipse]
	layer_0_expert_25_comm -> layer_0_expert_25 [style=solid]
	layer_0_expert_26 [label="GPU 48\nExpert 26 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_26 [style=dashed]
	layer_0_expert_26_comm [label="GPU 48\nExpert Communication" shape=ellipse]
	layer_0_expert_26_comm -> layer_0_expert_26 [style=solid]
	layer_0_expert_27 [label="GPU 48\nExpert 27 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_27 [style=dashed]
	layer_0_expert_27_comm [label="GPU 48\nExpert Communication" shape=ellipse]
	layer_0_expert_27_comm -> layer_0_expert_27 [style=solid]
	layer_0_expert_28 [label="GPU 56\nExpert 28 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_28 [style=dashed]
	layer_0_expert_28_comm [label="GPU 56\nExpert Communication" shape=ellipse]
	layer_0_expert_28_comm -> layer_0_expert_28 [style=solid]
	layer_0_expert_29 [label="GPU 56\nExpert 29 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_29 [style=dashed]
	layer_0_expert_29_comm [label="GPU 56\nExpert Communication" shape=ellipse]
	layer_0_expert_29_comm -> layer_0_expert_29 [style=solid]
	layer_0_expert_30 [label="GPU 56\nExpert 30 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_30 [style=dashed]
	layer_0_expert_30_comm [label="GPU 56\nExpert Communication" shape=ellipse]
	layer_0_expert_30_comm -> layer_0_expert_30 [style=solid]
	layer_0_expert_31 [label="GPU 56\nExpert 31 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_31 [style=dashed]
	layer_0_expert_31_comm [label="GPU 56\nExpert Communication" shape=ellipse]
	layer_0_expert_31_comm -> layer_0_expert_31 [style=solid]
	layer_0_expert_32 [label="GPU 64\nExpert 32 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_32 [style=dashed]
	layer_0_expert_32_comm [label="GPU 64\nExpert Communication" shape=ellipse]
	layer_0_expert_32_comm -> layer_0_expert_32 [style=solid]
	layer_0_expert_33 [label="GPU 64\nExpert 33 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_33 [style=dashed]
	layer_0_expert_33_comm [label="GPU 64\nExpert Communication" shape=ellipse]
	layer_0_expert_33_comm -> layer_0_expert_33 [style=solid]
	layer_0_expert_34 [label="GPU 64\nExpert 34 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_34 [style=dashed]
	layer_0_expert_34_comm [label="GPU 64\nExpert Communication" shape=ellipse]
	layer_0_expert_34_comm -> layer_0_expert_34 [style=solid]
	layer_0_expert_35 [label="GPU 64\nExpert 35 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_35 [style=dashed]
	layer_0_expert_35_comm [label="GPU 64\nExpert Communication" shape=ellipse]
	layer_0_expert_35_comm -> layer_0_expert_35 [style=solid]
	layer_0_expert_36 [label="GPU 72\nExpert 36 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_36 [style=dashed]
	layer_0_expert_36_comm [label="GPU 72\nExpert Communication" shape=ellipse]
	layer_0_expert_36_comm -> layer_0_expert_36 [style=solid]
	layer_0_expert_37 [label="GPU 72\nExpert 37 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_37 [style=dashed]
	layer_0_expert_37_comm [label="GPU 72\nExpert Communication" shape=ellipse]
	layer_0_expert_37_comm -> layer_0_expert_37 [style=solid]
	layer_0_expert_38 [label="GPU 72\nExpert 38 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_38 [style=dashed]
	layer_0_expert_38_comm [label="GPU 72\nExpert Communication" shape=ellipse]
	layer_0_expert_38_comm -> layer_0_expert_38 [style=solid]
	layer_0_expert_39 [label="GPU 72\nExpert 39 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_39 [style=dashed]
	layer_0_expert_39_comm [label="GPU 72\nExpert Communication" shape=ellipse]
	layer_0_expert_39_comm -> layer_0_expert_39 [style=solid]
	layer_0_expert_40 [label="GPU 80\nExpert 40 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_40 [style=dashed]
	layer_0_expert_40_comm [label="GPU 80\nExpert Communication" shape=ellipse]
	layer_0_expert_40_comm -> layer_0_expert_40 [style=solid]
	layer_0_expert_41 [label="GPU 80\nExpert 41 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_41 [style=dashed]
	layer_0_expert_41_comm [label="GPU 80\nExpert Communication" shape=ellipse]
	layer_0_expert_41_comm -> layer_0_expert_41 [style=solid]
	layer_0_expert_42 [label="GPU 80\nExpert 42 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_42 [style=dashed]
	layer_0_expert_42_comm [label="GPU 80\nExpert Communication" shape=ellipse]
	layer_0_expert_42_comm -> layer_0_expert_42 [style=solid]
	layer_0_expert_43 [label="GPU 80\nExpert 43 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_43 [style=dashed]
	layer_0_expert_43_comm [label="GPU 80\nExpert Communication" shape=ellipse]
	layer_0_expert_43_comm -> layer_0_expert_43 [style=solid]
	layer_0_expert_44 [label="GPU 88\nExpert 44 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_44 [style=dashed]
	layer_0_expert_44_comm [label="GPU 88\nExpert Communication" shape=ellipse]
	layer_0_expert_44_comm -> layer_0_expert_44 [style=solid]
	layer_0_expert_45 [label="GPU 88\nExpert 45 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_45 [style=dashed]
	layer_0_expert_45_comm [label="GPU 88\nExpert Communication" shape=ellipse]
	layer_0_expert_45_comm -> layer_0_expert_45 [style=solid]
	layer_0_expert_46 [label="GPU 88\nExpert 46 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_46 [style=dashed]
	layer_0_expert_46_comm [label="GPU 88\nExpert Communication" shape=ellipse]
	layer_0_expert_46_comm -> layer_0_expert_46 [style=solid]
	layer_0_expert_47 [label="GPU 88\nExpert 47 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_47 [style=dashed]
	layer_0_expert_47_comm [label="GPU 88\nExpert Communication" shape=ellipse]
	layer_0_expert_47_comm -> layer_0_expert_47 [style=solid]
	layer_0_expert_48 [label="GPU 96\nExpert 48 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_48 [style=dashed]
	layer_0_expert_48_comm [label="GPU 96\nExpert Communication" shape=ellipse]
	layer_0_expert_48_comm -> layer_0_expert_48 [style=solid]
	layer_0_expert_49 [label="GPU 96\nExpert 49 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_49 [style=dashed]
	layer_0_expert_49_comm [label="GPU 96\nExpert Communication" shape=ellipse]
	layer_0_expert_49_comm -> layer_0_expert_49 [style=solid]
	layer_0_expert_50 [label="GPU 96\nExpert 50 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_50 [style=dashed]
	layer_0_expert_50_comm [label="GPU 96\nExpert Communication" shape=ellipse]
	layer_0_expert_50_comm -> layer_0_expert_50 [style=solid]
	layer_0_expert_51 [label="GPU 96\nExpert 51 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_51 [style=dashed]
	layer_0_expert_51_comm [label="GPU 96\nExpert Communication" shape=ellipse]
	layer_0_expert_51_comm -> layer_0_expert_51 [style=solid]
	layer_0_expert_52 [label="GPU 104\nExpert 52 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_52 [style=dashed]
	layer_0_expert_52_comm [label="GPU 104\nExpert Communication" shape=ellipse]
	layer_0_expert_52_comm -> layer_0_expert_52 [style=solid]
	layer_0_expert_53 [label="GPU 104\nExpert 53 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_53 [style=dashed]
	layer_0_expert_53_comm [label="GPU 104\nExpert Communication" shape=ellipse]
	layer_0_expert_53_comm -> layer_0_expert_53 [style=solid]
	layer_0_expert_54 [label="GPU 104\nExpert 54 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_54 [style=dashed]
	layer_0_expert_54_comm [label="GPU 104\nExpert Communication" shape=ellipse]
	layer_0_expert_54_comm -> layer_0_expert_54 [style=solid]
	layer_0_expert_55 [label="GPU 104\nExpert 55 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_55 [style=dashed]
	layer_0_expert_55_comm [label="GPU 104\nExpert Communication" shape=ellipse]
	layer_0_expert_55_comm -> layer_0_expert_55 [style=solid]
	layer_0_expert_56 [label="GPU 112\nExpert 56 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_56 [style=dashed]
	layer_0_expert_56_comm [label="GPU 112\nExpert Communication" shape=ellipse]
	layer_0_expert_56_comm -> layer_0_expert_56 [style=solid]
	layer_0_expert_57 [label="GPU 112\nExpert 57 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_57 [style=dashed]
	layer_0_expert_57_comm [label="GPU 112\nExpert Communication" shape=ellipse]
	layer_0_expert_57_comm -> layer_0_expert_57 [style=solid]
	layer_0_expert_58 [label="GPU 112\nExpert 58 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_58 [style=dashed]
	layer_0_expert_58_comm [label="GPU 112\nExpert Communication" shape=ellipse]
	layer_0_expert_58_comm -> layer_0_expert_58 [style=solid]
	layer_0_expert_59 [label="GPU 112\nExpert 59 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_59 [style=dashed]
	layer_0_expert_59_comm [label="GPU 112\nExpert Communication" shape=ellipse]
	layer_0_expert_59_comm -> layer_0_expert_59 [style=solid]
	layer_0_expert_60 [label="GPU 120\nExpert 60 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_60 [style=dashed]
	layer_0_expert_60_comm [label="GPU 120\nExpert Communication" shape=ellipse]
	layer_0_expert_60_comm -> layer_0_expert_60 [style=solid]
	layer_0_expert_61 [label="GPU 120\nExpert 61 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_61 [style=dashed]
	layer_0_expert_61_comm [label="GPU 120\nExpert Communication" shape=ellipse]
	layer_0_expert_61_comm -> layer_0_expert_61 [style=solid]
	layer_0_expert_62 [label="GPU 120\nExpert 62 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_62 [style=dashed]
	layer_0_expert_62_comm [label="GPU 120\nExpert Communication" shape=ellipse]
	layer_0_expert_62_comm -> layer_0_expert_62 [style=solid]
	layer_0_expert_63 [label="GPU 120\nExpert 63 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_0_gate -> layer_0_expert_63 [style=dashed]
	layer_0_expert_63_comm [label="GPU 120\nExpert Communication" shape=ellipse]
	layer_0_expert_63_comm -> layer_0_expert_63 [style=solid]
	layer_0_expert_agg [label="GPU 0\nExpert Aggregation (Weighted Sum)\nInput: [batch_size=16, seq_len=10240, experts=64, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=parallelogram]
	layer_0_expert_0 -> layer_0_expert_agg [style=solid]
	layer_0_expert_1 -> layer_0_expert_agg [style=solid]
	layer_0_expert_2 -> layer_0_expert_agg [style=solid]
	layer_0_expert_3 -> layer_0_expert_agg [style=solid]
	layer_0_expert_4 -> layer_0_expert_agg [style=solid]
	layer_0_expert_5 -> layer_0_expert_agg [style=solid]
	layer_0_expert_6 -> layer_0_expert_agg [style=solid]
	layer_0_expert_7 -> layer_0_expert_agg [style=solid]
	layer_0_expert_8 -> layer_0_expert_agg [style=solid]
	layer_0_expert_9 -> layer_0_expert_agg [style=solid]
	layer_0_expert_10 -> layer_0_expert_agg [style=solid]
	layer_0_expert_11 -> layer_0_expert_agg [style=solid]
	layer_0_expert_12 -> layer_0_expert_agg [style=solid]
	layer_0_expert_13 -> layer_0_expert_agg [style=solid]
	layer_0_expert_14 -> layer_0_expert_agg [style=solid]
	layer_0_expert_15 -> layer_0_expert_agg [style=solid]
	layer_0_expert_16 -> layer_0_expert_agg [style=solid]
	layer_0_expert_17 -> layer_0_expert_agg [style=solid]
	layer_0_expert_18 -> layer_0_expert_agg [style=solid]
	layer_0_expert_19 -> layer_0_expert_agg [style=solid]
	layer_0_expert_20 -> layer_0_expert_agg [style=solid]
	layer_0_expert_21 -> layer_0_expert_agg [style=solid]
	layer_0_expert_22 -> layer_0_expert_agg [style=solid]
	layer_0_expert_23 -> layer_0_expert_agg [style=solid]
	layer_0_expert_24 -> layer_0_expert_agg [style=solid]
	layer_0_expert_25 -> layer_0_expert_agg [style=solid]
	layer_0_expert_26 -> layer_0_expert_agg [style=solid]
	layer_0_expert_27 -> layer_0_expert_agg [style=solid]
	layer_0_expert_28 -> layer_0_expert_agg [style=solid]
	layer_0_expert_29 -> layer_0_expert_agg [style=solid]
	layer_0_expert_30 -> layer_0_expert_agg [style=solid]
	layer_0_expert_31 -> layer_0_expert_agg [style=solid]
	layer_0_expert_32 -> layer_0_expert_agg [style=solid]
	layer_0_expert_33 -> layer_0_expert_agg [style=solid]
	layer_0_expert_34 -> layer_0_expert_agg [style=solid]
	layer_0_expert_35 -> layer_0_expert_agg [style=solid]
	layer_0_expert_36 -> layer_0_expert_agg [style=solid]
	layer_0_expert_37 -> layer_0_expert_agg [style=solid]
	layer_0_expert_38 -> layer_0_expert_agg [style=solid]
	layer_0_expert_39 -> layer_0_expert_agg [style=solid]
	layer_0_expert_40 -> layer_0_expert_agg [style=solid]
	layer_0_expert_41 -> layer_0_expert_agg [style=solid]
	layer_0_expert_42 -> layer_0_expert_agg [style=solid]
	layer_0_expert_43 -> layer_0_expert_agg [style=solid]
	layer_0_expert_44 -> layer_0_expert_agg [style=solid]
	layer_0_expert_45 -> layer_0_expert_agg [style=solid]
	layer_0_expert_46 -> layer_0_expert_agg [style=solid]
	layer_0_expert_47 -> layer_0_expert_agg [style=solid]
	layer_0_expert_48 -> layer_0_expert_agg [style=solid]
	layer_0_expert_49 -> layer_0_expert_agg [style=solid]
	layer_0_expert_50 -> layer_0_expert_agg [style=solid]
	layer_0_expert_51 -> layer_0_expert_agg [style=solid]
	layer_0_expert_52 -> layer_0_expert_agg [style=solid]
	layer_0_expert_53 -> layer_0_expert_agg [style=solid]
	layer_0_expert_54 -> layer_0_expert_agg [style=solid]
	layer_0_expert_55 -> layer_0_expert_agg [style=solid]
	layer_0_expert_56 -> layer_0_expert_agg [style=solid]
	layer_0_expert_57 -> layer_0_expert_agg [style=solid]
	layer_0_expert_58 -> layer_0_expert_agg [style=solid]
	layer_0_expert_59 -> layer_0_expert_agg [style=solid]
	layer_0_expert_60 -> layer_0_expert_agg [style=solid]
	layer_0_expert_61 -> layer_0_expert_agg [style=solid]
	layer_0_expert_62 -> layer_0_expert_agg [style=solid]
	layer_0_expert_63 -> layer_0_expert_agg [style=solid]
	layer_0_expert_agg -> layer_0_moe [style=solid]
	layer_0_norm [label="GPU 0\nLayer Normalization\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_0_moe -> layer_0_norm [style=solid]
	layer_0_dp_comm [label="GPU 0\nData Parallel All-Reduce" shape=ellipse]
	layer_0_norm -> layer_0_dp_comm [style=solid]
	layer_0_dp_comm -> layer_1_attn [style=solid]
	layer_1_attn [label="GPU 0\nLayer 1 Self-Attention\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_1_attn_comm [label="GPU 0\nAttention Communication" shape=ellipse]
	layer_0_attn -> layer_1_attn_comm [style=solid]
	layer_1_attn_comm -> layer_1_attn [style=solid]
	layer_1_moe [label="GPU 0\nLayer 1 MoE Layer\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_1_attn -> layer_1_moe [style=solid]
	layer_1_gate [label="GPU 0\nExpert Gate (Top-2)\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, experts=2]" shape=parallelogram]
	layer_1_attn -> layer_1_gate [style=solid]
	layer_1_expert_0 [label="GPU 0\nExpert 0 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_0 [style=dashed]
	layer_1_expert_1 [label="GPU 0\nExpert 1 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_1 [style=dashed]
	layer_1_expert_2 [label="GPU 0\nExpert 2 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_2 [style=dashed]
	layer_1_expert_3 [label="GPU 0\nExpert 3 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_3 [style=dashed]
	layer_1_expert_4 [label="GPU 8\nExpert 4 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_4 [style=dashed]
	layer_1_expert_4_comm [label="GPU 8\nExpert Communication" shape=ellipse]
	layer_1_expert_4_comm -> layer_1_expert_4 [style=solid]
	layer_1_expert_5 [label="GPU 8\nExpert 5 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_5 [style=dashed]
	layer_1_expert_5_comm [label="GPU 8\nExpert Communication" shape=ellipse]
	layer_1_expert_5_comm -> layer_1_expert_5 [style=solid]
	layer_1_expert_6 [label="GPU 8\nExpert 6 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_6 [style=dashed]
	layer_1_expert_6_comm [label="GPU 8\nExpert Communication" shape=ellipse]
	layer_1_expert_6_comm -> layer_1_expert_6 [style=solid]
	layer_1_expert_7 [label="GPU 8\nExpert 7 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_7 [style=dashed]
	layer_1_expert_7_comm [label="GPU 8\nExpert Communication" shape=ellipse]
	layer_1_expert_7_comm -> layer_1_expert_7 [style=solid]
	layer_1_expert_8 [label="GPU 16\nExpert 8 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_8 [style=dashed]
	layer_1_expert_8_comm [label="GPU 16\nExpert Communication" shape=ellipse]
	layer_1_expert_8_comm -> layer_1_expert_8 [style=solid]
	layer_1_expert_9 [label="GPU 16\nExpert 9 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_9 [style=dashed]
	layer_1_expert_9_comm [label="GPU 16\nExpert Communication" shape=ellipse]
	layer_1_expert_9_comm -> layer_1_expert_9 [style=solid]
	layer_1_expert_10 [label="GPU 16\nExpert 10 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_10 [style=dashed]
	layer_1_expert_10_comm [label="GPU 16\nExpert Communication" shape=ellipse]
	layer_1_expert_10_comm -> layer_1_expert_10 [style=solid]
	layer_1_expert_11 [label="GPU 16\nExpert 11 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_11 [style=dashed]
	layer_1_expert_11_comm [label="GPU 16\nExpert Communication" shape=ellipse]
	layer_1_expert_11_comm -> layer_1_expert_11 [style=solid]
	layer_1_expert_12 [label="GPU 24\nExpert 12 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_12 [style=dashed]
	layer_1_expert_12_comm [label="GPU 24\nExpert Communication" shape=ellipse]
	layer_1_expert_12_comm -> layer_1_expert_12 [style=solid]
	layer_1_expert_13 [label="GPU 24\nExpert 13 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_13 [style=dashed]
	layer_1_expert_13_comm [label="GPU 24\nExpert Communication" shape=ellipse]
	layer_1_expert_13_comm -> layer_1_expert_13 [style=solid]
	layer_1_expert_14 [label="GPU 24\nExpert 14 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_14 [style=dashed]
	layer_1_expert_14_comm [label="GPU 24\nExpert Communication" shape=ellipse]
	layer_1_expert_14_comm -> layer_1_expert_14 [style=solid]
	layer_1_expert_15 [label="GPU 24\nExpert 15 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_15 [style=dashed]
	layer_1_expert_15_comm [label="GPU 24\nExpert Communication" shape=ellipse]
	layer_1_expert_15_comm -> layer_1_expert_15 [style=solid]
	layer_1_expert_16 [label="GPU 32\nExpert 16 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_16 [style=dashed]
	layer_1_expert_16_comm [label="GPU 32\nExpert Communication" shape=ellipse]
	layer_1_expert_16_comm -> layer_1_expert_16 [style=solid]
	layer_1_expert_17 [label="GPU 32\nExpert 17 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_17 [style=dashed]
	layer_1_expert_17_comm [label="GPU 32\nExpert Communication" shape=ellipse]
	layer_1_expert_17_comm -> layer_1_expert_17 [style=solid]
	layer_1_expert_18 [label="GPU 32\nExpert 18 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_18 [style=dashed]
	layer_1_expert_18_comm [label="GPU 32\nExpert Communication" shape=ellipse]
	layer_1_expert_18_comm -> layer_1_expert_18 [style=solid]
	layer_1_expert_19 [label="GPU 32\nExpert 19 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_19 [style=dashed]
	layer_1_expert_19_comm [label="GPU 32\nExpert Communication" shape=ellipse]
	layer_1_expert_19_comm -> layer_1_expert_19 [style=solid]
	layer_1_expert_20 [label="GPU 40\nExpert 20 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_20 [style=dashed]
	layer_1_expert_20_comm [label="GPU 40\nExpert Communication" shape=ellipse]
	layer_1_expert_20_comm -> layer_1_expert_20 [style=solid]
	layer_1_expert_21 [label="GPU 40\nExpert 21 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_21 [style=dashed]
	layer_1_expert_21_comm [label="GPU 40\nExpert Communication" shape=ellipse]
	layer_1_expert_21_comm -> layer_1_expert_21 [style=solid]
	layer_1_expert_22 [label="GPU 40\nExpert 22 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_22 [style=dashed]
	layer_1_expert_22_comm [label="GPU 40\nExpert Communication" shape=ellipse]
	layer_1_expert_22_comm -> layer_1_expert_22 [style=solid]
	layer_1_expert_23 [label="GPU 40\nExpert 23 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_23 [style=dashed]
	layer_1_expert_23_comm [label="GPU 40\nExpert Communication" shape=ellipse]
	layer_1_expert_23_comm -> layer_1_expert_23 [style=solid]
	layer_1_expert_24 [label="GPU 48\nExpert 24 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_24 [style=dashed]
	layer_1_expert_24_comm [label="GPU 48\nExpert Communication" shape=ellipse]
	layer_1_expert_24_comm -> layer_1_expert_24 [style=solid]
	layer_1_expert_25 [label="GPU 48\nExpert 25 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_25 [style=dashed]
	layer_1_expert_25_comm [label="GPU 48\nExpert Communication" shape=ellipse]
	layer_1_expert_25_comm -> layer_1_expert_25 [style=solid]
	layer_1_expert_26 [label="GPU 48\nExpert 26 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_26 [style=dashed]
	layer_1_expert_26_comm [label="GPU 48\nExpert Communication" shape=ellipse]
	layer_1_expert_26_comm -> layer_1_expert_26 [style=solid]
	layer_1_expert_27 [label="GPU 48\nExpert 27 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_27 [style=dashed]
	layer_1_expert_27_comm [label="GPU 48\nExpert Communication" shape=ellipse]
	layer_1_expert_27_comm -> layer_1_expert_27 [style=solid]
	layer_1_expert_28 [label="GPU 56\nExpert 28 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_28 [style=dashed]
	layer_1_expert_28_comm [label="GPU 56\nExpert Communication" shape=ellipse]
	layer_1_expert_28_comm -> layer_1_expert_28 [style=solid]
	layer_1_expert_29 [label="GPU 56\nExpert 29 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_29 [style=dashed]
	layer_1_expert_29_comm [label="GPU 56\nExpert Communication" shape=ellipse]
	layer_1_expert_29_comm -> layer_1_expert_29 [style=solid]
	layer_1_expert_30 [label="GPU 56\nExpert 30 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_30 [style=dashed]
	layer_1_expert_30_comm [label="GPU 56\nExpert Communication" shape=ellipse]
	layer_1_expert_30_comm -> layer_1_expert_30 [style=solid]
	layer_1_expert_31 [label="GPU 56\nExpert 31 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_31 [style=dashed]
	layer_1_expert_31_comm [label="GPU 56\nExpert Communication" shape=ellipse]
	layer_1_expert_31_comm -> layer_1_expert_31 [style=solid]
	layer_1_expert_32 [label="GPU 64\nExpert 32 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_32 [style=dashed]
	layer_1_expert_32_comm [label="GPU 64\nExpert Communication" shape=ellipse]
	layer_1_expert_32_comm -> layer_1_expert_32 [style=solid]
	layer_1_expert_33 [label="GPU 64\nExpert 33 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_33 [style=dashed]
	layer_1_expert_33_comm [label="GPU 64\nExpert Communication" shape=ellipse]
	layer_1_expert_33_comm -> layer_1_expert_33 [style=solid]
	layer_1_expert_34 [label="GPU 64\nExpert 34 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_34 [style=dashed]
	layer_1_expert_34_comm [label="GPU 64\nExpert Communication" shape=ellipse]
	layer_1_expert_34_comm -> layer_1_expert_34 [style=solid]
	layer_1_expert_35 [label="GPU 64\nExpert 35 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_35 [style=dashed]
	layer_1_expert_35_comm [label="GPU 64\nExpert Communication" shape=ellipse]
	layer_1_expert_35_comm -> layer_1_expert_35 [style=solid]
	layer_1_expert_36 [label="GPU 72\nExpert 36 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_36 [style=dashed]
	layer_1_expert_36_comm [label="GPU 72\nExpert Communication" shape=ellipse]
	layer_1_expert_36_comm -> layer_1_expert_36 [style=solid]
	layer_1_expert_37 [label="GPU 72\nExpert 37 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_37 [style=dashed]
	layer_1_expert_37_comm [label="GPU 72\nExpert Communication" shape=ellipse]
	layer_1_expert_37_comm -> layer_1_expert_37 [style=solid]
	layer_1_expert_38 [label="GPU 72\nExpert 38 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_38 [style=dashed]
	layer_1_expert_38_comm [label="GPU 72\nExpert Communication" shape=ellipse]
	layer_1_expert_38_comm -> layer_1_expert_38 [style=solid]
	layer_1_expert_39 [label="GPU 72\nExpert 39 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_39 [style=dashed]
	layer_1_expert_39_comm [label="GPU 72\nExpert Communication" shape=ellipse]
	layer_1_expert_39_comm -> layer_1_expert_39 [style=solid]
	layer_1_expert_40 [label="GPU 80\nExpert 40 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_40 [style=dashed]
	layer_1_expert_40_comm [label="GPU 80\nExpert Communication" shape=ellipse]
	layer_1_expert_40_comm -> layer_1_expert_40 [style=solid]
	layer_1_expert_41 [label="GPU 80\nExpert 41 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_41 [style=dashed]
	layer_1_expert_41_comm [label="GPU 80\nExpert Communication" shape=ellipse]
	layer_1_expert_41_comm -> layer_1_expert_41 [style=solid]
	layer_1_expert_42 [label="GPU 80\nExpert 42 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_42 [style=dashed]
	layer_1_expert_42_comm [label="GPU 80\nExpert Communication" shape=ellipse]
	layer_1_expert_42_comm -> layer_1_expert_42 [style=solid]
	layer_1_expert_43 [label="GPU 80\nExpert 43 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_43 [style=dashed]
	layer_1_expert_43_comm [label="GPU 80\nExpert Communication" shape=ellipse]
	layer_1_expert_43_comm -> layer_1_expert_43 [style=solid]
	layer_1_expert_44 [label="GPU 88\nExpert 44 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_44 [style=dashed]
	layer_1_expert_44_comm [label="GPU 88\nExpert Communication" shape=ellipse]
	layer_1_expert_44_comm -> layer_1_expert_44 [style=solid]
	layer_1_expert_45 [label="GPU 88\nExpert 45 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_45 [style=dashed]
	layer_1_expert_45_comm [label="GPU 88\nExpert Communication" shape=ellipse]
	layer_1_expert_45_comm -> layer_1_expert_45 [style=solid]
	layer_1_expert_46 [label="GPU 88\nExpert 46 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_46 [style=dashed]
	layer_1_expert_46_comm [label="GPU 88\nExpert Communication" shape=ellipse]
	layer_1_expert_46_comm -> layer_1_expert_46 [style=solid]
	layer_1_expert_47 [label="GPU 88\nExpert 47 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_47 [style=dashed]
	layer_1_expert_47_comm [label="GPU 88\nExpert Communication" shape=ellipse]
	layer_1_expert_47_comm -> layer_1_expert_47 [style=solid]
	layer_1_expert_48 [label="GPU 96\nExpert 48 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_48 [style=dashed]
	layer_1_expert_48_comm [label="GPU 96\nExpert Communication" shape=ellipse]
	layer_1_expert_48_comm -> layer_1_expert_48 [style=solid]
	layer_1_expert_49 [label="GPU 96\nExpert 49 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_49 [style=dashed]
	layer_1_expert_49_comm [label="GPU 96\nExpert Communication" shape=ellipse]
	layer_1_expert_49_comm -> layer_1_expert_49 [style=solid]
	layer_1_expert_50 [label="GPU 96\nExpert 50 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_50 [style=dashed]
	layer_1_expert_50_comm [label="GPU 96\nExpert Communication" shape=ellipse]
	layer_1_expert_50_comm -> layer_1_expert_50 [style=solid]
	layer_1_expert_51 [label="GPU 96\nExpert 51 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_51 [style=dashed]
	layer_1_expert_51_comm [label="GPU 96\nExpert Communication" shape=ellipse]
	layer_1_expert_51_comm -> layer_1_expert_51 [style=solid]
	layer_1_expert_52 [label="GPU 104\nExpert 52 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_52 [style=dashed]
	layer_1_expert_52_comm [label="GPU 104\nExpert Communication" shape=ellipse]
	layer_1_expert_52_comm -> layer_1_expert_52 [style=solid]
	layer_1_expert_53 [label="GPU 104\nExpert 53 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_53 [style=dashed]
	layer_1_expert_53_comm [label="GPU 104\nExpert Communication" shape=ellipse]
	layer_1_expert_53_comm -> layer_1_expert_53 [style=solid]
	layer_1_expert_54 [label="GPU 104\nExpert 54 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_54 [style=dashed]
	layer_1_expert_54_comm [label="GPU 104\nExpert Communication" shape=ellipse]
	layer_1_expert_54_comm -> layer_1_expert_54 [style=solid]
	layer_1_expert_55 [label="GPU 104\nExpert 55 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_55 [style=dashed]
	layer_1_expert_55_comm [label="GPU 104\nExpert Communication" shape=ellipse]
	layer_1_expert_55_comm -> layer_1_expert_55 [style=solid]
	layer_1_expert_56 [label="GPU 112\nExpert 56 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_56 [style=dashed]
	layer_1_expert_56_comm [label="GPU 112\nExpert Communication" shape=ellipse]
	layer_1_expert_56_comm -> layer_1_expert_56 [style=solid]
	layer_1_expert_57 [label="GPU 112\nExpert 57 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_57 [style=dashed]
	layer_1_expert_57_comm [label="GPU 112\nExpert Communication" shape=ellipse]
	layer_1_expert_57_comm -> layer_1_expert_57 [style=solid]
	layer_1_expert_58 [label="GPU 112\nExpert 58 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_58 [style=dashed]
	layer_1_expert_58_comm [label="GPU 112\nExpert Communication" shape=ellipse]
	layer_1_expert_58_comm -> layer_1_expert_58 [style=solid]
	layer_1_expert_59 [label="GPU 112\nExpert 59 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_59 [style=dashed]
	layer_1_expert_59_comm [label="GPU 112\nExpert Communication" shape=ellipse]
	layer_1_expert_59_comm -> layer_1_expert_59 [style=solid]
	layer_1_expert_60 [label="GPU 120\nExpert 60 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_60 [style=dashed]
	layer_1_expert_60_comm [label="GPU 120\nExpert Communication" shape=ellipse]
	layer_1_expert_60_comm -> layer_1_expert_60 [style=solid]
	layer_1_expert_61 [label="GPU 120\nExpert 61 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_61 [style=dashed]
	layer_1_expert_61_comm [label="GPU 120\nExpert Communication" shape=ellipse]
	layer_1_expert_61_comm -> layer_1_expert_61 [style=solid]
	layer_1_expert_62 [label="GPU 120\nExpert 62 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_62 [style=dashed]
	layer_1_expert_62_comm [label="GPU 120\nExpert Communication" shape=ellipse]
	layer_1_expert_62_comm -> layer_1_expert_62 [style=solid]
	layer_1_expert_63 [label="GPU 120\nExpert 63 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_1_gate -> layer_1_expert_63 [style=dashed]
	layer_1_expert_63_comm [label="GPU 120\nExpert Communication" shape=ellipse]
	layer_1_expert_63_comm -> layer_1_expert_63 [style=solid]
	layer_1_expert_agg [label="GPU 0\nExpert Aggregation (Weighted Sum)\nInput: [batch_size=16, seq_len=10240, experts=64, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=parallelogram]
	layer_1_expert_0 -> layer_1_expert_agg [style=solid]
	layer_1_expert_1 -> layer_1_expert_agg [style=solid]
	layer_1_expert_2 -> layer_1_expert_agg [style=solid]
	layer_1_expert_3 -> layer_1_expert_agg [style=solid]
	layer_1_expert_4 -> layer_1_expert_agg [style=solid]
	layer_1_expert_5 -> layer_1_expert_agg [style=solid]
	layer_1_expert_6 -> layer_1_expert_agg [style=solid]
	layer_1_expert_7 -> layer_1_expert_agg [style=solid]
	layer_1_expert_8 -> layer_1_expert_agg [style=solid]
	layer_1_expert_9 -> layer_1_expert_agg [style=solid]
	layer_1_expert_10 -> layer_1_expert_agg [style=solid]
	layer_1_expert_11 -> layer_1_expert_agg [style=solid]
	layer_1_expert_12 -> layer_1_expert_agg [style=solid]
	layer_1_expert_13 -> layer_1_expert_agg [style=solid]
	layer_1_expert_14 -> layer_1_expert_agg [style=solid]
	layer_1_expert_15 -> layer_1_expert_agg [style=solid]
	layer_1_expert_16 -> layer_1_expert_agg [style=solid]
	layer_1_expert_17 -> layer_1_expert_agg [style=solid]
	layer_1_expert_18 -> layer_1_expert_agg [style=solid]
	layer_1_expert_19 -> layer_1_expert_agg [style=solid]
	layer_1_expert_20 -> layer_1_expert_agg [style=solid]
	layer_1_expert_21 -> layer_1_expert_agg [style=solid]
	layer_1_expert_22 -> layer_1_expert_agg [style=solid]
	layer_1_expert_23 -> layer_1_expert_agg [style=solid]
	layer_1_expert_24 -> layer_1_expert_agg [style=solid]
	layer_1_expert_25 -> layer_1_expert_agg [style=solid]
	layer_1_expert_26 -> layer_1_expert_agg [style=solid]
	layer_1_expert_27 -> layer_1_expert_agg [style=solid]
	layer_1_expert_28 -> layer_1_expert_agg [style=solid]
	layer_1_expert_29 -> layer_1_expert_agg [style=solid]
	layer_1_expert_30 -> layer_1_expert_agg [style=solid]
	layer_1_expert_31 -> layer_1_expert_agg [style=solid]
	layer_1_expert_32 -> layer_1_expert_agg [style=solid]
	layer_1_expert_33 -> layer_1_expert_agg [style=solid]
	layer_1_expert_34 -> layer_1_expert_agg [style=solid]
	layer_1_expert_35 -> layer_1_expert_agg [style=solid]
	layer_1_expert_36 -> layer_1_expert_agg [style=solid]
	layer_1_expert_37 -> layer_1_expert_agg [style=solid]
	layer_1_expert_38 -> layer_1_expert_agg [style=solid]
	layer_1_expert_39 -> layer_1_expert_agg [style=solid]
	layer_1_expert_40 -> layer_1_expert_agg [style=solid]
	layer_1_expert_41 -> layer_1_expert_agg [style=solid]
	layer_1_expert_42 -> layer_1_expert_agg [style=solid]
	layer_1_expert_43 -> layer_1_expert_agg [style=solid]
	layer_1_expert_44 -> layer_1_expert_agg [style=solid]
	layer_1_expert_45 -> layer_1_expert_agg [style=solid]
	layer_1_expert_46 -> layer_1_expert_agg [style=solid]
	layer_1_expert_47 -> layer_1_expert_agg [style=solid]
	layer_1_expert_48 -> layer_1_expert_agg [style=solid]
	layer_1_expert_49 -> layer_1_expert_agg [style=solid]
	layer_1_expert_50 -> layer_1_expert_agg [style=solid]
	layer_1_expert_51 -> layer_1_expert_agg [style=solid]
	layer_1_expert_52 -> layer_1_expert_agg [style=solid]
	layer_1_expert_53 -> layer_1_expert_agg [style=solid]
	layer_1_expert_54 -> layer_1_expert_agg [style=solid]
	layer_1_expert_55 -> layer_1_expert_agg [style=solid]
	layer_1_expert_56 -> layer_1_expert_agg [style=solid]
	layer_1_expert_57 -> layer_1_expert_agg [style=solid]
	layer_1_expert_58 -> layer_1_expert_agg [style=solid]
	layer_1_expert_59 -> layer_1_expert_agg [style=solid]
	layer_1_expert_60 -> layer_1_expert_agg [style=solid]
	layer_1_expert_61 -> layer_1_expert_agg [style=solid]
	layer_1_expert_62 -> layer_1_expert_agg [style=solid]
	layer_1_expert_63 -> layer_1_expert_agg [style=solid]
	layer_1_expert_agg -> layer_1_moe [style=solid]
	layer_1_norm [label="GPU 0\nLayer Normalization\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_1_moe -> layer_1_norm [style=solid]
	layer_1_dp_comm [label="GPU 0\nData Parallel All-Reduce" shape=ellipse]
	layer_1_norm -> layer_1_dp_comm [style=solid]
	layer_1_dp_comm -> layer_2_attn [style=solid]
	layer_2_attn [label="GPU 0\nLayer 2 Self-Attention\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_2_attn_comm [label="GPU 0\nAttention Communication" shape=ellipse]
	layer_1_attn -> layer_2_attn_comm [style=solid]
	layer_2_attn_comm -> layer_2_attn [style=solid]
	layer_2_moe [label="GPU 0\nLayer 2 MoE Layer\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_2_attn -> layer_2_moe [style=solid]
	layer_2_gate [label="GPU 0\nExpert Gate (Top-2)\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, experts=2]" shape=parallelogram]
	layer_2_attn -> layer_2_gate [style=solid]
	layer_2_expert_0 [label="GPU 0\nExpert 0 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_0 [style=dashed]
	layer_2_expert_1 [label="GPU 0\nExpert 1 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_1 [style=dashed]
	layer_2_expert_2 [label="GPU 0\nExpert 2 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_2 [style=dashed]
	layer_2_expert_3 [label="GPU 0\nExpert 3 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_3 [style=dashed]
	layer_2_expert_4 [label="GPU 8\nExpert 4 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_4 [style=dashed]
	layer_2_expert_4_comm [label="GPU 8\nExpert Communication" shape=ellipse]
	layer_2_expert_4_comm -> layer_2_expert_4 [style=solid]
	layer_2_expert_5 [label="GPU 8\nExpert 5 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_5 [style=dashed]
	layer_2_expert_5_comm [label="GPU 8\nExpert Communication" shape=ellipse]
	layer_2_expert_5_comm -> layer_2_expert_5 [style=solid]
	layer_2_expert_6 [label="GPU 8\nExpert 6 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_6 [style=dashed]
	layer_2_expert_6_comm [label="GPU 8\nExpert Communication" shape=ellipse]
	layer_2_expert_6_comm -> layer_2_expert_6 [style=solid]
	layer_2_expert_7 [label="GPU 8\nExpert 7 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_7 [style=dashed]
	layer_2_expert_7_comm [label="GPU 8\nExpert Communication" shape=ellipse]
	layer_2_expert_7_comm -> layer_2_expert_7 [style=solid]
	layer_2_expert_8 [label="GPU 16\nExpert 8 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_8 [style=dashed]
	layer_2_expert_8_comm [label="GPU 16\nExpert Communication" shape=ellipse]
	layer_2_expert_8_comm -> layer_2_expert_8 [style=solid]
	layer_2_expert_9 [label="GPU 16\nExpert 9 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_9 [style=dashed]
	layer_2_expert_9_comm [label="GPU 16\nExpert Communication" shape=ellipse]
	layer_2_expert_9_comm -> layer_2_expert_9 [style=solid]
	layer_2_expert_10 [label="GPU 16\nExpert 10 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_10 [style=dashed]
	layer_2_expert_10_comm [label="GPU 16\nExpert Communication" shape=ellipse]
	layer_2_expert_10_comm -> layer_2_expert_10 [style=solid]
	layer_2_expert_11 [label="GPU 16\nExpert 11 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_11 [style=dashed]
	layer_2_expert_11_comm [label="GPU 16\nExpert Communication" shape=ellipse]
	layer_2_expert_11_comm -> layer_2_expert_11 [style=solid]
	layer_2_expert_12 [label="GPU 24\nExpert 12 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_12 [style=dashed]
	layer_2_expert_12_comm [label="GPU 24\nExpert Communication" shape=ellipse]
	layer_2_expert_12_comm -> layer_2_expert_12 [style=solid]
	layer_2_expert_13 [label="GPU 24\nExpert 13 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_13 [style=dashed]
	layer_2_expert_13_comm [label="GPU 24\nExpert Communication" shape=ellipse]
	layer_2_expert_13_comm -> layer_2_expert_13 [style=solid]
	layer_2_expert_14 [label="GPU 24\nExpert 14 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_14 [style=dashed]
	layer_2_expert_14_comm [label="GPU 24\nExpert Communication" shape=ellipse]
	layer_2_expert_14_comm -> layer_2_expert_14 [style=solid]
	layer_2_expert_15 [label="GPU 24\nExpert 15 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_15 [style=dashed]
	layer_2_expert_15_comm [label="GPU 24\nExpert Communication" shape=ellipse]
	layer_2_expert_15_comm -> layer_2_expert_15 [style=solid]
	layer_2_expert_16 [label="GPU 32\nExpert 16 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_16 [style=dashed]
	layer_2_expert_16_comm [label="GPU 32\nExpert Communication" shape=ellipse]
	layer_2_expert_16_comm -> layer_2_expert_16 [style=solid]
	layer_2_expert_17 [label="GPU 32\nExpert 17 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_17 [style=dashed]
	layer_2_expert_17_comm [label="GPU 32\nExpert Communication" shape=ellipse]
	layer_2_expert_17_comm -> layer_2_expert_17 [style=solid]
	layer_2_expert_18 [label="GPU 32\nExpert 18 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_18 [style=dashed]
	layer_2_expert_18_comm [label="GPU 32\nExpert Communication" shape=ellipse]
	layer_2_expert_18_comm -> layer_2_expert_18 [style=solid]
	layer_2_expert_19 [label="GPU 32\nExpert 19 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_19 [style=dashed]
	layer_2_expert_19_comm [label="GPU 32\nExpert Communication" shape=ellipse]
	layer_2_expert_19_comm -> layer_2_expert_19 [style=solid]
	layer_2_expert_20 [label="GPU 40\nExpert 20 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_20 [style=dashed]
	layer_2_expert_20_comm [label="GPU 40\nExpert Communication" shape=ellipse]
	layer_2_expert_20_comm -> layer_2_expert_20 [style=solid]
	layer_2_expert_21 [label="GPU 40\nExpert 21 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_21 [style=dashed]
	layer_2_expert_21_comm [label="GPU 40\nExpert Communication" shape=ellipse]
	layer_2_expert_21_comm -> layer_2_expert_21 [style=solid]
	layer_2_expert_22 [label="GPU 40\nExpert 22 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_22 [style=dashed]
	layer_2_expert_22_comm [label="GPU 40\nExpert Communication" shape=ellipse]
	layer_2_expert_22_comm -> layer_2_expert_22 [style=solid]
	layer_2_expert_23 [label="GPU 40\nExpert 23 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_23 [style=dashed]
	layer_2_expert_23_comm [label="GPU 40\nExpert Communication" shape=ellipse]
	layer_2_expert_23_comm -> layer_2_expert_23 [style=solid]
	layer_2_expert_24 [label="GPU 48\nExpert 24 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_24 [style=dashed]
	layer_2_expert_24_comm [label="GPU 48\nExpert Communication" shape=ellipse]
	layer_2_expert_24_comm -> layer_2_expert_24 [style=solid]
	layer_2_expert_25 [label="GPU 48\nExpert 25 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_25 [style=dashed]
	layer_2_expert_25_comm [label="GPU 48\nExpert Communication" shape=ellipse]
	layer_2_expert_25_comm -> layer_2_expert_25 [style=solid]
	layer_2_expert_26 [label="GPU 48\nExpert 26 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_26 [style=dashed]
	layer_2_expert_26_comm [label="GPU 48\nExpert Communication" shape=ellipse]
	layer_2_expert_26_comm -> layer_2_expert_26 [style=solid]
	layer_2_expert_27 [label="GPU 48\nExpert 27 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_27 [style=dashed]
	layer_2_expert_27_comm [label="GPU 48\nExpert Communication" shape=ellipse]
	layer_2_expert_27_comm -> layer_2_expert_27 [style=solid]
	layer_2_expert_28 [label="GPU 56\nExpert 28 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_28 [style=dashed]
	layer_2_expert_28_comm [label="GPU 56\nExpert Communication" shape=ellipse]
	layer_2_expert_28_comm -> layer_2_expert_28 [style=solid]
	layer_2_expert_29 [label="GPU 56\nExpert 29 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_29 [style=dashed]
	layer_2_expert_29_comm [label="GPU 56\nExpert Communication" shape=ellipse]
	layer_2_expert_29_comm -> layer_2_expert_29 [style=solid]
	layer_2_expert_30 [label="GPU 56\nExpert 30 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_30 [style=dashed]
	layer_2_expert_30_comm [label="GPU 56\nExpert Communication" shape=ellipse]
	layer_2_expert_30_comm -> layer_2_expert_30 [style=solid]
	layer_2_expert_31 [label="GPU 56\nExpert 31 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_31 [style=dashed]
	layer_2_expert_31_comm [label="GPU 56\nExpert Communication" shape=ellipse]
	layer_2_expert_31_comm -> layer_2_expert_31 [style=solid]
	layer_2_expert_32 [label="GPU 64\nExpert 32 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_32 [style=dashed]
	layer_2_expert_32_comm [label="GPU 64\nExpert Communication" shape=ellipse]
	layer_2_expert_32_comm -> layer_2_expert_32 [style=solid]
	layer_2_expert_33 [label="GPU 64\nExpert 33 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_33 [style=dashed]
	layer_2_expert_33_comm [label="GPU 64\nExpert Communication" shape=ellipse]
	layer_2_expert_33_comm -> layer_2_expert_33 [style=solid]
	layer_2_expert_34 [label="GPU 64\nExpert 34 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_34 [style=dashed]
	layer_2_expert_34_comm [label="GPU 64\nExpert Communication" shape=ellipse]
	layer_2_expert_34_comm -> layer_2_expert_34 [style=solid]
	layer_2_expert_35 [label="GPU 64\nExpert 35 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_35 [style=dashed]
	layer_2_expert_35_comm [label="GPU 64\nExpert Communication" shape=ellipse]
	layer_2_expert_35_comm -> layer_2_expert_35 [style=solid]
	layer_2_expert_36 [label="GPU 72\nExpert 36 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_36 [style=dashed]
	layer_2_expert_36_comm [label="GPU 72\nExpert Communication" shape=ellipse]
	layer_2_expert_36_comm -> layer_2_expert_36 [style=solid]
	layer_2_expert_37 [label="GPU 72\nExpert 37 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_37 [style=dashed]
	layer_2_expert_37_comm [label="GPU 72\nExpert Communication" shape=ellipse]
	layer_2_expert_37_comm -> layer_2_expert_37 [style=solid]
	layer_2_expert_38 [label="GPU 72\nExpert 38 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_38 [style=dashed]
	layer_2_expert_38_comm [label="GPU 72\nExpert Communication" shape=ellipse]
	layer_2_expert_38_comm -> layer_2_expert_38 [style=solid]
	layer_2_expert_39 [label="GPU 72\nExpert 39 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_39 [style=dashed]
	layer_2_expert_39_comm [label="GPU 72\nExpert Communication" shape=ellipse]
	layer_2_expert_39_comm -> layer_2_expert_39 [style=solid]
	layer_2_expert_40 [label="GPU 80\nExpert 40 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_40 [style=dashed]
	layer_2_expert_40_comm [label="GPU 80\nExpert Communication" shape=ellipse]
	layer_2_expert_40_comm -> layer_2_expert_40 [style=solid]
	layer_2_expert_41 [label="GPU 80\nExpert 41 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_41 [style=dashed]
	layer_2_expert_41_comm [label="GPU 80\nExpert Communication" shape=ellipse]
	layer_2_expert_41_comm -> layer_2_expert_41 [style=solid]
	layer_2_expert_42 [label="GPU 80\nExpert 42 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_42 [style=dashed]
	layer_2_expert_42_comm [label="GPU 80\nExpert Communication" shape=ellipse]
	layer_2_expert_42_comm -> layer_2_expert_42 [style=solid]
	layer_2_expert_43 [label="GPU 80\nExpert 43 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_43 [style=dashed]
	layer_2_expert_43_comm [label="GPU 80\nExpert Communication" shape=ellipse]
	layer_2_expert_43_comm -> layer_2_expert_43 [style=solid]
	layer_2_expert_44 [label="GPU 88\nExpert 44 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_44 [style=dashed]
	layer_2_expert_44_comm [label="GPU 88\nExpert Communication" shape=ellipse]
	layer_2_expert_44_comm -> layer_2_expert_44 [style=solid]
	layer_2_expert_45 [label="GPU 88\nExpert 45 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_45 [style=dashed]
	layer_2_expert_45_comm [label="GPU 88\nExpert Communication" shape=ellipse]
	layer_2_expert_45_comm -> layer_2_expert_45 [style=solid]
	layer_2_expert_46 [label="GPU 88\nExpert 46 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_46 [style=dashed]
	layer_2_expert_46_comm [label="GPU 88\nExpert Communication" shape=ellipse]
	layer_2_expert_46_comm -> layer_2_expert_46 [style=solid]
	layer_2_expert_47 [label="GPU 88\nExpert 47 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_47 [style=dashed]
	layer_2_expert_47_comm [label="GPU 88\nExpert Communication" shape=ellipse]
	layer_2_expert_47_comm -> layer_2_expert_47 [style=solid]
	layer_2_expert_48 [label="GPU 96\nExpert 48 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_48 [style=dashed]
	layer_2_expert_48_comm [label="GPU 96\nExpert Communication" shape=ellipse]
	layer_2_expert_48_comm -> layer_2_expert_48 [style=solid]
	layer_2_expert_49 [label="GPU 96\nExpert 49 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_49 [style=dashed]
	layer_2_expert_49_comm [label="GPU 96\nExpert Communication" shape=ellipse]
	layer_2_expert_49_comm -> layer_2_expert_49 [style=solid]
	layer_2_expert_50 [label="GPU 96\nExpert 50 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_50 [style=dashed]
	layer_2_expert_50_comm [label="GPU 96\nExpert Communication" shape=ellipse]
	layer_2_expert_50_comm -> layer_2_expert_50 [style=solid]
	layer_2_expert_51 [label="GPU 96\nExpert 51 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_51 [style=dashed]
	layer_2_expert_51_comm [label="GPU 96\nExpert Communication" shape=ellipse]
	layer_2_expert_51_comm -> layer_2_expert_51 [style=solid]
	layer_2_expert_52 [label="GPU 104\nExpert 52 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_52 [style=dashed]
	layer_2_expert_52_comm [label="GPU 104\nExpert Communication" shape=ellipse]
	layer_2_expert_52_comm -> layer_2_expert_52 [style=solid]
	layer_2_expert_53 [label="GPU 104\nExpert 53 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_53 [style=dashed]
	layer_2_expert_53_comm [label="GPU 104\nExpert Communication" shape=ellipse]
	layer_2_expert_53_comm -> layer_2_expert_53 [style=solid]
	layer_2_expert_54 [label="GPU 104\nExpert 54 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_54 [style=dashed]
	layer_2_expert_54_comm [label="GPU 104\nExpert Communication" shape=ellipse]
	layer_2_expert_54_comm -> layer_2_expert_54 [style=solid]
	layer_2_expert_55 [label="GPU 104\nExpert 55 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_55 [style=dashed]
	layer_2_expert_55_comm [label="GPU 104\nExpert Communication" shape=ellipse]
	layer_2_expert_55_comm -> layer_2_expert_55 [style=solid]
	layer_2_expert_56 [label="GPU 112\nExpert 56 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_56 [style=dashed]
	layer_2_expert_56_comm [label="GPU 112\nExpert Communication" shape=ellipse]
	layer_2_expert_56_comm -> layer_2_expert_56 [style=solid]
	layer_2_expert_57 [label="GPU 112\nExpert 57 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_57 [style=dashed]
	layer_2_expert_57_comm [label="GPU 112\nExpert Communication" shape=ellipse]
	layer_2_expert_57_comm -> layer_2_expert_57 [style=solid]
	layer_2_expert_58 [label="GPU 112\nExpert 58 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_58 [style=dashed]
	layer_2_expert_58_comm [label="GPU 112\nExpert Communication" shape=ellipse]
	layer_2_expert_58_comm -> layer_2_expert_58 [style=solid]
	layer_2_expert_59 [label="GPU 112\nExpert 59 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_59 [style=dashed]
	layer_2_expert_59_comm [label="GPU 112\nExpert Communication" shape=ellipse]
	layer_2_expert_59_comm -> layer_2_expert_59 [style=solid]
	layer_2_expert_60 [label="GPU 120\nExpert 60 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_60 [style=dashed]
	layer_2_expert_60_comm [label="GPU 120\nExpert Communication" shape=ellipse]
	layer_2_expert_60_comm -> layer_2_expert_60 [style=solid]
	layer_2_expert_61 [label="GPU 120\nExpert 61 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_61 [style=dashed]
	layer_2_expert_61_comm [label="GPU 120\nExpert Communication" shape=ellipse]
	layer_2_expert_61_comm -> layer_2_expert_61 [style=solid]
	layer_2_expert_62 [label="GPU 120\nExpert 62 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_62 [style=dashed]
	layer_2_expert_62_comm [label="GPU 120\nExpert Communication" shape=ellipse]
	layer_2_expert_62_comm -> layer_2_expert_62 [style=solid]
	layer_2_expert_63 [label="GPU 120\nExpert 63 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_2_gate -> layer_2_expert_63 [style=dashed]
	layer_2_expert_63_comm [label="GPU 120\nExpert Communication" shape=ellipse]
	layer_2_expert_63_comm -> layer_2_expert_63 [style=solid]
	layer_2_expert_agg [label="GPU 0\nExpert Aggregation (Weighted Sum)\nInput: [batch_size=16, seq_len=10240, experts=64, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=parallelogram]
	layer_2_expert_0 -> layer_2_expert_agg [style=solid]
	layer_2_expert_1 -> layer_2_expert_agg [style=solid]
	layer_2_expert_2 -> layer_2_expert_agg [style=solid]
	layer_2_expert_3 -> layer_2_expert_agg [style=solid]
	layer_2_expert_4 -> layer_2_expert_agg [style=solid]
	layer_2_expert_5 -> layer_2_expert_agg [style=solid]
	layer_2_expert_6 -> layer_2_expert_agg [style=solid]
	layer_2_expert_7 -> layer_2_expert_agg [style=solid]
	layer_2_expert_8 -> layer_2_expert_agg [style=solid]
	layer_2_expert_9 -> layer_2_expert_agg [style=solid]
	layer_2_expert_10 -> layer_2_expert_agg [style=solid]
	layer_2_expert_11 -> layer_2_expert_agg [style=solid]
	layer_2_expert_12 -> layer_2_expert_agg [style=solid]
	layer_2_expert_13 -> layer_2_expert_agg [style=solid]
	layer_2_expert_14 -> layer_2_expert_agg [style=solid]
	layer_2_expert_15 -> layer_2_expert_agg [style=solid]
	layer_2_expert_16 -> layer_2_expert_agg [style=solid]
	layer_2_expert_17 -> layer_2_expert_agg [style=solid]
	layer_2_expert_18 -> layer_2_expert_agg [style=solid]
	layer_2_expert_19 -> layer_2_expert_agg [style=solid]
	layer_2_expert_20 -> layer_2_expert_agg [style=solid]
	layer_2_expert_21 -> layer_2_expert_agg [style=solid]
	layer_2_expert_22 -> layer_2_expert_agg [style=solid]
	layer_2_expert_23 -> layer_2_expert_agg [style=solid]
	layer_2_expert_24 -> layer_2_expert_agg [style=solid]
	layer_2_expert_25 -> layer_2_expert_agg [style=solid]
	layer_2_expert_26 -> layer_2_expert_agg [style=solid]
	layer_2_expert_27 -> layer_2_expert_agg [style=solid]
	layer_2_expert_28 -> layer_2_expert_agg [style=solid]
	layer_2_expert_29 -> layer_2_expert_agg [style=solid]
	layer_2_expert_30 -> layer_2_expert_agg [style=solid]
	layer_2_expert_31 -> layer_2_expert_agg [style=solid]
	layer_2_expert_32 -> layer_2_expert_agg [style=solid]
	layer_2_expert_33 -> layer_2_expert_agg [style=solid]
	layer_2_expert_34 -> layer_2_expert_agg [style=solid]
	layer_2_expert_35 -> layer_2_expert_agg [style=solid]
	layer_2_expert_36 -> layer_2_expert_agg [style=solid]
	layer_2_expert_37 -> layer_2_expert_agg [style=solid]
	layer_2_expert_38 -> layer_2_expert_agg [style=solid]
	layer_2_expert_39 -> layer_2_expert_agg [style=solid]
	layer_2_expert_40 -> layer_2_expert_agg [style=solid]
	layer_2_expert_41 -> layer_2_expert_agg [style=solid]
	layer_2_expert_42 -> layer_2_expert_agg [style=solid]
	layer_2_expert_43 -> layer_2_expert_agg [style=solid]
	layer_2_expert_44 -> layer_2_expert_agg [style=solid]
	layer_2_expert_45 -> layer_2_expert_agg [style=solid]
	layer_2_expert_46 -> layer_2_expert_agg [style=solid]
	layer_2_expert_47 -> layer_2_expert_agg [style=solid]
	layer_2_expert_48 -> layer_2_expert_agg [style=solid]
	layer_2_expert_49 -> layer_2_expert_agg [style=solid]
	layer_2_expert_50 -> layer_2_expert_agg [style=solid]
	layer_2_expert_51 -> layer_2_expert_agg [style=solid]
	layer_2_expert_52 -> layer_2_expert_agg [style=solid]
	layer_2_expert_53 -> layer_2_expert_agg [style=solid]
	layer_2_expert_54 -> layer_2_expert_agg [style=solid]
	layer_2_expert_55 -> layer_2_expert_agg [style=solid]
	layer_2_expert_56 -> layer_2_expert_agg [style=solid]
	layer_2_expert_57 -> layer_2_expert_agg [style=solid]
	layer_2_expert_58 -> layer_2_expert_agg [style=solid]
	layer_2_expert_59 -> layer_2_expert_agg [style=solid]
	layer_2_expert_60 -> layer_2_expert_agg [style=solid]
	layer_2_expert_61 -> layer_2_expert_agg [style=solid]
	layer_2_expert_62 -> layer_2_expert_agg [style=solid]
	layer_2_expert_63 -> layer_2_expert_agg [style=solid]
	layer_2_expert_agg -> layer_2_moe [style=solid]
	layer_2_norm [label="GPU 0\nLayer Normalization\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_2_moe -> layer_2_norm [style=solid]
	layer_2_dp_comm [label="GPU 0\nData Parallel All-Reduce" shape=ellipse]
	layer_2_norm -> layer_2_dp_comm [style=solid]
	layer_2_dp_comm -> layer_3_attn [style=solid]
	layer_3_attn [label="GPU 0\nLayer 3 Self-Attention\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_3_attn_comm [label="GPU 0\nAttention Communication" shape=ellipse]
	layer_2_attn -> layer_3_attn_comm [style=solid]
	layer_3_attn_comm -> layer_3_attn [style=solid]
	layer_3_moe [label="GPU 0\nLayer 3 MoE Layer\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_3_attn -> layer_3_moe [style=solid]
	layer_3_gate [label="GPU 0\nExpert Gate (Top-2)\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, experts=2]" shape=parallelogram]
	layer_3_attn -> layer_3_gate [style=solid]
	layer_3_expert_0 [label="GPU 0\nExpert 0 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_0 [style=dashed]
	layer_3_expert_1 [label="GPU 0\nExpert 1 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_1 [style=dashed]
	layer_3_expert_2 [label="GPU 0\nExpert 2 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_2 [style=dashed]
	layer_3_expert_3 [label="GPU 0\nExpert 3 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_3 [style=dashed]
	layer_3_expert_4 [label="GPU 8\nExpert 4 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_4 [style=dashed]
	layer_3_expert_4_comm [label="GPU 8\nExpert Communication" shape=ellipse]
	layer_3_expert_4_comm -> layer_3_expert_4 [style=solid]
	layer_3_expert_5 [label="GPU 8\nExpert 5 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_5 [style=dashed]
	layer_3_expert_5_comm [label="GPU 8\nExpert Communication" shape=ellipse]
	layer_3_expert_5_comm -> layer_3_expert_5 [style=solid]
	layer_3_expert_6 [label="GPU 8\nExpert 6 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_6 [style=dashed]
	layer_3_expert_6_comm [label="GPU 8\nExpert Communication" shape=ellipse]
	layer_3_expert_6_comm -> layer_3_expert_6 [style=solid]
	layer_3_expert_7 [label="GPU 8\nExpert 7 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_7 [style=dashed]
	layer_3_expert_7_comm [label="GPU 8\nExpert Communication" shape=ellipse]
	layer_3_expert_7_comm -> layer_3_expert_7 [style=solid]
	layer_3_expert_8 [label="GPU 16\nExpert 8 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_8 [style=dashed]
	layer_3_expert_8_comm [label="GPU 16\nExpert Communication" shape=ellipse]
	layer_3_expert_8_comm -> layer_3_expert_8 [style=solid]
	layer_3_expert_9 [label="GPU 16\nExpert 9 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_9 [style=dashed]
	layer_3_expert_9_comm [label="GPU 16\nExpert Communication" shape=ellipse]
	layer_3_expert_9_comm -> layer_3_expert_9 [style=solid]
	layer_3_expert_10 [label="GPU 16\nExpert 10 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_10 [style=dashed]
	layer_3_expert_10_comm [label="GPU 16\nExpert Communication" shape=ellipse]
	layer_3_expert_10_comm -> layer_3_expert_10 [style=solid]
	layer_3_expert_11 [label="GPU 16\nExpert 11 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_11 [style=dashed]
	layer_3_expert_11_comm [label="GPU 16\nExpert Communication" shape=ellipse]
	layer_3_expert_11_comm -> layer_3_expert_11 [style=solid]
	layer_3_expert_12 [label="GPU 24\nExpert 12 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_12 [style=dashed]
	layer_3_expert_12_comm [label="GPU 24\nExpert Communication" shape=ellipse]
	layer_3_expert_12_comm -> layer_3_expert_12 [style=solid]
	layer_3_expert_13 [label="GPU 24\nExpert 13 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_13 [style=dashed]
	layer_3_expert_13_comm [label="GPU 24\nExpert Communication" shape=ellipse]
	layer_3_expert_13_comm -> layer_3_expert_13 [style=solid]
	layer_3_expert_14 [label="GPU 24\nExpert 14 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_14 [style=dashed]
	layer_3_expert_14_comm [label="GPU 24\nExpert Communication" shape=ellipse]
	layer_3_expert_14_comm -> layer_3_expert_14 [style=solid]
	layer_3_expert_15 [label="GPU 24\nExpert 15 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_15 [style=dashed]
	layer_3_expert_15_comm [label="GPU 24\nExpert Communication" shape=ellipse]
	layer_3_expert_15_comm -> layer_3_expert_15 [style=solid]
	layer_3_expert_16 [label="GPU 32\nExpert 16 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_16 [style=dashed]
	layer_3_expert_16_comm [label="GPU 32\nExpert Communication" shape=ellipse]
	layer_3_expert_16_comm -> layer_3_expert_16 [style=solid]
	layer_3_expert_17 [label="GPU 32\nExpert 17 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_17 [style=dashed]
	layer_3_expert_17_comm [label="GPU 32\nExpert Communication" shape=ellipse]
	layer_3_expert_17_comm -> layer_3_expert_17 [style=solid]
	layer_3_expert_18 [label="GPU 32\nExpert 18 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_18 [style=dashed]
	layer_3_expert_18_comm [label="GPU 32\nExpert Communication" shape=ellipse]
	layer_3_expert_18_comm -> layer_3_expert_18 [style=solid]
	layer_3_expert_19 [label="GPU 32\nExpert 19 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_19 [style=dashed]
	layer_3_expert_19_comm [label="GPU 32\nExpert Communication" shape=ellipse]
	layer_3_expert_19_comm -> layer_3_expert_19 [style=solid]
	layer_3_expert_20 [label="GPU 40\nExpert 20 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_20 [style=dashed]
	layer_3_expert_20_comm [label="GPU 40\nExpert Communication" shape=ellipse]
	layer_3_expert_20_comm -> layer_3_expert_20 [style=solid]
	layer_3_expert_21 [label="GPU 40\nExpert 21 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_21 [style=dashed]
	layer_3_expert_21_comm [label="GPU 40\nExpert Communication" shape=ellipse]
	layer_3_expert_21_comm -> layer_3_expert_21 [style=solid]
	layer_3_expert_22 [label="GPU 40\nExpert 22 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_22 [style=dashed]
	layer_3_expert_22_comm [label="GPU 40\nExpert Communication" shape=ellipse]
	layer_3_expert_22_comm -> layer_3_expert_22 [style=solid]
	layer_3_expert_23 [label="GPU 40\nExpert 23 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_23 [style=dashed]
	layer_3_expert_23_comm [label="GPU 40\nExpert Communication" shape=ellipse]
	layer_3_expert_23_comm -> layer_3_expert_23 [style=solid]
	layer_3_expert_24 [label="GPU 48\nExpert 24 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_24 [style=dashed]
	layer_3_expert_24_comm [label="GPU 48\nExpert Communication" shape=ellipse]
	layer_3_expert_24_comm -> layer_3_expert_24 [style=solid]
	layer_3_expert_25 [label="GPU 48\nExpert 25 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_25 [style=dashed]
	layer_3_expert_25_comm [label="GPU 48\nExpert Communication" shape=ellipse]
	layer_3_expert_25_comm -> layer_3_expert_25 [style=solid]
	layer_3_expert_26 [label="GPU 48\nExpert 26 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_26 [style=dashed]
	layer_3_expert_26_comm [label="GPU 48\nExpert Communication" shape=ellipse]
	layer_3_expert_26_comm -> layer_3_expert_26 [style=solid]
	layer_3_expert_27 [label="GPU 48\nExpert 27 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_27 [style=dashed]
	layer_3_expert_27_comm [label="GPU 48\nExpert Communication" shape=ellipse]
	layer_3_expert_27_comm -> layer_3_expert_27 [style=solid]
	layer_3_expert_28 [label="GPU 56\nExpert 28 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_28 [style=dashed]
	layer_3_expert_28_comm [label="GPU 56\nExpert Communication" shape=ellipse]
	layer_3_expert_28_comm -> layer_3_expert_28 [style=solid]
	layer_3_expert_29 [label="GPU 56\nExpert 29 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_29 [style=dashed]
	layer_3_expert_29_comm [label="GPU 56\nExpert Communication" shape=ellipse]
	layer_3_expert_29_comm -> layer_3_expert_29 [style=solid]
	layer_3_expert_30 [label="GPU 56\nExpert 30 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_30 [style=dashed]
	layer_3_expert_30_comm [label="GPU 56\nExpert Communication" shape=ellipse]
	layer_3_expert_30_comm -> layer_3_expert_30 [style=solid]
	layer_3_expert_31 [label="GPU 56\nExpert 31 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_31 [style=dashed]
	layer_3_expert_31_comm [label="GPU 56\nExpert Communication" shape=ellipse]
	layer_3_expert_31_comm -> layer_3_expert_31 [style=solid]
	layer_3_expert_32 [label="GPU 64\nExpert 32 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_32 [style=dashed]
	layer_3_expert_32_comm [label="GPU 64\nExpert Communication" shape=ellipse]
	layer_3_expert_32_comm -> layer_3_expert_32 [style=solid]
	layer_3_expert_33 [label="GPU 64\nExpert 33 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_33 [style=dashed]
	layer_3_expert_33_comm [label="GPU 64\nExpert Communication" shape=ellipse]
	layer_3_expert_33_comm -> layer_3_expert_33 [style=solid]
	layer_3_expert_34 [label="GPU 64\nExpert 34 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_34 [style=dashed]
	layer_3_expert_34_comm [label="GPU 64\nExpert Communication" shape=ellipse]
	layer_3_expert_34_comm -> layer_3_expert_34 [style=solid]
	layer_3_expert_35 [label="GPU 64\nExpert 35 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_35 [style=dashed]
	layer_3_expert_35_comm [label="GPU 64\nExpert Communication" shape=ellipse]
	layer_3_expert_35_comm -> layer_3_expert_35 [style=solid]
	layer_3_expert_36 [label="GPU 72\nExpert 36 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_36 [style=dashed]
	layer_3_expert_36_comm [label="GPU 72\nExpert Communication" shape=ellipse]
	layer_3_expert_36_comm -> layer_3_expert_36 [style=solid]
	layer_3_expert_37 [label="GPU 72\nExpert 37 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_37 [style=dashed]
	layer_3_expert_37_comm [label="GPU 72\nExpert Communication" shape=ellipse]
	layer_3_expert_37_comm -> layer_3_expert_37 [style=solid]
	layer_3_expert_38 [label="GPU 72\nExpert 38 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_38 [style=dashed]
	layer_3_expert_38_comm [label="GPU 72\nExpert Communication" shape=ellipse]
	layer_3_expert_38_comm -> layer_3_expert_38 [style=solid]
	layer_3_expert_39 [label="GPU 72\nExpert 39 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_39 [style=dashed]
	layer_3_expert_39_comm [label="GPU 72\nExpert Communication" shape=ellipse]
	layer_3_expert_39_comm -> layer_3_expert_39 [style=solid]
	layer_3_expert_40 [label="GPU 80\nExpert 40 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_40 [style=dashed]
	layer_3_expert_40_comm [label="GPU 80\nExpert Communication" shape=ellipse]
	layer_3_expert_40_comm -> layer_3_expert_40 [style=solid]
	layer_3_expert_41 [label="GPU 80\nExpert 41 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_41 [style=dashed]
	layer_3_expert_41_comm [label="GPU 80\nExpert Communication" shape=ellipse]
	layer_3_expert_41_comm -> layer_3_expert_41 [style=solid]
	layer_3_expert_42 [label="GPU 80\nExpert 42 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_42 [style=dashed]
	layer_3_expert_42_comm [label="GPU 80\nExpert Communication" shape=ellipse]
	layer_3_expert_42_comm -> layer_3_expert_42 [style=solid]
	layer_3_expert_43 [label="GPU 80\nExpert 43 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_43 [style=dashed]
	layer_3_expert_43_comm [label="GPU 80\nExpert Communication" shape=ellipse]
	layer_3_expert_43_comm -> layer_3_expert_43 [style=solid]
	layer_3_expert_44 [label="GPU 88\nExpert 44 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_44 [style=dashed]
	layer_3_expert_44_comm [label="GPU 88\nExpert Communication" shape=ellipse]
	layer_3_expert_44_comm -> layer_3_expert_44 [style=solid]
	layer_3_expert_45 [label="GPU 88\nExpert 45 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_45 [style=dashed]
	layer_3_expert_45_comm [label="GPU 88\nExpert Communication" shape=ellipse]
	layer_3_expert_45_comm -> layer_3_expert_45 [style=solid]
	layer_3_expert_46 [label="GPU 88\nExpert 46 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_46 [style=dashed]
	layer_3_expert_46_comm [label="GPU 88\nExpert Communication" shape=ellipse]
	layer_3_expert_46_comm -> layer_3_expert_46 [style=solid]
	layer_3_expert_47 [label="GPU 88\nExpert 47 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_47 [style=dashed]
	layer_3_expert_47_comm [label="GPU 88\nExpert Communication" shape=ellipse]
	layer_3_expert_47_comm -> layer_3_expert_47 [style=solid]
	layer_3_expert_48 [label="GPU 96\nExpert 48 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_48 [style=dashed]
	layer_3_expert_48_comm [label="GPU 96\nExpert Communication" shape=ellipse]
	layer_3_expert_48_comm -> layer_3_expert_48 [style=solid]
	layer_3_expert_49 [label="GPU 96\nExpert 49 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_49 [style=dashed]
	layer_3_expert_49_comm [label="GPU 96\nExpert Communication" shape=ellipse]
	layer_3_expert_49_comm -> layer_3_expert_49 [style=solid]
	layer_3_expert_50 [label="GPU 96\nExpert 50 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_50 [style=dashed]
	layer_3_expert_50_comm [label="GPU 96\nExpert Communication" shape=ellipse]
	layer_3_expert_50_comm -> layer_3_expert_50 [style=solid]
	layer_3_expert_51 [label="GPU 96\nExpert 51 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_51 [style=dashed]
	layer_3_expert_51_comm [label="GPU 96\nExpert Communication" shape=ellipse]
	layer_3_expert_51_comm -> layer_3_expert_51 [style=solid]
	layer_3_expert_52 [label="GPU 104\nExpert 52 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_52 [style=dashed]
	layer_3_expert_52_comm [label="GPU 104\nExpert Communication" shape=ellipse]
	layer_3_expert_52_comm -> layer_3_expert_52 [style=solid]
	layer_3_expert_53 [label="GPU 104\nExpert 53 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_53 [style=dashed]
	layer_3_expert_53_comm [label="GPU 104\nExpert Communication" shape=ellipse]
	layer_3_expert_53_comm -> layer_3_expert_53 [style=solid]
	layer_3_expert_54 [label="GPU 104\nExpert 54 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_54 [style=dashed]
	layer_3_expert_54_comm [label="GPU 104\nExpert Communication" shape=ellipse]
	layer_3_expert_54_comm -> layer_3_expert_54 [style=solid]
	layer_3_expert_55 [label="GPU 104\nExpert 55 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_55 [style=dashed]
	layer_3_expert_55_comm [label="GPU 104\nExpert Communication" shape=ellipse]
	layer_3_expert_55_comm -> layer_3_expert_55 [style=solid]
	layer_3_expert_56 [label="GPU 112\nExpert 56 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_56 [style=dashed]
	layer_3_expert_56_comm [label="GPU 112\nExpert Communication" shape=ellipse]
	layer_3_expert_56_comm -> layer_3_expert_56 [style=solid]
	layer_3_expert_57 [label="GPU 112\nExpert 57 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_57 [style=dashed]
	layer_3_expert_57_comm [label="GPU 112\nExpert Communication" shape=ellipse]
	layer_3_expert_57_comm -> layer_3_expert_57 [style=solid]
	layer_3_expert_58 [label="GPU 112\nExpert 58 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_58 [style=dashed]
	layer_3_expert_58_comm [label="GPU 112\nExpert Communication" shape=ellipse]
	layer_3_expert_58_comm -> layer_3_expert_58 [style=solid]
	layer_3_expert_59 [label="GPU 112\nExpert 59 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_59 [style=dashed]
	layer_3_expert_59_comm [label="GPU 112\nExpert Communication" shape=ellipse]
	layer_3_expert_59_comm -> layer_3_expert_59 [style=solid]
	layer_3_expert_60 [label="GPU 120\nExpert 60 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_60 [style=dashed]
	layer_3_expert_60_comm [label="GPU 120\nExpert Communication" shape=ellipse]
	layer_3_expert_60_comm -> layer_3_expert_60 [style=solid]
	layer_3_expert_61 [label="GPU 120\nExpert 61 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_61 [style=dashed]
	layer_3_expert_61_comm [label="GPU 120\nExpert Communication" shape=ellipse]
	layer_3_expert_61_comm -> layer_3_expert_61 [style=solid]
	layer_3_expert_62 [label="GPU 120\nExpert 62 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_62 [style=dashed]
	layer_3_expert_62_comm [label="GPU 120\nExpert Communication" shape=ellipse]
	layer_3_expert_62_comm -> layer_3_expert_62 [style=solid]
	layer_3_expert_63 [label="GPU 120\nExpert 63 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_3_gate -> layer_3_expert_63 [style=dashed]
	layer_3_expert_63_comm [label="GPU 120\nExpert Communication" shape=ellipse]
	layer_3_expert_63_comm -> layer_3_expert_63 [style=solid]
	layer_3_expert_agg [label="GPU 0\nExpert Aggregation (Weighted Sum)\nInput: [batch_size=16, seq_len=10240, experts=64, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=parallelogram]
	layer_3_expert_0 -> layer_3_expert_agg [style=solid]
	layer_3_expert_1 -> layer_3_expert_agg [style=solid]
	layer_3_expert_2 -> layer_3_expert_agg [style=solid]
	layer_3_expert_3 -> layer_3_expert_agg [style=solid]
	layer_3_expert_4 -> layer_3_expert_agg [style=solid]
	layer_3_expert_5 -> layer_3_expert_agg [style=solid]
	layer_3_expert_6 -> layer_3_expert_agg [style=solid]
	layer_3_expert_7 -> layer_3_expert_agg [style=solid]
	layer_3_expert_8 -> layer_3_expert_agg [style=solid]
	layer_3_expert_9 -> layer_3_expert_agg [style=solid]
	layer_3_expert_10 -> layer_3_expert_agg [style=solid]
	layer_3_expert_11 -> layer_3_expert_agg [style=solid]
	layer_3_expert_12 -> layer_3_expert_agg [style=solid]
	layer_3_expert_13 -> layer_3_expert_agg [style=solid]
	layer_3_expert_14 -> layer_3_expert_agg [style=solid]
	layer_3_expert_15 -> layer_3_expert_agg [style=solid]
	layer_3_expert_16 -> layer_3_expert_agg [style=solid]
	layer_3_expert_17 -> layer_3_expert_agg [style=solid]
	layer_3_expert_18 -> layer_3_expert_agg [style=solid]
	layer_3_expert_19 -> layer_3_expert_agg [style=solid]
	layer_3_expert_20 -> layer_3_expert_agg [style=solid]
	layer_3_expert_21 -> layer_3_expert_agg [style=solid]
	layer_3_expert_22 -> layer_3_expert_agg [style=solid]
	layer_3_expert_23 -> layer_3_expert_agg [style=solid]
	layer_3_expert_24 -> layer_3_expert_agg [style=solid]
	layer_3_expert_25 -> layer_3_expert_agg [style=solid]
	layer_3_expert_26 -> layer_3_expert_agg [style=solid]
	layer_3_expert_27 -> layer_3_expert_agg [style=solid]
	layer_3_expert_28 -> layer_3_expert_agg [style=solid]
	layer_3_expert_29 -> layer_3_expert_agg [style=solid]
	layer_3_expert_30 -> layer_3_expert_agg [style=solid]
	layer_3_expert_31 -> layer_3_expert_agg [style=solid]
	layer_3_expert_32 -> layer_3_expert_agg [style=solid]
	layer_3_expert_33 -> layer_3_expert_agg [style=solid]
	layer_3_expert_34 -> layer_3_expert_agg [style=solid]
	layer_3_expert_35 -> layer_3_expert_agg [style=solid]
	layer_3_expert_36 -> layer_3_expert_agg [style=solid]
	layer_3_expert_37 -> layer_3_expert_agg [style=solid]
	layer_3_expert_38 -> layer_3_expert_agg [style=solid]
	layer_3_expert_39 -> layer_3_expert_agg [style=solid]
	layer_3_expert_40 -> layer_3_expert_agg [style=solid]
	layer_3_expert_41 -> layer_3_expert_agg [style=solid]
	layer_3_expert_42 -> layer_3_expert_agg [style=solid]
	layer_3_expert_43 -> layer_3_expert_agg [style=solid]
	layer_3_expert_44 -> layer_3_expert_agg [style=solid]
	layer_3_expert_45 -> layer_3_expert_agg [style=solid]
	layer_3_expert_46 -> layer_3_expert_agg [style=solid]
	layer_3_expert_47 -> layer_3_expert_agg [style=solid]
	layer_3_expert_48 -> layer_3_expert_agg [style=solid]
	layer_3_expert_49 -> layer_3_expert_agg [style=solid]
	layer_3_expert_50 -> layer_3_expert_agg [style=solid]
	layer_3_expert_51 -> layer_3_expert_agg [style=solid]
	layer_3_expert_52 -> layer_3_expert_agg [style=solid]
	layer_3_expert_53 -> layer_3_expert_agg [style=solid]
	layer_3_expert_54 -> layer_3_expert_agg [style=solid]
	layer_3_expert_55 -> layer_3_expert_agg [style=solid]
	layer_3_expert_56 -> layer_3_expert_agg [style=solid]
	layer_3_expert_57 -> layer_3_expert_agg [style=solid]
	layer_3_expert_58 -> layer_3_expert_agg [style=solid]
	layer_3_expert_59 -> layer_3_expert_agg [style=solid]
	layer_3_expert_60 -> layer_3_expert_agg [style=solid]
	layer_3_expert_61 -> layer_3_expert_agg [style=solid]
	layer_3_expert_62 -> layer_3_expert_agg [style=solid]
	layer_3_expert_63 -> layer_3_expert_agg [style=solid]
	layer_3_expert_agg -> layer_3_moe [style=solid]
	layer_3_norm [label="GPU 0\nLayer Normalization\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_3_moe -> layer_3_norm [style=solid]
	layer_3_dp_comm [label="GPU 0\nData Parallel All-Reduce" shape=ellipse]
	layer_3_norm -> layer_3_dp_comm [style=solid]
	layer_3_stage_comm [label="GPU 128\nStage Communication" shape=ellipse]
	layer_3_dp_comm -> layer_3_stage_comm [style=solid]
	subgraph stage_0 {
		rank=same
		label="Pipeline Stage 0 (Layers 0-3)"
	}
	layer_4_attn [label="GPU 128\nLayer 4 Self-Attention\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_4_attn_comm [label="GPU 128\nAttention Communication" shape=ellipse]
	layer_3_attn -> layer_4_attn_comm [style=solid]
	layer_4_attn_comm -> layer_4_attn [style=solid]
	layer_4_moe [label="GPU 128\nLayer 4 MoE Layer\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_4_attn -> layer_4_moe [style=solid]
	layer_4_gate [label="GPU 128\nExpert Gate (Top-2)\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, experts=2]" shape=parallelogram]
	layer_4_attn -> layer_4_gate [style=solid]
	layer_4_expert_0 [label="GPU 128\nExpert 0 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_0 [style=dashed]
	layer_4_expert_1 [label="GPU 128\nExpert 1 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_1 [style=dashed]
	layer_4_expert_2 [label="GPU 128\nExpert 2 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_2 [style=dashed]
	layer_4_expert_3 [label="GPU 128\nExpert 3 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_3 [style=dashed]
	layer_4_expert_4 [label="GPU 136\nExpert 4 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_4 [style=dashed]
	layer_4_expert_4_comm [label="GPU 136\nExpert Communication" shape=ellipse]
	layer_4_expert_4_comm -> layer_4_expert_4 [style=solid]
	layer_4_expert_5 [label="GPU 136\nExpert 5 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_5 [style=dashed]
	layer_4_expert_5_comm [label="GPU 136\nExpert Communication" shape=ellipse]
	layer_4_expert_5_comm -> layer_4_expert_5 [style=solid]
	layer_4_expert_6 [label="GPU 136\nExpert 6 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_6 [style=dashed]
	layer_4_expert_6_comm [label="GPU 136\nExpert Communication" shape=ellipse]
	layer_4_expert_6_comm -> layer_4_expert_6 [style=solid]
	layer_4_expert_7 [label="GPU 136\nExpert 7 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_7 [style=dashed]
	layer_4_expert_7_comm [label="GPU 136\nExpert Communication" shape=ellipse]
	layer_4_expert_7_comm -> layer_4_expert_7 [style=solid]
	layer_4_expert_8 [label="GPU 144\nExpert 8 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_8 [style=dashed]
	layer_4_expert_8_comm [label="GPU 144\nExpert Communication" shape=ellipse]
	layer_4_expert_8_comm -> layer_4_expert_8 [style=solid]
	layer_4_expert_9 [label="GPU 144\nExpert 9 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_9 [style=dashed]
	layer_4_expert_9_comm [label="GPU 144\nExpert Communication" shape=ellipse]
	layer_4_expert_9_comm -> layer_4_expert_9 [style=solid]
	layer_4_expert_10 [label="GPU 144\nExpert 10 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_10 [style=dashed]
	layer_4_expert_10_comm [label="GPU 144\nExpert Communication" shape=ellipse]
	layer_4_expert_10_comm -> layer_4_expert_10 [style=solid]
	layer_4_expert_11 [label="GPU 144\nExpert 11 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_11 [style=dashed]
	layer_4_expert_11_comm [label="GPU 144\nExpert Communication" shape=ellipse]
	layer_4_expert_11_comm -> layer_4_expert_11 [style=solid]
	layer_4_expert_12 [label="GPU 152\nExpert 12 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_12 [style=dashed]
	layer_4_expert_12_comm [label="GPU 152\nExpert Communication" shape=ellipse]
	layer_4_expert_12_comm -> layer_4_expert_12 [style=solid]
	layer_4_expert_13 [label="GPU 152\nExpert 13 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_13 [style=dashed]
	layer_4_expert_13_comm [label="GPU 152\nExpert Communication" shape=ellipse]
	layer_4_expert_13_comm -> layer_4_expert_13 [style=solid]
	layer_4_expert_14 [label="GPU 152\nExpert 14 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_14 [style=dashed]
	layer_4_expert_14_comm [label="GPU 152\nExpert Communication" shape=ellipse]
	layer_4_expert_14_comm -> layer_4_expert_14 [style=solid]
	layer_4_expert_15 [label="GPU 152\nExpert 15 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_15 [style=dashed]
	layer_4_expert_15_comm [label="GPU 152\nExpert Communication" shape=ellipse]
	layer_4_expert_15_comm -> layer_4_expert_15 [style=solid]
	layer_4_expert_16 [label="GPU 160\nExpert 16 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_16 [style=dashed]
	layer_4_expert_16_comm [label="GPU 160\nExpert Communication" shape=ellipse]
	layer_4_expert_16_comm -> layer_4_expert_16 [style=solid]
	layer_4_expert_17 [label="GPU 160\nExpert 17 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_17 [style=dashed]
	layer_4_expert_17_comm [label="GPU 160\nExpert Communication" shape=ellipse]
	layer_4_expert_17_comm -> layer_4_expert_17 [style=solid]
	layer_4_expert_18 [label="GPU 160\nExpert 18 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_18 [style=dashed]
	layer_4_expert_18_comm [label="GPU 160\nExpert Communication" shape=ellipse]
	layer_4_expert_18_comm -> layer_4_expert_18 [style=solid]
	layer_4_expert_19 [label="GPU 160\nExpert 19 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_19 [style=dashed]
	layer_4_expert_19_comm [label="GPU 160\nExpert Communication" shape=ellipse]
	layer_4_expert_19_comm -> layer_4_expert_19 [style=solid]
	layer_4_expert_20 [label="GPU 168\nExpert 20 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_20 [style=dashed]
	layer_4_expert_20_comm [label="GPU 168\nExpert Communication" shape=ellipse]
	layer_4_expert_20_comm -> layer_4_expert_20 [style=solid]
	layer_4_expert_21 [label="GPU 168\nExpert 21 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_21 [style=dashed]
	layer_4_expert_21_comm [label="GPU 168\nExpert Communication" shape=ellipse]
	layer_4_expert_21_comm -> layer_4_expert_21 [style=solid]
	layer_4_expert_22 [label="GPU 168\nExpert 22 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_22 [style=dashed]
	layer_4_expert_22_comm [label="GPU 168\nExpert Communication" shape=ellipse]
	layer_4_expert_22_comm -> layer_4_expert_22 [style=solid]
	layer_4_expert_23 [label="GPU 168\nExpert 23 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_23 [style=dashed]
	layer_4_expert_23_comm [label="GPU 168\nExpert Communication" shape=ellipse]
	layer_4_expert_23_comm -> layer_4_expert_23 [style=solid]
	layer_4_expert_24 [label="GPU 176\nExpert 24 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_24 [style=dashed]
	layer_4_expert_24_comm [label="GPU 176\nExpert Communication" shape=ellipse]
	layer_4_expert_24_comm -> layer_4_expert_24 [style=solid]
	layer_4_expert_25 [label="GPU 176\nExpert 25 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_25 [style=dashed]
	layer_4_expert_25_comm [label="GPU 176\nExpert Communication" shape=ellipse]
	layer_4_expert_25_comm -> layer_4_expert_25 [style=solid]
	layer_4_expert_26 [label="GPU 176\nExpert 26 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_26 [style=dashed]
	layer_4_expert_26_comm [label="GPU 176\nExpert Communication" shape=ellipse]
	layer_4_expert_26_comm -> layer_4_expert_26 [style=solid]
	layer_4_expert_27 [label="GPU 176\nExpert 27 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_27 [style=dashed]
	layer_4_expert_27_comm [label="GPU 176\nExpert Communication" shape=ellipse]
	layer_4_expert_27_comm -> layer_4_expert_27 [style=solid]
	layer_4_expert_28 [label="GPU 184\nExpert 28 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_28 [style=dashed]
	layer_4_expert_28_comm [label="GPU 184\nExpert Communication" shape=ellipse]
	layer_4_expert_28_comm -> layer_4_expert_28 [style=solid]
	layer_4_expert_29 [label="GPU 184\nExpert 29 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_29 [style=dashed]
	layer_4_expert_29_comm [label="GPU 184\nExpert Communication" shape=ellipse]
	layer_4_expert_29_comm -> layer_4_expert_29 [style=solid]
	layer_4_expert_30 [label="GPU 184\nExpert 30 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_30 [style=dashed]
	layer_4_expert_30_comm [label="GPU 184\nExpert Communication" shape=ellipse]
	layer_4_expert_30_comm -> layer_4_expert_30 [style=solid]
	layer_4_expert_31 [label="GPU 184\nExpert 31 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_31 [style=dashed]
	layer_4_expert_31_comm [label="GPU 184\nExpert Communication" shape=ellipse]
	layer_4_expert_31_comm -> layer_4_expert_31 [style=solid]
	layer_4_expert_32 [label="GPU 192\nExpert 32 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_32 [style=dashed]
	layer_4_expert_32_comm [label="GPU 192\nExpert Communication" shape=ellipse]
	layer_4_expert_32_comm -> layer_4_expert_32 [style=solid]
	layer_4_expert_33 [label="GPU 192\nExpert 33 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_33 [style=dashed]
	layer_4_expert_33_comm [label="GPU 192\nExpert Communication" shape=ellipse]
	layer_4_expert_33_comm -> layer_4_expert_33 [style=solid]
	layer_4_expert_34 [label="GPU 192\nExpert 34 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_34 [style=dashed]
	layer_4_expert_34_comm [label="GPU 192\nExpert Communication" shape=ellipse]
	layer_4_expert_34_comm -> layer_4_expert_34 [style=solid]
	layer_4_expert_35 [label="GPU 192\nExpert 35 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_35 [style=dashed]
	layer_4_expert_35_comm [label="GPU 192\nExpert Communication" shape=ellipse]
	layer_4_expert_35_comm -> layer_4_expert_35 [style=solid]
	layer_4_expert_36 [label="GPU 200\nExpert 36 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_36 [style=dashed]
	layer_4_expert_36_comm [label="GPU 200\nExpert Communication" shape=ellipse]
	layer_4_expert_36_comm -> layer_4_expert_36 [style=solid]
	layer_4_expert_37 [label="GPU 200\nExpert 37 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_37 [style=dashed]
	layer_4_expert_37_comm [label="GPU 200\nExpert Communication" shape=ellipse]
	layer_4_expert_37_comm -> layer_4_expert_37 [style=solid]
	layer_4_expert_38 [label="GPU 200\nExpert 38 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_38 [style=dashed]
	layer_4_expert_38_comm [label="GPU 200\nExpert Communication" shape=ellipse]
	layer_4_expert_38_comm -> layer_4_expert_38 [style=solid]
	layer_4_expert_39 [label="GPU 200\nExpert 39 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_39 [style=dashed]
	layer_4_expert_39_comm [label="GPU 200\nExpert Communication" shape=ellipse]
	layer_4_expert_39_comm -> layer_4_expert_39 [style=solid]
	layer_4_expert_40 [label="GPU 208\nExpert 40 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_40 [style=dashed]
	layer_4_expert_40_comm [label="GPU 208\nExpert Communication" shape=ellipse]
	layer_4_expert_40_comm -> layer_4_expert_40 [style=solid]
	layer_4_expert_41 [label="GPU 208\nExpert 41 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_41 [style=dashed]
	layer_4_expert_41_comm [label="GPU 208\nExpert Communication" shape=ellipse]
	layer_4_expert_41_comm -> layer_4_expert_41 [style=solid]
	layer_4_expert_42 [label="GPU 208\nExpert 42 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_42 [style=dashed]
	layer_4_expert_42_comm [label="GPU 208\nExpert Communication" shape=ellipse]
	layer_4_expert_42_comm -> layer_4_expert_42 [style=solid]
	layer_4_expert_43 [label="GPU 208\nExpert 43 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_43 [style=dashed]
	layer_4_expert_43_comm [label="GPU 208\nExpert Communication" shape=ellipse]
	layer_4_expert_43_comm -> layer_4_expert_43 [style=solid]
	layer_4_expert_44 [label="GPU 216\nExpert 44 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_44 [style=dashed]
	layer_4_expert_44_comm [label="GPU 216\nExpert Communication" shape=ellipse]
	layer_4_expert_44_comm -> layer_4_expert_44 [style=solid]
	layer_4_expert_45 [label="GPU 216\nExpert 45 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_45 [style=dashed]
	layer_4_expert_45_comm [label="GPU 216\nExpert Communication" shape=ellipse]
	layer_4_expert_45_comm -> layer_4_expert_45 [style=solid]
	layer_4_expert_46 [label="GPU 216\nExpert 46 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_46 [style=dashed]
	layer_4_expert_46_comm [label="GPU 216\nExpert Communication" shape=ellipse]
	layer_4_expert_46_comm -> layer_4_expert_46 [style=solid]
	layer_4_expert_47 [label="GPU 216\nExpert 47 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_47 [style=dashed]
	layer_4_expert_47_comm [label="GPU 216\nExpert Communication" shape=ellipse]
	layer_4_expert_47_comm -> layer_4_expert_47 [style=solid]
	layer_4_expert_48 [label="GPU 224\nExpert 48 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_48 [style=dashed]
	layer_4_expert_48_comm [label="GPU 224\nExpert Communication" shape=ellipse]
	layer_4_expert_48_comm -> layer_4_expert_48 [style=solid]
	layer_4_expert_49 [label="GPU 224\nExpert 49 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_49 [style=dashed]
	layer_4_expert_49_comm [label="GPU 224\nExpert Communication" shape=ellipse]
	layer_4_expert_49_comm -> layer_4_expert_49 [style=solid]
	layer_4_expert_50 [label="GPU 224\nExpert 50 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_50 [style=dashed]
	layer_4_expert_50_comm [label="GPU 224\nExpert Communication" shape=ellipse]
	layer_4_expert_50_comm -> layer_4_expert_50 [style=solid]
	layer_4_expert_51 [label="GPU 224\nExpert 51 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_51 [style=dashed]
	layer_4_expert_51_comm [label="GPU 224\nExpert Communication" shape=ellipse]
	layer_4_expert_51_comm -> layer_4_expert_51 [style=solid]
	layer_4_expert_52 [label="GPU 232\nExpert 52 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_52 [style=dashed]
	layer_4_expert_52_comm [label="GPU 232\nExpert Communication" shape=ellipse]
	layer_4_expert_52_comm -> layer_4_expert_52 [style=solid]
	layer_4_expert_53 [label="GPU 232\nExpert 53 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_53 [style=dashed]
	layer_4_expert_53_comm [label="GPU 232\nExpert Communication" shape=ellipse]
	layer_4_expert_53_comm -> layer_4_expert_53 [style=solid]
	layer_4_expert_54 [label="GPU 232\nExpert 54 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_54 [style=dashed]
	layer_4_expert_54_comm [label="GPU 232\nExpert Communication" shape=ellipse]
	layer_4_expert_54_comm -> layer_4_expert_54 [style=solid]
	layer_4_expert_55 [label="GPU 232\nExpert 55 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_55 [style=dashed]
	layer_4_expert_55_comm [label="GPU 232\nExpert Communication" shape=ellipse]
	layer_4_expert_55_comm -> layer_4_expert_55 [style=solid]
	layer_4_expert_56 [label="GPU 240\nExpert 56 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_56 [style=dashed]
	layer_4_expert_56_comm [label="GPU 240\nExpert Communication" shape=ellipse]
	layer_4_expert_56_comm -> layer_4_expert_56 [style=solid]
	layer_4_expert_57 [label="GPU 240\nExpert 57 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_57 [style=dashed]
	layer_4_expert_57_comm [label="GPU 240\nExpert Communication" shape=ellipse]
	layer_4_expert_57_comm -> layer_4_expert_57 [style=solid]
	layer_4_expert_58 [label="GPU 240\nExpert 58 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_58 [style=dashed]
	layer_4_expert_58_comm [label="GPU 240\nExpert Communication" shape=ellipse]
	layer_4_expert_58_comm -> layer_4_expert_58 [style=solid]
	layer_4_expert_59 [label="GPU 240\nExpert 59 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_59 [style=dashed]
	layer_4_expert_59_comm [label="GPU 240\nExpert Communication" shape=ellipse]
	layer_4_expert_59_comm -> layer_4_expert_59 [style=solid]
	layer_4_expert_60 [label="GPU 248\nExpert 60 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_60 [style=dashed]
	layer_4_expert_60_comm [label="GPU 248\nExpert Communication" shape=ellipse]
	layer_4_expert_60_comm -> layer_4_expert_60 [style=solid]
	layer_4_expert_61 [label="GPU 248\nExpert 61 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_61 [style=dashed]
	layer_4_expert_61_comm [label="GPU 248\nExpert Communication" shape=ellipse]
	layer_4_expert_61_comm -> layer_4_expert_61 [style=solid]
	layer_4_expert_62 [label="GPU 248\nExpert 62 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_62 [style=dashed]
	layer_4_expert_62_comm [label="GPU 248\nExpert Communication" shape=ellipse]
	layer_4_expert_62_comm -> layer_4_expert_62 [style=solid]
	layer_4_expert_63 [label="GPU 248\nExpert 63 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_4_gate -> layer_4_expert_63 [style=dashed]
	layer_4_expert_63_comm [label="GPU 248\nExpert Communication" shape=ellipse]
	layer_4_expert_63_comm -> layer_4_expert_63 [style=solid]
	layer_4_expert_agg [label="GPU 128\nExpert Aggregation (Weighted Sum)\nInput: [batch_size=16, seq_len=10240, experts=64, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=parallelogram]
	layer_4_expert_0 -> layer_4_expert_agg [style=solid]
	layer_4_expert_1 -> layer_4_expert_agg [style=solid]
	layer_4_expert_2 -> layer_4_expert_agg [style=solid]
	layer_4_expert_3 -> layer_4_expert_agg [style=solid]
	layer_4_expert_4 -> layer_4_expert_agg [style=solid]
	layer_4_expert_5 -> layer_4_expert_agg [style=solid]
	layer_4_expert_6 -> layer_4_expert_agg [style=solid]
	layer_4_expert_7 -> layer_4_expert_agg [style=solid]
	layer_4_expert_8 -> layer_4_expert_agg [style=solid]
	layer_4_expert_9 -> layer_4_expert_agg [style=solid]
	layer_4_expert_10 -> layer_4_expert_agg [style=solid]
	layer_4_expert_11 -> layer_4_expert_agg [style=solid]
	layer_4_expert_12 -> layer_4_expert_agg [style=solid]
	layer_4_expert_13 -> layer_4_expert_agg [style=solid]
	layer_4_expert_14 -> layer_4_expert_agg [style=solid]
	layer_4_expert_15 -> layer_4_expert_agg [style=solid]
	layer_4_expert_16 -> layer_4_expert_agg [style=solid]
	layer_4_expert_17 -> layer_4_expert_agg [style=solid]
	layer_4_expert_18 -> layer_4_expert_agg [style=solid]
	layer_4_expert_19 -> layer_4_expert_agg [style=solid]
	layer_4_expert_20 -> layer_4_expert_agg [style=solid]
	layer_4_expert_21 -> layer_4_expert_agg [style=solid]
	layer_4_expert_22 -> layer_4_expert_agg [style=solid]
	layer_4_expert_23 -> layer_4_expert_agg [style=solid]
	layer_4_expert_24 -> layer_4_expert_agg [style=solid]
	layer_4_expert_25 -> layer_4_expert_agg [style=solid]
	layer_4_expert_26 -> layer_4_expert_agg [style=solid]
	layer_4_expert_27 -> layer_4_expert_agg [style=solid]
	layer_4_expert_28 -> layer_4_expert_agg [style=solid]
	layer_4_expert_29 -> layer_4_expert_agg [style=solid]
	layer_4_expert_30 -> layer_4_expert_agg [style=solid]
	layer_4_expert_31 -> layer_4_expert_agg [style=solid]
	layer_4_expert_32 -> layer_4_expert_agg [style=solid]
	layer_4_expert_33 -> layer_4_expert_agg [style=solid]
	layer_4_expert_34 -> layer_4_expert_agg [style=solid]
	layer_4_expert_35 -> layer_4_expert_agg [style=solid]
	layer_4_expert_36 -> layer_4_expert_agg [style=solid]
	layer_4_expert_37 -> layer_4_expert_agg [style=solid]
	layer_4_expert_38 -> layer_4_expert_agg [style=solid]
	layer_4_expert_39 -> layer_4_expert_agg [style=solid]
	layer_4_expert_40 -> layer_4_expert_agg [style=solid]
	layer_4_expert_41 -> layer_4_expert_agg [style=solid]
	layer_4_expert_42 -> layer_4_expert_agg [style=solid]
	layer_4_expert_43 -> layer_4_expert_agg [style=solid]
	layer_4_expert_44 -> layer_4_expert_agg [style=solid]
	layer_4_expert_45 -> layer_4_expert_agg [style=solid]
	layer_4_expert_46 -> layer_4_expert_agg [style=solid]
	layer_4_expert_47 -> layer_4_expert_agg [style=solid]
	layer_4_expert_48 -> layer_4_expert_agg [style=solid]
	layer_4_expert_49 -> layer_4_expert_agg [style=solid]
	layer_4_expert_50 -> layer_4_expert_agg [style=solid]
	layer_4_expert_51 -> layer_4_expert_agg [style=solid]
	layer_4_expert_52 -> layer_4_expert_agg [style=solid]
	layer_4_expert_53 -> layer_4_expert_agg [style=solid]
	layer_4_expert_54 -> layer_4_expert_agg [style=solid]
	layer_4_expert_55 -> layer_4_expert_agg [style=solid]
	layer_4_expert_56 -> layer_4_expert_agg [style=solid]
	layer_4_expert_57 -> layer_4_expert_agg [style=solid]
	layer_4_expert_58 -> layer_4_expert_agg [style=solid]
	layer_4_expert_59 -> layer_4_expert_agg [style=solid]
	layer_4_expert_60 -> layer_4_expert_agg [style=solid]
	layer_4_expert_61 -> layer_4_expert_agg [style=solid]
	layer_4_expert_62 -> layer_4_expert_agg [style=solid]
	layer_4_expert_63 -> layer_4_expert_agg [style=solid]
	layer_4_expert_agg -> layer_4_moe [style=solid]
	layer_4_norm [label="GPU 128\nLayer Normalization\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_4_moe -> layer_4_norm [style=solid]
	layer_4_dp_comm [label="GPU 128\nData Parallel All-Reduce" shape=ellipse]
	layer_4_norm -> layer_4_dp_comm [style=solid]
	layer_4_dp_comm -> layer_5_attn [style=solid]
	layer_5_attn [label="GPU 128\nLayer 5 Self-Attention\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_5_attn_comm [label="GPU 128\nAttention Communication" shape=ellipse]
	layer_4_attn -> layer_5_attn_comm [style=solid]
	layer_5_attn_comm -> layer_5_attn [style=solid]
	layer_5_moe [label="GPU 128\nLayer 5 MoE Layer\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_5_attn -> layer_5_moe [style=solid]
	layer_5_gate [label="GPU 128\nExpert Gate (Top-2)\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, experts=2]" shape=parallelogram]
	layer_5_attn -> layer_5_gate [style=solid]
	layer_5_expert_0 [label="GPU 128\nExpert 0 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_0 [style=dashed]
	layer_5_expert_1 [label="GPU 128\nExpert 1 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_1 [style=dashed]
	layer_5_expert_2 [label="GPU 128\nExpert 2 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_2 [style=dashed]
	layer_5_expert_3 [label="GPU 128\nExpert 3 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_3 [style=dashed]
	layer_5_expert_4 [label="GPU 136\nExpert 4 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_4 [style=dashed]
	layer_5_expert_4_comm [label="GPU 136\nExpert Communication" shape=ellipse]
	layer_5_expert_4_comm -> layer_5_expert_4 [style=solid]
	layer_5_expert_5 [label="GPU 136\nExpert 5 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_5 [style=dashed]
	layer_5_expert_5_comm [label="GPU 136\nExpert Communication" shape=ellipse]
	layer_5_expert_5_comm -> layer_5_expert_5 [style=solid]
	layer_5_expert_6 [label="GPU 136\nExpert 6 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_6 [style=dashed]
	layer_5_expert_6_comm [label="GPU 136\nExpert Communication" shape=ellipse]
	layer_5_expert_6_comm -> layer_5_expert_6 [style=solid]
	layer_5_expert_7 [label="GPU 136\nExpert 7 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_7 [style=dashed]
	layer_5_expert_7_comm [label="GPU 136\nExpert Communication" shape=ellipse]
	layer_5_expert_7_comm -> layer_5_expert_7 [style=solid]
	layer_5_expert_8 [label="GPU 144\nExpert 8 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_8 [style=dashed]
	layer_5_expert_8_comm [label="GPU 144\nExpert Communication" shape=ellipse]
	layer_5_expert_8_comm -> layer_5_expert_8 [style=solid]
	layer_5_expert_9 [label="GPU 144\nExpert 9 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_9 [style=dashed]
	layer_5_expert_9_comm [label="GPU 144\nExpert Communication" shape=ellipse]
	layer_5_expert_9_comm -> layer_5_expert_9 [style=solid]
	layer_5_expert_10 [label="GPU 144\nExpert 10 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_10 [style=dashed]
	layer_5_expert_10_comm [label="GPU 144\nExpert Communication" shape=ellipse]
	layer_5_expert_10_comm -> layer_5_expert_10 [style=solid]
	layer_5_expert_11 [label="GPU 144\nExpert 11 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_11 [style=dashed]
	layer_5_expert_11_comm [label="GPU 144\nExpert Communication" shape=ellipse]
	layer_5_expert_11_comm -> layer_5_expert_11 [style=solid]
	layer_5_expert_12 [label="GPU 152\nExpert 12 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_12 [style=dashed]
	layer_5_expert_12_comm [label="GPU 152\nExpert Communication" shape=ellipse]
	layer_5_expert_12_comm -> layer_5_expert_12 [style=solid]
	layer_5_expert_13 [label="GPU 152\nExpert 13 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_13 [style=dashed]
	layer_5_expert_13_comm [label="GPU 152\nExpert Communication" shape=ellipse]
	layer_5_expert_13_comm -> layer_5_expert_13 [style=solid]
	layer_5_expert_14 [label="GPU 152\nExpert 14 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_14 [style=dashed]
	layer_5_expert_14_comm [label="GPU 152\nExpert Communication" shape=ellipse]
	layer_5_expert_14_comm -> layer_5_expert_14 [style=solid]
	layer_5_expert_15 [label="GPU 152\nExpert 15 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_15 [style=dashed]
	layer_5_expert_15_comm [label="GPU 152\nExpert Communication" shape=ellipse]
	layer_5_expert_15_comm -> layer_5_expert_15 [style=solid]
	layer_5_expert_16 [label="GPU 160\nExpert 16 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_16 [style=dashed]
	layer_5_expert_16_comm [label="GPU 160\nExpert Communication" shape=ellipse]
	layer_5_expert_16_comm -> layer_5_expert_16 [style=solid]
	layer_5_expert_17 [label="GPU 160\nExpert 17 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_17 [style=dashed]
	layer_5_expert_17_comm [label="GPU 160\nExpert Communication" shape=ellipse]
	layer_5_expert_17_comm -> layer_5_expert_17 [style=solid]
	layer_5_expert_18 [label="GPU 160\nExpert 18 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_18 [style=dashed]
	layer_5_expert_18_comm [label="GPU 160\nExpert Communication" shape=ellipse]
	layer_5_expert_18_comm -> layer_5_expert_18 [style=solid]
	layer_5_expert_19 [label="GPU 160\nExpert 19 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_19 [style=dashed]
	layer_5_expert_19_comm [label="GPU 160\nExpert Communication" shape=ellipse]
	layer_5_expert_19_comm -> layer_5_expert_19 [style=solid]
	layer_5_expert_20 [label="GPU 168\nExpert 20 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_20 [style=dashed]
	layer_5_expert_20_comm [label="GPU 168\nExpert Communication" shape=ellipse]
	layer_5_expert_20_comm -> layer_5_expert_20 [style=solid]
	layer_5_expert_21 [label="GPU 168\nExpert 21 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_21 [style=dashed]
	layer_5_expert_21_comm [label="GPU 168\nExpert Communication" shape=ellipse]
	layer_5_expert_21_comm -> layer_5_expert_21 [style=solid]
	layer_5_expert_22 [label="GPU 168\nExpert 22 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_22 [style=dashed]
	layer_5_expert_22_comm [label="GPU 168\nExpert Communication" shape=ellipse]
	layer_5_expert_22_comm -> layer_5_expert_22 [style=solid]
	layer_5_expert_23 [label="GPU 168\nExpert 23 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_23 [style=dashed]
	layer_5_expert_23_comm [label="GPU 168\nExpert Communication" shape=ellipse]
	layer_5_expert_23_comm -> layer_5_expert_23 [style=solid]
	layer_5_expert_24 [label="GPU 176\nExpert 24 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_24 [style=dashed]
	layer_5_expert_24_comm [label="GPU 176\nExpert Communication" shape=ellipse]
	layer_5_expert_24_comm -> layer_5_expert_24 [style=solid]
	layer_5_expert_25 [label="GPU 176\nExpert 25 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_25 [style=dashed]
	layer_5_expert_25_comm [label="GPU 176\nExpert Communication" shape=ellipse]
	layer_5_expert_25_comm -> layer_5_expert_25 [style=solid]
	layer_5_expert_26 [label="GPU 176\nExpert 26 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_26 [style=dashed]
	layer_5_expert_26_comm [label="GPU 176\nExpert Communication" shape=ellipse]
	layer_5_expert_26_comm -> layer_5_expert_26 [style=solid]
	layer_5_expert_27 [label="GPU 176\nExpert 27 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_27 [style=dashed]
	layer_5_expert_27_comm [label="GPU 176\nExpert Communication" shape=ellipse]
	layer_5_expert_27_comm -> layer_5_expert_27 [style=solid]
	layer_5_expert_28 [label="GPU 184\nExpert 28 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_28 [style=dashed]
	layer_5_expert_28_comm [label="GPU 184\nExpert Communication" shape=ellipse]
	layer_5_expert_28_comm -> layer_5_expert_28 [style=solid]
	layer_5_expert_29 [label="GPU 184\nExpert 29 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_29 [style=dashed]
	layer_5_expert_29_comm [label="GPU 184\nExpert Communication" shape=ellipse]
	layer_5_expert_29_comm -> layer_5_expert_29 [style=solid]
	layer_5_expert_30 [label="GPU 184\nExpert 30 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_30 [style=dashed]
	layer_5_expert_30_comm [label="GPU 184\nExpert Communication" shape=ellipse]
	layer_5_expert_30_comm -> layer_5_expert_30 [style=solid]
	layer_5_expert_31 [label="GPU 184\nExpert 31 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_31 [style=dashed]
	layer_5_expert_31_comm [label="GPU 184\nExpert Communication" shape=ellipse]
	layer_5_expert_31_comm -> layer_5_expert_31 [style=solid]
	layer_5_expert_32 [label="GPU 192\nExpert 32 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_32 [style=dashed]
	layer_5_expert_32_comm [label="GPU 192\nExpert Communication" shape=ellipse]
	layer_5_expert_32_comm -> layer_5_expert_32 [style=solid]
	layer_5_expert_33 [label="GPU 192\nExpert 33 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_33 [style=dashed]
	layer_5_expert_33_comm [label="GPU 192\nExpert Communication" shape=ellipse]
	layer_5_expert_33_comm -> layer_5_expert_33 [style=solid]
	layer_5_expert_34 [label="GPU 192\nExpert 34 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_34 [style=dashed]
	layer_5_expert_34_comm [label="GPU 192\nExpert Communication" shape=ellipse]
	layer_5_expert_34_comm -> layer_5_expert_34 [style=solid]
	layer_5_expert_35 [label="GPU 192\nExpert 35 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_35 [style=dashed]
	layer_5_expert_35_comm [label="GPU 192\nExpert Communication" shape=ellipse]
	layer_5_expert_35_comm -> layer_5_expert_35 [style=solid]
	layer_5_expert_36 [label="GPU 200\nExpert 36 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_36 [style=dashed]
	layer_5_expert_36_comm [label="GPU 200\nExpert Communication" shape=ellipse]
	layer_5_expert_36_comm -> layer_5_expert_36 [style=solid]
	layer_5_expert_37 [label="GPU 200\nExpert 37 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_37 [style=dashed]
	layer_5_expert_37_comm [label="GPU 200\nExpert Communication" shape=ellipse]
	layer_5_expert_37_comm -> layer_5_expert_37 [style=solid]
	layer_5_expert_38 [label="GPU 200\nExpert 38 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_38 [style=dashed]
	layer_5_expert_38_comm [label="GPU 200\nExpert Communication" shape=ellipse]
	layer_5_expert_38_comm -> layer_5_expert_38 [style=solid]
	layer_5_expert_39 [label="GPU 200\nExpert 39 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_39 [style=dashed]
	layer_5_expert_39_comm [label="GPU 200\nExpert Communication" shape=ellipse]
	layer_5_expert_39_comm -> layer_5_expert_39 [style=solid]
	layer_5_expert_40 [label="GPU 208\nExpert 40 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_40 [style=dashed]
	layer_5_expert_40_comm [label="GPU 208\nExpert Communication" shape=ellipse]
	layer_5_expert_40_comm -> layer_5_expert_40 [style=solid]
	layer_5_expert_41 [label="GPU 208\nExpert 41 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_41 [style=dashed]
	layer_5_expert_41_comm [label="GPU 208\nExpert Communication" shape=ellipse]
	layer_5_expert_41_comm -> layer_5_expert_41 [style=solid]
	layer_5_expert_42 [label="GPU 208\nExpert 42 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_42 [style=dashed]
	layer_5_expert_42_comm [label="GPU 208\nExpert Communication" shape=ellipse]
	layer_5_expert_42_comm -> layer_5_expert_42 [style=solid]
	layer_5_expert_43 [label="GPU 208\nExpert 43 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_43 [style=dashed]
	layer_5_expert_43_comm [label="GPU 208\nExpert Communication" shape=ellipse]
	layer_5_expert_43_comm -> layer_5_expert_43 [style=solid]
	layer_5_expert_44 [label="GPU 216\nExpert 44 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_44 [style=dashed]
	layer_5_expert_44_comm [label="GPU 216\nExpert Communication" shape=ellipse]
	layer_5_expert_44_comm -> layer_5_expert_44 [style=solid]
	layer_5_expert_45 [label="GPU 216\nExpert 45 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_45 [style=dashed]
	layer_5_expert_45_comm [label="GPU 216\nExpert Communication" shape=ellipse]
	layer_5_expert_45_comm -> layer_5_expert_45 [style=solid]
	layer_5_expert_46 [label="GPU 216\nExpert 46 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_46 [style=dashed]
	layer_5_expert_46_comm [label="GPU 216\nExpert Communication" shape=ellipse]
	layer_5_expert_46_comm -> layer_5_expert_46 [style=solid]
	layer_5_expert_47 [label="GPU 216\nExpert 47 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_47 [style=dashed]
	layer_5_expert_47_comm [label="GPU 216\nExpert Communication" shape=ellipse]
	layer_5_expert_47_comm -> layer_5_expert_47 [style=solid]
	layer_5_expert_48 [label="GPU 224\nExpert 48 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_48 [style=dashed]
	layer_5_expert_48_comm [label="GPU 224\nExpert Communication" shape=ellipse]
	layer_5_expert_48_comm -> layer_5_expert_48 [style=solid]
	layer_5_expert_49 [label="GPU 224\nExpert 49 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_49 [style=dashed]
	layer_5_expert_49_comm [label="GPU 224\nExpert Communication" shape=ellipse]
	layer_5_expert_49_comm -> layer_5_expert_49 [style=solid]
	layer_5_expert_50 [label="GPU 224\nExpert 50 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_50 [style=dashed]
	layer_5_expert_50_comm [label="GPU 224\nExpert Communication" shape=ellipse]
	layer_5_expert_50_comm -> layer_5_expert_50 [style=solid]
	layer_5_expert_51 [label="GPU 224\nExpert 51 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_51 [style=dashed]
	layer_5_expert_51_comm [label="GPU 224\nExpert Communication" shape=ellipse]
	layer_5_expert_51_comm -> layer_5_expert_51 [style=solid]
	layer_5_expert_52 [label="GPU 232\nExpert 52 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_52 [style=dashed]
	layer_5_expert_52_comm [label="GPU 232\nExpert Communication" shape=ellipse]
	layer_5_expert_52_comm -> layer_5_expert_52 [style=solid]
	layer_5_expert_53 [label="GPU 232\nExpert 53 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_53 [style=dashed]
	layer_5_expert_53_comm [label="GPU 232\nExpert Communication" shape=ellipse]
	layer_5_expert_53_comm -> layer_5_expert_53 [style=solid]
	layer_5_expert_54 [label="GPU 232\nExpert 54 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_54 [style=dashed]
	layer_5_expert_54_comm [label="GPU 232\nExpert Communication" shape=ellipse]
	layer_5_expert_54_comm -> layer_5_expert_54 [style=solid]
	layer_5_expert_55 [label="GPU 232\nExpert 55 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_55 [style=dashed]
	layer_5_expert_55_comm [label="GPU 232\nExpert Communication" shape=ellipse]
	layer_5_expert_55_comm -> layer_5_expert_55 [style=solid]
	layer_5_expert_56 [label="GPU 240\nExpert 56 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_56 [style=dashed]
	layer_5_expert_56_comm [label="GPU 240\nExpert Communication" shape=ellipse]
	layer_5_expert_56_comm -> layer_5_expert_56 [style=solid]
	layer_5_expert_57 [label="GPU 240\nExpert 57 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_57 [style=dashed]
	layer_5_expert_57_comm [label="GPU 240\nExpert Communication" shape=ellipse]
	layer_5_expert_57_comm -> layer_5_expert_57 [style=solid]
	layer_5_expert_58 [label="GPU 240\nExpert 58 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_58 [style=dashed]
	layer_5_expert_58_comm [label="GPU 240\nExpert Communication" shape=ellipse]
	layer_5_expert_58_comm -> layer_5_expert_58 [style=solid]
	layer_5_expert_59 [label="GPU 240\nExpert 59 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_59 [style=dashed]
	layer_5_expert_59_comm [label="GPU 240\nExpert Communication" shape=ellipse]
	layer_5_expert_59_comm -> layer_5_expert_59 [style=solid]
	layer_5_expert_60 [label="GPU 248\nExpert 60 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_60 [style=dashed]
	layer_5_expert_60_comm [label="GPU 248\nExpert Communication" shape=ellipse]
	layer_5_expert_60_comm -> layer_5_expert_60 [style=solid]
	layer_5_expert_61 [label="GPU 248\nExpert 61 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_61 [style=dashed]
	layer_5_expert_61_comm [label="GPU 248\nExpert Communication" shape=ellipse]
	layer_5_expert_61_comm -> layer_5_expert_61 [style=solid]
	layer_5_expert_62 [label="GPU 248\nExpert 62 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_62 [style=dashed]
	layer_5_expert_62_comm [label="GPU 248\nExpert Communication" shape=ellipse]
	layer_5_expert_62_comm -> layer_5_expert_62 [style=solid]
	layer_5_expert_63 [label="GPU 248\nExpert 63 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_5_gate -> layer_5_expert_63 [style=dashed]
	layer_5_expert_63_comm [label="GPU 248\nExpert Communication" shape=ellipse]
	layer_5_expert_63_comm -> layer_5_expert_63 [style=solid]
	layer_5_expert_agg [label="GPU 128\nExpert Aggregation (Weighted Sum)\nInput: [batch_size=16, seq_len=10240, experts=64, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=parallelogram]
	layer_5_expert_0 -> layer_5_expert_agg [style=solid]
	layer_5_expert_1 -> layer_5_expert_agg [style=solid]
	layer_5_expert_2 -> layer_5_expert_agg [style=solid]
	layer_5_expert_3 -> layer_5_expert_agg [style=solid]
	layer_5_expert_4 -> layer_5_expert_agg [style=solid]
	layer_5_expert_5 -> layer_5_expert_agg [style=solid]
	layer_5_expert_6 -> layer_5_expert_agg [style=solid]
	layer_5_expert_7 -> layer_5_expert_agg [style=solid]
	layer_5_expert_8 -> layer_5_expert_agg [style=solid]
	layer_5_expert_9 -> layer_5_expert_agg [style=solid]
	layer_5_expert_10 -> layer_5_expert_agg [style=solid]
	layer_5_expert_11 -> layer_5_expert_agg [style=solid]
	layer_5_expert_12 -> layer_5_expert_agg [style=solid]
	layer_5_expert_13 -> layer_5_expert_agg [style=solid]
	layer_5_expert_14 -> layer_5_expert_agg [style=solid]
	layer_5_expert_15 -> layer_5_expert_agg [style=solid]
	layer_5_expert_16 -> layer_5_expert_agg [style=solid]
	layer_5_expert_17 -> layer_5_expert_agg [style=solid]
	layer_5_expert_18 -> layer_5_expert_agg [style=solid]
	layer_5_expert_19 -> layer_5_expert_agg [style=solid]
	layer_5_expert_20 -> layer_5_expert_agg [style=solid]
	layer_5_expert_21 -> layer_5_expert_agg [style=solid]
	layer_5_expert_22 -> layer_5_expert_agg [style=solid]
	layer_5_expert_23 -> layer_5_expert_agg [style=solid]
	layer_5_expert_24 -> layer_5_expert_agg [style=solid]
	layer_5_expert_25 -> layer_5_expert_agg [style=solid]
	layer_5_expert_26 -> layer_5_expert_agg [style=solid]
	layer_5_expert_27 -> layer_5_expert_agg [style=solid]
	layer_5_expert_28 -> layer_5_expert_agg [style=solid]
	layer_5_expert_29 -> layer_5_expert_agg [style=solid]
	layer_5_expert_30 -> layer_5_expert_agg [style=solid]
	layer_5_expert_31 -> layer_5_expert_agg [style=solid]
	layer_5_expert_32 -> layer_5_expert_agg [style=solid]
	layer_5_expert_33 -> layer_5_expert_agg [style=solid]
	layer_5_expert_34 -> layer_5_expert_agg [style=solid]
	layer_5_expert_35 -> layer_5_expert_agg [style=solid]
	layer_5_expert_36 -> layer_5_expert_agg [style=solid]
	layer_5_expert_37 -> layer_5_expert_agg [style=solid]
	layer_5_expert_38 -> layer_5_expert_agg [style=solid]
	layer_5_expert_39 -> layer_5_expert_agg [style=solid]
	layer_5_expert_40 -> layer_5_expert_agg [style=solid]
	layer_5_expert_41 -> layer_5_expert_agg [style=solid]
	layer_5_expert_42 -> layer_5_expert_agg [style=solid]
	layer_5_expert_43 -> layer_5_expert_agg [style=solid]
	layer_5_expert_44 -> layer_5_expert_agg [style=solid]
	layer_5_expert_45 -> layer_5_expert_agg [style=solid]
	layer_5_expert_46 -> layer_5_expert_agg [style=solid]
	layer_5_expert_47 -> layer_5_expert_agg [style=solid]
	layer_5_expert_48 -> layer_5_expert_agg [style=solid]
	layer_5_expert_49 -> layer_5_expert_agg [style=solid]
	layer_5_expert_50 -> layer_5_expert_agg [style=solid]
	layer_5_expert_51 -> layer_5_expert_agg [style=solid]
	layer_5_expert_52 -> layer_5_expert_agg [style=solid]
	layer_5_expert_53 -> layer_5_expert_agg [style=solid]
	layer_5_expert_54 -> layer_5_expert_agg [style=solid]
	layer_5_expert_55 -> layer_5_expert_agg [style=solid]
	layer_5_expert_56 -> layer_5_expert_agg [style=solid]
	layer_5_expert_57 -> layer_5_expert_agg [style=solid]
	layer_5_expert_58 -> layer_5_expert_agg [style=solid]
	layer_5_expert_59 -> layer_5_expert_agg [style=solid]
	layer_5_expert_60 -> layer_5_expert_agg [style=solid]
	layer_5_expert_61 -> layer_5_expert_agg [style=solid]
	layer_5_expert_62 -> layer_5_expert_agg [style=solid]
	layer_5_expert_63 -> layer_5_expert_agg [style=solid]
	layer_5_expert_agg -> layer_5_moe [style=solid]
	layer_5_norm [label="GPU 128\nLayer Normalization\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_5_moe -> layer_5_norm [style=solid]
	layer_5_dp_comm [label="GPU 128\nData Parallel All-Reduce" shape=ellipse]
	layer_5_norm -> layer_5_dp_comm [style=solid]
	layer_5_dp_comm -> layer_6_attn [style=solid]
	layer_6_attn [label="GPU 128\nLayer 6 Self-Attention\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_6_attn_comm [label="GPU 128\nAttention Communication" shape=ellipse]
	layer_5_attn -> layer_6_attn_comm [style=solid]
	layer_6_attn_comm -> layer_6_attn [style=solid]
	layer_6_moe [label="GPU 128\nLayer 6 MoE Layer\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_6_attn -> layer_6_moe [style=solid]
	layer_6_gate [label="GPU 128\nExpert Gate (Top-2)\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, experts=2]" shape=parallelogram]
	layer_6_attn -> layer_6_gate [style=solid]
	layer_6_expert_0 [label="GPU 128\nExpert 0 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_0 [style=dashed]
	layer_6_expert_1 [label="GPU 128\nExpert 1 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_1 [style=dashed]
	layer_6_expert_2 [label="GPU 128\nExpert 2 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_2 [style=dashed]
	layer_6_expert_3 [label="GPU 128\nExpert 3 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_3 [style=dashed]
	layer_6_expert_4 [label="GPU 136\nExpert 4 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_4 [style=dashed]
	layer_6_expert_4_comm [label="GPU 136\nExpert Communication" shape=ellipse]
	layer_6_expert_4_comm -> layer_6_expert_4 [style=solid]
	layer_6_expert_5 [label="GPU 136\nExpert 5 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_5 [style=dashed]
	layer_6_expert_5_comm [label="GPU 136\nExpert Communication" shape=ellipse]
	layer_6_expert_5_comm -> layer_6_expert_5 [style=solid]
	layer_6_expert_6 [label="GPU 136\nExpert 6 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_6 [style=dashed]
	layer_6_expert_6_comm [label="GPU 136\nExpert Communication" shape=ellipse]
	layer_6_expert_6_comm -> layer_6_expert_6 [style=solid]
	layer_6_expert_7 [label="GPU 136\nExpert 7 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_7 [style=dashed]
	layer_6_expert_7_comm [label="GPU 136\nExpert Communication" shape=ellipse]
	layer_6_expert_7_comm -> layer_6_expert_7 [style=solid]
	layer_6_expert_8 [label="GPU 144\nExpert 8 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_8 [style=dashed]
	layer_6_expert_8_comm [label="GPU 144\nExpert Communication" shape=ellipse]
	layer_6_expert_8_comm -> layer_6_expert_8 [style=solid]
	layer_6_expert_9 [label="GPU 144\nExpert 9 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_9 [style=dashed]
	layer_6_expert_9_comm [label="GPU 144\nExpert Communication" shape=ellipse]
	layer_6_expert_9_comm -> layer_6_expert_9 [style=solid]
	layer_6_expert_10 [label="GPU 144\nExpert 10 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_10 [style=dashed]
	layer_6_expert_10_comm [label="GPU 144\nExpert Communication" shape=ellipse]
	layer_6_expert_10_comm -> layer_6_expert_10 [style=solid]
	layer_6_expert_11 [label="GPU 144\nExpert 11 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_11 [style=dashed]
	layer_6_expert_11_comm [label="GPU 144\nExpert Communication" shape=ellipse]
	layer_6_expert_11_comm -> layer_6_expert_11 [style=solid]
	layer_6_expert_12 [label="GPU 152\nExpert 12 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_12 [style=dashed]
	layer_6_expert_12_comm [label="GPU 152\nExpert Communication" shape=ellipse]
	layer_6_expert_12_comm -> layer_6_expert_12 [style=solid]
	layer_6_expert_13 [label="GPU 152\nExpert 13 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_13 [style=dashed]
	layer_6_expert_13_comm [label="GPU 152\nExpert Communication" shape=ellipse]
	layer_6_expert_13_comm -> layer_6_expert_13 [style=solid]
	layer_6_expert_14 [label="GPU 152\nExpert 14 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_14 [style=dashed]
	layer_6_expert_14_comm [label="GPU 152\nExpert Communication" shape=ellipse]
	layer_6_expert_14_comm -> layer_6_expert_14 [style=solid]
	layer_6_expert_15 [label="GPU 152\nExpert 15 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_15 [style=dashed]
	layer_6_expert_15_comm [label="GPU 152\nExpert Communication" shape=ellipse]
	layer_6_expert_15_comm -> layer_6_expert_15 [style=solid]
	layer_6_expert_16 [label="GPU 160\nExpert 16 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_16 [style=dashed]
	layer_6_expert_16_comm [label="GPU 160\nExpert Communication" shape=ellipse]
	layer_6_expert_16_comm -> layer_6_expert_16 [style=solid]
	layer_6_expert_17 [label="GPU 160\nExpert 17 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_17 [style=dashed]
	layer_6_expert_17_comm [label="GPU 160\nExpert Communication" shape=ellipse]
	layer_6_expert_17_comm -> layer_6_expert_17 [style=solid]
	layer_6_expert_18 [label="GPU 160\nExpert 18 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_18 [style=dashed]
	layer_6_expert_18_comm [label="GPU 160\nExpert Communication" shape=ellipse]
	layer_6_expert_18_comm -> layer_6_expert_18 [style=solid]
	layer_6_expert_19 [label="GPU 160\nExpert 19 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_19 [style=dashed]
	layer_6_expert_19_comm [label="GPU 160\nExpert Communication" shape=ellipse]
	layer_6_expert_19_comm -> layer_6_expert_19 [style=solid]
	layer_6_expert_20 [label="GPU 168\nExpert 20 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_20 [style=dashed]
	layer_6_expert_20_comm [label="GPU 168\nExpert Communication" shape=ellipse]
	layer_6_expert_20_comm -> layer_6_expert_20 [style=solid]
	layer_6_expert_21 [label="GPU 168\nExpert 21 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_21 [style=dashed]
	layer_6_expert_21_comm [label="GPU 168\nExpert Communication" shape=ellipse]
	layer_6_expert_21_comm -> layer_6_expert_21 [style=solid]
	layer_6_expert_22 [label="GPU 168\nExpert 22 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_22 [style=dashed]
	layer_6_expert_22_comm [label="GPU 168\nExpert Communication" shape=ellipse]
	layer_6_expert_22_comm -> layer_6_expert_22 [style=solid]
	layer_6_expert_23 [label="GPU 168\nExpert 23 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_23 [style=dashed]
	layer_6_expert_23_comm [label="GPU 168\nExpert Communication" shape=ellipse]
	layer_6_expert_23_comm -> layer_6_expert_23 [style=solid]
	layer_6_expert_24 [label="GPU 176\nExpert 24 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_24 [style=dashed]
	layer_6_expert_24_comm [label="GPU 176\nExpert Communication" shape=ellipse]
	layer_6_expert_24_comm -> layer_6_expert_24 [style=solid]
	layer_6_expert_25 [label="GPU 176\nExpert 25 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_25 [style=dashed]
	layer_6_expert_25_comm [label="GPU 176\nExpert Communication" shape=ellipse]
	layer_6_expert_25_comm -> layer_6_expert_25 [style=solid]
	layer_6_expert_26 [label="GPU 176\nExpert 26 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_26 [style=dashed]
	layer_6_expert_26_comm [label="GPU 176\nExpert Communication" shape=ellipse]
	layer_6_expert_26_comm -> layer_6_expert_26 [style=solid]
	layer_6_expert_27 [label="GPU 176\nExpert 27 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_27 [style=dashed]
	layer_6_expert_27_comm [label="GPU 176\nExpert Communication" shape=ellipse]
	layer_6_expert_27_comm -> layer_6_expert_27 [style=solid]
	layer_6_expert_28 [label="GPU 184\nExpert 28 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_28 [style=dashed]
	layer_6_expert_28_comm [label="GPU 184\nExpert Communication" shape=ellipse]
	layer_6_expert_28_comm -> layer_6_expert_28 [style=solid]
	layer_6_expert_29 [label="GPU 184\nExpert 29 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_29 [style=dashed]
	layer_6_expert_29_comm [label="GPU 184\nExpert Communication" shape=ellipse]
	layer_6_expert_29_comm -> layer_6_expert_29 [style=solid]
	layer_6_expert_30 [label="GPU 184\nExpert 30 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_30 [style=dashed]
	layer_6_expert_30_comm [label="GPU 184\nExpert Communication" shape=ellipse]
	layer_6_expert_30_comm -> layer_6_expert_30 [style=solid]
	layer_6_expert_31 [label="GPU 184\nExpert 31 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_31 [style=dashed]
	layer_6_expert_31_comm [label="GPU 184\nExpert Communication" shape=ellipse]
	layer_6_expert_31_comm -> layer_6_expert_31 [style=solid]
	layer_6_expert_32 [label="GPU 192\nExpert 32 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_32 [style=dashed]
	layer_6_expert_32_comm [label="GPU 192\nExpert Communication" shape=ellipse]
	layer_6_expert_32_comm -> layer_6_expert_32 [style=solid]
	layer_6_expert_33 [label="GPU 192\nExpert 33 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_33 [style=dashed]
	layer_6_expert_33_comm [label="GPU 192\nExpert Communication" shape=ellipse]
	layer_6_expert_33_comm -> layer_6_expert_33 [style=solid]
	layer_6_expert_34 [label="GPU 192\nExpert 34 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_34 [style=dashed]
	layer_6_expert_34_comm [label="GPU 192\nExpert Communication" shape=ellipse]
	layer_6_expert_34_comm -> layer_6_expert_34 [style=solid]
	layer_6_expert_35 [label="GPU 192\nExpert 35 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_35 [style=dashed]
	layer_6_expert_35_comm [label="GPU 192\nExpert Communication" shape=ellipse]
	layer_6_expert_35_comm -> layer_6_expert_35 [style=solid]
	layer_6_expert_36 [label="GPU 200\nExpert 36 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_36 [style=dashed]
	layer_6_expert_36_comm [label="GPU 200\nExpert Communication" shape=ellipse]
	layer_6_expert_36_comm -> layer_6_expert_36 [style=solid]
	layer_6_expert_37 [label="GPU 200\nExpert 37 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_37 [style=dashed]
	layer_6_expert_37_comm [label="GPU 200\nExpert Communication" shape=ellipse]
	layer_6_expert_37_comm -> layer_6_expert_37 [style=solid]
	layer_6_expert_38 [label="GPU 200\nExpert 38 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_38 [style=dashed]
	layer_6_expert_38_comm [label="GPU 200\nExpert Communication" shape=ellipse]
	layer_6_expert_38_comm -> layer_6_expert_38 [style=solid]
	layer_6_expert_39 [label="GPU 200\nExpert 39 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_39 [style=dashed]
	layer_6_expert_39_comm [label="GPU 200\nExpert Communication" shape=ellipse]
	layer_6_expert_39_comm -> layer_6_expert_39 [style=solid]
	layer_6_expert_40 [label="GPU 208\nExpert 40 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_40 [style=dashed]
	layer_6_expert_40_comm [label="GPU 208\nExpert Communication" shape=ellipse]
	layer_6_expert_40_comm -> layer_6_expert_40 [style=solid]
	layer_6_expert_41 [label="GPU 208\nExpert 41 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_41 [style=dashed]
	layer_6_expert_41_comm [label="GPU 208\nExpert Communication" shape=ellipse]
	layer_6_expert_41_comm -> layer_6_expert_41 [style=solid]
	layer_6_expert_42 [label="GPU 208\nExpert 42 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_42 [style=dashed]
	layer_6_expert_42_comm [label="GPU 208\nExpert Communication" shape=ellipse]
	layer_6_expert_42_comm -> layer_6_expert_42 [style=solid]
	layer_6_expert_43 [label="GPU 208\nExpert 43 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_43 [style=dashed]
	layer_6_expert_43_comm [label="GPU 208\nExpert Communication" shape=ellipse]
	layer_6_expert_43_comm -> layer_6_expert_43 [style=solid]
	layer_6_expert_44 [label="GPU 216\nExpert 44 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_44 [style=dashed]
	layer_6_expert_44_comm [label="GPU 216\nExpert Communication" shape=ellipse]
	layer_6_expert_44_comm -> layer_6_expert_44 [style=solid]
	layer_6_expert_45 [label="GPU 216\nExpert 45 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_45 [style=dashed]
	layer_6_expert_45_comm [label="GPU 216\nExpert Communication" shape=ellipse]
	layer_6_expert_45_comm -> layer_6_expert_45 [style=solid]
	layer_6_expert_46 [label="GPU 216\nExpert 46 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_46 [style=dashed]
	layer_6_expert_46_comm [label="GPU 216\nExpert Communication" shape=ellipse]
	layer_6_expert_46_comm -> layer_6_expert_46 [style=solid]
	layer_6_expert_47 [label="GPU 216\nExpert 47 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_47 [style=dashed]
	layer_6_expert_47_comm [label="GPU 216\nExpert Communication" shape=ellipse]
	layer_6_expert_47_comm -> layer_6_expert_47 [style=solid]
	layer_6_expert_48 [label="GPU 224\nExpert 48 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_48 [style=dashed]
	layer_6_expert_48_comm [label="GPU 224\nExpert Communication" shape=ellipse]
	layer_6_expert_48_comm -> layer_6_expert_48 [style=solid]
	layer_6_expert_49 [label="GPU 224\nExpert 49 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_49 [style=dashed]
	layer_6_expert_49_comm [label="GPU 224\nExpert Communication" shape=ellipse]
	layer_6_expert_49_comm -> layer_6_expert_49 [style=solid]
	layer_6_expert_50 [label="GPU 224\nExpert 50 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_50 [style=dashed]
	layer_6_expert_50_comm [label="GPU 224\nExpert Communication" shape=ellipse]
	layer_6_expert_50_comm -> layer_6_expert_50 [style=solid]
	layer_6_expert_51 [label="GPU 224\nExpert 51 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_51 [style=dashed]
	layer_6_expert_51_comm [label="GPU 224\nExpert Communication" shape=ellipse]
	layer_6_expert_51_comm -> layer_6_expert_51 [style=solid]
	layer_6_expert_52 [label="GPU 232\nExpert 52 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_52 [style=dashed]
	layer_6_expert_52_comm [label="GPU 232\nExpert Communication" shape=ellipse]
	layer_6_expert_52_comm -> layer_6_expert_52 [style=solid]
	layer_6_expert_53 [label="GPU 232\nExpert 53 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_53 [style=dashed]
	layer_6_expert_53_comm [label="GPU 232\nExpert Communication" shape=ellipse]
	layer_6_expert_53_comm -> layer_6_expert_53 [style=solid]
	layer_6_expert_54 [label="GPU 232\nExpert 54 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_54 [style=dashed]
	layer_6_expert_54_comm [label="GPU 232\nExpert Communication" shape=ellipse]
	layer_6_expert_54_comm -> layer_6_expert_54 [style=solid]
	layer_6_expert_55 [label="GPU 232\nExpert 55 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_55 [style=dashed]
	layer_6_expert_55_comm [label="GPU 232\nExpert Communication" shape=ellipse]
	layer_6_expert_55_comm -> layer_6_expert_55 [style=solid]
	layer_6_expert_56 [label="GPU 240\nExpert 56 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_56 [style=dashed]
	layer_6_expert_56_comm [label="GPU 240\nExpert Communication" shape=ellipse]
	layer_6_expert_56_comm -> layer_6_expert_56 [style=solid]
	layer_6_expert_57 [label="GPU 240\nExpert 57 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_57 [style=dashed]
	layer_6_expert_57_comm [label="GPU 240\nExpert Communication" shape=ellipse]
	layer_6_expert_57_comm -> layer_6_expert_57 [style=solid]
	layer_6_expert_58 [label="GPU 240\nExpert 58 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_58 [style=dashed]
	layer_6_expert_58_comm [label="GPU 240\nExpert Communication" shape=ellipse]
	layer_6_expert_58_comm -> layer_6_expert_58 [style=solid]
	layer_6_expert_59 [label="GPU 240\nExpert 59 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_59 [style=dashed]
	layer_6_expert_59_comm [label="GPU 240\nExpert Communication" shape=ellipse]
	layer_6_expert_59_comm -> layer_6_expert_59 [style=solid]
	layer_6_expert_60 [label="GPU 248\nExpert 60 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_60 [style=dashed]
	layer_6_expert_60_comm [label="GPU 248\nExpert Communication" shape=ellipse]
	layer_6_expert_60_comm -> layer_6_expert_60 [style=solid]
	layer_6_expert_61 [label="GPU 248\nExpert 61 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_61 [style=dashed]
	layer_6_expert_61_comm [label="GPU 248\nExpert Communication" shape=ellipse]
	layer_6_expert_61_comm -> layer_6_expert_61 [style=solid]
	layer_6_expert_62 [label="GPU 248\nExpert 62 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_62 [style=dashed]
	layer_6_expert_62_comm [label="GPU 248\nExpert Communication" shape=ellipse]
	layer_6_expert_62_comm -> layer_6_expert_62 [style=solid]
	layer_6_expert_63 [label="GPU 248\nExpert 63 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_6_gate -> layer_6_expert_63 [style=dashed]
	layer_6_expert_63_comm [label="GPU 248\nExpert Communication" shape=ellipse]
	layer_6_expert_63_comm -> layer_6_expert_63 [style=solid]
	layer_6_expert_agg [label="GPU 128\nExpert Aggregation (Weighted Sum)\nInput: [batch_size=16, seq_len=10240, experts=64, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=parallelogram]
	layer_6_expert_0 -> layer_6_expert_agg [style=solid]
	layer_6_expert_1 -> layer_6_expert_agg [style=solid]
	layer_6_expert_2 -> layer_6_expert_agg [style=solid]
	layer_6_expert_3 -> layer_6_expert_agg [style=solid]
	layer_6_expert_4 -> layer_6_expert_agg [style=solid]
	layer_6_expert_5 -> layer_6_expert_agg [style=solid]
	layer_6_expert_6 -> layer_6_expert_agg [style=solid]
	layer_6_expert_7 -> layer_6_expert_agg [style=solid]
	layer_6_expert_8 -> layer_6_expert_agg [style=solid]
	layer_6_expert_9 -> layer_6_expert_agg [style=solid]
	layer_6_expert_10 -> layer_6_expert_agg [style=solid]
	layer_6_expert_11 -> layer_6_expert_agg [style=solid]
	layer_6_expert_12 -> layer_6_expert_agg [style=solid]
	layer_6_expert_13 -> layer_6_expert_agg [style=solid]
	layer_6_expert_14 -> layer_6_expert_agg [style=solid]
	layer_6_expert_15 -> layer_6_expert_agg [style=solid]
	layer_6_expert_16 -> layer_6_expert_agg [style=solid]
	layer_6_expert_17 -> layer_6_expert_agg [style=solid]
	layer_6_expert_18 -> layer_6_expert_agg [style=solid]
	layer_6_expert_19 -> layer_6_expert_agg [style=solid]
	layer_6_expert_20 -> layer_6_expert_agg [style=solid]
	layer_6_expert_21 -> layer_6_expert_agg [style=solid]
	layer_6_expert_22 -> layer_6_expert_agg [style=solid]
	layer_6_expert_23 -> layer_6_expert_agg [style=solid]
	layer_6_expert_24 -> layer_6_expert_agg [style=solid]
	layer_6_expert_25 -> layer_6_expert_agg [style=solid]
	layer_6_expert_26 -> layer_6_expert_agg [style=solid]
	layer_6_expert_27 -> layer_6_expert_agg [style=solid]
	layer_6_expert_28 -> layer_6_expert_agg [style=solid]
	layer_6_expert_29 -> layer_6_expert_agg [style=solid]
	layer_6_expert_30 -> layer_6_expert_agg [style=solid]
	layer_6_expert_31 -> layer_6_expert_agg [style=solid]
	layer_6_expert_32 -> layer_6_expert_agg [style=solid]
	layer_6_expert_33 -> layer_6_expert_agg [style=solid]
	layer_6_expert_34 -> layer_6_expert_agg [style=solid]
	layer_6_expert_35 -> layer_6_expert_agg [style=solid]
	layer_6_expert_36 -> layer_6_expert_agg [style=solid]
	layer_6_expert_37 -> layer_6_expert_agg [style=solid]
	layer_6_expert_38 -> layer_6_expert_agg [style=solid]
	layer_6_expert_39 -> layer_6_expert_agg [style=solid]
	layer_6_expert_40 -> layer_6_expert_agg [style=solid]
	layer_6_expert_41 -> layer_6_expert_agg [style=solid]
	layer_6_expert_42 -> layer_6_expert_agg [style=solid]
	layer_6_expert_43 -> layer_6_expert_agg [style=solid]
	layer_6_expert_44 -> layer_6_expert_agg [style=solid]
	layer_6_expert_45 -> layer_6_expert_agg [style=solid]
	layer_6_expert_46 -> layer_6_expert_agg [style=solid]
	layer_6_expert_47 -> layer_6_expert_agg [style=solid]
	layer_6_expert_48 -> layer_6_expert_agg [style=solid]
	layer_6_expert_49 -> layer_6_expert_agg [style=solid]
	layer_6_expert_50 -> layer_6_expert_agg [style=solid]
	layer_6_expert_51 -> layer_6_expert_agg [style=solid]
	layer_6_expert_52 -> layer_6_expert_agg [style=solid]
	layer_6_expert_53 -> layer_6_expert_agg [style=solid]
	layer_6_expert_54 -> layer_6_expert_agg [style=solid]
	layer_6_expert_55 -> layer_6_expert_agg [style=solid]
	layer_6_expert_56 -> layer_6_expert_agg [style=solid]
	layer_6_expert_57 -> layer_6_expert_agg [style=solid]
	layer_6_expert_58 -> layer_6_expert_agg [style=solid]
	layer_6_expert_59 -> layer_6_expert_agg [style=solid]
	layer_6_expert_60 -> layer_6_expert_agg [style=solid]
	layer_6_expert_61 -> layer_6_expert_agg [style=solid]
	layer_6_expert_62 -> layer_6_expert_agg [style=solid]
	layer_6_expert_63 -> layer_6_expert_agg [style=solid]
	layer_6_expert_agg -> layer_6_moe [style=solid]
	layer_6_norm [label="GPU 128\nLayer Normalization\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_6_moe -> layer_6_norm [style=solid]
	layer_6_dp_comm [label="GPU 128\nData Parallel All-Reduce" shape=ellipse]
	layer_6_norm -> layer_6_dp_comm [style=solid]
	layer_6_dp_comm -> layer_7_attn [style=solid]
	layer_7_attn [label="GPU 128\nLayer 7 Self-Attention\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_7_attn_comm [label="GPU 128\nAttention Communication" shape=ellipse]
	layer_6_attn -> layer_7_attn_comm [style=solid]
	layer_7_attn_comm -> layer_7_attn [style=solid]
	layer_7_moe [label="GPU 128\nLayer 7 MoE Layer\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_7_attn -> layer_7_moe [style=solid]
	layer_7_gate [label="GPU 128\nExpert Gate (Top-2)\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, experts=2]" shape=parallelogram]
	layer_7_attn -> layer_7_gate [style=solid]
	layer_7_expert_0 [label="GPU 128\nExpert 0 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_0 [style=dashed]
	layer_7_expert_1 [label="GPU 128\nExpert 1 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_1 [style=dashed]
	layer_7_expert_2 [label="GPU 128\nExpert 2 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_2 [style=dashed]
	layer_7_expert_3 [label="GPU 128\nExpert 3 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_3 [style=dashed]
	layer_7_expert_4 [label="GPU 136\nExpert 4 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_4 [style=dashed]
	layer_7_expert_4_comm [label="GPU 136\nExpert Communication" shape=ellipse]
	layer_7_expert_4_comm -> layer_7_expert_4 [style=solid]
	layer_7_expert_5 [label="GPU 136\nExpert 5 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_5 [style=dashed]
	layer_7_expert_5_comm [label="GPU 136\nExpert Communication" shape=ellipse]
	layer_7_expert_5_comm -> layer_7_expert_5 [style=solid]
	layer_7_expert_6 [label="GPU 136\nExpert 6 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_6 [style=dashed]
	layer_7_expert_6_comm [label="GPU 136\nExpert Communication" shape=ellipse]
	layer_7_expert_6_comm -> layer_7_expert_6 [style=solid]
	layer_7_expert_7 [label="GPU 136\nExpert 7 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_7 [style=dashed]
	layer_7_expert_7_comm [label="GPU 136\nExpert Communication" shape=ellipse]
	layer_7_expert_7_comm -> layer_7_expert_7 [style=solid]
	layer_7_expert_8 [label="GPU 144\nExpert 8 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_8 [style=dashed]
	layer_7_expert_8_comm [label="GPU 144\nExpert Communication" shape=ellipse]
	layer_7_expert_8_comm -> layer_7_expert_8 [style=solid]
	layer_7_expert_9 [label="GPU 144\nExpert 9 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_9 [style=dashed]
	layer_7_expert_9_comm [label="GPU 144\nExpert Communication" shape=ellipse]
	layer_7_expert_9_comm -> layer_7_expert_9 [style=solid]
	layer_7_expert_10 [label="GPU 144\nExpert 10 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_10 [style=dashed]
	layer_7_expert_10_comm [label="GPU 144\nExpert Communication" shape=ellipse]
	layer_7_expert_10_comm -> layer_7_expert_10 [style=solid]
	layer_7_expert_11 [label="GPU 144\nExpert 11 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_11 [style=dashed]
	layer_7_expert_11_comm [label="GPU 144\nExpert Communication" shape=ellipse]
	layer_7_expert_11_comm -> layer_7_expert_11 [style=solid]
	layer_7_expert_12 [label="GPU 152\nExpert 12 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_12 [style=dashed]
	layer_7_expert_12_comm [label="GPU 152\nExpert Communication" shape=ellipse]
	layer_7_expert_12_comm -> layer_7_expert_12 [style=solid]
	layer_7_expert_13 [label="GPU 152\nExpert 13 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_13 [style=dashed]
	layer_7_expert_13_comm [label="GPU 152\nExpert Communication" shape=ellipse]
	layer_7_expert_13_comm -> layer_7_expert_13 [style=solid]
	layer_7_expert_14 [label="GPU 152\nExpert 14 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_14 [style=dashed]
	layer_7_expert_14_comm [label="GPU 152\nExpert Communication" shape=ellipse]
	layer_7_expert_14_comm -> layer_7_expert_14 [style=solid]
	layer_7_expert_15 [label="GPU 152\nExpert 15 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_15 [style=dashed]
	layer_7_expert_15_comm [label="GPU 152\nExpert Communication" shape=ellipse]
	layer_7_expert_15_comm -> layer_7_expert_15 [style=solid]
	layer_7_expert_16 [label="GPU 160\nExpert 16 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_16 [style=dashed]
	layer_7_expert_16_comm [label="GPU 160\nExpert Communication" shape=ellipse]
	layer_7_expert_16_comm -> layer_7_expert_16 [style=solid]
	layer_7_expert_17 [label="GPU 160\nExpert 17 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_17 [style=dashed]
	layer_7_expert_17_comm [label="GPU 160\nExpert Communication" shape=ellipse]
	layer_7_expert_17_comm -> layer_7_expert_17 [style=solid]
	layer_7_expert_18 [label="GPU 160\nExpert 18 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_18 [style=dashed]
	layer_7_expert_18_comm [label="GPU 160\nExpert Communication" shape=ellipse]
	layer_7_expert_18_comm -> layer_7_expert_18 [style=solid]
	layer_7_expert_19 [label="GPU 160\nExpert 19 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_19 [style=dashed]
	layer_7_expert_19_comm [label="GPU 160\nExpert Communication" shape=ellipse]
	layer_7_expert_19_comm -> layer_7_expert_19 [style=solid]
	layer_7_expert_20 [label="GPU 168\nExpert 20 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_20 [style=dashed]
	layer_7_expert_20_comm [label="GPU 168\nExpert Communication" shape=ellipse]
	layer_7_expert_20_comm -> layer_7_expert_20 [style=solid]
	layer_7_expert_21 [label="GPU 168\nExpert 21 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_21 [style=dashed]
	layer_7_expert_21_comm [label="GPU 168\nExpert Communication" shape=ellipse]
	layer_7_expert_21_comm -> layer_7_expert_21 [style=solid]
	layer_7_expert_22 [label="GPU 168\nExpert 22 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_22 [style=dashed]
	layer_7_expert_22_comm [label="GPU 168\nExpert Communication" shape=ellipse]
	layer_7_expert_22_comm -> layer_7_expert_22 [style=solid]
	layer_7_expert_23 [label="GPU 168\nExpert 23 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_23 [style=dashed]
	layer_7_expert_23_comm [label="GPU 168\nExpert Communication" shape=ellipse]
	layer_7_expert_23_comm -> layer_7_expert_23 [style=solid]
	layer_7_expert_24 [label="GPU 176\nExpert 24 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_24 [style=dashed]
	layer_7_expert_24_comm [label="GPU 176\nExpert Communication" shape=ellipse]
	layer_7_expert_24_comm -> layer_7_expert_24 [style=solid]
	layer_7_expert_25 [label="GPU 176\nExpert 25 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_25 [style=dashed]
	layer_7_expert_25_comm [label="GPU 176\nExpert Communication" shape=ellipse]
	layer_7_expert_25_comm -> layer_7_expert_25 [style=solid]
	layer_7_expert_26 [label="GPU 176\nExpert 26 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_26 [style=dashed]
	layer_7_expert_26_comm [label="GPU 176\nExpert Communication" shape=ellipse]
	layer_7_expert_26_comm -> layer_7_expert_26 [style=solid]
	layer_7_expert_27 [label="GPU 176\nExpert 27 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_27 [style=dashed]
	layer_7_expert_27_comm [label="GPU 176\nExpert Communication" shape=ellipse]
	layer_7_expert_27_comm -> layer_7_expert_27 [style=solid]
	layer_7_expert_28 [label="GPU 184\nExpert 28 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_28 [style=dashed]
	layer_7_expert_28_comm [label="GPU 184\nExpert Communication" shape=ellipse]
	layer_7_expert_28_comm -> layer_7_expert_28 [style=solid]
	layer_7_expert_29 [label="GPU 184\nExpert 29 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_29 [style=dashed]
	layer_7_expert_29_comm [label="GPU 184\nExpert Communication" shape=ellipse]
	layer_7_expert_29_comm -> layer_7_expert_29 [style=solid]
	layer_7_expert_30 [label="GPU 184\nExpert 30 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_30 [style=dashed]
	layer_7_expert_30_comm [label="GPU 184\nExpert Communication" shape=ellipse]
	layer_7_expert_30_comm -> layer_7_expert_30 [style=solid]
	layer_7_expert_31 [label="GPU 184\nExpert 31 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_31 [style=dashed]
	layer_7_expert_31_comm [label="GPU 184\nExpert Communication" shape=ellipse]
	layer_7_expert_31_comm -> layer_7_expert_31 [style=solid]
	layer_7_expert_32 [label="GPU 192\nExpert 32 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_32 [style=dashed]
	layer_7_expert_32_comm [label="GPU 192\nExpert Communication" shape=ellipse]
	layer_7_expert_32_comm -> layer_7_expert_32 [style=solid]
	layer_7_expert_33 [label="GPU 192\nExpert 33 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_33 [style=dashed]
	layer_7_expert_33_comm [label="GPU 192\nExpert Communication" shape=ellipse]
	layer_7_expert_33_comm -> layer_7_expert_33 [style=solid]
	layer_7_expert_34 [label="GPU 192\nExpert 34 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_34 [style=dashed]
	layer_7_expert_34_comm [label="GPU 192\nExpert Communication" shape=ellipse]
	layer_7_expert_34_comm -> layer_7_expert_34 [style=solid]
	layer_7_expert_35 [label="GPU 192\nExpert 35 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_35 [style=dashed]
	layer_7_expert_35_comm [label="GPU 192\nExpert Communication" shape=ellipse]
	layer_7_expert_35_comm -> layer_7_expert_35 [style=solid]
	layer_7_expert_36 [label="GPU 200\nExpert 36 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_36 [style=dashed]
	layer_7_expert_36_comm [label="GPU 200\nExpert Communication" shape=ellipse]
	layer_7_expert_36_comm -> layer_7_expert_36 [style=solid]
	layer_7_expert_37 [label="GPU 200\nExpert 37 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_37 [style=dashed]
	layer_7_expert_37_comm [label="GPU 200\nExpert Communication" shape=ellipse]
	layer_7_expert_37_comm -> layer_7_expert_37 [style=solid]
	layer_7_expert_38 [label="GPU 200\nExpert 38 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_38 [style=dashed]
	layer_7_expert_38_comm [label="GPU 200\nExpert Communication" shape=ellipse]
	layer_7_expert_38_comm -> layer_7_expert_38 [style=solid]
	layer_7_expert_39 [label="GPU 200\nExpert 39 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_39 [style=dashed]
	layer_7_expert_39_comm [label="GPU 200\nExpert Communication" shape=ellipse]
	layer_7_expert_39_comm -> layer_7_expert_39 [style=solid]
	layer_7_expert_40 [label="GPU 208\nExpert 40 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_40 [style=dashed]
	layer_7_expert_40_comm [label="GPU 208\nExpert Communication" shape=ellipse]
	layer_7_expert_40_comm -> layer_7_expert_40 [style=solid]
	layer_7_expert_41 [label="GPU 208\nExpert 41 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_41 [style=dashed]
	layer_7_expert_41_comm [label="GPU 208\nExpert Communication" shape=ellipse]
	layer_7_expert_41_comm -> layer_7_expert_41 [style=solid]
	layer_7_expert_42 [label="GPU 208\nExpert 42 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_42 [style=dashed]
	layer_7_expert_42_comm [label="GPU 208\nExpert Communication" shape=ellipse]
	layer_7_expert_42_comm -> layer_7_expert_42 [style=solid]
	layer_7_expert_43 [label="GPU 208\nExpert 43 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_43 [style=dashed]
	layer_7_expert_43_comm [label="GPU 208\nExpert Communication" shape=ellipse]
	layer_7_expert_43_comm -> layer_7_expert_43 [style=solid]
	layer_7_expert_44 [label="GPU 216\nExpert 44 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_44 [style=dashed]
	layer_7_expert_44_comm [label="GPU 216\nExpert Communication" shape=ellipse]
	layer_7_expert_44_comm -> layer_7_expert_44 [style=solid]
	layer_7_expert_45 [label="GPU 216\nExpert 45 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_45 [style=dashed]
	layer_7_expert_45_comm [label="GPU 216\nExpert Communication" shape=ellipse]
	layer_7_expert_45_comm -> layer_7_expert_45 [style=solid]
	layer_7_expert_46 [label="GPU 216\nExpert 46 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_46 [style=dashed]
	layer_7_expert_46_comm [label="GPU 216\nExpert Communication" shape=ellipse]
	layer_7_expert_46_comm -> layer_7_expert_46 [style=solid]
	layer_7_expert_47 [label="GPU 216\nExpert 47 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_47 [style=dashed]
	layer_7_expert_47_comm [label="GPU 216\nExpert Communication" shape=ellipse]
	layer_7_expert_47_comm -> layer_7_expert_47 [style=solid]
	layer_7_expert_48 [label="GPU 224\nExpert 48 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_48 [style=dashed]
	layer_7_expert_48_comm [label="GPU 224\nExpert Communication" shape=ellipse]
	layer_7_expert_48_comm -> layer_7_expert_48 [style=solid]
	layer_7_expert_49 [label="GPU 224\nExpert 49 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_49 [style=dashed]
	layer_7_expert_49_comm [label="GPU 224\nExpert Communication" shape=ellipse]
	layer_7_expert_49_comm -> layer_7_expert_49 [style=solid]
	layer_7_expert_50 [label="GPU 224\nExpert 50 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_50 [style=dashed]
	layer_7_expert_50_comm [label="GPU 224\nExpert Communication" shape=ellipse]
	layer_7_expert_50_comm -> layer_7_expert_50 [style=solid]
	layer_7_expert_51 [label="GPU 224\nExpert 51 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_51 [style=dashed]
	layer_7_expert_51_comm [label="GPU 224\nExpert Communication" shape=ellipse]
	layer_7_expert_51_comm -> layer_7_expert_51 [style=solid]
	layer_7_expert_52 [label="GPU 232\nExpert 52 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_52 [style=dashed]
	layer_7_expert_52_comm [label="GPU 232\nExpert Communication" shape=ellipse]
	layer_7_expert_52_comm -> layer_7_expert_52 [style=solid]
	layer_7_expert_53 [label="GPU 232\nExpert 53 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_53 [style=dashed]
	layer_7_expert_53_comm [label="GPU 232\nExpert Communication" shape=ellipse]
	layer_7_expert_53_comm -> layer_7_expert_53 [style=solid]
	layer_7_expert_54 [label="GPU 232\nExpert 54 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_54 [style=dashed]
	layer_7_expert_54_comm [label="GPU 232\nExpert Communication" shape=ellipse]
	layer_7_expert_54_comm -> layer_7_expert_54 [style=solid]
	layer_7_expert_55 [label="GPU 232\nExpert 55 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_55 [style=dashed]
	layer_7_expert_55_comm [label="GPU 232\nExpert Communication" shape=ellipse]
	layer_7_expert_55_comm -> layer_7_expert_55 [style=solid]
	layer_7_expert_56 [label="GPU 240\nExpert 56 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_56 [style=dashed]
	layer_7_expert_56_comm [label="GPU 240\nExpert Communication" shape=ellipse]
	layer_7_expert_56_comm -> layer_7_expert_56 [style=solid]
	layer_7_expert_57 [label="GPU 240\nExpert 57 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_57 [style=dashed]
	layer_7_expert_57_comm [label="GPU 240\nExpert Communication" shape=ellipse]
	layer_7_expert_57_comm -> layer_7_expert_57 [style=solid]
	layer_7_expert_58 [label="GPU 240\nExpert 58 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_58 [style=dashed]
	layer_7_expert_58_comm [label="GPU 240\nExpert Communication" shape=ellipse]
	layer_7_expert_58_comm -> layer_7_expert_58 [style=solid]
	layer_7_expert_59 [label="GPU 240\nExpert 59 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_59 [style=dashed]
	layer_7_expert_59_comm [label="GPU 240\nExpert Communication" shape=ellipse]
	layer_7_expert_59_comm -> layer_7_expert_59 [style=solid]
	layer_7_expert_60 [label="GPU 248\nExpert 60 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_60 [style=dashed]
	layer_7_expert_60_comm [label="GPU 248\nExpert Communication" shape=ellipse]
	layer_7_expert_60_comm -> layer_7_expert_60 [style=solid]
	layer_7_expert_61 [label="GPU 248\nExpert 61 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_61 [style=dashed]
	layer_7_expert_61_comm [label="GPU 248\nExpert Communication" shape=ellipse]
	layer_7_expert_61_comm -> layer_7_expert_61 [style=solid]
	layer_7_expert_62 [label="GPU 248\nExpert 62 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_62 [style=dashed]
	layer_7_expert_62_comm [label="GPU 248\nExpert Communication" shape=ellipse]
	layer_7_expert_62_comm -> layer_7_expert_62 [style=solid]
	layer_7_expert_63 [label="GPU 248\nExpert 63 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_7_gate -> layer_7_expert_63 [style=dashed]
	layer_7_expert_63_comm [label="GPU 248\nExpert Communication" shape=ellipse]
	layer_7_expert_63_comm -> layer_7_expert_63 [style=solid]
	layer_7_expert_agg [label="GPU 128\nExpert Aggregation (Weighted Sum)\nInput: [batch_size=16, seq_len=10240, experts=64, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=parallelogram]
	layer_7_expert_0 -> layer_7_expert_agg [style=solid]
	layer_7_expert_1 -> layer_7_expert_agg [style=solid]
	layer_7_expert_2 -> layer_7_expert_agg [style=solid]
	layer_7_expert_3 -> layer_7_expert_agg [style=solid]
	layer_7_expert_4 -> layer_7_expert_agg [style=solid]
	layer_7_expert_5 -> layer_7_expert_agg [style=solid]
	layer_7_expert_6 -> layer_7_expert_agg [style=solid]
	layer_7_expert_7 -> layer_7_expert_agg [style=solid]
	layer_7_expert_8 -> layer_7_expert_agg [style=solid]
	layer_7_expert_9 -> layer_7_expert_agg [style=solid]
	layer_7_expert_10 -> layer_7_expert_agg [style=solid]
	layer_7_expert_11 -> layer_7_expert_agg [style=solid]
	layer_7_expert_12 -> layer_7_expert_agg [style=solid]
	layer_7_expert_13 -> layer_7_expert_agg [style=solid]
	layer_7_expert_14 -> layer_7_expert_agg [style=solid]
	layer_7_expert_15 -> layer_7_expert_agg [style=solid]
	layer_7_expert_16 -> layer_7_expert_agg [style=solid]
	layer_7_expert_17 -> layer_7_expert_agg [style=solid]
	layer_7_expert_18 -> layer_7_expert_agg [style=solid]
	layer_7_expert_19 -> layer_7_expert_agg [style=solid]
	layer_7_expert_20 -> layer_7_expert_agg [style=solid]
	layer_7_expert_21 -> layer_7_expert_agg [style=solid]
	layer_7_expert_22 -> layer_7_expert_agg [style=solid]
	layer_7_expert_23 -> layer_7_expert_agg [style=solid]
	layer_7_expert_24 -> layer_7_expert_agg [style=solid]
	layer_7_expert_25 -> layer_7_expert_agg [style=solid]
	layer_7_expert_26 -> layer_7_expert_agg [style=solid]
	layer_7_expert_27 -> layer_7_expert_agg [style=solid]
	layer_7_expert_28 -> layer_7_expert_agg [style=solid]
	layer_7_expert_29 -> layer_7_expert_agg [style=solid]
	layer_7_expert_30 -> layer_7_expert_agg [style=solid]
	layer_7_expert_31 -> layer_7_expert_agg [style=solid]
	layer_7_expert_32 -> layer_7_expert_agg [style=solid]
	layer_7_expert_33 -> layer_7_expert_agg [style=solid]
	layer_7_expert_34 -> layer_7_expert_agg [style=solid]
	layer_7_expert_35 -> layer_7_expert_agg [style=solid]
	layer_7_expert_36 -> layer_7_expert_agg [style=solid]
	layer_7_expert_37 -> layer_7_expert_agg [style=solid]
	layer_7_expert_38 -> layer_7_expert_agg [style=solid]
	layer_7_expert_39 -> layer_7_expert_agg [style=solid]
	layer_7_expert_40 -> layer_7_expert_agg [style=solid]
	layer_7_expert_41 -> layer_7_expert_agg [style=solid]
	layer_7_expert_42 -> layer_7_expert_agg [style=solid]
	layer_7_expert_43 -> layer_7_expert_agg [style=solid]
	layer_7_expert_44 -> layer_7_expert_agg [style=solid]
	layer_7_expert_45 -> layer_7_expert_agg [style=solid]
	layer_7_expert_46 -> layer_7_expert_agg [style=solid]
	layer_7_expert_47 -> layer_7_expert_agg [style=solid]
	layer_7_expert_48 -> layer_7_expert_agg [style=solid]
	layer_7_expert_49 -> layer_7_expert_agg [style=solid]
	layer_7_expert_50 -> layer_7_expert_agg [style=solid]
	layer_7_expert_51 -> layer_7_expert_agg [style=solid]
	layer_7_expert_52 -> layer_7_expert_agg [style=solid]
	layer_7_expert_53 -> layer_7_expert_agg [style=solid]
	layer_7_expert_54 -> layer_7_expert_agg [style=solid]
	layer_7_expert_55 -> layer_7_expert_agg [style=solid]
	layer_7_expert_56 -> layer_7_expert_agg [style=solid]
	layer_7_expert_57 -> layer_7_expert_agg [style=solid]
	layer_7_expert_58 -> layer_7_expert_agg [style=solid]
	layer_7_expert_59 -> layer_7_expert_agg [style=solid]
	layer_7_expert_60 -> layer_7_expert_agg [style=solid]
	layer_7_expert_61 -> layer_7_expert_agg [style=solid]
	layer_7_expert_62 -> layer_7_expert_agg [style=solid]
	layer_7_expert_63 -> layer_7_expert_agg [style=solid]
	layer_7_expert_agg -> layer_7_moe [style=solid]
	layer_7_norm [label="GPU 128\nLayer Normalization\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_7_moe -> layer_7_norm [style=solid]
	layer_7_dp_comm [label="GPU 128\nData Parallel All-Reduce" shape=ellipse]
	layer_7_norm -> layer_7_dp_comm [style=solid]
	layer_7_stage_comm [label="GPU 256\nStage Communication" shape=ellipse]
	layer_7_dp_comm -> layer_7_stage_comm [style=solid]
	subgraph stage_1 {
		rank=same
		label="Pipeline Stage 1 (Layers 4-7)"
	}
	layer_8_attn [label="GPU 256\nLayer 8 Self-Attention\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_8_attn_comm [label="GPU 256\nAttention Communication" shape=ellipse]
	layer_7_attn -> layer_8_attn_comm [style=solid]
	layer_8_attn_comm -> layer_8_attn [style=solid]
	layer_8_moe [label="GPU 256\nLayer 8 MoE Layer\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_8_attn -> layer_8_moe [style=solid]
	layer_8_gate [label="GPU 256\nExpert Gate (Top-2)\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, experts=2]" shape=parallelogram]
	layer_8_attn -> layer_8_gate [style=solid]
	layer_8_expert_0 [label="GPU 256\nExpert 0 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_0 [style=dashed]
	layer_8_expert_1 [label="GPU 256\nExpert 1 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_1 [style=dashed]
	layer_8_expert_2 [label="GPU 256\nExpert 2 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_2 [style=dashed]
	layer_8_expert_3 [label="GPU 256\nExpert 3 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_3 [style=dashed]
	layer_8_expert_4 [label="GPU 264\nExpert 4 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_4 [style=dashed]
	layer_8_expert_4_comm [label="GPU 264\nExpert Communication" shape=ellipse]
	layer_8_expert_4_comm -> layer_8_expert_4 [style=solid]
	layer_8_expert_5 [label="GPU 264\nExpert 5 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_5 [style=dashed]
	layer_8_expert_5_comm [label="GPU 264\nExpert Communication" shape=ellipse]
	layer_8_expert_5_comm -> layer_8_expert_5 [style=solid]
	layer_8_expert_6 [label="GPU 264\nExpert 6 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_6 [style=dashed]
	layer_8_expert_6_comm [label="GPU 264\nExpert Communication" shape=ellipse]
	layer_8_expert_6_comm -> layer_8_expert_6 [style=solid]
	layer_8_expert_7 [label="GPU 264\nExpert 7 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_7 [style=dashed]
	layer_8_expert_7_comm [label="GPU 264\nExpert Communication" shape=ellipse]
	layer_8_expert_7_comm -> layer_8_expert_7 [style=solid]
	layer_8_expert_8 [label="GPU 272\nExpert 8 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_8 [style=dashed]
	layer_8_expert_8_comm [label="GPU 272\nExpert Communication" shape=ellipse]
	layer_8_expert_8_comm -> layer_8_expert_8 [style=solid]
	layer_8_expert_9 [label="GPU 272\nExpert 9 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_9 [style=dashed]
	layer_8_expert_9_comm [label="GPU 272\nExpert Communication" shape=ellipse]
	layer_8_expert_9_comm -> layer_8_expert_9 [style=solid]
	layer_8_expert_10 [label="GPU 272\nExpert 10 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_10 [style=dashed]
	layer_8_expert_10_comm [label="GPU 272\nExpert Communication" shape=ellipse]
	layer_8_expert_10_comm -> layer_8_expert_10 [style=solid]
	layer_8_expert_11 [label="GPU 272\nExpert 11 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_11 [style=dashed]
	layer_8_expert_11_comm [label="GPU 272\nExpert Communication" shape=ellipse]
	layer_8_expert_11_comm -> layer_8_expert_11 [style=solid]
	layer_8_expert_12 [label="GPU 280\nExpert 12 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_12 [style=dashed]
	layer_8_expert_12_comm [label="GPU 280\nExpert Communication" shape=ellipse]
	layer_8_expert_12_comm -> layer_8_expert_12 [style=solid]
	layer_8_expert_13 [label="GPU 280\nExpert 13 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_13 [style=dashed]
	layer_8_expert_13_comm [label="GPU 280\nExpert Communication" shape=ellipse]
	layer_8_expert_13_comm -> layer_8_expert_13 [style=solid]
	layer_8_expert_14 [label="GPU 280\nExpert 14 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_14 [style=dashed]
	layer_8_expert_14_comm [label="GPU 280\nExpert Communication" shape=ellipse]
	layer_8_expert_14_comm -> layer_8_expert_14 [style=solid]
	layer_8_expert_15 [label="GPU 280\nExpert 15 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_15 [style=dashed]
	layer_8_expert_15_comm [label="GPU 280\nExpert Communication" shape=ellipse]
	layer_8_expert_15_comm -> layer_8_expert_15 [style=solid]
	layer_8_expert_16 [label="GPU 288\nExpert 16 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_16 [style=dashed]
	layer_8_expert_16_comm [label="GPU 288\nExpert Communication" shape=ellipse]
	layer_8_expert_16_comm -> layer_8_expert_16 [style=solid]
	layer_8_expert_17 [label="GPU 288\nExpert 17 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_17 [style=dashed]
	layer_8_expert_17_comm [label="GPU 288\nExpert Communication" shape=ellipse]
	layer_8_expert_17_comm -> layer_8_expert_17 [style=solid]
	layer_8_expert_18 [label="GPU 288\nExpert 18 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_18 [style=dashed]
	layer_8_expert_18_comm [label="GPU 288\nExpert Communication" shape=ellipse]
	layer_8_expert_18_comm -> layer_8_expert_18 [style=solid]
	layer_8_expert_19 [label="GPU 288\nExpert 19 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_19 [style=dashed]
	layer_8_expert_19_comm [label="GPU 288\nExpert Communication" shape=ellipse]
	layer_8_expert_19_comm -> layer_8_expert_19 [style=solid]
	layer_8_expert_20 [label="GPU 296\nExpert 20 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_20 [style=dashed]
	layer_8_expert_20_comm [label="GPU 296\nExpert Communication" shape=ellipse]
	layer_8_expert_20_comm -> layer_8_expert_20 [style=solid]
	layer_8_expert_21 [label="GPU 296\nExpert 21 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_21 [style=dashed]
	layer_8_expert_21_comm [label="GPU 296\nExpert Communication" shape=ellipse]
	layer_8_expert_21_comm -> layer_8_expert_21 [style=solid]
	layer_8_expert_22 [label="GPU 296\nExpert 22 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_22 [style=dashed]
	layer_8_expert_22_comm [label="GPU 296\nExpert Communication" shape=ellipse]
	layer_8_expert_22_comm -> layer_8_expert_22 [style=solid]
	layer_8_expert_23 [label="GPU 296\nExpert 23 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_23 [style=dashed]
	layer_8_expert_23_comm [label="GPU 296\nExpert Communication" shape=ellipse]
	layer_8_expert_23_comm -> layer_8_expert_23 [style=solid]
	layer_8_expert_24 [label="GPU 304\nExpert 24 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_24 [style=dashed]
	layer_8_expert_24_comm [label="GPU 304\nExpert Communication" shape=ellipse]
	layer_8_expert_24_comm -> layer_8_expert_24 [style=solid]
	layer_8_expert_25 [label="GPU 304\nExpert 25 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_25 [style=dashed]
	layer_8_expert_25_comm [label="GPU 304\nExpert Communication" shape=ellipse]
	layer_8_expert_25_comm -> layer_8_expert_25 [style=solid]
	layer_8_expert_26 [label="GPU 304\nExpert 26 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_26 [style=dashed]
	layer_8_expert_26_comm [label="GPU 304\nExpert Communication" shape=ellipse]
	layer_8_expert_26_comm -> layer_8_expert_26 [style=solid]
	layer_8_expert_27 [label="GPU 304\nExpert 27 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_27 [style=dashed]
	layer_8_expert_27_comm [label="GPU 304\nExpert Communication" shape=ellipse]
	layer_8_expert_27_comm -> layer_8_expert_27 [style=solid]
	layer_8_expert_28 [label="GPU 312\nExpert 28 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_28 [style=dashed]
	layer_8_expert_28_comm [label="GPU 312\nExpert Communication" shape=ellipse]
	layer_8_expert_28_comm -> layer_8_expert_28 [style=solid]
	layer_8_expert_29 [label="GPU 312\nExpert 29 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_29 [style=dashed]
	layer_8_expert_29_comm [label="GPU 312\nExpert Communication" shape=ellipse]
	layer_8_expert_29_comm -> layer_8_expert_29 [style=solid]
	layer_8_expert_30 [label="GPU 312\nExpert 30 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_30 [style=dashed]
	layer_8_expert_30_comm [label="GPU 312\nExpert Communication" shape=ellipse]
	layer_8_expert_30_comm -> layer_8_expert_30 [style=solid]
	layer_8_expert_31 [label="GPU 312\nExpert 31 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_31 [style=dashed]
	layer_8_expert_31_comm [label="GPU 312\nExpert Communication" shape=ellipse]
	layer_8_expert_31_comm -> layer_8_expert_31 [style=solid]
	layer_8_expert_32 [label="GPU 320\nExpert 32 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_32 [style=dashed]
	layer_8_expert_32_comm [label="GPU 320\nExpert Communication" shape=ellipse]
	layer_8_expert_32_comm -> layer_8_expert_32 [style=solid]
	layer_8_expert_33 [label="GPU 320\nExpert 33 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_33 [style=dashed]
	layer_8_expert_33_comm [label="GPU 320\nExpert Communication" shape=ellipse]
	layer_8_expert_33_comm -> layer_8_expert_33 [style=solid]
	layer_8_expert_34 [label="GPU 320\nExpert 34 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_34 [style=dashed]
	layer_8_expert_34_comm [label="GPU 320\nExpert Communication" shape=ellipse]
	layer_8_expert_34_comm -> layer_8_expert_34 [style=solid]
	layer_8_expert_35 [label="GPU 320\nExpert 35 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_35 [style=dashed]
	layer_8_expert_35_comm [label="GPU 320\nExpert Communication" shape=ellipse]
	layer_8_expert_35_comm -> layer_8_expert_35 [style=solid]
	layer_8_expert_36 [label="GPU 328\nExpert 36 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_36 [style=dashed]
	layer_8_expert_36_comm [label="GPU 328\nExpert Communication" shape=ellipse]
	layer_8_expert_36_comm -> layer_8_expert_36 [style=solid]
	layer_8_expert_37 [label="GPU 328\nExpert 37 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_37 [style=dashed]
	layer_8_expert_37_comm [label="GPU 328\nExpert Communication" shape=ellipse]
	layer_8_expert_37_comm -> layer_8_expert_37 [style=solid]
	layer_8_expert_38 [label="GPU 328\nExpert 38 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_38 [style=dashed]
	layer_8_expert_38_comm [label="GPU 328\nExpert Communication" shape=ellipse]
	layer_8_expert_38_comm -> layer_8_expert_38 [style=solid]
	layer_8_expert_39 [label="GPU 328\nExpert 39 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_39 [style=dashed]
	layer_8_expert_39_comm [label="GPU 328\nExpert Communication" shape=ellipse]
	layer_8_expert_39_comm -> layer_8_expert_39 [style=solid]
	layer_8_expert_40 [label="GPU 336\nExpert 40 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_40 [style=dashed]
	layer_8_expert_40_comm [label="GPU 336\nExpert Communication" shape=ellipse]
	layer_8_expert_40_comm -> layer_8_expert_40 [style=solid]
	layer_8_expert_41 [label="GPU 336\nExpert 41 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_41 [style=dashed]
	layer_8_expert_41_comm [label="GPU 336\nExpert Communication" shape=ellipse]
	layer_8_expert_41_comm -> layer_8_expert_41 [style=solid]
	layer_8_expert_42 [label="GPU 336\nExpert 42 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_42 [style=dashed]
	layer_8_expert_42_comm [label="GPU 336\nExpert Communication" shape=ellipse]
	layer_8_expert_42_comm -> layer_8_expert_42 [style=solid]
	layer_8_expert_43 [label="GPU 336\nExpert 43 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_43 [style=dashed]
	layer_8_expert_43_comm [label="GPU 336\nExpert Communication" shape=ellipse]
	layer_8_expert_43_comm -> layer_8_expert_43 [style=solid]
	layer_8_expert_44 [label="GPU 344\nExpert 44 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_44 [style=dashed]
	layer_8_expert_44_comm [label="GPU 344\nExpert Communication" shape=ellipse]
	layer_8_expert_44_comm -> layer_8_expert_44 [style=solid]
	layer_8_expert_45 [label="GPU 344\nExpert 45 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_45 [style=dashed]
	layer_8_expert_45_comm [label="GPU 344\nExpert Communication" shape=ellipse]
	layer_8_expert_45_comm -> layer_8_expert_45 [style=solid]
	layer_8_expert_46 [label="GPU 344\nExpert 46 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_46 [style=dashed]
	layer_8_expert_46_comm [label="GPU 344\nExpert Communication" shape=ellipse]
	layer_8_expert_46_comm -> layer_8_expert_46 [style=solid]
	layer_8_expert_47 [label="GPU 344\nExpert 47 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_47 [style=dashed]
	layer_8_expert_47_comm [label="GPU 344\nExpert Communication" shape=ellipse]
	layer_8_expert_47_comm -> layer_8_expert_47 [style=solid]
	layer_8_expert_48 [label="GPU 352\nExpert 48 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_48 [style=dashed]
	layer_8_expert_48_comm [label="GPU 352\nExpert Communication" shape=ellipse]
	layer_8_expert_48_comm -> layer_8_expert_48 [style=solid]
	layer_8_expert_49 [label="GPU 352\nExpert 49 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_49 [style=dashed]
	layer_8_expert_49_comm [label="GPU 352\nExpert Communication" shape=ellipse]
	layer_8_expert_49_comm -> layer_8_expert_49 [style=solid]
	layer_8_expert_50 [label="GPU 352\nExpert 50 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_50 [style=dashed]
	layer_8_expert_50_comm [label="GPU 352\nExpert Communication" shape=ellipse]
	layer_8_expert_50_comm -> layer_8_expert_50 [style=solid]
	layer_8_expert_51 [label="GPU 352\nExpert 51 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_51 [style=dashed]
	layer_8_expert_51_comm [label="GPU 352\nExpert Communication" shape=ellipse]
	layer_8_expert_51_comm -> layer_8_expert_51 [style=solid]
	layer_8_expert_52 [label="GPU 360\nExpert 52 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_52 [style=dashed]
	layer_8_expert_52_comm [label="GPU 360\nExpert Communication" shape=ellipse]
	layer_8_expert_52_comm -> layer_8_expert_52 [style=solid]
	layer_8_expert_53 [label="GPU 360\nExpert 53 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_53 [style=dashed]
	layer_8_expert_53_comm [label="GPU 360\nExpert Communication" shape=ellipse]
	layer_8_expert_53_comm -> layer_8_expert_53 [style=solid]
	layer_8_expert_54 [label="GPU 360\nExpert 54 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_54 [style=dashed]
	layer_8_expert_54_comm [label="GPU 360\nExpert Communication" shape=ellipse]
	layer_8_expert_54_comm -> layer_8_expert_54 [style=solid]
	layer_8_expert_55 [label="GPU 360\nExpert 55 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_55 [style=dashed]
	layer_8_expert_55_comm [label="GPU 360\nExpert Communication" shape=ellipse]
	layer_8_expert_55_comm -> layer_8_expert_55 [style=solid]
	layer_8_expert_56 [label="GPU 368\nExpert 56 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_56 [style=dashed]
	layer_8_expert_56_comm [label="GPU 368\nExpert Communication" shape=ellipse]
	layer_8_expert_56_comm -> layer_8_expert_56 [style=solid]
	layer_8_expert_57 [label="GPU 368\nExpert 57 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_57 [style=dashed]
	layer_8_expert_57_comm [label="GPU 368\nExpert Communication" shape=ellipse]
	layer_8_expert_57_comm -> layer_8_expert_57 [style=solid]
	layer_8_expert_58 [label="GPU 368\nExpert 58 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_58 [style=dashed]
	layer_8_expert_58_comm [label="GPU 368\nExpert Communication" shape=ellipse]
	layer_8_expert_58_comm -> layer_8_expert_58 [style=solid]
	layer_8_expert_59 [label="GPU 368\nExpert 59 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_59 [style=dashed]
	layer_8_expert_59_comm [label="GPU 368\nExpert Communication" shape=ellipse]
	layer_8_expert_59_comm -> layer_8_expert_59 [style=solid]
	layer_8_expert_60 [label="GPU 376\nExpert 60 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_60 [style=dashed]
	layer_8_expert_60_comm [label="GPU 376\nExpert Communication" shape=ellipse]
	layer_8_expert_60_comm -> layer_8_expert_60 [style=solid]
	layer_8_expert_61 [label="GPU 376\nExpert 61 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_61 [style=dashed]
	layer_8_expert_61_comm [label="GPU 376\nExpert Communication" shape=ellipse]
	layer_8_expert_61_comm -> layer_8_expert_61 [style=solid]
	layer_8_expert_62 [label="GPU 376\nExpert 62 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_62 [style=dashed]
	layer_8_expert_62_comm [label="GPU 376\nExpert Communication" shape=ellipse]
	layer_8_expert_62_comm -> layer_8_expert_62 [style=solid]
	layer_8_expert_63 [label="GPU 376\nExpert 63 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_8_gate -> layer_8_expert_63 [style=dashed]
	layer_8_expert_63_comm [label="GPU 376\nExpert Communication" shape=ellipse]
	layer_8_expert_63_comm -> layer_8_expert_63 [style=solid]
	layer_8_expert_agg [label="GPU 256\nExpert Aggregation (Weighted Sum)\nInput: [batch_size=16, seq_len=10240, experts=64, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=parallelogram]
	layer_8_expert_0 -> layer_8_expert_agg [style=solid]
	layer_8_expert_1 -> layer_8_expert_agg [style=solid]
	layer_8_expert_2 -> layer_8_expert_agg [style=solid]
	layer_8_expert_3 -> layer_8_expert_agg [style=solid]
	layer_8_expert_4 -> layer_8_expert_agg [style=solid]
	layer_8_expert_5 -> layer_8_expert_agg [style=solid]
	layer_8_expert_6 -> layer_8_expert_agg [style=solid]
	layer_8_expert_7 -> layer_8_expert_agg [style=solid]
	layer_8_expert_8 -> layer_8_expert_agg [style=solid]
	layer_8_expert_9 -> layer_8_expert_agg [style=solid]
	layer_8_expert_10 -> layer_8_expert_agg [style=solid]
	layer_8_expert_11 -> layer_8_expert_agg [style=solid]
	layer_8_expert_12 -> layer_8_expert_agg [style=solid]
	layer_8_expert_13 -> layer_8_expert_agg [style=solid]
	layer_8_expert_14 -> layer_8_expert_agg [style=solid]
	layer_8_expert_15 -> layer_8_expert_agg [style=solid]
	layer_8_expert_16 -> layer_8_expert_agg [style=solid]
	layer_8_expert_17 -> layer_8_expert_agg [style=solid]
	layer_8_expert_18 -> layer_8_expert_agg [style=solid]
	layer_8_expert_19 -> layer_8_expert_agg [style=solid]
	layer_8_expert_20 -> layer_8_expert_agg [style=solid]
	layer_8_expert_21 -> layer_8_expert_agg [style=solid]
	layer_8_expert_22 -> layer_8_expert_agg [style=solid]
	layer_8_expert_23 -> layer_8_expert_agg [style=solid]
	layer_8_expert_24 -> layer_8_expert_agg [style=solid]
	layer_8_expert_25 -> layer_8_expert_agg [style=solid]
	layer_8_expert_26 -> layer_8_expert_agg [style=solid]
	layer_8_expert_27 -> layer_8_expert_agg [style=solid]
	layer_8_expert_28 -> layer_8_expert_agg [style=solid]
	layer_8_expert_29 -> layer_8_expert_agg [style=solid]
	layer_8_expert_30 -> layer_8_expert_agg [style=solid]
	layer_8_expert_31 -> layer_8_expert_agg [style=solid]
	layer_8_expert_32 -> layer_8_expert_agg [style=solid]
	layer_8_expert_33 -> layer_8_expert_agg [style=solid]
	layer_8_expert_34 -> layer_8_expert_agg [style=solid]
	layer_8_expert_35 -> layer_8_expert_agg [style=solid]
	layer_8_expert_36 -> layer_8_expert_agg [style=solid]
	layer_8_expert_37 -> layer_8_expert_agg [style=solid]
	layer_8_expert_38 -> layer_8_expert_agg [style=solid]
	layer_8_expert_39 -> layer_8_expert_agg [style=solid]
	layer_8_expert_40 -> layer_8_expert_agg [style=solid]
	layer_8_expert_41 -> layer_8_expert_agg [style=solid]
	layer_8_expert_42 -> layer_8_expert_agg [style=solid]
	layer_8_expert_43 -> layer_8_expert_agg [style=solid]
	layer_8_expert_44 -> layer_8_expert_agg [style=solid]
	layer_8_expert_45 -> layer_8_expert_agg [style=solid]
	layer_8_expert_46 -> layer_8_expert_agg [style=solid]
	layer_8_expert_47 -> layer_8_expert_agg [style=solid]
	layer_8_expert_48 -> layer_8_expert_agg [style=solid]
	layer_8_expert_49 -> layer_8_expert_agg [style=solid]
	layer_8_expert_50 -> layer_8_expert_agg [style=solid]
	layer_8_expert_51 -> layer_8_expert_agg [style=solid]
	layer_8_expert_52 -> layer_8_expert_agg [style=solid]
	layer_8_expert_53 -> layer_8_expert_agg [style=solid]
	layer_8_expert_54 -> layer_8_expert_agg [style=solid]
	layer_8_expert_55 -> layer_8_expert_agg [style=solid]
	layer_8_expert_56 -> layer_8_expert_agg [style=solid]
	layer_8_expert_57 -> layer_8_expert_agg [style=solid]
	layer_8_expert_58 -> layer_8_expert_agg [style=solid]
	layer_8_expert_59 -> layer_8_expert_agg [style=solid]
	layer_8_expert_60 -> layer_8_expert_agg [style=solid]
	layer_8_expert_61 -> layer_8_expert_agg [style=solid]
	layer_8_expert_62 -> layer_8_expert_agg [style=solid]
	layer_8_expert_63 -> layer_8_expert_agg [style=solid]
	layer_8_expert_agg -> layer_8_moe [style=solid]
	layer_8_norm [label="GPU 256\nLayer Normalization\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_8_moe -> layer_8_norm [style=solid]
	layer_8_dp_comm [label="GPU 256\nData Parallel All-Reduce" shape=ellipse]
	layer_8_norm -> layer_8_dp_comm [style=solid]
	layer_8_dp_comm -> layer_9_attn [style=solid]
	layer_9_attn [label="GPU 256\nLayer 9 Self-Attention\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_9_attn_comm [label="GPU 256\nAttention Communication" shape=ellipse]
	layer_8_attn -> layer_9_attn_comm [style=solid]
	layer_9_attn_comm -> layer_9_attn [style=solid]
	layer_9_moe [label="GPU 256\nLayer 9 MoE Layer\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_9_attn -> layer_9_moe [style=solid]
	layer_9_gate [label="GPU 256\nExpert Gate (Top-2)\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, experts=2]" shape=parallelogram]
	layer_9_attn -> layer_9_gate [style=solid]
	layer_9_expert_0 [label="GPU 256\nExpert 0 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_0 [style=dashed]
	layer_9_expert_1 [label="GPU 256\nExpert 1 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_1 [style=dashed]
	layer_9_expert_2 [label="GPU 256\nExpert 2 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_2 [style=dashed]
	layer_9_expert_3 [label="GPU 256\nExpert 3 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_3 [style=dashed]
	layer_9_expert_4 [label="GPU 264\nExpert 4 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_4 [style=dashed]
	layer_9_expert_4_comm [label="GPU 264\nExpert Communication" shape=ellipse]
	layer_9_expert_4_comm -> layer_9_expert_4 [style=solid]
	layer_9_expert_5 [label="GPU 264\nExpert 5 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_5 [style=dashed]
	layer_9_expert_5_comm [label="GPU 264\nExpert Communication" shape=ellipse]
	layer_9_expert_5_comm -> layer_9_expert_5 [style=solid]
	layer_9_expert_6 [label="GPU 264\nExpert 6 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_6 [style=dashed]
	layer_9_expert_6_comm [label="GPU 264\nExpert Communication" shape=ellipse]
	layer_9_expert_6_comm -> layer_9_expert_6 [style=solid]
	layer_9_expert_7 [label="GPU 264\nExpert 7 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_7 [style=dashed]
	layer_9_expert_7_comm [label="GPU 264\nExpert Communication" shape=ellipse]
	layer_9_expert_7_comm -> layer_9_expert_7 [style=solid]
	layer_9_expert_8 [label="GPU 272\nExpert 8 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_8 [style=dashed]
	layer_9_expert_8_comm [label="GPU 272\nExpert Communication" shape=ellipse]
	layer_9_expert_8_comm -> layer_9_expert_8 [style=solid]
	layer_9_expert_9 [label="GPU 272\nExpert 9 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_9 [style=dashed]
	layer_9_expert_9_comm [label="GPU 272\nExpert Communication" shape=ellipse]
	layer_9_expert_9_comm -> layer_9_expert_9 [style=solid]
	layer_9_expert_10 [label="GPU 272\nExpert 10 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_10 [style=dashed]
	layer_9_expert_10_comm [label="GPU 272\nExpert Communication" shape=ellipse]
	layer_9_expert_10_comm -> layer_9_expert_10 [style=solid]
	layer_9_expert_11 [label="GPU 272\nExpert 11 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_11 [style=dashed]
	layer_9_expert_11_comm [label="GPU 272\nExpert Communication" shape=ellipse]
	layer_9_expert_11_comm -> layer_9_expert_11 [style=solid]
	layer_9_expert_12 [label="GPU 280\nExpert 12 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_12 [style=dashed]
	layer_9_expert_12_comm [label="GPU 280\nExpert Communication" shape=ellipse]
	layer_9_expert_12_comm -> layer_9_expert_12 [style=solid]
	layer_9_expert_13 [label="GPU 280\nExpert 13 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_13 [style=dashed]
	layer_9_expert_13_comm [label="GPU 280\nExpert Communication" shape=ellipse]
	layer_9_expert_13_comm -> layer_9_expert_13 [style=solid]
	layer_9_expert_14 [label="GPU 280\nExpert 14 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_14 [style=dashed]
	layer_9_expert_14_comm [label="GPU 280\nExpert Communication" shape=ellipse]
	layer_9_expert_14_comm -> layer_9_expert_14 [style=solid]
	layer_9_expert_15 [label="GPU 280\nExpert 15 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_15 [style=dashed]
	layer_9_expert_15_comm [label="GPU 280\nExpert Communication" shape=ellipse]
	layer_9_expert_15_comm -> layer_9_expert_15 [style=solid]
	layer_9_expert_16 [label="GPU 288\nExpert 16 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_16 [style=dashed]
	layer_9_expert_16_comm [label="GPU 288\nExpert Communication" shape=ellipse]
	layer_9_expert_16_comm -> layer_9_expert_16 [style=solid]
	layer_9_expert_17 [label="GPU 288\nExpert 17 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_17 [style=dashed]
	layer_9_expert_17_comm [label="GPU 288\nExpert Communication" shape=ellipse]
	layer_9_expert_17_comm -> layer_9_expert_17 [style=solid]
	layer_9_expert_18 [label="GPU 288\nExpert 18 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_18 [style=dashed]
	layer_9_expert_18_comm [label="GPU 288\nExpert Communication" shape=ellipse]
	layer_9_expert_18_comm -> layer_9_expert_18 [style=solid]
	layer_9_expert_19 [label="GPU 288\nExpert 19 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_19 [style=dashed]
	layer_9_expert_19_comm [label="GPU 288\nExpert Communication" shape=ellipse]
	layer_9_expert_19_comm -> layer_9_expert_19 [style=solid]
	layer_9_expert_20 [label="GPU 296\nExpert 20 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_20 [style=dashed]
	layer_9_expert_20_comm [label="GPU 296\nExpert Communication" shape=ellipse]
	layer_9_expert_20_comm -> layer_9_expert_20 [style=solid]
	layer_9_expert_21 [label="GPU 296\nExpert 21 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_21 [style=dashed]
	layer_9_expert_21_comm [label="GPU 296\nExpert Communication" shape=ellipse]
	layer_9_expert_21_comm -> layer_9_expert_21 [style=solid]
	layer_9_expert_22 [label="GPU 296\nExpert 22 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_22 [style=dashed]
	layer_9_expert_22_comm [label="GPU 296\nExpert Communication" shape=ellipse]
	layer_9_expert_22_comm -> layer_9_expert_22 [style=solid]
	layer_9_expert_23 [label="GPU 296\nExpert 23 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_23 [style=dashed]
	layer_9_expert_23_comm [label="GPU 296\nExpert Communication" shape=ellipse]
	layer_9_expert_23_comm -> layer_9_expert_23 [style=solid]
	layer_9_expert_24 [label="GPU 304\nExpert 24 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_24 [style=dashed]
	layer_9_expert_24_comm [label="GPU 304\nExpert Communication" shape=ellipse]
	layer_9_expert_24_comm -> layer_9_expert_24 [style=solid]
	layer_9_expert_25 [label="GPU 304\nExpert 25 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_25 [style=dashed]
	layer_9_expert_25_comm [label="GPU 304\nExpert Communication" shape=ellipse]
	layer_9_expert_25_comm -> layer_9_expert_25 [style=solid]
	layer_9_expert_26 [label="GPU 304\nExpert 26 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_26 [style=dashed]
	layer_9_expert_26_comm [label="GPU 304\nExpert Communication" shape=ellipse]
	layer_9_expert_26_comm -> layer_9_expert_26 [style=solid]
	layer_9_expert_27 [label="GPU 304\nExpert 27 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_27 [style=dashed]
	layer_9_expert_27_comm [label="GPU 304\nExpert Communication" shape=ellipse]
	layer_9_expert_27_comm -> layer_9_expert_27 [style=solid]
	layer_9_expert_28 [label="GPU 312\nExpert 28 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_28 [style=dashed]
	layer_9_expert_28_comm [label="GPU 312\nExpert Communication" shape=ellipse]
	layer_9_expert_28_comm -> layer_9_expert_28 [style=solid]
	layer_9_expert_29 [label="GPU 312\nExpert 29 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_29 [style=dashed]
	layer_9_expert_29_comm [label="GPU 312\nExpert Communication" shape=ellipse]
	layer_9_expert_29_comm -> layer_9_expert_29 [style=solid]
	layer_9_expert_30 [label="GPU 312\nExpert 30 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_30 [style=dashed]
	layer_9_expert_30_comm [label="GPU 312\nExpert Communication" shape=ellipse]
	layer_9_expert_30_comm -> layer_9_expert_30 [style=solid]
	layer_9_expert_31 [label="GPU 312\nExpert 31 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_31 [style=dashed]
	layer_9_expert_31_comm [label="GPU 312\nExpert Communication" shape=ellipse]
	layer_9_expert_31_comm -> layer_9_expert_31 [style=solid]
	layer_9_expert_32 [label="GPU 320\nExpert 32 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_32 [style=dashed]
	layer_9_expert_32_comm [label="GPU 320\nExpert Communication" shape=ellipse]
	layer_9_expert_32_comm -> layer_9_expert_32 [style=solid]
	layer_9_expert_33 [label="GPU 320\nExpert 33 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_33 [style=dashed]
	layer_9_expert_33_comm [label="GPU 320\nExpert Communication" shape=ellipse]
	layer_9_expert_33_comm -> layer_9_expert_33 [style=solid]
	layer_9_expert_34 [label="GPU 320\nExpert 34 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_34 [style=dashed]
	layer_9_expert_34_comm [label="GPU 320\nExpert Communication" shape=ellipse]
	layer_9_expert_34_comm -> layer_9_expert_34 [style=solid]
	layer_9_expert_35 [label="GPU 320\nExpert 35 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_35 [style=dashed]
	layer_9_expert_35_comm [label="GPU 320\nExpert Communication" shape=ellipse]
	layer_9_expert_35_comm -> layer_9_expert_35 [style=solid]
	layer_9_expert_36 [label="GPU 328\nExpert 36 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_36 [style=dashed]
	layer_9_expert_36_comm [label="GPU 328\nExpert Communication" shape=ellipse]
	layer_9_expert_36_comm -> layer_9_expert_36 [style=solid]
	layer_9_expert_37 [label="GPU 328\nExpert 37 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_37 [style=dashed]
	layer_9_expert_37_comm [label="GPU 328\nExpert Communication" shape=ellipse]
	layer_9_expert_37_comm -> layer_9_expert_37 [style=solid]
	layer_9_expert_38 [label="GPU 328\nExpert 38 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_38 [style=dashed]
	layer_9_expert_38_comm [label="GPU 328\nExpert Communication" shape=ellipse]
	layer_9_expert_38_comm -> layer_9_expert_38 [style=solid]
	layer_9_expert_39 [label="GPU 328\nExpert 39 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_39 [style=dashed]
	layer_9_expert_39_comm [label="GPU 328\nExpert Communication" shape=ellipse]
	layer_9_expert_39_comm -> layer_9_expert_39 [style=solid]
	layer_9_expert_40 [label="GPU 336\nExpert 40 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_40 [style=dashed]
	layer_9_expert_40_comm [label="GPU 336\nExpert Communication" shape=ellipse]
	layer_9_expert_40_comm -> layer_9_expert_40 [style=solid]
	layer_9_expert_41 [label="GPU 336\nExpert 41 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_41 [style=dashed]
	layer_9_expert_41_comm [label="GPU 336\nExpert Communication" shape=ellipse]
	layer_9_expert_41_comm -> layer_9_expert_41 [style=solid]
	layer_9_expert_42 [label="GPU 336\nExpert 42 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_42 [style=dashed]
	layer_9_expert_42_comm [label="GPU 336\nExpert Communication" shape=ellipse]
	layer_9_expert_42_comm -> layer_9_expert_42 [style=solid]
	layer_9_expert_43 [label="GPU 336\nExpert 43 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_43 [style=dashed]
	layer_9_expert_43_comm [label="GPU 336\nExpert Communication" shape=ellipse]
	layer_9_expert_43_comm -> layer_9_expert_43 [style=solid]
	layer_9_expert_44 [label="GPU 344\nExpert 44 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_44 [style=dashed]
	layer_9_expert_44_comm [label="GPU 344\nExpert Communication" shape=ellipse]
	layer_9_expert_44_comm -> layer_9_expert_44 [style=solid]
	layer_9_expert_45 [label="GPU 344\nExpert 45 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_45 [style=dashed]
	layer_9_expert_45_comm [label="GPU 344\nExpert Communication" shape=ellipse]
	layer_9_expert_45_comm -> layer_9_expert_45 [style=solid]
	layer_9_expert_46 [label="GPU 344\nExpert 46 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_46 [style=dashed]
	layer_9_expert_46_comm [label="GPU 344\nExpert Communication" shape=ellipse]
	layer_9_expert_46_comm -> layer_9_expert_46 [style=solid]
	layer_9_expert_47 [label="GPU 344\nExpert 47 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_47 [style=dashed]
	layer_9_expert_47_comm [label="GPU 344\nExpert Communication" shape=ellipse]
	layer_9_expert_47_comm -> layer_9_expert_47 [style=solid]
	layer_9_expert_48 [label="GPU 352\nExpert 48 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_48 [style=dashed]
	layer_9_expert_48_comm [label="GPU 352\nExpert Communication" shape=ellipse]
	layer_9_expert_48_comm -> layer_9_expert_48 [style=solid]
	layer_9_expert_49 [label="GPU 352\nExpert 49 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_49 [style=dashed]
	layer_9_expert_49_comm [label="GPU 352\nExpert Communication" shape=ellipse]
	layer_9_expert_49_comm -> layer_9_expert_49 [style=solid]
	layer_9_expert_50 [label="GPU 352\nExpert 50 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_50 [style=dashed]
	layer_9_expert_50_comm [label="GPU 352\nExpert Communication" shape=ellipse]
	layer_9_expert_50_comm -> layer_9_expert_50 [style=solid]
	layer_9_expert_51 [label="GPU 352\nExpert 51 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_51 [style=dashed]
	layer_9_expert_51_comm [label="GPU 352\nExpert Communication" shape=ellipse]
	layer_9_expert_51_comm -> layer_9_expert_51 [style=solid]
	layer_9_expert_52 [label="GPU 360\nExpert 52 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_52 [style=dashed]
	layer_9_expert_52_comm [label="GPU 360\nExpert Communication" shape=ellipse]
	layer_9_expert_52_comm -> layer_9_expert_52 [style=solid]
	layer_9_expert_53 [label="GPU 360\nExpert 53 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_53 [style=dashed]
	layer_9_expert_53_comm [label="GPU 360\nExpert Communication" shape=ellipse]
	layer_9_expert_53_comm -> layer_9_expert_53 [style=solid]
	layer_9_expert_54 [label="GPU 360\nExpert 54 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_54 [style=dashed]
	layer_9_expert_54_comm [label="GPU 360\nExpert Communication" shape=ellipse]
	layer_9_expert_54_comm -> layer_9_expert_54 [style=solid]
	layer_9_expert_55 [label="GPU 360\nExpert 55 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_55 [style=dashed]
	layer_9_expert_55_comm [label="GPU 360\nExpert Communication" shape=ellipse]
	layer_9_expert_55_comm -> layer_9_expert_55 [style=solid]
	layer_9_expert_56 [label="GPU 368\nExpert 56 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_56 [style=dashed]
	layer_9_expert_56_comm [label="GPU 368\nExpert Communication" shape=ellipse]
	layer_9_expert_56_comm -> layer_9_expert_56 [style=solid]
	layer_9_expert_57 [label="GPU 368\nExpert 57 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_57 [style=dashed]
	layer_9_expert_57_comm [label="GPU 368\nExpert Communication" shape=ellipse]
	layer_9_expert_57_comm -> layer_9_expert_57 [style=solid]
	layer_9_expert_58 [label="GPU 368\nExpert 58 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_58 [style=dashed]
	layer_9_expert_58_comm [label="GPU 368\nExpert Communication" shape=ellipse]
	layer_9_expert_58_comm -> layer_9_expert_58 [style=solid]
	layer_9_expert_59 [label="GPU 368\nExpert 59 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_59 [style=dashed]
	layer_9_expert_59_comm [label="GPU 368\nExpert Communication" shape=ellipse]
	layer_9_expert_59_comm -> layer_9_expert_59 [style=solid]
	layer_9_expert_60 [label="GPU 376\nExpert 60 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_60 [style=dashed]
	layer_9_expert_60_comm [label="GPU 376\nExpert Communication" shape=ellipse]
	layer_9_expert_60_comm -> layer_9_expert_60 [style=solid]
	layer_9_expert_61 [label="GPU 376\nExpert 61 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_61 [style=dashed]
	layer_9_expert_61_comm [label="GPU 376\nExpert Communication" shape=ellipse]
	layer_9_expert_61_comm -> layer_9_expert_61 [style=solid]
	layer_9_expert_62 [label="GPU 376\nExpert 62 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_62 [style=dashed]
	layer_9_expert_62_comm [label="GPU 376\nExpert Communication" shape=ellipse]
	layer_9_expert_62_comm -> layer_9_expert_62 [style=solid]
	layer_9_expert_63 [label="GPU 376\nExpert 63 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_9_gate -> layer_9_expert_63 [style=dashed]
	layer_9_expert_63_comm [label="GPU 376\nExpert Communication" shape=ellipse]
	layer_9_expert_63_comm -> layer_9_expert_63 [style=solid]
	layer_9_expert_agg [label="GPU 256\nExpert Aggregation (Weighted Sum)\nInput: [batch_size=16, seq_len=10240, experts=64, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=parallelogram]
	layer_9_expert_0 -> layer_9_expert_agg [style=solid]
	layer_9_expert_1 -> layer_9_expert_agg [style=solid]
	layer_9_expert_2 -> layer_9_expert_agg [style=solid]
	layer_9_expert_3 -> layer_9_expert_agg [style=solid]
	layer_9_expert_4 -> layer_9_expert_agg [style=solid]
	layer_9_expert_5 -> layer_9_expert_agg [style=solid]
	layer_9_expert_6 -> layer_9_expert_agg [style=solid]
	layer_9_expert_7 -> layer_9_expert_agg [style=solid]
	layer_9_expert_8 -> layer_9_expert_agg [style=solid]
	layer_9_expert_9 -> layer_9_expert_agg [style=solid]
	layer_9_expert_10 -> layer_9_expert_agg [style=solid]
	layer_9_expert_11 -> layer_9_expert_agg [style=solid]
	layer_9_expert_12 -> layer_9_expert_agg [style=solid]
	layer_9_expert_13 -> layer_9_expert_agg [style=solid]
	layer_9_expert_14 -> layer_9_expert_agg [style=solid]
	layer_9_expert_15 -> layer_9_expert_agg [style=solid]
	layer_9_expert_16 -> layer_9_expert_agg [style=solid]
	layer_9_expert_17 -> layer_9_expert_agg [style=solid]
	layer_9_expert_18 -> layer_9_expert_agg [style=solid]
	layer_9_expert_19 -> layer_9_expert_agg [style=solid]
	layer_9_expert_20 -> layer_9_expert_agg [style=solid]
	layer_9_expert_21 -> layer_9_expert_agg [style=solid]
	layer_9_expert_22 -> layer_9_expert_agg [style=solid]
	layer_9_expert_23 -> layer_9_expert_agg [style=solid]
	layer_9_expert_24 -> layer_9_expert_agg [style=solid]
	layer_9_expert_25 -> layer_9_expert_agg [style=solid]
	layer_9_expert_26 -> layer_9_expert_agg [style=solid]
	layer_9_expert_27 -> layer_9_expert_agg [style=solid]
	layer_9_expert_28 -> layer_9_expert_agg [style=solid]
	layer_9_expert_29 -> layer_9_expert_agg [style=solid]
	layer_9_expert_30 -> layer_9_expert_agg [style=solid]
	layer_9_expert_31 -> layer_9_expert_agg [style=solid]
	layer_9_expert_32 -> layer_9_expert_agg [style=solid]
	layer_9_expert_33 -> layer_9_expert_agg [style=solid]
	layer_9_expert_34 -> layer_9_expert_agg [style=solid]
	layer_9_expert_35 -> layer_9_expert_agg [style=solid]
	layer_9_expert_36 -> layer_9_expert_agg [style=solid]
	layer_9_expert_37 -> layer_9_expert_agg [style=solid]
	layer_9_expert_38 -> layer_9_expert_agg [style=solid]
	layer_9_expert_39 -> layer_9_expert_agg [style=solid]
	layer_9_expert_40 -> layer_9_expert_agg [style=solid]
	layer_9_expert_41 -> layer_9_expert_agg [style=solid]
	layer_9_expert_42 -> layer_9_expert_agg [style=solid]
	layer_9_expert_43 -> layer_9_expert_agg [style=solid]
	layer_9_expert_44 -> layer_9_expert_agg [style=solid]
	layer_9_expert_45 -> layer_9_expert_agg [style=solid]
	layer_9_expert_46 -> layer_9_expert_agg [style=solid]
	layer_9_expert_47 -> layer_9_expert_agg [style=solid]
	layer_9_expert_48 -> layer_9_expert_agg [style=solid]
	layer_9_expert_49 -> layer_9_expert_agg [style=solid]
	layer_9_expert_50 -> layer_9_expert_agg [style=solid]
	layer_9_expert_51 -> layer_9_expert_agg [style=solid]
	layer_9_expert_52 -> layer_9_expert_agg [style=solid]
	layer_9_expert_53 -> layer_9_expert_agg [style=solid]
	layer_9_expert_54 -> layer_9_expert_agg [style=solid]
	layer_9_expert_55 -> layer_9_expert_agg [style=solid]
	layer_9_expert_56 -> layer_9_expert_agg [style=solid]
	layer_9_expert_57 -> layer_9_expert_agg [style=solid]
	layer_9_expert_58 -> layer_9_expert_agg [style=solid]
	layer_9_expert_59 -> layer_9_expert_agg [style=solid]
	layer_9_expert_60 -> layer_9_expert_agg [style=solid]
	layer_9_expert_61 -> layer_9_expert_agg [style=solid]
	layer_9_expert_62 -> layer_9_expert_agg [style=solid]
	layer_9_expert_63 -> layer_9_expert_agg [style=solid]
	layer_9_expert_agg -> layer_9_moe [style=solid]
	layer_9_norm [label="GPU 256\nLayer Normalization\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_9_moe -> layer_9_norm [style=solid]
	layer_9_dp_comm [label="GPU 256\nData Parallel All-Reduce" shape=ellipse]
	layer_9_norm -> layer_9_dp_comm [style=solid]
	layer_9_dp_comm -> layer_10_attn [style=solid]
	layer_10_attn [label="GPU 256\nLayer 10 Self-Attention\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_10_attn_comm [label="GPU 256\nAttention Communication" shape=ellipse]
	layer_9_attn -> layer_10_attn_comm [style=solid]
	layer_10_attn_comm -> layer_10_attn [style=solid]
	layer_10_moe [label="GPU 256\nLayer 10 MoE Layer\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_10_attn -> layer_10_moe [style=solid]
	layer_10_gate [label="GPU 256\nExpert Gate (Top-2)\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, experts=2]" shape=parallelogram]
	layer_10_attn -> layer_10_gate [style=solid]
	layer_10_expert_0 [label="GPU 256\nExpert 0 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_0 [style=dashed]
	layer_10_expert_1 [label="GPU 256\nExpert 1 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_1 [style=dashed]
	layer_10_expert_2 [label="GPU 256\nExpert 2 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_2 [style=dashed]
	layer_10_expert_3 [label="GPU 256\nExpert 3 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_3 [style=dashed]
	layer_10_expert_4 [label="GPU 264\nExpert 4 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_4 [style=dashed]
	layer_10_expert_4_comm [label="GPU 264\nExpert Communication" shape=ellipse]
	layer_10_expert_4_comm -> layer_10_expert_4 [style=solid]
	layer_10_expert_5 [label="GPU 264\nExpert 5 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_5 [style=dashed]
	layer_10_expert_5_comm [label="GPU 264\nExpert Communication" shape=ellipse]
	layer_10_expert_5_comm -> layer_10_expert_5 [style=solid]
	layer_10_expert_6 [label="GPU 264\nExpert 6 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_6 [style=dashed]
	layer_10_expert_6_comm [label="GPU 264\nExpert Communication" shape=ellipse]
	layer_10_expert_6_comm -> layer_10_expert_6 [style=solid]
	layer_10_expert_7 [label="GPU 264\nExpert 7 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_7 [style=dashed]
	layer_10_expert_7_comm [label="GPU 264\nExpert Communication" shape=ellipse]
	layer_10_expert_7_comm -> layer_10_expert_7 [style=solid]
	layer_10_expert_8 [label="GPU 272\nExpert 8 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_8 [style=dashed]
	layer_10_expert_8_comm [label="GPU 272\nExpert Communication" shape=ellipse]
	layer_10_expert_8_comm -> layer_10_expert_8 [style=solid]
	layer_10_expert_9 [label="GPU 272\nExpert 9 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_9 [style=dashed]
	layer_10_expert_9_comm [label="GPU 272\nExpert Communication" shape=ellipse]
	layer_10_expert_9_comm -> layer_10_expert_9 [style=solid]
	layer_10_expert_10 [label="GPU 272\nExpert 10 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_10 [style=dashed]
	layer_10_expert_10_comm [label="GPU 272\nExpert Communication" shape=ellipse]
	layer_10_expert_10_comm -> layer_10_expert_10 [style=solid]
	layer_10_expert_11 [label="GPU 272\nExpert 11 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_11 [style=dashed]
	layer_10_expert_11_comm [label="GPU 272\nExpert Communication" shape=ellipse]
	layer_10_expert_11_comm -> layer_10_expert_11 [style=solid]
	layer_10_expert_12 [label="GPU 280\nExpert 12 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_12 [style=dashed]
	layer_10_expert_12_comm [label="GPU 280\nExpert Communication" shape=ellipse]
	layer_10_expert_12_comm -> layer_10_expert_12 [style=solid]
	layer_10_expert_13 [label="GPU 280\nExpert 13 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_13 [style=dashed]
	layer_10_expert_13_comm [label="GPU 280\nExpert Communication" shape=ellipse]
	layer_10_expert_13_comm -> layer_10_expert_13 [style=solid]
	layer_10_expert_14 [label="GPU 280\nExpert 14 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_14 [style=dashed]
	layer_10_expert_14_comm [label="GPU 280\nExpert Communication" shape=ellipse]
	layer_10_expert_14_comm -> layer_10_expert_14 [style=solid]
	layer_10_expert_15 [label="GPU 280\nExpert 15 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_15 [style=dashed]
	layer_10_expert_15_comm [label="GPU 280\nExpert Communication" shape=ellipse]
	layer_10_expert_15_comm -> layer_10_expert_15 [style=solid]
	layer_10_expert_16 [label="GPU 288\nExpert 16 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_16 [style=dashed]
	layer_10_expert_16_comm [label="GPU 288\nExpert Communication" shape=ellipse]
	layer_10_expert_16_comm -> layer_10_expert_16 [style=solid]
	layer_10_expert_17 [label="GPU 288\nExpert 17 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_17 [style=dashed]
	layer_10_expert_17_comm [label="GPU 288\nExpert Communication" shape=ellipse]
	layer_10_expert_17_comm -> layer_10_expert_17 [style=solid]
	layer_10_expert_18 [label="GPU 288\nExpert 18 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_18 [style=dashed]
	layer_10_expert_18_comm [label="GPU 288\nExpert Communication" shape=ellipse]
	layer_10_expert_18_comm -> layer_10_expert_18 [style=solid]
	layer_10_expert_19 [label="GPU 288\nExpert 19 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_19 [style=dashed]
	layer_10_expert_19_comm [label="GPU 288\nExpert Communication" shape=ellipse]
	layer_10_expert_19_comm -> layer_10_expert_19 [style=solid]
	layer_10_expert_20 [label="GPU 296\nExpert 20 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_20 [style=dashed]
	layer_10_expert_20_comm [label="GPU 296\nExpert Communication" shape=ellipse]
	layer_10_expert_20_comm -> layer_10_expert_20 [style=solid]
	layer_10_expert_21 [label="GPU 296\nExpert 21 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_21 [style=dashed]
	layer_10_expert_21_comm [label="GPU 296\nExpert Communication" shape=ellipse]
	layer_10_expert_21_comm -> layer_10_expert_21 [style=solid]
	layer_10_expert_22 [label="GPU 296\nExpert 22 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_22 [style=dashed]
	layer_10_expert_22_comm [label="GPU 296\nExpert Communication" shape=ellipse]
	layer_10_expert_22_comm -> layer_10_expert_22 [style=solid]
	layer_10_expert_23 [label="GPU 296\nExpert 23 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_23 [style=dashed]
	layer_10_expert_23_comm [label="GPU 296\nExpert Communication" shape=ellipse]
	layer_10_expert_23_comm -> layer_10_expert_23 [style=solid]
	layer_10_expert_24 [label="GPU 304\nExpert 24 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_24 [style=dashed]
	layer_10_expert_24_comm [label="GPU 304\nExpert Communication" shape=ellipse]
	layer_10_expert_24_comm -> layer_10_expert_24 [style=solid]
	layer_10_expert_25 [label="GPU 304\nExpert 25 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_25 [style=dashed]
	layer_10_expert_25_comm [label="GPU 304\nExpert Communication" shape=ellipse]
	layer_10_expert_25_comm -> layer_10_expert_25 [style=solid]
	layer_10_expert_26 [label="GPU 304\nExpert 26 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_26 [style=dashed]
	layer_10_expert_26_comm [label="GPU 304\nExpert Communication" shape=ellipse]
	layer_10_expert_26_comm -> layer_10_expert_26 [style=solid]
	layer_10_expert_27 [label="GPU 304\nExpert 27 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_27 [style=dashed]
	layer_10_expert_27_comm [label="GPU 304\nExpert Communication" shape=ellipse]
	layer_10_expert_27_comm -> layer_10_expert_27 [style=solid]
	layer_10_expert_28 [label="GPU 312\nExpert 28 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_28 [style=dashed]
	layer_10_expert_28_comm [label="GPU 312\nExpert Communication" shape=ellipse]
	layer_10_expert_28_comm -> layer_10_expert_28 [style=solid]
	layer_10_expert_29 [label="GPU 312\nExpert 29 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_29 [style=dashed]
	layer_10_expert_29_comm [label="GPU 312\nExpert Communication" shape=ellipse]
	layer_10_expert_29_comm -> layer_10_expert_29 [style=solid]
	layer_10_expert_30 [label="GPU 312\nExpert 30 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_30 [style=dashed]
	layer_10_expert_30_comm [label="GPU 312\nExpert Communication" shape=ellipse]
	layer_10_expert_30_comm -> layer_10_expert_30 [style=solid]
	layer_10_expert_31 [label="GPU 312\nExpert 31 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_31 [style=dashed]
	layer_10_expert_31_comm [label="GPU 312\nExpert Communication" shape=ellipse]
	layer_10_expert_31_comm -> layer_10_expert_31 [style=solid]
	layer_10_expert_32 [label="GPU 320\nExpert 32 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_32 [style=dashed]
	layer_10_expert_32_comm [label="GPU 320\nExpert Communication" shape=ellipse]
	layer_10_expert_32_comm -> layer_10_expert_32 [style=solid]
	layer_10_expert_33 [label="GPU 320\nExpert 33 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_33 [style=dashed]
	layer_10_expert_33_comm [label="GPU 320\nExpert Communication" shape=ellipse]
	layer_10_expert_33_comm -> layer_10_expert_33 [style=solid]
	layer_10_expert_34 [label="GPU 320\nExpert 34 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_34 [style=dashed]
	layer_10_expert_34_comm [label="GPU 320\nExpert Communication" shape=ellipse]
	layer_10_expert_34_comm -> layer_10_expert_34 [style=solid]
	layer_10_expert_35 [label="GPU 320\nExpert 35 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_35 [style=dashed]
	layer_10_expert_35_comm [label="GPU 320\nExpert Communication" shape=ellipse]
	layer_10_expert_35_comm -> layer_10_expert_35 [style=solid]
	layer_10_expert_36 [label="GPU 328\nExpert 36 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_36 [style=dashed]
	layer_10_expert_36_comm [label="GPU 328\nExpert Communication" shape=ellipse]
	layer_10_expert_36_comm -> layer_10_expert_36 [style=solid]
	layer_10_expert_37 [label="GPU 328\nExpert 37 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_37 [style=dashed]
	layer_10_expert_37_comm [label="GPU 328\nExpert Communication" shape=ellipse]
	layer_10_expert_37_comm -> layer_10_expert_37 [style=solid]
	layer_10_expert_38 [label="GPU 328\nExpert 38 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_38 [style=dashed]
	layer_10_expert_38_comm [label="GPU 328\nExpert Communication" shape=ellipse]
	layer_10_expert_38_comm -> layer_10_expert_38 [style=solid]
	layer_10_expert_39 [label="GPU 328\nExpert 39 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_39 [style=dashed]
	layer_10_expert_39_comm [label="GPU 328\nExpert Communication" shape=ellipse]
	layer_10_expert_39_comm -> layer_10_expert_39 [style=solid]
	layer_10_expert_40 [label="GPU 336\nExpert 40 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_40 [style=dashed]
	layer_10_expert_40_comm [label="GPU 336\nExpert Communication" shape=ellipse]
	layer_10_expert_40_comm -> layer_10_expert_40 [style=solid]
	layer_10_expert_41 [label="GPU 336\nExpert 41 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_41 [style=dashed]
	layer_10_expert_41_comm [label="GPU 336\nExpert Communication" shape=ellipse]
	layer_10_expert_41_comm -> layer_10_expert_41 [style=solid]
	layer_10_expert_42 [label="GPU 336\nExpert 42 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_42 [style=dashed]
	layer_10_expert_42_comm [label="GPU 336\nExpert Communication" shape=ellipse]
	layer_10_expert_42_comm -> layer_10_expert_42 [style=solid]
	layer_10_expert_43 [label="GPU 336\nExpert 43 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_43 [style=dashed]
	layer_10_expert_43_comm [label="GPU 336\nExpert Communication" shape=ellipse]
	layer_10_expert_43_comm -> layer_10_expert_43 [style=solid]
	layer_10_expert_44 [label="GPU 344\nExpert 44 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_44 [style=dashed]
	layer_10_expert_44_comm [label="GPU 344\nExpert Communication" shape=ellipse]
	layer_10_expert_44_comm -> layer_10_expert_44 [style=solid]
	layer_10_expert_45 [label="GPU 344\nExpert 45 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_45 [style=dashed]
	layer_10_expert_45_comm [label="GPU 344\nExpert Communication" shape=ellipse]
	layer_10_expert_45_comm -> layer_10_expert_45 [style=solid]
	layer_10_expert_46 [label="GPU 344\nExpert 46 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_46 [style=dashed]
	layer_10_expert_46_comm [label="GPU 344\nExpert Communication" shape=ellipse]
	layer_10_expert_46_comm -> layer_10_expert_46 [style=solid]
	layer_10_expert_47 [label="GPU 344\nExpert 47 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_47 [style=dashed]
	layer_10_expert_47_comm [label="GPU 344\nExpert Communication" shape=ellipse]
	layer_10_expert_47_comm -> layer_10_expert_47 [style=solid]
	layer_10_expert_48 [label="GPU 352\nExpert 48 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_48 [style=dashed]
	layer_10_expert_48_comm [label="GPU 352\nExpert Communication" shape=ellipse]
	layer_10_expert_48_comm -> layer_10_expert_48 [style=solid]
	layer_10_expert_49 [label="GPU 352\nExpert 49 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_49 [style=dashed]
	layer_10_expert_49_comm [label="GPU 352\nExpert Communication" shape=ellipse]
	layer_10_expert_49_comm -> layer_10_expert_49 [style=solid]
	layer_10_expert_50 [label="GPU 352\nExpert 50 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_50 [style=dashed]
	layer_10_expert_50_comm [label="GPU 352\nExpert Communication" shape=ellipse]
	layer_10_expert_50_comm -> layer_10_expert_50 [style=solid]
	layer_10_expert_51 [label="GPU 352\nExpert 51 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_51 [style=dashed]
	layer_10_expert_51_comm [label="GPU 352\nExpert Communication" shape=ellipse]
	layer_10_expert_51_comm -> layer_10_expert_51 [style=solid]
	layer_10_expert_52 [label="GPU 360\nExpert 52 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_52 [style=dashed]
	layer_10_expert_52_comm [label="GPU 360\nExpert Communication" shape=ellipse]
	layer_10_expert_52_comm -> layer_10_expert_52 [style=solid]
	layer_10_expert_53 [label="GPU 360\nExpert 53 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_53 [style=dashed]
	layer_10_expert_53_comm [label="GPU 360\nExpert Communication" shape=ellipse]
	layer_10_expert_53_comm -> layer_10_expert_53 [style=solid]
	layer_10_expert_54 [label="GPU 360\nExpert 54 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_54 [style=dashed]
	layer_10_expert_54_comm [label="GPU 360\nExpert Communication" shape=ellipse]
	layer_10_expert_54_comm -> layer_10_expert_54 [style=solid]
	layer_10_expert_55 [label="GPU 360\nExpert 55 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_55 [style=dashed]
	layer_10_expert_55_comm [label="GPU 360\nExpert Communication" shape=ellipse]
	layer_10_expert_55_comm -> layer_10_expert_55 [style=solid]
	layer_10_expert_56 [label="GPU 368\nExpert 56 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_56 [style=dashed]
	layer_10_expert_56_comm [label="GPU 368\nExpert Communication" shape=ellipse]
	layer_10_expert_56_comm -> layer_10_expert_56 [style=solid]
	layer_10_expert_57 [label="GPU 368\nExpert 57 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_57 [style=dashed]
	layer_10_expert_57_comm [label="GPU 368\nExpert Communication" shape=ellipse]
	layer_10_expert_57_comm -> layer_10_expert_57 [style=solid]
	layer_10_expert_58 [label="GPU 368\nExpert 58 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_58 [style=dashed]
	layer_10_expert_58_comm [label="GPU 368\nExpert Communication" shape=ellipse]
	layer_10_expert_58_comm -> layer_10_expert_58 [style=solid]
	layer_10_expert_59 [label="GPU 368\nExpert 59 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_59 [style=dashed]
	layer_10_expert_59_comm [label="GPU 368\nExpert Communication" shape=ellipse]
	layer_10_expert_59_comm -> layer_10_expert_59 [style=solid]
	layer_10_expert_60 [label="GPU 376\nExpert 60 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_60 [style=dashed]
	layer_10_expert_60_comm [label="GPU 376\nExpert Communication" shape=ellipse]
	layer_10_expert_60_comm -> layer_10_expert_60 [style=solid]
	layer_10_expert_61 [label="GPU 376\nExpert 61 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_61 [style=dashed]
	layer_10_expert_61_comm [label="GPU 376\nExpert Communication" shape=ellipse]
	layer_10_expert_61_comm -> layer_10_expert_61 [style=solid]
	layer_10_expert_62 [label="GPU 376\nExpert 62 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_62 [style=dashed]
	layer_10_expert_62_comm [label="GPU 376\nExpert Communication" shape=ellipse]
	layer_10_expert_62_comm -> layer_10_expert_62 [style=solid]
	layer_10_expert_63 [label="GPU 376\nExpert 63 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_10_gate -> layer_10_expert_63 [style=dashed]
	layer_10_expert_63_comm [label="GPU 376\nExpert Communication" shape=ellipse]
	layer_10_expert_63_comm -> layer_10_expert_63 [style=solid]
	layer_10_expert_agg [label="GPU 256\nExpert Aggregation (Weighted Sum)\nInput: [batch_size=16, seq_len=10240, experts=64, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=parallelogram]
	layer_10_expert_0 -> layer_10_expert_agg [style=solid]
	layer_10_expert_1 -> layer_10_expert_agg [style=solid]
	layer_10_expert_2 -> layer_10_expert_agg [style=solid]
	layer_10_expert_3 -> layer_10_expert_agg [style=solid]
	layer_10_expert_4 -> layer_10_expert_agg [style=solid]
	layer_10_expert_5 -> layer_10_expert_agg [style=solid]
	layer_10_expert_6 -> layer_10_expert_agg [style=solid]
	layer_10_expert_7 -> layer_10_expert_agg [style=solid]
	layer_10_expert_8 -> layer_10_expert_agg [style=solid]
	layer_10_expert_9 -> layer_10_expert_agg [style=solid]
	layer_10_expert_10 -> layer_10_expert_agg [style=solid]
	layer_10_expert_11 -> layer_10_expert_agg [style=solid]
	layer_10_expert_12 -> layer_10_expert_agg [style=solid]
	layer_10_expert_13 -> layer_10_expert_agg [style=solid]
	layer_10_expert_14 -> layer_10_expert_agg [style=solid]
	layer_10_expert_15 -> layer_10_expert_agg [style=solid]
	layer_10_expert_16 -> layer_10_expert_agg [style=solid]
	layer_10_expert_17 -> layer_10_expert_agg [style=solid]
	layer_10_expert_18 -> layer_10_expert_agg [style=solid]
	layer_10_expert_19 -> layer_10_expert_agg [style=solid]
	layer_10_expert_20 -> layer_10_expert_agg [style=solid]
	layer_10_expert_21 -> layer_10_expert_agg [style=solid]
	layer_10_expert_22 -> layer_10_expert_agg [style=solid]
	layer_10_expert_23 -> layer_10_expert_agg [style=solid]
	layer_10_expert_24 -> layer_10_expert_agg [style=solid]
	layer_10_expert_25 -> layer_10_expert_agg [style=solid]
	layer_10_expert_26 -> layer_10_expert_agg [style=solid]
	layer_10_expert_27 -> layer_10_expert_agg [style=solid]
	layer_10_expert_28 -> layer_10_expert_agg [style=solid]
	layer_10_expert_29 -> layer_10_expert_agg [style=solid]
	layer_10_expert_30 -> layer_10_expert_agg [style=solid]
	layer_10_expert_31 -> layer_10_expert_agg [style=solid]
	layer_10_expert_32 -> layer_10_expert_agg [style=solid]
	layer_10_expert_33 -> layer_10_expert_agg [style=solid]
	layer_10_expert_34 -> layer_10_expert_agg [style=solid]
	layer_10_expert_35 -> layer_10_expert_agg [style=solid]
	layer_10_expert_36 -> layer_10_expert_agg [style=solid]
	layer_10_expert_37 -> layer_10_expert_agg [style=solid]
	layer_10_expert_38 -> layer_10_expert_agg [style=solid]
	layer_10_expert_39 -> layer_10_expert_agg [style=solid]
	layer_10_expert_40 -> layer_10_expert_agg [style=solid]
	layer_10_expert_41 -> layer_10_expert_agg [style=solid]
	layer_10_expert_42 -> layer_10_expert_agg [style=solid]
	layer_10_expert_43 -> layer_10_expert_agg [style=solid]
	layer_10_expert_44 -> layer_10_expert_agg [style=solid]
	layer_10_expert_45 -> layer_10_expert_agg [style=solid]
	layer_10_expert_46 -> layer_10_expert_agg [style=solid]
	layer_10_expert_47 -> layer_10_expert_agg [style=solid]
	layer_10_expert_48 -> layer_10_expert_agg [style=solid]
	layer_10_expert_49 -> layer_10_expert_agg [style=solid]
	layer_10_expert_50 -> layer_10_expert_agg [style=solid]
	layer_10_expert_51 -> layer_10_expert_agg [style=solid]
	layer_10_expert_52 -> layer_10_expert_agg [style=solid]
	layer_10_expert_53 -> layer_10_expert_agg [style=solid]
	layer_10_expert_54 -> layer_10_expert_agg [style=solid]
	layer_10_expert_55 -> layer_10_expert_agg [style=solid]
	layer_10_expert_56 -> layer_10_expert_agg [style=solid]
	layer_10_expert_57 -> layer_10_expert_agg [style=solid]
	layer_10_expert_58 -> layer_10_expert_agg [style=solid]
	layer_10_expert_59 -> layer_10_expert_agg [style=solid]
	layer_10_expert_60 -> layer_10_expert_agg [style=solid]
	layer_10_expert_61 -> layer_10_expert_agg [style=solid]
	layer_10_expert_62 -> layer_10_expert_agg [style=solid]
	layer_10_expert_63 -> layer_10_expert_agg [style=solid]
	layer_10_expert_agg -> layer_10_moe [style=solid]
	layer_10_norm [label="GPU 256\nLayer Normalization\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_10_moe -> layer_10_norm [style=solid]
	layer_10_dp_comm [label="GPU 256\nData Parallel All-Reduce" shape=ellipse]
	layer_10_norm -> layer_10_dp_comm [style=solid]
	layer_10_dp_comm -> layer_11_attn [style=solid]
	layer_11_attn [label="GPU 256\nLayer 11 Self-Attention\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_11_attn_comm [label="GPU 256\nAttention Communication" shape=ellipse]
	layer_10_attn -> layer_11_attn_comm [style=solid]
	layer_11_attn_comm -> layer_11_attn [style=solid]
	layer_11_moe [label="GPU 256\nLayer 11 MoE Layer\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_11_attn -> layer_11_moe [style=solid]
	layer_11_gate [label="GPU 256\nExpert Gate (Top-2)\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, experts=2]" shape=parallelogram]
	layer_11_attn -> layer_11_gate [style=solid]
	layer_11_expert_0 [label="GPU 256\nExpert 0 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_0 [style=dashed]
	layer_11_expert_1 [label="GPU 256\nExpert 1 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_1 [style=dashed]
	layer_11_expert_2 [label="GPU 256\nExpert 2 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_2 [style=dashed]
	layer_11_expert_3 [label="GPU 256\nExpert 3 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_3 [style=dashed]
	layer_11_expert_4 [label="GPU 264\nExpert 4 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_4 [style=dashed]
	layer_11_expert_4_comm [label="GPU 264\nExpert Communication" shape=ellipse]
	layer_11_expert_4_comm -> layer_11_expert_4 [style=solid]
	layer_11_expert_5 [label="GPU 264\nExpert 5 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_5 [style=dashed]
	layer_11_expert_5_comm [label="GPU 264\nExpert Communication" shape=ellipse]
	layer_11_expert_5_comm -> layer_11_expert_5 [style=solid]
	layer_11_expert_6 [label="GPU 264\nExpert 6 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_6 [style=dashed]
	layer_11_expert_6_comm [label="GPU 264\nExpert Communication" shape=ellipse]
	layer_11_expert_6_comm -> layer_11_expert_6 [style=solid]
	layer_11_expert_7 [label="GPU 264\nExpert 7 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_7 [style=dashed]
	layer_11_expert_7_comm [label="GPU 264\nExpert Communication" shape=ellipse]
	layer_11_expert_7_comm -> layer_11_expert_7 [style=solid]
	layer_11_expert_8 [label="GPU 272\nExpert 8 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_8 [style=dashed]
	layer_11_expert_8_comm [label="GPU 272\nExpert Communication" shape=ellipse]
	layer_11_expert_8_comm -> layer_11_expert_8 [style=solid]
	layer_11_expert_9 [label="GPU 272\nExpert 9 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_9 [style=dashed]
	layer_11_expert_9_comm [label="GPU 272\nExpert Communication" shape=ellipse]
	layer_11_expert_9_comm -> layer_11_expert_9 [style=solid]
	layer_11_expert_10 [label="GPU 272\nExpert 10 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_10 [style=dashed]
	layer_11_expert_10_comm [label="GPU 272\nExpert Communication" shape=ellipse]
	layer_11_expert_10_comm -> layer_11_expert_10 [style=solid]
	layer_11_expert_11 [label="GPU 272\nExpert 11 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_11 [style=dashed]
	layer_11_expert_11_comm [label="GPU 272\nExpert Communication" shape=ellipse]
	layer_11_expert_11_comm -> layer_11_expert_11 [style=solid]
	layer_11_expert_12 [label="GPU 280\nExpert 12 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_12 [style=dashed]
	layer_11_expert_12_comm [label="GPU 280\nExpert Communication" shape=ellipse]
	layer_11_expert_12_comm -> layer_11_expert_12 [style=solid]
	layer_11_expert_13 [label="GPU 280\nExpert 13 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_13 [style=dashed]
	layer_11_expert_13_comm [label="GPU 280\nExpert Communication" shape=ellipse]
	layer_11_expert_13_comm -> layer_11_expert_13 [style=solid]
	layer_11_expert_14 [label="GPU 280\nExpert 14 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_14 [style=dashed]
	layer_11_expert_14_comm [label="GPU 280\nExpert Communication" shape=ellipse]
	layer_11_expert_14_comm -> layer_11_expert_14 [style=solid]
	layer_11_expert_15 [label="GPU 280\nExpert 15 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_15 [style=dashed]
	layer_11_expert_15_comm [label="GPU 280\nExpert Communication" shape=ellipse]
	layer_11_expert_15_comm -> layer_11_expert_15 [style=solid]
	layer_11_expert_16 [label="GPU 288\nExpert 16 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_16 [style=dashed]
	layer_11_expert_16_comm [label="GPU 288\nExpert Communication" shape=ellipse]
	layer_11_expert_16_comm -> layer_11_expert_16 [style=solid]
	layer_11_expert_17 [label="GPU 288\nExpert 17 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_17 [style=dashed]
	layer_11_expert_17_comm [label="GPU 288\nExpert Communication" shape=ellipse]
	layer_11_expert_17_comm -> layer_11_expert_17 [style=solid]
	layer_11_expert_18 [label="GPU 288\nExpert 18 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_18 [style=dashed]
	layer_11_expert_18_comm [label="GPU 288\nExpert Communication" shape=ellipse]
	layer_11_expert_18_comm -> layer_11_expert_18 [style=solid]
	layer_11_expert_19 [label="GPU 288\nExpert 19 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_19 [style=dashed]
	layer_11_expert_19_comm [label="GPU 288\nExpert Communication" shape=ellipse]
	layer_11_expert_19_comm -> layer_11_expert_19 [style=solid]
	layer_11_expert_20 [label="GPU 296\nExpert 20 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_20 [style=dashed]
	layer_11_expert_20_comm [label="GPU 296\nExpert Communication" shape=ellipse]
	layer_11_expert_20_comm -> layer_11_expert_20 [style=solid]
	layer_11_expert_21 [label="GPU 296\nExpert 21 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_21 [style=dashed]
	layer_11_expert_21_comm [label="GPU 296\nExpert Communication" shape=ellipse]
	layer_11_expert_21_comm -> layer_11_expert_21 [style=solid]
	layer_11_expert_22 [label="GPU 296\nExpert 22 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_22 [style=dashed]
	layer_11_expert_22_comm [label="GPU 296\nExpert Communication" shape=ellipse]
	layer_11_expert_22_comm -> layer_11_expert_22 [style=solid]
	layer_11_expert_23 [label="GPU 296\nExpert 23 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_23 [style=dashed]
	layer_11_expert_23_comm [label="GPU 296\nExpert Communication" shape=ellipse]
	layer_11_expert_23_comm -> layer_11_expert_23 [style=solid]
	layer_11_expert_24 [label="GPU 304\nExpert 24 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_24 [style=dashed]
	layer_11_expert_24_comm [label="GPU 304\nExpert Communication" shape=ellipse]
	layer_11_expert_24_comm -> layer_11_expert_24 [style=solid]
	layer_11_expert_25 [label="GPU 304\nExpert 25 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_25 [style=dashed]
	layer_11_expert_25_comm [label="GPU 304\nExpert Communication" shape=ellipse]
	layer_11_expert_25_comm -> layer_11_expert_25 [style=solid]
	layer_11_expert_26 [label="GPU 304\nExpert 26 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_26 [style=dashed]
	layer_11_expert_26_comm [label="GPU 304\nExpert Communication" shape=ellipse]
	layer_11_expert_26_comm -> layer_11_expert_26 [style=solid]
	layer_11_expert_27 [label="GPU 304\nExpert 27 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_27 [style=dashed]
	layer_11_expert_27_comm [label="GPU 304\nExpert Communication" shape=ellipse]
	layer_11_expert_27_comm -> layer_11_expert_27 [style=solid]
	layer_11_expert_28 [label="GPU 312\nExpert 28 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_28 [style=dashed]
	layer_11_expert_28_comm [label="GPU 312\nExpert Communication" shape=ellipse]
	layer_11_expert_28_comm -> layer_11_expert_28 [style=solid]
	layer_11_expert_29 [label="GPU 312\nExpert 29 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_29 [style=dashed]
	layer_11_expert_29_comm [label="GPU 312\nExpert Communication" shape=ellipse]
	layer_11_expert_29_comm -> layer_11_expert_29 [style=solid]
	layer_11_expert_30 [label="GPU 312\nExpert 30 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_30 [style=dashed]
	layer_11_expert_30_comm [label="GPU 312\nExpert Communication" shape=ellipse]
	layer_11_expert_30_comm -> layer_11_expert_30 [style=solid]
	layer_11_expert_31 [label="GPU 312\nExpert 31 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_31 [style=dashed]
	layer_11_expert_31_comm [label="GPU 312\nExpert Communication" shape=ellipse]
	layer_11_expert_31_comm -> layer_11_expert_31 [style=solid]
	layer_11_expert_32 [label="GPU 320\nExpert 32 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_32 [style=dashed]
	layer_11_expert_32_comm [label="GPU 320\nExpert Communication" shape=ellipse]
	layer_11_expert_32_comm -> layer_11_expert_32 [style=solid]
	layer_11_expert_33 [label="GPU 320\nExpert 33 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_33 [style=dashed]
	layer_11_expert_33_comm [label="GPU 320\nExpert Communication" shape=ellipse]
	layer_11_expert_33_comm -> layer_11_expert_33 [style=solid]
	layer_11_expert_34 [label="GPU 320\nExpert 34 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_34 [style=dashed]
	layer_11_expert_34_comm [label="GPU 320\nExpert Communication" shape=ellipse]
	layer_11_expert_34_comm -> layer_11_expert_34 [style=solid]
	layer_11_expert_35 [label="GPU 320\nExpert 35 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_35 [style=dashed]
	layer_11_expert_35_comm [label="GPU 320\nExpert Communication" shape=ellipse]
	layer_11_expert_35_comm -> layer_11_expert_35 [style=solid]
	layer_11_expert_36 [label="GPU 328\nExpert 36 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_36 [style=dashed]
	layer_11_expert_36_comm [label="GPU 328\nExpert Communication" shape=ellipse]
	layer_11_expert_36_comm -> layer_11_expert_36 [style=solid]
	layer_11_expert_37 [label="GPU 328\nExpert 37 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_37 [style=dashed]
	layer_11_expert_37_comm [label="GPU 328\nExpert Communication" shape=ellipse]
	layer_11_expert_37_comm -> layer_11_expert_37 [style=solid]
	layer_11_expert_38 [label="GPU 328\nExpert 38 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_38 [style=dashed]
	layer_11_expert_38_comm [label="GPU 328\nExpert Communication" shape=ellipse]
	layer_11_expert_38_comm -> layer_11_expert_38 [style=solid]
	layer_11_expert_39 [label="GPU 328\nExpert 39 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_39 [style=dashed]
	layer_11_expert_39_comm [label="GPU 328\nExpert Communication" shape=ellipse]
	layer_11_expert_39_comm -> layer_11_expert_39 [style=solid]
	layer_11_expert_40 [label="GPU 336\nExpert 40 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_40 [style=dashed]
	layer_11_expert_40_comm [label="GPU 336\nExpert Communication" shape=ellipse]
	layer_11_expert_40_comm -> layer_11_expert_40 [style=solid]
	layer_11_expert_41 [label="GPU 336\nExpert 41 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_41 [style=dashed]
	layer_11_expert_41_comm [label="GPU 336\nExpert Communication" shape=ellipse]
	layer_11_expert_41_comm -> layer_11_expert_41 [style=solid]
	layer_11_expert_42 [label="GPU 336\nExpert 42 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_42 [style=dashed]
	layer_11_expert_42_comm [label="GPU 336\nExpert Communication" shape=ellipse]
	layer_11_expert_42_comm -> layer_11_expert_42 [style=solid]
	layer_11_expert_43 [label="GPU 336\nExpert 43 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_43 [style=dashed]
	layer_11_expert_43_comm [label="GPU 336\nExpert Communication" shape=ellipse]
	layer_11_expert_43_comm -> layer_11_expert_43 [style=solid]
	layer_11_expert_44 [label="GPU 344\nExpert 44 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_44 [style=dashed]
	layer_11_expert_44_comm [label="GPU 344\nExpert Communication" shape=ellipse]
	layer_11_expert_44_comm -> layer_11_expert_44 [style=solid]
	layer_11_expert_45 [label="GPU 344\nExpert 45 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_45 [style=dashed]
	layer_11_expert_45_comm [label="GPU 344\nExpert Communication" shape=ellipse]
	layer_11_expert_45_comm -> layer_11_expert_45 [style=solid]
	layer_11_expert_46 [label="GPU 344\nExpert 46 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_46 [style=dashed]
	layer_11_expert_46_comm [label="GPU 344\nExpert Communication" shape=ellipse]
	layer_11_expert_46_comm -> layer_11_expert_46 [style=solid]
	layer_11_expert_47 [label="GPU 344\nExpert 47 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_47 [style=dashed]
	layer_11_expert_47_comm [label="GPU 344\nExpert Communication" shape=ellipse]
	layer_11_expert_47_comm -> layer_11_expert_47 [style=solid]
	layer_11_expert_48 [label="GPU 352\nExpert 48 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_48 [style=dashed]
	layer_11_expert_48_comm [label="GPU 352\nExpert Communication" shape=ellipse]
	layer_11_expert_48_comm -> layer_11_expert_48 [style=solid]
	layer_11_expert_49 [label="GPU 352\nExpert 49 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_49 [style=dashed]
	layer_11_expert_49_comm [label="GPU 352\nExpert Communication" shape=ellipse]
	layer_11_expert_49_comm -> layer_11_expert_49 [style=solid]
	layer_11_expert_50 [label="GPU 352\nExpert 50 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_50 [style=dashed]
	layer_11_expert_50_comm [label="GPU 352\nExpert Communication" shape=ellipse]
	layer_11_expert_50_comm -> layer_11_expert_50 [style=solid]
	layer_11_expert_51 [label="GPU 352\nExpert 51 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_51 [style=dashed]
	layer_11_expert_51_comm [label="GPU 352\nExpert Communication" shape=ellipse]
	layer_11_expert_51_comm -> layer_11_expert_51 [style=solid]
	layer_11_expert_52 [label="GPU 360\nExpert 52 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_52 [style=dashed]
	layer_11_expert_52_comm [label="GPU 360\nExpert Communication" shape=ellipse]
	layer_11_expert_52_comm -> layer_11_expert_52 [style=solid]
	layer_11_expert_53 [label="GPU 360\nExpert 53 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_53 [style=dashed]
	layer_11_expert_53_comm [label="GPU 360\nExpert Communication" shape=ellipse]
	layer_11_expert_53_comm -> layer_11_expert_53 [style=solid]
	layer_11_expert_54 [label="GPU 360\nExpert 54 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_54 [style=dashed]
	layer_11_expert_54_comm [label="GPU 360\nExpert Communication" shape=ellipse]
	layer_11_expert_54_comm -> layer_11_expert_54 [style=solid]
	layer_11_expert_55 [label="GPU 360\nExpert 55 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_55 [style=dashed]
	layer_11_expert_55_comm [label="GPU 360\nExpert Communication" shape=ellipse]
	layer_11_expert_55_comm -> layer_11_expert_55 [style=solid]
	layer_11_expert_56 [label="GPU 368\nExpert 56 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_56 [style=dashed]
	layer_11_expert_56_comm [label="GPU 368\nExpert Communication" shape=ellipse]
	layer_11_expert_56_comm -> layer_11_expert_56 [style=solid]
	layer_11_expert_57 [label="GPU 368\nExpert 57 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_57 [style=dashed]
	layer_11_expert_57_comm [label="GPU 368\nExpert Communication" shape=ellipse]
	layer_11_expert_57_comm -> layer_11_expert_57 [style=solid]
	layer_11_expert_58 [label="GPU 368\nExpert 58 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_58 [style=dashed]
	layer_11_expert_58_comm [label="GPU 368\nExpert Communication" shape=ellipse]
	layer_11_expert_58_comm -> layer_11_expert_58 [style=solid]
	layer_11_expert_59 [label="GPU 368\nExpert 59 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_59 [style=dashed]
	layer_11_expert_59_comm [label="GPU 368\nExpert Communication" shape=ellipse]
	layer_11_expert_59_comm -> layer_11_expert_59 [style=solid]
	layer_11_expert_60 [label="GPU 376\nExpert 60 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_60 [style=dashed]
	layer_11_expert_60_comm [label="GPU 376\nExpert Communication" shape=ellipse]
	layer_11_expert_60_comm -> layer_11_expert_60 [style=solid]
	layer_11_expert_61 [label="GPU 376\nExpert 61 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_61 [style=dashed]
	layer_11_expert_61_comm [label="GPU 376\nExpert Communication" shape=ellipse]
	layer_11_expert_61_comm -> layer_11_expert_61 [style=solid]
	layer_11_expert_62 [label="GPU 376\nExpert 62 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_62 [style=dashed]
	layer_11_expert_62_comm [label="GPU 376\nExpert Communication" shape=ellipse]
	layer_11_expert_62_comm -> layer_11_expert_62 [style=solid]
	layer_11_expert_63 [label="GPU 376\nExpert 63 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_11_gate -> layer_11_expert_63 [style=dashed]
	layer_11_expert_63_comm [label="GPU 376\nExpert Communication" shape=ellipse]
	layer_11_expert_63_comm -> layer_11_expert_63 [style=solid]
	layer_11_expert_agg [label="GPU 256\nExpert Aggregation (Weighted Sum)\nInput: [batch_size=16, seq_len=10240, experts=64, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=parallelogram]
	layer_11_expert_0 -> layer_11_expert_agg [style=solid]
	layer_11_expert_1 -> layer_11_expert_agg [style=solid]
	layer_11_expert_2 -> layer_11_expert_agg [style=solid]
	layer_11_expert_3 -> layer_11_expert_agg [style=solid]
	layer_11_expert_4 -> layer_11_expert_agg [style=solid]
	layer_11_expert_5 -> layer_11_expert_agg [style=solid]
	layer_11_expert_6 -> layer_11_expert_agg [style=solid]
	layer_11_expert_7 -> layer_11_expert_agg [style=solid]
	layer_11_expert_8 -> layer_11_expert_agg [style=solid]
	layer_11_expert_9 -> layer_11_expert_agg [style=solid]
	layer_11_expert_10 -> layer_11_expert_agg [style=solid]
	layer_11_expert_11 -> layer_11_expert_agg [style=solid]
	layer_11_expert_12 -> layer_11_expert_agg [style=solid]
	layer_11_expert_13 -> layer_11_expert_agg [style=solid]
	layer_11_expert_14 -> layer_11_expert_agg [style=solid]
	layer_11_expert_15 -> layer_11_expert_agg [style=solid]
	layer_11_expert_16 -> layer_11_expert_agg [style=solid]
	layer_11_expert_17 -> layer_11_expert_agg [style=solid]
	layer_11_expert_18 -> layer_11_expert_agg [style=solid]
	layer_11_expert_19 -> layer_11_expert_agg [style=solid]
	layer_11_expert_20 -> layer_11_expert_agg [style=solid]
	layer_11_expert_21 -> layer_11_expert_agg [style=solid]
	layer_11_expert_22 -> layer_11_expert_agg [style=solid]
	layer_11_expert_23 -> layer_11_expert_agg [style=solid]
	layer_11_expert_24 -> layer_11_expert_agg [style=solid]
	layer_11_expert_25 -> layer_11_expert_agg [style=solid]
	layer_11_expert_26 -> layer_11_expert_agg [style=solid]
	layer_11_expert_27 -> layer_11_expert_agg [style=solid]
	layer_11_expert_28 -> layer_11_expert_agg [style=solid]
	layer_11_expert_29 -> layer_11_expert_agg [style=solid]
	layer_11_expert_30 -> layer_11_expert_agg [style=solid]
	layer_11_expert_31 -> layer_11_expert_agg [style=solid]
	layer_11_expert_32 -> layer_11_expert_agg [style=solid]
	layer_11_expert_33 -> layer_11_expert_agg [style=solid]
	layer_11_expert_34 -> layer_11_expert_agg [style=solid]
	layer_11_expert_35 -> layer_11_expert_agg [style=solid]
	layer_11_expert_36 -> layer_11_expert_agg [style=solid]
	layer_11_expert_37 -> layer_11_expert_agg [style=solid]
	layer_11_expert_38 -> layer_11_expert_agg [style=solid]
	layer_11_expert_39 -> layer_11_expert_agg [style=solid]
	layer_11_expert_40 -> layer_11_expert_agg [style=solid]
	layer_11_expert_41 -> layer_11_expert_agg [style=solid]
	layer_11_expert_42 -> layer_11_expert_agg [style=solid]
	layer_11_expert_43 -> layer_11_expert_agg [style=solid]
	layer_11_expert_44 -> layer_11_expert_agg [style=solid]
	layer_11_expert_45 -> layer_11_expert_agg [style=solid]
	layer_11_expert_46 -> layer_11_expert_agg [style=solid]
	layer_11_expert_47 -> layer_11_expert_agg [style=solid]
	layer_11_expert_48 -> layer_11_expert_agg [style=solid]
	layer_11_expert_49 -> layer_11_expert_agg [style=solid]
	layer_11_expert_50 -> layer_11_expert_agg [style=solid]
	layer_11_expert_51 -> layer_11_expert_agg [style=solid]
	layer_11_expert_52 -> layer_11_expert_agg [style=solid]
	layer_11_expert_53 -> layer_11_expert_agg [style=solid]
	layer_11_expert_54 -> layer_11_expert_agg [style=solid]
	layer_11_expert_55 -> layer_11_expert_agg [style=solid]
	layer_11_expert_56 -> layer_11_expert_agg [style=solid]
	layer_11_expert_57 -> layer_11_expert_agg [style=solid]
	layer_11_expert_58 -> layer_11_expert_agg [style=solid]
	layer_11_expert_59 -> layer_11_expert_agg [style=solid]
	layer_11_expert_60 -> layer_11_expert_agg [style=solid]
	layer_11_expert_61 -> layer_11_expert_agg [style=solid]
	layer_11_expert_62 -> layer_11_expert_agg [style=solid]
	layer_11_expert_63 -> layer_11_expert_agg [style=solid]
	layer_11_expert_agg -> layer_11_moe [style=solid]
	layer_11_norm [label="GPU 256\nLayer Normalization\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_11_moe -> layer_11_norm [style=solid]
	layer_11_dp_comm [label="GPU 256\nData Parallel All-Reduce" shape=ellipse]
	layer_11_norm -> layer_11_dp_comm [style=solid]
	layer_11_stage_comm [label="GPU 384\nStage Communication" shape=ellipse]
	layer_11_dp_comm -> layer_11_stage_comm [style=solid]
	subgraph stage_2 {
		rank=same
		label="Pipeline Stage 2 (Layers 8-11)"
	}
	layer_12_attn [label="GPU 384\nLayer 12 Self-Attention\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_12_attn_comm [label="GPU 384\nAttention Communication" shape=ellipse]
	layer_11_attn -> layer_12_attn_comm [style=solid]
	layer_12_attn_comm -> layer_12_attn [style=solid]
	layer_12_moe [label="GPU 384\nLayer 12 MoE Layer\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_12_attn -> layer_12_moe [style=solid]
	layer_12_gate [label="GPU 384\nExpert Gate (Top-2)\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, experts=2]" shape=parallelogram]
	layer_12_attn -> layer_12_gate [style=solid]
	layer_12_expert_0 [label="GPU 384\nExpert 0 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_0 [style=dashed]
	layer_12_expert_1 [label="GPU 384\nExpert 1 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_1 [style=dashed]
	layer_12_expert_2 [label="GPU 384\nExpert 2 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_2 [style=dashed]
	layer_12_expert_3 [label="GPU 384\nExpert 3 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_3 [style=dashed]
	layer_12_expert_4 [label="GPU 392\nExpert 4 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_4 [style=dashed]
	layer_12_expert_4_comm [label="GPU 392\nExpert Communication" shape=ellipse]
	layer_12_expert_4_comm -> layer_12_expert_4 [style=solid]
	layer_12_expert_5 [label="GPU 392\nExpert 5 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_5 [style=dashed]
	layer_12_expert_5_comm [label="GPU 392\nExpert Communication" shape=ellipse]
	layer_12_expert_5_comm -> layer_12_expert_5 [style=solid]
	layer_12_expert_6 [label="GPU 392\nExpert 6 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_6 [style=dashed]
	layer_12_expert_6_comm [label="GPU 392\nExpert Communication" shape=ellipse]
	layer_12_expert_6_comm -> layer_12_expert_6 [style=solid]
	layer_12_expert_7 [label="GPU 392\nExpert 7 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_7 [style=dashed]
	layer_12_expert_7_comm [label="GPU 392\nExpert Communication" shape=ellipse]
	layer_12_expert_7_comm -> layer_12_expert_7 [style=solid]
	layer_12_expert_8 [label="GPU 400\nExpert 8 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_8 [style=dashed]
	layer_12_expert_8_comm [label="GPU 400\nExpert Communication" shape=ellipse]
	layer_12_expert_8_comm -> layer_12_expert_8 [style=solid]
	layer_12_expert_9 [label="GPU 400\nExpert 9 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_9 [style=dashed]
	layer_12_expert_9_comm [label="GPU 400\nExpert Communication" shape=ellipse]
	layer_12_expert_9_comm -> layer_12_expert_9 [style=solid]
	layer_12_expert_10 [label="GPU 400\nExpert 10 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_10 [style=dashed]
	layer_12_expert_10_comm [label="GPU 400\nExpert Communication" shape=ellipse]
	layer_12_expert_10_comm -> layer_12_expert_10 [style=solid]
	layer_12_expert_11 [label="GPU 400\nExpert 11 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_11 [style=dashed]
	layer_12_expert_11_comm [label="GPU 400\nExpert Communication" shape=ellipse]
	layer_12_expert_11_comm -> layer_12_expert_11 [style=solid]
	layer_12_expert_12 [label="GPU 408\nExpert 12 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_12 [style=dashed]
	layer_12_expert_12_comm [label="GPU 408\nExpert Communication" shape=ellipse]
	layer_12_expert_12_comm -> layer_12_expert_12 [style=solid]
	layer_12_expert_13 [label="GPU 408\nExpert 13 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_13 [style=dashed]
	layer_12_expert_13_comm [label="GPU 408\nExpert Communication" shape=ellipse]
	layer_12_expert_13_comm -> layer_12_expert_13 [style=solid]
	layer_12_expert_14 [label="GPU 408\nExpert 14 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_14 [style=dashed]
	layer_12_expert_14_comm [label="GPU 408\nExpert Communication" shape=ellipse]
	layer_12_expert_14_comm -> layer_12_expert_14 [style=solid]
	layer_12_expert_15 [label="GPU 408\nExpert 15 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_15 [style=dashed]
	layer_12_expert_15_comm [label="GPU 408\nExpert Communication" shape=ellipse]
	layer_12_expert_15_comm -> layer_12_expert_15 [style=solid]
	layer_12_expert_16 [label="GPU 416\nExpert 16 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_16 [style=dashed]
	layer_12_expert_16_comm [label="GPU 416\nExpert Communication" shape=ellipse]
	layer_12_expert_16_comm -> layer_12_expert_16 [style=solid]
	layer_12_expert_17 [label="GPU 416\nExpert 17 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_17 [style=dashed]
	layer_12_expert_17_comm [label="GPU 416\nExpert Communication" shape=ellipse]
	layer_12_expert_17_comm -> layer_12_expert_17 [style=solid]
	layer_12_expert_18 [label="GPU 416\nExpert 18 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_18 [style=dashed]
	layer_12_expert_18_comm [label="GPU 416\nExpert Communication" shape=ellipse]
	layer_12_expert_18_comm -> layer_12_expert_18 [style=solid]
	layer_12_expert_19 [label="GPU 416\nExpert 19 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_19 [style=dashed]
	layer_12_expert_19_comm [label="GPU 416\nExpert Communication" shape=ellipse]
	layer_12_expert_19_comm -> layer_12_expert_19 [style=solid]
	layer_12_expert_20 [label="GPU 424\nExpert 20 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_20 [style=dashed]
	layer_12_expert_20_comm [label="GPU 424\nExpert Communication" shape=ellipse]
	layer_12_expert_20_comm -> layer_12_expert_20 [style=solid]
	layer_12_expert_21 [label="GPU 424\nExpert 21 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_21 [style=dashed]
	layer_12_expert_21_comm [label="GPU 424\nExpert Communication" shape=ellipse]
	layer_12_expert_21_comm -> layer_12_expert_21 [style=solid]
	layer_12_expert_22 [label="GPU 424\nExpert 22 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_22 [style=dashed]
	layer_12_expert_22_comm [label="GPU 424\nExpert Communication" shape=ellipse]
	layer_12_expert_22_comm -> layer_12_expert_22 [style=solid]
	layer_12_expert_23 [label="GPU 424\nExpert 23 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_23 [style=dashed]
	layer_12_expert_23_comm [label="GPU 424\nExpert Communication" shape=ellipse]
	layer_12_expert_23_comm -> layer_12_expert_23 [style=solid]
	layer_12_expert_24 [label="GPU 432\nExpert 24 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_24 [style=dashed]
	layer_12_expert_24_comm [label="GPU 432\nExpert Communication" shape=ellipse]
	layer_12_expert_24_comm -> layer_12_expert_24 [style=solid]
	layer_12_expert_25 [label="GPU 432\nExpert 25 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_25 [style=dashed]
	layer_12_expert_25_comm [label="GPU 432\nExpert Communication" shape=ellipse]
	layer_12_expert_25_comm -> layer_12_expert_25 [style=solid]
	layer_12_expert_26 [label="GPU 432\nExpert 26 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_26 [style=dashed]
	layer_12_expert_26_comm [label="GPU 432\nExpert Communication" shape=ellipse]
	layer_12_expert_26_comm -> layer_12_expert_26 [style=solid]
	layer_12_expert_27 [label="GPU 432\nExpert 27 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_27 [style=dashed]
	layer_12_expert_27_comm [label="GPU 432\nExpert Communication" shape=ellipse]
	layer_12_expert_27_comm -> layer_12_expert_27 [style=solid]
	layer_12_expert_28 [label="GPU 440\nExpert 28 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_28 [style=dashed]
	layer_12_expert_28_comm [label="GPU 440\nExpert Communication" shape=ellipse]
	layer_12_expert_28_comm -> layer_12_expert_28 [style=solid]
	layer_12_expert_29 [label="GPU 440\nExpert 29 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_29 [style=dashed]
	layer_12_expert_29_comm [label="GPU 440\nExpert Communication" shape=ellipse]
	layer_12_expert_29_comm -> layer_12_expert_29 [style=solid]
	layer_12_expert_30 [label="GPU 440\nExpert 30 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_30 [style=dashed]
	layer_12_expert_30_comm [label="GPU 440\nExpert Communication" shape=ellipse]
	layer_12_expert_30_comm -> layer_12_expert_30 [style=solid]
	layer_12_expert_31 [label="GPU 440\nExpert 31 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_31 [style=dashed]
	layer_12_expert_31_comm [label="GPU 440\nExpert Communication" shape=ellipse]
	layer_12_expert_31_comm -> layer_12_expert_31 [style=solid]
	layer_12_expert_32 [label="GPU 448\nExpert 32 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_32 [style=dashed]
	layer_12_expert_32_comm [label="GPU 448\nExpert Communication" shape=ellipse]
	layer_12_expert_32_comm -> layer_12_expert_32 [style=solid]
	layer_12_expert_33 [label="GPU 448\nExpert 33 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_33 [style=dashed]
	layer_12_expert_33_comm [label="GPU 448\nExpert Communication" shape=ellipse]
	layer_12_expert_33_comm -> layer_12_expert_33 [style=solid]
	layer_12_expert_34 [label="GPU 448\nExpert 34 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_34 [style=dashed]
	layer_12_expert_34_comm [label="GPU 448\nExpert Communication" shape=ellipse]
	layer_12_expert_34_comm -> layer_12_expert_34 [style=solid]
	layer_12_expert_35 [label="GPU 448\nExpert 35 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_35 [style=dashed]
	layer_12_expert_35_comm [label="GPU 448\nExpert Communication" shape=ellipse]
	layer_12_expert_35_comm -> layer_12_expert_35 [style=solid]
	layer_12_expert_36 [label="GPU 456\nExpert 36 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_36 [style=dashed]
	layer_12_expert_36_comm [label="GPU 456\nExpert Communication" shape=ellipse]
	layer_12_expert_36_comm -> layer_12_expert_36 [style=solid]
	layer_12_expert_37 [label="GPU 456\nExpert 37 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_37 [style=dashed]
	layer_12_expert_37_comm [label="GPU 456\nExpert Communication" shape=ellipse]
	layer_12_expert_37_comm -> layer_12_expert_37 [style=solid]
	layer_12_expert_38 [label="GPU 456\nExpert 38 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_38 [style=dashed]
	layer_12_expert_38_comm [label="GPU 456\nExpert Communication" shape=ellipse]
	layer_12_expert_38_comm -> layer_12_expert_38 [style=solid]
	layer_12_expert_39 [label="GPU 456\nExpert 39 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_39 [style=dashed]
	layer_12_expert_39_comm [label="GPU 456\nExpert Communication" shape=ellipse]
	layer_12_expert_39_comm -> layer_12_expert_39 [style=solid]
	layer_12_expert_40 [label="GPU 464\nExpert 40 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_40 [style=dashed]
	layer_12_expert_40_comm [label="GPU 464\nExpert Communication" shape=ellipse]
	layer_12_expert_40_comm -> layer_12_expert_40 [style=solid]
	layer_12_expert_41 [label="GPU 464\nExpert 41 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_41 [style=dashed]
	layer_12_expert_41_comm [label="GPU 464\nExpert Communication" shape=ellipse]
	layer_12_expert_41_comm -> layer_12_expert_41 [style=solid]
	layer_12_expert_42 [label="GPU 464\nExpert 42 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_42 [style=dashed]
	layer_12_expert_42_comm [label="GPU 464\nExpert Communication" shape=ellipse]
	layer_12_expert_42_comm -> layer_12_expert_42 [style=solid]
	layer_12_expert_43 [label="GPU 464\nExpert 43 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_43 [style=dashed]
	layer_12_expert_43_comm [label="GPU 464\nExpert Communication" shape=ellipse]
	layer_12_expert_43_comm -> layer_12_expert_43 [style=solid]
	layer_12_expert_44 [label="GPU 472\nExpert 44 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_44 [style=dashed]
	layer_12_expert_44_comm [label="GPU 472\nExpert Communication" shape=ellipse]
	layer_12_expert_44_comm -> layer_12_expert_44 [style=solid]
	layer_12_expert_45 [label="GPU 472\nExpert 45 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_45 [style=dashed]
	layer_12_expert_45_comm [label="GPU 472\nExpert Communication" shape=ellipse]
	layer_12_expert_45_comm -> layer_12_expert_45 [style=solid]
	layer_12_expert_46 [label="GPU 472\nExpert 46 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_46 [style=dashed]
	layer_12_expert_46_comm [label="GPU 472\nExpert Communication" shape=ellipse]
	layer_12_expert_46_comm -> layer_12_expert_46 [style=solid]
	layer_12_expert_47 [label="GPU 472\nExpert 47 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_47 [style=dashed]
	layer_12_expert_47_comm [label="GPU 472\nExpert Communication" shape=ellipse]
	layer_12_expert_47_comm -> layer_12_expert_47 [style=solid]
	layer_12_expert_48 [label="GPU 480\nExpert 48 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_48 [style=dashed]
	layer_12_expert_48_comm [label="GPU 480\nExpert Communication" shape=ellipse]
	layer_12_expert_48_comm -> layer_12_expert_48 [style=solid]
	layer_12_expert_49 [label="GPU 480\nExpert 49 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_49 [style=dashed]
	layer_12_expert_49_comm [label="GPU 480\nExpert Communication" shape=ellipse]
	layer_12_expert_49_comm -> layer_12_expert_49 [style=solid]
	layer_12_expert_50 [label="GPU 480\nExpert 50 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_50 [style=dashed]
	layer_12_expert_50_comm [label="GPU 480\nExpert Communication" shape=ellipse]
	layer_12_expert_50_comm -> layer_12_expert_50 [style=solid]
	layer_12_expert_51 [label="GPU 480\nExpert 51 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_51 [style=dashed]
	layer_12_expert_51_comm [label="GPU 480\nExpert Communication" shape=ellipse]
	layer_12_expert_51_comm -> layer_12_expert_51 [style=solid]
	layer_12_expert_52 [label="GPU 488\nExpert 52 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_52 [style=dashed]
	layer_12_expert_52_comm [label="GPU 488\nExpert Communication" shape=ellipse]
	layer_12_expert_52_comm -> layer_12_expert_52 [style=solid]
	layer_12_expert_53 [label="GPU 488\nExpert 53 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_53 [style=dashed]
	layer_12_expert_53_comm [label="GPU 488\nExpert Communication" shape=ellipse]
	layer_12_expert_53_comm -> layer_12_expert_53 [style=solid]
	layer_12_expert_54 [label="GPU 488\nExpert 54 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_54 [style=dashed]
	layer_12_expert_54_comm [label="GPU 488\nExpert Communication" shape=ellipse]
	layer_12_expert_54_comm -> layer_12_expert_54 [style=solid]
	layer_12_expert_55 [label="GPU 488\nExpert 55 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_55 [style=dashed]
	layer_12_expert_55_comm [label="GPU 488\nExpert Communication" shape=ellipse]
	layer_12_expert_55_comm -> layer_12_expert_55 [style=solid]
	layer_12_expert_56 [label="GPU 496\nExpert 56 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_56 [style=dashed]
	layer_12_expert_56_comm [label="GPU 496\nExpert Communication" shape=ellipse]
	layer_12_expert_56_comm -> layer_12_expert_56 [style=solid]
	layer_12_expert_57 [label="GPU 496\nExpert 57 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_57 [style=dashed]
	layer_12_expert_57_comm [label="GPU 496\nExpert Communication" shape=ellipse]
	layer_12_expert_57_comm -> layer_12_expert_57 [style=solid]
	layer_12_expert_58 [label="GPU 496\nExpert 58 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_58 [style=dashed]
	layer_12_expert_58_comm [label="GPU 496\nExpert Communication" shape=ellipse]
	layer_12_expert_58_comm -> layer_12_expert_58 [style=solid]
	layer_12_expert_59 [label="GPU 496\nExpert 59 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_59 [style=dashed]
	layer_12_expert_59_comm [label="GPU 496\nExpert Communication" shape=ellipse]
	layer_12_expert_59_comm -> layer_12_expert_59 [style=solid]
	layer_12_expert_60 [label="GPU 504\nExpert 60 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_60 [style=dashed]
	layer_12_expert_60_comm [label="GPU 504\nExpert Communication" shape=ellipse]
	layer_12_expert_60_comm -> layer_12_expert_60 [style=solid]
	layer_12_expert_61 [label="GPU 504\nExpert 61 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_61 [style=dashed]
	layer_12_expert_61_comm [label="GPU 504\nExpert Communication" shape=ellipse]
	layer_12_expert_61_comm -> layer_12_expert_61 [style=solid]
	layer_12_expert_62 [label="GPU 504\nExpert 62 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_62 [style=dashed]
	layer_12_expert_62_comm [label="GPU 504\nExpert Communication" shape=ellipse]
	layer_12_expert_62_comm -> layer_12_expert_62 [style=solid]
	layer_12_expert_63 [label="GPU 504\nExpert 63 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_12_gate -> layer_12_expert_63 [style=dashed]
	layer_12_expert_63_comm [label="GPU 504\nExpert Communication" shape=ellipse]
	layer_12_expert_63_comm -> layer_12_expert_63 [style=solid]
	layer_12_expert_agg [label="GPU 384\nExpert Aggregation (Weighted Sum)\nInput: [batch_size=16, seq_len=10240, experts=64, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=parallelogram]
	layer_12_expert_0 -> layer_12_expert_agg [style=solid]
	layer_12_expert_1 -> layer_12_expert_agg [style=solid]
	layer_12_expert_2 -> layer_12_expert_agg [style=solid]
	layer_12_expert_3 -> layer_12_expert_agg [style=solid]
	layer_12_expert_4 -> layer_12_expert_agg [style=solid]
	layer_12_expert_5 -> layer_12_expert_agg [style=solid]
	layer_12_expert_6 -> layer_12_expert_agg [style=solid]
	layer_12_expert_7 -> layer_12_expert_agg [style=solid]
	layer_12_expert_8 -> layer_12_expert_agg [style=solid]
	layer_12_expert_9 -> layer_12_expert_agg [style=solid]
	layer_12_expert_10 -> layer_12_expert_agg [style=solid]
	layer_12_expert_11 -> layer_12_expert_agg [style=solid]
	layer_12_expert_12 -> layer_12_expert_agg [style=solid]
	layer_12_expert_13 -> layer_12_expert_agg [style=solid]
	layer_12_expert_14 -> layer_12_expert_agg [style=solid]
	layer_12_expert_15 -> layer_12_expert_agg [style=solid]
	layer_12_expert_16 -> layer_12_expert_agg [style=solid]
	layer_12_expert_17 -> layer_12_expert_agg [style=solid]
	layer_12_expert_18 -> layer_12_expert_agg [style=solid]
	layer_12_expert_19 -> layer_12_expert_agg [style=solid]
	layer_12_expert_20 -> layer_12_expert_agg [style=solid]
	layer_12_expert_21 -> layer_12_expert_agg [style=solid]
	layer_12_expert_22 -> layer_12_expert_agg [style=solid]
	layer_12_expert_23 -> layer_12_expert_agg [style=solid]
	layer_12_expert_24 -> layer_12_expert_agg [style=solid]
	layer_12_expert_25 -> layer_12_expert_agg [style=solid]
	layer_12_expert_26 -> layer_12_expert_agg [style=solid]
	layer_12_expert_27 -> layer_12_expert_agg [style=solid]
	layer_12_expert_28 -> layer_12_expert_agg [style=solid]
	layer_12_expert_29 -> layer_12_expert_agg [style=solid]
	layer_12_expert_30 -> layer_12_expert_agg [style=solid]
	layer_12_expert_31 -> layer_12_expert_agg [style=solid]
	layer_12_expert_32 -> layer_12_expert_agg [style=solid]
	layer_12_expert_33 -> layer_12_expert_agg [style=solid]
	layer_12_expert_34 -> layer_12_expert_agg [style=solid]
	layer_12_expert_35 -> layer_12_expert_agg [style=solid]
	layer_12_expert_36 -> layer_12_expert_agg [style=solid]
	layer_12_expert_37 -> layer_12_expert_agg [style=solid]
	layer_12_expert_38 -> layer_12_expert_agg [style=solid]
	layer_12_expert_39 -> layer_12_expert_agg [style=solid]
	layer_12_expert_40 -> layer_12_expert_agg [style=solid]
	layer_12_expert_41 -> layer_12_expert_agg [style=solid]
	layer_12_expert_42 -> layer_12_expert_agg [style=solid]
	layer_12_expert_43 -> layer_12_expert_agg [style=solid]
	layer_12_expert_44 -> layer_12_expert_agg [style=solid]
	layer_12_expert_45 -> layer_12_expert_agg [style=solid]
	layer_12_expert_46 -> layer_12_expert_agg [style=solid]
	layer_12_expert_47 -> layer_12_expert_agg [style=solid]
	layer_12_expert_48 -> layer_12_expert_agg [style=solid]
	layer_12_expert_49 -> layer_12_expert_agg [style=solid]
	layer_12_expert_50 -> layer_12_expert_agg [style=solid]
	layer_12_expert_51 -> layer_12_expert_agg [style=solid]
	layer_12_expert_52 -> layer_12_expert_agg [style=solid]
	layer_12_expert_53 -> layer_12_expert_agg [style=solid]
	layer_12_expert_54 -> layer_12_expert_agg [style=solid]
	layer_12_expert_55 -> layer_12_expert_agg [style=solid]
	layer_12_expert_56 -> layer_12_expert_agg [style=solid]
	layer_12_expert_57 -> layer_12_expert_agg [style=solid]
	layer_12_expert_58 -> layer_12_expert_agg [style=solid]
	layer_12_expert_59 -> layer_12_expert_agg [style=solid]
	layer_12_expert_60 -> layer_12_expert_agg [style=solid]
	layer_12_expert_61 -> layer_12_expert_agg [style=solid]
	layer_12_expert_62 -> layer_12_expert_agg [style=solid]
	layer_12_expert_63 -> layer_12_expert_agg [style=solid]
	layer_12_expert_agg -> layer_12_moe [style=solid]
	layer_12_norm [label="GPU 384\nLayer Normalization\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_12_moe -> layer_12_norm [style=solid]
	layer_12_dp_comm [label="GPU 384\nData Parallel All-Reduce" shape=ellipse]
	layer_12_norm -> layer_12_dp_comm [style=solid]
	layer_12_dp_comm -> layer_13_attn [style=solid]
	layer_13_attn [label="GPU 384\nLayer 13 Self-Attention\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_13_attn_comm [label="GPU 384\nAttention Communication" shape=ellipse]
	layer_12_attn -> layer_13_attn_comm [style=solid]
	layer_13_attn_comm -> layer_13_attn [style=solid]
	layer_13_moe [label="GPU 384\nLayer 13 MoE Layer\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_13_attn -> layer_13_moe [style=solid]
	layer_13_gate [label="GPU 384\nExpert Gate (Top-2)\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, experts=2]" shape=parallelogram]
	layer_13_attn -> layer_13_gate [style=solid]
	layer_13_expert_0 [label="GPU 384\nExpert 0 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_0 [style=dashed]
	layer_13_expert_1 [label="GPU 384\nExpert 1 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_1 [style=dashed]
	layer_13_expert_2 [label="GPU 384\nExpert 2 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_2 [style=dashed]
	layer_13_expert_3 [label="GPU 384\nExpert 3 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_3 [style=dashed]
	layer_13_expert_4 [label="GPU 392\nExpert 4 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_4 [style=dashed]
	layer_13_expert_4_comm [label="GPU 392\nExpert Communication" shape=ellipse]
	layer_13_expert_4_comm -> layer_13_expert_4 [style=solid]
	layer_13_expert_5 [label="GPU 392\nExpert 5 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_5 [style=dashed]
	layer_13_expert_5_comm [label="GPU 392\nExpert Communication" shape=ellipse]
	layer_13_expert_5_comm -> layer_13_expert_5 [style=solid]
	layer_13_expert_6 [label="GPU 392\nExpert 6 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_6 [style=dashed]
	layer_13_expert_6_comm [label="GPU 392\nExpert Communication" shape=ellipse]
	layer_13_expert_6_comm -> layer_13_expert_6 [style=solid]
	layer_13_expert_7 [label="GPU 392\nExpert 7 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_7 [style=dashed]
	layer_13_expert_7_comm [label="GPU 392\nExpert Communication" shape=ellipse]
	layer_13_expert_7_comm -> layer_13_expert_7 [style=solid]
	layer_13_expert_8 [label="GPU 400\nExpert 8 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_8 [style=dashed]
	layer_13_expert_8_comm [label="GPU 400\nExpert Communication" shape=ellipse]
	layer_13_expert_8_comm -> layer_13_expert_8 [style=solid]
	layer_13_expert_9 [label="GPU 400\nExpert 9 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_9 [style=dashed]
	layer_13_expert_9_comm [label="GPU 400\nExpert Communication" shape=ellipse]
	layer_13_expert_9_comm -> layer_13_expert_9 [style=solid]
	layer_13_expert_10 [label="GPU 400\nExpert 10 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_10 [style=dashed]
	layer_13_expert_10_comm [label="GPU 400\nExpert Communication" shape=ellipse]
	layer_13_expert_10_comm -> layer_13_expert_10 [style=solid]
	layer_13_expert_11 [label="GPU 400\nExpert 11 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_11 [style=dashed]
	layer_13_expert_11_comm [label="GPU 400\nExpert Communication" shape=ellipse]
	layer_13_expert_11_comm -> layer_13_expert_11 [style=solid]
	layer_13_expert_12 [label="GPU 408\nExpert 12 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_12 [style=dashed]
	layer_13_expert_12_comm [label="GPU 408\nExpert Communication" shape=ellipse]
	layer_13_expert_12_comm -> layer_13_expert_12 [style=solid]
	layer_13_expert_13 [label="GPU 408\nExpert 13 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_13 [style=dashed]
	layer_13_expert_13_comm [label="GPU 408\nExpert Communication" shape=ellipse]
	layer_13_expert_13_comm -> layer_13_expert_13 [style=solid]
	layer_13_expert_14 [label="GPU 408\nExpert 14 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_14 [style=dashed]
	layer_13_expert_14_comm [label="GPU 408\nExpert Communication" shape=ellipse]
	layer_13_expert_14_comm -> layer_13_expert_14 [style=solid]
	layer_13_expert_15 [label="GPU 408\nExpert 15 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_15 [style=dashed]
	layer_13_expert_15_comm [label="GPU 408\nExpert Communication" shape=ellipse]
	layer_13_expert_15_comm -> layer_13_expert_15 [style=solid]
	layer_13_expert_16 [label="GPU 416\nExpert 16 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_16 [style=dashed]
	layer_13_expert_16_comm [label="GPU 416\nExpert Communication" shape=ellipse]
	layer_13_expert_16_comm -> layer_13_expert_16 [style=solid]
	layer_13_expert_17 [label="GPU 416\nExpert 17 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_17 [style=dashed]
	layer_13_expert_17_comm [label="GPU 416\nExpert Communication" shape=ellipse]
	layer_13_expert_17_comm -> layer_13_expert_17 [style=solid]
	layer_13_expert_18 [label="GPU 416\nExpert 18 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_18 [style=dashed]
	layer_13_expert_18_comm [label="GPU 416\nExpert Communication" shape=ellipse]
	layer_13_expert_18_comm -> layer_13_expert_18 [style=solid]
	layer_13_expert_19 [label="GPU 416\nExpert 19 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_19 [style=dashed]
	layer_13_expert_19_comm [label="GPU 416\nExpert Communication" shape=ellipse]
	layer_13_expert_19_comm -> layer_13_expert_19 [style=solid]
	layer_13_expert_20 [label="GPU 424\nExpert 20 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_20 [style=dashed]
	layer_13_expert_20_comm [label="GPU 424\nExpert Communication" shape=ellipse]
	layer_13_expert_20_comm -> layer_13_expert_20 [style=solid]
	layer_13_expert_21 [label="GPU 424\nExpert 21 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_21 [style=dashed]
	layer_13_expert_21_comm [label="GPU 424\nExpert Communication" shape=ellipse]
	layer_13_expert_21_comm -> layer_13_expert_21 [style=solid]
	layer_13_expert_22 [label="GPU 424\nExpert 22 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_22 [style=dashed]
	layer_13_expert_22_comm [label="GPU 424\nExpert Communication" shape=ellipse]
	layer_13_expert_22_comm -> layer_13_expert_22 [style=solid]
	layer_13_expert_23 [label="GPU 424\nExpert 23 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_23 [style=dashed]
	layer_13_expert_23_comm [label="GPU 424\nExpert Communication" shape=ellipse]
	layer_13_expert_23_comm -> layer_13_expert_23 [style=solid]
	layer_13_expert_24 [label="GPU 432\nExpert 24 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_24 [style=dashed]
	layer_13_expert_24_comm [label="GPU 432\nExpert Communication" shape=ellipse]
	layer_13_expert_24_comm -> layer_13_expert_24 [style=solid]
	layer_13_expert_25 [label="GPU 432\nExpert 25 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_25 [style=dashed]
	layer_13_expert_25_comm [label="GPU 432\nExpert Communication" shape=ellipse]
	layer_13_expert_25_comm -> layer_13_expert_25 [style=solid]
	layer_13_expert_26 [label="GPU 432\nExpert 26 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_26 [style=dashed]
	layer_13_expert_26_comm [label="GPU 432\nExpert Communication" shape=ellipse]
	layer_13_expert_26_comm -> layer_13_expert_26 [style=solid]
	layer_13_expert_27 [label="GPU 432\nExpert 27 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_27 [style=dashed]
	layer_13_expert_27_comm [label="GPU 432\nExpert Communication" shape=ellipse]
	layer_13_expert_27_comm -> layer_13_expert_27 [style=solid]
	layer_13_expert_28 [label="GPU 440\nExpert 28 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_28 [style=dashed]
	layer_13_expert_28_comm [label="GPU 440\nExpert Communication" shape=ellipse]
	layer_13_expert_28_comm -> layer_13_expert_28 [style=solid]
	layer_13_expert_29 [label="GPU 440\nExpert 29 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_29 [style=dashed]
	layer_13_expert_29_comm [label="GPU 440\nExpert Communication" shape=ellipse]
	layer_13_expert_29_comm -> layer_13_expert_29 [style=solid]
	layer_13_expert_30 [label="GPU 440\nExpert 30 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_30 [style=dashed]
	layer_13_expert_30_comm [label="GPU 440\nExpert Communication" shape=ellipse]
	layer_13_expert_30_comm -> layer_13_expert_30 [style=solid]
	layer_13_expert_31 [label="GPU 440\nExpert 31 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_31 [style=dashed]
	layer_13_expert_31_comm [label="GPU 440\nExpert Communication" shape=ellipse]
	layer_13_expert_31_comm -> layer_13_expert_31 [style=solid]
	layer_13_expert_32 [label="GPU 448\nExpert 32 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_32 [style=dashed]
	layer_13_expert_32_comm [label="GPU 448\nExpert Communication" shape=ellipse]
	layer_13_expert_32_comm -> layer_13_expert_32 [style=solid]
	layer_13_expert_33 [label="GPU 448\nExpert 33 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_33 [style=dashed]
	layer_13_expert_33_comm [label="GPU 448\nExpert Communication" shape=ellipse]
	layer_13_expert_33_comm -> layer_13_expert_33 [style=solid]
	layer_13_expert_34 [label="GPU 448\nExpert 34 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_34 [style=dashed]
	layer_13_expert_34_comm [label="GPU 448\nExpert Communication" shape=ellipse]
	layer_13_expert_34_comm -> layer_13_expert_34 [style=solid]
	layer_13_expert_35 [label="GPU 448\nExpert 35 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_35 [style=dashed]
	layer_13_expert_35_comm [label="GPU 448\nExpert Communication" shape=ellipse]
	layer_13_expert_35_comm -> layer_13_expert_35 [style=solid]
	layer_13_expert_36 [label="GPU 456\nExpert 36 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_36 [style=dashed]
	layer_13_expert_36_comm [label="GPU 456\nExpert Communication" shape=ellipse]
	layer_13_expert_36_comm -> layer_13_expert_36 [style=solid]
	layer_13_expert_37 [label="GPU 456\nExpert 37 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_37 [style=dashed]
	layer_13_expert_37_comm [label="GPU 456\nExpert Communication" shape=ellipse]
	layer_13_expert_37_comm -> layer_13_expert_37 [style=solid]
	layer_13_expert_38 [label="GPU 456\nExpert 38 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_38 [style=dashed]
	layer_13_expert_38_comm [label="GPU 456\nExpert Communication" shape=ellipse]
	layer_13_expert_38_comm -> layer_13_expert_38 [style=solid]
	layer_13_expert_39 [label="GPU 456\nExpert 39 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_39 [style=dashed]
	layer_13_expert_39_comm [label="GPU 456\nExpert Communication" shape=ellipse]
	layer_13_expert_39_comm -> layer_13_expert_39 [style=solid]
	layer_13_expert_40 [label="GPU 464\nExpert 40 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_40 [style=dashed]
	layer_13_expert_40_comm [label="GPU 464\nExpert Communication" shape=ellipse]
	layer_13_expert_40_comm -> layer_13_expert_40 [style=solid]
	layer_13_expert_41 [label="GPU 464\nExpert 41 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_41 [style=dashed]
	layer_13_expert_41_comm [label="GPU 464\nExpert Communication" shape=ellipse]
	layer_13_expert_41_comm -> layer_13_expert_41 [style=solid]
	layer_13_expert_42 [label="GPU 464\nExpert 42 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_42 [style=dashed]
	layer_13_expert_42_comm [label="GPU 464\nExpert Communication" shape=ellipse]
	layer_13_expert_42_comm -> layer_13_expert_42 [style=solid]
	layer_13_expert_43 [label="GPU 464\nExpert 43 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_43 [style=dashed]
	layer_13_expert_43_comm [label="GPU 464\nExpert Communication" shape=ellipse]
	layer_13_expert_43_comm -> layer_13_expert_43 [style=solid]
	layer_13_expert_44 [label="GPU 472\nExpert 44 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_44 [style=dashed]
	layer_13_expert_44_comm [label="GPU 472\nExpert Communication" shape=ellipse]
	layer_13_expert_44_comm -> layer_13_expert_44 [style=solid]
	layer_13_expert_45 [label="GPU 472\nExpert 45 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_45 [style=dashed]
	layer_13_expert_45_comm [label="GPU 472\nExpert Communication" shape=ellipse]
	layer_13_expert_45_comm -> layer_13_expert_45 [style=solid]
	layer_13_expert_46 [label="GPU 472\nExpert 46 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_46 [style=dashed]
	layer_13_expert_46_comm [label="GPU 472\nExpert Communication" shape=ellipse]
	layer_13_expert_46_comm -> layer_13_expert_46 [style=solid]
	layer_13_expert_47 [label="GPU 472\nExpert 47 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_47 [style=dashed]
	layer_13_expert_47_comm [label="GPU 472\nExpert Communication" shape=ellipse]
	layer_13_expert_47_comm -> layer_13_expert_47 [style=solid]
	layer_13_expert_48 [label="GPU 480\nExpert 48 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_48 [style=dashed]
	layer_13_expert_48_comm [label="GPU 480\nExpert Communication" shape=ellipse]
	layer_13_expert_48_comm -> layer_13_expert_48 [style=solid]
	layer_13_expert_49 [label="GPU 480\nExpert 49 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_49 [style=dashed]
	layer_13_expert_49_comm [label="GPU 480\nExpert Communication" shape=ellipse]
	layer_13_expert_49_comm -> layer_13_expert_49 [style=solid]
	layer_13_expert_50 [label="GPU 480\nExpert 50 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_50 [style=dashed]
	layer_13_expert_50_comm [label="GPU 480\nExpert Communication" shape=ellipse]
	layer_13_expert_50_comm -> layer_13_expert_50 [style=solid]
	layer_13_expert_51 [label="GPU 480\nExpert 51 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_51 [style=dashed]
	layer_13_expert_51_comm [label="GPU 480\nExpert Communication" shape=ellipse]
	layer_13_expert_51_comm -> layer_13_expert_51 [style=solid]
	layer_13_expert_52 [label="GPU 488\nExpert 52 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_52 [style=dashed]
	layer_13_expert_52_comm [label="GPU 488\nExpert Communication" shape=ellipse]
	layer_13_expert_52_comm -> layer_13_expert_52 [style=solid]
	layer_13_expert_53 [label="GPU 488\nExpert 53 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_53 [style=dashed]
	layer_13_expert_53_comm [label="GPU 488\nExpert Communication" shape=ellipse]
	layer_13_expert_53_comm -> layer_13_expert_53 [style=solid]
	layer_13_expert_54 [label="GPU 488\nExpert 54 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_54 [style=dashed]
	layer_13_expert_54_comm [label="GPU 488\nExpert Communication" shape=ellipse]
	layer_13_expert_54_comm -> layer_13_expert_54 [style=solid]
	layer_13_expert_55 [label="GPU 488\nExpert 55 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_55 [style=dashed]
	layer_13_expert_55_comm [label="GPU 488\nExpert Communication" shape=ellipse]
	layer_13_expert_55_comm -> layer_13_expert_55 [style=solid]
	layer_13_expert_56 [label="GPU 496\nExpert 56 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_56 [style=dashed]
	layer_13_expert_56_comm [label="GPU 496\nExpert Communication" shape=ellipse]
	layer_13_expert_56_comm -> layer_13_expert_56 [style=solid]
	layer_13_expert_57 [label="GPU 496\nExpert 57 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_57 [style=dashed]
	layer_13_expert_57_comm [label="GPU 496\nExpert Communication" shape=ellipse]
	layer_13_expert_57_comm -> layer_13_expert_57 [style=solid]
	layer_13_expert_58 [label="GPU 496\nExpert 58 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_58 [style=dashed]
	layer_13_expert_58_comm [label="GPU 496\nExpert Communication" shape=ellipse]
	layer_13_expert_58_comm -> layer_13_expert_58 [style=solid]
	layer_13_expert_59 [label="GPU 496\nExpert 59 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_59 [style=dashed]
	layer_13_expert_59_comm [label="GPU 496\nExpert Communication" shape=ellipse]
	layer_13_expert_59_comm -> layer_13_expert_59 [style=solid]
	layer_13_expert_60 [label="GPU 504\nExpert 60 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_60 [style=dashed]
	layer_13_expert_60_comm [label="GPU 504\nExpert Communication" shape=ellipse]
	layer_13_expert_60_comm -> layer_13_expert_60 [style=solid]
	layer_13_expert_61 [label="GPU 504\nExpert 61 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_61 [style=dashed]
	layer_13_expert_61_comm [label="GPU 504\nExpert Communication" shape=ellipse]
	layer_13_expert_61_comm -> layer_13_expert_61 [style=solid]
	layer_13_expert_62 [label="GPU 504\nExpert 62 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_62 [style=dashed]
	layer_13_expert_62_comm [label="GPU 504\nExpert Communication" shape=ellipse]
	layer_13_expert_62_comm -> layer_13_expert_62 [style=solid]
	layer_13_expert_63 [label="GPU 504\nExpert 63 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_13_gate -> layer_13_expert_63 [style=dashed]
	layer_13_expert_63_comm [label="GPU 504\nExpert Communication" shape=ellipse]
	layer_13_expert_63_comm -> layer_13_expert_63 [style=solid]
	layer_13_expert_agg [label="GPU 384\nExpert Aggregation (Weighted Sum)\nInput: [batch_size=16, seq_len=10240, experts=64, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=parallelogram]
	layer_13_expert_0 -> layer_13_expert_agg [style=solid]
	layer_13_expert_1 -> layer_13_expert_agg [style=solid]
	layer_13_expert_2 -> layer_13_expert_agg [style=solid]
	layer_13_expert_3 -> layer_13_expert_agg [style=solid]
	layer_13_expert_4 -> layer_13_expert_agg [style=solid]
	layer_13_expert_5 -> layer_13_expert_agg [style=solid]
	layer_13_expert_6 -> layer_13_expert_agg [style=solid]
	layer_13_expert_7 -> layer_13_expert_agg [style=solid]
	layer_13_expert_8 -> layer_13_expert_agg [style=solid]
	layer_13_expert_9 -> layer_13_expert_agg [style=solid]
	layer_13_expert_10 -> layer_13_expert_agg [style=solid]
	layer_13_expert_11 -> layer_13_expert_agg [style=solid]
	layer_13_expert_12 -> layer_13_expert_agg [style=solid]
	layer_13_expert_13 -> layer_13_expert_agg [style=solid]
	layer_13_expert_14 -> layer_13_expert_agg [style=solid]
	layer_13_expert_15 -> layer_13_expert_agg [style=solid]
	layer_13_expert_16 -> layer_13_expert_agg [style=solid]
	layer_13_expert_17 -> layer_13_expert_agg [style=solid]
	layer_13_expert_18 -> layer_13_expert_agg [style=solid]
	layer_13_expert_19 -> layer_13_expert_agg [style=solid]
	layer_13_expert_20 -> layer_13_expert_agg [style=solid]
	layer_13_expert_21 -> layer_13_expert_agg [style=solid]
	layer_13_expert_22 -> layer_13_expert_agg [style=solid]
	layer_13_expert_23 -> layer_13_expert_agg [style=solid]
	layer_13_expert_24 -> layer_13_expert_agg [style=solid]
	layer_13_expert_25 -> layer_13_expert_agg [style=solid]
	layer_13_expert_26 -> layer_13_expert_agg [style=solid]
	layer_13_expert_27 -> layer_13_expert_agg [style=solid]
	layer_13_expert_28 -> layer_13_expert_agg [style=solid]
	layer_13_expert_29 -> layer_13_expert_agg [style=solid]
	layer_13_expert_30 -> layer_13_expert_agg [style=solid]
	layer_13_expert_31 -> layer_13_expert_agg [style=solid]
	layer_13_expert_32 -> layer_13_expert_agg [style=solid]
	layer_13_expert_33 -> layer_13_expert_agg [style=solid]
	layer_13_expert_34 -> layer_13_expert_agg [style=solid]
	layer_13_expert_35 -> layer_13_expert_agg [style=solid]
	layer_13_expert_36 -> layer_13_expert_agg [style=solid]
	layer_13_expert_37 -> layer_13_expert_agg [style=solid]
	layer_13_expert_38 -> layer_13_expert_agg [style=solid]
	layer_13_expert_39 -> layer_13_expert_agg [style=solid]
	layer_13_expert_40 -> layer_13_expert_agg [style=solid]
	layer_13_expert_41 -> layer_13_expert_agg [style=solid]
	layer_13_expert_42 -> layer_13_expert_agg [style=solid]
	layer_13_expert_43 -> layer_13_expert_agg [style=solid]
	layer_13_expert_44 -> layer_13_expert_agg [style=solid]
	layer_13_expert_45 -> layer_13_expert_agg [style=solid]
	layer_13_expert_46 -> layer_13_expert_agg [style=solid]
	layer_13_expert_47 -> layer_13_expert_agg [style=solid]
	layer_13_expert_48 -> layer_13_expert_agg [style=solid]
	layer_13_expert_49 -> layer_13_expert_agg [style=solid]
	layer_13_expert_50 -> layer_13_expert_agg [style=solid]
	layer_13_expert_51 -> layer_13_expert_agg [style=solid]
	layer_13_expert_52 -> layer_13_expert_agg [style=solid]
	layer_13_expert_53 -> layer_13_expert_agg [style=solid]
	layer_13_expert_54 -> layer_13_expert_agg [style=solid]
	layer_13_expert_55 -> layer_13_expert_agg [style=solid]
	layer_13_expert_56 -> layer_13_expert_agg [style=solid]
	layer_13_expert_57 -> layer_13_expert_agg [style=solid]
	layer_13_expert_58 -> layer_13_expert_agg [style=solid]
	layer_13_expert_59 -> layer_13_expert_agg [style=solid]
	layer_13_expert_60 -> layer_13_expert_agg [style=solid]
	layer_13_expert_61 -> layer_13_expert_agg [style=solid]
	layer_13_expert_62 -> layer_13_expert_agg [style=solid]
	layer_13_expert_63 -> layer_13_expert_agg [style=solid]
	layer_13_expert_agg -> layer_13_moe [style=solid]
	layer_13_norm [label="GPU 384\nLayer Normalization\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_13_moe -> layer_13_norm [style=solid]
	layer_13_dp_comm [label="GPU 384\nData Parallel All-Reduce" shape=ellipse]
	layer_13_norm -> layer_13_dp_comm [style=solid]
	layer_13_dp_comm -> layer_14_attn [style=solid]
	layer_14_attn [label="GPU 384\nLayer 14 Self-Attention\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_14_attn_comm [label="GPU 384\nAttention Communication" shape=ellipse]
	layer_13_attn -> layer_14_attn_comm [style=solid]
	layer_14_attn_comm -> layer_14_attn [style=solid]
	layer_14_moe [label="GPU 384\nLayer 14 MoE Layer\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_14_attn -> layer_14_moe [style=solid]
	layer_14_gate [label="GPU 384\nExpert Gate (Top-2)\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, experts=2]" shape=parallelogram]
	layer_14_attn -> layer_14_gate [style=solid]
	layer_14_expert_0 [label="GPU 384\nExpert 0 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_0 [style=dashed]
	layer_14_expert_1 [label="GPU 384\nExpert 1 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_1 [style=dashed]
	layer_14_expert_2 [label="GPU 384\nExpert 2 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_2 [style=dashed]
	layer_14_expert_3 [label="GPU 384\nExpert 3 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_3 [style=dashed]
	layer_14_expert_4 [label="GPU 392\nExpert 4 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_4 [style=dashed]
	layer_14_expert_4_comm [label="GPU 392\nExpert Communication" shape=ellipse]
	layer_14_expert_4_comm -> layer_14_expert_4 [style=solid]
	layer_14_expert_5 [label="GPU 392\nExpert 5 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_5 [style=dashed]
	layer_14_expert_5_comm [label="GPU 392\nExpert Communication" shape=ellipse]
	layer_14_expert_5_comm -> layer_14_expert_5 [style=solid]
	layer_14_expert_6 [label="GPU 392\nExpert 6 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_6 [style=dashed]
	layer_14_expert_6_comm [label="GPU 392\nExpert Communication" shape=ellipse]
	layer_14_expert_6_comm -> layer_14_expert_6 [style=solid]
	layer_14_expert_7 [label="GPU 392\nExpert 7 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_7 [style=dashed]
	layer_14_expert_7_comm [label="GPU 392\nExpert Communication" shape=ellipse]
	layer_14_expert_7_comm -> layer_14_expert_7 [style=solid]
	layer_14_expert_8 [label="GPU 400\nExpert 8 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_8 [style=dashed]
	layer_14_expert_8_comm [label="GPU 400\nExpert Communication" shape=ellipse]
	layer_14_expert_8_comm -> layer_14_expert_8 [style=solid]
	layer_14_expert_9 [label="GPU 400\nExpert 9 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_9 [style=dashed]
	layer_14_expert_9_comm [label="GPU 400\nExpert Communication" shape=ellipse]
	layer_14_expert_9_comm -> layer_14_expert_9 [style=solid]
	layer_14_expert_10 [label="GPU 400\nExpert 10 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_10 [style=dashed]
	layer_14_expert_10_comm [label="GPU 400\nExpert Communication" shape=ellipse]
	layer_14_expert_10_comm -> layer_14_expert_10 [style=solid]
	layer_14_expert_11 [label="GPU 400\nExpert 11 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_11 [style=dashed]
	layer_14_expert_11_comm [label="GPU 400\nExpert Communication" shape=ellipse]
	layer_14_expert_11_comm -> layer_14_expert_11 [style=solid]
	layer_14_expert_12 [label="GPU 408\nExpert 12 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_12 [style=dashed]
	layer_14_expert_12_comm [label="GPU 408\nExpert Communication" shape=ellipse]
	layer_14_expert_12_comm -> layer_14_expert_12 [style=solid]
	layer_14_expert_13 [label="GPU 408\nExpert 13 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_13 [style=dashed]
	layer_14_expert_13_comm [label="GPU 408\nExpert Communication" shape=ellipse]
	layer_14_expert_13_comm -> layer_14_expert_13 [style=solid]
	layer_14_expert_14 [label="GPU 408\nExpert 14 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_14 [style=dashed]
	layer_14_expert_14_comm [label="GPU 408\nExpert Communication" shape=ellipse]
	layer_14_expert_14_comm -> layer_14_expert_14 [style=solid]
	layer_14_expert_15 [label="GPU 408\nExpert 15 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_15 [style=dashed]
	layer_14_expert_15_comm [label="GPU 408\nExpert Communication" shape=ellipse]
	layer_14_expert_15_comm -> layer_14_expert_15 [style=solid]
	layer_14_expert_16 [label="GPU 416\nExpert 16 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_16 [style=dashed]
	layer_14_expert_16_comm [label="GPU 416\nExpert Communication" shape=ellipse]
	layer_14_expert_16_comm -> layer_14_expert_16 [style=solid]
	layer_14_expert_17 [label="GPU 416\nExpert 17 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_17 [style=dashed]
	layer_14_expert_17_comm [label="GPU 416\nExpert Communication" shape=ellipse]
	layer_14_expert_17_comm -> layer_14_expert_17 [style=solid]
	layer_14_expert_18 [label="GPU 416\nExpert 18 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_18 [style=dashed]
	layer_14_expert_18_comm [label="GPU 416\nExpert Communication" shape=ellipse]
	layer_14_expert_18_comm -> layer_14_expert_18 [style=solid]
	layer_14_expert_19 [label="GPU 416\nExpert 19 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_19 [style=dashed]
	layer_14_expert_19_comm [label="GPU 416\nExpert Communication" shape=ellipse]
	layer_14_expert_19_comm -> layer_14_expert_19 [style=solid]
	layer_14_expert_20 [label="GPU 424\nExpert 20 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_20 [style=dashed]
	layer_14_expert_20_comm [label="GPU 424\nExpert Communication" shape=ellipse]
	layer_14_expert_20_comm -> layer_14_expert_20 [style=solid]
	layer_14_expert_21 [label="GPU 424\nExpert 21 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_21 [style=dashed]
	layer_14_expert_21_comm [label="GPU 424\nExpert Communication" shape=ellipse]
	layer_14_expert_21_comm -> layer_14_expert_21 [style=solid]
	layer_14_expert_22 [label="GPU 424\nExpert 22 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_22 [style=dashed]
	layer_14_expert_22_comm [label="GPU 424\nExpert Communication" shape=ellipse]
	layer_14_expert_22_comm -> layer_14_expert_22 [style=solid]
	layer_14_expert_23 [label="GPU 424\nExpert 23 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_23 [style=dashed]
	layer_14_expert_23_comm [label="GPU 424\nExpert Communication" shape=ellipse]
	layer_14_expert_23_comm -> layer_14_expert_23 [style=solid]
	layer_14_expert_24 [label="GPU 432\nExpert 24 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_24 [style=dashed]
	layer_14_expert_24_comm [label="GPU 432\nExpert Communication" shape=ellipse]
	layer_14_expert_24_comm -> layer_14_expert_24 [style=solid]
	layer_14_expert_25 [label="GPU 432\nExpert 25 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_25 [style=dashed]
	layer_14_expert_25_comm [label="GPU 432\nExpert Communication" shape=ellipse]
	layer_14_expert_25_comm -> layer_14_expert_25 [style=solid]
	layer_14_expert_26 [label="GPU 432\nExpert 26 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_26 [style=dashed]
	layer_14_expert_26_comm [label="GPU 432\nExpert Communication" shape=ellipse]
	layer_14_expert_26_comm -> layer_14_expert_26 [style=solid]
	layer_14_expert_27 [label="GPU 432\nExpert 27 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_27 [style=dashed]
	layer_14_expert_27_comm [label="GPU 432\nExpert Communication" shape=ellipse]
	layer_14_expert_27_comm -> layer_14_expert_27 [style=solid]
	layer_14_expert_28 [label="GPU 440\nExpert 28 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_28 [style=dashed]
	layer_14_expert_28_comm [label="GPU 440\nExpert Communication" shape=ellipse]
	layer_14_expert_28_comm -> layer_14_expert_28 [style=solid]
	layer_14_expert_29 [label="GPU 440\nExpert 29 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_29 [style=dashed]
	layer_14_expert_29_comm [label="GPU 440\nExpert Communication" shape=ellipse]
	layer_14_expert_29_comm -> layer_14_expert_29 [style=solid]
	layer_14_expert_30 [label="GPU 440\nExpert 30 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_30 [style=dashed]
	layer_14_expert_30_comm [label="GPU 440\nExpert Communication" shape=ellipse]
	layer_14_expert_30_comm -> layer_14_expert_30 [style=solid]
	layer_14_expert_31 [label="GPU 440\nExpert 31 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_31 [style=dashed]
	layer_14_expert_31_comm [label="GPU 440\nExpert Communication" shape=ellipse]
	layer_14_expert_31_comm -> layer_14_expert_31 [style=solid]
	layer_14_expert_32 [label="GPU 448\nExpert 32 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_32 [style=dashed]
	layer_14_expert_32_comm [label="GPU 448\nExpert Communication" shape=ellipse]
	layer_14_expert_32_comm -> layer_14_expert_32 [style=solid]
	layer_14_expert_33 [label="GPU 448\nExpert 33 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_33 [style=dashed]
	layer_14_expert_33_comm [label="GPU 448\nExpert Communication" shape=ellipse]
	layer_14_expert_33_comm -> layer_14_expert_33 [style=solid]
	layer_14_expert_34 [label="GPU 448\nExpert 34 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_34 [style=dashed]
	layer_14_expert_34_comm [label="GPU 448\nExpert Communication" shape=ellipse]
	layer_14_expert_34_comm -> layer_14_expert_34 [style=solid]
	layer_14_expert_35 [label="GPU 448\nExpert 35 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_35 [style=dashed]
	layer_14_expert_35_comm [label="GPU 448\nExpert Communication" shape=ellipse]
	layer_14_expert_35_comm -> layer_14_expert_35 [style=solid]
	layer_14_expert_36 [label="GPU 456\nExpert 36 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_36 [style=dashed]
	layer_14_expert_36_comm [label="GPU 456\nExpert Communication" shape=ellipse]
	layer_14_expert_36_comm -> layer_14_expert_36 [style=solid]
	layer_14_expert_37 [label="GPU 456\nExpert 37 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_37 [style=dashed]
	layer_14_expert_37_comm [label="GPU 456\nExpert Communication" shape=ellipse]
	layer_14_expert_37_comm -> layer_14_expert_37 [style=solid]
	layer_14_expert_38 [label="GPU 456\nExpert 38 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_38 [style=dashed]
	layer_14_expert_38_comm [label="GPU 456\nExpert Communication" shape=ellipse]
	layer_14_expert_38_comm -> layer_14_expert_38 [style=solid]
	layer_14_expert_39 [label="GPU 456\nExpert 39 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_39 [style=dashed]
	layer_14_expert_39_comm [label="GPU 456\nExpert Communication" shape=ellipse]
	layer_14_expert_39_comm -> layer_14_expert_39 [style=solid]
	layer_14_expert_40 [label="GPU 464\nExpert 40 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_40 [style=dashed]
	layer_14_expert_40_comm [label="GPU 464\nExpert Communication" shape=ellipse]
	layer_14_expert_40_comm -> layer_14_expert_40 [style=solid]
	layer_14_expert_41 [label="GPU 464\nExpert 41 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_41 [style=dashed]
	layer_14_expert_41_comm [label="GPU 464\nExpert Communication" shape=ellipse]
	layer_14_expert_41_comm -> layer_14_expert_41 [style=solid]
	layer_14_expert_42 [label="GPU 464\nExpert 42 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_42 [style=dashed]
	layer_14_expert_42_comm [label="GPU 464\nExpert Communication" shape=ellipse]
	layer_14_expert_42_comm -> layer_14_expert_42 [style=solid]
	layer_14_expert_43 [label="GPU 464\nExpert 43 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_43 [style=dashed]
	layer_14_expert_43_comm [label="GPU 464\nExpert Communication" shape=ellipse]
	layer_14_expert_43_comm -> layer_14_expert_43 [style=solid]
	layer_14_expert_44 [label="GPU 472\nExpert 44 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_44 [style=dashed]
	layer_14_expert_44_comm [label="GPU 472\nExpert Communication" shape=ellipse]
	layer_14_expert_44_comm -> layer_14_expert_44 [style=solid]
	layer_14_expert_45 [label="GPU 472\nExpert 45 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_45 [style=dashed]
	layer_14_expert_45_comm [label="GPU 472\nExpert Communication" shape=ellipse]
	layer_14_expert_45_comm -> layer_14_expert_45 [style=solid]
	layer_14_expert_46 [label="GPU 472\nExpert 46 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_46 [style=dashed]
	layer_14_expert_46_comm [label="GPU 472\nExpert Communication" shape=ellipse]
	layer_14_expert_46_comm -> layer_14_expert_46 [style=solid]
	layer_14_expert_47 [label="GPU 472\nExpert 47 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_47 [style=dashed]
	layer_14_expert_47_comm [label="GPU 472\nExpert Communication" shape=ellipse]
	layer_14_expert_47_comm -> layer_14_expert_47 [style=solid]
	layer_14_expert_48 [label="GPU 480\nExpert 48 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_48 [style=dashed]
	layer_14_expert_48_comm [label="GPU 480\nExpert Communication" shape=ellipse]
	layer_14_expert_48_comm -> layer_14_expert_48 [style=solid]
	layer_14_expert_49 [label="GPU 480\nExpert 49 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_49 [style=dashed]
	layer_14_expert_49_comm [label="GPU 480\nExpert Communication" shape=ellipse]
	layer_14_expert_49_comm -> layer_14_expert_49 [style=solid]
	layer_14_expert_50 [label="GPU 480\nExpert 50 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_50 [style=dashed]
	layer_14_expert_50_comm [label="GPU 480\nExpert Communication" shape=ellipse]
	layer_14_expert_50_comm -> layer_14_expert_50 [style=solid]
	layer_14_expert_51 [label="GPU 480\nExpert 51 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_51 [style=dashed]
	layer_14_expert_51_comm [label="GPU 480\nExpert Communication" shape=ellipse]
	layer_14_expert_51_comm -> layer_14_expert_51 [style=solid]
	layer_14_expert_52 [label="GPU 488\nExpert 52 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_52 [style=dashed]
	layer_14_expert_52_comm [label="GPU 488\nExpert Communication" shape=ellipse]
	layer_14_expert_52_comm -> layer_14_expert_52 [style=solid]
	layer_14_expert_53 [label="GPU 488\nExpert 53 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_53 [style=dashed]
	layer_14_expert_53_comm [label="GPU 488\nExpert Communication" shape=ellipse]
	layer_14_expert_53_comm -> layer_14_expert_53 [style=solid]
	layer_14_expert_54 [label="GPU 488\nExpert 54 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_54 [style=dashed]
	layer_14_expert_54_comm [label="GPU 488\nExpert Communication" shape=ellipse]
	layer_14_expert_54_comm -> layer_14_expert_54 [style=solid]
	layer_14_expert_55 [label="GPU 488\nExpert 55 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_55 [style=dashed]
	layer_14_expert_55_comm [label="GPU 488\nExpert Communication" shape=ellipse]
	layer_14_expert_55_comm -> layer_14_expert_55 [style=solid]
	layer_14_expert_56 [label="GPU 496\nExpert 56 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_56 [style=dashed]
	layer_14_expert_56_comm [label="GPU 496\nExpert Communication" shape=ellipse]
	layer_14_expert_56_comm -> layer_14_expert_56 [style=solid]
	layer_14_expert_57 [label="GPU 496\nExpert 57 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_57 [style=dashed]
	layer_14_expert_57_comm [label="GPU 496\nExpert Communication" shape=ellipse]
	layer_14_expert_57_comm -> layer_14_expert_57 [style=solid]
	layer_14_expert_58 [label="GPU 496\nExpert 58 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_58 [style=dashed]
	layer_14_expert_58_comm [label="GPU 496\nExpert Communication" shape=ellipse]
	layer_14_expert_58_comm -> layer_14_expert_58 [style=solid]
	layer_14_expert_59 [label="GPU 496\nExpert 59 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_59 [style=dashed]
	layer_14_expert_59_comm [label="GPU 496\nExpert Communication" shape=ellipse]
	layer_14_expert_59_comm -> layer_14_expert_59 [style=solid]
	layer_14_expert_60 [label="GPU 504\nExpert 60 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_60 [style=dashed]
	layer_14_expert_60_comm [label="GPU 504\nExpert Communication" shape=ellipse]
	layer_14_expert_60_comm -> layer_14_expert_60 [style=solid]
	layer_14_expert_61 [label="GPU 504\nExpert 61 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_61 [style=dashed]
	layer_14_expert_61_comm [label="GPU 504\nExpert Communication" shape=ellipse]
	layer_14_expert_61_comm -> layer_14_expert_61 [style=solid]
	layer_14_expert_62 [label="GPU 504\nExpert 62 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_62 [style=dashed]
	layer_14_expert_62_comm [label="GPU 504\nExpert Communication" shape=ellipse]
	layer_14_expert_62_comm -> layer_14_expert_62 [style=solid]
	layer_14_expert_63 [label="GPU 504\nExpert 63 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_14_gate -> layer_14_expert_63 [style=dashed]
	layer_14_expert_63_comm [label="GPU 504\nExpert Communication" shape=ellipse]
	layer_14_expert_63_comm -> layer_14_expert_63 [style=solid]
	layer_14_expert_agg [label="GPU 384\nExpert Aggregation (Weighted Sum)\nInput: [batch_size=16, seq_len=10240, experts=64, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=parallelogram]
	layer_14_expert_0 -> layer_14_expert_agg [style=solid]
	layer_14_expert_1 -> layer_14_expert_agg [style=solid]
	layer_14_expert_2 -> layer_14_expert_agg [style=solid]
	layer_14_expert_3 -> layer_14_expert_agg [style=solid]
	layer_14_expert_4 -> layer_14_expert_agg [style=solid]
	layer_14_expert_5 -> layer_14_expert_agg [style=solid]
	layer_14_expert_6 -> layer_14_expert_agg [style=solid]
	layer_14_expert_7 -> layer_14_expert_agg [style=solid]
	layer_14_expert_8 -> layer_14_expert_agg [style=solid]
	layer_14_expert_9 -> layer_14_expert_agg [style=solid]
	layer_14_expert_10 -> layer_14_expert_agg [style=solid]
	layer_14_expert_11 -> layer_14_expert_agg [style=solid]
	layer_14_expert_12 -> layer_14_expert_agg [style=solid]
	layer_14_expert_13 -> layer_14_expert_agg [style=solid]
	layer_14_expert_14 -> layer_14_expert_agg [style=solid]
	layer_14_expert_15 -> layer_14_expert_agg [style=solid]
	layer_14_expert_16 -> layer_14_expert_agg [style=solid]
	layer_14_expert_17 -> layer_14_expert_agg [style=solid]
	layer_14_expert_18 -> layer_14_expert_agg [style=solid]
	layer_14_expert_19 -> layer_14_expert_agg [style=solid]
	layer_14_expert_20 -> layer_14_expert_agg [style=solid]
	layer_14_expert_21 -> layer_14_expert_agg [style=solid]
	layer_14_expert_22 -> layer_14_expert_agg [style=solid]
	layer_14_expert_23 -> layer_14_expert_agg [style=solid]
	layer_14_expert_24 -> layer_14_expert_agg [style=solid]
	layer_14_expert_25 -> layer_14_expert_agg [style=solid]
	layer_14_expert_26 -> layer_14_expert_agg [style=solid]
	layer_14_expert_27 -> layer_14_expert_agg [style=solid]
	layer_14_expert_28 -> layer_14_expert_agg [style=solid]
	layer_14_expert_29 -> layer_14_expert_agg [style=solid]
	layer_14_expert_30 -> layer_14_expert_agg [style=solid]
	layer_14_expert_31 -> layer_14_expert_agg [style=solid]
	layer_14_expert_32 -> layer_14_expert_agg [style=solid]
	layer_14_expert_33 -> layer_14_expert_agg [style=solid]
	layer_14_expert_34 -> layer_14_expert_agg [style=solid]
	layer_14_expert_35 -> layer_14_expert_agg [style=solid]
	layer_14_expert_36 -> layer_14_expert_agg [style=solid]
	layer_14_expert_37 -> layer_14_expert_agg [style=solid]
	layer_14_expert_38 -> layer_14_expert_agg [style=solid]
	layer_14_expert_39 -> layer_14_expert_agg [style=solid]
	layer_14_expert_40 -> layer_14_expert_agg [style=solid]
	layer_14_expert_41 -> layer_14_expert_agg [style=solid]
	layer_14_expert_42 -> layer_14_expert_agg [style=solid]
	layer_14_expert_43 -> layer_14_expert_agg [style=solid]
	layer_14_expert_44 -> layer_14_expert_agg [style=solid]
	layer_14_expert_45 -> layer_14_expert_agg [style=solid]
	layer_14_expert_46 -> layer_14_expert_agg [style=solid]
	layer_14_expert_47 -> layer_14_expert_agg [style=solid]
	layer_14_expert_48 -> layer_14_expert_agg [style=solid]
	layer_14_expert_49 -> layer_14_expert_agg [style=solid]
	layer_14_expert_50 -> layer_14_expert_agg [style=solid]
	layer_14_expert_51 -> layer_14_expert_agg [style=solid]
	layer_14_expert_52 -> layer_14_expert_agg [style=solid]
	layer_14_expert_53 -> layer_14_expert_agg [style=solid]
	layer_14_expert_54 -> layer_14_expert_agg [style=solid]
	layer_14_expert_55 -> layer_14_expert_agg [style=solid]
	layer_14_expert_56 -> layer_14_expert_agg [style=solid]
	layer_14_expert_57 -> layer_14_expert_agg [style=solid]
	layer_14_expert_58 -> layer_14_expert_agg [style=solid]
	layer_14_expert_59 -> layer_14_expert_agg [style=solid]
	layer_14_expert_60 -> layer_14_expert_agg [style=solid]
	layer_14_expert_61 -> layer_14_expert_agg [style=solid]
	layer_14_expert_62 -> layer_14_expert_agg [style=solid]
	layer_14_expert_63 -> layer_14_expert_agg [style=solid]
	layer_14_expert_agg -> layer_14_moe [style=solid]
	layer_14_norm [label="GPU 384\nLayer Normalization\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_14_moe -> layer_14_norm [style=solid]
	layer_14_dp_comm [label="GPU 384\nData Parallel All-Reduce" shape=ellipse]
	layer_14_norm -> layer_14_dp_comm [style=solid]
	layer_14_dp_comm -> layer_15_attn [style=solid]
	layer_15_attn [label="GPU 384\nLayer 15 Self-Attention\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_15_attn_comm [label="GPU 384\nAttention Communication" shape=ellipse]
	layer_14_attn -> layer_15_attn_comm [style=solid]
	layer_15_attn_comm -> layer_15_attn [style=solid]
	layer_15_moe [label="GPU 384\nLayer 15 MoE Layer\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_15_attn -> layer_15_moe [style=solid]
	layer_15_gate [label="GPU 384\nExpert Gate (Top-2)\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, experts=2]" shape=parallelogram]
	layer_15_attn -> layer_15_gate [style=solid]
	layer_15_expert_0 [label="GPU 384\nExpert 0 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_0 [style=dashed]
	layer_15_expert_1 [label="GPU 384\nExpert 1 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_1 [style=dashed]
	layer_15_expert_2 [label="GPU 384\nExpert 2 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_2 [style=dashed]
	layer_15_expert_3 [label="GPU 384\nExpert 3 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_3 [style=dashed]
	layer_15_expert_4 [label="GPU 392\nExpert 4 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_4 [style=dashed]
	layer_15_expert_4_comm [label="GPU 392\nExpert Communication" shape=ellipse]
	layer_15_expert_4_comm -> layer_15_expert_4 [style=solid]
	layer_15_expert_5 [label="GPU 392\nExpert 5 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_5 [style=dashed]
	layer_15_expert_5_comm [label="GPU 392\nExpert Communication" shape=ellipse]
	layer_15_expert_5_comm -> layer_15_expert_5 [style=solid]
	layer_15_expert_6 [label="GPU 392\nExpert 6 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_6 [style=dashed]
	layer_15_expert_6_comm [label="GPU 392\nExpert Communication" shape=ellipse]
	layer_15_expert_6_comm -> layer_15_expert_6 [style=solid]
	layer_15_expert_7 [label="GPU 392\nExpert 7 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_7 [style=dashed]
	layer_15_expert_7_comm [label="GPU 392\nExpert Communication" shape=ellipse]
	layer_15_expert_7_comm -> layer_15_expert_7 [style=solid]
	layer_15_expert_8 [label="GPU 400\nExpert 8 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_8 [style=dashed]
	layer_15_expert_8_comm [label="GPU 400\nExpert Communication" shape=ellipse]
	layer_15_expert_8_comm -> layer_15_expert_8 [style=solid]
	layer_15_expert_9 [label="GPU 400\nExpert 9 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_9 [style=dashed]
	layer_15_expert_9_comm [label="GPU 400\nExpert Communication" shape=ellipse]
	layer_15_expert_9_comm -> layer_15_expert_9 [style=solid]
	layer_15_expert_10 [label="GPU 400\nExpert 10 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_10 [style=dashed]
	layer_15_expert_10_comm [label="GPU 400\nExpert Communication" shape=ellipse]
	layer_15_expert_10_comm -> layer_15_expert_10 [style=solid]
	layer_15_expert_11 [label="GPU 400\nExpert 11 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_11 [style=dashed]
	layer_15_expert_11_comm [label="GPU 400\nExpert Communication" shape=ellipse]
	layer_15_expert_11_comm -> layer_15_expert_11 [style=solid]
	layer_15_expert_12 [label="GPU 408\nExpert 12 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_12 [style=dashed]
	layer_15_expert_12_comm [label="GPU 408\nExpert Communication" shape=ellipse]
	layer_15_expert_12_comm -> layer_15_expert_12 [style=solid]
	layer_15_expert_13 [label="GPU 408\nExpert 13 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_13 [style=dashed]
	layer_15_expert_13_comm [label="GPU 408\nExpert Communication" shape=ellipse]
	layer_15_expert_13_comm -> layer_15_expert_13 [style=solid]
	layer_15_expert_14 [label="GPU 408\nExpert 14 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_14 [style=dashed]
	layer_15_expert_14_comm [label="GPU 408\nExpert Communication" shape=ellipse]
	layer_15_expert_14_comm -> layer_15_expert_14 [style=solid]
	layer_15_expert_15 [label="GPU 408\nExpert 15 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_15 [style=dashed]
	layer_15_expert_15_comm [label="GPU 408\nExpert Communication" shape=ellipse]
	layer_15_expert_15_comm -> layer_15_expert_15 [style=solid]
	layer_15_expert_16 [label="GPU 416\nExpert 16 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_16 [style=dashed]
	layer_15_expert_16_comm [label="GPU 416\nExpert Communication" shape=ellipse]
	layer_15_expert_16_comm -> layer_15_expert_16 [style=solid]
	layer_15_expert_17 [label="GPU 416\nExpert 17 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_17 [style=dashed]
	layer_15_expert_17_comm [label="GPU 416\nExpert Communication" shape=ellipse]
	layer_15_expert_17_comm -> layer_15_expert_17 [style=solid]
	layer_15_expert_18 [label="GPU 416\nExpert 18 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_18 [style=dashed]
	layer_15_expert_18_comm [label="GPU 416\nExpert Communication" shape=ellipse]
	layer_15_expert_18_comm -> layer_15_expert_18 [style=solid]
	layer_15_expert_19 [label="GPU 416\nExpert 19 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_19 [style=dashed]
	layer_15_expert_19_comm [label="GPU 416\nExpert Communication" shape=ellipse]
	layer_15_expert_19_comm -> layer_15_expert_19 [style=solid]
	layer_15_expert_20 [label="GPU 424\nExpert 20 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_20 [style=dashed]
	layer_15_expert_20_comm [label="GPU 424\nExpert Communication" shape=ellipse]
	layer_15_expert_20_comm -> layer_15_expert_20 [style=solid]
	layer_15_expert_21 [label="GPU 424\nExpert 21 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_21 [style=dashed]
	layer_15_expert_21_comm [label="GPU 424\nExpert Communication" shape=ellipse]
	layer_15_expert_21_comm -> layer_15_expert_21 [style=solid]
	layer_15_expert_22 [label="GPU 424\nExpert 22 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_22 [style=dashed]
	layer_15_expert_22_comm [label="GPU 424\nExpert Communication" shape=ellipse]
	layer_15_expert_22_comm -> layer_15_expert_22 [style=solid]
	layer_15_expert_23 [label="GPU 424\nExpert 23 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_23 [style=dashed]
	layer_15_expert_23_comm [label="GPU 424\nExpert Communication" shape=ellipse]
	layer_15_expert_23_comm -> layer_15_expert_23 [style=solid]
	layer_15_expert_24 [label="GPU 432\nExpert 24 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_24 [style=dashed]
	layer_15_expert_24_comm [label="GPU 432\nExpert Communication" shape=ellipse]
	layer_15_expert_24_comm -> layer_15_expert_24 [style=solid]
	layer_15_expert_25 [label="GPU 432\nExpert 25 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_25 [style=dashed]
	layer_15_expert_25_comm [label="GPU 432\nExpert Communication" shape=ellipse]
	layer_15_expert_25_comm -> layer_15_expert_25 [style=solid]
	layer_15_expert_26 [label="GPU 432\nExpert 26 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_26 [style=dashed]
	layer_15_expert_26_comm [label="GPU 432\nExpert Communication" shape=ellipse]
	layer_15_expert_26_comm -> layer_15_expert_26 [style=solid]
	layer_15_expert_27 [label="GPU 432\nExpert 27 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_27 [style=dashed]
	layer_15_expert_27_comm [label="GPU 432\nExpert Communication" shape=ellipse]
	layer_15_expert_27_comm -> layer_15_expert_27 [style=solid]
	layer_15_expert_28 [label="GPU 440\nExpert 28 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_28 [style=dashed]
	layer_15_expert_28_comm [label="GPU 440\nExpert Communication" shape=ellipse]
	layer_15_expert_28_comm -> layer_15_expert_28 [style=solid]
	layer_15_expert_29 [label="GPU 440\nExpert 29 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_29 [style=dashed]
	layer_15_expert_29_comm [label="GPU 440\nExpert Communication" shape=ellipse]
	layer_15_expert_29_comm -> layer_15_expert_29 [style=solid]
	layer_15_expert_30 [label="GPU 440\nExpert 30 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_30 [style=dashed]
	layer_15_expert_30_comm [label="GPU 440\nExpert Communication" shape=ellipse]
	layer_15_expert_30_comm -> layer_15_expert_30 [style=solid]
	layer_15_expert_31 [label="GPU 440\nExpert 31 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_31 [style=dashed]
	layer_15_expert_31_comm [label="GPU 440\nExpert Communication" shape=ellipse]
	layer_15_expert_31_comm -> layer_15_expert_31 [style=solid]
	layer_15_expert_32 [label="GPU 448\nExpert 32 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_32 [style=dashed]
	layer_15_expert_32_comm [label="GPU 448\nExpert Communication" shape=ellipse]
	layer_15_expert_32_comm -> layer_15_expert_32 [style=solid]
	layer_15_expert_33 [label="GPU 448\nExpert 33 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_33 [style=dashed]
	layer_15_expert_33_comm [label="GPU 448\nExpert Communication" shape=ellipse]
	layer_15_expert_33_comm -> layer_15_expert_33 [style=solid]
	layer_15_expert_34 [label="GPU 448\nExpert 34 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_34 [style=dashed]
	layer_15_expert_34_comm [label="GPU 448\nExpert Communication" shape=ellipse]
	layer_15_expert_34_comm -> layer_15_expert_34 [style=solid]
	layer_15_expert_35 [label="GPU 448\nExpert 35 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_35 [style=dashed]
	layer_15_expert_35_comm [label="GPU 448\nExpert Communication" shape=ellipse]
	layer_15_expert_35_comm -> layer_15_expert_35 [style=solid]
	layer_15_expert_36 [label="GPU 456\nExpert 36 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_36 [style=dashed]
	layer_15_expert_36_comm [label="GPU 456\nExpert Communication" shape=ellipse]
	layer_15_expert_36_comm -> layer_15_expert_36 [style=solid]
	layer_15_expert_37 [label="GPU 456\nExpert 37 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_37 [style=dashed]
	layer_15_expert_37_comm [label="GPU 456\nExpert Communication" shape=ellipse]
	layer_15_expert_37_comm -> layer_15_expert_37 [style=solid]
	layer_15_expert_38 [label="GPU 456\nExpert 38 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_38 [style=dashed]
	layer_15_expert_38_comm [label="GPU 456\nExpert Communication" shape=ellipse]
	layer_15_expert_38_comm -> layer_15_expert_38 [style=solid]
	layer_15_expert_39 [label="GPU 456\nExpert 39 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_39 [style=dashed]
	layer_15_expert_39_comm [label="GPU 456\nExpert Communication" shape=ellipse]
	layer_15_expert_39_comm -> layer_15_expert_39 [style=solid]
	layer_15_expert_40 [label="GPU 464\nExpert 40 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_40 [style=dashed]
	layer_15_expert_40_comm [label="GPU 464\nExpert Communication" shape=ellipse]
	layer_15_expert_40_comm -> layer_15_expert_40 [style=solid]
	layer_15_expert_41 [label="GPU 464\nExpert 41 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_41 [style=dashed]
	layer_15_expert_41_comm [label="GPU 464\nExpert Communication" shape=ellipse]
	layer_15_expert_41_comm -> layer_15_expert_41 [style=solid]
	layer_15_expert_42 [label="GPU 464\nExpert 42 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_42 [style=dashed]
	layer_15_expert_42_comm [label="GPU 464\nExpert Communication" shape=ellipse]
	layer_15_expert_42_comm -> layer_15_expert_42 [style=solid]
	layer_15_expert_43 [label="GPU 464\nExpert 43 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_43 [style=dashed]
	layer_15_expert_43_comm [label="GPU 464\nExpert Communication" shape=ellipse]
	layer_15_expert_43_comm -> layer_15_expert_43 [style=solid]
	layer_15_expert_44 [label="GPU 472\nExpert 44 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_44 [style=dashed]
	layer_15_expert_44_comm [label="GPU 472\nExpert Communication" shape=ellipse]
	layer_15_expert_44_comm -> layer_15_expert_44 [style=solid]
	layer_15_expert_45 [label="GPU 472\nExpert 45 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_45 [style=dashed]
	layer_15_expert_45_comm [label="GPU 472\nExpert Communication" shape=ellipse]
	layer_15_expert_45_comm -> layer_15_expert_45 [style=solid]
	layer_15_expert_46 [label="GPU 472\nExpert 46 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_46 [style=dashed]
	layer_15_expert_46_comm [label="GPU 472\nExpert Communication" shape=ellipse]
	layer_15_expert_46_comm -> layer_15_expert_46 [style=solid]
	layer_15_expert_47 [label="GPU 472\nExpert 47 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_47 [style=dashed]
	layer_15_expert_47_comm [label="GPU 472\nExpert Communication" shape=ellipse]
	layer_15_expert_47_comm -> layer_15_expert_47 [style=solid]
	layer_15_expert_48 [label="GPU 480\nExpert 48 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_48 [style=dashed]
	layer_15_expert_48_comm [label="GPU 480\nExpert Communication" shape=ellipse]
	layer_15_expert_48_comm -> layer_15_expert_48 [style=solid]
	layer_15_expert_49 [label="GPU 480\nExpert 49 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_49 [style=dashed]
	layer_15_expert_49_comm [label="GPU 480\nExpert Communication" shape=ellipse]
	layer_15_expert_49_comm -> layer_15_expert_49 [style=solid]
	layer_15_expert_50 [label="GPU 480\nExpert 50 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_50 [style=dashed]
	layer_15_expert_50_comm [label="GPU 480\nExpert Communication" shape=ellipse]
	layer_15_expert_50_comm -> layer_15_expert_50 [style=solid]
	layer_15_expert_51 [label="GPU 480\nExpert 51 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_51 [style=dashed]
	layer_15_expert_51_comm [label="GPU 480\nExpert Communication" shape=ellipse]
	layer_15_expert_51_comm -> layer_15_expert_51 [style=solid]
	layer_15_expert_52 [label="GPU 488\nExpert 52 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_52 [style=dashed]
	layer_15_expert_52_comm [label="GPU 488\nExpert Communication" shape=ellipse]
	layer_15_expert_52_comm -> layer_15_expert_52 [style=solid]
	layer_15_expert_53 [label="GPU 488\nExpert 53 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_53 [style=dashed]
	layer_15_expert_53_comm [label="GPU 488\nExpert Communication" shape=ellipse]
	layer_15_expert_53_comm -> layer_15_expert_53 [style=solid]
	layer_15_expert_54 [label="GPU 488\nExpert 54 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_54 [style=dashed]
	layer_15_expert_54_comm [label="GPU 488\nExpert Communication" shape=ellipse]
	layer_15_expert_54_comm -> layer_15_expert_54 [style=solid]
	layer_15_expert_55 [label="GPU 488\nExpert 55 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_55 [style=dashed]
	layer_15_expert_55_comm [label="GPU 488\nExpert Communication" shape=ellipse]
	layer_15_expert_55_comm -> layer_15_expert_55 [style=solid]
	layer_15_expert_56 [label="GPU 496\nExpert 56 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_56 [style=dashed]
	layer_15_expert_56_comm [label="GPU 496\nExpert Communication" shape=ellipse]
	layer_15_expert_56_comm -> layer_15_expert_56 [style=solid]
	layer_15_expert_57 [label="GPU 496\nExpert 57 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_57 [style=dashed]
	layer_15_expert_57_comm [label="GPU 496\nExpert Communication" shape=ellipse]
	layer_15_expert_57_comm -> layer_15_expert_57 [style=solid]
	layer_15_expert_58 [label="GPU 496\nExpert 58 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_58 [style=dashed]
	layer_15_expert_58_comm [label="GPU 496\nExpert Communication" shape=ellipse]
	layer_15_expert_58_comm -> layer_15_expert_58 [style=solid]
	layer_15_expert_59 [label="GPU 496\nExpert 59 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_59 [style=dashed]
	layer_15_expert_59_comm [label="GPU 496\nExpert Communication" shape=ellipse]
	layer_15_expert_59_comm -> layer_15_expert_59 [style=solid]
	layer_15_expert_60 [label="GPU 504\nExpert 60 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_60 [style=dashed]
	layer_15_expert_60_comm [label="GPU 504\nExpert Communication" shape=ellipse]
	layer_15_expert_60_comm -> layer_15_expert_60 [style=solid]
	layer_15_expert_61 [label="GPU 504\nExpert 61 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_61 [style=dashed]
	layer_15_expert_61_comm [label="GPU 504\nExpert Communication" shape=ellipse]
	layer_15_expert_61_comm -> layer_15_expert_61 [style=solid]
	layer_15_expert_62 [label="GPU 504\nExpert 62 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_62 [style=dashed]
	layer_15_expert_62_comm [label="GPU 504\nExpert Communication" shape=ellipse]
	layer_15_expert_62_comm -> layer_15_expert_62 [style=solid]
	layer_15_expert_63 [label="GPU 504\nExpert 63 MLP\nInput: [batch_size=?, seq_len=?, hidden=1024]\nOutput: [batch_size=?, seq_len=?, hidden=1024]" shape=rectangle]
	layer_15_gate -> layer_15_expert_63 [style=dashed]
	layer_15_expert_63_comm [label="GPU 504\nExpert Communication" shape=ellipse]
	layer_15_expert_63_comm -> layer_15_expert_63 [style=solid]
	layer_15_expert_agg [label="GPU 384\nExpert Aggregation (Weighted Sum)\nInput: [batch_size=16, seq_len=10240, experts=64, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=parallelogram]
	layer_15_expert_0 -> layer_15_expert_agg [style=solid]
	layer_15_expert_1 -> layer_15_expert_agg [style=solid]
	layer_15_expert_2 -> layer_15_expert_agg [style=solid]
	layer_15_expert_3 -> layer_15_expert_agg [style=solid]
	layer_15_expert_4 -> layer_15_expert_agg [style=solid]
	layer_15_expert_5 -> layer_15_expert_agg [style=solid]
	layer_15_expert_6 -> layer_15_expert_agg [style=solid]
	layer_15_expert_7 -> layer_15_expert_agg [style=solid]
	layer_15_expert_8 -> layer_15_expert_agg [style=solid]
	layer_15_expert_9 -> layer_15_expert_agg [style=solid]
	layer_15_expert_10 -> layer_15_expert_agg [style=solid]
	layer_15_expert_11 -> layer_15_expert_agg [style=solid]
	layer_15_expert_12 -> layer_15_expert_agg [style=solid]
	layer_15_expert_13 -> layer_15_expert_agg [style=solid]
	layer_15_expert_14 -> layer_15_expert_agg [style=solid]
	layer_15_expert_15 -> layer_15_expert_agg [style=solid]
	layer_15_expert_16 -> layer_15_expert_agg [style=solid]
	layer_15_expert_17 -> layer_15_expert_agg [style=solid]
	layer_15_expert_18 -> layer_15_expert_agg [style=solid]
	layer_15_expert_19 -> layer_15_expert_agg [style=solid]
	layer_15_expert_20 -> layer_15_expert_agg [style=solid]
	layer_15_expert_21 -> layer_15_expert_agg [style=solid]
	layer_15_expert_22 -> layer_15_expert_agg [style=solid]
	layer_15_expert_23 -> layer_15_expert_agg [style=solid]
	layer_15_expert_24 -> layer_15_expert_agg [style=solid]
	layer_15_expert_25 -> layer_15_expert_agg [style=solid]
	layer_15_expert_26 -> layer_15_expert_agg [style=solid]
	layer_15_expert_27 -> layer_15_expert_agg [style=solid]
	layer_15_expert_28 -> layer_15_expert_agg [style=solid]
	layer_15_expert_29 -> layer_15_expert_agg [style=solid]
	layer_15_expert_30 -> layer_15_expert_agg [style=solid]
	layer_15_expert_31 -> layer_15_expert_agg [style=solid]
	layer_15_expert_32 -> layer_15_expert_agg [style=solid]
	layer_15_expert_33 -> layer_15_expert_agg [style=solid]
	layer_15_expert_34 -> layer_15_expert_agg [style=solid]
	layer_15_expert_35 -> layer_15_expert_agg [style=solid]
	layer_15_expert_36 -> layer_15_expert_agg [style=solid]
	layer_15_expert_37 -> layer_15_expert_agg [style=solid]
	layer_15_expert_38 -> layer_15_expert_agg [style=solid]
	layer_15_expert_39 -> layer_15_expert_agg [style=solid]
	layer_15_expert_40 -> layer_15_expert_agg [style=solid]
	layer_15_expert_41 -> layer_15_expert_agg [style=solid]
	layer_15_expert_42 -> layer_15_expert_agg [style=solid]
	layer_15_expert_43 -> layer_15_expert_agg [style=solid]
	layer_15_expert_44 -> layer_15_expert_agg [style=solid]
	layer_15_expert_45 -> layer_15_expert_agg [style=solid]
	layer_15_expert_46 -> layer_15_expert_agg [style=solid]
	layer_15_expert_47 -> layer_15_expert_agg [style=solid]
	layer_15_expert_48 -> layer_15_expert_agg [style=solid]
	layer_15_expert_49 -> layer_15_expert_agg [style=solid]
	layer_15_expert_50 -> layer_15_expert_agg [style=solid]
	layer_15_expert_51 -> layer_15_expert_agg [style=solid]
	layer_15_expert_52 -> layer_15_expert_agg [style=solid]
	layer_15_expert_53 -> layer_15_expert_agg [style=solid]
	layer_15_expert_54 -> layer_15_expert_agg [style=solid]
	layer_15_expert_55 -> layer_15_expert_agg [style=solid]
	layer_15_expert_56 -> layer_15_expert_agg [style=solid]
	layer_15_expert_57 -> layer_15_expert_agg [style=solid]
	layer_15_expert_58 -> layer_15_expert_agg [style=solid]
	layer_15_expert_59 -> layer_15_expert_agg [style=solid]
	layer_15_expert_60 -> layer_15_expert_agg [style=solid]
	layer_15_expert_61 -> layer_15_expert_agg [style=solid]
	layer_15_expert_62 -> layer_15_expert_agg [style=solid]
	layer_15_expert_63 -> layer_15_expert_agg [style=solid]
	layer_15_expert_agg -> layer_15_moe [style=solid]
	layer_15_norm [label="GPU 384\nLayer Normalization\nInput: [batch_size=16, seq_len=10240, hidden=1024]\nOutput: [batch_size=16, seq_len=10240, hidden=1024]" shape=rectangle]
	layer_15_moe -> layer_15_norm [style=solid]
	layer_15_dp_comm [label="GPU 384\nData Parallel All-Reduce" shape=ellipse]
	layer_15_norm -> layer_15_dp_comm [style=solid]
	layer_15_dp_comm -> output [style=solid]
	subgraph stage_3 {
		rank=same
		label="Pipeline Stage 3 (Layers 12-15)"
	}
	output [label="GPU 384\nOutput\nInput: [batch_size=128, seq_len=10240, hidden=1024]\nOutput: [batch_size=128, seq_len=10240, hidden=1024]" shape=rectangle]
}
