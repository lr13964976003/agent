<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="418pt" height="861pt"
 viewBox="0.00 0.00 418.00 860.74" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 856.74)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-856.74 414,-856.74 414,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer1_detailed</title>
<path fill="lightblue" stroke="black" stroke-dasharray="5,2" d="M20,-66C20,-66 390,-66 390,-66 396,-66 402,-72 402,-78 402,-78 402,-794.74 402,-794.74 402,-800.74 396,-806.74 390,-806.74 390,-806.74 20,-806.74 20,-806.74 14,-806.74 8,-800.74 8,-794.74 8,-794.74 8,-78 8,-78 8,-72 14,-66 20,-66"/>
<text text-anchor="middle" x="205" y="-791.54" font-family="Times,serif" font-size="14.00">Layer 1 &#45; Tensor Parallel MLP (Detailed)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightcoral" stroke="black" points="356,-852.74 54,-852.74 54,-814.74 356,-814.74 356,-852.74"/>
<text text-anchor="middle" x="205" y="-837.54" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="205" y="-822.54" font-family="Times,serif" font-size="14.00">(batch=128, seq=10000, hidden=4096)</text>
</g>
<!-- l1_input_split -->
<g id="node2" class="node">
<title>l1_input_split</title>
<polygon fill="lightyellow" stroke="black" points="333.61,-775.74 129.02,-775.74 76.39,-669.74 280.98,-669.74 333.61,-775.74"/>
<text text-anchor="middle" x="205" y="-734.04" font-family="Times,serif" font-size="14.00">Split Input</text>
<text text-anchor="middle" x="205" y="-719.04" font-family="Times,serif" font-size="14.00">Column&#45;wise</text>
<text text-anchor="middle" x="205" y="-704.04" font-family="Times,serif" font-size="14.00">(hidden_size/2)</text>
</g>
<!-- input&#45;&gt;l1_input_split -->
<g id="edge11" class="edge">
<title>input&#45;&gt;l1_input_split</title>
<path fill="none" stroke="black" d="M205,-814.66C205,-814.66 205,-785.92 205,-785.92"/>
<polygon fill="black" stroke="black" points="208.5,-785.92 205,-775.92 201.5,-785.93 208.5,-785.92"/>
</g>
<!-- l1_linear1_gpu0 -->
<g id="node3" class="node">
<title>l1_linear1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="195,-633.74 23,-633.74 23,-580.74 195,-580.74 195,-633.74"/>
<text text-anchor="middle" x="109" y="-618.54" font-family="Times,serif" font-size="14.00">Linear1 Col&#45;Parallel A</text>
<text text-anchor="middle" x="109" y="-603.54" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="109" y="-588.54" font-family="Times,serif" font-size="14.00">(4096→8192)</text>
</g>
<!-- l1_input_split&#45;&gt;l1_linear1_gpu0 -->
<g id="edge1" class="edge">
<title>l1_input_split&#45;&gt;l1_linear1_gpu0</title>
<path fill="none" stroke="black" d="M135.72,-669.72C135.72,-669.72 135.72,-643.81 135.72,-643.81"/>
<polygon fill="black" stroke="black" points="139.22,-643.81 135.72,-633.81 132.22,-643.81 139.22,-643.81"/>
</g>
<!-- l1_linear1_gpu1 -->
<g id="node4" class="node">
<title>l1_linear1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="386.5,-633.74 213.5,-633.74 213.5,-580.74 386.5,-580.74 386.5,-633.74"/>
<text text-anchor="middle" x="300" y="-618.54" font-family="Times,serif" font-size="14.00">Linear1 Col&#45;Parallel B</text>
<text text-anchor="middle" x="300" y="-603.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="300" y="-588.54" font-family="Times,serif" font-size="14.00">(4096→8192)</text>
</g>
<!-- l1_input_split&#45;&gt;l1_linear1_gpu1 -->
<g id="edge2" class="edge">
<title>l1_input_split&#45;&gt;l1_linear1_gpu1</title>
<path fill="none" stroke="black" d="M273.53,-669.72C273.53,-669.72 273.53,-643.81 273.53,-643.81"/>
<polygon fill="black" stroke="black" points="277.03,-643.81 273.53,-633.81 270.03,-643.81 277.03,-643.81"/>
</g>
<!-- l1_concat1 -->
<g id="node5" class="node">
<title>l1_concat1</title>
<polygon fill="lightyellow" stroke="black" points="319.09,-544.74 137.6,-544.74 90.91,-468.74 272.4,-468.74 319.09,-544.74"/>
<text text-anchor="middle" x="205" y="-510.54" font-family="Times,serif" font-size="14.00">Concatenate</text>
<text text-anchor="middle" x="205" y="-495.54" font-family="Times,serif" font-size="14.00">FFN Outputs</text>
</g>
<!-- l1_linear1_gpu0&#45;&gt;l1_concat1 -->
<g id="edge3" class="edge">
<title>l1_linear1_gpu0&#45;&gt;l1_concat1</title>
<path fill="none" stroke="black" d="M142.98,-580.57C142.98,-580.57 142.98,-554.88 142.98,-554.88"/>
<polygon fill="black" stroke="black" points="146.48,-554.88 142.98,-544.88 139.48,-554.88 146.48,-554.88"/>
</g>
<!-- l1_linear1_gpu1&#45;&gt;l1_concat1 -->
<g id="edge4" class="edge">
<title>l1_linear1_gpu1&#45;&gt;l1_concat1</title>
<path fill="none" stroke="black" d="M266.27,-580.57C266.27,-580.57 266.27,-554.88 266.27,-554.88"/>
<polygon fill="black" stroke="black" points="269.77,-554.88 266.27,-544.88 262.77,-554.88 269.77,-554.88"/>
</g>
<!-- l1_gelu -->
<g id="node6" class="node">
<title>l1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="272.5,-432.74 137.5,-432.74 137.5,-394.74 272.5,-394.74 272.5,-432.74"/>
<text text-anchor="middle" x="205" y="-417.54" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="205" y="-402.54" font-family="Times,serif" font-size="14.00">(Element&#45;wise)</text>
</g>
<!-- l1_concat1&#45;&gt;l1_gelu -->
<g id="edge5" class="edge">
<title>l1_concat1&#45;&gt;l1_gelu</title>
<path fill="none" stroke="black" d="M205,-468.65C205,-468.65 205,-442.81 205,-442.81"/>
<polygon fill="black" stroke="black" points="208.5,-442.81 205,-432.81 201.5,-442.81 208.5,-442.81"/>
</g>
<!-- l1_split2 -->
<g id="node7" class="node">
<title>l1_split2</title>
<polygon fill="lightyellow" stroke="black" points="359.45,-358.74 113.75,-358.74 50.55,-252.74 296.25,-252.74 359.45,-358.74"/>
<text text-anchor="middle" x="205" y="-317.04" font-family="Times,serif" font-size="14.00">Split Intermediate</text>
<text text-anchor="middle" x="205" y="-302.04" font-family="Times,serif" font-size="14.00">Row&#45;wise</text>
<text text-anchor="middle" x="205" y="-287.04" font-family="Times,serif" font-size="14.00">(ffn_hidden_size/2)</text>
</g>
<!-- l1_gelu&#45;&gt;l1_split2 -->
<g id="edge6" class="edge">
<title>l1_gelu&#45;&gt;l1_split2</title>
<path fill="none" stroke="black" d="M205,-394.68C205,-394.68 205,-368.92 205,-368.92"/>
<polygon fill="black" stroke="black" points="208.5,-368.92 205,-358.92 201.5,-368.92 208.5,-368.92"/>
</g>
<!-- l1_linear2_gpu0 -->
<g id="node8" class="node">
<title>l1_linear2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="195.5,-216.74 16.5,-216.74 16.5,-163.74 195.5,-163.74 195.5,-216.74"/>
<text text-anchor="middle" x="106" y="-201.54" font-family="Times,serif" font-size="14.00">Linear2 Row&#45;Parallel A</text>
<text text-anchor="middle" x="106" y="-186.54" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="106" y="-171.54" font-family="Times,serif" font-size="14.00">(8192→4096)</text>
</g>
<!-- l1_split2&#45;&gt;l1_linear2_gpu0 -->
<g id="edge7" class="edge">
<title>l1_split2&#45;&gt;l1_linear2_gpu0</title>
<path fill="none" stroke="black" d="M123.01,-252.72C123.01,-252.72 123.01,-226.81 123.01,-226.81"/>
<polygon fill="black" stroke="black" points="126.51,-226.81 123.01,-216.81 119.51,-226.81 126.51,-226.81"/>
</g>
<!-- l1_linear2_gpu1 -->
<g id="node9" class="node">
<title>l1_linear2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="394,-216.74 214,-216.74 214,-163.74 394,-163.74 394,-216.74"/>
<text text-anchor="middle" x="304" y="-201.54" font-family="Times,serif" font-size="14.00">Linear2 Row&#45;Parallel B</text>
<text text-anchor="middle" x="304" y="-186.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="304" y="-171.54" font-family="Times,serif" font-size="14.00">(8192→4096)</text>
</g>
<!-- l1_split2&#45;&gt;l1_linear2_gpu1 -->
<g id="edge8" class="edge">
<title>l1_split2&#45;&gt;l1_linear2_gpu1</title>
<path fill="none" stroke="black" d="M286.74,-252.72C286.74,-252.72 286.74,-226.81 286.74,-226.81"/>
<polygon fill="black" stroke="black" points="290.24,-226.81 286.74,-216.81 283.24,-226.81 290.24,-226.81"/>
</g>
<!-- l1_allreduce -->
<g id="node10" class="node">
<title>l1_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="205" cy="-100.87" rx="91.43" ry="26.74"/>
<text text-anchor="middle" x="205" y="-104.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="205" y="-89.67" font-family="Times,serif" font-size="14.00">Final Output</text>
</g>
<!-- l1_linear2_gpu0&#45;&gt;l1_allreduce -->
<g id="edge9" class="edge">
<title>l1_linear2_gpu0&#45;&gt;l1_allreduce</title>
<path fill="none" stroke="black" d="M154.64,-163.43C154.64,-163.43 154.64,-133.44 154.64,-133.44"/>
<polygon fill="black" stroke="black" points="158.14,-133.44 154.64,-123.44 151.14,-133.44 158.14,-133.44"/>
</g>
<!-- l1_linear2_gpu1&#45;&gt;l1_allreduce -->
<g id="edge10" class="edge">
<title>l1_linear2_gpu1&#45;&gt;l1_allreduce</title>
<path fill="none" stroke="black" d="M255.11,-163.43C255.11,-163.43 255.11,-133.44 255.11,-133.44"/>
<polygon fill="black" stroke="black" points="258.61,-133.44 255.11,-123.44 251.61,-133.44 258.61,-133.44"/>
</g>
<!-- output -->
<g id="node11" class="node">
<title>output</title>
<polygon fill="lightcoral" stroke="black" points="356,-38 54,-38 54,0 356,0 356,-38"/>
<text text-anchor="middle" x="205" y="-22.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="205" y="-7.8" font-family="Times,serif" font-size="14.00">(batch=128, seq=10000, hidden=4096)</text>
</g>
<!-- l1_allreduce&#45;&gt;output -->
<g id="edge12" class="edge">
<title>l1_allreduce&#45;&gt;output</title>
<path fill="none" stroke="black" d="M205,-73.61C205,-73.61 205,-48.13 205,-48.13"/>
<polygon fill="black" stroke="black" points="208.5,-48.13 205,-38.13 201.5,-48.13 208.5,-48.13"/>
</g>
</g>
</svg>
