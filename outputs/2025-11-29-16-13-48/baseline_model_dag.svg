<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="949pt" height="1163pt"
 viewBox="0.00 0.00 949.00 1162.70" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1158.7)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1158.7 945,-1158.7 945,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage1</title>
<path fill="lightblue" stroke="black" stroke-dasharray="5,2" d="M20,-636.22C20,-636.22 867,-636.22 867,-636.22 873,-636.22 879,-642.22 879,-648.22 879,-648.22 879,-1096.7 879,-1096.7 879,-1102.7 873,-1108.7 867,-1108.7 867,-1108.7 20,-1108.7 20,-1108.7 14,-1108.7 8,-1102.7 8,-1096.7 8,-1096.7 8,-648.22 8,-648.22 8,-642.22 14,-636.22 20,-636.22"/>
<text text-anchor="middle" x="443.5" y="-1093.5" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (TP=8)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage2</title>
<path fill="lightpink" stroke="black" stroke-dasharray="5,2" d="M74,-66C74,-66 921,-66 921,-66 927,-66 933,-72 933,-78 933,-78 933,-616.22 933,-616.22 933,-622.22 927,-628.22 921,-628.22 921,-628.22 74,-628.22 74,-628.22 68,-628.22 62,-622.22 62,-616.22 62,-616.22 62,-78 62,-78 62,-72 68,-66 74,-66"/>
<text text-anchor="middle" x="497.5" y="-613.02" font-family="Times,serif" font-size="14.00">Pipeline Stage 2 (TP=8)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightcoral" stroke="black" points="643,-1154.7 243,-1154.7 243,-1116.7 643,-1116.7 643,-1154.7"/>
<text text-anchor="middle" x="443" y="-1139.5" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="443" y="-1124.5" font-family="Times,serif" font-size="14.00">(batch_size=128, seq_len=10000, hidden_size=4096)</text>
</g>
<!-- split_input_s1 -->
<g id="node2" class="node">
<title>split_input_s1</title>
<polygon fill="lightyellow" stroke="black" points="554.94,-1077.7 376.87,-1077.7 331.06,-1001.7 509.13,-1001.7 554.94,-1077.7"/>
<text text-anchor="middle" x="443" y="-1043.5" font-family="Times,serif" font-size="14.00">Split Input</text>
<text text-anchor="middle" x="443" y="-1028.5" font-family="Times,serif" font-size="14.00">Column&#45;wise</text>
</g>
<!-- input&#45;&gt;split_input_s1 -->
<g id="edge66" class="edge">
<title>input&#45;&gt;split_input_s1</title>
<path fill="none" stroke="black" d="M443,-1116.27C443,-1116.27 443,-1087.75 443,-1087.75"/>
<polygon fill="black" stroke="black" points="446.5,-1087.75 443,-1077.75 439.5,-1087.75 446.5,-1087.75"/>
</g>
<!-- layer1_gpu0 -->
<g id="node3" class="node">
<title>layer1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="107.5,-965.7 16.5,-965.7 16.5,-912.7 107.5,-912.7 107.5,-965.7"/>
<text text-anchor="middle" x="62" y="-950.5" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="62" y="-935.5" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="62" y="-920.5" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- split_input_s1&#45;&gt;layer1_gpu0 -->
<g id="edge1" class="edge">
<title>split_input_s1&#45;&gt;layer1_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M361.27,-1052C249.32,-1052 62,-1052 62,-1052 62,-1052 62,-975.93 62,-975.93"/>
<polygon fill="black" stroke="black" points="65.5,-975.93 62,-965.93 58.5,-975.93 65.5,-975.93"/>
</g>
<!-- layer1_gpu1 -->
<g id="node4" class="node">
<title>layer1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="216.5,-965.7 125.5,-965.7 125.5,-912.7 216.5,-912.7 216.5,-965.7"/>
<text text-anchor="middle" x="171" y="-950.5" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="171" y="-935.5" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="171" y="-920.5" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- split_input_s1&#45;&gt;layer1_gpu1 -->
<g id="edge2" class="edge">
<title>split_input_s1&#45;&gt;layer1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M345.95,-1027C267.84,-1027 171,-1027 171,-1027 171,-1027 171,-976.02 171,-976.02"/>
<polygon fill="black" stroke="black" points="174.5,-976.02 171,-966.02 167.5,-976.02 174.5,-976.02"/>
</g>
<!-- layer1_gpu2 -->
<g id="node5" class="node">
<title>layer1_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="325.5,-965.7 234.5,-965.7 234.5,-912.7 325.5,-912.7 325.5,-965.7"/>
<text text-anchor="middle" x="280" y="-950.5" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="280" y="-935.5" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="280" y="-920.5" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- split_input_s1&#45;&gt;layer1_gpu2 -->
<g id="edge3" class="edge">
<title>split_input_s1&#45;&gt;layer1_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M337.27,-1039.63C337.27,-1036.58 337.27,-939 337.27,-939 337.27,-939 335.68,-939 335.68,-939"/>
<polygon fill="black" stroke="black" points="335.68,-935.5 325.68,-939 335.68,-942.5 335.68,-935.5"/>
</g>
<!-- layer1_gpu3 -->
<g id="node6" class="node">
<title>layer1_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="434.5,-965.7 343.5,-965.7 343.5,-912.7 434.5,-912.7 434.5,-965.7"/>
<text text-anchor="middle" x="389" y="-950.5" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="389" y="-935.5" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="389" y="-920.5" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- split_input_s1&#45;&gt;layer1_gpu3 -->
<g id="edge4" class="edge">
<title>split_input_s1&#45;&gt;layer1_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389,-1001.42C389,-1001.42 389,-975.83 389,-975.83"/>
<polygon fill="black" stroke="black" points="392.5,-975.83 389,-965.83 385.5,-975.83 392.5,-975.83"/>
</g>
<!-- layer1_gpu4 -->
<g id="node7" class="node">
<title>layer1_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="543.5,-965.7 452.5,-965.7 452.5,-912.7 543.5,-912.7 543.5,-965.7"/>
<text text-anchor="middle" x="498" y="-950.5" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="498" y="-935.5" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="498" y="-920.5" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- split_input_s1&#45;&gt;layer1_gpu4 -->
<g id="edge5" class="edge">
<title>split_input_s1&#45;&gt;layer1_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M498,-1001.42C498,-1001.42 498,-975.83 498,-975.83"/>
<polygon fill="black" stroke="black" points="501.5,-975.83 498,-965.83 494.5,-975.83 501.5,-975.83"/>
</g>
<!-- layer1_gpu5 -->
<g id="node8" class="node">
<title>layer1_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="652.5,-965.7 561.5,-965.7 561.5,-912.7 652.5,-912.7 652.5,-965.7"/>
<text text-anchor="middle" x="607" y="-950.5" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="607" y="-935.5" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="607" y="-920.5" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- split_input_s1&#45;&gt;layer1_gpu5 -->
<g id="edge6" class="edge">
<title>split_input_s1&#45;&gt;layer1_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M549.23,-1039.63C549.23,-1036.58 549.23,-939 549.23,-939 549.23,-939 551.49,-939 551.49,-939"/>
<polygon fill="black" stroke="black" points="551.49,-942.5 561.49,-939 551.49,-935.5 551.49,-942.5"/>
</g>
<!-- layer1_gpu6 -->
<g id="node9" class="node">
<title>layer1_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="761.5,-965.7 670.5,-965.7 670.5,-912.7 761.5,-912.7 761.5,-965.7"/>
<text text-anchor="middle" x="716" y="-950.5" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="716" y="-935.5" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="716" y="-920.5" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- split_input_s1&#45;&gt;layer1_gpu6 -->
<g id="edge7" class="edge">
<title>split_input_s1&#45;&gt;layer1_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M524.54,-1027C604.98,-1027 716,-1027 716,-1027 716,-1027 716,-976.02 716,-976.02"/>
<polygon fill="black" stroke="black" points="719.5,-976.02 716,-966.02 712.5,-976.02 719.5,-976.02"/>
</g>
<!-- layer1_gpu7 -->
<g id="node10" class="node">
<title>layer1_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="870.5,-965.7 779.5,-965.7 779.5,-912.7 870.5,-912.7 870.5,-965.7"/>
<text text-anchor="middle" x="825" y="-950.5" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="825" y="-935.5" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="825" y="-920.5" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- split_input_s1&#45;&gt;layer1_gpu7 -->
<g id="edge8" class="edge">
<title>split_input_s1&#45;&gt;layer1_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M539.89,-1052C653.06,-1052 825,-1052 825,-1052 825,-1052 825,-975.93 825,-975.93"/>
<polygon fill="black" stroke="black" points="828.5,-975.93 825,-965.93 821.5,-975.93 828.5,-975.93"/>
</g>
<!-- ar_layer1 -->
<g id="node11" class="node">
<title>ar_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="443" cy="-849.83" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="443" y="-853.63" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="443" y="-838.63" font-family="Times,serif" font-size="14.00">Layer 1 Output</text>
</g>
<!-- layer1_gpu0&#45;&gt;ar_layer1 -->
<g id="edge9" class="edge">
<title>layer1_gpu0&#45;&gt;ar_layer1</title>
<path fill="none" stroke="black" d="M77.17,-912.4C77.17,-887.09 77.17,-853 77.17,-853 77.17,-853 344.91,-853 344.91,-853"/>
<polygon fill="black" stroke="black" points="344.91,-856.5 354.91,-853 344.91,-849.5 344.91,-856.5"/>
</g>
<!-- layer1_gpu1&#45;&gt;ar_layer1 -->
<g id="edge12" class="edge">
<title>layer1_gpu1&#45;&gt;ar_layer1</title>
<path fill="none" stroke="black" d="M186.17,-912.29C186.17,-889.67 186.17,-861 186.17,-861 186.17,-861 352.44,-861 352.44,-861"/>
<polygon fill="black" stroke="black" points="352.44,-864.5 362.44,-861 352.44,-857.5 352.44,-864.5"/>
</g>
<!-- layer1_gpu2&#45;&gt;ar_layer1 -->
<g id="edge15" class="edge">
<title>layer1_gpu2&#45;&gt;ar_layer1</title>
<path fill="none" stroke="black" d="M295.17,-912.66C295.17,-892.78 295.17,-869 295.17,-869 295.17,-869 370.73,-869 370.73,-869"/>
<polygon fill="black" stroke="black" points="370.73,-872.5 380.73,-869 370.73,-865.5 370.73,-872.5"/>
</g>
<!-- layer1_gpu3&#45;&gt;ar_layer1 -->
<g id="edge18" class="edge">
<title>layer1_gpu3&#45;&gt;ar_layer1</title>
<path fill="none" stroke="black" d="M394.56,-912.39C394.56,-912.39 394.56,-882.4 394.56,-882.4"/>
<polygon fill="black" stroke="black" points="398.06,-882.4 394.56,-872.4 391.06,-882.4 398.06,-882.4"/>
</g>
<!-- layer1_gpu4&#45;&gt;ar_layer1 -->
<g id="edge21" class="edge">
<title>layer1_gpu4&#45;&gt;ar_layer1</title>
<path fill="none" stroke="black" d="M491.94,-912.39C491.94,-912.39 491.94,-882.4 491.94,-882.4"/>
<polygon fill="black" stroke="black" points="495.44,-882.4 491.94,-872.4 488.44,-882.4 495.44,-882.4"/>
</g>
<!-- layer1_gpu5&#45;&gt;ar_layer1 -->
<g id="edge24" class="edge">
<title>layer1_gpu5&#45;&gt;ar_layer1</title>
<path fill="none" stroke="black" d="M622.17,-912.66C622.17,-892.78 622.17,-869 622.17,-869 622.17,-869 515.16,-869 515.16,-869"/>
<polygon fill="black" stroke="black" points="515.16,-865.5 505.16,-869 515.16,-872.5 515.16,-865.5"/>
</g>
<!-- layer1_gpu6&#45;&gt;ar_layer1 -->
<g id="edge27" class="edge">
<title>layer1_gpu6&#45;&gt;ar_layer1</title>
<path fill="none" stroke="black" d="M731.17,-912.29C731.17,-889.67 731.17,-861 731.17,-861 731.17,-861 533.65,-861 533.65,-861"/>
<polygon fill="black" stroke="black" points="533.65,-857.5 523.65,-861 533.65,-864.5 533.65,-857.5"/>
</g>
<!-- layer1_gpu7&#45;&gt;ar_layer1 -->
<g id="edge30" class="edge">
<title>layer1_gpu7&#45;&gt;ar_layer1</title>
<path fill="none" stroke="black" d="M840.17,-912.4C840.17,-887.09 840.17,-853 840.17,-853 840.17,-853 541.14,-853 541.14,-853"/>
<polygon fill="black" stroke="black" points="541.14,-849.5 531.14,-853 541.14,-856.5 541.14,-849.5"/>
</g>
<!-- layer2_gpu0 -->
<g id="node12" class="node">
<title>layer2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="107.5,-786.96 16.5,-786.96 16.5,-733.96 107.5,-733.96 107.5,-786.96"/>
<text text-anchor="middle" x="62" y="-771.76" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="62" y="-756.76" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="62" y="-741.76" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- ar_layer1&#45;&gt;layer2_gpu0 -->
<g id="edge10" class="edge">
<title>ar_layer1&#45;&gt;layer2_gpu0</title>
<path fill="none" stroke="black" d="M355.57,-845C238.9,-845 46.83,-845 46.83,-845 46.83,-845 46.83,-797.21 46.83,-797.21"/>
<polygon fill="black" stroke="black" points="50.33,-797.21 46.83,-787.21 43.33,-797.21 50.33,-797.21"/>
</g>
<!-- layer2_gpu1 -->
<g id="node13" class="node">
<title>layer2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="216.5,-786.96 125.5,-786.96 125.5,-733.96 216.5,-733.96 216.5,-786.96"/>
<text text-anchor="middle" x="171" y="-771.76" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="171" y="-756.76" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="171" y="-741.76" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- ar_layer1&#45;&gt;layer2_gpu1 -->
<g id="edge13" class="edge">
<title>ar_layer1&#45;&gt;layer2_gpu1</title>
<path fill="none" stroke="black" d="M363.39,-838C278.4,-838 155.83,-838 155.83,-838 155.83,-838 155.83,-797.15 155.83,-797.15"/>
<polygon fill="black" stroke="black" points="159.33,-797.15 155.83,-787.15 152.33,-797.15 159.33,-797.15"/>
</g>
<!-- layer2_gpu2 -->
<g id="node14" class="node">
<title>layer2_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="325.5,-786.96 234.5,-786.96 234.5,-733.96 325.5,-733.96 325.5,-786.96"/>
<text text-anchor="middle" x="280" y="-771.76" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="280" y="-756.76" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="280" y="-741.76" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- ar_layer1&#45;&gt;layer2_gpu2 -->
<g id="edge16" class="edge">
<title>ar_layer1&#45;&gt;layer2_gpu2</title>
<path fill="none" stroke="black" d="M383.18,-830C331.42,-830 264.83,-830 264.83,-830 264.83,-830 264.83,-797.15 264.83,-797.15"/>
<polygon fill="black" stroke="black" points="268.33,-797.15 264.83,-787.15 261.33,-797.15 268.33,-797.15"/>
</g>
<!-- layer2_gpu3 -->
<g id="node15" class="node">
<title>layer2_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="434.5,-786.96 343.5,-786.96 343.5,-733.96 434.5,-733.96 434.5,-786.96"/>
<text text-anchor="middle" x="389" y="-771.76" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="389" y="-756.76" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="389" y="-741.76" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- ar_layer1&#45;&gt;layer2_gpu3 -->
<g id="edge19" class="edge">
<title>ar_layer1&#45;&gt;layer2_gpu3</title>
<path fill="none" stroke="black" d="M394.56,-827.28C394.56,-827.28 394.56,-797.14 394.56,-797.14"/>
<polygon fill="black" stroke="black" points="398.06,-797.14 394.56,-787.14 391.06,-797.14 398.06,-797.14"/>
</g>
<!-- layer2_gpu4 -->
<g id="node16" class="node">
<title>layer2_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="543.5,-786.96 452.5,-786.96 452.5,-733.96 543.5,-733.96 543.5,-786.96"/>
<text text-anchor="middle" x="498" y="-771.76" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="498" y="-756.76" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="498" y="-741.76" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- ar_layer1&#45;&gt;layer2_gpu4 -->
<g id="edge22" class="edge">
<title>ar_layer1&#45;&gt;layer2_gpu4</title>
<path fill="none" stroke="black" d="M491.94,-827.28C491.94,-827.28 491.94,-797.14 491.94,-797.14"/>
<polygon fill="black" stroke="black" points="495.44,-797.14 491.94,-787.14 488.44,-797.14 495.44,-797.14"/>
</g>
<!-- layer2_gpu5 -->
<g id="node17" class="node">
<title>layer2_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="652.5,-786.96 561.5,-786.96 561.5,-733.96 652.5,-733.96 652.5,-786.96"/>
<text text-anchor="middle" x="607" y="-771.76" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="607" y="-756.76" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="607" y="-741.76" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- ar_layer1&#45;&gt;layer2_gpu5 -->
<g id="edge25" class="edge">
<title>ar_layer1&#45;&gt;layer2_gpu5</title>
<path fill="none" stroke="black" d="M502.68,-830C544.09,-830 591.83,-830 591.83,-830 591.83,-830 591.83,-797.15 591.83,-797.15"/>
<polygon fill="black" stroke="black" points="595.33,-797.15 591.83,-787.15 588.33,-797.15 595.33,-797.15"/>
</g>
<!-- layer2_gpu6 -->
<g id="node18" class="node">
<title>layer2_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="761.5,-786.96 670.5,-786.96 670.5,-733.96 761.5,-733.96 761.5,-786.96"/>
<text text-anchor="middle" x="716" y="-771.76" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="716" y="-756.76" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="716" y="-741.76" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- ar_layer1&#45;&gt;layer2_gpu6 -->
<g id="edge28" class="edge">
<title>ar_layer1&#45;&gt;layer2_gpu6</title>
<path fill="none" stroke="black" d="M522.46,-838C598.22,-838 700.83,-838 700.83,-838 700.83,-838 700.83,-797.15 700.83,-797.15"/>
<polygon fill="black" stroke="black" points="704.33,-797.15 700.83,-787.15 697.33,-797.15 704.33,-797.15"/>
</g>
<!-- layer2_gpu7 -->
<g id="node19" class="node">
<title>layer2_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="870.5,-786.96 779.5,-786.96 779.5,-733.96 870.5,-733.96 870.5,-786.96"/>
<text text-anchor="middle" x="825" y="-771.76" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="825" y="-756.76" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="825" y="-741.76" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- ar_layer1&#45;&gt;layer2_gpu7 -->
<g id="edge31" class="edge">
<title>ar_layer1&#45;&gt;layer2_gpu7</title>
<path fill="none" stroke="black" d="M530.4,-845C638.9,-845 809.83,-845 809.83,-845 809.83,-845 809.83,-797.21 809.83,-797.21"/>
<polygon fill="black" stroke="black" points="813.33,-797.21 809.83,-787.21 806.33,-797.21 813.33,-797.21"/>
</g>
<!-- ar_layer2 -->
<g id="node20" class="node">
<title>ar_layer2</title>
<ellipse fill="lightblue" stroke="black" cx="443" cy="-671.09" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="443" y="-674.89" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="443" y="-659.89" font-family="Times,serif" font-size="14.00">Layer 2 Output</text>
</g>
<!-- layer2_gpu0&#45;&gt;ar_layer2 -->
<g id="edge11" class="edge">
<title>layer2_gpu0&#45;&gt;ar_layer2</title>
<path fill="none" stroke="black" d="M89,-733.82C89,-703.16 89,-657 89,-657 89,-657 357.49,-657 357.49,-657"/>
<polygon fill="black" stroke="black" points="357.49,-660.5 367.49,-657 357.49,-653.5 357.49,-660.5"/>
</g>
<!-- layer2_gpu1&#45;&gt;ar_layer2 -->
<g id="edge14" class="edge">
<title>layer2_gpu1&#45;&gt;ar_layer2</title>
<path fill="none" stroke="black" d="M198,-733.62C198,-707.27 198,-671 198,-671 198,-671 344.55,-671 344.55,-671"/>
<polygon fill="black" stroke="black" points="344.55,-674.5 354.55,-671 344.55,-667.5 344.55,-674.5"/>
</g>
<!-- layer2_gpu2&#45;&gt;ar_layer2 -->
<g id="edge17" class="edge">
<title>layer2_gpu2&#45;&gt;ar_layer2</title>
<path fill="none" stroke="black" d="M307,-733.72C307,-711.67 307,-684 307,-684 307,-684 355.47,-684 355.47,-684"/>
<polygon fill="black" stroke="black" points="355.47,-687.5 365.47,-684 355.47,-680.5 355.47,-687.5"/>
</g>
<!-- layer2_gpu3&#45;&gt;ar_layer2 -->
<g id="edge20" class="edge">
<title>layer2_gpu3&#45;&gt;ar_layer2</title>
<path fill="none" stroke="black" d="M394.56,-733.65C394.56,-733.65 394.56,-703.66 394.56,-703.66"/>
<polygon fill="black" stroke="black" points="398.06,-703.66 394.56,-693.66 391.06,-703.66 398.06,-703.66"/>
</g>
<!-- layer2_gpu4&#45;&gt;ar_layer2 -->
<g id="edge23" class="edge">
<title>layer2_gpu4&#45;&gt;ar_layer2</title>
<path fill="none" stroke="black" d="M491.94,-733.65C491.94,-733.65 491.94,-703.66 491.94,-703.66"/>
<polygon fill="black" stroke="black" points="495.44,-703.66 491.94,-693.66 488.44,-703.66 495.44,-703.66"/>
</g>
<!-- layer2_gpu5&#45;&gt;ar_layer2 -->
<g id="edge26" class="edge">
<title>layer2_gpu5&#45;&gt;ar_layer2</title>
<path fill="none" stroke="black" d="M579.5,-733.72C579.5,-711.67 579.5,-684 579.5,-684 579.5,-684 530.82,-684 530.82,-684"/>
<polygon fill="black" stroke="black" points="530.82,-680.5 520.82,-684 530.82,-687.5 530.82,-680.5"/>
</g>
<!-- layer2_gpu6&#45;&gt;ar_layer2 -->
<g id="edge29" class="edge">
<title>layer2_gpu6&#45;&gt;ar_layer2</title>
<path fill="none" stroke="black" d="M688.5,-733.62C688.5,-707.27 688.5,-671 688.5,-671 688.5,-671 541.63,-671 541.63,-671"/>
<polygon fill="black" stroke="black" points="541.63,-667.5 531.63,-671 541.63,-674.5 541.63,-667.5"/>
</g>
<!-- layer2_gpu7&#45;&gt;ar_layer2 -->
<g id="edge32" class="edge">
<title>layer2_gpu7&#45;&gt;ar_layer2</title>
<path fill="none" stroke="black" d="M797.5,-733.82C797.5,-703.16 797.5,-657 797.5,-657 797.5,-657 528.61,-657 528.61,-657"/>
<polygon fill="black" stroke="black" points="528.61,-653.5 518.61,-657 528.61,-660.5 528.61,-653.5"/>
</g>
<!-- transfer_s1_s2 -->
<g id="node21" class="node">
<title>transfer_s1_s2</title>
<ellipse fill="lightblue" stroke="black" cx="443" cy="-570.35" rx="91.43" ry="26.74"/>
<text text-anchor="middle" x="443" y="-574.15" font-family="Times,serif" font-size="14.00">Transfer</text>
<text text-anchor="middle" x="443" y="-559.15" font-family="Times,serif" font-size="14.00">Stage1â†’Stage2</text>
</g>
<!-- ar_layer2&#45;&gt;transfer_s1_s2 -->
<g id="edge67" class="edge">
<title>ar_layer2&#45;&gt;transfer_s1_s2</title>
<path fill="none" stroke="black" d="M443,-644.09C443,-644.09 443,-607.42 443,-607.42"/>
<polygon fill="black" stroke="black" points="446.5,-607.42 443,-597.42 439.5,-607.42 446.5,-607.42"/>
</g>
<!-- split_input_s2 -->
<g id="node22" class="node">
<title>split_input_s2</title>
<polygon fill="lightyellow" stroke="black" points="554.94,-507.48 376.87,-507.48 331.06,-431.48 509.13,-431.48 554.94,-507.48"/>
<text text-anchor="middle" x="443" y="-473.28" font-family="Times,serif" font-size="14.00">Split Input</text>
<text text-anchor="middle" x="443" y="-458.28" font-family="Times,serif" font-size="14.00">Column&#45;wise</text>
</g>
<!-- transfer_s1_s2&#45;&gt;split_input_s2 -->
<g id="edge33" class="edge">
<title>transfer_s1_s2&#45;&gt;split_input_s2</title>
<path fill="none" stroke="black" d="M443,-543.32C443,-543.32 443,-517.58 443,-517.58"/>
<polygon fill="black" stroke="black" points="446.5,-517.58 443,-507.58 439.5,-517.58 446.5,-517.58"/>
</g>
<!-- layer3_gpu8 -->
<g id="node23" class="node">
<title>layer3_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="161.5,-395.48 70.5,-395.48 70.5,-342.48 161.5,-342.48 161.5,-395.48"/>
<text text-anchor="middle" x="116" y="-380.28" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="116" y="-365.28" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="116" y="-350.28" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- split_input_s2&#45;&gt;layer3_gpu8 -->
<g id="edge34" class="edge">
<title>split_input_s2&#45;&gt;layer3_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M361.16,-482C272.48,-482 143.5,-482 143.5,-482 143.5,-482 143.5,-405.76 143.5,-405.76"/>
<polygon fill="black" stroke="black" points="147,-405.76 143.5,-395.76 140,-405.76 147,-405.76"/>
</g>
<!-- layer3_gpu9 -->
<g id="node24" class="node">
<title>layer3_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="270.5,-395.48 179.5,-395.48 179.5,-342.48 270.5,-342.48 270.5,-395.48"/>
<text text-anchor="middle" x="225" y="-380.28" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="225" y="-365.28" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="225" y="-350.28" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- split_input_s2&#45;&gt;layer3_gpu9 -->
<g id="edge35" class="edge">
<title>split_input_s2&#45;&gt;layer3_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M345.8,-456C298.83,-456 252.5,-456 252.5,-456 252.5,-456 252.5,-405.56 252.5,-405.56"/>
<polygon fill="black" stroke="black" points="256,-405.56 252.5,-395.56 249,-405.56 256,-405.56"/>
</g>
<!-- layer3_gpu10 -->
<g id="node25" class="node">
<title>layer3_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="379.5,-395.48 288.5,-395.48 288.5,-342.48 379.5,-342.48 379.5,-395.48"/>
<text text-anchor="middle" x="334" y="-380.28" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="334" y="-365.28" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="334" y="-350.28" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- split_input_s2&#45;&gt;layer3_gpu10 -->
<g id="edge36" class="edge">
<title>split_input_s2&#45;&gt;layer3_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M355.27,-431.2C355.27,-431.2 355.27,-405.61 355.27,-405.61"/>
<polygon fill="black" stroke="black" points="358.77,-405.61 355.27,-395.61 351.77,-405.61 358.77,-405.61"/>
</g>
<!-- layer3_gpu11 -->
<g id="node26" class="node">
<title>layer3_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="488.5,-395.48 397.5,-395.48 397.5,-342.48 488.5,-342.48 488.5,-395.48"/>
<text text-anchor="middle" x="443" y="-380.28" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="443" y="-365.28" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="443" y="-350.28" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- split_input_s2&#45;&gt;layer3_gpu11 -->
<g id="edge37" class="edge">
<title>split_input_s2&#45;&gt;layer3_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M443,-431.2C443,-431.2 443,-405.61 443,-405.61"/>
<polygon fill="black" stroke="black" points="446.5,-405.61 443,-395.61 439.5,-405.61 446.5,-405.61"/>
</g>
<!-- layer3_gpu12 -->
<g id="node27" class="node">
<title>layer3_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="597.5,-395.48 506.5,-395.48 506.5,-342.48 597.5,-342.48 597.5,-395.48"/>
<text text-anchor="middle" x="552" y="-380.28" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="552" y="-365.28" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="552" y="-350.28" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- split_input_s2&#45;&gt;layer3_gpu12 -->
<g id="edge38" class="edge">
<title>split_input_s2&#45;&gt;layer3_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M530.73,-467C530.73,-467 530.73,-405.91 530.73,-405.91"/>
<polygon fill="black" stroke="black" points="534.23,-405.91 530.73,-395.91 527.23,-405.91 534.23,-405.91"/>
</g>
<!-- layer3_gpu13 -->
<g id="node28" class="node">
<title>layer3_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="706.5,-395.48 615.5,-395.48 615.5,-342.48 706.5,-342.48 706.5,-395.48"/>
<text text-anchor="middle" x="661" y="-380.28" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="661" y="-365.28" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="661" y="-350.28" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- split_input_s2&#45;&gt;layer3_gpu13 -->
<g id="edge39" class="edge">
<title>split_input_s2&#45;&gt;layer3_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M520.41,-450C573.36,-450 634,-450 634,-450 634,-450 634,-405.51 634,-405.51"/>
<polygon fill="black" stroke="black" points="637.5,-405.51 634,-395.51 630.5,-405.51 637.5,-405.51"/>
</g>
<!-- layer3_gpu14 -->
<g id="node29" class="node">
<title>layer3_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="815.5,-395.48 724.5,-395.48 724.5,-342.48 815.5,-342.48 815.5,-395.48"/>
<text text-anchor="middle" x="770" y="-380.28" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="770" y="-365.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="770" y="-350.28" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- split_input_s2&#45;&gt;layer3_gpu14 -->
<g id="edge40" class="edge">
<title>split_input_s2&#45;&gt;layer3_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M531.79,-469C620.25,-469 743,-469 743,-469 743,-469 743,-405.52 743,-405.52"/>
<polygon fill="black" stroke="black" points="746.5,-405.52 743,-395.52 739.5,-405.52 746.5,-405.52"/>
</g>
<!-- layer3_gpu15 -->
<g id="node30" class="node">
<title>layer3_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="924.5,-395.48 833.5,-395.48 833.5,-342.48 924.5,-342.48 924.5,-395.48"/>
<text text-anchor="middle" x="879" y="-380.28" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="879" y="-365.28" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="879" y="-350.28" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- split_input_s2&#45;&gt;layer3_gpu15 -->
<g id="edge41" class="edge">
<title>split_input_s2&#45;&gt;layer3_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M543.31,-488C664.41,-488 852,-488 852,-488 852,-488 852,-405.69 852,-405.69"/>
<polygon fill="black" stroke="black" points="855.5,-405.69 852,-395.69 848.5,-405.69 855.5,-405.69"/>
</g>
<!-- ar_layer3 -->
<g id="node31" class="node">
<title>ar_layer3</title>
<ellipse fill="lightblue" stroke="black" cx="497" cy="-279.61" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="497" y="-283.41" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="497" y="-268.41" font-family="Times,serif" font-size="14.00">Layer 3 Output</text>
</g>
<!-- layer3_gpu8&#45;&gt;ar_layer3 -->
<g id="edge42" class="edge">
<title>layer3_gpu8&#45;&gt;ar_layer3</title>
<path fill="none" stroke="black" d="M131.17,-342.25C131.17,-317.01 131.17,-283 131.17,-283 131.17,-283 398.91,-283 398.91,-283"/>
<polygon fill="black" stroke="black" points="398.91,-286.5 408.91,-283 398.91,-279.5 398.91,-286.5"/>
</g>
<!-- layer3_gpu9&#45;&gt;ar_layer3 -->
<g id="edge45" class="edge">
<title>layer3_gpu9&#45;&gt;ar_layer3</title>
<path fill="none" stroke="black" d="M240.17,-342.14C240.17,-319.59 240.17,-291 240.17,-291 240.17,-291 406.79,-291 406.79,-291"/>
<polygon fill="black" stroke="black" points="406.79,-294.5 416.79,-291 406.79,-287.5 406.79,-294.5"/>
</g>
<!-- layer3_gpu10&#45;&gt;ar_layer3 -->
<g id="edge48" class="edge">
<title>layer3_gpu10&#45;&gt;ar_layer3</title>
<path fill="none" stroke="black" d="M349.17,-342.15C349.17,-322.05 349.17,-298 349.17,-298 349.17,-298 422.16,-298 422.16,-298"/>
<polygon fill="black" stroke="black" points="422.16,-301.5 432.16,-298 422.16,-294.5 422.16,-301.5"/>
</g>
<!-- layer3_gpu11&#45;&gt;ar_layer3 -->
<g id="edge51" class="edge">
<title>layer3_gpu11&#45;&gt;ar_layer3</title>
<path fill="none" stroke="black" d="M448.56,-342.17C448.56,-342.17 448.56,-312.18 448.56,-312.18"/>
<polygon fill="black" stroke="black" points="452.06,-312.18 448.56,-302.18 445.06,-312.18 452.06,-312.18"/>
</g>
<!-- layer3_gpu12&#45;&gt;ar_layer3 -->
<g id="edge54" class="edge">
<title>layer3_gpu12&#45;&gt;ar_layer3</title>
<path fill="none" stroke="black" d="M545.94,-342.17C545.94,-342.17 545.94,-312.18 545.94,-312.18"/>
<polygon fill="black" stroke="black" points="549.44,-312.18 545.94,-302.18 542.44,-312.18 549.44,-312.18"/>
</g>
<!-- layer3_gpu13&#45;&gt;ar_layer3 -->
<g id="edge57" class="edge">
<title>layer3_gpu13&#45;&gt;ar_layer3</title>
<path fill="none" stroke="black" d="M676.17,-342.15C676.17,-322.05 676.17,-298 676.17,-298 676.17,-298 571.68,-298 571.68,-298"/>
<polygon fill="black" stroke="black" points="571.68,-294.5 561.68,-298 571.68,-301.5 571.68,-294.5"/>
</g>
<!-- layer3_gpu14&#45;&gt;ar_layer3 -->
<g id="edge60" class="edge">
<title>layer3_gpu14&#45;&gt;ar_layer3</title>
<path fill="none" stroke="black" d="M785.17,-342.14C785.17,-319.59 785.17,-291 785.17,-291 785.17,-291 587.27,-291 587.27,-291"/>
<polygon fill="black" stroke="black" points="587.27,-287.5 577.27,-291 587.27,-294.5 587.27,-287.5"/>
</g>
<!-- layer3_gpu15&#45;&gt;ar_layer3 -->
<g id="edge63" class="edge">
<title>layer3_gpu15&#45;&gt;ar_layer3</title>
<path fill="none" stroke="black" d="M894.17,-342.25C894.17,-317.01 894.17,-283 894.17,-283 894.17,-283 595.14,-283 595.14,-283"/>
<polygon fill="black" stroke="black" points="595.14,-279.5 585.14,-283 595.14,-286.5 595.14,-279.5"/>
</g>
<!-- layer4_gpu8 -->
<g id="node32" class="node">
<title>layer4_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="161.5,-216.74 70.5,-216.74 70.5,-163.74 161.5,-163.74 161.5,-216.74"/>
<text text-anchor="middle" x="116" y="-201.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="116" y="-186.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="116" y="-171.54" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- ar_layer3&#45;&gt;layer4_gpu8 -->
<g id="edge43" class="edge">
<title>ar_layer3&#45;&gt;layer4_gpu8</title>
<path fill="none" stroke="black" d="M409.57,-275C292.9,-275 100.83,-275 100.83,-275 100.83,-275 100.83,-227.06 100.83,-227.06"/>
<polygon fill="black" stroke="black" points="104.33,-227.06 100.83,-217.06 97.33,-227.06 104.33,-227.06"/>
</g>
<!-- layer4_gpu9 -->
<g id="node33" class="node">
<title>layer4_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="270.5,-216.74 179.5,-216.74 179.5,-163.74 270.5,-163.74 270.5,-216.74"/>
<text text-anchor="middle" x="225" y="-201.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="225" y="-186.54" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="225" y="-171.54" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- ar_layer3&#45;&gt;layer4_gpu9 -->
<g id="edge46" class="edge">
<title>ar_layer3&#45;&gt;layer4_gpu9</title>
<path fill="none" stroke="black" d="M417.01,-268C332.04,-268 209.83,-268 209.83,-268 209.83,-268 209.83,-227 209.83,-227"/>
<polygon fill="black" stroke="black" points="213.33,-227 209.83,-217 206.33,-227 213.33,-227"/>
</g>
<!-- layer4_gpu10 -->
<g id="node34" class="node">
<title>layer4_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="379.5,-216.74 288.5,-216.74 288.5,-163.74 379.5,-163.74 379.5,-216.74"/>
<text text-anchor="middle" x="334" y="-201.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="334" y="-186.54" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="334" y="-171.54" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- ar_layer3&#45;&gt;layer4_gpu10 -->
<g id="edge49" class="edge">
<title>ar_layer3&#45;&gt;layer4_gpu10</title>
<path fill="none" stroke="black" d="M436.18,-260C384.57,-260 318.83,-260 318.83,-260 318.83,-260 318.83,-227.01 318.83,-227.01"/>
<polygon fill="black" stroke="black" points="322.33,-227.01 318.83,-217.01 315.33,-227.01 322.33,-227.01"/>
</g>
<!-- layer4_gpu11 -->
<g id="node35" class="node">
<title>layer4_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="488.5,-216.74 397.5,-216.74 397.5,-163.74 488.5,-163.74 488.5,-216.74"/>
<text text-anchor="middle" x="443" y="-201.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="443" y="-186.54" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="443" y="-171.54" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- ar_layer3&#45;&gt;layer4_gpu11 -->
<g id="edge52" class="edge">
<title>ar_layer3&#45;&gt;layer4_gpu11</title>
<path fill="none" stroke="black" d="M448.56,-257.06C448.56,-257.06 448.56,-226.92 448.56,-226.92"/>
<polygon fill="black" stroke="black" points="452.06,-226.92 448.56,-216.92 445.06,-226.92 452.06,-226.92"/>
</g>
<!-- layer4_gpu12 -->
<g id="node36" class="node">
<title>layer4_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="597.5,-216.74 506.5,-216.74 506.5,-163.74 597.5,-163.74 597.5,-216.74"/>
<text text-anchor="middle" x="552" y="-201.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="552" y="-186.54" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="552" y="-171.54" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- ar_layer3&#45;&gt;layer4_gpu12 -->
<g id="edge55" class="edge">
<title>ar_layer3&#45;&gt;layer4_gpu12</title>
<path fill="none" stroke="black" d="M545.94,-257.06C545.94,-257.06 545.94,-226.92 545.94,-226.92"/>
<polygon fill="black" stroke="black" points="549.44,-226.92 545.94,-216.92 542.44,-226.92 549.44,-226.92"/>
</g>
<!-- layer4_gpu13 -->
<g id="node37" class="node">
<title>layer4_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="706.5,-216.74 615.5,-216.74 615.5,-163.74 706.5,-163.74 706.5,-216.74"/>
<text text-anchor="middle" x="661" y="-201.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="661" y="-186.54" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="661" y="-171.54" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- ar_layer3&#45;&gt;layer4_gpu13 -->
<g id="edge58" class="edge">
<title>ar_layer3&#45;&gt;layer4_gpu13</title>
<path fill="none" stroke="black" d="M557.54,-260C598.74,-260 645.83,-260 645.83,-260 645.83,-260 645.83,-227.01 645.83,-227.01"/>
<polygon fill="black" stroke="black" points="649.33,-227.01 645.83,-217.01 642.33,-227.01 649.33,-227.01"/>
</g>
<!-- layer4_gpu14 -->
<g id="node38" class="node">
<title>layer4_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="815.5,-216.74 724.5,-216.74 724.5,-163.74 815.5,-163.74 815.5,-216.74"/>
<text text-anchor="middle" x="770" y="-201.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="770" y="-186.54" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="770" y="-171.54" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- ar_layer3&#45;&gt;layer4_gpu14 -->
<g id="edge61" class="edge">
<title>ar_layer3&#45;&gt;layer4_gpu14</title>
<path fill="none" stroke="black" d="M576.81,-268C652.54,-268 754.83,-268 754.83,-268 754.83,-268 754.83,-227 754.83,-227"/>
<polygon fill="black" stroke="black" points="758.33,-227 754.83,-217 751.33,-227 758.33,-227"/>
</g>
<!-- layer4_gpu15 -->
<g id="node39" class="node">
<title>layer4_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="924.5,-216.74 833.5,-216.74 833.5,-163.74 924.5,-163.74 924.5,-216.74"/>
<text text-anchor="middle" x="879" y="-201.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="879" y="-186.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="879" y="-171.54" font-family="Times,serif" font-size="14.00">(TP shard)</text>
</g>
<!-- ar_layer3&#45;&gt;layer4_gpu15 -->
<g id="edge64" class="edge">
<title>ar_layer3&#45;&gt;layer4_gpu15</title>
<path fill="none" stroke="black" d="M584.4,-275C692.9,-275 863.83,-275 863.83,-275 863.83,-275 863.83,-227.06 863.83,-227.06"/>
<polygon fill="black" stroke="black" points="867.33,-227.06 863.83,-217.06 860.33,-227.06 867.33,-227.06"/>
</g>
<!-- ar_layer4 -->
<g id="node40" class="node">
<title>ar_layer4</title>
<ellipse fill="lightblue" stroke="black" cx="497" cy="-100.87" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="497" y="-104.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="497" y="-89.67" font-family="Times,serif" font-size="14.00">Layer 4 Output</text>
</g>
<!-- layer4_gpu8&#45;&gt;ar_layer4 -->
<g id="edge44" class="edge">
<title>layer4_gpu8&#45;&gt;ar_layer4</title>
<path fill="none" stroke="black" d="M116,-163.65C116,-133.06 116,-87 116,-87 116,-87 411.27,-87 411.27,-87"/>
<polygon fill="black" stroke="black" points="411.27,-90.5 421.27,-87 411.27,-83.5 411.27,-90.5"/>
</g>
<!-- layer4_gpu9&#45;&gt;ar_layer4 -->
<g id="edge47" class="edge">
<title>layer4_gpu9&#45;&gt;ar_layer4</title>
<path fill="none" stroke="black" d="M225,-163.65C225,-137.03 225,-100 225,-100 225,-100 398.31,-100 398.31,-100"/>
<polygon fill="black" stroke="black" points="398.31,-103.5 408.31,-100 398.31,-96.5 398.31,-103.5"/>
</g>
<!-- layer4_gpu10&#45;&gt;ar_layer4 -->
<g id="edge50" class="edge">
<title>layer4_gpu10&#45;&gt;ar_layer4</title>
<path fill="none" stroke="black" d="M338.25,-163.58C338.25,-141.59 338.25,-114 338.25,-114 338.25,-114 409.49,-114 409.49,-114"/>
<polygon fill="black" stroke="black" points="409.49,-117.5 419.49,-114 409.49,-110.5 409.49,-117.5"/>
</g>
<!-- layer4_gpu11&#45;&gt;ar_layer4 -->
<g id="edge53" class="edge">
<title>layer4_gpu11&#45;&gt;ar_layer4</title>
<path fill="none" stroke="black" d="M448.56,-163.43C448.56,-163.43 448.56,-133.44 448.56,-133.44"/>
<polygon fill="black" stroke="black" points="452.06,-133.44 448.56,-123.44 445.06,-133.44 452.06,-133.44"/>
</g>
<!-- layer4_gpu12&#45;&gt;ar_layer4 -->
<g id="edge56" class="edge">
<title>layer4_gpu12&#45;&gt;ar_layer4</title>
<path fill="none" stroke="black" d="M545.94,-163.43C545.94,-163.43 545.94,-133.44 545.94,-133.44"/>
<polygon fill="black" stroke="black" points="549.44,-133.44 545.94,-123.44 542.44,-133.44 549.44,-133.44"/>
</g>
<!-- layer4_gpu13&#45;&gt;ar_layer4 -->
<g id="edge59" class="edge">
<title>layer4_gpu13&#45;&gt;ar_layer4</title>
<path fill="none" stroke="black" d="M656.25,-163.58C656.25,-141.59 656.25,-114 656.25,-114 656.25,-114 584.29,-114 584.29,-114"/>
<polygon fill="black" stroke="black" points="584.29,-110.5 574.29,-114 584.29,-117.5 584.29,-110.5"/>
</g>
<!-- layer4_gpu14&#45;&gt;ar_layer4 -->
<g id="edge62" class="edge">
<title>layer4_gpu14&#45;&gt;ar_layer4</title>
<path fill="none" stroke="black" d="M770,-163.65C770,-137.03 770,-100 770,-100 770,-100 595.64,-100 595.64,-100"/>
<polygon fill="black" stroke="black" points="595.64,-96.5 585.64,-100 595.64,-103.5 595.64,-96.5"/>
</g>
<!-- layer4_gpu15&#45;&gt;ar_layer4 -->
<g id="edge65" class="edge">
<title>layer4_gpu15&#45;&gt;ar_layer4</title>
<path fill="none" stroke="black" d="M879,-163.65C879,-133.06 879,-87 879,-87 879,-87 582.93,-87 582.93,-87"/>
<polygon fill="black" stroke="black" points="582.93,-83.5 572.93,-87 582.93,-90.5 582.93,-83.5"/>
</g>
<!-- output -->
<g id="node41" class="node">
<title>output</title>
<polygon fill="lightcoral" stroke="black" points="697,-38 297,-38 297,0 697,0 697,-38"/>
<text text-anchor="middle" x="497" y="-22.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="497" y="-7.8" font-family="Times,serif" font-size="14.00">(batch_size=128, seq_len=10000, hidden_size=4096)</text>
</g>
<!-- ar_layer4&#45;&gt;output -->
<g id="edge68" class="edge">
<title>ar_layer4&#45;&gt;output</title>
<path fill="none" stroke="black" d="M497,-73.61C497,-73.61 497,-48.13 497,-48.13"/>
<polygon fill="black" stroke="black" points="500.5,-48.13 497,-38.13 493.5,-48.13 500.5,-48.13"/>
</g>
</g>
</svg>
