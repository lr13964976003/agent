<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="5019pt" height="216pt"
 viewBox="0.00 0.00 5018.50 215.98" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 211.98)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-211.98 5014.5,-211.98 5014.5,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_memory</title>
<path fill="lightyellow" stroke="black" stroke-dasharray="5,2" d="M317,-8C317,-8 972,-8 972,-8 978,-8 984,-14 984,-20 984,-20 984,-169.5 984,-169.5 984,-175.5 978,-181.5 972,-181.5 972,-181.5 317,-181.5 317,-181.5 311,-181.5 305,-175.5 305,-169.5 305,-169.5 305,-20 305,-20 305,-14 311,-8 317,-8"/>
<text text-anchor="middle" x="644.5" y="-166.3" font-family="Times,serif" font-size="14.00">Per&#45;Layer Memory Breakdown (60MB Cache Constraint)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu_assignment</title>
<path fill="lightblue" stroke="black" stroke-dasharray="5,2" d="M1004,-97C1004,-97 3515,-97 3515,-97 3521,-97 3527,-103 3527,-109 3527,-109 3527,-177 3527,-177 3527,-183 3521,-189 3515,-189 3515,-189 1004,-189 1004,-189 998,-189 992,-183 992,-177 992,-177 992,-109 992,-109 992,-103 998,-97 1004,-97"/>
<text text-anchor="middle" x="2259.5" y="-173.8" font-family="Times,serif" font-size="14.00">Optimized GPU Assignment Strategy</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_communication</title>
<path fill="lightgreen" stroke="black" stroke-dasharray="5,2" d="M3547,-86.02C3547,-86.02 4634,-86.02 4634,-86.02 4640,-86.02 4646,-92.02 4646,-98.02 4646,-98.02 4646,-187.98 4646,-187.98 4646,-193.98 4640,-199.98 4634,-199.98 4634,-199.98 3547,-199.98 3547,-199.98 3541,-199.98 3535,-193.98 3535,-187.98 3535,-187.98 3535,-98.02 3535,-98.02 3535,-92.02 3541,-86.02 3547,-86.02"/>
<text text-anchor="middle" x="4090.5" y="-184.78" font-family="Times,serif" font-size="14.00">Communication Pattern Comparison</text>
</g>
<!-- title -->
<g id="node1" class="node">
<title>title</title>
<polygon fill="darkblue" stroke="black" points="294,-150.5 0,-150.5 0,-112.5 294,-112.5 294,-150.5"/>
<text text-anchor="middle" x="147" y="-135.3" font-family="Times,serif" font-size="14.00" fill="white">Memory Layout Analysis</text>
<text text-anchor="middle" x="147" y="-120.3" font-family="Times,serif" font-size="14.00" fill="white">Cache&#45;Conscious Deployment Strategy</text>
</g>
<!-- mem_weights -->
<g id="node2" class="node">
<title>mem_weights</title>
<polygon fill="lightgreen" stroke="black" points="975.5,-150.5 804.5,-150.5 804.5,-112.5 975.5,-112.5 975.5,-150.5"/>
<text text-anchor="middle" x="890" y="-135.3" font-family="Times,serif" font-size="14.00">Weights: 15.36GB</text>
<text text-anchor="middle" x="890" y="-120.3" font-family="Times,serif" font-size="14.00">(30B total ÷ 4 layers)</text>
</g>
<!-- mem_total -->
<g id="node5" class="node">
<title>mem_total</title>
<polygon fill="lightcoral" stroke="black" points="743.5,-54 542.5,-54 542.5,-16 743.5,-16 743.5,-54"/>
<text text-anchor="middle" x="643" y="-38.8" font-family="Times,serif" font-size="14.00">Total per layer: 15.87GB</text>
<text text-anchor="middle" x="643" y="-23.8" font-family="Times,serif" font-size="14.00">(Cache utilization: 98.8%)</text>
</g>
<!-- mem_weights&#45;&gt;mem_total -->
<g id="edge1" class="edge">
<title>mem_weights&#45;&gt;mem_total</title>
<path fill="none" stroke="black" d="M890,-112.43C890,-84.31 890,-35 890,-35 890,-35 753.82,-35 753.82,-35"/>
<polygon fill="black" stroke="black" points="753.82,-31.5 743.82,-35 753.82,-38.5 753.82,-31.5"/>
</g>
<!-- mem_activations -->
<g id="node3" class="node">
<title>mem_activations</title>
<polygon fill="lightgreen" stroke="black" points="786,-150.5 500,-150.5 500,-112.5 786,-112.5 786,-150.5"/>
<text text-anchor="middle" x="643" y="-135.3" font-family="Times,serif" font-size="14.00">Activations: 256MB</text>
<text text-anchor="middle" x="643" y="-120.3" font-family="Times,serif" font-size="14.00">(batch_size × seq_len × hidden × 2B)</text>
</g>
<!-- mem_activations&#45;&gt;mem_total -->
<g id="edge2" class="edge">
<title>mem_activations&#45;&gt;mem_total</title>
<path fill="none" stroke="black" d="M643,-112.43C643,-112.43 643,-64.03 643,-64.03"/>
<polygon fill="black" stroke="black" points="646.5,-64.03 643,-54.03 639.5,-64.03 646.5,-64.03"/>
</g>
<!-- mem_buffers -->
<g id="node4" class="node">
<title>mem_buffers</title>
<polygon fill="lightgreen" stroke="black" points="481.5,-150.5 312.5,-150.5 312.5,-112.5 481.5,-112.5 481.5,-150.5"/>
<text text-anchor="middle" x="397" y="-135.3" font-family="Times,serif" font-size="14.00">Buffers: 256MB</text>
<text text-anchor="middle" x="397" y="-120.3" font-family="Times,serif" font-size="14.00">(operator workspace)</text>
</g>
<!-- mem_buffers&#45;&gt;mem_total -->
<g id="edge3" class="edge">
<title>mem_buffers&#45;&gt;mem_total</title>
<path fill="none" stroke="black" d="M397,-112.43C397,-84.31 397,-35 397,-35 397,-35 532.23,-35 532.23,-35"/>
<polygon fill="black" stroke="black" points="532.23,-38.5 542.23,-35 532.23,-31.5 532.23,-38.5"/>
</g>
<!-- gpu0_part_a -->
<g id="node6" class="node">
<title>gpu0_part_a</title>
<polygon fill="lightgreen" stroke="black" points="3518.5,-158 3399.5,-158 3399.5,-105 3518.5,-105 3518.5,-158"/>
<text text-anchor="middle" x="3459" y="-142.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="3459" y="-127.8" font-family="Times,serif" font-size="14.00">Layer 1 Part A</text>
<text text-anchor="middle" x="3459" y="-112.8" font-family="Times,serif" font-size="14.00">30.5GB cache</text>
</g>
<!-- gpu1_part_b -->
<g id="node7" class="node">
<title>gpu1_part_b</title>
<polygon fill="lightgreen" stroke="black" points="3381,-158 3261,-158 3261,-105 3381,-105 3381,-158"/>
<text text-anchor="middle" x="3321" y="-142.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3321" y="-127.8" font-family="Times,serif" font-size="14.00">Layer 1 Part B</text>
<text text-anchor="middle" x="3321" y="-112.8" font-family="Times,serif" font-size="14.00">30.5GB cache</text>
</g>
<!-- gpu2_part_a -->
<g id="node8" class="node">
<title>gpu2_part_a</title>
<polygon fill="lightgreen" stroke="black" points="3242.5,-158 3123.5,-158 3123.5,-105 3242.5,-105 3242.5,-158"/>
<text text-anchor="middle" x="3183" y="-142.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="3183" y="-127.8" font-family="Times,serif" font-size="14.00">Layer 2 Part A</text>
<text text-anchor="middle" x="3183" y="-112.8" font-family="Times,serif" font-size="14.00">30.5GB cache</text>
</g>
<!-- gpu3_part_b -->
<g id="node9" class="node">
<title>gpu3_part_b</title>
<polygon fill="lightgreen" stroke="black" points="3105,-158 2985,-158 2985,-105 3105,-105 3105,-158"/>
<text text-anchor="middle" x="3045" y="-142.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3045" y="-127.8" font-family="Times,serif" font-size="14.00">Layer 2 Part B</text>
<text text-anchor="middle" x="3045" y="-112.8" font-family="Times,serif" font-size="14.00">30.5GB cache</text>
</g>
<!-- gpu4_part_a -->
<g id="node10" class="node">
<title>gpu4_part_a</title>
<polygon fill="lightgreen" stroke="black" points="2966.5,-158 2847.5,-158 2847.5,-105 2966.5,-105 2966.5,-158"/>
<text text-anchor="middle" x="2907" y="-142.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2907" y="-127.8" font-family="Times,serif" font-size="14.00">Layer 3 Part A</text>
<text text-anchor="middle" x="2907" y="-112.8" font-family="Times,serif" font-size="14.00">30.5GB cache</text>
</g>
<!-- gpu5_part_b -->
<g id="node11" class="node">
<title>gpu5_part_b</title>
<polygon fill="lightgreen" stroke="black" points="2829,-158 2709,-158 2709,-105 2829,-105 2829,-158"/>
<text text-anchor="middle" x="2769" y="-142.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2769" y="-127.8" font-family="Times,serif" font-size="14.00">Layer 3 Part B</text>
<text text-anchor="middle" x="2769" y="-112.8" font-family="Times,serif" font-size="14.00">30.5GB cache</text>
</g>
<!-- gpu6_part_a -->
<g id="node12" class="node">
<title>gpu6_part_a</title>
<polygon fill="lightgreen" stroke="black" points="2690.5,-158 2571.5,-158 2571.5,-105 2690.5,-105 2690.5,-158"/>
<text text-anchor="middle" x="2631" y="-142.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="2631" y="-127.8" font-family="Times,serif" font-size="14.00">Layer 4 Part A</text>
<text text-anchor="middle" x="2631" y="-112.8" font-family="Times,serif" font-size="14.00">30.5GB cache</text>
</g>
<!-- gpu7_part_b -->
<g id="node13" class="node">
<title>gpu7_part_b</title>
<polygon fill="lightgreen" stroke="black" points="2553,-158 2433,-158 2433,-105 2553,-105 2553,-158"/>
<text text-anchor="middle" x="2493" y="-142.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="2493" y="-127.8" font-family="Times,serif" font-size="14.00">Layer 4 Part B</text>
<text text-anchor="middle" x="2493" y="-112.8" font-family="Times,serif" font-size="14.00">30.5GB cache</text>
</g>
<!-- gpu8_available -->
<g id="node14" class="node">
<title>gpu8_available</title>
<polygon fill="lightgray" stroke="black" points="2414.5,-158 2253.5,-158 2253.5,-105 2414.5,-105 2414.5,-158"/>
<text text-anchor="middle" x="2334" y="-142.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="2334" y="-127.8" font-family="Times,serif" font-size="14.00">Available for scaling</text>
<text text-anchor="middle" x="2334" y="-112.8" font-family="Times,serif" font-size="14.00">61.4GB cache</text>
</g>
<!-- gpu9_available -->
<g id="node15" class="node">
<title>gpu9_available</title>
<polygon fill="lightgray" stroke="black" points="2235.5,-158 2074.5,-158 2074.5,-105 2235.5,-105 2235.5,-158"/>
<text text-anchor="middle" x="2155" y="-142.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="2155" y="-127.8" font-family="Times,serif" font-size="14.00">Available for scaling</text>
<text text-anchor="middle" x="2155" y="-112.8" font-family="Times,serif" font-size="14.00">61.4GB cache</text>
</g>
<!-- gpu10_available -->
<g id="node16" class="node">
<title>gpu10_available</title>
<polygon fill="lightgray" stroke="black" points="2056.5,-158 1895.5,-158 1895.5,-105 2056.5,-105 2056.5,-158"/>
<text text-anchor="middle" x="1976" y="-142.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="1976" y="-127.8" font-family="Times,serif" font-size="14.00">Available for scaling</text>
<text text-anchor="middle" x="1976" y="-112.8" font-family="Times,serif" font-size="14.00">61.4GB cache</text>
</g>
<!-- gpu11_available -->
<g id="node17" class="node">
<title>gpu11_available</title>
<polygon fill="lightgray" stroke="black" points="1877.5,-158 1716.5,-158 1716.5,-105 1877.5,-105 1877.5,-158"/>
<text text-anchor="middle" x="1797" y="-142.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="1797" y="-127.8" font-family="Times,serif" font-size="14.00">Available for scaling</text>
<text text-anchor="middle" x="1797" y="-112.8" font-family="Times,serif" font-size="14.00">61.4GB cache</text>
</g>
<!-- gpu12_available -->
<g id="node18" class="node">
<title>gpu12_available</title>
<polygon fill="lightgray" stroke="black" points="1698.5,-158 1537.5,-158 1537.5,-105 1698.5,-105 1698.5,-158"/>
<text text-anchor="middle" x="1618" y="-142.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="1618" y="-127.8" font-family="Times,serif" font-size="14.00">Available for scaling</text>
<text text-anchor="middle" x="1618" y="-112.8" font-family="Times,serif" font-size="14.00">61.4GB cache</text>
</g>
<!-- gpu13_available -->
<g id="node19" class="node">
<title>gpu13_available</title>
<polygon fill="lightgray" stroke="black" points="1519.5,-158 1358.5,-158 1358.5,-105 1519.5,-105 1519.5,-158"/>
<text text-anchor="middle" x="1439" y="-142.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="1439" y="-127.8" font-family="Times,serif" font-size="14.00">Available for scaling</text>
<text text-anchor="middle" x="1439" y="-112.8" font-family="Times,serif" font-size="14.00">61.4GB cache</text>
</g>
<!-- gpu14_available -->
<g id="node20" class="node">
<title>gpu14_available</title>
<polygon fill="lightgray" stroke="black" points="1340.5,-158 1179.5,-158 1179.5,-105 1340.5,-105 1340.5,-158"/>
<text text-anchor="middle" x="1260" y="-142.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="1260" y="-127.8" font-family="Times,serif" font-size="14.00">Available for scaling</text>
<text text-anchor="middle" x="1260" y="-112.8" font-family="Times,serif" font-size="14.00">61.4GB cache</text>
</g>
<!-- gpu15_available -->
<g id="node21" class="node">
<title>gpu15_available</title>
<polygon fill="lightgray" stroke="black" points="1161.5,-158 1000.5,-158 1000.5,-105 1161.5,-105 1161.5,-158"/>
<text text-anchor="middle" x="1081" y="-142.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="1081" y="-127.8" font-family="Times,serif" font-size="14.00">Available for scaling</text>
<text text-anchor="middle" x="1081" y="-112.8" font-family="Times,serif" font-size="14.00">61.4GB cache</text>
</g>
<!-- comm_baseline -->
<g id="node22" class="node">
<title>comm_baseline</title>
<ellipse fill="lightblue" stroke="black" cx="4447" cy="-131.5" rx="190.84" ry="37.45"/>
<text text-anchor="middle" x="4447" y="-142.8" font-family="Times,serif" font-size="14.00">Baseline (TP=8, PP=2):</text>
<text text-anchor="middle" x="4447" y="-127.8" font-family="Times,serif" font-size="14.00">• All&#45;reduce: 25% overhead</text>
<text text-anchor="middle" x="4447" y="-112.8" font-family="Times,serif" font-size="14.00">• Inter&#45;stage transfer: High latency</text>
</g>
<!-- comm_proposed -->
<g id="node23" class="node">
<title>comm_proposed</title>
<ellipse fill="lightblue" stroke="black" cx="4075" cy="-131.5" rx="163.18" ry="37.45"/>
<text text-anchor="middle" x="4075" y="-142.8" font-family="Times,serif" font-size="14.00">Proposed (Layer&#45;wise):</text>
<text text-anchor="middle" x="4075" y="-127.8" font-family="Times,serif" font-size="14.00">• Point&#45;to&#45;point: 5% overhead</text>
<text text-anchor="middle" x="4075" y="-112.8" font-family="Times,serif" font-size="14.00">• Cache&#45;to&#45;cache: Low latency</text>
</g>
<!-- comm_optimized -->
<g id="node24" class="node">
<title>comm_optimized</title>
<ellipse fill="lightblue" stroke="black" cx="3718" cy="-131.5" rx="175.23" ry="37.45"/>
<text text-anchor="middle" x="3718" y="-142.8" font-family="Times,serif" font-size="14.00">Optimized (Layer&#45;wise + TP):</text>
<text text-anchor="middle" x="3718" y="-127.8" font-family="Times,serif" font-size="14.00">• 2&#45;way all&#45;reduce: 8% overhead</text>
<text text-anchor="middle" x="3718" y="-112.8" font-family="Times,serif" font-size="14.00">• Balanced communication</text>
</g>
<!-- cache_summary -->
<g id="node25" class="node">
<title>cache_summary</title>
<polygon fill="lightgray" stroke="black" points="5004.5,-173 4655.5,-173 4655.5,-90 5010.5,-90 5010.5,-167 5004.5,-173"/>
<polyline fill="none" stroke="black" points="5004.5,-173 5004.5,-167 "/>
<polyline fill="none" stroke="black" points="5010.5,-167 5004.5,-167 "/>
<text text-anchor="middle" x="4833" y="-157.8" font-family="Times,serif" font-size="14.00">Cache Utilization Summary:</text>
<text text-anchor="middle" x="4833" y="-142.8" font-family="Times,serif" font-size="14.00">• Baseline: 60&#45;70% (uneven distribution)</text>
<text text-anchor="middle" x="4833" y="-127.8" font-family="Times,serif" font-size="14.00">• Original Proposed: 98.8% (perfect fit)</text>
<text text-anchor="middle" x="4833" y="-112.8" font-family="Times,serif" font-size="14.00">• Optimized: 99.2% (tensor parallel split)</text>
<text text-anchor="middle" x="4833" y="-97.8" font-family="Times,serif" font-size="14.00">• Available GPUs: 12/16 (75% unused capacity)</text>
</g>
</g>
</svg>
