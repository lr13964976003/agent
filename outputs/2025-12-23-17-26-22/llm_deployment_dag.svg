<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="2510pt" height="1519pt"
 viewBox="0.00 0.00 2510.04 1519.07" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1515.07)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1515.07 2506.04,-1515.07 2506.04,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="white" stroke="black" cx="263.04" cy="-1473.6" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="263.04" y="-1484.9" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="263.04" y="-1469.9" font-family="Times,serif" font-size="14.00">Input: [batch_size=B, seq_len=S]</text>
<text text-anchor="middle" x="263.04" y="-1454.9" font-family="Times,serif" font-size="14.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- embed_tp0 -->
<g id="node2" class="node">
<title>embed_tp0</title>
<polygon fill="none" stroke="black" points="234.54,-1336.04 83.54,-1336.04 83.54,-1268.04 234.54,-1268.04 234.54,-1336.04"/>
<text text-anchor="middle" x="159.04" y="-1320.84" font-family="Times,serif" font-size="14.00">Embedding TP0</text>
<text text-anchor="middle" x="159.04" y="-1305.84" font-family="Times,serif" font-size="14.00">GPU: 0,2,4,6</text>
<text text-anchor="middle" x="159.04" y="-1290.84" font-family="Times,serif" font-size="14.00">Input: [B,S]</text>
<text text-anchor="middle" x="159.04" y="-1275.84" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- input&#45;&gt;embed_tp0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embed_tp0</title>
<path fill="none" stroke="black" d="M240.73,-1436.22C224.31,-1409.44 201.94,-1372.97 184.76,-1344.96"/>
<polygon fill="black" stroke="black" points="187.59,-1342.88 179.38,-1336.19 181.62,-1346.54 187.59,-1342.88"/>
</g>
<!-- embed_tp1 -->
<g id="node3" class="node">
<title>embed_tp1</title>
<polygon fill="none" stroke="black" points="443.54,-1336.04 292.54,-1336.04 292.54,-1268.04 443.54,-1268.04 443.54,-1336.04"/>
<text text-anchor="middle" x="368.04" y="-1320.84" font-family="Times,serif" font-size="14.00">Embedding TP1</text>
<text text-anchor="middle" x="368.04" y="-1305.84" font-family="Times,serif" font-size="14.00">GPU: 1,3,5,7</text>
<text text-anchor="middle" x="368.04" y="-1290.84" font-family="Times,serif" font-size="14.00">Input: [B,S]</text>
<text text-anchor="middle" x="368.04" y="-1275.84" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- input&#45;&gt;embed_tp1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;embed_tp1</title>
<path fill="none" stroke="black" d="M285.57,-1436.22C302.15,-1409.44 324.74,-1372.97 342.08,-1344.96"/>
<polygon fill="black" stroke="black" points="345.22,-1346.53 347.51,-1336.19 339.27,-1342.85 345.22,-1346.53"/>
</g>
<!-- embed_allreduce -->
<g id="node4" class="node">
<title>embed_allreduce</title>
<ellipse fill="none" stroke="black" cx="266.04" cy="-1119.87" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="266.04" y="-1138.67" font-family="Times,serif" font-size="14.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="266.04" y="-1123.67" font-family="Times,serif" font-size="14.00">GPUs: 0&#45;7</text>
<text text-anchor="middle" x="266.04" y="-1108.67" font-family="Times,serif" font-size="14.00">Input: [B,S,4096]</text>
<text text-anchor="middle" x="266.04" y="-1093.67" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- embed_tp0&#45;&gt;embed_allreduce -->
<g id="edge3" class="edge">
<title>embed_tp0&#45;&gt;embed_allreduce</title>
<path fill="none" stroke="black" d="M178.67,-1267.99C193.99,-1242.19 215.61,-1205.8 233.5,-1175.66"/>
<polygon fill="black" stroke="black" points="236.59,-1177.32 238.69,-1166.93 230.57,-1173.74 236.59,-1177.32"/>
</g>
<!-- embed_tp1&#45;&gt;embed_allreduce -->
<g id="edge4" class="edge">
<title>embed_tp1&#45;&gt;embed_allreduce</title>
<path fill="none" stroke="black" d="M349.34,-1267.99C334.73,-1242.19 314.12,-1205.8 297.06,-1175.66"/>
<polygon fill="black" stroke="black" points="300.1,-1173.91 292.12,-1166.93 294,-1177.36 300.1,-1173.91"/>
</g>
<!-- layer0_qkv_tp0 -->
<g id="node5" class="node">
<title>layer0_qkv_tp0</title>
<polygon fill="none" stroke="black" points="326.54,-971.7 153.54,-971.7 153.54,-903.7 326.54,-903.7 326.54,-971.7"/>
<text text-anchor="middle" x="240.04" y="-956.5" font-family="Times,serif" font-size="14.00">Layer 0 QKV Proj TP0</text>
<text text-anchor="middle" x="240.04" y="-941.5" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="240.04" y="-926.5" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="240.04" y="-911.5" font-family="Times,serif" font-size="14.00">Output: [B,S,4096]</text>
</g>
<!-- embed_allreduce&#45;&gt;layer0_qkv_tp0 -->
<g id="edge5" class="edge">
<title>embed_allreduce&#45;&gt;layer0_qkv_tp0</title>
<path fill="none" stroke="black" d="M259.21,-1071.53C255.2,-1043.71 250.16,-1008.79 246.26,-981.75"/>
<polygon fill="black" stroke="black" points="249.71,-981.19 244.82,-971.8 242.78,-982.19 249.71,-981.19"/>
</g>
<!-- layer0_qkv_tp1 -->
<g id="node6" class="node">
<title>layer0_qkv_tp1</title>
<polygon fill="none" stroke="black" points="557.54,-971.7 384.54,-971.7 384.54,-903.7 557.54,-903.7 557.54,-971.7"/>
<text text-anchor="middle" x="471.04" y="-956.5" font-family="Times,serif" font-size="14.00">Layer 0 QKV Proj TP1</text>
<text text-anchor="middle" x="471.04" y="-941.5" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="471.04" y="-926.5" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="471.04" y="-911.5" font-family="Times,serif" font-size="14.00">Output: [B,S,4096]</text>
</g>
<!-- embed_allreduce&#45;&gt;layer0_qkv_tp1 -->
<g id="edge6" class="edge">
<title>embed_allreduce&#45;&gt;layer0_qkv_tp1</title>
<path fill="none" stroke="black" d="M315.41,-1075.49C348.97,-1045.99 393.04,-1007.26 425.71,-978.54"/>
<polygon fill="black" stroke="black" points="428.14,-981.07 433.34,-971.84 423.52,-975.81 428.14,-981.07"/>
</g>
<!-- layer0_attn_allreduce -->
<g id="node7" class="node">
<title>layer0_attn_allreduce</title>
<ellipse fill="none" stroke="black" cx="331.04" cy="-755.54" rx="156.96" ry="48.17"/>
<text text-anchor="middle" x="331.04" y="-774.34" font-family="Times,serif" font-size="14.00">Layer 0 Attention All&#45;Reduce</text>
<text text-anchor="middle" x="331.04" y="-759.34" font-family="Times,serif" font-size="14.00">GPUs: 0&#45;1</text>
<text text-anchor="middle" x="331.04" y="-744.34" font-family="Times,serif" font-size="14.00">Input: [B,S,4096]</text>
<text text-anchor="middle" x="331.04" y="-729.34" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- layer0_qkv_tp0&#45;&gt;layer0_attn_allreduce -->
<g id="edge7" class="edge">
<title>layer0_qkv_tp0&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M256.73,-903.66C269.62,-878.16 287.73,-842.29 302.85,-812.36"/>
<polygon fill="black" stroke="black" points="306.05,-813.79 307.43,-803.28 299.8,-810.63 306.05,-813.79"/>
</g>
<!-- layer0_qkv_tp1&#45;&gt;layer0_attn_allreduce -->
<g id="edge8" class="edge">
<title>layer0_qkv_tp1&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M445.37,-903.66C425.15,-877.64 396.55,-840.84 373.02,-810.55"/>
<polygon fill="black" stroke="black" points="375.74,-808.35 366.84,-802.6 370.21,-812.64 375.74,-808.35"/>
</g>
<!-- layer0_ffn1_tp0 -->
<g id="node8" class="node">
<title>layer0_ffn1_tp0</title>
<polygon fill="none" stroke="black" points="345.04,-607.37 185.04,-607.37 185.04,-539.37 345.04,-539.37 345.04,-607.37"/>
<text text-anchor="middle" x="265.04" y="-592.17" font-family="Times,serif" font-size="14.00">Layer 0 FFN1 TP0</text>
<text text-anchor="middle" x="265.04" y="-577.17" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="265.04" y="-562.17" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="265.04" y="-547.17" font-family="Times,serif" font-size="14.00">Output: [B,S,16384]</text>
</g>
<!-- layer0_attn_allreduce&#45;&gt;layer0_ffn1_tp0 -->
<g id="edge9" class="edge">
<title>layer0_attn_allreduce&#45;&gt;layer0_ffn1_tp0</title>
<path fill="none" stroke="black" d="M313.88,-707.67C303.64,-679.72 290.73,-644.49 280.76,-617.27"/>
<polygon fill="black" stroke="black" points="283.96,-615.82 277.23,-607.64 277.38,-618.23 283.96,-615.82"/>
</g>
<!-- layer0_ffn1_tp1 -->
<g id="node9" class="node">
<title>layer0_ffn1_tp1</title>
<polygon fill="none" stroke="black" points="563.04,-607.37 403.04,-607.37 403.04,-539.37 563.04,-539.37 563.04,-607.37"/>
<text text-anchor="middle" x="483.04" y="-592.17" font-family="Times,serif" font-size="14.00">Layer 0 FFN1 TP1</text>
<text text-anchor="middle" x="483.04" y="-577.17" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="483.04" y="-562.17" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="483.04" y="-547.17" font-family="Times,serif" font-size="14.00">Output: [B,S,16384]</text>
</g>
<!-- layer0_attn_allreduce&#45;&gt;layer0_ffn1_tp1 -->
<g id="edge10" class="edge">
<title>layer0_attn_allreduce&#45;&gt;layer0_ffn1_tp1</title>
<path fill="none" stroke="black" d="M369.79,-708.61C394.05,-679.86 425.03,-643.13 448.46,-615.37"/>
<polygon fill="black" stroke="black" points="451.39,-617.32 455.16,-607.42 446.04,-612.81 451.39,-617.32"/>
</g>
<!-- layer0_ffn_allreduce -->
<g id="node10" class="node">
<title>layer0_ffn_allreduce</title>
<ellipse fill="none" stroke="black" cx="401.04" cy="-391.2" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="401.04" y="-410" font-family="Times,serif" font-size="14.00">Layer 0 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="401.04" y="-395" font-family="Times,serif" font-size="14.00">GPUs: 0&#45;1</text>
<text text-anchor="middle" x="401.04" y="-380" font-family="Times,serif" font-size="14.00">Input: [B,S,4096]</text>
<text text-anchor="middle" x="401.04" y="-365" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- layer0_ffn1_tp0&#45;&gt;layer0_ffn_allreduce -->
<g id="edge11" class="edge">
<title>layer0_ffn1_tp0&#45;&gt;layer0_ffn_allreduce</title>
<path fill="none" stroke="black" d="M289.99,-539.32C309.61,-513.32 337.37,-476.56 360.22,-446.28"/>
<polygon fill="black" stroke="black" points="363.3,-448.02 366.53,-437.93 357.71,-443.8 363.3,-448.02"/>
</g>
<!-- layer0_ffn1_tp1&#45;&gt;layer0_ffn_allreduce -->
<g id="edge12" class="edge">
<title>layer0_ffn1_tp1&#45;&gt;layer0_ffn_allreduce</title>
<path fill="none" stroke="black" d="M468,-539.32C456.45,-513.93 440.22,-478.27 426.63,-448.42"/>
<polygon fill="black" stroke="black" points="429.65,-446.6 422.32,-438.95 423.28,-449.5 429.65,-446.6"/>
</g>
<!-- layer19_qkv_tp0 -->
<g id="node11" class="node">
<title>layer19_qkv_tp0</title>
<polygon fill="none" stroke="black" points="818.04,-1507.6 636.04,-1507.6 636.04,-1439.6 818.04,-1439.6 818.04,-1507.6"/>
<text text-anchor="middle" x="727.04" y="-1492.4" font-family="Times,serif" font-size="14.00">Layer 19 QKV Proj TP0</text>
<text text-anchor="middle" x="727.04" y="-1477.4" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="727.04" y="-1462.4" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="727.04" y="-1447.4" font-family="Times,serif" font-size="14.00">Output: [B,S,4096]</text>
</g>
<!-- layer19_attn_allreduce -->
<g id="node13" class="node">
<title>layer19_attn_allreduce</title>
<ellipse fill="none" stroke="black" cx="966.04" cy="-1302.04" rx="163.18" ry="48.17"/>
<text text-anchor="middle" x="966.04" y="-1320.84" font-family="Times,serif" font-size="14.00">Layer 19 Attention All&#45;Reduce</text>
<text text-anchor="middle" x="966.04" y="-1305.84" font-family="Times,serif" font-size="14.00">GPUs: 0&#45;1</text>
<text text-anchor="middle" x="966.04" y="-1290.84" font-family="Times,serif" font-size="14.00">Input: [B,S,4096]</text>
<text text-anchor="middle" x="966.04" y="-1275.84" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- layer19_qkv_tp0&#45;&gt;layer19_attn_allreduce -->
<g id="edge13" class="edge">
<title>layer19_qkv_tp0&#45;&gt;layer19_attn_allreduce</title>
<path fill="none" stroke="black" d="M773.69,-1439.5C808.57,-1414.76 856.83,-1380.51 896.29,-1352.52"/>
<polygon fill="black" stroke="black" points="898.44,-1355.29 904.57,-1346.65 894.39,-1349.58 898.44,-1355.29"/>
</g>
<!-- layer19_qkv_tp1 -->
<g id="node12" class="node">
<title>layer19_qkv_tp1</title>
<polygon fill="none" stroke="black" points="1058.04,-1507.6 876.04,-1507.6 876.04,-1439.6 1058.04,-1439.6 1058.04,-1507.6"/>
<text text-anchor="middle" x="967.04" y="-1492.4" font-family="Times,serif" font-size="14.00">Layer 19 QKV Proj TP1</text>
<text text-anchor="middle" x="967.04" y="-1477.4" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="967.04" y="-1462.4" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="967.04" y="-1447.4" font-family="Times,serif" font-size="14.00">Output: [B,S,4096]</text>
</g>
<!-- layer19_qkv_tp1&#45;&gt;layer19_attn_allreduce -->
<g id="edge14" class="edge">
<title>layer19_qkv_tp1&#45;&gt;layer19_attn_allreduce</title>
<path fill="none" stroke="black" d="M966.85,-1439.5C966.72,-1417.04 966.54,-1386.75 966.38,-1360.41"/>
<polygon fill="black" stroke="black" points="969.88,-1360.14 966.32,-1350.16 962.88,-1360.18 969.88,-1360.14"/>
</g>
<!-- layer19_ffn1_tp0 -->
<g id="node14" class="node">
<title>layer19_ffn1_tp0</title>
<polygon fill="none" stroke="black" points="835.04,-1153.87 675.04,-1153.87 675.04,-1085.87 835.04,-1085.87 835.04,-1153.87"/>
<text text-anchor="middle" x="755.04" y="-1138.67" font-family="Times,serif" font-size="14.00">Layer 19 FFN1 TP0</text>
<text text-anchor="middle" x="755.04" y="-1123.67" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="755.04" y="-1108.67" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="755.04" y="-1093.67" font-family="Times,serif" font-size="14.00">Output: [B,S,16384]</text>
</g>
<!-- layer19_attn_allreduce&#45;&gt;layer19_ffn1_tp0 -->
<g id="edge15" class="edge">
<title>layer19_attn_allreduce&#45;&gt;layer19_ffn1_tp0</title>
<path fill="none" stroke="black" d="M913.62,-1256.27C879.27,-1226.94 834.77,-1188.94 801.65,-1160.67"/>
<polygon fill="black" stroke="black" points="803.8,-1157.9 793.92,-1154.07 799.25,-1163.22 803.8,-1157.9"/>
</g>
<!-- layer19_ffn1_tp1 -->
<g id="node15" class="node">
<title>layer19_ffn1_tp1</title>
<polygon fill="none" stroke="black" points="1053.04,-1153.87 893.04,-1153.87 893.04,-1085.87 1053.04,-1085.87 1053.04,-1153.87"/>
<text text-anchor="middle" x="973.04" y="-1138.67" font-family="Times,serif" font-size="14.00">Layer 19 FFN1 TP1</text>
<text text-anchor="middle" x="973.04" y="-1123.67" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="973.04" y="-1108.67" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="973.04" y="-1093.67" font-family="Times,serif" font-size="14.00">Output: [B,S,16384]</text>
</g>
<!-- layer19_attn_allreduce&#45;&gt;layer19_ffn1_tp1 -->
<g id="edge16" class="edge">
<title>layer19_attn_allreduce&#45;&gt;layer19_ffn1_tp1</title>
<path fill="none" stroke="black" d="M967.88,-1253.7C968.96,-1225.99 970.31,-1191.27 971.36,-1164.27"/>
<polygon fill="black" stroke="black" points="974.87,-1164.09 971.76,-1153.96 967.87,-1163.82 974.87,-1164.09"/>
</g>
<!-- layer19_ffn_allreduce -->
<g id="node16" class="node">
<title>layer19_ffn_allreduce</title>
<ellipse fill="none" stroke="black" cx="886.04" cy="-937.7" rx="138.69" ry="48.17"/>
<text text-anchor="middle" x="886.04" y="-956.5" font-family="Times,serif" font-size="14.00">Layer 19 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="886.04" y="-941.5" font-family="Times,serif" font-size="14.00">GPUs: 0&#45;1</text>
<text text-anchor="middle" x="886.04" y="-926.5" font-family="Times,serif" font-size="14.00">Input: [B,S,4096]</text>
<text text-anchor="middle" x="886.04" y="-911.5" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- layer19_ffn1_tp0&#45;&gt;layer19_ffn_allreduce -->
<g id="edge17" class="edge">
<title>layer19_ffn1_tp0&#45;&gt;layer19_ffn_allreduce</title>
<path fill="none" stroke="black" d="M779.07,-1085.82C797.98,-1059.82 824.71,-1023.06 846.72,-992.78"/>
<polygon fill="black" stroke="black" points="849.75,-994.57 852.8,-984.43 844.08,-990.46 849.75,-994.57"/>
</g>
<!-- layer19_ffn1_tp1&#45;&gt;layer19_ffn_allreduce -->
<g id="edge18" class="edge">
<title>layer19_ffn1_tp1&#45;&gt;layer19_ffn_allreduce</title>
<path fill="none" stroke="black" d="M957.09,-1085.82C944.77,-1060.32 927.46,-1024.46 913,-994.53"/>
<polygon fill="black" stroke="black" points="916.12,-992.93 908.62,-985.45 909.81,-995.97 916.12,-992.93"/>
</g>
<!-- layer20_qkv_tp0 -->
<g id="node17" class="node">
<title>layer20_qkv_tp0</title>
<polygon fill="none" stroke="black" points="774.04,-789.54 592.04,-789.54 592.04,-721.54 774.04,-721.54 774.04,-789.54"/>
<text text-anchor="middle" x="683.04" y="-774.34" font-family="Times,serif" font-size="14.00">Layer 20 QKV Proj TP0</text>
<text text-anchor="middle" x="683.04" y="-759.34" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="683.04" y="-744.34" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="683.04" y="-729.34" font-family="Times,serif" font-size="14.00">Output: [B,S,4096]</text>
</g>
<!-- layer19_ffn_allreduce&#45;&gt;layer20_qkv_tp0 -->
<g id="edge19" class="edge">
<title>layer19_ffn_allreduce&#45;&gt;layer20_qkv_tp0</title>
<path fill="none" stroke="black" d="M836.38,-892.63C803.24,-863.21 760.02,-824.85 727.91,-796.36"/>
<polygon fill="black" stroke="black" points="730.22,-793.72 720.41,-789.7 725.57,-798.96 730.22,-793.72"/>
</g>
<!-- layer20_qkv_tp1 -->
<g id="node18" class="node">
<title>layer20_qkv_tp1</title>
<polygon fill="none" stroke="black" points="1014.04,-789.54 832.04,-789.54 832.04,-721.54 1014.04,-721.54 1014.04,-789.54"/>
<text text-anchor="middle" x="923.04" y="-774.34" font-family="Times,serif" font-size="14.00">Layer 20 QKV Proj TP1</text>
<text text-anchor="middle" x="923.04" y="-759.34" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="923.04" y="-744.34" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="923.04" y="-729.34" font-family="Times,serif" font-size="14.00">Output: [B,S,4096]</text>
</g>
<!-- layer19_ffn_allreduce&#45;&gt;layer20_qkv_tp1 -->
<g id="edge20" class="edge">
<title>layer19_ffn_allreduce&#45;&gt;layer20_qkv_tp1</title>
<path fill="none" stroke="black" d="M895.77,-889.37C901.48,-861.54 908.65,-826.63 914.2,-799.58"/>
<polygon fill="black" stroke="black" points="917.66,-800.13 916.25,-789.63 910.81,-798.72 917.66,-800.13"/>
</g>
<!-- layer20_attn_allreduce -->
<g id="node19" class="node">
<title>layer20_attn_allreduce</title>
<ellipse fill="none" stroke="black" cx="830.04" cy="-573.37" rx="163.18" ry="48.17"/>
<text text-anchor="middle" x="830.04" y="-592.17" font-family="Times,serif" font-size="14.00">Layer 20 Attention All&#45;Reduce</text>
<text text-anchor="middle" x="830.04" y="-577.17" font-family="Times,serif" font-size="14.00">GPUs: 2&#45;3</text>
<text text-anchor="middle" x="830.04" y="-562.17" font-family="Times,serif" font-size="14.00">Input: [B,S,4096]</text>
<text text-anchor="middle" x="830.04" y="-547.17" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- layer20_qkv_tp0&#45;&gt;layer20_attn_allreduce -->
<g id="edge21" class="edge">
<title>layer20_qkv_tp0&#45;&gt;layer20_attn_allreduce</title>
<path fill="none" stroke="black" d="M710.01,-721.49C731.23,-695.47 761.26,-658.67 785.97,-628.39"/>
<polygon fill="black" stroke="black" points="788.85,-630.4 792.46,-620.43 783.43,-625.97 788.85,-630.4"/>
</g>
<!-- layer20_qkv_tp1&#45;&gt;layer20_attn_allreduce -->
<g id="edge22" class="edge">
<title>layer20_qkv_tp1&#45;&gt;layer20_attn_allreduce</title>
<path fill="none" stroke="black" d="M905.99,-721.49C892.82,-695.99 874.31,-660.13 858.86,-630.2"/>
<polygon fill="black" stroke="black" points="861.87,-628.4 854.17,-621.11 855.65,-631.61 861.87,-628.4"/>
</g>
<!-- layer20_ffn1_tp0 -->
<g id="node20" class="node">
<title>layer20_ffn1_tp0</title>
<polygon fill="none" stroke="black" points="766.04,-425.2 606.04,-425.2 606.04,-357.2 766.04,-357.2 766.04,-425.2"/>
<text text-anchor="middle" x="686.04" y="-410" font-family="Times,serif" font-size="14.00">Layer 20 FFN1 TP0</text>
<text text-anchor="middle" x="686.04" y="-395" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="686.04" y="-380" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="686.04" y="-365" font-family="Times,serif" font-size="14.00">Output: [B,S,16384]</text>
</g>
<!-- layer20_attn_allreduce&#45;&gt;layer20_ffn1_tp0 -->
<g id="edge23" class="edge">
<title>layer20_attn_allreduce&#45;&gt;layer20_ffn1_tp0</title>
<path fill="none" stroke="black" d="M793.33,-526.44C770.35,-497.69 741,-460.96 718.81,-433.2"/>
<polygon fill="black" stroke="black" points="721.44,-430.88 712.46,-425.25 715.97,-435.25 721.44,-430.88"/>
</g>
<!-- layer20_ffn1_tp1 -->
<g id="node21" class="node">
<title>layer20_ffn1_tp1</title>
<polygon fill="none" stroke="black" points="984.04,-425.2 824.04,-425.2 824.04,-357.2 984.04,-357.2 984.04,-425.2"/>
<text text-anchor="middle" x="904.04" y="-410" font-family="Times,serif" font-size="14.00">Layer 20 FFN1 TP1</text>
<text text-anchor="middle" x="904.04" y="-395" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="904.04" y="-380" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="904.04" y="-365" font-family="Times,serif" font-size="14.00">Output: [B,S,16384]</text>
</g>
<!-- layer20_attn_allreduce&#45;&gt;layer20_ffn1_tp1 -->
<g id="edge24" class="edge">
<title>layer20_attn_allreduce&#45;&gt;layer20_ffn1_tp1</title>
<path fill="none" stroke="black" d="M849.29,-525.5C860.82,-497.43 875.37,-462.02 886.57,-434.75"/>
<polygon fill="black" stroke="black" points="889.82,-436.05 890.38,-425.47 883.34,-433.39 889.82,-436.05"/>
</g>
<!-- layer20_ffn_allreduce -->
<g id="node22" class="node">
<title>layer20_ffn_allreduce</title>
<ellipse fill="none" stroke="black" cx="839.04" cy="-209.04" rx="138.69" ry="48.17"/>
<text text-anchor="middle" x="839.04" y="-227.84" font-family="Times,serif" font-size="14.00">Layer 20 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="839.04" y="-212.84" font-family="Times,serif" font-size="14.00">GPUs: 2&#45;3</text>
<text text-anchor="middle" x="839.04" y="-197.84" font-family="Times,serif" font-size="14.00">Input: [B,S,4096]</text>
<text text-anchor="middle" x="839.04" y="-182.84" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- layer20_ffn1_tp0&#45;&gt;layer20_ffn_allreduce -->
<g id="edge25" class="edge">
<title>layer20_ffn1_tp0&#45;&gt;layer20_ffn_allreduce</title>
<path fill="none" stroke="black" d="M714.11,-357.16C736.36,-330.95 767.9,-293.81 793.73,-263.4"/>
<polygon fill="black" stroke="black" points="796.69,-265.31 800.5,-255.42 791.36,-260.78 796.69,-265.31"/>
</g>
<!-- layer20_ffn1_tp1&#45;&gt;layer20_ffn_allreduce -->
<g id="edge26" class="edge">
<title>layer20_ffn1_tp1&#45;&gt;layer20_ffn_allreduce</title>
<path fill="none" stroke="black" d="M892.12,-357.16C882.96,-331.77 870.09,-296.1 859.32,-266.25"/>
<polygon fill="black" stroke="black" points="862.59,-265 855.91,-256.78 856.01,-267.38 862.59,-265"/>
</g>
<!-- layer39_qkv_tp0 -->
<g id="node23" class="node">
<title>layer39_qkv_tp0</title>
<polygon fill="none" stroke="black" points="1300.04,-1507.6 1118.04,-1507.6 1118.04,-1439.6 1300.04,-1439.6 1300.04,-1507.6"/>
<text text-anchor="middle" x="1209.04" y="-1492.4" font-family="Times,serif" font-size="14.00">Layer 39 QKV Proj TP0</text>
<text text-anchor="middle" x="1209.04" y="-1477.4" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="1209.04" y="-1462.4" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="1209.04" y="-1447.4" font-family="Times,serif" font-size="14.00">Output: [B,S,4096]</text>
</g>
<!-- layer39_attn_allreduce -->
<g id="node25" class="node">
<title>layer39_attn_allreduce</title>
<ellipse fill="none" stroke="black" cx="1406.04" cy="-1302.04" rx="163.18" ry="48.17"/>
<text text-anchor="middle" x="1406.04" y="-1320.84" font-family="Times,serif" font-size="14.00">Layer 39 Attention All&#45;Reduce</text>
<text text-anchor="middle" x="1406.04" y="-1305.84" font-family="Times,serif" font-size="14.00">GPUs: 2&#45;3</text>
<text text-anchor="middle" x="1406.04" y="-1290.84" font-family="Times,serif" font-size="14.00">Input: [B,S,4096]</text>
<text text-anchor="middle" x="1406.04" y="-1275.84" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- layer39_qkv_tp0&#45;&gt;layer39_attn_allreduce -->
<g id="edge27" class="edge">
<title>layer39_qkv_tp0&#45;&gt;layer39_attn_allreduce</title>
<path fill="none" stroke="black" d="M1247.49,-1439.5C1275.59,-1415.32 1314.22,-1382.07 1346.31,-1354.45"/>
<polygon fill="black" stroke="black" points="1348.6,-1357.09 1353.9,-1347.92 1344.04,-1351.79 1348.6,-1357.09"/>
</g>
<!-- layer39_qkv_tp1 -->
<g id="node24" class="node">
<title>layer39_qkv_tp1</title>
<polygon fill="none" stroke="black" points="1540.04,-1507.6 1358.04,-1507.6 1358.04,-1439.6 1540.04,-1439.6 1540.04,-1507.6"/>
<text text-anchor="middle" x="1449.04" y="-1492.4" font-family="Times,serif" font-size="14.00">Layer 39 QKV Proj TP1</text>
<text text-anchor="middle" x="1449.04" y="-1477.4" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="1449.04" y="-1462.4" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="1449.04" y="-1447.4" font-family="Times,serif" font-size="14.00">Output: [B,S,4096]</text>
</g>
<!-- layer39_qkv_tp1&#45;&gt;layer39_attn_allreduce -->
<g id="edge28" class="edge">
<title>layer39_qkv_tp1&#45;&gt;layer39_attn_allreduce</title>
<path fill="none" stroke="black" d="M1440.65,-1439.5C1434.93,-1416.94 1427.21,-1386.48 1420.51,-1360.06"/>
<polygon fill="black" stroke="black" points="1423.85,-1358.99 1417.99,-1350.16 1417.06,-1360.72 1423.85,-1358.99"/>
</g>
<!-- layer39_ffn1_tp0 -->
<g id="node26" class="node">
<title>layer39_ffn1_tp0</title>
<polygon fill="none" stroke="black" points="1328.04,-1153.87 1168.04,-1153.87 1168.04,-1085.87 1328.04,-1085.87 1328.04,-1153.87"/>
<text text-anchor="middle" x="1248.04" y="-1138.67" font-family="Times,serif" font-size="14.00">Layer 39 FFN1 TP0</text>
<text text-anchor="middle" x="1248.04" y="-1123.67" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="1248.04" y="-1108.67" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="1248.04" y="-1093.67" font-family="Times,serif" font-size="14.00">Output: [B,S,16384]</text>
</g>
<!-- layer39_attn_allreduce&#45;&gt;layer39_ffn1_tp0 -->
<g id="edge29" class="edge">
<title>layer39_attn_allreduce&#45;&gt;layer39_ffn1_tp0</title>
<path fill="none" stroke="black" d="M1365.76,-1255.11C1340.44,-1226.23 1308.07,-1189.32 1283.68,-1161.51"/>
<polygon fill="black" stroke="black" points="1286.25,-1159.13 1277.03,-1153.92 1280.99,-1163.75 1286.25,-1159.13"/>
</g>
<!-- layer39_ffn1_tp1 -->
<g id="node27" class="node">
<title>layer39_ffn1_tp1</title>
<polygon fill="none" stroke="black" points="1546.04,-1153.87 1386.04,-1153.87 1386.04,-1085.87 1546.04,-1085.87 1546.04,-1153.87"/>
<text text-anchor="middle" x="1466.04" y="-1138.67" font-family="Times,serif" font-size="14.00">Layer 39 FFN1 TP1</text>
<text text-anchor="middle" x="1466.04" y="-1123.67" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="1466.04" y="-1108.67" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="1466.04" y="-1093.67" font-family="Times,serif" font-size="14.00">Output: [B,S,16384]</text>
</g>
<!-- layer39_attn_allreduce&#45;&gt;layer39_ffn1_tp1 -->
<g id="edge30" class="edge">
<title>layer39_attn_allreduce&#45;&gt;layer39_ffn1_tp1</title>
<path fill="none" stroke="black" d="M1421.65,-1254.17C1430.96,-1226.22 1442.69,-1190.99 1451.76,-1163.77"/>
<polygon fill="black" stroke="black" points="1455.13,-1164.73 1454.96,-1154.14 1448.48,-1162.52 1455.13,-1164.73"/>
</g>
<!-- layer39_ffn_allreduce -->
<g id="node28" class="node">
<title>layer39_ffn_allreduce</title>
<ellipse fill="none" stroke="black" cx="1380.04" cy="-937.7" rx="138.69" ry="48.17"/>
<text text-anchor="middle" x="1380.04" y="-956.5" font-family="Times,serif" font-size="14.00">Layer 39 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="1380.04" y="-941.5" font-family="Times,serif" font-size="14.00">GPUs: 2&#45;3</text>
<text text-anchor="middle" x="1380.04" y="-926.5" font-family="Times,serif" font-size="14.00">Input: [B,S,4096]</text>
<text text-anchor="middle" x="1380.04" y="-911.5" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- layer39_ffn1_tp0&#45;&gt;layer39_ffn_allreduce -->
<g id="edge31" class="edge">
<title>layer39_ffn1_tp0&#45;&gt;layer39_ffn_allreduce</title>
<path fill="none" stroke="black" d="M1272.25,-1085.82C1291.3,-1059.82 1318.24,-1023.06 1340.42,-992.78"/>
<polygon fill="black" stroke="black" points="1343.46,-994.56 1346.54,-984.43 1337.81,-990.43 1343.46,-994.56"/>
</g>
<!-- layer39_ffn1_tp1&#45;&gt;layer39_ffn_allreduce -->
<g id="edge32" class="edge">
<title>layer39_ffn1_tp1&#45;&gt;layer39_ffn_allreduce</title>
<path fill="none" stroke="black" d="M1450.27,-1085.82C1438.1,-1060.32 1420.98,-1024.46 1406.69,-994.53"/>
<polygon fill="black" stroke="black" points="1409.82,-992.96 1402.36,-985.45 1403.51,-995.98 1409.82,-992.96"/>
</g>
<!-- layer40_qkv_tp0 -->
<g id="node29" class="node">
<title>layer40_qkv_tp0</title>
<polygon fill="none" stroke="black" points="1277.04,-789.54 1095.04,-789.54 1095.04,-721.54 1277.04,-721.54 1277.04,-789.54"/>
<text text-anchor="middle" x="1186.04" y="-774.34" font-family="Times,serif" font-size="14.00">Layer 40 QKV Proj TP0</text>
<text text-anchor="middle" x="1186.04" y="-759.34" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="1186.04" y="-744.34" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="1186.04" y="-729.34" font-family="Times,serif" font-size="14.00">Output: [B,S,4096]</text>
</g>
<!-- layer39_ffn_allreduce&#45;&gt;layer40_qkv_tp0 -->
<g id="edge33" class="edge">
<title>layer39_ffn_allreduce&#45;&gt;layer40_qkv_tp0</title>
<path fill="none" stroke="black" d="M1332.09,-892.17C1300.64,-862.96 1259.87,-825.09 1229.39,-796.8"/>
<polygon fill="black" stroke="black" points="1231.59,-794.06 1221.88,-789.82 1226.83,-799.19 1231.59,-794.06"/>
</g>
<!-- layer40_qkv_tp1 -->
<g id="node30" class="node">
<title>layer40_qkv_tp1</title>
<polygon fill="none" stroke="black" points="1517.04,-789.54 1335.04,-789.54 1335.04,-721.54 1517.04,-721.54 1517.04,-789.54"/>
<text text-anchor="middle" x="1426.04" y="-774.34" font-family="Times,serif" font-size="14.00">Layer 40 QKV Proj TP1</text>
<text text-anchor="middle" x="1426.04" y="-759.34" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1426.04" y="-744.34" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="1426.04" y="-729.34" font-family="Times,serif" font-size="14.00">Output: [B,S,4096]</text>
</g>
<!-- layer39_ffn_allreduce&#45;&gt;layer40_qkv_tp1 -->
<g id="edge34" class="edge">
<title>layer39_ffn_allreduce&#45;&gt;layer40_qkv_tp1</title>
<path fill="none" stroke="black" d="M1392.13,-889.37C1399.23,-861.54 1408.15,-826.63 1415.05,-799.58"/>
<polygon fill="black" stroke="black" points="1418.51,-800.19 1417.59,-789.63 1411.73,-798.45 1418.51,-800.19"/>
</g>
<!-- layer40_attn_allreduce -->
<g id="node31" class="node">
<title>layer40_attn_allreduce</title>
<ellipse fill="none" stroke="black" cx="1388.04" cy="-573.37" rx="163.18" ry="48.17"/>
<text text-anchor="middle" x="1388.04" y="-592.17" font-family="Times,serif" font-size="14.00">Layer 40 Attention All&#45;Reduce</text>
<text text-anchor="middle" x="1388.04" y="-577.17" font-family="Times,serif" font-size="14.00">GPUs: 4&#45;5</text>
<text text-anchor="middle" x="1388.04" y="-562.17" font-family="Times,serif" font-size="14.00">Input: [B,S,4096]</text>
<text text-anchor="middle" x="1388.04" y="-547.17" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- layer40_qkv_tp0&#45;&gt;layer40_attn_allreduce -->
<g id="edge35" class="edge">
<title>layer40_qkv_tp0&#45;&gt;layer40_attn_allreduce</title>
<path fill="none" stroke="black" d="M1223.09,-721.49C1252.95,-694.86 1295.48,-656.92 1329.88,-626.25"/>
<polygon fill="black" stroke="black" points="1332.4,-628.69 1337.53,-619.42 1327.74,-623.46 1332.4,-628.69"/>
</g>
<!-- layer40_qkv_tp1&#45;&gt;layer40_attn_allreduce -->
<g id="edge36" class="edge">
<title>layer40_qkv_tp1&#45;&gt;layer40_attn_allreduce</title>
<path fill="none" stroke="black" d="M1419.07,-721.49C1413.76,-696.3 1406.32,-661 1400.05,-631.29"/>
<polygon fill="black" stroke="black" points="1403.46,-630.52 1397.98,-621.46 1396.61,-631.96 1403.46,-630.52"/>
</g>
<!-- layer40_ffn1_tp0 -->
<g id="node32" class="node">
<title>layer40_ffn1_tp0</title>
<polygon fill="none" stroke="black" points="1276.04,-425.2 1116.04,-425.2 1116.04,-357.2 1276.04,-357.2 1276.04,-425.2"/>
<text text-anchor="middle" x="1196.04" y="-410" font-family="Times,serif" font-size="14.00">Layer 40 FFN1 TP0</text>
<text text-anchor="middle" x="1196.04" y="-395" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="1196.04" y="-380" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="1196.04" y="-365" font-family="Times,serif" font-size="14.00">Output: [B,S,16384]</text>
</g>
<!-- layer40_attn_allreduce&#45;&gt;layer40_ffn1_tp0 -->
<g id="edge37" class="edge">
<title>layer40_attn_allreduce&#45;&gt;layer40_ffn1_tp0</title>
<path fill="none" stroke="black" d="M1340.09,-527.37C1308.96,-498.16 1268.75,-460.43 1238.73,-432.26"/>
<polygon fill="black" stroke="black" points="1241.02,-429.6 1231.33,-425.31 1236.23,-434.71 1241.02,-429.6"/>
</g>
<!-- layer40_ffn1_tp1 -->
<g id="node33" class="node">
<title>layer40_ffn1_tp1</title>
<polygon fill="none" stroke="black" points="1494.04,-425.2 1334.04,-425.2 1334.04,-357.2 1494.04,-357.2 1494.04,-425.2"/>
<text text-anchor="middle" x="1414.04" y="-410" font-family="Times,serif" font-size="14.00">Layer 40 FFN1 TP1</text>
<text text-anchor="middle" x="1414.04" y="-395" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1414.04" y="-380" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="1414.04" y="-365" font-family="Times,serif" font-size="14.00">Output: [B,S,16384]</text>
</g>
<!-- layer40_attn_allreduce&#45;&gt;layer40_ffn1_tp1 -->
<g id="edge38" class="edge">
<title>layer40_attn_allreduce&#45;&gt;layer40_ffn1_tp1</title>
<path fill="none" stroke="black" d="M1394.87,-525.03C1398.89,-497.21 1403.93,-462.3 1407.83,-435.25"/>
<polygon fill="black" stroke="black" points="1411.3,-435.69 1409.27,-425.3 1404.38,-434.7 1411.3,-435.69"/>
</g>
<!-- layer40_ffn_allreduce -->
<g id="node34" class="node">
<title>layer40_ffn_allreduce</title>
<ellipse fill="none" stroke="black" cx="1260.04" cy="-209.04" rx="138.69" ry="48.17"/>
<text text-anchor="middle" x="1260.04" y="-227.84" font-family="Times,serif" font-size="14.00">Layer 40 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="1260.04" y="-212.84" font-family="Times,serif" font-size="14.00">GPUs: 4&#45;5</text>
<text text-anchor="middle" x="1260.04" y="-197.84" font-family="Times,serif" font-size="14.00">Input: [B,S,4096]</text>
<text text-anchor="middle" x="1260.04" y="-182.84" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- layer40_ffn1_tp0&#45;&gt;layer40_ffn_allreduce -->
<g id="edge39" class="edge">
<title>layer40_ffn1_tp0&#45;&gt;layer40_ffn_allreduce</title>
<path fill="none" stroke="black" d="M1207.78,-357.16C1216.8,-331.77 1229.47,-296.1 1240.08,-266.25"/>
<polygon fill="black" stroke="black" points="1243.39,-267.38 1243.44,-256.78 1236.79,-265.03 1243.39,-267.38"/>
</g>
<!-- layer40_ffn1_tp1&#45;&gt;layer40_ffn_allreduce -->
<g id="edge40" class="edge">
<title>layer40_ffn1_tp1&#45;&gt;layer40_ffn_allreduce</title>
<path fill="none" stroke="black" d="M1385.8,-357.16C1363.4,-330.95 1331.65,-293.81 1305.66,-263.4"/>
<polygon fill="black" stroke="black" points="1308,-260.75 1298.84,-255.42 1302.68,-265.3 1308,-260.75"/>
</g>
<!-- layer59_qkv_tp0 -->
<g id="node35" class="node">
<title>layer59_qkv_tp0</title>
<polygon fill="none" stroke="black" points="1781.04,-1507.6 1599.04,-1507.6 1599.04,-1439.6 1781.04,-1439.6 1781.04,-1507.6"/>
<text text-anchor="middle" x="1690.04" y="-1492.4" font-family="Times,serif" font-size="14.00">Layer 59 QKV Proj TP0</text>
<text text-anchor="middle" x="1690.04" y="-1477.4" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="1690.04" y="-1462.4" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="1690.04" y="-1447.4" font-family="Times,serif" font-size="14.00">Output: [B,S,4096]</text>
</g>
<!-- layer59_attn_allreduce -->
<g id="node37" class="node">
<title>layer59_attn_allreduce</title>
<ellipse fill="none" stroke="black" cx="1816.04" cy="-1302.04" rx="163.18" ry="48.17"/>
<text text-anchor="middle" x="1816.04" y="-1320.84" font-family="Times,serif" font-size="14.00">Layer 59 Attention All&#45;Reduce</text>
<text text-anchor="middle" x="1816.04" y="-1305.84" font-family="Times,serif" font-size="14.00">GPUs: 4&#45;5</text>
<text text-anchor="middle" x="1816.04" y="-1290.84" font-family="Times,serif" font-size="14.00">Input: [B,S,4096]</text>
<text text-anchor="middle" x="1816.04" y="-1275.84" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- layer59_qkv_tp0&#45;&gt;layer59_attn_allreduce -->
<g id="edge41" class="edge">
<title>layer59_qkv_tp0&#45;&gt;layer59_attn_allreduce</title>
<path fill="none" stroke="black" d="M1714.64,-1439.5C1731.97,-1416.18 1755.56,-1384.42 1775.64,-1357.41"/>
<polygon fill="black" stroke="black" points="1778.59,-1359.31 1781.74,-1349.2 1772.97,-1355.14 1778.59,-1359.31"/>
</g>
<!-- layer59_qkv_tp1 -->
<g id="node36" class="node">
<title>layer59_qkv_tp1</title>
<polygon fill="none" stroke="black" points="2021.04,-1507.6 1839.04,-1507.6 1839.04,-1439.6 2021.04,-1439.6 2021.04,-1507.6"/>
<text text-anchor="middle" x="1930.04" y="-1492.4" font-family="Times,serif" font-size="14.00">Layer 59 QKV Proj TP1</text>
<text text-anchor="middle" x="1930.04" y="-1477.4" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1930.04" y="-1462.4" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="1930.04" y="-1447.4" font-family="Times,serif" font-size="14.00">Output: [B,S,4096]</text>
</g>
<!-- layer59_qkv_tp1&#45;&gt;layer59_attn_allreduce -->
<g id="edge42" class="edge">
<title>layer59_qkv_tp1&#45;&gt;layer59_attn_allreduce</title>
<path fill="none" stroke="black" d="M1907.79,-1439.5C1892.24,-1416.37 1871.11,-1384.93 1853.04,-1358.06"/>
<polygon fill="black" stroke="black" points="1855.78,-1355.86 1847.29,-1349.52 1849.97,-1359.77 1855.78,-1355.86"/>
</g>
<!-- layer59_ffn1_tp0 -->
<g id="node38" class="node">
<title>layer59_ffn1_tp0</title>
<polygon fill="none" stroke="black" points="1793.04,-1153.87 1633.04,-1153.87 1633.04,-1085.87 1793.04,-1085.87 1793.04,-1153.87"/>
<text text-anchor="middle" x="1713.04" y="-1138.67" font-family="Times,serif" font-size="14.00">Layer 59 FFN1 TP0</text>
<text text-anchor="middle" x="1713.04" y="-1123.67" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="1713.04" y="-1108.67" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="1713.04" y="-1093.67" font-family="Times,serif" font-size="14.00">Output: [B,S,16384]</text>
</g>
<!-- layer59_attn_allreduce&#45;&gt;layer59_ffn1_tp0 -->
<g id="edge43" class="edge">
<title>layer59_attn_allreduce&#45;&gt;layer59_ffn1_tp0</title>
<path fill="none" stroke="black" d="M1789.25,-1254.17C1773.13,-1225.97 1752.78,-1190.38 1737.16,-1163.06"/>
<polygon fill="black" stroke="black" points="1740.06,-1161.08 1732.06,-1154.14 1733.99,-1164.56 1740.06,-1161.08"/>
</g>
<!-- layer59_ffn1_tp1 -->
<g id="node39" class="node">
<title>layer59_ffn1_tp1</title>
<polygon fill="none" stroke="black" points="2011.04,-1153.87 1851.04,-1153.87 1851.04,-1085.87 2011.04,-1085.87 2011.04,-1153.87"/>
<text text-anchor="middle" x="1931.04" y="-1138.67" font-family="Times,serif" font-size="14.00">Layer 59 FFN1 TP1</text>
<text text-anchor="middle" x="1931.04" y="-1123.67" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1931.04" y="-1108.67" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="1931.04" y="-1093.67" font-family="Times,serif" font-size="14.00">Output: [B,S,16384]</text>
</g>
<!-- layer59_attn_allreduce&#45;&gt;layer59_ffn1_tp1 -->
<g id="edge44" class="edge">
<title>layer59_attn_allreduce&#45;&gt;layer59_ffn1_tp1</title>
<path fill="none" stroke="black" d="M1845.66,-1254.64C1863.79,-1226.23 1886.81,-1190.16 1904.38,-1162.64"/>
<polygon fill="black" stroke="black" points="1907.45,-1164.34 1909.88,-1154.03 1901.55,-1160.58 1907.45,-1164.34"/>
</g>
<!-- layer59_ffn_allreduce -->
<g id="node40" class="node">
<title>layer59_ffn_allreduce</title>
<ellipse fill="none" stroke="black" cx="1765.04" cy="-937.7" rx="138.69" ry="48.17"/>
<text text-anchor="middle" x="1765.04" y="-956.5" font-family="Times,serif" font-size="14.00">Layer 59 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="1765.04" y="-941.5" font-family="Times,serif" font-size="14.00">GPUs: 4&#45;5</text>
<text text-anchor="middle" x="1765.04" y="-926.5" font-family="Times,serif" font-size="14.00">Input: [B,S,4096]</text>
<text text-anchor="middle" x="1765.04" y="-911.5" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- layer59_ffn1_tp0&#45;&gt;layer59_ffn_allreduce -->
<g id="edge45" class="edge">
<title>layer59_ffn1_tp0&#45;&gt;layer59_ffn_allreduce</title>
<path fill="none" stroke="black" d="M1722.58,-1085.82C1729.85,-1060.63 1740.04,-1025.33 1748.61,-995.63"/>
<polygon fill="black" stroke="black" points="1752.04,-996.37 1751.45,-985.79 1745.32,-994.43 1752.04,-996.37"/>
</g>
<!-- layer59_ffn1_tp1&#45;&gt;layer59_ffn_allreduce -->
<g id="edge46" class="edge">
<title>layer59_ffn1_tp1&#45;&gt;layer59_ffn_allreduce</title>
<path fill="none" stroke="black" d="M1900.6,-1085.82C1876.26,-1059.41 1841.69,-1021.89 1813.56,-991.36"/>
<polygon fill="black" stroke="black" points="1815.9,-988.73 1806.55,-983.75 1810.75,-993.48 1815.9,-988.73"/>
</g>
<!-- layer60_qkv_tp0 -->
<g id="node41" class="node">
<title>layer60_qkv_tp0</title>
<polygon fill="none" stroke="black" points="1768.04,-789.54 1586.04,-789.54 1586.04,-721.54 1768.04,-721.54 1768.04,-789.54"/>
<text text-anchor="middle" x="1677.04" y="-774.34" font-family="Times,serif" font-size="14.00">Layer 60 QKV Proj TP0</text>
<text text-anchor="middle" x="1677.04" y="-759.34" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="1677.04" y="-744.34" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="1677.04" y="-729.34" font-family="Times,serif" font-size="14.00">Output: [B,S,4096]</text>
</g>
<!-- layer59_ffn_allreduce&#45;&gt;layer60_qkv_tp0 -->
<g id="edge47" class="edge">
<title>layer59_ffn_allreduce&#45;&gt;layer60_qkv_tp0</title>
<path fill="none" stroke="black" d="M1742.15,-889.84C1728.44,-861.76 1711.14,-826.35 1697.83,-799.08"/>
<polygon fill="black" stroke="black" points="1700.83,-797.25 1693.29,-789.8 1694.54,-800.33 1700.83,-797.25"/>
</g>
<!-- layer60_qkv_tp1 -->
<g id="node42" class="node">
<title>layer60_qkv_tp1</title>
<polygon fill="none" stroke="black" points="2008.04,-789.54 1826.04,-789.54 1826.04,-721.54 2008.04,-721.54 2008.04,-789.54"/>
<text text-anchor="middle" x="1917.04" y="-774.34" font-family="Times,serif" font-size="14.00">Layer 60 QKV Proj TP1</text>
<text text-anchor="middle" x="1917.04" y="-759.34" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="1917.04" y="-744.34" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="1917.04" y="-729.34" font-family="Times,serif" font-size="14.00">Output: [B,S,4096]</text>
</g>
<!-- layer59_ffn_allreduce&#45;&gt;layer60_qkv_tp1 -->
<g id="edge48" class="edge">
<title>layer59_ffn_allreduce&#45;&gt;layer60_qkv_tp1</title>
<path fill="none" stroke="black" d="M1803.4,-891.24C1827.65,-862.49 1858.75,-825.63 1882.28,-797.74"/>
<polygon fill="black" stroke="black" points="1885.24,-799.66 1889.02,-789.76 1879.89,-795.14 1885.24,-799.66"/>
</g>
<!-- layer60_attn_allreduce -->
<g id="node43" class="node">
<title>layer60_attn_allreduce</title>
<ellipse fill="none" stroke="black" cx="1846.04" cy="-573.37" rx="163.18" ry="48.17"/>
<text text-anchor="middle" x="1846.04" y="-592.17" font-family="Times,serif" font-size="14.00">Layer 60 Attention All&#45;Reduce</text>
<text text-anchor="middle" x="1846.04" y="-577.17" font-family="Times,serif" font-size="14.00">GPUs: 6&#45;7</text>
<text text-anchor="middle" x="1846.04" y="-562.17" font-family="Times,serif" font-size="14.00">Input: [B,S,4096]</text>
<text text-anchor="middle" x="1846.04" y="-547.17" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- layer60_qkv_tp0&#45;&gt;layer60_attn_allreduce -->
<g id="edge49" class="edge">
<title>layer60_qkv_tp0&#45;&gt;layer60_attn_allreduce</title>
<path fill="none" stroke="black" d="M1708.04,-721.49C1732.64,-695.27 1767.51,-658.09 1796.04,-627.67"/>
<polygon fill="black" stroke="black" points="1798.86,-629.78 1803.15,-620.1 1793.76,-624.99 1798.86,-629.78"/>
</g>
<!-- layer60_qkv_tp1&#45;&gt;layer60_attn_allreduce -->
<g id="edge50" class="edge">
<title>layer60_qkv_tp1&#45;&gt;layer60_attn_allreduce</title>
<path fill="none" stroke="black" d="M1904.02,-721.49C1894.05,-696.19 1880.06,-660.69 1868.32,-630.91"/>
<polygon fill="black" stroke="black" points="1871.52,-629.48 1864.6,-621.46 1865.01,-632.04 1871.52,-629.48"/>
</g>
<!-- layer60_ffn1_tp0 -->
<g id="node44" class="node">
<title>layer60_ffn1_tp0</title>
<polygon fill="none" stroke="black" points="1744.04,-425.2 1584.04,-425.2 1584.04,-357.2 1744.04,-357.2 1744.04,-425.2"/>
<text text-anchor="middle" x="1664.04" y="-410" font-family="Times,serif" font-size="14.00">Layer 60 FFN1 TP0</text>
<text text-anchor="middle" x="1664.04" y="-395" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="1664.04" y="-380" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="1664.04" y="-365" font-family="Times,serif" font-size="14.00">Output: [B,S,16384]</text>
</g>
<!-- layer60_attn_allreduce&#45;&gt;layer60_ffn1_tp0 -->
<g id="edge51" class="edge">
<title>layer60_attn_allreduce&#45;&gt;layer60_ffn1_tp0</title>
<path fill="none" stroke="black" d="M1800.12,-526.91C1770.83,-497.91 1733.2,-460.67 1704.94,-432.69"/>
<polygon fill="black" stroke="black" points="1707.17,-429.97 1697.6,-425.43 1702.25,-434.95 1707.17,-429.97"/>
</g>
<!-- layer60_ffn1_tp1 -->
<g id="node45" class="node">
<title>layer60_ffn1_tp1</title>
<polygon fill="none" stroke="black" points="1962.04,-425.2 1802.04,-425.2 1802.04,-357.2 1962.04,-357.2 1962.04,-425.2"/>
<text text-anchor="middle" x="1882.04" y="-410" font-family="Times,serif" font-size="14.00">Layer 60 FFN1 TP1</text>
<text text-anchor="middle" x="1882.04" y="-395" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="1882.04" y="-380" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="1882.04" y="-365" font-family="Times,serif" font-size="14.00">Output: [B,S,16384]</text>
</g>
<!-- layer60_attn_allreduce&#45;&gt;layer60_ffn1_tp1 -->
<g id="edge52" class="edge">
<title>layer60_attn_allreduce&#45;&gt;layer60_ffn1_tp1</title>
<path fill="none" stroke="black" d="M1855.5,-525.03C1861.06,-497.21 1868.04,-462.3 1873.44,-435.25"/>
<polygon fill="black" stroke="black" points="1876.9,-435.79 1875.43,-425.3 1870.04,-434.42 1876.9,-435.79"/>
</g>
<!-- layer60_ffn_allreduce -->
<g id="node46" class="node">
<title>layer60_ffn_allreduce</title>
<ellipse fill="none" stroke="black" cx="1739.04" cy="-209.04" rx="138.69" ry="48.17"/>
<text text-anchor="middle" x="1739.04" y="-227.84" font-family="Times,serif" font-size="14.00">Layer 60 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="1739.04" y="-212.84" font-family="Times,serif" font-size="14.00">GPUs: 6&#45;7</text>
<text text-anchor="middle" x="1739.04" y="-197.84" font-family="Times,serif" font-size="14.00">Input: [B,S,4096]</text>
<text text-anchor="middle" x="1739.04" y="-182.84" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- layer60_ffn1_tp0&#45;&gt;layer60_ffn_allreduce -->
<g id="edge53" class="edge">
<title>layer60_ffn1_tp0&#45;&gt;layer60_ffn_allreduce</title>
<path fill="none" stroke="black" d="M1677.8,-357.16C1688.37,-331.77 1703.22,-296.1 1715.64,-266.25"/>
<polygon fill="black" stroke="black" points="1718.97,-267.36 1719.58,-256.78 1712.51,-264.67 1718.97,-267.36"/>
</g>
<!-- layer60_ffn1_tp1&#45;&gt;layer60_ffn_allreduce -->
<g id="edge54" class="edge">
<title>layer60_ffn1_tp1&#45;&gt;layer60_ffn_allreduce</title>
<path fill="none" stroke="black" d="M1855.82,-357.16C1835.09,-331.05 1805.75,-294.07 1781.66,-263.73"/>
<polygon fill="black" stroke="black" points="1784.29,-261.42 1775.34,-255.76 1778.81,-265.77 1784.29,-261.42"/>
</g>
<!-- layer79_qkv_tp0 -->
<g id="node47" class="node">
<title>layer79_qkv_tp0</title>
<polygon fill="none" stroke="black" points="2262.04,-1507.6 2080.04,-1507.6 2080.04,-1439.6 2262.04,-1439.6 2262.04,-1507.6"/>
<text text-anchor="middle" x="2171.04" y="-1492.4" font-family="Times,serif" font-size="14.00">Layer 79 QKV Proj TP0</text>
<text text-anchor="middle" x="2171.04" y="-1477.4" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="2171.04" y="-1462.4" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="2171.04" y="-1447.4" font-family="Times,serif" font-size="14.00">Output: [B,S,4096]</text>
</g>
<!-- layer79_attn_allreduce -->
<g id="node49" class="node">
<title>layer79_attn_allreduce</title>
<ellipse fill="none" stroke="black" cx="2213.04" cy="-1302.04" rx="163.18" ry="48.17"/>
<text text-anchor="middle" x="2213.04" y="-1320.84" font-family="Times,serif" font-size="14.00">Layer 79 Attention All&#45;Reduce</text>
<text text-anchor="middle" x="2213.04" y="-1305.84" font-family="Times,serif" font-size="14.00">GPUs: 6&#45;7</text>
<text text-anchor="middle" x="2213.04" y="-1290.84" font-family="Times,serif" font-size="14.00">Input: [B,S,4096]</text>
<text text-anchor="middle" x="2213.04" y="-1275.84" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- layer79_qkv_tp0&#45;&gt;layer79_attn_allreduce -->
<g id="edge55" class="edge">
<title>layer79_qkv_tp0&#45;&gt;layer79_attn_allreduce</title>
<path fill="none" stroke="black" d="M2179.24,-1439.5C2184.83,-1416.94 2192.37,-1386.48 2198.92,-1360.06"/>
<polygon fill="black" stroke="black" points="2202.36,-1360.71 2201.37,-1350.16 2195.57,-1359.03 2202.36,-1360.71"/>
</g>
<!-- layer79_qkv_tp1 -->
<g id="node48" class="node">
<title>layer79_qkv_tp1</title>
<polygon fill="none" stroke="black" points="2502.04,-1507.6 2320.04,-1507.6 2320.04,-1439.6 2502.04,-1439.6 2502.04,-1507.6"/>
<text text-anchor="middle" x="2411.04" y="-1492.4" font-family="Times,serif" font-size="14.00">Layer 79 QKV Proj TP1</text>
<text text-anchor="middle" x="2411.04" y="-1477.4" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="2411.04" y="-1462.4" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="2411.04" y="-1447.4" font-family="Times,serif" font-size="14.00">Output: [B,S,4096]</text>
</g>
<!-- layer79_qkv_tp1&#45;&gt;layer79_attn_allreduce -->
<g id="edge56" class="edge">
<title>layer79_qkv_tp1&#45;&gt;layer79_attn_allreduce</title>
<path fill="none" stroke="black" d="M2372.4,-1439.5C2344.16,-1415.32 2305.34,-1382.07 2273.08,-1354.45"/>
<polygon fill="black" stroke="black" points="2275.33,-1351.76 2265.45,-1347.92 2270.77,-1357.08 2275.33,-1351.76"/>
</g>
<!-- layer79_ffn1_tp0 -->
<g id="node50" class="node">
<title>layer79_ffn1_tp0</title>
<polygon fill="none" stroke="black" points="2243.04,-1153.87 2083.04,-1153.87 2083.04,-1085.87 2243.04,-1085.87 2243.04,-1153.87"/>
<text text-anchor="middle" x="2163.04" y="-1138.67" font-family="Times,serif" font-size="14.00">Layer 79 FFN1 TP0</text>
<text text-anchor="middle" x="2163.04" y="-1123.67" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="2163.04" y="-1108.67" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="2163.04" y="-1093.67" font-family="Times,serif" font-size="14.00">Output: [B,S,16384]</text>
</g>
<!-- layer79_attn_allreduce&#45;&gt;layer79_ffn1_tp0 -->
<g id="edge57" class="edge">
<title>layer79_attn_allreduce&#45;&gt;layer79_ffn1_tp0</title>
<path fill="none" stroke="black" d="M2199.91,-1253.7C2192.18,-1225.87 2182.5,-1190.96 2174.99,-1163.91"/>
<polygon fill="black" stroke="black" points="2178.27,-1162.66 2172.23,-1153.96 2171.53,-1164.54 2178.27,-1162.66"/>
</g>
<!-- layer79_ffn1_tp1 -->
<g id="node51" class="node">
<title>layer79_ffn1_tp1</title>
<polygon fill="none" stroke="black" points="2461.04,-1153.87 2301.04,-1153.87 2301.04,-1085.87 2461.04,-1085.87 2461.04,-1153.87"/>
<text text-anchor="middle" x="2381.04" y="-1138.67" font-family="Times,serif" font-size="14.00">Layer 79 FFN1 TP1</text>
<text text-anchor="middle" x="2381.04" y="-1123.67" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="2381.04" y="-1108.67" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="2381.04" y="-1093.67" font-family="Times,serif" font-size="14.00">Output: [B,S,16384]</text>
</g>
<!-- layer79_attn_allreduce&#45;&gt;layer79_ffn1_tp1 -->
<g id="edge58" class="edge">
<title>layer79_attn_allreduce&#45;&gt;layer79_ffn1_tp1</title>
<path fill="none" stroke="black" d="M2255.44,-1255.57C2282.36,-1226.7 2316.91,-1189.65 2342.96,-1161.71"/>
<polygon fill="black" stroke="black" points="2345.8,-1163.79 2350.06,-1154.09 2340.69,-1159.02 2345.8,-1163.79"/>
</g>
<!-- layer79_ffn_allreduce -->
<g id="node52" class="node">
<title>layer79_ffn_allreduce</title>
<ellipse fill="none" stroke="black" cx="2203.04" cy="-937.7" rx="138.69" ry="48.17"/>
<text text-anchor="middle" x="2203.04" y="-956.5" font-family="Times,serif" font-size="14.00">Layer 79 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="2203.04" y="-941.5" font-family="Times,serif" font-size="14.00">GPUs: 6&#45;7</text>
<text text-anchor="middle" x="2203.04" y="-926.5" font-family="Times,serif" font-size="14.00">Input: [B,S,4096]</text>
<text text-anchor="middle" x="2203.04" y="-911.5" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- layer79_ffn1_tp0&#45;&gt;layer79_ffn_allreduce -->
<g id="edge59" class="edge">
<title>layer79_ffn1_tp0&#45;&gt;layer79_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2170.38,-1085.82C2175.97,-1060.63 2183.81,-1025.33 2190.41,-995.63"/>
<polygon fill="black" stroke="black" points="2193.84,-996.31 2192.59,-985.79 2187.01,-994.79 2193.84,-996.31"/>
</g>
<!-- layer79_ffn1_tp1&#45;&gt;layer79_ffn_allreduce -->
<g id="edge60" class="edge">
<title>layer79_ffn1_tp1&#45;&gt;layer79_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2348.4,-1085.82C2322.1,-1059.21 2284.66,-1021.31 2254.36,-990.64"/>
<polygon fill="black" stroke="black" points="2256.74,-988.07 2247.22,-983.42 2251.76,-992.99 2256.74,-988.07"/>
</g>
<!-- final_ln_tp0 -->
<g id="node53" class="node">
<title>final_ln_tp0</title>
<polygon fill="none" stroke="black" points="2242.04,-789.54 2072.04,-789.54 2072.04,-721.54 2242.04,-721.54 2242.04,-789.54"/>
<text text-anchor="middle" x="2157.04" y="-774.34" font-family="Times,serif" font-size="14.00">Final LayerNorm TP0</text>
<text text-anchor="middle" x="2157.04" y="-759.34" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="2157.04" y="-744.34" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="2157.04" y="-729.34" font-family="Times,serif" font-size="14.00">Output: [B,S,4096]</text>
</g>
<!-- layer79_ffn_allreduce&#45;&gt;final_ln_tp0 -->
<g id="edge61" class="edge">
<title>layer79_ffn_allreduce&#45;&gt;final_ln_tp0</title>
<path fill="none" stroke="black" d="M2190.96,-889.37C2183.85,-861.54 2174.94,-826.63 2168.03,-799.58"/>
<polygon fill="black" stroke="black" points="2171.36,-798.45 2165.49,-789.63 2164.58,-800.19 2171.36,-798.45"/>
</g>
<!-- final_ln_tp1 -->
<g id="node54" class="node">
<title>final_ln_tp1</title>
<polygon fill="none" stroke="black" points="2470.04,-789.54 2300.04,-789.54 2300.04,-721.54 2470.04,-721.54 2470.04,-789.54"/>
<text text-anchor="middle" x="2385.04" y="-774.34" font-family="Times,serif" font-size="14.00">Final LayerNorm TP1</text>
<text text-anchor="middle" x="2385.04" y="-759.34" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="2385.04" y="-744.34" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="2385.04" y="-729.34" font-family="Times,serif" font-size="14.00">Output: [B,S,4096]</text>
</g>
<!-- layer79_ffn_allreduce&#45;&gt;final_ln_tp1 -->
<g id="edge62" class="edge">
<title>layer79_ffn_allreduce&#45;&gt;final_ln_tp1</title>
<path fill="none" stroke="black" d="M2248.03,-892.17C2277.41,-863.09 2315.46,-825.42 2344.01,-797.16"/>
<polygon fill="black" stroke="black" points="2346.78,-799.34 2351.42,-789.82 2341.85,-794.37 2346.78,-799.34"/>
</g>
<!-- final_allreduce -->
<g id="node55" class="node">
<title>final_allreduce</title>
<ellipse fill="none" stroke="black" cx="2193.04" cy="-573.37" rx="106.55" ry="48.17"/>
<text text-anchor="middle" x="2193.04" y="-592.17" font-family="Times,serif" font-size="14.00">Final All&#45;Reduce</text>
<text text-anchor="middle" x="2193.04" y="-577.17" font-family="Times,serif" font-size="14.00">GPUs: 6&#45;7</text>
<text text-anchor="middle" x="2193.04" y="-562.17" font-family="Times,serif" font-size="14.00">Input: [B,S,4096]</text>
<text text-anchor="middle" x="2193.04" y="-547.17" font-family="Times,serif" font-size="14.00">Output: [B,S,8192]</text>
</g>
<!-- final_ln_tp0&#45;&gt;final_allreduce -->
<g id="edge63" class="edge">
<title>final_ln_tp0&#45;&gt;final_allreduce</title>
<path fill="none" stroke="black" d="M2163.65,-721.49C2168.68,-696.3 2175.73,-661 2181.67,-631.29"/>
<polygon fill="black" stroke="black" points="2185.11,-631.95 2183.64,-621.46 2178.24,-630.58 2185.11,-631.95"/>
</g>
<!-- final_ln_tp1&#45;&gt;final_allreduce -->
<g id="edge64" class="edge">
<title>final_ln_tp1&#45;&gt;final_allreduce</title>
<path fill="none" stroke="black" d="M2349.83,-721.49C2320.74,-694.2 2279.01,-655.03 2245.91,-623.98"/>
<polygon fill="black" stroke="black" points="2248.24,-621.37 2238.56,-617.08 2243.45,-626.47 2248.24,-621.37"/>
</g>
<!-- output_proj_tp0 -->
<g id="node56" class="node">
<title>output_proj_tp0</title>
<polygon fill="none" stroke="black" points="2212.04,-425.2 2036.04,-425.2 2036.04,-357.2 2212.04,-357.2 2212.04,-425.2"/>
<text text-anchor="middle" x="2124.04" y="-410" font-family="Times,serif" font-size="14.00">Output Projection TP0</text>
<text text-anchor="middle" x="2124.04" y="-395" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="2124.04" y="-380" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="2124.04" y="-365" font-family="Times,serif" font-size="14.00">Output: [B,S,16000]</text>
</g>
<!-- final_allreduce&#45;&gt;output_proj_tp0 -->
<g id="edge65" class="edge">
<title>final_allreduce&#45;&gt;output_proj_tp0</title>
<path fill="none" stroke="black" d="M2175.09,-525.5C2164.39,-497.55 2150.9,-462.33 2140.48,-435.11"/>
<polygon fill="black" stroke="black" points="2143.63,-433.56 2136.78,-425.47 2137.09,-436.06 2143.63,-433.56"/>
</g>
<!-- output_proj_tp1 -->
<g id="node57" class="node">
<title>output_proj_tp1</title>
<polygon fill="none" stroke="black" points="2446.04,-425.2 2270.04,-425.2 2270.04,-357.2 2446.04,-357.2 2446.04,-425.2"/>
<text text-anchor="middle" x="2358.04" y="-410" font-family="Times,serif" font-size="14.00">Output Projection TP1</text>
<text text-anchor="middle" x="2358.04" y="-395" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="2358.04" y="-380" font-family="Times,serif" font-size="14.00">Input: [B,S,8192]</text>
<text text-anchor="middle" x="2358.04" y="-365" font-family="Times,serif" font-size="14.00">Output: [B,S,16000]</text>
</g>
<!-- final_allreduce&#45;&gt;output_proj_tp1 -->
<g id="edge66" class="edge">
<title>final_allreduce&#45;&gt;output_proj_tp1</title>
<path fill="none" stroke="black" d="M2232.99,-528.76C2259.78,-499.5 2294.81,-461.25 2320.98,-432.67"/>
<polygon fill="black" stroke="black" points="2323.6,-434.99 2327.77,-425.25 2318.44,-430.27 2323.6,-434.99"/>
</g>
<!-- output_allreduce -->
<g id="node58" class="node">
<title>output_allreduce</title>
<ellipse fill="none" stroke="black" cx="2241.04" cy="-209.04" rx="113.27" ry="48.17"/>
<text text-anchor="middle" x="2241.04" y="-227.84" font-family="Times,serif" font-size="14.00">Output All&#45;Reduce</text>
<text text-anchor="middle" x="2241.04" y="-212.84" font-family="Times,serif" font-size="14.00">GPUs: 6&#45;7</text>
<text text-anchor="middle" x="2241.04" y="-197.84" font-family="Times,serif" font-size="14.00">Input: [B,S,16000]</text>
<text text-anchor="middle" x="2241.04" y="-182.84" font-family="Times,serif" font-size="14.00">Output: [B,S,32000]</text>
</g>
<!-- output_proj_tp0&#45;&gt;output_allreduce -->
<g id="edge67" class="edge">
<title>output_proj_tp0&#45;&gt;output_allreduce</title>
<path fill="none" stroke="black" d="M2145.5,-357.16C2162.32,-331.27 2186.06,-294.7 2205.67,-264.5"/>
<polygon fill="black" stroke="black" points="2208.84,-266.06 2211.35,-255.76 2202.97,-262.24 2208.84,-266.06"/>
</g>
<!-- output_proj_tp1&#45;&gt;output_allreduce -->
<g id="edge68" class="edge">
<title>output_proj_tp1&#45;&gt;output_allreduce</title>
<path fill="none" stroke="black" d="M2336.58,-357.16C2319.77,-331.27 2296.03,-294.7 2276.41,-264.5"/>
<polygon fill="black" stroke="black" points="2279.12,-262.24 2270.74,-255.76 2273.25,-266.06 2279.12,-262.24"/>
</g>
<!-- output -->
<g id="node59" class="node">
<title>output</title>
<ellipse fill="white" stroke="black" cx="2241.04" cy="-37.48" rx="113.27" ry="37.45"/>
<text text-anchor="middle" x="2241.04" y="-48.78" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="2241.04" y="-33.78" font-family="Times,serif" font-size="14.00">Input: [B,S,32000]</text>
<text text-anchor="middle" x="2241.04" y="-18.78" font-family="Times,serif" font-size="14.00">Output: [B,S,32000]</text>
</g>
<!-- output_allreduce&#45;&gt;output -->
<g id="edge69" class="edge">
<title>output_allreduce&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2241.04,-160.8C2241.04,-137.16 2241.04,-108.63 2241.04,-85.08"/>
<polygon fill="black" stroke="black" points="2244.54,-84.98 2241.04,-74.98 2237.54,-84.98 2244.54,-84.98"/>
</g>
</g>
</svg>
