<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="15000pt" height="5776pt"
 viewBox="0.00 0.00 3600.00 1386.31" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(3.05 3.05) rotate(0) translate(4 1890.23)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1890.23 4915,-1890.23 4915,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="none" stroke="black" points="678,-1886.23 446,-1886.23 446,-1845.23 678,-1845.23 678,-1886.23"/>
<text text-anchor="middle" x="562" y="-1874.23" font-family="Arial" font-size="10.00">INPUT</text>
<text text-anchor="middle" x="562" y="-1863.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="562" y="-1852.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer0_norm_tp0 -->
<g id="node2" class="node">
<title>layer0_norm_tp0</title>
<polygon fill="none" stroke="black" points="767,-1773.23 535,-1773.23 535,-1721.23 767,-1721.23 767,-1773.23"/>
<text text-anchor="middle" x="651" y="-1761.23" font-family="Arial" font-size="10.00">Layer 0 RMSNorm</text>
<text text-anchor="middle" x="651" y="-1750.23" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="651" y="-1739.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="651" y="-1728.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- input&#45;&gt;layer0_norm_tp0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_norm_tp0</title>
<path fill="none" stroke="black" d="M577.1,-1844.97C590.35,-1827.63 609.9,-1802.04 625.56,-1781.54"/>
<polygon fill="black" stroke="black" points="628.49,-1783.46 631.78,-1773.39 622.93,-1779.21 628.49,-1783.46"/>
</g>
<!-- layer0_residual_tp0 -->
<g id="node9" class="node">
<title>layer0_residual_tp0</title>
<polygon fill="none" stroke="black" points="272,-1078.93 40,-1078.93 40,-1026.93 272,-1026.93 272,-1078.93"/>
<text text-anchor="middle" x="156" y="-1066.93" font-family="Arial" font-size="10.00">Layer 0 Residual Add</text>
<text text-anchor="middle" x="156" y="-1055.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="156" y="-1044.93" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="156" y="-1033.93" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- input&#45;&gt;layer0_residual_tp0 -->
<g id="edge9" class="edge">
<title>input&#45;&gt;layer0_residual_tp0</title>
<path fill="none" stroke="black" d="M445.86,-1854.63C324.02,-1840.74 150,-1810.07 150,-1748.23 150,-1748.23 150,-1748.23 150,-1213.47 150,-1170.76 152.17,-1121.66 153.9,-1089.34"/>
<polygon fill="black" stroke="black" points="157.42,-1089.24 154.47,-1079.06 150.43,-1088.85 157.42,-1089.24"/>
</g>
<!-- layer0_norm_tp1 -->
<g id="node18" class="node">
<title>layer0_norm_tp1</title>
<polygon fill="none" stroke="black" points="477,-1773.23 245,-1773.23 245,-1721.23 477,-1721.23 477,-1773.23"/>
<text text-anchor="middle" x="361" y="-1761.23" font-family="Arial" font-size="10.00">Layer 0 RMSNorm</text>
<text text-anchor="middle" x="361" y="-1750.23" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="361" y="-1739.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="361" y="-1728.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- input&#45;&gt;layer0_norm_tp1 -->
<g id="edge20" class="edge">
<title>input&#45;&gt;layer0_norm_tp1</title>
<path fill="none" stroke="black" d="M527.9,-1844.97C496.51,-1826.78 449.48,-1799.52 413.34,-1778.57"/>
<polygon fill="black" stroke="black" points="414.8,-1775.37 404.4,-1773.39 411.29,-1781.43 414.8,-1775.37"/>
</g>
<!-- layer0_residual_tp1 -->
<g id="node23" class="node">
<title>layer0_residual_tp1</title>
<polygon fill="none" stroke="black" points="962,-959.39 730,-959.39 730,-907.39 962,-907.39 962,-959.39"/>
<text text-anchor="middle" x="846" y="-947.39" font-family="Arial" font-size="10.00">Layer 0 Residual Add</text>
<text text-anchor="middle" x="846" y="-936.39" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="846" y="-925.39" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="846" y="-914.39" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- input&#45;&gt;layer0_residual_tp1 -->
<g id="edge28" class="edge">
<title>input&#45;&gt;layer0_residual_tp1</title>
<path fill="none" stroke="black" d="M657.43,-1845.19C741.61,-1825.11 851,-1790.84 851,-1748.23 851,-1748.23 851,-1748.23 851,-1051.93 851,-1024.3 849.6,-993.04 848.29,-969.71"/>
<polygon fill="black" stroke="black" points="851.77,-969.37 847.69,-959.59 844.78,-969.78 851.77,-969.37"/>
</g>
<!-- layer0_qkv_tp0 -->
<g id="node3" class="node">
<title>layer0_qkv_tp0</title>
<polygon fill="none" stroke="black" points="777.5,-1658.23 532.5,-1658.23 532.5,-1606.23 777.5,-1606.23 777.5,-1658.23"/>
<text text-anchor="middle" x="655" y="-1646.23" font-family="Arial" font-size="10.00">Layer 0 QKV Projection</text>
<text text-anchor="middle" x="655" y="-1635.23" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="655" y="-1624.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="655" y="-1613.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
</g>
<!-- layer0_norm_tp0&#45;&gt;layer0_qkv_tp0 -->
<g id="edge2" class="edge">
<title>layer0_norm_tp0&#45;&gt;layer0_qkv_tp0</title>
<path fill="none" stroke="black" d="M651.89,-1721.16C652.44,-1705.65 653.15,-1685.51 653.75,-1668.42"/>
<polygon fill="black" stroke="black" points="657.26,-1668.36 654.11,-1658.24 650.26,-1668.11 657.26,-1668.36"/>
</g>
<!-- layer0_attention_scores_tp0 -->
<g id="node4" class="node">
<title>layer0_attention_scores_tp0</title>
<polygon fill="none" stroke="black" points="822.5,-1569.23 509.5,-1569.23 509.5,-1517.23 822.5,-1517.23 822.5,-1569.23"/>
<text text-anchor="middle" x="666" y="-1557.23" font-family="Arial" font-size="10.00">Layer 0 Attention Scores</text>
<text text-anchor="middle" x="666" y="-1546.23" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="666" y="-1535.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
<text text-anchor="middle" x="666" y="-1524.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer0_qkv_tp0&#45;&gt;layer0_attention_scores_tp0 -->
<g id="edge3" class="edge">
<title>layer0_qkv_tp0&#45;&gt;layer0_attention_scores_tp0</title>
<path fill="none" stroke="black" d="M658.18,-1606.07C659.23,-1597.77 660.42,-1588.39 661.54,-1579.48"/>
<polygon fill="black" stroke="black" points="665.04,-1579.7 662.83,-1569.34 658.1,-1578.82 665.04,-1579.7"/>
</g>
<!-- layer0_attention_weights_tp0 -->
<g id="node5" class="node">
<title>layer0_attention_weights_tp0</title>
<polygon fill="none" stroke="black" points="822.5,-1480.23 509.5,-1480.23 509.5,-1428.23 822.5,-1428.23 822.5,-1480.23"/>
<text text-anchor="middle" x="666" y="-1468.23" font-family="Arial" font-size="10.00">Layer 0 Attention Weights</text>
<text text-anchor="middle" x="666" y="-1457.23" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="666" y="-1446.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="666" y="-1435.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer0_attention_scores_tp0&#45;&gt;layer0_attention_weights_tp0 -->
<g id="edge4" class="edge">
<title>layer0_attention_scores_tp0&#45;&gt;layer0_attention_weights_tp0</title>
<path fill="none" stroke="black" d="M666,-1517.07C666,-1508.77 666,-1499.39 666,-1490.48"/>
<polygon fill="black" stroke="black" points="669.5,-1490.34 666,-1480.34 662.5,-1490.34 669.5,-1490.34"/>
</g>
<!-- layer0_attention_output_tp0 -->
<g id="node6" class="node">
<title>layer0_attention_output_tp0</title>
<polygon fill="none" stroke="black" points="813.5,-1391.23 508.5,-1391.23 508.5,-1339.23 813.5,-1339.23 813.5,-1391.23"/>
<text text-anchor="middle" x="661" y="-1379.23" font-family="Arial" font-size="10.00">Layer 0 Attention Output</text>
<text text-anchor="middle" x="661" y="-1368.23" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="661" y="-1357.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="661" y="-1346.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer0_attention_weights_tp0&#45;&gt;layer0_attention_output_tp0 -->
<g id="edge5" class="edge">
<title>layer0_attention_weights_tp0&#45;&gt;layer0_attention_output_tp0</title>
<path fill="none" stroke="black" d="M664.55,-1428.07C664.08,-1419.77 663.54,-1410.39 663.03,-1401.48"/>
<polygon fill="black" stroke="black" points="666.51,-1401.12 662.44,-1391.34 659.52,-1401.53 666.51,-1401.12"/>
</g>
<!-- layer0_attention_allreduce_tp0 -->
<g id="node7" class="node">
<title>layer0_attention_allreduce_tp0</title>
<ellipse fill="none" stroke="black" cx="659" cy="-1214.47" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="659" y="-1228.47" font-family="Arial" font-size="10.00">Layer 0 Attention All&#45;Reduce</text>
<text text-anchor="middle" x="659" y="-1217.47" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="659" y="-1206.47" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="659" y="-1195.47" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer0_attention_output_tp0&#45;&gt;layer0_attention_allreduce_tp0 -->
<g id="edge6" class="edge">
<title>layer0_attention_output_tp0&#45;&gt;layer0_attention_allreduce_tp0</title>
<path fill="none" stroke="black" d="M660.66,-1339C660.38,-1317.87 659.96,-1287.16 659.62,-1261.65"/>
<polygon fill="black" stroke="black" points="663.12,-1261.39 659.48,-1251.44 656.12,-1261.49 663.12,-1261.39"/>
</g>
<!-- layer0_attention_allreduce_tp1 -->
<g id="node8" class="node">
<title>layer0_attention_allreduce_tp1</title>
<ellipse fill="none" stroke="black" cx="631" cy="-1052.93" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="631" y="-1066.93" font-family="Arial" font-size="10.00">Layer 0 Attention All&#45;Reduce</text>
<text text-anchor="middle" x="631" y="-1055.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="631" y="-1044.93" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="631" y="-1033.93" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer0_attention_allreduce_tp0&#45;&gt;layer0_attention_allreduce_tp1 -->
<g id="edge7" class="edge">
<title>layer0_attention_allreduce_tp0&#45;&gt;layer0_attention_allreduce_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M627.27,-1178.3C623.47,-1172.43 620.18,-1166.15 618,-1159.7 611.58,-1140.68 612.93,-1118.78 616.63,-1099.86"/>
<polygon fill="black" stroke="black" points="620.07,-1100.5 618.82,-1089.98 613.24,-1098.99 620.07,-1100.5"/>
<text text-anchor="middle" x="634.5" y="-1131.5" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer0_attention_allreduce_tp0&#45;&gt;layer0_residual_tp0 -->
<g id="edge8" class="edge">
<title>layer0_attention_allreduce_tp0&#45;&gt;layer0_residual_tp0</title>
<path fill="none" stroke="black" d="M566.16,-1184.02C474.4,-1154.92 335.04,-1110.71 244.74,-1082.07"/>
<polygon fill="black" stroke="black" points="245.66,-1078.69 235.07,-1079 243.54,-1085.36 245.66,-1078.69"/>
</g>
<!-- layer0_attention_allreduce_tp1&#45;&gt;layer0_attention_allreduce_tp0 -->
<g id="edge26" class="edge">
<title>layer0_attention_allreduce_tp1&#45;&gt;layer0_attention_allreduce_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M645.87,-1089.66C647.88,-1095.6 649.7,-1101.76 651,-1107.7 655.23,-1126.97 657.32,-1148.64 658.32,-1167.32"/>
<polygon fill="black" stroke="black" points="654.82,-1167.53 658.77,-1177.36 661.82,-1167.22 654.82,-1167.53"/>
<text text-anchor="middle" x="674.5" y="-1131.5" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer0_attention_allreduce_tp1&#45;&gt;layer0_residual_tp1 -->
<g id="edge27" class="edge">
<title>layer0_attention_allreduce_tp1&#45;&gt;layer0_residual_tp1</title>
<path fill="none" stroke="black" d="M691.75,-1018.72C722.92,-1001.67 760.61,-981.07 790.92,-964.5"/>
<polygon fill="black" stroke="black" points="792.99,-967.36 800.08,-959.49 789.63,-961.22 792.99,-967.36"/>
</g>
<!-- layer0_post_norm_tp0 -->
<g id="node10" class="node">
<title>layer0_post_norm_tp0</title>
<polygon fill="none" stroke="black" points="336,-959.39 104,-959.39 104,-907.39 336,-907.39 336,-959.39"/>
<text text-anchor="middle" x="220" y="-947.39" font-family="Arial" font-size="10.00">Layer 0 Post&#45;Attention RMSNorm</text>
<text text-anchor="middle" x="220" y="-936.39" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="220" y="-925.39" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="220" y="-914.39" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer0_residual_tp0&#45;&gt;layer0_post_norm_tp0 -->
<g id="edge10" class="edge">
<title>layer0_residual_tp0&#45;&gt;layer0_post_norm_tp0</title>
<path fill="none" stroke="black" d="M169.73,-1026.71C178.97,-1009.75 191.26,-987.17 201.38,-968.59"/>
<polygon fill="black" stroke="black" points="204.58,-970.02 206.29,-959.56 198.44,-966.67 204.58,-970.02"/>
</g>
<!-- layer0_final_residual_tp0 -->
<g id="node17" class="node">
<title>layer0_final_residual_tp0</title>
<polygon fill="none" stroke="black" points="232,-151.77 0,-151.77 0,-99.77 232,-99.77 232,-151.77"/>
<text text-anchor="middle" x="116" y="-139.77" font-family="Arial" font-size="10.00">Layer 0 Final Residual</text>
<text text-anchor="middle" x="116" y="-128.77" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="116" y="-117.77" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="116" y="-106.77" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer0_residual_tp0&#45;&gt;layer0_final_residual_tp0 -->
<g id="edge19" class="edge">
<title>layer0_residual_tp0&#45;&gt;layer0_final_residual_tp0</title>
<path fill="none" stroke="black" d="M118.73,-1026.91C92.11,-1005.76 61,-972.83 61,-934.39 61,-934.39 61,-934.39 61,-244.31 61,-213.88 76.31,-182.84 90.78,-160.3"/>
<polygon fill="black" stroke="black" points="93.81,-162.06 96.45,-151.8 87.99,-158.17 93.81,-162.06"/>
</g>
<!-- layer0_ffn_gate_tp0 -->
<g id="node11" class="node">
<title>layer0_ffn_gate_tp0</title>
<polygon fill="none" stroke="black" points="631,-859.62 369,-859.62 369,-807.62 631,-807.62 631,-859.62"/>
<text text-anchor="middle" x="500" y="-847.62" font-family="Arial" font-size="10.00">Layer 0 FFN Gate</text>
<text text-anchor="middle" x="500" y="-836.62" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="500" y="-825.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="500" y="-814.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer0_post_norm_tp0&#45;&gt;layer0_ffn_gate_tp0 -->
<g id="edge11" class="edge">
<title>layer0_post_norm_tp0&#45;&gt;layer0_ffn_gate_tp0</title>
<path fill="none" stroke="black" d="M291.74,-907.34C330.44,-893.82 378.36,-877.09 418.47,-863.09"/>
<polygon fill="black" stroke="black" points="419.67,-866.37 427.96,-859.77 417.36,-859.77 419.67,-866.37"/>
</g>
<!-- layer0_ffn_up_tp0 -->
<g id="node12" class="node">
<title>layer0_ffn_up_tp0</title>
<polygon fill="none" stroke="black" points="351,-859.62 89,-859.62 89,-807.62 351,-807.62 351,-859.62"/>
<text text-anchor="middle" x="220" y="-847.62" font-family="Arial" font-size="10.00">Layer 0 FFN Up</text>
<text text-anchor="middle" x="220" y="-836.62" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="220" y="-825.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="220" y="-814.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer0_post_norm_tp0&#45;&gt;layer0_ffn_up_tp0 -->
<g id="edge12" class="edge">
<title>layer0_post_norm_tp0&#45;&gt;layer0_ffn_up_tp0</title>
<path fill="none" stroke="black" d="M220,-907.21C220,-895.8 220,-882.13 220,-869.74"/>
<polygon fill="black" stroke="black" points="223.5,-869.71 220,-859.71 216.5,-869.71 223.5,-869.71"/>
</g>
<!-- layer0_ffn_activation_tp0 -->
<g id="node13" class="node">
<title>layer0_ffn_activation_tp0</title>
<polygon fill="none" stroke="black" points="351,-770.62 89,-770.62 89,-718.62 351,-718.62 351,-770.62"/>
<text text-anchor="middle" x="220" y="-758.62" font-family="Arial" font-size="10.00">Layer 0 FFN SwiGLU</text>
<text text-anchor="middle" x="220" y="-747.62" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="220" y="-736.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="220" y="-725.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer0_ffn_gate_tp0&#45;&gt;layer0_ffn_activation_tp0 -->
<g id="edge13" class="edge">
<title>layer0_ffn_gate_tp0&#45;&gt;layer0_ffn_activation_tp0</title>
<path fill="none" stroke="black" d="M419.39,-807.57C385.28,-796.97 345.39,-784.58 310.29,-773.67"/>
<polygon fill="black" stroke="black" points="311.12,-770.26 300.53,-770.64 309.04,-776.95 311.12,-770.26"/>
</g>
<!-- layer0_ffn_up_tp0&#45;&gt;layer0_ffn_activation_tp0 -->
<g id="edge14" class="edge">
<title>layer0_ffn_up_tp0&#45;&gt;layer0_ffn_activation_tp0</title>
<path fill="none" stroke="black" d="M220,-807.45C220,-799.16 220,-789.77 220,-780.87"/>
<polygon fill="black" stroke="black" points="223.5,-780.72 220,-770.72 216.5,-780.72 223.5,-780.72"/>
</g>
<!-- layer0_ffn_down_tp0 -->
<g id="node14" class="node">
<title>layer0_ffn_down_tp0</title>
<polygon fill="none" stroke="black" points="367,-611.62 113,-611.62 113,-559.62 367,-559.62 367,-611.62"/>
<text text-anchor="middle" x="240" y="-599.62" font-family="Arial" font-size="10.00">Layer 0 FFN Down</text>
<text text-anchor="middle" x="240" y="-588.62" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="240" y="-577.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="240" y="-566.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer0_ffn_activation_tp0&#45;&gt;layer0_ffn_down_tp0 -->
<g id="edge15" class="edge">
<title>layer0_ffn_activation_tp0&#45;&gt;layer0_ffn_down_tp0</title>
<path fill="none" stroke="black" d="M223.21,-718.39C226.54,-692.3 231.76,-651.34 235.49,-622.01"/>
<polygon fill="black" stroke="black" points="239,-622.14 236.79,-611.78 232.06,-621.26 239,-622.14"/>
</g>
<!-- layer0_ffn_allreduce_tp0 -->
<g id="node15" class="node">
<title>layer0_ffn_allreduce_tp0</title>
<ellipse fill="none" stroke="black" cx="253" cy="-245.31" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="253" y="-259.31" font-family="Arial" font-size="10.00">Layer 0 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="253" y="-248.31" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="253" y="-237.31" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="253" y="-226.31" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer0_ffn_down_tp0&#45;&gt;layer0_ffn_allreduce_tp0 -->
<g id="edge16" class="edge">
<title>layer0_ffn_down_tp0&#45;&gt;layer0_ffn_allreduce_tp0</title>
<path fill="none" stroke="black" d="M240.97,-559.47C243.14,-502.91 248.44,-364.99 251.22,-292.53"/>
<polygon fill="black" stroke="black" points="254.73,-292.45 251.62,-282.33 247.73,-292.19 254.73,-292.45"/>
</g>
<!-- layer0_ffn_allreduce_tp1 -->
<g id="node16" class="node">
<title>layer0_ffn_allreduce_tp1</title>
<ellipse fill="none" stroke="black" cx="470" cy="-364.85" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="470" y="-378.85" font-family="Arial" font-size="10.00">Layer 0 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="470" y="-367.85" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="470" y="-356.85" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="470" y="-345.85" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer0_ffn_allreduce_tp0&#45;&gt;layer0_ffn_allreduce_tp1 -->
<g id="edge17" class="edge">
<title>layer0_ffn_allreduce_tp0&#45;&gt;layer0_ffn_allreduce_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M282.77,-281.51C292.82,-291.78 304.65,-302.32 317,-310.08 330.33,-318.45 345.13,-325.73 360.13,-331.99"/>
<polygon fill="black" stroke="black" points="358.9,-335.27 369.48,-335.76 361.51,-328.78 358.9,-335.27"/>
<text text-anchor="middle" x="333.5" y="-302.88" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer0_ffn_allreduce_tp0&#45;&gt;layer0_final_residual_tp0 -->
<g id="edge18" class="edge">
<title>layer0_ffn_allreduce_tp0&#45;&gt;layer0_final_residual_tp0</title>
<path fill="none" stroke="black" d="M212.27,-209.36C193.66,-193.4 171.77,-174.62 153.56,-159"/>
<polygon fill="black" stroke="black" points="155.35,-155.92 145.48,-152.07 150.8,-161.23 155.35,-155.92"/>
</g>
<!-- layer0_ffn_allreduce_tp1&#45;&gt;layer0_ffn_allreduce_tp0 -->
<g id="edge36" class="edge">
<title>layer0_ffn_allreduce_tp1&#45;&gt;layer0_ffn_allreduce_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M408.69,-330.64C382,-316.18 350.58,-299.16 322.98,-284.21"/>
<polygon fill="black" stroke="black" points="324.62,-281.12 314.16,-279.44 321.29,-287.28 324.62,-281.12"/>
<text text-anchor="middle" x="385.5" y="-302.88" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer0_final_residual_tp1 -->
<g id="node29" class="node">
<title>layer0_final_residual_tp1</title>
<polygon fill="none" stroke="black" points="970,-271.31 738,-271.31 738,-219.31 970,-219.31 970,-271.31"/>
<text text-anchor="middle" x="854" y="-259.31" font-family="Arial" font-size="10.00">Layer 0 Final Residual</text>
<text text-anchor="middle" x="854" y="-248.31" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="854" y="-237.31" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="854" y="-226.31" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer0_ffn_allreduce_tp1&#45;&gt;layer0_final_residual_tp1 -->
<g id="edge37" class="edge">
<title>layer0_ffn_allreduce_tp1&#45;&gt;layer0_final_residual_tp1</title>
<path fill="none" stroke="black" d="M564.92,-334.79C625.2,-316.34 702.79,-292.59 762.41,-274.34"/>
<polygon fill="black" stroke="black" points="763.66,-277.62 772.2,-271.35 761.61,-270.93 763.66,-277.62"/>
</g>
<!-- layer0_qkv_tp1 -->
<g id="node19" class="node">
<title>layer0_qkv_tp1</title>
<polygon fill="none" stroke="black" points="463.5,-1658.23 218.5,-1658.23 218.5,-1606.23 463.5,-1606.23 463.5,-1658.23"/>
<text text-anchor="middle" x="341" y="-1646.23" font-family="Arial" font-size="10.00">Layer 0 QKV Projection</text>
<text text-anchor="middle" x="341" y="-1635.23" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="341" y="-1624.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="341" y="-1613.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
</g>
<!-- layer0_norm_tp1&#45;&gt;layer0_qkv_tp1 -->
<g id="edge21" class="edge">
<title>layer0_norm_tp1&#45;&gt;layer0_qkv_tp1</title>
<path fill="none" stroke="black" d="M356.56,-1721.16C353.82,-1705.65 350.25,-1685.51 347.23,-1668.42"/>
<polygon fill="black" stroke="black" points="350.62,-1667.48 345.43,-1658.24 343.72,-1668.7 350.62,-1667.48"/>
</g>
<!-- layer0_attention_scores_tp1 -->
<g id="node20" class="node">
<title>layer0_attention_scores_tp1</title>
<polygon fill="none" stroke="black" points="491.5,-1569.23 178.5,-1569.23 178.5,-1517.23 491.5,-1517.23 491.5,-1569.23"/>
<text text-anchor="middle" x="335" y="-1557.23" font-family="Arial" font-size="10.00">Layer 0 Attention Scores</text>
<text text-anchor="middle" x="335" y="-1546.23" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="335" y="-1535.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
<text text-anchor="middle" x="335" y="-1524.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer0_qkv_tp1&#45;&gt;layer0_attention_scores_tp1 -->
<g id="edge22" class="edge">
<title>layer0_qkv_tp1&#45;&gt;layer0_attention_scores_tp1</title>
<path fill="none" stroke="black" d="M339.26,-1606.07C338.69,-1597.77 338.05,-1588.39 337.43,-1579.48"/>
<polygon fill="black" stroke="black" points="340.91,-1579.08 336.73,-1569.34 333.93,-1579.56 340.91,-1579.08"/>
</g>
<!-- layer0_attention_weights_tp1 -->
<g id="node21" class="node">
<title>layer0_attention_weights_tp1</title>
<polygon fill="none" stroke="black" points="491.5,-1480.23 178.5,-1480.23 178.5,-1428.23 491.5,-1428.23 491.5,-1480.23"/>
<text text-anchor="middle" x="335" y="-1468.23" font-family="Arial" font-size="10.00">Layer 0 Attention Weights</text>
<text text-anchor="middle" x="335" y="-1457.23" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="335" y="-1446.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="335" y="-1435.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer0_attention_scores_tp1&#45;&gt;layer0_attention_weights_tp1 -->
<g id="edge23" class="edge">
<title>layer0_attention_scores_tp1&#45;&gt;layer0_attention_weights_tp1</title>
<path fill="none" stroke="black" d="M335,-1517.07C335,-1508.77 335,-1499.39 335,-1490.48"/>
<polygon fill="black" stroke="black" points="338.5,-1490.34 335,-1480.34 331.5,-1490.34 338.5,-1490.34"/>
</g>
<!-- layer0_attention_output_tp1 -->
<g id="node22" class="node">
<title>layer0_attention_output_tp1</title>
<polygon fill="none" stroke="black" points="569.5,-1321.23 264.5,-1321.23 264.5,-1269.23 569.5,-1269.23 569.5,-1321.23"/>
<text text-anchor="middle" x="417" y="-1309.23" font-family="Arial" font-size="10.00">Layer 0 Attention Output</text>
<text text-anchor="middle" x="417" y="-1298.23" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="417" y="-1287.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="417" y="-1276.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer0_attention_weights_tp1&#45;&gt;layer0_attention_output_tp1 -->
<g id="edge24" class="edge">
<title>layer0_attention_weights_tp1&#45;&gt;layer0_attention_output_tp1</title>
<path fill="none" stroke="black" d="M348.17,-1428.01C361.98,-1401.57 383.76,-1359.87 399.12,-1330.47"/>
<polygon fill="black" stroke="black" points="402.33,-1331.88 403.86,-1321.4 396.13,-1328.64 402.33,-1331.88"/>
</g>
<!-- layer0_attention_output_tp1&#45;&gt;layer0_attention_allreduce_tp1 -->
<g id="edge25" class="edge">
<title>layer0_attention_output_tp1&#45;&gt;layer0_attention_allreduce_tp1</title>
<path fill="none" stroke="black" d="M428.85,-1269.04C441.14,-1244.33 461.93,-1206.3 486,-1177.7 512.1,-1146.67 546.42,-1117 575.11,-1094.49"/>
<polygon fill="black" stroke="black" points="577.29,-1097.23 583.05,-1088.34 573,-1091.7 577.29,-1097.23"/>
</g>
<!-- layer0_post_norm_tp1 -->
<g id="node24" class="node">
<title>layer0_post_norm_tp1</title>
<polygon fill="none" stroke="black" points="896,-859.62 664,-859.62 664,-807.62 896,-807.62 896,-859.62"/>
<text text-anchor="middle" x="780" y="-847.62" font-family="Arial" font-size="10.00">Layer 0 Post&#45;Attention RMSNorm</text>
<text text-anchor="middle" x="780" y="-836.62" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="780" y="-825.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="780" y="-814.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer0_residual_tp1&#45;&gt;layer0_post_norm_tp1 -->
<g id="edge29" class="edge">
<title>layer0_residual_tp1&#45;&gt;layer0_post_norm_tp1</title>
<path fill="none" stroke="black" d="M829,-907.21C821,-895.35 811.33,-881.03 802.71,-868.26"/>
<polygon fill="black" stroke="black" points="805.44,-866.04 796.94,-859.71 799.63,-869.96 805.44,-866.04"/>
</g>
<!-- layer0_residual_tp1&#45;&gt;layer0_final_residual_tp1 -->
<g id="edge38" class="edge">
<title>layer0_residual_tp1&#45;&gt;layer0_final_residual_tp1</title>
<path fill="none" stroke="black" d="M890.59,-907.36C914.46,-890.38 939,-865.42 939,-834.62 939,-834.62 939,-834.62 939,-363.85 939,-330.36 916.07,-299.95 894.03,-278.46"/>
<polygon fill="black" stroke="black" points="896.31,-275.8 886.62,-271.52 891.52,-280.91 896.31,-275.8"/>
</g>
<!-- layer0_ffn_gate_tp1 -->
<g id="node25" class="node">
<title>layer0_ffn_gate_tp1</title>
<polygon fill="none" stroke="black" points="631,-770.62 369,-770.62 369,-718.62 631,-718.62 631,-770.62"/>
<text text-anchor="middle" x="500" y="-758.62" font-family="Arial" font-size="10.00">Layer 0 FFN Gate</text>
<text text-anchor="middle" x="500" y="-747.62" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="500" y="-736.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="500" y="-725.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer0_post_norm_tp1&#45;&gt;layer0_ffn_gate_tp1 -->
<g id="edge30" class="edge">
<title>layer0_post_norm_tp1&#45;&gt;layer0_ffn_gate_tp1</title>
<path fill="none" stroke="black" d="M699.39,-807.57C665.28,-796.97 625.39,-784.58 590.29,-773.67"/>
<polygon fill="black" stroke="black" points="591.12,-770.26 580.53,-770.64 589.04,-776.95 591.12,-770.26"/>
</g>
<!-- layer0_ffn_up_tp1 -->
<g id="node26" class="node">
<title>layer0_ffn_up_tp1</title>
<polygon fill="none" stroke="black" points="911,-770.62 649,-770.62 649,-718.62 911,-718.62 911,-770.62"/>
<text text-anchor="middle" x="780" y="-758.62" font-family="Arial" font-size="10.00">Layer 0 FFN Up</text>
<text text-anchor="middle" x="780" y="-747.62" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="780" y="-736.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="780" y="-725.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer0_post_norm_tp1&#45;&gt;layer0_ffn_up_tp1 -->
<g id="edge31" class="edge">
<title>layer0_post_norm_tp1&#45;&gt;layer0_ffn_up_tp1</title>
<path fill="none" stroke="black" d="M780,-807.45C780,-799.16 780,-789.77 780,-780.87"/>
<polygon fill="black" stroke="black" points="783.5,-780.72 780,-770.72 776.5,-780.72 783.5,-780.72"/>
</g>
<!-- layer0_ffn_activation_tp1 -->
<g id="node27" class="node">
<title>layer0_ffn_activation_tp1</title>
<polygon fill="none" stroke="black" points="631,-681.62 369,-681.62 369,-629.62 631,-629.62 631,-681.62"/>
<text text-anchor="middle" x="500" y="-669.62" font-family="Arial" font-size="10.00">Layer 0 FFN SwiGLU</text>
<text text-anchor="middle" x="500" y="-658.62" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="500" y="-647.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="500" y="-636.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer0_ffn_gate_tp1&#45;&gt;layer0_ffn_activation_tp1 -->
<g id="edge32" class="edge">
<title>layer0_ffn_gate_tp1&#45;&gt;layer0_ffn_activation_tp1</title>
<path fill="none" stroke="black" d="M500,-718.45C500,-710.16 500,-700.77 500,-691.87"/>
<polygon fill="black" stroke="black" points="503.5,-691.72 500,-681.72 496.5,-691.72 503.5,-691.72"/>
</g>
<!-- layer0_ffn_up_tp1&#45;&gt;layer0_ffn_activation_tp1 -->
<g id="edge33" class="edge">
<title>layer0_ffn_up_tp1&#45;&gt;layer0_ffn_activation_tp1</title>
<path fill="none" stroke="black" d="M699.39,-718.57C665.28,-707.97 625.39,-695.58 590.29,-684.67"/>
<polygon fill="black" stroke="black" points="591.12,-681.26 580.53,-681.64 589.04,-687.95 591.12,-681.26"/>
</g>
<!-- layer0_ffn_down_tp1 -->
<g id="node28" class="node">
<title>layer0_ffn_down_tp1</title>
<polygon fill="none" stroke="black" points="616,-541.62 362,-541.62 362,-489.62 616,-489.62 616,-541.62"/>
<text text-anchor="middle" x="489" y="-529.62" font-family="Arial" font-size="10.00">Layer 0 FFN Down</text>
<text text-anchor="middle" x="489" y="-518.62" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="489" y="-507.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="489" y="-496.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer0_ffn_activation_tp1&#45;&gt;layer0_ffn_down_tp1 -->
<g id="edge34" class="edge">
<title>layer0_ffn_activation_tp1&#45;&gt;layer0_ffn_down_tp1</title>
<path fill="none" stroke="black" d="M497.98,-629.31C496.25,-607.62 493.74,-576.14 491.82,-551.97"/>
<polygon fill="black" stroke="black" points="495.29,-551.46 491,-541.77 488.31,-552.01 495.29,-551.46"/>
</g>
<!-- layer0_ffn_down_tp1&#45;&gt;layer0_ffn_allreduce_tp1 -->
<g id="edge35" class="edge">
<title>layer0_ffn_down_tp1&#45;&gt;layer0_ffn_allreduce_tp1</title>
<path fill="none" stroke="black" d="M485.78,-489.38C483.08,-468.25 479.16,-437.54 475.9,-412.03"/>
<polygon fill="black" stroke="black" points="479.33,-411.3 474.59,-401.82 472.39,-412.19 479.33,-411.3"/>
</g>
<!-- pp_stage1_recv_tp0 -->
<g id="node30" class="node">
<title>pp_stage1_recv_tp0</title>
<polygon fill="none" stroke="black" points="1475.55,-1799.23 1092.89,-1799.23 994.45,-1695.23 1377.11,-1695.23 1475.55,-1799.23"/>
<text text-anchor="middle" x="1235" y="-1761.23" font-family="Arial" font-size="10.00">PP Stage 1 Receive</text>
<text text-anchor="middle" x="1235" y="-1750.23" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1235" y="-1739.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="1235" y="-1728.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer20_norm_tp0 -->
<g id="node34" class="node">
<title>layer20_norm_tp0</title>
<polygon fill="none" stroke="black" points="1470,-1658.23 1238,-1658.23 1238,-1606.23 1470,-1606.23 1470,-1658.23"/>
<text text-anchor="middle" x="1354" y="-1646.23" font-family="Arial" font-size="10.00">Layer 20 RMSNorm</text>
<text text-anchor="middle" x="1354" y="-1635.23" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1354" y="-1624.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="1354" y="-1613.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- pp_stage1_recv_tp0&#45;&gt;layer20_norm_tp0 -->
<g id="edge43" class="edge">
<title>pp_stage1_recv_tp0&#45;&gt;layer20_norm_tp0</title>
<path fill="none" stroke="black" d="M1288.93,-1695.02C1299.51,-1684.98 1310.32,-1674.71 1320.02,-1665.5"/>
<polygon fill="black" stroke="black" points="1322.69,-1667.79 1327.53,-1658.37 1317.87,-1662.71 1322.69,-1667.79"/>
</g>
<!-- layer20_residual_tp0 -->
<g id="node41" class="node">
<title>layer20_residual_tp0</title>
<polygon fill="none" stroke="black" points="1329,-959.39 1097,-959.39 1097,-907.39 1329,-907.39 1329,-959.39"/>
<text text-anchor="middle" x="1213" y="-947.39" font-family="Arial" font-size="10.00">Layer 20 Residual Add</text>
<text text-anchor="middle" x="1213" y="-936.39" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1213" y="-925.39" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="1213" y="-914.39" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- pp_stage1_recv_tp0&#45;&gt;layer20_residual_tp0 -->
<g id="edge51" class="edge">
<title>pp_stage1_recv_tp0&#45;&gt;layer20_residual_tp0</title>
<path fill="none" stroke="black" d="M1216.79,-1695.14C1211.45,-1675.98 1207,-1653.85 1207,-1633.23 1207,-1633.23 1207,-1633.23 1207,-1051.93 1207,-1024.28 1208.68,-993.03 1210.26,-969.71"/>
<polygon fill="black" stroke="black" points="1213.76,-969.81 1210.97,-959.59 1206.77,-969.32 1213.76,-969.81"/>
</g>
<!-- layer19_ffn_allreduce_tp0 -->
<g id="node31" class="node">
<title>layer19_ffn_allreduce_tp0</title>
<ellipse fill="none" stroke="black" cx="1340" cy="-1865.73" rx="74.52" ry="18"/>
<text text-anchor="middle" x="1340" y="-1863.23" font-family="Arial" font-size="10.00">layer19_ffn_allreduce_tp0</text>
</g>
<!-- layer19_ffn_allreduce_tp0&#45;&gt;pp_stage1_recv_tp0 -->
<g id="edge39" class="edge">
<title>layer19_ffn_allreduce_tp0&#45;&gt;pp_stage1_recv_tp0</title>
<path fill="none" stroke="black" d="M1283.39,-1853.89C1268.44,-1848.33 1253.77,-1839.93 1244,-1827.23 1239.97,-1821.99 1237.13,-1815.95 1235.18,-1809.58"/>
<polygon fill="black" stroke="black" points="1238.48,-1808.33 1232.8,-1799.38 1231.66,-1809.92 1238.48,-1808.33"/>
<text text-anchor="middle" x="1306" y="-1820.03" font-family="Arial" font-size="9.00">pipeline_send_gpu0_to_gpu2</text>
</g>
<!-- pp_stage1_recv_tp1 -->
<g id="node33" class="node">
<title>pp_stage1_recv_tp1</title>
<polygon fill="none" stroke="black" points="1974.55,-1799.23 1591.89,-1799.23 1493.45,-1695.23 1876.11,-1695.23 1974.55,-1799.23"/>
<text text-anchor="middle" x="1734" y="-1761.23" font-family="Arial" font-size="10.00">PP Stage 1 Receive</text>
<text text-anchor="middle" x="1734" y="-1750.23" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1734" y="-1739.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="1734" y="-1728.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer19_ffn_allreduce_tp0&#45;&gt;pp_stage1_recv_tp1 -->
<g id="edge41" class="edge">
<title>layer19_ffn_allreduce_tp0&#45;&gt;pp_stage1_recv_tp1</title>
<path fill="none" stroke="black" d="M1353.51,-1847.64C1362.69,-1837.22 1375.72,-1824.55 1390,-1817.23 1428.25,-1797.64 1442.84,-1807.55 1485,-1799.23 1510.83,-1794.14 1538.15,-1788.65 1564.86,-1783.23"/>
<polygon fill="black" stroke="black" points="1565.57,-1786.66 1574.67,-1781.23 1564.17,-1779.8 1565.57,-1786.66"/>
<text text-anchor="middle" x="1452" y="-1820.03" font-family="Arial" font-size="9.00">pipeline_send_gpu0_to_gpu3</text>
</g>
<!-- layer19_ffn_allreduce_tp1 -->
<g id="node32" class="node">
<title>layer19_ffn_allreduce_tp1</title>
<ellipse fill="none" stroke="black" cx="1600" cy="-1865.73" rx="74.52" ry="18"/>
<text text-anchor="middle" x="1600" y="-1863.23" font-family="Arial" font-size="10.00">layer19_ffn_allreduce_tp1</text>
</g>
<!-- layer19_ffn_allreduce_tp1&#45;&gt;pp_stage1_recv_tp0 -->
<g id="edge40" class="edge">
<title>layer19_ffn_allreduce_tp1&#45;&gt;pp_stage1_recv_tp0</title>
<path fill="none" stroke="black" d="M1576.17,-1848.48C1560.29,-1838.27 1538.61,-1825.52 1518,-1817.23 1504.94,-1811.99 1491.38,-1807.07 1477.57,-1802.46"/>
<polygon fill="black" stroke="black" points="1478.57,-1799.11 1467.98,-1799.32 1476.4,-1805.76 1478.57,-1799.11"/>
<text text-anchor="middle" x="1602" y="-1820.03" font-family="Arial" font-size="9.00">pipeline_send_gpu1_to_gpu2</text>
</g>
<!-- layer19_ffn_allreduce_tp1&#45;&gt;pp_stage1_recv_tp1 -->
<g id="edge42" class="edge">
<title>layer19_ffn_allreduce_tp1&#45;&gt;pp_stage1_recv_tp1</title>
<path fill="none" stroke="black" d="M1640.16,-1850.5C1653.41,-1844.6 1667.65,-1836.85 1679,-1827.23 1685.69,-1821.57 1691.95,-1814.9 1697.67,-1807.89"/>
<polygon fill="black" stroke="black" points="1700.78,-1809.59 1704.14,-1799.54 1695.25,-1805.3 1700.78,-1809.59"/>
<text text-anchor="middle" x="1751" y="-1820.03" font-family="Arial" font-size="9.00">pipeline_send_gpu1_to_gpu3</text>
</g>
<!-- layer20_norm_tp1 -->
<g id="node50" class="node">
<title>layer20_norm_tp1</title>
<polygon fill="none" stroke="black" points="1847,-1658.23 1615,-1658.23 1615,-1606.23 1847,-1606.23 1847,-1658.23"/>
<text text-anchor="middle" x="1731" y="-1646.23" font-family="Arial" font-size="10.00">Layer 20 RMSNorm</text>
<text text-anchor="middle" x="1731" y="-1635.23" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1731" y="-1624.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="1731" y="-1613.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- pp_stage1_recv_tp1&#45;&gt;layer20_norm_tp1 -->
<g id="edge62" class="edge">
<title>pp_stage1_recv_tp1&#45;&gt;layer20_norm_tp1</title>
<path fill="none" stroke="black" d="M1732.64,-1695.02C1732.4,-1686.07 1732.16,-1676.94 1731.94,-1668.55"/>
<polygon fill="black" stroke="black" points="1735.43,-1668.27 1731.67,-1658.37 1728.43,-1668.46 1735.43,-1668.27"/>
</g>
<!-- layer20_residual_tp1 -->
<g id="node55" class="node">
<title>layer20_residual_tp1</title>
<polygon fill="none" stroke="black" points="2022,-859.62 1790,-859.62 1790,-807.62 2022,-807.62 2022,-859.62"/>
<text text-anchor="middle" x="1906" y="-847.62" font-family="Arial" font-size="10.00">Layer 20 Residual Add</text>
<text text-anchor="middle" x="1906" y="-836.62" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1906" y="-825.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="1906" y="-814.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- pp_stage1_recv_tp1&#45;&gt;layer20_residual_tp1 -->
<g id="edge70" class="edge">
<title>pp_stage1_recv_tp1&#45;&gt;layer20_residual_tp1</title>
<path fill="none" stroke="black" d="M1874.45,-1695.21C1894.24,-1679.45 1908,-1659.17 1908,-1633.23 1908,-1633.23 1908,-1633.23 1908,-932.39 1908,-911.71 1907.55,-888.58 1907.07,-870.01"/>
<polygon fill="black" stroke="black" points="1910.57,-869.84 1906.8,-859.94 1903.57,-870.03 1910.57,-869.84"/>
</g>
<!-- layer20_qkv_tp0 -->
<g id="node35" class="node">
<title>layer20_qkv_tp0</title>
<polygon fill="none" stroke="black" points="1501.5,-1569.23 1256.5,-1569.23 1256.5,-1517.23 1501.5,-1517.23 1501.5,-1569.23"/>
<text text-anchor="middle" x="1379" y="-1557.23" font-family="Arial" font-size="10.00">Layer 20 QKV Projection</text>
<text text-anchor="middle" x="1379" y="-1546.23" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1379" y="-1535.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="1379" y="-1524.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
</g>
<!-- layer20_norm_tp0&#45;&gt;layer20_qkv_tp0 -->
<g id="edge44" class="edge">
<title>layer20_norm_tp0&#45;&gt;layer20_qkv_tp0</title>
<path fill="none" stroke="black" d="M1361.23,-1606.07C1363.64,-1597.68 1366.37,-1588.19 1368.95,-1579.19"/>
<polygon fill="black" stroke="black" points="1372.39,-1579.92 1371.79,-1569.34 1365.66,-1577.99 1372.39,-1579.92"/>
</g>
<!-- layer20_attention_scores_tp0 -->
<g id="node36" class="node">
<title>layer20_attention_scores_tp0</title>
<polygon fill="none" stroke="black" points="1548.5,-1480.23 1235.5,-1480.23 1235.5,-1428.23 1548.5,-1428.23 1548.5,-1480.23"/>
<text text-anchor="middle" x="1392" y="-1468.23" font-family="Arial" font-size="10.00">Layer 20 Attention Scores</text>
<text text-anchor="middle" x="1392" y="-1457.23" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1392" y="-1446.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
<text text-anchor="middle" x="1392" y="-1435.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer20_qkv_tp0&#45;&gt;layer20_attention_scores_tp0 -->
<g id="edge45" class="edge">
<title>layer20_qkv_tp0&#45;&gt;layer20_attention_scores_tp0</title>
<path fill="none" stroke="black" d="M1382.76,-1517.07C1384,-1508.77 1385.4,-1499.39 1386.73,-1490.48"/>
<polygon fill="black" stroke="black" points="1390.23,-1490.75 1388.25,-1480.34 1383.31,-1489.72 1390.23,-1490.75"/>
</g>
<!-- layer20_attention_weights_tp0 -->
<g id="node37" class="node">
<title>layer20_attention_weights_tp0</title>
<polygon fill="none" stroke="black" points="1548.5,-1391.23 1235.5,-1391.23 1235.5,-1339.23 1548.5,-1339.23 1548.5,-1391.23"/>
<text text-anchor="middle" x="1392" y="-1379.23" font-family="Arial" font-size="10.00">Layer 20 Attention Weights</text>
<text text-anchor="middle" x="1392" y="-1368.23" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1392" y="-1357.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="1392" y="-1346.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer20_attention_scores_tp0&#45;&gt;layer20_attention_weights_tp0 -->
<g id="edge46" class="edge">
<title>layer20_attention_scores_tp0&#45;&gt;layer20_attention_weights_tp0</title>
<path fill="none" stroke="black" d="M1392,-1428.07C1392,-1419.77 1392,-1410.39 1392,-1401.48"/>
<polygon fill="black" stroke="black" points="1395.5,-1401.34 1392,-1391.34 1388.5,-1401.34 1395.5,-1401.34"/>
</g>
<!-- layer20_attention_output_tp0 -->
<g id="node38" class="node">
<title>layer20_attention_output_tp0</title>
<polygon fill="none" stroke="black" points="1549.5,-1240.47 1244.5,-1240.47 1244.5,-1188.47 1549.5,-1188.47 1549.5,-1240.47"/>
<text text-anchor="middle" x="1397" y="-1228.47" font-family="Arial" font-size="10.00">Layer 20 Attention Output</text>
<text text-anchor="middle" x="1397" y="-1217.47" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1397" y="-1206.47" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="1397" y="-1195.47" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer20_attention_weights_tp0&#45;&gt;layer20_attention_output_tp0 -->
<g id="edge47" class="edge">
<title>layer20_attention_weights_tp0&#45;&gt;layer20_attention_output_tp0</title>
<path fill="none" stroke="black" d="M1392.85,-1339C1393.66,-1314.85 1394.89,-1278.18 1395.8,-1251.07"/>
<polygon fill="black" stroke="black" points="1399.31,-1250.94 1396.15,-1240.83 1392.31,-1250.7 1399.31,-1250.94"/>
</g>
<!-- layer20_attention_allreduce_tp0 -->
<g id="node39" class="node">
<title>layer20_attention_allreduce_tp0</title>
<ellipse fill="none" stroke="black" cx="1413" cy="-1052.93" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="1413" y="-1066.93" font-family="Arial" font-size="10.00">Layer 20 Attention All&#45;Reduce</text>
<text text-anchor="middle" x="1413" y="-1055.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1413" y="-1044.93" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="1413" y="-1033.93" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer20_attention_output_tp0&#45;&gt;layer20_attention_allreduce_tp0 -->
<g id="edge48" class="edge">
<title>layer20_attention_output_tp0&#45;&gt;layer20_attention_allreduce_tp0</title>
<path fill="none" stroke="black" d="M1399.54,-1188.19C1401.91,-1164.55 1405.5,-1128.7 1408.38,-1099.99"/>
<polygon fill="black" stroke="black" points="1411.89,-1100.06 1409.41,-1089.77 1404.93,-1099.37 1411.89,-1100.06"/>
</g>
<!-- layer20_attention_allreduce_tp1 -->
<g id="node40" class="node">
<title>layer20_attention_allreduce_tp1</title>
<ellipse fill="none" stroke="black" cx="1611" cy="-933.39" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="1611" y="-947.39" font-family="Arial" font-size="10.00">Layer 20 Attention All&#45;Reduce</text>
<text text-anchor="middle" x="1611" y="-936.39" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1611" y="-925.39" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="1611" y="-914.39" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer20_attention_allreduce_tp0&#45;&gt;layer20_attention_allreduce_tp1 -->
<g id="edge49" class="edge">
<title>layer20_attention_allreduce_tp0&#45;&gt;layer20_attention_allreduce_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1469.47,-1018.4C1493.19,-1004.32 1520.93,-987.85 1545.54,-973.25"/>
<polygon fill="black" stroke="black" points="1547.64,-976.07 1554.45,-967.96 1544.07,-970.05 1547.64,-976.07"/>
<text text-anchor="middle" x="1534.5" y="-990.96" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer20_attention_allreduce_tp0&#45;&gt;layer20_residual_tp0 -->
<g id="edge50" class="edge">
<title>layer20_attention_allreduce_tp0&#45;&gt;layer20_residual_tp0</title>
<path fill="none" stroke="black" d="M1355.96,-1018.4C1327.2,-1001.5 1292.6,-981.17 1264.64,-964.73"/>
<polygon fill="black" stroke="black" points="1266.2,-961.59 1255.81,-959.54 1262.66,-967.63 1266.2,-961.59"/>
</g>
<!-- layer20_attention_allreduce_tp1&#45;&gt;layer20_attention_allreduce_tp0 -->
<g id="edge68" class="edge">
<title>layer20_attention_allreduce_tp1&#45;&gt;layer20_attention_allreduce_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1584.65,-969.83C1575.78,-980 1565.25,-990.41 1554,-998.16 1542.71,-1005.93 1530.15,-1012.77 1517.31,-1018.73"/>
<polygon fill="black" stroke="black" points="1515.63,-1015.65 1507.92,-1022.92 1518.48,-1022.04 1515.63,-1015.65"/>
<text text-anchor="middle" x="1581.5" y="-990.96" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer20_attention_allreduce_tp1&#45;&gt;layer20_residual_tp1 -->
<g id="edge69" class="edge">
<title>layer20_attention_allreduce_tp1&#45;&gt;layer20_residual_tp1</title>
<path fill="none" stroke="black" d="M1701.11,-902.52C1739.06,-889.94 1783.02,-875.37 1820.47,-862.96"/>
<polygon fill="black" stroke="black" points="1821.95,-866.16 1830.34,-859.69 1819.75,-859.52 1821.95,-866.16"/>
</g>
<!-- layer20_post_norm_tp0 -->
<g id="node42" class="node">
<title>layer20_post_norm_tp0</title>
<polygon fill="none" stroke="black" points="1423,-859.62 1191,-859.62 1191,-807.62 1423,-807.62 1423,-859.62"/>
<text text-anchor="middle" x="1307" y="-847.62" font-family="Arial" font-size="10.00">Layer 20 Post&#45;Attention RMSNorm</text>
<text text-anchor="middle" x="1307" y="-836.62" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1307" y="-825.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="1307" y="-814.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer20_residual_tp0&#45;&gt;layer20_post_norm_tp0 -->
<g id="edge52" class="edge">
<title>layer20_residual_tp0&#45;&gt;layer20_post_norm_tp0</title>
<path fill="none" stroke="black" d="M1237.21,-907.21C1248.94,-895.01 1263.17,-880.2 1275.72,-867.16"/>
<polygon fill="black" stroke="black" points="1278.47,-869.34 1282.87,-859.71 1273.42,-864.49 1278.47,-869.34"/>
</g>
<!-- layer20_final_residual_tp0 -->
<g id="node49" class="node">
<title>layer20_final_residual_tp0</title>
<polygon fill="none" stroke="black" points="1275,-52 1043,-52 1043,0 1275,0 1275,-52"/>
<text text-anchor="middle" x="1159" y="-40" font-family="Arial" font-size="10.00">Layer 20 Final Residual</text>
<text text-anchor="middle" x="1159" y="-29" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1159" y="-18" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="1159" y="-7" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer20_residual_tp0&#45;&gt;layer20_final_residual_tp0 -->
<g id="edge61" class="edge">
<title>layer20_residual_tp0&#45;&gt;layer20_final_residual_tp0</title>
<path fill="none" stroke="black" d="M1184.3,-907.15C1166.89,-888.96 1148,-862.75 1148,-834.62 1148,-834.62 1148,-834.62 1148,-124.77 1148,-103.97 1150.49,-80.83 1153.1,-62.29"/>
<polygon fill="black" stroke="black" points="1156.59,-62.64 1154.59,-52.23 1149.66,-61.61 1156.59,-62.64"/>
</g>
<!-- layer20_ffn_gate_tp0 -->
<g id="node43" class="node">
<title>layer20_ffn_gate_tp0</title>
<polygon fill="none" stroke="black" points="1718,-770.62 1456,-770.62 1456,-718.62 1718,-718.62 1718,-770.62"/>
<text text-anchor="middle" x="1587" y="-758.62" font-family="Arial" font-size="10.00">Layer 20 FFN Gate</text>
<text text-anchor="middle" x="1587" y="-747.62" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1587" y="-736.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="1587" y="-725.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer20_post_norm_tp0&#45;&gt;layer20_ffn_gate_tp0 -->
<g id="edge53" class="edge">
<title>layer20_post_norm_tp0&#45;&gt;layer20_ffn_gate_tp0</title>
<path fill="none" stroke="black" d="M1387.61,-807.57C1421.72,-796.97 1461.61,-784.58 1496.71,-773.67"/>
<polygon fill="black" stroke="black" points="1497.96,-776.95 1506.47,-770.64 1495.88,-770.26 1497.96,-776.95"/>
</g>
<!-- layer20_ffn_up_tp0 -->
<g id="node44" class="node">
<title>layer20_ffn_up_tp0</title>
<polygon fill="none" stroke="black" points="1438,-770.62 1176,-770.62 1176,-718.62 1438,-718.62 1438,-770.62"/>
<text text-anchor="middle" x="1307" y="-758.62" font-family="Arial" font-size="10.00">Layer 20 FFN Up</text>
<text text-anchor="middle" x="1307" y="-747.62" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1307" y="-736.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="1307" y="-725.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer20_post_norm_tp0&#45;&gt;layer20_ffn_up_tp0 -->
<g id="edge54" class="edge">
<title>layer20_post_norm_tp0&#45;&gt;layer20_ffn_up_tp0</title>
<path fill="none" stroke="black" d="M1307,-807.45C1307,-799.16 1307,-789.77 1307,-780.87"/>
<polygon fill="black" stroke="black" points="1310.5,-780.72 1307,-770.72 1303.5,-780.72 1310.5,-780.72"/>
</g>
<!-- layer20_ffn_activation_tp0 -->
<g id="node45" class="node">
<title>layer20_ffn_activation_tp0</title>
<polygon fill="none" stroke="black" points="1438,-681.62 1176,-681.62 1176,-629.62 1438,-629.62 1438,-681.62"/>
<text text-anchor="middle" x="1307" y="-669.62" font-family="Arial" font-size="10.00">Layer 20 FFN SwiGLU</text>
<text text-anchor="middle" x="1307" y="-658.62" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1307" y="-647.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="1307" y="-636.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer20_ffn_gate_tp0&#45;&gt;layer20_ffn_activation_tp0 -->
<g id="edge55" class="edge">
<title>layer20_ffn_gate_tp0&#45;&gt;layer20_ffn_activation_tp0</title>
<path fill="none" stroke="black" d="M1506.39,-718.57C1472.28,-707.97 1432.39,-695.58 1397.29,-684.67"/>
<polygon fill="black" stroke="black" points="1398.12,-681.26 1387.53,-681.64 1396.04,-687.95 1398.12,-681.26"/>
</g>
<!-- layer20_ffn_up_tp0&#45;&gt;layer20_ffn_activation_tp0 -->
<g id="edge56" class="edge">
<title>layer20_ffn_up_tp0&#45;&gt;layer20_ffn_activation_tp0</title>
<path fill="none" stroke="black" d="M1307,-718.45C1307,-710.16 1307,-700.77 1307,-691.87"/>
<polygon fill="black" stroke="black" points="1310.5,-691.72 1307,-681.72 1303.5,-691.72 1310.5,-691.72"/>
</g>
<!-- layer20_ffn_down_tp0 -->
<g id="node46" class="node">
<title>layer20_ffn_down_tp0</title>
<polygon fill="none" stroke="black" points="1457,-471.62 1203,-471.62 1203,-419.62 1457,-419.62 1457,-471.62"/>
<text text-anchor="middle" x="1330" y="-459.62" font-family="Arial" font-size="10.00">Layer 20 FFN Down</text>
<text text-anchor="middle" x="1330" y="-448.62" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1330" y="-437.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="1330" y="-426.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer20_ffn_activation_tp0&#45;&gt;layer20_ffn_down_tp0 -->
<g id="edge57" class="edge">
<title>layer20_ffn_activation_tp0&#45;&gt;layer20_ffn_down_tp0</title>
<path fill="none" stroke="black" d="M1309.77,-629.53C1313.85,-592.67 1321.47,-523.74 1326.11,-481.83"/>
<polygon fill="black" stroke="black" points="1329.6,-482.12 1327.22,-471.8 1322.64,-481.35 1329.6,-482.12"/>
</g>
<!-- layer20_ffn_allreduce_tp0 -->
<g id="node47" class="node">
<title>layer20_ffn_allreduce_tp0</title>
<ellipse fill="none" stroke="black" cx="1440" cy="-125.77" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="1440" y="-139.77" font-family="Arial" font-size="10.00">Layer 20 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="1440" y="-128.77" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1440" y="-117.77" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="1440" y="-106.77" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer20_ffn_down_tp0&#45;&gt;layer20_ffn_allreduce_tp0 -->
<g id="edge58" class="edge">
<title>layer20_ffn_down_tp0&#45;&gt;layer20_ffn_allreduce_tp0</title>
<path fill="none" stroke="black" d="M1335.09,-419.55C1344.4,-375.77 1366.01,-282.94 1396,-208.54 1400.99,-196.15 1407.37,-183.21 1413.7,-171.38"/>
<polygon fill="black" stroke="black" points="1416.79,-173.03 1418.51,-162.57 1410.65,-169.67 1416.79,-173.03"/>
</g>
<!-- layer20_ffn_allreduce_tp1 -->
<g id="node48" class="node">
<title>layer20_ffn_allreduce_tp1</title>
<ellipse fill="none" stroke="black" cx="1569" cy="-245.31" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="1569" y="-259.31" font-family="Arial" font-size="10.00">Layer 20 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="1569" y="-248.31" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1569" y="-237.31" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="1569" y="-226.31" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer20_ffn_allreduce_tp0&#45;&gt;layer20_ffn_allreduce_tp1 -->
<g id="edge59" class="edge">
<title>layer20_ffn_allreduce_tp0&#45;&gt;layer20_ffn_allreduce_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1464.65,-162.19C1472.22,-171.91 1480.96,-182.08 1490,-190.54 1495.05,-195.26 1500.55,-199.87 1506.21,-204.27"/>
<polygon fill="black" stroke="black" points="1504.5,-207.37 1514.6,-210.57 1508.71,-201.77 1504.5,-207.37"/>
<text text-anchor="middle" x="1506.5" y="-183.34" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer20_ffn_allreduce_tp0&#45;&gt;layer20_final_residual_tp0 -->
<g id="edge60" class="edge">
<title>layer20_ffn_allreduce_tp0&#45;&gt;layer20_final_residual_tp0</title>
<path fill="none" stroke="black" d="M1353.01,-94.5C1317.21,-82.05 1275.96,-67.69 1240.72,-55.43"/>
<polygon fill="black" stroke="black" points="1241.55,-52.02 1230.95,-52.04 1239.25,-58.63 1241.55,-52.02"/>
</g>
<!-- layer20_ffn_allreduce_tp1&#45;&gt;layer20_ffn_allreduce_tp0 -->
<g id="edge78" class="edge">
<title>layer20_ffn_allreduce_tp1&#45;&gt;layer20_ffn_allreduce_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1546.82,-208.66C1539.86,-198.94 1531.7,-188.82 1523,-180.54 1517.78,-175.58 1512.05,-170.8 1506.1,-166.27"/>
<polygon fill="black" stroke="black" points="1508.04,-163.35 1497.9,-160.27 1503.9,-169 1508.04,-163.35"/>
<text text-anchor="middle" x="1548.5" y="-183.34" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer20_final_residual_tp1 -->
<g id="node61" class="node">
<title>layer20_final_residual_tp1</title>
<polygon fill="none" stroke="black" points="2004,-151.77 1772,-151.77 1772,-99.77 2004,-99.77 2004,-151.77"/>
<text text-anchor="middle" x="1888" y="-139.77" font-family="Arial" font-size="10.00">Layer 20 Final Residual</text>
<text text-anchor="middle" x="1888" y="-128.77" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1888" y="-117.77" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="1888" y="-106.77" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer20_ffn_allreduce_tp1&#45;&gt;layer20_final_residual_tp1 -->
<g id="edge79" class="edge">
<title>layer20_ffn_allreduce_tp1&#45;&gt;layer20_final_residual_tp1</title>
<path fill="none" stroke="black" d="M1652.4,-213.58C1701.37,-195.53 1762.86,-172.88 1810.73,-155.24"/>
<polygon fill="black" stroke="black" points="1811.95,-158.52 1820.12,-151.78 1809.53,-151.95 1811.95,-158.52"/>
</g>
<!-- layer20_qkv_tp1 -->
<g id="node51" class="node">
<title>layer20_qkv_tp1</title>
<polygon fill="none" stroke="black" points="1850.5,-1569.23 1605.5,-1569.23 1605.5,-1517.23 1850.5,-1517.23 1850.5,-1569.23"/>
<text text-anchor="middle" x="1728" y="-1557.23" font-family="Arial" font-size="10.00">Layer 20 QKV Projection</text>
<text text-anchor="middle" x="1728" y="-1546.23" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1728" y="-1535.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="1728" y="-1524.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
</g>
<!-- layer20_norm_tp1&#45;&gt;layer20_qkv_tp1 -->
<g id="edge63" class="edge">
<title>layer20_norm_tp1&#45;&gt;layer20_qkv_tp1</title>
<path fill="none" stroke="black" d="M1730.13,-1606.07C1729.85,-1597.77 1729.52,-1588.39 1729.22,-1579.48"/>
<polygon fill="black" stroke="black" points="1732.71,-1579.22 1728.87,-1569.34 1725.71,-1579.46 1732.71,-1579.22"/>
</g>
<!-- layer20_attention_scores_tp1 -->
<g id="node52" class="node">
<title>layer20_attention_scores_tp1</title>
<polygon fill="none" stroke="black" points="1879.5,-1480.23 1566.5,-1480.23 1566.5,-1428.23 1879.5,-1428.23 1879.5,-1480.23"/>
<text text-anchor="middle" x="1723" y="-1468.23" font-family="Arial" font-size="10.00">Layer 20 Attention Scores</text>
<text text-anchor="middle" x="1723" y="-1457.23" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1723" y="-1446.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
<text text-anchor="middle" x="1723" y="-1435.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer20_qkv_tp1&#45;&gt;layer20_attention_scores_tp1 -->
<g id="edge64" class="edge">
<title>layer20_qkv_tp1&#45;&gt;layer20_attention_scores_tp1</title>
<path fill="none" stroke="black" d="M1726.55,-1517.07C1726.08,-1508.77 1725.54,-1499.39 1725.03,-1490.48"/>
<polygon fill="black" stroke="black" points="1728.51,-1490.12 1724.44,-1480.34 1721.52,-1490.53 1728.51,-1490.12"/>
</g>
<!-- layer20_attention_weights_tp1 -->
<g id="node53" class="node">
<title>layer20_attention_weights_tp1</title>
<polygon fill="none" stroke="black" points="1879.5,-1391.23 1566.5,-1391.23 1566.5,-1339.23 1879.5,-1339.23 1879.5,-1391.23"/>
<text text-anchor="middle" x="1723" y="-1379.23" font-family="Arial" font-size="10.00">Layer 20 Attention Weights</text>
<text text-anchor="middle" x="1723" y="-1368.23" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1723" y="-1357.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="1723" y="-1346.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer20_attention_scores_tp1&#45;&gt;layer20_attention_weights_tp1 -->
<g id="edge65" class="edge">
<title>layer20_attention_scores_tp1&#45;&gt;layer20_attention_weights_tp1</title>
<path fill="none" stroke="black" d="M1723,-1428.07C1723,-1419.77 1723,-1410.39 1723,-1401.48"/>
<polygon fill="black" stroke="black" points="1726.5,-1401.34 1723,-1391.34 1719.5,-1401.34 1726.5,-1401.34"/>
</g>
<!-- layer20_attention_output_tp1 -->
<g id="node54" class="node">
<title>layer20_attention_output_tp1</title>
<polygon fill="none" stroke="black" points="1791.5,-1159.7 1486.5,-1159.7 1486.5,-1107.7 1791.5,-1107.7 1791.5,-1159.7"/>
<text text-anchor="middle" x="1639" y="-1147.7" font-family="Arial" font-size="10.00">Layer 20 Attention Output</text>
<text text-anchor="middle" x="1639" y="-1136.7" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1639" y="-1125.7" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="1639" y="-1114.7" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer20_attention_weights_tp1&#45;&gt;layer20_attention_output_tp1 -->
<g id="edge66" class="edge">
<title>layer20_attention_weights_tp1&#45;&gt;layer20_attention_output_tp1</title>
<path fill="none" stroke="black" d="M1713.85,-1339.23C1698.81,-1298.12 1668.81,-1216.15 1651.71,-1169.42"/>
<polygon fill="black" stroke="black" points="1654.99,-1168.2 1648.27,-1160.02 1648.42,-1170.61 1654.99,-1168.2"/>
</g>
<!-- layer20_attention_output_tp1&#45;&gt;layer20_attention_allreduce_tp1 -->
<g id="edge67" class="edge">
<title>layer20_attention_output_tp1&#45;&gt;layer20_attention_allreduce_tp1</title>
<path fill="none" stroke="black" d="M1635.45,-1107.58C1630.95,-1075.65 1623.08,-1019.93 1617.49,-980.32"/>
<polygon fill="black" stroke="black" points="1620.94,-979.78 1616.08,-970.37 1614.01,-980.76 1620.94,-979.78"/>
</g>
<!-- layer20_post_norm_tp1 -->
<g id="node56" class="node">
<title>layer20_post_norm_tp1</title>
<polygon fill="none" stroke="black" points="1983,-770.62 1751,-770.62 1751,-718.62 1983,-718.62 1983,-770.62"/>
<text text-anchor="middle" x="1867" y="-758.62" font-family="Arial" font-size="10.00">Layer 20 Post&#45;Attention RMSNorm</text>
<text text-anchor="middle" x="1867" y="-747.62" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1867" y="-736.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="1867" y="-725.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer20_residual_tp1&#45;&gt;layer20_post_norm_tp1 -->
<g id="edge71" class="edge">
<title>layer20_residual_tp1&#45;&gt;layer20_post_norm_tp1</title>
<path fill="none" stroke="black" d="M1894.72,-807.45C1890.88,-798.89 1886.52,-789.16 1882.41,-780"/>
<polygon fill="black" stroke="black" points="1885.54,-778.42 1878.26,-770.72 1879.15,-781.28 1885.54,-778.42"/>
</g>
<!-- layer20_residual_tp1&#45;&gt;layer20_final_residual_tp1 -->
<g id="edge80" class="edge">
<title>layer20_residual_tp1&#45;&gt;layer20_final_residual_tp1</title>
<path fill="none" stroke="black" d="M1978.92,-807.44C2004.05,-793.78 2026,-773.79 2026,-745.62 2026,-745.62 2026,-745.62 2026,-244.31 2026,-205.02 1993.18,-176.1 1959.55,-156.77"/>
<polygon fill="black" stroke="black" points="1960.99,-153.57 1950.54,-151.82 1957.62,-159.71 1960.99,-153.57"/>
</g>
<!-- layer20_ffn_gate_tp1 -->
<g id="node57" class="node">
<title>layer20_ffn_gate_tp1</title>
<polygon fill="none" stroke="black" points="1718,-681.62 1456,-681.62 1456,-629.62 1718,-629.62 1718,-681.62"/>
<text text-anchor="middle" x="1587" y="-669.62" font-family="Arial" font-size="10.00">Layer 20 FFN Gate</text>
<text text-anchor="middle" x="1587" y="-658.62" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1587" y="-647.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="1587" y="-636.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer20_post_norm_tp1&#45;&gt;layer20_ffn_gate_tp1 -->
<g id="edge72" class="edge">
<title>layer20_post_norm_tp1&#45;&gt;layer20_ffn_gate_tp1</title>
<path fill="none" stroke="black" d="M1786.39,-718.57C1752.28,-707.97 1712.39,-695.58 1677.29,-684.67"/>
<polygon fill="black" stroke="black" points="1678.12,-681.26 1667.53,-681.64 1676.04,-687.95 1678.12,-681.26"/>
</g>
<!-- layer20_ffn_up_tp1 -->
<g id="node58" class="node">
<title>layer20_ffn_up_tp1</title>
<polygon fill="none" stroke="black" points="1998,-681.62 1736,-681.62 1736,-629.62 1998,-629.62 1998,-681.62"/>
<text text-anchor="middle" x="1867" y="-669.62" font-family="Arial" font-size="10.00">Layer 20 FFN Up</text>
<text text-anchor="middle" x="1867" y="-658.62" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1867" y="-647.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="1867" y="-636.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer20_post_norm_tp1&#45;&gt;layer20_ffn_up_tp1 -->
<g id="edge73" class="edge">
<title>layer20_post_norm_tp1&#45;&gt;layer20_ffn_up_tp1</title>
<path fill="none" stroke="black" d="M1867,-718.45C1867,-710.16 1867,-700.77 1867,-691.87"/>
<polygon fill="black" stroke="black" points="1870.5,-691.72 1867,-681.72 1863.5,-691.72 1870.5,-691.72"/>
</g>
<!-- layer20_ffn_activation_tp1 -->
<g id="node59" class="node">
<title>layer20_ffn_activation_tp1</title>
<polygon fill="none" stroke="black" points="1718,-541.62 1456,-541.62 1456,-489.62 1718,-489.62 1718,-541.62"/>
<text text-anchor="middle" x="1587" y="-529.62" font-family="Arial" font-size="10.00">Layer 20 FFN SwiGLU</text>
<text text-anchor="middle" x="1587" y="-518.62" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1587" y="-507.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="1587" y="-496.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer20_ffn_gate_tp1&#45;&gt;layer20_ffn_activation_tp1 -->
<g id="edge74" class="edge">
<title>layer20_ffn_gate_tp1&#45;&gt;layer20_ffn_activation_tp1</title>
<path fill="none" stroke="black" d="M1587,-629.31C1587,-607.62 1587,-576.14 1587,-551.97"/>
<polygon fill="black" stroke="black" points="1590.5,-551.77 1587,-541.77 1583.5,-551.77 1590.5,-551.77"/>
</g>
<!-- layer20_ffn_up_tp1&#45;&gt;layer20_ffn_activation_tp1 -->
<g id="edge75" class="edge">
<title>layer20_ffn_up_tp1&#45;&gt;layer20_ffn_activation_tp1</title>
<path fill="none" stroke="black" d="M1815.97,-629.47C1768.45,-606.05 1697.58,-571.12 1647.29,-546.33"/>
<polygon fill="black" stroke="black" points="1648.67,-543.11 1638.15,-541.83 1645.58,-549.39 1648.67,-543.11"/>
</g>
<!-- layer20_ffn_down_tp1 -->
<g id="node60" class="node">
<title>layer20_ffn_down_tp1</title>
<polygon fill="none" stroke="black" points="1702,-390.85 1448,-390.85 1448,-338.85 1702,-338.85 1702,-390.85"/>
<text text-anchor="middle" x="1575" y="-378.85" font-family="Arial" font-size="10.00">Layer 20 FFN Down</text>
<text text-anchor="middle" x="1575" y="-367.85" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1575" y="-356.85" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="1575" y="-345.85" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer20_ffn_activation_tp1&#45;&gt;layer20_ffn_down_tp1 -->
<g id="edge76" class="edge">
<title>layer20_ffn_activation_tp1&#45;&gt;layer20_ffn_down_tp1</title>
<path fill="none" stroke="black" d="M1584.96,-489.38C1583.02,-465.23 1580.06,-428.57 1577.87,-401.45"/>
<polygon fill="black" stroke="black" points="1581.34,-400.89 1577.05,-391.21 1574.36,-401.46 1581.34,-400.89"/>
</g>
<!-- layer20_ffn_down_tp1&#45;&gt;layer20_ffn_allreduce_tp1 -->
<g id="edge77" class="edge">
<title>layer20_ffn_down_tp1&#45;&gt;layer20_ffn_allreduce_tp1</title>
<path fill="none" stroke="black" d="M1573.71,-338.63C1573.02,-325.13 1572.15,-308.08 1571.35,-292.31"/>
<polygon fill="black" stroke="black" points="1574.84,-291.99 1570.83,-282.19 1567.85,-292.35 1574.84,-291.99"/>
</g>
<!-- pp_stage2_recv_tp0 -->
<g id="node62" class="node">
<title>pp_stage2_recv_tp0</title>
<polygon fill="none" stroke="black" points="2476.55,-1799.23 2093.89,-1799.23 1995.45,-1695.23 2378.11,-1695.23 2476.55,-1799.23"/>
<text text-anchor="middle" x="2236" y="-1761.23" font-family="Arial" font-size="10.00">PP Stage 2 Receive</text>
<text text-anchor="middle" x="2236" y="-1750.23" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2236" y="-1739.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="2236" y="-1728.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer40_norm_tp0 -->
<g id="node66" class="node">
<title>layer40_norm_tp0</title>
<polygon fill="none" stroke="black" points="2453,-1658.23 2221,-1658.23 2221,-1606.23 2453,-1606.23 2453,-1658.23"/>
<text text-anchor="middle" x="2337" y="-1646.23" font-family="Arial" font-size="10.00">Layer 40 RMSNorm</text>
<text text-anchor="middle" x="2337" y="-1635.23" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2337" y="-1624.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="2337" y="-1613.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- pp_stage2_recv_tp0&#45;&gt;layer40_norm_tp0 -->
<g id="edge85" class="edge">
<title>pp_stage2_recv_tp0&#45;&gt;layer40_norm_tp0</title>
<path fill="none" stroke="black" d="M2281.77,-1695.02C2290.57,-1685.18 2299.57,-1675.12 2307.67,-1666.05"/>
<polygon fill="black" stroke="black" points="2310.48,-1668.15 2314.54,-1658.37 2305.26,-1663.49 2310.48,-1668.15"/>
</g>
<!-- layer40_residual_tp0 -->
<g id="node73" class="node">
<title>layer40_residual_tp0</title>
<polygon fill="none" stroke="black" points="2335,-959.39 2103,-959.39 2103,-907.39 2335,-907.39 2335,-959.39"/>
<text text-anchor="middle" x="2219" y="-947.39" font-family="Arial" font-size="10.00">Layer 40 Residual Add</text>
<text text-anchor="middle" x="2219" y="-936.39" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2219" y="-925.39" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="2219" y="-914.39" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- pp_stage2_recv_tp0&#45;&gt;layer40_residual_tp0 -->
<g id="edge93" class="edge">
<title>pp_stage2_recv_tp0&#45;&gt;layer40_residual_tp0</title>
<path fill="none" stroke="black" d="M2205.57,-1695.09C2197.02,-1676.29 2190,-1654.42 2190,-1633.23 2190,-1633.23 2190,-1633.23 2190,-1051.93 2190,-1023.55 2198.07,-992.41 2205.69,-969.31"/>
<polygon fill="black" stroke="black" points="2209.08,-970.22 2209.02,-959.62 2202.46,-967.94 2209.08,-970.22"/>
</g>
<!-- layer39_ffn_allreduce_tp0 -->
<g id="node63" class="node">
<title>layer39_ffn_allreduce_tp0</title>
<ellipse fill="none" stroke="black" cx="2324" cy="-1865.73" rx="74.52" ry="18"/>
<text text-anchor="middle" x="2324" y="-1863.23" font-family="Arial" font-size="10.00">layer39_ffn_allreduce_tp0</text>
</g>
<!-- layer39_ffn_allreduce_tp0&#45;&gt;pp_stage2_recv_tp0 -->
<g id="edge81" class="edge">
<title>layer39_ffn_allreduce_tp0&#45;&gt;pp_stage2_recv_tp0</title>
<path fill="none" stroke="black" d="M2295.21,-1849.04C2286.26,-1843.11 2276.93,-1835.72 2270,-1827.23 2265.39,-1821.59 2261.3,-1815.23 2257.7,-1808.62"/>
<polygon fill="black" stroke="black" points="2260.73,-1806.86 2253.1,-1799.51 2254.48,-1810.02 2260.73,-1806.86"/>
<text text-anchor="middle" x="2332" y="-1820.03" font-family="Arial" font-size="9.00">pipeline_send_gpu2_to_gpu4</text>
</g>
<!-- pp_stage2_recv_tp1 -->
<g id="node65" class="node">
<title>pp_stage2_recv_tp1</title>
<polygon fill="none" stroke="black" points="2975.55,-1799.23 2592.89,-1799.23 2494.45,-1695.23 2877.11,-1695.23 2975.55,-1799.23"/>
<text text-anchor="middle" x="2735" y="-1761.23" font-family="Arial" font-size="10.00">PP Stage 2 Receive</text>
<text text-anchor="middle" x="2735" y="-1750.23" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2735" y="-1739.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="2735" y="-1728.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer39_ffn_allreduce_tp0&#45;&gt;pp_stage2_recv_tp1 -->
<g id="edge83" class="edge">
<title>layer39_ffn_allreduce_tp0&#45;&gt;pp_stage2_recv_tp1</title>
<path fill="none" stroke="black" d="M2354.74,-1849.17C2375.79,-1838.99 2404.57,-1826.01 2431,-1817.23 2473.26,-1803.21 2519.76,-1791.07 2563.4,-1781.05"/>
<polygon fill="black" stroke="black" points="2564.28,-1784.44 2573.26,-1778.82 2562.73,-1777.62 2564.28,-1784.44"/>
<text text-anchor="middle" x="2493" y="-1820.03" font-family="Arial" font-size="9.00">pipeline_send_gpu2_to_gpu5</text>
</g>
<!-- layer39_ffn_allreduce_tp1 -->
<g id="node64" class="node">
<title>layer39_ffn_allreduce_tp1</title>
<ellipse fill="none" stroke="black" cx="2654" cy="-1865.73" rx="74.52" ry="18"/>
<text text-anchor="middle" x="2654" y="-1863.23" font-family="Arial" font-size="10.00">layer39_ffn_allreduce_tp1</text>
</g>
<!-- layer39_ffn_allreduce_tp1&#45;&gt;pp_stage2_recv_tp0 -->
<g id="edge82" class="edge">
<title>layer39_ffn_allreduce_tp1&#45;&gt;pp_stage2_recv_tp0</title>
<path fill="none" stroke="black" d="M2622.36,-1849.33C2594.74,-1835.93 2558.53,-1818.44 2555,-1817.23 2545.97,-1814.14 2519.57,-1807.89 2485.58,-1800.36"/>
<polygon fill="black" stroke="black" points="2486.32,-1796.94 2475.8,-1798.2 2484.81,-1803.78 2486.32,-1796.94"/>
<text text-anchor="middle" x="2639" y="-1820.03" font-family="Arial" font-size="9.00">pipeline_send_gpu3_to_gpu4</text>
</g>
<!-- layer39_ffn_allreduce_tp1&#45;&gt;pp_stage2_recv_tp1 -->
<g id="edge84" class="edge">
<title>layer39_ffn_allreduce_tp1&#45;&gt;pp_stage2_recv_tp1</title>
<path fill="none" stroke="black" d="M2681.38,-1848.94C2689.85,-1843.01 2698.62,-1835.63 2705,-1827.23 2709.33,-1821.53 2713.1,-1815.13 2716.37,-1808.51"/>
<polygon fill="black" stroke="black" points="2719.57,-1809.93 2720.52,-1799.38 2713.19,-1807.04 2719.57,-1809.93"/>
<text text-anchor="middle" x="2774" y="-1820.03" font-family="Arial" font-size="9.00">pipeline_send_gpu3_to_gpu5</text>
</g>
<!-- layer40_norm_tp1 -->
<g id="node82" class="node">
<title>layer40_norm_tp1</title>
<polygon fill="none" stroke="black" points="2841,-1658.23 2609,-1658.23 2609,-1606.23 2841,-1606.23 2841,-1658.23"/>
<text text-anchor="middle" x="2725" y="-1646.23" font-family="Arial" font-size="10.00">Layer 40 RMSNorm</text>
<text text-anchor="middle" x="2725" y="-1635.23" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2725" y="-1624.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="2725" y="-1613.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- pp_stage2_recv_tp1&#45;&gt;layer40_norm_tp1 -->
<g id="edge104" class="edge">
<title>pp_stage2_recv_tp1&#45;&gt;layer40_norm_tp1</title>
<path fill="none" stroke="black" d="M2730.47,-1695.02C2729.68,-1686.07 2728.87,-1676.94 2728.12,-1668.55"/>
<polygon fill="black" stroke="black" points="2731.59,-1668.02 2727.22,-1658.37 2724.62,-1668.64 2731.59,-1668.02"/>
</g>
<!-- layer40_residual_tp1 -->
<g id="node87" class="node">
<title>layer40_residual_tp1</title>
<polygon fill="none" stroke="black" points="2984,-859.62 2752,-859.62 2752,-807.62 2984,-807.62 2984,-859.62"/>
<text text-anchor="middle" x="2868" y="-847.62" font-family="Arial" font-size="10.00">Layer 40 Residual Add</text>
<text text-anchor="middle" x="2868" y="-836.62" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2868" y="-825.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="2868" y="-814.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- pp_stage2_recv_tp1&#45;&gt;layer40_residual_tp1 -->
<g id="edge112" class="edge">
<title>pp_stage2_recv_tp1&#45;&gt;layer40_residual_tp1</title>
<path fill="none" stroke="black" d="M2857.53,-1695.21C2877.07,-1679.2 2891,-1658.82 2891,-1633.23 2891,-1633.23 2891,-1633.23 2891,-932.39 2891,-911.2 2885.82,-888.1 2880.38,-869.68"/>
<polygon fill="black" stroke="black" points="2883.67,-868.48 2877.35,-859.97 2876.98,-870.55 2883.67,-868.48"/>
</g>
<!-- layer40_qkv_tp0 -->
<g id="node67" class="node">
<title>layer40_qkv_tp0</title>
<polygon fill="none" stroke="black" points="2484.5,-1569.23 2239.5,-1569.23 2239.5,-1517.23 2484.5,-1517.23 2484.5,-1569.23"/>
<text text-anchor="middle" x="2362" y="-1557.23" font-family="Arial" font-size="10.00">Layer 40 QKV Projection</text>
<text text-anchor="middle" x="2362" y="-1546.23" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2362" y="-1535.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="2362" y="-1524.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
</g>
<!-- layer40_norm_tp0&#45;&gt;layer40_qkv_tp0 -->
<g id="edge86" class="edge">
<title>layer40_norm_tp0&#45;&gt;layer40_qkv_tp0</title>
<path fill="none" stroke="black" d="M2344.23,-1606.07C2346.64,-1597.68 2349.37,-1588.19 2351.95,-1579.19"/>
<polygon fill="black" stroke="black" points="2355.39,-1579.92 2354.79,-1569.34 2348.66,-1577.99 2355.39,-1579.92"/>
</g>
<!-- layer40_attention_scores_tp0 -->
<g id="node68" class="node">
<title>layer40_attention_scores_tp0</title>
<polygon fill="none" stroke="black" points="2531.5,-1480.23 2218.5,-1480.23 2218.5,-1428.23 2531.5,-1428.23 2531.5,-1480.23"/>
<text text-anchor="middle" x="2375" y="-1468.23" font-family="Arial" font-size="10.00">Layer 40 Attention Scores</text>
<text text-anchor="middle" x="2375" y="-1457.23" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2375" y="-1446.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
<text text-anchor="middle" x="2375" y="-1435.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer40_qkv_tp0&#45;&gt;layer40_attention_scores_tp0 -->
<g id="edge87" class="edge">
<title>layer40_qkv_tp0&#45;&gt;layer40_attention_scores_tp0</title>
<path fill="none" stroke="black" d="M2365.76,-1517.07C2367,-1508.77 2368.4,-1499.39 2369.73,-1490.48"/>
<polygon fill="black" stroke="black" points="2373.23,-1490.75 2371.25,-1480.34 2366.31,-1489.72 2373.23,-1490.75"/>
</g>
<!-- layer40_attention_weights_tp0 -->
<g id="node69" class="node">
<title>layer40_attention_weights_tp0</title>
<polygon fill="none" stroke="black" points="2531.5,-1391.23 2218.5,-1391.23 2218.5,-1339.23 2531.5,-1339.23 2531.5,-1391.23"/>
<text text-anchor="middle" x="2375" y="-1379.23" font-family="Arial" font-size="10.00">Layer 40 Attention Weights</text>
<text text-anchor="middle" x="2375" y="-1368.23" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2375" y="-1357.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="2375" y="-1346.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer40_attention_scores_tp0&#45;&gt;layer40_attention_weights_tp0 -->
<g id="edge88" class="edge">
<title>layer40_attention_scores_tp0&#45;&gt;layer40_attention_weights_tp0</title>
<path fill="none" stroke="black" d="M2375,-1428.07C2375,-1419.77 2375,-1410.39 2375,-1401.48"/>
<polygon fill="black" stroke="black" points="2378.5,-1401.34 2375,-1391.34 2371.5,-1401.34 2378.5,-1401.34"/>
</g>
<!-- layer40_attention_output_tp0 -->
<g id="node70" class="node">
<title>layer40_attention_output_tp0</title>
<polygon fill="none" stroke="black" points="2532.5,-1240.47 2227.5,-1240.47 2227.5,-1188.47 2532.5,-1188.47 2532.5,-1240.47"/>
<text text-anchor="middle" x="2380" y="-1228.47" font-family="Arial" font-size="10.00">Layer 40 Attention Output</text>
<text text-anchor="middle" x="2380" y="-1217.47" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2380" y="-1206.47" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="2380" y="-1195.47" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer40_attention_weights_tp0&#45;&gt;layer40_attention_output_tp0 -->
<g id="edge89" class="edge">
<title>layer40_attention_weights_tp0&#45;&gt;layer40_attention_output_tp0</title>
<path fill="none" stroke="black" d="M2375.85,-1339C2376.66,-1314.85 2377.89,-1278.18 2378.8,-1251.07"/>
<polygon fill="black" stroke="black" points="2382.31,-1250.94 2379.15,-1240.83 2375.31,-1250.7 2382.31,-1250.94"/>
</g>
<!-- layer40_attention_allreduce_tp0 -->
<g id="node71" class="node">
<title>layer40_attention_allreduce_tp0</title>
<ellipse fill="none" stroke="black" cx="2409" cy="-1052.93" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="2409" y="-1066.93" font-family="Arial" font-size="10.00">Layer 40 Attention All&#45;Reduce</text>
<text text-anchor="middle" x="2409" y="-1055.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2409" y="-1044.93" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="2409" y="-1033.93" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer40_attention_output_tp0&#45;&gt;layer40_attention_allreduce_tp0 -->
<g id="edge90" class="edge">
<title>layer40_attention_output_tp0&#45;&gt;layer40_attention_allreduce_tp0</title>
<path fill="none" stroke="black" d="M2384.6,-1188.19C2388.91,-1164.45 2395.47,-1128.38 2400.7,-1099.61"/>
<polygon fill="black" stroke="black" points="2404.14,-1100.23 2402.49,-1089.77 2397.25,-1098.98 2404.14,-1100.23"/>
</g>
<!-- layer40_attention_allreduce_tp1 -->
<g id="node72" class="node">
<title>layer40_attention_allreduce_tp1</title>
<ellipse fill="none" stroke="black" cx="2646" cy="-933.39" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="2646" y="-947.39" font-family="Arial" font-size="10.00">Layer 40 Attention All&#45;Reduce</text>
<text text-anchor="middle" x="2646" y="-936.39" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2646" y="-925.39" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="2646" y="-914.39" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer40_attention_allreduce_tp0&#45;&gt;layer40_attention_allreduce_tp1 -->
<g id="edge91" class="edge">
<title>layer40_attention_allreduce_tp0&#45;&gt;layer40_attention_allreduce_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2470,-1018.63C2488.81,-1008.61 2509.65,-997.73 2529,-988.16 2540.57,-982.43 2552.88,-976.55 2565.01,-970.87"/>
<polygon fill="black" stroke="black" points="2566.64,-973.97 2574.23,-966.58 2563.68,-967.63 2566.64,-973.97"/>
<text text-anchor="middle" x="2545.5" y="-990.96" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer40_attention_allreduce_tp0&#45;&gt;layer40_residual_tp0 -->
<g id="edge92" class="edge">
<title>layer40_attention_allreduce_tp0&#45;&gt;layer40_residual_tp0</title>
<path fill="none" stroke="black" d="M2354.3,-1018.09C2327.11,-1001.27 2294.53,-981.11 2268.14,-964.79"/>
<polygon fill="black" stroke="black" points="2269.8,-961.7 2259.45,-959.41 2266.12,-967.65 2269.8,-961.7"/>
</g>
<!-- layer40_attention_allreduce_tp1&#45;&gt;layer40_attention_allreduce_tp0 -->
<g id="edge110" class="edge">
<title>layer40_attention_allreduce_tp1&#45;&gt;layer40_attention_allreduce_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2605.44,-969.21C2592.18,-979.47 2577,-990.09 2562,-998.16 2547.28,-1006.07 2531.17,-1013.21 2515.09,-1019.5"/>
<polygon fill="black" stroke="black" points="2513.74,-1016.27 2505.64,-1023.11 2516.23,-1022.81 2513.74,-1016.27"/>
<text text-anchor="middle" x="2593.5" y="-990.96" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer40_attention_allreduce_tp1&#45;&gt;layer40_residual_tp1 -->
<g id="edge111" class="edge">
<title>layer40_attention_allreduce_tp1&#45;&gt;layer40_residual_tp1</title>
<path fill="none" stroke="black" d="M2718.69,-900.37C2745.38,-888.62 2775.44,-875.38 2801.56,-863.88"/>
<polygon fill="black" stroke="black" points="2803.25,-866.96 2810.99,-859.73 2800.42,-860.55 2803.25,-866.96"/>
</g>
<!-- layer40_post_norm_tp0 -->
<g id="node74" class="node">
<title>layer40_post_norm_tp0</title>
<polygon fill="none" stroke="black" points="2364,-859.62 2132,-859.62 2132,-807.62 2364,-807.62 2364,-859.62"/>
<text text-anchor="middle" x="2248" y="-847.62" font-family="Arial" font-size="10.00">Layer 40 Post&#45;Attention RMSNorm</text>
<text text-anchor="middle" x="2248" y="-836.62" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2248" y="-825.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="2248" y="-814.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer40_residual_tp0&#45;&gt;layer40_post_norm_tp0 -->
<g id="edge94" class="edge">
<title>layer40_residual_tp0&#45;&gt;layer40_post_norm_tp0</title>
<path fill="none" stroke="black" d="M2226.47,-907.21C2229.88,-895.69 2233.99,-881.86 2237.69,-869.37"/>
<polygon fill="black" stroke="black" points="2241.07,-870.29 2240.56,-859.71 2234.36,-868.3 2241.07,-870.29"/>
</g>
<!-- layer40_final_residual_tp0 -->
<g id="node81" class="node">
<title>layer40_final_residual_tp0</title>
<polygon fill="none" stroke="black" points="2259,-52 2027,-52 2027,0 2259,0 2259,-52"/>
<text text-anchor="middle" x="2143" y="-40" font-family="Arial" font-size="10.00">Layer 40 Final Residual</text>
<text text-anchor="middle" x="2143" y="-29" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2143" y="-18" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="2143" y="-7" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer40_residual_tp0&#45;&gt;layer40_final_residual_tp0 -->
<g id="edge103" class="edge">
<title>layer40_residual_tp0&#45;&gt;layer40_final_residual_tp0</title>
<path fill="none" stroke="black" d="M2147.16,-907.23C2117.09,-891.71 2089,-868.22 2089,-834.62 2089,-834.62 2089,-834.62 2089,-124.77 2089,-101.44 2100.93,-78.44 2113.57,-60.62"/>
<polygon fill="black" stroke="black" points="2116.6,-62.41 2119.79,-52.31 2110.99,-58.22 2116.6,-62.41"/>
</g>
<!-- layer40_ffn_gate_tp0 -->
<g id="node75" class="node">
<title>layer40_ffn_gate_tp0</title>
<polygon fill="none" stroke="black" points="2659,-770.62 2397,-770.62 2397,-718.62 2659,-718.62 2659,-770.62"/>
<text text-anchor="middle" x="2528" y="-758.62" font-family="Arial" font-size="10.00">Layer 40 FFN Gate</text>
<text text-anchor="middle" x="2528" y="-747.62" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2528" y="-736.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="2528" y="-725.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer40_post_norm_tp0&#45;&gt;layer40_ffn_gate_tp0 -->
<g id="edge95" class="edge">
<title>layer40_post_norm_tp0&#45;&gt;layer40_ffn_gate_tp0</title>
<path fill="none" stroke="black" d="M2328.61,-807.57C2362.72,-796.97 2402.61,-784.58 2437.71,-773.67"/>
<polygon fill="black" stroke="black" points="2438.96,-776.95 2447.47,-770.64 2436.88,-770.26 2438.96,-776.95"/>
</g>
<!-- layer40_ffn_up_tp0 -->
<g id="node76" class="node">
<title>layer40_ffn_up_tp0</title>
<polygon fill="none" stroke="black" points="2379,-770.62 2117,-770.62 2117,-718.62 2379,-718.62 2379,-770.62"/>
<text text-anchor="middle" x="2248" y="-758.62" font-family="Arial" font-size="10.00">Layer 40 FFN Up</text>
<text text-anchor="middle" x="2248" y="-747.62" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2248" y="-736.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="2248" y="-725.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer40_post_norm_tp0&#45;&gt;layer40_ffn_up_tp0 -->
<g id="edge96" class="edge">
<title>layer40_post_norm_tp0&#45;&gt;layer40_ffn_up_tp0</title>
<path fill="none" stroke="black" d="M2248,-807.45C2248,-799.16 2248,-789.77 2248,-780.87"/>
<polygon fill="black" stroke="black" points="2251.5,-780.72 2248,-770.72 2244.5,-780.72 2251.5,-780.72"/>
</g>
<!-- layer40_ffn_activation_tp0 -->
<g id="node77" class="node">
<title>layer40_ffn_activation_tp0</title>
<polygon fill="none" stroke="black" points="2379,-681.62 2117,-681.62 2117,-629.62 2379,-629.62 2379,-681.62"/>
<text text-anchor="middle" x="2248" y="-669.62" font-family="Arial" font-size="10.00">Layer 40 FFN SwiGLU</text>
<text text-anchor="middle" x="2248" y="-658.62" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2248" y="-647.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="2248" y="-636.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer40_ffn_gate_tp0&#45;&gt;layer40_ffn_activation_tp0 -->
<g id="edge97" class="edge">
<title>layer40_ffn_gate_tp0&#45;&gt;layer40_ffn_activation_tp0</title>
<path fill="none" stroke="black" d="M2447.39,-718.57C2413.28,-707.97 2373.39,-695.58 2338.29,-684.67"/>
<polygon fill="black" stroke="black" points="2339.12,-681.26 2328.53,-681.64 2337.04,-687.95 2339.12,-681.26"/>
</g>
<!-- layer40_ffn_up_tp0&#45;&gt;layer40_ffn_activation_tp0 -->
<g id="edge98" class="edge">
<title>layer40_ffn_up_tp0&#45;&gt;layer40_ffn_activation_tp0</title>
<path fill="none" stroke="black" d="M2248,-718.45C2248,-710.16 2248,-700.77 2248,-691.87"/>
<polygon fill="black" stroke="black" points="2251.5,-691.72 2248,-681.72 2244.5,-691.72 2251.5,-691.72"/>
</g>
<!-- layer40_ffn_down_tp0 -->
<g id="node78" class="node">
<title>layer40_ffn_down_tp0</title>
<polygon fill="none" stroke="black" points="2397,-471.62 2143,-471.62 2143,-419.62 2397,-419.62 2397,-471.62"/>
<text text-anchor="middle" x="2270" y="-459.62" font-family="Arial" font-size="10.00">Layer 40 FFN Down</text>
<text text-anchor="middle" x="2270" y="-448.62" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2270" y="-437.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="2270" y="-426.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer40_ffn_activation_tp0&#45;&gt;layer40_ffn_down_tp0 -->
<g id="edge99" class="edge">
<title>layer40_ffn_activation_tp0&#45;&gt;layer40_ffn_down_tp0</title>
<path fill="none" stroke="black" d="M2250.65,-629.53C2254.55,-592.67 2261.84,-523.74 2266.28,-481.83"/>
<polygon fill="black" stroke="black" points="2269.77,-482.11 2267.34,-471.8 2262.8,-481.37 2269.77,-482.11"/>
</g>
<!-- layer40_ffn_allreduce_tp0 -->
<g id="node79" class="node">
<title>layer40_ffn_allreduce_tp0</title>
<ellipse fill="none" stroke="black" cx="2281" cy="-125.77" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="2281" y="-139.77" font-family="Arial" font-size="10.00">Layer 40 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="2281" y="-128.77" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2281" y="-117.77" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="2281" y="-106.77" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer40_ffn_down_tp0&#45;&gt;layer40_ffn_allreduce_tp0 -->
<g id="edge100" class="edge">
<title>layer40_ffn_down_tp0&#45;&gt;layer40_ffn_allreduce_tp0</title>
<path fill="none" stroke="black" d="M2270.87,-419.41C2272.72,-365.99 2277.06,-240.72 2279.41,-172.69"/>
<polygon fill="black" stroke="black" points="2282.91,-172.8 2279.76,-162.68 2275.91,-172.56 2282.91,-172.8"/>
</g>
<!-- layer40_ffn_allreduce_tp1 -->
<g id="node80" class="node">
<title>layer40_ffn_allreduce_tp1</title>
<ellipse fill="none" stroke="black" cx="2493" cy="-245.31" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="2493" y="-259.31" font-family="Arial" font-size="10.00">Layer 40 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="2493" y="-248.31" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2493" y="-237.31" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="2493" y="-226.31" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer40_ffn_allreduce_tp0&#45;&gt;layer40_ffn_allreduce_tp1 -->
<g id="edge101" class="edge">
<title>layer40_ffn_allreduce_tp0&#45;&gt;layer40_ffn_allreduce_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2340.97,-160.02C2366.79,-174.33 2397.13,-191.16 2423.89,-205.99"/>
<polygon fill="black" stroke="black" points="2422.37,-209.15 2432.82,-210.94 2425.77,-203.03 2422.37,-209.15"/>
<text text-anchor="middle" x="2410.5" y="-183.34" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer40_ffn_allreduce_tp0&#45;&gt;layer40_final_residual_tp0 -->
<g id="edge102" class="edge">
<title>layer40_ffn_allreduce_tp0&#45;&gt;layer40_final_residual_tp0</title>
<path fill="none" stroke="black" d="M2232.73,-90.57C2217.79,-79.99 2201.42,-68.39 2186.79,-58.03"/>
<polygon fill="black" stroke="black" points="2188.59,-55.01 2178.41,-52.09 2184.55,-60.72 2188.59,-55.01"/>
</g>
<!-- layer40_ffn_allreduce_tp1&#45;&gt;layer40_ffn_allreduce_tp0 -->
<g id="edge120" class="edge">
<title>layer40_ffn_allreduce_tp1&#45;&gt;layer40_ffn_allreduce_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2463.97,-208.79C2454.31,-198.63 2442.95,-188.23 2431,-180.54 2418.31,-172.37 2404.22,-165.24 2389.9,-159.08"/>
<polygon fill="black" stroke="black" points="2391.04,-155.77 2380.46,-155.17 2388.36,-162.24 2391.04,-155.77"/>
<text text-anchor="middle" x="2459.5" y="-183.34" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer40_final_residual_tp1 -->
<g id="node93" class="node">
<title>layer40_final_residual_tp1</title>
<polygon fill="none" stroke="black" points="2869,-151.77 2637,-151.77 2637,-99.77 2869,-99.77 2869,-151.77"/>
<text text-anchor="middle" x="2753" y="-139.77" font-family="Arial" font-size="10.00">Layer 40 Final Residual</text>
<text text-anchor="middle" x="2753" y="-128.77" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2753" y="-117.77" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="2753" y="-106.77" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer40_ffn_allreduce_tp1&#45;&gt;layer40_final_residual_tp1 -->
<g id="edge121" class="edge">
<title>layer40_ffn_allreduce_tp1&#45;&gt;layer40_final_residual_tp1</title>
<path fill="none" stroke="black" d="M2564.39,-212.04C2603.06,-194.56 2650.47,-173.12 2688.09,-156.11"/>
<polygon fill="black" stroke="black" points="2689.76,-159.2 2697.43,-151.89 2686.87,-152.82 2689.76,-159.2"/>
</g>
<!-- layer40_qkv_tp1 -->
<g id="node83" class="node">
<title>layer40_qkv_tp1</title>
<polygon fill="none" stroke="black" points="2842.5,-1569.23 2597.5,-1569.23 2597.5,-1517.23 2842.5,-1517.23 2842.5,-1569.23"/>
<text text-anchor="middle" x="2720" y="-1557.23" font-family="Arial" font-size="10.00">Layer 40 QKV Projection</text>
<text text-anchor="middle" x="2720" y="-1546.23" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2720" y="-1535.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="2720" y="-1524.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
</g>
<!-- layer40_norm_tp1&#45;&gt;layer40_qkv_tp1 -->
<g id="edge105" class="edge">
<title>layer40_norm_tp1&#45;&gt;layer40_qkv_tp1</title>
<path fill="none" stroke="black" d="M2723.55,-1606.07C2723.08,-1597.77 2722.54,-1588.39 2722.03,-1579.48"/>
<polygon fill="black" stroke="black" points="2725.51,-1579.12 2721.44,-1569.34 2718.52,-1579.53 2725.51,-1579.12"/>
</g>
<!-- layer40_attention_scores_tp1 -->
<g id="node84" class="node">
<title>layer40_attention_scores_tp1</title>
<polygon fill="none" stroke="black" points="2862.5,-1480.23 2549.5,-1480.23 2549.5,-1428.23 2862.5,-1428.23 2862.5,-1480.23"/>
<text text-anchor="middle" x="2706" y="-1468.23" font-family="Arial" font-size="10.00">Layer 40 Attention Scores</text>
<text text-anchor="middle" x="2706" y="-1457.23" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2706" y="-1446.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
<text text-anchor="middle" x="2706" y="-1435.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer40_qkv_tp1&#45;&gt;layer40_attention_scores_tp1 -->
<g id="edge106" class="edge">
<title>layer40_qkv_tp1&#45;&gt;layer40_attention_scores_tp1</title>
<path fill="none" stroke="black" d="M2715.95,-1517.07C2714.62,-1508.77 2713.11,-1499.39 2711.67,-1490.48"/>
<polygon fill="black" stroke="black" points="2715.08,-1489.66 2710.04,-1480.34 2708.17,-1490.77 2715.08,-1489.66"/>
</g>
<!-- layer40_attention_weights_tp1 -->
<g id="node85" class="node">
<title>layer40_attention_weights_tp1</title>
<polygon fill="none" stroke="black" points="2862.5,-1391.23 2549.5,-1391.23 2549.5,-1339.23 2862.5,-1339.23 2862.5,-1391.23"/>
<text text-anchor="middle" x="2706" y="-1379.23" font-family="Arial" font-size="10.00">Layer 40 Attention Weights</text>
<text text-anchor="middle" x="2706" y="-1368.23" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2706" y="-1357.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="2706" y="-1346.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer40_attention_scores_tp1&#45;&gt;layer40_attention_weights_tp1 -->
<g id="edge107" class="edge">
<title>layer40_attention_scores_tp1&#45;&gt;layer40_attention_weights_tp1</title>
<path fill="none" stroke="black" d="M2706,-1428.07C2706,-1419.77 2706,-1410.39 2706,-1401.48"/>
<polygon fill="black" stroke="black" points="2709.5,-1401.34 2706,-1391.34 2702.5,-1401.34 2709.5,-1401.34"/>
</g>
<!-- layer40_attention_output_tp1 -->
<g id="node86" class="node">
<title>layer40_attention_output_tp1</title>
<polygon fill="none" stroke="black" points="2813.5,-1159.7 2508.5,-1159.7 2508.5,-1107.7 2813.5,-1107.7 2813.5,-1159.7"/>
<text text-anchor="middle" x="2661" y="-1147.7" font-family="Arial" font-size="10.00">Layer 40 Attention Output</text>
<text text-anchor="middle" x="2661" y="-1136.7" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2661" y="-1125.7" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="2661" y="-1114.7" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer40_attention_weights_tp1&#45;&gt;layer40_attention_output_tp1 -->
<g id="edge108" class="edge">
<title>layer40_attention_weights_tp1&#45;&gt;layer40_attention_output_tp1</title>
<path fill="none" stroke="black" d="M2701.1,-1339.23C2693.07,-1298.29 2677.1,-1216.83 2667.92,-1170.01"/>
<polygon fill="black" stroke="black" points="2671.32,-1169.16 2665.96,-1160.02 2664.45,-1170.5 2671.32,-1169.16"/>
</g>
<!-- layer40_attention_output_tp1&#45;&gt;layer40_attention_allreduce_tp1 -->
<g id="edge109" class="edge">
<title>layer40_attention_output_tp1&#45;&gt;layer40_attention_allreduce_tp1</title>
<path fill="none" stroke="black" d="M2659.1,-1107.58C2656.69,-1075.72 2652.49,-1020.17 2649.49,-980.57"/>
<polygon fill="black" stroke="black" points="2652.97,-980.07 2648.72,-970.37 2645.99,-980.6 2652.97,-980.07"/>
</g>
<!-- layer40_post_norm_tp1 -->
<g id="node88" class="node">
<title>layer40_post_norm_tp1</title>
<polygon fill="none" stroke="black" points="2924,-770.62 2692,-770.62 2692,-718.62 2924,-718.62 2924,-770.62"/>
<text text-anchor="middle" x="2808" y="-758.62" font-family="Arial" font-size="10.00">Layer 40 Post&#45;Attention RMSNorm</text>
<text text-anchor="middle" x="2808" y="-747.62" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2808" y="-736.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="2808" y="-725.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer40_residual_tp1&#45;&gt;layer40_post_norm_tp1 -->
<g id="edge113" class="edge">
<title>layer40_residual_tp1&#45;&gt;layer40_post_norm_tp1</title>
<path fill="none" stroke="black" d="M2850.65,-807.45C2844.55,-798.62 2837.6,-788.54 2831.11,-779.13"/>
<polygon fill="black" stroke="black" points="2833.87,-776.97 2825.32,-770.72 2828.11,-780.94 2833.87,-776.97"/>
</g>
<!-- layer40_residual_tp1&#45;&gt;layer40_final_residual_tp1 -->
<g id="edge122" class="edge">
<title>layer40_residual_tp1&#45;&gt;layer40_final_residual_tp1</title>
<path fill="none" stroke="black" d="M2923.29,-807.57C2945.97,-793.21 2967,-772.62 2967,-745.62 2967,-745.62 2967,-745.62 2967,-244.31 2967,-196.42 2925.33,-167.91 2878.76,-151"/>
<polygon fill="black" stroke="black" points="2879.68,-147.61 2869.08,-147.67 2877.4,-154.23 2879.68,-147.61"/>
</g>
<!-- layer40_ffn_gate_tp1 -->
<g id="node89" class="node">
<title>layer40_ffn_gate_tp1</title>
<polygon fill="none" stroke="black" points="2659,-681.62 2397,-681.62 2397,-629.62 2659,-629.62 2659,-681.62"/>
<text text-anchor="middle" x="2528" y="-669.62" font-family="Arial" font-size="10.00">Layer 40 FFN Gate</text>
<text text-anchor="middle" x="2528" y="-658.62" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2528" y="-647.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="2528" y="-636.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer40_post_norm_tp1&#45;&gt;layer40_ffn_gate_tp1 -->
<g id="edge114" class="edge">
<title>layer40_post_norm_tp1&#45;&gt;layer40_ffn_gate_tp1</title>
<path fill="none" stroke="black" d="M2727.39,-718.57C2693.28,-707.97 2653.39,-695.58 2618.29,-684.67"/>
<polygon fill="black" stroke="black" points="2619.12,-681.26 2608.53,-681.64 2617.04,-687.95 2619.12,-681.26"/>
</g>
<!-- layer40_ffn_up_tp1 -->
<g id="node90" class="node">
<title>layer40_ffn_up_tp1</title>
<polygon fill="none" stroke="black" points="2939,-681.62 2677,-681.62 2677,-629.62 2939,-629.62 2939,-681.62"/>
<text text-anchor="middle" x="2808" y="-669.62" font-family="Arial" font-size="10.00">Layer 40 FFN Up</text>
<text text-anchor="middle" x="2808" y="-658.62" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2808" y="-647.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="2808" y="-636.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer40_post_norm_tp1&#45;&gt;layer40_ffn_up_tp1 -->
<g id="edge115" class="edge">
<title>layer40_post_norm_tp1&#45;&gt;layer40_ffn_up_tp1</title>
<path fill="none" stroke="black" d="M2808,-718.45C2808,-710.16 2808,-700.77 2808,-691.87"/>
<polygon fill="black" stroke="black" points="2811.5,-691.72 2808,-681.72 2804.5,-691.72 2811.5,-691.72"/>
</g>
<!-- layer40_ffn_activation_tp1 -->
<g id="node91" class="node">
<title>layer40_ffn_activation_tp1</title>
<polygon fill="none" stroke="black" points="2659,-541.62 2397,-541.62 2397,-489.62 2659,-489.62 2659,-541.62"/>
<text text-anchor="middle" x="2528" y="-529.62" font-family="Arial" font-size="10.00">Layer 40 FFN SwiGLU</text>
<text text-anchor="middle" x="2528" y="-518.62" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2528" y="-507.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="2528" y="-496.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer40_ffn_gate_tp1&#45;&gt;layer40_ffn_activation_tp1 -->
<g id="edge116" class="edge">
<title>layer40_ffn_gate_tp1&#45;&gt;layer40_ffn_activation_tp1</title>
<path fill="none" stroke="black" d="M2528,-629.31C2528,-607.62 2528,-576.14 2528,-551.97"/>
<polygon fill="black" stroke="black" points="2531.5,-551.77 2528,-541.77 2524.5,-551.77 2531.5,-551.77"/>
</g>
<!-- layer40_ffn_up_tp1&#45;&gt;layer40_ffn_activation_tp1 -->
<g id="edge117" class="edge">
<title>layer40_ffn_up_tp1&#45;&gt;layer40_ffn_activation_tp1</title>
<path fill="none" stroke="black" d="M2756.97,-629.47C2709.45,-606.05 2638.58,-571.12 2588.29,-546.33"/>
<polygon fill="black" stroke="black" points="2589.67,-543.11 2579.15,-541.83 2586.58,-549.39 2589.67,-543.11"/>
</g>
<!-- layer40_ffn_down_tp1 -->
<g id="node92" class="node">
<title>layer40_ffn_down_tp1</title>
<polygon fill="none" stroke="black" points="2631,-390.85 2377,-390.85 2377,-338.85 2631,-338.85 2631,-390.85"/>
<text text-anchor="middle" x="2504" y="-378.85" font-family="Arial" font-size="10.00">Layer 40 FFN Down</text>
<text text-anchor="middle" x="2504" y="-367.85" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2504" y="-356.85" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="2504" y="-345.85" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer40_ffn_activation_tp1&#45;&gt;layer40_ffn_down_tp1 -->
<g id="edge118" class="edge">
<title>layer40_ffn_activation_tp1&#45;&gt;layer40_ffn_down_tp1</title>
<path fill="none" stroke="black" d="M2523.93,-489.38C2520.02,-465.12 2514.07,-428.24 2509.69,-401.09"/>
<polygon fill="black" stroke="black" points="2513.14,-400.52 2508.09,-391.21 2506.23,-401.64 2513.14,-400.52"/>
</g>
<!-- layer40_ffn_down_tp1&#45;&gt;layer40_ffn_allreduce_tp1 -->
<g id="edge119" class="edge">
<title>layer40_ffn_down_tp1&#45;&gt;layer40_ffn_allreduce_tp1</title>
<path fill="none" stroke="black" d="M2501.64,-338.63C2500.38,-325.13 2498.78,-308.08 2497.31,-292.31"/>
<polygon fill="black" stroke="black" points="2500.77,-291.82 2496.36,-282.19 2493.8,-292.47 2500.77,-291.82"/>
</g>
<!-- pp_stage3_recv_tp0 -->
<g id="node94" class="node">
<title>pp_stage3_recv_tp0</title>
<polygon fill="none" stroke="black" points="3508.55,-1799.23 3125.89,-1799.23 3027.45,-1695.23 3410.11,-1695.23 3508.55,-1799.23"/>
<text text-anchor="middle" x="3268" y="-1761.23" font-family="Arial" font-size="10.00">PP Stage 3 Receive</text>
<text text-anchor="middle" x="3268" y="-1750.23" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3268" y="-1739.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="3268" y="-1728.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer60_norm_tp0 -->
<g id="node98" class="node">
<title>layer60_norm_tp0</title>
<polygon fill="none" stroke="black" points="3420,-1658.23 3188,-1658.23 3188,-1606.23 3420,-1606.23 3420,-1658.23"/>
<text text-anchor="middle" x="3304" y="-1646.23" font-family="Arial" font-size="10.00">Layer 60 RMSNorm</text>
<text text-anchor="middle" x="3304" y="-1635.23" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3304" y="-1624.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="3304" y="-1613.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- pp_stage3_recv_tp0&#45;&gt;layer60_norm_tp0 -->
<g id="edge127" class="edge">
<title>pp_stage3_recv_tp0&#45;&gt;layer60_norm_tp0</title>
<path fill="none" stroke="black" d="M3284.31,-1695.02C3287.23,-1685.87 3290.2,-1676.54 3292.93,-1667.99"/>
<polygon fill="black" stroke="black" points="3296.29,-1668.96 3295.99,-1658.37 3289.62,-1666.83 3296.29,-1668.96"/>
</g>
<!-- layer60_residual_tp0 -->
<g id="node105" class="node">
<title>layer60_residual_tp0</title>
<polygon fill="none" stroke="black" points="3287,-959.39 3055,-959.39 3055,-907.39 3287,-907.39 3287,-959.39"/>
<text text-anchor="middle" x="3171" y="-947.39" font-family="Arial" font-size="10.00">Layer 60 Residual Add</text>
<text text-anchor="middle" x="3171" y="-936.39" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3171" y="-925.39" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="3171" y="-914.39" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- pp_stage3_recv_tp0&#45;&gt;layer60_residual_tp0 -->
<g id="edge135" class="edge">
<title>pp_stage3_recv_tp0&#45;&gt;layer60_residual_tp0</title>
<path fill="none" stroke="black" d="M3187.04,-1695.09C3169.97,-1678.11 3157,-1657.3 3157,-1633.23 3157,-1633.23 3157,-1633.23 3157,-1051.93 3157,-1024.13 3160.91,-992.88 3164.6,-969.6"/>
<polygon fill="black" stroke="black" points="3168.09,-969.94 3166.26,-959.51 3161.18,-968.8 3168.09,-969.94"/>
</g>
<!-- layer59_ffn_allreduce_tp0 -->
<g id="node95" class="node">
<title>layer59_ffn_allreduce_tp0</title>
<ellipse fill="none" stroke="black" cx="3360" cy="-1865.73" rx="74.52" ry="18"/>
<text text-anchor="middle" x="3360" y="-1863.23" font-family="Arial" font-size="10.00">layer59_ffn_allreduce_tp0</text>
</g>
<!-- layer59_ffn_allreduce_tp0&#45;&gt;pp_stage3_recv_tp0 -->
<g id="edge123" class="edge">
<title>layer59_ffn_allreduce_tp0&#45;&gt;pp_stage3_recv_tp0</title>
<path fill="none" stroke="black" d="M3328.76,-1849.22C3319.24,-1843.34 3309.35,-1835.94 3302,-1827.23 3297.23,-1821.59 3293.03,-1815.17 3289.37,-1808.5"/>
<polygon fill="black" stroke="black" points="3292.33,-1806.61 3284.69,-1799.28 3286.09,-1809.78 3292.33,-1806.61"/>
<text text-anchor="middle" x="3364" y="-1820.03" font-family="Arial" font-size="9.00">pipeline_send_gpu4_to_gpu6</text>
</g>
<!-- pp_stage3_recv_tp1 -->
<g id="node97" class="node">
<title>pp_stage3_recv_tp1</title>
<polygon fill="none" stroke="black" points="4007.55,-1799.23 3624.89,-1799.23 3526.45,-1695.23 3909.11,-1695.23 4007.55,-1799.23"/>
<text text-anchor="middle" x="3767" y="-1761.23" font-family="Arial" font-size="10.00">PP Stage 3 Receive</text>
<text text-anchor="middle" x="3767" y="-1750.23" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3767" y="-1739.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="3767" y="-1728.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer59_ffn_allreduce_tp0&#45;&gt;pp_stage3_recv_tp1 -->
<g id="edge125" class="edge">
<title>layer59_ffn_allreduce_tp0&#45;&gt;pp_stage3_recv_tp1</title>
<path fill="none" stroke="black" d="M3389.52,-1849.11C3409.75,-1838.91 3437.46,-1825.92 3463,-1817.23 3505.16,-1802.9 3551.62,-1790.66 3595.26,-1780.64"/>
<polygon fill="black" stroke="black" points="3596.14,-1784.03 3605.12,-1778.4 3594.59,-1777.2 3596.14,-1784.03"/>
<text text-anchor="middle" x="3525" y="-1820.03" font-family="Arial" font-size="9.00">pipeline_send_gpu4_to_gpu7</text>
</g>
<!-- layer59_ffn_allreduce_tp1 -->
<g id="node96" class="node">
<title>layer59_ffn_allreduce_tp1</title>
<ellipse fill="none" stroke="black" cx="3686" cy="-1865.73" rx="74.52" ry="18"/>
<text text-anchor="middle" x="3686" y="-1863.23" font-family="Arial" font-size="10.00">layer59_ffn_allreduce_tp1</text>
</g>
<!-- layer59_ffn_allreduce_tp1&#45;&gt;pp_stage3_recv_tp0 -->
<g id="edge124" class="edge">
<title>layer59_ffn_allreduce_tp1&#45;&gt;pp_stage3_recv_tp0</title>
<path fill="none" stroke="black" d="M3654.36,-1849.33C3626.74,-1835.93 3590.53,-1818.44 3587,-1817.23 3577.97,-1814.14 3551.57,-1807.89 3517.58,-1800.36"/>
<polygon fill="black" stroke="black" points="3518.32,-1796.94 3507.8,-1798.2 3516.81,-1803.78 3518.32,-1796.94"/>
<text text-anchor="middle" x="3671" y="-1820.03" font-family="Arial" font-size="9.00">pipeline_send_gpu5_to_gpu6</text>
</g>
<!-- layer59_ffn_allreduce_tp1&#45;&gt;pp_stage3_recv_tp1 -->
<g id="edge126" class="edge">
<title>layer59_ffn_allreduce_tp1&#45;&gt;pp_stage3_recv_tp1</title>
<path fill="none" stroke="black" d="M3713.38,-1848.94C3721.85,-1843.01 3730.62,-1835.63 3737,-1827.23 3741.33,-1821.53 3745.1,-1815.13 3748.37,-1808.51"/>
<polygon fill="black" stroke="black" points="3751.57,-1809.93 3752.52,-1799.38 3745.19,-1807.04 3751.57,-1809.93"/>
<text text-anchor="middle" x="3806" y="-1820.03" font-family="Arial" font-size="9.00">pipeline_send_gpu5_to_gpu7</text>
</g>
<!-- layer60_norm_tp1 -->
<g id="node114" class="node">
<title>layer60_norm_tp1</title>
<polygon fill="none" stroke="black" points="3810,-1658.23 3578,-1658.23 3578,-1606.23 3810,-1606.23 3810,-1658.23"/>
<text text-anchor="middle" x="3694" y="-1646.23" font-family="Arial" font-size="10.00">Layer 60 RMSNorm</text>
<text text-anchor="middle" x="3694" y="-1635.23" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3694" y="-1624.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="3694" y="-1613.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- pp_stage3_recv_tp1&#45;&gt;layer60_norm_tp1 -->
<g id="edge146" class="edge">
<title>pp_stage3_recv_tp1&#45;&gt;layer60_norm_tp1</title>
<path fill="none" stroke="black" d="M3733.92,-1695.02C3727.75,-1685.48 3721.45,-1675.73 3715.73,-1666.88"/>
<polygon fill="black" stroke="black" points="3718.6,-1664.87 3710.24,-1658.37 3712.72,-1668.66 3718.6,-1664.87"/>
</g>
<!-- layer60_residual_tp1 -->
<g id="node119" class="node">
<title>layer60_residual_tp1</title>
<polygon fill="none" stroke="black" points="3957,-859.62 3725,-859.62 3725,-807.62 3957,-807.62 3957,-859.62"/>
<text text-anchor="middle" x="3841" y="-847.62" font-family="Arial" font-size="10.00">Layer 60 Residual Add</text>
<text text-anchor="middle" x="3841" y="-836.62" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3841" y="-825.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="3841" y="-814.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- pp_stage3_recv_tp1&#45;&gt;layer60_residual_tp1 -->
<g id="edge154" class="edge">
<title>pp_stage3_recv_tp1&#45;&gt;layer60_residual_tp1</title>
<path fill="none" stroke="black" d="M3831.19,-1695.06C3846.25,-1677.52 3858,-1656.41 3858,-1633.23 3858,-1633.23 3858,-1633.23 3858,-932.39 3858,-911.31 3854.12,-888.05 3850.06,-869.5"/>
<polygon fill="black" stroke="black" points="3853.47,-868.69 3847.82,-859.73 3846.65,-870.26 3853.47,-868.69"/>
</g>
<!-- layer60_qkv_tp0 -->
<g id="node99" class="node">
<title>layer60_qkv_tp0</title>
<polygon fill="none" stroke="black" points="3451.5,-1569.23 3206.5,-1569.23 3206.5,-1517.23 3451.5,-1517.23 3451.5,-1569.23"/>
<text text-anchor="middle" x="3329" y="-1557.23" font-family="Arial" font-size="10.00">Layer 60 QKV Projection</text>
<text text-anchor="middle" x="3329" y="-1546.23" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3329" y="-1535.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="3329" y="-1524.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
</g>
<!-- layer60_norm_tp0&#45;&gt;layer60_qkv_tp0 -->
<g id="edge128" class="edge">
<title>layer60_norm_tp0&#45;&gt;layer60_qkv_tp0</title>
<path fill="none" stroke="black" d="M3311.23,-1606.07C3313.64,-1597.68 3316.37,-1588.19 3318.95,-1579.19"/>
<polygon fill="black" stroke="black" points="3322.39,-1579.92 3321.79,-1569.34 3315.66,-1577.99 3322.39,-1579.92"/>
</g>
<!-- layer60_attention_scores_tp0 -->
<g id="node100" class="node">
<title>layer60_attention_scores_tp0</title>
<polygon fill="none" stroke="black" points="3498.5,-1480.23 3185.5,-1480.23 3185.5,-1428.23 3498.5,-1428.23 3498.5,-1480.23"/>
<text text-anchor="middle" x="3342" y="-1468.23" font-family="Arial" font-size="10.00">Layer 60 Attention Scores</text>
<text text-anchor="middle" x="3342" y="-1457.23" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3342" y="-1446.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
<text text-anchor="middle" x="3342" y="-1435.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer60_qkv_tp0&#45;&gt;layer60_attention_scores_tp0 -->
<g id="edge129" class="edge">
<title>layer60_qkv_tp0&#45;&gt;layer60_attention_scores_tp0</title>
<path fill="none" stroke="black" d="M3332.76,-1517.07C3334,-1508.77 3335.4,-1499.39 3336.73,-1490.48"/>
<polygon fill="black" stroke="black" points="3340.23,-1490.75 3338.25,-1480.34 3333.31,-1489.72 3340.23,-1490.75"/>
</g>
<!-- layer60_attention_weights_tp0 -->
<g id="node101" class="node">
<title>layer60_attention_weights_tp0</title>
<polygon fill="none" stroke="black" points="3498.5,-1391.23 3185.5,-1391.23 3185.5,-1339.23 3498.5,-1339.23 3498.5,-1391.23"/>
<text text-anchor="middle" x="3342" y="-1379.23" font-family="Arial" font-size="10.00">Layer 60 Attention Weights</text>
<text text-anchor="middle" x="3342" y="-1368.23" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3342" y="-1357.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="3342" y="-1346.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer60_attention_scores_tp0&#45;&gt;layer60_attention_weights_tp0 -->
<g id="edge130" class="edge">
<title>layer60_attention_scores_tp0&#45;&gt;layer60_attention_weights_tp0</title>
<path fill="none" stroke="black" d="M3342,-1428.07C3342,-1419.77 3342,-1410.39 3342,-1401.48"/>
<polygon fill="black" stroke="black" points="3345.5,-1401.34 3342,-1391.34 3338.5,-1401.34 3345.5,-1401.34"/>
</g>
<!-- layer60_attention_output_tp0 -->
<g id="node102" class="node">
<title>layer60_attention_output_tp0</title>
<polygon fill="none" stroke="black" points="3509.5,-1240.47 3204.5,-1240.47 3204.5,-1188.47 3509.5,-1188.47 3509.5,-1240.47"/>
<text text-anchor="middle" x="3357" y="-1228.47" font-family="Arial" font-size="10.00">Layer 60 Attention Output</text>
<text text-anchor="middle" x="3357" y="-1217.47" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3357" y="-1206.47" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="3357" y="-1195.47" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer60_attention_weights_tp0&#45;&gt;layer60_attention_output_tp0 -->
<g id="edge131" class="edge">
<title>layer60_attention_weights_tp0&#45;&gt;layer60_attention_output_tp0</title>
<path fill="none" stroke="black" d="M3344.54,-1339C3346.98,-1314.85 3350.68,-1278.18 3353.41,-1251.07"/>
<polygon fill="black" stroke="black" points="3356.92,-1251.13 3354.44,-1240.83 3349.96,-1250.42 3356.92,-1251.13"/>
</g>
<!-- layer60_attention_allreduce_tp0 -->
<g id="node103" class="node">
<title>layer60_attention_allreduce_tp0</title>
<ellipse fill="none" stroke="black" cx="3365" cy="-1052.93" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="3365" y="-1066.93" font-family="Arial" font-size="10.00">Layer 60 Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3365" y="-1055.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3365" y="-1044.93" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="3365" y="-1033.93" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer60_attention_output_tp0&#45;&gt;layer60_attention_allreduce_tp0 -->
<g id="edge132" class="edge">
<title>layer60_attention_output_tp0&#45;&gt;layer60_attention_allreduce_tp0</title>
<path fill="none" stroke="black" d="M3358.27,-1188.19C3359.45,-1164.55 3361.25,-1128.7 3362.69,-1099.99"/>
<polygon fill="black" stroke="black" points="3366.2,-1099.93 3363.2,-1089.77 3359.21,-1099.58 3366.2,-1099.93"/>
</g>
<!-- layer60_attention_allreduce_tp1 -->
<g id="node104" class="node">
<title>layer60_attention_allreduce_tp1</title>
<ellipse fill="none" stroke="black" cx="3512" cy="-933.39" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="3512" y="-947.39" font-family="Arial" font-size="10.00">Layer 60 Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3512" y="-936.39" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3512" y="-925.39" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="3512" y="-914.39" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer60_attention_allreduce_tp0&#45;&gt;layer60_attention_allreduce_tp1 -->
<g id="edge133" class="edge">
<title>layer60_attention_allreduce_tp0&#45;&gt;layer60_attention_allreduce_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3400.41,-1016.76C3410.64,-1007.15 3422.01,-996.96 3433,-988.16 3438.79,-983.52 3444.96,-978.87 3451.21,-974.34"/>
<polygon fill="black" stroke="black" points="3453.63,-976.91 3459.75,-968.26 3449.57,-971.21 3453.63,-976.91"/>
<text text-anchor="middle" x="3449.5" y="-990.96" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer60_attention_allreduce_tp0&#45;&gt;layer60_residual_tp0 -->
<g id="edge134" class="edge">
<title>layer60_attention_allreduce_tp0&#45;&gt;layer60_residual_tp0</title>
<path fill="none" stroke="black" d="M3309.41,-1018.24C3281.64,-1001.42 3248.31,-981.23 3221.31,-964.87"/>
<polygon fill="black" stroke="black" points="3222.78,-961.67 3212.41,-959.48 3219.15,-967.65 3222.78,-961.67"/>
</g>
<!-- layer60_attention_allreduce_tp1&#45;&gt;layer60_attention_allreduce_tp0 -->
<g id="edge152" class="edge">
<title>layer60_attention_allreduce_tp1&#45;&gt;layer60_attention_allreduce_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3490.73,-969.86C3483.69,-979.8 3475.26,-990.08 3466,-998.16 3459.44,-1003.88 3452.16,-1009.23 3444.61,-1014.15"/>
<polygon fill="black" stroke="black" points="3442.28,-1011.47 3435.64,-1019.73 3445.98,-1017.42 3442.28,-1011.47"/>
<text text-anchor="middle" x="3492.5" y="-990.96" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer60_attention_allreduce_tp1&#45;&gt;layer60_residual_tp1 -->
<g id="edge153" class="edge">
<title>layer60_attention_allreduce_tp1&#45;&gt;layer60_residual_tp1</title>
<path fill="none" stroke="black" d="M3608.93,-903.58C3652.55,-890.62 3703.83,-875.38 3747.08,-862.53"/>
<polygon fill="black" stroke="black" points="3748.16,-865.86 3756.75,-859.65 3746.17,-859.15 3748.16,-865.86"/>
</g>
<!-- layer60_post_norm_tp0 -->
<g id="node106" class="node">
<title>layer60_post_norm_tp0</title>
<polygon fill="none" stroke="black" points="3313,-859.62 3081,-859.62 3081,-807.62 3313,-807.62 3313,-859.62"/>
<text text-anchor="middle" x="3197" y="-847.62" font-family="Arial" font-size="10.00">Layer 60 Post&#45;Attention RMSNorm</text>
<text text-anchor="middle" x="3197" y="-836.62" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3197" y="-825.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="3197" y="-814.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer60_residual_tp0&#45;&gt;layer60_post_norm_tp0 -->
<g id="edge136" class="edge">
<title>layer60_residual_tp0&#45;&gt;layer60_post_norm_tp0</title>
<path fill="none" stroke="black" d="M3177.7,-907.21C3180.73,-895.8 3184.37,-882.13 3187.66,-869.74"/>
<polygon fill="black" stroke="black" points="3191.14,-870.27 3190.33,-859.71 3184.37,-868.47 3191.14,-870.27"/>
</g>
<!-- layer60_final_residual_tp0 -->
<g id="node113" class="node">
<title>layer60_final_residual_tp0</title>
<polygon fill="none" stroke="black" points="3187,-52 2955,-52 2955,0 3187,0 3187,-52"/>
<text text-anchor="middle" x="3071" y="-40" font-family="Arial" font-size="10.00">Layer 60 Final Residual</text>
<text text-anchor="middle" x="3071" y="-29" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3071" y="-18" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="3071" y="-7" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer60_residual_tp0&#45;&gt;layer60_final_residual_tp0 -->
<g id="edge145" class="edge">
<title>layer60_residual_tp0&#45;&gt;layer60_final_residual_tp0</title>
<path fill="none" stroke="black" d="M3096.72,-907.26C3066.26,-891.85 3038,-868.43 3038,-834.62 3038,-834.62 3038,-834.62 3038,-124.77 3038,-103.05 3045.4,-79.98 3053.19,-61.71"/>
<polygon fill="black" stroke="black" points="3056.49,-62.91 3057.39,-52.36 3050.1,-60.05 3056.49,-62.91"/>
</g>
<!-- layer60_ffn_gate_tp0 -->
<g id="node107" class="node">
<title>layer60_ffn_gate_tp0</title>
<polygon fill="none" stroke="black" points="3608,-770.62 3346,-770.62 3346,-718.62 3608,-718.62 3608,-770.62"/>
<text text-anchor="middle" x="3477" y="-758.62" font-family="Arial" font-size="10.00">Layer 60 FFN Gate</text>
<text text-anchor="middle" x="3477" y="-747.62" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3477" y="-736.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="3477" y="-725.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer60_post_norm_tp0&#45;&gt;layer60_ffn_gate_tp0 -->
<g id="edge137" class="edge">
<title>layer60_post_norm_tp0&#45;&gt;layer60_ffn_gate_tp0</title>
<path fill="none" stroke="black" d="M3277.61,-807.57C3311.72,-796.97 3351.61,-784.58 3386.71,-773.67"/>
<polygon fill="black" stroke="black" points="3387.96,-776.95 3396.47,-770.64 3385.88,-770.26 3387.96,-776.95"/>
</g>
<!-- layer60_ffn_up_tp0 -->
<g id="node108" class="node">
<title>layer60_ffn_up_tp0</title>
<polygon fill="none" stroke="black" points="3328,-770.62 3066,-770.62 3066,-718.62 3328,-718.62 3328,-770.62"/>
<text text-anchor="middle" x="3197" y="-758.62" font-family="Arial" font-size="10.00">Layer 60 FFN Up</text>
<text text-anchor="middle" x="3197" y="-747.62" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3197" y="-736.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="3197" y="-725.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer60_post_norm_tp0&#45;&gt;layer60_ffn_up_tp0 -->
<g id="edge138" class="edge">
<title>layer60_post_norm_tp0&#45;&gt;layer60_ffn_up_tp0</title>
<path fill="none" stroke="black" d="M3197,-807.45C3197,-799.16 3197,-789.77 3197,-780.87"/>
<polygon fill="black" stroke="black" points="3200.5,-780.72 3197,-770.72 3193.5,-780.72 3200.5,-780.72"/>
</g>
<!-- layer60_ffn_activation_tp0 -->
<g id="node109" class="node">
<title>layer60_ffn_activation_tp0</title>
<polygon fill="none" stroke="black" points="3328,-681.62 3066,-681.62 3066,-629.62 3328,-629.62 3328,-681.62"/>
<text text-anchor="middle" x="3197" y="-669.62" font-family="Arial" font-size="10.00">Layer 60 FFN SwiGLU</text>
<text text-anchor="middle" x="3197" y="-658.62" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3197" y="-647.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="3197" y="-636.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer60_ffn_gate_tp0&#45;&gt;layer60_ffn_activation_tp0 -->
<g id="edge139" class="edge">
<title>layer60_ffn_gate_tp0&#45;&gt;layer60_ffn_activation_tp0</title>
<path fill="none" stroke="black" d="M3396.39,-718.57C3362.28,-707.97 3322.39,-695.58 3287.29,-684.67"/>
<polygon fill="black" stroke="black" points="3288.12,-681.26 3277.53,-681.64 3286.04,-687.95 3288.12,-681.26"/>
</g>
<!-- layer60_ffn_up_tp0&#45;&gt;layer60_ffn_activation_tp0 -->
<g id="edge140" class="edge">
<title>layer60_ffn_up_tp0&#45;&gt;layer60_ffn_activation_tp0</title>
<path fill="none" stroke="black" d="M3197,-718.45C3197,-710.16 3197,-700.77 3197,-691.87"/>
<polygon fill="black" stroke="black" points="3200.5,-691.72 3197,-681.72 3193.5,-691.72 3200.5,-691.72"/>
</g>
<!-- layer60_ffn_down_tp0 -->
<g id="node110" class="node">
<title>layer60_ffn_down_tp0</title>
<polygon fill="none" stroke="black" points="3336,-471.62 3082,-471.62 3082,-419.62 3336,-419.62 3336,-471.62"/>
<text text-anchor="middle" x="3209" y="-459.62" font-family="Arial" font-size="10.00">Layer 60 FFN Down</text>
<text text-anchor="middle" x="3209" y="-448.62" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3209" y="-437.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="3209" y="-426.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer60_ffn_activation_tp0&#45;&gt;layer60_ffn_down_tp0 -->
<g id="edge141" class="edge">
<title>layer60_ffn_activation_tp0&#45;&gt;layer60_ffn_down_tp0</title>
<path fill="none" stroke="black" d="M3198.45,-629.53C3200.57,-592.67 3204.55,-523.74 3206.97,-481.83"/>
<polygon fill="black" stroke="black" points="3210.47,-481.98 3207.55,-471.8 3203.48,-481.58 3210.47,-481.98"/>
</g>
<!-- layer60_ffn_allreduce_tp0 -->
<g id="node111" class="node">
<title>layer60_ffn_allreduce_tp0</title>
<ellipse fill="none" stroke="black" cx="3265" cy="-125.77" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="3265" y="-139.77" font-family="Arial" font-size="10.00">Layer 60 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="3265" y="-128.77" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3265" y="-117.77" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="3265" y="-106.77" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer60_ffn_down_tp0&#45;&gt;layer60_ffn_allreduce_tp0 -->
<g id="edge142" class="edge">
<title>layer60_ffn_down_tp0&#45;&gt;layer60_ffn_allreduce_tp0</title>
<path fill="none" stroke="black" d="M3213.44,-419.41C3222.85,-365.99 3244.92,-240.72 3256.91,-172.69"/>
<polygon fill="black" stroke="black" points="3260.38,-173.14 3258.67,-162.68 3253.49,-171.93 3260.38,-173.14"/>
</g>
<!-- layer60_ffn_allreduce_tp1 -->
<g id="node112" class="node">
<title>layer60_ffn_allreduce_tp1</title>
<ellipse fill="none" stroke="black" cx="3428" cy="-245.31" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="3428" y="-259.31" font-family="Arial" font-size="10.00">Layer 60 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="3428" y="-248.31" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3428" y="-237.31" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="3428" y="-226.31" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer60_ffn_allreduce_tp0&#45;&gt;layer60_ffn_allreduce_tp1 -->
<g id="edge143" class="edge">
<title>layer60_ffn_allreduce_tp0&#45;&gt;layer60_ffn_allreduce_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3301.02,-161.68C3311.88,-171.49 3324.09,-181.85 3336,-190.54 3342.98,-195.63 3350.48,-200.66 3358.07,-205.47"/>
<polygon fill="black" stroke="black" points="3356.66,-208.72 3367,-211.01 3360.35,-202.77 3356.66,-208.72"/>
<text text-anchor="middle" x="3352.5" y="-183.34" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer60_ffn_allreduce_tp0&#45;&gt;layer60_final_residual_tp0 -->
<g id="edge144" class="edge">
<title>layer60_ffn_allreduce_tp0&#45;&gt;layer60_final_residual_tp0</title>
<path fill="none" stroke="black" d="M3199.86,-91.94C3177.13,-80.48 3151.76,-67.7 3129.59,-56.53"/>
<polygon fill="black" stroke="black" points="3131.13,-53.38 3120.63,-52.01 3127.98,-59.64 3131.13,-53.38"/>
</g>
<!-- layer60_ffn_allreduce_tp1&#45;&gt;layer60_ffn_allreduce_tp0 -->
<g id="edge162" class="edge">
<title>layer60_ffn_allreduce_tp1&#45;&gt;layer60_ffn_allreduce_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3399.37,-209.01C3390.3,-199.08 3379.8,-188.76 3369,-180.54 3361.3,-174.68 3352.86,-169.13 3344.23,-163.99"/>
<polygon fill="black" stroke="black" points="3345.97,-160.96 3335.56,-158.99 3342.47,-167.02 3345.97,-160.96"/>
<text text-anchor="middle" x="3396.5" y="-183.34" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer60_final_residual_tp1 -->
<g id="node125" class="node">
<title>layer60_final_residual_tp1</title>
<polygon fill="none" stroke="black" points="3963,-151.77 3731,-151.77 3731,-99.77 3963,-99.77 3963,-151.77"/>
<text text-anchor="middle" x="3847" y="-139.77" font-family="Arial" font-size="10.00">Layer 60 Final Residual</text>
<text text-anchor="middle" x="3847" y="-128.77" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3847" y="-117.77" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="3847" y="-106.77" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer60_ffn_allreduce_tp1&#45;&gt;layer60_final_residual_tp1 -->
<g id="edge163" class="edge">
<title>layer60_ffn_allreduce_tp1&#45;&gt;layer60_final_residual_tp1</title>
<path fill="none" stroke="black" d="M3528.36,-216.16C3594.8,-197.52 3681.55,-173.18 3747.76,-154.61"/>
<polygon fill="black" stroke="black" points="3749.1,-157.87 3757.79,-151.8 3747.21,-151.13 3749.1,-157.87"/>
</g>
<!-- layer60_qkv_tp1 -->
<g id="node115" class="node">
<title>layer60_qkv_tp1</title>
<polygon fill="none" stroke="black" points="3803.5,-1569.23 3558.5,-1569.23 3558.5,-1517.23 3803.5,-1517.23 3803.5,-1569.23"/>
<text text-anchor="middle" x="3681" y="-1557.23" font-family="Arial" font-size="10.00">Layer 60 QKV Projection</text>
<text text-anchor="middle" x="3681" y="-1546.23" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3681" y="-1535.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="3681" y="-1524.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
</g>
<!-- layer60_norm_tp1&#45;&gt;layer60_qkv_tp1 -->
<g id="edge147" class="edge">
<title>layer60_norm_tp1&#45;&gt;layer60_qkv_tp1</title>
<path fill="none" stroke="black" d="M3690.24,-1606.07C3689,-1597.77 3687.6,-1588.39 3686.27,-1579.48"/>
<polygon fill="black" stroke="black" points="3689.69,-1578.72 3684.75,-1569.34 3682.77,-1579.75 3689.69,-1578.72"/>
</g>
<!-- layer60_attention_scores_tp1 -->
<g id="node116" class="node">
<title>layer60_attention_scores_tp1</title>
<polygon fill="none" stroke="black" points="3829.5,-1480.23 3516.5,-1480.23 3516.5,-1428.23 3829.5,-1428.23 3829.5,-1480.23"/>
<text text-anchor="middle" x="3673" y="-1468.23" font-family="Arial" font-size="10.00">Layer 60 Attention Scores</text>
<text text-anchor="middle" x="3673" y="-1457.23" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3673" y="-1446.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
<text text-anchor="middle" x="3673" y="-1435.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer60_qkv_tp1&#45;&gt;layer60_attention_scores_tp1 -->
<g id="edge148" class="edge">
<title>layer60_qkv_tp1&#45;&gt;layer60_attention_scores_tp1</title>
<path fill="none" stroke="black" d="M3678.69,-1517.07C3677.92,-1508.77 3677.06,-1499.39 3676.24,-1490.48"/>
<polygon fill="black" stroke="black" points="3679.71,-1489.98 3675.31,-1480.34 3672.74,-1490.62 3679.71,-1489.98"/>
</g>
<!-- layer60_attention_weights_tp1 -->
<g id="node117" class="node">
<title>layer60_attention_weights_tp1</title>
<polygon fill="none" stroke="black" points="3829.5,-1391.23 3516.5,-1391.23 3516.5,-1339.23 3829.5,-1339.23 3829.5,-1391.23"/>
<text text-anchor="middle" x="3673" y="-1379.23" font-family="Arial" font-size="10.00">Layer 60 Attention Weights</text>
<text text-anchor="middle" x="3673" y="-1368.23" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3673" y="-1357.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="3673" y="-1346.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer60_attention_scores_tp1&#45;&gt;layer60_attention_weights_tp1 -->
<g id="edge149" class="edge">
<title>layer60_attention_scores_tp1&#45;&gt;layer60_attention_weights_tp1</title>
<path fill="none" stroke="black" d="M3673,-1428.07C3673,-1419.77 3673,-1410.39 3673,-1401.48"/>
<polygon fill="black" stroke="black" points="3676.5,-1401.34 3673,-1391.34 3669.5,-1401.34 3676.5,-1401.34"/>
</g>
<!-- layer60_attention_output_tp1 -->
<g id="node118" class="node">
<title>layer60_attention_output_tp1</title>
<polygon fill="none" stroke="black" points="3750.5,-1159.7 3445.5,-1159.7 3445.5,-1107.7 3750.5,-1107.7 3750.5,-1159.7"/>
<text text-anchor="middle" x="3598" y="-1147.7" font-family="Arial" font-size="10.00">Layer 60 Attention Output</text>
<text text-anchor="middle" x="3598" y="-1136.7" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3598" y="-1125.7" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="3598" y="-1114.7" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer60_attention_weights_tp1&#45;&gt;layer60_attention_output_tp1 -->
<g id="edge150" class="edge">
<title>layer60_attention_weights_tp1&#45;&gt;layer60_attention_output_tp1</title>
<path fill="none" stroke="black" d="M3664.83,-1339.23C3651.43,-1298.21 3624.73,-1216.49 3609.44,-1169.72"/>
<polygon fill="black" stroke="black" points="3612.71,-1168.43 3606.27,-1160.02 3606.05,-1170.61 3612.71,-1168.43"/>
</g>
<!-- layer60_attention_output_tp1&#45;&gt;layer60_attention_allreduce_tp1 -->
<g id="edge151" class="edge">
<title>layer60_attention_output_tp1&#45;&gt;layer60_attention_allreduce_tp1</title>
<path fill="none" stroke="black" d="M3587.11,-1107.58C3573.13,-1075.35 3548.64,-1018.88 3531.44,-979.21"/>
<polygon fill="black" stroke="black" points="3534.64,-977.79 3527.45,-970.01 3528.22,-980.58 3534.64,-977.79"/>
</g>
<!-- layer60_post_norm_tp1 -->
<g id="node120" class="node">
<title>layer60_post_norm_tp1</title>
<polygon fill="none" stroke="black" points="3873,-770.62 3641,-770.62 3641,-718.62 3873,-718.62 3873,-770.62"/>
<text text-anchor="middle" x="3757" y="-758.62" font-family="Arial" font-size="10.00">Layer 60 Post&#45;Attention RMSNorm</text>
<text text-anchor="middle" x="3757" y="-747.62" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3757" y="-736.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="3757" y="-725.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer60_residual_tp1&#45;&gt;layer60_post_norm_tp1 -->
<g id="edge155" class="edge">
<title>layer60_residual_tp1&#45;&gt;layer60_post_norm_tp1</title>
<path fill="none" stroke="black" d="M3816.7,-807.45C3807.82,-798.26 3797.65,-787.72 3788.25,-777.98"/>
<polygon fill="black" stroke="black" points="3790.71,-775.49 3781.24,-770.72 3785.67,-780.35 3790.71,-775.49"/>
</g>
<!-- layer60_residual_tp1&#45;&gt;layer60_final_residual_tp1 -->
<g id="edge164" class="edge">
<title>layer60_residual_tp1&#45;&gt;layer60_final_residual_tp1</title>
<path fill="none" stroke="black" d="M3879.38,-807.54C3897.83,-792.21 3916,-770.74 3916,-745.62 3916,-745.62 3916,-745.62 3916,-244.31 3916,-212.49 3896.96,-181.66 3878.88,-159.57"/>
<polygon fill="black" stroke="black" points="3881.45,-157.18 3872.3,-151.84 3876.12,-161.72 3881.45,-157.18"/>
</g>
<!-- layer60_ffn_gate_tp1 -->
<g id="node121" class="node">
<title>layer60_ffn_gate_tp1</title>
<polygon fill="none" stroke="black" points="3608,-681.62 3346,-681.62 3346,-629.62 3608,-629.62 3608,-681.62"/>
<text text-anchor="middle" x="3477" y="-669.62" font-family="Arial" font-size="10.00">Layer 60 FFN Gate</text>
<text text-anchor="middle" x="3477" y="-658.62" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3477" y="-647.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="3477" y="-636.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer60_post_norm_tp1&#45;&gt;layer60_ffn_gate_tp1 -->
<g id="edge156" class="edge">
<title>layer60_post_norm_tp1&#45;&gt;layer60_ffn_gate_tp1</title>
<path fill="none" stroke="black" d="M3676.39,-718.57C3642.28,-707.97 3602.39,-695.58 3567.29,-684.67"/>
<polygon fill="black" stroke="black" points="3568.12,-681.26 3557.53,-681.64 3566.04,-687.95 3568.12,-681.26"/>
</g>
<!-- layer60_ffn_up_tp1 -->
<g id="node122" class="node">
<title>layer60_ffn_up_tp1</title>
<polygon fill="none" stroke="black" points="3888,-681.62 3626,-681.62 3626,-629.62 3888,-629.62 3888,-681.62"/>
<text text-anchor="middle" x="3757" y="-669.62" font-family="Arial" font-size="10.00">Layer 60 FFN Up</text>
<text text-anchor="middle" x="3757" y="-658.62" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3757" y="-647.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="3757" y="-636.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer60_post_norm_tp1&#45;&gt;layer60_ffn_up_tp1 -->
<g id="edge157" class="edge">
<title>layer60_post_norm_tp1&#45;&gt;layer60_ffn_up_tp1</title>
<path fill="none" stroke="black" d="M3757,-718.45C3757,-710.16 3757,-700.77 3757,-691.87"/>
<polygon fill="black" stroke="black" points="3760.5,-691.72 3757,-681.72 3753.5,-691.72 3760.5,-691.72"/>
</g>
<!-- layer60_ffn_activation_tp1 -->
<g id="node123" class="node">
<title>layer60_ffn_activation_tp1</title>
<polygon fill="none" stroke="black" points="3608,-541.62 3346,-541.62 3346,-489.62 3608,-489.62 3608,-541.62"/>
<text text-anchor="middle" x="3477" y="-529.62" font-family="Arial" font-size="10.00">Layer 60 FFN SwiGLU</text>
<text text-anchor="middle" x="3477" y="-518.62" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3477" y="-507.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="3477" y="-496.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer60_ffn_gate_tp1&#45;&gt;layer60_ffn_activation_tp1 -->
<g id="edge158" class="edge">
<title>layer60_ffn_gate_tp1&#45;&gt;layer60_ffn_activation_tp1</title>
<path fill="none" stroke="black" d="M3477,-629.31C3477,-607.62 3477,-576.14 3477,-551.97"/>
<polygon fill="black" stroke="black" points="3480.5,-551.77 3477,-541.77 3473.5,-551.77 3480.5,-551.77"/>
</g>
<!-- layer60_ffn_up_tp1&#45;&gt;layer60_ffn_activation_tp1 -->
<g id="edge159" class="edge">
<title>layer60_ffn_up_tp1&#45;&gt;layer60_ffn_activation_tp1</title>
<path fill="none" stroke="black" d="M3705.97,-629.47C3658.45,-606.05 3587.58,-571.12 3537.29,-546.33"/>
<polygon fill="black" stroke="black" points="3538.67,-543.11 3528.15,-541.83 3535.58,-549.39 3538.67,-543.11"/>
</g>
<!-- layer60_ffn_down_tp1 -->
<g id="node124" class="node">
<title>layer60_ffn_down_tp1</title>
<polygon fill="none" stroke="black" points="3600,-390.85 3346,-390.85 3346,-338.85 3600,-338.85 3600,-390.85"/>
<text text-anchor="middle" x="3473" y="-378.85" font-family="Arial" font-size="10.00">Layer 60 FFN Down</text>
<text text-anchor="middle" x="3473" y="-367.85" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3473" y="-356.85" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="3473" y="-345.85" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer60_ffn_activation_tp1&#45;&gt;layer60_ffn_down_tp1 -->
<g id="edge160" class="edge">
<title>layer60_ffn_activation_tp1&#45;&gt;layer60_ffn_down_tp1</title>
<path fill="none" stroke="black" d="M3476.32,-489.38C3475.67,-465.23 3474.69,-428.57 3473.96,-401.45"/>
<polygon fill="black" stroke="black" points="3477.45,-401.11 3473.68,-391.21 3470.45,-401.3 3477.45,-401.11"/>
</g>
<!-- layer60_ffn_down_tp1&#45;&gt;layer60_ffn_allreduce_tp1 -->
<g id="edge161" class="edge">
<title>layer60_ffn_down_tp1&#45;&gt;layer60_ffn_allreduce_tp1</title>
<path fill="none" stroke="black" d="M3463.35,-338.63C3458.13,-325 3451.52,-307.75 3445.44,-291.86"/>
<polygon fill="black" stroke="black" points="3448.58,-290.27 3441.74,-282.19 3442.04,-292.78 3448.58,-290.27"/>
</g>
<!-- layer79_norm_tp0 -->
<g id="node126" class="node">
<title>layer79_norm_tp0</title>
<polygon fill="none" stroke="black" points="4348,-1773.23 4116,-1773.23 4116,-1721.23 4348,-1721.23 4348,-1773.23"/>
<text text-anchor="middle" x="4232" y="-1761.23" font-family="Arial" font-size="10.00">Layer 79 RMSNorm</text>
<text text-anchor="middle" x="4232" y="-1750.23" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="4232" y="-1739.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="4232" y="-1728.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer79_qkv_tp0 -->
<g id="node128" class="node">
<title>layer79_qkv_tp0</title>
<polygon fill="none" stroke="black" points="4381.5,-1658.23 4136.5,-1658.23 4136.5,-1606.23 4381.5,-1606.23 4381.5,-1658.23"/>
<text text-anchor="middle" x="4259" y="-1646.23" font-family="Arial" font-size="10.00">Layer 79 QKV Projection</text>
<text text-anchor="middle" x="4259" y="-1635.23" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="4259" y="-1624.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="4259" y="-1613.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
</g>
<!-- layer79_norm_tp0&#45;&gt;layer79_qkv_tp0 -->
<g id="edge166" class="edge">
<title>layer79_norm_tp0&#45;&gt;layer79_qkv_tp0</title>
<path fill="none" stroke="black" d="M4237.99,-1721.16C4241.7,-1705.65 4246.51,-1685.51 4250.59,-1668.42"/>
<polygon fill="black" stroke="black" points="4254.1,-1668.78 4253.02,-1658.24 4247.3,-1667.16 4254.1,-1668.78"/>
</g>
<!-- layer78_final_residual_tp0 -->
<g id="node127" class="node">
<title>layer78_final_residual_tp0</title>
<ellipse fill="none" stroke="black" cx="4141" cy="-1865.73" rx="75.88" ry="18"/>
<text text-anchor="middle" x="4141" y="-1863.23" font-family="Arial" font-size="10.00">layer78_final_residual_tp0</text>
</g>
<!-- layer78_final_residual_tp0&#45;&gt;layer79_norm_tp0 -->
<g id="edge165" class="edge">
<title>layer78_final_residual_tp0&#45;&gt;layer79_norm_tp0</title>
<path fill="none" stroke="black" d="M4154.43,-1847.54C4168.02,-1830.15 4189.37,-1802.8 4206.24,-1781.21"/>
<polygon fill="black" stroke="black" points="4209.06,-1783.28 4212.46,-1773.25 4203.55,-1778.98 4209.06,-1783.28"/>
</g>
<!-- layer79_residual_tp0 -->
<g id="node134" class="node">
<title>layer79_residual_tp0</title>
<polygon fill="none" stroke="black" points="4215,-1078.93 3983,-1078.93 3983,-1026.93 4215,-1026.93 4215,-1078.93"/>
<text text-anchor="middle" x="4099" y="-1066.93" font-family="Arial" font-size="10.00">Layer 79 Residual Add</text>
<text text-anchor="middle" x="4099" y="-1055.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="4099" y="-1044.93" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="4099" y="-1033.93" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer78_final_residual_tp0&#45;&gt;layer79_residual_tp0 -->
<g id="edge173" class="edge">
<title>layer78_final_residual_tp0&#45;&gt;layer79_residual_tp0</title>
<path fill="none" stroke="black" d="M4127.37,-1847.72C4111.38,-1825.99 4087,-1786.58 4087,-1748.23 4087,-1748.23 4087,-1748.23 4087,-1213.47 4087,-1170.67 4091.35,-1121.59 4094.81,-1089.3"/>
<polygon fill="black" stroke="black" points="4098.32,-1089.35 4095.94,-1079.03 4091.37,-1088.58 4098.32,-1089.35"/>
</g>
<!-- layer79_attention_scores_tp0 -->
<g id="node129" class="node">
<title>layer79_attention_scores_tp0</title>
<polygon fill="none" stroke="black" points="4429.5,-1569.23 4116.5,-1569.23 4116.5,-1517.23 4429.5,-1517.23 4429.5,-1569.23"/>
<text text-anchor="middle" x="4273" y="-1557.23" font-family="Arial" font-size="10.00">Layer 79 Attention Scores</text>
<text text-anchor="middle" x="4273" y="-1546.23" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="4273" y="-1535.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
<text text-anchor="middle" x="4273" y="-1524.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer79_qkv_tp0&#45;&gt;layer79_attention_scores_tp0 -->
<g id="edge167" class="edge">
<title>layer79_qkv_tp0&#45;&gt;layer79_attention_scores_tp0</title>
<path fill="none" stroke="black" d="M4263.05,-1606.07C4264.38,-1597.77 4265.89,-1588.39 4267.33,-1579.48"/>
<polygon fill="black" stroke="black" points="4270.83,-1579.77 4268.96,-1569.34 4263.92,-1578.66 4270.83,-1579.77"/>
</g>
<!-- layer79_attention_weights_tp0 -->
<g id="node130" class="node">
<title>layer79_attention_weights_tp0</title>
<polygon fill="none" stroke="black" points="4433.5,-1480.23 4120.5,-1480.23 4120.5,-1428.23 4433.5,-1428.23 4433.5,-1480.23"/>
<text text-anchor="middle" x="4277" y="-1468.23" font-family="Arial" font-size="10.00">Layer 79 Attention Weights</text>
<text text-anchor="middle" x="4277" y="-1457.23" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="4277" y="-1446.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="4277" y="-1435.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer79_attention_scores_tp0&#45;&gt;layer79_attention_weights_tp0 -->
<g id="edge168" class="edge">
<title>layer79_attention_scores_tp0&#45;&gt;layer79_attention_weights_tp0</title>
<path fill="none" stroke="black" d="M4274.16,-1517.07C4274.54,-1508.77 4274.97,-1499.39 4275.38,-1490.48"/>
<polygon fill="black" stroke="black" points="4278.88,-1490.49 4275.85,-1480.34 4271.89,-1490.17 4278.88,-1490.49"/>
</g>
<!-- layer79_attention_output_tp0 -->
<g id="node131" class="node">
<title>layer79_attention_output_tp0</title>
<polygon fill="none" stroke="black" points="4430.5,-1391.23 4125.5,-1391.23 4125.5,-1339.23 4430.5,-1339.23 4430.5,-1391.23"/>
<text text-anchor="middle" x="4278" y="-1379.23" font-family="Arial" font-size="10.00">Layer 79 Attention Output</text>
<text text-anchor="middle" x="4278" y="-1368.23" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="4278" y="-1357.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="4278" y="-1346.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer79_attention_weights_tp0&#45;&gt;layer79_attention_output_tp0 -->
<g id="edge169" class="edge">
<title>layer79_attention_weights_tp0&#45;&gt;layer79_attention_output_tp0</title>
<path fill="none" stroke="black" d="M4277.29,-1428.07C4277.38,-1419.77 4277.49,-1410.39 4277.59,-1401.48"/>
<polygon fill="black" stroke="black" points="4281.1,-1401.38 4277.71,-1391.34 4274.1,-1401.3 4281.1,-1401.38"/>
</g>
<!-- layer79_attention_allreduce_tp0 -->
<g id="node132" class="node">
<title>layer79_attention_allreduce_tp0</title>
<ellipse fill="none" stroke="black" cx="4279" cy="-1214.47" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="4279" y="-1228.47" font-family="Arial" font-size="10.00">Layer 79 Attention All&#45;Reduce</text>
<text text-anchor="middle" x="4279" y="-1217.47" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="4279" y="-1206.47" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="4279" y="-1195.47" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer79_attention_output_tp0&#45;&gt;layer79_attention_allreduce_tp0 -->
<g id="edge170" class="edge">
<title>layer79_attention_output_tp0&#45;&gt;layer79_attention_allreduce_tp0</title>
<path fill="none" stroke="black" d="M4278.17,-1339C4278.31,-1317.87 4278.52,-1287.16 4278.69,-1261.65"/>
<polygon fill="black" stroke="black" points="4282.19,-1261.46 4278.76,-1251.44 4275.19,-1261.42 4282.19,-1261.46"/>
</g>
<!-- layer79_attention_allreduce_tp1 -->
<g id="node133" class="node">
<title>layer79_attention_allreduce_tp1</title>
<ellipse fill="none" stroke="black" cx="4548" cy="-1052.93" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="4548" y="-1066.93" font-family="Arial" font-size="10.00">Layer 79 Attention All&#45;Reduce</text>
<text text-anchor="middle" x="4548" y="-1055.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="4548" y="-1044.93" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="4548" y="-1033.93" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer79_attention_allreduce_tp0&#45;&gt;layer79_attention_allreduce_tp1 -->
<g id="edge171" class="edge">
<title>layer79_attention_allreduce_tp0&#45;&gt;layer79_attention_allreduce_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4318.67,-1178.53C4345.23,-1156.31 4381.67,-1128 4417,-1107.7 4428.83,-1100.89 4441.7,-1094.51 4454.59,-1088.69"/>
<polygon fill="black" stroke="black" points="4456.23,-1091.79 4463.96,-1084.55 4453.4,-1085.39 4456.23,-1091.79"/>
<text text-anchor="middle" x="4433.5" y="-1131.5" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer79_attention_allreduce_tp0&#45;&gt;layer79_residual_tp0 -->
<g id="edge172" class="edge">
<title>layer79_attention_allreduce_tp0&#45;&gt;layer79_residual_tp0</title>
<path fill="none" stroke="black" d="M4239.5,-1178.45C4208.34,-1150.84 4165.24,-1112.64 4135.02,-1085.85"/>
<polygon fill="black" stroke="black" points="4137.05,-1082.97 4127.24,-1078.96 4132.4,-1088.21 4137.05,-1082.97"/>
</g>
<!-- layer79_attention_allreduce_tp1&#45;&gt;layer79_attention_allreduce_tp0 -->
<g id="edge190" class="edge">
<title>layer79_attention_allreduce_tp1&#45;&gt;layer79_attention_allreduce_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4522.95,-1089.36C4505.01,-1112.36 4478.98,-1141.36 4450,-1159.7 4434.8,-1169.31 4417.75,-1177.33 4400.45,-1183.97"/>
<polygon fill="black" stroke="black" points="4399,-1180.78 4390.83,-1187.53 4401.42,-1187.35 4399,-1180.78"/>
<text text-anchor="middle" x="4522.5" y="-1131.5" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer79_residual_tp1 -->
<g id="node149" class="node">
<title>layer79_residual_tp1</title>
<polygon fill="none" stroke="black" points="4899,-959.39 4667,-959.39 4667,-907.39 4899,-907.39 4899,-959.39"/>
<text text-anchor="middle" x="4783" y="-947.39" font-family="Arial" font-size="10.00">Layer 79 Residual Add</text>
<text text-anchor="middle" x="4783" y="-936.39" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="4783" y="-925.39" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="4783" y="-914.39" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer79_attention_allreduce_tp1&#45;&gt;layer79_residual_tp1 -->
<g id="edge191" class="edge">
<title>layer79_attention_allreduce_tp1&#45;&gt;layer79_residual_tp1</title>
<path fill="none" stroke="black" d="M4613.46,-1019.18C4647.97,-1001.92 4689.99,-980.91 4723.56,-964.12"/>
<polygon fill="black" stroke="black" points="4725.41,-967.1 4732.79,-959.5 4722.28,-960.84 4725.41,-967.1"/>
</g>
<!-- layer79_post_norm_tp0 -->
<g id="node135" class="node">
<title>layer79_post_norm_tp0</title>
<polygon fill="none" stroke="black" points="4308,-959.39 4076,-959.39 4076,-907.39 4308,-907.39 4308,-959.39"/>
<text text-anchor="middle" x="4192" y="-947.39" font-family="Arial" font-size="10.00">Layer 79 Post&#45;Attention RMSNorm</text>
<text text-anchor="middle" x="4192" y="-936.39" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="4192" y="-925.39" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="4192" y="-914.39" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer79_residual_tp0&#45;&gt;layer79_post_norm_tp0 -->
<g id="edge174" class="edge">
<title>layer79_residual_tp0&#45;&gt;layer79_post_norm_tp0</title>
<path fill="none" stroke="black" d="M4118.95,-1026.71C4132.62,-1009.44 4150.89,-986.34 4165.74,-967.58"/>
<polygon fill="black" stroke="black" points="4168.62,-969.57 4172.08,-959.56 4163.13,-965.23 4168.62,-969.57"/>
</g>
<!-- layer79_final_residual_tp0 -->
<g id="node142" class="node">
<title>layer79_final_residual_tp0</title>
<polygon fill="none" stroke="black" points="4436,-151.77 4204,-151.77 4204,-99.77 4436,-99.77 4436,-151.77"/>
<text text-anchor="middle" x="4320" y="-139.77" font-family="Arial" font-size="10.00">Layer 79 Final Residual</text>
<text text-anchor="middle" x="4320" y="-128.77" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="4320" y="-117.77" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="4320" y="-106.77" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer79_residual_tp0&#45;&gt;layer79_final_residual_tp0 -->
<g id="edge183" class="edge">
<title>layer79_residual_tp0&#45;&gt;layer79_final_residual_tp0</title>
<path fill="none" stroke="black" d="M4074.8,-1026.66C4055.96,-1004.27 4033,-969.73 4033,-934.39 4033,-934.39 4033,-934.39 4033,-244.31 4033,-206.81 4117.97,-175.32 4195.44,-154.4"/>
<polygon fill="black" stroke="black" points="4196.57,-157.72 4205.33,-151.78 4194.77,-150.96 4196.57,-157.72"/>
</g>
<!-- layer79_ffn_gate_tp0 -->
<g id="node136" class="node">
<title>layer79_ffn_gate_tp0</title>
<polygon fill="none" stroke="black" points="4603,-859.62 4341,-859.62 4341,-807.62 4603,-807.62 4603,-859.62"/>
<text text-anchor="middle" x="4472" y="-847.62" font-family="Arial" font-size="10.00">Layer 79 FFN Gate</text>
<text text-anchor="middle" x="4472" y="-836.62" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="4472" y="-825.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="4472" y="-814.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer79_post_norm_tp0&#45;&gt;layer79_ffn_gate_tp0 -->
<g id="edge175" class="edge">
<title>layer79_post_norm_tp0&#45;&gt;layer79_ffn_gate_tp0</title>
<path fill="none" stroke="black" d="M4263.74,-907.34C4302.44,-893.82 4350.36,-877.09 4390.47,-863.09"/>
<polygon fill="black" stroke="black" points="4391.67,-866.37 4399.96,-859.77 4389.36,-859.77 4391.67,-866.37"/>
</g>
<!-- layer79_ffn_up_tp0 -->
<g id="node137" class="node">
<title>layer79_ffn_up_tp0</title>
<polygon fill="none" stroke="black" points="4323,-859.62 4061,-859.62 4061,-807.62 4323,-807.62 4323,-859.62"/>
<text text-anchor="middle" x="4192" y="-847.62" font-family="Arial" font-size="10.00">Layer 79 FFN Up</text>
<text text-anchor="middle" x="4192" y="-836.62" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="4192" y="-825.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="4192" y="-814.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer79_post_norm_tp0&#45;&gt;layer79_ffn_up_tp0 -->
<g id="edge176" class="edge">
<title>layer79_post_norm_tp0&#45;&gt;layer79_ffn_up_tp0</title>
<path fill="none" stroke="black" d="M4192,-907.21C4192,-895.8 4192,-882.13 4192,-869.74"/>
<polygon fill="black" stroke="black" points="4195.5,-869.71 4192,-859.71 4188.5,-869.71 4195.5,-869.71"/>
</g>
<!-- layer79_ffn_activation_tp0 -->
<g id="node138" class="node">
<title>layer79_ffn_activation_tp0</title>
<polygon fill="none" stroke="black" points="4323,-770.62 4061,-770.62 4061,-718.62 4323,-718.62 4323,-770.62"/>
<text text-anchor="middle" x="4192" y="-758.62" font-family="Arial" font-size="10.00">Layer 79 FFN SwiGLU</text>
<text text-anchor="middle" x="4192" y="-747.62" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="4192" y="-736.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="4192" y="-725.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer79_ffn_gate_tp0&#45;&gt;layer79_ffn_activation_tp0 -->
<g id="edge177" class="edge">
<title>layer79_ffn_gate_tp0&#45;&gt;layer79_ffn_activation_tp0</title>
<path fill="none" stroke="black" d="M4391.39,-807.57C4357.28,-796.97 4317.39,-784.58 4282.29,-773.67"/>
<polygon fill="black" stroke="black" points="4283.12,-770.26 4272.53,-770.64 4281.04,-776.95 4283.12,-770.26"/>
</g>
<!-- layer79_ffn_up_tp0&#45;&gt;layer79_ffn_activation_tp0 -->
<g id="edge178" class="edge">
<title>layer79_ffn_up_tp0&#45;&gt;layer79_ffn_activation_tp0</title>
<path fill="none" stroke="black" d="M4192,-807.45C4192,-799.16 4192,-789.77 4192,-780.87"/>
<polygon fill="black" stroke="black" points="4195.5,-780.72 4192,-770.72 4188.5,-780.72 4195.5,-780.72"/>
</g>
<!-- layer79_ffn_down_tp0 -->
<g id="node139" class="node">
<title>layer79_ffn_down_tp0</title>
<polygon fill="none" stroke="black" points="4331,-611.62 4077,-611.62 4077,-559.62 4331,-559.62 4331,-611.62"/>
<text text-anchor="middle" x="4204" y="-599.62" font-family="Arial" font-size="10.00">Layer 79 FFN Down</text>
<text text-anchor="middle" x="4204" y="-588.62" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="4204" y="-577.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="4204" y="-566.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer79_ffn_activation_tp0&#45;&gt;layer79_ffn_down_tp0 -->
<g id="edge179" class="edge">
<title>layer79_ffn_activation_tp0&#45;&gt;layer79_ffn_down_tp0</title>
<path fill="none" stroke="black" d="M4193.93,-718.39C4195.92,-692.3 4199.05,-651.34 4201.29,-622.01"/>
<polygon fill="black" stroke="black" points="4204.8,-622.02 4202.08,-611.78 4197.82,-621.48 4204.8,-622.02"/>
</g>
<!-- layer79_ffn_allreduce_tp0 -->
<g id="node140" class="node">
<title>layer79_ffn_allreduce_tp0</title>
<ellipse fill="none" stroke="black" cx="4320" cy="-245.31" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="4320" y="-259.31" font-family="Arial" font-size="10.00">Layer 79 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="4320" y="-248.31" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="4320" y="-237.31" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="4320" y="-226.31" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer79_ffn_down_tp0&#45;&gt;layer79_ffn_allreduce_tp0 -->
<g id="edge180" class="edge">
<title>layer79_ffn_down_tp0&#45;&gt;layer79_ffn_allreduce_tp0</title>
<path fill="none" stroke="black" d="M4205.82,-559.47C4209.99,-512.2 4222.86,-407.72 4259,-328.08 4265.07,-314.71 4273.6,-301.43 4282.36,-289.58"/>
<polygon fill="black" stroke="black" points="4285.15,-291.69 4288.44,-281.62 4279.59,-287.44 4285.15,-291.69"/>
</g>
<!-- layer79_ffn_allreduce_tp1 -->
<g id="node141" class="node">
<title>layer79_ffn_allreduce_tp1</title>
<ellipse fill="none" stroke="black" cx="4432" cy="-364.85" rx="164.1" ry="36.54"/>
<text text-anchor="middle" x="4432" y="-378.85" font-family="Arial" font-size="10.00">Layer 79 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="4432" y="-367.85" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="4432" y="-356.85" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=4096]</text>
<text text-anchor="middle" x="4432" y="-345.85" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer79_ffn_allreduce_tp0&#45;&gt;layer79_ffn_allreduce_tp1 -->
<g id="edge181" class="edge">
<title>layer79_ffn_allreduce_tp0&#45;&gt;layer79_ffn_allreduce_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4346.47,-281.65C4354.07,-291.16 4362.59,-301.25 4371,-310.08 4374.84,-314.1 4378.93,-318.16 4383.12,-322.15"/>
<polygon fill="black" stroke="black" points="4381.02,-324.97 4390.73,-329.22 4385.79,-319.85 4381.02,-324.97"/>
<text text-anchor="middle" x="4387.5" y="-302.88" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer79_ffn_allreduce_tp0&#45;&gt;layer79_final_residual_tp0 -->
<g id="edge182" class="edge">
<title>layer79_ffn_allreduce_tp0&#45;&gt;layer79_final_residual_tp0</title>
<path fill="none" stroke="black" d="M4320,-208.4C4320,-193.74 4320,-176.82 4320,-162.2"/>
<polygon fill="black" stroke="black" points="4323.5,-162.03 4320,-152.03 4316.5,-162.03 4323.5,-162.03"/>
</g>
<!-- layer79_ffn_allreduce_tp1&#45;&gt;layer79_ffn_allreduce_tp0 -->
<g id="edge200" class="edge">
<title>layer79_ffn_allreduce_tp1&#45;&gt;layer79_ffn_allreduce_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4420.59,-327.95C4416.39,-318.23 4410.92,-308.16 4404,-300.08 4399.69,-295.04 4394.79,-290.3 4389.57,-285.9"/>
<polygon fill="black" stroke="black" points="4391.74,-283.15 4381.73,-279.67 4387.39,-288.63 4391.74,-283.15"/>
<text text-anchor="middle" x="4427.5" y="-302.88" font-family="Arial" font-size="9.00">TP sync</text>
</g>
<!-- layer79_final_residual_tp1 -->
<g id="node155" class="node">
<title>layer79_final_residual_tp1</title>
<polygon fill="none" stroke="black" points="4734,-271.31 4502,-271.31 4502,-219.31 4734,-219.31 4734,-271.31"/>
<text text-anchor="middle" x="4618" y="-259.31" font-family="Arial" font-size="10.00">Layer 79 Final Residual</text>
<text text-anchor="middle" x="4618" y="-248.31" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="4618" y="-237.31" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="4618" y="-226.31" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer79_ffn_allreduce_tp1&#45;&gt;layer79_final_residual_tp1 -->
<g id="edge201" class="edge">
<title>layer79_ffn_allreduce_tp1&#45;&gt;layer79_final_residual_tp1</title>
<path fill="none" stroke="black" d="M4485.8,-329.85C4512.31,-313.1 4544.02,-293.06 4569.73,-276.81"/>
<polygon fill="black" stroke="black" points="4571.63,-279.75 4578.21,-271.45 4567.89,-273.84 4571.63,-279.75"/>
</g>
<!-- output -->
<g id="node156" class="node">
<title>output</title>
<polygon fill="none" stroke="black" points="4615,-46.5 4383,-46.5 4383,-5.5 4615,-5.5 4615,-46.5"/>
<text text-anchor="middle" x="4499" y="-34.5" font-family="Arial" font-size="10.00">OUTPUT</text>
<text text-anchor="middle" x="4499" y="-23.5" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="4499" y="-12.5" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer79_final_residual_tp0&#45;&gt;output -->
<g id="edge203" class="edge">
<title>layer79_final_residual_tp0&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4366.1,-99.59C4393.27,-84.75 4427.49,-66.06 4454.4,-51.36"/>
<polygon fill="black" stroke="black" points="4456.13,-54.4 4463.23,-46.54 4452.77,-48.26 4456.13,-54.4"/>
</g>
<!-- layer79_norm_tp1 -->
<g id="node143" class="node">
<title>layer79_norm_tp1</title>
<polygon fill="none" stroke="black" points="4764,-1658.23 4532,-1658.23 4532,-1606.23 4764,-1606.23 4764,-1658.23"/>
<text text-anchor="middle" x="4648" y="-1646.23" font-family="Arial" font-size="10.00">Layer 79 RMSNorm</text>
<text text-anchor="middle" x="4648" y="-1635.23" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="4648" y="-1624.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="4648" y="-1613.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer79_qkv_tp1 -->
<g id="node145" class="node">
<title>layer79_qkv_tp1</title>
<polygon fill="none" stroke="black" points="4749.5,-1569.23 4504.5,-1569.23 4504.5,-1517.23 4749.5,-1517.23 4749.5,-1569.23"/>
<text text-anchor="middle" x="4627" y="-1557.23" font-family="Arial" font-size="10.00">Layer 79 QKV Projection</text>
<text text-anchor="middle" x="4627" y="-1546.23" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="4627" y="-1535.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="4627" y="-1524.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
</g>
<!-- layer79_norm_tp1&#45;&gt;layer79_qkv_tp1 -->
<g id="edge185" class="edge">
<title>layer79_norm_tp1&#45;&gt;layer79_qkv_tp1</title>
<path fill="none" stroke="black" d="M4641.93,-1606.07C4639.9,-1597.68 4637.61,-1588.19 4635.44,-1579.19"/>
<polygon fill="black" stroke="black" points="4638.81,-1578.24 4633.06,-1569.34 4632,-1579.88 4638.81,-1578.24"/>
</g>
<!-- layer78_final_residual_tp1 -->
<g id="node144" class="node">
<title>layer78_final_residual_tp1</title>
<ellipse fill="none" stroke="black" cx="4722" cy="-1747.23" rx="75.88" ry="18"/>
<text text-anchor="middle" x="4722" y="-1744.73" font-family="Arial" font-size="10.00">layer78_final_residual_tp1</text>
</g>
<!-- layer78_final_residual_tp1&#45;&gt;layer79_norm_tp1 -->
<g id="edge184" class="edge">
<title>layer78_final_residual_tp1&#45;&gt;layer79_norm_tp1</title>
<path fill="none" stroke="black" d="M4710.76,-1729.07C4700.01,-1712.65 4683.49,-1687.42 4670.09,-1666.97"/>
<polygon fill="black" stroke="black" points="4672.98,-1664.99 4664.57,-1658.54 4667.12,-1668.82 4672.98,-1664.99"/>
</g>
<!-- layer78_final_residual_tp1&#45;&gt;layer79_residual_tp1 -->
<g id="edge192" class="edge">
<title>layer78_final_residual_tp1&#45;&gt;layer79_residual_tp1</title>
<path fill="none" stroke="black" d="M4741.56,-1729.63C4763.19,-1709.31 4795,-1672.71 4795,-1633.23 4795,-1633.23 4795,-1633.23 4795,-1051.93 4795,-1024.18 4791.65,-992.93 4788.49,-969.64"/>
<polygon fill="black" stroke="black" points="4791.93,-968.95 4787.06,-959.53 4784.99,-969.92 4791.93,-968.95"/>
</g>
<!-- layer79_attention_scores_tp1 -->
<g id="node146" class="node">
<title>layer79_attention_scores_tp1</title>
<polygon fill="none" stroke="black" points="4766.5,-1480.23 4453.5,-1480.23 4453.5,-1428.23 4766.5,-1428.23 4766.5,-1480.23"/>
<text text-anchor="middle" x="4610" y="-1468.23" font-family="Arial" font-size="10.00">Layer 79 Attention Scores</text>
<text text-anchor="middle" x="4610" y="-1457.23" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="4610" y="-1446.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, qkv_dim=12288]</text>
<text text-anchor="middle" x="4610" y="-1435.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer79_qkv_tp1&#45;&gt;layer79_attention_scores_tp1 -->
<g id="edge186" class="edge">
<title>layer79_qkv_tp1&#45;&gt;layer79_attention_scores_tp1</title>
<path fill="none" stroke="black" d="M4622.08,-1517.07C4620.44,-1508.68 4618.59,-1499.19 4616.83,-1490.19"/>
<polygon fill="black" stroke="black" points="4620.26,-1489.49 4614.91,-1480.34 4613.39,-1490.83 4620.26,-1489.49"/>
</g>
<!-- layer79_attention_weights_tp1 -->
<g id="node147" class="node">
<title>layer79_attention_weights_tp1</title>
<polygon fill="none" stroke="black" points="4766.5,-1391.23 4453.5,-1391.23 4453.5,-1339.23 4766.5,-1339.23 4766.5,-1391.23"/>
<text text-anchor="middle" x="4610" y="-1379.23" font-family="Arial" font-size="10.00">Layer 79 Attention Weights</text>
<text text-anchor="middle" x="4610" y="-1368.23" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="4610" y="-1357.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="4610" y="-1346.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
</g>
<!-- layer79_attention_scores_tp1&#45;&gt;layer79_attention_weights_tp1 -->
<g id="edge187" class="edge">
<title>layer79_attention_scores_tp1&#45;&gt;layer79_attention_weights_tp1</title>
<path fill="none" stroke="black" d="M4610,-1428.07C4610,-1419.77 4610,-1410.39 4610,-1401.48"/>
<polygon fill="black" stroke="black" points="4613.5,-1401.34 4610,-1391.34 4606.5,-1401.34 4613.5,-1401.34"/>
</g>
<!-- layer79_attention_output_tp1 -->
<g id="node148" class="node">
<title>layer79_attention_output_tp1</title>
<polygon fill="none" stroke="black" points="4766.5,-1240.47 4461.5,-1240.47 4461.5,-1188.47 4766.5,-1188.47 4766.5,-1240.47"/>
<text text-anchor="middle" x="4614" y="-1228.47" font-family="Arial" font-size="10.00">Layer 79 Attention Output</text>
<text text-anchor="middle" x="4614" y="-1217.47" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="4614" y="-1206.47" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="4614" y="-1195.47" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer79_attention_weights_tp1&#45;&gt;layer79_attention_output_tp1 -->
<g id="edge188" class="edge">
<title>layer79_attention_weights_tp1&#45;&gt;layer79_attention_output_tp1</title>
<path fill="none" stroke="black" d="M4610.68,-1339C4611.33,-1314.85 4612.31,-1278.18 4613.04,-1251.07"/>
<polygon fill="black" stroke="black" points="4616.55,-1250.92 4613.32,-1240.83 4609.55,-1250.73 4616.55,-1250.92"/>
</g>
<!-- layer79_attention_output_tp1&#45;&gt;layer79_attention_allreduce_tp1 -->
<g id="edge189" class="edge">
<title>layer79_attention_output_tp1&#45;&gt;layer79_attention_allreduce_tp1</title>
<path fill="none" stroke="black" d="M4603.54,-1188.19C4593.68,-1164.35 4578.67,-1128.07 4566.74,-1099.23"/>
<polygon fill="black" stroke="black" points="4569.88,-1097.67 4562.83,-1089.77 4563.42,-1100.34 4569.88,-1097.67"/>
</g>
<!-- layer79_post_norm_tp1 -->
<g id="node150" class="node">
<title>layer79_post_norm_tp1</title>
<polygon fill="none" stroke="black" points="4868,-859.62 4636,-859.62 4636,-807.62 4868,-807.62 4868,-859.62"/>
<text text-anchor="middle" x="4752" y="-847.62" font-family="Arial" font-size="10.00">Layer 79 Post&#45;Attention RMSNorm</text>
<text text-anchor="middle" x="4752" y="-836.62" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="4752" y="-825.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="4752" y="-814.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=8192]</text>
</g>
<!-- layer79_residual_tp1&#45;&gt;layer79_post_norm_tp1 -->
<g id="edge193" class="edge">
<title>layer79_residual_tp1&#45;&gt;layer79_post_norm_tp1</title>
<path fill="none" stroke="black" d="M4775.02,-907.21C4771.36,-895.69 4766.98,-881.86 4763.02,-869.37"/>
<polygon fill="black" stroke="black" points="4766.32,-868.18 4759.96,-859.71 4759.64,-870.3 4766.32,-868.18"/>
</g>
<!-- layer79_residual_tp1&#45;&gt;layer79_final_residual_tp1 -->
<g id="edge202" class="edge">
<title>layer79_residual_tp1&#45;&gt;layer79_final_residual_tp1</title>
<path fill="none" stroke="black" d="M4852.99,-907.34C4882.88,-891.75 4911,-868.17 4911,-834.62 4911,-834.62 4911,-834.62 4911,-363.85 4911,-325.54 4823.66,-294.03 4744.35,-273.31"/>
<polygon fill="black" stroke="black" points="4744.78,-269.8 4734.22,-270.71 4743.04,-276.58 4744.78,-269.8"/>
</g>
<!-- layer79_ffn_gate_tp1 -->
<g id="node151" class="node">
<title>layer79_ffn_gate_tp1</title>
<polygon fill="none" stroke="black" points="4603,-770.62 4341,-770.62 4341,-718.62 4603,-718.62 4603,-770.62"/>
<text text-anchor="middle" x="4472" y="-758.62" font-family="Arial" font-size="10.00">Layer 79 FFN Gate</text>
<text text-anchor="middle" x="4472" y="-747.62" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="4472" y="-736.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="4472" y="-725.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer79_post_norm_tp1&#45;&gt;layer79_ffn_gate_tp1 -->
<g id="edge194" class="edge">
<title>layer79_post_norm_tp1&#45;&gt;layer79_ffn_gate_tp1</title>
<path fill="none" stroke="black" d="M4671.39,-807.57C4637.28,-796.97 4597.39,-784.58 4562.29,-773.67"/>
<polygon fill="black" stroke="black" points="4563.12,-770.26 4552.53,-770.64 4561.04,-776.95 4563.12,-770.26"/>
</g>
<!-- layer79_ffn_up_tp1 -->
<g id="node152" class="node">
<title>layer79_ffn_up_tp1</title>
<polygon fill="none" stroke="black" points="4883,-770.62 4621,-770.62 4621,-718.62 4883,-718.62 4883,-770.62"/>
<text text-anchor="middle" x="4752" y="-758.62" font-family="Arial" font-size="10.00">Layer 79 FFN Up</text>
<text text-anchor="middle" x="4752" y="-747.62" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="4752" y="-736.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden=8192]</text>
<text text-anchor="middle" x="4752" y="-725.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer79_post_norm_tp1&#45;&gt;layer79_ffn_up_tp1 -->
<g id="edge195" class="edge">
<title>layer79_post_norm_tp1&#45;&gt;layer79_ffn_up_tp1</title>
<path fill="none" stroke="black" d="M4752,-807.45C4752,-799.16 4752,-789.77 4752,-780.87"/>
<polygon fill="black" stroke="black" points="4755.5,-780.72 4752,-770.72 4748.5,-780.72 4755.5,-780.72"/>
</g>
<!-- layer79_ffn_activation_tp1 -->
<g id="node153" class="node">
<title>layer79_ffn_activation_tp1</title>
<polygon fill="none" stroke="black" points="4603,-681.62 4341,-681.62 4341,-629.62 4603,-629.62 4603,-681.62"/>
<text text-anchor="middle" x="4472" y="-669.62" font-family="Arial" font-size="10.00">Layer 79 FFN SwiGLU</text>
<text text-anchor="middle" x="4472" y="-658.62" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="4472" y="-647.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="4472" y="-636.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, intermediate=14336]</text>
</g>
<!-- layer79_ffn_gate_tp1&#45;&gt;layer79_ffn_activation_tp1 -->
<g id="edge196" class="edge">
<title>layer79_ffn_gate_tp1&#45;&gt;layer79_ffn_activation_tp1</title>
<path fill="none" stroke="black" d="M4472,-718.45C4472,-710.16 4472,-700.77 4472,-691.87"/>
<polygon fill="black" stroke="black" points="4475.5,-691.72 4472,-681.72 4468.5,-691.72 4475.5,-691.72"/>
</g>
<!-- layer79_ffn_up_tp1&#45;&gt;layer79_ffn_activation_tp1 -->
<g id="edge197" class="edge">
<title>layer79_ffn_up_tp1&#45;&gt;layer79_ffn_activation_tp1</title>
<path fill="none" stroke="black" d="M4671.39,-718.57C4637.28,-707.97 4597.39,-695.58 4562.29,-684.67"/>
<polygon fill="black" stroke="black" points="4563.12,-681.26 4552.53,-681.64 4561.04,-687.95 4563.12,-681.26"/>
</g>
<!-- layer79_ffn_down_tp1 -->
<g id="node154" class="node">
<title>layer79_ffn_down_tp1</title>
<polygon fill="none" stroke="black" points="4586,-541.62 4332,-541.62 4332,-489.62 4586,-489.62 4586,-541.62"/>
<text text-anchor="middle" x="4459" y="-529.62" font-family="Arial" font-size="10.00">Layer 79 FFN Down</text>
<text text-anchor="middle" x="4459" y="-518.62" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="4459" y="-507.62" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, intermediate=14336]</text>
<text text-anchor="middle" x="4459" y="-496.62" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden=4096]</text>
</g>
<!-- layer79_ffn_activation_tp1&#45;&gt;layer79_ffn_down_tp1 -->
<g id="edge198" class="edge">
<title>layer79_ffn_activation_tp1&#45;&gt;layer79_ffn_down_tp1</title>
<path fill="none" stroke="black" d="M4469.62,-629.31C4467.57,-607.62 4464.61,-576.14 4462.33,-551.97"/>
<polygon fill="black" stroke="black" points="4465.79,-551.4 4461.37,-541.77 4458.82,-552.05 4465.79,-551.4"/>
</g>
<!-- layer79_ffn_down_tp1&#45;&gt;layer79_ffn_allreduce_tp1 -->
<g id="edge199" class="edge">
<title>layer79_ffn_down_tp1&#45;&gt;layer79_ffn_allreduce_tp1</title>
<path fill="none" stroke="black" d="M4454.42,-489.38C4450.57,-468.16 4444.96,-437.27 4440.32,-411.69"/>
<polygon fill="black" stroke="black" points="4443.76,-411.04 4438.53,-401.82 4436.87,-412.29 4443.76,-411.04"/>
</g>
<!-- layer79_final_residual_tp1&#45;&gt;output -->
<g id="edge204" class="edge">
<title>layer79_final_residual_tp1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4604.12,-218.96C4581.78,-178.17 4538.02,-98.26 4514.63,-55.53"/>
<polygon fill="black" stroke="black" points="4517.69,-53.85 4509.82,-46.76 4511.55,-57.21 4517.69,-53.85"/>
</g>
</g>
</svg>
