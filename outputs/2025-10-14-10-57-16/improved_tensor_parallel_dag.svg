<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="804pt" height="2880pt"
 viewBox="0.00 0.00 803.56 2880.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.63 0.63) rotate(0) translate(4 4583.33)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-4583.33 1275.93,-4583.33 1275.93,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage_0</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="8,-1154.17 8,-4475.17 1186,-4475.17 1186,-1154.17 8,-1154.17"/>
<text text-anchor="middle" x="597" y="-4459.97" font-family="Times,serif" font-size="14.00">Stage 0: Layers 0&#45;7</text>
<text text-anchor="middle" x="597" y="-4444.97" font-family="Times,serif" font-size="14.00">Tensor Parallel across GPUs 0&#45;7</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_0_stage_0</title>
<polygon fill="none" stroke="blue" stroke-dasharray="1,5" points="16,-1914.17 16,-4429.17 1178,-4429.17 1178,-1914.17 16,-1914.17"/>
<text text-anchor="middle" x="597" y="-4413.97" font-family="Times,serif" font-size="14.00">Layer 0 &#45; Tensor Parallel</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage_1</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="142,-124.17 142,-1146.17 1128,-1146.17 1128,-124.17 142,-124.17"/>
<text text-anchor="middle" x="635" y="-1130.97" font-family="Times,serif" font-size="14.00">Stage 1: Layers 8&#45;15</text>
<text text-anchor="middle" x="635" y="-1115.97" font-family="Times,serif" font-size="14.00">Tensor Parallel across GPUs 8&#45;15</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="orange" stroke="black" cx="941" cy="-4531.25" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="941" y="-4550.05" font-family="Times,serif" font-size="14.00">Model Input</text>
<text text-anchor="middle" x="941" y="-4535.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="941" y="-4520.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="941" y="-4505.05" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- broadcast_0 -->
<g id="node2" class="node">
<title>broadcast_0</title>
<polygon fill="orange" stroke="black" points="1170.4,-4398.17 398.24,-4398.17 199.6,-4262.17 971.76,-4262.17 1170.4,-4398.17"/>
<text text-anchor="middle" x="685" y="-4348.97" font-family="Times,serif" font-size="14.00">Broadcast</text>
<text text-anchor="middle" x="685" y="-4333.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="685" y="-4318.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="685" y="-4303.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- input&#45;&gt;broadcast_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;broadcast_0</title>
<path fill="none" stroke="black" d="M881.3,-4483.82C851.07,-4460.32 813.66,-4431.22 779.63,-4404.75"/>
<polygon fill="black" stroke="black" points="781.55,-4401.82 771.51,-4398.44 777.26,-4407.35 781.55,-4401.82"/>
</g>
<!-- layer0_res1 -->
<g id="node15" class="node">
<title>layer0_res1</title>
<polygon fill="orange" stroke="black" points="989,-2884.17 521,-2884.17 521,-2801.17 989,-2801.17 989,-2884.17"/>
<text text-anchor="middle" x="755" y="-2868.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="755" y="-2853.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="755" y="-2838.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="755" y="-2823.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="755" y="-2808.97" font-family="Times,serif" font-size="14.00">GPU: GPU 0</text>
</g>
<!-- input&#45;&gt;layer0_res1 -->
<g id="edge17" class="edge">
<title>input&#45;&gt;layer0_res1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1148.83,-4493.73C1162.45,-4488.27 1173.09,-4482.11 1179,-4475.17 1260.43,-4379.52 1198,-4318.78 1198,-4193.17 1198,-4193.17 1198,-4193.17 1198,-3125.17 1198,-3030.6 1210.35,-2984.46 1141,-2920.17 1118,-2898.84 1061.82,-2882.97 999.24,-2871.38"/>
<polygon fill="black" stroke="black" points="999.6,-2867.89 989.14,-2869.56 998.36,-2874.78 999.6,-2867.89"/>
</g>
<!-- layer0_ln1 -->
<g id="node3" class="node">
<title>layer0_ln1</title>
<polygon fill="orange" stroke="black" points="919,-4226.17 451,-4226.17 451,-4158.17 919,-4158.17 919,-4226.17"/>
<text text-anchor="middle" x="685" y="-4210.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="685" y="-4195.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="685" y="-4180.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="685" y="-4165.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- broadcast_0&#45;&gt;layer0_ln1 -->
<g id="edge2" class="edge">
<title>broadcast_0&#45;&gt;layer0_ln1</title>
<path fill="none" stroke="black" d="M685,-4261.96C685,-4253.21 685,-4244.44 685,-4236.23"/>
<polygon fill="black" stroke="black" points="688.5,-4236.18 685,-4226.18 681.5,-4236.18 688.5,-4236.18"/>
</g>
<!-- layer0_qkv_split -->
<g id="node4" class="node">
<title>layer0_qkv_split</title>
<polygon fill="orange" stroke="black" points="1170.4,-4122.17 398.24,-4122.17 199.6,-3986.17 971.76,-3986.17 1170.4,-4122.17"/>
<text text-anchor="middle" x="685" y="-4072.97" font-family="Times,serif" font-size="14.00">Split QKV Input</text>
<text text-anchor="middle" x="685" y="-4057.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="685" y="-4042.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="685" y="-4027.97" font-family="Times,serif" font-size="14.00">GPU: Each GPU 0&#45;7 gets 1/8th</text>
</g>
<!-- layer0_ln1&#45;&gt;layer0_qkv_split -->
<g id="edge3" class="edge">
<title>layer0_ln1&#45;&gt;layer0_qkv_split</title>
<path fill="none" stroke="black" d="M685,-4157.9C685,-4150.07 685,-4141.4 685,-4132.52"/>
<polygon fill="black" stroke="black" points="688.5,-4132.43 685,-4122.43 681.5,-4132.43 688.5,-4132.43"/>
</g>
<!-- layer0_q_linear -->
<g id="node5" class="node">
<title>layer0_q_linear</title>
<polygon fill="orange" stroke="black" points="578,-3950.17 24,-3950.17 24,-3882.17 578,-3882.17 578,-3950.17"/>
<text text-anchor="middle" x="301" y="-3934.97" font-family="Times,serif" font-size="14.00">Query Linear</text>
<text text-anchor="middle" x="301" y="-3919.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="301" y="-3904.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=2, head_dim=512]</text>
<text text-anchor="middle" x="301" y="-3889.97" font-family="Times,serif" font-size="14.00">GPU: Each GPU 0&#45;7</text>
</g>
<!-- layer0_qkv_split&#45;&gt;layer0_q_linear -->
<g id="edge4" class="edge">
<title>layer0_qkv_split&#45;&gt;layer0_q_linear</title>
<path fill="none" stroke="black" d="M495.81,-3986.16C464.18,-3974.96 432.44,-3963.72 404.04,-3953.66"/>
<polygon fill="black" stroke="black" points="405.13,-3950.33 394.54,-3950.29 402.79,-3956.93 405.13,-3950.33"/>
</g>
<!-- layer0_k_linear -->
<g id="node6" class="node">
<title>layer0_k_linear</title>
<polygon fill="orange" stroke="black" points="1150,-3950.17 596,-3950.17 596,-3882.17 1150,-3882.17 1150,-3950.17"/>
<text text-anchor="middle" x="873" y="-3934.97" font-family="Times,serif" font-size="14.00">Key Linear</text>
<text text-anchor="middle" x="873" y="-3919.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="873" y="-3904.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=2, head_dim=512]</text>
<text text-anchor="middle" x="873" y="-3889.97" font-family="Times,serif" font-size="14.00">GPU: Each GPU 0&#45;7</text>
</g>
<!-- layer0_qkv_split&#45;&gt;layer0_k_linear -->
<g id="edge5" class="edge">
<title>layer0_qkv_split&#45;&gt;layer0_k_linear</title>
<path fill="none" stroke="black" d="M777.62,-3986.16C791.76,-3975.93 805.95,-3965.67 818.89,-3956.31"/>
<polygon fill="black" stroke="black" points="821.16,-3958.99 827.21,-3950.29 817.05,-3953.32 821.16,-3958.99"/>
</g>
<!-- layer0_v_linear -->
<g id="node7" class="node">
<title>layer0_v_linear</title>
<polygon fill="orange" stroke="black" points="1170,-3838.67 616,-3838.67 616,-3770.67 1170,-3770.67 1170,-3838.67"/>
<text text-anchor="middle" x="893" y="-3823.47" font-family="Times,serif" font-size="14.00">Value Linear</text>
<text text-anchor="middle" x="893" y="-3808.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="893" y="-3793.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=2, head_dim=512]</text>
<text text-anchor="middle" x="893" y="-3778.47" font-family="Times,serif" font-size="14.00">GPU: Each GPU 0&#45;7</text>
</g>
<!-- layer0_qkv_split&#45;&gt;layer0_v_linear -->
<g id="edge6" class="edge">
<title>layer0_qkv_split&#45;&gt;layer0_v_linear</title>
<path fill="none" stroke="black" d="M1011.17,-4013.04C1079.18,-3997.89 1137,-3977.46 1159,-3950.17 1177.97,-3926.64 1177.18,-3906.31 1159,-3882.17 1147.04,-3866.29 1115.03,-3852.68 1077.17,-3841.54"/>
<polygon fill="black" stroke="black" points="1078.01,-3838.13 1067.43,-3838.76 1076.09,-3844.87 1078.01,-3838.13"/>
</g>
<!-- layer0_attn_score -->
<g id="node8" class="node">
<title>layer0_attn_score</title>
<polygon fill="orange" stroke="black" points="597.5,-3846.17 40.5,-3846.17 40.5,-3763.17 597.5,-3763.17 597.5,-3846.17"/>
<text text-anchor="middle" x="319" y="-3830.97" font-family="Times,serif" font-size="14.00">Attention Score Q·K^T</text>
<text text-anchor="middle" x="319" y="-3815.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, num_heads=2, head_dim=512]</text>
<text text-anchor="middle" x="319" y="-3800.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=2, head_dim=512]</text>
<text text-anchor="middle" x="319" y="-3785.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="319" y="-3770.97" font-family="Times,serif" font-size="14.00">GPU: Each GPU 0&#45;7</text>
</g>
<!-- layer0_q_linear&#45;&gt;layer0_attn_score -->
<g id="edge7" class="edge">
<title>layer0_q_linear&#45;&gt;layer0_attn_score</title>
<path fill="none" stroke="black" d="M306.45,-3882.02C307.77,-3873.96 309.22,-3865.17 310.64,-3856.5"/>
<polygon fill="black" stroke="black" points="314.13,-3856.88 312.3,-3846.44 307.22,-3855.74 314.13,-3856.88"/>
</g>
<!-- layer0_k_linear&#45;&gt;layer0_attn_score -->
<g id="edge8" class="edge">
<title>layer0_k_linear&#45;&gt;layer0_attn_score</title>
<path fill="none" stroke="black" d="M706.03,-3882.16C651.89,-3871.46 591.06,-3859.44 533.94,-3848.15"/>
<polygon fill="black" stroke="black" points="534.56,-3844.7 524.07,-3846.2 533.2,-3851.57 534.56,-3844.7"/>
</g>
<!-- layer0_attn_out -->
<g id="node10" class="node">
<title>layer0_attn_out</title>
<polygon fill="orange" stroke="black" points="885,-3623.17 331,-3623.17 331,-3540.17 885,-3540.17 885,-3623.17"/>
<text text-anchor="middle" x="608" y="-3607.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="608" y="-3592.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, num_heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="608" y="-3577.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=2, head_dim=512]</text>
<text text-anchor="middle" x="608" y="-3562.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=2, head_dim=512]</text>
<text text-anchor="middle" x="608" y="-3547.97" font-family="Times,serif" font-size="14.00">GPU: Each GPU 0&#45;7</text>
</g>
<!-- layer0_v_linear&#45;&gt;layer0_attn_out -->
<g id="edge11" class="edge">
<title>layer0_v_linear&#45;&gt;layer0_attn_out</title>
<path fill="none" stroke="black" d="M850.33,-3770.58C802.11,-3733.19 723.23,-3672.02 668.62,-3629.68"/>
<polygon fill="black" stroke="black" points="670.46,-3626.67 660.41,-3623.31 666.17,-3632.2 670.46,-3626.67"/>
</g>
<!-- layer0_attn_weights -->
<g id="node9" class="node">
<title>layer0_attn_weights</title>
<polygon fill="orange" stroke="black" points="666.5,-3727.17 109.5,-3727.17 109.5,-3659.17 666.5,-3659.17 666.5,-3727.17"/>
<text text-anchor="middle" x="388" y="-3711.97" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="388" y="-3696.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="388" y="-3681.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="388" y="-3666.97" font-family="Times,serif" font-size="14.00">GPU: Each GPU 0&#45;7</text>
</g>
<!-- layer0_attn_score&#45;&gt;layer0_attn_weights -->
<g id="edge9" class="edge">
<title>layer0_attn_score&#45;&gt;layer0_attn_weights</title>
<path fill="none" stroke="black" d="M344.69,-3762.89C350.21,-3754.14 356.05,-3744.87 361.59,-3736.07"/>
<polygon fill="black" stroke="black" points="364.65,-3737.79 367.02,-3727.47 358.72,-3734.06 364.65,-3737.79"/>
</g>
<!-- layer0_attn_weights&#45;&gt;layer0_attn_out -->
<g id="edge10" class="edge">
<title>layer0_attn_weights&#45;&gt;layer0_attn_out</title>
<path fill="none" stroke="black" d="M454.31,-3659.16C474.12,-3649.3 496.2,-3638.31 517.29,-3627.81"/>
<polygon fill="black" stroke="black" points="518.87,-3630.94 526.27,-3623.35 515.75,-3624.67 518.87,-3630.94"/>
</g>
<!-- layer0_attn_gather -->
<g id="node11" class="node">
<title>layer0_attn_gather</title>
<polygon fill="orange" stroke="black" points="1169.84,-3504.17 276.08,-3504.17 46.16,-3368.17 939.92,-3368.17 1169.84,-3504.17"/>
<text text-anchor="middle" x="608" y="-3454.97" font-family="Times,serif" font-size="14.00">Gather Attention Outputs</text>
<text text-anchor="middle" x="608" y="-3439.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=2, head_dim=512]</text>
<text text-anchor="middle" x="608" y="-3424.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="608" y="-3409.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7 → GPU 0</text>
</g>
<!-- layer0_attn_out&#45;&gt;layer0_attn_gather -->
<g id="edge12" class="edge">
<title>layer0_attn_out&#45;&gt;layer0_attn_gather</title>
<path fill="none" stroke="black" d="M608,-3539.93C608,-3531.95 608,-3523.33 608,-3514.61"/>
<polygon fill="black" stroke="black" points="611.5,-3514.34 608,-3504.34 604.5,-3514.34 611.5,-3514.34"/>
</g>
<!-- layer0_attn_proj_split -->
<g id="node12" class="node">
<title>layer0_attn_proj_split</title>
<polygon fill="orange" stroke="black" points="1103.4,-3332.17 331.24,-3332.17 132.6,-3196.17 904.76,-3196.17 1103.4,-3332.17"/>
<text text-anchor="middle" x="618" y="-3282.97" font-family="Times,serif" font-size="14.00">Split for Projection</text>
<text text-anchor="middle" x="618" y="-3267.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="618" y="-3252.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="618" y="-3237.97" font-family="Times,serif" font-size="14.00">GPU: Each GPU 0&#45;7 gets 1/8th</text>
</g>
<!-- layer0_attn_gather&#45;&gt;layer0_attn_proj_split -->
<g id="edge13" class="edge">
<title>layer0_attn_gather&#45;&gt;layer0_attn_proj_split</title>
<path fill="none" stroke="black" d="M611.95,-3367.98C612.44,-3359.66 612.94,-3351.11 613.44,-3342.66"/>
<polygon fill="black" stroke="black" points="616.95,-3342.61 614.04,-3332.42 609.96,-3342.2 616.95,-3342.61"/>
</g>
<!-- layer0_attn_proj -->
<g id="node13" class="node">
<title>layer0_attn_proj</title>
<polygon fill="orange" stroke="black" points="871,-3160.17 403,-3160.17 403,-3092.17 871,-3092.17 871,-3160.17"/>
<text text-anchor="middle" x="637" y="-3144.97" font-family="Times,serif" font-size="14.00">Attention Projection</text>
<text text-anchor="middle" x="637" y="-3129.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="637" y="-3114.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="637" y="-3099.97" font-family="Times,serif" font-size="14.00">GPU: Each GPU 0&#45;7</text>
</g>
<!-- layer0_attn_proj_split&#45;&gt;layer0_attn_proj -->
<g id="edge14" class="edge">
<title>layer0_attn_proj_split&#45;&gt;layer0_attn_proj</title>
<path fill="none" stroke="black" d="M627.39,-3195.96C628.61,-3187.21 629.84,-3178.44 630.98,-3170.23"/>
<polygon fill="black" stroke="black" points="634.47,-3170.57 632.39,-3160.18 627.54,-3169.6 634.47,-3170.57"/>
</g>
<!-- layer0_attn_allreduce -->
<g id="node14" class="node">
<title>layer0_attn_allreduce</title>
<polygon fill="orange" stroke="black" points="1132.4,-3056.17 360.24,-3056.17 161.6,-2920.17 933.76,-2920.17 1132.4,-3056.17"/>
<text text-anchor="middle" x="647" y="-3006.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="647" y="-2991.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="647" y="-2976.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="647" y="-2961.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer0_attn_proj&#45;&gt;layer0_attn_allreduce -->
<g id="edge15" class="edge">
<title>layer0_attn_proj&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M639.45,-3091.9C640.02,-3084.07 640.66,-3075.4 641.31,-3066.52"/>
<polygon fill="black" stroke="black" points="644.81,-3066.66 642.05,-3056.43 637.83,-3066.15 644.81,-3066.66"/>
</g>
<!-- layer0_attn_allreduce&#45;&gt;layer0_res1 -->
<g id="edge16" class="edge">
<title>layer0_attn_allreduce&#45;&gt;layer0_res1</title>
<path fill="none" stroke="black" d="M697.52,-2920.04C704.58,-2910.66 711.72,-2901.17 718.46,-2892.22"/>
<polygon fill="black" stroke="black" points="721.3,-2894.27 724.52,-2884.17 715.71,-2890.06 721.3,-2894.27"/>
</g>
<!-- layer0_ln2 -->
<g id="node16" class="node">
<title>layer0_ln2</title>
<polygon fill="orange" stroke="black" points="955,-2765.17 487,-2765.17 487,-2697.17 955,-2697.17 955,-2765.17"/>
<text text-anchor="middle" x="721" y="-2749.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="721" y="-2734.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="721" y="-2719.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="721" y="-2704.97" font-family="Times,serif" font-size="14.00">GPU: GPU 0</text>
</g>
<!-- layer0_res1&#45;&gt;layer0_ln2 -->
<g id="edge18" class="edge">
<title>layer0_res1&#45;&gt;layer0_ln2</title>
<path fill="none" stroke="black" d="M742.34,-2800.89C739.73,-2792.5 736.98,-2783.64 734.35,-2775.17"/>
<polygon fill="black" stroke="black" points="737.65,-2773.98 731.34,-2765.47 730.96,-2776.05 737.65,-2773.98"/>
</g>
<!-- layer0_res2 -->
<g id="node22" class="node">
<title>layer0_res2</title>
<polygon fill="orange" stroke="black" points="869,-2005.17 401,-2005.17 401,-1922.17 869,-1922.17 869,-2005.17"/>
<text text-anchor="middle" x="635" y="-1989.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="635" y="-1974.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-1959.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-1944.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-1929.97" font-family="Times,serif" font-size="14.00">GPU: GPU 0</text>
</g>
<!-- layer0_res1&#45;&gt;layer0_res2 -->
<g id="edge25" class="edge">
<title>layer0_res1&#45;&gt;layer0_res2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M891.27,-2801.14C916.35,-2791.11 941.64,-2779.15 964,-2765.17 1020.5,-2729.84 1041.45,-2720.39 1072,-2661.17 1085.8,-2634.41 1082,-2624.27 1082,-2594.17 1082,-2594.17 1082,-2594.17 1082,-2246.17 1082,-2154.95 1132.36,-2109.56 1072,-2041.17 1044.76,-2010.3 964.08,-1991.88 879.33,-1980.88"/>
<polygon fill="black" stroke="black" points="879.61,-1977.39 869.25,-1979.61 878.73,-1984.33 879.61,-1977.39"/>
</g>
<!-- layer0_mlp1_split -->
<g id="node17" class="node">
<title>layer0_mlp1_split</title>
<polygon fill="orange" stroke="black" points="1063.4,-2661.17 291.24,-2661.17 92.6,-2525.17 864.76,-2525.17 1063.4,-2661.17"/>
<text text-anchor="middle" x="578" y="-2611.97" font-family="Times,serif" font-size="14.00">Split MLP Input</text>
<text text-anchor="middle" x="578" y="-2596.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="578" y="-2581.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="578" y="-2566.97" font-family="Times,serif" font-size="14.00">GPU: Each GPU 0&#45;7 gets 1/8th</text>
</g>
<!-- layer0_ln2&#45;&gt;layer0_mlp1_split -->
<g id="edge19" class="edge">
<title>layer0_ln2&#45;&gt;layer0_mlp1_split</title>
<path fill="none" stroke="black" d="M686.02,-2696.9C676.81,-2688.14 666.51,-2678.34 656.01,-2668.36"/>
<polygon fill="black" stroke="black" points="658.38,-2665.78 648.73,-2661.43 653.56,-2670.86 658.38,-2665.78"/>
</g>
<!-- layer0_mlp1 -->
<g id="node18" class="node">
<title>layer0_mlp1</title>
<polygon fill="orange" stroke="black" points="825,-2489.17 331,-2489.17 331,-2421.17 825,-2421.17 825,-2489.17"/>
<text text-anchor="middle" x="578" y="-2473.97" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column)</text>
<text text-anchor="middle" x="578" y="-2458.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="578" y="-2443.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=4096]</text>
<text text-anchor="middle" x="578" y="-2428.97" font-family="Times,serif" font-size="14.00">GPU: Each GPU 0&#45;7</text>
</g>
<!-- layer0_mlp1_split&#45;&gt;layer0_mlp1 -->
<g id="edge20" class="edge">
<title>layer0_mlp1_split&#45;&gt;layer0_mlp1</title>
<path fill="none" stroke="black" d="M578,-2524.96C578,-2516.21 578,-2507.44 578,-2499.23"/>
<polygon fill="black" stroke="black" points="581.5,-2499.18 578,-2489.18 574.5,-2499.18 581.5,-2499.18"/>
</g>
<!-- layer0_gelu -->
<g id="node19" class="node">
<title>layer0_gelu</title>
<polygon fill="orange" stroke="black" points="825,-2385.17 331,-2385.17 331,-2317.17 825,-2317.17 825,-2385.17"/>
<text text-anchor="middle" x="578" y="-2369.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="578" y="-2354.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=4096]</text>
<text text-anchor="middle" x="578" y="-2339.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=4096]</text>
<text text-anchor="middle" x="578" y="-2324.97" font-family="Times,serif" font-size="14.00">GPU: Each GPU 0&#45;7</text>
</g>
<!-- layer0_mlp1&#45;&gt;layer0_gelu -->
<g id="edge21" class="edge">
<title>layer0_mlp1&#45;&gt;layer0_gelu</title>
<path fill="none" stroke="black" d="M578,-2421.05C578,-2412.94 578,-2404.15 578,-2395.64"/>
<polygon fill="black" stroke="black" points="581.5,-2395.47 578,-2385.47 574.5,-2395.47 581.5,-2395.47"/>
</g>
<!-- layer0_mlp2 -->
<g id="node20" class="node">
<title>layer0_mlp2</title>
<polygon fill="orange" stroke="black" points="819,-2281.17 337,-2281.17 337,-2213.17 819,-2213.17 819,-2281.17"/>
<text text-anchor="middle" x="578" y="-2265.97" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row)</text>
<text text-anchor="middle" x="578" y="-2250.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=4096]</text>
<text text-anchor="middle" x="578" y="-2235.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="578" y="-2220.97" font-family="Times,serif" font-size="14.00">GPU: Each GPU 0&#45;7</text>
</g>
<!-- layer0_gelu&#45;&gt;layer0_mlp2 -->
<g id="edge22" class="edge">
<title>layer0_gelu&#45;&gt;layer0_mlp2</title>
<path fill="none" stroke="black" d="M578,-2317.05C578,-2308.94 578,-2300.15 578,-2291.64"/>
<polygon fill="black" stroke="black" points="581.5,-2291.47 578,-2281.47 574.5,-2291.47 581.5,-2291.47"/>
</g>
<!-- layer0_mlp_allreduce -->
<g id="node21" class="node">
<title>layer0_mlp_allreduce</title>
<polygon fill="orange" stroke="black" points="1063.4,-2177.17 291.24,-2177.17 92.6,-2041.17 864.76,-2041.17 1063.4,-2177.17"/>
<text text-anchor="middle" x="578" y="-2127.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="578" y="-2112.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="578" y="-2097.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="578" y="-2082.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer0_mlp2&#45;&gt;layer0_mlp_allreduce -->
<g id="edge23" class="edge">
<title>layer0_mlp2&#45;&gt;layer0_mlp_allreduce</title>
<path fill="none" stroke="black" d="M578,-2212.9C578,-2205.07 578,-2196.4 578,-2187.52"/>
<polygon fill="black" stroke="black" points="581.5,-2187.43 578,-2177.43 574.5,-2187.43 581.5,-2187.43"/>
</g>
<!-- layer0_mlp_allreduce&#45;&gt;layer0_res2 -->
<g id="edge24" class="edge">
<title>layer0_mlp_allreduce&#45;&gt;layer0_res2</title>
<path fill="none" stroke="black" d="M604.66,-2041.04C608.2,-2032.13 611.78,-2023.14 615.17,-2014.59"/>
<polygon fill="black" stroke="black" points="618.47,-2015.76 618.91,-2005.17 611.97,-2013.17 618.47,-2015.76"/>
</g>
<!-- send_layer0_to_layer1 -->
<g id="node23" class="node">
<title>send_layer0_to_layer1</title>
<polygon fill="orange" stroke="black" points="1120.4,-1886.17 348.24,-1886.17 149.6,-1750.17 921.76,-1750.17 1120.4,-1886.17"/>
<text text-anchor="middle" x="635" y="-1836.97" font-family="Times,serif" font-size="14.00">Send to Layer 1</text>
<text text-anchor="middle" x="635" y="-1821.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-1806.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-1791.97" font-family="Times,serif" font-size="14.00">GPU: GPU 0 → All GPUs 0&#45;7</text>
</g>
<!-- layer0_res2&#45;&gt;send_layer0_to_layer1 -->
<g id="edge26" class="edge">
<title>layer0_res2&#45;&gt;send_layer0_to_layer1</title>
<path fill="none" stroke="black" d="M635,-1921.93C635,-1913.95 635,-1905.33 635,-1896.61"/>
<polygon fill="black" stroke="black" points="638.5,-1896.34 635,-1886.34 631.5,-1896.34 638.5,-1896.34"/>
</g>
<!-- layer1_ln1 -->
<g id="node24" class="node">
<title>layer1_ln1</title>
<polygon fill="orange" stroke="black" points="869,-1714.17 401,-1714.17 401,-1646.17 869,-1646.17 869,-1714.17"/>
<text text-anchor="middle" x="635" y="-1698.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="635" y="-1683.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-1668.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-1653.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- send_layer0_to_layer1&#45;&gt;layer1_ln1 -->
<g id="edge27" class="edge">
<title>send_layer0_to_layer1&#45;&gt;layer1_ln1</title>
<path fill="none" stroke="black" d="M635,-1749.96C635,-1741.21 635,-1732.44 635,-1724.23"/>
<polygon fill="black" stroke="black" points="638.5,-1724.18 635,-1714.18 631.5,-1724.18 638.5,-1724.18"/>
</g>
<!-- layer1_qkv -->
<g id="node25" class="node">
<title>layer1_qkv</title>
<polygon fill="orange" stroke="black" points="916.5,-1610.17 353.5,-1610.17 353.5,-1542.17 916.5,-1542.17 916.5,-1610.17"/>
<text text-anchor="middle" x="635" y="-1594.97" font-family="Times,serif" font-size="14.00">QKV Linear (Parallel)</text>
<text text-anchor="middle" x="635" y="-1579.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-1564.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="635" y="-1549.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_qkv -->
<g id="edge28" class="edge">
<title>layer1_ln1&#45;&gt;layer1_qkv</title>
<path fill="none" stroke="black" d="M635,-1646.05C635,-1637.94 635,-1629.15 635,-1620.64"/>
<polygon fill="black" stroke="black" points="638.5,-1620.47 635,-1610.47 631.5,-1620.47 638.5,-1620.47"/>
</g>
<!-- layer1_attn -->
<g id="node26" class="node">
<title>layer1_attn</title>
<polygon fill="orange" stroke="black" points="910.5,-1506.17 359.5,-1506.17 359.5,-1438.17 910.5,-1438.17 910.5,-1506.17"/>
<text text-anchor="middle" x="635" y="-1490.97" font-family="Times,serif" font-size="14.00">Attention (Parallel)</text>
<text text-anchor="middle" x="635" y="-1475.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="635" y="-1460.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-1445.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer1_qkv&#45;&gt;layer1_attn -->
<g id="edge29" class="edge">
<title>layer1_qkv&#45;&gt;layer1_attn</title>
<path fill="none" stroke="black" d="M635,-1542.05C635,-1533.94 635,-1525.15 635,-1516.64"/>
<polygon fill="black" stroke="black" points="638.5,-1516.47 635,-1506.47 631.5,-1516.47 638.5,-1516.47"/>
</g>
<!-- layer1_mlp -->
<g id="node27" class="node">
<title>layer1_mlp</title>
<polygon fill="orange" stroke="black" points="869,-1402.17 401,-1402.17 401,-1334.17 869,-1334.17 869,-1402.17"/>
<text text-anchor="middle" x="635" y="-1386.97" font-family="Times,serif" font-size="14.00">MLP (Parallel)</text>
<text text-anchor="middle" x="635" y="-1371.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-1356.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-1341.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer1_attn&#45;&gt;layer1_mlp -->
<g id="edge30" class="edge">
<title>layer1_attn&#45;&gt;layer1_mlp</title>
<path fill="none" stroke="black" d="M635,-1438.05C635,-1429.94 635,-1421.15 635,-1412.64"/>
<polygon fill="black" stroke="black" points="638.5,-1412.47 635,-1402.47 631.5,-1412.47 638.5,-1412.47"/>
</g>
<!-- send_stage0_to_stage1 -->
<g id="node28" class="node">
<title>send_stage0_to_stage1</title>
<polygon fill="orange" stroke="black" points="1120.4,-1298.17 348.24,-1298.17 149.6,-1162.17 921.76,-1162.17 1120.4,-1298.17"/>
<text text-anchor="middle" x="635" y="-1248.97" font-family="Times,serif" font-size="14.00">Send to Stage 1</text>
<text text-anchor="middle" x="635" y="-1233.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-1218.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-1203.97" font-family="Times,serif" font-size="14.00">GPU: GPU 7 → All GPUs 8&#45;15</text>
</g>
<!-- layer1_mlp&#45;&gt;send_stage0_to_stage1 -->
<g id="edge31" class="edge">
<title>layer1_mlp&#45;&gt;send_stage0_to_stage1</title>
<path fill="none" stroke="black" d="M635,-1333.9C635,-1326.07 635,-1317.4 635,-1308.52"/>
<polygon fill="black" stroke="black" points="638.5,-1308.43 635,-1298.43 631.5,-1308.43 638.5,-1308.43"/>
</g>
<!-- receive_stage1 -->
<g id="node29" class="node">
<title>receive_stage1</title>
<polygon fill="orange" stroke="black" points="1120.4,-1100.17 348.24,-1100.17 149.6,-964.17 921.76,-964.17 1120.4,-1100.17"/>
<text text-anchor="middle" x="635" y="-1050.97" font-family="Times,serif" font-size="14.00">Receive from Stage 0</text>
<text text-anchor="middle" x="635" y="-1035.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-1020.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-1005.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- send_stage0_to_stage1&#45;&gt;receive_stage1 -->
<g id="edge32" class="edge">
<title>send_stage0_to_stage1&#45;&gt;receive_stage1</title>
<path fill="none" stroke="black" d="M635,-1161.99C635,-1145.47 635,-1127.65 635,-1110.69"/>
<polygon fill="black" stroke="black" points="638.5,-1110.26 635,-1100.26 631.5,-1110.26 638.5,-1110.26"/>
</g>
<!-- layer8 -->
<g id="node30" class="node">
<title>layer8</title>
<polygon fill="orange" stroke="black" points="869,-928.17 401,-928.17 401,-860.17 869,-860.17 869,-928.17"/>
<text text-anchor="middle" x="635" y="-912.97" font-family="Times,serif" font-size="14.00">Layer 8 (Parallel)</text>
<text text-anchor="middle" x="635" y="-897.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-882.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-867.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- receive_stage1&#45;&gt;layer8 -->
<g id="edge33" class="edge">
<title>receive_stage1&#45;&gt;layer8</title>
<path fill="none" stroke="black" d="M635,-963.96C635,-955.21 635,-946.44 635,-938.23"/>
<polygon fill="black" stroke="black" points="638.5,-938.18 635,-928.18 631.5,-938.18 638.5,-938.18"/>
</g>
<!-- layer9 -->
<g id="node31" class="node">
<title>layer9</title>
<polygon fill="orange" stroke="black" points="869,-824.17 401,-824.17 401,-756.17 869,-756.17 869,-824.17"/>
<text text-anchor="middle" x="635" y="-808.97" font-family="Times,serif" font-size="14.00">Layer 9 (Parallel)</text>
<text text-anchor="middle" x="635" y="-793.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-778.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-763.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer8&#45;&gt;layer9 -->
<g id="edge34" class="edge">
<title>layer8&#45;&gt;layer9</title>
<path fill="none" stroke="black" d="M635,-860.05C635,-851.94 635,-843.15 635,-834.64"/>
<polygon fill="black" stroke="black" points="638.5,-834.47 635,-824.47 631.5,-834.47 638.5,-834.47"/>
</g>
<!-- layer10 -->
<g id="node32" class="node">
<title>layer10</title>
<polygon fill="orange" stroke="black" points="869,-720.17 401,-720.17 401,-652.17 869,-652.17 869,-720.17"/>
<text text-anchor="middle" x="635" y="-704.97" font-family="Times,serif" font-size="14.00">Layer 10 (Parallel)</text>
<text text-anchor="middle" x="635" y="-689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-659.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer9&#45;&gt;layer10 -->
<g id="edge35" class="edge">
<title>layer9&#45;&gt;layer10</title>
<path fill="none" stroke="black" d="M635,-756.05C635,-747.94 635,-739.15 635,-730.64"/>
<polygon fill="black" stroke="black" points="638.5,-730.47 635,-720.47 631.5,-730.47 638.5,-730.47"/>
</g>
<!-- layer11 -->
<g id="node33" class="node">
<title>layer11</title>
<polygon fill="orange" stroke="black" points="869,-616.17 401,-616.17 401,-548.17 869,-548.17 869,-616.17"/>
<text text-anchor="middle" x="635" y="-600.97" font-family="Times,serif" font-size="14.00">Layer 11 (Parallel)</text>
<text text-anchor="middle" x="635" y="-585.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-570.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-555.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer10&#45;&gt;layer11 -->
<g id="edge36" class="edge">
<title>layer10&#45;&gt;layer11</title>
<path fill="none" stroke="black" d="M635,-652.05C635,-643.94 635,-635.15 635,-626.64"/>
<polygon fill="black" stroke="black" points="638.5,-626.47 635,-616.47 631.5,-626.47 638.5,-626.47"/>
</g>
<!-- layer12 -->
<g id="node34" class="node">
<title>layer12</title>
<polygon fill="orange" stroke="black" points="869,-512.17 401,-512.17 401,-444.17 869,-444.17 869,-512.17"/>
<text text-anchor="middle" x="635" y="-496.97" font-family="Times,serif" font-size="14.00">Layer 12 (Parallel)</text>
<text text-anchor="middle" x="635" y="-481.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-466.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-451.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer11&#45;&gt;layer12 -->
<g id="edge37" class="edge">
<title>layer11&#45;&gt;layer12</title>
<path fill="none" stroke="black" d="M635,-548.05C635,-539.94 635,-531.15 635,-522.64"/>
<polygon fill="black" stroke="black" points="638.5,-522.47 635,-512.47 631.5,-522.47 638.5,-522.47"/>
</g>
<!-- layer13 -->
<g id="node35" class="node">
<title>layer13</title>
<polygon fill="orange" stroke="black" points="869,-408.17 401,-408.17 401,-340.17 869,-340.17 869,-408.17"/>
<text text-anchor="middle" x="635" y="-392.97" font-family="Times,serif" font-size="14.00">Layer 13 (Parallel)</text>
<text text-anchor="middle" x="635" y="-377.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-362.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-347.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer12&#45;&gt;layer13 -->
<g id="edge38" class="edge">
<title>layer12&#45;&gt;layer13</title>
<path fill="none" stroke="black" d="M635,-444.05C635,-435.94 635,-427.15 635,-418.64"/>
<polygon fill="black" stroke="black" points="638.5,-418.47 635,-408.47 631.5,-418.47 638.5,-418.47"/>
</g>
<!-- layer14 -->
<g id="node36" class="node">
<title>layer14</title>
<polygon fill="orange" stroke="black" points="869,-304.17 401,-304.17 401,-236.17 869,-236.17 869,-304.17"/>
<text text-anchor="middle" x="635" y="-288.97" font-family="Times,serif" font-size="14.00">Layer 14 (Parallel)</text>
<text text-anchor="middle" x="635" y="-273.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-258.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-243.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer13&#45;&gt;layer14 -->
<g id="edge39" class="edge">
<title>layer13&#45;&gt;layer14</title>
<path fill="none" stroke="black" d="M635,-340.05C635,-331.94 635,-323.15 635,-314.64"/>
<polygon fill="black" stroke="black" points="638.5,-314.47 635,-304.47 631.5,-314.47 638.5,-314.47"/>
</g>
<!-- layer15 -->
<g id="node37" class="node">
<title>layer15</title>
<polygon fill="orange" stroke="black" points="869,-200.17 401,-200.17 401,-132.17 869,-132.17 869,-200.17"/>
<text text-anchor="middle" x="635" y="-184.97" font-family="Times,serif" font-size="14.00">Layer 15 (Parallel)</text>
<text text-anchor="middle" x="635" y="-169.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-154.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-139.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer14&#45;&gt;layer15 -->
<g id="edge40" class="edge">
<title>layer14&#45;&gt;layer15</title>
<path fill="none" stroke="black" d="M635,-236.05C635,-227.94 635,-219.15 635,-210.64"/>
<polygon fill="black" stroke="black" points="638.5,-210.47 635,-200.47 631.5,-210.47 638.5,-210.47"/>
</g>
<!-- output -->
<g id="node38" class="node">
<title>output</title>
<ellipse fill="orange" stroke="black" cx="635" cy="-48.08" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="635" y="-66.88" font-family="Times,serif" font-size="14.00">Model Output</text>
<text text-anchor="middle" x="635" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="635" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: GPU 15</text>
</g>
<!-- layer15&#45;&gt;output -->
<g id="edge41" class="edge">
<title>layer15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M635,-131.9C635,-123.91 635,-115.14 635,-106.4"/>
<polygon fill="black" stroke="black" points="638.5,-106.19 635,-96.19 631.5,-106.19 638.5,-106.19"/>
</g>
</g>
</svg>
