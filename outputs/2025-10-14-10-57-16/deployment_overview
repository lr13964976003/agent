
    digraph {
        rankdir=LR
        size="20,10"
        node [shape=box, style=filled, fillcolor=lightblue]
        
        // Input
        input [label="Model Input
[1024, 10000, 8192]"]
        
        // Stage 0: GPUs 0-7
        subgraph cluster_stage0 {
            label="Stage 0: Layers 0-7
GPUs 0-7 (8-way Tensor Parallel)"
            style=filled
            fillcolor=lightyellow
            
            layer0 [label="Layer 0
Tensor Parallel"]
            layer1 [label="Layer 1
Tensor Parallel"]
            layer2 [label="Layer 2
Tensor Parallel"]
            layer3 [label="Layer 3
Tensor Parallel"]
            layer4 [label="Layer 4
Tensor Parallel"]
            layer5 [label="Layer 5
Tensor Parallel"]
            layer6 [label="Layer 6
Tensor Parallel"]
            layer7 [label="Layer 7
Tensor Parallel"]
            
            layer0 -> layer1 -> layer2 -> layer3 -> layer4 -> layer5 -> layer6 -> layer7
        }
        
        // Stage 1: GPUs 8-15
        subgraph cluster_stage1 {
            label="Stage 1: Layers 8-15
GPUs 8-15 (8-way Tensor Parallel)"
            style=filled
            fillcolor=lightgreen
            
            layer8 [label="Layer 8
Tensor Parallel"]
            layer9 [label="Layer 9
Tensor Parallel"]
            layer10 [label="Layer 10
Tensor Parallel"]
            layer11 [label="Layer 11
Tensor Parallel"]
            layer12 [label="Layer 12
Tensor Parallel"]
            layer13 [label="Layer 13
Tensor Parallel"]
            layer14 [label="Layer 14
Tensor Parallel"]
            layer15 [label="Layer 15
Tensor Parallel"]
            
            layer8 -> layer9 -> layer10 -> layer11 -> layer12 -> layer13 -> layer14 -> layer15
        }
        
        // Output
        output [label="Model Output
[1024, 10000, 8192]"]
        
        // Connections
        input -> layer0
        layer7 -> layer8 [label="Pipeline Communication"]
        layer15 -> output
    }
    
