<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="487pt" height="1440pt"
 viewBox="0.00 0.00 487.24 1440.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.85 0.85) rotate(0) translate(4 1693)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1693 570.2,-1693 570.2,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_qkv</title>
<polygon fill="lightyellow" stroke="black" points="8,-1380 8,-1569 546,-1569 546,-1380 8,-1380"/>
<text text-anchor="middle" x="277" y="-1553.8" font-family="Times,serif" font-size="14.00">QKV Linear (Column Parallel)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_attn</title>
<polygon fill="lightcyan" stroke="black" points="185,-1147 185,-1372 391,-1372 391,-1147 185,-1147"/>
<text text-anchor="middle" x="288" y="-1356.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_mlp</title>
<polygon fill="lightpink" stroke="black" points="187,-140 187,-589 471,-589 471,-140 187,-140"/>
<text text-anchor="middle" x="329" y="-573.8" font-family="Times,serif" font-size="14.00">MLP (Column + Row Parallel)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightblue" stroke="black" points="502,-1689 340,-1689 340,-1651 502,-1651 502,-1689"/>
<text text-anchor="middle" x="421" y="-1673.8" font-family="Times,serif" font-size="14.00">Layer Input</text>
<text text-anchor="middle" x="421" y="-1658.8" font-family="Times,serif" font-size="14.00">[1024, 10000, 8192]</text>
</g>
<!-- ln1 -->
<g id="node2" class="node">
<title>ln1</title>
<polygon fill="lightgreen" stroke="black" points="448,-1615 286,-1615 286,-1577 448,-1577 448,-1615"/>
<text text-anchor="middle" x="367" y="-1599.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="367" y="-1584.8" font-family="Times,serif" font-size="14.00">[1024, 10000, 8192]</text>
</g>
<!-- input&#45;&gt;ln1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln1</title>
<path fill="none" stroke="black" d="M407.37,-1650.83C401.15,-1642.54 393.67,-1632.56 386.84,-1623.45"/>
<polygon fill="black" stroke="black" points="389.61,-1621.31 380.81,-1615.41 384.01,-1625.51 389.61,-1621.31"/>
</g>
<!-- res1 -->
<g id="node14" class="node">
<title>res1</title>
<polygon fill="lightgreen" stroke="black" points="494,-709 332,-709 332,-671 494,-671 494,-709"/>
<text text-anchor="middle" x="413" y="-693.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="413" y="-678.8" font-family="Times,serif" font-size="14.00">[1024, 10000, 8192]</text>
</g>
<!-- input&#45;&gt;res1 -->
<g id="edge16" class="edge">
<title>input&#45;&gt;res1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M456.04,-1650.84C485.6,-1633.69 526.71,-1605.23 550,-1569 566.79,-1542.88 566,-1532.05 566,-1501 566,-1501 566,-1501 566,-875 566,-815.05 568.82,-790.69 530,-745 518.56,-731.53 503.04,-721.23 487.04,-713.43"/>
<polygon fill="black" stroke="black" points="488.15,-710.09 477.6,-709.12 485.24,-716.46 488.15,-710.09"/>
</g>
<!-- split_qkv -->
<g id="node3" class="node">
<title>split_qkv</title>
<polygon fill="lightgrey" stroke="black" points="443.1,-1538 250.46,-1538 200.9,-1462 393.54,-1462 443.1,-1538"/>
<text text-anchor="middle" x="322" y="-1503.8" font-family="Times,serif" font-size="14.00">Split Input</text>
<text text-anchor="middle" x="322" y="-1488.8" font-family="Times,serif" font-size="14.00">8&#45;way parallel</text>
</g>
<!-- ln1&#45;&gt;split_qkv -->
<g id="edge2" class="edge">
<title>ln1&#45;&gt;split_qkv</title>
<path fill="none" stroke="black" d="M358.32,-1576.88C354.25,-1568.38 349.2,-1557.82 344.17,-1547.31"/>
<polygon fill="black" stroke="black" points="347.25,-1545.64 339.78,-1538.13 340.94,-1548.67 347.25,-1545.64"/>
</g>
<!-- q_linear -->
<g id="node4" class="node">
<title>q_linear</title>
<polygon fill="orange" stroke="black" points="178,-1426 16,-1426 16,-1388 178,-1388 178,-1426"/>
<text text-anchor="middle" x="97" y="-1410.8" font-family="Times,serif" font-size="14.00">Query Linear</text>
<text text-anchor="middle" x="97" y="-1395.8" font-family="Times,serif" font-size="14.00">[1024, 10000, 1024]</text>
</g>
<!-- split_qkv&#45;&gt;q_linear -->
<g id="edge3" class="edge">
<title>split_qkv&#45;&gt;q_linear</title>
<path fill="none" stroke="black" d="M230.48,-1461.99C203.54,-1451.09 174.92,-1439.52 151.13,-1429.89"/>
<polygon fill="black" stroke="black" points="152.17,-1426.54 141.59,-1426.03 149.55,-1433.03 152.17,-1426.54"/>
</g>
<!-- k_linear -->
<g id="node5" class="node">
<title>k_linear</title>
<polygon fill="orange" stroke="black" points="358,-1426 196,-1426 196,-1388 358,-1388 358,-1426"/>
<text text-anchor="middle" x="277" y="-1410.8" font-family="Times,serif" font-size="14.00">Key Linear</text>
<text text-anchor="middle" x="277" y="-1395.8" font-family="Times,serif" font-size="14.00">[1024, 10000, 1024]</text>
</g>
<!-- split_qkv&#45;&gt;k_linear -->
<g id="edge4" class="edge">
<title>split_qkv&#45;&gt;k_linear</title>
<path fill="none" stroke="black" d="M303.7,-1461.99C299.24,-1452.98 294.56,-1443.51 290.38,-1435.06"/>
<polygon fill="black" stroke="black" points="293.49,-1433.45 285.92,-1426.03 287.21,-1436.55 293.49,-1433.45"/>
</g>
<!-- v_linear -->
<g id="node6" class="node">
<title>v_linear</title>
<polygon fill="orange" stroke="black" points="538,-1426 376,-1426 376,-1388 538,-1388 538,-1426"/>
<text text-anchor="middle" x="457" y="-1410.8" font-family="Times,serif" font-size="14.00">Value Linear</text>
<text text-anchor="middle" x="457" y="-1395.8" font-family="Times,serif" font-size="14.00">[1024, 10000, 1024]</text>
</g>
<!-- split_qkv&#45;&gt;v_linear -->
<g id="edge5" class="edge">
<title>split_qkv&#45;&gt;v_linear</title>
<path fill="none" stroke="black" d="M376.91,-1461.99C392,-1451.81 407.96,-1441.06 421.63,-1431.84"/>
<polygon fill="black" stroke="black" points="423.91,-1434.52 430.25,-1426.03 420,-1428.72 423.91,-1434.52"/>
</g>
<!-- attn_score -->
<g id="node7" class="node">
<title>attn_score</title>
<polygon fill="lightgreen" stroke="black" points="382.5,-1341 193.5,-1341 193.5,-1303 382.5,-1303 382.5,-1341"/>
<text text-anchor="middle" x="288" y="-1325.8" font-family="Times,serif" font-size="14.00">Q·K^T</text>
<text text-anchor="middle" x="288" y="-1310.8" font-family="Times,serif" font-size="14.00">[1024, 2, 10000, 10000]</text>
</g>
<!-- q_linear&#45;&gt;attn_score -->
<g id="edge6" class="edge">
<title>q_linear&#45;&gt;attn_score</title>
<path fill="none" stroke="black" d="M138.44,-1387.99C167.38,-1375.42 206.18,-1358.55 237.01,-1345.16"/>
<polygon fill="black" stroke="black" points="238.53,-1348.31 246.31,-1341.12 235.74,-1341.89 238.53,-1348.31"/>
</g>
<!-- k_linear&#45;&gt;attn_score -->
<g id="edge7" class="edge">
<title>k_linear&#45;&gt;attn_score</title>
<path fill="none" stroke="black" d="M279.39,-1387.99C280.8,-1377.3 282.63,-1363.5 284.24,-1351.37"/>
<polygon fill="black" stroke="black" points="287.74,-1351.63 285.58,-1341.26 280.8,-1350.71 287.74,-1351.63"/>
</g>
<!-- attn_out -->
<g id="node9" class="node">
<title>attn_out</title>
<polygon fill="lightgreen" stroke="black" points="383,-1193 221,-1193 221,-1155 383,-1155 383,-1193"/>
<text text-anchor="middle" x="302" y="-1177.8" font-family="Times,serif" font-size="14.00">Attention·V</text>
<text text-anchor="middle" x="302" y="-1162.8" font-family="Times,serif" font-size="14.00">[1024, 10000, 1024]</text>
</g>
<!-- v_linear&#45;&gt;attn_out -->
<g id="edge10" class="edge">
<title>v_linear&#45;&gt;attn_out</title>
<path fill="none" stroke="black" d="M454.44,-1387.96C448.77,-1353.56 432.27,-1277.68 392,-1229 381.71,-1216.56 367.76,-1206.26 353.92,-1198.12"/>
<polygon fill="black" stroke="black" points="355.32,-1194.89 344.88,-1193.07 351.91,-1201 355.32,-1194.89"/>
</g>
<!-- softmax -->
<g id="node8" class="node">
<title>softmax</title>
<polygon fill="lightgreen" stroke="black" points="382.5,-1267 193.5,-1267 193.5,-1229 382.5,-1229 382.5,-1267"/>
<text text-anchor="middle" x="288" y="-1251.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="288" y="-1236.8" font-family="Times,serif" font-size="14.00">[1024, 2, 10000, 10000]</text>
</g>
<!-- attn_score&#45;&gt;softmax -->
<g id="edge8" class="edge">
<title>attn_score&#45;&gt;softmax</title>
<path fill="none" stroke="black" d="M288,-1302.83C288,-1295.13 288,-1285.97 288,-1277.42"/>
<polygon fill="black" stroke="black" points="291.5,-1277.41 288,-1267.41 284.5,-1277.41 291.5,-1277.41"/>
</g>
<!-- softmax&#45;&gt;attn_out -->
<g id="edge9" class="edge">
<title>softmax&#45;&gt;attn_out</title>
<path fill="none" stroke="black" d="M291.53,-1228.83C293.03,-1221.13 294.81,-1211.97 296.47,-1203.42"/>
<polygon fill="black" stroke="black" points="299.95,-1203.9 298.42,-1193.41 293.08,-1202.56 299.95,-1203.9"/>
</g>
<!-- gather_attn -->
<g id="node10" class="node">
<title>gather_attn</title>
<polygon fill="lightgrey" stroke="black" points="478.91,-1119 267.48,-1119 213.09,-1043 424.52,-1043 478.91,-1119"/>
<text text-anchor="middle" x="346" y="-1084.8" font-family="Times,serif" font-size="14.00">Gather Outputs</text>
<text text-anchor="middle" x="346" y="-1069.8" font-family="Times,serif" font-size="14.00">8&#45;way → 1</text>
</g>
<!-- attn_out&#45;&gt;gather_attn -->
<g id="edge11" class="edge">
<title>attn_out&#45;&gt;gather_attn</title>
<path fill="none" stroke="black" d="M310.9,-1154.58C314.6,-1146.95 319.06,-1137.72 323.55,-1128.43"/>
<polygon fill="black" stroke="black" points="326.82,-1129.71 328.02,-1119.19 320.52,-1126.66 326.82,-1129.71"/>
</g>
<!-- split_proj -->
<g id="node11" class="node">
<title>split_proj</title>
<polygon fill="lightgrey" stroke="black" points="515.67,-1007 264.85,-1007 200.33,-931 451.15,-931 515.67,-1007"/>
<text text-anchor="middle" x="358" y="-972.8" font-family="Times,serif" font-size="14.00">Split for Projection</text>
<text text-anchor="middle" x="358" y="-957.8" font-family="Times,serif" font-size="14.00">8&#45;way parallel</text>
</g>
<!-- gather_attn&#45;&gt;split_proj -->
<g id="edge12" class="edge">
<title>gather_attn&#45;&gt;split_proj</title>
<path fill="none" stroke="black" d="M350.06,-1042.76C350.95,-1034.61 351.91,-1025.87 352.83,-1017.38"/>
<polygon fill="black" stroke="black" points="356.34,-1017.52 353.94,-1007.2 349.38,-1016.76 356.34,-1017.52"/>
</g>
<!-- attn_proj -->
<g id="node12" class="node">
<title>attn_proj</title>
<polygon fill="orange" stroke="black" points="451,-895 289,-895 289,-857 451,-857 451,-895"/>
<text text-anchor="middle" x="370" y="-879.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="370" y="-864.8" font-family="Times,serif" font-size="14.00">[1024, 10000, 1024]</text>
</g>
<!-- split_proj&#45;&gt;attn_proj -->
<g id="edge13" class="edge">
<title>split_proj&#45;&gt;attn_proj</title>
<path fill="none" stroke="black" d="M362.88,-930.99C364.02,-922.36 365.21,-913.32 366.29,-905.15"/>
<polygon fill="black" stroke="black" points="369.78,-905.4 367.62,-895.03 362.84,-904.49 369.78,-905.4"/>
</g>
<!-- allreduce_proj -->
<g id="node13" class="node">
<title>allreduce_proj</title>
<polygon fill="red" stroke="black" points="520.98,-821 307.85,-821 253.02,-745 466.15,-745 520.98,-821"/>
<text text-anchor="middle" x="387" y="-786.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="387" y="-771.8" font-family="Times,serif" font-size="14.00">8&#45;way → 1</text>
</g>
<!-- attn_proj&#45;&gt;allreduce_proj -->
<g id="edge14" class="edge">
<title>attn_proj&#45;&gt;allreduce_proj</title>
<path fill="none" stroke="black" d="M373.44,-856.58C374.82,-849.19 376.48,-840.29 378.16,-831.3"/>
<polygon fill="black" stroke="black" points="381.66,-831.66 380.05,-821.19 374.78,-830.37 381.66,-831.66"/>
</g>
<!-- allreduce_proj&#45;&gt;res1 -->
<g id="edge15" class="edge">
<title>allreduce_proj&#45;&gt;res1</title>
<path fill="none" stroke="black" d="M397.58,-744.99C400.07,-736.27 402.68,-727.12 405.03,-718.88"/>
<polygon fill="black" stroke="black" points="408.47,-719.61 407.85,-709.03 401.74,-717.69 408.47,-719.61"/>
</g>
<!-- ln2 -->
<g id="node15" class="node">
<title>ln2</title>
<polygon fill="lightgreen" stroke="black" points="440,-635 278,-635 278,-597 440,-597 440,-635"/>
<text text-anchor="middle" x="359" y="-619.8" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="359" y="-604.8" font-family="Times,serif" font-size="14.00">[1024, 10000, 8192]</text>
</g>
<!-- res1&#45;&gt;ln2 -->
<g id="edge17" class="edge">
<title>res1&#45;&gt;ln2</title>
<path fill="none" stroke="black" d="M399.37,-670.83C393.15,-662.54 385.67,-652.56 378.84,-643.45"/>
<polygon fill="black" stroke="black" points="381.61,-641.31 372.81,-635.41 376.01,-645.51 381.61,-641.31"/>
</g>
<!-- res2 -->
<g id="node21" class="node">
<title>res2</title>
<polygon fill="lightgreen" stroke="black" points="491,-112 329,-112 329,-74 491,-74 491,-112"/>
<text text-anchor="middle" x="410" y="-96.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="410" y="-81.8" font-family="Times,serif" font-size="14.00">[1024, 10000, 8192]</text>
</g>
<!-- res1&#45;&gt;res2 -->
<g id="edge24" class="edge">
<title>res1&#45;&gt;res2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M428.04,-670.65C450.71,-641.07 491,-580.17 491,-521 491,-521 491,-521 491,-278 491,-216.26 506.49,-193.11 475,-140 470.03,-131.62 462.87,-124.36 455.1,-118.25"/>
<polygon fill="black" stroke="black" points="456.66,-115.07 446.5,-112.07 452.58,-120.75 456.66,-115.07"/>
</g>
<!-- split_mlp -->
<g id="node16" class="node">
<title>split_mlp</title>
<polygon fill="lightgrey" stroke="black" points="457.1,-558 264.46,-558 214.9,-482 407.54,-482 457.1,-558"/>
<text text-anchor="middle" x="336" y="-523.8" font-family="Times,serif" font-size="14.00">Split Input</text>
<text text-anchor="middle" x="336" y="-508.8" font-family="Times,serif" font-size="14.00">8&#45;way parallel</text>
</g>
<!-- ln2&#45;&gt;split_mlp -->
<g id="edge18" class="edge">
<title>ln2&#45;&gt;split_mlp</title>
<path fill="none" stroke="black" d="M354.57,-596.88C352.53,-588.55 350.01,-578.24 347.49,-567.94"/>
<polygon fill="black" stroke="black" points="350.86,-567.02 345.09,-558.13 344.06,-568.68 350.86,-567.02"/>
</g>
<!-- mlp1 -->
<g id="node17" class="node">
<title>mlp1</title>
<polygon fill="orange" stroke="black" points="416,-446 254,-446 254,-408 416,-408 416,-446"/>
<text text-anchor="middle" x="335" y="-430.8" font-family="Times,serif" font-size="14.00">Linear1 (Column)</text>
<text text-anchor="middle" x="335" y="-415.8" font-family="Times,serif" font-size="14.00">[1024, 10000, 4096]</text>
</g>
<!-- split_mlp&#45;&gt;mlp1 -->
<g id="edge19" class="edge">
<title>split_mlp&#45;&gt;mlp1</title>
<path fill="none" stroke="black" d="M335.59,-481.99C335.5,-473.36 335.4,-464.32 335.31,-456.15"/>
<polygon fill="black" stroke="black" points="338.81,-455.99 335.2,-446.03 331.81,-456.07 338.81,-455.99"/>
</g>
<!-- gelu -->
<g id="node18" class="node">
<title>gelu</title>
<polygon fill="lightgreen" stroke="black" points="415,-372 253,-372 253,-334 415,-334 415,-372"/>
<text text-anchor="middle" x="334" y="-356.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="334" y="-341.8" font-family="Times,serif" font-size="14.00">[1024, 10000, 4096]</text>
</g>
<!-- mlp1&#45;&gt;gelu -->
<g id="edge20" class="edge">
<title>mlp1&#45;&gt;gelu</title>
<path fill="none" stroke="black" d="M334.75,-407.83C334.64,-400.13 334.51,-390.97 334.39,-382.42"/>
<polygon fill="black" stroke="black" points="337.89,-382.36 334.26,-372.41 330.9,-382.46 337.89,-382.36"/>
</g>
<!-- mlp2 -->
<g id="node19" class="node">
<title>mlp2</title>
<polygon fill="orange" stroke="black" points="413,-298 251,-298 251,-260 413,-260 413,-298"/>
<text text-anchor="middle" x="332" y="-282.8" font-family="Times,serif" font-size="14.00">Linear2 (Row)</text>
<text text-anchor="middle" x="332" y="-267.8" font-family="Times,serif" font-size="14.00">[1024, 10000, 1024]</text>
</g>
<!-- gelu&#45;&gt;mlp2 -->
<g id="edge21" class="edge">
<title>gelu&#45;&gt;mlp2</title>
<path fill="none" stroke="black" d="M333.5,-333.83C333.28,-326.13 333.03,-316.97 332.79,-308.42"/>
<polygon fill="black" stroke="black" points="336.29,-308.31 332.51,-298.41 329.29,-308.51 336.29,-308.31"/>
</g>
<!-- allreduce_mlp -->
<g id="node20" class="node">
<title>allreduce_mlp</title>
<polygon fill="red" stroke="black" points="462.98,-224 249.85,-224 195.02,-148 408.15,-148 462.98,-224"/>
<text text-anchor="middle" x="329" y="-189.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="329" y="-174.8" font-family="Times,serif" font-size="14.00">8&#45;way → 1</text>
</g>
<!-- mlp2&#45;&gt;allreduce_mlp -->
<g id="edge22" class="edge">
<title>mlp2&#45;&gt;allreduce_mlp</title>
<path fill="none" stroke="black" d="M331.39,-259.58C331.15,-252.19 330.86,-243.29 330.56,-234.3"/>
<polygon fill="black" stroke="black" points="334.05,-234.06 330.23,-224.19 327.06,-234.3 334.05,-234.06"/>
</g>
<!-- allreduce_mlp&#45;&gt;res2 -->
<g id="edge23" class="edge">
<title>allreduce_mlp&#45;&gt;res2</title>
<path fill="none" stroke="black" d="M361.95,-147.99C370.4,-138.49 379.3,-128.49 387.12,-119.71"/>
<polygon fill="black" stroke="black" points="389.91,-121.83 393.95,-112.03 384.69,-117.18 389.91,-121.83"/>
</g>
<!-- output -->
<g id="node22" class="node">
<title>output</title>
<polygon fill="lightblue" stroke="black" points="491,-38 329,-38 329,0 491,0 491,-38"/>
<text text-anchor="middle" x="410" y="-22.8" font-family="Times,serif" font-size="14.00">Layer Output</text>
<text text-anchor="middle" x="410" y="-7.8" font-family="Times,serif" font-size="14.00">[1024, 10000, 8192]</text>
</g>
<!-- res2&#45;&gt;output -->
<g id="edge25" class="edge">
<title>res2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M410,-73.83C410,-66.13 410,-56.97 410,-48.42"/>
<polygon fill="black" stroke="black" points="413.5,-48.41 410,-38.41 406.5,-48.41 413.5,-48.41"/>
</g>
</g>
</svg>
