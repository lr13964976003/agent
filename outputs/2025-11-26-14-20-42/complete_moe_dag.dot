// Large-Scale Cross-Node Expert Parallelism MoE DAG
digraph {
	rankdir=TB size="50,50"
	node [fontname=Arial fontsize=10]
	edge [fontname=Arial fontsize=8]
	node [fillcolor=lightblue shape=ellipse style=filled]
	node [fillcolor=lightgreen shape=rectangle style=filled]
	node [fillcolor=lightyellow shape=parallelogram style=filled]
	subgraph cluster_input {
		fillcolor=lightgray label="Input Layer" style="rounded,filled"
		input [label="INPUT\nGPU: Host\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
	}
	subgraph cluster_dense_1 {
		fillcolor=lightgray label="Dense Layer 1" style="rounded,filled"
		dense_1_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		dense_1_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		dense_1_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		dense_1_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_dense_2 {
		fillcolor=lightgray label="Dense Layer 2" style="rounded,filled"
		dense_2_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		dense_2_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		dense_2_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		dense_2_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_dense_3 {
		fillcolor=lightgray label="Dense Layer 3" style="rounded,filled"
		dense_3_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		dense_3_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		dense_3_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		dense_3_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_4 {
		fillcolor=lightgray label="MoE Layer 4" style="rounded,filled"
		moe_4_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_4_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_4_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_4_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_4_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_4_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_4_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_4_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_4_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_4_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_4_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_4_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_4_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_4_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_4_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_4_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_4_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_4_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_4_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_4_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_4_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_4_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_4_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_5 {
		fillcolor=lightgray label="MoE Layer 5" style="rounded,filled"
		moe_5_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_5_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_5_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_5_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_5_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_5_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_5_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_5_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_5_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_5_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_5_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_5_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_5_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_5_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_5_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_5_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_5_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_5_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_5_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_5_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_5_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_5_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_5_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_6 {
		fillcolor=lightgray label="MoE Layer 6" style="rounded,filled"
		moe_6_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_6_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_6_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_6_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_6_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_6_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_6_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_6_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_6_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_6_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_6_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_6_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_6_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_6_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_6_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_6_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_6_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_6_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_6_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_6_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_6_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_6_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_6_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_7 {
		fillcolor=lightgray label="MoE Layer 7" style="rounded,filled"
		moe_7_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_7_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_7_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_7_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_7_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_7_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_7_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_7_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_7_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_7_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_7_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_7_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_7_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_7_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_7_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_7_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_7_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_7_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_7_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_7_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_7_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_7_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_7_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_8 {
		fillcolor=lightgray label="MoE Layer 8" style="rounded,filled"
		moe_8_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_8_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_8_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_8_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_8_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_8_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_8_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_8_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_8_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_8_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_8_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_8_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_8_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_8_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_8_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_8_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_8_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_8_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_8_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_8_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_8_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_8_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_8_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_9 {
		fillcolor=lightgray label="MoE Layer 9" style="rounded,filled"
		moe_9_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_9_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_9_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_9_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_9_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_9_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_9_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_9_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_9_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_9_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_9_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_9_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_9_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_9_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_9_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_9_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_9_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_9_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_9_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_9_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_9_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_9_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_9_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_10 {
		fillcolor=lightgray label="MoE Layer 10" style="rounded,filled"
		moe_10_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_10_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_10_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_10_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_10_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_10_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_10_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_10_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_10_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_10_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_10_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_10_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_10_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_10_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_10_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_10_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_10_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_10_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_10_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_10_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_10_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_10_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_10_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_11 {
		fillcolor=lightgray label="MoE Layer 11" style="rounded,filled"
		moe_11_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_11_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_11_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_11_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_11_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_11_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_11_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_11_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_11_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_11_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_11_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_11_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_11_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_11_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_11_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_11_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_11_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_11_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_11_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_11_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_11_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_11_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_11_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_12 {
		fillcolor=lightgray label="MoE Layer 12" style="rounded,filled"
		moe_12_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_12_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_12_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_12_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_12_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_12_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_12_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_12_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_12_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_12_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_12_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_12_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_12_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_12_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_12_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_12_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_12_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_12_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_12_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_12_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_12_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_12_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_12_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_13 {
		fillcolor=lightgray label="MoE Layer 13" style="rounded,filled"
		moe_13_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_13_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_13_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_13_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_13_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_13_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_13_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_13_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_13_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_13_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_13_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_13_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_13_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_13_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_13_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_13_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_13_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_13_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_13_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_13_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_13_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_13_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_13_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_14 {
		fillcolor=lightgray label="MoE Layer 14" style="rounded,filled"
		moe_14_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_14_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_14_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_14_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_14_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_14_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_14_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_14_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_14_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_14_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_14_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_14_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_14_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_14_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_14_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_14_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_14_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_14_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_14_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_14_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_14_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_14_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_14_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_15 {
		fillcolor=lightgray label="MoE Layer 15" style="rounded,filled"
		moe_15_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_15_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_15_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_15_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_15_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_15_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_15_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_15_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_15_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_15_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_15_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_15_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_15_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_15_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_15_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_15_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_15_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_15_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_15_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_15_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_15_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_15_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_15_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_16 {
		fillcolor=lightgray label="MoE Layer 16" style="rounded,filled"
		moe_16_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_16_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_16_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_16_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_16_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_16_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_16_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_16_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_16_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_16_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_16_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_16_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_16_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_16_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_16_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_16_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_16_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_16_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_16_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_16_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_16_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_16_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_16_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_17 {
		fillcolor=lightgray label="MoE Layer 17" style="rounded,filled"
		moe_17_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_17_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_17_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_17_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_17_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_17_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_17_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_17_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_17_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_17_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_17_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_17_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_17_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_17_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_17_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_17_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_17_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_17_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_17_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_17_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_17_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_17_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_17_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_18 {
		fillcolor=lightgray label="MoE Layer 18" style="rounded,filled"
		moe_18_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_18_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_18_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_18_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_18_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_18_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_18_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_18_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_18_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_18_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_18_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_18_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_18_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_18_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_18_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_18_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_18_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_18_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_18_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_18_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_18_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_18_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_18_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_19 {
		fillcolor=lightgray label="MoE Layer 19" style="rounded,filled"
		moe_19_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_19_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_19_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_19_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_19_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_19_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_19_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_19_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_19_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_19_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_19_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_19_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_19_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_19_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_19_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_19_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_19_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_19_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_19_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_19_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_19_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_19_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_19_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_20 {
		fillcolor=lightgray label="MoE Layer 20" style="rounded,filled"
		moe_20_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_20_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_20_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_20_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_20_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_20_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_20_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_20_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_20_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_20_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_20_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_20_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_20_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_20_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_20_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_20_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_20_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_20_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_20_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_20_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_20_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_20_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_20_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_21 {
		fillcolor=lightgray label="MoE Layer 21" style="rounded,filled"
		moe_21_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_21_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_21_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_21_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_21_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_21_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_21_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_21_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_21_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_21_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_21_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_21_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_21_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_21_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_21_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_21_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_21_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_21_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_21_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_21_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_21_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_21_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_21_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_22 {
		fillcolor=lightgray label="MoE Layer 22" style="rounded,filled"
		moe_22_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_22_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_22_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_22_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_22_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_22_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_22_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_22_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_22_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_22_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_22_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_22_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_22_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_22_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_22_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_22_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_22_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_22_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_22_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_22_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_22_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_22_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_22_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_23 {
		fillcolor=lightgray label="MoE Layer 23" style="rounded,filled"
		moe_23_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_23_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_23_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_23_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_23_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_23_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_23_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_23_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_23_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_23_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_23_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_23_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_23_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_23_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_23_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_23_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_23_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_23_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_23_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_23_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_23_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_23_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_23_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_24 {
		fillcolor=lightgray label="MoE Layer 24" style="rounded,filled"
		moe_24_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_24_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_24_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_24_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_24_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_24_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_24_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_24_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_24_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_24_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_24_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_24_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_24_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_24_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_24_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_24_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_24_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_24_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_24_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_24_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_24_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_24_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_24_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_25 {
		fillcolor=lightgray label="MoE Layer 25" style="rounded,filled"
		moe_25_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_25_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_25_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_25_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_25_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_25_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_25_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_25_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_25_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_25_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_25_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_25_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_25_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_25_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_25_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_25_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_25_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_25_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_25_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_25_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_25_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_25_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_25_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_26 {
		fillcolor=lightgray label="MoE Layer 26" style="rounded,filled"
		moe_26_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_26_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_26_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_26_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_26_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_26_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_26_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_26_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_26_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_26_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_26_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_26_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_26_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_26_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_26_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_26_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_26_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_26_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_26_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_26_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_26_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_26_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_26_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_27 {
		fillcolor=lightgray label="MoE Layer 27" style="rounded,filled"
		moe_27_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_27_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_27_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_27_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_27_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_27_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_27_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_27_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_27_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_27_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_27_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_27_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_27_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_27_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_27_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_27_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_27_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_27_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_27_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_27_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_27_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_27_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_27_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_28 {
		fillcolor=lightgray label="MoE Layer 28" style="rounded,filled"
		moe_28_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_28_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_28_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_28_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_28_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_28_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_28_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_28_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_28_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_28_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_28_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_28_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_28_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_28_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_28_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_28_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_28_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_28_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_28_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_28_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_28_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_28_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_28_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_29 {
		fillcolor=lightgray label="MoE Layer 29" style="rounded,filled"
		moe_29_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_29_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_29_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_29_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_29_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_29_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_29_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_29_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_29_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_29_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_29_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_29_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_29_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_29_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_29_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_29_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_29_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_29_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_29_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_29_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_29_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_29_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_29_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_30 {
		fillcolor=lightgray label="MoE Layer 30" style="rounded,filled"
		moe_30_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_30_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_30_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_30_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_30_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_30_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_30_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_30_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_30_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_30_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_30_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_30_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_30_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_30_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_30_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_30_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_30_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_30_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_30_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_30_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_30_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_30_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_30_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_31 {
		fillcolor=lightgray label="MoE Layer 31" style="rounded,filled"
		moe_31_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_31_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_31_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_31_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_31_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_31_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_31_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_31_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_31_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_31_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_31_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_31_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_31_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_31_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_31_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_31_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_31_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_31_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_31_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_31_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_31_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_31_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_31_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_32 {
		fillcolor=lightgray label="MoE Layer 32" style="rounded,filled"
		moe_32_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_32_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_32_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_32_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_32_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_32_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_32_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_32_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_32_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_32_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_32_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_32_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_32_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_32_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_32_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_32_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_32_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_32_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_32_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_32_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_32_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_32_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_32_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_33 {
		fillcolor=lightgray label="MoE Layer 33" style="rounded,filled"
		moe_33_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_33_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_33_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_33_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_33_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_33_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_33_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_33_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_33_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_33_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_33_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_33_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_33_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_33_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_33_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_33_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_33_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_33_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_33_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_33_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_33_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_33_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_33_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_34 {
		fillcolor=lightgray label="MoE Layer 34" style="rounded,filled"
		moe_34_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_34_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_34_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_34_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_34_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_34_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_34_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_34_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_34_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_34_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_34_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_34_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_34_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_34_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_34_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_34_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_34_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_34_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_34_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_34_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_34_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_34_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_34_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_35 {
		fillcolor=lightgray label="MoE Layer 35" style="rounded,filled"
		moe_35_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_35_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_35_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_35_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_35_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_35_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_35_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_35_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_35_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_35_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_35_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_35_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_35_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_35_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_35_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_35_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_35_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_35_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_35_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_35_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_35_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_35_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_35_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_36 {
		fillcolor=lightgray label="MoE Layer 36" style="rounded,filled"
		moe_36_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_36_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_36_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_36_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_36_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_36_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_36_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_36_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_36_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_36_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_36_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_36_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_36_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_36_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_36_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_36_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_36_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_36_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_36_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_36_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_36_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_36_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_36_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_37 {
		fillcolor=lightgray label="MoE Layer 37" style="rounded,filled"
		moe_37_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_37_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_37_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_37_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_37_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_37_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_37_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_37_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_37_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_37_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_37_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_37_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_37_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_37_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_37_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_37_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_37_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_37_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_37_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_37_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_37_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_37_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_37_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_38 {
		fillcolor=lightgray label="MoE Layer 38" style="rounded,filled"
		moe_38_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_38_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_38_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_38_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_38_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_38_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_38_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_38_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_38_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_38_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_38_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_38_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_38_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_38_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_38_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_38_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_38_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_38_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_38_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_38_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_38_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_38_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_38_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_39 {
		fillcolor=lightgray label="MoE Layer 39" style="rounded,filled"
		moe_39_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_39_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_39_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_39_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_39_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_39_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_39_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_39_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_39_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_39_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_39_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_39_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_39_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_39_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_39_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_39_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_39_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_39_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_39_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_39_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_39_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_39_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_39_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_40 {
		fillcolor=lightgray label="MoE Layer 40" style="rounded,filled"
		moe_40_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_40_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_40_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_40_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_40_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_40_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_40_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_40_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_40_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_40_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_40_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_40_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_40_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_40_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_40_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_40_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_40_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_40_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_40_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_40_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_40_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_40_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_40_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_41 {
		fillcolor=lightgray label="MoE Layer 41" style="rounded,filled"
		moe_41_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_41_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_41_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_41_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_41_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_41_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_41_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_41_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_41_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_41_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_41_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_41_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_41_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_41_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_41_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_41_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_41_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_41_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_41_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_41_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_41_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_41_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_41_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_42 {
		fillcolor=lightgray label="MoE Layer 42" style="rounded,filled"
		moe_42_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_42_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_42_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_42_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_42_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_42_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_42_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_42_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_42_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_42_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_42_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_42_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_42_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_42_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_42_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_42_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_42_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_42_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_42_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_42_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_42_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_42_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_42_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_43 {
		fillcolor=lightgray label="MoE Layer 43" style="rounded,filled"
		moe_43_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_43_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_43_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_43_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_43_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_43_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_43_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_43_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_43_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_43_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_43_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_43_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_43_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_43_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_43_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_43_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_43_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_43_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_43_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_43_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_43_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_43_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_43_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_44 {
		fillcolor=lightgray label="MoE Layer 44" style="rounded,filled"
		moe_44_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_44_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_44_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_44_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_44_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_44_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_44_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_44_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_44_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_44_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_44_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_44_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_44_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_44_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_44_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_44_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_44_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_44_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_44_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_44_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_44_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_44_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_44_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_45 {
		fillcolor=lightgray label="MoE Layer 45" style="rounded,filled"
		moe_45_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_45_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_45_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_45_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_45_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_45_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_45_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_45_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_45_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_45_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_45_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_45_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_45_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_45_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_45_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_45_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_45_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_45_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_45_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_45_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_45_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_45_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_45_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_46 {
		fillcolor=lightgray label="MoE Layer 46" style="rounded,filled"
		moe_46_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_46_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_46_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_46_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_46_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_46_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_46_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_46_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_46_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_46_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_46_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_46_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_46_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_46_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_46_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_46_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_46_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_46_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_46_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_46_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_46_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_46_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_46_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_47 {
		fillcolor=lightgray label="MoE Layer 47" style="rounded,filled"
		moe_47_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_47_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_47_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_47_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_47_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_47_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_47_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_47_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_47_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_47_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_47_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_47_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_47_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_47_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_47_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_47_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_47_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_47_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_47_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_47_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_47_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_47_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_47_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_48 {
		fillcolor=lightgray label="MoE Layer 48" style="rounded,filled"
		moe_48_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_48_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_48_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_48_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_48_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_48_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_48_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_48_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_48_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_48_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_48_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_48_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_48_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_48_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_48_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_48_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_48_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_48_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_48_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_48_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_48_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_48_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_48_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_49 {
		fillcolor=lightgray label="MoE Layer 49" style="rounded,filled"
		moe_49_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_49_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_49_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_49_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_49_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_49_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_49_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_49_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_49_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_49_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_49_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_49_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_49_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_49_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_49_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_49_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_49_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_49_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_49_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_49_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_49_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_49_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_49_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_50 {
		fillcolor=lightgray label="MoE Layer 50" style="rounded,filled"
		moe_50_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_50_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_50_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_50_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_50_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_50_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_50_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_50_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_50_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_50_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_50_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_50_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_50_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_50_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_50_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_50_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_50_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_50_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_50_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_50_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_50_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_50_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_50_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_51 {
		fillcolor=lightgray label="MoE Layer 51" style="rounded,filled"
		moe_51_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_51_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_51_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_51_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_51_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_51_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_51_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_51_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_51_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_51_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_51_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_51_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_51_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_51_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_51_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_51_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_51_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_51_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_51_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_51_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_51_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_51_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_51_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_52 {
		fillcolor=lightgray label="MoE Layer 52" style="rounded,filled"
		moe_52_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_52_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_52_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_52_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_52_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_52_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_52_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_52_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_52_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_52_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_52_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_52_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_52_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_52_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_52_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_52_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_52_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_52_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_52_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_52_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_52_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_52_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_52_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_53 {
		fillcolor=lightgray label="MoE Layer 53" style="rounded,filled"
		moe_53_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_53_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_53_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_53_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_53_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_53_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_53_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_53_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_53_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_53_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_53_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_53_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_53_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_53_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_53_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_53_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_53_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_53_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_53_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_53_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_53_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_53_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_53_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_54 {
		fillcolor=lightgray label="MoE Layer 54" style="rounded,filled"
		moe_54_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_54_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_54_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_54_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_54_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_54_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_54_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_54_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_54_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_54_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_54_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_54_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_54_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_54_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_54_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_54_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_54_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_54_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_54_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_54_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_54_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_54_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_54_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_55 {
		fillcolor=lightgray label="MoE Layer 55" style="rounded,filled"
		moe_55_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_55_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_55_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_55_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_55_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_55_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_55_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_55_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_55_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_55_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_55_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_55_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_55_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_55_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_55_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_55_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_55_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_55_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_55_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_55_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_55_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_55_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_55_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_56 {
		fillcolor=lightgray label="MoE Layer 56" style="rounded,filled"
		moe_56_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_56_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_56_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_56_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_56_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_56_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_56_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_56_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_56_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_56_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_56_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_56_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_56_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_56_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_56_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_56_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_56_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_56_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_56_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_56_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_56_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_56_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_56_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_57 {
		fillcolor=lightgray label="MoE Layer 57" style="rounded,filled"
		moe_57_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_57_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_57_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_57_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_57_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_57_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_57_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_57_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_57_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_57_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_57_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_57_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_57_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_57_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_57_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_57_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_57_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_57_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_57_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_57_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_57_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_57_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_57_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_58 {
		fillcolor=lightgray label="MoE Layer 58" style="rounded,filled"
		moe_58_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_58_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_58_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_58_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_58_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_58_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_58_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_58_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_58_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_58_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_58_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_58_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_58_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_58_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_58_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_58_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_58_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_58_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_58_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_58_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_58_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_58_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_58_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_59 {
		fillcolor=lightgray label="MoE Layer 59" style="rounded,filled"
		moe_59_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_59_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_59_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_59_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_59_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_59_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_59_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_59_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_59_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_59_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_59_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_59_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_59_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_59_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_59_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_59_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_59_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_59_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_59_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_59_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_59_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_59_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_59_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_60 {
		fillcolor=lightgray label="MoE Layer 60" style="rounded,filled"
		moe_60_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_60_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_60_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_60_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_60_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_60_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_60_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_60_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_60_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_60_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_60_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_60_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_60_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_60_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_60_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_60_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_60_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_60_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_60_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_60_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_60_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_60_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_60_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_moe_61 {
		fillcolor=lightgray label="MoE Layer 61" style="rounded,filled"
		moe_61_mha [label="MHA Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_61_gate [label="Gating Network\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, num_experts=16]" fillcolor=lightyellow shape=parallelogram]
		moe_61_route [label="Token Routing\nGPU: All GPUs\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightblue shape=ellipse]
		moe_61_expert_0 [label="Expert 0 MLP\nGPU: 0\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_61_expert_1 [label="Expert 1 MLP\nGPU: 1\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_61_expert_2 [label="Expert 2 MLP\nGPU: 2\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_61_expert_3 [label="Expert 3 MLP\nGPU: 3\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_61_expert_4 [label="Expert 4 MLP\nGPU: 4\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_61_expert_5 [label="Expert 5 MLP\nGPU: 5\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_61_expert_6 [label="Expert 6 MLP\nGPU: 6\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_61_expert_7 [label="Expert 7 MLP\nGPU: 7\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_61_expert_8 [label="Expert 8 MLP\nGPU: 8\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_61_expert_9 [label="Expert 9 MLP\nGPU: 9\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_61_expert_10 [label="Expert 10 MLP\nGPU: 10\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_61_expert_11 [label="Expert 11 MLP\nGPU: 11\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_61_expert_12 [label="Expert 12 MLP\nGPU: 12\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_61_expert_13 [label="Expert 13 MLP\nGPU: 13\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_61_expert_14 [label="Expert 14 MLP\nGPU: 14\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_61_expert_15 [label="Expert 15 MLP\nGPU: 15\nInput: [batch_size_subset, token_dim=7168]\nOutput: [batch_size_subset, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_61_aggregate [label="Expert Output Aggregation\nGPU: All GPUs\nInput: [batch_size_subset, token_dim=7168] x 16\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightblue shape=ellipse]
		moe_61_ffn [label="FFN Computation\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
		moe_61_res1 [label="Residual Add 1\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
		moe_61_res2 [label="Residual Add 2\nGPU: Replicated\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightyellow shape=parallelogram]
	}
	subgraph cluster_output {
		fillcolor=lightgray label="Output Layer" style="rounded,filled"
		output [label="OUTPUT\nGPU: Host\nInput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]\nOutput: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]" fillcolor=lightgreen shape=rectangle]
	}
	input -> dense_1_mha
	dense_1_mha -> dense_1_res1
	dense_1_res1 -> dense_1_ffn
	dense_1_ffn -> dense_1_res2
	dense_1_res2 -> dense_2_mha
	dense_2_mha -> dense_2_res1
	dense_2_res1 -> dense_2_ffn
	dense_2_ffn -> dense_2_res2
	dense_2_res2 -> dense_3_mha
	dense_3_mha -> dense_3_res1
	dense_3_res1 -> dense_3_ffn
	dense_3_ffn -> dense_3_res2
	dense_3_res2 -> moe_4_mha
	moe_4_mha -> moe_4_res1
	moe_4_res1 -> moe_4_gate
	moe_4_gate -> moe_4_route
	moe_4_route -> moe_4_expert_0
	moe_4_route -> moe_4_expert_1
	moe_4_route -> moe_4_expert_2
	moe_4_route -> moe_4_expert_3
	moe_4_route -> moe_4_expert_4
	moe_4_route -> moe_4_expert_5
	moe_4_route -> moe_4_expert_6
	moe_4_route -> moe_4_expert_7
	moe_4_route -> moe_4_expert_8
	moe_4_route -> moe_4_expert_9
	moe_4_route -> moe_4_expert_10
	moe_4_route -> moe_4_expert_11
	moe_4_route -> moe_4_expert_12
	moe_4_route -> moe_4_expert_13
	moe_4_route -> moe_4_expert_14
	moe_4_route -> moe_4_expert_15
	moe_4_expert_0 -> moe_4_aggregate
	moe_4_expert_1 -> moe_4_aggregate
	moe_4_expert_2 -> moe_4_aggregate
	moe_4_expert_3 -> moe_4_aggregate
	moe_4_expert_4 -> moe_4_aggregate
	moe_4_expert_5 -> moe_4_aggregate
	moe_4_expert_6 -> moe_4_aggregate
	moe_4_expert_7 -> moe_4_aggregate
	moe_4_expert_8 -> moe_4_aggregate
	moe_4_expert_9 -> moe_4_aggregate
	moe_4_expert_10 -> moe_4_aggregate
	moe_4_expert_11 -> moe_4_aggregate
	moe_4_expert_12 -> moe_4_aggregate
	moe_4_expert_13 -> moe_4_aggregate
	moe_4_expert_14 -> moe_4_aggregate
	moe_4_expert_15 -> moe_4_aggregate
	moe_4_aggregate -> moe_4_ffn
	moe_4_ffn -> moe_4_res2
	moe_4_res2 -> moe_5_mha
	moe_5_mha -> moe_5_res1
	moe_5_res1 -> moe_5_gate
	moe_5_gate -> moe_5_route
	moe_5_route -> moe_5_expert_0
	moe_5_route -> moe_5_expert_1
	moe_5_route -> moe_5_expert_2
	moe_5_route -> moe_5_expert_3
	moe_5_route -> moe_5_expert_4
	moe_5_route -> moe_5_expert_5
	moe_5_route -> moe_5_expert_6
	moe_5_route -> moe_5_expert_7
	moe_5_route -> moe_5_expert_8
	moe_5_route -> moe_5_expert_9
	moe_5_route -> moe_5_expert_10
	moe_5_route -> moe_5_expert_11
	moe_5_route -> moe_5_expert_12
	moe_5_route -> moe_5_expert_13
	moe_5_route -> moe_5_expert_14
	moe_5_route -> moe_5_expert_15
	moe_5_expert_0 -> moe_5_aggregate
	moe_5_expert_1 -> moe_5_aggregate
	moe_5_expert_2 -> moe_5_aggregate
	moe_5_expert_3 -> moe_5_aggregate
	moe_5_expert_4 -> moe_5_aggregate
	moe_5_expert_5 -> moe_5_aggregate
	moe_5_expert_6 -> moe_5_aggregate
	moe_5_expert_7 -> moe_5_aggregate
	moe_5_expert_8 -> moe_5_aggregate
	moe_5_expert_9 -> moe_5_aggregate
	moe_5_expert_10 -> moe_5_aggregate
	moe_5_expert_11 -> moe_5_aggregate
	moe_5_expert_12 -> moe_5_aggregate
	moe_5_expert_13 -> moe_5_aggregate
	moe_5_expert_14 -> moe_5_aggregate
	moe_5_expert_15 -> moe_5_aggregate
	moe_5_aggregate -> moe_5_ffn
	moe_5_ffn -> moe_5_res2
	moe_5_res2 -> moe_6_mha
	moe_6_mha -> moe_6_res1
	moe_6_res1 -> moe_6_gate
	moe_6_gate -> moe_6_route
	moe_6_route -> moe_6_expert_0
	moe_6_route -> moe_6_expert_1
	moe_6_route -> moe_6_expert_2
	moe_6_route -> moe_6_expert_3
	moe_6_route -> moe_6_expert_4
	moe_6_route -> moe_6_expert_5
	moe_6_route -> moe_6_expert_6
	moe_6_route -> moe_6_expert_7
	moe_6_route -> moe_6_expert_8
	moe_6_route -> moe_6_expert_9
	moe_6_route -> moe_6_expert_10
	moe_6_route -> moe_6_expert_11
	moe_6_route -> moe_6_expert_12
	moe_6_route -> moe_6_expert_13
	moe_6_route -> moe_6_expert_14
	moe_6_route -> moe_6_expert_15
	moe_6_expert_0 -> moe_6_aggregate
	moe_6_expert_1 -> moe_6_aggregate
	moe_6_expert_2 -> moe_6_aggregate
	moe_6_expert_3 -> moe_6_aggregate
	moe_6_expert_4 -> moe_6_aggregate
	moe_6_expert_5 -> moe_6_aggregate
	moe_6_expert_6 -> moe_6_aggregate
	moe_6_expert_7 -> moe_6_aggregate
	moe_6_expert_8 -> moe_6_aggregate
	moe_6_expert_9 -> moe_6_aggregate
	moe_6_expert_10 -> moe_6_aggregate
	moe_6_expert_11 -> moe_6_aggregate
	moe_6_expert_12 -> moe_6_aggregate
	moe_6_expert_13 -> moe_6_aggregate
	moe_6_expert_14 -> moe_6_aggregate
	moe_6_expert_15 -> moe_6_aggregate
	moe_6_aggregate -> moe_6_ffn
	moe_6_ffn -> moe_6_res2
	moe_6_res2 -> moe_7_mha
	moe_7_mha -> moe_7_res1
	moe_7_res1 -> moe_7_gate
	moe_7_gate -> moe_7_route
	moe_7_route -> moe_7_expert_0
	moe_7_route -> moe_7_expert_1
	moe_7_route -> moe_7_expert_2
	moe_7_route -> moe_7_expert_3
	moe_7_route -> moe_7_expert_4
	moe_7_route -> moe_7_expert_5
	moe_7_route -> moe_7_expert_6
	moe_7_route -> moe_7_expert_7
	moe_7_route -> moe_7_expert_8
	moe_7_route -> moe_7_expert_9
	moe_7_route -> moe_7_expert_10
	moe_7_route -> moe_7_expert_11
	moe_7_route -> moe_7_expert_12
	moe_7_route -> moe_7_expert_13
	moe_7_route -> moe_7_expert_14
	moe_7_route -> moe_7_expert_15
	moe_7_expert_0 -> moe_7_aggregate
	moe_7_expert_1 -> moe_7_aggregate
	moe_7_expert_2 -> moe_7_aggregate
	moe_7_expert_3 -> moe_7_aggregate
	moe_7_expert_4 -> moe_7_aggregate
	moe_7_expert_5 -> moe_7_aggregate
	moe_7_expert_6 -> moe_7_aggregate
	moe_7_expert_7 -> moe_7_aggregate
	moe_7_expert_8 -> moe_7_aggregate
	moe_7_expert_9 -> moe_7_aggregate
	moe_7_expert_10 -> moe_7_aggregate
	moe_7_expert_11 -> moe_7_aggregate
	moe_7_expert_12 -> moe_7_aggregate
	moe_7_expert_13 -> moe_7_aggregate
	moe_7_expert_14 -> moe_7_aggregate
	moe_7_expert_15 -> moe_7_aggregate
	moe_7_aggregate -> moe_7_ffn
	moe_7_ffn -> moe_7_res2
	moe_7_res2 -> moe_8_mha
	moe_8_mha -> moe_8_res1
	moe_8_res1 -> moe_8_gate
	moe_8_gate -> moe_8_route
	moe_8_route -> moe_8_expert_0
	moe_8_route -> moe_8_expert_1
	moe_8_route -> moe_8_expert_2
	moe_8_route -> moe_8_expert_3
	moe_8_route -> moe_8_expert_4
	moe_8_route -> moe_8_expert_5
	moe_8_route -> moe_8_expert_6
	moe_8_route -> moe_8_expert_7
	moe_8_route -> moe_8_expert_8
	moe_8_route -> moe_8_expert_9
	moe_8_route -> moe_8_expert_10
	moe_8_route -> moe_8_expert_11
	moe_8_route -> moe_8_expert_12
	moe_8_route -> moe_8_expert_13
	moe_8_route -> moe_8_expert_14
	moe_8_route -> moe_8_expert_15
	moe_8_expert_0 -> moe_8_aggregate
	moe_8_expert_1 -> moe_8_aggregate
	moe_8_expert_2 -> moe_8_aggregate
	moe_8_expert_3 -> moe_8_aggregate
	moe_8_expert_4 -> moe_8_aggregate
	moe_8_expert_5 -> moe_8_aggregate
	moe_8_expert_6 -> moe_8_aggregate
	moe_8_expert_7 -> moe_8_aggregate
	moe_8_expert_8 -> moe_8_aggregate
	moe_8_expert_9 -> moe_8_aggregate
	moe_8_expert_10 -> moe_8_aggregate
	moe_8_expert_11 -> moe_8_aggregate
	moe_8_expert_12 -> moe_8_aggregate
	moe_8_expert_13 -> moe_8_aggregate
	moe_8_expert_14 -> moe_8_aggregate
	moe_8_expert_15 -> moe_8_aggregate
	moe_8_aggregate -> moe_8_ffn
	moe_8_ffn -> moe_8_res2
	moe_8_res2 -> moe_9_mha
	moe_9_mha -> moe_9_res1
	moe_9_res1 -> moe_9_gate
	moe_9_gate -> moe_9_route
	moe_9_route -> moe_9_expert_0
	moe_9_route -> moe_9_expert_1
	moe_9_route -> moe_9_expert_2
	moe_9_route -> moe_9_expert_3
	moe_9_route -> moe_9_expert_4
	moe_9_route -> moe_9_expert_5
	moe_9_route -> moe_9_expert_6
	moe_9_route -> moe_9_expert_7
	moe_9_route -> moe_9_expert_8
	moe_9_route -> moe_9_expert_9
	moe_9_route -> moe_9_expert_10
	moe_9_route -> moe_9_expert_11
	moe_9_route -> moe_9_expert_12
	moe_9_route -> moe_9_expert_13
	moe_9_route -> moe_9_expert_14
	moe_9_route -> moe_9_expert_15
	moe_9_expert_0 -> moe_9_aggregate
	moe_9_expert_1 -> moe_9_aggregate
	moe_9_expert_2 -> moe_9_aggregate
	moe_9_expert_3 -> moe_9_aggregate
	moe_9_expert_4 -> moe_9_aggregate
	moe_9_expert_5 -> moe_9_aggregate
	moe_9_expert_6 -> moe_9_aggregate
	moe_9_expert_7 -> moe_9_aggregate
	moe_9_expert_8 -> moe_9_aggregate
	moe_9_expert_9 -> moe_9_aggregate
	moe_9_expert_10 -> moe_9_aggregate
	moe_9_expert_11 -> moe_9_aggregate
	moe_9_expert_12 -> moe_9_aggregate
	moe_9_expert_13 -> moe_9_aggregate
	moe_9_expert_14 -> moe_9_aggregate
	moe_9_expert_15 -> moe_9_aggregate
	moe_9_aggregate -> moe_9_ffn
	moe_9_ffn -> moe_9_res2
	moe_9_res2 -> moe_10_mha
	moe_10_mha -> moe_10_res1
	moe_10_res1 -> moe_10_gate
	moe_10_gate -> moe_10_route
	moe_10_route -> moe_10_expert_0
	moe_10_route -> moe_10_expert_1
	moe_10_route -> moe_10_expert_2
	moe_10_route -> moe_10_expert_3
	moe_10_route -> moe_10_expert_4
	moe_10_route -> moe_10_expert_5
	moe_10_route -> moe_10_expert_6
	moe_10_route -> moe_10_expert_7
	moe_10_route -> moe_10_expert_8
	moe_10_route -> moe_10_expert_9
	moe_10_route -> moe_10_expert_10
	moe_10_route -> moe_10_expert_11
	moe_10_route -> moe_10_expert_12
	moe_10_route -> moe_10_expert_13
	moe_10_route -> moe_10_expert_14
	moe_10_route -> moe_10_expert_15
	moe_10_expert_0 -> moe_10_aggregate
	moe_10_expert_1 -> moe_10_aggregate
	moe_10_expert_2 -> moe_10_aggregate
	moe_10_expert_3 -> moe_10_aggregate
	moe_10_expert_4 -> moe_10_aggregate
	moe_10_expert_5 -> moe_10_aggregate
	moe_10_expert_6 -> moe_10_aggregate
	moe_10_expert_7 -> moe_10_aggregate
	moe_10_expert_8 -> moe_10_aggregate
	moe_10_expert_9 -> moe_10_aggregate
	moe_10_expert_10 -> moe_10_aggregate
	moe_10_expert_11 -> moe_10_aggregate
	moe_10_expert_12 -> moe_10_aggregate
	moe_10_expert_13 -> moe_10_aggregate
	moe_10_expert_14 -> moe_10_aggregate
	moe_10_expert_15 -> moe_10_aggregate
	moe_10_aggregate -> moe_10_ffn
	moe_10_ffn -> moe_10_res2
	moe_10_res2 -> moe_11_mha
	moe_11_mha -> moe_11_res1
	moe_11_res1 -> moe_11_gate
	moe_11_gate -> moe_11_route
	moe_11_route -> moe_11_expert_0
	moe_11_route -> moe_11_expert_1
	moe_11_route -> moe_11_expert_2
	moe_11_route -> moe_11_expert_3
	moe_11_route -> moe_11_expert_4
	moe_11_route -> moe_11_expert_5
	moe_11_route -> moe_11_expert_6
	moe_11_route -> moe_11_expert_7
	moe_11_route -> moe_11_expert_8
	moe_11_route -> moe_11_expert_9
	moe_11_route -> moe_11_expert_10
	moe_11_route -> moe_11_expert_11
	moe_11_route -> moe_11_expert_12
	moe_11_route -> moe_11_expert_13
	moe_11_route -> moe_11_expert_14
	moe_11_route -> moe_11_expert_15
	moe_11_expert_0 -> moe_11_aggregate
	moe_11_expert_1 -> moe_11_aggregate
	moe_11_expert_2 -> moe_11_aggregate
	moe_11_expert_3 -> moe_11_aggregate
	moe_11_expert_4 -> moe_11_aggregate
	moe_11_expert_5 -> moe_11_aggregate
	moe_11_expert_6 -> moe_11_aggregate
	moe_11_expert_7 -> moe_11_aggregate
	moe_11_expert_8 -> moe_11_aggregate
	moe_11_expert_9 -> moe_11_aggregate
	moe_11_expert_10 -> moe_11_aggregate
	moe_11_expert_11 -> moe_11_aggregate
	moe_11_expert_12 -> moe_11_aggregate
	moe_11_expert_13 -> moe_11_aggregate
	moe_11_expert_14 -> moe_11_aggregate
	moe_11_expert_15 -> moe_11_aggregate
	moe_11_aggregate -> moe_11_ffn
	moe_11_ffn -> moe_11_res2
	moe_11_res2 -> moe_12_mha
	moe_12_mha -> moe_12_res1
	moe_12_res1 -> moe_12_gate
	moe_12_gate -> moe_12_route
	moe_12_route -> moe_12_expert_0
	moe_12_route -> moe_12_expert_1
	moe_12_route -> moe_12_expert_2
	moe_12_route -> moe_12_expert_3
	moe_12_route -> moe_12_expert_4
	moe_12_route -> moe_12_expert_5
	moe_12_route -> moe_12_expert_6
	moe_12_route -> moe_12_expert_7
	moe_12_route -> moe_12_expert_8
	moe_12_route -> moe_12_expert_9
	moe_12_route -> moe_12_expert_10
	moe_12_route -> moe_12_expert_11
	moe_12_route -> moe_12_expert_12
	moe_12_route -> moe_12_expert_13
	moe_12_route -> moe_12_expert_14
	moe_12_route -> moe_12_expert_15
	moe_12_expert_0 -> moe_12_aggregate
	moe_12_expert_1 -> moe_12_aggregate
	moe_12_expert_2 -> moe_12_aggregate
	moe_12_expert_3 -> moe_12_aggregate
	moe_12_expert_4 -> moe_12_aggregate
	moe_12_expert_5 -> moe_12_aggregate
	moe_12_expert_6 -> moe_12_aggregate
	moe_12_expert_7 -> moe_12_aggregate
	moe_12_expert_8 -> moe_12_aggregate
	moe_12_expert_9 -> moe_12_aggregate
	moe_12_expert_10 -> moe_12_aggregate
	moe_12_expert_11 -> moe_12_aggregate
	moe_12_expert_12 -> moe_12_aggregate
	moe_12_expert_13 -> moe_12_aggregate
	moe_12_expert_14 -> moe_12_aggregate
	moe_12_expert_15 -> moe_12_aggregate
	moe_12_aggregate -> moe_12_ffn
	moe_12_ffn -> moe_12_res2
	moe_12_res2 -> moe_13_mha
	moe_13_mha -> moe_13_res1
	moe_13_res1 -> moe_13_gate
	moe_13_gate -> moe_13_route
	moe_13_route -> moe_13_expert_0
	moe_13_route -> moe_13_expert_1
	moe_13_route -> moe_13_expert_2
	moe_13_route -> moe_13_expert_3
	moe_13_route -> moe_13_expert_4
	moe_13_route -> moe_13_expert_5
	moe_13_route -> moe_13_expert_6
	moe_13_route -> moe_13_expert_7
	moe_13_route -> moe_13_expert_8
	moe_13_route -> moe_13_expert_9
	moe_13_route -> moe_13_expert_10
	moe_13_route -> moe_13_expert_11
	moe_13_route -> moe_13_expert_12
	moe_13_route -> moe_13_expert_13
	moe_13_route -> moe_13_expert_14
	moe_13_route -> moe_13_expert_15
	moe_13_expert_0 -> moe_13_aggregate
	moe_13_expert_1 -> moe_13_aggregate
	moe_13_expert_2 -> moe_13_aggregate
	moe_13_expert_3 -> moe_13_aggregate
	moe_13_expert_4 -> moe_13_aggregate
	moe_13_expert_5 -> moe_13_aggregate
	moe_13_expert_6 -> moe_13_aggregate
	moe_13_expert_7 -> moe_13_aggregate
	moe_13_expert_8 -> moe_13_aggregate
	moe_13_expert_9 -> moe_13_aggregate
	moe_13_expert_10 -> moe_13_aggregate
	moe_13_expert_11 -> moe_13_aggregate
	moe_13_expert_12 -> moe_13_aggregate
	moe_13_expert_13 -> moe_13_aggregate
	moe_13_expert_14 -> moe_13_aggregate
	moe_13_expert_15 -> moe_13_aggregate
	moe_13_aggregate -> moe_13_ffn
	moe_13_ffn -> moe_13_res2
	moe_13_res2 -> moe_14_mha
	moe_14_mha -> moe_14_res1
	moe_14_res1 -> moe_14_gate
	moe_14_gate -> moe_14_route
	moe_14_route -> moe_14_expert_0
	moe_14_route -> moe_14_expert_1
	moe_14_route -> moe_14_expert_2
	moe_14_route -> moe_14_expert_3
	moe_14_route -> moe_14_expert_4
	moe_14_route -> moe_14_expert_5
	moe_14_route -> moe_14_expert_6
	moe_14_route -> moe_14_expert_7
	moe_14_route -> moe_14_expert_8
	moe_14_route -> moe_14_expert_9
	moe_14_route -> moe_14_expert_10
	moe_14_route -> moe_14_expert_11
	moe_14_route -> moe_14_expert_12
	moe_14_route -> moe_14_expert_13
	moe_14_route -> moe_14_expert_14
	moe_14_route -> moe_14_expert_15
	moe_14_expert_0 -> moe_14_aggregate
	moe_14_expert_1 -> moe_14_aggregate
	moe_14_expert_2 -> moe_14_aggregate
	moe_14_expert_3 -> moe_14_aggregate
	moe_14_expert_4 -> moe_14_aggregate
	moe_14_expert_5 -> moe_14_aggregate
	moe_14_expert_6 -> moe_14_aggregate
	moe_14_expert_7 -> moe_14_aggregate
	moe_14_expert_8 -> moe_14_aggregate
	moe_14_expert_9 -> moe_14_aggregate
	moe_14_expert_10 -> moe_14_aggregate
	moe_14_expert_11 -> moe_14_aggregate
	moe_14_expert_12 -> moe_14_aggregate
	moe_14_expert_13 -> moe_14_aggregate
	moe_14_expert_14 -> moe_14_aggregate
	moe_14_expert_15 -> moe_14_aggregate
	moe_14_aggregate -> moe_14_ffn
	moe_14_ffn -> moe_14_res2
	moe_14_res2 -> moe_15_mha
	moe_15_mha -> moe_15_res1
	moe_15_res1 -> moe_15_gate
	moe_15_gate -> moe_15_route
	moe_15_route -> moe_15_expert_0
	moe_15_route -> moe_15_expert_1
	moe_15_route -> moe_15_expert_2
	moe_15_route -> moe_15_expert_3
	moe_15_route -> moe_15_expert_4
	moe_15_route -> moe_15_expert_5
	moe_15_route -> moe_15_expert_6
	moe_15_route -> moe_15_expert_7
	moe_15_route -> moe_15_expert_8
	moe_15_route -> moe_15_expert_9
	moe_15_route -> moe_15_expert_10
	moe_15_route -> moe_15_expert_11
	moe_15_route -> moe_15_expert_12
	moe_15_route -> moe_15_expert_13
	moe_15_route -> moe_15_expert_14
	moe_15_route -> moe_15_expert_15
	moe_15_expert_0 -> moe_15_aggregate
	moe_15_expert_1 -> moe_15_aggregate
	moe_15_expert_2 -> moe_15_aggregate
	moe_15_expert_3 -> moe_15_aggregate
	moe_15_expert_4 -> moe_15_aggregate
	moe_15_expert_5 -> moe_15_aggregate
	moe_15_expert_6 -> moe_15_aggregate
	moe_15_expert_7 -> moe_15_aggregate
	moe_15_expert_8 -> moe_15_aggregate
	moe_15_expert_9 -> moe_15_aggregate
	moe_15_expert_10 -> moe_15_aggregate
	moe_15_expert_11 -> moe_15_aggregate
	moe_15_expert_12 -> moe_15_aggregate
	moe_15_expert_13 -> moe_15_aggregate
	moe_15_expert_14 -> moe_15_aggregate
	moe_15_expert_15 -> moe_15_aggregate
	moe_15_aggregate -> moe_15_ffn
	moe_15_ffn -> moe_15_res2
	moe_15_res2 -> moe_16_mha
	moe_16_mha -> moe_16_res1
	moe_16_res1 -> moe_16_gate
	moe_16_gate -> moe_16_route
	moe_16_route -> moe_16_expert_0
	moe_16_route -> moe_16_expert_1
	moe_16_route -> moe_16_expert_2
	moe_16_route -> moe_16_expert_3
	moe_16_route -> moe_16_expert_4
	moe_16_route -> moe_16_expert_5
	moe_16_route -> moe_16_expert_6
	moe_16_route -> moe_16_expert_7
	moe_16_route -> moe_16_expert_8
	moe_16_route -> moe_16_expert_9
	moe_16_route -> moe_16_expert_10
	moe_16_route -> moe_16_expert_11
	moe_16_route -> moe_16_expert_12
	moe_16_route -> moe_16_expert_13
	moe_16_route -> moe_16_expert_14
	moe_16_route -> moe_16_expert_15
	moe_16_expert_0 -> moe_16_aggregate
	moe_16_expert_1 -> moe_16_aggregate
	moe_16_expert_2 -> moe_16_aggregate
	moe_16_expert_3 -> moe_16_aggregate
	moe_16_expert_4 -> moe_16_aggregate
	moe_16_expert_5 -> moe_16_aggregate
	moe_16_expert_6 -> moe_16_aggregate
	moe_16_expert_7 -> moe_16_aggregate
	moe_16_expert_8 -> moe_16_aggregate
	moe_16_expert_9 -> moe_16_aggregate
	moe_16_expert_10 -> moe_16_aggregate
	moe_16_expert_11 -> moe_16_aggregate
	moe_16_expert_12 -> moe_16_aggregate
	moe_16_expert_13 -> moe_16_aggregate
	moe_16_expert_14 -> moe_16_aggregate
	moe_16_expert_15 -> moe_16_aggregate
	moe_16_aggregate -> moe_16_ffn
	moe_16_ffn -> moe_16_res2
	moe_16_res2 -> moe_17_mha
	moe_17_mha -> moe_17_res1
	moe_17_res1 -> moe_17_gate
	moe_17_gate -> moe_17_route
	moe_17_route -> moe_17_expert_0
	moe_17_route -> moe_17_expert_1
	moe_17_route -> moe_17_expert_2
	moe_17_route -> moe_17_expert_3
	moe_17_route -> moe_17_expert_4
	moe_17_route -> moe_17_expert_5
	moe_17_route -> moe_17_expert_6
	moe_17_route -> moe_17_expert_7
	moe_17_route -> moe_17_expert_8
	moe_17_route -> moe_17_expert_9
	moe_17_route -> moe_17_expert_10
	moe_17_route -> moe_17_expert_11
	moe_17_route -> moe_17_expert_12
	moe_17_route -> moe_17_expert_13
	moe_17_route -> moe_17_expert_14
	moe_17_route -> moe_17_expert_15
	moe_17_expert_0 -> moe_17_aggregate
	moe_17_expert_1 -> moe_17_aggregate
	moe_17_expert_2 -> moe_17_aggregate
	moe_17_expert_3 -> moe_17_aggregate
	moe_17_expert_4 -> moe_17_aggregate
	moe_17_expert_5 -> moe_17_aggregate
	moe_17_expert_6 -> moe_17_aggregate
	moe_17_expert_7 -> moe_17_aggregate
	moe_17_expert_8 -> moe_17_aggregate
	moe_17_expert_9 -> moe_17_aggregate
	moe_17_expert_10 -> moe_17_aggregate
	moe_17_expert_11 -> moe_17_aggregate
	moe_17_expert_12 -> moe_17_aggregate
	moe_17_expert_13 -> moe_17_aggregate
	moe_17_expert_14 -> moe_17_aggregate
	moe_17_expert_15 -> moe_17_aggregate
	moe_17_aggregate -> moe_17_ffn
	moe_17_ffn -> moe_17_res2
	moe_17_res2 -> moe_18_mha
	moe_18_mha -> moe_18_res1
	moe_18_res1 -> moe_18_gate
	moe_18_gate -> moe_18_route
	moe_18_route -> moe_18_expert_0
	moe_18_route -> moe_18_expert_1
	moe_18_route -> moe_18_expert_2
	moe_18_route -> moe_18_expert_3
	moe_18_route -> moe_18_expert_4
	moe_18_route -> moe_18_expert_5
	moe_18_route -> moe_18_expert_6
	moe_18_route -> moe_18_expert_7
	moe_18_route -> moe_18_expert_8
	moe_18_route -> moe_18_expert_9
	moe_18_route -> moe_18_expert_10
	moe_18_route -> moe_18_expert_11
	moe_18_route -> moe_18_expert_12
	moe_18_route -> moe_18_expert_13
	moe_18_route -> moe_18_expert_14
	moe_18_route -> moe_18_expert_15
	moe_18_expert_0 -> moe_18_aggregate
	moe_18_expert_1 -> moe_18_aggregate
	moe_18_expert_2 -> moe_18_aggregate
	moe_18_expert_3 -> moe_18_aggregate
	moe_18_expert_4 -> moe_18_aggregate
	moe_18_expert_5 -> moe_18_aggregate
	moe_18_expert_6 -> moe_18_aggregate
	moe_18_expert_7 -> moe_18_aggregate
	moe_18_expert_8 -> moe_18_aggregate
	moe_18_expert_9 -> moe_18_aggregate
	moe_18_expert_10 -> moe_18_aggregate
	moe_18_expert_11 -> moe_18_aggregate
	moe_18_expert_12 -> moe_18_aggregate
	moe_18_expert_13 -> moe_18_aggregate
	moe_18_expert_14 -> moe_18_aggregate
	moe_18_expert_15 -> moe_18_aggregate
	moe_18_aggregate -> moe_18_ffn
	moe_18_ffn -> moe_18_res2
	moe_18_res2 -> moe_19_mha
	moe_19_mha -> moe_19_res1
	moe_19_res1 -> moe_19_gate
	moe_19_gate -> moe_19_route
	moe_19_route -> moe_19_expert_0
	moe_19_route -> moe_19_expert_1
	moe_19_route -> moe_19_expert_2
	moe_19_route -> moe_19_expert_3
	moe_19_route -> moe_19_expert_4
	moe_19_route -> moe_19_expert_5
	moe_19_route -> moe_19_expert_6
	moe_19_route -> moe_19_expert_7
	moe_19_route -> moe_19_expert_8
	moe_19_route -> moe_19_expert_9
	moe_19_route -> moe_19_expert_10
	moe_19_route -> moe_19_expert_11
	moe_19_route -> moe_19_expert_12
	moe_19_route -> moe_19_expert_13
	moe_19_route -> moe_19_expert_14
	moe_19_route -> moe_19_expert_15
	moe_19_expert_0 -> moe_19_aggregate
	moe_19_expert_1 -> moe_19_aggregate
	moe_19_expert_2 -> moe_19_aggregate
	moe_19_expert_3 -> moe_19_aggregate
	moe_19_expert_4 -> moe_19_aggregate
	moe_19_expert_5 -> moe_19_aggregate
	moe_19_expert_6 -> moe_19_aggregate
	moe_19_expert_7 -> moe_19_aggregate
	moe_19_expert_8 -> moe_19_aggregate
	moe_19_expert_9 -> moe_19_aggregate
	moe_19_expert_10 -> moe_19_aggregate
	moe_19_expert_11 -> moe_19_aggregate
	moe_19_expert_12 -> moe_19_aggregate
	moe_19_expert_13 -> moe_19_aggregate
	moe_19_expert_14 -> moe_19_aggregate
	moe_19_expert_15 -> moe_19_aggregate
	moe_19_aggregate -> moe_19_ffn
	moe_19_ffn -> moe_19_res2
	moe_19_res2 -> moe_20_mha
	moe_20_mha -> moe_20_res1
	moe_20_res1 -> moe_20_gate
	moe_20_gate -> moe_20_route
	moe_20_route -> moe_20_expert_0
	moe_20_route -> moe_20_expert_1
	moe_20_route -> moe_20_expert_2
	moe_20_route -> moe_20_expert_3
	moe_20_route -> moe_20_expert_4
	moe_20_route -> moe_20_expert_5
	moe_20_route -> moe_20_expert_6
	moe_20_route -> moe_20_expert_7
	moe_20_route -> moe_20_expert_8
	moe_20_route -> moe_20_expert_9
	moe_20_route -> moe_20_expert_10
	moe_20_route -> moe_20_expert_11
	moe_20_route -> moe_20_expert_12
	moe_20_route -> moe_20_expert_13
	moe_20_route -> moe_20_expert_14
	moe_20_route -> moe_20_expert_15
	moe_20_expert_0 -> moe_20_aggregate
	moe_20_expert_1 -> moe_20_aggregate
	moe_20_expert_2 -> moe_20_aggregate
	moe_20_expert_3 -> moe_20_aggregate
	moe_20_expert_4 -> moe_20_aggregate
	moe_20_expert_5 -> moe_20_aggregate
	moe_20_expert_6 -> moe_20_aggregate
	moe_20_expert_7 -> moe_20_aggregate
	moe_20_expert_8 -> moe_20_aggregate
	moe_20_expert_9 -> moe_20_aggregate
	moe_20_expert_10 -> moe_20_aggregate
	moe_20_expert_11 -> moe_20_aggregate
	moe_20_expert_12 -> moe_20_aggregate
	moe_20_expert_13 -> moe_20_aggregate
	moe_20_expert_14 -> moe_20_aggregate
	moe_20_expert_15 -> moe_20_aggregate
	moe_20_aggregate -> moe_20_ffn
	moe_20_ffn -> moe_20_res2
	moe_20_res2 -> moe_21_mha
	moe_21_mha -> moe_21_res1
	moe_21_res1 -> moe_21_gate
	moe_21_gate -> moe_21_route
	moe_21_route -> moe_21_expert_0
	moe_21_route -> moe_21_expert_1
	moe_21_route -> moe_21_expert_2
	moe_21_route -> moe_21_expert_3
	moe_21_route -> moe_21_expert_4
	moe_21_route -> moe_21_expert_5
	moe_21_route -> moe_21_expert_6
	moe_21_route -> moe_21_expert_7
	moe_21_route -> moe_21_expert_8
	moe_21_route -> moe_21_expert_9
	moe_21_route -> moe_21_expert_10
	moe_21_route -> moe_21_expert_11
	moe_21_route -> moe_21_expert_12
	moe_21_route -> moe_21_expert_13
	moe_21_route -> moe_21_expert_14
	moe_21_route -> moe_21_expert_15
	moe_21_expert_0 -> moe_21_aggregate
	moe_21_expert_1 -> moe_21_aggregate
	moe_21_expert_2 -> moe_21_aggregate
	moe_21_expert_3 -> moe_21_aggregate
	moe_21_expert_4 -> moe_21_aggregate
	moe_21_expert_5 -> moe_21_aggregate
	moe_21_expert_6 -> moe_21_aggregate
	moe_21_expert_7 -> moe_21_aggregate
	moe_21_expert_8 -> moe_21_aggregate
	moe_21_expert_9 -> moe_21_aggregate
	moe_21_expert_10 -> moe_21_aggregate
	moe_21_expert_11 -> moe_21_aggregate
	moe_21_expert_12 -> moe_21_aggregate
	moe_21_expert_13 -> moe_21_aggregate
	moe_21_expert_14 -> moe_21_aggregate
	moe_21_expert_15 -> moe_21_aggregate
	moe_21_aggregate -> moe_21_ffn
	moe_21_ffn -> moe_21_res2
	moe_21_res2 -> moe_22_mha
	moe_22_mha -> moe_22_res1
	moe_22_res1 -> moe_22_gate
	moe_22_gate -> moe_22_route
	moe_22_route -> moe_22_expert_0
	moe_22_route -> moe_22_expert_1
	moe_22_route -> moe_22_expert_2
	moe_22_route -> moe_22_expert_3
	moe_22_route -> moe_22_expert_4
	moe_22_route -> moe_22_expert_5
	moe_22_route -> moe_22_expert_6
	moe_22_route -> moe_22_expert_7
	moe_22_route -> moe_22_expert_8
	moe_22_route -> moe_22_expert_9
	moe_22_route -> moe_22_expert_10
	moe_22_route -> moe_22_expert_11
	moe_22_route -> moe_22_expert_12
	moe_22_route -> moe_22_expert_13
	moe_22_route -> moe_22_expert_14
	moe_22_route -> moe_22_expert_15
	moe_22_expert_0 -> moe_22_aggregate
	moe_22_expert_1 -> moe_22_aggregate
	moe_22_expert_2 -> moe_22_aggregate
	moe_22_expert_3 -> moe_22_aggregate
	moe_22_expert_4 -> moe_22_aggregate
	moe_22_expert_5 -> moe_22_aggregate
	moe_22_expert_6 -> moe_22_aggregate
	moe_22_expert_7 -> moe_22_aggregate
	moe_22_expert_8 -> moe_22_aggregate
	moe_22_expert_9 -> moe_22_aggregate
	moe_22_expert_10 -> moe_22_aggregate
	moe_22_expert_11 -> moe_22_aggregate
	moe_22_expert_12 -> moe_22_aggregate
	moe_22_expert_13 -> moe_22_aggregate
	moe_22_expert_14 -> moe_22_aggregate
	moe_22_expert_15 -> moe_22_aggregate
	moe_22_aggregate -> moe_22_ffn
	moe_22_ffn -> moe_22_res2
	moe_22_res2 -> moe_23_mha
	moe_23_mha -> moe_23_res1
	moe_23_res1 -> moe_23_gate
	moe_23_gate -> moe_23_route
	moe_23_route -> moe_23_expert_0
	moe_23_route -> moe_23_expert_1
	moe_23_route -> moe_23_expert_2
	moe_23_route -> moe_23_expert_3
	moe_23_route -> moe_23_expert_4
	moe_23_route -> moe_23_expert_5
	moe_23_route -> moe_23_expert_6
	moe_23_route -> moe_23_expert_7
	moe_23_route -> moe_23_expert_8
	moe_23_route -> moe_23_expert_9
	moe_23_route -> moe_23_expert_10
	moe_23_route -> moe_23_expert_11
	moe_23_route -> moe_23_expert_12
	moe_23_route -> moe_23_expert_13
	moe_23_route -> moe_23_expert_14
	moe_23_route -> moe_23_expert_15
	moe_23_expert_0 -> moe_23_aggregate
	moe_23_expert_1 -> moe_23_aggregate
	moe_23_expert_2 -> moe_23_aggregate
	moe_23_expert_3 -> moe_23_aggregate
	moe_23_expert_4 -> moe_23_aggregate
	moe_23_expert_5 -> moe_23_aggregate
	moe_23_expert_6 -> moe_23_aggregate
	moe_23_expert_7 -> moe_23_aggregate
	moe_23_expert_8 -> moe_23_aggregate
	moe_23_expert_9 -> moe_23_aggregate
	moe_23_expert_10 -> moe_23_aggregate
	moe_23_expert_11 -> moe_23_aggregate
	moe_23_expert_12 -> moe_23_aggregate
	moe_23_expert_13 -> moe_23_aggregate
	moe_23_expert_14 -> moe_23_aggregate
	moe_23_expert_15 -> moe_23_aggregate
	moe_23_aggregate -> moe_23_ffn
	moe_23_ffn -> moe_23_res2
	moe_23_res2 -> moe_24_mha
	moe_24_mha -> moe_24_res1
	moe_24_res1 -> moe_24_gate
	moe_24_gate -> moe_24_route
	moe_24_route -> moe_24_expert_0
	moe_24_route -> moe_24_expert_1
	moe_24_route -> moe_24_expert_2
	moe_24_route -> moe_24_expert_3
	moe_24_route -> moe_24_expert_4
	moe_24_route -> moe_24_expert_5
	moe_24_route -> moe_24_expert_6
	moe_24_route -> moe_24_expert_7
	moe_24_route -> moe_24_expert_8
	moe_24_route -> moe_24_expert_9
	moe_24_route -> moe_24_expert_10
	moe_24_route -> moe_24_expert_11
	moe_24_route -> moe_24_expert_12
	moe_24_route -> moe_24_expert_13
	moe_24_route -> moe_24_expert_14
	moe_24_route -> moe_24_expert_15
	moe_24_expert_0 -> moe_24_aggregate
	moe_24_expert_1 -> moe_24_aggregate
	moe_24_expert_2 -> moe_24_aggregate
	moe_24_expert_3 -> moe_24_aggregate
	moe_24_expert_4 -> moe_24_aggregate
	moe_24_expert_5 -> moe_24_aggregate
	moe_24_expert_6 -> moe_24_aggregate
	moe_24_expert_7 -> moe_24_aggregate
	moe_24_expert_8 -> moe_24_aggregate
	moe_24_expert_9 -> moe_24_aggregate
	moe_24_expert_10 -> moe_24_aggregate
	moe_24_expert_11 -> moe_24_aggregate
	moe_24_expert_12 -> moe_24_aggregate
	moe_24_expert_13 -> moe_24_aggregate
	moe_24_expert_14 -> moe_24_aggregate
	moe_24_expert_15 -> moe_24_aggregate
	moe_24_aggregate -> moe_24_ffn
	moe_24_ffn -> moe_24_res2
	moe_24_res2 -> moe_25_mha
	moe_25_mha -> moe_25_res1
	moe_25_res1 -> moe_25_gate
	moe_25_gate -> moe_25_route
	moe_25_route -> moe_25_expert_0
	moe_25_route -> moe_25_expert_1
	moe_25_route -> moe_25_expert_2
	moe_25_route -> moe_25_expert_3
	moe_25_route -> moe_25_expert_4
	moe_25_route -> moe_25_expert_5
	moe_25_route -> moe_25_expert_6
	moe_25_route -> moe_25_expert_7
	moe_25_route -> moe_25_expert_8
	moe_25_route -> moe_25_expert_9
	moe_25_route -> moe_25_expert_10
	moe_25_route -> moe_25_expert_11
	moe_25_route -> moe_25_expert_12
	moe_25_route -> moe_25_expert_13
	moe_25_route -> moe_25_expert_14
	moe_25_route -> moe_25_expert_15
	moe_25_expert_0 -> moe_25_aggregate
	moe_25_expert_1 -> moe_25_aggregate
	moe_25_expert_2 -> moe_25_aggregate
	moe_25_expert_3 -> moe_25_aggregate
	moe_25_expert_4 -> moe_25_aggregate
	moe_25_expert_5 -> moe_25_aggregate
	moe_25_expert_6 -> moe_25_aggregate
	moe_25_expert_7 -> moe_25_aggregate
	moe_25_expert_8 -> moe_25_aggregate
	moe_25_expert_9 -> moe_25_aggregate
	moe_25_expert_10 -> moe_25_aggregate
	moe_25_expert_11 -> moe_25_aggregate
	moe_25_expert_12 -> moe_25_aggregate
	moe_25_expert_13 -> moe_25_aggregate
	moe_25_expert_14 -> moe_25_aggregate
	moe_25_expert_15 -> moe_25_aggregate
	moe_25_aggregate -> moe_25_ffn
	moe_25_ffn -> moe_25_res2
	moe_25_res2 -> moe_26_mha
	moe_26_mha -> moe_26_res1
	moe_26_res1 -> moe_26_gate
	moe_26_gate -> moe_26_route
	moe_26_route -> moe_26_expert_0
	moe_26_route -> moe_26_expert_1
	moe_26_route -> moe_26_expert_2
	moe_26_route -> moe_26_expert_3
	moe_26_route -> moe_26_expert_4
	moe_26_route -> moe_26_expert_5
	moe_26_route -> moe_26_expert_6
	moe_26_route -> moe_26_expert_7
	moe_26_route -> moe_26_expert_8
	moe_26_route -> moe_26_expert_9
	moe_26_route -> moe_26_expert_10
	moe_26_route -> moe_26_expert_11
	moe_26_route -> moe_26_expert_12
	moe_26_route -> moe_26_expert_13
	moe_26_route -> moe_26_expert_14
	moe_26_route -> moe_26_expert_15
	moe_26_expert_0 -> moe_26_aggregate
	moe_26_expert_1 -> moe_26_aggregate
	moe_26_expert_2 -> moe_26_aggregate
	moe_26_expert_3 -> moe_26_aggregate
	moe_26_expert_4 -> moe_26_aggregate
	moe_26_expert_5 -> moe_26_aggregate
	moe_26_expert_6 -> moe_26_aggregate
	moe_26_expert_7 -> moe_26_aggregate
	moe_26_expert_8 -> moe_26_aggregate
	moe_26_expert_9 -> moe_26_aggregate
	moe_26_expert_10 -> moe_26_aggregate
	moe_26_expert_11 -> moe_26_aggregate
	moe_26_expert_12 -> moe_26_aggregate
	moe_26_expert_13 -> moe_26_aggregate
	moe_26_expert_14 -> moe_26_aggregate
	moe_26_expert_15 -> moe_26_aggregate
	moe_26_aggregate -> moe_26_ffn
	moe_26_ffn -> moe_26_res2
	moe_26_res2 -> moe_27_mha
	moe_27_mha -> moe_27_res1
	moe_27_res1 -> moe_27_gate
	moe_27_gate -> moe_27_route
	moe_27_route -> moe_27_expert_0
	moe_27_route -> moe_27_expert_1
	moe_27_route -> moe_27_expert_2
	moe_27_route -> moe_27_expert_3
	moe_27_route -> moe_27_expert_4
	moe_27_route -> moe_27_expert_5
	moe_27_route -> moe_27_expert_6
	moe_27_route -> moe_27_expert_7
	moe_27_route -> moe_27_expert_8
	moe_27_route -> moe_27_expert_9
	moe_27_route -> moe_27_expert_10
	moe_27_route -> moe_27_expert_11
	moe_27_route -> moe_27_expert_12
	moe_27_route -> moe_27_expert_13
	moe_27_route -> moe_27_expert_14
	moe_27_route -> moe_27_expert_15
	moe_27_expert_0 -> moe_27_aggregate
	moe_27_expert_1 -> moe_27_aggregate
	moe_27_expert_2 -> moe_27_aggregate
	moe_27_expert_3 -> moe_27_aggregate
	moe_27_expert_4 -> moe_27_aggregate
	moe_27_expert_5 -> moe_27_aggregate
	moe_27_expert_6 -> moe_27_aggregate
	moe_27_expert_7 -> moe_27_aggregate
	moe_27_expert_8 -> moe_27_aggregate
	moe_27_expert_9 -> moe_27_aggregate
	moe_27_expert_10 -> moe_27_aggregate
	moe_27_expert_11 -> moe_27_aggregate
	moe_27_expert_12 -> moe_27_aggregate
	moe_27_expert_13 -> moe_27_aggregate
	moe_27_expert_14 -> moe_27_aggregate
	moe_27_expert_15 -> moe_27_aggregate
	moe_27_aggregate -> moe_27_ffn
	moe_27_ffn -> moe_27_res2
	moe_27_res2 -> moe_28_mha
	moe_28_mha -> moe_28_res1
	moe_28_res1 -> moe_28_gate
	moe_28_gate -> moe_28_route
	moe_28_route -> moe_28_expert_0
	moe_28_route -> moe_28_expert_1
	moe_28_route -> moe_28_expert_2
	moe_28_route -> moe_28_expert_3
	moe_28_route -> moe_28_expert_4
	moe_28_route -> moe_28_expert_5
	moe_28_route -> moe_28_expert_6
	moe_28_route -> moe_28_expert_7
	moe_28_route -> moe_28_expert_8
	moe_28_route -> moe_28_expert_9
	moe_28_route -> moe_28_expert_10
	moe_28_route -> moe_28_expert_11
	moe_28_route -> moe_28_expert_12
	moe_28_route -> moe_28_expert_13
	moe_28_route -> moe_28_expert_14
	moe_28_route -> moe_28_expert_15
	moe_28_expert_0 -> moe_28_aggregate
	moe_28_expert_1 -> moe_28_aggregate
	moe_28_expert_2 -> moe_28_aggregate
	moe_28_expert_3 -> moe_28_aggregate
	moe_28_expert_4 -> moe_28_aggregate
	moe_28_expert_5 -> moe_28_aggregate
	moe_28_expert_6 -> moe_28_aggregate
	moe_28_expert_7 -> moe_28_aggregate
	moe_28_expert_8 -> moe_28_aggregate
	moe_28_expert_9 -> moe_28_aggregate
	moe_28_expert_10 -> moe_28_aggregate
	moe_28_expert_11 -> moe_28_aggregate
	moe_28_expert_12 -> moe_28_aggregate
	moe_28_expert_13 -> moe_28_aggregate
	moe_28_expert_14 -> moe_28_aggregate
	moe_28_expert_15 -> moe_28_aggregate
	moe_28_aggregate -> moe_28_ffn
	moe_28_ffn -> moe_28_res2
	moe_28_res2 -> moe_29_mha
	moe_29_mha -> moe_29_res1
	moe_29_res1 -> moe_29_gate
	moe_29_gate -> moe_29_route
	moe_29_route -> moe_29_expert_0
	moe_29_route -> moe_29_expert_1
	moe_29_route -> moe_29_expert_2
	moe_29_route -> moe_29_expert_3
	moe_29_route -> moe_29_expert_4
	moe_29_route -> moe_29_expert_5
	moe_29_route -> moe_29_expert_6
	moe_29_route -> moe_29_expert_7
	moe_29_route -> moe_29_expert_8
	moe_29_route -> moe_29_expert_9
	moe_29_route -> moe_29_expert_10
	moe_29_route -> moe_29_expert_11
	moe_29_route -> moe_29_expert_12
	moe_29_route -> moe_29_expert_13
	moe_29_route -> moe_29_expert_14
	moe_29_route -> moe_29_expert_15
	moe_29_expert_0 -> moe_29_aggregate
	moe_29_expert_1 -> moe_29_aggregate
	moe_29_expert_2 -> moe_29_aggregate
	moe_29_expert_3 -> moe_29_aggregate
	moe_29_expert_4 -> moe_29_aggregate
	moe_29_expert_5 -> moe_29_aggregate
	moe_29_expert_6 -> moe_29_aggregate
	moe_29_expert_7 -> moe_29_aggregate
	moe_29_expert_8 -> moe_29_aggregate
	moe_29_expert_9 -> moe_29_aggregate
	moe_29_expert_10 -> moe_29_aggregate
	moe_29_expert_11 -> moe_29_aggregate
	moe_29_expert_12 -> moe_29_aggregate
	moe_29_expert_13 -> moe_29_aggregate
	moe_29_expert_14 -> moe_29_aggregate
	moe_29_expert_15 -> moe_29_aggregate
	moe_29_aggregate -> moe_29_ffn
	moe_29_ffn -> moe_29_res2
	moe_29_res2 -> moe_30_mha
	moe_30_mha -> moe_30_res1
	moe_30_res1 -> moe_30_gate
	moe_30_gate -> moe_30_route
	moe_30_route -> moe_30_expert_0
	moe_30_route -> moe_30_expert_1
	moe_30_route -> moe_30_expert_2
	moe_30_route -> moe_30_expert_3
	moe_30_route -> moe_30_expert_4
	moe_30_route -> moe_30_expert_5
	moe_30_route -> moe_30_expert_6
	moe_30_route -> moe_30_expert_7
	moe_30_route -> moe_30_expert_8
	moe_30_route -> moe_30_expert_9
	moe_30_route -> moe_30_expert_10
	moe_30_route -> moe_30_expert_11
	moe_30_route -> moe_30_expert_12
	moe_30_route -> moe_30_expert_13
	moe_30_route -> moe_30_expert_14
	moe_30_route -> moe_30_expert_15
	moe_30_expert_0 -> moe_30_aggregate
	moe_30_expert_1 -> moe_30_aggregate
	moe_30_expert_2 -> moe_30_aggregate
	moe_30_expert_3 -> moe_30_aggregate
	moe_30_expert_4 -> moe_30_aggregate
	moe_30_expert_5 -> moe_30_aggregate
	moe_30_expert_6 -> moe_30_aggregate
	moe_30_expert_7 -> moe_30_aggregate
	moe_30_expert_8 -> moe_30_aggregate
	moe_30_expert_9 -> moe_30_aggregate
	moe_30_expert_10 -> moe_30_aggregate
	moe_30_expert_11 -> moe_30_aggregate
	moe_30_expert_12 -> moe_30_aggregate
	moe_30_expert_13 -> moe_30_aggregate
	moe_30_expert_14 -> moe_30_aggregate
	moe_30_expert_15 -> moe_30_aggregate
	moe_30_aggregate -> moe_30_ffn
	moe_30_ffn -> moe_30_res2
	moe_30_res2 -> moe_31_mha
	moe_31_mha -> moe_31_res1
	moe_31_res1 -> moe_31_gate
	moe_31_gate -> moe_31_route
	moe_31_route -> moe_31_expert_0
	moe_31_route -> moe_31_expert_1
	moe_31_route -> moe_31_expert_2
	moe_31_route -> moe_31_expert_3
	moe_31_route -> moe_31_expert_4
	moe_31_route -> moe_31_expert_5
	moe_31_route -> moe_31_expert_6
	moe_31_route -> moe_31_expert_7
	moe_31_route -> moe_31_expert_8
	moe_31_route -> moe_31_expert_9
	moe_31_route -> moe_31_expert_10
	moe_31_route -> moe_31_expert_11
	moe_31_route -> moe_31_expert_12
	moe_31_route -> moe_31_expert_13
	moe_31_route -> moe_31_expert_14
	moe_31_route -> moe_31_expert_15
	moe_31_expert_0 -> moe_31_aggregate
	moe_31_expert_1 -> moe_31_aggregate
	moe_31_expert_2 -> moe_31_aggregate
	moe_31_expert_3 -> moe_31_aggregate
	moe_31_expert_4 -> moe_31_aggregate
	moe_31_expert_5 -> moe_31_aggregate
	moe_31_expert_6 -> moe_31_aggregate
	moe_31_expert_7 -> moe_31_aggregate
	moe_31_expert_8 -> moe_31_aggregate
	moe_31_expert_9 -> moe_31_aggregate
	moe_31_expert_10 -> moe_31_aggregate
	moe_31_expert_11 -> moe_31_aggregate
	moe_31_expert_12 -> moe_31_aggregate
	moe_31_expert_13 -> moe_31_aggregate
	moe_31_expert_14 -> moe_31_aggregate
	moe_31_expert_15 -> moe_31_aggregate
	moe_31_aggregate -> moe_31_ffn
	moe_31_ffn -> moe_31_res2
	moe_31_res2 -> moe_32_mha
	moe_32_mha -> moe_32_res1
	moe_32_res1 -> moe_32_gate
	moe_32_gate -> moe_32_route
	moe_32_route -> moe_32_expert_0
	moe_32_route -> moe_32_expert_1
	moe_32_route -> moe_32_expert_2
	moe_32_route -> moe_32_expert_3
	moe_32_route -> moe_32_expert_4
	moe_32_route -> moe_32_expert_5
	moe_32_route -> moe_32_expert_6
	moe_32_route -> moe_32_expert_7
	moe_32_route -> moe_32_expert_8
	moe_32_route -> moe_32_expert_9
	moe_32_route -> moe_32_expert_10
	moe_32_route -> moe_32_expert_11
	moe_32_route -> moe_32_expert_12
	moe_32_route -> moe_32_expert_13
	moe_32_route -> moe_32_expert_14
	moe_32_route -> moe_32_expert_15
	moe_32_expert_0 -> moe_32_aggregate
	moe_32_expert_1 -> moe_32_aggregate
	moe_32_expert_2 -> moe_32_aggregate
	moe_32_expert_3 -> moe_32_aggregate
	moe_32_expert_4 -> moe_32_aggregate
	moe_32_expert_5 -> moe_32_aggregate
	moe_32_expert_6 -> moe_32_aggregate
	moe_32_expert_7 -> moe_32_aggregate
	moe_32_expert_8 -> moe_32_aggregate
	moe_32_expert_9 -> moe_32_aggregate
	moe_32_expert_10 -> moe_32_aggregate
	moe_32_expert_11 -> moe_32_aggregate
	moe_32_expert_12 -> moe_32_aggregate
	moe_32_expert_13 -> moe_32_aggregate
	moe_32_expert_14 -> moe_32_aggregate
	moe_32_expert_15 -> moe_32_aggregate
	moe_32_aggregate -> moe_32_ffn
	moe_32_ffn -> moe_32_res2
	moe_32_res2 -> moe_33_mha
	moe_33_mha -> moe_33_res1
	moe_33_res1 -> moe_33_gate
	moe_33_gate -> moe_33_route
	moe_33_route -> moe_33_expert_0
	moe_33_route -> moe_33_expert_1
	moe_33_route -> moe_33_expert_2
	moe_33_route -> moe_33_expert_3
	moe_33_route -> moe_33_expert_4
	moe_33_route -> moe_33_expert_5
	moe_33_route -> moe_33_expert_6
	moe_33_route -> moe_33_expert_7
	moe_33_route -> moe_33_expert_8
	moe_33_route -> moe_33_expert_9
	moe_33_route -> moe_33_expert_10
	moe_33_route -> moe_33_expert_11
	moe_33_route -> moe_33_expert_12
	moe_33_route -> moe_33_expert_13
	moe_33_route -> moe_33_expert_14
	moe_33_route -> moe_33_expert_15
	moe_33_expert_0 -> moe_33_aggregate
	moe_33_expert_1 -> moe_33_aggregate
	moe_33_expert_2 -> moe_33_aggregate
	moe_33_expert_3 -> moe_33_aggregate
	moe_33_expert_4 -> moe_33_aggregate
	moe_33_expert_5 -> moe_33_aggregate
	moe_33_expert_6 -> moe_33_aggregate
	moe_33_expert_7 -> moe_33_aggregate
	moe_33_expert_8 -> moe_33_aggregate
	moe_33_expert_9 -> moe_33_aggregate
	moe_33_expert_10 -> moe_33_aggregate
	moe_33_expert_11 -> moe_33_aggregate
	moe_33_expert_12 -> moe_33_aggregate
	moe_33_expert_13 -> moe_33_aggregate
	moe_33_expert_14 -> moe_33_aggregate
	moe_33_expert_15 -> moe_33_aggregate
	moe_33_aggregate -> moe_33_ffn
	moe_33_ffn -> moe_33_res2
	moe_33_res2 -> moe_34_mha
	moe_34_mha -> moe_34_res1
	moe_34_res1 -> moe_34_gate
	moe_34_gate -> moe_34_route
	moe_34_route -> moe_34_expert_0
	moe_34_route -> moe_34_expert_1
	moe_34_route -> moe_34_expert_2
	moe_34_route -> moe_34_expert_3
	moe_34_route -> moe_34_expert_4
	moe_34_route -> moe_34_expert_5
	moe_34_route -> moe_34_expert_6
	moe_34_route -> moe_34_expert_7
	moe_34_route -> moe_34_expert_8
	moe_34_route -> moe_34_expert_9
	moe_34_route -> moe_34_expert_10
	moe_34_route -> moe_34_expert_11
	moe_34_route -> moe_34_expert_12
	moe_34_route -> moe_34_expert_13
	moe_34_route -> moe_34_expert_14
	moe_34_route -> moe_34_expert_15
	moe_34_expert_0 -> moe_34_aggregate
	moe_34_expert_1 -> moe_34_aggregate
	moe_34_expert_2 -> moe_34_aggregate
	moe_34_expert_3 -> moe_34_aggregate
	moe_34_expert_4 -> moe_34_aggregate
	moe_34_expert_5 -> moe_34_aggregate
	moe_34_expert_6 -> moe_34_aggregate
	moe_34_expert_7 -> moe_34_aggregate
	moe_34_expert_8 -> moe_34_aggregate
	moe_34_expert_9 -> moe_34_aggregate
	moe_34_expert_10 -> moe_34_aggregate
	moe_34_expert_11 -> moe_34_aggregate
	moe_34_expert_12 -> moe_34_aggregate
	moe_34_expert_13 -> moe_34_aggregate
	moe_34_expert_14 -> moe_34_aggregate
	moe_34_expert_15 -> moe_34_aggregate
	moe_34_aggregate -> moe_34_ffn
	moe_34_ffn -> moe_34_res2
	moe_34_res2 -> moe_35_mha
	moe_35_mha -> moe_35_res1
	moe_35_res1 -> moe_35_gate
	moe_35_gate -> moe_35_route
	moe_35_route -> moe_35_expert_0
	moe_35_route -> moe_35_expert_1
	moe_35_route -> moe_35_expert_2
	moe_35_route -> moe_35_expert_3
	moe_35_route -> moe_35_expert_4
	moe_35_route -> moe_35_expert_5
	moe_35_route -> moe_35_expert_6
	moe_35_route -> moe_35_expert_7
	moe_35_route -> moe_35_expert_8
	moe_35_route -> moe_35_expert_9
	moe_35_route -> moe_35_expert_10
	moe_35_route -> moe_35_expert_11
	moe_35_route -> moe_35_expert_12
	moe_35_route -> moe_35_expert_13
	moe_35_route -> moe_35_expert_14
	moe_35_route -> moe_35_expert_15
	moe_35_expert_0 -> moe_35_aggregate
	moe_35_expert_1 -> moe_35_aggregate
	moe_35_expert_2 -> moe_35_aggregate
	moe_35_expert_3 -> moe_35_aggregate
	moe_35_expert_4 -> moe_35_aggregate
	moe_35_expert_5 -> moe_35_aggregate
	moe_35_expert_6 -> moe_35_aggregate
	moe_35_expert_7 -> moe_35_aggregate
	moe_35_expert_8 -> moe_35_aggregate
	moe_35_expert_9 -> moe_35_aggregate
	moe_35_expert_10 -> moe_35_aggregate
	moe_35_expert_11 -> moe_35_aggregate
	moe_35_expert_12 -> moe_35_aggregate
	moe_35_expert_13 -> moe_35_aggregate
	moe_35_expert_14 -> moe_35_aggregate
	moe_35_expert_15 -> moe_35_aggregate
	moe_35_aggregate -> moe_35_ffn
	moe_35_ffn -> moe_35_res2
	moe_35_res2 -> moe_36_mha
	moe_36_mha -> moe_36_res1
	moe_36_res1 -> moe_36_gate
	moe_36_gate -> moe_36_route
	moe_36_route -> moe_36_expert_0
	moe_36_route -> moe_36_expert_1
	moe_36_route -> moe_36_expert_2
	moe_36_route -> moe_36_expert_3
	moe_36_route -> moe_36_expert_4
	moe_36_route -> moe_36_expert_5
	moe_36_route -> moe_36_expert_6
	moe_36_route -> moe_36_expert_7
	moe_36_route -> moe_36_expert_8
	moe_36_route -> moe_36_expert_9
	moe_36_route -> moe_36_expert_10
	moe_36_route -> moe_36_expert_11
	moe_36_route -> moe_36_expert_12
	moe_36_route -> moe_36_expert_13
	moe_36_route -> moe_36_expert_14
	moe_36_route -> moe_36_expert_15
	moe_36_expert_0 -> moe_36_aggregate
	moe_36_expert_1 -> moe_36_aggregate
	moe_36_expert_2 -> moe_36_aggregate
	moe_36_expert_3 -> moe_36_aggregate
	moe_36_expert_4 -> moe_36_aggregate
	moe_36_expert_5 -> moe_36_aggregate
	moe_36_expert_6 -> moe_36_aggregate
	moe_36_expert_7 -> moe_36_aggregate
	moe_36_expert_8 -> moe_36_aggregate
	moe_36_expert_9 -> moe_36_aggregate
	moe_36_expert_10 -> moe_36_aggregate
	moe_36_expert_11 -> moe_36_aggregate
	moe_36_expert_12 -> moe_36_aggregate
	moe_36_expert_13 -> moe_36_aggregate
	moe_36_expert_14 -> moe_36_aggregate
	moe_36_expert_15 -> moe_36_aggregate
	moe_36_aggregate -> moe_36_ffn
	moe_36_ffn -> moe_36_res2
	moe_36_res2 -> moe_37_mha
	moe_37_mha -> moe_37_res1
	moe_37_res1 -> moe_37_gate
	moe_37_gate -> moe_37_route
	moe_37_route -> moe_37_expert_0
	moe_37_route -> moe_37_expert_1
	moe_37_route -> moe_37_expert_2
	moe_37_route -> moe_37_expert_3
	moe_37_route -> moe_37_expert_4
	moe_37_route -> moe_37_expert_5
	moe_37_route -> moe_37_expert_6
	moe_37_route -> moe_37_expert_7
	moe_37_route -> moe_37_expert_8
	moe_37_route -> moe_37_expert_9
	moe_37_route -> moe_37_expert_10
	moe_37_route -> moe_37_expert_11
	moe_37_route -> moe_37_expert_12
	moe_37_route -> moe_37_expert_13
	moe_37_route -> moe_37_expert_14
	moe_37_route -> moe_37_expert_15
	moe_37_expert_0 -> moe_37_aggregate
	moe_37_expert_1 -> moe_37_aggregate
	moe_37_expert_2 -> moe_37_aggregate
	moe_37_expert_3 -> moe_37_aggregate
	moe_37_expert_4 -> moe_37_aggregate
	moe_37_expert_5 -> moe_37_aggregate
	moe_37_expert_6 -> moe_37_aggregate
	moe_37_expert_7 -> moe_37_aggregate
	moe_37_expert_8 -> moe_37_aggregate
	moe_37_expert_9 -> moe_37_aggregate
	moe_37_expert_10 -> moe_37_aggregate
	moe_37_expert_11 -> moe_37_aggregate
	moe_37_expert_12 -> moe_37_aggregate
	moe_37_expert_13 -> moe_37_aggregate
	moe_37_expert_14 -> moe_37_aggregate
	moe_37_expert_15 -> moe_37_aggregate
	moe_37_aggregate -> moe_37_ffn
	moe_37_ffn -> moe_37_res2
	moe_37_res2 -> moe_38_mha
	moe_38_mha -> moe_38_res1
	moe_38_res1 -> moe_38_gate
	moe_38_gate -> moe_38_route
	moe_38_route -> moe_38_expert_0
	moe_38_route -> moe_38_expert_1
	moe_38_route -> moe_38_expert_2
	moe_38_route -> moe_38_expert_3
	moe_38_route -> moe_38_expert_4
	moe_38_route -> moe_38_expert_5
	moe_38_route -> moe_38_expert_6
	moe_38_route -> moe_38_expert_7
	moe_38_route -> moe_38_expert_8
	moe_38_route -> moe_38_expert_9
	moe_38_route -> moe_38_expert_10
	moe_38_route -> moe_38_expert_11
	moe_38_route -> moe_38_expert_12
	moe_38_route -> moe_38_expert_13
	moe_38_route -> moe_38_expert_14
	moe_38_route -> moe_38_expert_15
	moe_38_expert_0 -> moe_38_aggregate
	moe_38_expert_1 -> moe_38_aggregate
	moe_38_expert_2 -> moe_38_aggregate
	moe_38_expert_3 -> moe_38_aggregate
	moe_38_expert_4 -> moe_38_aggregate
	moe_38_expert_5 -> moe_38_aggregate
	moe_38_expert_6 -> moe_38_aggregate
	moe_38_expert_7 -> moe_38_aggregate
	moe_38_expert_8 -> moe_38_aggregate
	moe_38_expert_9 -> moe_38_aggregate
	moe_38_expert_10 -> moe_38_aggregate
	moe_38_expert_11 -> moe_38_aggregate
	moe_38_expert_12 -> moe_38_aggregate
	moe_38_expert_13 -> moe_38_aggregate
	moe_38_expert_14 -> moe_38_aggregate
	moe_38_expert_15 -> moe_38_aggregate
	moe_38_aggregate -> moe_38_ffn
	moe_38_ffn -> moe_38_res2
	moe_38_res2 -> moe_39_mha
	moe_39_mha -> moe_39_res1
	moe_39_res1 -> moe_39_gate
	moe_39_gate -> moe_39_route
	moe_39_route -> moe_39_expert_0
	moe_39_route -> moe_39_expert_1
	moe_39_route -> moe_39_expert_2
	moe_39_route -> moe_39_expert_3
	moe_39_route -> moe_39_expert_4
	moe_39_route -> moe_39_expert_5
	moe_39_route -> moe_39_expert_6
	moe_39_route -> moe_39_expert_7
	moe_39_route -> moe_39_expert_8
	moe_39_route -> moe_39_expert_9
	moe_39_route -> moe_39_expert_10
	moe_39_route -> moe_39_expert_11
	moe_39_route -> moe_39_expert_12
	moe_39_route -> moe_39_expert_13
	moe_39_route -> moe_39_expert_14
	moe_39_route -> moe_39_expert_15
	moe_39_expert_0 -> moe_39_aggregate
	moe_39_expert_1 -> moe_39_aggregate
	moe_39_expert_2 -> moe_39_aggregate
	moe_39_expert_3 -> moe_39_aggregate
	moe_39_expert_4 -> moe_39_aggregate
	moe_39_expert_5 -> moe_39_aggregate
	moe_39_expert_6 -> moe_39_aggregate
	moe_39_expert_7 -> moe_39_aggregate
	moe_39_expert_8 -> moe_39_aggregate
	moe_39_expert_9 -> moe_39_aggregate
	moe_39_expert_10 -> moe_39_aggregate
	moe_39_expert_11 -> moe_39_aggregate
	moe_39_expert_12 -> moe_39_aggregate
	moe_39_expert_13 -> moe_39_aggregate
	moe_39_expert_14 -> moe_39_aggregate
	moe_39_expert_15 -> moe_39_aggregate
	moe_39_aggregate -> moe_39_ffn
	moe_39_ffn -> moe_39_res2
	moe_39_res2 -> moe_40_mha
	moe_40_mha -> moe_40_res1
	moe_40_res1 -> moe_40_gate
	moe_40_gate -> moe_40_route
	moe_40_route -> moe_40_expert_0
	moe_40_route -> moe_40_expert_1
	moe_40_route -> moe_40_expert_2
	moe_40_route -> moe_40_expert_3
	moe_40_route -> moe_40_expert_4
	moe_40_route -> moe_40_expert_5
	moe_40_route -> moe_40_expert_6
	moe_40_route -> moe_40_expert_7
	moe_40_route -> moe_40_expert_8
	moe_40_route -> moe_40_expert_9
	moe_40_route -> moe_40_expert_10
	moe_40_route -> moe_40_expert_11
	moe_40_route -> moe_40_expert_12
	moe_40_route -> moe_40_expert_13
	moe_40_route -> moe_40_expert_14
	moe_40_route -> moe_40_expert_15
	moe_40_expert_0 -> moe_40_aggregate
	moe_40_expert_1 -> moe_40_aggregate
	moe_40_expert_2 -> moe_40_aggregate
	moe_40_expert_3 -> moe_40_aggregate
	moe_40_expert_4 -> moe_40_aggregate
	moe_40_expert_5 -> moe_40_aggregate
	moe_40_expert_6 -> moe_40_aggregate
	moe_40_expert_7 -> moe_40_aggregate
	moe_40_expert_8 -> moe_40_aggregate
	moe_40_expert_9 -> moe_40_aggregate
	moe_40_expert_10 -> moe_40_aggregate
	moe_40_expert_11 -> moe_40_aggregate
	moe_40_expert_12 -> moe_40_aggregate
	moe_40_expert_13 -> moe_40_aggregate
	moe_40_expert_14 -> moe_40_aggregate
	moe_40_expert_15 -> moe_40_aggregate
	moe_40_aggregate -> moe_40_ffn
	moe_40_ffn -> moe_40_res2
	moe_40_res2 -> moe_41_mha
	moe_41_mha -> moe_41_res1
	moe_41_res1 -> moe_41_gate
	moe_41_gate -> moe_41_route
	moe_41_route -> moe_41_expert_0
	moe_41_route -> moe_41_expert_1
	moe_41_route -> moe_41_expert_2
	moe_41_route -> moe_41_expert_3
	moe_41_route -> moe_41_expert_4
	moe_41_route -> moe_41_expert_5
	moe_41_route -> moe_41_expert_6
	moe_41_route -> moe_41_expert_7
	moe_41_route -> moe_41_expert_8
	moe_41_route -> moe_41_expert_9
	moe_41_route -> moe_41_expert_10
	moe_41_route -> moe_41_expert_11
	moe_41_route -> moe_41_expert_12
	moe_41_route -> moe_41_expert_13
	moe_41_route -> moe_41_expert_14
	moe_41_route -> moe_41_expert_15
	moe_41_expert_0 -> moe_41_aggregate
	moe_41_expert_1 -> moe_41_aggregate
	moe_41_expert_2 -> moe_41_aggregate
	moe_41_expert_3 -> moe_41_aggregate
	moe_41_expert_4 -> moe_41_aggregate
	moe_41_expert_5 -> moe_41_aggregate
	moe_41_expert_6 -> moe_41_aggregate
	moe_41_expert_7 -> moe_41_aggregate
	moe_41_expert_8 -> moe_41_aggregate
	moe_41_expert_9 -> moe_41_aggregate
	moe_41_expert_10 -> moe_41_aggregate
	moe_41_expert_11 -> moe_41_aggregate
	moe_41_expert_12 -> moe_41_aggregate
	moe_41_expert_13 -> moe_41_aggregate
	moe_41_expert_14 -> moe_41_aggregate
	moe_41_expert_15 -> moe_41_aggregate
	moe_41_aggregate -> moe_41_ffn
	moe_41_ffn -> moe_41_res2
	moe_41_res2 -> moe_42_mha
	moe_42_mha -> moe_42_res1
	moe_42_res1 -> moe_42_gate
	moe_42_gate -> moe_42_route
	moe_42_route -> moe_42_expert_0
	moe_42_route -> moe_42_expert_1
	moe_42_route -> moe_42_expert_2
	moe_42_route -> moe_42_expert_3
	moe_42_route -> moe_42_expert_4
	moe_42_route -> moe_42_expert_5
	moe_42_route -> moe_42_expert_6
	moe_42_route -> moe_42_expert_7
	moe_42_route -> moe_42_expert_8
	moe_42_route -> moe_42_expert_9
	moe_42_route -> moe_42_expert_10
	moe_42_route -> moe_42_expert_11
	moe_42_route -> moe_42_expert_12
	moe_42_route -> moe_42_expert_13
	moe_42_route -> moe_42_expert_14
	moe_42_route -> moe_42_expert_15
	moe_42_expert_0 -> moe_42_aggregate
	moe_42_expert_1 -> moe_42_aggregate
	moe_42_expert_2 -> moe_42_aggregate
	moe_42_expert_3 -> moe_42_aggregate
	moe_42_expert_4 -> moe_42_aggregate
	moe_42_expert_5 -> moe_42_aggregate
	moe_42_expert_6 -> moe_42_aggregate
	moe_42_expert_7 -> moe_42_aggregate
	moe_42_expert_8 -> moe_42_aggregate
	moe_42_expert_9 -> moe_42_aggregate
	moe_42_expert_10 -> moe_42_aggregate
	moe_42_expert_11 -> moe_42_aggregate
	moe_42_expert_12 -> moe_42_aggregate
	moe_42_expert_13 -> moe_42_aggregate
	moe_42_expert_14 -> moe_42_aggregate
	moe_42_expert_15 -> moe_42_aggregate
	moe_42_aggregate -> moe_42_ffn
	moe_42_ffn -> moe_42_res2
	moe_42_res2 -> moe_43_mha
	moe_43_mha -> moe_43_res1
	moe_43_res1 -> moe_43_gate
	moe_43_gate -> moe_43_route
	moe_43_route -> moe_43_expert_0
	moe_43_route -> moe_43_expert_1
	moe_43_route -> moe_43_expert_2
	moe_43_route -> moe_43_expert_3
	moe_43_route -> moe_43_expert_4
	moe_43_route -> moe_43_expert_5
	moe_43_route -> moe_43_expert_6
	moe_43_route -> moe_43_expert_7
	moe_43_route -> moe_43_expert_8
	moe_43_route -> moe_43_expert_9
	moe_43_route -> moe_43_expert_10
	moe_43_route -> moe_43_expert_11
	moe_43_route -> moe_43_expert_12
	moe_43_route -> moe_43_expert_13
	moe_43_route -> moe_43_expert_14
	moe_43_route -> moe_43_expert_15
	moe_43_expert_0 -> moe_43_aggregate
	moe_43_expert_1 -> moe_43_aggregate
	moe_43_expert_2 -> moe_43_aggregate
	moe_43_expert_3 -> moe_43_aggregate
	moe_43_expert_4 -> moe_43_aggregate
	moe_43_expert_5 -> moe_43_aggregate
	moe_43_expert_6 -> moe_43_aggregate
	moe_43_expert_7 -> moe_43_aggregate
	moe_43_expert_8 -> moe_43_aggregate
	moe_43_expert_9 -> moe_43_aggregate
	moe_43_expert_10 -> moe_43_aggregate
	moe_43_expert_11 -> moe_43_aggregate
	moe_43_expert_12 -> moe_43_aggregate
	moe_43_expert_13 -> moe_43_aggregate
	moe_43_expert_14 -> moe_43_aggregate
	moe_43_expert_15 -> moe_43_aggregate
	moe_43_aggregate -> moe_43_ffn
	moe_43_ffn -> moe_43_res2
	moe_43_res2 -> moe_44_mha
	moe_44_mha -> moe_44_res1
	moe_44_res1 -> moe_44_gate
	moe_44_gate -> moe_44_route
	moe_44_route -> moe_44_expert_0
	moe_44_route -> moe_44_expert_1
	moe_44_route -> moe_44_expert_2
	moe_44_route -> moe_44_expert_3
	moe_44_route -> moe_44_expert_4
	moe_44_route -> moe_44_expert_5
	moe_44_route -> moe_44_expert_6
	moe_44_route -> moe_44_expert_7
	moe_44_route -> moe_44_expert_8
	moe_44_route -> moe_44_expert_9
	moe_44_route -> moe_44_expert_10
	moe_44_route -> moe_44_expert_11
	moe_44_route -> moe_44_expert_12
	moe_44_route -> moe_44_expert_13
	moe_44_route -> moe_44_expert_14
	moe_44_route -> moe_44_expert_15
	moe_44_expert_0 -> moe_44_aggregate
	moe_44_expert_1 -> moe_44_aggregate
	moe_44_expert_2 -> moe_44_aggregate
	moe_44_expert_3 -> moe_44_aggregate
	moe_44_expert_4 -> moe_44_aggregate
	moe_44_expert_5 -> moe_44_aggregate
	moe_44_expert_6 -> moe_44_aggregate
	moe_44_expert_7 -> moe_44_aggregate
	moe_44_expert_8 -> moe_44_aggregate
	moe_44_expert_9 -> moe_44_aggregate
	moe_44_expert_10 -> moe_44_aggregate
	moe_44_expert_11 -> moe_44_aggregate
	moe_44_expert_12 -> moe_44_aggregate
	moe_44_expert_13 -> moe_44_aggregate
	moe_44_expert_14 -> moe_44_aggregate
	moe_44_expert_15 -> moe_44_aggregate
	moe_44_aggregate -> moe_44_ffn
	moe_44_ffn -> moe_44_res2
	moe_44_res2 -> moe_45_mha
	moe_45_mha -> moe_45_res1
	moe_45_res1 -> moe_45_gate
	moe_45_gate -> moe_45_route
	moe_45_route -> moe_45_expert_0
	moe_45_route -> moe_45_expert_1
	moe_45_route -> moe_45_expert_2
	moe_45_route -> moe_45_expert_3
	moe_45_route -> moe_45_expert_4
	moe_45_route -> moe_45_expert_5
	moe_45_route -> moe_45_expert_6
	moe_45_route -> moe_45_expert_7
	moe_45_route -> moe_45_expert_8
	moe_45_route -> moe_45_expert_9
	moe_45_route -> moe_45_expert_10
	moe_45_route -> moe_45_expert_11
	moe_45_route -> moe_45_expert_12
	moe_45_route -> moe_45_expert_13
	moe_45_route -> moe_45_expert_14
	moe_45_route -> moe_45_expert_15
	moe_45_expert_0 -> moe_45_aggregate
	moe_45_expert_1 -> moe_45_aggregate
	moe_45_expert_2 -> moe_45_aggregate
	moe_45_expert_3 -> moe_45_aggregate
	moe_45_expert_4 -> moe_45_aggregate
	moe_45_expert_5 -> moe_45_aggregate
	moe_45_expert_6 -> moe_45_aggregate
	moe_45_expert_7 -> moe_45_aggregate
	moe_45_expert_8 -> moe_45_aggregate
	moe_45_expert_9 -> moe_45_aggregate
	moe_45_expert_10 -> moe_45_aggregate
	moe_45_expert_11 -> moe_45_aggregate
	moe_45_expert_12 -> moe_45_aggregate
	moe_45_expert_13 -> moe_45_aggregate
	moe_45_expert_14 -> moe_45_aggregate
	moe_45_expert_15 -> moe_45_aggregate
	moe_45_aggregate -> moe_45_ffn
	moe_45_ffn -> moe_45_res2
	moe_45_res2 -> moe_46_mha
	moe_46_mha -> moe_46_res1
	moe_46_res1 -> moe_46_gate
	moe_46_gate -> moe_46_route
	moe_46_route -> moe_46_expert_0
	moe_46_route -> moe_46_expert_1
	moe_46_route -> moe_46_expert_2
	moe_46_route -> moe_46_expert_3
	moe_46_route -> moe_46_expert_4
	moe_46_route -> moe_46_expert_5
	moe_46_route -> moe_46_expert_6
	moe_46_route -> moe_46_expert_7
	moe_46_route -> moe_46_expert_8
	moe_46_route -> moe_46_expert_9
	moe_46_route -> moe_46_expert_10
	moe_46_route -> moe_46_expert_11
	moe_46_route -> moe_46_expert_12
	moe_46_route -> moe_46_expert_13
	moe_46_route -> moe_46_expert_14
	moe_46_route -> moe_46_expert_15
	moe_46_expert_0 -> moe_46_aggregate
	moe_46_expert_1 -> moe_46_aggregate
	moe_46_expert_2 -> moe_46_aggregate
	moe_46_expert_3 -> moe_46_aggregate
	moe_46_expert_4 -> moe_46_aggregate
	moe_46_expert_5 -> moe_46_aggregate
	moe_46_expert_6 -> moe_46_aggregate
	moe_46_expert_7 -> moe_46_aggregate
	moe_46_expert_8 -> moe_46_aggregate
	moe_46_expert_9 -> moe_46_aggregate
	moe_46_expert_10 -> moe_46_aggregate
	moe_46_expert_11 -> moe_46_aggregate
	moe_46_expert_12 -> moe_46_aggregate
	moe_46_expert_13 -> moe_46_aggregate
	moe_46_expert_14 -> moe_46_aggregate
	moe_46_expert_15 -> moe_46_aggregate
	moe_46_aggregate -> moe_46_ffn
	moe_46_ffn -> moe_46_res2
	moe_46_res2 -> moe_47_mha
	moe_47_mha -> moe_47_res1
	moe_47_res1 -> moe_47_gate
	moe_47_gate -> moe_47_route
	moe_47_route -> moe_47_expert_0
	moe_47_route -> moe_47_expert_1
	moe_47_route -> moe_47_expert_2
	moe_47_route -> moe_47_expert_3
	moe_47_route -> moe_47_expert_4
	moe_47_route -> moe_47_expert_5
	moe_47_route -> moe_47_expert_6
	moe_47_route -> moe_47_expert_7
	moe_47_route -> moe_47_expert_8
	moe_47_route -> moe_47_expert_9
	moe_47_route -> moe_47_expert_10
	moe_47_route -> moe_47_expert_11
	moe_47_route -> moe_47_expert_12
	moe_47_route -> moe_47_expert_13
	moe_47_route -> moe_47_expert_14
	moe_47_route -> moe_47_expert_15
	moe_47_expert_0 -> moe_47_aggregate
	moe_47_expert_1 -> moe_47_aggregate
	moe_47_expert_2 -> moe_47_aggregate
	moe_47_expert_3 -> moe_47_aggregate
	moe_47_expert_4 -> moe_47_aggregate
	moe_47_expert_5 -> moe_47_aggregate
	moe_47_expert_6 -> moe_47_aggregate
	moe_47_expert_7 -> moe_47_aggregate
	moe_47_expert_8 -> moe_47_aggregate
	moe_47_expert_9 -> moe_47_aggregate
	moe_47_expert_10 -> moe_47_aggregate
	moe_47_expert_11 -> moe_47_aggregate
	moe_47_expert_12 -> moe_47_aggregate
	moe_47_expert_13 -> moe_47_aggregate
	moe_47_expert_14 -> moe_47_aggregate
	moe_47_expert_15 -> moe_47_aggregate
	moe_47_aggregate -> moe_47_ffn
	moe_47_ffn -> moe_47_res2
	moe_47_res2 -> moe_48_mha
	moe_48_mha -> moe_48_res1
	moe_48_res1 -> moe_48_gate
	moe_48_gate -> moe_48_route
	moe_48_route -> moe_48_expert_0
	moe_48_route -> moe_48_expert_1
	moe_48_route -> moe_48_expert_2
	moe_48_route -> moe_48_expert_3
	moe_48_route -> moe_48_expert_4
	moe_48_route -> moe_48_expert_5
	moe_48_route -> moe_48_expert_6
	moe_48_route -> moe_48_expert_7
	moe_48_route -> moe_48_expert_8
	moe_48_route -> moe_48_expert_9
	moe_48_route -> moe_48_expert_10
	moe_48_route -> moe_48_expert_11
	moe_48_route -> moe_48_expert_12
	moe_48_route -> moe_48_expert_13
	moe_48_route -> moe_48_expert_14
	moe_48_route -> moe_48_expert_15
	moe_48_expert_0 -> moe_48_aggregate
	moe_48_expert_1 -> moe_48_aggregate
	moe_48_expert_2 -> moe_48_aggregate
	moe_48_expert_3 -> moe_48_aggregate
	moe_48_expert_4 -> moe_48_aggregate
	moe_48_expert_5 -> moe_48_aggregate
	moe_48_expert_6 -> moe_48_aggregate
	moe_48_expert_7 -> moe_48_aggregate
	moe_48_expert_8 -> moe_48_aggregate
	moe_48_expert_9 -> moe_48_aggregate
	moe_48_expert_10 -> moe_48_aggregate
	moe_48_expert_11 -> moe_48_aggregate
	moe_48_expert_12 -> moe_48_aggregate
	moe_48_expert_13 -> moe_48_aggregate
	moe_48_expert_14 -> moe_48_aggregate
	moe_48_expert_15 -> moe_48_aggregate
	moe_48_aggregate -> moe_48_ffn
	moe_48_ffn -> moe_48_res2
	moe_48_res2 -> moe_49_mha
	moe_49_mha -> moe_49_res1
	moe_49_res1 -> moe_49_gate
	moe_49_gate -> moe_49_route
	moe_49_route -> moe_49_expert_0
	moe_49_route -> moe_49_expert_1
	moe_49_route -> moe_49_expert_2
	moe_49_route -> moe_49_expert_3
	moe_49_route -> moe_49_expert_4
	moe_49_route -> moe_49_expert_5
	moe_49_route -> moe_49_expert_6
	moe_49_route -> moe_49_expert_7
	moe_49_route -> moe_49_expert_8
	moe_49_route -> moe_49_expert_9
	moe_49_route -> moe_49_expert_10
	moe_49_route -> moe_49_expert_11
	moe_49_route -> moe_49_expert_12
	moe_49_route -> moe_49_expert_13
	moe_49_route -> moe_49_expert_14
	moe_49_route -> moe_49_expert_15
	moe_49_expert_0 -> moe_49_aggregate
	moe_49_expert_1 -> moe_49_aggregate
	moe_49_expert_2 -> moe_49_aggregate
	moe_49_expert_3 -> moe_49_aggregate
	moe_49_expert_4 -> moe_49_aggregate
	moe_49_expert_5 -> moe_49_aggregate
	moe_49_expert_6 -> moe_49_aggregate
	moe_49_expert_7 -> moe_49_aggregate
	moe_49_expert_8 -> moe_49_aggregate
	moe_49_expert_9 -> moe_49_aggregate
	moe_49_expert_10 -> moe_49_aggregate
	moe_49_expert_11 -> moe_49_aggregate
	moe_49_expert_12 -> moe_49_aggregate
	moe_49_expert_13 -> moe_49_aggregate
	moe_49_expert_14 -> moe_49_aggregate
	moe_49_expert_15 -> moe_49_aggregate
	moe_49_aggregate -> moe_49_ffn
	moe_49_ffn -> moe_49_res2
	moe_49_res2 -> moe_50_mha
	moe_50_mha -> moe_50_res1
	moe_50_res1 -> moe_50_gate
	moe_50_gate -> moe_50_route
	moe_50_route -> moe_50_expert_0
	moe_50_route -> moe_50_expert_1
	moe_50_route -> moe_50_expert_2
	moe_50_route -> moe_50_expert_3
	moe_50_route -> moe_50_expert_4
	moe_50_route -> moe_50_expert_5
	moe_50_route -> moe_50_expert_6
	moe_50_route -> moe_50_expert_7
	moe_50_route -> moe_50_expert_8
	moe_50_route -> moe_50_expert_9
	moe_50_route -> moe_50_expert_10
	moe_50_route -> moe_50_expert_11
	moe_50_route -> moe_50_expert_12
	moe_50_route -> moe_50_expert_13
	moe_50_route -> moe_50_expert_14
	moe_50_route -> moe_50_expert_15
	moe_50_expert_0 -> moe_50_aggregate
	moe_50_expert_1 -> moe_50_aggregate
	moe_50_expert_2 -> moe_50_aggregate
	moe_50_expert_3 -> moe_50_aggregate
	moe_50_expert_4 -> moe_50_aggregate
	moe_50_expert_5 -> moe_50_aggregate
	moe_50_expert_6 -> moe_50_aggregate
	moe_50_expert_7 -> moe_50_aggregate
	moe_50_expert_8 -> moe_50_aggregate
	moe_50_expert_9 -> moe_50_aggregate
	moe_50_expert_10 -> moe_50_aggregate
	moe_50_expert_11 -> moe_50_aggregate
	moe_50_expert_12 -> moe_50_aggregate
	moe_50_expert_13 -> moe_50_aggregate
	moe_50_expert_14 -> moe_50_aggregate
	moe_50_expert_15 -> moe_50_aggregate
	moe_50_aggregate -> moe_50_ffn
	moe_50_ffn -> moe_50_res2
	moe_50_res2 -> moe_51_mha
	moe_51_mha -> moe_51_res1
	moe_51_res1 -> moe_51_gate
	moe_51_gate -> moe_51_route
	moe_51_route -> moe_51_expert_0
	moe_51_route -> moe_51_expert_1
	moe_51_route -> moe_51_expert_2
	moe_51_route -> moe_51_expert_3
	moe_51_route -> moe_51_expert_4
	moe_51_route -> moe_51_expert_5
	moe_51_route -> moe_51_expert_6
	moe_51_route -> moe_51_expert_7
	moe_51_route -> moe_51_expert_8
	moe_51_route -> moe_51_expert_9
	moe_51_route -> moe_51_expert_10
	moe_51_route -> moe_51_expert_11
	moe_51_route -> moe_51_expert_12
	moe_51_route -> moe_51_expert_13
	moe_51_route -> moe_51_expert_14
	moe_51_route -> moe_51_expert_15
	moe_51_expert_0 -> moe_51_aggregate
	moe_51_expert_1 -> moe_51_aggregate
	moe_51_expert_2 -> moe_51_aggregate
	moe_51_expert_3 -> moe_51_aggregate
	moe_51_expert_4 -> moe_51_aggregate
	moe_51_expert_5 -> moe_51_aggregate
	moe_51_expert_6 -> moe_51_aggregate
	moe_51_expert_7 -> moe_51_aggregate
	moe_51_expert_8 -> moe_51_aggregate
	moe_51_expert_9 -> moe_51_aggregate
	moe_51_expert_10 -> moe_51_aggregate
	moe_51_expert_11 -> moe_51_aggregate
	moe_51_expert_12 -> moe_51_aggregate
	moe_51_expert_13 -> moe_51_aggregate
	moe_51_expert_14 -> moe_51_aggregate
	moe_51_expert_15 -> moe_51_aggregate
	moe_51_aggregate -> moe_51_ffn
	moe_51_ffn -> moe_51_res2
	moe_51_res2 -> moe_52_mha
	moe_52_mha -> moe_52_res1
	moe_52_res1 -> moe_52_gate
	moe_52_gate -> moe_52_route
	moe_52_route -> moe_52_expert_0
	moe_52_route -> moe_52_expert_1
	moe_52_route -> moe_52_expert_2
	moe_52_route -> moe_52_expert_3
	moe_52_route -> moe_52_expert_4
	moe_52_route -> moe_52_expert_5
	moe_52_route -> moe_52_expert_6
	moe_52_route -> moe_52_expert_7
	moe_52_route -> moe_52_expert_8
	moe_52_route -> moe_52_expert_9
	moe_52_route -> moe_52_expert_10
	moe_52_route -> moe_52_expert_11
	moe_52_route -> moe_52_expert_12
	moe_52_route -> moe_52_expert_13
	moe_52_route -> moe_52_expert_14
	moe_52_route -> moe_52_expert_15
	moe_52_expert_0 -> moe_52_aggregate
	moe_52_expert_1 -> moe_52_aggregate
	moe_52_expert_2 -> moe_52_aggregate
	moe_52_expert_3 -> moe_52_aggregate
	moe_52_expert_4 -> moe_52_aggregate
	moe_52_expert_5 -> moe_52_aggregate
	moe_52_expert_6 -> moe_52_aggregate
	moe_52_expert_7 -> moe_52_aggregate
	moe_52_expert_8 -> moe_52_aggregate
	moe_52_expert_9 -> moe_52_aggregate
	moe_52_expert_10 -> moe_52_aggregate
	moe_52_expert_11 -> moe_52_aggregate
	moe_52_expert_12 -> moe_52_aggregate
	moe_52_expert_13 -> moe_52_aggregate
	moe_52_expert_14 -> moe_52_aggregate
	moe_52_expert_15 -> moe_52_aggregate
	moe_52_aggregate -> moe_52_ffn
	moe_52_ffn -> moe_52_res2
	moe_52_res2 -> moe_53_mha
	moe_53_mha -> moe_53_res1
	moe_53_res1 -> moe_53_gate
	moe_53_gate -> moe_53_route
	moe_53_route -> moe_53_expert_0
	moe_53_route -> moe_53_expert_1
	moe_53_route -> moe_53_expert_2
	moe_53_route -> moe_53_expert_3
	moe_53_route -> moe_53_expert_4
	moe_53_route -> moe_53_expert_5
	moe_53_route -> moe_53_expert_6
	moe_53_route -> moe_53_expert_7
	moe_53_route -> moe_53_expert_8
	moe_53_route -> moe_53_expert_9
	moe_53_route -> moe_53_expert_10
	moe_53_route -> moe_53_expert_11
	moe_53_route -> moe_53_expert_12
	moe_53_route -> moe_53_expert_13
	moe_53_route -> moe_53_expert_14
	moe_53_route -> moe_53_expert_15
	moe_53_expert_0 -> moe_53_aggregate
	moe_53_expert_1 -> moe_53_aggregate
	moe_53_expert_2 -> moe_53_aggregate
	moe_53_expert_3 -> moe_53_aggregate
	moe_53_expert_4 -> moe_53_aggregate
	moe_53_expert_5 -> moe_53_aggregate
	moe_53_expert_6 -> moe_53_aggregate
	moe_53_expert_7 -> moe_53_aggregate
	moe_53_expert_8 -> moe_53_aggregate
	moe_53_expert_9 -> moe_53_aggregate
	moe_53_expert_10 -> moe_53_aggregate
	moe_53_expert_11 -> moe_53_aggregate
	moe_53_expert_12 -> moe_53_aggregate
	moe_53_expert_13 -> moe_53_aggregate
	moe_53_expert_14 -> moe_53_aggregate
	moe_53_expert_15 -> moe_53_aggregate
	moe_53_aggregate -> moe_53_ffn
	moe_53_ffn -> moe_53_res2
	moe_53_res2 -> moe_54_mha
	moe_54_mha -> moe_54_res1
	moe_54_res1 -> moe_54_gate
	moe_54_gate -> moe_54_route
	moe_54_route -> moe_54_expert_0
	moe_54_route -> moe_54_expert_1
	moe_54_route -> moe_54_expert_2
	moe_54_route -> moe_54_expert_3
	moe_54_route -> moe_54_expert_4
	moe_54_route -> moe_54_expert_5
	moe_54_route -> moe_54_expert_6
	moe_54_route -> moe_54_expert_7
	moe_54_route -> moe_54_expert_8
	moe_54_route -> moe_54_expert_9
	moe_54_route -> moe_54_expert_10
	moe_54_route -> moe_54_expert_11
	moe_54_route -> moe_54_expert_12
	moe_54_route -> moe_54_expert_13
	moe_54_route -> moe_54_expert_14
	moe_54_route -> moe_54_expert_15
	moe_54_expert_0 -> moe_54_aggregate
	moe_54_expert_1 -> moe_54_aggregate
	moe_54_expert_2 -> moe_54_aggregate
	moe_54_expert_3 -> moe_54_aggregate
	moe_54_expert_4 -> moe_54_aggregate
	moe_54_expert_5 -> moe_54_aggregate
	moe_54_expert_6 -> moe_54_aggregate
	moe_54_expert_7 -> moe_54_aggregate
	moe_54_expert_8 -> moe_54_aggregate
	moe_54_expert_9 -> moe_54_aggregate
	moe_54_expert_10 -> moe_54_aggregate
	moe_54_expert_11 -> moe_54_aggregate
	moe_54_expert_12 -> moe_54_aggregate
	moe_54_expert_13 -> moe_54_aggregate
	moe_54_expert_14 -> moe_54_aggregate
	moe_54_expert_15 -> moe_54_aggregate
	moe_54_aggregate -> moe_54_ffn
	moe_54_ffn -> moe_54_res2
	moe_54_res2 -> moe_55_mha
	moe_55_mha -> moe_55_res1
	moe_55_res1 -> moe_55_gate
	moe_55_gate -> moe_55_route
	moe_55_route -> moe_55_expert_0
	moe_55_route -> moe_55_expert_1
	moe_55_route -> moe_55_expert_2
	moe_55_route -> moe_55_expert_3
	moe_55_route -> moe_55_expert_4
	moe_55_route -> moe_55_expert_5
	moe_55_route -> moe_55_expert_6
	moe_55_route -> moe_55_expert_7
	moe_55_route -> moe_55_expert_8
	moe_55_route -> moe_55_expert_9
	moe_55_route -> moe_55_expert_10
	moe_55_route -> moe_55_expert_11
	moe_55_route -> moe_55_expert_12
	moe_55_route -> moe_55_expert_13
	moe_55_route -> moe_55_expert_14
	moe_55_route -> moe_55_expert_15
	moe_55_expert_0 -> moe_55_aggregate
	moe_55_expert_1 -> moe_55_aggregate
	moe_55_expert_2 -> moe_55_aggregate
	moe_55_expert_3 -> moe_55_aggregate
	moe_55_expert_4 -> moe_55_aggregate
	moe_55_expert_5 -> moe_55_aggregate
	moe_55_expert_6 -> moe_55_aggregate
	moe_55_expert_7 -> moe_55_aggregate
	moe_55_expert_8 -> moe_55_aggregate
	moe_55_expert_9 -> moe_55_aggregate
	moe_55_expert_10 -> moe_55_aggregate
	moe_55_expert_11 -> moe_55_aggregate
	moe_55_expert_12 -> moe_55_aggregate
	moe_55_expert_13 -> moe_55_aggregate
	moe_55_expert_14 -> moe_55_aggregate
	moe_55_expert_15 -> moe_55_aggregate
	moe_55_aggregate -> moe_55_ffn
	moe_55_ffn -> moe_55_res2
	moe_55_res2 -> moe_56_mha
	moe_56_mha -> moe_56_res1
	moe_56_res1 -> moe_56_gate
	moe_56_gate -> moe_56_route
	moe_56_route -> moe_56_expert_0
	moe_56_route -> moe_56_expert_1
	moe_56_route -> moe_56_expert_2
	moe_56_route -> moe_56_expert_3
	moe_56_route -> moe_56_expert_4
	moe_56_route -> moe_56_expert_5
	moe_56_route -> moe_56_expert_6
	moe_56_route -> moe_56_expert_7
	moe_56_route -> moe_56_expert_8
	moe_56_route -> moe_56_expert_9
	moe_56_route -> moe_56_expert_10
	moe_56_route -> moe_56_expert_11
	moe_56_route -> moe_56_expert_12
	moe_56_route -> moe_56_expert_13
	moe_56_route -> moe_56_expert_14
	moe_56_route -> moe_56_expert_15
	moe_56_expert_0 -> moe_56_aggregate
	moe_56_expert_1 -> moe_56_aggregate
	moe_56_expert_2 -> moe_56_aggregate
	moe_56_expert_3 -> moe_56_aggregate
	moe_56_expert_4 -> moe_56_aggregate
	moe_56_expert_5 -> moe_56_aggregate
	moe_56_expert_6 -> moe_56_aggregate
	moe_56_expert_7 -> moe_56_aggregate
	moe_56_expert_8 -> moe_56_aggregate
	moe_56_expert_9 -> moe_56_aggregate
	moe_56_expert_10 -> moe_56_aggregate
	moe_56_expert_11 -> moe_56_aggregate
	moe_56_expert_12 -> moe_56_aggregate
	moe_56_expert_13 -> moe_56_aggregate
	moe_56_expert_14 -> moe_56_aggregate
	moe_56_expert_15 -> moe_56_aggregate
	moe_56_aggregate -> moe_56_ffn
	moe_56_ffn -> moe_56_res2
	moe_56_res2 -> moe_57_mha
	moe_57_mha -> moe_57_res1
	moe_57_res1 -> moe_57_gate
	moe_57_gate -> moe_57_route
	moe_57_route -> moe_57_expert_0
	moe_57_route -> moe_57_expert_1
	moe_57_route -> moe_57_expert_2
	moe_57_route -> moe_57_expert_3
	moe_57_route -> moe_57_expert_4
	moe_57_route -> moe_57_expert_5
	moe_57_route -> moe_57_expert_6
	moe_57_route -> moe_57_expert_7
	moe_57_route -> moe_57_expert_8
	moe_57_route -> moe_57_expert_9
	moe_57_route -> moe_57_expert_10
	moe_57_route -> moe_57_expert_11
	moe_57_route -> moe_57_expert_12
	moe_57_route -> moe_57_expert_13
	moe_57_route -> moe_57_expert_14
	moe_57_route -> moe_57_expert_15
	moe_57_expert_0 -> moe_57_aggregate
	moe_57_expert_1 -> moe_57_aggregate
	moe_57_expert_2 -> moe_57_aggregate
	moe_57_expert_3 -> moe_57_aggregate
	moe_57_expert_4 -> moe_57_aggregate
	moe_57_expert_5 -> moe_57_aggregate
	moe_57_expert_6 -> moe_57_aggregate
	moe_57_expert_7 -> moe_57_aggregate
	moe_57_expert_8 -> moe_57_aggregate
	moe_57_expert_9 -> moe_57_aggregate
	moe_57_expert_10 -> moe_57_aggregate
	moe_57_expert_11 -> moe_57_aggregate
	moe_57_expert_12 -> moe_57_aggregate
	moe_57_expert_13 -> moe_57_aggregate
	moe_57_expert_14 -> moe_57_aggregate
	moe_57_expert_15 -> moe_57_aggregate
	moe_57_aggregate -> moe_57_ffn
	moe_57_ffn -> moe_57_res2
	moe_57_res2 -> moe_58_mha
	moe_58_mha -> moe_58_res1
	moe_58_res1 -> moe_58_gate
	moe_58_gate -> moe_58_route
	moe_58_route -> moe_58_expert_0
	moe_58_route -> moe_58_expert_1
	moe_58_route -> moe_58_expert_2
	moe_58_route -> moe_58_expert_3
	moe_58_route -> moe_58_expert_4
	moe_58_route -> moe_58_expert_5
	moe_58_route -> moe_58_expert_6
	moe_58_route -> moe_58_expert_7
	moe_58_route -> moe_58_expert_8
	moe_58_route -> moe_58_expert_9
	moe_58_route -> moe_58_expert_10
	moe_58_route -> moe_58_expert_11
	moe_58_route -> moe_58_expert_12
	moe_58_route -> moe_58_expert_13
	moe_58_route -> moe_58_expert_14
	moe_58_route -> moe_58_expert_15
	moe_58_expert_0 -> moe_58_aggregate
	moe_58_expert_1 -> moe_58_aggregate
	moe_58_expert_2 -> moe_58_aggregate
	moe_58_expert_3 -> moe_58_aggregate
	moe_58_expert_4 -> moe_58_aggregate
	moe_58_expert_5 -> moe_58_aggregate
	moe_58_expert_6 -> moe_58_aggregate
	moe_58_expert_7 -> moe_58_aggregate
	moe_58_expert_8 -> moe_58_aggregate
	moe_58_expert_9 -> moe_58_aggregate
	moe_58_expert_10 -> moe_58_aggregate
	moe_58_expert_11 -> moe_58_aggregate
	moe_58_expert_12 -> moe_58_aggregate
	moe_58_expert_13 -> moe_58_aggregate
	moe_58_expert_14 -> moe_58_aggregate
	moe_58_expert_15 -> moe_58_aggregate
	moe_58_aggregate -> moe_58_ffn
	moe_58_ffn -> moe_58_res2
	moe_58_res2 -> moe_59_mha
	moe_59_mha -> moe_59_res1
	moe_59_res1 -> moe_59_gate
	moe_59_gate -> moe_59_route
	moe_59_route -> moe_59_expert_0
	moe_59_route -> moe_59_expert_1
	moe_59_route -> moe_59_expert_2
	moe_59_route -> moe_59_expert_3
	moe_59_route -> moe_59_expert_4
	moe_59_route -> moe_59_expert_5
	moe_59_route -> moe_59_expert_6
	moe_59_route -> moe_59_expert_7
	moe_59_route -> moe_59_expert_8
	moe_59_route -> moe_59_expert_9
	moe_59_route -> moe_59_expert_10
	moe_59_route -> moe_59_expert_11
	moe_59_route -> moe_59_expert_12
	moe_59_route -> moe_59_expert_13
	moe_59_route -> moe_59_expert_14
	moe_59_route -> moe_59_expert_15
	moe_59_expert_0 -> moe_59_aggregate
	moe_59_expert_1 -> moe_59_aggregate
	moe_59_expert_2 -> moe_59_aggregate
	moe_59_expert_3 -> moe_59_aggregate
	moe_59_expert_4 -> moe_59_aggregate
	moe_59_expert_5 -> moe_59_aggregate
	moe_59_expert_6 -> moe_59_aggregate
	moe_59_expert_7 -> moe_59_aggregate
	moe_59_expert_8 -> moe_59_aggregate
	moe_59_expert_9 -> moe_59_aggregate
	moe_59_expert_10 -> moe_59_aggregate
	moe_59_expert_11 -> moe_59_aggregate
	moe_59_expert_12 -> moe_59_aggregate
	moe_59_expert_13 -> moe_59_aggregate
	moe_59_expert_14 -> moe_59_aggregate
	moe_59_expert_15 -> moe_59_aggregate
	moe_59_aggregate -> moe_59_ffn
	moe_59_ffn -> moe_59_res2
	moe_59_res2 -> moe_60_mha
	moe_60_mha -> moe_60_res1
	moe_60_res1 -> moe_60_gate
	moe_60_gate -> moe_60_route
	moe_60_route -> moe_60_expert_0
	moe_60_route -> moe_60_expert_1
	moe_60_route -> moe_60_expert_2
	moe_60_route -> moe_60_expert_3
	moe_60_route -> moe_60_expert_4
	moe_60_route -> moe_60_expert_5
	moe_60_route -> moe_60_expert_6
	moe_60_route -> moe_60_expert_7
	moe_60_route -> moe_60_expert_8
	moe_60_route -> moe_60_expert_9
	moe_60_route -> moe_60_expert_10
	moe_60_route -> moe_60_expert_11
	moe_60_route -> moe_60_expert_12
	moe_60_route -> moe_60_expert_13
	moe_60_route -> moe_60_expert_14
	moe_60_route -> moe_60_expert_15
	moe_60_expert_0 -> moe_60_aggregate
	moe_60_expert_1 -> moe_60_aggregate
	moe_60_expert_2 -> moe_60_aggregate
	moe_60_expert_3 -> moe_60_aggregate
	moe_60_expert_4 -> moe_60_aggregate
	moe_60_expert_5 -> moe_60_aggregate
	moe_60_expert_6 -> moe_60_aggregate
	moe_60_expert_7 -> moe_60_aggregate
	moe_60_expert_8 -> moe_60_aggregate
	moe_60_expert_9 -> moe_60_aggregate
	moe_60_expert_10 -> moe_60_aggregate
	moe_60_expert_11 -> moe_60_aggregate
	moe_60_expert_12 -> moe_60_aggregate
	moe_60_expert_13 -> moe_60_aggregate
	moe_60_expert_14 -> moe_60_aggregate
	moe_60_expert_15 -> moe_60_aggregate
	moe_60_aggregate -> moe_60_ffn
	moe_60_ffn -> moe_60_res2
	moe_60_res2 -> moe_61_mha
	moe_61_mha -> moe_61_res1
	moe_61_res1 -> moe_61_gate
	moe_61_gate -> moe_61_route
	moe_61_route -> moe_61_expert_0
	moe_61_route -> moe_61_expert_1
	moe_61_route -> moe_61_expert_2
	moe_61_route -> moe_61_expert_3
	moe_61_route -> moe_61_expert_4
	moe_61_route -> moe_61_expert_5
	moe_61_route -> moe_61_expert_6
	moe_61_route -> moe_61_expert_7
	moe_61_route -> moe_61_expert_8
	moe_61_route -> moe_61_expert_9
	moe_61_route -> moe_61_expert_10
	moe_61_route -> moe_61_expert_11
	moe_61_route -> moe_61_expert_12
	moe_61_route -> moe_61_expert_13
	moe_61_route -> moe_61_expert_14
	moe_61_route -> moe_61_expert_15
	moe_61_expert_0 -> moe_61_aggregate
	moe_61_expert_1 -> moe_61_aggregate
	moe_61_expert_2 -> moe_61_aggregate
	moe_61_expert_3 -> moe_61_aggregate
	moe_61_expert_4 -> moe_61_aggregate
	moe_61_expert_5 -> moe_61_aggregate
	moe_61_expert_6 -> moe_61_aggregate
	moe_61_expert_7 -> moe_61_aggregate
	moe_61_expert_8 -> moe_61_aggregate
	moe_61_expert_9 -> moe_61_aggregate
	moe_61_expert_10 -> moe_61_aggregate
	moe_61_expert_11 -> moe_61_aggregate
	moe_61_expert_12 -> moe_61_aggregate
	moe_61_expert_13 -> moe_61_aggregate
	moe_61_expert_14 -> moe_61_aggregate
	moe_61_expert_15 -> moe_61_aggregate
	moe_61_aggregate -> moe_61_ffn
	moe_61_ffn -> moe_61_res2
	moe_61_res2 -> output
}
