<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="258pt" height="3600pt"
 viewBox="0.00 0.00 257.92 3600.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.07 0.07) rotate(0) translate(4 54627.54)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-54627.54 3910,-54627.54 3910,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<path fill="lightgray" stroke="black" d="M1741,-54524.54C1741,-54524.54 2049,-54524.54 2049,-54524.54 2055,-54524.54 2061,-54530.54 2061,-54536.54 2061,-54536.54 2061,-54603.54 2061,-54603.54 2061,-54609.54 2055,-54615.54 2049,-54615.54 2049,-54615.54 1741,-54615.54 1741,-54615.54 1735,-54615.54 1729,-54609.54 1729,-54603.54 1729,-54603.54 1729,-54536.54 1729,-54536.54 1729,-54530.54 1735,-54524.54 1741,-54524.54"/>
<text text-anchor="middle" x="1895" y="-54600.34" font-family="Times,serif" font-size="14.00">Input Layer</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_dense_1</title>
<path fill="lightgray" stroke="black" d="M1562,-54057.54C1562,-54057.54 2228,-54057.54 2228,-54057.54 2234,-54057.54 2240,-54063.54 2240,-54069.54 2240,-54069.54 2240,-54504.54 2240,-54504.54 2240,-54510.54 2234,-54516.54 2228,-54516.54 2228,-54516.54 1562,-54516.54 1562,-54516.54 1556,-54516.54 1550,-54510.54 1550,-54504.54 1550,-54504.54 1550,-54069.54 1550,-54069.54 1550,-54063.54 1556,-54057.54 1562,-54057.54"/>
<text text-anchor="middle" x="1895" y="-54501.34" font-family="Times,serif" font-size="14.00">Dense Layer 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_dense_2</title>
<path fill="lightgray" stroke="black" d="M1562,-53590.54C1562,-53590.54 2228,-53590.54 2228,-53590.54 2234,-53590.54 2240,-53596.54 2240,-53602.54 2240,-53602.54 2240,-54037.54 2240,-54037.54 2240,-54043.54 2234,-54049.54 2228,-54049.54 2228,-54049.54 1562,-54049.54 1562,-54049.54 1556,-54049.54 1550,-54043.54 1550,-54037.54 1550,-54037.54 1550,-53602.54 1550,-53602.54 1550,-53596.54 1556,-53590.54 1562,-53590.54"/>
<text text-anchor="middle" x="1895" y="-54034.34" font-family="Times,serif" font-size="14.00">Dense Layer 2</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_dense_3</title>
<path fill="lightgray" stroke="black" d="M1562,-53123.54C1562,-53123.54 2228,-53123.54 2228,-53123.54 2234,-53123.54 2240,-53129.54 2240,-53135.54 2240,-53135.54 2240,-53570.54 2240,-53570.54 2240,-53576.54 2234,-53582.54 2228,-53582.54 2228,-53582.54 1562,-53582.54 1562,-53582.54 1556,-53582.54 1550,-53576.54 1550,-53570.54 1550,-53570.54 1550,-53135.54 1550,-53135.54 1550,-53129.54 1556,-53123.54 1562,-53123.54"/>
<text text-anchor="middle" x="1895" y="-53567.34" font-family="Times,serif" font-size="14.00">Dense Layer 3</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_moe_4</title>
<path fill="lightgray" stroke="black" d="M20,-52209.46C20,-52209.46 3770,-52209.46 3770,-52209.46 3776,-52209.46 3782,-52215.46 3782,-52221.46 3782,-52221.46 3782,-53103.54 3782,-53103.54 3782,-53109.54 3776,-53115.54 3770,-53115.54 3770,-53115.54 20,-53115.54 20,-53115.54 14,-53115.54 8,-53109.54 8,-53103.54 8,-53103.54 8,-52221.46 8,-52221.46 8,-52215.46 14,-52209.46 20,-52209.46"/>
<text text-anchor="middle" x="1895" y="-53100.34" font-family="Times,serif" font-size="14.00">MoE Layer 4</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_moe_5</title>
<path fill="lightgray" stroke="black" d="M34,-51295.38C34,-51295.38 3784,-51295.38 3784,-51295.38 3790,-51295.38 3796,-51301.38 3796,-51307.38 3796,-51307.38 3796,-52189.46 3796,-52189.46 3796,-52195.46 3790,-52201.46 3784,-52201.46 3784,-52201.46 34,-52201.46 34,-52201.46 28,-52201.46 22,-52195.46 22,-52189.46 22,-52189.46 22,-51307.38 22,-51307.38 22,-51301.38 28,-51295.38 34,-51295.38"/>
<text text-anchor="middle" x="1909" y="-52186.26" font-family="Times,serif" font-size="14.00">MoE Layer 5</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_moe_6</title>
<path fill="lightgray" stroke="black" d="M63,-50381.3C63,-50381.3 3813,-50381.3 3813,-50381.3 3819,-50381.3 3825,-50387.3 3825,-50393.3 3825,-50393.3 3825,-51275.38 3825,-51275.38 3825,-51281.38 3819,-51287.38 3813,-51287.38 3813,-51287.38 63,-51287.38 63,-51287.38 57,-51287.38 51,-51281.38 51,-51275.38 51,-51275.38 51,-50393.3 51,-50393.3 51,-50387.3 57,-50381.3 63,-50381.3"/>
<text text-anchor="middle" x="1938" y="-51272.18" font-family="Times,serif" font-size="14.00">MoE Layer 6</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_moe_7</title>
<path fill="lightgray" stroke="black" d="M121,-49467.22C121,-49467.22 3871,-49467.22 3871,-49467.22 3877,-49467.22 3883,-49473.22 3883,-49479.22 3883,-49479.22 3883,-50361.3 3883,-50361.3 3883,-50367.3 3877,-50373.3 3871,-50373.3 3871,-50373.3 121,-50373.3 121,-50373.3 115,-50373.3 109,-50367.3 109,-50361.3 109,-50361.3 109,-49479.22 109,-49479.22 109,-49473.22 115,-49467.22 121,-49467.22"/>
<text text-anchor="middle" x="1996" y="-50358.1" font-family="Times,serif" font-size="14.00">MoE Layer 7</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_moe_8</title>
<path fill="lightgray" stroke="black" d="M78,-48553.15C78,-48553.15 3828,-48553.15 3828,-48553.15 3834,-48553.15 3840,-48559.15 3840,-48565.15 3840,-48565.15 3840,-49447.22 3840,-49447.22 3840,-49453.22 3834,-49459.22 3828,-49459.22 3828,-49459.22 78,-49459.22 78,-49459.22 72,-49459.22 66,-49453.22 66,-49447.22 66,-49447.22 66,-48565.15 66,-48565.15 66,-48559.15 72,-48553.15 78,-48553.15"/>
<text text-anchor="middle" x="1953" y="-49444.02" font-family="Times,serif" font-size="14.00">MoE Layer 8</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_moe_9</title>
<path fill="lightgray" stroke="black" d="M81,-47639.07C81,-47639.07 3831,-47639.07 3831,-47639.07 3837,-47639.07 3843,-47645.07 3843,-47651.07 3843,-47651.07 3843,-48533.15 3843,-48533.15 3843,-48539.15 3837,-48545.15 3831,-48545.15 3831,-48545.15 81,-48545.15 81,-48545.15 75,-48545.15 69,-48539.15 69,-48533.15 69,-48533.15 69,-47651.07 69,-47651.07 69,-47645.07 75,-47639.07 81,-47639.07"/>
<text text-anchor="middle" x="1956" y="-48529.95" font-family="Times,serif" font-size="14.00">MoE Layer 9</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_moe_10</title>
<path fill="lightgray" stroke="black" d="M93,-46724.99C93,-46724.99 3843,-46724.99 3843,-46724.99 3849,-46724.99 3855,-46730.99 3855,-46736.99 3855,-46736.99 3855,-47619.07 3855,-47619.07 3855,-47625.07 3849,-47631.07 3843,-47631.07 3843,-47631.07 93,-47631.07 93,-47631.07 87,-47631.07 81,-47625.07 81,-47619.07 81,-47619.07 81,-46736.99 81,-46736.99 81,-46730.99 87,-46724.99 93,-46724.99"/>
<text text-anchor="middle" x="1968" y="-47615.87" font-family="Times,serif" font-size="14.00">MoE Layer 10</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_moe_11</title>
<path fill="lightgray" stroke="black" d="M136,-45810.91C136,-45810.91 3886,-45810.91 3886,-45810.91 3892,-45810.91 3898,-45816.91 3898,-45822.91 3898,-45822.91 3898,-46704.99 3898,-46704.99 3898,-46710.99 3892,-46716.99 3886,-46716.99 3886,-46716.99 136,-46716.99 136,-46716.99 130,-46716.99 124,-46710.99 124,-46704.99 124,-46704.99 124,-45822.91 124,-45822.91 124,-45816.91 130,-45810.91 136,-45810.91"/>
<text text-anchor="middle" x="2011" y="-46701.79" font-family="Times,serif" font-size="14.00">MoE Layer 11</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_moe_12</title>
<path fill="lightgray" stroke="black" d="M78,-44896.83C78,-44896.83 3828,-44896.83 3828,-44896.83 3834,-44896.83 3840,-44902.83 3840,-44908.83 3840,-44908.83 3840,-45790.91 3840,-45790.91 3840,-45796.91 3834,-45802.91 3828,-45802.91 3828,-45802.91 78,-45802.91 78,-45802.91 72,-45802.91 66,-45796.91 66,-45790.91 66,-45790.91 66,-44908.83 66,-44908.83 66,-44902.83 72,-44896.83 78,-44896.83"/>
<text text-anchor="middle" x="1953" y="-45787.71" font-family="Times,serif" font-size="14.00">MoE Layer 12</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_moe_13</title>
<path fill="lightgray" stroke="black" d="M78,-43982.75C78,-43982.75 3828,-43982.75 3828,-43982.75 3834,-43982.75 3840,-43988.75 3840,-43994.75 3840,-43994.75 3840,-44876.83 3840,-44876.83 3840,-44882.83 3834,-44888.83 3828,-44888.83 3828,-44888.83 78,-44888.83 78,-44888.83 72,-44888.83 66,-44882.83 66,-44876.83 66,-44876.83 66,-43994.75 66,-43994.75 66,-43988.75 72,-43982.75 78,-43982.75"/>
<text text-anchor="middle" x="1953" y="-44873.63" font-family="Times,serif" font-size="14.00">MoE Layer 13</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_moe_14</title>
<path fill="lightgray" stroke="black" d="M20,-43068.68C20,-43068.68 3770,-43068.68 3770,-43068.68 3776,-43068.68 3782,-43074.68 3782,-43080.68 3782,-43080.68 3782,-43962.75 3782,-43962.75 3782,-43968.75 3776,-43974.75 3770,-43974.75 3770,-43974.75 20,-43974.75 20,-43974.75 14,-43974.75 8,-43968.75 8,-43962.75 8,-43962.75 8,-43080.68 8,-43080.68 8,-43074.68 14,-43068.68 20,-43068.68"/>
<text text-anchor="middle" x="1895" y="-43959.55" font-family="Times,serif" font-size="14.00">MoE Layer 14</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_moe_15</title>
<path fill="lightgray" stroke="black" d="M20,-42154.6C20,-42154.6 3770,-42154.6 3770,-42154.6 3776,-42154.6 3782,-42160.6 3782,-42166.6 3782,-42166.6 3782,-43048.68 3782,-43048.68 3782,-43054.68 3776,-43060.68 3770,-43060.68 3770,-43060.68 20,-43060.68 20,-43060.68 14,-43060.68 8,-43054.68 8,-43048.68 8,-43048.68 8,-42166.6 8,-42166.6 8,-42160.6 14,-42154.6 20,-42154.6"/>
<text text-anchor="middle" x="1895" y="-43045.48" font-family="Times,serif" font-size="14.00">MoE Layer 15</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_moe_16</title>
<path fill="lightgray" stroke="black" d="M55,-41240.52C55,-41240.52 3805,-41240.52 3805,-41240.52 3811,-41240.52 3817,-41246.52 3817,-41252.52 3817,-41252.52 3817,-42134.6 3817,-42134.6 3817,-42140.6 3811,-42146.6 3805,-42146.6 3805,-42146.6 55,-42146.6 55,-42146.6 49,-42146.6 43,-42140.6 43,-42134.6 43,-42134.6 43,-41252.52 43,-41252.52 43,-41246.52 49,-41240.52 55,-41240.52"/>
<text text-anchor="middle" x="1930" y="-42131.4" font-family="Times,serif" font-size="14.00">MoE Layer 16</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_moe_17</title>
<path fill="lightgray" stroke="black" d="M47,-40326.44C47,-40326.44 3797,-40326.44 3797,-40326.44 3803,-40326.44 3809,-40332.44 3809,-40338.44 3809,-40338.44 3809,-41220.52 3809,-41220.52 3809,-41226.52 3803,-41232.52 3797,-41232.52 3797,-41232.52 47,-41232.52 47,-41232.52 41,-41232.52 35,-41226.52 35,-41220.52 35,-41220.52 35,-40338.44 35,-40338.44 35,-40332.44 41,-40326.44 47,-40326.44"/>
<text text-anchor="middle" x="1922" y="-41217.32" font-family="Times,serif" font-size="14.00">MoE Layer 17</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_moe_18</title>
<path fill="lightgray" stroke="black" d="M61,-39412.36C61,-39412.36 3811,-39412.36 3811,-39412.36 3817,-39412.36 3823,-39418.36 3823,-39424.36 3823,-39424.36 3823,-40306.44 3823,-40306.44 3823,-40312.44 3817,-40318.44 3811,-40318.44 3811,-40318.44 61,-40318.44 61,-40318.44 55,-40318.44 49,-40312.44 49,-40306.44 49,-40306.44 49,-39424.36 49,-39424.36 49,-39418.36 55,-39412.36 61,-39412.36"/>
<text text-anchor="middle" x="1936" y="-40303.24" font-family="Times,serif" font-size="14.00">MoE Layer 18</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_moe_19</title>
<path fill="lightgray" stroke="black" d="M20,-38498.28C20,-38498.28 3770,-38498.28 3770,-38498.28 3776,-38498.28 3782,-38504.28 3782,-38510.28 3782,-38510.28 3782,-39392.36 3782,-39392.36 3782,-39398.36 3776,-39404.36 3770,-39404.36 3770,-39404.36 20,-39404.36 20,-39404.36 14,-39404.36 8,-39398.36 8,-39392.36 8,-39392.36 8,-38510.28 8,-38510.28 8,-38504.28 14,-38498.28 20,-38498.28"/>
<text text-anchor="middle" x="1895" y="-39389.16" font-family="Times,serif" font-size="14.00">MoE Layer 19</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_moe_20</title>
<path fill="lightgray" stroke="black" d="M20,-37584.21C20,-37584.21 3770,-37584.21 3770,-37584.21 3776,-37584.21 3782,-37590.21 3782,-37596.21 3782,-37596.21 3782,-38478.28 3782,-38478.28 3782,-38484.28 3776,-38490.28 3770,-38490.28 3770,-38490.28 20,-38490.28 20,-38490.28 14,-38490.28 8,-38484.28 8,-38478.28 8,-38478.28 8,-37596.21 8,-37596.21 8,-37590.21 14,-37584.21 20,-37584.21"/>
<text text-anchor="middle" x="1895" y="-38475.08" font-family="Times,serif" font-size="14.00">MoE Layer 20</text>
</g>
<g id="clust22" class="cluster">
<title>cluster_moe_21</title>
<path fill="lightgray" stroke="black" d="M75,-36670.13C75,-36670.13 3825,-36670.13 3825,-36670.13 3831,-36670.13 3837,-36676.13 3837,-36682.13 3837,-36682.13 3837,-37564.21 3837,-37564.21 3837,-37570.21 3831,-37576.21 3825,-37576.21 3825,-37576.21 75,-37576.21 75,-37576.21 69,-37576.21 63,-37570.21 63,-37564.21 63,-37564.21 63,-36682.13 63,-36682.13 63,-36676.13 69,-36670.13 75,-36670.13"/>
<text text-anchor="middle" x="1950" y="-37561.01" font-family="Times,serif" font-size="14.00">MoE Layer 21</text>
</g>
<g id="clust23" class="cluster">
<title>cluster_moe_22</title>
<path fill="lightgray" stroke="black" d="M93,-35756.05C93,-35756.05 3843,-35756.05 3843,-35756.05 3849,-35756.05 3855,-35762.05 3855,-35768.05 3855,-35768.05 3855,-36650.13 3855,-36650.13 3855,-36656.13 3849,-36662.13 3843,-36662.13 3843,-36662.13 93,-36662.13 93,-36662.13 87,-36662.13 81,-36656.13 81,-36650.13 81,-36650.13 81,-35768.05 81,-35768.05 81,-35762.05 87,-35756.05 93,-35756.05"/>
<text text-anchor="middle" x="1968" y="-36646.93" font-family="Times,serif" font-size="14.00">MoE Layer 22</text>
</g>
<g id="clust24" class="cluster">
<title>cluster_moe_23</title>
<path fill="lightgray" stroke="black" d="M65,-34841.97C65,-34841.97 3815,-34841.97 3815,-34841.97 3821,-34841.97 3827,-34847.97 3827,-34853.97 3827,-34853.97 3827,-35736.05 3827,-35736.05 3827,-35742.05 3821,-35748.05 3815,-35748.05 3815,-35748.05 65,-35748.05 65,-35748.05 59,-35748.05 53,-35742.05 53,-35736.05 53,-35736.05 53,-34853.97 53,-34853.97 53,-34847.97 59,-34841.97 65,-34841.97"/>
<text text-anchor="middle" x="1940" y="-35732.85" font-family="Times,serif" font-size="14.00">MoE Layer 23</text>
</g>
<g id="clust25" class="cluster">
<title>cluster_moe_24</title>
<path fill="lightgray" stroke="black" d="M81,-33927.89C81,-33927.89 3831,-33927.89 3831,-33927.89 3837,-33927.89 3843,-33933.89 3843,-33939.89 3843,-33939.89 3843,-34821.97 3843,-34821.97 3843,-34827.97 3837,-34833.97 3831,-34833.97 3831,-34833.97 81,-34833.97 81,-34833.97 75,-34833.97 69,-34827.97 69,-34821.97 69,-34821.97 69,-33939.89 69,-33939.89 69,-33933.89 75,-33927.89 81,-33927.89"/>
<text text-anchor="middle" x="1956" y="-34818.77" font-family="Times,serif" font-size="14.00">MoE Layer 24</text>
</g>
<g id="clust26" class="cluster">
<title>cluster_moe_25</title>
<path fill="lightgray" stroke="black" d="M20,-33013.82C20,-33013.82 3770,-33013.82 3770,-33013.82 3776,-33013.82 3782,-33019.82 3782,-33025.82 3782,-33025.82 3782,-33907.89 3782,-33907.89 3782,-33913.89 3776,-33919.89 3770,-33919.89 3770,-33919.89 20,-33919.89 20,-33919.89 14,-33919.89 8,-33913.89 8,-33907.89 8,-33907.89 8,-33025.82 8,-33025.82 8,-33019.82 14,-33013.82 20,-33013.82"/>
<text text-anchor="middle" x="1895" y="-33904.69" font-family="Times,serif" font-size="14.00">MoE Layer 25</text>
</g>
<g id="clust27" class="cluster">
<title>cluster_moe_26</title>
<path fill="lightgray" stroke="black" d="M109,-32099.74C109,-32099.74 3859,-32099.74 3859,-32099.74 3865,-32099.74 3871,-32105.74 3871,-32111.74 3871,-32111.74 3871,-32993.82 3871,-32993.82 3871,-32999.82 3865,-33005.82 3859,-33005.82 3859,-33005.82 109,-33005.82 109,-33005.82 103,-33005.82 97,-32999.82 97,-32993.82 97,-32993.82 97,-32111.74 97,-32111.74 97,-32105.74 103,-32099.74 109,-32099.74"/>
<text text-anchor="middle" x="1984" y="-32990.62" font-family="Times,serif" font-size="14.00">MoE Layer 26</text>
</g>
<g id="clust28" class="cluster">
<title>cluster_moe_27</title>
<path fill="lightgray" stroke="black" d="M81,-31185.66C81,-31185.66 3831,-31185.66 3831,-31185.66 3837,-31185.66 3843,-31191.66 3843,-31197.66 3843,-31197.66 3843,-32079.74 3843,-32079.74 3843,-32085.74 3837,-32091.74 3831,-32091.74 3831,-32091.74 81,-32091.74 81,-32091.74 75,-32091.74 69,-32085.74 69,-32079.74 69,-32079.74 69,-31197.66 69,-31197.66 69,-31191.66 75,-31185.66 81,-31185.66"/>
<text text-anchor="middle" x="1956" y="-32076.54" font-family="Times,serif" font-size="14.00">MoE Layer 27</text>
</g>
<g id="clust29" class="cluster">
<title>cluster_moe_28</title>
<path fill="lightgray" stroke="black" d="M81,-30271.58C81,-30271.58 3831,-30271.58 3831,-30271.58 3837,-30271.58 3843,-30277.58 3843,-30283.58 3843,-30283.58 3843,-31165.66 3843,-31165.66 3843,-31171.66 3837,-31177.66 3831,-31177.66 3831,-31177.66 81,-31177.66 81,-31177.66 75,-31177.66 69,-31171.66 69,-31165.66 69,-31165.66 69,-30283.58 69,-30283.58 69,-30277.58 75,-30271.58 81,-30271.58"/>
<text text-anchor="middle" x="1956" y="-31162.46" font-family="Times,serif" font-size="14.00">MoE Layer 28</text>
</g>
<g id="clust30" class="cluster">
<title>cluster_moe_29</title>
<path fill="lightgray" stroke="black" d="M136,-29357.5C136,-29357.5 3886,-29357.5 3886,-29357.5 3892,-29357.5 3898,-29363.5 3898,-29369.5 3898,-29369.5 3898,-30251.58 3898,-30251.58 3898,-30257.58 3892,-30263.58 3886,-30263.58 3886,-30263.58 136,-30263.58 136,-30263.58 130,-30263.58 124,-30257.58 124,-30251.58 124,-30251.58 124,-29369.5 124,-29369.5 124,-29363.5 130,-29357.5 136,-29357.5"/>
<text text-anchor="middle" x="2011" y="-30248.38" font-family="Times,serif" font-size="14.00">MoE Layer 29</text>
</g>
<g id="clust31" class="cluster">
<title>cluster_moe_30</title>
<path fill="lightgray" stroke="black" d="M136,-28443.42C136,-28443.42 3886,-28443.42 3886,-28443.42 3892,-28443.42 3898,-28449.42 3898,-28455.42 3898,-28455.42 3898,-29337.5 3898,-29337.5 3898,-29343.5 3892,-29349.5 3886,-29349.5 3886,-29349.5 136,-29349.5 136,-29349.5 130,-29349.5 124,-29343.5 124,-29337.5 124,-29337.5 124,-28455.42 124,-28455.42 124,-28449.42 130,-28443.42 136,-28443.42"/>
<text text-anchor="middle" x="2011" y="-29334.3" font-family="Times,serif" font-size="14.00">MoE Layer 30</text>
</g>
<g id="clust32" class="cluster">
<title>cluster_moe_31</title>
<path fill="lightgray" stroke="black" d="M81,-27529.35C81,-27529.35 3831,-27529.35 3831,-27529.35 3837,-27529.35 3843,-27535.35 3843,-27541.35 3843,-27541.35 3843,-28423.42 3843,-28423.42 3843,-28429.42 3837,-28435.42 3831,-28435.42 3831,-28435.42 81,-28435.42 81,-28435.42 75,-28435.42 69,-28429.42 69,-28423.42 69,-28423.42 69,-27541.35 69,-27541.35 69,-27535.35 75,-27529.35 81,-27529.35"/>
<text text-anchor="middle" x="1956" y="-28420.22" font-family="Times,serif" font-size="14.00">MoE Layer 31</text>
</g>
<g id="clust33" class="cluster">
<title>cluster_moe_32</title>
<path fill="lightgray" stroke="black" d="M20,-26615.27C20,-26615.27 3770,-26615.27 3770,-26615.27 3776,-26615.27 3782,-26621.27 3782,-26627.27 3782,-26627.27 3782,-27509.35 3782,-27509.35 3782,-27515.35 3776,-27521.35 3770,-27521.35 3770,-27521.35 20,-27521.35 20,-27521.35 14,-27521.35 8,-27515.35 8,-27509.35 8,-27509.35 8,-26627.27 8,-26627.27 8,-26621.27 14,-26615.27 20,-26615.27"/>
<text text-anchor="middle" x="1895" y="-27506.15" font-family="Times,serif" font-size="14.00">MoE Layer 32</text>
</g>
<g id="clust34" class="cluster">
<title>cluster_moe_33</title>
<path fill="lightgray" stroke="black" d="M20,-25701.19C20,-25701.19 3770,-25701.19 3770,-25701.19 3776,-25701.19 3782,-25707.19 3782,-25713.19 3782,-25713.19 3782,-26595.27 3782,-26595.27 3782,-26601.27 3776,-26607.27 3770,-26607.27 3770,-26607.27 20,-26607.27 20,-26607.27 14,-26607.27 8,-26601.27 8,-26595.27 8,-26595.27 8,-25713.19 8,-25713.19 8,-25707.19 14,-25701.19 20,-25701.19"/>
<text text-anchor="middle" x="1895" y="-26592.07" font-family="Times,serif" font-size="14.00">MoE Layer 33</text>
</g>
<g id="clust35" class="cluster">
<title>cluster_moe_34</title>
<path fill="lightgray" stroke="black" d="M22,-24787.11C22,-24787.11 3772,-24787.11 3772,-24787.11 3778,-24787.11 3784,-24793.11 3784,-24799.11 3784,-24799.11 3784,-25681.19 3784,-25681.19 3784,-25687.19 3778,-25693.19 3772,-25693.19 3772,-25693.19 22,-25693.19 22,-25693.19 16,-25693.19 10,-25687.19 10,-25681.19 10,-25681.19 10,-24799.11 10,-24799.11 10,-24793.11 16,-24787.11 22,-24787.11"/>
<text text-anchor="middle" x="1897" y="-25677.99" font-family="Times,serif" font-size="14.00">MoE Layer 34</text>
</g>
<g id="clust36" class="cluster">
<title>cluster_moe_35</title>
<path fill="lightgray" stroke="black" d="M29,-23873.03C29,-23873.03 3779,-23873.03 3779,-23873.03 3785,-23873.03 3791,-23879.03 3791,-23885.03 3791,-23885.03 3791,-24767.11 3791,-24767.11 3791,-24773.11 3785,-24779.11 3779,-24779.11 3779,-24779.11 29,-24779.11 29,-24779.11 23,-24779.11 17,-24773.11 17,-24767.11 17,-24767.11 17,-23885.03 17,-23885.03 17,-23879.03 23,-23873.03 29,-23873.03"/>
<text text-anchor="middle" x="1904" y="-24763.91" font-family="Times,serif" font-size="14.00">MoE Layer 35</text>
</g>
<g id="clust37" class="cluster">
<title>cluster_moe_36</title>
<path fill="lightgray" stroke="black" d="M33,-22958.96C33,-22958.96 3783,-22958.96 3783,-22958.96 3789,-22958.96 3795,-22964.96 3795,-22970.96 3795,-22970.96 3795,-23853.03 3795,-23853.03 3795,-23859.03 3789,-23865.03 3783,-23865.03 3783,-23865.03 33,-23865.03 33,-23865.03 27,-23865.03 21,-23859.03 21,-23853.03 21,-23853.03 21,-22970.96 21,-22970.96 21,-22964.96 27,-22958.96 33,-22958.96"/>
<text text-anchor="middle" x="1908" y="-23849.83" font-family="Times,serif" font-size="14.00">MoE Layer 36</text>
</g>
<g id="clust38" class="cluster">
<title>cluster_moe_37</title>
<path fill="lightgray" stroke="black" d="M48,-22044.88C48,-22044.88 3798,-22044.88 3798,-22044.88 3804,-22044.88 3810,-22050.88 3810,-22056.88 3810,-22056.88 3810,-22938.96 3810,-22938.96 3810,-22944.96 3804,-22950.96 3798,-22950.96 3798,-22950.96 48,-22950.96 48,-22950.96 42,-22950.96 36,-22944.96 36,-22938.96 36,-22938.96 36,-22056.88 36,-22056.88 36,-22050.88 42,-22044.88 48,-22044.88"/>
<text text-anchor="middle" x="1923" y="-22935.76" font-family="Times,serif" font-size="14.00">MoE Layer 37</text>
</g>
<g id="clust39" class="cluster">
<title>cluster_moe_38</title>
<path fill="lightgray" stroke="black" d="M77,-21130.8C77,-21130.8 3827,-21130.8 3827,-21130.8 3833,-21130.8 3839,-21136.8 3839,-21142.8 3839,-21142.8 3839,-22024.88 3839,-22024.88 3839,-22030.88 3833,-22036.88 3827,-22036.88 3827,-22036.88 77,-22036.88 77,-22036.88 71,-22036.88 65,-22030.88 65,-22024.88 65,-22024.88 65,-21142.8 65,-21142.8 65,-21136.8 71,-21130.8 77,-21130.8"/>
<text text-anchor="middle" x="1952" y="-22021.68" font-family="Times,serif" font-size="14.00">MoE Layer 38</text>
</g>
<g id="clust40" class="cluster">
<title>cluster_moe_39</title>
<path fill="lightgray" stroke="black" d="M106,-20216.72C106,-20216.72 3856,-20216.72 3856,-20216.72 3862,-20216.72 3868,-20222.72 3868,-20228.72 3868,-20228.72 3868,-21110.8 3868,-21110.8 3868,-21116.8 3862,-21122.8 3856,-21122.8 3856,-21122.8 106,-21122.8 106,-21122.8 100,-21122.8 94,-21116.8 94,-21110.8 94,-21110.8 94,-20228.72 94,-20228.72 94,-20222.72 100,-20216.72 106,-20216.72"/>
<text text-anchor="middle" x="1981" y="-21107.6" font-family="Times,serif" font-size="14.00">MoE Layer 39</text>
</g>
<g id="clust41" class="cluster">
<title>cluster_moe_40</title>
<path fill="lightgray" stroke="black" d="M106,-19302.64C106,-19302.64 3856,-19302.64 3856,-19302.64 3862,-19302.64 3868,-19308.64 3868,-19314.64 3868,-19314.64 3868,-20196.72 3868,-20196.72 3868,-20202.72 3862,-20208.72 3856,-20208.72 3856,-20208.72 106,-20208.72 106,-20208.72 100,-20208.72 94,-20202.72 94,-20196.72 94,-20196.72 94,-19314.64 94,-19314.64 94,-19308.64 100,-19302.64 106,-19302.64"/>
<text text-anchor="middle" x="1981" y="-20193.52" font-family="Times,serif" font-size="14.00">MoE Layer 40</text>
</g>
<g id="clust42" class="cluster">
<title>cluster_moe_41</title>
<path fill="lightgray" stroke="black" d="M106,-18388.56C106,-18388.56 3856,-18388.56 3856,-18388.56 3862,-18388.56 3868,-18394.56 3868,-18400.56 3868,-18400.56 3868,-19282.64 3868,-19282.64 3868,-19288.64 3862,-19294.64 3856,-19294.64 3856,-19294.64 106,-19294.64 106,-19294.64 100,-19294.64 94,-19288.64 94,-19282.64 94,-19282.64 94,-18400.56 94,-18400.56 94,-18394.56 100,-18388.56 106,-18388.56"/>
<text text-anchor="middle" x="1981" y="-19279.44" font-family="Times,serif" font-size="14.00">MoE Layer 41</text>
</g>
<g id="clust43" class="cluster">
<title>cluster_moe_42</title>
<path fill="lightgray" stroke="black" d="M106,-17474.49C106,-17474.49 3856,-17474.49 3856,-17474.49 3862,-17474.49 3868,-17480.49 3868,-17486.49 3868,-17486.49 3868,-18368.56 3868,-18368.56 3868,-18374.56 3862,-18380.56 3856,-18380.56 3856,-18380.56 106,-18380.56 106,-18380.56 100,-18380.56 94,-18374.56 94,-18368.56 94,-18368.56 94,-17486.49 94,-17486.49 94,-17480.49 100,-17474.49 106,-17474.49"/>
<text text-anchor="middle" x="1981" y="-18365.36" font-family="Times,serif" font-size="14.00">MoE Layer 42</text>
</g>
<g id="clust44" class="cluster">
<title>cluster_moe_43</title>
<path fill="lightgray" stroke="black" d="M20,-16560.41C20,-16560.41 3770,-16560.41 3770,-16560.41 3776,-16560.41 3782,-16566.41 3782,-16572.41 3782,-16572.41 3782,-17454.49 3782,-17454.49 3782,-17460.49 3776,-17466.49 3770,-17466.49 3770,-17466.49 20,-17466.49 20,-17466.49 14,-17466.49 8,-17460.49 8,-17454.49 8,-17454.49 8,-16572.41 8,-16572.41 8,-16566.41 14,-16560.41 20,-16560.41"/>
<text text-anchor="middle" x="1895" y="-17451.29" font-family="Times,serif" font-size="14.00">MoE Layer 43</text>
</g>
<g id="clust45" class="cluster">
<title>cluster_moe_44</title>
<path fill="lightgray" stroke="black" d="M20,-15646.33C20,-15646.33 3770,-15646.33 3770,-15646.33 3776,-15646.33 3782,-15652.33 3782,-15658.33 3782,-15658.33 3782,-16540.41 3782,-16540.41 3782,-16546.41 3776,-16552.41 3770,-16552.41 3770,-16552.41 20,-16552.41 20,-16552.41 14,-16552.41 8,-16546.41 8,-16540.41 8,-16540.41 8,-15658.33 8,-15658.33 8,-15652.33 14,-15646.33 20,-15646.33"/>
<text text-anchor="middle" x="1895" y="-16537.21" font-family="Times,serif" font-size="14.00">MoE Layer 44</text>
</g>
<g id="clust46" class="cluster">
<title>cluster_moe_45</title>
<path fill="lightgray" stroke="black" d="M20,-14732.25C20,-14732.25 3770,-14732.25 3770,-14732.25 3776,-14732.25 3782,-14738.25 3782,-14744.25 3782,-14744.25 3782,-15626.33 3782,-15626.33 3782,-15632.33 3776,-15638.33 3770,-15638.33 3770,-15638.33 20,-15638.33 20,-15638.33 14,-15638.33 8,-15632.33 8,-15626.33 8,-15626.33 8,-14744.25 8,-14744.25 8,-14738.25 14,-14732.25 20,-14732.25"/>
<text text-anchor="middle" x="1895" y="-15623.13" font-family="Times,serif" font-size="14.00">MoE Layer 45</text>
</g>
<g id="clust47" class="cluster">
<title>cluster_moe_46</title>
<path fill="lightgray" stroke="black" d="M20,-13818.17C20,-13818.17 3770,-13818.17 3770,-13818.17 3776,-13818.17 3782,-13824.17 3782,-13830.17 3782,-13830.17 3782,-14712.25 3782,-14712.25 3782,-14718.25 3776,-14724.25 3770,-14724.25 3770,-14724.25 20,-14724.25 20,-14724.25 14,-14724.25 8,-14718.25 8,-14712.25 8,-14712.25 8,-13830.17 8,-13830.17 8,-13824.17 14,-13818.17 20,-13818.17"/>
<text text-anchor="middle" x="1895" y="-14709.05" font-family="Times,serif" font-size="14.00">MoE Layer 46</text>
</g>
<g id="clust48" class="cluster">
<title>cluster_moe_47</title>
<path fill="lightgray" stroke="black" d="M20,-12904.09C20,-12904.09 3770,-12904.09 3770,-12904.09 3776,-12904.09 3782,-12910.09 3782,-12916.09 3782,-12916.09 3782,-13798.17 3782,-13798.17 3782,-13804.17 3776,-13810.17 3770,-13810.17 3770,-13810.17 20,-13810.17 20,-13810.17 14,-13810.17 8,-13804.17 8,-13798.17 8,-13798.17 8,-12916.09 8,-12916.09 8,-12910.09 14,-12904.09 20,-12904.09"/>
<text text-anchor="middle" x="1895" y="-13794.97" font-family="Times,serif" font-size="14.00">MoE Layer 47</text>
</g>
<g id="clust49" class="cluster">
<title>cluster_moe_48</title>
<path fill="lightgray" stroke="black" d="M20,-11990.02C20,-11990.02 3770,-11990.02 3770,-11990.02 3776,-11990.02 3782,-11996.02 3782,-12002.02 3782,-12002.02 3782,-12884.09 3782,-12884.09 3782,-12890.09 3776,-12896.09 3770,-12896.09 3770,-12896.09 20,-12896.09 20,-12896.09 14,-12896.09 8,-12890.09 8,-12884.09 8,-12884.09 8,-12002.02 8,-12002.02 8,-11996.02 14,-11990.02 20,-11990.02"/>
<text text-anchor="middle" x="1895" y="-12880.89" font-family="Times,serif" font-size="14.00">MoE Layer 48</text>
</g>
<g id="clust50" class="cluster">
<title>cluster_moe_49</title>
<path fill="lightgray" stroke="black" d="M20,-11075.94C20,-11075.94 3770,-11075.94 3770,-11075.94 3776,-11075.94 3782,-11081.94 3782,-11087.94 3782,-11087.94 3782,-11970.02 3782,-11970.02 3782,-11976.02 3776,-11982.02 3770,-11982.02 3770,-11982.02 20,-11982.02 20,-11982.02 14,-11982.02 8,-11976.02 8,-11970.02 8,-11970.02 8,-11087.94 8,-11087.94 8,-11081.94 14,-11075.94 20,-11075.94"/>
<text text-anchor="middle" x="1895" y="-11966.82" font-family="Times,serif" font-size="14.00">MoE Layer 49</text>
</g>
<g id="clust51" class="cluster">
<title>cluster_moe_50</title>
<path fill="lightgray" stroke="black" d="M20,-10161.86C20,-10161.86 3770,-10161.86 3770,-10161.86 3776,-10161.86 3782,-10167.86 3782,-10173.86 3782,-10173.86 3782,-11055.94 3782,-11055.94 3782,-11061.94 3776,-11067.94 3770,-11067.94 3770,-11067.94 20,-11067.94 20,-11067.94 14,-11067.94 8,-11061.94 8,-11055.94 8,-11055.94 8,-10173.86 8,-10173.86 8,-10167.86 14,-10161.86 20,-10161.86"/>
<text text-anchor="middle" x="1895" y="-11052.74" font-family="Times,serif" font-size="14.00">MoE Layer 50</text>
</g>
<g id="clust52" class="cluster">
<title>cluster_moe_51</title>
<path fill="lightgray" stroke="black" d="M20,-9247.78C20,-9247.78 3770,-9247.78 3770,-9247.78 3776,-9247.78 3782,-9253.78 3782,-9259.78 3782,-9259.78 3782,-10141.86 3782,-10141.86 3782,-10147.86 3776,-10153.86 3770,-10153.86 3770,-10153.86 20,-10153.86 20,-10153.86 14,-10153.86 8,-10147.86 8,-10141.86 8,-10141.86 8,-9259.78 8,-9259.78 8,-9253.78 14,-9247.78 20,-9247.78"/>
<text text-anchor="middle" x="1895" y="-10138.66" font-family="Times,serif" font-size="14.00">MoE Layer 51</text>
</g>
<g id="clust53" class="cluster">
<title>cluster_moe_52</title>
<path fill="lightgray" stroke="black" d="M20,-8333.7C20,-8333.7 3770,-8333.7 3770,-8333.7 3776,-8333.7 3782,-8339.7 3782,-8345.7 3782,-8345.7 3782,-9227.78 3782,-9227.78 3782,-9233.78 3776,-9239.78 3770,-9239.78 3770,-9239.78 20,-9239.78 20,-9239.78 14,-9239.78 8,-9233.78 8,-9227.78 8,-9227.78 8,-8345.7 8,-8345.7 8,-8339.7 14,-8333.7 20,-8333.7"/>
<text text-anchor="middle" x="1895" y="-9224.58" font-family="Times,serif" font-size="14.00">MoE Layer 52</text>
</g>
<g id="clust54" class="cluster">
<title>cluster_moe_53</title>
<path fill="lightgray" stroke="black" d="M20,-7419.63C20,-7419.63 3770,-7419.63 3770,-7419.63 3776,-7419.63 3782,-7425.63 3782,-7431.63 3782,-7431.63 3782,-8313.7 3782,-8313.7 3782,-8319.7 3776,-8325.7 3770,-8325.7 3770,-8325.7 20,-8325.7 20,-8325.7 14,-8325.7 8,-8319.7 8,-8313.7 8,-8313.7 8,-7431.63 8,-7431.63 8,-7425.63 14,-7419.63 20,-7419.63"/>
<text text-anchor="middle" x="1895" y="-8310.5" font-family="Times,serif" font-size="14.00">MoE Layer 53</text>
</g>
<g id="clust55" class="cluster">
<title>cluster_moe_54</title>
<path fill="lightgray" stroke="black" d="M20,-6505.55C20,-6505.55 3770,-6505.55 3770,-6505.55 3776,-6505.55 3782,-6511.55 3782,-6517.55 3782,-6517.55 3782,-7399.63 3782,-7399.63 3782,-7405.63 3776,-7411.63 3770,-7411.63 3770,-7411.63 20,-7411.63 20,-7411.63 14,-7411.63 8,-7405.63 8,-7399.63 8,-7399.63 8,-6517.55 8,-6517.55 8,-6511.55 14,-6505.55 20,-6505.55"/>
<text text-anchor="middle" x="1895" y="-7396.43" font-family="Times,serif" font-size="14.00">MoE Layer 54</text>
</g>
<g id="clust56" class="cluster">
<title>cluster_moe_55</title>
<path fill="lightgray" stroke="black" d="M20,-5591.47C20,-5591.47 3770,-5591.47 3770,-5591.47 3776,-5591.47 3782,-5597.47 3782,-5603.47 3782,-5603.47 3782,-6485.55 3782,-6485.55 3782,-6491.55 3776,-6497.55 3770,-6497.55 3770,-6497.55 20,-6497.55 20,-6497.55 14,-6497.55 8,-6491.55 8,-6485.55 8,-6485.55 8,-5603.47 8,-5603.47 8,-5597.47 14,-5591.47 20,-5591.47"/>
<text text-anchor="middle" x="1895" y="-6482.35" font-family="Times,serif" font-size="14.00">MoE Layer 55</text>
</g>
<g id="clust57" class="cluster">
<title>cluster_moe_56</title>
<path fill="lightgray" stroke="black" d="M20,-4677.39C20,-4677.39 3770,-4677.39 3770,-4677.39 3776,-4677.39 3782,-4683.39 3782,-4689.39 3782,-4689.39 3782,-5571.47 3782,-5571.47 3782,-5577.47 3776,-5583.47 3770,-5583.47 3770,-5583.47 20,-5583.47 20,-5583.47 14,-5583.47 8,-5577.47 8,-5571.47 8,-5571.47 8,-4689.39 8,-4689.39 8,-4683.39 14,-4677.39 20,-4677.39"/>
<text text-anchor="middle" x="1895" y="-5568.27" font-family="Times,serif" font-size="14.00">MoE Layer 56</text>
</g>
<g id="clust58" class="cluster">
<title>cluster_moe_57</title>
<path fill="lightgray" stroke="black" d="M20,-3763.31C20,-3763.31 3770,-3763.31 3770,-3763.31 3776,-3763.31 3782,-3769.31 3782,-3775.31 3782,-3775.31 3782,-4657.39 3782,-4657.39 3782,-4663.39 3776,-4669.39 3770,-4669.39 3770,-4669.39 20,-4669.39 20,-4669.39 14,-4669.39 8,-4663.39 8,-4657.39 8,-4657.39 8,-3775.31 8,-3775.31 8,-3769.31 14,-3763.31 20,-3763.31"/>
<text text-anchor="middle" x="1895" y="-4654.19" font-family="Times,serif" font-size="14.00">MoE Layer 57</text>
</g>
<g id="clust59" class="cluster">
<title>cluster_moe_58</title>
<path fill="lightgray" stroke="black" d="M20,-2849.23C20,-2849.23 3770,-2849.23 3770,-2849.23 3776,-2849.23 3782,-2855.23 3782,-2861.23 3782,-2861.23 3782,-3743.31 3782,-3743.31 3782,-3749.31 3776,-3755.31 3770,-3755.31 3770,-3755.31 20,-3755.31 20,-3755.31 14,-3755.31 8,-3749.31 8,-3743.31 8,-3743.31 8,-2861.23 8,-2861.23 8,-2855.23 14,-2849.23 20,-2849.23"/>
<text text-anchor="middle" x="1895" y="-3740.11" font-family="Times,serif" font-size="14.00">MoE Layer 58</text>
</g>
<g id="clust60" class="cluster">
<title>cluster_moe_59</title>
<path fill="lightgray" stroke="black" d="M20,-1935.16C20,-1935.16 3770,-1935.16 3770,-1935.16 3776,-1935.16 3782,-1941.16 3782,-1947.16 3782,-1947.16 3782,-2829.23 3782,-2829.23 3782,-2835.23 3776,-2841.23 3770,-2841.23 3770,-2841.23 20,-2841.23 20,-2841.23 14,-2841.23 8,-2835.23 8,-2829.23 8,-2829.23 8,-1947.16 8,-1947.16 8,-1941.16 14,-1935.16 20,-1935.16"/>
<text text-anchor="middle" x="1895" y="-2826.03" font-family="Times,serif" font-size="14.00">MoE Layer 59</text>
</g>
<g id="clust61" class="cluster">
<title>cluster_moe_60</title>
<path fill="lightgray" stroke="black" d="M20,-1021.08C20,-1021.08 3770,-1021.08 3770,-1021.08 3776,-1021.08 3782,-1027.08 3782,-1033.08 3782,-1033.08 3782,-1915.16 3782,-1915.16 3782,-1921.16 3776,-1927.16 3770,-1927.16 3770,-1927.16 20,-1927.16 20,-1927.16 14,-1927.16 8,-1921.16 8,-1915.16 8,-1915.16 8,-1033.08 8,-1033.08 8,-1027.08 14,-1021.08 20,-1021.08"/>
<text text-anchor="middle" x="1895" y="-1911.96" font-family="Times,serif" font-size="14.00">MoE Layer 60</text>
</g>
<g id="clust62" class="cluster">
<title>cluster_moe_61</title>
<path fill="lightgray" stroke="black" d="M20,-107C20,-107 3770,-107 3770,-107 3776,-107 3782,-113 3782,-119 3782,-119 3782,-1001.08 3782,-1001.08 3782,-1007.08 3776,-1013.08 3770,-1013.08 3770,-1013.08 20,-1013.08 20,-1013.08 14,-1013.08 8,-1007.08 8,-1001.08 8,-1001.08 8,-119 8,-119 8,-113 14,-107 20,-107"/>
<text text-anchor="middle" x="1895" y="-997.88" font-family="Times,serif" font-size="14.00">MoE Layer 61</text>
</g>
<g id="clust63" class="cluster">
<title>cluster_output</title>
<path fill="lightgray" stroke="black" d="M1741,-8C1741,-8 2049,-8 2049,-8 2055,-8 2061,-14 2061,-20 2061,-20 2061,-87 2061,-87 2061,-93 2055,-99 2049,-99 2049,-99 1741,-99 1741,-99 1735,-99 1729,-93 1729,-87 1729,-87 1729,-20 1729,-20 1729,-14 1735,-8 1741,-8"/>
<text text-anchor="middle" x="1895" y="-83.8" font-family="Times,serif" font-size="14.00">Output Layer</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="2053,-54584.54 1737,-54584.54 1737,-54532.54 2053,-54532.54 2053,-54584.54"/>
<text text-anchor="middle" x="1895" y="-54572.54" font-family="Arial" font-size="10.00">INPUT</text>
<text text-anchor="middle" x="1895" y="-54561.54" font-family="Arial" font-size="10.00">GPU: Host</text>
<text text-anchor="middle" x="1895" y="-54550.54" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-54539.54" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- dense_1_mha -->
<g id="node2" class="node">
<title>dense_1_mha</title>
<polygon fill="lightgreen" stroke="black" points="2053,-54485.54 1737,-54485.54 1737,-54433.54 2053,-54433.54 2053,-54485.54"/>
<text text-anchor="middle" x="1895" y="-54473.54" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1895" y="-54462.54" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-54451.54" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-54440.54" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- input&#45;&gt;dense_1_mha -->
<g id="edge1" class="edge">
<title>input&#45;&gt;dense_1_mha</title>
<path fill="none" stroke="black" d="M1895,-54532.3C1895,-54521.19 1895,-54507.94 1895,-54495.87"/>
<polygon fill="black" stroke="black" points="1898.5,-54495.64 1895,-54485.64 1891.5,-54495.64 1898.5,-54495.64"/>
</g>
<!-- dense_1_res1 -->
<g id="node4" class="node">
<title>dense_1_res1</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-54397.54 1695.97,-54397.54 1558.11,-54293.54 2094.03,-54293.54 2231.89,-54397.54"/>
<text text-anchor="middle" x="1895" y="-54359.54" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1895" y="-54348.54" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-54337.54" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-54326.54" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- dense_1_mha&#45;&gt;dense_1_res1 -->
<g id="edge2" class="edge">
<title>dense_1_mha&#45;&gt;dense_1_res1</title>
<path fill="none" stroke="black" d="M1895,-54433.4C1895,-54425.72 1895,-54416.9 1895,-54407.9"/>
<polygon fill="black" stroke="black" points="1898.5,-54407.71 1895,-54397.71 1891.5,-54407.71 1898.5,-54407.71"/>
</g>
<!-- dense_1_ffn -->
<g id="node3" class="node">
<title>dense_1_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2053,-54257.54 1737,-54257.54 1737,-54205.54 2053,-54205.54 2053,-54257.54"/>
<text text-anchor="middle" x="1895" y="-54245.54" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1895" y="-54234.54" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-54223.54" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-54212.54" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- dense_1_res2 -->
<g id="node5" class="node">
<title>dense_1_res2</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-54169.54 1695.97,-54169.54 1558.11,-54065.54 2094.03,-54065.54 2231.89,-54169.54"/>
<text text-anchor="middle" x="1895" y="-54131.54" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1895" y="-54120.54" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-54109.54" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-54098.54" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- dense_1_ffn&#45;&gt;dense_1_res2 -->
<g id="edge4" class="edge">
<title>dense_1_ffn&#45;&gt;dense_1_res2</title>
<path fill="none" stroke="black" d="M1895,-54205.4C1895,-54197.72 1895,-54188.9 1895,-54179.9"/>
<polygon fill="black" stroke="black" points="1898.5,-54179.71 1895,-54169.71 1891.5,-54179.71 1898.5,-54179.71"/>
</g>
<!-- dense_1_res1&#45;&gt;dense_1_ffn -->
<g id="edge3" class="edge">
<title>dense_1_res1&#45;&gt;dense_1_ffn</title>
<path fill="none" stroke="black" d="M1895,-54293.45C1895,-54284.79 1895,-54275.96 1895,-54267.82"/>
<polygon fill="black" stroke="black" points="1898.5,-54267.58 1895,-54257.58 1891.5,-54267.58 1898.5,-54267.58"/>
</g>
<!-- dense_2_mha -->
<g id="node6" class="node">
<title>dense_2_mha</title>
<polygon fill="lightgreen" stroke="black" points="2053,-54018.54 1737,-54018.54 1737,-53966.54 2053,-53966.54 2053,-54018.54"/>
<text text-anchor="middle" x="1895" y="-54006.54" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1895" y="-53995.54" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-53984.54" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-53973.54" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- dense_1_res2&#45;&gt;dense_2_mha -->
<g id="edge5" class="edge">
<title>dense_1_res2&#45;&gt;dense_2_mha</title>
<path fill="none" stroke="black" d="M1895,-54065.44C1895,-54053.11 1895,-54040.21 1895,-54028.79"/>
<polygon fill="black" stroke="black" points="1898.5,-54028.78 1895,-54018.78 1891.5,-54028.78 1898.5,-54028.78"/>
</g>
<!-- dense_2_res1 -->
<g id="node8" class="node">
<title>dense_2_res1</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-53930.54 1695.97,-53930.54 1558.11,-53826.54 2094.03,-53826.54 2231.89,-53930.54"/>
<text text-anchor="middle" x="1895" y="-53892.54" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1895" y="-53881.54" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-53870.54" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-53859.54" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- dense_2_mha&#45;&gt;dense_2_res1 -->
<g id="edge6" class="edge">
<title>dense_2_mha&#45;&gt;dense_2_res1</title>
<path fill="none" stroke="black" d="M1895,-53966.4C1895,-53958.72 1895,-53949.9 1895,-53940.9"/>
<polygon fill="black" stroke="black" points="1898.5,-53940.71 1895,-53930.71 1891.5,-53940.71 1898.5,-53940.71"/>
</g>
<!-- dense_2_ffn -->
<g id="node7" class="node">
<title>dense_2_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2053,-53790.54 1737,-53790.54 1737,-53738.54 2053,-53738.54 2053,-53790.54"/>
<text text-anchor="middle" x="1895" y="-53778.54" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1895" y="-53767.54" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-53756.54" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-53745.54" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- dense_2_res2 -->
<g id="node9" class="node">
<title>dense_2_res2</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-53702.54 1695.97,-53702.54 1558.11,-53598.54 2094.03,-53598.54 2231.89,-53702.54"/>
<text text-anchor="middle" x="1895" y="-53664.54" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1895" y="-53653.54" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-53642.54" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-53631.54" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- dense_2_ffn&#45;&gt;dense_2_res2 -->
<g id="edge8" class="edge">
<title>dense_2_ffn&#45;&gt;dense_2_res2</title>
<path fill="none" stroke="black" d="M1895,-53738.4C1895,-53730.72 1895,-53721.9 1895,-53712.9"/>
<polygon fill="black" stroke="black" points="1898.5,-53712.71 1895,-53702.71 1891.5,-53712.71 1898.5,-53712.71"/>
</g>
<!-- dense_2_res1&#45;&gt;dense_2_ffn -->
<g id="edge7" class="edge">
<title>dense_2_res1&#45;&gt;dense_2_ffn</title>
<path fill="none" stroke="black" d="M1895,-53826.45C1895,-53817.79 1895,-53808.96 1895,-53800.82"/>
<polygon fill="black" stroke="black" points="1898.5,-53800.58 1895,-53790.58 1891.5,-53800.58 1898.5,-53800.58"/>
</g>
<!-- dense_3_mha -->
<g id="node10" class="node">
<title>dense_3_mha</title>
<polygon fill="lightgreen" stroke="black" points="2053,-53551.54 1737,-53551.54 1737,-53499.54 2053,-53499.54 2053,-53551.54"/>
<text text-anchor="middle" x="1895" y="-53539.54" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1895" y="-53528.54" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-53517.54" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-53506.54" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- dense_2_res2&#45;&gt;dense_3_mha -->
<g id="edge9" class="edge">
<title>dense_2_res2&#45;&gt;dense_3_mha</title>
<path fill="none" stroke="black" d="M1895,-53598.44C1895,-53586.11 1895,-53573.21 1895,-53561.79"/>
<polygon fill="black" stroke="black" points="1898.5,-53561.78 1895,-53551.78 1891.5,-53561.78 1898.5,-53561.78"/>
</g>
<!-- dense_3_res1 -->
<g id="node12" class="node">
<title>dense_3_res1</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-53463.54 1695.97,-53463.54 1558.11,-53359.54 2094.03,-53359.54 2231.89,-53463.54"/>
<text text-anchor="middle" x="1895" y="-53425.54" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1895" y="-53414.54" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-53403.54" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-53392.54" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- dense_3_mha&#45;&gt;dense_3_res1 -->
<g id="edge10" class="edge">
<title>dense_3_mha&#45;&gt;dense_3_res1</title>
<path fill="none" stroke="black" d="M1895,-53499.4C1895,-53491.72 1895,-53482.9 1895,-53473.9"/>
<polygon fill="black" stroke="black" points="1898.5,-53473.71 1895,-53463.71 1891.5,-53473.71 1898.5,-53473.71"/>
</g>
<!-- dense_3_ffn -->
<g id="node11" class="node">
<title>dense_3_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2053,-53323.54 1737,-53323.54 1737,-53271.54 2053,-53271.54 2053,-53323.54"/>
<text text-anchor="middle" x="1895" y="-53311.54" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1895" y="-53300.54" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-53289.54" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-53278.54" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- dense_3_res2 -->
<g id="node13" class="node">
<title>dense_3_res2</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-53235.54 1695.97,-53235.54 1558.11,-53131.54 2094.03,-53131.54 2231.89,-53235.54"/>
<text text-anchor="middle" x="1895" y="-53197.54" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1895" y="-53186.54" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-53175.54" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-53164.54" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- dense_3_ffn&#45;&gt;dense_3_res2 -->
<g id="edge12" class="edge">
<title>dense_3_ffn&#45;&gt;dense_3_res2</title>
<path fill="none" stroke="black" d="M1895,-53271.4C1895,-53263.72 1895,-53254.9 1895,-53245.9"/>
<polygon fill="black" stroke="black" points="1898.5,-53245.71 1895,-53235.71 1891.5,-53245.71 1898.5,-53245.71"/>
</g>
<!-- dense_3_res1&#45;&gt;dense_3_ffn -->
<g id="edge11" class="edge">
<title>dense_3_res1&#45;&gt;dense_3_ffn</title>
<path fill="none" stroke="black" d="M1895,-53359.45C1895,-53350.79 1895,-53341.96 1895,-53333.82"/>
<polygon fill="black" stroke="black" points="1898.5,-53333.58 1895,-53323.58 1891.5,-53333.58 1898.5,-53333.58"/>
</g>
<!-- moe_4_mha -->
<g id="node14" class="node">
<title>moe_4_mha</title>
<polygon fill="lightgreen" stroke="black" points="2053,-53084.54 1737,-53084.54 1737,-53032.54 2053,-53032.54 2053,-53084.54"/>
<text text-anchor="middle" x="1895" y="-53072.54" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1895" y="-53061.54" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-53050.54" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-53039.54" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- dense_3_res2&#45;&gt;moe_4_mha -->
<g id="edge13" class="edge">
<title>dense_3_res2&#45;&gt;moe_4_mha</title>
<path fill="none" stroke="black" d="M1895,-53131.44C1895,-53119.11 1895,-53106.21 1895,-53094.79"/>
<polygon fill="black" stroke="black" points="1898.5,-53094.78 1895,-53084.78 1891.5,-53094.78 1898.5,-53094.78"/>
</g>
<!-- moe_4_res1 -->
<g id="node35" class="node">
<title>moe_4_res1</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-52996.54 1695.97,-52996.54 1558.11,-52892.54 2094.03,-52892.54 2231.89,-52996.54"/>
<text text-anchor="middle" x="1895" y="-52958.54" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1895" y="-52947.54" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-52936.54" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-52925.54" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_4_mha&#45;&gt;moe_4_res1 -->
<g id="edge14" class="edge">
<title>moe_4_mha&#45;&gt;moe_4_res1</title>
<path fill="none" stroke="black" d="M1895,-53032.4C1895,-53024.72 1895,-53015.9 1895,-53006.9"/>
<polygon fill="black" stroke="black" points="1898.5,-53006.71 1895,-52996.71 1891.5,-53006.71 1898.5,-53006.71"/>
</g>
<!-- moe_4_gate -->
<g id="node15" class="node">
<title>moe_4_gate</title>
<polygon fill="lightyellow" stroke="black" points="2223.8,-52856.54 1700.75,-52856.54 1566.2,-52752.54 2089.25,-52752.54 2223.8,-52856.54"/>
<text text-anchor="middle" x="1895" y="-52818.54" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1895" y="-52807.54" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-52796.54" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-52785.54" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_4_route -->
<g id="node16" class="node">
<title>moe_4_route</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-52679.77" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-52693.77" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1895" y="-52682.77" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-52671.77" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-52660.77" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_4_gate&#45;&gt;moe_4_route -->
<g id="edge16" class="edge">
<title>moe_4_gate&#45;&gt;moe_4_route</title>
<path fill="none" stroke="black" d="M1895,-52752.18C1895,-52743.77 1895,-52735.11 1895,-52726.84"/>
<polygon fill="black" stroke="black" points="1898.5,-52726.62 1895,-52716.62 1891.5,-52726.62 1898.5,-52726.62"/>
</g>
<!-- moe_4_expert_0 -->
<g id="node17" class="node">
<title>moe_4_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-52607 16,-52607 16,-52555 234,-52555 234,-52607"/>
<text text-anchor="middle" x="125" y="-52595" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-52584" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-52573" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-52562" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_4_route&#45;&gt;moe_4_expert_0 -->
<g id="edge17" class="edge">
<title>moe_4_route&#45;&gt;moe_4_expert_0</title>
<path fill="none" stroke="black" d="M1679.93,-52673.85C1302.11,-52664.48 532.75,-52641.94 244.24,-52607.04"/>
<polygon fill="black" stroke="black" points="244.54,-52603.55 234.18,-52605.79 243.68,-52610.5 244.54,-52603.55"/>
</g>
<!-- moe_4_expert_1 -->
<g id="node18" class="node">
<title>moe_4_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-52607 252,-52607 252,-52555 470,-52555 470,-52607"/>
<text text-anchor="middle" x="361" y="-52595" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-52584" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-52573" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-52562" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_4_route&#45;&gt;moe_4_expert_1 -->
<g id="edge18" class="edge">
<title>moe_4_route&#45;&gt;moe_4_expert_1</title>
<path fill="none" stroke="black" d="M1677.23,-52678.39C1400.57,-52675.48 908.56,-52662.23 480.29,-52607.07"/>
<polygon fill="black" stroke="black" points="480.55,-52603.58 470.19,-52605.76 479.65,-52610.52 480.55,-52603.58"/>
</g>
<!-- moe_4_expert_2 -->
<g id="node19" class="node">
<title>moe_4_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-52607 488,-52607 488,-52555 706,-52555 706,-52607"/>
<text text-anchor="middle" x="597" y="-52595" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-52584" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-52573" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-52562" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_4_route&#45;&gt;moe_4_expert_2 -->
<g id="edge19" class="edge">
<title>moe_4_route&#45;&gt;moe_4_expert_2</title>
<path fill="none" stroke="black" d="M1678.74,-52675.2C1443.7,-52669.12 1057.2,-52652.68 716.26,-52607.08"/>
<polygon fill="black" stroke="black" points="716.57,-52603.59 706.19,-52605.73 715.63,-52610.53 716.57,-52603.59"/>
</g>
<!-- moe_4_expert_3 -->
<g id="node20" class="node">
<title>moe_4_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-52607 724,-52607 724,-52555 942,-52555 942,-52607"/>
<text text-anchor="middle" x="833" y="-52595" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-52584" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-52573" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-52562" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_4_route&#45;&gt;moe_4_expert_3 -->
<g id="edge20" class="edge">
<title>moe_4_route&#45;&gt;moe_4_expert_3</title>
<path fill="none" stroke="black" d="M1683.7,-52670.74C1494.33,-52661.67 1209,-52643.36 952.47,-52607.13"/>
<polygon fill="black" stroke="black" points="952.59,-52603.61 942.2,-52605.67 951.61,-52610.54 952.59,-52603.61"/>
</g>
<!-- moe_4_expert_4 -->
<g id="node21" class="node">
<title>moe_4_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-52607 960,-52607 960,-52555 1178,-52555 1178,-52607"/>
<text text-anchor="middle" x="1069" y="-52595" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-52584" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-52573" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-52562" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_4_route&#45;&gt;moe_4_expert_4 -->
<g id="edge21" class="edge">
<title>moe_4_route&#45;&gt;moe_4_expert_4</title>
<path fill="none" stroke="black" d="M1696.66,-52664.41C1556.96,-52652.93 1365.46,-52634.43 1188.25,-52607.13"/>
<polygon fill="black" stroke="black" points="1188.63,-52603.64 1178.21,-52605.57 1187.56,-52610.56 1188.63,-52603.64"/>
</g>
<!-- moe_4_expert_5 -->
<g id="node22" class="node">
<title>moe_4_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-52607 1196,-52607 1196,-52555 1414,-52555 1414,-52607"/>
<text text-anchor="middle" x="1305" y="-52595" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-52584" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-52573" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-52562" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_4_route&#45;&gt;moe_4_expert_5 -->
<g id="edge22" class="edge">
<title>moe_4_route&#45;&gt;moe_4_expert_5</title>
<path fill="none" stroke="black" d="M1728.87,-52655.9C1640.99,-52643.23 1531.11,-52626.45 1424.25,-52607.19"/>
<polygon fill="black" stroke="black" points="1424.71,-52603.71 1414.25,-52605.38 1423.46,-52610.6 1424.71,-52603.71"/>
</g>
<!-- moe_4_expert_6 -->
<g id="node23" class="node">
<title>moe_4_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-52607 1432,-52607 1432,-52555 1650,-52555 1650,-52607"/>
<text text-anchor="middle" x="1541" y="-52595" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-52584" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-52573" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-52562" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_4_route&#45;&gt;moe_4_expert_6 -->
<g id="edge23" class="edge">
<title>moe_4_route&#45;&gt;moe_4_expert_6</title>
<path fill="none" stroke="black" d="M1782.99,-52648.15C1737.98,-52635.84 1686.47,-52621.76 1642.56,-52609.76"/>
<polygon fill="black" stroke="black" points="1643.31,-52606.34 1632.74,-52607.08 1641.46,-52613.09 1643.31,-52606.34"/>
</g>
<!-- moe_4_expert_7 -->
<g id="node24" class="node">
<title>moe_4_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-52607 1668,-52607 1668,-52555 1886,-52555 1886,-52607"/>
<text text-anchor="middle" x="1777" y="-52595" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-52584" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-52573" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-52562" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_4_route&#45;&gt;moe_4_expert_7 -->
<g id="edge24" class="edge">
<title>moe_4_route&#45;&gt;moe_4_expert_7</title>
<path fill="none" stroke="black" d="M1852.07,-52643.56C1840.07,-52633.72 1827.12,-52623.1 1815.41,-52613.49"/>
<polygon fill="black" stroke="black" points="1817.47,-52610.66 1807.52,-52607.03 1813.04,-52616.08 1817.47,-52610.66"/>
</g>
<!-- moe_4_expert_8 -->
<g id="node25" class="node">
<title>moe_4_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-52607 1904,-52607 1904,-52555 2122,-52555 2122,-52607"/>
<text text-anchor="middle" x="2013" y="-52595" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-52584" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-52573" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-52562" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_4_route&#45;&gt;moe_4_expert_8 -->
<g id="edge25" class="edge">
<title>moe_4_route&#45;&gt;moe_4_expert_8</title>
<path fill="none" stroke="black" d="M1937.93,-52643.56C1949.93,-52633.72 1962.88,-52623.1 1974.59,-52613.49"/>
<polygon fill="black" stroke="black" points="1976.96,-52616.08 1982.48,-52607.03 1972.53,-52610.66 1976.96,-52616.08"/>
</g>
<!-- moe_4_expert_9 -->
<g id="node26" class="node">
<title>moe_4_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-52607 2140,-52607 2140,-52555 2358,-52555 2358,-52607"/>
<text text-anchor="middle" x="2249" y="-52595" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-52584" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-52573" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-52562" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_4_route&#45;&gt;moe_4_expert_9 -->
<g id="edge26" class="edge">
<title>moe_4_route&#45;&gt;moe_4_expert_9</title>
<path fill="none" stroke="black" d="M2007.01,-52648.15C2052.02,-52635.84 2103.53,-52621.76 2147.44,-52609.76"/>
<polygon fill="black" stroke="black" points="2148.54,-52613.09 2157.26,-52607.08 2146.69,-52606.34 2148.54,-52613.09"/>
</g>
<!-- moe_4_expert_10 -->
<g id="node27" class="node">
<title>moe_4_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-52607 2376,-52607 2376,-52555 2594,-52555 2594,-52607"/>
<text text-anchor="middle" x="2485" y="-52595" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-52584" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-52573" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-52562" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_4_route&#45;&gt;moe_4_expert_10 -->
<g id="edge27" class="edge">
<title>moe_4_route&#45;&gt;moe_4_expert_10</title>
<path fill="none" stroke="black" d="M2061.13,-52655.9C2149.01,-52643.23 2258.89,-52626.45 2365.75,-52607.19"/>
<polygon fill="black" stroke="black" points="2366.54,-52610.6 2375.75,-52605.38 2365.29,-52603.71 2366.54,-52610.6"/>
</g>
<!-- moe_4_expert_11 -->
<g id="node28" class="node">
<title>moe_4_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-52607 2612,-52607 2612,-52555 2830,-52555 2830,-52607"/>
<text text-anchor="middle" x="2721" y="-52595" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-52584" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-52573" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-52562" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_4_route&#45;&gt;moe_4_expert_11 -->
<g id="edge28" class="edge">
<title>moe_4_route&#45;&gt;moe_4_expert_11</title>
<path fill="none" stroke="black" d="M2093.34,-52664.41C2233.04,-52652.93 2424.54,-52634.43 2601.75,-52607.13"/>
<polygon fill="black" stroke="black" points="2602.44,-52610.56 2611.79,-52605.57 2601.37,-52603.64 2602.44,-52610.56"/>
</g>
<!-- moe_4_expert_12 -->
<g id="node29" class="node">
<title>moe_4_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-52607 2848,-52607 2848,-52555 3066,-52555 3066,-52607"/>
<text text-anchor="middle" x="2957" y="-52595" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-52584" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-52573" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-52562" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_4_route&#45;&gt;moe_4_expert_12 -->
<g id="edge29" class="edge">
<title>moe_4_route&#45;&gt;moe_4_expert_12</title>
<path fill="none" stroke="black" d="M2106.3,-52670.74C2295.67,-52661.67 2581,-52643.36 2837.53,-52607.13"/>
<polygon fill="black" stroke="black" points="2838.39,-52610.54 2847.8,-52605.67 2837.41,-52603.61 2838.39,-52610.54"/>
</g>
<!-- moe_4_expert_13 -->
<g id="node30" class="node">
<title>moe_4_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-52607 3084,-52607 3084,-52555 3302,-52555 3302,-52607"/>
<text text-anchor="middle" x="3193" y="-52595" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-52584" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-52573" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-52562" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_4_route&#45;&gt;moe_4_expert_13 -->
<g id="edge30" class="edge">
<title>moe_4_route&#45;&gt;moe_4_expert_13</title>
<path fill="none" stroke="black" d="M2111.26,-52675.2C2346.3,-52669.12 2732.8,-52652.68 3073.74,-52607.08"/>
<polygon fill="black" stroke="black" points="3074.37,-52610.53 3083.81,-52605.73 3073.43,-52603.59 3074.37,-52610.53"/>
</g>
<!-- moe_4_expert_14 -->
<g id="node31" class="node">
<title>moe_4_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-52607 3320,-52607 3320,-52555 3538,-52555 3538,-52607"/>
<text text-anchor="middle" x="3429" y="-52595" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-52584" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-52573" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-52562" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_4_route&#45;&gt;moe_4_expert_14 -->
<g id="edge31" class="edge">
<title>moe_4_route&#45;&gt;moe_4_expert_14</title>
<path fill="none" stroke="black" d="M2112.77,-52678.39C2389.43,-52675.48 2881.44,-52662.23 3309.71,-52607.07"/>
<polygon fill="black" stroke="black" points="3310.35,-52610.52 3319.81,-52605.76 3309.45,-52603.58 3310.35,-52610.52"/>
</g>
<!-- moe_4_expert_15 -->
<g id="node32" class="node">
<title>moe_4_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-52607 3556,-52607 3556,-52555 3774,-52555 3774,-52607"/>
<text text-anchor="middle" x="3665" y="-52595" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-52584" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-52573" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-52562" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_4_route&#45;&gt;moe_4_expert_15 -->
<g id="edge32" class="edge">
<title>moe_4_route&#45;&gt;moe_4_expert_15</title>
<path fill="none" stroke="black" d="M2110.07,-52673.85C2487.89,-52664.48 3257.25,-52641.94 3545.76,-52607.04"/>
<polygon fill="black" stroke="black" points="3546.32,-52610.5 3555.82,-52605.79 3545.46,-52603.55 3546.32,-52610.5"/>
</g>
<!-- moe_4_aggregate -->
<g id="node33" class="node">
<title>moe_4_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1791" cy="-52482.23" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1791" y="-52496.23" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1791" y="-52485.23" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1791" y="-52474.23" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1791" y="-52463.23" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_4_expert_0&#45;&gt;moe_4_aggregate -->
<g id="edge33" class="edge">
<title>moe_4_expert_0&#45;&gt;moe_4_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-52556.21C237.15,-52555.78 240.09,-52555.37 243,-52555 490.77,-52523.22 1193.62,-52499.78 1560.95,-52489.3"/>
<polygon fill="black" stroke="black" points="1561.29,-52492.79 1571.18,-52489.01 1561.09,-52485.8 1561.29,-52492.79"/>
</g>
<!-- moe_4_expert_1&#45;&gt;moe_4_aggregate -->
<g id="edge34" class="edge">
<title>moe_4_expert_1&#45;&gt;moe_4_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-52556.25C473.15,-52555.8 476.09,-52555.38 479,-52555 854.51,-52505.25 1294.89,-52489.84 1557.98,-52485.16"/>
<polygon fill="black" stroke="black" points="1558.11,-52488.66 1568.05,-52484.98 1557.99,-52481.66 1558.11,-52488.66"/>
</g>
<!-- moe_4_expert_2&#45;&gt;moe_4_aggregate -->
<g id="edge35" class="edge">
<title>moe_4_expert_2&#45;&gt;moe_4_aggregate</title>
<path fill="none" stroke="black" d="M706.19,-52556.29C709.16,-52555.83 712.1,-52555.4 715,-52555 1004.91,-52514.82 1342,-52496.95 1560.54,-52489.13"/>
<polygon fill="black" stroke="black" points="1560.98,-52492.61 1570.85,-52488.76 1560.73,-52485.62 1560.98,-52492.61"/>
</g>
<!-- moe_4_expert_3&#45;&gt;moe_4_aggregate -->
<g id="edge36" class="edge">
<title>moe_4_expert_3&#45;&gt;moe_4_aggregate</title>
<path fill="none" stroke="black" d="M942.21,-52556.36C945.16,-52555.88 948.1,-52555.43 951,-52555 1159.5,-52524.12 1399.23,-52505.27 1569.08,-52494.69"/>
<polygon fill="black" stroke="black" points="1569.38,-52498.18 1579.15,-52494.07 1568.95,-52491.19 1569.38,-52498.18"/>
</g>
<!-- moe_4_expert_4&#45;&gt;moe_4_aggregate -->
<g id="edge37" class="edge">
<title>moe_4_expert_4&#45;&gt;moe_4_aggregate</title>
<path fill="none" stroke="black" d="M1178.23,-52556.49C1181.18,-52555.97 1184.11,-52555.47 1187,-52555 1320.76,-52532.93 1472.27,-52514.94 1590.08,-52502.5"/>
<polygon fill="black" stroke="black" points="1590.71,-52505.95 1600.29,-52501.42 1589.98,-52498.99 1590.71,-52505.95"/>
</g>
<!-- moe_4_expert_5&#45;&gt;moe_4_aggregate -->
<g id="edge38" class="edge">
<title>moe_4_expert_5&#45;&gt;moe_4_aggregate</title>
<path fill="none" stroke="black" d="M1414.28,-52556.78C1417.22,-52556.18 1420.13,-52555.58 1423,-52555 1493.53,-52540.65 1571.79,-52525.31 1637.94,-52512.5"/>
<polygon fill="black" stroke="black" points="1638.87,-52515.89 1648.03,-52510.55 1637.54,-52509.02 1638.87,-52515.89"/>
</g>
<!-- moe_4_expert_6&#45;&gt;moe_4_aggregate -->
<g id="edge39" class="edge">
<title>moe_4_expert_6&#45;&gt;moe_4_aggregate</title>
<path fill="none" stroke="black" d="M1605.71,-52554.95C1633.12,-52544.34 1665.62,-52531.76 1695.69,-52520.12"/>
<polygon fill="black" stroke="black" points="1697.3,-52523.25 1705.36,-52516.38 1694.77,-52516.72 1697.3,-52523.25"/>
</g>
<!-- moe_4_expert_7&#45;&gt;moe_4_aggregate -->
<g id="edge40" class="edge">
<title>moe_4_expert_7&#45;&gt;moe_4_aggregate</title>
<path fill="none" stroke="black" d="M1780.64,-52554.82C1781.77,-52547.02 1783.05,-52538.15 1784.32,-52529.38"/>
<polygon fill="black" stroke="black" points="1787.83,-52529.6 1785.8,-52519.2 1780.9,-52528.6 1787.83,-52529.6"/>
</g>
<!-- moe_4_expert_8&#45;&gt;moe_4_aggregate -->
<g id="edge41" class="edge">
<title>moe_4_expert_8&#45;&gt;moe_4_aggregate</title>
<path fill="none" stroke="black" d="M1955.54,-52554.95C1931.75,-52544.58 1903.65,-52532.33 1877.46,-52520.92"/>
<polygon fill="black" stroke="black" points="1878.86,-52517.71 1868.29,-52516.92 1876.06,-52524.12 1878.86,-52517.71"/>
</g>
<!-- moe_4_expert_9&#45;&gt;moe_4_aggregate -->
<g id="edge42" class="edge">
<title>moe_4_expert_9&#45;&gt;moe_4_aggregate</title>
<path fill="none" stroke="black" d="M2139.71,-52556.84C2136.78,-52556.22 2133.87,-52555.6 2131,-52555 2066.98,-52541.46 1996.18,-52526.51 1935.83,-52513.77"/>
<polygon fill="black" stroke="black" points="1936.36,-52510.31 1925.85,-52511.67 1934.92,-52517.16 1936.36,-52510.31"/>
</g>
<!-- moe_4_expert_10&#45;&gt;moe_4_aggregate -->
<g id="edge43" class="edge">
<title>moe_4_expert_10&#45;&gt;moe_4_aggregate</title>
<path fill="none" stroke="black" d="M2375.77,-52556.51C2372.82,-52555.99 2369.89,-52555.48 2367,-52555 2241.35,-52533.9 2099.31,-52516.13 1987.73,-52503.56"/>
<polygon fill="black" stroke="black" points="1988.03,-52500.07 1977.71,-52502.43 1987.25,-52507.03 1988.03,-52500.07"/>
</g>
<!-- moe_4_expert_11&#45;&gt;moe_4_aggregate -->
<g id="edge44" class="edge">
<title>moe_4_expert_11&#45;&gt;moe_4_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-52556.38C2608.83,-52555.89 2605.9,-52555.43 2603,-52555 2403.87,-52525.21 2175.28,-52506.37 2011.48,-52495.5"/>
<polygon fill="black" stroke="black" points="2011.49,-52491.99 2001.28,-52494.83 2011.03,-52498.98 2011.49,-52491.99"/>
</g>
<!-- moe_4_expert_12&#45;&gt;moe_4_aggregate -->
<g id="edge45" class="edge">
<title>moe_4_expert_12&#45;&gt;moe_4_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-52556.3C2844.84,-52555.84 2841.9,-52555.4 2839,-52555 2558.85,-52515.93 2233.48,-52497.85 2020.51,-52489.68"/>
<polygon fill="black" stroke="black" points="2020.58,-52486.18 2010.46,-52489.3 2020.32,-52493.17 2020.58,-52486.18"/>
</g>
<!-- moe_4_expert_13&#45;&gt;moe_4_aggregate -->
<g id="edge46" class="edge">
<title>moe_4_expert_13&#45;&gt;moe_4_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-52556.25C3080.85,-52555.8 3077.91,-52555.38 3075,-52555 2709.87,-52506.4 2282.08,-52490.64 2024.04,-52485.57"/>
<polygon fill="black" stroke="black" points="2023.85,-52482.06 2013.79,-52485.37 2023.72,-52489.06 2023.85,-52482.06"/>
</g>
<!-- moe_4_expert_14&#45;&gt;moe_4_aggregate -->
<g id="edge47" class="edge">
<title>moe_4_expert_14&#45;&gt;moe_4_aggregate</title>
<path fill="none" stroke="black" d="M3319.82,-52556.22C3316.85,-52555.78 3313.91,-52555.37 3311,-52555 2858.1,-52496.72 2323.84,-52484.42 2024.56,-52482.58"/>
<polygon fill="black" stroke="black" points="2024.48,-52479.08 2014.46,-52482.52 2024.44,-52486.08 2024.48,-52479.08"/>
</g>
<!-- moe_4_expert_15&#45;&gt;moe_4_aggregate -->
<g id="edge48" class="edge">
<title>moe_4_expert_15&#45;&gt;moe_4_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-52556.19C3552.85,-52555.76 3549.91,-52555.36 3547,-52555 3259.06,-52518.87 2429.5,-52496.81 2022.2,-52487.85"/>
<polygon fill="black" stroke="black" points="2022.14,-52484.35 2012.06,-52487.63 2021.98,-52491.35 2022.14,-52484.35"/>
</g>
<!-- moe_4_ffn -->
<g id="node34" class="node">
<title>moe_4_ffn</title>
<polygon fill="lightgreen" stroke="black" points="1949,-52409.46 1633,-52409.46 1633,-52357.46 1949,-52357.46 1949,-52409.46"/>
<text text-anchor="middle" x="1791" y="-52397.46" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1791" y="-52386.46" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1791" y="-52375.46" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1791" y="-52364.46" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_4_aggregate&#45;&gt;moe_4_ffn -->
<g id="edge49" class="edge">
<title>moe_4_aggregate&#45;&gt;moe_4_ffn</title>
<path fill="none" stroke="black" d="M1791,-52445.19C1791,-52436.88 1791,-52428.05 1791,-52419.77"/>
<polygon fill="black" stroke="black" points="1794.5,-52419.65 1791,-52409.65 1787.5,-52419.65 1794.5,-52419.65"/>
</g>
<!-- moe_4_res2 -->
<g id="node36" class="node">
<title>moe_4_res2</title>
<polygon fill="lightyellow" stroke="black" points="2127.89,-52321.46 1591.97,-52321.46 1454.11,-52217.46 1990.03,-52217.46 2127.89,-52321.46"/>
<text text-anchor="middle" x="1791" y="-52283.46" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1791" y="-52272.46" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1791" y="-52261.46" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1791" y="-52250.46" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_4_ffn&#45;&gt;moe_4_res2 -->
<g id="edge50" class="edge">
<title>moe_4_ffn&#45;&gt;moe_4_res2</title>
<path fill="none" stroke="black" d="M1791,-52357.32C1791,-52349.64 1791,-52340.83 1791,-52331.83"/>
<polygon fill="black" stroke="black" points="1794.5,-52331.64 1791,-52321.64 1787.5,-52331.64 1794.5,-52331.64"/>
</g>
<!-- moe_4_res1&#45;&gt;moe_4_gate -->
<g id="edge15" class="edge">
<title>moe_4_res1&#45;&gt;moe_4_gate</title>
<path fill="none" stroke="black" d="M1895,-52892.15C1895,-52883.98 1895,-52875.45 1895,-52867.08"/>
<polygon fill="black" stroke="black" points="1898.5,-52866.97 1895,-52856.97 1891.5,-52866.97 1898.5,-52866.97"/>
</g>
<!-- moe_5_mha -->
<g id="node37" class="node">
<title>moe_5_mha</title>
<polygon fill="lightgreen" stroke="black" points="1949,-52170.46 1633,-52170.46 1633,-52118.46 1949,-52118.46 1949,-52170.46"/>
<text text-anchor="middle" x="1791" y="-52158.46" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1791" y="-52147.46" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1791" y="-52136.46" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1791" y="-52125.46" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_4_res2&#45;&gt;moe_5_mha -->
<g id="edge51" class="edge">
<title>moe_4_res2&#45;&gt;moe_5_mha</title>
<path fill="none" stroke="black" d="M1791,-52217.36C1791,-52205.03 1791,-52192.13 1791,-52180.71"/>
<polygon fill="black" stroke="black" points="1794.5,-52180.7 1791,-52170.7 1787.5,-52180.7 1794.5,-52180.7"/>
</g>
<!-- moe_5_res1 -->
<g id="node58" class="node">
<title>moe_5_res1</title>
<polygon fill="lightyellow" stroke="black" points="2127.89,-52082.46 1591.97,-52082.46 1454.11,-51978.46 1990.03,-51978.46 2127.89,-52082.46"/>
<text text-anchor="middle" x="1791" y="-52044.46" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1791" y="-52033.46" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1791" y="-52022.46" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1791" y="-52011.46" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_5_mha&#45;&gt;moe_5_res1 -->
<g id="edge52" class="edge">
<title>moe_5_mha&#45;&gt;moe_5_res1</title>
<path fill="none" stroke="black" d="M1791,-52118.32C1791,-52110.64 1791,-52101.83 1791,-52092.83"/>
<polygon fill="black" stroke="black" points="1794.5,-52092.64 1791,-52082.64 1787.5,-52092.64 1794.5,-52092.64"/>
</g>
<!-- moe_5_gate -->
<g id="node38" class="node">
<title>moe_5_gate</title>
<polygon fill="lightyellow" stroke="black" points="2119.8,-51942.46 1596.75,-51942.46 1462.2,-51838.46 1985.25,-51838.46 2119.8,-51942.46"/>
<text text-anchor="middle" x="1791" y="-51904.46" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1791" y="-51893.46" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1791" y="-51882.46" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1791" y="-51871.46" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_5_route -->
<g id="node39" class="node">
<title>moe_5_route</title>
<ellipse fill="lightblue" stroke="black" cx="1791" cy="-51765.69" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1791" y="-51779.69" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1791" y="-51768.69" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1791" y="-51757.69" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1791" y="-51746.69" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_5_gate&#45;&gt;moe_5_route -->
<g id="edge54" class="edge">
<title>moe_5_gate&#45;&gt;moe_5_route</title>
<path fill="none" stroke="black" d="M1791,-51838.1C1791,-51829.7 1791,-51821.03 1791,-51812.76"/>
<polygon fill="black" stroke="black" points="1794.5,-51812.54 1791,-51802.54 1787.5,-51812.54 1794.5,-51812.54"/>
</g>
<!-- moe_5_expert_0 -->
<g id="node40" class="node">
<title>moe_5_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="248,-51692.92 30,-51692.92 30,-51640.92 248,-51640.92 248,-51692.92"/>
<text text-anchor="middle" x="139" y="-51680.92" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="139" y="-51669.92" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="139" y="-51658.92" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="139" y="-51647.92" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_5_route&#45;&gt;moe_5_expert_0 -->
<g id="edge55" class="edge">
<title>moe_5_route&#45;&gt;moe_5_expert_0</title>
<path fill="none" stroke="black" d="M1576.77,-51758.96C1221.39,-51748.74 523.65,-51725.46 258.21,-51692.96"/>
<polygon fill="black" stroke="black" points="258.54,-51689.47 248.18,-51691.7 257.67,-51696.42 258.54,-51689.47"/>
</g>
<!-- moe_5_expert_1 -->
<g id="node41" class="node">
<title>moe_5_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="484,-51692.92 266,-51692.92 266,-51640.92 484,-51640.92 484,-51692.92"/>
<text text-anchor="middle" x="375" y="-51680.92" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="375" y="-51669.92" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="375" y="-51658.92" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="375" y="-51647.92" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_5_route&#45;&gt;moe_5_expert_1 -->
<g id="edge56" class="edge">
<title>moe_5_route&#45;&gt;moe_5_expert_1</title>
<path fill="none" stroke="black" d="M1573.59,-51762.84C1317.22,-51758.34 878.4,-51743.34 494.11,-51692.98"/>
<polygon fill="black" stroke="black" points="494.56,-51689.51 484.19,-51691.67 493.64,-51696.45 494.56,-51689.51"/>
</g>
<!-- moe_5_expert_2 -->
<g id="node42" class="node">
<title>moe_5_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="720,-51692.92 502,-51692.92 502,-51640.92 720,-51640.92 720,-51692.92"/>
<text text-anchor="middle" x="611" y="-51680.92" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="611" y="-51669.92" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="611" y="-51658.92" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="611" y="-51647.92" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_5_route&#45;&gt;moe_5_expert_2 -->
<g id="edge57" class="edge">
<title>moe_5_route&#45;&gt;moe_5_expert_2</title>
<path fill="none" stroke="black" d="M1576.51,-51759.08C1363.77,-51751.46 1028.57,-51733.9 730.34,-51693.02"/>
<polygon fill="black" stroke="black" points="730.58,-51689.52 720.2,-51691.62 729.62,-51696.46 730.58,-51689.52"/>
</g>
<!-- moe_5_expert_3 -->
<g id="node43" class="node">
<title>moe_5_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="956,-51692.92 738,-51692.92 738,-51640.92 956,-51640.92 956,-51692.92"/>
<text text-anchor="middle" x="847" y="-51680.92" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="847" y="-51669.92" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="847" y="-51658.92" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="847" y="-51647.92" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_5_route&#45;&gt;moe_5_expert_3 -->
<g id="edge58" class="edge">
<title>moe_5_route&#45;&gt;moe_5_expert_3</title>
<path fill="none" stroke="black" d="M1584.82,-51753.78C1419.76,-51743.39 1182.32,-51724.74 966.16,-51693.02"/>
<polygon fill="black" stroke="black" points="966.61,-51689.55 956.21,-51691.55 965.59,-51696.47 966.61,-51689.55"/>
</g>
<!-- moe_5_expert_4 -->
<g id="node44" class="node">
<title>moe_5_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1192,-51692.92 974,-51692.92 974,-51640.92 1192,-51640.92 1192,-51692.92"/>
<text text-anchor="middle" x="1083" y="-51680.92" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1083" y="-51669.92" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1083" y="-51658.92" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1083" y="-51647.92" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_5_route&#45;&gt;moe_5_expert_4 -->
<g id="edge59" class="edge">
<title>moe_5_route&#45;&gt;moe_5_expert_4</title>
<path fill="none" stroke="black" d="M1605.38,-51746.33C1491.62,-51734.06 1342.9,-51716.2 1202.33,-51693.09"/>
<polygon fill="black" stroke="black" points="1202.66,-51689.59 1192.23,-51691.41 1201.52,-51696.5 1202.66,-51689.59"/>
</g>
<!-- moe_5_expert_5 -->
<g id="node45" class="node">
<title>moe_5_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1428,-51692.92 1210,-51692.92 1210,-51640.92 1428,-51640.92 1428,-51692.92"/>
<text text-anchor="middle" x="1319" y="-51680.92" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1319" y="-51669.92" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1319" y="-51658.92" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1319" y="-51647.92" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_5_route&#45;&gt;moe_5_expert_5 -->
<g id="edge60" class="edge">
<title>moe_5_route&#45;&gt;moe_5_expert_5</title>
<path fill="none" stroke="black" d="M1653.51,-51737.11C1590.62,-51724.42 1514.88,-51709.04 1438.14,-51693.15"/>
<polygon fill="black" stroke="black" points="1438.79,-51689.71 1428.28,-51691.11 1437.37,-51696.56 1438.79,-51689.71"/>
</g>
<!-- moe_5_expert_6 -->
<g id="node46" class="node">
<title>moe_5_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1664,-51692.92 1446,-51692.92 1446,-51640.92 1664,-51640.92 1664,-51692.92"/>
<text text-anchor="middle" x="1555" y="-51680.92" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1555" y="-51669.92" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1555" y="-51658.92" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1555" y="-51647.92" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_5_route&#45;&gt;moe_5_expert_6 -->
<g id="edge61" class="edge">
<title>moe_5_route&#45;&gt;moe_5_expert_6</title>
<path fill="none" stroke="black" d="M1710.11,-51731.52C1682.54,-51720.22 1651.96,-51707.68 1625.29,-51696.74"/>
<polygon fill="black" stroke="black" points="1626.61,-51693.5 1616.03,-51692.94 1623.95,-51699.98 1626.61,-51693.5"/>
</g>
<!-- moe_5_expert_7 -->
<g id="node47" class="node">
<title>moe_5_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1900,-51692.92 1682,-51692.92 1682,-51640.92 1900,-51640.92 1900,-51692.92"/>
<text text-anchor="middle" x="1791" y="-51680.92" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1791" y="-51669.92" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1791" y="-51658.92" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1791" y="-51647.92" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_5_route&#45;&gt;moe_5_expert_7 -->
<g id="edge62" class="edge">
<title>moe_5_route&#45;&gt;moe_5_expert_7</title>
<path fill="none" stroke="black" d="M1791,-51728.66C1791,-51720.34 1791,-51711.51 1791,-51703.23"/>
<polygon fill="black" stroke="black" points="1794.5,-51703.11 1791,-51693.11 1787.5,-51703.12 1794.5,-51703.11"/>
</g>
<!-- moe_5_expert_8 -->
<g id="node48" class="node">
<title>moe_5_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2136,-51692.92 1918,-51692.92 1918,-51640.92 2136,-51640.92 2136,-51692.92"/>
<text text-anchor="middle" x="2027" y="-51680.92" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2027" y="-51669.92" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2027" y="-51658.92" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2027" y="-51647.92" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_5_route&#45;&gt;moe_5_expert_8 -->
<g id="edge63" class="edge">
<title>moe_5_route&#45;&gt;moe_5_expert_8</title>
<path fill="none" stroke="black" d="M1871.89,-51731.52C1899.46,-51720.22 1930.04,-51707.68 1956.71,-51696.74"/>
<polygon fill="black" stroke="black" points="1958.05,-51699.98 1965.97,-51692.94 1955.39,-51693.5 1958.05,-51699.98"/>
</g>
<!-- moe_5_expert_9 -->
<g id="node49" class="node">
<title>moe_5_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2372,-51692.92 2154,-51692.92 2154,-51640.92 2372,-51640.92 2372,-51692.92"/>
<text text-anchor="middle" x="2263" y="-51680.92" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2263" y="-51669.92" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2263" y="-51658.92" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2263" y="-51647.92" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_5_route&#45;&gt;moe_5_expert_9 -->
<g id="edge64" class="edge">
<title>moe_5_route&#45;&gt;moe_5_expert_9</title>
<path fill="none" stroke="black" d="M1928.49,-51737.11C1991.38,-51724.42 2067.12,-51709.04 2143.86,-51693.15"/>
<polygon fill="black" stroke="black" points="2144.63,-51696.56 2153.72,-51691.11 2143.21,-51689.71 2144.63,-51696.56"/>
</g>
<!-- moe_5_expert_10 -->
<g id="node50" class="node">
<title>moe_5_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2608,-51692.92 2390,-51692.92 2390,-51640.92 2608,-51640.92 2608,-51692.92"/>
<text text-anchor="middle" x="2499" y="-51680.92" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2499" y="-51669.92" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2499" y="-51658.92" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2499" y="-51647.92" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_5_route&#45;&gt;moe_5_expert_10 -->
<g id="edge65" class="edge">
<title>moe_5_route&#45;&gt;moe_5_expert_10</title>
<path fill="none" stroke="black" d="M1976.62,-51746.33C2090.38,-51734.06 2239.1,-51716.2 2379.67,-51693.09"/>
<polygon fill="black" stroke="black" points="2380.48,-51696.5 2389.77,-51691.41 2379.34,-51689.59 2380.48,-51696.5"/>
</g>
<!-- moe_5_expert_11 -->
<g id="node51" class="node">
<title>moe_5_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2844,-51692.92 2626,-51692.92 2626,-51640.92 2844,-51640.92 2844,-51692.92"/>
<text text-anchor="middle" x="2735" y="-51680.92" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2735" y="-51669.92" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2735" y="-51658.92" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2735" y="-51647.92" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_5_route&#45;&gt;moe_5_expert_11 -->
<g id="edge66" class="edge">
<title>moe_5_route&#45;&gt;moe_5_expert_11</title>
<path fill="none" stroke="black" d="M1997.18,-51753.78C2162.24,-51743.39 2399.68,-51724.74 2615.84,-51693.02"/>
<polygon fill="black" stroke="black" points="2616.41,-51696.47 2625.79,-51691.55 2615.39,-51689.55 2616.41,-51696.47"/>
</g>
<!-- moe_5_expert_12 -->
<g id="node52" class="node">
<title>moe_5_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3080,-51692.92 2862,-51692.92 2862,-51640.92 3080,-51640.92 3080,-51692.92"/>
<text text-anchor="middle" x="2971" y="-51680.92" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2971" y="-51669.92" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2971" y="-51658.92" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2971" y="-51647.92" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_5_route&#45;&gt;moe_5_expert_12 -->
<g id="edge67" class="edge">
<title>moe_5_route&#45;&gt;moe_5_expert_12</title>
<path fill="none" stroke="black" d="M2005.49,-51759.08C2218.23,-51751.46 2553.43,-51733.9 2851.66,-51693.02"/>
<polygon fill="black" stroke="black" points="2852.38,-51696.46 2861.8,-51691.62 2851.42,-51689.52 2852.38,-51696.46"/>
</g>
<!-- moe_5_expert_13 -->
<g id="node53" class="node">
<title>moe_5_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3316,-51692.92 3098,-51692.92 3098,-51640.92 3316,-51640.92 3316,-51692.92"/>
<text text-anchor="middle" x="3207" y="-51680.92" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3207" y="-51669.92" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3207" y="-51658.92" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3207" y="-51647.92" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_5_route&#45;&gt;moe_5_expert_13 -->
<g id="edge68" class="edge">
<title>moe_5_route&#45;&gt;moe_5_expert_13</title>
<path fill="none" stroke="black" d="M2008.41,-51762.84C2264.78,-51758.34 2703.6,-51743.34 3087.89,-51692.98"/>
<polygon fill="black" stroke="black" points="3088.36,-51696.45 3097.81,-51691.67 3087.44,-51689.51 3088.36,-51696.45"/>
</g>
<!-- moe_5_expert_14 -->
<g id="node54" class="node">
<title>moe_5_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3552,-51692.92 3334,-51692.92 3334,-51640.92 3552,-51640.92 3552,-51692.92"/>
<text text-anchor="middle" x="3443" y="-51680.92" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3443" y="-51669.92" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3443" y="-51658.92" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3443" y="-51647.92" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_5_route&#45;&gt;moe_5_expert_14 -->
<g id="edge69" class="edge">
<title>moe_5_route&#45;&gt;moe_5_expert_14</title>
<path fill="none" stroke="black" d="M2005.23,-51758.96C2360.61,-51748.74 3058.35,-51725.46 3323.79,-51692.96"/>
<polygon fill="black" stroke="black" points="3324.33,-51696.42 3333.82,-51691.7 3323.46,-51689.47 3324.33,-51696.42"/>
</g>
<!-- moe_5_expert_15 -->
<g id="node55" class="node">
<title>moe_5_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3788,-51692.92 3570,-51692.92 3570,-51640.92 3788,-51640.92 3788,-51692.92"/>
<text text-anchor="middle" x="3679" y="-51680.92" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3679" y="-51669.92" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3679" y="-51658.92" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3679" y="-51647.92" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_5_route&#45;&gt;moe_5_expert_15 -->
<g id="edge70" class="edge">
<title>moe_5_route&#45;&gt;moe_5_expert_15</title>
<path fill="none" stroke="black" d="M2006.71,-51760.48C2406.25,-51751.95 3248.28,-51730.28 3559.86,-51692.95"/>
<polygon fill="black" stroke="black" points="3560.32,-51696.42 3569.82,-51691.73 3559.47,-51689.47 3560.32,-51696.42"/>
</g>
<!-- moe_5_aggregate -->
<g id="node56" class="node">
<title>moe_5_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1820" cy="-51568.15" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1820" y="-51582.15" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1820" y="-51571.15" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1820" y="-51560.15" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1820" y="-51549.15" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_5_expert_0&#45;&gt;moe_5_aggregate -->
<g id="edge71" class="edge">
<title>moe_5_expert_0&#45;&gt;moe_5_aggregate</title>
<path fill="none" stroke="black" d="M248.18,-51642.13C251.15,-51641.7 254.09,-51641.29 257,-51640.92 507.74,-51608.82 1220.02,-51585.46 1590.22,-51575.1"/>
<polygon fill="black" stroke="black" points="1590.36,-51578.6 1600.26,-51574.82 1590.16,-51571.6 1590.36,-51578.6"/>
</g>
<!-- moe_5_expert_1&#45;&gt;moe_5_aggregate -->
<g id="edge72" class="edge">
<title>moe_5_expert_1&#45;&gt;moe_5_aggregate</title>
<path fill="none" stroke="black" d="M484.19,-51642.16C487.15,-51641.72 490.09,-51641.3 493,-51640.92 873.94,-51590.57 1320.87,-51575.36 1586.69,-51570.87"/>
<polygon fill="black" stroke="black" points="1586.91,-51574.37 1596.85,-51570.7 1586.8,-51567.37 1586.91,-51574.37"/>
</g>
<!-- moe_5_expert_2&#45;&gt;moe_5_aggregate -->
<g id="edge73" class="edge">
<title>moe_5_expert_2&#45;&gt;moe_5_aggregate</title>
<path fill="none" stroke="black" d="M720.19,-51642.21C723.16,-51641.75 726.1,-51641.32 729,-51640.92 1024.38,-51600.13 1368.04,-51582.37 1589.52,-51574.74"/>
<polygon fill="black" stroke="black" points="1589.77,-51578.24 1599.65,-51574.4 1589.54,-51571.24 1589.77,-51578.24"/>
</g>
<!-- moe_5_expert_3&#45;&gt;moe_5_aggregate -->
<g id="edge74" class="edge">
<title>moe_5_expert_3&#45;&gt;moe_5_aggregate</title>
<path fill="none" stroke="black" d="M956.2,-51642.28C959.16,-51641.8 962.1,-51641.35 965,-51640.92 1178.59,-51609.45 1424.39,-51590.61 1597.46,-51580.19"/>
<polygon fill="black" stroke="black" points="1597.68,-51583.68 1607.45,-51579.59 1597.26,-51576.69 1597.68,-51583.68"/>
</g>
<!-- moe_5_expert_4&#45;&gt;moe_5_aggregate -->
<g id="edge75" class="edge">
<title>moe_5_expert_4&#45;&gt;moe_5_aggregate</title>
<path fill="none" stroke="black" d="M1192.22,-51642.4C1195.18,-51641.89 1198.11,-51641.39 1201,-51640.92 1339.25,-51618.31 1496,-51600.21 1617.18,-51587.84"/>
<polygon fill="black" stroke="black" points="1617.72,-51591.31 1627.31,-51586.81 1617.01,-51584.34 1617.72,-51591.31"/>
</g>
<!-- moe_5_expert_5&#45;&gt;moe_5_aggregate -->
<g id="edge76" class="edge">
<title>moe_5_expert_5&#45;&gt;moe_5_aggregate</title>
<path fill="none" stroke="black" d="M1428.27,-51642.67C1431.21,-51642.08 1434.12,-51641.49 1437,-51640.92 1511.14,-51626.12 1593.54,-51610.57 1662.85,-51597.73"/>
<polygon fill="black" stroke="black" points="1663.79,-51601.12 1672.98,-51595.86 1662.51,-51594.24 1663.79,-51601.12"/>
</g>
<!-- moe_5_expert_6&#45;&gt;moe_5_aggregate -->
<g id="edge77" class="edge">
<title>moe_5_expert_6&#45;&gt;moe_5_aggregate</title>
<path fill="none" stroke="black" d="M1623.59,-51640.87C1653.18,-51630.07 1688.36,-51617.22 1720.72,-51605.4"/>
<polygon fill="black" stroke="black" points="1722.02,-51608.66 1730.21,-51601.94 1719.62,-51602.08 1722.02,-51608.66"/>
</g>
<!-- moe_5_expert_7&#45;&gt;moe_5_aggregate -->
<g id="edge78" class="edge">
<title>moe_5_expert_7&#45;&gt;moe_5_aggregate</title>
<path fill="none" stroke="black" d="M1798.54,-51640.75C1800.93,-51632.77 1803.66,-51623.69 1806.34,-51614.73"/>
<polygon fill="black" stroke="black" points="1809.7,-51615.71 1809.22,-51605.13 1803,-51613.7 1809.7,-51615.71"/>
</g>
<!-- moe_5_expert_8&#45;&gt;moe_5_aggregate -->
<g id="edge79" class="edge">
<title>moe_5_expert_8&#45;&gt;moe_5_aggregate</title>
<path fill="none" stroke="black" d="M1973.42,-51640.87C1951.54,-51630.64 1925.75,-51618.58 1901.61,-51607.3"/>
<polygon fill="black" stroke="black" points="1903,-51604.09 1892.46,-51603.02 1900.03,-51610.43 1903,-51604.09"/>
</g>
<!-- moe_5_expert_9&#45;&gt;moe_5_aggregate -->
<g id="edge80" class="edge">
<title>moe_5_expert_9&#45;&gt;moe_5_aggregate</title>
<path fill="none" stroke="black" d="M2153.78,-51642.06C2095.78,-51629.39 2023.81,-51613.67 1961.57,-51600.07"/>
<polygon fill="black" stroke="black" points="1962.18,-51596.63 1951.67,-51597.91 1960.69,-51603.46 1962.18,-51596.63"/>
</g>
<!-- moe_5_expert_10&#45;&gt;moe_5_aggregate -->
<g id="edge81" class="edge">
<title>moe_5_expert_10&#45;&gt;moe_5_aggregate</title>
<path fill="none" stroke="black" d="M2389.77,-51642.45C2386.82,-51641.92 2383.89,-51641.41 2381,-51640.92 2259.78,-51620.36 2122.93,-51602.74 2014.74,-51590.11"/>
<polygon fill="black" stroke="black" points="2015.03,-51586.62 2004.69,-51588.94 2014.22,-51593.57 2015.03,-51586.62"/>
</g>
<!-- moe_5_expert_11&#45;&gt;moe_5_aggregate -->
<g id="edge82" class="edge">
<title>moe_5_expert_11&#45;&gt;moe_5_aggregate</title>
<path fill="none" stroke="black" d="M2625.79,-51642.3C2622.83,-51641.82 2619.9,-51641.35 2617,-51640.92 2422.72,-51611.7 2199.88,-51592.86 2039.32,-51581.85"/>
<polygon fill="black" stroke="black" points="2039.53,-51578.36 2029.31,-51581.17 2039.05,-51585.34 2039.53,-51578.36"/>
</g>
<!-- moe_5_expert_12&#45;&gt;moe_5_aggregate -->
<g id="edge83" class="edge">
<title>moe_5_expert_12&#45;&gt;moe_5_aggregate</title>
<path fill="none" stroke="black" d="M2861.8,-51642.22C2858.84,-51641.76 2855.9,-51641.33 2853,-51640.92 2578.2,-51602.45 2259.26,-51584.28 2049.3,-51575.92"/>
<polygon fill="black" stroke="black" points="2049.2,-51572.41 2039.07,-51575.51 2048.92,-51579.4 2049.2,-51572.41"/>
</g>
<!-- moe_5_expert_13&#45;&gt;moe_5_aggregate -->
<g id="edge84" class="edge">
<title>moe_5_expert_13&#45;&gt;moe_5_aggregate</title>
<path fill="none" stroke="black" d="M3097.81,-51642.17C3094.85,-51641.73 3091.91,-51641.31 3089,-51640.92 2729.35,-51592.93 2308.18,-51576.98 2052.9,-51571.71"/>
<polygon fill="black" stroke="black" points="2052.82,-51568.21 2042.75,-51571.5 2052.68,-51575.21 2052.82,-51568.21"/>
</g>
<!-- moe_5_expert_14&#45;&gt;moe_5_aggregate -->
<g id="edge85" class="edge">
<title>moe_5_expert_14&#45;&gt;moe_5_aggregate</title>
<path fill="none" stroke="black" d="M3333.82,-51642.14C3330.85,-51641.7 3327.91,-51641.29 3325,-51640.92 2877.69,-51583.25 2350.23,-51570.71 2053.49,-51568.66"/>
<polygon fill="black" stroke="black" points="2053.49,-51565.16 2043.47,-51568.6 2053.44,-51572.16 2053.49,-51565.16"/>
</g>
<!-- moe_5_expert_15&#45;&gt;moe_5_aggregate -->
<g id="edge86" class="edge">
<title>moe_5_expert_15&#45;&gt;moe_5_aggregate</title>
<path fill="none" stroke="black" d="M3569.82,-51642.11C3566.85,-51641.68 3563.91,-51641.28 3561,-51640.92 3275.99,-51605.11 2455.73,-51582.93 2051.2,-51573.87"/>
<polygon fill="black" stroke="black" points="2051.21,-51570.37 2041.13,-51573.64 2051.05,-51577.37 2051.21,-51570.37"/>
</g>
<!-- moe_5_ffn -->
<g id="node57" class="node">
<title>moe_5_ffn</title>
<polygon fill="lightgreen" stroke="black" points="1978,-51495.38 1662,-51495.38 1662,-51443.38 1978,-51443.38 1978,-51495.38"/>
<text text-anchor="middle" x="1820" y="-51483.38" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1820" y="-51472.38" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1820" y="-51461.38" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1820" y="-51450.38" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_5_aggregate&#45;&gt;moe_5_ffn -->
<g id="edge87" class="edge">
<title>moe_5_aggregate&#45;&gt;moe_5_ffn</title>
<path fill="none" stroke="black" d="M1820,-51531.12C1820,-51522.8 1820,-51513.97 1820,-51505.69"/>
<polygon fill="black" stroke="black" points="1823.5,-51505.58 1820,-51495.58 1816.5,-51505.58 1823.5,-51505.58"/>
</g>
<!-- moe_5_res2 -->
<g id="node59" class="node">
<title>moe_5_res2</title>
<polygon fill="lightyellow" stroke="black" points="2156.89,-51407.38 1620.97,-51407.38 1483.11,-51303.38 2019.03,-51303.38 2156.89,-51407.38"/>
<text text-anchor="middle" x="1820" y="-51369.38" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1820" y="-51358.38" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1820" y="-51347.38" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1820" y="-51336.38" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_5_ffn&#45;&gt;moe_5_res2 -->
<g id="edge88" class="edge">
<title>moe_5_ffn&#45;&gt;moe_5_res2</title>
<path fill="none" stroke="black" d="M1820,-51443.24C1820,-51435.56 1820,-51426.75 1820,-51417.75"/>
<polygon fill="black" stroke="black" points="1823.5,-51417.56 1820,-51407.56 1816.5,-51417.56 1823.5,-51417.56"/>
</g>
<!-- moe_5_res1&#45;&gt;moe_5_gate -->
<g id="edge53" class="edge">
<title>moe_5_res1&#45;&gt;moe_5_gate</title>
<path fill="none" stroke="black" d="M1791,-51978.07C1791,-51969.9 1791,-51961.37 1791,-51953"/>
<polygon fill="black" stroke="black" points="1794.5,-51952.89 1791,-51942.89 1787.5,-51952.89 1794.5,-51952.89"/>
</g>
<!-- moe_6_mha -->
<g id="node60" class="node">
<title>moe_6_mha</title>
<polygon fill="lightgreen" stroke="black" points="1978,-51256.38 1662,-51256.38 1662,-51204.38 1978,-51204.38 1978,-51256.38"/>
<text text-anchor="middle" x="1820" y="-51244.38" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1820" y="-51233.38" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1820" y="-51222.38" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1820" y="-51211.38" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_5_res2&#45;&gt;moe_6_mha -->
<g id="edge89" class="edge">
<title>moe_5_res2&#45;&gt;moe_6_mha</title>
<path fill="none" stroke="black" d="M1820,-51303.29C1820,-51290.95 1820,-51278.05 1820,-51266.63"/>
<polygon fill="black" stroke="black" points="1823.5,-51266.62 1820,-51256.62 1816.5,-51266.62 1823.5,-51266.62"/>
</g>
<!-- moe_6_res1 -->
<g id="node81" class="node">
<title>moe_6_res1</title>
<polygon fill="lightyellow" stroke="black" points="2156.89,-51168.38 1620.97,-51168.38 1483.11,-51064.38 2019.03,-51064.38 2156.89,-51168.38"/>
<text text-anchor="middle" x="1820" y="-51130.38" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1820" y="-51119.38" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1820" y="-51108.38" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1820" y="-51097.38" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_6_mha&#45;&gt;moe_6_res1 -->
<g id="edge90" class="edge">
<title>moe_6_mha&#45;&gt;moe_6_res1</title>
<path fill="none" stroke="black" d="M1820,-51204.24C1820,-51196.56 1820,-51187.75 1820,-51178.75"/>
<polygon fill="black" stroke="black" points="1823.5,-51178.56 1820,-51168.56 1816.5,-51178.56 1823.5,-51178.56"/>
</g>
<!-- moe_6_gate -->
<g id="node61" class="node">
<title>moe_6_gate</title>
<polygon fill="lightyellow" stroke="black" points="2148.8,-51028.38 1625.75,-51028.38 1491.2,-50924.38 2014.25,-50924.38 2148.8,-51028.38"/>
<text text-anchor="middle" x="1820" y="-50990.38" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1820" y="-50979.38" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1820" y="-50968.38" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1820" y="-50957.38" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_6_route -->
<g id="node62" class="node">
<title>moe_6_route</title>
<ellipse fill="lightblue" stroke="black" cx="1820" cy="-50851.61" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1820" y="-50865.61" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1820" y="-50854.61" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1820" y="-50843.61" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1820" y="-50832.61" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_6_gate&#45;&gt;moe_6_route -->
<g id="edge92" class="edge">
<title>moe_6_gate&#45;&gt;moe_6_route</title>
<path fill="none" stroke="black" d="M1820,-50924.03C1820,-50915.62 1820,-50906.95 1820,-50898.68"/>
<polygon fill="black" stroke="black" points="1823.5,-50898.47 1820,-50888.47 1816.5,-50898.47 1823.5,-50898.47"/>
</g>
<!-- moe_6_expert_0 -->
<g id="node63" class="node">
<title>moe_6_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="277,-50778.84 59,-50778.84 59,-50726.84 277,-50726.84 277,-50778.84"/>
<text text-anchor="middle" x="168" y="-50766.84" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="168" y="-50755.84" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="168" y="-50744.84" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="168" y="-50733.84" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_6_route&#45;&gt;moe_6_expert_0 -->
<g id="edge93" class="edge">
<title>moe_6_route&#45;&gt;moe_6_expert_0</title>
<path fill="none" stroke="black" d="M1605.77,-50844.88C1250.39,-50834.66 552.65,-50811.38 287.21,-50778.88"/>
<polygon fill="black" stroke="black" points="287.54,-50775.4 277.18,-50777.62 286.67,-50782.34 287.54,-50775.4"/>
</g>
<!-- moe_6_expert_1 -->
<g id="node64" class="node">
<title>moe_6_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="513,-50778.84 295,-50778.84 295,-50726.84 513,-50726.84 513,-50778.84"/>
<text text-anchor="middle" x="404" y="-50766.84" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="404" y="-50755.84" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="404" y="-50744.84" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="404" y="-50733.84" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_6_route&#45;&gt;moe_6_expert_1 -->
<g id="edge94" class="edge">
<title>moe_6_route&#45;&gt;moe_6_expert_1</title>
<path fill="none" stroke="black" d="M1602.59,-50848.76C1346.22,-50844.26 907.4,-50829.27 523.11,-50778.9"/>
<polygon fill="black" stroke="black" points="523.56,-50775.43 513.19,-50777.59 522.64,-50782.37 523.56,-50775.43"/>
</g>
<!-- moe_6_expert_2 -->
<g id="node65" class="node">
<title>moe_6_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="749,-50778.84 531,-50778.84 531,-50726.84 749,-50726.84 749,-50778.84"/>
<text text-anchor="middle" x="640" y="-50766.84" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="640" y="-50755.84" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="640" y="-50744.84" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="640" y="-50733.84" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_6_route&#45;&gt;moe_6_expert_2 -->
<g id="edge95" class="edge">
<title>moe_6_route&#45;&gt;moe_6_expert_2</title>
<path fill="none" stroke="black" d="M1605.51,-50845C1392.77,-50837.38 1057.57,-50819.82 759.34,-50778.94"/>
<polygon fill="black" stroke="black" points="759.58,-50775.44 749.2,-50777.54 758.62,-50782.38 759.58,-50775.44"/>
</g>
<!-- moe_6_expert_3 -->
<g id="node66" class="node">
<title>moe_6_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="985,-50778.84 767,-50778.84 767,-50726.84 985,-50726.84 985,-50778.84"/>
<text text-anchor="middle" x="876" y="-50766.84" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="876" y="-50755.84" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="876" y="-50744.84" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="876" y="-50733.84" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_6_route&#45;&gt;moe_6_expert_3 -->
<g id="edge96" class="edge">
<title>moe_6_route&#45;&gt;moe_6_expert_3</title>
<path fill="none" stroke="black" d="M1613.82,-50839.7C1448.76,-50829.32 1211.32,-50810.67 995.16,-50778.94"/>
<polygon fill="black" stroke="black" points="995.61,-50775.47 985.21,-50777.47 994.59,-50782.39 995.61,-50775.47"/>
</g>
<!-- moe_6_expert_4 -->
<g id="node67" class="node">
<title>moe_6_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1221,-50778.84 1003,-50778.84 1003,-50726.84 1221,-50726.84 1221,-50778.84"/>
<text text-anchor="middle" x="1112" y="-50766.84" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1112" y="-50755.84" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1112" y="-50744.84" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1112" y="-50733.84" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_6_route&#45;&gt;moe_6_expert_4 -->
<g id="edge97" class="edge">
<title>moe_6_route&#45;&gt;moe_6_expert_4</title>
<path fill="none" stroke="black" d="M1634.38,-50832.25C1520.62,-50819.98 1371.9,-50802.12 1231.33,-50779.01"/>
<polygon fill="black" stroke="black" points="1231.66,-50775.52 1221.23,-50777.33 1230.52,-50782.42 1231.66,-50775.52"/>
</g>
<!-- moe_6_expert_5 -->
<g id="node68" class="node">
<title>moe_6_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1457,-50778.84 1239,-50778.84 1239,-50726.84 1457,-50726.84 1457,-50778.84"/>
<text text-anchor="middle" x="1348" y="-50766.84" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1348" y="-50755.84" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1348" y="-50744.84" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1348" y="-50733.84" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_6_route&#45;&gt;moe_6_expert_5 -->
<g id="edge98" class="edge">
<title>moe_6_route&#45;&gt;moe_6_expert_5</title>
<path fill="none" stroke="black" d="M1682.51,-50823.03C1619.62,-50810.34 1543.88,-50794.96 1467.14,-50779.07"/>
<polygon fill="black" stroke="black" points="1467.79,-50775.63 1457.28,-50777.03 1466.37,-50782.49 1467.79,-50775.63"/>
</g>
<!-- moe_6_expert_6 -->
<g id="node69" class="node">
<title>moe_6_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1693,-50778.84 1475,-50778.84 1475,-50726.84 1693,-50726.84 1693,-50778.84"/>
<text text-anchor="middle" x="1584" y="-50766.84" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1584" y="-50755.84" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1584" y="-50744.84" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1584" y="-50733.84" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_6_route&#45;&gt;moe_6_expert_6 -->
<g id="edge99" class="edge">
<title>moe_6_route&#45;&gt;moe_6_expert_6</title>
<path fill="none" stroke="black" d="M1739.11,-50817.44C1711.54,-50806.14 1680.96,-50793.6 1654.29,-50782.66"/>
<polygon fill="black" stroke="black" points="1655.61,-50779.42 1645.03,-50778.86 1652.95,-50785.9 1655.61,-50779.42"/>
</g>
<!-- moe_6_expert_7 -->
<g id="node70" class="node">
<title>moe_6_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1929,-50778.84 1711,-50778.84 1711,-50726.84 1929,-50726.84 1929,-50778.84"/>
<text text-anchor="middle" x="1820" y="-50766.84" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1820" y="-50755.84" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1820" y="-50744.84" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1820" y="-50733.84" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_6_route&#45;&gt;moe_6_expert_7 -->
<g id="edge100" class="edge">
<title>moe_6_route&#45;&gt;moe_6_expert_7</title>
<path fill="none" stroke="black" d="M1820,-50814.58C1820,-50806.26 1820,-50797.43 1820,-50789.15"/>
<polygon fill="black" stroke="black" points="1823.5,-50789.04 1820,-50779.04 1816.5,-50789.04 1823.5,-50789.04"/>
</g>
<!-- moe_6_expert_8 -->
<g id="node71" class="node">
<title>moe_6_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2165,-50778.84 1947,-50778.84 1947,-50726.84 2165,-50726.84 2165,-50778.84"/>
<text text-anchor="middle" x="2056" y="-50766.84" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2056" y="-50755.84" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2056" y="-50744.84" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2056" y="-50733.84" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_6_route&#45;&gt;moe_6_expert_8 -->
<g id="edge101" class="edge">
<title>moe_6_route&#45;&gt;moe_6_expert_8</title>
<path fill="none" stroke="black" d="M1900.89,-50817.44C1928.46,-50806.14 1959.04,-50793.6 1985.71,-50782.66"/>
<polygon fill="black" stroke="black" points="1987.05,-50785.9 1994.97,-50778.86 1984.39,-50779.42 1987.05,-50785.9"/>
</g>
<!-- moe_6_expert_9 -->
<g id="node72" class="node">
<title>moe_6_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2401,-50778.84 2183,-50778.84 2183,-50726.84 2401,-50726.84 2401,-50778.84"/>
<text text-anchor="middle" x="2292" y="-50766.84" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2292" y="-50755.84" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2292" y="-50744.84" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2292" y="-50733.84" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_6_route&#45;&gt;moe_6_expert_9 -->
<g id="edge102" class="edge">
<title>moe_6_route&#45;&gt;moe_6_expert_9</title>
<path fill="none" stroke="black" d="M1957.49,-50823.03C2020.38,-50810.34 2096.12,-50794.96 2172.86,-50779.07"/>
<polygon fill="black" stroke="black" points="2173.63,-50782.49 2182.72,-50777.03 2172.21,-50775.63 2173.63,-50782.49"/>
</g>
<!-- moe_6_expert_10 -->
<g id="node73" class="node">
<title>moe_6_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2637,-50778.84 2419,-50778.84 2419,-50726.84 2637,-50726.84 2637,-50778.84"/>
<text text-anchor="middle" x="2528" y="-50766.84" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2528" y="-50755.84" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2528" y="-50744.84" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2528" y="-50733.84" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_6_route&#45;&gt;moe_6_expert_10 -->
<g id="edge103" class="edge">
<title>moe_6_route&#45;&gt;moe_6_expert_10</title>
<path fill="none" stroke="black" d="M2005.62,-50832.25C2119.38,-50819.98 2268.1,-50802.12 2408.67,-50779.01"/>
<polygon fill="black" stroke="black" points="2409.48,-50782.42 2418.77,-50777.33 2408.34,-50775.52 2409.48,-50782.42"/>
</g>
<!-- moe_6_expert_11 -->
<g id="node74" class="node">
<title>moe_6_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2873,-50778.84 2655,-50778.84 2655,-50726.84 2873,-50726.84 2873,-50778.84"/>
<text text-anchor="middle" x="2764" y="-50766.84" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2764" y="-50755.84" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2764" y="-50744.84" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2764" y="-50733.84" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_6_route&#45;&gt;moe_6_expert_11 -->
<g id="edge104" class="edge">
<title>moe_6_route&#45;&gt;moe_6_expert_11</title>
<path fill="none" stroke="black" d="M2026.18,-50839.7C2191.24,-50829.32 2428.68,-50810.67 2644.84,-50778.94"/>
<polygon fill="black" stroke="black" points="2645.41,-50782.39 2654.79,-50777.47 2644.39,-50775.47 2645.41,-50782.39"/>
</g>
<!-- moe_6_expert_12 -->
<g id="node75" class="node">
<title>moe_6_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3109,-50778.84 2891,-50778.84 2891,-50726.84 3109,-50726.84 3109,-50778.84"/>
<text text-anchor="middle" x="3000" y="-50766.84" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3000" y="-50755.84" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3000" y="-50744.84" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3000" y="-50733.84" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_6_route&#45;&gt;moe_6_expert_12 -->
<g id="edge105" class="edge">
<title>moe_6_route&#45;&gt;moe_6_expert_12</title>
<path fill="none" stroke="black" d="M2034.49,-50845C2247.23,-50837.38 2582.43,-50819.82 2880.66,-50778.94"/>
<polygon fill="black" stroke="black" points="2881.38,-50782.38 2890.8,-50777.54 2880.42,-50775.44 2881.38,-50782.38"/>
</g>
<!-- moe_6_expert_13 -->
<g id="node76" class="node">
<title>moe_6_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3345,-50778.84 3127,-50778.84 3127,-50726.84 3345,-50726.84 3345,-50778.84"/>
<text text-anchor="middle" x="3236" y="-50766.84" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3236" y="-50755.84" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3236" y="-50744.84" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3236" y="-50733.84" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_6_route&#45;&gt;moe_6_expert_13 -->
<g id="edge106" class="edge">
<title>moe_6_route&#45;&gt;moe_6_expert_13</title>
<path fill="none" stroke="black" d="M2037.41,-50848.76C2293.78,-50844.26 2732.6,-50829.27 3116.89,-50778.9"/>
<polygon fill="black" stroke="black" points="3117.36,-50782.37 3126.81,-50777.59 3116.44,-50775.43 3117.36,-50782.37"/>
</g>
<!-- moe_6_expert_14 -->
<g id="node77" class="node">
<title>moe_6_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3581,-50778.84 3363,-50778.84 3363,-50726.84 3581,-50726.84 3581,-50778.84"/>
<text text-anchor="middle" x="3472" y="-50766.84" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3472" y="-50755.84" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3472" y="-50744.84" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3472" y="-50733.84" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_6_route&#45;&gt;moe_6_expert_14 -->
<g id="edge107" class="edge">
<title>moe_6_route&#45;&gt;moe_6_expert_14</title>
<path fill="none" stroke="black" d="M2034.23,-50844.88C2389.61,-50834.66 3087.35,-50811.38 3352.79,-50778.88"/>
<polygon fill="black" stroke="black" points="3353.33,-50782.34 3362.82,-50777.62 3352.46,-50775.4 3353.33,-50782.34"/>
</g>
<!-- moe_6_expert_15 -->
<g id="node78" class="node">
<title>moe_6_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3817,-50778.84 3599,-50778.84 3599,-50726.84 3817,-50726.84 3817,-50778.84"/>
<text text-anchor="middle" x="3708" y="-50766.84" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3708" y="-50755.84" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3708" y="-50744.84" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3708" y="-50733.84" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_6_route&#45;&gt;moe_6_expert_15 -->
<g id="edge108" class="edge">
<title>moe_6_route&#45;&gt;moe_6_expert_15</title>
<path fill="none" stroke="black" d="M2035.71,-50846.41C2435.25,-50837.87 3277.28,-50816.2 3588.86,-50778.87"/>
<polygon fill="black" stroke="black" points="3589.32,-50782.34 3598.82,-50777.65 3588.47,-50775.39 3589.32,-50782.34"/>
</g>
<!-- moe_6_aggregate -->
<g id="node79" class="node">
<title>moe_6_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1878" cy="-50654.07" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1878" y="-50668.07" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1878" y="-50657.07" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1878" y="-50646.07" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1878" y="-50635.07" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_6_expert_0&#45;&gt;moe_6_aggregate -->
<g id="edge109" class="edge">
<title>moe_6_expert_0&#45;&gt;moe_6_aggregate</title>
<path fill="none" stroke="black" d="M277.18,-50728.05C280.15,-50727.62 283.09,-50727.21 286,-50726.84 542.24,-50694.14 1271.72,-50670.96 1647.71,-50660.81"/>
<polygon fill="black" stroke="black" points="1648,-50664.3 1657.9,-50660.53 1647.81,-50657.31 1648,-50664.3"/>
</g>
<!-- moe_6_expert_1&#45;&gt;moe_6_aggregate -->
<g id="edge110" class="edge">
<title>moe_6_expert_1&#45;&gt;moe_6_aggregate</title>
<path fill="none" stroke="black" d="M513.19,-50728.08C516.15,-50727.64 519.09,-50727.22 522,-50726.84 913.58,-50675.32 1373.38,-50660.49 1644.4,-50656.4"/>
<polygon fill="black" stroke="black" points="1644.82,-50659.9 1654.77,-50656.25 1644.71,-50652.9 1644.82,-50659.9"/>
</g>
<!-- moe_6_expert_2&#45;&gt;moe_6_aggregate -->
<g id="edge111" class="edge">
<title>moe_6_expert_2&#45;&gt;moe_6_aggregate</title>
<path fill="none" stroke="black" d="M749.19,-50728.13C752.16,-50727.67 755.1,-50727.24 758,-50726.84 1063.76,-50684.88 1419.92,-50667.37 1647.06,-50660.12"/>
<polygon fill="black" stroke="black" points="1647.22,-50663.61 1657.1,-50659.8 1647,-50656.62 1647.22,-50663.61"/>
</g>
<!-- moe_6_expert_3&#45;&gt;moe_6_aggregate -->
<g id="edge112" class="edge">
<title>moe_6_expert_3&#45;&gt;moe_6_aggregate</title>
<path fill="none" stroke="black" d="M985.2,-50728.19C988.16,-50727.72 991.1,-50727.26 994,-50726.84 1217.37,-50694.25 1474.81,-50675.45 1654.05,-50665.33"/>
<polygon fill="black" stroke="black" points="1654.34,-50668.82 1664.13,-50664.77 1653.95,-50661.83 1654.34,-50668.82"/>
</g>
<!-- moe_6_expert_4&#45;&gt;moe_6_aggregate -->
<g id="edge113" class="edge">
<title>moe_6_expert_4&#45;&gt;moe_6_aggregate</title>
<path fill="none" stroke="black" d="M1221.22,-50728.31C1224.17,-50727.8 1227.11,-50727.31 1230,-50726.84 1376.89,-50703.21 1543.76,-50684.92 1671.38,-50672.72"/>
<polygon fill="black" stroke="black" points="1672.04,-50676.18 1681.66,-50671.75 1671.38,-50669.21 1672.04,-50676.18"/>
</g>
<!-- moe_6_expert_5&#45;&gt;moe_6_aggregate -->
<g id="edge114" class="edge">
<title>moe_6_expert_5&#45;&gt;moe_6_aggregate</title>
<path fill="none" stroke="black" d="M1457.26,-50728.55C1460.2,-50727.97 1463.12,-50727.4 1466,-50726.84 1547.19,-50711.17 1637.68,-50695.24 1713.13,-50682.38"/>
<polygon fill="black" stroke="black" points="1713.93,-50685.8 1723.2,-50680.67 1712.75,-50678.9 1713.93,-50685.8"/>
</g>
<!-- moe_6_expert_6&#45;&gt;moe_6_aggregate -->
<g id="edge115" class="edge">
<title>moe_6_expert_6&#45;&gt;moe_6_aggregate</title>
<path fill="none" stroke="black" d="M1660.09,-50726.79C1693.75,-50715.72 1733.93,-50702.49 1770.57,-50690.43"/>
<polygon fill="black" stroke="black" points="1771.89,-50693.68 1780.3,-50687.23 1769.7,-50687.03 1771.89,-50693.68"/>
</g>
<!-- moe_6_expert_7&#45;&gt;moe_6_aggregate -->
<g id="edge116" class="edge">
<title>moe_6_expert_7&#45;&gt;moe_6_aggregate</title>
<path fill="none" stroke="black" d="M1835.09,-50726.67C1840.07,-50718.35 1845.78,-50708.83 1851.36,-50699.51"/>
<polygon fill="black" stroke="black" points="1854.52,-50701.06 1856.66,-50690.68 1848.51,-50697.46 1854.52,-50701.06"/>
</g>
<!-- moe_6_expert_8&#45;&gt;moe_6_aggregate -->
<g id="edge117" class="edge">
<title>moe_6_expert_8&#45;&gt;moe_6_aggregate</title>
<path fill="none" stroke="black" d="M2009.7,-50726.67C1991.48,-50716.77 1970.14,-50705.16 1950,-50694.22"/>
<polygon fill="black" stroke="black" points="1951.61,-50691.11 1941.16,-50689.41 1948.27,-50697.26 1951.61,-50691.11"/>
</g>
<!-- moe_6_expert_9&#45;&gt;moe_6_aggregate -->
<g id="edge118" class="edge">
<title>moe_6_expert_9&#45;&gt;moe_6_aggregate</title>
<path fill="none" stroke="black" d="M2184.85,-50726.79C2132.64,-50714.59 2069.29,-50699.78 2013.73,-50686.8"/>
<polygon fill="black" stroke="black" points="2014.35,-50683.35 2003.82,-50684.48 2012.76,-50690.16 2014.35,-50683.35"/>
</g>
<!-- moe_6_expert_10&#45;&gt;moe_6_aggregate -->
<g id="edge119" class="edge">
<title>moe_6_expert_10&#45;&gt;moe_6_aggregate</title>
<path fill="none" stroke="black" d="M2418.76,-50728.4C2415.81,-50727.86 2412.89,-50727.34 2410,-50726.84 2297.02,-50707.28 2169.76,-50689.94 2068.05,-50677.21"/>
<polygon fill="black" stroke="black" points="2068.33,-50673.72 2057.97,-50675.96 2067.46,-50680.67 2068.33,-50673.72"/>
</g>
<!-- moe_6_expert_11&#45;&gt;moe_6_aggregate -->
<g id="edge120" class="edge">
<title>moe_6_expert_11&#45;&gt;moe_6_aggregate</title>
<path fill="none" stroke="black" d="M2654.79,-50728.24C2651.83,-50727.75 2648.9,-50727.28 2646,-50726.84 2461.23,-50698.73 2249.67,-50679.94 2095.44,-50668.66"/>
<polygon fill="black" stroke="black" points="2095.6,-50665.16 2085.37,-50667.93 2095.09,-50672.15 2095.6,-50665.16"/>
</g>
<!-- moe_6_expert_12&#45;&gt;moe_6_aggregate -->
<g id="edge121" class="edge">
<title>moe_6_expert_12&#45;&gt;moe_6_aggregate</title>
<path fill="none" stroke="black" d="M2890.8,-50728.15C2887.84,-50727.69 2884.9,-50727.25 2882,-50726.84 2617.39,-50689.53 2310.66,-50671.19 2106.55,-50662.46"/>
<polygon fill="black" stroke="black" points="2106.44,-50658.95 2096.3,-50662.03 2106.15,-50665.95 2106.44,-50658.95"/>
</g>
<!-- moe_6_expert_13&#45;&gt;moe_6_aggregate -->
<g id="edge122" class="edge">
<title>moe_6_expert_13&#45;&gt;moe_6_aggregate</title>
<path fill="none" stroke="black" d="M3126.81,-50728.1C3123.85,-50727.65 3120.91,-50727.23 3118,-50726.84 2768.99,-50680.04 2360.68,-50663.74 2110.74,-50658.08"/>
<polygon fill="black" stroke="black" points="2110.51,-50654.57 2100.44,-50657.85 2110.36,-50661.57 2110.51,-50654.57"/>
</g>
<!-- moe_6_expert_14&#45;&gt;moe_6_aggregate -->
<g id="edge123" class="edge">
<title>moe_6_expert_14&#45;&gt;moe_6_aggregate</title>
<path fill="none" stroke="black" d="M3362.81,-50728.07C3359.85,-50727.63 3356.91,-50727.22 3354,-50726.84 2917.73,-50670.39 2403.72,-50657.36 2111.82,-50654.91"/>
<polygon fill="black" stroke="black" points="2111.56,-50651.41 2101.53,-50654.83 2111.5,-50658.41 2111.56,-50651.41"/>
</g>
<!-- moe_6_expert_15&#45;&gt;moe_6_aggregate -->
<g id="edge124" class="edge">
<title>moe_6_expert_15&#45;&gt;moe_6_aggregate</title>
<path fill="none" stroke="black" d="M3598.82,-50728.04C3595.85,-50727.61 3592.91,-50727.21 3590,-50726.84 3310.63,-50691.64 2508.27,-50669.25 2109.16,-50659.98"/>
<polygon fill="black" stroke="black" points="2109.01,-50656.47 2098.94,-50659.74 2108.85,-50663.47 2109.01,-50656.47"/>
</g>
<!-- moe_6_ffn -->
<g id="node80" class="node">
<title>moe_6_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2036,-50581.3 1720,-50581.3 1720,-50529.3 2036,-50529.3 2036,-50581.3"/>
<text text-anchor="middle" x="1878" y="-50569.3" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1878" y="-50558.3" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1878" y="-50547.3" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1878" y="-50536.3" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_6_aggregate&#45;&gt;moe_6_ffn -->
<g id="edge125" class="edge">
<title>moe_6_aggregate&#45;&gt;moe_6_ffn</title>
<path fill="none" stroke="black" d="M1878,-50617.04C1878,-50608.73 1878,-50599.89 1878,-50591.61"/>
<polygon fill="black" stroke="black" points="1881.5,-50591.5 1878,-50581.5 1874.5,-50591.5 1881.5,-50591.5"/>
</g>
<!-- moe_6_res2 -->
<g id="node82" class="node">
<title>moe_6_res2</title>
<polygon fill="lightyellow" stroke="black" points="2214.89,-50493.3 1678.97,-50493.3 1541.11,-50389.3 2077.03,-50389.3 2214.89,-50493.3"/>
<text text-anchor="middle" x="1878" y="-50455.3" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1878" y="-50444.3" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1878" y="-50433.3" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1878" y="-50422.3" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_6_ffn&#45;&gt;moe_6_res2 -->
<g id="edge126" class="edge">
<title>moe_6_ffn&#45;&gt;moe_6_res2</title>
<path fill="none" stroke="black" d="M1878,-50529.17C1878,-50521.48 1878,-50512.67 1878,-50503.67"/>
<polygon fill="black" stroke="black" points="1881.5,-50503.48 1878,-50493.48 1874.5,-50503.48 1881.5,-50503.48"/>
</g>
<!-- moe_6_res1&#45;&gt;moe_6_gate -->
<g id="edge91" class="edge">
<title>moe_6_res1&#45;&gt;moe_6_gate</title>
<path fill="none" stroke="black" d="M1820,-51063.99C1820,-51055.82 1820,-51047.3 1820,-51038.92"/>
<polygon fill="black" stroke="black" points="1823.5,-51038.81 1820,-51028.81 1816.5,-51038.81 1823.5,-51038.81"/>
</g>
<!-- moe_7_mha -->
<g id="node83" class="node">
<title>moe_7_mha</title>
<polygon fill="lightgreen" stroke="black" points="2036,-50342.3 1720,-50342.3 1720,-50290.3 2036,-50290.3 2036,-50342.3"/>
<text text-anchor="middle" x="1878" y="-50330.3" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1878" y="-50319.3" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1878" y="-50308.3" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1878" y="-50297.3" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_6_res2&#45;&gt;moe_7_mha -->
<g id="edge127" class="edge">
<title>moe_6_res2&#45;&gt;moe_7_mha</title>
<path fill="none" stroke="black" d="M1878,-50389.21C1878,-50376.88 1878,-50363.97 1878,-50352.55"/>
<polygon fill="black" stroke="black" points="1881.5,-50352.54 1878,-50342.54 1874.5,-50352.54 1881.5,-50352.54"/>
</g>
<!-- moe_7_res1 -->
<g id="node104" class="node">
<title>moe_7_res1</title>
<polygon fill="lightyellow" stroke="black" points="2214.89,-50254.3 1678.97,-50254.3 1541.11,-50150.3 2077.03,-50150.3 2214.89,-50254.3"/>
<text text-anchor="middle" x="1878" y="-50216.3" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1878" y="-50205.3" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1878" y="-50194.3" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1878" y="-50183.3" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_7_mha&#45;&gt;moe_7_res1 -->
<g id="edge128" class="edge">
<title>moe_7_mha&#45;&gt;moe_7_res1</title>
<path fill="none" stroke="black" d="M1878,-50290.17C1878,-50282.48 1878,-50273.67 1878,-50264.67"/>
<polygon fill="black" stroke="black" points="1881.5,-50264.48 1878,-50254.48 1874.5,-50264.48 1881.5,-50264.48"/>
</g>
<!-- moe_7_gate -->
<g id="node84" class="node">
<title>moe_7_gate</title>
<polygon fill="lightyellow" stroke="black" points="2206.8,-50114.3 1683.75,-50114.3 1549.2,-50010.3 2072.25,-50010.3 2206.8,-50114.3"/>
<text text-anchor="middle" x="1878" y="-50076.3" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1878" y="-50065.3" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1878" y="-50054.3" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1878" y="-50043.3" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_7_route -->
<g id="node85" class="node">
<title>moe_7_route</title>
<ellipse fill="lightblue" stroke="black" cx="1878" cy="-49937.53" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1878" y="-49951.53" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1878" y="-49940.53" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1878" y="-49929.53" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1878" y="-49918.53" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_7_gate&#45;&gt;moe_7_route -->
<g id="edge130" class="edge">
<title>moe_7_gate&#45;&gt;moe_7_route</title>
<path fill="none" stroke="black" d="M1878,-50009.95C1878,-50001.54 1878,-49992.87 1878,-49984.6"/>
<polygon fill="black" stroke="black" points="1881.5,-49984.39 1878,-49974.39 1874.5,-49984.39 1881.5,-49984.39"/>
</g>
<!-- moe_7_expert_0 -->
<g id="node86" class="node">
<title>moe_7_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="335,-49864.76 117,-49864.76 117,-49812.76 335,-49812.76 335,-49864.76"/>
<text text-anchor="middle" x="226" y="-49852.76" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="226" y="-49841.76" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="226" y="-49830.76" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="226" y="-49819.76" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_7_route&#45;&gt;moe_7_expert_0 -->
<g id="edge131" class="edge">
<title>moe_7_route&#45;&gt;moe_7_expert_0</title>
<path fill="none" stroke="black" d="M1663.77,-49930.8C1308.39,-49920.58 610.65,-49897.31 345.21,-49864.8"/>
<polygon fill="black" stroke="black" points="345.54,-49861.32 335.18,-49863.54 344.67,-49868.26 345.54,-49861.32"/>
</g>
<!-- moe_7_expert_1 -->
<g id="node87" class="node">
<title>moe_7_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="571,-49864.76 353,-49864.76 353,-49812.76 571,-49812.76 571,-49864.76"/>
<text text-anchor="middle" x="462" y="-49852.76" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="462" y="-49841.76" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="462" y="-49830.76" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="462" y="-49819.76" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_7_route&#45;&gt;moe_7_expert_1 -->
<g id="edge132" class="edge">
<title>moe_7_route&#45;&gt;moe_7_expert_1</title>
<path fill="none" stroke="black" d="M1660.59,-49934.68C1404.22,-49930.18 965.4,-49915.19 581.11,-49864.82"/>
<polygon fill="black" stroke="black" points="581.56,-49861.35 571.19,-49863.51 580.64,-49868.29 581.56,-49861.35"/>
</g>
<!-- moe_7_expert_2 -->
<g id="node88" class="node">
<title>moe_7_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="807,-49864.76 589,-49864.76 589,-49812.76 807,-49812.76 807,-49864.76"/>
<text text-anchor="middle" x="698" y="-49852.76" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="698" y="-49841.76" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="698" y="-49830.76" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="698" y="-49819.76" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_7_route&#45;&gt;moe_7_expert_2 -->
<g id="edge133" class="edge">
<title>moe_7_route&#45;&gt;moe_7_expert_2</title>
<path fill="none" stroke="black" d="M1663.51,-49930.93C1450.77,-49923.31 1115.57,-49905.75 817.34,-49864.87"/>
<polygon fill="black" stroke="black" points="817.58,-49861.37 807.2,-49863.46 816.62,-49868.3 817.58,-49861.37"/>
</g>
<!-- moe_7_expert_3 -->
<g id="node89" class="node">
<title>moe_7_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1043,-49864.76 825,-49864.76 825,-49812.76 1043,-49812.76 1043,-49864.76"/>
<text text-anchor="middle" x="934" y="-49852.76" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="934" y="-49841.76" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="934" y="-49830.76" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="934" y="-49819.76" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_7_route&#45;&gt;moe_7_expert_3 -->
<g id="edge134" class="edge">
<title>moe_7_route&#45;&gt;moe_7_expert_3</title>
<path fill="none" stroke="black" d="M1671.82,-49925.62C1506.76,-49915.24 1269.32,-49896.59 1053.16,-49864.86"/>
<polygon fill="black" stroke="black" points="1053.61,-49861.39 1043.21,-49863.39 1052.59,-49868.32 1053.61,-49861.39"/>
</g>
<!-- moe_7_expert_4 -->
<g id="node90" class="node">
<title>moe_7_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1279,-49864.76 1061,-49864.76 1061,-49812.76 1279,-49812.76 1279,-49864.76"/>
<text text-anchor="middle" x="1170" y="-49852.76" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1170" y="-49841.76" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1170" y="-49830.76" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1170" y="-49819.76" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_7_route&#45;&gt;moe_7_expert_4 -->
<g id="edge135" class="edge">
<title>moe_7_route&#45;&gt;moe_7_expert_4</title>
<path fill="none" stroke="black" d="M1692.38,-49918.17C1578.62,-49905.9 1429.9,-49888.05 1289.33,-49864.93"/>
<polygon fill="black" stroke="black" points="1289.66,-49861.44 1279.23,-49863.26 1288.52,-49868.34 1289.66,-49861.44"/>
</g>
<!-- moe_7_expert_5 -->
<g id="node91" class="node">
<title>moe_7_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1515,-49864.76 1297,-49864.76 1297,-49812.76 1515,-49812.76 1515,-49864.76"/>
<text text-anchor="middle" x="1406" y="-49852.76" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1406" y="-49841.76" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1406" y="-49830.76" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1406" y="-49819.76" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_7_route&#45;&gt;moe_7_expert_5 -->
<g id="edge136" class="edge">
<title>moe_7_route&#45;&gt;moe_7_expert_5</title>
<path fill="none" stroke="black" d="M1740.51,-49908.95C1677.62,-49896.26 1601.88,-49880.88 1525.14,-49864.99"/>
<polygon fill="black" stroke="black" points="1525.79,-49861.55 1515.28,-49862.95 1524.37,-49868.41 1525.79,-49861.55"/>
</g>
<!-- moe_7_expert_6 -->
<g id="node92" class="node">
<title>moe_7_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1751,-49864.76 1533,-49864.76 1533,-49812.76 1751,-49812.76 1751,-49864.76"/>
<text text-anchor="middle" x="1642" y="-49852.76" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1642" y="-49841.76" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1642" y="-49830.76" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1642" y="-49819.76" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_7_route&#45;&gt;moe_7_expert_6 -->
<g id="edge137" class="edge">
<title>moe_7_route&#45;&gt;moe_7_expert_6</title>
<path fill="none" stroke="black" d="M1797.11,-49903.36C1769.54,-49892.06 1738.96,-49879.52 1712.29,-49868.58"/>
<polygon fill="black" stroke="black" points="1713.61,-49865.34 1703.03,-49864.79 1710.95,-49871.82 1713.61,-49865.34"/>
</g>
<!-- moe_7_expert_7 -->
<g id="node93" class="node">
<title>moe_7_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1987,-49864.76 1769,-49864.76 1769,-49812.76 1987,-49812.76 1987,-49864.76"/>
<text text-anchor="middle" x="1878" y="-49852.76" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1878" y="-49841.76" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1878" y="-49830.76" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1878" y="-49819.76" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_7_route&#45;&gt;moe_7_expert_7 -->
<g id="edge138" class="edge">
<title>moe_7_route&#45;&gt;moe_7_expert_7</title>
<path fill="none" stroke="black" d="M1878,-49900.5C1878,-49892.19 1878,-49883.35 1878,-49875.07"/>
<polygon fill="black" stroke="black" points="1881.5,-49874.96 1878,-49864.96 1874.5,-49874.96 1881.5,-49874.96"/>
</g>
<!-- moe_7_expert_8 -->
<g id="node94" class="node">
<title>moe_7_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2223,-49864.76 2005,-49864.76 2005,-49812.76 2223,-49812.76 2223,-49864.76"/>
<text text-anchor="middle" x="2114" y="-49852.76" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2114" y="-49841.76" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2114" y="-49830.76" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2114" y="-49819.76" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_7_route&#45;&gt;moe_7_expert_8 -->
<g id="edge139" class="edge">
<title>moe_7_route&#45;&gt;moe_7_expert_8</title>
<path fill="none" stroke="black" d="M1958.89,-49903.36C1986.46,-49892.06 2017.04,-49879.52 2043.71,-49868.58"/>
<polygon fill="black" stroke="black" points="2045.05,-49871.82 2052.97,-49864.79 2042.39,-49865.34 2045.05,-49871.82"/>
</g>
<!-- moe_7_expert_9 -->
<g id="node95" class="node">
<title>moe_7_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2459,-49864.76 2241,-49864.76 2241,-49812.76 2459,-49812.76 2459,-49864.76"/>
<text text-anchor="middle" x="2350" y="-49852.76" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2350" y="-49841.76" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2350" y="-49830.76" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2350" y="-49819.76" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_7_route&#45;&gt;moe_7_expert_9 -->
<g id="edge140" class="edge">
<title>moe_7_route&#45;&gt;moe_7_expert_9</title>
<path fill="none" stroke="black" d="M2015.49,-49908.95C2078.38,-49896.26 2154.12,-49880.88 2230.86,-49864.99"/>
<polygon fill="black" stroke="black" points="2231.63,-49868.41 2240.72,-49862.95 2230.21,-49861.55 2231.63,-49868.41"/>
</g>
<!-- moe_7_expert_10 -->
<g id="node96" class="node">
<title>moe_7_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2695,-49864.76 2477,-49864.76 2477,-49812.76 2695,-49812.76 2695,-49864.76"/>
<text text-anchor="middle" x="2586" y="-49852.76" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2586" y="-49841.76" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2586" y="-49830.76" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2586" y="-49819.76" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_7_route&#45;&gt;moe_7_expert_10 -->
<g id="edge141" class="edge">
<title>moe_7_route&#45;&gt;moe_7_expert_10</title>
<path fill="none" stroke="black" d="M2063.62,-49918.17C2177.38,-49905.9 2326.1,-49888.05 2466.67,-49864.93"/>
<polygon fill="black" stroke="black" points="2467.48,-49868.34 2476.77,-49863.26 2466.34,-49861.44 2467.48,-49868.34"/>
</g>
<!-- moe_7_expert_11 -->
<g id="node97" class="node">
<title>moe_7_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2931,-49864.76 2713,-49864.76 2713,-49812.76 2931,-49812.76 2931,-49864.76"/>
<text text-anchor="middle" x="2822" y="-49852.76" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2822" y="-49841.76" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2822" y="-49830.76" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2822" y="-49819.76" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_7_route&#45;&gt;moe_7_expert_11 -->
<g id="edge142" class="edge">
<title>moe_7_route&#45;&gt;moe_7_expert_11</title>
<path fill="none" stroke="black" d="M2084.18,-49925.62C2249.24,-49915.24 2486.68,-49896.59 2702.84,-49864.86"/>
<polygon fill="black" stroke="black" points="2703.41,-49868.32 2712.79,-49863.39 2702.39,-49861.39 2703.41,-49868.32"/>
</g>
<!-- moe_7_expert_12 -->
<g id="node98" class="node">
<title>moe_7_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3167,-49864.76 2949,-49864.76 2949,-49812.76 3167,-49812.76 3167,-49864.76"/>
<text text-anchor="middle" x="3058" y="-49852.76" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3058" y="-49841.76" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3058" y="-49830.76" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3058" y="-49819.76" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_7_route&#45;&gt;moe_7_expert_12 -->
<g id="edge143" class="edge">
<title>moe_7_route&#45;&gt;moe_7_expert_12</title>
<path fill="none" stroke="black" d="M2092.49,-49930.93C2305.23,-49923.31 2640.43,-49905.75 2938.66,-49864.87"/>
<polygon fill="black" stroke="black" points="2939.38,-49868.3 2948.8,-49863.46 2938.42,-49861.37 2939.38,-49868.3"/>
</g>
<!-- moe_7_expert_13 -->
<g id="node99" class="node">
<title>moe_7_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3403,-49864.76 3185,-49864.76 3185,-49812.76 3403,-49812.76 3403,-49864.76"/>
<text text-anchor="middle" x="3294" y="-49852.76" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3294" y="-49841.76" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3294" y="-49830.76" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3294" y="-49819.76" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_7_route&#45;&gt;moe_7_expert_13 -->
<g id="edge144" class="edge">
<title>moe_7_route&#45;&gt;moe_7_expert_13</title>
<path fill="none" stroke="black" d="M2095.41,-49934.68C2351.78,-49930.18 2790.6,-49915.19 3174.89,-49864.82"/>
<polygon fill="black" stroke="black" points="3175.36,-49868.29 3184.81,-49863.51 3174.44,-49861.35 3175.36,-49868.29"/>
</g>
<!-- moe_7_expert_14 -->
<g id="node100" class="node">
<title>moe_7_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3639,-49864.76 3421,-49864.76 3421,-49812.76 3639,-49812.76 3639,-49864.76"/>
<text text-anchor="middle" x="3530" y="-49852.76" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3530" y="-49841.76" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3530" y="-49830.76" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3530" y="-49819.76" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_7_route&#45;&gt;moe_7_expert_14 -->
<g id="edge145" class="edge">
<title>moe_7_route&#45;&gt;moe_7_expert_14</title>
<path fill="none" stroke="black" d="M2092.23,-49930.8C2447.61,-49920.58 3145.35,-49897.31 3410.79,-49864.8"/>
<polygon fill="black" stroke="black" points="3411.33,-49868.26 3420.82,-49863.54 3410.46,-49861.32 3411.33,-49868.26"/>
</g>
<!-- moe_7_expert_15 -->
<g id="node101" class="node">
<title>moe_7_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3875,-49864.76 3657,-49864.76 3657,-49812.76 3875,-49812.76 3875,-49864.76"/>
<text text-anchor="middle" x="3766" y="-49852.76" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3766" y="-49841.76" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3766" y="-49830.76" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3766" y="-49819.76" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_7_route&#45;&gt;moe_7_expert_15 -->
<g id="edge146" class="edge">
<title>moe_7_route&#45;&gt;moe_7_expert_15</title>
<path fill="none" stroke="black" d="M2093.71,-49932.33C2493.25,-49923.79 3335.28,-49902.12 3646.86,-49864.79"/>
<polygon fill="black" stroke="black" points="3647.32,-49868.26 3656.82,-49863.57 3646.47,-49861.31 3647.32,-49868.26"/>
</g>
<!-- moe_7_aggregate -->
<g id="node102" class="node">
<title>moe_7_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1924" cy="-49739.99" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1924" y="-49753.99" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1924" y="-49742.99" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1924" y="-49731.99" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1924" y="-49720.99" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_7_expert_0&#45;&gt;moe_7_aggregate -->
<g id="edge147" class="edge">
<title>moe_7_expert_0&#45;&gt;moe_7_aggregate</title>
<path fill="none" stroke="black" d="M335.18,-49813.97C338.15,-49813.54 341.09,-49813.13 344,-49812.76 597.97,-49780.31 1320.37,-49757.05 1693.96,-49746.82"/>
<polygon fill="black" stroke="black" points="1694.19,-49750.31 1704.09,-49746.54 1694,-49743.31 1694.19,-49750.31"/>
</g>
<!-- moe_7_expert_1&#45;&gt;moe_7_aggregate -->
<g id="edge148" class="edge">
<title>moe_7_expert_1&#45;&gt;moe_7_aggregate</title>
<path fill="none" stroke="black" d="M571.19,-49814.01C574.15,-49813.56 577.09,-49813.15 580,-49812.76 967.25,-49761.72 1421.83,-49746.73 1690.69,-49742.48"/>
<polygon fill="black" stroke="black" points="1691.02,-49745.98 1700.97,-49742.32 1690.91,-49738.98 1691.02,-49745.98"/>
</g>
<!-- moe_7_expert_2&#45;&gt;moe_7_aggregate -->
<g id="edge149" class="edge">
<title>moe_7_expert_2&#45;&gt;moe_7_aggregate</title>
<path fill="none" stroke="black" d="M807.19,-49814.05C810.16,-49813.59 813.1,-49813.16 816,-49812.76 1117.39,-49771.29 1468.29,-49753.68 1693.1,-49746.27"/>
<polygon fill="black" stroke="black" points="1693.49,-49749.76 1703.37,-49745.93 1693.27,-49742.76 1693.49,-49749.76"/>
</g>
<!-- moe_7_expert_3&#45;&gt;moe_7_aggregate -->
<g id="edge150" class="edge">
<title>moe_7_expert_3&#45;&gt;moe_7_aggregate</title>
<path fill="none" stroke="black" d="M1043.2,-49814.12C1046.16,-49813.64 1049.1,-49813.19 1052,-49812.76 1271.12,-49780.66 1523.49,-49761.85 1700.16,-49751.6"/>
<polygon fill="black" stroke="black" points="1700.58,-49755.08 1710.36,-49751.01 1700.18,-49748.09 1700.58,-49755.08"/>
</g>
<!-- moe_7_expert_4&#45;&gt;moe_7_aggregate -->
<g id="edge151" class="edge">
<title>moe_7_expert_4&#45;&gt;moe_7_aggregate</title>
<path fill="none" stroke="black" d="M1279.22,-49814.24C1282.18,-49813.72 1285.11,-49813.23 1288,-49812.76 1431.37,-49789.54 1594.14,-49771.32 1719.12,-49759.05"/>
<polygon fill="black" stroke="black" points="1719.58,-49762.52 1729.19,-49758.07 1718.9,-49755.56 1719.58,-49762.52"/>
</g>
<!-- moe_7_expert_5&#45;&gt;moe_7_aggregate -->
<g id="edge152" class="edge">
<title>moe_7_expert_5&#45;&gt;moe_7_aggregate</title>
<path fill="none" stroke="black" d="M1515.27,-49814.49C1518.21,-49813.9 1521.12,-49813.33 1524,-49812.76 1602.2,-49797.47 1689.25,-49781.7 1762.13,-49768.85"/>
<polygon fill="black" stroke="black" points="1763.07,-49772.24 1772.31,-49767.06 1761.86,-49765.35 1763.07,-49772.24"/>
</g>
<!-- moe_7_expert_6&#45;&gt;moe_7_aggregate -->
<g id="edge153" class="edge">
<title>moe_7_expert_6&#45;&gt;moe_7_aggregate</title>
<path fill="none" stroke="black" d="M1714.99,-49812.72C1746.91,-49801.76 1784.95,-49788.71 1819.77,-49776.76"/>
<polygon fill="black" stroke="black" points="1821.18,-49779.98 1829.5,-49773.42 1818.9,-49773.36 1821.18,-49779.98"/>
</g>
<!-- moe_7_expert_7&#45;&gt;moe_7_aggregate -->
<g id="edge154" class="edge">
<title>moe_7_expert_7&#45;&gt;moe_7_aggregate</title>
<path fill="none" stroke="black" d="M1889.97,-49812.59C1893.84,-49804.44 1898.26,-49795.14 1902.6,-49786"/>
<polygon fill="black" stroke="black" points="1905.77,-49787.5 1906.9,-49776.97 1899.44,-49784.5 1905.77,-49787.5"/>
</g>
<!-- moe_7_expert_8&#45;&gt;moe_7_aggregate -->
<g id="edge155" class="edge">
<title>moe_7_expert_8&#45;&gt;moe_7_aggregate</title>
<path fill="none" stroke="black" d="M2064.58,-49812.59C2044.95,-49802.59 2021.92,-49790.87 2000.25,-49779.83"/>
<polygon fill="black" stroke="black" points="2001.56,-49776.57 1991.06,-49775.15 1998.38,-49782.8 2001.56,-49776.57"/>
</g>
<!-- moe_7_expert_9&#45;&gt;moe_7_aggregate -->
<g id="edge156" class="edge">
<title>moe_7_expert_9&#45;&gt;moe_7_aggregate</title>
<path fill="none" stroke="black" d="M2240.85,-49812.97C2186.55,-49800.63 2120.33,-49785.59 2062.5,-49772.45"/>
<polygon fill="black" stroke="black" points="2063.08,-49769 2052.55,-49770.19 2061.52,-49775.82 2063.08,-49769"/>
</g>
<!-- moe_7_expert_10&#45;&gt;moe_7_aggregate -->
<g id="edge157" class="edge">
<title>moe_7_expert_10&#45;&gt;moe_7_aggregate</title>
<path fill="none" stroke="black" d="M2476.77,-49814.31C2473.82,-49813.77 2470.89,-49813.26 2468,-49812.76 2351.58,-49792.78 2220.31,-49775.32 2115.89,-49762.62"/>
<polygon fill="black" stroke="black" points="2116.21,-49759.14 2105.87,-49761.41 2115.37,-49766.09 2116.21,-49759.14"/>
</g>
<!-- moe_7_expert_11&#45;&gt;moe_7_aggregate -->
<g id="edge158" class="edge">
<title>moe_7_expert_11&#45;&gt;moe_7_aggregate</title>
<path fill="none" stroke="black" d="M2712.79,-49814.16C2709.83,-49813.67 2706.9,-49813.2 2704,-49812.76 2515.36,-49784.2 2299.22,-49765.39 2142.38,-49754.22"/>
<polygon fill="black" stroke="black" points="2142.36,-49750.71 2132.13,-49753.5 2141.86,-49757.69 2142.36,-49750.71"/>
</g>
<!-- moe_7_expert_12&#45;&gt;moe_7_aggregate -->
<g id="edge159" class="edge">
<title>moe_7_expert_12&#45;&gt;moe_7_aggregate</title>
<path fill="none" stroke="black" d="M2948.8,-49814.07C2945.84,-49813.61 2942.9,-49813.17 2940,-49812.76 2671.23,-49774.98 2359.53,-49756.71 2152.99,-49748.13"/>
<polygon fill="black" stroke="black" points="2153.06,-49744.63 2142.93,-49747.71 2152.77,-49751.62 2153.06,-49744.63"/>
</g>
<!-- moe_7_expert_13&#45;&gt;moe_7_aggregate -->
<g id="edge160" class="edge">
<title>moe_7_expert_13&#45;&gt;moe_7_aggregate</title>
<path fill="none" stroke="black" d="M3184.81,-49814.02C3181.85,-49813.57 3178.91,-49813.15 3176,-49812.76 2822.5,-49765.46 2408.76,-49749.31 2156.62,-49743.81"/>
<polygon fill="black" stroke="black" points="2156.67,-49740.31 2146.6,-49743.59 2156.52,-49747.31 2156.67,-49740.31"/>
</g>
<!-- moe_7_expert_14&#45;&gt;moe_7_aggregate -->
<g id="edge161" class="edge">
<title>moe_7_expert_14&#45;&gt;moe_7_aggregate</title>
<path fill="none" stroke="black" d="M3420.81,-49813.99C3417.85,-49813.55 3414.91,-49813.14 3412,-49812.76 2971.23,-49755.82 2451.75,-49742.98 2157.82,-49740.7"/>
<polygon fill="black" stroke="black" points="2157.48,-49737.2 2147.46,-49740.62 2157.43,-49744.2 2157.48,-49737.2"/>
</g>
<!-- moe_7_expert_15&#45;&gt;moe_7_aggregate -->
<g id="edge162" class="edge">
<title>moe_7_expert_15&#45;&gt;moe_7_aggregate</title>
<path fill="none" stroke="black" d="M3656.82,-49813.96C3653.85,-49813.53 3650.91,-49813.13 3648,-49812.76 3366.3,-49777.31 2556.57,-49755.01 2155.21,-49745.82"/>
<polygon fill="black" stroke="black" points="2155,-49742.32 2144.92,-49745.59 2154.84,-49749.32 2155,-49742.32"/>
</g>
<!-- moe_7_ffn -->
<g id="node103" class="node">
<title>moe_7_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2082,-49667.22 1766,-49667.22 1766,-49615.22 2082,-49615.22 2082,-49667.22"/>
<text text-anchor="middle" x="1924" y="-49655.22" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1924" y="-49644.22" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1924" y="-49633.22" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1924" y="-49622.22" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_7_aggregate&#45;&gt;moe_7_ffn -->
<g id="edge163" class="edge">
<title>moe_7_aggregate&#45;&gt;moe_7_ffn</title>
<path fill="none" stroke="black" d="M1924,-49702.96C1924,-49694.65 1924,-49685.81 1924,-49677.53"/>
<polygon fill="black" stroke="black" points="1927.5,-49677.42 1924,-49667.42 1920.5,-49677.42 1927.5,-49677.42"/>
</g>
<!-- moe_7_res2 -->
<g id="node105" class="node">
<title>moe_7_res2</title>
<polygon fill="lightyellow" stroke="black" points="2260.89,-49579.22 1724.97,-49579.22 1587.11,-49475.22 2123.03,-49475.22 2260.89,-49579.22"/>
<text text-anchor="middle" x="1924" y="-49541.22" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1924" y="-49530.22" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1924" y="-49519.22" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1924" y="-49508.22" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_7_ffn&#45;&gt;moe_7_res2 -->
<g id="edge164" class="edge">
<title>moe_7_ffn&#45;&gt;moe_7_res2</title>
<path fill="none" stroke="black" d="M1924,-49615.09C1924,-49607.4 1924,-49598.59 1924,-49589.59"/>
<polygon fill="black" stroke="black" points="1927.5,-49589.4 1924,-49579.4 1920.5,-49589.4 1927.5,-49589.4"/>
</g>
<!-- moe_7_res1&#45;&gt;moe_7_gate -->
<g id="edge129" class="edge">
<title>moe_7_res1&#45;&gt;moe_7_gate</title>
<path fill="none" stroke="black" d="M1878,-50149.92C1878,-50141.74 1878,-50133.22 1878,-50124.84"/>
<polygon fill="black" stroke="black" points="1881.5,-50124.73 1878,-50114.73 1874.5,-50124.73 1881.5,-50124.73"/>
</g>
<!-- moe_8_mha -->
<g id="node106" class="node">
<title>moe_8_mha</title>
<polygon fill="lightgreen" stroke="black" points="2082,-49428.22 1766,-49428.22 1766,-49376.22 2082,-49376.22 2082,-49428.22"/>
<text text-anchor="middle" x="1924" y="-49416.22" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1924" y="-49405.22" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1924" y="-49394.22" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1924" y="-49383.22" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_7_res2&#45;&gt;moe_8_mha -->
<g id="edge165" class="edge">
<title>moe_7_res2&#45;&gt;moe_8_mha</title>
<path fill="none" stroke="black" d="M1924,-49475.13C1924,-49462.8 1924,-49449.89 1924,-49438.47"/>
<polygon fill="black" stroke="black" points="1927.5,-49438.46 1924,-49428.46 1920.5,-49438.46 1927.5,-49438.46"/>
</g>
<!-- moe_8_res1 -->
<g id="node127" class="node">
<title>moe_8_res1</title>
<polygon fill="lightyellow" stroke="black" points="2260.89,-49340.22 1724.97,-49340.22 1587.11,-49236.22 2123.03,-49236.22 2260.89,-49340.22"/>
<text text-anchor="middle" x="1924" y="-49302.22" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1924" y="-49291.22" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1924" y="-49280.22" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1924" y="-49269.22" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_8_mha&#45;&gt;moe_8_res1 -->
<g id="edge166" class="edge">
<title>moe_8_mha&#45;&gt;moe_8_res1</title>
<path fill="none" stroke="black" d="M1924,-49376.09C1924,-49368.4 1924,-49359.59 1924,-49350.59"/>
<polygon fill="black" stroke="black" points="1927.5,-49350.4 1924,-49340.4 1920.5,-49350.4 1927.5,-49350.4"/>
</g>
<!-- moe_8_gate -->
<g id="node107" class="node">
<title>moe_8_gate</title>
<polygon fill="lightyellow" stroke="black" points="2252.8,-49200.22 1729.75,-49200.22 1595.2,-49096.22 2118.25,-49096.22 2252.8,-49200.22"/>
<text text-anchor="middle" x="1924" y="-49162.22" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1924" y="-49151.22" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1924" y="-49140.22" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1924" y="-49129.22" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_8_route -->
<g id="node108" class="node">
<title>moe_8_route</title>
<ellipse fill="lightblue" stroke="black" cx="1924" cy="-49023.45" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1924" y="-49037.45" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1924" y="-49026.45" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1924" y="-49015.45" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1924" y="-49004.45" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_8_gate&#45;&gt;moe_8_route -->
<g id="edge168" class="edge">
<title>moe_8_gate&#45;&gt;moe_8_route</title>
<path fill="none" stroke="black" d="M1924,-49095.87C1924,-49087.46 1924,-49078.79 1924,-49070.52"/>
<polygon fill="black" stroke="black" points="1927.5,-49070.31 1924,-49060.31 1920.5,-49070.31 1927.5,-49070.31"/>
</g>
<!-- moe_8_expert_0 -->
<g id="node109" class="node">
<title>moe_8_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="292,-48950.68 74,-48950.68 74,-48898.68 292,-48898.68 292,-48950.68"/>
<text text-anchor="middle" x="183" y="-48938.68" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="183" y="-48927.68" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="183" y="-48916.68" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="183" y="-48905.68" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_8_route&#45;&gt;moe_8_expert_0 -->
<g id="edge169" class="edge">
<title>moe_8_route&#45;&gt;moe_8_expert_0</title>
<path fill="none" stroke="black" d="M1709,-49017.34C1336.67,-49007.76 585.43,-48985.05 302.46,-48950.75"/>
<polygon fill="black" stroke="black" points="302.54,-48947.24 292.18,-48949.48 301.68,-48954.18 302.54,-48947.24"/>
</g>
<!-- moe_8_expert_1 -->
<g id="node110" class="node">
<title>moe_8_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="528,-48950.68 310,-48950.68 310,-48898.68 528,-48898.68 528,-48950.68"/>
<text text-anchor="middle" x="419" y="-48938.68" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="419" y="-48927.68" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="419" y="-48916.68" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="419" y="-48905.68" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_8_route&#45;&gt;moe_8_expert_1 -->
<g id="edge170" class="edge">
<title>moe_8_route&#45;&gt;moe_8_expert_1</title>
<path fill="none" stroke="black" d="M1706.23,-49021.73C1434.48,-49018.43 955.71,-49004.73 538.34,-48950.77"/>
<polygon fill="black" stroke="black" points="538.56,-48947.27 528.19,-48949.45 537.65,-48954.21 538.56,-48947.27"/>
</g>
<!-- moe_8_expert_2 -->
<g id="node111" class="node">
<title>moe_8_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="764,-48950.68 546,-48950.68 546,-48898.68 764,-48898.68 764,-48950.68"/>
<text text-anchor="middle" x="655" y="-48938.68" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="655" y="-48927.68" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="655" y="-48916.68" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="655" y="-48905.68" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_8_route&#45;&gt;moe_8_expert_2 -->
<g id="edge171" class="edge">
<title>moe_8_route&#45;&gt;moe_8_expert_2</title>
<path fill="none" stroke="black" d="M1708.02,-49018.42C1478.4,-49011.95 1104.73,-48995.21 774.44,-48950.8"/>
<polygon fill="black" stroke="black" points="774.57,-48947.28 764.19,-48949.41 773.63,-48954.22 774.57,-48947.28"/>
</g>
<!-- moe_8_expert_3 -->
<g id="node112" class="node">
<title>moe_8_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1000,-48950.68 782,-48950.68 782,-48898.68 1000,-48898.68 1000,-48950.68"/>
<text text-anchor="middle" x="891" y="-48938.68" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="891" y="-48927.68" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="891" y="-48916.68" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="891" y="-48905.68" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_8_route&#45;&gt;moe_8_expert_3 -->
<g id="edge172" class="edge">
<title>moe_8_route&#45;&gt;moe_8_expert_3</title>
<path fill="none" stroke="black" d="M1713.72,-49013.77C1530.25,-49004.36 1256.9,-48985.93 1010.43,-48950.81"/>
<polygon fill="black" stroke="black" points="1010.6,-48947.3 1000.2,-48949.34 1009.6,-48954.23 1010.6,-48947.3"/>
</g>
<!-- moe_8_expert_4 -->
<g id="node113" class="node">
<title>moe_8_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1236,-48950.68 1018,-48950.68 1018,-48898.68 1236,-48898.68 1236,-48950.68"/>
<text text-anchor="middle" x="1127" y="-48938.68" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1127" y="-48927.68" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1127" y="-48916.68" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1127" y="-48905.68" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_8_route&#45;&gt;moe_8_expert_4 -->
<g id="edge173" class="edge">
<title>moe_8_route&#45;&gt;moe_8_expert_4</title>
<path fill="none" stroke="black" d="M1728.29,-49007.17C1594.92,-48995.46 1414.23,-48977.07 1246.24,-48950.82"/>
<polygon fill="black" stroke="black" points="1246.64,-48947.34 1236.22,-48949.24 1245.55,-48954.25 1246.64,-48947.34"/>
</g>
<!-- moe_8_expert_5 -->
<g id="node114" class="node">
<title>moe_8_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1472,-48950.68 1254,-48950.68 1254,-48898.68 1472,-48898.68 1472,-48950.68"/>
<text text-anchor="middle" x="1363" y="-48938.68" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1363" y="-48927.68" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1363" y="-48916.68" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1363" y="-48905.68" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_8_route&#45;&gt;moe_8_expert_5 -->
<g id="edge174" class="edge">
<title>moe_8_route&#45;&gt;moe_8_expert_5</title>
<path fill="none" stroke="black" d="M1764,-48998.44C1682.36,-48985.72 1581.29,-48969.26 1482.15,-48950.87"/>
<polygon fill="black" stroke="black" points="1482.73,-48947.42 1472.25,-48949.02 1481.44,-48954.3 1482.73,-48947.42"/>
</g>
<!-- moe_8_expert_6 -->
<g id="node115" class="node">
<title>moe_8_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1708,-48950.68 1490,-48950.68 1490,-48898.68 1708,-48898.68 1708,-48950.68"/>
<text text-anchor="middle" x="1599" y="-48938.68" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1599" y="-48927.68" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1599" y="-48916.68" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1599" y="-48905.68" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_8_route&#45;&gt;moe_8_expert_6 -->
<g id="edge175" class="edge">
<title>moe_8_route&#45;&gt;moe_8_expert_6</title>
<path fill="none" stroke="black" d="M1818.93,-48991.17C1778.41,-48979.1 1732.42,-48965.41 1693.02,-48953.68"/>
<polygon fill="black" stroke="black" points="1693.73,-48950.24 1683.15,-48950.74 1691.73,-48956.95 1693.73,-48950.24"/>
</g>
<!-- moe_8_expert_7 -->
<g id="node116" class="node">
<title>moe_8_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1944,-48950.68 1726,-48950.68 1726,-48898.68 1944,-48898.68 1944,-48950.68"/>
<text text-anchor="middle" x="1835" y="-48938.68" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1835" y="-48927.68" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1835" y="-48916.68" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1835" y="-48905.68" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_8_route&#45;&gt;moe_8_expert_7 -->
<g id="edge176" class="edge">
<title>moe_8_route&#45;&gt;moe_8_expert_7</title>
<path fill="none" stroke="black" d="M1891.37,-48986.97C1882.76,-48977.61 1873.52,-48967.56 1865.06,-48958.36"/>
<polygon fill="black" stroke="black" points="1867.51,-48955.86 1858.16,-48950.87 1862.36,-48960.6 1867.51,-48955.86"/>
</g>
<!-- moe_8_expert_8 -->
<g id="node117" class="node">
<title>moe_8_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2180,-48950.68 1962,-48950.68 1962,-48898.68 2180,-48898.68 2180,-48950.68"/>
<text text-anchor="middle" x="2071" y="-48938.68" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2071" y="-48927.68" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2071" y="-48916.68" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2071" y="-48905.68" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_8_route&#45;&gt;moe_8_expert_8 -->
<g id="edge177" class="edge">
<title>moe_8_route&#45;&gt;moe_8_expert_8</title>
<path fill="none" stroke="black" d="M1977.07,-48987.52C1992.47,-48977.38 2009.17,-48966.39 2024.16,-48956.52"/>
<polygon fill="black" stroke="black" points="2026.33,-48959.28 2032.76,-48950.86 2022.48,-48953.43 2026.33,-48959.28"/>
</g>
<!-- moe_8_expert_9 -->
<g id="node118" class="node">
<title>moe_8_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2416,-48950.68 2198,-48950.68 2198,-48898.68 2416,-48898.68 2416,-48950.68"/>
<text text-anchor="middle" x="2307" y="-48938.68" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2307" y="-48927.68" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2307" y="-48916.68" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2307" y="-48905.68" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_8_route&#45;&gt;moe_8_expert_9 -->
<g id="edge178" class="edge">
<title>moe_8_route&#45;&gt;moe_8_expert_9</title>
<path fill="none" stroke="black" d="M2042.3,-48992.56C2091.95,-48980.02 2149.32,-48965.52 2197.94,-48953.24"/>
<polygon fill="black" stroke="black" points="2199.02,-48956.58 2207.85,-48950.73 2197.3,-48949.79 2199.02,-48956.58"/>
</g>
<!-- moe_8_expert_10 -->
<g id="node119" class="node">
<title>moe_8_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2652,-48950.68 2434,-48950.68 2434,-48898.68 2652,-48898.68 2652,-48950.68"/>
<text text-anchor="middle" x="2543" y="-48938.68" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2543" y="-48927.68" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2543" y="-48916.68" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2543" y="-48905.68" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_8_route&#45;&gt;moe_8_expert_10 -->
<g id="edge179" class="edge">
<title>moe_8_route&#45;&gt;moe_8_expert_10</title>
<path fill="none" stroke="black" d="M2095.46,-49000.76C2189.68,-48988.14 2308.81,-48971.06 2423.72,-48950.87"/>
<polygon fill="black" stroke="black" points="2424.52,-48954.28 2433.76,-48949.1 2423.3,-48947.39 2424.52,-48954.28"/>
</g>
<!-- moe_8_expert_11 -->
<g id="node120" class="node">
<title>moe_8_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2888,-48950.68 2670,-48950.68 2670,-48898.68 2888,-48898.68 2888,-48950.68"/>
<text text-anchor="middle" x="2779" y="-48938.68" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2779" y="-48927.68" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2779" y="-48916.68" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2779" y="-48905.68" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_8_route&#45;&gt;moe_8_expert_11 -->
<g id="edge180" class="edge">
<title>moe_8_route&#45;&gt;moe_8_expert_11</title>
<path fill="none" stroke="black" d="M2124.56,-49009.01C2270.58,-48997.77 2473.15,-48979.18 2659.79,-48950.8"/>
<polygon fill="black" stroke="black" points="2660.43,-48954.25 2669.79,-48949.27 2659.37,-48947.33 2660.43,-48954.25"/>
</g>
<!-- moe_8_expert_12 -->
<g id="node121" class="node">
<title>moe_8_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3124,-48950.68 2906,-48950.68 2906,-48898.68 3124,-48898.68 3124,-48950.68"/>
<text text-anchor="middle" x="3015" y="-48938.68" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3015" y="-48927.68" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3015" y="-48916.68" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3015" y="-48905.68" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_8_route&#45;&gt;moe_8_expert_12 -->
<g id="edge181" class="edge">
<title>moe_8_route&#45;&gt;moe_8_expert_12</title>
<path fill="none" stroke="black" d="M2136.52,-49015.05C2331.72,-49006.32 2628.99,-48988.16 2895.53,-48950.81"/>
<polygon fill="black" stroke="black" points="2896.39,-48954.23 2905.8,-48949.36 2895.41,-48947.3 2896.39,-48954.23"/>
</g>
<!-- moe_8_expert_13 -->
<g id="node122" class="node">
<title>moe_8_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3360,-48950.68 3142,-48950.68 3142,-48898.68 3360,-48898.68 3360,-48950.68"/>
<text text-anchor="middle" x="3251" y="-48938.68" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3251" y="-48927.68" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3251" y="-48916.68" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3251" y="-48905.68" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_8_route&#45;&gt;moe_8_expert_13 -->
<g id="edge182" class="edge">
<title>moe_8_route&#45;&gt;moe_8_expert_13</title>
<path fill="none" stroke="black" d="M2140.6,-49019.34C2380.95,-49013.64 2780.18,-48997.53 3131.69,-48950.77"/>
<polygon fill="black" stroke="black" points="3132.36,-48954.22 3141.81,-48949.42 3131.43,-48947.28 3132.36,-48954.22"/>
</g>
<!-- moe_8_expert_14 -->
<g id="node123" class="node">
<title>moe_8_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3596,-48950.68 3378,-48950.68 3378,-48898.68 3596,-48898.68 3596,-48950.68"/>
<text text-anchor="middle" x="3487" y="-48938.68" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3487" y="-48927.68" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3487" y="-48916.68" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3487" y="-48905.68" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_8_route&#45;&gt;moe_8_expert_14 -->
<g id="edge183" class="edge">
<title>moe_8_route&#45;&gt;moe_8_expert_14</title>
<path fill="none" stroke="black" d="M2141.92,-49022.4C2423.49,-49019.89 2928.65,-49007.09 3367.78,-48950.75"/>
<polygon fill="black" stroke="black" points="3368.35,-48954.21 3377.81,-48949.46 3367.45,-48947.27 3368.35,-48954.21"/>
</g>
<!-- moe_8_expert_15 -->
<g id="node124" class="node">
<title>moe_8_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3832,-48950.68 3614,-48950.68 3614,-48898.68 3832,-48898.68 3832,-48950.68"/>
<text text-anchor="middle" x="3723" y="-48938.68" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3723" y="-48927.68" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3723" y="-48916.68" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3723" y="-48905.68" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_8_route&#45;&gt;moe_8_expert_15 -->
<g id="edge184" class="edge">
<title>moe_8_route&#45;&gt;moe_8_expert_15</title>
<path fill="none" stroke="black" d="M2139.41,-49017.72C2522.61,-49008.55 3309.26,-48986.23 3603.56,-48950.75"/>
<polygon fill="black" stroke="black" points="3604.32,-48954.18 3613.82,-48949.48 3603.46,-48947.24 3604.32,-48954.18"/>
</g>
<!-- moe_8_aggregate -->
<g id="node125" class="node">
<title>moe_8_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1953" cy="-48825.91" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1953" y="-48839.91" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1953" y="-48828.91" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1953" y="-48817.91" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1953" y="-48806.91" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_8_expert_0&#45;&gt;moe_8_aggregate -->
<g id="edge185" class="edge">
<title>moe_8_expert_0&#45;&gt;moe_8_aggregate</title>
<path fill="none" stroke="black" d="M292.18,-48899.89C295.15,-48899.46 298.09,-48899.05 301,-48898.68 568.74,-48864.74 1334.32,-48841.94 1722.04,-48832.23"/>
<polygon fill="black" stroke="black" points="1722.35,-48835.72 1732.26,-48831.97 1722.17,-48828.72 1722.35,-48835.72"/>
</g>
<!-- moe_8_expert_1&#45;&gt;moe_8_aggregate -->
<g id="edge186" class="edge">
<title>moe_8_expert_1&#45;&gt;moe_8_aggregate</title>
<path fill="none" stroke="black" d="M528.19,-48899.92C531.15,-48899.48 534.09,-48899.06 537,-48898.68 950.79,-48844.71 1437.51,-48830.75 1719.11,-48827.47"/>
<polygon fill="black" stroke="black" points="1719.49,-48830.97 1729.45,-48827.36 1719.41,-48823.97 1719.49,-48830.97"/>
</g>
<!-- moe_8_expert_2&#45;&gt;moe_8_aggregate -->
<g id="edge187" class="edge">
<title>moe_8_expert_2&#45;&gt;moe_8_aggregate</title>
<path fill="none" stroke="black" d="M764.19,-48899.96C767.15,-48899.5 770.09,-48899.08 773,-48898.68 1100.31,-48854.31 1482.45,-48837.36 1721.11,-48830.9"/>
<polygon fill="black" stroke="black" points="1721.4,-48834.39 1731.31,-48830.62 1721.22,-48827.39 1721.4,-48834.39"/>
</g>
<!-- moe_8_expert_3&#45;&gt;moe_8_aggregate -->
<g id="edge188" class="edge">
<title>moe_8_expert_3&#45;&gt;moe_8_aggregate</title>
<path fill="none" stroke="black" d="M1000.2,-48900.02C1003.16,-48899.55 1006.1,-48899.1 1009,-48898.68 1252.76,-48863.75 1534.52,-48845.13 1726.32,-48835.69"/>
<polygon fill="black" stroke="black" points="1726.71,-48839.17 1736.53,-48835.19 1726.37,-48832.18 1726.71,-48839.17"/>
</g>
<!-- moe_8_expert_4&#45;&gt;moe_8_aggregate -->
<g id="edge189" class="edge">
<title>moe_8_expert_4&#45;&gt;moe_8_aggregate</title>
<path fill="none" stroke="black" d="M1236.21,-48900.11C1239.17,-48899.61 1242.1,-48899.14 1245,-48898.68 1410.7,-48872.81 1599.73,-48854.2 1740.77,-48842.42"/>
<polygon fill="black" stroke="black" points="1741.17,-48845.9 1750.84,-48841.58 1740.59,-48838.92 1741.17,-48845.9"/>
</g>
<!-- moe_8_expert_5&#45;&gt;moe_8_aggregate -->
<g id="edge190" class="edge">
<title>moe_8_expert_5&#45;&gt;moe_8_aggregate</title>
<path fill="none" stroke="black" d="M1472.25,-48900.31C1475.19,-48899.75 1478.12,-48899.21 1481,-48898.68 1577.58,-48881.13 1685.83,-48864.45 1774.27,-48851.6"/>
<polygon fill="black" stroke="black" points="1775.01,-48855.03 1784.4,-48850.13 1774,-48848.1 1775.01,-48855.03"/>
</g>
<!-- moe_8_expert_6&#45;&gt;moe_8_aggregate -->
<g id="edge191" class="edge">
<title>moe_8_expert_6&#45;&gt;moe_8_aggregate</title>
<path fill="none" stroke="black" d="M1690.62,-48898.64C1733.27,-48886.98 1784.62,-48872.94 1830.54,-48860.39"/>
<polygon fill="black" stroke="black" points="1831.53,-48863.75 1840.25,-48857.74 1829.68,-48857 1831.53,-48863.75"/>
</g>
<!-- moe_8_expert_7&#45;&gt;moe_8_aggregate -->
<g id="edge192" class="edge">
<title>moe_8_expert_7&#45;&gt;moe_8_aggregate</title>
<path fill="none" stroke="black" d="M1865.7,-48898.51C1876.79,-48889.42 1889.63,-48878.89 1901.99,-48868.75"/>
<polygon fill="black" stroke="black" points="1904.51,-48871.21 1910.02,-48862.16 1900.07,-48865.79 1904.51,-48871.21"/>
</g>
<!-- moe_8_expert_8&#45;&gt;moe_8_aggregate -->
<g id="edge193" class="edge">
<title>moe_8_expert_8&#45;&gt;moe_8_aggregate</title>
<path fill="none" stroke="black" d="M2040.3,-48898.51C2029.21,-48889.42 2016.37,-48878.89 2004.01,-48868.75"/>
<polygon fill="black" stroke="black" points="2005.93,-48865.79 1995.98,-48862.16 2001.49,-48871.21 2005.93,-48865.79"/>
</g>
<!-- moe_8_expert_9&#45;&gt;moe_8_aggregate -->
<g id="edge194" class="edge">
<title>moe_8_expert_9&#45;&gt;moe_8_aggregate</title>
<path fill="none" stroke="black" d="M2215.38,-48898.64C2172.73,-48886.98 2121.38,-48872.94 2075.46,-48860.39"/>
<polygon fill="black" stroke="black" points="2076.32,-48857 2065.75,-48857.74 2074.47,-48863.75 2076.32,-48857"/>
</g>
<!-- moe_8_expert_10&#45;&gt;moe_8_aggregate -->
<g id="edge195" class="edge">
<title>moe_8_expert_10&#45;&gt;moe_8_aggregate</title>
<path fill="none" stroke="black" d="M2433.75,-48900.31C2430.81,-48899.75 2427.88,-48899.21 2425,-48898.68 2328.42,-48881.13 2220.17,-48864.45 2131.73,-48851.6"/>
<polygon fill="black" stroke="black" points="2132,-48848.1 2121.6,-48850.13 2130.99,-48855.03 2132,-48848.1"/>
</g>
<!-- moe_8_expert_11&#45;&gt;moe_8_aggregate -->
<g id="edge196" class="edge">
<title>moe_8_expert_11&#45;&gt;moe_8_aggregate</title>
<path fill="none" stroke="black" d="M2669.79,-48900.11C2666.83,-48899.61 2663.9,-48899.14 2661,-48898.68 2495.3,-48872.81 2306.27,-48854.2 2165.23,-48842.42"/>
<polygon fill="black" stroke="black" points="2165.41,-48838.92 2155.16,-48841.58 2164.83,-48845.9 2165.41,-48838.92"/>
</g>
<!-- moe_8_expert_12&#45;&gt;moe_8_aggregate -->
<g id="edge197" class="edge">
<title>moe_8_expert_12&#45;&gt;moe_8_aggregate</title>
<path fill="none" stroke="black" d="M2905.8,-48900.02C2902.84,-48899.55 2899.9,-48899.1 2897,-48898.68 2653.24,-48863.75 2371.48,-48845.13 2179.68,-48835.69"/>
<polygon fill="black" stroke="black" points="2179.63,-48832.18 2169.47,-48835.19 2179.29,-48839.17 2179.63,-48832.18"/>
</g>
<!-- moe_8_expert_13&#45;&gt;moe_8_aggregate -->
<g id="edge198" class="edge">
<title>moe_8_expert_13&#45;&gt;moe_8_aggregate</title>
<path fill="none" stroke="black" d="M3141.81,-48899.96C3138.85,-48899.5 3135.91,-48899.08 3133,-48898.68 2805.69,-48854.31 2423.55,-48837.36 2184.89,-48830.9"/>
<polygon fill="black" stroke="black" points="2184.78,-48827.39 2174.69,-48830.62 2184.6,-48834.39 2184.78,-48827.39"/>
</g>
<!-- moe_8_expert_14&#45;&gt;moe_8_aggregate -->
<g id="edge199" class="edge">
<title>moe_8_expert_14&#45;&gt;moe_8_aggregate</title>
<path fill="none" stroke="black" d="M3377.81,-48899.92C3374.85,-48899.48 3371.91,-48899.06 3369,-48898.68 2955.21,-48844.71 2468.49,-48830.75 2186.89,-48827.47"/>
<polygon fill="black" stroke="black" points="2186.59,-48823.97 2176.55,-48827.36 2186.51,-48830.97 2186.59,-48823.97"/>
</g>
<!-- moe_8_expert_15&#45;&gt;moe_8_aggregate -->
<g id="edge200" class="edge">
<title>moe_8_expert_15&#45;&gt;moe_8_aggregate</title>
<path fill="none" stroke="black" d="M3613.82,-48899.89C3610.85,-48899.46 3607.91,-48899.05 3605,-48898.68 3337.26,-48864.74 2571.68,-48841.94 2183.96,-48832.23"/>
<polygon fill="black" stroke="black" points="2183.83,-48828.72 2173.74,-48831.97 2183.65,-48835.72 2183.83,-48828.72"/>
</g>
<!-- moe_8_ffn -->
<g id="node126" class="node">
<title>moe_8_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2111,-48753.15 1795,-48753.15 1795,-48701.15 2111,-48701.15 2111,-48753.15"/>
<text text-anchor="middle" x="1953" y="-48741.15" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1953" y="-48730.15" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1953" y="-48719.15" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1953" y="-48708.15" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_8_aggregate&#45;&gt;moe_8_ffn -->
<g id="edge201" class="edge">
<title>moe_8_aggregate&#45;&gt;moe_8_ffn</title>
<path fill="none" stroke="black" d="M1953,-48788.88C1953,-48780.57 1953,-48771.74 1953,-48763.45"/>
<polygon fill="black" stroke="black" points="1956.5,-48763.34 1953,-48753.34 1949.5,-48763.34 1956.5,-48763.34"/>
</g>
<!-- moe_8_res2 -->
<g id="node128" class="node">
<title>moe_8_res2</title>
<polygon fill="lightyellow" stroke="black" points="2289.89,-48665.15 1753.97,-48665.15 1616.11,-48561.15 2152.03,-48561.15 2289.89,-48665.15"/>
<text text-anchor="middle" x="1953" y="-48627.15" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1953" y="-48616.15" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1953" y="-48605.15" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1953" y="-48594.15" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_8_ffn&#45;&gt;moe_8_res2 -->
<g id="edge202" class="edge">
<title>moe_8_ffn&#45;&gt;moe_8_res2</title>
<path fill="none" stroke="black" d="M1953,-48701.01C1953,-48693.33 1953,-48684.51 1953,-48675.51"/>
<polygon fill="black" stroke="black" points="1956.5,-48675.32 1953,-48665.32 1949.5,-48675.32 1956.5,-48675.32"/>
</g>
<!-- moe_8_res1&#45;&gt;moe_8_gate -->
<g id="edge167" class="edge">
<title>moe_8_res1&#45;&gt;moe_8_gate</title>
<path fill="none" stroke="black" d="M1924,-49235.84C1924,-49227.67 1924,-49219.14 1924,-49210.76"/>
<polygon fill="black" stroke="black" points="1927.5,-49210.65 1924,-49200.65 1920.5,-49210.65 1927.5,-49210.65"/>
</g>
<!-- moe_9_mha -->
<g id="node129" class="node">
<title>moe_9_mha</title>
<polygon fill="lightgreen" stroke="black" points="2111,-48514.15 1795,-48514.15 1795,-48462.15 2111,-48462.15 2111,-48514.15"/>
<text text-anchor="middle" x="1953" y="-48502.15" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1953" y="-48491.15" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1953" y="-48480.15" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1953" y="-48469.15" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_8_res2&#45;&gt;moe_9_mha -->
<g id="edge203" class="edge">
<title>moe_8_res2&#45;&gt;moe_9_mha</title>
<path fill="none" stroke="black" d="M1953,-48561.05C1953,-48548.72 1953,-48535.82 1953,-48524.4"/>
<polygon fill="black" stroke="black" points="1956.5,-48524.39 1953,-48514.39 1949.5,-48524.39 1956.5,-48524.39"/>
</g>
<!-- moe_9_res1 -->
<g id="node150" class="node">
<title>moe_9_res1</title>
<polygon fill="lightyellow" stroke="black" points="2289.89,-48426.15 1753.97,-48426.15 1616.11,-48322.15 2152.03,-48322.15 2289.89,-48426.15"/>
<text text-anchor="middle" x="1953" y="-48388.15" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1953" y="-48377.15" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1953" y="-48366.15" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1953" y="-48355.15" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_9_mha&#45;&gt;moe_9_res1 -->
<g id="edge204" class="edge">
<title>moe_9_mha&#45;&gt;moe_9_res1</title>
<path fill="none" stroke="black" d="M1953,-48462.01C1953,-48454.33 1953,-48445.51 1953,-48436.51"/>
<polygon fill="black" stroke="black" points="1956.5,-48436.32 1953,-48426.32 1949.5,-48436.32 1956.5,-48436.32"/>
</g>
<!-- moe_9_gate -->
<g id="node130" class="node">
<title>moe_9_gate</title>
<polygon fill="lightyellow" stroke="black" points="2281.8,-48286.15 1758.75,-48286.15 1624.2,-48182.15 2147.25,-48182.15 2281.8,-48286.15"/>
<text text-anchor="middle" x="1953" y="-48248.15" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1953" y="-48237.15" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1953" y="-48226.15" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1953" y="-48215.15" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_9_route -->
<g id="node131" class="node">
<title>moe_9_route</title>
<ellipse fill="lightblue" stroke="black" cx="1953" cy="-48109.38" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1953" y="-48123.38" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1953" y="-48112.38" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1953" y="-48101.38" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1953" y="-48090.38" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_9_gate&#45;&gt;moe_9_route -->
<g id="edge206" class="edge">
<title>moe_9_gate&#45;&gt;moe_9_route</title>
<path fill="none" stroke="black" d="M1953,-48181.79C1953,-48173.38 1953,-48164.72 1953,-48156.45"/>
<polygon fill="black" stroke="black" points="1956.5,-48156.23 1953,-48146.23 1949.5,-48156.23 1956.5,-48156.23"/>
</g>
<!-- moe_9_expert_0 -->
<g id="node132" class="node">
<title>moe_9_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="295,-48036.61 77,-48036.61 77,-47984.61 295,-47984.61 295,-48036.61"/>
<text text-anchor="middle" x="186" y="-48024.61" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="186" y="-48013.61" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="186" y="-48002.61" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="186" y="-47991.61" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_9_route&#45;&gt;moe_9_expert_0 -->
<g id="edge207" class="edge">
<title>moe_9_route&#45;&gt;moe_9_expert_0</title>
<path fill="none" stroke="black" d="M1737.94,-48103.44C1360.67,-48094.05 593.12,-48071.49 305.22,-48036.65"/>
<polygon fill="black" stroke="black" points="305.54,-48033.16 295.18,-48035.4 304.68,-48040.11 305.54,-48033.16"/>
</g>
<!-- moe_9_expert_1 -->
<g id="node133" class="node">
<title>moe_9_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="531,-48036.61 313,-48036.61 313,-47984.61 531,-47984.61 531,-48036.61"/>
<text text-anchor="middle" x="422" y="-48024.61" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="422" y="-48013.61" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="422" y="-48002.61" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="422" y="-47991.61" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_9_route&#45;&gt;moe_9_expert_1 -->
<g id="edge208" class="edge">
<title>moe_9_route&#45;&gt;moe_9_expert_1</title>
<path fill="none" stroke="black" d="M1735.09,-48107.96C1458.9,-48105.01 968.34,-48091.7 541.26,-48036.68"/>
<polygon fill="black" stroke="black" points="541.55,-48033.19 531.19,-48035.37 540.65,-48040.13 541.55,-48033.19"/>
</g>
<!-- moe_9_expert_2 -->
<g id="node134" class="node">
<title>moe_9_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="767,-48036.61 549,-48036.61 549,-47984.61 767,-47984.61 767,-48036.61"/>
<text text-anchor="middle" x="658" y="-48024.61" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="658" y="-48013.61" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="658" y="-48002.61" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="658" y="-47991.61" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_9_route&#45;&gt;moe_9_expert_2 -->
<g id="edge209" class="edge">
<title>moe_9_route&#45;&gt;moe_9_expert_2</title>
<path fill="none" stroke="black" d="M1736.75,-48104.76C1502.26,-48098.64 1117.07,-48082.17 777.23,-48036.69"/>
<polygon fill="black" stroke="black" points="777.57,-48033.2 767.19,-48035.33 776.63,-48040.14 777.57,-48033.2"/>
</g>
<!-- moe_9_expert_3 -->
<g id="node135" class="node">
<title>moe_9_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1003,-48036.61 785,-48036.61 785,-47984.61 1003,-47984.61 1003,-48036.61"/>
<text text-anchor="middle" x="894" y="-48024.61" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="894" y="-48013.61" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="894" y="-48002.61" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="894" y="-47991.61" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_9_route&#45;&gt;moe_9_expert_3 -->
<g id="edge210" class="edge">
<title>moe_9_route&#45;&gt;moe_9_expert_3</title>
<path fill="none" stroke="black" d="M1741.9,-48100.29C1553.14,-48091.18 1268.97,-48072.86 1013.43,-48036.73"/>
<polygon fill="black" stroke="black" points="1013.59,-48033.22 1003.2,-48035.27 1012.61,-48040.15 1013.59,-48033.22"/>
</g>
<!-- moe_9_expert_4 -->
<g id="node136" class="node">
<title>moe_9_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1239,-48036.61 1021,-48036.61 1021,-47984.61 1239,-47984.61 1239,-48036.61"/>
<text text-anchor="middle" x="1130" y="-48024.61" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1130" y="-48013.61" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1130" y="-48002.61" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1130" y="-47991.61" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_9_route&#45;&gt;moe_9_expert_4 -->
<g id="edge211" class="edge">
<title>moe_9_route&#45;&gt;moe_9_expert_4</title>
<path fill="none" stroke="black" d="M1755.12,-48093.94C1616.04,-48082.44 1425.55,-48063.94 1249.2,-48036.73"/>
<polygon fill="black" stroke="black" points="1249.63,-48033.25 1239.21,-48035.18 1248.56,-48040.17 1249.63,-48033.25"/>
</g>
<!-- moe_9_expert_5 -->
<g id="node137" class="node">
<title>moe_9_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1475,-48036.61 1257,-48036.61 1257,-47984.61 1475,-47984.61 1475,-48036.61"/>
<text text-anchor="middle" x="1366" y="-48024.61" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1366" y="-48013.61" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1366" y="-48002.61" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1366" y="-47991.61" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_9_route&#45;&gt;moe_9_expert_5 -->
<g id="edge212" class="edge">
<title>moe_9_route&#45;&gt;moe_9_expert_5</title>
<path fill="none" stroke="black" d="M1787.66,-48085.42C1700.39,-48072.73 1591.32,-48055.97 1485.18,-48036.78"/>
<polygon fill="black" stroke="black" points="1485.71,-48033.32 1475.25,-48034.98 1484.46,-48040.21 1485.71,-48033.32"/>
</g>
<!-- moe_9_expert_6 -->
<g id="node138" class="node">
<title>moe_9_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1711,-48036.61 1493,-48036.61 1493,-47984.61 1711,-47984.61 1711,-48036.61"/>
<text text-anchor="middle" x="1602" y="-48024.61" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1602" y="-48013.61" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1602" y="-48002.61" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1602" y="-47991.61" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_9_route&#45;&gt;moe_9_expert_6 -->
<g id="edge213" class="edge">
<title>moe_9_route&#45;&gt;moe_9_expert_6</title>
<path fill="none" stroke="black" d="M1841.46,-48077.62C1796.86,-48065.33 1745.87,-48051.27 1702.44,-48039.3"/>
<polygon fill="black" stroke="black" points="1703.29,-48035.9 1692.72,-48036.62 1701.43,-48042.65 1703.29,-48035.9"/>
</g>
<!-- moe_9_expert_7 -->
<g id="node139" class="node">
<title>moe_9_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1947,-48036.61 1729,-48036.61 1729,-47984.61 1947,-47984.61 1947,-48036.61"/>
<text text-anchor="middle" x="1838" y="-48024.61" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1838" y="-48013.61" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1838" y="-48002.61" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1838" y="-47991.61" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_9_route&#45;&gt;moe_9_expert_7 -->
<g id="edge214" class="edge">
<title>moe_9_route&#45;&gt;moe_9_expert_7</title>
<path fill="none" stroke="black" d="M1911.16,-48073.17C1899.47,-48063.33 1886.85,-48052.71 1875.43,-48043.1"/>
<polygon fill="black" stroke="black" points="1877.65,-48040.4 1867.75,-48036.64 1873.14,-48045.75 1877.65,-48040.4"/>
</g>
<!-- moe_9_expert_8 -->
<g id="node140" class="node">
<title>moe_9_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2183,-48036.61 1965,-48036.61 1965,-47984.61 2183,-47984.61 2183,-48036.61"/>
<text text-anchor="middle" x="2074" y="-48024.61" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2074" y="-48013.61" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2074" y="-48002.61" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2074" y="-47991.61" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_9_route&#45;&gt;moe_9_expert_8 -->
<g id="edge215" class="edge">
<title>moe_9_route&#45;&gt;moe_9_expert_8</title>
<path fill="none" stroke="black" d="M1997.03,-48073.17C2009.32,-48063.33 2022.61,-48052.71 2034.62,-48043.1"/>
<polygon fill="black" stroke="black" points="2037.08,-48045.62 2042.7,-48036.64 2032.71,-48040.15 2037.08,-48045.62"/>
</g>
<!-- moe_9_expert_9 -->
<g id="node141" class="node">
<title>moe_9_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2419,-48036.61 2201,-48036.61 2201,-47984.61 2419,-47984.61 2419,-48036.61"/>
<text text-anchor="middle" x="2310" y="-48024.61" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2310" y="-48013.61" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2310" y="-48002.61" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2310" y="-47991.61" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_9_route&#45;&gt;moe_9_expert_9 -->
<g id="edge216" class="edge">
<title>moe_9_route&#45;&gt;moe_9_expert_9</title>
<path fill="none" stroke="black" d="M2065.96,-48077.76C2111.35,-48065.45 2163.3,-48051.37 2207.58,-48039.37"/>
<polygon fill="black" stroke="black" points="2208.75,-48042.68 2217.48,-48036.68 2206.92,-48035.92 2208.75,-48042.68"/>
</g>
<!-- moe_9_expert_10 -->
<g id="node142" class="node">
<title>moe_9_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2655,-48036.61 2437,-48036.61 2437,-47984.61 2655,-47984.61 2655,-48036.61"/>
<text text-anchor="middle" x="2546" y="-48024.61" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2546" y="-48013.61" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2546" y="-48002.61" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2546" y="-47991.61" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_9_route&#45;&gt;moe_9_expert_10 -->
<g id="edge217" class="edge">
<title>moe_9_route&#45;&gt;moe_9_expert_10</title>
<path fill="none" stroke="black" d="M2119.64,-48085.64C2208.16,-48072.97 2318.99,-48056.17 2426.68,-48036.81"/>
<polygon fill="black" stroke="black" points="2427.54,-48040.21 2436.75,-48034.99 2426.29,-48033.32 2427.54,-48040.21"/>
</g>
<!-- moe_9_expert_11 -->
<g id="node143" class="node">
<title>moe_9_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2891,-48036.61 2673,-48036.61 2673,-47984.61 2891,-47984.61 2891,-48036.61"/>
<text text-anchor="middle" x="2782" y="-48024.61" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2782" y="-48013.61" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2782" y="-48002.61" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2782" y="-47991.61" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_9_route&#45;&gt;moe_9_expert_11 -->
<g id="edge218" class="edge">
<title>moe_9_route&#45;&gt;moe_9_expert_11</title>
<path fill="none" stroke="black" d="M2151.42,-48094.13C2291.77,-48082.67 2484.47,-48064.17 2662.69,-48036.74"/>
<polygon fill="black" stroke="black" points="2663.44,-48040.17 2672.79,-48035.18 2662.37,-48033.25 2663.44,-48040.17"/>
</g>
<!-- moe_9_expert_12 -->
<g id="node144" class="node">
<title>moe_9_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3127,-48036.61 2909,-48036.61 2909,-47984.61 3127,-47984.61 3127,-48036.61"/>
<text text-anchor="middle" x="3018" y="-48024.61" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3018" y="-48013.61" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3018" y="-48002.61" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3018" y="-47991.61" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_9_route&#45;&gt;moe_9_expert_12 -->
<g id="edge219" class="edge">
<title>moe_9_route&#45;&gt;moe_9_expert_12</title>
<path fill="none" stroke="black" d="M2164.51,-48100.41C2354.56,-48091.37 2641.26,-48073.07 2898.88,-48036.69"/>
<polygon fill="black" stroke="black" points="2899.39,-48040.15 2908.8,-48035.28 2898.41,-48033.22 2899.39,-48040.15"/>
</g>
<!-- moe_9_expert_13 -->
<g id="node145" class="node">
<title>moe_9_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3363,-48036.61 3145,-48036.61 3145,-47984.61 3363,-47984.61 3363,-48036.61"/>
<text text-anchor="middle" x="3254" y="-48024.61" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3254" y="-48013.61" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3254" y="-48002.61" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3254" y="-47991.61" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_9_route&#45;&gt;moe_9_expert_13 -->
<g id="edge220" class="edge">
<title>moe_9_route&#45;&gt;moe_9_expert_13</title>
<path fill="none" stroke="black" d="M2169.26,-48104.86C2404.85,-48098.81 2792.67,-48082.41 3134.7,-48036.7"/>
<polygon fill="black" stroke="black" points="3135.37,-48040.14 3144.81,-48035.33 3134.43,-48033.2 3135.37,-48040.14"/>
</g>
<!-- moe_9_expert_14 -->
<g id="node146" class="node">
<title>moe_9_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3599,-48036.61 3381,-48036.61 3381,-47984.61 3599,-47984.61 3599,-48036.61"/>
<text text-anchor="middle" x="3490" y="-48024.61" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3490" y="-48013.61" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3490" y="-48002.61" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3490" y="-47991.61" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_9_route&#45;&gt;moe_9_expert_14 -->
<g id="edge221" class="edge">
<title>moe_9_route&#45;&gt;moe_9_expert_14</title>
<path fill="none" stroke="black" d="M2170.93,-48108.03C2448.12,-48105.16 2941.37,-48091.95 3370.68,-48036.69"/>
<polygon fill="black" stroke="black" points="3371.35,-48040.13 3380.81,-48035.37 3370.45,-48033.19 3371.35,-48040.13"/>
</g>
<!-- moe_9_expert_15 -->
<g id="node147" class="node">
<title>moe_9_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3835,-48036.61 3617,-48036.61 3617,-47984.61 3835,-47984.61 3835,-48036.61"/>
<text text-anchor="middle" x="3726" y="-48024.61" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3726" y="-48013.61" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3726" y="-48002.61" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3726" y="-47991.61" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_9_route&#45;&gt;moe_9_expert_15 -->
<g id="edge222" class="edge">
<title>moe_9_route&#45;&gt;moe_9_expert_15</title>
<path fill="none" stroke="black" d="M2168.09,-48103.48C2546.46,-48094.13 3317.63,-48071.62 3606.74,-48036.65"/>
<polygon fill="black" stroke="black" points="3607.32,-48040.11 3616.82,-48035.4 3606.46,-48033.16 3607.32,-48040.11"/>
</g>
<!-- moe_9_aggregate -->
<g id="node148" class="node">
<title>moe_9_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1880" cy="-47911.84" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1880" y="-47925.84" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1880" y="-47914.84" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1880" y="-47903.84" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1880" y="-47892.84" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_9_expert_0&#45;&gt;moe_9_aggregate -->
<g id="edge223" class="edge">
<title>moe_9_expert_0&#45;&gt;moe_9_aggregate</title>
<path fill="none" stroke="black" d="M295.18,-47985.82C298.15,-47985.38 301.09,-47984.98 304,-47984.61 557.16,-47952.24 1276.94,-47928.97 1649.8,-47918.7"/>
<polygon fill="black" stroke="black" points="1650.01,-47922.19 1659.91,-47918.42 1649.82,-47915.19 1650.01,-47922.19"/>
</g>
<!-- moe_9_expert_1&#45;&gt;moe_9_aggregate -->
<g id="edge224" class="edge">
<title>moe_9_expert_1&#45;&gt;moe_9_aggregate</title>
<path fill="none" stroke="black" d="M531.19,-47985.85C534.15,-47985.41 537.09,-47984.99 540,-47984.61 925.67,-47933.74 1378.32,-47918.69 1646.49,-47914.38"/>
<polygon fill="black" stroke="black" points="1646.8,-47917.88 1656.74,-47914.22 1646.69,-47910.88 1646.8,-47917.88"/>
</g>
<!-- moe_9_expert_2&#45;&gt;moe_9_aggregate -->
<g id="edge225" class="edge">
<title>moe_9_expert_2&#45;&gt;moe_9_aggregate</title>
<path fill="none" stroke="black" d="M767.19,-47985.89C770.16,-47985.44 773.1,-47985.01 776,-47984.61 1075.95,-47943.3 1425.11,-47925.65 1649.15,-47918.19"/>
<polygon fill="black" stroke="black" points="1649.51,-47921.68 1659.39,-47917.85 1649.28,-47914.68 1649.51,-47921.68"/>
</g>
<!-- moe_9_expert_3&#45;&gt;moe_9_aggregate -->
<g id="edge226" class="edge">
<title>moe_9_expert_3&#45;&gt;moe_9_aggregate</title>
<path fill="none" stroke="black" d="M1003.2,-47985.96C1006.16,-47985.49 1009.1,-47985.03 1012,-47984.61 1229.94,-47952.64 1480.9,-47933.81 1656.74,-47923.53"/>
<polygon fill="black" stroke="black" points="1657.12,-47927.01 1666.9,-47922.94 1656.71,-47920.02 1657.12,-47927.01"/>
</g>
<!-- moe_9_expert_4&#45;&gt;moe_9_aggregate -->
<g id="edge227" class="edge">
<title>moe_9_expert_4&#45;&gt;moe_9_aggregate</title>
<path fill="none" stroke="black" d="M1239.22,-47986.08C1242.18,-47985.57 1245.11,-47985.08 1248,-47984.61 1390.21,-47961.52 1551.62,-47943.33 1675.72,-47931.03"/>
<polygon fill="black" stroke="black" points="1676.11,-47934.51 1685.72,-47930.05 1675.42,-47927.54 1676.11,-47934.51"/>
</g>
<!-- moe_9_expert_5&#45;&gt;moe_9_aggregate -->
<g id="edge228" class="edge">
<title>moe_9_expert_5&#45;&gt;moe_9_aggregate</title>
<path fill="none" stroke="black" d="M1475.27,-47986.34C1478.21,-47985.75 1481.12,-47985.17 1484,-47984.61 1561.27,-47969.42 1647.25,-47953.7 1719.3,-47940.85"/>
<polygon fill="black" stroke="black" points="1720.14,-47944.26 1729.37,-47939.06 1718.91,-47937.37 1720.14,-47944.26"/>
</g>
<!-- moe_9_expert_6&#45;&gt;moe_9_aggregate -->
<g id="edge229" class="edge">
<title>moe_9_expert_6&#45;&gt;moe_9_aggregate</title>
<path fill="none" stroke="black" d="M1673.95,-47984.56C1705.42,-47973.61 1742.92,-47960.55 1777.25,-47948.6"/>
<polygon fill="black" stroke="black" points="1778.55,-47951.86 1786.84,-47945.26 1776.24,-47945.25 1778.55,-47951.86"/>
</g>
<!-- moe_9_expert_7&#45;&gt;moe_9_aggregate -->
<g id="edge230" class="edge">
<title>moe_9_expert_7&#45;&gt;moe_9_aggregate</title>
<path fill="none" stroke="black" d="M1848.93,-47984.43C1852.42,-47976.37 1856.41,-47967.18 1860.34,-47958.13"/>
<polygon fill="black" stroke="black" points="1863.61,-47959.38 1864.39,-47948.81 1857.19,-47956.59 1863.61,-47959.38"/>
</g>
<!-- moe_9_expert_8&#45;&gt;moe_9_aggregate -->
<g id="edge231" class="edge">
<title>moe_9_expert_8&#45;&gt;moe_9_aggregate</title>
<path fill="none" stroke="black" d="M2023.79,-47984.56C2003.56,-47974.47 1979.76,-47962.6 1957.41,-47951.45"/>
<polygon fill="black" stroke="black" points="1958.78,-47948.22 1948.27,-47946.89 1955.66,-47954.49 1958.78,-47948.22"/>
</g>
<!-- moe_9_expert_9&#45;&gt;moe_9_aggregate -->
<g id="edge232" class="edge">
<title>moe_9_expert_9&#45;&gt;moe_9_aggregate</title>
<path fill="none" stroke="black" d="M2200.94,-47985.06C2145.67,-47972.62 2077.95,-47957.38 2018.98,-47944.11"/>
<polygon fill="black" stroke="black" points="2019.74,-47940.7 2009.22,-47941.92 2018.2,-47947.53 2019.74,-47940.7"/>
</g>
<!-- moe_9_expert_10&#45;&gt;moe_9_aggregate -->
<g id="edge233" class="edge">
<title>moe_9_expert_10&#45;&gt;moe_9_aggregate</title>
<path fill="none" stroke="black" d="M2436.77,-47986.15C2433.82,-47985.62 2430.89,-47985.1 2428,-47984.61 2310.5,-47964.5 2177.97,-47947 2072.68,-47934.32"/>
<polygon fill="black" stroke="black" points="2072.93,-47930.82 2062.58,-47933.11 2072.09,-47937.77 2072.93,-47930.82"/>
</g>
<!-- moe_9_expert_11&#45;&gt;moe_9_aggregate -->
<g id="edge234" class="edge">
<title>moe_9_expert_11&#45;&gt;moe_9_aggregate</title>
<path fill="none" stroke="black" d="M2672.79,-47986C2669.83,-47985.51 2666.9,-47985.04 2664,-47984.61 2474.07,-47955.89 2256.39,-47937.08 2098.68,-47925.94"/>
<polygon fill="black" stroke="black" points="2098.6,-47922.43 2088.37,-47925.22 2098.11,-47929.41 2098.6,-47922.43"/>
</g>
<!-- moe_9_expert_12&#45;&gt;moe_9_aggregate -->
<g id="edge235" class="edge">
<title>moe_9_expert_12&#45;&gt;moe_9_aggregate</title>
<path fill="none" stroke="black" d="M2908.8,-47985.92C2905.84,-47985.45 2902.9,-47985.01 2900,-47984.61 2629.74,-47946.66 2316.24,-47928.4 2108.89,-47919.88"/>
<polygon fill="black" stroke="black" points="2108.93,-47916.38 2098.79,-47919.47 2108.64,-47923.37 2108.93,-47916.38"/>
</g>
<!-- moe_9_expert_13&#45;&gt;moe_9_aggregate -->
<g id="edge236" class="edge">
<title>moe_9_expert_13&#45;&gt;moe_9_aggregate</title>
<path fill="none" stroke="black" d="M3144.81,-47985.86C3141.85,-47985.42 3138.91,-47984.99 3136,-47984.61 2780.97,-47937.13 2365.37,-47921.03 2112.51,-47915.59"/>
<polygon fill="black" stroke="black" points="2112.53,-47912.09 2102.46,-47915.38 2112.38,-47919.09 2112.53,-47912.09"/>
</g>
<!-- moe_9_expert_14&#45;&gt;moe_9_aggregate -->
<g id="edge237" class="edge">
<title>moe_9_expert_14&#45;&gt;moe_9_aggregate</title>
<path fill="none" stroke="black" d="M3380.81,-47985.83C3377.85,-47985.39 3374.91,-47984.98 3372,-47984.61 2929.73,-47927.49 2408.42,-47914.73 2113.81,-47912.5"/>
<polygon fill="black" stroke="black" points="2113.45,-47908.99 2103.43,-47912.42 2113.4,-47915.99 2113.45,-47908.99"/>
</g>
<!-- moe_9_expert_15&#45;&gt;moe_9_aggregate -->
<g id="edge238" class="edge">
<title>moe_9_expert_15&#45;&gt;moe_9_aggregate</title>
<path fill="none" stroke="black" d="M3616.82,-47985.8C3613.85,-47985.37 3610.91,-47984.97 3608,-47984.61 3325.49,-47949.07 2513.11,-47926.79 2111.05,-47917.64"/>
<polygon fill="black" stroke="black" points="2111.12,-47914.14 2101.04,-47917.41 2110.96,-47921.14 2111.12,-47914.14"/>
</g>
<!-- moe_9_ffn -->
<g id="node149" class="node">
<title>moe_9_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2038,-47839.07 1722,-47839.07 1722,-47787.07 2038,-47787.07 2038,-47839.07"/>
<text text-anchor="middle" x="1880" y="-47827.07" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1880" y="-47816.07" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1880" y="-47805.07" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1880" y="-47794.07" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_9_aggregate&#45;&gt;moe_9_ffn -->
<g id="edge239" class="edge">
<title>moe_9_aggregate&#45;&gt;moe_9_ffn</title>
<path fill="none" stroke="black" d="M1880,-47874.8C1880,-47866.49 1880,-47857.66 1880,-47849.38"/>
<polygon fill="black" stroke="black" points="1883.5,-47849.26 1880,-47839.26 1876.5,-47849.26 1883.5,-47849.26"/>
</g>
<!-- moe_9_res2 -->
<g id="node151" class="node">
<title>moe_9_res2</title>
<polygon fill="lightyellow" stroke="black" points="2216.89,-47751.07 1680.97,-47751.07 1543.11,-47647.07 2079.03,-47647.07 2216.89,-47751.07"/>
<text text-anchor="middle" x="1880" y="-47713.07" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1880" y="-47702.07" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1880" y="-47691.07" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1880" y="-47680.07" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_9_ffn&#45;&gt;moe_9_res2 -->
<g id="edge240" class="edge">
<title>moe_9_ffn&#45;&gt;moe_9_res2</title>
<path fill="none" stroke="black" d="M1880,-47786.93C1880,-47779.25 1880,-47770.43 1880,-47761.43"/>
<polygon fill="black" stroke="black" points="1883.5,-47761.25 1880,-47751.25 1876.5,-47761.25 1883.5,-47761.25"/>
</g>
<!-- moe_9_res1&#45;&gt;moe_9_gate -->
<g id="edge205" class="edge">
<title>moe_9_res1&#45;&gt;moe_9_gate</title>
<path fill="none" stroke="black" d="M1953,-48321.76C1953,-48313.59 1953,-48305.06 1953,-48296.68"/>
<polygon fill="black" stroke="black" points="1956.5,-48296.57 1953,-48286.57 1949.5,-48296.57 1956.5,-48296.57"/>
</g>
<!-- moe_10_mha -->
<g id="node152" class="node">
<title>moe_10_mha</title>
<polygon fill="lightgreen" stroke="black" points="2038,-47600.07 1722,-47600.07 1722,-47548.07 2038,-47548.07 2038,-47600.07"/>
<text text-anchor="middle" x="1880" y="-47588.07" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1880" y="-47577.07" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1880" y="-47566.07" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1880" y="-47555.07" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_9_res2&#45;&gt;moe_10_mha -->
<g id="edge241" class="edge">
<title>moe_9_res2&#45;&gt;moe_10_mha</title>
<path fill="none" stroke="black" d="M1880,-47646.97C1880,-47634.64 1880,-47621.74 1880,-47610.32"/>
<polygon fill="black" stroke="black" points="1883.5,-47610.31 1880,-47600.31 1876.5,-47610.31 1883.5,-47610.31"/>
</g>
<!-- moe_10_res1 -->
<g id="node173" class="node">
<title>moe_10_res1</title>
<polygon fill="lightyellow" stroke="black" points="2216.89,-47512.07 1680.97,-47512.07 1543.11,-47408.07 2079.03,-47408.07 2216.89,-47512.07"/>
<text text-anchor="middle" x="1880" y="-47474.07" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1880" y="-47463.07" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1880" y="-47452.07" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1880" y="-47441.07" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_10_mha&#45;&gt;moe_10_res1 -->
<g id="edge242" class="edge">
<title>moe_10_mha&#45;&gt;moe_10_res1</title>
<path fill="none" stroke="black" d="M1880,-47547.93C1880,-47540.25 1880,-47531.43 1880,-47522.43"/>
<polygon fill="black" stroke="black" points="1883.5,-47522.25 1880,-47512.25 1876.5,-47522.25 1883.5,-47522.25"/>
</g>
<!-- moe_10_gate -->
<g id="node153" class="node">
<title>moe_10_gate</title>
<polygon fill="lightyellow" stroke="black" points="2208.8,-47372.07 1685.75,-47372.07 1551.2,-47268.07 2074.25,-47268.07 2208.8,-47372.07"/>
<text text-anchor="middle" x="1880" y="-47334.07" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1880" y="-47323.07" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1880" y="-47312.07" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1880" y="-47301.07" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_10_route -->
<g id="node154" class="node">
<title>moe_10_route</title>
<ellipse fill="lightblue" stroke="black" cx="1880" cy="-47195.3" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1880" y="-47209.3" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1880" y="-47198.3" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1880" y="-47187.3" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1880" y="-47176.3" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_10_gate&#45;&gt;moe_10_route -->
<g id="edge244" class="edge">
<title>moe_10_gate&#45;&gt;moe_10_route</title>
<path fill="none" stroke="black" d="M1880,-47267.71C1880,-47259.3 1880,-47250.64 1880,-47242.37"/>
<polygon fill="black" stroke="black" points="1883.5,-47242.15 1880,-47232.15 1876.5,-47242.15 1883.5,-47242.15"/>
</g>
<!-- moe_10_expert_0 -->
<g id="node155" class="node">
<title>moe_10_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="307,-47122.53 89,-47122.53 89,-47070.53 307,-47070.53 307,-47122.53"/>
<text text-anchor="middle" x="198" y="-47110.53" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="198" y="-47099.53" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="198" y="-47088.53" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="198" y="-47077.53" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_10_route&#45;&gt;moe_10_expert_0 -->
<g id="edge245" class="edge">
<title>moe_10_route&#45;&gt;moe_10_expert_0</title>
<path fill="none" stroke="black" d="M1665.59,-47188.78C1304.55,-47178.78 588.91,-47155.7 317.43,-47122.6"/>
<polygon fill="black" stroke="black" points="317.54,-47119.08 307.18,-47121.31 316.67,-47126.03 317.54,-47119.08"/>
</g>
<!-- moe_10_expert_1 -->
<g id="node156" class="node">
<title>moe_10_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="543,-47122.53 325,-47122.53 325,-47070.53 543,-47070.53 543,-47122.53"/>
<text text-anchor="middle" x="434" y="-47110.53" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="434" y="-47099.53" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="434" y="-47088.53" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="434" y="-47077.53" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_10_route&#45;&gt;moe_10_expert_1 -->
<g id="edge246" class="edge">
<title>moe_10_route&#45;&gt;moe_10_expert_1</title>
<path fill="none" stroke="black" d="M1662.54,-47192.85C1400.92,-47188.75 948.58,-47174.18 553.11,-47122.59"/>
<polygon fill="black" stroke="black" points="553.56,-47119.11 543.19,-47121.28 552.65,-47126.06 553.56,-47119.11"/>
</g>
<!-- moe_10_expert_2 -->
<g id="node157" class="node">
<title>moe_10_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="779,-47122.53 561,-47122.53 561,-47070.53 779,-47070.53 779,-47122.53"/>
<text text-anchor="middle" x="670" y="-47110.53" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="670" y="-47099.53" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="670" y="-47088.53" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="670" y="-47077.53" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_10_route&#45;&gt;moe_10_expert_2 -->
<g id="edge247" class="edge">
<title>moe_10_route&#45;&gt;moe_10_expert_2</title>
<path fill="none" stroke="black" d="M1665.14,-47189.25C1446.63,-47182.02 1098.36,-47164.71 789.25,-47122.62"/>
<polygon fill="black" stroke="black" points="789.58,-47119.13 779.19,-47121.24 788.63,-47126.06 789.58,-47119.13"/>
</g>
<!-- moe_10_expert_3 -->
<g id="node158" class="node">
<title>moe_10_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1015,-47122.53 797,-47122.53 797,-47070.53 1015,-47070.53 1015,-47122.53"/>
<text text-anchor="middle" x="906" y="-47110.53" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="906" y="-47099.53" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="906" y="-47088.53" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="906" y="-47077.53" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_10_route&#45;&gt;moe_10_expert_3 -->
<g id="edge248" class="edge">
<title>moe_10_route&#45;&gt;moe_10_expert_3</title>
<path fill="none" stroke="black" d="M1672.04,-47184.16C1500.72,-47174.08 1251.45,-47155.48 1025.28,-47122.64"/>
<polygon fill="black" stroke="black" points="1025.61,-47119.15 1015.2,-47121.17 1024.59,-47126.08 1025.61,-47119.15"/>
</g>
<!-- moe_10_expert_4 -->
<g id="node159" class="node">
<title>moe_10_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1251,-47122.53 1033,-47122.53 1033,-47070.53 1251,-47070.53 1251,-47122.53"/>
<text text-anchor="middle" x="1142" y="-47110.53" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1142" y="-47099.53" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1142" y="-47088.53" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1142" y="-47077.53" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_10_route&#45;&gt;moe_10_expert_4 -->
<g id="edge249" class="edge">
<title>moe_10_route&#45;&gt;moe_10_expert_4</title>
<path fill="none" stroke="black" d="M1690.79,-47177.03C1570.44,-47164.93 1411.17,-47146.87 1261.52,-47122.72"/>
<polygon fill="black" stroke="black" points="1261.66,-47119.19 1251.22,-47121.04 1260.53,-47126.1 1261.66,-47119.19"/>
</g>
<!-- moe_10_expert_5 -->
<g id="node160" class="node">
<title>moe_10_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1487,-47122.53 1269,-47122.53 1269,-47070.53 1487,-47070.53 1487,-47122.53"/>
<text text-anchor="middle" x="1378" y="-47110.53" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1378" y="-47099.53" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1378" y="-47088.53" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1378" y="-47077.53" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_10_route&#45;&gt;moe_10_expert_5 -->
<g id="edge250" class="edge">
<title>moe_10_route&#45;&gt;moe_10_expert_5</title>
<path fill="none" stroke="black" d="M1734.42,-47167.94C1665.31,-47155.22 1581.32,-47139.46 1497.26,-47122.76"/>
<polygon fill="black" stroke="black" points="1497.76,-47119.29 1487.27,-47120.78 1496.4,-47126.16 1497.76,-47119.29"/>
</g>
<!-- moe_10_expert_6 -->
<g id="node161" class="node">
<title>moe_10_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1723,-47122.53 1505,-47122.53 1505,-47070.53 1723,-47070.53 1723,-47122.53"/>
<text text-anchor="middle" x="1614" y="-47110.53" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1614" y="-47099.53" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1614" y="-47088.53" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1614" y="-47077.53" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_10_route&#45;&gt;moe_10_expert_6 -->
<g id="edge251" class="edge">
<title>moe_10_route&#45;&gt;moe_10_expert_6</title>
<path fill="none" stroke="black" d="M1790.32,-47161.67C1758.74,-47150.18 1723.51,-47137.37 1692.89,-47126.23"/>
<polygon fill="black" stroke="black" points="1693.72,-47122.8 1683.12,-47122.67 1691.32,-47129.38 1693.72,-47122.8"/>
</g>
<!-- moe_10_expert_7 -->
<g id="node162" class="node">
<title>moe_10_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1959,-47122.53 1741,-47122.53 1741,-47070.53 1959,-47070.53 1959,-47122.53"/>
<text text-anchor="middle" x="1850" y="-47110.53" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1850" y="-47099.53" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1850" y="-47088.53" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1850" y="-47077.53" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_10_route&#45;&gt;moe_10_expert_7 -->
<g id="edge252" class="edge">
<title>moe_10_route&#45;&gt;moe_10_expert_7</title>
<path fill="none" stroke="black" d="M1868.91,-47158.54C1866.25,-47149.95 1863.41,-47140.79 1860.76,-47132.24"/>
<polygon fill="black" stroke="black" points="1864.07,-47131.09 1857.76,-47122.57 1857.38,-47133.16 1864.07,-47131.09"/>
</g>
<!-- moe_10_expert_8 -->
<g id="node163" class="node">
<title>moe_10_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2195,-47122.53 1977,-47122.53 1977,-47070.53 2195,-47070.53 2195,-47122.53"/>
<text text-anchor="middle" x="2086" y="-47110.53" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2086" y="-47099.53" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2086" y="-47088.53" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2086" y="-47077.53" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_10_route&#45;&gt;moe_10_expert_8 -->
<g id="edge253" class="edge">
<title>moe_10_route&#45;&gt;moe_10_expert_8</title>
<path fill="none" stroke="black" d="M1952.05,-47160.45C1975.3,-47149.53 2000.87,-47137.52 2023.38,-47126.94"/>
<polygon fill="black" stroke="black" points="2024.93,-47130.08 2032.5,-47122.66 2021.96,-47123.74 2024.93,-47130.08"/>
</g>
<!-- moe_10_expert_9 -->
<g id="node164" class="node">
<title>moe_10_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2431,-47122.53 2213,-47122.53 2213,-47070.53 2431,-47070.53 2431,-47122.53"/>
<text text-anchor="middle" x="2322" y="-47110.53" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2322" y="-47099.53" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2322" y="-47088.53" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2322" y="-47077.53" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_10_route&#45;&gt;moe_10_expert_9 -->
<g id="edge254" class="edge">
<title>moe_10_route&#45;&gt;moe_10_expert_9</title>
<path fill="none" stroke="black" d="M2010.22,-47165.79C2071.25,-47152.43 2143.46,-47136.62 2203.01,-47123.58"/>
<polygon fill="black" stroke="black" points="2203.81,-47126.99 2212.83,-47121.43 2202.31,-47120.15 2203.81,-47126.99"/>
</g>
<!-- moe_10_expert_10 -->
<g id="node165" class="node">
<title>moe_10_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2667,-47122.53 2449,-47122.53 2449,-47070.53 2667,-47070.53 2667,-47122.53"/>
<text text-anchor="middle" x="2558" y="-47110.53" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2558" y="-47099.53" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2558" y="-47088.53" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2558" y="-47077.53" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_10_route&#45;&gt;moe_10_expert_10 -->
<g id="edge255" class="edge">
<title>moe_10_route&#45;&gt;moe_10_expert_10</title>
<path fill="none" stroke="black" d="M2061.19,-47174.86C2168.42,-47162.44 2307.05,-47144.8 2438.88,-47122.67"/>
<polygon fill="black" stroke="black" points="2439.49,-47126.11 2448.77,-47121 2438.33,-47119.21 2439.49,-47126.11"/>
</g>
<!-- moe_10_expert_11 -->
<g id="node166" class="node">
<title>moe_10_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2903,-47122.53 2685,-47122.53 2685,-47070.53 2903,-47070.53 2903,-47122.53"/>
<text text-anchor="middle" x="2794" y="-47110.53" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2794" y="-47099.53" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2794" y="-47088.53" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2794" y="-47077.53" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_10_route&#45;&gt;moe_10_expert_11 -->
<g id="edge256" class="edge">
<title>moe_10_route&#45;&gt;moe_10_expert_11</title>
<path fill="none" stroke="black" d="M2084.47,-47182.57C2243.13,-47171.89 2468.61,-47153.23 2674.68,-47122.65"/>
<polygon fill="black" stroke="black" points="2675.42,-47126.08 2684.79,-47121.14 2674.38,-47119.16 2675.42,-47126.08"/>
</g>
<!-- moe_10_expert_12 -->
<g id="node167" class="node">
<title>moe_10_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3139,-47122.53 2921,-47122.53 2921,-47070.53 3139,-47070.53 3139,-47122.53"/>
<text text-anchor="middle" x="3030" y="-47110.53" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3030" y="-47099.53" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3030" y="-47088.53" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3030" y="-47077.53" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_10_route&#45;&gt;moe_10_expert_12 -->
<g id="edge257" class="edge">
<title>moe_10_route&#45;&gt;moe_10_expert_12</title>
<path fill="none" stroke="black" d="M2093.87,-47188.11C2300.76,-47180.11 2623.09,-47162.33 2910.59,-47122.64"/>
<polygon fill="black" stroke="black" points="2911.38,-47126.07 2920.8,-47121.22 2910.42,-47119.13 2911.38,-47126.07"/>
</g>
<!-- moe_10_expert_13 -->
<g id="node168" class="node">
<title>moe_10_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3375,-47122.53 3157,-47122.53 3157,-47070.53 3375,-47070.53 3375,-47122.53"/>
<text text-anchor="middle" x="3266" y="-47110.53" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3266" y="-47099.53" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3266" y="-47088.53" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3266" y="-47077.53" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_10_route&#45;&gt;moe_10_expert_13 -->
<g id="edge258" class="edge">
<title>moe_10_route&#45;&gt;moe_10_expert_13</title>
<path fill="none" stroke="black" d="M2097.18,-47192.04C2348.22,-47187.13 2773.68,-47171.74 3146.9,-47122.59"/>
<polygon fill="black" stroke="black" points="3147.36,-47126.06 3156.81,-47121.27 3146.44,-47119.12 3147.36,-47126.06"/>
</g>
<!-- moe_10_expert_14 -->
<g id="node169" class="node">
<title>moe_10_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3611,-47122.53 3393,-47122.53 3393,-47070.53 3611,-47070.53 3611,-47122.53"/>
<text text-anchor="middle" x="3502" y="-47110.53" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3502" y="-47099.53" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3502" y="-47088.53" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3502" y="-47077.53" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_10_route&#45;&gt;moe_10_expert_14 -->
<g id="edge259" class="edge">
<title>moe_10_route&#45;&gt;moe_10_expert_14</title>
<path fill="none" stroke="black" d="M2097.96,-47194.87C2389.24,-47193.16 2921.29,-47181.35 3382.62,-47122.61"/>
<polygon fill="black" stroke="black" points="3383.34,-47126.05 3392.82,-47121.31 3382.45,-47119.11 3383.34,-47126.05"/>
</g>
<!-- moe_10_expert_15 -->
<g id="node170" class="node">
<title>moe_10_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3847,-47122.53 3629,-47122.53 3629,-47070.53 3847,-47070.53 3847,-47122.53"/>
<text text-anchor="middle" x="3738" y="-47110.53" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3738" y="-47099.53" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3738" y="-47088.53" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3738" y="-47077.53" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_10_route&#45;&gt;moe_10_expert_15 -->
<g id="edge260" class="edge">
<title>moe_10_route&#45;&gt;moe_10_expert_15</title>
<path fill="none" stroke="black" d="M2095.54,-47189.92C2489.52,-47181.18 3312.7,-47159.28 3618.6,-47122.59"/>
<polygon fill="black" stroke="black" points="3619.32,-47126.03 3628.82,-47121.33 3618.47,-47119.08 3619.32,-47126.03"/>
</g>
<!-- moe_10_aggregate -->
<g id="node171" class="node">
<title>moe_10_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="2011" cy="-46997.76" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="2011" y="-47011.76" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="2011" y="-47000.76" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2011" y="-46989.76" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="2011" y="-46978.76" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_10_expert_0&#45;&gt;moe_10_aggregate -->
<g id="edge261" class="edge">
<title>moe_10_expert_0&#45;&gt;moe_10_aggregate</title>
<path fill="none" stroke="black" d="M307.18,-47071.73C310.15,-47071.3 313.09,-47070.89 316,-47070.53 592.05,-47035.69 1383.87,-47013.18 1779.8,-47003.78"/>
<polygon fill="black" stroke="black" points="1780.03,-47007.28 1789.95,-47003.54 1779.87,-47000.28 1780.03,-47007.28"/>
</g>
<!-- moe_10_expert_1&#45;&gt;moe_10_aggregate -->
<g id="edge262" class="edge">
<title>moe_10_expert_1&#45;&gt;moe_10_aggregate</title>
<path fill="none" stroke="black" d="M543.19,-47071.75C546.15,-47071.32 549.09,-47070.9 552,-47070.53 981.99,-47014.76 1488.41,-47001.47 1777.37,-46998.8"/>
<polygon fill="black" stroke="black" points="1777.59,-47002.29 1787.56,-46998.71 1777.53,-46995.29 1777.59,-47002.29"/>
</g>
<!-- moe_10_expert_2&#45;&gt;moe_10_aggregate -->
<g id="edge263" class="edge">
<title>moe_10_expert_2&#45;&gt;moe_10_aggregate</title>
<path fill="none" stroke="black" d="M779.19,-47071.79C782.15,-47071.34 785.09,-47070.92 788,-47070.53 1130.92,-47024.4 1531.89,-47007.92 1778.65,-47002.03"/>
<polygon fill="black" stroke="black" points="1778.91,-47005.52 1788.82,-47001.79 1778.74,-46998.53 1778.91,-47005.52"/>
</g>
<!-- moe_10_expert_3&#45;&gt;moe_10_aggregate -->
<g id="edge264" class="edge">
<title>moe_10_expert_3&#45;&gt;moe_10_aggregate</title>
<path fill="none" stroke="black" d="M1015.2,-47071.85C1018.16,-47071.38 1021.1,-47070.94 1024,-47070.53 1282.66,-47033.9 1582.27,-47015.46 1782.92,-47006.53"/>
<polygon fill="black" stroke="black" points="1783.16,-47010.02 1793,-47006.08 1782.85,-47003.03 1783.16,-47010.02"/>
</g>
<!-- moe_10_expert_4&#45;&gt;moe_10_aggregate -->
<g id="edge265" class="edge">
<title>moe_10_expert_4&#45;&gt;moe_10_aggregate</title>
<path fill="none" stroke="black" d="M1251.21,-47071.93C1254.17,-47071.44 1257.1,-47070.97 1260,-47070.53 1439.24,-47043.07 1644.25,-47024.32 1794.74,-47012.89"/>
<polygon fill="black" stroke="black" points="1795.32,-47016.36 1805.03,-47012.11 1794.79,-47009.38 1795.32,-47016.36"/>
</g>
<!-- moe_10_expert_5&#45;&gt;moe_10_aggregate -->
<g id="edge266" class="edge">
<title>moe_10_expert_5&#45;&gt;moe_10_aggregate</title>
<path fill="none" stroke="black" d="M1487.24,-47072.1C1490.19,-47071.56 1493.11,-47071.03 1496,-47070.53 1604.31,-47051.53 1726.16,-47034.36 1824.13,-47021.58"/>
<polygon fill="black" stroke="black" points="1824.67,-47025.04 1834.14,-47020.28 1823.77,-47018.1 1824.67,-47025.04"/>
</g>
<!-- moe_10_expert_6&#45;&gt;moe_10_aggregate -->
<g id="edge267" class="edge">
<title>moe_10_expert_6&#45;&gt;moe_10_aggregate</title>
<path fill="none" stroke="black" d="M1716.75,-47070.48C1766.17,-47058.44 1826.01,-47043.85 1878.78,-47030.99"/>
<polygon fill="black" stroke="black" points="1879.66,-47034.38 1888.55,-47028.61 1878,-47027.57 1879.66,-47034.38"/>
</g>
<!-- moe_10_expert_7&#45;&gt;moe_10_aggregate -->
<g id="edge268" class="edge">
<title>moe_10_expert_7&#45;&gt;moe_10_aggregate</title>
<path fill="none" stroke="black" d="M1891.88,-47070.36C1907.97,-47060.68 1926.77,-47049.39 1944.61,-47038.66"/>
<polygon fill="black" stroke="black" points="1946.5,-47041.61 1953.27,-47033.46 1942.9,-47035.61 1946.5,-47041.61"/>
</g>
<!-- moe_10_expert_8&#45;&gt;moe_10_aggregate -->
<g id="edge269" class="edge">
<title>moe_10_expert_8&#45;&gt;moe_10_aggregate</title>
<path fill="none" stroke="black" d="M2066.49,-47070.36C2059.84,-47061.78 2052.21,-47051.93 2044.77,-47042.34"/>
<polygon fill="black" stroke="black" points="2047.49,-47040.13 2038.6,-47034.37 2041.96,-47044.42 2047.49,-47040.13"/>
</g>
<!-- moe_10_expert_9&#45;&gt;moe_10_aggregate -->
<g id="edge270" class="edge">
<title>moe_10_expert_9&#45;&gt;moe_10_aggregate</title>
<path fill="none" stroke="black" d="M2241.51,-47070.48C2205.42,-47059.25 2162.25,-47045.82 2123.07,-47033.63"/>
<polygon fill="black" stroke="black" points="2123.79,-47030.19 2113.2,-47030.56 2121.71,-47036.87 2123.79,-47030.19"/>
</g>
<!-- moe_10_expert_10&#45;&gt;moe_10_aggregate -->
<g id="edge271" class="edge">
<title>moe_10_expert_10&#45;&gt;moe_10_aggregate</title>
<path fill="none" stroke="black" d="M2448.74,-47072.21C2445.8,-47071.63 2442.88,-47071.07 2440,-47070.53 2354.53,-47054.33 2259.11,-47038.18 2180.01,-47025.31"/>
<polygon fill="black" stroke="black" points="2180.38,-47021.83 2169.95,-47023.68 2179.26,-47028.74 2180.38,-47021.83"/>
</g>
<!-- moe_10_expert_11&#45;&gt;moe_10_aggregate -->
<g id="edge272" class="edge">
<title>moe_10_expert_11&#45;&gt;moe_10_aggregate</title>
<path fill="none" stroke="black" d="M2684.78,-47071.98C2681.83,-47071.48 2678.9,-47070.99 2676,-47070.53 2523.87,-47046.27 2350.82,-47027.88 2219.39,-47015.79"/>
<polygon fill="black" stroke="black" points="2219.48,-47012.28 2209.2,-47014.86 2218.84,-47019.25 2219.48,-47012.28"/>
</g>
<!-- moe_10_expert_12&#45;&gt;moe_10_aggregate -->
<g id="edge273" class="edge">
<title>moe_10_expert_12&#45;&gt;moe_10_aggregate</title>
<path fill="none" stroke="black" d="M2920.8,-47071.87C2917.84,-47071.4 2914.9,-47070.95 2912,-47070.53 2682.89,-47037.27 2418.6,-47018.51 2235.78,-47008.58"/>
<polygon fill="black" stroke="black" points="2235.95,-47005.09 2225.77,-47008.04 2235.57,-47012.08 2235.95,-47005.09"/>
</g>
<!-- moe_10_expert_13&#45;&gt;moe_10_aggregate -->
<g id="edge274" class="edge">
<title>moe_10_expert_13&#45;&gt;moe_10_aggregate</title>
<path fill="none" stroke="black" d="M3156.81,-47071.81C3153.84,-47071.35 3150.9,-47070.93 3148,-47070.53 2836.15,-47027.88 2472.66,-47010.52 2242.23,-47003.49"/>
<polygon fill="black" stroke="black" points="2242.14,-46999.99 2232.04,-47003.18 2241.93,-47006.98 2242.14,-46999.99"/>
</g>
<!-- moe_10_expert_14&#45;&gt;moe_10_aggregate -->
<g id="edge275" class="edge">
<title>moe_10_expert_14&#45;&gt;moe_10_aggregate</title>
<path fill="none" stroke="black" d="M3392.81,-47071.77C3389.85,-47071.32 3386.91,-47070.91 3384,-47070.53 2986,-47018.29 2518.4,-47003.71 2244.39,-46999.86"/>
<polygon fill="black" stroke="black" points="2244.37,-46996.36 2234.32,-46999.72 2244.28,-47003.36 2244.37,-46996.36"/>
</g>
<!-- moe_10_expert_15&#45;&gt;moe_10_aggregate -->
<g id="edge276" class="edge">
<title>moe_10_expert_15&#45;&gt;moe_10_aggregate</title>
<path fill="none" stroke="black" d="M3628.82,-47071.74C3625.85,-47071.3 3622.91,-47070.9 3620,-47070.53 3360.44,-47037.47 2620.45,-47014.39 2241.2,-47004.37"/>
<polygon fill="black" stroke="black" points="2241.29,-47000.87 2231.2,-47004.1 2241.11,-47007.86 2241.29,-47000.87"/>
</g>
<!-- moe_10_ffn -->
<g id="node172" class="node">
<title>moe_10_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2169,-46924.99 1853,-46924.99 1853,-46872.99 2169,-46872.99 2169,-46924.99"/>
<text text-anchor="middle" x="2011" y="-46912.99" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="2011" y="-46901.99" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-46890.99" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="2011" y="-46879.99" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_10_aggregate&#45;&gt;moe_10_ffn -->
<g id="edge277" class="edge">
<title>moe_10_aggregate&#45;&gt;moe_10_ffn</title>
<path fill="none" stroke="black" d="M2011,-46960.72C2011,-46952.41 2011,-46943.58 2011,-46935.3"/>
<polygon fill="black" stroke="black" points="2014.5,-46935.18 2011,-46925.18 2007.5,-46935.18 2014.5,-46935.18"/>
</g>
<!-- moe_10_res2 -->
<g id="node174" class="node">
<title>moe_10_res2</title>
<polygon fill="lightyellow" stroke="black" points="2347.89,-46836.99 1811.97,-46836.99 1674.11,-46732.99 2210.03,-46732.99 2347.89,-46836.99"/>
<text text-anchor="middle" x="2011" y="-46798.99" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="2011" y="-46787.99" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-46776.99" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="2011" y="-46765.99" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_10_ffn&#45;&gt;moe_10_res2 -->
<g id="edge278" class="edge">
<title>moe_10_ffn&#45;&gt;moe_10_res2</title>
<path fill="none" stroke="black" d="M2011,-46872.85C2011,-46865.17 2011,-46856.36 2011,-46847.36"/>
<polygon fill="black" stroke="black" points="2014.5,-46847.17 2011,-46837.17 2007.5,-46847.17 2014.5,-46847.17"/>
</g>
<!-- moe_10_res1&#45;&gt;moe_10_gate -->
<g id="edge243" class="edge">
<title>moe_10_res1&#45;&gt;moe_10_gate</title>
<path fill="none" stroke="black" d="M1880,-47407.68C1880,-47399.51 1880,-47390.98 1880,-47382.61"/>
<polygon fill="black" stroke="black" points="1883.5,-47382.5 1880,-47372.5 1876.5,-47382.5 1883.5,-47382.5"/>
</g>
<!-- moe_11_mha -->
<g id="node175" class="node">
<title>moe_11_mha</title>
<polygon fill="lightgreen" stroke="black" points="2169,-46685.99 1853,-46685.99 1853,-46633.99 2169,-46633.99 2169,-46685.99"/>
<text text-anchor="middle" x="2011" y="-46673.99" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="2011" y="-46662.99" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-46651.99" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="2011" y="-46640.99" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_10_res2&#45;&gt;moe_11_mha -->
<g id="edge279" class="edge">
<title>moe_10_res2&#45;&gt;moe_11_mha</title>
<path fill="none" stroke="black" d="M2011,-46732.89C2011,-46720.56 2011,-46707.66 2011,-46696.24"/>
<polygon fill="black" stroke="black" points="2014.5,-46696.23 2011,-46686.23 2007.5,-46696.23 2014.5,-46696.23"/>
</g>
<!-- moe_11_res1 -->
<g id="node196" class="node">
<title>moe_11_res1</title>
<polygon fill="lightyellow" stroke="black" points="2347.89,-46597.99 1811.97,-46597.99 1674.11,-46493.99 2210.03,-46493.99 2347.89,-46597.99"/>
<text text-anchor="middle" x="2011" y="-46559.99" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="2011" y="-46548.99" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-46537.99" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="2011" y="-46526.99" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_11_mha&#45;&gt;moe_11_res1 -->
<g id="edge280" class="edge">
<title>moe_11_mha&#45;&gt;moe_11_res1</title>
<path fill="none" stroke="black" d="M2011,-46633.85C2011,-46626.17 2011,-46617.36 2011,-46608.36"/>
<polygon fill="black" stroke="black" points="2014.5,-46608.17 2011,-46598.17 2007.5,-46608.17 2014.5,-46608.17"/>
</g>
<!-- moe_11_gate -->
<g id="node176" class="node">
<title>moe_11_gate</title>
<polygon fill="lightyellow" stroke="black" points="2339.8,-46457.99 1816.75,-46457.99 1682.2,-46353.99 2205.25,-46353.99 2339.8,-46457.99"/>
<text text-anchor="middle" x="2011" y="-46419.99" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="2011" y="-46408.99" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-46397.99" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="2011" y="-46386.99" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_11_route -->
<g id="node177" class="node">
<title>moe_11_route</title>
<ellipse fill="lightblue" stroke="black" cx="2011" cy="-46281.22" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="2011" y="-46295.22" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="2011" y="-46284.22" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2011" y="-46273.22" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="2011" y="-46262.22" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_11_gate&#45;&gt;moe_11_route -->
<g id="edge282" class="edge">
<title>moe_11_gate&#45;&gt;moe_11_route</title>
<path fill="none" stroke="black" d="M2011,-46353.63C2011,-46345.23 2011,-46336.56 2011,-46328.29"/>
<polygon fill="black" stroke="black" points="2014.5,-46328.07 2011,-46318.07 2007.5,-46328.07 2014.5,-46328.07"/>
</g>
<!-- moe_11_expert_0 -->
<g id="node178" class="node">
<title>moe_11_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="350,-46208.45 132,-46208.45 132,-46156.45 350,-46156.45 350,-46208.45"/>
<text text-anchor="middle" x="241" y="-46196.45" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="241" y="-46185.45" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="241" y="-46174.45" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="241" y="-46163.45" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_11_route&#45;&gt;moe_11_expert_0 -->
<g id="edge283" class="edge">
<title>moe_11_route&#45;&gt;moe_11_expert_0</title>
<path fill="none" stroke="black" d="M1795.93,-46275.3C1418.11,-46265.93 648.75,-46243.4 360.24,-46208.49"/>
<polygon fill="black" stroke="black" points="360.54,-46205 350.18,-46207.25 359.68,-46211.95 360.54,-46205"/>
</g>
<!-- moe_11_expert_1 -->
<g id="node179" class="node">
<title>moe_11_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="586,-46208.45 368,-46208.45 368,-46156.45 586,-46156.45 586,-46208.45"/>
<text text-anchor="middle" x="477" y="-46196.45" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="477" y="-46185.45" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="477" y="-46174.45" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="477" y="-46163.45" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_11_route&#45;&gt;moe_11_expert_1 -->
<g id="edge284" class="edge">
<title>moe_11_route&#45;&gt;moe_11_expert_1</title>
<path fill="none" stroke="black" d="M1793.23,-46279.84C1516.57,-46276.94 1024.56,-46263.68 596.29,-46208.53"/>
<polygon fill="black" stroke="black" points="596.55,-46205.03 586.19,-46207.22 595.65,-46211.97 596.55,-46205.03"/>
</g>
<!-- moe_11_expert_2 -->
<g id="node180" class="node">
<title>moe_11_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="822,-46208.45 604,-46208.45 604,-46156.45 822,-46156.45 822,-46208.45"/>
<text text-anchor="middle" x="713" y="-46196.45" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="713" y="-46185.45" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="713" y="-46174.45" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="713" y="-46163.45" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_11_route&#45;&gt;moe_11_expert_2 -->
<g id="edge285" class="edge">
<title>moe_11_route&#45;&gt;moe_11_expert_2</title>
<path fill="none" stroke="black" d="M1794.74,-46276.65C1559.7,-46270.57 1173.2,-46254.14 832.26,-46208.54"/>
<polygon fill="black" stroke="black" points="832.57,-46205.04 822.19,-46207.18 831.63,-46211.98 832.57,-46205.04"/>
</g>
<!-- moe_11_expert_3 -->
<g id="node181" class="node">
<title>moe_11_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1058,-46208.45 840,-46208.45 840,-46156.45 1058,-46156.45 1058,-46208.45"/>
<text text-anchor="middle" x="949" y="-46196.45" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="949" y="-46185.45" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="949" y="-46174.45" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="949" y="-46163.45" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_11_route&#45;&gt;moe_11_expert_3 -->
<g id="edge286" class="edge">
<title>moe_11_route&#45;&gt;moe_11_expert_3</title>
<path fill="none" stroke="black" d="M1799.7,-46272.2C1610.33,-46263.12 1325,-46244.82 1068.47,-46208.58"/>
<polygon fill="black" stroke="black" points="1068.59,-46205.06 1058.2,-46207.12 1067.61,-46211.99 1068.59,-46205.06"/>
</g>
<!-- moe_11_expert_4 -->
<g id="node182" class="node">
<title>moe_11_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1294,-46208.45 1076,-46208.45 1076,-46156.45 1294,-46156.45 1294,-46208.45"/>
<text text-anchor="middle" x="1185" y="-46196.45" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1185" y="-46185.45" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1185" y="-46174.45" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1185" y="-46163.45" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_11_route&#45;&gt;moe_11_expert_4 -->
<g id="edge287" class="edge">
<title>moe_11_route&#45;&gt;moe_11_expert_4</title>
<path fill="none" stroke="black" d="M1812.66,-46265.87C1672.96,-46254.38 1481.46,-46235.88 1304.25,-46208.58"/>
<polygon fill="black" stroke="black" points="1304.63,-46205.1 1294.21,-46207.02 1303.56,-46212.01 1304.63,-46205.1"/>
</g>
<!-- moe_11_expert_5 -->
<g id="node183" class="node">
<title>moe_11_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1530,-46208.45 1312,-46208.45 1312,-46156.45 1530,-46156.45 1530,-46208.45"/>
<text text-anchor="middle" x="1421" y="-46196.45" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1421" y="-46185.45" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1421" y="-46174.45" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1421" y="-46163.45" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_11_route&#45;&gt;moe_11_expert_5 -->
<g id="edge288" class="edge">
<title>moe_11_route&#45;&gt;moe_11_expert_5</title>
<path fill="none" stroke="black" d="M1844.87,-46257.36C1756.99,-46244.68 1647.11,-46227.9 1540.25,-46208.64"/>
<polygon fill="black" stroke="black" points="1540.71,-46205.17 1530.25,-46206.83 1539.46,-46212.05 1540.71,-46205.17"/>
</g>
<!-- moe_11_expert_6 -->
<g id="node184" class="node">
<title>moe_11_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1766,-46208.45 1548,-46208.45 1548,-46156.45 1766,-46156.45 1766,-46208.45"/>
<text text-anchor="middle" x="1657" y="-46196.45" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1657" y="-46185.45" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1657" y="-46174.45" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1657" y="-46163.45" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_11_route&#45;&gt;moe_11_expert_6 -->
<g id="edge289" class="edge">
<title>moe_11_route&#45;&gt;moe_11_expert_6</title>
<path fill="none" stroke="black" d="M1898.99,-46249.6C1853.98,-46237.3 1802.47,-46223.21 1758.56,-46211.21"/>
<polygon fill="black" stroke="black" points="1759.31,-46207.79 1748.74,-46208.53 1757.46,-46214.54 1759.31,-46207.79"/>
</g>
<!-- moe_11_expert_7 -->
<g id="node185" class="node">
<title>moe_11_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="2002,-46208.45 1784,-46208.45 1784,-46156.45 2002,-46156.45 2002,-46208.45"/>
<text text-anchor="middle" x="1893" y="-46196.45" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1893" y="-46185.45" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1893" y="-46174.45" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1893" y="-46163.45" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_11_route&#45;&gt;moe_11_expert_7 -->
<g id="edge290" class="edge">
<title>moe_11_route&#45;&gt;moe_11_expert_7</title>
<path fill="none" stroke="black" d="M1968.07,-46245.01C1956.07,-46235.17 1943.12,-46224.55 1931.41,-46214.95"/>
<polygon fill="black" stroke="black" points="1933.47,-46212.12 1923.52,-46208.48 1929.04,-46217.53 1933.47,-46212.12"/>
</g>
<!-- moe_11_expert_8 -->
<g id="node186" class="node">
<title>moe_11_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2238,-46208.45 2020,-46208.45 2020,-46156.45 2238,-46156.45 2238,-46208.45"/>
<text text-anchor="middle" x="2129" y="-46196.45" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2129" y="-46185.45" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2129" y="-46174.45" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2129" y="-46163.45" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_11_route&#45;&gt;moe_11_expert_8 -->
<g id="edge291" class="edge">
<title>moe_11_route&#45;&gt;moe_11_expert_8</title>
<path fill="none" stroke="black" d="M2053.93,-46245.01C2065.93,-46235.17 2078.88,-46224.55 2090.59,-46214.95"/>
<polygon fill="black" stroke="black" points="2092.96,-46217.53 2098.48,-46208.48 2088.53,-46212.12 2092.96,-46217.53"/>
</g>
<!-- moe_11_expert_9 -->
<g id="node187" class="node">
<title>moe_11_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2474,-46208.45 2256,-46208.45 2256,-46156.45 2474,-46156.45 2474,-46208.45"/>
<text text-anchor="middle" x="2365" y="-46196.45" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2365" y="-46185.45" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2365" y="-46174.45" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2365" y="-46163.45" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_11_route&#45;&gt;moe_11_expert_9 -->
<g id="edge292" class="edge">
<title>moe_11_route&#45;&gt;moe_11_expert_9</title>
<path fill="none" stroke="black" d="M2123.01,-46249.6C2168.02,-46237.3 2219.53,-46223.21 2263.44,-46211.21"/>
<polygon fill="black" stroke="black" points="2264.54,-46214.54 2273.26,-46208.53 2262.69,-46207.79 2264.54,-46214.54"/>
</g>
<!-- moe_11_expert_10 -->
<g id="node188" class="node">
<title>moe_11_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2710,-46208.45 2492,-46208.45 2492,-46156.45 2710,-46156.45 2710,-46208.45"/>
<text text-anchor="middle" x="2601" y="-46196.45" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2601" y="-46185.45" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2601" y="-46174.45" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2601" y="-46163.45" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_11_route&#45;&gt;moe_11_expert_10 -->
<g id="edge293" class="edge">
<title>moe_11_route&#45;&gt;moe_11_expert_10</title>
<path fill="none" stroke="black" d="M2177.13,-46257.36C2265.01,-46244.68 2374.89,-46227.9 2481.75,-46208.64"/>
<polygon fill="black" stroke="black" points="2482.54,-46212.05 2491.75,-46206.83 2481.29,-46205.17 2482.54,-46212.05"/>
</g>
<!-- moe_11_expert_11 -->
<g id="node189" class="node">
<title>moe_11_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2946,-46208.45 2728,-46208.45 2728,-46156.45 2946,-46156.45 2946,-46208.45"/>
<text text-anchor="middle" x="2837" y="-46196.45" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2837" y="-46185.45" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2837" y="-46174.45" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2837" y="-46163.45" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_11_route&#45;&gt;moe_11_expert_11 -->
<g id="edge294" class="edge">
<title>moe_11_route&#45;&gt;moe_11_expert_11</title>
<path fill="none" stroke="black" d="M2209.34,-46265.87C2349.04,-46254.38 2540.54,-46235.88 2717.75,-46208.58"/>
<polygon fill="black" stroke="black" points="2718.44,-46212.01 2727.79,-46207.02 2717.37,-46205.1 2718.44,-46212.01"/>
</g>
<!-- moe_11_expert_12 -->
<g id="node190" class="node">
<title>moe_11_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3182,-46208.45 2964,-46208.45 2964,-46156.45 3182,-46156.45 3182,-46208.45"/>
<text text-anchor="middle" x="3073" y="-46196.45" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3073" y="-46185.45" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3073" y="-46174.45" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3073" y="-46163.45" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_11_route&#45;&gt;moe_11_expert_12 -->
<g id="edge295" class="edge">
<title>moe_11_route&#45;&gt;moe_11_expert_12</title>
<path fill="none" stroke="black" d="M2222.3,-46272.2C2411.67,-46263.12 2697,-46244.82 2953.53,-46208.58"/>
<polygon fill="black" stroke="black" points="2954.39,-46211.99 2963.8,-46207.12 2953.41,-46205.06 2954.39,-46211.99"/>
</g>
<!-- moe_11_expert_13 -->
<g id="node191" class="node">
<title>moe_11_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3418,-46208.45 3200,-46208.45 3200,-46156.45 3418,-46156.45 3418,-46208.45"/>
<text text-anchor="middle" x="3309" y="-46196.45" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3309" y="-46185.45" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3309" y="-46174.45" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3309" y="-46163.45" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_11_route&#45;&gt;moe_11_expert_13 -->
<g id="edge296" class="edge">
<title>moe_11_route&#45;&gt;moe_11_expert_13</title>
<path fill="none" stroke="black" d="M2227.26,-46276.65C2462.3,-46270.57 2848.8,-46254.14 3189.74,-46208.54"/>
<polygon fill="black" stroke="black" points="3190.37,-46211.98 3199.81,-46207.18 3189.43,-46205.04 3190.37,-46211.98"/>
</g>
<!-- moe_11_expert_14 -->
<g id="node192" class="node">
<title>moe_11_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3654,-46208.45 3436,-46208.45 3436,-46156.45 3654,-46156.45 3654,-46208.45"/>
<text text-anchor="middle" x="3545" y="-46196.45" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3545" y="-46185.45" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3545" y="-46174.45" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3545" y="-46163.45" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_11_route&#45;&gt;moe_11_expert_14 -->
<g id="edge297" class="edge">
<title>moe_11_route&#45;&gt;moe_11_expert_14</title>
<path fill="none" stroke="black" d="M2228.77,-46279.84C2505.43,-46276.94 2997.44,-46263.68 3425.71,-46208.53"/>
<polygon fill="black" stroke="black" points="3426.35,-46211.97 3435.81,-46207.22 3425.45,-46205.03 3426.35,-46211.97"/>
</g>
<!-- moe_11_expert_15 -->
<g id="node193" class="node">
<title>moe_11_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3890,-46208.45 3672,-46208.45 3672,-46156.45 3890,-46156.45 3890,-46208.45"/>
<text text-anchor="middle" x="3781" y="-46196.45" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3781" y="-46185.45" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3781" y="-46174.45" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3781" y="-46163.45" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_11_route&#45;&gt;moe_11_expert_15 -->
<g id="edge298" class="edge">
<title>moe_11_route&#45;&gt;moe_11_expert_15</title>
<path fill="none" stroke="black" d="M2226.07,-46275.3C2603.89,-46265.93 3373.25,-46243.4 3661.76,-46208.49"/>
<polygon fill="black" stroke="black" points="3662.32,-46211.95 3671.82,-46207.25 3661.46,-46205 3662.32,-46211.95"/>
</g>
<!-- moe_11_aggregate -->
<g id="node194" class="node">
<title>moe_11_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="2011" cy="-46083.68" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="2011" y="-46097.68" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="2011" y="-46086.68" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2011" y="-46075.68" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="2011" y="-46064.68" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_11_expert_0&#45;&gt;moe_11_aggregate -->
<g id="edge299" class="edge">
<title>moe_11_expert_0&#45;&gt;moe_11_aggregate</title>
<path fill="none" stroke="black" d="M350.18,-46157.65C353.15,-46157.22 356.09,-46156.82 359,-46156.45 626.74,-46122.51 1392.32,-46099.71 1780.04,-46089.99"/>
<polygon fill="black" stroke="black" points="1780.35,-46093.49 1790.26,-46089.74 1780.17,-46086.49 1780.35,-46093.49"/>
</g>
<!-- moe_11_expert_1&#45;&gt;moe_11_aggregate -->
<g id="edge300" class="edge">
<title>moe_11_expert_1&#45;&gt;moe_11_aggregate</title>
<path fill="none" stroke="black" d="M586.19,-46157.68C589.15,-46157.24 592.09,-46156.83 595,-46156.45 1008.79,-46102.47 1495.51,-46088.51 1777.11,-46085.24"/>
<polygon fill="black" stroke="black" points="1777.49,-46088.73 1787.45,-46085.12 1777.41,-46081.74 1777.49,-46088.73"/>
</g>
<!-- moe_11_expert_2&#45;&gt;moe_11_aggregate -->
<g id="edge301" class="edge">
<title>moe_11_expert_2&#45;&gt;moe_11_aggregate</title>
<path fill="none" stroke="black" d="M822.19,-46157.72C825.15,-46157.27 828.09,-46156.84 831,-46156.45 1158.31,-46112.07 1540.45,-46095.13 1779.11,-46088.66"/>
<polygon fill="black" stroke="black" points="1779.4,-46092.15 1789.31,-46088.39 1779.22,-46085.16 1779.4,-46092.15"/>
</g>
<!-- moe_11_expert_3&#45;&gt;moe_11_aggregate -->
<g id="edge302" class="edge">
<title>moe_11_expert_3&#45;&gt;moe_11_aggregate</title>
<path fill="none" stroke="black" d="M1058.2,-46157.78C1061.16,-46157.31 1064.1,-46156.87 1067,-46156.45 1310.76,-46121.52 1592.52,-46102.89 1784.32,-46093.45"/>
<polygon fill="black" stroke="black" points="1784.71,-46096.94 1794.53,-46092.95 1784.37,-46089.94 1784.71,-46096.94"/>
</g>
<!-- moe_11_expert_4&#45;&gt;moe_11_aggregate -->
<g id="edge303" class="edge">
<title>moe_11_expert_4&#45;&gt;moe_11_aggregate</title>
<path fill="none" stroke="black" d="M1294.21,-46157.88C1297.17,-46157.38 1300.1,-46156.9 1303,-46156.45 1468.7,-46130.58 1657.73,-46111.96 1798.77,-46100.18"/>
<polygon fill="black" stroke="black" points="1799.17,-46103.66 1808.84,-46099.35 1798.59,-46096.69 1799.17,-46103.66"/>
</g>
<!-- moe_11_expert_5&#45;&gt;moe_11_aggregate -->
<g id="edge304" class="edge">
<title>moe_11_expert_5&#45;&gt;moe_11_aggregate</title>
<path fill="none" stroke="black" d="M1530.25,-46158.07C1533.19,-46157.52 1536.12,-46156.97 1539,-46156.45 1635.58,-46138.89 1743.83,-46122.22 1832.27,-46109.37"/>
<polygon fill="black" stroke="black" points="1833.01,-46112.8 1842.4,-46107.9 1832,-46105.87 1833.01,-46112.8"/>
</g>
<!-- moe_11_expert_6&#45;&gt;moe_11_aggregate -->
<g id="edge305" class="edge">
<title>moe_11_expert_6&#45;&gt;moe_11_aggregate</title>
<path fill="none" stroke="black" d="M1748.62,-46156.4C1791.27,-46144.74 1842.62,-46130.71 1888.54,-46118.16"/>
<polygon fill="black" stroke="black" points="1889.53,-46121.51 1898.25,-46115.5 1887.68,-46114.76 1889.53,-46121.51"/>
</g>
<!-- moe_11_expert_7&#45;&gt;moe_11_aggregate -->
<g id="edge306" class="edge">
<title>moe_11_expert_7&#45;&gt;moe_11_aggregate</title>
<path fill="none" stroke="black" d="M1923.7,-46156.28C1934.79,-46147.18 1947.63,-46136.65 1959.99,-46126.51"/>
<polygon fill="black" stroke="black" points="1962.51,-46128.97 1968.02,-46119.93 1958.07,-46123.56 1962.51,-46128.97"/>
</g>
<!-- moe_11_expert_8&#45;&gt;moe_11_aggregate -->
<g id="edge307" class="edge">
<title>moe_11_expert_8&#45;&gt;moe_11_aggregate</title>
<path fill="none" stroke="black" d="M2098.3,-46156.28C2087.21,-46147.18 2074.37,-46136.65 2062.01,-46126.51"/>
<polygon fill="black" stroke="black" points="2063.93,-46123.56 2053.98,-46119.93 2059.49,-46128.97 2063.93,-46123.56"/>
</g>
<!-- moe_11_expert_9&#45;&gt;moe_11_aggregate -->
<g id="edge308" class="edge">
<title>moe_11_expert_9&#45;&gt;moe_11_aggregate</title>
<path fill="none" stroke="black" d="M2273.38,-46156.4C2230.73,-46144.74 2179.38,-46130.71 2133.46,-46118.16"/>
<polygon fill="black" stroke="black" points="2134.32,-46114.76 2123.75,-46115.5 2132.47,-46121.51 2134.32,-46114.76"/>
</g>
<!-- moe_11_expert_10&#45;&gt;moe_11_aggregate -->
<g id="edge309" class="edge">
<title>moe_11_expert_10&#45;&gt;moe_11_aggregate</title>
<path fill="none" stroke="black" d="M2491.75,-46158.07C2488.81,-46157.52 2485.88,-46156.97 2483,-46156.45 2386.42,-46138.89 2278.17,-46122.22 2189.73,-46109.37"/>
<polygon fill="black" stroke="black" points="2190,-46105.87 2179.6,-46107.9 2188.99,-46112.8 2190,-46105.87"/>
</g>
<!-- moe_11_expert_11&#45;&gt;moe_11_aggregate -->
<g id="edge310" class="edge">
<title>moe_11_expert_11&#45;&gt;moe_11_aggregate</title>
<path fill="none" stroke="black" d="M2727.79,-46157.88C2724.83,-46157.38 2721.9,-46156.9 2719,-46156.45 2553.3,-46130.58 2364.27,-46111.96 2223.23,-46100.18"/>
<polygon fill="black" stroke="black" points="2223.41,-46096.69 2213.16,-46099.35 2222.83,-46103.66 2223.41,-46096.69"/>
</g>
<!-- moe_11_expert_12&#45;&gt;moe_11_aggregate -->
<g id="edge311" class="edge">
<title>moe_11_expert_12&#45;&gt;moe_11_aggregate</title>
<path fill="none" stroke="black" d="M2963.8,-46157.78C2960.84,-46157.31 2957.9,-46156.87 2955,-46156.45 2711.24,-46121.52 2429.48,-46102.89 2237.68,-46093.45"/>
<polygon fill="black" stroke="black" points="2237.63,-46089.94 2227.47,-46092.95 2237.29,-46096.94 2237.63,-46089.94"/>
</g>
<!-- moe_11_expert_13&#45;&gt;moe_11_aggregate -->
<g id="edge312" class="edge">
<title>moe_11_expert_13&#45;&gt;moe_11_aggregate</title>
<path fill="none" stroke="black" d="M3199.81,-46157.72C3196.85,-46157.27 3193.91,-46156.84 3191,-46156.45 2863.69,-46112.07 2481.55,-46095.13 2242.89,-46088.66"/>
<polygon fill="black" stroke="black" points="2242.78,-46085.16 2232.69,-46088.39 2242.6,-46092.15 2242.78,-46085.16"/>
</g>
<!-- moe_11_expert_14&#45;&gt;moe_11_aggregate -->
<g id="edge313" class="edge">
<title>moe_11_expert_14&#45;&gt;moe_11_aggregate</title>
<path fill="none" stroke="black" d="M3435.81,-46157.68C3432.85,-46157.24 3429.91,-46156.83 3427,-46156.45 3013.21,-46102.47 2526.49,-46088.51 2244.89,-46085.24"/>
<polygon fill="black" stroke="black" points="2244.59,-46081.74 2234.55,-46085.12 2244.51,-46088.73 2244.59,-46081.74"/>
</g>
<!-- moe_11_expert_15&#45;&gt;moe_11_aggregate -->
<g id="edge314" class="edge">
<title>moe_11_expert_15&#45;&gt;moe_11_aggregate</title>
<path fill="none" stroke="black" d="M3671.82,-46157.65C3668.85,-46157.22 3665.91,-46156.82 3663,-46156.45 3395.26,-46122.51 2629.68,-46099.71 2241.96,-46089.99"/>
<polygon fill="black" stroke="black" points="2241.83,-46086.49 2231.74,-46089.74 2241.65,-46093.49 2241.83,-46086.49"/>
</g>
<!-- moe_11_ffn -->
<g id="node195" class="node">
<title>moe_11_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2169,-46010.91 1853,-46010.91 1853,-45958.91 2169,-45958.91 2169,-46010.91"/>
<text text-anchor="middle" x="2011" y="-45998.91" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="2011" y="-45987.91" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-45976.91" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="2011" y="-45965.91" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_11_aggregate&#45;&gt;moe_11_ffn -->
<g id="edge315" class="edge">
<title>moe_11_aggregate&#45;&gt;moe_11_ffn</title>
<path fill="none" stroke="black" d="M2011,-46046.65C2011,-46038.33 2011,-46029.5 2011,-46021.22"/>
<polygon fill="black" stroke="black" points="2014.5,-46021.11 2011,-46011.11 2007.5,-46021.11 2014.5,-46021.11"/>
</g>
<!-- moe_11_res2 -->
<g id="node197" class="node">
<title>moe_11_res2</title>
<polygon fill="lightyellow" stroke="black" points="2347.89,-45922.91 1811.97,-45922.91 1674.11,-45818.91 2210.03,-45818.91 2347.89,-45922.91"/>
<text text-anchor="middle" x="2011" y="-45884.91" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="2011" y="-45873.91" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-45862.91" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="2011" y="-45851.91" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_11_ffn&#45;&gt;moe_11_res2 -->
<g id="edge316" class="edge">
<title>moe_11_ffn&#45;&gt;moe_11_res2</title>
<path fill="none" stroke="black" d="M2011,-45958.78C2011,-45951.09 2011,-45942.28 2011,-45933.28"/>
<polygon fill="black" stroke="black" points="2014.5,-45933.09 2011,-45923.09 2007.5,-45933.09 2014.5,-45933.09"/>
</g>
<!-- moe_11_res1&#45;&gt;moe_11_gate -->
<g id="edge281" class="edge">
<title>moe_11_res1&#45;&gt;moe_11_gate</title>
<path fill="none" stroke="black" d="M2011,-46493.6C2011,-46485.43 2011,-46476.91 2011,-46468.53"/>
<polygon fill="black" stroke="black" points="2014.5,-46468.42 2011,-46458.42 2007.5,-46468.42 2014.5,-46468.42"/>
</g>
<!-- moe_12_mha -->
<g id="node198" class="node">
<title>moe_12_mha</title>
<polygon fill="lightgreen" stroke="black" points="2169,-45771.91 1853,-45771.91 1853,-45719.91 2169,-45719.91 2169,-45771.91"/>
<text text-anchor="middle" x="2011" y="-45759.91" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="2011" y="-45748.91" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-45737.91" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="2011" y="-45726.91" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_11_res2&#45;&gt;moe_12_mha -->
<g id="edge317" class="edge">
<title>moe_11_res2&#45;&gt;moe_12_mha</title>
<path fill="none" stroke="black" d="M2011,-45818.82C2011,-45806.49 2011,-45793.58 2011,-45782.16"/>
<polygon fill="black" stroke="black" points="2014.5,-45782.15 2011,-45772.15 2007.5,-45782.15 2014.5,-45782.15"/>
</g>
<!-- moe_12_res1 -->
<g id="node219" class="node">
<title>moe_12_res1</title>
<polygon fill="lightyellow" stroke="black" points="2347.89,-45683.91 1811.97,-45683.91 1674.11,-45579.91 2210.03,-45579.91 2347.89,-45683.91"/>
<text text-anchor="middle" x="2011" y="-45645.91" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="2011" y="-45634.91" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-45623.91" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="2011" y="-45612.91" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_12_mha&#45;&gt;moe_12_res1 -->
<g id="edge318" class="edge">
<title>moe_12_mha&#45;&gt;moe_12_res1</title>
<path fill="none" stroke="black" d="M2011,-45719.78C2011,-45712.09 2011,-45703.28 2011,-45694.28"/>
<polygon fill="black" stroke="black" points="2014.5,-45694.09 2011,-45684.09 2007.5,-45694.09 2014.5,-45694.09"/>
</g>
<!-- moe_12_gate -->
<g id="node199" class="node">
<title>moe_12_gate</title>
<polygon fill="lightyellow" stroke="black" points="2339.8,-45543.91 1816.75,-45543.91 1682.2,-45439.91 2205.25,-45439.91 2339.8,-45543.91"/>
<text text-anchor="middle" x="2011" y="-45505.91" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="2011" y="-45494.91" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-45483.91" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="2011" y="-45472.91" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_12_route -->
<g id="node200" class="node">
<title>moe_12_route</title>
<ellipse fill="lightblue" stroke="black" cx="2011" cy="-45367.14" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="2011" y="-45381.14" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="2011" y="-45370.14" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2011" y="-45359.14" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="2011" y="-45348.14" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_12_gate&#45;&gt;moe_12_route -->
<g id="edge320" class="edge">
<title>moe_12_gate&#45;&gt;moe_12_route</title>
<path fill="none" stroke="black" d="M2011,-45439.56C2011,-45431.15 2011,-45422.48 2011,-45414.21"/>
<polygon fill="black" stroke="black" points="2014.5,-45414 2011,-45404 2007.5,-45414 2014.5,-45414"/>
</g>
<!-- moe_12_expert_0 -->
<g id="node201" class="node">
<title>moe_12_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="292,-45294.37 74,-45294.37 74,-45242.37 292,-45242.37 292,-45294.37"/>
<text text-anchor="middle" x="183" y="-45282.37" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="183" y="-45271.37" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="183" y="-45260.37" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="183" y="-45249.37" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_12_route&#45;&gt;moe_12_expert_0 -->
<g id="edge321" class="edge">
<title>moe_12_route&#45;&gt;moe_12_expert_0</title>
<path fill="none" stroke="black" d="M1795.34,-45361.58C1406.66,-45352.62 601.98,-45330.5 302.2,-45294.41"/>
<polygon fill="black" stroke="black" points="302.54,-45290.92 292.18,-45293.17 301.68,-45297.87 302.54,-45290.92"/>
</g>
<!-- moe_12_expert_1 -->
<g id="node202" class="node">
<title>moe_12_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="528,-45294.37 310,-45294.37 310,-45242.37 528,-45242.37 528,-45294.37"/>
<text text-anchor="middle" x="419" y="-45282.37" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="419" y="-45271.37" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="419" y="-45260.37" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="419" y="-45249.37" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_12_route&#45;&gt;moe_12_expert_1 -->
<g id="edge322" class="edge">
<title>moe_12_route&#45;&gt;moe_12_expert_1</title>
<path fill="none" stroke="black" d="M1793.06,-45366.4C1506.67,-45364.28 988.2,-45351.96 538.14,-45294.43"/>
<polygon fill="black" stroke="black" points="538.55,-45290.95 528.19,-45293.15 537.66,-45297.89 538.55,-45290.95"/>
</g>
<!-- moe_12_expert_2 -->
<g id="node203" class="node">
<title>moe_12_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="764,-45294.37 546,-45294.37 546,-45242.37 764,-45242.37 764,-45294.37"/>
<text text-anchor="middle" x="655" y="-45282.37" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="655" y="-45271.37" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="655" y="-45260.37" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="655" y="-45249.37" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_12_route&#45;&gt;moe_12_expert_2 -->
<g id="edge323" class="edge">
<title>moe_12_route&#45;&gt;moe_12_expert_2</title>
<path fill="none" stroke="black" d="M1794.24,-45363.46C1548.65,-45358.15 1136.54,-45342.4 774.35,-45294.47"/>
<polygon fill="black" stroke="black" points="774.57,-45290.96 764.19,-45293.11 773.64,-45297.9 774.57,-45290.96"/>
</g>
<!-- moe_12_expert_3 -->
<g id="node204" class="node">
<title>moe_12_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1000,-45294.37 782,-45294.37 782,-45242.37 1000,-45242.37 1000,-45294.37"/>
<text text-anchor="middle" x="891" y="-45282.37" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="891" y="-45271.37" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="891" y="-45260.37" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="891" y="-45249.37" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_12_route&#45;&gt;moe_12_expert_3 -->
<g id="edge324" class="edge">
<title>moe_12_route&#45;&gt;moe_12_expert_3</title>
<path fill="none" stroke="black" d="M1798.02,-45359.36C1597.05,-45350.99 1287.37,-45333 1010.45,-45294.49"/>
<polygon fill="black" stroke="black" points="1010.59,-45290.98 1000.2,-45293.06 1009.61,-45297.91 1010.59,-45290.98"/>
</g>
<!-- moe_12_expert_4 -->
<g id="node205" class="node">
<title>moe_12_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1236,-45294.37 1018,-45294.37 1018,-45242.37 1236,-45242.37 1236,-45294.37"/>
<text text-anchor="middle" x="1127" y="-45282.37" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1127" y="-45271.37" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1127" y="-45260.37" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1127" y="-45249.37" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_12_route&#45;&gt;moe_12_expert_4 -->
<g id="edge325" class="edge">
<title>moe_12_route&#45;&gt;moe_12_expert_4</title>
<path fill="none" stroke="black" d="M1808.22,-45353.55C1655.94,-45342.56 1442.22,-45323.93 1246.13,-45294.47"/>
<polygon fill="black" stroke="black" points="1246.62,-45291.01 1236.21,-45292.97 1245.57,-45297.93 1246.62,-45291.01"/>
</g>
<!-- moe_12_expert_5 -->
<g id="node206" class="node">
<title>moe_12_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1472,-45294.37 1254,-45294.37 1254,-45242.37 1472,-45242.37 1472,-45294.37"/>
<text text-anchor="middle" x="1363" y="-45282.37" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1363" y="-45271.37" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1363" y="-45260.37" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1363" y="-45249.37" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_12_route&#45;&gt;moe_12_expert_5 -->
<g id="edge326" class="edge">
<title>moe_12_route&#45;&gt;moe_12_expert_5</title>
<path fill="none" stroke="black" d="M1834.43,-45345.56C1733.85,-45333.03 1605.32,-45315.66 1482.22,-45294.54"/>
<polygon fill="black" stroke="black" points="1482.69,-45291.06 1472.24,-45292.81 1481.49,-45297.96 1482.69,-45291.06"/>
</g>
<!-- moe_12_expert_6 -->
<g id="node207" class="node">
<title>moe_12_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1708,-45294.37 1490,-45294.37 1490,-45242.37 1708,-45242.37 1708,-45294.37"/>
<text text-anchor="middle" x="1599" y="-45282.37" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1599" y="-45271.37" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1599" y="-45260.37" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1599" y="-45249.37" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_12_route&#45;&gt;moe_12_expert_6 -->
<g id="edge327" class="edge">
<title>moe_12_route&#45;&gt;moe_12_expert_6</title>
<path fill="none" stroke="black" d="M1886.55,-45336.91C1832.25,-45324.16 1768.93,-45309.28 1715.55,-45296.75"/>
<polygon fill="black" stroke="black" points="1716.24,-45293.31 1705.71,-45294.43 1714.64,-45300.13 1716.24,-45293.31"/>
</g>
<!-- moe_12_expert_7 -->
<g id="node208" class="node">
<title>moe_12_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1944,-45294.37 1726,-45294.37 1726,-45242.37 1944,-45242.37 1944,-45294.37"/>
<text text-anchor="middle" x="1835" y="-45282.37" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1835" y="-45271.37" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1835" y="-45260.37" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1835" y="-45249.37" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_12_route&#45;&gt;moe_12_expert_7 -->
<g id="edge328" class="edge">
<title>moe_12_route&#45;&gt;moe_12_expert_7</title>
<path fill="none" stroke="black" d="M1948.45,-45331.75C1929.18,-45321.15 1908.12,-45309.58 1889.44,-45299.3"/>
<polygon fill="black" stroke="black" points="1890.93,-45296.13 1880.48,-45294.38 1887.55,-45302.26 1890.93,-45296.13"/>
</g>
<!-- moe_12_expert_8 -->
<g id="node209" class="node">
<title>moe_12_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2180,-45294.37 1962,-45294.37 1962,-45242.37 2180,-45242.37 2180,-45294.37"/>
<text text-anchor="middle" x="2071" y="-45282.37" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2071" y="-45271.37" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2071" y="-45260.37" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2071" y="-45249.37" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_12_route&#45;&gt;moe_12_expert_8 -->
<g id="edge329" class="edge">
<title>moe_12_route&#45;&gt;moe_12_expert_8</title>
<path fill="none" stroke="black" d="M2033.17,-45330.38C2038.73,-45321.42 2044.67,-45311.83 2050.16,-45302.98"/>
<polygon fill="black" stroke="black" points="2053.18,-45304.76 2055.47,-45294.41 2047.23,-45301.07 2053.18,-45304.76"/>
</g>
<!-- moe_12_expert_9 -->
<g id="node210" class="node">
<title>moe_12_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2416,-45294.37 2198,-45294.37 2198,-45242.37 2416,-45242.37 2416,-45294.37"/>
<text text-anchor="middle" x="2307" y="-45282.37" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2307" y="-45271.37" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2307" y="-45260.37" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2307" y="-45249.37" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_12_route&#45;&gt;moe_12_expert_9 -->
<g id="edge330" class="edge">
<title>moe_12_route&#45;&gt;moe_12_expert_9</title>
<path fill="none" stroke="black" d="M2108.74,-45334.19C2144.91,-45322.36 2185.63,-45309.05 2220.71,-45297.58"/>
<polygon fill="black" stroke="black" points="2222.03,-45300.83 2230.45,-45294.4 2219.86,-45294.18 2222.03,-45300.83"/>
</g>
<!-- moe_12_expert_10 -->
<g id="node211" class="node">
<title>moe_12_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2652,-45294.37 2434,-45294.37 2434,-45242.37 2652,-45242.37 2652,-45294.37"/>
<text text-anchor="middle" x="2543" y="-45282.37" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2543" y="-45271.37" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2543" y="-45260.37" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2543" y="-45249.37" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_12_route&#45;&gt;moe_12_expert_10 -->
<g id="edge331" class="edge">
<title>moe_12_route&#45;&gt;moe_12_expert_10</title>
<path fill="none" stroke="black" d="M2164.11,-45340.99C2239.55,-45328.26 2332.1,-45312.14 2423.73,-45294.59"/>
<polygon fill="black" stroke="black" points="2424.58,-45297.99 2433.74,-45292.67 2423.26,-45291.12 2424.58,-45297.99"/>
</g>
<!-- moe_12_expert_11 -->
<g id="node212" class="node">
<title>moe_12_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2888,-45294.37 2670,-45294.37 2670,-45242.37 2888,-45242.37 2888,-45294.37"/>
<text text-anchor="middle" x="2779" y="-45282.37" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2779" y="-45271.37" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2779" y="-45260.37" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2779" y="-45249.37" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_12_route&#45;&gt;moe_12_expert_11 -->
<g id="edge332" class="edge">
<title>moe_12_route&#45;&gt;moe_12_expert_11</title>
<path fill="none" stroke="black" d="M2203.65,-45349.9C2330.69,-45337.99 2500.85,-45319.73 2659.81,-45294.5"/>
<polygon fill="black" stroke="black" points="2660.46,-45297.94 2669.78,-45292.91 2659.35,-45291.03 2660.46,-45297.94"/>
</g>
<!-- moe_12_expert_12 -->
<g id="node213" class="node">
<title>moe_12_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3124,-45294.37 2906,-45294.37 2906,-45242.37 3124,-45242.37 3124,-45294.37"/>
<text text-anchor="middle" x="3015" y="-45282.37" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3015" y="-45271.37" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3015" y="-45260.37" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3015" y="-45249.37" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_12_route&#45;&gt;moe_12_expert_12 -->
<g id="edge333" class="edge">
<title>moe_12_route&#45;&gt;moe_12_expert_12</title>
<path fill="none" stroke="black" d="M2219.96,-45356.77C2397.48,-45347.03 2659.07,-45328.5 2895.62,-45294.5"/>
<polygon fill="black" stroke="black" points="2896.4,-45297.92 2905.8,-45293.02 2895.4,-45290.99 2896.4,-45297.92"/>
</g>
<!-- moe_12_expert_13 -->
<g id="node214" class="node">
<title>moe_12_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3360,-45294.37 3142,-45294.37 3142,-45242.37 3360,-45242.37 3360,-45294.37"/>
<text text-anchor="middle" x="3251" y="-45282.37" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3251" y="-45271.37" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3251" y="-45260.37" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3251" y="-45249.37" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_12_route&#45;&gt;moe_12_expert_13 -->
<g id="edge334" class="edge">
<title>moe_12_route&#45;&gt;moe_12_expert_13</title>
<path fill="none" stroke="black" d="M2226.5,-45361.62C2450.74,-45354.77 2811.99,-45337.73 3131.88,-45294.44"/>
<polygon fill="black" stroke="black" points="3132.37,-45297.91 3141.81,-45293.09 3131.43,-45290.97 3132.37,-45297.91"/>
</g>
<!-- moe_12_expert_14 -->
<g id="node215" class="node">
<title>moe_12_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3596,-45294.37 3378,-45294.37 3378,-45242.37 3596,-45242.37 3596,-45294.37"/>
<text text-anchor="middle" x="3487" y="-45282.37" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3487" y="-45271.37" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3487" y="-45260.37" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3487" y="-45249.37" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_12_route&#45;&gt;moe_12_expert_14 -->
<g id="edge335" class="edge">
<title>moe_12_route&#45;&gt;moe_12_expert_14</title>
<path fill="none" stroke="black" d="M2228.63,-45365.07C2495.39,-45361.38 2961.07,-45347.24 3367.62,-45294.46"/>
<polygon fill="black" stroke="black" points="3368.35,-45297.9 3377.81,-45293.13 3367.44,-45290.96 3368.35,-45297.9"/>
</g>
<!-- moe_12_expert_15 -->
<g id="node216" class="node">
<title>moe_12_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3832,-45294.37 3614,-45294.37 3614,-45242.37 3832,-45242.37 3832,-45294.37"/>
<text text-anchor="middle" x="3723" y="-45282.37" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3723" y="-45271.37" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3723" y="-45260.37" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3723" y="-45249.37" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_12_route&#45;&gt;moe_12_expert_15 -->
<g id="edge336" class="edge">
<title>moe_12_route&#45;&gt;moe_12_expert_15</title>
<path fill="none" stroke="black" d="M2225.83,-45360.83C2592.76,-45351.04 3326.61,-45328.13 3603.75,-45294.42"/>
<polygon fill="black" stroke="black" points="3604.33,-45297.87 3613.82,-45293.16 3603.46,-45290.93 3604.33,-45297.87"/>
</g>
<!-- moe_12_aggregate -->
<g id="node217" class="node">
<title>moe_12_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1953" cy="-45169.6" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1953" y="-45183.6" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1953" y="-45172.6" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1953" y="-45161.6" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1953" y="-45150.6" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_12_expert_0&#45;&gt;moe_12_aggregate -->
<g id="edge337" class="edge">
<title>moe_12_expert_0&#45;&gt;moe_12_aggregate</title>
<path fill="none" stroke="black" d="M292.18,-45243.58C295.15,-45243.14 298.09,-45242.74 301,-45242.37 568.74,-45208.43 1334.32,-45185.63 1722.04,-45175.92"/>
<polygon fill="black" stroke="black" points="1722.35,-45179.41 1732.26,-45175.66 1722.17,-45172.41 1722.35,-45179.41"/>
</g>
<!-- moe_12_expert_1&#45;&gt;moe_12_aggregate -->
<g id="edge338" class="edge">
<title>moe_12_expert_1&#45;&gt;moe_12_aggregate</title>
<path fill="none" stroke="black" d="M528.19,-45243.6C531.15,-45243.16 534.09,-45242.75 537,-45242.37 950.79,-45188.4 1437.51,-45174.43 1719.11,-45171.16"/>
<polygon fill="black" stroke="black" points="1719.49,-45174.66 1729.45,-45171.04 1719.41,-45167.66 1719.49,-45174.66"/>
</g>
<!-- moe_12_expert_2&#45;&gt;moe_12_aggregate -->
<g id="edge339" class="edge">
<title>moe_12_expert_2&#45;&gt;moe_12_aggregate</title>
<path fill="none" stroke="black" d="M764.19,-45243.64C767.15,-45243.19 770.09,-45242.77 773,-45242.37 1100.31,-45197.99 1482.45,-45181.05 1721.11,-45174.58"/>
<polygon fill="black" stroke="black" points="1721.4,-45178.08 1731.31,-45174.31 1721.22,-45171.08 1721.4,-45178.08"/>
</g>
<!-- moe_12_expert_3&#45;&gt;moe_12_aggregate -->
<g id="edge340" class="edge">
<title>moe_12_expert_3&#45;&gt;moe_12_aggregate</title>
<path fill="none" stroke="black" d="M1000.2,-45243.7C1003.16,-45243.23 1006.1,-45242.79 1009,-45242.37 1252.76,-45207.44 1534.52,-45188.82 1726.32,-45179.37"/>
<polygon fill="black" stroke="black" points="1726.71,-45182.86 1736.53,-45178.87 1726.37,-45175.87 1726.71,-45182.86"/>
</g>
<!-- moe_12_expert_4&#45;&gt;moe_12_aggregate -->
<g id="edge341" class="edge">
<title>moe_12_expert_4&#45;&gt;moe_12_aggregate</title>
<path fill="none" stroke="black" d="M1236.21,-45243.8C1239.17,-45243.3 1242.1,-45242.82 1245,-45242.37 1410.7,-45216.5 1599.73,-45197.88 1740.77,-45186.11"/>
<polygon fill="black" stroke="black" points="1741.17,-45189.59 1750.84,-45185.27 1740.59,-45182.61 1741.17,-45189.59"/>
</g>
<!-- moe_12_expert_5&#45;&gt;moe_12_aggregate -->
<g id="edge342" class="edge">
<title>moe_12_expert_5&#45;&gt;moe_12_aggregate</title>
<path fill="none" stroke="black" d="M1472.25,-45243.99C1475.19,-45243.44 1478.12,-45242.9 1481,-45242.37 1577.58,-45224.81 1685.83,-45208.14 1774.27,-45195.29"/>
<polygon fill="black" stroke="black" points="1775.01,-45198.72 1784.4,-45193.82 1774,-45191.79 1775.01,-45198.72"/>
</g>
<!-- moe_12_expert_6&#45;&gt;moe_12_aggregate -->
<g id="edge343" class="edge">
<title>moe_12_expert_6&#45;&gt;moe_12_aggregate</title>
<path fill="none" stroke="black" d="M1690.62,-45242.33C1733.27,-45230.67 1784.62,-45216.63 1830.54,-45204.08"/>
<polygon fill="black" stroke="black" points="1831.53,-45207.44 1840.25,-45201.42 1829.68,-45200.68 1831.53,-45207.44"/>
</g>
<!-- moe_12_expert_7&#45;&gt;moe_12_aggregate -->
<g id="edge344" class="edge">
<title>moe_12_expert_7&#45;&gt;moe_12_aggregate</title>
<path fill="none" stroke="black" d="M1865.7,-45242.2C1876.79,-45233.1 1889.63,-45222.57 1901.99,-45212.43"/>
<polygon fill="black" stroke="black" points="1904.51,-45214.89 1910.02,-45205.85 1900.07,-45209.48 1904.51,-45214.89"/>
</g>
<!-- moe_12_expert_8&#45;&gt;moe_12_aggregate -->
<g id="edge345" class="edge">
<title>moe_12_expert_8&#45;&gt;moe_12_aggregate</title>
<path fill="none" stroke="black" d="M2040.3,-45242.2C2029.21,-45233.1 2016.37,-45222.57 2004.01,-45212.43"/>
<polygon fill="black" stroke="black" points="2005.93,-45209.48 1995.98,-45205.85 2001.49,-45214.89 2005.93,-45209.48"/>
</g>
<!-- moe_12_expert_9&#45;&gt;moe_12_aggregate -->
<g id="edge346" class="edge">
<title>moe_12_expert_9&#45;&gt;moe_12_aggregate</title>
<path fill="none" stroke="black" d="M2215.38,-45242.33C2172.73,-45230.67 2121.38,-45216.63 2075.46,-45204.08"/>
<polygon fill="black" stroke="black" points="2076.32,-45200.68 2065.75,-45201.42 2074.47,-45207.44 2076.32,-45200.68"/>
</g>
<!-- moe_12_expert_10&#45;&gt;moe_12_aggregate -->
<g id="edge347" class="edge">
<title>moe_12_expert_10&#45;&gt;moe_12_aggregate</title>
<path fill="none" stroke="black" d="M2433.75,-45243.99C2430.81,-45243.44 2427.88,-45242.9 2425,-45242.37 2328.42,-45224.81 2220.17,-45208.14 2131.73,-45195.29"/>
<polygon fill="black" stroke="black" points="2132,-45191.79 2121.6,-45193.82 2130.99,-45198.72 2132,-45191.79"/>
</g>
<!-- moe_12_expert_11&#45;&gt;moe_12_aggregate -->
<g id="edge348" class="edge">
<title>moe_12_expert_11&#45;&gt;moe_12_aggregate</title>
<path fill="none" stroke="black" d="M2669.79,-45243.8C2666.83,-45243.3 2663.9,-45242.82 2661,-45242.37 2495.3,-45216.5 2306.27,-45197.88 2165.23,-45186.11"/>
<polygon fill="black" stroke="black" points="2165.41,-45182.61 2155.16,-45185.27 2164.83,-45189.59 2165.41,-45182.61"/>
</g>
<!-- moe_12_expert_12&#45;&gt;moe_12_aggregate -->
<g id="edge349" class="edge">
<title>moe_12_expert_12&#45;&gt;moe_12_aggregate</title>
<path fill="none" stroke="black" d="M2905.8,-45243.7C2902.84,-45243.23 2899.9,-45242.79 2897,-45242.37 2653.24,-45207.44 2371.48,-45188.82 2179.68,-45179.37"/>
<polygon fill="black" stroke="black" points="2179.63,-45175.87 2169.47,-45178.87 2179.29,-45182.86 2179.63,-45175.87"/>
</g>
<!-- moe_12_expert_13&#45;&gt;moe_12_aggregate -->
<g id="edge350" class="edge">
<title>moe_12_expert_13&#45;&gt;moe_12_aggregate</title>
<path fill="none" stroke="black" d="M3141.81,-45243.64C3138.85,-45243.19 3135.91,-45242.77 3133,-45242.37 2805.69,-45197.99 2423.55,-45181.05 2184.89,-45174.58"/>
<polygon fill="black" stroke="black" points="2184.78,-45171.08 2174.69,-45174.31 2184.6,-45178.08 2184.78,-45171.08"/>
</g>
<!-- moe_12_expert_14&#45;&gt;moe_12_aggregate -->
<g id="edge351" class="edge">
<title>moe_12_expert_14&#45;&gt;moe_12_aggregate</title>
<path fill="none" stroke="black" d="M3377.81,-45243.6C3374.85,-45243.16 3371.91,-45242.75 3369,-45242.37 2955.21,-45188.4 2468.49,-45174.43 2186.89,-45171.16"/>
<polygon fill="black" stroke="black" points="2186.59,-45167.66 2176.55,-45171.04 2186.51,-45174.66 2186.59,-45167.66"/>
</g>
<!-- moe_12_expert_15&#45;&gt;moe_12_aggregate -->
<g id="edge352" class="edge">
<title>moe_12_expert_15&#45;&gt;moe_12_aggregate</title>
<path fill="none" stroke="black" d="M3613.82,-45243.58C3610.85,-45243.14 3607.91,-45242.74 3605,-45242.37 3337.26,-45208.43 2571.68,-45185.63 2183.96,-45175.92"/>
<polygon fill="black" stroke="black" points="2183.83,-45172.41 2173.74,-45175.66 2183.65,-45179.41 2183.83,-45172.41"/>
</g>
<!-- moe_12_ffn -->
<g id="node218" class="node">
<title>moe_12_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2111,-45096.83 1795,-45096.83 1795,-45044.83 2111,-45044.83 2111,-45096.83"/>
<text text-anchor="middle" x="1953" y="-45084.83" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1953" y="-45073.83" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1953" y="-45062.83" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1953" y="-45051.83" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_12_aggregate&#45;&gt;moe_12_ffn -->
<g id="edge353" class="edge">
<title>moe_12_aggregate&#45;&gt;moe_12_ffn</title>
<path fill="none" stroke="black" d="M1953,-45132.57C1953,-45124.26 1953,-45115.42 1953,-45107.14"/>
<polygon fill="black" stroke="black" points="1956.5,-45107.03 1953,-45097.03 1949.5,-45107.03 1956.5,-45107.03"/>
</g>
<!-- moe_12_res2 -->
<g id="node220" class="node">
<title>moe_12_res2</title>
<polygon fill="lightyellow" stroke="black" points="2289.89,-45008.83 1753.97,-45008.83 1616.11,-44904.83 2152.03,-44904.83 2289.89,-45008.83"/>
<text text-anchor="middle" x="1953" y="-44970.83" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1953" y="-44959.83" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1953" y="-44948.83" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1953" y="-44937.83" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_12_ffn&#45;&gt;moe_12_res2 -->
<g id="edge354" class="edge">
<title>moe_12_ffn&#45;&gt;moe_12_res2</title>
<path fill="none" stroke="black" d="M1953,-45044.7C1953,-45037.01 1953,-45028.2 1953,-45019.2"/>
<polygon fill="black" stroke="black" points="1956.5,-45019.01 1953,-45009.01 1949.5,-45019.01 1956.5,-45019.01"/>
</g>
<!-- moe_12_res1&#45;&gt;moe_12_gate -->
<g id="edge319" class="edge">
<title>moe_12_res1&#45;&gt;moe_12_gate</title>
<path fill="none" stroke="black" d="M2011,-45579.52C2011,-45571.35 2011,-45562.83 2011,-45554.45"/>
<polygon fill="black" stroke="black" points="2014.5,-45554.34 2011,-45544.34 2007.5,-45554.34 2014.5,-45554.34"/>
</g>
<!-- moe_13_mha -->
<g id="node221" class="node">
<title>moe_13_mha</title>
<polygon fill="lightgreen" stroke="black" points="2111,-44857.83 1795,-44857.83 1795,-44805.83 2111,-44805.83 2111,-44857.83"/>
<text text-anchor="middle" x="1953" y="-44845.83" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1953" y="-44834.83" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1953" y="-44823.83" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1953" y="-44812.83" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_12_res2&#45;&gt;moe_13_mha -->
<g id="edge355" class="edge">
<title>moe_12_res2&#45;&gt;moe_13_mha</title>
<path fill="none" stroke="black" d="M1953,-44904.74C1953,-44892.41 1953,-44879.5 1953,-44868.08"/>
<polygon fill="black" stroke="black" points="1956.5,-44868.07 1953,-44858.07 1949.5,-44868.07 1956.5,-44868.07"/>
</g>
<!-- moe_13_res1 -->
<g id="node242" class="node">
<title>moe_13_res1</title>
<polygon fill="lightyellow" stroke="black" points="2289.89,-44769.83 1753.97,-44769.83 1616.11,-44665.83 2152.03,-44665.83 2289.89,-44769.83"/>
<text text-anchor="middle" x="1953" y="-44731.83" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1953" y="-44720.83" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1953" y="-44709.83" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1953" y="-44698.83" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_13_mha&#45;&gt;moe_13_res1 -->
<g id="edge356" class="edge">
<title>moe_13_mha&#45;&gt;moe_13_res1</title>
<path fill="none" stroke="black" d="M1953,-44805.7C1953,-44798.01 1953,-44789.2 1953,-44780.2"/>
<polygon fill="black" stroke="black" points="1956.5,-44780.01 1953,-44770.01 1949.5,-44780.01 1956.5,-44780.01"/>
</g>
<!-- moe_13_gate -->
<g id="node222" class="node">
<title>moe_13_gate</title>
<polygon fill="lightyellow" stroke="black" points="2281.8,-44629.83 1758.75,-44629.83 1624.2,-44525.83 2147.25,-44525.83 2281.8,-44629.83"/>
<text text-anchor="middle" x="1953" y="-44591.83" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1953" y="-44580.83" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1953" y="-44569.83" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1953" y="-44558.83" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_13_route -->
<g id="node223" class="node">
<title>moe_13_route</title>
<ellipse fill="lightblue" stroke="black" cx="1953" cy="-44453.06" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1953" y="-44467.06" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1953" y="-44456.06" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1953" y="-44445.06" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1953" y="-44434.06" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_13_gate&#45;&gt;moe_13_route -->
<g id="edge358" class="edge">
<title>moe_13_gate&#45;&gt;moe_13_route</title>
<path fill="none" stroke="black" d="M1953,-44525.48C1953,-44517.07 1953,-44508.4 1953,-44500.13"/>
<polygon fill="black" stroke="black" points="1956.5,-44499.92 1953,-44489.92 1949.5,-44499.92 1956.5,-44499.92"/>
</g>
<!-- moe_13_expert_0 -->
<g id="node224" class="node">
<title>moe_13_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="292,-44380.29 74,-44380.29 74,-44328.29 292,-44328.29 292,-44380.29"/>
<text text-anchor="middle" x="183" y="-44368.29" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="183" y="-44357.29" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="183" y="-44346.29" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="183" y="-44335.29" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_13_route&#45;&gt;moe_13_expert_0 -->
<g id="edge359" class="edge">
<title>moe_13_route&#45;&gt;moe_13_expert_0</title>
<path fill="none" stroke="black" d="M1737.93,-44447.14C1360.11,-44437.77 590.75,-44415.24 302.24,-44380.34"/>
<polygon fill="black" stroke="black" points="302.54,-44376.85 292.18,-44379.09 301.68,-44383.79 302.54,-44376.85"/>
</g>
<!-- moe_13_expert_1 -->
<g id="node225" class="node">
<title>moe_13_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="528,-44380.29 310,-44380.29 310,-44328.29 528,-44328.29 528,-44380.29"/>
<text text-anchor="middle" x="419" y="-44368.29" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="419" y="-44357.29" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="419" y="-44346.29" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="419" y="-44335.29" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_13_route&#45;&gt;moe_13_expert_1 -->
<g id="edge360" class="edge">
<title>moe_13_route&#45;&gt;moe_13_expert_1</title>
<path fill="none" stroke="black" d="M1735.23,-44451.68C1458.57,-44448.78 966.56,-44435.52 538.29,-44380.37"/>
<polygon fill="black" stroke="black" points="538.55,-44376.88 528.19,-44379.06 537.65,-44383.82 538.55,-44376.88"/>
</g>
<!-- moe_13_expert_2 -->
<g id="node226" class="node">
<title>moe_13_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="764,-44380.29 546,-44380.29 546,-44328.29 764,-44328.29 764,-44380.29"/>
<text text-anchor="middle" x="655" y="-44368.29" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="655" y="-44357.29" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="655" y="-44346.29" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="655" y="-44335.29" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_13_route&#45;&gt;moe_13_expert_2 -->
<g id="edge361" class="edge">
<title>moe_13_route&#45;&gt;moe_13_expert_2</title>
<path fill="none" stroke="black" d="M1736.74,-44448.5C1501.7,-44442.41 1115.2,-44425.98 774.26,-44380.38"/>
<polygon fill="black" stroke="black" points="774.57,-44376.89 764.19,-44379.02 773.63,-44383.83 774.57,-44376.89"/>
</g>
<!-- moe_13_expert_3 -->
<g id="node227" class="node">
<title>moe_13_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1000,-44380.29 782,-44380.29 782,-44328.29 1000,-44328.29 1000,-44380.29"/>
<text text-anchor="middle" x="891" y="-44368.29" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="891" y="-44357.29" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="891" y="-44346.29" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="891" y="-44335.29" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_13_route&#45;&gt;moe_13_expert_3 -->
<g id="edge362" class="edge">
<title>moe_13_route&#45;&gt;moe_13_expert_3</title>
<path fill="none" stroke="black" d="M1741.7,-44444.04C1552.33,-44434.97 1267,-44416.66 1010.47,-44380.42"/>
<polygon fill="black" stroke="black" points="1010.59,-44376.91 1000.2,-44378.96 1009.61,-44383.84 1010.59,-44376.91"/>
</g>
<!-- moe_13_expert_4 -->
<g id="node228" class="node">
<title>moe_13_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1236,-44380.29 1018,-44380.29 1018,-44328.29 1236,-44328.29 1236,-44380.29"/>
<text text-anchor="middle" x="1127" y="-44368.29" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1127" y="-44357.29" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1127" y="-44346.29" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1127" y="-44335.29" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_13_route&#45;&gt;moe_13_expert_4 -->
<g id="edge363" class="edge">
<title>moe_13_route&#45;&gt;moe_13_expert_4</title>
<path fill="none" stroke="black" d="M1754.66,-44437.71C1614.96,-44426.23 1423.46,-44407.73 1246.25,-44380.42"/>
<polygon fill="black" stroke="black" points="1246.63,-44376.94 1236.21,-44378.86 1245.56,-44383.86 1246.63,-44376.94"/>
</g>
<!-- moe_13_expert_5 -->
<g id="node229" class="node">
<title>moe_13_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1472,-44380.29 1254,-44380.29 1254,-44328.29 1472,-44328.29 1472,-44380.29"/>
<text text-anchor="middle" x="1363" y="-44368.29" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1363" y="-44357.29" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1363" y="-44346.29" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1363" y="-44335.29" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_13_route&#45;&gt;moe_13_expert_5 -->
<g id="edge364" class="edge">
<title>moe_13_route&#45;&gt;moe_13_expert_5</title>
<path fill="none" stroke="black" d="M1786.87,-44429.2C1698.99,-44416.52 1589.11,-44399.75 1482.25,-44380.48"/>
<polygon fill="black" stroke="black" points="1482.71,-44377.01 1472.25,-44378.67 1481.46,-44383.9 1482.71,-44377.01"/>
</g>
<!-- moe_13_expert_6 -->
<g id="node230" class="node">
<title>moe_13_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1708,-44380.29 1490,-44380.29 1490,-44328.29 1708,-44328.29 1708,-44380.29"/>
<text text-anchor="middle" x="1599" y="-44368.29" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1599" y="-44357.29" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1599" y="-44346.29" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1599" y="-44335.29" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_13_route&#45;&gt;moe_13_expert_6 -->
<g id="edge365" class="edge">
<title>moe_13_route&#45;&gt;moe_13_expert_6</title>
<path fill="none" stroke="black" d="M1840.99,-44421.44C1795.98,-44409.14 1744.47,-44395.06 1700.56,-44383.06"/>
<polygon fill="black" stroke="black" points="1701.31,-44379.63 1690.74,-44380.37 1699.46,-44386.38 1701.31,-44379.63"/>
</g>
<!-- moe_13_expert_7 -->
<g id="node231" class="node">
<title>moe_13_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1944,-44380.29 1726,-44380.29 1726,-44328.29 1944,-44328.29 1944,-44380.29"/>
<text text-anchor="middle" x="1835" y="-44368.29" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1835" y="-44357.29" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1835" y="-44346.29" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1835" y="-44335.29" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_13_route&#45;&gt;moe_13_expert_7 -->
<g id="edge366" class="edge">
<title>moe_13_route&#45;&gt;moe_13_expert_7</title>
<path fill="none" stroke="black" d="M1910.07,-44416.85C1898.07,-44407.02 1885.12,-44396.4 1873.41,-44386.79"/>
<polygon fill="black" stroke="black" points="1875.47,-44383.96 1865.52,-44380.32 1871.04,-44389.37 1875.47,-44383.96"/>
</g>
<!-- moe_13_expert_8 -->
<g id="node232" class="node">
<title>moe_13_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2180,-44380.29 1962,-44380.29 1962,-44328.29 2180,-44328.29 2180,-44380.29"/>
<text text-anchor="middle" x="2071" y="-44368.29" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2071" y="-44357.29" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2071" y="-44346.29" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2071" y="-44335.29" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_13_route&#45;&gt;moe_13_expert_8 -->
<g id="edge367" class="edge">
<title>moe_13_route&#45;&gt;moe_13_expert_8</title>
<path fill="none" stroke="black" d="M1995.93,-44416.85C2007.93,-44407.02 2020.88,-44396.4 2032.59,-44386.79"/>
<polygon fill="black" stroke="black" points="2034.96,-44389.37 2040.48,-44380.32 2030.53,-44383.96 2034.96,-44389.37"/>
</g>
<!-- moe_13_expert_9 -->
<g id="node233" class="node">
<title>moe_13_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2416,-44380.29 2198,-44380.29 2198,-44328.29 2416,-44328.29 2416,-44380.29"/>
<text text-anchor="middle" x="2307" y="-44368.29" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2307" y="-44357.29" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2307" y="-44346.29" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2307" y="-44335.29" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_13_route&#45;&gt;moe_13_expert_9 -->
<g id="edge368" class="edge">
<title>moe_13_route&#45;&gt;moe_13_expert_9</title>
<path fill="none" stroke="black" d="M2065.01,-44421.44C2110.02,-44409.14 2161.53,-44395.06 2205.44,-44383.06"/>
<polygon fill="black" stroke="black" points="2206.54,-44386.38 2215.26,-44380.37 2204.69,-44379.63 2206.54,-44386.38"/>
</g>
<!-- moe_13_expert_10 -->
<g id="node234" class="node">
<title>moe_13_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2652,-44380.29 2434,-44380.29 2434,-44328.29 2652,-44328.29 2652,-44380.29"/>
<text text-anchor="middle" x="2543" y="-44368.29" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2543" y="-44357.29" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2543" y="-44346.29" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2543" y="-44335.29" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_13_route&#45;&gt;moe_13_expert_10 -->
<g id="edge369" class="edge">
<title>moe_13_route&#45;&gt;moe_13_expert_10</title>
<path fill="none" stroke="black" d="M2119.13,-44429.2C2207.01,-44416.52 2316.89,-44399.75 2423.75,-44380.48"/>
<polygon fill="black" stroke="black" points="2424.54,-44383.9 2433.75,-44378.67 2423.29,-44377.01 2424.54,-44383.9"/>
</g>
<!-- moe_13_expert_11 -->
<g id="node235" class="node">
<title>moe_13_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2888,-44380.29 2670,-44380.29 2670,-44328.29 2888,-44328.29 2888,-44380.29"/>
<text text-anchor="middle" x="2779" y="-44368.29" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2779" y="-44357.29" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2779" y="-44346.29" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2779" y="-44335.29" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_13_route&#45;&gt;moe_13_expert_11 -->
<g id="edge370" class="edge">
<title>moe_13_route&#45;&gt;moe_13_expert_11</title>
<path fill="none" stroke="black" d="M2151.34,-44437.71C2291.04,-44426.23 2482.54,-44407.73 2659.75,-44380.42"/>
<polygon fill="black" stroke="black" points="2660.44,-44383.86 2669.79,-44378.86 2659.37,-44376.94 2660.44,-44383.86"/>
</g>
<!-- moe_13_expert_12 -->
<g id="node236" class="node">
<title>moe_13_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3124,-44380.29 2906,-44380.29 2906,-44328.29 3124,-44328.29 3124,-44380.29"/>
<text text-anchor="middle" x="3015" y="-44368.29" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3015" y="-44357.29" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3015" y="-44346.29" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3015" y="-44335.29" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_13_route&#45;&gt;moe_13_expert_12 -->
<g id="edge371" class="edge">
<title>moe_13_route&#45;&gt;moe_13_expert_12</title>
<path fill="none" stroke="black" d="M2164.3,-44444.04C2353.67,-44434.97 2639,-44416.66 2895.53,-44380.42"/>
<polygon fill="black" stroke="black" points="2896.39,-44383.84 2905.8,-44378.96 2895.41,-44376.91 2896.39,-44383.84"/>
</g>
<!-- moe_13_expert_13 -->
<g id="node237" class="node">
<title>moe_13_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3360,-44380.29 3142,-44380.29 3142,-44328.29 3360,-44328.29 3360,-44380.29"/>
<text text-anchor="middle" x="3251" y="-44368.29" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3251" y="-44357.29" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3251" y="-44346.29" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3251" y="-44335.29" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_13_route&#45;&gt;moe_13_expert_13 -->
<g id="edge372" class="edge">
<title>moe_13_route&#45;&gt;moe_13_expert_13</title>
<path fill="none" stroke="black" d="M2169.26,-44448.5C2404.3,-44442.41 2790.8,-44425.98 3131.74,-44380.38"/>
<polygon fill="black" stroke="black" points="3132.37,-44383.83 3141.81,-44379.02 3131.43,-44376.89 3132.37,-44383.83"/>
</g>
<!-- moe_13_expert_14 -->
<g id="node238" class="node">
<title>moe_13_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3596,-44380.29 3378,-44380.29 3378,-44328.29 3596,-44328.29 3596,-44380.29"/>
<text text-anchor="middle" x="3487" y="-44368.29" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3487" y="-44357.29" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3487" y="-44346.29" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3487" y="-44335.29" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_13_route&#45;&gt;moe_13_expert_14 -->
<g id="edge373" class="edge">
<title>moe_13_route&#45;&gt;moe_13_expert_14</title>
<path fill="none" stroke="black" d="M2170.77,-44451.68C2447.43,-44448.78 2939.44,-44435.52 3367.71,-44380.37"/>
<polygon fill="black" stroke="black" points="3368.35,-44383.82 3377.81,-44379.06 3367.45,-44376.88 3368.35,-44383.82"/>
</g>
<!-- moe_13_expert_15 -->
<g id="node239" class="node">
<title>moe_13_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3832,-44380.29 3614,-44380.29 3614,-44328.29 3832,-44328.29 3832,-44380.29"/>
<text text-anchor="middle" x="3723" y="-44368.29" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3723" y="-44357.29" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3723" y="-44346.29" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3723" y="-44335.29" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_13_route&#45;&gt;moe_13_expert_15 -->
<g id="edge374" class="edge">
<title>moe_13_route&#45;&gt;moe_13_expert_15</title>
<path fill="none" stroke="black" d="M2168.07,-44447.14C2545.89,-44437.77 3315.25,-44415.24 3603.76,-44380.34"/>
<polygon fill="black" stroke="black" points="3604.32,-44383.79 3613.82,-44379.09 3603.46,-44376.85 3604.32,-44383.79"/>
</g>
<!-- moe_13_aggregate -->
<g id="node240" class="node">
<title>moe_13_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-44255.52" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-44269.52" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1895" y="-44258.52" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-44247.52" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1895" y="-44236.52" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_13_expert_0&#45;&gt;moe_13_aggregate -->
<g id="edge375" class="edge">
<title>moe_13_expert_0&#45;&gt;moe_13_aggregate</title>
<path fill="none" stroke="black" d="M292.18,-44329.5C295.15,-44329.07 298.09,-44328.66 301,-44328.29 557.65,-44295.55 1288.45,-44272.38 1664.8,-44262.24"/>
<polygon fill="black" stroke="black" points="1665.1,-44265.74 1675,-44261.97 1664.91,-44258.74 1665.1,-44265.74"/>
</g>
<!-- moe_13_expert_1&#45;&gt;moe_13_aggregate -->
<g id="edge376" class="edge">
<title>moe_13_expert_1&#45;&gt;moe_13_aggregate</title>
<path fill="none" stroke="black" d="M528.19,-44329.53C531.15,-44329.09 534.09,-44328.68 537,-44328.29 929.3,-44276.69 1389.97,-44261.89 1661.36,-44257.83"/>
<polygon fill="black" stroke="black" points="1661.79,-44261.32 1671.73,-44257.68 1661.68,-44254.32 1661.79,-44261.32"/>
</g>
<!-- moe_13_expert_2&#45;&gt;moe_13_aggregate -->
<g id="edge377" class="edge">
<title>moe_13_expert_2&#45;&gt;moe_13_aggregate</title>
<path fill="none" stroke="black" d="M764.19,-44329.58C767.16,-44329.12 770.1,-44328.69 773,-44328.29 1079.54,-44286.24 1436.66,-44268.75 1664.18,-44261.53"/>
<polygon fill="black" stroke="black" points="1664.35,-44265.02 1674.24,-44261.21 1664.13,-44258.03 1664.35,-44265.02"/>
</g>
<!-- moe_13_expert_3&#45;&gt;moe_13_aggregate -->
<g id="edge378" class="edge">
<title>moe_13_expert_3&#45;&gt;moe_13_aggregate</title>
<path fill="none" stroke="black" d="M1000.2,-44329.64C1003.16,-44329.17 1006.1,-44328.72 1009,-44328.29 1233.06,-44295.62 1491.33,-44276.82 1671,-44266.73"/>
<polygon fill="black" stroke="black" points="1671.31,-44270.22 1681.1,-44266.17 1670.92,-44263.23 1671.31,-44270.22"/>
</g>
<!-- moe_13_expert_4&#45;&gt;moe_13_aggregate -->
<g id="edge379" class="edge">
<title>moe_13_expert_4&#45;&gt;moe_13_aggregate</title>
<path fill="none" stroke="black" d="M1236.22,-44329.76C1239.17,-44329.25 1242.11,-44328.76 1245,-44328.29 1392.47,-44304.59 1560.04,-44286.29 1688.1,-44274.11"/>
<polygon fill="black" stroke="black" points="1688.79,-44277.56 1698.41,-44273.13 1688.13,-44270.59 1688.79,-44277.56"/>
</g>
<!-- moe_13_expert_5&#45;&gt;moe_13_aggregate -->
<g id="edge380" class="edge">
<title>moe_13_expert_5&#45;&gt;moe_13_aggregate</title>
<path fill="none" stroke="black" d="M1472.26,-44330C1475.2,-44329.42 1478.12,-44328.85 1481,-44328.29 1562.75,-44312.55 1653.89,-44296.58 1729.8,-44283.72"/>
<polygon fill="black" stroke="black" points="1730.66,-44287.12 1739.93,-44282 1729.49,-44280.22 1730.66,-44287.12"/>
</g>
<!-- moe_13_expert_6&#45;&gt;moe_13_aggregate -->
<g id="edge381" class="edge">
<title>moe_13_expert_6&#45;&gt;moe_13_aggregate</title>
<path fill="none" stroke="black" d="M1675.61,-44328.25C1709.58,-44317.14 1750.14,-44303.88 1787.09,-44291.8"/>
<polygon fill="black" stroke="black" points="1788.49,-44295.03 1796.91,-44288.59 1786.31,-44288.37 1788.49,-44295.03"/>
</g>
<!-- moe_13_expert_7&#45;&gt;moe_13_aggregate -->
<g id="edge382" class="edge">
<title>moe_13_expert_7&#45;&gt;moe_13_aggregate</title>
<path fill="none" stroke="black" d="M1850.61,-44328.12C1855.82,-44319.72 1861.79,-44310.09 1867.62,-44300.68"/>
<polygon fill="black" stroke="black" points="1870.63,-44302.48 1872.92,-44292.13 1864.68,-44298.79 1870.63,-44302.48"/>
</g>
<!-- moe_13_expert_8&#45;&gt;moe_13_aggregate -->
<g id="edge383" class="edge">
<title>moe_13_expert_8&#45;&gt;moe_13_aggregate</title>
<path fill="none" stroke="black" d="M2025.22,-44328.12C2007.29,-44318.26 1986.29,-44306.72 1966.46,-44295.82"/>
<polygon fill="black" stroke="black" points="1967.9,-44292.61 1957.45,-44290.86 1964.52,-44298.74 1967.9,-44292.61"/>
</g>
<!-- moe_13_expert_9&#45;&gt;moe_13_aggregate -->
<g id="edge384" class="edge">
<title>moe_13_expert_9&#45;&gt;moe_13_aggregate</title>
<path fill="none" stroke="black" d="M2200.36,-44328.25C2148.52,-44316.07 2085.63,-44301.3 2030.44,-44288.33"/>
<polygon fill="black" stroke="black" points="2031.12,-44284.9 2020.58,-44286.02 2029.52,-44291.71 2031.12,-44284.9"/>
</g>
<!-- moe_13_expert_10&#45;&gt;moe_13_aggregate -->
<g id="edge385" class="edge">
<title>moe_13_expert_10&#45;&gt;moe_13_aggregate</title>
<path fill="none" stroke="black" d="M2433.76,-44329.85C2430.81,-44329.31 2427.89,-44328.79 2425,-44328.29 2312.55,-44308.8 2185.91,-44291.48 2084.63,-44278.74"/>
<polygon fill="black" stroke="black" points="2084.95,-44275.25 2074.6,-44277.48 2084.08,-44282.2 2084.95,-44275.25"/>
</g>
<!-- moe_13_expert_11&#45;&gt;moe_13_aggregate -->
<g id="edge386" class="edge">
<title>moe_13_expert_11&#45;&gt;moe_13_aggregate</title>
<path fill="none" stroke="black" d="M2669.79,-44329.69C2666.83,-44329.2 2663.9,-44328.73 2661,-44328.29 2476.88,-44300.26 2266.07,-44281.47 2112.28,-44270.18"/>
<polygon fill="black" stroke="black" points="2112.46,-44266.68 2102.24,-44269.44 2111.95,-44273.66 2112.46,-44266.68"/>
</g>
<!-- moe_13_expert_12&#45;&gt;moe_13_aggregate -->
<g id="edge387" class="edge">
<title>moe_13_expert_12&#45;&gt;moe_13_aggregate</title>
<path fill="none" stroke="black" d="M2905.8,-44329.61C2902.84,-44329.14 2899.9,-44328.7 2897,-44328.29 2633.13,-44291.07 2327.29,-44272.71 2123.59,-44263.96"/>
<polygon fill="black" stroke="black" points="2123.5,-44260.46 2113.36,-44263.53 2123.2,-44267.45 2123.5,-44260.46"/>
</g>
<!-- moe_13_expert_13&#45;&gt;moe_13_aggregate -->
<g id="edge388" class="edge">
<title>moe_13_expert_13&#45;&gt;moe_13_aggregate</title>
<path fill="none" stroke="black" d="M3141.81,-44329.55C3138.85,-44329.1 3135.91,-44328.68 3133,-44328.29 2784.68,-44281.57 2377.21,-44265.25 2127.65,-44259.56"/>
<polygon fill="black" stroke="black" points="2127.44,-44256.06 2117.36,-44259.33 2127.28,-44263.05 2127.44,-44256.06"/>
</g>
<!-- moe_13_expert_14&#45;&gt;moe_13_aggregate -->
<g id="edge389" class="edge">
<title>moe_13_expert_14&#45;&gt;moe_13_aggregate</title>
<path fill="none" stroke="black" d="M3377.81,-44329.52C3374.85,-44329.08 3371.91,-44328.67 3369,-44328.29 2933.48,-44271.92 2420.38,-44258.86 2128.82,-44256.39"/>
<polygon fill="black" stroke="black" points="2128.57,-44252.89 2118.54,-44256.31 2128.51,-44259.89 2128.57,-44252.89"/>
</g>
<!-- moe_13_expert_15&#45;&gt;moe_13_aggregate -->
<g id="edge390" class="edge">
<title>moe_13_expert_15&#45;&gt;moe_13_aggregate</title>
<path fill="none" stroke="black" d="M3613.82,-44329.49C3610.85,-44329.06 3607.91,-44328.66 3605,-44328.29 3326.05,-44293.14 2525.06,-44270.74 2126.29,-44261.45"/>
<polygon fill="black" stroke="black" points="2126.14,-44257.94 2116.07,-44261.21 2125.98,-44264.94 2126.14,-44257.94"/>
</g>
<!-- moe_13_ffn -->
<g id="node241" class="node">
<title>moe_13_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2053,-44182.75 1737,-44182.75 1737,-44130.75 2053,-44130.75 2053,-44182.75"/>
<text text-anchor="middle" x="1895" y="-44170.75" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1895" y="-44159.75" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-44148.75" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-44137.75" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_13_aggregate&#45;&gt;moe_13_ffn -->
<g id="edge391" class="edge">
<title>moe_13_aggregate&#45;&gt;moe_13_ffn</title>
<path fill="none" stroke="black" d="M1895,-44218.49C1895,-44210.18 1895,-44201.34 1895,-44193.06"/>
<polygon fill="black" stroke="black" points="1898.5,-44192.95 1895,-44182.95 1891.5,-44192.95 1898.5,-44192.95"/>
</g>
<!-- moe_13_res2 -->
<g id="node243" class="node">
<title>moe_13_res2</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-44094.75 1695.97,-44094.75 1558.11,-43990.75 2094.03,-43990.75 2231.89,-44094.75"/>
<text text-anchor="middle" x="1895" y="-44056.75" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1895" y="-44045.75" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-44034.75" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-44023.75" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_13_ffn&#45;&gt;moe_13_res2 -->
<g id="edge392" class="edge">
<title>moe_13_ffn&#45;&gt;moe_13_res2</title>
<path fill="none" stroke="black" d="M1895,-44130.62C1895,-44122.93 1895,-44114.12 1895,-44105.12"/>
<polygon fill="black" stroke="black" points="1898.5,-44104.93 1895,-44094.93 1891.5,-44104.93 1898.5,-44104.93"/>
</g>
<!-- moe_13_res1&#45;&gt;moe_13_gate -->
<g id="edge357" class="edge">
<title>moe_13_res1&#45;&gt;moe_13_gate</title>
<path fill="none" stroke="black" d="M1953,-44665.45C1953,-44657.27 1953,-44648.75 1953,-44640.37"/>
<polygon fill="black" stroke="black" points="1956.5,-44640.26 1953,-44630.26 1949.5,-44640.26 1956.5,-44640.26"/>
</g>
<!-- moe_14_mha -->
<g id="node244" class="node">
<title>moe_14_mha</title>
<polygon fill="lightgreen" stroke="black" points="2053,-43943.75 1737,-43943.75 1737,-43891.75 2053,-43891.75 2053,-43943.75"/>
<text text-anchor="middle" x="1895" y="-43931.75" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1895" y="-43920.75" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-43909.75" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-43898.75" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_13_res2&#45;&gt;moe_14_mha -->
<g id="edge393" class="edge">
<title>moe_13_res2&#45;&gt;moe_14_mha</title>
<path fill="none" stroke="black" d="M1895,-43990.66C1895,-43978.33 1895,-43965.42 1895,-43954.01"/>
<polygon fill="black" stroke="black" points="1898.5,-43954 1895,-43944 1891.5,-43954 1898.5,-43954"/>
</g>
<!-- moe_14_res1 -->
<g id="node265" class="node">
<title>moe_14_res1</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-43855.75 1695.97,-43855.75 1558.11,-43751.75 2094.03,-43751.75 2231.89,-43855.75"/>
<text text-anchor="middle" x="1895" y="-43817.75" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1895" y="-43806.75" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-43795.75" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-43784.75" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_14_mha&#45;&gt;moe_14_res1 -->
<g id="edge394" class="edge">
<title>moe_14_mha&#45;&gt;moe_14_res1</title>
<path fill="none" stroke="black" d="M1895,-43891.62C1895,-43883.93 1895,-43875.12 1895,-43866.12"/>
<polygon fill="black" stroke="black" points="1898.5,-43865.93 1895,-43855.93 1891.5,-43865.93 1898.5,-43865.93"/>
</g>
<!-- moe_14_gate -->
<g id="node245" class="node">
<title>moe_14_gate</title>
<polygon fill="lightyellow" stroke="black" points="2223.8,-43715.75 1700.75,-43715.75 1566.2,-43611.75 2089.25,-43611.75 2223.8,-43715.75"/>
<text text-anchor="middle" x="1895" y="-43677.75" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1895" y="-43666.75" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-43655.75" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-43644.75" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_14_route -->
<g id="node246" class="node">
<title>moe_14_route</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-43538.98" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-43552.98" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1895" y="-43541.98" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-43530.98" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-43519.98" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_14_gate&#45;&gt;moe_14_route -->
<g id="edge396" class="edge">
<title>moe_14_gate&#45;&gt;moe_14_route</title>
<path fill="none" stroke="black" d="M1895,-43611.4C1895,-43602.99 1895,-43594.33 1895,-43586.05"/>
<polygon fill="black" stroke="black" points="1898.5,-43585.84 1895,-43575.84 1891.5,-43585.84 1898.5,-43585.84"/>
</g>
<!-- moe_14_expert_0 -->
<g id="node247" class="node">
<title>moe_14_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-43466.21 16,-43466.21 16,-43414.21 234,-43414.21 234,-43466.21"/>
<text text-anchor="middle" x="125" y="-43454.21" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-43443.21" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-43432.21" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-43421.21" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_14_route&#45;&gt;moe_14_expert_0 -->
<g id="edge397" class="edge">
<title>moe_14_route&#45;&gt;moe_14_expert_0</title>
<path fill="none" stroke="black" d="M1679.93,-43533.07C1302.11,-43523.7 532.75,-43501.16 244.24,-43466.26"/>
<polygon fill="black" stroke="black" points="244.54,-43462.77 234.18,-43465.01 243.68,-43469.71 244.54,-43462.77"/>
</g>
<!-- moe_14_expert_1 -->
<g id="node248" class="node">
<title>moe_14_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-43466.21 252,-43466.21 252,-43414.21 470,-43414.21 470,-43466.21"/>
<text text-anchor="middle" x="361" y="-43454.21" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-43443.21" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-43432.21" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-43421.21" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_14_route&#45;&gt;moe_14_expert_1 -->
<g id="edge398" class="edge">
<title>moe_14_route&#45;&gt;moe_14_expert_1</title>
<path fill="none" stroke="black" d="M1677.23,-43537.6C1400.57,-43534.7 908.56,-43521.45 480.29,-43466.29"/>
<polygon fill="black" stroke="black" points="480.55,-43462.8 470.19,-43464.98 479.65,-43469.74 480.55,-43462.8"/>
</g>
<!-- moe_14_expert_2 -->
<g id="node249" class="node">
<title>moe_14_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-43466.21 488,-43466.21 488,-43414.21 706,-43414.21 706,-43466.21"/>
<text text-anchor="middle" x="597" y="-43454.21" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-43443.21" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-43432.21" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-43421.21" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_14_route&#45;&gt;moe_14_expert_2 -->
<g id="edge399" class="edge">
<title>moe_14_route&#45;&gt;moe_14_expert_2</title>
<path fill="none" stroke="black" d="M1678.74,-43534.42C1443.7,-43528.33 1057.2,-43511.9 716.26,-43466.3"/>
<polygon fill="black" stroke="black" points="716.57,-43462.81 706.19,-43464.94 715.63,-43469.75 716.57,-43462.81"/>
</g>
<!-- moe_14_expert_3 -->
<g id="node250" class="node">
<title>moe_14_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-43466.21 724,-43466.21 724,-43414.21 942,-43414.21 942,-43466.21"/>
<text text-anchor="middle" x="833" y="-43454.21" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-43443.21" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-43432.21" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-43421.21" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_14_route&#45;&gt;moe_14_expert_3 -->
<g id="edge400" class="edge">
<title>moe_14_route&#45;&gt;moe_14_expert_3</title>
<path fill="none" stroke="black" d="M1683.7,-43529.96C1494.33,-43520.89 1209,-43502.58 952.47,-43466.35"/>
<polygon fill="black" stroke="black" points="952.59,-43462.83 942.2,-43464.88 951.61,-43469.76 952.59,-43462.83"/>
</g>
<!-- moe_14_expert_4 -->
<g id="node251" class="node">
<title>moe_14_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-43466.21 960,-43466.21 960,-43414.21 1178,-43414.21 1178,-43466.21"/>
<text text-anchor="middle" x="1069" y="-43454.21" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-43443.21" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-43432.21" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-43421.21" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_14_route&#45;&gt;moe_14_expert_4 -->
<g id="edge401" class="edge">
<title>moe_14_route&#45;&gt;moe_14_expert_4</title>
<path fill="none" stroke="black" d="M1696.66,-43523.63C1556.96,-43512.15 1365.46,-43493.65 1188.25,-43466.34"/>
<polygon fill="black" stroke="black" points="1188.63,-43462.86 1178.21,-43464.79 1187.56,-43469.78 1188.63,-43462.86"/>
</g>
<!-- moe_14_expert_5 -->
<g id="node252" class="node">
<title>moe_14_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-43466.21 1196,-43466.21 1196,-43414.21 1414,-43414.21 1414,-43466.21"/>
<text text-anchor="middle" x="1305" y="-43454.21" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-43443.21" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-43432.21" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-43421.21" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_14_route&#45;&gt;moe_14_expert_5 -->
<g id="edge402" class="edge">
<title>moe_14_route&#45;&gt;moe_14_expert_5</title>
<path fill="none" stroke="black" d="M1728.87,-43515.12C1640.99,-43502.44 1531.11,-43485.67 1424.25,-43466.4"/>
<polygon fill="black" stroke="black" points="1424.71,-43462.93 1414.25,-43464.59 1423.46,-43469.82 1424.71,-43462.93"/>
</g>
<!-- moe_14_expert_6 -->
<g id="node253" class="node">
<title>moe_14_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-43466.21 1432,-43466.21 1432,-43414.21 1650,-43414.21 1650,-43466.21"/>
<text text-anchor="middle" x="1541" y="-43454.21" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-43443.21" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-43432.21" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-43421.21" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_14_route&#45;&gt;moe_14_expert_6 -->
<g id="edge403" class="edge">
<title>moe_14_route&#45;&gt;moe_14_expert_6</title>
<path fill="none" stroke="black" d="M1782.99,-43507.37C1737.98,-43495.06 1686.47,-43480.98 1642.56,-43468.98"/>
<polygon fill="black" stroke="black" points="1643.31,-43465.55 1632.74,-43466.29 1641.46,-43472.31 1643.31,-43465.55"/>
</g>
<!-- moe_14_expert_7 -->
<g id="node254" class="node">
<title>moe_14_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-43466.21 1668,-43466.21 1668,-43414.21 1886,-43414.21 1886,-43466.21"/>
<text text-anchor="middle" x="1777" y="-43454.21" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-43443.21" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-43432.21" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-43421.21" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_14_route&#45;&gt;moe_14_expert_7 -->
<g id="edge404" class="edge">
<title>moe_14_route&#45;&gt;moe_14_expert_7</title>
<path fill="none" stroke="black" d="M1852.07,-43502.77C1840.07,-43492.94 1827.12,-43482.32 1815.41,-43472.71"/>
<polygon fill="black" stroke="black" points="1817.47,-43469.88 1807.52,-43466.25 1813.04,-43475.29 1817.47,-43469.88"/>
</g>
<!-- moe_14_expert_8 -->
<g id="node255" class="node">
<title>moe_14_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-43466.21 1904,-43466.21 1904,-43414.21 2122,-43414.21 2122,-43466.21"/>
<text text-anchor="middle" x="2013" y="-43454.21" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-43443.21" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-43432.21" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-43421.21" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_14_route&#45;&gt;moe_14_expert_8 -->
<g id="edge405" class="edge">
<title>moe_14_route&#45;&gt;moe_14_expert_8</title>
<path fill="none" stroke="black" d="M1937.93,-43502.77C1949.93,-43492.94 1962.88,-43482.32 1974.59,-43472.71"/>
<polygon fill="black" stroke="black" points="1976.96,-43475.29 1982.48,-43466.25 1972.53,-43469.88 1976.96,-43475.29"/>
</g>
<!-- moe_14_expert_9 -->
<g id="node256" class="node">
<title>moe_14_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-43466.21 2140,-43466.21 2140,-43414.21 2358,-43414.21 2358,-43466.21"/>
<text text-anchor="middle" x="2249" y="-43454.21" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-43443.21" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-43432.21" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-43421.21" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_14_route&#45;&gt;moe_14_expert_9 -->
<g id="edge406" class="edge">
<title>moe_14_route&#45;&gt;moe_14_expert_9</title>
<path fill="none" stroke="black" d="M2007.01,-43507.37C2052.02,-43495.06 2103.53,-43480.98 2147.44,-43468.98"/>
<polygon fill="black" stroke="black" points="2148.54,-43472.31 2157.26,-43466.29 2146.69,-43465.55 2148.54,-43472.31"/>
</g>
<!-- moe_14_expert_10 -->
<g id="node257" class="node">
<title>moe_14_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-43466.21 2376,-43466.21 2376,-43414.21 2594,-43414.21 2594,-43466.21"/>
<text text-anchor="middle" x="2485" y="-43454.21" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-43443.21" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-43432.21" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-43421.21" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_14_route&#45;&gt;moe_14_expert_10 -->
<g id="edge407" class="edge">
<title>moe_14_route&#45;&gt;moe_14_expert_10</title>
<path fill="none" stroke="black" d="M2061.13,-43515.12C2149.01,-43502.44 2258.89,-43485.67 2365.75,-43466.4"/>
<polygon fill="black" stroke="black" points="2366.54,-43469.82 2375.75,-43464.59 2365.29,-43462.93 2366.54,-43469.82"/>
</g>
<!-- moe_14_expert_11 -->
<g id="node258" class="node">
<title>moe_14_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-43466.21 2612,-43466.21 2612,-43414.21 2830,-43414.21 2830,-43466.21"/>
<text text-anchor="middle" x="2721" y="-43454.21" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-43443.21" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-43432.21" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-43421.21" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_14_route&#45;&gt;moe_14_expert_11 -->
<g id="edge408" class="edge">
<title>moe_14_route&#45;&gt;moe_14_expert_11</title>
<path fill="none" stroke="black" d="M2093.34,-43523.63C2233.04,-43512.15 2424.54,-43493.65 2601.75,-43466.34"/>
<polygon fill="black" stroke="black" points="2602.44,-43469.78 2611.79,-43464.79 2601.37,-43462.86 2602.44,-43469.78"/>
</g>
<!-- moe_14_expert_12 -->
<g id="node259" class="node">
<title>moe_14_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-43466.21 2848,-43466.21 2848,-43414.21 3066,-43414.21 3066,-43466.21"/>
<text text-anchor="middle" x="2957" y="-43454.21" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-43443.21" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-43432.21" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-43421.21" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_14_route&#45;&gt;moe_14_expert_12 -->
<g id="edge409" class="edge">
<title>moe_14_route&#45;&gt;moe_14_expert_12</title>
<path fill="none" stroke="black" d="M2106.3,-43529.96C2295.67,-43520.89 2581,-43502.58 2837.53,-43466.35"/>
<polygon fill="black" stroke="black" points="2838.39,-43469.76 2847.8,-43464.88 2837.41,-43462.83 2838.39,-43469.76"/>
</g>
<!-- moe_14_expert_13 -->
<g id="node260" class="node">
<title>moe_14_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-43466.21 3084,-43466.21 3084,-43414.21 3302,-43414.21 3302,-43466.21"/>
<text text-anchor="middle" x="3193" y="-43454.21" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-43443.21" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-43432.21" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-43421.21" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_14_route&#45;&gt;moe_14_expert_13 -->
<g id="edge410" class="edge">
<title>moe_14_route&#45;&gt;moe_14_expert_13</title>
<path fill="none" stroke="black" d="M2111.26,-43534.42C2346.3,-43528.33 2732.8,-43511.9 3073.74,-43466.3"/>
<polygon fill="black" stroke="black" points="3074.37,-43469.75 3083.81,-43464.94 3073.43,-43462.81 3074.37,-43469.75"/>
</g>
<!-- moe_14_expert_14 -->
<g id="node261" class="node">
<title>moe_14_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-43466.21 3320,-43466.21 3320,-43414.21 3538,-43414.21 3538,-43466.21"/>
<text text-anchor="middle" x="3429" y="-43454.21" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-43443.21" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-43432.21" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-43421.21" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_14_route&#45;&gt;moe_14_expert_14 -->
<g id="edge411" class="edge">
<title>moe_14_route&#45;&gt;moe_14_expert_14</title>
<path fill="none" stroke="black" d="M2112.77,-43537.6C2389.43,-43534.7 2881.44,-43521.45 3309.71,-43466.29"/>
<polygon fill="black" stroke="black" points="3310.35,-43469.74 3319.81,-43464.98 3309.45,-43462.8 3310.35,-43469.74"/>
</g>
<!-- moe_14_expert_15 -->
<g id="node262" class="node">
<title>moe_14_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-43466.21 3556,-43466.21 3556,-43414.21 3774,-43414.21 3774,-43466.21"/>
<text text-anchor="middle" x="3665" y="-43454.21" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-43443.21" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-43432.21" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-43421.21" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_14_route&#45;&gt;moe_14_expert_15 -->
<g id="edge412" class="edge">
<title>moe_14_route&#45;&gt;moe_14_expert_15</title>
<path fill="none" stroke="black" d="M2110.07,-43533.07C2487.89,-43523.7 3257.25,-43501.16 3545.76,-43466.26"/>
<polygon fill="black" stroke="black" points="3546.32,-43469.71 3555.82,-43465.01 3545.46,-43462.77 3546.32,-43469.71"/>
</g>
<!-- moe_14_aggregate -->
<g id="node263" class="node">
<title>moe_14_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-43341.45" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-43355.45" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1895" y="-43344.45" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-43333.45" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1895" y="-43322.45" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_14_expert_0&#45;&gt;moe_14_aggregate -->
<g id="edge413" class="edge">
<title>moe_14_expert_0&#45;&gt;moe_14_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-43415.42C237.15,-43414.99 240.09,-43414.58 243,-43414.21 510.74,-43380.27 1276.32,-43357.48 1664.04,-43347.76"/>
<polygon fill="black" stroke="black" points="1664.35,-43351.25 1674.26,-43347.5 1664.17,-43344.26 1664.35,-43351.25"/>
</g>
<!-- moe_14_expert_1&#45;&gt;moe_14_aggregate -->
<g id="edge414" class="edge">
<title>moe_14_expert_1&#45;&gt;moe_14_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-43415.45C473.15,-43415.01 476.09,-43414.59 479,-43414.21 892.79,-43360.24 1379.51,-43346.28 1661.11,-43343"/>
<polygon fill="black" stroke="black" points="1661.49,-43346.5 1671.45,-43342.89 1661.41,-43339.5 1661.49,-43346.5"/>
</g>
<!-- moe_14_expert_2&#45;&gt;moe_14_aggregate -->
<g id="edge415" class="edge">
<title>moe_14_expert_2&#45;&gt;moe_14_aggregate</title>
<path fill="none" stroke="black" d="M706.19,-43415.49C709.15,-43415.03 712.09,-43414.61 715,-43414.21 1042.31,-43369.84 1424.45,-43352.89 1663.11,-43346.43"/>
<polygon fill="black" stroke="black" points="1663.4,-43349.92 1673.31,-43346.15 1663.22,-43342.92 1663.4,-43349.92"/>
</g>
<!-- moe_14_expert_3&#45;&gt;moe_14_aggregate -->
<g id="edge416" class="edge">
<title>moe_14_expert_3&#45;&gt;moe_14_aggregate</title>
<path fill="none" stroke="black" d="M942.2,-43415.55C945.16,-43415.08 948.1,-43414.63 951,-43414.21 1194.76,-43379.29 1476.52,-43360.66 1668.32,-43351.22"/>
<polygon fill="black" stroke="black" points="1668.71,-43354.7 1678.53,-43350.72 1668.37,-43347.71 1668.71,-43354.7"/>
</g>
<!-- moe_14_expert_4&#45;&gt;moe_14_aggregate -->
<g id="edge417" class="edge">
<title>moe_14_expert_4&#45;&gt;moe_14_aggregate</title>
<path fill="none" stroke="black" d="M1178.21,-43415.64C1181.17,-43415.14 1184.1,-43414.67 1187,-43414.21 1352.7,-43388.34 1541.73,-43369.73 1682.77,-43357.95"/>
<polygon fill="black" stroke="black" points="1683.17,-43361.43 1692.84,-43357.11 1682.59,-43354.45 1683.17,-43361.43"/>
</g>
<!-- moe_14_expert_5&#45;&gt;moe_14_aggregate -->
<g id="edge418" class="edge">
<title>moe_14_expert_5&#45;&gt;moe_14_aggregate</title>
<path fill="none" stroke="black" d="M1414.25,-43415.84C1417.19,-43415.28 1420.12,-43414.74 1423,-43414.21 1519.58,-43396.66 1627.83,-43379.98 1716.27,-43367.13"/>
<polygon fill="black" stroke="black" points="1717.01,-43370.56 1726.4,-43365.67 1716,-43363.64 1717.01,-43370.56"/>
</g>
<!-- moe_14_expert_6&#45;&gt;moe_14_aggregate -->
<g id="edge419" class="edge">
<title>moe_14_expert_6&#45;&gt;moe_14_aggregate</title>
<path fill="none" stroke="black" d="M1632.62,-43414.17C1675.27,-43402.51 1726.62,-43388.47 1772.54,-43375.92"/>
<polygon fill="black" stroke="black" points="1773.53,-43379.28 1782.25,-43373.27 1771.68,-43372.53 1773.53,-43379.28"/>
</g>
<!-- moe_14_expert_7&#45;&gt;moe_14_aggregate -->
<g id="edge420" class="edge">
<title>moe_14_expert_7&#45;&gt;moe_14_aggregate</title>
<path fill="none" stroke="black" d="M1807.7,-43414.04C1818.79,-43404.95 1831.63,-43394.42 1843.99,-43384.28"/>
<polygon fill="black" stroke="black" points="1846.51,-43386.74 1852.02,-43377.69 1842.07,-43381.33 1846.51,-43386.74"/>
</g>
<!-- moe_14_expert_8&#45;&gt;moe_14_aggregate -->
<g id="edge421" class="edge">
<title>moe_14_expert_8&#45;&gt;moe_14_aggregate</title>
<path fill="none" stroke="black" d="M1982.3,-43414.04C1971.21,-43404.95 1958.37,-43394.42 1946.01,-43384.28"/>
<polygon fill="black" stroke="black" points="1947.93,-43381.33 1937.98,-43377.69 1943.49,-43386.74 1947.93,-43381.33"/>
</g>
<!-- moe_14_expert_9&#45;&gt;moe_14_aggregate -->
<g id="edge422" class="edge">
<title>moe_14_expert_9&#45;&gt;moe_14_aggregate</title>
<path fill="none" stroke="black" d="M2157.38,-43414.17C2114.73,-43402.51 2063.38,-43388.47 2017.46,-43375.92"/>
<polygon fill="black" stroke="black" points="2018.32,-43372.53 2007.75,-43373.27 2016.47,-43379.28 2018.32,-43372.53"/>
</g>
<!-- moe_14_expert_10&#45;&gt;moe_14_aggregate -->
<g id="edge423" class="edge">
<title>moe_14_expert_10&#45;&gt;moe_14_aggregate</title>
<path fill="none" stroke="black" d="M2375.75,-43415.84C2372.81,-43415.28 2369.88,-43414.74 2367,-43414.21 2270.42,-43396.66 2162.17,-43379.98 2073.73,-43367.13"/>
<polygon fill="black" stroke="black" points="2074,-43363.64 2063.6,-43365.67 2072.99,-43370.56 2074,-43363.64"/>
</g>
<!-- moe_14_expert_11&#45;&gt;moe_14_aggregate -->
<g id="edge424" class="edge">
<title>moe_14_expert_11&#45;&gt;moe_14_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-43415.64C2608.83,-43415.14 2605.9,-43414.67 2603,-43414.21 2437.3,-43388.34 2248.27,-43369.73 2107.23,-43357.95"/>
<polygon fill="black" stroke="black" points="2107.41,-43354.45 2097.16,-43357.11 2106.83,-43361.43 2107.41,-43354.45"/>
</g>
<!-- moe_14_expert_12&#45;&gt;moe_14_aggregate -->
<g id="edge425" class="edge">
<title>moe_14_expert_12&#45;&gt;moe_14_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-43415.55C2844.84,-43415.08 2841.9,-43414.63 2839,-43414.21 2595.24,-43379.29 2313.48,-43360.66 2121.68,-43351.22"/>
<polygon fill="black" stroke="black" points="2121.63,-43347.71 2111.47,-43350.72 2121.29,-43354.7 2121.63,-43347.71"/>
</g>
<!-- moe_14_expert_13&#45;&gt;moe_14_aggregate -->
<g id="edge426" class="edge">
<title>moe_14_expert_13&#45;&gt;moe_14_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-43415.49C3080.85,-43415.03 3077.91,-43414.61 3075,-43414.21 2747.69,-43369.84 2365.55,-43352.89 2126.89,-43346.43"/>
<polygon fill="black" stroke="black" points="2126.78,-43342.92 2116.69,-43346.15 2126.6,-43349.92 2126.78,-43342.92"/>
</g>
<!-- moe_14_expert_14&#45;&gt;moe_14_aggregate -->
<g id="edge427" class="edge">
<title>moe_14_expert_14&#45;&gt;moe_14_aggregate</title>
<path fill="none" stroke="black" d="M3319.81,-43415.45C3316.85,-43415.01 3313.91,-43414.59 3311,-43414.21 2897.21,-43360.24 2410.49,-43346.28 2128.89,-43343"/>
<polygon fill="black" stroke="black" points="2128.59,-43339.5 2118.55,-43342.89 2128.51,-43346.5 2128.59,-43339.5"/>
</g>
<!-- moe_14_expert_15&#45;&gt;moe_14_aggregate -->
<g id="edge428" class="edge">
<title>moe_14_expert_15&#45;&gt;moe_14_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-43415.42C3552.85,-43414.99 3549.91,-43414.58 3547,-43414.21 3279.26,-43380.27 2513.68,-43357.48 2125.96,-43347.76"/>
<polygon fill="black" stroke="black" points="2125.83,-43344.26 2115.74,-43347.5 2125.65,-43351.25 2125.83,-43344.26"/>
</g>
<!-- moe_14_ffn -->
<g id="node264" class="node">
<title>moe_14_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2053,-43268.68 1737,-43268.68 1737,-43216.68 2053,-43216.68 2053,-43268.68"/>
<text text-anchor="middle" x="1895" y="-43256.68" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1895" y="-43245.68" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-43234.68" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-43223.68" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_14_aggregate&#45;&gt;moe_14_ffn -->
<g id="edge429" class="edge">
<title>moe_14_aggregate&#45;&gt;moe_14_ffn</title>
<path fill="none" stroke="black" d="M1895,-43304.41C1895,-43296.1 1895,-43287.27 1895,-43278.99"/>
<polygon fill="black" stroke="black" points="1898.5,-43278.87 1895,-43268.87 1891.5,-43278.87 1898.5,-43278.87"/>
</g>
<!-- moe_14_res2 -->
<g id="node266" class="node">
<title>moe_14_res2</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-43180.68 1695.97,-43180.68 1558.11,-43076.68 2094.03,-43076.68 2231.89,-43180.68"/>
<text text-anchor="middle" x="1895" y="-43142.68" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1895" y="-43131.68" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-43120.68" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-43109.68" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_14_ffn&#45;&gt;moe_14_res2 -->
<g id="edge430" class="edge">
<title>moe_14_ffn&#45;&gt;moe_14_res2</title>
<path fill="none" stroke="black" d="M1895,-43216.54C1895,-43208.86 1895,-43200.04 1895,-43191.04"/>
<polygon fill="black" stroke="black" points="1898.5,-43190.85 1895,-43180.85 1891.5,-43190.85 1898.5,-43190.85"/>
</g>
<!-- moe_14_res1&#45;&gt;moe_14_gate -->
<g id="edge395" class="edge">
<title>moe_14_res1&#45;&gt;moe_14_gate</title>
<path fill="none" stroke="black" d="M1895,-43751.37C1895,-43743.2 1895,-43734.67 1895,-43726.29"/>
<polygon fill="black" stroke="black" points="1898.5,-43726.18 1895,-43716.18 1891.5,-43726.18 1898.5,-43726.18"/>
</g>
<!-- moe_15_mha -->
<g id="node267" class="node">
<title>moe_15_mha</title>
<polygon fill="lightgreen" stroke="black" points="2053,-43029.68 1737,-43029.68 1737,-42977.68 2053,-42977.68 2053,-43029.68"/>
<text text-anchor="middle" x="1895" y="-43017.68" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1895" y="-43006.68" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-42995.68" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-42984.68" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_14_res2&#45;&gt;moe_15_mha -->
<g id="edge431" class="edge">
<title>moe_14_res2&#45;&gt;moe_15_mha</title>
<path fill="none" stroke="black" d="M1895,-43076.58C1895,-43064.25 1895,-43051.35 1895,-43039.93"/>
<polygon fill="black" stroke="black" points="1898.5,-43039.92 1895,-43029.92 1891.5,-43039.92 1898.5,-43039.92"/>
</g>
<!-- moe_15_res1 -->
<g id="node288" class="node">
<title>moe_15_res1</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-42941.68 1695.97,-42941.68 1558.11,-42837.68 2094.03,-42837.68 2231.89,-42941.68"/>
<text text-anchor="middle" x="1895" y="-42903.68" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1895" y="-42892.68" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-42881.68" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-42870.68" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_15_mha&#45;&gt;moe_15_res1 -->
<g id="edge432" class="edge">
<title>moe_15_mha&#45;&gt;moe_15_res1</title>
<path fill="none" stroke="black" d="M1895,-42977.54C1895,-42969.86 1895,-42961.04 1895,-42952.04"/>
<polygon fill="black" stroke="black" points="1898.5,-42951.85 1895,-42941.85 1891.5,-42951.85 1898.5,-42951.85"/>
</g>
<!-- moe_15_gate -->
<g id="node268" class="node">
<title>moe_15_gate</title>
<polygon fill="lightyellow" stroke="black" points="2223.8,-42801.68 1700.75,-42801.68 1566.2,-42697.68 2089.25,-42697.68 2223.8,-42801.68"/>
<text text-anchor="middle" x="1895" y="-42763.68" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1895" y="-42752.68" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-42741.68" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-42730.68" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_15_route -->
<g id="node269" class="node">
<title>moe_15_route</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-42624.91" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-42638.91" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1895" y="-42627.91" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-42616.91" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-42605.91" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_15_gate&#45;&gt;moe_15_route -->
<g id="edge434" class="edge">
<title>moe_15_gate&#45;&gt;moe_15_route</title>
<path fill="none" stroke="black" d="M1895,-42697.32C1895,-42688.91 1895,-42680.25 1895,-42671.98"/>
<polygon fill="black" stroke="black" points="1898.5,-42671.76 1895,-42661.76 1891.5,-42671.76 1898.5,-42671.76"/>
</g>
<!-- moe_15_expert_0 -->
<g id="node270" class="node">
<title>moe_15_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-42552.14 16,-42552.14 16,-42500.14 234,-42500.14 234,-42552.14"/>
<text text-anchor="middle" x="125" y="-42540.14" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-42529.14" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-42518.14" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-42507.14" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_15_route&#45;&gt;moe_15_expert_0 -->
<g id="edge435" class="edge">
<title>moe_15_route&#45;&gt;moe_15_expert_0</title>
<path fill="none" stroke="black" d="M1679.93,-42618.99C1302.11,-42609.62 532.75,-42587.08 244.24,-42552.18"/>
<polygon fill="black" stroke="black" points="244.54,-42548.69 234.18,-42550.93 243.68,-42555.64 244.54,-42548.69"/>
</g>
<!-- moe_15_expert_1 -->
<g id="node271" class="node">
<title>moe_15_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-42552.14 252,-42552.14 252,-42500.14 470,-42500.14 470,-42552.14"/>
<text text-anchor="middle" x="361" y="-42540.14" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-42529.14" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-42518.14" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-42507.14" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_15_route&#45;&gt;moe_15_expert_1 -->
<g id="edge436" class="edge">
<title>moe_15_route&#45;&gt;moe_15_expert_1</title>
<path fill="none" stroke="black" d="M1677.23,-42623.53C1400.57,-42620.62 908.56,-42607.37 480.29,-42552.21"/>
<polygon fill="black" stroke="black" points="480.55,-42548.72 470.19,-42550.9 479.65,-42555.66 480.55,-42548.72"/>
</g>
<!-- moe_15_expert_2 -->
<g id="node272" class="node">
<title>moe_15_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-42552.14 488,-42552.14 488,-42500.14 706,-42500.14 706,-42552.14"/>
<text text-anchor="middle" x="597" y="-42540.14" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-42529.14" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-42518.14" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-42507.14" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_15_route&#45;&gt;moe_15_expert_2 -->
<g id="edge437" class="edge">
<title>moe_15_route&#45;&gt;moe_15_expert_2</title>
<path fill="none" stroke="black" d="M1678.74,-42620.34C1443.7,-42614.26 1057.2,-42597.82 716.26,-42552.22"/>
<polygon fill="black" stroke="black" points="716.57,-42548.73 706.19,-42550.86 715.63,-42555.67 716.57,-42548.73"/>
</g>
<!-- moe_15_expert_3 -->
<g id="node273" class="node">
<title>moe_15_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-42552.14 724,-42552.14 724,-42500.14 942,-42500.14 942,-42552.14"/>
<text text-anchor="middle" x="833" y="-42540.14" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-42529.14" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-42518.14" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-42507.14" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_15_route&#45;&gt;moe_15_expert_3 -->
<g id="edge438" class="edge">
<title>moe_15_route&#45;&gt;moe_15_expert_3</title>
<path fill="none" stroke="black" d="M1683.7,-42615.88C1494.33,-42606.81 1209,-42588.5 952.47,-42552.27"/>
<polygon fill="black" stroke="black" points="952.59,-42548.75 942.2,-42550.81 951.61,-42555.68 952.59,-42548.75"/>
</g>
<!-- moe_15_expert_4 -->
<g id="node274" class="node">
<title>moe_15_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-42552.14 960,-42552.14 960,-42500.14 1178,-42500.14 1178,-42552.14"/>
<text text-anchor="middle" x="1069" y="-42540.14" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-42529.14" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-42518.14" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-42507.14" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_15_route&#45;&gt;moe_15_expert_4 -->
<g id="edge439" class="edge">
<title>moe_15_route&#45;&gt;moe_15_expert_4</title>
<path fill="none" stroke="black" d="M1696.66,-42609.55C1556.96,-42598.07 1365.46,-42579.57 1188.25,-42552.27"/>
<polygon fill="black" stroke="black" points="1188.63,-42548.78 1178.21,-42550.71 1187.56,-42555.7 1188.63,-42548.78"/>
</g>
<!-- moe_15_expert_5 -->
<g id="node275" class="node">
<title>moe_15_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-42552.14 1196,-42552.14 1196,-42500.14 1414,-42500.14 1414,-42552.14"/>
<text text-anchor="middle" x="1305" y="-42540.14" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-42529.14" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-42518.14" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-42507.14" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_15_route&#45;&gt;moe_15_expert_5 -->
<g id="edge440" class="edge">
<title>moe_15_route&#45;&gt;moe_15_expert_5</title>
<path fill="none" stroke="black" d="M1728.87,-42601.04C1640.99,-42588.36 1531.11,-42571.59 1424.25,-42552.33"/>
<polygon fill="black" stroke="black" points="1424.71,-42548.85 1414.25,-42550.51 1423.46,-42555.74 1424.71,-42548.85"/>
</g>
<!-- moe_15_expert_6 -->
<g id="node276" class="node">
<title>moe_15_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-42552.14 1432,-42552.14 1432,-42500.14 1650,-42500.14 1650,-42552.14"/>
<text text-anchor="middle" x="1541" y="-42540.14" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-42529.14" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-42518.14" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-42507.14" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_15_route&#45;&gt;moe_15_expert_6 -->
<g id="edge441" class="edge">
<title>moe_15_route&#45;&gt;moe_15_expert_6</title>
<path fill="none" stroke="black" d="M1782.99,-42593.29C1737.98,-42580.98 1686.47,-42566.9 1642.56,-42554.9"/>
<polygon fill="black" stroke="black" points="1643.31,-42551.48 1632.74,-42552.21 1641.46,-42558.23 1643.31,-42551.48"/>
</g>
<!-- moe_15_expert_7 -->
<g id="node277" class="node">
<title>moe_15_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-42552.14 1668,-42552.14 1668,-42500.14 1886,-42500.14 1886,-42552.14"/>
<text text-anchor="middle" x="1777" y="-42540.14" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-42529.14" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-42518.14" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-42507.14" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_15_route&#45;&gt;moe_15_expert_7 -->
<g id="edge442" class="edge">
<title>moe_15_route&#45;&gt;moe_15_expert_7</title>
<path fill="none" stroke="black" d="M1852.07,-42588.7C1840.07,-42578.86 1827.12,-42568.24 1815.41,-42558.63"/>
<polygon fill="black" stroke="black" points="1817.47,-42555.8 1807.52,-42552.17 1813.04,-42561.22 1817.47,-42555.8"/>
</g>
<!-- moe_15_expert_8 -->
<g id="node278" class="node">
<title>moe_15_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-42552.14 1904,-42552.14 1904,-42500.14 2122,-42500.14 2122,-42552.14"/>
<text text-anchor="middle" x="2013" y="-42540.14" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-42529.14" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-42518.14" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-42507.14" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_15_route&#45;&gt;moe_15_expert_8 -->
<g id="edge443" class="edge">
<title>moe_15_route&#45;&gt;moe_15_expert_8</title>
<path fill="none" stroke="black" d="M1937.93,-42588.7C1949.93,-42578.86 1962.88,-42568.24 1974.59,-42558.63"/>
<polygon fill="black" stroke="black" points="1976.96,-42561.22 1982.48,-42552.17 1972.53,-42555.8 1976.96,-42561.22"/>
</g>
<!-- moe_15_expert_9 -->
<g id="node279" class="node">
<title>moe_15_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-42552.14 2140,-42552.14 2140,-42500.14 2358,-42500.14 2358,-42552.14"/>
<text text-anchor="middle" x="2249" y="-42540.14" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-42529.14" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-42518.14" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-42507.14" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_15_route&#45;&gt;moe_15_expert_9 -->
<g id="edge444" class="edge">
<title>moe_15_route&#45;&gt;moe_15_expert_9</title>
<path fill="none" stroke="black" d="M2007.01,-42593.29C2052.02,-42580.98 2103.53,-42566.9 2147.44,-42554.9"/>
<polygon fill="black" stroke="black" points="2148.54,-42558.23 2157.26,-42552.21 2146.69,-42551.48 2148.54,-42558.23"/>
</g>
<!-- moe_15_expert_10 -->
<g id="node280" class="node">
<title>moe_15_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-42552.14 2376,-42552.14 2376,-42500.14 2594,-42500.14 2594,-42552.14"/>
<text text-anchor="middle" x="2485" y="-42540.14" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-42529.14" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-42518.14" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-42507.14" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_15_route&#45;&gt;moe_15_expert_10 -->
<g id="edge445" class="edge">
<title>moe_15_route&#45;&gt;moe_15_expert_10</title>
<path fill="none" stroke="black" d="M2061.13,-42601.04C2149.01,-42588.36 2258.89,-42571.59 2365.75,-42552.33"/>
<polygon fill="black" stroke="black" points="2366.54,-42555.74 2375.75,-42550.51 2365.29,-42548.85 2366.54,-42555.74"/>
</g>
<!-- moe_15_expert_11 -->
<g id="node281" class="node">
<title>moe_15_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-42552.14 2612,-42552.14 2612,-42500.14 2830,-42500.14 2830,-42552.14"/>
<text text-anchor="middle" x="2721" y="-42540.14" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-42529.14" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-42518.14" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-42507.14" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_15_route&#45;&gt;moe_15_expert_11 -->
<g id="edge446" class="edge">
<title>moe_15_route&#45;&gt;moe_15_expert_11</title>
<path fill="none" stroke="black" d="M2093.34,-42609.55C2233.04,-42598.07 2424.54,-42579.57 2601.75,-42552.27"/>
<polygon fill="black" stroke="black" points="2602.44,-42555.7 2611.79,-42550.71 2601.37,-42548.78 2602.44,-42555.7"/>
</g>
<!-- moe_15_expert_12 -->
<g id="node282" class="node">
<title>moe_15_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-42552.14 2848,-42552.14 2848,-42500.14 3066,-42500.14 3066,-42552.14"/>
<text text-anchor="middle" x="2957" y="-42540.14" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-42529.14" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-42518.14" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-42507.14" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_15_route&#45;&gt;moe_15_expert_12 -->
<g id="edge447" class="edge">
<title>moe_15_route&#45;&gt;moe_15_expert_12</title>
<path fill="none" stroke="black" d="M2106.3,-42615.88C2295.67,-42606.81 2581,-42588.5 2837.53,-42552.27"/>
<polygon fill="black" stroke="black" points="2838.39,-42555.68 2847.8,-42550.81 2837.41,-42548.75 2838.39,-42555.68"/>
</g>
<!-- moe_15_expert_13 -->
<g id="node283" class="node">
<title>moe_15_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-42552.14 3084,-42552.14 3084,-42500.14 3302,-42500.14 3302,-42552.14"/>
<text text-anchor="middle" x="3193" y="-42540.14" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-42529.14" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-42518.14" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-42507.14" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_15_route&#45;&gt;moe_15_expert_13 -->
<g id="edge448" class="edge">
<title>moe_15_route&#45;&gt;moe_15_expert_13</title>
<path fill="none" stroke="black" d="M2111.26,-42620.34C2346.3,-42614.26 2732.8,-42597.82 3073.74,-42552.22"/>
<polygon fill="black" stroke="black" points="3074.37,-42555.67 3083.81,-42550.86 3073.43,-42548.73 3074.37,-42555.67"/>
</g>
<!-- moe_15_expert_14 -->
<g id="node284" class="node">
<title>moe_15_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-42552.14 3320,-42552.14 3320,-42500.14 3538,-42500.14 3538,-42552.14"/>
<text text-anchor="middle" x="3429" y="-42540.14" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-42529.14" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-42518.14" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-42507.14" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_15_route&#45;&gt;moe_15_expert_14 -->
<g id="edge449" class="edge">
<title>moe_15_route&#45;&gt;moe_15_expert_14</title>
<path fill="none" stroke="black" d="M2112.77,-42623.53C2389.43,-42620.62 2881.44,-42607.37 3309.71,-42552.21"/>
<polygon fill="black" stroke="black" points="3310.35,-42555.66 3319.81,-42550.9 3309.45,-42548.72 3310.35,-42555.66"/>
</g>
<!-- moe_15_expert_15 -->
<g id="node285" class="node">
<title>moe_15_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-42552.14 3556,-42552.14 3556,-42500.14 3774,-42500.14 3774,-42552.14"/>
<text text-anchor="middle" x="3665" y="-42540.14" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-42529.14" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-42518.14" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-42507.14" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_15_route&#45;&gt;moe_15_expert_15 -->
<g id="edge450" class="edge">
<title>moe_15_route&#45;&gt;moe_15_expert_15</title>
<path fill="none" stroke="black" d="M2110.07,-42618.99C2487.89,-42609.62 3257.25,-42587.08 3545.76,-42552.18"/>
<polygon fill="black" stroke="black" points="3546.32,-42555.64 3555.82,-42550.93 3545.46,-42548.69 3546.32,-42555.64"/>
</g>
<!-- moe_15_aggregate -->
<g id="node286" class="node">
<title>moe_15_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1912" cy="-42427.37" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1912" y="-42441.37" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1912" y="-42430.37" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1912" y="-42419.37" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1912" y="-42408.37" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_15_expert_0&#45;&gt;moe_15_aggregate -->
<g id="edge451" class="edge">
<title>moe_15_expert_0&#45;&gt;moe_15_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-42501.34C237.15,-42500.91 240.09,-42500.5 243,-42500.14 514.1,-42465.83 1290.4,-42443.14 1681.27,-42433.56"/>
<polygon fill="black" stroke="black" points="1681.37,-42437.06 1691.29,-42433.31 1681.2,-42430.06 1681.37,-42437.06"/>
</g>
<!-- moe_15_expert_1&#45;&gt;moe_15_aggregate -->
<g id="edge452" class="edge">
<title>moe_15_expert_1&#45;&gt;moe_15_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-42501.37C473.15,-42500.93 476.09,-42500.52 479,-42500.14 899.34,-42445.43 1394.05,-42431.74 1678.52,-42428.71"/>
<polygon fill="black" stroke="black" points="1678.58,-42432.21 1688.55,-42428.61 1678.51,-42425.21 1678.58,-42432.21"/>
</g>
<!-- moe_15_expert_2&#45;&gt;moe_15_aggregate -->
<g id="edge453" class="edge">
<title>moe_15_expert_2&#45;&gt;moe_15_aggregate</title>
<path fill="none" stroke="black" d="M706.19,-42501.41C709.15,-42500.95 712.09,-42500.53 715,-42500.14 1048.43,-42455.08 1437.93,-42438.31 1679.82,-42432.06"/>
<polygon fill="black" stroke="black" points="1680.24,-42435.56 1690.15,-42431.8 1680.07,-42428.56 1680.24,-42435.56"/>
</g>
<!-- moe_15_expert_3&#45;&gt;moe_15_aggregate -->
<g id="edge454" class="edge">
<title>moe_15_expert_3&#45;&gt;moe_15_aggregate</title>
<path fill="none" stroke="black" d="M942.2,-42501.46C945.16,-42500.99 948.1,-42500.55 951,-42500.14 1200.69,-42464.53 1489.56,-42445.97 1684.88,-42436.73"/>
<polygon fill="black" stroke="black" points="1685.16,-42440.22 1694.98,-42436.25 1684.83,-42433.23 1685.16,-42440.22"/>
</g>
<!-- moe_15_expert_4&#45;&gt;moe_15_aggregate -->
<g id="edge455" class="edge">
<title>moe_15_expert_4&#45;&gt;moe_15_aggregate</title>
<path fill="none" stroke="black" d="M1178.21,-42501.56C1181.17,-42501.06 1184.1,-42500.59 1187,-42500.14 1357.89,-42473.66 1553.03,-42454.99 1697.78,-42443.35"/>
<polygon fill="black" stroke="black" points="1698.43,-42446.81 1708.11,-42442.52 1697.87,-42439.83 1698.43,-42446.81"/>
</g>
<!-- moe_15_expert_5&#45;&gt;moe_15_aggregate -->
<g id="edge456" class="edge">
<title>moe_15_expert_5&#45;&gt;moe_15_aggregate</title>
<path fill="none" stroke="black" d="M1414.24,-42501.74C1417.19,-42501.19 1420.11,-42500.65 1423,-42500.14 1524.25,-42482 1637.91,-42465.11 1730.15,-42452.28"/>
<polygon fill="black" stroke="black" points="1730.72,-42455.73 1740.14,-42450.89 1729.76,-42448.8 1730.72,-42455.73"/>
</g>
<!-- moe_15_expert_6&#45;&gt;moe_15_aggregate -->
<g id="edge457" class="edge">
<title>moe_15_expert_6&#45;&gt;moe_15_aggregate</title>
<path fill="none" stroke="black" d="M1637.02,-42500.09C1682.22,-42488.3 1736.73,-42474.08 1785.26,-42461.43"/>
<polygon fill="black" stroke="black" points="1786.4,-42464.74 1795.2,-42458.83 1784.64,-42457.97 1786.4,-42464.74"/>
</g>
<!-- moe_15_expert_7&#45;&gt;moe_15_aggregate -->
<g id="edge458" class="edge">
<title>moe_15_expert_7&#45;&gt;moe_15_aggregate</title>
<path fill="none" stroke="black" d="M1812.12,-42499.96C1825.11,-42490.65 1840.21,-42479.83 1854.67,-42469.46"/>
<polygon fill="black" stroke="black" points="1857,-42472.1 1863.09,-42463.43 1852.92,-42466.41 1857,-42472.1"/>
</g>
<!-- moe_15_expert_8&#45;&gt;moe_15_aggregate -->
<g id="edge459" class="edge">
<title>moe_15_expert_8&#45;&gt;moe_15_aggregate</title>
<path fill="none" stroke="black" d="M1986.73,-42499.96C1977.51,-42491.13 1966.88,-42480.95 1956.58,-42471.08"/>
<polygon fill="black" stroke="black" points="1958.81,-42468.37 1949.17,-42463.98 1953.97,-42473.42 1958.81,-42468.37"/>
</g>
<!-- moe_15_expert_9&#45;&gt;moe_15_aggregate -->
<g id="edge460" class="edge">
<title>moe_15_expert_9&#45;&gt;moe_15_aggregate</title>
<path fill="none" stroke="black" d="M2161.78,-42500.09C2121.71,-42488.58 2073.57,-42474.76 2030.3,-42462.34"/>
<polygon fill="black" stroke="black" points="2031.15,-42458.94 2020.57,-42459.54 2029.22,-42465.67 2031.15,-42458.94"/>
</g>
<!-- moe_15_expert_10&#45;&gt;moe_15_aggregate -->
<g id="edge461" class="edge">
<title>moe_15_expert_10&#45;&gt;moe_15_aggregate</title>
<path fill="none" stroke="black" d="M2375.75,-42501.78C2372.8,-42501.22 2369.88,-42500.67 2367,-42500.14 2274.81,-42483.11 2171.63,-42466.63 2086.87,-42453.76"/>
<polygon fill="black" stroke="black" points="2087.3,-42450.29 2076.89,-42452.25 2086.25,-42457.21 2087.3,-42450.29"/>
</g>
<!-- moe_15_expert_11&#45;&gt;moe_15_aggregate -->
<g id="edge462" class="edge">
<title>moe_15_expert_11&#45;&gt;moe_15_aggregate</title>
<path fill="none" stroke="black" d="M2611.78,-42501.58C2608.83,-42501.07 2605.9,-42500.59 2603,-42500.14 2442.74,-42474.91 2260.13,-42456.38 2122.89,-42444.47"/>
<polygon fill="black" stroke="black" points="2122.94,-42440.96 2112.67,-42443.59 2122.33,-42447.94 2122.94,-42440.96"/>
</g>
<!-- moe_15_expert_12&#45;&gt;moe_15_aggregate -->
<g id="edge463" class="edge">
<title>moe_15_expert_12&#45;&gt;moe_15_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-42501.47C2844.84,-42501 2841.9,-42500.55 2839,-42500.14 2601.01,-42465.86 2326.12,-42447.18 2137.85,-42437.54"/>
<polygon fill="black" stroke="black" points="2137.99,-42434.04 2127.82,-42437.03 2137.63,-42441.04 2137.99,-42434.04"/>
</g>
<!-- moe_15_expert_13&#45;&gt;moe_15_aggregate -->
<g id="edge464" class="edge">
<title>moe_15_expert_13&#45;&gt;moe_15_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-42501.41C3080.85,-42500.96 3077.9,-42500.53 3075,-42500.14 2753.76,-42456.44 2378.95,-42439.32 2143.53,-42432.64"/>
<polygon fill="black" stroke="black" points="2143.57,-42429.14 2133.47,-42432.36 2143.37,-42436.13 2143.57,-42429.14"/>
</g>
<!-- moe_15_expert_14&#45;&gt;moe_15_aggregate -->
<g id="edge465" class="edge">
<title>moe_15_expert_14&#45;&gt;moe_15_aggregate</title>
<path fill="none" stroke="black" d="M3319.81,-42501.37C3316.85,-42500.93 3313.91,-42500.52 3311,-42500.14 2903.37,-42446.84 2424.1,-42432.63 2145.52,-42429.13"/>
<polygon fill="black" stroke="black" points="2145.33,-42425.63 2135.29,-42429.01 2145.24,-42432.63 2145.33,-42425.63"/>
</g>
<!-- moe_15_expert_15&#45;&gt;moe_15_aggregate -->
<g id="edge466" class="edge">
<title>moe_15_expert_15&#45;&gt;moe_15_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-42501.34C3552.85,-42500.91 3549.91,-42500.51 3547,-42500.14 3282.46,-42466.54 2526.81,-42443.63 2142.49,-42433.79"/>
<polygon fill="black" stroke="black" points="2142.44,-42430.29 2132.35,-42433.53 2142.26,-42437.29 2142.44,-42430.29"/>
</g>
<!-- moe_15_ffn -->
<g id="node287" class="node">
<title>moe_15_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2070,-42354.6 1754,-42354.6 1754,-42302.6 2070,-42302.6 2070,-42354.6"/>
<text text-anchor="middle" x="1912" y="-42342.6" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1912" y="-42331.6" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1912" y="-42320.6" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1912" y="-42309.6" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_15_aggregate&#45;&gt;moe_15_ffn -->
<g id="edge467" class="edge">
<title>moe_15_aggregate&#45;&gt;moe_15_ffn</title>
<path fill="none" stroke="black" d="M1912,-42390.33C1912,-42382.02 1912,-42373.19 1912,-42364.91"/>
<polygon fill="black" stroke="black" points="1915.5,-42364.79 1912,-42354.79 1908.5,-42364.79 1915.5,-42364.79"/>
</g>
<!-- moe_15_res2 -->
<g id="node289" class="node">
<title>moe_15_res2</title>
<polygon fill="lightyellow" stroke="black" points="2248.89,-42266.6 1712.97,-42266.6 1575.11,-42162.6 2111.03,-42162.6 2248.89,-42266.6"/>
<text text-anchor="middle" x="1912" y="-42228.6" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1912" y="-42217.6" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1912" y="-42206.6" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1912" y="-42195.6" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_15_ffn&#45;&gt;moe_15_res2 -->
<g id="edge468" class="edge">
<title>moe_15_ffn&#45;&gt;moe_15_res2</title>
<path fill="none" stroke="black" d="M1912,-42302.46C1912,-42294.78 1912,-42285.97 1912,-42276.97"/>
<polygon fill="black" stroke="black" points="1915.5,-42276.78 1912,-42266.78 1908.5,-42276.78 1915.5,-42276.78"/>
</g>
<!-- moe_15_res1&#45;&gt;moe_15_gate -->
<g id="edge433" class="edge">
<title>moe_15_res1&#45;&gt;moe_15_gate</title>
<path fill="none" stroke="black" d="M1895,-42837.29C1895,-42829.12 1895,-42820.59 1895,-42812.22"/>
<polygon fill="black" stroke="black" points="1898.5,-42812.1 1895,-42802.1 1891.5,-42812.1 1898.5,-42812.1"/>
</g>
<!-- moe_16_mha -->
<g id="node290" class="node">
<title>moe_16_mha</title>
<polygon fill="lightgreen" stroke="black" points="2070,-42115.6 1754,-42115.6 1754,-42063.6 2070,-42063.6 2070,-42115.6"/>
<text text-anchor="middle" x="1912" y="-42103.6" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1912" y="-42092.6" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1912" y="-42081.6" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1912" y="-42070.6" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_15_res2&#45;&gt;moe_16_mha -->
<g id="edge469" class="edge">
<title>moe_15_res2&#45;&gt;moe_16_mha</title>
<path fill="none" stroke="black" d="M1912,-42162.5C1912,-42150.17 1912,-42137.27 1912,-42125.85"/>
<polygon fill="black" stroke="black" points="1915.5,-42125.84 1912,-42115.84 1908.5,-42125.84 1915.5,-42125.84"/>
</g>
<!-- moe_16_res1 -->
<g id="node311" class="node">
<title>moe_16_res1</title>
<polygon fill="lightyellow" stroke="black" points="2248.89,-42027.6 1712.97,-42027.6 1575.11,-41923.6 2111.03,-41923.6 2248.89,-42027.6"/>
<text text-anchor="middle" x="1912" y="-41989.6" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1912" y="-41978.6" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1912" y="-41967.6" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1912" y="-41956.6" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_16_mha&#45;&gt;moe_16_res1 -->
<g id="edge470" class="edge">
<title>moe_16_mha&#45;&gt;moe_16_res1</title>
<path fill="none" stroke="black" d="M1912,-42063.46C1912,-42055.78 1912,-42046.97 1912,-42037.97"/>
<polygon fill="black" stroke="black" points="1915.5,-42037.78 1912,-42027.78 1908.5,-42037.78 1915.5,-42037.78"/>
</g>
<!-- moe_16_gate -->
<g id="node291" class="node">
<title>moe_16_gate</title>
<polygon fill="lightyellow" stroke="black" points="2240.8,-41887.6 1717.75,-41887.6 1583.2,-41783.6 2106.25,-41783.6 2240.8,-41887.6"/>
<text text-anchor="middle" x="1912" y="-41849.6" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1912" y="-41838.6" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1912" y="-41827.6" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1912" y="-41816.6" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_16_route -->
<g id="node292" class="node">
<title>moe_16_route</title>
<ellipse fill="lightblue" stroke="black" cx="1912" cy="-41710.83" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1912" y="-41724.83" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1912" y="-41713.83" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1912" y="-41702.83" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1912" y="-41691.83" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_16_gate&#45;&gt;moe_16_route -->
<g id="edge472" class="edge">
<title>moe_16_gate&#45;&gt;moe_16_route</title>
<path fill="none" stroke="black" d="M1912,-41783.24C1912,-41774.84 1912,-41766.17 1912,-41757.9"/>
<polygon fill="black" stroke="black" points="1915.5,-41757.68 1912,-41747.68 1908.5,-41757.68 1915.5,-41757.68"/>
</g>
<!-- moe_16_expert_0 -->
<g id="node293" class="node">
<title>moe_16_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="269,-41638.06 51,-41638.06 51,-41586.06 269,-41586.06 269,-41638.06"/>
<text text-anchor="middle" x="160" y="-41626.06" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="160" y="-41615.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="160" y="-41604.06" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="160" y="-41593.06" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_16_route&#45;&gt;moe_16_expert_0 -->
<g id="edge473" class="edge">
<title>moe_16_route&#45;&gt;moe_16_expert_0</title>
<path fill="none" stroke="black" d="M1697.04,-41704.79C1322.53,-41695.29 564,-41672.63 279.12,-41638.09"/>
<polygon fill="black" stroke="black" points="279.54,-41634.61 269.18,-41636.85 278.68,-41641.56 279.54,-41634.61"/>
</g>
<!-- moe_16_expert_1 -->
<g id="node294" class="node">
<title>moe_16_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="505,-41638.06 287,-41638.06 287,-41586.06 505,-41586.06 505,-41638.06"/>
<text text-anchor="middle" x="396" y="-41626.06" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="396" y="-41615.06" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="396" y="-41604.06" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="396" y="-41593.06" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_16_route&#45;&gt;moe_16_expert_1 -->
<g id="edge474" class="edge">
<title>moe_16_route&#45;&gt;moe_16_expert_1</title>
<path fill="none" stroke="black" d="M1694.3,-41709.24C1420.66,-41706.09 936.72,-41692.55 515.13,-41638.12"/>
<polygon fill="black" stroke="black" points="515.55,-41634.64 505.19,-41636.82 514.65,-41641.58 515.55,-41634.64"/>
</g>
<!-- moe_16_expert_2 -->
<g id="node295" class="node">
<title>moe_16_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="741,-41638.06 523,-41638.06 523,-41586.06 741,-41586.06 741,-41638.06"/>
<text text-anchor="middle" x="632" y="-41626.06" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="632" y="-41615.06" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="632" y="-41604.06" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="632" y="-41593.06" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_16_route&#45;&gt;moe_16_expert_2 -->
<g id="edge475" class="edge">
<title>moe_16_route&#45;&gt;moe_16_expert_2</title>
<path fill="none" stroke="black" d="M1696.1,-41705.98C1464.48,-41699.66 1085.94,-41683.04 751.57,-41638.19"/>
<polygon fill="black" stroke="black" points="751.57,-41634.65 741.19,-41636.78 750.63,-41641.59 751.57,-41634.65"/>
</g>
<!-- moe_16_expert_3 -->
<g id="node296" class="node">
<title>moe_16_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="977,-41638.06 759,-41638.06 759,-41586.06 977,-41586.06 977,-41638.06"/>
<text text-anchor="middle" x="868" y="-41626.06" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="868" y="-41615.06" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="868" y="-41604.06" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="868" y="-41593.06" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_16_route&#45;&gt;moe_16_expert_3 -->
<g id="edge476" class="edge">
<title>moe_16_route&#45;&gt;moe_16_expert_3</title>
<path fill="none" stroke="black" d="M1701.04,-41701.38C1515.27,-41692.09 1237.43,-41673.7 987.21,-41638.16"/>
<polygon fill="black" stroke="black" points="987.6,-41634.67 977.2,-41636.72 986.6,-41641.6 987.6,-41634.67"/>
</g>
<!-- moe_16_expert_4 -->
<g id="node297" class="node">
<title>moe_16_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1213,-41638.06 995,-41638.06 995,-41586.06 1213,-41586.06 1213,-41638.06"/>
<text text-anchor="middle" x="1104" y="-41626.06" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1104" y="-41615.06" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1104" y="-41604.06" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1104" y="-41593.06" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_16_route&#45;&gt;moe_16_expert_4 -->
<g id="edge477" class="edge">
<title>moe_16_route&#45;&gt;moe_16_expert_4</title>
<path fill="none" stroke="black" d="M1715.36,-41694.91C1579.56,-41683.28 1394.71,-41664.84 1223.19,-41638.18"/>
<polygon fill="black" stroke="black" points="1223.64,-41634.71 1213.22,-41636.62 1222.55,-41641.63 1223.64,-41634.71"/>
</g>
<!-- moe_16_expert_5 -->
<g id="node298" class="node">
<title>moe_16_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1449,-41638.06 1231,-41638.06 1231,-41586.06 1449,-41586.06 1449,-41638.06"/>
<text text-anchor="middle" x="1340" y="-41626.06" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1340" y="-41615.06" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1340" y="-41604.06" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1340" y="-41593.06" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_16_route&#45;&gt;moe_16_expert_5 -->
<g id="edge478" class="edge">
<title>moe_16_route&#45;&gt;moe_16_expert_5</title>
<path fill="none" stroke="black" d="M1749.59,-41686.25C1665.58,-41673.54 1561.18,-41656.95 1459.12,-41638.23"/>
<polygon fill="black" stroke="black" points="1459.72,-41634.78 1449.25,-41636.41 1458.45,-41641.67 1459.72,-41634.78"/>
</g>
<!-- moe_16_expert_6 -->
<g id="node299" class="node">
<title>moe_16_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1685,-41638.06 1467,-41638.06 1467,-41586.06 1685,-41586.06 1685,-41638.06"/>
<text text-anchor="middle" x="1576" y="-41626.06" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1576" y="-41615.06" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1576" y="-41604.06" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1576" y="-41593.06" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_16_route&#45;&gt;moe_16_expert_6 -->
<g id="edge479" class="edge">
<title>moe_16_route&#45;&gt;moe_16_expert_6</title>
<path fill="none" stroke="black" d="M1804.3,-41678.81C1762.01,-41666.63 1713.84,-41652.76 1672.68,-41640.9"/>
<polygon fill="black" stroke="black" points="1673.5,-41637.5 1662.92,-41638.09 1671.56,-41644.22 1673.5,-41637.5"/>
</g>
<!-- moe_16_expert_7 -->
<g id="node300" class="node">
<title>moe_16_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1921,-41638.06 1703,-41638.06 1703,-41586.06 1921,-41586.06 1921,-41638.06"/>
<text text-anchor="middle" x="1812" y="-41626.06" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1812" y="-41615.06" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1812" y="-41604.06" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1812" y="-41593.06" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_16_route&#45;&gt;moe_16_expert_7 -->
<g id="edge480" class="edge">
<title>moe_16_route&#45;&gt;moe_16_expert_7</title>
<path fill="none" stroke="black" d="M1875.33,-41674.34C1865.57,-41664.9 1855.07,-41654.74 1845.49,-41645.46"/>
<polygon fill="black" stroke="black" points="1847.65,-41642.68 1838.03,-41638.24 1842.78,-41647.71 1847.65,-41642.68"/>
</g>
<!-- moe_16_expert_8 -->
<g id="node301" class="node">
<title>moe_16_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2157,-41638.06 1939,-41638.06 1939,-41586.06 2157,-41586.06 2157,-41638.06"/>
<text text-anchor="middle" x="2048" y="-41626.06" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2048" y="-41615.06" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2048" y="-41604.06" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2048" y="-41593.06" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_16_route&#45;&gt;moe_16_expert_8 -->
<g id="edge481" class="edge">
<title>moe_16_route&#45;&gt;moe_16_expert_8</title>
<path fill="none" stroke="black" d="M1961.1,-41674.89C1975.21,-41664.85 1990.51,-41653.97 2004.27,-41644.17"/>
<polygon fill="black" stroke="black" points="2006.5,-41646.88 2012.62,-41638.23 2002.45,-41641.18 2006.5,-41646.88"/>
</g>
<!-- moe_16_expert_9 -->
<g id="node302" class="node">
<title>moe_16_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2393,-41638.06 2175,-41638.06 2175,-41586.06 2393,-41586.06 2393,-41638.06"/>
<text text-anchor="middle" x="2284" y="-41626.06" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2284" y="-41615.06" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2284" y="-41604.06" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2284" y="-41593.06" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_16_route&#45;&gt;moe_16_expert_9 -->
<g id="edge482" class="edge">
<title>moe_16_route&#45;&gt;moe_16_expert_9</title>
<path fill="none" stroke="black" d="M2027.92,-41679.67C2075.8,-41667.22 2130.93,-41652.88 2177.75,-41640.7"/>
<polygon fill="black" stroke="black" points="2178.81,-41644.04 2187.61,-41638.13 2177.05,-41637.26 2178.81,-41644.04"/>
</g>
<!-- moe_16_expert_10 -->
<g id="node303" class="node">
<title>moe_16_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2629,-41638.06 2411,-41638.06 2411,-41586.06 2629,-41586.06 2629,-41638.06"/>
<text text-anchor="middle" x="2520" y="-41626.06" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2520" y="-41615.06" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2520" y="-41604.06" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2520" y="-41593.06" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_16_route&#45;&gt;moe_16_expert_10 -->
<g id="edge483" class="edge">
<title>moe_16_route&#45;&gt;moe_16_expert_10</title>
<path fill="none" stroke="black" d="M2081.37,-41687.71C2173.18,-41675.07 2288.79,-41658.1 2400.64,-41638.26"/>
<polygon fill="black" stroke="black" points="2401.53,-41641.66 2410.76,-41636.46 2400.3,-41634.77 2401.53,-41641.66"/>
</g>
<!-- moe_16_expert_11 -->
<g id="node304" class="node">
<title>moe_16_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2865,-41638.06 2647,-41638.06 2647,-41586.06 2865,-41586.06 2865,-41638.06"/>
<text text-anchor="middle" x="2756" y="-41626.06" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2756" y="-41615.06" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2756" y="-41604.06" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2756" y="-41593.06" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_16_route&#45;&gt;moe_16_expert_11 -->
<g id="edge484" class="edge">
<title>moe_16_route&#45;&gt;moe_16_expert_11</title>
<path fill="none" stroke="black" d="M2111.5,-41696.06C2255.13,-41684.73 2453.57,-41666.17 2636.7,-41638.19"/>
<polygon fill="black" stroke="black" points="2637.44,-41641.62 2646.79,-41636.64 2636.37,-41634.7 2637.44,-41641.62"/>
</g>
<!-- moe_16_expert_12 -->
<g id="node305" class="node">
<title>moe_16_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3101,-41638.06 2883,-41638.06 2883,-41586.06 3101,-41586.06 3101,-41638.06"/>
<text text-anchor="middle" x="2992" y="-41626.06" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2992" y="-41615.06" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2992" y="-41604.06" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2992" y="-41593.06" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_16_route&#45;&gt;moe_16_expert_12 -->
<g id="edge485" class="edge">
<title>moe_16_route&#45;&gt;moe_16_expert_12</title>
<path fill="none" stroke="black" d="M2124.01,-41702.2C2317.04,-41693.33 2609.88,-41675.11 2872.68,-41638.17"/>
<polygon fill="black" stroke="black" points="2873.39,-41641.6 2882.8,-41636.73 2872.41,-41634.67 2873.39,-41641.6"/>
</g>
<!-- moe_16_expert_13 -->
<g id="node306" class="node">
<title>moe_16_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3337,-41638.06 3119,-41638.06 3119,-41586.06 3337,-41586.06 3337,-41638.06"/>
<text text-anchor="middle" x="3228" y="-41626.06" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3228" y="-41615.06" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3228" y="-41604.06" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3228" y="-41593.06" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_16_route&#45;&gt;moe_16_expert_13 -->
<g id="edge486" class="edge">
<title>moe_16_route&#45;&gt;moe_16_expert_13</title>
<path fill="none" stroke="black" d="M2128.54,-41706.54C2366.91,-41700.69 2761.32,-41684.46 3108.8,-41638.13"/>
<polygon fill="black" stroke="black" points="3109.36,-41641.59 3118.81,-41636.79 3108.43,-41634.65 3109.36,-41641.59"/>
</g>
<!-- moe_16_expert_14 -->
<g id="node307" class="node">
<title>moe_16_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3573,-41638.06 3355,-41638.06 3355,-41586.06 3573,-41586.06 3573,-41638.06"/>
<text text-anchor="middle" x="3464" y="-41626.06" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3464" y="-41615.06" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3464" y="-41604.06" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3464" y="-41593.06" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_16_route&#45;&gt;moe_16_expert_14 -->
<g id="edge487" class="edge">
<title>moe_16_route&#45;&gt;moe_16_expert_14</title>
<path fill="none" stroke="black" d="M2129.78,-41709.65C2409.51,-41706.99 2909.8,-41694.02 3344.87,-41638.11"/>
<polygon fill="black" stroke="black" points="3345.35,-41641.58 3354.81,-41636.83 3344.45,-41634.64 3345.35,-41641.58"/>
</g>
<!-- moe_16_expert_15 -->
<g id="node308" class="node">
<title>moe_16_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3809,-41638.06 3591,-41638.06 3591,-41586.06 3809,-41586.06 3809,-41638.06"/>
<text text-anchor="middle" x="3700" y="-41626.06" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3700" y="-41615.06" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3700" y="-41604.06" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3700" y="-41593.06" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_16_route&#45;&gt;moe_16_expert_15 -->
<g id="edge488" class="edge">
<title>moe_16_route&#45;&gt;moe_16_expert_15</title>
<path fill="none" stroke="black" d="M2127.14,-41705.03C2508.24,-41695.79 3288.49,-41673.38 3580.63,-41638.12"/>
<polygon fill="black" stroke="black" points="3581.32,-41641.56 3590.82,-41636.86 3580.46,-41634.61 3581.32,-41641.56"/>
</g>
<!-- moe_16_aggregate -->
<g id="node309" class="node">
<title>moe_16_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1847" cy="-41513.29" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1847" y="-41527.29" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1847" y="-41516.29" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1847" y="-41505.29" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1847" y="-41494.29" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_16_expert_0&#45;&gt;moe_16_aggregate -->
<g id="edge489" class="edge">
<title>moe_16_expert_0&#45;&gt;moe_16_aggregate</title>
<path fill="none" stroke="black" d="M269.18,-41587.27C272.15,-41586.84 275.09,-41586.43 278,-41586.06 529.87,-41553.84 1245.67,-41530.51 1617.08,-41520.19"/>
<polygon fill="black" stroke="black" points="1617.25,-41523.69 1627.15,-41519.92 1617.06,-41516.69 1617.25,-41523.69"/>
</g>
<!-- moe_16_expert_1&#45;&gt;moe_16_aggregate -->
<g id="edge490" class="edge">
<title>moe_16_expert_1&#45;&gt;moe_16_aggregate</title>
<path fill="none" stroke="black" d="M505.19,-41587.3C508.15,-41586.86 511.09,-41586.44 514,-41586.06 897.23,-41535.46 1346.94,-41520.33 1613.82,-41515.93"/>
<polygon fill="black" stroke="black" points="1614.08,-41519.42 1624.03,-41515.76 1613.97,-41512.42 1614.08,-41519.42"/>
</g>
<!-- moe_16_expert_2&#45;&gt;moe_16_aggregate -->
<g id="edge491" class="edge">
<title>moe_16_expert_2&#45;&gt;moe_16_aggregate</title>
<path fill="none" stroke="black" d="M741.19,-41587.35C744.16,-41586.89 747.1,-41586.46 750,-41586.06 1047.47,-41545.03 1393.64,-41527.33 1616.3,-41519.77"/>
<polygon fill="black" stroke="black" points="1616.6,-41523.26 1626.48,-41519.43 1616.37,-41516.27 1616.6,-41523.26"/>
</g>
<!-- moe_16_expert_3&#45;&gt;moe_16_aggregate -->
<g id="edge492" class="edge">
<title>moe_16_expert_3&#45;&gt;moe_16_aggregate</title>
<path fill="none" stroke="black" d="M977.2,-41587.42C980.16,-41586.94 983.1,-41586.49 986,-41586.06 1201.63,-41554.36 1449.87,-41535.52 1624.22,-41525.16"/>
<polygon fill="black" stroke="black" points="1624.51,-41528.65 1634.29,-41524.57 1624.1,-41521.66 1624.51,-41528.65"/>
</g>
<!-- moe_16_expert_4&#45;&gt;moe_16_aggregate -->
<g id="edge493" class="edge">
<title>moe_16_expert_4&#45;&gt;moe_16_aggregate</title>
<path fill="none" stroke="black" d="M1213.22,-41587.54C1216.18,-41587.02 1219.11,-41586.53 1222,-41586.06 1361.98,-41563.25 1520.75,-41545.11 1643.24,-41532.78"/>
<polygon fill="black" stroke="black" points="1643.88,-41536.23 1653.49,-41531.75 1643.19,-41529.27 1643.88,-41536.23"/>
</g>
<!-- moe_16_expert_5&#45;&gt;moe_16_aggregate -->
<g id="edge494" class="edge">
<title>moe_16_expert_5&#45;&gt;moe_16_aggregate</title>
<path fill="none" stroke="black" d="M1449.27,-41587.8C1452.21,-41587.21 1455.12,-41586.63 1458,-41586.06 1533.6,-41571.08 1617.67,-41555.44 1688.26,-41542.6"/>
<polygon fill="black" stroke="black" points="1688.91,-41546.04 1698.13,-41540.81 1687.66,-41539.15 1688.91,-41546.04"/>
</g>
<!-- moe_16_expert_6&#45;&gt;moe_16_aggregate -->
<g id="edge495" class="edge">
<title>moe_16_expert_6&#45;&gt;moe_16_aggregate</title>
<path fill="none" stroke="black" d="M1646.14,-41586.01C1676.54,-41575.16 1712.72,-41562.24 1745.94,-41550.38"/>
<polygon fill="black" stroke="black" points="1747.44,-41553.56 1755.68,-41546.9 1745.09,-41546.96 1747.44,-41553.56"/>
</g>
<!-- moe_16_expert_7&#45;&gt;moe_16_aggregate -->
<g id="edge496" class="edge">
<title>moe_16_expert_7&#45;&gt;moe_16_aggregate</title>
<path fill="none" stroke="black" d="M1821.1,-41585.89C1823.99,-41577.91 1827.27,-41568.83 1830.51,-41559.87"/>
<polygon fill="black" stroke="black" points="1833.88,-41560.86 1833.99,-41550.27 1827.3,-41558.48 1833.88,-41560.86"/>
</g>
<!-- moe_16_expert_8&#45;&gt;moe_16_aggregate -->
<g id="edge497" class="edge">
<title>moe_16_expert_8&#45;&gt;moe_16_aggregate</title>
<path fill="none" stroke="black" d="M1995.98,-41586.01C1974.93,-41575.88 1950.14,-41563.95 1926.9,-41552.75"/>
<polygon fill="black" stroke="black" points="1928.26,-41549.53 1917.73,-41548.34 1925.23,-41555.83 1928.26,-41549.53"/>
</g>
<!-- moe_16_expert_9&#45;&gt;moe_16_aggregate -->
<g id="edge498" class="edge">
<title>moe_16_expert_9&#45;&gt;moe_16_aggregate</title>
<path fill="none" stroke="black" d="M2174.85,-41586.89C2118.22,-41574.35 2048.38,-41558.88 1987.73,-41545.45"/>
<polygon fill="black" stroke="black" points="1988.21,-41541.97 1977.69,-41543.23 1986.69,-41548.81 1988.21,-41541.97"/>
</g>
<!-- moe_16_expert_10&#45;&gt;moe_16_aggregate -->
<g id="edge499" class="edge">
<title>moe_16_expert_10&#45;&gt;moe_16_aggregate</title>
<path fill="none" stroke="black" d="M2410.77,-41587.59C2407.82,-41587.06 2404.89,-41586.55 2402,-41586.06 2282.54,-41565.71 2147.74,-41548.16 2040.91,-41535.5"/>
<polygon fill="black" stroke="black" points="2041,-41531.99 2030.66,-41534.29 2040.18,-41538.94 2041,-41531.99"/>
</g>
<!-- moe_16_expert_11&#45;&gt;moe_16_aggregate -->
<g id="edge500" class="edge">
<title>moe_16_expert_11&#45;&gt;moe_16_aggregate</title>
<path fill="none" stroke="black" d="M2646.79,-41587.45C2643.83,-41586.96 2640.9,-41586.5 2638,-41586.06 2445.87,-41557.09 2225.61,-41538.27 2066.38,-41527.2"/>
<polygon fill="black" stroke="black" points="2066.2,-41523.68 2055.99,-41526.48 2065.72,-41530.66 2066.2,-41523.68"/>
</g>
<!-- moe_16_expert_12&#45;&gt;moe_16_aggregate -->
<g id="edge501" class="edge">
<title>moe_16_expert_12&#45;&gt;moe_16_aggregate</title>
<path fill="none" stroke="black" d="M2882.8,-41587.37C2879.84,-41586.9 2876.9,-41586.47 2874,-41586.06 2601.24,-41547.82 2284.72,-41529.61 2075.96,-41521.18"/>
<polygon fill="black" stroke="black" points="2075.93,-41517.67 2065.79,-41520.77 2075.65,-41524.67 2075.93,-41517.67"/>
</g>
<!-- moe_16_expert_13&#45;&gt;moe_16_aggregate -->
<g id="edge502" class="edge">
<title>moe_16_expert_13&#45;&gt;moe_16_aggregate</title>
<path fill="none" stroke="black" d="M3118.81,-41587.32C3115.85,-41586.87 3112.91,-41586.45 3110,-41586.06 2752.46,-41538.31 2333.82,-41522.29 2079.65,-41516.94"/>
<polygon fill="black" stroke="black" points="2079.63,-41513.43 2069.56,-41516.73 2079.48,-41520.43 2079.63,-41513.43"/>
</g>
<!-- moe_16_expert_14&#45;&gt;moe_16_aggregate -->
<g id="edge503" class="edge">
<title>moe_16_expert_14&#45;&gt;moe_16_aggregate</title>
<path fill="none" stroke="black" d="M3354.81,-41587.28C3351.85,-41586.84 3348.91,-41586.43 3346,-41586.06 2901.18,-41528.67 2376.77,-41516.01 2080.95,-41513.87"/>
<polygon fill="black" stroke="black" points="2080.55,-41510.37 2070.52,-41513.8 2080.5,-41517.37 2080.55,-41510.37"/>
</g>
<!-- moe_16_expert_15&#45;&gt;moe_16_aggregate -->
<g id="edge504" class="edge">
<title>moe_16_expert_15&#45;&gt;moe_16_aggregate</title>
<path fill="none" stroke="black" d="M3590.82,-41587.26C3587.85,-41586.82 3584.91,-41586.42 3582,-41586.06 3298.16,-41550.38 2481.61,-41528.15 2078.2,-41519.05"/>
<polygon fill="black" stroke="black" points="2078.23,-41515.55 2068.16,-41518.82 2078.07,-41522.55 2078.23,-41515.55"/>
</g>
<!-- moe_16_ffn -->
<g id="node310" class="node">
<title>moe_16_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2005,-41440.52 1689,-41440.52 1689,-41388.52 2005,-41388.52 2005,-41440.52"/>
<text text-anchor="middle" x="1847" y="-41428.52" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1847" y="-41417.52" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1847" y="-41406.52" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1847" y="-41395.52" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_16_aggregate&#45;&gt;moe_16_ffn -->
<g id="edge505" class="edge">
<title>moe_16_aggregate&#45;&gt;moe_16_ffn</title>
<path fill="none" stroke="black" d="M1847,-41476.26C1847,-41467.94 1847,-41459.11 1847,-41450.83"/>
<polygon fill="black" stroke="black" points="1850.5,-41450.72 1847,-41440.72 1843.5,-41450.72 1850.5,-41450.72"/>
</g>
<!-- moe_16_res2 -->
<g id="node312" class="node">
<title>moe_16_res2</title>
<polygon fill="lightyellow" stroke="black" points="2183.89,-41352.52 1647.97,-41352.52 1510.11,-41248.52 2046.03,-41248.52 2183.89,-41352.52"/>
<text text-anchor="middle" x="1847" y="-41314.52" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1847" y="-41303.52" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1847" y="-41292.52" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1847" y="-41281.52" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_16_ffn&#45;&gt;moe_16_res2 -->
<g id="edge506" class="edge">
<title>moe_16_ffn&#45;&gt;moe_16_res2</title>
<path fill="none" stroke="black" d="M1847,-41388.38C1847,-41380.7 1847,-41371.89 1847,-41362.89"/>
<polygon fill="black" stroke="black" points="1850.5,-41362.7 1847,-41352.7 1843.5,-41362.7 1850.5,-41362.7"/>
</g>
<!-- moe_16_res1&#45;&gt;moe_16_gate -->
<g id="edge471" class="edge">
<title>moe_16_res1&#45;&gt;moe_16_gate</title>
<path fill="none" stroke="black" d="M1912,-41923.21C1912,-41915.04 1912,-41906.51 1912,-41898.14"/>
<polygon fill="black" stroke="black" points="1915.5,-41898.03 1912,-41888.03 1908.5,-41898.03 1915.5,-41898.03"/>
</g>
<!-- moe_17_mha -->
<g id="node313" class="node">
<title>moe_17_mha</title>
<polygon fill="lightgreen" stroke="black" points="2005,-41201.52 1689,-41201.52 1689,-41149.52 2005,-41149.52 2005,-41201.52"/>
<text text-anchor="middle" x="1847" y="-41189.52" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1847" y="-41178.52" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1847" y="-41167.52" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1847" y="-41156.52" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_16_res2&#45;&gt;moe_17_mha -->
<g id="edge507" class="edge">
<title>moe_16_res2&#45;&gt;moe_17_mha</title>
<path fill="none" stroke="black" d="M1847,-41248.42C1847,-41236.09 1847,-41223.19 1847,-41211.77"/>
<polygon fill="black" stroke="black" points="1850.5,-41211.76 1847,-41201.76 1843.5,-41211.76 1850.5,-41211.76"/>
</g>
<!-- moe_17_res1 -->
<g id="node334" class="node">
<title>moe_17_res1</title>
<polygon fill="lightyellow" stroke="black" points="2183.89,-41113.52 1647.97,-41113.52 1510.11,-41009.52 2046.03,-41009.52 2183.89,-41113.52"/>
<text text-anchor="middle" x="1847" y="-41075.52" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1847" y="-41064.52" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1847" y="-41053.52" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1847" y="-41042.52" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_17_mha&#45;&gt;moe_17_res1 -->
<g id="edge508" class="edge">
<title>moe_17_mha&#45;&gt;moe_17_res1</title>
<path fill="none" stroke="black" d="M1847,-41149.38C1847,-41141.7 1847,-41132.89 1847,-41123.89"/>
<polygon fill="black" stroke="black" points="1850.5,-41123.7 1847,-41113.7 1843.5,-41123.7 1850.5,-41123.7"/>
</g>
<!-- moe_17_gate -->
<g id="node314" class="node">
<title>moe_17_gate</title>
<polygon fill="lightyellow" stroke="black" points="2175.8,-40973.52 1652.75,-40973.52 1518.2,-40869.52 2041.25,-40869.52 2175.8,-40973.52"/>
<text text-anchor="middle" x="1847" y="-40935.52" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1847" y="-40924.52" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1847" y="-40913.52" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1847" y="-40902.52" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_17_route -->
<g id="node315" class="node">
<title>moe_17_route</title>
<ellipse fill="lightblue" stroke="black" cx="1847" cy="-40796.75" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1847" y="-40810.75" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1847" y="-40799.75" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1847" y="-40788.75" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1847" y="-40777.75" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_17_gate&#45;&gt;moe_17_route -->
<g id="edge510" class="edge">
<title>moe_17_gate&#45;&gt;moe_17_route</title>
<path fill="none" stroke="black" d="M1847,-40869.17C1847,-40860.76 1847,-40852.09 1847,-40843.82"/>
<polygon fill="black" stroke="black" points="1850.5,-40843.61 1847,-40833.61 1843.5,-40843.61 1850.5,-40843.61"/>
</g>
<!-- moe_17_expert_0 -->
<g id="node316" class="node">
<title>moe_17_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="261,-40723.98 43,-40723.98 43,-40671.98 261,-40671.98 261,-40723.98"/>
<text text-anchor="middle" x="152" y="-40711.98" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="152" y="-40700.98" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="152" y="-40689.98" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="152" y="-40678.98" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_17_route&#45;&gt;moe_17_expert_0 -->
<g id="edge511" class="edge">
<title>moe_17_route&#45;&gt;moe_17_expert_0</title>
<path fill="none" stroke="black" d="M1632.27,-40790.32C1268.53,-40780.41 544.85,-40757.39 271.12,-40724.01"/>
<polygon fill="black" stroke="black" points="271.54,-40720.53 261.18,-40722.77 270.67,-40727.48 271.54,-40720.53"/>
</g>
<!-- moe_17_expert_1 -->
<g id="node317" class="node">
<title>moe_17_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="497,-40723.98 279,-40723.98 279,-40671.98 497,-40671.98 497,-40723.98"/>
<text text-anchor="middle" x="388" y="-40711.98" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="388" y="-40700.98" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="388" y="-40689.98" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="388" y="-40678.98" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_17_route&#45;&gt;moe_17_expert_1 -->
<g id="edge512" class="edge">
<title>moe_17_route&#45;&gt;moe_17_expert_1</title>
<path fill="none" stroke="black" d="M1629.46,-40794.46C1365.61,-40790.54 907.49,-40776.16 507.23,-40724.05"/>
<polygon fill="black" stroke="black" points="507.56,-40720.57 497.19,-40722.74 506.65,-40727.51 507.56,-40720.57"/>
</g>
<!-- moe_17_expert_2 -->
<g id="node318" class="node">
<title>moe_17_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="733,-40723.98 515,-40723.98 515,-40671.98 733,-40671.98 733,-40723.98"/>
<text text-anchor="middle" x="624" y="-40711.98" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="624" y="-40700.98" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="624" y="-40689.98" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="624" y="-40678.98" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_17_route&#45;&gt;moe_17_expert_2 -->
<g id="edge513" class="edge">
<title>moe_17_route&#45;&gt;moe_17_expert_2</title>
<path fill="none" stroke="black" d="M1631.92,-40790.93C1410.97,-40783.87 1057.15,-40766.68 743.4,-40724.09"/>
<polygon fill="black" stroke="black" points="743.58,-40720.58 733.19,-40722.69 742.63,-40727.52 743.58,-40720.58"/>
</g>
<!-- moe_17_expert_3 -->
<g id="node319" class="node">
<title>moe_17_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="969,-40723.98 751,-40723.98 751,-40671.98 969,-40671.98 969,-40723.98"/>
<text text-anchor="middle" x="860" y="-40711.98" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="860" y="-40700.98" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="860" y="-40689.98" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="860" y="-40678.98" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_17_route&#45;&gt;moe_17_expert_3 -->
<g id="edge514" class="edge">
<title>moe_17_route&#45;&gt;moe_17_expert_3</title>
<path fill="none" stroke="black" d="M1638.53,-40785.94C1464.47,-40776.01 1209.82,-40757.43 979.13,-40724.07"/>
<polygon fill="black" stroke="black" points="979.6,-40720.6 969.2,-40722.62 978.59,-40727.53 979.6,-40720.6"/>
</g>
<!-- moe_17_expert_4 -->
<g id="node320" class="node">
<title>moe_17_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1205,-40723.98 987,-40723.98 987,-40671.98 1205,-40671.98 1205,-40723.98"/>
<text text-anchor="middle" x="1096" y="-40711.98" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1096" y="-40700.98" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1096" y="-40689.98" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1096" y="-40678.98" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_17_route&#45;&gt;moe_17_expert_4 -->
<g id="edge515" class="edge">
<title>moe_17_route&#45;&gt;moe_17_expert_4</title>
<path fill="none" stroke="black" d="M1656.26,-40778.93C1532.99,-40766.91 1369.01,-40748.76 1215.33,-40724.14"/>
<polygon fill="black" stroke="black" points="1215.65,-40720.64 1205.22,-40722.51 1214.54,-40727.55 1215.65,-40720.64"/>
</g>
<!-- moe_17_expert_5 -->
<g id="node321" class="node">
<title>moe_17_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1441,-40723.98 1223,-40723.98 1223,-40671.98 1441,-40671.98 1441,-40723.98"/>
<text text-anchor="middle" x="1332" y="-40711.98" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1332" y="-40700.98" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1332" y="-40689.98" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1332" y="-40678.98" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_17_route&#45;&gt;moe_17_expert_5 -->
<g id="edge516" class="edge">
<title>moe_17_route&#45;&gt;moe_17_expert_5</title>
<path fill="none" stroke="black" d="M1697.87,-40769.88C1626.02,-40757.15 1538.38,-40741.23 1451.08,-40724.17"/>
<polygon fill="black" stroke="black" points="1451.75,-40720.74 1441.27,-40722.25 1450.41,-40727.61 1451.75,-40720.74"/>
</g>
<!-- moe_17_expert_6 -->
<g id="node322" class="node">
<title>moe_17_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1677,-40723.98 1459,-40723.98 1459,-40671.98 1677,-40671.98 1677,-40723.98"/>
<text text-anchor="middle" x="1568" y="-40711.98" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1568" y="-40700.98" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1568" y="-40689.98" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1568" y="-40678.98" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_17_route&#45;&gt;moe_17_expert_6 -->
<g id="edge517" class="edge">
<title>moe_17_route&#45;&gt;moe_17_expert_6</title>
<path fill="none" stroke="black" d="M1753.71,-40763.39C1720.12,-40751.74 1682.49,-40738.69 1649.94,-40727.4"/>
<polygon fill="black" stroke="black" points="1651.05,-40724.08 1640.45,-40724.11 1648.76,-40730.69 1651.05,-40724.08"/>
</g>
<!-- moe_17_expert_7 -->
<g id="node323" class="node">
<title>moe_17_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1913,-40723.98 1695,-40723.98 1695,-40671.98 1913,-40671.98 1913,-40723.98"/>
<text text-anchor="middle" x="1804" y="-40711.98" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1804" y="-40700.98" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1804" y="-40689.98" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1804" y="-40678.98" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_17_route&#45;&gt;moe_17_expert_7 -->
<g id="edge518" class="edge">
<title>moe_17_route&#45;&gt;moe_17_expert_7</title>
<path fill="none" stroke="black" d="M1831.11,-40759.99C1827.25,-40751.31 1823.13,-40742.04 1819.3,-40733.42"/>
<polygon fill="black" stroke="black" points="1822.39,-40731.74 1815.13,-40724.02 1815.99,-40734.58 1822.39,-40731.74"/>
</g>
<!-- moe_17_expert_8 -->
<g id="node324" class="node">
<title>moe_17_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2149,-40723.98 1931,-40723.98 1931,-40671.98 2149,-40671.98 2149,-40723.98"/>
<text text-anchor="middle" x="2040" y="-40711.98" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2040" y="-40700.98" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2040" y="-40689.98" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2040" y="-40678.98" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_17_route&#45;&gt;moe_17_expert_8 -->
<g id="edge519" class="edge">
<title>moe_17_route&#45;&gt;moe_17_expert_8</title>
<path fill="none" stroke="black" d="M1914.77,-40761.77C1936.35,-40750.95 1960.02,-40739.08 1980.93,-40728.6"/>
<polygon fill="black" stroke="black" points="1982.64,-40731.65 1990.01,-40724.04 1979.51,-40725.4 1982.64,-40731.65"/>
</g>
<!-- moe_17_expert_9 -->
<g id="node325" class="node">
<title>moe_17_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2385,-40723.98 2167,-40723.98 2167,-40671.98 2385,-40671.98 2385,-40723.98"/>
<text text-anchor="middle" x="2276" y="-40711.98" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2276" y="-40700.98" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2276" y="-40689.98" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2276" y="-40678.98" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_17_route&#45;&gt;moe_17_expert_9 -->
<g id="edge520" class="edge">
<title>moe_17_route&#45;&gt;moe_17_expert_9</title>
<path fill="none" stroke="black" d="M1974.84,-40766.91C2032.5,-40753.91 2100.2,-40738.64 2156.79,-40725.87"/>
<polygon fill="black" stroke="black" points="2157.87,-40729.21 2166.86,-40723.6 2156.33,-40722.39 2157.87,-40729.21"/>
</g>
<!-- moe_17_expert_10 -->
<g id="node326" class="node">
<title>moe_17_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2621,-40723.98 2403,-40723.98 2403,-40671.98 2621,-40671.98 2621,-40723.98"/>
<text text-anchor="middle" x="2512" y="-40711.98" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2512" y="-40700.98" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2512" y="-40689.98" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2512" y="-40678.98" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_17_route&#45;&gt;moe_17_expert_10 -->
<g id="edge521" class="edge">
<title>moe_17_route&#45;&gt;moe_17_expert_10</title>
<path fill="none" stroke="black" d="M2026.14,-40775.83C2130.49,-40763.36 2264.73,-40745.83 2392.77,-40724.14"/>
<polygon fill="black" stroke="black" points="2393.5,-40727.57 2402.77,-40722.44 2392.32,-40720.67 2393.5,-40727.57"/>
</g>
<!-- moe_17_expert_11 -->
<g id="node327" class="node">
<title>moe_17_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2857,-40723.98 2639,-40723.98 2639,-40671.98 2857,-40671.98 2857,-40723.98"/>
<text text-anchor="middle" x="2748" y="-40711.98" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2748" y="-40700.98" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2748" y="-40689.98" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2748" y="-40678.98" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_17_route&#45;&gt;moe_17_expert_11 -->
<g id="edge522" class="edge">
<title>moe_17_route&#45;&gt;moe_17_expert_11</title>
<path fill="none" stroke="black" d="M2050.58,-40783.66C2206.53,-40772.85 2427.05,-40754.19 2628.89,-40724.08"/>
<polygon fill="black" stroke="black" points="2629.42,-40727.54 2638.79,-40722.59 2628.38,-40720.61 2629.42,-40727.54"/>
</g>
<!-- moe_17_expert_12 -->
<g id="node328" class="node">
<title>moe_17_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3093,-40723.98 2875,-40723.98 2875,-40671.98 3093,-40671.98 3093,-40723.98"/>
<text text-anchor="middle" x="2984" y="-40711.98" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2984" y="-40700.98" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2984" y="-40689.98" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2984" y="-40678.98" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_17_route&#45;&gt;moe_17_expert_12 -->
<g id="edge523" class="edge">
<title>moe_17_route&#45;&gt;moe_17_expert_12</title>
<path fill="none" stroke="black" d="M2060.63,-40789.31C2265.01,-40781.14 2581.86,-40763.26 2864.75,-40724.07"/>
<polygon fill="black" stroke="black" points="2865.38,-40727.52 2874.8,-40722.67 2864.42,-40720.59 2865.38,-40727.52"/>
</g>
<!-- moe_17_expert_13 -->
<g id="node329" class="node">
<title>moe_17_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3329,-40723.98 3111,-40723.98 3111,-40671.98 3329,-40671.98 3329,-40723.98"/>
<text text-anchor="middle" x="3220" y="-40711.98" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3220" y="-40700.98" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3220" y="-40689.98" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3220" y="-40678.98" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_17_route&#45;&gt;moe_17_expert_13 -->
<g id="edge524" class="edge">
<title>moe_17_route&#45;&gt;moe_17_expert_13</title>
<path fill="none" stroke="black" d="M2063.91,-40793.31C2312.59,-40788.23 2732.28,-40772.69 3100.75,-40724.06"/>
<polygon fill="black" stroke="black" points="3101.36,-40727.51 3110.81,-40722.72 3100.44,-40720.57 3101.36,-40727.51"/>
</g>
<!-- moe_17_expert_14 -->
<g id="node330" class="node">
<title>moe_17_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3565,-40723.98 3347,-40723.98 3347,-40671.98 3565,-40671.98 3565,-40723.98"/>
<text text-anchor="middle" x="3456" y="-40711.98" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3456" y="-40700.98" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3456" y="-40689.98" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3456" y="-40678.98" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_17_route&#45;&gt;moe_17_expert_14 -->
<g id="edge525" class="edge">
<title>moe_17_route&#45;&gt;moe_17_expert_14</title>
<path fill="none" stroke="black" d="M2064.95,-40796.19C2354.11,-40794.3 2880.28,-40782.27 3336.72,-40724.05"/>
<polygon fill="black" stroke="black" points="3337.34,-40727.5 3346.81,-40722.76 3336.45,-40720.56 3337.34,-40727.5"/>
</g>
<!-- moe_17_expert_15 -->
<g id="node331" class="node">
<title>moe_17_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3801,-40723.98 3583,-40723.98 3583,-40671.98 3801,-40671.98 3801,-40723.98"/>
<text text-anchor="middle" x="3692" y="-40711.98" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3692" y="-40700.98" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3692" y="-40689.98" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3692" y="-40678.98" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_17_route&#45;&gt;moe_17_expert_15 -->
<g id="edge526" class="edge">
<title>moe_17_route&#45;&gt;moe_17_expert_15</title>
<path fill="none" stroke="black" d="M2062.48,-40791.3C2454.12,-40782.46 3269.41,-40760.47 3572.68,-40724.03"/>
<polygon fill="black" stroke="black" points="3573.32,-40727.48 3582.82,-40722.78 3572.47,-40720.53 3573.32,-40727.48"/>
</g>
<!-- moe_17_aggregate -->
<g id="node332" class="node">
<title>moe_17_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1859" cy="-40599.21" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1859" y="-40613.21" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1859" y="-40602.21" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1859" y="-40591.21" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1859" y="-40580.21" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_17_expert_0&#45;&gt;moe_17_aggregate -->
<g id="edge527" class="edge">
<title>moe_17_expert_0&#45;&gt;moe_17_aggregate</title>
<path fill="none" stroke="black" d="M261.18,-40673.19C264.15,-40672.76 267.09,-40672.35 270,-40671.98 525.67,-40639.35 1253.38,-40616.14 1628.77,-40605.97"/>
<polygon fill="black" stroke="black" points="1629.05,-40609.46 1638.95,-40605.7 1628.86,-40602.47 1629.05,-40609.46"/>
</g>
<!-- moe_17_expert_1&#45;&gt;moe_17_aggregate -->
<g id="edge528" class="edge">
<title>moe_17_expert_1&#45;&gt;moe_17_aggregate</title>
<path fill="none" stroke="black" d="M497.19,-40673.22C500.15,-40672.78 503.09,-40672.36 506,-40671.98 896.42,-40620.59 1354.82,-40605.72 1625.32,-40601.58"/>
<polygon fill="black" stroke="black" points="1625.72,-40605.08 1635.66,-40601.43 1625.61,-40598.08 1625.72,-40605.08"/>
</g>
<!-- moe_17_expert_2&#45;&gt;moe_17_aggregate -->
<g id="edge529" class="edge">
<title>moe_17_expert_2&#45;&gt;moe_17_aggregate</title>
<path fill="none" stroke="black" d="M733.19,-40673.27C736.16,-40672.81 739.1,-40672.38 742,-40671.98 1046.7,-40630.14 1401.59,-40612.6 1628.15,-40605.31"/>
<polygon fill="black" stroke="black" points="1628.28,-40608.81 1638.17,-40604.99 1628.06,-40601.81 1628.28,-40608.81"/>
</g>
<!-- moe_17_expert_3&#45;&gt;moe_17_aggregate -->
<g id="edge530" class="edge">
<title>moe_17_expert_3&#45;&gt;moe_17_aggregate</title>
<path fill="none" stroke="black" d="M969.2,-40673.33C972.16,-40672.86 975.1,-40672.4 978,-40671.98 1200.24,-40639.52 1456.32,-40620.72 1634.91,-40610.57"/>
<polygon fill="black" stroke="black" points="1635.17,-40614.06 1644.96,-40610 1634.78,-40607.07 1635.17,-40614.06"/>
</g>
<!-- moe_17_expert_4&#45;&gt;moe_17_aggregate -->
<g id="edge531" class="edge">
<title>moe_17_expert_4&#45;&gt;moe_17_aggregate</title>
<path fill="none" stroke="black" d="M1205.22,-40673.45C1208.17,-40672.94 1211.11,-40672.45 1214,-40671.98 1360.07,-40648.44 1526,-40630.16 1652.99,-40617.95"/>
<polygon fill="black" stroke="black" points="1653.6,-40621.41 1663.22,-40616.97 1652.93,-40614.44 1653.6,-40621.41"/>
</g>
<!-- moe_17_expert_5&#45;&gt;moe_17_aggregate -->
<g id="edge532" class="edge">
<title>moe_17_expert_5&#45;&gt;moe_17_aggregate</title>
<path fill="none" stroke="black" d="M1441.26,-40673.69C1444.21,-40673.11 1447.12,-40672.54 1450,-40671.98 1530.44,-40656.41 1620.06,-40640.52 1694.86,-40627.66"/>
<polygon fill="black" stroke="black" points="1695.58,-40631.09 1704.85,-40625.95 1694.4,-40624.19 1695.58,-40631.09"/>
</g>
<!-- moe_17_expert_6&#45;&gt;moe_17_aggregate -->
<g id="edge533" class="edge">
<title>moe_17_expert_6&#45;&gt;moe_17_aggregate</title>
<path fill="none" stroke="black" d="M1643.32,-40671.93C1676.63,-40660.86 1716.4,-40647.63 1752.66,-40635.57"/>
<polygon fill="black" stroke="black" points="1753.91,-40638.85 1762.29,-40632.37 1751.7,-40632.2 1753.91,-40638.85"/>
</g>
<!-- moe_17_expert_7&#45;&gt;moe_17_aggregate -->
<g id="edge534" class="edge">
<title>moe_17_expert_7&#45;&gt;moe_17_aggregate</title>
<path fill="none" stroke="black" d="M1818.31,-40671.81C1822.99,-40663.57 1828.33,-40654.17 1833.58,-40644.94"/>
<polygon fill="black" stroke="black" points="1836.65,-40646.61 1838.55,-40636.19 1830.57,-40643.15 1836.65,-40646.61"/>
</g>
<!-- moe_17_expert_8&#45;&gt;moe_17_aggregate -->
<g id="edge535" class="edge">
<title>moe_17_expert_8&#45;&gt;moe_17_aggregate</title>
<path fill="none" stroke="black" d="M1992.92,-40671.81C1974.39,-40661.91 1952.69,-40650.3 1932.22,-40639.36"/>
<polygon fill="black" stroke="black" points="1933.69,-40636.17 1923.22,-40634.55 1930.39,-40642.35 1933.69,-40636.17"/>
</g>
<!-- moe_17_expert_9&#45;&gt;moe_17_aggregate -->
<g id="edge536" class="edge">
<title>moe_17_expert_9&#45;&gt;moe_17_aggregate</title>
<path fill="none" stroke="black" d="M2168.07,-40671.93C2115.48,-40659.73 2051.67,-40644.92 1995.72,-40631.94"/>
<polygon fill="black" stroke="black" points="1996.26,-40628.47 1985.73,-40629.62 1994.68,-40635.29 1996.26,-40628.47"/>
</g>
<!-- moe_17_expert_10&#45;&gt;moe_17_aggregate -->
<g id="edge537" class="edge">
<title>moe_17_expert_10&#45;&gt;moe_17_aggregate</title>
<path fill="none" stroke="black" d="M2402.76,-40673.53C2399.81,-40673 2396.89,-40672.48 2394,-40671.98 2280.16,-40652.31 2151.91,-40634.95 2049.52,-40622.22"/>
<polygon fill="black" stroke="black" points="2049.73,-40618.72 2039.38,-40620.97 2048.87,-40625.67 2049.73,-40618.72"/>
</g>
<!-- moe_17_expert_11&#45;&gt;moe_17_aggregate -->
<g id="edge538" class="edge">
<title>moe_17_expert_11&#45;&gt;moe_17_aggregate</title>
<path fill="none" stroke="black" d="M2638.79,-40673.38C2635.83,-40672.89 2632.9,-40672.42 2630,-40671.98 2444.19,-40643.75 2231.38,-40624.95 2076.48,-40613.7"/>
<polygon fill="black" stroke="black" points="2076.59,-40610.19 2066.36,-40612.97 2076.09,-40617.18 2076.59,-40610.19"/>
</g>
<!-- moe_17_expert_12&#45;&gt;moe_17_aggregate -->
<g id="edge539" class="edge">
<title>moe_17_expert_12&#45;&gt;moe_17_aggregate</title>
<path fill="none" stroke="black" d="M2874.8,-40673.29C2871.84,-40672.83 2868.9,-40672.39 2866,-40671.98 2600.39,-40634.56 2292.46,-40616.23 2087.74,-40607.54"/>
<polygon fill="black" stroke="black" points="2087.6,-40604.03 2077.46,-40607.11 2087.31,-40611.03 2087.6,-40604.03"/>
</g>
<!-- moe_17_expert_13&#45;&gt;moe_17_aggregate -->
<g id="edge540" class="edge">
<title>moe_17_expert_13&#45;&gt;moe_17_aggregate</title>
<path fill="none" stroke="black" d="M3110.81,-40673.24C3107.85,-40672.79 3104.91,-40672.37 3102,-40671.98 2751.88,-40625.06 2342.23,-40608.8 2091.73,-40603.17"/>
<polygon fill="black" stroke="black" points="2091.49,-40599.66 2081.41,-40602.94 2091.33,-40606.66 2091.49,-40599.66"/>
</g>
<!-- moe_17_expert_14&#45;&gt;moe_17_aggregate -->
<g id="edge541" class="edge">
<title>moe_17_expert_14&#45;&gt;moe_17_aggregate</title>
<path fill="none" stroke="black" d="M3346.81,-40673.2C3343.85,-40672.77 3340.91,-40672.36 3338,-40671.98 2900.69,-40615.42 2385.41,-40602.43 2092.98,-40600.02"/>
<polygon fill="black" stroke="black" points="2092.7,-40596.52 2082.67,-40599.94 2092.65,-40603.52 2092.7,-40596.52"/>
</g>
<!-- moe_17_expert_15&#45;&gt;moe_17_aggregate -->
<g id="edge542" class="edge">
<title>moe_17_expert_15&#45;&gt;moe_17_aggregate</title>
<path fill="none" stroke="black" d="M3582.82,-40673.18C3579.85,-40672.75 3576.91,-40672.35 3574,-40671.98 3294.05,-40636.72 2489.85,-40614.35 2090.18,-40605.1"/>
<polygon fill="black" stroke="black" points="2090.01,-40601.59 2079.93,-40604.86 2089.85,-40608.59 2090.01,-40601.59"/>
</g>
<!-- moe_17_ffn -->
<g id="node333" class="node">
<title>moe_17_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2017,-40526.44 1701,-40526.44 1701,-40474.44 2017,-40474.44 2017,-40526.44"/>
<text text-anchor="middle" x="1859" y="-40514.44" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1859" y="-40503.44" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1859" y="-40492.44" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1859" y="-40481.44" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_17_aggregate&#45;&gt;moe_17_ffn -->
<g id="edge543" class="edge">
<title>moe_17_aggregate&#45;&gt;moe_17_ffn</title>
<path fill="none" stroke="black" d="M1859,-40562.18C1859,-40553.87 1859,-40545.03 1859,-40536.75"/>
<polygon fill="black" stroke="black" points="1862.5,-40536.64 1859,-40526.64 1855.5,-40536.64 1862.5,-40536.64"/>
</g>
<!-- moe_17_res2 -->
<g id="node335" class="node">
<title>moe_17_res2</title>
<polygon fill="lightyellow" stroke="black" points="2195.89,-40438.44 1659.97,-40438.44 1522.11,-40334.44 2058.03,-40334.44 2195.89,-40438.44"/>
<text text-anchor="middle" x="1859" y="-40400.44" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1859" y="-40389.44" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1859" y="-40378.44" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1859" y="-40367.44" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_17_ffn&#45;&gt;moe_17_res2 -->
<g id="edge544" class="edge">
<title>moe_17_ffn&#45;&gt;moe_17_res2</title>
<path fill="none" stroke="black" d="M1859,-40474.31C1859,-40466.62 1859,-40457.81 1859,-40448.81"/>
<polygon fill="black" stroke="black" points="1862.5,-40448.62 1859,-40438.62 1855.5,-40448.62 1862.5,-40448.62"/>
</g>
<!-- moe_17_res1&#45;&gt;moe_17_gate -->
<g id="edge509" class="edge">
<title>moe_17_res1&#45;&gt;moe_17_gate</title>
<path fill="none" stroke="black" d="M1847,-41009.13C1847,-41000.96 1847,-40992.44 1847,-40984.06"/>
<polygon fill="black" stroke="black" points="1850.5,-40983.95 1847,-40973.95 1843.5,-40983.95 1850.5,-40983.95"/>
</g>
<!-- moe_18_mha -->
<g id="node336" class="node">
<title>moe_18_mha</title>
<polygon fill="lightgreen" stroke="black" points="2017,-40287.44 1701,-40287.44 1701,-40235.44 2017,-40235.44 2017,-40287.44"/>
<text text-anchor="middle" x="1859" y="-40275.44" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1859" y="-40264.44" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1859" y="-40253.44" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1859" y="-40242.44" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_17_res2&#45;&gt;moe_18_mha -->
<g id="edge545" class="edge">
<title>moe_17_res2&#45;&gt;moe_18_mha</title>
<path fill="none" stroke="black" d="M1859,-40334.35C1859,-40322.02 1859,-40309.11 1859,-40297.69"/>
<polygon fill="black" stroke="black" points="1862.5,-40297.68 1859,-40287.68 1855.5,-40297.68 1862.5,-40297.68"/>
</g>
<!-- moe_18_res1 -->
<g id="node357" class="node">
<title>moe_18_res1</title>
<polygon fill="lightyellow" stroke="black" points="2195.89,-40199.44 1659.97,-40199.44 1522.11,-40095.44 2058.03,-40095.44 2195.89,-40199.44"/>
<text text-anchor="middle" x="1859" y="-40161.44" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1859" y="-40150.44" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1859" y="-40139.44" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1859" y="-40128.44" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_18_mha&#45;&gt;moe_18_res1 -->
<g id="edge546" class="edge">
<title>moe_18_mha&#45;&gt;moe_18_res1</title>
<path fill="none" stroke="black" d="M1859,-40235.31C1859,-40227.62 1859,-40218.81 1859,-40209.81"/>
<polygon fill="black" stroke="black" points="1862.5,-40209.62 1859,-40199.62 1855.5,-40209.62 1862.5,-40209.62"/>
</g>
<!-- moe_18_gate -->
<g id="node337" class="node">
<title>moe_18_gate</title>
<polygon fill="lightyellow" stroke="black" points="2187.8,-40059.44 1664.75,-40059.44 1530.2,-39955.44 2053.25,-39955.44 2187.8,-40059.44"/>
<text text-anchor="middle" x="1859" y="-40021.44" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1859" y="-40010.44" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1859" y="-39999.44" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1859" y="-39988.44" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_18_route -->
<g id="node338" class="node">
<title>moe_18_route</title>
<ellipse fill="lightblue" stroke="black" cx="1859" cy="-39882.67" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1859" y="-39896.67" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1859" y="-39885.67" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1859" y="-39874.67" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1859" y="-39863.67" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_18_gate&#45;&gt;moe_18_route -->
<g id="edge548" class="edge">
<title>moe_18_gate&#45;&gt;moe_18_route</title>
<path fill="none" stroke="black" d="M1859,-39955.09C1859,-39946.68 1859,-39938.01 1859,-39929.74"/>
<polygon fill="black" stroke="black" points="1862.5,-39929.53 1859,-39919.53 1855.5,-39929.53 1862.5,-39929.53"/>
</g>
<!-- moe_18_expert_0 -->
<g id="node339" class="node">
<title>moe_18_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="275,-39809.9 57,-39809.9 57,-39757.9 275,-39757.9 275,-39809.9"/>
<text text-anchor="middle" x="166" y="-39797.9" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="166" y="-39786.9" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="166" y="-39775.9" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="166" y="-39764.9" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_18_route&#45;&gt;moe_18_expert_0 -->
<g id="edge549" class="edge">
<title>moe_18_route&#45;&gt;moe_18_expert_0</title>
<path fill="none" stroke="black" d="M1644.55,-39876.24C1281.26,-39866.31 558.5,-39843.28 285.11,-39809.93"/>
<polygon fill="black" stroke="black" points="285.54,-39806.46 275.18,-39808.69 284.67,-39813.4 285.54,-39806.46"/>
</g>
<!-- moe_18_expert_1 -->
<g id="node340" class="node">
<title>moe_18_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="511,-39809.9 293,-39809.9 293,-39757.9 511,-39757.9 511,-39809.9"/>
<text text-anchor="middle" x="402" y="-39797.9" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="402" y="-39786.9" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="402" y="-39775.9" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="402" y="-39764.9" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_18_route&#45;&gt;moe_18_expert_1 -->
<g id="edge550" class="edge">
<title>moe_18_route&#45;&gt;moe_18_expert_1</title>
<path fill="none" stroke="black" d="M1641.5,-39880.36C1377.99,-39876.41 920.75,-39862 521.21,-39809.97"/>
<polygon fill="black" stroke="black" points="521.56,-39806.49 511.19,-39808.66 520.65,-39813.43 521.56,-39806.49"/>
</g>
<!-- moe_18_expert_2 -->
<g id="node341" class="node">
<title>moe_18_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="747,-39809.9 529,-39809.9 529,-39757.9 747,-39757.9 747,-39809.9"/>
<text text-anchor="middle" x="638" y="-39797.9" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="638" y="-39786.9" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="638" y="-39775.9" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="638" y="-39764.9" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_18_route&#45;&gt;moe_18_expert_2 -->
<g id="edge551" class="edge">
<title>moe_18_route&#45;&gt;moe_18_expert_2</title>
<path fill="none" stroke="black" d="M1643.79,-39876.81C1423.2,-39869.72 1070.34,-39852.52 757.37,-39810.01"/>
<polygon fill="black" stroke="black" points="757.58,-39806.5 747.19,-39808.61 756.63,-39813.44 757.58,-39806.5"/>
</g>
<!-- moe_18_expert_3 -->
<g id="node342" class="node">
<title>moe_18_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="983,-39809.9 765,-39809.9 765,-39757.9 983,-39757.9 983,-39809.9"/>
<text text-anchor="middle" x="874" y="-39797.9" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="874" y="-39786.9" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="874" y="-39775.9" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="874" y="-39764.9" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_18_route&#45;&gt;moe_18_expert_3 -->
<g id="edge552" class="edge">
<title>moe_18_route&#45;&gt;moe_18_expert_3</title>
<path fill="none" stroke="black" d="M1650.57,-39871.81C1476.92,-39861.86 1223.09,-39843.27 993.1,-39809.99"/>
<polygon fill="black" stroke="black" points="993.6,-39806.53 983.2,-39808.55 992.59,-39813.45 993.6,-39806.53"/>
</g>
<!-- moe_18_expert_4 -->
<g id="node343" class="node">
<title>moe_18_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1219,-39809.9 1001,-39809.9 1001,-39757.9 1219,-39757.9 1219,-39809.9"/>
<text text-anchor="middle" x="1110" y="-39797.9" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1110" y="-39786.9" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1110" y="-39775.9" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1110" y="-39764.9" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_18_route&#45;&gt;moe_18_expert_4 -->
<g id="edge553" class="edge">
<title>moe_18_route&#45;&gt;moe_18_expert_4</title>
<path fill="none" stroke="black" d="M1668.52,-39864.79C1545.68,-39852.75 1382.38,-39834.61 1229.29,-39810.05"/>
<polygon fill="black" stroke="black" points="1229.65,-39806.57 1219.22,-39808.43 1228.54,-39813.48 1229.65,-39806.57"/>
</g>
<!-- moe_18_expert_5 -->
<g id="node344" class="node">
<title>moe_18_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1455,-39809.9 1237,-39809.9 1237,-39757.9 1455,-39757.9 1455,-39809.9"/>
<text text-anchor="middle" x="1346" y="-39797.9" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1346" y="-39786.9" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1346" y="-39775.9" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1346" y="-39764.9" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_18_route&#45;&gt;moe_18_expert_5 -->
<g id="edge554" class="edge">
<title>moe_18_route&#45;&gt;moe_18_expert_5</title>
<path fill="none" stroke="black" d="M1710.16,-39855.68C1638.82,-39842.97 1551.93,-39827.11 1465.28,-39810.14"/>
<polygon fill="black" stroke="black" points="1465.76,-39806.66 1455.27,-39808.17 1464.41,-39813.53 1465.76,-39806.66"/>
</g>
<!-- moe_18_expert_6 -->
<g id="node345" class="node">
<title>moe_18_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1691,-39809.9 1473,-39809.9 1473,-39757.9 1691,-39757.9 1691,-39809.9"/>
<text text-anchor="middle" x="1582" y="-39797.9" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1582" y="-39786.9" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1582" y="-39775.9" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1582" y="-39764.9" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_18_route&#45;&gt;moe_18_expert_6 -->
<g id="edge555" class="edge">
<title>moe_18_route&#45;&gt;moe_18_expert_6</title>
<path fill="none" stroke="black" d="M1766.38,-39849.31C1733.17,-39837.71 1695.99,-39824.72 1663.77,-39813.47"/>
<polygon fill="black" stroke="black" points="1664.53,-39810.03 1653.93,-39810.03 1662.22,-39816.63 1664.53,-39810.03"/>
</g>
<!-- moe_18_expert_7 -->
<g id="node346" class="node">
<title>moe_18_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1927,-39809.9 1709,-39809.9 1709,-39757.9 1927,-39757.9 1927,-39809.9"/>
<text text-anchor="middle" x="1818" y="-39797.9" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1818" y="-39786.9" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1818" y="-39775.9" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1818" y="-39764.9" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_18_route&#45;&gt;moe_18_expert_7 -->
<g id="edge556" class="edge">
<title>moe_18_route&#45;&gt;moe_18_expert_7</title>
<path fill="none" stroke="black" d="M1843.85,-39845.91C1840.17,-39837.23 1836.24,-39827.96 1832.59,-39819.34"/>
<polygon fill="black" stroke="black" points="1835.73,-39817.79 1828.61,-39809.95 1829.29,-39820.52 1835.73,-39817.79"/>
</g>
<!-- moe_18_expert_8 -->
<g id="node347" class="node">
<title>moe_18_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2163,-39809.9 1945,-39809.9 1945,-39757.9 2163,-39757.9 2163,-39809.9"/>
<text text-anchor="middle" x="2054" y="-39797.9" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2054" y="-39786.9" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2054" y="-39775.9" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2054" y="-39764.9" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_18_route&#45;&gt;moe_18_expert_8 -->
<g id="edge557" class="edge">
<title>moe_18_route&#45;&gt;moe_18_expert_8</title>
<path fill="none" stroke="black" d="M1927.48,-39847.69C1949.27,-39836.87 1973.2,-39825 1994.32,-39814.52"/>
<polygon fill="black" stroke="black" points="1996.09,-39817.55 2003.5,-39809.97 1992.98,-39811.28 1996.09,-39817.55"/>
</g>
<!-- moe_18_expert_9 -->
<g id="node348" class="node">
<title>moe_18_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2399,-39809.9 2181,-39809.9 2181,-39757.9 2399,-39757.9 2399,-39809.9"/>
<text text-anchor="middle" x="2290" y="-39797.9" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2290" y="-39786.9" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2290" y="-39775.9" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2290" y="-39764.9" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_18_route&#45;&gt;moe_18_expert_9 -->
<g id="edge558" class="edge">
<title>moe_18_route&#45;&gt;moe_18_expert_9</title>
<path fill="none" stroke="black" d="M1987.15,-39852.9C2045.44,-39839.81 2113.99,-39824.42 2171.12,-39811.59"/>
<polygon fill="black" stroke="black" points="2171.93,-39815 2180.92,-39809.39 2170.39,-39808.17 2171.93,-39815"/>
</g>
<!-- moe_18_expert_10 -->
<g id="node349" class="node">
<title>moe_18_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2635,-39809.9 2417,-39809.9 2417,-39757.9 2635,-39757.9 2635,-39809.9"/>
<text text-anchor="middle" x="2526" y="-39797.9" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2526" y="-39786.9" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2526" y="-39775.9" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2526" y="-39764.9" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_18_route&#45;&gt;moe_18_expert_10 -->
<g id="edge559" class="edge">
<title>moe_18_route&#45;&gt;moe_18_expert_10</title>
<path fill="none" stroke="black" d="M2038.48,-39861.83C2143.26,-39849.37 2278.13,-39831.82 2406.73,-39810.07"/>
<polygon fill="black" stroke="black" points="2407.5,-39813.49 2416.77,-39808.36 2406.32,-39806.59 2407.5,-39813.49"/>
</g>
<!-- moe_18_expert_11 -->
<g id="node350" class="node">
<title>moe_18_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2871,-39809.9 2653,-39809.9 2653,-39757.9 2871,-39757.9 2871,-39809.9"/>
<text text-anchor="middle" x="2762" y="-39797.9" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2762" y="-39786.9" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2762" y="-39775.9" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2762" y="-39764.9" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_18_route&#45;&gt;moe_18_expert_11 -->
<g id="edge560" class="edge">
<title>moe_18_route&#45;&gt;moe_18_expert_11</title>
<path fill="none" stroke="black" d="M2062.69,-39869.64C2219.06,-39858.85 2440.36,-39840.19 2642.86,-39810"/>
<polygon fill="black" stroke="black" points="2643.42,-39813.46 2652.79,-39808.51 2642.38,-39806.54 2643.42,-39813.46"/>
</g>
<!-- moe_18_expert_12 -->
<g id="node351" class="node">
<title>moe_18_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3107,-39809.9 2889,-39809.9 2889,-39757.9 3107,-39757.9 3107,-39809.9"/>
<text text-anchor="middle" x="2998" y="-39797.9" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2998" y="-39786.9" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2998" y="-39775.9" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2998" y="-39764.9" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_18_route&#45;&gt;moe_18_expert_12 -->
<g id="edge561" class="edge">
<title>moe_18_route&#45;&gt;moe_18_expert_12</title>
<path fill="none" stroke="black" d="M2072.56,-39875.27C2277.32,-39867.13 2595.08,-39849.27 2878.73,-39810"/>
<polygon fill="black" stroke="black" points="2879.38,-39813.44 2888.8,-39808.59 2878.42,-39806.51 2879.38,-39813.44"/>
</g>
<!-- moe_18_expert_13 -->
<g id="node352" class="node">
<title>moe_18_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3343,-39809.9 3125,-39809.9 3125,-39757.9 3343,-39757.9 3343,-39809.9"/>
<text text-anchor="middle" x="3234" y="-39797.9" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3234" y="-39786.9" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3234" y="-39775.9" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3234" y="-39764.9" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_18_route&#45;&gt;moe_18_expert_13 -->
<g id="edge562" class="edge">
<title>moe_18_route&#45;&gt;moe_18_expert_13</title>
<path fill="none" stroke="black" d="M2075.98,-39879.26C2325.01,-39874.21 2745.55,-39858.69 3114.73,-39809.98"/>
<polygon fill="black" stroke="black" points="3115.36,-39813.43 3124.81,-39808.64 3114.44,-39806.49 3115.36,-39813.43"/>
</g>
<!-- moe_18_expert_14 -->
<g id="node353" class="node">
<title>moe_18_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3579,-39809.9 3361,-39809.9 3361,-39757.9 3579,-39757.9 3579,-39809.9"/>
<text text-anchor="middle" x="3470" y="-39797.9" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3470" y="-39786.9" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3470" y="-39775.9" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3470" y="-39764.9" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_18_route&#45;&gt;moe_18_expert_14 -->
<g id="edge563" class="edge">
<title>moe_18_route&#45;&gt;moe_18_expert_14</title>
<path fill="none" stroke="black" d="M2076.93,-39882.13C2366.41,-39880.27 2893.5,-39868.27 3350.71,-39809.98"/>
<polygon fill="black" stroke="black" points="3351.34,-39813.42 3360.81,-39808.68 3350.45,-39806.48 3351.34,-39813.42"/>
</g>
<!-- moe_18_expert_15 -->
<g id="node354" class="node">
<title>moe_18_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3815,-39809.9 3597,-39809.9 3597,-39757.9 3815,-39757.9 3815,-39809.9"/>
<text text-anchor="middle" x="3706" y="-39797.9" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3706" y="-39786.9" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3706" y="-39775.9" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3706" y="-39764.9" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_18_route&#45;&gt;moe_18_expert_15 -->
<g id="edge564" class="edge">
<title>moe_18_route&#45;&gt;moe_18_expert_15</title>
<path fill="none" stroke="black" d="M2074.73,-39877.22C2466.82,-39868.4 3283.06,-39846.42 3586.67,-39809.95"/>
<polygon fill="black" stroke="black" points="3587.32,-39813.4 3596.82,-39808.71 3586.47,-39806.45 3587.32,-39813.4"/>
</g>
<!-- moe_18_aggregate -->
<g id="node355" class="node">
<title>moe_18_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1936" cy="-39685.13" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1936" y="-39699.13" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1936" y="-39688.13" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1936" y="-39677.13" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1936" y="-39666.13" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_18_expert_0&#45;&gt;moe_18_aggregate -->
<g id="edge565" class="edge">
<title>moe_18_expert_0&#45;&gt;moe_18_aggregate</title>
<path fill="none" stroke="black" d="M275.18,-39759.11C278.15,-39758.67 281.09,-39758.27 284,-39757.9 551.74,-39723.96 1317.32,-39701.16 1705.04,-39691.45"/>
<polygon fill="black" stroke="black" points="1705.35,-39694.94 1715.26,-39691.19 1705.17,-39687.94 1705.35,-39694.94"/>
</g>
<!-- moe_18_expert_1&#45;&gt;moe_18_aggregate -->
<g id="edge566" class="edge">
<title>moe_18_expert_1&#45;&gt;moe_18_aggregate</title>
<path fill="none" stroke="black" d="M511.19,-39759.13C514.15,-39758.69 517.09,-39758.28 520,-39757.9 933.79,-39703.93 1420.51,-39689.97 1702.11,-39686.69"/>
<polygon fill="black" stroke="black" points="1702.49,-39690.19 1712.45,-39686.57 1702.41,-39683.19 1702.49,-39690.19"/>
</g>
<!-- moe_18_expert_2&#45;&gt;moe_18_aggregate -->
<g id="edge567" class="edge">
<title>moe_18_expert_2&#45;&gt;moe_18_aggregate</title>
<path fill="none" stroke="black" d="M747.19,-39759.17C750.15,-39758.72 753.09,-39758.3 756,-39757.9 1083.31,-39713.52 1465.45,-39696.58 1704.11,-39690.11"/>
<polygon fill="black" stroke="black" points="1704.4,-39693.61 1714.31,-39689.84 1704.22,-39686.61 1704.4,-39693.61"/>
</g>
<!-- moe_18_expert_3&#45;&gt;moe_18_aggregate -->
<g id="edge568" class="edge">
<title>moe_18_expert_3&#45;&gt;moe_18_aggregate</title>
<path fill="none" stroke="black" d="M983.2,-39759.23C986.16,-39758.76 989.1,-39758.32 992,-39757.9 1235.76,-39722.97 1517.52,-39704.35 1709.32,-39694.9"/>
<polygon fill="black" stroke="black" points="1709.71,-39698.39 1719.53,-39694.41 1709.37,-39691.4 1709.71,-39698.39"/>
</g>
<!-- moe_18_expert_4&#45;&gt;moe_18_aggregate -->
<g id="edge569" class="edge">
<title>moe_18_expert_4&#45;&gt;moe_18_aggregate</title>
<path fill="none" stroke="black" d="M1219.21,-39759.33C1222.17,-39758.83 1225.1,-39758.35 1228,-39757.9 1393.7,-39732.03 1582.73,-39713.41 1723.77,-39701.64"/>
<polygon fill="black" stroke="black" points="1724.17,-39705.12 1733.84,-39700.8 1723.59,-39698.14 1724.17,-39705.12"/>
</g>
<!-- moe_18_expert_5&#45;&gt;moe_18_aggregate -->
<g id="edge570" class="edge">
<title>moe_18_expert_5&#45;&gt;moe_18_aggregate</title>
<path fill="none" stroke="black" d="M1455.25,-39759.52C1458.19,-39758.97 1461.12,-39758.43 1464,-39757.9 1560.58,-39740.34 1668.83,-39723.67 1757.27,-39710.82"/>
<polygon fill="black" stroke="black" points="1758.01,-39714.25 1767.4,-39709.35 1757,-39707.32 1758.01,-39714.25"/>
</g>
<!-- moe_18_expert_6&#45;&gt;moe_18_aggregate -->
<g id="edge571" class="edge">
<title>moe_18_expert_6&#45;&gt;moe_18_aggregate</title>
<path fill="none" stroke="black" d="M1673.62,-39757.86C1716.27,-39746.2 1767.62,-39732.16 1813.54,-39719.61"/>
<polygon fill="black" stroke="black" points="1814.53,-39722.97 1823.25,-39716.95 1812.68,-39716.21 1814.53,-39722.97"/>
</g>
<!-- moe_18_expert_7&#45;&gt;moe_18_aggregate -->
<g id="edge572" class="edge">
<title>moe_18_expert_7&#45;&gt;moe_18_aggregate</title>
<path fill="none" stroke="black" d="M1848.7,-39757.73C1859.79,-39748.63 1872.63,-39738.1 1884.99,-39727.96"/>
<polygon fill="black" stroke="black" points="1887.51,-39730.43 1893.02,-39721.38 1883.07,-39725.01 1887.51,-39730.43"/>
</g>
<!-- moe_18_expert_8&#45;&gt;moe_18_aggregate -->
<g id="edge573" class="edge">
<title>moe_18_expert_8&#45;&gt;moe_18_aggregate</title>
<path fill="none" stroke="black" d="M2023.3,-39757.73C2012.21,-39748.63 1999.37,-39738.1 1987.01,-39727.96"/>
<polygon fill="black" stroke="black" points="1988.93,-39725.01 1978.98,-39721.38 1984.49,-39730.43 1988.93,-39725.01"/>
</g>
<!-- moe_18_expert_9&#45;&gt;moe_18_aggregate -->
<g id="edge574" class="edge">
<title>moe_18_expert_9&#45;&gt;moe_18_aggregate</title>
<path fill="none" stroke="black" d="M2198.38,-39757.86C2155.73,-39746.2 2104.38,-39732.16 2058.46,-39719.61"/>
<polygon fill="black" stroke="black" points="2059.32,-39716.21 2048.75,-39716.95 2057.47,-39722.97 2059.32,-39716.21"/>
</g>
<!-- moe_18_expert_10&#45;&gt;moe_18_aggregate -->
<g id="edge575" class="edge">
<title>moe_18_expert_10&#45;&gt;moe_18_aggregate</title>
<path fill="none" stroke="black" d="M2416.75,-39759.52C2413.81,-39758.97 2410.88,-39758.43 2408,-39757.9 2311.42,-39740.34 2203.17,-39723.67 2114.73,-39710.82"/>
<polygon fill="black" stroke="black" points="2115,-39707.32 2104.6,-39709.35 2113.99,-39714.25 2115,-39707.32"/>
</g>
<!-- moe_18_expert_11&#45;&gt;moe_18_aggregate -->
<g id="edge576" class="edge">
<title>moe_18_expert_11&#45;&gt;moe_18_aggregate</title>
<path fill="none" stroke="black" d="M2652.79,-39759.33C2649.83,-39758.83 2646.9,-39758.35 2644,-39757.9 2478.3,-39732.03 2289.27,-39713.41 2148.23,-39701.64"/>
<polygon fill="black" stroke="black" points="2148.41,-39698.14 2138.16,-39700.8 2147.83,-39705.12 2148.41,-39698.14"/>
</g>
<!-- moe_18_expert_12&#45;&gt;moe_18_aggregate -->
<g id="edge577" class="edge">
<title>moe_18_expert_12&#45;&gt;moe_18_aggregate</title>
<path fill="none" stroke="black" d="M2888.8,-39759.23C2885.84,-39758.76 2882.9,-39758.32 2880,-39757.9 2636.24,-39722.97 2354.48,-39704.35 2162.68,-39694.9"/>
<polygon fill="black" stroke="black" points="2162.63,-39691.4 2152.47,-39694.41 2162.29,-39698.39 2162.63,-39691.4"/>
</g>
<!-- moe_18_expert_13&#45;&gt;moe_18_aggregate -->
<g id="edge578" class="edge">
<title>moe_18_expert_13&#45;&gt;moe_18_aggregate</title>
<path fill="none" stroke="black" d="M3124.81,-39759.17C3121.85,-39758.72 3118.91,-39758.3 3116,-39757.9 2788.69,-39713.52 2406.55,-39696.58 2167.89,-39690.11"/>
<polygon fill="black" stroke="black" points="2167.78,-39686.61 2157.69,-39689.84 2167.6,-39693.61 2167.78,-39686.61"/>
</g>
<!-- moe_18_expert_14&#45;&gt;moe_18_aggregate -->
<g id="edge579" class="edge">
<title>moe_18_expert_14&#45;&gt;moe_18_aggregate</title>
<path fill="none" stroke="black" d="M3360.81,-39759.13C3357.85,-39758.69 3354.91,-39758.28 3352,-39757.9 2938.21,-39703.93 2451.49,-39689.97 2169.89,-39686.69"/>
<polygon fill="black" stroke="black" points="2169.59,-39683.19 2159.55,-39686.57 2169.51,-39690.19 2169.59,-39683.19"/>
</g>
<!-- moe_18_expert_15&#45;&gt;moe_18_aggregate -->
<g id="edge580" class="edge">
<title>moe_18_expert_15&#45;&gt;moe_18_aggregate</title>
<path fill="none" stroke="black" d="M3596.82,-39759.11C3593.85,-39758.67 3590.91,-39758.27 3588,-39757.9 3320.26,-39723.96 2554.68,-39701.16 2166.96,-39691.45"/>
<polygon fill="black" stroke="black" points="2166.83,-39687.94 2156.74,-39691.19 2166.65,-39694.94 2166.83,-39687.94"/>
</g>
<!-- moe_18_ffn -->
<g id="node356" class="node">
<title>moe_18_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2094,-39612.36 1778,-39612.36 1778,-39560.36 2094,-39560.36 2094,-39612.36"/>
<text text-anchor="middle" x="1936" y="-39600.36" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1936" y="-39589.36" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1936" y="-39578.36" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1936" y="-39567.36" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_18_aggregate&#45;&gt;moe_18_ffn -->
<g id="edge581" class="edge">
<title>moe_18_aggregate&#45;&gt;moe_18_ffn</title>
<path fill="none" stroke="black" d="M1936,-39648.1C1936,-39639.79 1936,-39630.95 1936,-39622.67"/>
<polygon fill="black" stroke="black" points="1939.5,-39622.56 1936,-39612.56 1932.5,-39622.56 1939.5,-39622.56"/>
</g>
<!-- moe_18_res2 -->
<g id="node358" class="node">
<title>moe_18_res2</title>
<polygon fill="lightyellow" stroke="black" points="2272.89,-39524.36 1736.97,-39524.36 1599.11,-39420.36 2135.03,-39420.36 2272.89,-39524.36"/>
<text text-anchor="middle" x="1936" y="-39486.36" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1936" y="-39475.36" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1936" y="-39464.36" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1936" y="-39453.36" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_18_ffn&#45;&gt;moe_18_res2 -->
<g id="edge582" class="edge">
<title>moe_18_ffn&#45;&gt;moe_18_res2</title>
<path fill="none" stroke="black" d="M1936,-39560.23C1936,-39552.54 1936,-39543.73 1936,-39534.73"/>
<polygon fill="black" stroke="black" points="1939.5,-39534.54 1936,-39524.54 1932.5,-39534.54 1939.5,-39534.54"/>
</g>
<!-- moe_18_res1&#45;&gt;moe_18_gate -->
<g id="edge547" class="edge">
<title>moe_18_res1&#45;&gt;moe_18_gate</title>
<path fill="none" stroke="black" d="M1859,-40095.06C1859,-40086.88 1859,-40078.36 1859,-40069.98"/>
<polygon fill="black" stroke="black" points="1862.5,-40069.87 1859,-40059.87 1855.5,-40069.87 1862.5,-40069.87"/>
</g>
<!-- moe_19_mha -->
<g id="node359" class="node">
<title>moe_19_mha</title>
<polygon fill="lightgreen" stroke="black" points="2094,-39373.36 1778,-39373.36 1778,-39321.36 2094,-39321.36 2094,-39373.36"/>
<text text-anchor="middle" x="1936" y="-39361.36" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1936" y="-39350.36" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1936" y="-39339.36" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1936" y="-39328.36" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_18_res2&#45;&gt;moe_19_mha -->
<g id="edge583" class="edge">
<title>moe_18_res2&#45;&gt;moe_19_mha</title>
<path fill="none" stroke="black" d="M1936,-39420.27C1936,-39407.94 1936,-39395.03 1936,-39383.61"/>
<polygon fill="black" stroke="black" points="1939.5,-39383.6 1936,-39373.6 1932.5,-39383.6 1939.5,-39383.6"/>
</g>
<!-- moe_19_res1 -->
<g id="node380" class="node">
<title>moe_19_res1</title>
<polygon fill="lightyellow" stroke="black" points="2272.89,-39285.36 1736.97,-39285.36 1599.11,-39181.36 2135.03,-39181.36 2272.89,-39285.36"/>
<text text-anchor="middle" x="1936" y="-39247.36" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1936" y="-39236.36" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1936" y="-39225.36" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1936" y="-39214.36" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_19_mha&#45;&gt;moe_19_res1 -->
<g id="edge584" class="edge">
<title>moe_19_mha&#45;&gt;moe_19_res1</title>
<path fill="none" stroke="black" d="M1936,-39321.23C1936,-39313.54 1936,-39304.73 1936,-39295.73"/>
<polygon fill="black" stroke="black" points="1939.5,-39295.54 1936,-39285.54 1932.5,-39295.54 1939.5,-39295.54"/>
</g>
<!-- moe_19_gate -->
<g id="node360" class="node">
<title>moe_19_gate</title>
<polygon fill="lightyellow" stroke="black" points="2264.8,-39145.36 1741.75,-39145.36 1607.2,-39041.36 2130.25,-39041.36 2264.8,-39145.36"/>
<text text-anchor="middle" x="1936" y="-39107.36" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1936" y="-39096.36" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1936" y="-39085.36" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1936" y="-39074.36" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_19_route -->
<g id="node361" class="node">
<title>moe_19_route</title>
<ellipse fill="lightblue" stroke="black" cx="1936" cy="-38968.59" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1936" y="-38982.59" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1936" y="-38971.59" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1936" y="-38960.59" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1936" y="-38949.59" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_19_gate&#45;&gt;moe_19_route -->
<g id="edge586" class="edge">
<title>moe_19_gate&#45;&gt;moe_19_route</title>
<path fill="none" stroke="black" d="M1936,-39041.01C1936,-39032.6 1936,-39023.93 1936,-39015.66"/>
<polygon fill="black" stroke="black" points="1939.5,-39015.45 1936,-39005.45 1932.5,-39015.45 1939.5,-39015.45"/>
</g>
<!-- moe_19_expert_0 -->
<g id="node362" class="node">
<title>moe_19_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-38895.82 16,-38895.82 16,-38843.82 234,-38843.82 234,-38895.82"/>
<text text-anchor="middle" x="125" y="-38883.82" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-38872.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-38861.82" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-38850.82" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_19_route&#45;&gt;moe_19_expert_0 -->
<g id="edge587" class="edge">
<title>moe_19_route&#45;&gt;moe_19_expert_0</title>
<path fill="none" stroke="black" d="M1720.58,-38962.93C1335.23,-38953.85 541.26,-38931.62 244.53,-38895.9"/>
<polygon fill="black" stroke="black" points="244.54,-38892.37 234.18,-38894.62 243.68,-38899.32 244.54,-38892.37"/>
</g>
<!-- moe_19_expert_1 -->
<g id="node363" class="node">
<title>moe_19_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-38895.82 252,-38895.82 252,-38843.82 470,-38843.82 470,-38895.82"/>
<text text-anchor="middle" x="361" y="-38883.82" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-38872.82" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-38861.82" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-38850.82" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_19_route&#45;&gt;moe_19_expert_1 -->
<g id="edge588" class="edge">
<title>moe_19_route&#45;&gt;moe_19_expert_1</title>
<path fill="none" stroke="black" d="M1718.12,-38967.67C1434.59,-38965.32 923.97,-38952.72 480.32,-38895.9"/>
<polygon fill="black" stroke="black" points="480.55,-38892.4 470.19,-38894.6 479.66,-38899.35 480.55,-38892.4"/>
</g>
<!-- moe_19_expert_2 -->
<g id="node364" class="node">
<title>moe_19_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-38895.82 488,-38895.82 488,-38843.82 706,-38843.82 706,-38895.82"/>
<text text-anchor="middle" x="597" y="-38883.82" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-38872.82" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-38861.82" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-38850.82" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_19_route&#45;&gt;moe_19_expert_2 -->
<g id="edge589" class="edge">
<title>moe_19_route&#45;&gt;moe_19_expert_2</title>
<path fill="none" stroke="black" d="M1719.19,-38964.65C1476.61,-38959.11 1072.07,-38943.15 716.18,-38895.9"/>
<polygon fill="black" stroke="black" points="716.57,-38892.42 706.19,-38894.56 715.64,-38899.35 716.57,-38892.42"/>
</g>
<!-- moe_19_expert_3 -->
<g id="node365" class="node">
<title>moe_19_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-38895.82 724,-38895.82 724,-38843.82 942,-38843.82 942,-38895.82"/>
<text text-anchor="middle" x="833" y="-38883.82" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-38872.82" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-38861.82" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-38850.82" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_19_route&#45;&gt;moe_19_expert_3 -->
<g id="edge590" class="edge">
<title>moe_19_route&#45;&gt;moe_19_expert_3</title>
<path fill="none" stroke="black" d="M1723.27,-38960.45C1525.62,-38951.87 1223.11,-38933.77 952.23,-38895.92"/>
<polygon fill="black" stroke="black" points="952.59,-38892.43 942.2,-38894.51 951.61,-38899.37 952.59,-38892.43"/>
</g>
<!-- moe_19_expert_4 -->
<g id="node366" class="node">
<title>moe_19_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-38895.82 960,-38895.82 960,-38843.82 1178,-38843.82 1178,-38895.82"/>
<text text-anchor="middle" x="1069" y="-38883.82" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-38872.82" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-38861.82" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-38850.82" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_19_route&#45;&gt;moe_19_expert_4 -->
<g id="edge591" class="edge">
<title>moe_19_route&#45;&gt;moe_19_expert_4</title>
<path fill="none" stroke="black" d="M1734.56,-38954.51C1585.93,-38943.37 1378.71,-38924.76 1188.14,-38895.93"/>
<polygon fill="black" stroke="black" points="1188.62,-38892.46 1178.21,-38894.42 1187.57,-38899.38 1188.62,-38892.46"/>
</g>
<!-- moe_19_expert_5 -->
<g id="node367" class="node">
<title>moe_19_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-38895.82 1196,-38895.82 1196,-38843.82 1414,-38843.82 1414,-38895.82"/>
<text text-anchor="middle" x="1305" y="-38883.82" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-38872.82" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-38861.82" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-38850.82" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_19_route&#45;&gt;moe_19_expert_5 -->
<g id="edge592" class="edge">
<title>moe_19_route&#45;&gt;moe_19_expert_5</title>
<path fill="none" stroke="black" d="M1762.18,-38946.34C1665.34,-38933.76 1542.42,-38916.55 1424.2,-38895.99"/>
<polygon fill="black" stroke="black" points="1424.69,-38892.52 1414.24,-38894.25 1423.49,-38899.42 1424.69,-38892.52"/>
</g>
<!-- moe_19_expert_6 -->
<g id="node368" class="node">
<title>moe_19_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-38895.82 1432,-38895.82 1432,-38843.82 1650,-38843.82 1650,-38895.82"/>
<text text-anchor="middle" x="1541" y="-38883.82" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-38872.82" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-38861.82" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-38850.82" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_19_route&#45;&gt;moe_19_expert_6 -->
<g id="edge593" class="edge">
<title>moe_19_route&#45;&gt;moe_19_expert_6</title>
<path fill="none" stroke="black" d="M1815.07,-38937.97C1763.5,-38925.33 1703.69,-38910.68 1653.13,-38898.29"/>
<polygon fill="black" stroke="black" points="1653.69,-38894.83 1643.14,-38895.85 1652.02,-38901.63 1653.69,-38894.83"/>
</g>
<!-- moe_19_expert_7 -->
<g id="node369" class="node">
<title>moe_19_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-38895.82 1668,-38895.82 1668,-38843.82 1886,-38843.82 1886,-38895.82"/>
<text text-anchor="middle" x="1777" y="-38883.82" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-38872.82" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-38861.82" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-38850.82" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_19_route&#45;&gt;moe_19_expert_7 -->
<g id="edge594" class="edge">
<title>moe_19_route&#45;&gt;moe_19_expert_7</title>
<path fill="none" stroke="black" d="M1879.05,-38932.93C1862.05,-38922.59 1843.56,-38911.34 1827.05,-38901.28"/>
<polygon fill="black" stroke="black" points="1828.46,-38898.05 1818.1,-38895.84 1824.82,-38904.03 1828.46,-38898.05"/>
</g>
<!-- moe_19_expert_8 -->
<g id="node370" class="node">
<title>moe_19_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-38895.82 1904,-38895.82 1904,-38843.82 2122,-38843.82 2122,-38895.82"/>
<text text-anchor="middle" x="2013" y="-38883.82" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-38872.82" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-38861.82" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-38850.82" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_19_route&#45;&gt;moe_19_expert_8 -->
<g id="edge595" class="edge">
<title>moe_19_route&#45;&gt;moe_19_expert_8</title>
<path fill="none" stroke="black" d="M1964.23,-38932.11C1971.53,-38922.94 1979.36,-38913.11 1986.56,-38904.06"/>
<polygon fill="black" stroke="black" points="1989.47,-38906.01 1992.96,-38896.01 1983.99,-38901.66 1989.47,-38906.01"/>
</g>
<!-- moe_19_expert_9 -->
<g id="node371" class="node">
<title>moe_19_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-38895.82 2140,-38895.82 2140,-38843.82 2358,-38843.82 2358,-38895.82"/>
<text text-anchor="middle" x="2249" y="-38883.82" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-38872.82" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-38861.82" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-38850.82" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_19_route&#45;&gt;moe_19_expert_9 -->
<g id="edge596" class="edge">
<title>moe_19_route&#45;&gt;moe_19_expert_9</title>
<path fill="none" stroke="black" d="M2038.05,-38936.04C2076.7,-38924.09 2120.41,-38910.58 2157.98,-38898.96"/>
<polygon fill="black" stroke="black" points="2159.38,-38902.2 2167.9,-38895.9 2157.31,-38895.51 2159.38,-38902.2"/>
</g>
<!-- moe_19_expert_10 -->
<g id="node372" class="node">
<title>moe_19_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-38895.82 2376,-38895.82 2376,-38843.82 2594,-38843.82 2594,-38895.82"/>
<text text-anchor="middle" x="2485" y="-38883.82" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-38872.82" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-38861.82" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-38850.82" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_19_route&#45;&gt;moe_19_expert_10 -->
<g id="edge597" class="edge">
<title>moe_19_route&#45;&gt;moe_19_expert_10</title>
<path fill="none" stroke="black" d="M2093.16,-38943.12C2172.25,-38930.39 2269.81,-38914.06 2365.85,-38896.01"/>
<polygon fill="black" stroke="black" points="2366.56,-38899.44 2375.74,-38894.15 2365.27,-38892.56 2366.56,-38899.44"/>
</g>
<!-- moe_19_expert_11 -->
<g id="node373" class="node">
<title>moe_19_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-38895.82 2612,-38895.82 2612,-38843.82 2830,-38843.82 2830,-38895.82"/>
<text text-anchor="middle" x="2721" y="-38883.82" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-38872.82" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-38861.82" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-38850.82" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_19_route&#45;&gt;moe_19_expert_11 -->
<g id="edge598" class="edge">
<title>moe_19_route&#45;&gt;moe_19_expert_11</title>
<path fill="none" stroke="black" d="M2130.42,-38951.92C2261.1,-38940.13 2437.31,-38921.81 2601.49,-38896"/>
<polygon fill="black" stroke="black" points="2602.45,-38899.39 2611.78,-38894.37 2601.36,-38892.48 2602.45,-38899.39"/>
</g>
<!-- moe_19_expert_12 -->
<g id="node374" class="node">
<title>moe_19_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-38895.82 2848,-38895.82 2848,-38843.82 3066,-38843.82 3066,-38895.82"/>
<text text-anchor="middle" x="2957" y="-38883.82" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-38872.82" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-38861.82" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-38850.82" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_19_route&#45;&gt;moe_19_expert_12 -->
<g id="edge599" class="edge">
<title>moe_19_route&#45;&gt;moe_19_expert_12</title>
<path fill="none" stroke="black" d="M2145.78,-38958.62C2326.84,-38949.08 2595.36,-38930.6 2837.73,-38895.93"/>
<polygon fill="black" stroke="black" points="2838.4,-38899.37 2847.8,-38894.48 2837.4,-38892.44 2838.4,-38899.37"/>
</g>
<!-- moe_19_expert_13 -->
<g id="node375" class="node">
<title>moe_19_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-38895.82 3084,-38895.82 3084,-38843.82 3302,-38843.82 3302,-38895.82"/>
<text text-anchor="middle" x="3193" y="-38883.82" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-38872.82" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-38861.82" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-38850.82" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_19_route&#45;&gt;moe_19_expert_13 -->
<g id="edge600" class="edge">
<title>moe_19_route&#45;&gt;moe_19_expert_13</title>
<path fill="none" stroke="black" d="M2151.58,-38963.36C2378.97,-38956.74 2747.61,-38939.88 3073.69,-38895.92"/>
<polygon fill="black" stroke="black" points="3074.37,-38899.36 3083.81,-38894.54 3073.43,-38892.42 3074.37,-38899.36"/>
</g>
<!-- moe_19_expert_14 -->
<g id="node376" class="node">
<title>moe_19_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-38895.82 3320,-38895.82 3320,-38843.82 3538,-38843.82 3538,-38895.82"/>
<text text-anchor="middle" x="3429" y="-38883.82" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-38872.82" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-38861.82" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-38850.82" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_19_route&#45;&gt;moe_19_expert_14 -->
<g id="edge601" class="edge">
<title>moe_19_route&#45;&gt;moe_19_expert_14</title>
<path fill="none" stroke="black" d="M2153.67,-38966.73C2423.38,-38963.27 2896.83,-38949.38 3309.76,-38895.9"/>
<polygon fill="black" stroke="black" points="3310.35,-38899.35 3319.81,-38894.59 3309.44,-38892.41 3310.35,-38899.35"/>
</g>
<!-- moe_19_expert_15 -->
<g id="node377" class="node">
<title>moe_19_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-38895.82 3556,-38895.82 3556,-38843.82 3774,-38843.82 3774,-38895.82"/>
<text text-anchor="middle" x="3665" y="-38883.82" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-38872.82" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-38861.82" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-38850.82" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_19_route&#45;&gt;moe_19_expert_15 -->
<g id="edge602" class="edge">
<title>moe_19_route&#45;&gt;moe_19_expert_15</title>
<path fill="none" stroke="black" d="M2150.89,-38962.4C2520.98,-38952.74 3265.06,-38929.94 3545.63,-38895.88"/>
<polygon fill="black" stroke="black" points="3546.33,-38899.32 3555.82,-38894.62 3545.46,-38892.38 3546.33,-38899.32"/>
</g>
<!-- moe_19_aggregate -->
<g id="node378" class="node">
<title>moe_19_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-38771.05" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-38785.05" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1895" y="-38774.05" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-38763.05" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1895" y="-38752.05" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_19_expert_0&#45;&gt;moe_19_aggregate -->
<g id="edge603" class="edge">
<title>moe_19_expert_0&#45;&gt;moe_19_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-38845.03C237.15,-38844.6 240.09,-38844.19 243,-38843.82 510.74,-38809.88 1276.32,-38787.08 1664.04,-38777.37"/>
<polygon fill="black" stroke="black" points="1664.35,-38780.86 1674.26,-38777.11 1664.17,-38773.86 1664.35,-38780.86"/>
</g>
<!-- moe_19_expert_1&#45;&gt;moe_19_aggregate -->
<g id="edge604" class="edge">
<title>moe_19_expert_1&#45;&gt;moe_19_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-38845.06C473.15,-38844.62 476.09,-38844.2 479,-38843.82 892.79,-38789.85 1379.51,-38775.89 1661.11,-38772.61"/>
<polygon fill="black" stroke="black" points="1661.49,-38776.11 1671.45,-38772.5 1661.41,-38769.11 1661.49,-38776.11"/>
</g>
<!-- moe_19_expert_2&#45;&gt;moe_19_aggregate -->
<g id="edge605" class="edge">
<title>moe_19_expert_2&#45;&gt;moe_19_aggregate</title>
<path fill="none" stroke="black" d="M706.19,-38845.1C709.15,-38844.64 712.09,-38844.22 715,-38843.82 1042.31,-38799.45 1424.45,-38782.5 1663.11,-38776.04"/>
<polygon fill="black" stroke="black" points="1663.4,-38779.53 1673.31,-38775.76 1663.22,-38772.53 1663.4,-38779.53"/>
</g>
<!-- moe_19_expert_3&#45;&gt;moe_19_aggregate -->
<g id="edge606" class="edge">
<title>moe_19_expert_3&#45;&gt;moe_19_aggregate</title>
<path fill="none" stroke="black" d="M942.2,-38845.15C945.16,-38844.68 948.1,-38844.24 951,-38843.82 1194.76,-38808.89 1476.52,-38790.27 1668.32,-38780.83"/>
<polygon fill="black" stroke="black" points="1668.71,-38784.31 1678.53,-38780.33 1668.37,-38777.32 1668.71,-38784.31"/>
</g>
<!-- moe_19_expert_4&#45;&gt;moe_19_aggregate -->
<g id="edge607" class="edge">
<title>moe_19_expert_4&#45;&gt;moe_19_aggregate</title>
<path fill="none" stroke="black" d="M1178.21,-38845.25C1181.17,-38844.75 1184.1,-38844.28 1187,-38843.82 1352.7,-38817.95 1541.73,-38799.34 1682.77,-38787.56"/>
<polygon fill="black" stroke="black" points="1683.17,-38791.04 1692.84,-38786.72 1682.59,-38784.06 1683.17,-38791.04"/>
</g>
<!-- moe_19_expert_5&#45;&gt;moe_19_aggregate -->
<g id="edge608" class="edge">
<title>moe_19_expert_5&#45;&gt;moe_19_aggregate</title>
<path fill="none" stroke="black" d="M1414.25,-38845.45C1417.19,-38844.89 1420.12,-38844.35 1423,-38843.82 1519.58,-38826.26 1627.83,-38809.59 1716.27,-38796.74"/>
<polygon fill="black" stroke="black" points="1717.01,-38800.17 1726.4,-38795.27 1716,-38793.24 1717.01,-38800.17"/>
</g>
<!-- moe_19_expert_6&#45;&gt;moe_19_aggregate -->
<g id="edge609" class="edge">
<title>moe_19_expert_6&#45;&gt;moe_19_aggregate</title>
<path fill="none" stroke="black" d="M1632.62,-38843.78C1675.27,-38832.12 1726.62,-38818.08 1772.54,-38805.53"/>
<polygon fill="black" stroke="black" points="1773.53,-38808.89 1782.25,-38802.88 1771.68,-38802.14 1773.53,-38808.89"/>
</g>
<!-- moe_19_expert_7&#45;&gt;moe_19_aggregate -->
<g id="edge610" class="edge">
<title>moe_19_expert_7&#45;&gt;moe_19_aggregate</title>
<path fill="none" stroke="black" d="M1807.7,-38843.65C1818.79,-38834.56 1831.63,-38824.03 1843.99,-38813.89"/>
<polygon fill="black" stroke="black" points="1846.51,-38816.35 1852.02,-38807.3 1842.07,-38810.93 1846.51,-38816.35"/>
</g>
<!-- moe_19_expert_8&#45;&gt;moe_19_aggregate -->
<g id="edge611" class="edge">
<title>moe_19_expert_8&#45;&gt;moe_19_aggregate</title>
<path fill="none" stroke="black" d="M1982.3,-38843.65C1971.21,-38834.56 1958.37,-38824.03 1946.01,-38813.89"/>
<polygon fill="black" stroke="black" points="1947.93,-38810.93 1937.98,-38807.3 1943.49,-38816.35 1947.93,-38810.93"/>
</g>
<!-- moe_19_expert_9&#45;&gt;moe_19_aggregate -->
<g id="edge612" class="edge">
<title>moe_19_expert_9&#45;&gt;moe_19_aggregate</title>
<path fill="none" stroke="black" d="M2157.38,-38843.78C2114.73,-38832.12 2063.38,-38818.08 2017.46,-38805.53"/>
<polygon fill="black" stroke="black" points="2018.32,-38802.14 2007.75,-38802.88 2016.47,-38808.89 2018.32,-38802.14"/>
</g>
<!-- moe_19_expert_10&#45;&gt;moe_19_aggregate -->
<g id="edge613" class="edge">
<title>moe_19_expert_10&#45;&gt;moe_19_aggregate</title>
<path fill="none" stroke="black" d="M2375.75,-38845.45C2372.81,-38844.89 2369.88,-38844.35 2367,-38843.82 2270.42,-38826.26 2162.17,-38809.59 2073.73,-38796.74"/>
<polygon fill="black" stroke="black" points="2074,-38793.24 2063.6,-38795.27 2072.99,-38800.17 2074,-38793.24"/>
</g>
<!-- moe_19_expert_11&#45;&gt;moe_19_aggregate -->
<g id="edge614" class="edge">
<title>moe_19_expert_11&#45;&gt;moe_19_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-38845.25C2608.83,-38844.75 2605.9,-38844.28 2603,-38843.82 2437.3,-38817.95 2248.27,-38799.34 2107.23,-38787.56"/>
<polygon fill="black" stroke="black" points="2107.41,-38784.06 2097.16,-38786.72 2106.83,-38791.04 2107.41,-38784.06"/>
</g>
<!-- moe_19_expert_12&#45;&gt;moe_19_aggregate -->
<g id="edge615" class="edge">
<title>moe_19_expert_12&#45;&gt;moe_19_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-38845.15C2844.84,-38844.68 2841.9,-38844.24 2839,-38843.82 2595.24,-38808.89 2313.48,-38790.27 2121.68,-38780.83"/>
<polygon fill="black" stroke="black" points="2121.63,-38777.32 2111.47,-38780.33 2121.29,-38784.31 2121.63,-38777.32"/>
</g>
<!-- moe_19_expert_13&#45;&gt;moe_19_aggregate -->
<g id="edge616" class="edge">
<title>moe_19_expert_13&#45;&gt;moe_19_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-38845.1C3080.85,-38844.64 3077.91,-38844.22 3075,-38843.82 2747.69,-38799.45 2365.55,-38782.5 2126.89,-38776.04"/>
<polygon fill="black" stroke="black" points="2126.78,-38772.53 2116.69,-38775.76 2126.6,-38779.53 2126.78,-38772.53"/>
</g>
<!-- moe_19_expert_14&#45;&gt;moe_19_aggregate -->
<g id="edge617" class="edge">
<title>moe_19_expert_14&#45;&gt;moe_19_aggregate</title>
<path fill="none" stroke="black" d="M3319.81,-38845.06C3316.85,-38844.62 3313.91,-38844.2 3311,-38843.82 2897.21,-38789.85 2410.49,-38775.89 2128.89,-38772.61"/>
<polygon fill="black" stroke="black" points="2128.59,-38769.11 2118.55,-38772.5 2128.51,-38776.11 2128.59,-38769.11"/>
</g>
<!-- moe_19_expert_15&#45;&gt;moe_19_aggregate -->
<g id="edge618" class="edge">
<title>moe_19_expert_15&#45;&gt;moe_19_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-38845.03C3552.85,-38844.6 3549.91,-38844.19 3547,-38843.82 3279.26,-38809.88 2513.68,-38787.08 2125.96,-38777.37"/>
<polygon fill="black" stroke="black" points="2125.83,-38773.86 2115.74,-38777.11 2125.65,-38780.86 2125.83,-38773.86"/>
</g>
<!-- moe_19_ffn -->
<g id="node379" class="node">
<title>moe_19_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2053,-38698.28 1737,-38698.28 1737,-38646.28 2053,-38646.28 2053,-38698.28"/>
<text text-anchor="middle" x="1895" y="-38686.28" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1895" y="-38675.28" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-38664.28" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-38653.28" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_19_aggregate&#45;&gt;moe_19_ffn -->
<g id="edge619" class="edge">
<title>moe_19_aggregate&#45;&gt;moe_19_ffn</title>
<path fill="none" stroke="black" d="M1895,-38734.02C1895,-38725.71 1895,-38716.88 1895,-38708.59"/>
<polygon fill="black" stroke="black" points="1898.5,-38708.48 1895,-38698.48 1891.5,-38708.48 1898.5,-38708.48"/>
</g>
<!-- moe_19_res2 -->
<g id="node381" class="node">
<title>moe_19_res2</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-38610.28 1695.97,-38610.28 1558.11,-38506.28 2094.03,-38506.28 2231.89,-38610.28"/>
<text text-anchor="middle" x="1895" y="-38572.28" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1895" y="-38561.28" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-38550.28" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-38539.28" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_19_ffn&#45;&gt;moe_19_res2 -->
<g id="edge620" class="edge">
<title>moe_19_ffn&#45;&gt;moe_19_res2</title>
<path fill="none" stroke="black" d="M1895,-38646.15C1895,-38638.46 1895,-38629.65 1895,-38620.65"/>
<polygon fill="black" stroke="black" points="1898.5,-38620.46 1895,-38610.46 1891.5,-38620.46 1898.5,-38620.46"/>
</g>
<!-- moe_19_res1&#45;&gt;moe_19_gate -->
<g id="edge585" class="edge">
<title>moe_19_res1&#45;&gt;moe_19_gate</title>
<path fill="none" stroke="black" d="M1936,-39180.98C1936,-39172.8 1936,-39164.28 1936,-39155.9"/>
<polygon fill="black" stroke="black" points="1939.5,-39155.79 1936,-39145.79 1932.5,-39155.79 1939.5,-39155.79"/>
</g>
<!-- moe_20_mha -->
<g id="node382" class="node">
<title>moe_20_mha</title>
<polygon fill="lightgreen" stroke="black" points="2053,-38459.28 1737,-38459.28 1737,-38407.28 2053,-38407.28 2053,-38459.28"/>
<text text-anchor="middle" x="1895" y="-38447.28" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1895" y="-38436.28" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-38425.28" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-38414.28" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_19_res2&#45;&gt;moe_20_mha -->
<g id="edge621" class="edge">
<title>moe_19_res2&#45;&gt;moe_20_mha</title>
<path fill="none" stroke="black" d="M1895,-38506.19C1895,-38493.86 1895,-38480.95 1895,-38469.54"/>
<polygon fill="black" stroke="black" points="1898.5,-38469.53 1895,-38459.53 1891.5,-38469.53 1898.5,-38469.53"/>
</g>
<!-- moe_20_res1 -->
<g id="node403" class="node">
<title>moe_20_res1</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-38371.28 1695.97,-38371.28 1558.11,-38267.28 2094.03,-38267.28 2231.89,-38371.28"/>
<text text-anchor="middle" x="1895" y="-38333.28" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1895" y="-38322.28" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-38311.28" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-38300.28" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_20_mha&#45;&gt;moe_20_res1 -->
<g id="edge622" class="edge">
<title>moe_20_mha&#45;&gt;moe_20_res1</title>
<path fill="none" stroke="black" d="M1895,-38407.15C1895,-38399.46 1895,-38390.65 1895,-38381.65"/>
<polygon fill="black" stroke="black" points="1898.5,-38381.46 1895,-38371.46 1891.5,-38381.46 1898.5,-38381.46"/>
</g>
<!-- moe_20_gate -->
<g id="node383" class="node">
<title>moe_20_gate</title>
<polygon fill="lightyellow" stroke="black" points="2223.8,-38231.28 1700.75,-38231.28 1566.2,-38127.28 2089.25,-38127.28 2223.8,-38231.28"/>
<text text-anchor="middle" x="1895" y="-38193.28" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1895" y="-38182.28" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-38171.28" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-38160.28" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_20_route -->
<g id="node384" class="node">
<title>moe_20_route</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-38054.52" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-38068.52" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1895" y="-38057.52" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-38046.52" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-38035.52" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_20_gate&#45;&gt;moe_20_route -->
<g id="edge624" class="edge">
<title>moe_20_gate&#45;&gt;moe_20_route</title>
<path fill="none" stroke="black" d="M1895,-38126.93C1895,-38118.52 1895,-38109.86 1895,-38101.59"/>
<polygon fill="black" stroke="black" points="1898.5,-38101.37 1895,-38091.37 1891.5,-38101.37 1898.5,-38101.37"/>
</g>
<!-- moe_20_expert_0 -->
<g id="node385" class="node">
<title>moe_20_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-37981.75 16,-37981.75 16,-37929.75 234,-37929.75 234,-37981.75"/>
<text text-anchor="middle" x="125" y="-37969.75" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-37958.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-37947.75" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-37936.75" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_20_route&#45;&gt;moe_20_expert_0 -->
<g id="edge625" class="edge">
<title>moe_20_route&#45;&gt;moe_20_expert_0</title>
<path fill="none" stroke="black" d="M1679.93,-38048.6C1302.11,-38039.23 532.75,-38016.69 244.24,-37981.79"/>
<polygon fill="black" stroke="black" points="244.54,-37978.3 234.18,-37980.54 243.68,-37985.24 244.54,-37978.3"/>
</g>
<!-- moe_20_expert_1 -->
<g id="node386" class="node">
<title>moe_20_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-37981.75 252,-37981.75 252,-37929.75 470,-37929.75 470,-37981.75"/>
<text text-anchor="middle" x="361" y="-37969.75" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-37958.75" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-37947.75" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-37936.75" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_20_route&#45;&gt;moe_20_expert_1 -->
<g id="edge626" class="edge">
<title>moe_20_route&#45;&gt;moe_20_expert_1</title>
<path fill="none" stroke="black" d="M1677.23,-38053.13C1400.57,-38050.23 908.56,-38036.98 480.29,-37981.82"/>
<polygon fill="black" stroke="black" points="480.55,-37978.33 470.19,-37980.51 479.65,-37985.27 480.55,-37978.33"/>
</g>
<!-- moe_20_expert_2 -->
<g id="node387" class="node">
<title>moe_20_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-37981.75 488,-37981.75 488,-37929.75 706,-37929.75 706,-37981.75"/>
<text text-anchor="middle" x="597" y="-37969.75" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-37958.75" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-37947.75" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-37936.75" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_20_route&#45;&gt;moe_20_expert_2 -->
<g id="edge627" class="edge">
<title>moe_20_route&#45;&gt;moe_20_expert_2</title>
<path fill="none" stroke="black" d="M1678.74,-38049.95C1443.7,-38043.87 1057.2,-38027.43 716.26,-37981.83"/>
<polygon fill="black" stroke="black" points="716.57,-37978.34 706.19,-37980.47 715.63,-37985.28 716.57,-37978.34"/>
</g>
<!-- moe_20_expert_3 -->
<g id="node388" class="node">
<title>moe_20_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-37981.75 724,-37981.75 724,-37929.75 942,-37929.75 942,-37981.75"/>
<text text-anchor="middle" x="833" y="-37969.75" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-37958.75" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-37947.75" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-37936.75" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_20_route&#45;&gt;moe_20_expert_3 -->
<g id="edge628" class="edge">
<title>moe_20_route&#45;&gt;moe_20_expert_3</title>
<path fill="none" stroke="black" d="M1683.7,-38045.49C1494.33,-38036.42 1209,-38018.11 952.47,-37981.88"/>
<polygon fill="black" stroke="black" points="952.59,-37978.36 942.2,-37980.41 951.61,-37985.29 952.59,-37978.36"/>
</g>
<!-- moe_20_expert_4 -->
<g id="node389" class="node">
<title>moe_20_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-37981.75 960,-37981.75 960,-37929.75 1178,-37929.75 1178,-37981.75"/>
<text text-anchor="middle" x="1069" y="-37969.75" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-37958.75" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-37947.75" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-37936.75" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_20_route&#45;&gt;moe_20_expert_4 -->
<g id="edge629" class="edge">
<title>moe_20_route&#45;&gt;moe_20_expert_4</title>
<path fill="none" stroke="black" d="M1696.66,-38039.16C1556.96,-38027.68 1365.46,-38009.18 1188.25,-37981.88"/>
<polygon fill="black" stroke="black" points="1188.63,-37978.39 1178.21,-37980.32 1187.56,-37985.31 1188.63,-37978.39"/>
</g>
<!-- moe_20_expert_5 -->
<g id="node390" class="node">
<title>moe_20_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-37981.75 1196,-37981.75 1196,-37929.75 1414,-37929.75 1414,-37981.75"/>
<text text-anchor="middle" x="1305" y="-37969.75" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-37958.75" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-37947.75" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-37936.75" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_20_route&#45;&gt;moe_20_expert_5 -->
<g id="edge630" class="edge">
<title>moe_20_route&#45;&gt;moe_20_expert_5</title>
<path fill="none" stroke="black" d="M1728.87,-38030.65C1640.99,-38017.97 1531.11,-38001.2 1424.25,-37981.94"/>
<polygon fill="black" stroke="black" points="1424.71,-37978.46 1414.25,-37980.12 1423.46,-37985.35 1424.71,-37978.46"/>
</g>
<!-- moe_20_expert_6 -->
<g id="node391" class="node">
<title>moe_20_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-37981.75 1432,-37981.75 1432,-37929.75 1650,-37929.75 1650,-37981.75"/>
<text text-anchor="middle" x="1541" y="-37969.75" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-37958.75" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-37947.75" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-37936.75" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_20_route&#45;&gt;moe_20_expert_6 -->
<g id="edge631" class="edge">
<title>moe_20_route&#45;&gt;moe_20_expert_6</title>
<path fill="none" stroke="black" d="M1782.99,-38022.9C1737.98,-38010.59 1686.47,-37996.51 1642.56,-37984.51"/>
<polygon fill="black" stroke="black" points="1643.31,-37981.08 1632.74,-37981.82 1641.46,-37987.84 1643.31,-37981.08"/>
</g>
<!-- moe_20_expert_7 -->
<g id="node392" class="node">
<title>moe_20_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-37981.75 1668,-37981.75 1668,-37929.75 1886,-37929.75 1886,-37981.75"/>
<text text-anchor="middle" x="1777" y="-37969.75" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-37958.75" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-37947.75" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-37936.75" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_20_route&#45;&gt;moe_20_expert_7 -->
<g id="edge632" class="edge">
<title>moe_20_route&#45;&gt;moe_20_expert_7</title>
<path fill="none" stroke="black" d="M1852.07,-38018.31C1840.07,-38008.47 1827.12,-37997.85 1815.41,-37988.24"/>
<polygon fill="black" stroke="black" points="1817.47,-37985.41 1807.52,-37981.78 1813.04,-37990.82 1817.47,-37985.41"/>
</g>
<!-- moe_20_expert_8 -->
<g id="node393" class="node">
<title>moe_20_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-37981.75 1904,-37981.75 1904,-37929.75 2122,-37929.75 2122,-37981.75"/>
<text text-anchor="middle" x="2013" y="-37969.75" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-37958.75" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-37947.75" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-37936.75" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_20_route&#45;&gt;moe_20_expert_8 -->
<g id="edge633" class="edge">
<title>moe_20_route&#45;&gt;moe_20_expert_8</title>
<path fill="none" stroke="black" d="M1937.93,-38018.31C1949.93,-38008.47 1962.88,-37997.85 1974.59,-37988.24"/>
<polygon fill="black" stroke="black" points="1976.96,-37990.82 1982.48,-37981.78 1972.53,-37985.41 1976.96,-37990.82"/>
</g>
<!-- moe_20_expert_9 -->
<g id="node394" class="node">
<title>moe_20_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-37981.75 2140,-37981.75 2140,-37929.75 2358,-37929.75 2358,-37981.75"/>
<text text-anchor="middle" x="2249" y="-37969.75" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-37958.75" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-37947.75" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-37936.75" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_20_route&#45;&gt;moe_20_expert_9 -->
<g id="edge634" class="edge">
<title>moe_20_route&#45;&gt;moe_20_expert_9</title>
<path fill="none" stroke="black" d="M2007.01,-38022.9C2052.02,-38010.59 2103.53,-37996.51 2147.44,-37984.51"/>
<polygon fill="black" stroke="black" points="2148.54,-37987.84 2157.26,-37981.82 2146.69,-37981.08 2148.54,-37987.84"/>
</g>
<!-- moe_20_expert_10 -->
<g id="node395" class="node">
<title>moe_20_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-37981.75 2376,-37981.75 2376,-37929.75 2594,-37929.75 2594,-37981.75"/>
<text text-anchor="middle" x="2485" y="-37969.75" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-37958.75" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-37947.75" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-37936.75" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_20_route&#45;&gt;moe_20_expert_10 -->
<g id="edge635" class="edge">
<title>moe_20_route&#45;&gt;moe_20_expert_10</title>
<path fill="none" stroke="black" d="M2061.13,-38030.65C2149.01,-38017.97 2258.89,-38001.2 2365.75,-37981.94"/>
<polygon fill="black" stroke="black" points="2366.54,-37985.35 2375.75,-37980.12 2365.29,-37978.46 2366.54,-37985.35"/>
</g>
<!-- moe_20_expert_11 -->
<g id="node396" class="node">
<title>moe_20_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-37981.75 2612,-37981.75 2612,-37929.75 2830,-37929.75 2830,-37981.75"/>
<text text-anchor="middle" x="2721" y="-37969.75" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-37958.75" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-37947.75" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-37936.75" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_20_route&#45;&gt;moe_20_expert_11 -->
<g id="edge636" class="edge">
<title>moe_20_route&#45;&gt;moe_20_expert_11</title>
<path fill="none" stroke="black" d="M2093.34,-38039.16C2233.04,-38027.68 2424.54,-38009.18 2601.75,-37981.88"/>
<polygon fill="black" stroke="black" points="2602.44,-37985.31 2611.79,-37980.32 2601.37,-37978.39 2602.44,-37985.31"/>
</g>
<!-- moe_20_expert_12 -->
<g id="node397" class="node">
<title>moe_20_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-37981.75 2848,-37981.75 2848,-37929.75 3066,-37929.75 3066,-37981.75"/>
<text text-anchor="middle" x="2957" y="-37969.75" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-37958.75" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-37947.75" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-37936.75" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_20_route&#45;&gt;moe_20_expert_12 -->
<g id="edge637" class="edge">
<title>moe_20_route&#45;&gt;moe_20_expert_12</title>
<path fill="none" stroke="black" d="M2106.3,-38045.49C2295.67,-38036.42 2581,-38018.11 2837.53,-37981.88"/>
<polygon fill="black" stroke="black" points="2838.39,-37985.29 2847.8,-37980.41 2837.41,-37978.36 2838.39,-37985.29"/>
</g>
<!-- moe_20_expert_13 -->
<g id="node398" class="node">
<title>moe_20_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-37981.75 3084,-37981.75 3084,-37929.75 3302,-37929.75 3302,-37981.75"/>
<text text-anchor="middle" x="3193" y="-37969.75" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-37958.75" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-37947.75" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-37936.75" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_20_route&#45;&gt;moe_20_expert_13 -->
<g id="edge638" class="edge">
<title>moe_20_route&#45;&gt;moe_20_expert_13</title>
<path fill="none" stroke="black" d="M2111.26,-38049.95C2346.3,-38043.87 2732.8,-38027.43 3073.74,-37981.83"/>
<polygon fill="black" stroke="black" points="3074.37,-37985.28 3083.81,-37980.47 3073.43,-37978.34 3074.37,-37985.28"/>
</g>
<!-- moe_20_expert_14 -->
<g id="node399" class="node">
<title>moe_20_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-37981.75 3320,-37981.75 3320,-37929.75 3538,-37929.75 3538,-37981.75"/>
<text text-anchor="middle" x="3429" y="-37969.75" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-37958.75" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-37947.75" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-37936.75" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_20_route&#45;&gt;moe_20_expert_14 -->
<g id="edge639" class="edge">
<title>moe_20_route&#45;&gt;moe_20_expert_14</title>
<path fill="none" stroke="black" d="M2112.77,-38053.13C2389.43,-38050.23 2881.44,-38036.98 3309.71,-37981.82"/>
<polygon fill="black" stroke="black" points="3310.35,-37985.27 3319.81,-37980.51 3309.45,-37978.33 3310.35,-37985.27"/>
</g>
<!-- moe_20_expert_15 -->
<g id="node400" class="node">
<title>moe_20_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-37981.75 3556,-37981.75 3556,-37929.75 3774,-37929.75 3774,-37981.75"/>
<text text-anchor="middle" x="3665" y="-37969.75" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-37958.75" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-37947.75" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-37936.75" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_20_route&#45;&gt;moe_20_expert_15 -->
<g id="edge640" class="edge">
<title>moe_20_route&#45;&gt;moe_20_expert_15</title>
<path fill="none" stroke="black" d="M2110.07,-38048.6C2487.89,-38039.23 3257.25,-38016.69 3545.76,-37981.79"/>
<polygon fill="black" stroke="black" points="3546.32,-37985.24 3555.82,-37980.54 3545.46,-37978.3 3546.32,-37985.24"/>
</g>
<!-- moe_20_aggregate -->
<g id="node401" class="node">
<title>moe_20_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1922" cy="-37856.98" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1922" y="-37870.98" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1922" y="-37859.98" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1922" y="-37848.98" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1922" y="-37837.98" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_20_expert_0&#45;&gt;moe_20_aggregate -->
<g id="edge641" class="edge">
<title>moe_20_expert_0&#45;&gt;moe_20_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-37930.95C237.15,-37930.52 240.09,-37930.11 243,-37929.75 515.99,-37895.24 1298.22,-37872.62 1691.05,-37863.1"/>
<polygon fill="black" stroke="black" points="1691.2,-37866.6 1701.12,-37862.86 1691.03,-37859.6 1691.2,-37866.6"/>
</g>
<!-- moe_20_expert_1&#45;&gt;moe_20_aggregate -->
<g id="edge642" class="edge">
<title>moe_20_expert_1&#45;&gt;moe_20_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-37930.97C473.15,-37930.53 476.09,-37930.12 479,-37929.75 903.05,-37874.64 1402.24,-37861.1 1688.45,-37858.2"/>
<polygon fill="black" stroke="black" points="1688.57,-37861.7 1698.54,-37858.1 1688.5,-37854.7 1688.57,-37861.7"/>
</g>
<!-- moe_20_expert_2&#45;&gt;moe_20_aggregate -->
<g id="edge643" class="edge">
<title>moe_20_expert_2&#45;&gt;moe_20_aggregate</title>
<path fill="none" stroke="black" d="M706.19,-37931.01C709.15,-37930.56 712.09,-37930.14 715,-37929.75 1052.15,-37884.27 1446.16,-37867.61 1689.92,-37861.5"/>
<polygon fill="black" stroke="black" points="1690.05,-37865 1699.97,-37861.26 1689.88,-37858 1690.05,-37865"/>
</g>
<!-- moe_20_expert_3&#45;&gt;moe_20_aggregate -->
<g id="edge644" class="edge">
<title>moe_20_expert_3&#45;&gt;moe_20_aggregate</title>
<path fill="none" stroke="black" d="M942.2,-37931.07C945.16,-37930.6 948.1,-37930.16 951,-37929.75 1204.11,-37893.75 1497.07,-37875.23 1694.44,-37866.11"/>
<polygon fill="black" stroke="black" points="1694.82,-37869.6 1704.65,-37865.64 1694.5,-37862.6 1694.82,-37869.6"/>
</g>
<!-- moe_20_expert_4&#45;&gt;moe_20_aggregate -->
<g id="edge645" class="edge">
<title>moe_20_expert_4&#45;&gt;moe_20_aggregate</title>
<path fill="none" stroke="black" d="M1178.21,-37931.16C1181.17,-37930.67 1184.1,-37930.19 1187,-37929.75 1361.19,-37902.88 1560.24,-37884.17 1707.23,-37872.61"/>
<polygon fill="black" stroke="black" points="1707.58,-37876.09 1717.27,-37871.82 1707.03,-37869.11 1707.58,-37876.09"/>
</g>
<!-- moe_20_expert_5&#45;&gt;moe_20_aggregate -->
<g id="edge646" class="edge">
<title>moe_20_expert_5&#45;&gt;moe_20_aggregate</title>
<path fill="none" stroke="black" d="M1414.24,-37931.34C1417.19,-37930.79 1420.11,-37930.26 1423,-37929.75 1526.93,-37911.28 1643.69,-37894.29 1738.12,-37881.47"/>
<polygon fill="black" stroke="black" points="1738.62,-37884.94 1748.06,-37880.13 1737.68,-37878 1738.62,-37884.94"/>
</g>
<!-- moe_20_expert_6&#45;&gt;moe_20_aggregate -->
<g id="edge647" class="edge">
<title>moe_20_expert_6&#45;&gt;moe_20_aggregate</title>
<path fill="none" stroke="black" d="M1639.61,-37929.7C1686.43,-37917.81 1742.99,-37903.44 1793.15,-37890.7"/>
<polygon fill="black" stroke="black" points="1794.26,-37894.03 1803.09,-37888.18 1792.54,-37887.25 1794.26,-37894.03"/>
</g>
<!-- moe_20_expert_7&#45;&gt;moe_20_aggregate -->
<g id="edge648" class="edge">
<title>moe_20_expert_7&#45;&gt;moe_20_aggregate</title>
<path fill="none" stroke="black" d="M1814.72,-37929.57C1828.88,-37920.12 1845.36,-37909.12 1861.09,-37898.63"/>
<polygon fill="black" stroke="black" points="1863.36,-37901.32 1869.73,-37892.86 1859.47,-37895.5 1863.36,-37901.32"/>
</g>
<!-- moe_20_expert_8&#45;&gt;moe_20_aggregate -->
<g id="edge649" class="edge">
<title>moe_20_expert_8&#45;&gt;moe_20_aggregate</title>
<path fill="none" stroke="black" d="M1989.33,-37929.57C1981.1,-37920.83 1971.63,-37910.75 1962.44,-37900.98"/>
<polygon fill="black" stroke="black" points="1964.89,-37898.47 1955.49,-37893.59 1959.79,-37903.27 1964.89,-37898.47"/>
</g>
<!-- moe_20_expert_9&#45;&gt;moe_20_aggregate -->
<g id="edge650" class="edge">
<title>moe_20_expert_9&#45;&gt;moe_20_aggregate</title>
<path fill="none" stroke="black" d="M2164.36,-37929.7C2125.83,-37918.3 2079.61,-37904.62 2037.91,-37892.28"/>
<polygon fill="black" stroke="black" points="2038.84,-37888.9 2028.25,-37889.42 2036.85,-37895.61 2038.84,-37888.9"/>
</g>
<!-- moe_20_expert_10&#45;&gt;moe_20_aggregate -->
<g id="edge651" class="edge">
<title>moe_20_expert_10&#45;&gt;moe_20_aggregate</title>
<path fill="none" stroke="black" d="M2375.75,-37931.4C2372.8,-37930.84 2369.88,-37930.28 2367,-37929.75 2277.37,-37913.03 2177.14,-37896.67 2094.54,-37883.79"/>
<polygon fill="black" stroke="black" points="2094.97,-37880.32 2084.55,-37882.24 2093.9,-37887.24 2094.97,-37880.32"/>
</g>
<!-- moe_20_expert_11&#45;&gt;moe_20_aggregate -->
<g id="edge652" class="edge">
<title>moe_20_expert_11&#45;&gt;moe_20_aggregate</title>
<path fill="none" stroke="black" d="M2611.78,-37931.19C2608.83,-37930.69 2605.9,-37930.2 2603,-37929.75 2445.77,-37904.87 2266.71,-37886.39 2131.67,-37874.41"/>
<polygon fill="black" stroke="black" points="2131.89,-37870.91 2121.62,-37873.52 2131.27,-37877.89 2131.89,-37870.91"/>
</g>
<!-- moe_20_expert_12&#45;&gt;moe_20_aggregate -->
<g id="edge653" class="edge">
<title>moe_20_expert_12&#45;&gt;moe_20_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-37931.09C2844.84,-37930.61 2841.9,-37930.16 2839,-37929.75 2604.46,-37895.87 2333.71,-37877.15 2147.53,-37867.4"/>
<polygon fill="black" stroke="black" points="2147.51,-37863.9 2137.34,-37866.87 2147.15,-37870.89 2147.51,-37863.9"/>
</g>
<!-- moe_20_expert_13&#45;&gt;moe_20_aggregate -->
<g id="edge654" class="edge">
<title>moe_20_expert_13&#45;&gt;moe_20_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-37931.02C3080.84,-37930.57 3077.9,-37930.14 3075,-37929.75 2757.54,-37886.47 2387.3,-37869.26 2153.77,-37862.43"/>
<polygon fill="black" stroke="black" points="2153.55,-37858.92 2143.45,-37862.13 2153.34,-37865.92 2153.55,-37858.92"/>
</g>
<!-- moe_20_expert_14&#45;&gt;moe_20_aggregate -->
<g id="edge655" class="edge">
<title>moe_20_expert_14&#45;&gt;moe_20_aggregate</title>
<path fill="none" stroke="black" d="M3319.81,-37930.98C3316.85,-37930.54 3313.91,-37930.13 3311,-37929.75 2907.03,-37876.85 2432.18,-37862.5 2155.37,-37858.87"/>
<polygon fill="black" stroke="black" points="2155.24,-37855.37 2145.2,-37858.74 2155.15,-37862.37 2155.24,-37855.37"/>
</g>
<!-- moe_20_expert_15&#45;&gt;moe_20_aggregate -->
<g id="edge656" class="edge">
<title>moe_20_expert_15&#45;&gt;moe_20_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-37930.95C3552.85,-37930.52 3549.91,-37930.12 3547,-37929.75 3284.42,-37896.36 2535.03,-37873.39 2152.59,-37863.48"/>
<polygon fill="black" stroke="black" points="2152.59,-37859.97 2142.51,-37863.22 2152.41,-37866.97 2152.59,-37859.97"/>
</g>
<!-- moe_20_ffn -->
<g id="node402" class="node">
<title>moe_20_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2080,-37784.21 1764,-37784.21 1764,-37732.21 2080,-37732.21 2080,-37784.21"/>
<text text-anchor="middle" x="1922" y="-37772.21" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1922" y="-37761.21" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1922" y="-37750.21" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1922" y="-37739.21" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_20_aggregate&#45;&gt;moe_20_ffn -->
<g id="edge657" class="edge">
<title>moe_20_aggregate&#45;&gt;moe_20_ffn</title>
<path fill="none" stroke="black" d="M1922,-37819.94C1922,-37811.63 1922,-37802.8 1922,-37794.52"/>
<polygon fill="black" stroke="black" points="1925.5,-37794.4 1922,-37784.4 1918.5,-37794.4 1925.5,-37794.4"/>
</g>
<!-- moe_20_res2 -->
<g id="node404" class="node">
<title>moe_20_res2</title>
<polygon fill="lightyellow" stroke="black" points="2258.89,-37696.21 1722.97,-37696.21 1585.11,-37592.21 2121.03,-37592.21 2258.89,-37696.21"/>
<text text-anchor="middle" x="1922" y="-37658.21" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1922" y="-37647.21" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1922" y="-37636.21" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1922" y="-37625.21" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_20_ffn&#45;&gt;moe_20_res2 -->
<g id="edge658" class="edge">
<title>moe_20_ffn&#45;&gt;moe_20_res2</title>
<path fill="none" stroke="black" d="M1922,-37732.07C1922,-37724.39 1922,-37715.57 1922,-37706.57"/>
<polygon fill="black" stroke="black" points="1925.5,-37706.38 1922,-37696.38 1918.5,-37706.38 1925.5,-37706.38"/>
</g>
<!-- moe_20_res1&#45;&gt;moe_20_gate -->
<g id="edge623" class="edge">
<title>moe_20_res1&#45;&gt;moe_20_gate</title>
<path fill="none" stroke="black" d="M1895,-38266.9C1895,-38258.73 1895,-38250.2 1895,-38241.82"/>
<polygon fill="black" stroke="black" points="1898.5,-38241.71 1895,-38231.71 1891.5,-38241.71 1898.5,-38241.71"/>
</g>
<!-- moe_21_mha -->
<g id="node405" class="node">
<title>moe_21_mha</title>
<polygon fill="lightgreen" stroke="black" points="2080,-37545.21 1764,-37545.21 1764,-37493.21 2080,-37493.21 2080,-37545.21"/>
<text text-anchor="middle" x="1922" y="-37533.21" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1922" y="-37522.21" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1922" y="-37511.21" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1922" y="-37500.21" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_20_res2&#45;&gt;moe_21_mha -->
<g id="edge659" class="edge">
<title>moe_20_res2&#45;&gt;moe_21_mha</title>
<path fill="none" stroke="black" d="M1922,-37592.11C1922,-37579.78 1922,-37566.88 1922,-37555.46"/>
<polygon fill="black" stroke="black" points="1925.5,-37555.45 1922,-37545.45 1918.5,-37555.45 1925.5,-37555.45"/>
</g>
<!-- moe_21_res1 -->
<g id="node426" class="node">
<title>moe_21_res1</title>
<polygon fill="lightyellow" stroke="black" points="2258.89,-37457.21 1722.97,-37457.21 1585.11,-37353.21 2121.03,-37353.21 2258.89,-37457.21"/>
<text text-anchor="middle" x="1922" y="-37419.21" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1922" y="-37408.21" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1922" y="-37397.21" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1922" y="-37386.21" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_21_mha&#45;&gt;moe_21_res1 -->
<g id="edge660" class="edge">
<title>moe_21_mha&#45;&gt;moe_21_res1</title>
<path fill="none" stroke="black" d="M1922,-37493.07C1922,-37485.39 1922,-37476.57 1922,-37467.57"/>
<polygon fill="black" stroke="black" points="1925.5,-37467.38 1922,-37457.38 1918.5,-37467.38 1925.5,-37467.38"/>
</g>
<!-- moe_21_gate -->
<g id="node406" class="node">
<title>moe_21_gate</title>
<polygon fill="lightyellow" stroke="black" points="2250.8,-37317.21 1727.75,-37317.21 1593.2,-37213.21 2116.25,-37213.21 2250.8,-37317.21"/>
<text text-anchor="middle" x="1922" y="-37279.21" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1922" y="-37268.21" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1922" y="-37257.21" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1922" y="-37246.21" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_21_route -->
<g id="node407" class="node">
<title>moe_21_route</title>
<ellipse fill="lightblue" stroke="black" cx="1922" cy="-37140.44" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1922" y="-37154.44" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1922" y="-37143.44" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1922" y="-37132.44" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1922" y="-37121.44" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_21_gate&#45;&gt;moe_21_route -->
<g id="edge662" class="edge">
<title>moe_21_gate&#45;&gt;moe_21_route</title>
<path fill="none" stroke="black" d="M1922,-37212.85C1922,-37204.44 1922,-37195.78 1922,-37187.51"/>
<polygon fill="black" stroke="black" points="1925.5,-37187.29 1922,-37177.29 1918.5,-37187.29 1925.5,-37187.29"/>
</g>
<!-- moe_21_expert_0 -->
<g id="node408" class="node">
<title>moe_21_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="289,-37067.67 71,-37067.67 71,-37015.67 289,-37015.67 289,-37067.67"/>
<text text-anchor="middle" x="180" y="-37055.67" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="180" y="-37044.67" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="180" y="-37033.67" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="180" y="-37022.67" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_21_route&#45;&gt;moe_21_expert_0 -->
<g id="edge663" class="edge">
<title>moe_21_route&#45;&gt;moe_21_expert_0</title>
<path fill="none" stroke="black" d="M1706.86,-37134.33C1334.31,-37124.76 582.6,-37102.05 299.46,-37067.74"/>
<polygon fill="black" stroke="black" points="299.54,-37064.22 289.18,-37066.46 298.68,-37071.17 299.54,-37064.22"/>
</g>
<!-- moe_21_expert_1 -->
<g id="node409" class="node">
<title>moe_21_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="525,-37067.67 307,-37067.67 307,-37015.67 525,-37015.67 525,-37067.67"/>
<text text-anchor="middle" x="416" y="-37055.67" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="416" y="-37044.67" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="416" y="-37033.67" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="416" y="-37022.67" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_21_route&#45;&gt;moe_21_expert_1 -->
<g id="edge664" class="edge">
<title>moe_21_route&#45;&gt;moe_21_expert_1</title>
<path fill="none" stroke="black" d="M1704.37,-37138.73C1432.48,-37135.45 953.16,-37121.76 535.36,-37067.75"/>
<polygon fill="black" stroke="black" points="535.56,-37064.25 525.19,-37066.43 534.65,-37071.19 535.56,-37064.25"/>
</g>
<!-- moe_21_expert_2 -->
<g id="node410" class="node">
<title>moe_21_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="761,-37067.67 543,-37067.67 543,-37015.67 761,-37015.67 761,-37067.67"/>
<text text-anchor="middle" x="652" y="-37055.67" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="652" y="-37044.67" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="652" y="-37033.67" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="652" y="-37022.67" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_21_route&#45;&gt;moe_21_expert_2 -->
<g id="edge665" class="edge">
<title>moe_21_route&#45;&gt;moe_21_expert_2</title>
<path fill="none" stroke="black" d="M1706.1,-37135.42C1476.3,-37128.97 1102.15,-37112.24 771.46,-37067.78"/>
<polygon fill="black" stroke="black" points="771.57,-37064.26 761.19,-37066.39 770.63,-37071.2 771.57,-37064.26"/>
</g>
<!-- moe_21_expert_3 -->
<g id="node411" class="node">
<title>moe_21_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="997,-37067.67 779,-37067.67 779,-37015.67 997,-37015.67 997,-37067.67"/>
<text text-anchor="middle" x="888" y="-37055.67" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="888" y="-37044.67" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="888" y="-37033.67" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="888" y="-37022.67" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_21_route&#45;&gt;moe_21_expert_3 -->
<g id="edge666" class="edge">
<title>moe_21_route&#45;&gt;moe_21_expert_3</title>
<path fill="none" stroke="black" d="M1711.49,-37130.76C1527.82,-37121.36 1254.17,-37102.94 1007.45,-37067.8"/>
<polygon fill="black" stroke="black" points="1007.6,-37064.28 997.2,-37066.33 1006.6,-37071.21 1007.6,-37064.28"/>
</g>
<!-- moe_21_expert_4 -->
<g id="node412" class="node">
<title>moe_21_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1233,-37067.67 1015,-37067.67 1015,-37015.67 1233,-37015.67 1233,-37067.67"/>
<text text-anchor="middle" x="1124" y="-37055.67" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1124" y="-37044.67" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1124" y="-37033.67" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1124" y="-37022.67" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_21_route&#45;&gt;moe_21_expert_4 -->
<g id="edge667" class="edge">
<title>moe_21_route&#45;&gt;moe_21_expert_4</title>
<path fill="none" stroke="black" d="M1726.37,-37124.2C1592.77,-37112.5 1411.63,-37094.1 1243.26,-37067.8"/>
<polygon fill="black" stroke="black" points="1243.64,-37064.32 1233.22,-37066.22 1242.55,-37071.24 1243.64,-37064.32"/>
</g>
<!-- moe_21_expert_5 -->
<g id="node413" class="node">
<title>moe_21_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1469,-37067.67 1251,-37067.67 1251,-37015.67 1469,-37015.67 1469,-37067.67"/>
<text text-anchor="middle" x="1360" y="-37055.67" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1360" y="-37044.67" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1360" y="-37033.67" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1360" y="-37022.67" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_21_route&#45;&gt;moe_21_expert_5 -->
<g id="edge668" class="edge">
<title>moe_21_route&#45;&gt;moe_21_expert_5</title>
<path fill="none" stroke="black" d="M1761.89,-37115.48C1680.03,-37102.76 1578.61,-37086.28 1479.18,-37067.86"/>
<polygon fill="black" stroke="black" points="1479.73,-37064.4 1469.25,-37066.01 1478.44,-37071.28 1479.73,-37064.4"/>
</g>
<!-- moe_21_expert_6 -->
<g id="node414" class="node">
<title>moe_21_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1705,-37067.67 1487,-37067.67 1487,-37015.67 1705,-37015.67 1705,-37067.67"/>
<text text-anchor="middle" x="1596" y="-37055.67" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1596" y="-37044.67" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1596" y="-37033.67" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1596" y="-37022.67" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_21_route&#45;&gt;moe_21_expert_6 -->
<g id="edge669" class="edge">
<title>moe_21_route&#45;&gt;moe_21_expert_6</title>
<path fill="none" stroke="black" d="M1816.61,-37108.15C1775.88,-37096.06 1729.64,-37082.34 1690.05,-37070.59"/>
<polygon fill="black" stroke="black" points="1690.99,-37067.21 1680.4,-37067.72 1688.99,-37073.92 1690.99,-37067.21"/>
</g>
<!-- moe_21_expert_7 -->
<g id="node415" class="node">
<title>moe_21_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1941,-37067.67 1723,-37067.67 1723,-37015.67 1941,-37015.67 1941,-37067.67"/>
<text text-anchor="middle" x="1832" y="-37055.67" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1832" y="-37044.67" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1832" y="-37033.67" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1832" y="-37022.67" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_21_route&#45;&gt;moe_21_expert_7 -->
<g id="edge670" class="edge">
<title>moe_21_route&#45;&gt;moe_21_expert_7</title>
<path fill="none" stroke="black" d="M1889,-37103.95C1880.3,-37094.6 1870.95,-37084.55 1862.39,-37075.35"/>
<polygon fill="black" stroke="black" points="1864.8,-37072.79 1855.42,-37067.85 1859.67,-37077.56 1864.8,-37072.79"/>
</g>
<!-- moe_21_expert_8 -->
<g id="node416" class="node">
<title>moe_21_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2177,-37067.67 1959,-37067.67 1959,-37015.67 2177,-37015.67 2177,-37067.67"/>
<text text-anchor="middle" x="2068" y="-37055.67" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2068" y="-37044.67" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2068" y="-37033.67" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2068" y="-37022.67" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_21_route&#45;&gt;moe_21_expert_8 -->
<g id="edge671" class="edge">
<title>moe_21_route&#45;&gt;moe_21_expert_8</title>
<path fill="none" stroke="black" d="M1974.71,-37104.5C1990,-37094.36 2006.59,-37083.37 2021.48,-37073.5"/>
<polygon fill="black" stroke="black" points="2023.62,-37076.28 2030.02,-37067.84 2019.75,-37070.45 2023.62,-37076.28"/>
</g>
<!-- moe_21_expert_9 -->
<g id="node417" class="node">
<title>moe_21_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2413,-37067.67 2195,-37067.67 2195,-37015.67 2413,-37015.67 2413,-37067.67"/>
<text text-anchor="middle" x="2304" y="-37055.67" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2304" y="-37044.67" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2304" y="-37033.67" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2304" y="-37022.67" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_21_route&#45;&gt;moe_21_expert_9 -->
<g id="edge672" class="edge">
<title>moe_21_route&#45;&gt;moe_21_expert_9</title>
<path fill="none" stroke="black" d="M2040.25,-37109.48C2089.76,-37096.94 2146.93,-37082.46 2195.36,-37070.19"/>
<polygon fill="black" stroke="black" points="2196.41,-37073.53 2205.24,-37067.68 2194.69,-37066.75 2196.41,-37073.53"/>
</g>
<!-- moe_21_expert_10 -->
<g id="node418" class="node">
<title>moe_21_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2649,-37067.67 2431,-37067.67 2431,-37015.67 2649,-37015.67 2649,-37067.67"/>
<text text-anchor="middle" x="2540" y="-37055.67" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2540" y="-37044.67" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2540" y="-37033.67" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2540" y="-37022.67" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_21_route&#45;&gt;moe_21_expert_10 -->
<g id="edge673" class="edge">
<title>moe_21_route&#45;&gt;moe_21_expert_10</title>
<path fill="none" stroke="black" d="M2093.4,-37117.69C2187.4,-37105.07 2306.15,-37088 2420.75,-37067.85"/>
<polygon fill="black" stroke="black" points="2421.52,-37071.27 2430.76,-37066.08 2420.3,-37064.37 2421.52,-37071.27"/>
</g>
<!-- moe_21_expert_11 -->
<g id="node419" class="node">
<title>moe_21_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2885,-37067.67 2667,-37067.67 2667,-37015.67 2885,-37015.67 2885,-37067.67"/>
<text text-anchor="middle" x="2776" y="-37055.67" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2776" y="-37044.67" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2776" y="-37033.67" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2776" y="-37022.67" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_21_route&#45;&gt;moe_21_expert_11 -->
<g id="edge674" class="edge">
<title>moe_21_route&#45;&gt;moe_21_expert_11</title>
<path fill="none" stroke="black" d="M2122.29,-37125.97C2268.11,-37114.73 2470.41,-37096.14 2656.8,-37067.79"/>
<polygon fill="black" stroke="black" points="2657.43,-37071.23 2666.79,-37066.25 2656.37,-37064.31 2657.43,-37071.23"/>
</g>
<!-- moe_21_expert_12 -->
<g id="node420" class="node">
<title>moe_21_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3121,-37067.67 2903,-37067.67 2903,-37015.67 3121,-37015.67 3121,-37067.67"/>
<text text-anchor="middle" x="3012" y="-37055.67" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3012" y="-37044.67" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3012" y="-37033.67" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3012" y="-37022.67" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_21_route&#45;&gt;moe_21_expert_12 -->
<g id="edge675" class="edge">
<title>moe_21_route&#45;&gt;moe_21_expert_12</title>
<path fill="none" stroke="black" d="M2134.3,-37132.02C2329.3,-37123.28 2626.26,-37105.12 2892.54,-37067.79"/>
<polygon fill="black" stroke="black" points="2893.39,-37071.21 2902.8,-37066.35 2892.41,-37064.28 2893.39,-37071.21"/>
</g>
<!-- moe_21_expert_13 -->
<g id="node421" class="node">
<title>moe_21_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3357,-37067.67 3139,-37067.67 3139,-37015.67 3357,-37015.67 3357,-37067.67"/>
<text text-anchor="middle" x="3248" y="-37055.67" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3248" y="-37044.67" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3248" y="-37033.67" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3248" y="-37022.67" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_21_route&#45;&gt;moe_21_expert_13 -->
<g id="edge676" class="edge">
<title>moe_21_route&#45;&gt;moe_21_expert_13</title>
<path fill="none" stroke="black" d="M2138.42,-37136.31C2378.58,-37130.6 2777.47,-37114.49 3128.69,-37067.76"/>
<polygon fill="black" stroke="black" points="3129.36,-37071.2 3138.81,-37066.4 3128.43,-37064.26 3129.36,-37071.2"/>
</g>
<!-- moe_21_expert_14 -->
<g id="node422" class="node">
<title>moe_21_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3593,-37067.67 3375,-37067.67 3375,-37015.67 3593,-37015.67 3593,-37067.67"/>
<text text-anchor="middle" x="3484" y="-37055.67" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3484" y="-37044.67" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3484" y="-37033.67" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3484" y="-37022.67" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_21_route&#45;&gt;moe_21_expert_14 -->
<g id="edge677" class="edge">
<title>moe_21_route&#45;&gt;moe_21_expert_14</title>
<path fill="none" stroke="black" d="M2139.77,-37139.37C2421.14,-37136.85 2925.96,-37124.04 3364.79,-37067.73"/>
<polygon fill="black" stroke="black" points="3365.35,-37071.19 3374.81,-37066.44 3364.45,-37064.25 3365.35,-37071.19"/>
</g>
<!-- moe_21_expert_15 -->
<g id="node423" class="node">
<title>moe_21_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3829,-37067.67 3611,-37067.67 3611,-37015.67 3829,-37015.67 3829,-37067.67"/>
<text text-anchor="middle" x="3720" y="-37055.67" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3720" y="-37044.67" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3720" y="-37033.67" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3720" y="-37022.67" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_21_route&#45;&gt;moe_21_expert_15 -->
<g id="edge678" class="edge">
<title>moe_21_route&#45;&gt;moe_21_expert_15</title>
<path fill="none" stroke="black" d="M2137.28,-37134.7C2520.25,-37125.53 3306.43,-37103.2 3600.56,-37067.73"/>
<polygon fill="black" stroke="black" points="3601.32,-37071.17 3610.82,-37066.47 3600.46,-37064.22 3601.32,-37071.17"/>
</g>
<!-- moe_21_aggregate -->
<g id="node424" class="node">
<title>moe_21_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1913" cy="-36942.9" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1913" y="-36956.9" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1913" y="-36945.9" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1913" y="-36934.9" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1913" y="-36923.9" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_21_expert_0&#45;&gt;moe_21_aggregate -->
<g id="edge679" class="edge">
<title>moe_21_expert_0&#45;&gt;moe_21_aggregate</title>
<path fill="none" stroke="black" d="M289.18,-37016.88C292.15,-37016.44 295.09,-37016.04 298,-37015.67 558.7,-36982.49 1302.26,-36959.44 1682.69,-36949.46"/>
<polygon fill="black" stroke="black" points="1682.82,-36952.96 1692.73,-36949.2 1682.64,-36945.96 1682.82,-36952.96"/>
</g>
<!-- moe_21_expert_1&#45;&gt;moe_21_aggregate -->
<g id="edge680" class="edge">
<title>moe_21_expert_1&#45;&gt;moe_21_aggregate</title>
<path fill="none" stroke="black" d="M525.19,-37016.91C528.15,-37016.46 531.09,-37016.05 534,-37015.67 934.18,-36963.19 1404.42,-36948.7 1679.5,-36944.92"/>
<polygon fill="black" stroke="black" points="1679.65,-36948.42 1689.6,-36944.79 1679.56,-36941.42 1679.65,-36948.42"/>
</g>
<!-- moe_21_expert_2&#45;&gt;moe_21_aggregate -->
<g id="edge681" class="edge">
<title>moe_21_expert_2&#45;&gt;moe_21_aggregate</title>
<path fill="none" stroke="black" d="M761.19,-37016.95C764.16,-37016.49 767.1,-37016.06 770,-37015.67 1083.98,-36972.78 1450.04,-36955.48 1681.63,-36948.52"/>
<polygon fill="black" stroke="black" points="1681.98,-36952.02 1691.87,-36948.22 1681.77,-36945.02 1681.98,-36952.02"/>
</g>
<!-- moe_21_expert_3&#45;&gt;moe_21_aggregate -->
<g id="edge682" class="edge">
<title>moe_21_expert_3&#45;&gt;moe_21_aggregate</title>
<path fill="none" stroke="black" d="M997.2,-37017.01C1000.16,-37016.54 1003.1,-37016.09 1006,-37015.67 1237.21,-36982.17 1504.01,-36963.42 1688.1,-36953.56"/>
<polygon fill="black" stroke="black" points="1688.37,-36957.05 1698.17,-36953.03 1688,-36950.06 1688.37,-36957.05"/>
</g>
<!-- moe_21_expert_4&#45;&gt;moe_21_aggregate -->
<g id="edge683" class="edge">
<title>moe_21_expert_4&#45;&gt;moe_21_aggregate</title>
<path fill="none" stroke="black" d="M1233.22,-37017.12C1236.17,-37016.61 1239.1,-37016.13 1242,-37015.67 1395.93,-36991.2 1571.08,-36972.78 1703.82,-36960.73"/>
<polygon fill="black" stroke="black" points="1704.47,-36964.18 1714.11,-36959.8 1703.84,-36957.21 1704.47,-36964.18"/>
</g>
<!-- moe_21_expert_5&#45;&gt;moe_21_aggregate -->
<g id="edge684" class="edge">
<title>moe_21_expert_5&#45;&gt;moe_21_aggregate</title>
<path fill="none" stroke="black" d="M1469.26,-37017.34C1472.2,-37016.77 1475.12,-37016.21 1478,-37015.67 1565.01,-36999.28 1662.21,-36983.05 1742.62,-36970.18"/>
<polygon fill="black" stroke="black" points="1743.52,-36973.58 1752.84,-36968.55 1742.41,-36966.67 1743.52,-36973.58"/>
</g>
<!-- moe_21_expert_6&#45;&gt;moe_21_aggregate -->
<g id="edge685" class="edge">
<title>moe_21_expert_6&#45;&gt;moe_21_aggregate</title>
<path fill="none" stroke="black" d="M1678.05,-37015.62C1715.16,-37004.29 1759.62,-36990.72 1799.83,-36978.45"/>
<polygon fill="black" stroke="black" points="1800.87,-36981.79 1809.41,-36975.52 1798.82,-36975.09 1800.87,-36981.79"/>
</g>
<!-- moe_21_expert_7&#45;&gt;moe_21_aggregate -->
<g id="edge686" class="edge">
<title>moe_21_expert_7&#45;&gt;moe_21_aggregate</title>
<path fill="none" stroke="black" d="M1853.07,-37015.5C1860.32,-37006.83 1868.66,-36996.87 1876.77,-36987.19"/>
<polygon fill="black" stroke="black" points="1879.46,-36989.42 1883.19,-36979.51 1874.09,-36984.93 1879.46,-36989.42"/>
</g>
<!-- moe_21_expert_8&#45;&gt;moe_21_aggregate -->
<g id="edge687" class="edge">
<title>moe_21_expert_8&#45;&gt;moe_21_aggregate</title>
<path fill="none" stroke="black" d="M2027.68,-37015.5C2012.33,-37005.91 1994.42,-36994.73 1977.39,-36984.1"/>
<polygon fill="black" stroke="black" points="1978.91,-36980.92 1968.58,-36978.6 1975.21,-36986.86 1978.91,-36980.92"/>
</g>
<!-- moe_21_expert_9&#45;&gt;moe_21_aggregate -->
<g id="edge688" class="edge">
<title>moe_21_expert_9&#45;&gt;moe_21_aggregate</title>
<path fill="none" stroke="black" d="M2202.8,-37015.62C2154.33,-37003.63 2095.7,-36989.11 2043.89,-36976.29"/>
<polygon fill="black" stroke="black" points="2044.51,-36972.84 2033.96,-36973.83 2042.82,-36979.63 2044.51,-36972.84"/>
</g>
<!-- moe_21_expert_10&#45;&gt;moe_21_aggregate -->
<g id="edge689" class="edge">
<title>moe_21_expert_10&#45;&gt;moe_21_aggregate</title>
<path fill="none" stroke="black" d="M2430.76,-37017.25C2427.81,-37016.7 2424.89,-37016.18 2422,-37015.67 2315.36,-36996.88 2195.47,-36979.78 2098.84,-36966.98"/>
<polygon fill="black" stroke="black" points="2099.05,-36963.48 2088.67,-36965.64 2098.13,-36970.42 2099.05,-36963.48"/>
</g>
<!-- moe_21_expert_11&#45;&gt;moe_21_aggregate -->
<g id="edge690" class="edge">
<title>moe_21_expert_11&#45;&gt;moe_21_aggregate</title>
<path fill="none" stroke="black" d="M2666.79,-37017.08C2663.83,-37016.58 2660.9,-37016.11 2658,-37015.67 2480.66,-36988.43 2277.89,-36969.69 2128.72,-36958.21"/>
<polygon fill="black" stroke="black" points="2128.76,-36954.71 2118.52,-36957.43 2128.22,-36961.69 2128.76,-36954.71"/>
</g>
<!-- moe_21_expert_12&#45;&gt;moe_21_aggregate -->
<g id="edge691" class="edge">
<title>moe_21_expert_12&#45;&gt;moe_21_aggregate</title>
<path fill="none" stroke="black" d="M2902.8,-37016.99C2899.84,-37016.52 2896.9,-37016.08 2894,-37015.67 2637.32,-36979.26 2340.09,-36960.79 2140.66,-36951.79"/>
<polygon fill="black" stroke="black" points="2140.79,-36948.3 2130.65,-36951.35 2140.48,-36955.29 2140.79,-36948.3"/>
</g>
<!-- moe_21_expert_13&#45;&gt;moe_21_aggregate -->
<g id="edge692" class="edge">
<title>moe_21_expert_13&#45;&gt;moe_21_aggregate</title>
<path fill="none" stroke="black" d="M3138.81,-37016.93C3135.85,-37016.48 3132.91,-37016.06 3130,-37015.67 2789.28,-36969.79 2390.97,-36953.24 2145.33,-36947.27"/>
<polygon fill="black" stroke="black" points="2145.28,-36943.76 2135.2,-36947.02 2145.11,-36950.76 2145.28,-36943.76"/>
</g>
<!-- moe_21_expert_14&#45;&gt;moe_21_aggregate -->
<g id="edge693" class="edge">
<title>moe_21_expert_14&#45;&gt;moe_21_aggregate</title>
<path fill="none" stroke="black" d="M3374.81,-37016.9C3371.85,-37016.46 3368.91,-37016.04 3366,-37015.67 2938.24,-36960.15 2434.54,-36946.77 2146.61,-36944.01"/>
<polygon fill="black" stroke="black" points="2146.49,-36940.51 2136.46,-36943.91 2146.42,-36947.5 2146.49,-36940.51"/>
</g>
<!-- moe_21_expert_15&#45;&gt;moe_21_aggregate -->
<g id="edge694" class="edge">
<title>moe_21_expert_15&#45;&gt;moe_21_aggregate</title>
<path fill="none" stroke="black" d="M3610.82,-37016.87C3607.85,-37016.44 3604.91,-37016.03 3602,-37015.67 3327.02,-36980.94 2538.43,-36958.39 2143.77,-36948.95"/>
<polygon fill="black" stroke="black" points="2143.74,-36945.45 2133.66,-36948.71 2143.57,-36952.45 2143.74,-36945.45"/>
</g>
<!-- moe_21_ffn -->
<g id="node425" class="node">
<title>moe_21_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2071,-36870.13 1755,-36870.13 1755,-36818.13 2071,-36818.13 2071,-36870.13"/>
<text text-anchor="middle" x="1913" y="-36858.13" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1913" y="-36847.13" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1913" y="-36836.13" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1913" y="-36825.13" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_21_aggregate&#45;&gt;moe_21_ffn -->
<g id="edge695" class="edge">
<title>moe_21_aggregate&#45;&gt;moe_21_ffn</title>
<path fill="none" stroke="black" d="M1913,-36905.86C1913,-36897.55 1913,-36888.72 1913,-36880.44"/>
<polygon fill="black" stroke="black" points="1916.5,-36880.32 1913,-36870.32 1909.5,-36880.32 1916.5,-36880.32"/>
</g>
<!-- moe_21_res2 -->
<g id="node427" class="node">
<title>moe_21_res2</title>
<polygon fill="lightyellow" stroke="black" points="2249.89,-36782.13 1713.97,-36782.13 1576.11,-36678.13 2112.03,-36678.13 2249.89,-36782.13"/>
<text text-anchor="middle" x="1913" y="-36744.13" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1913" y="-36733.13" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1913" y="-36722.13" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1913" y="-36711.13" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_21_ffn&#45;&gt;moe_21_res2 -->
<g id="edge696" class="edge">
<title>moe_21_ffn&#45;&gt;moe_21_res2</title>
<path fill="none" stroke="black" d="M1913,-36817.99C1913,-36810.31 1913,-36801.5 1913,-36792.5"/>
<polygon fill="black" stroke="black" points="1916.5,-36792.31 1913,-36782.31 1909.5,-36792.31 1916.5,-36792.31"/>
</g>
<!-- moe_21_res1&#45;&gt;moe_21_gate -->
<g id="edge661" class="edge">
<title>moe_21_res1&#45;&gt;moe_21_gate</title>
<path fill="none" stroke="black" d="M1922,-37352.82C1922,-37344.65 1922,-37336.12 1922,-37327.75"/>
<polygon fill="black" stroke="black" points="1925.5,-37327.64 1922,-37317.64 1918.5,-37327.64 1925.5,-37327.64"/>
</g>
<!-- moe_22_mha -->
<g id="node428" class="node">
<title>moe_22_mha</title>
<polygon fill="lightgreen" stroke="black" points="2071,-36631.13 1755,-36631.13 1755,-36579.13 2071,-36579.13 2071,-36631.13"/>
<text text-anchor="middle" x="1913" y="-36619.13" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1913" y="-36608.13" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1913" y="-36597.13" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1913" y="-36586.13" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_21_res2&#45;&gt;moe_22_mha -->
<g id="edge697" class="edge">
<title>moe_21_res2&#45;&gt;moe_22_mha</title>
<path fill="none" stroke="black" d="M1913,-36678.03C1913,-36665.7 1913,-36652.8 1913,-36641.38"/>
<polygon fill="black" stroke="black" points="1916.5,-36641.37 1913,-36631.37 1909.5,-36641.37 1916.5,-36641.37"/>
</g>
<!-- moe_22_res1 -->
<g id="node449" class="node">
<title>moe_22_res1</title>
<polygon fill="lightyellow" stroke="black" points="2249.89,-36543.13 1713.97,-36543.13 1576.11,-36439.13 2112.03,-36439.13 2249.89,-36543.13"/>
<text text-anchor="middle" x="1913" y="-36505.13" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1913" y="-36494.13" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1913" y="-36483.13" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1913" y="-36472.13" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_22_mha&#45;&gt;moe_22_res1 -->
<g id="edge698" class="edge">
<title>moe_22_mha&#45;&gt;moe_22_res1</title>
<path fill="none" stroke="black" d="M1913,-36578.99C1913,-36571.31 1913,-36562.5 1913,-36553.5"/>
<polygon fill="black" stroke="black" points="1916.5,-36553.31 1913,-36543.31 1909.5,-36553.31 1916.5,-36553.31"/>
</g>
<!-- moe_22_gate -->
<g id="node429" class="node">
<title>moe_22_gate</title>
<polygon fill="lightyellow" stroke="black" points="2241.8,-36403.13 1718.75,-36403.13 1584.2,-36299.13 2107.25,-36299.13 2241.8,-36403.13"/>
<text text-anchor="middle" x="1913" y="-36365.13" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1913" y="-36354.13" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1913" y="-36343.13" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1913" y="-36332.13" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_22_route -->
<g id="node430" class="node">
<title>moe_22_route</title>
<ellipse fill="lightblue" stroke="black" cx="1913" cy="-36226.36" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1913" y="-36240.36" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1913" y="-36229.36" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1913" y="-36218.36" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1913" y="-36207.36" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_22_gate&#45;&gt;moe_22_route -->
<g id="edge700" class="edge">
<title>moe_22_gate&#45;&gt;moe_22_route</title>
<path fill="none" stroke="black" d="M1913,-36298.77C1913,-36290.37 1913,-36281.7 1913,-36273.43"/>
<polygon fill="black" stroke="black" points="1916.5,-36273.21 1913,-36263.21 1909.5,-36273.21 1916.5,-36273.21"/>
</g>
<!-- moe_22_expert_0 -->
<g id="node431" class="node">
<title>moe_22_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="307,-36153.59 89,-36153.59 89,-36101.59 307,-36101.59 307,-36153.59"/>
<text text-anchor="middle" x="198" y="-36141.59" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="198" y="-36130.59" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="198" y="-36119.59" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="198" y="-36108.59" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_22_route&#45;&gt;moe_22_expert_0 -->
<g id="edge701" class="edge">
<title>moe_22_route&#45;&gt;moe_22_expert_0</title>
<path fill="none" stroke="black" d="M1698.14,-36220.07C1330.64,-36210.3 595.01,-36187.41 317.27,-36153.64"/>
<polygon fill="black" stroke="black" points="317.54,-36150.14 307.18,-36152.38 316.67,-36157.09 317.54,-36150.14"/>
</g>
<!-- moe_22_expert_1 -->
<g id="node432" class="node">
<title>moe_22_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="543,-36153.59 325,-36153.59 325,-36101.59 543,-36101.59 543,-36153.59"/>
<text text-anchor="middle" x="434" y="-36141.59" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="434" y="-36130.59" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="434" y="-36119.59" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="434" y="-36108.59" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_22_route&#45;&gt;moe_22_expert_1 -->
<g id="edge702" class="edge">
<title>moe_22_route&#45;&gt;moe_22_expert_1</title>
<path fill="none" stroke="black" d="M1695.48,-36224.32C1428.16,-36220.68 960.91,-36206.58 553.11,-36153.65"/>
<polygon fill="black" stroke="black" points="553.56,-36150.17 543.19,-36152.35 552.65,-36157.12 553.56,-36150.17"/>
</g>
<!-- moe_22_expert_2 -->
<g id="node433" class="node">
<title>moe_22_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="779,-36153.59 561,-36153.59 561,-36101.59 779,-36101.59 779,-36153.59"/>
<text text-anchor="middle" x="670" y="-36141.59" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="670" y="-36130.59" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="670" y="-36119.59" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="670" y="-36108.59" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_22_route&#45;&gt;moe_22_expert_2 -->
<g id="edge703" class="edge">
<title>moe_22_route&#45;&gt;moe_22_expert_2</title>
<path fill="none" stroke="black" d="M1697.45,-36220.89C1472.65,-36214.08 1110.12,-36197.07 789.16,-36153.66"/>
<polygon fill="black" stroke="black" points="789.57,-36150.19 779.19,-36152.31 788.63,-36157.12 789.57,-36150.19"/>
</g>
<!-- moe_22_expert_3 -->
<g id="node434" class="node">
<title>moe_22_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1015,-36153.59 797,-36153.59 797,-36101.59 1015,-36101.59 1015,-36153.59"/>
<text text-anchor="middle" x="906" y="-36141.59" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="906" y="-36130.59" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="906" y="-36119.59" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="906" y="-36108.59" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_22_route&#45;&gt;moe_22_expert_3 -->
<g id="edge704" class="edge">
<title>moe_22_route&#45;&gt;moe_22_expert_3</title>
<path fill="none" stroke="black" d="M1703.79,-36216.05C1525.65,-36206.35 1262.93,-36187.83 1025.42,-36153.72"/>
<polygon fill="black" stroke="black" points="1025.6,-36150.21 1015.2,-36152.24 1024.6,-36157.14 1025.6,-36150.21"/>
</g>
<!-- moe_22_expert_4 -->
<g id="node435" class="node">
<title>moe_22_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1251,-36153.59 1033,-36153.59 1033,-36101.59 1251,-36101.59 1251,-36153.59"/>
<text text-anchor="middle" x="1142" y="-36141.59" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1142" y="-36130.59" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1142" y="-36119.59" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1142" y="-36108.59" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_22_route&#45;&gt;moe_22_expert_4 -->
<g id="edge705" class="edge">
<title>moe_22_route&#45;&gt;moe_22_expert_4</title>
<path fill="none" stroke="black" d="M1720.17,-36209.24C1592.47,-36197.34 1421.19,-36179.07 1261.25,-36153.73"/>
<polygon fill="black" stroke="black" points="1261.65,-36150.25 1251.22,-36152.13 1260.54,-36157.16 1261.65,-36150.25"/>
</g>
<!-- moe_22_expert_5 -->
<g id="node436" class="node">
<title>moe_22_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1487,-36153.59 1269,-36153.59 1269,-36101.59 1487,-36101.59 1487,-36153.59"/>
<text text-anchor="middle" x="1378" y="-36141.59" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1378" y="-36130.59" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1378" y="-36119.59" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1378" y="-36108.59" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_22_route&#45;&gt;moe_22_expert_5 -->
<g id="edge706" class="edge">
<title>moe_22_route&#45;&gt;moe_22_expert_5</title>
<path fill="none" stroke="black" d="M1758.77,-36200.26C1682.78,-36187.55 1589.57,-36171.42 1497.34,-36153.82"/>
<polygon fill="black" stroke="black" points="1497.74,-36150.33 1487.26,-36151.89 1496.42,-36157.21 1497.74,-36150.33"/>
</g>
<!-- moe_22_expert_6 -->
<g id="node437" class="node">
<title>moe_22_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1723,-36153.59 1505,-36153.59 1505,-36101.59 1723,-36101.59 1723,-36153.59"/>
<text text-anchor="middle" x="1614" y="-36141.59" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1614" y="-36130.59" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1614" y="-36119.59" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1614" y="-36108.59" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_22_route&#45;&gt;moe_22_expert_6 -->
<g id="edge707" class="edge">
<title>moe_22_route&#45;&gt;moe_22_expert_6</title>
<path fill="none" stroke="black" d="M1814.68,-36193.54C1778.12,-36181.71 1736.91,-36168.37 1701.4,-36156.87"/>
<polygon fill="black" stroke="black" points="1702.13,-36153.43 1691.54,-36153.68 1699.97,-36160.09 1702.13,-36153.43"/>
</g>
<!-- moe_22_expert_7 -->
<g id="node438" class="node">
<title>moe_22_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1959,-36153.59 1741,-36153.59 1741,-36101.59 1959,-36101.59 1959,-36153.59"/>
<text text-anchor="middle" x="1850" y="-36141.59" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1850" y="-36130.59" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1850" y="-36119.59" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1850" y="-36108.59" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_22_route&#45;&gt;moe_22_expert_7 -->
<g id="edge708" class="edge">
<title>moe_22_route&#45;&gt;moe_22_expert_7</title>
<path fill="none" stroke="black" d="M1889.72,-36189.6C1883.88,-36180.64 1877.64,-36171.05 1871.88,-36162.19"/>
<polygon fill="black" stroke="black" points="1874.69,-36160.1 1866.3,-36153.63 1868.83,-36163.92 1874.69,-36160.1"/>
</g>
<!-- moe_22_expert_8 -->
<g id="node439" class="node">
<title>moe_22_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2195,-36153.59 1977,-36153.59 1977,-36101.59 2195,-36101.59 2195,-36153.59"/>
<text text-anchor="middle" x="2086" y="-36141.59" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2086" y="-36130.59" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2086" y="-36119.59" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2086" y="-36108.59" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_22_route&#45;&gt;moe_22_expert_8 -->
<g id="edge709" class="edge">
<title>moe_22_route&#45;&gt;moe_22_expert_8</title>
<path fill="none" stroke="black" d="M1974.48,-36190.97C1993.43,-36180.37 2014.12,-36168.79 2032.49,-36158.52"/>
<polygon fill="black" stroke="black" points="2034.28,-36161.53 2041.3,-36153.59 2030.86,-36155.42 2034.28,-36161.53"/>
</g>
<!-- moe_22_expert_9 -->
<g id="node440" class="node">
<title>moe_22_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2431,-36153.59 2213,-36153.59 2213,-36101.59 2431,-36101.59 2431,-36153.59"/>
<text text-anchor="middle" x="2322" y="-36141.59" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2322" y="-36130.59" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2322" y="-36119.59" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2322" y="-36108.59" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_22_route&#45;&gt;moe_22_expert_9 -->
<g id="edge710" class="edge">
<title>moe_22_route&#45;&gt;moe_22_expert_9</title>
<path fill="none" stroke="black" d="M2036.82,-36196.06C2090.72,-36183.31 2153.52,-36168.45 2206.45,-36155.93"/>
<polygon fill="black" stroke="black" points="2207.28,-36159.33 2216.21,-36153.62 2205.67,-36152.52 2207.28,-36159.33"/>
</g>
<!-- moe_22_expert_10 -->
<g id="node441" class="node">
<title>moe_22_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2667,-36153.59 2449,-36153.59 2449,-36101.59 2667,-36101.59 2667,-36153.59"/>
<text text-anchor="middle" x="2558" y="-36141.59" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2558" y="-36130.59" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2558" y="-36119.59" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2558" y="-36108.59" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_22_route&#45;&gt;moe_22_expert_10 -->
<g id="edge711" class="edge">
<title>moe_22_route&#45;&gt;moe_22_expert_10</title>
<path fill="none" stroke="black" d="M2089.16,-36204.65C2189.1,-36192.11 2316.63,-36174.77 2438.85,-36153.74"/>
<polygon fill="black" stroke="black" points="2439.51,-36157.18 2448.76,-36152.03 2438.31,-36150.28 2439.51,-36157.18"/>
</g>
<!-- moe_22_expert_11 -->
<g id="node442" class="node">
<title>moe_22_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2903,-36153.59 2685,-36153.59 2685,-36101.59 2903,-36101.59 2903,-36153.59"/>
<text text-anchor="middle" x="2794" y="-36141.59" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2794" y="-36130.59" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2794" y="-36119.59" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2794" y="-36108.59" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_22_route&#45;&gt;moe_22_expert_11 -->
<g id="edge712" class="edge">
<title>moe_22_route&#45;&gt;moe_22_expert_11</title>
<path fill="none" stroke="black" d="M2115.39,-36212.69C2266.97,-36201.69 2479.52,-36183.06 2674.63,-36153.73"/>
<polygon fill="black" stroke="black" points="2675.43,-36157.15 2684.79,-36152.19 2674.38,-36150.23 2675.43,-36157.15"/>
</g>
<!-- moe_22_expert_12 -->
<g id="node443" class="node">
<title>moe_22_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3139,-36153.59 2921,-36153.59 2921,-36101.59 3139,-36101.59 3139,-36153.59"/>
<text text-anchor="middle" x="3030" y="-36141.59" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3030" y="-36130.59" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3030" y="-36119.59" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3030" y="-36108.59" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_22_route&#45;&gt;moe_22_expert_12 -->
<g id="edge713" class="edge">
<title>moe_22_route&#45;&gt;moe_22_expert_12</title>
<path fill="none" stroke="black" d="M2125.83,-36218.52C2326.21,-36210.11 2634.69,-36192.11 2910.59,-36153.71"/>
<polygon fill="black" stroke="black" points="2911.39,-36157.13 2920.8,-36152.27 2910.41,-36150.2 2911.39,-36157.13"/>
</g>
<!-- moe_22_expert_13 -->
<g id="node444" class="node">
<title>moe_22_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3375,-36153.59 3157,-36153.59 3157,-36101.59 3375,-36101.59 3375,-36153.59"/>
<text text-anchor="middle" x="3266" y="-36141.59" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3266" y="-36130.59" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3266" y="-36119.59" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3266" y="-36108.59" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_22_route&#45;&gt;moe_22_expert_13 -->
<g id="edge714" class="edge">
<title>moe_22_route&#45;&gt;moe_22_expert_13</title>
<path fill="none" stroke="black" d="M2129.79,-36222.63C2374.85,-36217.28 2785.61,-36201.49 3146.68,-36153.68"/>
<polygon fill="black" stroke="black" points="3147.36,-36157.12 3156.81,-36152.33 3146.43,-36150.18 3147.36,-36157.12"/>
</g>
<!-- moe_22_expert_14 -->
<g id="node445" class="node">
<title>moe_22_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3611,-36153.59 3393,-36153.59 3393,-36101.59 3611,-36101.59 3611,-36153.59"/>
<text text-anchor="middle" x="3502" y="-36141.59" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3502" y="-36130.59" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3502" y="-36119.59" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3502" y="-36108.59" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_22_route&#45;&gt;moe_22_expert_14 -->
<g id="edge715" class="edge">
<title>moe_22_route&#45;&gt;moe_22_expert_14</title>
<path fill="none" stroke="black" d="M2130.8,-36225.59C2416.68,-36223.43 2933.88,-36211.06 3382.89,-36153.64"/>
<polygon fill="black" stroke="black" points="3383.34,-36157.11 3392.81,-36152.36 3382.45,-36150.17 3383.34,-36157.11"/>
</g>
<!-- moe_22_expert_15 -->
<g id="node446" class="node">
<title>moe_22_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3847,-36153.59 3629,-36153.59 3629,-36101.59 3847,-36101.59 3847,-36153.59"/>
<text text-anchor="middle" x="3738" y="-36141.59" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3738" y="-36130.59" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3738" y="-36119.59" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3738" y="-36108.59" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_22_route&#45;&gt;moe_22_expert_15 -->
<g id="edge716" class="edge">
<title>moe_22_route&#45;&gt;moe_22_expert_15</title>
<path fill="none" stroke="black" d="M2128.28,-36220.79C2516.28,-36211.81 3319.55,-36189.66 3618.82,-36153.62"/>
<polygon fill="black" stroke="black" points="3619.32,-36157.09 3628.82,-36152.39 3618.46,-36150.14 3619.32,-36157.09"/>
</g>
<!-- moe_22_aggregate -->
<g id="node447" class="node">
<title>moe_22_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1877" cy="-36028.82" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1877" y="-36042.82" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1877" y="-36031.82" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1877" y="-36020.82" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1877" y="-36009.82" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_22_expert_0&#45;&gt;moe_22_aggregate -->
<g id="edge717" class="edge">
<title>moe_22_expert_0&#45;&gt;moe_22_aggregate</title>
<path fill="none" stroke="black" d="M307.18,-36102.8C310.15,-36102.37 313.09,-36101.96 316,-36101.59 566.33,-36069.53 1277.31,-36046.16 1647.14,-36035.79"/>
<polygon fill="black" stroke="black" points="1647.27,-36039.28 1657.17,-36035.51 1647.08,-36032.29 1647.27,-36039.28"/>
</g>
<!-- moe_22_expert_1&#45;&gt;moe_22_aggregate -->
<g id="edge718" class="edge">
<title>moe_22_expert_1&#45;&gt;moe_22_aggregate</title>
<path fill="none" stroke="black" d="M543.19,-36102.84C546.15,-36102.39 549.09,-36101.97 552,-36101.59 932.22,-36051.32 1378.29,-36036.08 1643.75,-36031.57"/>
<polygon fill="black" stroke="black" points="1643.96,-36035.07 1653.9,-36031.4 1643.84,-36028.07 1643.96,-36035.07"/>
</g>
<!-- moe_22_expert_2&#45;&gt;moe_22_aggregate -->
<g id="edge719" class="edge">
<title>moe_22_expert_2&#45;&gt;moe_22_aggregate</title>
<path fill="none" stroke="black" d="M779.19,-36102.88C782.16,-36102.42 785.1,-36101.99 788,-36101.59 1082.72,-36060.87 1425.6,-36043.1 1646.69,-36035.45"/>
<polygon fill="black" stroke="black" points="1646.92,-36038.94 1656.79,-36035.1 1646.68,-36031.95 1646.92,-36038.94"/>
</g>
<!-- moe_22_expert_3&#45;&gt;moe_22_aggregate -->
<g id="edge720" class="edge">
<title>moe_22_expert_3&#45;&gt;moe_22_aggregate</title>
<path fill="none" stroke="black" d="M1015.2,-36102.95C1018.16,-36102.47 1021.1,-36102.02 1024,-36101.59 1236.81,-36070.22 1481.65,-36051.38 1654.28,-36040.93"/>
<polygon fill="black" stroke="black" points="1654.74,-36044.41 1664.51,-36040.31 1654.32,-36037.42 1654.74,-36044.41"/>
</g>
<!-- moe_22_expert_4&#45;&gt;moe_22_aggregate -->
<g id="edge721" class="edge">
<title>moe_22_expert_4&#45;&gt;moe_22_aggregate</title>
<path fill="none" stroke="black" d="M1251.22,-36103.08C1254.18,-36102.56 1257.11,-36102.06 1260,-36101.59 1397.67,-36079.05 1553.76,-36060.96 1674.5,-36048.58"/>
<polygon fill="black" stroke="black" points="1675,-36052.05 1684.59,-36047.55 1674.29,-36045.09 1675,-36052.05"/>
</g>
<!-- moe_22_expert_5&#45;&gt;moe_22_aggregate -->
<g id="edge722" class="edge">
<title>moe_22_expert_5&#45;&gt;moe_22_aggregate</title>
<path fill="none" stroke="black" d="M1487.27,-36103.35C1490.21,-36102.75 1493.13,-36102.16 1496,-36101.59 1569.6,-36086.86 1651.38,-36071.35 1720.24,-36058.52"/>
<polygon fill="black" stroke="black" points="1721.11,-36061.92 1730.3,-36056.65 1719.83,-36055.04 1721.11,-36061.92"/>
</g>
<!-- moe_22_expert_6&#45;&gt;moe_22_aggregate -->
<g id="edge723" class="edge">
<title>moe_22_expert_6&#45;&gt;moe_22_aggregate</title>
<path fill="none" stroke="black" d="M1682.07,-36101.54C1711.44,-36090.74 1746.36,-36077.89 1778.47,-36066.07"/>
<polygon fill="black" stroke="black" points="1779.71,-36069.35 1787.89,-36062.61 1777.3,-36062.78 1779.71,-36069.35"/>
</g>
<!-- moe_22_expert_7&#45;&gt;moe_22_aggregate -->
<g id="edge724" class="edge">
<title>moe_22_expert_7&#45;&gt;moe_22_aggregate</title>
<path fill="none" stroke="black" d="M1857.02,-36101.42C1859.23,-36093.52 1861.73,-36084.55 1864.2,-36075.69"/>
<polygon fill="black" stroke="black" points="1867.65,-36076.37 1866.96,-36065.8 1860.9,-36074.49 1867.65,-36076.37"/>
</g>
<!-- moe_22_expert_8&#45;&gt;moe_22_aggregate -->
<g id="edge725" class="edge">
<title>moe_22_expert_8&#45;&gt;moe_22_aggregate</title>
<path fill="none" stroke="black" d="M2031.91,-36101.54C2009.81,-36091.31 1983.77,-36079.25 1959.4,-36067.97"/>
<polygon fill="black" stroke="black" points="1960.7,-36064.72 1950.16,-36063.69 1957.76,-36071.07 1960.7,-36064.72"/>
</g>
<!-- moe_22_expert_9&#45;&gt;moe_22_aggregate -->
<g id="edge726" class="edge">
<title>moe_22_expert_9&#45;&gt;moe_22_aggregate</title>
<path fill="none" stroke="black" d="M2212.86,-36102.85C2154.48,-36090.16 2081.89,-36074.38 2019.16,-36060.73"/>
<polygon fill="black" stroke="black" points="2019.69,-36057.27 2009.18,-36058.56 2018.2,-36064.11 2019.69,-36057.27"/>
</g>
<!-- moe_22_expert_10&#45;&gt;moe_22_aggregate -->
<g id="edge727" class="edge">
<title>moe_22_expert_10&#45;&gt;moe_22_aggregate</title>
<path fill="none" stroke="black" d="M2448.77,-36103.12C2445.82,-36102.59 2442.89,-36102.08 2440,-36101.59 2318.23,-36080.96 2180.75,-36063.33 2072.12,-36050.71"/>
<polygon fill="black" stroke="black" points="2072.37,-36047.21 2062.03,-36049.54 2071.56,-36054.16 2072.37,-36047.21"/>
</g>
<!-- moe_22_expert_11&#45;&gt;moe_22_aggregate -->
<g id="edge728" class="edge">
<title>moe_22_expert_11&#45;&gt;moe_22_aggregate</title>
<path fill="none" stroke="black" d="M2684.79,-36102.97C2681.83,-36102.49 2678.9,-36102.03 2676,-36101.59 2481.07,-36072.29 2257.45,-36053.45 2096.45,-36042.46"/>
<polygon fill="black" stroke="black" points="2096.63,-36038.97 2086.42,-36041.78 2096.16,-36045.95 2096.63,-36038.97"/>
</g>
<!-- moe_22_expert_12&#45;&gt;moe_22_aggregate -->
<g id="edge729" class="edge">
<title>moe_22_expert_12&#45;&gt;moe_22_aggregate</title>
<path fill="none" stroke="black" d="M2920.8,-36102.89C2917.84,-36102.43 2914.9,-36102 2912,-36101.59 2636.45,-36063.04 2316.6,-36044.88 2106.24,-36036.54"/>
<polygon fill="black" stroke="black" points="2106.12,-36033.03 2095.99,-36036.14 2105.85,-36040.03 2106.12,-36033.03"/>
</g>
<!-- moe_22_expert_13&#45;&gt;moe_22_aggregate -->
<g id="edge730" class="edge">
<title>moe_22_expert_13&#45;&gt;moe_22_aggregate</title>
<path fill="none" stroke="black" d="M3156.81,-36102.84C3153.85,-36102.4 3150.91,-36101.98 3148,-36101.59 2787.51,-36053.51 2365.32,-36037.59 2109.69,-36032.35"/>
<polygon fill="black" stroke="black" points="2109.6,-36028.84 2099.53,-36032.14 2109.46,-36035.84 2109.6,-36028.84"/>
</g>
<!-- moe_22_expert_14&#45;&gt;moe_22_aggregate -->
<g id="edge731" class="edge">
<title>moe_22_expert_14&#45;&gt;moe_22_aggregate</title>
<path fill="none" stroke="black" d="M3392.82,-36102.81C3389.85,-36102.37 3386.91,-36101.96 3384,-36101.59 2935.94,-36043.84 2407.56,-36031.33 2110.48,-36029.31"/>
<polygon fill="black" stroke="black" points="2110.47,-36025.81 2100.45,-36029.25 2110.42,-36032.81 2110.47,-36025.81"/>
</g>
<!-- moe_22_expert_15&#45;&gt;moe_22_aggregate -->
<g id="edge732" class="edge">
<title>moe_22_expert_15&#45;&gt;moe_22_aggregate</title>
<path fill="none" stroke="black" d="M3628.82,-36102.79C3625.85,-36102.35 3622.91,-36101.95 3620,-36101.59 3334.57,-36065.73 2512.92,-36043.57 2108.07,-36034.52"/>
<polygon fill="black" stroke="black" points="2108.07,-36031.02 2098,-36034.3 2107.92,-36038.02 2108.07,-36031.02"/>
</g>
<!-- moe_22_ffn -->
<g id="node448" class="node">
<title>moe_22_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2035,-35956.05 1719,-35956.05 1719,-35904.05 2035,-35904.05 2035,-35956.05"/>
<text text-anchor="middle" x="1877" y="-35944.05" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1877" y="-35933.05" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1877" y="-35922.05" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1877" y="-35911.05" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_22_aggregate&#45;&gt;moe_22_ffn -->
<g id="edge733" class="edge">
<title>moe_22_aggregate&#45;&gt;moe_22_ffn</title>
<path fill="none" stroke="black" d="M1877,-35991.79C1877,-35983.47 1877,-35974.64 1877,-35966.36"/>
<polygon fill="black" stroke="black" points="1880.5,-35966.25 1877,-35956.25 1873.5,-35966.25 1880.5,-35966.25"/>
</g>
<!-- moe_22_res2 -->
<g id="node450" class="node">
<title>moe_22_res2</title>
<polygon fill="lightyellow" stroke="black" points="2213.89,-35868.05 1677.97,-35868.05 1540.11,-35764.05 2076.03,-35764.05 2213.89,-35868.05"/>
<text text-anchor="middle" x="1877" y="-35830.05" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1877" y="-35819.05" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1877" y="-35808.05" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1877" y="-35797.05" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_22_ffn&#45;&gt;moe_22_res2 -->
<g id="edge734" class="edge">
<title>moe_22_ffn&#45;&gt;moe_22_res2</title>
<path fill="none" stroke="black" d="M1877,-35903.92C1877,-35896.23 1877,-35887.42 1877,-35878.42"/>
<polygon fill="black" stroke="black" points="1880.5,-35878.23 1877,-35868.23 1873.5,-35878.23 1880.5,-35878.23"/>
</g>
<!-- moe_22_res1&#45;&gt;moe_22_gate -->
<g id="edge699" class="edge">
<title>moe_22_res1&#45;&gt;moe_22_gate</title>
<path fill="none" stroke="black" d="M1913,-36438.74C1913,-36430.57 1913,-36422.04 1913,-36413.67"/>
<polygon fill="black" stroke="black" points="1916.5,-36413.56 1913,-36403.56 1909.5,-36413.56 1916.5,-36413.56"/>
</g>
<!-- moe_23_mha -->
<g id="node451" class="node">
<title>moe_23_mha</title>
<polygon fill="lightgreen" stroke="black" points="2035,-35717.05 1719,-35717.05 1719,-35665.05 2035,-35665.05 2035,-35717.05"/>
<text text-anchor="middle" x="1877" y="-35705.05" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1877" y="-35694.05" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1877" y="-35683.05" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1877" y="-35672.05" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_22_res2&#45;&gt;moe_23_mha -->
<g id="edge735" class="edge">
<title>moe_22_res2&#45;&gt;moe_23_mha</title>
<path fill="none" stroke="black" d="M1877,-35763.96C1877,-35751.63 1877,-35738.72 1877,-35727.3"/>
<polygon fill="black" stroke="black" points="1880.5,-35727.29 1877,-35717.29 1873.5,-35727.29 1880.5,-35727.29"/>
</g>
<!-- moe_23_res1 -->
<g id="node472" class="node">
<title>moe_23_res1</title>
<polygon fill="lightyellow" stroke="black" points="2213.89,-35629.05 1677.97,-35629.05 1540.11,-35525.05 2076.03,-35525.05 2213.89,-35629.05"/>
<text text-anchor="middle" x="1877" y="-35591.05" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1877" y="-35580.05" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1877" y="-35569.05" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1877" y="-35558.05" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_23_mha&#45;&gt;moe_23_res1 -->
<g id="edge736" class="edge">
<title>moe_23_mha&#45;&gt;moe_23_res1</title>
<path fill="none" stroke="black" d="M1877,-35664.92C1877,-35657.23 1877,-35648.42 1877,-35639.42"/>
<polygon fill="black" stroke="black" points="1880.5,-35639.23 1877,-35629.23 1873.5,-35639.23 1880.5,-35639.23"/>
</g>
<!-- moe_23_gate -->
<g id="node452" class="node">
<title>moe_23_gate</title>
<polygon fill="lightyellow" stroke="black" points="2205.8,-35489.05 1682.75,-35489.05 1548.2,-35385.05 2071.25,-35385.05 2205.8,-35489.05"/>
<text text-anchor="middle" x="1877" y="-35451.05" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1877" y="-35440.05" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1877" y="-35429.05" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1877" y="-35418.05" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_23_route -->
<g id="node453" class="node">
<title>moe_23_route</title>
<ellipse fill="lightblue" stroke="black" cx="1877" cy="-35312.28" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1877" y="-35326.28" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1877" y="-35315.28" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1877" y="-35304.28" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1877" y="-35293.28" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_23_gate&#45;&gt;moe_23_route -->
<g id="edge738" class="edge">
<title>moe_23_gate&#45;&gt;moe_23_route</title>
<path fill="none" stroke="black" d="M1877,-35384.7C1877,-35376.29 1877,-35367.62 1877,-35359.35"/>
<polygon fill="black" stroke="black" points="1880.5,-35359.14 1877,-35349.14 1873.5,-35359.14 1880.5,-35359.14"/>
</g>
<!-- moe_23_expert_0 -->
<g id="node454" class="node">
<title>moe_23_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="279,-35239.51 61,-35239.51 61,-35187.51 279,-35187.51 279,-35239.51"/>
<text text-anchor="middle" x="170" y="-35227.51" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="170" y="-35216.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="170" y="-35205.51" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="170" y="-35194.51" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_23_route&#45;&gt;moe_23_expert_0 -->
<g id="edge739" class="edge">
<title>moe_23_route&#45;&gt;moe_23_expert_0</title>
<path fill="none" stroke="black" d="M1662.11,-35305.94C1296.09,-35296.11 565.32,-35273.17 289.21,-35239.55"/>
<polygon fill="black" stroke="black" points="289.54,-35236.07 279.18,-35238.3 288.67,-35243.01 289.54,-35236.07"/>
</g>
<!-- moe_23_expert_1 -->
<g id="node455" class="node">
<title>moe_23_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="515,-35239.51 297,-35239.51 297,-35187.51 515,-35187.51 515,-35239.51"/>
<text text-anchor="middle" x="406" y="-35227.51" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="406" y="-35216.51" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="406" y="-35205.51" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="406" y="-35194.51" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_23_route&#45;&gt;moe_23_expert_1 -->
<g id="edge740" class="edge">
<title>moe_23_route&#45;&gt;moe_23_expert_1</title>
<path fill="none" stroke="black" d="M1659.29,-35310.14C1393.36,-35306.38 929.98,-35292.17 525.34,-35239.6"/>
<polygon fill="black" stroke="black" points="525.56,-35236.1 515.19,-35238.27 524.65,-35243.04 525.56,-35236.1"/>
</g>
<!-- moe_23_expert_2 -->
<g id="node456" class="node">
<title>moe_23_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="751,-35239.51 533,-35239.51 533,-35187.51 751,-35187.51 751,-35239.51"/>
<text text-anchor="middle" x="642" y="-35227.51" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="642" y="-35216.51" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="642" y="-35205.51" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="642" y="-35194.51" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_23_route&#45;&gt;moe_23_expert_2 -->
<g id="edge741" class="edge">
<title>moe_23_route&#45;&gt;moe_23_expert_2</title>
<path fill="none" stroke="black" d="M1661.68,-35306.67C1438.48,-35299.76 1079.57,-35282.69 761.54,-35239.64"/>
<polygon fill="black" stroke="black" points="761.57,-35236.11 751.19,-35238.23 760.63,-35243.05 761.57,-35236.11"/>
</g>
<!-- moe_23_expert_3 -->
<g id="node457" class="node">
<title>moe_23_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="987,-35239.51 769,-35239.51 769,-35187.51 987,-35187.51 987,-35239.51"/>
<text text-anchor="middle" x="878" y="-35227.51" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="878" y="-35216.51" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="878" y="-35205.51" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="878" y="-35194.51" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_23_route&#45;&gt;moe_23_expert_3 -->
<g id="edge742" class="edge">
<title>moe_23_route&#45;&gt;moe_23_expert_3</title>
<path fill="none" stroke="black" d="M1667.89,-35301.77C1491.38,-35291.97 1232,-35273.42 997.3,-35239.62"/>
<polygon fill="black" stroke="black" points="997.6,-35236.13 987.2,-35238.16 996.6,-35243.06 997.6,-35236.13"/>
</g>
<!-- moe_23_expert_4 -->
<g id="node458" class="node">
<title>moe_23_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1223,-35239.51 1005,-35239.51 1005,-35187.51 1223,-35187.51 1223,-35239.51"/>
<text text-anchor="middle" x="1114" y="-35227.51" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1114" y="-35216.51" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1114" y="-35205.51" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1114" y="-35194.51" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_23_route&#45;&gt;moe_23_expert_4 -->
<g id="edge743" class="edge">
<title>moe_23_route&#45;&gt;moe_23_expert_4</title>
<path fill="none" stroke="black" d="M1684.77,-35294.86C1558.94,-35282.92 1390.82,-35264.72 1233.56,-35239.7"/>
<polygon fill="black" stroke="black" points="1233.65,-35236.17 1223.22,-35238.04 1232.54,-35243.08 1233.65,-35236.17"/>
</g>
<!-- moe_23_expert_5 -->
<g id="node459" class="node">
<title>moe_23_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1459,-35239.51 1241,-35239.51 1241,-35187.51 1459,-35187.51 1459,-35239.51"/>
<text text-anchor="middle" x="1350" y="-35227.51" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1350" y="-35216.51" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1350" y="-35205.51" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1350" y="-35194.51" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_23_route&#45;&gt;moe_23_expert_5 -->
<g id="edge744" class="edge">
<title>moe_23_route&#45;&gt;moe_23_expert_5</title>
<path fill="none" stroke="black" d="M1724.78,-35285.88C1650.42,-35273.15 1559.41,-35257.09 1469.13,-35239.71"/>
<polygon fill="black" stroke="black" points="1469.75,-35236.26 1459.26,-35237.8 1468.42,-35243.13 1469.75,-35236.26"/>
</g>
<!-- moe_23_expert_6 -->
<g id="node460" class="node">
<title>moe_23_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1695,-35239.51 1477,-35239.51 1477,-35187.51 1695,-35187.51 1695,-35239.51"/>
<text text-anchor="middle" x="1586" y="-35227.51" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1586" y="-35216.51" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1586" y="-35205.51" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1586" y="-35194.51" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_23_route&#45;&gt;moe_23_expert_6 -->
<g id="edge745" class="edge">
<title>moe_23_route&#45;&gt;moe_23_expert_6</title>
<path fill="none" stroke="black" d="M1780.51,-35279.19C1745.12,-35267.42 1705.35,-35254.2 1671.04,-35242.79"/>
<polygon fill="black" stroke="black" points="1672.11,-35239.46 1661.52,-35239.62 1669.9,-35246.1 1672.11,-35239.46"/>
</g>
<!-- moe_23_expert_7 -->
<g id="node461" class="node">
<title>moe_23_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1931,-35239.51 1713,-35239.51 1713,-35187.51 1931,-35187.51 1931,-35239.51"/>
<text text-anchor="middle" x="1822" y="-35227.51" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1822" y="-35216.51" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1822" y="-35205.51" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1822" y="-35194.51" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_23_route&#45;&gt;moe_23_expert_7 -->
<g id="edge746" class="edge">
<title>moe_23_route&#45;&gt;moe_23_expert_7</title>
<path fill="none" stroke="black" d="M1856.68,-35275.52C1851.63,-35266.65 1846.25,-35257.17 1841.26,-35248.39"/>
<polygon fill="black" stroke="black" points="1844.22,-35246.52 1836.23,-35239.55 1838.13,-35249.98 1844.22,-35246.52"/>
</g>
<!-- moe_23_expert_8 -->
<g id="node462" class="node">
<title>moe_23_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2167,-35239.51 1949,-35239.51 1949,-35187.51 2167,-35187.51 2167,-35239.51"/>
<text text-anchor="middle" x="2058" y="-35227.51" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2058" y="-35216.51" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2058" y="-35205.51" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2058" y="-35194.51" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_23_route&#45;&gt;moe_23_expert_8 -->
<g id="edge747" class="edge">
<title>moe_23_route&#45;&gt;moe_23_expert_8</title>
<path fill="none" stroke="black" d="M1941.07,-35277.03C1961,-35266.37 1982.8,-35254.72 2002.12,-35244.38"/>
<polygon fill="black" stroke="black" points="2003.93,-35247.39 2011.1,-35239.59 2000.63,-35241.21 2003.93,-35247.39"/>
</g>
<!-- moe_23_expert_9 -->
<g id="node463" class="node">
<title>moe_23_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2403,-35239.51 2185,-35239.51 2185,-35187.51 2403,-35187.51 2403,-35239.51"/>
<text text-anchor="middle" x="2294" y="-35227.51" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2294" y="-35216.51" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2294" y="-35205.51" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2294" y="-35194.51" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_23_route&#45;&gt;moe_23_expert_9 -->
<g id="edge748" class="edge">
<title>moe_23_route&#45;&gt;moe_23_expert_9</title>
<path fill="none" stroke="black" d="M2002.4,-35282.18C2057.49,-35269.4 2121.84,-35254.46 2176.06,-35241.88"/>
<polygon fill="black" stroke="black" points="2177.11,-35245.23 2186.06,-35239.56 2175.53,-35238.41 2177.11,-35245.23"/>
</g>
<!-- moe_23_expert_10 -->
<g id="node464" class="node">
<title>moe_23_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2639,-35239.51 2421,-35239.51 2421,-35187.51 2639,-35187.51 2639,-35239.51"/>
<text text-anchor="middle" x="2530" y="-35227.51" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2530" y="-35216.51" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2530" y="-35205.51" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2530" y="-35194.51" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_23_route&#45;&gt;moe_23_expert_10 -->
<g id="edge749" class="edge">
<title>moe_23_route&#45;&gt;moe_23_expert_10</title>
<path fill="none" stroke="black" d="M2054.32,-35290.9C2155.99,-35278.39 2286.15,-35260.98 2410.66,-35239.69"/>
<polygon fill="black" stroke="black" points="2411.5,-35243.1 2420.76,-35237.96 2410.32,-35236.2 2411.5,-35243.1"/>
</g>
<!-- moe_23_expert_11 -->
<g id="node465" class="node">
<title>moe_23_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2875,-35239.51 2657,-35239.51 2657,-35187.51 2875,-35187.51 2875,-35239.51"/>
<text text-anchor="middle" x="2766" y="-35227.51" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2766" y="-35216.51" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2766" y="-35205.51" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2766" y="-35194.51" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_23_route&#45;&gt;moe_23_expert_11 -->
<g id="edge750" class="edge">
<title>moe_23_route&#45;&gt;moe_23_expert_11</title>
<path fill="none" stroke="black" d="M2079.89,-35298.85C2233.23,-35287.92 2448.98,-35269.27 2646.79,-35239.63"/>
<polygon fill="black" stroke="black" points="2647.43,-35243.07 2656.79,-35238.11 2646.38,-35236.15 2647.43,-35243.07"/>
</g>
<!-- moe_23_expert_12 -->
<g id="node466" class="node">
<title>moe_23_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3111,-35239.51 2893,-35239.51 2893,-35187.51 3111,-35187.51 3111,-35239.51"/>
<text text-anchor="middle" x="3002" y="-35227.51" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3002" y="-35216.51" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3002" y="-35205.51" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3002" y="-35194.51" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_23_route&#45;&gt;moe_23_expert_12 -->
<g id="edge751" class="edge">
<title>moe_23_route&#45;&gt;moe_23_expert_12</title>
<path fill="none" stroke="black" d="M2090.07,-35304.61C2292.11,-35296.29 2604.1,-35278.33 2882.9,-35239.59"/>
<polygon fill="black" stroke="black" points="2883.38,-35243.05 2892.8,-35238.2 2882.41,-35236.12 2883.38,-35243.05"/>
</g>
<!-- moe_23_expert_13 -->
<g id="node467" class="node">
<title>moe_23_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3347,-35239.51 3129,-35239.51 3129,-35187.51 3347,-35187.51 3347,-35239.51"/>
<text text-anchor="middle" x="3238" y="-35227.51" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3238" y="-35216.51" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3238" y="-35205.51" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3238" y="-35194.51" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_23_route&#45;&gt;moe_23_expert_13 -->
<g id="edge752" class="edge">
<title>moe_23_route&#45;&gt;moe_23_expert_13</title>
<path fill="none" stroke="black" d="M2093.79,-35308.67C2340.33,-35303.43 2754.78,-35287.73 3118.87,-35239.58"/>
<polygon fill="black" stroke="black" points="3119.36,-35243.04 3128.81,-35238.25 3118.44,-35236.1 3119.36,-35243.04"/>
</g>
<!-- moe_23_expert_14 -->
<g id="node468" class="node">
<title>moe_23_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3583,-35239.51 3365,-35239.51 3365,-35187.51 3583,-35187.51 3583,-35239.51"/>
<text text-anchor="middle" x="3474" y="-35227.51" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3474" y="-35216.51" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3474" y="-35205.51" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3474" y="-35194.51" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_23_route&#45;&gt;moe_23_expert_14 -->
<g id="edge753" class="edge">
<title>moe_23_route&#45;&gt;moe_23_expert_14</title>
<path fill="none" stroke="black" d="M2095.05,-35311.59C2382.29,-35309.54 2902.94,-35297.3 3354.82,-35239.57"/>
<polygon fill="black" stroke="black" points="3355.34,-35243.03 3364.81,-35238.29 3354.45,-35236.09 3355.34,-35243.03"/>
</g>
<!-- moe_23_expert_15 -->
<g id="node469" class="node">
<title>moe_23_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3819,-35239.51 3601,-35239.51 3601,-35187.51 3819,-35187.51 3819,-35239.51"/>
<text text-anchor="middle" x="3710" y="-35227.51" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3710" y="-35216.51" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3710" y="-35205.51" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3710" y="-35194.51" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_23_route&#45;&gt;moe_23_expert_15 -->
<g id="edge754" class="edge">
<title>moe_23_route&#45;&gt;moe_23_expert_15</title>
<path fill="none" stroke="black" d="M2092.52,-35306.75C2482.04,-35297.83 3289.94,-35275.74 3590.77,-35239.55"/>
<polygon fill="black" stroke="black" points="3591.32,-35243.01 3600.82,-35238.31 3590.46,-35236.06 3591.32,-35243.01"/>
</g>
<!-- moe_23_aggregate -->
<g id="node470" class="node">
<title>moe_23_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1956" cy="-35114.74" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1956" y="-35128.74" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1956" y="-35117.74" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1956" y="-35106.74" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1956" y="-35095.74" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_23_expert_0&#45;&gt;moe_23_aggregate -->
<g id="edge755" class="edge">
<title>moe_23_expert_0&#45;&gt;moe_23_aggregate</title>
<path fill="none" stroke="black" d="M279.18,-35188.71C282.15,-35188.28 285.09,-35187.88 288,-35187.51 558.93,-35153.22 1334.77,-35130.53 1725.4,-35120.93"/>
<polygon fill="black" stroke="black" points="1725.51,-35124.43 1735.42,-35120.69 1725.34,-35117.44 1725.51,-35124.43"/>
</g>
<!-- moe_23_expert_1&#45;&gt;moe_23_aggregate -->
<g id="edge756" class="edge">
<title>moe_23_expert_1&#45;&gt;moe_23_aggregate</title>
<path fill="none" stroke="black" d="M515.19,-35188.74C518.15,-35188.3 521.09,-35187.89 524,-35187.51 943.9,-35132.86 1438.05,-35119.15 1722.37,-35116.1"/>
<polygon fill="black" stroke="black" points="1722.43,-35119.6 1732.4,-35116 1722.36,-35112.6 1722.43,-35119.6"/>
</g>
<!-- moe_23_expert_2&#45;&gt;moe_23_aggregate -->
<g id="edge757" class="edge">
<title>moe_23_expert_2&#45;&gt;moe_23_aggregate</title>
<path fill="none" stroke="black" d="M751.19,-35188.78C754.15,-35188.33 757.09,-35187.9 760,-35187.51 1093.02,-35142.5 1482.03,-35125.71 1723.74,-35119.46"/>
<polygon fill="black" stroke="black" points="1724.15,-35122.95 1734.06,-35119.2 1723.98,-35115.95 1724.15,-35122.95"/>
</g>
<!-- moe_23_expert_3&#45;&gt;moe_23_aggregate -->
<g id="edge758" class="edge">
<title>moe_23_expert_3&#45;&gt;moe_23_aggregate</title>
<path fill="none" stroke="black" d="M987.2,-35188.84C990.16,-35188.37 993.1,-35187.93 996,-35187.51 1245.23,-35151.96 1533.53,-35133.4 1728.64,-35124.14"/>
<polygon fill="black" stroke="black" points="1728.91,-35127.63 1738.73,-35123.66 1728.58,-35120.64 1728.91,-35127.63"/>
</g>
<!-- moe_23_expert_4&#45;&gt;moe_23_aggregate -->
<g id="edge759" class="edge">
<title>moe_23_expert_4&#45;&gt;moe_23_aggregate</title>
<path fill="none" stroke="black" d="M1223.21,-35188.93C1226.17,-35188.43 1229.1,-35187.96 1232,-35187.51 1402.65,-35161.06 1597.53,-35142.39 1742.08,-35130.74"/>
<polygon fill="black" stroke="black" points="1742.71,-35134.2 1752.4,-35129.91 1742.15,-35127.22 1742.71,-35134.2"/>
</g>
<!-- moe_23_expert_5&#45;&gt;moe_23_aggregate -->
<g id="edge760" class="edge">
<title>moe_23_expert_5&#45;&gt;moe_23_aggregate</title>
<path fill="none" stroke="black" d="M1459.24,-35189.11C1462.19,-35188.56 1465.11,-35188.03 1468,-35187.51 1568.95,-35169.41 1682.24,-35152.54 1774.24,-35139.71"/>
<polygon fill="black" stroke="black" points="1774.79,-35143.17 1784.21,-35138.32 1773.83,-35136.23 1774.79,-35143.17"/>
</g>
<!-- moe_23_expert_6&#45;&gt;moe_23_aggregate -->
<g id="edge761" class="edge">
<title>moe_23_expert_6&#45;&gt;moe_23_aggregate</title>
<path fill="none" stroke="black" d="M1681.77,-35187.46C1726.84,-35175.68 1781.2,-35161.46 1829.6,-35148.8"/>
<polygon fill="black" stroke="black" points="1830.72,-35152.12 1839.51,-35146.21 1828.95,-35145.35 1830.72,-35152.12"/>
</g>
<!-- moe_23_expert_7&#45;&gt;moe_23_aggregate -->
<g id="edge762" class="edge">
<title>moe_23_expert_7&#45;&gt;moe_23_aggregate</title>
<path fill="none" stroke="black" d="M1856.86,-35187.34C1869.76,-35178.02 1884.74,-35167.2 1899.09,-35156.84"/>
<polygon fill="black" stroke="black" points="1901.39,-35159.5 1907.45,-35150.8 1897.29,-35153.82 1901.39,-35159.5"/>
</g>
<!-- moe_23_expert_8&#45;&gt;moe_23_aggregate -->
<g id="edge763" class="edge">
<title>moe_23_expert_8&#45;&gt;moe_23_aggregate</title>
<path fill="none" stroke="black" d="M2031.47,-35187.34C2022.16,-35178.51 2011.42,-35168.32 2001.02,-35158.46"/>
<polygon fill="black" stroke="black" points="2003.2,-35155.7 1993.54,-35151.35 1998.38,-35160.77 2003.2,-35155.7"/>
</g>
<!-- moe_23_expert_9&#45;&gt;moe_23_aggregate -->
<g id="edge764" class="edge">
<title>moe_23_expert_9&#45;&gt;moe_23_aggregate</title>
<path fill="none" stroke="black" d="M2206.52,-35187.46C2166.33,-35175.96 2118.05,-35162.14 2074.65,-35149.71"/>
<polygon fill="black" stroke="black" points="2075.47,-35146.31 2064.89,-35146.92 2073.54,-35153.04 2075.47,-35146.31"/>
</g>
<!-- moe_23_expert_10&#45;&gt;moe_23_aggregate -->
<g id="edge765" class="edge">
<title>moe_23_expert_10&#45;&gt;moe_23_aggregate</title>
<path fill="none" stroke="black" d="M2420.75,-35189.15C2417.8,-35188.59 2414.88,-35188.04 2412,-35187.51 2319.51,-35170.45 2216,-35153.95 2131,-35141.08"/>
<polygon fill="black" stroke="black" points="2131.4,-35137.6 2120.99,-35139.57 2130.35,-35144.52 2131.4,-35137.6"/>
</g>
<!-- moe_23_expert_11&#45;&gt;moe_23_aggregate -->
<g id="edge766" class="edge">
<title>moe_23_expert_11&#45;&gt;moe_23_aggregate</title>
<path fill="none" stroke="black" d="M2656.78,-35188.95C2653.83,-35188.45 2650.9,-35187.97 2648,-35187.51 2487.51,-35162.26 2304.63,-35143.73 2167.19,-35131.83"/>
<polygon fill="black" stroke="black" points="2167.23,-35128.32 2156.96,-35130.95 2166.63,-35135.29 2167.23,-35128.32"/>
</g>
<!-- moe_23_expert_12&#45;&gt;moe_23_aggregate -->
<g id="edge767" class="edge">
<title>moe_23_expert_12&#45;&gt;moe_23_aggregate</title>
<path fill="none" stroke="black" d="M2892.8,-35188.85C2889.84,-35188.38 2886.9,-35187.93 2884,-35187.51 2645.75,-35153.21 2370.56,-35134.53 2182.09,-35124.9"/>
<polygon fill="black" stroke="black" points="2182.22,-35121.4 2172.06,-35124.39 2181.87,-35128.39 2182.22,-35121.4"/>
</g>
<!-- moe_23_expert_13&#45;&gt;moe_23_aggregate -->
<g id="edge768" class="edge">
<title>moe_23_expert_13&#45;&gt;moe_23_aggregate</title>
<path fill="none" stroke="black" d="M3128.81,-35188.79C3125.85,-35188.33 3122.9,-35187.91 3120,-35187.51 2798.49,-35143.78 2423.35,-35126.68 2187.73,-35120"/>
<polygon fill="black" stroke="black" points="2187.76,-35116.5 2177.66,-35119.72 2187.56,-35123.5 2187.76,-35116.5"/>
</g>
<!-- moe_23_expert_14&#45;&gt;moe_23_aggregate -->
<g id="edge769" class="edge">
<title>moe_23_expert_14&#45;&gt;moe_23_aggregate</title>
<path fill="none" stroke="black" d="M3364.81,-35188.75C3361.85,-35188.3 3358.91,-35187.89 3356,-35187.51 2948.08,-35134.18 2468.47,-35119.99 2189.69,-35116.5"/>
<polygon fill="black" stroke="black" points="2189.49,-35113 2179.45,-35116.37 2189.4,-35120 2189.49,-35113"/>
</g>
<!-- moe_23_expert_15&#45;&gt;moe_23_aggregate -->
<g id="edge770" class="edge">
<title>moe_23_expert_15&#45;&gt;moe_23_aggregate</title>
<path fill="none" stroke="black" d="M3600.82,-35188.72C3597.85,-35188.28 3594.91,-35187.88 3592,-35187.51 3327.29,-35153.9 2571.19,-35130.99 2186.63,-35121.16"/>
<polygon fill="black" stroke="black" points="2186.57,-35117.66 2176.49,-35120.9 2186.4,-35124.66 2186.57,-35117.66"/>
</g>
<!-- moe_23_ffn -->
<g id="node471" class="node">
<title>moe_23_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2114,-35041.97 1798,-35041.97 1798,-34989.97 2114,-34989.97 2114,-35041.97"/>
<text text-anchor="middle" x="1956" y="-35029.97" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1956" y="-35018.97" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1956" y="-35007.97" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1956" y="-34996.97" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_23_aggregate&#45;&gt;moe_23_ffn -->
<g id="edge771" class="edge">
<title>moe_23_aggregate&#45;&gt;moe_23_ffn</title>
<path fill="none" stroke="black" d="M1956,-35077.71C1956,-35069.4 1956,-35060.56 1956,-35052.28"/>
<polygon fill="black" stroke="black" points="1959.5,-35052.17 1956,-35042.17 1952.5,-35052.17 1959.5,-35052.17"/>
</g>
<!-- moe_23_res2 -->
<g id="node473" class="node">
<title>moe_23_res2</title>
<polygon fill="lightyellow" stroke="black" points="2292.89,-34953.97 1756.97,-34953.97 1619.11,-34849.97 2155.03,-34849.97 2292.89,-34953.97"/>
<text text-anchor="middle" x="1956" y="-34915.97" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1956" y="-34904.97" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1956" y="-34893.97" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1956" y="-34882.97" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_23_ffn&#45;&gt;moe_23_res2 -->
<g id="edge772" class="edge">
<title>moe_23_ffn&#45;&gt;moe_23_res2</title>
<path fill="none" stroke="black" d="M1956,-34989.84C1956,-34982.15 1956,-34973.34 1956,-34964.34"/>
<polygon fill="black" stroke="black" points="1959.5,-34964.15 1956,-34954.15 1952.5,-34964.15 1959.5,-34964.15"/>
</g>
<!-- moe_23_res1&#45;&gt;moe_23_gate -->
<g id="edge737" class="edge">
<title>moe_23_res1&#45;&gt;moe_23_gate</title>
<path fill="none" stroke="black" d="M1877,-35524.66C1877,-35516.49 1877,-35507.97 1877,-35499.59"/>
<polygon fill="black" stroke="black" points="1880.5,-35499.48 1877,-35489.48 1873.5,-35499.48 1880.5,-35499.48"/>
</g>
<!-- moe_24_mha -->
<g id="node474" class="node">
<title>moe_24_mha</title>
<polygon fill="lightgreen" stroke="black" points="2114,-34802.97 1798,-34802.97 1798,-34750.97 2114,-34750.97 2114,-34802.97"/>
<text text-anchor="middle" x="1956" y="-34790.97" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1956" y="-34779.97" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1956" y="-34768.97" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1956" y="-34757.97" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_23_res2&#45;&gt;moe_24_mha -->
<g id="edge773" class="edge">
<title>moe_23_res2&#45;&gt;moe_24_mha</title>
<path fill="none" stroke="black" d="M1956,-34849.88C1956,-34837.55 1956,-34824.64 1956,-34813.22"/>
<polygon fill="black" stroke="black" points="1959.5,-34813.21 1956,-34803.21 1952.5,-34813.21 1959.5,-34813.21"/>
</g>
<!-- moe_24_res1 -->
<g id="node495" class="node">
<title>moe_24_res1</title>
<polygon fill="lightyellow" stroke="black" points="2292.89,-34714.97 1756.97,-34714.97 1619.11,-34610.97 2155.03,-34610.97 2292.89,-34714.97"/>
<text text-anchor="middle" x="1956" y="-34676.97" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1956" y="-34665.97" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1956" y="-34654.97" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1956" y="-34643.97" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_24_mha&#45;&gt;moe_24_res1 -->
<g id="edge774" class="edge">
<title>moe_24_mha&#45;&gt;moe_24_res1</title>
<path fill="none" stroke="black" d="M1956,-34750.84C1956,-34743.15 1956,-34734.34 1956,-34725.34"/>
<polygon fill="black" stroke="black" points="1959.5,-34725.15 1956,-34715.15 1952.5,-34725.15 1959.5,-34725.15"/>
</g>
<!-- moe_24_gate -->
<g id="node475" class="node">
<title>moe_24_gate</title>
<polygon fill="lightyellow" stroke="black" points="2284.8,-34574.97 1761.75,-34574.97 1627.2,-34470.97 2150.25,-34470.97 2284.8,-34574.97"/>
<text text-anchor="middle" x="1956" y="-34536.97" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1956" y="-34525.97" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1956" y="-34514.97" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1956" y="-34503.97" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_24_route -->
<g id="node476" class="node">
<title>moe_24_route</title>
<ellipse fill="lightblue" stroke="black" cx="1956" cy="-34398.2" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1956" y="-34412.2" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1956" y="-34401.2" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1956" y="-34390.2" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1956" y="-34379.2" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_24_gate&#45;&gt;moe_24_route -->
<g id="edge776" class="edge">
<title>moe_24_gate&#45;&gt;moe_24_route</title>
<path fill="none" stroke="black" d="M1956,-34470.62C1956,-34462.21 1956,-34453.54 1956,-34445.27"/>
<polygon fill="black" stroke="black" points="1959.5,-34445.06 1956,-34435.06 1952.5,-34445.06 1959.5,-34445.06"/>
</g>
<!-- moe_24_expert_0 -->
<g id="node477" class="node">
<title>moe_24_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="295,-34325.43 77,-34325.43 77,-34273.43 295,-34273.43 295,-34325.43"/>
<text text-anchor="middle" x="186" y="-34313.43" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="186" y="-34302.43" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="186" y="-34291.43" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="186" y="-34280.43" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_24_route&#45;&gt;moe_24_expert_0 -->
<g id="edge777" class="edge">
<title>moe_24_route&#45;&gt;moe_24_expert_0</title>
<path fill="none" stroke="black" d="M1740.93,-34392.28C1363.11,-34382.91 593.75,-34360.38 305.24,-34325.48"/>
<polygon fill="black" stroke="black" points="305.54,-34321.99 295.18,-34324.23 304.68,-34328.93 305.54,-34321.99"/>
</g>
<!-- moe_24_expert_1 -->
<g id="node478" class="node">
<title>moe_24_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="531,-34325.43 313,-34325.43 313,-34273.43 531,-34273.43 531,-34325.43"/>
<text text-anchor="middle" x="422" y="-34313.43" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="422" y="-34302.43" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="422" y="-34291.43" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="422" y="-34280.43" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_24_route&#45;&gt;moe_24_expert_1 -->
<g id="edge778" class="edge">
<title>moe_24_route&#45;&gt;moe_24_expert_1</title>
<path fill="none" stroke="black" d="M1738.23,-34396.82C1461.57,-34393.92 969.56,-34380.66 541.29,-34325.51"/>
<polygon fill="black" stroke="black" points="541.55,-34322.02 531.19,-34324.2 540.65,-34328.96 541.55,-34322.02"/>
</g>
<!-- moe_24_expert_2 -->
<g id="node479" class="node">
<title>moe_24_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="767,-34325.43 549,-34325.43 549,-34273.43 767,-34273.43 767,-34325.43"/>
<text text-anchor="middle" x="658" y="-34313.43" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="658" y="-34302.43" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="658" y="-34291.43" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="658" y="-34280.43" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_24_route&#45;&gt;moe_24_expert_2 -->
<g id="edge779" class="edge">
<title>moe_24_route&#45;&gt;moe_24_expert_2</title>
<path fill="none" stroke="black" d="M1739.74,-34393.64C1504.7,-34387.55 1118.2,-34371.12 777.26,-34325.52"/>
<polygon fill="black" stroke="black" points="777.57,-34322.03 767.19,-34324.16 776.63,-34328.97 777.57,-34322.03"/>
</g>
<!-- moe_24_expert_3 -->
<g id="node480" class="node">
<title>moe_24_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1003,-34325.43 785,-34325.43 785,-34273.43 1003,-34273.43 1003,-34325.43"/>
<text text-anchor="middle" x="894" y="-34313.43" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="894" y="-34302.43" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="894" y="-34291.43" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="894" y="-34280.43" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_24_route&#45;&gt;moe_24_expert_3 -->
<g id="edge780" class="edge">
<title>moe_24_route&#45;&gt;moe_24_expert_3</title>
<path fill="none" stroke="black" d="M1744.7,-34389.18C1555.33,-34380.11 1270,-34361.8 1013.47,-34325.56"/>
<polygon fill="black" stroke="black" points="1013.59,-34322.05 1003.2,-34324.1 1012.61,-34328.98 1013.59,-34322.05"/>
</g>
<!-- moe_24_expert_4 -->
<g id="node481" class="node">
<title>moe_24_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1239,-34325.43 1021,-34325.43 1021,-34273.43 1239,-34273.43 1239,-34325.43"/>
<text text-anchor="middle" x="1130" y="-34313.43" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1130" y="-34302.43" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1130" y="-34291.43" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1130" y="-34280.43" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_24_route&#45;&gt;moe_24_expert_4 -->
<g id="edge781" class="edge">
<title>moe_24_route&#45;&gt;moe_24_expert_4</title>
<path fill="none" stroke="black" d="M1757.66,-34382.85C1617.96,-34371.37 1426.46,-34352.87 1249.25,-34325.56"/>
<polygon fill="black" stroke="black" points="1249.63,-34322.08 1239.21,-34324 1248.56,-34329 1249.63,-34322.08"/>
</g>
<!-- moe_24_expert_5 -->
<g id="node482" class="node">
<title>moe_24_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1475,-34325.43 1257,-34325.43 1257,-34273.43 1475,-34273.43 1475,-34325.43"/>
<text text-anchor="middle" x="1366" y="-34313.43" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1366" y="-34302.43" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1366" y="-34291.43" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1366" y="-34280.43" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_24_route&#45;&gt;moe_24_expert_5 -->
<g id="edge782" class="edge">
<title>moe_24_route&#45;&gt;moe_24_expert_5</title>
<path fill="none" stroke="black" d="M1789.87,-34374.34C1701.99,-34361.66 1592.11,-34344.89 1485.25,-34325.62"/>
<polygon fill="black" stroke="black" points="1485.71,-34322.15 1475.25,-34323.81 1484.46,-34329.04 1485.71,-34322.15"/>
</g>
<!-- moe_24_expert_6 -->
<g id="node483" class="node">
<title>moe_24_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1711,-34325.43 1493,-34325.43 1493,-34273.43 1711,-34273.43 1711,-34325.43"/>
<text text-anchor="middle" x="1602" y="-34313.43" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1602" y="-34302.43" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1602" y="-34291.43" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1602" y="-34280.43" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_24_route&#45;&gt;moe_24_expert_6 -->
<g id="edge783" class="edge">
<title>moe_24_route&#45;&gt;moe_24_expert_6</title>
<path fill="none" stroke="black" d="M1843.99,-34366.58C1798.98,-34354.28 1747.47,-34340.2 1703.56,-34328.2"/>
<polygon fill="black" stroke="black" points="1704.31,-34324.77 1693.74,-34325.51 1702.46,-34331.52 1704.31,-34324.77"/>
</g>
<!-- moe_24_expert_7 -->
<g id="node484" class="node">
<title>moe_24_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1947,-34325.43 1729,-34325.43 1729,-34273.43 1947,-34273.43 1947,-34325.43"/>
<text text-anchor="middle" x="1838" y="-34313.43" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1838" y="-34302.43" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1838" y="-34291.43" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1838" y="-34280.43" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_24_route&#45;&gt;moe_24_expert_7 -->
<g id="edge784" class="edge">
<title>moe_24_route&#45;&gt;moe_24_expert_7</title>
<path fill="none" stroke="black" d="M1913.07,-34361.99C1901.07,-34352.16 1888.12,-34341.54 1876.41,-34331.93"/>
<polygon fill="black" stroke="black" points="1878.47,-34329.1 1868.52,-34325.46 1874.04,-34334.51 1878.47,-34329.1"/>
</g>
<!-- moe_24_expert_8 -->
<g id="node485" class="node">
<title>moe_24_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2183,-34325.43 1965,-34325.43 1965,-34273.43 2183,-34273.43 2183,-34325.43"/>
<text text-anchor="middle" x="2074" y="-34313.43" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2074" y="-34302.43" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2074" y="-34291.43" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2074" y="-34280.43" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_24_route&#45;&gt;moe_24_expert_8 -->
<g id="edge785" class="edge">
<title>moe_24_route&#45;&gt;moe_24_expert_8</title>
<path fill="none" stroke="black" d="M1998.93,-34361.99C2010.93,-34352.16 2023.88,-34341.54 2035.59,-34331.93"/>
<polygon fill="black" stroke="black" points="2037.96,-34334.51 2043.48,-34325.46 2033.53,-34329.1 2037.96,-34334.51"/>
</g>
<!-- moe_24_expert_9 -->
<g id="node486" class="node">
<title>moe_24_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2419,-34325.43 2201,-34325.43 2201,-34273.43 2419,-34273.43 2419,-34325.43"/>
<text text-anchor="middle" x="2310" y="-34313.43" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2310" y="-34302.43" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2310" y="-34291.43" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2310" y="-34280.43" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_24_route&#45;&gt;moe_24_expert_9 -->
<g id="edge786" class="edge">
<title>moe_24_route&#45;&gt;moe_24_expert_9</title>
<path fill="none" stroke="black" d="M2068.01,-34366.58C2113.02,-34354.28 2164.53,-34340.2 2208.44,-34328.2"/>
<polygon fill="black" stroke="black" points="2209.54,-34331.52 2218.26,-34325.51 2207.69,-34324.77 2209.54,-34331.52"/>
</g>
<!-- moe_24_expert_10 -->
<g id="node487" class="node">
<title>moe_24_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2655,-34325.43 2437,-34325.43 2437,-34273.43 2655,-34273.43 2655,-34325.43"/>
<text text-anchor="middle" x="2546" y="-34313.43" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2546" y="-34302.43" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2546" y="-34291.43" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2546" y="-34280.43" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_24_route&#45;&gt;moe_24_expert_10 -->
<g id="edge787" class="edge">
<title>moe_24_route&#45;&gt;moe_24_expert_10</title>
<path fill="none" stroke="black" d="M2122.13,-34374.34C2210.01,-34361.66 2319.89,-34344.89 2426.75,-34325.62"/>
<polygon fill="black" stroke="black" points="2427.54,-34329.04 2436.75,-34323.81 2426.29,-34322.15 2427.54,-34329.04"/>
</g>
<!-- moe_24_expert_11 -->
<g id="node488" class="node">
<title>moe_24_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2891,-34325.43 2673,-34325.43 2673,-34273.43 2891,-34273.43 2891,-34325.43"/>
<text text-anchor="middle" x="2782" y="-34313.43" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2782" y="-34302.43" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2782" y="-34291.43" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2782" y="-34280.43" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_24_route&#45;&gt;moe_24_expert_11 -->
<g id="edge788" class="edge">
<title>moe_24_route&#45;&gt;moe_24_expert_11</title>
<path fill="none" stroke="black" d="M2154.34,-34382.85C2294.04,-34371.37 2485.54,-34352.87 2662.75,-34325.56"/>
<polygon fill="black" stroke="black" points="2663.44,-34329 2672.79,-34324 2662.37,-34322.08 2663.44,-34329"/>
</g>
<!-- moe_24_expert_12 -->
<g id="node489" class="node">
<title>moe_24_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3127,-34325.43 2909,-34325.43 2909,-34273.43 3127,-34273.43 3127,-34325.43"/>
<text text-anchor="middle" x="3018" y="-34313.43" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3018" y="-34302.43" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3018" y="-34291.43" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3018" y="-34280.43" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_24_route&#45;&gt;moe_24_expert_12 -->
<g id="edge789" class="edge">
<title>moe_24_route&#45;&gt;moe_24_expert_12</title>
<path fill="none" stroke="black" d="M2167.3,-34389.18C2356.67,-34380.11 2642,-34361.8 2898.53,-34325.56"/>
<polygon fill="black" stroke="black" points="2899.39,-34328.98 2908.8,-34324.1 2898.41,-34322.05 2899.39,-34328.98"/>
</g>
<!-- moe_24_expert_13 -->
<g id="node490" class="node">
<title>moe_24_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3363,-34325.43 3145,-34325.43 3145,-34273.43 3363,-34273.43 3363,-34325.43"/>
<text text-anchor="middle" x="3254" y="-34313.43" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3254" y="-34302.43" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3254" y="-34291.43" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3254" y="-34280.43" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_24_route&#45;&gt;moe_24_expert_13 -->
<g id="edge790" class="edge">
<title>moe_24_route&#45;&gt;moe_24_expert_13</title>
<path fill="none" stroke="black" d="M2172.26,-34393.64C2407.3,-34387.55 2793.8,-34371.12 3134.74,-34325.52"/>
<polygon fill="black" stroke="black" points="3135.37,-34328.97 3144.81,-34324.16 3134.43,-34322.03 3135.37,-34328.97"/>
</g>
<!-- moe_24_expert_14 -->
<g id="node491" class="node">
<title>moe_24_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3599,-34325.43 3381,-34325.43 3381,-34273.43 3599,-34273.43 3599,-34325.43"/>
<text text-anchor="middle" x="3490" y="-34313.43" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3490" y="-34302.43" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3490" y="-34291.43" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3490" y="-34280.43" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_24_route&#45;&gt;moe_24_expert_14 -->
<g id="edge791" class="edge">
<title>moe_24_route&#45;&gt;moe_24_expert_14</title>
<path fill="none" stroke="black" d="M2173.77,-34396.82C2450.43,-34393.92 2942.44,-34380.66 3370.71,-34325.51"/>
<polygon fill="black" stroke="black" points="3371.35,-34328.96 3380.81,-34324.2 3370.45,-34322.02 3371.35,-34328.96"/>
</g>
<!-- moe_24_expert_15 -->
<g id="node492" class="node">
<title>moe_24_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3835,-34325.43 3617,-34325.43 3617,-34273.43 3835,-34273.43 3835,-34325.43"/>
<text text-anchor="middle" x="3726" y="-34313.43" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3726" y="-34302.43" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3726" y="-34291.43" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3726" y="-34280.43" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_24_route&#45;&gt;moe_24_expert_15 -->
<g id="edge792" class="edge">
<title>moe_24_route&#45;&gt;moe_24_expert_15</title>
<path fill="none" stroke="black" d="M2171.07,-34392.28C2548.89,-34382.91 3318.25,-34360.38 3606.76,-34325.48"/>
<polygon fill="black" stroke="black" points="3607.32,-34328.93 3616.82,-34324.23 3606.46,-34321.99 3607.32,-34328.93"/>
</g>
<!-- moe_24_aggregate -->
<g id="node493" class="node">
<title>moe_24_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1901" cy="-34200.66" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1901" y="-34214.66" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1901" y="-34203.66" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1901" y="-34192.66" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1901" y="-34181.66" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_24_expert_0&#45;&gt;moe_24_aggregate -->
<g id="edge793" class="edge">
<title>moe_24_expert_0&#45;&gt;moe_24_aggregate</title>
<path fill="none" stroke="black" d="M295.18,-34274.64C298.15,-34274.21 301.09,-34273.8 304,-34273.43 561.22,-34240.63 1293.79,-34217.48 1670.74,-34207.36"/>
<polygon fill="black" stroke="black" points="1671.05,-34210.86 1680.96,-34207.09 1670.87,-34203.86 1671.05,-34210.86"/>
</g>
<!-- moe_24_expert_1&#45;&gt;moe_24_aggregate -->
<g id="edge794" class="edge">
<title>moe_24_expert_1&#45;&gt;moe_24_aggregate</title>
<path fill="none" stroke="black" d="M531.19,-34274.67C534.15,-34274.23 537.09,-34273.82 540,-34273.43 933.46,-34221.7 1395.54,-34206.95 1667.44,-34202.93"/>
<polygon fill="black" stroke="black" points="1667.89,-34206.42 1677.84,-34202.78 1667.79,-34199.42 1667.89,-34206.42"/>
</g>
<!-- moe_24_expert_2&#45;&gt;moe_24_aggregate -->
<g id="edge795" class="edge">
<title>moe_24_expert_2&#45;&gt;moe_24_aggregate</title>
<path fill="none" stroke="black" d="M767.19,-34274.72C770.16,-34274.26 773.1,-34273.83 776,-34273.43 1083.6,-34231.26 1441.99,-34213.8 1670.09,-34206.61"/>
<polygon fill="black" stroke="black" points="1670.29,-34210.11 1680.18,-34206.3 1670.07,-34203.11 1670.29,-34210.11"/>
</g>
<!-- moe_24_expert_3&#45;&gt;moe_24_aggregate -->
<g id="edge796" class="edge">
<title>moe_24_expert_3&#45;&gt;moe_24_aggregate</title>
<path fill="none" stroke="black" d="M1003.2,-34274.78C1006.16,-34274.31 1009.1,-34273.86 1012,-34273.43 1237.01,-34240.65 1496.4,-34221.86 1676.69,-34211.8"/>
<polygon fill="black" stroke="black" points="1677.04,-34215.29 1686.83,-34211.24 1676.65,-34208.3 1677.04,-34215.29"/>
</g>
<!-- moe_24_expert_4&#45;&gt;moe_24_aggregate -->
<g id="edge797" class="edge">
<title>moe_24_expert_4&#45;&gt;moe_24_aggregate</title>
<path fill="none" stroke="black" d="M1239.22,-34274.89C1242.17,-34274.39 1245.11,-34273.9 1248,-34273.43 1396.57,-34249.59 1565.45,-34231.26 1694.24,-34219.09"/>
<polygon fill="black" stroke="black" points="1694.6,-34222.58 1704.23,-34218.16 1693.94,-34215.61 1694.6,-34222.58"/>
</g>
<!-- moe_24_expert_5&#45;&gt;moe_24_aggregate -->
<g id="edge798" class="edge">
<title>moe_24_expert_5&#45;&gt;moe_24_aggregate</title>
<path fill="none" stroke="black" d="M1475.26,-34275.13C1478.2,-34274.55 1481.12,-34273.99 1484,-34273.43 1566.33,-34257.63 1658.13,-34241.66 1734.6,-34228.8"/>
<polygon fill="black" stroke="black" points="1735.52,-34232.19 1744.8,-34227.09 1734.36,-34225.29 1735.52,-34232.19"/>
</g>
<!-- moe_24_expert_6&#45;&gt;moe_24_aggregate -->
<g id="edge799" class="edge">
<title>moe_24_expert_6&#45;&gt;moe_24_aggregate</title>
<path fill="none" stroke="black" d="M1679.39,-34273.39C1713.78,-34262.26 1754.86,-34248.96 1792.26,-34236.86"/>
<polygon fill="black" stroke="black" points="1793.75,-34240.05 1802.19,-34233.64 1791.6,-34233.39 1793.75,-34240.05"/>
</g>
<!-- moe_24_expert_7&#45;&gt;moe_24_aggregate -->
<g id="edge800" class="edge">
<title>moe_24_expert_7&#45;&gt;moe_24_aggregate</title>
<path fill="none" stroke="black" d="M1854.39,-34273.26C1859.86,-34264.86 1866.13,-34255.23 1872.26,-34245.82"/>
<polygon fill="black" stroke="black" points="1875.29,-34247.56 1877.82,-34237.27 1869.43,-34243.74 1875.29,-34247.56"/>
</g>
<!-- moe_24_expert_8&#45;&gt;moe_24_aggregate -->
<g id="edge801" class="edge">
<title>moe_24_expert_8&#45;&gt;moe_24_aggregate</title>
<path fill="none" stroke="black" d="M2029,-34273.26C2011.46,-34263.45 1990.94,-34251.97 1971.53,-34241.12"/>
<polygon fill="black" stroke="black" points="1973.14,-34238.01 1962.71,-34236.18 1969.73,-34244.12 1973.14,-34238.01"/>
</g>
<!-- moe_24_expert_9&#45;&gt;moe_24_aggregate -->
<g id="edge802" class="edge">
<title>moe_24_expert_9&#45;&gt;moe_24_aggregate</title>
<path fill="none" stroke="black" d="M2204.14,-34273.39C2152.79,-34261.24 2090.52,-34246.5 2035.81,-34233.56"/>
<polygon fill="black" stroke="black" points="2036.58,-34230.14 2026.04,-34231.25 2034.96,-34236.96 2036.58,-34230.14"/>
</g>
<!-- moe_24_expert_10&#45;&gt;moe_24_aggregate -->
<g id="edge803" class="edge">
<title>moe_24_expert_10&#45;&gt;moe_24_aggregate</title>
<path fill="none" stroke="black" d="M2436.76,-34274.99C2433.81,-34274.46 2430.89,-34273.93 2428,-34273.43 2316.3,-34254.02 2190.51,-34236.72 2089.85,-34223.97"/>
<polygon fill="black" stroke="black" points="2090.24,-34220.49 2079.88,-34222.71 2089.36,-34227.44 2090.24,-34220.49"/>
</g>
<!-- moe_24_expert_11&#45;&gt;moe_24_aggregate -->
<g id="edge804" class="edge">
<title>moe_24_expert_11&#45;&gt;moe_24_aggregate</title>
<path fill="none" stroke="black" d="M2672.79,-34274.83C2669.83,-34274.34 2666.9,-34273.87 2664,-34273.43 2480.76,-34245.5 2270.99,-34226.71 2117.83,-34215.39"/>
<polygon fill="black" stroke="black" points="2118.06,-34211.9 2107.83,-34214.66 2117.55,-34218.88 2118.06,-34211.9"/>
</g>
<!-- moe_24_expert_12&#45;&gt;moe_24_aggregate -->
<g id="edge805" class="edge">
<title>moe_24_expert_12&#45;&gt;moe_24_aggregate</title>
<path fill="none" stroke="black" d="M2908.8,-34274.75C2905.84,-34274.28 2902.9,-34273.84 2900,-34273.43 2637.13,-34236.32 2332.49,-34217.95 2129.39,-34209.16"/>
<polygon fill="black" stroke="black" points="2129.34,-34205.66 2119.2,-34208.73 2129.04,-34212.65 2129.34,-34205.66"/>
</g>
<!-- moe_24_expert_13&#45;&gt;moe_24_aggregate -->
<g id="edge806" class="edge">
<title>moe_24_expert_13&#45;&gt;moe_24_aggregate</title>
<path fill="none" stroke="black" d="M3144.81,-34274.69C3141.85,-34274.24 3138.91,-34273.82 3136,-34273.43 2788.79,-34226.83 2382.66,-34210.48 2133.65,-34204.75"/>
<polygon fill="black" stroke="black" points="2133.46,-34201.24 2123.38,-34204.52 2133.3,-34208.24 2133.46,-34201.24"/>
</g>
<!-- moe_24_expert_14&#45;&gt;moe_24_aggregate -->
<g id="edge807" class="edge">
<title>moe_24_expert_14&#45;&gt;moe_24_aggregate</title>
<path fill="none" stroke="black" d="M3380.81,-34274.66C3377.85,-34274.22 3374.91,-34273.81 3372,-34273.43 2937.53,-34217.18 2425.68,-34204.08 2134.66,-34201.56"/>
<polygon fill="black" stroke="black" points="2134.43,-34198.06 2124.4,-34201.48 2134.37,-34205.06 2134.43,-34198.06"/>
</g>
<!-- moe_24_expert_15&#45;&gt;moe_24_aggregate -->
<g id="edge808" class="edge">
<title>moe_24_expert_15&#45;&gt;moe_24_aggregate</title>
<path fill="none" stroke="black" d="M3616.82,-34274.63C3613.85,-34274.2 3610.91,-34273.8 3608,-34273.43 3329.63,-34238.34 2530.48,-34215.92 2132.27,-34206.61"/>
<polygon fill="black" stroke="black" points="2132.14,-34203.1 2122.07,-34206.37 2131.98,-34210.1 2132.14,-34203.1"/>
</g>
<!-- moe_24_ffn -->
<g id="node494" class="node">
<title>moe_24_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2059,-34127.89 1743,-34127.89 1743,-34075.89 2059,-34075.89 2059,-34127.89"/>
<text text-anchor="middle" x="1901" y="-34115.89" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1901" y="-34104.89" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1901" y="-34093.89" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1901" y="-34082.89" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_24_aggregate&#45;&gt;moe_24_ffn -->
<g id="edge809" class="edge">
<title>moe_24_aggregate&#45;&gt;moe_24_ffn</title>
<path fill="none" stroke="black" d="M1901,-34163.63C1901,-34155.32 1901,-34146.48 1901,-34138.2"/>
<polygon fill="black" stroke="black" points="1904.5,-34138.09 1901,-34128.09 1897.5,-34138.09 1904.5,-34138.09"/>
</g>
<!-- moe_24_res2 -->
<g id="node496" class="node">
<title>moe_24_res2</title>
<polygon fill="lightyellow" stroke="black" points="2237.89,-34039.89 1701.97,-34039.89 1564.11,-33935.89 2100.03,-33935.89 2237.89,-34039.89"/>
<text text-anchor="middle" x="1901" y="-34001.89" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1901" y="-33990.89" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1901" y="-33979.89" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1901" y="-33968.89" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_24_ffn&#45;&gt;moe_24_res2 -->
<g id="edge810" class="edge">
<title>moe_24_ffn&#45;&gt;moe_24_res2</title>
<path fill="none" stroke="black" d="M1901,-34075.76C1901,-34068.07 1901,-34059.26 1901,-34050.26"/>
<polygon fill="black" stroke="black" points="1904.5,-34050.07 1901,-34040.07 1897.5,-34050.07 1904.5,-34050.07"/>
</g>
<!-- moe_24_res1&#45;&gt;moe_24_gate -->
<g id="edge775" class="edge">
<title>moe_24_res1&#45;&gt;moe_24_gate</title>
<path fill="none" stroke="black" d="M1956,-34610.59C1956,-34602.41 1956,-34593.89 1956,-34585.51"/>
<polygon fill="black" stroke="black" points="1959.5,-34585.4 1956,-34575.4 1952.5,-34585.4 1959.5,-34585.4"/>
</g>
<!-- moe_25_mha -->
<g id="node497" class="node">
<title>moe_25_mha</title>
<polygon fill="lightgreen" stroke="black" points="2059,-33888.89 1743,-33888.89 1743,-33836.89 2059,-33836.89 2059,-33888.89"/>
<text text-anchor="middle" x="1901" y="-33876.89" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1901" y="-33865.89" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1901" y="-33854.89" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1901" y="-33843.89" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_24_res2&#45;&gt;moe_25_mha -->
<g id="edge811" class="edge">
<title>moe_24_res2&#45;&gt;moe_25_mha</title>
<path fill="none" stroke="black" d="M1901,-33935.8C1901,-33923.47 1901,-33910.56 1901,-33899.14"/>
<polygon fill="black" stroke="black" points="1904.5,-33899.13 1901,-33889.13 1897.5,-33899.13 1904.5,-33899.13"/>
</g>
<!-- moe_25_res1 -->
<g id="node518" class="node">
<title>moe_25_res1</title>
<polygon fill="lightyellow" stroke="black" points="2237.89,-33800.89 1701.97,-33800.89 1564.11,-33696.89 2100.03,-33696.89 2237.89,-33800.89"/>
<text text-anchor="middle" x="1901" y="-33762.89" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1901" y="-33751.89" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1901" y="-33740.89" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1901" y="-33729.89" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_25_mha&#45;&gt;moe_25_res1 -->
<g id="edge812" class="edge">
<title>moe_25_mha&#45;&gt;moe_25_res1</title>
<path fill="none" stroke="black" d="M1901,-33836.76C1901,-33829.07 1901,-33820.26 1901,-33811.26"/>
<polygon fill="black" stroke="black" points="1904.5,-33811.07 1901,-33801.07 1897.5,-33811.07 1904.5,-33811.07"/>
</g>
<!-- moe_25_gate -->
<g id="node498" class="node">
<title>moe_25_gate</title>
<polygon fill="lightyellow" stroke="black" points="2229.8,-33660.89 1706.75,-33660.89 1572.2,-33556.89 2095.25,-33556.89 2229.8,-33660.89"/>
<text text-anchor="middle" x="1901" y="-33622.89" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1901" y="-33611.89" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1901" y="-33600.89" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1901" y="-33589.89" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_25_route -->
<g id="node499" class="node">
<title>moe_25_route</title>
<ellipse fill="lightblue" stroke="black" cx="1901" cy="-33484.12" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1901" y="-33498.12" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1901" y="-33487.12" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1901" y="-33476.12" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1901" y="-33465.12" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_25_gate&#45;&gt;moe_25_route -->
<g id="edge814" class="edge">
<title>moe_25_gate&#45;&gt;moe_25_route</title>
<path fill="none" stroke="black" d="M1901,-33556.54C1901,-33548.13 1901,-33539.46 1901,-33531.19"/>
<polygon fill="black" stroke="black" points="1904.5,-33530.98 1901,-33520.98 1897.5,-33530.98 1904.5,-33530.98"/>
</g>
<!-- moe_25_expert_0 -->
<g id="node500" class="node">
<title>moe_25_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-33411.35 16,-33411.35 16,-33359.35 234,-33359.35 234,-33411.35"/>
<text text-anchor="middle" x="125" y="-33399.35" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-33388.35" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-33377.35" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-33366.35" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_25_route&#45;&gt;moe_25_expert_0 -->
<g id="edge815" class="edge">
<title>moe_25_route&#45;&gt;moe_25_expert_0</title>
<path fill="none" stroke="black" d="M1685.9,-33478.24C1306.98,-33468.92 534,-33446.43 244.28,-33411.4"/>
<polygon fill="black" stroke="black" points="244.54,-33407.91 234.18,-33410.15 243.68,-33414.85 244.54,-33407.91"/>
</g>
<!-- moe_25_expert_1 -->
<g id="node501" class="node">
<title>moe_25_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-33411.35 252,-33411.35 252,-33359.35 470,-33359.35 470,-33411.35"/>
<text text-anchor="middle" x="361" y="-33399.35" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-33388.35" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-33377.35" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-33366.35" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_25_route&#45;&gt;moe_25_expert_1 -->
<g id="edge816" class="edge">
<title>moe_25_route&#45;&gt;moe_25_expert_1</title>
<path fill="none" stroke="black" d="M1683.22,-33482.81C1405.56,-33479.99 910.85,-33466.83 480.34,-33411.44"/>
<polygon fill="black" stroke="black" points="480.55,-33407.94 470.19,-33410.12 479.65,-33414.88 480.55,-33407.94"/>
</g>
<!-- moe_25_expert_2 -->
<g id="node502" class="node">
<title>moe_25_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-33411.35 488,-33411.35 488,-33359.35 706,-33359.35 706,-33411.35"/>
<text text-anchor="middle" x="597" y="-33399.35" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-33388.35" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-33377.35" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-33366.35" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_25_route&#45;&gt;moe_25_expert_2 -->
<g id="edge817" class="edge">
<title>moe_25_route&#45;&gt;moe_25_expert_2</title>
<path fill="none" stroke="black" d="M1684.73,-33479.65C1448.61,-33473.65 1059.46,-33457.29 716.33,-33411.45"/>
<polygon fill="black" stroke="black" points="716.57,-33407.95 706.19,-33410.08 715.64,-33414.89 716.57,-33407.95"/>
</g>
<!-- moe_25_expert_3 -->
<g id="node503" class="node">
<title>moe_25_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-33411.35 724,-33411.35 724,-33359.35 942,-33359.35 942,-33411.35"/>
<text text-anchor="middle" x="833" y="-33399.35" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-33388.35" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-33377.35" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-33366.35" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_25_route&#45;&gt;moe_25_expert_3 -->
<g id="edge818" class="edge">
<title>moe_25_route&#45;&gt;moe_25_expert_3</title>
<path fill="none" stroke="black" d="M1689.29,-33475.22C1498.64,-33466.22 1210.77,-33447.93 952.16,-33411.44"/>
<polygon fill="black" stroke="black" points="952.59,-33407.97 942.2,-33410.03 951.61,-33414.9 952.59,-33407.97"/>
</g>
<!-- moe_25_expert_4 -->
<g id="node504" class="node">
<title>moe_25_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-33411.35 960,-33411.35 960,-33359.35 1178,-33359.35 1178,-33411.35"/>
<text text-anchor="middle" x="1069" y="-33399.35" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-33388.35" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-33377.35" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-33366.35" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_25_route&#45;&gt;moe_25_expert_4 -->
<g id="edge819" class="edge">
<title>moe_25_route&#45;&gt;moe_25_expert_4</title>
<path fill="none" stroke="black" d="M1702.51,-33468.99C1561.43,-33457.55 1367.42,-33439.02 1188.1,-33411.46"/>
<polygon fill="black" stroke="black" points="1188.63,-33408 1178.21,-33409.93 1187.56,-33414.92 1188.63,-33408"/>
</g>
<!-- moe_25_expert_5 -->
<g id="node505" class="node">
<title>moe_25_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-33411.35 1196,-33411.35 1196,-33359.35 1414,-33359.35 1414,-33411.35"/>
<text text-anchor="middle" x="1305" y="-33399.35" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-33388.35" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-33377.35" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-33366.35" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_25_route&#45;&gt;moe_25_expert_5 -->
<g id="edge820" class="edge">
<title>moe_25_route&#45;&gt;moe_25_expert_5</title>
<path fill="none" stroke="black" d="M1733.86,-33460.52C1644.69,-33447.86 1532.91,-33431.02 1424.4,-33411.57"/>
<polygon fill="black" stroke="black" points="1424.71,-33408.07 1414.25,-33409.74 1423.47,-33414.96 1424.71,-33408.07"/>
</g>
<!-- moe_25_expert_6 -->
<g id="node506" class="node">
<title>moe_25_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-33411.35 1432,-33411.35 1432,-33359.35 1650,-33359.35 1650,-33411.35"/>
<text text-anchor="middle" x="1541" y="-33399.35" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-33388.35" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-33377.35" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-33366.35" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_25_route&#45;&gt;moe_25_expert_6 -->
<g id="edge821" class="edge">
<title>moe_25_route&#45;&gt;moe_25_expert_6</title>
<path fill="none" stroke="black" d="M1787.59,-33452.64C1741.6,-33440.28 1688.86,-33426.1 1643.99,-33414.04"/>
<polygon fill="black" stroke="black" points="1644.82,-33410.64 1634.25,-33411.42 1643,-33417.4 1644.82,-33410.64"/>
</g>
<!-- moe_25_expert_7 -->
<g id="node507" class="node">
<title>moe_25_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-33411.35 1668,-33411.35 1668,-33359.35 1886,-33359.35 1886,-33411.35"/>
<text text-anchor="middle" x="1777" y="-33399.35" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-33388.35" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-33377.35" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-33366.35" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_25_route&#45;&gt;moe_25_expert_7 -->
<g id="edge822" class="edge">
<title>moe_25_route&#45;&gt;moe_25_expert_7</title>
<path fill="none" stroke="black" d="M1855.88,-33447.91C1843.16,-33437.98 1829.41,-33427.25 1817,-33417.57"/>
<polygon fill="black" stroke="black" points="1819.11,-33414.78 1809.07,-33411.39 1814.8,-33420.3 1819.11,-33414.78"/>
</g>
<!-- moe_25_expert_8 -->
<g id="node508" class="node">
<title>moe_25_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-33411.35 1904,-33411.35 1904,-33359.35 2122,-33359.35 2122,-33411.35"/>
<text text-anchor="middle" x="2013" y="-33399.35" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-33388.35" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-33377.35" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-33366.35" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_25_route&#45;&gt;moe_25_expert_8 -->
<g id="edge823" class="edge">
<title>moe_25_route&#45;&gt;moe_25_expert_8</title>
<path fill="none" stroke="black" d="M1941.75,-33447.91C1953.03,-33438.17 1965.19,-33427.66 1976.23,-33418.13"/>
<polygon fill="black" stroke="black" points="1978.75,-33420.57 1984.03,-33411.39 1974.17,-33415.27 1978.75,-33420.57"/>
</g>
<!-- moe_25_expert_9 -->
<g id="node509" class="node">
<title>moe_25_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-33411.35 2140,-33411.35 2140,-33359.35 2358,-33359.35 2358,-33411.35"/>
<text text-anchor="middle" x="2249" y="-33399.35" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-33388.35" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-33377.35" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-33366.35" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_25_route&#45;&gt;moe_25_expert_9 -->
<g id="edge824" class="edge">
<title>moe_25_route&#45;&gt;moe_25_expert_9</title>
<path fill="none" stroke="black" d="M2011.59,-33452.37C2055.81,-33440.08 2106.36,-33426.02 2149.42,-33414.04"/>
<polygon fill="black" stroke="black" points="2150.36,-33417.42 2159.06,-33411.37 2148.48,-33410.67 2150.36,-33417.42"/>
</g>
<!-- moe_25_expert_10 -->
<g id="node510" class="node">
<title>moe_25_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-33411.35 2376,-33411.35 2376,-33359.35 2594,-33359.35 2594,-33411.35"/>
<text text-anchor="middle" x="2485" y="-33399.35" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-33388.35" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-33377.35" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-33366.35" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_25_route&#45;&gt;moe_25_expert_10 -->
<g id="edge825" class="edge">
<title>moe_25_route&#45;&gt;moe_25_expert_10</title>
<path fill="none" stroke="black" d="M2065.82,-33460.04C2152.45,-33447.34 2260.58,-33430.62 2365.9,-33411.52"/>
<polygon fill="black" stroke="black" points="2366.54,-33414.96 2375.75,-33409.73 2365.29,-33408.07 2366.54,-33414.96"/>
</g>
<!-- moe_25_expert_11 -->
<g id="node511" class="node">
<title>moe_25_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-33411.35 2612,-33411.35 2612,-33359.35 2830,-33359.35 2830,-33411.35"/>
<text text-anchor="middle" x="2721" y="-33399.35" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-33388.35" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-33377.35" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-33366.35" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_25_route&#45;&gt;moe_25_expert_11 -->
<g id="edge826" class="edge">
<title>moe_25_route&#45;&gt;moe_25_expert_11</title>
<path fill="none" stroke="black" d="M2098.79,-33468.58C2237.22,-33457.05 2426.53,-33438.57 2601.86,-33411.47"/>
<polygon fill="black" stroke="black" points="2602.44,-33414.92 2611.78,-33409.92 2601.37,-33408 2602.44,-33414.92"/>
</g>
<!-- moe_25_expert_12 -->
<g id="node512" class="node">
<title>moe_25_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-33411.35 2848,-33411.35 2848,-33359.35 3066,-33359.35 3066,-33411.35"/>
<text text-anchor="middle" x="2957" y="-33399.35" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-33388.35" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-33377.35" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-33366.35" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_25_route&#45;&gt;moe_25_expert_12 -->
<g id="edge827" class="edge">
<title>moe_25_route&#45;&gt;moe_25_expert_12</title>
<path fill="none" stroke="black" d="M2112.36,-33474.95C2300.53,-33465.81 2583.27,-33447.47 2837.62,-33411.47"/>
<polygon fill="black" stroke="black" points="2838.39,-33414.9 2847.8,-33410.02 2837.41,-33407.97 2838.39,-33414.9"/>
</g>
<!-- moe_25_expert_13 -->
<g id="node513" class="node">
<title>moe_25_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-33411.35 3084,-33411.35 3084,-33359.35 3302,-33359.35 3302,-33411.35"/>
<text text-anchor="middle" x="3193" y="-33399.35" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-33388.35" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-33377.35" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-33366.35" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_25_route&#45;&gt;moe_25_expert_13 -->
<g id="edge828" class="edge">
<title>moe_25_route&#45;&gt;moe_25_expert_13</title>
<path fill="none" stroke="black" d="M2117.24,-33479.46C2351.18,-33473.3 2735.06,-33456.79 3073.8,-33411.43"/>
<polygon fill="black" stroke="black" points="3074.37,-33414.89 3083.81,-33410.08 3073.43,-33407.95 3074.37,-33414.89"/>
</g>
<!-- moe_25_expert_14 -->
<g id="node514" class="node">
<title>moe_25_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-33411.35 3320,-33411.35 3320,-33359.35 3538,-33359.35 3538,-33411.35"/>
<text text-anchor="middle" x="3429" y="-33399.35" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-33388.35" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-33377.35" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-33366.35" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_25_route&#45;&gt;moe_25_expert_14 -->
<g id="edge829" class="edge">
<title>moe_25_route&#45;&gt;moe_25_expert_14</title>
<path fill="none" stroke="black" d="M2118.75,-33482.67C2394.41,-33479.69 2883.72,-33466.34 3309.76,-33411.43"/>
<polygon fill="black" stroke="black" points="3310.35,-33414.88 3319.81,-33410.12 3309.45,-33407.94 3310.35,-33414.88"/>
</g>
<!-- moe_25_expert_15 -->
<g id="node515" class="node">
<title>moe_25_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-33411.35 3556,-33411.35 3556,-33359.35 3774,-33359.35 3774,-33411.35"/>
<text text-anchor="middle" x="3665" y="-33399.35" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-33388.35" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-33377.35" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-33366.35" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_25_route&#45;&gt;moe_25_expert_15 -->
<g id="edge830" class="edge">
<title>moe_25_route&#45;&gt;moe_25_expert_15</title>
<path fill="none" stroke="black" d="M2116.04,-33478.17C2492.76,-33468.75 3258.5,-33446.18 3545.8,-33411.39"/>
<polygon fill="black" stroke="black" points="3546.32,-33414.85 3555.82,-33410.15 3545.46,-33407.91 3546.32,-33414.85"/>
</g>
<!-- moe_25_aggregate -->
<g id="node516" class="node">
<title>moe_25_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1940" cy="-33286.59" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1940" y="-33300.59" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1940" y="-33289.59" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1940" y="-33278.59" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1940" y="-33267.59" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_25_expert_0&#45;&gt;moe_25_aggregate -->
<g id="edge831" class="edge">
<title>moe_25_expert_0&#45;&gt;moe_25_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-33360.55C237.15,-33360.12 240.09,-33359.72 243,-33359.35 519.46,-33324.47 1312.65,-33301.98 1708.91,-33292.59"/>
<polygon fill="black" stroke="black" points="1709.16,-33296.09 1719.07,-33292.35 1708.99,-33289.09 1709.16,-33296.09"/>
</g>
<!-- moe_25_expert_1&#45;&gt;moe_25_aggregate -->
<g id="edge832" class="edge">
<title>moe_25_expert_1&#45;&gt;moe_25_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-33360.58C473.15,-33360.14 476.09,-33359.73 479,-33359.35 909.74,-33303.51 1417.06,-33290.25 1706.36,-33287.6"/>
<polygon fill="black" stroke="black" points="1706.59,-33291.1 1716.56,-33287.51 1706.53,-33284.1 1706.59,-33291.1"/>
</g>
<!-- moe_25_expert_2&#45;&gt;moe_25_aggregate -->
<g id="edge833" class="edge">
<title>moe_25_expert_2&#45;&gt;moe_25_aggregate</title>
<path fill="none" stroke="black" d="M706.19,-33360.62C709.15,-33360.17 712.09,-33359.75 715,-33359.35 1058.62,-33313.16 1460.42,-33296.69 1707.55,-33290.83"/>
<polygon fill="black" stroke="black" points="1707.82,-33294.32 1717.74,-33290.59 1707.66,-33287.32 1707.82,-33294.32"/>
</g>
<!-- moe_25_expert_3&#45;&gt;moe_25_aggregate -->
<g id="edge834" class="edge">
<title>moe_25_expert_3&#45;&gt;moe_25_aggregate</title>
<path fill="none" stroke="black" d="M942.2,-33360.67C945.16,-33360.21 948.1,-33359.77 951,-33359.35 1210.4,-33322.64 1510.89,-33304.21 1711.95,-33295.31"/>
<polygon fill="black" stroke="black" points="1712.21,-33298.8 1722.04,-33294.86 1711.9,-33291.81 1712.21,-33298.8"/>
</g>
<!-- moe_25_expert_4&#45;&gt;moe_25_aggregate -->
<g id="edge835" class="edge">
<title>moe_25_expert_4&#45;&gt;moe_25_aggregate</title>
<path fill="none" stroke="black" d="M1178.21,-33360.76C1181.17,-33360.27 1184.1,-33359.8 1187,-33359.35 1366.87,-33331.82 1572.64,-33313.07 1723.56,-33301.65"/>
<polygon fill="black" stroke="black" points="1724.17,-33305.12 1733.88,-33300.88 1723.65,-33298.14 1724.17,-33305.12"/>
</g>
<!-- moe_25_expert_5&#45;&gt;moe_25_aggregate -->
<g id="edge836" class="edge">
<title>moe_25_expert_5&#45;&gt;moe_25_aggregate</title>
<path fill="none" stroke="black" d="M1414.24,-33360.93C1417.19,-33360.39 1420.11,-33359.86 1423,-33359.35 1531.84,-33340.3 1654.29,-33323.11 1752.69,-33310.34"/>
<polygon fill="black" stroke="black" points="1753.28,-33313.79 1762.75,-33309.04 1752.38,-33306.85 1753.28,-33313.79"/>
</g>
<!-- moe_25_expert_6&#45;&gt;moe_25_aggregate -->
<g id="edge837" class="edge">
<title>moe_25_expert_6&#45;&gt;moe_25_aggregate</title>
<path fill="none" stroke="black" d="M1644.27,-33359.31C1694.05,-33347.24 1754.34,-33332.61 1807.46,-33319.73"/>
<polygon fill="black" stroke="black" points="1808.4,-33323.1 1817.29,-33317.35 1806.75,-33316.3 1808.4,-33323.1"/>
</g>
<!-- moe_25_expert_7&#45;&gt;moe_25_aggregate -->
<g id="edge838" class="edge">
<title>moe_25_expert_7&#45;&gt;moe_25_aggregate</title>
<path fill="none" stroke="black" d="M1819.4,-33359.18C1835.78,-33349.46 1854.91,-33338.1 1873.05,-33327.33"/>
<polygon fill="black" stroke="black" points="1875.05,-33330.22 1881.86,-33322.1 1871.47,-33324.2 1875.05,-33330.22"/>
</g>
<!-- moe_25_expert_8&#45;&gt;moe_25_aggregate -->
<g id="edge839" class="edge">
<title>moe_25_expert_8&#45;&gt;moe_25_aggregate</title>
<path fill="none" stroke="black" d="M1994.01,-33359.18C1987.61,-33350.69 1980.26,-33340.95 1973.09,-33331.45"/>
<polygon fill="black" stroke="black" points="1975.68,-33329.07 1966.86,-33323.2 1970.09,-33333.29 1975.68,-33329.07"/>
</g>
<!-- moe_25_expert_9&#45;&gt;moe_25_aggregate -->
<g id="edge840" class="edge">
<title>moe_25_expert_9&#45;&gt;moe_25_aggregate</title>
<path fill="none" stroke="black" d="M2169.02,-33359.31C2133.17,-33348.08 2090.27,-33334.65 2051.35,-33322.46"/>
<polygon fill="black" stroke="black" points="2052.13,-33319.03 2041.55,-33319.39 2050.04,-33325.71 2052.13,-33319.03"/>
</g>
<!-- moe_25_expert_10&#45;&gt;moe_25_aggregate -->
<g id="edge841" class="edge">
<title>moe_25_expert_10&#45;&gt;moe_25_aggregate</title>
<path fill="none" stroke="black" d="M2375.74,-33361.04C2372.8,-33360.46 2369.88,-33359.9 2367,-33359.35 2282.01,-33343.22 2187.15,-33327.09 2108.46,-33314.22"/>
<polygon fill="black" stroke="black" points="2108.89,-33310.74 2098.45,-33312.58 2107.76,-33317.65 2108.89,-33310.74"/>
</g>
<!-- moe_25_expert_11&#45;&gt;moe_25_aggregate -->
<g id="edge842" class="edge">
<title>moe_25_expert_11&#45;&gt;moe_25_aggregate</title>
<path fill="none" stroke="black" d="M2611.78,-33360.81C2608.83,-33360.3 2605.9,-33359.82 2603,-33359.35 2451.46,-33335.16 2279.11,-33316.78 2148.12,-33304.68"/>
<polygon fill="black" stroke="black" points="2148.25,-33301.18 2137.97,-33303.75 2147.61,-33308.15 2148.25,-33301.18"/>
</g>
<!-- moe_25_expert_12&#45;&gt;moe_25_aggregate -->
<g id="edge843" class="edge">
<title>moe_25_expert_12&#45;&gt;moe_25_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-33360.7C2844.84,-33360.23 2841.9,-33359.78 2839,-33359.35 2610.7,-33326.2 2347.4,-33307.43 2165.01,-33297.48"/>
<polygon fill="black" stroke="black" points="2164.93,-33293.97 2154.75,-33296.92 2164.55,-33300.96 2164.93,-33293.97"/>
</g>
<!-- moe_25_expert_13&#45;&gt;moe_25_aggregate -->
<g id="edge844" class="edge">
<title>moe_25_expert_13&#45;&gt;moe_25_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-33360.64C3080.84,-33360.18 3077.9,-33359.75 3075,-33359.35 2763.94,-33316.8 2401.41,-33299.42 2171.35,-33292.36"/>
<polygon fill="black" stroke="black" points="2171.28,-33288.86 2161.18,-33292.05 2171.07,-33295.85 2171.28,-33288.86"/>
</g>
<!-- moe_25_expert_14&#45;&gt;moe_25_aggregate -->
<g id="edge845" class="edge">
<title>moe_25_expert_14&#45;&gt;moe_25_aggregate</title>
<path fill="none" stroke="black" d="M3319.81,-33360.59C3316.85,-33360.15 3313.91,-33359.74 3311,-33359.35 2913.72,-33307.2 2447,-33292.59 2173.36,-33288.71"/>
<polygon fill="black" stroke="black" points="2173.35,-33285.21 2163.3,-33288.57 2173.25,-33292.21 2173.35,-33285.21"/>
</g>
<!-- moe_25_expert_15&#45;&gt;moe_25_aggregate -->
<g id="edge846" class="edge">
<title>moe_25_expert_15&#45;&gt;moe_25_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-33360.56C3552.85,-33360.13 3549.91,-33359.73 3547,-33359.35 3287.91,-33326.35 2549.54,-33303.26 2170.57,-33293.22"/>
<polygon fill="black" stroke="black" points="2170.39,-33289.71 2160.3,-33292.95 2170.2,-33296.71 2170.39,-33289.71"/>
</g>
<!-- moe_25_ffn -->
<g id="node517" class="node">
<title>moe_25_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2098,-33213.82 1782,-33213.82 1782,-33161.82 2098,-33161.82 2098,-33213.82"/>
<text text-anchor="middle" x="1940" y="-33201.82" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1940" y="-33190.82" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1940" y="-33179.82" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1940" y="-33168.82" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_25_aggregate&#45;&gt;moe_25_ffn -->
<g id="edge847" class="edge">
<title>moe_25_aggregate&#45;&gt;moe_25_ffn</title>
<path fill="none" stroke="black" d="M1940,-33249.55C1940,-33241.24 1940,-33232.41 1940,-33224.12"/>
<polygon fill="black" stroke="black" points="1943.5,-33224.01 1940,-33214.01 1936.5,-33224.01 1943.5,-33224.01"/>
</g>
<!-- moe_25_res2 -->
<g id="node519" class="node">
<title>moe_25_res2</title>
<polygon fill="lightyellow" stroke="black" points="2276.89,-33125.82 1740.97,-33125.82 1603.11,-33021.82 2139.03,-33021.82 2276.89,-33125.82"/>
<text text-anchor="middle" x="1940" y="-33087.82" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1940" y="-33076.82" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1940" y="-33065.82" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1940" y="-33054.82" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_25_ffn&#45;&gt;moe_25_res2 -->
<g id="edge848" class="edge">
<title>moe_25_ffn&#45;&gt;moe_25_res2</title>
<path fill="none" stroke="black" d="M1940,-33161.68C1940,-33154 1940,-33145.18 1940,-33136.18"/>
<polygon fill="black" stroke="black" points="1943.5,-33135.99 1940,-33125.99 1936.5,-33135.99 1943.5,-33135.99"/>
</g>
<!-- moe_25_res1&#45;&gt;moe_25_gate -->
<g id="edge813" class="edge">
<title>moe_25_res1&#45;&gt;moe_25_gate</title>
<path fill="none" stroke="black" d="M1901,-33696.51C1901,-33688.34 1901,-33679.81 1901,-33671.43"/>
<polygon fill="black" stroke="black" points="1904.5,-33671.32 1901,-33661.32 1897.5,-33671.32 1904.5,-33671.32"/>
</g>
<!-- moe_26_mha -->
<g id="node520" class="node">
<title>moe_26_mha</title>
<polygon fill="lightgreen" stroke="black" points="2098,-32974.82 1782,-32974.82 1782,-32922.82 2098,-32922.82 2098,-32974.82"/>
<text text-anchor="middle" x="1940" y="-32962.82" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1940" y="-32951.82" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1940" y="-32940.82" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1940" y="-32929.82" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_25_res2&#45;&gt;moe_26_mha -->
<g id="edge849" class="edge">
<title>moe_25_res2&#45;&gt;moe_26_mha</title>
<path fill="none" stroke="black" d="M1940,-33021.72C1940,-33009.39 1940,-32996.49 1940,-32985.07"/>
<polygon fill="black" stroke="black" points="1943.5,-32985.06 1940,-32975.06 1936.5,-32985.06 1943.5,-32985.06"/>
</g>
<!-- moe_26_res1 -->
<g id="node541" class="node">
<title>moe_26_res1</title>
<polygon fill="lightyellow" stroke="black" points="2276.89,-32886.82 1740.97,-32886.82 1603.11,-32782.82 2139.03,-32782.82 2276.89,-32886.82"/>
<text text-anchor="middle" x="1940" y="-32848.82" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1940" y="-32837.82" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1940" y="-32826.82" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1940" y="-32815.82" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_26_mha&#45;&gt;moe_26_res1 -->
<g id="edge850" class="edge">
<title>moe_26_mha&#45;&gt;moe_26_res1</title>
<path fill="none" stroke="black" d="M1940,-32922.68C1940,-32915 1940,-32906.18 1940,-32897.18"/>
<polygon fill="black" stroke="black" points="1943.5,-32896.99 1940,-32886.99 1936.5,-32896.99 1943.5,-32896.99"/>
</g>
<!-- moe_26_gate -->
<g id="node521" class="node">
<title>moe_26_gate</title>
<polygon fill="lightyellow" stroke="black" points="2268.8,-32746.82 1745.75,-32746.82 1611.2,-32642.82 2134.25,-32642.82 2268.8,-32746.82"/>
<text text-anchor="middle" x="1940" y="-32708.82" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1940" y="-32697.82" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1940" y="-32686.82" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1940" y="-32675.82" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_26_route -->
<g id="node522" class="node">
<title>moe_26_route</title>
<ellipse fill="lightblue" stroke="black" cx="1940" cy="-32570.05" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1940" y="-32584.05" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1940" y="-32573.05" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1940" y="-32562.05" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1940" y="-32551.05" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_26_gate&#45;&gt;moe_26_route -->
<g id="edge852" class="edge">
<title>moe_26_gate&#45;&gt;moe_26_route</title>
<path fill="none" stroke="black" d="M1940,-32642.46C1940,-32634.05 1940,-32625.39 1940,-32617.12"/>
<polygon fill="black" stroke="black" points="1943.5,-32616.9 1940,-32606.9 1936.5,-32616.9 1943.5,-32616.9"/>
</g>
<!-- moe_26_expert_0 -->
<g id="node523" class="node">
<title>moe_26_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="323,-32497.28 105,-32497.28 105,-32445.28 323,-32445.28 323,-32497.28"/>
<text text-anchor="middle" x="214" y="-32485.28" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="214" y="-32474.28" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="214" y="-32463.28" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="214" y="-32452.28" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_26_route&#45;&gt;moe_26_expert_0 -->
<g id="edge853" class="edge">
<title>moe_26_route&#45;&gt;moe_26_expert_0</title>
<path fill="none" stroke="black" d="M1725.14,-32563.83C1355.62,-32554.15 613.32,-32531.33 333.35,-32497.33"/>
<polygon fill="black" stroke="black" points="333.54,-32493.83 323.18,-32496.07 332.67,-32500.78 333.54,-32493.83"/>
</g>
<!-- moe_26_expert_1 -->
<g id="node524" class="node">
<title>moe_26_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="559,-32497.28 341,-32497.28 341,-32445.28 559,-32445.28 559,-32497.28"/>
<text text-anchor="middle" x="450" y="-32485.28" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="450" y="-32474.28" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="450" y="-32463.28" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="450" y="-32452.28" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_26_route&#45;&gt;moe_26_expert_1 -->
<g id="edge854" class="edge">
<title>moe_26_route&#45;&gt;moe_26_expert_1</title>
<path fill="none" stroke="black" d="M1722.21,-32568.14C1452.99,-32564.64 980.97,-32550.7 569.21,-32497.35"/>
<polygon fill="black" stroke="black" points="569.56,-32493.86 559.19,-32496.04 568.65,-32500.8 569.56,-32493.86"/>
</g>
<!-- moe_26_expert_2 -->
<g id="node525" class="node">
<title>moe_26_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="795,-32497.28 577,-32497.28 577,-32445.28 795,-32445.28 795,-32497.28"/>
<text text-anchor="middle" x="686" y="-32485.28" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="686" y="-32474.28" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="686" y="-32463.28" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="686" y="-32452.28" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_26_route&#45;&gt;moe_26_expert_2 -->
<g id="edge855" class="edge">
<title>moe_26_route&#45;&gt;moe_26_expert_2</title>
<path fill="none" stroke="black" d="M1724.46,-32564.76C1497.63,-32558.1 1130.28,-32541.21 805.28,-32497.37"/>
<polygon fill="black" stroke="black" points="805.57,-32493.87 795.19,-32496 804.63,-32500.81 805.57,-32493.87"/>
</g>
<!-- moe_26_expert_3 -->
<g id="node526" class="node">
<title>moe_26_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1031,-32497.28 813,-32497.28 813,-32445.28 1031,-32445.28 1031,-32497.28"/>
<text text-anchor="middle" x="922" y="-32485.28" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="922" y="-32474.28" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="922" y="-32463.28" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="922" y="-32452.28" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_26_route&#45;&gt;moe_26_expert_3 -->
<g id="edge856" class="edge">
<title>moe_26_route&#45;&gt;moe_26_expert_3</title>
<path fill="none" stroke="black" d="M1730.46,-32560.01C1550.01,-32550.43 1282.63,-32531.94 1041.23,-32497.38"/>
<polygon fill="black" stroke="black" points="1041.6,-32493.9 1031.2,-32495.93 1040.6,-32500.82 1041.6,-32493.9"/>
</g>
<!-- moe_26_expert_4 -->
<g id="node527" class="node">
<title>moe_26_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1267,-32497.28 1049,-32497.28 1049,-32445.28 1267,-32445.28 1267,-32497.28"/>
<text text-anchor="middle" x="1158" y="-32485.28" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1158" y="-32474.28" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1158" y="-32463.28" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1158" y="-32452.28" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_26_route&#45;&gt;moe_26_expert_4 -->
<g id="edge857" class="edge">
<title>moe_26_route&#45;&gt;moe_26_expert_4</title>
<path fill="none" stroke="black" d="M1746.1,-32553.3C1616.03,-32541.48 1440.8,-32523.17 1277.46,-32497.45"/>
<polygon fill="black" stroke="black" points="1277.64,-32493.93 1267.22,-32495.82 1276.55,-32500.85 1277.64,-32493.93"/>
</g>
<!-- moe_26_expert_5 -->
<g id="node528" class="node">
<title>moe_26_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1503,-32497.28 1285,-32497.28 1285,-32445.28 1503,-32445.28 1503,-32497.28"/>
<text text-anchor="middle" x="1394" y="-32485.28" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1394" y="-32474.28" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1394" y="-32463.28" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1394" y="-32452.28" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_26_route&#45;&gt;moe_26_expert_5 -->
<g id="edge858" class="edge">
<title>moe_26_route&#45;&gt;moe_26_expert_5</title>
<path fill="none" stroke="black" d="M1783.44,-32544.44C1705.06,-32531.71 1608.52,-32515.44 1513.36,-32497.51"/>
<polygon fill="black" stroke="black" points="1513.73,-32494.02 1503.26,-32495.6 1512.43,-32500.89 1513.73,-32494.02"/>
</g>
<!-- moe_26_expert_6 -->
<g id="node529" class="node">
<title>moe_26_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1739,-32497.28 1521,-32497.28 1521,-32445.28 1739,-32445.28 1739,-32497.28"/>
<text text-anchor="middle" x="1630" y="-32485.28" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1630" y="-32474.28" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1630" y="-32463.28" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1630" y="-32452.28" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_26_route&#45;&gt;moe_26_expert_6 -->
<g id="edge859" class="edge">
<title>moe_26_route&#45;&gt;moe_26_expert_6</title>
<path fill="none" stroke="black" d="M1838.49,-32537.36C1800.24,-32525.42 1757.03,-32511.93 1719.91,-32500.34"/>
<polygon fill="black" stroke="black" points="1720.7,-32496.92 1710.11,-32497.28 1718.61,-32503.6 1720.7,-32496.92"/>
</g>
<!-- moe_26_expert_7 -->
<g id="node530" class="node">
<title>moe_26_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1975,-32497.28 1757,-32497.28 1757,-32445.28 1975,-32445.28 1975,-32497.28"/>
<text text-anchor="middle" x="1866" y="-32485.28" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1866" y="-32474.28" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1866" y="-32463.28" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1866" y="-32452.28" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_26_route&#45;&gt;moe_26_expert_7 -->
<g id="edge860" class="edge">
<title>moe_26_route&#45;&gt;moe_26_expert_7</title>
<path fill="none" stroke="black" d="M1912.87,-32533.56C1905.85,-32524.39 1898.33,-32514.56 1891.41,-32505.51"/>
<polygon fill="black" stroke="black" points="1894.11,-32503.28 1885.26,-32497.46 1888.55,-32507.53 1894.11,-32503.28"/>
</g>
<!-- moe_26_expert_8 -->
<g id="node531" class="node">
<title>moe_26_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2211,-32497.28 1993,-32497.28 1993,-32445.28 2211,-32445.28 2211,-32497.28"/>
<text text-anchor="middle" x="2102" y="-32485.28" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2102" y="-32474.28" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2102" y="-32463.28" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2102" y="-32452.28" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_26_route&#45;&gt;moe_26_expert_8 -->
<g id="edge861" class="edge">
<title>moe_26_route&#45;&gt;moe_26_expert_8</title>
<path fill="none" stroke="black" d="M1998.03,-32534.38C2015.5,-32523.95 2034.53,-32512.58 2051.47,-32502.46"/>
<polygon fill="black" stroke="black" points="2053.33,-32505.42 2060.12,-32497.29 2049.74,-32499.41 2053.33,-32505.42"/>
</g>
<!-- moe_26_expert_9 -->
<g id="node532" class="node">
<title>moe_26_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2447,-32497.28 2229,-32497.28 2229,-32445.28 2447,-32445.28 2447,-32497.28"/>
<text text-anchor="middle" x="2338" y="-32485.28" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2338" y="-32474.28" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2338" y="-32463.28" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2338" y="-32452.28" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_26_route&#45;&gt;moe_26_expert_9 -->
<g id="edge862" class="edge">
<title>moe_26_route&#45;&gt;moe_26_expert_9</title>
<path fill="none" stroke="black" d="M2061.58,-32539.49C2113.66,-32526.82 2174.12,-32512.12 2225.19,-32499.71"/>
<polygon fill="black" stroke="black" points="2226.05,-32503.1 2234.94,-32497.33 2224.4,-32496.3 2226.05,-32503.1"/>
</g>
<!-- moe_26_expert_10 -->
<g id="node533" class="node">
<title>moe_26_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2683,-32497.28 2465,-32497.28 2465,-32445.28 2683,-32445.28 2683,-32497.28"/>
<text text-anchor="middle" x="2574" y="-32485.28" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2574" y="-32474.28" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2574" y="-32463.28" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2574" y="-32452.28" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_26_route&#45;&gt;moe_26_expert_10 -->
<g id="edge863" class="edge">
<title>moe_26_route&#45;&gt;moe_26_expert_10</title>
<path fill="none" stroke="black" d="M2114.24,-32547.92C2211.74,-32535.35 2335.65,-32518.12 2454.73,-32497.45"/>
<polygon fill="black" stroke="black" points="2455.51,-32500.87 2464.76,-32495.7 2454.31,-32493.98 2455.51,-32500.87"/>
</g>
<!-- moe_26_expert_11 -->
<g id="node534" class="node">
<title>moe_26_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2919,-32497.28 2701,-32497.28 2701,-32445.28 2919,-32445.28 2919,-32497.28"/>
<text text-anchor="middle" x="2810" y="-32485.28" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2810" y="-32474.28" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2810" y="-32463.28" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2810" y="-32452.28" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_26_route&#45;&gt;moe_26_expert_11 -->
<g id="edge864" class="edge">
<title>moe_26_route&#45;&gt;moe_26_expert_11</title>
<path fill="none" stroke="black" d="M2141.45,-32556.06C2290.73,-32544.96 2499.19,-32526.34 2690.81,-32497.39"/>
<polygon fill="black" stroke="black" points="2691.43,-32500.84 2700.79,-32495.87 2690.38,-32493.92 2691.43,-32500.84"/>
</g>
<!-- moe_26_expert_12 -->
<g id="node535" class="node">
<title>moe_26_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3155,-32497.28 2937,-32497.28 2937,-32445.28 3155,-32445.28 3155,-32497.28"/>
<text text-anchor="middle" x="3046" y="-32485.28" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3046" y="-32474.28" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3046" y="-32463.28" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3046" y="-32452.28" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_26_route&#45;&gt;moe_26_expert_12 -->
<g id="edge865" class="edge">
<title>moe_26_route&#45;&gt;moe_26_expert_12</title>
<path fill="none" stroke="black" d="M2152.89,-32561.96C2351.14,-32553.42 2654.84,-32535.33 2926.74,-32497.37"/>
<polygon fill="black" stroke="black" points="2927.39,-32500.82 2936.8,-32495.96 2926.41,-32493.89 2927.39,-32500.82"/>
</g>
<!-- moe_26_expert_13 -->
<g id="node536" class="node">
<title>moe_26_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3391,-32497.28 3173,-32497.28 3173,-32445.28 3391,-32445.28 3391,-32497.28"/>
<text text-anchor="middle" x="3282" y="-32485.28" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3282" y="-32474.28" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3282" y="-32463.28" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3282" y="-32452.28" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_26_route&#45;&gt;moe_26_expert_13 -->
<g id="edge866" class="edge">
<title>moe_26_route&#45;&gt;moe_26_expert_13</title>
<path fill="none" stroke="black" d="M2156.79,-32566.15C2399.9,-32560.65 2805.78,-32544.72 3162.79,-32497.35"/>
<polygon fill="black" stroke="black" points="3163.36,-32500.81 3172.81,-32496.01 3162.43,-32493.87 3163.36,-32500.81"/>
</g>
<!-- moe_26_expert_14 -->
<g id="node537" class="node">
<title>moe_26_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3627,-32497.28 3409,-32497.28 3409,-32445.28 3627,-32445.28 3627,-32497.28"/>
<text text-anchor="middle" x="3518" y="-32485.28" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3518" y="-32474.28" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3518" y="-32463.28" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3518" y="-32452.28" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_26_route&#45;&gt;moe_26_expert_14 -->
<g id="edge867" class="edge">
<title>moe_26_route&#45;&gt;moe_26_expert_14</title>
<path fill="none" stroke="black" d="M2158.02,-32569.16C2442.07,-32566.84 2953.96,-32554.29 3398.65,-32497.36"/>
<polygon fill="black" stroke="black" points="3399.34,-32500.8 3408.81,-32496.05 3398.45,-32493.86 3399.34,-32500.8"/>
</g>
<!-- moe_26_expert_15 -->
<g id="node538" class="node">
<title>moe_26_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3863,-32497.28 3645,-32497.28 3645,-32445.28 3863,-32445.28 3863,-32497.28"/>
<text text-anchor="middle" x="3754" y="-32485.28" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3754" y="-32474.28" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3754" y="-32463.28" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3754" y="-32452.28" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_26_route&#45;&gt;moe_26_expert_15 -->
<g id="edge868" class="edge">
<title>moe_26_route&#45;&gt;moe_26_expert_15</title>
<path fill="none" stroke="black" d="M2155.42,-32564.4C2541.5,-32555.34 3337.89,-32533.11 3634.89,-32497.3"/>
<polygon fill="black" stroke="black" points="3635.32,-32500.78 3644.82,-32496.08 3634.46,-32493.83 3635.32,-32500.78"/>
</g>
<!-- moe_26_aggregate -->
<g id="node539" class="node">
<title>moe_26_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1970" cy="-32372.51" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1970" y="-32386.51" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1970" y="-32375.51" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1970" y="-32364.51" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1970" y="-32353.51" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_26_expert_0&#45;&gt;moe_26_aggregate -->
<g id="edge869" class="edge">
<title>moe_26_expert_0&#45;&gt;moe_26_aggregate</title>
<path fill="none" stroke="black" d="M323.18,-32446.48C326.15,-32446.05 329.09,-32445.65 332,-32445.28 597.12,-32411.62 1354.56,-32388.72 1739.47,-32378.91"/>
<polygon fill="black" stroke="black" points="1739.71,-32382.41 1749.62,-32378.65 1739.53,-32375.41 1739.71,-32382.41"/>
</g>
<!-- moe_26_expert_1&#45;&gt;moe_26_aggregate -->
<g id="edge870" class="edge">
<title>moe_26_expert_1&#45;&gt;moe_26_aggregate</title>
<path fill="none" stroke="black" d="M559.19,-32446.51C562.15,-32446.07 565.09,-32445.66 568,-32445.28 976.65,-32391.87 1457.15,-32377.7 1736.28,-32374.24"/>
<polygon fill="black" stroke="black" points="1736.58,-32377.74 1746.54,-32374.12 1736.5,-32370.74 1736.58,-32377.74"/>
</g>
<!-- moe_26_expert_2&#45;&gt;moe_26_aggregate -->
<g id="edge871" class="edge">
<title>moe_26_expert_2&#45;&gt;moe_26_aggregate</title>
<path fill="none" stroke="black" d="M795.19,-32446.55C798.15,-32446.1 801.1,-32445.67 804,-32445.28 1126.32,-32401.46 1502.43,-32384.37 1738.42,-32377.72"/>
<polygon fill="black" stroke="black" points="1738.6,-32381.22 1748.5,-32377.44 1738.41,-32374.22 1738.6,-32381.22"/>
</g>
<!-- moe_26_expert_3&#45;&gt;moe_26_aggregate -->
<g id="edge872" class="edge">
<title>moe_26_expert_3&#45;&gt;moe_26_aggregate</title>
<path fill="none" stroke="black" d="M1031.2,-32446.61C1034.16,-32446.14 1037.1,-32445.69 1040,-32445.28 1278.96,-32410.9 1555,-32392.22 1743.89,-32382.61"/>
<polygon fill="black" stroke="black" points="1744.13,-32386.11 1753.94,-32382.11 1743.78,-32379.12 1744.13,-32386.11"/>
</g>
<!-- moe_26_expert_4&#45;&gt;moe_26_aggregate -->
<g id="edge873" class="edge">
<title>moe_26_expert_4&#45;&gt;moe_26_aggregate</title>
<path fill="none" stroke="black" d="M1267.22,-32446.71C1270.17,-32446.21 1273.1,-32445.73 1276,-32445.28 1437.1,-32419.95 1620.69,-32401.42 1758.57,-32389.53"/>
<polygon fill="black" stroke="black" points="1759.17,-32392.99 1768.83,-32388.65 1758.57,-32386.02 1759.17,-32392.99"/>
</g>
<!-- moe_26_expert_5&#45;&gt;moe_26_aggregate -->
<g id="edge874" class="edge">
<title>moe_26_expert_5&#45;&gt;moe_26_aggregate</title>
<path fill="none" stroke="black" d="M1503.25,-32446.92C1506.2,-32446.36 1509.12,-32445.81 1512,-32445.28 1604.98,-32428.15 1709.07,-32411.63 1794.5,-32398.77"/>
<polygon fill="black" stroke="black" points="1795.18,-32402.2 1804.55,-32397.26 1794.14,-32395.28 1795.18,-32402.2"/>
</g>
<!-- moe_26_expert_6&#45;&gt;moe_26_aggregate -->
<g id="edge875" class="edge">
<title>moe_26_expert_6&#45;&gt;moe_26_aggregate</title>
<path fill="none" stroke="black" d="M1718,-32445.23C1758.52,-32433.7 1807.21,-32419.84 1850.94,-32407.39"/>
<polygon fill="black" stroke="black" points="1852.11,-32410.7 1860.77,-32404.59 1850.2,-32403.97 1852.11,-32410.7"/>
</g>
<!-- moe_26_expert_7&#45;&gt;moe_26_aggregate -->
<g id="edge876" class="edge">
<title>moe_26_expert_7&#45;&gt;moe_26_aggregate</title>
<path fill="none" stroke="black" d="M1893.05,-32445.1C1902.74,-32436.09 1913.93,-32425.68 1924.73,-32415.63"/>
<polygon fill="black" stroke="black" points="1927.18,-32418.13 1932.12,-32408.75 1922.42,-32413 1927.18,-32418.13"/>
</g>
<!-- moe_26_expert_8&#45;&gt;moe_26_aggregate -->
<g id="edge877" class="edge">
<title>moe_26_expert_8&#45;&gt;moe_26_aggregate</title>
<path fill="none" stroke="black" d="M2067.66,-32445.1C2055.02,-32435.84 2040.34,-32425.08 2026.27,-32414.76"/>
<polygon fill="black" stroke="black" points="2028.21,-32411.84 2018.08,-32408.75 2024.07,-32417.49 2028.21,-32411.84"/>
</g>
<!-- moe_26_expert_9&#45;&gt;moe_26_aggregate -->
<g id="edge878" class="edge">
<title>moe_26_expert_9&#45;&gt;moe_26_aggregate</title>
<path fill="none" stroke="black" d="M2242.75,-32445.23C2197.92,-32433.44 2143.85,-32419.22 2095.72,-32406.57"/>
<polygon fill="black" stroke="black" points="2096.42,-32403.13 2085.86,-32403.97 2094.64,-32409.9 2096.42,-32403.13"/>
</g>
<!-- moe_26_expert_10&#45;&gt;moe_26_aggregate -->
<g id="edge879" class="edge">
<title>moe_26_expert_10&#45;&gt;moe_26_aggregate</title>
<path fill="none" stroke="black" d="M2464.76,-32446.88C2461.81,-32446.33 2458.89,-32445.79 2456,-32445.28 2355.57,-32427.24 2242.86,-32410.39 2151.28,-32397.55"/>
<polygon fill="black" stroke="black" points="2151.75,-32394.08 2141.36,-32396.16 2150.78,-32401.01 2151.75,-32394.08"/>
</g>
<!-- moe_26_expert_11&#45;&gt;moe_26_aggregate -->
<g id="edge880" class="edge">
<title>moe_26_expert_11&#45;&gt;moe_26_aggregate</title>
<path fill="none" stroke="black" d="M2700.79,-32446.7C2697.83,-32446.2 2694.9,-32445.73 2692,-32445.28 2521.97,-32418.9 2327.83,-32400.23 2183.72,-32388.56"/>
<polygon fill="black" stroke="black" points="2183.68,-32385.05 2173.43,-32387.74 2183.12,-32392.03 2183.68,-32385.05"/>
</g>
<!-- moe_26_expert_12&#45;&gt;moe_26_aggregate -->
<g id="edge881" class="edge">
<title>moe_26_expert_12&#45;&gt;moe_26_aggregate</title>
<path fill="none" stroke="black" d="M2936.8,-32446.6C2933.84,-32446.13 2930.9,-32445.69 2928,-32445.28 2679.29,-32409.78 2391.59,-32391.21 2196.89,-32381.93"/>
<polygon fill="black" stroke="black" points="2196.97,-32378.43 2186.82,-32381.46 2196.64,-32385.42 2196.97,-32378.43"/>
</g>
<!-- moe_26_expert_13&#45;&gt;moe_26_aggregate -->
<g id="edge882" class="edge">
<title>moe_26_expert_13&#45;&gt;moe_26_aggregate</title>
<path fill="none" stroke="black" d="M3172.81,-32446.55C3169.85,-32446.09 3166.91,-32445.67 3164,-32445.28 2831.66,-32400.34 2443.47,-32383.54 2202.15,-32377.25"/>
<polygon fill="black" stroke="black" points="2201.93,-32373.75 2191.84,-32376.99 2201.75,-32380.75 2201.93,-32373.75"/>
</g>
<!-- moe_26_expert_14&#45;&gt;moe_26_aggregate -->
<g id="edge883" class="edge">
<title>moe_26_expert_14&#45;&gt;moe_26_aggregate</title>
<path fill="none" stroke="black" d="M3408.81,-32446.51C3405.85,-32446.07 3402.91,-32445.65 3400,-32445.28 2980.84,-32390.71 2487.59,-32376.97 2203.61,-32373.89"/>
<polygon fill="black" stroke="black" points="2203.64,-32370.39 2193.6,-32373.79 2203.56,-32377.39 2203.64,-32370.39"/>
</g>
<!-- moe_26_expert_15&#45;&gt;moe_26_aggregate -->
<g id="edge884" class="edge">
<title>moe_26_expert_15&#45;&gt;moe_26_aggregate</title>
<path fill="none" stroke="black" d="M3644.82,-32446.48C3641.85,-32446.05 3638.91,-32445.64 3636,-32445.28 3365.48,-32411.03 2590.99,-32388.32 2200.7,-32378.72"/>
<polygon fill="black" stroke="black" points="2200.78,-32375.22 2190.7,-32378.47 2200.61,-32382.22 2200.78,-32375.22"/>
</g>
<!-- moe_26_ffn -->
<g id="node540" class="node">
<title>moe_26_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2128,-32299.74 1812,-32299.74 1812,-32247.74 2128,-32247.74 2128,-32299.74"/>
<text text-anchor="middle" x="1970" y="-32287.74" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1970" y="-32276.74" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1970" y="-32265.74" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1970" y="-32254.74" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_26_aggregate&#45;&gt;moe_26_ffn -->
<g id="edge885" class="edge">
<title>moe_26_aggregate&#45;&gt;moe_26_ffn</title>
<path fill="none" stroke="black" d="M1970,-32335.47C1970,-32327.16 1970,-32318.33 1970,-32310.05"/>
<polygon fill="black" stroke="black" points="1973.5,-32309.93 1970,-32299.93 1966.5,-32309.93 1973.5,-32309.93"/>
</g>
<!-- moe_26_res2 -->
<g id="node542" class="node">
<title>moe_26_res2</title>
<polygon fill="lightyellow" stroke="black" points="2306.89,-32211.74 1770.97,-32211.74 1633.11,-32107.74 2169.03,-32107.74 2306.89,-32211.74"/>
<text text-anchor="middle" x="1970" y="-32173.74" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1970" y="-32162.74" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1970" y="-32151.74" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1970" y="-32140.74" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_26_ffn&#45;&gt;moe_26_res2 -->
<g id="edge886" class="edge">
<title>moe_26_ffn&#45;&gt;moe_26_res2</title>
<path fill="none" stroke="black" d="M1970,-32247.6C1970,-32239.92 1970,-32231.1 1970,-32222.11"/>
<polygon fill="black" stroke="black" points="1973.5,-32221.92 1970,-32211.92 1966.5,-32221.92 1973.5,-32221.92"/>
</g>
<!-- moe_26_res1&#45;&gt;moe_26_gate -->
<g id="edge851" class="edge">
<title>moe_26_res1&#45;&gt;moe_26_gate</title>
<path fill="none" stroke="black" d="M1940,-32782.43C1940,-32774.26 1940,-32765.73 1940,-32757.36"/>
<polygon fill="black" stroke="black" points="1943.5,-32757.24 1940,-32747.24 1936.5,-32757.24 1943.5,-32757.24"/>
</g>
<!-- moe_27_mha -->
<g id="node543" class="node">
<title>moe_27_mha</title>
<polygon fill="lightgreen" stroke="black" points="2128,-32060.74 1812,-32060.74 1812,-32008.74 2128,-32008.74 2128,-32060.74"/>
<text text-anchor="middle" x="1970" y="-32048.74" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1970" y="-32037.74" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1970" y="-32026.74" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1970" y="-32015.74" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_26_res2&#45;&gt;moe_27_mha -->
<g id="edge887" class="edge">
<title>moe_26_res2&#45;&gt;moe_27_mha</title>
<path fill="none" stroke="black" d="M1970,-32107.64C1970,-32095.31 1970,-32082.41 1970,-32070.99"/>
<polygon fill="black" stroke="black" points="1973.5,-32070.98 1970,-32060.98 1966.5,-32070.98 1973.5,-32070.98"/>
</g>
<!-- moe_27_res1 -->
<g id="node564" class="node">
<title>moe_27_res1</title>
<polygon fill="lightyellow" stroke="black" points="2306.89,-31972.74 1770.97,-31972.74 1633.11,-31868.74 2169.03,-31868.74 2306.89,-31972.74"/>
<text text-anchor="middle" x="1970" y="-31934.74" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1970" y="-31923.74" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1970" y="-31912.74" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1970" y="-31901.74" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_27_mha&#45;&gt;moe_27_res1 -->
<g id="edge888" class="edge">
<title>moe_27_mha&#45;&gt;moe_27_res1</title>
<path fill="none" stroke="black" d="M1970,-32008.6C1970,-32000.92 1970,-31992.1 1970,-31983.11"/>
<polygon fill="black" stroke="black" points="1973.5,-31982.92 1970,-31972.92 1966.5,-31982.92 1973.5,-31982.92"/>
</g>
<!-- moe_27_gate -->
<g id="node544" class="node">
<title>moe_27_gate</title>
<polygon fill="lightyellow" stroke="black" points="2298.8,-31832.74 1775.75,-31832.74 1641.2,-31728.74 2164.25,-31728.74 2298.8,-31832.74"/>
<text text-anchor="middle" x="1970" y="-31794.74" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1970" y="-31783.74" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1970" y="-31772.74" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1970" y="-31761.74" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_27_route -->
<g id="node545" class="node">
<title>moe_27_route</title>
<ellipse fill="lightblue" stroke="black" cx="1970" cy="-31655.97" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1970" y="-31669.97" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1970" y="-31658.97" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1970" y="-31647.97" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1970" y="-31636.97" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_27_gate&#45;&gt;moe_27_route -->
<g id="edge890" class="edge">
<title>moe_27_gate&#45;&gt;moe_27_route</title>
<path fill="none" stroke="black" d="M1970,-31728.38C1970,-31719.97 1970,-31711.31 1970,-31703.04"/>
<polygon fill="black" stroke="black" points="1973.5,-31702.82 1970,-31692.82 1966.5,-31702.82 1973.5,-31702.82"/>
</g>
<!-- moe_27_expert_0 -->
<g id="node546" class="node">
<title>moe_27_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="295,-31583.2 77,-31583.2 77,-31531.2 295,-31531.2 295,-31583.2"/>
<text text-anchor="middle" x="186" y="-31571.2" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="186" y="-31560.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="186" y="-31549.2" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="186" y="-31538.2" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_27_route&#45;&gt;moe_27_expert_0 -->
<g id="edge891" class="edge">
<title>moe_27_route&#45;&gt;moe_27_expert_0</title>
<path fill="none" stroke="black" d="M1754.62,-31650.13C1374.15,-31640.86 596.6,-31618.43 305.34,-31583.25"/>
<polygon fill="black" stroke="black" points="305.54,-31579.75 295.18,-31582 304.68,-31586.7 305.54,-31579.75"/>
</g>
<!-- moe_27_expert_1 -->
<g id="node547" class="node">
<title>moe_27_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="531,-31583.2 313,-31583.2 313,-31531.2 531,-31531.2 531,-31583.2"/>
<text text-anchor="middle" x="422" y="-31571.2" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="422" y="-31560.2" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="422" y="-31549.2" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="422" y="-31538.2" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_27_route&#45;&gt;moe_27_expert_1 -->
<g id="edge892" class="edge">
<title>moe_27_route&#45;&gt;moe_27_expert_1</title>
<path fill="none" stroke="black" d="M1752.21,-31654.75C1473.22,-31652.03 974.92,-31639 541.41,-31583.29"/>
<polygon fill="black" stroke="black" points="541.55,-31579.78 531.19,-31581.97 540.65,-31586.72 541.55,-31579.78"/>
</g>
<!-- moe_27_expert_2 -->
<g id="node548" class="node">
<title>moe_27_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="767,-31583.2 549,-31583.2 549,-31531.2 767,-31531.2 767,-31583.2"/>
<text text-anchor="middle" x="658" y="-31571.2" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="658" y="-31560.2" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="658" y="-31549.2" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="658" y="-31538.2" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_27_route&#45;&gt;moe_27_expert_2 -->
<g id="edge893" class="edge">
<title>moe_27_route&#45;&gt;moe_27_expert_2</title>
<path fill="none" stroke="black" d="M1753.64,-31651.62C1516,-31645.73 1123.25,-31629.45 777.16,-31583.27"/>
<polygon fill="black" stroke="black" points="777.57,-31579.79 767.19,-31581.93 776.64,-31586.73 777.57,-31579.79"/>
</g>
<!-- moe_27_expert_3 -->
<g id="node549" class="node">
<title>moe_27_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1003,-31583.2 785,-31583.2 785,-31531.2 1003,-31531.2 1003,-31583.2"/>
<text text-anchor="middle" x="894" y="-31571.2" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="894" y="-31560.2" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="894" y="-31549.2" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="894" y="-31538.2" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_27_route&#45;&gt;moe_27_expert_3 -->
<g id="edge894" class="edge">
<title>moe_27_route&#45;&gt;moe_27_expert_3</title>
<path fill="none" stroke="black" d="M1758.4,-31647.26C1566.17,-31638.36 1274.81,-31620.11 1013.27,-31583.3"/>
<polygon fill="black" stroke="black" points="1013.59,-31579.81 1003.2,-31581.87 1012.61,-31586.74 1013.59,-31579.81"/>
</g>
<!-- moe_27_expert_4 -->
<g id="node550" class="node">
<title>moe_27_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1239,-31583.2 1021,-31583.2 1021,-31531.2 1239,-31531.2 1239,-31583.2"/>
<text text-anchor="middle" x="1130" y="-31571.2" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1130" y="-31560.2" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1130" y="-31549.2" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1130" y="-31538.2" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_27_route&#45;&gt;moe_27_expert_4 -->
<g id="edge895" class="edge">
<title>moe_27_route&#45;&gt;moe_27_expert_4</title>
<path fill="none" stroke="black" d="M1770.83,-31641.08C1628.05,-31629.71 1431.09,-31611.16 1249.24,-31583.32"/>
<polygon fill="black" stroke="black" points="1249.63,-31579.84 1239.21,-31581.78 1248.56,-31586.76 1249.63,-31579.84"/>
</g>
<!-- moe_27_expert_5 -->
<g id="node551" class="node">
<title>moe_27_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1475,-31583.2 1257,-31583.2 1257,-31531.2 1475,-31531.2 1475,-31583.2"/>
<text text-anchor="middle" x="1366" y="-31571.2" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1366" y="-31560.2" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1366" y="-31549.2" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1366" y="-31538.2" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_27_route&#45;&gt;moe_27_expert_5 -->
<g id="edge896" class="edge">
<title>moe_27_route&#45;&gt;moe_27_expert_5</title>
<path fill="none" stroke="black" d="M1801.17,-31632.66C1710.25,-31620.01 1595.96,-31603.09 1485.26,-31583.38"/>
<polygon fill="black" stroke="black" points="1485.7,-31579.91 1475.24,-31581.59 1484.47,-31586.8 1485.7,-31579.91"/>
</g>
<!-- moe_27_expert_6 -->
<g id="node552" class="node">
<title>moe_27_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1711,-31583.2 1493,-31583.2 1493,-31531.2 1711,-31531.2 1711,-31583.2"/>
<text text-anchor="middle" x="1602" y="-31571.2" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1602" y="-31560.2" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1602" y="-31549.2" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1602" y="-31538.2" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_27_route&#45;&gt;moe_27_expert_6 -->
<g id="edge897" class="edge">
<title>moe_27_route&#45;&gt;moe_27_expert_6</title>
<path fill="none" stroke="black" d="M1854.82,-31624.68C1807.48,-31612.23 1753.04,-31597.92 1706.83,-31585.77"/>
<polygon fill="black" stroke="black" points="1707.67,-31582.37 1697.1,-31583.21 1705.89,-31589.14 1707.67,-31582.37"/>
</g>
<!-- moe_27_expert_7 -->
<g id="node553" class="node">
<title>moe_27_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1947,-31583.2 1729,-31583.2 1729,-31531.2 1947,-31531.2 1947,-31583.2"/>
<text text-anchor="middle" x="1838" y="-31571.2" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1838" y="-31560.2" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1838" y="-31549.2" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1838" y="-31538.2" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_27_route&#45;&gt;moe_27_expert_7 -->
<g id="edge898" class="edge">
<title>moe_27_route&#45;&gt;moe_27_expert_7</title>
<path fill="none" stroke="black" d="M1922.34,-31620.03C1908.65,-31609.99 1893.8,-31599.11 1880.44,-31589.31"/>
<polygon fill="black" stroke="black" points="1882.47,-31586.46 1872.34,-31583.37 1878.33,-31592.11 1882.47,-31586.46"/>
</g>
<!-- moe_27_expert_8 -->
<g id="node554" class="node">
<title>moe_27_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2183,-31583.2 1965,-31583.2 1965,-31531.2 2183,-31531.2 2183,-31583.2"/>
<text text-anchor="middle" x="2074" y="-31571.2" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2074" y="-31560.2" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2074" y="-31549.2" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2074" y="-31538.2" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_27_route&#45;&gt;moe_27_expert_8 -->
<g id="edge899" class="edge">
<title>moe_27_route&#45;&gt;moe_27_expert_8</title>
<path fill="none" stroke="black" d="M2008.14,-31619.48C2018.39,-31609.94 2029.42,-31599.68 2039.47,-31590.33"/>
<polygon fill="black" stroke="black" points="2042,-31592.76 2046.93,-31583.38 2037.23,-31587.63 2042,-31592.76"/>
</g>
<!-- moe_27_expert_9 -->
<g id="node555" class="node">
<title>moe_27_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2419,-31583.2 2201,-31583.2 2201,-31531.2 2419,-31531.2 2419,-31583.2"/>
<text text-anchor="middle" x="2310" y="-31571.2" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2310" y="-31560.2" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2310" y="-31549.2" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2310" y="-31538.2" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_27_route&#45;&gt;moe_27_expert_9 -->
<g id="edge900" class="edge">
<title>moe_27_route&#45;&gt;moe_27_expert_9</title>
<path fill="none" stroke="black" d="M2078.51,-31624.08C2121.51,-31611.84 2170.58,-31597.88 2212.44,-31585.97"/>
<polygon fill="black" stroke="black" points="2213.43,-31589.32 2222.08,-31583.22 2211.51,-31582.59 2213.43,-31589.32"/>
</g>
<!-- moe_27_expert_10 -->
<g id="node556" class="node">
<title>moe_27_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2655,-31583.2 2437,-31583.2 2437,-31531.2 2655,-31531.2 2655,-31583.2"/>
<text text-anchor="middle" x="2546" y="-31571.2" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2546" y="-31560.2" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2546" y="-31549.2" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2546" y="-31538.2" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_27_route&#45;&gt;moe_27_expert_10 -->
<g id="edge901" class="edge">
<title>moe_27_route&#45;&gt;moe_27_expert_10</title>
<path fill="none" stroke="black" d="M2133.04,-31631.58C2217.93,-31618.87 2323.6,-31602.24 2426.77,-31583.39"/>
<polygon fill="black" stroke="black" points="2427.55,-31586.81 2436.75,-31581.56 2426.28,-31579.92 2427.55,-31586.81"/>
</g>
<!-- moe_27_expert_11 -->
<g id="node557" class="node">
<title>moe_27_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2891,-31583.2 2673,-31583.2 2673,-31531.2 2891,-31531.2 2891,-31583.2"/>
<text text-anchor="middle" x="2782" y="-31571.2" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2782" y="-31560.2" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2782" y="-31549.2" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2782" y="-31538.2" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_27_route&#45;&gt;moe_27_expert_11 -->
<g id="edge902" class="edge">
<title>moe_27_route&#45;&gt;moe_27_expert_11</title>
<path fill="none" stroke="black" d="M2167.03,-31640.18C2303.69,-31628.58 2489.97,-31610.13 2662.74,-31583.33"/>
<polygon fill="black" stroke="black" points="2663.44,-31586.76 2672.78,-31581.76 2662.36,-31579.85 2663.44,-31586.76"/>
</g>
<!-- moe_27_expert_12 -->
<g id="node558" class="node">
<title>moe_27_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3127,-31583.2 2909,-31583.2 2909,-31531.2 3127,-31531.2 3127,-31583.2"/>
<text text-anchor="middle" x="3018" y="-31571.2" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3018" y="-31560.2" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3018" y="-31549.2" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3018" y="-31538.2" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_27_route&#45;&gt;moe_27_expert_12 -->
<g id="edge903" class="edge">
<title>moe_27_route&#45;&gt;moe_27_expert_12</title>
<path fill="none" stroke="black" d="M2180.94,-31646.62C2367.51,-31637.38 2647.07,-31619 2898.73,-31583.3"/>
<polygon fill="black" stroke="black" points="2899.4,-31586.74 2908.8,-31581.86 2898.4,-31579.81 2899.4,-31586.74"/>
</g>
<!-- moe_27_expert_13 -->
<g id="node559" class="node">
<title>moe_27_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3363,-31583.2 3145,-31583.2 3145,-31531.2 3363,-31531.2 3363,-31583.2"/>
<text text-anchor="middle" x="3254" y="-31571.2" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3254" y="-31560.2" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3254" y="-31549.2" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3254" y="-31538.2" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_27_route&#45;&gt;moe_27_expert_13 -->
<g id="edge904" class="edge">
<title>moe_27_route&#45;&gt;moe_27_expert_13</title>
<path fill="none" stroke="black" d="M2186.1,-31651.18C2418.59,-31644.91 2799.03,-31628.32 3134.88,-31583.26"/>
<polygon fill="black" stroke="black" points="3135.37,-31586.73 3144.81,-31581.92 3134.43,-31579.79 3135.37,-31586.73"/>
</g>
<!-- moe_27_expert_14 -->
<g id="node560" class="node">
<title>moe_27_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3599,-31583.2 3381,-31583.2 3381,-31531.2 3599,-31531.2 3599,-31583.2"/>
<text text-anchor="middle" x="3490" y="-31571.2" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3490" y="-31560.2" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3490" y="-31549.2" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3490" y="-31538.2" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_27_route&#45;&gt;moe_27_expert_14 -->
<g id="edge905" class="edge">
<title>moe_27_route&#45;&gt;moe_27_expert_14</title>
<path fill="none" stroke="black" d="M2187.72,-31654.43C2462.04,-31651.33 2947.77,-31637.86 3370.83,-31583.26"/>
<polygon fill="black" stroke="black" points="3371.35,-31586.72 3380.81,-31581.96 3370.45,-31579.78 3371.35,-31586.72"/>
</g>
<!-- moe_27_expert_15 -->
<g id="node561" class="node">
<title>moe_27_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3835,-31583.2 3617,-31583.2 3617,-31531.2 3835,-31531.2 3835,-31583.2"/>
<text text-anchor="middle" x="3726" y="-31571.2" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3726" y="-31560.2" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3726" y="-31549.2" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3726" y="-31538.2" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_27_route&#45;&gt;moe_27_expert_15 -->
<g id="edge906" class="edge">
<title>moe_27_route&#45;&gt;moe_27_expert_15</title>
<path fill="none" stroke="black" d="M2185.12,-31649.96C2560.41,-31640.48 3321.2,-31617.85 3606.86,-31583.23"/>
<polygon fill="black" stroke="black" points="3607.32,-31586.7 3616.82,-31581.99 3606.46,-31579.75 3607.32,-31586.7"/>
</g>
<!-- moe_27_aggregate -->
<g id="node562" class="node">
<title>moe_27_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1956" cy="-31458.43" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1956" y="-31472.43" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1956" y="-31461.43" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1956" y="-31450.43" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1956" y="-31439.43" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_27_expert_0&#45;&gt;moe_27_aggregate -->
<g id="edge907" class="edge">
<title>moe_27_expert_0&#45;&gt;moe_27_aggregate</title>
<path fill="none" stroke="black" d="M295.18,-31532.4C298.15,-31531.97 301.09,-31531.57 304,-31531.2 571.74,-31497.26 1337.32,-31474.46 1725.04,-31464.74"/>
<polygon fill="black" stroke="black" points="1725.35,-31468.24 1735.26,-31464.49 1725.17,-31461.24 1725.35,-31468.24"/>
</g>
<!-- moe_27_expert_1&#45;&gt;moe_27_aggregate -->
<g id="edge908" class="edge">
<title>moe_27_expert_1&#45;&gt;moe_27_aggregate</title>
<path fill="none" stroke="black" d="M531.19,-31532.43C534.15,-31531.99 537.09,-31531.58 540,-31531.2 953.79,-31477.22 1440.51,-31463.26 1722.11,-31459.99"/>
<polygon fill="black" stroke="black" points="1722.49,-31463.48 1732.45,-31459.87 1722.41,-31456.48 1722.49,-31463.48"/>
</g>
<!-- moe_27_expert_2&#45;&gt;moe_27_aggregate -->
<g id="edge909" class="edge">
<title>moe_27_expert_2&#45;&gt;moe_27_aggregate</title>
<path fill="none" stroke="black" d="M767.19,-31532.47C770.15,-31532.02 773.09,-31531.59 776,-31531.2 1103.31,-31486.82 1485.45,-31469.87 1724.11,-31463.41"/>
<polygon fill="black" stroke="black" points="1724.4,-31466.9 1734.31,-31463.14 1724.22,-31459.91 1724.4,-31466.9"/>
</g>
<!-- moe_27_expert_3&#45;&gt;moe_27_aggregate -->
<g id="edge910" class="edge">
<title>moe_27_expert_3&#45;&gt;moe_27_aggregate</title>
<path fill="none" stroke="black" d="M1003.2,-31532.53C1006.16,-31532.06 1009.1,-31531.61 1012,-31531.2 1255.76,-31496.27 1537.52,-31477.64 1729.32,-31468.2"/>
<polygon fill="black" stroke="black" points="1729.71,-31471.68 1739.53,-31467.7 1729.37,-31464.69 1729.71,-31471.68"/>
</g>
<!-- moe_27_expert_4&#45;&gt;moe_27_aggregate -->
<g id="edge911" class="edge">
<title>moe_27_expert_4&#45;&gt;moe_27_aggregate</title>
<path fill="none" stroke="black" d="M1239.21,-31532.63C1242.17,-31532.13 1245.1,-31531.65 1248,-31531.2 1413.7,-31505.32 1602.73,-31486.71 1743.77,-31474.93"/>
<polygon fill="black" stroke="black" points="1744.17,-31478.41 1753.84,-31474.1 1743.59,-31471.44 1744.17,-31478.41"/>
</g>
<!-- moe_27_expert_5&#45;&gt;moe_27_aggregate -->
<g id="edge912" class="edge">
<title>moe_27_expert_5&#45;&gt;moe_27_aggregate</title>
<path fill="none" stroke="black" d="M1475.25,-31532.82C1478.19,-31532.26 1481.12,-31531.72 1484,-31531.2 1580.58,-31513.64 1688.83,-31496.97 1777.27,-31484.12"/>
<polygon fill="black" stroke="black" points="1778.01,-31487.55 1787.4,-31482.65 1777,-31480.62 1778.01,-31487.55"/>
</g>
<!-- moe_27_expert_6&#45;&gt;moe_27_aggregate -->
<g id="edge913" class="edge">
<title>moe_27_expert_6&#45;&gt;moe_27_aggregate</title>
<path fill="none" stroke="black" d="M1693.62,-31531.15C1736.27,-31519.49 1787.62,-31505.46 1833.54,-31492.9"/>
<polygon fill="black" stroke="black" points="1834.53,-31496.26 1843.25,-31490.25 1832.68,-31489.51 1834.53,-31496.26"/>
</g>
<!-- moe_27_expert_7&#45;&gt;moe_27_aggregate -->
<g id="edge914" class="edge">
<title>moe_27_expert_7&#45;&gt;moe_27_aggregate</title>
<path fill="none" stroke="black" d="M1868.7,-31531.03C1879.79,-31521.93 1892.63,-31511.4 1904.99,-31501.26"/>
<polygon fill="black" stroke="black" points="1907.51,-31503.72 1913.02,-31494.67 1903.07,-31498.31 1907.51,-31503.72"/>
</g>
<!-- moe_27_expert_8&#45;&gt;moe_27_aggregate -->
<g id="edge915" class="edge">
<title>moe_27_expert_8&#45;&gt;moe_27_aggregate</title>
<path fill="none" stroke="black" d="M2043.3,-31531.03C2032.21,-31521.93 2019.37,-31511.4 2007.01,-31501.26"/>
<polygon fill="black" stroke="black" points="2008.93,-31498.31 1998.98,-31494.67 2004.49,-31503.72 2008.93,-31498.31"/>
</g>
<!-- moe_27_expert_9&#45;&gt;moe_27_aggregate -->
<g id="edge916" class="edge">
<title>moe_27_expert_9&#45;&gt;moe_27_aggregate</title>
<path fill="none" stroke="black" d="M2218.38,-31531.15C2175.73,-31519.49 2124.38,-31505.46 2078.46,-31492.9"/>
<polygon fill="black" stroke="black" points="2079.32,-31489.51 2068.75,-31490.25 2077.47,-31496.26 2079.32,-31489.51"/>
</g>
<!-- moe_27_expert_10&#45;&gt;moe_27_aggregate -->
<g id="edge917" class="edge">
<title>moe_27_expert_10&#45;&gt;moe_27_aggregate</title>
<path fill="none" stroke="black" d="M2436.75,-31532.82C2433.81,-31532.26 2430.88,-31531.72 2428,-31531.2 2331.42,-31513.64 2223.17,-31496.97 2134.73,-31484.12"/>
<polygon fill="black" stroke="black" points="2135,-31480.62 2124.6,-31482.65 2133.99,-31487.55 2135,-31480.62"/>
</g>
<!-- moe_27_expert_11&#45;&gt;moe_27_aggregate -->
<g id="edge918" class="edge">
<title>moe_27_expert_11&#45;&gt;moe_27_aggregate</title>
<path fill="none" stroke="black" d="M2672.79,-31532.63C2669.83,-31532.13 2666.9,-31531.65 2664,-31531.2 2498.3,-31505.32 2309.27,-31486.71 2168.23,-31474.93"/>
<polygon fill="black" stroke="black" points="2168.41,-31471.44 2158.16,-31474.1 2167.83,-31478.41 2168.41,-31471.44"/>
</g>
<!-- moe_27_expert_12&#45;&gt;moe_27_aggregate -->
<g id="edge919" class="edge">
<title>moe_27_expert_12&#45;&gt;moe_27_aggregate</title>
<path fill="none" stroke="black" d="M2908.8,-31532.53C2905.84,-31532.06 2902.9,-31531.61 2900,-31531.2 2656.24,-31496.27 2374.48,-31477.64 2182.68,-31468.2"/>
<polygon fill="black" stroke="black" points="2182.63,-31464.69 2172.47,-31467.7 2182.29,-31471.68 2182.63,-31464.69"/>
</g>
<!-- moe_27_expert_13&#45;&gt;moe_27_aggregate -->
<g id="edge920" class="edge">
<title>moe_27_expert_13&#45;&gt;moe_27_aggregate</title>
<path fill="none" stroke="black" d="M3144.81,-31532.47C3141.85,-31532.02 3138.91,-31531.59 3136,-31531.2 2808.69,-31486.82 2426.55,-31469.87 2187.89,-31463.41"/>
<polygon fill="black" stroke="black" points="2187.78,-31459.91 2177.69,-31463.14 2187.6,-31466.9 2187.78,-31459.91"/>
</g>
<!-- moe_27_expert_14&#45;&gt;moe_27_aggregate -->
<g id="edge921" class="edge">
<title>moe_27_expert_14&#45;&gt;moe_27_aggregate</title>
<path fill="none" stroke="black" d="M3380.81,-31532.43C3377.85,-31531.99 3374.91,-31531.58 3372,-31531.2 2958.21,-31477.22 2471.49,-31463.26 2189.89,-31459.99"/>
<polygon fill="black" stroke="black" points="2189.59,-31456.48 2179.55,-31459.87 2189.51,-31463.48 2189.59,-31456.48"/>
</g>
<!-- moe_27_expert_15&#45;&gt;moe_27_aggregate -->
<g id="edge922" class="edge">
<title>moe_27_expert_15&#45;&gt;moe_27_aggregate</title>
<path fill="none" stroke="black" d="M3616.82,-31532.4C3613.85,-31531.97 3610.91,-31531.57 3608,-31531.2 3340.26,-31497.26 2574.68,-31474.46 2186.96,-31464.74"/>
<polygon fill="black" stroke="black" points="2186.83,-31461.24 2176.74,-31464.49 2186.65,-31468.24 2186.83,-31461.24"/>
</g>
<!-- moe_27_ffn -->
<g id="node563" class="node">
<title>moe_27_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2114,-31385.66 1798,-31385.66 1798,-31333.66 2114,-31333.66 2114,-31385.66"/>
<text text-anchor="middle" x="1956" y="-31373.66" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1956" y="-31362.66" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1956" y="-31351.66" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1956" y="-31340.66" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_27_aggregate&#45;&gt;moe_27_ffn -->
<g id="edge923" class="edge">
<title>moe_27_aggregate&#45;&gt;moe_27_ffn</title>
<path fill="none" stroke="black" d="M1956,-31421.4C1956,-31413.08 1956,-31404.25 1956,-31395.97"/>
<polygon fill="black" stroke="black" points="1959.5,-31395.86 1956,-31385.86 1952.5,-31395.86 1959.5,-31395.86"/>
</g>
<!-- moe_27_res2 -->
<g id="node565" class="node">
<title>moe_27_res2</title>
<polygon fill="lightyellow" stroke="black" points="2292.89,-31297.66 1756.97,-31297.66 1619.11,-31193.66 2155.03,-31193.66 2292.89,-31297.66"/>
<text text-anchor="middle" x="1956" y="-31259.66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1956" y="-31248.66" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1956" y="-31237.66" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1956" y="-31226.66" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_27_ffn&#45;&gt;moe_27_res2 -->
<g id="edge924" class="edge">
<title>moe_27_ffn&#45;&gt;moe_27_res2</title>
<path fill="none" stroke="black" d="M1956,-31333.52C1956,-31325.84 1956,-31317.03 1956,-31308.03"/>
<polygon fill="black" stroke="black" points="1959.5,-31307.84 1956,-31297.84 1952.5,-31307.84 1959.5,-31307.84"/>
</g>
<!-- moe_27_res1&#45;&gt;moe_27_gate -->
<g id="edge889" class="edge">
<title>moe_27_res1&#45;&gt;moe_27_gate</title>
<path fill="none" stroke="black" d="M1970,-31868.35C1970,-31860.18 1970,-31851.65 1970,-31843.28"/>
<polygon fill="black" stroke="black" points="1973.5,-31843.17 1970,-31833.17 1966.5,-31843.17 1973.5,-31843.17"/>
</g>
<!-- moe_28_mha -->
<g id="node566" class="node">
<title>moe_28_mha</title>
<polygon fill="lightgreen" stroke="black" points="2114,-31146.66 1798,-31146.66 1798,-31094.66 2114,-31094.66 2114,-31146.66"/>
<text text-anchor="middle" x="1956" y="-31134.66" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1956" y="-31123.66" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1956" y="-31112.66" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1956" y="-31101.66" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_27_res2&#45;&gt;moe_28_mha -->
<g id="edge925" class="edge">
<title>moe_27_res2&#45;&gt;moe_28_mha</title>
<path fill="none" stroke="black" d="M1956,-31193.56C1956,-31181.23 1956,-31168.33 1956,-31156.91"/>
<polygon fill="black" stroke="black" points="1959.5,-31156.9 1956,-31146.9 1952.5,-31156.9 1959.5,-31156.9"/>
</g>
<!-- moe_28_res1 -->
<g id="node587" class="node">
<title>moe_28_res1</title>
<polygon fill="lightyellow" stroke="black" points="2292.89,-31058.66 1756.97,-31058.66 1619.11,-30954.66 2155.03,-30954.66 2292.89,-31058.66"/>
<text text-anchor="middle" x="1956" y="-31020.66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1956" y="-31009.66" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1956" y="-30998.66" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1956" y="-30987.66" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_28_mha&#45;&gt;moe_28_res1 -->
<g id="edge926" class="edge">
<title>moe_28_mha&#45;&gt;moe_28_res1</title>
<path fill="none" stroke="black" d="M1956,-31094.52C1956,-31086.84 1956,-31078.03 1956,-31069.03"/>
<polygon fill="black" stroke="black" points="1959.5,-31068.84 1956,-31058.84 1952.5,-31068.84 1959.5,-31068.84"/>
</g>
<!-- moe_28_gate -->
<g id="node567" class="node">
<title>moe_28_gate</title>
<polygon fill="lightyellow" stroke="black" points="2284.8,-30918.66 1761.75,-30918.66 1627.2,-30814.66 2150.25,-30814.66 2284.8,-30918.66"/>
<text text-anchor="middle" x="1956" y="-30880.66" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1956" y="-30869.66" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1956" y="-30858.66" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1956" y="-30847.66" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_28_route -->
<g id="node568" class="node">
<title>moe_28_route</title>
<ellipse fill="lightblue" stroke="black" cx="1956" cy="-30741.89" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1956" y="-30755.89" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1956" y="-30744.89" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1956" y="-30733.89" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1956" y="-30722.89" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_28_gate&#45;&gt;moe_28_route -->
<g id="edge928" class="edge">
<title>moe_28_gate&#45;&gt;moe_28_route</title>
<path fill="none" stroke="black" d="M1956,-30814.31C1956,-30805.9 1956,-30797.23 1956,-30788.96"/>
<polygon fill="black" stroke="black" points="1959.5,-30788.75 1956,-30778.75 1952.5,-30788.75 1959.5,-30788.75"/>
</g>
<!-- moe_28_expert_0 -->
<g id="node569" class="node">
<title>moe_28_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="295,-30669.12 77,-30669.12 77,-30617.12 295,-30617.12 295,-30669.12"/>
<text text-anchor="middle" x="186" y="-30657.12" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="186" y="-30646.12" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="186" y="-30635.12" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="186" y="-30624.12" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_28_route&#45;&gt;moe_28_expert_0 -->
<g id="edge929" class="edge">
<title>moe_28_route&#45;&gt;moe_28_expert_0</title>
<path fill="none" stroke="black" d="M1740.93,-30735.97C1363.11,-30726.6 593.75,-30704.07 305.24,-30669.16"/>
<polygon fill="black" stroke="black" points="305.54,-30665.67 295.18,-30667.92 304.68,-30672.62 305.54,-30665.67"/>
</g>
<!-- moe_28_expert_1 -->
<g id="node570" class="node">
<title>moe_28_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="531,-30669.12 313,-30669.12 313,-30617.12 531,-30617.12 531,-30669.12"/>
<text text-anchor="middle" x="422" y="-30657.12" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="422" y="-30646.12" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="422" y="-30635.12" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="422" y="-30624.12" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_28_route&#45;&gt;moe_28_expert_1 -->
<g id="edge930" class="edge">
<title>moe_28_route&#45;&gt;moe_28_expert_1</title>
<path fill="none" stroke="black" d="M1738.23,-30740.51C1461.57,-30737.61 969.56,-30724.35 541.29,-30669.2"/>
<polygon fill="black" stroke="black" points="541.55,-30665.7 531.19,-30667.89 540.65,-30672.64 541.55,-30665.7"/>
</g>
<!-- moe_28_expert_2 -->
<g id="node571" class="node">
<title>moe_28_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="767,-30669.12 549,-30669.12 549,-30617.12 767,-30617.12 767,-30669.12"/>
<text text-anchor="middle" x="658" y="-30657.12" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="658" y="-30646.12" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="658" y="-30635.12" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="658" y="-30624.12" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_28_route&#45;&gt;moe_28_expert_2 -->
<g id="edge931" class="edge">
<title>moe_28_route&#45;&gt;moe_28_expert_2</title>
<path fill="none" stroke="black" d="M1739.74,-30737.32C1504.7,-30731.24 1118.2,-30714.81 777.26,-30669.21"/>
<polygon fill="black" stroke="black" points="777.57,-30665.72 767.19,-30667.85 776.63,-30672.65 777.57,-30665.72"/>
</g>
<!-- moe_28_expert_3 -->
<g id="node572" class="node">
<title>moe_28_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1003,-30669.12 785,-30669.12 785,-30617.12 1003,-30617.12 1003,-30669.12"/>
<text text-anchor="middle" x="894" y="-30657.12" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="894" y="-30646.12" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="894" y="-30635.12" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="894" y="-30624.12" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_28_route&#45;&gt;moe_28_expert_3 -->
<g id="edge932" class="edge">
<title>moe_28_route&#45;&gt;moe_28_expert_3</title>
<path fill="none" stroke="black" d="M1744.7,-30732.87C1555.33,-30723.79 1270,-30705.49 1013.47,-30669.25"/>
<polygon fill="black" stroke="black" points="1013.59,-30665.73 1003.2,-30667.79 1012.61,-30672.66 1013.59,-30665.73"/>
</g>
<!-- moe_28_expert_4 -->
<g id="node573" class="node">
<title>moe_28_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1239,-30669.12 1021,-30669.12 1021,-30617.12 1239,-30617.12 1239,-30669.12"/>
<text text-anchor="middle" x="1130" y="-30657.12" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1130" y="-30646.12" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1130" y="-30635.12" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1130" y="-30624.12" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_28_route&#45;&gt;moe_28_expert_4 -->
<g id="edge933" class="edge">
<title>moe_28_route&#45;&gt;moe_28_expert_4</title>
<path fill="none" stroke="black" d="M1757.66,-30726.54C1617.96,-30715.05 1426.46,-30696.56 1249.25,-30669.25"/>
<polygon fill="black" stroke="black" points="1249.63,-30665.77 1239.21,-30667.69 1248.56,-30672.68 1249.63,-30665.77"/>
</g>
<!-- moe_28_expert_5 -->
<g id="node574" class="node">
<title>moe_28_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1475,-30669.12 1257,-30669.12 1257,-30617.12 1475,-30617.12 1475,-30669.12"/>
<text text-anchor="middle" x="1366" y="-30657.12" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1366" y="-30646.12" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1366" y="-30635.12" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1366" y="-30624.12" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_28_route&#45;&gt;moe_28_expert_5 -->
<g id="edge934" class="edge">
<title>moe_28_route&#45;&gt;moe_28_expert_5</title>
<path fill="none" stroke="black" d="M1789.87,-30718.03C1701.99,-30705.35 1592.11,-30688.57 1485.25,-30669.31"/>
<polygon fill="black" stroke="black" points="1485.71,-30665.84 1475.25,-30667.5 1484.46,-30672.72 1485.71,-30665.84"/>
</g>
<!-- moe_28_expert_6 -->
<g id="node575" class="node">
<title>moe_28_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1711,-30669.12 1493,-30669.12 1493,-30617.12 1711,-30617.12 1711,-30669.12"/>
<text text-anchor="middle" x="1602" y="-30657.12" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1602" y="-30646.12" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1602" y="-30635.12" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1602" y="-30624.12" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_28_route&#45;&gt;moe_28_expert_6 -->
<g id="edge935" class="edge">
<title>moe_28_route&#45;&gt;moe_28_expert_6</title>
<path fill="none" stroke="black" d="M1843.99,-30710.27C1798.98,-30697.97 1747.47,-30683.88 1703.56,-30671.88"/>
<polygon fill="black" stroke="black" points="1704.31,-30668.46 1693.74,-30669.2 1702.46,-30675.21 1704.31,-30668.46"/>
</g>
<!-- moe_28_expert_7 -->
<g id="node576" class="node">
<title>moe_28_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1947,-30669.12 1729,-30669.12 1729,-30617.12 1947,-30617.12 1947,-30669.12"/>
<text text-anchor="middle" x="1838" y="-30657.12" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1838" y="-30646.12" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1838" y="-30635.12" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1838" y="-30624.12" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_28_route&#45;&gt;moe_28_expert_7 -->
<g id="edge936" class="edge">
<title>moe_28_route&#45;&gt;moe_28_expert_7</title>
<path fill="none" stroke="black" d="M1913.07,-30705.68C1901.07,-30695.84 1888.12,-30685.22 1876.41,-30675.62"/>
<polygon fill="black" stroke="black" points="1878.47,-30672.79 1868.52,-30669.15 1874.04,-30678.2 1878.47,-30672.79"/>
</g>
<!-- moe_28_expert_8 -->
<g id="node577" class="node">
<title>moe_28_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2183,-30669.12 1965,-30669.12 1965,-30617.12 2183,-30617.12 2183,-30669.12"/>
<text text-anchor="middle" x="2074" y="-30657.12" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2074" y="-30646.12" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2074" y="-30635.12" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2074" y="-30624.12" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_28_route&#45;&gt;moe_28_expert_8 -->
<g id="edge937" class="edge">
<title>moe_28_route&#45;&gt;moe_28_expert_8</title>
<path fill="none" stroke="black" d="M1998.93,-30705.68C2010.93,-30695.84 2023.88,-30685.22 2035.59,-30675.62"/>
<polygon fill="black" stroke="black" points="2037.96,-30678.2 2043.48,-30669.15 2033.53,-30672.79 2037.96,-30678.2"/>
</g>
<!-- moe_28_expert_9 -->
<g id="node578" class="node">
<title>moe_28_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2419,-30669.12 2201,-30669.12 2201,-30617.12 2419,-30617.12 2419,-30669.12"/>
<text text-anchor="middle" x="2310" y="-30657.12" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2310" y="-30646.12" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2310" y="-30635.12" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2310" y="-30624.12" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_28_route&#45;&gt;moe_28_expert_9 -->
<g id="edge938" class="edge">
<title>moe_28_route&#45;&gt;moe_28_expert_9</title>
<path fill="none" stroke="black" d="M2068.01,-30710.27C2113.02,-30697.97 2164.53,-30683.88 2208.44,-30671.88"/>
<polygon fill="black" stroke="black" points="2209.54,-30675.21 2218.26,-30669.2 2207.69,-30668.46 2209.54,-30675.21"/>
</g>
<!-- moe_28_expert_10 -->
<g id="node579" class="node">
<title>moe_28_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2655,-30669.12 2437,-30669.12 2437,-30617.12 2655,-30617.12 2655,-30669.12"/>
<text text-anchor="middle" x="2546" y="-30657.12" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2546" y="-30646.12" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2546" y="-30635.12" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2546" y="-30624.12" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_28_route&#45;&gt;moe_28_expert_10 -->
<g id="edge939" class="edge">
<title>moe_28_route&#45;&gt;moe_28_expert_10</title>
<path fill="none" stroke="black" d="M2122.13,-30718.03C2210.01,-30705.35 2319.89,-30688.57 2426.75,-30669.31"/>
<polygon fill="black" stroke="black" points="2427.54,-30672.72 2436.75,-30667.5 2426.29,-30665.84 2427.54,-30672.72"/>
</g>
<!-- moe_28_expert_11 -->
<g id="node580" class="node">
<title>moe_28_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2891,-30669.12 2673,-30669.12 2673,-30617.12 2891,-30617.12 2891,-30669.12"/>
<text text-anchor="middle" x="2782" y="-30657.12" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2782" y="-30646.12" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2782" y="-30635.12" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2782" y="-30624.12" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_28_route&#45;&gt;moe_28_expert_11 -->
<g id="edge940" class="edge">
<title>moe_28_route&#45;&gt;moe_28_expert_11</title>
<path fill="none" stroke="black" d="M2154.34,-30726.54C2294.04,-30715.05 2485.54,-30696.56 2662.75,-30669.25"/>
<polygon fill="black" stroke="black" points="2663.44,-30672.68 2672.79,-30667.69 2662.37,-30665.77 2663.44,-30672.68"/>
</g>
<!-- moe_28_expert_12 -->
<g id="node581" class="node">
<title>moe_28_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3127,-30669.12 2909,-30669.12 2909,-30617.12 3127,-30617.12 3127,-30669.12"/>
<text text-anchor="middle" x="3018" y="-30657.12" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3018" y="-30646.12" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3018" y="-30635.12" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3018" y="-30624.12" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_28_route&#45;&gt;moe_28_expert_12 -->
<g id="edge941" class="edge">
<title>moe_28_route&#45;&gt;moe_28_expert_12</title>
<path fill="none" stroke="black" d="M2167.3,-30732.87C2356.67,-30723.79 2642,-30705.49 2898.53,-30669.25"/>
<polygon fill="black" stroke="black" points="2899.39,-30672.66 2908.8,-30667.79 2898.41,-30665.73 2899.39,-30672.66"/>
</g>
<!-- moe_28_expert_13 -->
<g id="node582" class="node">
<title>moe_28_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3363,-30669.12 3145,-30669.12 3145,-30617.12 3363,-30617.12 3363,-30669.12"/>
<text text-anchor="middle" x="3254" y="-30657.12" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3254" y="-30646.12" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3254" y="-30635.12" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3254" y="-30624.12" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_28_route&#45;&gt;moe_28_expert_13 -->
<g id="edge942" class="edge">
<title>moe_28_route&#45;&gt;moe_28_expert_13</title>
<path fill="none" stroke="black" d="M2172.26,-30737.32C2407.3,-30731.24 2793.8,-30714.81 3134.74,-30669.21"/>
<polygon fill="black" stroke="black" points="3135.37,-30672.65 3144.81,-30667.85 3134.43,-30665.72 3135.37,-30672.65"/>
</g>
<!-- moe_28_expert_14 -->
<g id="node583" class="node">
<title>moe_28_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3599,-30669.12 3381,-30669.12 3381,-30617.12 3599,-30617.12 3599,-30669.12"/>
<text text-anchor="middle" x="3490" y="-30657.12" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3490" y="-30646.12" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3490" y="-30635.12" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3490" y="-30624.12" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_28_route&#45;&gt;moe_28_expert_14 -->
<g id="edge943" class="edge">
<title>moe_28_route&#45;&gt;moe_28_expert_14</title>
<path fill="none" stroke="black" d="M2173.77,-30740.51C2450.43,-30737.61 2942.44,-30724.35 3370.71,-30669.2"/>
<polygon fill="black" stroke="black" points="3371.35,-30672.64 3380.81,-30667.89 3370.45,-30665.7 3371.35,-30672.64"/>
</g>
<!-- moe_28_expert_15 -->
<g id="node584" class="node">
<title>moe_28_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3835,-30669.12 3617,-30669.12 3617,-30617.12 3835,-30617.12 3835,-30669.12"/>
<text text-anchor="middle" x="3726" y="-30657.12" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3726" y="-30646.12" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3726" y="-30635.12" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3726" y="-30624.12" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_28_route&#45;&gt;moe_28_expert_15 -->
<g id="edge944" class="edge">
<title>moe_28_route&#45;&gt;moe_28_expert_15</title>
<path fill="none" stroke="black" d="M2171.07,-30735.97C2548.89,-30726.6 3318.25,-30704.07 3606.76,-30669.16"/>
<polygon fill="black" stroke="black" points="3607.32,-30672.62 3616.82,-30667.92 3606.46,-30665.67 3607.32,-30672.62"/>
</g>
<!-- moe_28_aggregate -->
<g id="node585" class="node">
<title>moe_28_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="2011" cy="-30544.35" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="2011" y="-30558.35" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="2011" y="-30547.35" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2011" y="-30536.35" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="2011" y="-30525.35" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_28_expert_0&#45;&gt;moe_28_aggregate -->
<g id="edge945" class="edge">
<title>moe_28_expert_0&#45;&gt;moe_28_aggregate</title>
<path fill="none" stroke="black" d="M295.18,-30618.32C298.15,-30617.89 301.09,-30617.49 304,-30617.12 582.37,-30582.03 1381.52,-30559.61 1779.73,-30550.29"/>
<polygon fill="black" stroke="black" points="1780.02,-30553.79 1789.93,-30550.06 1779.86,-30546.79 1780.02,-30553.79"/>
</g>
<!-- moe_28_expert_1&#45;&gt;moe_28_aggregate -->
<g id="edge946" class="edge">
<title>moe_28_expert_1&#45;&gt;moe_28_aggregate</title>
<path fill="none" stroke="black" d="M531.19,-30618.35C534.15,-30617.91 537.09,-30617.5 540,-30617.12 974.47,-30560.86 1486.32,-30547.76 1777.34,-30545.25"/>
<polygon fill="black" stroke="black" points="1777.63,-30548.75 1787.6,-30545.16 1777.57,-30541.75 1777.63,-30548.75"/>
</g>
<!-- moe_28_expert_2&#45;&gt;moe_28_aggregate -->
<g id="edge947" class="edge">
<title>moe_28_expert_2&#45;&gt;moe_28_aggregate</title>
<path fill="none" stroke="black" d="M767.19,-30618.38C770.15,-30617.93 773.09,-30617.51 776,-30617.12 1123.21,-30570.52 1529.34,-30554.17 1778.35,-30548.44"/>
<polygon fill="black" stroke="black" points="1778.7,-30551.93 1788.62,-30548.2 1778.54,-30544.93 1778.7,-30551.93"/>
</g>
<!-- moe_28_expert_3&#45;&gt;moe_28_aggregate -->
<g id="edge948" class="edge">
<title>moe_28_expert_3&#45;&gt;moe_28_aggregate</title>
<path fill="none" stroke="black" d="M1003.2,-30618.43C1006.16,-30617.97 1009.1,-30617.53 1012,-30617.12 1274.87,-30580.01 1579.51,-30561.64 1782.61,-30552.85"/>
<polygon fill="black" stroke="black" points="1782.96,-30556.34 1792.8,-30552.41 1782.66,-30549.35 1782.96,-30556.34"/>
</g>
<!-- moe_28_expert_4&#45;&gt;moe_28_aggregate -->
<g id="edge949" class="edge">
<title>moe_28_expert_4&#45;&gt;moe_28_aggregate</title>
<path fill="none" stroke="black" d="M1239.21,-30618.52C1242.17,-30618.03 1245.1,-30617.56 1248,-30617.12 1431.24,-30589.19 1641.01,-30570.4 1794.17,-30559.08"/>
<polygon fill="black" stroke="black" points="1794.45,-30562.57 1804.17,-30558.34 1793.94,-30555.59 1794.45,-30562.57"/>
</g>
<!-- moe_28_expert_5&#45;&gt;moe_28_aggregate -->
<g id="edge950" class="edge">
<title>moe_28_expert_5&#45;&gt;moe_28_aggregate</title>
<path fill="none" stroke="black" d="M1475.24,-30618.68C1478.19,-30618.14 1481.11,-30617.62 1484,-30617.12 1595.7,-30597.71 1721.49,-30580.41 1822.15,-30567.66"/>
<polygon fill="black" stroke="black" points="1822.64,-30571.12 1832.12,-30566.4 1821.76,-30564.18 1822.64,-30571.12"/>
</g>
<!-- moe_28_expert_6&#45;&gt;moe_28_aggregate -->
<g id="edge951" class="edge">
<title>moe_28_expert_6&#45;&gt;moe_28_aggregate</title>
<path fill="none" stroke="black" d="M1707.86,-30617.07C1759.21,-30604.92 1821.48,-30590.19 1876.19,-30577.25"/>
<polygon fill="black" stroke="black" points="1877.04,-30580.64 1885.96,-30574.93 1875.42,-30573.83 1877.04,-30580.64"/>
</g>
<!-- moe_28_expert_7&#45;&gt;moe_28_aggregate -->
<g id="edge952" class="edge">
<title>moe_28_expert_7&#45;&gt;moe_28_aggregate</title>
<path fill="none" stroke="black" d="M1883,-30616.95C1900.54,-30607.14 1921.06,-30595.66 1940.47,-30584.8"/>
<polygon fill="black" stroke="black" points="1942.27,-30587.8 1949.29,-30579.87 1938.86,-30581.69 1942.27,-30587.8"/>
</g>
<!-- moe_28_expert_8&#45;&gt;moe_28_aggregate -->
<g id="edge953" class="edge">
<title>moe_28_expert_8&#45;&gt;moe_28_aggregate</title>
<path fill="none" stroke="black" d="M2057.61,-30616.95C2052.14,-30608.54 2045.87,-30598.92 2039.74,-30589.5"/>
<polygon fill="black" stroke="black" points="2042.57,-30587.43 2034.18,-30580.96 2036.71,-30591.25 2042.57,-30587.43"/>
</g>
<!-- moe_28_expert_9&#45;&gt;moe_28_aggregate -->
<g id="edge954" class="edge">
<title>moe_28_expert_9&#45;&gt;moe_28_aggregate</title>
<path fill="none" stroke="black" d="M2232.61,-30617.07C2198.22,-30605.94 2157.14,-30592.65 2119.74,-30580.54"/>
<polygon fill="black" stroke="black" points="2120.4,-30577.08 2109.81,-30577.33 2118.25,-30583.74 2120.4,-30577.08"/>
</g>
<!-- moe_28_expert_10&#45;&gt;moe_28_aggregate -->
<g id="edge955" class="edge">
<title>moe_28_expert_10&#45;&gt;moe_28_aggregate</title>
<path fill="none" stroke="black" d="M2436.74,-30618.82C2433.8,-30618.24 2430.88,-30617.67 2428,-30617.12 2345.67,-30601.32 2253.87,-30585.34 2177.4,-30572.49"/>
<polygon fill="black" stroke="black" points="2177.64,-30568.98 2167.2,-30570.78 2176.48,-30575.88 2177.64,-30568.98"/>
</g>
<!-- moe_28_expert_11&#45;&gt;moe_28_aggregate -->
<g id="edge956" class="edge">
<title>moe_28_expert_11&#45;&gt;moe_28_aggregate</title>
<path fill="none" stroke="black" d="M2672.78,-30618.58C2669.83,-30618.07 2666.89,-30617.58 2664,-30617.12 2515.43,-30593.28 2346.55,-30574.95 2217.76,-30562.78"/>
<polygon fill="black" stroke="black" points="2218.06,-30559.29 2207.77,-30561.84 2217.4,-30566.26 2218.06,-30559.29"/>
</g>
<!-- moe_28_expert_12&#45;&gt;moe_28_aggregate -->
<g id="edge957" class="edge">
<title>moe_28_expert_12&#45;&gt;moe_28_aggregate</title>
<path fill="none" stroke="black" d="M2908.8,-30618.47C2905.84,-30617.99 2902.9,-30617.54 2900,-30617.12 2674.99,-30584.34 2415.6,-30565.55 2235.31,-30555.49"/>
<polygon fill="black" stroke="black" points="2235.35,-30551.99 2225.17,-30554.93 2234.96,-30558.97 2235.35,-30551.99"/>
</g>
<!-- moe_28_expert_13&#45;&gt;moe_28_aggregate -->
<g id="edge958" class="edge">
<title>moe_28_expert_13&#45;&gt;moe_28_aggregate</title>
<path fill="none" stroke="black" d="M3144.81,-30618.4C3141.84,-30617.95 3138.9,-30617.52 3136,-30617.12 2828.4,-30574.95 2470.01,-30557.48 2241.91,-30550.3"/>
<polygon fill="black" stroke="black" points="2241.93,-30546.8 2231.82,-30549.98 2241.71,-30553.79 2241.93,-30546.8"/>
</g>
<!-- moe_28_expert_14&#45;&gt;moe_28_aggregate -->
<g id="edge959" class="edge">
<title>moe_28_expert_14&#45;&gt;moe_28_aggregate</title>
<path fill="none" stroke="black" d="M3380.81,-30618.36C3377.85,-30617.92 3374.91,-30617.5 3372,-30617.12 2978.54,-30565.39 2516.46,-30550.64 2244.56,-30546.61"/>
<polygon fill="black" stroke="black" points="2244.21,-30543.11 2234.16,-30546.46 2244.11,-30550.11 2244.21,-30543.11"/>
</g>
<!-- moe_28_expert_15&#45;&gt;moe_28_aggregate -->
<g id="edge960" class="edge">
<title>moe_28_expert_15&#45;&gt;moe_28_aggregate</title>
<path fill="none" stroke="black" d="M3616.82,-30618.33C3613.85,-30617.9 3610.91,-30617.49 3608,-30617.12 3350.78,-30584.32 2618.21,-30561.16 2241.26,-30551.05"/>
<polygon fill="black" stroke="black" points="2241.13,-30547.55 2231.04,-30550.78 2240.95,-30554.54 2241.13,-30547.55"/>
</g>
<!-- moe_28_ffn -->
<g id="node586" class="node">
<title>moe_28_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2169,-30471.58 1853,-30471.58 1853,-30419.58 2169,-30419.58 2169,-30471.58"/>
<text text-anchor="middle" x="2011" y="-30459.58" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="2011" y="-30448.58" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-30437.58" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="2011" y="-30426.58" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_28_aggregate&#45;&gt;moe_28_ffn -->
<g id="edge961" class="edge">
<title>moe_28_aggregate&#45;&gt;moe_28_ffn</title>
<path fill="none" stroke="black" d="M2011,-30507.32C2011,-30499 2011,-30490.17 2011,-30481.89"/>
<polygon fill="black" stroke="black" points="2014.5,-30481.78 2011,-30471.78 2007.5,-30481.78 2014.5,-30481.78"/>
</g>
<!-- moe_28_res2 -->
<g id="node588" class="node">
<title>moe_28_res2</title>
<polygon fill="lightyellow" stroke="black" points="2347.89,-30383.58 1811.97,-30383.58 1674.11,-30279.58 2210.03,-30279.58 2347.89,-30383.58"/>
<text text-anchor="middle" x="2011" y="-30345.58" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="2011" y="-30334.58" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-30323.58" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="2011" y="-30312.58" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_28_ffn&#45;&gt;moe_28_res2 -->
<g id="edge962" class="edge">
<title>moe_28_ffn&#45;&gt;moe_28_res2</title>
<path fill="none" stroke="black" d="M2011,-30419.45C2011,-30411.76 2011,-30402.95 2011,-30393.95"/>
<polygon fill="black" stroke="black" points="2014.5,-30393.76 2011,-30383.76 2007.5,-30393.76 2014.5,-30393.76"/>
</g>
<!-- moe_28_res1&#45;&gt;moe_28_gate -->
<g id="edge927" class="edge">
<title>moe_28_res1&#45;&gt;moe_28_gate</title>
<path fill="none" stroke="black" d="M1956,-30954.27C1956,-30946.1 1956,-30937.58 1956,-30929.2"/>
<polygon fill="black" stroke="black" points="1959.5,-30929.09 1956,-30919.09 1952.5,-30929.09 1959.5,-30929.09"/>
</g>
<!-- moe_29_mha -->
<g id="node589" class="node">
<title>moe_29_mha</title>
<polygon fill="lightgreen" stroke="black" points="2169,-30232.58 1853,-30232.58 1853,-30180.58 2169,-30180.58 2169,-30232.58"/>
<text text-anchor="middle" x="2011" y="-30220.58" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="2011" y="-30209.58" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-30198.58" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="2011" y="-30187.58" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_28_res2&#45;&gt;moe_29_mha -->
<g id="edge963" class="edge">
<title>moe_28_res2&#45;&gt;moe_29_mha</title>
<path fill="none" stroke="black" d="M2011,-30279.49C2011,-30267.16 2011,-30254.25 2011,-30242.83"/>
<polygon fill="black" stroke="black" points="2014.5,-30242.82 2011,-30232.82 2007.5,-30242.82 2014.5,-30242.82"/>
</g>
<!-- moe_29_res1 -->
<g id="node610" class="node">
<title>moe_29_res1</title>
<polygon fill="lightyellow" stroke="black" points="2347.89,-30144.58 1811.97,-30144.58 1674.11,-30040.58 2210.03,-30040.58 2347.89,-30144.58"/>
<text text-anchor="middle" x="2011" y="-30106.58" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="2011" y="-30095.58" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-30084.58" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="2011" y="-30073.58" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_29_mha&#45;&gt;moe_29_res1 -->
<g id="edge964" class="edge">
<title>moe_29_mha&#45;&gt;moe_29_res1</title>
<path fill="none" stroke="black" d="M2011,-30180.45C2011,-30172.76 2011,-30163.95 2011,-30154.95"/>
<polygon fill="black" stroke="black" points="2014.5,-30154.76 2011,-30144.76 2007.5,-30154.76 2014.5,-30154.76"/>
</g>
<!-- moe_29_gate -->
<g id="node590" class="node">
<title>moe_29_gate</title>
<polygon fill="lightyellow" stroke="black" points="2339.8,-30004.58 1816.75,-30004.58 1682.2,-29900.58 2205.25,-29900.58 2339.8,-30004.58"/>
<text text-anchor="middle" x="2011" y="-29966.58" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="2011" y="-29955.58" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-29944.58" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="2011" y="-29933.58" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_29_route -->
<g id="node591" class="node">
<title>moe_29_route</title>
<ellipse fill="lightblue" stroke="black" cx="2011" cy="-29827.81" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="2011" y="-29841.81" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="2011" y="-29830.81" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2011" y="-29819.81" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="2011" y="-29808.81" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_29_gate&#45;&gt;moe_29_route -->
<g id="edge966" class="edge">
<title>moe_29_gate&#45;&gt;moe_29_route</title>
<path fill="none" stroke="black" d="M2011,-29900.23C2011,-29891.82 2011,-29883.15 2011,-29874.88"/>
<polygon fill="black" stroke="black" points="2014.5,-29874.67 2011,-29864.67 2007.5,-29874.67 2014.5,-29874.67"/>
</g>
<!-- moe_29_expert_0 -->
<g id="node592" class="node">
<title>moe_29_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="350,-29755.04 132,-29755.04 132,-29703.04 350,-29703.04 350,-29755.04"/>
<text text-anchor="middle" x="241" y="-29743.04" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="241" y="-29732.04" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="241" y="-29721.04" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="241" y="-29710.04" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_29_route&#45;&gt;moe_29_expert_0 -->
<g id="edge967" class="edge">
<title>moe_29_route&#45;&gt;moe_29_expert_0</title>
<path fill="none" stroke="black" d="M1795.93,-29821.89C1418.11,-29812.52 648.75,-29789.99 360.24,-29755.08"/>
<polygon fill="black" stroke="black" points="360.54,-29751.59 350.18,-29753.84 359.68,-29758.54 360.54,-29751.59"/>
</g>
<!-- moe_29_expert_1 -->
<g id="node593" class="node">
<title>moe_29_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="586,-29755.04 368,-29755.04 368,-29703.04 586,-29703.04 586,-29755.04"/>
<text text-anchor="middle" x="477" y="-29743.04" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="477" y="-29732.04" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="477" y="-29721.04" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="477" y="-29710.04" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_29_route&#45;&gt;moe_29_expert_1 -->
<g id="edge968" class="edge">
<title>moe_29_route&#45;&gt;moe_29_expert_1</title>
<path fill="none" stroke="black" d="M1793.23,-29826.43C1516.57,-29823.53 1024.56,-29810.27 596.29,-29755.12"/>
<polygon fill="black" stroke="black" points="596.55,-29751.62 586.19,-29753.81 595.65,-29758.57 596.55,-29751.62"/>
</g>
<!-- moe_29_expert_2 -->
<g id="node594" class="node">
<title>moe_29_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="822,-29755.04 604,-29755.04 604,-29703.04 822,-29703.04 822,-29755.04"/>
<text text-anchor="middle" x="713" y="-29743.04" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="713" y="-29732.04" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="713" y="-29721.04" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="713" y="-29710.04" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_29_route&#45;&gt;moe_29_expert_2 -->
<g id="edge969" class="edge">
<title>moe_29_route&#45;&gt;moe_29_expert_2</title>
<path fill="none" stroke="black" d="M1794.74,-29823.24C1559.7,-29817.16 1173.2,-29800.73 832.26,-29755.13"/>
<polygon fill="black" stroke="black" points="832.57,-29751.64 822.19,-29753.77 831.63,-29758.57 832.57,-29751.64"/>
</g>
<!-- moe_29_expert_3 -->
<g id="node595" class="node">
<title>moe_29_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1058,-29755.04 840,-29755.04 840,-29703.04 1058,-29703.04 1058,-29755.04"/>
<text text-anchor="middle" x="949" y="-29743.04" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="949" y="-29732.04" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="949" y="-29721.04" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="949" y="-29710.04" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_29_route&#45;&gt;moe_29_expert_3 -->
<g id="edge970" class="edge">
<title>moe_29_route&#45;&gt;moe_29_expert_3</title>
<path fill="none" stroke="black" d="M1799.7,-29818.79C1610.33,-29809.72 1325,-29791.41 1068.47,-29755.17"/>
<polygon fill="black" stroke="black" points="1068.59,-29751.66 1058.2,-29753.71 1067.61,-29758.59 1068.59,-29751.66"/>
</g>
<!-- moe_29_expert_4 -->
<g id="node596" class="node">
<title>moe_29_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1294,-29755.04 1076,-29755.04 1076,-29703.04 1294,-29703.04 1294,-29755.04"/>
<text text-anchor="middle" x="1185" y="-29743.04" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1185" y="-29732.04" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1185" y="-29721.04" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1185" y="-29710.04" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_29_route&#45;&gt;moe_29_expert_4 -->
<g id="edge971" class="edge">
<title>moe_29_route&#45;&gt;moe_29_expert_4</title>
<path fill="none" stroke="black" d="M1812.66,-29812.46C1672.96,-29800.97 1481.46,-29782.48 1304.25,-29755.17"/>
<polygon fill="black" stroke="black" points="1304.63,-29751.69 1294.21,-29753.61 1303.56,-29758.61 1304.63,-29751.69"/>
</g>
<!-- moe_29_expert_5 -->
<g id="node597" class="node">
<title>moe_29_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1530,-29755.04 1312,-29755.04 1312,-29703.04 1530,-29703.04 1530,-29755.04"/>
<text text-anchor="middle" x="1421" y="-29743.04" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1421" y="-29732.04" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1421" y="-29721.04" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1421" y="-29710.04" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_29_route&#45;&gt;moe_29_expert_5 -->
<g id="edge972" class="edge">
<title>moe_29_route&#45;&gt;moe_29_expert_5</title>
<path fill="none" stroke="black" d="M1844.87,-29803.95C1756.99,-29791.27 1647.11,-29774.5 1540.25,-29755.23"/>
<polygon fill="black" stroke="black" points="1540.71,-29751.76 1530.25,-29753.42 1539.46,-29758.65 1540.71,-29751.76"/>
</g>
<!-- moe_29_expert_6 -->
<g id="node598" class="node">
<title>moe_29_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1766,-29755.04 1548,-29755.04 1548,-29703.04 1766,-29703.04 1766,-29755.04"/>
<text text-anchor="middle" x="1657" y="-29743.04" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1657" y="-29732.04" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1657" y="-29721.04" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1657" y="-29710.04" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_29_route&#45;&gt;moe_29_expert_6 -->
<g id="edge973" class="edge">
<title>moe_29_route&#45;&gt;moe_29_expert_6</title>
<path fill="none" stroke="black" d="M1898.99,-29796.19C1853.98,-29783.89 1802.47,-29769.81 1758.56,-29757.81"/>
<polygon fill="black" stroke="black" points="1759.31,-29754.38 1748.74,-29755.12 1757.46,-29761.13 1759.31,-29754.38"/>
</g>
<!-- moe_29_expert_7 -->
<g id="node599" class="node">
<title>moe_29_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="2002,-29755.04 1784,-29755.04 1784,-29703.04 2002,-29703.04 2002,-29755.04"/>
<text text-anchor="middle" x="1893" y="-29743.04" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1893" y="-29732.04" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1893" y="-29721.04" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1893" y="-29710.04" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_29_route&#45;&gt;moe_29_expert_7 -->
<g id="edge974" class="edge">
<title>moe_29_route&#45;&gt;moe_29_expert_7</title>
<path fill="none" stroke="black" d="M1968.07,-29791.6C1956.07,-29781.77 1943.12,-29771.14 1931.41,-29761.54"/>
<polygon fill="black" stroke="black" points="1933.47,-29758.71 1923.52,-29755.07 1929.04,-29764.12 1933.47,-29758.71"/>
</g>
<!-- moe_29_expert_8 -->
<g id="node600" class="node">
<title>moe_29_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2238,-29755.04 2020,-29755.04 2020,-29703.04 2238,-29703.04 2238,-29755.04"/>
<text text-anchor="middle" x="2129" y="-29743.04" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2129" y="-29732.04" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2129" y="-29721.04" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2129" y="-29710.04" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_29_route&#45;&gt;moe_29_expert_8 -->
<g id="edge975" class="edge">
<title>moe_29_route&#45;&gt;moe_29_expert_8</title>
<path fill="none" stroke="black" d="M2053.93,-29791.6C2065.93,-29781.77 2078.88,-29771.14 2090.59,-29761.54"/>
<polygon fill="black" stroke="black" points="2092.96,-29764.12 2098.48,-29755.07 2088.53,-29758.71 2092.96,-29764.12"/>
</g>
<!-- moe_29_expert_9 -->
<g id="node601" class="node">
<title>moe_29_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2474,-29755.04 2256,-29755.04 2256,-29703.04 2474,-29703.04 2474,-29755.04"/>
<text text-anchor="middle" x="2365" y="-29743.04" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2365" y="-29732.04" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2365" y="-29721.04" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2365" y="-29710.04" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_29_route&#45;&gt;moe_29_expert_9 -->
<g id="edge976" class="edge">
<title>moe_29_route&#45;&gt;moe_29_expert_9</title>
<path fill="none" stroke="black" d="M2123.01,-29796.19C2168.02,-29783.89 2219.53,-29769.81 2263.44,-29757.81"/>
<polygon fill="black" stroke="black" points="2264.54,-29761.13 2273.26,-29755.12 2262.69,-29754.38 2264.54,-29761.13"/>
</g>
<!-- moe_29_expert_10 -->
<g id="node602" class="node">
<title>moe_29_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2710,-29755.04 2492,-29755.04 2492,-29703.04 2710,-29703.04 2710,-29755.04"/>
<text text-anchor="middle" x="2601" y="-29743.04" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2601" y="-29732.04" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2601" y="-29721.04" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2601" y="-29710.04" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_29_route&#45;&gt;moe_29_expert_10 -->
<g id="edge977" class="edge">
<title>moe_29_route&#45;&gt;moe_29_expert_10</title>
<path fill="none" stroke="black" d="M2177.13,-29803.95C2265.01,-29791.27 2374.89,-29774.5 2481.75,-29755.23"/>
<polygon fill="black" stroke="black" points="2482.54,-29758.65 2491.75,-29753.42 2481.29,-29751.76 2482.54,-29758.65"/>
</g>
<!-- moe_29_expert_11 -->
<g id="node603" class="node">
<title>moe_29_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2946,-29755.04 2728,-29755.04 2728,-29703.04 2946,-29703.04 2946,-29755.04"/>
<text text-anchor="middle" x="2837" y="-29743.04" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2837" y="-29732.04" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2837" y="-29721.04" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2837" y="-29710.04" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_29_route&#45;&gt;moe_29_expert_11 -->
<g id="edge978" class="edge">
<title>moe_29_route&#45;&gt;moe_29_expert_11</title>
<path fill="none" stroke="black" d="M2209.34,-29812.46C2349.04,-29800.97 2540.54,-29782.48 2717.75,-29755.17"/>
<polygon fill="black" stroke="black" points="2718.44,-29758.61 2727.79,-29753.61 2717.37,-29751.69 2718.44,-29758.61"/>
</g>
<!-- moe_29_expert_12 -->
<g id="node604" class="node">
<title>moe_29_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3182,-29755.04 2964,-29755.04 2964,-29703.04 3182,-29703.04 3182,-29755.04"/>
<text text-anchor="middle" x="3073" y="-29743.04" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3073" y="-29732.04" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3073" y="-29721.04" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3073" y="-29710.04" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_29_route&#45;&gt;moe_29_expert_12 -->
<g id="edge979" class="edge">
<title>moe_29_route&#45;&gt;moe_29_expert_12</title>
<path fill="none" stroke="black" d="M2222.3,-29818.79C2411.67,-29809.72 2697,-29791.41 2953.53,-29755.17"/>
<polygon fill="black" stroke="black" points="2954.39,-29758.59 2963.8,-29753.71 2953.41,-29751.66 2954.39,-29758.59"/>
</g>
<!-- moe_29_expert_13 -->
<g id="node605" class="node">
<title>moe_29_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3418,-29755.04 3200,-29755.04 3200,-29703.04 3418,-29703.04 3418,-29755.04"/>
<text text-anchor="middle" x="3309" y="-29743.04" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3309" y="-29732.04" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3309" y="-29721.04" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3309" y="-29710.04" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_29_route&#45;&gt;moe_29_expert_13 -->
<g id="edge980" class="edge">
<title>moe_29_route&#45;&gt;moe_29_expert_13</title>
<path fill="none" stroke="black" d="M2227.26,-29823.24C2462.3,-29817.16 2848.8,-29800.73 3189.74,-29755.13"/>
<polygon fill="black" stroke="black" points="3190.37,-29758.57 3199.81,-29753.77 3189.43,-29751.64 3190.37,-29758.57"/>
</g>
<!-- moe_29_expert_14 -->
<g id="node606" class="node">
<title>moe_29_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3654,-29755.04 3436,-29755.04 3436,-29703.04 3654,-29703.04 3654,-29755.04"/>
<text text-anchor="middle" x="3545" y="-29743.04" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3545" y="-29732.04" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3545" y="-29721.04" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3545" y="-29710.04" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_29_route&#45;&gt;moe_29_expert_14 -->
<g id="edge981" class="edge">
<title>moe_29_route&#45;&gt;moe_29_expert_14</title>
<path fill="none" stroke="black" d="M2228.77,-29826.43C2505.43,-29823.53 2997.44,-29810.27 3425.71,-29755.12"/>
<polygon fill="black" stroke="black" points="3426.35,-29758.57 3435.81,-29753.81 3425.45,-29751.62 3426.35,-29758.57"/>
</g>
<!-- moe_29_expert_15 -->
<g id="node607" class="node">
<title>moe_29_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3890,-29755.04 3672,-29755.04 3672,-29703.04 3890,-29703.04 3890,-29755.04"/>
<text text-anchor="middle" x="3781" y="-29743.04" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3781" y="-29732.04" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3781" y="-29721.04" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3781" y="-29710.04" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_29_route&#45;&gt;moe_29_expert_15 -->
<g id="edge982" class="edge">
<title>moe_29_route&#45;&gt;moe_29_expert_15</title>
<path fill="none" stroke="black" d="M2226.07,-29821.89C2603.89,-29812.52 3373.25,-29789.99 3661.76,-29755.08"/>
<polygon fill="black" stroke="black" points="3662.32,-29758.54 3671.82,-29753.84 3661.46,-29751.59 3662.32,-29758.54"/>
</g>
<!-- moe_29_aggregate -->
<g id="node608" class="node">
<title>moe_29_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="2011" cy="-29630.27" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="2011" y="-29644.27" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="2011" y="-29633.27" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2011" y="-29622.27" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="2011" y="-29611.27" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_29_expert_0&#45;&gt;moe_29_aggregate -->
<g id="edge983" class="edge">
<title>moe_29_expert_0&#45;&gt;moe_29_aggregate</title>
<path fill="none" stroke="black" d="M350.18,-29704.25C353.15,-29703.81 356.09,-29703.41 359,-29703.04 626.74,-29669.1 1392.32,-29646.3 1780.04,-29636.59"/>
<polygon fill="black" stroke="black" points="1780.35,-29640.08 1790.26,-29636.33 1780.17,-29633.08 1780.35,-29640.08"/>
</g>
<!-- moe_29_expert_1&#45;&gt;moe_29_aggregate -->
<g id="edge984" class="edge">
<title>moe_29_expert_1&#45;&gt;moe_29_aggregate</title>
<path fill="none" stroke="black" d="M586.19,-29704.27C589.15,-29703.83 592.09,-29703.42 595,-29703.04 1008.79,-29649.07 1495.51,-29635.1 1777.11,-29631.83"/>
<polygon fill="black" stroke="black" points="1777.49,-29635.33 1787.45,-29631.71 1777.41,-29628.33 1777.49,-29635.33"/>
</g>
<!-- moe_29_expert_2&#45;&gt;moe_29_aggregate -->
<g id="edge985" class="edge">
<title>moe_29_expert_2&#45;&gt;moe_29_aggregate</title>
<path fill="none" stroke="black" d="M822.19,-29704.31C825.15,-29703.86 828.09,-29703.44 831,-29703.04 1158.31,-29658.66 1540.45,-29641.72 1779.11,-29635.25"/>
<polygon fill="black" stroke="black" points="1779.4,-29638.75 1789.31,-29634.98 1779.22,-29631.75 1779.4,-29638.75"/>
</g>
<!-- moe_29_expert_3&#45;&gt;moe_29_aggregate -->
<g id="edge986" class="edge">
<title>moe_29_expert_3&#45;&gt;moe_29_aggregate</title>
<path fill="none" stroke="black" d="M1058.2,-29704.37C1061.16,-29703.9 1064.1,-29703.46 1067,-29703.04 1310.76,-29668.11 1592.52,-29649.49 1784.32,-29640.04"/>
<polygon fill="black" stroke="black" points="1784.71,-29643.53 1794.53,-29639.55 1784.37,-29636.54 1784.71,-29643.53"/>
</g>
<!-- moe_29_expert_4&#45;&gt;moe_29_aggregate -->
<g id="edge987" class="edge">
<title>moe_29_expert_4&#45;&gt;moe_29_aggregate</title>
<path fill="none" stroke="black" d="M1294.21,-29704.47C1297.17,-29703.97 1300.1,-29703.49 1303,-29703.04 1468.7,-29677.17 1657.73,-29658.55 1798.77,-29646.78"/>
<polygon fill="black" stroke="black" points="1799.17,-29650.26 1808.84,-29645.94 1798.59,-29643.28 1799.17,-29650.26"/>
</g>
<!-- moe_29_expert_5&#45;&gt;moe_29_aggregate -->
<g id="edge988" class="edge">
<title>moe_29_expert_5&#45;&gt;moe_29_aggregate</title>
<path fill="none" stroke="black" d="M1530.25,-29704.66C1533.19,-29704.11 1536.12,-29703.57 1539,-29703.04 1635.58,-29685.48 1743.83,-29668.81 1832.27,-29655.96"/>
<polygon fill="black" stroke="black" points="1833.01,-29659.39 1842.4,-29654.49 1832,-29652.46 1833.01,-29659.39"/>
</g>
<!-- moe_29_expert_6&#45;&gt;moe_29_aggregate -->
<g id="edge989" class="edge">
<title>moe_29_expert_6&#45;&gt;moe_29_aggregate</title>
<path fill="none" stroke="black" d="M1748.62,-29703C1791.27,-29691.34 1842.62,-29677.3 1888.54,-29664.75"/>
<polygon fill="black" stroke="black" points="1889.53,-29668.11 1898.25,-29662.09 1887.68,-29661.35 1889.53,-29668.11"/>
</g>
<!-- moe_29_expert_7&#45;&gt;moe_29_aggregate -->
<g id="edge990" class="edge">
<title>moe_29_expert_7&#45;&gt;moe_29_aggregate</title>
<path fill="none" stroke="black" d="M1923.7,-29702.87C1934.79,-29693.77 1947.63,-29683.24 1959.99,-29673.1"/>
<polygon fill="black" stroke="black" points="1962.51,-29675.56 1968.02,-29666.52 1958.07,-29670.15 1962.51,-29675.56"/>
</g>
<!-- moe_29_expert_8&#45;&gt;moe_29_aggregate -->
<g id="edge991" class="edge">
<title>moe_29_expert_8&#45;&gt;moe_29_aggregate</title>
<path fill="none" stroke="black" d="M2098.3,-29702.87C2087.21,-29693.77 2074.37,-29683.24 2062.01,-29673.1"/>
<polygon fill="black" stroke="black" points="2063.93,-29670.15 2053.98,-29666.52 2059.49,-29675.56 2063.93,-29670.15"/>
</g>
<!-- moe_29_expert_9&#45;&gt;moe_29_aggregate -->
<g id="edge992" class="edge">
<title>moe_29_expert_9&#45;&gt;moe_29_aggregate</title>
<path fill="none" stroke="black" d="M2273.38,-29703C2230.73,-29691.34 2179.38,-29677.3 2133.46,-29664.75"/>
<polygon fill="black" stroke="black" points="2134.32,-29661.35 2123.75,-29662.09 2132.47,-29668.11 2134.32,-29661.35"/>
</g>
<!-- moe_29_expert_10&#45;&gt;moe_29_aggregate -->
<g id="edge993" class="edge">
<title>moe_29_expert_10&#45;&gt;moe_29_aggregate</title>
<path fill="none" stroke="black" d="M2491.75,-29704.66C2488.81,-29704.11 2485.88,-29703.57 2483,-29703.04 2386.42,-29685.48 2278.17,-29668.81 2189.73,-29655.96"/>
<polygon fill="black" stroke="black" points="2190,-29652.46 2179.6,-29654.49 2188.99,-29659.39 2190,-29652.46"/>
</g>
<!-- moe_29_expert_11&#45;&gt;moe_29_aggregate -->
<g id="edge994" class="edge">
<title>moe_29_expert_11&#45;&gt;moe_29_aggregate</title>
<path fill="none" stroke="black" d="M2727.79,-29704.47C2724.83,-29703.97 2721.9,-29703.49 2719,-29703.04 2553.3,-29677.17 2364.27,-29658.55 2223.23,-29646.78"/>
<polygon fill="black" stroke="black" points="2223.41,-29643.28 2213.16,-29645.94 2222.83,-29650.26 2223.41,-29643.28"/>
</g>
<!-- moe_29_expert_12&#45;&gt;moe_29_aggregate -->
<g id="edge995" class="edge">
<title>moe_29_expert_12&#45;&gt;moe_29_aggregate</title>
<path fill="none" stroke="black" d="M2963.8,-29704.37C2960.84,-29703.9 2957.9,-29703.46 2955,-29703.04 2711.24,-29668.11 2429.48,-29649.49 2237.68,-29640.04"/>
<polygon fill="black" stroke="black" points="2237.63,-29636.54 2227.47,-29639.55 2237.29,-29643.53 2237.63,-29636.54"/>
</g>
<!-- moe_29_expert_13&#45;&gt;moe_29_aggregate -->
<g id="edge996" class="edge">
<title>moe_29_expert_13&#45;&gt;moe_29_aggregate</title>
<path fill="none" stroke="black" d="M3199.81,-29704.31C3196.85,-29703.86 3193.91,-29703.44 3191,-29703.04 2863.69,-29658.66 2481.55,-29641.72 2242.89,-29635.25"/>
<polygon fill="black" stroke="black" points="2242.78,-29631.75 2232.69,-29634.98 2242.6,-29638.75 2242.78,-29631.75"/>
</g>
<!-- moe_29_expert_14&#45;&gt;moe_29_aggregate -->
<g id="edge997" class="edge">
<title>moe_29_expert_14&#45;&gt;moe_29_aggregate</title>
<path fill="none" stroke="black" d="M3435.81,-29704.27C3432.85,-29703.83 3429.91,-29703.42 3427,-29703.04 3013.21,-29649.07 2526.49,-29635.1 2244.89,-29631.83"/>
<polygon fill="black" stroke="black" points="2244.59,-29628.33 2234.55,-29631.71 2244.51,-29635.33 2244.59,-29628.33"/>
</g>
<!-- moe_29_expert_15&#45;&gt;moe_29_aggregate -->
<g id="edge998" class="edge">
<title>moe_29_expert_15&#45;&gt;moe_29_aggregate</title>
<path fill="none" stroke="black" d="M3671.82,-29704.25C3668.85,-29703.81 3665.91,-29703.41 3663,-29703.04 3395.26,-29669.1 2629.68,-29646.3 2241.96,-29636.59"/>
<polygon fill="black" stroke="black" points="2241.83,-29633.08 2231.74,-29636.33 2241.65,-29640.08 2241.83,-29633.08"/>
</g>
<!-- moe_29_ffn -->
<g id="node609" class="node">
<title>moe_29_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2169,-29557.5 1853,-29557.5 1853,-29505.5 2169,-29505.5 2169,-29557.5"/>
<text text-anchor="middle" x="2011" y="-29545.5" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="2011" y="-29534.5" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-29523.5" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="2011" y="-29512.5" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_29_aggregate&#45;&gt;moe_29_ffn -->
<g id="edge999" class="edge">
<title>moe_29_aggregate&#45;&gt;moe_29_ffn</title>
<path fill="none" stroke="black" d="M2011,-29593.24C2011,-29584.93 2011,-29576.09 2011,-29567.81"/>
<polygon fill="black" stroke="black" points="2014.5,-29567.7 2011,-29557.7 2007.5,-29567.7 2014.5,-29567.7"/>
</g>
<!-- moe_29_res2 -->
<g id="node611" class="node">
<title>moe_29_res2</title>
<polygon fill="lightyellow" stroke="black" points="2347.89,-29469.5 1811.97,-29469.5 1674.11,-29365.5 2210.03,-29365.5 2347.89,-29469.5"/>
<text text-anchor="middle" x="2011" y="-29431.5" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="2011" y="-29420.5" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-29409.5" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="2011" y="-29398.5" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_29_ffn&#45;&gt;moe_29_res2 -->
<g id="edge1000" class="edge">
<title>moe_29_ffn&#45;&gt;moe_29_res2</title>
<path fill="none" stroke="black" d="M2011,-29505.37C2011,-29497.68 2011,-29488.87 2011,-29479.87"/>
<polygon fill="black" stroke="black" points="2014.5,-29479.68 2011,-29469.68 2007.5,-29479.68 2014.5,-29479.68"/>
</g>
<!-- moe_29_res1&#45;&gt;moe_29_gate -->
<g id="edge965" class="edge">
<title>moe_29_res1&#45;&gt;moe_29_gate</title>
<path fill="none" stroke="black" d="M2011,-30040.19C2011,-30032.02 2011,-30023.5 2011,-30015.12"/>
<polygon fill="black" stroke="black" points="2014.5,-30015.01 2011,-30005.01 2007.5,-30015.01 2014.5,-30015.01"/>
</g>
<!-- moe_30_mha -->
<g id="node612" class="node">
<title>moe_30_mha</title>
<polygon fill="lightgreen" stroke="black" points="2169,-29318.5 1853,-29318.5 1853,-29266.5 2169,-29266.5 2169,-29318.5"/>
<text text-anchor="middle" x="2011" y="-29306.5" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="2011" y="-29295.5" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-29284.5" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="2011" y="-29273.5" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_29_res2&#45;&gt;moe_30_mha -->
<g id="edge1001" class="edge">
<title>moe_29_res2&#45;&gt;moe_30_mha</title>
<path fill="none" stroke="black" d="M2011,-29365.41C2011,-29353.08 2011,-29340.17 2011,-29328.75"/>
<polygon fill="black" stroke="black" points="2014.5,-29328.74 2011,-29318.74 2007.5,-29328.74 2014.5,-29328.74"/>
</g>
<!-- moe_30_res1 -->
<g id="node633" class="node">
<title>moe_30_res1</title>
<polygon fill="lightyellow" stroke="black" points="2347.89,-29230.5 1811.97,-29230.5 1674.11,-29126.5 2210.03,-29126.5 2347.89,-29230.5"/>
<text text-anchor="middle" x="2011" y="-29192.5" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="2011" y="-29181.5" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-29170.5" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="2011" y="-29159.5" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_30_mha&#45;&gt;moe_30_res1 -->
<g id="edge1002" class="edge">
<title>moe_30_mha&#45;&gt;moe_30_res1</title>
<path fill="none" stroke="black" d="M2011,-29266.37C2011,-29258.68 2011,-29249.87 2011,-29240.87"/>
<polygon fill="black" stroke="black" points="2014.5,-29240.68 2011,-29230.68 2007.5,-29240.68 2014.5,-29240.68"/>
</g>
<!-- moe_30_gate -->
<g id="node613" class="node">
<title>moe_30_gate</title>
<polygon fill="lightyellow" stroke="black" points="2339.8,-29090.5 1816.75,-29090.5 1682.2,-28986.5 2205.25,-28986.5 2339.8,-29090.5"/>
<text text-anchor="middle" x="2011" y="-29052.5" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="2011" y="-29041.5" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="2011" y="-29030.5" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="2011" y="-29019.5" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_30_route -->
<g id="node614" class="node">
<title>moe_30_route</title>
<ellipse fill="lightblue" stroke="black" cx="2011" cy="-28913.73" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="2011" y="-28927.73" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="2011" y="-28916.73" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2011" y="-28905.73" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="2011" y="-28894.73" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_30_gate&#45;&gt;moe_30_route -->
<g id="edge1004" class="edge">
<title>moe_30_gate&#45;&gt;moe_30_route</title>
<path fill="none" stroke="black" d="M2011,-28986.15C2011,-28977.74 2011,-28969.07 2011,-28960.8"/>
<polygon fill="black" stroke="black" points="2014.5,-28960.59 2011,-28950.59 2007.5,-28960.59 2014.5,-28960.59"/>
</g>
<!-- moe_30_expert_0 -->
<g id="node615" class="node">
<title>moe_30_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="350,-28840.96 132,-28840.96 132,-28788.96 350,-28788.96 350,-28840.96"/>
<text text-anchor="middle" x="241" y="-28828.96" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="241" y="-28817.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="241" y="-28806.96" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="241" y="-28795.96" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_30_route&#45;&gt;moe_30_expert_0 -->
<g id="edge1005" class="edge">
<title>moe_30_route&#45;&gt;moe_30_expert_0</title>
<path fill="none" stroke="black" d="M1795.93,-28907.81C1418.11,-28898.44 648.75,-28875.91 360.24,-28841.01"/>
<polygon fill="black" stroke="black" points="360.54,-28837.52 350.18,-28839.76 359.68,-28844.46 360.54,-28837.52"/>
</g>
<!-- moe_30_expert_1 -->
<g id="node616" class="node">
<title>moe_30_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="586,-28840.96 368,-28840.96 368,-28788.96 586,-28788.96 586,-28840.96"/>
<text text-anchor="middle" x="477" y="-28828.96" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="477" y="-28817.96" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="477" y="-28806.96" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="477" y="-28795.96" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_30_route&#45;&gt;moe_30_expert_1 -->
<g id="edge1006" class="edge">
<title>moe_30_route&#45;&gt;moe_30_expert_1</title>
<path fill="none" stroke="black" d="M1793.23,-28912.35C1516.57,-28909.45 1024.56,-28896.19 596.29,-28841.04"/>
<polygon fill="black" stroke="black" points="596.55,-28837.55 586.19,-28839.73 595.65,-28844.49 596.55,-28837.55"/>
</g>
<!-- moe_30_expert_2 -->
<g id="node617" class="node">
<title>moe_30_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="822,-28840.96 604,-28840.96 604,-28788.96 822,-28788.96 822,-28840.96"/>
<text text-anchor="middle" x="713" y="-28828.96" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="713" y="-28817.96" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="713" y="-28806.96" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="713" y="-28795.96" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_30_route&#45;&gt;moe_30_expert_2 -->
<g id="edge1007" class="edge">
<title>moe_30_route&#45;&gt;moe_30_expert_2</title>
<path fill="none" stroke="black" d="M1794.74,-28909.17C1559.7,-28903.08 1173.2,-28886.65 832.26,-28841.05"/>
<polygon fill="black" stroke="black" points="832.57,-28837.56 822.19,-28839.69 831.63,-28844.5 832.57,-28837.56"/>
</g>
<!-- moe_30_expert_3 -->
<g id="node618" class="node">
<title>moe_30_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1058,-28840.96 840,-28840.96 840,-28788.96 1058,-28788.96 1058,-28840.96"/>
<text text-anchor="middle" x="949" y="-28828.96" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="949" y="-28817.96" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="949" y="-28806.96" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="949" y="-28795.96" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_30_route&#45;&gt;moe_30_expert_3 -->
<g id="edge1008" class="edge">
<title>moe_30_route&#45;&gt;moe_30_expert_3</title>
<path fill="none" stroke="black" d="M1799.7,-28904.71C1610.33,-28895.64 1325,-28877.33 1068.47,-28841.09"/>
<polygon fill="black" stroke="black" points="1068.59,-28837.58 1058.2,-28839.63 1067.61,-28844.51 1068.59,-28837.58"/>
</g>
<!-- moe_30_expert_4 -->
<g id="node619" class="node">
<title>moe_30_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1294,-28840.96 1076,-28840.96 1076,-28788.96 1294,-28788.96 1294,-28840.96"/>
<text text-anchor="middle" x="1185" y="-28828.96" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1185" y="-28817.96" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1185" y="-28806.96" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1185" y="-28795.96" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_30_route&#45;&gt;moe_30_expert_4 -->
<g id="edge1009" class="edge">
<title>moe_30_route&#45;&gt;moe_30_expert_4</title>
<path fill="none" stroke="black" d="M1812.66,-28898.38C1672.96,-28886.9 1481.46,-28868.4 1304.25,-28841.09"/>
<polygon fill="black" stroke="black" points="1304.63,-28837.61 1294.21,-28839.53 1303.56,-28844.53 1304.63,-28837.61"/>
</g>
<!-- moe_30_expert_5 -->
<g id="node620" class="node">
<title>moe_30_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1530,-28840.96 1312,-28840.96 1312,-28788.96 1530,-28788.96 1530,-28840.96"/>
<text text-anchor="middle" x="1421" y="-28828.96" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1421" y="-28817.96" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1421" y="-28806.96" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1421" y="-28795.96" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_30_route&#45;&gt;moe_30_expert_5 -->
<g id="edge1010" class="edge">
<title>moe_30_route&#45;&gt;moe_30_expert_5</title>
<path fill="none" stroke="black" d="M1844.87,-28889.87C1756.99,-28877.19 1647.11,-28860.42 1540.25,-28841.15"/>
<polygon fill="black" stroke="black" points="1540.71,-28837.68 1530.25,-28839.34 1539.46,-28844.57 1540.71,-28837.68"/>
</g>
<!-- moe_30_expert_6 -->
<g id="node621" class="node">
<title>moe_30_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1766,-28840.96 1548,-28840.96 1548,-28788.96 1766,-28788.96 1766,-28840.96"/>
<text text-anchor="middle" x="1657" y="-28828.96" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1657" y="-28817.96" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1657" y="-28806.96" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1657" y="-28795.96" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_30_route&#45;&gt;moe_30_expert_6 -->
<g id="edge1011" class="edge">
<title>moe_30_route&#45;&gt;moe_30_expert_6</title>
<path fill="none" stroke="black" d="M1898.99,-28882.11C1853.98,-28869.81 1802.47,-28855.73 1758.56,-28843.73"/>
<polygon fill="black" stroke="black" points="1759.31,-28840.3 1748.74,-28841.04 1757.46,-28847.05 1759.31,-28840.3"/>
</g>
<!-- moe_30_expert_7 -->
<g id="node622" class="node">
<title>moe_30_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="2002,-28840.96 1784,-28840.96 1784,-28788.96 2002,-28788.96 2002,-28840.96"/>
<text text-anchor="middle" x="1893" y="-28828.96" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1893" y="-28817.96" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1893" y="-28806.96" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1893" y="-28795.96" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_30_route&#45;&gt;moe_30_expert_7 -->
<g id="edge1012" class="edge">
<title>moe_30_route&#45;&gt;moe_30_expert_7</title>
<path fill="none" stroke="black" d="M1968.07,-28877.52C1956.07,-28867.69 1943.12,-28857.07 1931.41,-28847.46"/>
<polygon fill="black" stroke="black" points="1933.47,-28844.63 1923.52,-28840.99 1929.04,-28850.04 1933.47,-28844.63"/>
</g>
<!-- moe_30_expert_8 -->
<g id="node623" class="node">
<title>moe_30_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2238,-28840.96 2020,-28840.96 2020,-28788.96 2238,-28788.96 2238,-28840.96"/>
<text text-anchor="middle" x="2129" y="-28828.96" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2129" y="-28817.96" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2129" y="-28806.96" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2129" y="-28795.96" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_30_route&#45;&gt;moe_30_expert_8 -->
<g id="edge1013" class="edge">
<title>moe_30_route&#45;&gt;moe_30_expert_8</title>
<path fill="none" stroke="black" d="M2053.93,-28877.52C2065.93,-28867.69 2078.88,-28857.07 2090.59,-28847.46"/>
<polygon fill="black" stroke="black" points="2092.96,-28850.04 2098.48,-28840.99 2088.53,-28844.63 2092.96,-28850.04"/>
</g>
<!-- moe_30_expert_9 -->
<g id="node624" class="node">
<title>moe_30_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2474,-28840.96 2256,-28840.96 2256,-28788.96 2474,-28788.96 2474,-28840.96"/>
<text text-anchor="middle" x="2365" y="-28828.96" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2365" y="-28817.96" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2365" y="-28806.96" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2365" y="-28795.96" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_30_route&#45;&gt;moe_30_expert_9 -->
<g id="edge1014" class="edge">
<title>moe_30_route&#45;&gt;moe_30_expert_9</title>
<path fill="none" stroke="black" d="M2123.01,-28882.11C2168.02,-28869.81 2219.53,-28855.73 2263.44,-28843.73"/>
<polygon fill="black" stroke="black" points="2264.54,-28847.05 2273.26,-28841.04 2262.69,-28840.3 2264.54,-28847.05"/>
</g>
<!-- moe_30_expert_10 -->
<g id="node625" class="node">
<title>moe_30_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2710,-28840.96 2492,-28840.96 2492,-28788.96 2710,-28788.96 2710,-28840.96"/>
<text text-anchor="middle" x="2601" y="-28828.96" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2601" y="-28817.96" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2601" y="-28806.96" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2601" y="-28795.96" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_30_route&#45;&gt;moe_30_expert_10 -->
<g id="edge1015" class="edge">
<title>moe_30_route&#45;&gt;moe_30_expert_10</title>
<path fill="none" stroke="black" d="M2177.13,-28889.87C2265.01,-28877.19 2374.89,-28860.42 2481.75,-28841.15"/>
<polygon fill="black" stroke="black" points="2482.54,-28844.57 2491.75,-28839.34 2481.29,-28837.68 2482.54,-28844.57"/>
</g>
<!-- moe_30_expert_11 -->
<g id="node626" class="node">
<title>moe_30_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2946,-28840.96 2728,-28840.96 2728,-28788.96 2946,-28788.96 2946,-28840.96"/>
<text text-anchor="middle" x="2837" y="-28828.96" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2837" y="-28817.96" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2837" y="-28806.96" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2837" y="-28795.96" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_30_route&#45;&gt;moe_30_expert_11 -->
<g id="edge1016" class="edge">
<title>moe_30_route&#45;&gt;moe_30_expert_11</title>
<path fill="none" stroke="black" d="M2209.34,-28898.38C2349.04,-28886.9 2540.54,-28868.4 2717.75,-28841.09"/>
<polygon fill="black" stroke="black" points="2718.44,-28844.53 2727.79,-28839.53 2717.37,-28837.61 2718.44,-28844.53"/>
</g>
<!-- moe_30_expert_12 -->
<g id="node627" class="node">
<title>moe_30_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3182,-28840.96 2964,-28840.96 2964,-28788.96 3182,-28788.96 3182,-28840.96"/>
<text text-anchor="middle" x="3073" y="-28828.96" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3073" y="-28817.96" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3073" y="-28806.96" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3073" y="-28795.96" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_30_route&#45;&gt;moe_30_expert_12 -->
<g id="edge1017" class="edge">
<title>moe_30_route&#45;&gt;moe_30_expert_12</title>
<path fill="none" stroke="black" d="M2222.3,-28904.71C2411.67,-28895.64 2697,-28877.33 2953.53,-28841.09"/>
<polygon fill="black" stroke="black" points="2954.39,-28844.51 2963.8,-28839.63 2953.41,-28837.58 2954.39,-28844.51"/>
</g>
<!-- moe_30_expert_13 -->
<g id="node628" class="node">
<title>moe_30_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3418,-28840.96 3200,-28840.96 3200,-28788.96 3418,-28788.96 3418,-28840.96"/>
<text text-anchor="middle" x="3309" y="-28828.96" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3309" y="-28817.96" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3309" y="-28806.96" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3309" y="-28795.96" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_30_route&#45;&gt;moe_30_expert_13 -->
<g id="edge1018" class="edge">
<title>moe_30_route&#45;&gt;moe_30_expert_13</title>
<path fill="none" stroke="black" d="M2227.26,-28909.17C2462.3,-28903.08 2848.8,-28886.65 3189.74,-28841.05"/>
<polygon fill="black" stroke="black" points="3190.37,-28844.5 3199.81,-28839.69 3189.43,-28837.56 3190.37,-28844.5"/>
</g>
<!-- moe_30_expert_14 -->
<g id="node629" class="node">
<title>moe_30_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3654,-28840.96 3436,-28840.96 3436,-28788.96 3654,-28788.96 3654,-28840.96"/>
<text text-anchor="middle" x="3545" y="-28828.96" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3545" y="-28817.96" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3545" y="-28806.96" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3545" y="-28795.96" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_30_route&#45;&gt;moe_30_expert_14 -->
<g id="edge1019" class="edge">
<title>moe_30_route&#45;&gt;moe_30_expert_14</title>
<path fill="none" stroke="black" d="M2228.77,-28912.35C2505.43,-28909.45 2997.44,-28896.19 3425.71,-28841.04"/>
<polygon fill="black" stroke="black" points="3426.35,-28844.49 3435.81,-28839.73 3425.45,-28837.55 3426.35,-28844.49"/>
</g>
<!-- moe_30_expert_15 -->
<g id="node630" class="node">
<title>moe_30_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3890,-28840.96 3672,-28840.96 3672,-28788.96 3890,-28788.96 3890,-28840.96"/>
<text text-anchor="middle" x="3781" y="-28828.96" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3781" y="-28817.96" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3781" y="-28806.96" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3781" y="-28795.96" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_30_route&#45;&gt;moe_30_expert_15 -->
<g id="edge1020" class="edge">
<title>moe_30_route&#45;&gt;moe_30_expert_15</title>
<path fill="none" stroke="black" d="M2226.07,-28907.81C2603.89,-28898.44 3373.25,-28875.91 3661.76,-28841.01"/>
<polygon fill="black" stroke="black" points="3662.32,-28844.46 3671.82,-28839.76 3661.46,-28837.52 3662.32,-28844.46"/>
</g>
<!-- moe_30_aggregate -->
<g id="node631" class="node">
<title>moe_30_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1893" cy="-28716.19" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1893" y="-28730.19" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1893" y="-28719.19" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1893" y="-28708.19" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1893" y="-28697.19" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_30_expert_0&#45;&gt;moe_30_aggregate -->
<g id="edge1021" class="edge">
<title>moe_30_expert_0&#45;&gt;moe_30_aggregate</title>
<path fill="none" stroke="black" d="M350.18,-28790.18C353.15,-28789.74 356.09,-28789.34 359,-28788.96 604.12,-28757.47 1298.7,-28733.95 1663.21,-28723.38"/>
<polygon fill="black" stroke="black" points="1663.47,-28726.87 1673.36,-28723.08 1663.27,-28719.87 1663.47,-28726.87"/>
</g>
<!-- moe_30_expert_1&#45;&gt;moe_30_aggregate -->
<g id="edge1022" class="edge">
<title>moe_30_expert_1&#45;&gt;moe_30_aggregate</title>
<path fill="none" stroke="black" d="M586.19,-28790.21C589.15,-28789.77 592.09,-28789.35 595,-28788.96 965.22,-28739.81 1399.16,-28724.21 1659.76,-28719.33"/>
<polygon fill="black" stroke="black" points="1660.17,-28722.82 1670.11,-28719.14 1660.05,-28715.82 1660.17,-28722.82"/>
</g>
<!-- moe_30_expert_2&#45;&gt;moe_30_aggregate -->
<g id="edge1023" class="edge">
<title>moe_30_expert_2&#45;&gt;moe_30_aggregate</title>
<path fill="none" stroke="black" d="M822.2,-28790.26C825.16,-28789.8 828.1,-28789.37 831,-28788.96 1116.02,-28749.34 1447.23,-28731.37 1662.98,-28723.37"/>
<polygon fill="black" stroke="black" points="1663.3,-28726.86 1673.17,-28722.99 1663.05,-28719.86 1663.3,-28726.86"/>
</g>
<!-- moe_30_expert_3&#45;&gt;moe_30_aggregate -->
<g id="edge1024" class="edge">
<title>moe_30_expert_3&#45;&gt;moe_30_aggregate</title>
<path fill="none" stroke="black" d="M1058.21,-28790.34C1061.16,-28789.85 1064.1,-28789.4 1067,-28788.96 1270.78,-28758.64 1504.89,-28739.79 1671.72,-28729.06"/>
<polygon fill="black" stroke="black" points="1672.35,-28732.53 1682.11,-28728.4 1671.91,-28725.54 1672.35,-28732.53"/>
</g>
<!-- moe_30_expert_4&#45;&gt;moe_30_aggregate -->
<g id="edge1025" class="edge">
<title>moe_30_expert_4&#45;&gt;moe_30_aggregate</title>
<path fill="none" stroke="black" d="M1294.23,-28790.47C1297.18,-28789.95 1300.11,-28789.44 1303,-28788.96 1432.69,-28767.38 1579.43,-28749.5 1694.13,-28736.99"/>
<polygon fill="black" stroke="black" points="1694.51,-28740.47 1704.07,-28735.91 1693.75,-28733.51 1694.51,-28740.47"/>
</g>
<!-- moe_30_expert_5&#45;&gt;moe_30_aggregate -->
<g id="edge1026" class="edge">
<title>moe_30_expert_5&#45;&gt;moe_30_aggregate</title>
<path fill="none" stroke="black" d="M1530.28,-28790.78C1533.22,-28790.16 1536.13,-28789.56 1539,-28788.96 1606.32,-28775.01 1680.9,-28759.84 1744.19,-28747.06"/>
<polygon fill="black" stroke="black" points="1745.13,-28750.44 1754.24,-28745.03 1743.75,-28743.58 1745.13,-28750.44"/>
</g>
<!-- moe_30_expert_6&#45;&gt;moe_30_aggregate -->
<g id="edge1027" class="edge">
<title>moe_30_expert_6&#45;&gt;moe_30_aggregate</title>
<path fill="none" stroke="black" d="M1718.08,-28788.92C1743.73,-28778.4 1774.09,-28765.95 1802.26,-28754.4"/>
<polygon fill="black" stroke="black" points="1803.79,-28757.56 1811.72,-28750.52 1801.14,-28751.08 1803.79,-28757.56"/>
</g>
<!-- moe_30_expert_7&#45;&gt;moe_30_aggregate -->
<g id="edge1028" class="edge">
<title>moe_30_expert_7&#45;&gt;moe_30_aggregate</title>
<path fill="none" stroke="black" d="M1893,-28788.79C1893,-28780.98 1893,-28772.12 1893,-28763.35"/>
<polygon fill="black" stroke="black" points="1896.5,-28763.17 1893,-28753.17 1889.5,-28763.17 1896.5,-28763.17"/>
</g>
<!-- moe_30_expert_8&#45;&gt;moe_30_aggregate -->
<g id="edge1029" class="edge">
<title>moe_30_expert_8&#45;&gt;moe_30_aggregate</title>
<path fill="none" stroke="black" d="M2067.92,-28788.92C2042.27,-28778.4 2011.91,-28765.95 1983.74,-28754.4"/>
<polygon fill="black" stroke="black" points="1984.86,-28751.08 1974.28,-28750.52 1982.21,-28757.56 1984.86,-28751.08"/>
</g>
<!-- moe_30_expert_9&#45;&gt;moe_30_aggregate -->
<g id="edge1030" class="edge">
<title>moe_30_expert_9&#45;&gt;moe_30_aggregate</title>
<path fill="none" stroke="black" d="M2255.72,-28790.78C2252.78,-28790.16 2249.87,-28789.56 2247,-28788.96 2179.68,-28775.01 2105.1,-28759.84 2041.81,-28747.06"/>
<polygon fill="black" stroke="black" points="2042.25,-28743.58 2031.76,-28745.03 2040.87,-28750.44 2042.25,-28743.58"/>
</g>
<!-- moe_30_expert_10&#45;&gt;moe_30_aggregate -->
<g id="edge1031" class="edge">
<title>moe_30_expert_10&#45;&gt;moe_30_aggregate</title>
<path fill="none" stroke="black" d="M2491.77,-28790.47C2488.82,-28789.95 2485.89,-28789.44 2483,-28788.96 2353.31,-28767.38 2206.57,-28749.5 2091.87,-28736.99"/>
<polygon fill="black" stroke="black" points="2092.25,-28733.51 2081.93,-28735.91 2091.49,-28740.47 2092.25,-28733.51"/>
</g>
<!-- moe_30_expert_11&#45;&gt;moe_30_aggregate -->
<g id="edge1032" class="edge">
<title>moe_30_expert_11&#45;&gt;moe_30_aggregate</title>
<path fill="none" stroke="black" d="M2727.79,-28790.34C2724.84,-28789.85 2721.9,-28789.4 2719,-28788.96 2515.22,-28758.64 2281.11,-28739.79 2114.28,-28729.06"/>
<polygon fill="black" stroke="black" points="2114.09,-28725.54 2103.89,-28728.4 2113.65,-28732.53 2114.09,-28725.54"/>
</g>
<!-- moe_30_expert_12&#45;&gt;moe_30_aggregate -->
<g id="edge1033" class="edge">
<title>moe_30_expert_12&#45;&gt;moe_30_aggregate</title>
<path fill="none" stroke="black" d="M2963.8,-28790.26C2960.84,-28789.8 2957.9,-28789.37 2955,-28788.96 2669.98,-28749.34 2338.77,-28731.37 2123.02,-28723.37"/>
<polygon fill="black" stroke="black" points="2122.95,-28719.86 2112.83,-28722.99 2122.7,-28726.86 2122.95,-28719.86"/>
</g>
<!-- moe_30_expert_13&#45;&gt;moe_30_aggregate -->
<g id="edge1034" class="edge">
<title>moe_30_expert_13&#45;&gt;moe_30_aggregate</title>
<path fill="none" stroke="black" d="M3199.81,-28790.21C3196.85,-28789.77 3193.91,-28789.35 3191,-28788.96 2820.78,-28739.81 2386.84,-28724.21 2126.24,-28719.33"/>
<polygon fill="black" stroke="black" points="2125.95,-28715.82 2115.89,-28719.14 2125.83,-28722.82 2125.95,-28715.82"/>
</g>
<!-- moe_30_expert_14&#45;&gt;moe_30_aggregate -->
<g id="edge1035" class="edge">
<title>moe_30_expert_14&#45;&gt;moe_30_aggregate</title>
<path fill="none" stroke="black" d="M3435.82,-28790.18C3432.85,-28789.74 3429.91,-28789.34 3427,-28788.96 3181.88,-28757.47 2487.3,-28733.95 2122.79,-28723.38"/>
<polygon fill="black" stroke="black" points="2122.73,-28719.87 2112.64,-28723.08 2122.53,-28726.87 2122.73,-28719.87"/>
</g>
<!-- moe_30_expert_15&#45;&gt;moe_30_aggregate -->
<g id="edge1036" class="edge">
<title>moe_30_expert_15&#45;&gt;moe_30_aggregate</title>
<path fill="none" stroke="black" d="M3671.82,-28790.16C3668.85,-28789.73 3665.91,-28789.33 3663,-28788.96 3372.39,-28752.55 2534.41,-28730.59 2124.44,-28721.74"/>
<polygon fill="black" stroke="black" points="2124.31,-28718.23 2114.24,-28721.52 2124.16,-28725.23 2124.31,-28718.23"/>
</g>
<!-- moe_30_ffn -->
<g id="node632" class="node">
<title>moe_30_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2051,-28643.42 1735,-28643.42 1735,-28591.42 2051,-28591.42 2051,-28643.42"/>
<text text-anchor="middle" x="1893" y="-28631.42" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1893" y="-28620.42" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1893" y="-28609.42" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1893" y="-28598.42" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_30_aggregate&#45;&gt;moe_30_ffn -->
<g id="edge1037" class="edge">
<title>moe_30_aggregate&#45;&gt;moe_30_ffn</title>
<path fill="none" stroke="black" d="M1893,-28679.16C1893,-28670.85 1893,-28662.01 1893,-28653.73"/>
<polygon fill="black" stroke="black" points="1896.5,-28653.62 1893,-28643.62 1889.5,-28653.62 1896.5,-28653.62"/>
</g>
<!-- moe_30_res2 -->
<g id="node634" class="node">
<title>moe_30_res2</title>
<polygon fill="lightyellow" stroke="black" points="2229.89,-28555.42 1693.97,-28555.42 1556.11,-28451.42 2092.03,-28451.42 2229.89,-28555.42"/>
<text text-anchor="middle" x="1893" y="-28517.42" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1893" y="-28506.42" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1893" y="-28495.42" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1893" y="-28484.42" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_30_ffn&#45;&gt;moe_30_res2 -->
<g id="edge1038" class="edge">
<title>moe_30_ffn&#45;&gt;moe_30_res2</title>
<path fill="none" stroke="black" d="M1893,-28591.29C1893,-28583.6 1893,-28574.79 1893,-28565.79"/>
<polygon fill="black" stroke="black" points="1896.5,-28565.6 1893,-28555.6 1889.5,-28565.6 1896.5,-28565.6"/>
</g>
<!-- moe_30_res1&#45;&gt;moe_30_gate -->
<g id="edge1003" class="edge">
<title>moe_30_res1&#45;&gt;moe_30_gate</title>
<path fill="none" stroke="black" d="M2011,-29126.12C2011,-29117.94 2011,-29109.42 2011,-29101.04"/>
<polygon fill="black" stroke="black" points="2014.5,-29100.93 2011,-29090.93 2007.5,-29100.93 2014.5,-29100.93"/>
</g>
<!-- moe_31_mha -->
<g id="node635" class="node">
<title>moe_31_mha</title>
<polygon fill="lightgreen" stroke="black" points="2051,-28404.42 1735,-28404.42 1735,-28352.42 2051,-28352.42 2051,-28404.42"/>
<text text-anchor="middle" x="1893" y="-28392.42" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1893" y="-28381.42" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1893" y="-28370.42" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1893" y="-28359.42" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_30_res2&#45;&gt;moe_31_mha -->
<g id="edge1039" class="edge">
<title>moe_30_res2&#45;&gt;moe_31_mha</title>
<path fill="none" stroke="black" d="M1893,-28451.33C1893,-28439 1893,-28426.09 1893,-28414.68"/>
<polygon fill="black" stroke="black" points="1896.5,-28414.67 1893,-28404.67 1889.5,-28414.67 1896.5,-28414.67"/>
</g>
<!-- moe_31_res1 -->
<g id="node656" class="node">
<title>moe_31_res1</title>
<polygon fill="lightyellow" stroke="black" points="2229.89,-28316.42 1693.97,-28316.42 1556.11,-28212.42 2092.03,-28212.42 2229.89,-28316.42"/>
<text text-anchor="middle" x="1893" y="-28278.42" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1893" y="-28267.42" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1893" y="-28256.42" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1893" y="-28245.42" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_31_mha&#45;&gt;moe_31_res1 -->
<g id="edge1040" class="edge">
<title>moe_31_mha&#45;&gt;moe_31_res1</title>
<path fill="none" stroke="black" d="M1893,-28352.29C1893,-28344.6 1893,-28335.79 1893,-28326.79"/>
<polygon fill="black" stroke="black" points="1896.5,-28326.6 1893,-28316.6 1889.5,-28326.6 1896.5,-28326.6"/>
</g>
<!-- moe_31_gate -->
<g id="node636" class="node">
<title>moe_31_gate</title>
<polygon fill="lightyellow" stroke="black" points="2221.8,-28176.42 1698.75,-28176.42 1564.2,-28072.42 2087.25,-28072.42 2221.8,-28176.42"/>
<text text-anchor="middle" x="1893" y="-28138.42" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1893" y="-28127.42" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1893" y="-28116.42" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1893" y="-28105.42" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_31_route -->
<g id="node637" class="node">
<title>moe_31_route</title>
<ellipse fill="lightblue" stroke="black" cx="1893" cy="-27999.65" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1893" y="-28013.65" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1893" y="-28002.65" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1893" y="-27991.65" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1893" y="-27980.65" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_31_gate&#45;&gt;moe_31_route -->
<g id="edge1042" class="edge">
<title>moe_31_gate&#45;&gt;moe_31_route</title>
<path fill="none" stroke="black" d="M1893,-28072.07C1893,-28063.66 1893,-28055 1893,-28046.73"/>
<polygon fill="black" stroke="black" points="1896.5,-28046.51 1893,-28036.51 1889.5,-28046.51 1896.5,-28046.51"/>
</g>
<!-- moe_31_expert_0 -->
<g id="node638" class="node">
<title>moe_31_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="295,-27926.89 77,-27926.89 77,-27874.89 295,-27874.89 295,-27926.89"/>
<text text-anchor="middle" x="186" y="-27914.89" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="186" y="-27903.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="186" y="-27892.89" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="186" y="-27881.89" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_31_route&#45;&gt;moe_31_expert_0 -->
<g id="edge1043" class="edge">
<title>moe_31_route&#45;&gt;moe_31_expert_0</title>
<path fill="none" stroke="black" d="M1678.11,-27993.31C1312.09,-27983.48 581.32,-27960.54 305.21,-27926.93"/>
<polygon fill="black" stroke="black" points="305.54,-27923.44 295.18,-27925.67 304.67,-27930.39 305.54,-27923.44"/>
</g>
<!-- moe_31_expert_1 -->
<g id="node639" class="node">
<title>moe_31_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="531,-27926.89 313,-27926.89 313,-27874.89 531,-27874.89 531,-27926.89"/>
<text text-anchor="middle" x="422" y="-27914.89" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="422" y="-27903.89" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="422" y="-27892.89" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="422" y="-27881.89" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_31_route&#45;&gt;moe_31_expert_1 -->
<g id="edge1044" class="edge">
<title>moe_31_route&#45;&gt;moe_31_expert_1</title>
<path fill="none" stroke="black" d="M1675.29,-27997.52C1409.36,-27993.76 945.98,-27979.54 541.34,-27926.97"/>
<polygon fill="black" stroke="black" points="541.56,-27923.47 531.19,-27925.64 540.65,-27930.41 541.56,-27923.47"/>
</g>
<!-- moe_31_expert_2 -->
<g id="node640" class="node">
<title>moe_31_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="767,-27926.89 549,-27926.89 549,-27874.89 767,-27874.89 767,-27926.89"/>
<text text-anchor="middle" x="658" y="-27914.89" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="658" y="-27903.89" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="658" y="-27892.89" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="658" y="-27881.89" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_31_route&#45;&gt;moe_31_expert_2 -->
<g id="edge1045" class="edge">
<title>moe_31_route&#45;&gt;moe_31_expert_2</title>
<path fill="none" stroke="black" d="M1677.68,-27994.05C1454.48,-27987.14 1095.57,-27970.07 777.54,-27927.01"/>
<polygon fill="black" stroke="black" points="777.57,-27923.48 767.19,-27925.6 776.63,-27930.42 777.57,-27923.48"/>
</g>
<!-- moe_31_expert_3 -->
<g id="node641" class="node">
<title>moe_31_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1003,-27926.89 785,-27926.89 785,-27874.89 1003,-27874.89 1003,-27926.89"/>
<text text-anchor="middle" x="894" y="-27914.89" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="894" y="-27903.89" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="894" y="-27892.89" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="894" y="-27881.89" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_31_route&#45;&gt;moe_31_expert_3 -->
<g id="edge1046" class="edge">
<title>moe_31_route&#45;&gt;moe_31_expert_3</title>
<path fill="none" stroke="black" d="M1683.89,-27989.14C1507.38,-27979.34 1248,-27960.8 1013.3,-27927"/>
<polygon fill="black" stroke="black" points="1013.6,-27923.51 1003.2,-27925.53 1012.6,-27930.43 1013.6,-27923.51"/>
</g>
<!-- moe_31_expert_4 -->
<g id="node642" class="node">
<title>moe_31_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1239,-27926.89 1021,-27926.89 1021,-27874.89 1239,-27874.89 1239,-27926.89"/>
<text text-anchor="middle" x="1130" y="-27914.89" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1130" y="-27903.89" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1130" y="-27892.89" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1130" y="-27881.89" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_31_route&#45;&gt;moe_31_expert_4 -->
<g id="edge1047" class="edge">
<title>moe_31_route&#45;&gt;moe_31_expert_4</title>
<path fill="none" stroke="black" d="M1700.77,-27982.24C1574.94,-27970.3 1406.82,-27952.09 1249.56,-27927.08"/>
<polygon fill="black" stroke="black" points="1249.65,-27923.55 1239.22,-27925.42 1248.54,-27930.46 1249.65,-27923.55"/>
</g>
<!-- moe_31_expert_5 -->
<g id="node643" class="node">
<title>moe_31_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1475,-27926.89 1257,-27926.89 1257,-27874.89 1475,-27874.89 1475,-27926.89"/>
<text text-anchor="middle" x="1366" y="-27914.89" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1366" y="-27903.89" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1366" y="-27892.89" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1366" y="-27881.89" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_31_route&#45;&gt;moe_31_expert_5 -->
<g id="edge1048" class="edge">
<title>moe_31_route&#45;&gt;moe_31_expert_5</title>
<path fill="none" stroke="black" d="M1740.78,-27973.25C1666.42,-27960.52 1575.41,-27944.47 1485.13,-27927.08"/>
<polygon fill="black" stroke="black" points="1485.75,-27923.64 1475.26,-27925.18 1484.42,-27930.51 1485.75,-27923.64"/>
</g>
<!-- moe_31_expert_6 -->
<g id="node644" class="node">
<title>moe_31_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1711,-27926.89 1493,-27926.89 1493,-27874.89 1711,-27874.89 1711,-27926.89"/>
<text text-anchor="middle" x="1602" y="-27914.89" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1602" y="-27903.89" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1602" y="-27892.89" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1602" y="-27881.89" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_31_route&#45;&gt;moe_31_expert_6 -->
<g id="edge1049" class="edge">
<title>moe_31_route&#45;&gt;moe_31_expert_6</title>
<path fill="none" stroke="black" d="M1796.51,-27966.57C1761.12,-27954.8 1721.35,-27941.58 1687.04,-27930.17"/>
<polygon fill="black" stroke="black" points="1688.11,-27926.83 1677.52,-27927 1685.9,-27933.48 1688.11,-27926.83"/>
</g>
<!-- moe_31_expert_7 -->
<g id="node645" class="node">
<title>moe_31_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1947,-27926.89 1729,-27926.89 1729,-27874.89 1947,-27874.89 1947,-27926.89"/>
<text text-anchor="middle" x="1838" y="-27914.89" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1838" y="-27903.89" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1838" y="-27892.89" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1838" y="-27881.89" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_31_route&#45;&gt;moe_31_expert_7 -->
<g id="edge1050" class="edge">
<title>moe_31_route&#45;&gt;moe_31_expert_7</title>
<path fill="none" stroke="black" d="M1872.68,-27962.9C1867.63,-27954.03 1862.25,-27944.55 1857.26,-27935.77"/>
<polygon fill="black" stroke="black" points="1860.22,-27933.89 1852.23,-27926.93 1854.13,-27937.35 1860.22,-27933.89"/>
</g>
<!-- moe_31_expert_8 -->
<g id="node646" class="node">
<title>moe_31_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2183,-27926.89 1965,-27926.89 1965,-27874.89 2183,-27874.89 2183,-27926.89"/>
<text text-anchor="middle" x="2074" y="-27914.89" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2074" y="-27903.89" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2074" y="-27892.89" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2074" y="-27881.89" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_31_route&#45;&gt;moe_31_expert_8 -->
<g id="edge1051" class="edge">
<title>moe_31_route&#45;&gt;moe_31_expert_8</title>
<path fill="none" stroke="black" d="M1957.07,-27964.4C1977,-27953.75 1998.8,-27942.09 2018.12,-27931.76"/>
<polygon fill="black" stroke="black" points="2019.93,-27934.76 2027.1,-27926.96 2016.63,-27928.59 2019.93,-27934.76"/>
</g>
<!-- moe_31_expert_9 -->
<g id="node647" class="node">
<title>moe_31_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2419,-27926.89 2201,-27926.89 2201,-27874.89 2419,-27874.89 2419,-27926.89"/>
<text text-anchor="middle" x="2310" y="-27914.89" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2310" y="-27903.89" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2310" y="-27892.89" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2310" y="-27881.89" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_31_route&#45;&gt;moe_31_expert_9 -->
<g id="edge1052" class="edge">
<title>moe_31_route&#45;&gt;moe_31_expert_9</title>
<path fill="none" stroke="black" d="M2018.4,-27969.56C2073.49,-27956.77 2137.84,-27941.84 2192.06,-27929.26"/>
<polygon fill="black" stroke="black" points="2193.11,-27932.6 2202.06,-27926.93 2191.53,-27925.79 2193.11,-27932.6"/>
</g>
<!-- moe_31_expert_10 -->
<g id="node648" class="node">
<title>moe_31_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2655,-27926.89 2437,-27926.89 2437,-27874.89 2655,-27874.89 2655,-27926.89"/>
<text text-anchor="middle" x="2546" y="-27914.89" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2546" y="-27903.89" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2546" y="-27892.89" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2546" y="-27881.89" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_31_route&#45;&gt;moe_31_expert_10 -->
<g id="edge1053" class="edge">
<title>moe_31_route&#45;&gt;moe_31_expert_10</title>
<path fill="none" stroke="black" d="M2070.32,-27978.27C2171.99,-27965.76 2302.15,-27948.35 2426.66,-27927.07"/>
<polygon fill="black" stroke="black" points="2427.5,-27930.48 2436.76,-27925.33 2426.32,-27923.58 2427.5,-27930.48"/>
</g>
<!-- moe_31_expert_11 -->
<g id="node649" class="node">
<title>moe_31_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2891,-27926.89 2673,-27926.89 2673,-27874.89 2891,-27874.89 2891,-27926.89"/>
<text text-anchor="middle" x="2782" y="-27914.89" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2782" y="-27903.89" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2782" y="-27892.89" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2782" y="-27881.89" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_31_route&#45;&gt;moe_31_expert_11 -->
<g id="edge1054" class="edge">
<title>moe_31_route&#45;&gt;moe_31_expert_11</title>
<path fill="none" stroke="black" d="M2095.89,-27986.22C2249.23,-27975.29 2464.98,-27956.65 2662.79,-27927"/>
<polygon fill="black" stroke="black" points="2663.43,-27930.44 2672.79,-27925.49 2662.38,-27923.52 2663.43,-27930.44"/>
</g>
<!-- moe_31_expert_12 -->
<g id="node650" class="node">
<title>moe_31_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3127,-27926.89 2909,-27926.89 2909,-27874.89 3127,-27874.89 3127,-27926.89"/>
<text text-anchor="middle" x="3018" y="-27914.89" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3018" y="-27903.89" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3018" y="-27892.89" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3018" y="-27881.89" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_31_route&#45;&gt;moe_31_expert_12 -->
<g id="edge1055" class="edge">
<title>moe_31_route&#45;&gt;moe_31_expert_12</title>
<path fill="none" stroke="black" d="M2106.07,-27991.98C2308.11,-27983.67 2620.1,-27965.7 2898.9,-27926.96"/>
<polygon fill="black" stroke="black" points="2899.38,-27930.43 2908.8,-27925.57 2898.41,-27923.49 2899.38,-27930.43"/>
</g>
<!-- moe_31_expert_13 -->
<g id="node651" class="node">
<title>moe_31_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3363,-27926.89 3145,-27926.89 3145,-27874.89 3363,-27874.89 3363,-27926.89"/>
<text text-anchor="middle" x="3254" y="-27914.89" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3254" y="-27903.89" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3254" y="-27892.89" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3254" y="-27881.89" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_31_route&#45;&gt;moe_31_expert_13 -->
<g id="edge1056" class="edge">
<title>moe_31_route&#45;&gt;moe_31_expert_13</title>
<path fill="none" stroke="black" d="M2109.79,-27996.04C2356.33,-27990.8 2770.78,-27975.1 3134.87,-27926.95"/>
<polygon fill="black" stroke="black" points="3135.36,-27930.42 3144.81,-27925.63 3134.44,-27923.48 3135.36,-27930.42"/>
</g>
<!-- moe_31_expert_14 -->
<g id="node652" class="node">
<title>moe_31_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3599,-27926.89 3381,-27926.89 3381,-27874.89 3599,-27874.89 3599,-27926.89"/>
<text text-anchor="middle" x="3490" y="-27914.89" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3490" y="-27903.89" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3490" y="-27892.89" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3490" y="-27881.89" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_31_route&#45;&gt;moe_31_expert_14 -->
<g id="edge1057" class="edge">
<title>moe_31_route&#45;&gt;moe_31_expert_14</title>
<path fill="none" stroke="black" d="M2111.05,-27998.97C2398.29,-27996.91 2918.94,-27984.67 3370.82,-27926.95"/>
<polygon fill="black" stroke="black" points="3371.34,-27930.41 3380.81,-27925.66 3370.45,-27923.47 3371.34,-27930.41"/>
</g>
<!-- moe_31_expert_15 -->
<g id="node653" class="node">
<title>moe_31_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3835,-27926.89 3617,-27926.89 3617,-27874.89 3835,-27874.89 3835,-27926.89"/>
<text text-anchor="middle" x="3726" y="-27914.89" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3726" y="-27903.89" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3726" y="-27892.89" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3726" y="-27881.89" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_31_route&#45;&gt;moe_31_expert_15 -->
<g id="edge1058" class="edge">
<title>moe_31_route&#45;&gt;moe_31_expert_15</title>
<path fill="none" stroke="black" d="M2108.52,-27994.13C2498.04,-27985.2 3305.94,-27963.12 3606.77,-27926.93"/>
<polygon fill="black" stroke="black" points="3607.32,-27930.38 3616.82,-27925.69 3606.46,-27923.44 3607.32,-27930.38"/>
</g>
<!-- moe_31_aggregate -->
<g id="node654" class="node">
<title>moe_31_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1923" cy="-27802.12" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1923" y="-27816.12" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1923" y="-27805.12" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1923" y="-27794.12" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1923" y="-27783.12" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_31_expert_0&#45;&gt;moe_31_aggregate -->
<g id="edge1059" class="edge">
<title>moe_31_expert_0&#45;&gt;moe_31_aggregate</title>
<path fill="none" stroke="black" d="M295.18,-27876.09C298.15,-27875.66 301.09,-27875.26 304,-27874.89 565.43,-27841.63 1311.24,-27818.61 1692.5,-27808.66"/>
<polygon fill="black" stroke="black" points="1692.65,-27812.15 1702.56,-27808.4 1692.47,-27805.16 1692.65,-27812.15"/>
</g>
<!-- moe_31_expert_1&#45;&gt;moe_31_aggregate -->
<g id="edge1060" class="edge">
<title>moe_31_expert_1&#45;&gt;moe_31_aggregate</title>
<path fill="none" stroke="black" d="M531.19,-27876.12C534.15,-27875.68 537.09,-27875.27 540,-27874.89 941.64,-27822.25 1413.64,-27807.81 1689.42,-27804.09"/>
<polygon fill="black" stroke="black" points="1689.61,-27807.59 1699.56,-27803.96 1689.51,-27800.59 1689.61,-27807.59"/>
</g>
<!-- moe_31_expert_2&#45;&gt;moe_31_aggregate -->
<g id="edge1061" class="edge">
<title>moe_31_expert_2&#45;&gt;moe_31_aggregate</title>
<path fill="none" stroke="black" d="M767.19,-27876.16C770.16,-27875.71 773.1,-27875.28 776,-27874.89 1091.32,-27831.85 1458.99,-27814.58 1691.36,-27807.68"/>
<polygon fill="black" stroke="black" points="1691.74,-27811.17 1701.63,-27807.38 1691.53,-27804.17 1691.74,-27811.17"/>
</g>
<!-- moe_31_expert_3&#45;&gt;moe_31_aggregate -->
<g id="edge1062" class="edge">
<title>moe_31_expert_3&#45;&gt;moe_31_aggregate</title>
<path fill="none" stroke="black" d="M1003.2,-27876.23C1006.16,-27875.75 1009.1,-27875.31 1012,-27874.89 1244.42,-27841.25 1512.65,-27822.52 1697.57,-27812.7"/>
<polygon fill="black" stroke="black" points="1697.88,-27816.19 1707.69,-27812.17 1697.52,-27809.2 1697.88,-27816.19"/>
</g>
<!-- moe_31_expert_4&#45;&gt;moe_31_aggregate -->
<g id="edge1063" class="edge">
<title>moe_31_expert_4&#45;&gt;moe_31_aggregate</title>
<path fill="none" stroke="black" d="M1239.22,-27876.33C1242.17,-27875.83 1245.1,-27875.34 1248,-27874.89 1403.27,-27850.25 1580,-27831.8 1713.68,-27819.78"/>
<polygon fill="black" stroke="black" points="1714.39,-27823.23 1724.03,-27818.85 1713.76,-27816.26 1714.39,-27823.23"/>
</g>
<!-- moe_31_expert_5&#45;&gt;moe_31_aggregate -->
<g id="edge1064" class="edge">
<title>moe_31_expert_5&#45;&gt;moe_31_aggregate</title>
<path fill="none" stroke="black" d="M1475.26,-27876.55C1478.2,-27875.98 1481.12,-27875.43 1484,-27874.89 1571.99,-27858.38 1670.3,-27842.11 1751.55,-27829.24"/>
<polygon fill="black" stroke="black" points="1752.55,-27832.63 1761.88,-27827.61 1751.45,-27825.71 1752.55,-27832.63"/>
</g>
<!-- moe_31_expert_6&#45;&gt;moe_31_aggregate -->
<g id="edge1065" class="edge">
<title>moe_31_expert_6&#45;&gt;moe_31_aggregate</title>
<path fill="none" stroke="black" d="M1685.08,-27874.84C1722.75,-27863.49 1767.89,-27849.88 1808.68,-27837.58"/>
<polygon fill="black" stroke="black" points="1809.84,-27840.89 1818.4,-27834.65 1807.82,-27834.18 1809.84,-27840.89"/>
</g>
<!-- moe_31_expert_7&#45;&gt;moe_31_aggregate -->
<g id="edge1066" class="edge">
<title>moe_31_expert_7&#45;&gt;moe_31_aggregate</title>
<path fill="none" stroke="black" d="M1860.11,-27874.71C1867.72,-27866.05 1876.47,-27856.09 1884.98,-27846.4"/>
<polygon fill="black" stroke="black" points="1887.75,-27848.55 1891.72,-27838.73 1882.49,-27843.93 1887.75,-27848.55"/>
</g>
<!-- moe_31_expert_8&#45;&gt;moe_31_aggregate -->
<g id="edge1067" class="edge">
<title>moe_31_expert_8&#45;&gt;moe_31_aggregate</title>
<path fill="none" stroke="black" d="M2034.72,-27874.71C2019.76,-27865.13 2002.32,-27853.95 1985.73,-27843.31"/>
<polygon fill="black" stroke="black" points="1987.45,-27840.26 1977.14,-27837.81 1983.67,-27846.16 1987.45,-27840.26"/>
</g>
<!-- moe_31_expert_9&#45;&gt;moe_31_aggregate -->
<g id="edge1068" class="edge">
<title>moe_31_expert_9&#45;&gt;moe_31_aggregate</title>
<path fill="none" stroke="black" d="M2209.83,-27874.84C2161.97,-27862.87 2104.08,-27848.4 2052.88,-27835.59"/>
<polygon fill="black" stroke="black" points="2053.62,-27832.17 2043.07,-27833.14 2051.93,-27838.96 2053.62,-27832.17"/>
</g>
<!-- moe_31_expert_10&#45;&gt;moe_31_aggregate -->
<g id="edge1069" class="edge">
<title>moe_31_expert_10&#45;&gt;moe_31_aggregate</title>
<path fill="none" stroke="black" d="M2436.76,-27876.47C2433.81,-27875.93 2430.89,-27875.4 2428,-27874.89 2322.41,-27856.22 2203.72,-27839.15 2107.95,-27826.35"/>
<polygon fill="black" stroke="black" points="2108.25,-27822.86 2097.87,-27825.01 2107.32,-27829.8 2108.25,-27822.86"/>
</g>
<!-- moe_31_expert_11&#45;&gt;moe_31_aggregate -->
<g id="edge1070" class="edge">
<title>moe_31_expert_11&#45;&gt;moe_31_aggregate</title>
<path fill="none" stroke="black" d="M2672.79,-27876.3C2669.83,-27875.8 2666.9,-27875.33 2664,-27874.89 2487.93,-27847.79 2286.65,-27829.07 2138.35,-27817.56"/>
<polygon fill="black" stroke="black" points="2138.45,-27814.05 2128.21,-27816.77 2137.91,-27821.03 2138.45,-27814.05"/>
</g>
<!-- moe_31_expert_12&#45;&gt;moe_31_aggregate -->
<g id="edge1071" class="edge">
<title>moe_31_expert_12&#45;&gt;moe_31_aggregate</title>
<path fill="none" stroke="black" d="M2908.8,-27876.21C2905.84,-27875.74 2902.9,-27875.3 2900,-27874.89 2644.91,-27838.66 2349.6,-27820.18 2150.99,-27811.12"/>
<polygon fill="black" stroke="black" points="2150.87,-27807.61 2140.72,-27810.66 2150.56,-27814.61 2150.87,-27807.61"/>
</g>
<!-- moe_31_expert_13&#45;&gt;moe_31_aggregate -->
<g id="edge1072" class="edge">
<title>moe_31_expert_13&#45;&gt;moe_31_aggregate</title>
<path fill="none" stroke="black" d="M3144.81,-27876.15C3141.85,-27875.7 3138.91,-27875.28 3136,-27874.89 2796.65,-27829.16 2400,-27812.57 2155.12,-27806.54"/>
<polygon fill="black" stroke="black" points="2155.11,-27803.04 2145.03,-27806.3 2154.94,-27810.04 2155.11,-27803.04"/>
</g>
<!-- moe_31_expert_14&#45;&gt;moe_31_aggregate -->
<g id="edge1073" class="edge">
<title>moe_31_expert_14&#45;&gt;moe_31_aggregate</title>
<path fill="none" stroke="black" d="M3380.81,-27876.11C3377.85,-27875.67 3374.91,-27875.26 3372,-27874.89 2945.73,-27819.53 2443.83,-27806.08 2156.59,-27803.27"/>
<polygon fill="black" stroke="black" points="2156.49,-27799.77 2146.46,-27803.18 2156.43,-27806.77 2156.49,-27799.77"/>
</g>
<!-- moe_31_expert_15&#45;&gt;moe_31_aggregate -->
<g id="edge1074" class="edge">
<title>moe_31_expert_15&#45;&gt;moe_31_aggregate</title>
<path fill="none" stroke="black" d="M3616.82,-27876.09C3613.85,-27875.65 3610.91,-27875.25 3608,-27874.89 3333.85,-27840.25 2547.98,-27817.67 2154,-27808.2"/>
<polygon fill="black" stroke="black" points="2153.98,-27804.7 2143.9,-27807.96 2153.82,-27811.7 2153.98,-27804.7"/>
</g>
<!-- moe_31_ffn -->
<g id="node655" class="node">
<title>moe_31_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2081,-27729.35 1765,-27729.35 1765,-27677.35 2081,-27677.35 2081,-27729.35"/>
<text text-anchor="middle" x="1923" y="-27717.35" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1923" y="-27706.35" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1923" y="-27695.35" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1923" y="-27684.35" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_31_aggregate&#45;&gt;moe_31_ffn -->
<g id="edge1075" class="edge">
<title>moe_31_aggregate&#45;&gt;moe_31_ffn</title>
<path fill="none" stroke="black" d="M1923,-27765.08C1923,-27756.77 1923,-27747.94 1923,-27739.66"/>
<polygon fill="black" stroke="black" points="1926.5,-27739.54 1923,-27729.54 1919.5,-27739.54 1926.5,-27739.54"/>
</g>
<!-- moe_31_res2 -->
<g id="node657" class="node">
<title>moe_31_res2</title>
<polygon fill="lightyellow" stroke="black" points="2259.89,-27641.35 1723.97,-27641.35 1586.11,-27537.35 2122.03,-27537.35 2259.89,-27641.35"/>
<text text-anchor="middle" x="1923" y="-27603.35" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1923" y="-27592.35" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1923" y="-27581.35" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1923" y="-27570.35" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_31_ffn&#45;&gt;moe_31_res2 -->
<g id="edge1076" class="edge">
<title>moe_31_ffn&#45;&gt;moe_31_res2</title>
<path fill="none" stroke="black" d="M1923,-27677.21C1923,-27669.53 1923,-27660.71 1923,-27651.71"/>
<polygon fill="black" stroke="black" points="1926.5,-27651.52 1923,-27641.52 1919.5,-27651.52 1926.5,-27651.52"/>
</g>
<!-- moe_31_res1&#45;&gt;moe_31_gate -->
<g id="edge1041" class="edge">
<title>moe_31_res1&#45;&gt;moe_31_gate</title>
<path fill="none" stroke="black" d="M1893,-28212.04C1893,-28203.87 1893,-28195.34 1893,-28186.96"/>
<polygon fill="black" stroke="black" points="1896.5,-28186.85 1893,-28176.85 1889.5,-28186.85 1896.5,-28186.85"/>
</g>
<!-- moe_32_mha -->
<g id="node658" class="node">
<title>moe_32_mha</title>
<polygon fill="lightgreen" stroke="black" points="2081,-27490.35 1765,-27490.35 1765,-27438.35 2081,-27438.35 2081,-27490.35"/>
<text text-anchor="middle" x="1923" y="-27478.35" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1923" y="-27467.35" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1923" y="-27456.35" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1923" y="-27445.35" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_31_res2&#45;&gt;moe_32_mha -->
<g id="edge1077" class="edge">
<title>moe_31_res2&#45;&gt;moe_32_mha</title>
<path fill="none" stroke="black" d="M1923,-27537.25C1923,-27524.92 1923,-27512.02 1923,-27500.6"/>
<polygon fill="black" stroke="black" points="1926.5,-27500.59 1923,-27490.59 1919.5,-27500.59 1926.5,-27500.59"/>
</g>
<!-- moe_32_res1 -->
<g id="node679" class="node">
<title>moe_32_res1</title>
<polygon fill="lightyellow" stroke="black" points="2259.89,-27402.35 1723.97,-27402.35 1586.11,-27298.35 2122.03,-27298.35 2259.89,-27402.35"/>
<text text-anchor="middle" x="1923" y="-27364.35" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1923" y="-27353.35" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1923" y="-27342.35" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1923" y="-27331.35" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_32_mha&#45;&gt;moe_32_res1 -->
<g id="edge1078" class="edge">
<title>moe_32_mha&#45;&gt;moe_32_res1</title>
<path fill="none" stroke="black" d="M1923,-27438.21C1923,-27430.53 1923,-27421.71 1923,-27412.71"/>
<polygon fill="black" stroke="black" points="1926.5,-27412.52 1923,-27402.52 1919.5,-27412.52 1926.5,-27412.52"/>
</g>
<!-- moe_32_gate -->
<g id="node659" class="node">
<title>moe_32_gate</title>
<polygon fill="lightyellow" stroke="black" points="2251.8,-27262.35 1728.75,-27262.35 1594.2,-27158.35 2117.25,-27158.35 2251.8,-27262.35"/>
<text text-anchor="middle" x="1923" y="-27224.35" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1923" y="-27213.35" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1923" y="-27202.35" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1923" y="-27191.35" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_32_route -->
<g id="node660" class="node">
<title>moe_32_route</title>
<ellipse fill="lightblue" stroke="black" cx="1923" cy="-27085.58" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1923" y="-27099.58" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1923" y="-27088.58" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1923" y="-27077.58" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1923" y="-27066.58" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_32_gate&#45;&gt;moe_32_route -->
<g id="edge1080" class="edge">
<title>moe_32_gate&#45;&gt;moe_32_route</title>
<path fill="none" stroke="black" d="M1923,-27157.99C1923,-27149.58 1923,-27140.92 1923,-27132.65"/>
<polygon fill="black" stroke="black" points="1926.5,-27132.43 1923,-27122.43 1919.5,-27132.43 1926.5,-27132.43"/>
</g>
<!-- moe_32_expert_0 -->
<g id="node661" class="node">
<title>moe_32_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-27012.81 16,-27012.81 16,-26960.81 234,-26960.81 234,-27012.81"/>
<text text-anchor="middle" x="125" y="-27000.81" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-26989.81" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-26978.81" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-26967.81" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_32_route&#45;&gt;moe_32_expert_0 -->
<g id="edge1081" class="edge">
<title>moe_32_route&#45;&gt;moe_32_expert_0</title>
<path fill="none" stroke="black" d="M1707.72,-27079.83C1324.75,-27070.67 538.57,-27048.34 244.44,-27012.87"/>
<polygon fill="black" stroke="black" points="244.54,-27009.36 234.18,-27011.61 243.68,-27016.31 244.54,-27009.36"/>
</g>
<!-- moe_32_expert_1 -->
<g id="node662" class="node">
<title>moe_32_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-27012.81 252,-27012.81 252,-26960.81 470,-26960.81 470,-27012.81"/>
<text text-anchor="middle" x="361" y="-27000.81" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-26989.81" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-26978.81" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-26967.81" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_32_route&#45;&gt;moe_32_expert_1 -->
<g id="edge1082" class="edge">
<title>moe_32_route&#45;&gt;moe_32_expert_1</title>
<path fill="none" stroke="black" d="M1705.23,-27084.51C1423.86,-27081.99 919.04,-27069.18 480.21,-27012.87"/>
<polygon fill="black" stroke="black" points="480.55,-27009.39 470.19,-27011.58 479.65,-27016.33 480.55,-27009.39"/>
</g>
<!-- moe_32_expert_2 -->
<g id="node663" class="node">
<title>moe_32_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-27012.81 488,-27012.81 488,-26960.81 706,-26960.81 706,-27012.81"/>
<text text-anchor="middle" x="597" y="-27000.81" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-26989.81" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-26978.81" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-26967.81" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_32_route&#45;&gt;moe_32_expert_2 -->
<g id="edge1083" class="edge">
<title>moe_32_route&#45;&gt;moe_32_expert_2</title>
<path fill="none" stroke="black" d="M1706.58,-27081.45C1466.42,-27075.74 1067.53,-27059.63 716.31,-27012.9"/>
<polygon fill="black" stroke="black" points="716.57,-27009.4 706.19,-27011.54 715.64,-27016.34 716.57,-27009.4"/>
</g>
<!-- moe_32_expert_3 -->
<g id="node664" class="node">
<title>moe_32_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-27012.81 724,-27012.81 724,-26960.81 942,-26960.81 942,-27012.81"/>
<text text-anchor="middle" x="833" y="-27000.81" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-26989.81" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-26978.81" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-26967.81" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_32_route&#45;&gt;moe_32_expert_3 -->
<g id="edge1084" class="edge">
<title>moe_32_route&#45;&gt;moe_32_expert_3</title>
<path fill="none" stroke="black" d="M1710.7,-27077.16C1515.7,-27068.42 1218.74,-27050.26 952.46,-27012.93"/>
<polygon fill="black" stroke="black" points="952.59,-27009.42 942.2,-27011.48 951.61,-27016.35 952.59,-27009.42"/>
</g>
<!-- moe_32_expert_4 -->
<g id="node665" class="node">
<title>moe_32_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-27012.81 960,-27012.81 960,-26960.81 1178,-26960.81 1178,-27012.81"/>
<text text-anchor="middle" x="1069" y="-27000.81" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-26989.81" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-26978.81" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-26967.81" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_32_route&#45;&gt;moe_32_expert_4 -->
<g id="edge1085" class="edge">
<title>moe_32_route&#45;&gt;moe_32_expert_4</title>
<path fill="none" stroke="black" d="M1722.71,-27071.11C1576.89,-27059.87 1374.59,-27041.28 1188.2,-27012.92"/>
<polygon fill="black" stroke="black" points="1188.63,-27009.45 1178.21,-27011.39 1187.57,-27016.37 1188.63,-27009.45"/>
</g>
<!-- moe_32_expert_5 -->
<g id="node666" class="node">
<title>moe_32_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-27012.81 1196,-27012.81 1196,-26960.81 1414,-26960.81 1414,-27012.81"/>
<text text-anchor="middle" x="1305" y="-27000.81" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-26989.81" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-26978.81" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-26967.81" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_32_route&#45;&gt;moe_32_expert_5 -->
<g id="edge1086" class="edge">
<title>moe_32_route&#45;&gt;moe_32_expert_5</title>
<path fill="none" stroke="black" d="M1751.6,-27062.83C1657.6,-27050.21 1538.85,-27033.14 1424.25,-27012.99"/>
<polygon fill="black" stroke="black" points="1424.7,-27009.51 1414.24,-27011.22 1423.48,-27016.41 1424.7,-27009.51"/>
</g>
<!-- moe_32_expert_6 -->
<g id="node667" class="node">
<title>moe_32_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-27012.81 1432,-27012.81 1432,-26960.81 1650,-26960.81 1650,-27012.81"/>
<text text-anchor="middle" x="1541" y="-27000.81" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-26989.81" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-26978.81" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-26967.81" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_32_route&#45;&gt;moe_32_expert_6 -->
<g id="edge1087" class="edge">
<title>moe_32_route&#45;&gt;moe_32_expert_6</title>
<path fill="none" stroke="black" d="M1804.75,-27054.62C1755.24,-27042.08 1698.07,-27027.6 1649.64,-27015.33"/>
<polygon fill="black" stroke="black" points="1650.31,-27011.89 1639.76,-27012.82 1648.59,-27018.67 1650.31,-27011.89"/>
</g>
<!-- moe_32_expert_7 -->
<g id="node668" class="node">
<title>moe_32_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-27012.81 1668,-27012.81 1668,-26960.81 1886,-26960.81 1886,-27012.81"/>
<text text-anchor="middle" x="1777" y="-27000.81" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-26989.81" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-26978.81" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-26967.81" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_32_route&#45;&gt;moe_32_expert_7 -->
<g id="edge1088" class="edge">
<title>moe_32_route&#45;&gt;moe_32_expert_7</title>
<path fill="none" stroke="black" d="M1870.29,-27049.64C1855,-27039.5 1838.41,-27028.51 1823.52,-27018.64"/>
<polygon fill="black" stroke="black" points="1825.25,-27015.59 1814.98,-27012.98 1821.38,-27021.42 1825.25,-27015.59"/>
</g>
<!-- moe_32_expert_8 -->
<g id="node669" class="node">
<title>moe_32_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-27012.81 1904,-27012.81 1904,-26960.81 2122,-26960.81 2122,-27012.81"/>
<text text-anchor="middle" x="2013" y="-27000.81" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-26989.81" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-26978.81" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-26967.81" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_32_route&#45;&gt;moe_32_expert_8 -->
<g id="edge1089" class="edge">
<title>moe_32_route&#45;&gt;moe_32_expert_8</title>
<path fill="none" stroke="black" d="M1956,-27049.09C1964.7,-27039.74 1974.05,-27029.69 1982.61,-27020.49"/>
<polygon fill="black" stroke="black" points="1985.33,-27022.7 1989.58,-27012.99 1980.2,-27017.93 1985.33,-27022.7"/>
</g>
<!-- moe_32_expert_9 -->
<g id="node670" class="node">
<title>moe_32_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-27012.81 2140,-27012.81 2140,-26960.81 2358,-26960.81 2358,-27012.81"/>
<text text-anchor="middle" x="2249" y="-27000.81" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-26989.81" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-26978.81" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-26967.81" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_32_route&#45;&gt;moe_32_expert_9 -->
<g id="edge1090" class="edge">
<title>moe_32_route&#45;&gt;moe_32_expert_9</title>
<path fill="none" stroke="black" d="M2028.39,-27053.29C2069.12,-27041.2 2115.36,-27027.48 2154.95,-27015.73"/>
<polygon fill="black" stroke="black" points="2156.01,-27019.06 2164.6,-27012.86 2154.01,-27012.35 2156.01,-27019.06"/>
</g>
<!-- moe_32_expert_10 -->
<g id="node671" class="node">
<title>moe_32_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-27012.81 2376,-27012.81 2376,-26960.81 2594,-26960.81 2594,-27012.81"/>
<text text-anchor="middle" x="2485" y="-27000.81" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-26989.81" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-26978.81" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-26967.81" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_32_route&#45;&gt;moe_32_expert_10 -->
<g id="edge1091" class="edge">
<title>moe_32_route&#45;&gt;moe_32_expert_10</title>
<path fill="none" stroke="black" d="M2083.11,-27060.62C2164.97,-27047.9 2266.39,-27031.42 2365.82,-27013"/>
<polygon fill="black" stroke="black" points="2366.56,-27016.42 2375.75,-27011.15 2365.27,-27009.54 2366.56,-27016.42"/>
</g>
<!-- moe_32_expert_11 -->
<g id="node672" class="node">
<title>moe_32_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-27012.81 2612,-27012.81 2612,-26960.81 2830,-26960.81 2830,-27012.81"/>
<text text-anchor="middle" x="2721" y="-27000.81" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-26989.81" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-26978.81" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-26967.81" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_32_route&#45;&gt;moe_32_expert_11 -->
<g id="edge1092" class="edge">
<title>moe_32_route&#45;&gt;moe_32_expert_11</title>
<path fill="none" stroke="black" d="M2118.63,-27069.34C2252.23,-27057.64 2433.37,-27039.24 2601.74,-27012.94"/>
<polygon fill="black" stroke="black" points="2602.45,-27016.37 2611.78,-27011.36 2601.36,-27009.46 2602.45,-27016.37"/>
</g>
<!-- moe_32_expert_12 -->
<g id="node673" class="node">
<title>moe_32_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-27012.81 2848,-27012.81 2848,-26960.81 3066,-26960.81 3066,-27012.81"/>
<text text-anchor="middle" x="2957" y="-27000.81" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-26989.81" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-26978.81" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-26967.81" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_32_route&#45;&gt;moe_32_expert_12 -->
<g id="edge1093" class="edge">
<title>moe_32_route&#45;&gt;moe_32_expert_12</title>
<path fill="none" stroke="black" d="M2133.51,-27075.9C2317.18,-27066.5 2590.83,-27048.08 2837.55,-27012.94"/>
<polygon fill="black" stroke="black" points="2838.4,-27016.35 2847.8,-27011.47 2837.4,-27009.42 2838.4,-27016.35"/>
</g>
<!-- moe_32_expert_13 -->
<g id="node674" class="node">
<title>moe_32_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-27012.81 3084,-27012.81 3084,-26960.81 3302,-26960.81 3302,-27012.81"/>
<text text-anchor="middle" x="3193" y="-27000.81" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-26989.81" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-26978.81" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-26967.81" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_32_route&#45;&gt;moe_32_expert_13 -->
<g id="edge1094" class="edge">
<title>moe_32_route&#45;&gt;moe_32_expert_13</title>
<path fill="none" stroke="black" d="M2138.9,-27080.56C2368.7,-27074.11 2742.85,-27057.38 3073.54,-27012.92"/>
<polygon fill="black" stroke="black" points="3074.37,-27016.34 3083.81,-27011.53 3073.43,-27009.4 3074.37,-27016.34"/>
</g>
<!-- moe_32_expert_14 -->
<g id="node675" class="node">
<title>moe_32_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-27012.81 3320,-27012.81 3320,-26960.81 3538,-26960.81 3538,-27012.81"/>
<text text-anchor="middle" x="3429" y="-27000.81" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-26989.81" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-26978.81" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-26967.81" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_32_route&#45;&gt;moe_32_expert_14 -->
<g id="edge1095" class="edge">
<title>moe_32_route&#45;&gt;moe_32_expert_14</title>
<path fill="none" stroke="black" d="M2140.63,-27083.87C2412.52,-27080.59 2891.84,-27066.9 3309.64,-27012.89"/>
<polygon fill="black" stroke="black" points="3310.35,-27016.33 3319.81,-27011.57 3309.44,-27009.39 3310.35,-27016.33"/>
</g>
<!-- moe_32_expert_15 -->
<g id="node676" class="node">
<title>moe_32_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-27012.81 3556,-27012.81 3556,-26960.81 3774,-26960.81 3774,-27012.81"/>
<text text-anchor="middle" x="3665" y="-27000.81" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-26989.81" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-26978.81" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-26967.81" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_32_route&#45;&gt;moe_32_expert_15 -->
<g id="edge1096" class="edge">
<title>moe_32_route&#45;&gt;moe_32_expert_15</title>
<path fill="none" stroke="black" d="M2138.14,-27079.47C2510.69,-27069.9 3262.4,-27047.19 3545.54,-27012.88"/>
<polygon fill="black" stroke="black" points="3546.32,-27016.31 3555.82,-27011.6 3545.46,-27009.36 3546.32,-27016.31"/>
</g>
<!-- moe_32_aggregate -->
<g id="node677" class="node">
<title>moe_32_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-26888.04" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-26902.04" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1895" y="-26891.04" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-26880.04" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1895" y="-26869.04" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_32_expert_0&#45;&gt;moe_32_aggregate -->
<g id="edge1097" class="edge">
<title>moe_32_expert_0&#45;&gt;moe_32_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-26962.01C237.15,-26961.58 240.09,-26961.18 243,-26960.81 510.74,-26926.87 1276.32,-26904.07 1664.04,-26894.35"/>
<polygon fill="black" stroke="black" points="1664.35,-26897.85 1674.26,-26894.1 1664.17,-26890.85 1664.35,-26897.85"/>
</g>
<!-- moe_32_expert_1&#45;&gt;moe_32_aggregate -->
<g id="edge1098" class="edge">
<title>moe_32_expert_1&#45;&gt;moe_32_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-26962.04C473.15,-26961.6 476.09,-26961.19 479,-26960.81 892.79,-26906.83 1379.51,-26892.87 1661.11,-26889.6"/>
<polygon fill="black" stroke="black" points="1661.49,-26893.09 1671.45,-26889.48 1661.41,-26886.09 1661.49,-26893.09"/>
</g>
<!-- moe_32_expert_2&#45;&gt;moe_32_aggregate -->
<g id="edge1099" class="edge">
<title>moe_32_expert_2&#45;&gt;moe_32_aggregate</title>
<path fill="none" stroke="black" d="M706.19,-26962.08C709.15,-26961.63 712.09,-26961.2 715,-26960.81 1042.31,-26916.43 1424.45,-26899.48 1663.11,-26893.02"/>
<polygon fill="black" stroke="black" points="1663.4,-26896.51 1673.31,-26892.75 1663.22,-26889.51 1663.4,-26896.51"/>
</g>
<!-- moe_32_expert_3&#45;&gt;moe_32_aggregate -->
<g id="edge1100" class="edge">
<title>moe_32_expert_3&#45;&gt;moe_32_aggregate</title>
<path fill="none" stroke="black" d="M942.2,-26962.14C945.16,-26961.67 948.1,-26961.22 951,-26960.81 1194.76,-26925.88 1476.52,-26907.25 1668.32,-26897.81"/>
<polygon fill="black" stroke="black" points="1668.71,-26901.29 1678.53,-26897.31 1668.37,-26894.3 1668.71,-26901.29"/>
</g>
<!-- moe_32_expert_4&#45;&gt;moe_32_aggregate -->
<g id="edge1101" class="edge">
<title>moe_32_expert_4&#45;&gt;moe_32_aggregate</title>
<path fill="none" stroke="black" d="M1178.21,-26962.24C1181.17,-26961.74 1184.1,-26961.26 1187,-26960.81 1352.7,-26934.93 1541.73,-26916.32 1682.77,-26904.54"/>
<polygon fill="black" stroke="black" points="1683.17,-26908.02 1692.84,-26903.71 1682.59,-26901.05 1683.17,-26908.02"/>
</g>
<!-- moe_32_expert_5&#45;&gt;moe_32_aggregate -->
<g id="edge1102" class="edge">
<title>moe_32_expert_5&#45;&gt;moe_32_aggregate</title>
<path fill="none" stroke="black" d="M1414.25,-26962.43C1417.19,-26961.87 1420.12,-26961.33 1423,-26960.81 1519.58,-26943.25 1627.83,-26926.57 1716.27,-26913.73"/>
<polygon fill="black" stroke="black" points="1717.01,-26917.16 1726.4,-26912.26 1716,-26910.23 1717.01,-26917.16"/>
</g>
<!-- moe_32_expert_6&#45;&gt;moe_32_aggregate -->
<g id="edge1103" class="edge">
<title>moe_32_expert_6&#45;&gt;moe_32_aggregate</title>
<path fill="none" stroke="black" d="M1632.62,-26960.76C1675.27,-26949.1 1726.62,-26935.07 1772.54,-26922.51"/>
<polygon fill="black" stroke="black" points="1773.53,-26925.87 1782.25,-26919.86 1771.68,-26919.12 1773.53,-26925.87"/>
</g>
<!-- moe_32_expert_7&#45;&gt;moe_32_aggregate -->
<g id="edge1104" class="edge">
<title>moe_32_expert_7&#45;&gt;moe_32_aggregate</title>
<path fill="none" stroke="black" d="M1807.7,-26960.63C1818.79,-26951.54 1831.63,-26941.01 1843.99,-26930.87"/>
<polygon fill="black" stroke="black" points="1846.51,-26933.33 1852.02,-26924.28 1842.07,-26927.92 1846.51,-26933.33"/>
</g>
<!-- moe_32_expert_8&#45;&gt;moe_32_aggregate -->
<g id="edge1105" class="edge">
<title>moe_32_expert_8&#45;&gt;moe_32_aggregate</title>
<path fill="none" stroke="black" d="M1982.3,-26960.63C1971.21,-26951.54 1958.37,-26941.01 1946.01,-26930.87"/>
<polygon fill="black" stroke="black" points="1947.93,-26927.92 1937.98,-26924.28 1943.49,-26933.33 1947.93,-26927.92"/>
</g>
<!-- moe_32_expert_9&#45;&gt;moe_32_aggregate -->
<g id="edge1106" class="edge">
<title>moe_32_expert_9&#45;&gt;moe_32_aggregate</title>
<path fill="none" stroke="black" d="M2157.38,-26960.76C2114.73,-26949.1 2063.38,-26935.07 2017.46,-26922.51"/>
<polygon fill="black" stroke="black" points="2018.32,-26919.12 2007.75,-26919.86 2016.47,-26925.87 2018.32,-26919.12"/>
</g>
<!-- moe_32_expert_10&#45;&gt;moe_32_aggregate -->
<g id="edge1107" class="edge">
<title>moe_32_expert_10&#45;&gt;moe_32_aggregate</title>
<path fill="none" stroke="black" d="M2375.75,-26962.43C2372.81,-26961.87 2369.88,-26961.33 2367,-26960.81 2270.42,-26943.25 2162.17,-26926.57 2073.73,-26913.73"/>
<polygon fill="black" stroke="black" points="2074,-26910.23 2063.6,-26912.26 2072.99,-26917.16 2074,-26910.23"/>
</g>
<!-- moe_32_expert_11&#45;&gt;moe_32_aggregate -->
<g id="edge1108" class="edge">
<title>moe_32_expert_11&#45;&gt;moe_32_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-26962.24C2608.83,-26961.74 2605.9,-26961.26 2603,-26960.81 2437.3,-26934.93 2248.27,-26916.32 2107.23,-26904.54"/>
<polygon fill="black" stroke="black" points="2107.41,-26901.05 2097.16,-26903.71 2106.83,-26908.02 2107.41,-26901.05"/>
</g>
<!-- moe_32_expert_12&#45;&gt;moe_32_aggregate -->
<g id="edge1109" class="edge">
<title>moe_32_expert_12&#45;&gt;moe_32_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-26962.14C2844.84,-26961.67 2841.9,-26961.22 2839,-26960.81 2595.24,-26925.88 2313.48,-26907.25 2121.68,-26897.81"/>
<polygon fill="black" stroke="black" points="2121.63,-26894.3 2111.47,-26897.31 2121.29,-26901.29 2121.63,-26894.3"/>
</g>
<!-- moe_32_expert_13&#45;&gt;moe_32_aggregate -->
<g id="edge1110" class="edge">
<title>moe_32_expert_13&#45;&gt;moe_32_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-26962.08C3080.85,-26961.63 3077.91,-26961.2 3075,-26960.81 2747.69,-26916.43 2365.55,-26899.48 2126.89,-26893.02"/>
<polygon fill="black" stroke="black" points="2126.78,-26889.51 2116.69,-26892.75 2126.6,-26896.51 2126.78,-26889.51"/>
</g>
<!-- moe_32_expert_14&#45;&gt;moe_32_aggregate -->
<g id="edge1111" class="edge">
<title>moe_32_expert_14&#45;&gt;moe_32_aggregate</title>
<path fill="none" stroke="black" d="M3319.81,-26962.04C3316.85,-26961.6 3313.91,-26961.19 3311,-26960.81 2897.21,-26906.83 2410.49,-26892.87 2128.89,-26889.6"/>
<polygon fill="black" stroke="black" points="2128.59,-26886.09 2118.55,-26889.48 2128.51,-26893.09 2128.59,-26886.09"/>
</g>
<!-- moe_32_expert_15&#45;&gt;moe_32_aggregate -->
<g id="edge1112" class="edge">
<title>moe_32_expert_15&#45;&gt;moe_32_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-26962.01C3552.85,-26961.58 3549.91,-26961.18 3547,-26960.81 3279.26,-26926.87 2513.68,-26904.07 2125.96,-26894.35"/>
<polygon fill="black" stroke="black" points="2125.83,-26890.85 2115.74,-26894.1 2125.65,-26897.85 2125.83,-26890.85"/>
</g>
<!-- moe_32_ffn -->
<g id="node678" class="node">
<title>moe_32_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2053,-26815.27 1737,-26815.27 1737,-26763.27 2053,-26763.27 2053,-26815.27"/>
<text text-anchor="middle" x="1895" y="-26803.27" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1895" y="-26792.27" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-26781.27" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-26770.27" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_32_aggregate&#45;&gt;moe_32_ffn -->
<g id="edge1113" class="edge">
<title>moe_32_aggregate&#45;&gt;moe_32_ffn</title>
<path fill="none" stroke="black" d="M1895,-26851C1895,-26842.69 1895,-26833.86 1895,-26825.58"/>
<polygon fill="black" stroke="black" points="1898.5,-26825.46 1895,-26815.46 1891.5,-26825.46 1898.5,-26825.46"/>
</g>
<!-- moe_32_res2 -->
<g id="node680" class="node">
<title>moe_32_res2</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-26727.27 1695.97,-26727.27 1558.11,-26623.27 2094.03,-26623.27 2231.89,-26727.27"/>
<text text-anchor="middle" x="1895" y="-26689.27" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1895" y="-26678.27" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-26667.27" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-26656.27" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_32_ffn&#45;&gt;moe_32_res2 -->
<g id="edge1114" class="edge">
<title>moe_32_ffn&#45;&gt;moe_32_res2</title>
<path fill="none" stroke="black" d="M1895,-26763.13C1895,-26755.45 1895,-26746.64 1895,-26737.64"/>
<polygon fill="black" stroke="black" points="1898.5,-26737.45 1895,-26727.45 1891.5,-26737.45 1898.5,-26737.45"/>
</g>
<!-- moe_32_res1&#45;&gt;moe_32_gate -->
<g id="edge1079" class="edge">
<title>moe_32_res1&#45;&gt;moe_32_gate</title>
<path fill="none" stroke="black" d="M1923,-27297.96C1923,-27289.79 1923,-27281.26 1923,-27272.89"/>
<polygon fill="black" stroke="black" points="1926.5,-27272.78 1923,-27262.78 1919.5,-27272.78 1926.5,-27272.78"/>
</g>
<!-- moe_33_mha -->
<g id="node681" class="node">
<title>moe_33_mha</title>
<polygon fill="lightgreen" stroke="black" points="2053,-26576.27 1737,-26576.27 1737,-26524.27 2053,-26524.27 2053,-26576.27"/>
<text text-anchor="middle" x="1895" y="-26564.27" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1895" y="-26553.27" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-26542.27" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-26531.27" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_32_res2&#45;&gt;moe_33_mha -->
<g id="edge1115" class="edge">
<title>moe_32_res2&#45;&gt;moe_33_mha</title>
<path fill="none" stroke="black" d="M1895,-26623.17C1895,-26610.84 1895,-26597.94 1895,-26586.52"/>
<polygon fill="black" stroke="black" points="1898.5,-26586.51 1895,-26576.51 1891.5,-26586.51 1898.5,-26586.51"/>
</g>
<!-- moe_33_res1 -->
<g id="node702" class="node">
<title>moe_33_res1</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-26488.27 1695.97,-26488.27 1558.11,-26384.27 2094.03,-26384.27 2231.89,-26488.27"/>
<text text-anchor="middle" x="1895" y="-26450.27" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1895" y="-26439.27" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-26428.27" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-26417.27" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_33_mha&#45;&gt;moe_33_res1 -->
<g id="edge1116" class="edge">
<title>moe_33_mha&#45;&gt;moe_33_res1</title>
<path fill="none" stroke="black" d="M1895,-26524.13C1895,-26516.45 1895,-26507.64 1895,-26498.64"/>
<polygon fill="black" stroke="black" points="1898.5,-26498.45 1895,-26488.45 1891.5,-26498.45 1898.5,-26498.45"/>
</g>
<!-- moe_33_gate -->
<g id="node682" class="node">
<title>moe_33_gate</title>
<polygon fill="lightyellow" stroke="black" points="2223.8,-26348.27 1700.75,-26348.27 1566.2,-26244.27 2089.25,-26244.27 2223.8,-26348.27"/>
<text text-anchor="middle" x="1895" y="-26310.27" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1895" y="-26299.27" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-26288.27" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-26277.27" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_33_route -->
<g id="node683" class="node">
<title>moe_33_route</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-26171.5" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-26185.5" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1895" y="-26174.5" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-26163.5" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-26152.5" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_33_gate&#45;&gt;moe_33_route -->
<g id="edge1118" class="edge">
<title>moe_33_gate&#45;&gt;moe_33_route</title>
<path fill="none" stroke="black" d="M1895,-26243.91C1895,-26235.51 1895,-26226.84 1895,-26218.57"/>
<polygon fill="black" stroke="black" points="1898.5,-26218.35 1895,-26208.35 1891.5,-26218.35 1898.5,-26218.35"/>
</g>
<!-- moe_33_expert_0 -->
<g id="node684" class="node">
<title>moe_33_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-26098.73 16,-26098.73 16,-26046.73 234,-26046.73 234,-26098.73"/>
<text text-anchor="middle" x="125" y="-26086.73" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-26075.73" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-26064.73" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-26053.73" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_33_route&#45;&gt;moe_33_expert_0 -->
<g id="edge1119" class="edge">
<title>moe_33_route&#45;&gt;moe_33_expert_0</title>
<path fill="none" stroke="black" d="M1679.93,-26165.58C1302.11,-26156.21 532.75,-26133.68 244.24,-26098.77"/>
<polygon fill="black" stroke="black" points="244.54,-26095.28 234.18,-26097.52 243.68,-26102.23 244.54,-26095.28"/>
</g>
<!-- moe_33_expert_1 -->
<g id="node685" class="node">
<title>moe_33_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-26098.73 252,-26098.73 252,-26046.73 470,-26046.73 470,-26098.73"/>
<text text-anchor="middle" x="361" y="-26086.73" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-26075.73" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-26064.73" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-26053.73" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_33_route&#45;&gt;moe_33_expert_1 -->
<g id="edge1120" class="edge">
<title>moe_33_route&#45;&gt;moe_33_expert_1</title>
<path fill="none" stroke="black" d="M1677.23,-26170.12C1400.57,-26167.21 908.56,-26153.96 480.29,-26098.81"/>
<polygon fill="black" stroke="black" points="480.55,-26095.31 470.19,-26097.5 479.65,-26102.25 480.55,-26095.31"/>
</g>
<!-- moe_33_expert_2 -->
<g id="node686" class="node">
<title>moe_33_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-26098.73 488,-26098.73 488,-26046.73 706,-26046.73 706,-26098.73"/>
<text text-anchor="middle" x="597" y="-26086.73" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-26075.73" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-26064.73" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-26053.73" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_33_route&#45;&gt;moe_33_expert_2 -->
<g id="edge1121" class="edge">
<title>moe_33_route&#45;&gt;moe_33_expert_2</title>
<path fill="none" stroke="black" d="M1678.74,-26166.93C1443.7,-26160.85 1057.2,-26144.41 716.26,-26098.81"/>
<polygon fill="black" stroke="black" points="716.57,-26095.32 706.19,-26097.46 715.63,-26102.26 716.57,-26095.32"/>
</g>
<!-- moe_33_expert_3 -->
<g id="node687" class="node">
<title>moe_33_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-26098.73 724,-26098.73 724,-26046.73 942,-26046.73 942,-26098.73"/>
<text text-anchor="middle" x="833" y="-26086.73" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-26075.73" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-26064.73" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-26053.73" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_33_route&#45;&gt;moe_33_expert_3 -->
<g id="edge1122" class="edge">
<title>moe_33_route&#45;&gt;moe_33_expert_3</title>
<path fill="none" stroke="black" d="M1683.7,-26162.47C1494.33,-26153.4 1209,-26135.1 952.47,-26098.86"/>
<polygon fill="black" stroke="black" points="952.59,-26095.34 942.2,-26097.4 951.61,-26102.27 952.59,-26095.34"/>
</g>
<!-- moe_33_expert_4 -->
<g id="node688" class="node">
<title>moe_33_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-26098.73 960,-26098.73 960,-26046.73 1178,-26046.73 1178,-26098.73"/>
<text text-anchor="middle" x="1069" y="-26086.73" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-26075.73" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-26064.73" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-26053.73" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_33_route&#45;&gt;moe_33_expert_4 -->
<g id="edge1123" class="edge">
<title>moe_33_route&#45;&gt;moe_33_expert_4</title>
<path fill="none" stroke="black" d="M1696.66,-26156.15C1556.96,-26144.66 1365.46,-26126.16 1188.25,-26098.86"/>
<polygon fill="black" stroke="black" points="1188.63,-26095.38 1178.21,-26097.3 1187.56,-26102.29 1188.63,-26095.38"/>
</g>
<!-- moe_33_expert_5 -->
<g id="node689" class="node">
<title>moe_33_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-26098.73 1196,-26098.73 1196,-26046.73 1414,-26046.73 1414,-26098.73"/>
<text text-anchor="middle" x="1305" y="-26086.73" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-26075.73" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-26064.73" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-26053.73" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_33_route&#45;&gt;moe_33_expert_5 -->
<g id="edge1124" class="edge">
<title>moe_33_route&#45;&gt;moe_33_expert_5</title>
<path fill="none" stroke="black" d="M1728.87,-26147.64C1640.99,-26134.96 1531.11,-26118.18 1424.25,-26098.92"/>
<polygon fill="black" stroke="black" points="1424.71,-26095.45 1414.25,-26097.11 1423.46,-26102.33 1424.71,-26095.45"/>
</g>
<!-- moe_33_expert_6 -->
<g id="node690" class="node">
<title>moe_33_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-26098.73 1432,-26098.73 1432,-26046.73 1650,-26046.73 1650,-26098.73"/>
<text text-anchor="middle" x="1541" y="-26086.73" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-26075.73" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-26064.73" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-26053.73" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_33_route&#45;&gt;moe_33_expert_6 -->
<g id="edge1125" class="edge">
<title>moe_33_route&#45;&gt;moe_33_expert_6</title>
<path fill="none" stroke="black" d="M1782.99,-26139.88C1737.98,-26127.58 1686.47,-26113.49 1642.56,-26101.49"/>
<polygon fill="black" stroke="black" points="1643.31,-26098.07 1632.74,-26098.81 1641.46,-26104.82 1643.31,-26098.07"/>
</g>
<!-- moe_33_expert_7 -->
<g id="node691" class="node">
<title>moe_33_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-26098.73 1668,-26098.73 1668,-26046.73 1886,-26046.73 1886,-26098.73"/>
<text text-anchor="middle" x="1777" y="-26086.73" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-26075.73" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-26064.73" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-26053.73" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_33_route&#45;&gt;moe_33_expert_7 -->
<g id="edge1126" class="edge">
<title>moe_33_route&#45;&gt;moe_33_expert_7</title>
<path fill="none" stroke="black" d="M1852.07,-26135.29C1840.07,-26125.45 1827.12,-26114.83 1815.41,-26105.23"/>
<polygon fill="black" stroke="black" points="1817.47,-26102.39 1807.52,-26098.76 1813.04,-26107.81 1817.47,-26102.39"/>
</g>
<!-- moe_33_expert_8 -->
<g id="node692" class="node">
<title>moe_33_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-26098.73 1904,-26098.73 1904,-26046.73 2122,-26046.73 2122,-26098.73"/>
<text text-anchor="middle" x="2013" y="-26086.73" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-26075.73" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-26064.73" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-26053.73" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_33_route&#45;&gt;moe_33_expert_8 -->
<g id="edge1127" class="edge">
<title>moe_33_route&#45;&gt;moe_33_expert_8</title>
<path fill="none" stroke="black" d="M1937.93,-26135.29C1949.93,-26125.45 1962.88,-26114.83 1974.59,-26105.23"/>
<polygon fill="black" stroke="black" points="1976.96,-26107.81 1982.48,-26098.76 1972.53,-26102.39 1976.96,-26107.81"/>
</g>
<!-- moe_33_expert_9 -->
<g id="node693" class="node">
<title>moe_33_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-26098.73 2140,-26098.73 2140,-26046.73 2358,-26046.73 2358,-26098.73"/>
<text text-anchor="middle" x="2249" y="-26086.73" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-26075.73" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-26064.73" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-26053.73" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_33_route&#45;&gt;moe_33_expert_9 -->
<g id="edge1128" class="edge">
<title>moe_33_route&#45;&gt;moe_33_expert_9</title>
<path fill="none" stroke="black" d="M2007.01,-26139.88C2052.02,-26127.58 2103.53,-26113.49 2147.44,-26101.49"/>
<polygon fill="black" stroke="black" points="2148.54,-26104.82 2157.26,-26098.81 2146.69,-26098.07 2148.54,-26104.82"/>
</g>
<!-- moe_33_expert_10 -->
<g id="node694" class="node">
<title>moe_33_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-26098.73 2376,-26098.73 2376,-26046.73 2594,-26046.73 2594,-26098.73"/>
<text text-anchor="middle" x="2485" y="-26086.73" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-26075.73" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-26064.73" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-26053.73" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_33_route&#45;&gt;moe_33_expert_10 -->
<g id="edge1129" class="edge">
<title>moe_33_route&#45;&gt;moe_33_expert_10</title>
<path fill="none" stroke="black" d="M2061.13,-26147.64C2149.01,-26134.96 2258.89,-26118.18 2365.75,-26098.92"/>
<polygon fill="black" stroke="black" points="2366.54,-26102.33 2375.75,-26097.11 2365.29,-26095.45 2366.54,-26102.33"/>
</g>
<!-- moe_33_expert_11 -->
<g id="node695" class="node">
<title>moe_33_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-26098.73 2612,-26098.73 2612,-26046.73 2830,-26046.73 2830,-26098.73"/>
<text text-anchor="middle" x="2721" y="-26086.73" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-26075.73" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-26064.73" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-26053.73" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_33_route&#45;&gt;moe_33_expert_11 -->
<g id="edge1130" class="edge">
<title>moe_33_route&#45;&gt;moe_33_expert_11</title>
<path fill="none" stroke="black" d="M2093.34,-26156.15C2233.04,-26144.66 2424.54,-26126.16 2601.75,-26098.86"/>
<polygon fill="black" stroke="black" points="2602.44,-26102.29 2611.79,-26097.3 2601.37,-26095.38 2602.44,-26102.29"/>
</g>
<!-- moe_33_expert_12 -->
<g id="node696" class="node">
<title>moe_33_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-26098.73 2848,-26098.73 2848,-26046.73 3066,-26046.73 3066,-26098.73"/>
<text text-anchor="middle" x="2957" y="-26086.73" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-26075.73" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-26064.73" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-26053.73" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_33_route&#45;&gt;moe_33_expert_12 -->
<g id="edge1131" class="edge">
<title>moe_33_route&#45;&gt;moe_33_expert_12</title>
<path fill="none" stroke="black" d="M2106.3,-26162.47C2295.67,-26153.4 2581,-26135.1 2837.53,-26098.86"/>
<polygon fill="black" stroke="black" points="2838.39,-26102.27 2847.8,-26097.4 2837.41,-26095.34 2838.39,-26102.27"/>
</g>
<!-- moe_33_expert_13 -->
<g id="node697" class="node">
<title>moe_33_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-26098.73 3084,-26098.73 3084,-26046.73 3302,-26046.73 3302,-26098.73"/>
<text text-anchor="middle" x="3193" y="-26086.73" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-26075.73" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-26064.73" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-26053.73" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_33_route&#45;&gt;moe_33_expert_13 -->
<g id="edge1132" class="edge">
<title>moe_33_route&#45;&gt;moe_33_expert_13</title>
<path fill="none" stroke="black" d="M2111.26,-26166.93C2346.3,-26160.85 2732.8,-26144.41 3073.74,-26098.81"/>
<polygon fill="black" stroke="black" points="3074.37,-26102.26 3083.81,-26097.46 3073.43,-26095.32 3074.37,-26102.26"/>
</g>
<!-- moe_33_expert_14 -->
<g id="node698" class="node">
<title>moe_33_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-26098.73 3320,-26098.73 3320,-26046.73 3538,-26046.73 3538,-26098.73"/>
<text text-anchor="middle" x="3429" y="-26086.73" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-26075.73" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-26064.73" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-26053.73" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_33_route&#45;&gt;moe_33_expert_14 -->
<g id="edge1133" class="edge">
<title>moe_33_route&#45;&gt;moe_33_expert_14</title>
<path fill="none" stroke="black" d="M2112.77,-26170.12C2389.43,-26167.21 2881.44,-26153.96 3309.71,-26098.81"/>
<polygon fill="black" stroke="black" points="3310.35,-26102.25 3319.81,-26097.5 3309.45,-26095.31 3310.35,-26102.25"/>
</g>
<!-- moe_33_expert_15 -->
<g id="node699" class="node">
<title>moe_33_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-26098.73 3556,-26098.73 3556,-26046.73 3774,-26046.73 3774,-26098.73"/>
<text text-anchor="middle" x="3665" y="-26086.73" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-26075.73" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-26064.73" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-26053.73" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_33_route&#45;&gt;moe_33_expert_15 -->
<g id="edge1134" class="edge">
<title>moe_33_route&#45;&gt;moe_33_expert_15</title>
<path fill="none" stroke="black" d="M2110.07,-26165.58C2487.89,-26156.21 3257.25,-26133.68 3545.76,-26098.77"/>
<polygon fill="black" stroke="black" points="3546.32,-26102.23 3555.82,-26097.52 3545.46,-26095.28 3546.32,-26102.23"/>
</g>
<!-- moe_33_aggregate -->
<g id="node700" class="node">
<title>moe_33_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1779" cy="-25973.96" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1779" y="-25987.96" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1779" y="-25976.96" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1779" y="-25965.96" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1779" y="-25954.96" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_33_expert_0&#45;&gt;moe_33_aggregate -->
<g id="edge1135" class="edge">
<title>moe_33_expert_0&#45;&gt;moe_33_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-26047.95C237.15,-26047.51 240.09,-26047.1 243,-26046.73 488.52,-26015.2 1184.39,-25991.69 1549.28,-25981.12"/>
<polygon fill="black" stroke="black" points="1549.54,-25984.62 1559.44,-25980.83 1549.34,-25977.62 1549.54,-25984.62"/>
</g>
<!-- moe_33_expert_1&#45;&gt;moe_33_aggregate -->
<g id="edge1136" class="edge">
<title>moe_33_expert_1&#45;&gt;moe_33_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-26047.98C473.15,-26047.53 476.09,-26047.11 479,-26046.73 849.93,-25997.49 1284.72,-25981.92 1545.69,-25977.07"/>
<polygon fill="black" stroke="black" points="1546.12,-25980.56 1556.06,-25976.88 1545.99,-25973.56 1546.12,-25980.56"/>
</g>
<!-- moe_33_expert_2&#45;&gt;moe_33_aggregate -->
<g id="edge1137" class="edge">
<title>moe_33_expert_2&#45;&gt;moe_33_aggregate</title>
<path fill="none" stroke="black" d="M706.2,-26048.03C709.16,-26047.57 712.1,-26047.13 715,-26046.73 1000.78,-26007.02 1332.91,-25989.06 1549.06,-25981.09"/>
<polygon fill="black" stroke="black" points="1549.4,-25984.58 1559.27,-25980.71 1549.15,-25977.58 1549.4,-25984.58"/>
</g>
<!-- moe_33_expert_3&#45;&gt;moe_33_aggregate -->
<g id="edge1138" class="edge">
<title>moe_33_expert_3&#45;&gt;moe_33_aggregate</title>
<path fill="none" stroke="black" d="M942.21,-26048.1C945.16,-26047.62 948.1,-26047.16 951,-26046.73 1155.55,-26016.31 1390.59,-25997.46 1557.86,-25986.75"/>
<polygon fill="black" stroke="black" points="1558.27,-25990.23 1568.03,-25986.11 1557.83,-25983.25 1558.27,-25990.23"/>
</g>
<!-- moe_33_expert_4&#45;&gt;moe_33_aggregate -->
<g id="edge1139" class="edge">
<title>moe_33_expert_4&#45;&gt;moe_33_aggregate</title>
<path fill="none" stroke="black" d="M1178.23,-26048.23C1181.18,-26047.71 1184.11,-26047.21 1187,-26046.73 1317.25,-26025.08 1464.65,-26007.19 1579.78,-25994.68"/>
<polygon fill="black" stroke="black" points="1580.2,-25998.16 1589.76,-25993.61 1579.45,-25991.2 1580.2,-25998.16"/>
</g>
<!-- moe_33_expert_5&#45;&gt;moe_33_aggregate -->
<g id="edge1140" class="edge">
<title>moe_33_expert_5&#45;&gt;moe_33_aggregate</title>
<path fill="none" stroke="black" d="M1414.28,-26048.54C1417.22,-26047.93 1420.13,-26047.32 1423,-26046.73 1490.69,-26032.74 1565.7,-26017.56 1629.34,-26004.79"/>
<polygon fill="black" stroke="black" points="1630.33,-26008.16 1639.45,-26002.76 1628.96,-26001.3 1630.33,-26008.16"/>
</g>
<!-- moe_33_expert_6&#45;&gt;moe_33_aggregate -->
<g id="edge1141" class="edge">
<title>moe_33_expert_6&#45;&gt;moe_33_aggregate</title>
<path fill="none" stroke="black" d="M1602.6,-26046.68C1628.46,-26036.17 1659.08,-26023.72 1687.49,-26012.17"/>
<polygon fill="black" stroke="black" points="1689.08,-26015.3 1697.03,-26008.29 1686.45,-26008.81 1689.08,-26015.3"/>
</g>
<!-- moe_33_expert_7&#45;&gt;moe_33_aggregate -->
<g id="edge1142" class="edge">
<title>moe_33_expert_7&#45;&gt;moe_33_aggregate</title>
<path fill="none" stroke="black" d="M1777.52,-26046.56C1777.68,-26038.75 1777.86,-26029.88 1778.05,-26021.11"/>
<polygon fill="black" stroke="black" points="1781.55,-26021.01 1778.26,-26010.94 1774.55,-26020.86 1781.55,-26021.01"/>
</g>
<!-- moe_33_expert_8&#45;&gt;moe_33_aggregate -->
<g id="edge1143" class="edge">
<title>moe_33_expert_8&#45;&gt;moe_33_aggregate</title>
<path fill="none" stroke="black" d="M1952.43,-26046.68C1927.01,-26036.17 1896.9,-26023.72 1868.97,-26012.17"/>
<polygon fill="black" stroke="black" points="1870.17,-26008.88 1859.59,-26008.29 1867.5,-26015.34 1870.17,-26008.88"/>
</g>
<!-- moe_33_expert_9&#45;&gt;moe_33_aggregate -->
<g id="edge1144" class="edge">
<title>moe_33_expert_9&#45;&gt;moe_33_aggregate</title>
<path fill="none" stroke="black" d="M2139.72,-26048.54C2136.78,-26047.93 2133.87,-26047.33 2131,-26046.73 2064.2,-26032.84 1990.21,-26017.72 1927.38,-26004.95"/>
<polygon fill="black" stroke="black" points="1927.89,-26001.48 1917.39,-26002.92 1926.49,-26008.34 1927.89,-26001.48"/>
</g>
<!-- moe_33_expert_10&#45;&gt;moe_33_aggregate -->
<g id="edge1145" class="edge">
<title>moe_33_expert_10&#45;&gt;moe_33_aggregate</title>
<path fill="none" stroke="black" d="M2375.77,-26048.24C2372.82,-26047.71 2369.89,-26047.21 2367,-26046.73 2238,-26025.23 2092.08,-26007.38 1977.87,-25994.86"/>
<polygon fill="black" stroke="black" points="1977.94,-25991.35 1967.62,-25993.74 1977.18,-25998.31 1977.94,-25991.35"/>
</g>
<!-- moe_33_expert_11&#45;&gt;moe_33_aggregate -->
<g id="edge1146" class="edge">
<title>moe_33_expert_11&#45;&gt;moe_33_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-26048.1C2608.84,-26047.62 2605.9,-26047.16 2603,-26046.73 2399.89,-26016.48 2166.57,-25997.63 2000.17,-25986.89"/>
<polygon fill="black" stroke="black" points="2000.01,-25983.37 1989.81,-25986.22 1999.56,-25990.35 2000.01,-25983.37"/>
</g>
<!-- moe_33_expert_12&#45;&gt;moe_33_aggregate -->
<g id="edge1147" class="edge">
<title>moe_33_expert_12&#45;&gt;moe_33_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-26048.03C2844.84,-26047.57 2841.9,-26047.13 2839,-26046.73 2554.63,-26007.18 2224.2,-25989.19 2008.84,-25981.17"/>
<polygon fill="black" stroke="black" points="2008.79,-25977.66 1998.67,-25980.79 2008.54,-25984.66 2008.79,-25977.66"/>
</g>
<!-- moe_33_expert_13&#45;&gt;moe_33_aggregate -->
<g id="edge1148" class="edge">
<title>moe_33_expert_13&#45;&gt;moe_33_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-26047.98C3080.85,-26047.53 3077.91,-26047.12 3075,-26046.73 2705.49,-25997.65 2272.4,-25982.03 2012.17,-25977.12"/>
<polygon fill="black" stroke="black" points="2011.9,-25973.62 2001.84,-25976.93 2011.77,-25980.62 2011.9,-25973.62"/>
</g>
<!-- moe_33_expert_14&#45;&gt;moe_33_aggregate -->
<g id="edge1149" class="edge">
<title>moe_33_expert_14&#45;&gt;moe_33_aggregate</title>
<path fill="none" stroke="black" d="M3319.82,-26047.95C3316.85,-26047.51 3313.91,-26047.1 3311,-26046.73 3066.28,-26015.28 2372.99,-25991.75 2008.86,-25981.16"/>
<polygon fill="black" stroke="black" points="2008.81,-25977.66 1998.71,-25980.86 2008.61,-25984.65 2008.81,-25977.66"/>
</g>
<!-- moe_33_expert_15&#45;&gt;moe_33_aggregate -->
<g id="edge1150" class="edge">
<title>moe_33_expert_15&#45;&gt;moe_33_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-26047.92C3552.85,-26047.49 3549.91,-26047.09 3547,-26046.73 3256.81,-26010.36 2420.23,-25988.39 2010.58,-25979.52"/>
<polygon fill="black" stroke="black" points="2010.46,-25976.01 2000.38,-25979.3 2010.31,-25983.01 2010.46,-25976.01"/>
</g>
<!-- moe_33_ffn -->
<g id="node701" class="node">
<title>moe_33_ffn</title>
<polygon fill="lightgreen" stroke="black" points="1937,-25901.19 1621,-25901.19 1621,-25849.19 1937,-25849.19 1937,-25901.19"/>
<text text-anchor="middle" x="1779" y="-25889.19" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1779" y="-25878.19" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1779" y="-25867.19" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1779" y="-25856.19" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_33_aggregate&#45;&gt;moe_33_ffn -->
<g id="edge1151" class="edge">
<title>moe_33_aggregate&#45;&gt;moe_33_ffn</title>
<path fill="none" stroke="black" d="M1779,-25936.93C1779,-25928.61 1779,-25919.78 1779,-25911.5"/>
<polygon fill="black" stroke="black" points="1782.5,-25911.39 1779,-25901.39 1775.5,-25911.39 1782.5,-25911.39"/>
</g>
<!-- moe_33_res2 -->
<g id="node703" class="node">
<title>moe_33_res2</title>
<polygon fill="lightyellow" stroke="black" points="2115.89,-25813.19 1579.97,-25813.19 1442.11,-25709.19 1978.03,-25709.19 2115.89,-25813.19"/>
<text text-anchor="middle" x="1779" y="-25775.19" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1779" y="-25764.19" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1779" y="-25753.19" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1779" y="-25742.19" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_33_ffn&#45;&gt;moe_33_res2 -->
<g id="edge1152" class="edge">
<title>moe_33_ffn&#45;&gt;moe_33_res2</title>
<path fill="none" stroke="black" d="M1779,-25849.05C1779,-25841.37 1779,-25832.56 1779,-25823.56"/>
<polygon fill="black" stroke="black" points="1782.5,-25823.37 1779,-25813.37 1775.5,-25823.37 1782.5,-25823.37"/>
</g>
<!-- moe_33_res1&#45;&gt;moe_33_gate -->
<g id="edge1117" class="edge">
<title>moe_33_res1&#45;&gt;moe_33_gate</title>
<path fill="none" stroke="black" d="M1895,-26383.88C1895,-26375.71 1895,-26367.18 1895,-26358.81"/>
<polygon fill="black" stroke="black" points="1898.5,-26358.7 1895,-26348.7 1891.5,-26358.7 1898.5,-26358.7"/>
</g>
<!-- moe_34_mha -->
<g id="node704" class="node">
<title>moe_34_mha</title>
<polygon fill="lightgreen" stroke="black" points="1937,-25662.19 1621,-25662.19 1621,-25610.19 1937,-25610.19 1937,-25662.19"/>
<text text-anchor="middle" x="1779" y="-25650.19" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1779" y="-25639.19" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1779" y="-25628.19" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1779" y="-25617.19" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_33_res2&#45;&gt;moe_34_mha -->
<g id="edge1153" class="edge">
<title>moe_33_res2&#45;&gt;moe_34_mha</title>
<path fill="none" stroke="black" d="M1779,-25709.1C1779,-25696.76 1779,-25683.86 1779,-25672.44"/>
<polygon fill="black" stroke="black" points="1782.5,-25672.43 1779,-25662.43 1775.5,-25672.43 1782.5,-25672.43"/>
</g>
<!-- moe_34_res1 -->
<g id="node725" class="node">
<title>moe_34_res1</title>
<polygon fill="lightyellow" stroke="black" points="2115.89,-25574.19 1579.97,-25574.19 1442.11,-25470.19 1978.03,-25470.19 2115.89,-25574.19"/>
<text text-anchor="middle" x="1779" y="-25536.19" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1779" y="-25525.19" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1779" y="-25514.19" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1779" y="-25503.19" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_34_mha&#45;&gt;moe_34_res1 -->
<g id="edge1154" class="edge">
<title>moe_34_mha&#45;&gt;moe_34_res1</title>
<path fill="none" stroke="black" d="M1779,-25610.05C1779,-25602.37 1779,-25593.56 1779,-25584.56"/>
<polygon fill="black" stroke="black" points="1782.5,-25584.37 1779,-25574.37 1775.5,-25584.37 1782.5,-25584.37"/>
</g>
<!-- moe_34_gate -->
<g id="node705" class="node">
<title>moe_34_gate</title>
<polygon fill="lightyellow" stroke="black" points="2107.8,-25434.19 1584.75,-25434.19 1450.2,-25330.19 1973.25,-25330.19 2107.8,-25434.19"/>
<text text-anchor="middle" x="1779" y="-25396.19" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1779" y="-25385.19" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1779" y="-25374.19" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1779" y="-25363.19" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_34_route -->
<g id="node706" class="node">
<title>moe_34_route</title>
<ellipse fill="lightblue" stroke="black" cx="1779" cy="-25257.42" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1779" y="-25271.42" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1779" y="-25260.42" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1779" y="-25249.42" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1779" y="-25238.42" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_34_gate&#45;&gt;moe_34_route -->
<g id="edge1156" class="edge">
<title>moe_34_gate&#45;&gt;moe_34_route</title>
<path fill="none" stroke="black" d="M1779,-25329.84C1779,-25321.43 1779,-25312.76 1779,-25304.49"/>
<polygon fill="black" stroke="black" points="1782.5,-25304.28 1779,-25294.28 1775.5,-25304.28 1782.5,-25304.28"/>
</g>
<!-- moe_34_expert_0 -->
<g id="node707" class="node">
<title>moe_34_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="236,-25184.65 18,-25184.65 18,-25132.65 236,-25132.65 236,-25184.65"/>
<text text-anchor="middle" x="127" y="-25172.65" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="127" y="-25161.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="127" y="-25150.65" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="127" y="-25139.65" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_34_route&#45;&gt;moe_34_expert_0 -->
<g id="edge1157" class="edge">
<title>moe_34_route&#45;&gt;moe_34_expert_0</title>
<path fill="none" stroke="black" d="M1564.77,-25250.69C1209.39,-25240.47 511.65,-25217.19 246.21,-25184.69"/>
<polygon fill="black" stroke="black" points="246.54,-25181.21 236.18,-25183.43 245.67,-25188.15 246.54,-25181.21"/>
</g>
<!-- moe_34_expert_1 -->
<g id="node708" class="node">
<title>moe_34_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="472,-25184.65 254,-25184.65 254,-25132.65 472,-25132.65 472,-25184.65"/>
<text text-anchor="middle" x="363" y="-25172.65" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="363" y="-25161.65" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="363" y="-25150.65" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="363" y="-25139.65" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_34_route&#45;&gt;moe_34_expert_1 -->
<g id="edge1158" class="edge">
<title>moe_34_route&#45;&gt;moe_34_expert_1</title>
<path fill="none" stroke="black" d="M1561.59,-25254.57C1305.22,-25250.07 866.4,-25235.08 482.11,-25184.71"/>
<polygon fill="black" stroke="black" points="482.56,-25181.24 472.19,-25183.4 481.64,-25188.18 482.56,-25181.24"/>
</g>
<!-- moe_34_expert_2 -->
<g id="node709" class="node">
<title>moe_34_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="708,-25184.65 490,-25184.65 490,-25132.65 708,-25132.65 708,-25184.65"/>
<text text-anchor="middle" x="599" y="-25172.65" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="599" y="-25161.65" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="599" y="-25150.65" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="599" y="-25139.65" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_34_route&#45;&gt;moe_34_expert_2 -->
<g id="edge1159" class="edge">
<title>moe_34_route&#45;&gt;moe_34_expert_2</title>
<path fill="none" stroke="black" d="M1564.51,-25250.81C1351.77,-25243.19 1016.57,-25225.63 718.34,-25184.75"/>
<polygon fill="black" stroke="black" points="718.58,-25181.25 708.2,-25183.35 717.62,-25188.19 718.58,-25181.25"/>
</g>
<!-- moe_34_expert_3 -->
<g id="node710" class="node">
<title>moe_34_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="944,-25184.65 726,-25184.65 726,-25132.65 944,-25132.65 944,-25184.65"/>
<text text-anchor="middle" x="835" y="-25172.65" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="835" y="-25161.65" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="835" y="-25150.65" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="835" y="-25139.65" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_34_route&#45;&gt;moe_34_expert_3 -->
<g id="edge1160" class="edge">
<title>moe_34_route&#45;&gt;moe_34_expert_3</title>
<path fill="none" stroke="black" d="M1572.82,-25245.51C1407.76,-25235.13 1170.32,-25216.48 954.16,-25184.75"/>
<polygon fill="black" stroke="black" points="954.61,-25181.28 944.21,-25183.28 953.59,-25188.2 954.61,-25181.28"/>
</g>
<!-- moe_34_expert_4 -->
<g id="node711" class="node">
<title>moe_34_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1180,-25184.65 962,-25184.65 962,-25132.65 1180,-25132.65 1180,-25184.65"/>
<text text-anchor="middle" x="1071" y="-25172.65" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1071" y="-25161.65" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1071" y="-25150.65" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1071" y="-25139.65" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_34_route&#45;&gt;moe_34_expert_4 -->
<g id="edge1161" class="edge">
<title>moe_34_route&#45;&gt;moe_34_expert_4</title>
<path fill="none" stroke="black" d="M1593.38,-25238.06C1479.62,-25225.79 1330.9,-25207.93 1190.33,-25184.82"/>
<polygon fill="black" stroke="black" points="1190.66,-25181.33 1180.23,-25183.14 1189.52,-25188.23 1190.66,-25181.33"/>
</g>
<!-- moe_34_expert_5 -->
<g id="node712" class="node">
<title>moe_34_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1416,-25184.65 1198,-25184.65 1198,-25132.65 1416,-25132.65 1416,-25184.65"/>
<text text-anchor="middle" x="1307" y="-25172.65" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1307" y="-25161.65" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1307" y="-25150.65" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1307" y="-25139.65" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_34_route&#45;&gt;moe_34_expert_5 -->
<g id="edge1162" class="edge">
<title>moe_34_route&#45;&gt;moe_34_expert_5</title>
<path fill="none" stroke="black" d="M1641.51,-25228.84C1578.62,-25216.15 1502.88,-25200.77 1426.14,-25184.88"/>
<polygon fill="black" stroke="black" points="1426.79,-25181.44 1416.28,-25182.84 1425.37,-25188.3 1426.79,-25181.44"/>
</g>
<!-- moe_34_expert_6 -->
<g id="node713" class="node">
<title>moe_34_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1652,-25184.65 1434,-25184.65 1434,-25132.65 1652,-25132.65 1652,-25184.65"/>
<text text-anchor="middle" x="1543" y="-25172.65" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1543" y="-25161.65" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1543" y="-25150.65" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1543" y="-25139.65" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_34_route&#45;&gt;moe_34_expert_6 -->
<g id="edge1163" class="edge">
<title>moe_34_route&#45;&gt;moe_34_expert_6</title>
<path fill="none" stroke="black" d="M1698.11,-25223.25C1670.54,-25211.95 1639.96,-25199.41 1613.29,-25188.47"/>
<polygon fill="black" stroke="black" points="1614.61,-25185.23 1604.03,-25184.67 1611.95,-25191.71 1614.61,-25185.23"/>
</g>
<!-- moe_34_expert_7 -->
<g id="node714" class="node">
<title>moe_34_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1888,-25184.65 1670,-25184.65 1670,-25132.65 1888,-25132.65 1888,-25184.65"/>
<text text-anchor="middle" x="1779" y="-25172.65" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1779" y="-25161.65" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1779" y="-25150.65" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1779" y="-25139.65" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_34_route&#45;&gt;moe_34_expert_7 -->
<g id="edge1164" class="edge">
<title>moe_34_route&#45;&gt;moe_34_expert_7</title>
<path fill="none" stroke="black" d="M1779,-25220.39C1779,-25212.07 1779,-25203.24 1779,-25194.96"/>
<polygon fill="black" stroke="black" points="1782.5,-25194.85 1779,-25184.85 1775.5,-25194.85 1782.5,-25194.85"/>
</g>
<!-- moe_34_expert_8 -->
<g id="node715" class="node">
<title>moe_34_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2124,-25184.65 1906,-25184.65 1906,-25132.65 2124,-25132.65 2124,-25184.65"/>
<text text-anchor="middle" x="2015" y="-25172.65" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2015" y="-25161.65" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2015" y="-25150.65" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2015" y="-25139.65" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_34_route&#45;&gt;moe_34_expert_8 -->
<g id="edge1165" class="edge">
<title>moe_34_route&#45;&gt;moe_34_expert_8</title>
<path fill="none" stroke="black" d="M1859.89,-25223.25C1887.46,-25211.95 1918.04,-25199.41 1944.71,-25188.47"/>
<polygon fill="black" stroke="black" points="1946.05,-25191.71 1953.97,-25184.67 1943.39,-25185.23 1946.05,-25191.71"/>
</g>
<!-- moe_34_expert_9 -->
<g id="node716" class="node">
<title>moe_34_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2360,-25184.65 2142,-25184.65 2142,-25132.65 2360,-25132.65 2360,-25184.65"/>
<text text-anchor="middle" x="2251" y="-25172.65" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2251" y="-25161.65" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2251" y="-25150.65" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2251" y="-25139.65" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_34_route&#45;&gt;moe_34_expert_9 -->
<g id="edge1166" class="edge">
<title>moe_34_route&#45;&gt;moe_34_expert_9</title>
<path fill="none" stroke="black" d="M1916.49,-25228.84C1979.38,-25216.15 2055.12,-25200.77 2131.86,-25184.88"/>
<polygon fill="black" stroke="black" points="2132.63,-25188.3 2141.72,-25182.84 2131.21,-25181.44 2132.63,-25188.3"/>
</g>
<!-- moe_34_expert_10 -->
<g id="node717" class="node">
<title>moe_34_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2596,-25184.65 2378,-25184.65 2378,-25132.65 2596,-25132.65 2596,-25184.65"/>
<text text-anchor="middle" x="2487" y="-25172.65" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2487" y="-25161.65" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2487" y="-25150.65" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2487" y="-25139.65" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_34_route&#45;&gt;moe_34_expert_10 -->
<g id="edge1167" class="edge">
<title>moe_34_route&#45;&gt;moe_34_expert_10</title>
<path fill="none" stroke="black" d="M1964.62,-25238.06C2078.38,-25225.79 2227.1,-25207.93 2367.67,-25184.82"/>
<polygon fill="black" stroke="black" points="2368.48,-25188.23 2377.77,-25183.14 2367.34,-25181.33 2368.48,-25188.23"/>
</g>
<!-- moe_34_expert_11 -->
<g id="node718" class="node">
<title>moe_34_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2832,-25184.65 2614,-25184.65 2614,-25132.65 2832,-25132.65 2832,-25184.65"/>
<text text-anchor="middle" x="2723" y="-25172.65" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2723" y="-25161.65" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2723" y="-25150.65" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2723" y="-25139.65" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_34_route&#45;&gt;moe_34_expert_11 -->
<g id="edge1168" class="edge">
<title>moe_34_route&#45;&gt;moe_34_expert_11</title>
<path fill="none" stroke="black" d="M1985.18,-25245.51C2150.24,-25235.13 2387.68,-25216.48 2603.84,-25184.75"/>
<polygon fill="black" stroke="black" points="2604.41,-25188.2 2613.79,-25183.28 2603.39,-25181.28 2604.41,-25188.2"/>
</g>
<!-- moe_34_expert_12 -->
<g id="node719" class="node">
<title>moe_34_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3068,-25184.65 2850,-25184.65 2850,-25132.65 3068,-25132.65 3068,-25184.65"/>
<text text-anchor="middle" x="2959" y="-25172.65" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2959" y="-25161.65" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2959" y="-25150.65" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2959" y="-25139.65" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_34_route&#45;&gt;moe_34_expert_12 -->
<g id="edge1169" class="edge">
<title>moe_34_route&#45;&gt;moe_34_expert_12</title>
<path fill="none" stroke="black" d="M1993.49,-25250.81C2206.23,-25243.19 2541.43,-25225.63 2839.66,-25184.75"/>
<polygon fill="black" stroke="black" points="2840.38,-25188.19 2849.8,-25183.35 2839.42,-25181.25 2840.38,-25188.19"/>
</g>
<!-- moe_34_expert_13 -->
<g id="node720" class="node">
<title>moe_34_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3304,-25184.65 3086,-25184.65 3086,-25132.65 3304,-25132.65 3304,-25184.65"/>
<text text-anchor="middle" x="3195" y="-25172.65" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3195" y="-25161.65" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3195" y="-25150.65" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3195" y="-25139.65" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_34_route&#45;&gt;moe_34_expert_13 -->
<g id="edge1170" class="edge">
<title>moe_34_route&#45;&gt;moe_34_expert_13</title>
<path fill="none" stroke="black" d="M1996.41,-25254.57C2252.78,-25250.07 2691.6,-25235.08 3075.89,-25184.71"/>
<polygon fill="black" stroke="black" points="3076.36,-25188.18 3085.81,-25183.4 3075.44,-25181.24 3076.36,-25188.18"/>
</g>
<!-- moe_34_expert_14 -->
<g id="node721" class="node">
<title>moe_34_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3540,-25184.65 3322,-25184.65 3322,-25132.65 3540,-25132.65 3540,-25184.65"/>
<text text-anchor="middle" x="3431" y="-25172.65" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3431" y="-25161.65" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3431" y="-25150.65" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3431" y="-25139.65" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_34_route&#45;&gt;moe_34_expert_14 -->
<g id="edge1171" class="edge">
<title>moe_34_route&#45;&gt;moe_34_expert_14</title>
<path fill="none" stroke="black" d="M1993.23,-25250.69C2348.61,-25240.47 3046.35,-25217.19 3311.79,-25184.69"/>
<polygon fill="black" stroke="black" points="3312.33,-25188.15 3321.82,-25183.43 3311.46,-25181.21 3312.33,-25188.15"/>
</g>
<!-- moe_34_expert_15 -->
<g id="node722" class="node">
<title>moe_34_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3776,-25184.65 3558,-25184.65 3558,-25132.65 3776,-25132.65 3776,-25184.65"/>
<text text-anchor="middle" x="3667" y="-25172.65" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3667" y="-25161.65" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3667" y="-25150.65" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3667" y="-25139.65" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_34_route&#45;&gt;moe_34_expert_15 -->
<g id="edge1172" class="edge">
<title>moe_34_route&#45;&gt;moe_34_expert_15</title>
<path fill="none" stroke="black" d="M1994.71,-25252.22C2394.25,-25243.68 3236.28,-25222.01 3547.86,-25184.68"/>
<polygon fill="black" stroke="black" points="3548.32,-25188.15 3557.82,-25183.46 3547.47,-25181.2 3548.32,-25188.15"/>
</g>
<!-- moe_34_aggregate -->
<g id="node723" class="node">
<title>moe_34_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1786" cy="-25059.88" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1786" y="-25073.88" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1786" y="-25062.88" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1786" y="-25051.88" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1786" y="-25040.88" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_34_expert_0&#45;&gt;moe_34_aggregate -->
<g id="edge1173" class="edge">
<title>moe_34_expert_0&#45;&gt;moe_34_aggregate</title>
<path fill="none" stroke="black" d="M236.18,-25133.87C239.15,-25133.43 242.09,-25133.02 245,-25132.65 491.4,-25101.02 1189.92,-25077.55 1555.89,-25067.01"/>
<polygon fill="black" stroke="black" points="1556.19,-25070.51 1566.09,-25066.72 1555.99,-25063.51 1556.19,-25070.51"/>
</g>
<!-- moe_34_expert_1&#45;&gt;moe_34_aggregate -->
<g id="edge1174" class="edge">
<title>moe_34_expert_1&#45;&gt;moe_34_aggregate</title>
<path fill="none" stroke="black" d="M472.19,-25133.9C475.15,-25133.45 478.09,-25133.04 481,-25132.65 853.95,-25083.19 1291.23,-25067.69 1553.06,-25062.91"/>
<polygon fill="black" stroke="black" points="1553.14,-25066.41 1563.07,-25062.73 1553.01,-25059.41 1553.14,-25066.41"/>
</g>
<!-- moe_34_expert_2&#45;&gt;moe_34_aggregate -->
<g id="edge1175" class="edge">
<title>moe_34_expert_2&#45;&gt;moe_34_aggregate</title>
<path fill="none" stroke="black" d="M708.2,-25133.95C711.16,-25133.49 714.1,-25133.05 717,-25132.65 1004.46,-25092.75 1338.61,-25074.83 1555.75,-25066.92"/>
<polygon fill="black" stroke="black" points="1556.14,-25070.4 1566,-25066.55 1555.88,-25063.41 1556.14,-25070.4"/>
</g>
<!-- moe_34_expert_3&#45;&gt;moe_34_aggregate -->
<g id="edge1176" class="edge">
<title>moe_34_expert_3&#45;&gt;moe_34_aggregate</title>
<path fill="none" stroke="black" d="M944.21,-25134.02C947.16,-25133.54 950.1,-25133.08 953,-25132.65 1159.13,-25102.05 1396.05,-25083.2 1564.39,-25072.55"/>
<polygon fill="black" stroke="black" points="1564.86,-25076.02 1574.62,-25071.9 1564.42,-25069.04 1564.86,-25076.02"/>
</g>
<!-- moe_34_expert_4&#45;&gt;moe_34_aggregate -->
<g id="edge1177" class="edge">
<title>moe_34_expert_4&#45;&gt;moe_34_aggregate</title>
<path fill="none" stroke="black" d="M1180.23,-25134.15C1183.18,-25133.63 1186.11,-25133.13 1189,-25132.65 1320.72,-25110.82 1469.83,-25092.89 1586.09,-25080.41"/>
<polygon fill="black" stroke="black" points="1586.6,-25083.88 1596.17,-25079.34 1585.85,-25076.92 1586.6,-25083.88"/>
</g>
<!-- moe_34_expert_5&#45;&gt;moe_34_aggregate -->
<g id="edge1178" class="edge">
<title>moe_34_expert_5&#45;&gt;moe_34_aggregate</title>
<path fill="none" stroke="black" d="M1416.28,-25134.45C1419.22,-25133.84 1422.13,-25133.24 1425,-25132.65 1493.92,-25118.5 1570.32,-25103.25 1635.04,-25090.46"/>
<polygon fill="black" stroke="black" points="1635.77,-25093.88 1644.91,-25088.51 1634.42,-25087.01 1635.77,-25093.88"/>
</g>
<!-- moe_34_expert_6&#45;&gt;moe_34_aggregate -->
<g id="edge1179" class="edge">
<title>moe_34_expert_6&#45;&gt;moe_34_aggregate</title>
<path fill="none" stroke="black" d="M1605.89,-25132.6C1632.54,-25121.99 1664.13,-25109.41 1693.36,-25097.77"/>
<polygon fill="black" stroke="black" points="1694.76,-25100.98 1702.76,-25094.03 1692.17,-25094.48 1694.76,-25100.98"/>
</g>
<!-- moe_34_expert_7&#45;&gt;moe_34_aggregate -->
<g id="edge1180" class="edge">
<title>moe_34_expert_7&#45;&gt;moe_34_aggregate</title>
<path fill="none" stroke="black" d="M1780.82,-25132.48C1781.39,-25124.67 1782.03,-25115.8 1782.66,-25107.04"/>
<polygon fill="black" stroke="black" points="1786.17,-25107.08 1783.4,-25096.86 1779.19,-25106.58 1786.17,-25107.08"/>
</g>
<!-- moe_34_expert_8&#45;&gt;moe_34_aggregate -->
<g id="edge1181" class="edge">
<title>moe_34_expert_8&#45;&gt;moe_34_aggregate</title>
<path fill="none" stroke="black" d="M1955.73,-25132.6C1931.07,-25122.18 1901.92,-25109.87 1874.8,-25098.41"/>
<polygon fill="black" stroke="black" points="1875.87,-25095.06 1865.3,-25094.39 1873.15,-25101.51 1875.87,-25095.06"/>
</g>
<!-- moe_34_expert_9&#45;&gt;moe_34_aggregate -->
<g id="edge1182" class="edge">
<title>moe_34_expert_9&#45;&gt;moe_34_aggregate</title>
<path fill="none" stroke="black" d="M2141.71,-25134.48C2138.78,-25133.86 2135.87,-25133.25 2133,-25132.65 2067.27,-25118.89 1994.5,-25103.82 1932.65,-25091.05"/>
<polygon fill="black" stroke="black" points="1933.32,-25087.61 1922.82,-25089.02 1931.91,-25094.47 1933.32,-25087.61"/>
</g>
<!-- moe_34_expert_10&#45;&gt;moe_34_aggregate -->
<g id="edge1183" class="edge">
<title>moe_34_expert_10&#45;&gt;moe_34_aggregate</title>
<path fill="none" stroke="black" d="M2377.77,-25134.16C2374.82,-25133.64 2371.89,-25133.13 2369,-25132.65 2241.46,-25111.33 2097.24,-25093.52 1984.15,-25080.98"/>
<polygon fill="black" stroke="black" points="1984.32,-25077.48 1973.99,-25079.86 1983.55,-25084.44 1984.32,-25077.48"/>
</g>
<!-- moe_34_expert_11&#45;&gt;moe_34_aggregate -->
<g id="edge1184" class="edge">
<title>moe_34_expert_11&#45;&gt;moe_34_aggregate</title>
<path fill="none" stroke="black" d="M2613.79,-25134.03C2610.84,-25133.54 2607.9,-25133.08 2605,-25132.65 2403.46,-25102.58 2172.01,-25083.73 2006.68,-25072.94"/>
<polygon fill="black" stroke="black" points="2006.59,-25069.42 1996.38,-25072.27 2006.13,-25076.41 2006.59,-25069.42"/>
</g>
<!-- moe_34_expert_12&#45;&gt;moe_34_aggregate -->
<g id="edge1185" class="edge">
<title>moe_34_expert_12&#45;&gt;moe_34_aggregate</title>
<path fill="none" stroke="black" d="M2849.8,-25133.95C2846.84,-25133.49 2843.9,-25133.06 2841,-25132.65 2558.42,-25093.3 2230.14,-25075.28 2015.77,-25067.19"/>
<polygon fill="black" stroke="black" points="2015.78,-25063.69 2005.65,-25066.81 2015.51,-25070.68 2015.78,-25063.69"/>
</g>
<!-- moe_34_expert_13&#45;&gt;moe_34_aggregate -->
<g id="edge1186" class="edge">
<title>moe_34_expert_13&#45;&gt;moe_34_aggregate</title>
<path fill="none" stroke="black" d="M3085.81,-25133.9C3082.85,-25133.46 3079.91,-25133.04 3077,-25132.65 2709.33,-25083.78 2278.47,-25068.09 2019.15,-25063.12"/>
<polygon fill="black" stroke="black" points="2018.91,-25059.61 2008.85,-25062.92 2018.78,-25066.61 2018.91,-25059.61"/>
</g>
<!-- moe_34_expert_14&#45;&gt;moe_34_aggregate -->
<g id="edge1187" class="edge">
<title>moe_34_expert_14&#45;&gt;moe_34_aggregate</title>
<path fill="none" stroke="black" d="M3321.82,-25133.87C3318.85,-25133.43 3315.91,-25133.02 3313,-25132.65 2857.52,-25074.09 2320.14,-25061.9 2019.67,-25060.16"/>
<polygon fill="black" stroke="black" points="2019.54,-25056.66 2009.53,-25060.1 2019.51,-25063.66 2019.54,-25056.66"/>
</g>
<!-- moe_34_expert_15&#45;&gt;moe_34_aggregate -->
<g id="edge1188" class="edge">
<title>moe_34_expert_15&#45;&gt;moe_34_aggregate</title>
<path fill="none" stroke="black" d="M3557.82,-25133.84C3554.85,-25133.42 3551.91,-25133.02 3549,-25132.65 3259.72,-25096.38 2425.96,-25074.37 2017.32,-25065.46"/>
<polygon fill="black" stroke="black" points="2017.23,-25061.96 2007.15,-25065.24 2017.07,-25068.96 2017.23,-25061.96"/>
</g>
<!-- moe_34_ffn -->
<g id="node724" class="node">
<title>moe_34_ffn</title>
<polygon fill="lightgreen" stroke="black" points="1944,-24987.11 1628,-24987.11 1628,-24935.11 1944,-24935.11 1944,-24987.11"/>
<text text-anchor="middle" x="1786" y="-24975.11" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1786" y="-24964.11" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1786" y="-24953.11" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1786" y="-24942.11" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_34_aggregate&#45;&gt;moe_34_ffn -->
<g id="edge1189" class="edge">
<title>moe_34_aggregate&#45;&gt;moe_34_ffn</title>
<path fill="none" stroke="black" d="M1786,-25022.85C1786,-25014.54 1786,-25005.7 1786,-24997.42"/>
<polygon fill="black" stroke="black" points="1789.5,-24997.31 1786,-24987.31 1782.5,-24997.31 1789.5,-24997.31"/>
</g>
<!-- moe_34_res2 -->
<g id="node726" class="node">
<title>moe_34_res2</title>
<polygon fill="lightyellow" stroke="black" points="2122.89,-24899.11 1586.97,-24899.11 1449.11,-24795.11 1985.03,-24795.11 2122.89,-24899.11"/>
<text text-anchor="middle" x="1786" y="-24861.11" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1786" y="-24850.11" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1786" y="-24839.11" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1786" y="-24828.11" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_34_ffn&#45;&gt;moe_34_res2 -->
<g id="edge1190" class="edge">
<title>moe_34_ffn&#45;&gt;moe_34_res2</title>
<path fill="none" stroke="black" d="M1786,-24934.98C1786,-24927.29 1786,-24918.48 1786,-24909.48"/>
<polygon fill="black" stroke="black" points="1789.5,-24909.29 1786,-24899.29 1782.5,-24909.29 1789.5,-24909.29"/>
</g>
<!-- moe_34_res1&#45;&gt;moe_34_gate -->
<g id="edge1155" class="edge">
<title>moe_34_res1&#45;&gt;moe_34_gate</title>
<path fill="none" stroke="black" d="M1779,-25469.8C1779,-25461.63 1779,-25453.11 1779,-25444.73"/>
<polygon fill="black" stroke="black" points="1782.5,-25444.62 1779,-25434.62 1775.5,-25444.62 1782.5,-25444.62"/>
</g>
<!-- moe_35_mha -->
<g id="node727" class="node">
<title>moe_35_mha</title>
<polygon fill="lightgreen" stroke="black" points="1944,-24748.11 1628,-24748.11 1628,-24696.11 1944,-24696.11 1944,-24748.11"/>
<text text-anchor="middle" x="1786" y="-24736.11" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1786" y="-24725.11" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1786" y="-24714.11" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1786" y="-24703.11" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_34_res2&#45;&gt;moe_35_mha -->
<g id="edge1191" class="edge">
<title>moe_34_res2&#45;&gt;moe_35_mha</title>
<path fill="none" stroke="black" d="M1786,-24795.02C1786,-24782.69 1786,-24769.78 1786,-24758.36"/>
<polygon fill="black" stroke="black" points="1789.5,-24758.35 1786,-24748.35 1782.5,-24758.35 1789.5,-24758.35"/>
</g>
<!-- moe_35_res1 -->
<g id="node748" class="node">
<title>moe_35_res1</title>
<polygon fill="lightyellow" stroke="black" points="2122.89,-24660.11 1586.97,-24660.11 1449.11,-24556.11 1985.03,-24556.11 2122.89,-24660.11"/>
<text text-anchor="middle" x="1786" y="-24622.11" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1786" y="-24611.11" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1786" y="-24600.11" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1786" y="-24589.11" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_35_mha&#45;&gt;moe_35_res1 -->
<g id="edge1192" class="edge">
<title>moe_35_mha&#45;&gt;moe_35_res1</title>
<path fill="none" stroke="black" d="M1786,-24695.98C1786,-24688.29 1786,-24679.48 1786,-24670.48"/>
<polygon fill="black" stroke="black" points="1789.5,-24670.29 1786,-24660.29 1782.5,-24670.29 1789.5,-24670.29"/>
</g>
<!-- moe_35_gate -->
<g id="node728" class="node">
<title>moe_35_gate</title>
<polygon fill="lightyellow" stroke="black" points="2114.8,-24520.11 1591.75,-24520.11 1457.2,-24416.11 1980.25,-24416.11 2114.8,-24520.11"/>
<text text-anchor="middle" x="1786" y="-24482.11" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1786" y="-24471.11" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1786" y="-24460.11" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1786" y="-24449.11" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_35_route -->
<g id="node729" class="node">
<title>moe_35_route</title>
<ellipse fill="lightblue" stroke="black" cx="1786" cy="-24343.34" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1786" y="-24357.34" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1786" y="-24346.34" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1786" y="-24335.34" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1786" y="-24324.34" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_35_gate&#45;&gt;moe_35_route -->
<g id="edge1194" class="edge">
<title>moe_35_gate&#45;&gt;moe_35_route</title>
<path fill="none" stroke="black" d="M1786,-24415.76C1786,-24407.35 1786,-24398.68 1786,-24390.41"/>
<polygon fill="black" stroke="black" points="1789.5,-24390.2 1786,-24380.2 1782.5,-24390.2 1789.5,-24390.2"/>
</g>
<!-- moe_35_expert_0 -->
<g id="node730" class="node">
<title>moe_35_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="243,-24270.57 25,-24270.57 25,-24218.57 243,-24218.57 243,-24270.57"/>
<text text-anchor="middle" x="134" y="-24258.57" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="134" y="-24247.57" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="134" y="-24236.57" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="134" y="-24225.57" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_35_route&#45;&gt;moe_35_expert_0 -->
<g id="edge1195" class="edge">
<title>moe_35_route&#45;&gt;moe_35_expert_0</title>
<path fill="none" stroke="black" d="M1571.77,-24336.61C1216.39,-24326.39 518.65,-24303.12 253.21,-24270.61"/>
<polygon fill="black" stroke="black" points="253.54,-24267.13 243.18,-24269.36 252.67,-24274.07 253.54,-24267.13"/>
</g>
<!-- moe_35_expert_1 -->
<g id="node731" class="node">
<title>moe_35_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="479,-24270.57 261,-24270.57 261,-24218.57 479,-24218.57 479,-24270.57"/>
<text text-anchor="middle" x="370" y="-24258.57" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="370" y="-24247.57" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="370" y="-24236.57" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="370" y="-24225.57" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_35_route&#45;&gt;moe_35_expert_1 -->
<g id="edge1196" class="edge">
<title>moe_35_route&#45;&gt;moe_35_expert_1</title>
<path fill="none" stroke="black" d="M1568.59,-24340.49C1312.22,-24335.99 873.4,-24321 489.11,-24270.63"/>
<polygon fill="black" stroke="black" points="489.56,-24267.16 479.19,-24269.32 488.64,-24274.1 489.56,-24267.16"/>
</g>
<!-- moe_35_expert_2 -->
<g id="node732" class="node">
<title>moe_35_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="715,-24270.57 497,-24270.57 497,-24218.57 715,-24218.57 715,-24270.57"/>
<text text-anchor="middle" x="606" y="-24258.57" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="606" y="-24247.57" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="606" y="-24236.57" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="606" y="-24225.57" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_35_route&#45;&gt;moe_35_expert_2 -->
<g id="edge1197" class="edge">
<title>moe_35_route&#45;&gt;moe_35_expert_2</title>
<path fill="none" stroke="black" d="M1571.51,-24336.74C1358.77,-24329.12 1023.57,-24311.56 725.34,-24270.68"/>
<polygon fill="black" stroke="black" points="725.58,-24267.18 715.2,-24269.27 724.62,-24274.11 725.58,-24267.18"/>
</g>
<!-- moe_35_expert_3 -->
<g id="node733" class="node">
<title>moe_35_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="951,-24270.57 733,-24270.57 733,-24218.57 951,-24218.57 951,-24270.57"/>
<text text-anchor="middle" x="842" y="-24258.57" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="842" y="-24247.57" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="842" y="-24236.57" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="842" y="-24225.57" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_35_route&#45;&gt;moe_35_expert_3 -->
<g id="edge1198" class="edge">
<title>moe_35_route&#45;&gt;moe_35_expert_3</title>
<path fill="none" stroke="black" d="M1579.82,-24331.43C1414.76,-24321.05 1177.32,-24302.4 961.16,-24270.67"/>
<polygon fill="black" stroke="black" points="961.61,-24267.2 951.21,-24269.2 960.59,-24274.13 961.61,-24267.2"/>
</g>
<!-- moe_35_expert_4 -->
<g id="node734" class="node">
<title>moe_35_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1187,-24270.57 969,-24270.57 969,-24218.57 1187,-24218.57 1187,-24270.57"/>
<text text-anchor="middle" x="1078" y="-24258.57" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1078" y="-24247.57" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1078" y="-24236.57" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1078" y="-24225.57" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_35_route&#45;&gt;moe_35_expert_4 -->
<g id="edge1199" class="edge">
<title>moe_35_route&#45;&gt;moe_35_expert_4</title>
<path fill="none" stroke="black" d="M1600.38,-24323.98C1486.62,-24311.71 1337.9,-24293.86 1197.33,-24270.74"/>
<polygon fill="black" stroke="black" points="1197.66,-24267.25 1187.23,-24269.07 1196.52,-24274.15 1197.66,-24267.25"/>
</g>
<!-- moe_35_expert_5 -->
<g id="node735" class="node">
<title>moe_35_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1423,-24270.57 1205,-24270.57 1205,-24218.57 1423,-24218.57 1423,-24270.57"/>
<text text-anchor="middle" x="1314" y="-24258.57" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1314" y="-24247.57" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1314" y="-24236.57" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1314" y="-24225.57" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_35_route&#45;&gt;moe_35_expert_5 -->
<g id="edge1200" class="edge">
<title>moe_35_route&#45;&gt;moe_35_expert_5</title>
<path fill="none" stroke="black" d="M1648.51,-24314.76C1585.62,-24302.07 1509.88,-24286.69 1433.14,-24270.8"/>
<polygon fill="black" stroke="black" points="1433.79,-24267.36 1423.28,-24268.76 1432.37,-24274.22 1433.79,-24267.36"/>
</g>
<!-- moe_35_expert_6 -->
<g id="node736" class="node">
<title>moe_35_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1659,-24270.57 1441,-24270.57 1441,-24218.57 1659,-24218.57 1659,-24270.57"/>
<text text-anchor="middle" x="1550" y="-24258.57" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1550" y="-24247.57" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1550" y="-24236.57" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1550" y="-24225.57" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_35_route&#45;&gt;moe_35_expert_6 -->
<g id="edge1201" class="edge">
<title>moe_35_route&#45;&gt;moe_35_expert_6</title>
<path fill="none" stroke="black" d="M1705.11,-24309.17C1677.54,-24297.87 1646.96,-24285.33 1620.29,-24274.39"/>
<polygon fill="black" stroke="black" points="1621.61,-24271.15 1611.03,-24270.6 1618.95,-24277.63 1621.61,-24271.15"/>
</g>
<!-- moe_35_expert_7 -->
<g id="node737" class="node">
<title>moe_35_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1895,-24270.57 1677,-24270.57 1677,-24218.57 1895,-24218.57 1895,-24270.57"/>
<text text-anchor="middle" x="1786" y="-24258.57" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1786" y="-24247.57" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1786" y="-24236.57" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1786" y="-24225.57" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_35_route&#45;&gt;moe_35_expert_7 -->
<g id="edge1202" class="edge">
<title>moe_35_route&#45;&gt;moe_35_expert_7</title>
<path fill="none" stroke="black" d="M1786,-24306.31C1786,-24298 1786,-24289.16 1786,-24280.88"/>
<polygon fill="black" stroke="black" points="1789.5,-24280.77 1786,-24270.77 1782.5,-24280.77 1789.5,-24280.77"/>
</g>
<!-- moe_35_expert_8 -->
<g id="node738" class="node">
<title>moe_35_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2131,-24270.57 1913,-24270.57 1913,-24218.57 2131,-24218.57 2131,-24270.57"/>
<text text-anchor="middle" x="2022" y="-24258.57" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2022" y="-24247.57" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2022" y="-24236.57" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2022" y="-24225.57" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_35_route&#45;&gt;moe_35_expert_8 -->
<g id="edge1203" class="edge">
<title>moe_35_route&#45;&gt;moe_35_expert_8</title>
<path fill="none" stroke="black" d="M1866.89,-24309.17C1894.46,-24297.87 1925.04,-24285.33 1951.71,-24274.39"/>
<polygon fill="black" stroke="black" points="1953.05,-24277.63 1960.97,-24270.6 1950.39,-24271.15 1953.05,-24277.63"/>
</g>
<!-- moe_35_expert_9 -->
<g id="node739" class="node">
<title>moe_35_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2367,-24270.57 2149,-24270.57 2149,-24218.57 2367,-24218.57 2367,-24270.57"/>
<text text-anchor="middle" x="2258" y="-24258.57" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2258" y="-24247.57" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2258" y="-24236.57" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2258" y="-24225.57" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_35_route&#45;&gt;moe_35_expert_9 -->
<g id="edge1204" class="edge">
<title>moe_35_route&#45;&gt;moe_35_expert_9</title>
<path fill="none" stroke="black" d="M1923.49,-24314.76C1986.38,-24302.07 2062.12,-24286.69 2138.86,-24270.8"/>
<polygon fill="black" stroke="black" points="2139.63,-24274.22 2148.72,-24268.76 2138.21,-24267.36 2139.63,-24274.22"/>
</g>
<!-- moe_35_expert_10 -->
<g id="node740" class="node">
<title>moe_35_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2603,-24270.57 2385,-24270.57 2385,-24218.57 2603,-24218.57 2603,-24270.57"/>
<text text-anchor="middle" x="2494" y="-24258.57" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2494" y="-24247.57" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2494" y="-24236.57" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2494" y="-24225.57" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_35_route&#45;&gt;moe_35_expert_10 -->
<g id="edge1205" class="edge">
<title>moe_35_route&#45;&gt;moe_35_expert_10</title>
<path fill="none" stroke="black" d="M1971.62,-24323.98C2085.38,-24311.71 2234.1,-24293.86 2374.67,-24270.74"/>
<polygon fill="black" stroke="black" points="2375.48,-24274.15 2384.77,-24269.07 2374.34,-24267.25 2375.48,-24274.15"/>
</g>
<!-- moe_35_expert_11 -->
<g id="node741" class="node">
<title>moe_35_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2839,-24270.57 2621,-24270.57 2621,-24218.57 2839,-24218.57 2839,-24270.57"/>
<text text-anchor="middle" x="2730" y="-24258.57" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2730" y="-24247.57" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2730" y="-24236.57" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2730" y="-24225.57" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_35_route&#45;&gt;moe_35_expert_11 -->
<g id="edge1206" class="edge">
<title>moe_35_route&#45;&gt;moe_35_expert_11</title>
<path fill="none" stroke="black" d="M1992.18,-24331.43C2157.24,-24321.05 2394.68,-24302.4 2610.84,-24270.67"/>
<polygon fill="black" stroke="black" points="2611.41,-24274.13 2620.79,-24269.2 2610.39,-24267.2 2611.41,-24274.13"/>
</g>
<!-- moe_35_expert_12 -->
<g id="node742" class="node">
<title>moe_35_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3075,-24270.57 2857,-24270.57 2857,-24218.57 3075,-24218.57 3075,-24270.57"/>
<text text-anchor="middle" x="2966" y="-24258.57" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2966" y="-24247.57" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2966" y="-24236.57" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2966" y="-24225.57" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_35_route&#45;&gt;moe_35_expert_12 -->
<g id="edge1207" class="edge">
<title>moe_35_route&#45;&gt;moe_35_expert_12</title>
<path fill="none" stroke="black" d="M2000.49,-24336.74C2213.23,-24329.12 2548.43,-24311.56 2846.66,-24270.68"/>
<polygon fill="black" stroke="black" points="2847.38,-24274.11 2856.8,-24269.27 2846.42,-24267.18 2847.38,-24274.11"/>
</g>
<!-- moe_35_expert_13 -->
<g id="node743" class="node">
<title>moe_35_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3311,-24270.57 3093,-24270.57 3093,-24218.57 3311,-24218.57 3311,-24270.57"/>
<text text-anchor="middle" x="3202" y="-24258.57" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3202" y="-24247.57" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3202" y="-24236.57" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3202" y="-24225.57" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_35_route&#45;&gt;moe_35_expert_13 -->
<g id="edge1208" class="edge">
<title>moe_35_route&#45;&gt;moe_35_expert_13</title>
<path fill="none" stroke="black" d="M2003.41,-24340.49C2259.78,-24335.99 2698.6,-24321 3082.89,-24270.63"/>
<polygon fill="black" stroke="black" points="3083.36,-24274.1 3092.81,-24269.32 3082.44,-24267.16 3083.36,-24274.1"/>
</g>
<!-- moe_35_expert_14 -->
<g id="node744" class="node">
<title>moe_35_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3547,-24270.57 3329,-24270.57 3329,-24218.57 3547,-24218.57 3547,-24270.57"/>
<text text-anchor="middle" x="3438" y="-24258.57" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3438" y="-24247.57" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3438" y="-24236.57" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3438" y="-24225.57" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_35_route&#45;&gt;moe_35_expert_14 -->
<g id="edge1209" class="edge">
<title>moe_35_route&#45;&gt;moe_35_expert_14</title>
<path fill="none" stroke="black" d="M2000.23,-24336.61C2355.61,-24326.39 3053.35,-24303.12 3318.79,-24270.61"/>
<polygon fill="black" stroke="black" points="3319.33,-24274.07 3328.82,-24269.36 3318.46,-24267.13 3319.33,-24274.07"/>
</g>
<!-- moe_35_expert_15 -->
<g id="node745" class="node">
<title>moe_35_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3783,-24270.57 3565,-24270.57 3565,-24218.57 3783,-24218.57 3783,-24270.57"/>
<text text-anchor="middle" x="3674" y="-24258.57" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3674" y="-24247.57" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3674" y="-24236.57" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3674" y="-24225.57" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_35_route&#45;&gt;moe_35_expert_15 -->
<g id="edge1210" class="edge">
<title>moe_35_route&#45;&gt;moe_35_expert_15</title>
<path fill="none" stroke="black" d="M2001.71,-24338.14C2401.25,-24329.6 3243.28,-24307.93 3554.86,-24270.6"/>
<polygon fill="black" stroke="black" points="3555.32,-24274.07 3564.82,-24269.38 3554.47,-24267.12 3555.32,-24274.07"/>
</g>
<!-- moe_35_aggregate -->
<g id="node746" class="node">
<title>moe_35_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1790" cy="-24145.8" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1790" y="-24159.8" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1790" y="-24148.8" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1790" y="-24137.8" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1790" y="-24126.8" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_35_expert_0&#45;&gt;moe_35_aggregate -->
<g id="edge1211" class="edge">
<title>moe_35_expert_0&#45;&gt;moe_35_aggregate</title>
<path fill="none" stroke="black" d="M243.18,-24219.79C246.15,-24219.35 249.09,-24218.95 252,-24218.57 497.84,-24187.01 1194.61,-24163.51 1559.98,-24152.96"/>
<polygon fill="black" stroke="black" points="1560.26,-24156.45 1570.15,-24152.67 1560.06,-24149.45 1560.26,-24156.45"/>
</g>
<!-- moe_35_expert_1&#45;&gt;moe_35_aggregate -->
<g id="edge1212" class="edge">
<title>moe_35_expert_1&#45;&gt;moe_35_aggregate</title>
<path fill="none" stroke="black" d="M479.19,-24219.82C482.15,-24219.38 485.09,-24218.96 488,-24218.57 859.64,-24169.26 1295.29,-24153.71 1556.62,-24148.88"/>
<polygon fill="black" stroke="black" points="1557.07,-24152.38 1567,-24148.7 1556.94,-24145.38 1557.07,-24152.38"/>
</g>
<!-- moe_35_expert_2&#45;&gt;moe_35_aggregate -->
<g id="edge1213" class="edge">
<title>moe_35_expert_2&#45;&gt;moe_35_aggregate</title>
<path fill="none" stroke="black" d="M715.2,-24219.87C718.16,-24219.41 721.1,-24218.98 724,-24218.57 1010.43,-24178.79 1343.34,-24160.85 1559.89,-24152.89"/>
<polygon fill="black" stroke="black" points="1560.24,-24156.38 1570.11,-24152.52 1559.99,-24149.39 1560.24,-24156.38"/>
</g>
<!-- moe_35_expert_3&#45;&gt;moe_35_aggregate -->
<g id="edge1214" class="edge">
<title>moe_35_expert_3&#45;&gt;moe_35_aggregate</title>
<path fill="none" stroke="black" d="M951.21,-24219.94C954.16,-24219.46 957.1,-24219 960,-24218.57 1165.22,-24188.08 1401.05,-24169.22 1568.76,-24158.54"/>
<polygon fill="black" stroke="black" points="1569.19,-24162.02 1578.95,-24157.9 1568.75,-24155.03 1569.19,-24162.02"/>
</g>
<!-- moe_35_expert_4&#45;&gt;moe_35_aggregate -->
<g id="edge1215" class="edge">
<title>moe_35_expert_4&#45;&gt;moe_35_aggregate</title>
<path fill="none" stroke="black" d="M1187.23,-24220.08C1190.18,-24219.56 1193.11,-24219.05 1196,-24218.57 1326.81,-24196.86 1474.86,-24178.95 1590.44,-24166.46"/>
<polygon fill="black" stroke="black" points="1590.89,-24169.93 1600.46,-24165.38 1590.14,-24162.97 1590.89,-24169.93"/>
</g>
<!-- moe_35_expert_5&#45;&gt;moe_35_aggregate -->
<g id="edge1216" class="edge">
<title>moe_35_expert_5&#45;&gt;moe_35_aggregate</title>
<path fill="none" stroke="black" d="M1423.28,-24220.38C1426.22,-24219.77 1429.13,-24219.16 1432,-24218.57 1500.21,-24204.51 1575.82,-24189.3 1639.9,-24176.51"/>
<polygon fill="black" stroke="black" points="1640.97,-24179.87 1650.09,-24174.48 1639.6,-24173.01 1640.97,-24179.87"/>
</g>
<!-- moe_35_expert_6&#45;&gt;moe_35_aggregate -->
<g id="edge1217" class="edge">
<title>moe_35_expert_6&#45;&gt;moe_35_aggregate</title>
<path fill="none" stroke="black" d="M1612.12,-24218.53C1638.2,-24208.01 1669.07,-24195.56 1697.72,-24184.01"/>
<polygon fill="black" stroke="black" points="1699.37,-24187.12 1707.34,-24180.13 1696.76,-24180.63 1699.37,-24187.12"/>
</g>
<!-- moe_35_expert_7&#45;&gt;moe_35_aggregate -->
<g id="edge1218" class="edge">
<title>moe_35_expert_7&#45;&gt;moe_35_aggregate</title>
<path fill="none" stroke="black" d="M1787.04,-24218.4C1787.36,-24210.59 1787.73,-24201.73 1788.09,-24192.96"/>
<polygon fill="black" stroke="black" points="1791.6,-24192.92 1788.51,-24182.78 1784.6,-24192.63 1791.6,-24192.92"/>
</g>
<!-- moe_35_expert_8&#45;&gt;moe_35_aggregate -->
<g id="edge1219" class="edge">
<title>moe_35_expert_8&#45;&gt;moe_35_aggregate</title>
<path fill="none" stroke="black" d="M1961.95,-24218.53C1936.86,-24208.06 1907.18,-24195.68 1879.6,-24184.18"/>
<polygon fill="black" stroke="black" points="1880.92,-24180.93 1870.34,-24180.31 1878.22,-24187.39 1880.92,-24180.93"/>
</g>
<!-- moe_35_expert_9&#45;&gt;moe_35_aggregate -->
<g id="edge1220" class="edge">
<title>moe_35_expert_9&#45;&gt;moe_35_aggregate</title>
<path fill="none" stroke="black" d="M2148.71,-24220.39C2145.78,-24219.78 2142.87,-24219.17 2140,-24218.57 2073.57,-24204.72 2000,-24189.61 1937.53,-24176.83"/>
<polygon fill="black" stroke="black" points="1938.09,-24173.38 1927.6,-24174.8 1936.69,-24180.23 1938.09,-24173.38"/>
</g>
<!-- moe_35_expert_10&#45;&gt;moe_35_aggregate -->
<g id="edge1221" class="edge">
<title>moe_35_expert_10&#45;&gt;moe_35_aggregate</title>
<path fill="none" stroke="black" d="M2384.77,-24220.08C2381.82,-24219.56 2378.89,-24219.06 2376,-24218.57 2247.56,-24197.14 2102.29,-24179.31 1988.52,-24166.78"/>
<polygon fill="black" stroke="black" points="1988.63,-24163.27 1978.3,-24165.66 1987.86,-24170.23 1988.63,-24163.27"/>
</g>
<!-- moe_35_expert_11&#45;&gt;moe_35_aggregate -->
<g id="edge1222" class="edge">
<title>moe_35_expert_11&#45;&gt;moe_35_aggregate</title>
<path fill="none" stroke="black" d="M2620.79,-24219.95C2617.84,-24219.46 2614.9,-24219 2612,-24218.57 2409.55,-24188.4 2177.02,-24169.55 2011.06,-24158.79"/>
<polygon fill="black" stroke="black" points="2010.93,-24155.27 2000.72,-24158.12 2010.48,-24162.26 2010.93,-24155.27"/>
</g>
<!-- moe_35_expert_12&#45;&gt;moe_35_aggregate -->
<g id="edge1223" class="edge">
<title>moe_35_expert_12&#45;&gt;moe_35_aggregate</title>
<path fill="none" stroke="black" d="M2856.8,-24219.87C2853.84,-24219.41 2850.9,-24218.98 2848,-24218.57 2564.39,-24179.11 2234.88,-24161.11 2019.92,-24153.06"/>
<polygon fill="black" stroke="black" points="2019.89,-24149.55 2009.77,-24152.68 2019.63,-24156.55 2019.89,-24149.55"/>
</g>
<!-- moe_35_expert_13&#45;&gt;moe_35_aggregate -->
<g id="edge1224" class="edge">
<title>moe_35_expert_13&#45;&gt;moe_35_aggregate</title>
<path fill="none" stroke="black" d="M3092.81,-24219.82C3089.85,-24219.38 3086.91,-24218.96 3084,-24218.57 2715.2,-24169.57 2282.96,-24153.93 2023.11,-24148.99"/>
<polygon fill="black" stroke="black" points="2022.85,-24145.49 2012.78,-24148.8 2022.72,-24152.49 2022.85,-24145.49"/>
</g>
<!-- moe_35_expert_14&#45;&gt;moe_35_aggregate -->
<g id="edge1225" class="edge">
<title>moe_35_expert_14&#45;&gt;moe_35_aggregate</title>
<path fill="none" stroke="black" d="M3328.82,-24219.79C3325.85,-24219.35 3322.91,-24218.95 3320,-24218.57 2863.46,-24159.9 2324.81,-24147.76 2023.81,-24146.05"/>
<polygon fill="black" stroke="black" points="2023.66,-24142.55 2013.64,-24145.99 2023.63,-24149.55 2023.66,-24142.55"/>
</g>
<!-- moe_35_expert_15&#45;&gt;moe_35_aggregate -->
<g id="edge1226" class="edge">
<title>moe_35_expert_15&#45;&gt;moe_35_aggregate</title>
<path fill="none" stroke="black" d="M3564.82,-24219.77C3561.85,-24219.34 3558.91,-24218.94 3556,-24218.57 3266.14,-24182.24 2430.51,-24160.25 2021.32,-24151.37"/>
<polygon fill="black" stroke="black" points="2021.21,-24147.86 2011.13,-24151.15 2021.06,-24154.86 2021.21,-24147.86"/>
</g>
<!-- moe_35_ffn -->
<g id="node747" class="node">
<title>moe_35_ffn</title>
<polygon fill="lightgreen" stroke="black" points="1948,-24073.03 1632,-24073.03 1632,-24021.03 1948,-24021.03 1948,-24073.03"/>
<text text-anchor="middle" x="1790" y="-24061.03" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1790" y="-24050.03" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1790" y="-24039.03" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1790" y="-24028.03" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_35_aggregate&#45;&gt;moe_35_ffn -->
<g id="edge1227" class="edge">
<title>moe_35_aggregate&#45;&gt;moe_35_ffn</title>
<path fill="none" stroke="black" d="M1790,-24108.77C1790,-24100.46 1790,-24091.62 1790,-24083.34"/>
<polygon fill="black" stroke="black" points="1793.5,-24083.23 1790,-24073.23 1786.5,-24083.23 1793.5,-24083.23"/>
</g>
<!-- moe_35_res2 -->
<g id="node749" class="node">
<title>moe_35_res2</title>
<polygon fill="lightyellow" stroke="black" points="2126.89,-23985.03 1590.97,-23985.03 1453.11,-23881.03 1989.03,-23881.03 2126.89,-23985.03"/>
<text text-anchor="middle" x="1790" y="-23947.03" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1790" y="-23936.03" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1790" y="-23925.03" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1790" y="-23914.03" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_35_ffn&#45;&gt;moe_35_res2 -->
<g id="edge1228" class="edge">
<title>moe_35_ffn&#45;&gt;moe_35_res2</title>
<path fill="none" stroke="black" d="M1790,-24020.9C1790,-24013.21 1790,-24004.4 1790,-23995.4"/>
<polygon fill="black" stroke="black" points="1793.5,-23995.21 1790,-23985.21 1786.5,-23995.21 1793.5,-23995.21"/>
</g>
<!-- moe_35_res1&#45;&gt;moe_35_gate -->
<g id="edge1193" class="edge">
<title>moe_35_res1&#45;&gt;moe_35_gate</title>
<path fill="none" stroke="black" d="M1786,-24555.73C1786,-24547.55 1786,-24539.03 1786,-24530.65"/>
<polygon fill="black" stroke="black" points="1789.5,-24530.54 1786,-24520.54 1782.5,-24530.54 1789.5,-24530.54"/>
</g>
<!-- moe_36_mha -->
<g id="node750" class="node">
<title>moe_36_mha</title>
<polygon fill="lightgreen" stroke="black" points="1948,-23834.03 1632,-23834.03 1632,-23782.03 1948,-23782.03 1948,-23834.03"/>
<text text-anchor="middle" x="1790" y="-23822.03" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1790" y="-23811.03" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1790" y="-23800.03" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1790" y="-23789.03" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_35_res2&#45;&gt;moe_36_mha -->
<g id="edge1229" class="edge">
<title>moe_35_res2&#45;&gt;moe_36_mha</title>
<path fill="none" stroke="black" d="M1790,-23880.94C1790,-23868.61 1790,-23855.7 1790,-23844.28"/>
<polygon fill="black" stroke="black" points="1793.5,-23844.27 1790,-23834.27 1786.5,-23844.27 1793.5,-23844.27"/>
</g>
<!-- moe_36_res1 -->
<g id="node771" class="node">
<title>moe_36_res1</title>
<polygon fill="lightyellow" stroke="black" points="2126.89,-23746.03 1590.97,-23746.03 1453.11,-23642.03 1989.03,-23642.03 2126.89,-23746.03"/>
<text text-anchor="middle" x="1790" y="-23708.03" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1790" y="-23697.03" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1790" y="-23686.03" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1790" y="-23675.03" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_36_mha&#45;&gt;moe_36_res1 -->
<g id="edge1230" class="edge">
<title>moe_36_mha&#45;&gt;moe_36_res1</title>
<path fill="none" stroke="black" d="M1790,-23781.9C1790,-23774.21 1790,-23765.4 1790,-23756.4"/>
<polygon fill="black" stroke="black" points="1793.5,-23756.21 1790,-23746.21 1786.5,-23756.21 1793.5,-23756.21"/>
</g>
<!-- moe_36_gate -->
<g id="node751" class="node">
<title>moe_36_gate</title>
<polygon fill="lightyellow" stroke="black" points="2118.8,-23606.03 1595.75,-23606.03 1461.2,-23502.03 1984.25,-23502.03 2118.8,-23606.03"/>
<text text-anchor="middle" x="1790" y="-23568.03" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1790" y="-23557.03" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1790" y="-23546.03" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1790" y="-23535.03" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_36_route -->
<g id="node752" class="node">
<title>moe_36_route</title>
<ellipse fill="lightblue" stroke="black" cx="1790" cy="-23429.26" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1790" y="-23443.26" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1790" y="-23432.26" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1790" y="-23421.26" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1790" y="-23410.26" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_36_gate&#45;&gt;moe_36_route -->
<g id="edge1232" class="edge">
<title>moe_36_gate&#45;&gt;moe_36_route</title>
<path fill="none" stroke="black" d="M1790,-23501.68C1790,-23493.27 1790,-23484.6 1790,-23476.33"/>
<polygon fill="black" stroke="black" points="1793.5,-23476.12 1790,-23466.12 1786.5,-23476.12 1793.5,-23476.12"/>
</g>
<!-- moe_36_expert_0 -->
<g id="node753" class="node">
<title>moe_36_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="247,-23356.49 29,-23356.49 29,-23304.49 247,-23304.49 247,-23356.49"/>
<text text-anchor="middle" x="138" y="-23344.49" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="138" y="-23333.49" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="138" y="-23322.49" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="138" y="-23311.49" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_36_route&#45;&gt;moe_36_expert_0 -->
<g id="edge1233" class="edge">
<title>moe_36_route&#45;&gt;moe_36_expert_0</title>
<path fill="none" stroke="black" d="M1575.77,-23422.53C1220.39,-23412.31 522.65,-23389.04 257.21,-23356.54"/>
<polygon fill="black" stroke="black" points="257.54,-23353.05 247.18,-23355.28 256.67,-23360 257.54,-23353.05"/>
</g>
<!-- moe_36_expert_1 -->
<g id="node754" class="node">
<title>moe_36_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="483,-23356.49 265,-23356.49 265,-23304.49 483,-23304.49 483,-23356.49"/>
<text text-anchor="middle" x="374" y="-23344.49" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="374" y="-23333.49" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="374" y="-23322.49" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="374" y="-23311.49" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_36_route&#45;&gt;moe_36_expert_1 -->
<g id="edge1234" class="edge">
<title>moe_36_route&#45;&gt;moe_36_expert_1</title>
<path fill="none" stroke="black" d="M1572.59,-23426.42C1316.22,-23421.91 877.4,-23406.92 493.11,-23356.55"/>
<polygon fill="black" stroke="black" points="493.56,-23353.08 483.19,-23355.24 492.64,-23360.02 493.56,-23353.08"/>
</g>
<!-- moe_36_expert_2 -->
<g id="node755" class="node">
<title>moe_36_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="719,-23356.49 501,-23356.49 501,-23304.49 719,-23304.49 719,-23356.49"/>
<text text-anchor="middle" x="610" y="-23344.49" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="610" y="-23333.49" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="610" y="-23322.49" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="610" y="-23311.49" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_36_route&#45;&gt;moe_36_expert_2 -->
<g id="edge1235" class="edge">
<title>moe_36_route&#45;&gt;moe_36_expert_2</title>
<path fill="none" stroke="black" d="M1575.51,-23422.66C1362.77,-23415.04 1027.57,-23397.48 729.34,-23356.6"/>
<polygon fill="black" stroke="black" points="729.58,-23353.1 719.2,-23355.2 728.62,-23360.03 729.58,-23353.1"/>
</g>
<!-- moe_36_expert_3 -->
<g id="node756" class="node">
<title>moe_36_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="955,-23356.49 737,-23356.49 737,-23304.49 955,-23304.49 955,-23356.49"/>
<text text-anchor="middle" x="846" y="-23344.49" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="846" y="-23333.49" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="846" y="-23322.49" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="846" y="-23311.49" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_36_route&#45;&gt;moe_36_expert_3 -->
<g id="edge1236" class="edge">
<title>moe_36_route&#45;&gt;moe_36_expert_3</title>
<path fill="none" stroke="black" d="M1583.82,-23417.36C1418.76,-23406.97 1181.32,-23388.32 965.16,-23356.59"/>
<polygon fill="black" stroke="black" points="965.61,-23353.12 955.21,-23355.12 964.59,-23360.05 965.61,-23353.12"/>
</g>
<!-- moe_36_expert_4 -->
<g id="node757" class="node">
<title>moe_36_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1191,-23356.49 973,-23356.49 973,-23304.49 1191,-23304.49 1191,-23356.49"/>
<text text-anchor="middle" x="1082" y="-23344.49" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1082" y="-23333.49" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1082" y="-23322.49" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1082" y="-23311.49" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_36_route&#45;&gt;moe_36_expert_4 -->
<g id="edge1237" class="edge">
<title>moe_36_route&#45;&gt;moe_36_expert_4</title>
<path fill="none" stroke="black" d="M1604.38,-23409.91C1490.62,-23397.64 1341.9,-23379.78 1201.33,-23356.66"/>
<polygon fill="black" stroke="black" points="1201.66,-23353.17 1191.23,-23354.99 1200.52,-23360.07 1201.66,-23353.17"/>
</g>
<!-- moe_36_expert_5 -->
<g id="node758" class="node">
<title>moe_36_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1427,-23356.49 1209,-23356.49 1209,-23304.49 1427,-23304.49 1427,-23356.49"/>
<text text-anchor="middle" x="1318" y="-23344.49" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1318" y="-23333.49" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1318" y="-23322.49" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1318" y="-23311.49" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_36_route&#45;&gt;moe_36_expert_5 -->
<g id="edge1238" class="edge">
<title>moe_36_route&#45;&gt;moe_36_expert_5</title>
<path fill="none" stroke="black" d="M1652.51,-23400.68C1589.62,-23387.99 1513.88,-23372.61 1437.14,-23356.72"/>
<polygon fill="black" stroke="black" points="1437.79,-23353.28 1427.28,-23354.68 1436.37,-23360.14 1437.79,-23353.28"/>
</g>
<!-- moe_36_expert_6 -->
<g id="node759" class="node">
<title>moe_36_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1663,-23356.49 1445,-23356.49 1445,-23304.49 1663,-23304.49 1663,-23356.49"/>
<text text-anchor="middle" x="1554" y="-23344.49" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1554" y="-23333.49" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1554" y="-23322.49" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1554" y="-23311.49" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_36_route&#45;&gt;moe_36_expert_6 -->
<g id="edge1239" class="edge">
<title>moe_36_route&#45;&gt;moe_36_expert_6</title>
<path fill="none" stroke="black" d="M1709.11,-23395.1C1681.54,-23383.79 1650.96,-23371.25 1624.29,-23360.32"/>
<polygon fill="black" stroke="black" points="1625.61,-23357.07 1615.03,-23356.52 1622.95,-23363.55 1625.61,-23357.07"/>
</g>
<!-- moe_36_expert_7 -->
<g id="node760" class="node">
<title>moe_36_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1899,-23356.49 1681,-23356.49 1681,-23304.49 1899,-23304.49 1899,-23356.49"/>
<text text-anchor="middle" x="1790" y="-23344.49" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1790" y="-23333.49" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1790" y="-23322.49" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1790" y="-23311.49" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_36_route&#45;&gt;moe_36_expert_7 -->
<g id="edge1240" class="edge">
<title>moe_36_route&#45;&gt;moe_36_expert_7</title>
<path fill="none" stroke="black" d="M1790,-23392.23C1790,-23383.92 1790,-23375.08 1790,-23366.8"/>
<polygon fill="black" stroke="black" points="1793.5,-23366.69 1790,-23356.69 1786.5,-23366.69 1793.5,-23366.69"/>
</g>
<!-- moe_36_expert_8 -->
<g id="node761" class="node">
<title>moe_36_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2135,-23356.49 1917,-23356.49 1917,-23304.49 2135,-23304.49 2135,-23356.49"/>
<text text-anchor="middle" x="2026" y="-23344.49" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2026" y="-23333.49" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2026" y="-23322.49" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2026" y="-23311.49" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_36_route&#45;&gt;moe_36_expert_8 -->
<g id="edge1241" class="edge">
<title>moe_36_route&#45;&gt;moe_36_expert_8</title>
<path fill="none" stroke="black" d="M1870.89,-23395.1C1898.46,-23383.79 1929.04,-23371.25 1955.71,-23360.32"/>
<polygon fill="black" stroke="black" points="1957.05,-23363.55 1964.97,-23356.52 1954.39,-23357.07 1957.05,-23363.55"/>
</g>
<!-- moe_36_expert_9 -->
<g id="node762" class="node">
<title>moe_36_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2371,-23356.49 2153,-23356.49 2153,-23304.49 2371,-23304.49 2371,-23356.49"/>
<text text-anchor="middle" x="2262" y="-23344.49" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2262" y="-23333.49" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2262" y="-23322.49" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2262" y="-23311.49" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_36_route&#45;&gt;moe_36_expert_9 -->
<g id="edge1242" class="edge">
<title>moe_36_route&#45;&gt;moe_36_expert_9</title>
<path fill="none" stroke="black" d="M1927.49,-23400.68C1990.38,-23387.99 2066.12,-23372.61 2142.86,-23356.72"/>
<polygon fill="black" stroke="black" points="2143.63,-23360.14 2152.72,-23354.68 2142.21,-23353.28 2143.63,-23360.14"/>
</g>
<!-- moe_36_expert_10 -->
<g id="node763" class="node">
<title>moe_36_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2607,-23356.49 2389,-23356.49 2389,-23304.49 2607,-23304.49 2607,-23356.49"/>
<text text-anchor="middle" x="2498" y="-23344.49" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2498" y="-23333.49" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2498" y="-23322.49" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2498" y="-23311.49" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_36_route&#45;&gt;moe_36_expert_10 -->
<g id="edge1243" class="edge">
<title>moe_36_route&#45;&gt;moe_36_expert_10</title>
<path fill="none" stroke="black" d="M1975.62,-23409.91C2089.38,-23397.64 2238.1,-23379.78 2378.67,-23356.66"/>
<polygon fill="black" stroke="black" points="2379.48,-23360.07 2388.77,-23354.99 2378.34,-23353.17 2379.48,-23360.07"/>
</g>
<!-- moe_36_expert_11 -->
<g id="node764" class="node">
<title>moe_36_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2843,-23356.49 2625,-23356.49 2625,-23304.49 2843,-23304.49 2843,-23356.49"/>
<text text-anchor="middle" x="2734" y="-23344.49" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2734" y="-23333.49" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2734" y="-23322.49" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2734" y="-23311.49" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_36_route&#45;&gt;moe_36_expert_11 -->
<g id="edge1244" class="edge">
<title>moe_36_route&#45;&gt;moe_36_expert_11</title>
<path fill="none" stroke="black" d="M1996.18,-23417.36C2161.24,-23406.97 2398.68,-23388.32 2614.84,-23356.59"/>
<polygon fill="black" stroke="black" points="2615.41,-23360.05 2624.79,-23355.12 2614.39,-23353.12 2615.41,-23360.05"/>
</g>
<!-- moe_36_expert_12 -->
<g id="node765" class="node">
<title>moe_36_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3079,-23356.49 2861,-23356.49 2861,-23304.49 3079,-23304.49 3079,-23356.49"/>
<text text-anchor="middle" x="2970" y="-23344.49" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2970" y="-23333.49" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2970" y="-23322.49" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2970" y="-23311.49" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_36_route&#45;&gt;moe_36_expert_12 -->
<g id="edge1245" class="edge">
<title>moe_36_route&#45;&gt;moe_36_expert_12</title>
<path fill="none" stroke="black" d="M2004.49,-23422.66C2217.23,-23415.04 2552.43,-23397.48 2850.66,-23356.6"/>
<polygon fill="black" stroke="black" points="2851.38,-23360.03 2860.8,-23355.2 2850.42,-23353.1 2851.38,-23360.03"/>
</g>
<!-- moe_36_expert_13 -->
<g id="node766" class="node">
<title>moe_36_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3315,-23356.49 3097,-23356.49 3097,-23304.49 3315,-23304.49 3315,-23356.49"/>
<text text-anchor="middle" x="3206" y="-23344.49" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3206" y="-23333.49" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3206" y="-23322.49" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3206" y="-23311.49" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_36_route&#45;&gt;moe_36_expert_13 -->
<g id="edge1246" class="edge">
<title>moe_36_route&#45;&gt;moe_36_expert_13</title>
<path fill="none" stroke="black" d="M2007.41,-23426.42C2263.78,-23421.91 2702.6,-23406.92 3086.89,-23356.55"/>
<polygon fill="black" stroke="black" points="3087.36,-23360.02 3096.81,-23355.24 3086.44,-23353.08 3087.36,-23360.02"/>
</g>
<!-- moe_36_expert_14 -->
<g id="node767" class="node">
<title>moe_36_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3551,-23356.49 3333,-23356.49 3333,-23304.49 3551,-23304.49 3551,-23356.49"/>
<text text-anchor="middle" x="3442" y="-23344.49" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3442" y="-23333.49" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3442" y="-23322.49" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3442" y="-23311.49" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_36_route&#45;&gt;moe_36_expert_14 -->
<g id="edge1247" class="edge">
<title>moe_36_route&#45;&gt;moe_36_expert_14</title>
<path fill="none" stroke="black" d="M2004.23,-23422.53C2359.61,-23412.31 3057.35,-23389.04 3322.79,-23356.54"/>
<polygon fill="black" stroke="black" points="3323.33,-23360 3332.82,-23355.28 3322.46,-23353.05 3323.33,-23360"/>
</g>
<!-- moe_36_expert_15 -->
<g id="node768" class="node">
<title>moe_36_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3787,-23356.49 3569,-23356.49 3569,-23304.49 3787,-23304.49 3787,-23356.49"/>
<text text-anchor="middle" x="3678" y="-23344.49" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3678" y="-23333.49" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3678" y="-23322.49" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3678" y="-23311.49" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_36_route&#45;&gt;moe_36_expert_15 -->
<g id="edge1248" class="edge">
<title>moe_36_route&#45;&gt;moe_36_expert_15</title>
<path fill="none" stroke="black" d="M2005.71,-23424.06C2405.25,-23415.53 3247.28,-23393.85 3558.86,-23356.52"/>
<polygon fill="black" stroke="black" points="3559.32,-23359.99 3568.82,-23355.3 3558.47,-23353.04 3559.32,-23359.99"/>
</g>
<!-- moe_36_aggregate -->
<g id="node769" class="node">
<title>moe_36_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1805" cy="-23231.72" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1805" y="-23245.72" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1805" y="-23234.72" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1805" y="-23223.72" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1805" y="-23212.72" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_36_expert_0&#45;&gt;moe_36_aggregate -->
<g id="edge1249" class="edge">
<title>moe_36_expert_0&#45;&gt;moe_36_aggregate</title>
<path fill="none" stroke="black" d="M247.18,-23305.71C250.15,-23305.27 253.09,-23304.87 256,-23304.49 503.93,-23272.7 1207.23,-23249.27 1574.8,-23238.8"/>
<polygon fill="black" stroke="black" points="1575.15,-23242.29 1585.04,-23238.51 1574.95,-23235.29 1575.15,-23242.29"/>
</g>
<!-- moe_36_expert_1&#45;&gt;moe_36_aggregate -->
<g id="edge1250" class="edge">
<title>moe_36_expert_1&#45;&gt;moe_36_aggregate</title>
<path fill="none" stroke="black" d="M483.19,-23305.74C486.15,-23305.3 489.09,-23304.88 492,-23304.49 867.94,-23254.7 1308.84,-23239.31 1572.1,-23234.64"/>
<polygon fill="black" stroke="black" points="1572.23,-23238.14 1582.17,-23234.46 1572.11,-23231.14 1572.23,-23238.14"/>
</g>
<!-- moe_36_expert_2&#45;&gt;moe_36_aggregate -->
<g id="edge1251" class="edge">
<title>moe_36_expert_2&#45;&gt;moe_36_aggregate</title>
<path fill="none" stroke="black" d="M719.19,-23305.79C722.16,-23305.33 725.1,-23304.9 728,-23304.49 1018.44,-23264.26 1356.19,-23246.4 1574.91,-23238.59"/>
<polygon fill="black" stroke="black" points="1575.04,-23242.09 1584.91,-23238.24 1574.79,-23235.09 1575.04,-23242.09"/>
</g>
<!-- moe_36_expert_3&#45;&gt;moe_36_aggregate -->
<g id="edge1252" class="edge">
<title>moe_36_expert_3&#45;&gt;moe_36_aggregate</title>
<path fill="none" stroke="black" d="M955.21,-23305.86C958.16,-23305.38 961.1,-23304.92 964,-23304.49 1172.93,-23273.57 1413.17,-23254.72 1583.25,-23244.15"/>
<polygon fill="black" stroke="black" points="1583.57,-23247.63 1593.33,-23243.52 1583.13,-23240.65 1583.57,-23247.63"/>
</g>
<!-- moe_36_expert_4&#45;&gt;moe_36_aggregate -->
<g id="edge1253" class="edge">
<title>moe_36_expert_4&#45;&gt;moe_36_aggregate</title>
<path fill="none" stroke="black" d="M1191.23,-23305.99C1194.18,-23305.47 1197.11,-23304.97 1200,-23304.49 1333.98,-23282.4 1485.74,-23264.42 1603.74,-23251.98"/>
<polygon fill="black" stroke="black" points="1604.4,-23255.43 1613.98,-23250.9 1603.67,-23248.47 1604.4,-23255.43"/>
</g>
<!-- moe_36_expert_5&#45;&gt;moe_36_aggregate -->
<g id="edge1254" class="edge">
<title>moe_36_expert_5&#45;&gt;moe_36_aggregate</title>
<path fill="none" stroke="black" d="M1427.28,-23306.28C1430.22,-23305.67 1433.13,-23305.08 1436,-23304.49 1506.72,-23290.13 1585.19,-23274.78 1651.52,-23261.98"/>
<polygon fill="black" stroke="black" points="1652.48,-23265.36 1661.64,-23260.03 1651.15,-23258.49 1652.48,-23265.36"/>
</g>
<!-- moe_36_expert_6&#45;&gt;moe_36_aggregate -->
<g id="edge1255" class="edge">
<title>moe_36_expert_6&#45;&gt;moe_36_aggregate</title>
<path fill="none" stroke="black" d="M1618.97,-23304.45C1646.49,-23293.84 1679.12,-23281.26 1709.31,-23269.62"/>
<polygon fill="black" stroke="black" points="1710.95,-23272.74 1719.02,-23265.87 1708.43,-23266.21 1710.95,-23272.74"/>
</g>
<!-- moe_36_expert_7&#45;&gt;moe_36_aggregate -->
<g id="edge1256" class="edge">
<title>moe_36_expert_7&#45;&gt;moe_36_aggregate</title>
<path fill="none" stroke="black" d="M1793.9,-23304.32C1795.13,-23296.43 1796.52,-23287.45 1797.89,-23278.59"/>
<polygon fill="black" stroke="black" points="1801.35,-23279.12 1799.42,-23268.7 1794.43,-23278.05 1801.35,-23279.12"/>
</g>
<!-- moe_36_expert_8&#45;&gt;moe_36_aggregate -->
<g id="edge1257" class="edge">
<title>moe_36_expert_8&#45;&gt;moe_36_aggregate</title>
<path fill="none" stroke="black" d="M1968.8,-23304.45C1945.22,-23294.12 1917.39,-23281.94 1891.42,-23270.56"/>
<polygon fill="black" stroke="black" points="1892.51,-23267.22 1881.94,-23266.42 1889.7,-23273.63 1892.51,-23267.22"/>
</g>
<!-- moe_36_expert_9&#45;&gt;moe_36_aggregate -->
<g id="edge1258" class="edge">
<title>moe_36_expert_9&#45;&gt;moe_36_aggregate</title>
<path fill="none" stroke="black" d="M2152.71,-23306.34C2149.78,-23305.72 2146.87,-23305.1 2144,-23304.49 2080.17,-23290.98 2009.57,-23276.03 1949.4,-23263.29"/>
<polygon fill="black" stroke="black" points="1949.96,-23259.83 1939.45,-23261.18 1948.51,-23266.68 1949.96,-23259.83"/>
</g>
<!-- moe_36_expert_10&#45;&gt;moe_36_aggregate -->
<g id="edge1259" class="edge">
<title>moe_36_expert_10&#45;&gt;moe_36_aggregate</title>
<path fill="none" stroke="black" d="M2388.77,-23306.01C2385.82,-23305.49 2382.89,-23304.98 2380,-23304.49 2254.68,-23283.44 2113.05,-23265.69 2001.7,-23253.11"/>
<polygon fill="black" stroke="black" points="2002.04,-23249.62 1991.71,-23251.98 2001.25,-23256.58 2002.04,-23249.62"/>
</g>
<!-- moe_36_expert_11&#45;&gt;moe_36_aggregate -->
<g id="edge1260" class="edge">
<title>moe_36_expert_11&#45;&gt;moe_36_aggregate</title>
<path fill="none" stroke="black" d="M2624.79,-23305.87C2621.83,-23305.39 2618.9,-23304.93 2616,-23304.49 2417.12,-23274.74 2188.81,-23255.89 2025.21,-23245.01"/>
<polygon fill="black" stroke="black" points="2025.23,-23241.51 2015.02,-23244.34 2024.77,-23248.49 2025.23,-23241.51"/>
</g>
<!-- moe_36_expert_12&#45;&gt;moe_36_aggregate -->
<g id="edge1261" class="edge">
<title>moe_36_expert_12&#45;&gt;moe_36_aggregate</title>
<path fill="none" stroke="black" d="M2860.8,-23305.8C2857.84,-23305.33 2854.9,-23304.9 2852,-23304.49 2572.23,-23265.47 2247.32,-23247.39 2034.55,-23239.2"/>
<polygon fill="black" stroke="black" points="2034.63,-23235.7 2024.5,-23238.81 2034.36,-23242.69 2034.63,-23235.7"/>
</g>
<!-- moe_36_expert_13&#45;&gt;moe_36_aggregate -->
<g id="edge1262" class="edge">
<title>moe_36_expert_13&#45;&gt;moe_36_aggregate</title>
<path fill="none" stroke="black" d="M3096.81,-23305.75C3093.85,-23305.3 3090.91,-23304.88 3088,-23304.49 2723.29,-23255.95 2296.01,-23240.17 2038.15,-23235.08"/>
<polygon fill="black" stroke="black" points="2037.97,-23231.58 2027.9,-23234.88 2037.83,-23238.57 2037.97,-23231.58"/>
</g>
<!-- moe_36_expert_14&#45;&gt;moe_36_aggregate -->
<g id="edge1263" class="edge">
<title>moe_36_expert_14&#45;&gt;moe_36_aggregate</title>
<path fill="none" stroke="black" d="M3332.82,-23305.71C3329.85,-23305.28 3326.91,-23304.87 3324,-23304.49 2871.56,-23246.27 2337.87,-23233.94 2038.73,-23232.09"/>
<polygon fill="black" stroke="black" points="2038.65,-23228.59 2028.63,-23232.03 2038.61,-23235.59 2038.65,-23228.59"/>
</g>
<!-- moe_36_expert_15&#45;&gt;moe_36_aggregate -->
<g id="edge1264" class="edge">
<title>moe_36_expert_15&#45;&gt;moe_36_aggregate</title>
<path fill="none" stroke="black" d="M3568.82,-23305.69C3565.85,-23305.26 3562.91,-23304.86 3560,-23304.49 3272.32,-23268.4 2443.68,-23246.33 2036.47,-23237.36"/>
<polygon fill="black" stroke="black" points="2036.41,-23233.86 2026.33,-23237.14 2036.25,-23240.86 2036.41,-23233.86"/>
</g>
<!-- moe_36_ffn -->
<g id="node770" class="node">
<title>moe_36_ffn</title>
<polygon fill="lightgreen" stroke="black" points="1963,-23158.96 1647,-23158.96 1647,-23106.96 1963,-23106.96 1963,-23158.96"/>
<text text-anchor="middle" x="1805" y="-23146.96" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1805" y="-23135.96" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1805" y="-23124.96" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1805" y="-23113.96" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_36_aggregate&#45;&gt;moe_36_ffn -->
<g id="edge1265" class="edge">
<title>moe_36_aggregate&#45;&gt;moe_36_ffn</title>
<path fill="none" stroke="black" d="M1805,-23194.69C1805,-23186.38 1805,-23177.55 1805,-23169.26"/>
<polygon fill="black" stroke="black" points="1808.5,-23169.15 1805,-23159.15 1801.5,-23169.15 1808.5,-23169.15"/>
</g>
<!-- moe_36_res2 -->
<g id="node772" class="node">
<title>moe_36_res2</title>
<polygon fill="lightyellow" stroke="black" points="2141.89,-23070.96 1605.97,-23070.96 1468.11,-22966.96 2004.03,-22966.96 2141.89,-23070.96"/>
<text text-anchor="middle" x="1805" y="-23032.96" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1805" y="-23021.96" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1805" y="-23010.96" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1805" y="-22999.96" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_36_ffn&#45;&gt;moe_36_res2 -->
<g id="edge1266" class="edge">
<title>moe_36_ffn&#45;&gt;moe_36_res2</title>
<path fill="none" stroke="black" d="M1805,-23106.82C1805,-23099.14 1805,-23090.32 1805,-23081.32"/>
<polygon fill="black" stroke="black" points="1808.5,-23081.13 1805,-23071.13 1801.5,-23081.13 1808.5,-23081.13"/>
</g>
<!-- moe_36_res1&#45;&gt;moe_36_gate -->
<g id="edge1231" class="edge">
<title>moe_36_res1&#45;&gt;moe_36_gate</title>
<path fill="none" stroke="black" d="M1790,-23641.65C1790,-23633.48 1790,-23624.95 1790,-23616.57"/>
<polygon fill="black" stroke="black" points="1793.5,-23616.46 1790,-23606.46 1786.5,-23616.46 1793.5,-23616.46"/>
</g>
<!-- moe_37_mha -->
<g id="node773" class="node">
<title>moe_37_mha</title>
<polygon fill="lightgreen" stroke="black" points="1963,-22919.96 1647,-22919.96 1647,-22867.96 1963,-22867.96 1963,-22919.96"/>
<text text-anchor="middle" x="1805" y="-22907.96" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1805" y="-22896.96" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1805" y="-22885.96" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1805" y="-22874.96" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_36_res2&#45;&gt;moe_37_mha -->
<g id="edge1267" class="edge">
<title>moe_36_res2&#45;&gt;moe_37_mha</title>
<path fill="none" stroke="black" d="M1805,-22966.86C1805,-22954.53 1805,-22941.63 1805,-22930.21"/>
<polygon fill="black" stroke="black" points="1808.5,-22930.2 1805,-22920.2 1801.5,-22930.2 1808.5,-22930.2"/>
</g>
<!-- moe_37_res1 -->
<g id="node794" class="node">
<title>moe_37_res1</title>
<polygon fill="lightyellow" stroke="black" points="2141.89,-22831.96 1605.97,-22831.96 1468.11,-22727.96 2004.03,-22727.96 2141.89,-22831.96"/>
<text text-anchor="middle" x="1805" y="-22793.96" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1805" y="-22782.96" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1805" y="-22771.96" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1805" y="-22760.96" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_37_mha&#45;&gt;moe_37_res1 -->
<g id="edge1268" class="edge">
<title>moe_37_mha&#45;&gt;moe_37_res1</title>
<path fill="none" stroke="black" d="M1805,-22867.82C1805,-22860.14 1805,-22851.32 1805,-22842.32"/>
<polygon fill="black" stroke="black" points="1808.5,-22842.13 1805,-22832.13 1801.5,-22842.13 1808.5,-22842.13"/>
</g>
<!-- moe_37_gate -->
<g id="node774" class="node">
<title>moe_37_gate</title>
<polygon fill="lightyellow" stroke="black" points="2133.8,-22691.96 1610.75,-22691.96 1476.2,-22587.96 1999.25,-22587.96 2133.8,-22691.96"/>
<text text-anchor="middle" x="1805" y="-22653.96" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1805" y="-22642.96" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1805" y="-22631.96" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1805" y="-22620.96" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_37_route -->
<g id="node775" class="node">
<title>moe_37_route</title>
<ellipse fill="lightblue" stroke="black" cx="1805" cy="-22515.19" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1805" y="-22529.19" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1805" y="-22518.19" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1805" y="-22507.19" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1805" y="-22496.19" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_37_gate&#45;&gt;moe_37_route -->
<g id="edge1270" class="edge">
<title>moe_37_gate&#45;&gt;moe_37_route</title>
<path fill="none" stroke="black" d="M1805,-22587.6C1805,-22579.19 1805,-22570.53 1805,-22562.26"/>
<polygon fill="black" stroke="black" points="1808.5,-22562.04 1805,-22552.04 1801.5,-22562.04 1808.5,-22562.04"/>
</g>
<!-- moe_37_expert_0 -->
<g id="node776" class="node">
<title>moe_37_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="262,-22442.42 44,-22442.42 44,-22390.42 262,-22390.42 262,-22442.42"/>
<text text-anchor="middle" x="153" y="-22430.42" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="153" y="-22419.42" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="153" y="-22408.42" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="153" y="-22397.42" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_37_route&#45;&gt;moe_37_expert_0 -->
<g id="edge1271" class="edge">
<title>moe_37_route&#45;&gt;moe_37_expert_0</title>
<path fill="none" stroke="black" d="M1590.77,-22508.45C1235.39,-22498.23 537.65,-22474.96 272.21,-22442.46"/>
<polygon fill="black" stroke="black" points="272.54,-22438.97 262.18,-22441.2 271.67,-22445.92 272.54,-22438.97"/>
</g>
<!-- moe_37_expert_1 -->
<g id="node777" class="node">
<title>moe_37_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="498,-22442.42 280,-22442.42 280,-22390.42 498,-22390.42 498,-22442.42"/>
<text text-anchor="middle" x="389" y="-22430.42" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="389" y="-22419.42" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="389" y="-22408.42" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="389" y="-22397.42" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_37_route&#45;&gt;moe_37_expert_1 -->
<g id="edge1272" class="edge">
<title>moe_37_route&#45;&gt;moe_37_expert_1</title>
<path fill="none" stroke="black" d="M1587.59,-22512.34C1331.22,-22507.83 892.4,-22492.84 508.11,-22442.48"/>
<polygon fill="black" stroke="black" points="508.56,-22439 498.19,-22441.17 507.64,-22445.94 508.56,-22439"/>
</g>
<!-- moe_37_expert_2 -->
<g id="node778" class="node">
<title>moe_37_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="734,-22442.42 516,-22442.42 516,-22390.42 734,-22390.42 734,-22442.42"/>
<text text-anchor="middle" x="625" y="-22430.42" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="625" y="-22419.42" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="625" y="-22408.42" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="625" y="-22397.42" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_37_route&#45;&gt;moe_37_expert_2 -->
<g id="edge1273" class="edge">
<title>moe_37_route&#45;&gt;moe_37_expert_2</title>
<path fill="none" stroke="black" d="M1590.51,-22508.58C1377.77,-22500.96 1042.57,-22483.4 744.34,-22442.52"/>
<polygon fill="black" stroke="black" points="744.58,-22439.02 734.2,-22441.12 743.62,-22445.95 744.58,-22439.02"/>
</g>
<!-- moe_37_expert_3 -->
<g id="node779" class="node">
<title>moe_37_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="970,-22442.42 752,-22442.42 752,-22390.42 970,-22390.42 970,-22442.42"/>
<text text-anchor="middle" x="861" y="-22430.42" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="861" y="-22419.42" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="861" y="-22408.42" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="861" y="-22397.42" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_37_route&#45;&gt;moe_37_expert_3 -->
<g id="edge1274" class="edge">
<title>moe_37_route&#45;&gt;moe_37_expert_3</title>
<path fill="none" stroke="black" d="M1598.82,-22503.28C1433.76,-22492.89 1196.32,-22474.24 980.16,-22442.52"/>
<polygon fill="black" stroke="black" points="980.61,-22439.04 970.21,-22441.04 979.59,-22445.97 980.61,-22439.04"/>
</g>
<!-- moe_37_expert_4 -->
<g id="node780" class="node">
<title>moe_37_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1206,-22442.42 988,-22442.42 988,-22390.42 1206,-22390.42 1206,-22442.42"/>
<text text-anchor="middle" x="1097" y="-22430.42" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1097" y="-22419.42" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1097" y="-22408.42" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1097" y="-22397.42" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_37_route&#45;&gt;moe_37_expert_4 -->
<g id="edge1275" class="edge">
<title>moe_37_route&#45;&gt;moe_37_expert_4</title>
<path fill="none" stroke="black" d="M1619.38,-22495.83C1505.62,-22483.56 1356.9,-22465.7 1216.33,-22442.58"/>
<polygon fill="black" stroke="black" points="1216.66,-22439.09 1206.23,-22440.91 1215.52,-22446 1216.66,-22439.09"/>
</g>
<!-- moe_37_expert_5 -->
<g id="node781" class="node">
<title>moe_37_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1442,-22442.42 1224,-22442.42 1224,-22390.42 1442,-22390.42 1442,-22442.42"/>
<text text-anchor="middle" x="1333" y="-22430.42" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1333" y="-22419.42" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1333" y="-22408.42" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1333" y="-22397.42" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_37_route&#45;&gt;moe_37_expert_5 -->
<g id="edge1276" class="edge">
<title>moe_37_route&#45;&gt;moe_37_expert_5</title>
<path fill="none" stroke="black" d="M1667.51,-22486.6C1604.62,-22473.91 1528.88,-22458.53 1452.14,-22442.65"/>
<polygon fill="black" stroke="black" points="1452.79,-22439.21 1442.28,-22440.6 1451.37,-22446.06 1452.79,-22439.21"/>
</g>
<!-- moe_37_expert_6 -->
<g id="node782" class="node">
<title>moe_37_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1678,-22442.42 1460,-22442.42 1460,-22390.42 1678,-22390.42 1678,-22442.42"/>
<text text-anchor="middle" x="1569" y="-22430.42" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1569" y="-22419.42" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1569" y="-22408.42" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1569" y="-22397.42" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_37_route&#45;&gt;moe_37_expert_6 -->
<g id="edge1277" class="edge">
<title>moe_37_route&#45;&gt;moe_37_expert_6</title>
<path fill="none" stroke="black" d="M1724.11,-22481.02C1696.54,-22469.71 1665.96,-22457.17 1639.29,-22446.24"/>
<polygon fill="black" stroke="black" points="1640.61,-22443 1630.03,-22442.44 1637.95,-22449.47 1640.61,-22443"/>
</g>
<!-- moe_37_expert_7 -->
<g id="node783" class="node">
<title>moe_37_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1914,-22442.42 1696,-22442.42 1696,-22390.42 1914,-22390.42 1914,-22442.42"/>
<text text-anchor="middle" x="1805" y="-22430.42" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1805" y="-22419.42" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1805" y="-22408.42" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1805" y="-22397.42" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_37_route&#45;&gt;moe_37_expert_7 -->
<g id="edge1278" class="edge">
<title>moe_37_route&#45;&gt;moe_37_expert_7</title>
<path fill="none" stroke="black" d="M1805,-22478.15C1805,-22469.84 1805,-22461.01 1805,-22452.73"/>
<polygon fill="black" stroke="black" points="1808.5,-22452.61 1805,-22442.61 1801.5,-22452.61 1808.5,-22452.61"/>
</g>
<!-- moe_37_expert_8 -->
<g id="node784" class="node">
<title>moe_37_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2150,-22442.42 1932,-22442.42 1932,-22390.42 2150,-22390.42 2150,-22442.42"/>
<text text-anchor="middle" x="2041" y="-22430.42" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2041" y="-22419.42" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2041" y="-22408.42" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2041" y="-22397.42" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_37_route&#45;&gt;moe_37_expert_8 -->
<g id="edge1279" class="edge">
<title>moe_37_route&#45;&gt;moe_37_expert_8</title>
<path fill="none" stroke="black" d="M1885.89,-22481.02C1913.46,-22469.71 1944.04,-22457.17 1970.71,-22446.24"/>
<polygon fill="black" stroke="black" points="1972.05,-22449.47 1979.97,-22442.44 1969.39,-22443 1972.05,-22449.47"/>
</g>
<!-- moe_37_expert_9 -->
<g id="node785" class="node">
<title>moe_37_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2386,-22442.42 2168,-22442.42 2168,-22390.42 2386,-22390.42 2386,-22442.42"/>
<text text-anchor="middle" x="2277" y="-22430.42" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2277" y="-22419.42" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2277" y="-22408.42" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2277" y="-22397.42" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_37_route&#45;&gt;moe_37_expert_9 -->
<g id="edge1280" class="edge">
<title>moe_37_route&#45;&gt;moe_37_expert_9</title>
<path fill="none" stroke="black" d="M1942.49,-22486.6C2005.38,-22473.91 2081.12,-22458.53 2157.86,-22442.65"/>
<polygon fill="black" stroke="black" points="2158.63,-22446.06 2167.72,-22440.6 2157.21,-22439.21 2158.63,-22446.06"/>
</g>
<!-- moe_37_expert_10 -->
<g id="node786" class="node">
<title>moe_37_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2622,-22442.42 2404,-22442.42 2404,-22390.42 2622,-22390.42 2622,-22442.42"/>
<text text-anchor="middle" x="2513" y="-22430.42" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2513" y="-22419.42" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2513" y="-22408.42" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2513" y="-22397.42" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_37_route&#45;&gt;moe_37_expert_10 -->
<g id="edge1281" class="edge">
<title>moe_37_route&#45;&gt;moe_37_expert_10</title>
<path fill="none" stroke="black" d="M1990.62,-22495.83C2104.38,-22483.56 2253.1,-22465.7 2393.67,-22442.58"/>
<polygon fill="black" stroke="black" points="2394.48,-22446 2403.77,-22440.91 2393.34,-22439.09 2394.48,-22446"/>
</g>
<!-- moe_37_expert_11 -->
<g id="node787" class="node">
<title>moe_37_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2858,-22442.42 2640,-22442.42 2640,-22390.42 2858,-22390.42 2858,-22442.42"/>
<text text-anchor="middle" x="2749" y="-22430.42" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2749" y="-22419.42" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2749" y="-22408.42" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2749" y="-22397.42" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_37_route&#45;&gt;moe_37_expert_11 -->
<g id="edge1282" class="edge">
<title>moe_37_route&#45;&gt;moe_37_expert_11</title>
<path fill="none" stroke="black" d="M2011.18,-22503.28C2176.24,-22492.89 2413.68,-22474.24 2629.84,-22442.52"/>
<polygon fill="black" stroke="black" points="2630.41,-22445.97 2639.79,-22441.04 2629.39,-22439.04 2630.41,-22445.97"/>
</g>
<!-- moe_37_expert_12 -->
<g id="node788" class="node">
<title>moe_37_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3094,-22442.42 2876,-22442.42 2876,-22390.42 3094,-22390.42 3094,-22442.42"/>
<text text-anchor="middle" x="2985" y="-22430.42" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2985" y="-22419.42" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2985" y="-22408.42" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2985" y="-22397.42" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_37_route&#45;&gt;moe_37_expert_12 -->
<g id="edge1283" class="edge">
<title>moe_37_route&#45;&gt;moe_37_expert_12</title>
<path fill="none" stroke="black" d="M2019.49,-22508.58C2232.23,-22500.96 2567.43,-22483.4 2865.66,-22442.52"/>
<polygon fill="black" stroke="black" points="2866.38,-22445.95 2875.8,-22441.12 2865.42,-22439.02 2866.38,-22445.95"/>
</g>
<!-- moe_37_expert_13 -->
<g id="node789" class="node">
<title>moe_37_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3330,-22442.42 3112,-22442.42 3112,-22390.42 3330,-22390.42 3330,-22442.42"/>
<text text-anchor="middle" x="3221" y="-22430.42" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3221" y="-22419.42" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3221" y="-22408.42" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3221" y="-22397.42" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_37_route&#45;&gt;moe_37_expert_13 -->
<g id="edge1284" class="edge">
<title>moe_37_route&#45;&gt;moe_37_expert_13</title>
<path fill="none" stroke="black" d="M2022.41,-22512.34C2278.78,-22507.83 2717.6,-22492.84 3101.89,-22442.48"/>
<polygon fill="black" stroke="black" points="3102.36,-22445.94 3111.81,-22441.17 3101.44,-22439 3102.36,-22445.94"/>
</g>
<!-- moe_37_expert_14 -->
<g id="node790" class="node">
<title>moe_37_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3566,-22442.42 3348,-22442.42 3348,-22390.42 3566,-22390.42 3566,-22442.42"/>
<text text-anchor="middle" x="3457" y="-22430.42" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3457" y="-22419.42" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3457" y="-22408.42" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3457" y="-22397.42" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_37_route&#45;&gt;moe_37_expert_14 -->
<g id="edge1285" class="edge">
<title>moe_37_route&#45;&gt;moe_37_expert_14</title>
<path fill="none" stroke="black" d="M2019.23,-22508.45C2374.61,-22498.23 3072.35,-22474.96 3337.79,-22442.46"/>
<polygon fill="black" stroke="black" points="3338.33,-22445.92 3347.82,-22441.2 3337.46,-22438.97 3338.33,-22445.92"/>
</g>
<!-- moe_37_expert_15 -->
<g id="node791" class="node">
<title>moe_37_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3802,-22442.42 3584,-22442.42 3584,-22390.42 3802,-22390.42 3802,-22442.42"/>
<text text-anchor="middle" x="3693" y="-22430.42" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3693" y="-22419.42" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3693" y="-22408.42" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3693" y="-22397.42" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_37_route&#45;&gt;moe_37_expert_15 -->
<g id="edge1286" class="edge">
<title>moe_37_route&#45;&gt;moe_37_expert_15</title>
<path fill="none" stroke="black" d="M2020.71,-22509.98C2420.25,-22501.45 3262.28,-22479.77 3573.86,-22442.44"/>
<polygon fill="black" stroke="black" points="3574.32,-22445.91 3583.82,-22441.22 3573.47,-22438.97 3574.32,-22445.91"/>
</g>
<!-- moe_37_aggregate -->
<g id="node792" class="node">
<title>moe_37_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1834" cy="-22317.65" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1834" y="-22331.65" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1834" y="-22320.65" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1834" y="-22309.65" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1834" y="-22298.65" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_37_expert_0&#45;&gt;moe_37_aggregate -->
<g id="edge1287" class="edge">
<title>moe_37_expert_0&#45;&gt;moe_37_aggregate</title>
<path fill="none" stroke="black" d="M262.18,-22391.63C265.15,-22391.19 268.09,-22390.79 271,-22390.42 521.74,-22358.32 1234.02,-22334.96 1604.22,-22324.6"/>
<polygon fill="black" stroke="black" points="1604.36,-22328.09 1614.26,-22324.32 1604.16,-22321.1 1604.36,-22328.09"/>
</g>
<!-- moe_37_expert_1&#45;&gt;moe_37_aggregate -->
<g id="edge1288" class="edge">
<title>moe_37_expert_1&#45;&gt;moe_37_aggregate</title>
<path fill="none" stroke="black" d="M498.19,-22391.66C501.15,-22391.22 504.09,-22390.8 507,-22390.42 887.94,-22340.07 1334.87,-22324.85 1600.69,-22320.37"/>
<polygon fill="black" stroke="black" points="1600.91,-22323.87 1610.85,-22320.2 1600.8,-22316.87 1600.91,-22323.87"/>
</g>
<!-- moe_37_expert_2&#45;&gt;moe_37_aggregate -->
<g id="edge1289" class="edge">
<title>moe_37_expert_2&#45;&gt;moe_37_aggregate</title>
<path fill="none" stroke="black" d="M734.19,-22391.71C737.16,-22391.25 740.1,-22390.82 743,-22390.42 1038.38,-22349.62 1382.04,-22331.87 1603.52,-22324.24"/>
<polygon fill="black" stroke="black" points="1603.77,-22327.73 1613.65,-22323.9 1603.54,-22320.74 1603.77,-22327.73"/>
</g>
<!-- moe_37_expert_3&#45;&gt;moe_37_aggregate -->
<g id="edge1290" class="edge">
<title>moe_37_expert_3&#45;&gt;moe_37_aggregate</title>
<path fill="none" stroke="black" d="M970.2,-22391.78C973.16,-22391.3 976.1,-22390.84 979,-22390.42 1192.59,-22358.95 1438.39,-22340.11 1611.46,-22329.68"/>
<polygon fill="black" stroke="black" points="1611.68,-22333.18 1621.45,-22329.09 1611.26,-22326.19 1611.68,-22333.18"/>
</g>
<!-- moe_37_expert_4&#45;&gt;moe_37_aggregate -->
<g id="edge1291" class="edge">
<title>moe_37_expert_4&#45;&gt;moe_37_aggregate</title>
<path fill="none" stroke="black" d="M1206.22,-22391.9C1209.18,-22391.39 1212.11,-22390.89 1215,-22390.42 1353.25,-22367.81 1510,-22349.71 1631.18,-22337.34"/>
<polygon fill="black" stroke="black" points="1631.72,-22340.8 1641.31,-22336.31 1631.01,-22333.84 1631.72,-22340.8"/>
</g>
<!-- moe_37_expert_5&#45;&gt;moe_37_aggregate -->
<g id="edge1292" class="edge">
<title>moe_37_expert_5&#45;&gt;moe_37_aggregate</title>
<path fill="none" stroke="black" d="M1442.27,-22392.17C1445.21,-22391.58 1448.12,-22390.99 1451,-22390.42 1525.14,-22375.62 1607.54,-22360.06 1676.85,-22347.23"/>
<polygon fill="black" stroke="black" points="1677.79,-22350.62 1686.98,-22345.36 1676.51,-22343.74 1677.79,-22350.62"/>
</g>
<!-- moe_37_expert_6&#45;&gt;moe_37_aggregate -->
<g id="edge1293" class="edge">
<title>moe_37_expert_6&#45;&gt;moe_37_aggregate</title>
<path fill="none" stroke="black" d="M1637.59,-22390.37C1667.18,-22379.56 1702.36,-22366.72 1734.72,-22354.9"/>
<polygon fill="black" stroke="black" points="1736.02,-22358.15 1744.21,-22351.43 1733.62,-22351.58 1736.02,-22358.15"/>
</g>
<!-- moe_37_expert_7&#45;&gt;moe_37_aggregate -->
<g id="edge1294" class="edge">
<title>moe_37_expert_7&#45;&gt;moe_37_aggregate</title>
<path fill="none" stroke="black" d="M1812.54,-22390.24C1814.93,-22382.27 1817.66,-22373.18 1820.34,-22364.23"/>
<polygon fill="black" stroke="black" points="1823.7,-22365.21 1823.22,-22354.62 1817,-22363.2 1823.7,-22365.21"/>
</g>
<!-- moe_37_expert_8&#45;&gt;moe_37_aggregate -->
<g id="edge1295" class="edge">
<title>moe_37_expert_8&#45;&gt;moe_37_aggregate</title>
<path fill="none" stroke="black" d="M1987.42,-22390.37C1965.54,-22380.14 1939.75,-22368.08 1915.61,-22356.8"/>
<polygon fill="black" stroke="black" points="1917,-22353.58 1906.46,-22352.52 1914.03,-22359.92 1917,-22353.58"/>
</g>
<!-- moe_37_expert_9&#45;&gt;moe_37_aggregate -->
<g id="edge1296" class="edge">
<title>moe_37_expert_9&#45;&gt;moe_37_aggregate</title>
<path fill="none" stroke="black" d="M2167.78,-22391.56C2109.78,-22378.89 2037.81,-22363.17 1975.57,-22349.57"/>
<polygon fill="black" stroke="black" points="1976.18,-22346.12 1965.67,-22347.41 1974.69,-22352.96 1976.18,-22346.12"/>
</g>
<!-- moe_37_expert_10&#45;&gt;moe_37_aggregate -->
<g id="edge1297" class="edge">
<title>moe_37_expert_10&#45;&gt;moe_37_aggregate</title>
<path fill="none" stroke="black" d="M2403.77,-22391.95C2400.82,-22391.42 2397.89,-22390.91 2395,-22390.42 2273.78,-22369.86 2136.93,-22352.24 2028.74,-22339.6"/>
<polygon fill="black" stroke="black" points="2029.03,-22336.11 2018.69,-22338.44 2028.22,-22343.07 2029.03,-22336.11"/>
</g>
<!-- moe_37_expert_11&#45;&gt;moe_37_aggregate -->
<g id="edge1298" class="edge">
<title>moe_37_expert_11&#45;&gt;moe_37_aggregate</title>
<path fill="none" stroke="black" d="M2639.79,-22391.8C2636.83,-22391.32 2633.9,-22390.85 2631,-22390.42 2436.72,-22361.19 2213.88,-22342.36 2053.32,-22331.35"/>
<polygon fill="black" stroke="black" points="2053.53,-22327.85 2043.31,-22330.67 2053.05,-22334.84 2053.53,-22327.85"/>
</g>
<!-- moe_37_expert_12&#45;&gt;moe_37_aggregate -->
<g id="edge1299" class="edge">
<title>moe_37_expert_12&#45;&gt;moe_37_aggregate</title>
<path fill="none" stroke="black" d="M2875.8,-22391.72C2872.84,-22391.26 2869.9,-22390.82 2867,-22390.42 2592.2,-22351.95 2273.26,-22333.78 2063.3,-22325.41"/>
<polygon fill="black" stroke="black" points="2063.2,-22321.91 2053.07,-22325.01 2062.92,-22328.9 2063.2,-22321.91"/>
</g>
<!-- moe_37_expert_13&#45;&gt;moe_37_aggregate -->
<g id="edge1300" class="edge">
<title>moe_37_expert_13&#45;&gt;moe_37_aggregate</title>
<path fill="none" stroke="black" d="M3111.81,-22391.67C3108.85,-22391.22 3105.91,-22390.8 3103,-22390.42 2743.35,-22342.43 2322.18,-22326.48 2066.9,-22321.21"/>
<polygon fill="black" stroke="black" points="2066.82,-22317.71 2056.75,-22321 2066.68,-22324.7 2066.82,-22317.71"/>
</g>
<!-- moe_37_expert_14&#45;&gt;moe_37_aggregate -->
<g id="edge1301" class="edge">
<title>moe_37_expert_14&#45;&gt;moe_37_aggregate</title>
<path fill="none" stroke="black" d="M3347.82,-22391.64C3344.85,-22391.2 3341.91,-22390.79 3339,-22390.42 2891.69,-22332.75 2364.23,-22320.2 2067.49,-22318.16"/>
<polygon fill="black" stroke="black" points="2067.49,-22314.66 2057.47,-22318.09 2067.44,-22321.66 2067.49,-22314.66"/>
</g>
<!-- moe_37_expert_15&#45;&gt;moe_37_aggregate -->
<g id="edge1302" class="edge">
<title>moe_37_expert_15&#45;&gt;moe_37_aggregate</title>
<path fill="none" stroke="black" d="M3583.82,-22391.61C3580.85,-22391.18 3577.91,-22390.78 3575,-22390.42 3289.99,-22354.61 2469.73,-22332.43 2065.2,-22323.37"/>
<polygon fill="black" stroke="black" points="2065.21,-22319.87 2055.13,-22323.14 2065.05,-22326.86 2065.21,-22319.87"/>
</g>
<!-- moe_37_ffn -->
<g id="node793" class="node">
<title>moe_37_ffn</title>
<polygon fill="lightgreen" stroke="black" points="1992,-22244.88 1676,-22244.88 1676,-22192.88 1992,-22192.88 1992,-22244.88"/>
<text text-anchor="middle" x="1834" y="-22232.88" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1834" y="-22221.88" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1834" y="-22210.88" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1834" y="-22199.88" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_37_aggregate&#45;&gt;moe_37_ffn -->
<g id="edge1303" class="edge">
<title>moe_37_aggregate&#45;&gt;moe_37_ffn</title>
<path fill="none" stroke="black" d="M1834,-22280.61C1834,-22272.3 1834,-22263.47 1834,-22255.19"/>
<polygon fill="black" stroke="black" points="1837.5,-22255.07 1834,-22245.07 1830.5,-22255.07 1837.5,-22255.07"/>
</g>
<!-- moe_37_res2 -->
<g id="node795" class="node">
<title>moe_37_res2</title>
<polygon fill="lightyellow" stroke="black" points="2170.89,-22156.88 1634.97,-22156.88 1497.11,-22052.88 2033.03,-22052.88 2170.89,-22156.88"/>
<text text-anchor="middle" x="1834" y="-22118.88" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1834" y="-22107.88" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1834" y="-22096.88" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1834" y="-22085.88" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_37_ffn&#45;&gt;moe_37_res2 -->
<g id="edge1304" class="edge">
<title>moe_37_ffn&#45;&gt;moe_37_res2</title>
<path fill="none" stroke="black" d="M1834,-22192.74C1834,-22185.06 1834,-22176.24 1834,-22167.25"/>
<polygon fill="black" stroke="black" points="1837.5,-22167.06 1834,-22157.06 1830.5,-22167.06 1837.5,-22167.06"/>
</g>
<!-- moe_37_res1&#45;&gt;moe_37_gate -->
<g id="edge1269" class="edge">
<title>moe_37_res1&#45;&gt;moe_37_gate</title>
<path fill="none" stroke="black" d="M1805,-22727.57C1805,-22719.4 1805,-22710.87 1805,-22702.49"/>
<polygon fill="black" stroke="black" points="1808.5,-22702.38 1805,-22692.38 1801.5,-22702.38 1808.5,-22702.38"/>
</g>
<!-- moe_38_mha -->
<g id="node796" class="node">
<title>moe_38_mha</title>
<polygon fill="lightgreen" stroke="black" points="1992,-22005.88 1676,-22005.88 1676,-21953.88 1992,-21953.88 1992,-22005.88"/>
<text text-anchor="middle" x="1834" y="-21993.88" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1834" y="-21982.88" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1834" y="-21971.88" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1834" y="-21960.88" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_37_res2&#45;&gt;moe_38_mha -->
<g id="edge1305" class="edge">
<title>moe_37_res2&#45;&gt;moe_38_mha</title>
<path fill="none" stroke="black" d="M1834,-22052.78C1834,-22040.45 1834,-22027.55 1834,-22016.13"/>
<polygon fill="black" stroke="black" points="1837.5,-22016.12 1834,-22006.12 1830.5,-22016.12 1837.5,-22016.12"/>
</g>
<!-- moe_38_res1 -->
<g id="node817" class="node">
<title>moe_38_res1</title>
<polygon fill="lightyellow" stroke="black" points="2170.89,-21917.88 1634.97,-21917.88 1497.11,-21813.88 2033.03,-21813.88 2170.89,-21917.88"/>
<text text-anchor="middle" x="1834" y="-21879.88" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1834" y="-21868.88" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1834" y="-21857.88" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1834" y="-21846.88" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_38_mha&#45;&gt;moe_38_res1 -->
<g id="edge1306" class="edge">
<title>moe_38_mha&#45;&gt;moe_38_res1</title>
<path fill="none" stroke="black" d="M1834,-21953.74C1834,-21946.06 1834,-21937.24 1834,-21928.25"/>
<polygon fill="black" stroke="black" points="1837.5,-21928.06 1834,-21918.06 1830.5,-21928.06 1837.5,-21928.06"/>
</g>
<!-- moe_38_gate -->
<g id="node797" class="node">
<title>moe_38_gate</title>
<polygon fill="lightyellow" stroke="black" points="2162.8,-21777.88 1639.75,-21777.88 1505.2,-21673.88 2028.25,-21673.88 2162.8,-21777.88"/>
<text text-anchor="middle" x="1834" y="-21739.88" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1834" y="-21728.88" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1834" y="-21717.88" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1834" y="-21706.88" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_38_route -->
<g id="node798" class="node">
<title>moe_38_route</title>
<ellipse fill="lightblue" stroke="black" cx="1834" cy="-21601.11" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1834" y="-21615.11" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1834" y="-21604.11" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1834" y="-21593.11" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1834" y="-21582.11" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_38_gate&#45;&gt;moe_38_route -->
<g id="edge1308" class="edge">
<title>moe_38_gate&#45;&gt;moe_38_route</title>
<path fill="none" stroke="black" d="M1834,-21673.52C1834,-21665.11 1834,-21656.45 1834,-21648.18"/>
<polygon fill="black" stroke="black" points="1837.5,-21647.96 1834,-21637.96 1830.5,-21647.96 1837.5,-21647.96"/>
</g>
<!-- moe_38_expert_0 -->
<g id="node799" class="node">
<title>moe_38_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="291,-21528.34 73,-21528.34 73,-21476.34 291,-21476.34 291,-21528.34"/>
<text text-anchor="middle" x="182" y="-21516.34" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="182" y="-21505.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="182" y="-21494.34" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="182" y="-21483.34" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_38_route&#45;&gt;moe_38_expert_0 -->
<g id="edge1309" class="edge">
<title>moe_38_route&#45;&gt;moe_38_expert_0</title>
<path fill="none" stroke="black" d="M1619.77,-21594.38C1264.39,-21584.16 566.65,-21560.88 301.21,-21528.38"/>
<polygon fill="black" stroke="black" points="301.54,-21524.89 291.18,-21527.12 300.67,-21531.84 301.54,-21524.89"/>
</g>
<!-- moe_38_expert_1 -->
<g id="node800" class="node">
<title>moe_38_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="527,-21528.34 309,-21528.34 309,-21476.34 527,-21476.34 527,-21528.34"/>
<text text-anchor="middle" x="418" y="-21516.34" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="418" y="-21505.34" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="418" y="-21494.34" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="418" y="-21483.34" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_38_route&#45;&gt;moe_38_expert_1 -->
<g id="edge1310" class="edge">
<title>moe_38_route&#45;&gt;moe_38_expert_1</title>
<path fill="none" stroke="black" d="M1616.59,-21598.26C1360.22,-21593.75 921.4,-21578.76 537.11,-21528.4"/>
<polygon fill="black" stroke="black" points="537.56,-21524.93 527.19,-21527.09 536.64,-21531.87 537.56,-21524.93"/>
</g>
<!-- moe_38_expert_2 -->
<g id="node801" class="node">
<title>moe_38_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="763,-21528.34 545,-21528.34 545,-21476.34 763,-21476.34 763,-21528.34"/>
<text text-anchor="middle" x="654" y="-21516.34" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="654" y="-21505.34" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="654" y="-21494.34" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="654" y="-21483.34" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_38_route&#45;&gt;moe_38_expert_2 -->
<g id="edge1311" class="edge">
<title>moe_38_route&#45;&gt;moe_38_expert_2</title>
<path fill="none" stroke="black" d="M1619.51,-21594.5C1406.77,-21586.88 1071.57,-21569.32 773.34,-21528.44"/>
<polygon fill="black" stroke="black" points="773.58,-21524.94 763.2,-21527.04 772.62,-21531.88 773.58,-21524.94"/>
</g>
<!-- moe_38_expert_3 -->
<g id="node802" class="node">
<title>moe_38_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="999,-21528.34 781,-21528.34 781,-21476.34 999,-21476.34 999,-21528.34"/>
<text text-anchor="middle" x="890" y="-21516.34" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="890" y="-21505.34" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="890" y="-21494.34" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="890" y="-21483.34" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_38_route&#45;&gt;moe_38_expert_3 -->
<g id="edge1312" class="edge">
<title>moe_38_route&#45;&gt;moe_38_expert_3</title>
<path fill="none" stroke="black" d="M1627.82,-21589.2C1462.76,-21578.81 1225.32,-21560.16 1009.16,-21528.44"/>
<polygon fill="black" stroke="black" points="1009.61,-21524.97 999.21,-21526.97 1008.59,-21531.89 1009.61,-21524.97"/>
</g>
<!-- moe_38_expert_4 -->
<g id="node803" class="node">
<title>moe_38_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1235,-21528.34 1017,-21528.34 1017,-21476.34 1235,-21476.34 1235,-21528.34"/>
<text text-anchor="middle" x="1126" y="-21516.34" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1126" y="-21505.34" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1126" y="-21494.34" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1126" y="-21483.34" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_38_route&#45;&gt;moe_38_expert_4 -->
<g id="edge1313" class="edge">
<title>moe_38_route&#45;&gt;moe_38_expert_4</title>
<path fill="none" stroke="black" d="M1648.38,-21581.75C1534.62,-21569.48 1385.9,-21551.62 1245.33,-21528.51"/>
<polygon fill="black" stroke="black" points="1245.66,-21525.01 1235.23,-21526.83 1244.52,-21531.92 1245.66,-21525.01"/>
</g>
<!-- moe_38_expert_5 -->
<g id="node804" class="node">
<title>moe_38_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1471,-21528.34 1253,-21528.34 1253,-21476.34 1471,-21476.34 1471,-21528.34"/>
<text text-anchor="middle" x="1362" y="-21516.34" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1362" y="-21505.34" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1362" y="-21494.34" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1362" y="-21483.34" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_38_route&#45;&gt;moe_38_expert_5 -->
<g id="edge1314" class="edge">
<title>moe_38_route&#45;&gt;moe_38_expert_5</title>
<path fill="none" stroke="black" d="M1696.51,-21572.52C1633.62,-21559.84 1557.88,-21544.46 1481.14,-21528.57"/>
<polygon fill="black" stroke="black" points="1481.79,-21525.13 1471.28,-21526.53 1480.37,-21531.98 1481.79,-21525.13"/>
</g>
<!-- moe_38_expert_6 -->
<g id="node805" class="node">
<title>moe_38_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1707,-21528.34 1489,-21528.34 1489,-21476.34 1707,-21476.34 1707,-21528.34"/>
<text text-anchor="middle" x="1598" y="-21516.34" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1598" y="-21505.34" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1598" y="-21494.34" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1598" y="-21483.34" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_38_route&#45;&gt;moe_38_expert_6 -->
<g id="edge1315" class="edge">
<title>moe_38_route&#45;&gt;moe_38_expert_6</title>
<path fill="none" stroke="black" d="M1753.11,-21566.94C1725.54,-21555.63 1694.96,-21543.09 1668.29,-21532.16"/>
<polygon fill="black" stroke="black" points="1669.61,-21528.92 1659.03,-21528.36 1666.95,-21535.39 1669.61,-21528.92"/>
</g>
<!-- moe_38_expert_7 -->
<g id="node806" class="node">
<title>moe_38_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1943,-21528.34 1725,-21528.34 1725,-21476.34 1943,-21476.34 1943,-21528.34"/>
<text text-anchor="middle" x="1834" y="-21516.34" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1834" y="-21505.34" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1834" y="-21494.34" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1834" y="-21483.34" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_38_route&#45;&gt;moe_38_expert_7 -->
<g id="edge1316" class="edge">
<title>moe_38_route&#45;&gt;moe_38_expert_7</title>
<path fill="none" stroke="black" d="M1834,-21564.07C1834,-21555.76 1834,-21546.93 1834,-21538.65"/>
<polygon fill="black" stroke="black" points="1837.5,-21538.53 1834,-21528.53 1830.5,-21538.53 1837.5,-21538.53"/>
</g>
<!-- moe_38_expert_8 -->
<g id="node807" class="node">
<title>moe_38_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2179,-21528.34 1961,-21528.34 1961,-21476.34 2179,-21476.34 2179,-21528.34"/>
<text text-anchor="middle" x="2070" y="-21516.34" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2070" y="-21505.34" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2070" y="-21494.34" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2070" y="-21483.34" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_38_route&#45;&gt;moe_38_expert_8 -->
<g id="edge1317" class="edge">
<title>moe_38_route&#45;&gt;moe_38_expert_8</title>
<path fill="none" stroke="black" d="M1914.89,-21566.94C1942.46,-21555.63 1973.04,-21543.09 1999.71,-21532.16"/>
<polygon fill="black" stroke="black" points="2001.05,-21535.39 2008.97,-21528.36 1998.39,-21528.92 2001.05,-21535.39"/>
</g>
<!-- moe_38_expert_9 -->
<g id="node808" class="node">
<title>moe_38_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2415,-21528.34 2197,-21528.34 2197,-21476.34 2415,-21476.34 2415,-21528.34"/>
<text text-anchor="middle" x="2306" y="-21516.34" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2306" y="-21505.34" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2306" y="-21494.34" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2306" y="-21483.34" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_38_route&#45;&gt;moe_38_expert_9 -->
<g id="edge1318" class="edge">
<title>moe_38_route&#45;&gt;moe_38_expert_9</title>
<path fill="none" stroke="black" d="M1971.49,-21572.52C2034.38,-21559.84 2110.12,-21544.46 2186.86,-21528.57"/>
<polygon fill="black" stroke="black" points="2187.63,-21531.98 2196.72,-21526.53 2186.21,-21525.13 2187.63,-21531.98"/>
</g>
<!-- moe_38_expert_10 -->
<g id="node809" class="node">
<title>moe_38_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2651,-21528.34 2433,-21528.34 2433,-21476.34 2651,-21476.34 2651,-21528.34"/>
<text text-anchor="middle" x="2542" y="-21516.34" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2542" y="-21505.34" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2542" y="-21494.34" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2542" y="-21483.34" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_38_route&#45;&gt;moe_38_expert_10 -->
<g id="edge1319" class="edge">
<title>moe_38_route&#45;&gt;moe_38_expert_10</title>
<path fill="none" stroke="black" d="M2019.62,-21581.75C2133.38,-21569.48 2282.1,-21551.62 2422.67,-21528.51"/>
<polygon fill="black" stroke="black" points="2423.48,-21531.92 2432.77,-21526.83 2422.34,-21525.01 2423.48,-21531.92"/>
</g>
<!-- moe_38_expert_11 -->
<g id="node810" class="node">
<title>moe_38_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2887,-21528.34 2669,-21528.34 2669,-21476.34 2887,-21476.34 2887,-21528.34"/>
<text text-anchor="middle" x="2778" y="-21516.34" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2778" y="-21505.34" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2778" y="-21494.34" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2778" y="-21483.34" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_38_route&#45;&gt;moe_38_expert_11 -->
<g id="edge1320" class="edge">
<title>moe_38_route&#45;&gt;moe_38_expert_11</title>
<path fill="none" stroke="black" d="M2040.18,-21589.2C2205.24,-21578.81 2442.68,-21560.16 2658.84,-21528.44"/>
<polygon fill="black" stroke="black" points="2659.41,-21531.89 2668.79,-21526.97 2658.39,-21524.97 2659.41,-21531.89"/>
</g>
<!-- moe_38_expert_12 -->
<g id="node811" class="node">
<title>moe_38_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3123,-21528.34 2905,-21528.34 2905,-21476.34 3123,-21476.34 3123,-21528.34"/>
<text text-anchor="middle" x="3014" y="-21516.34" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3014" y="-21505.34" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3014" y="-21494.34" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3014" y="-21483.34" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_38_route&#45;&gt;moe_38_expert_12 -->
<g id="edge1321" class="edge">
<title>moe_38_route&#45;&gt;moe_38_expert_12</title>
<path fill="none" stroke="black" d="M2048.49,-21594.5C2261.23,-21586.88 2596.43,-21569.32 2894.66,-21528.44"/>
<polygon fill="black" stroke="black" points="2895.38,-21531.88 2904.8,-21527.04 2894.42,-21524.94 2895.38,-21531.88"/>
</g>
<!-- moe_38_expert_13 -->
<g id="node812" class="node">
<title>moe_38_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3359,-21528.34 3141,-21528.34 3141,-21476.34 3359,-21476.34 3359,-21528.34"/>
<text text-anchor="middle" x="3250" y="-21516.34" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3250" y="-21505.34" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3250" y="-21494.34" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3250" y="-21483.34" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_38_route&#45;&gt;moe_38_expert_13 -->
<g id="edge1322" class="edge">
<title>moe_38_route&#45;&gt;moe_38_expert_13</title>
<path fill="none" stroke="black" d="M2051.41,-21598.26C2307.78,-21593.75 2746.6,-21578.76 3130.89,-21528.4"/>
<polygon fill="black" stroke="black" points="3131.36,-21531.87 3140.81,-21527.09 3130.44,-21524.93 3131.36,-21531.87"/>
</g>
<!-- moe_38_expert_14 -->
<g id="node813" class="node">
<title>moe_38_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3595,-21528.34 3377,-21528.34 3377,-21476.34 3595,-21476.34 3595,-21528.34"/>
<text text-anchor="middle" x="3486" y="-21516.34" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3486" y="-21505.34" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3486" y="-21494.34" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3486" y="-21483.34" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_38_route&#45;&gt;moe_38_expert_14 -->
<g id="edge1323" class="edge">
<title>moe_38_route&#45;&gt;moe_38_expert_14</title>
<path fill="none" stroke="black" d="M2048.23,-21594.38C2403.61,-21584.16 3101.35,-21560.88 3366.79,-21528.38"/>
<polygon fill="black" stroke="black" points="3367.33,-21531.84 3376.82,-21527.12 3366.46,-21524.89 3367.33,-21531.84"/>
</g>
<!-- moe_38_expert_15 -->
<g id="node814" class="node">
<title>moe_38_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3831,-21528.34 3613,-21528.34 3613,-21476.34 3831,-21476.34 3831,-21528.34"/>
<text text-anchor="middle" x="3722" y="-21516.34" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3722" y="-21505.34" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3722" y="-21494.34" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3722" y="-21483.34" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_38_route&#45;&gt;moe_38_expert_15 -->
<g id="edge1324" class="edge">
<title>moe_38_route&#45;&gt;moe_38_expert_15</title>
<path fill="none" stroke="black" d="M2049.71,-21595.9C2449.25,-21587.37 3291.28,-21565.7 3602.86,-21528.37"/>
<polygon fill="black" stroke="black" points="3603.32,-21531.84 3612.82,-21527.14 3602.47,-21524.89 3603.32,-21531.84"/>
</g>
<!-- moe_38_aggregate -->
<g id="node815" class="node">
<title>moe_38_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1863" cy="-21403.57" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1863" y="-21417.57" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1863" y="-21406.57" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1863" y="-21395.57" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1863" y="-21384.57" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_38_expert_0&#45;&gt;moe_38_aggregate -->
<g id="edge1325" class="edge">
<title>moe_38_expert_0&#45;&gt;moe_38_aggregate</title>
<path fill="none" stroke="black" d="M291.18,-21477.55C294.15,-21477.12 297.09,-21476.71 300,-21476.34 550.74,-21444.24 1263.02,-21420.88 1633.22,-21410.52"/>
<polygon fill="black" stroke="black" points="1633.36,-21414.01 1643.26,-21410.24 1633.16,-21407.02 1633.36,-21414.01"/>
</g>
<!-- moe_38_expert_1&#45;&gt;moe_38_aggregate -->
<g id="edge1326" class="edge">
<title>moe_38_expert_1&#45;&gt;moe_38_aggregate</title>
<path fill="none" stroke="black" d="M527.19,-21477.58C530.15,-21477.14 533.09,-21476.72 536,-21476.34 916.94,-21425.99 1363.87,-21410.78 1629.69,-21406.29"/>
<polygon fill="black" stroke="black" points="1629.91,-21409.79 1639.85,-21406.12 1629.8,-21402.79 1629.91,-21409.79"/>
</g>
<!-- moe_38_expert_2&#45;&gt;moe_38_aggregate -->
<g id="edge1327" class="edge">
<title>moe_38_expert_2&#45;&gt;moe_38_aggregate</title>
<path fill="none" stroke="black" d="M763.19,-21477.63C766.16,-21477.17 769.1,-21476.74 772,-21476.34 1067.38,-21435.55 1411.04,-21417.79 1632.52,-21410.16"/>
<polygon fill="black" stroke="black" points="1632.77,-21413.66 1642.65,-21409.82 1632.54,-21406.66 1632.77,-21413.66"/>
</g>
<!-- moe_38_expert_3&#45;&gt;moe_38_aggregate -->
<g id="edge1328" class="edge">
<title>moe_38_expert_3&#45;&gt;moe_38_aggregate</title>
<path fill="none" stroke="black" d="M999.2,-21477.7C1002.16,-21477.22 1005.1,-21476.77 1008,-21476.34 1221.59,-21444.87 1467.39,-21426.03 1640.46,-21415.61"/>
<polygon fill="black" stroke="black" points="1640.68,-21419.1 1650.45,-21415.01 1640.26,-21412.11 1640.68,-21419.1"/>
</g>
<!-- moe_38_expert_4&#45;&gt;moe_38_aggregate -->
<g id="edge1329" class="edge">
<title>moe_38_expert_4&#45;&gt;moe_38_aggregate</title>
<path fill="none" stroke="black" d="M1235.22,-21477.82C1238.18,-21477.31 1241.11,-21476.81 1244,-21476.34 1382.25,-21453.73 1539,-21435.63 1660.18,-21423.26"/>
<polygon fill="black" stroke="black" points="1660.72,-21426.73 1670.31,-21422.23 1660.01,-21419.76 1660.72,-21426.73"/>
</g>
<!-- moe_38_expert_5&#45;&gt;moe_38_aggregate -->
<g id="edge1330" class="edge">
<title>moe_38_expert_5&#45;&gt;moe_38_aggregate</title>
<path fill="none" stroke="black" d="M1471.27,-21478.09C1474.21,-21477.5 1477.12,-21476.91 1480,-21476.34 1554.14,-21461.54 1636.54,-21445.98 1705.85,-21433.15"/>
<polygon fill="black" stroke="black" points="1706.79,-21436.54 1715.98,-21431.28 1705.51,-21429.66 1706.79,-21436.54"/>
</g>
<!-- moe_38_expert_6&#45;&gt;moe_38_aggregate -->
<g id="edge1331" class="edge">
<title>moe_38_expert_6&#45;&gt;moe_38_aggregate</title>
<path fill="none" stroke="black" d="M1666.59,-21476.29C1696.18,-21465.49 1731.36,-21452.64 1763.72,-21440.82"/>
<polygon fill="black" stroke="black" points="1765.02,-21444.07 1773.21,-21437.36 1762.62,-21437.5 1765.02,-21444.07"/>
</g>
<!-- moe_38_expert_7&#45;&gt;moe_38_aggregate -->
<g id="edge1332" class="edge">
<title>moe_38_expert_7&#45;&gt;moe_38_aggregate</title>
<path fill="none" stroke="black" d="M1841.54,-21476.17C1843.93,-21468.19 1846.66,-21459.11 1849.34,-21450.15"/>
<polygon fill="black" stroke="black" points="1852.7,-21451.13 1852.22,-21440.54 1846,-21449.12 1852.7,-21451.13"/>
</g>
<!-- moe_38_expert_8&#45;&gt;moe_38_aggregate -->
<g id="edge1333" class="edge">
<title>moe_38_expert_8&#45;&gt;moe_38_aggregate</title>
<path fill="none" stroke="black" d="M2016.42,-21476.29C1994.54,-21466.06 1968.75,-21454 1944.61,-21442.72"/>
<polygon fill="black" stroke="black" points="1946,-21439.51 1935.46,-21438.44 1943.03,-21445.85 1946,-21439.51"/>
</g>
<!-- moe_38_expert_9&#45;&gt;moe_38_aggregate -->
<g id="edge1334" class="edge">
<title>moe_38_expert_9&#45;&gt;moe_38_aggregate</title>
<path fill="none" stroke="black" d="M2196.78,-21477.48C2138.78,-21464.81 2066.81,-21449.09 2004.57,-21435.49"/>
<polygon fill="black" stroke="black" points="2005.18,-21432.04 1994.67,-21433.33 2003.69,-21438.88 2005.18,-21432.04"/>
</g>
<!-- moe_38_expert_10&#45;&gt;moe_38_aggregate -->
<g id="edge1335" class="edge">
<title>moe_38_expert_10&#45;&gt;moe_38_aggregate</title>
<path fill="none" stroke="black" d="M2432.77,-21477.87C2429.82,-21477.34 2426.89,-21476.83 2424,-21476.34 2302.78,-21455.78 2165.93,-21438.16 2057.74,-21425.53"/>
<polygon fill="black" stroke="black" points="2058.03,-21422.04 2047.69,-21424.36 2057.22,-21428.99 2058.03,-21422.04"/>
</g>
<!-- moe_38_expert_11&#45;&gt;moe_38_aggregate -->
<g id="edge1336" class="edge">
<title>moe_38_expert_11&#45;&gt;moe_38_aggregate</title>
<path fill="none" stroke="black" d="M2668.79,-21477.72C2665.83,-21477.24 2662.9,-21476.77 2660,-21476.34 2465.72,-21447.12 2242.88,-21428.28 2082.32,-21417.27"/>
<polygon fill="black" stroke="black" points="2082.53,-21413.78 2072.31,-21416.59 2082.05,-21420.76 2082.53,-21413.78"/>
</g>
<!-- moe_38_expert_12&#45;&gt;moe_38_aggregate -->
<g id="edge1337" class="edge">
<title>moe_38_expert_12&#45;&gt;moe_38_aggregate</title>
<path fill="none" stroke="black" d="M2904.8,-21477.64C2901.84,-21477.18 2898.9,-21476.74 2896,-21476.34 2621.2,-21437.87 2302.26,-21419.7 2092.3,-21411.34"/>
<polygon fill="black" stroke="black" points="2092.2,-21407.83 2082.07,-21410.93 2091.92,-21414.82 2092.2,-21407.83"/>
</g>
<!-- moe_38_expert_13&#45;&gt;moe_38_aggregate -->
<g id="edge1338" class="edge">
<title>moe_38_expert_13&#45;&gt;moe_38_aggregate</title>
<path fill="none" stroke="black" d="M3140.81,-21477.59C3137.85,-21477.15 3134.91,-21476.73 3132,-21476.34 2772.35,-21428.35 2351.18,-21412.4 2095.9,-21407.13"/>
<polygon fill="black" stroke="black" points="2095.82,-21403.63 2085.75,-21406.92 2095.68,-21410.63 2095.82,-21403.63"/>
</g>
<!-- moe_38_expert_14&#45;&gt;moe_38_aggregate -->
<g id="edge1339" class="edge">
<title>moe_38_expert_14&#45;&gt;moe_38_aggregate</title>
<path fill="none" stroke="black" d="M3376.82,-21477.56C3373.85,-21477.12 3370.91,-21476.71 3368,-21476.34 2920.69,-21418.67 2393.23,-21406.13 2096.49,-21404.08"/>
<polygon fill="black" stroke="black" points="2096.49,-21400.58 2086.47,-21404.02 2096.44,-21407.58 2096.49,-21400.58"/>
</g>
<!-- moe_38_expert_15&#45;&gt;moe_38_aggregate -->
<g id="edge1340" class="edge">
<title>moe_38_expert_15&#45;&gt;moe_38_aggregate</title>
<path fill="none" stroke="black" d="M3612.82,-21477.53C3609.85,-21477.1 3606.91,-21476.7 3604,-21476.34 3318.99,-21440.53 2498.73,-21418.35 2094.2,-21409.29"/>
<polygon fill="black" stroke="black" points="2094.21,-21405.79 2084.13,-21409.06 2094.05,-21412.79 2094.21,-21405.79"/>
</g>
<!-- moe_38_ffn -->
<g id="node816" class="node">
<title>moe_38_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2021,-21330.8 1705,-21330.8 1705,-21278.8 2021,-21278.8 2021,-21330.8"/>
<text text-anchor="middle" x="1863" y="-21318.8" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1863" y="-21307.8" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-21296.8" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-21285.8" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_38_aggregate&#45;&gt;moe_38_ffn -->
<g id="edge1341" class="edge">
<title>moe_38_aggregate&#45;&gt;moe_38_ffn</title>
<path fill="none" stroke="black" d="M1863,-21366.53C1863,-21358.22 1863,-21349.39 1863,-21341.11"/>
<polygon fill="black" stroke="black" points="1866.5,-21340.99 1863,-21330.99 1859.5,-21340.99 1866.5,-21340.99"/>
</g>
<!-- moe_38_res2 -->
<g id="node818" class="node">
<title>moe_38_res2</title>
<polygon fill="lightyellow" stroke="black" points="2199.89,-21242.8 1663.97,-21242.8 1526.11,-21138.8 2062.03,-21138.8 2199.89,-21242.8"/>
<text text-anchor="middle" x="1863" y="-21204.8" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1863" y="-21193.8" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-21182.8" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1863" y="-21171.8" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_38_ffn&#45;&gt;moe_38_res2 -->
<g id="edge1342" class="edge">
<title>moe_38_ffn&#45;&gt;moe_38_res2</title>
<path fill="none" stroke="black" d="M1863,-21278.66C1863,-21270.98 1863,-21262.17 1863,-21253.17"/>
<polygon fill="black" stroke="black" points="1866.5,-21252.98 1863,-21242.98 1859.5,-21252.98 1866.5,-21252.98"/>
</g>
<!-- moe_38_res1&#45;&gt;moe_38_gate -->
<g id="edge1307" class="edge">
<title>moe_38_res1&#45;&gt;moe_38_gate</title>
<path fill="none" stroke="black" d="M1834,-21813.49C1834,-21805.32 1834,-21796.79 1834,-21788.42"/>
<polygon fill="black" stroke="black" points="1837.5,-21788.31 1834,-21778.31 1830.5,-21788.31 1837.5,-21788.31"/>
</g>
<!-- moe_39_mha -->
<g id="node819" class="node">
<title>moe_39_mha</title>
<polygon fill="lightgreen" stroke="black" points="2021,-21091.8 1705,-21091.8 1705,-21039.8 2021,-21039.8 2021,-21091.8"/>
<text text-anchor="middle" x="1863" y="-21079.8" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1863" y="-21068.8" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-21057.8" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-21046.8" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_38_res2&#45;&gt;moe_39_mha -->
<g id="edge1343" class="edge">
<title>moe_38_res2&#45;&gt;moe_39_mha</title>
<path fill="none" stroke="black" d="M1863,-21138.7C1863,-21126.37 1863,-21113.47 1863,-21102.05"/>
<polygon fill="black" stroke="black" points="1866.5,-21102.04 1863,-21092.04 1859.5,-21102.04 1866.5,-21102.04"/>
</g>
<!-- moe_39_res1 -->
<g id="node840" class="node">
<title>moe_39_res1</title>
<polygon fill="lightyellow" stroke="black" points="2199.89,-21003.8 1663.97,-21003.8 1526.11,-20899.8 2062.03,-20899.8 2199.89,-21003.8"/>
<text text-anchor="middle" x="1863" y="-20965.8" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1863" y="-20954.8" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-20943.8" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1863" y="-20932.8" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_39_mha&#45;&gt;moe_39_res1 -->
<g id="edge1344" class="edge">
<title>moe_39_mha&#45;&gt;moe_39_res1</title>
<path fill="none" stroke="black" d="M1863,-21039.66C1863,-21031.98 1863,-21023.17 1863,-21014.17"/>
<polygon fill="black" stroke="black" points="1866.5,-21013.98 1863,-21003.98 1859.5,-21013.98 1866.5,-21013.98"/>
</g>
<!-- moe_39_gate -->
<g id="node820" class="node">
<title>moe_39_gate</title>
<polygon fill="lightyellow" stroke="black" points="2191.8,-20863.8 1668.75,-20863.8 1534.2,-20759.8 2057.25,-20759.8 2191.8,-20863.8"/>
<text text-anchor="middle" x="1863" y="-20825.8" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1863" y="-20814.8" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-20803.8" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-20792.8" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_39_route -->
<g id="node821" class="node">
<title>moe_39_route</title>
<ellipse fill="lightblue" stroke="black" cx="1863" cy="-20687.03" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1863" y="-20701.03" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1863" y="-20690.03" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1863" y="-20679.03" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-20668.03" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_39_gate&#45;&gt;moe_39_route -->
<g id="edge1346" class="edge">
<title>moe_39_gate&#45;&gt;moe_39_route</title>
<path fill="none" stroke="black" d="M1863,-20759.44C1863,-20751.04 1863,-20742.37 1863,-20734.1"/>
<polygon fill="black" stroke="black" points="1866.5,-20733.88 1863,-20723.88 1859.5,-20733.88 1866.5,-20733.88"/>
</g>
<!-- moe_39_expert_0 -->
<g id="node822" class="node">
<title>moe_39_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="320,-20614.26 102,-20614.26 102,-20562.26 320,-20562.26 320,-20614.26"/>
<text text-anchor="middle" x="211" y="-20602.26" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="211" y="-20591.26" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="211" y="-20580.26" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="211" y="-20569.26" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_39_route&#45;&gt;moe_39_expert_0 -->
<g id="edge1347" class="edge">
<title>moe_39_route&#45;&gt;moe_39_expert_0</title>
<path fill="none" stroke="black" d="M1648.77,-20680.3C1293.39,-20670.08 595.65,-20646.8 330.21,-20614.3"/>
<polygon fill="black" stroke="black" points="330.54,-20610.82 320.18,-20613.04 329.67,-20617.76 330.54,-20610.82"/>
</g>
<!-- moe_39_expert_1 -->
<g id="node823" class="node">
<title>moe_39_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="556,-20614.26 338,-20614.26 338,-20562.26 556,-20562.26 556,-20614.26"/>
<text text-anchor="middle" x="447" y="-20602.26" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="447" y="-20591.26" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="447" y="-20580.26" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="447" y="-20569.26" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_39_route&#45;&gt;moe_39_expert_1 -->
<g id="edge1348" class="edge">
<title>moe_39_route&#45;&gt;moe_39_expert_1</title>
<path fill="none" stroke="black" d="M1645.59,-20684.18C1389.22,-20679.68 950.4,-20664.69 566.11,-20614.32"/>
<polygon fill="black" stroke="black" points="566.56,-20610.85 556.19,-20613.01 565.64,-20617.79 566.56,-20610.85"/>
</g>
<!-- moe_39_expert_2 -->
<g id="node824" class="node">
<title>moe_39_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="792,-20614.26 574,-20614.26 574,-20562.26 792,-20562.26 792,-20614.26"/>
<text text-anchor="middle" x="683" y="-20602.26" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="683" y="-20591.26" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="683" y="-20580.26" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="683" y="-20569.26" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_39_route&#45;&gt;moe_39_expert_2 -->
<g id="edge1349" class="edge">
<title>moe_39_route&#45;&gt;moe_39_expert_2</title>
<path fill="none" stroke="black" d="M1648.51,-20680.42C1435.77,-20672.8 1100.57,-20655.24 802.34,-20614.36"/>
<polygon fill="black" stroke="black" points="802.58,-20610.86 792.2,-20612.96 801.62,-20617.8 802.58,-20610.86"/>
</g>
<!-- moe_39_expert_3 -->
<g id="node825" class="node">
<title>moe_39_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1028,-20614.26 810,-20614.26 810,-20562.26 1028,-20562.26 1028,-20614.26"/>
<text text-anchor="middle" x="919" y="-20602.26" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="919" y="-20591.26" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="919" y="-20580.26" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="919" y="-20569.26" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_39_route&#45;&gt;moe_39_expert_3 -->
<g id="edge1350" class="edge">
<title>moe_39_route&#45;&gt;moe_39_expert_3</title>
<path fill="none" stroke="black" d="M1656.82,-20675.12C1491.76,-20664.73 1254.32,-20646.09 1038.16,-20614.36"/>
<polygon fill="black" stroke="black" points="1038.61,-20610.89 1028.21,-20612.89 1037.59,-20617.81 1038.61,-20610.89"/>
</g>
<!-- moe_39_expert_4 -->
<g id="node826" class="node">
<title>moe_39_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1264,-20614.26 1046,-20614.26 1046,-20562.26 1264,-20562.26 1264,-20614.26"/>
<text text-anchor="middle" x="1155" y="-20602.26" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1155" y="-20591.26" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1155" y="-20580.26" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1155" y="-20569.26" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_39_route&#45;&gt;moe_39_expert_4 -->
<g id="edge1351" class="edge">
<title>moe_39_route&#45;&gt;moe_39_expert_4</title>
<path fill="none" stroke="black" d="M1677.38,-20667.67C1563.62,-20655.4 1414.9,-20637.54 1274.33,-20614.43"/>
<polygon fill="black" stroke="black" points="1274.66,-20610.93 1264.23,-20612.75 1273.52,-20617.84 1274.66,-20610.93"/>
</g>
<!-- moe_39_expert_5 -->
<g id="node827" class="node">
<title>moe_39_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1500,-20614.26 1282,-20614.26 1282,-20562.26 1500,-20562.26 1500,-20614.26"/>
<text text-anchor="middle" x="1391" y="-20602.26" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1391" y="-20591.26" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1391" y="-20580.26" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1391" y="-20569.26" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_39_route&#45;&gt;moe_39_expert_5 -->
<g id="edge1352" class="edge">
<title>moe_39_route&#45;&gt;moe_39_expert_5</title>
<path fill="none" stroke="black" d="M1725.51,-20658.45C1662.62,-20645.76 1586.88,-20630.38 1510.14,-20614.49"/>
<polygon fill="black" stroke="black" points="1510.79,-20611.05 1500.28,-20612.45 1509.37,-20617.9 1510.79,-20611.05"/>
</g>
<!-- moe_39_expert_6 -->
<g id="node828" class="node">
<title>moe_39_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1736,-20614.26 1518,-20614.26 1518,-20562.26 1736,-20562.26 1736,-20614.26"/>
<text text-anchor="middle" x="1627" y="-20602.26" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1627" y="-20591.26" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1627" y="-20580.26" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1627" y="-20569.26" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_39_route&#45;&gt;moe_39_expert_6 -->
<g id="edge1353" class="edge">
<title>moe_39_route&#45;&gt;moe_39_expert_6</title>
<path fill="none" stroke="black" d="M1782.11,-20652.86C1754.54,-20641.56 1723.96,-20629.02 1697.29,-20618.08"/>
<polygon fill="black" stroke="black" points="1698.61,-20614.84 1688.03,-20614.28 1695.95,-20621.32 1698.61,-20614.84"/>
</g>
<!-- moe_39_expert_7 -->
<g id="node829" class="node">
<title>moe_39_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1972,-20614.26 1754,-20614.26 1754,-20562.26 1972,-20562.26 1972,-20614.26"/>
<text text-anchor="middle" x="1863" y="-20602.26" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1863" y="-20591.26" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1863" y="-20580.26" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-20569.26" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_39_route&#45;&gt;moe_39_expert_7 -->
<g id="edge1354" class="edge">
<title>moe_39_route&#45;&gt;moe_39_expert_7</title>
<path fill="none" stroke="black" d="M1863,-20650C1863,-20641.68 1863,-20632.85 1863,-20624.57"/>
<polygon fill="black" stroke="black" points="1866.5,-20624.46 1863,-20614.46 1859.5,-20624.46 1866.5,-20624.46"/>
</g>
<!-- moe_39_expert_8 -->
<g id="node830" class="node">
<title>moe_39_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2208,-20614.26 1990,-20614.26 1990,-20562.26 2208,-20562.26 2208,-20614.26"/>
<text text-anchor="middle" x="2099" y="-20602.26" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2099" y="-20591.26" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2099" y="-20580.26" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2099" y="-20569.26" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_39_route&#45;&gt;moe_39_expert_8 -->
<g id="edge1355" class="edge">
<title>moe_39_route&#45;&gt;moe_39_expert_8</title>
<path fill="none" stroke="black" d="M1943.89,-20652.86C1971.46,-20641.56 2002.04,-20629.02 2028.71,-20618.08"/>
<polygon fill="black" stroke="black" points="2030.05,-20621.32 2037.97,-20614.28 2027.39,-20614.84 2030.05,-20621.32"/>
</g>
<!-- moe_39_expert_9 -->
<g id="node831" class="node">
<title>moe_39_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2444,-20614.26 2226,-20614.26 2226,-20562.26 2444,-20562.26 2444,-20614.26"/>
<text text-anchor="middle" x="2335" y="-20602.26" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2335" y="-20591.26" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2335" y="-20580.26" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2335" y="-20569.26" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_39_route&#45;&gt;moe_39_expert_9 -->
<g id="edge1356" class="edge">
<title>moe_39_route&#45;&gt;moe_39_expert_9</title>
<path fill="none" stroke="black" d="M2000.49,-20658.45C2063.38,-20645.76 2139.12,-20630.38 2215.86,-20614.49"/>
<polygon fill="black" stroke="black" points="2216.63,-20617.9 2225.72,-20612.45 2215.21,-20611.05 2216.63,-20617.9"/>
</g>
<!-- moe_39_expert_10 -->
<g id="node832" class="node">
<title>moe_39_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2680,-20614.26 2462,-20614.26 2462,-20562.26 2680,-20562.26 2680,-20614.26"/>
<text text-anchor="middle" x="2571" y="-20602.26" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2571" y="-20591.26" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2571" y="-20580.26" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2571" y="-20569.26" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_39_route&#45;&gt;moe_39_expert_10 -->
<g id="edge1357" class="edge">
<title>moe_39_route&#45;&gt;moe_39_expert_10</title>
<path fill="none" stroke="black" d="M2048.62,-20667.67C2162.38,-20655.4 2311.1,-20637.54 2451.67,-20614.43"/>
<polygon fill="black" stroke="black" points="2452.48,-20617.84 2461.77,-20612.75 2451.34,-20610.93 2452.48,-20617.84"/>
</g>
<!-- moe_39_expert_11 -->
<g id="node833" class="node">
<title>moe_39_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2916,-20614.26 2698,-20614.26 2698,-20562.26 2916,-20562.26 2916,-20614.26"/>
<text text-anchor="middle" x="2807" y="-20602.26" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2807" y="-20591.26" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2807" y="-20580.26" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2807" y="-20569.26" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_39_route&#45;&gt;moe_39_expert_11 -->
<g id="edge1358" class="edge">
<title>moe_39_route&#45;&gt;moe_39_expert_11</title>
<path fill="none" stroke="black" d="M2069.18,-20675.12C2234.24,-20664.73 2471.68,-20646.09 2687.84,-20614.36"/>
<polygon fill="black" stroke="black" points="2688.41,-20617.81 2697.79,-20612.89 2687.39,-20610.89 2688.41,-20617.81"/>
</g>
<!-- moe_39_expert_12 -->
<g id="node834" class="node">
<title>moe_39_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3152,-20614.26 2934,-20614.26 2934,-20562.26 3152,-20562.26 3152,-20614.26"/>
<text text-anchor="middle" x="3043" y="-20602.26" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3043" y="-20591.26" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3043" y="-20580.26" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3043" y="-20569.26" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_39_route&#45;&gt;moe_39_expert_12 -->
<g id="edge1359" class="edge">
<title>moe_39_route&#45;&gt;moe_39_expert_12</title>
<path fill="none" stroke="black" d="M2077.49,-20680.42C2290.23,-20672.8 2625.43,-20655.24 2923.66,-20614.36"/>
<polygon fill="black" stroke="black" points="2924.38,-20617.8 2933.8,-20612.96 2923.42,-20610.86 2924.38,-20617.8"/>
</g>
<!-- moe_39_expert_13 -->
<g id="node835" class="node">
<title>moe_39_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3388,-20614.26 3170,-20614.26 3170,-20562.26 3388,-20562.26 3388,-20614.26"/>
<text text-anchor="middle" x="3279" y="-20602.26" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3279" y="-20591.26" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3279" y="-20580.26" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3279" y="-20569.26" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_39_route&#45;&gt;moe_39_expert_13 -->
<g id="edge1360" class="edge">
<title>moe_39_route&#45;&gt;moe_39_expert_13</title>
<path fill="none" stroke="black" d="M2080.41,-20684.18C2336.78,-20679.68 2775.6,-20664.69 3159.89,-20614.32"/>
<polygon fill="black" stroke="black" points="3160.36,-20617.79 3169.81,-20613.01 3159.44,-20610.85 3160.36,-20617.79"/>
</g>
<!-- moe_39_expert_14 -->
<g id="node836" class="node">
<title>moe_39_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3624,-20614.26 3406,-20614.26 3406,-20562.26 3624,-20562.26 3624,-20614.26"/>
<text text-anchor="middle" x="3515" y="-20602.26" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3515" y="-20591.26" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3515" y="-20580.26" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3515" y="-20569.26" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_39_route&#45;&gt;moe_39_expert_14 -->
<g id="edge1361" class="edge">
<title>moe_39_route&#45;&gt;moe_39_expert_14</title>
<path fill="none" stroke="black" d="M2077.23,-20680.3C2432.61,-20670.08 3130.35,-20646.8 3395.79,-20614.3"/>
<polygon fill="black" stroke="black" points="3396.33,-20617.76 3405.82,-20613.04 3395.46,-20610.82 3396.33,-20617.76"/>
</g>
<!-- moe_39_expert_15 -->
<g id="node837" class="node">
<title>moe_39_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3860,-20614.26 3642,-20614.26 3642,-20562.26 3860,-20562.26 3860,-20614.26"/>
<text text-anchor="middle" x="3751" y="-20602.26" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3751" y="-20591.26" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3751" y="-20580.26" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3751" y="-20569.26" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_39_route&#45;&gt;moe_39_expert_15 -->
<g id="edge1362" class="edge">
<title>moe_39_route&#45;&gt;moe_39_expert_15</title>
<path fill="none" stroke="black" d="M2078.71,-20681.82C2478.25,-20673.29 3320.28,-20651.62 3631.86,-20614.29"/>
<polygon fill="black" stroke="black" points="3632.32,-20617.76 3641.82,-20613.07 3631.47,-20610.81 3632.32,-20617.76"/>
</g>
<!-- moe_39_aggregate -->
<g id="node838" class="node">
<title>moe_39_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1863" cy="-20489.49" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1863" y="-20503.49" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1863" y="-20492.49" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1863" y="-20481.49" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1863" y="-20470.49" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_39_expert_0&#45;&gt;moe_39_aggregate -->
<g id="edge1363" class="edge">
<title>moe_39_expert_0&#45;&gt;moe_39_aggregate</title>
<path fill="none" stroke="black" d="M320.18,-20563.48C323.15,-20563.04 326.09,-20562.63 329,-20562.26 574.12,-20530.77 1268.7,-20507.25 1633.21,-20496.67"/>
<polygon fill="black" stroke="black" points="1633.47,-20500.17 1643.36,-20496.38 1633.27,-20493.17 1633.47,-20500.17"/>
</g>
<!-- moe_39_expert_1&#45;&gt;moe_39_aggregate -->
<g id="edge1364" class="edge">
<title>moe_39_expert_1&#45;&gt;moe_39_aggregate</title>
<path fill="none" stroke="black" d="M556.19,-20563.51C559.15,-20563.06 562.09,-20562.65 565,-20562.26 935.22,-20513.1 1369.16,-20497.51 1629.76,-20492.63"/>
<polygon fill="black" stroke="black" points="1630.17,-20496.12 1640.11,-20492.44 1630.05,-20489.12 1630.17,-20496.12"/>
</g>
<!-- moe_39_expert_2&#45;&gt;moe_39_aggregate -->
<g id="edge1365" class="edge">
<title>moe_39_expert_2&#45;&gt;moe_39_aggregate</title>
<path fill="none" stroke="black" d="M792.2,-20563.56C795.16,-20563.1 798.1,-20562.66 801,-20562.26 1086.02,-20522.64 1417.23,-20504.66 1632.98,-20496.66"/>
<polygon fill="black" stroke="black" points="1633.3,-20500.15 1643.17,-20496.29 1633.05,-20493.16 1633.3,-20500.15"/>
</g>
<!-- moe_39_expert_3&#45;&gt;moe_39_aggregate -->
<g id="edge1366" class="edge">
<title>moe_39_expert_3&#45;&gt;moe_39_aggregate</title>
<path fill="none" stroke="black" d="M1028.21,-20563.63C1031.16,-20563.15 1034.1,-20562.69 1037,-20562.26 1240.78,-20531.94 1474.89,-20513.09 1641.72,-20502.36"/>
<polygon fill="black" stroke="black" points="1642.35,-20505.82 1652.11,-20501.69 1641.91,-20498.84 1642.35,-20505.82"/>
</g>
<!-- moe_39_expert_4&#45;&gt;moe_39_aggregate -->
<g id="edge1367" class="edge">
<title>moe_39_expert_4&#45;&gt;moe_39_aggregate</title>
<path fill="none" stroke="black" d="M1264.23,-20563.77C1267.18,-20563.24 1270.11,-20562.74 1273,-20562.26 1402.69,-20540.68 1549.43,-20522.8 1664.13,-20510.29"/>
<polygon fill="black" stroke="black" points="1664.51,-20513.77 1674.07,-20509.21 1663.75,-20506.81 1664.51,-20513.77"/>
</g>
<!-- moe_39_expert_5&#45;&gt;moe_39_aggregate -->
<g id="edge1368" class="edge">
<title>moe_39_expert_5&#45;&gt;moe_39_aggregate</title>
<path fill="none" stroke="black" d="M1500.28,-20564.07C1503.22,-20563.46 1506.13,-20562.85 1509,-20562.26 1576.32,-20548.3 1650.9,-20533.14 1714.19,-20520.36"/>
<polygon fill="black" stroke="black" points="1715.13,-20523.74 1724.24,-20518.33 1713.75,-20516.88 1715.13,-20523.74"/>
</g>
<!-- moe_39_expert_6&#45;&gt;moe_39_aggregate -->
<g id="edge1369" class="edge">
<title>moe_39_expert_6&#45;&gt;moe_39_aggregate</title>
<path fill="none" stroke="black" d="M1688.08,-20562.21C1713.73,-20551.7 1744.09,-20539.25 1772.26,-20527.7"/>
<polygon fill="black" stroke="black" points="1773.79,-20530.85 1781.72,-20523.82 1771.14,-20524.38 1773.79,-20530.85"/>
</g>
<!-- moe_39_expert_7&#45;&gt;moe_39_aggregate -->
<g id="edge1370" class="edge">
<title>moe_39_expert_7&#45;&gt;moe_39_aggregate</title>
<path fill="none" stroke="black" d="M1863,-20562.09C1863,-20554.28 1863,-20545.41 1863,-20536.65"/>
<polygon fill="black" stroke="black" points="1866.5,-20536.47 1863,-20526.47 1859.5,-20536.47 1866.5,-20536.47"/>
</g>
<!-- moe_39_expert_8&#45;&gt;moe_39_aggregate -->
<g id="edge1371" class="edge">
<title>moe_39_expert_8&#45;&gt;moe_39_aggregate</title>
<path fill="none" stroke="black" d="M2037.92,-20562.21C2012.27,-20551.7 1981.91,-20539.25 1953.74,-20527.7"/>
<polygon fill="black" stroke="black" points="1954.86,-20524.38 1944.28,-20523.82 1952.21,-20530.85 1954.86,-20524.38"/>
</g>
<!-- moe_39_expert_9&#45;&gt;moe_39_aggregate -->
<g id="edge1372" class="edge">
<title>moe_39_expert_9&#45;&gt;moe_39_aggregate</title>
<path fill="none" stroke="black" d="M2225.72,-20564.07C2222.78,-20563.46 2219.87,-20562.85 2217,-20562.26 2149.68,-20548.3 2075.1,-20533.14 2011.81,-20520.36"/>
<polygon fill="black" stroke="black" points="2012.25,-20516.88 2001.76,-20518.33 2010.87,-20523.74 2012.25,-20516.88"/>
</g>
<!-- moe_39_expert_10&#45;&gt;moe_39_aggregate -->
<g id="edge1373" class="edge">
<title>moe_39_expert_10&#45;&gt;moe_39_aggregate</title>
<path fill="none" stroke="black" d="M2461.77,-20563.77C2458.82,-20563.24 2455.89,-20562.74 2453,-20562.26 2323.31,-20540.68 2176.57,-20522.8 2061.87,-20510.29"/>
<polygon fill="black" stroke="black" points="2062.25,-20506.81 2051.93,-20509.21 2061.49,-20513.77 2062.25,-20506.81"/>
</g>
<!-- moe_39_expert_11&#45;&gt;moe_39_aggregate -->
<g id="edge1374" class="edge">
<title>moe_39_expert_11&#45;&gt;moe_39_aggregate</title>
<path fill="none" stroke="black" d="M2697.79,-20563.63C2694.84,-20563.15 2691.9,-20562.69 2689,-20562.26 2485.22,-20531.94 2251.11,-20513.09 2084.28,-20502.36"/>
<polygon fill="black" stroke="black" points="2084.09,-20498.84 2073.89,-20501.69 2083.65,-20505.82 2084.09,-20498.84"/>
</g>
<!-- moe_39_expert_12&#45;&gt;moe_39_aggregate -->
<g id="edge1375" class="edge">
<title>moe_39_expert_12&#45;&gt;moe_39_aggregate</title>
<path fill="none" stroke="black" d="M2933.8,-20563.56C2930.84,-20563.1 2927.9,-20562.66 2925,-20562.26 2639.98,-20522.64 2308.77,-20504.66 2093.02,-20496.66"/>
<polygon fill="black" stroke="black" points="2092.95,-20493.16 2082.83,-20496.29 2092.7,-20500.15 2092.95,-20493.16"/>
</g>
<!-- moe_39_expert_13&#45;&gt;moe_39_aggregate -->
<g id="edge1376" class="edge">
<title>moe_39_expert_13&#45;&gt;moe_39_aggregate</title>
<path fill="none" stroke="black" d="M3169.81,-20563.51C3166.85,-20563.06 3163.91,-20562.65 3161,-20562.26 2790.78,-20513.1 2356.84,-20497.51 2096.24,-20492.63"/>
<polygon fill="black" stroke="black" points="2095.95,-20489.12 2085.89,-20492.44 2095.83,-20496.12 2095.95,-20489.12"/>
</g>
<!-- moe_39_expert_14&#45;&gt;moe_39_aggregate -->
<g id="edge1377" class="edge">
<title>moe_39_expert_14&#45;&gt;moe_39_aggregate</title>
<path fill="none" stroke="black" d="M3405.82,-20563.48C3402.85,-20563.04 3399.91,-20562.63 3397,-20562.26 3151.88,-20530.77 2457.3,-20507.25 2092.79,-20496.67"/>
<polygon fill="black" stroke="black" points="2092.73,-20493.17 2082.64,-20496.38 2092.53,-20500.17 2092.73,-20493.17"/>
</g>
<!-- moe_39_expert_15&#45;&gt;moe_39_aggregate -->
<g id="edge1378" class="edge">
<title>moe_39_expert_15&#45;&gt;moe_39_aggregate</title>
<path fill="none" stroke="black" d="M3641.82,-20563.45C3638.85,-20563.02 3635.91,-20562.62 3633,-20562.26 3342.39,-20525.85 2504.41,-20503.89 2094.44,-20495.03"/>
<polygon fill="black" stroke="black" points="2094.31,-20491.53 2084.24,-20494.81 2094.16,-20498.53 2094.31,-20491.53"/>
</g>
<!-- moe_39_ffn -->
<g id="node839" class="node">
<title>moe_39_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2021,-20416.72 1705,-20416.72 1705,-20364.72 2021,-20364.72 2021,-20416.72"/>
<text text-anchor="middle" x="1863" y="-20404.72" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1863" y="-20393.72" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-20382.72" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-20371.72" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_39_aggregate&#45;&gt;moe_39_ffn -->
<g id="edge1379" class="edge">
<title>moe_39_aggregate&#45;&gt;moe_39_ffn</title>
<path fill="none" stroke="black" d="M1863,-20452.46C1863,-20444.14 1863,-20435.31 1863,-20427.03"/>
<polygon fill="black" stroke="black" points="1866.5,-20426.92 1863,-20416.92 1859.5,-20426.92 1866.5,-20426.92"/>
</g>
<!-- moe_39_res2 -->
<g id="node841" class="node">
<title>moe_39_res2</title>
<polygon fill="lightyellow" stroke="black" points="2199.89,-20328.72 1663.97,-20328.72 1526.11,-20224.72 2062.03,-20224.72 2199.89,-20328.72"/>
<text text-anchor="middle" x="1863" y="-20290.72" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1863" y="-20279.72" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-20268.72" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1863" y="-20257.72" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_39_ffn&#45;&gt;moe_39_res2 -->
<g id="edge1380" class="edge">
<title>moe_39_ffn&#45;&gt;moe_39_res2</title>
<path fill="none" stroke="black" d="M1863,-20364.59C1863,-20356.9 1863,-20348.09 1863,-20339.09"/>
<polygon fill="black" stroke="black" points="1866.5,-20338.9 1863,-20328.9 1859.5,-20338.9 1866.5,-20338.9"/>
</g>
<!-- moe_39_res1&#45;&gt;moe_39_gate -->
<g id="edge1345" class="edge">
<title>moe_39_res1&#45;&gt;moe_39_gate</title>
<path fill="none" stroke="black" d="M1863,-20899.41C1863,-20891.24 1863,-20882.72 1863,-20874.34"/>
<polygon fill="black" stroke="black" points="1866.5,-20874.23 1863,-20864.23 1859.5,-20874.23 1866.5,-20874.23"/>
</g>
<!-- moe_40_mha -->
<g id="node842" class="node">
<title>moe_40_mha</title>
<polygon fill="lightgreen" stroke="black" points="2021,-20177.72 1705,-20177.72 1705,-20125.72 2021,-20125.72 2021,-20177.72"/>
<text text-anchor="middle" x="1863" y="-20165.72" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1863" y="-20154.72" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-20143.72" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-20132.72" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_39_res2&#45;&gt;moe_40_mha -->
<g id="edge1381" class="edge">
<title>moe_39_res2&#45;&gt;moe_40_mha</title>
<path fill="none" stroke="black" d="M1863,-20224.63C1863,-20212.3 1863,-20199.39 1863,-20187.97"/>
<polygon fill="black" stroke="black" points="1866.5,-20187.96 1863,-20177.96 1859.5,-20187.96 1866.5,-20187.96"/>
</g>
<!-- moe_40_res1 -->
<g id="node863" class="node">
<title>moe_40_res1</title>
<polygon fill="lightyellow" stroke="black" points="2199.89,-20089.72 1663.97,-20089.72 1526.11,-19985.72 2062.03,-19985.72 2199.89,-20089.72"/>
<text text-anchor="middle" x="1863" y="-20051.72" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1863" y="-20040.72" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-20029.72" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1863" y="-20018.72" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_40_mha&#45;&gt;moe_40_res1 -->
<g id="edge1382" class="edge">
<title>moe_40_mha&#45;&gt;moe_40_res1</title>
<path fill="none" stroke="black" d="M1863,-20125.59C1863,-20117.9 1863,-20109.09 1863,-20100.09"/>
<polygon fill="black" stroke="black" points="1866.5,-20099.9 1863,-20089.9 1859.5,-20099.9 1866.5,-20099.9"/>
</g>
<!-- moe_40_gate -->
<g id="node843" class="node">
<title>moe_40_gate</title>
<polygon fill="lightyellow" stroke="black" points="2191.8,-19949.72 1668.75,-19949.72 1534.2,-19845.72 2057.25,-19845.72 2191.8,-19949.72"/>
<text text-anchor="middle" x="1863" y="-19911.72" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1863" y="-19900.72" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-19889.72" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-19878.72" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_40_route -->
<g id="node844" class="node">
<title>moe_40_route</title>
<ellipse fill="lightblue" stroke="black" cx="1863" cy="-19772.95" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1863" y="-19786.95" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1863" y="-19775.95" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1863" y="-19764.95" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-19753.95" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_40_gate&#45;&gt;moe_40_route -->
<g id="edge1384" class="edge">
<title>moe_40_gate&#45;&gt;moe_40_route</title>
<path fill="none" stroke="black" d="M1863,-19845.37C1863,-19836.96 1863,-19828.29 1863,-19820.02"/>
<polygon fill="black" stroke="black" points="1866.5,-19819.81 1863,-19809.81 1859.5,-19819.81 1866.5,-19819.81"/>
</g>
<!-- moe_40_expert_0 -->
<g id="node845" class="node">
<title>moe_40_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="320,-19700.18 102,-19700.18 102,-19648.18 320,-19648.18 320,-19700.18"/>
<text text-anchor="middle" x="211" y="-19688.18" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="211" y="-19677.18" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="211" y="-19666.18" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="211" y="-19655.18" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_40_route&#45;&gt;moe_40_expert_0 -->
<g id="edge1385" class="edge">
<title>moe_40_route&#45;&gt;moe_40_expert_0</title>
<path fill="none" stroke="black" d="M1648.77,-19766.22C1293.39,-19756 595.65,-19732.73 330.21,-19700.22"/>
<polygon fill="black" stroke="black" points="330.54,-19696.74 320.18,-19698.96 329.67,-19703.68 330.54,-19696.74"/>
</g>
<!-- moe_40_expert_1 -->
<g id="node846" class="node">
<title>moe_40_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="556,-19700.18 338,-19700.18 338,-19648.18 556,-19648.18 556,-19700.18"/>
<text text-anchor="middle" x="447" y="-19688.18" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="447" y="-19677.18" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="447" y="-19666.18" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="447" y="-19655.18" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_40_route&#45;&gt;moe_40_expert_1 -->
<g id="edge1386" class="edge">
<title>moe_40_route&#45;&gt;moe_40_expert_1</title>
<path fill="none" stroke="black" d="M1645.59,-19770.1C1389.22,-19765.6 950.4,-19750.61 566.11,-19700.24"/>
<polygon fill="black" stroke="black" points="566.56,-19696.77 556.19,-19698.93 565.64,-19703.71 566.56,-19696.77"/>
</g>
<!-- moe_40_expert_2 -->
<g id="node847" class="node">
<title>moe_40_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="792,-19700.18 574,-19700.18 574,-19648.18 792,-19648.18 792,-19700.18"/>
<text text-anchor="middle" x="683" y="-19688.18" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="683" y="-19677.18" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="683" y="-19666.18" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="683" y="-19655.18" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_40_route&#45;&gt;moe_40_expert_2 -->
<g id="edge1387" class="edge">
<title>moe_40_route&#45;&gt;moe_40_expert_2</title>
<path fill="none" stroke="black" d="M1648.51,-19766.35C1435.77,-19758.72 1100.57,-19741.17 802.34,-19700.29"/>
<polygon fill="black" stroke="black" points="802.58,-19696.78 792.2,-19698.88 801.62,-19703.72 802.58,-19696.78"/>
</g>
<!-- moe_40_expert_3 -->
<g id="node848" class="node">
<title>moe_40_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1028,-19700.18 810,-19700.18 810,-19648.18 1028,-19648.18 1028,-19700.18"/>
<text text-anchor="middle" x="919" y="-19688.18" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="919" y="-19677.18" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="919" y="-19666.18" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="919" y="-19655.18" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_40_route&#45;&gt;moe_40_expert_3 -->
<g id="edge1388" class="edge">
<title>moe_40_route&#45;&gt;moe_40_expert_3</title>
<path fill="none" stroke="black" d="M1656.82,-19761.04C1491.76,-19750.66 1254.32,-19732.01 1038.16,-19700.28"/>
<polygon fill="black" stroke="black" points="1038.61,-19696.81 1028.21,-19698.81 1037.59,-19703.73 1038.61,-19696.81"/>
</g>
<!-- moe_40_expert_4 -->
<g id="node849" class="node">
<title>moe_40_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1264,-19700.18 1046,-19700.18 1046,-19648.18 1264,-19648.18 1264,-19700.18"/>
<text text-anchor="middle" x="1155" y="-19688.18" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1155" y="-19677.18" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1155" y="-19666.18" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1155" y="-19655.18" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_40_route&#45;&gt;moe_40_expert_4 -->
<g id="edge1389" class="edge">
<title>moe_40_route&#45;&gt;moe_40_expert_4</title>
<path fill="none" stroke="black" d="M1677.38,-19753.59C1563.62,-19741.32 1414.9,-19723.47 1274.33,-19700.35"/>
<polygon fill="black" stroke="black" points="1274.66,-19696.86 1264.23,-19698.68 1273.52,-19703.76 1274.66,-19696.86"/>
</g>
<!-- moe_40_expert_5 -->
<g id="node850" class="node">
<title>moe_40_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1500,-19700.18 1282,-19700.18 1282,-19648.18 1500,-19648.18 1500,-19700.18"/>
<text text-anchor="middle" x="1391" y="-19688.18" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1391" y="-19677.18" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1391" y="-19666.18" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1391" y="-19655.18" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_40_route&#45;&gt;moe_40_expert_5 -->
<g id="edge1390" class="edge">
<title>moe_40_route&#45;&gt;moe_40_expert_5</title>
<path fill="none" stroke="black" d="M1725.51,-19744.37C1662.62,-19731.68 1586.88,-19716.3 1510.14,-19700.41"/>
<polygon fill="black" stroke="black" points="1510.79,-19696.97 1500.28,-19698.37 1509.37,-19703.83 1510.79,-19696.97"/>
</g>
<!-- moe_40_expert_6 -->
<g id="node851" class="node">
<title>moe_40_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1736,-19700.18 1518,-19700.18 1518,-19648.18 1736,-19648.18 1736,-19700.18"/>
<text text-anchor="middle" x="1627" y="-19688.18" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1627" y="-19677.18" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1627" y="-19666.18" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1627" y="-19655.18" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_40_route&#45;&gt;moe_40_expert_6 -->
<g id="edge1391" class="edge">
<title>moe_40_route&#45;&gt;moe_40_expert_6</title>
<path fill="none" stroke="black" d="M1782.11,-19738.78C1754.54,-19727.48 1723.96,-19714.94 1697.29,-19704"/>
<polygon fill="black" stroke="black" points="1698.61,-19700.76 1688.03,-19700.21 1695.95,-19707.24 1698.61,-19700.76"/>
</g>
<!-- moe_40_expert_7 -->
<g id="node852" class="node">
<title>moe_40_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1972,-19700.18 1754,-19700.18 1754,-19648.18 1972,-19648.18 1972,-19700.18"/>
<text text-anchor="middle" x="1863" y="-19688.18" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1863" y="-19677.18" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1863" y="-19666.18" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-19655.18" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_40_route&#45;&gt;moe_40_expert_7 -->
<g id="edge1392" class="edge">
<title>moe_40_route&#45;&gt;moe_40_expert_7</title>
<path fill="none" stroke="black" d="M1863,-19735.92C1863,-19727.61 1863,-19718.77 1863,-19710.49"/>
<polygon fill="black" stroke="black" points="1866.5,-19710.38 1863,-19700.38 1859.5,-19710.38 1866.5,-19710.38"/>
</g>
<!-- moe_40_expert_8 -->
<g id="node853" class="node">
<title>moe_40_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2208,-19700.18 1990,-19700.18 1990,-19648.18 2208,-19648.18 2208,-19700.18"/>
<text text-anchor="middle" x="2099" y="-19688.18" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2099" y="-19677.18" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2099" y="-19666.18" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2099" y="-19655.18" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_40_route&#45;&gt;moe_40_expert_8 -->
<g id="edge1393" class="edge">
<title>moe_40_route&#45;&gt;moe_40_expert_8</title>
<path fill="none" stroke="black" d="M1943.89,-19738.78C1971.46,-19727.48 2002.04,-19714.94 2028.71,-19704"/>
<polygon fill="black" stroke="black" points="2030.05,-19707.24 2037.97,-19700.21 2027.39,-19700.76 2030.05,-19707.24"/>
</g>
<!-- moe_40_expert_9 -->
<g id="node854" class="node">
<title>moe_40_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2444,-19700.18 2226,-19700.18 2226,-19648.18 2444,-19648.18 2444,-19700.18"/>
<text text-anchor="middle" x="2335" y="-19688.18" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2335" y="-19677.18" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2335" y="-19666.18" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2335" y="-19655.18" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_40_route&#45;&gt;moe_40_expert_9 -->
<g id="edge1394" class="edge">
<title>moe_40_route&#45;&gt;moe_40_expert_9</title>
<path fill="none" stroke="black" d="M2000.49,-19744.37C2063.38,-19731.68 2139.12,-19716.3 2215.86,-19700.41"/>
<polygon fill="black" stroke="black" points="2216.63,-19703.83 2225.72,-19698.37 2215.21,-19696.97 2216.63,-19703.83"/>
</g>
<!-- moe_40_expert_10 -->
<g id="node855" class="node">
<title>moe_40_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2680,-19700.18 2462,-19700.18 2462,-19648.18 2680,-19648.18 2680,-19700.18"/>
<text text-anchor="middle" x="2571" y="-19688.18" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2571" y="-19677.18" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2571" y="-19666.18" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2571" y="-19655.18" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_40_route&#45;&gt;moe_40_expert_10 -->
<g id="edge1395" class="edge">
<title>moe_40_route&#45;&gt;moe_40_expert_10</title>
<path fill="none" stroke="black" d="M2048.62,-19753.59C2162.38,-19741.32 2311.1,-19723.47 2451.67,-19700.35"/>
<polygon fill="black" stroke="black" points="2452.48,-19703.76 2461.77,-19698.68 2451.34,-19696.86 2452.48,-19703.76"/>
</g>
<!-- moe_40_expert_11 -->
<g id="node856" class="node">
<title>moe_40_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2916,-19700.18 2698,-19700.18 2698,-19648.18 2916,-19648.18 2916,-19700.18"/>
<text text-anchor="middle" x="2807" y="-19688.18" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2807" y="-19677.18" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2807" y="-19666.18" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2807" y="-19655.18" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_40_route&#45;&gt;moe_40_expert_11 -->
<g id="edge1396" class="edge">
<title>moe_40_route&#45;&gt;moe_40_expert_11</title>
<path fill="none" stroke="black" d="M2069.18,-19761.04C2234.24,-19750.66 2471.68,-19732.01 2687.84,-19700.28"/>
<polygon fill="black" stroke="black" points="2688.41,-19703.73 2697.79,-19698.81 2687.39,-19696.81 2688.41,-19703.73"/>
</g>
<!-- moe_40_expert_12 -->
<g id="node857" class="node">
<title>moe_40_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3152,-19700.18 2934,-19700.18 2934,-19648.18 3152,-19648.18 3152,-19700.18"/>
<text text-anchor="middle" x="3043" y="-19688.18" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3043" y="-19677.18" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3043" y="-19666.18" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3043" y="-19655.18" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_40_route&#45;&gt;moe_40_expert_12 -->
<g id="edge1397" class="edge">
<title>moe_40_route&#45;&gt;moe_40_expert_12</title>
<path fill="none" stroke="black" d="M2077.49,-19766.35C2290.23,-19758.72 2625.43,-19741.17 2923.66,-19700.29"/>
<polygon fill="black" stroke="black" points="2924.38,-19703.72 2933.8,-19698.88 2923.42,-19696.78 2924.38,-19703.72"/>
</g>
<!-- moe_40_expert_13 -->
<g id="node858" class="node">
<title>moe_40_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3388,-19700.18 3170,-19700.18 3170,-19648.18 3388,-19648.18 3388,-19700.18"/>
<text text-anchor="middle" x="3279" y="-19688.18" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3279" y="-19677.18" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3279" y="-19666.18" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3279" y="-19655.18" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_40_route&#45;&gt;moe_40_expert_13 -->
<g id="edge1398" class="edge">
<title>moe_40_route&#45;&gt;moe_40_expert_13</title>
<path fill="none" stroke="black" d="M2080.41,-19770.1C2336.78,-19765.6 2775.6,-19750.61 3159.89,-19700.24"/>
<polygon fill="black" stroke="black" points="3160.36,-19703.71 3169.81,-19698.93 3159.44,-19696.77 3160.36,-19703.71"/>
</g>
<!-- moe_40_expert_14 -->
<g id="node859" class="node">
<title>moe_40_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3624,-19700.18 3406,-19700.18 3406,-19648.18 3624,-19648.18 3624,-19700.18"/>
<text text-anchor="middle" x="3515" y="-19688.18" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3515" y="-19677.18" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3515" y="-19666.18" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3515" y="-19655.18" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_40_route&#45;&gt;moe_40_expert_14 -->
<g id="edge1399" class="edge">
<title>moe_40_route&#45;&gt;moe_40_expert_14</title>
<path fill="none" stroke="black" d="M2077.23,-19766.22C2432.61,-19756 3130.35,-19732.73 3395.79,-19700.22"/>
<polygon fill="black" stroke="black" points="3396.33,-19703.68 3405.82,-19698.96 3395.46,-19696.74 3396.33,-19703.68"/>
</g>
<!-- moe_40_expert_15 -->
<g id="node860" class="node">
<title>moe_40_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3860,-19700.18 3642,-19700.18 3642,-19648.18 3860,-19648.18 3860,-19700.18"/>
<text text-anchor="middle" x="3751" y="-19688.18" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3751" y="-19677.18" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3751" y="-19666.18" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3751" y="-19655.18" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_40_route&#45;&gt;moe_40_expert_15 -->
<g id="edge1400" class="edge">
<title>moe_40_route&#45;&gt;moe_40_expert_15</title>
<path fill="none" stroke="black" d="M2078.71,-19767.75C2478.25,-19759.21 3320.28,-19737.54 3631.86,-19700.21"/>
<polygon fill="black" stroke="black" points="3632.32,-19703.68 3641.82,-19698.99 3631.47,-19696.73 3632.32,-19703.68"/>
</g>
<!-- moe_40_aggregate -->
<g id="node861" class="node">
<title>moe_40_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1863" cy="-19575.41" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1863" y="-19589.41" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1863" y="-19578.41" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1863" y="-19567.41" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1863" y="-19556.41" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_40_expert_0&#45;&gt;moe_40_aggregate -->
<g id="edge1401" class="edge">
<title>moe_40_expert_0&#45;&gt;moe_40_aggregate</title>
<path fill="none" stroke="black" d="M320.18,-19649.4C323.15,-19648.96 326.09,-19648.56 329,-19648.18 574.12,-19616.69 1268.7,-19593.17 1633.21,-19582.59"/>
<polygon fill="black" stroke="black" points="1633.47,-19586.09 1643.36,-19582.3 1633.27,-19579.09 1633.47,-19586.09"/>
</g>
<!-- moe_40_expert_1&#45;&gt;moe_40_aggregate -->
<g id="edge1402" class="edge">
<title>moe_40_expert_1&#45;&gt;moe_40_aggregate</title>
<path fill="none" stroke="black" d="M556.19,-19649.43C559.15,-19648.99 562.09,-19648.57 565,-19648.18 935.22,-19599.02 1369.16,-19583.43 1629.76,-19578.55"/>
<polygon fill="black" stroke="black" points="1630.17,-19582.04 1640.11,-19578.36 1630.05,-19575.04 1630.17,-19582.04"/>
</g>
<!-- moe_40_expert_2&#45;&gt;moe_40_aggregate -->
<g id="edge1403" class="edge">
<title>moe_40_expert_2&#45;&gt;moe_40_aggregate</title>
<path fill="none" stroke="black" d="M792.2,-19649.48C795.16,-19649.02 798.1,-19648.59 801,-19648.18 1086.02,-19608.56 1417.23,-19590.59 1632.98,-19582.58"/>
<polygon fill="black" stroke="black" points="1633.3,-19586.07 1643.17,-19582.21 1633.05,-19579.08 1633.3,-19586.07"/>
</g>
<!-- moe_40_expert_3&#45;&gt;moe_40_aggregate -->
<g id="edge1404" class="edge">
<title>moe_40_expert_3&#45;&gt;moe_40_aggregate</title>
<path fill="none" stroke="black" d="M1028.21,-19649.55C1031.16,-19649.07 1034.1,-19648.61 1037,-19648.18 1240.78,-19617.86 1474.89,-19599.01 1641.72,-19588.28"/>
<polygon fill="black" stroke="black" points="1642.35,-19591.75 1652.11,-19587.62 1641.91,-19584.76 1642.35,-19591.75"/>
</g>
<!-- moe_40_expert_4&#45;&gt;moe_40_aggregate -->
<g id="edge1405" class="edge">
<title>moe_40_expert_4&#45;&gt;moe_40_aggregate</title>
<path fill="none" stroke="black" d="M1264.23,-19649.69C1267.18,-19649.17 1270.11,-19648.66 1273,-19648.18 1402.69,-19626.6 1549.43,-19608.72 1664.13,-19596.21"/>
<polygon fill="black" stroke="black" points="1664.51,-19599.69 1674.07,-19595.13 1663.75,-19592.73 1664.51,-19599.69"/>
</g>
<!-- moe_40_expert_5&#45;&gt;moe_40_aggregate -->
<g id="edge1406" class="edge">
<title>moe_40_expert_5&#45;&gt;moe_40_aggregate</title>
<path fill="none" stroke="black" d="M1500.28,-19649.99C1503.22,-19649.38 1506.13,-19648.78 1509,-19648.18 1576.32,-19634.23 1650.9,-19619.06 1714.19,-19606.28"/>
<polygon fill="black" stroke="black" points="1715.13,-19609.66 1724.24,-19604.25 1713.75,-19602.8 1715.13,-19609.66"/>
</g>
<!-- moe_40_expert_6&#45;&gt;moe_40_aggregate -->
<g id="edge1407" class="edge">
<title>moe_40_expert_6&#45;&gt;moe_40_aggregate</title>
<path fill="none" stroke="black" d="M1688.08,-19648.14C1713.73,-19637.62 1744.09,-19625.17 1772.26,-19613.62"/>
<polygon fill="black" stroke="black" points="1773.79,-19616.77 1781.72,-19609.74 1771.14,-19610.3 1773.79,-19616.77"/>
</g>
<!-- moe_40_expert_7&#45;&gt;moe_40_aggregate -->
<g id="edge1408" class="edge">
<title>moe_40_expert_7&#45;&gt;moe_40_aggregate</title>
<path fill="none" stroke="black" d="M1863,-19648.01C1863,-19640.2 1863,-19631.33 1863,-19622.57"/>
<polygon fill="black" stroke="black" points="1866.5,-19622.39 1863,-19612.39 1859.5,-19622.39 1866.5,-19622.39"/>
</g>
<!-- moe_40_expert_8&#45;&gt;moe_40_aggregate -->
<g id="edge1409" class="edge">
<title>moe_40_expert_8&#45;&gt;moe_40_aggregate</title>
<path fill="none" stroke="black" d="M2037.92,-19648.14C2012.27,-19637.62 1981.91,-19625.17 1953.74,-19613.62"/>
<polygon fill="black" stroke="black" points="1954.86,-19610.3 1944.28,-19609.74 1952.21,-19616.77 1954.86,-19610.3"/>
</g>
<!-- moe_40_expert_9&#45;&gt;moe_40_aggregate -->
<g id="edge1410" class="edge">
<title>moe_40_expert_9&#45;&gt;moe_40_aggregate</title>
<path fill="none" stroke="black" d="M2225.72,-19649.99C2222.78,-19649.38 2219.87,-19648.78 2217,-19648.18 2149.68,-19634.23 2075.1,-19619.06 2011.81,-19606.28"/>
<polygon fill="black" stroke="black" points="2012.25,-19602.8 2001.76,-19604.25 2010.87,-19609.66 2012.25,-19602.8"/>
</g>
<!-- moe_40_expert_10&#45;&gt;moe_40_aggregate -->
<g id="edge1411" class="edge">
<title>moe_40_expert_10&#45;&gt;moe_40_aggregate</title>
<path fill="none" stroke="black" d="M2461.77,-19649.69C2458.82,-19649.17 2455.89,-19648.66 2453,-19648.18 2323.31,-19626.6 2176.57,-19608.72 2061.87,-19596.21"/>
<polygon fill="black" stroke="black" points="2062.25,-19592.73 2051.93,-19595.13 2061.49,-19599.69 2062.25,-19592.73"/>
</g>
<!-- moe_40_expert_11&#45;&gt;moe_40_aggregate -->
<g id="edge1412" class="edge">
<title>moe_40_expert_11&#45;&gt;moe_40_aggregate</title>
<path fill="none" stroke="black" d="M2697.79,-19649.55C2694.84,-19649.07 2691.9,-19648.61 2689,-19648.18 2485.22,-19617.86 2251.11,-19599.01 2084.28,-19588.28"/>
<polygon fill="black" stroke="black" points="2084.09,-19584.76 2073.89,-19587.62 2083.65,-19591.75 2084.09,-19584.76"/>
</g>
<!-- moe_40_expert_12&#45;&gt;moe_40_aggregate -->
<g id="edge1413" class="edge">
<title>moe_40_expert_12&#45;&gt;moe_40_aggregate</title>
<path fill="none" stroke="black" d="M2933.8,-19649.48C2930.84,-19649.02 2927.9,-19648.59 2925,-19648.18 2639.98,-19608.56 2308.77,-19590.59 2093.02,-19582.58"/>
<polygon fill="black" stroke="black" points="2092.95,-19579.08 2082.83,-19582.21 2092.7,-19586.07 2092.95,-19579.08"/>
</g>
<!-- moe_40_expert_13&#45;&gt;moe_40_aggregate -->
<g id="edge1414" class="edge">
<title>moe_40_expert_13&#45;&gt;moe_40_aggregate</title>
<path fill="none" stroke="black" d="M3169.81,-19649.43C3166.85,-19648.99 3163.91,-19648.57 3161,-19648.18 2790.78,-19599.02 2356.84,-19583.43 2096.24,-19578.55"/>
<polygon fill="black" stroke="black" points="2095.95,-19575.04 2085.89,-19578.36 2095.83,-19582.04 2095.95,-19575.04"/>
</g>
<!-- moe_40_expert_14&#45;&gt;moe_40_aggregate -->
<g id="edge1415" class="edge">
<title>moe_40_expert_14&#45;&gt;moe_40_aggregate</title>
<path fill="none" stroke="black" d="M3405.82,-19649.4C3402.85,-19648.96 3399.91,-19648.56 3397,-19648.18 3151.88,-19616.69 2457.3,-19593.17 2092.79,-19582.59"/>
<polygon fill="black" stroke="black" points="2092.73,-19579.09 2082.64,-19582.3 2092.53,-19586.09 2092.73,-19579.09"/>
</g>
<!-- moe_40_expert_15&#45;&gt;moe_40_aggregate -->
<g id="edge1416" class="edge">
<title>moe_40_expert_15&#45;&gt;moe_40_aggregate</title>
<path fill="none" stroke="black" d="M3641.82,-19649.37C3638.85,-19648.95 3635.91,-19648.55 3633,-19648.18 3342.39,-19611.77 2504.41,-19589.81 2094.44,-19580.95"/>
<polygon fill="black" stroke="black" points="2094.31,-19577.45 2084.24,-19580.73 2094.16,-19584.45 2094.31,-19577.45"/>
</g>
<!-- moe_40_ffn -->
<g id="node862" class="node">
<title>moe_40_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2021,-19502.64 1705,-19502.64 1705,-19450.64 2021,-19450.64 2021,-19502.64"/>
<text text-anchor="middle" x="1863" y="-19490.64" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1863" y="-19479.64" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-19468.64" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-19457.64" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_40_aggregate&#45;&gt;moe_40_ffn -->
<g id="edge1417" class="edge">
<title>moe_40_aggregate&#45;&gt;moe_40_ffn</title>
<path fill="none" stroke="black" d="M1863,-19538.38C1863,-19530.07 1863,-19521.23 1863,-19512.95"/>
<polygon fill="black" stroke="black" points="1866.5,-19512.84 1863,-19502.84 1859.5,-19512.84 1866.5,-19512.84"/>
</g>
<!-- moe_40_res2 -->
<g id="node864" class="node">
<title>moe_40_res2</title>
<polygon fill="lightyellow" stroke="black" points="2199.89,-19414.64 1663.97,-19414.64 1526.11,-19310.64 2062.03,-19310.64 2199.89,-19414.64"/>
<text text-anchor="middle" x="1863" y="-19376.64" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1863" y="-19365.64" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-19354.64" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1863" y="-19343.64" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_40_ffn&#45;&gt;moe_40_res2 -->
<g id="edge1418" class="edge">
<title>moe_40_ffn&#45;&gt;moe_40_res2</title>
<path fill="none" stroke="black" d="M1863,-19450.51C1863,-19442.82 1863,-19434.01 1863,-19425.01"/>
<polygon fill="black" stroke="black" points="1866.5,-19424.82 1863,-19414.82 1859.5,-19424.82 1866.5,-19424.82"/>
</g>
<!-- moe_40_res1&#45;&gt;moe_40_gate -->
<g id="edge1383" class="edge">
<title>moe_40_res1&#45;&gt;moe_40_gate</title>
<path fill="none" stroke="black" d="M1863,-19985.33C1863,-19977.16 1863,-19968.64 1863,-19960.26"/>
<polygon fill="black" stroke="black" points="1866.5,-19960.15 1863,-19950.15 1859.5,-19960.15 1866.5,-19960.15"/>
</g>
<!-- moe_41_mha -->
<g id="node865" class="node">
<title>moe_41_mha</title>
<polygon fill="lightgreen" stroke="black" points="2021,-19263.64 1705,-19263.64 1705,-19211.64 2021,-19211.64 2021,-19263.64"/>
<text text-anchor="middle" x="1863" y="-19251.64" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1863" y="-19240.64" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-19229.64" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-19218.64" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_40_res2&#45;&gt;moe_41_mha -->
<g id="edge1419" class="edge">
<title>moe_40_res2&#45;&gt;moe_41_mha</title>
<path fill="none" stroke="black" d="M1863,-19310.55C1863,-19298.22 1863,-19285.31 1863,-19273.89"/>
<polygon fill="black" stroke="black" points="1866.5,-19273.88 1863,-19263.88 1859.5,-19273.88 1866.5,-19273.88"/>
</g>
<!-- moe_41_res1 -->
<g id="node886" class="node">
<title>moe_41_res1</title>
<polygon fill="lightyellow" stroke="black" points="2199.89,-19175.64 1663.97,-19175.64 1526.11,-19071.64 2062.03,-19071.64 2199.89,-19175.64"/>
<text text-anchor="middle" x="1863" y="-19137.64" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1863" y="-19126.64" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-19115.64" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1863" y="-19104.64" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_41_mha&#45;&gt;moe_41_res1 -->
<g id="edge1420" class="edge">
<title>moe_41_mha&#45;&gt;moe_41_res1</title>
<path fill="none" stroke="black" d="M1863,-19211.51C1863,-19203.82 1863,-19195.01 1863,-19186.01"/>
<polygon fill="black" stroke="black" points="1866.5,-19185.82 1863,-19175.82 1859.5,-19185.82 1866.5,-19185.82"/>
</g>
<!-- moe_41_gate -->
<g id="node866" class="node">
<title>moe_41_gate</title>
<polygon fill="lightyellow" stroke="black" points="2191.8,-19035.64 1668.75,-19035.64 1534.2,-18931.64 2057.25,-18931.64 2191.8,-19035.64"/>
<text text-anchor="middle" x="1863" y="-18997.64" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1863" y="-18986.64" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-18975.64" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-18964.64" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_41_route -->
<g id="node867" class="node">
<title>moe_41_route</title>
<ellipse fill="lightblue" stroke="black" cx="1863" cy="-18858.87" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1863" y="-18872.87" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1863" y="-18861.87" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1863" y="-18850.87" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-18839.87" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_41_gate&#45;&gt;moe_41_route -->
<g id="edge1422" class="edge">
<title>moe_41_gate&#45;&gt;moe_41_route</title>
<path fill="none" stroke="black" d="M1863,-18931.29C1863,-18922.88 1863,-18914.21 1863,-18905.94"/>
<polygon fill="black" stroke="black" points="1866.5,-18905.73 1863,-18895.73 1859.5,-18905.73 1866.5,-18905.73"/>
</g>
<!-- moe_41_expert_0 -->
<g id="node868" class="node">
<title>moe_41_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="320,-18786.1 102,-18786.1 102,-18734.1 320,-18734.1 320,-18786.1"/>
<text text-anchor="middle" x="211" y="-18774.1" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="211" y="-18763.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="211" y="-18752.1" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="211" y="-18741.1" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_41_route&#45;&gt;moe_41_expert_0 -->
<g id="edge1423" class="edge">
<title>moe_41_route&#45;&gt;moe_41_expert_0</title>
<path fill="none" stroke="black" d="M1648.77,-18852.14C1293.39,-18841.92 595.65,-18818.65 330.21,-18786.14"/>
<polygon fill="black" stroke="black" points="330.54,-18782.66 320.18,-18784.89 329.67,-18789.6 330.54,-18782.66"/>
</g>
<!-- moe_41_expert_1 -->
<g id="node869" class="node">
<title>moe_41_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="556,-18786.1 338,-18786.1 338,-18734.1 556,-18734.1 556,-18786.1"/>
<text text-anchor="middle" x="447" y="-18774.1" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="447" y="-18763.1" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="447" y="-18752.1" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="447" y="-18741.1" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_41_route&#45;&gt;moe_41_expert_1 -->
<g id="edge1424" class="edge">
<title>moe_41_route&#45;&gt;moe_41_expert_1</title>
<path fill="none" stroke="black" d="M1645.59,-18856.02C1389.22,-18851.52 950.4,-18836.53 566.11,-18786.16"/>
<polygon fill="black" stroke="black" points="566.56,-18782.69 556.19,-18784.85 565.64,-18789.63 566.56,-18782.69"/>
</g>
<!-- moe_41_expert_2 -->
<g id="node870" class="node">
<title>moe_41_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="792,-18786.1 574,-18786.1 574,-18734.1 792,-18734.1 792,-18786.1"/>
<text text-anchor="middle" x="683" y="-18774.1" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="683" y="-18763.1" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="683" y="-18752.1" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="683" y="-18741.1" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_41_route&#45;&gt;moe_41_expert_2 -->
<g id="edge1425" class="edge">
<title>moe_41_route&#45;&gt;moe_41_expert_2</title>
<path fill="none" stroke="black" d="M1648.51,-18852.27C1435.77,-18844.65 1100.57,-18827.09 802.34,-18786.21"/>
<polygon fill="black" stroke="black" points="802.58,-18782.71 792.2,-18784.81 801.62,-18789.64 802.58,-18782.71"/>
</g>
<!-- moe_41_expert_3 -->
<g id="node871" class="node">
<title>moe_41_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1028,-18786.1 810,-18786.1 810,-18734.1 1028,-18734.1 1028,-18786.1"/>
<text text-anchor="middle" x="919" y="-18774.1" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="919" y="-18763.1" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="919" y="-18752.1" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="919" y="-18741.1" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_41_route&#45;&gt;moe_41_expert_3 -->
<g id="edge1426" class="edge">
<title>moe_41_route&#45;&gt;moe_41_expert_3</title>
<path fill="none" stroke="black" d="M1656.82,-18846.97C1491.76,-18836.58 1254.32,-18817.93 1038.16,-18786.2"/>
<polygon fill="black" stroke="black" points="1038.61,-18782.73 1028.21,-18784.73 1037.59,-18789.66 1038.61,-18782.73"/>
</g>
<!-- moe_41_expert_4 -->
<g id="node872" class="node">
<title>moe_41_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1264,-18786.1 1046,-18786.1 1046,-18734.1 1264,-18734.1 1264,-18786.1"/>
<text text-anchor="middle" x="1155" y="-18774.1" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1155" y="-18763.1" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1155" y="-18752.1" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1155" y="-18741.1" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_41_route&#45;&gt;moe_41_expert_4 -->
<g id="edge1427" class="edge">
<title>moe_41_route&#45;&gt;moe_41_expert_4</title>
<path fill="none" stroke="black" d="M1677.38,-18839.52C1563.62,-18827.25 1414.9,-18809.39 1274.33,-18786.27"/>
<polygon fill="black" stroke="black" points="1274.66,-18782.78 1264.23,-18784.6 1273.52,-18789.68 1274.66,-18782.78"/>
</g>
<!-- moe_41_expert_5 -->
<g id="node873" class="node">
<title>moe_41_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1500,-18786.1 1282,-18786.1 1282,-18734.1 1500,-18734.1 1500,-18786.1"/>
<text text-anchor="middle" x="1391" y="-18774.1" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1391" y="-18763.1" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1391" y="-18752.1" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1391" y="-18741.1" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_41_route&#45;&gt;moe_41_expert_5 -->
<g id="edge1428" class="edge">
<title>moe_41_route&#45;&gt;moe_41_expert_5</title>
<path fill="none" stroke="black" d="M1725.51,-18830.29C1662.62,-18817.6 1586.88,-18802.22 1510.14,-18786.33"/>
<polygon fill="black" stroke="black" points="1510.79,-18782.89 1500.28,-18784.29 1509.37,-18789.75 1510.79,-18782.89"/>
</g>
<!-- moe_41_expert_6 -->
<g id="node874" class="node">
<title>moe_41_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1736,-18786.1 1518,-18786.1 1518,-18734.1 1736,-18734.1 1736,-18786.1"/>
<text text-anchor="middle" x="1627" y="-18774.1" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1627" y="-18763.1" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1627" y="-18752.1" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1627" y="-18741.1" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_41_route&#45;&gt;moe_41_expert_6 -->
<g id="edge1429" class="edge">
<title>moe_41_route&#45;&gt;moe_41_expert_6</title>
<path fill="none" stroke="black" d="M1782.11,-18824.71C1754.54,-18813.4 1723.96,-18800.86 1697.29,-18789.92"/>
<polygon fill="black" stroke="black" points="1698.61,-18786.68 1688.03,-18786.13 1695.95,-18793.16 1698.61,-18786.68"/>
</g>
<!-- moe_41_expert_7 -->
<g id="node875" class="node">
<title>moe_41_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1972,-18786.1 1754,-18786.1 1754,-18734.1 1972,-18734.1 1972,-18786.1"/>
<text text-anchor="middle" x="1863" y="-18774.1" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1863" y="-18763.1" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1863" y="-18752.1" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-18741.1" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_41_route&#45;&gt;moe_41_expert_7 -->
<g id="edge1430" class="edge">
<title>moe_41_route&#45;&gt;moe_41_expert_7</title>
<path fill="none" stroke="black" d="M1863,-18821.84C1863,-18813.53 1863,-18804.69 1863,-18796.41"/>
<polygon fill="black" stroke="black" points="1866.5,-18796.3 1863,-18786.3 1859.5,-18796.3 1866.5,-18796.3"/>
</g>
<!-- moe_41_expert_8 -->
<g id="node876" class="node">
<title>moe_41_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2208,-18786.1 1990,-18786.1 1990,-18734.1 2208,-18734.1 2208,-18786.1"/>
<text text-anchor="middle" x="2099" y="-18774.1" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2099" y="-18763.1" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2099" y="-18752.1" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2099" y="-18741.1" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_41_route&#45;&gt;moe_41_expert_8 -->
<g id="edge1431" class="edge">
<title>moe_41_route&#45;&gt;moe_41_expert_8</title>
<path fill="none" stroke="black" d="M1943.89,-18824.71C1971.46,-18813.4 2002.04,-18800.86 2028.71,-18789.92"/>
<polygon fill="black" stroke="black" points="2030.05,-18793.16 2037.97,-18786.13 2027.39,-18786.68 2030.05,-18793.16"/>
</g>
<!-- moe_41_expert_9 -->
<g id="node877" class="node">
<title>moe_41_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2444,-18786.1 2226,-18786.1 2226,-18734.1 2444,-18734.1 2444,-18786.1"/>
<text text-anchor="middle" x="2335" y="-18774.1" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2335" y="-18763.1" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2335" y="-18752.1" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2335" y="-18741.1" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_41_route&#45;&gt;moe_41_expert_9 -->
<g id="edge1432" class="edge">
<title>moe_41_route&#45;&gt;moe_41_expert_9</title>
<path fill="none" stroke="black" d="M2000.49,-18830.29C2063.38,-18817.6 2139.12,-18802.22 2215.86,-18786.33"/>
<polygon fill="black" stroke="black" points="2216.63,-18789.75 2225.72,-18784.29 2215.21,-18782.89 2216.63,-18789.75"/>
</g>
<!-- moe_41_expert_10 -->
<g id="node878" class="node">
<title>moe_41_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2680,-18786.1 2462,-18786.1 2462,-18734.1 2680,-18734.1 2680,-18786.1"/>
<text text-anchor="middle" x="2571" y="-18774.1" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2571" y="-18763.1" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2571" y="-18752.1" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2571" y="-18741.1" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_41_route&#45;&gt;moe_41_expert_10 -->
<g id="edge1433" class="edge">
<title>moe_41_route&#45;&gt;moe_41_expert_10</title>
<path fill="none" stroke="black" d="M2048.62,-18839.52C2162.38,-18827.25 2311.1,-18809.39 2451.67,-18786.27"/>
<polygon fill="black" stroke="black" points="2452.48,-18789.68 2461.77,-18784.6 2451.34,-18782.78 2452.48,-18789.68"/>
</g>
<!-- moe_41_expert_11 -->
<g id="node879" class="node">
<title>moe_41_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2916,-18786.1 2698,-18786.1 2698,-18734.1 2916,-18734.1 2916,-18786.1"/>
<text text-anchor="middle" x="2807" y="-18774.1" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2807" y="-18763.1" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2807" y="-18752.1" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2807" y="-18741.1" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_41_route&#45;&gt;moe_41_expert_11 -->
<g id="edge1434" class="edge">
<title>moe_41_route&#45;&gt;moe_41_expert_11</title>
<path fill="none" stroke="black" d="M2069.18,-18846.97C2234.24,-18836.58 2471.68,-18817.93 2687.84,-18786.2"/>
<polygon fill="black" stroke="black" points="2688.41,-18789.66 2697.79,-18784.73 2687.39,-18782.73 2688.41,-18789.66"/>
</g>
<!-- moe_41_expert_12 -->
<g id="node880" class="node">
<title>moe_41_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3152,-18786.1 2934,-18786.1 2934,-18734.1 3152,-18734.1 3152,-18786.1"/>
<text text-anchor="middle" x="3043" y="-18774.1" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3043" y="-18763.1" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3043" y="-18752.1" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3043" y="-18741.1" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_41_route&#45;&gt;moe_41_expert_12 -->
<g id="edge1435" class="edge">
<title>moe_41_route&#45;&gt;moe_41_expert_12</title>
<path fill="none" stroke="black" d="M2077.49,-18852.27C2290.23,-18844.65 2625.43,-18827.09 2923.66,-18786.21"/>
<polygon fill="black" stroke="black" points="2924.38,-18789.64 2933.8,-18784.81 2923.42,-18782.71 2924.38,-18789.64"/>
</g>
<!-- moe_41_expert_13 -->
<g id="node881" class="node">
<title>moe_41_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3388,-18786.1 3170,-18786.1 3170,-18734.1 3388,-18734.1 3388,-18786.1"/>
<text text-anchor="middle" x="3279" y="-18774.1" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3279" y="-18763.1" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3279" y="-18752.1" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3279" y="-18741.1" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_41_route&#45;&gt;moe_41_expert_13 -->
<g id="edge1436" class="edge">
<title>moe_41_route&#45;&gt;moe_41_expert_13</title>
<path fill="none" stroke="black" d="M2080.41,-18856.02C2336.78,-18851.52 2775.6,-18836.53 3159.89,-18786.16"/>
<polygon fill="black" stroke="black" points="3160.36,-18789.63 3169.81,-18784.85 3159.44,-18782.69 3160.36,-18789.63"/>
</g>
<!-- moe_41_expert_14 -->
<g id="node882" class="node">
<title>moe_41_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3624,-18786.1 3406,-18786.1 3406,-18734.1 3624,-18734.1 3624,-18786.1"/>
<text text-anchor="middle" x="3515" y="-18774.1" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3515" y="-18763.1" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3515" y="-18752.1" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3515" y="-18741.1" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_41_route&#45;&gt;moe_41_expert_14 -->
<g id="edge1437" class="edge">
<title>moe_41_route&#45;&gt;moe_41_expert_14</title>
<path fill="none" stroke="black" d="M2077.23,-18852.14C2432.61,-18841.92 3130.35,-18818.65 3395.79,-18786.14"/>
<polygon fill="black" stroke="black" points="3396.33,-18789.6 3405.82,-18784.89 3395.46,-18782.66 3396.33,-18789.6"/>
</g>
<!-- moe_41_expert_15 -->
<g id="node883" class="node">
<title>moe_41_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3860,-18786.1 3642,-18786.1 3642,-18734.1 3860,-18734.1 3860,-18786.1"/>
<text text-anchor="middle" x="3751" y="-18774.1" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3751" y="-18763.1" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3751" y="-18752.1" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3751" y="-18741.1" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_41_route&#45;&gt;moe_41_expert_15 -->
<g id="edge1438" class="edge">
<title>moe_41_route&#45;&gt;moe_41_expert_15</title>
<path fill="none" stroke="black" d="M2078.71,-18853.67C2478.25,-18845.13 3320.28,-18823.46 3631.86,-18786.13"/>
<polygon fill="black" stroke="black" points="3632.32,-18789.6 3641.82,-18784.91 3631.47,-18782.65 3632.32,-18789.6"/>
</g>
<!-- moe_41_aggregate -->
<g id="node884" class="node">
<title>moe_41_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1863" cy="-18661.33" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1863" y="-18675.33" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1863" y="-18664.33" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1863" y="-18653.33" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1863" y="-18642.33" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_41_expert_0&#45;&gt;moe_41_aggregate -->
<g id="edge1439" class="edge">
<title>moe_41_expert_0&#45;&gt;moe_41_aggregate</title>
<path fill="none" stroke="black" d="M320.18,-18735.32C323.15,-18734.88 326.09,-18734.48 329,-18734.1 574.12,-18702.61 1268.7,-18679.09 1633.21,-18668.52"/>
<polygon fill="black" stroke="black" points="1633.47,-18672.01 1643.36,-18668.22 1633.27,-18665.01 1633.47,-18672.01"/>
</g>
<!-- moe_41_expert_1&#45;&gt;moe_41_aggregate -->
<g id="edge1440" class="edge">
<title>moe_41_expert_1&#45;&gt;moe_41_aggregate</title>
<path fill="none" stroke="black" d="M556.19,-18735.35C559.15,-18734.91 562.09,-18734.49 565,-18734.1 935.22,-18684.95 1369.16,-18669.35 1629.76,-18664.47"/>
<polygon fill="black" stroke="black" points="1630.17,-18667.96 1640.11,-18664.28 1630.05,-18660.96 1630.17,-18667.96"/>
</g>
<!-- moe_41_expert_2&#45;&gt;moe_41_aggregate -->
<g id="edge1441" class="edge">
<title>moe_41_expert_2&#45;&gt;moe_41_aggregate</title>
<path fill="none" stroke="black" d="M792.2,-18735.4C795.16,-18734.94 798.1,-18734.51 801,-18734.1 1086.02,-18694.48 1417.23,-18676.51 1632.98,-18668.51"/>
<polygon fill="black" stroke="black" points="1633.3,-18672 1643.17,-18668.13 1633.05,-18665 1633.3,-18672"/>
</g>
<!-- moe_41_expert_3&#45;&gt;moe_41_aggregate -->
<g id="edge1442" class="edge">
<title>moe_41_expert_3&#45;&gt;moe_41_aggregate</title>
<path fill="none" stroke="black" d="M1028.21,-18735.48C1031.16,-18734.99 1034.1,-18734.53 1037,-18734.1 1240.78,-18703.78 1474.89,-18684.93 1641.72,-18674.2"/>
<polygon fill="black" stroke="black" points="1642.35,-18677.67 1652.11,-18673.54 1641.91,-18670.68 1642.35,-18677.67"/>
</g>
<!-- moe_41_expert_4&#45;&gt;moe_41_aggregate -->
<g id="edge1443" class="edge">
<title>moe_41_expert_4&#45;&gt;moe_41_aggregate</title>
<path fill="none" stroke="black" d="M1264.23,-18735.61C1267.18,-18735.09 1270.11,-18734.58 1273,-18734.1 1402.69,-18712.52 1549.43,-18694.64 1664.13,-18682.13"/>
<polygon fill="black" stroke="black" points="1664.51,-18685.61 1674.07,-18681.05 1663.75,-18678.65 1664.51,-18685.61"/>
</g>
<!-- moe_41_expert_5&#45;&gt;moe_41_aggregate -->
<g id="edge1444" class="edge">
<title>moe_41_expert_5&#45;&gt;moe_41_aggregate</title>
<path fill="none" stroke="black" d="M1500.28,-18735.91C1503.22,-18735.3 1506.13,-18734.7 1509,-18734.1 1576.32,-18720.15 1650.9,-18704.98 1714.19,-18692.2"/>
<polygon fill="black" stroke="black" points="1715.13,-18695.58 1724.24,-18690.17 1713.75,-18688.72 1715.13,-18695.58"/>
</g>
<!-- moe_41_expert_6&#45;&gt;moe_41_aggregate -->
<g id="edge1445" class="edge">
<title>moe_41_expert_6&#45;&gt;moe_41_aggregate</title>
<path fill="none" stroke="black" d="M1688.08,-18734.06C1713.73,-18723.54 1744.09,-18711.09 1772.26,-18699.54"/>
<polygon fill="black" stroke="black" points="1773.79,-18702.7 1781.72,-18695.66 1771.14,-18696.22 1773.79,-18702.7"/>
</g>
<!-- moe_41_expert_7&#45;&gt;moe_41_aggregate -->
<g id="edge1446" class="edge">
<title>moe_41_expert_7&#45;&gt;moe_41_aggregate</title>
<path fill="none" stroke="black" d="M1863,-18733.93C1863,-18726.12 1863,-18717.26 1863,-18708.49"/>
<polygon fill="black" stroke="black" points="1866.5,-18708.31 1863,-18698.31 1859.5,-18708.31 1866.5,-18708.31"/>
</g>
<!-- moe_41_expert_8&#45;&gt;moe_41_aggregate -->
<g id="edge1447" class="edge">
<title>moe_41_expert_8&#45;&gt;moe_41_aggregate</title>
<path fill="none" stroke="black" d="M2037.92,-18734.06C2012.27,-18723.54 1981.91,-18711.09 1953.74,-18699.54"/>
<polygon fill="black" stroke="black" points="1954.86,-18696.22 1944.28,-18695.66 1952.21,-18702.7 1954.86,-18696.22"/>
</g>
<!-- moe_41_expert_9&#45;&gt;moe_41_aggregate -->
<g id="edge1448" class="edge">
<title>moe_41_expert_9&#45;&gt;moe_41_aggregate</title>
<path fill="none" stroke="black" d="M2225.72,-18735.91C2222.78,-18735.3 2219.87,-18734.7 2217,-18734.1 2149.68,-18720.15 2075.1,-18704.98 2011.81,-18692.2"/>
<polygon fill="black" stroke="black" points="2012.25,-18688.72 2001.76,-18690.17 2010.87,-18695.58 2012.25,-18688.72"/>
</g>
<!-- moe_41_expert_10&#45;&gt;moe_41_aggregate -->
<g id="edge1449" class="edge">
<title>moe_41_expert_10&#45;&gt;moe_41_aggregate</title>
<path fill="none" stroke="black" d="M2461.77,-18735.61C2458.82,-18735.09 2455.89,-18734.58 2453,-18734.1 2323.31,-18712.52 2176.57,-18694.64 2061.87,-18682.13"/>
<polygon fill="black" stroke="black" points="2062.25,-18678.65 2051.93,-18681.05 2061.49,-18685.61 2062.25,-18678.65"/>
</g>
<!-- moe_41_expert_11&#45;&gt;moe_41_aggregate -->
<g id="edge1450" class="edge">
<title>moe_41_expert_11&#45;&gt;moe_41_aggregate</title>
<path fill="none" stroke="black" d="M2697.79,-18735.48C2694.84,-18734.99 2691.9,-18734.53 2689,-18734.1 2485.22,-18703.78 2251.11,-18684.93 2084.28,-18674.2"/>
<polygon fill="black" stroke="black" points="2084.09,-18670.68 2073.89,-18673.54 2083.65,-18677.67 2084.09,-18670.68"/>
</g>
<!-- moe_41_expert_12&#45;&gt;moe_41_aggregate -->
<g id="edge1451" class="edge">
<title>moe_41_expert_12&#45;&gt;moe_41_aggregate</title>
<path fill="none" stroke="black" d="M2933.8,-18735.4C2930.84,-18734.94 2927.9,-18734.51 2925,-18734.1 2639.98,-18694.48 2308.77,-18676.51 2093.02,-18668.51"/>
<polygon fill="black" stroke="black" points="2092.95,-18665 2082.83,-18668.13 2092.7,-18672 2092.95,-18665"/>
</g>
<!-- moe_41_expert_13&#45;&gt;moe_41_aggregate -->
<g id="edge1452" class="edge">
<title>moe_41_expert_13&#45;&gt;moe_41_aggregate</title>
<path fill="none" stroke="black" d="M3169.81,-18735.35C3166.85,-18734.91 3163.91,-18734.49 3161,-18734.1 2790.78,-18684.95 2356.84,-18669.35 2096.24,-18664.47"/>
<polygon fill="black" stroke="black" points="2095.95,-18660.96 2085.89,-18664.28 2095.83,-18667.96 2095.95,-18660.96"/>
</g>
<!-- moe_41_expert_14&#45;&gt;moe_41_aggregate -->
<g id="edge1453" class="edge">
<title>moe_41_expert_14&#45;&gt;moe_41_aggregate</title>
<path fill="none" stroke="black" d="M3405.82,-18735.32C3402.85,-18734.88 3399.91,-18734.48 3397,-18734.1 3151.88,-18702.61 2457.3,-18679.09 2092.79,-18668.52"/>
<polygon fill="black" stroke="black" points="2092.73,-18665.01 2082.64,-18668.22 2092.53,-18672.01 2092.73,-18665.01"/>
</g>
<!-- moe_41_expert_15&#45;&gt;moe_41_aggregate -->
<g id="edge1454" class="edge">
<title>moe_41_expert_15&#45;&gt;moe_41_aggregate</title>
<path fill="none" stroke="black" d="M3641.82,-18735.3C3638.85,-18734.87 3635.91,-18734.47 3633,-18734.1 3342.39,-18697.69 2504.41,-18675.73 2094.44,-18666.88"/>
<polygon fill="black" stroke="black" points="2094.31,-18663.37 2084.24,-18666.66 2094.16,-18670.37 2094.31,-18663.37"/>
</g>
<!-- moe_41_ffn -->
<g id="node885" class="node">
<title>moe_41_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2021,-18588.56 1705,-18588.56 1705,-18536.56 2021,-18536.56 2021,-18588.56"/>
<text text-anchor="middle" x="1863" y="-18576.56" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1863" y="-18565.56" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-18554.56" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-18543.56" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_41_aggregate&#45;&gt;moe_41_ffn -->
<g id="edge1455" class="edge">
<title>moe_41_aggregate&#45;&gt;moe_41_ffn</title>
<path fill="none" stroke="black" d="M1863,-18624.3C1863,-18615.99 1863,-18607.15 1863,-18598.87"/>
<polygon fill="black" stroke="black" points="1866.5,-18598.76 1863,-18588.76 1859.5,-18598.76 1866.5,-18598.76"/>
</g>
<!-- moe_41_res2 -->
<g id="node887" class="node">
<title>moe_41_res2</title>
<polygon fill="lightyellow" stroke="black" points="2199.89,-18500.56 1663.97,-18500.56 1526.11,-18396.56 2062.03,-18396.56 2199.89,-18500.56"/>
<text text-anchor="middle" x="1863" y="-18462.56" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1863" y="-18451.56" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-18440.56" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1863" y="-18429.56" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_41_ffn&#45;&gt;moe_41_res2 -->
<g id="edge1456" class="edge">
<title>moe_41_ffn&#45;&gt;moe_41_res2</title>
<path fill="none" stroke="black" d="M1863,-18536.43C1863,-18528.74 1863,-18519.93 1863,-18510.93"/>
<polygon fill="black" stroke="black" points="1866.5,-18510.74 1863,-18500.74 1859.5,-18510.74 1866.5,-18510.74"/>
</g>
<!-- moe_41_res1&#45;&gt;moe_41_gate -->
<g id="edge1421" class="edge">
<title>moe_41_res1&#45;&gt;moe_41_gate</title>
<path fill="none" stroke="black" d="M1863,-19071.26C1863,-19063.08 1863,-19054.56 1863,-19046.18"/>
<polygon fill="black" stroke="black" points="1866.5,-19046.07 1863,-19036.07 1859.5,-19046.07 1866.5,-19046.07"/>
</g>
<!-- moe_42_mha -->
<g id="node888" class="node">
<title>moe_42_mha</title>
<polygon fill="lightgreen" stroke="black" points="2021,-18349.56 1705,-18349.56 1705,-18297.56 2021,-18297.56 2021,-18349.56"/>
<text text-anchor="middle" x="1863" y="-18337.56" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1863" y="-18326.56" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-18315.56" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-18304.56" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_41_res2&#45;&gt;moe_42_mha -->
<g id="edge1457" class="edge">
<title>moe_41_res2&#45;&gt;moe_42_mha</title>
<path fill="none" stroke="black" d="M1863,-18396.47C1863,-18384.14 1863,-18371.23 1863,-18359.82"/>
<polygon fill="black" stroke="black" points="1866.5,-18359.81 1863,-18349.81 1859.5,-18359.81 1866.5,-18359.81"/>
</g>
<!-- moe_42_res1 -->
<g id="node909" class="node">
<title>moe_42_res1</title>
<polygon fill="lightyellow" stroke="black" points="2199.89,-18261.56 1663.97,-18261.56 1526.11,-18157.56 2062.03,-18157.56 2199.89,-18261.56"/>
<text text-anchor="middle" x="1863" y="-18223.56" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1863" y="-18212.56" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-18201.56" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1863" y="-18190.56" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_42_mha&#45;&gt;moe_42_res1 -->
<g id="edge1458" class="edge">
<title>moe_42_mha&#45;&gt;moe_42_res1</title>
<path fill="none" stroke="black" d="M1863,-18297.43C1863,-18289.74 1863,-18280.93 1863,-18271.93"/>
<polygon fill="black" stroke="black" points="1866.5,-18271.74 1863,-18261.74 1859.5,-18271.74 1866.5,-18271.74"/>
</g>
<!-- moe_42_gate -->
<g id="node889" class="node">
<title>moe_42_gate</title>
<polygon fill="lightyellow" stroke="black" points="2191.8,-18121.56 1668.75,-18121.56 1534.2,-18017.56 2057.25,-18017.56 2191.8,-18121.56"/>
<text text-anchor="middle" x="1863" y="-18083.56" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1863" y="-18072.56" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1863" y="-18061.56" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-18050.56" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_42_route -->
<g id="node890" class="node">
<title>moe_42_route</title>
<ellipse fill="lightblue" stroke="black" cx="1863" cy="-17944.79" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1863" y="-17958.79" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1863" y="-17947.79" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1863" y="-17936.79" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-17925.79" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_42_gate&#45;&gt;moe_42_route -->
<g id="edge1460" class="edge">
<title>moe_42_gate&#45;&gt;moe_42_route</title>
<path fill="none" stroke="black" d="M1863,-18017.21C1863,-18008.8 1863,-18000.14 1863,-17991.86"/>
<polygon fill="black" stroke="black" points="1866.5,-17991.65 1863,-17981.65 1859.5,-17991.65 1866.5,-17991.65"/>
</g>
<!-- moe_42_expert_0 -->
<g id="node891" class="node">
<title>moe_42_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="320,-17872.03 102,-17872.03 102,-17820.03 320,-17820.03 320,-17872.03"/>
<text text-anchor="middle" x="211" y="-17860.03" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="211" y="-17849.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="211" y="-17838.03" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="211" y="-17827.03" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_42_route&#45;&gt;moe_42_expert_0 -->
<g id="edge1461" class="edge">
<title>moe_42_route&#45;&gt;moe_42_expert_0</title>
<path fill="none" stroke="black" d="M1648.77,-17938.06C1293.39,-17927.84 595.65,-17904.57 330.21,-17872.07"/>
<polygon fill="black" stroke="black" points="330.54,-17868.58 320.18,-17870.81 329.67,-17875.53 330.54,-17868.58"/>
</g>
<!-- moe_42_expert_1 -->
<g id="node892" class="node">
<title>moe_42_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="556,-17872.03 338,-17872.03 338,-17820.03 556,-17820.03 556,-17872.03"/>
<text text-anchor="middle" x="447" y="-17860.03" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="447" y="-17849.03" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="447" y="-17838.03" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="447" y="-17827.03" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_42_route&#45;&gt;moe_42_expert_1 -->
<g id="edge1462" class="edge">
<title>moe_42_route&#45;&gt;moe_42_expert_1</title>
<path fill="none" stroke="black" d="M1645.59,-17941.95C1389.22,-17937.44 950.4,-17922.45 566.11,-17872.08"/>
<polygon fill="black" stroke="black" points="566.56,-17868.61 556.19,-17870.77 565.64,-17875.55 566.56,-17868.61"/>
</g>
<!-- moe_42_expert_2 -->
<g id="node893" class="node">
<title>moe_42_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="792,-17872.03 574,-17872.03 574,-17820.03 792,-17820.03 792,-17872.03"/>
<text text-anchor="middle" x="683" y="-17860.03" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="683" y="-17849.03" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="683" y="-17838.03" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="683" y="-17827.03" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_42_route&#45;&gt;moe_42_expert_2 -->
<g id="edge1463" class="edge">
<title>moe_42_route&#45;&gt;moe_42_expert_2</title>
<path fill="none" stroke="black" d="M1648.51,-17938.19C1435.77,-17930.57 1100.57,-17913.01 802.34,-17872.13"/>
<polygon fill="black" stroke="black" points="802.58,-17868.63 792.2,-17870.73 801.62,-17875.56 802.58,-17868.63"/>
</g>
<!-- moe_42_expert_3 -->
<g id="node894" class="node">
<title>moe_42_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1028,-17872.03 810,-17872.03 810,-17820.03 1028,-17820.03 1028,-17872.03"/>
<text text-anchor="middle" x="919" y="-17860.03" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="919" y="-17849.03" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="919" y="-17838.03" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="919" y="-17827.03" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_42_route&#45;&gt;moe_42_expert_3 -->
<g id="edge1464" class="edge">
<title>moe_42_route&#45;&gt;moe_42_expert_3</title>
<path fill="none" stroke="black" d="M1656.82,-17932.89C1491.76,-17922.5 1254.32,-17903.85 1038.16,-17872.12"/>
<polygon fill="black" stroke="black" points="1038.61,-17868.65 1028.21,-17870.65 1037.59,-17875.58 1038.61,-17868.65"/>
</g>
<!-- moe_42_expert_4 -->
<g id="node895" class="node">
<title>moe_42_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1264,-17872.03 1046,-17872.03 1046,-17820.03 1264,-17820.03 1264,-17872.03"/>
<text text-anchor="middle" x="1155" y="-17860.03" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1155" y="-17849.03" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1155" y="-17838.03" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1155" y="-17827.03" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_42_route&#45;&gt;moe_42_expert_4 -->
<g id="edge1465" class="edge">
<title>moe_42_route&#45;&gt;moe_42_expert_4</title>
<path fill="none" stroke="black" d="M1677.38,-17925.44C1563.62,-17913.17 1414.9,-17895.31 1274.33,-17872.19"/>
<polygon fill="black" stroke="black" points="1274.66,-17868.7 1264.23,-17870.52 1273.52,-17875.61 1274.66,-17868.7"/>
</g>
<!-- moe_42_expert_5 -->
<g id="node896" class="node">
<title>moe_42_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1500,-17872.03 1282,-17872.03 1282,-17820.03 1500,-17820.03 1500,-17872.03"/>
<text text-anchor="middle" x="1391" y="-17860.03" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1391" y="-17849.03" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1391" y="-17838.03" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1391" y="-17827.03" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_42_route&#45;&gt;moe_42_expert_5 -->
<g id="edge1466" class="edge">
<title>moe_42_route&#45;&gt;moe_42_expert_5</title>
<path fill="none" stroke="black" d="M1725.51,-17916.21C1662.62,-17903.52 1586.88,-17888.14 1510.14,-17872.25"/>
<polygon fill="black" stroke="black" points="1510.79,-17868.82 1500.28,-17870.21 1509.37,-17875.67 1510.79,-17868.82"/>
</g>
<!-- moe_42_expert_6 -->
<g id="node897" class="node">
<title>moe_42_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1736,-17872.03 1518,-17872.03 1518,-17820.03 1736,-17820.03 1736,-17872.03"/>
<text text-anchor="middle" x="1627" y="-17860.03" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1627" y="-17849.03" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1627" y="-17838.03" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1627" y="-17827.03" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_42_route&#45;&gt;moe_42_expert_6 -->
<g id="edge1467" class="edge">
<title>moe_42_route&#45;&gt;moe_42_expert_6</title>
<path fill="none" stroke="black" d="M1782.11,-17910.63C1754.54,-17899.32 1723.96,-17886.78 1697.29,-17875.85"/>
<polygon fill="black" stroke="black" points="1698.61,-17872.6 1688.03,-17872.05 1695.95,-17879.08 1698.61,-17872.6"/>
</g>
<!-- moe_42_expert_7 -->
<g id="node898" class="node">
<title>moe_42_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1972,-17872.03 1754,-17872.03 1754,-17820.03 1972,-17820.03 1972,-17872.03"/>
<text text-anchor="middle" x="1863" y="-17860.03" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1863" y="-17849.03" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1863" y="-17838.03" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1863" y="-17827.03" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_42_route&#45;&gt;moe_42_expert_7 -->
<g id="edge1468" class="edge">
<title>moe_42_route&#45;&gt;moe_42_expert_7</title>
<path fill="none" stroke="black" d="M1863,-17907.76C1863,-17899.45 1863,-17890.62 1863,-17882.33"/>
<polygon fill="black" stroke="black" points="1866.5,-17882.22 1863,-17872.22 1859.5,-17882.22 1866.5,-17882.22"/>
</g>
<!-- moe_42_expert_8 -->
<g id="node899" class="node">
<title>moe_42_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2208,-17872.03 1990,-17872.03 1990,-17820.03 2208,-17820.03 2208,-17872.03"/>
<text text-anchor="middle" x="2099" y="-17860.03" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2099" y="-17849.03" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2099" y="-17838.03" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2099" y="-17827.03" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_42_route&#45;&gt;moe_42_expert_8 -->
<g id="edge1469" class="edge">
<title>moe_42_route&#45;&gt;moe_42_expert_8</title>
<path fill="none" stroke="black" d="M1943.89,-17910.63C1971.46,-17899.32 2002.04,-17886.78 2028.71,-17875.85"/>
<polygon fill="black" stroke="black" points="2030.05,-17879.08 2037.97,-17872.05 2027.39,-17872.6 2030.05,-17879.08"/>
</g>
<!-- moe_42_expert_9 -->
<g id="node900" class="node">
<title>moe_42_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2444,-17872.03 2226,-17872.03 2226,-17820.03 2444,-17820.03 2444,-17872.03"/>
<text text-anchor="middle" x="2335" y="-17860.03" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2335" y="-17849.03" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2335" y="-17838.03" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2335" y="-17827.03" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_42_route&#45;&gt;moe_42_expert_9 -->
<g id="edge1470" class="edge">
<title>moe_42_route&#45;&gt;moe_42_expert_9</title>
<path fill="none" stroke="black" d="M2000.49,-17916.21C2063.38,-17903.52 2139.12,-17888.14 2215.86,-17872.25"/>
<polygon fill="black" stroke="black" points="2216.63,-17875.67 2225.72,-17870.21 2215.21,-17868.82 2216.63,-17875.67"/>
</g>
<!-- moe_42_expert_10 -->
<g id="node901" class="node">
<title>moe_42_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2680,-17872.03 2462,-17872.03 2462,-17820.03 2680,-17820.03 2680,-17872.03"/>
<text text-anchor="middle" x="2571" y="-17860.03" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2571" y="-17849.03" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2571" y="-17838.03" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2571" y="-17827.03" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_42_route&#45;&gt;moe_42_expert_10 -->
<g id="edge1471" class="edge">
<title>moe_42_route&#45;&gt;moe_42_expert_10</title>
<path fill="none" stroke="black" d="M2048.62,-17925.44C2162.38,-17913.17 2311.1,-17895.31 2451.67,-17872.19"/>
<polygon fill="black" stroke="black" points="2452.48,-17875.61 2461.77,-17870.52 2451.34,-17868.7 2452.48,-17875.61"/>
</g>
<!-- moe_42_expert_11 -->
<g id="node902" class="node">
<title>moe_42_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2916,-17872.03 2698,-17872.03 2698,-17820.03 2916,-17820.03 2916,-17872.03"/>
<text text-anchor="middle" x="2807" y="-17860.03" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2807" y="-17849.03" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2807" y="-17838.03" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2807" y="-17827.03" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_42_route&#45;&gt;moe_42_expert_11 -->
<g id="edge1472" class="edge">
<title>moe_42_route&#45;&gt;moe_42_expert_11</title>
<path fill="none" stroke="black" d="M2069.18,-17932.89C2234.24,-17922.5 2471.68,-17903.85 2687.84,-17872.12"/>
<polygon fill="black" stroke="black" points="2688.41,-17875.58 2697.79,-17870.65 2687.39,-17868.65 2688.41,-17875.58"/>
</g>
<!-- moe_42_expert_12 -->
<g id="node903" class="node">
<title>moe_42_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3152,-17872.03 2934,-17872.03 2934,-17820.03 3152,-17820.03 3152,-17872.03"/>
<text text-anchor="middle" x="3043" y="-17860.03" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="3043" y="-17849.03" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3043" y="-17838.03" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3043" y="-17827.03" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_42_route&#45;&gt;moe_42_expert_12 -->
<g id="edge1473" class="edge">
<title>moe_42_route&#45;&gt;moe_42_expert_12</title>
<path fill="none" stroke="black" d="M2077.49,-17938.19C2290.23,-17930.57 2625.43,-17913.01 2923.66,-17872.13"/>
<polygon fill="black" stroke="black" points="2924.38,-17875.56 2933.8,-17870.73 2923.42,-17868.63 2924.38,-17875.56"/>
</g>
<!-- moe_42_expert_13 -->
<g id="node904" class="node">
<title>moe_42_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3388,-17872.03 3170,-17872.03 3170,-17820.03 3388,-17820.03 3388,-17872.03"/>
<text text-anchor="middle" x="3279" y="-17860.03" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3279" y="-17849.03" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3279" y="-17838.03" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3279" y="-17827.03" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_42_route&#45;&gt;moe_42_expert_13 -->
<g id="edge1474" class="edge">
<title>moe_42_route&#45;&gt;moe_42_expert_13</title>
<path fill="none" stroke="black" d="M2080.41,-17941.95C2336.78,-17937.44 2775.6,-17922.45 3159.89,-17872.08"/>
<polygon fill="black" stroke="black" points="3160.36,-17875.55 3169.81,-17870.77 3159.44,-17868.61 3160.36,-17875.55"/>
</g>
<!-- moe_42_expert_14 -->
<g id="node905" class="node">
<title>moe_42_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3624,-17872.03 3406,-17872.03 3406,-17820.03 3624,-17820.03 3624,-17872.03"/>
<text text-anchor="middle" x="3515" y="-17860.03" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3515" y="-17849.03" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3515" y="-17838.03" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3515" y="-17827.03" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_42_route&#45;&gt;moe_42_expert_14 -->
<g id="edge1475" class="edge">
<title>moe_42_route&#45;&gt;moe_42_expert_14</title>
<path fill="none" stroke="black" d="M2077.23,-17938.06C2432.61,-17927.84 3130.35,-17904.57 3395.79,-17872.07"/>
<polygon fill="black" stroke="black" points="3396.33,-17875.53 3405.82,-17870.81 3395.46,-17868.58 3396.33,-17875.53"/>
</g>
<!-- moe_42_expert_15 -->
<g id="node906" class="node">
<title>moe_42_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3860,-17872.03 3642,-17872.03 3642,-17820.03 3860,-17820.03 3860,-17872.03"/>
<text text-anchor="middle" x="3751" y="-17860.03" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3751" y="-17849.03" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3751" y="-17838.03" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3751" y="-17827.03" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_42_route&#45;&gt;moe_42_expert_15 -->
<g id="edge1476" class="edge">
<title>moe_42_route&#45;&gt;moe_42_expert_15</title>
<path fill="none" stroke="black" d="M2078.71,-17939.59C2478.25,-17931.06 3320.28,-17909.38 3631.86,-17872.05"/>
<polygon fill="black" stroke="black" points="3632.32,-17875.52 3641.82,-17870.83 3631.47,-17868.58 3632.32,-17875.52"/>
</g>
<!-- moe_42_aggregate -->
<g id="node907" class="node">
<title>moe_42_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1981" cy="-17747.26" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1981" y="-17761.26" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1981" y="-17750.26" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1981" y="-17739.26" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1981" y="-17728.26" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_42_expert_0&#45;&gt;moe_42_aggregate -->
<g id="edge1477" class="edge">
<title>moe_42_expert_0&#45;&gt;moe_42_aggregate</title>
<path fill="none" stroke="black" d="M320.18,-17821.23C323.15,-17820.8 326.09,-17820.39 329,-17820.03 596.74,-17786.08 1362.32,-17763.29 1750.04,-17753.57"/>
<polygon fill="black" stroke="black" points="1750.35,-17757.06 1760.26,-17753.31 1750.17,-17750.07 1750.35,-17757.06"/>
</g>
<!-- moe_42_expert_1&#45;&gt;moe_42_aggregate -->
<g id="edge1478" class="edge">
<title>moe_42_expert_1&#45;&gt;moe_42_aggregate</title>
<path fill="none" stroke="black" d="M556.19,-17821.26C559.15,-17820.82 562.09,-17820.4 565,-17820.03 978.79,-17766.05 1465.51,-17752.09 1747.11,-17748.81"/>
<polygon fill="black" stroke="black" points="1747.49,-17752.31 1757.45,-17748.7 1747.41,-17745.31 1747.49,-17752.31"/>
</g>
<!-- moe_42_expert_2&#45;&gt;moe_42_aggregate -->
<g id="edge1479" class="edge">
<title>moe_42_expert_2&#45;&gt;moe_42_aggregate</title>
<path fill="none" stroke="black" d="M792.19,-17821.3C795.15,-17820.84 798.09,-17820.42 801,-17820.03 1128.31,-17775.65 1510.45,-17758.7 1749.11,-17752.24"/>
<polygon fill="black" stroke="black" points="1749.4,-17755.73 1759.31,-17751.96 1749.22,-17748.73 1749.4,-17755.73"/>
</g>
<!-- moe_42_expert_3&#45;&gt;moe_42_aggregate -->
<g id="edge1480" class="edge">
<title>moe_42_expert_3&#45;&gt;moe_42_aggregate</title>
<path fill="none" stroke="black" d="M1028.2,-17821.36C1031.16,-17820.89 1034.1,-17820.44 1037,-17820.03 1280.76,-17785.1 1562.52,-17766.47 1754.32,-17757.03"/>
<polygon fill="black" stroke="black" points="1754.71,-17760.51 1764.53,-17756.53 1754.37,-17753.52 1754.71,-17760.51"/>
</g>
<!-- moe_42_expert_4&#45;&gt;moe_42_aggregate -->
<g id="edge1481" class="edge">
<title>moe_42_expert_4&#45;&gt;moe_42_aggregate</title>
<path fill="none" stroke="black" d="M1264.21,-17821.45C1267.17,-17820.96 1270.1,-17820.48 1273,-17820.03 1438.7,-17794.15 1627.73,-17775.54 1768.77,-17763.76"/>
<polygon fill="black" stroke="black" points="1769.17,-17767.24 1778.84,-17762.92 1768.59,-17760.26 1769.17,-17767.24"/>
</g>
<!-- moe_42_expert_5&#45;&gt;moe_42_aggregate -->
<g id="edge1482" class="edge">
<title>moe_42_expert_5&#45;&gt;moe_42_aggregate</title>
<path fill="none" stroke="black" d="M1500.25,-17821.65C1503.19,-17821.09 1506.12,-17820.55 1509,-17820.03 1605.58,-17802.47 1713.83,-17785.79 1802.27,-17772.94"/>
<polygon fill="black" stroke="black" points="1803.01,-17776.37 1812.4,-17771.48 1802,-17769.45 1803.01,-17776.37"/>
</g>
<!-- moe_42_expert_6&#45;&gt;moe_42_aggregate -->
<g id="edge1483" class="edge">
<title>moe_42_expert_6&#45;&gt;moe_42_aggregate</title>
<path fill="none" stroke="black" d="M1718.62,-17819.98C1761.27,-17808.32 1812.62,-17794.28 1858.54,-17781.73"/>
<polygon fill="black" stroke="black" points="1859.53,-17785.09 1868.25,-17779.08 1857.68,-17778.34 1859.53,-17785.09"/>
</g>
<!-- moe_42_expert_7&#45;&gt;moe_42_aggregate -->
<g id="edge1484" class="edge">
<title>moe_42_expert_7&#45;&gt;moe_42_aggregate</title>
<path fill="none" stroke="black" d="M1893.7,-17819.85C1904.79,-17810.76 1917.63,-17800.23 1929.99,-17790.09"/>
<polygon fill="black" stroke="black" points="1932.51,-17792.55 1938.02,-17783.5 1928.07,-17787.14 1932.51,-17792.55"/>
</g>
<!-- moe_42_expert_8&#45;&gt;moe_42_aggregate -->
<g id="edge1485" class="edge">
<title>moe_42_expert_8&#45;&gt;moe_42_aggregate</title>
<path fill="none" stroke="black" d="M2068.3,-17819.85C2057.21,-17810.76 2044.37,-17800.23 2032.01,-17790.09"/>
<polygon fill="black" stroke="black" points="2033.93,-17787.14 2023.98,-17783.5 2029.49,-17792.55 2033.93,-17787.14"/>
</g>
<!-- moe_42_expert_9&#45;&gt;moe_42_aggregate -->
<g id="edge1486" class="edge">
<title>moe_42_expert_9&#45;&gt;moe_42_aggregate</title>
<path fill="none" stroke="black" d="M2243.38,-17819.98C2200.73,-17808.32 2149.38,-17794.28 2103.46,-17781.73"/>
<polygon fill="black" stroke="black" points="2104.32,-17778.34 2093.75,-17779.08 2102.47,-17785.09 2104.32,-17778.34"/>
</g>
<!-- moe_42_expert_10&#45;&gt;moe_42_aggregate -->
<g id="edge1487" class="edge">
<title>moe_42_expert_10&#45;&gt;moe_42_aggregate</title>
<path fill="none" stroke="black" d="M2461.75,-17821.65C2458.81,-17821.09 2455.88,-17820.55 2453,-17820.03 2356.42,-17802.47 2248.17,-17785.79 2159.73,-17772.94"/>
<polygon fill="black" stroke="black" points="2160,-17769.45 2149.6,-17771.48 2158.99,-17776.37 2160,-17769.45"/>
</g>
<!-- moe_42_expert_11&#45;&gt;moe_42_aggregate -->
<g id="edge1488" class="edge">
<title>moe_42_expert_11&#45;&gt;moe_42_aggregate</title>
<path fill="none" stroke="black" d="M2697.79,-17821.45C2694.83,-17820.96 2691.9,-17820.48 2689,-17820.03 2523.3,-17794.15 2334.27,-17775.54 2193.23,-17763.76"/>
<polygon fill="black" stroke="black" points="2193.41,-17760.26 2183.16,-17762.92 2192.83,-17767.24 2193.41,-17760.26"/>
</g>
<!-- moe_42_expert_12&#45;&gt;moe_42_aggregate -->
<g id="edge1489" class="edge">
<title>moe_42_expert_12&#45;&gt;moe_42_aggregate</title>
<path fill="none" stroke="black" d="M2933.8,-17821.36C2930.84,-17820.89 2927.9,-17820.44 2925,-17820.03 2681.24,-17785.1 2399.48,-17766.47 2207.68,-17757.03"/>
<polygon fill="black" stroke="black" points="2207.63,-17753.52 2197.47,-17756.53 2207.29,-17760.51 2207.63,-17753.52"/>
</g>
<!-- moe_42_expert_13&#45;&gt;moe_42_aggregate -->
<g id="edge1490" class="edge">
<title>moe_42_expert_13&#45;&gt;moe_42_aggregate</title>
<path fill="none" stroke="black" d="M3169.81,-17821.3C3166.85,-17820.84 3163.91,-17820.42 3161,-17820.03 2833.69,-17775.65 2451.55,-17758.7 2212.89,-17752.24"/>
<polygon fill="black" stroke="black" points="2212.78,-17748.73 2202.69,-17751.96 2212.6,-17755.73 2212.78,-17748.73"/>
</g>
<!-- moe_42_expert_14&#45;&gt;moe_42_aggregate -->
<g id="edge1491" class="edge">
<title>moe_42_expert_14&#45;&gt;moe_42_aggregate</title>
<path fill="none" stroke="black" d="M3405.81,-17821.26C3402.85,-17820.82 3399.91,-17820.4 3397,-17820.03 2983.21,-17766.05 2496.49,-17752.09 2214.89,-17748.81"/>
<polygon fill="black" stroke="black" points="2214.59,-17745.31 2204.55,-17748.7 2214.51,-17752.31 2214.59,-17745.31"/>
</g>
<!-- moe_42_expert_15&#45;&gt;moe_42_aggregate -->
<g id="edge1492" class="edge">
<title>moe_42_expert_15&#45;&gt;moe_42_aggregate</title>
<path fill="none" stroke="black" d="M3641.82,-17821.23C3638.85,-17820.8 3635.91,-17820.39 3633,-17820.03 3365.26,-17786.08 2599.68,-17763.29 2211.96,-17753.57"/>
<polygon fill="black" stroke="black" points="2211.83,-17750.07 2201.74,-17753.31 2211.65,-17757.06 2211.83,-17750.07"/>
</g>
<!-- moe_42_ffn -->
<g id="node908" class="node">
<title>moe_42_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2139,-17674.49 1823,-17674.49 1823,-17622.49 2139,-17622.49 2139,-17674.49"/>
<text text-anchor="middle" x="1981" y="-17662.49" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1981" y="-17651.49" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1981" y="-17640.49" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1981" y="-17629.49" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_42_aggregate&#45;&gt;moe_42_ffn -->
<g id="edge1493" class="edge">
<title>moe_42_aggregate&#45;&gt;moe_42_ffn</title>
<path fill="none" stroke="black" d="M1981,-17710.22C1981,-17701.91 1981,-17693.08 1981,-17684.8"/>
<polygon fill="black" stroke="black" points="1984.5,-17684.68 1981,-17674.68 1977.5,-17684.68 1984.5,-17684.68"/>
</g>
<!-- moe_42_res2 -->
<g id="node910" class="node">
<title>moe_42_res2</title>
<polygon fill="lightyellow" stroke="black" points="2317.89,-17586.49 1781.97,-17586.49 1644.11,-17482.49 2180.03,-17482.49 2317.89,-17586.49"/>
<text text-anchor="middle" x="1981" y="-17548.49" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1981" y="-17537.49" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1981" y="-17526.49" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1981" y="-17515.49" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_42_ffn&#45;&gt;moe_42_res2 -->
<g id="edge1494" class="edge">
<title>moe_42_ffn&#45;&gt;moe_42_res2</title>
<path fill="none" stroke="black" d="M1981,-17622.35C1981,-17614.67 1981,-17605.85 1981,-17596.85"/>
<polygon fill="black" stroke="black" points="1984.5,-17596.66 1981,-17586.66 1977.5,-17596.66 1984.5,-17596.66"/>
</g>
<!-- moe_42_res1&#45;&gt;moe_42_gate -->
<g id="edge1459" class="edge">
<title>moe_42_res1&#45;&gt;moe_42_gate</title>
<path fill="none" stroke="black" d="M1863,-18157.18C1863,-18149.01 1863,-18140.48 1863,-18132.1"/>
<polygon fill="black" stroke="black" points="1866.5,-18131.99 1863,-18121.99 1859.5,-18131.99 1866.5,-18131.99"/>
</g>
<!-- moe_43_mha -->
<g id="node911" class="node">
<title>moe_43_mha</title>
<polygon fill="lightgreen" stroke="black" points="2139,-17435.49 1823,-17435.49 1823,-17383.49 2139,-17383.49 2139,-17435.49"/>
<text text-anchor="middle" x="1981" y="-17423.49" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1981" y="-17412.49" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1981" y="-17401.49" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1981" y="-17390.49" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_42_res2&#45;&gt;moe_43_mha -->
<g id="edge1495" class="edge">
<title>moe_42_res2&#45;&gt;moe_43_mha</title>
<path fill="none" stroke="black" d="M1981,-17482.39C1981,-17470.06 1981,-17457.16 1981,-17445.74"/>
<polygon fill="black" stroke="black" points="1984.5,-17445.73 1981,-17435.73 1977.5,-17445.73 1984.5,-17445.73"/>
</g>
<!-- moe_43_res1 -->
<g id="node932" class="node">
<title>moe_43_res1</title>
<polygon fill="lightyellow" stroke="black" points="2317.89,-17347.49 1781.97,-17347.49 1644.11,-17243.49 2180.03,-17243.49 2317.89,-17347.49"/>
<text text-anchor="middle" x="1981" y="-17309.49" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1981" y="-17298.49" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1981" y="-17287.49" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1981" y="-17276.49" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_43_mha&#45;&gt;moe_43_res1 -->
<g id="edge1496" class="edge">
<title>moe_43_mha&#45;&gt;moe_43_res1</title>
<path fill="none" stroke="black" d="M1981,-17383.35C1981,-17375.67 1981,-17366.85 1981,-17357.85"/>
<polygon fill="black" stroke="black" points="1984.5,-17357.66 1981,-17347.66 1977.5,-17357.66 1984.5,-17357.66"/>
</g>
<!-- moe_43_gate -->
<g id="node912" class="node">
<title>moe_43_gate</title>
<polygon fill="lightyellow" stroke="black" points="2309.8,-17207.49 1786.75,-17207.49 1652.2,-17103.49 2175.25,-17103.49 2309.8,-17207.49"/>
<text text-anchor="middle" x="1981" y="-17169.49" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1981" y="-17158.49" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1981" y="-17147.49" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1981" y="-17136.49" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_43_route -->
<g id="node913" class="node">
<title>moe_43_route</title>
<ellipse fill="lightblue" stroke="black" cx="1981" cy="-17030.72" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1981" y="-17044.72" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1981" y="-17033.72" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1981" y="-17022.72" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1981" y="-17011.72" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_43_gate&#45;&gt;moe_43_route -->
<g id="edge1498" class="edge">
<title>moe_43_gate&#45;&gt;moe_43_route</title>
<path fill="none" stroke="black" d="M1981,-17103.13C1981,-17094.72 1981,-17086.06 1981,-17077.79"/>
<polygon fill="black" stroke="black" points="1984.5,-17077.57 1981,-17067.57 1977.5,-17077.57 1984.5,-17077.57"/>
</g>
<!-- moe_43_expert_0 -->
<g id="node914" class="node">
<title>moe_43_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-16957.95 16,-16957.95 16,-16905.95 234,-16905.95 234,-16957.95"/>
<text text-anchor="middle" x="125" y="-16945.95" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-16934.95" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-16923.95" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-16912.95" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_43_route&#45;&gt;moe_43_expert_0 -->
<g id="edge1499" class="edge">
<title>moe_43_route&#45;&gt;moe_43_expert_0</title>
<path fill="none" stroke="black" d="M1765.32,-17025.32C1371.64,-17016.57 549.84,-16994.66 244.39,-16958.01"/>
<polygon fill="black" stroke="black" points="244.53,-16954.5 234.18,-16956.75 243.68,-16961.44 244.53,-16954.5"/>
</g>
<!-- moe_43_expert_1 -->
<g id="node915" class="node">
<title>moe_43_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-16957.95 252,-16957.95 252,-16905.95 470,-16905.95 470,-16957.95"/>
<text text-anchor="middle" x="361" y="-16945.95" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-16934.95" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-16923.95" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-16912.95" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_43_route&#45;&gt;moe_43_expert_1 -->
<g id="edge1500" class="edge">
<title>moe_43_route&#45;&gt;moe_43_expert_1</title>
<path fill="none" stroke="black" d="M1763.02,-17030.27C1472.06,-17028.53 940.93,-17016.68 480.37,-16958.03"/>
<polygon fill="black" stroke="black" points="480.55,-16954.53 470.18,-16956.73 479.66,-16961.47 480.55,-16954.53"/>
</g>
<!-- moe_43_expert_2 -->
<g id="node916" class="node">
<title>moe_43_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-16957.95 488,-16957.95 488,-16905.95 706,-16905.95 706,-16957.95"/>
<text text-anchor="middle" x="597" y="-16945.95" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-16934.95" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-16923.95" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-16912.95" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_43_route&#45;&gt;moe_43_expert_2 -->
<g id="edge1501" class="edge">
<title>moe_43_route&#45;&gt;moe_43_expert_2</title>
<path fill="none" stroke="black" d="M1763.88,-17027.43C1513.26,-17022.5 1088.8,-17007.09 716.36,-16958.04"/>
<polygon fill="black" stroke="black" points="716.56,-16954.54 706.19,-16956.69 715.64,-16961.48 716.56,-16954.54"/>
</g>
<!-- moe_43_expert_3 -->
<g id="node917" class="node">
<title>moe_43_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-16957.95 724,-16957.95 724,-16905.95 942,-16905.95 942,-16957.95"/>
<text text-anchor="middle" x="833" y="-16945.95" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-16934.95" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-16923.95" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-16912.95" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_43_route&#45;&gt;moe_43_expert_3 -->
<g id="edge1502" class="edge">
<title>moe_43_route&#45;&gt;moe_43_expert_3</title>
<path fill="none" stroke="black" d="M1767.05,-17023.49C1560.54,-17015.46 1239.12,-16997.66 952.38,-16958.06"/>
<polygon fill="black" stroke="black" points="952.58,-16954.55 942.2,-16956.64 951.62,-16961.49 952.58,-16954.55"/>
</g>
<!-- moe_43_expert_4 -->
<g id="node918" class="node">
<title>moe_43_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-16957.95 960,-16957.95 960,-16905.95 1178,-16905.95 1178,-16957.95"/>
<text text-anchor="middle" x="1069" y="-16945.95" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-16934.95" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-16923.95" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-16912.95" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_43_route&#45;&gt;moe_43_expert_4 -->
<g id="edge1503" class="edge">
<title>moe_43_route&#45;&gt;moe_43_expert_4</title>
<path fill="none" stroke="black" d="M1776.63,-17017.93C1618.39,-17007.23 1393.69,-16988.57 1188.28,-16958.07"/>
<polygon fill="black" stroke="black" points="1188.62,-16954.58 1178.21,-16956.56 1187.58,-16961.5 1188.62,-16954.58"/>
</g>
<!-- moe_43_expert_5 -->
<g id="node919" class="node">
<title>moe_43_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-16957.95 1196,-16957.95 1196,-16905.95 1414,-16905.95 1414,-16957.95"/>
<text text-anchor="middle" x="1305" y="-16945.95" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-16934.95" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-16923.95" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-16912.95" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_43_route&#45;&gt;moe_43_expert_5 -->
<g id="edge1504" class="edge">
<title>moe_43_route&#45;&gt;moe_43_expert_5</title>
<path fill="none" stroke="black" d="M1800.14,-17010.21C1693.44,-16997.79 1555.62,-16980.18 1424.47,-16958.15"/>
<polygon fill="black" stroke="black" points="1424.68,-16954.63 1414.23,-16956.41 1423.51,-16961.53 1424.68,-16954.63"/>
</g>
<!-- moe_43_expert_6 -->
<g id="node920" class="node">
<title>moe_43_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-16957.95 1432,-16957.95 1432,-16905.95 1650,-16905.95 1650,-16957.95"/>
<text text-anchor="middle" x="1541" y="-16945.95" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-16934.95" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-16923.95" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-16912.95" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_43_route&#45;&gt;moe_43_expert_6 -->
<g id="edge1505" class="edge">
<title>moe_43_route&#45;&gt;moe_43_expert_6</title>
<path fill="none" stroke="black" d="M1851.07,-17001.14C1790.69,-16987.86 1719.38,-16972.18 1660.37,-16959.2"/>
<polygon fill="black" stroke="black" points="1660.77,-16955.71 1650.26,-16956.98 1659.27,-16962.54 1660.77,-16955.71"/>
</g>
<!-- moe_43_expert_7 -->
<g id="node921" class="node">
<title>moe_43_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-16957.95 1668,-16957.95 1668,-16905.95 1886,-16905.95 1886,-16957.95"/>
<text text-anchor="middle" x="1777" y="-16945.95" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-16934.95" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-16923.95" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-16912.95" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_43_route&#45;&gt;moe_43_expert_7 -->
<g id="edge1506" class="edge">
<title>moe_43_route&#45;&gt;moe_43_expert_7</title>
<path fill="none" stroke="black" d="M1909.65,-16995.87C1886.73,-16985 1861.53,-16973.04 1839.31,-16962.5"/>
<polygon fill="black" stroke="black" points="1840.52,-16959.2 1829.98,-16958.08 1837.52,-16965.53 1840.52,-16959.2"/>
</g>
<!-- moe_43_expert_8 -->
<g id="node922" class="node">
<title>moe_43_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-16957.95 1904,-16957.95 1904,-16905.95 2122,-16905.95 2122,-16957.95"/>
<text text-anchor="middle" x="2013" y="-16945.95" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-16934.95" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-16923.95" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-16912.95" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_43_route&#45;&gt;moe_43_expert_8 -->
<g id="edge1507" class="edge">
<title>moe_43_route&#45;&gt;moe_43_expert_8</title>
<path fill="none" stroke="black" d="M1992.82,-16993.96C1995.67,-16985.37 1998.7,-16976.21 2001.52,-16967.66"/>
<polygon fill="black" stroke="black" points="2004.9,-16968.58 2004.72,-16957.99 1998.26,-16966.39 2004.9,-16968.58"/>
</g>
<!-- moe_43_expert_9 -->
<g id="node923" class="node">
<title>moe_43_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-16957.95 2140,-16957.95 2140,-16905.95 2358,-16905.95 2358,-16957.95"/>
<text text-anchor="middle" x="2249" y="-16945.95" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-16934.95" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-16923.95" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-16912.95" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_43_route&#45;&gt;moe_43_expert_9 -->
<g id="edge1508" class="edge">
<title>moe_43_route&#45;&gt;moe_43_expert_9</title>
<path fill="none" stroke="black" d="M2070.99,-16997.22C2103.09,-16985.63 2139,-16972.67 2170.1,-16961.44"/>
<polygon fill="black" stroke="black" points="2171.38,-16964.7 2179.59,-16958.01 2169,-16958.11 2171.38,-16964.7"/>
</g>
<!-- moe_43_expert_10 -->
<g id="node924" class="node">
<title>moe_43_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-16957.95 2376,-16957.95 2376,-16905.95 2594,-16905.95 2594,-16957.95"/>
<text text-anchor="middle" x="2485" y="-16945.95" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-16934.95" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-16923.95" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-16912.95" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_43_route&#45;&gt;moe_43_expert_10 -->
<g id="edge1509" class="edge">
<title>moe_43_route&#45;&gt;moe_43_expert_10</title>
<path fill="none" stroke="black" d="M2127.34,-17003.4C2196.81,-16990.68 2281.24,-16974.92 2365.7,-16958.19"/>
<polygon fill="black" stroke="black" points="2366.6,-16961.58 2375.73,-16956.2 2365.24,-16954.71 2366.6,-16961.58"/>
</g>
<!-- moe_43_expert_11 -->
<g id="node925" class="node">
<title>moe_43_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-16957.95 2612,-16957.95 2612,-16905.95 2830,-16905.95 2830,-16957.95"/>
<text text-anchor="middle" x="2721" y="-16945.95" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-16934.95" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-16923.95" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-16912.95" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_43_route&#45;&gt;moe_43_expert_11 -->
<g id="edge1510" class="edge">
<title>moe_43_route&#45;&gt;moe_43_expert_11</title>
<path fill="none" stroke="black" d="M2170.48,-17012.52C2291.38,-17000.42 2451.52,-16982.32 2601.89,-16958.07"/>
<polygon fill="black" stroke="black" points="2602.47,-16961.52 2611.78,-16956.46 2601.35,-16954.61 2602.47,-16961.52"/>
</g>
<!-- moe_43_expert_12 -->
<g id="node926" class="node">
<title>moe_43_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-16957.95 2848,-16957.95 2848,-16905.95 3066,-16905.95 3066,-16957.95"/>
<text text-anchor="middle" x="2957" y="-16945.95" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-16934.95" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-16923.95" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-16912.95" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_43_route&#45;&gt;moe_43_expert_12 -->
<g id="edge1511" class="edge">
<title>moe_43_route&#45;&gt;moe_43_expert_12</title>
<path fill="none" stroke="black" d="M2189.01,-17019.63C2360.74,-17009.58 2610.83,-16990.98 2837.69,-16958.06"/>
<polygon fill="black" stroke="black" points="2838.41,-16961.5 2847.8,-16956.59 2837.39,-16954.57 2838.41,-16961.5"/>
</g>
<!-- moe_43_expert_13 -->
<g id="node927" class="node">
<title>moe_43_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-16957.95 3084,-16957.95 3084,-16905.95 3302,-16905.95 3302,-16957.95"/>
<text text-anchor="middle" x="3193" y="-16945.95" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-16934.95" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-16923.95" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-16912.95" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_43_route&#45;&gt;moe_43_expert_13 -->
<g id="edge1512" class="edge">
<title>moe_43_route&#45;&gt;moe_43_expert_13</title>
<path fill="none" stroke="black" d="M2196,-17024.7C2414.89,-17017.49 2763.95,-17000.2 3073.73,-16958.04"/>
<polygon fill="black" stroke="black" points="3074.37,-16961.48 3083.81,-16956.66 3073.42,-16954.55 3074.37,-16961.48"/>
</g>
<!-- moe_43_expert_14 -->
<g id="node928" class="node">
<title>moe_43_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-16957.95 3320,-16957.95 3320,-16905.95 3538,-16905.95 3538,-16957.95"/>
<text text-anchor="middle" x="3429" y="-16945.95" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-16934.95" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-16923.95" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-16912.95" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_43_route&#45;&gt;moe_43_expert_14 -->
<g id="edge1513" class="edge">
<title>moe_43_route&#45;&gt;moe_43_expert_14</title>
<path fill="none" stroke="black" d="M2198.5,-17028.29C2460.46,-17024.22 2913.68,-17009.67 3309.88,-16958.01"/>
<polygon fill="black" stroke="black" points="3310.35,-16961.47 3319.81,-16956.7 3309.44,-16954.53 3310.35,-16961.47"/>
</g>
<!-- moe_43_expert_15 -->
<g id="node929" class="node">
<title>moe_43_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-16957.95 3556,-16957.95 3556,-16905.95 3774,-16905.95 3774,-16957.95"/>
<text text-anchor="middle" x="3665" y="-16945.95" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-16934.95" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-16923.95" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-16912.95" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_43_route&#45;&gt;moe_43_expert_15 -->
<g id="edge1514" class="edge">
<title>moe_43_route&#45;&gt;moe_43_expert_15</title>
<path fill="none" stroke="black" d="M2195.68,-17024.21C2557.19,-17014.22 3273.74,-16991.15 3545.55,-16958.02"/>
<polygon fill="black" stroke="black" points="3546.33,-16961.45 3555.82,-16956.73 3545.46,-16954.5 3546.33,-16961.45"/>
</g>
<!-- moe_43_aggregate -->
<g id="node930" class="node">
<title>moe_43_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1777" cy="-16833.18" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1777" y="-16847.18" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1777" y="-16836.18" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1777" y="-16825.18" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1777" y="-16814.18" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_43_expert_0&#45;&gt;moe_43_aggregate -->
<g id="edge1515" class="edge">
<title>moe_43_expert_0&#45;&gt;moe_43_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-16907.16C237.15,-16906.73 240.09,-16906.32 243,-16905.95 488.12,-16874.46 1182.7,-16850.94 1547.21,-16840.36"/>
<polygon fill="black" stroke="black" points="1547.47,-16843.85 1557.36,-16840.06 1547.27,-16836.86 1547.47,-16843.85"/>
</g>
<!-- moe_43_expert_1&#45;&gt;moe_43_aggregate -->
<g id="edge1516" class="edge">
<title>moe_43_expert_1&#45;&gt;moe_43_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-16907.2C473.15,-16906.75 476.09,-16906.33 479,-16905.95 849.22,-16856.79 1283.16,-16841.2 1543.76,-16836.31"/>
<polygon fill="black" stroke="black" points="1544.17,-16839.81 1554.11,-16836.12 1544.05,-16832.81 1544.17,-16839.81"/>
</g>
<!-- moe_43_expert_2&#45;&gt;moe_43_aggregate -->
<g id="edge1517" class="edge">
<title>moe_43_expert_2&#45;&gt;moe_43_aggregate</title>
<path fill="none" stroke="black" d="M706.2,-16907.25C709.16,-16906.78 712.1,-16906.35 715,-16905.95 1000.02,-16866.33 1331.23,-16848.35 1546.98,-16840.35"/>
<polygon fill="black" stroke="black" points="1547.3,-16843.84 1557.17,-16839.98 1547.05,-16836.84 1547.3,-16843.84"/>
</g>
<!-- moe_43_expert_3&#45;&gt;moe_43_aggregate -->
<g id="edge1518" class="edge">
<title>moe_43_expert_3&#45;&gt;moe_43_aggregate</title>
<path fill="none" stroke="black" d="M942.21,-16907.32C945.16,-16906.84 948.1,-16906.38 951,-16905.95 1154.78,-16875.62 1388.89,-16856.77 1555.72,-16846.05"/>
<polygon fill="black" stroke="black" points="1556.35,-16849.51 1566.11,-16845.38 1555.91,-16842.53 1556.35,-16849.51"/>
</g>
<!-- moe_43_expert_4&#45;&gt;moe_43_aggregate -->
<g id="edge1519" class="edge">
<title>moe_43_expert_4&#45;&gt;moe_43_aggregate</title>
<path fill="none" stroke="black" d="M1178.23,-16907.45C1181.18,-16906.93 1184.11,-16906.43 1187,-16905.95 1316.69,-16884.36 1463.43,-16866.49 1578.13,-16853.97"/>
<polygon fill="black" stroke="black" points="1578.51,-16857.45 1588.07,-16852.89 1577.75,-16850.49 1578.51,-16857.45"/>
</g>
<!-- moe_43_expert_5&#45;&gt;moe_43_aggregate -->
<g id="edge1520" class="edge">
<title>moe_43_expert_5&#45;&gt;moe_43_aggregate</title>
<path fill="none" stroke="black" d="M1414.28,-16907.76C1417.22,-16907.15 1420.13,-16906.54 1423,-16905.95 1490.32,-16891.99 1564.9,-16876.83 1628.19,-16864.05"/>
<polygon fill="black" stroke="black" points="1629.13,-16867.43 1638.24,-16862.02 1627.75,-16860.56 1629.13,-16867.43"/>
</g>
<!-- moe_43_expert_6&#45;&gt;moe_43_aggregate -->
<g id="edge1521" class="edge">
<title>moe_43_expert_6&#45;&gt;moe_43_aggregate</title>
<path fill="none" stroke="black" d="M1602.08,-16905.9C1627.73,-16895.39 1658.09,-16882.94 1686.26,-16871.39"/>
<polygon fill="black" stroke="black" points="1687.79,-16874.54 1695.72,-16867.51 1685.14,-16868.06 1687.79,-16874.54"/>
</g>
<!-- moe_43_expert_7&#45;&gt;moe_43_aggregate -->
<g id="edge1522" class="edge">
<title>moe_43_expert_7&#45;&gt;moe_43_aggregate</title>
<path fill="none" stroke="black" d="M1777,-16905.77C1777,-16897.97 1777,-16889.1 1777,-16880.33"/>
<polygon fill="black" stroke="black" points="1780.5,-16880.15 1777,-16870.15 1773.5,-16880.15 1780.5,-16880.15"/>
</g>
<!-- moe_43_expert_8&#45;&gt;moe_43_aggregate -->
<g id="edge1523" class="edge">
<title>moe_43_expert_8&#45;&gt;moe_43_aggregate</title>
<path fill="none" stroke="black" d="M1951.92,-16905.9C1926.27,-16895.39 1895.91,-16882.94 1867.74,-16871.39"/>
<polygon fill="black" stroke="black" points="1868.86,-16868.06 1858.28,-16867.51 1866.21,-16874.54 1868.86,-16868.06"/>
</g>
<!-- moe_43_expert_9&#45;&gt;moe_43_aggregate -->
<g id="edge1524" class="edge">
<title>moe_43_expert_9&#45;&gt;moe_43_aggregate</title>
<path fill="none" stroke="black" d="M2139.72,-16907.76C2136.78,-16907.15 2133.87,-16906.54 2131,-16905.95 2063.68,-16891.99 1989.1,-16876.83 1925.81,-16864.05"/>
<polygon fill="black" stroke="black" points="1926.25,-16860.56 1915.76,-16862.02 1924.87,-16867.43 1926.25,-16860.56"/>
</g>
<!-- moe_43_expert_10&#45;&gt;moe_43_aggregate -->
<g id="edge1525" class="edge">
<title>moe_43_expert_10&#45;&gt;moe_43_aggregate</title>
<path fill="none" stroke="black" d="M2375.77,-16907.45C2372.82,-16906.93 2369.89,-16906.43 2367,-16905.95 2237.31,-16884.36 2090.57,-16866.49 1975.87,-16853.97"/>
<polygon fill="black" stroke="black" points="1976.25,-16850.49 1965.93,-16852.89 1975.49,-16857.45 1976.25,-16850.49"/>
</g>
<!-- moe_43_expert_11&#45;&gt;moe_43_aggregate -->
<g id="edge1526" class="edge">
<title>moe_43_expert_11&#45;&gt;moe_43_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-16907.32C2608.84,-16906.84 2605.9,-16906.38 2603,-16905.95 2399.22,-16875.62 2165.11,-16856.77 1998.28,-16846.05"/>
<polygon fill="black" stroke="black" points="1998.09,-16842.53 1987.89,-16845.38 1997.65,-16849.51 1998.09,-16842.53"/>
</g>
<!-- moe_43_expert_12&#45;&gt;moe_43_aggregate -->
<g id="edge1527" class="edge">
<title>moe_43_expert_12&#45;&gt;moe_43_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-16907.25C2844.84,-16906.78 2841.9,-16906.35 2839,-16905.95 2553.98,-16866.33 2222.77,-16848.35 2007.02,-16840.35"/>
<polygon fill="black" stroke="black" points="2006.95,-16836.84 1996.83,-16839.98 2006.7,-16843.84 2006.95,-16836.84"/>
</g>
<!-- moe_43_expert_13&#45;&gt;moe_43_aggregate -->
<g id="edge1528" class="edge">
<title>moe_43_expert_13&#45;&gt;moe_43_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-16907.2C3080.85,-16906.75 3077.91,-16906.33 3075,-16905.95 2704.78,-16856.79 2270.84,-16841.2 2010.24,-16836.31"/>
<polygon fill="black" stroke="black" points="2009.95,-16832.81 1999.89,-16836.12 2009.83,-16839.81 2009.95,-16832.81"/>
</g>
<!-- moe_43_expert_14&#45;&gt;moe_43_aggregate -->
<g id="edge1529" class="edge">
<title>moe_43_expert_14&#45;&gt;moe_43_aggregate</title>
<path fill="none" stroke="black" d="M3319.82,-16907.16C3316.85,-16906.73 3313.91,-16906.32 3311,-16905.95 3065.88,-16874.46 2371.3,-16850.94 2006.79,-16840.36"/>
<polygon fill="black" stroke="black" points="2006.73,-16836.86 1996.64,-16840.06 2006.53,-16843.85 2006.73,-16836.86"/>
</g>
<!-- moe_43_expert_15&#45;&gt;moe_43_aggregate -->
<g id="edge1530" class="edge">
<title>moe_43_expert_15&#45;&gt;moe_43_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-16907.14C3552.85,-16906.71 3549.91,-16906.31 3547,-16905.95 3256.39,-16869.53 2418.41,-16847.58 2008.44,-16838.72"/>
<polygon fill="black" stroke="black" points="2008.31,-16835.22 1998.24,-16838.5 2008.16,-16842.21 2008.31,-16835.22"/>
</g>
<!-- moe_43_ffn -->
<g id="node931" class="node">
<title>moe_43_ffn</title>
<polygon fill="lightgreen" stroke="black" points="1935,-16760.41 1619,-16760.41 1619,-16708.41 1935,-16708.41 1935,-16760.41"/>
<text text-anchor="middle" x="1777" y="-16748.41" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1777" y="-16737.41" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-16726.41" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-16715.41" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_43_aggregate&#45;&gt;moe_43_ffn -->
<g id="edge1531" class="edge">
<title>moe_43_aggregate&#45;&gt;moe_43_ffn</title>
<path fill="none" stroke="black" d="M1777,-16796.14C1777,-16787.83 1777,-16779 1777,-16770.72"/>
<polygon fill="black" stroke="black" points="1780.5,-16770.6 1777,-16760.6 1773.5,-16770.6 1780.5,-16770.6"/>
</g>
<!-- moe_43_res2 -->
<g id="node933" class="node">
<title>moe_43_res2</title>
<polygon fill="lightyellow" stroke="black" points="2113.89,-16672.41 1577.97,-16672.41 1440.11,-16568.41 1976.03,-16568.41 2113.89,-16672.41"/>
<text text-anchor="middle" x="1777" y="-16634.41" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1777" y="-16623.41" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-16612.41" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1777" y="-16601.41" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_43_ffn&#45;&gt;moe_43_res2 -->
<g id="edge1532" class="edge">
<title>moe_43_ffn&#45;&gt;moe_43_res2</title>
<path fill="none" stroke="black" d="M1777,-16708.27C1777,-16700.59 1777,-16691.78 1777,-16682.78"/>
<polygon fill="black" stroke="black" points="1780.5,-16682.59 1777,-16672.59 1773.5,-16682.59 1780.5,-16682.59"/>
</g>
<!-- moe_43_res1&#45;&gt;moe_43_gate -->
<g id="edge1497" class="edge">
<title>moe_43_res1&#45;&gt;moe_43_gate</title>
<path fill="none" stroke="black" d="M1981,-17243.1C1981,-17234.93 1981,-17226.4 1981,-17218.03"/>
<polygon fill="black" stroke="black" points="1984.5,-17217.91 1981,-17207.92 1977.5,-17217.92 1984.5,-17217.91"/>
</g>
<!-- moe_44_mha -->
<g id="node934" class="node">
<title>moe_44_mha</title>
<polygon fill="lightgreen" stroke="black" points="1935,-16521.41 1619,-16521.41 1619,-16469.41 1935,-16469.41 1935,-16521.41"/>
<text text-anchor="middle" x="1777" y="-16509.41" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1777" y="-16498.41" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-16487.41" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-16476.41" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_43_res2&#45;&gt;moe_44_mha -->
<g id="edge1533" class="edge">
<title>moe_43_res2&#45;&gt;moe_44_mha</title>
<path fill="none" stroke="black" d="M1777,-16568.31C1777,-16555.98 1777,-16543.08 1777,-16531.66"/>
<polygon fill="black" stroke="black" points="1780.5,-16531.65 1777,-16521.65 1773.5,-16531.65 1780.5,-16531.65"/>
</g>
<!-- moe_44_res1 -->
<g id="node955" class="node">
<title>moe_44_res1</title>
<polygon fill="lightyellow" stroke="black" points="2113.89,-16433.41 1577.97,-16433.41 1440.11,-16329.41 1976.03,-16329.41 2113.89,-16433.41"/>
<text text-anchor="middle" x="1777" y="-16395.41" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1777" y="-16384.41" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-16373.41" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1777" y="-16362.41" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_44_mha&#45;&gt;moe_44_res1 -->
<g id="edge1534" class="edge">
<title>moe_44_mha&#45;&gt;moe_44_res1</title>
<path fill="none" stroke="black" d="M1777,-16469.27C1777,-16461.59 1777,-16452.78 1777,-16443.78"/>
<polygon fill="black" stroke="black" points="1780.5,-16443.59 1777,-16433.59 1773.5,-16443.59 1780.5,-16443.59"/>
</g>
<!-- moe_44_gate -->
<g id="node935" class="node">
<title>moe_44_gate</title>
<polygon fill="lightyellow" stroke="black" points="2105.8,-16293.41 1582.75,-16293.41 1448.2,-16189.41 1971.25,-16189.41 2105.8,-16293.41"/>
<text text-anchor="middle" x="1777" y="-16255.41" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1777" y="-16244.41" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-16233.41" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-16222.41" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_44_route -->
<g id="node936" class="node">
<title>moe_44_route</title>
<ellipse fill="lightblue" stroke="black" cx="1777" cy="-16116.64" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1777" y="-16130.64" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1777" y="-16119.64" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1777" y="-16108.64" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-16097.64" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_44_gate&#45;&gt;moe_44_route -->
<g id="edge1536" class="edge">
<title>moe_44_gate&#45;&gt;moe_44_route</title>
<path fill="none" stroke="black" d="M1777,-16189.05C1777,-16180.65 1777,-16171.98 1777,-16163.71"/>
<polygon fill="black" stroke="black" points="1780.5,-16163.49 1777,-16153.49 1773.5,-16163.49 1780.5,-16163.49"/>
</g>
<!-- moe_44_expert_0 -->
<g id="node937" class="node">
<title>moe_44_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-16043.87 16,-16043.87 16,-15991.87 234,-15991.87 234,-16043.87"/>
<text text-anchor="middle" x="125" y="-16031.87" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-16020.87" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-16009.87" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-15998.87" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_44_route&#45;&gt;moe_44_expert_0 -->
<g id="edge1537" class="edge">
<title>moe_44_route&#45;&gt;moe_44_expert_0</title>
<path fill="none" stroke="black" d="M1562.77,-16109.91C1207.39,-16099.69 509.65,-16076.41 244.21,-16043.91"/>
<polygon fill="black" stroke="black" points="244.54,-16040.42 234.18,-16042.65 243.67,-16047.37 244.54,-16040.42"/>
</g>
<!-- moe_44_expert_1 -->
<g id="node938" class="node">
<title>moe_44_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-16043.87 252,-16043.87 252,-15991.87 470,-15991.87 470,-16043.87"/>
<text text-anchor="middle" x="361" y="-16031.87" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-16020.87" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-16009.87" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-15998.87" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_44_route&#45;&gt;moe_44_expert_1 -->
<g id="edge1538" class="edge">
<title>moe_44_route&#45;&gt;moe_44_expert_1</title>
<path fill="none" stroke="black" d="M1559.59,-16113.79C1303.22,-16109.29 864.4,-16094.29 480.11,-16043.93"/>
<polygon fill="black" stroke="black" points="480.56,-16040.46 470.19,-16042.62 479.64,-16047.4 480.56,-16040.46"/>
</g>
<!-- moe_44_expert_2 -->
<g id="node939" class="node">
<title>moe_44_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-16043.87 488,-16043.87 488,-15991.87 706,-15991.87 706,-16043.87"/>
<text text-anchor="middle" x="597" y="-16031.87" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-16020.87" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-16009.87" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-15998.87" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_44_route&#45;&gt;moe_44_expert_2 -->
<g id="edge1539" class="edge">
<title>moe_44_route&#45;&gt;moe_44_expert_2</title>
<path fill="none" stroke="black" d="M1562.51,-16110.03C1349.77,-16102.41 1014.57,-16084.85 716.34,-16043.97"/>
<polygon fill="black" stroke="black" points="716.58,-16040.47 706.2,-16042.57 715.62,-16047.41 716.58,-16040.47"/>
</g>
<!-- moe_44_expert_3 -->
<g id="node940" class="node">
<title>moe_44_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-16043.87 724,-16043.87 724,-15991.87 942,-15991.87 942,-16043.87"/>
<text text-anchor="middle" x="833" y="-16031.87" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-16020.87" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-16009.87" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-15998.87" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_44_route&#45;&gt;moe_44_expert_3 -->
<g id="edge1540" class="edge">
<title>moe_44_route&#45;&gt;moe_44_expert_3</title>
<path fill="none" stroke="black" d="M1570.82,-16104.73C1405.76,-16094.34 1168.32,-16075.69 952.16,-16043.97"/>
<polygon fill="black" stroke="black" points="952.61,-16040.5 942.21,-16042.5 951.59,-16047.42 952.61,-16040.5"/>
</g>
<!-- moe_44_expert_4 -->
<g id="node941" class="node">
<title>moe_44_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-16043.87 960,-16043.87 960,-15991.87 1178,-15991.87 1178,-16043.87"/>
<text text-anchor="middle" x="1069" y="-16031.87" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-16020.87" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-16009.87" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-15998.87" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_44_route&#45;&gt;moe_44_expert_4 -->
<g id="edge1541" class="edge">
<title>moe_44_route&#45;&gt;moe_44_expert_4</title>
<path fill="none" stroke="black" d="M1591.38,-16097.28C1477.62,-16085.01 1328.9,-16067.15 1188.33,-16044.04"/>
<polygon fill="black" stroke="black" points="1188.66,-16040.54 1178.23,-16042.36 1187.52,-16047.45 1188.66,-16040.54"/>
</g>
<!-- moe_44_expert_5 -->
<g id="node942" class="node">
<title>moe_44_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-16043.87 1196,-16043.87 1196,-15991.87 1414,-15991.87 1414,-16043.87"/>
<text text-anchor="middle" x="1305" y="-16031.87" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-16020.87" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-16009.87" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-15998.87" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_44_route&#45;&gt;moe_44_expert_5 -->
<g id="edge1542" class="edge">
<title>moe_44_route&#45;&gt;moe_44_expert_5</title>
<path fill="none" stroke="black" d="M1639.51,-16088.06C1576.62,-16075.37 1500.88,-16059.99 1424.14,-16044.1"/>
<polygon fill="black" stroke="black" points="1424.79,-16040.66 1414.28,-16042.06 1423.37,-16047.51 1424.79,-16040.66"/>
</g>
<!-- moe_44_expert_6 -->
<g id="node943" class="node">
<title>moe_44_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-16043.87 1432,-16043.87 1432,-15991.87 1650,-15991.87 1650,-16043.87"/>
<text text-anchor="middle" x="1541" y="-16031.87" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-16020.87" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-16009.87" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-15998.87" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_44_route&#45;&gt;moe_44_expert_6 -->
<g id="edge1543" class="edge">
<title>moe_44_route&#45;&gt;moe_44_expert_6</title>
<path fill="none" stroke="black" d="M1696.11,-16082.47C1668.54,-16071.17 1637.96,-16058.63 1611.29,-16047.69"/>
<polygon fill="black" stroke="black" points="1612.61,-16044.45 1602.03,-16043.89 1609.95,-16050.92 1612.61,-16044.45"/>
</g>
<!-- moe_44_expert_7 -->
<g id="node944" class="node">
<title>moe_44_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-16043.87 1668,-16043.87 1668,-15991.87 1886,-15991.87 1886,-16043.87"/>
<text text-anchor="middle" x="1777" y="-16031.87" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-16020.87" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-16009.87" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-15998.87" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_44_route&#45;&gt;moe_44_expert_7 -->
<g id="edge1544" class="edge">
<title>moe_44_route&#45;&gt;moe_44_expert_7</title>
<path fill="none" stroke="black" d="M1777,-16079.6C1777,-16071.29 1777,-16062.46 1777,-16054.18"/>
<polygon fill="black" stroke="black" points="1780.5,-16054.06 1777,-16044.06 1773.5,-16054.06 1780.5,-16054.06"/>
</g>
<!-- moe_44_expert_8 -->
<g id="node945" class="node">
<title>moe_44_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-16043.87 1904,-16043.87 1904,-15991.87 2122,-15991.87 2122,-16043.87"/>
<text text-anchor="middle" x="2013" y="-16031.87" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-16020.87" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-16009.87" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-15998.87" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_44_route&#45;&gt;moe_44_expert_8 -->
<g id="edge1545" class="edge">
<title>moe_44_route&#45;&gt;moe_44_expert_8</title>
<path fill="none" stroke="black" d="M1857.89,-16082.47C1885.46,-16071.17 1916.04,-16058.63 1942.71,-16047.69"/>
<polygon fill="black" stroke="black" points="1944.05,-16050.92 1951.97,-16043.89 1941.39,-16044.45 1944.05,-16050.92"/>
</g>
<!-- moe_44_expert_9 -->
<g id="node946" class="node">
<title>moe_44_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-16043.87 2140,-16043.87 2140,-15991.87 2358,-15991.87 2358,-16043.87"/>
<text text-anchor="middle" x="2249" y="-16031.87" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-16020.87" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-16009.87" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-15998.87" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_44_route&#45;&gt;moe_44_expert_9 -->
<g id="edge1546" class="edge">
<title>moe_44_route&#45;&gt;moe_44_expert_9</title>
<path fill="none" stroke="black" d="M1914.49,-16088.06C1977.38,-16075.37 2053.12,-16059.99 2129.86,-16044.1"/>
<polygon fill="black" stroke="black" points="2130.63,-16047.51 2139.72,-16042.06 2129.21,-16040.66 2130.63,-16047.51"/>
</g>
<!-- moe_44_expert_10 -->
<g id="node947" class="node">
<title>moe_44_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-16043.87 2376,-16043.87 2376,-15991.87 2594,-15991.87 2594,-16043.87"/>
<text text-anchor="middle" x="2485" y="-16031.87" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-16020.87" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-16009.87" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-15998.87" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_44_route&#45;&gt;moe_44_expert_10 -->
<g id="edge1547" class="edge">
<title>moe_44_route&#45;&gt;moe_44_expert_10</title>
<path fill="none" stroke="black" d="M1962.62,-16097.28C2076.38,-16085.01 2225.1,-16067.15 2365.67,-16044.04"/>
<polygon fill="black" stroke="black" points="2366.48,-16047.45 2375.77,-16042.36 2365.34,-16040.54 2366.48,-16047.45"/>
</g>
<!-- moe_44_expert_11 -->
<g id="node948" class="node">
<title>moe_44_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-16043.87 2612,-16043.87 2612,-15991.87 2830,-15991.87 2830,-16043.87"/>
<text text-anchor="middle" x="2721" y="-16031.87" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-16020.87" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-16009.87" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-15998.87" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_44_route&#45;&gt;moe_44_expert_11 -->
<g id="edge1548" class="edge">
<title>moe_44_route&#45;&gt;moe_44_expert_11</title>
<path fill="none" stroke="black" d="M1983.18,-16104.73C2148.24,-16094.34 2385.68,-16075.69 2601.84,-16043.97"/>
<polygon fill="black" stroke="black" points="2602.41,-16047.42 2611.79,-16042.5 2601.39,-16040.5 2602.41,-16047.42"/>
</g>
<!-- moe_44_expert_12 -->
<g id="node949" class="node">
<title>moe_44_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-16043.87 2848,-16043.87 2848,-15991.87 3066,-15991.87 3066,-16043.87"/>
<text text-anchor="middle" x="2957" y="-16031.87" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-16020.87" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-16009.87" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-15998.87" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_44_route&#45;&gt;moe_44_expert_12 -->
<g id="edge1549" class="edge">
<title>moe_44_route&#45;&gt;moe_44_expert_12</title>
<path fill="none" stroke="black" d="M1991.49,-16110.03C2204.23,-16102.41 2539.43,-16084.85 2837.66,-16043.97"/>
<polygon fill="black" stroke="black" points="2838.38,-16047.41 2847.8,-16042.57 2837.42,-16040.47 2838.38,-16047.41"/>
</g>
<!-- moe_44_expert_13 -->
<g id="node950" class="node">
<title>moe_44_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-16043.87 3084,-16043.87 3084,-15991.87 3302,-15991.87 3302,-16043.87"/>
<text text-anchor="middle" x="3193" y="-16031.87" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-16020.87" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-16009.87" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-15998.87" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_44_route&#45;&gt;moe_44_expert_13 -->
<g id="edge1550" class="edge">
<title>moe_44_route&#45;&gt;moe_44_expert_13</title>
<path fill="none" stroke="black" d="M1994.41,-16113.79C2250.78,-16109.29 2689.6,-16094.29 3073.89,-16043.93"/>
<polygon fill="black" stroke="black" points="3074.36,-16047.4 3083.81,-16042.62 3073.44,-16040.46 3074.36,-16047.4"/>
</g>
<!-- moe_44_expert_14 -->
<g id="node951" class="node">
<title>moe_44_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-16043.87 3320,-16043.87 3320,-15991.87 3538,-15991.87 3538,-16043.87"/>
<text text-anchor="middle" x="3429" y="-16031.87" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-16020.87" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-16009.87" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-15998.87" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_44_route&#45;&gt;moe_44_expert_14 -->
<g id="edge1551" class="edge">
<title>moe_44_route&#45;&gt;moe_44_expert_14</title>
<path fill="none" stroke="black" d="M1991.23,-16109.91C2346.61,-16099.69 3044.35,-16076.41 3309.79,-16043.91"/>
<polygon fill="black" stroke="black" points="3310.33,-16047.37 3319.82,-16042.65 3309.46,-16040.42 3310.33,-16047.37"/>
</g>
<!-- moe_44_expert_15 -->
<g id="node952" class="node">
<title>moe_44_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-16043.87 3556,-16043.87 3556,-15991.87 3774,-15991.87 3774,-16043.87"/>
<text text-anchor="middle" x="3665" y="-16031.87" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-16020.87" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-16009.87" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-15998.87" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_44_route&#45;&gt;moe_44_expert_15 -->
<g id="edge1552" class="edge">
<title>moe_44_route&#45;&gt;moe_44_expert_15</title>
<path fill="none" stroke="black" d="M1992.71,-16111.43C2392.25,-16102.9 3234.28,-16081.23 3545.86,-16043.9"/>
<polygon fill="black" stroke="black" points="3546.32,-16047.37 3555.82,-16042.68 3545.47,-16040.42 3546.32,-16047.37"/>
</g>
<!-- moe_44_aggregate -->
<g id="node953" class="node">
<title>moe_44_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1777" cy="-15919.1" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1777" y="-15933.1" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1777" y="-15922.1" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1777" y="-15911.1" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1777" y="-15900.1" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_44_expert_0&#45;&gt;moe_44_aggregate -->
<g id="edge1553" class="edge">
<title>moe_44_expert_0&#45;&gt;moe_44_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-15993.09C237.15,-15992.65 240.09,-15992.24 243,-15991.87 488.12,-15960.38 1182.7,-15936.86 1547.21,-15926.28"/>
<polygon fill="black" stroke="black" points="1547.47,-15929.77 1557.36,-15925.99 1547.27,-15922.78 1547.47,-15929.77"/>
</g>
<!-- moe_44_expert_1&#45;&gt;moe_44_aggregate -->
<g id="edge1554" class="edge">
<title>moe_44_expert_1&#45;&gt;moe_44_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-15993.12C473.15,-15992.67 476.09,-15992.25 479,-15991.87 849.22,-15942.71 1283.16,-15927.12 1543.76,-15922.23"/>
<polygon fill="black" stroke="black" points="1544.17,-15925.73 1554.11,-15922.04 1544.05,-15918.73 1544.17,-15925.73"/>
</g>
<!-- moe_44_expert_2&#45;&gt;moe_44_aggregate -->
<g id="edge1555" class="edge">
<title>moe_44_expert_2&#45;&gt;moe_44_aggregate</title>
<path fill="none" stroke="black" d="M706.2,-15993.17C709.16,-15992.71 712.1,-15992.27 715,-15991.87 1000.02,-15952.25 1331.23,-15934.27 1546.98,-15926.27"/>
<polygon fill="black" stroke="black" points="1547.3,-15929.76 1557.17,-15925.9 1547.05,-15922.77 1547.3,-15929.76"/>
</g>
<!-- moe_44_expert_3&#45;&gt;moe_44_aggregate -->
<g id="edge1556" class="edge">
<title>moe_44_expert_3&#45;&gt;moe_44_aggregate</title>
<path fill="none" stroke="black" d="M942.21,-15993.24C945.16,-15992.76 948.1,-15992.3 951,-15991.87 1154.78,-15961.54 1388.89,-15942.69 1555.72,-15931.97"/>
<polygon fill="black" stroke="black" points="1556.35,-15935.43 1566.11,-15931.3 1555.91,-15928.45 1556.35,-15935.43"/>
</g>
<!-- moe_44_expert_4&#45;&gt;moe_44_aggregate -->
<g id="edge1557" class="edge">
<title>moe_44_expert_4&#45;&gt;moe_44_aggregate</title>
<path fill="none" stroke="black" d="M1178.23,-15993.38C1181.18,-15992.85 1184.11,-15992.35 1187,-15991.87 1316.69,-15970.29 1463.43,-15952.41 1578.13,-15939.89"/>
<polygon fill="black" stroke="black" points="1578.51,-15943.37 1588.07,-15938.81 1577.75,-15936.42 1578.51,-15943.37"/>
</g>
<!-- moe_44_expert_5&#45;&gt;moe_44_aggregate -->
<g id="edge1558" class="edge">
<title>moe_44_expert_5&#45;&gt;moe_44_aggregate</title>
<path fill="none" stroke="black" d="M1414.28,-15993.68C1417.22,-15993.07 1420.13,-15992.46 1423,-15991.87 1490.32,-15977.91 1564.9,-15962.75 1628.19,-15949.97"/>
<polygon fill="black" stroke="black" points="1629.13,-15953.35 1638.24,-15947.94 1627.75,-15946.49 1629.13,-15953.35"/>
</g>
<!-- moe_44_expert_6&#45;&gt;moe_44_aggregate -->
<g id="edge1559" class="edge">
<title>moe_44_expert_6&#45;&gt;moe_44_aggregate</title>
<path fill="none" stroke="black" d="M1602.08,-15991.82C1627.73,-15981.31 1658.09,-15968.86 1686.26,-15957.31"/>
<polygon fill="black" stroke="black" points="1687.79,-15960.46 1695.72,-15953.43 1685.14,-15953.98 1687.79,-15960.46"/>
</g>
<!-- moe_44_expert_7&#45;&gt;moe_44_aggregate -->
<g id="edge1560" class="edge">
<title>moe_44_expert_7&#45;&gt;moe_44_aggregate</title>
<path fill="none" stroke="black" d="M1777,-15991.7C1777,-15983.89 1777,-15975.02 1777,-15966.25"/>
<polygon fill="black" stroke="black" points="1780.5,-15966.08 1777,-15956.08 1773.5,-15966.08 1780.5,-15966.08"/>
</g>
<!-- moe_44_expert_8&#45;&gt;moe_44_aggregate -->
<g id="edge1561" class="edge">
<title>moe_44_expert_8&#45;&gt;moe_44_aggregate</title>
<path fill="none" stroke="black" d="M1951.92,-15991.82C1926.27,-15981.31 1895.91,-15968.86 1867.74,-15957.31"/>
<polygon fill="black" stroke="black" points="1868.86,-15953.98 1858.28,-15953.43 1866.21,-15960.46 1868.86,-15953.98"/>
</g>
<!-- moe_44_expert_9&#45;&gt;moe_44_aggregate -->
<g id="edge1562" class="edge">
<title>moe_44_expert_9&#45;&gt;moe_44_aggregate</title>
<path fill="none" stroke="black" d="M2139.72,-15993.68C2136.78,-15993.07 2133.87,-15992.46 2131,-15991.87 2063.68,-15977.91 1989.1,-15962.75 1925.81,-15949.97"/>
<polygon fill="black" stroke="black" points="1926.25,-15946.49 1915.76,-15947.94 1924.87,-15953.35 1926.25,-15946.49"/>
</g>
<!-- moe_44_expert_10&#45;&gt;moe_44_aggregate -->
<g id="edge1563" class="edge">
<title>moe_44_expert_10&#45;&gt;moe_44_aggregate</title>
<path fill="none" stroke="black" d="M2375.77,-15993.38C2372.82,-15992.85 2369.89,-15992.35 2367,-15991.87 2237.31,-15970.29 2090.57,-15952.41 1975.87,-15939.89"/>
<polygon fill="black" stroke="black" points="1976.25,-15936.42 1965.93,-15938.81 1975.49,-15943.37 1976.25,-15936.42"/>
</g>
<!-- moe_44_expert_11&#45;&gt;moe_44_aggregate -->
<g id="edge1564" class="edge">
<title>moe_44_expert_11&#45;&gt;moe_44_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-15993.24C2608.84,-15992.76 2605.9,-15992.3 2603,-15991.87 2399.22,-15961.54 2165.11,-15942.69 1998.28,-15931.97"/>
<polygon fill="black" stroke="black" points="1998.09,-15928.45 1987.89,-15931.3 1997.65,-15935.43 1998.09,-15928.45"/>
</g>
<!-- moe_44_expert_12&#45;&gt;moe_44_aggregate -->
<g id="edge1565" class="edge">
<title>moe_44_expert_12&#45;&gt;moe_44_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-15993.17C2844.84,-15992.71 2841.9,-15992.27 2839,-15991.87 2553.98,-15952.25 2222.77,-15934.27 2007.02,-15926.27"/>
<polygon fill="black" stroke="black" points="2006.95,-15922.77 1996.83,-15925.9 2006.7,-15929.76 2006.95,-15922.77"/>
</g>
<!-- moe_44_expert_13&#45;&gt;moe_44_aggregate -->
<g id="edge1566" class="edge">
<title>moe_44_expert_13&#45;&gt;moe_44_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-15993.12C3080.85,-15992.67 3077.91,-15992.25 3075,-15991.87 2704.78,-15942.71 2270.84,-15927.12 2010.24,-15922.23"/>
<polygon fill="black" stroke="black" points="2009.95,-15918.73 1999.89,-15922.04 2009.83,-15925.73 2009.95,-15918.73"/>
</g>
<!-- moe_44_expert_14&#45;&gt;moe_44_aggregate -->
<g id="edge1567" class="edge">
<title>moe_44_expert_14&#45;&gt;moe_44_aggregate</title>
<path fill="none" stroke="black" d="M3319.82,-15993.09C3316.85,-15992.65 3313.91,-15992.24 3311,-15991.87 3065.88,-15960.38 2371.3,-15936.86 2006.79,-15926.28"/>
<polygon fill="black" stroke="black" points="2006.73,-15922.78 1996.64,-15925.99 2006.53,-15929.77 2006.73,-15922.78"/>
</g>
<!-- moe_44_expert_15&#45;&gt;moe_44_aggregate -->
<g id="edge1568" class="edge">
<title>moe_44_expert_15&#45;&gt;moe_44_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-15993.06C3552.85,-15992.63 3549.91,-15992.23 3547,-15991.87 3256.39,-15955.45 2418.41,-15933.5 2008.44,-15924.64"/>
<polygon fill="black" stroke="black" points="2008.31,-15921.14 1998.24,-15924.42 2008.16,-15928.14 2008.31,-15921.14"/>
</g>
<!-- moe_44_ffn -->
<g id="node954" class="node">
<title>moe_44_ffn</title>
<polygon fill="lightgreen" stroke="black" points="1935,-15846.33 1619,-15846.33 1619,-15794.33 1935,-15794.33 1935,-15846.33"/>
<text text-anchor="middle" x="1777" y="-15834.33" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1777" y="-15823.33" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-15812.33" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-15801.33" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_44_aggregate&#45;&gt;moe_44_ffn -->
<g id="edge1569" class="edge">
<title>moe_44_aggregate&#45;&gt;moe_44_ffn</title>
<path fill="none" stroke="black" d="M1777,-15882.07C1777,-15873.75 1777,-15864.92 1777,-15856.64"/>
<polygon fill="black" stroke="black" points="1780.5,-15856.53 1777,-15846.53 1773.5,-15856.53 1780.5,-15856.53"/>
</g>
<!-- moe_44_res2 -->
<g id="node956" class="node">
<title>moe_44_res2</title>
<polygon fill="lightyellow" stroke="black" points="2113.89,-15758.33 1577.97,-15758.33 1440.11,-15654.33 1976.03,-15654.33 2113.89,-15758.33"/>
<text text-anchor="middle" x="1777" y="-15720.33" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1777" y="-15709.33" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-15698.33" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1777" y="-15687.33" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_44_ffn&#45;&gt;moe_44_res2 -->
<g id="edge1570" class="edge">
<title>moe_44_ffn&#45;&gt;moe_44_res2</title>
<path fill="none" stroke="black" d="M1777,-15794.19C1777,-15786.51 1777,-15777.7 1777,-15768.7"/>
<polygon fill="black" stroke="black" points="1780.5,-15768.51 1777,-15758.51 1773.5,-15768.51 1780.5,-15768.51"/>
</g>
<!-- moe_44_res1&#45;&gt;moe_44_gate -->
<g id="edge1535" class="edge">
<title>moe_44_res1&#45;&gt;moe_44_gate</title>
<path fill="none" stroke="black" d="M1777,-16329.02C1777,-16320.85 1777,-16312.32 1777,-16303.95"/>
<polygon fill="black" stroke="black" points="1780.5,-16303.84 1777,-16293.84 1773.5,-16303.84 1780.5,-16303.84"/>
</g>
<!-- moe_45_mha -->
<g id="node957" class="node">
<title>moe_45_mha</title>
<polygon fill="lightgreen" stroke="black" points="1935,-15607.33 1619,-15607.33 1619,-15555.33 1935,-15555.33 1935,-15607.33"/>
<text text-anchor="middle" x="1777" y="-15595.33" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1777" y="-15584.33" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-15573.33" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-15562.33" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_44_res2&#45;&gt;moe_45_mha -->
<g id="edge1571" class="edge">
<title>moe_44_res2&#45;&gt;moe_45_mha</title>
<path fill="none" stroke="black" d="M1777,-15654.24C1777,-15641.9 1777,-15629 1777,-15617.58"/>
<polygon fill="black" stroke="black" points="1780.5,-15617.57 1777,-15607.57 1773.5,-15617.57 1780.5,-15617.57"/>
</g>
<!-- moe_45_res1 -->
<g id="node978" class="node">
<title>moe_45_res1</title>
<polygon fill="lightyellow" stroke="black" points="2113.89,-15519.33 1577.97,-15519.33 1440.11,-15415.33 1976.03,-15415.33 2113.89,-15519.33"/>
<text text-anchor="middle" x="1777" y="-15481.33" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1777" y="-15470.33" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-15459.33" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1777" y="-15448.33" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_45_mha&#45;&gt;moe_45_res1 -->
<g id="edge1572" class="edge">
<title>moe_45_mha&#45;&gt;moe_45_res1</title>
<path fill="none" stroke="black" d="M1777,-15555.19C1777,-15547.51 1777,-15538.7 1777,-15529.7"/>
<polygon fill="black" stroke="black" points="1780.5,-15529.51 1777,-15519.51 1773.5,-15529.51 1780.5,-15529.51"/>
</g>
<!-- moe_45_gate -->
<g id="node958" class="node">
<title>moe_45_gate</title>
<polygon fill="lightyellow" stroke="black" points="2105.8,-15379.33 1582.75,-15379.33 1448.2,-15275.33 1971.25,-15275.33 2105.8,-15379.33"/>
<text text-anchor="middle" x="1777" y="-15341.33" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1777" y="-15330.33" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-15319.33" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-15308.33" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_45_route -->
<g id="node959" class="node">
<title>moe_45_route</title>
<ellipse fill="lightblue" stroke="black" cx="1777" cy="-15202.56" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1777" y="-15216.56" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1777" y="-15205.56" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1777" y="-15194.56" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-15183.56" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_45_gate&#45;&gt;moe_45_route -->
<g id="edge1574" class="edge">
<title>moe_45_gate&#45;&gt;moe_45_route</title>
<path fill="none" stroke="black" d="M1777,-15274.98C1777,-15266.57 1777,-15257.9 1777,-15249.63"/>
<polygon fill="black" stroke="black" points="1780.5,-15249.42 1777,-15239.42 1773.5,-15249.42 1780.5,-15249.42"/>
</g>
<!-- moe_45_expert_0 -->
<g id="node960" class="node">
<title>moe_45_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-15129.79 16,-15129.79 16,-15077.79 234,-15077.79 234,-15129.79"/>
<text text-anchor="middle" x="125" y="-15117.79" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-15106.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-15095.79" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-15084.79" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_45_route&#45;&gt;moe_45_expert_0 -->
<g id="edge1575" class="edge">
<title>moe_45_route&#45;&gt;moe_45_expert_0</title>
<path fill="none" stroke="black" d="M1562.77,-15195.83C1207.39,-15185.61 509.65,-15162.33 244.21,-15129.83"/>
<polygon fill="black" stroke="black" points="244.54,-15126.35 234.18,-15128.57 243.67,-15133.29 244.54,-15126.35"/>
</g>
<!-- moe_45_expert_1 -->
<g id="node961" class="node">
<title>moe_45_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-15129.79 252,-15129.79 252,-15077.79 470,-15077.79 470,-15129.79"/>
<text text-anchor="middle" x="361" y="-15117.79" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-15106.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-15095.79" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-15084.79" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_45_route&#45;&gt;moe_45_expert_1 -->
<g id="edge1576" class="edge">
<title>moe_45_route&#45;&gt;moe_45_expert_1</title>
<path fill="none" stroke="black" d="M1559.59,-15199.71C1303.22,-15195.21 864.4,-15180.22 480.11,-15129.85"/>
<polygon fill="black" stroke="black" points="480.56,-15126.38 470.19,-15128.54 479.64,-15133.32 480.56,-15126.38"/>
</g>
<!-- moe_45_expert_2 -->
<g id="node962" class="node">
<title>moe_45_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-15129.79 488,-15129.79 488,-15077.79 706,-15077.79 706,-15129.79"/>
<text text-anchor="middle" x="597" y="-15117.79" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-15106.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-15095.79" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-15084.79" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_45_route&#45;&gt;moe_45_expert_2 -->
<g id="edge1577" class="edge">
<title>moe_45_route&#45;&gt;moe_45_expert_2</title>
<path fill="none" stroke="black" d="M1562.51,-15195.95C1349.77,-15188.33 1014.57,-15170.77 716.34,-15129.89"/>
<polygon fill="black" stroke="black" points="716.58,-15126.39 706.2,-15128.49 715.62,-15133.33 716.58,-15126.39"/>
</g>
<!-- moe_45_expert_3 -->
<g id="node963" class="node">
<title>moe_45_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-15129.79 724,-15129.79 724,-15077.79 942,-15077.79 942,-15129.79"/>
<text text-anchor="middle" x="833" y="-15117.79" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-15106.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-15095.79" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-15084.79" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_45_route&#45;&gt;moe_45_expert_3 -->
<g id="edge1578" class="edge">
<title>moe_45_route&#45;&gt;moe_45_expert_3</title>
<path fill="none" stroke="black" d="M1570.82,-15190.65C1405.76,-15180.27 1168.32,-15161.62 952.16,-15129.89"/>
<polygon fill="black" stroke="black" points="952.61,-15126.42 942.21,-15128.42 951.59,-15133.34 952.61,-15126.42"/>
</g>
<!-- moe_45_expert_4 -->
<g id="node964" class="node">
<title>moe_45_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-15129.79 960,-15129.79 960,-15077.79 1178,-15077.79 1178,-15129.79"/>
<text text-anchor="middle" x="1069" y="-15117.79" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-15106.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-15095.79" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-15084.79" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_45_route&#45;&gt;moe_45_expert_4 -->
<g id="edge1579" class="edge">
<title>moe_45_route&#45;&gt;moe_45_expert_4</title>
<path fill="none" stroke="black" d="M1591.38,-15183.2C1477.62,-15170.93 1328.9,-15153.07 1188.33,-15129.96"/>
<polygon fill="black" stroke="black" points="1188.66,-15126.46 1178.23,-15128.28 1187.52,-15133.37 1188.66,-15126.46"/>
</g>
<!-- moe_45_expert_5 -->
<g id="node965" class="node">
<title>moe_45_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-15129.79 1196,-15129.79 1196,-15077.79 1414,-15077.79 1414,-15129.79"/>
<text text-anchor="middle" x="1305" y="-15117.79" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-15106.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-15095.79" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-15084.79" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_45_route&#45;&gt;moe_45_expert_5 -->
<g id="edge1580" class="edge">
<title>moe_45_route&#45;&gt;moe_45_expert_5</title>
<path fill="none" stroke="black" d="M1639.51,-15173.98C1576.62,-15161.29 1500.88,-15145.91 1424.14,-15130.02"/>
<polygon fill="black" stroke="black" points="1424.79,-15126.58 1414.28,-15127.98 1423.37,-15133.44 1424.79,-15126.58"/>
</g>
<!-- moe_45_expert_6 -->
<g id="node966" class="node">
<title>moe_45_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-15129.79 1432,-15129.79 1432,-15077.79 1650,-15077.79 1650,-15129.79"/>
<text text-anchor="middle" x="1541" y="-15117.79" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-15106.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-15095.79" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-15084.79" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_45_route&#45;&gt;moe_45_expert_6 -->
<g id="edge1581" class="edge">
<title>moe_45_route&#45;&gt;moe_45_expert_6</title>
<path fill="none" stroke="black" d="M1696.11,-15168.39C1668.54,-15157.09 1637.96,-15144.55 1611.29,-15133.61"/>
<polygon fill="black" stroke="black" points="1612.61,-15130.37 1602.03,-15129.81 1609.95,-15136.85 1612.61,-15130.37"/>
</g>
<!-- moe_45_expert_7 -->
<g id="node967" class="node">
<title>moe_45_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-15129.79 1668,-15129.79 1668,-15077.79 1886,-15077.79 1886,-15129.79"/>
<text text-anchor="middle" x="1777" y="-15117.79" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-15106.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-15095.79" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-15084.79" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_45_route&#45;&gt;moe_45_expert_7 -->
<g id="edge1582" class="edge">
<title>moe_45_route&#45;&gt;moe_45_expert_7</title>
<path fill="none" stroke="black" d="M1777,-15165.53C1777,-15157.21 1777,-15148.38 1777,-15140.1"/>
<polygon fill="black" stroke="black" points="1780.5,-15139.99 1777,-15129.99 1773.5,-15139.99 1780.5,-15139.99"/>
</g>
<!-- moe_45_expert_8 -->
<g id="node968" class="node">
<title>moe_45_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-15129.79 1904,-15129.79 1904,-15077.79 2122,-15077.79 2122,-15129.79"/>
<text text-anchor="middle" x="2013" y="-15117.79" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-15106.79" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-15095.79" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-15084.79" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_45_route&#45;&gt;moe_45_expert_8 -->
<g id="edge1583" class="edge">
<title>moe_45_route&#45;&gt;moe_45_expert_8</title>
<path fill="none" stroke="black" d="M1857.89,-15168.39C1885.46,-15157.09 1916.04,-15144.55 1942.71,-15133.61"/>
<polygon fill="black" stroke="black" points="1944.05,-15136.85 1951.97,-15129.81 1941.39,-15130.37 1944.05,-15136.85"/>
</g>
<!-- moe_45_expert_9 -->
<g id="node969" class="node">
<title>moe_45_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-15129.79 2140,-15129.79 2140,-15077.79 2358,-15077.79 2358,-15129.79"/>
<text text-anchor="middle" x="2249" y="-15117.79" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-15106.79" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-15095.79" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-15084.79" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_45_route&#45;&gt;moe_45_expert_9 -->
<g id="edge1584" class="edge">
<title>moe_45_route&#45;&gt;moe_45_expert_9</title>
<path fill="none" stroke="black" d="M1914.49,-15173.98C1977.38,-15161.29 2053.12,-15145.91 2129.86,-15130.02"/>
<polygon fill="black" stroke="black" points="2130.63,-15133.44 2139.72,-15127.98 2129.21,-15126.58 2130.63,-15133.44"/>
</g>
<!-- moe_45_expert_10 -->
<g id="node970" class="node">
<title>moe_45_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-15129.79 2376,-15129.79 2376,-15077.79 2594,-15077.79 2594,-15129.79"/>
<text text-anchor="middle" x="2485" y="-15117.79" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-15106.79" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-15095.79" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-15084.79" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_45_route&#45;&gt;moe_45_expert_10 -->
<g id="edge1585" class="edge">
<title>moe_45_route&#45;&gt;moe_45_expert_10</title>
<path fill="none" stroke="black" d="M1962.62,-15183.2C2076.38,-15170.93 2225.1,-15153.07 2365.67,-15129.96"/>
<polygon fill="black" stroke="black" points="2366.48,-15133.37 2375.77,-15128.28 2365.34,-15126.46 2366.48,-15133.37"/>
</g>
<!-- moe_45_expert_11 -->
<g id="node971" class="node">
<title>moe_45_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-15129.79 2612,-15129.79 2612,-15077.79 2830,-15077.79 2830,-15129.79"/>
<text text-anchor="middle" x="2721" y="-15117.79" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-15106.79" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-15095.79" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-15084.79" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_45_route&#45;&gt;moe_45_expert_11 -->
<g id="edge1586" class="edge">
<title>moe_45_route&#45;&gt;moe_45_expert_11</title>
<path fill="none" stroke="black" d="M1983.18,-15190.65C2148.24,-15180.27 2385.68,-15161.62 2601.84,-15129.89"/>
<polygon fill="black" stroke="black" points="2602.41,-15133.34 2611.79,-15128.42 2601.39,-15126.42 2602.41,-15133.34"/>
</g>
<!-- moe_45_expert_12 -->
<g id="node972" class="node">
<title>moe_45_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-15129.79 2848,-15129.79 2848,-15077.79 3066,-15077.79 3066,-15129.79"/>
<text text-anchor="middle" x="2957" y="-15117.79" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-15106.79" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-15095.79" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-15084.79" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_45_route&#45;&gt;moe_45_expert_12 -->
<g id="edge1587" class="edge">
<title>moe_45_route&#45;&gt;moe_45_expert_12</title>
<path fill="none" stroke="black" d="M1991.49,-15195.95C2204.23,-15188.33 2539.43,-15170.77 2837.66,-15129.89"/>
<polygon fill="black" stroke="black" points="2838.38,-15133.33 2847.8,-15128.49 2837.42,-15126.39 2838.38,-15133.33"/>
</g>
<!-- moe_45_expert_13 -->
<g id="node973" class="node">
<title>moe_45_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-15129.79 3084,-15129.79 3084,-15077.79 3302,-15077.79 3302,-15129.79"/>
<text text-anchor="middle" x="3193" y="-15117.79" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-15106.79" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-15095.79" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-15084.79" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_45_route&#45;&gt;moe_45_expert_13 -->
<g id="edge1588" class="edge">
<title>moe_45_route&#45;&gt;moe_45_expert_13</title>
<path fill="none" stroke="black" d="M1994.41,-15199.71C2250.78,-15195.21 2689.6,-15180.22 3073.89,-15129.85"/>
<polygon fill="black" stroke="black" points="3074.36,-15133.32 3083.81,-15128.54 3073.44,-15126.38 3074.36,-15133.32"/>
</g>
<!-- moe_45_expert_14 -->
<g id="node974" class="node">
<title>moe_45_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-15129.79 3320,-15129.79 3320,-15077.79 3538,-15077.79 3538,-15129.79"/>
<text text-anchor="middle" x="3429" y="-15117.79" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-15106.79" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-15095.79" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-15084.79" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_45_route&#45;&gt;moe_45_expert_14 -->
<g id="edge1589" class="edge">
<title>moe_45_route&#45;&gt;moe_45_expert_14</title>
<path fill="none" stroke="black" d="M1991.23,-15195.83C2346.61,-15185.61 3044.35,-15162.33 3309.79,-15129.83"/>
<polygon fill="black" stroke="black" points="3310.33,-15133.29 3319.82,-15128.57 3309.46,-15126.35 3310.33,-15133.29"/>
</g>
<!-- moe_45_expert_15 -->
<g id="node975" class="node">
<title>moe_45_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-15129.79 3556,-15129.79 3556,-15077.79 3774,-15077.79 3774,-15129.79"/>
<text text-anchor="middle" x="3665" y="-15117.79" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-15106.79" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-15095.79" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-15084.79" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_45_route&#45;&gt;moe_45_expert_15 -->
<g id="edge1590" class="edge">
<title>moe_45_route&#45;&gt;moe_45_expert_15</title>
<path fill="none" stroke="black" d="M1992.71,-15197.36C2392.25,-15188.82 3234.28,-15167.15 3545.86,-15129.82"/>
<polygon fill="black" stroke="black" points="3546.32,-15133.29 3555.82,-15128.6 3545.47,-15126.34 3546.32,-15133.29"/>
</g>
<!-- moe_45_aggregate -->
<g id="node976" class="node">
<title>moe_45_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-15005.02" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-15019.02" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1895" y="-15008.02" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-14997.02" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1895" y="-14986.02" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_45_expert_0&#45;&gt;moe_45_aggregate -->
<g id="edge1591" class="edge">
<title>moe_45_expert_0&#45;&gt;moe_45_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-15079C237.15,-15078.56 240.09,-15078.16 243,-15077.79 510.74,-15043.85 1276.32,-15021.05 1664.04,-15011.34"/>
<polygon fill="black" stroke="black" points="1664.35,-15014.83 1674.26,-15011.08 1664.17,-15007.83 1664.35,-15014.83"/>
</g>
<!-- moe_45_expert_1&#45;&gt;moe_45_aggregate -->
<g id="edge1592" class="edge">
<title>moe_45_expert_1&#45;&gt;moe_45_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-15079.02C473.15,-15078.58 476.09,-15078.17 479,-15077.79 892.79,-15023.81 1379.51,-15009.85 1661.11,-15006.58"/>
<polygon fill="black" stroke="black" points="1661.49,-15010.08 1671.45,-15006.46 1661.41,-15003.08 1661.49,-15010.08"/>
</g>
<!-- moe_45_expert_2&#45;&gt;moe_45_aggregate -->
<g id="edge1593" class="edge">
<title>moe_45_expert_2&#45;&gt;moe_45_aggregate</title>
<path fill="none" stroke="black" d="M706.19,-15079.06C709.15,-15078.61 712.09,-15078.18 715,-15077.79 1042.31,-15033.41 1424.45,-15016.47 1663.11,-15010"/>
<polygon fill="black" stroke="black" points="1663.4,-15013.5 1673.31,-15009.73 1663.22,-15006.5 1663.4,-15013.5"/>
</g>
<!-- moe_45_expert_3&#45;&gt;moe_45_aggregate -->
<g id="edge1594" class="edge">
<title>moe_45_expert_3&#45;&gt;moe_45_aggregate</title>
<path fill="none" stroke="black" d="M942.2,-15079.12C945.16,-15078.65 948.1,-15078.21 951,-15077.79 1194.76,-15042.86 1476.52,-15024.23 1668.32,-15014.79"/>
<polygon fill="black" stroke="black" points="1668.71,-15018.28 1678.53,-15014.29 1668.37,-15011.29 1668.71,-15018.28"/>
</g>
<!-- moe_45_expert_4&#45;&gt;moe_45_aggregate -->
<g id="edge1595" class="edge">
<title>moe_45_expert_4&#45;&gt;moe_45_aggregate</title>
<path fill="none" stroke="black" d="M1178.21,-15079.22C1181.17,-15078.72 1184.1,-15078.24 1187,-15077.79 1352.7,-15051.92 1541.73,-15033.3 1682.77,-15021.53"/>
<polygon fill="black" stroke="black" points="1683.17,-15025 1692.84,-15020.69 1682.59,-15018.03 1683.17,-15025"/>
</g>
<!-- moe_45_expert_5&#45;&gt;moe_45_aggregate -->
<g id="edge1596" class="edge">
<title>moe_45_expert_5&#45;&gt;moe_45_aggregate</title>
<path fill="none" stroke="black" d="M1414.25,-15079.41C1417.19,-15078.86 1420.12,-15078.31 1423,-15077.79 1519.58,-15060.23 1627.83,-15043.56 1716.27,-15030.71"/>
<polygon fill="black" stroke="black" points="1717.01,-15034.14 1726.4,-15029.24 1716,-15027.21 1717.01,-15034.14"/>
</g>
<!-- moe_45_expert_6&#45;&gt;moe_45_aggregate -->
<g id="edge1597" class="edge">
<title>moe_45_expert_6&#45;&gt;moe_45_aggregate</title>
<path fill="none" stroke="black" d="M1632.62,-15077.74C1675.27,-15066.09 1726.62,-15052.05 1772.54,-15039.5"/>
<polygon fill="black" stroke="black" points="1773.53,-15042.85 1782.25,-15036.84 1771.68,-15036.1 1773.53,-15042.85"/>
</g>
<!-- moe_45_expert_7&#45;&gt;moe_45_aggregate -->
<g id="edge1598" class="edge">
<title>moe_45_expert_7&#45;&gt;moe_45_aggregate</title>
<path fill="none" stroke="black" d="M1807.7,-15077.62C1818.79,-15068.52 1831.63,-15057.99 1843.99,-15047.85"/>
<polygon fill="black" stroke="black" points="1846.51,-15050.31 1852.02,-15041.27 1842.07,-15044.9 1846.51,-15050.31"/>
</g>
<!-- moe_45_expert_8&#45;&gt;moe_45_aggregate -->
<g id="edge1599" class="edge">
<title>moe_45_expert_8&#45;&gt;moe_45_aggregate</title>
<path fill="none" stroke="black" d="M1982.3,-15077.62C1971.21,-15068.52 1958.37,-15057.99 1946.01,-15047.85"/>
<polygon fill="black" stroke="black" points="1947.93,-15044.9 1937.98,-15041.27 1943.49,-15050.31 1947.93,-15044.9"/>
</g>
<!-- moe_45_expert_9&#45;&gt;moe_45_aggregate -->
<g id="edge1600" class="edge">
<title>moe_45_expert_9&#45;&gt;moe_45_aggregate</title>
<path fill="none" stroke="black" d="M2157.38,-15077.74C2114.73,-15066.09 2063.38,-15052.05 2017.46,-15039.5"/>
<polygon fill="black" stroke="black" points="2018.32,-15036.1 2007.75,-15036.84 2016.47,-15042.85 2018.32,-15036.1"/>
</g>
<!-- moe_45_expert_10&#45;&gt;moe_45_aggregate -->
<g id="edge1601" class="edge">
<title>moe_45_expert_10&#45;&gt;moe_45_aggregate</title>
<path fill="none" stroke="black" d="M2375.75,-15079.41C2372.81,-15078.86 2369.88,-15078.31 2367,-15077.79 2270.42,-15060.23 2162.17,-15043.56 2073.73,-15030.71"/>
<polygon fill="black" stroke="black" points="2074,-15027.21 2063.6,-15029.24 2072.99,-15034.14 2074,-15027.21"/>
</g>
<!-- moe_45_expert_11&#45;&gt;moe_45_aggregate -->
<g id="edge1602" class="edge">
<title>moe_45_expert_11&#45;&gt;moe_45_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-15079.22C2608.83,-15078.72 2605.9,-15078.24 2603,-15077.79 2437.3,-15051.92 2248.27,-15033.3 2107.23,-15021.53"/>
<polygon fill="black" stroke="black" points="2107.41,-15018.03 2097.16,-15020.69 2106.83,-15025 2107.41,-15018.03"/>
</g>
<!-- moe_45_expert_12&#45;&gt;moe_45_aggregate -->
<g id="edge1603" class="edge">
<title>moe_45_expert_12&#45;&gt;moe_45_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-15079.12C2844.84,-15078.65 2841.9,-15078.21 2839,-15077.79 2595.24,-15042.86 2313.48,-15024.23 2121.68,-15014.79"/>
<polygon fill="black" stroke="black" points="2121.63,-15011.29 2111.47,-15014.29 2121.29,-15018.28 2121.63,-15011.29"/>
</g>
<!-- moe_45_expert_13&#45;&gt;moe_45_aggregate -->
<g id="edge1604" class="edge">
<title>moe_45_expert_13&#45;&gt;moe_45_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-15079.06C3080.85,-15078.61 3077.91,-15078.18 3075,-15077.79 2747.69,-15033.41 2365.55,-15016.47 2126.89,-15010"/>
<polygon fill="black" stroke="black" points="2126.78,-15006.5 2116.69,-15009.73 2126.6,-15013.5 2126.78,-15006.5"/>
</g>
<!-- moe_45_expert_14&#45;&gt;moe_45_aggregate -->
<g id="edge1605" class="edge">
<title>moe_45_expert_14&#45;&gt;moe_45_aggregate</title>
<path fill="none" stroke="black" d="M3319.81,-15079.02C3316.85,-15078.58 3313.91,-15078.17 3311,-15077.79 2897.21,-15023.81 2410.49,-15009.85 2128.89,-15006.58"/>
<polygon fill="black" stroke="black" points="2128.59,-15003.08 2118.55,-15006.46 2128.51,-15010.08 2128.59,-15003.08"/>
</g>
<!-- moe_45_expert_15&#45;&gt;moe_45_aggregate -->
<g id="edge1606" class="edge">
<title>moe_45_expert_15&#45;&gt;moe_45_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-15079C3552.85,-15078.56 3549.91,-15078.16 3547,-15077.79 3279.26,-15043.85 2513.68,-15021.05 2125.96,-15011.34"/>
<polygon fill="black" stroke="black" points="2125.83,-15007.83 2115.74,-15011.08 2125.65,-15014.83 2125.83,-15007.83"/>
</g>
<!-- moe_45_ffn -->
<g id="node977" class="node">
<title>moe_45_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2053,-14932.25 1737,-14932.25 1737,-14880.25 2053,-14880.25 2053,-14932.25"/>
<text text-anchor="middle" x="1895" y="-14920.25" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1895" y="-14909.25" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-14898.25" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-14887.25" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_45_aggregate&#45;&gt;moe_45_ffn -->
<g id="edge1607" class="edge">
<title>moe_45_aggregate&#45;&gt;moe_45_ffn</title>
<path fill="none" stroke="black" d="M1895,-14967.99C1895,-14959.68 1895,-14950.84 1895,-14942.56"/>
<polygon fill="black" stroke="black" points="1898.5,-14942.45 1895,-14932.45 1891.5,-14942.45 1898.5,-14942.45"/>
</g>
<!-- moe_45_res2 -->
<g id="node979" class="node">
<title>moe_45_res2</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-14844.25 1695.97,-14844.25 1558.11,-14740.25 2094.03,-14740.25 2231.89,-14844.25"/>
<text text-anchor="middle" x="1895" y="-14806.25" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1895" y="-14795.25" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-14784.25" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-14773.25" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_45_ffn&#45;&gt;moe_45_res2 -->
<g id="edge1608" class="edge">
<title>moe_45_ffn&#45;&gt;moe_45_res2</title>
<path fill="none" stroke="black" d="M1895,-14880.12C1895,-14872.43 1895,-14863.62 1895,-14854.62"/>
<polygon fill="black" stroke="black" points="1898.5,-14854.43 1895,-14844.43 1891.5,-14854.43 1898.5,-14854.43"/>
</g>
<!-- moe_45_res1&#45;&gt;moe_45_gate -->
<g id="edge1573" class="edge">
<title>moe_45_res1&#45;&gt;moe_45_gate</title>
<path fill="none" stroke="black" d="M1777,-15414.94C1777,-15406.77 1777,-15398.25 1777,-15389.87"/>
<polygon fill="black" stroke="black" points="1780.5,-15389.76 1777,-15379.76 1773.5,-15389.76 1780.5,-15389.76"/>
</g>
<!-- moe_46_mha -->
<g id="node980" class="node">
<title>moe_46_mha</title>
<polygon fill="lightgreen" stroke="black" points="2053,-14693.25 1737,-14693.25 1737,-14641.25 2053,-14641.25 2053,-14693.25"/>
<text text-anchor="middle" x="1895" y="-14681.25" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1895" y="-14670.25" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-14659.25" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-14648.25" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_45_res2&#45;&gt;moe_46_mha -->
<g id="edge1609" class="edge">
<title>moe_45_res2&#45;&gt;moe_46_mha</title>
<path fill="none" stroke="black" d="M1895,-14740.16C1895,-14727.83 1895,-14714.92 1895,-14703.5"/>
<polygon fill="black" stroke="black" points="1898.5,-14703.49 1895,-14693.49 1891.5,-14703.49 1898.5,-14703.49"/>
</g>
<!-- moe_46_res1 -->
<g id="node1001" class="node">
<title>moe_46_res1</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-14605.25 1695.97,-14605.25 1558.11,-14501.25 2094.03,-14501.25 2231.89,-14605.25"/>
<text text-anchor="middle" x="1895" y="-14567.25" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1895" y="-14556.25" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-14545.25" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-14534.25" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_46_mha&#45;&gt;moe_46_res1 -->
<g id="edge1610" class="edge">
<title>moe_46_mha&#45;&gt;moe_46_res1</title>
<path fill="none" stroke="black" d="M1895,-14641.12C1895,-14633.43 1895,-14624.62 1895,-14615.62"/>
<polygon fill="black" stroke="black" points="1898.5,-14615.43 1895,-14605.43 1891.5,-14615.43 1898.5,-14615.43"/>
</g>
<!-- moe_46_gate -->
<g id="node981" class="node">
<title>moe_46_gate</title>
<polygon fill="lightyellow" stroke="black" points="2223.8,-14465.25 1700.75,-14465.25 1566.2,-14361.25 2089.25,-14361.25 2223.8,-14465.25"/>
<text text-anchor="middle" x="1895" y="-14427.25" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1895" y="-14416.25" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-14405.25" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-14394.25" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_46_route -->
<g id="node982" class="node">
<title>moe_46_route</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-14288.48" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-14302.48" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1895" y="-14291.48" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-14280.48" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-14269.48" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_46_gate&#45;&gt;moe_46_route -->
<g id="edge1612" class="edge">
<title>moe_46_gate&#45;&gt;moe_46_route</title>
<path fill="none" stroke="black" d="M1895,-14360.9C1895,-14352.49 1895,-14343.82 1895,-14335.55"/>
<polygon fill="black" stroke="black" points="1898.5,-14335.34 1895,-14325.34 1891.5,-14335.34 1898.5,-14335.34"/>
</g>
<!-- moe_46_expert_0 -->
<g id="node983" class="node">
<title>moe_46_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-14215.71 16,-14215.71 16,-14163.71 234,-14163.71 234,-14215.71"/>
<text text-anchor="middle" x="125" y="-14203.71" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-14192.71" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-14181.71" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-14170.71" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_46_route&#45;&gt;moe_46_expert_0 -->
<g id="edge1613" class="edge">
<title>moe_46_route&#45;&gt;moe_46_expert_0</title>
<path fill="none" stroke="black" d="M1679.93,-14282.56C1302.11,-14273.19 532.75,-14250.66 244.24,-14215.75"/>
<polygon fill="black" stroke="black" points="244.54,-14212.26 234.18,-14214.51 243.68,-14219.21 244.54,-14212.26"/>
</g>
<!-- moe_46_expert_1 -->
<g id="node984" class="node">
<title>moe_46_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-14215.71 252,-14215.71 252,-14163.71 470,-14163.71 470,-14215.71"/>
<text text-anchor="middle" x="361" y="-14203.71" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-14192.71" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-14181.71" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-14170.71" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_46_route&#45;&gt;moe_46_expert_1 -->
<g id="edge1614" class="edge">
<title>moe_46_route&#45;&gt;moe_46_expert_1</title>
<path fill="none" stroke="black" d="M1677.23,-14287.1C1400.57,-14284.2 908.56,-14270.94 480.29,-14215.79"/>
<polygon fill="black" stroke="black" points="480.55,-14212.29 470.19,-14214.48 479.65,-14219.24 480.55,-14212.29"/>
</g>
<!-- moe_46_expert_2 -->
<g id="node985" class="node">
<title>moe_46_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-14215.71 488,-14215.71 488,-14163.71 706,-14163.71 706,-14215.71"/>
<text text-anchor="middle" x="597" y="-14203.71" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-14192.71" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-14181.71" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-14170.71" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_46_route&#45;&gt;moe_46_expert_2 -->
<g id="edge1615" class="edge">
<title>moe_46_route&#45;&gt;moe_46_expert_2</title>
<path fill="none" stroke="black" d="M1678.74,-14283.91C1443.7,-14277.83 1057.2,-14261.4 716.26,-14215.8"/>
<polygon fill="black" stroke="black" points="716.57,-14212.31 706.19,-14214.44 715.63,-14219.24 716.57,-14212.31"/>
</g>
<!-- moe_46_expert_3 -->
<g id="node986" class="node">
<title>moe_46_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-14215.71 724,-14215.71 724,-14163.71 942,-14163.71 942,-14215.71"/>
<text text-anchor="middle" x="833" y="-14203.71" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-14192.71" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-14181.71" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-14170.71" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_46_route&#45;&gt;moe_46_expert_3 -->
<g id="edge1616" class="edge">
<title>moe_46_route&#45;&gt;moe_46_expert_3</title>
<path fill="none" stroke="black" d="M1683.7,-14279.46C1494.33,-14270.39 1209,-14252.08 952.47,-14215.84"/>
<polygon fill="black" stroke="black" points="952.59,-14212.33 942.2,-14214.38 951.61,-14219.26 952.59,-14212.33"/>
</g>
<!-- moe_46_expert_4 -->
<g id="node987" class="node">
<title>moe_46_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-14215.71 960,-14215.71 960,-14163.71 1178,-14163.71 1178,-14215.71"/>
<text text-anchor="middle" x="1069" y="-14203.71" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-14192.71" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-14181.71" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-14170.71" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_46_route&#45;&gt;moe_46_expert_4 -->
<g id="edge1617" class="edge">
<title>moe_46_route&#45;&gt;moe_46_expert_4</title>
<path fill="none" stroke="black" d="M1696.66,-14273.13C1556.96,-14261.65 1365.46,-14243.15 1188.25,-14215.84"/>
<polygon fill="black" stroke="black" points="1188.63,-14212.36 1178.21,-14214.28 1187.56,-14219.28 1188.63,-14212.36"/>
</g>
<!-- moe_46_expert_5 -->
<g id="node988" class="node">
<title>moe_46_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-14215.71 1196,-14215.71 1196,-14163.71 1414,-14163.71 1414,-14215.71"/>
<text text-anchor="middle" x="1305" y="-14203.71" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-14192.71" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-14181.71" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-14170.71" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_46_route&#45;&gt;moe_46_expert_5 -->
<g id="edge1618" class="edge">
<title>moe_46_route&#45;&gt;moe_46_expert_5</title>
<path fill="none" stroke="black" d="M1728.87,-14264.62C1640.99,-14251.94 1531.11,-14235.17 1424.25,-14215.9"/>
<polygon fill="black" stroke="black" points="1424.71,-14212.43 1414.25,-14214.09 1423.46,-14219.32 1424.71,-14212.43"/>
</g>
<!-- moe_46_expert_6 -->
<g id="node989" class="node">
<title>moe_46_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-14215.71 1432,-14215.71 1432,-14163.71 1650,-14163.71 1650,-14215.71"/>
<text text-anchor="middle" x="1541" y="-14203.71" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-14192.71" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-14181.71" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-14170.71" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_46_route&#45;&gt;moe_46_expert_6 -->
<g id="edge1619" class="edge">
<title>moe_46_route&#45;&gt;moe_46_expert_6</title>
<path fill="none" stroke="black" d="M1782.99,-14256.86C1737.98,-14244.56 1686.47,-14230.48 1642.56,-14218.48"/>
<polygon fill="black" stroke="black" points="1643.31,-14215.05 1632.74,-14215.79 1641.46,-14221.8 1643.31,-14215.05"/>
</g>
<!-- moe_46_expert_7 -->
<g id="node990" class="node">
<title>moe_46_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-14215.71 1668,-14215.71 1668,-14163.71 1886,-14163.71 1886,-14215.71"/>
<text text-anchor="middle" x="1777" y="-14203.71" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-14192.71" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-14181.71" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-14170.71" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_46_route&#45;&gt;moe_46_expert_7 -->
<g id="edge1620" class="edge">
<title>moe_46_route&#45;&gt;moe_46_expert_7</title>
<path fill="none" stroke="black" d="M1852.07,-14252.27C1840.07,-14242.44 1827.12,-14231.82 1815.41,-14222.21"/>
<polygon fill="black" stroke="black" points="1817.47,-14219.38 1807.52,-14215.74 1813.04,-14224.79 1817.47,-14219.38"/>
</g>
<!-- moe_46_expert_8 -->
<g id="node991" class="node">
<title>moe_46_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-14215.71 1904,-14215.71 1904,-14163.71 2122,-14163.71 2122,-14215.71"/>
<text text-anchor="middle" x="2013" y="-14203.71" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-14192.71" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-14181.71" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-14170.71" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_46_route&#45;&gt;moe_46_expert_8 -->
<g id="edge1621" class="edge">
<title>moe_46_route&#45;&gt;moe_46_expert_8</title>
<path fill="none" stroke="black" d="M1937.93,-14252.27C1949.93,-14242.44 1962.88,-14231.82 1974.59,-14222.21"/>
<polygon fill="black" stroke="black" points="1976.96,-14224.79 1982.48,-14215.74 1972.53,-14219.38 1976.96,-14224.79"/>
</g>
<!-- moe_46_expert_9 -->
<g id="node992" class="node">
<title>moe_46_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-14215.71 2140,-14215.71 2140,-14163.71 2358,-14163.71 2358,-14215.71"/>
<text text-anchor="middle" x="2249" y="-14203.71" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-14192.71" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-14181.71" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-14170.71" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_46_route&#45;&gt;moe_46_expert_9 -->
<g id="edge1622" class="edge">
<title>moe_46_route&#45;&gt;moe_46_expert_9</title>
<path fill="none" stroke="black" d="M2007.01,-14256.86C2052.02,-14244.56 2103.53,-14230.48 2147.44,-14218.48"/>
<polygon fill="black" stroke="black" points="2148.54,-14221.8 2157.26,-14215.79 2146.69,-14215.05 2148.54,-14221.8"/>
</g>
<!-- moe_46_expert_10 -->
<g id="node993" class="node">
<title>moe_46_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-14215.71 2376,-14215.71 2376,-14163.71 2594,-14163.71 2594,-14215.71"/>
<text text-anchor="middle" x="2485" y="-14203.71" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-14192.71" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-14181.71" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-14170.71" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_46_route&#45;&gt;moe_46_expert_10 -->
<g id="edge1623" class="edge">
<title>moe_46_route&#45;&gt;moe_46_expert_10</title>
<path fill="none" stroke="black" d="M2061.13,-14264.62C2149.01,-14251.94 2258.89,-14235.17 2365.75,-14215.9"/>
<polygon fill="black" stroke="black" points="2366.54,-14219.32 2375.75,-14214.09 2365.29,-14212.43 2366.54,-14219.32"/>
</g>
<!-- moe_46_expert_11 -->
<g id="node994" class="node">
<title>moe_46_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-14215.71 2612,-14215.71 2612,-14163.71 2830,-14163.71 2830,-14215.71"/>
<text text-anchor="middle" x="2721" y="-14203.71" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-14192.71" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-14181.71" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-14170.71" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_46_route&#45;&gt;moe_46_expert_11 -->
<g id="edge1624" class="edge">
<title>moe_46_route&#45;&gt;moe_46_expert_11</title>
<path fill="none" stroke="black" d="M2093.34,-14273.13C2233.04,-14261.65 2424.54,-14243.15 2601.75,-14215.84"/>
<polygon fill="black" stroke="black" points="2602.44,-14219.28 2611.79,-14214.28 2601.37,-14212.36 2602.44,-14219.28"/>
</g>
<!-- moe_46_expert_12 -->
<g id="node995" class="node">
<title>moe_46_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-14215.71 2848,-14215.71 2848,-14163.71 3066,-14163.71 3066,-14215.71"/>
<text text-anchor="middle" x="2957" y="-14203.71" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-14192.71" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-14181.71" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-14170.71" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_46_route&#45;&gt;moe_46_expert_12 -->
<g id="edge1625" class="edge">
<title>moe_46_route&#45;&gt;moe_46_expert_12</title>
<path fill="none" stroke="black" d="M2106.3,-14279.46C2295.67,-14270.39 2581,-14252.08 2837.53,-14215.84"/>
<polygon fill="black" stroke="black" points="2838.39,-14219.26 2847.8,-14214.38 2837.41,-14212.33 2838.39,-14219.26"/>
</g>
<!-- moe_46_expert_13 -->
<g id="node996" class="node">
<title>moe_46_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-14215.71 3084,-14215.71 3084,-14163.71 3302,-14163.71 3302,-14215.71"/>
<text text-anchor="middle" x="3193" y="-14203.71" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-14192.71" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-14181.71" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-14170.71" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_46_route&#45;&gt;moe_46_expert_13 -->
<g id="edge1626" class="edge">
<title>moe_46_route&#45;&gt;moe_46_expert_13</title>
<path fill="none" stroke="black" d="M2111.26,-14283.91C2346.3,-14277.83 2732.8,-14261.4 3073.74,-14215.8"/>
<polygon fill="black" stroke="black" points="3074.37,-14219.24 3083.81,-14214.44 3073.43,-14212.31 3074.37,-14219.24"/>
</g>
<!-- moe_46_expert_14 -->
<g id="node997" class="node">
<title>moe_46_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-14215.71 3320,-14215.71 3320,-14163.71 3538,-14163.71 3538,-14215.71"/>
<text text-anchor="middle" x="3429" y="-14203.71" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-14192.71" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-14181.71" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-14170.71" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_46_route&#45;&gt;moe_46_expert_14 -->
<g id="edge1627" class="edge">
<title>moe_46_route&#45;&gt;moe_46_expert_14</title>
<path fill="none" stroke="black" d="M2112.77,-14287.1C2389.43,-14284.2 2881.44,-14270.94 3309.71,-14215.79"/>
<polygon fill="black" stroke="black" points="3310.35,-14219.24 3319.81,-14214.48 3309.45,-14212.29 3310.35,-14219.24"/>
</g>
<!-- moe_46_expert_15 -->
<g id="node998" class="node">
<title>moe_46_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-14215.71 3556,-14215.71 3556,-14163.71 3774,-14163.71 3774,-14215.71"/>
<text text-anchor="middle" x="3665" y="-14203.71" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-14192.71" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-14181.71" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-14170.71" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_46_route&#45;&gt;moe_46_expert_15 -->
<g id="edge1628" class="edge">
<title>moe_46_route&#45;&gt;moe_46_expert_15</title>
<path fill="none" stroke="black" d="M2110.07,-14282.56C2487.89,-14273.19 3257.25,-14250.66 3545.76,-14215.75"/>
<polygon fill="black" stroke="black" points="3546.32,-14219.21 3555.82,-14214.51 3545.46,-14212.26 3546.32,-14219.21"/>
</g>
<!-- moe_46_aggregate -->
<g id="node999" class="node">
<title>moe_46_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1777" cy="-14090.94" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1777" y="-14104.94" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1777" y="-14093.94" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1777" y="-14082.94" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1777" y="-14071.94" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_46_expert_0&#45;&gt;moe_46_aggregate -->
<g id="edge1629" class="edge">
<title>moe_46_expert_0&#45;&gt;moe_46_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-14164.93C237.15,-14164.49 240.09,-14164.09 243,-14163.71 488.12,-14132.22 1182.7,-14108.7 1547.21,-14098.12"/>
<polygon fill="black" stroke="black" points="1547.47,-14101.62 1557.36,-14097.83 1547.27,-14094.62 1547.47,-14101.62"/>
</g>
<!-- moe_46_expert_1&#45;&gt;moe_46_aggregate -->
<g id="edge1630" class="edge">
<title>moe_46_expert_1&#45;&gt;moe_46_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-14164.96C473.15,-14164.52 476.09,-14164.1 479,-14163.71 849.22,-14114.56 1283.16,-14098.96 1543.76,-14094.08"/>
<polygon fill="black" stroke="black" points="1544.17,-14097.57 1554.11,-14093.89 1544.05,-14090.57 1544.17,-14097.57"/>
</g>
<!-- moe_46_expert_2&#45;&gt;moe_46_aggregate -->
<g id="edge1631" class="edge">
<title>moe_46_expert_2&#45;&gt;moe_46_aggregate</title>
<path fill="none" stroke="black" d="M706.2,-14165.01C709.16,-14164.55 712.1,-14164.12 715,-14163.71 1000.02,-14124.09 1331.23,-14106.12 1546.98,-14098.11"/>
<polygon fill="black" stroke="black" points="1547.3,-14101.61 1557.17,-14097.74 1547.05,-14094.61 1547.3,-14101.61"/>
</g>
<!-- moe_46_expert_3&#45;&gt;moe_46_aggregate -->
<g id="edge1632" class="edge">
<title>moe_46_expert_3&#45;&gt;moe_46_aggregate</title>
<path fill="none" stroke="black" d="M942.21,-14165.09C945.16,-14164.6 948.1,-14164.14 951,-14163.71 1154.78,-14133.39 1388.89,-14114.54 1555.72,-14103.81"/>
<polygon fill="black" stroke="black" points="1556.35,-14107.28 1566.11,-14103.15 1555.91,-14100.29 1556.35,-14107.28"/>
</g>
<!-- moe_46_expert_4&#45;&gt;moe_46_aggregate -->
<g id="edge1633" class="edge">
<title>moe_46_expert_4&#45;&gt;moe_46_aggregate</title>
<path fill="none" stroke="black" d="M1178.23,-14165.22C1181.18,-14164.7 1184.11,-14164.19 1187,-14163.71 1316.69,-14142.13 1463.43,-14124.25 1578.13,-14111.74"/>
<polygon fill="black" stroke="black" points="1578.51,-14115.22 1588.07,-14110.66 1577.75,-14108.26 1578.51,-14115.22"/>
</g>
<!-- moe_46_expert_5&#45;&gt;moe_46_aggregate -->
<g id="edge1634" class="edge">
<title>moe_46_expert_5&#45;&gt;moe_46_aggregate</title>
<path fill="none" stroke="black" d="M1414.28,-14165.52C1417.22,-14164.91 1420.13,-14164.31 1423,-14163.71 1490.32,-14149.76 1564.9,-14134.59 1628.19,-14121.81"/>
<polygon fill="black" stroke="black" points="1629.13,-14125.19 1638.24,-14119.78 1627.75,-14118.33 1629.13,-14125.19"/>
</g>
<!-- moe_46_expert_6&#45;&gt;moe_46_aggregate -->
<g id="edge1635" class="edge">
<title>moe_46_expert_6&#45;&gt;moe_46_aggregate</title>
<path fill="none" stroke="black" d="M1602.08,-14163.67C1627.73,-14153.15 1658.09,-14140.7 1686.26,-14129.15"/>
<polygon fill="black" stroke="black" points="1687.79,-14132.3 1695.72,-14125.27 1685.14,-14125.83 1687.79,-14132.3"/>
</g>
<!-- moe_46_expert_7&#45;&gt;moe_46_aggregate -->
<g id="edge1636" class="edge">
<title>moe_46_expert_7&#45;&gt;moe_46_aggregate</title>
<path fill="none" stroke="black" d="M1777,-14163.54C1777,-14155.73 1777,-14146.87 1777,-14138.1"/>
<polygon fill="black" stroke="black" points="1780.5,-14137.92 1777,-14127.92 1773.5,-14137.92 1780.5,-14137.92"/>
</g>
<!-- moe_46_expert_8&#45;&gt;moe_46_aggregate -->
<g id="edge1637" class="edge">
<title>moe_46_expert_8&#45;&gt;moe_46_aggregate</title>
<path fill="none" stroke="black" d="M1951.92,-14163.67C1926.27,-14153.15 1895.91,-14140.7 1867.74,-14129.15"/>
<polygon fill="black" stroke="black" points="1868.86,-14125.83 1858.28,-14125.27 1866.21,-14132.3 1868.86,-14125.83"/>
</g>
<!-- moe_46_expert_9&#45;&gt;moe_46_aggregate -->
<g id="edge1638" class="edge">
<title>moe_46_expert_9&#45;&gt;moe_46_aggregate</title>
<path fill="none" stroke="black" d="M2139.72,-14165.52C2136.78,-14164.91 2133.87,-14164.31 2131,-14163.71 2063.68,-14149.76 1989.1,-14134.59 1925.81,-14121.81"/>
<polygon fill="black" stroke="black" points="1926.25,-14118.33 1915.76,-14119.78 1924.87,-14125.19 1926.25,-14118.33"/>
</g>
<!-- moe_46_expert_10&#45;&gt;moe_46_aggregate -->
<g id="edge1639" class="edge">
<title>moe_46_expert_10&#45;&gt;moe_46_aggregate</title>
<path fill="none" stroke="black" d="M2375.77,-14165.22C2372.82,-14164.7 2369.89,-14164.19 2367,-14163.71 2237.31,-14142.13 2090.57,-14124.25 1975.87,-14111.74"/>
<polygon fill="black" stroke="black" points="1976.25,-14108.26 1965.93,-14110.66 1975.49,-14115.22 1976.25,-14108.26"/>
</g>
<!-- moe_46_expert_11&#45;&gt;moe_46_aggregate -->
<g id="edge1640" class="edge">
<title>moe_46_expert_11&#45;&gt;moe_46_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-14165.09C2608.84,-14164.6 2605.9,-14164.14 2603,-14163.71 2399.22,-14133.39 2165.11,-14114.54 1998.28,-14103.81"/>
<polygon fill="black" stroke="black" points="1998.09,-14100.29 1987.89,-14103.15 1997.65,-14107.28 1998.09,-14100.29"/>
</g>
<!-- moe_46_expert_12&#45;&gt;moe_46_aggregate -->
<g id="edge1641" class="edge">
<title>moe_46_expert_12&#45;&gt;moe_46_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-14165.01C2844.84,-14164.55 2841.9,-14164.12 2839,-14163.71 2553.98,-14124.09 2222.77,-14106.12 2007.02,-14098.11"/>
<polygon fill="black" stroke="black" points="2006.95,-14094.61 1996.83,-14097.74 2006.7,-14101.61 2006.95,-14094.61"/>
</g>
<!-- moe_46_expert_13&#45;&gt;moe_46_aggregate -->
<g id="edge1642" class="edge">
<title>moe_46_expert_13&#45;&gt;moe_46_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-14164.96C3080.85,-14164.52 3077.91,-14164.1 3075,-14163.71 2704.78,-14114.56 2270.84,-14098.96 2010.24,-14094.08"/>
<polygon fill="black" stroke="black" points="2009.95,-14090.57 1999.89,-14093.89 2009.83,-14097.57 2009.95,-14090.57"/>
</g>
<!-- moe_46_expert_14&#45;&gt;moe_46_aggregate -->
<g id="edge1643" class="edge">
<title>moe_46_expert_14&#45;&gt;moe_46_aggregate</title>
<path fill="none" stroke="black" d="M3319.82,-14164.93C3316.85,-14164.49 3313.91,-14164.09 3311,-14163.71 3065.88,-14132.22 2371.3,-14108.7 2006.79,-14098.12"/>
<polygon fill="black" stroke="black" points="2006.73,-14094.62 1996.64,-14097.83 2006.53,-14101.62 2006.73,-14094.62"/>
</g>
<!-- moe_46_expert_15&#45;&gt;moe_46_aggregate -->
<g id="edge1644" class="edge">
<title>moe_46_expert_15&#45;&gt;moe_46_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-14164.91C3552.85,-14164.48 3549.91,-14164.08 3547,-14163.71 3256.39,-14127.3 2418.41,-14105.34 2008.44,-14096.49"/>
<polygon fill="black" stroke="black" points="2008.31,-14092.98 1998.24,-14096.27 2008.16,-14099.98 2008.31,-14092.98"/>
</g>
<!-- moe_46_ffn -->
<g id="node1000" class="node">
<title>moe_46_ffn</title>
<polygon fill="lightgreen" stroke="black" points="1935,-14018.17 1619,-14018.17 1619,-13966.17 1935,-13966.17 1935,-14018.17"/>
<text text-anchor="middle" x="1777" y="-14006.17" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1777" y="-13995.17" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-13984.17" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-13973.17" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_46_aggregate&#45;&gt;moe_46_ffn -->
<g id="edge1645" class="edge">
<title>moe_46_aggregate&#45;&gt;moe_46_ffn</title>
<path fill="none" stroke="black" d="M1777,-14053.91C1777,-14045.6 1777,-14036.76 1777,-14028.48"/>
<polygon fill="black" stroke="black" points="1780.5,-14028.37 1777,-14018.37 1773.5,-14028.37 1780.5,-14028.37"/>
</g>
<!-- moe_46_res2 -->
<g id="node1002" class="node">
<title>moe_46_res2</title>
<polygon fill="lightyellow" stroke="black" points="2113.89,-13930.17 1577.97,-13930.17 1440.11,-13826.17 1976.03,-13826.17 2113.89,-13930.17"/>
<text text-anchor="middle" x="1777" y="-13892.17" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1777" y="-13881.17" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-13870.17" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1777" y="-13859.17" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_46_ffn&#45;&gt;moe_46_res2 -->
<g id="edge1646" class="edge">
<title>moe_46_ffn&#45;&gt;moe_46_res2</title>
<path fill="none" stroke="black" d="M1777,-13966.04C1777,-13958.35 1777,-13949.54 1777,-13940.54"/>
<polygon fill="black" stroke="black" points="1780.5,-13940.35 1777,-13930.35 1773.5,-13940.35 1780.5,-13940.35"/>
</g>
<!-- moe_46_res1&#45;&gt;moe_46_gate -->
<g id="edge1611" class="edge">
<title>moe_46_res1&#45;&gt;moe_46_gate</title>
<path fill="none" stroke="black" d="M1895,-14500.87C1895,-14492.69 1895,-14484.17 1895,-14475.79"/>
<polygon fill="black" stroke="black" points="1898.5,-14475.68 1895,-14465.68 1891.5,-14475.68 1898.5,-14475.68"/>
</g>
<!-- moe_47_mha -->
<g id="node1003" class="node">
<title>moe_47_mha</title>
<polygon fill="lightgreen" stroke="black" points="1935,-13779.17 1619,-13779.17 1619,-13727.17 1935,-13727.17 1935,-13779.17"/>
<text text-anchor="middle" x="1777" y="-13767.17" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1777" y="-13756.17" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-13745.17" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-13734.17" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_46_res2&#45;&gt;moe_47_mha -->
<g id="edge1647" class="edge">
<title>moe_46_res2&#45;&gt;moe_47_mha</title>
<path fill="none" stroke="black" d="M1777,-13826.08C1777,-13813.75 1777,-13800.84 1777,-13789.42"/>
<polygon fill="black" stroke="black" points="1780.5,-13789.41 1777,-13779.41 1773.5,-13789.41 1780.5,-13789.41"/>
</g>
<!-- moe_47_res1 -->
<g id="node1024" class="node">
<title>moe_47_res1</title>
<polygon fill="lightyellow" stroke="black" points="2113.89,-13691.17 1577.97,-13691.17 1440.11,-13587.17 1976.03,-13587.17 2113.89,-13691.17"/>
<text text-anchor="middle" x="1777" y="-13653.17" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1777" y="-13642.17" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-13631.17" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1777" y="-13620.17" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_47_mha&#45;&gt;moe_47_res1 -->
<g id="edge1648" class="edge">
<title>moe_47_mha&#45;&gt;moe_47_res1</title>
<path fill="none" stroke="black" d="M1777,-13727.04C1777,-13719.35 1777,-13710.54 1777,-13701.54"/>
<polygon fill="black" stroke="black" points="1780.5,-13701.35 1777,-13691.35 1773.5,-13701.35 1780.5,-13701.35"/>
</g>
<!-- moe_47_gate -->
<g id="node1004" class="node">
<title>moe_47_gate</title>
<polygon fill="lightyellow" stroke="black" points="2105.8,-13551.17 1582.75,-13551.17 1448.2,-13447.17 1971.25,-13447.17 2105.8,-13551.17"/>
<text text-anchor="middle" x="1777" y="-13513.17" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1777" y="-13502.17" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-13491.17" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-13480.17" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_47_route -->
<g id="node1005" class="node">
<title>moe_47_route</title>
<ellipse fill="lightblue" stroke="black" cx="1777" cy="-13374.4" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1777" y="-13388.4" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1777" y="-13377.4" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1777" y="-13366.4" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-13355.4" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_47_gate&#45;&gt;moe_47_route -->
<g id="edge1650" class="edge">
<title>moe_47_gate&#45;&gt;moe_47_route</title>
<path fill="none" stroke="black" d="M1777,-13446.82C1777,-13438.41 1777,-13429.74 1777,-13421.47"/>
<polygon fill="black" stroke="black" points="1780.5,-13421.26 1777,-13411.26 1773.5,-13421.26 1780.5,-13421.26"/>
</g>
<!-- moe_47_expert_0 -->
<g id="node1006" class="node">
<title>moe_47_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-13301.63 16,-13301.63 16,-13249.63 234,-13249.63 234,-13301.63"/>
<text text-anchor="middle" x="125" y="-13289.63" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-13278.63" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-13267.63" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-13256.63" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_47_route&#45;&gt;moe_47_expert_0 -->
<g id="edge1651" class="edge">
<title>moe_47_route&#45;&gt;moe_47_expert_0</title>
<path fill="none" stroke="black" d="M1562.77,-13367.67C1207.39,-13357.45 509.65,-13334.18 244.21,-13301.67"/>
<polygon fill="black" stroke="black" points="244.54,-13298.19 234.18,-13300.42 243.67,-13305.13 244.54,-13298.19"/>
</g>
<!-- moe_47_expert_1 -->
<g id="node1007" class="node">
<title>moe_47_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-13301.63 252,-13301.63 252,-13249.63 470,-13249.63 470,-13301.63"/>
<text text-anchor="middle" x="361" y="-13289.63" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-13278.63" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-13267.63" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-13256.63" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_47_route&#45;&gt;moe_47_expert_1 -->
<g id="edge1652" class="edge">
<title>moe_47_route&#45;&gt;moe_47_expert_1</title>
<path fill="none" stroke="black" d="M1559.59,-13371.56C1303.22,-13367.05 864.4,-13352.06 480.11,-13301.69"/>
<polygon fill="black" stroke="black" points="480.56,-13298.22 470.19,-13300.38 479.64,-13305.16 480.56,-13298.22"/>
</g>
<!-- moe_47_expert_2 -->
<g id="node1008" class="node">
<title>moe_47_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-13301.63 488,-13301.63 488,-13249.63 706,-13249.63 706,-13301.63"/>
<text text-anchor="middle" x="597" y="-13289.63" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-13278.63" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-13267.63" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-13256.63" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_47_route&#45;&gt;moe_47_expert_2 -->
<g id="edge1653" class="edge">
<title>moe_47_route&#45;&gt;moe_47_expert_2</title>
<path fill="none" stroke="black" d="M1562.51,-13367.8C1349.77,-13360.18 1014.57,-13342.62 716.34,-13301.74"/>
<polygon fill="black" stroke="black" points="716.58,-13298.24 706.2,-13300.34 715.62,-13305.17 716.58,-13298.24"/>
</g>
<!-- moe_47_expert_3 -->
<g id="node1009" class="node">
<title>moe_47_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-13301.63 724,-13301.63 724,-13249.63 942,-13249.63 942,-13301.63"/>
<text text-anchor="middle" x="833" y="-13289.63" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-13278.63" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-13267.63" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-13256.63" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_47_route&#45;&gt;moe_47_expert_3 -->
<g id="edge1654" class="edge">
<title>moe_47_route&#45;&gt;moe_47_expert_3</title>
<path fill="none" stroke="black" d="M1570.82,-13362.5C1405.76,-13352.11 1168.32,-13333.46 952.16,-13301.73"/>
<polygon fill="black" stroke="black" points="952.61,-13298.26 942.21,-13300.26 951.59,-13305.19 952.61,-13298.26"/>
</g>
<!-- moe_47_expert_4 -->
<g id="node1010" class="node">
<title>moe_47_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-13301.63 960,-13301.63 960,-13249.63 1178,-13249.63 1178,-13301.63"/>
<text text-anchor="middle" x="1069" y="-13289.63" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-13278.63" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-13267.63" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-13256.63" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_47_route&#45;&gt;moe_47_expert_4 -->
<g id="edge1655" class="edge">
<title>moe_47_route&#45;&gt;moe_47_expert_4</title>
<path fill="none" stroke="black" d="M1591.38,-13355.05C1477.62,-13342.78 1328.9,-13324.92 1188.33,-13301.8"/>
<polygon fill="black" stroke="black" points="1188.66,-13298.31 1178.23,-13300.13 1187.52,-13305.21 1188.66,-13298.31"/>
</g>
<!-- moe_47_expert_5 -->
<g id="node1011" class="node">
<title>moe_47_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-13301.63 1196,-13301.63 1196,-13249.63 1414,-13249.63 1414,-13301.63"/>
<text text-anchor="middle" x="1305" y="-13289.63" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-13278.63" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-13267.63" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-13256.63" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_47_route&#45;&gt;moe_47_expert_5 -->
<g id="edge1656" class="edge">
<title>moe_47_route&#45;&gt;moe_47_expert_5</title>
<path fill="none" stroke="black" d="M1639.51,-13345.82C1576.62,-13333.13 1500.88,-13317.75 1424.14,-13301.86"/>
<polygon fill="black" stroke="black" points="1424.79,-13298.42 1414.28,-13299.82 1423.37,-13305.28 1424.79,-13298.42"/>
</g>
<!-- moe_47_expert_6 -->
<g id="node1012" class="node">
<title>moe_47_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-13301.63 1432,-13301.63 1432,-13249.63 1650,-13249.63 1650,-13301.63"/>
<text text-anchor="middle" x="1541" y="-13289.63" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-13278.63" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-13267.63" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-13256.63" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_47_route&#45;&gt;moe_47_expert_6 -->
<g id="edge1657" class="edge">
<title>moe_47_route&#45;&gt;moe_47_expert_6</title>
<path fill="none" stroke="black" d="M1696.11,-13340.24C1668.54,-13328.93 1637.96,-13316.39 1611.29,-13305.45"/>
<polygon fill="black" stroke="black" points="1612.61,-13302.21 1602.03,-13301.66 1609.95,-13308.69 1612.61,-13302.21"/>
</g>
<!-- moe_47_expert_7 -->
<g id="node1013" class="node">
<title>moe_47_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-13301.63 1668,-13301.63 1668,-13249.63 1886,-13249.63 1886,-13301.63"/>
<text text-anchor="middle" x="1777" y="-13289.63" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-13278.63" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-13267.63" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-13256.63" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_47_route&#45;&gt;moe_47_expert_7 -->
<g id="edge1658" class="edge">
<title>moe_47_route&#45;&gt;moe_47_expert_7</title>
<path fill="none" stroke="black" d="M1777,-13337.37C1777,-13329.06 1777,-13320.22 1777,-13311.94"/>
<polygon fill="black" stroke="black" points="1780.5,-13311.83 1777,-13301.83 1773.5,-13311.83 1780.5,-13311.83"/>
</g>
<!-- moe_47_expert_8 -->
<g id="node1014" class="node">
<title>moe_47_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-13301.63 1904,-13301.63 1904,-13249.63 2122,-13249.63 2122,-13301.63"/>
<text text-anchor="middle" x="2013" y="-13289.63" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-13278.63" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-13267.63" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-13256.63" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_47_route&#45;&gt;moe_47_expert_8 -->
<g id="edge1659" class="edge">
<title>moe_47_route&#45;&gt;moe_47_expert_8</title>
<path fill="none" stroke="black" d="M1857.89,-13340.24C1885.46,-13328.93 1916.04,-13316.39 1942.71,-13305.45"/>
<polygon fill="black" stroke="black" points="1944.05,-13308.69 1951.97,-13301.66 1941.39,-13302.21 1944.05,-13308.69"/>
</g>
<!-- moe_47_expert_9 -->
<g id="node1015" class="node">
<title>moe_47_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-13301.63 2140,-13301.63 2140,-13249.63 2358,-13249.63 2358,-13301.63"/>
<text text-anchor="middle" x="2249" y="-13289.63" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-13278.63" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-13267.63" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-13256.63" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_47_route&#45;&gt;moe_47_expert_9 -->
<g id="edge1660" class="edge">
<title>moe_47_route&#45;&gt;moe_47_expert_9</title>
<path fill="none" stroke="black" d="M1914.49,-13345.82C1977.38,-13333.13 2053.12,-13317.75 2129.86,-13301.86"/>
<polygon fill="black" stroke="black" points="2130.63,-13305.28 2139.72,-13299.82 2129.21,-13298.42 2130.63,-13305.28"/>
</g>
<!-- moe_47_expert_10 -->
<g id="node1016" class="node">
<title>moe_47_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-13301.63 2376,-13301.63 2376,-13249.63 2594,-13249.63 2594,-13301.63"/>
<text text-anchor="middle" x="2485" y="-13289.63" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-13278.63" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-13267.63" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-13256.63" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_47_route&#45;&gt;moe_47_expert_10 -->
<g id="edge1661" class="edge">
<title>moe_47_route&#45;&gt;moe_47_expert_10</title>
<path fill="none" stroke="black" d="M1962.62,-13355.05C2076.38,-13342.78 2225.1,-13324.92 2365.67,-13301.8"/>
<polygon fill="black" stroke="black" points="2366.48,-13305.21 2375.77,-13300.13 2365.34,-13298.31 2366.48,-13305.21"/>
</g>
<!-- moe_47_expert_11 -->
<g id="node1017" class="node">
<title>moe_47_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-13301.63 2612,-13301.63 2612,-13249.63 2830,-13249.63 2830,-13301.63"/>
<text text-anchor="middle" x="2721" y="-13289.63" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-13278.63" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-13267.63" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-13256.63" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_47_route&#45;&gt;moe_47_expert_11 -->
<g id="edge1662" class="edge">
<title>moe_47_route&#45;&gt;moe_47_expert_11</title>
<path fill="none" stroke="black" d="M1983.18,-13362.5C2148.24,-13352.11 2385.68,-13333.46 2601.84,-13301.73"/>
<polygon fill="black" stroke="black" points="2602.41,-13305.19 2611.79,-13300.26 2601.39,-13298.26 2602.41,-13305.19"/>
</g>
<!-- moe_47_expert_12 -->
<g id="node1018" class="node">
<title>moe_47_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-13301.63 2848,-13301.63 2848,-13249.63 3066,-13249.63 3066,-13301.63"/>
<text text-anchor="middle" x="2957" y="-13289.63" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-13278.63" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-13267.63" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-13256.63" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_47_route&#45;&gt;moe_47_expert_12 -->
<g id="edge1663" class="edge">
<title>moe_47_route&#45;&gt;moe_47_expert_12</title>
<path fill="none" stroke="black" d="M1991.49,-13367.8C2204.23,-13360.18 2539.43,-13342.62 2837.66,-13301.74"/>
<polygon fill="black" stroke="black" points="2838.38,-13305.17 2847.8,-13300.34 2837.42,-13298.24 2838.38,-13305.17"/>
</g>
<!-- moe_47_expert_13 -->
<g id="node1019" class="node">
<title>moe_47_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-13301.63 3084,-13301.63 3084,-13249.63 3302,-13249.63 3302,-13301.63"/>
<text text-anchor="middle" x="3193" y="-13289.63" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-13278.63" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-13267.63" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-13256.63" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_47_route&#45;&gt;moe_47_expert_13 -->
<g id="edge1664" class="edge">
<title>moe_47_route&#45;&gt;moe_47_expert_13</title>
<path fill="none" stroke="black" d="M1994.41,-13371.56C2250.78,-13367.05 2689.6,-13352.06 3073.89,-13301.69"/>
<polygon fill="black" stroke="black" points="3074.36,-13305.16 3083.81,-13300.38 3073.44,-13298.22 3074.36,-13305.16"/>
</g>
<!-- moe_47_expert_14 -->
<g id="node1020" class="node">
<title>moe_47_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-13301.63 3320,-13301.63 3320,-13249.63 3538,-13249.63 3538,-13301.63"/>
<text text-anchor="middle" x="3429" y="-13289.63" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-13278.63" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-13267.63" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-13256.63" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_47_route&#45;&gt;moe_47_expert_14 -->
<g id="edge1665" class="edge">
<title>moe_47_route&#45;&gt;moe_47_expert_14</title>
<path fill="none" stroke="black" d="M1991.23,-13367.67C2346.61,-13357.45 3044.35,-13334.18 3309.79,-13301.67"/>
<polygon fill="black" stroke="black" points="3310.33,-13305.13 3319.82,-13300.42 3309.46,-13298.19 3310.33,-13305.13"/>
</g>
<!-- moe_47_expert_15 -->
<g id="node1021" class="node">
<title>moe_47_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-13301.63 3556,-13301.63 3556,-13249.63 3774,-13249.63 3774,-13301.63"/>
<text text-anchor="middle" x="3665" y="-13289.63" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-13278.63" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-13267.63" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-13256.63" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_47_route&#45;&gt;moe_47_expert_15 -->
<g id="edge1666" class="edge">
<title>moe_47_route&#45;&gt;moe_47_expert_15</title>
<path fill="none" stroke="black" d="M1992.71,-13369.2C2392.25,-13360.67 3234.28,-13338.99 3545.86,-13301.66"/>
<polygon fill="black" stroke="black" points="3546.32,-13305.13 3555.82,-13300.44 3545.47,-13298.18 3546.32,-13305.13"/>
</g>
<!-- moe_47_aggregate -->
<g id="node1022" class="node">
<title>moe_47_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1777" cy="-13176.86" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1777" y="-13190.86" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1777" y="-13179.86" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1777" y="-13168.86" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1777" y="-13157.86" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_47_expert_0&#45;&gt;moe_47_aggregate -->
<g id="edge1667" class="edge">
<title>moe_47_expert_0&#45;&gt;moe_47_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-13250.85C237.15,-13250.42 240.09,-13250.01 243,-13249.63 488.12,-13218.15 1182.7,-13194.63 1547.21,-13184.05"/>
<polygon fill="black" stroke="black" points="1547.47,-13187.54 1557.36,-13183.75 1547.27,-13180.54 1547.47,-13187.54"/>
</g>
<!-- moe_47_expert_1&#45;&gt;moe_47_aggregate -->
<g id="edge1668" class="edge">
<title>moe_47_expert_1&#45;&gt;moe_47_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-13250.88C473.15,-13250.44 476.09,-13250.02 479,-13249.63 849.22,-13200.48 1283.16,-13184.88 1543.76,-13180"/>
<polygon fill="black" stroke="black" points="1544.17,-13183.49 1554.11,-13179.81 1544.05,-13176.49 1544.17,-13183.49"/>
</g>
<!-- moe_47_expert_2&#45;&gt;moe_47_aggregate -->
<g id="edge1669" class="edge">
<title>moe_47_expert_2&#45;&gt;moe_47_aggregate</title>
<path fill="none" stroke="black" d="M706.2,-13250.93C709.16,-13250.47 712.1,-13250.04 715,-13249.63 1000.02,-13210.01 1331.23,-13192.04 1546.98,-13184.04"/>
<polygon fill="black" stroke="black" points="1547.3,-13187.53 1557.17,-13183.66 1547.05,-13180.53 1547.3,-13187.53"/>
</g>
<!-- moe_47_expert_3&#45;&gt;moe_47_aggregate -->
<g id="edge1670" class="edge">
<title>moe_47_expert_3&#45;&gt;moe_47_aggregate</title>
<path fill="none" stroke="black" d="M942.21,-13251.01C945.16,-13250.52 948.1,-13250.07 951,-13249.63 1154.78,-13219.31 1388.89,-13200.46 1555.72,-13189.73"/>
<polygon fill="black" stroke="black" points="1556.35,-13193.2 1566.11,-13189.07 1555.91,-13186.21 1556.35,-13193.2"/>
</g>
<!-- moe_47_expert_4&#45;&gt;moe_47_aggregate -->
<g id="edge1671" class="edge">
<title>moe_47_expert_4&#45;&gt;moe_47_aggregate</title>
<path fill="none" stroke="black" d="M1178.23,-13251.14C1181.18,-13250.62 1184.11,-13250.12 1187,-13249.63 1316.69,-13228.05 1463.43,-13210.17 1578.13,-13197.66"/>
<polygon fill="black" stroke="black" points="1578.51,-13201.14 1588.07,-13196.58 1577.75,-13194.18 1578.51,-13201.14"/>
</g>
<!-- moe_47_expert_5&#45;&gt;moe_47_aggregate -->
<g id="edge1672" class="edge">
<title>moe_47_expert_5&#45;&gt;moe_47_aggregate</title>
<path fill="none" stroke="black" d="M1414.28,-13251.45C1417.22,-13250.83 1420.13,-13250.23 1423,-13249.63 1490.32,-13235.68 1564.9,-13220.51 1628.19,-13207.73"/>
<polygon fill="black" stroke="black" points="1629.13,-13211.11 1638.24,-13205.7 1627.75,-13204.25 1629.13,-13211.11"/>
</g>
<!-- moe_47_expert_6&#45;&gt;moe_47_aggregate -->
<g id="edge1673" class="edge">
<title>moe_47_expert_6&#45;&gt;moe_47_aggregate</title>
<path fill="none" stroke="black" d="M1602.08,-13249.59C1627.73,-13239.07 1658.09,-13226.62 1686.26,-13215.07"/>
<polygon fill="black" stroke="black" points="1687.79,-13218.23 1695.72,-13211.19 1685.14,-13211.75 1687.79,-13218.23"/>
</g>
<!-- moe_47_expert_7&#45;&gt;moe_47_aggregate -->
<g id="edge1674" class="edge">
<title>moe_47_expert_7&#45;&gt;moe_47_aggregate</title>
<path fill="none" stroke="black" d="M1777,-13249.46C1777,-13241.65 1777,-13232.79 1777,-13224.02"/>
<polygon fill="black" stroke="black" points="1780.5,-13223.84 1777,-13213.84 1773.5,-13223.84 1780.5,-13223.84"/>
</g>
<!-- moe_47_expert_8&#45;&gt;moe_47_aggregate -->
<g id="edge1675" class="edge">
<title>moe_47_expert_8&#45;&gt;moe_47_aggregate</title>
<path fill="none" stroke="black" d="M1951.92,-13249.59C1926.27,-13239.07 1895.91,-13226.62 1867.74,-13215.07"/>
<polygon fill="black" stroke="black" points="1868.86,-13211.75 1858.28,-13211.19 1866.21,-13218.23 1868.86,-13211.75"/>
</g>
<!-- moe_47_expert_9&#45;&gt;moe_47_aggregate -->
<g id="edge1676" class="edge">
<title>moe_47_expert_9&#45;&gt;moe_47_aggregate</title>
<path fill="none" stroke="black" d="M2139.72,-13251.45C2136.78,-13250.83 2133.87,-13250.23 2131,-13249.63 2063.68,-13235.68 1989.1,-13220.51 1925.81,-13207.73"/>
<polygon fill="black" stroke="black" points="1926.25,-13204.25 1915.76,-13205.7 1924.87,-13211.11 1926.25,-13204.25"/>
</g>
<!-- moe_47_expert_10&#45;&gt;moe_47_aggregate -->
<g id="edge1677" class="edge">
<title>moe_47_expert_10&#45;&gt;moe_47_aggregate</title>
<path fill="none" stroke="black" d="M2375.77,-13251.14C2372.82,-13250.62 2369.89,-13250.12 2367,-13249.63 2237.31,-13228.05 2090.57,-13210.17 1975.87,-13197.66"/>
<polygon fill="black" stroke="black" points="1976.25,-13194.18 1965.93,-13196.58 1975.49,-13201.14 1976.25,-13194.18"/>
</g>
<!-- moe_47_expert_11&#45;&gt;moe_47_aggregate -->
<g id="edge1678" class="edge">
<title>moe_47_expert_11&#45;&gt;moe_47_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-13251.01C2608.84,-13250.52 2605.9,-13250.07 2603,-13249.63 2399.22,-13219.31 2165.11,-13200.46 1998.28,-13189.73"/>
<polygon fill="black" stroke="black" points="1998.09,-13186.21 1987.89,-13189.07 1997.65,-13193.2 1998.09,-13186.21"/>
</g>
<!-- moe_47_expert_12&#45;&gt;moe_47_aggregate -->
<g id="edge1679" class="edge">
<title>moe_47_expert_12&#45;&gt;moe_47_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-13250.93C2844.84,-13250.47 2841.9,-13250.04 2839,-13249.63 2553.98,-13210.01 2222.77,-13192.04 2007.02,-13184.04"/>
<polygon fill="black" stroke="black" points="2006.95,-13180.53 1996.83,-13183.66 2006.7,-13187.53 2006.95,-13180.53"/>
</g>
<!-- moe_47_expert_13&#45;&gt;moe_47_aggregate -->
<g id="edge1680" class="edge">
<title>moe_47_expert_13&#45;&gt;moe_47_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-13250.88C3080.85,-13250.44 3077.91,-13250.02 3075,-13249.63 2704.78,-13200.48 2270.84,-13184.88 2010.24,-13180"/>
<polygon fill="black" stroke="black" points="2009.95,-13176.49 1999.89,-13179.81 2009.83,-13183.49 2009.95,-13176.49"/>
</g>
<!-- moe_47_expert_14&#45;&gt;moe_47_aggregate -->
<g id="edge1681" class="edge">
<title>moe_47_expert_14&#45;&gt;moe_47_aggregate</title>
<path fill="none" stroke="black" d="M3319.82,-13250.85C3316.85,-13250.42 3313.91,-13250.01 3311,-13249.63 3065.88,-13218.15 2371.3,-13194.63 2006.79,-13184.05"/>
<polygon fill="black" stroke="black" points="2006.73,-13180.54 1996.64,-13183.75 2006.53,-13187.54 2006.73,-13180.54"/>
</g>
<!-- moe_47_expert_15&#45;&gt;moe_47_aggregate -->
<g id="edge1682" class="edge">
<title>moe_47_expert_15&#45;&gt;moe_47_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-13250.83C3552.85,-13250.4 3549.91,-13250 3547,-13249.63 3256.39,-13213.22 2418.41,-13191.26 2008.44,-13182.41"/>
<polygon fill="black" stroke="black" points="2008.31,-13178.9 1998.24,-13182.19 2008.16,-13185.9 2008.31,-13178.9"/>
</g>
<!-- moe_47_ffn -->
<g id="node1023" class="node">
<title>moe_47_ffn</title>
<polygon fill="lightgreen" stroke="black" points="1935,-13104.09 1619,-13104.09 1619,-13052.09 1935,-13052.09 1935,-13104.09"/>
<text text-anchor="middle" x="1777" y="-13092.09" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1777" y="-13081.09" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-13070.09" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-13059.09" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_47_aggregate&#45;&gt;moe_47_ffn -->
<g id="edge1683" class="edge">
<title>moe_47_aggregate&#45;&gt;moe_47_ffn</title>
<path fill="none" stroke="black" d="M1777,-13139.83C1777,-13131.52 1777,-13122.69 1777,-13114.4"/>
<polygon fill="black" stroke="black" points="1780.5,-13114.29 1777,-13104.29 1773.5,-13114.29 1780.5,-13114.29"/>
</g>
<!-- moe_47_res2 -->
<g id="node1025" class="node">
<title>moe_47_res2</title>
<polygon fill="lightyellow" stroke="black" points="2113.89,-13016.09 1577.97,-13016.09 1440.11,-12912.09 1976.03,-12912.09 2113.89,-13016.09"/>
<text text-anchor="middle" x="1777" y="-12978.09" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1777" y="-12967.09" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-12956.09" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1777" y="-12945.09" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_47_ffn&#45;&gt;moe_47_res2 -->
<g id="edge1684" class="edge">
<title>moe_47_ffn&#45;&gt;moe_47_res2</title>
<path fill="none" stroke="black" d="M1777,-13051.96C1777,-13044.28 1777,-13035.46 1777,-13026.46"/>
<polygon fill="black" stroke="black" points="1780.5,-13026.27 1777,-13016.27 1773.5,-13026.27 1780.5,-13026.27"/>
</g>
<!-- moe_47_res1&#45;&gt;moe_47_gate -->
<g id="edge1649" class="edge">
<title>moe_47_res1&#45;&gt;moe_47_gate</title>
<path fill="none" stroke="black" d="M1777,-13586.79C1777,-13578.62 1777,-13570.09 1777,-13561.71"/>
<polygon fill="black" stroke="black" points="1780.5,-13561.6 1777,-13551.6 1773.5,-13561.6 1780.5,-13561.6"/>
</g>
<!-- moe_48_mha -->
<g id="node1026" class="node">
<title>moe_48_mha</title>
<polygon fill="lightgreen" stroke="black" points="1935,-12865.09 1619,-12865.09 1619,-12813.09 1935,-12813.09 1935,-12865.09"/>
<text text-anchor="middle" x="1777" y="-12853.09" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1777" y="-12842.09" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-12831.09" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-12820.09" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_47_res2&#45;&gt;moe_48_mha -->
<g id="edge1685" class="edge">
<title>moe_47_res2&#45;&gt;moe_48_mha</title>
<path fill="none" stroke="black" d="M1777,-12912C1777,-12899.67 1777,-12886.76 1777,-12875.35"/>
<polygon fill="black" stroke="black" points="1780.5,-12875.34 1777,-12865.34 1773.5,-12875.34 1780.5,-12875.34"/>
</g>
<!-- moe_48_res1 -->
<g id="node1047" class="node">
<title>moe_48_res1</title>
<polygon fill="lightyellow" stroke="black" points="2113.89,-12777.09 1577.97,-12777.09 1440.11,-12673.09 1976.03,-12673.09 2113.89,-12777.09"/>
<text text-anchor="middle" x="1777" y="-12739.09" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1777" y="-12728.09" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-12717.09" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1777" y="-12706.09" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_48_mha&#45;&gt;moe_48_res1 -->
<g id="edge1686" class="edge">
<title>moe_48_mha&#45;&gt;moe_48_res1</title>
<path fill="none" stroke="black" d="M1777,-12812.96C1777,-12805.28 1777,-12796.46 1777,-12787.46"/>
<polygon fill="black" stroke="black" points="1780.5,-12787.27 1777,-12777.27 1773.5,-12787.27 1780.5,-12787.27"/>
</g>
<!-- moe_48_gate -->
<g id="node1027" class="node">
<title>moe_48_gate</title>
<polygon fill="lightyellow" stroke="black" points="2105.8,-12637.09 1582.75,-12637.09 1448.2,-12533.09 1971.25,-12533.09 2105.8,-12637.09"/>
<text text-anchor="middle" x="1777" y="-12599.09" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1777" y="-12588.09" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-12577.09" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-12566.09" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_48_route -->
<g id="node1028" class="node">
<title>moe_48_route</title>
<ellipse fill="lightblue" stroke="black" cx="1777" cy="-12460.33" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1777" y="-12474.33" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1777" y="-12463.33" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1777" y="-12452.33" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-12441.33" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_48_gate&#45;&gt;moe_48_route -->
<g id="edge1688" class="edge">
<title>moe_48_gate&#45;&gt;moe_48_route</title>
<path fill="none" stroke="black" d="M1777,-12532.74C1777,-12524.33 1777,-12515.67 1777,-12507.4"/>
<polygon fill="black" stroke="black" points="1780.5,-12507.18 1777,-12497.18 1773.5,-12507.18 1780.5,-12507.18"/>
</g>
<!-- moe_48_expert_0 -->
<g id="node1029" class="node">
<title>moe_48_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-12387.56 16,-12387.56 16,-12335.56 234,-12335.56 234,-12387.56"/>
<text text-anchor="middle" x="125" y="-12375.56" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-12364.56" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-12353.56" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-12342.56" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_48_route&#45;&gt;moe_48_expert_0 -->
<g id="edge1689" class="edge">
<title>moe_48_route&#45;&gt;moe_48_expert_0</title>
<path fill="none" stroke="black" d="M1562.77,-12453.59C1207.39,-12443.37 509.65,-12420.1 244.21,-12387.6"/>
<polygon fill="black" stroke="black" points="244.54,-12384.11 234.18,-12386.34 243.67,-12391.06 244.54,-12384.11"/>
</g>
<!-- moe_48_expert_1 -->
<g id="node1030" class="node">
<title>moe_48_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-12387.56 252,-12387.56 252,-12335.56 470,-12335.56 470,-12387.56"/>
<text text-anchor="middle" x="361" y="-12375.56" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-12364.56" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-12353.56" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-12342.56" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_48_route&#45;&gt;moe_48_expert_1 -->
<g id="edge1690" class="edge">
<title>moe_48_route&#45;&gt;moe_48_expert_1</title>
<path fill="none" stroke="black" d="M1559.59,-12457.48C1303.22,-12452.97 864.4,-12437.98 480.11,-12387.62"/>
<polygon fill="black" stroke="black" points="480.56,-12384.14 470.19,-12386.31 479.64,-12391.08 480.56,-12384.14"/>
</g>
<!-- moe_48_expert_2 -->
<g id="node1031" class="node">
<title>moe_48_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-12387.56 488,-12387.56 488,-12335.56 706,-12335.56 706,-12387.56"/>
<text text-anchor="middle" x="597" y="-12375.56" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-12364.56" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-12353.56" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-12342.56" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_48_route&#45;&gt;moe_48_expert_2 -->
<g id="edge1691" class="edge">
<title>moe_48_route&#45;&gt;moe_48_expert_2</title>
<path fill="none" stroke="black" d="M1562.51,-12453.72C1349.77,-12446.1 1014.57,-12428.54 716.34,-12387.66"/>
<polygon fill="black" stroke="black" points="716.58,-12384.16 706.2,-12386.26 715.62,-12391.09 716.58,-12384.16"/>
</g>
<!-- moe_48_expert_3 -->
<g id="node1032" class="node">
<title>moe_48_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-12387.56 724,-12387.56 724,-12335.56 942,-12335.56 942,-12387.56"/>
<text text-anchor="middle" x="833" y="-12375.56" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-12364.56" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-12353.56" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-12342.56" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_48_route&#45;&gt;moe_48_expert_3 -->
<g id="edge1692" class="edge">
<title>moe_48_route&#45;&gt;moe_48_expert_3</title>
<path fill="none" stroke="black" d="M1570.82,-12448.42C1405.76,-12438.03 1168.32,-12419.38 952.16,-12387.66"/>
<polygon fill="black" stroke="black" points="952.61,-12384.18 942.21,-12386.18 951.59,-12391.11 952.61,-12384.18"/>
</g>
<!-- moe_48_expert_4 -->
<g id="node1033" class="node">
<title>moe_48_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-12387.56 960,-12387.56 960,-12335.56 1178,-12335.56 1178,-12387.56"/>
<text text-anchor="middle" x="1069" y="-12375.56" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-12364.56" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-12353.56" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-12342.56" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_48_route&#45;&gt;moe_48_expert_4 -->
<g id="edge1693" class="edge">
<title>moe_48_route&#45;&gt;moe_48_expert_4</title>
<path fill="none" stroke="black" d="M1591.38,-12440.97C1477.62,-12428.7 1328.9,-12410.84 1188.33,-12387.72"/>
<polygon fill="black" stroke="black" points="1188.66,-12384.23 1178.23,-12386.05 1187.52,-12391.14 1188.66,-12384.23"/>
</g>
<!-- moe_48_expert_5 -->
<g id="node1034" class="node">
<title>moe_48_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-12387.56 1196,-12387.56 1196,-12335.56 1414,-12335.56 1414,-12387.56"/>
<text text-anchor="middle" x="1305" y="-12375.56" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-12364.56" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-12353.56" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-12342.56" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_48_route&#45;&gt;moe_48_expert_5 -->
<g id="edge1694" class="edge">
<title>moe_48_route&#45;&gt;moe_48_expert_5</title>
<path fill="none" stroke="black" d="M1639.51,-12431.74C1576.62,-12419.05 1500.88,-12403.67 1424.14,-12387.79"/>
<polygon fill="black" stroke="black" points="1424.79,-12384.35 1414.28,-12385.74 1423.37,-12391.2 1424.79,-12384.35"/>
</g>
<!-- moe_48_expert_6 -->
<g id="node1035" class="node">
<title>moe_48_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-12387.56 1432,-12387.56 1432,-12335.56 1650,-12335.56 1650,-12387.56"/>
<text text-anchor="middle" x="1541" y="-12375.56" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-12364.56" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-12353.56" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-12342.56" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_48_route&#45;&gt;moe_48_expert_6 -->
<g id="edge1695" class="edge">
<title>moe_48_route&#45;&gt;moe_48_expert_6</title>
<path fill="none" stroke="black" d="M1696.11,-12426.16C1668.54,-12414.85 1637.96,-12402.31 1611.29,-12391.38"/>
<polygon fill="black" stroke="black" points="1612.61,-12388.14 1602.03,-12387.58 1609.95,-12394.61 1612.61,-12388.14"/>
</g>
<!-- moe_48_expert_7 -->
<g id="node1036" class="node">
<title>moe_48_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-12387.56 1668,-12387.56 1668,-12335.56 1886,-12335.56 1886,-12387.56"/>
<text text-anchor="middle" x="1777" y="-12375.56" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-12364.56" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-12353.56" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-12342.56" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_48_route&#45;&gt;moe_48_expert_7 -->
<g id="edge1696" class="edge">
<title>moe_48_route&#45;&gt;moe_48_expert_7</title>
<path fill="none" stroke="black" d="M1777,-12423.29C1777,-12414.98 1777,-12406.15 1777,-12397.87"/>
<polygon fill="black" stroke="black" points="1780.5,-12397.75 1777,-12387.75 1773.5,-12397.75 1780.5,-12397.75"/>
</g>
<!-- moe_48_expert_8 -->
<g id="node1037" class="node">
<title>moe_48_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-12387.56 1904,-12387.56 1904,-12335.56 2122,-12335.56 2122,-12387.56"/>
<text text-anchor="middle" x="2013" y="-12375.56" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-12364.56" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-12353.56" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-12342.56" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_48_route&#45;&gt;moe_48_expert_8 -->
<g id="edge1697" class="edge">
<title>moe_48_route&#45;&gt;moe_48_expert_8</title>
<path fill="none" stroke="black" d="M1857.89,-12426.16C1885.46,-12414.85 1916.04,-12402.31 1942.71,-12391.38"/>
<polygon fill="black" stroke="black" points="1944.05,-12394.61 1951.97,-12387.58 1941.39,-12388.14 1944.05,-12394.61"/>
</g>
<!-- moe_48_expert_9 -->
<g id="node1038" class="node">
<title>moe_48_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-12387.56 2140,-12387.56 2140,-12335.56 2358,-12335.56 2358,-12387.56"/>
<text text-anchor="middle" x="2249" y="-12375.56" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-12364.56" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-12353.56" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-12342.56" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_48_route&#45;&gt;moe_48_expert_9 -->
<g id="edge1698" class="edge">
<title>moe_48_route&#45;&gt;moe_48_expert_9</title>
<path fill="none" stroke="black" d="M1914.49,-12431.74C1977.38,-12419.05 2053.12,-12403.67 2129.86,-12387.79"/>
<polygon fill="black" stroke="black" points="2130.63,-12391.2 2139.72,-12385.74 2129.21,-12384.35 2130.63,-12391.2"/>
</g>
<!-- moe_48_expert_10 -->
<g id="node1039" class="node">
<title>moe_48_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-12387.56 2376,-12387.56 2376,-12335.56 2594,-12335.56 2594,-12387.56"/>
<text text-anchor="middle" x="2485" y="-12375.56" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-12364.56" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-12353.56" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-12342.56" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_48_route&#45;&gt;moe_48_expert_10 -->
<g id="edge1699" class="edge">
<title>moe_48_route&#45;&gt;moe_48_expert_10</title>
<path fill="none" stroke="black" d="M1962.62,-12440.97C2076.38,-12428.7 2225.1,-12410.84 2365.67,-12387.72"/>
<polygon fill="black" stroke="black" points="2366.48,-12391.14 2375.77,-12386.05 2365.34,-12384.23 2366.48,-12391.14"/>
</g>
<!-- moe_48_expert_11 -->
<g id="node1040" class="node">
<title>moe_48_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-12387.56 2612,-12387.56 2612,-12335.56 2830,-12335.56 2830,-12387.56"/>
<text text-anchor="middle" x="2721" y="-12375.56" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-12364.56" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-12353.56" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-12342.56" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_48_route&#45;&gt;moe_48_expert_11 -->
<g id="edge1700" class="edge">
<title>moe_48_route&#45;&gt;moe_48_expert_11</title>
<path fill="none" stroke="black" d="M1983.18,-12448.42C2148.24,-12438.03 2385.68,-12419.38 2601.84,-12387.66"/>
<polygon fill="black" stroke="black" points="2602.41,-12391.11 2611.79,-12386.18 2601.39,-12384.18 2602.41,-12391.11"/>
</g>
<!-- moe_48_expert_12 -->
<g id="node1041" class="node">
<title>moe_48_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-12387.56 2848,-12387.56 2848,-12335.56 3066,-12335.56 3066,-12387.56"/>
<text text-anchor="middle" x="2957" y="-12375.56" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-12364.56" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-12353.56" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-12342.56" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_48_route&#45;&gt;moe_48_expert_12 -->
<g id="edge1701" class="edge">
<title>moe_48_route&#45;&gt;moe_48_expert_12</title>
<path fill="none" stroke="black" d="M1991.49,-12453.72C2204.23,-12446.1 2539.43,-12428.54 2837.66,-12387.66"/>
<polygon fill="black" stroke="black" points="2838.38,-12391.09 2847.8,-12386.26 2837.42,-12384.16 2838.38,-12391.09"/>
</g>
<!-- moe_48_expert_13 -->
<g id="node1042" class="node">
<title>moe_48_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-12387.56 3084,-12387.56 3084,-12335.56 3302,-12335.56 3302,-12387.56"/>
<text text-anchor="middle" x="3193" y="-12375.56" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-12364.56" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-12353.56" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-12342.56" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_48_route&#45;&gt;moe_48_expert_13 -->
<g id="edge1702" class="edge">
<title>moe_48_route&#45;&gt;moe_48_expert_13</title>
<path fill="none" stroke="black" d="M1994.41,-12457.48C2250.78,-12452.97 2689.6,-12437.98 3073.89,-12387.62"/>
<polygon fill="black" stroke="black" points="3074.36,-12391.08 3083.81,-12386.31 3073.44,-12384.14 3074.36,-12391.08"/>
</g>
<!-- moe_48_expert_14 -->
<g id="node1043" class="node">
<title>moe_48_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-12387.56 3320,-12387.56 3320,-12335.56 3538,-12335.56 3538,-12387.56"/>
<text text-anchor="middle" x="3429" y="-12375.56" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-12364.56" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-12353.56" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-12342.56" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_48_route&#45;&gt;moe_48_expert_14 -->
<g id="edge1703" class="edge">
<title>moe_48_route&#45;&gt;moe_48_expert_14</title>
<path fill="none" stroke="black" d="M1991.23,-12453.59C2346.61,-12443.37 3044.35,-12420.1 3309.79,-12387.6"/>
<polygon fill="black" stroke="black" points="3310.33,-12391.06 3319.82,-12386.34 3309.46,-12384.11 3310.33,-12391.06"/>
</g>
<!-- moe_48_expert_15 -->
<g id="node1044" class="node">
<title>moe_48_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-12387.56 3556,-12387.56 3556,-12335.56 3774,-12335.56 3774,-12387.56"/>
<text text-anchor="middle" x="3665" y="-12375.56" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-12364.56" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-12353.56" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-12342.56" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_48_route&#45;&gt;moe_48_expert_15 -->
<g id="edge1704" class="edge">
<title>moe_48_route&#45;&gt;moe_48_expert_15</title>
<path fill="none" stroke="black" d="M1992.71,-12455.12C2392.25,-12446.59 3234.28,-12424.91 3545.86,-12387.58"/>
<polygon fill="black" stroke="black" points="3546.32,-12391.05 3555.82,-12386.36 3545.47,-12384.11 3546.32,-12391.05"/>
</g>
<!-- moe_48_aggregate -->
<g id="node1045" class="node">
<title>moe_48_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-12262.79" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-12276.79" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1895" y="-12265.79" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-12254.79" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1895" y="-12243.79" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_48_expert_0&#45;&gt;moe_48_aggregate -->
<g id="edge1705" class="edge">
<title>moe_48_expert_0&#45;&gt;moe_48_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-12336.76C237.15,-12336.33 240.09,-12335.92 243,-12335.56 510.74,-12301.61 1276.32,-12278.82 1664.04,-12269.1"/>
<polygon fill="black" stroke="black" points="1664.35,-12272.59 1674.26,-12268.85 1664.17,-12265.6 1664.35,-12272.59"/>
</g>
<!-- moe_48_expert_1&#45;&gt;moe_48_aggregate -->
<g id="edge1706" class="edge">
<title>moe_48_expert_1&#45;&gt;moe_48_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-12336.79C473.15,-12336.35 476.09,-12335.94 479,-12335.56 892.79,-12281.58 1379.51,-12267.62 1661.11,-12264.35"/>
<polygon fill="black" stroke="black" points="1661.49,-12267.84 1671.45,-12264.23 1661.41,-12260.84 1661.49,-12267.84"/>
</g>
<!-- moe_48_expert_2&#45;&gt;moe_48_aggregate -->
<g id="edge1707" class="edge">
<title>moe_48_expert_2&#45;&gt;moe_48_aggregate</title>
<path fill="none" stroke="black" d="M706.19,-12336.83C709.15,-12336.38 712.09,-12335.95 715,-12335.56 1042.31,-12291.18 1424.45,-12274.23 1663.11,-12267.77"/>
<polygon fill="black" stroke="black" points="1663.4,-12271.26 1673.31,-12267.5 1663.22,-12264.26 1663.4,-12271.26"/>
</g>
<!-- moe_48_expert_3&#45;&gt;moe_48_aggregate -->
<g id="edge1708" class="edge">
<title>moe_48_expert_3&#45;&gt;moe_48_aggregate</title>
<path fill="none" stroke="black" d="M942.2,-12336.89C945.16,-12336.42 948.1,-12335.97 951,-12335.56 1194.76,-12300.63 1476.52,-12282 1668.32,-12272.56"/>
<polygon fill="black" stroke="black" points="1668.71,-12276.04 1678.53,-12272.06 1668.37,-12269.05 1668.71,-12276.04"/>
</g>
<!-- moe_48_expert_4&#45;&gt;moe_48_aggregate -->
<g id="edge1709" class="edge">
<title>moe_48_expert_4&#45;&gt;moe_48_aggregate</title>
<path fill="none" stroke="black" d="M1178.21,-12336.98C1181.17,-12336.49 1184.1,-12336.01 1187,-12335.56 1352.7,-12309.68 1541.73,-12291.07 1682.77,-12279.29"/>
<polygon fill="black" stroke="black" points="1683.17,-12282.77 1692.84,-12278.45 1682.59,-12275.79 1683.17,-12282.77"/>
</g>
<!-- moe_48_expert_5&#45;&gt;moe_48_aggregate -->
<g id="edge1710" class="edge">
<title>moe_48_expert_5&#45;&gt;moe_48_aggregate</title>
<path fill="none" stroke="black" d="M1414.25,-12337.18C1417.19,-12336.62 1420.12,-12336.08 1423,-12335.56 1519.58,-12318 1627.83,-12301.32 1716.27,-12288.47"/>
<polygon fill="black" stroke="black" points="1717.01,-12291.9 1726.4,-12287.01 1716,-12284.98 1717.01,-12291.9"/>
</g>
<!-- moe_48_expert_6&#45;&gt;moe_48_aggregate -->
<g id="edge1711" class="edge">
<title>moe_48_expert_6&#45;&gt;moe_48_aggregate</title>
<path fill="none" stroke="black" d="M1632.62,-12335.51C1675.27,-12323.85 1726.62,-12309.81 1772.54,-12297.26"/>
<polygon fill="black" stroke="black" points="1773.53,-12300.62 1782.25,-12294.61 1771.68,-12293.87 1773.53,-12300.62"/>
</g>
<!-- moe_48_expert_7&#45;&gt;moe_48_aggregate -->
<g id="edge1712" class="edge">
<title>moe_48_expert_7&#45;&gt;moe_48_aggregate</title>
<path fill="none" stroke="black" d="M1807.7,-12335.38C1818.79,-12326.29 1831.63,-12315.76 1843.99,-12305.62"/>
<polygon fill="black" stroke="black" points="1846.51,-12308.08 1852.02,-12299.03 1842.07,-12302.67 1846.51,-12308.08"/>
</g>
<!-- moe_48_expert_8&#45;&gt;moe_48_aggregate -->
<g id="edge1713" class="edge">
<title>moe_48_expert_8&#45;&gt;moe_48_aggregate</title>
<path fill="none" stroke="black" d="M1982.3,-12335.38C1971.21,-12326.29 1958.37,-12315.76 1946.01,-12305.62"/>
<polygon fill="black" stroke="black" points="1947.93,-12302.67 1937.98,-12299.03 1943.49,-12308.08 1947.93,-12302.67"/>
</g>
<!-- moe_48_expert_9&#45;&gt;moe_48_aggregate -->
<g id="edge1714" class="edge">
<title>moe_48_expert_9&#45;&gt;moe_48_aggregate</title>
<path fill="none" stroke="black" d="M2157.38,-12335.51C2114.73,-12323.85 2063.38,-12309.81 2017.46,-12297.26"/>
<polygon fill="black" stroke="black" points="2018.32,-12293.87 2007.75,-12294.61 2016.47,-12300.62 2018.32,-12293.87"/>
</g>
<!-- moe_48_expert_10&#45;&gt;moe_48_aggregate -->
<g id="edge1715" class="edge">
<title>moe_48_expert_10&#45;&gt;moe_48_aggregate</title>
<path fill="none" stroke="black" d="M2375.75,-12337.18C2372.81,-12336.62 2369.88,-12336.08 2367,-12335.56 2270.42,-12318 2162.17,-12301.32 2073.73,-12288.47"/>
<polygon fill="black" stroke="black" points="2074,-12284.98 2063.6,-12287.01 2072.99,-12291.9 2074,-12284.98"/>
</g>
<!-- moe_48_expert_11&#45;&gt;moe_48_aggregate -->
<g id="edge1716" class="edge">
<title>moe_48_expert_11&#45;&gt;moe_48_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-12336.98C2608.83,-12336.49 2605.9,-12336.01 2603,-12335.56 2437.3,-12309.68 2248.27,-12291.07 2107.23,-12279.29"/>
<polygon fill="black" stroke="black" points="2107.41,-12275.79 2097.16,-12278.45 2106.83,-12282.77 2107.41,-12275.79"/>
</g>
<!-- moe_48_expert_12&#45;&gt;moe_48_aggregate -->
<g id="edge1717" class="edge">
<title>moe_48_expert_12&#45;&gt;moe_48_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-12336.89C2844.84,-12336.42 2841.9,-12335.97 2839,-12335.56 2595.24,-12300.63 2313.48,-12282 2121.68,-12272.56"/>
<polygon fill="black" stroke="black" points="2121.63,-12269.05 2111.47,-12272.06 2121.29,-12276.04 2121.63,-12269.05"/>
</g>
<!-- moe_48_expert_13&#45;&gt;moe_48_aggregate -->
<g id="edge1718" class="edge">
<title>moe_48_expert_13&#45;&gt;moe_48_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-12336.83C3080.85,-12336.38 3077.91,-12335.95 3075,-12335.56 2747.69,-12291.18 2365.55,-12274.23 2126.89,-12267.77"/>
<polygon fill="black" stroke="black" points="2126.78,-12264.26 2116.69,-12267.5 2126.6,-12271.26 2126.78,-12264.26"/>
</g>
<!-- moe_48_expert_14&#45;&gt;moe_48_aggregate -->
<g id="edge1719" class="edge">
<title>moe_48_expert_14&#45;&gt;moe_48_aggregate</title>
<path fill="none" stroke="black" d="M3319.81,-12336.79C3316.85,-12336.35 3313.91,-12335.94 3311,-12335.56 2897.21,-12281.58 2410.49,-12267.62 2128.89,-12264.35"/>
<polygon fill="black" stroke="black" points="2128.59,-12260.84 2118.55,-12264.23 2128.51,-12267.84 2128.59,-12260.84"/>
</g>
<!-- moe_48_expert_15&#45;&gt;moe_48_aggregate -->
<g id="edge1720" class="edge">
<title>moe_48_expert_15&#45;&gt;moe_48_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-12336.76C3552.85,-12336.33 3549.91,-12335.92 3547,-12335.56 3279.26,-12301.61 2513.68,-12278.82 2125.96,-12269.1"/>
<polygon fill="black" stroke="black" points="2125.83,-12265.6 2115.74,-12268.85 2125.65,-12272.59 2125.83,-12265.6"/>
</g>
<!-- moe_48_ffn -->
<g id="node1046" class="node">
<title>moe_48_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2053,-12190.02 1737,-12190.02 1737,-12138.02 2053,-12138.02 2053,-12190.02"/>
<text text-anchor="middle" x="1895" y="-12178.02" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1895" y="-12167.02" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-12156.02" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-12145.02" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_48_aggregate&#45;&gt;moe_48_ffn -->
<g id="edge1721" class="edge">
<title>moe_48_aggregate&#45;&gt;moe_48_ffn</title>
<path fill="none" stroke="black" d="M1895,-12225.75C1895,-12217.44 1895,-12208.61 1895,-12200.33"/>
<polygon fill="black" stroke="black" points="1898.5,-12200.21 1895,-12190.21 1891.5,-12200.21 1898.5,-12200.21"/>
</g>
<!-- moe_48_res2 -->
<g id="node1048" class="node">
<title>moe_48_res2</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-12102.02 1695.97,-12102.02 1558.11,-11998.02 2094.03,-11998.02 2231.89,-12102.02"/>
<text text-anchor="middle" x="1895" y="-12064.02" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1895" y="-12053.02" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-12042.02" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-12031.02" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_48_ffn&#45;&gt;moe_48_res2 -->
<g id="edge1722" class="edge">
<title>moe_48_ffn&#45;&gt;moe_48_res2</title>
<path fill="none" stroke="black" d="M1895,-12137.88C1895,-12130.2 1895,-12121.38 1895,-12112.38"/>
<polygon fill="black" stroke="black" points="1898.5,-12112.19 1895,-12102.2 1891.5,-12112.2 1898.5,-12112.19"/>
</g>
<!-- moe_48_res1&#45;&gt;moe_48_gate -->
<g id="edge1687" class="edge">
<title>moe_48_res1&#45;&gt;moe_48_gate</title>
<path fill="none" stroke="black" d="M1777,-12672.71C1777,-12664.54 1777,-12656.01 1777,-12647.63"/>
<polygon fill="black" stroke="black" points="1780.5,-12647.52 1777,-12637.52 1773.5,-12647.52 1780.5,-12647.52"/>
</g>
<!-- moe_49_mha -->
<g id="node1049" class="node">
<title>moe_49_mha</title>
<polygon fill="lightgreen" stroke="black" points="2053,-11951.02 1737,-11951.02 1737,-11899.02 2053,-11899.02 2053,-11951.02"/>
<text text-anchor="middle" x="1895" y="-11939.02" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1895" y="-11928.02" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-11917.02" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-11906.02" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_48_res2&#45;&gt;moe_49_mha -->
<g id="edge1723" class="edge">
<title>moe_48_res2&#45;&gt;moe_49_mha</title>
<path fill="none" stroke="black" d="M1895,-11997.92C1895,-11985.59 1895,-11972.69 1895,-11961.27"/>
<polygon fill="black" stroke="black" points="1898.5,-11961.26 1895,-11951.26 1891.5,-11961.26 1898.5,-11961.26"/>
</g>
<!-- moe_49_res1 -->
<g id="node1070" class="node">
<title>moe_49_res1</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-11863.02 1695.97,-11863.02 1558.11,-11759.02 2094.03,-11759.02 2231.89,-11863.02"/>
<text text-anchor="middle" x="1895" y="-11825.02" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1895" y="-11814.02" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-11803.02" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-11792.02" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_49_mha&#45;&gt;moe_49_res1 -->
<g id="edge1724" class="edge">
<title>moe_49_mha&#45;&gt;moe_49_res1</title>
<path fill="none" stroke="black" d="M1895,-11898.88C1895,-11891.2 1895,-11882.38 1895,-11873.38"/>
<polygon fill="black" stroke="black" points="1898.5,-11873.19 1895,-11863.2 1891.5,-11873.2 1898.5,-11873.19"/>
</g>
<!-- moe_49_gate -->
<g id="node1050" class="node">
<title>moe_49_gate</title>
<polygon fill="lightyellow" stroke="black" points="2223.8,-11723.02 1700.75,-11723.02 1566.2,-11619.02 2089.25,-11619.02 2223.8,-11723.02"/>
<text text-anchor="middle" x="1895" y="-11685.02" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1895" y="-11674.02" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-11663.02" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-11652.02" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_49_route -->
<g id="node1051" class="node">
<title>moe_49_route</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-11546.25" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-11560.25" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1895" y="-11549.25" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-11538.25" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-11527.25" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_49_gate&#45;&gt;moe_49_route -->
<g id="edge1726" class="edge">
<title>moe_49_gate&#45;&gt;moe_49_route</title>
<path fill="none" stroke="black" d="M1895,-11618.66C1895,-11610.25 1895,-11601.59 1895,-11593.32"/>
<polygon fill="black" stroke="black" points="1898.5,-11593.1 1895,-11583.1 1891.5,-11593.1 1898.5,-11593.1"/>
</g>
<!-- moe_49_expert_0 -->
<g id="node1052" class="node">
<title>moe_49_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-11473.48 16,-11473.48 16,-11421.48 234,-11421.48 234,-11473.48"/>
<text text-anchor="middle" x="125" y="-11461.48" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-11450.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-11439.48" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-11428.48" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_49_route&#45;&gt;moe_49_expert_0 -->
<g id="edge1727" class="edge">
<title>moe_49_route&#45;&gt;moe_49_expert_0</title>
<path fill="none" stroke="black" d="M1679.93,-11540.33C1302.11,-11530.96 532.75,-11508.43 244.24,-11473.52"/>
<polygon fill="black" stroke="black" points="244.54,-11470.03 234.18,-11472.27 243.68,-11476.98 244.54,-11470.03"/>
</g>
<!-- moe_49_expert_1 -->
<g id="node1053" class="node">
<title>moe_49_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-11473.48 252,-11473.48 252,-11421.48 470,-11421.48 470,-11473.48"/>
<text text-anchor="middle" x="361" y="-11461.48" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-11450.48" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-11439.48" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-11428.48" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_49_route&#45;&gt;moe_49_expert_1 -->
<g id="edge1728" class="edge">
<title>moe_49_route&#45;&gt;moe_49_expert_1</title>
<path fill="none" stroke="black" d="M1677.23,-11544.87C1400.57,-11541.96 908.56,-11528.71 480.29,-11473.56"/>
<polygon fill="black" stroke="black" points="480.55,-11470.06 470.19,-11472.24 479.65,-11477 480.55,-11470.06"/>
</g>
<!-- moe_49_expert_2 -->
<g id="node1054" class="node">
<title>moe_49_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-11473.48 488,-11473.48 488,-11421.48 706,-11421.48 706,-11473.48"/>
<text text-anchor="middle" x="597" y="-11461.48" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-11450.48" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-11439.48" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-11428.48" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_49_route&#45;&gt;moe_49_expert_2 -->
<g id="edge1729" class="edge">
<title>moe_49_route&#45;&gt;moe_49_expert_2</title>
<path fill="none" stroke="black" d="M1678.74,-11541.68C1443.7,-11535.6 1057.2,-11519.16 716.26,-11473.56"/>
<polygon fill="black" stroke="black" points="716.57,-11470.07 706.19,-11472.21 715.63,-11477.01 716.57,-11470.07"/>
</g>
<!-- moe_49_expert_3 -->
<g id="node1055" class="node">
<title>moe_49_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-11473.48 724,-11473.48 724,-11421.48 942,-11421.48 942,-11473.48"/>
<text text-anchor="middle" x="833" y="-11461.48" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-11450.48" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-11439.48" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-11428.48" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_49_route&#45;&gt;moe_49_expert_3 -->
<g id="edge1730" class="edge">
<title>moe_49_route&#45;&gt;moe_49_expert_3</title>
<path fill="none" stroke="black" d="M1683.7,-11537.22C1494.33,-11528.15 1209,-11509.84 952.47,-11473.61"/>
<polygon fill="black" stroke="black" points="952.59,-11470.09 942.2,-11472.15 951.61,-11477.02 952.59,-11470.09"/>
</g>
<!-- moe_49_expert_4 -->
<g id="node1056" class="node">
<title>moe_49_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-11473.48 960,-11473.48 960,-11421.48 1178,-11421.48 1178,-11473.48"/>
<text text-anchor="middle" x="1069" y="-11461.48" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-11450.48" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-11439.48" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-11428.48" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_49_route&#45;&gt;moe_49_expert_4 -->
<g id="edge1731" class="edge">
<title>moe_49_route&#45;&gt;moe_49_expert_4</title>
<path fill="none" stroke="black" d="M1696.66,-11530.89C1556.96,-11519.41 1365.46,-11500.91 1188.25,-11473.61"/>
<polygon fill="black" stroke="black" points="1188.63,-11470.12 1178.21,-11472.05 1187.56,-11477.04 1188.63,-11470.12"/>
</g>
<!-- moe_49_expert_5 -->
<g id="node1057" class="node">
<title>moe_49_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-11473.48 1196,-11473.48 1196,-11421.48 1414,-11421.48 1414,-11473.48"/>
<text text-anchor="middle" x="1305" y="-11461.48" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-11450.48" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-11439.48" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-11428.48" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_49_route&#45;&gt;moe_49_expert_5 -->
<g id="edge1732" class="edge">
<title>moe_49_route&#45;&gt;moe_49_expert_5</title>
<path fill="none" stroke="black" d="M1728.87,-11522.38C1640.99,-11509.71 1531.11,-11492.93 1424.25,-11473.67"/>
<polygon fill="black" stroke="black" points="1424.71,-11470.19 1414.25,-11471.86 1423.46,-11477.08 1424.71,-11470.19"/>
</g>
<!-- moe_49_expert_6 -->
<g id="node1058" class="node">
<title>moe_49_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-11473.48 1432,-11473.48 1432,-11421.48 1650,-11421.48 1650,-11473.48"/>
<text text-anchor="middle" x="1541" y="-11461.48" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-11450.48" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-11439.48" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-11428.48" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_49_route&#45;&gt;moe_49_expert_6 -->
<g id="edge1733" class="edge">
<title>moe_49_route&#45;&gt;moe_49_expert_6</title>
<path fill="none" stroke="black" d="M1782.99,-11514.63C1737.98,-11502.33 1686.47,-11488.24 1642.56,-11476.24"/>
<polygon fill="black" stroke="black" points="1643.31,-11472.82 1632.74,-11473.56 1641.46,-11479.57 1643.31,-11472.82"/>
</g>
<!-- moe_49_expert_7 -->
<g id="node1059" class="node">
<title>moe_49_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-11473.48 1668,-11473.48 1668,-11421.48 1886,-11421.48 1886,-11473.48"/>
<text text-anchor="middle" x="1777" y="-11461.48" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-11450.48" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-11439.48" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-11428.48" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_49_route&#45;&gt;moe_49_expert_7 -->
<g id="edge1734" class="edge">
<title>moe_49_route&#45;&gt;moe_49_expert_7</title>
<path fill="none" stroke="black" d="M1852.07,-11510.04C1840.07,-11500.2 1827.12,-11489.58 1815.41,-11479.97"/>
<polygon fill="black" stroke="black" points="1817.47,-11477.14 1807.52,-11473.51 1813.04,-11482.56 1817.47,-11477.14"/>
</g>
<!-- moe_49_expert_8 -->
<g id="node1060" class="node">
<title>moe_49_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-11473.48 1904,-11473.48 1904,-11421.48 2122,-11421.48 2122,-11473.48"/>
<text text-anchor="middle" x="2013" y="-11461.48" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-11450.48" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-11439.48" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-11428.48" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_49_route&#45;&gt;moe_49_expert_8 -->
<g id="edge1735" class="edge">
<title>moe_49_route&#45;&gt;moe_49_expert_8</title>
<path fill="none" stroke="black" d="M1937.93,-11510.04C1949.93,-11500.2 1962.88,-11489.58 1974.59,-11479.97"/>
<polygon fill="black" stroke="black" points="1976.96,-11482.56 1982.48,-11473.51 1972.53,-11477.14 1976.96,-11482.56"/>
</g>
<!-- moe_49_expert_9 -->
<g id="node1061" class="node">
<title>moe_49_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-11473.48 2140,-11473.48 2140,-11421.48 2358,-11421.48 2358,-11473.48"/>
<text text-anchor="middle" x="2249" y="-11461.48" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-11450.48" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-11439.48" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-11428.48" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_49_route&#45;&gt;moe_49_expert_9 -->
<g id="edge1736" class="edge">
<title>moe_49_route&#45;&gt;moe_49_expert_9</title>
<path fill="none" stroke="black" d="M2007.01,-11514.63C2052.02,-11502.33 2103.53,-11488.24 2147.44,-11476.24"/>
<polygon fill="black" stroke="black" points="2148.54,-11479.57 2157.26,-11473.56 2146.69,-11472.82 2148.54,-11479.57"/>
</g>
<!-- moe_49_expert_10 -->
<g id="node1062" class="node">
<title>moe_49_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-11473.48 2376,-11473.48 2376,-11421.48 2594,-11421.48 2594,-11473.48"/>
<text text-anchor="middle" x="2485" y="-11461.48" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-11450.48" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-11439.48" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-11428.48" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_49_route&#45;&gt;moe_49_expert_10 -->
<g id="edge1737" class="edge">
<title>moe_49_route&#45;&gt;moe_49_expert_10</title>
<path fill="none" stroke="black" d="M2061.13,-11522.38C2149.01,-11509.71 2258.89,-11492.93 2365.75,-11473.67"/>
<polygon fill="black" stroke="black" points="2366.54,-11477.08 2375.75,-11471.86 2365.29,-11470.19 2366.54,-11477.08"/>
</g>
<!-- moe_49_expert_11 -->
<g id="node1063" class="node">
<title>moe_49_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-11473.48 2612,-11473.48 2612,-11421.48 2830,-11421.48 2830,-11473.48"/>
<text text-anchor="middle" x="2721" y="-11461.48" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-11450.48" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-11439.48" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-11428.48" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_49_route&#45;&gt;moe_49_expert_11 -->
<g id="edge1738" class="edge">
<title>moe_49_route&#45;&gt;moe_49_expert_11</title>
<path fill="none" stroke="black" d="M2093.34,-11530.89C2233.04,-11519.41 2424.54,-11500.91 2601.75,-11473.61"/>
<polygon fill="black" stroke="black" points="2602.44,-11477.04 2611.79,-11472.05 2601.37,-11470.12 2602.44,-11477.04"/>
</g>
<!-- moe_49_expert_12 -->
<g id="node1064" class="node">
<title>moe_49_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-11473.48 2848,-11473.48 2848,-11421.48 3066,-11421.48 3066,-11473.48"/>
<text text-anchor="middle" x="2957" y="-11461.48" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-11450.48" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-11439.48" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-11428.48" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_49_route&#45;&gt;moe_49_expert_12 -->
<g id="edge1739" class="edge">
<title>moe_49_route&#45;&gt;moe_49_expert_12</title>
<path fill="none" stroke="black" d="M2106.3,-11537.22C2295.67,-11528.15 2581,-11509.84 2837.53,-11473.61"/>
<polygon fill="black" stroke="black" points="2838.39,-11477.02 2847.8,-11472.15 2837.41,-11470.09 2838.39,-11477.02"/>
</g>
<!-- moe_49_expert_13 -->
<g id="node1065" class="node">
<title>moe_49_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-11473.48 3084,-11473.48 3084,-11421.48 3302,-11421.48 3302,-11473.48"/>
<text text-anchor="middle" x="3193" y="-11461.48" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-11450.48" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-11439.48" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-11428.48" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_49_route&#45;&gt;moe_49_expert_13 -->
<g id="edge1740" class="edge">
<title>moe_49_route&#45;&gt;moe_49_expert_13</title>
<path fill="none" stroke="black" d="M2111.26,-11541.68C2346.3,-11535.6 2732.8,-11519.16 3073.74,-11473.56"/>
<polygon fill="black" stroke="black" points="3074.37,-11477.01 3083.81,-11472.21 3073.43,-11470.07 3074.37,-11477.01"/>
</g>
<!-- moe_49_expert_14 -->
<g id="node1066" class="node">
<title>moe_49_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-11473.48 3320,-11473.48 3320,-11421.48 3538,-11421.48 3538,-11473.48"/>
<text text-anchor="middle" x="3429" y="-11461.48" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-11450.48" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-11439.48" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-11428.48" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_49_route&#45;&gt;moe_49_expert_14 -->
<g id="edge1741" class="edge">
<title>moe_49_route&#45;&gt;moe_49_expert_14</title>
<path fill="none" stroke="black" d="M2112.77,-11544.87C2389.43,-11541.96 2881.44,-11528.71 3309.71,-11473.56"/>
<polygon fill="black" stroke="black" points="3310.35,-11477 3319.81,-11472.24 3309.45,-11470.06 3310.35,-11477"/>
</g>
<!-- moe_49_expert_15 -->
<g id="node1067" class="node">
<title>moe_49_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-11473.48 3556,-11473.48 3556,-11421.48 3774,-11421.48 3774,-11473.48"/>
<text text-anchor="middle" x="3665" y="-11461.48" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-11450.48" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-11439.48" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-11428.48" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_49_route&#45;&gt;moe_49_expert_15 -->
<g id="edge1742" class="edge">
<title>moe_49_route&#45;&gt;moe_49_expert_15</title>
<path fill="none" stroke="black" d="M2110.07,-11540.33C2487.89,-11530.96 3257.25,-11508.43 3545.76,-11473.52"/>
<polygon fill="black" stroke="black" points="3546.32,-11476.98 3555.82,-11472.27 3545.46,-11470.03 3546.32,-11476.98"/>
</g>
<!-- moe_49_aggregate -->
<g id="node1068" class="node">
<title>moe_49_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1777" cy="-11348.71" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1777" y="-11362.71" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1777" y="-11351.71" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1777" y="-11340.71" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1777" y="-11329.71" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_49_expert_0&#45;&gt;moe_49_aggregate -->
<g id="edge1743" class="edge">
<title>moe_49_expert_0&#45;&gt;moe_49_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-11422.7C237.15,-11422.26 240.09,-11421.85 243,-11421.48 488.12,-11389.99 1182.7,-11366.47 1547.21,-11355.89"/>
<polygon fill="black" stroke="black" points="1547.47,-11359.38 1557.36,-11355.6 1547.27,-11352.39 1547.47,-11359.38"/>
</g>
<!-- moe_49_expert_1&#45;&gt;moe_49_aggregate -->
<g id="edge1744" class="edge">
<title>moe_49_expert_1&#45;&gt;moe_49_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-11422.73C473.15,-11422.28 476.09,-11421.86 479,-11421.48 849.22,-11372.32 1283.16,-11356.73 1543.76,-11351.84"/>
<polygon fill="black" stroke="black" points="1544.17,-11355.34 1554.11,-11351.65 1544.05,-11348.34 1544.17,-11355.34"/>
</g>
<!-- moe_49_expert_2&#45;&gt;moe_49_aggregate -->
<g id="edge1745" class="edge">
<title>moe_49_expert_2&#45;&gt;moe_49_aggregate</title>
<path fill="none" stroke="black" d="M706.2,-11422.78C709.16,-11422.32 712.1,-11421.88 715,-11421.48 1000.02,-11381.86 1331.23,-11363.88 1546.98,-11355.88"/>
<polygon fill="black" stroke="black" points="1547.3,-11359.37 1557.17,-11355.51 1547.05,-11352.38 1547.3,-11359.37"/>
</g>
<!-- moe_49_expert_3&#45;&gt;moe_49_aggregate -->
<g id="edge1746" class="edge">
<title>moe_49_expert_3&#45;&gt;moe_49_aggregate</title>
<path fill="none" stroke="black" d="M942.21,-11422.85C945.16,-11422.37 948.1,-11421.91 951,-11421.48 1154.78,-11391.15 1388.89,-11372.3 1555.72,-11361.58"/>
<polygon fill="black" stroke="black" points="1556.35,-11365.04 1566.11,-11360.91 1555.91,-11358.06 1556.35,-11365.04"/>
</g>
<!-- moe_49_expert_4&#45;&gt;moe_49_aggregate -->
<g id="edge1747" class="edge">
<title>moe_49_expert_4&#45;&gt;moe_49_aggregate</title>
<path fill="none" stroke="black" d="M1178.23,-11422.98C1181.18,-11422.46 1184.11,-11421.96 1187,-11421.48 1316.69,-11399.89 1463.43,-11382.02 1578.13,-11369.5"/>
<polygon fill="black" stroke="black" points="1578.51,-11372.98 1588.07,-11368.42 1577.75,-11366.02 1578.51,-11372.98"/>
</g>
<!-- moe_49_expert_5&#45;&gt;moe_49_aggregate -->
<g id="edge1748" class="edge">
<title>moe_49_expert_5&#45;&gt;moe_49_aggregate</title>
<path fill="none" stroke="black" d="M1414.28,-11423.29C1417.22,-11422.68 1420.13,-11422.07 1423,-11421.48 1490.32,-11407.52 1564.9,-11392.36 1628.19,-11379.58"/>
<polygon fill="black" stroke="black" points="1629.13,-11382.96 1638.24,-11377.55 1627.75,-11376.1 1629.13,-11382.96"/>
</g>
<!-- moe_49_expert_6&#45;&gt;moe_49_aggregate -->
<g id="edge1749" class="edge">
<title>moe_49_expert_6&#45;&gt;moe_49_aggregate</title>
<path fill="none" stroke="black" d="M1602.08,-11421.43C1627.73,-11410.92 1658.09,-11398.47 1686.26,-11386.92"/>
<polygon fill="black" stroke="black" points="1687.79,-11390.07 1695.72,-11383.04 1685.14,-11383.59 1687.79,-11390.07"/>
</g>
<!-- moe_49_expert_7&#45;&gt;moe_49_aggregate -->
<g id="edge1750" class="edge">
<title>moe_49_expert_7&#45;&gt;moe_49_aggregate</title>
<path fill="none" stroke="black" d="M1777,-11421.31C1777,-11413.5 1777,-11404.63 1777,-11395.86"/>
<polygon fill="black" stroke="black" points="1780.5,-11395.68 1777,-11385.68 1773.5,-11395.68 1780.5,-11395.68"/>
</g>
<!-- moe_49_expert_8&#45;&gt;moe_49_aggregate -->
<g id="edge1751" class="edge">
<title>moe_49_expert_8&#45;&gt;moe_49_aggregate</title>
<path fill="none" stroke="black" d="M1951.92,-11421.43C1926.27,-11410.92 1895.91,-11398.47 1867.74,-11386.92"/>
<polygon fill="black" stroke="black" points="1868.86,-11383.59 1858.28,-11383.04 1866.21,-11390.07 1868.86,-11383.59"/>
</g>
<!-- moe_49_expert_9&#45;&gt;moe_49_aggregate -->
<g id="edge1752" class="edge">
<title>moe_49_expert_9&#45;&gt;moe_49_aggregate</title>
<path fill="none" stroke="black" d="M2139.72,-11423.29C2136.78,-11422.68 2133.87,-11422.07 2131,-11421.48 2063.68,-11407.52 1989.1,-11392.36 1925.81,-11379.58"/>
<polygon fill="black" stroke="black" points="1926.25,-11376.1 1915.76,-11377.55 1924.87,-11382.96 1926.25,-11376.1"/>
</g>
<!-- moe_49_expert_10&#45;&gt;moe_49_aggregate -->
<g id="edge1753" class="edge">
<title>moe_49_expert_10&#45;&gt;moe_49_aggregate</title>
<path fill="none" stroke="black" d="M2375.77,-11422.98C2372.82,-11422.46 2369.89,-11421.96 2367,-11421.48 2237.31,-11399.89 2090.57,-11382.02 1975.87,-11369.5"/>
<polygon fill="black" stroke="black" points="1976.25,-11366.02 1965.93,-11368.42 1975.49,-11372.98 1976.25,-11366.02"/>
</g>
<!-- moe_49_expert_11&#45;&gt;moe_49_aggregate -->
<g id="edge1754" class="edge">
<title>moe_49_expert_11&#45;&gt;moe_49_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-11422.85C2608.84,-11422.37 2605.9,-11421.91 2603,-11421.48 2399.22,-11391.15 2165.11,-11372.3 1998.28,-11361.58"/>
<polygon fill="black" stroke="black" points="1998.09,-11358.06 1987.89,-11360.91 1997.65,-11365.04 1998.09,-11358.06"/>
</g>
<!-- moe_49_expert_12&#45;&gt;moe_49_aggregate -->
<g id="edge1755" class="edge">
<title>moe_49_expert_12&#45;&gt;moe_49_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-11422.78C2844.84,-11422.32 2841.9,-11421.88 2839,-11421.48 2553.98,-11381.86 2222.77,-11363.88 2007.02,-11355.88"/>
<polygon fill="black" stroke="black" points="2006.95,-11352.38 1996.83,-11355.51 2006.7,-11359.37 2006.95,-11352.38"/>
</g>
<!-- moe_49_expert_13&#45;&gt;moe_49_aggregate -->
<g id="edge1756" class="edge">
<title>moe_49_expert_13&#45;&gt;moe_49_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-11422.73C3080.85,-11422.28 3077.91,-11421.86 3075,-11421.48 2704.78,-11372.32 2270.84,-11356.73 2010.24,-11351.84"/>
<polygon fill="black" stroke="black" points="2009.95,-11348.34 1999.89,-11351.65 2009.83,-11355.34 2009.95,-11348.34"/>
</g>
<!-- moe_49_expert_14&#45;&gt;moe_49_aggregate -->
<g id="edge1757" class="edge">
<title>moe_49_expert_14&#45;&gt;moe_49_aggregate</title>
<path fill="none" stroke="black" d="M3319.82,-11422.7C3316.85,-11422.26 3313.91,-11421.85 3311,-11421.48 3065.88,-11389.99 2371.3,-11366.47 2006.79,-11355.89"/>
<polygon fill="black" stroke="black" points="2006.73,-11352.39 1996.64,-11355.6 2006.53,-11359.38 2006.73,-11352.39"/>
</g>
<!-- moe_49_expert_15&#45;&gt;moe_49_aggregate -->
<g id="edge1758" class="edge">
<title>moe_49_expert_15&#45;&gt;moe_49_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-11422.67C3552.85,-11422.24 3549.91,-11421.84 3547,-11421.48 3256.39,-11385.06 2418.41,-11363.11 2008.44,-11354.25"/>
<polygon fill="black" stroke="black" points="2008.31,-11350.75 1998.24,-11354.03 2008.16,-11357.75 2008.31,-11350.75"/>
</g>
<!-- moe_49_ffn -->
<g id="node1069" class="node">
<title>moe_49_ffn</title>
<polygon fill="lightgreen" stroke="black" points="1935,-11275.94 1619,-11275.94 1619,-11223.94 1935,-11223.94 1935,-11275.94"/>
<text text-anchor="middle" x="1777" y="-11263.94" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1777" y="-11252.94" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-11241.94" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-11230.94" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_49_aggregate&#45;&gt;moe_49_ffn -->
<g id="edge1759" class="edge">
<title>moe_49_aggregate&#45;&gt;moe_49_ffn</title>
<path fill="none" stroke="black" d="M1777,-11311.67C1777,-11303.36 1777,-11294.53 1777,-11286.25"/>
<polygon fill="black" stroke="black" points="1780.5,-11286.13 1777,-11276.13 1773.5,-11286.13 1780.5,-11286.13"/>
</g>
<!-- moe_49_res2 -->
<g id="node1071" class="node">
<title>moe_49_res2</title>
<polygon fill="lightyellow" stroke="black" points="2113.89,-11187.94 1577.97,-11187.94 1440.11,-11083.94 1976.03,-11083.94 2113.89,-11187.94"/>
<text text-anchor="middle" x="1777" y="-11149.94" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1777" y="-11138.94" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-11127.94" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1777" y="-11116.94" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_49_ffn&#45;&gt;moe_49_res2 -->
<g id="edge1760" class="edge">
<title>moe_49_ffn&#45;&gt;moe_49_res2</title>
<path fill="none" stroke="black" d="M1777,-11223.8C1777,-11216.12 1777,-11207.31 1777,-11198.31"/>
<polygon fill="black" stroke="black" points="1780.5,-11198.12 1777,-11188.12 1773.5,-11198.12 1780.5,-11198.12"/>
</g>
<!-- moe_49_res1&#45;&gt;moe_49_gate -->
<g id="edge1725" class="edge">
<title>moe_49_res1&#45;&gt;moe_49_gate</title>
<path fill="none" stroke="black" d="M1895,-11758.63C1895,-11750.46 1895,-11741.93 1895,-11733.56"/>
<polygon fill="black" stroke="black" points="1898.5,-11733.45 1895,-11723.45 1891.5,-11733.45 1898.5,-11733.45"/>
</g>
<!-- moe_50_mha -->
<g id="node1072" class="node">
<title>moe_50_mha</title>
<polygon fill="lightgreen" stroke="black" points="1935,-11036.94 1619,-11036.94 1619,-10984.94 1935,-10984.94 1935,-11036.94"/>
<text text-anchor="middle" x="1777" y="-11024.94" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1777" y="-11013.94" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-11002.94" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-10991.94" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_49_res2&#45;&gt;moe_50_mha -->
<g id="edge1761" class="edge">
<title>moe_49_res2&#45;&gt;moe_50_mha</title>
<path fill="none" stroke="black" d="M1777,-11083.84C1777,-11071.51 1777,-11058.61 1777,-11047.19"/>
<polygon fill="black" stroke="black" points="1780.5,-11047.18 1777,-11037.18 1773.5,-11047.18 1780.5,-11047.18"/>
</g>
<!-- moe_50_res1 -->
<g id="node1093" class="node">
<title>moe_50_res1</title>
<polygon fill="lightyellow" stroke="black" points="2113.89,-10948.94 1577.97,-10948.94 1440.11,-10844.94 1976.03,-10844.94 2113.89,-10948.94"/>
<text text-anchor="middle" x="1777" y="-10910.94" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1777" y="-10899.94" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-10888.94" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1777" y="-10877.94" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_50_mha&#45;&gt;moe_50_res1 -->
<g id="edge1762" class="edge">
<title>moe_50_mha&#45;&gt;moe_50_res1</title>
<path fill="none" stroke="black" d="M1777,-10984.8C1777,-10977.12 1777,-10968.31 1777,-10959.31"/>
<polygon fill="black" stroke="black" points="1780.5,-10959.12 1777,-10949.12 1773.5,-10959.12 1780.5,-10959.12"/>
</g>
<!-- moe_50_gate -->
<g id="node1073" class="node">
<title>moe_50_gate</title>
<polygon fill="lightyellow" stroke="black" points="2105.8,-10808.94 1582.75,-10808.94 1448.2,-10704.94 1971.25,-10704.94 2105.8,-10808.94"/>
<text text-anchor="middle" x="1777" y="-10770.94" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1777" y="-10759.94" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-10748.94" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-10737.94" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_50_route -->
<g id="node1074" class="node">
<title>moe_50_route</title>
<ellipse fill="lightblue" stroke="black" cx="1777" cy="-10632.17" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1777" y="-10646.17" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1777" y="-10635.17" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1777" y="-10624.17" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-10613.17" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_50_gate&#45;&gt;moe_50_route -->
<g id="edge1764" class="edge">
<title>moe_50_gate&#45;&gt;moe_50_route</title>
<path fill="none" stroke="black" d="M1777,-10704.58C1777,-10696.18 1777,-10687.51 1777,-10679.24"/>
<polygon fill="black" stroke="black" points="1780.5,-10679.02 1777,-10669.02 1773.5,-10679.02 1780.5,-10679.02"/>
</g>
<!-- moe_50_expert_0 -->
<g id="node1075" class="node">
<title>moe_50_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-10559.4 16,-10559.4 16,-10507.4 234,-10507.4 234,-10559.4"/>
<text text-anchor="middle" x="125" y="-10547.4" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-10536.4" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-10525.4" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-10514.4" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_50_route&#45;&gt;moe_50_expert_0 -->
<g id="edge1765" class="edge">
<title>moe_50_route&#45;&gt;moe_50_expert_0</title>
<path fill="none" stroke="black" d="M1562.77,-10625.44C1207.39,-10615.22 509.65,-10591.94 244.21,-10559.44"/>
<polygon fill="black" stroke="black" points="244.54,-10555.95 234.18,-10558.18 243.67,-10562.9 244.54,-10555.95"/>
</g>
<!-- moe_50_expert_1 -->
<g id="node1076" class="node">
<title>moe_50_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-10559.4 252,-10559.4 252,-10507.4 470,-10507.4 470,-10559.4"/>
<text text-anchor="middle" x="361" y="-10547.4" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-10536.4" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-10525.4" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-10514.4" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_50_route&#45;&gt;moe_50_expert_1 -->
<g id="edge1766" class="edge">
<title>moe_50_route&#45;&gt;moe_50_expert_1</title>
<path fill="none" stroke="black" d="M1559.59,-10629.32C1303.22,-10624.82 864.4,-10609.83 480.11,-10559.46"/>
<polygon fill="black" stroke="black" points="480.56,-10555.99 470.19,-10558.15 479.64,-10562.93 480.56,-10555.99"/>
</g>
<!-- moe_50_expert_2 -->
<g id="node1077" class="node">
<title>moe_50_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-10559.4 488,-10559.4 488,-10507.4 706,-10507.4 706,-10559.4"/>
<text text-anchor="middle" x="597" y="-10547.4" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-10536.4" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-10525.4" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-10514.4" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_50_route&#45;&gt;moe_50_expert_2 -->
<g id="edge1767" class="edge">
<title>moe_50_route&#45;&gt;moe_50_expert_2</title>
<path fill="none" stroke="black" d="M1562.51,-10625.56C1349.77,-10617.94 1014.57,-10600.38 716.34,-10559.5"/>
<polygon fill="black" stroke="black" points="716.58,-10556 706.2,-10558.1 715.62,-10562.94 716.58,-10556"/>
</g>
<!-- moe_50_expert_3 -->
<g id="node1078" class="node">
<title>moe_50_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-10559.4 724,-10559.4 724,-10507.4 942,-10507.4 942,-10559.4"/>
<text text-anchor="middle" x="833" y="-10547.4" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-10536.4" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-10525.4" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-10514.4" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_50_route&#45;&gt;moe_50_expert_3 -->
<g id="edge1768" class="edge">
<title>moe_50_route&#45;&gt;moe_50_expert_3</title>
<path fill="none" stroke="black" d="M1570.82,-10620.26C1405.76,-10609.87 1168.32,-10591.22 952.16,-10559.5"/>
<polygon fill="black" stroke="black" points="952.61,-10556.03 942.21,-10558.03 951.59,-10562.95 952.61,-10556.03"/>
</g>
<!-- moe_50_expert_4 -->
<g id="node1079" class="node">
<title>moe_50_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-10559.4 960,-10559.4 960,-10507.4 1178,-10507.4 1178,-10559.4"/>
<text text-anchor="middle" x="1069" y="-10547.4" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-10536.4" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-10525.4" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-10514.4" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_50_route&#45;&gt;moe_50_expert_4 -->
<g id="edge1769" class="edge">
<title>moe_50_route&#45;&gt;moe_50_expert_4</title>
<path fill="none" stroke="black" d="M1591.38,-10612.81C1477.62,-10600.54 1328.9,-10582.68 1188.33,-10559.57"/>
<polygon fill="black" stroke="black" points="1188.66,-10556.07 1178.23,-10557.89 1187.52,-10562.98 1188.66,-10556.07"/>
</g>
<!-- moe_50_expert_5 -->
<g id="node1080" class="node">
<title>moe_50_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-10559.4 1196,-10559.4 1196,-10507.4 1414,-10507.4 1414,-10559.4"/>
<text text-anchor="middle" x="1305" y="-10547.4" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-10536.4" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-10525.4" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-10514.4" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_50_route&#45;&gt;moe_50_expert_5 -->
<g id="edge1770" class="edge">
<title>moe_50_route&#45;&gt;moe_50_expert_5</title>
<path fill="none" stroke="black" d="M1639.51,-10603.59C1576.62,-10590.9 1500.88,-10575.52 1424.14,-10559.63"/>
<polygon fill="black" stroke="black" points="1424.79,-10556.19 1414.28,-10557.59 1423.37,-10563.04 1424.79,-10556.19"/>
</g>
<!-- moe_50_expert_6 -->
<g id="node1081" class="node">
<title>moe_50_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-10559.4 1432,-10559.4 1432,-10507.4 1650,-10507.4 1650,-10559.4"/>
<text text-anchor="middle" x="1541" y="-10547.4" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-10536.4" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-10525.4" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-10514.4" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_50_route&#45;&gt;moe_50_expert_6 -->
<g id="edge1771" class="edge">
<title>moe_50_route&#45;&gt;moe_50_expert_6</title>
<path fill="none" stroke="black" d="M1696.11,-10598C1668.54,-10586.7 1637.96,-10574.16 1611.29,-10563.22"/>
<polygon fill="black" stroke="black" points="1612.61,-10559.98 1602.03,-10559.42 1609.95,-10566.46 1612.61,-10559.98"/>
</g>
<!-- moe_50_expert_7 -->
<g id="node1082" class="node">
<title>moe_50_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-10559.4 1668,-10559.4 1668,-10507.4 1886,-10507.4 1886,-10559.4"/>
<text text-anchor="middle" x="1777" y="-10547.4" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-10536.4" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-10525.4" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-10514.4" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_50_route&#45;&gt;moe_50_expert_7 -->
<g id="edge1772" class="edge">
<title>moe_50_route&#45;&gt;moe_50_expert_7</title>
<path fill="none" stroke="black" d="M1777,-10595.14C1777,-10586.82 1777,-10577.99 1777,-10569.71"/>
<polygon fill="black" stroke="black" points="1780.5,-10569.6 1777,-10559.6 1773.5,-10569.6 1780.5,-10569.6"/>
</g>
<!-- moe_50_expert_8 -->
<g id="node1083" class="node">
<title>moe_50_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-10559.4 1904,-10559.4 1904,-10507.4 2122,-10507.4 2122,-10559.4"/>
<text text-anchor="middle" x="2013" y="-10547.4" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-10536.4" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-10525.4" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-10514.4" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_50_route&#45;&gt;moe_50_expert_8 -->
<g id="edge1773" class="edge">
<title>moe_50_route&#45;&gt;moe_50_expert_8</title>
<path fill="none" stroke="black" d="M1857.89,-10598C1885.46,-10586.7 1916.04,-10574.16 1942.71,-10563.22"/>
<polygon fill="black" stroke="black" points="1944.05,-10566.46 1951.97,-10559.42 1941.39,-10559.98 1944.05,-10566.46"/>
</g>
<!-- moe_50_expert_9 -->
<g id="node1084" class="node">
<title>moe_50_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-10559.4 2140,-10559.4 2140,-10507.4 2358,-10507.4 2358,-10559.4"/>
<text text-anchor="middle" x="2249" y="-10547.4" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-10536.4" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-10525.4" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-10514.4" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_50_route&#45;&gt;moe_50_expert_9 -->
<g id="edge1774" class="edge">
<title>moe_50_route&#45;&gt;moe_50_expert_9</title>
<path fill="none" stroke="black" d="M1914.49,-10603.59C1977.38,-10590.9 2053.12,-10575.52 2129.86,-10559.63"/>
<polygon fill="black" stroke="black" points="2130.63,-10563.04 2139.72,-10557.59 2129.21,-10556.19 2130.63,-10563.04"/>
</g>
<!-- moe_50_expert_10 -->
<g id="node1085" class="node">
<title>moe_50_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-10559.4 2376,-10559.4 2376,-10507.4 2594,-10507.4 2594,-10559.4"/>
<text text-anchor="middle" x="2485" y="-10547.4" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-10536.4" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-10525.4" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-10514.4" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_50_route&#45;&gt;moe_50_expert_10 -->
<g id="edge1775" class="edge">
<title>moe_50_route&#45;&gt;moe_50_expert_10</title>
<path fill="none" stroke="black" d="M1962.62,-10612.81C2076.38,-10600.54 2225.1,-10582.68 2365.67,-10559.57"/>
<polygon fill="black" stroke="black" points="2366.48,-10562.98 2375.77,-10557.89 2365.34,-10556.07 2366.48,-10562.98"/>
</g>
<!-- moe_50_expert_11 -->
<g id="node1086" class="node">
<title>moe_50_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-10559.4 2612,-10559.4 2612,-10507.4 2830,-10507.4 2830,-10559.4"/>
<text text-anchor="middle" x="2721" y="-10547.4" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-10536.4" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-10525.4" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-10514.4" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_50_route&#45;&gt;moe_50_expert_11 -->
<g id="edge1776" class="edge">
<title>moe_50_route&#45;&gt;moe_50_expert_11</title>
<path fill="none" stroke="black" d="M1983.18,-10620.26C2148.24,-10609.87 2385.68,-10591.22 2601.84,-10559.5"/>
<polygon fill="black" stroke="black" points="2602.41,-10562.95 2611.79,-10558.03 2601.39,-10556.03 2602.41,-10562.95"/>
</g>
<!-- moe_50_expert_12 -->
<g id="node1087" class="node">
<title>moe_50_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-10559.4 2848,-10559.4 2848,-10507.4 3066,-10507.4 3066,-10559.4"/>
<text text-anchor="middle" x="2957" y="-10547.4" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-10536.4" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-10525.4" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-10514.4" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_50_route&#45;&gt;moe_50_expert_12 -->
<g id="edge1777" class="edge">
<title>moe_50_route&#45;&gt;moe_50_expert_12</title>
<path fill="none" stroke="black" d="M1991.49,-10625.56C2204.23,-10617.94 2539.43,-10600.38 2837.66,-10559.5"/>
<polygon fill="black" stroke="black" points="2838.38,-10562.94 2847.8,-10558.1 2837.42,-10556 2838.38,-10562.94"/>
</g>
<!-- moe_50_expert_13 -->
<g id="node1088" class="node">
<title>moe_50_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-10559.4 3084,-10559.4 3084,-10507.4 3302,-10507.4 3302,-10559.4"/>
<text text-anchor="middle" x="3193" y="-10547.4" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-10536.4" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-10525.4" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-10514.4" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_50_route&#45;&gt;moe_50_expert_13 -->
<g id="edge1778" class="edge">
<title>moe_50_route&#45;&gt;moe_50_expert_13</title>
<path fill="none" stroke="black" d="M1994.41,-10629.32C2250.78,-10624.82 2689.6,-10609.83 3073.89,-10559.46"/>
<polygon fill="black" stroke="black" points="3074.36,-10562.93 3083.81,-10558.15 3073.44,-10555.99 3074.36,-10562.93"/>
</g>
<!-- moe_50_expert_14 -->
<g id="node1089" class="node">
<title>moe_50_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-10559.4 3320,-10559.4 3320,-10507.4 3538,-10507.4 3538,-10559.4"/>
<text text-anchor="middle" x="3429" y="-10547.4" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-10536.4" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-10525.4" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-10514.4" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_50_route&#45;&gt;moe_50_expert_14 -->
<g id="edge1779" class="edge">
<title>moe_50_route&#45;&gt;moe_50_expert_14</title>
<path fill="none" stroke="black" d="M1991.23,-10625.44C2346.61,-10615.22 3044.35,-10591.94 3309.79,-10559.44"/>
<polygon fill="black" stroke="black" points="3310.33,-10562.9 3319.82,-10558.18 3309.46,-10555.95 3310.33,-10562.9"/>
</g>
<!-- moe_50_expert_15 -->
<g id="node1090" class="node">
<title>moe_50_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-10559.4 3556,-10559.4 3556,-10507.4 3774,-10507.4 3774,-10559.4"/>
<text text-anchor="middle" x="3665" y="-10547.4" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-10536.4" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-10525.4" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-10514.4" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_50_route&#45;&gt;moe_50_expert_15 -->
<g id="edge1780" class="edge">
<title>moe_50_route&#45;&gt;moe_50_expert_15</title>
<path fill="none" stroke="black" d="M1992.71,-10626.96C2392.25,-10618.43 3234.28,-10596.76 3545.86,-10559.43"/>
<polygon fill="black" stroke="black" points="3546.32,-10562.9 3555.82,-10558.21 3545.47,-10555.95 3546.32,-10562.9"/>
</g>
<!-- moe_50_aggregate -->
<g id="node1091" class="node">
<title>moe_50_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-10434.63" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-10448.63" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1895" y="-10437.63" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-10426.63" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1895" y="-10415.63" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_50_expert_0&#45;&gt;moe_50_aggregate -->
<g id="edge1781" class="edge">
<title>moe_50_expert_0&#45;&gt;moe_50_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-10508.6C237.15,-10508.17 240.09,-10507.77 243,-10507.4 510.74,-10473.46 1276.32,-10450.66 1664.04,-10440.94"/>
<polygon fill="black" stroke="black" points="1664.35,-10444.44 1674.26,-10440.69 1664.17,-10437.44 1664.35,-10444.44"/>
</g>
<!-- moe_50_expert_1&#45;&gt;moe_50_aggregate -->
<g id="edge1782" class="edge">
<title>moe_50_expert_1&#45;&gt;moe_50_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-10508.63C473.15,-10508.19 476.09,-10507.78 479,-10507.4 892.79,-10453.42 1379.51,-10439.46 1661.11,-10436.19"/>
<polygon fill="black" stroke="black" points="1661.49,-10439.68 1671.45,-10436.07 1661.41,-10432.69 1661.49,-10439.68"/>
</g>
<!-- moe_50_expert_2&#45;&gt;moe_50_aggregate -->
<g id="edge1783" class="edge">
<title>moe_50_expert_2&#45;&gt;moe_50_aggregate</title>
<path fill="none" stroke="black" d="M706.19,-10508.67C709.15,-10508.22 712.09,-10507.79 715,-10507.4 1042.31,-10463.02 1424.45,-10446.08 1663.11,-10439.61"/>
<polygon fill="black" stroke="black" points="1663.4,-10443.1 1673.31,-10439.34 1663.22,-10436.11 1663.4,-10443.1"/>
</g>
<!-- moe_50_expert_3&#45;&gt;moe_50_aggregate -->
<g id="edge1784" class="edge">
<title>moe_50_expert_3&#45;&gt;moe_50_aggregate</title>
<path fill="none" stroke="black" d="M942.2,-10508.73C945.16,-10508.26 948.1,-10507.82 951,-10507.4 1194.76,-10472.47 1476.52,-10453.84 1668.32,-10444.4"/>
<polygon fill="black" stroke="black" points="1668.71,-10447.89 1678.53,-10443.9 1668.37,-10440.89 1668.71,-10447.89"/>
</g>
<!-- moe_50_expert_4&#45;&gt;moe_50_aggregate -->
<g id="edge1785" class="edge">
<title>moe_50_expert_4&#45;&gt;moe_50_aggregate</title>
<path fill="none" stroke="black" d="M1178.21,-10508.83C1181.17,-10508.33 1184.1,-10507.85 1187,-10507.4 1352.7,-10481.53 1541.73,-10462.91 1682.77,-10451.13"/>
<polygon fill="black" stroke="black" points="1683.17,-10454.61 1692.84,-10450.3 1682.59,-10447.64 1683.17,-10454.61"/>
</g>
<!-- moe_50_expert_5&#45;&gt;moe_50_aggregate -->
<g id="edge1786" class="edge">
<title>moe_50_expert_5&#45;&gt;moe_50_aggregate</title>
<path fill="none" stroke="black" d="M1414.25,-10509.02C1417.19,-10508.47 1420.12,-10507.92 1423,-10507.4 1519.58,-10489.84 1627.83,-10473.17 1716.27,-10460.32"/>
<polygon fill="black" stroke="black" points="1717.01,-10463.75 1726.4,-10458.85 1716,-10456.82 1717.01,-10463.75"/>
</g>
<!-- moe_50_expert_6&#45;&gt;moe_50_aggregate -->
<g id="edge1787" class="edge">
<title>moe_50_expert_6&#45;&gt;moe_50_aggregate</title>
<path fill="none" stroke="black" d="M1632.62,-10507.35C1675.27,-10495.69 1726.62,-10481.66 1772.54,-10469.11"/>
<polygon fill="black" stroke="black" points="1773.53,-10472.46 1782.25,-10466.45 1771.68,-10465.71 1773.53,-10472.46"/>
</g>
<!-- moe_50_expert_7&#45;&gt;moe_50_aggregate -->
<g id="edge1788" class="edge">
<title>moe_50_expert_7&#45;&gt;moe_50_aggregate</title>
<path fill="none" stroke="black" d="M1807.7,-10507.23C1818.79,-10498.13 1831.63,-10487.6 1843.99,-10477.46"/>
<polygon fill="black" stroke="black" points="1846.51,-10479.92 1852.02,-10470.87 1842.07,-10474.51 1846.51,-10479.92"/>
</g>
<!-- moe_50_expert_8&#45;&gt;moe_50_aggregate -->
<g id="edge1789" class="edge">
<title>moe_50_expert_8&#45;&gt;moe_50_aggregate</title>
<path fill="none" stroke="black" d="M1982.3,-10507.23C1971.21,-10498.13 1958.37,-10487.6 1946.01,-10477.46"/>
<polygon fill="black" stroke="black" points="1947.93,-10474.51 1937.98,-10470.87 1943.49,-10479.92 1947.93,-10474.51"/>
</g>
<!-- moe_50_expert_9&#45;&gt;moe_50_aggregate -->
<g id="edge1790" class="edge">
<title>moe_50_expert_9&#45;&gt;moe_50_aggregate</title>
<path fill="none" stroke="black" d="M2157.38,-10507.35C2114.73,-10495.69 2063.38,-10481.66 2017.46,-10469.11"/>
<polygon fill="black" stroke="black" points="2018.32,-10465.71 2007.75,-10466.45 2016.47,-10472.46 2018.32,-10465.71"/>
</g>
<!-- moe_50_expert_10&#45;&gt;moe_50_aggregate -->
<g id="edge1791" class="edge">
<title>moe_50_expert_10&#45;&gt;moe_50_aggregate</title>
<path fill="none" stroke="black" d="M2375.75,-10509.02C2372.81,-10508.47 2369.88,-10507.92 2367,-10507.4 2270.42,-10489.84 2162.17,-10473.17 2073.73,-10460.32"/>
<polygon fill="black" stroke="black" points="2074,-10456.82 2063.6,-10458.85 2072.99,-10463.75 2074,-10456.82"/>
</g>
<!-- moe_50_expert_11&#45;&gt;moe_50_aggregate -->
<g id="edge1792" class="edge">
<title>moe_50_expert_11&#45;&gt;moe_50_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-10508.83C2608.83,-10508.33 2605.9,-10507.85 2603,-10507.4 2437.3,-10481.53 2248.27,-10462.91 2107.23,-10451.13"/>
<polygon fill="black" stroke="black" points="2107.41,-10447.64 2097.16,-10450.3 2106.83,-10454.61 2107.41,-10447.64"/>
</g>
<!-- moe_50_expert_12&#45;&gt;moe_50_aggregate -->
<g id="edge1793" class="edge">
<title>moe_50_expert_12&#45;&gt;moe_50_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-10508.73C2844.84,-10508.26 2841.9,-10507.82 2839,-10507.4 2595.24,-10472.47 2313.48,-10453.84 2121.68,-10444.4"/>
<polygon fill="black" stroke="black" points="2121.63,-10440.89 2111.47,-10443.9 2121.29,-10447.89 2121.63,-10440.89"/>
</g>
<!-- moe_50_expert_13&#45;&gt;moe_50_aggregate -->
<g id="edge1794" class="edge">
<title>moe_50_expert_13&#45;&gt;moe_50_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-10508.67C3080.85,-10508.22 3077.91,-10507.79 3075,-10507.4 2747.69,-10463.02 2365.55,-10446.08 2126.89,-10439.61"/>
<polygon fill="black" stroke="black" points="2126.78,-10436.11 2116.69,-10439.34 2126.6,-10443.1 2126.78,-10436.11"/>
</g>
<!-- moe_50_expert_14&#45;&gt;moe_50_aggregate -->
<g id="edge1795" class="edge">
<title>moe_50_expert_14&#45;&gt;moe_50_aggregate</title>
<path fill="none" stroke="black" d="M3319.81,-10508.63C3316.85,-10508.19 3313.91,-10507.78 3311,-10507.4 2897.21,-10453.42 2410.49,-10439.46 2128.89,-10436.19"/>
<polygon fill="black" stroke="black" points="2128.59,-10432.69 2118.55,-10436.07 2128.51,-10439.68 2128.59,-10432.69"/>
</g>
<!-- moe_50_expert_15&#45;&gt;moe_50_aggregate -->
<g id="edge1796" class="edge">
<title>moe_50_expert_15&#45;&gt;moe_50_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-10508.6C3552.85,-10508.17 3549.91,-10507.77 3547,-10507.4 3279.26,-10473.46 2513.68,-10450.66 2125.96,-10440.94"/>
<polygon fill="black" stroke="black" points="2125.83,-10437.44 2115.74,-10440.69 2125.65,-10444.44 2125.83,-10437.44"/>
</g>
<!-- moe_50_ffn -->
<g id="node1092" class="node">
<title>moe_50_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2053,-10361.86 1737,-10361.86 1737,-10309.86 2053,-10309.86 2053,-10361.86"/>
<text text-anchor="middle" x="1895" y="-10349.86" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1895" y="-10338.86" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-10327.86" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-10316.86" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_50_aggregate&#45;&gt;moe_50_ffn -->
<g id="edge1797" class="edge">
<title>moe_50_aggregate&#45;&gt;moe_50_ffn</title>
<path fill="none" stroke="black" d="M1895,-10397.6C1895,-10389.28 1895,-10380.45 1895,-10372.17"/>
<polygon fill="black" stroke="black" points="1898.5,-10372.06 1895,-10362.06 1891.5,-10372.06 1898.5,-10372.06"/>
</g>
<!-- moe_50_res2 -->
<g id="node1094" class="node">
<title>moe_50_res2</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-10273.86 1695.97,-10273.86 1558.11,-10169.86 2094.03,-10169.86 2231.89,-10273.86"/>
<text text-anchor="middle" x="1895" y="-10235.86" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1895" y="-10224.86" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-10213.86" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-10202.86" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_50_ffn&#45;&gt;moe_50_res2 -->
<g id="edge1798" class="edge">
<title>moe_50_ffn&#45;&gt;moe_50_res2</title>
<path fill="none" stroke="black" d="M1895,-10309.73C1895,-10302.04 1895,-10293.23 1895,-10284.23"/>
<polygon fill="black" stroke="black" points="1898.5,-10284.04 1895,-10274.04 1891.5,-10284.04 1898.5,-10284.04"/>
</g>
<!-- moe_50_res1&#45;&gt;moe_50_gate -->
<g id="edge1763" class="edge">
<title>moe_50_res1&#45;&gt;moe_50_gate</title>
<path fill="none" stroke="black" d="M1777,-10844.55C1777,-10836.38 1777,-10827.86 1777,-10819.48"/>
<polygon fill="black" stroke="black" points="1780.5,-10819.37 1777,-10809.37 1773.5,-10819.37 1780.5,-10819.37"/>
</g>
<!-- moe_51_mha -->
<g id="node1095" class="node">
<title>moe_51_mha</title>
<polygon fill="lightgreen" stroke="black" points="2053,-10122.86 1737,-10122.86 1737,-10070.86 2053,-10070.86 2053,-10122.86"/>
<text text-anchor="middle" x="1895" y="-10110.86" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1895" y="-10099.86" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-10088.86" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-10077.86" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_50_res2&#45;&gt;moe_51_mha -->
<g id="edge1799" class="edge">
<title>moe_50_res2&#45;&gt;moe_51_mha</title>
<path fill="none" stroke="black" d="M1895,-10169.77C1895,-10157.44 1895,-10144.53 1895,-10133.11"/>
<polygon fill="black" stroke="black" points="1898.5,-10133.1 1895,-10123.1 1891.5,-10133.1 1898.5,-10133.1"/>
</g>
<!-- moe_51_res1 -->
<g id="node1116" class="node">
<title>moe_51_res1</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-10034.86 1695.97,-10034.86 1558.11,-9930.86 2094.03,-9930.86 2231.89,-10034.86"/>
<text text-anchor="middle" x="1895" y="-9996.86" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1895" y="-9985.86" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-9974.86" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-9963.86" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_51_mha&#45;&gt;moe_51_res1 -->
<g id="edge1800" class="edge">
<title>moe_51_mha&#45;&gt;moe_51_res1</title>
<path fill="none" stroke="black" d="M1895,-10070.73C1895,-10063.04 1895,-10054.23 1895,-10045.23"/>
<polygon fill="black" stroke="black" points="1898.5,-10045.04 1895,-10035.04 1891.5,-10045.04 1898.5,-10045.04"/>
</g>
<!-- moe_51_gate -->
<g id="node1096" class="node">
<title>moe_51_gate</title>
<polygon fill="lightyellow" stroke="black" points="2223.8,-9894.86 1700.75,-9894.86 1566.2,-9790.86 2089.25,-9790.86 2223.8,-9894.86"/>
<text text-anchor="middle" x="1895" y="-9856.86" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1895" y="-9845.86" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-9834.86" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-9823.86" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_51_route -->
<g id="node1097" class="node">
<title>moe_51_route</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-9718.09" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-9732.09" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1895" y="-9721.09" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-9710.09" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-9699.09" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_51_gate&#45;&gt;moe_51_route -->
<g id="edge1802" class="edge">
<title>moe_51_gate&#45;&gt;moe_51_route</title>
<path fill="none" stroke="black" d="M1895,-9790.51C1895,-9782.1 1895,-9773.43 1895,-9765.16"/>
<polygon fill="black" stroke="black" points="1898.5,-9764.95 1895,-9754.95 1891.5,-9764.95 1898.5,-9764.95"/>
</g>
<!-- moe_51_expert_0 -->
<g id="node1098" class="node">
<title>moe_51_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-9645.32 16,-9645.32 16,-9593.32 234,-9593.32 234,-9645.32"/>
<text text-anchor="middle" x="125" y="-9633.32" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-9622.32" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-9611.32" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-9600.32" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_51_route&#45;&gt;moe_51_expert_0 -->
<g id="edge1803" class="edge">
<title>moe_51_route&#45;&gt;moe_51_expert_0</title>
<path fill="none" stroke="black" d="M1679.93,-9712.17C1302.11,-9702.8 532.75,-9680.27 244.24,-9645.36"/>
<polygon fill="black" stroke="black" points="244.54,-9641.87 234.18,-9644.12 243.68,-9648.82 244.54,-9641.87"/>
</g>
<!-- moe_51_expert_1 -->
<g id="node1099" class="node">
<title>moe_51_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-9645.32 252,-9645.32 252,-9593.32 470,-9593.32 470,-9645.32"/>
<text text-anchor="middle" x="361" y="-9633.32" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-9622.32" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-9611.32" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-9600.32" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_51_route&#45;&gt;moe_51_expert_1 -->
<g id="edge1804" class="edge">
<title>moe_51_route&#45;&gt;moe_51_expert_1</title>
<path fill="none" stroke="black" d="M1677.23,-9716.71C1400.57,-9713.81 908.56,-9700.55 480.29,-9645.4"/>
<polygon fill="black" stroke="black" points="480.55,-9641.9 470.19,-9644.09 479.65,-9648.85 480.55,-9641.9"/>
</g>
<!-- moe_51_expert_2 -->
<g id="node1100" class="node">
<title>moe_51_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-9645.32 488,-9645.32 488,-9593.32 706,-9593.32 706,-9645.32"/>
<text text-anchor="middle" x="597" y="-9633.32" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-9622.32" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-9611.32" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-9600.32" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_51_route&#45;&gt;moe_51_expert_2 -->
<g id="edge1805" class="edge">
<title>moe_51_route&#45;&gt;moe_51_expert_2</title>
<path fill="none" stroke="black" d="M1678.74,-9713.52C1443.7,-9707.44 1057.2,-9691.01 716.26,-9645.41"/>
<polygon fill="black" stroke="black" points="716.57,-9641.92 706.19,-9644.05 715.63,-9648.85 716.57,-9641.92"/>
</g>
<!-- moe_51_expert_3 -->
<g id="node1101" class="node">
<title>moe_51_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-9645.32 724,-9645.32 724,-9593.32 942,-9593.32 942,-9645.32"/>
<text text-anchor="middle" x="833" y="-9633.32" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-9622.32" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-9611.32" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-9600.32" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_51_route&#45;&gt;moe_51_expert_3 -->
<g id="edge1806" class="edge">
<title>moe_51_route&#45;&gt;moe_51_expert_3</title>
<path fill="none" stroke="black" d="M1683.7,-9709.07C1494.33,-9700 1209,-9681.69 952.47,-9645.45"/>
<polygon fill="black" stroke="black" points="952.59,-9641.94 942.2,-9643.99 951.61,-9648.87 952.59,-9641.94"/>
</g>
<!-- moe_51_expert_4 -->
<g id="node1102" class="node">
<title>moe_51_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-9645.32 960,-9645.32 960,-9593.32 1178,-9593.32 1178,-9645.32"/>
<text text-anchor="middle" x="1069" y="-9633.32" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-9622.32" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-9611.32" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-9600.32" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_51_route&#45;&gt;moe_51_expert_4 -->
<g id="edge1807" class="edge">
<title>moe_51_route&#45;&gt;moe_51_expert_4</title>
<path fill="none" stroke="black" d="M1696.66,-9702.74C1556.96,-9691.25 1365.46,-9672.76 1188.25,-9645.45"/>
<polygon fill="black" stroke="black" points="1188.63,-9641.97 1178.21,-9643.89 1187.56,-9648.89 1188.63,-9641.97"/>
</g>
<!-- moe_51_expert_5 -->
<g id="node1103" class="node">
<title>moe_51_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-9645.32 1196,-9645.32 1196,-9593.32 1414,-9593.32 1414,-9645.32"/>
<text text-anchor="middle" x="1305" y="-9633.32" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-9622.32" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-9611.32" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-9600.32" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_51_route&#45;&gt;moe_51_expert_5 -->
<g id="edge1808" class="edge">
<title>moe_51_route&#45;&gt;moe_51_expert_5</title>
<path fill="none" stroke="black" d="M1728.87,-9694.23C1640.99,-9681.55 1531.11,-9664.78 1424.25,-9645.51"/>
<polygon fill="black" stroke="black" points="1424.71,-9642.04 1414.25,-9643.7 1423.46,-9648.93 1424.71,-9642.04"/>
</g>
<!-- moe_51_expert_6 -->
<g id="node1104" class="node">
<title>moe_51_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-9645.32 1432,-9645.32 1432,-9593.32 1650,-9593.32 1650,-9645.32"/>
<text text-anchor="middle" x="1541" y="-9633.32" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-9622.32" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-9611.32" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-9600.32" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_51_route&#45;&gt;moe_51_expert_6 -->
<g id="edge1809" class="edge">
<title>moe_51_route&#45;&gt;moe_51_expert_6</title>
<path fill="none" stroke="black" d="M1782.99,-9686.47C1737.98,-9674.17 1686.47,-9660.09 1642.56,-9648.08"/>
<polygon fill="black" stroke="black" points="1643.31,-9644.66 1632.74,-9645.4 1641.46,-9651.41 1643.31,-9644.66"/>
</g>
<!-- moe_51_expert_7 -->
<g id="node1105" class="node">
<title>moe_51_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-9645.32 1668,-9645.32 1668,-9593.32 1886,-9593.32 1886,-9645.32"/>
<text text-anchor="middle" x="1777" y="-9633.32" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-9622.32" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-9611.32" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-9600.32" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_51_route&#45;&gt;moe_51_expert_7 -->
<g id="edge1810" class="edge">
<title>moe_51_route&#45;&gt;moe_51_expert_7</title>
<path fill="none" stroke="black" d="M1852.07,-9681.88C1840.07,-9672.05 1827.12,-9661.42 1815.41,-9651.82"/>
<polygon fill="black" stroke="black" points="1817.47,-9648.99 1807.52,-9645.35 1813.04,-9654.4 1817.47,-9648.99"/>
</g>
<!-- moe_51_expert_8 -->
<g id="node1106" class="node">
<title>moe_51_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-9645.32 1904,-9645.32 1904,-9593.32 2122,-9593.32 2122,-9645.32"/>
<text text-anchor="middle" x="2013" y="-9633.32" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-9622.32" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-9611.32" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-9600.32" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_51_route&#45;&gt;moe_51_expert_8 -->
<g id="edge1811" class="edge">
<title>moe_51_route&#45;&gt;moe_51_expert_8</title>
<path fill="none" stroke="black" d="M1937.93,-9681.88C1949.93,-9672.05 1962.88,-9661.42 1974.59,-9651.82"/>
<polygon fill="black" stroke="black" points="1976.96,-9654.4 1982.48,-9645.35 1972.53,-9648.99 1976.96,-9654.4"/>
</g>
<!-- moe_51_expert_9 -->
<g id="node1107" class="node">
<title>moe_51_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-9645.32 2140,-9645.32 2140,-9593.32 2358,-9593.32 2358,-9645.32"/>
<text text-anchor="middle" x="2249" y="-9633.32" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-9622.32" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-9611.32" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-9600.32" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_51_route&#45;&gt;moe_51_expert_9 -->
<g id="edge1812" class="edge">
<title>moe_51_route&#45;&gt;moe_51_expert_9</title>
<path fill="none" stroke="black" d="M2007.01,-9686.47C2052.02,-9674.17 2103.53,-9660.09 2147.44,-9648.08"/>
<polygon fill="black" stroke="black" points="2148.54,-9651.41 2157.26,-9645.4 2146.69,-9644.66 2148.54,-9651.41"/>
</g>
<!-- moe_51_expert_10 -->
<g id="node1108" class="node">
<title>moe_51_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-9645.32 2376,-9645.32 2376,-9593.32 2594,-9593.32 2594,-9645.32"/>
<text text-anchor="middle" x="2485" y="-9633.32" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-9622.32" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-9611.32" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-9600.32" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_51_route&#45;&gt;moe_51_expert_10 -->
<g id="edge1813" class="edge">
<title>moe_51_route&#45;&gt;moe_51_expert_10</title>
<path fill="none" stroke="black" d="M2061.13,-9694.23C2149.01,-9681.55 2258.89,-9664.78 2365.75,-9645.51"/>
<polygon fill="black" stroke="black" points="2366.54,-9648.93 2375.75,-9643.7 2365.29,-9642.04 2366.54,-9648.93"/>
</g>
<!-- moe_51_expert_11 -->
<g id="node1109" class="node">
<title>moe_51_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-9645.32 2612,-9645.32 2612,-9593.32 2830,-9593.32 2830,-9645.32"/>
<text text-anchor="middle" x="2721" y="-9633.32" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-9622.32" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-9611.32" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-9600.32" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_51_route&#45;&gt;moe_51_expert_11 -->
<g id="edge1814" class="edge">
<title>moe_51_route&#45;&gt;moe_51_expert_11</title>
<path fill="none" stroke="black" d="M2093.34,-9702.74C2233.04,-9691.25 2424.54,-9672.76 2601.75,-9645.45"/>
<polygon fill="black" stroke="black" points="2602.44,-9648.89 2611.79,-9643.89 2601.37,-9641.97 2602.44,-9648.89"/>
</g>
<!-- moe_51_expert_12 -->
<g id="node1110" class="node">
<title>moe_51_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-9645.32 2848,-9645.32 2848,-9593.32 3066,-9593.32 3066,-9645.32"/>
<text text-anchor="middle" x="2957" y="-9633.32" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-9622.32" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-9611.32" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-9600.32" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_51_route&#45;&gt;moe_51_expert_12 -->
<g id="edge1815" class="edge">
<title>moe_51_route&#45;&gt;moe_51_expert_12</title>
<path fill="none" stroke="black" d="M2106.3,-9709.07C2295.67,-9700 2581,-9681.69 2837.53,-9645.45"/>
<polygon fill="black" stroke="black" points="2838.39,-9648.87 2847.8,-9643.99 2837.41,-9641.94 2838.39,-9648.87"/>
</g>
<!-- moe_51_expert_13 -->
<g id="node1111" class="node">
<title>moe_51_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-9645.32 3084,-9645.32 3084,-9593.32 3302,-9593.32 3302,-9645.32"/>
<text text-anchor="middle" x="3193" y="-9633.32" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-9622.32" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-9611.32" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-9600.32" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_51_route&#45;&gt;moe_51_expert_13 -->
<g id="edge1816" class="edge">
<title>moe_51_route&#45;&gt;moe_51_expert_13</title>
<path fill="none" stroke="black" d="M2111.26,-9713.52C2346.3,-9707.44 2732.8,-9691.01 3073.74,-9645.41"/>
<polygon fill="black" stroke="black" points="3074.37,-9648.85 3083.81,-9644.05 3073.43,-9641.92 3074.37,-9648.85"/>
</g>
<!-- moe_51_expert_14 -->
<g id="node1112" class="node">
<title>moe_51_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-9645.32 3320,-9645.32 3320,-9593.32 3538,-9593.32 3538,-9645.32"/>
<text text-anchor="middle" x="3429" y="-9633.32" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-9622.32" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-9611.32" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-9600.32" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_51_route&#45;&gt;moe_51_expert_14 -->
<g id="edge1817" class="edge">
<title>moe_51_route&#45;&gt;moe_51_expert_14</title>
<path fill="none" stroke="black" d="M2112.77,-9716.71C2389.43,-9713.81 2881.44,-9700.55 3309.71,-9645.4"/>
<polygon fill="black" stroke="black" points="3310.35,-9648.85 3319.81,-9644.09 3309.45,-9641.9 3310.35,-9648.85"/>
</g>
<!-- moe_51_expert_15 -->
<g id="node1113" class="node">
<title>moe_51_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-9645.32 3556,-9645.32 3556,-9593.32 3774,-9593.32 3774,-9645.32"/>
<text text-anchor="middle" x="3665" y="-9633.32" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-9622.32" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-9611.32" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-9600.32" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_51_route&#45;&gt;moe_51_expert_15 -->
<g id="edge1818" class="edge">
<title>moe_51_route&#45;&gt;moe_51_expert_15</title>
<path fill="none" stroke="black" d="M2110.07,-9712.17C2487.89,-9702.8 3257.25,-9680.27 3545.76,-9645.36"/>
<polygon fill="black" stroke="black" points="3546.32,-9648.82 3555.82,-9644.12 3545.46,-9641.87 3546.32,-9648.82"/>
</g>
<!-- moe_51_aggregate -->
<g id="node1114" class="node">
<title>moe_51_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-9520.55" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-9534.55" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1895" y="-9523.55" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-9512.55" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1895" y="-9501.55" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_51_expert_0&#45;&gt;moe_51_aggregate -->
<g id="edge1819" class="edge">
<title>moe_51_expert_0&#45;&gt;moe_51_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-9594.53C237.15,-9594.09 240.09,-9593.69 243,-9593.32 510.74,-9559.38 1276.32,-9536.58 1664.04,-9526.87"/>
<polygon fill="black" stroke="black" points="1664.35,-9530.36 1674.26,-9526.61 1664.17,-9523.36 1664.35,-9530.36"/>
</g>
<!-- moe_51_expert_1&#45;&gt;moe_51_aggregate -->
<g id="edge1820" class="edge">
<title>moe_51_expert_1&#45;&gt;moe_51_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-9594.55C473.15,-9594.11 476.09,-9593.7 479,-9593.32 892.79,-9539.35 1379.51,-9525.38 1661.11,-9522.11"/>
<polygon fill="black" stroke="black" points="1661.49,-9525.61 1671.45,-9521.99 1661.41,-9518.61 1661.49,-9525.61"/>
</g>
<!-- moe_51_expert_2&#45;&gt;moe_51_aggregate -->
<g id="edge1821" class="edge">
<title>moe_51_expert_2&#45;&gt;moe_51_aggregate</title>
<path fill="none" stroke="black" d="M706.19,-9594.59C709.15,-9594.14 712.09,-9593.72 715,-9593.32 1042.31,-9548.94 1424.45,-9532 1663.11,-9525.53"/>
<polygon fill="black" stroke="black" points="1663.4,-9529.03 1673.31,-9525.26 1663.22,-9522.03 1663.4,-9529.03"/>
</g>
<!-- moe_51_expert_3&#45;&gt;moe_51_aggregate -->
<g id="edge1822" class="edge">
<title>moe_51_expert_3&#45;&gt;moe_51_aggregate</title>
<path fill="none" stroke="black" d="M942.2,-9594.65C945.16,-9594.18 948.1,-9593.74 951,-9593.32 1194.76,-9558.39 1476.52,-9539.76 1668.32,-9530.32"/>
<polygon fill="black" stroke="black" points="1668.71,-9533.81 1678.53,-9529.82 1668.37,-9526.82 1668.71,-9533.81"/>
</g>
<!-- moe_51_expert_4&#45;&gt;moe_51_aggregate -->
<g id="edge1823" class="edge">
<title>moe_51_expert_4&#45;&gt;moe_51_aggregate</title>
<path fill="none" stroke="black" d="M1178.21,-9594.75C1181.17,-9594.25 1184.1,-9593.77 1187,-9593.32 1352.7,-9567.45 1541.73,-9548.83 1682.77,-9537.06"/>
<polygon fill="black" stroke="black" points="1683.17,-9540.54 1692.84,-9536.22 1682.59,-9533.56 1683.17,-9540.54"/>
</g>
<!-- moe_51_expert_5&#45;&gt;moe_51_aggregate -->
<g id="edge1824" class="edge">
<title>moe_51_expert_5&#45;&gt;moe_51_aggregate</title>
<path fill="none" stroke="black" d="M1414.25,-9594.94C1417.19,-9594.39 1420.12,-9593.85 1423,-9593.32 1519.58,-9575.76 1627.83,-9559.09 1716.27,-9546.24"/>
<polygon fill="black" stroke="black" points="1717.01,-9549.67 1726.4,-9544.77 1716,-9542.74 1717.01,-9549.67"/>
</g>
<!-- moe_51_expert_6&#45;&gt;moe_51_aggregate -->
<g id="edge1825" class="edge">
<title>moe_51_expert_6&#45;&gt;moe_51_aggregate</title>
<path fill="none" stroke="black" d="M1632.62,-9593.27C1675.27,-9581.62 1726.62,-9567.58 1772.54,-9555.03"/>
<polygon fill="black" stroke="black" points="1773.53,-9558.39 1782.25,-9552.37 1771.68,-9551.63 1773.53,-9558.39"/>
</g>
<!-- moe_51_expert_7&#45;&gt;moe_51_aggregate -->
<g id="edge1826" class="edge">
<title>moe_51_expert_7&#45;&gt;moe_51_aggregate</title>
<path fill="none" stroke="black" d="M1807.7,-9593.15C1818.79,-9584.05 1831.63,-9573.52 1843.99,-9563.38"/>
<polygon fill="black" stroke="black" points="1846.51,-9565.84 1852.02,-9556.8 1842.07,-9560.43 1846.51,-9565.84"/>
</g>
<!-- moe_51_expert_8&#45;&gt;moe_51_aggregate -->
<g id="edge1827" class="edge">
<title>moe_51_expert_8&#45;&gt;moe_51_aggregate</title>
<path fill="none" stroke="black" d="M1982.3,-9593.15C1971.21,-9584.05 1958.37,-9573.52 1946.01,-9563.38"/>
<polygon fill="black" stroke="black" points="1947.93,-9560.43 1937.98,-9556.8 1943.49,-9565.84 1947.93,-9560.43"/>
</g>
<!-- moe_51_expert_9&#45;&gt;moe_51_aggregate -->
<g id="edge1828" class="edge">
<title>moe_51_expert_9&#45;&gt;moe_51_aggregate</title>
<path fill="none" stroke="black" d="M2157.38,-9593.27C2114.73,-9581.62 2063.38,-9567.58 2017.46,-9555.03"/>
<polygon fill="black" stroke="black" points="2018.32,-9551.63 2007.75,-9552.37 2016.47,-9558.39 2018.32,-9551.63"/>
</g>
<!-- moe_51_expert_10&#45;&gt;moe_51_aggregate -->
<g id="edge1829" class="edge">
<title>moe_51_expert_10&#45;&gt;moe_51_aggregate</title>
<path fill="none" stroke="black" d="M2375.75,-9594.94C2372.81,-9594.39 2369.88,-9593.85 2367,-9593.32 2270.42,-9575.76 2162.17,-9559.09 2073.73,-9546.24"/>
<polygon fill="black" stroke="black" points="2074,-9542.74 2063.6,-9544.77 2072.99,-9549.67 2074,-9542.74"/>
</g>
<!-- moe_51_expert_11&#45;&gt;moe_51_aggregate -->
<g id="edge1830" class="edge">
<title>moe_51_expert_11&#45;&gt;moe_51_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-9594.75C2608.83,-9594.25 2605.9,-9593.77 2603,-9593.32 2437.3,-9567.45 2248.27,-9548.83 2107.23,-9537.06"/>
<polygon fill="black" stroke="black" points="2107.41,-9533.56 2097.16,-9536.22 2106.83,-9540.54 2107.41,-9533.56"/>
</g>
<!-- moe_51_expert_12&#45;&gt;moe_51_aggregate -->
<g id="edge1831" class="edge">
<title>moe_51_expert_12&#45;&gt;moe_51_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-9594.65C2844.84,-9594.18 2841.9,-9593.74 2839,-9593.32 2595.24,-9558.39 2313.48,-9539.76 2121.68,-9530.32"/>
<polygon fill="black" stroke="black" points="2121.63,-9526.82 2111.47,-9529.82 2121.29,-9533.81 2121.63,-9526.82"/>
</g>
<!-- moe_51_expert_13&#45;&gt;moe_51_aggregate -->
<g id="edge1832" class="edge">
<title>moe_51_expert_13&#45;&gt;moe_51_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-9594.59C3080.85,-9594.14 3077.91,-9593.72 3075,-9593.32 2747.69,-9548.94 2365.55,-9532 2126.89,-9525.53"/>
<polygon fill="black" stroke="black" points="2126.78,-9522.03 2116.69,-9525.26 2126.6,-9529.03 2126.78,-9522.03"/>
</g>
<!-- moe_51_expert_14&#45;&gt;moe_51_aggregate -->
<g id="edge1833" class="edge">
<title>moe_51_expert_14&#45;&gt;moe_51_aggregate</title>
<path fill="none" stroke="black" d="M3319.81,-9594.55C3316.85,-9594.11 3313.91,-9593.7 3311,-9593.32 2897.21,-9539.35 2410.49,-9525.38 2128.89,-9522.11"/>
<polygon fill="black" stroke="black" points="2128.59,-9518.61 2118.55,-9521.99 2128.51,-9525.61 2128.59,-9518.61"/>
</g>
<!-- moe_51_expert_15&#45;&gt;moe_51_aggregate -->
<g id="edge1834" class="edge">
<title>moe_51_expert_15&#45;&gt;moe_51_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-9594.53C3552.85,-9594.09 3549.91,-9593.69 3547,-9593.32 3279.26,-9559.38 2513.68,-9536.58 2125.96,-9526.87"/>
<polygon fill="black" stroke="black" points="2125.83,-9523.36 2115.74,-9526.61 2125.65,-9530.36 2125.83,-9523.36"/>
</g>
<!-- moe_51_ffn -->
<g id="node1115" class="node">
<title>moe_51_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2053,-9447.78 1737,-9447.78 1737,-9395.78 2053,-9395.78 2053,-9447.78"/>
<text text-anchor="middle" x="1895" y="-9435.78" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1895" y="-9424.78" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-9413.78" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-9402.78" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_51_aggregate&#45;&gt;moe_51_ffn -->
<g id="edge1835" class="edge">
<title>moe_51_aggregate&#45;&gt;moe_51_ffn</title>
<path fill="none" stroke="black" d="M1895,-9483.52C1895,-9475.21 1895,-9466.37 1895,-9458.09"/>
<polygon fill="black" stroke="black" points="1898.5,-9457.98 1895,-9447.98 1891.5,-9457.98 1898.5,-9457.98"/>
</g>
<!-- moe_51_res2 -->
<g id="node1117" class="node">
<title>moe_51_res2</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-9359.78 1695.97,-9359.78 1558.11,-9255.78 2094.03,-9255.78 2231.89,-9359.78"/>
<text text-anchor="middle" x="1895" y="-9321.78" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1895" y="-9310.78" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-9299.78" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-9288.78" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_51_ffn&#45;&gt;moe_51_res2 -->
<g id="edge1836" class="edge">
<title>moe_51_ffn&#45;&gt;moe_51_res2</title>
<path fill="none" stroke="black" d="M1895,-9395.65C1895,-9387.96 1895,-9379.15 1895,-9370.15"/>
<polygon fill="black" stroke="black" points="1898.5,-9369.96 1895,-9359.96 1891.5,-9369.96 1898.5,-9369.96"/>
</g>
<!-- moe_51_res1&#45;&gt;moe_51_gate -->
<g id="edge1801" class="edge">
<title>moe_51_res1&#45;&gt;moe_51_gate</title>
<path fill="none" stroke="black" d="M1895,-9930.47C1895,-9922.3 1895,-9913.78 1895,-9905.4"/>
<polygon fill="black" stroke="black" points="1898.5,-9905.29 1895,-9895.29 1891.5,-9905.29 1898.5,-9905.29"/>
</g>
<!-- moe_52_mha -->
<g id="node1118" class="node">
<title>moe_52_mha</title>
<polygon fill="lightgreen" stroke="black" points="2053,-9208.78 1737,-9208.78 1737,-9156.78 2053,-9156.78 2053,-9208.78"/>
<text text-anchor="middle" x="1895" y="-9196.78" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1895" y="-9185.78" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-9174.78" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-9163.78" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_51_res2&#45;&gt;moe_52_mha -->
<g id="edge1837" class="edge">
<title>moe_51_res2&#45;&gt;moe_52_mha</title>
<path fill="none" stroke="black" d="M1895,-9255.69C1895,-9243.36 1895,-9230.45 1895,-9219.03"/>
<polygon fill="black" stroke="black" points="1898.5,-9219.02 1895,-9209.02 1891.5,-9219.02 1898.5,-9219.02"/>
</g>
<!-- moe_52_res1 -->
<g id="node1139" class="node">
<title>moe_52_res1</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-9120.78 1695.97,-9120.78 1558.11,-9016.78 2094.03,-9016.78 2231.89,-9120.78"/>
<text text-anchor="middle" x="1895" y="-9082.78" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1895" y="-9071.78" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-9060.78" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-9049.78" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_52_mha&#45;&gt;moe_52_res1 -->
<g id="edge1838" class="edge">
<title>moe_52_mha&#45;&gt;moe_52_res1</title>
<path fill="none" stroke="black" d="M1895,-9156.65C1895,-9148.96 1895,-9140.15 1895,-9131.15"/>
<polygon fill="black" stroke="black" points="1898.5,-9130.96 1895,-9120.96 1891.5,-9130.96 1898.5,-9130.96"/>
</g>
<!-- moe_52_gate -->
<g id="node1119" class="node">
<title>moe_52_gate</title>
<polygon fill="lightyellow" stroke="black" points="2223.8,-8980.78 1700.75,-8980.78 1566.2,-8876.78 2089.25,-8876.78 2223.8,-8980.78"/>
<text text-anchor="middle" x="1895" y="-8942.78" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1895" y="-8931.78" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-8920.78" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-8909.78" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_52_route -->
<g id="node1120" class="node">
<title>moe_52_route</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-8804.01" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-8818.01" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1895" y="-8807.01" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-8796.01" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-8785.01" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_52_gate&#45;&gt;moe_52_route -->
<g id="edge1840" class="edge">
<title>moe_52_gate&#45;&gt;moe_52_route</title>
<path fill="none" stroke="black" d="M1895,-8876.43C1895,-8868.02 1895,-8859.35 1895,-8851.08"/>
<polygon fill="black" stroke="black" points="1898.5,-8850.87 1895,-8840.87 1891.5,-8850.87 1898.5,-8850.87"/>
</g>
<!-- moe_52_expert_0 -->
<g id="node1121" class="node">
<title>moe_52_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-8731.24 16,-8731.24 16,-8679.24 234,-8679.24 234,-8731.24"/>
<text text-anchor="middle" x="125" y="-8719.24" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-8708.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-8697.24" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-8686.24" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_52_route&#45;&gt;moe_52_expert_0 -->
<g id="edge1841" class="edge">
<title>moe_52_route&#45;&gt;moe_52_expert_0</title>
<path fill="none" stroke="black" d="M1679.93,-8798.09C1302.11,-8788.72 532.75,-8766.19 244.24,-8731.29"/>
<polygon fill="black" stroke="black" points="244.54,-8727.8 234.18,-8730.04 243.68,-8734.74 244.54,-8727.8"/>
</g>
<!-- moe_52_expert_1 -->
<g id="node1122" class="node">
<title>moe_52_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-8731.24 252,-8731.24 252,-8679.24 470,-8679.24 470,-8731.24"/>
<text text-anchor="middle" x="361" y="-8719.24" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-8708.24" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-8697.24" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-8686.24" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_52_route&#45;&gt;moe_52_expert_1 -->
<g id="edge1842" class="edge">
<title>moe_52_route&#45;&gt;moe_52_expert_1</title>
<path fill="none" stroke="black" d="M1677.23,-8802.63C1400.57,-8799.73 908.56,-8786.47 480.29,-8731.32"/>
<polygon fill="black" stroke="black" points="480.55,-8727.83 470.19,-8730.01 479.65,-8734.77 480.55,-8727.83"/>
</g>
<!-- moe_52_expert_2 -->
<g id="node1123" class="node">
<title>moe_52_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-8731.24 488,-8731.24 488,-8679.24 706,-8679.24 706,-8731.24"/>
<text text-anchor="middle" x="597" y="-8719.24" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-8708.24" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-8697.24" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-8686.24" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_52_route&#45;&gt;moe_52_expert_2 -->
<g id="edge1843" class="edge">
<title>moe_52_route&#45;&gt;moe_52_expert_2</title>
<path fill="none" stroke="black" d="M1678.74,-8799.45C1443.7,-8793.36 1057.2,-8776.93 716.26,-8731.33"/>
<polygon fill="black" stroke="black" points="716.57,-8727.84 706.19,-8729.97 715.63,-8734.78 716.57,-8727.84"/>
</g>
<!-- moe_52_expert_3 -->
<g id="node1124" class="node">
<title>moe_52_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-8731.24 724,-8731.24 724,-8679.24 942,-8679.24 942,-8731.24"/>
<text text-anchor="middle" x="833" y="-8719.24" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-8708.24" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-8697.24" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-8686.24" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_52_route&#45;&gt;moe_52_expert_3 -->
<g id="edge1844" class="edge">
<title>moe_52_route&#45;&gt;moe_52_expert_3</title>
<path fill="none" stroke="black" d="M1683.7,-8794.99C1494.33,-8785.92 1209,-8767.61 952.47,-8731.37"/>
<polygon fill="black" stroke="black" points="952.59,-8727.86 942.2,-8729.91 951.61,-8734.79 952.59,-8727.86"/>
</g>
<!-- moe_52_expert_4 -->
<g id="node1125" class="node">
<title>moe_52_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-8731.24 960,-8731.24 960,-8679.24 1178,-8679.24 1178,-8731.24"/>
<text text-anchor="middle" x="1069" y="-8719.24" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-8708.24" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-8697.24" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-8686.24" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_52_route&#45;&gt;moe_52_expert_4 -->
<g id="edge1845" class="edge">
<title>moe_52_route&#45;&gt;moe_52_expert_4</title>
<path fill="none" stroke="black" d="M1696.66,-8788.66C1556.96,-8777.18 1365.46,-8758.68 1188.25,-8731.37"/>
<polygon fill="black" stroke="black" points="1188.63,-8727.89 1178.21,-8729.81 1187.56,-8734.81 1188.63,-8727.89"/>
</g>
<!-- moe_52_expert_5 -->
<g id="node1126" class="node">
<title>moe_52_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-8731.24 1196,-8731.24 1196,-8679.24 1414,-8679.24 1414,-8731.24"/>
<text text-anchor="middle" x="1305" y="-8719.24" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-8708.24" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-8697.24" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-8686.24" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_52_route&#45;&gt;moe_52_expert_5 -->
<g id="edge1846" class="edge">
<title>moe_52_route&#45;&gt;moe_52_expert_5</title>
<path fill="none" stroke="black" d="M1728.87,-8780.15C1640.99,-8767.47 1531.11,-8750.7 1424.25,-8731.43"/>
<polygon fill="black" stroke="black" points="1424.71,-8727.96 1414.25,-8729.62 1423.46,-8734.85 1424.71,-8727.96"/>
</g>
<!-- moe_52_expert_6 -->
<g id="node1127" class="node">
<title>moe_52_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-8731.24 1432,-8731.24 1432,-8679.24 1650,-8679.24 1650,-8731.24"/>
<text text-anchor="middle" x="1541" y="-8719.24" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-8708.24" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-8697.24" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-8686.24" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_52_route&#45;&gt;moe_52_expert_6 -->
<g id="edge1847" class="edge">
<title>moe_52_route&#45;&gt;moe_52_expert_6</title>
<path fill="none" stroke="black" d="M1782.99,-8772.39C1737.98,-8760.09 1686.47,-8746.01 1642.56,-8734.01"/>
<polygon fill="black" stroke="black" points="1643.31,-8730.58 1632.74,-8731.32 1641.46,-8737.33 1643.31,-8730.58"/>
</g>
<!-- moe_52_expert_7 -->
<g id="node1128" class="node">
<title>moe_52_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-8731.24 1668,-8731.24 1668,-8679.24 1886,-8679.24 1886,-8731.24"/>
<text text-anchor="middle" x="1777" y="-8719.24" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-8708.24" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-8697.24" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-8686.24" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_52_route&#45;&gt;moe_52_expert_7 -->
<g id="edge1848" class="edge">
<title>moe_52_route&#45;&gt;moe_52_expert_7</title>
<path fill="none" stroke="black" d="M1852.07,-8767.8C1840.07,-8757.97 1827.12,-8747.35 1815.41,-8737.74"/>
<polygon fill="black" stroke="black" points="1817.47,-8734.91 1807.52,-8731.27 1813.04,-8740.32 1817.47,-8734.91"/>
</g>
<!-- moe_52_expert_8 -->
<g id="node1129" class="node">
<title>moe_52_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-8731.24 1904,-8731.24 1904,-8679.24 2122,-8679.24 2122,-8731.24"/>
<text text-anchor="middle" x="2013" y="-8719.24" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-8708.24" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-8697.24" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-8686.24" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_52_route&#45;&gt;moe_52_expert_8 -->
<g id="edge1849" class="edge">
<title>moe_52_route&#45;&gt;moe_52_expert_8</title>
<path fill="none" stroke="black" d="M1937.93,-8767.8C1949.93,-8757.97 1962.88,-8747.35 1974.59,-8737.74"/>
<polygon fill="black" stroke="black" points="1976.96,-8740.32 1982.48,-8731.27 1972.53,-8734.91 1976.96,-8740.32"/>
</g>
<!-- moe_52_expert_9 -->
<g id="node1130" class="node">
<title>moe_52_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-8731.24 2140,-8731.24 2140,-8679.24 2358,-8679.24 2358,-8731.24"/>
<text text-anchor="middle" x="2249" y="-8719.24" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-8708.24" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-8697.24" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-8686.24" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_52_route&#45;&gt;moe_52_expert_9 -->
<g id="edge1850" class="edge">
<title>moe_52_route&#45;&gt;moe_52_expert_9</title>
<path fill="none" stroke="black" d="M2007.01,-8772.39C2052.02,-8760.09 2103.53,-8746.01 2147.44,-8734.01"/>
<polygon fill="black" stroke="black" points="2148.54,-8737.33 2157.26,-8731.32 2146.69,-8730.58 2148.54,-8737.33"/>
</g>
<!-- moe_52_expert_10 -->
<g id="node1131" class="node">
<title>moe_52_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-8731.24 2376,-8731.24 2376,-8679.24 2594,-8679.24 2594,-8731.24"/>
<text text-anchor="middle" x="2485" y="-8719.24" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-8708.24" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-8697.24" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-8686.24" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_52_route&#45;&gt;moe_52_expert_10 -->
<g id="edge1851" class="edge">
<title>moe_52_route&#45;&gt;moe_52_expert_10</title>
<path fill="none" stroke="black" d="M2061.13,-8780.15C2149.01,-8767.47 2258.89,-8750.7 2365.75,-8731.43"/>
<polygon fill="black" stroke="black" points="2366.54,-8734.85 2375.75,-8729.62 2365.29,-8727.96 2366.54,-8734.85"/>
</g>
<!-- moe_52_expert_11 -->
<g id="node1132" class="node">
<title>moe_52_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-8731.24 2612,-8731.24 2612,-8679.24 2830,-8679.24 2830,-8731.24"/>
<text text-anchor="middle" x="2721" y="-8719.24" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-8708.24" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-8697.24" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-8686.24" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_52_route&#45;&gt;moe_52_expert_11 -->
<g id="edge1852" class="edge">
<title>moe_52_route&#45;&gt;moe_52_expert_11</title>
<path fill="none" stroke="black" d="M2093.34,-8788.66C2233.04,-8777.18 2424.54,-8758.68 2601.75,-8731.37"/>
<polygon fill="black" stroke="black" points="2602.44,-8734.81 2611.79,-8729.81 2601.37,-8727.89 2602.44,-8734.81"/>
</g>
<!-- moe_52_expert_12 -->
<g id="node1133" class="node">
<title>moe_52_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-8731.24 2848,-8731.24 2848,-8679.24 3066,-8679.24 3066,-8731.24"/>
<text text-anchor="middle" x="2957" y="-8719.24" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-8708.24" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-8697.24" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-8686.24" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_52_route&#45;&gt;moe_52_expert_12 -->
<g id="edge1853" class="edge">
<title>moe_52_route&#45;&gt;moe_52_expert_12</title>
<path fill="none" stroke="black" d="M2106.3,-8794.99C2295.67,-8785.92 2581,-8767.61 2837.53,-8731.37"/>
<polygon fill="black" stroke="black" points="2838.39,-8734.79 2847.8,-8729.91 2837.41,-8727.86 2838.39,-8734.79"/>
</g>
<!-- moe_52_expert_13 -->
<g id="node1134" class="node">
<title>moe_52_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-8731.24 3084,-8731.24 3084,-8679.24 3302,-8679.24 3302,-8731.24"/>
<text text-anchor="middle" x="3193" y="-8719.24" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-8708.24" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-8697.24" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-8686.24" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_52_route&#45;&gt;moe_52_expert_13 -->
<g id="edge1854" class="edge">
<title>moe_52_route&#45;&gt;moe_52_expert_13</title>
<path fill="none" stroke="black" d="M2111.26,-8799.45C2346.3,-8793.36 2732.8,-8776.93 3073.74,-8731.33"/>
<polygon fill="black" stroke="black" points="3074.37,-8734.78 3083.81,-8729.97 3073.43,-8727.84 3074.37,-8734.78"/>
</g>
<!-- moe_52_expert_14 -->
<g id="node1135" class="node">
<title>moe_52_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-8731.24 3320,-8731.24 3320,-8679.24 3538,-8679.24 3538,-8731.24"/>
<text text-anchor="middle" x="3429" y="-8719.24" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-8708.24" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-8697.24" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-8686.24" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_52_route&#45;&gt;moe_52_expert_14 -->
<g id="edge1855" class="edge">
<title>moe_52_route&#45;&gt;moe_52_expert_14</title>
<path fill="none" stroke="black" d="M2112.77,-8802.63C2389.43,-8799.73 2881.44,-8786.47 3309.71,-8731.32"/>
<polygon fill="black" stroke="black" points="3310.35,-8734.77 3319.81,-8730.01 3309.45,-8727.83 3310.35,-8734.77"/>
</g>
<!-- moe_52_expert_15 -->
<g id="node1136" class="node">
<title>moe_52_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-8731.24 3556,-8731.24 3556,-8679.24 3774,-8679.24 3774,-8731.24"/>
<text text-anchor="middle" x="3665" y="-8719.24" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-8708.24" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-8697.24" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-8686.24" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_52_route&#45;&gt;moe_52_expert_15 -->
<g id="edge1856" class="edge">
<title>moe_52_route&#45;&gt;moe_52_expert_15</title>
<path fill="none" stroke="black" d="M2110.07,-8798.09C2487.89,-8788.72 3257.25,-8766.19 3545.76,-8731.29"/>
<polygon fill="black" stroke="black" points="3546.32,-8734.74 3555.82,-8730.04 3545.46,-8727.8 3546.32,-8734.74"/>
</g>
<!-- moe_52_aggregate -->
<g id="node1137" class="node">
<title>moe_52_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1777" cy="-8606.47" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1777" y="-8620.47" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1777" y="-8609.47" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1777" y="-8598.47" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1777" y="-8587.47" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_52_expert_0&#45;&gt;moe_52_aggregate -->
<g id="edge1857" class="edge">
<title>moe_52_expert_0&#45;&gt;moe_52_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-8680.46C237.15,-8680.02 240.09,-8679.62 243,-8679.24 488.12,-8647.75 1182.7,-8624.23 1547.21,-8613.65"/>
<polygon fill="black" stroke="black" points="1547.47,-8617.15 1557.36,-8613.36 1547.27,-8610.15 1547.47,-8617.15"/>
</g>
<!-- moe_52_expert_1&#45;&gt;moe_52_aggregate -->
<g id="edge1858" class="edge">
<title>moe_52_expert_1&#45;&gt;moe_52_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-8680.49C473.15,-8680.05 476.09,-8679.63 479,-8679.24 849.22,-8630.09 1283.16,-8614.49 1543.76,-8609.61"/>
<polygon fill="black" stroke="black" points="1544.17,-8613.1 1554.11,-8609.42 1544.05,-8606.1 1544.17,-8613.1"/>
</g>
<!-- moe_52_expert_2&#45;&gt;moe_52_aggregate -->
<g id="edge1859" class="edge">
<title>moe_52_expert_2&#45;&gt;moe_52_aggregate</title>
<path fill="none" stroke="black" d="M706.2,-8680.54C709.16,-8680.08 712.1,-8679.65 715,-8679.24 1000.02,-8639.62 1331.23,-8621.65 1546.98,-8613.65"/>
<polygon fill="black" stroke="black" points="1547.3,-8617.14 1557.17,-8613.27 1547.05,-8610.14 1547.3,-8617.14"/>
</g>
<!-- moe_52_expert_3&#45;&gt;moe_52_aggregate -->
<g id="edge1860" class="edge">
<title>moe_52_expert_3&#45;&gt;moe_52_aggregate</title>
<path fill="none" stroke="black" d="M942.21,-8680.62C945.16,-8680.13 948.1,-8679.67 951,-8679.24 1154.78,-8648.92 1388.89,-8630.07 1555.72,-8619.34"/>
<polygon fill="black" stroke="black" points="1556.35,-8622.81 1566.11,-8618.68 1555.91,-8615.82 1556.35,-8622.81"/>
</g>
<!-- moe_52_expert_4&#45;&gt;moe_52_aggregate -->
<g id="edge1861" class="edge">
<title>moe_52_expert_4&#45;&gt;moe_52_aggregate</title>
<path fill="none" stroke="black" d="M1178.23,-8680.75C1181.18,-8680.23 1184.11,-8679.72 1187,-8679.24 1316.69,-8657.66 1463.43,-8639.78 1578.13,-8627.27"/>
<polygon fill="black" stroke="black" points="1578.51,-8630.75 1588.07,-8626.19 1577.75,-8623.79 1578.51,-8630.75"/>
</g>
<!-- moe_52_expert_5&#45;&gt;moe_52_aggregate -->
<g id="edge1862" class="edge">
<title>moe_52_expert_5&#45;&gt;moe_52_aggregate</title>
<path fill="none" stroke="black" d="M1414.28,-8681.05C1417.22,-8680.44 1420.13,-8679.84 1423,-8679.24 1490.32,-8665.29 1564.9,-8650.12 1628.19,-8637.34"/>
<polygon fill="black" stroke="black" points="1629.13,-8640.72 1638.24,-8635.31 1627.75,-8633.86 1629.13,-8640.72"/>
</g>
<!-- moe_52_expert_6&#45;&gt;moe_52_aggregate -->
<g id="edge1863" class="edge">
<title>moe_52_expert_6&#45;&gt;moe_52_aggregate</title>
<path fill="none" stroke="black" d="M1602.08,-8679.2C1627.73,-8668.68 1658.09,-8656.23 1686.26,-8644.68"/>
<polygon fill="black" stroke="black" points="1687.79,-8647.84 1695.72,-8640.8 1685.14,-8641.36 1687.79,-8647.84"/>
</g>
<!-- moe_52_expert_7&#45;&gt;moe_52_aggregate -->
<g id="edge1864" class="edge">
<title>moe_52_expert_7&#45;&gt;moe_52_aggregate</title>
<path fill="none" stroke="black" d="M1777,-8679.07C1777,-8671.26 1777,-8662.4 1777,-8653.63"/>
<polygon fill="black" stroke="black" points="1780.5,-8653.45 1777,-8643.45 1773.5,-8653.45 1780.5,-8653.45"/>
</g>
<!-- moe_52_expert_8&#45;&gt;moe_52_aggregate -->
<g id="edge1865" class="edge">
<title>moe_52_expert_8&#45;&gt;moe_52_aggregate</title>
<path fill="none" stroke="black" d="M1951.92,-8679.2C1926.27,-8668.68 1895.91,-8656.23 1867.74,-8644.68"/>
<polygon fill="black" stroke="black" points="1868.86,-8641.36 1858.28,-8640.8 1866.21,-8647.84 1868.86,-8641.36"/>
</g>
<!-- moe_52_expert_9&#45;&gt;moe_52_aggregate -->
<g id="edge1866" class="edge">
<title>moe_52_expert_9&#45;&gt;moe_52_aggregate</title>
<path fill="none" stroke="black" d="M2139.72,-8681.05C2136.78,-8680.44 2133.87,-8679.84 2131,-8679.24 2063.68,-8665.29 1989.1,-8650.12 1925.81,-8637.34"/>
<polygon fill="black" stroke="black" points="1926.25,-8633.86 1915.76,-8635.31 1924.87,-8640.72 1926.25,-8633.86"/>
</g>
<!-- moe_52_expert_10&#45;&gt;moe_52_aggregate -->
<g id="edge1867" class="edge">
<title>moe_52_expert_10&#45;&gt;moe_52_aggregate</title>
<path fill="none" stroke="black" d="M2375.77,-8680.75C2372.82,-8680.23 2369.89,-8679.72 2367,-8679.24 2237.31,-8657.66 2090.57,-8639.78 1975.87,-8627.27"/>
<polygon fill="black" stroke="black" points="1976.25,-8623.79 1965.93,-8626.19 1975.49,-8630.75 1976.25,-8623.79"/>
</g>
<!-- moe_52_expert_11&#45;&gt;moe_52_aggregate -->
<g id="edge1868" class="edge">
<title>moe_52_expert_11&#45;&gt;moe_52_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-8680.62C2608.84,-8680.13 2605.9,-8679.67 2603,-8679.24 2399.22,-8648.92 2165.11,-8630.07 1998.28,-8619.34"/>
<polygon fill="black" stroke="black" points="1998.09,-8615.82 1987.89,-8618.68 1997.65,-8622.81 1998.09,-8615.82"/>
</g>
<!-- moe_52_expert_12&#45;&gt;moe_52_aggregate -->
<g id="edge1869" class="edge">
<title>moe_52_expert_12&#45;&gt;moe_52_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-8680.54C2844.84,-8680.08 2841.9,-8679.65 2839,-8679.24 2553.98,-8639.62 2222.77,-8621.65 2007.02,-8613.65"/>
<polygon fill="black" stroke="black" points="2006.95,-8610.14 1996.83,-8613.27 2006.7,-8617.14 2006.95,-8610.14"/>
</g>
<!-- moe_52_expert_13&#45;&gt;moe_52_aggregate -->
<g id="edge1870" class="edge">
<title>moe_52_expert_13&#45;&gt;moe_52_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-8680.49C3080.85,-8680.05 3077.91,-8679.63 3075,-8679.24 2704.78,-8630.09 2270.84,-8614.49 2010.24,-8609.61"/>
<polygon fill="black" stroke="black" points="2009.95,-8606.1 1999.89,-8609.42 2009.83,-8613.1 2009.95,-8606.1"/>
</g>
<!-- moe_52_expert_14&#45;&gt;moe_52_aggregate -->
<g id="edge1871" class="edge">
<title>moe_52_expert_14&#45;&gt;moe_52_aggregate</title>
<path fill="none" stroke="black" d="M3319.82,-8680.46C3316.85,-8680.02 3313.91,-8679.62 3311,-8679.24 3065.88,-8647.75 2371.3,-8624.23 2006.79,-8613.65"/>
<polygon fill="black" stroke="black" points="2006.73,-8610.15 1996.64,-8613.36 2006.53,-8617.15 2006.73,-8610.15"/>
</g>
<!-- moe_52_expert_15&#45;&gt;moe_52_aggregate -->
<g id="edge1872" class="edge">
<title>moe_52_expert_15&#45;&gt;moe_52_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-8680.44C3552.85,-8680.01 3549.91,-8679.61 3547,-8679.24 3256.39,-8642.83 2418.41,-8620.87 2008.44,-8612.02"/>
<polygon fill="black" stroke="black" points="2008.31,-8608.51 1998.24,-8611.8 2008.16,-8615.51 2008.31,-8608.51"/>
</g>
<!-- moe_52_ffn -->
<g id="node1138" class="node">
<title>moe_52_ffn</title>
<polygon fill="lightgreen" stroke="black" points="1935,-8533.7 1619,-8533.7 1619,-8481.7 1935,-8481.7 1935,-8533.7"/>
<text text-anchor="middle" x="1777" y="-8521.7" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1777" y="-8510.7" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-8499.7" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-8488.7" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_52_aggregate&#45;&gt;moe_52_ffn -->
<g id="edge1873" class="edge">
<title>moe_52_aggregate&#45;&gt;moe_52_ffn</title>
<path fill="none" stroke="black" d="M1777,-8569.44C1777,-8561.13 1777,-8552.29 1777,-8544.01"/>
<polygon fill="black" stroke="black" points="1780.5,-8543.9 1777,-8533.9 1773.5,-8543.9 1780.5,-8543.9"/>
</g>
<!-- moe_52_res2 -->
<g id="node1140" class="node">
<title>moe_52_res2</title>
<polygon fill="lightyellow" stroke="black" points="2113.89,-8445.7 1577.97,-8445.7 1440.11,-8341.7 1976.03,-8341.7 2113.89,-8445.7"/>
<text text-anchor="middle" x="1777" y="-8407.7" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1777" y="-8396.7" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-8385.7" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1777" y="-8374.7" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_52_ffn&#45;&gt;moe_52_res2 -->
<g id="edge1874" class="edge">
<title>moe_52_ffn&#45;&gt;moe_52_res2</title>
<path fill="none" stroke="black" d="M1777,-8481.57C1777,-8473.88 1777,-8465.07 1777,-8456.07"/>
<polygon fill="black" stroke="black" points="1780.5,-8455.88 1777,-8445.88 1773.5,-8455.88 1780.5,-8455.88"/>
</g>
<!-- moe_52_res1&#45;&gt;moe_52_gate -->
<g id="edge1839" class="edge">
<title>moe_52_res1&#45;&gt;moe_52_gate</title>
<path fill="none" stroke="black" d="M1895,-9016.4C1895,-9008.22 1895,-8999.7 1895,-8991.32"/>
<polygon fill="black" stroke="black" points="1898.5,-8991.21 1895,-8981.21 1891.5,-8991.21 1898.5,-8991.21"/>
</g>
<!-- moe_53_mha -->
<g id="node1141" class="node">
<title>moe_53_mha</title>
<polygon fill="lightgreen" stroke="black" points="1935,-8294.7 1619,-8294.7 1619,-8242.7 1935,-8242.7 1935,-8294.7"/>
<text text-anchor="middle" x="1777" y="-8282.7" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1777" y="-8271.7" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-8260.7" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-8249.7" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_52_res2&#45;&gt;moe_53_mha -->
<g id="edge1875" class="edge">
<title>moe_52_res2&#45;&gt;moe_53_mha</title>
<path fill="none" stroke="black" d="M1777,-8341.61C1777,-8329.28 1777,-8316.37 1777,-8304.95"/>
<polygon fill="black" stroke="black" points="1780.5,-8304.95 1777,-8294.95 1773.5,-8304.95 1780.5,-8304.95"/>
</g>
<!-- moe_53_res1 -->
<g id="node1162" class="node">
<title>moe_53_res1</title>
<polygon fill="lightyellow" stroke="black" points="2113.89,-8206.7 1577.97,-8206.7 1440.11,-8102.7 1976.03,-8102.7 2113.89,-8206.7"/>
<text text-anchor="middle" x="1777" y="-8168.7" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1777" y="-8157.7" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-8146.7" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1777" y="-8135.7" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_53_mha&#45;&gt;moe_53_res1 -->
<g id="edge1876" class="edge">
<title>moe_53_mha&#45;&gt;moe_53_res1</title>
<path fill="none" stroke="black" d="M1777,-8242.57C1777,-8234.88 1777,-8226.07 1777,-8217.07"/>
<polygon fill="black" stroke="black" points="1780.5,-8216.88 1777,-8206.88 1773.5,-8216.88 1780.5,-8216.88"/>
</g>
<!-- moe_53_gate -->
<g id="node1142" class="node">
<title>moe_53_gate</title>
<polygon fill="lightyellow" stroke="black" points="2105.8,-8066.7 1582.75,-8066.7 1448.2,-7962.7 1971.25,-7962.7 2105.8,-8066.7"/>
<text text-anchor="middle" x="1777" y="-8028.7" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1777" y="-8017.7" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-8006.7" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-7995.7" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_53_route -->
<g id="node1143" class="node">
<title>moe_53_route</title>
<ellipse fill="lightblue" stroke="black" cx="1777" cy="-7889.93" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1777" y="-7903.93" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1777" y="-7892.93" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1777" y="-7881.93" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-7870.93" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_53_gate&#45;&gt;moe_53_route -->
<g id="edge1878" class="edge">
<title>moe_53_gate&#45;&gt;moe_53_route</title>
<path fill="none" stroke="black" d="M1777,-7962.35C1777,-7953.94 1777,-7945.27 1777,-7937"/>
<polygon fill="black" stroke="black" points="1780.5,-7936.79 1777,-7926.79 1773.5,-7936.79 1780.5,-7936.79"/>
</g>
<!-- moe_53_expert_0 -->
<g id="node1144" class="node">
<title>moe_53_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-7817.16 16,-7817.16 16,-7765.16 234,-7765.16 234,-7817.16"/>
<text text-anchor="middle" x="125" y="-7805.16" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-7794.16" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-7783.16" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-7772.16" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_53_route&#45;&gt;moe_53_expert_0 -->
<g id="edge1879" class="edge">
<title>moe_53_route&#45;&gt;moe_53_expert_0</title>
<path fill="none" stroke="black" d="M1562.77,-7883.2C1207.39,-7872.98 509.65,-7849.71 244.21,-7817.21"/>
<polygon fill="black" stroke="black" points="244.54,-7813.72 234.18,-7815.95 243.67,-7820.67 244.54,-7813.72"/>
</g>
<!-- moe_53_expert_1 -->
<g id="node1145" class="node">
<title>moe_53_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-7817.16 252,-7817.16 252,-7765.16 470,-7765.16 470,-7817.16"/>
<text text-anchor="middle" x="361" y="-7805.16" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-7794.16" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-7783.16" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-7772.16" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_53_route&#45;&gt;moe_53_expert_1 -->
<g id="edge1880" class="edge">
<title>moe_53_route&#45;&gt;moe_53_expert_1</title>
<path fill="none" stroke="black" d="M1559.59,-7887.09C1303.22,-7882.58 864.4,-7867.59 480.11,-7817.22"/>
<polygon fill="black" stroke="black" points="480.56,-7813.75 470.19,-7815.91 479.64,-7820.69 480.56,-7813.75"/>
</g>
<!-- moe_53_expert_2 -->
<g id="node1146" class="node">
<title>moe_53_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-7817.16 488,-7817.16 488,-7765.16 706,-7765.16 706,-7817.16"/>
<text text-anchor="middle" x="597" y="-7805.16" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-7794.16" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-7783.16" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-7772.16" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_53_route&#45;&gt;moe_53_expert_2 -->
<g id="edge1881" class="edge">
<title>moe_53_route&#45;&gt;moe_53_expert_2</title>
<path fill="none" stroke="black" d="M1562.51,-7883.33C1349.77,-7875.71 1014.57,-7858.15 716.34,-7817.27"/>
<polygon fill="black" stroke="black" points="716.58,-7813.77 706.2,-7815.87 715.62,-7820.7 716.58,-7813.77"/>
</g>
<!-- moe_53_expert_3 -->
<g id="node1147" class="node">
<title>moe_53_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-7817.16 724,-7817.16 724,-7765.16 942,-7765.16 942,-7817.16"/>
<text text-anchor="middle" x="833" y="-7805.16" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-7794.16" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-7783.16" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-7772.16" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_53_route&#45;&gt;moe_53_expert_3 -->
<g id="edge1882" class="edge">
<title>moe_53_route&#45;&gt;moe_53_expert_3</title>
<path fill="none" stroke="black" d="M1570.82,-7878.03C1405.76,-7867.64 1168.32,-7848.99 952.16,-7817.26"/>
<polygon fill="black" stroke="black" points="952.61,-7813.79 942.21,-7815.79 951.59,-7820.72 952.61,-7813.79"/>
</g>
<!-- moe_53_expert_4 -->
<g id="node1148" class="node">
<title>moe_53_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-7817.16 960,-7817.16 960,-7765.16 1178,-7765.16 1178,-7817.16"/>
<text text-anchor="middle" x="1069" y="-7805.16" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-7794.16" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-7783.16" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-7772.16" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_53_route&#45;&gt;moe_53_expert_4 -->
<g id="edge1883" class="edge">
<title>moe_53_route&#45;&gt;moe_53_expert_4</title>
<path fill="none" stroke="black" d="M1591.38,-7870.58C1477.62,-7858.31 1328.9,-7840.45 1188.33,-7817.33"/>
<polygon fill="black" stroke="black" points="1188.66,-7813.84 1178.23,-7815.66 1187.52,-7820.75 1188.66,-7813.84"/>
</g>
<!-- moe_53_expert_5 -->
<g id="node1149" class="node">
<title>moe_53_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-7817.16 1196,-7817.16 1196,-7765.16 1414,-7765.16 1414,-7817.16"/>
<text text-anchor="middle" x="1305" y="-7805.16" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-7794.16" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-7783.16" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-7772.16" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_53_route&#45;&gt;moe_53_expert_5 -->
<g id="edge1884" class="edge">
<title>moe_53_route&#45;&gt;moe_53_expert_5</title>
<path fill="none" stroke="black" d="M1639.51,-7861.35C1576.62,-7848.66 1500.88,-7833.28 1424.14,-7817.39"/>
<polygon fill="black" stroke="black" points="1424.79,-7813.95 1414.28,-7815.35 1423.37,-7820.81 1424.79,-7813.95"/>
</g>
<!-- moe_53_expert_6 -->
<g id="node1150" class="node">
<title>moe_53_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-7817.16 1432,-7817.16 1432,-7765.16 1650,-7765.16 1650,-7817.16"/>
<text text-anchor="middle" x="1541" y="-7805.16" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-7794.16" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-7783.16" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-7772.16" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_53_route&#45;&gt;moe_53_expert_6 -->
<g id="edge1885" class="edge">
<title>moe_53_route&#45;&gt;moe_53_expert_6</title>
<path fill="none" stroke="black" d="M1696.11,-7855.77C1668.54,-7844.46 1637.96,-7831.92 1611.29,-7820.99"/>
<polygon fill="black" stroke="black" points="1612.61,-7817.74 1602.03,-7817.19 1609.95,-7824.22 1612.61,-7817.74"/>
</g>
<!-- moe_53_expert_7 -->
<g id="node1151" class="node">
<title>moe_53_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-7817.16 1668,-7817.16 1668,-7765.16 1886,-7765.16 1886,-7817.16"/>
<text text-anchor="middle" x="1777" y="-7805.16" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-7794.16" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-7783.16" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-7772.16" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_53_route&#45;&gt;moe_53_expert_7 -->
<g id="edge1886" class="edge">
<title>moe_53_route&#45;&gt;moe_53_expert_7</title>
<path fill="none" stroke="black" d="M1777,-7852.9C1777,-7844.59 1777,-7835.76 1777,-7827.47"/>
<polygon fill="black" stroke="black" points="1780.5,-7827.36 1777,-7817.36 1773.5,-7827.36 1780.5,-7827.36"/>
</g>
<!-- moe_53_expert_8 -->
<g id="node1152" class="node">
<title>moe_53_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-7817.16 1904,-7817.16 1904,-7765.16 2122,-7765.16 2122,-7817.16"/>
<text text-anchor="middle" x="2013" y="-7805.16" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-7794.16" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-7783.16" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-7772.16" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_53_route&#45;&gt;moe_53_expert_8 -->
<g id="edge1887" class="edge">
<title>moe_53_route&#45;&gt;moe_53_expert_8</title>
<path fill="none" stroke="black" d="M1857.89,-7855.77C1885.46,-7844.46 1916.04,-7831.92 1942.71,-7820.99"/>
<polygon fill="black" stroke="black" points="1944.05,-7824.22 1951.97,-7817.19 1941.39,-7817.74 1944.05,-7824.22"/>
</g>
<!-- moe_53_expert_9 -->
<g id="node1153" class="node">
<title>moe_53_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-7817.16 2140,-7817.16 2140,-7765.16 2358,-7765.16 2358,-7817.16"/>
<text text-anchor="middle" x="2249" y="-7805.16" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-7794.16" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-7783.16" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-7772.16" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_53_route&#45;&gt;moe_53_expert_9 -->
<g id="edge1888" class="edge">
<title>moe_53_route&#45;&gt;moe_53_expert_9</title>
<path fill="none" stroke="black" d="M1914.49,-7861.35C1977.38,-7848.66 2053.12,-7833.28 2129.86,-7817.39"/>
<polygon fill="black" stroke="black" points="2130.63,-7820.81 2139.72,-7815.35 2129.21,-7813.95 2130.63,-7820.81"/>
</g>
<!-- moe_53_expert_10 -->
<g id="node1154" class="node">
<title>moe_53_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-7817.16 2376,-7817.16 2376,-7765.16 2594,-7765.16 2594,-7817.16"/>
<text text-anchor="middle" x="2485" y="-7805.16" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-7794.16" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-7783.16" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-7772.16" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_53_route&#45;&gt;moe_53_expert_10 -->
<g id="edge1889" class="edge">
<title>moe_53_route&#45;&gt;moe_53_expert_10</title>
<path fill="none" stroke="black" d="M1962.62,-7870.58C2076.38,-7858.31 2225.1,-7840.45 2365.67,-7817.33"/>
<polygon fill="black" stroke="black" points="2366.48,-7820.75 2375.77,-7815.66 2365.34,-7813.84 2366.48,-7820.75"/>
</g>
<!-- moe_53_expert_11 -->
<g id="node1155" class="node">
<title>moe_53_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-7817.16 2612,-7817.16 2612,-7765.16 2830,-7765.16 2830,-7817.16"/>
<text text-anchor="middle" x="2721" y="-7805.16" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-7794.16" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-7783.16" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-7772.16" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_53_route&#45;&gt;moe_53_expert_11 -->
<g id="edge1890" class="edge">
<title>moe_53_route&#45;&gt;moe_53_expert_11</title>
<path fill="none" stroke="black" d="M1983.18,-7878.03C2148.24,-7867.64 2385.68,-7848.99 2601.84,-7817.26"/>
<polygon fill="black" stroke="black" points="2602.41,-7820.72 2611.79,-7815.79 2601.39,-7813.79 2602.41,-7820.72"/>
</g>
<!-- moe_53_expert_12 -->
<g id="node1156" class="node">
<title>moe_53_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-7817.16 2848,-7817.16 2848,-7765.16 3066,-7765.16 3066,-7817.16"/>
<text text-anchor="middle" x="2957" y="-7805.16" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-7794.16" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-7783.16" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-7772.16" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_53_route&#45;&gt;moe_53_expert_12 -->
<g id="edge1891" class="edge">
<title>moe_53_route&#45;&gt;moe_53_expert_12</title>
<path fill="none" stroke="black" d="M1991.49,-7883.33C2204.23,-7875.71 2539.43,-7858.15 2837.66,-7817.27"/>
<polygon fill="black" stroke="black" points="2838.38,-7820.7 2847.8,-7815.87 2837.42,-7813.77 2838.38,-7820.7"/>
</g>
<!-- moe_53_expert_13 -->
<g id="node1157" class="node">
<title>moe_53_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-7817.16 3084,-7817.16 3084,-7765.16 3302,-7765.16 3302,-7817.16"/>
<text text-anchor="middle" x="3193" y="-7805.16" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-7794.16" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-7783.16" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-7772.16" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_53_route&#45;&gt;moe_53_expert_13 -->
<g id="edge1892" class="edge">
<title>moe_53_route&#45;&gt;moe_53_expert_13</title>
<path fill="none" stroke="black" d="M1994.41,-7887.09C2250.78,-7882.58 2689.6,-7867.59 3073.89,-7817.22"/>
<polygon fill="black" stroke="black" points="3074.36,-7820.69 3083.81,-7815.91 3073.44,-7813.75 3074.36,-7820.69"/>
</g>
<!-- moe_53_expert_14 -->
<g id="node1158" class="node">
<title>moe_53_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-7817.16 3320,-7817.16 3320,-7765.16 3538,-7765.16 3538,-7817.16"/>
<text text-anchor="middle" x="3429" y="-7805.16" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-7794.16" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-7783.16" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-7772.16" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_53_route&#45;&gt;moe_53_expert_14 -->
<g id="edge1893" class="edge">
<title>moe_53_route&#45;&gt;moe_53_expert_14</title>
<path fill="none" stroke="black" d="M1991.23,-7883.2C2346.61,-7872.98 3044.35,-7849.71 3309.79,-7817.21"/>
<polygon fill="black" stroke="black" points="3310.33,-7820.67 3319.82,-7815.95 3309.46,-7813.72 3310.33,-7820.67"/>
</g>
<!-- moe_53_expert_15 -->
<g id="node1159" class="node">
<title>moe_53_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-7817.16 3556,-7817.16 3556,-7765.16 3774,-7765.16 3774,-7817.16"/>
<text text-anchor="middle" x="3665" y="-7805.16" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-7794.16" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-7783.16" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-7772.16" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_53_route&#45;&gt;moe_53_expert_15 -->
<g id="edge1894" class="edge">
<title>moe_53_route&#45;&gt;moe_53_expert_15</title>
<path fill="none" stroke="black" d="M1992.71,-7884.73C2392.25,-7876.2 3234.28,-7854.52 3545.86,-7817.19"/>
<polygon fill="black" stroke="black" points="3546.32,-7820.66 3555.82,-7815.97 3545.47,-7813.71 3546.32,-7820.66"/>
</g>
<!-- moe_53_aggregate -->
<g id="node1160" class="node">
<title>moe_53_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-7692.4" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-7706.4" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1895" y="-7695.4" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-7684.4" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1895" y="-7673.4" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_53_expert_0&#45;&gt;moe_53_aggregate -->
<g id="edge1895" class="edge">
<title>moe_53_expert_0&#45;&gt;moe_53_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-7766.37C237.15,-7765.94 240.09,-7765.53 243,-7765.16 510.74,-7731.22 1276.32,-7708.42 1664.04,-7698.71"/>
<polygon fill="black" stroke="black" points="1664.35,-7702.2 1674.26,-7698.45 1664.17,-7695.21 1664.35,-7702.2"/>
</g>
<!-- moe_53_expert_1&#45;&gt;moe_53_aggregate -->
<g id="edge1896" class="edge">
<title>moe_53_expert_1&#45;&gt;moe_53_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-7766.4C473.15,-7765.96 476.09,-7765.54 479,-7765.16 892.79,-7711.19 1379.51,-7697.23 1661.11,-7693.95"/>
<polygon fill="black" stroke="black" points="1661.49,-7697.45 1671.45,-7693.84 1661.41,-7690.45 1661.49,-7697.45"/>
</g>
<!-- moe_53_expert_2&#45;&gt;moe_53_aggregate -->
<g id="edge1897" class="edge">
<title>moe_53_expert_2&#45;&gt;moe_53_aggregate</title>
<path fill="none" stroke="black" d="M706.19,-7766.44C709.15,-7765.98 712.09,-7765.56 715,-7765.16 1042.31,-7720.79 1424.45,-7703.84 1663.11,-7697.38"/>
<polygon fill="black" stroke="black" points="1663.4,-7700.87 1673.31,-7697.1 1663.22,-7693.87 1663.4,-7700.87"/>
</g>
<!-- moe_53_expert_3&#45;&gt;moe_53_aggregate -->
<g id="edge1898" class="edge">
<title>moe_53_expert_3&#45;&gt;moe_53_aggregate</title>
<path fill="none" stroke="black" d="M942.2,-7766.5C945.16,-7766.03 948.1,-7765.58 951,-7765.16 1194.76,-7730.24 1476.52,-7711.61 1668.32,-7702.17"/>
<polygon fill="black" stroke="black" points="1668.71,-7705.65 1678.53,-7701.67 1668.37,-7698.66 1668.71,-7705.65"/>
</g>
<!-- moe_53_expert_4&#45;&gt;moe_53_aggregate -->
<g id="edge1899" class="edge">
<title>moe_53_expert_4&#45;&gt;moe_53_aggregate</title>
<path fill="none" stroke="black" d="M1178.21,-7766.59C1181.17,-7766.09 1184.1,-7765.62 1187,-7765.16 1352.7,-7739.29 1541.73,-7720.68 1682.77,-7708.9"/>
<polygon fill="black" stroke="black" points="1683.17,-7712.38 1692.84,-7708.06 1682.59,-7705.4 1683.17,-7712.38"/>
</g>
<!-- moe_53_expert_5&#45;&gt;moe_53_aggregate -->
<g id="edge1900" class="edge">
<title>moe_53_expert_5&#45;&gt;moe_53_aggregate</title>
<path fill="none" stroke="black" d="M1414.25,-7766.79C1417.19,-7766.23 1420.12,-7765.69 1423,-7765.16 1519.58,-7747.61 1627.83,-7730.93 1716.27,-7718.08"/>
<polygon fill="black" stroke="black" points="1717.01,-7721.51 1726.4,-7716.62 1716,-7714.59 1717.01,-7721.51"/>
</g>
<!-- moe_53_expert_6&#45;&gt;moe_53_aggregate -->
<g id="edge1901" class="edge">
<title>moe_53_expert_6&#45;&gt;moe_53_aggregate</title>
<path fill="none" stroke="black" d="M1632.62,-7765.12C1675.27,-7753.46 1726.62,-7739.42 1772.54,-7726.87"/>
<polygon fill="black" stroke="black" points="1773.53,-7730.23 1782.25,-7724.22 1771.68,-7723.48 1773.53,-7730.23"/>
</g>
<!-- moe_53_expert_7&#45;&gt;moe_53_aggregate -->
<g id="edge1902" class="edge">
<title>moe_53_expert_7&#45;&gt;moe_53_aggregate</title>
<path fill="none" stroke="black" d="M1807.7,-7764.99C1818.79,-7755.9 1831.63,-7745.37 1843.99,-7735.23"/>
<polygon fill="black" stroke="black" points="1846.51,-7737.69 1852.02,-7728.64 1842.07,-7732.28 1846.51,-7737.69"/>
</g>
<!-- moe_53_expert_8&#45;&gt;moe_53_aggregate -->
<g id="edge1903" class="edge">
<title>moe_53_expert_8&#45;&gt;moe_53_aggregate</title>
<path fill="none" stroke="black" d="M1982.3,-7764.99C1971.21,-7755.9 1958.37,-7745.37 1946.01,-7735.23"/>
<polygon fill="black" stroke="black" points="1947.93,-7732.28 1937.98,-7728.64 1943.49,-7737.69 1947.93,-7732.28"/>
</g>
<!-- moe_53_expert_9&#45;&gt;moe_53_aggregate -->
<g id="edge1904" class="edge">
<title>moe_53_expert_9&#45;&gt;moe_53_aggregate</title>
<path fill="none" stroke="black" d="M2157.38,-7765.12C2114.73,-7753.46 2063.38,-7739.42 2017.46,-7726.87"/>
<polygon fill="black" stroke="black" points="2018.32,-7723.48 2007.75,-7724.22 2016.47,-7730.23 2018.32,-7723.48"/>
</g>
<!-- moe_53_expert_10&#45;&gt;moe_53_aggregate -->
<g id="edge1905" class="edge">
<title>moe_53_expert_10&#45;&gt;moe_53_aggregate</title>
<path fill="none" stroke="black" d="M2375.75,-7766.79C2372.81,-7766.23 2369.88,-7765.69 2367,-7765.16 2270.42,-7747.61 2162.17,-7730.93 2073.73,-7718.08"/>
<polygon fill="black" stroke="black" points="2074,-7714.59 2063.6,-7716.62 2072.99,-7721.51 2074,-7714.59"/>
</g>
<!-- moe_53_expert_11&#45;&gt;moe_53_aggregate -->
<g id="edge1906" class="edge">
<title>moe_53_expert_11&#45;&gt;moe_53_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-7766.59C2608.83,-7766.09 2605.9,-7765.62 2603,-7765.16 2437.3,-7739.29 2248.27,-7720.68 2107.23,-7708.9"/>
<polygon fill="black" stroke="black" points="2107.41,-7705.4 2097.16,-7708.06 2106.83,-7712.38 2107.41,-7705.4"/>
</g>
<!-- moe_53_expert_12&#45;&gt;moe_53_aggregate -->
<g id="edge1907" class="edge">
<title>moe_53_expert_12&#45;&gt;moe_53_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-7766.5C2844.84,-7766.03 2841.9,-7765.58 2839,-7765.16 2595.24,-7730.24 2313.48,-7711.61 2121.68,-7702.17"/>
<polygon fill="black" stroke="black" points="2121.63,-7698.66 2111.47,-7701.67 2121.29,-7705.65 2121.63,-7698.66"/>
</g>
<!-- moe_53_expert_13&#45;&gt;moe_53_aggregate -->
<g id="edge1908" class="edge">
<title>moe_53_expert_13&#45;&gt;moe_53_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-7766.44C3080.85,-7765.98 3077.91,-7765.56 3075,-7765.16 2747.69,-7720.79 2365.55,-7703.84 2126.89,-7697.38"/>
<polygon fill="black" stroke="black" points="2126.78,-7693.87 2116.69,-7697.1 2126.6,-7700.87 2126.78,-7693.87"/>
</g>
<!-- moe_53_expert_14&#45;&gt;moe_53_aggregate -->
<g id="edge1909" class="edge">
<title>moe_53_expert_14&#45;&gt;moe_53_aggregate</title>
<path fill="none" stroke="black" d="M3319.81,-7766.4C3316.85,-7765.96 3313.91,-7765.54 3311,-7765.16 2897.21,-7711.19 2410.49,-7697.23 2128.89,-7693.95"/>
<polygon fill="black" stroke="black" points="2128.59,-7690.45 2118.55,-7693.84 2128.51,-7697.45 2128.59,-7690.45"/>
</g>
<!-- moe_53_expert_15&#45;&gt;moe_53_aggregate -->
<g id="edge1910" class="edge">
<title>moe_53_expert_15&#45;&gt;moe_53_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-7766.37C3552.85,-7765.94 3549.91,-7765.53 3547,-7765.16 3279.26,-7731.22 2513.68,-7708.42 2125.96,-7698.71"/>
<polygon fill="black" stroke="black" points="2125.83,-7695.21 2115.74,-7698.45 2125.65,-7702.2 2125.83,-7695.21"/>
</g>
<!-- moe_53_ffn -->
<g id="node1161" class="node">
<title>moe_53_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2053,-7619.63 1737,-7619.63 1737,-7567.63 2053,-7567.63 2053,-7619.63"/>
<text text-anchor="middle" x="1895" y="-7607.63" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1895" y="-7596.63" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-7585.63" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-7574.63" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_53_aggregate&#45;&gt;moe_53_ffn -->
<g id="edge1911" class="edge">
<title>moe_53_aggregate&#45;&gt;moe_53_ffn</title>
<path fill="none" stroke="black" d="M1895,-7655.36C1895,-7647.05 1895,-7638.22 1895,-7629.93"/>
<polygon fill="black" stroke="black" points="1898.5,-7629.82 1895,-7619.82 1891.5,-7629.82 1898.5,-7629.82"/>
</g>
<!-- moe_53_res2 -->
<g id="node1163" class="node">
<title>moe_53_res2</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-7531.63 1695.97,-7531.63 1558.11,-7427.63 2094.03,-7427.63 2231.89,-7531.63"/>
<text text-anchor="middle" x="1895" y="-7493.63" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1895" y="-7482.63" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-7471.63" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-7460.63" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_53_ffn&#45;&gt;moe_53_res2 -->
<g id="edge1912" class="edge">
<title>moe_53_ffn&#45;&gt;moe_53_res2</title>
<path fill="none" stroke="black" d="M1895,-7567.49C1895,-7559.81 1895,-7550.99 1895,-7541.99"/>
<polygon fill="black" stroke="black" points="1898.5,-7541.8 1895,-7531.8 1891.5,-7541.8 1898.5,-7541.8"/>
</g>
<!-- moe_53_res1&#45;&gt;moe_53_gate -->
<g id="edge1877" class="edge">
<title>moe_53_res1&#45;&gt;moe_53_gate</title>
<path fill="none" stroke="black" d="M1777,-8102.32C1777,-8094.15 1777,-8085.62 1777,-8077.24"/>
<polygon fill="black" stroke="black" points="1780.5,-8077.13 1777,-8067.13 1773.5,-8077.13 1780.5,-8077.13"/>
</g>
<!-- moe_54_mha -->
<g id="node1164" class="node">
<title>moe_54_mha</title>
<polygon fill="lightgreen" stroke="black" points="2053,-7380.63 1737,-7380.63 1737,-7328.63 2053,-7328.63 2053,-7380.63"/>
<text text-anchor="middle" x="1895" y="-7368.63" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1895" y="-7357.63" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-7346.63" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-7335.63" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_53_res2&#45;&gt;moe_54_mha -->
<g id="edge1913" class="edge">
<title>moe_53_res2&#45;&gt;moe_54_mha</title>
<path fill="none" stroke="black" d="M1895,-7427.53C1895,-7415.2 1895,-7402.3 1895,-7390.88"/>
<polygon fill="black" stroke="black" points="1898.5,-7390.87 1895,-7380.87 1891.5,-7390.87 1898.5,-7390.87"/>
</g>
<!-- moe_54_res1 -->
<g id="node1185" class="node">
<title>moe_54_res1</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-7292.63 1695.97,-7292.63 1558.11,-7188.63 2094.03,-7188.63 2231.89,-7292.63"/>
<text text-anchor="middle" x="1895" y="-7254.63" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1895" y="-7243.63" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-7232.63" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-7221.63" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_54_mha&#45;&gt;moe_54_res1 -->
<g id="edge1914" class="edge">
<title>moe_54_mha&#45;&gt;moe_54_res1</title>
<path fill="none" stroke="black" d="M1895,-7328.49C1895,-7320.81 1895,-7311.99 1895,-7302.99"/>
<polygon fill="black" stroke="black" points="1898.5,-7302.8 1895,-7292.8 1891.5,-7302.8 1898.5,-7302.8"/>
</g>
<!-- moe_54_gate -->
<g id="node1165" class="node">
<title>moe_54_gate</title>
<polygon fill="lightyellow" stroke="black" points="2223.8,-7152.63 1700.75,-7152.63 1566.2,-7048.63 2089.25,-7048.63 2223.8,-7152.63"/>
<text text-anchor="middle" x="1895" y="-7114.63" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1895" y="-7103.63" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-7092.63" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-7081.63" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_54_route -->
<g id="node1166" class="node">
<title>moe_54_route</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-6975.86" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-6989.86" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1895" y="-6978.86" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-6967.86" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-6956.86" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_54_gate&#45;&gt;moe_54_route -->
<g id="edge1916" class="edge">
<title>moe_54_gate&#45;&gt;moe_54_route</title>
<path fill="none" stroke="black" d="M1895,-7048.27C1895,-7039.86 1895,-7031.2 1895,-7022.93"/>
<polygon fill="black" stroke="black" points="1898.5,-7022.71 1895,-7012.71 1891.5,-7022.71 1898.5,-7022.71"/>
</g>
<!-- moe_54_expert_0 -->
<g id="node1167" class="node">
<title>moe_54_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-6903.09 16,-6903.09 16,-6851.09 234,-6851.09 234,-6903.09"/>
<text text-anchor="middle" x="125" y="-6891.09" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-6880.09" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-6869.09" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-6858.09" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_54_route&#45;&gt;moe_54_expert_0 -->
<g id="edge1917" class="edge">
<title>moe_54_route&#45;&gt;moe_54_expert_0</title>
<path fill="none" stroke="black" d="M1679.93,-6969.94C1302.11,-6960.57 532.75,-6938.03 244.24,-6903.13"/>
<polygon fill="black" stroke="black" points="244.54,-6899.64 234.18,-6901.88 243.68,-6906.59 244.54,-6899.64"/>
</g>
<!-- moe_54_expert_1 -->
<g id="node1168" class="node">
<title>moe_54_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-6903.09 252,-6903.09 252,-6851.09 470,-6851.09 470,-6903.09"/>
<text text-anchor="middle" x="361" y="-6891.09" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-6880.09" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-6869.09" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-6858.09" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_54_route&#45;&gt;moe_54_expert_1 -->
<g id="edge1918" class="edge">
<title>moe_54_route&#45;&gt;moe_54_expert_1</title>
<path fill="none" stroke="black" d="M1677.23,-6974.48C1400.57,-6971.57 908.56,-6958.32 480.29,-6903.16"/>
<polygon fill="black" stroke="black" points="480.55,-6899.67 470.19,-6901.85 479.65,-6906.61 480.55,-6899.67"/>
</g>
<!-- moe_54_expert_2 -->
<g id="node1169" class="node">
<title>moe_54_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-6903.09 488,-6903.09 488,-6851.09 706,-6851.09 706,-6903.09"/>
<text text-anchor="middle" x="597" y="-6891.09" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-6880.09" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-6869.09" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-6858.09" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_54_route&#45;&gt;moe_54_expert_2 -->
<g id="edge1919" class="edge">
<title>moe_54_route&#45;&gt;moe_54_expert_2</title>
<path fill="none" stroke="black" d="M1678.74,-6971.29C1443.7,-6965.21 1057.2,-6948.77 716.26,-6903.17"/>
<polygon fill="black" stroke="black" points="716.57,-6899.68 706.19,-6901.81 715.63,-6906.62 716.57,-6899.68"/>
</g>
<!-- moe_54_expert_3 -->
<g id="node1170" class="node">
<title>moe_54_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-6903.09 724,-6903.09 724,-6851.09 942,-6851.09 942,-6903.09"/>
<text text-anchor="middle" x="833" y="-6891.09" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-6880.09" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-6869.09" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-6858.09" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_54_route&#45;&gt;moe_54_expert_3 -->
<g id="edge1920" class="edge">
<title>moe_54_route&#45;&gt;moe_54_expert_3</title>
<path fill="none" stroke="black" d="M1683.7,-6966.83C1494.33,-6957.76 1209,-6939.45 952.47,-6903.22"/>
<polygon fill="black" stroke="black" points="952.59,-6899.7 942.2,-6901.76 951.61,-6906.63 952.59,-6899.7"/>
</g>
<!-- moe_54_expert_4 -->
<g id="node1171" class="node">
<title>moe_54_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-6903.09 960,-6903.09 960,-6851.09 1178,-6851.09 1178,-6903.09"/>
<text text-anchor="middle" x="1069" y="-6891.09" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-6880.09" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-6869.09" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-6858.09" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_54_route&#45;&gt;moe_54_expert_4 -->
<g id="edge1921" class="edge">
<title>moe_54_route&#45;&gt;moe_54_expert_4</title>
<path fill="none" stroke="black" d="M1696.66,-6960.5C1556.96,-6949.02 1365.46,-6930.52 1188.25,-6903.22"/>
<polygon fill="black" stroke="black" points="1188.63,-6899.73 1178.21,-6901.66 1187.56,-6906.65 1188.63,-6899.73"/>
</g>
<!-- moe_54_expert_5 -->
<g id="node1172" class="node">
<title>moe_54_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-6903.09 1196,-6903.09 1196,-6851.09 1414,-6851.09 1414,-6903.09"/>
<text text-anchor="middle" x="1305" y="-6891.09" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-6880.09" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-6869.09" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-6858.09" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_54_route&#45;&gt;moe_54_expert_5 -->
<g id="edge1922" class="edge">
<title>moe_54_route&#45;&gt;moe_54_expert_5</title>
<path fill="none" stroke="black" d="M1728.87,-6951.99C1640.99,-6939.31 1531.11,-6922.54 1424.25,-6903.28"/>
<polygon fill="black" stroke="black" points="1424.71,-6899.8 1414.25,-6901.46 1423.46,-6906.69 1424.71,-6899.8"/>
</g>
<!-- moe_54_expert_6 -->
<g id="node1173" class="node">
<title>moe_54_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-6903.09 1432,-6903.09 1432,-6851.09 1650,-6851.09 1650,-6903.09"/>
<text text-anchor="middle" x="1541" y="-6891.09" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-6880.09" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-6869.09" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-6858.09" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_54_route&#45;&gt;moe_54_expert_6 -->
<g id="edge1923" class="edge">
<title>moe_54_route&#45;&gt;moe_54_expert_6</title>
<path fill="none" stroke="black" d="M1782.99,-6944.24C1737.98,-6931.93 1686.47,-6917.85 1642.56,-6905.85"/>
<polygon fill="black" stroke="black" points="1643.31,-6902.43 1632.74,-6903.16 1641.46,-6909.18 1643.31,-6902.43"/>
</g>
<!-- moe_54_expert_7 -->
<g id="node1174" class="node">
<title>moe_54_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-6903.09 1668,-6903.09 1668,-6851.09 1886,-6851.09 1886,-6903.09"/>
<text text-anchor="middle" x="1777" y="-6891.09" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-6880.09" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-6869.09" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-6858.09" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_54_route&#45;&gt;moe_54_expert_7 -->
<g id="edge1924" class="edge">
<title>moe_54_route&#45;&gt;moe_54_expert_7</title>
<path fill="none" stroke="black" d="M1852.07,-6939.65C1840.07,-6929.81 1827.12,-6919.19 1815.41,-6909.58"/>
<polygon fill="black" stroke="black" points="1817.47,-6906.75 1807.52,-6903.12 1813.04,-6912.16 1817.47,-6906.75"/>
</g>
<!-- moe_54_expert_8 -->
<g id="node1175" class="node">
<title>moe_54_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-6903.09 1904,-6903.09 1904,-6851.09 2122,-6851.09 2122,-6903.09"/>
<text text-anchor="middle" x="2013" y="-6891.09" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-6880.09" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-6869.09" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-6858.09" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_54_route&#45;&gt;moe_54_expert_8 -->
<g id="edge1925" class="edge">
<title>moe_54_route&#45;&gt;moe_54_expert_8</title>
<path fill="none" stroke="black" d="M1937.93,-6939.65C1949.93,-6929.81 1962.88,-6919.19 1974.59,-6909.58"/>
<polygon fill="black" stroke="black" points="1976.96,-6912.16 1982.48,-6903.12 1972.53,-6906.75 1976.96,-6912.16"/>
</g>
<!-- moe_54_expert_9 -->
<g id="node1176" class="node">
<title>moe_54_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-6903.09 2140,-6903.09 2140,-6851.09 2358,-6851.09 2358,-6903.09"/>
<text text-anchor="middle" x="2249" y="-6891.09" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-6880.09" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-6869.09" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-6858.09" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_54_route&#45;&gt;moe_54_expert_9 -->
<g id="edge1926" class="edge">
<title>moe_54_route&#45;&gt;moe_54_expert_9</title>
<path fill="none" stroke="black" d="M2007.01,-6944.24C2052.02,-6931.93 2103.53,-6917.85 2147.44,-6905.85"/>
<polygon fill="black" stroke="black" points="2148.54,-6909.18 2157.26,-6903.16 2146.69,-6902.43 2148.54,-6909.18"/>
</g>
<!-- moe_54_expert_10 -->
<g id="node1177" class="node">
<title>moe_54_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-6903.09 2376,-6903.09 2376,-6851.09 2594,-6851.09 2594,-6903.09"/>
<text text-anchor="middle" x="2485" y="-6891.09" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-6880.09" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-6869.09" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-6858.09" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_54_route&#45;&gt;moe_54_expert_10 -->
<g id="edge1927" class="edge">
<title>moe_54_route&#45;&gt;moe_54_expert_10</title>
<path fill="none" stroke="black" d="M2061.13,-6951.99C2149.01,-6939.31 2258.89,-6922.54 2365.75,-6903.28"/>
<polygon fill="black" stroke="black" points="2366.54,-6906.69 2375.75,-6901.46 2365.29,-6899.8 2366.54,-6906.69"/>
</g>
<!-- moe_54_expert_11 -->
<g id="node1178" class="node">
<title>moe_54_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-6903.09 2612,-6903.09 2612,-6851.09 2830,-6851.09 2830,-6903.09"/>
<text text-anchor="middle" x="2721" y="-6891.09" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-6880.09" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-6869.09" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-6858.09" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_54_route&#45;&gt;moe_54_expert_11 -->
<g id="edge1928" class="edge">
<title>moe_54_route&#45;&gt;moe_54_expert_11</title>
<path fill="none" stroke="black" d="M2093.34,-6960.5C2233.04,-6949.02 2424.54,-6930.52 2601.75,-6903.22"/>
<polygon fill="black" stroke="black" points="2602.44,-6906.65 2611.79,-6901.66 2601.37,-6899.73 2602.44,-6906.65"/>
</g>
<!-- moe_54_expert_12 -->
<g id="node1179" class="node">
<title>moe_54_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-6903.09 2848,-6903.09 2848,-6851.09 3066,-6851.09 3066,-6903.09"/>
<text text-anchor="middle" x="2957" y="-6891.09" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-6880.09" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-6869.09" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-6858.09" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_54_route&#45;&gt;moe_54_expert_12 -->
<g id="edge1929" class="edge">
<title>moe_54_route&#45;&gt;moe_54_expert_12</title>
<path fill="none" stroke="black" d="M2106.3,-6966.83C2295.67,-6957.76 2581,-6939.45 2837.53,-6903.22"/>
<polygon fill="black" stroke="black" points="2838.39,-6906.63 2847.8,-6901.76 2837.41,-6899.7 2838.39,-6906.63"/>
</g>
<!-- moe_54_expert_13 -->
<g id="node1180" class="node">
<title>moe_54_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-6903.09 3084,-6903.09 3084,-6851.09 3302,-6851.09 3302,-6903.09"/>
<text text-anchor="middle" x="3193" y="-6891.09" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-6880.09" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-6869.09" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-6858.09" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_54_route&#45;&gt;moe_54_expert_13 -->
<g id="edge1930" class="edge">
<title>moe_54_route&#45;&gt;moe_54_expert_13</title>
<path fill="none" stroke="black" d="M2111.26,-6971.29C2346.3,-6965.21 2732.8,-6948.77 3073.74,-6903.17"/>
<polygon fill="black" stroke="black" points="3074.37,-6906.62 3083.81,-6901.81 3073.43,-6899.68 3074.37,-6906.62"/>
</g>
<!-- moe_54_expert_14 -->
<g id="node1181" class="node">
<title>moe_54_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-6903.09 3320,-6903.09 3320,-6851.09 3538,-6851.09 3538,-6903.09"/>
<text text-anchor="middle" x="3429" y="-6891.09" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-6880.09" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-6869.09" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-6858.09" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_54_route&#45;&gt;moe_54_expert_14 -->
<g id="edge1931" class="edge">
<title>moe_54_route&#45;&gt;moe_54_expert_14</title>
<path fill="none" stroke="black" d="M2112.77,-6974.48C2389.43,-6971.57 2881.44,-6958.32 3309.71,-6903.16"/>
<polygon fill="black" stroke="black" points="3310.35,-6906.61 3319.81,-6901.85 3309.45,-6899.67 3310.35,-6906.61"/>
</g>
<!-- moe_54_expert_15 -->
<g id="node1182" class="node">
<title>moe_54_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-6903.09 3556,-6903.09 3556,-6851.09 3774,-6851.09 3774,-6903.09"/>
<text text-anchor="middle" x="3665" y="-6891.09" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-6880.09" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-6869.09" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-6858.09" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_54_route&#45;&gt;moe_54_expert_15 -->
<g id="edge1932" class="edge">
<title>moe_54_route&#45;&gt;moe_54_expert_15</title>
<path fill="none" stroke="black" d="M2110.07,-6969.94C2487.89,-6960.57 3257.25,-6938.03 3545.76,-6903.13"/>
<polygon fill="black" stroke="black" points="3546.32,-6906.59 3555.82,-6901.88 3545.46,-6899.64 3546.32,-6906.59"/>
</g>
<!-- moe_54_aggregate -->
<g id="node1183" class="node">
<title>moe_54_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1777" cy="-6778.32" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1777" y="-6792.32" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1777" y="-6781.32" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1777" y="-6770.32" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1777" y="-6759.32" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_54_expert_0&#45;&gt;moe_54_aggregate -->
<g id="edge1933" class="edge">
<title>moe_54_expert_0&#45;&gt;moe_54_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-6852.3C237.15,-6851.87 240.09,-6851.46 243,-6851.09 488.12,-6819.6 1182.7,-6796.08 1547.21,-6785.5"/>
<polygon fill="black" stroke="black" points="1547.47,-6788.99 1557.36,-6785.2 1547.27,-6782 1547.47,-6788.99"/>
</g>
<!-- moe_54_expert_1&#45;&gt;moe_54_aggregate -->
<g id="edge1934" class="edge">
<title>moe_54_expert_1&#45;&gt;moe_54_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-6852.34C473.15,-6851.89 476.09,-6851.47 479,-6851.09 849.22,-6801.93 1283.16,-6786.33 1543.76,-6781.45"/>
<polygon fill="black" stroke="black" points="1544.17,-6784.95 1554.11,-6781.26 1544.05,-6777.95 1544.17,-6784.95"/>
</g>
<!-- moe_54_expert_2&#45;&gt;moe_54_aggregate -->
<g id="edge1935" class="edge">
<title>moe_54_expert_2&#45;&gt;moe_54_aggregate</title>
<path fill="none" stroke="black" d="M706.2,-6852.38C709.16,-6851.92 712.1,-6851.49 715,-6851.09 1000.02,-6811.47 1331.23,-6793.49 1546.98,-6785.49"/>
<polygon fill="black" stroke="black" points="1547.3,-6788.98 1557.17,-6785.12 1547.05,-6781.98 1547.3,-6788.98"/>
</g>
<!-- moe_54_expert_3&#45;&gt;moe_54_aggregate -->
<g id="edge1936" class="edge">
<title>moe_54_expert_3&#45;&gt;moe_54_aggregate</title>
<path fill="none" stroke="black" d="M942.21,-6852.46C945.16,-6851.98 948.1,-6851.52 951,-6851.09 1154.78,-6820.76 1388.89,-6801.91 1555.72,-6791.18"/>
<polygon fill="black" stroke="black" points="1556.35,-6794.65 1566.11,-6790.52 1555.91,-6787.67 1556.35,-6794.65"/>
</g>
<!-- moe_54_expert_4&#45;&gt;moe_54_aggregate -->
<g id="edge1937" class="edge">
<title>moe_54_expert_4&#45;&gt;moe_54_aggregate</title>
<path fill="none" stroke="black" d="M1178.23,-6852.59C1181.18,-6852.07 1184.11,-6851.57 1187,-6851.09 1316.69,-6829.5 1463.43,-6811.63 1578.13,-6799.11"/>
<polygon fill="black" stroke="black" points="1578.51,-6802.59 1588.07,-6798.03 1577.75,-6795.63 1578.51,-6802.59"/>
</g>
<!-- moe_54_expert_5&#45;&gt;moe_54_aggregate -->
<g id="edge1938" class="edge">
<title>moe_54_expert_5&#45;&gt;moe_54_aggregate</title>
<path fill="none" stroke="black" d="M1414.28,-6852.9C1417.22,-6852.29 1420.13,-6851.68 1423,-6851.09 1490.32,-6837.13 1564.9,-6821.97 1628.19,-6809.19"/>
<polygon fill="black" stroke="black" points="1629.13,-6812.57 1638.24,-6807.16 1627.75,-6805.7 1629.13,-6812.57"/>
</g>
<!-- moe_54_expert_6&#45;&gt;moe_54_aggregate -->
<g id="edge1939" class="edge">
<title>moe_54_expert_6&#45;&gt;moe_54_aggregate</title>
<path fill="none" stroke="black" d="M1602.08,-6851.04C1627.73,-6840.52 1658.09,-6828.08 1686.26,-6816.52"/>
<polygon fill="black" stroke="black" points="1687.79,-6819.68 1695.72,-6812.65 1685.14,-6813.2 1687.79,-6819.68"/>
</g>
<!-- moe_54_expert_7&#45;&gt;moe_54_aggregate -->
<g id="edge1940" class="edge">
<title>moe_54_expert_7&#45;&gt;moe_54_aggregate</title>
<path fill="none" stroke="black" d="M1777,-6850.91C1777,-6843.11 1777,-6834.24 1777,-6825.47"/>
<polygon fill="black" stroke="black" points="1780.5,-6825.29 1777,-6815.29 1773.5,-6825.29 1780.5,-6825.29"/>
</g>
<!-- moe_54_expert_8&#45;&gt;moe_54_aggregate -->
<g id="edge1941" class="edge">
<title>moe_54_expert_8&#45;&gt;moe_54_aggregate</title>
<path fill="none" stroke="black" d="M1951.92,-6851.04C1926.27,-6840.52 1895.91,-6828.08 1867.74,-6816.52"/>
<polygon fill="black" stroke="black" points="1868.86,-6813.2 1858.28,-6812.65 1866.21,-6819.68 1868.86,-6813.2"/>
</g>
<!-- moe_54_expert_9&#45;&gt;moe_54_aggregate -->
<g id="edge1942" class="edge">
<title>moe_54_expert_9&#45;&gt;moe_54_aggregate</title>
<path fill="none" stroke="black" d="M2139.72,-6852.9C2136.78,-6852.29 2133.87,-6851.68 2131,-6851.09 2063.68,-6837.13 1989.1,-6821.97 1925.81,-6809.19"/>
<polygon fill="black" stroke="black" points="1926.25,-6805.7 1915.76,-6807.16 1924.87,-6812.57 1926.25,-6805.7"/>
</g>
<!-- moe_54_expert_10&#45;&gt;moe_54_aggregate -->
<g id="edge1943" class="edge">
<title>moe_54_expert_10&#45;&gt;moe_54_aggregate</title>
<path fill="none" stroke="black" d="M2375.77,-6852.59C2372.82,-6852.07 2369.89,-6851.57 2367,-6851.09 2237.31,-6829.5 2090.57,-6811.63 1975.87,-6799.11"/>
<polygon fill="black" stroke="black" points="1976.25,-6795.63 1965.93,-6798.03 1975.49,-6802.59 1976.25,-6795.63"/>
</g>
<!-- moe_54_expert_11&#45;&gt;moe_54_aggregate -->
<g id="edge1944" class="edge">
<title>moe_54_expert_11&#45;&gt;moe_54_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-6852.46C2608.84,-6851.98 2605.9,-6851.52 2603,-6851.09 2399.22,-6820.76 2165.11,-6801.91 1998.28,-6791.18"/>
<polygon fill="black" stroke="black" points="1998.09,-6787.67 1987.89,-6790.52 1997.65,-6794.65 1998.09,-6787.67"/>
</g>
<!-- moe_54_expert_12&#45;&gt;moe_54_aggregate -->
<g id="edge1945" class="edge">
<title>moe_54_expert_12&#45;&gt;moe_54_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-6852.38C2844.84,-6851.92 2841.9,-6851.49 2839,-6851.09 2553.98,-6811.47 2222.77,-6793.49 2007.02,-6785.49"/>
<polygon fill="black" stroke="black" points="2006.95,-6781.98 1996.83,-6785.12 2006.7,-6788.98 2006.95,-6781.98"/>
</g>
<!-- moe_54_expert_13&#45;&gt;moe_54_aggregate -->
<g id="edge1946" class="edge">
<title>moe_54_expert_13&#45;&gt;moe_54_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-6852.34C3080.85,-6851.89 3077.91,-6851.47 3075,-6851.09 2704.78,-6801.93 2270.84,-6786.33 2010.24,-6781.45"/>
<polygon fill="black" stroke="black" points="2009.95,-6777.95 1999.89,-6781.26 2009.83,-6784.95 2009.95,-6777.95"/>
</g>
<!-- moe_54_expert_14&#45;&gt;moe_54_aggregate -->
<g id="edge1947" class="edge">
<title>moe_54_expert_14&#45;&gt;moe_54_aggregate</title>
<path fill="none" stroke="black" d="M3319.82,-6852.3C3316.85,-6851.87 3313.91,-6851.46 3311,-6851.09 3065.88,-6819.6 2371.3,-6796.08 2006.79,-6785.5"/>
<polygon fill="black" stroke="black" points="2006.73,-6782 1996.64,-6785.2 2006.53,-6788.99 2006.73,-6782"/>
</g>
<!-- moe_54_expert_15&#45;&gt;moe_54_aggregate -->
<g id="edge1948" class="edge">
<title>moe_54_expert_15&#45;&gt;moe_54_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-6852.28C3552.85,-6851.85 3549.91,-6851.45 3547,-6851.09 3256.39,-6814.67 2418.41,-6792.71 2008.44,-6783.86"/>
<polygon fill="black" stroke="black" points="2008.31,-6780.36 1998.24,-6783.64 2008.16,-6787.35 2008.31,-6780.36"/>
</g>
<!-- moe_54_ffn -->
<g id="node1184" class="node">
<title>moe_54_ffn</title>
<polygon fill="lightgreen" stroke="black" points="1935,-6705.55 1619,-6705.55 1619,-6653.55 1935,-6653.55 1935,-6705.55"/>
<text text-anchor="middle" x="1777" y="-6693.55" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1777" y="-6682.55" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-6671.55" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-6660.55" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_54_aggregate&#45;&gt;moe_54_ffn -->
<g id="edge1949" class="edge">
<title>moe_54_aggregate&#45;&gt;moe_54_ffn</title>
<path fill="none" stroke="black" d="M1777,-6741.28C1777,-6732.97 1777,-6724.14 1777,-6715.86"/>
<polygon fill="black" stroke="black" points="1780.5,-6715.74 1777,-6705.74 1773.5,-6715.74 1780.5,-6715.74"/>
</g>
<!-- moe_54_res2 -->
<g id="node1186" class="node">
<title>moe_54_res2</title>
<polygon fill="lightyellow" stroke="black" points="2113.89,-6617.55 1577.97,-6617.55 1440.11,-6513.55 1976.03,-6513.55 2113.89,-6617.55"/>
<text text-anchor="middle" x="1777" y="-6579.55" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1777" y="-6568.55" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-6557.55" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1777" y="-6546.55" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_54_ffn&#45;&gt;moe_54_res2 -->
<g id="edge1950" class="edge">
<title>moe_54_ffn&#45;&gt;moe_54_res2</title>
<path fill="none" stroke="black" d="M1777,-6653.41C1777,-6645.73 1777,-6636.91 1777,-6627.92"/>
<polygon fill="black" stroke="black" points="1780.5,-6627.73 1777,-6617.73 1773.5,-6627.73 1780.5,-6627.73"/>
</g>
<!-- moe_54_res1&#45;&gt;moe_54_gate -->
<g id="edge1915" class="edge">
<title>moe_54_res1&#45;&gt;moe_54_gate</title>
<path fill="none" stroke="black" d="M1895,-7188.24C1895,-7180.07 1895,-7171.54 1895,-7163.17"/>
<polygon fill="black" stroke="black" points="1898.5,-7163.05 1895,-7153.05 1891.5,-7163.05 1898.5,-7163.05"/>
</g>
<!-- moe_55_mha -->
<g id="node1187" class="node">
<title>moe_55_mha</title>
<polygon fill="lightgreen" stroke="black" points="1935,-6466.55 1619,-6466.55 1619,-6414.55 1935,-6414.55 1935,-6466.55"/>
<text text-anchor="middle" x="1777" y="-6454.55" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1777" y="-6443.55" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-6432.55" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-6421.55" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_54_res2&#45;&gt;moe_55_mha -->
<g id="edge1951" class="edge">
<title>moe_54_res2&#45;&gt;moe_55_mha</title>
<path fill="none" stroke="black" d="M1777,-6513.45C1777,-6501.12 1777,-6488.22 1777,-6476.8"/>
<polygon fill="black" stroke="black" points="1780.5,-6476.79 1777,-6466.79 1773.5,-6476.79 1780.5,-6476.79"/>
</g>
<!-- moe_55_res1 -->
<g id="node1208" class="node">
<title>moe_55_res1</title>
<polygon fill="lightyellow" stroke="black" points="2113.89,-6378.55 1577.97,-6378.55 1440.11,-6274.55 1976.03,-6274.55 2113.89,-6378.55"/>
<text text-anchor="middle" x="1777" y="-6340.55" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1777" y="-6329.55" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-6318.55" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1777" y="-6307.55" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_55_mha&#45;&gt;moe_55_res1 -->
<g id="edge1952" class="edge">
<title>moe_55_mha&#45;&gt;moe_55_res1</title>
<path fill="none" stroke="black" d="M1777,-6414.41C1777,-6406.73 1777,-6397.91 1777,-6388.92"/>
<polygon fill="black" stroke="black" points="1780.5,-6388.73 1777,-6378.73 1773.5,-6388.73 1780.5,-6388.73"/>
</g>
<!-- moe_55_gate -->
<g id="node1188" class="node">
<title>moe_55_gate</title>
<polygon fill="lightyellow" stroke="black" points="2105.8,-6238.55 1582.75,-6238.55 1448.2,-6134.55 1971.25,-6134.55 2105.8,-6238.55"/>
<text text-anchor="middle" x="1777" y="-6200.55" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1777" y="-6189.55" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-6178.55" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-6167.55" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_55_route -->
<g id="node1189" class="node">
<title>moe_55_route</title>
<ellipse fill="lightblue" stroke="black" cx="1777" cy="-6061.78" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1777" y="-6075.78" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1777" y="-6064.78" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1777" y="-6053.78" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-6042.78" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_55_gate&#45;&gt;moe_55_route -->
<g id="edge1954" class="edge">
<title>moe_55_gate&#45;&gt;moe_55_route</title>
<path fill="none" stroke="black" d="M1777,-6134.19C1777,-6125.79 1777,-6117.12 1777,-6108.85"/>
<polygon fill="black" stroke="black" points="1780.5,-6108.63 1777,-6098.63 1773.5,-6108.63 1780.5,-6108.63"/>
</g>
<!-- moe_55_expert_0 -->
<g id="node1190" class="node">
<title>moe_55_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-5989.01 16,-5989.01 16,-5937.01 234,-5937.01 234,-5989.01"/>
<text text-anchor="middle" x="125" y="-5977.01" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-5966.01" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-5955.01" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-5944.01" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_55_route&#45;&gt;moe_55_expert_0 -->
<g id="edge1955" class="edge">
<title>moe_55_route&#45;&gt;moe_55_expert_0</title>
<path fill="none" stroke="black" d="M1562.77,-6055.05C1207.39,-6044.83 509.65,-6021.55 244.21,-5989.05"/>
<polygon fill="black" stroke="black" points="244.54,-5985.56 234.18,-5987.79 243.67,-5992.51 244.54,-5985.56"/>
</g>
<!-- moe_55_expert_1 -->
<g id="node1191" class="node">
<title>moe_55_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-5989.01 252,-5989.01 252,-5937.01 470,-5937.01 470,-5989.01"/>
<text text-anchor="middle" x="361" y="-5977.01" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-5966.01" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-5955.01" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-5944.01" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_55_route&#45;&gt;moe_55_expert_1 -->
<g id="edge1956" class="edge">
<title>moe_55_route&#45;&gt;moe_55_expert_1</title>
<path fill="none" stroke="black" d="M1559.59,-6058.93C1303.22,-6054.43 864.4,-6039.43 480.11,-5989.07"/>
<polygon fill="black" stroke="black" points="480.56,-5985.6 470.19,-5987.76 479.64,-5992.54 480.56,-5985.6"/>
</g>
<!-- moe_55_expert_2 -->
<g id="node1192" class="node">
<title>moe_55_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-5989.01 488,-5989.01 488,-5937.01 706,-5937.01 706,-5989.01"/>
<text text-anchor="middle" x="597" y="-5977.01" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-5966.01" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-5955.01" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-5944.01" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_55_route&#45;&gt;moe_55_expert_2 -->
<g id="edge1957" class="edge">
<title>moe_55_route&#45;&gt;moe_55_expert_2</title>
<path fill="none" stroke="black" d="M1562.51,-6055.17C1349.77,-6047.55 1014.57,-6029.99 716.34,-5989.11"/>
<polygon fill="black" stroke="black" points="716.58,-5985.61 706.2,-5987.71 715.62,-5992.55 716.58,-5985.61"/>
</g>
<!-- moe_55_expert_3 -->
<g id="node1193" class="node">
<title>moe_55_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-5989.01 724,-5989.01 724,-5937.01 942,-5937.01 942,-5989.01"/>
<text text-anchor="middle" x="833" y="-5977.01" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-5966.01" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-5955.01" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-5944.01" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_55_route&#45;&gt;moe_55_expert_3 -->
<g id="edge1958" class="edge">
<title>moe_55_route&#45;&gt;moe_55_expert_3</title>
<path fill="none" stroke="black" d="M1570.82,-6049.87C1405.76,-6039.48 1168.32,-6020.83 952.16,-5989.11"/>
<polygon fill="black" stroke="black" points="952.61,-5985.64 942.21,-5987.64 951.59,-5992.56 952.61,-5985.64"/>
</g>
<!-- moe_55_expert_4 -->
<g id="node1194" class="node">
<title>moe_55_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-5989.01 960,-5989.01 960,-5937.01 1178,-5937.01 1178,-5989.01"/>
<text text-anchor="middle" x="1069" y="-5977.01" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-5966.01" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-5955.01" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-5944.01" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_55_route&#45;&gt;moe_55_expert_4 -->
<g id="edge1959" class="edge">
<title>moe_55_route&#45;&gt;moe_55_expert_4</title>
<path fill="none" stroke="black" d="M1591.38,-6042.42C1477.62,-6030.15 1328.9,-6012.29 1188.33,-5989.18"/>
<polygon fill="black" stroke="black" points="1188.66,-5985.68 1178.23,-5987.5 1187.52,-5992.59 1188.66,-5985.68"/>
</g>
<!-- moe_55_expert_5 -->
<g id="node1195" class="node">
<title>moe_55_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-5989.01 1196,-5989.01 1196,-5937.01 1414,-5937.01 1414,-5989.01"/>
<text text-anchor="middle" x="1305" y="-5977.01" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-5966.01" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-5955.01" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-5944.01" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_55_route&#45;&gt;moe_55_expert_5 -->
<g id="edge1960" class="edge">
<title>moe_55_route&#45;&gt;moe_55_expert_5</title>
<path fill="none" stroke="black" d="M1639.51,-6033.19C1576.62,-6020.51 1500.88,-6005.13 1424.14,-5989.24"/>
<polygon fill="black" stroke="black" points="1424.79,-5985.8 1414.28,-5987.2 1423.37,-5992.65 1424.79,-5985.8"/>
</g>
<!-- moe_55_expert_6 -->
<g id="node1196" class="node">
<title>moe_55_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-5989.01 1432,-5989.01 1432,-5937.01 1650,-5937.01 1650,-5989.01"/>
<text text-anchor="middle" x="1541" y="-5977.01" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-5966.01" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-5955.01" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-5944.01" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_55_route&#45;&gt;moe_55_expert_6 -->
<g id="edge1961" class="edge">
<title>moe_55_route&#45;&gt;moe_55_expert_6</title>
<path fill="none" stroke="black" d="M1696.11,-6027.61C1668.54,-6016.31 1637.96,-6003.77 1611.29,-5992.83"/>
<polygon fill="black" stroke="black" points="1612.61,-5989.59 1602.03,-5989.03 1609.95,-5996.06 1612.61,-5989.59"/>
</g>
<!-- moe_55_expert_7 -->
<g id="node1197" class="node">
<title>moe_55_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-5989.01 1668,-5989.01 1668,-5937.01 1886,-5937.01 1886,-5989.01"/>
<text text-anchor="middle" x="1777" y="-5977.01" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-5966.01" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-5955.01" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-5944.01" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_55_route&#45;&gt;moe_55_expert_7 -->
<g id="edge1962" class="edge">
<title>moe_55_route&#45;&gt;moe_55_expert_7</title>
<path fill="none" stroke="black" d="M1777,-6024.74C1777,-6016.43 1777,-6007.6 1777,-5999.32"/>
<polygon fill="black" stroke="black" points="1780.5,-5999.2 1777,-5989.2 1773.5,-5999.2 1780.5,-5999.2"/>
</g>
<!-- moe_55_expert_8 -->
<g id="node1198" class="node">
<title>moe_55_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-5989.01 1904,-5989.01 1904,-5937.01 2122,-5937.01 2122,-5989.01"/>
<text text-anchor="middle" x="2013" y="-5977.01" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-5966.01" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-5955.01" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-5944.01" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_55_route&#45;&gt;moe_55_expert_8 -->
<g id="edge1963" class="edge">
<title>moe_55_route&#45;&gt;moe_55_expert_8</title>
<path fill="none" stroke="black" d="M1857.89,-6027.61C1885.46,-6016.31 1916.04,-6003.77 1942.71,-5992.83"/>
<polygon fill="black" stroke="black" points="1944.05,-5996.06 1951.97,-5989.03 1941.39,-5989.59 1944.05,-5996.06"/>
</g>
<!-- moe_55_expert_9 -->
<g id="node1199" class="node">
<title>moe_55_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-5989.01 2140,-5989.01 2140,-5937.01 2358,-5937.01 2358,-5989.01"/>
<text text-anchor="middle" x="2249" y="-5977.01" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-5966.01" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-5955.01" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-5944.01" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_55_route&#45;&gt;moe_55_expert_9 -->
<g id="edge1964" class="edge">
<title>moe_55_route&#45;&gt;moe_55_expert_9</title>
<path fill="none" stroke="black" d="M1914.49,-6033.19C1977.38,-6020.51 2053.12,-6005.13 2129.86,-5989.24"/>
<polygon fill="black" stroke="black" points="2130.63,-5992.65 2139.72,-5987.2 2129.21,-5985.8 2130.63,-5992.65"/>
</g>
<!-- moe_55_expert_10 -->
<g id="node1200" class="node">
<title>moe_55_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-5989.01 2376,-5989.01 2376,-5937.01 2594,-5937.01 2594,-5989.01"/>
<text text-anchor="middle" x="2485" y="-5977.01" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-5966.01" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-5955.01" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-5944.01" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_55_route&#45;&gt;moe_55_expert_10 -->
<g id="edge1965" class="edge">
<title>moe_55_route&#45;&gt;moe_55_expert_10</title>
<path fill="none" stroke="black" d="M1962.62,-6042.42C2076.38,-6030.15 2225.1,-6012.29 2365.67,-5989.18"/>
<polygon fill="black" stroke="black" points="2366.48,-5992.59 2375.77,-5987.5 2365.34,-5985.68 2366.48,-5992.59"/>
</g>
<!-- moe_55_expert_11 -->
<g id="node1201" class="node">
<title>moe_55_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-5989.01 2612,-5989.01 2612,-5937.01 2830,-5937.01 2830,-5989.01"/>
<text text-anchor="middle" x="2721" y="-5977.01" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-5966.01" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-5955.01" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-5944.01" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_55_route&#45;&gt;moe_55_expert_11 -->
<g id="edge1966" class="edge">
<title>moe_55_route&#45;&gt;moe_55_expert_11</title>
<path fill="none" stroke="black" d="M1983.18,-6049.87C2148.24,-6039.48 2385.68,-6020.83 2601.84,-5989.11"/>
<polygon fill="black" stroke="black" points="2602.41,-5992.56 2611.79,-5987.64 2601.39,-5985.64 2602.41,-5992.56"/>
</g>
<!-- moe_55_expert_12 -->
<g id="node1202" class="node">
<title>moe_55_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-5989.01 2848,-5989.01 2848,-5937.01 3066,-5937.01 3066,-5989.01"/>
<text text-anchor="middle" x="2957" y="-5977.01" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-5966.01" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-5955.01" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-5944.01" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_55_route&#45;&gt;moe_55_expert_12 -->
<g id="edge1967" class="edge">
<title>moe_55_route&#45;&gt;moe_55_expert_12</title>
<path fill="none" stroke="black" d="M1991.49,-6055.17C2204.23,-6047.55 2539.43,-6029.99 2837.66,-5989.11"/>
<polygon fill="black" stroke="black" points="2838.38,-5992.55 2847.8,-5987.71 2837.42,-5985.61 2838.38,-5992.55"/>
</g>
<!-- moe_55_expert_13 -->
<g id="node1203" class="node">
<title>moe_55_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-5989.01 3084,-5989.01 3084,-5937.01 3302,-5937.01 3302,-5989.01"/>
<text text-anchor="middle" x="3193" y="-5977.01" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-5966.01" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-5955.01" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-5944.01" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_55_route&#45;&gt;moe_55_expert_13 -->
<g id="edge1968" class="edge">
<title>moe_55_route&#45;&gt;moe_55_expert_13</title>
<path fill="none" stroke="black" d="M1994.41,-6058.93C2250.78,-6054.43 2689.6,-6039.43 3073.89,-5989.07"/>
<polygon fill="black" stroke="black" points="3074.36,-5992.54 3083.81,-5987.76 3073.44,-5985.6 3074.36,-5992.54"/>
</g>
<!-- moe_55_expert_14 -->
<g id="node1204" class="node">
<title>moe_55_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-5989.01 3320,-5989.01 3320,-5937.01 3538,-5937.01 3538,-5989.01"/>
<text text-anchor="middle" x="3429" y="-5977.01" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-5966.01" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-5955.01" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-5944.01" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_55_route&#45;&gt;moe_55_expert_14 -->
<g id="edge1969" class="edge">
<title>moe_55_route&#45;&gt;moe_55_expert_14</title>
<path fill="none" stroke="black" d="M1991.23,-6055.05C2346.61,-6044.83 3044.35,-6021.55 3309.79,-5989.05"/>
<polygon fill="black" stroke="black" points="3310.33,-5992.51 3319.82,-5987.79 3309.46,-5985.56 3310.33,-5992.51"/>
</g>
<!-- moe_55_expert_15 -->
<g id="node1205" class="node">
<title>moe_55_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-5989.01 3556,-5989.01 3556,-5937.01 3774,-5937.01 3774,-5989.01"/>
<text text-anchor="middle" x="3665" y="-5977.01" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-5966.01" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-5955.01" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-5944.01" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_55_route&#45;&gt;moe_55_expert_15 -->
<g id="edge1970" class="edge">
<title>moe_55_route&#45;&gt;moe_55_expert_15</title>
<path fill="none" stroke="black" d="M1992.71,-6056.57C2392.25,-6048.04 3234.28,-6026.37 3545.86,-5989.04"/>
<polygon fill="black" stroke="black" points="3546.32,-5992.51 3555.82,-5987.82 3545.47,-5985.56 3546.32,-5992.51"/>
</g>
<!-- moe_55_aggregate -->
<g id="node1206" class="node">
<title>moe_55_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-5864.24" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-5878.24" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1895" y="-5867.24" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-5856.24" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1895" y="-5845.24" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_55_expert_0&#45;&gt;moe_55_aggregate -->
<g id="edge1971" class="edge">
<title>moe_55_expert_0&#45;&gt;moe_55_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-5938.21C237.15,-5937.78 240.09,-5937.38 243,-5937.01 510.74,-5903.07 1276.32,-5880.27 1664.04,-5870.55"/>
<polygon fill="black" stroke="black" points="1664.35,-5874.05 1674.26,-5870.3 1664.17,-5867.05 1664.35,-5874.05"/>
</g>
<!-- moe_55_expert_1&#45;&gt;moe_55_aggregate -->
<g id="edge1972" class="edge">
<title>moe_55_expert_1&#45;&gt;moe_55_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-5938.24C473.15,-5937.8 476.09,-5937.39 479,-5937.01 892.79,-5883.03 1379.51,-5869.07 1661.11,-5865.8"/>
<polygon fill="black" stroke="black" points="1661.49,-5869.29 1671.45,-5865.68 1661.41,-5862.29 1661.49,-5869.29"/>
</g>
<!-- moe_55_expert_2&#45;&gt;moe_55_aggregate -->
<g id="edge1973" class="edge">
<title>moe_55_expert_2&#45;&gt;moe_55_aggregate</title>
<path fill="none" stroke="black" d="M706.19,-5938.28C709.15,-5937.83 712.09,-5937.4 715,-5937.01 1042.31,-5892.63 1424.45,-5875.69 1663.11,-5869.22"/>
<polygon fill="black" stroke="black" points="1663.4,-5872.71 1673.31,-5868.95 1663.22,-5865.72 1663.4,-5872.71"/>
</g>
<!-- moe_55_expert_3&#45;&gt;moe_55_aggregate -->
<g id="edge1974" class="edge">
<title>moe_55_expert_3&#45;&gt;moe_55_aggregate</title>
<path fill="none" stroke="black" d="M942.2,-5938.34C945.16,-5937.87 948.1,-5937.42 951,-5937.01 1194.76,-5902.08 1476.52,-5883.45 1668.32,-5874.01"/>
<polygon fill="black" stroke="black" points="1668.71,-5877.49 1678.53,-5873.51 1668.37,-5870.5 1668.71,-5877.49"/>
</g>
<!-- moe_55_expert_4&#45;&gt;moe_55_aggregate -->
<g id="edge1975" class="edge">
<title>moe_55_expert_4&#45;&gt;moe_55_aggregate</title>
<path fill="none" stroke="black" d="M1178.21,-5938.44C1181.17,-5937.94 1184.1,-5937.46 1187,-5937.01 1352.7,-5911.13 1541.73,-5892.52 1682.77,-5880.74"/>
<polygon fill="black" stroke="black" points="1683.17,-5884.22 1692.84,-5879.91 1682.59,-5877.25 1683.17,-5884.22"/>
</g>
<!-- moe_55_expert_5&#45;&gt;moe_55_aggregate -->
<g id="edge1976" class="edge">
<title>moe_55_expert_5&#45;&gt;moe_55_aggregate</title>
<path fill="none" stroke="black" d="M1414.25,-5938.63C1417.19,-5938.07 1420.12,-5937.53 1423,-5937.01 1519.58,-5919.45 1627.83,-5902.78 1716.27,-5889.93"/>
<polygon fill="black" stroke="black" points="1717.01,-5893.36 1726.4,-5888.46 1716,-5886.43 1717.01,-5893.36"/>
</g>
<!-- moe_55_expert_6&#45;&gt;moe_55_aggregate -->
<g id="edge1977" class="edge">
<title>moe_55_expert_6&#45;&gt;moe_55_aggregate</title>
<path fill="none" stroke="black" d="M1632.62,-5936.96C1675.27,-5925.3 1726.62,-5911.27 1772.54,-5898.71"/>
<polygon fill="black" stroke="black" points="1773.53,-5902.07 1782.25,-5896.06 1771.68,-5895.32 1773.53,-5902.07"/>
</g>
<!-- moe_55_expert_7&#45;&gt;moe_55_aggregate -->
<g id="edge1978" class="edge">
<title>moe_55_expert_7&#45;&gt;moe_55_aggregate</title>
<path fill="none" stroke="black" d="M1807.7,-5936.84C1818.79,-5927.74 1831.63,-5917.21 1843.99,-5907.07"/>
<polygon fill="black" stroke="black" points="1846.51,-5909.53 1852.02,-5900.48 1842.07,-5904.12 1846.51,-5909.53"/>
</g>
<!-- moe_55_expert_8&#45;&gt;moe_55_aggregate -->
<g id="edge1979" class="edge">
<title>moe_55_expert_8&#45;&gt;moe_55_aggregate</title>
<path fill="none" stroke="black" d="M1982.3,-5936.84C1971.21,-5927.74 1958.37,-5917.21 1946.01,-5907.07"/>
<polygon fill="black" stroke="black" points="1947.93,-5904.12 1937.98,-5900.48 1943.49,-5909.53 1947.93,-5904.12"/>
</g>
<!-- moe_55_expert_9&#45;&gt;moe_55_aggregate -->
<g id="edge1980" class="edge">
<title>moe_55_expert_9&#45;&gt;moe_55_aggregate</title>
<path fill="none" stroke="black" d="M2157.38,-5936.96C2114.73,-5925.3 2063.38,-5911.27 2017.46,-5898.71"/>
<polygon fill="black" stroke="black" points="2018.32,-5895.32 2007.75,-5896.06 2016.47,-5902.07 2018.32,-5895.32"/>
</g>
<!-- moe_55_expert_10&#45;&gt;moe_55_aggregate -->
<g id="edge1981" class="edge">
<title>moe_55_expert_10&#45;&gt;moe_55_aggregate</title>
<path fill="none" stroke="black" d="M2375.75,-5938.63C2372.81,-5938.07 2369.88,-5937.53 2367,-5937.01 2270.42,-5919.45 2162.17,-5902.78 2073.73,-5889.93"/>
<polygon fill="black" stroke="black" points="2074,-5886.43 2063.6,-5888.46 2072.99,-5893.36 2074,-5886.43"/>
</g>
<!-- moe_55_expert_11&#45;&gt;moe_55_aggregate -->
<g id="edge1982" class="edge">
<title>moe_55_expert_11&#45;&gt;moe_55_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-5938.44C2608.83,-5937.94 2605.9,-5937.46 2603,-5937.01 2437.3,-5911.13 2248.27,-5892.52 2107.23,-5880.74"/>
<polygon fill="black" stroke="black" points="2107.41,-5877.25 2097.16,-5879.91 2106.83,-5884.22 2107.41,-5877.25"/>
</g>
<!-- moe_55_expert_12&#45;&gt;moe_55_aggregate -->
<g id="edge1983" class="edge">
<title>moe_55_expert_12&#45;&gt;moe_55_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-5938.34C2844.84,-5937.87 2841.9,-5937.42 2839,-5937.01 2595.24,-5902.08 2313.48,-5883.45 2121.68,-5874.01"/>
<polygon fill="black" stroke="black" points="2121.63,-5870.5 2111.47,-5873.51 2121.29,-5877.49 2121.63,-5870.5"/>
</g>
<!-- moe_55_expert_13&#45;&gt;moe_55_aggregate -->
<g id="edge1984" class="edge">
<title>moe_55_expert_13&#45;&gt;moe_55_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-5938.28C3080.85,-5937.83 3077.91,-5937.4 3075,-5937.01 2747.69,-5892.63 2365.55,-5875.69 2126.89,-5869.22"/>
<polygon fill="black" stroke="black" points="2126.78,-5865.72 2116.69,-5868.95 2126.6,-5872.71 2126.78,-5865.72"/>
</g>
<!-- moe_55_expert_14&#45;&gt;moe_55_aggregate -->
<g id="edge1985" class="edge">
<title>moe_55_expert_14&#45;&gt;moe_55_aggregate</title>
<path fill="none" stroke="black" d="M3319.81,-5938.24C3316.85,-5937.8 3313.91,-5937.39 3311,-5937.01 2897.21,-5883.03 2410.49,-5869.07 2128.89,-5865.8"/>
<polygon fill="black" stroke="black" points="2128.59,-5862.29 2118.55,-5865.68 2128.51,-5869.29 2128.59,-5862.29"/>
</g>
<!-- moe_55_expert_15&#45;&gt;moe_55_aggregate -->
<g id="edge1986" class="edge">
<title>moe_55_expert_15&#45;&gt;moe_55_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-5938.21C3552.85,-5937.78 3549.91,-5937.38 3547,-5937.01 3279.26,-5903.07 2513.68,-5880.27 2125.96,-5870.55"/>
<polygon fill="black" stroke="black" points="2125.83,-5867.05 2115.74,-5870.3 2125.65,-5874.05 2125.83,-5867.05"/>
</g>
<!-- moe_55_ffn -->
<g id="node1207" class="node">
<title>moe_55_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2053,-5791.47 1737,-5791.47 1737,-5739.47 2053,-5739.47 2053,-5791.47"/>
<text text-anchor="middle" x="1895" y="-5779.47" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1895" y="-5768.47" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-5757.47" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-5746.47" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_55_aggregate&#45;&gt;moe_55_ffn -->
<g id="edge1987" class="edge">
<title>moe_55_aggregate&#45;&gt;moe_55_ffn</title>
<path fill="none" stroke="black" d="M1895,-5827.21C1895,-5818.89 1895,-5810.06 1895,-5801.78"/>
<polygon fill="black" stroke="black" points="1898.5,-5801.67 1895,-5791.67 1891.5,-5801.67 1898.5,-5801.67"/>
</g>
<!-- moe_55_res2 -->
<g id="node1209" class="node">
<title>moe_55_res2</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-5703.47 1695.97,-5703.47 1558.11,-5599.47 2094.03,-5599.47 2231.89,-5703.47"/>
<text text-anchor="middle" x="1895" y="-5665.47" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1895" y="-5654.47" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-5643.47" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-5632.47" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_55_ffn&#45;&gt;moe_55_res2 -->
<g id="edge1988" class="edge">
<title>moe_55_ffn&#45;&gt;moe_55_res2</title>
<path fill="none" stroke="black" d="M1895,-5739.33C1895,-5731.65 1895,-5722.84 1895,-5713.84"/>
<polygon fill="black" stroke="black" points="1898.5,-5713.65 1895,-5703.65 1891.5,-5713.65 1898.5,-5713.65"/>
</g>
<!-- moe_55_res1&#45;&gt;moe_55_gate -->
<g id="edge1953" class="edge">
<title>moe_55_res1&#45;&gt;moe_55_gate</title>
<path fill="none" stroke="black" d="M1777,-6274.16C1777,-6265.99 1777,-6257.46 1777,-6249.09"/>
<polygon fill="black" stroke="black" points="1780.5,-6248.98 1777,-6238.98 1773.5,-6248.98 1780.5,-6248.98"/>
</g>
<!-- moe_56_mha -->
<g id="node1210" class="node">
<title>moe_56_mha</title>
<polygon fill="lightgreen" stroke="black" points="2053,-5552.47 1737,-5552.47 1737,-5500.47 2053,-5500.47 2053,-5552.47"/>
<text text-anchor="middle" x="1895" y="-5540.47" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1895" y="-5529.47" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-5518.47" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-5507.47" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_55_res2&#45;&gt;moe_56_mha -->
<g id="edge1989" class="edge">
<title>moe_55_res2&#45;&gt;moe_56_mha</title>
<path fill="none" stroke="black" d="M1895,-5599.37C1895,-5587.04 1895,-5574.14 1895,-5562.72"/>
<polygon fill="black" stroke="black" points="1898.5,-5562.71 1895,-5552.71 1891.5,-5562.71 1898.5,-5562.71"/>
</g>
<!-- moe_56_res1 -->
<g id="node1231" class="node">
<title>moe_56_res1</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-5464.47 1695.97,-5464.47 1558.11,-5360.47 2094.03,-5360.47 2231.89,-5464.47"/>
<text text-anchor="middle" x="1895" y="-5426.47" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1895" y="-5415.47" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-5404.47" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-5393.47" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_56_mha&#45;&gt;moe_56_res1 -->
<g id="edge1990" class="edge">
<title>moe_56_mha&#45;&gt;moe_56_res1</title>
<path fill="none" stroke="black" d="M1895,-5500.33C1895,-5492.65 1895,-5483.84 1895,-5474.84"/>
<polygon fill="black" stroke="black" points="1898.5,-5474.65 1895,-5464.65 1891.5,-5474.65 1898.5,-5474.65"/>
</g>
<!-- moe_56_gate -->
<g id="node1211" class="node">
<title>moe_56_gate</title>
<polygon fill="lightyellow" stroke="black" points="2223.8,-5324.47 1700.75,-5324.47 1566.2,-5220.47 2089.25,-5220.47 2223.8,-5324.47"/>
<text text-anchor="middle" x="1895" y="-5286.47" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1895" y="-5275.47" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-5264.47" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-5253.47" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_56_route -->
<g id="node1212" class="node">
<title>moe_56_route</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-5147.7" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-5161.7" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1895" y="-5150.7" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-5139.7" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-5128.7" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_56_gate&#45;&gt;moe_56_route -->
<g id="edge1992" class="edge">
<title>moe_56_gate&#45;&gt;moe_56_route</title>
<path fill="none" stroke="black" d="M1895,-5220.12C1895,-5211.71 1895,-5203.04 1895,-5194.77"/>
<polygon fill="black" stroke="black" points="1898.5,-5194.56 1895,-5184.56 1891.5,-5194.56 1898.5,-5194.56"/>
</g>
<!-- moe_56_expert_0 -->
<g id="node1213" class="node">
<title>moe_56_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-5074.93 16,-5074.93 16,-5022.93 234,-5022.93 234,-5074.93"/>
<text text-anchor="middle" x="125" y="-5062.93" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-5051.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-5040.93" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-5029.93" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_56_route&#45;&gt;moe_56_expert_0 -->
<g id="edge1993" class="edge">
<title>moe_56_route&#45;&gt;moe_56_expert_0</title>
<path fill="none" stroke="black" d="M1679.93,-5141.78C1302.11,-5132.41 532.75,-5109.88 244.24,-5074.97"/>
<polygon fill="black" stroke="black" points="244.54,-5071.48 234.18,-5073.73 243.68,-5078.43 244.54,-5071.48"/>
</g>
<!-- moe_56_expert_1 -->
<g id="node1214" class="node">
<title>moe_56_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-5074.93 252,-5074.93 252,-5022.93 470,-5022.93 470,-5074.93"/>
<text text-anchor="middle" x="361" y="-5062.93" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-5051.93" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-5040.93" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-5029.93" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_56_route&#45;&gt;moe_56_expert_1 -->
<g id="edge1994" class="edge">
<title>moe_56_route&#45;&gt;moe_56_expert_1</title>
<path fill="none" stroke="black" d="M1677.23,-5146.32C1400.57,-5143.42 908.56,-5130.16 480.29,-5075.01"/>
<polygon fill="black" stroke="black" points="480.55,-5071.51 470.19,-5073.7 479.65,-5078.45 480.55,-5071.51"/>
</g>
<!-- moe_56_expert_2 -->
<g id="node1215" class="node">
<title>moe_56_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-5074.93 488,-5074.93 488,-5022.93 706,-5022.93 706,-5074.93"/>
<text text-anchor="middle" x="597" y="-5062.93" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-5051.93" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-5040.93" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-5029.93" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_56_route&#45;&gt;moe_56_expert_2 -->
<g id="edge1995" class="edge">
<title>moe_56_route&#45;&gt;moe_56_expert_2</title>
<path fill="none" stroke="black" d="M1678.74,-5143.13C1443.7,-5137.05 1057.2,-5120.62 716.26,-5075.02"/>
<polygon fill="black" stroke="black" points="716.57,-5071.53 706.19,-5073.66 715.63,-5078.46 716.57,-5071.53"/>
</g>
<!-- moe_56_expert_3 -->
<g id="node1216" class="node">
<title>moe_56_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-5074.93 724,-5074.93 724,-5022.93 942,-5022.93 942,-5074.93"/>
<text text-anchor="middle" x="833" y="-5062.93" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-5051.93" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-5040.93" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-5029.93" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_56_route&#45;&gt;moe_56_expert_3 -->
<g id="edge1996" class="edge">
<title>moe_56_route&#45;&gt;moe_56_expert_3</title>
<path fill="none" stroke="black" d="M1683.7,-5138.68C1494.33,-5129.6 1209,-5111.3 952.47,-5075.06"/>
<polygon fill="black" stroke="black" points="952.59,-5071.54 942.2,-5073.6 951.61,-5078.47 952.59,-5071.54"/>
</g>
<!-- moe_56_expert_4 -->
<g id="node1217" class="node">
<title>moe_56_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-5074.93 960,-5074.93 960,-5022.93 1178,-5022.93 1178,-5074.93"/>
<text text-anchor="middle" x="1069" y="-5062.93" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-5051.93" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-5040.93" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-5029.93" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_56_route&#45;&gt;moe_56_expert_4 -->
<g id="edge1997" class="edge">
<title>moe_56_route&#45;&gt;moe_56_expert_4</title>
<path fill="none" stroke="black" d="M1696.66,-5132.35C1556.96,-5120.86 1365.46,-5102.37 1188.25,-5075.06"/>
<polygon fill="black" stroke="black" points="1188.63,-5071.58 1178.21,-5073.5 1187.56,-5078.49 1188.63,-5071.58"/>
</g>
<!-- moe_56_expert_5 -->
<g id="node1218" class="node">
<title>moe_56_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-5074.93 1196,-5074.93 1196,-5022.93 1414,-5022.93 1414,-5074.93"/>
<text text-anchor="middle" x="1305" y="-5062.93" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-5051.93" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-5040.93" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-5029.93" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_56_route&#45;&gt;moe_56_expert_5 -->
<g id="edge1998" class="edge">
<title>moe_56_route&#45;&gt;moe_56_expert_5</title>
<path fill="none" stroke="black" d="M1728.87,-5123.84C1640.99,-5111.16 1531.11,-5094.38 1424.25,-5075.12"/>
<polygon fill="black" stroke="black" points="1424.71,-5071.65 1414.25,-5073.31 1423.46,-5078.53 1424.71,-5071.65"/>
</g>
<!-- moe_56_expert_6 -->
<g id="node1219" class="node">
<title>moe_56_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-5074.93 1432,-5074.93 1432,-5022.93 1650,-5022.93 1650,-5074.93"/>
<text text-anchor="middle" x="1541" y="-5062.93" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-5051.93" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-5040.93" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-5029.93" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_56_route&#45;&gt;moe_56_expert_6 -->
<g id="edge1999" class="edge">
<title>moe_56_route&#45;&gt;moe_56_expert_6</title>
<path fill="none" stroke="black" d="M1782.99,-5116.08C1737.98,-5103.78 1686.47,-5089.69 1642.56,-5077.69"/>
<polygon fill="black" stroke="black" points="1643.31,-5074.27 1632.74,-5075.01 1641.46,-5081.02 1643.31,-5074.27"/>
</g>
<!-- moe_56_expert_7 -->
<g id="node1220" class="node">
<title>moe_56_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-5074.93 1668,-5074.93 1668,-5022.93 1886,-5022.93 1886,-5074.93"/>
<text text-anchor="middle" x="1777" y="-5062.93" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-5051.93" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-5040.93" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-5029.93" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_56_route&#45;&gt;moe_56_expert_7 -->
<g id="edge2000" class="edge">
<title>moe_56_route&#45;&gt;moe_56_expert_7</title>
<path fill="none" stroke="black" d="M1852.07,-5111.49C1840.07,-5101.65 1827.12,-5091.03 1815.41,-5081.43"/>
<polygon fill="black" stroke="black" points="1817.47,-5078.6 1807.52,-5074.96 1813.04,-5084.01 1817.47,-5078.6"/>
</g>
<!-- moe_56_expert_8 -->
<g id="node1221" class="node">
<title>moe_56_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-5074.93 1904,-5074.93 1904,-5022.93 2122,-5022.93 2122,-5074.93"/>
<text text-anchor="middle" x="2013" y="-5062.93" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-5051.93" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-5040.93" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-5029.93" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_56_route&#45;&gt;moe_56_expert_8 -->
<g id="edge2001" class="edge">
<title>moe_56_route&#45;&gt;moe_56_expert_8</title>
<path fill="none" stroke="black" d="M1937.93,-5111.49C1949.93,-5101.65 1962.88,-5091.03 1974.59,-5081.43"/>
<polygon fill="black" stroke="black" points="1976.96,-5084.01 1982.48,-5074.96 1972.53,-5078.6 1976.96,-5084.01"/>
</g>
<!-- moe_56_expert_9 -->
<g id="node1222" class="node">
<title>moe_56_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-5074.93 2140,-5074.93 2140,-5022.93 2358,-5022.93 2358,-5074.93"/>
<text text-anchor="middle" x="2249" y="-5062.93" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-5051.93" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-5040.93" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-5029.93" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_56_route&#45;&gt;moe_56_expert_9 -->
<g id="edge2002" class="edge">
<title>moe_56_route&#45;&gt;moe_56_expert_9</title>
<path fill="none" stroke="black" d="M2007.01,-5116.08C2052.02,-5103.78 2103.53,-5089.69 2147.44,-5077.69"/>
<polygon fill="black" stroke="black" points="2148.54,-5081.02 2157.26,-5075.01 2146.69,-5074.27 2148.54,-5081.02"/>
</g>
<!-- moe_56_expert_10 -->
<g id="node1223" class="node">
<title>moe_56_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-5074.93 2376,-5074.93 2376,-5022.93 2594,-5022.93 2594,-5074.93"/>
<text text-anchor="middle" x="2485" y="-5062.93" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-5051.93" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-5040.93" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-5029.93" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_56_route&#45;&gt;moe_56_expert_10 -->
<g id="edge2003" class="edge">
<title>moe_56_route&#45;&gt;moe_56_expert_10</title>
<path fill="none" stroke="black" d="M2061.13,-5123.84C2149.01,-5111.16 2258.89,-5094.38 2365.75,-5075.12"/>
<polygon fill="black" stroke="black" points="2366.54,-5078.53 2375.75,-5073.31 2365.29,-5071.65 2366.54,-5078.53"/>
</g>
<!-- moe_56_expert_11 -->
<g id="node1224" class="node">
<title>moe_56_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-5074.93 2612,-5074.93 2612,-5022.93 2830,-5022.93 2830,-5074.93"/>
<text text-anchor="middle" x="2721" y="-5062.93" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-5051.93" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-5040.93" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-5029.93" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_56_route&#45;&gt;moe_56_expert_11 -->
<g id="edge2004" class="edge">
<title>moe_56_route&#45;&gt;moe_56_expert_11</title>
<path fill="none" stroke="black" d="M2093.34,-5132.35C2233.04,-5120.86 2424.54,-5102.37 2601.75,-5075.06"/>
<polygon fill="black" stroke="black" points="2602.44,-5078.49 2611.79,-5073.5 2601.37,-5071.58 2602.44,-5078.49"/>
</g>
<!-- moe_56_expert_12 -->
<g id="node1225" class="node">
<title>moe_56_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-5074.93 2848,-5074.93 2848,-5022.93 3066,-5022.93 3066,-5074.93"/>
<text text-anchor="middle" x="2957" y="-5062.93" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-5051.93" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-5040.93" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-5029.93" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_56_route&#45;&gt;moe_56_expert_12 -->
<g id="edge2005" class="edge">
<title>moe_56_route&#45;&gt;moe_56_expert_12</title>
<path fill="none" stroke="black" d="M2106.3,-5138.68C2295.67,-5129.6 2581,-5111.3 2837.53,-5075.06"/>
<polygon fill="black" stroke="black" points="2838.39,-5078.47 2847.8,-5073.6 2837.41,-5071.54 2838.39,-5078.47"/>
</g>
<!-- moe_56_expert_13 -->
<g id="node1226" class="node">
<title>moe_56_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-5074.93 3084,-5074.93 3084,-5022.93 3302,-5022.93 3302,-5074.93"/>
<text text-anchor="middle" x="3193" y="-5062.93" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-5051.93" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-5040.93" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-5029.93" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_56_route&#45;&gt;moe_56_expert_13 -->
<g id="edge2006" class="edge">
<title>moe_56_route&#45;&gt;moe_56_expert_13</title>
<path fill="none" stroke="black" d="M2111.26,-5143.13C2346.3,-5137.05 2732.8,-5120.62 3073.74,-5075.02"/>
<polygon fill="black" stroke="black" points="3074.37,-5078.46 3083.81,-5073.66 3073.43,-5071.53 3074.37,-5078.46"/>
</g>
<!-- moe_56_expert_14 -->
<g id="node1227" class="node">
<title>moe_56_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-5074.93 3320,-5074.93 3320,-5022.93 3538,-5022.93 3538,-5074.93"/>
<text text-anchor="middle" x="3429" y="-5062.93" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-5051.93" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-5040.93" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-5029.93" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_56_route&#45;&gt;moe_56_expert_14 -->
<g id="edge2007" class="edge">
<title>moe_56_route&#45;&gt;moe_56_expert_14</title>
<path fill="none" stroke="black" d="M2112.77,-5146.32C2389.43,-5143.42 2881.44,-5130.16 3309.71,-5075.01"/>
<polygon fill="black" stroke="black" points="3310.35,-5078.45 3319.81,-5073.7 3309.45,-5071.51 3310.35,-5078.45"/>
</g>
<!-- moe_56_expert_15 -->
<g id="node1228" class="node">
<title>moe_56_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-5074.93 3556,-5074.93 3556,-5022.93 3774,-5022.93 3774,-5074.93"/>
<text text-anchor="middle" x="3665" y="-5062.93" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-5051.93" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-5040.93" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-5029.93" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_56_route&#45;&gt;moe_56_expert_15 -->
<g id="edge2008" class="edge">
<title>moe_56_route&#45;&gt;moe_56_expert_15</title>
<path fill="none" stroke="black" d="M2110.07,-5141.78C2487.89,-5132.41 3257.25,-5109.88 3545.76,-5074.97"/>
<polygon fill="black" stroke="black" points="3546.32,-5078.43 3555.82,-5073.73 3545.46,-5071.48 3546.32,-5078.43"/>
</g>
<!-- moe_56_aggregate -->
<g id="node1229" class="node">
<title>moe_56_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1777" cy="-4950.16" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1777" y="-4964.16" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1777" y="-4953.16" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1777" y="-4942.16" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1777" y="-4931.16" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_56_expert_0&#45;&gt;moe_56_aggregate -->
<g id="edge2009" class="edge">
<title>moe_56_expert_0&#45;&gt;moe_56_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-5024.15C237.15,-5023.71 240.09,-5023.3 243,-5022.93 488.12,-4991.44 1182.7,-4967.92 1547.21,-4957.34"/>
<polygon fill="black" stroke="black" points="1547.47,-4960.84 1557.36,-4957.05 1547.27,-4953.84 1547.47,-4960.84"/>
</g>
<!-- moe_56_expert_1&#45;&gt;moe_56_aggregate -->
<g id="edge2010" class="edge">
<title>moe_56_expert_1&#45;&gt;moe_56_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-5024.18C473.15,-5023.73 476.09,-5023.32 479,-5022.93 849.22,-4973.77 1283.16,-4958.18 1543.76,-4953.3"/>
<polygon fill="black" stroke="black" points="1544.17,-4956.79 1554.11,-4953.11 1544.05,-4949.79 1544.17,-4956.79"/>
</g>
<!-- moe_56_expert_2&#45;&gt;moe_56_aggregate -->
<g id="edge2011" class="edge">
<title>moe_56_expert_2&#45;&gt;moe_56_aggregate</title>
<path fill="none" stroke="black" d="M706.2,-5024.23C709.16,-5023.77 712.1,-5023.33 715,-5022.93 1000.02,-4983.31 1331.23,-4965.33 1546.98,-4957.33"/>
<polygon fill="black" stroke="black" points="1547.3,-4960.82 1557.17,-4956.96 1547.05,-4953.83 1547.3,-4960.82"/>
</g>
<!-- moe_56_expert_3&#45;&gt;moe_56_aggregate -->
<g id="edge2012" class="edge">
<title>moe_56_expert_3&#45;&gt;moe_56_aggregate</title>
<path fill="none" stroke="black" d="M942.21,-5024.3C945.16,-5023.82 948.1,-5023.36 951,-5022.93 1154.78,-4992.61 1388.89,-4973.76 1555.72,-4963.03"/>
<polygon fill="black" stroke="black" points="1556.35,-4966.5 1566.11,-4962.37 1555.91,-4959.51 1556.35,-4966.5"/>
</g>
<!-- moe_56_expert_4&#45;&gt;moe_56_aggregate -->
<g id="edge2013" class="edge">
<title>moe_56_expert_4&#45;&gt;moe_56_aggregate</title>
<path fill="none" stroke="black" d="M1178.23,-5024.44C1181.18,-5023.91 1184.11,-5023.41 1187,-5022.93 1316.69,-5001.35 1463.43,-4983.47 1578.13,-4970.96"/>
<polygon fill="black" stroke="black" points="1578.51,-4974.44 1588.07,-4969.88 1577.75,-4967.48 1578.51,-4974.44"/>
</g>
<!-- moe_56_expert_5&#45;&gt;moe_56_aggregate -->
<g id="edge2014" class="edge">
<title>moe_56_expert_5&#45;&gt;moe_56_aggregate</title>
<path fill="none" stroke="black" d="M1414.28,-5024.74C1417.22,-5024.13 1420.13,-5023.53 1423,-5022.93 1490.32,-5008.98 1564.9,-4993.81 1628.19,-4981.03"/>
<polygon fill="black" stroke="black" points="1629.13,-4984.41 1638.24,-4979 1627.75,-4977.55 1629.13,-4984.41"/>
</g>
<!-- moe_56_expert_6&#45;&gt;moe_56_aggregate -->
<g id="edge2015" class="edge">
<title>moe_56_expert_6&#45;&gt;moe_56_aggregate</title>
<path fill="none" stroke="black" d="M1602.08,-5022.88C1627.73,-5012.37 1658.09,-4999.92 1686.26,-4988.37"/>
<polygon fill="black" stroke="black" points="1687.79,-4991.52 1695.72,-4984.49 1685.14,-4985.05 1687.79,-4991.52"/>
</g>
<!-- moe_56_expert_7&#45;&gt;moe_56_aggregate -->
<g id="edge2016" class="edge">
<title>moe_56_expert_7&#45;&gt;moe_56_aggregate</title>
<path fill="none" stroke="black" d="M1777,-5022.76C1777,-5014.95 1777,-5006.08 1777,-4997.32"/>
<polygon fill="black" stroke="black" points="1780.5,-4997.14 1777,-4987.14 1773.5,-4997.14 1780.5,-4997.14"/>
</g>
<!-- moe_56_expert_8&#45;&gt;moe_56_aggregate -->
<g id="edge2017" class="edge">
<title>moe_56_expert_8&#45;&gt;moe_56_aggregate</title>
<path fill="none" stroke="black" d="M1951.92,-5022.88C1926.27,-5012.37 1895.91,-4999.92 1867.74,-4988.37"/>
<polygon fill="black" stroke="black" points="1868.86,-4985.05 1858.28,-4984.49 1866.21,-4991.52 1868.86,-4985.05"/>
</g>
<!-- moe_56_expert_9&#45;&gt;moe_56_aggregate -->
<g id="edge2018" class="edge">
<title>moe_56_expert_9&#45;&gt;moe_56_aggregate</title>
<path fill="none" stroke="black" d="M2139.72,-5024.74C2136.78,-5024.13 2133.87,-5023.53 2131,-5022.93 2063.68,-5008.98 1989.1,-4993.81 1925.81,-4981.03"/>
<polygon fill="black" stroke="black" points="1926.25,-4977.55 1915.76,-4979 1924.87,-4984.41 1926.25,-4977.55"/>
</g>
<!-- moe_56_expert_10&#45;&gt;moe_56_aggregate -->
<g id="edge2019" class="edge">
<title>moe_56_expert_10&#45;&gt;moe_56_aggregate</title>
<path fill="none" stroke="black" d="M2375.77,-5024.44C2372.82,-5023.91 2369.89,-5023.41 2367,-5022.93 2237.31,-5001.35 2090.57,-4983.47 1975.87,-4970.96"/>
<polygon fill="black" stroke="black" points="1976.25,-4967.48 1965.93,-4969.88 1975.49,-4974.44 1976.25,-4967.48"/>
</g>
<!-- moe_56_expert_11&#45;&gt;moe_56_aggregate -->
<g id="edge2020" class="edge">
<title>moe_56_expert_11&#45;&gt;moe_56_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-5024.3C2608.84,-5023.82 2605.9,-5023.36 2603,-5022.93 2399.22,-4992.61 2165.11,-4973.76 1998.28,-4963.03"/>
<polygon fill="black" stroke="black" points="1998.09,-4959.51 1987.89,-4962.37 1997.65,-4966.5 1998.09,-4959.51"/>
</g>
<!-- moe_56_expert_12&#45;&gt;moe_56_aggregate -->
<g id="edge2021" class="edge">
<title>moe_56_expert_12&#45;&gt;moe_56_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-5024.23C2844.84,-5023.77 2841.9,-5023.33 2839,-5022.93 2553.98,-4983.31 2222.77,-4965.33 2007.02,-4957.33"/>
<polygon fill="black" stroke="black" points="2006.95,-4953.83 1996.83,-4956.96 2006.7,-4960.82 2006.95,-4953.83"/>
</g>
<!-- moe_56_expert_13&#45;&gt;moe_56_aggregate -->
<g id="edge2022" class="edge">
<title>moe_56_expert_13&#45;&gt;moe_56_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-5024.18C3080.85,-5023.73 3077.91,-5023.32 3075,-5022.93 2704.78,-4973.77 2270.84,-4958.18 2010.24,-4953.3"/>
<polygon fill="black" stroke="black" points="2009.95,-4949.79 1999.89,-4953.11 2009.83,-4956.79 2009.95,-4949.79"/>
</g>
<!-- moe_56_expert_14&#45;&gt;moe_56_aggregate -->
<g id="edge2023" class="edge">
<title>moe_56_expert_14&#45;&gt;moe_56_aggregate</title>
<path fill="none" stroke="black" d="M3319.82,-5024.15C3316.85,-5023.71 3313.91,-5023.3 3311,-5022.93 3065.88,-4991.44 2371.3,-4967.92 2006.79,-4957.34"/>
<polygon fill="black" stroke="black" points="2006.73,-4953.84 1996.64,-4957.05 2006.53,-4960.84 2006.73,-4953.84"/>
</g>
<!-- moe_56_expert_15&#45;&gt;moe_56_aggregate -->
<g id="edge2024" class="edge">
<title>moe_56_expert_15&#45;&gt;moe_56_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-5024.12C3552.85,-5023.69 3549.91,-5023.29 3547,-5022.93 3256.39,-4986.52 2418.41,-4964.56 2008.44,-4955.7"/>
<polygon fill="black" stroke="black" points="2008.31,-4952.2 1998.24,-4955.48 2008.16,-4959.2 2008.31,-4952.2"/>
</g>
<!-- moe_56_ffn -->
<g id="node1230" class="node">
<title>moe_56_ffn</title>
<polygon fill="lightgreen" stroke="black" points="1935,-4877.39 1619,-4877.39 1619,-4825.39 1935,-4825.39 1935,-4877.39"/>
<text text-anchor="middle" x="1777" y="-4865.39" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1777" y="-4854.39" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-4843.39" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-4832.39" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_56_aggregate&#45;&gt;moe_56_ffn -->
<g id="edge2025" class="edge">
<title>moe_56_aggregate&#45;&gt;moe_56_ffn</title>
<path fill="none" stroke="black" d="M1777,-4913.13C1777,-4904.81 1777,-4895.98 1777,-4887.7"/>
<polygon fill="black" stroke="black" points="1780.5,-4887.59 1777,-4877.59 1773.5,-4887.59 1780.5,-4887.59"/>
</g>
<!-- moe_56_res2 -->
<g id="node1232" class="node">
<title>moe_56_res2</title>
<polygon fill="lightyellow" stroke="black" points="2113.89,-4789.39 1577.97,-4789.39 1440.11,-4685.39 1976.03,-4685.39 2113.89,-4789.39"/>
<text text-anchor="middle" x="1777" y="-4751.39" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1777" y="-4740.39" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-4729.39" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1777" y="-4718.39" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_56_ffn&#45;&gt;moe_56_res2 -->
<g id="edge2026" class="edge">
<title>moe_56_ffn&#45;&gt;moe_56_res2</title>
<path fill="none" stroke="black" d="M1777,-4825.26C1777,-4817.57 1777,-4808.76 1777,-4799.76"/>
<polygon fill="black" stroke="black" points="1780.5,-4799.57 1777,-4789.57 1773.5,-4799.57 1780.5,-4799.57"/>
</g>
<!-- moe_56_res1&#45;&gt;moe_56_gate -->
<g id="edge1991" class="edge">
<title>moe_56_res1&#45;&gt;moe_56_gate</title>
<path fill="none" stroke="black" d="M1895,-5360.08C1895,-5351.91 1895,-5343.39 1895,-5335.01"/>
<polygon fill="black" stroke="black" points="1898.5,-5334.9 1895,-5324.9 1891.5,-5334.9 1898.5,-5334.9"/>
</g>
<!-- moe_57_mha -->
<g id="node1233" class="node">
<title>moe_57_mha</title>
<polygon fill="lightgreen" stroke="black" points="1935,-4638.39 1619,-4638.39 1619,-4586.39 1935,-4586.39 1935,-4638.39"/>
<text text-anchor="middle" x="1777" y="-4626.39" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1777" y="-4615.39" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-4604.39" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-4593.39" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_56_res2&#45;&gt;moe_57_mha -->
<g id="edge2027" class="edge">
<title>moe_56_res2&#45;&gt;moe_57_mha</title>
<path fill="none" stroke="black" d="M1777,-4685.3C1777,-4672.97 1777,-4660.06 1777,-4648.64"/>
<polygon fill="black" stroke="black" points="1780.5,-4648.63 1777,-4638.63 1773.5,-4648.63 1780.5,-4648.63"/>
</g>
<!-- moe_57_res1 -->
<g id="node1254" class="node">
<title>moe_57_res1</title>
<polygon fill="lightyellow" stroke="black" points="2113.89,-4550.39 1577.97,-4550.39 1440.11,-4446.39 1976.03,-4446.39 2113.89,-4550.39"/>
<text text-anchor="middle" x="1777" y="-4512.39" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1777" y="-4501.39" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-4490.39" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1777" y="-4479.39" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_57_mha&#45;&gt;moe_57_res1 -->
<g id="edge2028" class="edge">
<title>moe_57_mha&#45;&gt;moe_57_res1</title>
<path fill="none" stroke="black" d="M1777,-4586.26C1777,-4578.57 1777,-4569.76 1777,-4560.76"/>
<polygon fill="black" stroke="black" points="1780.5,-4560.57 1777,-4550.57 1773.5,-4560.57 1780.5,-4560.57"/>
</g>
<!-- moe_57_gate -->
<g id="node1234" class="node">
<title>moe_57_gate</title>
<polygon fill="lightyellow" stroke="black" points="2105.8,-4410.39 1582.75,-4410.39 1448.2,-4306.39 1971.25,-4306.39 2105.8,-4410.39"/>
<text text-anchor="middle" x="1777" y="-4372.39" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1777" y="-4361.39" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-4350.39" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-4339.39" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_57_route -->
<g id="node1235" class="node">
<title>moe_57_route</title>
<ellipse fill="lightblue" stroke="black" cx="1777" cy="-4233.62" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1777" y="-4247.62" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1777" y="-4236.62" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1777" y="-4225.62" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-4214.62" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_57_gate&#45;&gt;moe_57_route -->
<g id="edge2030" class="edge">
<title>moe_57_gate&#45;&gt;moe_57_route</title>
<path fill="none" stroke="black" d="M1777,-4306.04C1777,-4297.63 1777,-4288.96 1777,-4280.69"/>
<polygon fill="black" stroke="black" points="1780.5,-4280.48 1777,-4270.48 1773.5,-4280.48 1780.5,-4280.48"/>
</g>
<!-- moe_57_expert_0 -->
<g id="node1236" class="node">
<title>moe_57_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-4160.85 16,-4160.85 16,-4108.85 234,-4108.85 234,-4160.85"/>
<text text-anchor="middle" x="125" y="-4148.85" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-4137.85" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-4126.85" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-4115.85" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_57_route&#45;&gt;moe_57_expert_0 -->
<g id="edge2031" class="edge">
<title>moe_57_route&#45;&gt;moe_57_expert_0</title>
<path fill="none" stroke="black" d="M1562.77,-4226.89C1207.39,-4216.67 509.65,-4193.4 244.21,-4160.89"/>
<polygon fill="black" stroke="black" points="244.54,-4157.41 234.18,-4159.63 243.67,-4164.35 244.54,-4157.41"/>
</g>
<!-- moe_57_expert_1 -->
<g id="node1237" class="node">
<title>moe_57_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-4160.85 252,-4160.85 252,-4108.85 470,-4108.85 470,-4160.85"/>
<text text-anchor="middle" x="361" y="-4148.85" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-4137.85" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-4126.85" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-4115.85" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_57_route&#45;&gt;moe_57_expert_1 -->
<g id="edge2032" class="edge">
<title>moe_57_route&#45;&gt;moe_57_expert_1</title>
<path fill="none" stroke="black" d="M1559.59,-4230.77C1303.22,-4226.27 864.4,-4211.28 480.11,-4160.91"/>
<polygon fill="black" stroke="black" points="480.56,-4157.44 470.19,-4159.6 479.64,-4164.38 480.56,-4157.44"/>
</g>
<!-- moe_57_expert_2 -->
<g id="node1238" class="node">
<title>moe_57_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-4160.85 488,-4160.85 488,-4108.85 706,-4108.85 706,-4160.85"/>
<text text-anchor="middle" x="597" y="-4148.85" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-4137.85" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-4126.85" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-4115.85" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_57_route&#45;&gt;moe_57_expert_2 -->
<g id="edge2033" class="edge">
<title>moe_57_route&#45;&gt;moe_57_expert_2</title>
<path fill="none" stroke="black" d="M1562.51,-4227.02C1349.77,-4219.39 1014.57,-4201.84 716.34,-4160.96"/>
<polygon fill="black" stroke="black" points="716.58,-4157.46 706.2,-4159.55 715.62,-4164.39 716.58,-4157.46"/>
</g>
<!-- moe_57_expert_3 -->
<g id="node1239" class="node">
<title>moe_57_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-4160.85 724,-4160.85 724,-4108.85 942,-4108.85 942,-4160.85"/>
<text text-anchor="middle" x="833" y="-4148.85" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-4137.85" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-4126.85" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-4115.85" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_57_route&#45;&gt;moe_57_expert_3 -->
<g id="edge2034" class="edge">
<title>moe_57_route&#45;&gt;moe_57_expert_3</title>
<path fill="none" stroke="black" d="M1570.82,-4221.71C1405.76,-4211.33 1168.32,-4192.68 952.16,-4160.95"/>
<polygon fill="black" stroke="black" points="952.61,-4157.48 942.21,-4159.48 951.59,-4164.4 952.61,-4157.48"/>
</g>
<!-- moe_57_expert_4 -->
<g id="node1240" class="node">
<title>moe_57_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-4160.85 960,-4160.85 960,-4108.85 1178,-4108.85 1178,-4160.85"/>
<text text-anchor="middle" x="1069" y="-4148.85" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-4137.85" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-4126.85" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-4115.85" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_57_route&#45;&gt;moe_57_expert_4 -->
<g id="edge2035" class="edge">
<title>moe_57_route&#45;&gt;moe_57_expert_4</title>
<path fill="none" stroke="black" d="M1591.38,-4214.26C1477.62,-4201.99 1328.9,-4184.14 1188.33,-4161.02"/>
<polygon fill="black" stroke="black" points="1188.66,-4157.53 1178.23,-4159.35 1187.52,-4164.43 1188.66,-4157.53"/>
</g>
<!-- moe_57_expert_5 -->
<g id="node1241" class="node">
<title>moe_57_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-4160.85 1196,-4160.85 1196,-4108.85 1414,-4108.85 1414,-4160.85"/>
<text text-anchor="middle" x="1305" y="-4148.85" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-4137.85" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-4126.85" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-4115.85" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_57_route&#45;&gt;moe_57_expert_5 -->
<g id="edge2036" class="edge">
<title>moe_57_route&#45;&gt;moe_57_expert_5</title>
<path fill="none" stroke="black" d="M1639.51,-4205.04C1576.62,-4192.35 1500.88,-4176.97 1424.14,-4161.08"/>
<polygon fill="black" stroke="black" points="1424.79,-4157.64 1414.28,-4159.04 1423.37,-4164.5 1424.79,-4157.64"/>
</g>
<!-- moe_57_expert_6 -->
<g id="node1242" class="node">
<title>moe_57_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-4160.85 1432,-4160.85 1432,-4108.85 1650,-4108.85 1650,-4160.85"/>
<text text-anchor="middle" x="1541" y="-4148.85" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-4137.85" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-4126.85" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-4115.85" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_57_route&#45;&gt;moe_57_expert_6 -->
<g id="edge2037" class="edge">
<title>moe_57_route&#45;&gt;moe_57_expert_6</title>
<path fill="none" stroke="black" d="M1696.11,-4199.45C1668.54,-4188.15 1637.96,-4175.61 1611.29,-4164.67"/>
<polygon fill="black" stroke="black" points="1612.61,-4161.43 1602.03,-4160.88 1609.95,-4167.91 1612.61,-4161.43"/>
</g>
<!-- moe_57_expert_7 -->
<g id="node1243" class="node">
<title>moe_57_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-4160.85 1668,-4160.85 1668,-4108.85 1886,-4108.85 1886,-4160.85"/>
<text text-anchor="middle" x="1777" y="-4148.85" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-4137.85" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-4126.85" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-4115.85" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_57_route&#45;&gt;moe_57_expert_7 -->
<g id="edge2038" class="edge">
<title>moe_57_route&#45;&gt;moe_57_expert_7</title>
<path fill="none" stroke="black" d="M1777,-4196.59C1777,-4188.28 1777,-4179.44 1777,-4171.16"/>
<polygon fill="black" stroke="black" points="1780.5,-4171.05 1777,-4161.05 1773.5,-4171.05 1780.5,-4171.05"/>
</g>
<!-- moe_57_expert_8 -->
<g id="node1244" class="node">
<title>moe_57_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-4160.85 1904,-4160.85 1904,-4108.85 2122,-4108.85 2122,-4160.85"/>
<text text-anchor="middle" x="2013" y="-4148.85" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-4137.85" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-4126.85" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-4115.85" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_57_route&#45;&gt;moe_57_expert_8 -->
<g id="edge2039" class="edge">
<title>moe_57_route&#45;&gt;moe_57_expert_8</title>
<path fill="none" stroke="black" d="M1857.89,-4199.45C1885.46,-4188.15 1916.04,-4175.61 1942.71,-4164.67"/>
<polygon fill="black" stroke="black" points="1944.05,-4167.91 1951.97,-4160.88 1941.39,-4161.43 1944.05,-4167.91"/>
</g>
<!-- moe_57_expert_9 -->
<g id="node1245" class="node">
<title>moe_57_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-4160.85 2140,-4160.85 2140,-4108.85 2358,-4108.85 2358,-4160.85"/>
<text text-anchor="middle" x="2249" y="-4148.85" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-4137.85" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-4126.85" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-4115.85" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_57_route&#45;&gt;moe_57_expert_9 -->
<g id="edge2040" class="edge">
<title>moe_57_route&#45;&gt;moe_57_expert_9</title>
<path fill="none" stroke="black" d="M1914.49,-4205.04C1977.38,-4192.35 2053.12,-4176.97 2129.86,-4161.08"/>
<polygon fill="black" stroke="black" points="2130.63,-4164.5 2139.72,-4159.04 2129.21,-4157.64 2130.63,-4164.5"/>
</g>
<!-- moe_57_expert_10 -->
<g id="node1246" class="node">
<title>moe_57_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-4160.85 2376,-4160.85 2376,-4108.85 2594,-4108.85 2594,-4160.85"/>
<text text-anchor="middle" x="2485" y="-4148.85" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-4137.85" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-4126.85" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-4115.85" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_57_route&#45;&gt;moe_57_expert_10 -->
<g id="edge2041" class="edge">
<title>moe_57_route&#45;&gt;moe_57_expert_10</title>
<path fill="none" stroke="black" d="M1962.62,-4214.26C2076.38,-4201.99 2225.1,-4184.14 2365.67,-4161.02"/>
<polygon fill="black" stroke="black" points="2366.48,-4164.43 2375.77,-4159.35 2365.34,-4157.53 2366.48,-4164.43"/>
</g>
<!-- moe_57_expert_11 -->
<g id="node1247" class="node">
<title>moe_57_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-4160.85 2612,-4160.85 2612,-4108.85 2830,-4108.85 2830,-4160.85"/>
<text text-anchor="middle" x="2721" y="-4148.85" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-4137.85" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-4126.85" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-4115.85" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_57_route&#45;&gt;moe_57_expert_11 -->
<g id="edge2042" class="edge">
<title>moe_57_route&#45;&gt;moe_57_expert_11</title>
<path fill="none" stroke="black" d="M1983.18,-4221.71C2148.24,-4211.33 2385.68,-4192.68 2601.84,-4160.95"/>
<polygon fill="black" stroke="black" points="2602.41,-4164.4 2611.79,-4159.48 2601.39,-4157.48 2602.41,-4164.4"/>
</g>
<!-- moe_57_expert_12 -->
<g id="node1248" class="node">
<title>moe_57_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-4160.85 2848,-4160.85 2848,-4108.85 3066,-4108.85 3066,-4160.85"/>
<text text-anchor="middle" x="2957" y="-4148.85" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-4137.85" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-4126.85" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-4115.85" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_57_route&#45;&gt;moe_57_expert_12 -->
<g id="edge2043" class="edge">
<title>moe_57_route&#45;&gt;moe_57_expert_12</title>
<path fill="none" stroke="black" d="M1991.49,-4227.02C2204.23,-4219.39 2539.43,-4201.84 2837.66,-4160.96"/>
<polygon fill="black" stroke="black" points="2838.38,-4164.39 2847.8,-4159.55 2837.42,-4157.46 2838.38,-4164.39"/>
</g>
<!-- moe_57_expert_13 -->
<g id="node1249" class="node">
<title>moe_57_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-4160.85 3084,-4160.85 3084,-4108.85 3302,-4108.85 3302,-4160.85"/>
<text text-anchor="middle" x="3193" y="-4148.85" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-4137.85" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-4126.85" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-4115.85" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_57_route&#45;&gt;moe_57_expert_13 -->
<g id="edge2044" class="edge">
<title>moe_57_route&#45;&gt;moe_57_expert_13</title>
<path fill="none" stroke="black" d="M1994.41,-4230.77C2250.78,-4226.27 2689.6,-4211.28 3073.89,-4160.91"/>
<polygon fill="black" stroke="black" points="3074.36,-4164.38 3083.81,-4159.6 3073.44,-4157.44 3074.36,-4164.38"/>
</g>
<!-- moe_57_expert_14 -->
<g id="node1250" class="node">
<title>moe_57_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-4160.85 3320,-4160.85 3320,-4108.85 3538,-4108.85 3538,-4160.85"/>
<text text-anchor="middle" x="3429" y="-4148.85" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-4137.85" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-4126.85" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-4115.85" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_57_route&#45;&gt;moe_57_expert_14 -->
<g id="edge2045" class="edge">
<title>moe_57_route&#45;&gt;moe_57_expert_14</title>
<path fill="none" stroke="black" d="M1991.23,-4226.89C2346.61,-4216.67 3044.35,-4193.4 3309.79,-4160.89"/>
<polygon fill="black" stroke="black" points="3310.33,-4164.35 3319.82,-4159.63 3309.46,-4157.41 3310.33,-4164.35"/>
</g>
<!-- moe_57_expert_15 -->
<g id="node1251" class="node">
<title>moe_57_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-4160.85 3556,-4160.85 3556,-4108.85 3774,-4108.85 3774,-4160.85"/>
<text text-anchor="middle" x="3665" y="-4148.85" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-4137.85" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-4126.85" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-4115.85" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_57_route&#45;&gt;moe_57_expert_15 -->
<g id="edge2046" class="edge">
<title>moe_57_route&#45;&gt;moe_57_expert_15</title>
<path fill="none" stroke="black" d="M1992.71,-4228.42C2392.25,-4219.88 3234.28,-4198.21 3545.86,-4160.88"/>
<polygon fill="black" stroke="black" points="3546.32,-4164.35 3555.82,-4159.66 3545.47,-4157.4 3546.32,-4164.35"/>
</g>
<!-- moe_57_aggregate -->
<g id="node1252" class="node">
<title>moe_57_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-4036.08" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-4050.08" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1895" y="-4039.08" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-4028.08" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1895" y="-4017.08" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_57_expert_0&#45;&gt;moe_57_aggregate -->
<g id="edge2047" class="edge">
<title>moe_57_expert_0&#45;&gt;moe_57_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-4110.06C237.15,-4109.62 240.09,-4109.22 243,-4108.85 510.74,-4074.91 1276.32,-4052.11 1664.04,-4042.4"/>
<polygon fill="black" stroke="black" points="1664.35,-4045.89 1674.26,-4042.14 1664.17,-4038.89 1664.35,-4045.89"/>
</g>
<!-- moe_57_expert_1&#45;&gt;moe_57_aggregate -->
<g id="edge2048" class="edge">
<title>moe_57_expert_1&#45;&gt;moe_57_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-4110.08C473.15,-4109.64 476.09,-4109.23 479,-4108.85 892.79,-4054.88 1379.51,-4040.91 1661.11,-4037.64"/>
<polygon fill="black" stroke="black" points="1661.49,-4041.14 1671.45,-4037.52 1661.41,-4034.14 1661.49,-4041.14"/>
</g>
<!-- moe_57_expert_2&#45;&gt;moe_57_aggregate -->
<g id="edge2049" class="edge">
<title>moe_57_expert_2&#45;&gt;moe_57_aggregate</title>
<path fill="none" stroke="black" d="M706.19,-4110.12C709.15,-4109.67 712.09,-4109.25 715,-4108.85 1042.31,-4064.47 1424.45,-4047.53 1663.11,-4041.06"/>
<polygon fill="black" stroke="black" points="1663.4,-4044.56 1673.31,-4040.79 1663.22,-4037.56 1663.4,-4044.56"/>
</g>
<!-- moe_57_expert_3&#45;&gt;moe_57_aggregate -->
<g id="edge2050" class="edge">
<title>moe_57_expert_3&#45;&gt;moe_57_aggregate</title>
<path fill="none" stroke="black" d="M942.2,-4110.18C945.16,-4109.71 948.1,-4109.27 951,-4108.85 1194.76,-4073.92 1476.52,-4055.3 1668.32,-4045.85"/>
<polygon fill="black" stroke="black" points="1668.71,-4049.34 1678.53,-4045.36 1668.37,-4042.35 1668.71,-4049.34"/>
</g>
<!-- moe_57_expert_4&#45;&gt;moe_57_aggregate -->
<g id="edge2051" class="edge">
<title>moe_57_expert_4&#45;&gt;moe_57_aggregate</title>
<path fill="none" stroke="black" d="M1178.21,-4110.28C1181.17,-4109.78 1184.1,-4109.3 1187,-4108.85 1352.7,-4082.98 1541.73,-4064.36 1682.77,-4052.59"/>
<polygon fill="black" stroke="black" points="1683.17,-4056.07 1692.84,-4051.75 1682.59,-4049.09 1683.17,-4056.07"/>
</g>
<!-- moe_57_expert_5&#45;&gt;moe_57_aggregate -->
<g id="edge2052" class="edge">
<title>moe_57_expert_5&#45;&gt;moe_57_aggregate</title>
<path fill="none" stroke="black" d="M1414.25,-4110.47C1417.19,-4109.92 1420.12,-4109.38 1423,-4108.85 1519.58,-4091.29 1627.83,-4074.62 1716.27,-4061.77"/>
<polygon fill="black" stroke="black" points="1717.01,-4065.2 1726.4,-4060.3 1716,-4058.27 1717.01,-4065.2"/>
</g>
<!-- moe_57_expert_6&#45;&gt;moe_57_aggregate -->
<g id="edge2053" class="edge">
<title>moe_57_expert_6&#45;&gt;moe_57_aggregate</title>
<path fill="none" stroke="black" d="M1632.62,-4108.81C1675.27,-4097.15 1726.62,-4083.11 1772.54,-4070.56"/>
<polygon fill="black" stroke="black" points="1773.53,-4073.92 1782.25,-4067.9 1771.68,-4067.16 1773.53,-4073.92"/>
</g>
<!-- moe_57_expert_7&#45;&gt;moe_57_aggregate -->
<g id="edge2054" class="edge">
<title>moe_57_expert_7&#45;&gt;moe_57_aggregate</title>
<path fill="none" stroke="black" d="M1807.7,-4108.68C1818.79,-4099.58 1831.63,-4089.05 1843.99,-4078.91"/>
<polygon fill="black" stroke="black" points="1846.51,-4081.38 1852.02,-4072.33 1842.07,-4075.96 1846.51,-4081.38"/>
</g>
<!-- moe_57_expert_8&#45;&gt;moe_57_aggregate -->
<g id="edge2055" class="edge">
<title>moe_57_expert_8&#45;&gt;moe_57_aggregate</title>
<path fill="none" stroke="black" d="M1982.3,-4108.68C1971.21,-4099.58 1958.37,-4089.05 1946.01,-4078.91"/>
<polygon fill="black" stroke="black" points="1947.93,-4075.96 1937.98,-4072.33 1943.49,-4081.38 1947.93,-4075.96"/>
</g>
<!-- moe_57_expert_9&#45;&gt;moe_57_aggregate -->
<g id="edge2056" class="edge">
<title>moe_57_expert_9&#45;&gt;moe_57_aggregate</title>
<path fill="none" stroke="black" d="M2157.38,-4108.81C2114.73,-4097.15 2063.38,-4083.11 2017.46,-4070.56"/>
<polygon fill="black" stroke="black" points="2018.32,-4067.16 2007.75,-4067.9 2016.47,-4073.92 2018.32,-4067.16"/>
</g>
<!-- moe_57_expert_10&#45;&gt;moe_57_aggregate -->
<g id="edge2057" class="edge">
<title>moe_57_expert_10&#45;&gt;moe_57_aggregate</title>
<path fill="none" stroke="black" d="M2375.75,-4110.47C2372.81,-4109.92 2369.88,-4109.38 2367,-4108.85 2270.42,-4091.29 2162.17,-4074.62 2073.73,-4061.77"/>
<polygon fill="black" stroke="black" points="2074,-4058.27 2063.6,-4060.3 2072.99,-4065.2 2074,-4058.27"/>
</g>
<!-- moe_57_expert_11&#45;&gt;moe_57_aggregate -->
<g id="edge2058" class="edge">
<title>moe_57_expert_11&#45;&gt;moe_57_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-4110.28C2608.83,-4109.78 2605.9,-4109.3 2603,-4108.85 2437.3,-4082.98 2248.27,-4064.36 2107.23,-4052.59"/>
<polygon fill="black" stroke="black" points="2107.41,-4049.09 2097.16,-4051.75 2106.83,-4056.07 2107.41,-4049.09"/>
</g>
<!-- moe_57_expert_12&#45;&gt;moe_57_aggregate -->
<g id="edge2059" class="edge">
<title>moe_57_expert_12&#45;&gt;moe_57_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-4110.18C2844.84,-4109.71 2841.9,-4109.27 2839,-4108.85 2595.24,-4073.92 2313.48,-4055.3 2121.68,-4045.85"/>
<polygon fill="black" stroke="black" points="2121.63,-4042.35 2111.47,-4045.36 2121.29,-4049.34 2121.63,-4042.35"/>
</g>
<!-- moe_57_expert_13&#45;&gt;moe_57_aggregate -->
<g id="edge2060" class="edge">
<title>moe_57_expert_13&#45;&gt;moe_57_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-4110.12C3080.85,-4109.67 3077.91,-4109.25 3075,-4108.85 2747.69,-4064.47 2365.55,-4047.53 2126.89,-4041.06"/>
<polygon fill="black" stroke="black" points="2126.78,-4037.56 2116.69,-4040.79 2126.6,-4044.56 2126.78,-4037.56"/>
</g>
<!-- moe_57_expert_14&#45;&gt;moe_57_aggregate -->
<g id="edge2061" class="edge">
<title>moe_57_expert_14&#45;&gt;moe_57_aggregate</title>
<path fill="none" stroke="black" d="M3319.81,-4110.08C3316.85,-4109.64 3313.91,-4109.23 3311,-4108.85 2897.21,-4054.88 2410.49,-4040.91 2128.89,-4037.64"/>
<polygon fill="black" stroke="black" points="2128.59,-4034.14 2118.55,-4037.52 2128.51,-4041.14 2128.59,-4034.14"/>
</g>
<!-- moe_57_expert_15&#45;&gt;moe_57_aggregate -->
<g id="edge2062" class="edge">
<title>moe_57_expert_15&#45;&gt;moe_57_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-4110.06C3552.85,-4109.62 3549.91,-4109.22 3547,-4108.85 3279.26,-4074.91 2513.68,-4052.11 2125.96,-4042.4"/>
<polygon fill="black" stroke="black" points="2125.83,-4038.89 2115.74,-4042.14 2125.65,-4045.89 2125.83,-4038.89"/>
</g>
<!-- moe_57_ffn -->
<g id="node1253" class="node">
<title>moe_57_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2053,-3963.31 1737,-3963.31 1737,-3911.31 2053,-3911.31 2053,-3963.31"/>
<text text-anchor="middle" x="1895" y="-3951.31" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1895" y="-3940.31" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-3929.31" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-3918.31" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_57_aggregate&#45;&gt;moe_57_ffn -->
<g id="edge2063" class="edge">
<title>moe_57_aggregate&#45;&gt;moe_57_ffn</title>
<path fill="none" stroke="black" d="M1895,-3999.05C1895,-3990.74 1895,-3981.9 1895,-3973.62"/>
<polygon fill="black" stroke="black" points="1898.5,-3973.51 1895,-3963.51 1891.5,-3973.51 1898.5,-3973.51"/>
</g>
<!-- moe_57_res2 -->
<g id="node1255" class="node">
<title>moe_57_res2</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-3875.31 1695.97,-3875.31 1558.11,-3771.31 2094.03,-3771.31 2231.89,-3875.31"/>
<text text-anchor="middle" x="1895" y="-3837.31" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1895" y="-3826.31" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-3815.31" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-3804.31" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_57_ffn&#45;&gt;moe_57_res2 -->
<g id="edge2064" class="edge">
<title>moe_57_ffn&#45;&gt;moe_57_res2</title>
<path fill="none" stroke="black" d="M1895,-3911.18C1895,-3903.49 1895,-3894.68 1895,-3885.68"/>
<polygon fill="black" stroke="black" points="1898.5,-3885.49 1895,-3875.49 1891.5,-3885.49 1898.5,-3885.49"/>
</g>
<!-- moe_57_res1&#45;&gt;moe_57_gate -->
<g id="edge2029" class="edge">
<title>moe_57_res1&#45;&gt;moe_57_gate</title>
<path fill="none" stroke="black" d="M1777,-4446C1777,-4437.83 1777,-4429.31 1777,-4420.93"/>
<polygon fill="black" stroke="black" points="1780.5,-4420.82 1777,-4410.82 1773.5,-4420.82 1780.5,-4420.82"/>
</g>
<!-- moe_58_mha -->
<g id="node1256" class="node">
<title>moe_58_mha</title>
<polygon fill="lightgreen" stroke="black" points="2053,-3724.31 1737,-3724.31 1737,-3672.31 2053,-3672.31 2053,-3724.31"/>
<text text-anchor="middle" x="1895" y="-3712.31" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1895" y="-3701.31" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-3690.31" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-3679.31" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_57_res2&#45;&gt;moe_58_mha -->
<g id="edge2065" class="edge">
<title>moe_57_res2&#45;&gt;moe_58_mha</title>
<path fill="none" stroke="black" d="M1895,-3771.22C1895,-3758.89 1895,-3745.98 1895,-3734.56"/>
<polygon fill="black" stroke="black" points="1898.5,-3734.55 1895,-3724.55 1891.5,-3734.55 1898.5,-3734.55"/>
</g>
<!-- moe_58_res1 -->
<g id="node1277" class="node">
<title>moe_58_res1</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-3636.31 1695.97,-3636.31 1558.11,-3532.31 2094.03,-3532.31 2231.89,-3636.31"/>
<text text-anchor="middle" x="1895" y="-3598.31" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1895" y="-3587.31" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-3576.31" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-3565.31" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_58_mha&#45;&gt;moe_58_res1 -->
<g id="edge2066" class="edge">
<title>moe_58_mha&#45;&gt;moe_58_res1</title>
<path fill="none" stroke="black" d="M1895,-3672.18C1895,-3664.49 1895,-3655.68 1895,-3646.68"/>
<polygon fill="black" stroke="black" points="1898.5,-3646.49 1895,-3636.49 1891.5,-3646.49 1898.5,-3646.49"/>
</g>
<!-- moe_58_gate -->
<g id="node1257" class="node">
<title>moe_58_gate</title>
<polygon fill="lightyellow" stroke="black" points="2223.8,-3496.31 1700.75,-3496.31 1566.2,-3392.31 2089.25,-3392.31 2223.8,-3496.31"/>
<text text-anchor="middle" x="1895" y="-3458.31" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1895" y="-3447.31" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-3436.31" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-3425.31" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_58_route -->
<g id="node1258" class="node">
<title>moe_58_route</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-3319.54" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-3333.54" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1895" y="-3322.54" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-3311.54" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-3300.54" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_58_gate&#45;&gt;moe_58_route -->
<g id="edge2068" class="edge">
<title>moe_58_gate&#45;&gt;moe_58_route</title>
<path fill="none" stroke="black" d="M1895,-3391.96C1895,-3383.55 1895,-3374.88 1895,-3366.61"/>
<polygon fill="black" stroke="black" points="1898.5,-3366.4 1895,-3356.4 1891.5,-3366.4 1898.5,-3366.4"/>
</g>
<!-- moe_58_expert_0 -->
<g id="node1259" class="node">
<title>moe_58_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-3246.77 16,-3246.77 16,-3194.77 234,-3194.77 234,-3246.77"/>
<text text-anchor="middle" x="125" y="-3234.77" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-3223.77" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-3212.77" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-3201.77" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_58_route&#45;&gt;moe_58_expert_0 -->
<g id="edge2069" class="edge">
<title>moe_58_route&#45;&gt;moe_58_expert_0</title>
<path fill="none" stroke="black" d="M1679.93,-3313.62C1302.11,-3304.25 532.75,-3281.72 244.24,-3246.82"/>
<polygon fill="black" stroke="black" points="244.54,-3243.33 234.18,-3245.57 243.68,-3250.27 244.54,-3243.33"/>
</g>
<!-- moe_58_expert_1 -->
<g id="node1260" class="node">
<title>moe_58_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-3246.77 252,-3246.77 252,-3194.77 470,-3194.77 470,-3246.77"/>
<text text-anchor="middle" x="361" y="-3234.77" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-3223.77" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-3212.77" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-3201.77" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_58_route&#45;&gt;moe_58_expert_1 -->
<g id="edge2070" class="edge">
<title>moe_58_route&#45;&gt;moe_58_expert_1</title>
<path fill="none" stroke="black" d="M1677.23,-3318.16C1400.57,-3315.26 908.56,-3302 480.29,-3246.85"/>
<polygon fill="black" stroke="black" points="480.55,-3243.36 470.19,-3245.54 479.65,-3250.3 480.55,-3243.36"/>
</g>
<!-- moe_58_expert_2 -->
<g id="node1261" class="node">
<title>moe_58_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-3246.77 488,-3246.77 488,-3194.77 706,-3194.77 706,-3246.77"/>
<text text-anchor="middle" x="597" y="-3234.77" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-3223.77" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-3212.77" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-3201.77" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_58_route&#45;&gt;moe_58_expert_2 -->
<g id="edge2071" class="edge">
<title>moe_58_route&#45;&gt;moe_58_expert_2</title>
<path fill="none" stroke="black" d="M1678.74,-3314.98C1443.7,-3308.89 1057.2,-3292.46 716.26,-3246.86"/>
<polygon fill="black" stroke="black" points="716.57,-3243.37 706.19,-3245.5 715.63,-3250.31 716.57,-3243.37"/>
</g>
<!-- moe_58_expert_3 -->
<g id="node1262" class="node">
<title>moe_58_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-3246.77 724,-3246.77 724,-3194.77 942,-3194.77 942,-3246.77"/>
<text text-anchor="middle" x="833" y="-3234.77" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-3223.77" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-3212.77" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-3201.77" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_58_route&#45;&gt;moe_58_expert_3 -->
<g id="edge2072" class="edge">
<title>moe_58_route&#45;&gt;moe_58_expert_3</title>
<path fill="none" stroke="black" d="M1683.7,-3310.52C1494.33,-3301.45 1209,-3283.14 952.47,-3246.9"/>
<polygon fill="black" stroke="black" points="952.59,-3243.39 942.2,-3245.44 951.61,-3250.32 952.59,-3243.39"/>
</g>
<!-- moe_58_expert_4 -->
<g id="node1263" class="node">
<title>moe_58_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-3246.77 960,-3246.77 960,-3194.77 1178,-3194.77 1178,-3246.77"/>
<text text-anchor="middle" x="1069" y="-3234.77" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-3223.77" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-3212.77" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-3201.77" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_58_route&#45;&gt;moe_58_expert_4 -->
<g id="edge2073" class="edge">
<title>moe_58_route&#45;&gt;moe_58_expert_4</title>
<path fill="none" stroke="black" d="M1696.66,-3304.19C1556.96,-3292.71 1365.46,-3274.21 1188.25,-3246.9"/>
<polygon fill="black" stroke="black" points="1188.63,-3243.42 1178.21,-3245.35 1187.56,-3250.34 1188.63,-3243.42"/>
</g>
<!-- moe_58_expert_5 -->
<g id="node1264" class="node">
<title>moe_58_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-3246.77 1196,-3246.77 1196,-3194.77 1414,-3194.77 1414,-3246.77"/>
<text text-anchor="middle" x="1305" y="-3234.77" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-3223.77" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-3212.77" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-3201.77" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_58_route&#45;&gt;moe_58_expert_5 -->
<g id="edge2074" class="edge">
<title>moe_58_route&#45;&gt;moe_58_expert_5</title>
<path fill="none" stroke="black" d="M1728.87,-3295.68C1640.99,-3283 1531.11,-3266.23 1424.25,-3246.96"/>
<polygon fill="black" stroke="black" points="1424.71,-3243.49 1414.25,-3245.15 1423.46,-3250.38 1424.71,-3243.49"/>
</g>
<!-- moe_58_expert_6 -->
<g id="node1265" class="node">
<title>moe_58_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-3246.77 1432,-3246.77 1432,-3194.77 1650,-3194.77 1650,-3246.77"/>
<text text-anchor="middle" x="1541" y="-3234.77" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-3223.77" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-3212.77" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-3201.77" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_58_route&#45;&gt;moe_58_expert_6 -->
<g id="edge2075" class="edge">
<title>moe_58_route&#45;&gt;moe_58_expert_6</title>
<path fill="none" stroke="black" d="M1782.99,-3287.92C1737.98,-3275.62 1686.47,-3261.54 1642.56,-3249.54"/>
<polygon fill="black" stroke="black" points="1643.31,-3246.11 1632.74,-3246.85 1641.46,-3252.86 1643.31,-3246.11"/>
</g>
<!-- moe_58_expert_7 -->
<g id="node1266" class="node">
<title>moe_58_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-3246.77 1668,-3246.77 1668,-3194.77 1886,-3194.77 1886,-3246.77"/>
<text text-anchor="middle" x="1777" y="-3234.77" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-3223.77" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-3212.77" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-3201.77" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_58_route&#45;&gt;moe_58_expert_7 -->
<g id="edge2076" class="edge">
<title>moe_58_route&#45;&gt;moe_58_expert_7</title>
<path fill="none" stroke="black" d="M1852.07,-3283.33C1840.07,-3273.5 1827.12,-3262.88 1815.41,-3253.27"/>
<polygon fill="black" stroke="black" points="1817.47,-3250.44 1807.52,-3246.8 1813.04,-3255.85 1817.47,-3250.44"/>
</g>
<!-- moe_58_expert_8 -->
<g id="node1267" class="node">
<title>moe_58_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-3246.77 1904,-3246.77 1904,-3194.77 2122,-3194.77 2122,-3246.77"/>
<text text-anchor="middle" x="2013" y="-3234.77" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-3223.77" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-3212.77" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-3201.77" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_58_route&#45;&gt;moe_58_expert_8 -->
<g id="edge2077" class="edge">
<title>moe_58_route&#45;&gt;moe_58_expert_8</title>
<path fill="none" stroke="black" d="M1937.93,-3283.33C1949.93,-3273.5 1962.88,-3262.88 1974.59,-3253.27"/>
<polygon fill="black" stroke="black" points="1976.96,-3255.85 1982.48,-3246.8 1972.53,-3250.44 1976.96,-3255.85"/>
</g>
<!-- moe_58_expert_9 -->
<g id="node1268" class="node">
<title>moe_58_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-3246.77 2140,-3246.77 2140,-3194.77 2358,-3194.77 2358,-3246.77"/>
<text text-anchor="middle" x="2249" y="-3234.77" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-3223.77" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-3212.77" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-3201.77" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_58_route&#45;&gt;moe_58_expert_9 -->
<g id="edge2078" class="edge">
<title>moe_58_route&#45;&gt;moe_58_expert_9</title>
<path fill="none" stroke="black" d="M2007.01,-3287.92C2052.02,-3275.62 2103.53,-3261.54 2147.44,-3249.54"/>
<polygon fill="black" stroke="black" points="2148.54,-3252.86 2157.26,-3246.85 2146.69,-3246.11 2148.54,-3252.86"/>
</g>
<!-- moe_58_expert_10 -->
<g id="node1269" class="node">
<title>moe_58_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-3246.77 2376,-3246.77 2376,-3194.77 2594,-3194.77 2594,-3246.77"/>
<text text-anchor="middle" x="2485" y="-3234.77" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-3223.77" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-3212.77" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-3201.77" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_58_route&#45;&gt;moe_58_expert_10 -->
<g id="edge2079" class="edge">
<title>moe_58_route&#45;&gt;moe_58_expert_10</title>
<path fill="none" stroke="black" d="M2061.13,-3295.68C2149.01,-3283 2258.89,-3266.23 2365.75,-3246.96"/>
<polygon fill="black" stroke="black" points="2366.54,-3250.38 2375.75,-3245.15 2365.29,-3243.49 2366.54,-3250.38"/>
</g>
<!-- moe_58_expert_11 -->
<g id="node1270" class="node">
<title>moe_58_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-3246.77 2612,-3246.77 2612,-3194.77 2830,-3194.77 2830,-3246.77"/>
<text text-anchor="middle" x="2721" y="-3234.77" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-3223.77" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-3212.77" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-3201.77" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_58_route&#45;&gt;moe_58_expert_11 -->
<g id="edge2080" class="edge">
<title>moe_58_route&#45;&gt;moe_58_expert_11</title>
<path fill="none" stroke="black" d="M2093.34,-3304.19C2233.04,-3292.71 2424.54,-3274.21 2601.75,-3246.9"/>
<polygon fill="black" stroke="black" points="2602.44,-3250.34 2611.79,-3245.35 2601.37,-3243.42 2602.44,-3250.34"/>
</g>
<!-- moe_58_expert_12 -->
<g id="node1271" class="node">
<title>moe_58_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-3246.77 2848,-3246.77 2848,-3194.77 3066,-3194.77 3066,-3246.77"/>
<text text-anchor="middle" x="2957" y="-3234.77" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-3223.77" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-3212.77" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-3201.77" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_58_route&#45;&gt;moe_58_expert_12 -->
<g id="edge2081" class="edge">
<title>moe_58_route&#45;&gt;moe_58_expert_12</title>
<path fill="none" stroke="black" d="M2106.3,-3310.52C2295.67,-3301.45 2581,-3283.14 2837.53,-3246.9"/>
<polygon fill="black" stroke="black" points="2838.39,-3250.32 2847.8,-3245.44 2837.41,-3243.39 2838.39,-3250.32"/>
</g>
<!-- moe_58_expert_13 -->
<g id="node1272" class="node">
<title>moe_58_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-3246.77 3084,-3246.77 3084,-3194.77 3302,-3194.77 3302,-3246.77"/>
<text text-anchor="middle" x="3193" y="-3234.77" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-3223.77" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-3212.77" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-3201.77" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_58_route&#45;&gt;moe_58_expert_13 -->
<g id="edge2082" class="edge">
<title>moe_58_route&#45;&gt;moe_58_expert_13</title>
<path fill="none" stroke="black" d="M2111.26,-3314.98C2346.3,-3308.89 2732.8,-3292.46 3073.74,-3246.86"/>
<polygon fill="black" stroke="black" points="3074.37,-3250.31 3083.81,-3245.5 3073.43,-3243.37 3074.37,-3250.31"/>
</g>
<!-- moe_58_expert_14 -->
<g id="node1273" class="node">
<title>moe_58_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-3246.77 3320,-3246.77 3320,-3194.77 3538,-3194.77 3538,-3246.77"/>
<text text-anchor="middle" x="3429" y="-3234.77" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-3223.77" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-3212.77" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-3201.77" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_58_route&#45;&gt;moe_58_expert_14 -->
<g id="edge2083" class="edge">
<title>moe_58_route&#45;&gt;moe_58_expert_14</title>
<path fill="none" stroke="black" d="M2112.77,-3318.16C2389.43,-3315.26 2881.44,-3302 3309.71,-3246.85"/>
<polygon fill="black" stroke="black" points="3310.35,-3250.3 3319.81,-3245.54 3309.45,-3243.36 3310.35,-3250.3"/>
</g>
<!-- moe_58_expert_15 -->
<g id="node1274" class="node">
<title>moe_58_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-3246.77 3556,-3246.77 3556,-3194.77 3774,-3194.77 3774,-3246.77"/>
<text text-anchor="middle" x="3665" y="-3234.77" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-3223.77" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-3212.77" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-3201.77" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_58_route&#45;&gt;moe_58_expert_15 -->
<g id="edge2084" class="edge">
<title>moe_58_route&#45;&gt;moe_58_expert_15</title>
<path fill="none" stroke="black" d="M2110.07,-3313.62C2487.89,-3304.25 3257.25,-3281.72 3545.76,-3246.82"/>
<polygon fill="black" stroke="black" points="3546.32,-3250.27 3555.82,-3245.57 3545.46,-3243.33 3546.32,-3250.27"/>
</g>
<!-- moe_58_aggregate -->
<g id="node1275" class="node">
<title>moe_58_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-3122" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-3136" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1895" y="-3125" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-3114" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1895" y="-3103" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_58_expert_0&#45;&gt;moe_58_aggregate -->
<g id="edge2085" class="edge">
<title>moe_58_expert_0&#45;&gt;moe_58_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-3195.98C237.15,-3195.55 240.09,-3195.14 243,-3194.77 510.74,-3160.83 1276.32,-3138.03 1664.04,-3128.32"/>
<polygon fill="black" stroke="black" points="1664.35,-3131.81 1674.26,-3128.06 1664.17,-3124.81 1664.35,-3131.81"/>
</g>
<!-- moe_58_expert_1&#45;&gt;moe_58_aggregate -->
<g id="edge2086" class="edge">
<title>moe_58_expert_1&#45;&gt;moe_58_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-3196.01C473.15,-3195.57 476.09,-3195.15 479,-3194.77 892.79,-3140.8 1379.51,-3126.84 1661.11,-3123.56"/>
<polygon fill="black" stroke="black" points="1661.49,-3127.06 1671.45,-3123.45 1661.41,-3120.06 1661.49,-3127.06"/>
</g>
<!-- moe_58_expert_2&#45;&gt;moe_58_aggregate -->
<g id="edge2087" class="edge">
<title>moe_58_expert_2&#45;&gt;moe_58_aggregate</title>
<path fill="none" stroke="black" d="M706.19,-3196.05C709.15,-3195.59 712.09,-3195.17 715,-3194.77 1042.31,-3150.4 1424.45,-3133.45 1663.11,-3126.99"/>
<polygon fill="black" stroke="black" points="1663.4,-3130.48 1673.31,-3126.71 1663.22,-3123.48 1663.4,-3130.48"/>
</g>
<!-- moe_58_expert_3&#45;&gt;moe_58_aggregate -->
<g id="edge2088" class="edge">
<title>moe_58_expert_3&#45;&gt;moe_58_aggregate</title>
<path fill="none" stroke="black" d="M942.2,-3196.1C945.16,-3195.63 948.1,-3195.19 951,-3194.77 1194.76,-3159.84 1476.52,-3141.22 1668.32,-3131.78"/>
<polygon fill="black" stroke="black" points="1668.71,-3135.26 1678.53,-3131.28 1668.37,-3128.27 1668.71,-3135.26"/>
</g>
<!-- moe_58_expert_4&#45;&gt;moe_58_aggregate -->
<g id="edge2089" class="edge">
<title>moe_58_expert_4&#45;&gt;moe_58_aggregate</title>
<path fill="none" stroke="black" d="M1178.21,-3196.2C1181.17,-3195.7 1184.1,-3195.23 1187,-3194.77 1352.7,-3168.9 1541.73,-3150.29 1682.77,-3138.51"/>
<polygon fill="black" stroke="black" points="1683.17,-3141.99 1692.84,-3137.67 1682.59,-3135.01 1683.17,-3141.99"/>
</g>
<!-- moe_58_expert_5&#45;&gt;moe_58_aggregate -->
<g id="edge2090" class="edge">
<title>moe_58_expert_5&#45;&gt;moe_58_aggregate</title>
<path fill="none" stroke="black" d="M1414.25,-3196.4C1417.19,-3195.84 1420.12,-3195.3 1423,-3194.77 1519.58,-3177.21 1627.83,-3160.54 1716.27,-3147.69"/>
<polygon fill="black" stroke="black" points="1717.01,-3151.12 1726.4,-3146.22 1716,-3144.19 1717.01,-3151.12"/>
</g>
<!-- moe_58_expert_6&#45;&gt;moe_58_aggregate -->
<g id="edge2091" class="edge">
<title>moe_58_expert_6&#45;&gt;moe_58_aggregate</title>
<path fill="none" stroke="black" d="M1632.62,-3194.73C1675.27,-3183.07 1726.62,-3169.03 1772.54,-3156.48"/>
<polygon fill="black" stroke="black" points="1773.53,-3159.84 1782.25,-3153.83 1771.68,-3153.09 1773.53,-3159.84"/>
</g>
<!-- moe_58_expert_7&#45;&gt;moe_58_aggregate -->
<g id="edge2092" class="edge">
<title>moe_58_expert_7&#45;&gt;moe_58_aggregate</title>
<path fill="none" stroke="black" d="M1807.7,-3194.6C1818.79,-3185.51 1831.63,-3174.98 1843.99,-3164.84"/>
<polygon fill="black" stroke="black" points="1846.51,-3167.3 1852.02,-3158.25 1842.07,-3161.88 1846.51,-3167.3"/>
</g>
<!-- moe_58_expert_8&#45;&gt;moe_58_aggregate -->
<g id="edge2093" class="edge">
<title>moe_58_expert_8&#45;&gt;moe_58_aggregate</title>
<path fill="none" stroke="black" d="M1982.3,-3194.6C1971.21,-3185.51 1958.37,-3174.98 1946.01,-3164.84"/>
<polygon fill="black" stroke="black" points="1947.93,-3161.88 1937.98,-3158.25 1943.49,-3167.3 1947.93,-3161.88"/>
</g>
<!-- moe_58_expert_9&#45;&gt;moe_58_aggregate -->
<g id="edge2094" class="edge">
<title>moe_58_expert_9&#45;&gt;moe_58_aggregate</title>
<path fill="none" stroke="black" d="M2157.38,-3194.73C2114.73,-3183.07 2063.38,-3169.03 2017.46,-3156.48"/>
<polygon fill="black" stroke="black" points="2018.32,-3153.09 2007.75,-3153.83 2016.47,-3159.84 2018.32,-3153.09"/>
</g>
<!-- moe_58_expert_10&#45;&gt;moe_58_aggregate -->
<g id="edge2095" class="edge">
<title>moe_58_expert_10&#45;&gt;moe_58_aggregate</title>
<path fill="none" stroke="black" d="M2375.75,-3196.4C2372.81,-3195.84 2369.88,-3195.3 2367,-3194.77 2270.42,-3177.21 2162.17,-3160.54 2073.73,-3147.69"/>
<polygon fill="black" stroke="black" points="2074,-3144.19 2063.6,-3146.22 2072.99,-3151.12 2074,-3144.19"/>
</g>
<!-- moe_58_expert_11&#45;&gt;moe_58_aggregate -->
<g id="edge2096" class="edge">
<title>moe_58_expert_11&#45;&gt;moe_58_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-3196.2C2608.83,-3195.7 2605.9,-3195.23 2603,-3194.77 2437.3,-3168.9 2248.27,-3150.29 2107.23,-3138.51"/>
<polygon fill="black" stroke="black" points="2107.41,-3135.01 2097.16,-3137.67 2106.83,-3141.99 2107.41,-3135.01"/>
</g>
<!-- moe_58_expert_12&#45;&gt;moe_58_aggregate -->
<g id="edge2097" class="edge">
<title>moe_58_expert_12&#45;&gt;moe_58_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-3196.1C2844.84,-3195.63 2841.9,-3195.19 2839,-3194.77 2595.24,-3159.84 2313.48,-3141.22 2121.68,-3131.78"/>
<polygon fill="black" stroke="black" points="2121.63,-3128.27 2111.47,-3131.28 2121.29,-3135.26 2121.63,-3128.27"/>
</g>
<!-- moe_58_expert_13&#45;&gt;moe_58_aggregate -->
<g id="edge2098" class="edge">
<title>moe_58_expert_13&#45;&gt;moe_58_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-3196.05C3080.85,-3195.59 3077.91,-3195.17 3075,-3194.77 2747.69,-3150.4 2365.55,-3133.45 2126.89,-3126.99"/>
<polygon fill="black" stroke="black" points="2126.78,-3123.48 2116.69,-3126.71 2126.6,-3130.48 2126.78,-3123.48"/>
</g>
<!-- moe_58_expert_14&#45;&gt;moe_58_aggregate -->
<g id="edge2099" class="edge">
<title>moe_58_expert_14&#45;&gt;moe_58_aggregate</title>
<path fill="none" stroke="black" d="M3319.81,-3196.01C3316.85,-3195.57 3313.91,-3195.15 3311,-3194.77 2897.21,-3140.8 2410.49,-3126.84 2128.89,-3123.56"/>
<polygon fill="black" stroke="black" points="2128.59,-3120.06 2118.55,-3123.45 2128.51,-3127.06 2128.59,-3120.06"/>
</g>
<!-- moe_58_expert_15&#45;&gt;moe_58_aggregate -->
<g id="edge2100" class="edge">
<title>moe_58_expert_15&#45;&gt;moe_58_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-3195.98C3552.85,-3195.55 3549.91,-3195.14 3547,-3194.77 3279.26,-3160.83 2513.68,-3138.03 2125.96,-3128.32"/>
<polygon fill="black" stroke="black" points="2125.83,-3124.81 2115.74,-3128.06 2125.65,-3131.81 2125.83,-3124.81"/>
</g>
<!-- moe_58_ffn -->
<g id="node1276" class="node">
<title>moe_58_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2053,-3049.23 1737,-3049.23 1737,-2997.23 2053,-2997.23 2053,-3049.23"/>
<text text-anchor="middle" x="1895" y="-3037.23" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1895" y="-3026.23" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-3015.23" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-3004.23" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_58_aggregate&#45;&gt;moe_58_ffn -->
<g id="edge2101" class="edge">
<title>moe_58_aggregate&#45;&gt;moe_58_ffn</title>
<path fill="none" stroke="black" d="M1895,-3084.97C1895,-3076.66 1895,-3067.82 1895,-3059.54"/>
<polygon fill="black" stroke="black" points="1898.5,-3059.43 1895,-3049.43 1891.5,-3059.43 1898.5,-3059.43"/>
</g>
<!-- moe_58_res2 -->
<g id="node1278" class="node">
<title>moe_58_res2</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-2961.23 1695.97,-2961.23 1558.11,-2857.23 2094.03,-2857.23 2231.89,-2961.23"/>
<text text-anchor="middle" x="1895" y="-2923.23" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1895" y="-2912.23" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-2901.23" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-2890.23" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_58_ffn&#45;&gt;moe_58_res2 -->
<g id="edge2102" class="edge">
<title>moe_58_ffn&#45;&gt;moe_58_res2</title>
<path fill="none" stroke="black" d="M1895,-2997.1C1895,-2989.41 1895,-2980.6 1895,-2971.6"/>
<polygon fill="black" stroke="black" points="1898.5,-2971.41 1895,-2961.41 1891.5,-2971.41 1898.5,-2971.41"/>
</g>
<!-- moe_58_res1&#45;&gt;moe_58_gate -->
<g id="edge2067" class="edge">
<title>moe_58_res1&#45;&gt;moe_58_gate</title>
<path fill="none" stroke="black" d="M1895,-3531.93C1895,-3523.75 1895,-3515.23 1895,-3506.85"/>
<polygon fill="black" stroke="black" points="1898.5,-3506.74 1895,-3496.74 1891.5,-3506.74 1898.5,-3506.74"/>
</g>
<!-- moe_59_mha -->
<g id="node1279" class="node">
<title>moe_59_mha</title>
<polygon fill="lightgreen" stroke="black" points="2053,-2810.23 1737,-2810.23 1737,-2758.23 2053,-2758.23 2053,-2810.23"/>
<text text-anchor="middle" x="1895" y="-2798.23" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1895" y="-2787.23" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-2776.23" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-2765.23" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_58_res2&#45;&gt;moe_59_mha -->
<g id="edge2103" class="edge">
<title>moe_58_res2&#45;&gt;moe_59_mha</title>
<path fill="none" stroke="black" d="M1895,-2857.14C1895,-2844.81 1895,-2831.9 1895,-2820.49"/>
<polygon fill="black" stroke="black" points="1898.5,-2820.48 1895,-2810.48 1891.5,-2820.48 1898.5,-2820.48"/>
</g>
<!-- moe_59_res1 -->
<g id="node1300" class="node">
<title>moe_59_res1</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-2722.23 1695.97,-2722.23 1558.11,-2618.23 2094.03,-2618.23 2231.89,-2722.23"/>
<text text-anchor="middle" x="1895" y="-2684.23" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1895" y="-2673.23" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-2662.23" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-2651.23" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_59_mha&#45;&gt;moe_59_res1 -->
<g id="edge2104" class="edge">
<title>moe_59_mha&#45;&gt;moe_59_res1</title>
<path fill="none" stroke="black" d="M1895,-2758.1C1895,-2750.41 1895,-2741.6 1895,-2732.6"/>
<polygon fill="black" stroke="black" points="1898.5,-2732.41 1895,-2722.41 1891.5,-2732.41 1898.5,-2732.41"/>
</g>
<!-- moe_59_gate -->
<g id="node1280" class="node">
<title>moe_59_gate</title>
<polygon fill="lightyellow" stroke="black" points="2223.8,-2582.23 1700.75,-2582.23 1566.2,-2478.23 2089.25,-2478.23 2223.8,-2582.23"/>
<text text-anchor="middle" x="1895" y="-2544.23" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1895" y="-2533.23" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-2522.23" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-2511.23" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_59_route -->
<g id="node1281" class="node">
<title>moe_59_route</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-2405.47" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-2419.47" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1895" y="-2408.47" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-2397.47" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-2386.47" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_59_gate&#45;&gt;moe_59_route -->
<g id="edge2106" class="edge">
<title>moe_59_gate&#45;&gt;moe_59_route</title>
<path fill="none" stroke="black" d="M1895,-2477.88C1895,-2469.47 1895,-2460.81 1895,-2452.54"/>
<polygon fill="black" stroke="black" points="1898.5,-2452.32 1895,-2442.32 1891.5,-2452.32 1898.5,-2452.32"/>
</g>
<!-- moe_59_expert_0 -->
<g id="node1282" class="node">
<title>moe_59_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-2332.7 16,-2332.7 16,-2280.7 234,-2280.7 234,-2332.7"/>
<text text-anchor="middle" x="125" y="-2320.7" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-2309.7" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-2298.7" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-2287.7" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_59_route&#45;&gt;moe_59_expert_0 -->
<g id="edge2107" class="edge">
<title>moe_59_route&#45;&gt;moe_59_expert_0</title>
<path fill="none" stroke="black" d="M1679.93,-2399.55C1302.11,-2390.18 532.75,-2367.64 244.24,-2332.74"/>
<polygon fill="black" stroke="black" points="244.54,-2329.25 234.18,-2331.49 243.68,-2336.19 244.54,-2329.25"/>
</g>
<!-- moe_59_expert_1 -->
<g id="node1283" class="node">
<title>moe_59_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-2332.7 252,-2332.7 252,-2280.7 470,-2280.7 470,-2332.7"/>
<text text-anchor="middle" x="361" y="-2320.7" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-2309.7" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-2298.7" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-2287.7" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_59_route&#45;&gt;moe_59_expert_1 -->
<g id="edge2108" class="edge">
<title>moe_59_route&#45;&gt;moe_59_expert_1</title>
<path fill="none" stroke="black" d="M1677.23,-2404.08C1400.57,-2401.18 908.56,-2387.93 480.29,-2332.77"/>
<polygon fill="black" stroke="black" points="480.55,-2329.28 470.19,-2331.46 479.65,-2336.22 480.55,-2329.28"/>
</g>
<!-- moe_59_expert_2 -->
<g id="node1284" class="node">
<title>moe_59_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-2332.7 488,-2332.7 488,-2280.7 706,-2280.7 706,-2332.7"/>
<text text-anchor="middle" x="597" y="-2320.7" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-2309.7" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-2298.7" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-2287.7" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_59_route&#45;&gt;moe_59_expert_2 -->
<g id="edge2109" class="edge">
<title>moe_59_route&#45;&gt;moe_59_expert_2</title>
<path fill="none" stroke="black" d="M1678.74,-2400.9C1443.7,-2394.82 1057.2,-2378.38 716.26,-2332.78"/>
<polygon fill="black" stroke="black" points="716.57,-2329.29 706.19,-2331.42 715.63,-2336.23 716.57,-2329.29"/>
</g>
<!-- moe_59_expert_3 -->
<g id="node1285" class="node">
<title>moe_59_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-2332.7 724,-2332.7 724,-2280.7 942,-2280.7 942,-2332.7"/>
<text text-anchor="middle" x="833" y="-2320.7" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-2309.7" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-2298.7" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-2287.7" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_59_route&#45;&gt;moe_59_expert_3 -->
<g id="edge2110" class="edge">
<title>moe_59_route&#45;&gt;moe_59_expert_3</title>
<path fill="none" stroke="black" d="M1683.7,-2396.44C1494.33,-2387.37 1209,-2369.06 952.47,-2332.83"/>
<polygon fill="black" stroke="black" points="952.59,-2329.31 942.2,-2331.36 951.61,-2336.24 952.59,-2329.31"/>
</g>
<!-- moe_59_expert_4 -->
<g id="node1286" class="node">
<title>moe_59_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-2332.7 960,-2332.7 960,-2280.7 1178,-2280.7 1178,-2332.7"/>
<text text-anchor="middle" x="1069" y="-2320.7" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-2309.7" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-2298.7" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-2287.7" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_59_route&#45;&gt;moe_59_expert_4 -->
<g id="edge2111" class="edge">
<title>moe_59_route&#45;&gt;moe_59_expert_4</title>
<path fill="none" stroke="black" d="M1696.66,-2390.11C1556.96,-2378.63 1365.46,-2360.13 1188.25,-2332.82"/>
<polygon fill="black" stroke="black" points="1188.63,-2329.34 1178.21,-2331.27 1187.56,-2336.26 1188.63,-2329.34"/>
</g>
<!-- moe_59_expert_5 -->
<g id="node1287" class="node">
<title>moe_59_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-2332.7 1196,-2332.7 1196,-2280.7 1414,-2280.7 1414,-2332.7"/>
<text text-anchor="middle" x="1305" y="-2320.7" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-2309.7" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-2298.7" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-2287.7" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_59_route&#45;&gt;moe_59_expert_5 -->
<g id="edge2112" class="edge">
<title>moe_59_route&#45;&gt;moe_59_expert_5</title>
<path fill="none" stroke="black" d="M1728.87,-2381.6C1640.99,-2368.92 1531.11,-2352.15 1424.25,-2332.89"/>
<polygon fill="black" stroke="black" points="1424.71,-2329.41 1414.25,-2331.07 1423.46,-2336.3 1424.71,-2329.41"/>
</g>
<!-- moe_59_expert_6 -->
<g id="node1288" class="node">
<title>moe_59_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-2332.7 1432,-2332.7 1432,-2280.7 1650,-2280.7 1650,-2332.7"/>
<text text-anchor="middle" x="1541" y="-2320.7" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-2309.7" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-2298.7" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-2287.7" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_59_route&#45;&gt;moe_59_expert_6 -->
<g id="edge2113" class="edge">
<title>moe_59_route&#45;&gt;moe_59_expert_6</title>
<path fill="none" stroke="black" d="M1782.99,-2373.85C1737.98,-2361.54 1686.47,-2347.46 1642.56,-2335.46"/>
<polygon fill="black" stroke="black" points="1643.31,-2332.03 1632.74,-2332.77 1641.46,-2338.79 1643.31,-2332.03"/>
</g>
<!-- moe_59_expert_7 -->
<g id="node1289" class="node">
<title>moe_59_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-2332.7 1668,-2332.7 1668,-2280.7 1886,-2280.7 1886,-2332.7"/>
<text text-anchor="middle" x="1777" y="-2320.7" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-2309.7" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-2298.7" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-2287.7" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_59_route&#45;&gt;moe_59_expert_7 -->
<g id="edge2114" class="edge">
<title>moe_59_route&#45;&gt;moe_59_expert_7</title>
<path fill="none" stroke="black" d="M1852.07,-2369.26C1840.07,-2359.42 1827.12,-2348.8 1815.41,-2339.19"/>
<polygon fill="black" stroke="black" points="1817.47,-2336.36 1807.52,-2332.73 1813.04,-2341.77 1817.47,-2336.36"/>
</g>
<!-- moe_59_expert_8 -->
<g id="node1290" class="node">
<title>moe_59_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-2332.7 1904,-2332.7 1904,-2280.7 2122,-2280.7 2122,-2332.7"/>
<text text-anchor="middle" x="2013" y="-2320.7" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-2309.7" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-2298.7" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-2287.7" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_59_route&#45;&gt;moe_59_expert_8 -->
<g id="edge2115" class="edge">
<title>moe_59_route&#45;&gt;moe_59_expert_8</title>
<path fill="none" stroke="black" d="M1937.93,-2369.26C1949.93,-2359.42 1962.88,-2348.8 1974.59,-2339.19"/>
<polygon fill="black" stroke="black" points="1976.96,-2341.77 1982.48,-2332.73 1972.53,-2336.36 1976.96,-2341.77"/>
</g>
<!-- moe_59_expert_9 -->
<g id="node1291" class="node">
<title>moe_59_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-2332.7 2140,-2332.7 2140,-2280.7 2358,-2280.7 2358,-2332.7"/>
<text text-anchor="middle" x="2249" y="-2320.7" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-2309.7" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-2298.7" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-2287.7" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_59_route&#45;&gt;moe_59_expert_9 -->
<g id="edge2116" class="edge">
<title>moe_59_route&#45;&gt;moe_59_expert_9</title>
<path fill="none" stroke="black" d="M2007.01,-2373.85C2052.02,-2361.54 2103.53,-2347.46 2147.44,-2335.46"/>
<polygon fill="black" stroke="black" points="2148.54,-2338.79 2157.26,-2332.77 2146.69,-2332.03 2148.54,-2338.79"/>
</g>
<!-- moe_59_expert_10 -->
<g id="node1292" class="node">
<title>moe_59_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-2332.7 2376,-2332.7 2376,-2280.7 2594,-2280.7 2594,-2332.7"/>
<text text-anchor="middle" x="2485" y="-2320.7" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-2309.7" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-2298.7" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-2287.7" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_59_route&#45;&gt;moe_59_expert_10 -->
<g id="edge2117" class="edge">
<title>moe_59_route&#45;&gt;moe_59_expert_10</title>
<path fill="none" stroke="black" d="M2061.13,-2381.6C2149.01,-2368.92 2258.89,-2352.15 2365.75,-2332.89"/>
<polygon fill="black" stroke="black" points="2366.54,-2336.3 2375.75,-2331.07 2365.29,-2329.41 2366.54,-2336.3"/>
</g>
<!-- moe_59_expert_11 -->
<g id="node1293" class="node">
<title>moe_59_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-2332.7 2612,-2332.7 2612,-2280.7 2830,-2280.7 2830,-2332.7"/>
<text text-anchor="middle" x="2721" y="-2320.7" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-2309.7" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-2298.7" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-2287.7" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_59_route&#45;&gt;moe_59_expert_11 -->
<g id="edge2118" class="edge">
<title>moe_59_route&#45;&gt;moe_59_expert_11</title>
<path fill="none" stroke="black" d="M2093.34,-2390.11C2233.04,-2378.63 2424.54,-2360.13 2601.75,-2332.82"/>
<polygon fill="black" stroke="black" points="2602.44,-2336.26 2611.79,-2331.27 2601.37,-2329.34 2602.44,-2336.26"/>
</g>
<!-- moe_59_expert_12 -->
<g id="node1294" class="node">
<title>moe_59_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-2332.7 2848,-2332.7 2848,-2280.7 3066,-2280.7 3066,-2332.7"/>
<text text-anchor="middle" x="2957" y="-2320.7" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-2309.7" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-2298.7" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-2287.7" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_59_route&#45;&gt;moe_59_expert_12 -->
<g id="edge2119" class="edge">
<title>moe_59_route&#45;&gt;moe_59_expert_12</title>
<path fill="none" stroke="black" d="M2106.3,-2396.44C2295.67,-2387.37 2581,-2369.06 2837.53,-2332.83"/>
<polygon fill="black" stroke="black" points="2838.39,-2336.24 2847.8,-2331.36 2837.41,-2329.31 2838.39,-2336.24"/>
</g>
<!-- moe_59_expert_13 -->
<g id="node1295" class="node">
<title>moe_59_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-2332.7 3084,-2332.7 3084,-2280.7 3302,-2280.7 3302,-2332.7"/>
<text text-anchor="middle" x="3193" y="-2320.7" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-2309.7" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-2298.7" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-2287.7" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_59_route&#45;&gt;moe_59_expert_13 -->
<g id="edge2120" class="edge">
<title>moe_59_route&#45;&gt;moe_59_expert_13</title>
<path fill="none" stroke="black" d="M2111.26,-2400.9C2346.3,-2394.82 2732.8,-2378.38 3073.74,-2332.78"/>
<polygon fill="black" stroke="black" points="3074.37,-2336.23 3083.81,-2331.42 3073.43,-2329.29 3074.37,-2336.23"/>
</g>
<!-- moe_59_expert_14 -->
<g id="node1296" class="node">
<title>moe_59_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-2332.7 3320,-2332.7 3320,-2280.7 3538,-2280.7 3538,-2332.7"/>
<text text-anchor="middle" x="3429" y="-2320.7" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-2309.7" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-2298.7" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-2287.7" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_59_route&#45;&gt;moe_59_expert_14 -->
<g id="edge2121" class="edge">
<title>moe_59_route&#45;&gt;moe_59_expert_14</title>
<path fill="none" stroke="black" d="M2112.77,-2404.08C2389.43,-2401.18 2881.44,-2387.93 3309.71,-2332.77"/>
<polygon fill="black" stroke="black" points="3310.35,-2336.22 3319.81,-2331.46 3309.45,-2329.28 3310.35,-2336.22"/>
</g>
<!-- moe_59_expert_15 -->
<g id="node1297" class="node">
<title>moe_59_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-2332.7 3556,-2332.7 3556,-2280.7 3774,-2280.7 3774,-2332.7"/>
<text text-anchor="middle" x="3665" y="-2320.7" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-2309.7" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-2298.7" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-2287.7" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_59_route&#45;&gt;moe_59_expert_15 -->
<g id="edge2122" class="edge">
<title>moe_59_route&#45;&gt;moe_59_expert_15</title>
<path fill="none" stroke="black" d="M2110.07,-2399.55C2487.89,-2390.18 3257.25,-2367.64 3545.76,-2332.74"/>
<polygon fill="black" stroke="black" points="3546.32,-2336.19 3555.82,-2331.49 3545.46,-2329.25 3546.32,-2336.19"/>
</g>
<!-- moe_59_aggregate -->
<g id="node1298" class="node">
<title>moe_59_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1777" cy="-2207.93" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1777" y="-2221.93" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1777" y="-2210.93" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1777" y="-2199.93" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1777" y="-2188.93" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_59_expert_0&#45;&gt;moe_59_aggregate -->
<g id="edge2123" class="edge">
<title>moe_59_expert_0&#45;&gt;moe_59_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-2281.91C237.15,-2281.48 240.09,-2281.07 243,-2280.7 488.12,-2249.21 1182.7,-2225.69 1547.21,-2215.11"/>
<polygon fill="black" stroke="black" points="1547.47,-2218.6 1557.36,-2214.81 1547.27,-2211.6 1547.47,-2218.6"/>
</g>
<!-- moe_59_expert_1&#45;&gt;moe_59_aggregate -->
<g id="edge2124" class="edge">
<title>moe_59_expert_1&#45;&gt;moe_59_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-2281.95C473.15,-2281.5 476.09,-2281.08 479,-2280.7 849.22,-2231.54 1283.16,-2215.94 1543.76,-2211.06"/>
<polygon fill="black" stroke="black" points="1544.17,-2214.55 1554.11,-2210.87 1544.05,-2207.56 1544.17,-2214.55"/>
</g>
<!-- moe_59_expert_2&#45;&gt;moe_59_aggregate -->
<g id="edge2125" class="edge">
<title>moe_59_expert_2&#45;&gt;moe_59_aggregate</title>
<path fill="none" stroke="black" d="M706.2,-2281.99C709.16,-2281.53 712.1,-2281.1 715,-2280.7 1000.02,-2241.07 1331.23,-2223.1 1546.98,-2215.1"/>
<polygon fill="black" stroke="black" points="1547.3,-2218.59 1557.17,-2214.72 1547.05,-2211.59 1547.3,-2218.59"/>
</g>
<!-- moe_59_expert_3&#45;&gt;moe_59_aggregate -->
<g id="edge2126" class="edge">
<title>moe_59_expert_3&#45;&gt;moe_59_aggregate</title>
<path fill="none" stroke="black" d="M942.21,-2282.07C945.16,-2281.59 948.1,-2281.13 951,-2280.7 1154.78,-2250.37 1388.89,-2231.52 1555.72,-2220.79"/>
<polygon fill="black" stroke="black" points="1556.35,-2224.26 1566.11,-2220.13 1555.91,-2217.27 1556.35,-2224.26"/>
</g>
<!-- moe_59_expert_4&#45;&gt;moe_59_aggregate -->
<g id="edge2127" class="edge">
<title>moe_59_expert_4&#45;&gt;moe_59_aggregate</title>
<path fill="none" stroke="black" d="M1178.23,-2282.2C1181.18,-2281.68 1184.11,-2281.18 1187,-2280.7 1316.69,-2259.11 1463.43,-2241.24 1578.13,-2228.72"/>
<polygon fill="black" stroke="black" points="1578.51,-2232.2 1588.07,-2227.64 1577.75,-2225.24 1578.51,-2232.2"/>
</g>
<!-- moe_59_expert_5&#45;&gt;moe_59_aggregate -->
<g id="edge2128" class="edge">
<title>moe_59_expert_5&#45;&gt;moe_59_aggregate</title>
<path fill="none" stroke="black" d="M1414.28,-2282.51C1417.22,-2281.9 1420.13,-2281.29 1423,-2280.7 1490.32,-2266.74 1564.9,-2251.58 1628.19,-2238.8"/>
<polygon fill="black" stroke="black" points="1629.13,-2242.18 1638.24,-2236.77 1627.75,-2235.31 1629.13,-2242.18"/>
</g>
<!-- moe_59_expert_6&#45;&gt;moe_59_aggregate -->
<g id="edge2129" class="edge">
<title>moe_59_expert_6&#45;&gt;moe_59_aggregate</title>
<path fill="none" stroke="black" d="M1602.08,-2280.65C1627.73,-2270.13 1658.09,-2257.68 1686.26,-2246.13"/>
<polygon fill="black" stroke="black" points="1687.79,-2249.29 1695.72,-2242.26 1685.14,-2242.81 1687.79,-2249.29"/>
</g>
<!-- moe_59_expert_7&#45;&gt;moe_59_aggregate -->
<g id="edge2130" class="edge">
<title>moe_59_expert_7&#45;&gt;moe_59_aggregate</title>
<path fill="none" stroke="black" d="M1777,-2280.52C1777,-2272.71 1777,-2263.85 1777,-2255.08"/>
<polygon fill="black" stroke="black" points="1780.5,-2254.9 1777,-2244.9 1773.5,-2254.9 1780.5,-2254.9"/>
</g>
<!-- moe_59_expert_8&#45;&gt;moe_59_aggregate -->
<g id="edge2131" class="edge">
<title>moe_59_expert_8&#45;&gt;moe_59_aggregate</title>
<path fill="none" stroke="black" d="M1951.92,-2280.65C1926.27,-2270.13 1895.91,-2257.68 1867.74,-2246.13"/>
<polygon fill="black" stroke="black" points="1868.86,-2242.81 1858.28,-2242.26 1866.21,-2249.29 1868.86,-2242.81"/>
</g>
<!-- moe_59_expert_9&#45;&gt;moe_59_aggregate -->
<g id="edge2132" class="edge">
<title>moe_59_expert_9&#45;&gt;moe_59_aggregate</title>
<path fill="none" stroke="black" d="M2139.72,-2282.51C2136.78,-2281.9 2133.87,-2281.29 2131,-2280.7 2063.68,-2266.74 1989.1,-2251.58 1925.81,-2238.8"/>
<polygon fill="black" stroke="black" points="1926.25,-2235.31 1915.76,-2236.77 1924.87,-2242.18 1926.25,-2235.31"/>
</g>
<!-- moe_59_expert_10&#45;&gt;moe_59_aggregate -->
<g id="edge2133" class="edge">
<title>moe_59_expert_10&#45;&gt;moe_59_aggregate</title>
<path fill="none" stroke="black" d="M2375.77,-2282.2C2372.82,-2281.68 2369.89,-2281.18 2367,-2280.7 2237.31,-2259.11 2090.57,-2241.24 1975.87,-2228.72"/>
<polygon fill="black" stroke="black" points="1976.25,-2225.24 1965.93,-2227.64 1975.49,-2232.2 1976.25,-2225.24"/>
</g>
<!-- moe_59_expert_11&#45;&gt;moe_59_aggregate -->
<g id="edge2134" class="edge">
<title>moe_59_expert_11&#45;&gt;moe_59_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-2282.07C2608.84,-2281.59 2605.9,-2281.13 2603,-2280.7 2399.22,-2250.37 2165.11,-2231.52 1998.28,-2220.79"/>
<polygon fill="black" stroke="black" points="1998.09,-2217.27 1987.89,-2220.13 1997.65,-2224.26 1998.09,-2217.27"/>
</g>
<!-- moe_59_expert_12&#45;&gt;moe_59_aggregate -->
<g id="edge2135" class="edge">
<title>moe_59_expert_12&#45;&gt;moe_59_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-2281.99C2844.84,-2281.53 2841.9,-2281.1 2839,-2280.7 2553.98,-2241.07 2222.77,-2223.1 2007.02,-2215.1"/>
<polygon fill="black" stroke="black" points="2006.95,-2211.59 1996.83,-2214.72 2006.7,-2218.59 2006.95,-2211.59"/>
</g>
<!-- moe_59_expert_13&#45;&gt;moe_59_aggregate -->
<g id="edge2136" class="edge">
<title>moe_59_expert_13&#45;&gt;moe_59_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-2281.95C3080.85,-2281.5 3077.91,-2281.08 3075,-2280.7 2704.78,-2231.54 2270.84,-2215.94 2010.24,-2211.06"/>
<polygon fill="black" stroke="black" points="2009.95,-2207.56 1999.89,-2210.87 2009.83,-2214.55 2009.95,-2207.56"/>
</g>
<!-- moe_59_expert_14&#45;&gt;moe_59_aggregate -->
<g id="edge2137" class="edge">
<title>moe_59_expert_14&#45;&gt;moe_59_aggregate</title>
<path fill="none" stroke="black" d="M3319.82,-2281.91C3316.85,-2281.48 3313.91,-2281.07 3311,-2280.7 3065.88,-2249.21 2371.3,-2225.69 2006.79,-2215.11"/>
<polygon fill="black" stroke="black" points="2006.73,-2211.6 1996.64,-2214.81 2006.53,-2218.6 2006.73,-2211.6"/>
</g>
<!-- moe_59_expert_15&#45;&gt;moe_59_aggregate -->
<g id="edge2138" class="edge">
<title>moe_59_expert_15&#45;&gt;moe_59_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-2281.89C3552.85,-2281.46 3549.91,-2281.06 3547,-2280.7 3256.39,-2244.28 2418.41,-2222.32 2008.44,-2213.47"/>
<polygon fill="black" stroke="black" points="2008.31,-2209.96 1998.24,-2213.25 2008.16,-2216.96 2008.31,-2209.96"/>
</g>
<!-- moe_59_ffn -->
<g id="node1299" class="node">
<title>moe_59_ffn</title>
<polygon fill="lightgreen" stroke="black" points="1935,-2135.16 1619,-2135.16 1619,-2083.16 1935,-2083.16 1935,-2135.16"/>
<text text-anchor="middle" x="1777" y="-2123.16" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1777" y="-2112.16" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-2101.16" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-2090.16" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_59_aggregate&#45;&gt;moe_59_ffn -->
<g id="edge2139" class="edge">
<title>moe_59_aggregate&#45;&gt;moe_59_ffn</title>
<path fill="none" stroke="black" d="M1777,-2170.89C1777,-2162.58 1777,-2153.75 1777,-2145.47"/>
<polygon fill="black" stroke="black" points="1780.5,-2145.35 1777,-2135.35 1773.5,-2145.35 1780.5,-2145.35"/>
</g>
<!-- moe_59_res2 -->
<g id="node1301" class="node">
<title>moe_59_res2</title>
<polygon fill="lightyellow" stroke="black" points="2113.89,-2047.16 1577.97,-2047.16 1440.11,-1943.16 1976.03,-1943.16 2113.89,-2047.16"/>
<text text-anchor="middle" x="1777" y="-2009.16" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1777" y="-1998.16" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-1987.16" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1777" y="-1976.16" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_59_ffn&#45;&gt;moe_59_res2 -->
<g id="edge2140" class="edge">
<title>moe_59_ffn&#45;&gt;moe_59_res2</title>
<path fill="none" stroke="black" d="M1777,-2083.02C1777,-2075.34 1777,-2066.52 1777,-2057.52"/>
<polygon fill="black" stroke="black" points="1780.5,-2057.33 1777,-2047.33 1773.5,-2057.33 1780.5,-2057.33"/>
</g>
<!-- moe_59_res1&#45;&gt;moe_59_gate -->
<g id="edge2105" class="edge">
<title>moe_59_res1&#45;&gt;moe_59_gate</title>
<path fill="none" stroke="black" d="M1895,-2617.85C1895,-2609.68 1895,-2601.15 1895,-2592.77"/>
<polygon fill="black" stroke="black" points="1898.5,-2592.66 1895,-2582.66 1891.5,-2592.66 1898.5,-2592.66"/>
</g>
<!-- moe_60_mha -->
<g id="node1302" class="node">
<title>moe_60_mha</title>
<polygon fill="lightgreen" stroke="black" points="1935,-1896.16 1619,-1896.16 1619,-1844.16 1935,-1844.16 1935,-1896.16"/>
<text text-anchor="middle" x="1777" y="-1884.16" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1777" y="-1873.16" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-1862.16" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-1851.16" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_59_res2&#45;&gt;moe_60_mha -->
<g id="edge2141" class="edge">
<title>moe_59_res2&#45;&gt;moe_60_mha</title>
<path fill="none" stroke="black" d="M1777,-1943.06C1777,-1930.73 1777,-1917.83 1777,-1906.41"/>
<polygon fill="black" stroke="black" points="1780.5,-1906.4 1777,-1896.4 1773.5,-1906.4 1780.5,-1906.4"/>
</g>
<!-- moe_60_res1 -->
<g id="node1323" class="node">
<title>moe_60_res1</title>
<polygon fill="lightyellow" stroke="black" points="2113.89,-1808.16 1577.97,-1808.16 1440.11,-1704.16 1976.03,-1704.16 2113.89,-1808.16"/>
<text text-anchor="middle" x="1777" y="-1770.16" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1777" y="-1759.16" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-1748.16" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1777" y="-1737.16" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_60_mha&#45;&gt;moe_60_res1 -->
<g id="edge2142" class="edge">
<title>moe_60_mha&#45;&gt;moe_60_res1</title>
<path fill="none" stroke="black" d="M1777,-1844.02C1777,-1836.34 1777,-1827.52 1777,-1818.52"/>
<polygon fill="black" stroke="black" points="1780.5,-1818.33 1777,-1808.33 1773.5,-1818.33 1780.5,-1818.33"/>
</g>
<!-- moe_60_gate -->
<g id="node1303" class="node">
<title>moe_60_gate</title>
<polygon fill="lightyellow" stroke="black" points="2105.8,-1668.16 1582.75,-1668.16 1448.2,-1564.16 1971.25,-1564.16 2105.8,-1668.16"/>
<text text-anchor="middle" x="1777" y="-1630.16" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1777" y="-1619.16" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1777" y="-1608.16" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-1597.16" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_60_route -->
<g id="node1304" class="node">
<title>moe_60_route</title>
<ellipse fill="lightblue" stroke="black" cx="1777" cy="-1491.39" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1777" y="-1505.39" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1777" y="-1494.39" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1777" y="-1483.39" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-1472.39" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_60_gate&#45;&gt;moe_60_route -->
<g id="edge2144" class="edge">
<title>moe_60_gate&#45;&gt;moe_60_route</title>
<path fill="none" stroke="black" d="M1777,-1563.8C1777,-1555.39 1777,-1546.73 1777,-1538.46"/>
<polygon fill="black" stroke="black" points="1780.5,-1538.24 1777,-1528.24 1773.5,-1538.24 1780.5,-1538.24"/>
</g>
<!-- moe_60_expert_0 -->
<g id="node1305" class="node">
<title>moe_60_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-1418.62 16,-1418.62 16,-1366.62 234,-1366.62 234,-1418.62"/>
<text text-anchor="middle" x="125" y="-1406.62" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-1395.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-1384.62" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-1373.62" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_60_route&#45;&gt;moe_60_expert_0 -->
<g id="edge2145" class="edge">
<title>moe_60_route&#45;&gt;moe_60_expert_0</title>
<path fill="none" stroke="black" d="M1562.77,-1484.66C1207.39,-1474.43 509.65,-1451.16 244.21,-1418.66"/>
<polygon fill="black" stroke="black" points="244.54,-1415.17 234.18,-1417.4 243.67,-1422.12 244.54,-1415.17"/>
</g>
<!-- moe_60_expert_1 -->
<g id="node1306" class="node">
<title>moe_60_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-1418.62 252,-1418.62 252,-1366.62 470,-1366.62 470,-1418.62"/>
<text text-anchor="middle" x="361" y="-1406.62" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-1395.62" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-1384.62" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-1373.62" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_60_route&#45;&gt;moe_60_expert_1 -->
<g id="edge2146" class="edge">
<title>moe_60_route&#45;&gt;moe_60_expert_1</title>
<path fill="none" stroke="black" d="M1559.59,-1488.54C1303.22,-1484.03 864.4,-1469.04 480.11,-1418.68"/>
<polygon fill="black" stroke="black" points="480.56,-1415.21 470.19,-1417.37 479.64,-1422.15 480.56,-1415.21"/>
</g>
<!-- moe_60_expert_2 -->
<g id="node1307" class="node">
<title>moe_60_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-1418.62 488,-1418.62 488,-1366.62 706,-1366.62 706,-1418.62"/>
<text text-anchor="middle" x="597" y="-1406.62" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-1395.62" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-1384.62" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-1373.62" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_60_route&#45;&gt;moe_60_expert_2 -->
<g id="edge2147" class="edge">
<title>moe_60_route&#45;&gt;moe_60_expert_2</title>
<path fill="none" stroke="black" d="M1562.51,-1484.78C1349.77,-1477.16 1014.57,-1459.6 716.34,-1418.72"/>
<polygon fill="black" stroke="black" points="716.58,-1415.22 706.2,-1417.32 715.62,-1422.15 716.58,-1415.22"/>
</g>
<!-- moe_60_expert_3 -->
<g id="node1308" class="node">
<title>moe_60_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-1418.62 724,-1418.62 724,-1366.62 942,-1366.62 942,-1418.62"/>
<text text-anchor="middle" x="833" y="-1406.62" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-1395.62" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-1384.62" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-1373.62" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_60_route&#45;&gt;moe_60_expert_3 -->
<g id="edge2148" class="edge">
<title>moe_60_route&#45;&gt;moe_60_expert_3</title>
<path fill="none" stroke="black" d="M1570.82,-1479.48C1405.76,-1469.09 1168.32,-1450.44 952.16,-1418.72"/>
<polygon fill="black" stroke="black" points="952.61,-1415.25 942.21,-1417.24 951.59,-1422.17 952.61,-1415.25"/>
</g>
<!-- moe_60_expert_4 -->
<g id="node1309" class="node">
<title>moe_60_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-1418.62 960,-1418.62 960,-1366.62 1178,-1366.62 1178,-1418.62"/>
<text text-anchor="middle" x="1069" y="-1406.62" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-1395.62" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-1384.62" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-1373.62" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_60_route&#45;&gt;moe_60_expert_4 -->
<g id="edge2149" class="edge">
<title>moe_60_route&#45;&gt;moe_60_expert_4</title>
<path fill="none" stroke="black" d="M1591.38,-1472.03C1477.62,-1459.76 1328.9,-1441.9 1188.33,-1418.78"/>
<polygon fill="black" stroke="black" points="1188.66,-1415.29 1178.23,-1417.11 1187.52,-1422.2 1188.66,-1415.29"/>
</g>
<!-- moe_60_expert_5 -->
<g id="node1310" class="node">
<title>moe_60_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-1418.62 1196,-1418.62 1196,-1366.62 1414,-1366.62 1414,-1418.62"/>
<text text-anchor="middle" x="1305" y="-1406.62" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-1395.62" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-1384.62" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-1373.62" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_60_route&#45;&gt;moe_60_expert_5 -->
<g id="edge2150" class="edge">
<title>moe_60_route&#45;&gt;moe_60_expert_5</title>
<path fill="none" stroke="black" d="M1639.51,-1462.8C1576.62,-1450.11 1500.88,-1434.73 1424.14,-1418.85"/>
<polygon fill="black" stroke="black" points="1424.79,-1415.41 1414.28,-1416.81 1423.37,-1422.26 1424.79,-1415.41"/>
</g>
<!-- moe_60_expert_6 -->
<g id="node1311" class="node">
<title>moe_60_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-1418.62 1432,-1418.62 1432,-1366.62 1650,-1366.62 1650,-1418.62"/>
<text text-anchor="middle" x="1541" y="-1406.62" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-1395.62" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-1384.62" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-1373.62" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_60_route&#45;&gt;moe_60_expert_6 -->
<g id="edge2151" class="edge">
<title>moe_60_route&#45;&gt;moe_60_expert_6</title>
<path fill="none" stroke="black" d="M1696.11,-1457.22C1668.54,-1445.91 1637.96,-1433.37 1611.29,-1422.44"/>
<polygon fill="black" stroke="black" points="1612.61,-1419.2 1602.03,-1418.64 1609.95,-1425.67 1612.61,-1419.2"/>
</g>
<!-- moe_60_expert_7 -->
<g id="node1312" class="node">
<title>moe_60_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-1418.62 1668,-1418.62 1668,-1366.62 1886,-1366.62 1886,-1418.62"/>
<text text-anchor="middle" x="1777" y="-1406.62" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-1395.62" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-1384.62" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-1373.62" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_60_route&#45;&gt;moe_60_expert_7 -->
<g id="edge2152" class="edge">
<title>moe_60_route&#45;&gt;moe_60_expert_7</title>
<path fill="none" stroke="black" d="M1777,-1454.35C1777,-1446.04 1777,-1437.21 1777,-1428.93"/>
<polygon fill="black" stroke="black" points="1780.5,-1428.81 1777,-1418.81 1773.5,-1428.81 1780.5,-1428.81"/>
</g>
<!-- moe_60_expert_8 -->
<g id="node1313" class="node">
<title>moe_60_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-1418.62 1904,-1418.62 1904,-1366.62 2122,-1366.62 2122,-1418.62"/>
<text text-anchor="middle" x="2013" y="-1406.62" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-1395.62" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-1384.62" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-1373.62" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_60_route&#45;&gt;moe_60_expert_8 -->
<g id="edge2153" class="edge">
<title>moe_60_route&#45;&gt;moe_60_expert_8</title>
<path fill="none" stroke="black" d="M1857.89,-1457.22C1885.46,-1445.91 1916.04,-1433.37 1942.71,-1422.44"/>
<polygon fill="black" stroke="black" points="1944.05,-1425.67 1951.97,-1418.64 1941.39,-1419.2 1944.05,-1425.67"/>
</g>
<!-- moe_60_expert_9 -->
<g id="node1314" class="node">
<title>moe_60_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-1418.62 2140,-1418.62 2140,-1366.62 2358,-1366.62 2358,-1418.62"/>
<text text-anchor="middle" x="2249" y="-1406.62" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-1395.62" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-1384.62" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-1373.62" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_60_route&#45;&gt;moe_60_expert_9 -->
<g id="edge2154" class="edge">
<title>moe_60_route&#45;&gt;moe_60_expert_9</title>
<path fill="none" stroke="black" d="M1914.49,-1462.8C1977.38,-1450.11 2053.12,-1434.73 2129.86,-1418.85"/>
<polygon fill="black" stroke="black" points="2130.63,-1422.26 2139.72,-1416.81 2129.21,-1415.41 2130.63,-1422.26"/>
</g>
<!-- moe_60_expert_10 -->
<g id="node1315" class="node">
<title>moe_60_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-1418.62 2376,-1418.62 2376,-1366.62 2594,-1366.62 2594,-1418.62"/>
<text text-anchor="middle" x="2485" y="-1406.62" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-1395.62" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-1384.62" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-1373.62" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_60_route&#45;&gt;moe_60_expert_10 -->
<g id="edge2155" class="edge">
<title>moe_60_route&#45;&gt;moe_60_expert_10</title>
<path fill="none" stroke="black" d="M1962.62,-1472.03C2076.38,-1459.76 2225.1,-1441.9 2365.67,-1418.78"/>
<polygon fill="black" stroke="black" points="2366.48,-1422.2 2375.77,-1417.11 2365.34,-1415.29 2366.48,-1422.2"/>
</g>
<!-- moe_60_expert_11 -->
<g id="node1316" class="node">
<title>moe_60_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-1418.62 2612,-1418.62 2612,-1366.62 2830,-1366.62 2830,-1418.62"/>
<text text-anchor="middle" x="2721" y="-1406.62" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-1395.62" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-1384.62" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-1373.62" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_60_route&#45;&gt;moe_60_expert_11 -->
<g id="edge2156" class="edge">
<title>moe_60_route&#45;&gt;moe_60_expert_11</title>
<path fill="none" stroke="black" d="M1983.18,-1479.48C2148.24,-1469.09 2385.68,-1450.44 2601.84,-1418.72"/>
<polygon fill="black" stroke="black" points="2602.41,-1422.17 2611.79,-1417.24 2601.39,-1415.25 2602.41,-1422.17"/>
</g>
<!-- moe_60_expert_12 -->
<g id="node1317" class="node">
<title>moe_60_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-1418.62 2848,-1418.62 2848,-1366.62 3066,-1366.62 3066,-1418.62"/>
<text text-anchor="middle" x="2957" y="-1406.62" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-1395.62" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-1384.62" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-1373.62" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_60_route&#45;&gt;moe_60_expert_12 -->
<g id="edge2157" class="edge">
<title>moe_60_route&#45;&gt;moe_60_expert_12</title>
<path fill="none" stroke="black" d="M1991.49,-1484.78C2204.23,-1477.16 2539.43,-1459.6 2837.66,-1418.72"/>
<polygon fill="black" stroke="black" points="2838.38,-1422.15 2847.8,-1417.32 2837.42,-1415.22 2838.38,-1422.15"/>
</g>
<!-- moe_60_expert_13 -->
<g id="node1318" class="node">
<title>moe_60_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-1418.62 3084,-1418.62 3084,-1366.62 3302,-1366.62 3302,-1418.62"/>
<text text-anchor="middle" x="3193" y="-1406.62" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-1395.62" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-1384.62" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-1373.62" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_60_route&#45;&gt;moe_60_expert_13 -->
<g id="edge2158" class="edge">
<title>moe_60_route&#45;&gt;moe_60_expert_13</title>
<path fill="none" stroke="black" d="M1994.41,-1488.54C2250.78,-1484.03 2689.6,-1469.04 3073.89,-1418.68"/>
<polygon fill="black" stroke="black" points="3074.36,-1422.15 3083.81,-1417.37 3073.44,-1415.21 3074.36,-1422.15"/>
</g>
<!-- moe_60_expert_14 -->
<g id="node1319" class="node">
<title>moe_60_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-1418.62 3320,-1418.62 3320,-1366.62 3538,-1366.62 3538,-1418.62"/>
<text text-anchor="middle" x="3429" y="-1406.62" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-1395.62" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-1384.62" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-1373.62" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_60_route&#45;&gt;moe_60_expert_14 -->
<g id="edge2159" class="edge">
<title>moe_60_route&#45;&gt;moe_60_expert_14</title>
<path fill="none" stroke="black" d="M1991.23,-1484.66C2346.61,-1474.43 3044.35,-1451.16 3309.79,-1418.66"/>
<polygon fill="black" stroke="black" points="3310.33,-1422.12 3319.82,-1417.4 3309.46,-1415.17 3310.33,-1422.12"/>
</g>
<!-- moe_60_expert_15 -->
<g id="node1320" class="node">
<title>moe_60_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-1418.62 3556,-1418.62 3556,-1366.62 3774,-1366.62 3774,-1418.62"/>
<text text-anchor="middle" x="3665" y="-1406.62" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-1395.62" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-1384.62" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-1373.62" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_60_route&#45;&gt;moe_60_expert_15 -->
<g id="edge2160" class="edge">
<title>moe_60_route&#45;&gt;moe_60_expert_15</title>
<path fill="none" stroke="black" d="M1992.71,-1486.18C2392.25,-1477.65 3234.28,-1455.98 3545.86,-1418.65"/>
<polygon fill="black" stroke="black" points="3546.32,-1422.12 3555.82,-1417.42 3545.47,-1415.17 3546.32,-1422.12"/>
</g>
<!-- moe_60_aggregate -->
<g id="node1321" class="node">
<title>moe_60_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-1293.85" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-1307.85" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1895" y="-1296.85" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-1285.85" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1895" y="-1274.85" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_60_expert_0&#45;&gt;moe_60_aggregate -->
<g id="edge2161" class="edge">
<title>moe_60_expert_0&#45;&gt;moe_60_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-1367.82C237.15,-1367.39 240.09,-1366.99 243,-1366.62 510.74,-1332.68 1276.32,-1309.88 1664.04,-1300.16"/>
<polygon fill="black" stroke="black" points="1664.35,-1303.66 1674.26,-1299.91 1664.17,-1296.66 1664.35,-1303.66"/>
</g>
<!-- moe_60_expert_1&#45;&gt;moe_60_aggregate -->
<g id="edge2162" class="edge">
<title>moe_60_expert_1&#45;&gt;moe_60_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-1367.85C473.15,-1367.41 476.09,-1367 479,-1366.62 892.79,-1312.64 1379.51,-1298.68 1661.11,-1295.41"/>
<polygon fill="black" stroke="black" points="1661.49,-1298.9 1671.45,-1295.29 1661.41,-1291.9 1661.49,-1298.9"/>
</g>
<!-- moe_60_expert_2&#45;&gt;moe_60_aggregate -->
<g id="edge2163" class="edge">
<title>moe_60_expert_2&#45;&gt;moe_60_aggregate</title>
<path fill="none" stroke="black" d="M706.19,-1367.89C709.15,-1367.44 712.09,-1367.01 715,-1366.62 1042.31,-1322.24 1424.45,-1305.29 1663.11,-1298.83"/>
<polygon fill="black" stroke="black" points="1663.4,-1302.32 1673.31,-1298.56 1663.22,-1295.32 1663.4,-1302.32"/>
</g>
<!-- moe_60_expert_3&#45;&gt;moe_60_aggregate -->
<g id="edge2164" class="edge">
<title>moe_60_expert_3&#45;&gt;moe_60_aggregate</title>
<path fill="none" stroke="black" d="M942.2,-1367.95C945.16,-1367.48 948.1,-1367.03 951,-1366.62 1194.76,-1331.69 1476.52,-1313.06 1668.32,-1303.62"/>
<polygon fill="black" stroke="black" points="1668.71,-1307.1 1678.53,-1303.12 1668.37,-1300.11 1668.71,-1307.1"/>
</g>
<!-- moe_60_expert_4&#45;&gt;moe_60_aggregate -->
<g id="edge2165" class="edge">
<title>moe_60_expert_4&#45;&gt;moe_60_aggregate</title>
<path fill="none" stroke="black" d="M1178.21,-1368.05C1181.17,-1367.55 1184.1,-1367.07 1187,-1366.62 1352.7,-1340.74 1541.73,-1322.13 1682.77,-1310.35"/>
<polygon fill="black" stroke="black" points="1683.17,-1313.83 1692.84,-1309.52 1682.59,-1306.86 1683.17,-1313.83"/>
</g>
<!-- moe_60_expert_5&#45;&gt;moe_60_aggregate -->
<g id="edge2166" class="edge">
<title>moe_60_expert_5&#45;&gt;moe_60_aggregate</title>
<path fill="none" stroke="black" d="M1414.25,-1368.24C1417.19,-1367.68 1420.12,-1367.14 1423,-1366.62 1519.58,-1349.06 1627.83,-1332.38 1716.27,-1319.54"/>
<polygon fill="black" stroke="black" points="1717.01,-1322.97 1726.4,-1318.07 1716,-1316.04 1717.01,-1322.97"/>
</g>
<!-- moe_60_expert_6&#45;&gt;moe_60_aggregate -->
<g id="edge2167" class="edge">
<title>moe_60_expert_6&#45;&gt;moe_60_aggregate</title>
<path fill="none" stroke="black" d="M1632.62,-1366.57C1675.27,-1354.91 1726.62,-1340.88 1772.54,-1328.32"/>
<polygon fill="black" stroke="black" points="1773.53,-1331.68 1782.25,-1325.67 1771.68,-1324.93 1773.53,-1331.68"/>
</g>
<!-- moe_60_expert_7&#45;&gt;moe_60_aggregate -->
<g id="edge2168" class="edge">
<title>moe_60_expert_7&#45;&gt;moe_60_aggregate</title>
<path fill="none" stroke="black" d="M1807.7,-1366.44C1818.79,-1357.35 1831.63,-1346.82 1843.99,-1336.68"/>
<polygon fill="black" stroke="black" points="1846.51,-1339.14 1852.02,-1330.09 1842.07,-1333.73 1846.51,-1339.14"/>
</g>
<!-- moe_60_expert_8&#45;&gt;moe_60_aggregate -->
<g id="edge2169" class="edge">
<title>moe_60_expert_8&#45;&gt;moe_60_aggregate</title>
<path fill="none" stroke="black" d="M1982.3,-1366.44C1971.21,-1357.35 1958.37,-1346.82 1946.01,-1336.68"/>
<polygon fill="black" stroke="black" points="1947.93,-1333.73 1937.98,-1330.09 1943.49,-1339.14 1947.93,-1333.73"/>
</g>
<!-- moe_60_expert_9&#45;&gt;moe_60_aggregate -->
<g id="edge2170" class="edge">
<title>moe_60_expert_9&#45;&gt;moe_60_aggregate</title>
<path fill="none" stroke="black" d="M2157.38,-1366.57C2114.73,-1354.91 2063.38,-1340.88 2017.46,-1328.32"/>
<polygon fill="black" stroke="black" points="2018.32,-1324.93 2007.75,-1325.67 2016.47,-1331.68 2018.32,-1324.93"/>
</g>
<!-- moe_60_expert_10&#45;&gt;moe_60_aggregate -->
<g id="edge2171" class="edge">
<title>moe_60_expert_10&#45;&gt;moe_60_aggregate</title>
<path fill="none" stroke="black" d="M2375.75,-1368.24C2372.81,-1367.68 2369.88,-1367.14 2367,-1366.62 2270.42,-1349.06 2162.17,-1332.38 2073.73,-1319.54"/>
<polygon fill="black" stroke="black" points="2074,-1316.04 2063.6,-1318.07 2072.99,-1322.97 2074,-1316.04"/>
</g>
<!-- moe_60_expert_11&#45;&gt;moe_60_aggregate -->
<g id="edge2172" class="edge">
<title>moe_60_expert_11&#45;&gt;moe_60_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-1368.05C2608.83,-1367.55 2605.9,-1367.07 2603,-1366.62 2437.3,-1340.74 2248.27,-1322.13 2107.23,-1310.35"/>
<polygon fill="black" stroke="black" points="2107.41,-1306.86 2097.16,-1309.52 2106.83,-1313.83 2107.41,-1306.86"/>
</g>
<!-- moe_60_expert_12&#45;&gt;moe_60_aggregate -->
<g id="edge2173" class="edge">
<title>moe_60_expert_12&#45;&gt;moe_60_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-1367.95C2844.84,-1367.48 2841.9,-1367.03 2839,-1366.62 2595.24,-1331.69 2313.48,-1313.06 2121.68,-1303.62"/>
<polygon fill="black" stroke="black" points="2121.63,-1300.11 2111.47,-1303.12 2121.29,-1307.1 2121.63,-1300.11"/>
</g>
<!-- moe_60_expert_13&#45;&gt;moe_60_aggregate -->
<g id="edge2174" class="edge">
<title>moe_60_expert_13&#45;&gt;moe_60_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-1367.89C3080.85,-1367.44 3077.91,-1367.01 3075,-1366.62 2747.69,-1322.24 2365.55,-1305.29 2126.89,-1298.83"/>
<polygon fill="black" stroke="black" points="2126.78,-1295.32 2116.69,-1298.56 2126.6,-1302.32 2126.78,-1295.32"/>
</g>
<!-- moe_60_expert_14&#45;&gt;moe_60_aggregate -->
<g id="edge2175" class="edge">
<title>moe_60_expert_14&#45;&gt;moe_60_aggregate</title>
<path fill="none" stroke="black" d="M3319.81,-1367.85C3316.85,-1367.41 3313.91,-1367 3311,-1366.62 2897.21,-1312.64 2410.49,-1298.68 2128.89,-1295.41"/>
<polygon fill="black" stroke="black" points="2128.59,-1291.9 2118.55,-1295.29 2128.51,-1298.9 2128.59,-1291.9"/>
</g>
<!-- moe_60_expert_15&#45;&gt;moe_60_aggregate -->
<g id="edge2176" class="edge">
<title>moe_60_expert_15&#45;&gt;moe_60_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-1367.82C3552.85,-1367.39 3549.91,-1366.99 3547,-1366.62 3279.26,-1332.68 2513.68,-1309.88 2125.96,-1300.16"/>
<polygon fill="black" stroke="black" points="2125.83,-1296.66 2115.74,-1299.91 2125.65,-1303.66 2125.83,-1296.66"/>
</g>
<!-- moe_60_ffn -->
<g id="node1322" class="node">
<title>moe_60_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2053,-1221.08 1737,-1221.08 1737,-1169.08 2053,-1169.08 2053,-1221.08"/>
<text text-anchor="middle" x="1895" y="-1209.08" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1895" y="-1198.08" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-1187.08" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-1176.08" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_60_aggregate&#45;&gt;moe_60_ffn -->
<g id="edge2177" class="edge">
<title>moe_60_aggregate&#45;&gt;moe_60_ffn</title>
<path fill="none" stroke="black" d="M1895,-1256.81C1895,-1248.5 1895,-1239.67 1895,-1231.39"/>
<polygon fill="black" stroke="black" points="1898.5,-1231.27 1895,-1221.27 1891.5,-1231.27 1898.5,-1231.27"/>
</g>
<!-- moe_60_res2 -->
<g id="node1324" class="node">
<title>moe_60_res2</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-1133.08 1695.97,-1133.08 1558.11,-1029.08 2094.03,-1029.08 2231.89,-1133.08"/>
<text text-anchor="middle" x="1895" y="-1095.08" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1895" y="-1084.08" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-1073.08" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-1062.08" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_60_ffn&#45;&gt;moe_60_res2 -->
<g id="edge2178" class="edge">
<title>moe_60_ffn&#45;&gt;moe_60_res2</title>
<path fill="none" stroke="black" d="M1895,-1168.94C1895,-1161.26 1895,-1152.45 1895,-1143.45"/>
<polygon fill="black" stroke="black" points="1898.5,-1143.26 1895,-1133.26 1891.5,-1143.26 1898.5,-1143.26"/>
</g>
<!-- moe_60_res1&#45;&gt;moe_60_gate -->
<g id="edge2143" class="edge">
<title>moe_60_res1&#45;&gt;moe_60_gate</title>
<path fill="none" stroke="black" d="M1777,-1703.77C1777,-1695.6 1777,-1687.07 1777,-1678.7"/>
<polygon fill="black" stroke="black" points="1780.5,-1678.59 1777,-1668.59 1773.5,-1678.59 1780.5,-1678.59"/>
</g>
<!-- moe_61_mha -->
<g id="node1325" class="node">
<title>moe_61_mha</title>
<polygon fill="lightgreen" stroke="black" points="2053,-982.08 1737,-982.08 1737,-930.08 2053,-930.08 2053,-982.08"/>
<text text-anchor="middle" x="1895" y="-970.08" font-family="Arial" font-size="10.00">MHA Computation</text>
<text text-anchor="middle" x="1895" y="-959.08" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-948.08" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-937.08" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_60_res2&#45;&gt;moe_61_mha -->
<g id="edge2179" class="edge">
<title>moe_60_res2&#45;&gt;moe_61_mha</title>
<path fill="none" stroke="black" d="M1895,-1028.98C1895,-1016.65 1895,-1003.75 1895,-992.33"/>
<polygon fill="black" stroke="black" points="1898.5,-992.32 1895,-982.32 1891.5,-992.32 1898.5,-992.32"/>
</g>
<!-- moe_61_res1 -->
<g id="node1346" class="node">
<title>moe_61_res1</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-894.08 1695.97,-894.08 1558.11,-790.08 2094.03,-790.08 2231.89,-894.08"/>
<text text-anchor="middle" x="1895" y="-856.08" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="1895" y="-845.08" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-834.08" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-823.08" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_61_mha&#45;&gt;moe_61_res1 -->
<g id="edge2180" class="edge">
<title>moe_61_mha&#45;&gt;moe_61_res1</title>
<path fill="none" stroke="black" d="M1895,-929.94C1895,-922.26 1895,-913.45 1895,-904.45"/>
<polygon fill="black" stroke="black" points="1898.5,-904.26 1895,-894.26 1891.5,-904.26 1898.5,-904.26"/>
</g>
<!-- moe_61_gate -->
<g id="node1326" class="node">
<title>moe_61_gate</title>
<polygon fill="lightyellow" stroke="black" points="2223.8,-754.08 1700.75,-754.08 1566.2,-650.08 2089.25,-650.08 2223.8,-754.08"/>
<text text-anchor="middle" x="1895" y="-716.08" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="1895" y="-705.08" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-694.08" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-683.08" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, num_experts=16]</text>
</g>
<!-- moe_61_route -->
<g id="node1327" class="node">
<title>moe_61_route</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-577.31" rx="217.58" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-591.31" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="1895" y="-580.31" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-569.31" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-558.31" font-family="Arial" font-size="10.00">Output: Distributed to experts</text>
</g>
<!-- moe_61_gate&#45;&gt;moe_61_route -->
<g id="edge2182" class="edge">
<title>moe_61_gate&#45;&gt;moe_61_route</title>
<path fill="none" stroke="black" d="M1895,-649.72C1895,-641.32 1895,-632.65 1895,-624.38"/>
<polygon fill="black" stroke="black" points="1898.5,-624.16 1895,-614.16 1891.5,-624.16 1898.5,-624.16"/>
</g>
<!-- moe_61_expert_0 -->
<g id="node1328" class="node">
<title>moe_61_expert_0</title>
<polygon fill="lightgreen" stroke="black" points="234,-504.54 16,-504.54 16,-452.54 234,-452.54 234,-504.54"/>
<text text-anchor="middle" x="125" y="-492.54" font-family="Arial" font-size="10.00">Expert 0 MLP</text>
<text text-anchor="middle" x="125" y="-481.54" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="125" y="-470.54" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="125" y="-459.54" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_61_route&#45;&gt;moe_61_expert_0 -->
<g id="edge2183" class="edge">
<title>moe_61_route&#45;&gt;moe_61_expert_0</title>
<path fill="none" stroke="black" d="M1679.93,-571.39C1302.11,-562.02 532.75,-539.49 244.24,-504.58"/>
<polygon fill="black" stroke="black" points="244.54,-501.09 234.18,-503.33 243.68,-508.04 244.54,-501.09"/>
</g>
<!-- moe_61_expert_1 -->
<g id="node1329" class="node">
<title>moe_61_expert_1</title>
<polygon fill="lightgreen" stroke="black" points="470,-504.54 252,-504.54 252,-452.54 470,-452.54 470,-504.54"/>
<text text-anchor="middle" x="361" y="-492.54" font-family="Arial" font-size="10.00">Expert 1 MLP</text>
<text text-anchor="middle" x="361" y="-481.54" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="361" y="-470.54" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="361" y="-459.54" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_61_route&#45;&gt;moe_61_expert_1 -->
<g id="edge2184" class="edge">
<title>moe_61_route&#45;&gt;moe_61_expert_1</title>
<path fill="none" stroke="black" d="M1677.23,-575.93C1400.57,-573.02 908.56,-559.77 480.29,-504.62"/>
<polygon fill="black" stroke="black" points="480.55,-501.12 470.19,-503.31 479.65,-508.06 480.55,-501.12"/>
</g>
<!-- moe_61_expert_2 -->
<g id="node1330" class="node">
<title>moe_61_expert_2</title>
<polygon fill="lightgreen" stroke="black" points="706,-504.54 488,-504.54 488,-452.54 706,-452.54 706,-504.54"/>
<text text-anchor="middle" x="597" y="-492.54" font-family="Arial" font-size="10.00">Expert 2 MLP</text>
<text text-anchor="middle" x="597" y="-481.54" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="597" y="-470.54" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="597" y="-459.54" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_61_route&#45;&gt;moe_61_expert_2 -->
<g id="edge2185" class="edge">
<title>moe_61_route&#45;&gt;moe_61_expert_2</title>
<path fill="none" stroke="black" d="M1678.74,-572.74C1443.7,-566.66 1057.2,-550.22 716.26,-504.62"/>
<polygon fill="black" stroke="black" points="716.57,-501.13 706.19,-503.27 715.63,-508.07 716.57,-501.13"/>
</g>
<!-- moe_61_expert_3 -->
<g id="node1331" class="node">
<title>moe_61_expert_3</title>
<polygon fill="lightgreen" stroke="black" points="942,-504.54 724,-504.54 724,-452.54 942,-452.54 942,-504.54"/>
<text text-anchor="middle" x="833" y="-492.54" font-family="Arial" font-size="10.00">Expert 3 MLP</text>
<text text-anchor="middle" x="833" y="-481.54" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="833" y="-470.54" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="833" y="-459.54" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_61_route&#45;&gt;moe_61_expert_3 -->
<g id="edge2186" class="edge">
<title>moe_61_route&#45;&gt;moe_61_expert_3</title>
<path fill="none" stroke="black" d="M1683.7,-568.28C1494.33,-559.21 1209,-540.91 952.47,-504.67"/>
<polygon fill="black" stroke="black" points="952.59,-501.15 942.2,-503.21 951.61,-508.08 952.59,-501.15"/>
</g>
<!-- moe_61_expert_4 -->
<g id="node1332" class="node">
<title>moe_61_expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1178,-504.54 960,-504.54 960,-452.54 1178,-452.54 1178,-504.54"/>
<text text-anchor="middle" x="1069" y="-492.54" font-family="Arial" font-size="10.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1069" y="-481.54" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1069" y="-470.54" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1069" y="-459.54" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_61_route&#45;&gt;moe_61_expert_4 -->
<g id="edge2187" class="edge">
<title>moe_61_route&#45;&gt;moe_61_expert_4</title>
<path fill="none" stroke="black" d="M1696.66,-561.96C1556.96,-550.47 1365.46,-531.97 1188.25,-504.67"/>
<polygon fill="black" stroke="black" points="1188.63,-501.19 1178.21,-503.11 1187.56,-508.1 1188.63,-501.19"/>
</g>
<!-- moe_61_expert_5 -->
<g id="node1333" class="node">
<title>moe_61_expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1414,-504.54 1196,-504.54 1196,-452.54 1414,-452.54 1414,-504.54"/>
<text text-anchor="middle" x="1305" y="-492.54" font-family="Arial" font-size="10.00">Expert 5 MLP</text>
<text text-anchor="middle" x="1305" y="-481.54" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1305" y="-470.54" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1305" y="-459.54" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_61_route&#45;&gt;moe_61_expert_5 -->
<g id="edge2188" class="edge">
<title>moe_61_route&#45;&gt;moe_61_expert_5</title>
<path fill="none" stroke="black" d="M1728.87,-553.45C1640.99,-540.77 1531.11,-523.99 1424.25,-504.73"/>
<polygon fill="black" stroke="black" points="1424.71,-501.26 1414.25,-502.92 1423.46,-508.14 1424.71,-501.26"/>
</g>
<!-- moe_61_expert_6 -->
<g id="node1334" class="node">
<title>moe_61_expert_6</title>
<polygon fill="lightgreen" stroke="black" points="1650,-504.54 1432,-504.54 1432,-452.54 1650,-452.54 1650,-504.54"/>
<text text-anchor="middle" x="1541" y="-492.54" font-family="Arial" font-size="10.00">Expert 6 MLP</text>
<text text-anchor="middle" x="1541" y="-481.54" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1541" y="-470.54" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1541" y="-459.54" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_61_route&#45;&gt;moe_61_expert_6 -->
<g id="edge2189" class="edge">
<title>moe_61_route&#45;&gt;moe_61_expert_6</title>
<path fill="none" stroke="black" d="M1782.99,-545.69C1737.98,-533.39 1686.47,-519.3 1642.56,-507.3"/>
<polygon fill="black" stroke="black" points="1643.31,-503.88 1632.74,-504.62 1641.46,-510.63 1643.31,-503.88"/>
</g>
<!-- moe_61_expert_7 -->
<g id="node1335" class="node">
<title>moe_61_expert_7</title>
<polygon fill="lightgreen" stroke="black" points="1886,-504.54 1668,-504.54 1668,-452.54 1886,-452.54 1886,-504.54"/>
<text text-anchor="middle" x="1777" y="-492.54" font-family="Arial" font-size="10.00">Expert 7 MLP</text>
<text text-anchor="middle" x="1777" y="-481.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1777" y="-470.54" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="1777" y="-459.54" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_61_route&#45;&gt;moe_61_expert_7 -->
<g id="edge2190" class="edge">
<title>moe_61_route&#45;&gt;moe_61_expert_7</title>
<path fill="none" stroke="black" d="M1852.07,-541.1C1840.07,-531.26 1827.12,-520.64 1815.41,-511.04"/>
<polygon fill="black" stroke="black" points="1817.47,-508.2 1807.52,-504.57 1813.04,-513.62 1817.47,-508.2"/>
</g>
<!-- moe_61_expert_8 -->
<g id="node1336" class="node">
<title>moe_61_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2122,-504.54 1904,-504.54 1904,-452.54 2122,-452.54 2122,-504.54"/>
<text text-anchor="middle" x="2013" y="-492.54" font-family="Arial" font-size="10.00">Expert 8 MLP</text>
<text text-anchor="middle" x="2013" y="-481.54" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2013" y="-470.54" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2013" y="-459.54" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_61_route&#45;&gt;moe_61_expert_8 -->
<g id="edge2191" class="edge">
<title>moe_61_route&#45;&gt;moe_61_expert_8</title>
<path fill="none" stroke="black" d="M1937.93,-541.1C1949.93,-531.26 1962.88,-520.64 1974.59,-511.04"/>
<polygon fill="black" stroke="black" points="1976.96,-513.62 1982.48,-504.57 1972.53,-508.2 1976.96,-513.62"/>
</g>
<!-- moe_61_expert_9 -->
<g id="node1337" class="node">
<title>moe_61_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="2358,-504.54 2140,-504.54 2140,-452.54 2358,-452.54 2358,-504.54"/>
<text text-anchor="middle" x="2249" y="-492.54" font-family="Arial" font-size="10.00">Expert 9 MLP</text>
<text text-anchor="middle" x="2249" y="-481.54" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2249" y="-470.54" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-459.54" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_61_route&#45;&gt;moe_61_expert_9 -->
<g id="edge2192" class="edge">
<title>moe_61_route&#45;&gt;moe_61_expert_9</title>
<path fill="none" stroke="black" d="M2007.01,-545.69C2052.02,-533.39 2103.53,-519.3 2147.44,-507.3"/>
<polygon fill="black" stroke="black" points="2148.54,-510.63 2157.26,-504.62 2146.69,-503.88 2148.54,-510.63"/>
</g>
<!-- moe_61_expert_10 -->
<g id="node1338" class="node">
<title>moe_61_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="2594,-504.54 2376,-504.54 2376,-452.54 2594,-452.54 2594,-504.54"/>
<text text-anchor="middle" x="2485" y="-492.54" font-family="Arial" font-size="10.00">Expert 10 MLP</text>
<text text-anchor="middle" x="2485" y="-481.54" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2485" y="-470.54" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2485" y="-459.54" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_61_route&#45;&gt;moe_61_expert_10 -->
<g id="edge2193" class="edge">
<title>moe_61_route&#45;&gt;moe_61_expert_10</title>
<path fill="none" stroke="black" d="M2061.13,-553.45C2149.01,-540.77 2258.89,-523.99 2365.75,-504.73"/>
<polygon fill="black" stroke="black" points="2366.54,-508.14 2375.75,-502.92 2365.29,-501.26 2366.54,-508.14"/>
</g>
<!-- moe_61_expert_11 -->
<g id="node1339" class="node">
<title>moe_61_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="2830,-504.54 2612,-504.54 2612,-452.54 2830,-452.54 2830,-504.54"/>
<text text-anchor="middle" x="2721" y="-492.54" font-family="Arial" font-size="10.00">Expert 11 MLP</text>
<text text-anchor="middle" x="2721" y="-481.54" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2721" y="-470.54" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-459.54" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_61_route&#45;&gt;moe_61_expert_11 -->
<g id="edge2194" class="edge">
<title>moe_61_route&#45;&gt;moe_61_expert_11</title>
<path fill="none" stroke="black" d="M2093.34,-561.96C2233.04,-550.47 2424.54,-531.97 2601.75,-504.67"/>
<polygon fill="black" stroke="black" points="2602.44,-508.1 2611.79,-503.11 2601.37,-501.19 2602.44,-508.1"/>
</g>
<!-- moe_61_expert_12 -->
<g id="node1340" class="node">
<title>moe_61_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="3066,-504.54 2848,-504.54 2848,-452.54 3066,-452.54 3066,-504.54"/>
<text text-anchor="middle" x="2957" y="-492.54" font-family="Arial" font-size="10.00">Expert 12 MLP</text>
<text text-anchor="middle" x="2957" y="-481.54" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2957" y="-470.54" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="2957" y="-459.54" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_61_route&#45;&gt;moe_61_expert_12 -->
<g id="edge2195" class="edge">
<title>moe_61_route&#45;&gt;moe_61_expert_12</title>
<path fill="none" stroke="black" d="M2106.3,-568.28C2295.67,-559.21 2581,-540.91 2837.53,-504.67"/>
<polygon fill="black" stroke="black" points="2838.39,-508.08 2847.8,-503.21 2837.41,-501.15 2838.39,-508.08"/>
</g>
<!-- moe_61_expert_13 -->
<g id="node1341" class="node">
<title>moe_61_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="3302,-504.54 3084,-504.54 3084,-452.54 3302,-452.54 3302,-504.54"/>
<text text-anchor="middle" x="3193" y="-492.54" font-family="Arial" font-size="10.00">Expert 13 MLP</text>
<text text-anchor="middle" x="3193" y="-481.54" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3193" y="-470.54" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3193" y="-459.54" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_61_route&#45;&gt;moe_61_expert_13 -->
<g id="edge2196" class="edge">
<title>moe_61_route&#45;&gt;moe_61_expert_13</title>
<path fill="none" stroke="black" d="M2111.26,-572.74C2346.3,-566.66 2732.8,-550.22 3073.74,-504.62"/>
<polygon fill="black" stroke="black" points="3074.37,-508.07 3083.81,-503.27 3073.43,-501.13 3074.37,-508.07"/>
</g>
<!-- moe_61_expert_14 -->
<g id="node1342" class="node">
<title>moe_61_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="3538,-504.54 3320,-504.54 3320,-452.54 3538,-452.54 3538,-504.54"/>
<text text-anchor="middle" x="3429" y="-492.54" font-family="Arial" font-size="10.00">Expert 14 MLP</text>
<text text-anchor="middle" x="3429" y="-481.54" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="3429" y="-470.54" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3429" y="-459.54" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_61_route&#45;&gt;moe_61_expert_14 -->
<g id="edge2197" class="edge">
<title>moe_61_route&#45;&gt;moe_61_expert_14</title>
<path fill="none" stroke="black" d="M2112.77,-575.93C2389.43,-573.02 2881.44,-559.77 3309.71,-504.62"/>
<polygon fill="black" stroke="black" points="3310.35,-508.06 3319.81,-503.31 3309.45,-501.12 3310.35,-508.06"/>
</g>
<!-- moe_61_expert_15 -->
<g id="node1343" class="node">
<title>moe_61_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="3774,-504.54 3556,-504.54 3556,-452.54 3774,-452.54 3774,-504.54"/>
<text text-anchor="middle" x="3665" y="-492.54" font-family="Arial" font-size="10.00">Expert 15 MLP</text>
<text text-anchor="middle" x="3665" y="-481.54" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3665" y="-470.54" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168]</text>
<text text-anchor="middle" x="3665" y="-459.54" font-family="Arial" font-size="10.00">Output: [batch_size_subset, token_dim=7168]</text>
</g>
<!-- moe_61_route&#45;&gt;moe_61_expert_15 -->
<g id="edge2198" class="edge">
<title>moe_61_route&#45;&gt;moe_61_expert_15</title>
<path fill="none" stroke="black" d="M2110.07,-571.39C2487.89,-562.02 3257.25,-539.49 3545.76,-504.58"/>
<polygon fill="black" stroke="black" points="3546.32,-508.04 3555.82,-503.33 3545.46,-501.09 3546.32,-508.04"/>
</g>
<!-- moe_61_aggregate -->
<g id="node1344" class="node">
<title>moe_61_aggregate</title>
<ellipse fill="lightblue" stroke="black" cx="1895" cy="-379.77" rx="223.39" ry="36.54"/>
<text text-anchor="middle" x="1895" y="-393.77" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1895" y="-382.77" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1895" y="-371.77" font-family="Arial" font-size="10.00">Input: [batch_size_subset, token_dim=7168] x 16</text>
<text text-anchor="middle" x="1895" y="-360.77" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_61_expert_0&#45;&gt;moe_61_aggregate -->
<g id="edge2199" class="edge">
<title>moe_61_expert_0&#45;&gt;moe_61_aggregate</title>
<path fill="none" stroke="black" d="M234.18,-453.74C237.15,-453.31 240.09,-452.91 243,-452.54 510.74,-418.6 1276.32,-395.8 1664.04,-386.08"/>
<polygon fill="black" stroke="black" points="1664.35,-389.58 1674.26,-385.83 1664.17,-382.58 1664.35,-389.58"/>
</g>
<!-- moe_61_expert_1&#45;&gt;moe_61_aggregate -->
<g id="edge2200" class="edge">
<title>moe_61_expert_1&#45;&gt;moe_61_aggregate</title>
<path fill="none" stroke="black" d="M470.19,-453.77C473.15,-453.33 476.09,-452.92 479,-452.54 892.79,-398.56 1379.51,-384.6 1661.11,-381.33"/>
<polygon fill="black" stroke="black" points="1661.49,-384.82 1671.45,-381.21 1661.41,-377.82 1661.49,-384.82"/>
</g>
<!-- moe_61_expert_2&#45;&gt;moe_61_aggregate -->
<g id="edge2201" class="edge">
<title>moe_61_expert_2&#45;&gt;moe_61_aggregate</title>
<path fill="none" stroke="black" d="M706.19,-453.81C709.15,-453.36 712.09,-452.93 715,-452.54 1042.31,-408.16 1424.45,-391.22 1663.11,-384.75"/>
<polygon fill="black" stroke="black" points="1663.4,-388.24 1673.31,-384.48 1663.22,-381.25 1663.4,-388.24"/>
</g>
<!-- moe_61_expert_3&#45;&gt;moe_61_aggregate -->
<g id="edge2202" class="edge">
<title>moe_61_expert_3&#45;&gt;moe_61_aggregate</title>
<path fill="none" stroke="black" d="M942.2,-453.87C945.16,-453.4 948.1,-452.95 951,-452.54 1194.76,-417.61 1476.52,-398.98 1668.32,-389.54"/>
<polygon fill="black" stroke="black" points="1668.71,-393.03 1678.53,-389.04 1668.37,-386.03 1668.71,-393.03"/>
</g>
<!-- moe_61_expert_4&#45;&gt;moe_61_aggregate -->
<g id="edge2203" class="edge">
<title>moe_61_expert_4&#45;&gt;moe_61_aggregate</title>
<path fill="none" stroke="black" d="M1178.21,-453.97C1181.17,-453.47 1184.1,-452.99 1187,-452.54 1352.7,-426.67 1541.73,-408.05 1682.77,-396.27"/>
<polygon fill="black" stroke="black" points="1683.17,-399.75 1692.84,-395.44 1682.59,-392.78 1683.17,-399.75"/>
</g>
<!-- moe_61_expert_5&#45;&gt;moe_61_aggregate -->
<g id="edge2204" class="edge">
<title>moe_61_expert_5&#45;&gt;moe_61_aggregate</title>
<path fill="none" stroke="black" d="M1414.25,-454.16C1417.19,-453.61 1420.12,-453.06 1423,-452.54 1519.58,-434.98 1627.83,-418.31 1716.27,-405.46"/>
<polygon fill="black" stroke="black" points="1717.01,-408.89 1726.4,-403.99 1716,-401.96 1717.01,-408.89"/>
</g>
<!-- moe_61_expert_6&#45;&gt;moe_61_aggregate -->
<g id="edge2205" class="edge">
<title>moe_61_expert_6&#45;&gt;moe_61_aggregate</title>
<path fill="none" stroke="black" d="M1632.62,-452.49C1675.27,-440.83 1726.62,-426.8 1772.54,-414.25"/>
<polygon fill="black" stroke="black" points="1773.53,-417.6 1782.25,-411.59 1771.68,-410.85 1773.53,-417.6"/>
</g>
<!-- moe_61_expert_7&#45;&gt;moe_61_aggregate -->
<g id="edge2206" class="edge">
<title>moe_61_expert_7&#45;&gt;moe_61_aggregate</title>
<path fill="none" stroke="black" d="M1807.7,-452.37C1818.79,-443.27 1831.63,-432.74 1843.99,-422.6"/>
<polygon fill="black" stroke="black" points="1846.51,-425.06 1852.02,-416.01 1842.07,-419.65 1846.51,-425.06"/>
</g>
<!-- moe_61_expert_8&#45;&gt;moe_61_aggregate -->
<g id="edge2207" class="edge">
<title>moe_61_expert_8&#45;&gt;moe_61_aggregate</title>
<path fill="none" stroke="black" d="M1982.3,-452.37C1971.21,-443.27 1958.37,-432.74 1946.01,-422.6"/>
<polygon fill="black" stroke="black" points="1947.93,-419.65 1937.98,-416.01 1943.49,-425.06 1947.93,-419.65"/>
</g>
<!-- moe_61_expert_9&#45;&gt;moe_61_aggregate -->
<g id="edge2208" class="edge">
<title>moe_61_expert_9&#45;&gt;moe_61_aggregate</title>
<path fill="none" stroke="black" d="M2157.38,-452.49C2114.73,-440.83 2063.38,-426.8 2017.46,-414.25"/>
<polygon fill="black" stroke="black" points="2018.32,-410.85 2007.75,-411.59 2016.47,-417.6 2018.32,-410.85"/>
</g>
<!-- moe_61_expert_10&#45;&gt;moe_61_aggregate -->
<g id="edge2209" class="edge">
<title>moe_61_expert_10&#45;&gt;moe_61_aggregate</title>
<path fill="none" stroke="black" d="M2375.75,-454.16C2372.81,-453.61 2369.88,-453.06 2367,-452.54 2270.42,-434.98 2162.17,-418.31 2073.73,-405.46"/>
<polygon fill="black" stroke="black" points="2074,-401.96 2063.6,-403.99 2072.99,-408.89 2074,-401.96"/>
</g>
<!-- moe_61_expert_11&#45;&gt;moe_61_aggregate -->
<g id="edge2210" class="edge">
<title>moe_61_expert_11&#45;&gt;moe_61_aggregate</title>
<path fill="none" stroke="black" d="M2611.79,-453.97C2608.83,-453.47 2605.9,-452.99 2603,-452.54 2437.3,-426.67 2248.27,-408.05 2107.23,-396.27"/>
<polygon fill="black" stroke="black" points="2107.41,-392.78 2097.16,-395.44 2106.83,-399.75 2107.41,-392.78"/>
</g>
<!-- moe_61_expert_12&#45;&gt;moe_61_aggregate -->
<g id="edge2211" class="edge">
<title>moe_61_expert_12&#45;&gt;moe_61_aggregate</title>
<path fill="none" stroke="black" d="M2847.8,-453.87C2844.84,-453.4 2841.9,-452.95 2839,-452.54 2595.24,-417.61 2313.48,-398.98 2121.68,-389.54"/>
<polygon fill="black" stroke="black" points="2121.63,-386.03 2111.47,-389.04 2121.29,-393.03 2121.63,-386.03"/>
</g>
<!-- moe_61_expert_13&#45;&gt;moe_61_aggregate -->
<g id="edge2212" class="edge">
<title>moe_61_expert_13&#45;&gt;moe_61_aggregate</title>
<path fill="none" stroke="black" d="M3083.81,-453.81C3080.85,-453.36 3077.91,-452.93 3075,-452.54 2747.69,-408.16 2365.55,-391.22 2126.89,-384.75"/>
<polygon fill="black" stroke="black" points="2126.78,-381.25 2116.69,-384.48 2126.6,-388.24 2126.78,-381.25"/>
</g>
<!-- moe_61_expert_14&#45;&gt;moe_61_aggregate -->
<g id="edge2213" class="edge">
<title>moe_61_expert_14&#45;&gt;moe_61_aggregate</title>
<path fill="none" stroke="black" d="M3319.81,-453.77C3316.85,-453.33 3313.91,-452.92 3311,-452.54 2897.21,-398.56 2410.49,-384.6 2128.89,-381.33"/>
<polygon fill="black" stroke="black" points="2128.59,-377.82 2118.55,-381.21 2128.51,-384.82 2128.59,-377.82"/>
</g>
<!-- moe_61_expert_15&#45;&gt;moe_61_aggregate -->
<g id="edge2214" class="edge">
<title>moe_61_expert_15&#45;&gt;moe_61_aggregate</title>
<path fill="none" stroke="black" d="M3555.82,-453.74C3552.85,-453.31 3549.91,-452.91 3547,-452.54 3279.26,-418.6 2513.68,-395.8 2125.96,-386.08"/>
<polygon fill="black" stroke="black" points="2125.83,-382.58 2115.74,-385.83 2125.65,-389.58 2125.83,-382.58"/>
</g>
<!-- moe_61_ffn -->
<g id="node1345" class="node">
<title>moe_61_ffn</title>
<polygon fill="lightgreen" stroke="black" points="2053,-307 1737,-307 1737,-255 2053,-255 2053,-307"/>
<text text-anchor="middle" x="1895" y="-295" font-family="Arial" font-size="10.00">FFN Computation</text>
<text text-anchor="middle" x="1895" y="-284" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-273" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-262" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_61_aggregate&#45;&gt;moe_61_ffn -->
<g id="edge2215" class="edge">
<title>moe_61_aggregate&#45;&gt;moe_61_ffn</title>
<path fill="none" stroke="black" d="M1895,-342.74C1895,-334.42 1895,-325.59 1895,-317.31"/>
<polygon fill="black" stroke="black" points="1898.5,-317.2 1895,-307.2 1891.5,-317.2 1898.5,-317.2"/>
</g>
<!-- moe_61_res2 -->
<g id="node1347" class="node">
<title>moe_61_res2</title>
<polygon fill="lightyellow" stroke="black" points="2231.89,-219 1695.97,-219 1558.11,-115 2094.03,-115 2231.89,-219"/>
<text text-anchor="middle" x="1895" y="-181" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="1895" y="-170" font-family="Arial" font-size="10.00">GPU: Replicated</text>
<text text-anchor="middle" x="1895" y="-159" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168] x 2</text>
<text text-anchor="middle" x="1895" y="-148" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_61_ffn&#45;&gt;moe_61_res2 -->
<g id="edge2216" class="edge">
<title>moe_61_ffn&#45;&gt;moe_61_res2</title>
<path fill="none" stroke="black" d="M1895,-254.87C1895,-247.18 1895,-238.37 1895,-229.37"/>
<polygon fill="black" stroke="black" points="1898.5,-229.18 1895,-219.18 1891.5,-229.18 1898.5,-229.18"/>
</g>
<!-- moe_61_res1&#45;&gt;moe_61_gate -->
<g id="edge2181" class="edge">
<title>moe_61_res1&#45;&gt;moe_61_gate</title>
<path fill="none" stroke="black" d="M1895,-789.69C1895,-781.52 1895,-772.99 1895,-764.62"/>
<polygon fill="black" stroke="black" points="1898.5,-764.51 1895,-754.51 1891.5,-764.51 1898.5,-764.51"/>
</g>
<!-- output -->
<g id="node1348" class="node">
<title>output</title>
<polygon fill="lightgreen" stroke="black" points="2053,-68 1737,-68 1737,-16 2053,-16 2053,-68"/>
<text text-anchor="middle" x="1895" y="-56" font-family="Arial" font-size="10.00">OUTPUT</text>
<text text-anchor="middle" x="1895" y="-45" font-family="Arial" font-size="10.00">GPU: Host</text>
<text text-anchor="middle" x="1895" y="-34" font-family="Arial" font-size="10.00">Input: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895" y="-23" font-family="Arial" font-size="10.00">Output: [batch_size=batch_size, seq_len=seq_len, token_dim=7168]</text>
</g>
<!-- moe_61_res2&#45;&gt;output -->
<g id="edge2217" class="edge">
<title>moe_61_res2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1895,-114.91C1895,-102.58 1895,-89.67 1895,-78.25"/>
<polygon fill="black" stroke="black" points="1898.5,-78.24 1895,-68.24 1891.5,-78.24 1898.5,-78.24"/>
</g>
</g>
</svg>
