<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="654pt" height="548pt"
 viewBox="0.00 0.00 654.03 548.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 544)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-544 650.03,-544 650.03,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_baseline</title>
<path fill="lightcoral" stroke="black" d="M20,-8C20,-8 625.03,-8 625.03,-8 631.03,-8 637.03,-14 637.03,-20 637.03,-20 637.03,-254 637.03,-254 637.03,-260 631.03,-266 625.03,-266 625.03,-266 20,-266 20,-266 14,-266 8,-260 8,-254 8,-254 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="322.52" y="-250.8" font-family="Times,serif" font-size="14.00">Baseline: Multiple Experts per GPU</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_proposed</title>
<path fill="lightgreen" stroke="black" d="M20,-274C20,-274 626.03,-274 626.03,-274 632.03,-274 638.03,-280 638.03,-286 638.03,-286 638.03,-520 638.03,-520 638.03,-526 632.03,-532 626.03,-532 626.03,-532 20,-532 20,-532 14,-532 8,-526 8,-520 8,-520 8,-286 8,-286 8,-280 14,-274 20,-274"/>
<text text-anchor="middle" x="323.02" y="-516.8" font-family="Times,serif" font-size="14.00">Proposed: One Expert per GPU</text>
</g>
<!-- baseline_input -->
<g id="node1" class="node">
<title>baseline_input</title>
<polygon fill="none" stroke="black" points="88,-143 16,-143 16,-107 88,-107 88,-143"/>
<text text-anchor="middle" x="52" y="-122.5" font-family="Arial" font-size="10.00">Input Tokens</text>
</g>
<!-- baseline_route -->
<g id="node2" class="node">
<title>baseline_route</title>
<ellipse fill="none" stroke="black" cx="180.57" cy="-125" rx="56.64" ry="21.43"/>
<text text-anchor="middle" x="180.57" y="-128" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="180.57" y="-117" font-family="Arial" font-size="10.00">(Within Node)</text>
</g>
<!-- baseline_input&#45;&gt;baseline_route -->
<g id="edge1" class="edge">
<title>baseline_input&#45;&gt;baseline_route</title>
<path fill="none" stroke="black" d="M88.26,-125C96.14,-125 104.76,-125 113.44,-125"/>
<polygon fill="black" stroke="black" points="113.63,-128.5 123.63,-125 113.63,-121.5 113.63,-128.5"/>
</g>
<!-- baseline_gpu0 -->
<g id="node3" class="node">
<title>baseline_gpu0</title>
<polygon fill="none" stroke="black" points="345.14,-57.5 281.14,-57.5 281.14,-16.5 345.14,-16.5 345.14,-57.5"/>
<text text-anchor="middle" x="313.14" y="-45.5" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="313.14" y="-34.5" font-family="Arial" font-size="10.00">4 Experts</text>
<text text-anchor="middle" x="313.14" y="-23.5" font-family="Arial" font-size="10.00">Contention</text>
</g>
<!-- baseline_route&#45;&gt;baseline_gpu0 -->
<g id="edge2" class="edge">
<title>baseline_route&#45;&gt;baseline_gpu0</title>
<path fill="none" stroke="black" d="M208.94,-106.55C227.52,-94.03 252.38,-77.28 273.04,-63.35"/>
<polygon fill="black" stroke="black" points="275.27,-66.07 281.6,-57.58 271.36,-60.26 275.27,-66.07"/>
</g>
<!-- baseline_gpu1 -->
<g id="node4" class="node">
<title>baseline_gpu1</title>
<polygon fill="none" stroke="black" points="345.14,-116.5 281.14,-116.5 281.14,-75.5 345.14,-75.5 345.14,-116.5"/>
<text text-anchor="middle" x="313.14" y="-104.5" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="313.14" y="-93.5" font-family="Arial" font-size="10.00">4 Experts</text>
<text text-anchor="middle" x="313.14" y="-82.5" font-family="Arial" font-size="10.00">Contention</text>
</g>
<!-- baseline_route&#45;&gt;baseline_gpu1 -->
<g id="edge3" class="edge">
<title>baseline_route&#45;&gt;baseline_gpu1</title>
<path fill="none" stroke="black" d="M229.82,-114.28C243.34,-111.28 257.92,-108.04 271,-105.14"/>
<polygon fill="black" stroke="black" points="272.11,-108.48 281.11,-102.89 270.59,-101.64 272.11,-108.48"/>
</g>
<!-- baseline_gpu2 -->
<g id="node5" class="node">
<title>baseline_gpu2</title>
<polygon fill="none" stroke="black" points="345.14,-175.5 281.14,-175.5 281.14,-134.5 345.14,-134.5 345.14,-175.5"/>
<text text-anchor="middle" x="313.14" y="-163.5" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="313.14" y="-152.5" font-family="Arial" font-size="10.00">4 Experts</text>
<text text-anchor="middle" x="313.14" y="-141.5" font-family="Arial" font-size="10.00">Contention</text>
</g>
<!-- baseline_route&#45;&gt;baseline_gpu2 -->
<g id="edge4" class="edge">
<title>baseline_route&#45;&gt;baseline_gpu2</title>
<path fill="none" stroke="black" d="M229.08,-135.92C242.79,-139.07 257.63,-142.48 270.93,-145.53"/>
<polygon fill="black" stroke="black" points="270.22,-148.96 280.75,-147.79 271.79,-142.14 270.22,-148.96"/>
</g>
<!-- baseline_gpu3 -->
<g id="node6" class="node">
<title>baseline_gpu3</title>
<polygon fill="none" stroke="black" points="345.14,-234.5 281.14,-234.5 281.14,-193.5 345.14,-193.5 345.14,-234.5"/>
<text text-anchor="middle" x="313.14" y="-222.5" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="313.14" y="-211.5" font-family="Arial" font-size="10.00">4 Experts</text>
<text text-anchor="middle" x="313.14" y="-200.5" font-family="Arial" font-size="10.00">Contention</text>
</g>
<!-- baseline_route&#45;&gt;baseline_gpu3 -->
<g id="edge5" class="edge">
<title>baseline_route&#45;&gt;baseline_gpu3</title>
<path fill="none" stroke="black" d="M208.62,-143.44C227.4,-156.24 252.69,-173.48 273.57,-187.71"/>
<polygon fill="black" stroke="black" points="271.69,-190.66 281.92,-193.41 275.63,-184.88 271.69,-190.66"/>
</g>
<!-- baseline_aggregate -->
<g id="node7" class="node">
<title>baseline_aggregate</title>
<ellipse fill="none" stroke="black" cx="443.58" cy="-125" rx="54.39" ry="21.43"/>
<text text-anchor="middle" x="443.58" y="-128" font-family="Arial" font-size="10.00">Aggregation</text>
<text text-anchor="middle" x="443.58" y="-117" font-family="Arial" font-size="10.00">(Within Node)</text>
</g>
<!-- baseline_gpu0&#45;&gt;baseline_aggregate -->
<g id="edge6" class="edge">
<title>baseline_gpu0&#45;&gt;baseline_aggregate</title>
<path fill="none" stroke="black" d="M344.25,-57.63C363.11,-70.55 387.5,-87.26 407.27,-100.81"/>
<polygon fill="black" stroke="black" points="405.49,-103.83 415.71,-106.59 409.44,-98.05 405.49,-103.83"/>
</g>
<!-- baseline_gpu1&#45;&gt;baseline_aggregate -->
<g id="edge7" class="edge">
<title>baseline_gpu1&#45;&gt;baseline_aggregate</title>
<path fill="none" stroke="black" d="M345.23,-103.02C357.54,-105.8 372.08,-109.08 386.12,-112.25"/>
<polygon fill="black" stroke="black" points="385.69,-115.74 396.22,-114.53 387.23,-108.92 385.69,-115.74"/>
</g>
<!-- baseline_gpu2&#45;&gt;baseline_aggregate -->
<g id="edge8" class="edge">
<title>baseline_gpu2&#45;&gt;baseline_aggregate</title>
<path fill="none" stroke="black" d="M345.23,-147.74C357.54,-144.86 372.08,-141.47 386.12,-138.19"/>
<polygon fill="black" stroke="black" points="387.28,-141.51 396.22,-135.83 385.68,-134.7 387.28,-141.51"/>
</g>
<!-- baseline_gpu3&#45;&gt;baseline_aggregate -->
<g id="edge9" class="edge">
<title>baseline_gpu3&#45;&gt;baseline_aggregate</title>
<path fill="none" stroke="black" d="M343.93,-193.36C362.99,-180.15 387.81,-162.96 407.78,-149.12"/>
<polygon fill="black" stroke="black" points="409.78,-151.99 416.01,-143.41 405.8,-146.23 409.78,-151.99"/>
</g>
<!-- baseline_output -->
<g id="node8" class="node">
<title>baseline_output</title>
<polygon fill="none" stroke="black" points="629.03,-143 535.03,-143 535.03,-107 629.03,-107 629.03,-143"/>
<text text-anchor="middle" x="582.03" y="-128" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="582.03" y="-117" font-family="Arial" font-size="10.00">Lower Throughput</text>
</g>
<!-- baseline_aggregate&#45;&gt;baseline_output -->
<g id="edge10" class="edge">
<title>baseline_aggregate&#45;&gt;baseline_output</title>
<path fill="none" stroke="black" d="M498.12,-125C506.81,-125 515.84,-125 524.6,-125"/>
<polygon fill="black" stroke="black" points="524.73,-128.5 534.73,-125 524.73,-121.5 524.73,-128.5"/>
</g>
<!-- proposed_input -->
<g id="node9" class="node">
<title>proposed_input</title>
<polygon fill="none" stroke="black" points="88,-409 16,-409 16,-373 88,-373 88,-409"/>
<text text-anchor="middle" x="52" y="-388.5" font-family="Arial" font-size="10.00">Input Tokens</text>
</g>
<!-- proposed_route -->
<g id="node10" class="node">
<title>proposed_route</title>
<ellipse fill="none" stroke="black" cx="180.57" cy="-391" rx="56.64" ry="21.43"/>
<text text-anchor="middle" x="180.57" y="-394" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="180.57" y="-383" font-family="Arial" font-size="10.00">(Cross&#45;Node)</text>
</g>
<!-- proposed_input&#45;&gt;proposed_route -->
<g id="edge11" class="edge">
<title>proposed_input&#45;&gt;proposed_route</title>
<path fill="none" stroke="black" d="M88.26,-391C96.14,-391 104.76,-391 113.44,-391"/>
<polygon fill="black" stroke="black" points="113.63,-394.5 123.63,-391 113.63,-387.5 113.63,-394.5"/>
</g>
<!-- proposed_gpu0 -->
<g id="node11" class="node">
<title>proposed_gpu0</title>
<polygon fill="none" stroke="black" points="353.14,-323.5 273.14,-323.5 273.14,-282.5 353.14,-282.5 353.14,-323.5"/>
<text text-anchor="middle" x="313.14" y="-311.5" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="313.14" y="-300.5" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="313.14" y="-289.5" font-family="Arial" font-size="10.00">No Contention</text>
</g>
<!-- proposed_route&#45;&gt;proposed_gpu0 -->
<g id="edge12" class="edge">
<title>proposed_route&#45;&gt;proposed_gpu0</title>
<path fill="none" stroke="black" d="M208.94,-372.55C227.52,-360.03 252.38,-343.28 273.04,-329.35"/>
<polygon fill="black" stroke="black" points="275.27,-332.07 281.6,-323.58 271.36,-326.26 275.27,-332.07"/>
</g>
<!-- proposed_gpu1 -->
<g id="node12" class="node">
<title>proposed_gpu1</title>
<polygon fill="none" stroke="black" points="353.14,-382.5 273.14,-382.5 273.14,-341.5 353.14,-341.5 353.14,-382.5"/>
<text text-anchor="middle" x="313.14" y="-370.5" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="313.14" y="-359.5" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="313.14" y="-348.5" font-family="Arial" font-size="10.00">No Contention</text>
</g>
<!-- proposed_route&#45;&gt;proposed_gpu1 -->
<g id="edge13" class="edge">
<title>proposed_route&#45;&gt;proposed_gpu1</title>
<path fill="none" stroke="black" d="M229.82,-380.28C240.72,-377.86 252.3,-375.29 263.23,-372.86"/>
<polygon fill="black" stroke="black" points="264.04,-376.27 273.04,-370.68 262.52,-369.43 264.04,-376.27"/>
</g>
<!-- proposed_gpu2 -->
<g id="node13" class="node">
<title>proposed_gpu2</title>
<polygon fill="none" stroke="black" points="353.14,-441.5 273.14,-441.5 273.14,-400.5 353.14,-400.5 353.14,-441.5"/>
<text text-anchor="middle" x="313.14" y="-429.5" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="313.14" y="-418.5" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="313.14" y="-407.5" font-family="Arial" font-size="10.00">No Contention</text>
</g>
<!-- proposed_route&#45;&gt;proposed_gpu2 -->
<g id="edge14" class="edge">
<title>proposed_route&#45;&gt;proposed_gpu2</title>
<path fill="none" stroke="black" d="M229.08,-401.92C240.13,-404.46 251.92,-407.16 263.04,-409.72"/>
<polygon fill="black" stroke="black" points="262.49,-413.19 273.02,-412.01 264.06,-406.36 262.49,-413.19"/>
</g>
<!-- proposed_gpu15 -->
<g id="node14" class="node">
<title>proposed_gpu15</title>
<polygon fill="none" stroke="black" points="353.14,-500.5 273.14,-500.5 273.14,-459.5 353.14,-459.5 353.14,-500.5"/>
<text text-anchor="middle" x="313.14" y="-488.5" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="313.14" y="-477.5" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="313.14" y="-466.5" font-family="Arial" font-size="10.00">No Contention</text>
</g>
<!-- proposed_route&#45;&gt;proposed_gpu15 -->
<g id="edge15" class="edge">
<title>proposed_route&#45;&gt;proposed_gpu15</title>
<path fill="none" stroke="black" d="M208.62,-409.44C227.4,-422.24 252.69,-439.48 273.57,-453.71"/>
<polygon fill="black" stroke="black" points="271.69,-456.66 281.92,-459.41 275.63,-450.88 271.69,-456.66"/>
</g>
<!-- proposed_aggregate -->
<g id="node15" class="node">
<title>proposed_aggregate</title>
<ellipse fill="none" stroke="black" cx="443.58" cy="-391" rx="53.07" ry="21.43"/>
<text text-anchor="middle" x="443.58" y="-394" font-family="Arial" font-size="10.00">Aggregation</text>
<text text-anchor="middle" x="443.58" y="-383" font-family="Arial" font-size="10.00">(Cross&#45;Node)</text>
</g>
<!-- proposed_gpu0&#45;&gt;proposed_aggregate -->
<g id="edge16" class="edge">
<title>proposed_gpu0&#45;&gt;proposed_aggregate</title>
<path fill="none" stroke="black" d="M344.25,-323.63C363.11,-336.55 387.5,-353.26 407.27,-366.81"/>
<polygon fill="black" stroke="black" points="405.49,-369.83 415.71,-372.59 409.44,-364.05 405.49,-369.83"/>
</g>
<!-- proposed_gpu1&#45;&gt;proposed_aggregate -->
<g id="edge17" class="edge">
<title>proposed_gpu1&#45;&gt;proposed_aggregate</title>
<path fill="none" stroke="black" d="M353.37,-370.86C363.99,-373.25 375.68,-375.89 387.01,-378.45"/>
<polygon fill="black" stroke="black" points="386.3,-381.88 396.83,-380.67 387.85,-375.05 386.3,-381.88"/>
</g>
<!-- proposed_gpu2&#45;&gt;proposed_aggregate -->
<g id="edge18" class="edge">
<title>proposed_gpu2&#45;&gt;proposed_aggregate</title>
<path fill="none" stroke="black" d="M353.37,-411.84C364.1,-409.33 375.93,-406.57 387.37,-403.9"/>
<polygon fill="black" stroke="black" points="388.35,-407.26 397.29,-401.58 386.75,-400.45 388.35,-407.26"/>
</g>
<!-- proposed_gpu15&#45;&gt;proposed_aggregate -->
<g id="edge19" class="edge">
<title>proposed_gpu15&#45;&gt;proposed_aggregate</title>
<path fill="none" stroke="black" d="M343.93,-459.36C362.99,-446.15 387.81,-428.96 407.78,-415.12"/>
<polygon fill="black" stroke="black" points="409.78,-417.99 416.01,-409.41 405.8,-412.23 409.78,-417.99"/>
</g>
<!-- proposed_output -->
<g id="node16" class="node">
<title>proposed_output</title>
<polygon fill="none" stroke="black" points="630.03,-409 534.03,-409 534.03,-373 630.03,-373 630.03,-409"/>
<text text-anchor="middle" x="582.03" y="-394" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="582.03" y="-383" font-family="Arial" font-size="10.00">Higher Throughput</text>
</g>
<!-- proposed_aggregate&#45;&gt;proposed_output -->
<g id="edge20" class="edge">
<title>proposed_aggregate&#45;&gt;proposed_output</title>
<path fill="none" stroke="black" d="M496.95,-391C505.7,-391 514.82,-391 523.69,-391"/>
<polygon fill="black" stroke="black" points="523.94,-394.5 533.94,-391 523.94,-387.5 523.94,-394.5"/>
</g>
</g>
</svg>
