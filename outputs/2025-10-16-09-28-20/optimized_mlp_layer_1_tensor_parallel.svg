<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: optimized_mlp_layer_1_tensor_parallel Pages: 1 -->
<svg width="1440pt" height="378pt"
 viewBox="0.00 0.00 1440.00 377.87" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.37 0.37) rotate(0) translate(4 1019)">
<title>optimized_mlp_layer_1_tensor_parallel</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1019 3894.5,-1019 3894.5,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="3503.45,-1015 2752.69,-1015 2559.55,-909 3310.31,-909 3503.45,-1015"/>
<text text-anchor="middle" x="3031.5" y="-973.3" font-family="Times,serif" font-size="14.00">MLP Pipeline Input</text>
<text text-anchor="middle" x="3031.5" y="-958.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="3031.5" y="-943.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- ln -->
<g id="node2" class="node">
<title>ln</title>
<polygon fill="lightyellow" stroke="black" points="2407,-873 1940,-873 1940,-805 2407,-805 2407,-873"/>
<text text-anchor="middle" x="2173.5" y="-857.8" font-family="Times,serif" font-size="14.00">Distributed LayerNorm</text>
<text text-anchor="middle" x="2173.5" y="-842.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="2173.5" y="-827.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="2173.5" y="-812.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- input&#45;&gt;ln -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln</title>
<path fill="none" stroke="black" d="M2662.65,-908.98C2579.74,-897.29 2493.76,-885.17 2417.45,-874.4"/>
<polygon fill="black" stroke="black" points="2417.63,-870.89 2407.23,-872.96 2416.65,-877.82 2417.63,-870.89"/>
</g>
<!-- residual -->
<g id="node22" class="node">
<title>residual</title>
<polygon fill="lightgray" stroke="black" points="3265.5,-83 2797.5,-83 2797.5,0 3265.5,0 3265.5,-83"/>
<text text-anchor="middle" x="3031.5" y="-67.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3031.5" y="-52.8" font-family="Times,serif" font-size="14.00">Input 1: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="3031.5" y="-37.8" font-family="Times,serif" font-size="14.00">Input 2: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="3031.5" y="-22.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="3031.5" y="-7.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- input&#45;&gt;residual -->
<g id="edge36" class="edge">
<title>input&#45;&gt;residual</title>
<path fill="none" stroke="black" d="M3355.33,-933.54C3598.77,-903.63 3890.5,-843.75 3890.5,-728.5 3890.5,-728.5 3890.5,-728.5 3890.5,-331.5 3890.5,-200.97 3529.71,-118.25 3275.78,-76.19"/>
<polygon fill="black" stroke="black" points="3276.09,-72.69 3265.66,-74.52 3274.96,-79.6 3276.09,-72.69"/>
</g>
<!-- fc1_device_8 -->
<g id="node3" class="node">
<title>fc1_device_8</title>
<polygon fill="lightcoral" stroke="black" points="467,-769 0,-769 0,-686 467,-686 467,-769"/>
<text text-anchor="middle" x="233.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Column&#45;Parallel</text>
<text text-anchor="middle" x="233.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 8</text>
<text text-anchor="middle" x="233.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="233.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="233.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ln&#45;&gt;fc1_device_8 -->
<g id="edge2" class="edge">
<title>ln&#45;&gt;fc1_device_8</title>
<path fill="none" stroke="black" d="M1939.72,-837.74C1613.78,-835.29 1004.38,-823.13 477.28,-769.15"/>
<polygon fill="black" stroke="black" points="477.5,-765.65 467.19,-768.11 476.78,-772.62 477.5,-765.65"/>
</g>
<!-- fc1_device_9 -->
<g id="node4" class="node">
<title>fc1_device_9</title>
<polygon fill="lightcoral" stroke="black" points="952,-769 485,-769 485,-686 952,-686 952,-769"/>
<text text-anchor="middle" x="718.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Column&#45;Parallel</text>
<text text-anchor="middle" x="718.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 9</text>
<text text-anchor="middle" x="718.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="718.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="718.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ln&#45;&gt;fc1_device_9 -->
<g id="edge3" class="edge">
<title>ln&#45;&gt;fc1_device_9</title>
<path fill="none" stroke="black" d="M1939.76,-832.26C1697.36,-824.56 1307.34,-807.26 962.14,-769.15"/>
<polygon fill="black" stroke="black" points="962.52,-765.67 952.2,-768.05 961.75,-772.63 962.52,-765.67"/>
</g>
<!-- fc1_device_10 -->
<g id="node5" class="node">
<title>fc1_device_10</title>
<polygon fill="lightcoral" stroke="black" points="1437,-769 970,-769 970,-686 1437,-686 1437,-769"/>
<text text-anchor="middle" x="1203.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Column&#45;Parallel</text>
<text text-anchor="middle" x="1203.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 10</text>
<text text-anchor="middle" x="1203.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1203.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="1203.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ln&#45;&gt;fc1_device_10 -->
<g id="edge4" class="edge">
<title>ln&#45;&gt;fc1_device_10</title>
<path fill="none" stroke="black" d="M1939.83,-820.12C1799.61,-808.35 1617.52,-791.25 1447.37,-769.22"/>
<polygon fill="black" stroke="black" points="1447.58,-765.72 1437.22,-767.9 1446.68,-772.66 1447.58,-765.72"/>
</g>
<!-- fc1_device_11 -->
<g id="node6" class="node">
<title>fc1_device_11</title>
<polygon fill="lightcoral" stroke="black" points="1922,-769 1455,-769 1455,-686 1922,-686 1922,-769"/>
<text text-anchor="middle" x="1688.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Column&#45;Parallel</text>
<text text-anchor="middle" x="1688.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 11</text>
<text text-anchor="middle" x="1688.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1688.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="1688.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ln&#45;&gt;fc1_device_11 -->
<g id="edge5" class="edge">
<title>ln&#45;&gt;fc1_device_11</title>
<path fill="none" stroke="black" d="M2027.33,-805C1980.39,-794.4 1927.7,-782.51 1878.12,-771.31"/>
<polygon fill="black" stroke="black" points="1878.77,-767.87 1868.25,-769.08 1877.23,-774.7 1878.77,-767.87"/>
</g>
<!-- fc1_device_12 -->
<g id="node7" class="node">
<title>fc1_device_12</title>
<polygon fill="lightcoral" stroke="black" points="2407,-769 1940,-769 1940,-686 2407,-686 2407,-769"/>
<text text-anchor="middle" x="2173.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Column&#45;Parallel</text>
<text text-anchor="middle" x="2173.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 12</text>
<text text-anchor="middle" x="2173.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="2173.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="2173.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ln&#45;&gt;fc1_device_12 -->
<g id="edge6" class="edge">
<title>ln&#45;&gt;fc1_device_12</title>
<path fill="none" stroke="black" d="M2173.5,-804.85C2173.5,-796.8 2173.5,-788 2173.5,-779.34"/>
<polygon fill="black" stroke="black" points="2177,-779.28 2173.5,-769.28 2170,-779.28 2177,-779.28"/>
</g>
<!-- fc1_device_13 -->
<g id="node8" class="node">
<title>fc1_device_13</title>
<polygon fill="lightcoral" stroke="black" points="2892,-769 2425,-769 2425,-686 2892,-686 2892,-769"/>
<text text-anchor="middle" x="2658.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Column&#45;Parallel</text>
<text text-anchor="middle" x="2658.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 13</text>
<text text-anchor="middle" x="2658.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="2658.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="2658.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ln&#45;&gt;fc1_device_13 -->
<g id="edge7" class="edge">
<title>ln&#45;&gt;fc1_device_13</title>
<path fill="none" stroke="black" d="M2319.67,-805C2366.61,-794.4 2419.3,-782.51 2468.88,-771.31"/>
<polygon fill="black" stroke="black" points="2469.77,-774.7 2478.75,-769.08 2468.23,-767.87 2469.77,-774.7"/>
</g>
<!-- fc1_device_14 -->
<g id="node9" class="node">
<title>fc1_device_14</title>
<polygon fill="lightcoral" stroke="black" points="3377,-769 2910,-769 2910,-686 3377,-686 3377,-769"/>
<text text-anchor="middle" x="3143.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Column&#45;Parallel</text>
<text text-anchor="middle" x="3143.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 14</text>
<text text-anchor="middle" x="3143.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="3143.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="3143.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ln&#45;&gt;fc1_device_14 -->
<g id="edge8" class="edge">
<title>ln&#45;&gt;fc1_device_14</title>
<path fill="none" stroke="black" d="M2407.17,-820.12C2547.39,-808.35 2729.48,-791.25 2899.63,-769.22"/>
<polygon fill="black" stroke="black" points="2900.32,-772.66 2909.78,-767.9 2899.42,-765.72 2900.32,-772.66"/>
</g>
<!-- fc1_device_15 -->
<g id="node10" class="node">
<title>fc1_device_15</title>
<polygon fill="lightcoral" stroke="black" points="3862,-769 3395,-769 3395,-686 3862,-686 3862,-769"/>
<text text-anchor="middle" x="3628.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Column&#45;Parallel</text>
<text text-anchor="middle" x="3628.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 15</text>
<text text-anchor="middle" x="3628.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="3628.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="3628.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ln&#45;&gt;fc1_device_15 -->
<g id="edge9" class="edge">
<title>ln&#45;&gt;fc1_device_15</title>
<path fill="none" stroke="black" d="M2407.24,-832.26C2649.64,-824.56 3039.66,-807.26 3384.86,-769.15"/>
<polygon fill="black" stroke="black" points="3385.25,-772.63 3394.8,-768.05 3384.48,-765.67 3385.25,-772.63"/>
</g>
<!-- fc1_concat -->
<g id="node11" class="node">
<title>fc1_concat</title>
<polygon fill="lightsteelblue" stroke="black" points="2423.99,-650 1638.96,-650 1437.01,-514 2222.04,-514 2423.99,-650"/>
<text text-anchor="middle" x="1930.5" y="-600.8" font-family="Times,serif" font-size="14.00">Fused Concatenation</text>
<text text-anchor="middle" x="1930.5" y="-585.8" font-family="Times,serif" font-size="14.00">Input: 8×[batch_size=1024, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="1930.5" y="-570.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=32768]</text>
<text text-anchor="middle" x="1930.5" y="-555.8" font-family="Times,serif" font-size="14.00">GPU: all devices</text>
</g>
<!-- fc1_device_8&#45;&gt;fc1_concat -->
<g id="edge10" class="edge">
<title>fc1_device_8&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M467.2,-687.01C469.98,-686.66 472.75,-686.33 475.5,-686 840.2,-642.67 1258.66,-615.38 1552.92,-599.86"/>
<polygon fill="black" stroke="black" points="1553.53,-603.33 1563.33,-599.31 1553.16,-596.34 1553.53,-603.33"/>
</g>
<!-- fc1_device_9&#45;&gt;fc1_concat -->
<g id="edge11" class="edge">
<title>fc1_device_9&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M952.22,-687.15C955,-686.76 957.76,-686.37 960.5,-686 1163.87,-658.21 1392.11,-633.65 1576.08,-615.48"/>
<polygon fill="black" stroke="black" points="1576.58,-618.95 1586.19,-614.49 1575.89,-611.98 1576.58,-618.95"/>
</g>
<!-- fc1_device_10&#45;&gt;fc1_concat -->
<g id="edge12" class="edge">
<title>fc1_device_10&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M1408.91,-685.95C1473.88,-673.13 1547.21,-658.66 1617.92,-644.7"/>
<polygon fill="black" stroke="black" points="1618.75,-648.1 1627.88,-642.73 1617.39,-641.24 1618.75,-648.1"/>
</g>
<!-- fc1_device_11&#45;&gt;fc1_concat -->
<g id="edge13" class="edge">
<title>fc1_device_11&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M1756.88,-685.95C1773.09,-676.34 1790.87,-665.79 1808.68,-655.24"/>
<polygon fill="black" stroke="black" points="1810.6,-658.17 1817.41,-650.06 1807.03,-652.15 1810.6,-658.17"/>
</g>
<!-- fc1_device_12&#45;&gt;fc1_concat -->
<g id="edge14" class="edge">
<title>fc1_device_12&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M2104.84,-685.95C2088.56,-676.34 2070.7,-665.79 2052.82,-655.24"/>
<polygon fill="black" stroke="black" points="2054.44,-652.13 2044.05,-650.06 2050.88,-658.16 2054.44,-652.13"/>
</g>
<!-- fc1_device_13&#45;&gt;fc1_concat -->
<g id="edge15" class="edge">
<title>fc1_device_13&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M2452.8,-685.95C2399.03,-675.36 2339.54,-663.63 2280.54,-652"/>
<polygon fill="black" stroke="black" points="2281.18,-648.56 2270.69,-650.06 2279.82,-655.42 2281.18,-648.56"/>
</g>
<!-- fc1_device_14&#45;&gt;fc1_concat -->
<g id="edge16" class="edge">
<title>fc1_device_14&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M2909.78,-687.14C2907,-686.76 2904.24,-686.37 2901.5,-686 2737.8,-663.64 2558.02,-643.38 2398.11,-626.86"/>
<polygon fill="black" stroke="black" points="2398.4,-623.37 2388.1,-625.82 2397.69,-630.33 2398.4,-623.37"/>
</g>
<!-- fc1_device_15&#45;&gt;fc1_concat -->
<g id="edge17" class="edge">
<title>fc1_device_15&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M3394.8,-687.01C3392.02,-686.66 3389.25,-686.33 3386.5,-686 3043.77,-645.29 2653.6,-618.75 2363.48,-602.81"/>
<polygon fill="black" stroke="black" points="2363.38,-599.3 2353.21,-602.25 2363,-606.29 2363.38,-599.3"/>
</g>
<!-- gelu -->
<g id="node12" class="node">
<title>gelu</title>
<polygon fill="lightyellow" stroke="black" points="2168.5,-478 1692.5,-478 1692.5,-410 2168.5,-410 2168.5,-478"/>
<text text-anchor="middle" x="1930.5" y="-462.8" font-family="Times,serif" font-size="14.00">Distributed GELU</text>
<text text-anchor="middle" x="1930.5" y="-447.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=32768]</text>
<text text-anchor="middle" x="1930.5" y="-432.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=32768]</text>
<text text-anchor="middle" x="1930.5" y="-417.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- fc1_concat&#45;&gt;gelu -->
<g id="edge18" class="edge">
<title>fc1_concat&#45;&gt;gelu</title>
<path fill="none" stroke="black" d="M1930.5,-513.8C1930.5,-505.04 1930.5,-496.28 1930.5,-488.07"/>
<polygon fill="black" stroke="black" points="1934,-488.02 1930.5,-478.02 1927,-488.02 1934,-488.02"/>
</g>
<!-- fc2_device_8 -->
<g id="node13" class="node">
<title>fc2_device_8</title>
<polygon fill="lightcoral" stroke="black" points="467,-374 0,-374 0,-291 467,-291 467,-374"/>
<text text-anchor="middle" x="233.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Row&#45;Parallel</text>
<text text-anchor="middle" x="233.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 8</text>
<text text-anchor="middle" x="233.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="233.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=1024]</text>
<text text-anchor="middle" x="233.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- gelu&#45;&gt;fc2_device_8 -->
<g id="edge19" class="edge">
<title>gelu&#45;&gt;fc2_device_8</title>
<path fill="none" stroke="black" d="M1692.3,-440.35C1405.85,-435.18 910.47,-419.95 477.41,-374.17"/>
<polygon fill="black" stroke="black" points="477.51,-370.66 467.19,-373.08 476.77,-377.62 477.51,-370.66"/>
</g>
<!-- fc2_device_9 -->
<g id="node14" class="node">
<title>fc2_device_9</title>
<polygon fill="lightcoral" stroke="black" points="952,-374 485,-374 485,-291 952,-291 952,-374"/>
<text text-anchor="middle" x="718.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Row&#45;Parallel</text>
<text text-anchor="middle" x="718.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 9</text>
<text text-anchor="middle" x="718.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="718.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=1024]</text>
<text text-anchor="middle" x="718.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- gelu&#45;&gt;fc2_device_9 -->
<g id="edge20" class="edge">
<title>gelu&#45;&gt;fc2_device_9</title>
<path fill="none" stroke="black" d="M1692.22,-432.36C1498.09,-422.2 1216.78,-404.08 962.39,-374.19"/>
<polygon fill="black" stroke="black" points="962.55,-370.69 952.2,-372.99 961.72,-377.64 962.55,-370.69"/>
</g>
<!-- fc2_device_10 -->
<g id="node15" class="node">
<title>fc2_device_10</title>
<polygon fill="lightcoral" stroke="black" points="1437,-374 970,-374 970,-291 1437,-291 1437,-374"/>
<text text-anchor="middle" x="1203.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Row&#45;Parallel</text>
<text text-anchor="middle" x="1203.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 10</text>
<text text-anchor="middle" x="1203.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="1203.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=1024]</text>
<text text-anchor="middle" x="1203.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- gelu&#45;&gt;fc2_device_10 -->
<g id="edge21" class="edge">
<title>gelu&#45;&gt;fc2_device_10</title>
<path fill="none" stroke="black" d="M1692.28,-410.29C1616.64,-399.6 1532.45,-387.39 1447.35,-374.28"/>
<polygon fill="black" stroke="black" points="1447.66,-370.78 1437.24,-372.72 1446.59,-377.7 1447.66,-370.78"/>
</g>
<!-- fc2_device_11 -->
<g id="node16" class="node">
<title>fc2_device_11</title>
<polygon fill="lightcoral" stroke="black" points="1922,-374 1455,-374 1455,-291 1922,-291 1922,-374"/>
<text text-anchor="middle" x="1688.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Row&#45;Parallel</text>
<text text-anchor="middle" x="1688.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 11</text>
<text text-anchor="middle" x="1688.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="1688.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=1024]</text>
<text text-anchor="middle" x="1688.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- gelu&#45;&gt;fc2_device_11 -->
<g id="edge22" class="edge">
<title>gelu&#45;&gt;fc2_device_11</title>
<path fill="none" stroke="black" d="M1857.56,-410C1835.57,-400.05 1811.05,-388.95 1787.66,-378.37"/>
<polygon fill="black" stroke="black" points="1788.96,-375.11 1778.41,-374.18 1786.07,-381.49 1788.96,-375.11"/>
</g>
<!-- fc2_device_12 -->
<g id="node17" class="node">
<title>fc2_device_12</title>
<polygon fill="lightcoral" stroke="black" points="2407,-374 1940,-374 1940,-291 2407,-291 2407,-374"/>
<text text-anchor="middle" x="2173.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Row&#45;Parallel</text>
<text text-anchor="middle" x="2173.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 12</text>
<text text-anchor="middle" x="2173.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="2173.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=1024]</text>
<text text-anchor="middle" x="2173.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- gelu&#45;&gt;fc2_device_12 -->
<g id="edge23" class="edge">
<title>gelu&#45;&gt;fc2_device_12</title>
<path fill="none" stroke="black" d="M2003.74,-410C2025.82,-400.05 2050.44,-388.95 2073.93,-378.37"/>
<polygon fill="black" stroke="black" points="2075.54,-381.48 2083.22,-374.18 2072.67,-375.1 2075.54,-381.48"/>
</g>
<!-- fc2_device_13 -->
<g id="node18" class="node">
<title>fc2_device_13</title>
<polygon fill="lightcoral" stroke="black" points="2892,-374 2425,-374 2425,-291 2892,-291 2892,-374"/>
<text text-anchor="middle" x="2658.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Row&#45;Parallel</text>
<text text-anchor="middle" x="2658.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 13</text>
<text text-anchor="middle" x="2658.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="2658.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=1024]</text>
<text text-anchor="middle" x="2658.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- gelu&#45;&gt;fc2_device_13 -->
<g id="edge24" class="edge">
<title>gelu&#45;&gt;fc2_device_13</title>
<path fill="none" stroke="black" d="M2168.6,-410.4C2244.62,-399.68 2329.32,-387.42 2414.86,-374.24"/>
<polygon fill="black" stroke="black" points="2415.41,-377.7 2424.76,-372.72 2414.34,-370.78 2415.41,-377.7"/>
</g>
<!-- fc2_device_14 -->
<g id="node19" class="node">
<title>fc2_device_14</title>
<polygon fill="lightcoral" stroke="black" points="3377,-374 2910,-374 2910,-291 3377,-291 3377,-374"/>
<text text-anchor="middle" x="3143.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Row&#45;Parallel</text>
<text text-anchor="middle" x="3143.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 14</text>
<text text-anchor="middle" x="3143.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="3143.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=1024]</text>
<text text-anchor="middle" x="3143.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- gelu&#45;&gt;fc2_device_14 -->
<g id="edge25" class="edge">
<title>gelu&#45;&gt;fc2_device_14</title>
<path fill="none" stroke="black" d="M2168.53,-432.4C2362.87,-422.25 2644.74,-404.13 2899.6,-374.2"/>
<polygon fill="black" stroke="black" points="2900.28,-377.64 2909.8,-372.99 2899.45,-370.69 2900.28,-377.64"/>
</g>
<!-- fc2_device_15 -->
<g id="node20" class="node">
<title>fc2_device_15</title>
<polygon fill="lightcoral" stroke="black" points="3862,-374 3395,-374 3395,-291 3862,-291 3862,-374"/>
<text text-anchor="middle" x="3628.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Row&#45;Parallel</text>
<text text-anchor="middle" x="3628.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 15</text>
<text text-anchor="middle" x="3628.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="3628.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=1024]</text>
<text text-anchor="middle" x="3628.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- gelu&#45;&gt;fc2_device_15 -->
<g id="edge26" class="edge">
<title>gelu&#45;&gt;fc2_device_15</title>
<path fill="none" stroke="black" d="M2168.54,-440.36C2455.14,-435.21 2951.07,-419.99 3384.58,-374.17"/>
<polygon fill="black" stroke="black" points="3385.23,-377.62 3394.81,-373.08 3384.49,-370.66 3385.23,-377.62"/>
</g>
<!-- fc2_allreduce -->
<g id="node21" class="node">
<title>fc2_allreduce</title>
<polygon fill="lightsteelblue" stroke="black" points="2666.99,-255 1881.96,-255 1680.01,-119 2465.04,-119 2666.99,-255"/>
<text text-anchor="middle" x="2173.5" y="-205.8" font-family="Times,serif" font-size="14.00">Optimized All&#45;Reduce</text>
<text text-anchor="middle" x="2173.5" y="-190.8" font-family="Times,serif" font-size="14.00">Input: 8×[batch_size=1024, seq_len=10000, embed_dim=1024]</text>
<text text-anchor="middle" x="2173.5" y="-175.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="2173.5" y="-160.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- fc2_device_8&#45;&gt;fc2_allreduce -->
<g id="edge27" class="edge">
<title>fc2_device_8&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M467.2,-291.97C469.98,-291.64 472.75,-291.31 475.5,-291 924.81,-239.92 1444.07,-213.1 1788.88,-199.79"/>
<polygon fill="black" stroke="black" points="1789.17,-203.28 1799.03,-199.4 1788.91,-196.28 1789.17,-203.28"/>
</g>
<!-- fc2_device_9&#45;&gt;fc2_allreduce -->
<g id="edge28" class="edge">
<title>fc2_device_9&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M952.21,-292.06C954.99,-291.7 957.75,-291.35 960.5,-291 1243.32,-255.39 1564.83,-228.71 1805.76,-211.44"/>
<polygon fill="black" stroke="black" points="1806.37,-214.9 1816.09,-210.7 1805.87,-207.92 1806.37,-214.9"/>
</g>
<!-- fc2_device_10&#45;&gt;fc2_allreduce -->
<g id="edge29" class="edge">
<title>fc2_device_10&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M1437.24,-292.28C1440.01,-291.85 1442.76,-291.42 1445.5,-291 1573.55,-271.23 1714.5,-250.95 1837.99,-233.66"/>
<polygon fill="black" stroke="black" points="1838.57,-237.12 1847.99,-232.26 1837.6,-230.18 1838.57,-237.12"/>
</g>
<!-- fc2_device_11&#45;&gt;fc2_allreduce -->
<g id="edge30" class="edge">
<title>fc2_device_11&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M1825.54,-290.95C1860.4,-280.64 1898.87,-269.26 1937.14,-257.93"/>
<polygon fill="black" stroke="black" points="1938.27,-261.25 1946.86,-255.06 1936.28,-254.54 1938.27,-261.25"/>
</g>
<!-- fc2_device_12&#45;&gt;fc2_allreduce -->
<g id="edge31" class="edge">
<title>fc2_device_12&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M2173.5,-290.76C2173.5,-282.78 2173.5,-274.17 2173.5,-265.44"/>
<polygon fill="black" stroke="black" points="2177,-265.17 2173.5,-255.17 2170,-265.17 2177,-265.17"/>
</g>
<!-- fc2_device_13&#45;&gt;fc2_allreduce -->
<g id="edge32" class="edge">
<title>fc2_device_13&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M2521.46,-290.95C2486.6,-280.64 2448.13,-269.26 2409.86,-257.93"/>
<polygon fill="black" stroke="black" points="2410.72,-254.54 2400.14,-255.06 2408.73,-261.25 2410.72,-254.54"/>
</g>
<!-- fc2_device_14&#45;&gt;fc2_allreduce -->
<g id="edge33" class="edge">
<title>fc2_device_14&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M2909.76,-292.28C2906.99,-291.85 2904.24,-291.42 2901.5,-291 2826.64,-279.44 2747.38,-267.71 2669.77,-256.5"/>
<polygon fill="black" stroke="black" points="2670.22,-253.03 2659.82,-255.07 2669.22,-259.96 2670.22,-253.03"/>
</g>
<!-- fc2_device_15&#45;&gt;fc2_allreduce -->
<g id="edge34" class="edge">
<title>fc2_device_15&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M3394.79,-292.06C3392.01,-291.7 3389.25,-291.35 3386.5,-291 3133.52,-259.14 2849.58,-234.44 2620.05,-217.22"/>
<polygon fill="black" stroke="black" points="2620.09,-213.71 2609.85,-216.45 2619.57,-220.69 2620.09,-213.71"/>
</g>
<!-- fc2_allreduce&#45;&gt;residual -->
<g id="edge35" class="edge">
<title>fc2_allreduce&#45;&gt;residual</title>
<path fill="none" stroke="black" d="M2486.9,-133.58C2585.96,-117.02 2693.9,-98.96 2787.37,-83.33"/>
<polygon fill="black" stroke="black" points="2787.95,-86.78 2797.24,-81.68 2786.8,-79.88 2787.95,-86.78"/>
</g>
</g>
</svg>
