<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: optimized_complete_helix_model Pages: 1 -->
<svg width="976pt" height="645pt"
 viewBox="0.00 0.00 976.33 645.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 641)">
<title>optimized_complete_helix_model</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-641 972.33,-641 972.33,4 -4,4"/>
<!-- model_input -->
<g id="node1" class="node">
<title>model_input</title>
<polygon fill="lightgreen" stroke="black" points="956.11,-637 205.35,-637 12.22,-531 762.98,-531 956.11,-637"/>
<text text-anchor="middle" x="484.16" y="-595.3" font-family="Times,serif" font-size="14.00">Model Input</text>
<text text-anchor="middle" x="484.16" y="-580.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="484.16" y="-565.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- stage0_mha -->
<g id="node2" class="node">
<title>stage0_mha</title>
<polygon fill="lightcoral" stroke="black" points="717.66,-494 250.66,-494 250.66,-411 717.66,-411 717.66,-494"/>
<text text-anchor="middle" x="484.16" y="-478.8" font-family="Times,serif" font-size="14.00">Stage 0 &#45; MHA Layer 0 (Optimized)</text>
<text text-anchor="middle" x="484.16" y="-463.8" font-family="Times,serif" font-size="14.00">Pipeline stage with 8&#45;way partitioning</text>
<text text-anchor="middle" x="484.16" y="-448.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="484.16" y="-433.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="484.16" y="-418.8" font-family="Times,serif" font-size="14.00">GPUs: 0&#45;7</text>
</g>
<!-- model_input&#45;&gt;stage0_mha -->
<g id="edge1" class="edge">
<title>model_input&#45;&gt;stage0_mha</title>
<path fill="none" stroke="black" d="M484.16,-530.7C484.16,-521.92 484.16,-512.83 484.16,-504.09"/>
<polygon fill="black" stroke="black" points="487.66,-504.04 484.16,-494.04 480.66,-504.04 487.66,-504.04"/>
</g>
<!-- stage0_mlp -->
<g id="node3" class="node">
<title>stage0_mlp</title>
<polygon fill="lightgreen" stroke="black" points="475.66,-360 8.66,-360 8.66,-277 475.66,-277 475.66,-360"/>
<text text-anchor="middle" x="242.16" y="-344.8" font-family="Times,serif" font-size="14.00">Stage 0 &#45; MLP Layer 0 (Overlapped)</text>
<text text-anchor="middle" x="242.16" y="-329.8" font-family="Times,serif" font-size="14.00">Tensor parallel + pipeline</text>
<text text-anchor="middle" x="242.16" y="-314.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="242.16" y="-299.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="242.16" y="-284.8" font-family="Times,serif" font-size="14.00">GPUs: 0&#45;7</text>
</g>
<!-- stage0_mha&#45;&gt;stage0_mlp -->
<g id="edge2" class="edge">
<title>stage0_mha&#45;&gt;stage0_mlp</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M409.91,-411C383.21,-396.43 352.91,-379.91 325.49,-364.95"/>
<polygon fill="black" stroke="black" points="327.15,-361.87 316.69,-360.15 323.8,-368.01 327.15,-361.87"/>
<text text-anchor="middle" x="420.66" y="-381.8" font-family="Times,serif" font-size="14.00">micro&#45;batch 1</text>
</g>
<!-- stage1_mha -->
<g id="node4" class="node">
<title>stage1_mha</title>
<polygon fill="lightcoral" stroke="black" points="960.66,-360 493.66,-360 493.66,-277 960.66,-277 960.66,-360"/>
<text text-anchor="middle" x="727.16" y="-344.8" font-family="Times,serif" font-size="14.00">Stage 1 &#45; MHA Layer 1 (Optimized)</text>
<text text-anchor="middle" x="727.16" y="-329.8" font-family="Times,serif" font-size="14.00">Pipeline stage with 8&#45;way partitioning</text>
<text text-anchor="middle" x="727.16" y="-314.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="727.16" y="-299.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="727.16" y="-284.8" font-family="Times,serif" font-size="14.00">GPUs: 8&#45;15</text>
</g>
<!-- stage0_mha&#45;&gt;stage1_mha -->
<g id="edge3" class="edge">
<title>stage0_mha&#45;&gt;stage1_mha</title>
<path fill="none" stroke="black" d="M558.72,-411C585.54,-396.43 615.96,-379.91 643.49,-364.95"/>
<polygon fill="black" stroke="black" points="645.21,-368 652.33,-360.15 641.87,-361.85 645.21,-368"/>
<text text-anchor="middle" x="661.66" y="-381.8" font-family="Times,serif" font-size="14.00">micro&#45;batch 0</text>
</g>
<!-- stage1_mlp -->
<g id="node5" class="node">
<title>stage1_mlp</title>
<polygon fill="lightgreen" stroke="black" points="717.66,-226 250.66,-226 250.66,-143 717.66,-143 717.66,-226"/>
<text text-anchor="middle" x="484.16" y="-210.8" font-family="Times,serif" font-size="14.00">Stage 1 &#45; MLP Layer 1 (Overlapped)</text>
<text text-anchor="middle" x="484.16" y="-195.8" font-family="Times,serif" font-size="14.00">Tensor parallel + pipeline</text>
<text text-anchor="middle" x="484.16" y="-180.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="484.16" y="-165.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="484.16" y="-150.8" font-family="Times,serif" font-size="14.00">GPUs: 8&#45;15</text>
</g>
<!-- stage0_mlp&#45;&gt;stage1_mlp -->
<g id="edge4" class="edge">
<title>stage0_mlp&#45;&gt;stage1_mlp</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M316.42,-277C343.12,-262.43 373.41,-245.91 400.84,-230.95"/>
<polygon fill="black" stroke="black" points="402.53,-234.01 409.63,-226.15 399.18,-227.87 402.53,-234.01"/>
<text text-anchor="middle" x="420.66" y="-247.8" font-family="Times,serif" font-size="14.00">micro&#45;batch 1</text>
</g>
<!-- stage1_mha&#45;&gt;stage1_mlp -->
<g id="edge5" class="edge">
<title>stage1_mha&#45;&gt;stage1_mlp</title>
<path fill="none" stroke="black" d="M652.6,-277C625.79,-262.43 595.37,-245.91 567.83,-230.95"/>
<polygon fill="black" stroke="black" points="569.46,-227.85 559,-226.15 566.12,-234 569.46,-227.85"/>
</g>
<!-- model_output -->
<g id="node6" class="node">
<title>model_output</title>
<polygon fill="lightgreen" stroke="black" points="968.49,-106 198.03,-106 -0.16,0 770.29,0 968.49,-106"/>
<text text-anchor="middle" x="484.16" y="-64.3" font-family="Times,serif" font-size="14.00">Model Output</text>
<text text-anchor="middle" x="484.16" y="-49.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="484.16" y="-34.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- stage1_mlp&#45;&gt;model_output -->
<g id="edge6" class="edge">
<title>stage1_mlp&#45;&gt;model_output</title>
<path fill="none" stroke="black" d="M484.16,-142.88C484.16,-134.47 484.16,-125.43 484.16,-116.45"/>
<polygon fill="black" stroke="black" points="487.66,-116.37 484.16,-106.37 480.66,-116.37 487.66,-116.37"/>
</g>
</g>
</svg>
