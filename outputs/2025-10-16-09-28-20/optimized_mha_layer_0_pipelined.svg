<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: optimized_mha_layer_0_pipelined Pages: 1 -->
<svg width="1800pt" height="111pt"
 viewBox="0.00 0.00 1800.00 110.65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.15 0.15) rotate(0) translate(4 720)">
<title>optimized_mha_layer_0_pipelined</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-720 11774,-720 11774,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="9414.95,-716 8664.19,-716 8471.05,-610 9221.81,-610 9414.95,-716"/>
<text text-anchor="middle" x="8943" y="-674.3" font-family="Times,serif" font-size="14.00">Pipeline Input</text>
<text text-anchor="middle" x="8943" y="-659.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="8943" y="-644.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ln -->
<g id="node2" class="node">
<title>ln</title>
<polygon fill="lightyellow" stroke="black" points="6349.5,-574 5882.5,-574 5882.5,-506 6349.5,-506 6349.5,-574"/>
<text text-anchor="middle" x="6116" y="-558.8" font-family="Times,serif" font-size="14.00">Distributed LayerNorm</text>
<text text-anchor="middle" x="6116" y="-543.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="6116" y="-528.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="6116" y="-513.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- input&#45;&gt;ln -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln</title>
<path fill="none" stroke="black" d="M8533.82,-644.49C7936.81,-618.93 6845.39,-572.22 6359.97,-551.44"/>
<polygon fill="black" stroke="black" points="6359.82,-547.93 6349.68,-551 6359.52,-554.93 6359.82,-547.93"/>
</g>
<!-- residual -->
<g id="node36" class="node">
<title>residual</title>
<polygon fill="lightgray" stroke="black" points="9422,-83 8954,-83 8954,0 9422,0 9422,-83"/>
<text text-anchor="middle" x="9188" y="-67.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9188" y="-52.8" font-family="Times,serif" font-size="14.00">Input 1: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="9188" y="-37.8" font-family="Times,serif" font-size="14.00">Input 2: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="9188" y="-22.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="9188" y="-7.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- input&#45;&gt;residual -->
<g id="edge59" class="edge">
<title>input&#45;&gt;residual</title>
<path fill="none" stroke="black" d="M9308.4,-657.47C10023.18,-645.65 11554.11,-604.76 11751,-470 11767.41,-458.77 11770,-449.38 11770,-429.5 11770,-429.5 11770,-429.5 11770,-293.5 11770,-176.79 10076.64,-84.5 9432.6,-53.62"/>
<polygon fill="black" stroke="black" points="9432.42,-50.1 9422.26,-53.12 9432.08,-57.1 9432.42,-50.1"/>
</g>
<!-- q_proj_0 -->
<g id="node3" class="node">
<title>q_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="472,-470 0,-470 0,-387 472,-387 472,-470"/>
<text text-anchor="middle" x="236" y="-454.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="236" y="-439.8" font-family="Times,serif" font-size="14.00">Device 0</text>
<text text-anchor="middle" x="236" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="236" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="236" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ln&#45;&gt;q_proj_0 -->
<g id="edge2" class="edge">
<title>ln&#45;&gt;q_proj_0</title>
<path fill="none" stroke="black" d="M5882.14,-538.23C4891.93,-534.69 1068.73,-518.08 482.29,-470.04"/>
<polygon fill="black" stroke="black" points="482.51,-466.55 472.25,-469.19 481.92,-473.52 482.51,-466.55"/>
</g>
<!-- k_proj_0 -->
<g id="node4" class="node">
<title>k_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="962,-470 490,-470 490,-387 962,-387 962,-470"/>
<text text-anchor="middle" x="726" y="-454.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="726" y="-439.8" font-family="Times,serif" font-size="14.00">Device 0</text>
<text text-anchor="middle" x="726" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="726" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="726" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ln&#45;&gt;k_proj_0 -->
<g id="edge3" class="edge">
<title>ln&#45;&gt;k_proj_0</title>
<path fill="none" stroke="black" d="M5882.15,-537.94C4947.93,-533.41 1508.51,-513.95 972.54,-470.06"/>
<polygon fill="black" stroke="black" points="972.52,-466.55 962.25,-469.18 971.92,-473.52 972.52,-466.55"/>
</g>
<!-- v_proj_0 -->
<g id="node5" class="node">
<title>v_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="1452,-470 980,-470 980,-387 1452,-387 1452,-470"/>
<text text-anchor="middle" x="1216" y="-454.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1216" y="-439.8" font-family="Times,serif" font-size="14.00">Device 0</text>
<text text-anchor="middle" x="1216" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1216" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="1216" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ln&#45;&gt;v_proj_0 -->
<g id="edge4" class="edge">
<title>ln&#45;&gt;v_proj_0</title>
<path fill="none" stroke="black" d="M5882.28,-537.58C5006.82,-531.99 1947.39,-509.84 1462.56,-470.06"/>
<polygon fill="black" stroke="black" points="1462.52,-466.55 1452.26,-469.18 1461.92,-473.52 1462.52,-466.55"/>
</g>
<!-- q_proj_1 -->
<g id="node6" class="node">
<title>q_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="1942,-470 1470,-470 1470,-387 1942,-387 1942,-470"/>
<text text-anchor="middle" x="1706" y="-454.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="1706" y="-439.8" font-family="Times,serif" font-size="14.00">Device 1</text>
<text text-anchor="middle" x="1706" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1706" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="1706" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ln&#45;&gt;q_proj_1 -->
<g id="edge5" class="edge">
<title>ln&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M5882.37,-539.66C5125.28,-541.08 2743.38,-539.82 1952.35,-470.07"/>
<polygon fill="black" stroke="black" points="1952.53,-466.58 1942.26,-469.17 1951.9,-473.55 1952.53,-466.58"/>
</g>
<!-- k_proj_1 -->
<g id="node7" class="node">
<title>k_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="2432,-470 1960,-470 1960,-387 2432,-387 2432,-470"/>
<text text-anchor="middle" x="2196" y="-454.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="2196" y="-439.8" font-family="Times,serif" font-size="14.00">Device 1</text>
<text text-anchor="middle" x="2196" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="2196" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="2196" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ln&#45;&gt;k_proj_1 -->
<g id="edge6" class="edge">
<title>ln&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M5882.39,-539.05C5186.45,-538.49 3133.2,-531.59 2442.33,-470.07"/>
<polygon fill="black" stroke="black" points="2442.53,-466.58 2432.26,-469.16 2441.9,-473.55 2442.53,-466.58"/>
</g>
<!-- v_proj_1 -->
<g id="node8" class="node">
<title>v_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="2922,-470 2450,-470 2450,-387 2922,-387 2922,-470"/>
<text text-anchor="middle" x="2686" y="-454.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="2686" y="-439.8" font-family="Times,serif" font-size="14.00">Device 1</text>
<text text-anchor="middle" x="2686" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="2686" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="2686" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ln&#45;&gt;v_proj_1 -->
<g id="edge7" class="edge">
<title>ln&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M5882.48,-538.25C5252.09,-535.54 3524.14,-523.41 2932.6,-470.1"/>
<polygon fill="black" stroke="black" points="2932.54,-466.58 2922.26,-469.15 2931.9,-473.55 2932.54,-466.58"/>
</g>
<!-- q_proj_2 -->
<g id="node9" class="node">
<title>q_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="3412,-470 2940,-470 2940,-387 3412,-387 3412,-470"/>
<text text-anchor="middle" x="3176" y="-454.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="3176" y="-439.8" font-family="Times,serif" font-size="14.00">Device 2</text>
<text text-anchor="middle" x="3176" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="3176" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="3176" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ln&#45;&gt;q_proj_2 -->
<g id="edge8" class="edge">
<title>ln&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M5882.27,-537.17C5322.28,-532.11 3914.51,-515.27 3422.29,-470.07"/>
<polygon fill="black" stroke="black" points="3422.54,-466.58 3412.26,-469.13 3421.89,-473.55 3422.54,-466.58"/>
</g>
<!-- k_proj_2 -->
<g id="node10" class="node">
<title>k_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="3902,-470 3430,-470 3430,-387 3902,-387 3902,-470"/>
<text text-anchor="middle" x="3666" y="-454.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="3666" y="-439.8" font-family="Times,serif" font-size="14.00">Device 2</text>
<text text-anchor="middle" x="3666" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="3666" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="3666" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ln&#45;&gt;k_proj_2 -->
<g id="edge9" class="edge">
<title>ln&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M5882.16,-535.61C5399.58,-527.97 4306.3,-507.2 3912.29,-470.07"/>
<polygon fill="black" stroke="black" points="3912.55,-466.58 3902.26,-469.11 3911.88,-473.55 3912.55,-466.58"/>
</g>
<!-- v_proj_2 -->
<g id="node11" class="node">
<title>v_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="4392,-470 3920,-470 3920,-387 4392,-387 4392,-470"/>
<text text-anchor="middle" x="4156" y="-454.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4156" y="-439.8" font-family="Times,serif" font-size="14.00">Device 2</text>
<text text-anchor="middle" x="4156" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="4156" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="4156" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ln&#45;&gt;v_proj_2 -->
<g id="edge10" class="edge">
<title>ln&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M5882.34,-538.73C5553.77,-536.29 4936.55,-524.17 4402.49,-470.12"/>
<polygon fill="black" stroke="black" points="4402.57,-466.61 4392.27,-469.07 4401.86,-473.57 4402.57,-466.61"/>
</g>
<!-- q_proj_3 -->
<g id="node12" class="node">
<title>q_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="4882,-470 4410,-470 4410,-387 4882,-387 4882,-470"/>
<text text-anchor="middle" x="4646" y="-454.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4646" y="-439.8" font-family="Times,serif" font-size="14.00">Device 3</text>
<text text-anchor="middle" x="4646" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="4646" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="4646" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ln&#45;&gt;q_proj_3 -->
<g id="edge11" class="edge">
<title>ln&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M5882.25,-533.31C5637.64,-525.62 5242.4,-508.32 4892.35,-470.12"/>
<polygon fill="black" stroke="black" points="4892.59,-466.62 4882.27,-469.01 4891.83,-473.58 4892.59,-466.62"/>
</g>
<!-- k_proj_3 -->
<g id="node13" class="node">
<title>k_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="5372,-470 4900,-470 4900,-387 5372,-387 5372,-470"/>
<text text-anchor="middle" x="5136" y="-454.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5136" y="-439.8" font-family="Times,serif" font-size="14.00">Device 3</text>
<text text-anchor="middle" x="5136" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="5136" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="5136" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ln&#45;&gt;k_proj_3 -->
<g id="edge12" class="edge">
<title>ln&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M5882.17,-521.26C5740.26,-509.48 5555.34,-492.3 5382.35,-470.15"/>
<polygon fill="black" stroke="black" points="5382.66,-466.66 5372.29,-468.85 5381.76,-473.6 5382.66,-466.66"/>
</g>
<!-- v_proj_3 -->
<g id="node14" class="node">
<title>v_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="5862,-470 5390,-470 5390,-387 5862,-387 5862,-470"/>
<text text-anchor="middle" x="5626" y="-454.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5626" y="-439.8" font-family="Times,serif" font-size="14.00">Device 3</text>
<text text-anchor="middle" x="5626" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="5626" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="5626" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ln&#45;&gt;v_proj_3 -->
<g id="edge13" class="edge">
<title>ln&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M5968.32,-506C5920.9,-495.4 5867.67,-483.51 5817.58,-472.31"/>
<polygon fill="black" stroke="black" points="5818.12,-468.85 5807.6,-470.08 5816.6,-475.68 5818.12,-468.85"/>
</g>
<!-- q_proj_4 -->
<g id="node15" class="node">
<title>q_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="6352,-470 5880,-470 5880,-387 6352,-387 6352,-470"/>
<text text-anchor="middle" x="6116" y="-454.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6116" y="-439.8" font-family="Times,serif" font-size="14.00">Device 4</text>
<text text-anchor="middle" x="6116" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="6116" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="6116" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ln&#45;&gt;q_proj_4 -->
<g id="edge14" class="edge">
<title>ln&#45;&gt;q_proj_4</title>
<path fill="none" stroke="black" d="M6116,-505.85C6116,-497.8 6116,-489 6116,-480.34"/>
<polygon fill="black" stroke="black" points="6119.5,-480.28 6116,-470.28 6112.5,-480.28 6119.5,-480.28"/>
</g>
<!-- k_proj_4 -->
<g id="node16" class="node">
<title>k_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="6842,-470 6370,-470 6370,-387 6842,-387 6842,-470"/>
<text text-anchor="middle" x="6606" y="-454.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6606" y="-439.8" font-family="Times,serif" font-size="14.00">Device 4</text>
<text text-anchor="middle" x="6606" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="6606" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="6606" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ln&#45;&gt;k_proj_4 -->
<g id="edge15" class="edge">
<title>ln&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M6263.68,-506C6311.1,-495.4 6364.33,-483.51 6414.42,-472.31"/>
<polygon fill="black" stroke="black" points="6415.4,-475.68 6424.4,-470.08 6413.88,-468.85 6415.4,-475.68"/>
</g>
<!-- v_proj_4 -->
<g id="node17" class="node">
<title>v_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="7332,-470 6860,-470 6860,-387 7332,-387 7332,-470"/>
<text text-anchor="middle" x="7096" y="-454.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7096" y="-439.8" font-family="Times,serif" font-size="14.00">Device 4</text>
<text text-anchor="middle" x="7096" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="7096" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="7096" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ln&#45;&gt;v_proj_4 -->
<g id="edge16" class="edge">
<title>ln&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M6349.83,-521.26C6491.74,-509.48 6676.66,-492.3 6849.65,-470.15"/>
<polygon fill="black" stroke="black" points="6850.24,-473.6 6859.71,-468.85 6849.34,-466.66 6850.24,-473.6"/>
</g>
<!-- q_proj_5 -->
<g id="node18" class="node">
<title>q_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="7822,-470 7350,-470 7350,-387 7822,-387 7822,-470"/>
<text text-anchor="middle" x="7586" y="-454.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7586" y="-439.8" font-family="Times,serif" font-size="14.00">Device 5</text>
<text text-anchor="middle" x="7586" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="7586" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="7586" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ln&#45;&gt;q_proj_5 -->
<g id="edge17" class="edge">
<title>ln&#45;&gt;q_proj_5</title>
<path fill="none" stroke="black" d="M6349.75,-533.31C6594.36,-525.62 6989.6,-508.32 7339.65,-470.12"/>
<polygon fill="black" stroke="black" points="7340.17,-473.58 7349.73,-469.01 7339.41,-466.62 7340.17,-473.58"/>
</g>
<!-- k_proj_5 -->
<g id="node19" class="node">
<title>k_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="8312,-470 7840,-470 7840,-387 8312,-387 8312,-470"/>
<text text-anchor="middle" x="8076" y="-454.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8076" y="-439.8" font-family="Times,serif" font-size="14.00">Device 5</text>
<text text-anchor="middle" x="8076" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="8076" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="8076" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ln&#45;&gt;k_proj_5 -->
<g id="edge18" class="edge">
<title>ln&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M6349.66,-538.73C6678.23,-536.29 7295.45,-524.17 7829.51,-470.12"/>
<polygon fill="black" stroke="black" points="7830.14,-473.57 7839.73,-469.07 7829.43,-466.61 7830.14,-473.57"/>
</g>
<!-- v_proj_5 -->
<g id="node20" class="node">
<title>v_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="8802,-470 8330,-470 8330,-387 8802,-387 8802,-470"/>
<text text-anchor="middle" x="8566" y="-454.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8566" y="-439.8" font-family="Times,serif" font-size="14.00">Device 5</text>
<text text-anchor="middle" x="8566" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="8566" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="8566" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ln&#45;&gt;v_proj_5 -->
<g id="edge19" class="edge">
<title>ln&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M6349.84,-535.61C6832.42,-527.97 7925.7,-507.2 8319.71,-470.07"/>
<polygon fill="black" stroke="black" points="8320.12,-473.55 8329.74,-469.11 8319.45,-466.58 8320.12,-473.55"/>
</g>
<!-- q_proj_6 -->
<g id="node21" class="node">
<title>q_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="9292,-470 8820,-470 8820,-387 9292,-387 9292,-470"/>
<text text-anchor="middle" x="9056" y="-454.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="9056" y="-439.8" font-family="Times,serif" font-size="14.00">Device 6</text>
<text text-anchor="middle" x="9056" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="9056" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="9056" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ln&#45;&gt;q_proj_6 -->
<g id="edge20" class="edge">
<title>ln&#45;&gt;q_proj_6</title>
<path fill="none" stroke="black" d="M6349.73,-537.17C6909.72,-532.11 8317.49,-515.27 8809.71,-470.07"/>
<polygon fill="black" stroke="black" points="8810.11,-473.55 8819.74,-469.13 8809.46,-466.58 8810.11,-473.55"/>
</g>
<!-- k_proj_6 -->
<g id="node22" class="node">
<title>k_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="9782,-470 9310,-470 9310,-387 9782,-387 9782,-470"/>
<text text-anchor="middle" x="9546" y="-454.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="9546" y="-439.8" font-family="Times,serif" font-size="14.00">Device 6</text>
<text text-anchor="middle" x="9546" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="9546" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="9546" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ln&#45;&gt;k_proj_6 -->
<g id="edge21" class="edge">
<title>ln&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M6349.52,-538.25C6979.91,-535.54 8707.86,-523.41 9299.4,-470.1"/>
<polygon fill="black" stroke="black" points="9300.1,-473.55 9309.74,-469.15 9299.46,-466.58 9300.1,-473.55"/>
</g>
<!-- v_proj_6 -->
<g id="node23" class="node">
<title>v_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="10272,-470 9800,-470 9800,-387 10272,-387 10272,-470"/>
<text text-anchor="middle" x="10036" y="-454.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="10036" y="-439.8" font-family="Times,serif" font-size="14.00">Device 6</text>
<text text-anchor="middle" x="10036" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="10036" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="10036" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ln&#45;&gt;v_proj_6 -->
<g id="edge22" class="edge">
<title>ln&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M6349.61,-539.05C7045.55,-538.49 9098.8,-531.59 9789.67,-470.07"/>
<polygon fill="black" stroke="black" points="9790.1,-473.55 9799.74,-469.16 9789.47,-466.58 9790.1,-473.55"/>
</g>
<!-- q_proj_7 -->
<g id="node24" class="node">
<title>q_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="10762,-470 10290,-470 10290,-387 10762,-387 10762,-470"/>
<text text-anchor="middle" x="10526" y="-454.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="10526" y="-439.8" font-family="Times,serif" font-size="14.00">Device 7</text>
<text text-anchor="middle" x="10526" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="10526" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="10526" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ln&#45;&gt;q_proj_7 -->
<g id="edge23" class="edge">
<title>ln&#45;&gt;q_proj_7</title>
<path fill="none" stroke="black" d="M6349.63,-539.66C7106.72,-541.08 9488.62,-539.82 10279.65,-470.07"/>
<polygon fill="black" stroke="black" points="10280.1,-473.55 10289.74,-469.17 10279.47,-466.58 10280.1,-473.55"/>
</g>
<!-- k_proj_7 -->
<g id="node25" class="node">
<title>k_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="11252,-470 10780,-470 10780,-387 11252,-387 11252,-470"/>
<text text-anchor="middle" x="11016" y="-454.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="11016" y="-439.8" font-family="Times,serif" font-size="14.00">Device 7</text>
<text text-anchor="middle" x="11016" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="11016" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="11016" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ln&#45;&gt;k_proj_7 -->
<g id="edge24" class="edge">
<title>ln&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M6349.72,-537.58C7225.18,-531.99 10284.61,-509.84 10769.44,-470.06"/>
<polygon fill="black" stroke="black" points="10770.08,-473.52 10779.74,-469.18 10769.48,-466.55 10770.08,-473.52"/>
</g>
<!-- v_proj_7 -->
<g id="node26" class="node">
<title>v_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="11742,-470 11270,-470 11270,-387 11742,-387 11742,-470"/>
<text text-anchor="middle" x="11506" y="-454.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="11506" y="-439.8" font-family="Times,serif" font-size="14.00">Device 7</text>
<text text-anchor="middle" x="11506" y="-424.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="11506" y="-409.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="11506" y="-394.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ln&#45;&gt;v_proj_7 -->
<g id="edge25" class="edge">
<title>ln&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M6349.85,-537.94C7284.07,-533.41 10723.49,-513.95 11259.46,-470.06"/>
<polygon fill="black" stroke="black" points="11260.08,-473.52 11269.75,-469.18 11259.48,-466.55 11260.08,-473.52"/>
</g>
<!-- attn_0 -->
<g id="node27" class="node">
<title>attn_0</title>
<polygon fill="lightpink" stroke="black" points="1207,-351 735,-351 735,-238 1207,-238 1207,-351"/>
<text text-anchor="middle" x="971" y="-335.8" font-family="Times,serif" font-size="14.00">Fused Attention</text>
<text text-anchor="middle" x="971" y="-320.8" font-family="Times,serif" font-size="14.00">Device 0</text>
<text text-anchor="middle" x="971" y="-305.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="971" y="-290.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="971" y="-275.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="971" y="-260.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="971" y="-245.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- q_proj_0&#45;&gt;attn_0 -->
<g id="edge26" class="edge">
<title>q_proj_0&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M461.52,-387C544.83,-372.04 639.65,-355.01 724.71,-339.73"/>
<polygon fill="black" stroke="black" points="725.55,-343.14 734.77,-337.93 724.31,-336.25 725.55,-343.14"/>
</g>
<!-- k_proj_0&#45;&gt;attn_0 -->
<g id="edge27" class="edge">
<title>k_proj_0&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M801.17,-387C819.35,-377.21 839.17,-366.53 858.64,-356.04"/>
<polygon fill="black" stroke="black" points="860.41,-359.06 867.55,-351.23 857.09,-352.9 860.41,-359.06"/>
</g>
<!-- v_proj_0&#45;&gt;attn_0 -->
<g id="edge28" class="edge">
<title>v_proj_0&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M1140.83,-387C1122.65,-377.21 1102.83,-366.53 1083.36,-356.04"/>
<polygon fill="black" stroke="black" points="1084.91,-352.9 1074.45,-351.23 1081.59,-359.06 1084.91,-352.9"/>
</g>
<!-- attn_1 -->
<g id="node28" class="node">
<title>attn_1</title>
<polygon fill="lightpink" stroke="black" points="2677,-351 2205,-351 2205,-238 2677,-238 2677,-351"/>
<text text-anchor="middle" x="2441" y="-335.8" font-family="Times,serif" font-size="14.00">Fused Attention</text>
<text text-anchor="middle" x="2441" y="-320.8" font-family="Times,serif" font-size="14.00">Device 1</text>
<text text-anchor="middle" x="2441" y="-305.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="2441" y="-290.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="2441" y="-275.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="2441" y="-260.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="2441" y="-245.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- q_proj_1&#45;&gt;attn_1 -->
<g id="edge29" class="edge">
<title>q_proj_1&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M1931.52,-387C2014.83,-372.04 2109.65,-355.01 2194.71,-339.73"/>
<polygon fill="black" stroke="black" points="2195.55,-343.14 2204.77,-337.93 2194.31,-336.25 2195.55,-343.14"/>
</g>
<!-- k_proj_1&#45;&gt;attn_1 -->
<g id="edge30" class="edge">
<title>k_proj_1&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M2271.17,-387C2289.35,-377.21 2309.17,-366.53 2328.64,-356.04"/>
<polygon fill="black" stroke="black" points="2330.41,-359.06 2337.55,-351.23 2327.09,-352.9 2330.41,-359.06"/>
</g>
<!-- v_proj_1&#45;&gt;attn_1 -->
<g id="edge31" class="edge">
<title>v_proj_1&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M2610.83,-387C2592.65,-377.21 2572.83,-366.53 2553.36,-356.04"/>
<polygon fill="black" stroke="black" points="2554.91,-352.9 2544.45,-351.23 2551.59,-359.06 2554.91,-352.9"/>
</g>
<!-- attn_2 -->
<g id="node29" class="node">
<title>attn_2</title>
<polygon fill="lightpink" stroke="black" points="4147,-351 3675,-351 3675,-238 4147,-238 4147,-351"/>
<text text-anchor="middle" x="3911" y="-335.8" font-family="Times,serif" font-size="14.00">Fused Attention</text>
<text text-anchor="middle" x="3911" y="-320.8" font-family="Times,serif" font-size="14.00">Device 2</text>
<text text-anchor="middle" x="3911" y="-305.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="3911" y="-290.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="3911" y="-275.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="3911" y="-260.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="3911" y="-245.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- q_proj_2&#45;&gt;attn_2 -->
<g id="edge32" class="edge">
<title>q_proj_2&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M3401.52,-387C3484.83,-372.04 3579.65,-355.01 3664.71,-339.73"/>
<polygon fill="black" stroke="black" points="3665.55,-343.14 3674.77,-337.93 3664.31,-336.25 3665.55,-343.14"/>
</g>
<!-- k_proj_2&#45;&gt;attn_2 -->
<g id="edge33" class="edge">
<title>k_proj_2&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M3741.17,-387C3759.35,-377.21 3779.17,-366.53 3798.64,-356.04"/>
<polygon fill="black" stroke="black" points="3800.41,-359.06 3807.55,-351.23 3797.09,-352.9 3800.41,-359.06"/>
</g>
<!-- v_proj_2&#45;&gt;attn_2 -->
<g id="edge34" class="edge">
<title>v_proj_2&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M4080.83,-387C4062.65,-377.21 4042.83,-366.53 4023.36,-356.04"/>
<polygon fill="black" stroke="black" points="4024.91,-352.9 4014.45,-351.23 4021.59,-359.06 4024.91,-352.9"/>
</g>
<!-- attn_3 -->
<g id="node30" class="node">
<title>attn_3</title>
<polygon fill="lightpink" stroke="black" points="5617,-351 5145,-351 5145,-238 5617,-238 5617,-351"/>
<text text-anchor="middle" x="5381" y="-335.8" font-family="Times,serif" font-size="14.00">Fused Attention</text>
<text text-anchor="middle" x="5381" y="-320.8" font-family="Times,serif" font-size="14.00">Device 3</text>
<text text-anchor="middle" x="5381" y="-305.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="5381" y="-290.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="5381" y="-275.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="5381" y="-260.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="5381" y="-245.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- q_proj_3&#45;&gt;attn_3 -->
<g id="edge35" class="edge">
<title>q_proj_3&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M4871.52,-387C4954.83,-372.04 5049.65,-355.01 5134.71,-339.73"/>
<polygon fill="black" stroke="black" points="5135.55,-343.14 5144.77,-337.93 5134.31,-336.25 5135.55,-343.14"/>
</g>
<!-- k_proj_3&#45;&gt;attn_3 -->
<g id="edge36" class="edge">
<title>k_proj_3&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M5211.17,-387C5229.35,-377.21 5249.17,-366.53 5268.64,-356.04"/>
<polygon fill="black" stroke="black" points="5270.41,-359.06 5277.55,-351.23 5267.09,-352.9 5270.41,-359.06"/>
</g>
<!-- v_proj_3&#45;&gt;attn_3 -->
<g id="edge37" class="edge">
<title>v_proj_3&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M5550.83,-387C5532.65,-377.21 5512.83,-366.53 5493.36,-356.04"/>
<polygon fill="black" stroke="black" points="5494.91,-352.9 5484.45,-351.23 5491.59,-359.06 5494.91,-352.9"/>
</g>
<!-- attn_4 -->
<g id="node31" class="node">
<title>attn_4</title>
<polygon fill="lightpink" stroke="black" points="6842,-351 6370,-351 6370,-238 6842,-238 6842,-351"/>
<text text-anchor="middle" x="6606" y="-335.8" font-family="Times,serif" font-size="14.00">Fused Attention</text>
<text text-anchor="middle" x="6606" y="-320.8" font-family="Times,serif" font-size="14.00">Device 4</text>
<text text-anchor="middle" x="6606" y="-305.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="6606" y="-290.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="6606" y="-275.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="6606" y="-260.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="6606" y="-245.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- q_proj_4&#45;&gt;attn_4 -->
<g id="edge38" class="edge">
<title>q_proj_4&#45;&gt;attn_4</title>
<path fill="none" stroke="black" d="M6266.35,-387C6305.36,-376.49 6348.17,-364.96 6389.84,-353.73"/>
<polygon fill="black" stroke="black" points="6390.81,-357.09 6399.56,-351.11 6388.99,-350.33 6390.81,-357.09"/>
</g>
<!-- k_proj_4&#45;&gt;attn_4 -->
<g id="edge39" class="edge">
<title>k_proj_4&#45;&gt;attn_4</title>
<path fill="none" stroke="black" d="M6606,-386.82C6606,-378.76 6606,-370.11 6606,-361.46"/>
<polygon fill="black" stroke="black" points="6609.5,-361.34 6606,-351.34 6602.5,-361.34 6609.5,-361.34"/>
</g>
<!-- v_proj_4&#45;&gt;attn_4 -->
<g id="edge40" class="edge">
<title>v_proj_4&#45;&gt;attn_4</title>
<path fill="none" stroke="black" d="M6945.65,-387C6906.64,-376.49 6863.83,-364.96 6822.16,-353.73"/>
<polygon fill="black" stroke="black" points="6823.01,-350.33 6812.44,-351.11 6821.19,-357.09 6823.01,-350.33"/>
</g>
<!-- attn_5 -->
<g id="node32" class="node">
<title>attn_5</title>
<polygon fill="lightpink" stroke="black" points="8067,-351 7595,-351 7595,-238 8067,-238 8067,-351"/>
<text text-anchor="middle" x="7831" y="-335.8" font-family="Times,serif" font-size="14.00">Fused Attention</text>
<text text-anchor="middle" x="7831" y="-320.8" font-family="Times,serif" font-size="14.00">Device 5</text>
<text text-anchor="middle" x="7831" y="-305.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="7831" y="-290.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="7831" y="-275.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="7831" y="-260.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="7831" y="-245.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- q_proj_5&#45;&gt;attn_5 -->
<g id="edge41" class="edge">
<title>q_proj_5&#45;&gt;attn_5</title>
<path fill="none" stroke="black" d="M7661.17,-387C7679.35,-377.21 7699.17,-366.53 7718.64,-356.04"/>
<polygon fill="black" stroke="black" points="7720.41,-359.06 7727.55,-351.23 7717.09,-352.9 7720.41,-359.06"/>
</g>
<!-- k_proj_5&#45;&gt;attn_5 -->
<g id="edge42" class="edge">
<title>k_proj_5&#45;&gt;attn_5</title>
<path fill="none" stroke="black" d="M8000.83,-387C7982.65,-377.21 7962.83,-366.53 7943.36,-356.04"/>
<polygon fill="black" stroke="black" points="7944.91,-352.9 7934.45,-351.23 7941.59,-359.06 7944.91,-352.9"/>
</g>
<!-- v_proj_5&#45;&gt;attn_5 -->
<g id="edge43" class="edge">
<title>v_proj_5&#45;&gt;attn_5</title>
<path fill="none" stroke="black" d="M8340.48,-387C8257.17,-372.04 8162.35,-355.01 8077.29,-339.73"/>
<polygon fill="black" stroke="black" points="8077.69,-336.25 8067.23,-337.93 8076.45,-343.14 8077.69,-336.25"/>
</g>
<!-- attn_6 -->
<g id="node33" class="node">
<title>attn_6</title>
<polygon fill="lightpink" stroke="black" points="9537,-351 9065,-351 9065,-238 9537,-238 9537,-351"/>
<text text-anchor="middle" x="9301" y="-335.8" font-family="Times,serif" font-size="14.00">Fused Attention</text>
<text text-anchor="middle" x="9301" y="-320.8" font-family="Times,serif" font-size="14.00">Device 6</text>
<text text-anchor="middle" x="9301" y="-305.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="9301" y="-290.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="9301" y="-275.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="9301" y="-260.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="9301" y="-245.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- q_proj_6&#45;&gt;attn_6 -->
<g id="edge44" class="edge">
<title>q_proj_6&#45;&gt;attn_6</title>
<path fill="none" stroke="black" d="M9131.17,-387C9149.35,-377.21 9169.17,-366.53 9188.64,-356.04"/>
<polygon fill="black" stroke="black" points="9190.41,-359.06 9197.55,-351.23 9187.09,-352.9 9190.41,-359.06"/>
</g>
<!-- k_proj_6&#45;&gt;attn_6 -->
<g id="edge45" class="edge">
<title>k_proj_6&#45;&gt;attn_6</title>
<path fill="none" stroke="black" d="M9470.83,-387C9452.65,-377.21 9432.83,-366.53 9413.36,-356.04"/>
<polygon fill="black" stroke="black" points="9414.91,-352.9 9404.45,-351.23 9411.59,-359.06 9414.91,-352.9"/>
</g>
<!-- v_proj_6&#45;&gt;attn_6 -->
<g id="edge46" class="edge">
<title>v_proj_6&#45;&gt;attn_6</title>
<path fill="none" stroke="black" d="M9810.48,-387C9727.17,-372.04 9632.35,-355.01 9547.29,-339.73"/>
<polygon fill="black" stroke="black" points="9547.69,-336.25 9537.23,-337.93 9546.45,-343.14 9547.69,-336.25"/>
</g>
<!-- attn_7 -->
<g id="node34" class="node">
<title>attn_7</title>
<polygon fill="lightpink" stroke="black" points="11007,-351 10535,-351 10535,-238 11007,-238 11007,-351"/>
<text text-anchor="middle" x="10771" y="-335.8" font-family="Times,serif" font-size="14.00">Fused Attention</text>
<text text-anchor="middle" x="10771" y="-320.8" font-family="Times,serif" font-size="14.00">Device 7</text>
<text text-anchor="middle" x="10771" y="-305.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="10771" y="-290.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="10771" y="-275.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="10771" y="-260.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=8, d_v=128]</text>
<text text-anchor="middle" x="10771" y="-245.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- q_proj_7&#45;&gt;attn_7 -->
<g id="edge47" class="edge">
<title>q_proj_7&#45;&gt;attn_7</title>
<path fill="none" stroke="black" d="M10601.17,-387C10619.35,-377.21 10639.17,-366.53 10658.64,-356.04"/>
<polygon fill="black" stroke="black" points="10660.41,-359.06 10667.55,-351.23 10657.09,-352.9 10660.41,-359.06"/>
</g>
<!-- k_proj_7&#45;&gt;attn_7 -->
<g id="edge48" class="edge">
<title>k_proj_7&#45;&gt;attn_7</title>
<path fill="none" stroke="black" d="M10940.83,-387C10922.65,-377.21 10902.83,-366.53 10883.36,-356.04"/>
<polygon fill="black" stroke="black" points="10884.91,-352.9 10874.45,-351.23 10881.59,-359.06 10884.91,-352.9"/>
</g>
<!-- v_proj_7&#45;&gt;attn_7 -->
<g id="edge49" class="edge">
<title>v_proj_7&#45;&gt;attn_7</title>
<path fill="none" stroke="black" d="M11280.48,-387C11197.17,-372.04 11102.35,-355.01 11017.29,-339.73"/>
<polygon fill="black" stroke="black" points="11017.69,-336.25 11007.23,-337.93 11016.45,-343.14 11017.69,-336.25"/>
</g>
<!-- output_proj -->
<g id="node35" class="node">
<title>output_proj</title>
<polygon fill="lightcoral" stroke="black" points="6839.5,-202 6372.5,-202 6372.5,-119 6839.5,-119 6839.5,-202"/>
<text text-anchor="middle" x="6606" y="-186.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6606" y="-171.8" font-family="Times,serif" font-size="14.00">Tensor Parallel w/ All&#45;Reduce</text>
<text text-anchor="middle" x="6606" y="-156.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="6606" y="-141.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="6606" y="-126.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- attn_0&#45;&gt;output_proj -->
<g id="edge50" class="edge">
<title>attn_0&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M1207.19,-280.84C1453.84,-268.08 1851.95,-248.78 2196,-238 3784.08,-188.26 5694.94,-168.89 6362.06,-163.34"/>
<polygon fill="black" stroke="black" points="6362.3,-166.84 6372.27,-163.26 6362.24,-159.84 6362.3,-166.84"/>
</g>
<!-- attn_1&#45;&gt;output_proj -->
<g id="edge51" class="edge">
<title>attn_1&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M2677.21,-281.45C2923.87,-269.18 3322,-250.27 3666,-238 4665.93,-202.34 5857.74,-176.45 6361.74,-166.27"/>
<polygon fill="black" stroke="black" points="6362.12,-169.76 6372.05,-166.06 6361.98,-162.76 6362.12,-169.76"/>
</g>
<!-- attn_2&#45;&gt;output_proj -->
<g id="edge52" class="edge">
<title>attn_2&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M4147.21,-281.93C4655.31,-257.04 5847.61,-198.65 6362.33,-173.43"/>
<polygon fill="black" stroke="black" points="6362.67,-176.92 6372.49,-172.94 6362.33,-169.93 6362.67,-176.92"/>
</g>
<!-- attn_3&#45;&gt;output_proj -->
<g id="edge53" class="edge">
<title>attn_3&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M5617.19,-268.05C5831.32,-244.98 6145.63,-211.11 6362.12,-187.78"/>
<polygon fill="black" stroke="black" points="6362.79,-191.23 6372.35,-186.68 6362.04,-184.27 6362.79,-191.23"/>
</g>
<!-- attn_4&#45;&gt;output_proj -->
<g id="edge54" class="edge">
<title>attn_4&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M6606,-237.9C6606,-229.39 6606,-220.63 6606,-212.23"/>
<polygon fill="black" stroke="black" points="6609.5,-212.19 6606,-202.19 6602.5,-212.19 6609.5,-212.19"/>
</g>
<!-- attn_5&#45;&gt;output_proj -->
<g id="edge55" class="edge">
<title>attn_5&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M7594.81,-268.05C7380.68,-244.98 7066.37,-211.11 6849.88,-187.78"/>
<polygon fill="black" stroke="black" points="6849.96,-184.27 6839.65,-186.68 6849.21,-191.23 6849.96,-184.27"/>
</g>
<!-- attn_6&#45;&gt;output_proj -->
<g id="edge56" class="edge">
<title>attn_6&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M9064.79,-281.93C8556.69,-257.04 7364.39,-198.65 6849.67,-173.43"/>
<polygon fill="black" stroke="black" points="6849.67,-169.93 6839.51,-172.94 6849.33,-176.92 6849.67,-169.93"/>
</g>
<!-- attn_7&#45;&gt;output_proj -->
<g id="edge57" class="edge">
<title>attn_7&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M10534.79,-281.45C10288.13,-269.18 9890,-250.27 9546,-238 8546.07,-202.34 7354.26,-176.45 6850.26,-166.27"/>
<polygon fill="black" stroke="black" points="6850.02,-162.76 6839.95,-166.06 6849.88,-169.76 6850.02,-162.76"/>
</g>
<!-- output_proj&#45;&gt;residual -->
<g id="edge58" class="edge">
<title>output_proj&#45;&gt;residual</title>
<path fill="none" stroke="black" d="M6839.69,-148.91C7326.99,-126.83 8447.46,-76.06 8943.75,-53.57"/>
<polygon fill="black" stroke="black" points="8944.08,-57.06 8953.91,-53.11 8943.76,-50.06 8944.08,-57.06"/>
</g>
</g>
</svg>
