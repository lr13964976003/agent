<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_layer_wise Pages: 1 -->
<svg width="6723pt" height="2270pt"
 viewBox="0.00 0.00 6722.50 2269.86" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2265.86)">
<title>proposed_layer_wise</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2265.86 6718.5,-2265.86 6718.5,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer0_gpu0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="881.5,-400.91 881.5,-2178.91 3345.5,-2178.91 3345.5,-400.91 881.5,-400.91"/>
<text text-anchor="middle" x="2113.5" y="-2163.71" font-family="Times,serif" font-size="14.00">Layer 0 &#45; GPU 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer1_gpu1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="83.5,-153.74 83.5,-268.74 3113.5,-268.74 3113.5,-153.74 83.5,-153.74"/>
<text text-anchor="middle" x="1598.5" y="-253.54" font-family="Times,serif" font-size="14.00">Layer 1 &#45; GPU 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer15_gpu15</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3668.5,-1956.91 3668.5,-2071.91 6706.5,-2071.91 6706.5,-1956.91 3668.5,-1956.91"/>
<text text-anchor="middle" x="5187.5" y="-2056.71" font-family="Times,serif" font-size="14.00">Layer 15 &#45; GPU 15</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="2599.5" cy="-2224.38" rx="322.38" ry="37.45"/>
<text text-anchor="middle" x="2599.5" y="-2235.68" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="2599.5" y="-2220.68" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2599.5" y="-2205.68" font-family="Times,serif" font-size="14.00">GPU: Host</text>
</g>
<!-- q_linear0 -->
<g id="node2" class="node">
<title>q_linear0</title>
<polygon fill="none" stroke="black" points="2600.5,-2147.91 2132.5,-2147.91 2132.5,-2079.91 2600.5,-2079.91 2600.5,-2147.91"/>
<text text-anchor="middle" x="2366.5" y="-2132.71" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="2366.5" y="-2117.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2366.5" y="-2102.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2366.5" y="-2087.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;q_linear0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;q_linear0</title>
<path fill="none" stroke="black" d="M2523.21,-2187.86C2498.73,-2176.47 2471.55,-2163.81 2446.79,-2152.29"/>
<polygon fill="black" stroke="black" points="2447.98,-2148.98 2437.44,-2147.93 2445.02,-2155.33 2447.98,-2148.98"/>
</g>
<!-- k_linear0 -->
<g id="node3" class="node">
<title>k_linear0</title>
<polygon fill="none" stroke="black" points="1631.5,-2147.91 1163.5,-2147.91 1163.5,-2079.91 1631.5,-2079.91 1631.5,-2147.91"/>
<text text-anchor="middle" x="1397.5" y="-2132.71" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="1397.5" y="-2117.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1397.5" y="-2102.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1397.5" y="-2087.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;k_linear0 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;k_linear0</title>
<path fill="none" stroke="black" d="M2348.98,-2200.78C2141.25,-2182.03 1847.64,-2155.53 1641.67,-2136.94"/>
<polygon fill="black" stroke="black" points="1641.9,-2133.45 1631.62,-2136.04 1641.27,-2140.42 1641.9,-2133.45"/>
</g>
<!-- v_linear0 -->
<g id="node4" class="node">
<title>v_linear0</title>
<polygon fill="none" stroke="black" points="3337.5,-1894.91 2869.5,-1894.91 2869.5,-1826.91 3337.5,-1826.91 3337.5,-1894.91"/>
<text text-anchor="middle" x="3103.5" y="-1879.71" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="3103.5" y="-1864.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="3103.5" y="-1849.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="3103.5" y="-1834.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;v_linear0 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;v_linear0</title>
<path fill="none" stroke="black" d="M2650.13,-2187.07C2745.46,-2118.7 2950.79,-1971.44 3049,-1900.99"/>
<polygon fill="black" stroke="black" points="3051.22,-1903.71 3057.31,-1895.03 3047.14,-1898.02 3051.22,-1903.71"/>
</g>
<!-- residual_attn0 -->
<g id="node16" class="node">
<title>residual_attn0</title>
<polygon fill="none" stroke="black" points="3276.5,-1100.91 2798.5,-1100.91 2798.5,-1032.91 3276.5,-1032.91 3276.5,-1100.91"/>
<text text-anchor="middle" x="3037.5" y="-1085.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3037.5" y="-1070.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192] x2</text>
<text text-anchor="middle" x="3037.5" y="-1055.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="3037.5" y="-1040.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;residual_attn0 -->
<g id="edge18" class="edge">
<title>input&#45;&gt;residual_attn0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2845.82,-2200.13C3069.78,-2171.96 3365.5,-2113.93 3365.5,-2003.91 3365.5,-2003.91 3365.5,-2003.91 3365.5,-1307.91 3365.5,-1203.7 3256.35,-1139.86 3163.98,-1104.48"/>
<polygon fill="black" stroke="black" points="3165.12,-1101.17 3154.53,-1100.94 3162.66,-1107.73 3165.12,-1101.17"/>
</g>
<!-- reshape_q0 -->
<g id="node5" class="node">
<title>reshape_q0</title>
<polygon fill="none" stroke="black" points="2607,-2036.91 2126,-2036.91 2126,-1968.91 2607,-1968.91 2607,-2036.91"/>
<text text-anchor="middle" x="2366.5" y="-2021.71" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="2366.5" y="-2006.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2366.5" y="-1991.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2366.5" y="-1976.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- q_linear0&#45;&gt;reshape_q0 -->
<g id="edge4" class="edge">
<title>q_linear0&#45;&gt;reshape_q0</title>
<path fill="none" stroke="black" d="M2366.5,-2079.61C2366.5,-2069.36 2366.5,-2057.93 2366.5,-2047.12"/>
<polygon fill="black" stroke="black" points="2370,-2047 2366.5,-2037 2363,-2047 2370,-2047"/>
</g>
<!-- reshape_k0 -->
<g id="node6" class="node">
<title>reshape_k0</title>
<polygon fill="none" stroke="black" points="1627,-2036.91 1146,-2036.91 1146,-1968.91 1627,-1968.91 1627,-2036.91"/>
<text text-anchor="middle" x="1386.5" y="-2021.71" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="1386.5" y="-2006.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1386.5" y="-1991.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="1386.5" y="-1976.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- k_linear0&#45;&gt;reshape_k0 -->
<g id="edge5" class="edge">
<title>k_linear0&#45;&gt;reshape_k0</title>
<path fill="none" stroke="black" d="M1394.14,-2079.61C1393.11,-2069.36 1391.95,-2057.93 1390.86,-2047.12"/>
<polygon fill="black" stroke="black" points="1394.33,-2046.6 1389.84,-2037 1387.36,-2047.3 1394.33,-2046.6"/>
</g>
<!-- reshape_v0 -->
<g id="node7" class="node">
<title>reshape_v0</title>
<polygon fill="none" stroke="black" points="3215,-1756.91 2734,-1756.91 2734,-1688.91 3215,-1688.91 3215,-1756.91"/>
<text text-anchor="middle" x="2974.5" y="-1741.71" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="2974.5" y="-1726.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2974.5" y="-1711.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2974.5" y="-1696.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- v_linear0&#45;&gt;reshape_v0 -->
<g id="edge6" class="edge">
<title>v_linear0&#45;&gt;reshape_v0</title>
<path fill="none" stroke="black" d="M3071.94,-1826.64C3054.22,-1807.95 3031.95,-1784.48 3013.18,-1764.69"/>
<polygon fill="black" stroke="black" points="3015.6,-1762.15 3006.18,-1757.3 3010.52,-1766.97 3015.6,-1762.15"/>
</g>
<!-- split_heads_q0 -->
<g id="node8" class="node">
<title>split_heads_q0</title>
<polygon fill="none" stroke="black" points="2851.97,-1928.91 2078.1,-1928.91 1879.03,-1792.91 2652.9,-1792.91 2851.97,-1928.91"/>
<text text-anchor="middle" x="2365.5" y="-1879.71" font-family="Times,serif" font-size="14.00">Split Heads Q</text>
<text text-anchor="middle" x="2365.5" y="-1864.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2365.5" y="-1849.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024×16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="2365.5" y="-1834.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- reshape_q0&#45;&gt;split_heads_q0 -->
<g id="edge7" class="edge">
<title>reshape_q0&#45;&gt;split_heads_q0</title>
<path fill="none" stroke="black" d="M2366.26,-1968.73C2366.2,-1959.66 2366.13,-1949.44 2366.05,-1939"/>
<polygon fill="black" stroke="black" points="2369.55,-1938.94 2365.98,-1928.97 2362.55,-1938.99 2369.55,-1938.94"/>
</g>
<!-- split_heads_k0 -->
<g id="node9" class="node">
<title>split_heads_k0</title>
<polygon fill="none" stroke="black" points="1861.97,-1928.91 1088.1,-1928.91 889.03,-1792.91 1662.9,-1792.91 1861.97,-1928.91"/>
<text text-anchor="middle" x="1375.5" y="-1879.71" font-family="Times,serif" font-size="14.00">Split Heads K</text>
<text text-anchor="middle" x="1375.5" y="-1864.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="1375.5" y="-1849.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024×16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="1375.5" y="-1834.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- reshape_k0&#45;&gt;split_heads_k0 -->
<g id="edge8" class="edge">
<title>reshape_k0&#45;&gt;split_heads_k0</title>
<path fill="none" stroke="black" d="M1383.89,-1968.73C1383.18,-1959.66 1382.38,-1949.44 1381.56,-1939"/>
<polygon fill="black" stroke="black" points="1385.04,-1938.66 1380.77,-1928.97 1378.06,-1939.21 1385.04,-1938.66"/>
</g>
<!-- split_heads_v0 -->
<g id="node10" class="node">
<title>split_heads_v0</title>
<polygon fill="none" stroke="black" points="3337.97,-1652.91 2564.1,-1652.91 2365.03,-1516.91 3138.9,-1516.91 3337.97,-1652.91"/>
<text text-anchor="middle" x="2851.5" y="-1603.71" font-family="Times,serif" font-size="14.00">Split Heads V</text>
<text text-anchor="middle" x="2851.5" y="-1588.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2851.5" y="-1573.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024×16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="2851.5" y="-1558.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- reshape_v0&#45;&gt;split_heads_v0 -->
<g id="edge9" class="edge">
<title>reshape_v0&#45;&gt;split_heads_v0</title>
<path fill="none" stroke="black" d="M2944.41,-1688.64C2936.65,-1680.05 2927.97,-1670.46 2919.12,-1660.67"/>
<polygon fill="black" stroke="black" points="2921.64,-1658.24 2912.33,-1653.17 2916.45,-1662.93 2921.64,-1658.24"/>
</g>
<!-- attn_score0 -->
<g id="node11" class="node">
<title>attn_score0</title>
<polygon fill="none" stroke="black" points="2503,-1756.91 1714,-1756.91 1714,-1688.91 2503,-1688.91 2503,-1756.91"/>
<text text-anchor="middle" x="2108.5" y="-1741.71" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="2108.5" y="-1726.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024×16, seq_len=10000, d_k=512] x [batch_size=1024×16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="2108.5" y="-1711.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024×16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="2108.5" y="-1696.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- split_heads_q0&#45;&gt;attn_score0 -->
<g id="edge10" class="edge">
<title>split_heads_q0&#45;&gt;attn_score0</title>
<path fill="none" stroke="black" d="M2238.88,-1792.9C2218.63,-1782.19 2198.31,-1771.44 2179.95,-1761.72"/>
<polygon fill="black" stroke="black" points="2181.58,-1758.62 2171.1,-1757.03 2178.3,-1764.8 2181.58,-1758.62"/>
</g>
<!-- split_heads_k0&#45;&gt;attn_score0 -->
<g id="edge11" class="edge">
<title>split_heads_k0&#45;&gt;attn_score0</title>
<path fill="none" stroke="black" d="M1678.67,-1803.66C1760.67,-1788.44 1847.05,-1772.42 1920.68,-1758.75"/>
<polygon fill="black" stroke="black" points="1921.32,-1762.19 1930.52,-1756.93 1920.05,-1755.31 1921.32,-1762.19"/>
</g>
<!-- attn_out0 -->
<g id="node13" class="node">
<title>attn_out0</title>
<polygon fill="none" stroke="black" points="3269.5,-1480.91 2433.5,-1480.91 2433.5,-1412.91 3269.5,-1412.91 3269.5,-1480.91"/>
<text text-anchor="middle" x="2851.5" y="-1465.71" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2851.5" y="-1450.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024×16, seq_len=10000, seq_len=10000] x [batch_size=1024×16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="2851.5" y="-1435.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024×16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="2851.5" y="-1420.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- split_heads_v0&#45;&gt;attn_out0 -->
<g id="edge12" class="edge">
<title>split_heads_v0&#45;&gt;attn_out0</title>
<path fill="none" stroke="black" d="M2851.5,-1516.7C2851.5,-1507.95 2851.5,-1499.18 2851.5,-1490.97"/>
<polygon fill="black" stroke="black" points="2855,-1490.92 2851.5,-1480.92 2848,-1490.92 2855,-1490.92"/>
</g>
<!-- softmax0 -->
<g id="node12" class="node">
<title>softmax0</title>
<polygon fill="none" stroke="black" points="2347,-1618.91 1870,-1618.91 1870,-1550.91 2347,-1550.91 2347,-1618.91"/>
<text text-anchor="middle" x="2108.5" y="-1603.71" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="2108.5" y="-1588.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024×16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="2108.5" y="-1573.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024×16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="2108.5" y="-1558.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- attn_score0&#45;&gt;softmax0 -->
<g id="edge13" class="edge">
<title>attn_score0&#45;&gt;softmax0</title>
<path fill="none" stroke="black" d="M2108.5,-1688.64C2108.5,-1670.77 2108.5,-1648.54 2108.5,-1629.33"/>
<polygon fill="black" stroke="black" points="2112,-1629.3 2108.5,-1619.3 2105,-1629.3 2112,-1629.3"/>
</g>
<!-- softmax0&#45;&gt;attn_out0 -->
<g id="edge14" class="edge">
<title>softmax0&#45;&gt;attn_out0</title>
<path fill="none" stroke="black" d="M2218.9,-1550.9C2261.6,-1538.97 2311.05,-1526.18 2356.5,-1516.91 2421.9,-1503.57 2492.69,-1492.02 2559.73,-1482.38"/>
<polygon fill="black" stroke="black" points="2560.62,-1485.79 2570.03,-1480.91 2559.63,-1478.86 2560.62,-1485.79"/>
</g>
<!-- merge_heads0 -->
<g id="node14" class="node">
<title>merge_heads0</title>
<polygon fill="none" stroke="black" points="3337.9,-1376.91 2565.74,-1376.91 2367.1,-1240.91 3139.26,-1240.91 3337.9,-1376.91"/>
<text text-anchor="middle" x="2852.5" y="-1327.71" font-family="Times,serif" font-size="14.00">Merge Heads</text>
<text text-anchor="middle" x="2852.5" y="-1312.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024×16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="2852.5" y="-1297.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2852.5" y="-1282.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- attn_out0&#45;&gt;merge_heads0 -->
<g id="edge15" class="edge">
<title>attn_out0&#45;&gt;merge_heads0</title>
<path fill="none" stroke="black" d="M2851.74,-1412.64C2851.8,-1404.81 2851.87,-1396.14 2851.93,-1387.26"/>
<polygon fill="black" stroke="black" points="2855.43,-1387.2 2852.01,-1377.17 2848.43,-1387.14 2855.43,-1387.2"/>
</g>
<!-- out_proj0 -->
<g id="node15" class="node">
<title>out_proj0</title>
<polygon fill="none" stroke="black" points="3148.5,-1204.91 2680.5,-1204.91 2680.5,-1136.91 3148.5,-1136.91 3148.5,-1204.91"/>
<text text-anchor="middle" x="2914.5" y="-1189.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2914.5" y="-1174.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2914.5" y="-1159.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2914.5" y="-1144.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- merge_heads0&#45;&gt;out_proj0 -->
<g id="edge16" class="edge">
<title>merge_heads0&#45;&gt;out_proj0</title>
<path fill="none" stroke="black" d="M2883.14,-1240.7C2887.26,-1231.66 2891.39,-1222.6 2895.24,-1214.16"/>
<polygon fill="black" stroke="black" points="2898.48,-1215.47 2899.45,-1204.92 2892.12,-1212.57 2898.48,-1215.47"/>
</g>
<!-- out_proj0&#45;&gt;residual_attn0 -->
<g id="edge17" class="edge">
<title>out_proj0&#45;&gt;residual_attn0</title>
<path fill="none" stroke="black" d="M2954.43,-1136.79C2965.61,-1127.53 2977.86,-1117.36 2989.45,-1107.75"/>
<polygon fill="black" stroke="black" points="2991.88,-1110.28 2997.34,-1101.21 2987.41,-1104.9 2991.88,-1110.28"/>
</g>
<!-- layer_norm_attn0 -->
<g id="node17" class="node">
<title>layer_norm_attn0</title>
<polygon fill="none" stroke="black" points="3137.5,-996.91 2669.5,-996.91 2669.5,-928.91 3137.5,-928.91 3137.5,-996.91"/>
<text text-anchor="middle" x="2903.5" y="-981.71" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="2903.5" y="-966.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2903.5" y="-951.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2903.5" y="-936.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- residual_attn0&#45;&gt;layer_norm_attn0 -->
<g id="edge19" class="edge">
<title>residual_attn0&#45;&gt;layer_norm_attn0</title>
<path fill="none" stroke="black" d="M2993.99,-1032.79C2981.71,-1023.44 2968.21,-1013.17 2955.48,-1003.47"/>
<polygon fill="black" stroke="black" points="2957.32,-1000.48 2947.25,-997.21 2953.08,-1006.05 2957.32,-1000.48"/>
</g>
<!-- residual_mlp0 -->
<g id="node21" class="node">
<title>residual_mlp0</title>
<polygon fill="none" stroke="black" points="3209.5,-580.91 2731.5,-580.91 2731.5,-512.91 3209.5,-512.91 3209.5,-580.91"/>
<text text-anchor="middle" x="2970.5" y="-565.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2970.5" y="-550.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192] x2</text>
<text text-anchor="middle" x="2970.5" y="-535.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2970.5" y="-520.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- residual_attn0&#45;&gt;residual_mlp0 -->
<g id="edge24" class="edge">
<title>residual_attn0&#45;&gt;residual_mlp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3110.97,-1032.81C3124.94,-1023.21 3137.87,-1011.32 3146.5,-996.91 3177.87,-944.53 3156.5,-920.96 3156.5,-859.91 3156.5,-859.91 3156.5,-859.91 3156.5,-753.91 3156.5,-692.86 3182.71,-666.06 3146.5,-616.91 3137.48,-604.66 3125.95,-594.59 3113.13,-586.3"/>
<polygon fill="black" stroke="black" points="3114.9,-583.28 3104.52,-581.11 3111.28,-589.27 3114.9,-583.28"/>
</g>
<!-- mlp_linear1_0 -->
<g id="node18" class="node">
<title>mlp_linear1_0</title>
<polygon fill="none" stroke="black" points="3137.5,-892.91 2669.5,-892.91 2669.5,-824.91 3137.5,-824.91 3137.5,-892.91"/>
<text text-anchor="middle" x="2903.5" y="-877.71" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="2903.5" y="-862.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2903.5" y="-847.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden=32768]</text>
<text text-anchor="middle" x="2903.5" y="-832.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_norm_attn0&#45;&gt;mlp_linear1_0 -->
<g id="edge20" class="edge">
<title>layer_norm_attn0&#45;&gt;mlp_linear1_0</title>
<path fill="none" stroke="black" d="M2903.5,-928.79C2903.5,-920.68 2903.5,-911.89 2903.5,-903.38"/>
<polygon fill="black" stroke="black" points="2907,-903.21 2903.5,-893.21 2900,-903.21 2907,-903.21"/>
</g>
<!-- gelu0 -->
<g id="node19" class="node">
<title>gelu0</title>
<polygon fill="none" stroke="black" points="3137.5,-788.91 2669.5,-788.91 2669.5,-720.91 3137.5,-720.91 3137.5,-788.91"/>
<text text-anchor="middle" x="2903.5" y="-773.71" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2903.5" y="-758.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden=32768]</text>
<text text-anchor="middle" x="2903.5" y="-743.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden=32768]</text>
<text text-anchor="middle" x="2903.5" y="-728.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- mlp_linear1_0&#45;&gt;gelu0 -->
<g id="edge21" class="edge">
<title>mlp_linear1_0&#45;&gt;gelu0</title>
<path fill="none" stroke="black" d="M2903.5,-824.79C2903.5,-816.68 2903.5,-807.89 2903.5,-799.38"/>
<polygon fill="black" stroke="black" points="2907,-799.21 2903.5,-789.21 2900,-799.21 2907,-799.21"/>
</g>
<!-- mlp_linear2_0 -->
<g id="node20" class="node">
<title>mlp_linear2_0</title>
<polygon fill="none" stroke="black" points="3137.5,-684.91 2669.5,-684.91 2669.5,-616.91 3137.5,-616.91 3137.5,-684.91"/>
<text text-anchor="middle" x="2903.5" y="-669.71" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="2903.5" y="-654.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden=32768]</text>
<text text-anchor="middle" x="2903.5" y="-639.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2903.5" y="-624.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gelu0&#45;&gt;mlp_linear2_0 -->
<g id="edge22" class="edge">
<title>gelu0&#45;&gt;mlp_linear2_0</title>
<path fill="none" stroke="black" d="M2903.5,-720.79C2903.5,-712.68 2903.5,-703.89 2903.5,-695.38"/>
<polygon fill="black" stroke="black" points="2907,-695.21 2903.5,-685.21 2900,-695.21 2907,-695.21"/>
</g>
<!-- mlp_linear2_0&#45;&gt;residual_mlp0 -->
<g id="edge23" class="edge">
<title>mlp_linear2_0&#45;&gt;residual_mlp0</title>
<path fill="none" stroke="black" d="M2925.25,-616.79C2930.93,-608.15 2937.12,-598.73 2943.05,-589.7"/>
<polygon fill="black" stroke="black" points="2946.06,-591.49 2948.63,-581.21 2940.21,-587.64 2946.06,-591.49"/>
</g>
<!-- layer_norm_mlp0 -->
<g id="node22" class="node">
<title>layer_norm_mlp0</title>
<polygon fill="none" stroke="black" points="3204.5,-476.91 2736.5,-476.91 2736.5,-408.91 3204.5,-408.91 3204.5,-476.91"/>
<text text-anchor="middle" x="2970.5" y="-461.71" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="2970.5" y="-446.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2970.5" y="-431.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2970.5" y="-416.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- residual_mlp0&#45;&gt;layer_norm_mlp0 -->
<g id="edge25" class="edge">
<title>residual_mlp0&#45;&gt;layer_norm_mlp0</title>
<path fill="none" stroke="black" d="M2970.5,-512.79C2970.5,-504.68 2970.5,-495.89 2970.5,-487.38"/>
<polygon fill="black" stroke="black" points="2974,-487.21 2970.5,-477.21 2967,-487.21 2974,-487.21"/>
</g>
<!-- comm0_1 -->
<g id="node23" class="node">
<title>comm0_1</title>
<ellipse fill="none" stroke="black" cx="2970.5" cy="-324.82" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="2970.5" y="-343.62" font-family="Times,serif" font-size="14.00">GPU0→GPU1 Transfer</text>
<text text-anchor="middle" x="2970.5" y="-328.62" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2970.5" y="-313.62" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2970.5" y="-298.62" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- layer_norm_mlp0&#45;&gt;comm0_1 -->
<g id="edge26" class="edge">
<title>layer_norm_mlp0&#45;&gt;comm0_1</title>
<path fill="none" stroke="black" d="M2970.5,-408.64C2970.5,-400.65 2970.5,-391.88 2970.5,-383.14"/>
<polygon fill="black" stroke="black" points="2974,-382.93 2970.5,-372.93 2967,-382.93 2974,-382.93"/>
</g>
<!-- q_linear1 -->
<g id="node24" class="node">
<title>q_linear1</title>
<polygon fill="none" stroke="black" points="3105.5,-218.74 3027.5,-218.74 3027.5,-180.74 3105.5,-180.74 3105.5,-218.74"/>
<text text-anchor="middle" x="3066.5" y="-203.54" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="3066.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- comm0_1&#45;&gt;q_linear1 -->
<g id="edge27" class="edge">
<title>comm0_1&#45;&gt;q_linear1</title>
<path fill="none" stroke="black" d="M3011.01,-276.86C3013.23,-274.13 3015.4,-271.41 3017.5,-268.74 3028.01,-255.35 3039.15,-239.99 3048.15,-227.27"/>
<polygon fill="black" stroke="black" points="3051.12,-229.13 3054,-218.93 3045.39,-225.11 3051.12,-229.13"/>
</g>
<!-- k_linear1 -->
<g id="node25" class="node">
<title>k_linear1</title>
<polygon fill="none" stroke="black" points="3009,-218.74 2932,-218.74 2932,-180.74 3009,-180.74 3009,-218.74"/>
<text text-anchor="middle" x="2970.5" y="-203.54" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="2970.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- comm0_1&#45;&gt;k_linear1 -->
<g id="edge28" class="edge">
<title>comm0_1&#45;&gt;k_linear1</title>
<path fill="none" stroke="black" d="M2970.5,-276.59C2970.5,-260.49 2970.5,-243.01 2970.5,-228.89"/>
<polygon fill="black" stroke="black" points="2974,-228.83 2970.5,-218.83 2967,-228.83 2974,-228.83"/>
</g>
<!-- v_linear1 -->
<g id="node26" class="node">
<title>v_linear1</title>
<polygon fill="none" stroke="black" points="2914,-218.74 2837,-218.74 2837,-180.74 2914,-180.74 2914,-218.74"/>
<text text-anchor="middle" x="2875.5" y="-203.54" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="2875.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- comm0_1&#45;&gt;v_linear1 -->
<g id="edge29" class="edge">
<title>comm0_1&#45;&gt;v_linear1</title>
<path fill="none" stroke="black" d="M2929.04,-276.94C2926.79,-274.19 2924.6,-271.44 2922.5,-268.74 2912.12,-255.39 2901.34,-239.93 2892.73,-227.12"/>
<polygon fill="black" stroke="black" points="2895.6,-225.12 2887.14,-218.74 2889.78,-229 2895.6,-225.12"/>
</g>
<!-- reshape_q1 -->
<g id="node27" class="node">
<title>reshape_q1</title>
<polygon fill="none" stroke="black" points="2819,-218.74 2726,-218.74 2726,-180.74 2819,-180.74 2819,-218.74"/>
<text text-anchor="middle" x="2772.5" y="-203.54" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="2772.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- reshape_k1 -->
<g id="node28" class="node">
<title>reshape_k1</title>
<polygon fill="none" stroke="black" points="2707.5,-218.74 2615.5,-218.74 2615.5,-180.74 2707.5,-180.74 2707.5,-218.74"/>
<text text-anchor="middle" x="2661.5" y="-203.54" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="2661.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- reshape_v1 -->
<g id="node29" class="node">
<title>reshape_v1</title>
<polygon fill="none" stroke="black" points="2597.5,-218.74 2505.5,-218.74 2505.5,-180.74 2597.5,-180.74 2597.5,-218.74"/>
<text text-anchor="middle" x="2551.5" y="-203.54" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="2551.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- split_heads_q1 -->
<g id="node30" class="node">
<title>split_heads_q1</title>
<polygon fill="none" stroke="black" points="2487.53,-237.74 2296.59,-237.74 2247.47,-161.74 2438.41,-161.74 2487.53,-237.74"/>
<text text-anchor="middle" x="2367.5" y="-203.54" font-family="Times,serif" font-size="14.00">Split Heads Q</text>
<text text-anchor="middle" x="2367.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- split_heads_k1 -->
<g id="node31" class="node">
<title>split_heads_k1</title>
<polygon fill="none" stroke="black" points="2229.95,-237.74 2039.93,-237.74 1991.05,-161.74 2181.07,-161.74 2229.95,-237.74"/>
<text text-anchor="middle" x="2110.5" y="-203.54" font-family="Times,serif" font-size="14.00">Split Heads K</text>
<text text-anchor="middle" x="2110.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- split_heads_v1 -->
<g id="node32" class="node">
<title>split_heads_v1</title>
<polygon fill="none" stroke="black" points="1973.88,-237.74 1785.56,-237.74 1737.12,-161.74 1925.44,-161.74 1973.88,-237.74"/>
<text text-anchor="middle" x="1855.5" y="-203.54" font-family="Times,serif" font-size="14.00">Split Heads V</text>
<text text-anchor="middle" x="1855.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- attn_score1 -->
<g id="node33" class="node">
<title>attn_score1</title>
<polygon fill="none" stroke="black" points="1719.5,-218.74 1591.5,-218.74 1591.5,-180.74 1719.5,-180.74 1719.5,-218.74"/>
<text text-anchor="middle" x="1655.5" y="-203.54" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="1655.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- softmax1 -->
<g id="node34" class="node">
<title>softmax1</title>
<polygon fill="none" stroke="black" points="1573.5,-218.74 1497.5,-218.74 1497.5,-180.74 1573.5,-180.74 1573.5,-218.74"/>
<text text-anchor="middle" x="1535.5" y="-203.54" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1535.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- attn_out1 -->
<g id="node35" class="node">
<title>attn_out1</title>
<polygon fill="none" stroke="black" points="1479.5,-218.74 1341.5,-218.74 1341.5,-180.74 1479.5,-180.74 1479.5,-218.74"/>
<text text-anchor="middle" x="1410.5" y="-203.54" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1410.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- merge_heads1 -->
<g id="node36" class="node">
<title>merge_heads1</title>
<polygon fill="none" stroke="black" points="1323.81,-237.74 1137.2,-237.74 1089.19,-161.74 1275.8,-161.74 1323.81,-237.74"/>
<text text-anchor="middle" x="1206.5" y="-203.54" font-family="Times,serif" font-size="14.00">Merge Heads</text>
<text text-anchor="middle" x="1206.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- out_proj1 -->
<g id="node37" class="node">
<title>out_proj1</title>
<polygon fill="none" stroke="black" points="1071.5,-218.74 927.5,-218.74 927.5,-180.74 1071.5,-180.74 1071.5,-218.74"/>
<text text-anchor="middle" x="999.5" y="-203.54" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="999.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- residual_attn1 -->
<g id="node38" class="node">
<title>residual_attn1</title>
<polygon fill="none" stroke="black" points="909.5,-218.74 799.5,-218.74 799.5,-180.74 909.5,-180.74 909.5,-218.74"/>
<text text-anchor="middle" x="854.5" y="-203.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="854.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_norm_attn1 -->
<g id="node39" class="node">
<title>layer_norm_attn1</title>
<polygon fill="none" stroke="black" points="781.5,-218.74 679.5,-218.74 679.5,-180.74 781.5,-180.74 781.5,-218.74"/>
<text text-anchor="middle" x="730.5" y="-203.54" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="730.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- mlp_linear1_1 -->
<g id="node40" class="node">
<title>mlp_linear1_1</title>
<polygon fill="none" stroke="black" points="661,-218.74 552,-218.74 552,-180.74 661,-180.74 661,-218.74"/>
<text text-anchor="middle" x="606.5" y="-203.54" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="606.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- gelu1 -->
<g id="node41" class="node">
<title>gelu1</title>
<polygon fill="none" stroke="black" points="533.5,-218.74 467.5,-218.74 467.5,-180.74 533.5,-180.74 533.5,-218.74"/>
<text text-anchor="middle" x="500.5" y="-203.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="500.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- mlp_linear2_1 -->
<g id="node42" class="node">
<title>mlp_linear2_1</title>
<polygon fill="none" stroke="black" points="449,-218.74 340,-218.74 340,-180.74 449,-180.74 449,-218.74"/>
<text text-anchor="middle" x="394.5" y="-203.54" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="394.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- residual_mlp1 -->
<g id="node43" class="node">
<title>residual_mlp1</title>
<polygon fill="none" stroke="black" points="321.5,-218.74 211.5,-218.74 211.5,-180.74 321.5,-180.74 321.5,-218.74"/>
<text text-anchor="middle" x="266.5" y="-203.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="266.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_norm_mlp1 -->
<g id="node44" class="node">
<title>layer_norm_mlp1</title>
<polygon fill="none" stroke="black" points="193.5,-218.74 91.5,-218.74 91.5,-180.74 193.5,-180.74 193.5,-218.74"/>
<text text-anchor="middle" x="142.5" y="-203.54" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="142.5" y="-188.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- comm1_2 -->
<g id="node45" class="node">
<title>comm1_2</title>
<ellipse fill="none" stroke="black" cx="142.5" cy="-98.87" rx="124.4" ry="26.74"/>
<text text-anchor="middle" x="142.5" y="-102.67" font-family="Times,serif" font-size="14.00">GPU1→GPU2 Transfer</text>
<text text-anchor="middle" x="142.5" y="-87.67" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- layer_norm_mlp1&#45;&gt;comm1_2 -->
<g id="edge30" class="edge">
<title>layer_norm_mlp1&#45;&gt;comm1_2</title>
<path fill="none" stroke="black" d="M142.5,-180.61C142.5,-168.19 142.5,-151.31 142.5,-136.19"/>
<polygon fill="black" stroke="black" points="146,-136.09 142.5,-126.09 139,-136.09 146,-136.09"/>
</g>
<!-- q_linear2 -->
<g id="node81" class="node">
<title>q_linear2</title>
<polygon fill="none" stroke="black" points="83,-36 0,-36 0,0 83,0 83,-36"/>
<text text-anchor="middle" x="41.5" y="-14.3" font-family="Times,serif" font-size="14.00">q_linear2</text>
</g>
<!-- comm1_2&#45;&gt;q_linear2 -->
<g id="edge31" class="edge">
<title>comm1_2&#45;&gt;q_linear2</title>
<path fill="none" stroke="black" d="M110.27,-72.7C97.88,-63.03 83.81,-52.04 71.63,-42.53"/>
<polygon fill="black" stroke="black" points="73.58,-39.61 63.54,-36.21 69.27,-45.13 73.58,-39.61"/>
</g>
<!-- k_linear2 -->
<g id="node82" class="node">
<title>k_linear2</title>
<polygon fill="none" stroke="black" points="183.5,-36 101.5,-36 101.5,0 183.5,0 183.5,-36"/>
<text text-anchor="middle" x="142.5" y="-14.3" font-family="Times,serif" font-size="14.00">k_linear2</text>
</g>
<!-- comm1_2&#45;&gt;k_linear2 -->
<g id="edge32" class="edge">
<title>comm1_2&#45;&gt;k_linear2</title>
<path fill="none" stroke="black" d="M142.5,-71.61C142.5,-63.51 142.5,-54.57 142.5,-46.39"/>
<polygon fill="black" stroke="black" points="146,-46.22 142.5,-36.22 139,-46.22 146,-46.22"/>
</g>
<!-- v_linear2 -->
<g id="node83" class="node">
<title>v_linear2</title>
<polygon fill="none" stroke="black" points="283.5,-36 201.5,-36 201.5,0 283.5,0 283.5,-36"/>
<text text-anchor="middle" x="242.5" y="-14.3" font-family="Times,serif" font-size="14.00">v_linear2</text>
</g>
<!-- comm1_2&#45;&gt;v_linear2 -->
<g id="edge33" class="edge">
<title>comm1_2&#45;&gt;v_linear2</title>
<path fill="none" stroke="black" d="M174.42,-72.7C186.68,-63.03 200.61,-52.04 212.67,-42.53"/>
<polygon fill="black" stroke="black" points="214.99,-45.15 220.67,-36.21 210.66,-39.66 214.99,-45.15"/>
</g>
<!-- comm2_3 -->
<g id="node46" class="node">
<title>comm2_3</title>
<ellipse fill="none" stroke="black" cx="3180.5" cy="-2224.38" rx="124.4" ry="26.74"/>
<text text-anchor="middle" x="3180.5" y="-2228.18" font-family="Times,serif" font-size="14.00">GPU2→GPU3 Transfer</text>
<text text-anchor="middle" x="3180.5" y="-2213.18" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- comm3_4 -->
<g id="node47" class="node">
<title>comm3_4</title>
<ellipse fill="none" stroke="black" cx="3505.5" cy="-2224.38" rx="124.4" ry="26.74"/>
<text text-anchor="middle" x="3505.5" y="-2228.18" font-family="Times,serif" font-size="14.00">GPU3→GPU4 Transfer</text>
<text text-anchor="middle" x="3505.5" y="-2213.18" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- comm4_5 -->
<g id="node48" class="node">
<title>comm4_5</title>
<ellipse fill="none" stroke="black" cx="3801.5" cy="-2224.38" rx="124.4" ry="26.74"/>
<text text-anchor="middle" x="3801.5" y="-2228.18" font-family="Times,serif" font-size="14.00">GPU4→GPU5 Transfer</text>
<text text-anchor="middle" x="3801.5" y="-2213.18" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- comm5_6 -->
<g id="node49" class="node">
<title>comm5_6</title>
<ellipse fill="none" stroke="black" cx="4083.5" cy="-2224.38" rx="124.4" ry="26.74"/>
<text text-anchor="middle" x="4083.5" y="-2228.18" font-family="Times,serif" font-size="14.00">GPU5→GPU6 Transfer</text>
<text text-anchor="middle" x="4083.5" y="-2213.18" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- comm6_7 -->
<g id="node50" class="node">
<title>comm6_7</title>
<ellipse fill="none" stroke="black" cx="4357.5" cy="-2224.38" rx="124.4" ry="26.74"/>
<text text-anchor="middle" x="4357.5" y="-2228.18" font-family="Times,serif" font-size="14.00">GPU6→GPU7 Transfer</text>
<text text-anchor="middle" x="4357.5" y="-2213.18" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- comm7_8 -->
<g id="node51" class="node">
<title>comm7_8</title>
<ellipse fill="none" stroke="black" cx="4628.5" cy="-2224.38" rx="124.4" ry="26.74"/>
<text text-anchor="middle" x="4628.5" y="-2228.18" font-family="Times,serif" font-size="14.00">GPU7→GPU8 Transfer</text>
<text text-anchor="middle" x="4628.5" y="-2213.18" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- comm8_9 -->
<g id="node52" class="node">
<title>comm8_9</title>
<ellipse fill="none" stroke="black" cx="4897.5" cy="-2224.38" rx="124.4" ry="26.74"/>
<text text-anchor="middle" x="4897.5" y="-2228.18" font-family="Times,serif" font-size="14.00">GPU8→GPU9 Transfer</text>
<text text-anchor="middle" x="4897.5" y="-2213.18" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- comm9_10 -->
<g id="node53" class="node">
<title>comm9_10</title>
<ellipse fill="none" stroke="black" cx="5171.5" cy="-2224.38" rx="130.63" ry="26.74"/>
<text text-anchor="middle" x="5171.5" y="-2228.18" font-family="Times,serif" font-size="14.00">GPU9→GPU10 Transfer</text>
<text text-anchor="middle" x="5171.5" y="-2213.18" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- comm10_11 -->
<g id="node54" class="node">
<title>comm10_11</title>
<ellipse fill="none" stroke="black" cx="5457.5" cy="-2224.38" rx="137.36" ry="26.74"/>
<text text-anchor="middle" x="5457.5" y="-2228.18" font-family="Times,serif" font-size="14.00">GPU10→GPU11 Transfer</text>
<text text-anchor="middle" x="5457.5" y="-2213.18" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- comm11_12 -->
<g id="node55" class="node">
<title>comm11_12</title>
<ellipse fill="none" stroke="black" cx="5749.5" cy="-2224.38" rx="137.36" ry="26.74"/>
<text text-anchor="middle" x="5749.5" y="-2228.18" font-family="Times,serif" font-size="14.00">GPU11→GPU12 Transfer</text>
<text text-anchor="middle" x="5749.5" y="-2213.18" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- comm12_13 -->
<g id="node56" class="node">
<title>comm12_13</title>
<ellipse fill="none" stroke="black" cx="6041.5" cy="-2224.38" rx="137.36" ry="26.74"/>
<text text-anchor="middle" x="6041.5" y="-2228.18" font-family="Times,serif" font-size="14.00">GPU12→GPU13 Transfer</text>
<text text-anchor="middle" x="6041.5" y="-2213.18" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- comm13_14 -->
<g id="node57" class="node">
<title>comm13_14</title>
<ellipse fill="none" stroke="black" cx="6333.5" cy="-2224.38" rx="137.36" ry="26.74"/>
<text text-anchor="middle" x="6333.5" y="-2228.18" font-family="Times,serif" font-size="14.00">GPU13→GPU14 Transfer</text>
<text text-anchor="middle" x="6333.5" y="-2213.18" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- comm14_15 -->
<g id="node58" class="node">
<title>comm14_15</title>
<ellipse fill="none" stroke="black" cx="6563.5" cy="-2113.91" rx="137.36" ry="26.74"/>
<text text-anchor="middle" x="6563.5" y="-2117.71" font-family="Times,serif" font-size="14.00">GPU14→GPU15 Transfer</text>
<text text-anchor="middle" x="6563.5" y="-2102.71" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- q_linear15 -->
<g id="node59" class="node">
<title>q_linear15</title>
<polygon fill="none" stroke="black" points="6698.5,-2021.91 6620.5,-2021.91 6620.5,-1983.91 6698.5,-1983.91 6698.5,-2021.91"/>
<text text-anchor="middle" x="6659.5" y="-2006.71" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="6659.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- comm14_15&#45;&gt;q_linear15 -->
<g id="edge35" class="edge">
<title>comm14_15&#45;&gt;q_linear15</title>
<path fill="none" stroke="black" d="M6595.27,-2087.73C6600.91,-2082.73 6606.55,-2077.33 6611.5,-2071.91 6623.05,-2059.24 6634.2,-2043.71 6642.85,-2030.69"/>
<polygon fill="black" stroke="black" points="6645.89,-2032.44 6648.4,-2022.15 6640.02,-2028.62 6645.89,-2032.44"/>
</g>
<!-- k_linear15 -->
<g id="node60" class="node">
<title>k_linear15</title>
<polygon fill="none" stroke="black" points="6602,-2021.91 6525,-2021.91 6525,-1983.91 6602,-1983.91 6602,-2021.91"/>
<text text-anchor="middle" x="6563.5" y="-2006.71" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="6563.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- comm14_15&#45;&gt;k_linear15 -->
<g id="edge36" class="edge">
<title>comm14_15&#45;&gt;k_linear15</title>
<path fill="none" stroke="black" d="M6563.5,-2086.8C6563.5,-2070.37 6563.5,-2049.16 6563.5,-2032.31"/>
<polygon fill="black" stroke="black" points="6567,-2031.96 6563.5,-2021.96 6560,-2031.96 6567,-2031.96"/>
</g>
<!-- v_linear15 -->
<g id="node61" class="node">
<title>v_linear15</title>
<polygon fill="none" stroke="black" points="6507,-2021.91 6430,-2021.91 6430,-1983.91 6507,-1983.91 6507,-2021.91"/>
<text text-anchor="middle" x="6468.5" y="-2006.71" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="6468.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- comm14_15&#45;&gt;v_linear15 -->
<g id="edge37" class="edge">
<title>comm14_15&#45;&gt;v_linear15</title>
<path fill="none" stroke="black" d="M6532.17,-2087.45C6526.73,-2082.51 6521.29,-2077.21 6516.5,-2071.91 6505.02,-2059.18 6493.87,-2043.65 6485.21,-2030.64"/>
<polygon fill="black" stroke="black" points="6488.04,-2028.57 6479.64,-2022.11 6482.18,-2032.39 6488.04,-2028.57"/>
</g>
<!-- reshape_q15 -->
<g id="node62" class="node">
<title>reshape_q15</title>
<polygon fill="none" stroke="black" points="6412,-2021.91 6319,-2021.91 6319,-1983.91 6412,-1983.91 6412,-2021.91"/>
<text text-anchor="middle" x="6365.5" y="-2006.71" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="6365.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- reshape_k15 -->
<g id="node63" class="node">
<title>reshape_k15</title>
<polygon fill="none" stroke="black" points="6300.5,-2021.91 6208.5,-2021.91 6208.5,-1983.91 6300.5,-1983.91 6300.5,-2021.91"/>
<text text-anchor="middle" x="6254.5" y="-2006.71" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="6254.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- reshape_v15 -->
<g id="node64" class="node">
<title>reshape_v15</title>
<polygon fill="none" stroke="black" points="6190.5,-2021.91 6098.5,-2021.91 6098.5,-1983.91 6190.5,-1983.91 6190.5,-2021.91"/>
<text text-anchor="middle" x="6144.5" y="-2006.71" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="6144.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- split_heads_q15 -->
<g id="node65" class="node">
<title>split_heads_q15</title>
<polygon fill="none" stroke="black" points="6080.53,-2040.91 5889.59,-2040.91 5840.47,-1964.91 6031.41,-1964.91 6080.53,-2040.91"/>
<text text-anchor="middle" x="5960.5" y="-2006.71" font-family="Times,serif" font-size="14.00">Split Heads Q</text>
<text text-anchor="middle" x="5960.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- split_heads_k15 -->
<g id="node66" class="node">
<title>split_heads_k15</title>
<polygon fill="none" stroke="black" points="5822.95,-2040.91 5632.93,-2040.91 5584.05,-1964.91 5774.07,-1964.91 5822.95,-2040.91"/>
<text text-anchor="middle" x="5703.5" y="-2006.71" font-family="Times,serif" font-size="14.00">Split Heads K</text>
<text text-anchor="middle" x="5703.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- split_heads_v15 -->
<g id="node67" class="node">
<title>split_heads_v15</title>
<polygon fill="none" stroke="black" points="5566.88,-2040.91 5378.56,-2040.91 5330.12,-1964.91 5518.44,-1964.91 5566.88,-2040.91"/>
<text text-anchor="middle" x="5448.5" y="-2006.71" font-family="Times,serif" font-size="14.00">Split Heads V</text>
<text text-anchor="middle" x="5448.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- attn_score15 -->
<g id="node68" class="node">
<title>attn_score15</title>
<polygon fill="none" stroke="black" points="5312.5,-2021.91 5184.5,-2021.91 5184.5,-1983.91 5312.5,-1983.91 5312.5,-2021.91"/>
<text text-anchor="middle" x="5248.5" y="-2006.71" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="5248.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- softmax15 -->
<g id="node69" class="node">
<title>softmax15</title>
<polygon fill="none" stroke="black" points="5166.5,-2021.91 5090.5,-2021.91 5090.5,-1983.91 5166.5,-1983.91 5166.5,-2021.91"/>
<text text-anchor="middle" x="5128.5" y="-2006.71" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="5128.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- attn_out15 -->
<g id="node70" class="node">
<title>attn_out15</title>
<polygon fill="none" stroke="black" points="5072.5,-2021.91 4934.5,-2021.91 4934.5,-1983.91 5072.5,-1983.91 5072.5,-2021.91"/>
<text text-anchor="middle" x="5003.5" y="-2006.71" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5003.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- merge_heads15 -->
<g id="node71" class="node">
<title>merge_heads15</title>
<polygon fill="none" stroke="black" points="4916.81,-2040.91 4730.2,-2040.91 4682.19,-1964.91 4868.8,-1964.91 4916.81,-2040.91"/>
<text text-anchor="middle" x="4799.5" y="-2006.71" font-family="Times,serif" font-size="14.00">Merge Heads</text>
<text text-anchor="middle" x="4799.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- out_proj15 -->
<g id="node72" class="node">
<title>out_proj15</title>
<polygon fill="none" stroke="black" points="4664.5,-2021.91 4520.5,-2021.91 4520.5,-1983.91 4664.5,-1983.91 4664.5,-2021.91"/>
<text text-anchor="middle" x="4592.5" y="-2006.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4592.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- residual_attn15 -->
<g id="node73" class="node">
<title>residual_attn15</title>
<polygon fill="none" stroke="black" points="4502.5,-2021.91 4392.5,-2021.91 4392.5,-1983.91 4502.5,-1983.91 4502.5,-2021.91"/>
<text text-anchor="middle" x="4447.5" y="-2006.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4447.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_norm_attn15 -->
<g id="node74" class="node">
<title>layer_norm_attn15</title>
<polygon fill="none" stroke="black" points="4374.5,-2021.91 4272.5,-2021.91 4272.5,-1983.91 4374.5,-1983.91 4374.5,-2021.91"/>
<text text-anchor="middle" x="4323.5" y="-2006.71" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="4323.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- mlp_linear1_15 -->
<g id="node75" class="node">
<title>mlp_linear1_15</title>
<polygon fill="none" stroke="black" points="4254,-2021.91 4145,-2021.91 4145,-1983.91 4254,-1983.91 4254,-2021.91"/>
<text text-anchor="middle" x="4199.5" y="-2006.71" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="4199.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- gelu15 -->
<g id="node76" class="node">
<title>gelu15</title>
<polygon fill="none" stroke="black" points="4127,-2021.91 4052,-2021.91 4052,-1983.91 4127,-1983.91 4127,-2021.91"/>
<text text-anchor="middle" x="4089.5" y="-2006.71" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="4089.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- mlp_linear2_15 -->
<g id="node77" class="node">
<title>mlp_linear2_15</title>
<polygon fill="none" stroke="black" points="4034,-2021.91 3925,-2021.91 3925,-1983.91 4034,-1983.91 4034,-2021.91"/>
<text text-anchor="middle" x="3979.5" y="-2006.71" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="3979.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- residual_mlp15 -->
<g id="node78" class="node">
<title>residual_mlp15</title>
<polygon fill="none" stroke="black" points="3906.5,-2021.91 3796.5,-2021.91 3796.5,-1983.91 3906.5,-1983.91 3906.5,-2021.91"/>
<text text-anchor="middle" x="3851.5" y="-2006.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3851.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_norm_mlp15 -->
<g id="node79" class="node">
<title>layer_norm_mlp15</title>
<polygon fill="none" stroke="black" points="3778.5,-2021.91 3676.5,-2021.91 3676.5,-1983.91 3778.5,-1983.91 3778.5,-2021.91"/>
<text text-anchor="middle" x="3727.5" y="-2006.71" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="3727.5" y="-1991.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- output -->
<g id="node80" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="3727.5" cy="-1860.91" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="3727.5" y="-1879.71" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="3727.5" y="-1864.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="3727.5" y="-1849.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="3727.5" y="-1834.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_norm_mlp15&#45;&gt;output -->
<g id="edge38" class="edge">
<title>layer_norm_mlp15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3727.5,-1983.89C3727.5,-1967.49 3727.5,-1942.36 3727.5,-1919.16"/>
<polygon fill="black" stroke="black" points="3731,-1919.02 3727.5,-1909.02 3724,-1919.02 3731,-1919.02"/>
</g>
<!-- layer_norm_mlp14 -->
<g id="node84" class="node">
<title>layer_norm_mlp14</title>
<polygon fill="none" stroke="black" points="6638,-2242.38 6489,-2242.38 6489,-2206.38 6638,-2206.38 6638,-2242.38"/>
<text text-anchor="middle" x="6563.5" y="-2220.68" font-family="Times,serif" font-size="14.00">layer_norm_mlp14</text>
</g>
<!-- layer_norm_mlp14&#45;&gt;comm14_15 -->
<g id="edge34" class="edge">
<title>layer_norm_mlp14&#45;&gt;comm14_15</title>
<path fill="none" stroke="black" d="M6563.5,-2205.95C6563.5,-2191.17 6563.5,-2169.47 6563.5,-2150.96"/>
<polygon fill="black" stroke="black" points="6567,-2150.79 6563.5,-2140.79 6560,-2150.79 6567,-2150.79"/>
</g>
</g>
</svg>
