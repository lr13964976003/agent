<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_tensor_pipeline Pages: 1 -->
<svg width="3083pt" height="3788pt"
 viewBox="0.00 0.00 3083.37 3788.10" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3784.1)">
<title>baseline_tensor_pipeline</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3784.1 3079.37,-3784.1 3079.37,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="290.93,-1647.81 290.93,-3697.15 2874.93,-3697.15 2874.93,-1647.81 290.93,-1647.81"/>
<text text-anchor="middle" x="1582.93" y="-3681.95" font-family="Times,serif" font-size="14.00">Pipeline Stage 0</text>
<text text-anchor="middle" x="1582.93" y="-3666.95" font-family="Times,serif" font-size="14.00">Devices 0&#45;7 (Tensor Parallel)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer0</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1822.93,-1859.81 1822.93,-3651.15 2866.93,-3651.15 2866.93,-1859.81 1822.93,-1859.81"/>
<text text-anchor="middle" x="2344.93" y="-3635.95" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer1</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="298.93,-1736.81 298.93,-1851.81 2866.93,-1851.81 2866.93,-1736.81 298.93,-1736.81"/>
<text text-anchor="middle" x="1582.93" y="-1836.61" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="156.93,-124.17 156.93,-1515.65 426.93,-1515.65 426.93,-124.17 156.93,-124.17"/>
<text text-anchor="middle" x="291.93" y="-1500.45" font-family="Times,serif" font-size="14.00">Pipeline Stage 1</text>
<text text-anchor="middle" x="291.93" y="-1485.45" font-family="Times,serif" font-size="14.00">Devices 8&#45;15 (Tensor Parallel)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer8</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="164.93,-213.17 164.93,-1469.65 418.93,-1469.65 418.93,-213.17 164.93,-213.17"/>
<text text-anchor="middle" x="291.93" y="-1454.45" font-family="Times,serif" font-size="14.00">Layer 8</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="2752.93" cy="-3742.62" rx="322.38" ry="37.45"/>
<text text-anchor="middle" x="2752.93" y="-3753.92" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="2752.93" y="-3738.92" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2752.93" y="-3723.92" font-family="Times,serif" font-size="14.00">GPU: Host</text>
</g>
<!-- qkv_linear0 -->
<g id="node2" class="node">
<title>qkv_linear0</title>
<polygon fill="none" stroke="black" points="2723.43,-3620.15 2246.43,-3620.15 2246.43,-3552.15 2723.43,-3552.15 2723.43,-3620.15"/>
<text text-anchor="middle" x="2484.93" y="-3604.95" font-family="Times,serif" font-size="14.00">QKV Linear (Column Parallel)</text>
<text text-anchor="middle" x="2484.93" y="-3589.95" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2484.93" y="-3574.95" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=24576]</text>
<text text-anchor="middle" x="2484.93" y="-3559.95" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- input&#45;&gt;qkv_linear0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;qkv_linear0</title>
<path fill="none" stroke="black" d="M2690.77,-3705.79C2649.05,-3681.75 2594.14,-3650.1 2551.52,-3625.53"/>
<polygon fill="black" stroke="black" points="2553.04,-3622.37 2542.62,-3620.4 2549.54,-3628.43 2553.04,-3622.37"/>
</g>
<!-- residual_attn0 -->
<g id="node12" class="node">
<title>residual_attn0</title>
<polygon fill="none" stroke="black" points="2775.93,-2691.98 2297.93,-2691.98 2297.93,-2623.98 2775.93,-2623.98 2775.93,-2691.98"/>
<text text-anchor="middle" x="2536.93" y="-2676.78" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2536.93" y="-2661.78" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192] x2</text>
<text text-anchor="middle" x="2536.93" y="-2646.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2536.93" y="-2631.78" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- input&#45;&gt;residual_attn0 -->
<g id="edge14" class="edge">
<title>input&#45;&gt;residual_attn0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2782,-3705.29C2821.41,-3652.28 2886.93,-3549.12 2886.93,-3449.15 2886.93,-3449.15 2886.93,-3449.15 2886.93,-2893.15 2886.93,-2817.06 2896.88,-2780.6 2841.93,-2727.98 2828.22,-2714.85 2799.24,-2703.75 2764.36,-2694.54"/>
<polygon fill="black" stroke="black" points="2764.93,-2691.08 2754.37,-2692 2763.2,-2697.86 2764.93,-2691.08"/>
</g>
<!-- split_qkv0 -->
<g id="node3" class="node">
<title>split_qkv0</title>
<polygon fill="none" stroke="black" points="2858.94,-3516.15 2050.8,-3516.15 1842.91,-3380.15 2651.05,-3380.15 2858.94,-3516.15"/>
<text text-anchor="middle" x="2350.93" y="-3466.95" font-family="Times,serif" font-size="14.00">Split QKV</text>
<text text-anchor="middle" x="2350.93" y="-3451.95" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=24576]</text>
<text text-anchor="middle" x="2350.93" y="-3436.95" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192] x3</text>
<text text-anchor="middle" x="2350.93" y="-3421.95" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- qkv_linear0&#45;&gt;split_qkv0 -->
<g id="edge2" class="edge">
<title>qkv_linear0&#45;&gt;split_qkv0</title>
<path fill="none" stroke="black" d="M2452.15,-3551.88C2443.6,-3543.21 2434.05,-3533.51 2424.31,-3523.63"/>
<polygon fill="black" stroke="black" points="2426.71,-3521.08 2417.2,-3516.41 2421.73,-3525.99 2426.71,-3521.08"/>
</g>
<!-- reshape_q0 -->
<g id="node4" class="node">
<title>reshape_q0</title>
<polygon fill="none" stroke="black" points="2312.43,-3344.15 1831.43,-3344.15 1831.43,-3276.15 2312.43,-3276.15 2312.43,-3344.15"/>
<text text-anchor="middle" x="2071.93" y="-3328.95" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="2071.93" y="-3313.95" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2071.93" y="-3298.95" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2071.93" y="-3283.95" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- split_qkv0&#45;&gt;reshape_q0 -->
<g id="edge3" class="edge">
<title>split_qkv0&#45;&gt;reshape_q0</title>
<path fill="none" stroke="black" d="M2213.47,-3380.14C2191.28,-3369.33 2169.03,-3358.48 2148.95,-3348.69"/>
<polygon fill="black" stroke="black" points="2150.41,-3345.51 2139.89,-3344.27 2147.34,-3351.8 2150.41,-3345.51"/>
</g>
<!-- reshape_k0 -->
<g id="node5" class="node">
<title>reshape_k0</title>
<polygon fill="none" stroke="black" points="2811.43,-3344.15 2330.43,-3344.15 2330.43,-3276.15 2811.43,-3276.15 2811.43,-3344.15"/>
<text text-anchor="middle" x="2570.93" y="-3328.95" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="2570.93" y="-3313.95" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2570.93" y="-3298.95" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2570.93" y="-3283.95" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- split_qkv0&#45;&gt;reshape_k0 -->
<g id="edge4" class="edge">
<title>split_qkv0&#45;&gt;reshape_k0</title>
<path fill="none" stroke="black" d="M2459.31,-3380.14C2476.18,-3369.72 2493.09,-3359.26 2508.47,-3349.75"/>
<polygon fill="black" stroke="black" points="2510.67,-3352.51 2517.34,-3344.27 2506.99,-3346.55 2510.67,-3352.51"/>
</g>
<!-- reshape_v0 -->
<g id="node6" class="node">
<title>reshape_v0</title>
<polygon fill="none" stroke="black" points="2858.43,-3240.15 2377.43,-3240.15 2377.43,-3172.15 2858.43,-3172.15 2858.43,-3240.15"/>
<text text-anchor="middle" x="2617.93" y="-3224.95" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="2617.93" y="-3209.95" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2617.93" y="-3194.95" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2617.93" y="-3179.95" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- split_qkv0&#45;&gt;reshape_v0 -->
<g id="edge5" class="edge">
<title>split_qkv0&#45;&gt;reshape_v0</title>
<path fill="none" stroke="black" d="M2687.3,-3403.75C2749.06,-3388.94 2800.54,-3369.49 2820.93,-3344.15 2839.87,-3320.6 2838.52,-3300.72 2820.93,-3276.15 2812.21,-3263.98 2801.22,-3253.93 2788.89,-3245.63"/>
<polygon fill="black" stroke="black" points="2790.48,-3242.5 2780.15,-3240.17 2786.77,-3248.44 2790.48,-3242.5"/>
</g>
<!-- attn_score0 -->
<g id="node7" class="node">
<title>attn_score0</title>
<polygon fill="none" stroke="black" points="2358.93,-3240.15 1830.93,-3240.15 1830.93,-3172.15 2358.93,-3172.15 2358.93,-3240.15"/>
<text text-anchor="middle" x="2094.93" y="-3224.95" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="2094.93" y="-3209.95" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512] x2</text>
<text text-anchor="middle" x="2094.93" y="-3194.95" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="2094.93" y="-3179.95" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- reshape_q0&#45;&gt;attn_score0 -->
<g id="edge6" class="edge">
<title>reshape_q0&#45;&gt;attn_score0</title>
<path fill="none" stroke="black" d="M2079.39,-3276.03C2081.24,-3267.84 2083.25,-3258.93 2085.19,-3250.34"/>
<polygon fill="black" stroke="black" points="2088.63,-3250.97 2087.42,-3240.45 2081.8,-3249.43 2088.63,-3250.97"/>
</g>
<!-- reshape_k0&#45;&gt;attn_score0 -->
<g id="edge7" class="edge">
<title>reshape_k0&#45;&gt;attn_score0</title>
<path fill="none" stroke="black" d="M2416.71,-3276.1C2366.33,-3265.3 2310.2,-3253.28 2259.12,-3242.33"/>
<polygon fill="black" stroke="black" points="2259.81,-3238.9 2249.3,-3240.23 2258.35,-3245.74 2259.81,-3238.9"/>
</g>
<!-- attn_out0 -->
<g id="node9" class="node">
<title>attn_out0</title>
<polygon fill="none" stroke="black" points="2858.93,-3032.15 1920.93,-3032.15 1920.93,-2964.15 2858.93,-2964.15 2858.93,-3032.15"/>
<text text-anchor="middle" x="2389.93" y="-3016.95" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2389.93" y="-3001.95" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000] x [batch_size=1024, heads=16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="2389.93" y="-2986.95" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2389.93" y="-2971.95" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- reshape_v0&#45;&gt;attn_out0 -->
<g id="edge8" class="edge">
<title>reshape_v0&#45;&gt;attn_out0</title>
<path fill="none" stroke="black" d="M2589.91,-3172.1C2564.65,-3143.19 2525.76,-3100.84 2487.93,-3068.15 2475.98,-3057.82 2462.5,-3047.56 2449.46,-3038.22"/>
<polygon fill="black" stroke="black" points="2451.15,-3035.14 2440.97,-3032.23 2447.12,-3040.86 2451.15,-3035.14"/>
</g>
<!-- softmax0 -->
<g id="node8" class="node">
<title>softmax0</title>
<polygon fill="none" stroke="black" points="2478.93,-3136.15 1950.93,-3136.15 1950.93,-3068.15 2478.93,-3068.15 2478.93,-3136.15"/>
<text text-anchor="middle" x="2214.93" y="-3120.95" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="2214.93" y="-3105.95" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="2214.93" y="-3090.95" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="2214.93" y="-3075.95" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- attn_score0&#45;&gt;softmax0 -->
<g id="edge9" class="edge">
<title>attn_score0&#45;&gt;softmax0</title>
<path fill="none" stroke="black" d="M2133.89,-3172.03C2144.78,-3162.77 2156.74,-3152.6 2168.05,-3142.99"/>
<polygon fill="black" stroke="black" points="2170.4,-3145.59 2175.75,-3136.45 2165.86,-3140.26 2170.4,-3145.59"/>
</g>
<!-- softmax0&#45;&gt;attn_out0 -->
<g id="edge10" class="edge">
<title>softmax0&#45;&gt;attn_out0</title>
<path fill="none" stroke="black" d="M2271.74,-3068.03C2288.49,-3058.27 2306.94,-3047.51 2324.2,-3037.46"/>
<polygon fill="black" stroke="black" points="2326.22,-3040.33 2333.09,-3032.27 2322.69,-3034.28 2326.22,-3040.33"/>
</g>
<!-- reshape_back0 -->
<g id="node10" class="node">
<title>reshape_back0</title>
<polygon fill="none" stroke="black" points="2680.43,-2928.15 2211.43,-2928.15 2211.43,-2860.15 2680.43,-2860.15 2680.43,-2928.15"/>
<text text-anchor="middle" x="2445.93" y="-2912.95" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="2445.93" y="-2897.95" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2445.93" y="-2882.95" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2445.93" y="-2867.95" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- attn_out0&#45;&gt;reshape_back0 -->
<g id="edge11" class="edge">
<title>attn_out0&#45;&gt;reshape_back0</title>
<path fill="none" stroke="black" d="M2408.11,-2964.03C2412.8,-2955.48 2417.92,-2946.16 2422.83,-2937.22"/>
<polygon fill="black" stroke="black" points="2425.9,-2938.9 2427.64,-2928.45 2419.76,-2935.53 2425.9,-2938.9"/>
</g>
<!-- all_reduce_attn0 -->
<g id="node11" class="node">
<title>all_reduce_attn0</title>
<ellipse fill="none" stroke="black" cx="2501.93" cy="-2776.06" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="2501.93" y="-2794.86" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="2501.93" y="-2779.86" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2501.93" y="-2764.86" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2501.93" y="-2749.86" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- reshape_back0&#45;&gt;all_reduce_attn0 -->
<g id="edge12" class="edge">
<title>reshape_back0&#45;&gt;all_reduce_attn0</title>
<path fill="none" stroke="black" d="M2461.97,-2859.88C2466,-2851.54 2470.43,-2842.36 2474.83,-2833.24"/>
<polygon fill="black" stroke="black" points="2478.01,-2834.7 2479.2,-2824.17 2471.7,-2831.66 2478.01,-2834.7"/>
</g>
<!-- all_reduce_attn0&#45;&gt;residual_attn0 -->
<g id="edge13" class="edge">
<title>all_reduce_attn0&#45;&gt;residual_attn0</title>
<path fill="none" stroke="black" d="M2516.16,-2727.85C2518.75,-2719.28 2521.43,-2710.38 2523.97,-2701.94"/>
<polygon fill="black" stroke="black" points="2527.35,-2702.87 2526.88,-2692.28 2520.65,-2700.85 2527.35,-2702.87"/>
</g>
<!-- layer_norm_attn0 -->
<g id="node13" class="node">
<title>layer_norm_attn0</title>
<polygon fill="none" stroke="black" points="2760.93,-2587.98 2292.93,-2587.98 2292.93,-2519.98 2760.93,-2519.98 2760.93,-2587.98"/>
<text text-anchor="middle" x="2526.93" y="-2572.78" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="2526.93" y="-2557.78" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2526.93" y="-2542.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2526.93" y="-2527.78" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual_attn0&#45;&gt;layer_norm_attn0 -->
<g id="edge15" class="edge">
<title>residual_attn0&#45;&gt;layer_norm_attn0</title>
<path fill="none" stroke="black" d="M2533.68,-2623.86C2532.88,-2615.76 2532.02,-2606.96 2531.19,-2598.45"/>
<polygon fill="black" stroke="black" points="2534.65,-2597.89 2530.19,-2588.28 2527.68,-2598.57 2534.65,-2597.89"/>
</g>
<!-- residual_mlp0 -->
<g id="node18" class="node">
<title>residual_mlp0</title>
<polygon fill="none" stroke="black" points="2858.93,-2039.81 2380.93,-2039.81 2380.93,-1971.81 2858.93,-1971.81 2858.93,-2039.81"/>
<text text-anchor="middle" x="2619.93" y="-2024.61" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2619.93" y="-2009.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192] x2</text>
<text text-anchor="middle" x="2619.93" y="-1994.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2619.93" y="-1979.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual_attn0&#45;&gt;residual_mlp0 -->
<g id="edge21" class="edge">
<title>residual_attn0&#45;&gt;residual_mlp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2716.17,-2623.94C2735.96,-2614.72 2754.49,-2602.97 2769.93,-2587.98 2815.91,-2543.33 2814.93,-2515.07 2814.93,-2450.98 2814.93,-2450.98 2814.93,-2450.98 2814.93,-2240.98 2814.93,-2167.44 2848.68,-2134.93 2804.93,-2075.81 2795.81,-2063.49 2784.23,-2053.37 2771.34,-2045.06"/>
<polygon fill="black" stroke="black" points="2773.06,-2042.01 2762.69,-2039.85 2769.45,-2048.01 2773.06,-2042.01"/>
</g>
<!-- mlp_linear1_0 -->
<g id="node14" class="node">
<title>mlp_linear1_0</title>
<polygon fill="none" stroke="black" points="2757.93,-2483.98 2289.93,-2483.98 2289.93,-2415.98 2757.93,-2415.98 2757.93,-2483.98"/>
<text text-anchor="middle" x="2523.93" y="-2468.78" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column)</text>
<text text-anchor="middle" x="2523.93" y="-2453.78" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2523.93" y="-2438.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden=32768]</text>
<text text-anchor="middle" x="2523.93" y="-2423.78" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_norm_attn0&#45;&gt;mlp_linear1_0 -->
<g id="edge16" class="edge">
<title>layer_norm_attn0&#45;&gt;mlp_linear1_0</title>
<path fill="none" stroke="black" d="M2525.95,-2519.86C2525.71,-2511.76 2525.45,-2502.96 2525.2,-2494.45"/>
<polygon fill="black" stroke="black" points="2528.7,-2494.17 2524.91,-2484.28 2521.7,-2494.38 2528.7,-2494.17"/>
</g>
<!-- gelu0 -->
<g id="node15" class="node">
<title>gelu0</title>
<polygon fill="none" stroke="black" points="2750.93,-2379.98 2282.93,-2379.98 2282.93,-2311.98 2750.93,-2311.98 2750.93,-2379.98"/>
<text text-anchor="middle" x="2516.93" y="-2364.78" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2516.93" y="-2349.78" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden=32768]</text>
<text text-anchor="middle" x="2516.93" y="-2334.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden=32768]</text>
<text text-anchor="middle" x="2516.93" y="-2319.78" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- mlp_linear1_0&#45;&gt;gelu0 -->
<g id="edge17" class="edge">
<title>mlp_linear1_0&#45;&gt;gelu0</title>
<path fill="none" stroke="black" d="M2521.65,-2415.86C2521.1,-2407.76 2520.49,-2398.96 2519.91,-2390.45"/>
<polygon fill="black" stroke="black" points="2523.39,-2390.02 2519.21,-2380.28 2516.4,-2390.5 2523.39,-2390.02"/>
</g>
<!-- mlp_linear2_0 -->
<g id="node16" class="node">
<title>mlp_linear2_0</title>
<polygon fill="none" stroke="black" points="2737.93,-2275.98 2269.93,-2275.98 2269.93,-2207.98 2737.93,-2207.98 2737.93,-2275.98"/>
<text text-anchor="middle" x="2503.93" y="-2260.78" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row)</text>
<text text-anchor="middle" x="2503.93" y="-2245.78" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden=32768]</text>
<text text-anchor="middle" x="2503.93" y="-2230.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2503.93" y="-2215.78" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- gelu0&#45;&gt;mlp_linear2_0 -->
<g id="edge18" class="edge">
<title>gelu0&#45;&gt;mlp_linear2_0</title>
<path fill="none" stroke="black" d="M2512.71,-2311.86C2511.67,-2303.76 2510.55,-2294.96 2509.47,-2286.45"/>
<polygon fill="black" stroke="black" points="2512.91,-2285.76 2508.17,-2276.28 2505.96,-2286.64 2512.91,-2285.76"/>
</g>
<!-- all_reduce_mlp0 -->
<g id="node17" class="node">
<title>all_reduce_mlp0</title>
<ellipse fill="none" stroke="black" cx="2464.93" cy="-2123.9" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="2464.93" y="-2142.7" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="2464.93" y="-2127.7" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2464.93" y="-2112.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2464.93" y="-2097.7" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- mlp_linear2_0&#45;&gt;all_reduce_mlp0 -->
<g id="edge19" class="edge">
<title>mlp_linear2_0&#45;&gt;all_reduce_mlp0</title>
<path fill="none" stroke="black" d="M2492.75,-2207.71C2490.01,-2199.55 2486.99,-2190.57 2483.99,-2181.64"/>
<polygon fill="black" stroke="black" points="2487.26,-2180.37 2480.75,-2172.01 2480.62,-2182.6 2487.26,-2180.37"/>
</g>
<!-- all_reduce_mlp0&#45;&gt;residual_mlp0 -->
<g id="edge20" class="edge">
<title>all_reduce_mlp0&#45;&gt;residual_mlp0</title>
<path fill="none" stroke="black" d="M2527.08,-2076.35C2540.34,-2066.42 2554.23,-2056.01 2567.11,-2046.37"/>
<polygon fill="black" stroke="black" points="2569.5,-2048.95 2575.41,-2040.16 2565.3,-2043.35 2569.5,-2048.95"/>
</g>
<!-- layer_norm_mlp0 -->
<g id="node19" class="node">
<title>layer_norm_mlp0</title>
<polygon fill="none" stroke="black" points="2855.93,-1935.81 2387.93,-1935.81 2387.93,-1867.81 2855.93,-1867.81 2855.93,-1935.81"/>
<text text-anchor="middle" x="2621.93" y="-1920.61" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="2621.93" y="-1905.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2621.93" y="-1890.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2621.93" y="-1875.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual_mlp0&#45;&gt;layer_norm_mlp0 -->
<g id="edge22" class="edge">
<title>residual_mlp0&#45;&gt;layer_norm_mlp0</title>
<path fill="none" stroke="black" d="M2620.58,-1971.7C2620.73,-1963.59 2620.91,-1954.8 2621.07,-1946.29"/>
<polygon fill="black" stroke="black" points="2624.58,-1946.18 2621.27,-1936.11 2617.58,-1946.04 2624.58,-1946.18"/>
</g>
<!-- qkv_linear1 -->
<g id="node20" class="node">
<title>qkv_linear1</title>
<polygon fill="none" stroke="black" points="2858.43,-1801.81 2631.43,-1801.81 2631.43,-1763.81 2858.43,-1763.81 2858.43,-1801.81"/>
<text text-anchor="middle" x="2744.93" y="-1786.61" font-family="Times,serif" font-size="14.00">QKV Linear (Column Parallel)</text>
<text text-anchor="middle" x="2744.93" y="-1771.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_norm_mlp0&#45;&gt;qkv_linear1 -->
<g id="edge23" class="edge">
<title>layer_norm_mlp0&#45;&gt;qkv_linear1</title>
<path fill="none" stroke="black" d="M2656.84,-1867.6C2676.48,-1848.92 2700.6,-1825.98 2718.63,-1808.83"/>
<polygon fill="black" stroke="black" points="2721.12,-1811.29 2725.95,-1801.86 2716.29,-1806.22 2721.12,-1811.29"/>
</g>
<!-- split_qkv1 -->
<g id="node21" class="node">
<title>split_qkv1</title>
<polygon fill="none" stroke="black" points="2613.25,-1820.81 2471.16,-1820.81 2434.6,-1744.81 2576.7,-1744.81 2613.25,-1820.81"/>
<text text-anchor="middle" x="2523.93" y="-1786.61" font-family="Times,serif" font-size="14.00">Split QKV</text>
<text text-anchor="middle" x="2523.93" y="-1771.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- reshape_q1 -->
<g id="node22" class="node">
<title>reshape_q1</title>
<polygon fill="none" stroke="black" points="2416.43,-1801.81 2323.43,-1801.81 2323.43,-1763.81 2416.43,-1763.81 2416.43,-1801.81"/>
<text text-anchor="middle" x="2369.93" y="-1786.61" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="2369.93" y="-1771.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- reshape_k1 -->
<g id="node23" class="node">
<title>reshape_k1</title>
<polygon fill="none" stroke="black" points="2304.93,-1801.81 2212.93,-1801.81 2212.93,-1763.81 2304.93,-1763.81 2304.93,-1801.81"/>
<text text-anchor="middle" x="2258.93" y="-1786.61" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="2258.93" y="-1771.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- reshape_v1 -->
<g id="node24" class="node">
<title>reshape_v1</title>
<polygon fill="none" stroke="black" points="2194.93,-1801.81 2102.93,-1801.81 2102.93,-1763.81 2194.93,-1763.81 2194.93,-1801.81"/>
<text text-anchor="middle" x="2148.93" y="-1786.61" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="2148.93" y="-1771.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- attn_score1 -->
<g id="node25" class="node">
<title>attn_score1</title>
<polygon fill="none" stroke="black" points="2084.93,-1801.81 1956.93,-1801.81 1956.93,-1763.81 2084.93,-1763.81 2084.93,-1801.81"/>
<text text-anchor="middle" x="2020.93" y="-1786.61" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="2020.93" y="-1771.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- softmax1 -->
<g id="node26" class="node">
<title>softmax1</title>
<polygon fill="none" stroke="black" points="1938.93,-1801.81 1858.93,-1801.81 1858.93,-1763.81 1938.93,-1763.81 1938.93,-1801.81"/>
<text text-anchor="middle" x="1898.93" y="-1786.61" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1898.93" y="-1771.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- attn_out1 -->
<g id="node27" class="node">
<title>attn_out1</title>
<polygon fill="none" stroke="black" points="1840.93,-1801.81 1702.93,-1801.81 1702.93,-1763.81 1840.93,-1763.81 1840.93,-1801.81"/>
<text text-anchor="middle" x="1771.93" y="-1786.61" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1771.93" y="-1771.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- reshape_back1 -->
<g id="node28" class="node">
<title>reshape_back1</title>
<polygon fill="none" stroke="black" points="1684.93,-1801.81 1568.93,-1801.81 1568.93,-1763.81 1684.93,-1763.81 1684.93,-1801.81"/>
<text text-anchor="middle" x="1626.93" y="-1786.61" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="1626.93" y="-1771.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- all_reduce_attn1 -->
<g id="node29" class="node">
<title>all_reduce_attn1</title>
<ellipse fill="none" stroke="black" cx="1485.93" cy="-1782.81" rx="65.11" ry="26.74"/>
<text text-anchor="middle" x="1485.93" y="-1786.61" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1485.93" y="-1771.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual_attn1 -->
<g id="node30" class="node">
<title>residual_attn1</title>
<polygon fill="none" stroke="black" points="1402.93,-1801.81 1292.93,-1801.81 1292.93,-1763.81 1402.93,-1763.81 1402.93,-1801.81"/>
<text text-anchor="middle" x="1347.93" y="-1786.61" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1347.93" y="-1771.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_norm_attn1 -->
<g id="node31" class="node">
<title>layer_norm_attn1</title>
<polygon fill="none" stroke="black" points="1274.93,-1801.81 1172.93,-1801.81 1172.93,-1763.81 1274.93,-1763.81 1274.93,-1801.81"/>
<text text-anchor="middle" x="1223.93" y="-1786.61" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="1223.93" y="-1771.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- mlp_linear1_1 -->
<g id="node32" class="node">
<title>mlp_linear1_1</title>
<polygon fill="none" stroke="black" points="1154.43,-1801.81 975.43,-1801.81 975.43,-1763.81 1154.43,-1763.81 1154.43,-1801.81"/>
<text text-anchor="middle" x="1064.93" y="-1786.61" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column)</text>
<text text-anchor="middle" x="1064.93" y="-1771.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- gelu1 -->
<g id="node33" class="node">
<title>gelu1</title>
<polygon fill="none" stroke="black" points="956.93,-1801.81 876.93,-1801.81 876.93,-1763.81 956.93,-1763.81 956.93,-1801.81"/>
<text text-anchor="middle" x="916.93" y="-1786.61" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="916.93" y="-1771.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- mlp_linear2_1 -->
<g id="node34" class="node">
<title>mlp_linear2_1</title>
<polygon fill="none" stroke="black" points="858.43,-1801.81 703.43,-1801.81 703.43,-1763.81 858.43,-1763.81 858.43,-1801.81"/>
<text text-anchor="middle" x="780.93" y="-1786.61" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row)</text>
<text text-anchor="middle" x="780.93" y="-1771.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- all_reduce_mlp1 -->
<g id="node35" class="node">
<title>all_reduce_mlp1</title>
<ellipse fill="none" stroke="black" cx="619.93" cy="-1782.81" rx="65.11" ry="26.74"/>
<text text-anchor="middle" x="619.93" y="-1786.61" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="619.93" y="-1771.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual_mlp1 -->
<g id="node36" class="node">
<title>residual_mlp1</title>
<polygon fill="none" stroke="black" points="536.93,-1801.81 426.93,-1801.81 426.93,-1763.81 536.93,-1763.81 536.93,-1801.81"/>
<text text-anchor="middle" x="481.93" y="-1786.61" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="481.93" y="-1771.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_norm_mlp1 -->
<g id="node37" class="node">
<title>layer_norm_mlp1</title>
<polygon fill="none" stroke="black" points="408.93,-1801.81 306.93,-1801.81 306.93,-1763.81 408.93,-1763.81 408.93,-1801.81"/>
<text text-anchor="middle" x="357.93" y="-1786.61" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="357.93" y="-1771.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer2_out -->
<g id="node38" class="node">
<title>layer2_out</title>
<polygon fill="none" stroke="black" points="436.93,-1708.81 298.93,-1708.81 298.93,-1655.81 436.93,-1655.81 436.93,-1708.81"/>
<text text-anchor="middle" x="367.93" y="-1693.61" font-family="Times,serif" font-size="14.00">Layers 2&#45;7</text>
<text text-anchor="middle" x="367.93" y="-1678.61" font-family="Times,serif" font-size="14.00">(Same structure)</text>
<text text-anchor="middle" x="367.93" y="-1663.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_norm_mlp1&#45;&gt;layer2_out -->
<g id="edge24" class="edge">
<title>layer_norm_mlp1&#45;&gt;layer2_out</title>
<path fill="none" stroke="black" d="M359.76,-1763.75C361.02,-1751.29 362.75,-1734.32 364.29,-1719.17"/>
<polygon fill="black" stroke="black" points="367.78,-1719.36 365.31,-1709.06 360.82,-1718.65 367.78,-1719.36"/>
</g>
<!-- pipeline_comm -->
<g id="node39" class="node">
<title>pipeline_comm</title>
<ellipse fill="none" stroke="black" cx="367.93" cy="-1571.73" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="367.93" y="-1590.53" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="367.93" y="-1575.53" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="367.93" y="-1560.53" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="367.93" y="-1545.53" font-family="Times,serif" font-size="14.00">GPU: Stage0â†’Stage1</text>
</g>
<!-- layer2_out&#45;&gt;pipeline_comm -->
<g id="edge25" class="edge">
<title>layer2_out&#45;&gt;pipeline_comm</title>
<path fill="none" stroke="black" d="M367.93,-1655.58C367.93,-1647.83 367.93,-1639 367.93,-1630.06"/>
<polygon fill="black" stroke="black" points="371.43,-1629.97 367.93,-1619.97 364.43,-1629.97 371.43,-1629.97"/>
</g>
<!-- qkv_linear8 -->
<g id="node40" class="node">
<title>qkv_linear8</title>
<polygon fill="none" stroke="black" points="410.43,-1438.65 183.43,-1438.65 183.43,-1400.65 410.43,-1400.65 410.43,-1438.65"/>
<text text-anchor="middle" x="296.93" y="-1423.45" font-family="Times,serif" font-size="14.00">QKV Linear (Column Parallel)</text>
<text text-anchor="middle" x="296.93" y="-1408.45" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- pipeline_comm&#45;&gt;qkv_linear8 -->
<g id="edge26" class="edge">
<title>pipeline_comm&#45;&gt;qkv_linear8</title>
<path fill="none" stroke="black" d="M345.66,-1523.65C333.93,-1498.87 319.96,-1469.33 309.99,-1448.25"/>
<polygon fill="black" stroke="black" points="313.02,-1446.47 305.57,-1438.93 306.69,-1449.47 313.02,-1446.47"/>
</g>
<!-- residual_attn8 -->
<g id="node50" class="node">
<title>residual_attn8</title>
<polygon fill="none" stroke="black" points="405.93,-792.91 295.93,-792.91 295.93,-754.91 405.93,-754.91 405.93,-792.91"/>
<text text-anchor="middle" x="350.93" y="-777.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="350.93" y="-762.71" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- pipeline_comm&#45;&gt;residual_attn8 -->
<g id="edge39" class="edge">
<title>pipeline_comm&#45;&gt;residual_attn8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M414.48,-1524.02C416.13,-1521.29 417.63,-1518.49 418.93,-1515.65 453.68,-1439.15 438.93,-1411.67 438.93,-1327.65 438.93,-1327.65 438.93,-1327.65 438.93,-936.65 438.93,-887.94 444.03,-870.64 418.93,-828.91 411.93,-817.27 401.44,-807.14 390.78,-798.9"/>
<polygon fill="black" stroke="black" points="392.8,-796.04 382.65,-792.97 388.67,-801.69 392.8,-796.04"/>
</g>
<!-- split_qkv8 -->
<g id="node41" class="node">
<title>split_qkv8</title>
<polygon fill="none" stroke="black" points="399.97,-1364.65 253.55,-1364.65 215.88,-1288.65 362.3,-1288.65 399.97,-1364.65"/>
<text text-anchor="middle" x="307.93" y="-1330.45" font-family="Times,serif" font-size="14.00">Split QKV</text>
<text text-anchor="middle" x="307.93" y="-1315.45" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- qkv_linear8&#45;&gt;split_qkv8 -->
<g id="edge27" class="edge">
<title>qkv_linear8&#45;&gt;split_qkv8</title>
<path fill="none" stroke="black" d="M299.15,-1400.23C300.05,-1392.84 301.12,-1383.94 302.21,-1374.95"/>
<polygon fill="black" stroke="black" points="305.71,-1375.18 303.43,-1364.83 298.76,-1374.34 305.71,-1375.18"/>
</g>
<!-- reshape_q8 -->
<g id="node42" class="node">
<title>reshape_q8</title>
<polygon fill="none" stroke="black" points="265.43,-1252.65 172.43,-1252.65 172.43,-1214.65 265.43,-1214.65 265.43,-1252.65"/>
<text text-anchor="middle" x="218.93" y="-1237.45" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="218.93" y="-1222.45" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- split_qkv8&#45;&gt;reshape_q8 -->
<g id="edge28" class="edge">
<title>split_qkv8&#45;&gt;reshape_q8</title>
<path fill="none" stroke="black" d="M271.73,-1288.63C262.35,-1279.04 252.46,-1268.93 243.8,-1260.08"/>
<polygon fill="black" stroke="black" points="246.06,-1257.38 236.56,-1252.68 241.05,-1262.28 246.06,-1257.38"/>
</g>
<!-- reshape_k8 -->
<g id="node43" class="node">
<title>reshape_k8</title>
<polygon fill="none" stroke="black" points="375.93,-1252.65 283.93,-1252.65 283.93,-1214.65 375.93,-1214.65 375.93,-1252.65"/>
<text text-anchor="middle" x="329.93" y="-1237.45" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="329.93" y="-1222.45" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- split_qkv8&#45;&gt;reshape_k8 -->
<g id="edge29" class="edge">
<title>split_qkv8&#45;&gt;reshape_k8</title>
<path fill="none" stroke="black" d="M316.87,-1288.63C318.98,-1279.91 321.19,-1270.76 323.19,-1262.53"/>
<polygon fill="black" stroke="black" points="326.62,-1263.22 325.57,-1252.68 319.81,-1261.58 326.62,-1263.22"/>
</g>
<!-- reshape_v8 -->
<g id="node44" class="node">
<title>reshape_v8</title>
<polygon fill="none" stroke="black" points="410.93,-1178.65 318.93,-1178.65 318.93,-1140.65 410.93,-1140.65 410.93,-1178.65"/>
<text text-anchor="middle" x="364.93" y="-1163.45" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="364.93" y="-1148.45" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- split_qkv8&#45;&gt;reshape_v8 -->
<g id="edge30" class="edge">
<title>split_qkv8&#45;&gt;reshape_v8</title>
<path fill="none" stroke="black" d="M359.21,-1288.38C369.65,-1278.09 379.18,-1266.02 384.93,-1252.65 393.83,-1231.93 387.33,-1206.83 379.44,-1188.08"/>
<polygon fill="black" stroke="black" points="382.6,-1186.56 375.27,-1178.91 376.23,-1189.46 382.6,-1186.56"/>
</g>
<!-- attn_score8 -->
<g id="node45" class="node">
<title>attn_score8</title>
<polygon fill="none" stroke="black" points="300.93,-1178.65 172.93,-1178.65 172.93,-1140.65 300.93,-1140.65 300.93,-1178.65"/>
<text text-anchor="middle" x="236.93" y="-1163.45" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="236.93" y="-1148.45" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- reshape_q8&#45;&gt;attn_score8 -->
<g id="edge31" class="edge">
<title>reshape_q8&#45;&gt;attn_score8</title>
<path fill="none" stroke="black" d="M223.47,-1214.48C225.41,-1206.69 227.73,-1197.42 229.89,-1188.78"/>
<polygon fill="black" stroke="black" points="233.29,-1189.61 232.32,-1179.06 226.5,-1187.91 233.29,-1189.61"/>
</g>
<!-- reshape_k8&#45;&gt;attn_score8 -->
<g id="edge32" class="edge">
<title>reshape_k8&#45;&gt;attn_score8</title>
<path fill="none" stroke="black" d="M306.46,-1214.48C294.89,-1205.52 280.79,-1194.6 268.31,-1184.94"/>
<polygon fill="black" stroke="black" points="270.44,-1182.16 260.39,-1178.81 266.15,-1187.7 270.44,-1182.16"/>
</g>
<!-- attn_out8 -->
<g id="node47" class="node">
<title>attn_out8</title>
<polygon fill="none" stroke="black" points="410.93,-1030.65 272.93,-1030.65 272.93,-992.65 410.93,-992.65 410.93,-1030.65"/>
<text text-anchor="middle" x="341.93" y="-1015.45" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="341.93" y="-1000.45" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- reshape_v8&#45;&gt;attn_out8 -->
<g id="edge33" class="edge">
<title>reshape_v8&#45;&gt;attn_out8</title>
<path fill="none" stroke="black" d="M362.06,-1140.45C358.13,-1115.53 351.05,-1070.54 346.41,-1041.13"/>
<polygon fill="black" stroke="black" points="349.84,-1040.41 344.83,-1031.07 342.93,-1041.49 349.84,-1040.41"/>
</g>
<!-- softmax8 -->
<g id="node46" class="node">
<title>softmax8</title>
<polygon fill="none" stroke="black" points="303.43,-1104.65 214.43,-1104.65 214.43,-1066.65 303.43,-1066.65 303.43,-1104.65"/>
<text text-anchor="middle" x="258.93" y="-1089.45" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="258.93" y="-1074.45" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- attn_score8&#45;&gt;softmax8 -->
<g id="edge34" class="edge">
<title>attn_score8&#45;&gt;softmax8</title>
<path fill="none" stroke="black" d="M242.48,-1140.48C244.86,-1132.69 247.69,-1123.42 250.33,-1114.78"/>
<polygon fill="black" stroke="black" points="253.72,-1115.65 253.3,-1105.06 247.03,-1113.6 253.72,-1115.65"/>
</g>
<!-- softmax8&#45;&gt;attn_out8 -->
<g id="edge35" class="edge">
<title>softmax8&#45;&gt;attn_out8</title>
<path fill="none" stroke="black" d="M279.87,-1066.48C290,-1057.7 302.3,-1047.02 313.28,-1037.5"/>
<polygon fill="black" stroke="black" points="315.73,-1040.01 320.99,-1030.81 311.14,-1034.72 315.73,-1040.01"/>
</g>
<!-- reshape_back8 -->
<g id="node48" class="node">
<title>reshape_back8</title>
<polygon fill="none" stroke="black" points="400.93,-956.65 284.93,-956.65 284.93,-918.65 400.93,-918.65 400.93,-956.65"/>
<text text-anchor="middle" x="342.93" y="-941.45" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="342.93" y="-926.45" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- attn_out8&#45;&gt;reshape_back8 -->
<g id="edge36" class="edge">
<title>attn_out8&#45;&gt;reshape_back8</title>
<path fill="none" stroke="black" d="M342.18,-992.48C342.29,-984.78 342.41,-975.62 342.53,-967.06"/>
<polygon fill="black" stroke="black" points="346.03,-967.11 342.67,-957.06 339.03,-967.01 346.03,-967.11"/>
</g>
<!-- all_reduce_attn8 -->
<g id="node49" class="node">
<title>all_reduce_attn8</title>
<ellipse fill="none" stroke="black" cx="344.93" cy="-855.78" rx="65.11" ry="26.74"/>
<text text-anchor="middle" x="344.93" y="-859.58" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="344.93" y="-844.58" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- reshape_back8&#45;&gt;all_reduce_attn8 -->
<g id="edge37" class="edge">
<title>reshape_back8&#45;&gt;all_reduce_attn8</title>
<path fill="none" stroke="black" d="M343.38,-918.52C343.57,-910.91 343.8,-901.78 344.02,-892.9"/>
<polygon fill="black" stroke="black" points="347.53,-892.79 344.28,-882.7 340.53,-892.61 347.53,-892.79"/>
</g>
<!-- all_reduce_attn8&#45;&gt;residual_attn8 -->
<g id="edge38" class="edge">
<title>all_reduce_attn8&#45;&gt;residual_attn8</title>
<path fill="none" stroke="black" d="M346.89,-828.62C347.51,-820.44 348.19,-811.36 348.81,-803.04"/>
<polygon fill="black" stroke="black" points="352.31,-803.26 349.56,-793.03 345.33,-802.74 352.31,-803.26"/>
</g>
<!-- layer_norm_attn8 -->
<g id="node51" class="node">
<title>layer_norm_attn8</title>
<polygon fill="none" stroke="black" points="352.93,-718.91 250.93,-718.91 250.93,-680.91 352.93,-680.91 352.93,-718.91"/>
<text text-anchor="middle" x="301.93" y="-703.71" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="301.93" y="-688.71" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- residual_attn8&#45;&gt;layer_norm_attn8 -->
<g id="edge40" class="edge">
<title>residual_attn8&#45;&gt;layer_norm_attn8</title>
<path fill="none" stroke="black" d="M338.56,-754.74C332.98,-746.53 326.26,-736.67 320.12,-727.64"/>
<polygon fill="black" stroke="black" points="322.98,-725.62 314.46,-719.32 317.19,-729.56 322.98,-725.62"/>
</g>
<!-- residual_mlp8 -->
<g id="node56" class="node">
<title>residual_mlp8</title>
<polygon fill="none" stroke="black" points="385.93,-333.17 275.93,-333.17 275.93,-295.17 385.93,-295.17 385.93,-333.17"/>
<text text-anchor="middle" x="330.93" y="-317.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="330.93" y="-302.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- residual_attn8&#45;&gt;residual_mlp8 -->
<g id="edge46" class="edge">
<title>residual_attn8&#45;&gt;residual_mlp8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M359.21,-754.9C370.93,-727.76 390.93,-674.48 390.93,-626.91 390.93,-626.91 390.93,-626.91 390.93,-476.91 390.93,-428.43 393.45,-413.54 373.93,-369.17 369.58,-359.29 362.98,-349.69 356.24,-341.38"/>
<polygon fill="black" stroke="black" points="358.7,-338.87 349.54,-333.55 353.38,-343.42 358.7,-338.87"/>
</g>
<!-- mlp_linear1_8 -->
<g id="node52" class="node">
<title>mlp_linear1_8</title>
<polygon fill="none" stroke="black" points="371.43,-644.91 192.43,-644.91 192.43,-606.91 371.43,-606.91 371.43,-644.91"/>
<text text-anchor="middle" x="281.93" y="-629.71" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column)</text>
<text text-anchor="middle" x="281.93" y="-614.71" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_norm_attn8&#45;&gt;mlp_linear1_8 -->
<g id="edge41" class="edge">
<title>layer_norm_attn8&#45;&gt;mlp_linear1_8</title>
<path fill="none" stroke="black" d="M296.88,-680.74C294.72,-672.95 292.14,-663.68 289.74,-655.04"/>
<polygon fill="black" stroke="black" points="293.09,-654.02 287.04,-645.32 286.34,-655.89 293.09,-654.02"/>
</g>
<!-- gelu8 -->
<g id="node53" class="node">
<title>gelu8</title>
<polygon fill="none" stroke="black" points="329.43,-570.91 240.43,-570.91 240.43,-532.91 329.43,-532.91 329.43,-570.91"/>
<text text-anchor="middle" x="284.93" y="-555.71" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="284.93" y="-540.71" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- mlp_linear1_8&#45;&gt;gelu8 -->
<g id="edge42" class="edge">
<title>mlp_linear1_8&#45;&gt;gelu8</title>
<path fill="none" stroke="black" d="M282.68,-606.74C283,-599.04 283.39,-589.88 283.74,-581.32"/>
<polygon fill="black" stroke="black" points="287.24,-581.46 284.16,-571.32 280.25,-581.17 287.24,-581.46"/>
</g>
<!-- mlp_linear2_8 -->
<g id="node54" class="node">
<title>mlp_linear2_8</title>
<polygon fill="none" stroke="black" points="368.43,-496.91 213.43,-496.91 213.43,-458.91 368.43,-458.91 368.43,-496.91"/>
<text text-anchor="middle" x="290.93" y="-481.71" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row)</text>
<text text-anchor="middle" x="290.93" y="-466.71" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- gelu8&#45;&gt;mlp_linear2_8 -->
<g id="edge43" class="edge">
<title>gelu8&#45;&gt;mlp_linear2_8</title>
<path fill="none" stroke="black" d="M286.44,-532.74C287.08,-525.04 287.84,-515.88 288.56,-507.32"/>
<polygon fill="black" stroke="black" points="292.05,-507.58 289.39,-497.32 285.07,-506.99 292.05,-507.58"/>
</g>
<!-- all_reduce_mlp8 -->
<g id="node55" class="node">
<title>all_reduce_mlp8</title>
<ellipse fill="none" stroke="black" cx="299.93" cy="-396.04" rx="65.11" ry="26.74"/>
<text text-anchor="middle" x="299.93" y="-399.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="299.93" y="-384.84" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- mlp_linear2_8&#45;&gt;all_reduce_mlp8 -->
<g id="edge44" class="edge">
<title>mlp_linear2_8&#45;&gt;all_reduce_mlp8</title>
<path fill="none" stroke="black" d="M292.97,-458.78C293.83,-451.17 294.85,-442.04 295.86,-433.16"/>
<polygon fill="black" stroke="black" points="299.36,-433.29 297,-422.96 292.41,-432.51 299.36,-433.29"/>
</g>
<!-- all_reduce_mlp8&#45;&gt;residual_mlp8 -->
<g id="edge45" class="edge">
<title>all_reduce_mlp8&#45;&gt;residual_mlp8</title>
<path fill="none" stroke="black" d="M309.91,-369.33C313.16,-360.93 316.79,-351.58 320.11,-343.04"/>
<polygon fill="black" stroke="black" points="323.46,-344.08 323.81,-333.49 316.93,-341.55 323.46,-344.08"/>
</g>
<!-- layer_norm_mlp8 -->
<g id="node57" class="node">
<title>layer_norm_mlp8</title>
<polygon fill="none" stroke="black" points="381.93,-259.17 279.93,-259.17 279.93,-221.17 381.93,-221.17 381.93,-259.17"/>
<text text-anchor="middle" x="330.93" y="-243.97" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="330.93" y="-228.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- residual_mlp8&#45;&gt;layer_norm_mlp8 -->
<g id="edge47" class="edge">
<title>residual_mlp8&#45;&gt;layer_norm_mlp8</title>
<path fill="none" stroke="black" d="M330.93,-295C330.93,-287.3 330.93,-278.14 330.93,-269.58"/>
<polygon fill="black" stroke="black" points="334.43,-269.58 330.93,-259.58 327.43,-269.58 334.43,-269.58"/>
</g>
<!-- layer15_out -->
<g id="node58" class="node">
<title>layer15_out</title>
<polygon fill="none" stroke="black" points="399.93,-185.17 261.93,-185.17 261.93,-132.17 399.93,-132.17 399.93,-185.17"/>
<text text-anchor="middle" x="330.93" y="-169.97" font-family="Times,serif" font-size="14.00">Layers 9&#45;15</text>
<text text-anchor="middle" x="330.93" y="-154.97" font-family="Times,serif" font-size="14.00">(Same structure)</text>
<text text-anchor="middle" x="330.93" y="-139.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_norm_mlp8&#45;&gt;layer15_out -->
<g id="edge48" class="edge">
<title>layer_norm_mlp8&#45;&gt;layer15_out</title>
<path fill="none" stroke="black" d="M330.93,-221.13C330.93,-213.49 330.93,-204.31 330.93,-195.4"/>
<polygon fill="black" stroke="black" points="334.43,-195.17 330.93,-185.17 327.43,-195.17 334.43,-195.17"/>
</g>
<!-- output -->
<g id="node59" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="330.93" cy="-48.08" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="330.93" y="-66.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="330.93" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="330.93" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="330.93" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer15_out&#45;&gt;output -->
<g id="edge49" class="edge">
<title>layer15_out&#45;&gt;output</title>
<path fill="none" stroke="black" d="M330.93,-131.93C330.93,-124.19 330.93,-115.36 330.93,-106.42"/>
<polygon fill="black" stroke="black" points="334.43,-106.33 330.93,-96.33 327.43,-106.33 334.43,-106.33"/>
</g>
</g>
</svg>
