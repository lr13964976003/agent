<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MA_Separation_MoE Pages: 1 -->
<svg width="10556pt" height="8124pt"
 viewBox="0.00 0.00 10556.00 8124.33" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 8120.33)">
<title>MA_Separation_MoE</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-8120.33 10552,-8120.33 10552,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer_0</title>
<path fill="none" stroke="black" d="M282,-6046.17C282,-6046.17 8005,-6046.17 8005,-6046.17 8011,-6046.17 8017,-6052.17 8017,-6058.17 8017,-6058.17 8017,-8000.17 8017,-8000.17 8017,-8006.17 8011,-8012.17 8005,-8012.17 8005,-8012.17 282,-8012.17 282,-8012.17 276,-8012.17 270,-8006.17 270,-8000.17 270,-8000.17 270,-6058.17 270,-6058.17 270,-6052.17 276,-6046.17 282,-6046.17"/>
<text text-anchor="middle" x="4143.5" y="-7996.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_1</title>
<path fill="none" stroke="black" d="M20,-4072.17C20,-4072.17 7743,-4072.17 7743,-4072.17 7749,-4072.17 7755,-4078.17 7755,-4084.17 7755,-4084.17 7755,-6026.17 7755,-6026.17 7755,-6032.17 7749,-6038.17 7743,-6038.17 7743,-6038.17 20,-6038.17 20,-6038.17 14,-6038.17 8,-6032.17 8,-6026.17 8,-6026.17 8,-4084.17 8,-4084.17 8,-4078.17 14,-4072.17 20,-4072.17"/>
<text text-anchor="middle" x="3881.5" y="-6022.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_2</title>
<path fill="none" stroke="black" d="M1111,-2098.17C1111,-2098.17 8834,-2098.17 8834,-2098.17 8840,-2098.17 8846,-2104.17 8846,-2110.17 8846,-2110.17 8846,-4052.17 8846,-4052.17 8846,-4058.17 8840,-4064.17 8834,-4064.17 8834,-4064.17 1111,-4064.17 1111,-4064.17 1105,-4064.17 1099,-4058.17 1099,-4052.17 1099,-4052.17 1099,-2110.17 1099,-2110.17 1099,-2104.17 1105,-2098.17 1111,-2098.17"/>
<text text-anchor="middle" x="4972.5" y="-4048.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_3</title>
<path fill="none" stroke="black" d="M2805,-124.17C2805,-124.17 10528,-124.17 10528,-124.17 10534,-124.17 10540,-130.17 10540,-136.17 10540,-136.17 10540,-2078.17 10540,-2078.17 10540,-2084.17 10534,-2090.17 10528,-2090.17 10528,-2090.17 2805,-2090.17 2805,-2090.17 2799,-2090.17 2793,-2084.17 2793,-2078.17 2793,-2078.17 2793,-136.17 2793,-136.17 2793,-130.17 2799,-124.17 2805,-124.17"/>
<text text-anchor="middle" x="6666.5" y="-2074.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="6099" cy="-8068.25" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="6099" y="-8087.05" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="6099" y="-8072.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6099" y="-8057.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6099" y="-8042.05" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer0_ln1 -->
<g id="node2" class="node">
<title>layer0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="4875,-7981.17 4417,-7981.17 4417,-7913.17 4875,-7913.17 4875,-7981.17"/>
<text text-anchor="middle" x="4646" y="-7965.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4646" y="-7950.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4646" y="-7935.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4646" y="-7920.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- input&#45;&gt;layer0_ln1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_ln1</title>
<path fill="none" stroke="black" d="M5862.32,-8035.33C5862.32,-8007.11 5862.32,-7971 5862.32,-7971 5862.32,-7971 4885.14,-7971 4885.14,-7971"/>
<polygon fill="black" stroke="black" points="4885.14,-7967.5 4875.14,-7971 4885.14,-7974.5 4885.14,-7967.5"/>
</g>
<!-- layer0_residual1 -->
<g id="node40" class="node">
<title>layer0_residual1</title>
<polygon fill="lightpink" stroke="black" points="7070,-7348.17 6612,-7265.17 7070,-7182.17 7528,-7265.17 7070,-7348.17"/>
<text text-anchor="middle" x="7070" y="-7291.47" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7070" y="-7276.47" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7070" y="-7261.47" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7070" y="-7246.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7070" y="-7231.47" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- input&#45;&gt;layer0_residual1 -->
<g id="edge51" class="edge">
<title>input&#45;&gt;layer0_residual1</title>
<path fill="none" stroke="black" d="M6423.13,-8068C6682.47,-8068 7003,-8068 7003,-8068 7003,-8068 7003,-7346.06 7003,-7346.06"/>
<polygon fill="black" stroke="black" points="7006.5,-7346.06 7003,-7336.06 6999.5,-7346.06 7006.5,-7346.06"/>
</g>
<!-- layer0_qkv_proj_0 -->
<g id="node3" class="node">
<title>layer0_qkv_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="1749.5,-7877.17 1242.5,-7877.17 1242.5,-7794.17 1749.5,-7794.17 1749.5,-7877.17"/>
<text text-anchor="middle" x="1496" y="-7861.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1496" y="-7846.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="1496" y="-7831.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1496" y="-7816.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="1496" y="-7801.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_ln1&#45;&gt;layer0_qkv_proj_0 -->
<g id="edge2" class="edge">
<title>layer0_ln1&#45;&gt;layer0_qkv_proj_0</title>
<path fill="none" stroke="black" d="M4416.92,-7971C3692.05,-7971 1496,-7971 1496,-7971 1496,-7971 1496,-7887.38 1496,-7887.38"/>
<polygon fill="black" stroke="black" points="1499.5,-7887.38 1496,-7877.38 1492.5,-7887.38 1499.5,-7887.38"/>
</g>
<!-- layer0_qkv_proj_1 -->
<g id="node4" class="node">
<title>layer0_qkv_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="2274.5,-7877.17 1767.5,-7877.17 1767.5,-7794.17 2274.5,-7794.17 2274.5,-7877.17"/>
<text text-anchor="middle" x="2021" y="-7861.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2021" y="-7846.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="2021" y="-7831.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2021" y="-7816.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2021" y="-7801.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_ln1&#45;&gt;layer0_qkv_proj_1 -->
<g id="edge6" class="edge">
<title>layer0_ln1&#45;&gt;layer0_qkv_proj_1</title>
<path fill="none" stroke="black" d="M4416.78,-7961C3777.42,-7961 2021,-7961 2021,-7961 2021,-7961 2021,-7887.4 2021,-7887.4"/>
<polygon fill="black" stroke="black" points="2024.5,-7887.4 2021,-7877.4 2017.5,-7887.4 2024.5,-7887.4"/>
</g>
<!-- layer0_qkv_proj_2 -->
<g id="node5" class="node">
<title>layer0_qkv_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="2799.5,-7877.17 2292.5,-7877.17 2292.5,-7794.17 2799.5,-7794.17 2799.5,-7877.17"/>
<text text-anchor="middle" x="2546" y="-7861.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2546" y="-7846.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="2546" y="-7831.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2546" y="-7816.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2546" y="-7801.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_ln1&#45;&gt;layer0_qkv_proj_2 -->
<g id="edge10" class="edge">
<title>layer0_ln1&#45;&gt;layer0_qkv_proj_2</title>
<path fill="none" stroke="black" d="M4416.76,-7952C3872.18,-7952 2546,-7952 2546,-7952 2546,-7952 2546,-7887.34 2546,-7887.34"/>
<polygon fill="black" stroke="black" points="2549.5,-7887.34 2546,-7877.34 2542.5,-7887.34 2549.5,-7887.34"/>
</g>
<!-- layer0_qkv_proj_3 -->
<g id="node6" class="node">
<title>layer0_qkv_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="3324.5,-7877.17 2817.5,-7877.17 2817.5,-7794.17 3324.5,-7794.17 3324.5,-7877.17"/>
<text text-anchor="middle" x="3071" y="-7861.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3071" y="-7846.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3071" y="-7831.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3071" y="-7816.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3071" y="-7801.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_ln1&#45;&gt;layer0_qkv_proj_3 -->
<g id="edge14" class="edge">
<title>layer0_ln1&#45;&gt;layer0_qkv_proj_3</title>
<path fill="none" stroke="black" d="M4416.98,-7942C3980.16,-7942 3071,-7942 3071,-7942 3071,-7942 3071,-7887.39 3071,-7887.39"/>
<polygon fill="black" stroke="black" points="3074.5,-7887.39 3071,-7877.39 3067.5,-7887.39 3074.5,-7887.39"/>
</g>
<!-- layer0_qkv_proj_4 -->
<g id="node7" class="node">
<title>layer0_qkv_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="3849.5,-7877.17 3342.5,-7877.17 3342.5,-7794.17 3849.5,-7794.17 3849.5,-7877.17"/>
<text text-anchor="middle" x="3596" y="-7861.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3596" y="-7846.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3596" y="-7831.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3596" y="-7816.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3596" y="-7801.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_ln1&#45;&gt;layer0_qkv_proj_4 -->
<g id="edge18" class="edge">
<title>layer0_ln1&#45;&gt;layer0_qkv_proj_4</title>
<path fill="none" stroke="black" d="M4416.87,-7932C4107.92,-7932 3596,-7932 3596,-7932 3596,-7932 3596,-7887.36 3596,-7887.36"/>
<polygon fill="black" stroke="black" points="3599.5,-7887.36 3596,-7877.36 3592.5,-7887.36 3599.5,-7887.36"/>
</g>
<!-- layer0_qkv_proj_5 -->
<g id="node8" class="node">
<title>layer0_qkv_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="4374.5,-7877.17 3867.5,-7877.17 3867.5,-7794.17 4374.5,-7794.17 4374.5,-7877.17"/>
<text text-anchor="middle" x="4121" y="-7861.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4121" y="-7846.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4121" y="-7831.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4121" y="-7816.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4121" y="-7801.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_ln1&#45;&gt;layer0_qkv_proj_5 -->
<g id="edge22" class="edge">
<title>layer0_ln1&#45;&gt;layer0_qkv_proj_5</title>
<path fill="none" stroke="black" d="M4416.87,-7922C4275.5,-7922 4121,-7922 4121,-7922 4121,-7922 4121,-7887.32 4121,-7887.32"/>
<polygon fill="black" stroke="black" points="4124.5,-7887.32 4121,-7877.32 4117.5,-7887.32 4124.5,-7887.32"/>
</g>
<!-- layer0_qkv_proj_6 -->
<g id="node9" class="node">
<title>layer0_qkv_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="4899.5,-7877.17 4392.5,-7877.17 4392.5,-7794.17 4899.5,-7794.17 4899.5,-7877.17"/>
<text text-anchor="middle" x="4646" y="-7861.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4646" y="-7846.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4646" y="-7831.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4646" y="-7816.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4646" y="-7801.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_ln1&#45;&gt;layer0_qkv_proj_6 -->
<g id="edge26" class="edge">
<title>layer0_ln1&#45;&gt;layer0_qkv_proj_6</title>
<path fill="none" stroke="black" d="M4646,-7913.11C4646,-7913.11 4646,-7887.38 4646,-7887.38"/>
<polygon fill="black" stroke="black" points="4649.5,-7887.38 4646,-7877.38 4642.5,-7887.38 4649.5,-7887.38"/>
</g>
<!-- layer0_qkv_proj_7 -->
<g id="node10" class="node">
<title>layer0_qkv_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="5424.5,-7877.17 4917.5,-7877.17 4917.5,-7794.17 5424.5,-7794.17 5424.5,-7877.17"/>
<text text-anchor="middle" x="5171" y="-7861.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5171" y="-7846.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="5171" y="-7831.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5171" y="-7816.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5171" y="-7801.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_ln1&#45;&gt;layer0_qkv_proj_7 -->
<g id="edge30" class="edge">
<title>layer0_ln1&#45;&gt;layer0_qkv_proj_7</title>
<path fill="none" stroke="black" d="M4875.13,-7922C5016.5,-7922 5171,-7922 5171,-7922 5171,-7922 5171,-7887.32 5171,-7887.32"/>
<polygon fill="black" stroke="black" points="5174.5,-7887.32 5171,-7877.32 5167.5,-7887.32 5174.5,-7887.32"/>
</g>
<!-- layer0_qkv_proj_8 -->
<g id="node11" class="node">
<title>layer0_qkv_proj_8</title>
<polygon fill="lightcoral" stroke="black" points="5949.5,-7877.17 5442.5,-7877.17 5442.5,-7794.17 5949.5,-7794.17 5949.5,-7877.17"/>
<text text-anchor="middle" x="5696" y="-7861.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5696" y="-7846.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="5696" y="-7831.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5696" y="-7816.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="5696" y="-7801.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_ln1&#45;&gt;layer0_qkv_proj_8 -->
<g id="edge34" class="edge">
<title>layer0_ln1&#45;&gt;layer0_qkv_proj_8</title>
<path fill="none" stroke="black" d="M4875.09,-7932C5159.86,-7932 5608.82,-7932 5608.82,-7932 5608.82,-7932 5608.82,-7887.36 5608.82,-7887.36"/>
<polygon fill="black" stroke="black" points="5612.32,-7887.36 5608.82,-7877.36 5605.32,-7887.36 5612.32,-7887.36"/>
</g>
<!-- layer0_qkv_proj_9 -->
<g id="node12" class="node">
<title>layer0_qkv_proj_9</title>
<polygon fill="lightcoral" stroke="black" points="6474.5,-7877.17 5967.5,-7877.17 5967.5,-7794.17 6474.5,-7794.17 6474.5,-7877.17"/>
<text text-anchor="middle" x="6221" y="-7861.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6221" y="-7846.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="6221" y="-7831.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6221" y="-7816.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6221" y="-7801.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_ln1&#45;&gt;layer0_qkv_proj_9 -->
<g id="edge38" class="edge">
<title>layer0_ln1&#45;&gt;layer0_qkv_proj_9</title>
<path fill="none" stroke="black" d="M4875,-7942C5306.09,-7942 6195.18,-7942 6195.18,-7942 6195.18,-7942 6195.18,-7887.39 6195.18,-7887.39"/>
<polygon fill="black" stroke="black" points="6198.68,-7887.39 6195.18,-7877.39 6191.68,-7887.39 6198.68,-7887.39"/>
</g>
<!-- layer0_qkv_proj_10 -->
<g id="node13" class="node">
<title>layer0_qkv_proj_10</title>
<polygon fill="lightcoral" stroke="black" points="6999.5,-7877.17 6492.5,-7877.17 6492.5,-7794.17 6999.5,-7794.17 6999.5,-7877.17"/>
<text text-anchor="middle" x="6746" y="-7861.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6746" y="-7846.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="6746" y="-7831.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6746" y="-7816.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6746" y="-7801.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_ln1&#45;&gt;layer0_qkv_proj_10 -->
<g id="edge42" class="edge">
<title>layer0_ln1&#45;&gt;layer0_qkv_proj_10</title>
<path fill="none" stroke="black" d="M4875.24,-7952C5419.82,-7952 6746,-7952 6746,-7952 6746,-7952 6746,-7887.34 6746,-7887.34"/>
<polygon fill="black" stroke="black" points="6749.5,-7887.34 6746,-7877.34 6742.5,-7887.34 6749.5,-7887.34"/>
</g>
<!-- layer0_qkv_proj_11 -->
<g id="node14" class="node">
<title>layer0_qkv_proj_11</title>
<polygon fill="lightcoral" stroke="black" points="7524.5,-7877.17 7017.5,-7877.17 7017.5,-7794.17 7524.5,-7794.17 7524.5,-7877.17"/>
<text text-anchor="middle" x="7271" y="-7861.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7271" y="-7846.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="7271" y="-7831.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7271" y="-7816.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7271" y="-7801.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_ln1&#45;&gt;layer0_qkv_proj_11 -->
<g id="edge46" class="edge">
<title>layer0_ln1&#45;&gt;layer0_qkv_proj_11</title>
<path fill="none" stroke="black" d="M4875.22,-7961C5514.58,-7961 7271,-7961 7271,-7961 7271,-7961 7271,-7887.4 7271,-7887.4"/>
<polygon fill="black" stroke="black" points="7274.5,-7887.4 7271,-7877.4 7267.5,-7887.4 7274.5,-7887.4"/>
</g>
<!-- layer0_attention_0 -->
<g id="node15" class="node">
<title>layer0_attention_0</title>
<polygon fill="lightcoral" stroke="black" points="1749.5,-7758.17 1242.5,-7758.17 1242.5,-7675.17 1749.5,-7675.17 1749.5,-7758.17"/>
<text text-anchor="middle" x="1496" y="-7742.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="1496" y="-7727.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="1496" y="-7712.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="1496" y="-7697.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="1496" y="-7682.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_qkv_proj_0&#45;&gt;layer0_attention_0 -->
<g id="edge3" class="edge">
<title>layer0_qkv_proj_0&#45;&gt;layer0_attention_0</title>
<path fill="none" stroke="black" d="M1496,-7794.05C1496,-7794.05 1496,-7768.46 1496,-7768.46"/>
<polygon fill="black" stroke="black" points="1499.5,-7768.46 1496,-7758.46 1492.5,-7768.46 1499.5,-7768.46"/>
</g>
<!-- layer0_attention_1 -->
<g id="node16" class="node">
<title>layer0_attention_1</title>
<polygon fill="lightcoral" stroke="black" points="2274.5,-7758.17 1767.5,-7758.17 1767.5,-7675.17 2274.5,-7675.17 2274.5,-7758.17"/>
<text text-anchor="middle" x="2021" y="-7742.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="2021" y="-7727.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="2021" y="-7712.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2021" y="-7697.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2021" y="-7682.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_qkv_proj_1&#45;&gt;layer0_attention_1 -->
<g id="edge7" class="edge">
<title>layer0_qkv_proj_1&#45;&gt;layer0_attention_1</title>
<path fill="none" stroke="black" d="M2021,-7794.05C2021,-7794.05 2021,-7768.46 2021,-7768.46"/>
<polygon fill="black" stroke="black" points="2024.5,-7768.46 2021,-7758.46 2017.5,-7768.46 2024.5,-7768.46"/>
</g>
<!-- layer0_attention_2 -->
<g id="node17" class="node">
<title>layer0_attention_2</title>
<polygon fill="lightcoral" stroke="black" points="2799.5,-7758.17 2292.5,-7758.17 2292.5,-7675.17 2799.5,-7675.17 2799.5,-7758.17"/>
<text text-anchor="middle" x="2546" y="-7742.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="2546" y="-7727.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="2546" y="-7712.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2546" y="-7697.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2546" y="-7682.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_qkv_proj_2&#45;&gt;layer0_attention_2 -->
<g id="edge11" class="edge">
<title>layer0_qkv_proj_2&#45;&gt;layer0_attention_2</title>
<path fill="none" stroke="black" d="M2546,-7794.05C2546,-7794.05 2546,-7768.46 2546,-7768.46"/>
<polygon fill="black" stroke="black" points="2549.5,-7768.46 2546,-7758.46 2542.5,-7768.46 2549.5,-7768.46"/>
</g>
<!-- layer0_attention_3 -->
<g id="node18" class="node">
<title>layer0_attention_3</title>
<polygon fill="lightcoral" stroke="black" points="3324.5,-7758.17 2817.5,-7758.17 2817.5,-7675.17 3324.5,-7675.17 3324.5,-7758.17"/>
<text text-anchor="middle" x="3071" y="-7742.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="3071" y="-7727.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3071" y="-7712.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3071" y="-7697.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3071" y="-7682.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_qkv_proj_3&#45;&gt;layer0_attention_3 -->
<g id="edge15" class="edge">
<title>layer0_qkv_proj_3&#45;&gt;layer0_attention_3</title>
<path fill="none" stroke="black" d="M3071,-7794.05C3071,-7794.05 3071,-7768.46 3071,-7768.46"/>
<polygon fill="black" stroke="black" points="3074.5,-7768.46 3071,-7758.46 3067.5,-7768.46 3074.5,-7768.46"/>
</g>
<!-- layer0_attention_4 -->
<g id="node19" class="node">
<title>layer0_attention_4</title>
<polygon fill="lightcoral" stroke="black" points="3849.5,-7758.17 3342.5,-7758.17 3342.5,-7675.17 3849.5,-7675.17 3849.5,-7758.17"/>
<text text-anchor="middle" x="3596" y="-7742.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="3596" y="-7727.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3596" y="-7712.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3596" y="-7697.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3596" y="-7682.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_qkv_proj_4&#45;&gt;layer0_attention_4 -->
<g id="edge19" class="edge">
<title>layer0_qkv_proj_4&#45;&gt;layer0_attention_4</title>
<path fill="none" stroke="black" d="M3596,-7794.05C3596,-7794.05 3596,-7768.46 3596,-7768.46"/>
<polygon fill="black" stroke="black" points="3599.5,-7768.46 3596,-7758.46 3592.5,-7768.46 3599.5,-7768.46"/>
</g>
<!-- layer0_attention_5 -->
<g id="node20" class="node">
<title>layer0_attention_5</title>
<polygon fill="lightcoral" stroke="black" points="4374.5,-7758.17 3867.5,-7758.17 3867.5,-7675.17 4374.5,-7675.17 4374.5,-7758.17"/>
<text text-anchor="middle" x="4121" y="-7742.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="4121" y="-7727.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4121" y="-7712.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4121" y="-7697.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4121" y="-7682.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_qkv_proj_5&#45;&gt;layer0_attention_5 -->
<g id="edge23" class="edge">
<title>layer0_qkv_proj_5&#45;&gt;layer0_attention_5</title>
<path fill="none" stroke="black" d="M4121,-7794.05C4121,-7794.05 4121,-7768.46 4121,-7768.46"/>
<polygon fill="black" stroke="black" points="4124.5,-7768.46 4121,-7758.46 4117.5,-7768.46 4124.5,-7768.46"/>
</g>
<!-- layer0_attention_6 -->
<g id="node21" class="node">
<title>layer0_attention_6</title>
<polygon fill="lightcoral" stroke="black" points="4899.5,-7758.17 4392.5,-7758.17 4392.5,-7675.17 4899.5,-7675.17 4899.5,-7758.17"/>
<text text-anchor="middle" x="4646" y="-7742.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="4646" y="-7727.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4646" y="-7712.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4646" y="-7697.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4646" y="-7682.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_qkv_proj_6&#45;&gt;layer0_attention_6 -->
<g id="edge27" class="edge">
<title>layer0_qkv_proj_6&#45;&gt;layer0_attention_6</title>
<path fill="none" stroke="black" d="M4646,-7794.05C4646,-7794.05 4646,-7768.46 4646,-7768.46"/>
<polygon fill="black" stroke="black" points="4649.5,-7768.46 4646,-7758.46 4642.5,-7768.46 4649.5,-7768.46"/>
</g>
<!-- layer0_attention_7 -->
<g id="node22" class="node">
<title>layer0_attention_7</title>
<polygon fill="lightcoral" stroke="black" points="5424.5,-7758.17 4917.5,-7758.17 4917.5,-7675.17 5424.5,-7675.17 5424.5,-7758.17"/>
<text text-anchor="middle" x="5171" y="-7742.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="5171" y="-7727.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="5171" y="-7712.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5171" y="-7697.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5171" y="-7682.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_qkv_proj_7&#45;&gt;layer0_attention_7 -->
<g id="edge31" class="edge">
<title>layer0_qkv_proj_7&#45;&gt;layer0_attention_7</title>
<path fill="none" stroke="black" d="M5171,-7794.05C5171,-7794.05 5171,-7768.46 5171,-7768.46"/>
<polygon fill="black" stroke="black" points="5174.5,-7768.46 5171,-7758.46 5167.5,-7768.46 5174.5,-7768.46"/>
</g>
<!-- layer0_attention_8 -->
<g id="node23" class="node">
<title>layer0_attention_8</title>
<polygon fill="lightcoral" stroke="black" points="5949.5,-7758.17 5442.5,-7758.17 5442.5,-7675.17 5949.5,-7675.17 5949.5,-7758.17"/>
<text text-anchor="middle" x="5696" y="-7742.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="5696" y="-7727.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="5696" y="-7712.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="5696" y="-7697.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="5696" y="-7682.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_qkv_proj_8&#45;&gt;layer0_attention_8 -->
<g id="edge35" class="edge">
<title>layer0_qkv_proj_8&#45;&gt;layer0_attention_8</title>
<path fill="none" stroke="black" d="M5696,-7794.05C5696,-7794.05 5696,-7768.46 5696,-7768.46"/>
<polygon fill="black" stroke="black" points="5699.5,-7768.46 5696,-7758.46 5692.5,-7768.46 5699.5,-7768.46"/>
</g>
<!-- layer0_attention_9 -->
<g id="node24" class="node">
<title>layer0_attention_9</title>
<polygon fill="lightcoral" stroke="black" points="6474.5,-7758.17 5967.5,-7758.17 5967.5,-7675.17 6474.5,-7675.17 6474.5,-7758.17"/>
<text text-anchor="middle" x="6221" y="-7742.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="6221" y="-7727.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="6221" y="-7712.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6221" y="-7697.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6221" y="-7682.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_qkv_proj_9&#45;&gt;layer0_attention_9 -->
<g id="edge39" class="edge">
<title>layer0_qkv_proj_9&#45;&gt;layer0_attention_9</title>
<path fill="none" stroke="black" d="M6221,-7794.05C6221,-7794.05 6221,-7768.46 6221,-7768.46"/>
<polygon fill="black" stroke="black" points="6224.5,-7768.46 6221,-7758.46 6217.5,-7768.46 6224.5,-7768.46"/>
</g>
<!-- layer0_attention_10 -->
<g id="node25" class="node">
<title>layer0_attention_10</title>
<polygon fill="lightcoral" stroke="black" points="6999.5,-7758.17 6492.5,-7758.17 6492.5,-7675.17 6999.5,-7675.17 6999.5,-7758.17"/>
<text text-anchor="middle" x="6746" y="-7742.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="6746" y="-7727.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="6746" y="-7712.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6746" y="-7697.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6746" y="-7682.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_qkv_proj_10&#45;&gt;layer0_attention_10 -->
<g id="edge43" class="edge">
<title>layer0_qkv_proj_10&#45;&gt;layer0_attention_10</title>
<path fill="none" stroke="black" d="M6746,-7794.05C6746,-7794.05 6746,-7768.46 6746,-7768.46"/>
<polygon fill="black" stroke="black" points="6749.5,-7768.46 6746,-7758.46 6742.5,-7768.46 6749.5,-7768.46"/>
</g>
<!-- layer0_attention_11 -->
<g id="node26" class="node">
<title>layer0_attention_11</title>
<polygon fill="lightcoral" stroke="black" points="7524.5,-7758.17 7017.5,-7758.17 7017.5,-7675.17 7524.5,-7675.17 7524.5,-7758.17"/>
<text text-anchor="middle" x="7271" y="-7742.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="7271" y="-7727.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="7271" y="-7712.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7271" y="-7697.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7271" y="-7682.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_qkv_proj_11&#45;&gt;layer0_attention_11 -->
<g id="edge47" class="edge">
<title>layer0_qkv_proj_11&#45;&gt;layer0_attention_11</title>
<path fill="none" stroke="black" d="M7271,-7794.05C7271,-7794.05 7271,-7768.46 7271,-7768.46"/>
<polygon fill="black" stroke="black" points="7274.5,-7768.46 7271,-7758.46 7267.5,-7768.46 7274.5,-7768.46"/>
</g>
<!-- layer0_attn_out_proj_0 -->
<g id="node27" class="node">
<title>layer0_attn_out_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="1755.5,-7639.17 1260.5,-7639.17 1260.5,-7556.17 1755.5,-7556.17 1755.5,-7639.17"/>
<text text-anchor="middle" x="1508" y="-7623.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="1508" y="-7608.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="1508" y="-7593.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="1508" y="-7578.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="1508" y="-7563.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_attention_0&#45;&gt;layer0_attn_out_proj_0 -->
<g id="edge4" class="edge">
<title>layer0_attention_0&#45;&gt;layer0_attn_out_proj_0</title>
<path fill="none" stroke="black" d="M1505,-7675.05C1505,-7675.05 1505,-7649.46 1505,-7649.46"/>
<polygon fill="black" stroke="black" points="1508.5,-7649.46 1505,-7639.46 1501.5,-7649.46 1508.5,-7649.46"/>
</g>
<!-- layer0_attn_out_proj_1 -->
<g id="node28" class="node">
<title>layer0_attn_out_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="2280.5,-7639.17 1785.5,-7639.17 1785.5,-7556.17 2280.5,-7556.17 2280.5,-7639.17"/>
<text text-anchor="middle" x="2033" y="-7623.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="2033" y="-7608.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="2033" y="-7593.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2033" y="-7578.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="2033" y="-7563.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_attention_1&#45;&gt;layer0_attn_out_proj_1 -->
<g id="edge8" class="edge">
<title>layer0_attention_1&#45;&gt;layer0_attn_out_proj_1</title>
<path fill="none" stroke="black" d="M2030,-7675.05C2030,-7675.05 2030,-7649.46 2030,-7649.46"/>
<polygon fill="black" stroke="black" points="2033.5,-7649.46 2030,-7639.46 2026.5,-7649.46 2033.5,-7649.46"/>
</g>
<!-- layer0_attn_out_proj_2 -->
<g id="node29" class="node">
<title>layer0_attn_out_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="2805.5,-7639.17 2310.5,-7639.17 2310.5,-7556.17 2805.5,-7556.17 2805.5,-7639.17"/>
<text text-anchor="middle" x="2558" y="-7623.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="2558" y="-7608.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="2558" y="-7593.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2558" y="-7578.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="2558" y="-7563.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_attention_2&#45;&gt;layer0_attn_out_proj_2 -->
<g id="edge12" class="edge">
<title>layer0_attention_2&#45;&gt;layer0_attn_out_proj_2</title>
<path fill="none" stroke="black" d="M2555,-7675.05C2555,-7675.05 2555,-7649.46 2555,-7649.46"/>
<polygon fill="black" stroke="black" points="2558.5,-7649.46 2555,-7639.46 2551.5,-7649.46 2558.5,-7649.46"/>
</g>
<!-- layer0_attn_out_proj_3 -->
<g id="node30" class="node">
<title>layer0_attn_out_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="3330.5,-7639.17 2835.5,-7639.17 2835.5,-7556.17 3330.5,-7556.17 3330.5,-7639.17"/>
<text text-anchor="middle" x="3083" y="-7623.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="3083" y="-7608.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3083" y="-7593.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3083" y="-7578.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="3083" y="-7563.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_attention_3&#45;&gt;layer0_attn_out_proj_3 -->
<g id="edge16" class="edge">
<title>layer0_attention_3&#45;&gt;layer0_attn_out_proj_3</title>
<path fill="none" stroke="black" d="M3080,-7675.05C3080,-7675.05 3080,-7649.46 3080,-7649.46"/>
<polygon fill="black" stroke="black" points="3083.5,-7649.46 3080,-7639.46 3076.5,-7649.46 3083.5,-7649.46"/>
</g>
<!-- layer0_attn_out_proj_4 -->
<g id="node31" class="node">
<title>layer0_attn_out_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="3855.5,-7639.17 3360.5,-7639.17 3360.5,-7556.17 3855.5,-7556.17 3855.5,-7639.17"/>
<text text-anchor="middle" x="3608" y="-7623.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="3608" y="-7608.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3608" y="-7593.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3608" y="-7578.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="3608" y="-7563.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_attention_4&#45;&gt;layer0_attn_out_proj_4 -->
<g id="edge20" class="edge">
<title>layer0_attention_4&#45;&gt;layer0_attn_out_proj_4</title>
<path fill="none" stroke="black" d="M3605,-7675.05C3605,-7675.05 3605,-7649.46 3605,-7649.46"/>
<polygon fill="black" stroke="black" points="3608.5,-7649.46 3605,-7639.46 3601.5,-7649.46 3608.5,-7649.46"/>
</g>
<!-- layer0_attn_out_proj_5 -->
<g id="node32" class="node">
<title>layer0_attn_out_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="4374.5,-7639.17 3879.5,-7639.17 3879.5,-7556.17 4374.5,-7556.17 4374.5,-7639.17"/>
<text text-anchor="middle" x="4127" y="-7623.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="4127" y="-7608.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4127" y="-7593.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4127" y="-7578.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="4127" y="-7563.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_attention_5&#45;&gt;layer0_attn_out_proj_5 -->
<g id="edge24" class="edge">
<title>layer0_attention_5&#45;&gt;layer0_attn_out_proj_5</title>
<path fill="none" stroke="black" d="M4127,-7675.05C4127,-7675.05 4127,-7649.46 4127,-7649.46"/>
<polygon fill="black" stroke="black" points="4130.5,-7649.46 4127,-7639.46 4123.5,-7649.46 4130.5,-7649.46"/>
</g>
<!-- layer0_attn_out_proj_6 -->
<g id="node33" class="node">
<title>layer0_attn_out_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="4893.5,-7639.17 4398.5,-7639.17 4398.5,-7556.17 4893.5,-7556.17 4893.5,-7639.17"/>
<text text-anchor="middle" x="4646" y="-7623.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="4646" y="-7608.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4646" y="-7593.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4646" y="-7578.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="4646" y="-7563.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_attention_6&#45;&gt;layer0_attn_out_proj_6 -->
<g id="edge28" class="edge">
<title>layer0_attention_6&#45;&gt;layer0_attn_out_proj_6</title>
<path fill="none" stroke="black" d="M4646,-7675.05C4646,-7675.05 4646,-7649.46 4646,-7649.46"/>
<polygon fill="black" stroke="black" points="4649.5,-7649.46 4646,-7639.46 4642.5,-7649.46 4649.5,-7649.46"/>
</g>
<!-- layer0_attn_out_proj_7 -->
<g id="node34" class="node">
<title>layer0_attn_out_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="5412.5,-7639.17 4917.5,-7639.17 4917.5,-7556.17 5412.5,-7556.17 5412.5,-7639.17"/>
<text text-anchor="middle" x="5165" y="-7623.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="5165" y="-7608.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="5165" y="-7593.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5165" y="-7578.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="5165" y="-7563.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_attention_7&#45;&gt;layer0_attn_out_proj_7 -->
<g id="edge32" class="edge">
<title>layer0_attention_7&#45;&gt;layer0_attn_out_proj_7</title>
<path fill="none" stroke="black" d="M5165,-7675.05C5165,-7675.05 5165,-7649.46 5165,-7649.46"/>
<polygon fill="black" stroke="black" points="5168.5,-7649.46 5165,-7639.46 5161.5,-7649.46 5168.5,-7649.46"/>
</g>
<!-- layer0_attn_out_proj_8 -->
<g id="node35" class="node">
<title>layer0_attn_out_proj_8</title>
<polygon fill="lightcoral" stroke="black" points="5934.5,-7639.17 5439.5,-7639.17 5439.5,-7556.17 5934.5,-7556.17 5934.5,-7639.17"/>
<text text-anchor="middle" x="5687" y="-7623.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="5687" y="-7608.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="5687" y="-7593.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="5687" y="-7578.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=256]</text>
<text text-anchor="middle" x="5687" y="-7563.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_attention_8&#45;&gt;layer0_attn_out_proj_8 -->
<g id="edge36" class="edge">
<title>layer0_attention_8&#45;&gt;layer0_attn_out_proj_8</title>
<path fill="none" stroke="black" d="M5688.5,-7675.05C5688.5,-7675.05 5688.5,-7649.46 5688.5,-7649.46"/>
<polygon fill="black" stroke="black" points="5692,-7649.46 5688.5,-7639.46 5685,-7649.46 5692,-7649.46"/>
</g>
<!-- layer0_attn_out_proj_9 -->
<g id="node36" class="node">
<title>layer0_attn_out_proj_9</title>
<polygon fill="lightcoral" stroke="black" points="6457.5,-7639.17 5962.5,-7639.17 5962.5,-7556.17 6457.5,-7556.17 6457.5,-7639.17"/>
<text text-anchor="middle" x="6210" y="-7623.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="6210" y="-7608.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="6210" y="-7593.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6210" y="-7578.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=256]</text>
<text text-anchor="middle" x="6210" y="-7563.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_attention_9&#45;&gt;layer0_attn_out_proj_9 -->
<g id="edge40" class="edge">
<title>layer0_attention_9&#45;&gt;layer0_attn_out_proj_9</title>
<path fill="none" stroke="black" d="M6212.5,-7675.05C6212.5,-7675.05 6212.5,-7649.46 6212.5,-7649.46"/>
<polygon fill="black" stroke="black" points="6216,-7649.46 6212.5,-7639.46 6209,-7649.46 6216,-7649.46"/>
</g>
<!-- layer0_attn_out_proj_10 -->
<g id="node37" class="node">
<title>layer0_attn_out_proj_10</title>
<polygon fill="lightcoral" stroke="black" points="6982.5,-7639.17 6487.5,-7639.17 6487.5,-7556.17 6982.5,-7556.17 6982.5,-7639.17"/>
<text text-anchor="middle" x="6735" y="-7623.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="6735" y="-7608.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="6735" y="-7593.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6735" y="-7578.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=256]</text>
<text text-anchor="middle" x="6735" y="-7563.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_attention_10&#45;&gt;layer0_attn_out_proj_10 -->
<g id="edge44" class="edge">
<title>layer0_attention_10&#45;&gt;layer0_attn_out_proj_10</title>
<path fill="none" stroke="black" d="M6737.5,-7675.05C6737.5,-7675.05 6737.5,-7649.46 6737.5,-7649.46"/>
<polygon fill="black" stroke="black" points="6741,-7649.46 6737.5,-7639.46 6734,-7649.46 6741,-7649.46"/>
</g>
<!-- layer0_attn_out_proj_11 -->
<g id="node38" class="node">
<title>layer0_attn_out_proj_11</title>
<polygon fill="lightcoral" stroke="black" points="7501.5,-7639.17 7006.5,-7639.17 7006.5,-7556.17 7501.5,-7556.17 7501.5,-7639.17"/>
<text text-anchor="middle" x="7254" y="-7623.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="7254" y="-7608.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="7254" y="-7593.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7254" y="-7578.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=256]</text>
<text text-anchor="middle" x="7254" y="-7563.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_attention_11&#45;&gt;layer0_attn_out_proj_11 -->
<g id="edge48" class="edge">
<title>layer0_attention_11&#45;&gt;layer0_attn_out_proj_11</title>
<path fill="none" stroke="black" d="M7259.5,-7675.05C7259.5,-7675.05 7259.5,-7649.46 7259.5,-7649.46"/>
<polygon fill="black" stroke="black" points="7263,-7649.46 7259.5,-7639.46 7256,-7649.46 7263,-7649.46"/>
</g>
<!-- layer0_attn_allreduce -->
<g id="node39" class="node">
<title>layer0_attn_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="5120.67,-7520.17 4365.58,-7520.17 4171.33,-7384.17 4926.42,-7384.17 5120.67,-7520.17"/>
<text text-anchor="middle" x="4646" y="-7470.97" font-family="Times,serif" font-size="14.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="4646" y="-7455.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4646" y="-7440.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4646" y="-7425.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer0_attn_out_proj_0&#45;&gt;layer0_attn_allreduce -->
<g id="edge5" class="edge">
<title>layer0_attn_out_proj_0&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M1508,-7556.08C1508,-7499.71 1508,-7406 1508,-7406 1508,-7406 4192.23,-7406 4192.23,-7406"/>
<polygon fill="black" stroke="black" points="4192.23,-7409.5 4202.23,-7406 4192.23,-7402.5 4192.23,-7409.5"/>
</g>
<!-- layer0_attn_out_proj_1&#45;&gt;layer0_attn_allreduce -->
<g id="edge9" class="edge">
<title>layer0_attn_out_proj_1&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M2245.5,-7555.97C2245.5,-7506.03 2245.5,-7429 2245.5,-7429 2245.5,-7429 4225.04,-7429 4225.04,-7429"/>
<polygon fill="black" stroke="black" points="4225.04,-7432.5 4235.04,-7429 4225.04,-7425.5 4225.04,-7432.5"/>
</g>
<!-- layer0_attn_out_proj_2&#45;&gt;layer0_attn_allreduce -->
<g id="edge13" class="edge">
<title>layer0_attn_out_proj_2&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M2749.5,-7555.92C2749.5,-7512.88 2749.5,-7452 2749.5,-7452 2749.5,-7452 4258.19,-7452 4258.19,-7452"/>
<polygon fill="black" stroke="black" points="4258.19,-7455.5 4268.19,-7452 4258.19,-7448.5 4258.19,-7455.5"/>
</g>
<!-- layer0_attn_out_proj_3&#45;&gt;layer0_attn_allreduce -->
<g id="edge17" class="edge">
<title>layer0_attn_out_proj_3&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M3128.7,-7556.14C3128.7,-7520.22 3128.7,-7474 3128.7,-7474 3128.7,-7474 4289.33,-7474 4289.33,-7474"/>
<polygon fill="black" stroke="black" points="4289.33,-7477.5 4299.33,-7474 4289.33,-7470.5 4289.33,-7477.5"/>
</g>
<!-- layer0_attn_out_proj_4&#45;&gt;layer0_attn_allreduce -->
<g id="edge21" class="edge">
<title>layer0_attn_out_proj_4&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M3608,-7556.14C3608,-7528.41 3608,-7497 3608,-7497 3608,-7497 4322.45,-7497 4322.45,-7497"/>
<polygon fill="black" stroke="black" points="4322.45,-7500.5 4332.45,-7497 4322.45,-7493.5 4322.45,-7500.5"/>
</g>
<!-- layer0_attn_out_proj_5&#45;&gt;layer0_attn_allreduce -->
<g id="edge25" class="edge">
<title>layer0_attn_out_proj_5&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M4272.83,-7555.97C4272.83,-7555.97 4272.83,-7465.56 4272.83,-7465.56"/>
<polygon fill="black" stroke="black" points="4276.33,-7465.56 4272.83,-7455.56 4269.33,-7465.56 4276.33,-7465.56"/>
</g>
<!-- layer0_attn_out_proj_6&#45;&gt;layer0_attn_allreduce -->
<g id="edge29" class="edge">
<title>layer0_attn_out_proj_6&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M4646,-7555.97C4646,-7555.97 4646,-7530.24 4646,-7530.24"/>
<polygon fill="black" stroke="black" points="4649.5,-7530.24 4646,-7520.24 4642.5,-7530.24 4649.5,-7530.24"/>
</g>
<!-- layer0_attn_out_proj_7&#45;&gt;layer0_attn_allreduce -->
<g id="edge33" class="edge">
<title>layer0_attn_out_proj_7&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M5019.17,-7555.97C5019.17,-7555.97 5019.17,-7530.24 5019.17,-7530.24"/>
<polygon fill="black" stroke="black" points="5022.67,-7530.24 5019.17,-7520.24 5015.67,-7530.24 5022.67,-7530.24"/>
</g>
<!-- layer0_attn_out_proj_8&#45;&gt;layer0_attn_allreduce -->
<g id="edge37" class="edge">
<title>layer0_attn_out_proj_8&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M5467.25,-7556.14C5467.25,-7528.41 5467.25,-7497 5467.25,-7497 5467.25,-7497 5097.88,-7497 5097.88,-7497"/>
<polygon fill="black" stroke="black" points="5097.88,-7493.5 5087.88,-7497 5097.88,-7500.5 5097.88,-7493.5"/>
</g>
<!-- layer0_attn_out_proj_9&#45;&gt;layer0_attn_allreduce -->
<g id="edge41" class="edge">
<title>layer0_attn_out_proj_9&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M6009.5,-7556.14C6009.5,-7520.22 6009.5,-7474 6009.5,-7474 6009.5,-7474 5065.09,-7474 5065.09,-7474"/>
<polygon fill="black" stroke="black" points="5065.09,-7470.5 5055.09,-7474 5065.09,-7477.5 5065.09,-7470.5"/>
</g>
<!-- layer0_attn_out_proj_10&#45;&gt;layer0_attn_allreduce -->
<g id="edge45" class="edge">
<title>layer0_attn_out_proj_10&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M6549.75,-7555.92C6549.75,-7512.88 6549.75,-7452 6549.75,-7452 6549.75,-7452 5033.54,-7452 5033.54,-7452"/>
<polygon fill="black" stroke="black" points="5033.54,-7448.5 5023.54,-7452 5033.54,-7455.5 5033.54,-7448.5"/>
</g>
<!-- layer0_attn_out_proj_11&#45;&gt;layer0_attn_allreduce -->
<g id="edge49" class="edge">
<title>layer0_attn_out_proj_11&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M7254,-7555.97C7254,-7506.03 7254,-7429 7254,-7429 7254,-7429 5000.64,-7429 5000.64,-7429"/>
<polygon fill="black" stroke="black" points="5000.64,-7425.5 4990.64,-7429 5000.64,-7432.5 5000.64,-7425.5"/>
</g>
<!-- layer0_attn_allreduce&#45;&gt;layer0_residual1 -->
<g id="edge50" class="edge">
<title>layer0_attn_allreduce&#45;&gt;layer0_residual1</title>
<path fill="none" stroke="black" d="M4957.66,-7406C5553.86,-7406 6797.25,-7406 6797.25,-7406 6797.25,-7406 6797.25,-7308.9 6797.25,-7308.9"/>
<polygon fill="black" stroke="black" points="6800.75,-7308.9 6797.25,-7298.9 6793.75,-7308.9 6800.75,-7308.9"/>
</g>
<!-- layer0_ln2 -->
<g id="node41" class="node">
<title>layer0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="5953,-7146.17 5495,-7146.17 5495,-7078.17 5953,-7078.17 5953,-7146.17"/>
<text text-anchor="middle" x="5724" y="-7130.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5724" y="-7115.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5724" y="-7100.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5724" y="-7085.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer0_residual1&#45;&gt;layer0_ln2 -->
<g id="edge52" class="edge">
<title>layer0_residual1&#45;&gt;layer0_ln2</title>
<path fill="none" stroke="black" d="M6759.9,-7292C6425.98,-7292 5942,-7292 5942,-7292 5942,-7292 5942,-7156.42 5942,-7156.42"/>
<polygon fill="black" stroke="black" points="5945.5,-7156.42 5942,-7146.42 5938.5,-7156.42 5945.5,-7156.42"/>
</g>
<!-- layer0_residual2 -->
<g id="node68" class="node">
<title>layer0_residual2</title>
<polygon fill="lightpink" stroke="black" points="5863,-6220.17 5405,-6137.17 5863,-6054.17 6321,-6137.17 5863,-6220.17"/>
<text text-anchor="middle" x="5863" y="-6163.47" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5863" y="-6148.47" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5863" y="-6133.47" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5863" y="-6118.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5863" y="-6103.47" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer0_residual1&#45;&gt;layer0_residual2 -->
<g id="edge95" class="edge">
<title>layer0_residual1&#45;&gt;layer0_residual2</title>
<path fill="none" stroke="black" d="M6767.25,-7237C6471.49,-7237 6065.5,-7237 6065.5,-7237 6065.5,-7237 6065.5,-6193.72 6065.5,-6193.72"/>
<polygon fill="black" stroke="black" points="6069,-6193.72 6065.5,-6183.72 6062,-6193.72 6069,-6193.72"/>
</g>
<!-- layer0_gate -->
<g id="node42" class="node">
<title>layer0_gate</title>
<polygon fill="lightblue" stroke="black" points="5565.58,-7042.17 4823.36,-7042.17 4632.42,-6906.17 5374.64,-6906.17 5565.58,-7042.17"/>
<text text-anchor="middle" x="5099" y="-6992.97" font-family="Times,serif" font-size="14.00">Gate Computation</text>
<text text-anchor="middle" x="5099" y="-6977.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5099" y="-6962.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="5099" y="-6947.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer0_ln2&#45;&gt;layer0_gate -->
<g id="edge53" class="edge">
<title>layer0_ln2&#45;&gt;layer0_gate</title>
<path fill="none" stroke="black" d="M5530.27,-7078.05C5530.27,-7078.05 5530.27,-6984.21 5530.27,-6984.21"/>
<polygon fill="black" stroke="black" points="5533.77,-6984.21 5530.27,-6974.21 5526.77,-6984.21 5533.77,-6984.21"/>
</g>
<!-- layer0_route_0 -->
<g id="node43" class="node">
<title>layer0_route_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1959.18,-6870.17 1192.14,-6870.17 994.82,-6704.17 1761.86,-6704.17 1959.18,-6870.17"/>
<text text-anchor="middle" x="1477" y="-6813.47" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="1477" y="-6798.47" font-family="Times,serif" font-size="14.00">Experts=[0&#45;3]</text>
<text text-anchor="middle" x="1477" y="-6783.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1477" y="-6768.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="1477" y="-6753.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_0 -->
<g id="edge54" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4758.26,-6996C3928.82,-6996 1872.3,-6996 1872.3,-6996 1872.3,-6996 1872.3,-6880.3 1872.3,-6880.3"/>
<polygon fill="black" stroke="black" points="1875.8,-6880.3 1872.3,-6870.3 1868.8,-6880.3 1875.8,-6880.3"/>
</g>
<!-- layer0_route_1 -->
<g id="node49" class="node">
<title>layer0_route_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3891.18,-6870.17 3124.14,-6870.17 2926.82,-6704.17 3693.86,-6704.17 3891.18,-6870.17"/>
<text text-anchor="middle" x="3409" y="-6813.47" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="3409" y="-6798.47" font-family="Times,serif" font-size="14.00">Experts=[4&#45;7]</text>
<text text-anchor="middle" x="3409" y="-6783.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3409" y="-6768.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="3409" y="-6753.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_1 -->
<g id="edge63" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4695.28,-6951C4342.15,-6951 3885.3,-6951 3885.3,-6951 3885.3,-6951 3885.3,-6880.52 3885.3,-6880.52"/>
<polygon fill="black" stroke="black" points="3888.8,-6880.52 3885.3,-6870.52 3881.8,-6880.52 3888.8,-6880.52"/>
</g>
<!-- layer0_route_2 -->
<g id="node55" class="node">
<title>layer0_route_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="5581.18,-6870.17 4814.14,-6870.17 4616.82,-6704.17 5383.86,-6704.17 5581.18,-6870.17"/>
<text text-anchor="middle" x="5099" y="-6813.47" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="5099" y="-6798.47" font-family="Times,serif" font-size="14.00">Experts=[8&#45;11]</text>
<text text-anchor="middle" x="5099" y="-6783.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5099" y="-6768.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="5099" y="-6753.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_2 -->
<g id="edge72" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5099,-6906.13C5099,-6906.13 5099,-6880.45 5099,-6880.45"/>
<polygon fill="black" stroke="black" points="5102.5,-6880.45 5099,-6870.45 5095.5,-6880.45 5102.5,-6880.45"/>
</g>
<!-- layer0_route_3 -->
<g id="node61" class="node">
<title>layer0_route_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7272.18,-6870.17 6505.14,-6870.17 6307.82,-6704.17 7074.86,-6704.17 7272.18,-6870.17"/>
<text text-anchor="middle" x="6790" y="-6813.47" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="6790" y="-6798.47" font-family="Times,serif" font-size="14.00">Experts=[12&#45;15]</text>
<text text-anchor="middle" x="6790" y="-6783.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6790" y="-6768.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="6790" y="-6753.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_3 -->
<g id="edge81" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5470.3,-6974C5849.43,-6974 6382.7,-6974 6382.7,-6974 6382.7,-6974 6382.7,-6797.3 6382.7,-6797.3"/>
<polygon fill="black" stroke="black" points="6386.2,-6797.3 6382.7,-6787.3 6379.2,-6797.3 6386.2,-6797.3"/>
</g>
<!-- layer0_expert_0 -->
<g id="node44" class="node">
<title>layer0_expert_0</title>
<polygon fill="lightsteelblue" stroke="black" points="743.5,-6668.17 278.5,-6668.17 278.5,-6600.17 743.5,-6600.17 743.5,-6668.17"/>
<text text-anchor="middle" x="511" y="-6652.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="511" y="-6637.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="511" y="-6622.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="511" y="-6607.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_route_0&#45;&gt;layer0_expert_0 -->
<g id="edge55" class="edge">
<title>layer0_route_0&#45;&gt;layer0_expert_0</title>
<path fill="none" stroke="black" d="M1093.13,-6787C823.59,-6787 511,-6787 511,-6787 511,-6787 511,-6678.47 511,-6678.47"/>
<polygon fill="black" stroke="black" points="514.5,-6678.47 511,-6668.47 507.5,-6678.47 514.5,-6678.47"/>
</g>
<!-- layer0_expert_1 -->
<g id="node45" class="node">
<title>layer0_expert_1</title>
<polygon fill="lightsteelblue" stroke="black" points="1226.5,-6668.17 761.5,-6668.17 761.5,-6600.17 1226.5,-6600.17 1226.5,-6668.17"/>
<text text-anchor="middle" x="994" y="-6652.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="994" y="-6637.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="994" y="-6622.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="994" y="-6607.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_route_0&#45;&gt;layer0_expert_1 -->
<g id="edge57" class="edge">
<title>layer0_route_0&#45;&gt;layer0_expert_1</title>
<path fill="none" stroke="black" d="M1110.7,-6703.95C1110.7,-6703.95 1110.7,-6678.23 1110.7,-6678.23"/>
<polygon fill="black" stroke="black" points="1114.2,-6678.23 1110.7,-6668.23 1107.2,-6678.23 1114.2,-6678.23"/>
</g>
<!-- layer0_expert_2 -->
<g id="node46" class="node">
<title>layer0_expert_2</title>
<polygon fill="lightsteelblue" stroke="black" points="1709.5,-6668.17 1244.5,-6668.17 1244.5,-6600.17 1709.5,-6600.17 1709.5,-6668.17"/>
<text text-anchor="middle" x="1477" y="-6652.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1477" y="-6637.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1477" y="-6622.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="1477" y="-6607.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_route_0&#45;&gt;layer0_expert_2 -->
<g id="edge59" class="edge">
<title>layer0_route_0&#45;&gt;layer0_expert_2</title>
<path fill="none" stroke="black" d="M1477,-6703.95C1477,-6703.95 1477,-6678.23 1477,-6678.23"/>
<polygon fill="black" stroke="black" points="1480.5,-6678.23 1477,-6668.23 1473.5,-6678.23 1480.5,-6678.23"/>
</g>
<!-- layer0_expert_3 -->
<g id="node47" class="node">
<title>layer0_expert_3</title>
<polygon fill="lightsteelblue" stroke="black" points="2192.5,-6668.17 1727.5,-6668.17 1727.5,-6600.17 2192.5,-6600.17 2192.5,-6668.17"/>
<text text-anchor="middle" x="1960" y="-6652.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1960" y="-6637.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1960" y="-6622.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="1960" y="-6607.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_route_0&#45;&gt;layer0_expert_3 -->
<g id="edge61" class="edge">
<title>layer0_route_0&#45;&gt;layer0_expert_3</title>
<path fill="none" stroke="black" d="M1843.3,-6772.5C1843.3,-6772.5 1843.3,-6678.45 1843.3,-6678.45"/>
<polygon fill="black" stroke="black" points="1846.8,-6678.45 1843.3,-6668.45 1839.8,-6678.45 1846.8,-6678.45"/>
</g>
<!-- layer0_expert_agg_0 -->
<g id="node48" class="node">
<title>layer0_expert_agg_0</title>
<polygon fill="lightyellow" stroke="black" points="1951.67,-6564.17 1196.58,-6564.17 1002.33,-6428.17 1757.42,-6428.17 1951.67,-6564.17"/>
<text text-anchor="middle" x="1477" y="-6514.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1477" y="-6499.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="1477" y="-6484.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1477" y="-6469.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_expert_0&#45;&gt;layer0_expert_agg_0 -->
<g id="edge56" class="edge">
<title>layer0_expert_0&#45;&gt;layer0_expert_agg_0</title>
<path fill="none" stroke="black" d="M738.2,-6600.01C738.2,-6559.1 738.2,-6496 738.2,-6496 738.2,-6496 1089.22,-6496 1089.22,-6496"/>
<polygon fill="black" stroke="black" points="1089.22,-6499.5 1099.22,-6496 1089.22,-6492.5 1089.22,-6499.5"/>
</g>
<!-- layer0_expert_1&#45;&gt;layer0_expert_agg_0 -->
<g id="edge58" class="edge">
<title>layer0_expert_1&#45;&gt;layer0_expert_agg_0</title>
<path fill="none" stroke="black" d="M1114.33,-6600.05C1114.33,-6600.05 1114.33,-6516.65 1114.33,-6516.65"/>
<polygon fill="black" stroke="black" points="1117.83,-6516.65 1114.33,-6506.65 1110.83,-6516.65 1117.83,-6516.65"/>
</g>
<!-- layer0_expert_2&#45;&gt;layer0_expert_agg_0 -->
<g id="edge60" class="edge">
<title>layer0_expert_2&#45;&gt;layer0_expert_agg_0</title>
<path fill="none" stroke="black" d="M1477,-6600.05C1477,-6600.05 1477,-6574.4 1477,-6574.4"/>
<polygon fill="black" stroke="black" points="1480.5,-6574.4 1477,-6564.4 1473.5,-6574.4 1480.5,-6574.4"/>
</g>
<!-- layer0_expert_3&#45;&gt;layer0_expert_agg_0 -->
<g id="edge62" class="edge">
<title>layer0_expert_3&#45;&gt;layer0_expert_agg_0</title>
<path fill="none" stroke="black" d="M1839.67,-6600.05C1839.67,-6600.05 1839.67,-6574.4 1839.67,-6574.4"/>
<polygon fill="black" stroke="black" points="1843.17,-6574.4 1839.67,-6564.4 1836.17,-6574.4 1843.17,-6574.4"/>
</g>
<!-- layer0_expert_allreduce -->
<g id="node67" class="node">
<title>layer0_expert_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="5573.67,-6392.17 4818.58,-6392.17 4624.33,-6256.17 5379.42,-6256.17 5573.67,-6392.17"/>
<text text-anchor="middle" x="5099" y="-6342.97" font-family="Times,serif" font-size="14.00">MoE All&#45;Reduce</text>
<text text-anchor="middle" x="5099" y="-6327.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5099" y="-6312.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5099" y="-6297.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer0_expert_agg_0&#45;&gt;layer0_expert_allreduce -->
<g id="edge90" class="edge">
<title>layer0_expert_agg_0&#45;&gt;layer0_expert_allreduce</title>
<path fill="none" stroke="black" d="M1840.17,-6485.95C1840.17,-6445.79 1840.17,-6301 1840.17,-6301 1840.17,-6301 4678.33,-6301 4678.33,-6301"/>
<polygon fill="black" stroke="black" points="4678.33,-6304.5 4688.33,-6301 4678.33,-6297.5 4678.33,-6304.5"/>
</g>
<!-- layer0_expert_4 -->
<g id="node50" class="node">
<title>layer0_expert_4</title>
<polygon fill="lightsteelblue" stroke="black" points="2675.5,-6668.17 2210.5,-6668.17 2210.5,-6600.17 2675.5,-6600.17 2675.5,-6668.17"/>
<text text-anchor="middle" x="2443" y="-6652.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2443" y="-6637.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2443" y="-6622.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="2443" y="-6607.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_route_1&#45;&gt;layer0_expert_4 -->
<g id="edge64" class="edge">
<title>layer0_route_1&#45;&gt;layer0_expert_4</title>
<path fill="none" stroke="black" d="M3025.18,-6787C2774.34,-6787 2493,-6787 2493,-6787 2493,-6787 2493,-6678.47 2493,-6678.47"/>
<polygon fill="black" stroke="black" points="2496.5,-6678.47 2493,-6668.47 2489.5,-6678.47 2496.5,-6678.47"/>
</g>
<!-- layer0_expert_5 -->
<g id="node51" class="node">
<title>layer0_expert_5</title>
<polygon fill="lightsteelblue" stroke="black" points="3158.5,-6668.17 2693.5,-6668.17 2693.5,-6600.17 3158.5,-6600.17 3158.5,-6668.17"/>
<text text-anchor="middle" x="2926" y="-6652.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2926" y="-6637.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2926" y="-6622.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="2926" y="-6607.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_route_1&#45;&gt;layer0_expert_5 -->
<g id="edge66" class="edge">
<title>layer0_route_1&#45;&gt;layer0_expert_5</title>
<path fill="none" stroke="black" d="M3042.7,-6703.95C3042.7,-6703.95 3042.7,-6678.23 3042.7,-6678.23"/>
<polygon fill="black" stroke="black" points="3046.2,-6678.23 3042.7,-6668.23 3039.2,-6678.23 3046.2,-6678.23"/>
</g>
<!-- layer0_expert_6 -->
<g id="node52" class="node">
<title>layer0_expert_6</title>
<polygon fill="lightsteelblue" stroke="black" points="3641.5,-6668.17 3176.5,-6668.17 3176.5,-6600.17 3641.5,-6600.17 3641.5,-6668.17"/>
<text text-anchor="middle" x="3409" y="-6652.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="3409" y="-6637.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3409" y="-6622.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="3409" y="-6607.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_route_1&#45;&gt;layer0_expert_6 -->
<g id="edge68" class="edge">
<title>layer0_route_1&#45;&gt;layer0_expert_6</title>
<path fill="none" stroke="black" d="M3409,-6703.95C3409,-6703.95 3409,-6678.23 3409,-6678.23"/>
<polygon fill="black" stroke="black" points="3412.5,-6678.23 3409,-6668.23 3405.5,-6678.23 3412.5,-6678.23"/>
</g>
<!-- layer0_expert_7 -->
<g id="node53" class="node">
<title>layer0_expert_7</title>
<polygon fill="lightsteelblue" stroke="black" points="4124.5,-6668.17 3659.5,-6668.17 3659.5,-6600.17 4124.5,-6600.17 4124.5,-6668.17"/>
<text text-anchor="middle" x="3892" y="-6652.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3892" y="-6637.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3892" y="-6622.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="3892" y="-6607.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_route_1&#45;&gt;layer0_expert_7 -->
<g id="edge70" class="edge">
<title>layer0_route_1&#45;&gt;layer0_expert_7</title>
<path fill="none" stroke="black" d="M3775.3,-6772.5C3775.3,-6772.5 3775.3,-6678.45 3775.3,-6678.45"/>
<polygon fill="black" stroke="black" points="3778.8,-6678.45 3775.3,-6668.45 3771.8,-6678.45 3778.8,-6678.45"/>
</g>
<!-- layer0_expert_agg_1 -->
<g id="node54" class="node">
<title>layer0_expert_agg_1</title>
<polygon fill="lightyellow" stroke="black" points="3883.67,-6564.17 3128.58,-6564.17 2934.33,-6428.17 3689.42,-6428.17 3883.67,-6564.17"/>
<text text-anchor="middle" x="3409" y="-6514.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3409" y="-6499.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="3409" y="-6484.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3409" y="-6469.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_expert_4&#45;&gt;layer0_expert_agg_1 -->
<g id="edge65" class="edge">
<title>layer0_expert_4&#45;&gt;layer0_expert_agg_1</title>
<path fill="none" stroke="black" d="M2464.5,-6600.01C2464.5,-6559.1 2464.5,-6496 2464.5,-6496 2464.5,-6496 3020.96,-6496 3020.96,-6496"/>
<polygon fill="black" stroke="black" points="3020.96,-6499.5 3030.96,-6496 3020.96,-6492.5 3020.96,-6499.5"/>
</g>
<!-- layer0_expert_5&#45;&gt;layer0_expert_agg_1 -->
<g id="edge67" class="edge">
<title>layer0_expert_5&#45;&gt;layer0_expert_agg_1</title>
<path fill="none" stroke="black" d="M3046.33,-6600.05C3046.33,-6600.05 3046.33,-6516.65 3046.33,-6516.65"/>
<polygon fill="black" stroke="black" points="3049.83,-6516.65 3046.33,-6506.65 3042.83,-6516.65 3049.83,-6516.65"/>
</g>
<!-- layer0_expert_6&#45;&gt;layer0_expert_agg_1 -->
<g id="edge69" class="edge">
<title>layer0_expert_6&#45;&gt;layer0_expert_agg_1</title>
<path fill="none" stroke="black" d="M3409,-6600.05C3409,-6600.05 3409,-6574.4 3409,-6574.4"/>
<polygon fill="black" stroke="black" points="3412.5,-6574.4 3409,-6564.4 3405.5,-6574.4 3412.5,-6574.4"/>
</g>
<!-- layer0_expert_7&#45;&gt;layer0_expert_agg_1 -->
<g id="edge71" class="edge">
<title>layer0_expert_7&#45;&gt;layer0_expert_agg_1</title>
<path fill="none" stroke="black" d="M3771.67,-6600.05C3771.67,-6600.05 3771.67,-6574.4 3771.67,-6574.4"/>
<polygon fill="black" stroke="black" points="3775.17,-6574.4 3771.67,-6564.4 3768.17,-6574.4 3775.17,-6574.4"/>
</g>
<!-- layer0_expert_agg_1&#45;&gt;layer0_expert_allreduce -->
<g id="edge91" class="edge">
<title>layer0_expert_agg_1&#45;&gt;layer0_expert_allreduce</title>
<path fill="none" stroke="black" d="M3856.17,-6496.06C3856.17,-6491.51 3856.17,-6346 3856.17,-6346 3856.17,-6346 4742.39,-6346 4742.39,-6346"/>
<polygon fill="black" stroke="black" points="4742.39,-6349.5 4752.39,-6346 4742.39,-6342.5 4742.39,-6349.5"/>
</g>
<!-- layer0_expert_8 -->
<g id="node56" class="node">
<title>layer0_expert_8</title>
<polygon fill="lightsteelblue" stroke="black" points="4607.5,-6668.17 4142.5,-6668.17 4142.5,-6600.17 4607.5,-6600.17 4607.5,-6668.17"/>
<text text-anchor="middle" x="4375" y="-6652.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="4375" y="-6637.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4375" y="-6622.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="4375" y="-6607.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_route_2&#45;&gt;layer0_expert_8 -->
<g id="edge73" class="edge">
<title>layer0_route_2&#45;&gt;layer0_expert_8</title>
<path fill="none" stroke="black" d="M4620.54,-6787.06C4620.54,-6782.42 4620.54,-6634 4620.54,-6634 4620.54,-6634 4617.68,-6634 4617.68,-6634"/>
<polygon fill="black" stroke="black" points="4617.68,-6630.5 4607.68,-6634 4617.68,-6637.5 4617.68,-6630.5"/>
</g>
<!-- layer0_expert_9 -->
<g id="node57" class="node">
<title>layer0_expert_9</title>
<polygon fill="lightsteelblue" stroke="black" points="5090.5,-6668.17 4625.5,-6668.17 4625.5,-6600.17 5090.5,-6600.17 5090.5,-6668.17"/>
<text text-anchor="middle" x="4858" y="-6652.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="4858" y="-6637.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4858" y="-6622.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="4858" y="-6607.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_route_2&#45;&gt;layer0_expert_9 -->
<g id="edge75" class="edge">
<title>layer0_route_2&#45;&gt;layer0_expert_9</title>
<path fill="none" stroke="black" d="M4858,-6703.95C4858,-6703.95 4858,-6678.23 4858,-6678.23"/>
<polygon fill="black" stroke="black" points="4861.5,-6678.23 4858,-6668.23 4854.5,-6678.23 4861.5,-6678.23"/>
</g>
<!-- layer0_expert_10 -->
<g id="node58" class="node">
<title>layer0_expert_10</title>
<polygon fill="lightsteelblue" stroke="black" points="5573.5,-6668.17 5108.5,-6668.17 5108.5,-6600.17 5573.5,-6600.17 5573.5,-6668.17"/>
<text text-anchor="middle" x="5341" y="-6652.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="5341" y="-6637.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5341" y="-6622.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="5341" y="-6607.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_route_2&#45;&gt;layer0_expert_10 -->
<g id="edge77" class="edge">
<title>layer0_route_2&#45;&gt;layer0_expert_10</title>
<path fill="none" stroke="black" d="M5341,-6703.95C5341,-6703.95 5341,-6678.23 5341,-6678.23"/>
<polygon fill="black" stroke="black" points="5344.5,-6678.23 5341,-6668.23 5337.5,-6678.23 5344.5,-6678.23"/>
</g>
<!-- layer0_expert_11 -->
<g id="node59" class="node">
<title>layer0_expert_11</title>
<polygon fill="lightsteelblue" stroke="black" points="6056.5,-6668.17 5591.5,-6668.17 5591.5,-6600.17 6056.5,-6600.17 6056.5,-6668.17"/>
<text text-anchor="middle" x="5824" y="-6652.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="5824" y="-6637.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5824" y="-6622.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="5824" y="-6607.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_route_2&#45;&gt;layer0_expert_11 -->
<g id="edge79" class="edge">
<title>layer0_route_2&#45;&gt;layer0_expert_11</title>
<path fill="none" stroke="black" d="M5577.46,-6787.06C5577.46,-6782.42 5577.46,-6634 5577.46,-6634 5577.46,-6634 5581.42,-6634 5581.42,-6634"/>
<polygon fill="black" stroke="black" points="5581.42,-6637.5 5591.42,-6634 5581.42,-6630.5 5581.42,-6637.5"/>
</g>
<!-- layer0_expert_agg_2 -->
<g id="node60" class="node">
<title>layer0_expert_agg_2</title>
<polygon fill="lightyellow" stroke="black" points="5573.67,-6564.17 4818.58,-6564.17 4624.33,-6428.17 5379.42,-6428.17 5573.67,-6564.17"/>
<text text-anchor="middle" x="5099" y="-6514.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5099" y="-6499.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="5099" y="-6484.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5099" y="-6469.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_expert_8&#45;&gt;layer0_expert_agg_2 -->
<g id="edge74" class="edge">
<title>layer0_expert_8&#45;&gt;layer0_expert_agg_2</title>
<path fill="none" stroke="black" d="M4492.75,-6600.01C4492.75,-6559.1 4492.75,-6496 4492.75,-6496 4492.75,-6496 4711.08,-6496 4711.08,-6496"/>
<polygon fill="black" stroke="black" points="4711.08,-6499.5 4721.08,-6496 4711.08,-6492.5 4711.08,-6499.5"/>
</g>
<!-- layer0_expert_9&#45;&gt;layer0_expert_agg_2 -->
<g id="edge76" class="edge">
<title>layer0_expert_9&#45;&gt;layer0_expert_agg_2</title>
<path fill="none" stroke="black" d="M4858,-6600.05C4858,-6600.05 4858,-6574.4 4858,-6574.4"/>
<polygon fill="black" stroke="black" points="4861.5,-6574.4 4858,-6564.4 4854.5,-6574.4 4861.5,-6574.4"/>
</g>
<!-- layer0_expert_10&#45;&gt;layer0_expert_agg_2 -->
<g id="edge78" class="edge">
<title>layer0_expert_10&#45;&gt;layer0_expert_agg_2</title>
<path fill="none" stroke="black" d="M5341,-6600.05C5341,-6600.05 5341,-6574.4 5341,-6574.4"/>
<polygon fill="black" stroke="black" points="5344.5,-6574.4 5341,-6564.4 5337.5,-6574.4 5344.5,-6574.4"/>
</g>
<!-- layer0_expert_11&#45;&gt;layer0_expert_agg_2 -->
<g id="edge80" class="edge">
<title>layer0_expert_11&#45;&gt;layer0_expert_agg_2</title>
<path fill="none" stroke="black" d="M5824,-6600.01C5824,-6559.1 5824,-6496 5824,-6496 5824,-6496 5486.36,-6496 5486.36,-6496"/>
<polygon fill="black" stroke="black" points="5486.36,-6492.5 5476.36,-6496 5486.36,-6499.5 5486.36,-6492.5"/>
</g>
<!-- layer0_expert_agg_2&#45;&gt;layer0_expert_allreduce -->
<g id="edge92" class="edge">
<title>layer0_expert_agg_2&#45;&gt;layer0_expert_allreduce</title>
<path fill="none" stroke="black" d="M5099,-6427.69C5099,-6427.69 5099,-6402.4 5099,-6402.4"/>
<polygon fill="black" stroke="black" points="5102.5,-6402.4 5099,-6392.4 5095.5,-6402.4 5102.5,-6402.4"/>
</g>
<!-- layer0_expert_12 -->
<g id="node62" class="node">
<title>layer0_expert_12</title>
<polygon fill="lightsteelblue" stroke="black" points="6539.5,-6668.17 6074.5,-6668.17 6074.5,-6600.17 6539.5,-6600.17 6539.5,-6668.17"/>
<text text-anchor="middle" x="6307" y="-6652.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="6307" y="-6637.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6307" y="-6622.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="6307" y="-6607.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_route_3&#45;&gt;layer0_expert_12 -->
<g id="edge82" class="edge">
<title>layer0_route_3&#45;&gt;layer0_expert_12</title>
<path fill="none" stroke="black" d="M6423.7,-6703.95C6423.7,-6703.95 6423.7,-6678.23 6423.7,-6678.23"/>
<polygon fill="black" stroke="black" points="6427.2,-6678.23 6423.7,-6668.23 6420.2,-6678.23 6427.2,-6678.23"/>
</g>
<!-- layer0_expert_13 -->
<g id="node63" class="node">
<title>layer0_expert_13</title>
<polygon fill="lightsteelblue" stroke="black" points="7022.5,-6668.17 6557.5,-6668.17 6557.5,-6600.17 7022.5,-6600.17 7022.5,-6668.17"/>
<text text-anchor="middle" x="6790" y="-6652.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="6790" y="-6637.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6790" y="-6622.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="6790" y="-6607.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_route_3&#45;&gt;layer0_expert_13 -->
<g id="edge84" class="edge">
<title>layer0_route_3&#45;&gt;layer0_expert_13</title>
<path fill="none" stroke="black" d="M6790,-6703.95C6790,-6703.95 6790,-6678.23 6790,-6678.23"/>
<polygon fill="black" stroke="black" points="6793.5,-6678.23 6790,-6668.23 6786.5,-6678.23 6793.5,-6678.23"/>
</g>
<!-- layer0_expert_14 -->
<g id="node64" class="node">
<title>layer0_expert_14</title>
<polygon fill="lightsteelblue" stroke="black" points="7505.5,-6668.17 7040.5,-6668.17 7040.5,-6600.17 7505.5,-6600.17 7505.5,-6668.17"/>
<text text-anchor="middle" x="7273" y="-6652.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="7273" y="-6637.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7273" y="-6622.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="7273" y="-6607.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_route_3&#45;&gt;layer0_expert_14 -->
<g id="edge86" class="edge">
<title>layer0_route_3&#45;&gt;layer0_expert_14</title>
<path fill="none" stroke="black" d="M7156.3,-6772.5C7156.3,-6772.5 7156.3,-6678.45 7156.3,-6678.45"/>
<polygon fill="black" stroke="black" points="7159.8,-6678.45 7156.3,-6668.45 7152.8,-6678.45 7159.8,-6678.45"/>
</g>
<!-- layer0_expert_15 -->
<g id="node65" class="node">
<title>layer0_expert_15</title>
<polygon fill="lightsteelblue" stroke="black" points="7988.5,-6668.17 7523.5,-6668.17 7523.5,-6600.17 7988.5,-6600.17 7988.5,-6668.17"/>
<text text-anchor="middle" x="7756" y="-6652.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="7756" y="-6637.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7756" y="-6622.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="7756" y="-6607.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_route_3&#45;&gt;layer0_expert_15 -->
<g id="edge88" class="edge">
<title>layer0_route_3&#45;&gt;layer0_expert_15</title>
<path fill="none" stroke="black" d="M7173.37,-6787C7443.86,-6787 7758.25,-6787 7758.25,-6787 7758.25,-6787 7758.25,-6678.47 7758.25,-6678.47"/>
<polygon fill="black" stroke="black" points="7761.75,-6678.47 7758.25,-6668.47 7754.75,-6678.47 7761.75,-6678.47"/>
</g>
<!-- layer0_expert_agg_3 -->
<g id="node66" class="node">
<title>layer0_expert_agg_3</title>
<polygon fill="lightyellow" stroke="black" points="7264.67,-6564.17 6509.58,-6564.17 6315.33,-6428.17 7070.42,-6428.17 7264.67,-6564.17"/>
<text text-anchor="middle" x="6790" y="-6514.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="6790" y="-6499.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="6790" y="-6484.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6790" y="-6469.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_expert_12&#45;&gt;layer0_expert_agg_3 -->
<g id="edge83" class="edge">
<title>layer0_expert_12&#45;&gt;layer0_expert_agg_3</title>
<path fill="none" stroke="black" d="M6427.33,-6600.05C6427.33,-6600.05 6427.33,-6516.65 6427.33,-6516.65"/>
<polygon fill="black" stroke="black" points="6430.83,-6516.65 6427.33,-6506.65 6423.83,-6516.65 6430.83,-6516.65"/>
</g>
<!-- layer0_expert_13&#45;&gt;layer0_expert_agg_3 -->
<g id="edge85" class="edge">
<title>layer0_expert_13&#45;&gt;layer0_expert_agg_3</title>
<path fill="none" stroke="black" d="M6790,-6600.05C6790,-6600.05 6790,-6574.4 6790,-6574.4"/>
<polygon fill="black" stroke="black" points="6793.5,-6574.4 6790,-6564.4 6786.5,-6574.4 6793.5,-6574.4"/>
</g>
<!-- layer0_expert_14&#45;&gt;layer0_expert_agg_3 -->
<g id="edge87" class="edge">
<title>layer0_expert_14&#45;&gt;layer0_expert_agg_3</title>
<path fill="none" stroke="black" d="M7152.67,-6600.05C7152.67,-6600.05 7152.67,-6574.4 7152.67,-6574.4"/>
<polygon fill="black" stroke="black" points="7156.17,-6574.4 7152.67,-6564.4 7149.17,-6574.4 7156.17,-6574.4"/>
</g>
<!-- layer0_expert_15&#45;&gt;layer0_expert_agg_3 -->
<g id="edge89" class="edge">
<title>layer0_expert_15&#45;&gt;layer0_expert_agg_3</title>
<path fill="none" stroke="black" d="M7625,-6600.01C7625,-6559.1 7625,-6496 7625,-6496 7625,-6496 7177.5,-6496 7177.5,-6496"/>
<polygon fill="black" stroke="black" points="7177.5,-6492.5 7167.5,-6496 7177.5,-6499.5 7177.5,-6492.5"/>
</g>
<!-- layer0_expert_agg_3&#45;&gt;layer0_expert_allreduce -->
<g id="edge93" class="edge">
<title>layer0_expert_agg_3&#45;&gt;layer0_expert_allreduce</title>
<path fill="none" stroke="black" d="M6378.25,-6428.12C6378.25,-6380 6378.25,-6324 6378.25,-6324 6378.25,-6324 5486.33,-6324 5486.33,-6324"/>
<polygon fill="black" stroke="black" points="5486.33,-6320.5 5476.33,-6324 5486.33,-6327.5 5486.33,-6320.5"/>
</g>
<!-- layer0_expert_allreduce&#45;&gt;layer0_residual2 -->
<g id="edge94" class="edge">
<title>layer0_expert_allreduce&#45;&gt;layer0_residual2</title>
<path fill="none" stroke="black" d="M5489.42,-6324.03C5489.42,-6324.03 5489.42,-6162.65 5489.42,-6162.65"/>
<polygon fill="black" stroke="black" points="5492.92,-6162.65 5489.42,-6152.65 5485.92,-6162.65 5492.92,-6162.65"/>
</g>
<!-- layer1_ln1 -->
<g id="node69" class="node">
<title>layer1_ln1</title>
<polygon fill="lightgreen" stroke="black" points="4836,-6007.17 4378,-6007.17 4378,-5939.17 4836,-5939.17 4836,-6007.17"/>
<text text-anchor="middle" x="4607" y="-5991.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4607" y="-5976.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4607" y="-5961.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4607" y="-5946.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer0_residual2&#45;&gt;layer1_ln1 -->
<g id="edge96" class="edge">
<title>layer0_residual2&#45;&gt;layer1_ln1</title>
<path fill="none" stroke="black" d="M5405.87,-6137C5091.35,-6137 4730.08,-6137 4730.08,-6137 4730.08,-6137 4730.08,-6017.51 4730.08,-6017.51"/>
<polygon fill="black" stroke="black" points="4733.58,-6017.51 4730.08,-6007.51 4726.58,-6017.51 4733.58,-6017.51"/>
</g>
<!-- layer1_residual1 -->
<g id="node107" class="node">
<title>layer1_residual1</title>
<polygon fill="lightpink" stroke="black" points="6184,-5374.17 5726,-5291.17 6184,-5208.17 6642,-5291.17 6184,-5374.17"/>
<text text-anchor="middle" x="6184" y="-5317.47" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6184" y="-5302.47" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6184" y="-5287.47" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6184" y="-5272.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6184" y="-5257.47" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer0_residual2&#45;&gt;layer1_residual1 -->
<g id="edge146" class="edge">
<title>layer0_residual2&#45;&gt;layer1_residual1</title>
<path fill="none" stroke="black" d="M5918,-6063.94C5918,-6063.94 5918,-5336.06 5918,-5336.06"/>
<polygon fill="black" stroke="black" points="5921.5,-5336.06 5918,-5326.06 5914.5,-5336.06 5921.5,-5336.06"/>
</g>
<!-- layer1_qkv_proj_0 -->
<g id="node70" class="node">
<title>layer1_qkv_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="1710.5,-5903.17 1203.5,-5903.17 1203.5,-5820.17 1710.5,-5820.17 1710.5,-5903.17"/>
<text text-anchor="middle" x="1457" y="-5887.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1457" y="-5872.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="1457" y="-5857.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1457" y="-5842.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="1457" y="-5827.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_qkv_proj_0 -->
<g id="edge97" class="edge">
<title>layer1_ln1&#45;&gt;layer1_qkv_proj_0</title>
<path fill="none" stroke="black" d="M4377.92,-5997C3653.05,-5997 1457,-5997 1457,-5997 1457,-5997 1457,-5913.38 1457,-5913.38"/>
<polygon fill="black" stroke="black" points="1460.5,-5913.38 1457,-5903.38 1453.5,-5913.38 1460.5,-5913.38"/>
</g>
<!-- layer1_qkv_proj_1 -->
<g id="node71" class="node">
<title>layer1_qkv_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="2235.5,-5903.17 1728.5,-5903.17 1728.5,-5820.17 2235.5,-5820.17 2235.5,-5903.17"/>
<text text-anchor="middle" x="1982" y="-5887.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1982" y="-5872.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="1982" y="-5857.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1982" y="-5842.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="1982" y="-5827.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_qkv_proj_1 -->
<g id="edge101" class="edge">
<title>layer1_ln1&#45;&gt;layer1_qkv_proj_1</title>
<path fill="none" stroke="black" d="M4377.87,-5987C3780.77,-5987 2223,-5987 2223,-5987 2223,-5987 2223,-5913.4 2223,-5913.4"/>
<polygon fill="black" stroke="black" points="2226.5,-5913.4 2223,-5903.4 2219.5,-5913.4 2226.5,-5913.4"/>
</g>
<!-- layer1_qkv_proj_2 -->
<g id="node72" class="node">
<title>layer1_qkv_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="2760.5,-5903.17 2253.5,-5903.17 2253.5,-5820.17 2760.5,-5820.17 2760.5,-5903.17"/>
<text text-anchor="middle" x="2507" y="-5887.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2507" y="-5872.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="2507" y="-5857.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2507" y="-5842.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2507" y="-5827.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_qkv_proj_2 -->
<g id="edge105" class="edge">
<title>layer1_ln1&#45;&gt;layer1_qkv_proj_2</title>
<path fill="none" stroke="black" d="M4377.89,-5978C3876.61,-5978 2727,-5978 2727,-5978 2727,-5978 2727,-5913.34 2727,-5913.34"/>
<polygon fill="black" stroke="black" points="2730.5,-5913.34 2727,-5903.34 2723.5,-5913.34 2730.5,-5913.34"/>
</g>
<!-- layer1_qkv_proj_3 -->
<g id="node73" class="node">
<title>layer1_qkv_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="3285.5,-5903.17 2778.5,-5903.17 2778.5,-5820.17 3285.5,-5820.17 3285.5,-5903.17"/>
<text text-anchor="middle" x="3032" y="-5887.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3032" y="-5872.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3032" y="-5857.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3032" y="-5842.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3032" y="-5827.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_qkv_proj_3 -->
<g id="edge109" class="edge">
<title>layer1_ln1&#45;&gt;layer1_qkv_proj_3</title>
<path fill="none" stroke="black" d="M4377.98,-5968C3958.58,-5968 3109.83,-5968 3109.83,-5968 3109.83,-5968 3109.83,-5913.39 3109.83,-5913.39"/>
<polygon fill="black" stroke="black" points="3113.33,-5913.39 3109.83,-5903.39 3106.33,-5913.39 3113.33,-5913.39"/>
</g>
<!-- layer1_qkv_proj_4 -->
<g id="node74" class="node">
<title>layer1_qkv_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="3810.5,-5903.17 3303.5,-5903.17 3303.5,-5820.17 3810.5,-5820.17 3810.5,-5903.17"/>
<text text-anchor="middle" x="3557" y="-5887.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3557" y="-5872.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3557" y="-5857.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3557" y="-5842.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3557" y="-5827.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_qkv_proj_4 -->
<g id="edge113" class="edge">
<title>layer1_ln1&#45;&gt;layer1_qkv_proj_4</title>
<path fill="none" stroke="black" d="M4377.87,-5958C4068.92,-5958 3557,-5958 3557,-5958 3557,-5958 3557,-5913.36 3557,-5913.36"/>
<polygon fill="black" stroke="black" points="3560.5,-5913.36 3557,-5903.36 3553.5,-5913.36 3560.5,-5913.36"/>
</g>
<!-- layer1_qkv_proj_5 -->
<g id="node75" class="node">
<title>layer1_qkv_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="4335.5,-5903.17 3828.5,-5903.17 3828.5,-5820.17 4335.5,-5820.17 4335.5,-5903.17"/>
<text text-anchor="middle" x="4082" y="-5887.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4082" y="-5872.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4082" y="-5857.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4082" y="-5842.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4082" y="-5827.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_qkv_proj_5 -->
<g id="edge117" class="edge">
<title>layer1_ln1&#45;&gt;layer1_qkv_proj_5</title>
<path fill="none" stroke="black" d="M4377.86,-5948C4303.14,-5948 4239,-5948 4239,-5948 4239,-5948 4239,-5913.32 4239,-5913.32"/>
<polygon fill="black" stroke="black" points="4242.5,-5913.32 4239,-5903.32 4235.5,-5913.32 4242.5,-5913.32"/>
</g>
<!-- layer1_qkv_proj_6 -->
<g id="node76" class="node">
<title>layer1_qkv_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="4860.5,-5903.17 4353.5,-5903.17 4353.5,-5820.17 4860.5,-5820.17 4860.5,-5903.17"/>
<text text-anchor="middle" x="4607" y="-5887.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4607" y="-5872.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4607" y="-5857.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4607" y="-5842.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4607" y="-5827.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_qkv_proj_6 -->
<g id="edge121" class="edge">
<title>layer1_ln1&#45;&gt;layer1_qkv_proj_6</title>
<path fill="none" stroke="black" d="M4607,-5939.11C4607,-5939.11 4607,-5913.38 4607,-5913.38"/>
<polygon fill="black" stroke="black" points="4610.5,-5913.38 4607,-5903.38 4603.5,-5913.38 4610.5,-5913.38"/>
</g>
<!-- layer1_qkv_proj_7 -->
<g id="node77" class="node">
<title>layer1_qkv_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="5385.5,-5903.17 4878.5,-5903.17 4878.5,-5820.17 5385.5,-5820.17 5385.5,-5903.17"/>
<text text-anchor="middle" x="5132" y="-5887.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5132" y="-5872.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="5132" y="-5857.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5132" y="-5842.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5132" y="-5827.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_qkv_proj_7 -->
<g id="edge125" class="edge">
<title>layer1_ln1&#45;&gt;layer1_qkv_proj_7</title>
<path fill="none" stroke="black" d="M4836.13,-5950C4977.5,-5950 5132,-5950 5132,-5950 5132,-5950 5132,-5913.25 5132,-5913.25"/>
<polygon fill="black" stroke="black" points="5135.5,-5913.25 5132,-5903.25 5128.5,-5913.25 5135.5,-5913.25"/>
</g>
<!-- layer1_qkv_proj_8 -->
<g id="node78" class="node">
<title>layer1_qkv_proj_8</title>
<polygon fill="lightcoral" stroke="black" points="5910.5,-5903.17 5403.5,-5903.17 5403.5,-5820.17 5910.5,-5820.17 5910.5,-5903.17"/>
<text text-anchor="middle" x="5657" y="-5887.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5657" y="-5872.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="5657" y="-5857.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5657" y="-5842.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="5657" y="-5827.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_qkv_proj_8 -->
<g id="edge129" class="edge">
<title>layer1_ln1&#45;&gt;layer1_qkv_proj_8</title>
<path fill="none" stroke="black" d="M4836.29,-5961C5145.47,-5961 5657.75,-5961 5657.75,-5961 5657.75,-5961 5657.75,-5913.22 5657.75,-5913.22"/>
<polygon fill="black" stroke="black" points="5661.25,-5913.22 5657.75,-5903.22 5654.25,-5913.22 5661.25,-5913.22"/>
</g>
<!-- layer1_qkv_proj_9 -->
<g id="node79" class="node">
<title>layer1_qkv_proj_9</title>
<polygon fill="lightcoral" stroke="black" points="6435.5,-5903.17 5928.5,-5903.17 5928.5,-5820.17 6435.5,-5820.17 6435.5,-5903.17"/>
<text text-anchor="middle" x="6182" y="-5887.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6182" y="-5872.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="6182" y="-5857.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6182" y="-5842.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6182" y="-5827.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_qkv_proj_9 -->
<g id="edge133" class="edge">
<title>layer1_ln1&#45;&gt;layer1_qkv_proj_9</title>
<path fill="none" stroke="black" d="M4836.28,-5973C5260.42,-5973 6124.75,-5973 6124.75,-5973 6124.75,-5973 6124.75,-5913.44 6124.75,-5913.44"/>
<polygon fill="black" stroke="black" points="6128.25,-5913.44 6124.75,-5903.44 6121.25,-5913.44 6128.25,-5913.44"/>
</g>
<!-- layer1_qkv_proj_10 -->
<g id="node80" class="node">
<title>layer1_qkv_proj_10</title>
<polygon fill="lightcoral" stroke="black" points="6960.5,-5903.17 6453.5,-5903.17 6453.5,-5820.17 6960.5,-5820.17 6960.5,-5903.17"/>
<text text-anchor="middle" x="6707" y="-5887.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6707" y="-5872.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="6707" y="-5857.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6707" y="-5842.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6707" y="-5827.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_qkv_proj_10 -->
<g id="edge137" class="edge">
<title>layer1_ln1&#45;&gt;layer1_qkv_proj_10</title>
<path fill="none" stroke="black" d="M4836.24,-5984C5380.82,-5984 6707,-5984 6707,-5984 6707,-5984 6707,-5913.42 6707,-5913.42"/>
<polygon fill="black" stroke="black" points="6710.5,-5913.42 6707,-5903.42 6703.5,-5913.42 6710.5,-5913.42"/>
</g>
<!-- layer1_qkv_proj_11 -->
<g id="node81" class="node">
<title>layer1_qkv_proj_11</title>
<polygon fill="lightcoral" stroke="black" points="7485.5,-5903.17 6978.5,-5903.17 6978.5,-5820.17 7485.5,-5820.17 7485.5,-5903.17"/>
<text text-anchor="middle" x="7232" y="-5887.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7232" y="-5872.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="7232" y="-5857.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7232" y="-5842.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7232" y="-5827.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_qkv_proj_11 -->
<g id="edge141" class="edge">
<title>layer1_ln1&#45;&gt;layer1_qkv_proj_11</title>
<path fill="none" stroke="black" d="M4836.27,-5995C5456.6,-5995 7121.67,-5995 7121.67,-5995 7121.67,-5995 7121.67,-5913.49 7121.67,-5913.49"/>
<polygon fill="black" stroke="black" points="7125.17,-5913.49 7121.67,-5903.49 7118.17,-5913.49 7125.17,-5913.49"/>
</g>
<!-- layer1_attention_0 -->
<g id="node82" class="node">
<title>layer1_attention_0</title>
<polygon fill="lightcoral" stroke="black" points="1710.5,-5784.17 1203.5,-5784.17 1203.5,-5701.17 1710.5,-5701.17 1710.5,-5784.17"/>
<text text-anchor="middle" x="1457" y="-5768.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="1457" y="-5753.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="1457" y="-5738.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="1457" y="-5723.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="1457" y="-5708.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_qkv_proj_0&#45;&gt;layer1_attention_0 -->
<g id="edge98" class="edge">
<title>layer1_qkv_proj_0&#45;&gt;layer1_attention_0</title>
<path fill="none" stroke="black" d="M1457,-5820.05C1457,-5820.05 1457,-5794.46 1457,-5794.46"/>
<polygon fill="black" stroke="black" points="1460.5,-5794.46 1457,-5784.46 1453.5,-5794.46 1460.5,-5794.46"/>
</g>
<!-- layer1_attention_1 -->
<g id="node83" class="node">
<title>layer1_attention_1</title>
<polygon fill="lightcoral" stroke="black" points="2235.5,-5784.17 1728.5,-5784.17 1728.5,-5701.17 2235.5,-5701.17 2235.5,-5784.17"/>
<text text-anchor="middle" x="1982" y="-5768.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="1982" y="-5753.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="1982" y="-5738.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="1982" y="-5723.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="1982" y="-5708.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_qkv_proj_1&#45;&gt;layer1_attention_1 -->
<g id="edge102" class="edge">
<title>layer1_qkv_proj_1&#45;&gt;layer1_attention_1</title>
<path fill="none" stroke="black" d="M1982,-5820.05C1982,-5820.05 1982,-5794.46 1982,-5794.46"/>
<polygon fill="black" stroke="black" points="1985.5,-5794.46 1982,-5784.46 1978.5,-5794.46 1985.5,-5794.46"/>
</g>
<!-- layer1_attention_2 -->
<g id="node84" class="node">
<title>layer1_attention_2</title>
<polygon fill="lightcoral" stroke="black" points="2760.5,-5784.17 2253.5,-5784.17 2253.5,-5701.17 2760.5,-5701.17 2760.5,-5784.17"/>
<text text-anchor="middle" x="2507" y="-5768.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="2507" y="-5753.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="2507" y="-5738.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2507" y="-5723.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2507" y="-5708.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_qkv_proj_2&#45;&gt;layer1_attention_2 -->
<g id="edge106" class="edge">
<title>layer1_qkv_proj_2&#45;&gt;layer1_attention_2</title>
<path fill="none" stroke="black" d="M2507,-5820.05C2507,-5820.05 2507,-5794.46 2507,-5794.46"/>
<polygon fill="black" stroke="black" points="2510.5,-5794.46 2507,-5784.46 2503.5,-5794.46 2510.5,-5794.46"/>
</g>
<!-- layer1_attention_3 -->
<g id="node85" class="node">
<title>layer1_attention_3</title>
<polygon fill="lightcoral" stroke="black" points="3285.5,-5784.17 2778.5,-5784.17 2778.5,-5701.17 3285.5,-5701.17 3285.5,-5784.17"/>
<text text-anchor="middle" x="3032" y="-5768.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="3032" y="-5753.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3032" y="-5738.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3032" y="-5723.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3032" y="-5708.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_qkv_proj_3&#45;&gt;layer1_attention_3 -->
<g id="edge110" class="edge">
<title>layer1_qkv_proj_3&#45;&gt;layer1_attention_3</title>
<path fill="none" stroke="black" d="M3032,-5820.05C3032,-5820.05 3032,-5794.46 3032,-5794.46"/>
<polygon fill="black" stroke="black" points="3035.5,-5794.46 3032,-5784.46 3028.5,-5794.46 3035.5,-5794.46"/>
</g>
<!-- layer1_attention_4 -->
<g id="node86" class="node">
<title>layer1_attention_4</title>
<polygon fill="lightcoral" stroke="black" points="3810.5,-5784.17 3303.5,-5784.17 3303.5,-5701.17 3810.5,-5701.17 3810.5,-5784.17"/>
<text text-anchor="middle" x="3557" y="-5768.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="3557" y="-5753.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3557" y="-5738.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3557" y="-5723.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3557" y="-5708.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_qkv_proj_4&#45;&gt;layer1_attention_4 -->
<g id="edge114" class="edge">
<title>layer1_qkv_proj_4&#45;&gt;layer1_attention_4</title>
<path fill="none" stroke="black" d="M3557,-5820.05C3557,-5820.05 3557,-5794.46 3557,-5794.46"/>
<polygon fill="black" stroke="black" points="3560.5,-5794.46 3557,-5784.46 3553.5,-5794.46 3560.5,-5794.46"/>
</g>
<!-- layer1_attention_5 -->
<g id="node87" class="node">
<title>layer1_attention_5</title>
<polygon fill="lightcoral" stroke="black" points="4335.5,-5784.17 3828.5,-5784.17 3828.5,-5701.17 4335.5,-5701.17 4335.5,-5784.17"/>
<text text-anchor="middle" x="4082" y="-5768.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="4082" y="-5753.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4082" y="-5738.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4082" y="-5723.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4082" y="-5708.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_qkv_proj_5&#45;&gt;layer1_attention_5 -->
<g id="edge118" class="edge">
<title>layer1_qkv_proj_5&#45;&gt;layer1_attention_5</title>
<path fill="none" stroke="black" d="M4082,-5820.05C4082,-5820.05 4082,-5794.46 4082,-5794.46"/>
<polygon fill="black" stroke="black" points="4085.5,-5794.46 4082,-5784.46 4078.5,-5794.46 4085.5,-5794.46"/>
</g>
<!-- layer1_attention_6 -->
<g id="node88" class="node">
<title>layer1_attention_6</title>
<polygon fill="lightcoral" stroke="black" points="4860.5,-5784.17 4353.5,-5784.17 4353.5,-5701.17 4860.5,-5701.17 4860.5,-5784.17"/>
<text text-anchor="middle" x="4607" y="-5768.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="4607" y="-5753.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4607" y="-5738.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4607" y="-5723.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4607" y="-5708.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_qkv_proj_6&#45;&gt;layer1_attention_6 -->
<g id="edge122" class="edge">
<title>layer1_qkv_proj_6&#45;&gt;layer1_attention_6</title>
<path fill="none" stroke="black" d="M4607,-5820.05C4607,-5820.05 4607,-5794.46 4607,-5794.46"/>
<polygon fill="black" stroke="black" points="4610.5,-5794.46 4607,-5784.46 4603.5,-5794.46 4610.5,-5794.46"/>
</g>
<!-- layer1_attention_7 -->
<g id="node89" class="node">
<title>layer1_attention_7</title>
<polygon fill="lightcoral" stroke="black" points="5385.5,-5784.17 4878.5,-5784.17 4878.5,-5701.17 5385.5,-5701.17 5385.5,-5784.17"/>
<text text-anchor="middle" x="5132" y="-5768.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="5132" y="-5753.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="5132" y="-5738.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5132" y="-5723.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5132" y="-5708.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_qkv_proj_7&#45;&gt;layer1_attention_7 -->
<g id="edge126" class="edge">
<title>layer1_qkv_proj_7&#45;&gt;layer1_attention_7</title>
<path fill="none" stroke="black" d="M5132,-5820.05C5132,-5820.05 5132,-5794.46 5132,-5794.46"/>
<polygon fill="black" stroke="black" points="5135.5,-5794.46 5132,-5784.46 5128.5,-5794.46 5135.5,-5794.46"/>
</g>
<!-- layer1_attention_8 -->
<g id="node90" class="node">
<title>layer1_attention_8</title>
<polygon fill="lightcoral" stroke="black" points="5910.5,-5784.17 5403.5,-5784.17 5403.5,-5701.17 5910.5,-5701.17 5910.5,-5784.17"/>
<text text-anchor="middle" x="5657" y="-5768.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="5657" y="-5753.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="5657" y="-5738.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="5657" y="-5723.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="5657" y="-5708.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_qkv_proj_8&#45;&gt;layer1_attention_8 -->
<g id="edge130" class="edge">
<title>layer1_qkv_proj_8&#45;&gt;layer1_attention_8</title>
<path fill="none" stroke="black" d="M5657,-5820.05C5657,-5820.05 5657,-5794.46 5657,-5794.46"/>
<polygon fill="black" stroke="black" points="5660.5,-5794.46 5657,-5784.46 5653.5,-5794.46 5660.5,-5794.46"/>
</g>
<!-- layer1_attention_9 -->
<g id="node91" class="node">
<title>layer1_attention_9</title>
<polygon fill="lightcoral" stroke="black" points="6435.5,-5784.17 5928.5,-5784.17 5928.5,-5701.17 6435.5,-5701.17 6435.5,-5784.17"/>
<text text-anchor="middle" x="6182" y="-5768.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="6182" y="-5753.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="6182" y="-5738.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6182" y="-5723.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6182" y="-5708.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_qkv_proj_9&#45;&gt;layer1_attention_9 -->
<g id="edge134" class="edge">
<title>layer1_qkv_proj_9&#45;&gt;layer1_attention_9</title>
<path fill="none" stroke="black" d="M6182,-5820.05C6182,-5820.05 6182,-5794.46 6182,-5794.46"/>
<polygon fill="black" stroke="black" points="6185.5,-5794.46 6182,-5784.46 6178.5,-5794.46 6185.5,-5794.46"/>
</g>
<!-- layer1_attention_10 -->
<g id="node92" class="node">
<title>layer1_attention_10</title>
<polygon fill="lightcoral" stroke="black" points="6960.5,-5784.17 6453.5,-5784.17 6453.5,-5701.17 6960.5,-5701.17 6960.5,-5784.17"/>
<text text-anchor="middle" x="6707" y="-5768.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="6707" y="-5753.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="6707" y="-5738.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6707" y="-5723.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6707" y="-5708.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_qkv_proj_10&#45;&gt;layer1_attention_10 -->
<g id="edge138" class="edge">
<title>layer1_qkv_proj_10&#45;&gt;layer1_attention_10</title>
<path fill="none" stroke="black" d="M6707,-5820.05C6707,-5820.05 6707,-5794.46 6707,-5794.46"/>
<polygon fill="black" stroke="black" points="6710.5,-5794.46 6707,-5784.46 6703.5,-5794.46 6710.5,-5794.46"/>
</g>
<!-- layer1_attention_11 -->
<g id="node93" class="node">
<title>layer1_attention_11</title>
<polygon fill="lightcoral" stroke="black" points="7485.5,-5784.17 6978.5,-5784.17 6978.5,-5701.17 7485.5,-5701.17 7485.5,-5784.17"/>
<text text-anchor="middle" x="7232" y="-5768.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="7232" y="-5753.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="7232" y="-5738.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7232" y="-5723.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7232" y="-5708.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_qkv_proj_11&#45;&gt;layer1_attention_11 -->
<g id="edge142" class="edge">
<title>layer1_qkv_proj_11&#45;&gt;layer1_attention_11</title>
<path fill="none" stroke="black" d="M7232,-5820.05C7232,-5820.05 7232,-5794.46 7232,-5794.46"/>
<polygon fill="black" stroke="black" points="7235.5,-5794.46 7232,-5784.46 7228.5,-5794.46 7235.5,-5794.46"/>
</g>
<!-- layer1_attn_out_proj_0 -->
<g id="node94" class="node">
<title>layer1_attn_out_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="1717.5,-5665.17 1222.5,-5665.17 1222.5,-5582.17 1717.5,-5582.17 1717.5,-5665.17"/>
<text text-anchor="middle" x="1470" y="-5649.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="1470" y="-5634.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="1470" y="-5619.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="1470" y="-5604.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="1470" y="-5589.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attention_0&#45;&gt;layer1_attn_out_proj_0 -->
<g id="edge99" class="edge">
<title>layer1_attention_0&#45;&gt;layer1_attn_out_proj_0</title>
<path fill="none" stroke="black" d="M1466.5,-5701.05C1466.5,-5701.05 1466.5,-5675.46 1466.5,-5675.46"/>
<polygon fill="black" stroke="black" points="1470,-5675.46 1466.5,-5665.46 1463,-5675.46 1470,-5675.46"/>
</g>
<!-- layer1_attn_out_proj_1 -->
<g id="node95" class="node">
<title>layer1_attn_out_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="2243.5,-5665.17 1748.5,-5665.17 1748.5,-5582.17 2243.5,-5582.17 2243.5,-5665.17"/>
<text text-anchor="middle" x="1996" y="-5649.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="1996" y="-5634.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="1996" y="-5619.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="1996" y="-5604.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="1996" y="-5589.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attention_1&#45;&gt;layer1_attn_out_proj_1 -->
<g id="edge103" class="edge">
<title>layer1_attention_1&#45;&gt;layer1_attn_out_proj_1</title>
<path fill="none" stroke="black" d="M1992,-5701.05C1992,-5701.05 1992,-5675.46 1992,-5675.46"/>
<polygon fill="black" stroke="black" points="1995.5,-5675.46 1992,-5665.46 1988.5,-5675.46 1995.5,-5675.46"/>
</g>
<!-- layer1_attn_out_proj_2 -->
<g id="node96" class="node">
<title>layer1_attn_out_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="2774.5,-5665.17 2279.5,-5665.17 2279.5,-5582.17 2774.5,-5582.17 2774.5,-5665.17"/>
<text text-anchor="middle" x="2527" y="-5649.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="2527" y="-5634.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="2527" y="-5619.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2527" y="-5604.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="2527" y="-5589.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attention_2&#45;&gt;layer1_attn_out_proj_2 -->
<g id="edge107" class="edge">
<title>layer1_attention_2&#45;&gt;layer1_attn_out_proj_2</title>
<path fill="none" stroke="black" d="M2520,-5701.05C2520,-5701.05 2520,-5675.46 2520,-5675.46"/>
<polygon fill="black" stroke="black" points="2523.5,-5675.46 2520,-5665.46 2516.5,-5675.46 2523.5,-5675.46"/>
</g>
<!-- layer1_attn_out_proj_3 -->
<g id="node97" class="node">
<title>layer1_attn_out_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="3296.5,-5665.17 2801.5,-5665.17 2801.5,-5582.17 3296.5,-5582.17 3296.5,-5665.17"/>
<text text-anchor="middle" x="3049" y="-5649.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="3049" y="-5634.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3049" y="-5619.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3049" y="-5604.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="3049" y="-5589.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_attention_3&#45;&gt;layer1_attn_out_proj_3 -->
<g id="edge111" class="edge">
<title>layer1_attention_3&#45;&gt;layer1_attn_out_proj_3</title>
<path fill="none" stroke="black" d="M3043.5,-5701.05C3043.5,-5701.05 3043.5,-5675.46 3043.5,-5675.46"/>
<polygon fill="black" stroke="black" points="3047,-5675.46 3043.5,-5665.46 3040,-5675.46 3047,-5675.46"/>
</g>
<!-- layer1_attn_out_proj_4 -->
<g id="node98" class="node">
<title>layer1_attn_out_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="3813.5,-5665.17 3318.5,-5665.17 3318.5,-5582.17 3813.5,-5582.17 3813.5,-5665.17"/>
<text text-anchor="middle" x="3566" y="-5649.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="3566" y="-5634.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3566" y="-5619.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3566" y="-5604.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="3566" y="-5589.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_attention_4&#45;&gt;layer1_attn_out_proj_4 -->
<g id="edge115" class="edge">
<title>layer1_attention_4&#45;&gt;layer1_attn_out_proj_4</title>
<path fill="none" stroke="black" d="M3564.5,-5701.05C3564.5,-5701.05 3564.5,-5675.46 3564.5,-5675.46"/>
<polygon fill="black" stroke="black" points="3568,-5675.46 3564.5,-5665.46 3561,-5675.46 3568,-5675.46"/>
</g>
<!-- layer1_attn_out_proj_5 -->
<g id="node99" class="node">
<title>layer1_attn_out_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="4335.5,-5665.17 3840.5,-5665.17 3840.5,-5582.17 4335.5,-5582.17 4335.5,-5665.17"/>
<text text-anchor="middle" x="4088" y="-5649.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="4088" y="-5634.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4088" y="-5619.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4088" y="-5604.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="4088" y="-5589.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_attention_5&#45;&gt;layer1_attn_out_proj_5 -->
<g id="edge119" class="edge">
<title>layer1_attention_5&#45;&gt;layer1_attn_out_proj_5</title>
<path fill="none" stroke="black" d="M4088,-5701.05C4088,-5701.05 4088,-5675.46 4088,-5675.46"/>
<polygon fill="black" stroke="black" points="4091.5,-5675.46 4088,-5665.46 4084.5,-5675.46 4091.5,-5675.46"/>
</g>
<!-- layer1_attn_out_proj_6 -->
<g id="node100" class="node">
<title>layer1_attn_out_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="4854.5,-5665.17 4359.5,-5665.17 4359.5,-5582.17 4854.5,-5582.17 4854.5,-5665.17"/>
<text text-anchor="middle" x="4607" y="-5649.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="4607" y="-5634.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4607" y="-5619.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4607" y="-5604.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="4607" y="-5589.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_attention_6&#45;&gt;layer1_attn_out_proj_6 -->
<g id="edge123" class="edge">
<title>layer1_attention_6&#45;&gt;layer1_attn_out_proj_6</title>
<path fill="none" stroke="black" d="M4607,-5701.05C4607,-5701.05 4607,-5675.46 4607,-5675.46"/>
<polygon fill="black" stroke="black" points="4610.5,-5675.46 4607,-5665.46 4603.5,-5675.46 4610.5,-5675.46"/>
</g>
<!-- layer1_attn_out_proj_7 -->
<g id="node101" class="node">
<title>layer1_attn_out_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="5373.5,-5665.17 4878.5,-5665.17 4878.5,-5582.17 5373.5,-5582.17 5373.5,-5665.17"/>
<text text-anchor="middle" x="5126" y="-5649.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="5126" y="-5634.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="5126" y="-5619.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5126" y="-5604.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="5126" y="-5589.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_attention_7&#45;&gt;layer1_attn_out_proj_7 -->
<g id="edge127" class="edge">
<title>layer1_attention_7&#45;&gt;layer1_attn_out_proj_7</title>
<path fill="none" stroke="black" d="M5126,-5701.05C5126,-5701.05 5126,-5675.46 5126,-5675.46"/>
<polygon fill="black" stroke="black" points="5129.5,-5675.46 5126,-5665.46 5122.5,-5675.46 5129.5,-5675.46"/>
</g>
<!-- layer1_attn_out_proj_8 -->
<g id="node102" class="node">
<title>layer1_attn_out_proj_8</title>
<polygon fill="lightcoral" stroke="black" points="5898.5,-5665.17 5403.5,-5665.17 5403.5,-5582.17 5898.5,-5582.17 5898.5,-5665.17"/>
<text text-anchor="middle" x="5651" y="-5649.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="5651" y="-5634.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="5651" y="-5619.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="5651" y="-5604.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=256]</text>
<text text-anchor="middle" x="5651" y="-5589.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_attention_8&#45;&gt;layer1_attn_out_proj_8 -->
<g id="edge131" class="edge">
<title>layer1_attention_8&#45;&gt;layer1_attn_out_proj_8</title>
<path fill="none" stroke="black" d="M5651,-5701.05C5651,-5701.05 5651,-5675.46 5651,-5675.46"/>
<polygon fill="black" stroke="black" points="5654.5,-5675.46 5651,-5665.46 5647.5,-5675.46 5654.5,-5675.46"/>
</g>
<!-- layer1_attn_out_proj_9 -->
<g id="node103" class="node">
<title>layer1_attn_out_proj_9</title>
<polygon fill="lightcoral" stroke="black" points="6420.5,-5665.17 5925.5,-5665.17 5925.5,-5582.17 6420.5,-5582.17 6420.5,-5665.17"/>
<text text-anchor="middle" x="6173" y="-5649.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="6173" y="-5634.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="6173" y="-5619.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6173" y="-5604.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=256]</text>
<text text-anchor="middle" x="6173" y="-5589.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_attention_9&#45;&gt;layer1_attn_out_proj_9 -->
<g id="edge135" class="edge">
<title>layer1_attention_9&#45;&gt;layer1_attn_out_proj_9</title>
<path fill="none" stroke="black" d="M6174.5,-5701.05C6174.5,-5701.05 6174.5,-5675.46 6174.5,-5675.46"/>
<polygon fill="black" stroke="black" points="6178,-5675.46 6174.5,-5665.46 6171,-5675.46 6178,-5675.46"/>
</g>
<!-- layer1_attn_out_proj_10 -->
<g id="node104" class="node">
<title>layer1_attn_out_proj_10</title>
<polygon fill="lightcoral" stroke="black" points="6944.5,-5665.17 6449.5,-5665.17 6449.5,-5582.17 6944.5,-5582.17 6944.5,-5665.17"/>
<text text-anchor="middle" x="6697" y="-5649.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="6697" y="-5634.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="6697" y="-5619.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6697" y="-5604.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=256]</text>
<text text-anchor="middle" x="6697" y="-5589.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_attention_10&#45;&gt;layer1_attn_out_proj_10 -->
<g id="edge139" class="edge">
<title>layer1_attention_10&#45;&gt;layer1_attn_out_proj_10</title>
<path fill="none" stroke="black" d="M6699,-5701.05C6699,-5701.05 6699,-5675.46 6699,-5675.46"/>
<polygon fill="black" stroke="black" points="6702.5,-5675.46 6699,-5665.46 6695.5,-5675.46 6702.5,-5675.46"/>
</g>
<!-- layer1_attn_out_proj_11 -->
<g id="node105" class="node">
<title>layer1_attn_out_proj_11</title>
<polygon fill="lightcoral" stroke="black" points="7468.5,-5665.17 6973.5,-5665.17 6973.5,-5582.17 7468.5,-5582.17 7468.5,-5665.17"/>
<text text-anchor="middle" x="7221" y="-5649.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="7221" y="-5634.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="7221" y="-5619.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7221" y="-5604.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=256]</text>
<text text-anchor="middle" x="7221" y="-5589.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_attention_11&#45;&gt;layer1_attn_out_proj_11 -->
<g id="edge143" class="edge">
<title>layer1_attention_11&#45;&gt;layer1_attn_out_proj_11</title>
<path fill="none" stroke="black" d="M7223.5,-5701.05C7223.5,-5701.05 7223.5,-5675.46 7223.5,-5675.46"/>
<polygon fill="black" stroke="black" points="7227,-5675.46 7223.5,-5665.46 7220,-5675.46 7227,-5675.46"/>
</g>
<!-- layer1_attn_allreduce -->
<g id="node106" class="node">
<title>layer1_attn_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="5081.67,-5546.17 4326.58,-5546.17 4132.33,-5410.17 4887.42,-5410.17 5081.67,-5546.17"/>
<text text-anchor="middle" x="4607" y="-5496.97" font-family="Times,serif" font-size="14.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="4607" y="-5481.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4607" y="-5466.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4607" y="-5451.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer1_attn_out_proj_0&#45;&gt;layer1_attn_allreduce -->
<g id="edge100" class="edge">
<title>layer1_attn_out_proj_0&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M1707.3,-5582.08C1707.3,-5525.71 1707.3,-5432 1707.3,-5432 1707.3,-5432 4153.44,-5432 4153.44,-5432"/>
<polygon fill="black" stroke="black" points="4153.44,-5435.5 4163.44,-5432 4153.44,-5428.5 4153.44,-5435.5"/>
</g>
<!-- layer1_attn_out_proj_1&#45;&gt;layer1_attn_allreduce -->
<g id="edge104" class="edge">
<title>layer1_attn_out_proj_1&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M2096,-5581.97C2096,-5532.03 2096,-5455 2096,-5455 2096,-5455 4186.22,-5455 4186.22,-5455"/>
<polygon fill="black" stroke="black" points="4186.22,-5458.5 4196.22,-5455 4186.22,-5451.5 4186.22,-5458.5"/>
</g>
<!-- layer1_attn_out_proj_2&#45;&gt;layer1_attn_allreduce -->
<g id="edge108" class="edge">
<title>layer1_attn_out_proj_2&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M2719.7,-5581.92C2719.7,-5538.88 2719.7,-5478 2719.7,-5478 2719.7,-5478 4219.05,-5478 4219.05,-5478"/>
<polygon fill="black" stroke="black" points="4219.05,-5481.5 4229.05,-5478 4219.05,-5474.5 4219.05,-5481.5"/>
</g>
<!-- layer1_attn_out_proj_3&#45;&gt;layer1_attn_allreduce -->
<g id="edge112" class="edge">
<title>layer1_attn_out_proj_3&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M3049,-5582.14C3049,-5546.22 3049,-5500 3049,-5500 3049,-5500 4250.26,-5500 4250.26,-5500"/>
<polygon fill="black" stroke="black" points="4250.26,-5503.5 4260.26,-5500 4250.26,-5496.5 4250.26,-5503.5"/>
</g>
<!-- layer1_attn_out_proj_4&#45;&gt;layer1_attn_allreduce -->
<g id="edge116" class="edge">
<title>layer1_attn_out_proj_4&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M3721.3,-5582.14C3721.3,-5554.41 3721.3,-5523 3721.3,-5523 3721.3,-5523 4283.49,-5523 4283.49,-5523"/>
<polygon fill="black" stroke="black" points="4283.49,-5526.5 4293.49,-5523 4283.49,-5519.5 4283.49,-5526.5"/>
</g>
<!-- layer1_attn_out_proj_5&#45;&gt;layer1_attn_allreduce -->
<g id="edge120" class="edge">
<title>layer1_attn_out_proj_5&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M4233.83,-5581.97C4233.83,-5581.97 4233.83,-5491.56 4233.83,-5491.56"/>
<polygon fill="black" stroke="black" points="4237.33,-5491.56 4233.83,-5481.56 4230.33,-5491.56 4237.33,-5491.56"/>
</g>
<!-- layer1_attn_out_proj_6&#45;&gt;layer1_attn_allreduce -->
<g id="edge124" class="edge">
<title>layer1_attn_out_proj_6&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M4607,-5581.97C4607,-5581.97 4607,-5556.24 4607,-5556.24"/>
<polygon fill="black" stroke="black" points="4610.5,-5556.24 4607,-5546.24 4603.5,-5556.24 4610.5,-5556.24"/>
</g>
<!-- layer1_attn_out_proj_7&#45;&gt;layer1_attn_allreduce -->
<g id="edge128" class="edge">
<title>layer1_attn_out_proj_7&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M4980.17,-5581.97C4980.17,-5581.97 4980.17,-5556.24 4980.17,-5556.24"/>
<polygon fill="black" stroke="black" points="4983.67,-5556.24 4980.17,-5546.24 4976.67,-5556.24 4983.67,-5556.24"/>
</g>
<!-- layer1_attn_out_proj_8&#45;&gt;layer1_attn_allreduce -->
<g id="edge132" class="edge">
<title>layer1_attn_out_proj_8&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M5564.75,-5582.14C5564.75,-5554.41 5564.75,-5523 5564.75,-5523 5564.75,-5523 5058.73,-5523 5058.73,-5523"/>
<polygon fill="black" stroke="black" points="5058.73,-5519.5 5048.73,-5523 5058.73,-5526.5 5058.73,-5519.5"/>
</g>
<!-- layer1_attn_out_proj_9&#45;&gt;layer1_attn_allreduce -->
<g id="edge136" class="edge">
<title>layer1_attn_out_proj_9&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M6173,-5582.14C6173,-5546.22 6173,-5500 6173,-5500 6173,-5500 5025.89,-5500 5025.89,-5500"/>
<polygon fill="black" stroke="black" points="5025.89,-5496.5 5015.89,-5500 5025.89,-5503.5 5025.89,-5496.5"/>
</g>
<!-- layer1_attn_out_proj_10&#45;&gt;layer1_attn_allreduce -->
<g id="edge140" class="edge">
<title>layer1_attn_out_proj_10&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M6545.75,-5581.92C6545.75,-5538.88 6545.75,-5478 6545.75,-5478 6545.75,-5478 4994.55,-5478 4994.55,-5478"/>
<polygon fill="black" stroke="black" points="4994.55,-5474.5 4984.55,-5478 4994.55,-5481.5 4994.55,-5474.5"/>
</g>
<!-- layer1_attn_out_proj_11&#45;&gt;layer1_attn_allreduce -->
<g id="edge144" class="edge">
<title>layer1_attn_out_proj_11&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M6991.8,-5581.97C6991.8,-5532.03 6991.8,-5455 6991.8,-5455 6991.8,-5455 4961.54,-5455 4961.54,-5455"/>
<polygon fill="black" stroke="black" points="4961.54,-5451.5 4951.54,-5455 4961.54,-5458.5 4961.54,-5451.5"/>
</g>
<!-- layer1_attn_allreduce&#45;&gt;layer1_residual1 -->
<g id="edge145" class="edge">
<title>layer1_attn_allreduce&#45;&gt;layer1_residual1</title>
<path fill="none" stroke="black" d="M4918.95,-5432C5276.06,-5432 5812.25,-5432 5812.25,-5432 5812.25,-5432 5812.25,-5317.05 5812.25,-5317.05"/>
<polygon fill="black" stroke="black" points="5815.75,-5317.05 5812.25,-5307.05 5808.75,-5317.05 5815.75,-5317.05"/>
</g>
<!-- layer1_ln2 -->
<g id="node108" class="node">
<title>layer1_ln2</title>
<polygon fill="lightgreen" stroke="black" points="5740,-5172.17 5282,-5172.17 5282,-5104.17 5740,-5104.17 5740,-5172.17"/>
<text text-anchor="middle" x="5511" y="-5156.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5511" y="-5141.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5511" y="-5126.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5511" y="-5111.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer1_residual1&#45;&gt;layer1_ln2 -->
<g id="edge147" class="edge">
<title>layer1_residual1&#45;&gt;layer1_ln2</title>
<path fill="none" stroke="black" d="M5733,-5289.84C5733,-5289.84 5733,-5182.47 5733,-5182.47"/>
<polygon fill="black" stroke="black" points="5736.5,-5182.47 5733,-5172.47 5729.5,-5182.47 5736.5,-5182.47"/>
</g>
<!-- layer1_residual2 -->
<g id="node135" class="node">
<title>layer1_residual2</title>
<polygon fill="lightpink" stroke="black" points="5943,-4246.17 5485,-4163.17 5943,-4080.17 6401,-4163.17 5943,-4246.17"/>
<text text-anchor="middle" x="5943" y="-4189.47" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5943" y="-4174.47" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5943" y="-4159.47" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5943" y="-4144.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5943" y="-4129.47" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer1_residual1&#45;&gt;layer1_residual2 -->
<g id="edge190" class="edge">
<title>layer1_residual1&#45;&gt;layer1_residual2</title>
<path fill="none" stroke="black" d="M5803.5,-5276.9C5803.5,-5276.9 5803.5,-4231.05 5803.5,-4231.05"/>
<polygon fill="black" stroke="black" points="5807,-4231.05 5803.5,-4221.05 5800,-4231.05 5807,-4231.05"/>
</g>
<!-- layer1_gate -->
<g id="node109" class="node">
<title>layer1_gate</title>
<polygon fill="lightblue" stroke="black" points="5304.58,-5068.17 4562.36,-5068.17 4371.42,-4932.17 5113.64,-4932.17 5304.58,-5068.17"/>
<text text-anchor="middle" x="4838" y="-5018.97" font-family="Times,serif" font-size="14.00">Gate Computation</text>
<text text-anchor="middle" x="4838" y="-5003.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4838" y="-4988.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="4838" y="-4973.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer1_ln2&#45;&gt;layer1_gate -->
<g id="edge148" class="edge">
<title>layer1_ln2&#45;&gt;layer1_gate</title>
<path fill="none" stroke="black" d="M5293.27,-5104.05C5293.27,-5104.05 5293.27,-5010.21 5293.27,-5010.21"/>
<polygon fill="black" stroke="black" points="5296.77,-5010.21 5293.27,-5000.21 5289.77,-5010.21 5296.77,-5010.21"/>
</g>
<!-- layer1_route_0 -->
<g id="node110" class="node">
<title>layer1_route_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1697.18,-4896.17 930.14,-4896.17 732.82,-4730.17 1499.86,-4730.17 1697.18,-4896.17"/>
<text text-anchor="middle" x="1215" y="-4839.47" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="1215" y="-4824.47" font-family="Times,serif" font-size="14.00">Experts=[0&#45;3]</text>
<text text-anchor="middle" x="1215" y="-4809.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1215" y="-4794.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="1215" y="-4779.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_0 -->
<g id="edge149" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4497.45,-5022C3639.96,-5022 1459.8,-5022 1459.8,-5022 1459.8,-5022 1459.8,-4906.3 1459.8,-4906.3"/>
<polygon fill="black" stroke="black" points="1463.3,-4906.3 1459.8,-4896.3 1456.3,-4906.3 1463.3,-4906.3"/>
</g>
<!-- layer1_route_1 -->
<g id="node116" class="node">
<title>layer1_route_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3629.18,-4896.17 2862.14,-4896.17 2664.82,-4730.17 3431.86,-4730.17 3629.18,-4896.17"/>
<text text-anchor="middle" x="3147" y="-4839.47" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="3147" y="-4824.47" font-family="Times,serif" font-size="14.00">Experts=[4&#45;7]</text>
<text text-anchor="middle" x="3147" y="-4809.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3147" y="-4794.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="3147" y="-4779.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_1 -->
<g id="edge158" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4434.23,-4977C4031.96,-4977 3473.8,-4977 3473.8,-4977 3473.8,-4977 3473.8,-4906.52 3473.8,-4906.52"/>
<polygon fill="black" stroke="black" points="3477.3,-4906.52 3473.8,-4896.52 3470.3,-4906.52 3477.3,-4906.52"/>
</g>
<!-- layer1_route_2 -->
<g id="node122" class="node">
<title>layer1_route_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="5320.18,-4896.17 4553.14,-4896.17 4355.82,-4730.17 5122.86,-4730.17 5320.18,-4896.17"/>
<text text-anchor="middle" x="4838" y="-4839.47" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="4838" y="-4824.47" font-family="Times,serif" font-size="14.00">Experts=[8&#45;11]</text>
<text text-anchor="middle" x="4838" y="-4809.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4838" y="-4794.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="4838" y="-4779.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_2 -->
<g id="edge167" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4838,-4932.13C4838,-4932.13 4838,-4906.45 4838,-4906.45"/>
<polygon fill="black" stroke="black" points="4841.5,-4906.45 4838,-4896.45 4834.5,-4906.45 4841.5,-4906.45"/>
</g>
<!-- layer1_route_3 -->
<g id="node128" class="node">
<title>layer1_route_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7010.18,-4896.17 6243.14,-4896.17 6045.82,-4730.17 6812.86,-4730.17 7010.18,-4896.17"/>
<text text-anchor="middle" x="6528" y="-4839.47" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="6528" y="-4824.47" font-family="Times,serif" font-size="14.00">Experts=[12&#45;15]</text>
<text text-anchor="middle" x="6528" y="-4809.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6528" y="-4794.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="6528" y="-4779.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_3 -->
<g id="edge176" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5209.29,-5000C5655.22,-5000 6343.95,-5000 6343.95,-5000 6343.95,-5000 6343.95,-4906.2 6343.95,-4906.2"/>
<polygon fill="black" stroke="black" points="6347.45,-4906.2 6343.95,-4896.2 6340.45,-4906.2 6347.45,-4906.2"/>
</g>
<!-- layer1_expert_0 -->
<g id="node111" class="node">
<title>layer1_expert_0</title>
<polygon fill="lightsteelblue" stroke="black" points="481.5,-4694.17 16.5,-4694.17 16.5,-4626.17 481.5,-4626.17 481.5,-4694.17"/>
<text text-anchor="middle" x="249" y="-4678.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="249" y="-4663.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="249" y="-4648.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="249" y="-4633.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_route_0&#45;&gt;layer1_expert_0 -->
<g id="edge150" class="edge">
<title>layer1_route_0&#45;&gt;layer1_expert_0</title>
<path fill="none" stroke="black" d="M831.1,-4813C611.78,-4813 380,-4813 380,-4813 380,-4813 380,-4704.47 380,-4704.47"/>
<polygon fill="black" stroke="black" points="383.5,-4704.47 380,-4694.47 376.5,-4704.47 383.5,-4704.47"/>
</g>
<!-- layer1_expert_1 -->
<g id="node112" class="node">
<title>layer1_expert_1</title>
<polygon fill="lightsteelblue" stroke="black" points="964.5,-4694.17 499.5,-4694.17 499.5,-4626.17 964.5,-4626.17 964.5,-4694.17"/>
<text text-anchor="middle" x="732" y="-4678.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="732" y="-4663.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="732" y="-4648.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="732" y="-4633.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_route_0&#45;&gt;layer1_expert_1 -->
<g id="edge152" class="edge">
<title>layer1_route_0&#45;&gt;layer1_expert_1</title>
<path fill="none" stroke="black" d="M848.7,-4729.95C848.7,-4729.95 848.7,-4704.23 848.7,-4704.23"/>
<polygon fill="black" stroke="black" points="852.2,-4704.23 848.7,-4694.23 845.2,-4704.23 852.2,-4704.23"/>
</g>
<!-- layer1_expert_2 -->
<g id="node113" class="node">
<title>layer1_expert_2</title>
<polygon fill="lightsteelblue" stroke="black" points="1447.5,-4694.17 982.5,-4694.17 982.5,-4626.17 1447.5,-4626.17 1447.5,-4694.17"/>
<text text-anchor="middle" x="1215" y="-4678.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1215" y="-4663.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1215" y="-4648.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="1215" y="-4633.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_route_0&#45;&gt;layer1_expert_2 -->
<g id="edge154" class="edge">
<title>layer1_route_0&#45;&gt;layer1_expert_2</title>
<path fill="none" stroke="black" d="M1215,-4729.95C1215,-4729.95 1215,-4704.23 1215,-4704.23"/>
<polygon fill="black" stroke="black" points="1218.5,-4704.23 1215,-4694.23 1211.5,-4704.23 1218.5,-4704.23"/>
</g>
<!-- layer1_expert_3 -->
<g id="node114" class="node">
<title>layer1_expert_3</title>
<polygon fill="lightsteelblue" stroke="black" points="1930.5,-4694.17 1465.5,-4694.17 1465.5,-4626.17 1930.5,-4626.17 1930.5,-4694.17"/>
<text text-anchor="middle" x="1698" y="-4678.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1698" y="-4663.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1698" y="-4648.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="1698" y="-4633.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_route_0&#45;&gt;layer1_expert_3 -->
<g id="edge156" class="edge">
<title>layer1_route_0&#45;&gt;layer1_expert_3</title>
<path fill="none" stroke="black" d="M1581.3,-4798.5C1581.3,-4798.5 1581.3,-4704.45 1581.3,-4704.45"/>
<polygon fill="black" stroke="black" points="1584.8,-4704.45 1581.3,-4694.45 1577.8,-4704.45 1584.8,-4704.45"/>
</g>
<!-- layer1_expert_agg_0 -->
<g id="node115" class="node">
<title>layer1_expert_agg_0</title>
<polygon fill="lightyellow" stroke="black" points="1689.67,-4590.17 934.58,-4590.17 740.33,-4454.17 1495.42,-4454.17 1689.67,-4590.17"/>
<text text-anchor="middle" x="1215" y="-4540.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1215" y="-4525.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="1215" y="-4510.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1215" y="-4495.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_expert_0&#45;&gt;layer1_expert_agg_0 -->
<g id="edge151" class="edge">
<title>layer1_expert_0&#45;&gt;layer1_expert_agg_0</title>
<path fill="none" stroke="black" d="M249,-4626.01C249,-4585.1 249,-4522 249,-4522 249,-4522 827.02,-4522 827.02,-4522"/>
<polygon fill="black" stroke="black" points="827.02,-4525.5 837.02,-4522 827.02,-4518.5 827.02,-4525.5"/>
</g>
<!-- layer1_expert_1&#45;&gt;layer1_expert_agg_0 -->
<g id="edge153" class="edge">
<title>layer1_expert_1&#45;&gt;layer1_expert_agg_0</title>
<path fill="none" stroke="black" d="M852.33,-4626.05C852.33,-4626.05 852.33,-4542.65 852.33,-4542.65"/>
<polygon fill="black" stroke="black" points="855.83,-4542.65 852.33,-4532.65 848.83,-4542.65 855.83,-4542.65"/>
</g>
<!-- layer1_expert_2&#45;&gt;layer1_expert_agg_0 -->
<g id="edge155" class="edge">
<title>layer1_expert_2&#45;&gt;layer1_expert_agg_0</title>
<path fill="none" stroke="black" d="M1215,-4626.05C1215,-4626.05 1215,-4600.4 1215,-4600.4"/>
<polygon fill="black" stroke="black" points="1218.5,-4600.4 1215,-4590.4 1211.5,-4600.4 1218.5,-4600.4"/>
</g>
<!-- layer1_expert_3&#45;&gt;layer1_expert_agg_0 -->
<g id="edge157" class="edge">
<title>layer1_expert_3&#45;&gt;layer1_expert_agg_0</title>
<path fill="none" stroke="black" d="M1577.67,-4626.05C1577.67,-4626.05 1577.67,-4600.4 1577.67,-4600.4"/>
<polygon fill="black" stroke="black" points="1581.17,-4600.4 1577.67,-4590.4 1574.17,-4600.4 1581.17,-4600.4"/>
</g>
<!-- layer1_expert_allreduce -->
<g id="node134" class="node">
<title>layer1_expert_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="5312.67,-4418.17 4557.58,-4418.17 4363.33,-4282.17 5118.42,-4282.17 5312.67,-4418.17"/>
<text text-anchor="middle" x="4838" y="-4368.97" font-family="Times,serif" font-size="14.00">MoE All&#45;Reduce</text>
<text text-anchor="middle" x="4838" y="-4353.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4838" y="-4338.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4838" y="-4323.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer1_expert_agg_0&#45;&gt;layer1_expert_allreduce -->
<g id="edge185" class="edge">
<title>layer1_expert_agg_0&#45;&gt;layer1_expert_allreduce</title>
<path fill="none" stroke="black" d="M1640.17,-4522.03C1640.17,-4516.12 1640.17,-4327 1640.17,-4327 1640.17,-4327 4417.3,-4327 4417.3,-4327"/>
<polygon fill="black" stroke="black" points="4417.3,-4330.5 4427.3,-4327 4417.3,-4323.5 4417.3,-4330.5"/>
</g>
<!-- layer1_expert_4 -->
<g id="node117" class="node">
<title>layer1_expert_4</title>
<polygon fill="lightsteelblue" stroke="black" points="2413.5,-4694.17 1948.5,-4694.17 1948.5,-4626.17 2413.5,-4626.17 2413.5,-4694.17"/>
<text text-anchor="middle" x="2181" y="-4678.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2181" y="-4663.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2181" y="-4648.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="2181" y="-4633.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_route_1&#45;&gt;layer1_expert_4 -->
<g id="edge159" class="edge">
<title>layer1_route_1&#45;&gt;layer1_expert_4</title>
<path fill="none" stroke="black" d="M2763.16,-4813C2557.72,-4813 2346.5,-4813 2346.5,-4813 2346.5,-4813 2346.5,-4704.47 2346.5,-4704.47"/>
<polygon fill="black" stroke="black" points="2350,-4704.47 2346.5,-4694.47 2343,-4704.47 2350,-4704.47"/>
</g>
<!-- layer1_expert_5 -->
<g id="node118" class="node">
<title>layer1_expert_5</title>
<polygon fill="lightsteelblue" stroke="black" points="2896.5,-4694.17 2431.5,-4694.17 2431.5,-4626.17 2896.5,-4626.17 2896.5,-4694.17"/>
<text text-anchor="middle" x="2664" y="-4678.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2664" y="-4663.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2664" y="-4648.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="2664" y="-4633.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_route_1&#45;&gt;layer1_expert_5 -->
<g id="edge161" class="edge">
<title>layer1_route_1&#45;&gt;layer1_expert_5</title>
<path fill="none" stroke="black" d="M2780.7,-4729.95C2780.7,-4729.95 2780.7,-4704.23 2780.7,-4704.23"/>
<polygon fill="black" stroke="black" points="2784.2,-4704.23 2780.7,-4694.23 2777.2,-4704.23 2784.2,-4704.23"/>
</g>
<!-- layer1_expert_6 -->
<g id="node119" class="node">
<title>layer1_expert_6</title>
<polygon fill="lightsteelblue" stroke="black" points="3379.5,-4694.17 2914.5,-4694.17 2914.5,-4626.17 3379.5,-4626.17 3379.5,-4694.17"/>
<text text-anchor="middle" x="3147" y="-4678.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="3147" y="-4663.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3147" y="-4648.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="3147" y="-4633.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_route_1&#45;&gt;layer1_expert_6 -->
<g id="edge163" class="edge">
<title>layer1_route_1&#45;&gt;layer1_expert_6</title>
<path fill="none" stroke="black" d="M3147,-4729.95C3147,-4729.95 3147,-4704.23 3147,-4704.23"/>
<polygon fill="black" stroke="black" points="3150.5,-4704.23 3147,-4694.23 3143.5,-4704.23 3150.5,-4704.23"/>
</g>
<!-- layer1_expert_7 -->
<g id="node120" class="node">
<title>layer1_expert_7</title>
<polygon fill="lightsteelblue" stroke="black" points="3862.5,-4694.17 3397.5,-4694.17 3397.5,-4626.17 3862.5,-4626.17 3862.5,-4694.17"/>
<text text-anchor="middle" x="3630" y="-4678.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3630" y="-4663.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3630" y="-4648.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="3630" y="-4633.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_route_1&#45;&gt;layer1_expert_7 -->
<g id="edge165" class="edge">
<title>layer1_route_1&#45;&gt;layer1_expert_7</title>
<path fill="none" stroke="black" d="M3513.3,-4798.5C3513.3,-4798.5 3513.3,-4704.45 3513.3,-4704.45"/>
<polygon fill="black" stroke="black" points="3516.8,-4704.45 3513.3,-4694.45 3509.8,-4704.45 3516.8,-4704.45"/>
</g>
<!-- layer1_expert_agg_1 -->
<g id="node121" class="node">
<title>layer1_expert_agg_1</title>
<polygon fill="lightyellow" stroke="black" points="3621.67,-4590.17 2866.58,-4590.17 2672.33,-4454.17 3427.42,-4454.17 3621.67,-4590.17"/>
<text text-anchor="middle" x="3147" y="-4540.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3147" y="-4525.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="3147" y="-4510.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3147" y="-4495.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_expert_4&#45;&gt;layer1_expert_agg_1 -->
<g id="edge160" class="edge">
<title>layer1_expert_4&#45;&gt;layer1_expert_agg_1</title>
<path fill="none" stroke="black" d="M2363,-4626.01C2363,-4585.1 2363,-4522 2363,-4522 2363,-4522 2759.07,-4522 2759.07,-4522"/>
<polygon fill="black" stroke="black" points="2759.07,-4525.5 2769.07,-4522 2759.07,-4518.5 2759.07,-4525.5"/>
</g>
<!-- layer1_expert_5&#45;&gt;layer1_expert_agg_1 -->
<g id="edge162" class="edge">
<title>layer1_expert_5&#45;&gt;layer1_expert_agg_1</title>
<path fill="none" stroke="black" d="M2784.33,-4626.05C2784.33,-4626.05 2784.33,-4542.65 2784.33,-4542.65"/>
<polygon fill="black" stroke="black" points="2787.83,-4542.65 2784.33,-4532.65 2780.83,-4542.65 2787.83,-4542.65"/>
</g>
<!-- layer1_expert_6&#45;&gt;layer1_expert_agg_1 -->
<g id="edge164" class="edge">
<title>layer1_expert_6&#45;&gt;layer1_expert_agg_1</title>
<path fill="none" stroke="black" d="M3147,-4626.05C3147,-4626.05 3147,-4600.4 3147,-4600.4"/>
<polygon fill="black" stroke="black" points="3150.5,-4600.4 3147,-4590.4 3143.5,-4600.4 3150.5,-4600.4"/>
</g>
<!-- layer1_expert_7&#45;&gt;layer1_expert_agg_1 -->
<g id="edge166" class="edge">
<title>layer1_expert_7&#45;&gt;layer1_expert_agg_1</title>
<path fill="none" stroke="black" d="M3509.67,-4626.05C3509.67,-4626.05 3509.67,-4600.4 3509.67,-4600.4"/>
<polygon fill="black" stroke="black" points="3513.17,-4600.4 3509.67,-4590.4 3506.17,-4600.4 3513.17,-4600.4"/>
</g>
<!-- layer1_expert_agg_1&#45;&gt;layer1_expert_allreduce -->
<g id="edge186" class="edge">
<title>layer1_expert_agg_1&#45;&gt;layer1_expert_allreduce</title>
<path fill="none" stroke="black" d="M3492.17,-4499.36C3492.17,-4457.35 3492.17,-4372 3492.17,-4372 3492.17,-4372 4481.41,-4372 4481.41,-4372"/>
<polygon fill="black" stroke="black" points="4481.41,-4375.5 4491.41,-4372 4481.41,-4368.5 4481.41,-4375.5"/>
</g>
<!-- layer1_expert_8 -->
<g id="node123" class="node">
<title>layer1_expert_8</title>
<polygon fill="lightsteelblue" stroke="black" points="4345.5,-4694.17 3880.5,-4694.17 3880.5,-4626.17 4345.5,-4626.17 4345.5,-4694.17"/>
<text text-anchor="middle" x="4113" y="-4678.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="4113" y="-4663.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4113" y="-4648.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="4113" y="-4633.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_route_2&#45;&gt;layer1_expert_8 -->
<g id="edge168" class="edge">
<title>layer1_route_2&#45;&gt;layer1_expert_8</title>
<path fill="none" stroke="black" d="M4359.54,-4813.06C4359.54,-4808.42 4359.54,-4660 4359.54,-4660 4359.54,-4660 4355.58,-4660 4355.58,-4660"/>
<polygon fill="black" stroke="black" points="4355.58,-4656.5 4345.58,-4660 4355.58,-4663.5 4355.58,-4656.5"/>
</g>
<!-- layer1_expert_9 -->
<g id="node124" class="node">
<title>layer1_expert_9</title>
<polygon fill="lightsteelblue" stroke="black" points="4828.5,-4694.17 4363.5,-4694.17 4363.5,-4626.17 4828.5,-4626.17 4828.5,-4694.17"/>
<text text-anchor="middle" x="4596" y="-4678.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="4596" y="-4663.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4596" y="-4648.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="4596" y="-4633.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_route_2&#45;&gt;layer1_expert_9 -->
<g id="edge170" class="edge">
<title>layer1_route_2&#45;&gt;layer1_expert_9</title>
<path fill="none" stroke="black" d="M4596,-4729.95C4596,-4729.95 4596,-4704.23 4596,-4704.23"/>
<polygon fill="black" stroke="black" points="4599.5,-4704.23 4596,-4694.23 4592.5,-4704.23 4599.5,-4704.23"/>
</g>
<!-- layer1_expert_10 -->
<g id="node125" class="node">
<title>layer1_expert_10</title>
<polygon fill="lightsteelblue" stroke="black" points="5311.5,-4694.17 4846.5,-4694.17 4846.5,-4626.17 5311.5,-4626.17 5311.5,-4694.17"/>
<text text-anchor="middle" x="5079" y="-4678.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="5079" y="-4663.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5079" y="-4648.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="5079" y="-4633.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_route_2&#45;&gt;layer1_expert_10 -->
<g id="edge172" class="edge">
<title>layer1_route_2&#45;&gt;layer1_expert_10</title>
<path fill="none" stroke="black" d="M5079,-4729.95C5079,-4729.95 5079,-4704.23 5079,-4704.23"/>
<polygon fill="black" stroke="black" points="5082.5,-4704.23 5079,-4694.23 5075.5,-4704.23 5082.5,-4704.23"/>
</g>
<!-- layer1_expert_11 -->
<g id="node126" class="node">
<title>layer1_expert_11</title>
<polygon fill="lightsteelblue" stroke="black" points="5794.5,-4694.17 5329.5,-4694.17 5329.5,-4626.17 5794.5,-4626.17 5794.5,-4694.17"/>
<text text-anchor="middle" x="5562" y="-4678.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="5562" y="-4663.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5562" y="-4648.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="5562" y="-4633.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_route_2&#45;&gt;layer1_expert_11 -->
<g id="edge174" class="edge">
<title>layer1_route_2&#45;&gt;layer1_expert_11</title>
<path fill="none" stroke="black" d="M5316.46,-4813.06C5316.46,-4808.42 5316.46,-4660 5316.46,-4660 5316.46,-4660 5319.32,-4660 5319.32,-4660"/>
<polygon fill="black" stroke="black" points="5319.32,-4663.5 5329.32,-4660 5319.32,-4656.5 5319.32,-4663.5"/>
</g>
<!-- layer1_expert_agg_2 -->
<g id="node127" class="node">
<title>layer1_expert_agg_2</title>
<polygon fill="lightyellow" stroke="black" points="5312.67,-4590.17 4557.58,-4590.17 4363.33,-4454.17 5118.42,-4454.17 5312.67,-4590.17"/>
<text text-anchor="middle" x="4838" y="-4540.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4838" y="-4525.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="4838" y="-4510.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4838" y="-4495.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_expert_8&#45;&gt;layer1_expert_agg_2 -->
<g id="edge169" class="edge">
<title>layer1_expert_8&#45;&gt;layer1_expert_agg_2</title>
<path fill="none" stroke="black" d="M4116.5,-4626.01C4116.5,-4585.1 4116.5,-4522 4116.5,-4522 4116.5,-4522 4450.08,-4522 4450.08,-4522"/>
<polygon fill="black" stroke="black" points="4450.08,-4525.5 4460.08,-4522 4450.08,-4518.5 4450.08,-4525.5"/>
</g>
<!-- layer1_expert_9&#45;&gt;layer1_expert_agg_2 -->
<g id="edge171" class="edge">
<title>layer1_expert_9&#45;&gt;layer1_expert_agg_2</title>
<path fill="none" stroke="black" d="M4596,-4626.05C4596,-4626.05 4596,-4600.4 4596,-4600.4"/>
<polygon fill="black" stroke="black" points="4599.5,-4600.4 4596,-4590.4 4592.5,-4600.4 4599.5,-4600.4"/>
</g>
<!-- layer1_expert_10&#45;&gt;layer1_expert_agg_2 -->
<g id="edge173" class="edge">
<title>layer1_expert_10&#45;&gt;layer1_expert_agg_2</title>
<path fill="none" stroke="black" d="M5079,-4626.05C5079,-4626.05 5079,-4600.4 5079,-4600.4"/>
<polygon fill="black" stroke="black" points="5082.5,-4600.4 5079,-4590.4 5075.5,-4600.4 5082.5,-4600.4"/>
</g>
<!-- layer1_expert_11&#45;&gt;layer1_expert_agg_2 -->
<g id="edge175" class="edge">
<title>layer1_expert_11&#45;&gt;layer1_expert_agg_2</title>
<path fill="none" stroke="black" d="M5367.83,-4626.01C5367.83,-4585.1 5367.83,-4522 5367.83,-4522 5367.83,-4522 5225.65,-4522 5225.65,-4522"/>
<polygon fill="black" stroke="black" points="5225.65,-4518.5 5215.65,-4522 5225.65,-4525.5 5225.65,-4518.5"/>
</g>
<!-- layer1_expert_agg_2&#45;&gt;layer1_expert_allreduce -->
<g id="edge187" class="edge">
<title>layer1_expert_agg_2&#45;&gt;layer1_expert_allreduce</title>
<path fill="none" stroke="black" d="M4838,-4453.69C4838,-4453.69 4838,-4428.4 4838,-4428.4"/>
<polygon fill="black" stroke="black" points="4841.5,-4428.4 4838,-4418.4 4834.5,-4428.4 4841.5,-4428.4"/>
</g>
<!-- layer1_expert_12 -->
<g id="node129" class="node">
<title>layer1_expert_12</title>
<polygon fill="lightsteelblue" stroke="black" points="6277.5,-4694.17 5812.5,-4694.17 5812.5,-4626.17 6277.5,-4626.17 6277.5,-4694.17"/>
<text text-anchor="middle" x="6045" y="-4678.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="6045" y="-4663.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6045" y="-4648.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="6045" y="-4633.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_route_3&#45;&gt;layer1_expert_12 -->
<g id="edge177" class="edge">
<title>layer1_route_3&#45;&gt;layer1_expert_12</title>
<path fill="none" stroke="black" d="M6161.7,-4729.95C6161.7,-4729.95 6161.7,-4704.23 6161.7,-4704.23"/>
<polygon fill="black" stroke="black" points="6165.2,-4704.23 6161.7,-4694.23 6158.2,-4704.23 6165.2,-4704.23"/>
</g>
<!-- layer1_expert_13 -->
<g id="node130" class="node">
<title>layer1_expert_13</title>
<polygon fill="lightsteelblue" stroke="black" points="6760.5,-4694.17 6295.5,-4694.17 6295.5,-4626.17 6760.5,-4626.17 6760.5,-4694.17"/>
<text text-anchor="middle" x="6528" y="-4678.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="6528" y="-4663.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6528" y="-4648.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="6528" y="-4633.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_route_3&#45;&gt;layer1_expert_13 -->
<g id="edge179" class="edge">
<title>layer1_route_3&#45;&gt;layer1_expert_13</title>
<path fill="none" stroke="black" d="M6528,-4729.95C6528,-4729.95 6528,-4704.23 6528,-4704.23"/>
<polygon fill="black" stroke="black" points="6531.5,-4704.23 6528,-4694.23 6524.5,-4704.23 6531.5,-4704.23"/>
</g>
<!-- layer1_expert_14 -->
<g id="node131" class="node">
<title>layer1_expert_14</title>
<polygon fill="lightsteelblue" stroke="black" points="7243.5,-4694.17 6778.5,-4694.17 6778.5,-4626.17 7243.5,-4626.17 7243.5,-4694.17"/>
<text text-anchor="middle" x="7011" y="-4678.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="7011" y="-4663.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7011" y="-4648.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="7011" y="-4633.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_route_3&#45;&gt;layer1_expert_14 -->
<g id="edge181" class="edge">
<title>layer1_route_3&#45;&gt;layer1_expert_14</title>
<path fill="none" stroke="black" d="M6894.3,-4798.5C6894.3,-4798.5 6894.3,-4704.45 6894.3,-4704.45"/>
<polygon fill="black" stroke="black" points="6897.8,-4704.45 6894.3,-4694.45 6890.8,-4704.45 6897.8,-4704.45"/>
</g>
<!-- layer1_expert_15 -->
<g id="node132" class="node">
<title>layer1_expert_15</title>
<polygon fill="lightsteelblue" stroke="black" points="7726.5,-4694.17 7261.5,-4694.17 7261.5,-4626.17 7726.5,-4626.17 7726.5,-4694.17"/>
<text text-anchor="middle" x="7494" y="-4678.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="7494" y="-4663.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7494" y="-4648.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="7494" y="-4633.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_route_3&#45;&gt;layer1_expert_15 -->
<g id="edge183" class="edge">
<title>layer1_route_3&#45;&gt;layer1_expert_15</title>
<path fill="none" stroke="black" d="M6911.59,-4813C7131.81,-4813 7365,-4813 7365,-4813 7365,-4813 7365,-4704.47 7365,-4704.47"/>
<polygon fill="black" stroke="black" points="7368.5,-4704.47 7365,-4694.47 7361.5,-4704.47 7368.5,-4704.47"/>
</g>
<!-- layer1_expert_agg_3 -->
<g id="node133" class="node">
<title>layer1_expert_agg_3</title>
<polygon fill="lightyellow" stroke="black" points="7002.67,-4590.17 6247.58,-4590.17 6053.33,-4454.17 6808.42,-4454.17 7002.67,-4590.17"/>
<text text-anchor="middle" x="6528" y="-4540.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="6528" y="-4525.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="6528" y="-4510.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6528" y="-4495.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_expert_12&#45;&gt;layer1_expert_agg_3 -->
<g id="edge178" class="edge">
<title>layer1_expert_12&#45;&gt;layer1_expert_agg_3</title>
<path fill="none" stroke="black" d="M6165.33,-4626.05C6165.33,-4626.05 6165.33,-4542.65 6165.33,-4542.65"/>
<polygon fill="black" stroke="black" points="6168.83,-4542.65 6165.33,-4532.65 6161.83,-4542.65 6168.83,-4542.65"/>
</g>
<!-- layer1_expert_13&#45;&gt;layer1_expert_agg_3 -->
<g id="edge180" class="edge">
<title>layer1_expert_13&#45;&gt;layer1_expert_agg_3</title>
<path fill="none" stroke="black" d="M6528,-4626.05C6528,-4626.05 6528,-4600.4 6528,-4600.4"/>
<polygon fill="black" stroke="black" points="6531.5,-4600.4 6528,-4590.4 6524.5,-4600.4 6531.5,-4600.4"/>
</g>
<!-- layer1_expert_14&#45;&gt;layer1_expert_agg_3 -->
<g id="edge182" class="edge">
<title>layer1_expert_14&#45;&gt;layer1_expert_agg_3</title>
<path fill="none" stroke="black" d="M6890.67,-4626.05C6890.67,-4626.05 6890.67,-4600.4 6890.67,-4600.4"/>
<polygon fill="black" stroke="black" points="6894.17,-4600.4 6890.67,-4590.4 6887.17,-4600.4 6894.17,-4600.4"/>
</g>
<!-- layer1_expert_15&#45;&gt;layer1_expert_agg_3 -->
<g id="edge184" class="edge">
<title>layer1_expert_15&#45;&gt;layer1_expert_agg_3</title>
<path fill="none" stroke="black" d="M7403,-4626.01C7403,-4585.1 7403,-4522 7403,-4522 7403,-4522 6915.43,-4522 6915.43,-4522"/>
<polygon fill="black" stroke="black" points="6915.43,-4518.5 6905.43,-4522 6915.43,-4525.5 6915.43,-4518.5"/>
</g>
<!-- layer1_expert_agg_3&#45;&gt;layer1_expert_allreduce -->
<g id="edge188" class="edge">
<title>layer1_expert_agg_3&#45;&gt;layer1_expert_allreduce</title>
<path fill="none" stroke="black" d="M6227.08,-4454.11C6227.08,-4414.38 6227.08,-4372 6227.08,-4372 6227.08,-4372 5256.79,-4372 5256.79,-4372"/>
<polygon fill="black" stroke="black" points="5256.79,-4368.5 5246.79,-4372 5256.79,-4375.5 5256.79,-4368.5"/>
</g>
<!-- layer1_expert_allreduce&#45;&gt;layer1_residual2 -->
<g id="edge189" class="edge">
<title>layer1_expert_allreduce&#45;&gt;layer1_residual2</title>
<path fill="none" stroke="black" d="M5182.67,-4327C5399.97,-4327 5639.75,-4327 5639.75,-4327 5639.75,-4327 5639.75,-4201.33 5639.75,-4201.33"/>
<polygon fill="black" stroke="black" points="5643.25,-4201.33 5639.75,-4191.33 5636.25,-4201.33 5643.25,-4201.33"/>
</g>
<!-- layer2_ln1 -->
<g id="node136" class="node">
<title>layer2_ln1</title>
<polygon fill="lightgreen" stroke="black" points="5945,-4033.17 5487,-4033.17 5487,-3965.17 5945,-3965.17 5945,-4033.17"/>
<text text-anchor="middle" x="5716" y="-4017.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5716" y="-4002.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5716" y="-3987.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5716" y="-3972.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer1_residual2&#45;&gt;layer2_ln1 -->
<g id="edge191" class="edge">
<title>layer1_residual2&#45;&gt;layer2_ln1</title>
<path fill="none" stroke="black" d="M5716,-4120.93C5716,-4120.93 5716,-4043.26 5716,-4043.26"/>
<polygon fill="black" stroke="black" points="5719.5,-4043.26 5716,-4033.26 5712.5,-4043.26 5719.5,-4043.26"/>
</g>
<!-- layer2_residual1 -->
<g id="node174" class="node">
<title>layer2_residual1</title>
<polygon fill="lightpink" stroke="black" points="7828,-3400.17 7370,-3317.17 7828,-3234.17 8286,-3317.17 7828,-3400.17"/>
<text text-anchor="middle" x="7828" y="-3343.47" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7828" y="-3328.47" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7828" y="-3313.47" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7828" y="-3298.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7828" y="-3283.47" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer1_residual2&#45;&gt;layer2_residual1 -->
<g id="edge241" class="edge">
<title>layer1_residual2&#45;&gt;layer2_residual1</title>
<path fill="none" stroke="black" d="M6400.29,-4163C6875.65,-4163 7551,-4163 7551,-4163 7551,-4163 7551,-3360.06 7551,-3360.06"/>
<polygon fill="black" stroke="black" points="7554.5,-3360.06 7551,-3350.06 7547.5,-3360.06 7554.5,-3360.06"/>
</g>
<!-- layer2_qkv_proj_0 -->
<g id="node137" class="node">
<title>layer2_qkv_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="2819.5,-3929.17 2312.5,-3929.17 2312.5,-3846.17 2819.5,-3846.17 2819.5,-3929.17"/>
<text text-anchor="middle" x="2566" y="-3913.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2566" y="-3898.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="2566" y="-3883.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2566" y="-3868.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2566" y="-3853.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_qkv_proj_0 -->
<g id="edge192" class="edge">
<title>layer2_ln1&#45;&gt;layer2_qkv_proj_0</title>
<path fill="none" stroke="black" d="M5486.95,-4023C4790.56,-4023 2745.83,-4023 2745.83,-4023 2745.83,-4023 2745.83,-3939.38 2745.83,-3939.38"/>
<polygon fill="black" stroke="black" points="2749.33,-3939.38 2745.83,-3929.38 2742.33,-3939.38 2749.33,-3939.38"/>
</g>
<!-- layer2_qkv_proj_1 -->
<g id="node138" class="node">
<title>layer2_qkv_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="3344.5,-3929.17 2837.5,-3929.17 2837.5,-3846.17 3344.5,-3846.17 3344.5,-3929.17"/>
<text text-anchor="middle" x="3091" y="-3913.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3091" y="-3898.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3091" y="-3883.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3091" y="-3868.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3091" y="-3853.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_qkv_proj_1 -->
<g id="edge196" class="edge">
<title>layer2_ln1&#45;&gt;layer2_qkv_proj_1</title>
<path fill="none" stroke="black" d="M5486.78,-4013C4847.42,-4013 3091,-4013 3091,-4013 3091,-4013 3091,-3939.4 3091,-3939.4"/>
<polygon fill="black" stroke="black" points="3094.5,-3939.4 3091,-3929.4 3087.5,-3939.4 3094.5,-3939.4"/>
</g>
<!-- layer2_qkv_proj_2 -->
<g id="node139" class="node">
<title>layer2_qkv_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="3869.5,-3929.17 3362.5,-3929.17 3362.5,-3846.17 3869.5,-3846.17 3869.5,-3929.17"/>
<text text-anchor="middle" x="3616" y="-3913.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3616" y="-3898.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3616" y="-3883.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3616" y="-3868.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3616" y="-3853.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_qkv_proj_2 -->
<g id="edge200" class="edge">
<title>layer2_ln1&#45;&gt;layer2_qkv_proj_2</title>
<path fill="none" stroke="black" d="M5486.83,-4004C4991.62,-4004 3866,-4004 3866,-4004 3866,-4004 3866,-3939.34 3866,-3939.34"/>
<polygon fill="black" stroke="black" points="3869.5,-3939.34 3866,-3929.34 3862.5,-3939.34 3869.5,-3939.34"/>
</g>
<!-- layer2_qkv_proj_3 -->
<g id="node140" class="node">
<title>layer2_qkv_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="4394.5,-3929.17 3887.5,-3929.17 3887.5,-3846.17 4394.5,-3846.17 4394.5,-3929.17"/>
<text text-anchor="middle" x="4141" y="-3913.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4141" y="-3898.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4141" y="-3883.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4141" y="-3868.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4141" y="-3853.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_qkv_proj_3 -->
<g id="edge204" class="edge">
<title>layer2_ln1&#45;&gt;layer2_qkv_proj_3</title>
<path fill="none" stroke="black" d="M5486.89,-3994C5104.78,-3994 4378.83,-3994 4378.83,-3994 4378.83,-3994 4378.83,-3939.39 4378.83,-3939.39"/>
<polygon fill="black" stroke="black" points="4382.33,-3939.39 4378.83,-3929.39 4375.33,-3939.39 4382.33,-3939.39"/>
</g>
<!-- layer2_qkv_proj_4 -->
<g id="node141" class="node">
<title>layer2_qkv_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="4919.5,-3929.17 4412.5,-3929.17 4412.5,-3846.17 4919.5,-3846.17 4919.5,-3929.17"/>
<text text-anchor="middle" x="4666" y="-3913.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4666" y="-3898.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4666" y="-3883.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4666" y="-3868.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4666" y="-3853.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_qkv_proj_4 -->
<g id="edge208" class="edge">
<title>layer2_ln1&#45;&gt;layer2_qkv_proj_4</title>
<path fill="none" stroke="black" d="M5486.87,-3984C5177.92,-3984 4666,-3984 4666,-3984 4666,-3984 4666,-3939.36 4666,-3939.36"/>
<polygon fill="black" stroke="black" points="4669.5,-3939.36 4666,-3929.36 4662.5,-3939.36 4669.5,-3939.36"/>
</g>
<!-- layer2_qkv_proj_5 -->
<g id="node142" class="node">
<title>layer2_qkv_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="5444.5,-3929.17 4937.5,-3929.17 4937.5,-3846.17 5444.5,-3846.17 5444.5,-3929.17"/>
<text text-anchor="middle" x="5191" y="-3913.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5191" y="-3898.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="5191" y="-3883.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5191" y="-3868.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5191" y="-3853.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_qkv_proj_5 -->
<g id="edge212" class="edge">
<title>layer2_ln1&#45;&gt;layer2_qkv_proj_5</title>
<path fill="none" stroke="black" d="M5486.76,-3974C5440.73,-3974 5406.17,-3974 5406.17,-3974 5406.17,-3974 5406.17,-3939.32 5406.17,-3939.32"/>
<polygon fill="black" stroke="black" points="5409.67,-3939.32 5406.17,-3929.32 5402.67,-3939.32 5409.67,-3939.32"/>
</g>
<!-- layer2_qkv_proj_6 -->
<g id="node143" class="node">
<title>layer2_qkv_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="5969.5,-3929.17 5462.5,-3929.17 5462.5,-3846.17 5969.5,-3846.17 5969.5,-3929.17"/>
<text text-anchor="middle" x="5716" y="-3913.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5716" y="-3898.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="5716" y="-3883.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5716" y="-3868.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5716" y="-3853.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_qkv_proj_6 -->
<g id="edge216" class="edge">
<title>layer2_ln1&#45;&gt;layer2_qkv_proj_6</title>
<path fill="none" stroke="black" d="M5716,-3965.11C5716,-3965.11 5716,-3939.38 5716,-3939.38"/>
<polygon fill="black" stroke="black" points="5719.5,-3939.38 5716,-3929.38 5712.5,-3939.38 5719.5,-3939.38"/>
</g>
<!-- layer2_qkv_proj_7 -->
<g id="node144" class="node">
<title>layer2_qkv_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="6494.5,-3929.17 5987.5,-3929.17 5987.5,-3846.17 6494.5,-3846.17 6494.5,-3929.17"/>
<text text-anchor="middle" x="6241" y="-3913.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6241" y="-3898.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="6241" y="-3883.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6241" y="-3868.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="6241" y="-3853.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_qkv_proj_7 -->
<g id="edge220" class="edge">
<title>layer2_ln1&#45;&gt;layer2_qkv_proj_7</title>
<path fill="none" stroke="black" d="M5945.32,-3976C6068.06,-3976 6194.25,-3976 6194.25,-3976 6194.25,-3976 6194.25,-3939.25 6194.25,-3939.25"/>
<polygon fill="black" stroke="black" points="6197.75,-3939.25 6194.25,-3929.25 6190.75,-3939.25 6197.75,-3939.25"/>
</g>
<!-- layer2_qkv_proj_8 -->
<g id="node145" class="node">
<title>layer2_qkv_proj_8</title>
<polygon fill="lightcoral" stroke="black" points="7019.5,-3929.17 6512.5,-3929.17 6512.5,-3846.17 7019.5,-3846.17 7019.5,-3929.17"/>
<text text-anchor="middle" x="6766" y="-3913.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6766" y="-3898.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="6766" y="-3883.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6766" y="-3868.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6766" y="-3853.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_qkv_proj_8 -->
<g id="edge224" class="edge">
<title>layer2_ln1&#45;&gt;layer2_qkv_proj_8</title>
<path fill="none" stroke="black" d="M5945.24,-3987C6251.94,-3987 6757.67,-3987 6757.67,-3987 6757.67,-3987 6757.67,-3939.22 6757.67,-3939.22"/>
<polygon fill="black" stroke="black" points="6761.17,-3939.22 6757.67,-3929.22 6754.17,-3939.22 6761.17,-3939.22"/>
</g>
<!-- layer2_qkv_proj_9 -->
<g id="node146" class="node">
<title>layer2_qkv_proj_9</title>
<polygon fill="lightcoral" stroke="black" points="7544.5,-3929.17 7037.5,-3929.17 7037.5,-3846.17 7544.5,-3846.17 7544.5,-3929.17"/>
<text text-anchor="middle" x="7291" y="-3913.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7291" y="-3898.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="7291" y="-3883.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7291" y="-3868.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7291" y="-3853.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_qkv_proj_9 -->
<g id="edge228" class="edge">
<title>layer2_ln1&#45;&gt;layer2_qkv_proj_9</title>
<path fill="none" stroke="black" d="M5945.27,-3999C6348.06,-3999 7140.5,-3999 7140.5,-3999 7140.5,-3999 7140.5,-3939.44 7140.5,-3939.44"/>
<polygon fill="black" stroke="black" points="7144,-3939.44 7140.5,-3929.44 7137,-3939.44 7144,-3939.44"/>
</g>
<!-- layer2_qkv_proj_10 -->
<g id="node147" class="node">
<title>layer2_qkv_proj_10</title>
<polygon fill="lightcoral" stroke="black" points="8069.5,-3929.17 7562.5,-3929.17 7562.5,-3846.17 8069.5,-3846.17 8069.5,-3929.17"/>
<text text-anchor="middle" x="7816" y="-3913.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7816" y="-3898.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="7816" y="-3883.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7816" y="-3868.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7816" y="-3853.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_qkv_proj_10 -->
<g id="edge232" class="edge">
<title>layer2_ln1&#45;&gt;layer2_qkv_proj_10</title>
<path fill="none" stroke="black" d="M5945.27,-4010C6456.38,-4010 7644.5,-4010 7644.5,-4010 7644.5,-4010 7644.5,-3939.42 7644.5,-3939.42"/>
<polygon fill="black" stroke="black" points="7648,-3939.42 7644.5,-3929.42 7641,-3939.42 7648,-3939.42"/>
</g>
<!-- layer2_qkv_proj_11 -->
<g id="node148" class="node">
<title>layer2_qkv_proj_11</title>
<polygon fill="lightcoral" stroke="black" points="8594.5,-3929.17 8087.5,-3929.17 8087.5,-3846.17 8594.5,-3846.17 8594.5,-3929.17"/>
<text text-anchor="middle" x="8341" y="-3913.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8341" y="-3898.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="8341" y="-3883.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8341" y="-3868.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="8341" y="-3853.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_qkv_proj_11 -->
<g id="edge236" class="edge">
<title>layer2_ln1&#45;&gt;layer2_qkv_proj_11</title>
<path fill="none" stroke="black" d="M5945.22,-4021C6584.58,-4021 8341,-4021 8341,-4021 8341,-4021 8341,-3939.49 8341,-3939.49"/>
<polygon fill="black" stroke="black" points="8344.5,-3939.49 8341,-3929.49 8337.5,-3939.49 8344.5,-3939.49"/>
</g>
<!-- layer2_attention_0 -->
<g id="node149" class="node">
<title>layer2_attention_0</title>
<polygon fill="lightcoral" stroke="black" points="2819.5,-3810.17 2312.5,-3810.17 2312.5,-3727.17 2819.5,-3727.17 2819.5,-3810.17"/>
<text text-anchor="middle" x="2566" y="-3794.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="2566" y="-3779.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="2566" y="-3764.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2566" y="-3749.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2566" y="-3734.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_qkv_proj_0&#45;&gt;layer2_attention_0 -->
<g id="edge193" class="edge">
<title>layer2_qkv_proj_0&#45;&gt;layer2_attention_0</title>
<path fill="none" stroke="black" d="M2566,-3846.05C2566,-3846.05 2566,-3820.46 2566,-3820.46"/>
<polygon fill="black" stroke="black" points="2569.5,-3820.46 2566,-3810.46 2562.5,-3820.46 2569.5,-3820.46"/>
</g>
<!-- layer2_attention_1 -->
<g id="node150" class="node">
<title>layer2_attention_1</title>
<polygon fill="lightcoral" stroke="black" points="3344.5,-3810.17 2837.5,-3810.17 2837.5,-3727.17 3344.5,-3727.17 3344.5,-3810.17"/>
<text text-anchor="middle" x="3091" y="-3794.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="3091" y="-3779.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3091" y="-3764.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3091" y="-3749.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3091" y="-3734.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_qkv_proj_1&#45;&gt;layer2_attention_1 -->
<g id="edge197" class="edge">
<title>layer2_qkv_proj_1&#45;&gt;layer2_attention_1</title>
<path fill="none" stroke="black" d="M3091,-3846.05C3091,-3846.05 3091,-3820.46 3091,-3820.46"/>
<polygon fill="black" stroke="black" points="3094.5,-3820.46 3091,-3810.46 3087.5,-3820.46 3094.5,-3820.46"/>
</g>
<!-- layer2_attention_2 -->
<g id="node151" class="node">
<title>layer2_attention_2</title>
<polygon fill="lightcoral" stroke="black" points="3869.5,-3810.17 3362.5,-3810.17 3362.5,-3727.17 3869.5,-3727.17 3869.5,-3810.17"/>
<text text-anchor="middle" x="3616" y="-3794.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="3616" y="-3779.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3616" y="-3764.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3616" y="-3749.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3616" y="-3734.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_qkv_proj_2&#45;&gt;layer2_attention_2 -->
<g id="edge201" class="edge">
<title>layer2_qkv_proj_2&#45;&gt;layer2_attention_2</title>
<path fill="none" stroke="black" d="M3616,-3846.05C3616,-3846.05 3616,-3820.46 3616,-3820.46"/>
<polygon fill="black" stroke="black" points="3619.5,-3820.46 3616,-3810.46 3612.5,-3820.46 3619.5,-3820.46"/>
</g>
<!-- layer2_attention_3 -->
<g id="node152" class="node">
<title>layer2_attention_3</title>
<polygon fill="lightcoral" stroke="black" points="4394.5,-3810.17 3887.5,-3810.17 3887.5,-3727.17 4394.5,-3727.17 4394.5,-3810.17"/>
<text text-anchor="middle" x="4141" y="-3794.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="4141" y="-3779.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4141" y="-3764.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4141" y="-3749.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4141" y="-3734.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_qkv_proj_3&#45;&gt;layer2_attention_3 -->
<g id="edge205" class="edge">
<title>layer2_qkv_proj_3&#45;&gt;layer2_attention_3</title>
<path fill="none" stroke="black" d="M4141,-3846.05C4141,-3846.05 4141,-3820.46 4141,-3820.46"/>
<polygon fill="black" stroke="black" points="4144.5,-3820.46 4141,-3810.46 4137.5,-3820.46 4144.5,-3820.46"/>
</g>
<!-- layer2_attention_4 -->
<g id="node153" class="node">
<title>layer2_attention_4</title>
<polygon fill="lightcoral" stroke="black" points="4919.5,-3810.17 4412.5,-3810.17 4412.5,-3727.17 4919.5,-3727.17 4919.5,-3810.17"/>
<text text-anchor="middle" x="4666" y="-3794.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="4666" y="-3779.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4666" y="-3764.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4666" y="-3749.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4666" y="-3734.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_qkv_proj_4&#45;&gt;layer2_attention_4 -->
<g id="edge209" class="edge">
<title>layer2_qkv_proj_4&#45;&gt;layer2_attention_4</title>
<path fill="none" stroke="black" d="M4666,-3846.05C4666,-3846.05 4666,-3820.46 4666,-3820.46"/>
<polygon fill="black" stroke="black" points="4669.5,-3820.46 4666,-3810.46 4662.5,-3820.46 4669.5,-3820.46"/>
</g>
<!-- layer2_attention_5 -->
<g id="node154" class="node">
<title>layer2_attention_5</title>
<polygon fill="lightcoral" stroke="black" points="5444.5,-3810.17 4937.5,-3810.17 4937.5,-3727.17 5444.5,-3727.17 5444.5,-3810.17"/>
<text text-anchor="middle" x="5191" y="-3794.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="5191" y="-3779.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="5191" y="-3764.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5191" y="-3749.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5191" y="-3734.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_qkv_proj_5&#45;&gt;layer2_attention_5 -->
<g id="edge213" class="edge">
<title>layer2_qkv_proj_5&#45;&gt;layer2_attention_5</title>
<path fill="none" stroke="black" d="M5191,-3846.05C5191,-3846.05 5191,-3820.46 5191,-3820.46"/>
<polygon fill="black" stroke="black" points="5194.5,-3820.46 5191,-3810.46 5187.5,-3820.46 5194.5,-3820.46"/>
</g>
<!-- layer2_attention_6 -->
<g id="node155" class="node">
<title>layer2_attention_6</title>
<polygon fill="lightcoral" stroke="black" points="5969.5,-3810.17 5462.5,-3810.17 5462.5,-3727.17 5969.5,-3727.17 5969.5,-3810.17"/>
<text text-anchor="middle" x="5716" y="-3794.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="5716" y="-3779.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="5716" y="-3764.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5716" y="-3749.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5716" y="-3734.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_qkv_proj_6&#45;&gt;layer2_attention_6 -->
<g id="edge217" class="edge">
<title>layer2_qkv_proj_6&#45;&gt;layer2_attention_6</title>
<path fill="none" stroke="black" d="M5716,-3846.05C5716,-3846.05 5716,-3820.46 5716,-3820.46"/>
<polygon fill="black" stroke="black" points="5719.5,-3820.46 5716,-3810.46 5712.5,-3820.46 5719.5,-3820.46"/>
</g>
<!-- layer2_attention_7 -->
<g id="node156" class="node">
<title>layer2_attention_7</title>
<polygon fill="lightcoral" stroke="black" points="6494.5,-3810.17 5987.5,-3810.17 5987.5,-3727.17 6494.5,-3727.17 6494.5,-3810.17"/>
<text text-anchor="middle" x="6241" y="-3794.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="6241" y="-3779.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="6241" y="-3764.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="6241" y="-3749.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="6241" y="-3734.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_qkv_proj_7&#45;&gt;layer2_attention_7 -->
<g id="edge221" class="edge">
<title>layer2_qkv_proj_7&#45;&gt;layer2_attention_7</title>
<path fill="none" stroke="black" d="M6241,-3846.05C6241,-3846.05 6241,-3820.46 6241,-3820.46"/>
<polygon fill="black" stroke="black" points="6244.5,-3820.46 6241,-3810.46 6237.5,-3820.46 6244.5,-3820.46"/>
</g>
<!-- layer2_attention_8 -->
<g id="node157" class="node">
<title>layer2_attention_8</title>
<polygon fill="lightcoral" stroke="black" points="7019.5,-3810.17 6512.5,-3810.17 6512.5,-3727.17 7019.5,-3727.17 7019.5,-3810.17"/>
<text text-anchor="middle" x="6766" y="-3794.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="6766" y="-3779.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="6766" y="-3764.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6766" y="-3749.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6766" y="-3734.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_qkv_proj_8&#45;&gt;layer2_attention_8 -->
<g id="edge225" class="edge">
<title>layer2_qkv_proj_8&#45;&gt;layer2_attention_8</title>
<path fill="none" stroke="black" d="M6766,-3846.05C6766,-3846.05 6766,-3820.46 6766,-3820.46"/>
<polygon fill="black" stroke="black" points="6769.5,-3820.46 6766,-3810.46 6762.5,-3820.46 6769.5,-3820.46"/>
</g>
<!-- layer2_attention_9 -->
<g id="node158" class="node">
<title>layer2_attention_9</title>
<polygon fill="lightcoral" stroke="black" points="7544.5,-3810.17 7037.5,-3810.17 7037.5,-3727.17 7544.5,-3727.17 7544.5,-3810.17"/>
<text text-anchor="middle" x="7291" y="-3794.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="7291" y="-3779.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="7291" y="-3764.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7291" y="-3749.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7291" y="-3734.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_qkv_proj_9&#45;&gt;layer2_attention_9 -->
<g id="edge229" class="edge">
<title>layer2_qkv_proj_9&#45;&gt;layer2_attention_9</title>
<path fill="none" stroke="black" d="M7291,-3846.05C7291,-3846.05 7291,-3820.46 7291,-3820.46"/>
<polygon fill="black" stroke="black" points="7294.5,-3820.46 7291,-3810.46 7287.5,-3820.46 7294.5,-3820.46"/>
</g>
<!-- layer2_attention_10 -->
<g id="node159" class="node">
<title>layer2_attention_10</title>
<polygon fill="lightcoral" stroke="black" points="8069.5,-3810.17 7562.5,-3810.17 7562.5,-3727.17 8069.5,-3727.17 8069.5,-3810.17"/>
<text text-anchor="middle" x="7816" y="-3794.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="7816" y="-3779.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="7816" y="-3764.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7816" y="-3749.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7816" y="-3734.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_qkv_proj_10&#45;&gt;layer2_attention_10 -->
<g id="edge233" class="edge">
<title>layer2_qkv_proj_10&#45;&gt;layer2_attention_10</title>
<path fill="none" stroke="black" d="M7816,-3846.05C7816,-3846.05 7816,-3820.46 7816,-3820.46"/>
<polygon fill="black" stroke="black" points="7819.5,-3820.46 7816,-3810.46 7812.5,-3820.46 7819.5,-3820.46"/>
</g>
<!-- layer2_attention_11 -->
<g id="node160" class="node">
<title>layer2_attention_11</title>
<polygon fill="lightcoral" stroke="black" points="8594.5,-3810.17 8087.5,-3810.17 8087.5,-3727.17 8594.5,-3727.17 8594.5,-3810.17"/>
<text text-anchor="middle" x="8341" y="-3794.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="8341" y="-3779.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="8341" y="-3764.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="8341" y="-3749.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="8341" y="-3734.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_qkv_proj_11&#45;&gt;layer2_attention_11 -->
<g id="edge237" class="edge">
<title>layer2_qkv_proj_11&#45;&gt;layer2_attention_11</title>
<path fill="none" stroke="black" d="M8341,-3846.05C8341,-3846.05 8341,-3820.46 8341,-3820.46"/>
<polygon fill="black" stroke="black" points="8344.5,-3820.46 8341,-3810.46 8337.5,-3820.46 8344.5,-3820.46"/>
</g>
<!-- layer2_attn_out_proj_0 -->
<g id="node161" class="node">
<title>layer2_attn_out_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="2826.5,-3691.17 2331.5,-3691.17 2331.5,-3608.17 2826.5,-3608.17 2826.5,-3691.17"/>
<text text-anchor="middle" x="2579" y="-3675.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="2579" y="-3660.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="2579" y="-3645.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2579" y="-3630.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="2579" y="-3615.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_attention_0&#45;&gt;layer2_attn_out_proj_0 -->
<g id="edge194" class="edge">
<title>layer2_attention_0&#45;&gt;layer2_attn_out_proj_0</title>
<path fill="none" stroke="black" d="M2575.5,-3727.05C2575.5,-3727.05 2575.5,-3701.46 2575.5,-3701.46"/>
<polygon fill="black" stroke="black" points="2579,-3701.46 2575.5,-3691.46 2572,-3701.46 2579,-3701.46"/>
</g>
<!-- layer2_attn_out_proj_1 -->
<g id="node162" class="node">
<title>layer2_attn_out_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="3352.5,-3691.17 2857.5,-3691.17 2857.5,-3608.17 3352.5,-3608.17 3352.5,-3691.17"/>
<text text-anchor="middle" x="3105" y="-3675.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="3105" y="-3660.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3105" y="-3645.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3105" y="-3630.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="3105" y="-3615.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_attention_1&#45;&gt;layer2_attn_out_proj_1 -->
<g id="edge198" class="edge">
<title>layer2_attention_1&#45;&gt;layer2_attn_out_proj_1</title>
<path fill="none" stroke="black" d="M3101,-3727.05C3101,-3727.05 3101,-3701.46 3101,-3701.46"/>
<polygon fill="black" stroke="black" points="3104.5,-3701.46 3101,-3691.46 3097.5,-3701.46 3104.5,-3701.46"/>
</g>
<!-- layer2_attn_out_proj_2 -->
<g id="node163" class="node">
<title>layer2_attn_out_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="3879.5,-3691.17 3384.5,-3691.17 3384.5,-3608.17 3879.5,-3608.17 3879.5,-3691.17"/>
<text text-anchor="middle" x="3632" y="-3675.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="3632" y="-3660.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3632" y="-3645.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3632" y="-3630.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="3632" y="-3615.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_attention_2&#45;&gt;layer2_attn_out_proj_2 -->
<g id="edge202" class="edge">
<title>layer2_attention_2&#45;&gt;layer2_attn_out_proj_2</title>
<path fill="none" stroke="black" d="M3627,-3727.05C3627,-3727.05 3627,-3701.46 3627,-3701.46"/>
<polygon fill="black" stroke="black" points="3630.5,-3701.46 3627,-3691.46 3623.5,-3701.46 3630.5,-3701.46"/>
</g>
<!-- layer2_attn_out_proj_3 -->
<g id="node164" class="node">
<title>layer2_attn_out_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="4398.5,-3691.17 3903.5,-3691.17 3903.5,-3608.17 4398.5,-3608.17 4398.5,-3691.17"/>
<text text-anchor="middle" x="4151" y="-3675.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="4151" y="-3660.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4151" y="-3645.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4151" y="-3630.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="4151" y="-3615.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_attention_3&#45;&gt;layer2_attn_out_proj_3 -->
<g id="edge206" class="edge">
<title>layer2_attention_3&#45;&gt;layer2_attn_out_proj_3</title>
<path fill="none" stroke="black" d="M4149,-3727.05C4149,-3727.05 4149,-3701.46 4149,-3701.46"/>
<polygon fill="black" stroke="black" points="4152.5,-3701.46 4149,-3691.46 4145.5,-3701.46 4152.5,-3701.46"/>
</g>
<!-- layer2_attn_out_proj_4 -->
<g id="node165" class="node">
<title>layer2_attn_out_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="4922.5,-3691.17 4427.5,-3691.17 4427.5,-3608.17 4922.5,-3608.17 4922.5,-3691.17"/>
<text text-anchor="middle" x="4675" y="-3675.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="4675" y="-3660.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4675" y="-3645.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4675" y="-3630.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="4675" y="-3615.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_attention_4&#45;&gt;layer2_attn_out_proj_4 -->
<g id="edge210" class="edge">
<title>layer2_attention_4&#45;&gt;layer2_attn_out_proj_4</title>
<path fill="none" stroke="black" d="M4673.5,-3727.05C4673.5,-3727.05 4673.5,-3701.46 4673.5,-3701.46"/>
<polygon fill="black" stroke="black" points="4677,-3701.46 4673.5,-3691.46 4670,-3701.46 4677,-3701.46"/>
</g>
<!-- layer2_attn_out_proj_5 -->
<g id="node166" class="node">
<title>layer2_attn_out_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="5444.5,-3691.17 4949.5,-3691.17 4949.5,-3608.17 5444.5,-3608.17 5444.5,-3691.17"/>
<text text-anchor="middle" x="5197" y="-3675.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="5197" y="-3660.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="5197" y="-3645.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5197" y="-3630.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="5197" y="-3615.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_attention_5&#45;&gt;layer2_attn_out_proj_5 -->
<g id="edge214" class="edge">
<title>layer2_attention_5&#45;&gt;layer2_attn_out_proj_5</title>
<path fill="none" stroke="black" d="M5197,-3727.05C5197,-3727.05 5197,-3701.46 5197,-3701.46"/>
<polygon fill="black" stroke="black" points="5200.5,-3701.46 5197,-3691.46 5193.5,-3701.46 5200.5,-3701.46"/>
</g>
<!-- layer2_attn_out_proj_6 -->
<g id="node167" class="node">
<title>layer2_attn_out_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="5963.5,-3691.17 5468.5,-3691.17 5468.5,-3608.17 5963.5,-3608.17 5963.5,-3691.17"/>
<text text-anchor="middle" x="5716" y="-3675.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="5716" y="-3660.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="5716" y="-3645.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5716" y="-3630.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="5716" y="-3615.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_attention_6&#45;&gt;layer2_attn_out_proj_6 -->
<g id="edge218" class="edge">
<title>layer2_attention_6&#45;&gt;layer2_attn_out_proj_6</title>
<path fill="none" stroke="black" d="M5716,-3727.05C5716,-3727.05 5716,-3701.46 5716,-3701.46"/>
<polygon fill="black" stroke="black" points="5719.5,-3701.46 5716,-3691.46 5712.5,-3701.46 5719.5,-3701.46"/>
</g>
<!-- layer2_attn_out_proj_7 -->
<g id="node168" class="node">
<title>layer2_attn_out_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="6482.5,-3691.17 5987.5,-3691.17 5987.5,-3608.17 6482.5,-3608.17 6482.5,-3691.17"/>
<text text-anchor="middle" x="6235" y="-3675.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="6235" y="-3660.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="6235" y="-3645.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="6235" y="-3630.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="6235" y="-3615.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_attention_7&#45;&gt;layer2_attn_out_proj_7 -->
<g id="edge222" class="edge">
<title>layer2_attention_7&#45;&gt;layer2_attn_out_proj_7</title>
<path fill="none" stroke="black" d="M6235,-3727.05C6235,-3727.05 6235,-3701.46 6235,-3701.46"/>
<polygon fill="black" stroke="black" points="6238.5,-3701.46 6235,-3691.46 6231.5,-3701.46 6238.5,-3701.46"/>
</g>
<!-- layer2_attn_out_proj_8 -->
<g id="node169" class="node">
<title>layer2_attn_out_proj_8</title>
<polygon fill="lightcoral" stroke="black" points="7004.5,-3691.17 6509.5,-3691.17 6509.5,-3608.17 7004.5,-3608.17 7004.5,-3691.17"/>
<text text-anchor="middle" x="6757" y="-3675.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="6757" y="-3660.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="6757" y="-3645.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6757" y="-3630.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=256]</text>
<text text-anchor="middle" x="6757" y="-3615.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_attention_8&#45;&gt;layer2_attn_out_proj_8 -->
<g id="edge226" class="edge">
<title>layer2_attention_8&#45;&gt;layer2_attn_out_proj_8</title>
<path fill="none" stroke="black" d="M6758.5,-3727.05C6758.5,-3727.05 6758.5,-3701.46 6758.5,-3701.46"/>
<polygon fill="black" stroke="black" points="6762,-3701.46 6758.5,-3691.46 6755,-3701.46 6762,-3701.46"/>
</g>
<!-- layer2_attn_out_proj_9 -->
<g id="node170" class="node">
<title>layer2_attn_out_proj_9</title>
<polygon fill="lightcoral" stroke="black" points="7528.5,-3691.17 7033.5,-3691.17 7033.5,-3608.17 7528.5,-3608.17 7528.5,-3691.17"/>
<text text-anchor="middle" x="7281" y="-3675.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="7281" y="-3660.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="7281" y="-3645.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7281" y="-3630.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=256]</text>
<text text-anchor="middle" x="7281" y="-3615.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_attention_9&#45;&gt;layer2_attn_out_proj_9 -->
<g id="edge230" class="edge">
<title>layer2_attention_9&#45;&gt;layer2_attn_out_proj_9</title>
<path fill="none" stroke="black" d="M7283,-3727.05C7283,-3727.05 7283,-3701.46 7283,-3701.46"/>
<polygon fill="black" stroke="black" points="7286.5,-3701.46 7283,-3691.46 7279.5,-3701.46 7286.5,-3701.46"/>
</g>
<!-- layer2_attn_out_proj_10 -->
<g id="node171" class="node">
<title>layer2_attn_out_proj_10</title>
<polygon fill="lightcoral" stroke="black" points="8052.5,-3691.17 7557.5,-3691.17 7557.5,-3608.17 8052.5,-3608.17 8052.5,-3691.17"/>
<text text-anchor="middle" x="7805" y="-3675.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="7805" y="-3660.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="7805" y="-3645.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7805" y="-3630.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=256]</text>
<text text-anchor="middle" x="7805" y="-3615.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_attention_10&#45;&gt;layer2_attn_out_proj_10 -->
<g id="edge234" class="edge">
<title>layer2_attention_10&#45;&gt;layer2_attn_out_proj_10</title>
<path fill="none" stroke="black" d="M7807.5,-3727.05C7807.5,-3727.05 7807.5,-3701.46 7807.5,-3701.46"/>
<polygon fill="black" stroke="black" points="7811,-3701.46 7807.5,-3691.46 7804,-3701.46 7811,-3701.46"/>
</g>
<!-- layer2_attn_out_proj_11 -->
<g id="node172" class="node">
<title>layer2_attn_out_proj_11</title>
<polygon fill="lightcoral" stroke="black" points="8577.5,-3691.17 8082.5,-3691.17 8082.5,-3608.17 8577.5,-3608.17 8577.5,-3691.17"/>
<text text-anchor="middle" x="8330" y="-3675.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="8330" y="-3660.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="8330" y="-3645.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="8330" y="-3630.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=256]</text>
<text text-anchor="middle" x="8330" y="-3615.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_attention_11&#45;&gt;layer2_attn_out_proj_11 -->
<g id="edge238" class="edge">
<title>layer2_attention_11&#45;&gt;layer2_attn_out_proj_11</title>
<path fill="none" stroke="black" d="M8332.5,-3727.05C8332.5,-3727.05 8332.5,-3701.46 8332.5,-3701.46"/>
<polygon fill="black" stroke="black" points="8336,-3701.46 8332.5,-3691.46 8329,-3701.46 8336,-3701.46"/>
</g>
<!-- layer2_attn_allreduce -->
<g id="node173" class="node">
<title>layer2_attn_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="6190.67,-3572.17 5435.58,-3572.17 5241.33,-3436.17 5996.42,-3436.17 6190.67,-3572.17"/>
<text text-anchor="middle" x="5716" y="-3522.97" font-family="Times,serif" font-size="14.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="5716" y="-3507.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5716" y="-3492.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5716" y="-3477.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer2_attn_out_proj_0&#45;&gt;layer2_attn_allreduce -->
<g id="edge195" class="edge">
<title>layer2_attn_out_proj_0&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M2807.3,-3608.08C2807.3,-3551.71 2807.3,-3458 2807.3,-3458 2807.3,-3458 5262.25,-3458 5262.25,-3458"/>
<polygon fill="black" stroke="black" points="5262.25,-3461.5 5272.25,-3458 5262.25,-3454.5 5262.25,-3461.5"/>
</g>
<!-- layer2_attn_out_proj_1&#45;&gt;layer2_attn_allreduce -->
<g id="edge199" class="edge">
<title>layer2_attn_out_proj_1&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M3196,-3607.97C3196,-3558.03 3196,-3481 3196,-3481 3196,-3481 5295.16,-3481 5295.16,-3481"/>
<polygon fill="black" stroke="black" points="5295.16,-3484.5 5305.16,-3481 5295.16,-3477.5 5295.16,-3484.5"/>
</g>
<!-- layer2_attn_out_proj_2&#45;&gt;layer2_attn_allreduce -->
<g id="edge203" class="edge">
<title>layer2_attn_out_proj_2&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M3817.7,-3607.92C3817.7,-3564.88 3817.7,-3504 3817.7,-3504 3817.7,-3504 5328.12,-3504 5328.12,-3504"/>
<polygon fill="black" stroke="black" points="5328.12,-3507.5 5338.12,-3504 5328.12,-3500.5 5328.12,-3507.5"/>
</g>
<!-- layer2_attn_out_proj_3&#45;&gt;layer2_attn_allreduce -->
<g id="edge207" class="edge">
<title>layer2_attn_out_proj_3&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M4151,-3608.14C4151,-3572.22 4151,-3526 4151,-3526 4151,-3526 5359.16,-3526 5359.16,-3526"/>
<polygon fill="black" stroke="black" points="5359.16,-3529.5 5369.16,-3526 5359.16,-3522.5 5359.16,-3529.5"/>
</g>
<!-- layer2_attn_out_proj_4&#45;&gt;layer2_attn_allreduce -->
<g id="edge211" class="edge">
<title>layer2_attn_out_proj_4&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M4821.3,-3608.14C4821.3,-3580.41 4821.3,-3549 4821.3,-3549 4821.3,-3549 5392.45,-3549 5392.45,-3549"/>
<polygon fill="black" stroke="black" points="5392.45,-3552.5 5402.45,-3549 5392.45,-3545.5 5392.45,-3552.5"/>
</g>
<!-- layer2_attn_out_proj_5&#45;&gt;layer2_attn_allreduce -->
<g id="edge215" class="edge">
<title>layer2_attn_out_proj_5&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M5342.83,-3607.97C5342.83,-3607.97 5342.83,-3517.56 5342.83,-3517.56"/>
<polygon fill="black" stroke="black" points="5346.33,-3517.56 5342.83,-3507.56 5339.33,-3517.56 5346.33,-3517.56"/>
</g>
<!-- layer2_attn_out_proj_6&#45;&gt;layer2_attn_allreduce -->
<g id="edge219" class="edge">
<title>layer2_attn_out_proj_6&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M5716,-3607.97C5716,-3607.97 5716,-3582.24 5716,-3582.24"/>
<polygon fill="black" stroke="black" points="5719.5,-3582.24 5716,-3572.24 5712.5,-3582.24 5719.5,-3582.24"/>
</g>
<!-- layer2_attn_out_proj_7&#45;&gt;layer2_attn_allreduce -->
<g id="edge223" class="edge">
<title>layer2_attn_out_proj_7&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M6089.17,-3607.97C6089.17,-3607.97 6089.17,-3582.24 6089.17,-3582.24"/>
<polygon fill="black" stroke="black" points="6092.67,-3582.24 6089.17,-3572.24 6085.67,-3582.24 6092.67,-3582.24"/>
</g>
<!-- layer2_attn_out_proj_8&#45;&gt;layer2_attn_allreduce -->
<g id="edge227" class="edge">
<title>layer2_attn_out_proj_8&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M6804.5,-3608.14C6804.5,-3580.41 6804.5,-3549 6804.5,-3549 6804.5,-3549 6167.95,-3549 6167.95,-3549"/>
<polygon fill="black" stroke="black" points="6167.95,-3545.5 6157.95,-3549 6167.95,-3552.5 6167.95,-3545.5"/>
</g>
<!-- layer2_attn_out_proj_9&#45;&gt;layer2_attn_allreduce -->
<g id="edge231" class="edge">
<title>layer2_attn_out_proj_9&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M7085.2,-3608.14C7085.2,-3572.22 7085.2,-3526 7085.2,-3526 7085.2,-3526 6134.95,-3526 6134.95,-3526"/>
<polygon fill="black" stroke="black" points="6134.95,-3522.5 6124.95,-3526 6134.95,-3529.5 6134.95,-3522.5"/>
</g>
<!-- layer2_attn_out_proj_10&#45;&gt;layer2_attn_allreduce -->
<g id="edge235" class="edge">
<title>layer2_attn_out_proj_10&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M7805,-3607.92C7805,-3564.88 7805,-3504 7805,-3504 7805,-3504 6103.39,-3504 6103.39,-3504"/>
<polygon fill="black" stroke="black" points="6103.39,-3500.5 6093.39,-3504 6103.39,-3507.5 6103.39,-3500.5"/>
</g>
<!-- layer2_attn_out_proj_11&#45;&gt;layer2_attn_allreduce -->
<g id="edge239" class="edge">
<title>layer2_attn_out_proj_11&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M8184.25,-3607.97C8184.25,-3558.03 8184.25,-3481 8184.25,-3481 8184.25,-3481 6070.5,-3481 6070.5,-3481"/>
<polygon fill="black" stroke="black" points="6070.5,-3477.5 6060.5,-3481 6070.5,-3484.5 6070.5,-3477.5"/>
</g>
<!-- layer2_attn_allreduce&#45;&gt;layer2_residual1 -->
<g id="edge240" class="edge">
<title>layer2_attn_allreduce&#45;&gt;layer2_residual1</title>
<path fill="none" stroke="black" d="M6027.62,-3458C6526.58,-3458 7449.25,-3458 7449.25,-3458 7449.25,-3458 7449.25,-3341.71 7449.25,-3341.71"/>
<polygon fill="black" stroke="black" points="7452.75,-3341.71 7449.25,-3331.71 7445.75,-3341.71 7452.75,-3341.71"/>
</g>
<!-- layer2_ln2 -->
<g id="node175" class="node">
<title>layer2_ln2</title>
<polygon fill="lightgreen" stroke="black" points="6952,-3198.17 6494,-3198.17 6494,-3130.17 6952,-3130.17 6952,-3198.17"/>
<text text-anchor="middle" x="6723" y="-3182.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6723" y="-3167.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6723" y="-3152.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6723" y="-3137.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer2_residual1&#45;&gt;layer2_ln2 -->
<g id="edge242" class="edge">
<title>layer2_residual1&#45;&gt;layer2_ln2</title>
<path fill="none" stroke="black" d="M7370.65,-3317C7042.13,-3317 6657,-3317 6657,-3317 6657,-3317 6657,-3208.47 6657,-3208.47"/>
<polygon fill="black" stroke="black" points="6660.5,-3208.47 6657,-3198.47 6653.5,-3208.47 6660.5,-3208.47"/>
</g>
<!-- layer2_residual2 -->
<g id="node202" class="node">
<title>layer2_residual2</title>
<polygon fill="lightpink" stroke="black" points="7034,-2272.17 6576,-2189.17 7034,-2106.17 7492,-2189.17 7034,-2272.17"/>
<text text-anchor="middle" x="7034" y="-2215.47" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7034" y="-2200.47" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7034" y="-2185.47" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7034" y="-2170.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7034" y="-2155.47" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer2_residual1&#45;&gt;layer2_residual2 -->
<g id="edge285" class="edge">
<title>layer2_residual1&#45;&gt;layer2_residual2</title>
<path fill="none" stroke="black" d="M7735.55,-3250.84C7735.55,-3190.9 7735.55,-3112 7735.55,-3112 7735.55,-3112 6894.5,-3112 6894.5,-3112 6894.5,-3112 6894.5,-2256.89 6894.5,-2256.89"/>
<polygon fill="black" stroke="black" points="6898,-2256.89 6894.5,-2246.89 6891,-2256.89 6898,-2256.89"/>
</g>
<!-- layer2_gate -->
<g id="node176" class="node">
<title>layer2_gate</title>
<polygon fill="lightblue" stroke="black" points="6395.58,-3094.17 5653.36,-3094.17 5462.42,-2958.17 6204.64,-2958.17 6395.58,-3094.17"/>
<text text-anchor="middle" x="5929" y="-3044.97" font-family="Times,serif" font-size="14.00">Gate Computation</text>
<text text-anchor="middle" x="5929" y="-3029.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5929" y="-3014.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="5929" y="-2999.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer2_ln2&#45;&gt;layer2_gate -->
<g id="edge243" class="edge">
<title>layer2_ln2&#45;&gt;layer2_gate</title>
<path fill="none" stroke="black" d="M6493.94,-3164C6391.4,-3164 6293.19,-3164 6293.19,-3164 6293.19,-3164 6293.19,-3104.28 6293.19,-3104.28"/>
<polygon fill="black" stroke="black" points="6296.69,-3104.28 6293.19,-3094.28 6289.69,-3104.28 6296.69,-3104.28"/>
</g>
<!-- layer2_route_0 -->
<g id="node177" class="node">
<title>layer2_route_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2788.18,-2922.17 2021.14,-2922.17 1823.82,-2756.17 2590.86,-2756.17 2788.18,-2922.17"/>
<text text-anchor="middle" x="2306" y="-2865.47" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="2306" y="-2850.47" font-family="Times,serif" font-size="14.00">Experts=[0&#45;3]</text>
<text text-anchor="middle" x="2306" y="-2835.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2306" y="-2820.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="2306" y="-2805.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_0 -->
<g id="edge244" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5588.18,-3048C4732.17,-3048 2559.8,-3048 2559.8,-3048 2559.8,-3048 2559.8,-2932.3 2559.8,-2932.3"/>
<polygon fill="black" stroke="black" points="2563.3,-2932.3 2559.8,-2922.3 2556.3,-2932.3 2563.3,-2932.3"/>
</g>
<!-- layer2_route_1 -->
<g id="node183" class="node">
<title>layer2_route_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4720.18,-2922.17 3953.14,-2922.17 3755.82,-2756.17 4522.86,-2756.17 4720.18,-2922.17"/>
<text text-anchor="middle" x="4238" y="-2865.47" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="4238" y="-2850.47" font-family="Times,serif" font-size="14.00">Experts=[4&#45;7]</text>
<text text-anchor="middle" x="4238" y="-2835.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4238" y="-2820.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="4238" y="-2805.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_1 -->
<g id="edge253" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5525.15,-3003C5125.74,-3003 4573.8,-3003 4573.8,-3003 4573.8,-3003 4573.8,-2932.52 4573.8,-2932.52"/>
<polygon fill="black" stroke="black" points="4577.3,-2932.52 4573.8,-2922.52 4570.3,-2932.52 4577.3,-2932.52"/>
</g>
<!-- layer2_route_2 -->
<g id="node189" class="node">
<title>layer2_route_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6411.18,-2922.17 5644.14,-2922.17 5446.82,-2756.17 6213.86,-2756.17 6411.18,-2922.17"/>
<text text-anchor="middle" x="5929" y="-2865.47" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="5929" y="-2850.47" font-family="Times,serif" font-size="14.00">Experts=[8&#45;11]</text>
<text text-anchor="middle" x="5929" y="-2835.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5929" y="-2820.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="5929" y="-2805.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_2 -->
<g id="edge262" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5929,-2958.13C5929,-2958.13 5929,-2932.45 5929,-2932.45"/>
<polygon fill="black" stroke="black" points="5932.5,-2932.45 5929,-2922.45 5925.5,-2932.45 5932.5,-2932.45"/>
</g>
<!-- layer2_route_3 -->
<g id="node195" class="node">
<title>layer2_route_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8101.18,-2922.17 7334.14,-2922.17 7136.82,-2756.17 7903.86,-2756.17 8101.18,-2922.17"/>
<text text-anchor="middle" x="7619" y="-2865.47" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="7619" y="-2850.47" font-family="Times,serif" font-size="14.00">Experts=[12&#45;15]</text>
<text text-anchor="middle" x="7619" y="-2835.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7619" y="-2820.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="7619" y="-2805.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_3 -->
<g id="edge271" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6300.14,-3026C6691.94,-3026 7253.45,-3026 7253.45,-3026 7253.45,-3026 7253.45,-2864.46 7253.45,-2864.46"/>
<polygon fill="black" stroke="black" points="7256.95,-2864.46 7253.45,-2854.46 7249.95,-2864.46 7256.95,-2864.46"/>
</g>
<!-- layer2_expert_0 -->
<g id="node178" class="node">
<title>layer2_expert_0</title>
<polygon fill="lightsteelblue" stroke="black" points="1572.5,-2720.17 1107.5,-2720.17 1107.5,-2652.17 1572.5,-2652.17 1572.5,-2720.17"/>
<text text-anchor="middle" x="1340" y="-2704.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1340" y="-2689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1340" y="-2674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="1340" y="-2659.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_route_0&#45;&gt;layer2_expert_0 -->
<g id="edge245" class="edge">
<title>layer2_route_0&#45;&gt;layer2_expert_0</title>
<path fill="none" stroke="black" d="M1922.13,-2839C1652.59,-2839 1340,-2839 1340,-2839 1340,-2839 1340,-2730.47 1340,-2730.47"/>
<polygon fill="black" stroke="black" points="1343.5,-2730.47 1340,-2720.47 1336.5,-2730.47 1343.5,-2730.47"/>
</g>
<!-- layer2_expert_1 -->
<g id="node179" class="node">
<title>layer2_expert_1</title>
<polygon fill="lightsteelblue" stroke="black" points="2055.5,-2720.17 1590.5,-2720.17 1590.5,-2652.17 2055.5,-2652.17 2055.5,-2720.17"/>
<text text-anchor="middle" x="1823" y="-2704.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1823" y="-2689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1823" y="-2674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="1823" y="-2659.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_route_0&#45;&gt;layer2_expert_1 -->
<g id="edge247" class="edge">
<title>layer2_route_0&#45;&gt;layer2_expert_1</title>
<path fill="none" stroke="black" d="M1939.7,-2755.95C1939.7,-2755.95 1939.7,-2730.23 1939.7,-2730.23"/>
<polygon fill="black" stroke="black" points="1943.2,-2730.23 1939.7,-2720.23 1936.2,-2730.23 1943.2,-2730.23"/>
</g>
<!-- layer2_expert_2 -->
<g id="node180" class="node">
<title>layer2_expert_2</title>
<polygon fill="lightsteelblue" stroke="black" points="2538.5,-2720.17 2073.5,-2720.17 2073.5,-2652.17 2538.5,-2652.17 2538.5,-2720.17"/>
<text text-anchor="middle" x="2306" y="-2704.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2306" y="-2689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2306" y="-2674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="2306" y="-2659.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_route_0&#45;&gt;layer2_expert_2 -->
<g id="edge249" class="edge">
<title>layer2_route_0&#45;&gt;layer2_expert_2</title>
<path fill="none" stroke="black" d="M2306,-2755.95C2306,-2755.95 2306,-2730.23 2306,-2730.23"/>
<polygon fill="black" stroke="black" points="2309.5,-2730.23 2306,-2720.23 2302.5,-2730.23 2309.5,-2730.23"/>
</g>
<!-- layer2_expert_3 -->
<g id="node181" class="node">
<title>layer2_expert_3</title>
<polygon fill="lightsteelblue" stroke="black" points="3021.5,-2720.17 2556.5,-2720.17 2556.5,-2652.17 3021.5,-2652.17 3021.5,-2720.17"/>
<text text-anchor="middle" x="2789" y="-2704.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2789" y="-2689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2789" y="-2674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="2789" y="-2659.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_route_0&#45;&gt;layer2_expert_3 -->
<g id="edge251" class="edge">
<title>layer2_route_0&#45;&gt;layer2_expert_3</title>
<path fill="none" stroke="black" d="M2672.3,-2824.5C2672.3,-2824.5 2672.3,-2730.45 2672.3,-2730.45"/>
<polygon fill="black" stroke="black" points="2675.8,-2730.45 2672.3,-2720.45 2668.8,-2730.45 2675.8,-2730.45"/>
</g>
<!-- layer2_expert_agg_0 -->
<g id="node182" class="node">
<title>layer2_expert_agg_0</title>
<polygon fill="lightyellow" stroke="black" points="2780.67,-2616.17 2025.58,-2616.17 1831.33,-2480.17 2586.42,-2480.17 2780.67,-2616.17"/>
<text text-anchor="middle" x="2306" y="-2566.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2306" y="-2551.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="2306" y="-2536.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2306" y="-2521.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_expert_0&#45;&gt;layer2_expert_agg_0 -->
<g id="edge246" class="edge">
<title>layer2_expert_0&#45;&gt;layer2_expert_agg_0</title>
<path fill="none" stroke="black" d="M1340,-2652.01C1340,-2611.1 1340,-2548 1340,-2548 1340,-2548 1918.02,-2548 1918.02,-2548"/>
<polygon fill="black" stroke="black" points="1918.02,-2551.5 1928.02,-2548 1918.02,-2544.5 1918.02,-2551.5"/>
</g>
<!-- layer2_expert_1&#45;&gt;layer2_expert_agg_0 -->
<g id="edge248" class="edge">
<title>layer2_expert_1&#45;&gt;layer2_expert_agg_0</title>
<path fill="none" stroke="black" d="M1943.33,-2652.05C1943.33,-2652.05 1943.33,-2568.65 1943.33,-2568.65"/>
<polygon fill="black" stroke="black" points="1946.83,-2568.65 1943.33,-2558.65 1939.83,-2568.65 1946.83,-2568.65"/>
</g>
<!-- layer2_expert_2&#45;&gt;layer2_expert_agg_0 -->
<g id="edge250" class="edge">
<title>layer2_expert_2&#45;&gt;layer2_expert_agg_0</title>
<path fill="none" stroke="black" d="M2306,-2652.05C2306,-2652.05 2306,-2626.4 2306,-2626.4"/>
<polygon fill="black" stroke="black" points="2309.5,-2626.4 2306,-2616.4 2302.5,-2626.4 2309.5,-2626.4"/>
</g>
<!-- layer2_expert_3&#45;&gt;layer2_expert_agg_0 -->
<g id="edge252" class="edge">
<title>layer2_expert_3&#45;&gt;layer2_expert_agg_0</title>
<path fill="none" stroke="black" d="M2668.67,-2652.05C2668.67,-2652.05 2668.67,-2626.4 2668.67,-2626.4"/>
<polygon fill="black" stroke="black" points="2672.17,-2626.4 2668.67,-2616.4 2665.17,-2626.4 2672.17,-2626.4"/>
</g>
<!-- layer2_expert_allreduce -->
<g id="node201" class="node">
<title>layer2_expert_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="6403.67,-2444.17 5648.58,-2444.17 5454.33,-2308.17 6209.42,-2308.17 6403.67,-2444.17"/>
<text text-anchor="middle" x="5929" y="-2394.97" font-family="Times,serif" font-size="14.00">MoE All&#45;Reduce</text>
<text text-anchor="middle" x="5929" y="-2379.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5929" y="-2364.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5929" y="-2349.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer2_expert_agg_0&#45;&gt;layer2_expert_allreduce -->
<g id="edge280" class="edge">
<title>layer2_expert_agg_0&#45;&gt;layer2_expert_allreduce</title>
<path fill="none" stroke="black" d="M2306,-2479.91C2306,-2423.63 2306,-2353 2306,-2353 2306,-2353 5508.24,-2353 5508.24,-2353"/>
<polygon fill="black" stroke="black" points="5508.24,-2356.5 5518.24,-2353 5508.24,-2349.5 5508.24,-2356.5"/>
</g>
<!-- layer2_expert_4 -->
<g id="node184" class="node">
<title>layer2_expert_4</title>
<polygon fill="lightsteelblue" stroke="black" points="3504.5,-2720.17 3039.5,-2720.17 3039.5,-2652.17 3504.5,-2652.17 3504.5,-2720.17"/>
<text text-anchor="middle" x="3272" y="-2704.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3272" y="-2689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3272" y="-2674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="3272" y="-2659.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_route_1&#45;&gt;layer2_expert_4 -->
<g id="edge254" class="edge">
<title>layer2_route_1&#45;&gt;layer2_expert_4</title>
<path fill="none" stroke="black" d="M3854.03,-2839C3651.49,-2839 3444.5,-2839 3444.5,-2839 3444.5,-2839 3444.5,-2730.47 3444.5,-2730.47"/>
<polygon fill="black" stroke="black" points="3448,-2730.47 3444.5,-2720.47 3441,-2730.47 3448,-2730.47"/>
</g>
<!-- layer2_expert_5 -->
<g id="node185" class="node">
<title>layer2_expert_5</title>
<polygon fill="lightsteelblue" stroke="black" points="3987.5,-2720.17 3522.5,-2720.17 3522.5,-2652.17 3987.5,-2652.17 3987.5,-2720.17"/>
<text text-anchor="middle" x="3755" y="-2704.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3755" y="-2689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3755" y="-2674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="3755" y="-2659.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_route_1&#45;&gt;layer2_expert_5 -->
<g id="edge256" class="edge">
<title>layer2_route_1&#45;&gt;layer2_expert_5</title>
<path fill="none" stroke="black" d="M3871.7,-2755.95C3871.7,-2755.95 3871.7,-2730.23 3871.7,-2730.23"/>
<polygon fill="black" stroke="black" points="3875.2,-2730.23 3871.7,-2720.23 3868.2,-2730.23 3875.2,-2730.23"/>
</g>
<!-- layer2_expert_6 -->
<g id="node186" class="node">
<title>layer2_expert_6</title>
<polygon fill="lightsteelblue" stroke="black" points="4470.5,-2720.17 4005.5,-2720.17 4005.5,-2652.17 4470.5,-2652.17 4470.5,-2720.17"/>
<text text-anchor="middle" x="4238" y="-2704.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="4238" y="-2689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4238" y="-2674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="4238" y="-2659.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_route_1&#45;&gt;layer2_expert_6 -->
<g id="edge258" class="edge">
<title>layer2_route_1&#45;&gt;layer2_expert_6</title>
<path fill="none" stroke="black" d="M4238,-2755.95C4238,-2755.95 4238,-2730.23 4238,-2730.23"/>
<polygon fill="black" stroke="black" points="4241.5,-2730.23 4238,-2720.23 4234.5,-2730.23 4241.5,-2730.23"/>
</g>
<!-- layer2_expert_7 -->
<g id="node187" class="node">
<title>layer2_expert_7</title>
<polygon fill="lightsteelblue" stroke="black" points="4953.5,-2720.17 4488.5,-2720.17 4488.5,-2652.17 4953.5,-2652.17 4953.5,-2720.17"/>
<text text-anchor="middle" x="4721" y="-2704.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="4721" y="-2689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4721" y="-2674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="4721" y="-2659.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_route_1&#45;&gt;layer2_expert_7 -->
<g id="edge260" class="edge">
<title>layer2_route_1&#45;&gt;layer2_expert_7</title>
<path fill="none" stroke="black" d="M4604.3,-2824.5C4604.3,-2824.5 4604.3,-2730.45 4604.3,-2730.45"/>
<polygon fill="black" stroke="black" points="4607.8,-2730.45 4604.3,-2720.45 4600.8,-2730.45 4607.8,-2730.45"/>
</g>
<!-- layer2_expert_agg_1 -->
<g id="node188" class="node">
<title>layer2_expert_agg_1</title>
<polygon fill="lightyellow" stroke="black" points="4712.67,-2616.17 3957.58,-2616.17 3763.33,-2480.17 4518.42,-2480.17 4712.67,-2616.17"/>
<text text-anchor="middle" x="4238" y="-2566.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4238" y="-2551.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="4238" y="-2536.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4238" y="-2521.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_expert_4&#45;&gt;layer2_expert_agg_1 -->
<g id="edge255" class="edge">
<title>layer2_expert_4&#45;&gt;layer2_expert_agg_1</title>
<path fill="none" stroke="black" d="M3394.5,-2652.01C3394.5,-2611.1 3394.5,-2548 3394.5,-2548 3394.5,-2548 3850.04,-2548 3850.04,-2548"/>
<polygon fill="black" stroke="black" points="3850.04,-2551.5 3860.04,-2548 3850.04,-2544.5 3850.04,-2551.5"/>
</g>
<!-- layer2_expert_5&#45;&gt;layer2_expert_agg_1 -->
<g id="edge257" class="edge">
<title>layer2_expert_5&#45;&gt;layer2_expert_agg_1</title>
<path fill="none" stroke="black" d="M3875.33,-2652.05C3875.33,-2652.05 3875.33,-2568.65 3875.33,-2568.65"/>
<polygon fill="black" stroke="black" points="3878.83,-2568.65 3875.33,-2558.65 3871.83,-2568.65 3878.83,-2568.65"/>
</g>
<!-- layer2_expert_6&#45;&gt;layer2_expert_agg_1 -->
<g id="edge259" class="edge">
<title>layer2_expert_6&#45;&gt;layer2_expert_agg_1</title>
<path fill="none" stroke="black" d="M4238,-2652.05C4238,-2652.05 4238,-2626.4 4238,-2626.4"/>
<polygon fill="black" stroke="black" points="4241.5,-2626.4 4238,-2616.4 4234.5,-2626.4 4241.5,-2626.4"/>
</g>
<!-- layer2_expert_7&#45;&gt;layer2_expert_agg_1 -->
<g id="edge261" class="edge">
<title>layer2_expert_7&#45;&gt;layer2_expert_agg_1</title>
<path fill="none" stroke="black" d="M4600.67,-2652.05C4600.67,-2652.05 4600.67,-2626.4 4600.67,-2626.4"/>
<polygon fill="black" stroke="black" points="4604.17,-2626.4 4600.67,-2616.4 4597.17,-2626.4 4604.17,-2626.4"/>
</g>
<!-- layer2_expert_agg_1&#45;&gt;layer2_expert_allreduce -->
<g id="edge281" class="edge">
<title>layer2_expert_agg_1&#45;&gt;layer2_expert_allreduce</title>
<path fill="none" stroke="black" d="M4644.17,-2548.06C4644.17,-2543.51 4644.17,-2398 4644.17,-2398 4644.17,-2398 5572.58,-2398 5572.58,-2398"/>
<polygon fill="black" stroke="black" points="5572.58,-2401.5 5582.58,-2398 5572.58,-2394.5 5572.58,-2401.5"/>
</g>
<!-- layer2_expert_8 -->
<g id="node190" class="node">
<title>layer2_expert_8</title>
<polygon fill="lightsteelblue" stroke="black" points="5436.5,-2720.17 4971.5,-2720.17 4971.5,-2652.17 5436.5,-2652.17 5436.5,-2720.17"/>
<text text-anchor="middle" x="5204" y="-2704.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="5204" y="-2689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5204" y="-2674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="5204" y="-2659.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_route_2&#45;&gt;layer2_expert_8 -->
<g id="edge263" class="edge">
<title>layer2_route_2&#45;&gt;layer2_expert_8</title>
<path fill="none" stroke="black" d="M5450.54,-2839.06C5450.54,-2834.42 5450.54,-2686 5450.54,-2686 5450.54,-2686 5446.58,-2686 5446.58,-2686"/>
<polygon fill="black" stroke="black" points="5446.58,-2682.5 5436.58,-2686 5446.58,-2689.5 5446.58,-2682.5"/>
</g>
<!-- layer2_expert_9 -->
<g id="node191" class="node">
<title>layer2_expert_9</title>
<polygon fill="lightsteelblue" stroke="black" points="5919.5,-2720.17 5454.5,-2720.17 5454.5,-2652.17 5919.5,-2652.17 5919.5,-2720.17"/>
<text text-anchor="middle" x="5687" y="-2704.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="5687" y="-2689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5687" y="-2674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="5687" y="-2659.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_route_2&#45;&gt;layer2_expert_9 -->
<g id="edge265" class="edge">
<title>layer2_route_2&#45;&gt;layer2_expert_9</title>
<path fill="none" stroke="black" d="M5687,-2755.95C5687,-2755.95 5687,-2730.23 5687,-2730.23"/>
<polygon fill="black" stroke="black" points="5690.5,-2730.23 5687,-2720.23 5683.5,-2730.23 5690.5,-2730.23"/>
</g>
<!-- layer2_expert_10 -->
<g id="node192" class="node">
<title>layer2_expert_10</title>
<polygon fill="lightsteelblue" stroke="black" points="6402.5,-2720.17 5937.5,-2720.17 5937.5,-2652.17 6402.5,-2652.17 6402.5,-2720.17"/>
<text text-anchor="middle" x="6170" y="-2704.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="6170" y="-2689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6170" y="-2674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="6170" y="-2659.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_route_2&#45;&gt;layer2_expert_10 -->
<g id="edge267" class="edge">
<title>layer2_route_2&#45;&gt;layer2_expert_10</title>
<path fill="none" stroke="black" d="M6170,-2755.95C6170,-2755.95 6170,-2730.23 6170,-2730.23"/>
<polygon fill="black" stroke="black" points="6173.5,-2730.23 6170,-2720.23 6166.5,-2730.23 6173.5,-2730.23"/>
</g>
<!-- layer2_expert_11 -->
<g id="node193" class="node">
<title>layer2_expert_11</title>
<polygon fill="lightsteelblue" stroke="black" points="6885.5,-2720.17 6420.5,-2720.17 6420.5,-2652.17 6885.5,-2652.17 6885.5,-2720.17"/>
<text text-anchor="middle" x="6653" y="-2704.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="6653" y="-2689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6653" y="-2674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="6653" y="-2659.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_route_2&#45;&gt;layer2_expert_11 -->
<g id="edge269" class="edge">
<title>layer2_route_2&#45;&gt;layer2_expert_11</title>
<path fill="none" stroke="black" d="M6407.46,-2839.06C6407.46,-2834.42 6407.46,-2686 6407.46,-2686 6407.46,-2686 6410.32,-2686 6410.32,-2686"/>
<polygon fill="black" stroke="black" points="6410.32,-2689.5 6420.32,-2686 6410.32,-2682.5 6410.32,-2689.5"/>
</g>
<!-- layer2_expert_agg_2 -->
<g id="node194" class="node">
<title>layer2_expert_agg_2</title>
<polygon fill="lightyellow" stroke="black" points="6403.67,-2616.17 5648.58,-2616.17 5454.33,-2480.17 6209.42,-2480.17 6403.67,-2616.17"/>
<text text-anchor="middle" x="5929" y="-2566.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5929" y="-2551.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="5929" y="-2536.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5929" y="-2521.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_expert_8&#45;&gt;layer2_expert_agg_2 -->
<g id="edge264" class="edge">
<title>layer2_expert_8&#45;&gt;layer2_expert_agg_2</title>
<path fill="none" stroke="black" d="M5268.5,-2652.01C5268.5,-2611.1 5268.5,-2548 5268.5,-2548 5268.5,-2548 5541.01,-2548 5541.01,-2548"/>
<polygon fill="black" stroke="black" points="5541.01,-2551.5 5551.01,-2548 5541.01,-2544.5 5541.01,-2551.5"/>
</g>
<!-- layer2_expert_9&#45;&gt;layer2_expert_agg_2 -->
<g id="edge266" class="edge">
<title>layer2_expert_9&#45;&gt;layer2_expert_agg_2</title>
<path fill="none" stroke="black" d="M5687,-2652.05C5687,-2652.05 5687,-2626.4 5687,-2626.4"/>
<polygon fill="black" stroke="black" points="5690.5,-2626.4 5687,-2616.4 5683.5,-2626.4 5690.5,-2626.4"/>
</g>
<!-- layer2_expert_10&#45;&gt;layer2_expert_agg_2 -->
<g id="edge268" class="edge">
<title>layer2_expert_10&#45;&gt;layer2_expert_agg_2</title>
<path fill="none" stroke="black" d="M6170,-2652.05C6170,-2652.05 6170,-2626.4 6170,-2626.4"/>
<polygon fill="black" stroke="black" points="6173.5,-2626.4 6170,-2616.4 6166.5,-2626.4 6173.5,-2626.4"/>
</g>
<!-- layer2_expert_11&#45;&gt;layer2_expert_agg_2 -->
<g id="edge270" class="edge">
<title>layer2_expert_11&#45;&gt;layer2_expert_agg_2</title>
<path fill="none" stroke="black" d="M6498.25,-2652.01C6498.25,-2611.1 6498.25,-2548 6498.25,-2548 6498.25,-2548 6316.32,-2548 6316.32,-2548"/>
<polygon fill="black" stroke="black" points="6316.32,-2544.5 6306.32,-2548 6316.32,-2551.5 6316.32,-2544.5"/>
</g>
<!-- layer2_expert_agg_2&#45;&gt;layer2_expert_allreduce -->
<g id="edge282" class="edge">
<title>layer2_expert_agg_2&#45;&gt;layer2_expert_allreduce</title>
<path fill="none" stroke="black" d="M5929,-2479.69C5929,-2479.69 5929,-2454.4 5929,-2454.4"/>
<polygon fill="black" stroke="black" points="5932.5,-2454.4 5929,-2444.4 5925.5,-2454.4 5932.5,-2454.4"/>
</g>
<!-- layer2_expert_12 -->
<g id="node196" class="node">
<title>layer2_expert_12</title>
<polygon fill="lightsteelblue" stroke="black" points="7368.5,-2720.17 6903.5,-2720.17 6903.5,-2652.17 7368.5,-2652.17 7368.5,-2720.17"/>
<text text-anchor="middle" x="7136" y="-2704.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="7136" y="-2689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7136" y="-2674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="7136" y="-2659.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_route_3&#45;&gt;layer2_expert_12 -->
<g id="edge272" class="edge">
<title>layer2_route_3&#45;&gt;layer2_expert_12</title>
<path fill="none" stroke="black" d="M7252.7,-2755.95C7252.7,-2755.95 7252.7,-2730.23 7252.7,-2730.23"/>
<polygon fill="black" stroke="black" points="7256.2,-2730.23 7252.7,-2720.23 7249.2,-2730.23 7256.2,-2730.23"/>
</g>
<!-- layer2_expert_13 -->
<g id="node197" class="node">
<title>layer2_expert_13</title>
<polygon fill="lightsteelblue" stroke="black" points="7851.5,-2720.17 7386.5,-2720.17 7386.5,-2652.17 7851.5,-2652.17 7851.5,-2720.17"/>
<text text-anchor="middle" x="7619" y="-2704.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="7619" y="-2689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7619" y="-2674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="7619" y="-2659.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_route_3&#45;&gt;layer2_expert_13 -->
<g id="edge274" class="edge">
<title>layer2_route_3&#45;&gt;layer2_expert_13</title>
<path fill="none" stroke="black" d="M7619,-2755.95C7619,-2755.95 7619,-2730.23 7619,-2730.23"/>
<polygon fill="black" stroke="black" points="7622.5,-2730.23 7619,-2720.23 7615.5,-2730.23 7622.5,-2730.23"/>
</g>
<!-- layer2_expert_14 -->
<g id="node198" class="node">
<title>layer2_expert_14</title>
<polygon fill="lightsteelblue" stroke="black" points="8334.5,-2720.17 7869.5,-2720.17 7869.5,-2652.17 8334.5,-2652.17 8334.5,-2720.17"/>
<text text-anchor="middle" x="8102" y="-2704.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="8102" y="-2689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8102" y="-2674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="8102" y="-2659.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_route_3&#45;&gt;layer2_expert_14 -->
<g id="edge276" class="edge">
<title>layer2_route_3&#45;&gt;layer2_expert_14</title>
<path fill="none" stroke="black" d="M7985.3,-2824.5C7985.3,-2824.5 7985.3,-2730.45 7985.3,-2730.45"/>
<polygon fill="black" stroke="black" points="7988.8,-2730.45 7985.3,-2720.45 7981.8,-2730.45 7988.8,-2730.45"/>
</g>
<!-- layer2_expert_15 -->
<g id="node199" class="node">
<title>layer2_expert_15</title>
<polygon fill="lightsteelblue" stroke="black" points="8817.5,-2720.17 8352.5,-2720.17 8352.5,-2652.17 8817.5,-2652.17 8817.5,-2720.17"/>
<text text-anchor="middle" x="8585" y="-2704.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="8585" y="-2689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8585" y="-2674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="8585" y="-2659.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_route_3&#45;&gt;layer2_expert_15 -->
<g id="edge278" class="edge">
<title>layer2_route_3&#45;&gt;layer2_expert_15</title>
<path fill="none" stroke="black" d="M8002.4,-2839C8226.24,-2839 8465,-2839 8465,-2839 8465,-2839 8465,-2730.47 8465,-2730.47"/>
<polygon fill="black" stroke="black" points="8468.5,-2730.47 8465,-2720.47 8461.5,-2730.47 8468.5,-2730.47"/>
</g>
<!-- layer2_expert_agg_3 -->
<g id="node200" class="node">
<title>layer2_expert_agg_3</title>
<polygon fill="lightyellow" stroke="black" points="8093.67,-2616.17 7338.58,-2616.17 7144.33,-2480.17 7899.42,-2480.17 8093.67,-2616.17"/>
<text text-anchor="middle" x="7619" y="-2566.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7619" y="-2551.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="7619" y="-2536.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7619" y="-2521.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_expert_12&#45;&gt;layer2_expert_agg_3 -->
<g id="edge273" class="edge">
<title>layer2_expert_12&#45;&gt;layer2_expert_agg_3</title>
<path fill="none" stroke="black" d="M7256.33,-2652.05C7256.33,-2652.05 7256.33,-2568.65 7256.33,-2568.65"/>
<polygon fill="black" stroke="black" points="7259.83,-2568.65 7256.33,-2558.65 7252.83,-2568.65 7259.83,-2568.65"/>
</g>
<!-- layer2_expert_13&#45;&gt;layer2_expert_agg_3 -->
<g id="edge275" class="edge">
<title>layer2_expert_13&#45;&gt;layer2_expert_agg_3</title>
<path fill="none" stroke="black" d="M7619,-2652.05C7619,-2652.05 7619,-2626.4 7619,-2626.4"/>
<polygon fill="black" stroke="black" points="7622.5,-2626.4 7619,-2616.4 7615.5,-2626.4 7622.5,-2626.4"/>
</g>
<!-- layer2_expert_14&#45;&gt;layer2_expert_agg_3 -->
<g id="edge277" class="edge">
<title>layer2_expert_14&#45;&gt;layer2_expert_agg_3</title>
<path fill="none" stroke="black" d="M7981.67,-2652.05C7981.67,-2652.05 7981.67,-2626.4 7981.67,-2626.4"/>
<polygon fill="black" stroke="black" points="7985.17,-2626.4 7981.67,-2616.4 7978.17,-2626.4 7985.17,-2626.4"/>
</g>
<!-- layer2_expert_15&#45;&gt;layer2_expert_agg_3 -->
<g id="edge279" class="edge">
<title>layer2_expert_15&#45;&gt;layer2_expert_agg_3</title>
<path fill="none" stroke="black" d="M8555,-2652.01C8555,-2611.1 8555,-2548 8555,-2548 8555,-2548 8006.33,-2548 8006.33,-2548"/>
<polygon fill="black" stroke="black" points="8006.34,-2544.5 7996.33,-2548 8006.33,-2551.5 8006.34,-2544.5"/>
</g>
<!-- layer2_expert_agg_3&#45;&gt;layer2_expert_allreduce -->
<g id="edge283" class="edge">
<title>layer2_expert_agg_3&#45;&gt;layer2_expert_allreduce</title>
<path fill="none" stroke="black" d="M7318.08,-2480.12C7318.08,-2432 7318.08,-2376 7318.08,-2376 7318.08,-2376 6316.74,-2376 6316.74,-2376"/>
<polygon fill="black" stroke="black" points="6316.74,-2372.5 6306.74,-2376 6316.74,-2379.5 6316.74,-2372.5"/>
</g>
<!-- layer2_expert_allreduce&#45;&gt;layer2_residual2 -->
<g id="edge284" class="edge">
<title>layer2_expert_allreduce&#45;&gt;layer2_residual2</title>
<path fill="none" stroke="black" d="M6277.17,-2355.42C6277.17,-2306.69 6277.17,-2189 6277.17,-2189 6277.17,-2189 6566.83,-2189 6566.83,-2189"/>
<polygon fill="black" stroke="black" points="6566.83,-2192.5 6576.83,-2189 6566.83,-2185.5 6566.83,-2192.5"/>
</g>
<!-- layer3_ln1 -->
<g id="node203" class="node">
<title>layer3_ln1</title>
<polygon fill="lightgreen" stroke="black" points="7158,-2059.17 6700,-2059.17 6700,-1991.17 7158,-1991.17 7158,-2059.17"/>
<text text-anchor="middle" x="6929" y="-2043.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6929" y="-2028.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6929" y="-2013.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6929" y="-1998.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer2_residual2&#45;&gt;layer3_ln1 -->
<g id="edge286" class="edge">
<title>layer2_residual2&#45;&gt;layer3_ln1</title>
<path fill="none" stroke="black" d="M6929,-2124.82C6929,-2124.82 6929,-2069.58 6929,-2069.58"/>
<polygon fill="black" stroke="black" points="6932.5,-2069.58 6929,-2059.58 6925.5,-2069.58 6932.5,-2069.58"/>
</g>
<!-- layer3_residual1 -->
<g id="node241" class="node">
<title>layer3_residual1</title>
<polygon fill="lightpink" stroke="black" points="8864,-1426.17 8406,-1343.17 8864,-1260.17 9322,-1343.17 8864,-1426.17"/>
<text text-anchor="middle" x="8864" y="-1369.47" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8864" y="-1354.47" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8864" y="-1339.47" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8864" y="-1324.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8864" y="-1309.47" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer2_residual2&#45;&gt;layer3_residual1 -->
<g id="edge336" class="edge">
<title>layer2_residual2&#45;&gt;layer3_residual1</title>
<path fill="none" stroke="black" d="M7491.23,-2189C8003.63,-2189 8763.5,-2189 8763.5,-2189 8763.5,-2189 8763.5,-1418.13 8763.5,-1418.13"/>
<polygon fill="black" stroke="black" points="8767,-1418.13 8763.5,-1408.13 8760,-1418.13 8767,-1418.13"/>
</g>
<!-- layer3_qkv_proj_0 -->
<g id="node204" class="node">
<title>layer3_qkv_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="4032.5,-1955.17 3525.5,-1955.17 3525.5,-1872.17 4032.5,-1872.17 4032.5,-1955.17"/>
<text text-anchor="middle" x="3779" y="-1939.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3779" y="-1924.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3779" y="-1909.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3779" y="-1894.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3779" y="-1879.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_qkv_proj_0 -->
<g id="edge287" class="edge">
<title>layer3_ln1&#45;&gt;layer3_qkv_proj_0</title>
<path fill="none" stroke="black" d="M6699.93,-2049C5993.78,-2049 3897.83,-2049 3897.83,-2049 3897.83,-2049 3897.83,-1965.38 3897.83,-1965.38"/>
<polygon fill="black" stroke="black" points="3901.33,-1965.38 3897.83,-1955.38 3894.33,-1965.38 3901.33,-1965.38"/>
</g>
<!-- layer3_qkv_proj_1 -->
<g id="node205" class="node">
<title>layer3_qkv_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="4557.5,-1955.17 4050.5,-1955.17 4050.5,-1872.17 4557.5,-1872.17 4557.5,-1955.17"/>
<text text-anchor="middle" x="4304" y="-1939.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4304" y="-1924.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4304" y="-1909.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4304" y="-1894.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4304" y="-1879.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_qkv_proj_1 -->
<g id="edge291" class="edge">
<title>layer3_ln1&#45;&gt;layer3_qkv_proj_1</title>
<path fill="none" stroke="black" d="M6699.78,-2039C6060.42,-2039 4304,-2039 4304,-2039 4304,-2039 4304,-1965.4 4304,-1965.4"/>
<polygon fill="black" stroke="black" points="4307.5,-1965.4 4304,-1955.4 4300.5,-1965.4 4307.5,-1965.4"/>
</g>
<!-- layer3_qkv_proj_2 -->
<g id="node206" class="node">
<title>layer3_qkv_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="5082.5,-1955.17 4575.5,-1955.17 4575.5,-1872.17 5082.5,-1872.17 5082.5,-1955.17"/>
<text text-anchor="middle" x="4829" y="-1939.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4829" y="-1924.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4829" y="-1909.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4829" y="-1894.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4829" y="-1879.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_qkv_proj_2 -->
<g id="edge295" class="edge">
<title>layer3_ln1&#45;&gt;layer3_qkv_proj_2</title>
<path fill="none" stroke="black" d="M6699.57,-2030C6193.7,-2030 5027,-2030 5027,-2030 5027,-2030 5027,-1965.34 5027,-1965.34"/>
<polygon fill="black" stroke="black" points="5030.5,-1965.34 5027,-1955.34 5023.5,-1965.34 5030.5,-1965.34"/>
</g>
<!-- layer3_qkv_proj_3 -->
<g id="node207" class="node">
<title>layer3_qkv_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="5607.5,-1955.17 5100.5,-1955.17 5100.5,-1872.17 5607.5,-1872.17 5607.5,-1955.17"/>
<text text-anchor="middle" x="5354" y="-1939.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5354" y="-1924.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="5354" y="-1909.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5354" y="-1894.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5354" y="-1879.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_qkv_proj_3 -->
<g id="edge299" class="edge">
<title>layer3_ln1&#45;&gt;layer3_qkv_proj_3</title>
<path fill="none" stroke="black" d="M6699.69,-2020C6303.03,-2020 5530.83,-2020 5530.83,-2020 5530.83,-2020 5530.83,-1965.39 5530.83,-1965.39"/>
<polygon fill="black" stroke="black" points="5534.33,-1965.39 5530.83,-1955.39 5527.33,-1965.39 5534.33,-1965.39"/>
</g>
<!-- layer3_qkv_proj_4 -->
<g id="node208" class="node">
<title>layer3_qkv_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="6132.5,-1955.17 5625.5,-1955.17 5625.5,-1872.17 6132.5,-1872.17 6132.5,-1955.17"/>
<text text-anchor="middle" x="5879" y="-1939.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5879" y="-1924.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="5879" y="-1909.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5879" y="-1894.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5879" y="-1879.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_qkv_proj_4 -->
<g id="edge303" class="edge">
<title>layer3_ln1&#45;&gt;layer3_qkv_proj_4</title>
<path fill="none" stroke="black" d="M6699.87,-2010C6390.92,-2010 5879,-2010 5879,-2010 5879,-2010 5879,-1965.36 5879,-1965.36"/>
<polygon fill="black" stroke="black" points="5882.5,-1965.36 5879,-1955.36 5875.5,-1965.36 5882.5,-1965.36"/>
</g>
<!-- layer3_qkv_proj_5 -->
<g id="node209" class="node">
<title>layer3_qkv_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="6657.5,-1955.17 6150.5,-1955.17 6150.5,-1872.17 6657.5,-1872.17 6657.5,-1955.17"/>
<text text-anchor="middle" x="6404" y="-1939.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6404" y="-1924.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="6404" y="-1909.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6404" y="-1894.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="6404" y="-1879.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_qkv_proj_5 -->
<g id="edge307" class="edge">
<title>layer3_ln1&#45;&gt;layer3_qkv_proj_5</title>
<path fill="none" stroke="black" d="M6699.61,-2000C6652.4,-2000 6616.75,-2000 6616.75,-2000 6616.75,-2000 6616.75,-1965.32 6616.75,-1965.32"/>
<polygon fill="black" stroke="black" points="6620.25,-1965.32 6616.75,-1955.32 6613.25,-1965.32 6620.25,-1965.32"/>
</g>
<!-- layer3_qkv_proj_6 -->
<g id="node210" class="node">
<title>layer3_qkv_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="7182.5,-1955.17 6675.5,-1955.17 6675.5,-1872.17 7182.5,-1872.17 7182.5,-1955.17"/>
<text text-anchor="middle" x="6929" y="-1939.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6929" y="-1924.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="6929" y="-1909.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6929" y="-1894.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="6929" y="-1879.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_qkv_proj_6 -->
<g id="edge311" class="edge">
<title>layer3_ln1&#45;&gt;layer3_qkv_proj_6</title>
<path fill="none" stroke="black" d="M6929,-1991.11C6929,-1991.11 6929,-1965.38 6929,-1965.38"/>
<polygon fill="black" stroke="black" points="6932.5,-1965.38 6929,-1955.38 6925.5,-1965.38 6932.5,-1965.38"/>
</g>
<!-- layer3_qkv_proj_7 -->
<g id="node211" class="node">
<title>layer3_qkv_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="7707.5,-1955.17 7200.5,-1955.17 7200.5,-1872.17 7707.5,-1872.17 7707.5,-1955.17"/>
<text text-anchor="middle" x="7454" y="-1939.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7454" y="-1924.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="7454" y="-1909.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7454" y="-1894.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="7454" y="-1879.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_qkv_proj_7 -->
<g id="edge315" class="edge">
<title>layer3_ln1&#45;&gt;layer3_qkv_proj_7</title>
<path fill="none" stroke="black" d="M7158.07,-2002C7255.14,-2002 7346.25,-2002 7346.25,-2002 7346.25,-2002 7346.25,-1965.25 7346.25,-1965.25"/>
<polygon fill="black" stroke="black" points="7349.75,-1965.25 7346.25,-1955.25 7342.75,-1965.25 7349.75,-1965.25"/>
</g>
<!-- layer3_qkv_proj_8 -->
<g id="node212" class="node">
<title>layer3_qkv_proj_8</title>
<polygon fill="lightcoral" stroke="black" points="8232.5,-1955.17 7725.5,-1955.17 7725.5,-1872.17 8232.5,-1872.17 8232.5,-1955.17"/>
<text text-anchor="middle" x="7979" y="-1939.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7979" y="-1924.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="7979" y="-1909.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7979" y="-1894.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7979" y="-1879.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_qkv_proj_8 -->
<g id="edge319" class="edge">
<title>layer3_ln1&#45;&gt;layer3_qkv_proj_8</title>
<path fill="none" stroke="black" d="M7158.3,-2013C7448.12,-2013 7909.67,-2013 7909.67,-2013 7909.67,-2013 7909.67,-1965.22 7909.67,-1965.22"/>
<polygon fill="black" stroke="black" points="7913.17,-1965.22 7909.67,-1955.22 7906.17,-1965.22 7913.17,-1965.22"/>
</g>
<!-- layer3_qkv_proj_9 -->
<g id="node213" class="node">
<title>layer3_qkv_proj_9</title>
<polygon fill="lightcoral" stroke="black" points="8757.5,-1955.17 8250.5,-1955.17 8250.5,-1872.17 8757.5,-1872.17 8757.5,-1955.17"/>
<text text-anchor="middle" x="8504" y="-1939.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8504" y="-1924.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="8504" y="-1909.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8504" y="-1894.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="8504" y="-1879.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_qkv_proj_9 -->
<g id="edge323" class="edge">
<title>layer3_ln1&#45;&gt;layer3_qkv_proj_9</title>
<path fill="none" stroke="black" d="M7158.37,-2025C7546.85,-2025 8292.5,-2025 8292.5,-2025 8292.5,-2025 8292.5,-1965.44 8292.5,-1965.44"/>
<polygon fill="black" stroke="black" points="8296,-1965.44 8292.5,-1955.44 8289,-1965.44 8296,-1965.44"/>
</g>
<!-- layer3_qkv_proj_10 -->
<g id="node214" class="node">
<title>layer3_qkv_proj_10</title>
<polygon fill="lightcoral" stroke="black" points="9282.5,-1955.17 8775.5,-1955.17 8775.5,-1872.17 9282.5,-1872.17 9282.5,-1955.17"/>
<text text-anchor="middle" x="9029" y="-1939.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9029" y="-1924.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="9029" y="-1909.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9029" y="-1894.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="9029" y="-1879.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_qkv_proj_10 -->
<g id="edge327" class="edge">
<title>layer3_ln1&#45;&gt;layer3_qkv_proj_10</title>
<path fill="none" stroke="black" d="M7158.46,-2036C7657.38,-2036 8796.5,-2036 8796.5,-2036 8796.5,-2036 8796.5,-1965.42 8796.5,-1965.42"/>
<polygon fill="black" stroke="black" points="8800,-1965.42 8796.5,-1955.42 8793,-1965.42 8800,-1965.42"/>
</g>
<!-- layer3_qkv_proj_11 -->
<g id="node215" class="node">
<title>layer3_qkv_proj_11</title>
<polygon fill="lightcoral" stroke="black" points="9807.5,-1955.17 9300.5,-1955.17 9300.5,-1872.17 9807.5,-1872.17 9807.5,-1955.17"/>
<text text-anchor="middle" x="9554" y="-1939.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9554" y="-1924.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="9554" y="-1909.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9554" y="-1894.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="9554" y="-1879.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_qkv_proj_11 -->
<g id="edge331" class="edge">
<title>layer3_ln1&#45;&gt;layer3_qkv_proj_11</title>
<path fill="none" stroke="black" d="M7158.22,-2047C7797.58,-2047 9554,-2047 9554,-2047 9554,-2047 9554,-1965.49 9554,-1965.49"/>
<polygon fill="black" stroke="black" points="9557.5,-1965.49 9554,-1955.49 9550.5,-1965.49 9557.5,-1965.49"/>
</g>
<!-- layer3_attention_0 -->
<g id="node216" class="node">
<title>layer3_attention_0</title>
<polygon fill="lightcoral" stroke="black" points="4032.5,-1836.17 3525.5,-1836.17 3525.5,-1753.17 4032.5,-1753.17 4032.5,-1836.17"/>
<text text-anchor="middle" x="3779" y="-1820.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="3779" y="-1805.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3779" y="-1790.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3779" y="-1775.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3779" y="-1760.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_qkv_proj_0&#45;&gt;layer3_attention_0 -->
<g id="edge288" class="edge">
<title>layer3_qkv_proj_0&#45;&gt;layer3_attention_0</title>
<path fill="none" stroke="black" d="M3779,-1872.05C3779,-1872.05 3779,-1846.46 3779,-1846.46"/>
<polygon fill="black" stroke="black" points="3782.5,-1846.46 3779,-1836.46 3775.5,-1846.46 3782.5,-1846.46"/>
</g>
<!-- layer3_attention_1 -->
<g id="node217" class="node">
<title>layer3_attention_1</title>
<polygon fill="lightcoral" stroke="black" points="4557.5,-1836.17 4050.5,-1836.17 4050.5,-1753.17 4557.5,-1753.17 4557.5,-1836.17"/>
<text text-anchor="middle" x="4304" y="-1820.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="4304" y="-1805.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4304" y="-1790.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4304" y="-1775.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4304" y="-1760.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_qkv_proj_1&#45;&gt;layer3_attention_1 -->
<g id="edge292" class="edge">
<title>layer3_qkv_proj_1&#45;&gt;layer3_attention_1</title>
<path fill="none" stroke="black" d="M4304,-1872.05C4304,-1872.05 4304,-1846.46 4304,-1846.46"/>
<polygon fill="black" stroke="black" points="4307.5,-1846.46 4304,-1836.46 4300.5,-1846.46 4307.5,-1846.46"/>
</g>
<!-- layer3_attention_2 -->
<g id="node218" class="node">
<title>layer3_attention_2</title>
<polygon fill="lightcoral" stroke="black" points="5082.5,-1836.17 4575.5,-1836.17 4575.5,-1753.17 5082.5,-1753.17 5082.5,-1836.17"/>
<text text-anchor="middle" x="4829" y="-1820.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="4829" y="-1805.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4829" y="-1790.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4829" y="-1775.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4829" y="-1760.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_qkv_proj_2&#45;&gt;layer3_attention_2 -->
<g id="edge296" class="edge">
<title>layer3_qkv_proj_2&#45;&gt;layer3_attention_2</title>
<path fill="none" stroke="black" d="M4829,-1872.05C4829,-1872.05 4829,-1846.46 4829,-1846.46"/>
<polygon fill="black" stroke="black" points="4832.5,-1846.46 4829,-1836.46 4825.5,-1846.46 4832.5,-1846.46"/>
</g>
<!-- layer3_attention_3 -->
<g id="node219" class="node">
<title>layer3_attention_3</title>
<polygon fill="lightcoral" stroke="black" points="5607.5,-1836.17 5100.5,-1836.17 5100.5,-1753.17 5607.5,-1753.17 5607.5,-1836.17"/>
<text text-anchor="middle" x="5354" y="-1820.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="5354" y="-1805.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="5354" y="-1790.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5354" y="-1775.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5354" y="-1760.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_qkv_proj_3&#45;&gt;layer3_attention_3 -->
<g id="edge300" class="edge">
<title>layer3_qkv_proj_3&#45;&gt;layer3_attention_3</title>
<path fill="none" stroke="black" d="M5354,-1872.05C5354,-1872.05 5354,-1846.46 5354,-1846.46"/>
<polygon fill="black" stroke="black" points="5357.5,-1846.46 5354,-1836.46 5350.5,-1846.46 5357.5,-1846.46"/>
</g>
<!-- layer3_attention_4 -->
<g id="node220" class="node">
<title>layer3_attention_4</title>
<polygon fill="lightcoral" stroke="black" points="6132.5,-1836.17 5625.5,-1836.17 5625.5,-1753.17 6132.5,-1753.17 6132.5,-1836.17"/>
<text text-anchor="middle" x="5879" y="-1820.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="5879" y="-1805.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="5879" y="-1790.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5879" y="-1775.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5879" y="-1760.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_qkv_proj_4&#45;&gt;layer3_attention_4 -->
<g id="edge304" class="edge">
<title>layer3_qkv_proj_4&#45;&gt;layer3_attention_4</title>
<path fill="none" stroke="black" d="M5879,-1872.05C5879,-1872.05 5879,-1846.46 5879,-1846.46"/>
<polygon fill="black" stroke="black" points="5882.5,-1846.46 5879,-1836.46 5875.5,-1846.46 5882.5,-1846.46"/>
</g>
<!-- layer3_attention_5 -->
<g id="node221" class="node">
<title>layer3_attention_5</title>
<polygon fill="lightcoral" stroke="black" points="6657.5,-1836.17 6150.5,-1836.17 6150.5,-1753.17 6657.5,-1753.17 6657.5,-1836.17"/>
<text text-anchor="middle" x="6404" y="-1820.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="6404" y="-1805.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="6404" y="-1790.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="6404" y="-1775.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="6404" y="-1760.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_qkv_proj_5&#45;&gt;layer3_attention_5 -->
<g id="edge308" class="edge">
<title>layer3_qkv_proj_5&#45;&gt;layer3_attention_5</title>
<path fill="none" stroke="black" d="M6404,-1872.05C6404,-1872.05 6404,-1846.46 6404,-1846.46"/>
<polygon fill="black" stroke="black" points="6407.5,-1846.46 6404,-1836.46 6400.5,-1846.46 6407.5,-1846.46"/>
</g>
<!-- layer3_attention_6 -->
<g id="node222" class="node">
<title>layer3_attention_6</title>
<polygon fill="lightcoral" stroke="black" points="7182.5,-1836.17 6675.5,-1836.17 6675.5,-1753.17 7182.5,-1753.17 7182.5,-1836.17"/>
<text text-anchor="middle" x="6929" y="-1820.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="6929" y="-1805.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="6929" y="-1790.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="6929" y="-1775.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="6929" y="-1760.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_qkv_proj_6&#45;&gt;layer3_attention_6 -->
<g id="edge312" class="edge">
<title>layer3_qkv_proj_6&#45;&gt;layer3_attention_6</title>
<path fill="none" stroke="black" d="M6929,-1872.05C6929,-1872.05 6929,-1846.46 6929,-1846.46"/>
<polygon fill="black" stroke="black" points="6932.5,-1846.46 6929,-1836.46 6925.5,-1846.46 6932.5,-1846.46"/>
</g>
<!-- layer3_attention_7 -->
<g id="node223" class="node">
<title>layer3_attention_7</title>
<polygon fill="lightcoral" stroke="black" points="7707.5,-1836.17 7200.5,-1836.17 7200.5,-1753.17 7707.5,-1753.17 7707.5,-1836.17"/>
<text text-anchor="middle" x="7454" y="-1820.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="7454" y="-1805.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="7454" y="-1790.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="7454" y="-1775.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="7454" y="-1760.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_qkv_proj_7&#45;&gt;layer3_attention_7 -->
<g id="edge316" class="edge">
<title>layer3_qkv_proj_7&#45;&gt;layer3_attention_7</title>
<path fill="none" stroke="black" d="M7454,-1872.05C7454,-1872.05 7454,-1846.46 7454,-1846.46"/>
<polygon fill="black" stroke="black" points="7457.5,-1846.46 7454,-1836.46 7450.5,-1846.46 7457.5,-1846.46"/>
</g>
<!-- layer3_attention_8 -->
<g id="node224" class="node">
<title>layer3_attention_8</title>
<polygon fill="lightcoral" stroke="black" points="8232.5,-1836.17 7725.5,-1836.17 7725.5,-1753.17 8232.5,-1753.17 8232.5,-1836.17"/>
<text text-anchor="middle" x="7979" y="-1820.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="7979" y="-1805.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="7979" y="-1790.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7979" y="-1775.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7979" y="-1760.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_qkv_proj_8&#45;&gt;layer3_attention_8 -->
<g id="edge320" class="edge">
<title>layer3_qkv_proj_8&#45;&gt;layer3_attention_8</title>
<path fill="none" stroke="black" d="M7979,-1872.05C7979,-1872.05 7979,-1846.46 7979,-1846.46"/>
<polygon fill="black" stroke="black" points="7982.5,-1846.46 7979,-1836.46 7975.5,-1846.46 7982.5,-1846.46"/>
</g>
<!-- layer3_attention_9 -->
<g id="node225" class="node">
<title>layer3_attention_9</title>
<polygon fill="lightcoral" stroke="black" points="8757.5,-1836.17 8250.5,-1836.17 8250.5,-1753.17 8757.5,-1753.17 8757.5,-1836.17"/>
<text text-anchor="middle" x="8504" y="-1820.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="8504" y="-1805.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="8504" y="-1790.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="8504" y="-1775.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="8504" y="-1760.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_qkv_proj_9&#45;&gt;layer3_attention_9 -->
<g id="edge324" class="edge">
<title>layer3_qkv_proj_9&#45;&gt;layer3_attention_9</title>
<path fill="none" stroke="black" d="M8504,-1872.05C8504,-1872.05 8504,-1846.46 8504,-1846.46"/>
<polygon fill="black" stroke="black" points="8507.5,-1846.46 8504,-1836.46 8500.5,-1846.46 8507.5,-1846.46"/>
</g>
<!-- layer3_attention_10 -->
<g id="node226" class="node">
<title>layer3_attention_10</title>
<polygon fill="lightcoral" stroke="black" points="9282.5,-1836.17 8775.5,-1836.17 8775.5,-1753.17 9282.5,-1753.17 9282.5,-1836.17"/>
<text text-anchor="middle" x="9029" y="-1820.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="9029" y="-1805.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="9029" y="-1790.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="9029" y="-1775.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="9029" y="-1760.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_qkv_proj_10&#45;&gt;layer3_attention_10 -->
<g id="edge328" class="edge">
<title>layer3_qkv_proj_10&#45;&gt;layer3_attention_10</title>
<path fill="none" stroke="black" d="M9029,-1872.05C9029,-1872.05 9029,-1846.46 9029,-1846.46"/>
<polygon fill="black" stroke="black" points="9032.5,-1846.46 9029,-1836.46 9025.5,-1846.46 9032.5,-1846.46"/>
</g>
<!-- layer3_attention_11 -->
<g id="node227" class="node">
<title>layer3_attention_11</title>
<polygon fill="lightcoral" stroke="black" points="9807.5,-1836.17 9300.5,-1836.17 9300.5,-1753.17 9807.5,-1753.17 9807.5,-1836.17"/>
<text text-anchor="middle" x="9554" y="-1820.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="9554" y="-1805.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="9554" y="-1790.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="9554" y="-1775.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="9554" y="-1760.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_qkv_proj_11&#45;&gt;layer3_attention_11 -->
<g id="edge332" class="edge">
<title>layer3_qkv_proj_11&#45;&gt;layer3_attention_11</title>
<path fill="none" stroke="black" d="M9554,-1872.05C9554,-1872.05 9554,-1846.46 9554,-1846.46"/>
<polygon fill="black" stroke="black" points="9557.5,-1846.46 9554,-1836.46 9550.5,-1846.46 9557.5,-1846.46"/>
</g>
<!-- layer3_attn_out_proj_0 -->
<g id="node228" class="node">
<title>layer3_attn_out_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="4037.5,-1717.17 3542.5,-1717.17 3542.5,-1634.17 4037.5,-1634.17 4037.5,-1717.17"/>
<text text-anchor="middle" x="3790" y="-1701.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="3790" y="-1686.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="3790" y="-1671.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3790" y="-1656.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="3790" y="-1641.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_attention_0&#45;&gt;layer3_attn_out_proj_0 -->
<g id="edge289" class="edge">
<title>layer3_attention_0&#45;&gt;layer3_attn_out_proj_0</title>
<path fill="none" stroke="black" d="M3787.5,-1753.05C3787.5,-1753.05 3787.5,-1727.46 3787.5,-1727.46"/>
<polygon fill="black" stroke="black" points="3791,-1727.46 3787.5,-1717.46 3784,-1727.46 3791,-1727.46"/>
</g>
<!-- layer3_attn_out_proj_1 -->
<g id="node229" class="node">
<title>layer3_attn_out_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="4562.5,-1717.17 4067.5,-1717.17 4067.5,-1634.17 4562.5,-1634.17 4562.5,-1717.17"/>
<text text-anchor="middle" x="4315" y="-1701.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="4315" y="-1686.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4315" y="-1671.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4315" y="-1656.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="4315" y="-1641.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_attention_1&#45;&gt;layer3_attn_out_proj_1 -->
<g id="edge293" class="edge">
<title>layer3_attention_1&#45;&gt;layer3_attn_out_proj_1</title>
<path fill="none" stroke="black" d="M4312.5,-1753.05C4312.5,-1753.05 4312.5,-1727.46 4312.5,-1727.46"/>
<polygon fill="black" stroke="black" points="4316,-1727.46 4312.5,-1717.46 4309,-1727.46 4316,-1727.46"/>
</g>
<!-- layer3_attn_out_proj_2 -->
<g id="node230" class="node">
<title>layer3_attn_out_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="5087.5,-1717.17 4592.5,-1717.17 4592.5,-1634.17 5087.5,-1634.17 5087.5,-1717.17"/>
<text text-anchor="middle" x="4840" y="-1701.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="4840" y="-1686.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="4840" y="-1671.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4840" y="-1656.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="4840" y="-1641.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_attention_2&#45;&gt;layer3_attn_out_proj_2 -->
<g id="edge297" class="edge">
<title>layer3_attention_2&#45;&gt;layer3_attn_out_proj_2</title>
<path fill="none" stroke="black" d="M4837.5,-1753.05C4837.5,-1753.05 4837.5,-1727.46 4837.5,-1727.46"/>
<polygon fill="black" stroke="black" points="4841,-1727.46 4837.5,-1717.46 4834,-1727.46 4841,-1727.46"/>
</g>
<!-- layer3_attn_out_proj_3 -->
<g id="node231" class="node">
<title>layer3_attn_out_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="5611.5,-1717.17 5116.5,-1717.17 5116.5,-1634.17 5611.5,-1634.17 5611.5,-1717.17"/>
<text text-anchor="middle" x="5364" y="-1701.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="5364" y="-1686.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="5364" y="-1671.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5364" y="-1656.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="5364" y="-1641.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_attention_3&#45;&gt;layer3_attn_out_proj_3 -->
<g id="edge301" class="edge">
<title>layer3_attention_3&#45;&gt;layer3_attn_out_proj_3</title>
<path fill="none" stroke="black" d="M5362,-1753.05C5362,-1753.05 5362,-1727.46 5362,-1727.46"/>
<polygon fill="black" stroke="black" points="5365.5,-1727.46 5362,-1717.46 5358.5,-1727.46 5365.5,-1727.46"/>
</g>
<!-- layer3_attn_out_proj_4 -->
<g id="node232" class="node">
<title>layer3_attn_out_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="6135.5,-1717.17 5640.5,-1717.17 5640.5,-1634.17 6135.5,-1634.17 6135.5,-1717.17"/>
<text text-anchor="middle" x="5888" y="-1701.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="5888" y="-1686.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="5888" y="-1671.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="5888" y="-1656.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="5888" y="-1641.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_attention_4&#45;&gt;layer3_attn_out_proj_4 -->
<g id="edge305" class="edge">
<title>layer3_attention_4&#45;&gt;layer3_attn_out_proj_4</title>
<path fill="none" stroke="black" d="M5886.5,-1753.05C5886.5,-1753.05 5886.5,-1727.46 5886.5,-1727.46"/>
<polygon fill="black" stroke="black" points="5890,-1727.46 5886.5,-1717.46 5883,-1727.46 5890,-1727.46"/>
</g>
<!-- layer3_attn_out_proj_5 -->
<g id="node233" class="node">
<title>layer3_attn_out_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="6657.5,-1717.17 6162.5,-1717.17 6162.5,-1634.17 6657.5,-1634.17 6657.5,-1717.17"/>
<text text-anchor="middle" x="6410" y="-1701.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="6410" y="-1686.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="6410" y="-1671.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="6410" y="-1656.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="6410" y="-1641.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_attention_5&#45;&gt;layer3_attn_out_proj_5 -->
<g id="edge309" class="edge">
<title>layer3_attention_5&#45;&gt;layer3_attn_out_proj_5</title>
<path fill="none" stroke="black" d="M6410,-1753.05C6410,-1753.05 6410,-1727.46 6410,-1727.46"/>
<polygon fill="black" stroke="black" points="6413.5,-1727.46 6410,-1717.46 6406.5,-1727.46 6413.5,-1727.46"/>
</g>
<!-- layer3_attn_out_proj_6 -->
<g id="node234" class="node">
<title>layer3_attn_out_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="7176.5,-1717.17 6681.5,-1717.17 6681.5,-1634.17 7176.5,-1634.17 7176.5,-1717.17"/>
<text text-anchor="middle" x="6929" y="-1701.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="6929" y="-1686.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="6929" y="-1671.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="6929" y="-1656.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="6929" y="-1641.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_attention_6&#45;&gt;layer3_attn_out_proj_6 -->
<g id="edge313" class="edge">
<title>layer3_attention_6&#45;&gt;layer3_attn_out_proj_6</title>
<path fill="none" stroke="black" d="M6929,-1753.05C6929,-1753.05 6929,-1727.46 6929,-1727.46"/>
<polygon fill="black" stroke="black" points="6932.5,-1727.46 6929,-1717.46 6925.5,-1727.46 6932.5,-1727.46"/>
</g>
<!-- layer3_attn_out_proj_7 -->
<g id="node235" class="node">
<title>layer3_attn_out_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="7695.5,-1717.17 7200.5,-1717.17 7200.5,-1634.17 7695.5,-1634.17 7695.5,-1717.17"/>
<text text-anchor="middle" x="7448" y="-1701.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="7448" y="-1686.97" font-family="Times,serif" font-size="14.00">Heads=3</text>
<text text-anchor="middle" x="7448" y="-1671.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="7448" y="-1656.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=384]</text>
<text text-anchor="middle" x="7448" y="-1641.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_attention_7&#45;&gt;layer3_attn_out_proj_7 -->
<g id="edge317" class="edge">
<title>layer3_attention_7&#45;&gt;layer3_attn_out_proj_7</title>
<path fill="none" stroke="black" d="M7448,-1753.05C7448,-1753.05 7448,-1727.46 7448,-1727.46"/>
<polygon fill="black" stroke="black" points="7451.5,-1727.46 7448,-1717.46 7444.5,-1727.46 7451.5,-1727.46"/>
</g>
<!-- layer3_attn_out_proj_8 -->
<g id="node236" class="node">
<title>layer3_attn_out_proj_8</title>
<polygon fill="lightcoral" stroke="black" points="8217.5,-1717.17 7722.5,-1717.17 7722.5,-1634.17 8217.5,-1634.17 8217.5,-1717.17"/>
<text text-anchor="middle" x="7970" y="-1701.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="7970" y="-1686.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="7970" y="-1671.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7970" y="-1656.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=256]</text>
<text text-anchor="middle" x="7970" y="-1641.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_attention_8&#45;&gt;layer3_attn_out_proj_8 -->
<g id="edge321" class="edge">
<title>layer3_attention_8&#45;&gt;layer3_attn_out_proj_8</title>
<path fill="none" stroke="black" d="M7971.5,-1753.05C7971.5,-1753.05 7971.5,-1727.46 7971.5,-1727.46"/>
<polygon fill="black" stroke="black" points="7975,-1727.46 7971.5,-1717.46 7968,-1727.46 7975,-1727.46"/>
</g>
<!-- layer3_attn_out_proj_9 -->
<g id="node237" class="node">
<title>layer3_attn_out_proj_9</title>
<polygon fill="lightcoral" stroke="black" points="8740.5,-1717.17 8245.5,-1717.17 8245.5,-1634.17 8740.5,-1634.17 8740.5,-1717.17"/>
<text text-anchor="middle" x="8493" y="-1701.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="8493" y="-1686.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="8493" y="-1671.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="8493" y="-1656.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=256]</text>
<text text-anchor="middle" x="8493" y="-1641.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_attention_9&#45;&gt;layer3_attn_out_proj_9 -->
<g id="edge325" class="edge">
<title>layer3_attention_9&#45;&gt;layer3_attn_out_proj_9</title>
<path fill="none" stroke="black" d="M8495.5,-1753.05C8495.5,-1753.05 8495.5,-1727.46 8495.5,-1727.46"/>
<polygon fill="black" stroke="black" points="8499,-1727.46 8495.5,-1717.46 8492,-1727.46 8499,-1727.46"/>
</g>
<!-- layer3_attn_out_proj_10 -->
<g id="node238" class="node">
<title>layer3_attn_out_proj_10</title>
<polygon fill="lightcoral" stroke="black" points="9264.5,-1717.17 8769.5,-1717.17 8769.5,-1634.17 9264.5,-1634.17 9264.5,-1717.17"/>
<text text-anchor="middle" x="9017" y="-1701.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="9017" y="-1686.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="9017" y="-1671.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="9017" y="-1656.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=256]</text>
<text text-anchor="middle" x="9017" y="-1641.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_attention_10&#45;&gt;layer3_attn_out_proj_10 -->
<g id="edge329" class="edge">
<title>layer3_attention_10&#45;&gt;layer3_attn_out_proj_10</title>
<path fill="none" stroke="black" d="M9020,-1753.05C9020,-1753.05 9020,-1727.46 9020,-1727.46"/>
<polygon fill="black" stroke="black" points="9023.5,-1727.46 9020,-1717.46 9016.5,-1727.46 9023.5,-1727.46"/>
</g>
<!-- layer3_attn_out_proj_11 -->
<g id="node239" class="node">
<title>layer3_attn_out_proj_11</title>
<polygon fill="lightcoral" stroke="black" points="9789.5,-1717.17 9294.5,-1717.17 9294.5,-1634.17 9789.5,-1634.17 9789.5,-1717.17"/>
<text text-anchor="middle" x="9542" y="-1701.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="9542" y="-1686.97" font-family="Times,serif" font-size="14.00">Heads=2</text>
<text text-anchor="middle" x="9542" y="-1671.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="9542" y="-1656.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=256]</text>
<text text-anchor="middle" x="9542" y="-1641.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_attention_11&#45;&gt;layer3_attn_out_proj_11 -->
<g id="edge333" class="edge">
<title>layer3_attention_11&#45;&gt;layer3_attn_out_proj_11</title>
<path fill="none" stroke="black" d="M9545,-1753.05C9545,-1753.05 9545,-1727.46 9545,-1727.46"/>
<polygon fill="black" stroke="black" points="9548.5,-1727.46 9545,-1717.46 9541.5,-1727.46 9548.5,-1727.46"/>
</g>
<!-- layer3_attn_allreduce -->
<g id="node240" class="node">
<title>layer3_attn_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="7403.67,-1598.17 6648.58,-1598.17 6454.33,-1462.17 7209.42,-1462.17 7403.67,-1598.17"/>
<text text-anchor="middle" x="6929" y="-1548.97" font-family="Times,serif" font-size="14.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="6929" y="-1533.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6929" y="-1518.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6929" y="-1503.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer3_attn_out_proj_0&#45;&gt;layer3_attn_allreduce -->
<g id="edge290" class="edge">
<title>layer3_attn_out_proj_0&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M3790,-1634.08C3790,-1577.71 3790,-1484 3790,-1484 3790,-1484 6475.5,-1484 6475.5,-1484"/>
<polygon fill="black" stroke="black" points="6475.5,-1487.5 6485.5,-1484 6475.5,-1480.5 6475.5,-1487.5"/>
</g>
<!-- layer3_attn_out_proj_1&#45;&gt;layer3_attn_allreduce -->
<g id="edge294" class="edge">
<title>layer3_attn_out_proj_1&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M4522.3,-1633.97C4522.3,-1584.03 4522.3,-1507 4522.3,-1507 4522.3,-1507 6508.35,-1507 6508.35,-1507"/>
<polygon fill="black" stroke="black" points="6508.35,-1510.5 6518.35,-1507 6508.35,-1503.5 6508.35,-1510.5"/>
</g>
<!-- layer3_attn_out_proj_2&#45;&gt;layer3_attn_allreduce -->
<g id="edge298" class="edge">
<title>layer3_attn_out_proj_2&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M4910.5,-1633.92C4910.5,-1590.88 4910.5,-1530 4910.5,-1530 4910.5,-1530 6541.11,-1530 6541.11,-1530"/>
<polygon fill="black" stroke="black" points="6541.11,-1533.5 6551.11,-1530 6541.11,-1526.5 6541.11,-1533.5"/>
</g>
<!-- layer3_attn_out_proj_3&#45;&gt;layer3_attn_allreduce -->
<g id="edge302" class="edge">
<title>layer3_attn_out_proj_3&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M5530.7,-1634.14C5530.7,-1598.22 5530.7,-1552 5530.7,-1552 5530.7,-1552 6572.46,-1552 6572.46,-1552"/>
<polygon fill="black" stroke="black" points="6572.46,-1555.5 6582.46,-1552 6572.46,-1548.5 6572.46,-1555.5"/>
</g>
<!-- layer3_attn_out_proj_4&#45;&gt;layer3_attn_allreduce -->
<g id="edge306" class="edge">
<title>layer3_attn_out_proj_4&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M5888,-1634.14C5888,-1606.41 5888,-1575 5888,-1575 5888,-1575 6605.25,-1575 6605.25,-1575"/>
<polygon fill="black" stroke="black" points="6605.25,-1578.5 6615.25,-1575 6605.25,-1571.5 6605.25,-1578.5"/>
</g>
<!-- layer3_attn_out_proj_5&#45;&gt;layer3_attn_allreduce -->
<g id="edge310" class="edge">
<title>layer3_attn_out_proj_5&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M6555.83,-1633.97C6555.83,-1633.97 6555.83,-1543.56 6555.83,-1543.56"/>
<polygon fill="black" stroke="black" points="6559.33,-1543.56 6555.83,-1533.56 6552.33,-1543.56 6559.33,-1543.56"/>
</g>
<!-- layer3_attn_out_proj_6&#45;&gt;layer3_attn_allreduce -->
<g id="edge314" class="edge">
<title>layer3_attn_out_proj_6&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M6929,-1633.97C6929,-1633.97 6929,-1608.24 6929,-1608.24"/>
<polygon fill="black" stroke="black" points="6932.5,-1608.24 6929,-1598.24 6925.5,-1608.24 6932.5,-1608.24"/>
</g>
<!-- layer3_attn_out_proj_7&#45;&gt;layer3_attn_allreduce -->
<g id="edge318" class="edge">
<title>layer3_attn_out_proj_7&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M7302.17,-1633.97C7302.17,-1633.97 7302.17,-1608.24 7302.17,-1608.24"/>
<polygon fill="black" stroke="black" points="7305.67,-1608.24 7302.17,-1598.24 7298.67,-1608.24 7305.67,-1608.24"/>
</g>
<!-- layer3_attn_out_proj_8&#45;&gt;layer3_attn_allreduce -->
<g id="edge322" class="edge">
<title>layer3_attn_out_proj_8&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M7868.25,-1633.9C7868.25,-1604.37 7868.25,-1570 7868.25,-1570 7868.25,-1570 7373.57,-1570 7373.57,-1570"/>
<polygon fill="black" stroke="black" points="7373.57,-1566.5 7363.57,-1570 7373.57,-1573.5 7373.57,-1566.5"/>
</g>
<!-- layer3_attn_out_proj_9&#45;&gt;layer3_attn_allreduce -->
<g id="edge326" class="edge">
<title>layer3_attn_out_proj_9&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M8325.75,-1634.05C8325.75,-1595.15 8325.75,-1543 8325.75,-1543 8325.75,-1543 7335.05,-1543 7335.05,-1543"/>
<polygon fill="black" stroke="black" points="7335.05,-1539.5 7325.05,-1543 7335.05,-1546.5 7335.05,-1539.5"/>
</g>
<!-- layer3_attn_out_proj_10&#45;&gt;layer3_attn_allreduce -->
<g id="edge330" class="edge">
<title>layer3_attn_out_proj_10&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M9017,-1634.13C9017,-1586.82 9017,-1516 9017,-1516 9017,-1516 7296.46,-1516 7296.46,-1516"/>
<polygon fill="black" stroke="black" points="7296.46,-1512.5 7286.46,-1516 7296.46,-1519.5 7296.46,-1512.5"/>
</g>
<!-- layer3_attn_out_proj_11&#45;&gt;layer3_attn_allreduce -->
<g id="edge334" class="edge">
<title>layer3_attn_out_proj_11&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M9308.25,-1633.77C9308.25,-1578.74 9308.25,-1489 9308.25,-1489 9308.25,-1489 7258.02,-1489 7258.02,-1489"/>
<polygon fill="black" stroke="black" points="7258.02,-1485.5 7248.02,-1489 7258.02,-1492.5 7258.02,-1485.5"/>
</g>
<!-- layer3_attn_allreduce&#45;&gt;layer3_residual1 -->
<g id="edge335" class="edge">
<title>layer3_attn_allreduce&#45;&gt;layer3_residual1</title>
<path fill="none" stroke="black" d="M7279.65,-1511.19C7279.65,-1463.61 7279.65,-1343 7279.65,-1343 7279.65,-1343 8396.8,-1343 8396.8,-1343"/>
<polygon fill="black" stroke="black" points="8396.8,-1346.5 8406.8,-1343 8396.8,-1339.5 8396.8,-1346.5"/>
</g>
<!-- layer3_ln2 -->
<g id="node242" class="node">
<title>layer3_ln2</title>
<polygon fill="lightgreen" stroke="black" points="8472,-1224.17 8014,-1224.17 8014,-1156.17 8472,-1156.17 8472,-1224.17"/>
<text text-anchor="middle" x="8243" y="-1208.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8243" y="-1193.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8243" y="-1178.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8243" y="-1163.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer3_residual1&#45;&gt;layer3_ln2 -->
<g id="edge337" class="edge">
<title>layer3_residual1&#45;&gt;layer3_ln2</title>
<path fill="none" stroke="black" d="M8439,-1336.98C8439,-1336.98 8439,-1234.29 8439,-1234.29"/>
<polygon fill="black" stroke="black" points="8442.5,-1234.29 8439,-1224.29 8435.5,-1234.29 8442.5,-1234.29"/>
</g>
<!-- layer3_residual2 -->
<g id="node269" class="node">
<title>layer3_residual2</title>
<polygon fill="lightpink" stroke="black" points="8968,-298.17 8510,-215.17 8968,-132.17 9426,-215.17 8968,-298.17"/>
<text text-anchor="middle" x="8968" y="-241.47" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8968" y="-226.47" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8968" y="-211.47" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8968" y="-196.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8968" y="-181.47" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer3_residual1&#45;&gt;layer3_residual2 -->
<g id="edge380" class="edge">
<title>layer3_residual1&#45;&gt;layer3_residual2</title>
<path fill="none" stroke="black" d="M8588.5,-1310.02C8588.5,-1310.02 8588.5,-239.51 8588.5,-239.51"/>
<polygon fill="black" stroke="black" points="8592,-239.51 8588.5,-229.51 8585,-239.51 8592,-239.51"/>
</g>
<!-- layer3_gate -->
<g id="node243" class="node">
<title>layer3_gate</title>
<polygon fill="lightblue" stroke="black" points="8088.58,-1120.17 7346.36,-1120.17 7155.42,-984.17 7897.64,-984.17 8088.58,-1120.17"/>
<text text-anchor="middle" x="7622" y="-1070.97" font-family="Times,serif" font-size="14.00">Gate Computation</text>
<text text-anchor="middle" x="7622" y="-1055.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7622" y="-1040.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="7622" y="-1025.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer3_ln2&#45;&gt;layer3_gate -->
<g id="edge338" class="edge">
<title>layer3_ln2&#45;&gt;layer3_gate</title>
<path fill="none" stroke="black" d="M8051.27,-1156.05C8051.27,-1156.05 8051.27,-1062.21 8051.27,-1062.21"/>
<polygon fill="black" stroke="black" points="8054.77,-1062.21 8051.27,-1052.21 8047.77,-1062.21 8054.77,-1062.21"/>
</g>
<!-- layer3_route_0 -->
<g id="node244" class="node">
<title>layer3_route_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4482.18,-948.17 3715.14,-948.17 3517.82,-782.17 4284.86,-782.17 4482.18,-948.17"/>
<text text-anchor="middle" x="4000" y="-891.47" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="4000" y="-876.47" font-family="Times,serif" font-size="14.00">Experts=[0&#45;3]</text>
<text text-anchor="middle" x="4000" y="-861.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4000" y="-846.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="4000" y="-831.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_0 -->
<g id="edge339" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7281.47,-1074C6429.71,-1074 4274.8,-1074 4274.8,-1074 4274.8,-1074 4274.8,-958.3 4274.8,-958.3"/>
<polygon fill="black" stroke="black" points="4278.3,-958.3 4274.8,-948.3 4271.3,-958.3 4278.3,-958.3"/>
</g>
<!-- layer3_route_1 -->
<g id="node250" class="node">
<title>layer3_route_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6414.18,-948.17 5647.14,-948.17 5449.82,-782.17 6216.86,-782.17 6414.18,-948.17"/>
<text text-anchor="middle" x="5932" y="-891.47" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="5932" y="-876.47" font-family="Times,serif" font-size="14.00">Experts=[4&#45;7]</text>
<text text-anchor="middle" x="5932" y="-861.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5932" y="-846.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="5932" y="-831.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_1 -->
<g id="edge348" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7218.23,-1029C6825.68,-1029 6288.3,-1029 6288.3,-1029 6288.3,-1029 6288.3,-958.52 6288.3,-958.52"/>
<polygon fill="black" stroke="black" points="6291.8,-958.52 6288.3,-948.52 6284.8,-958.52 6291.8,-958.52"/>
</g>
<!-- layer3_route_2 -->
<g id="node256" class="node">
<title>layer3_route_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8104.18,-948.17 7337.14,-948.17 7139.82,-782.17 7906.86,-782.17 8104.18,-948.17"/>
<text text-anchor="middle" x="7622" y="-891.47" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="7622" y="-876.47" font-family="Times,serif" font-size="14.00">Experts=[8&#45;11]</text>
<text text-anchor="middle" x="7622" y="-861.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7622" y="-846.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="7622" y="-831.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_2 -->
<g id="edge357" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7622,-984.13C7622,-984.13 7622,-958.45 7622,-958.45"/>
<polygon fill="black" stroke="black" points="7625.5,-958.45 7622,-948.45 7618.5,-958.45 7625.5,-958.45"/>
</g>
<!-- layer3_route_3 -->
<g id="node262" class="node">
<title>layer3_route_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="9795.18,-948.17 9028.14,-948.17 8830.82,-782.17 9597.86,-782.17 9795.18,-948.17"/>
<text text-anchor="middle" x="9313" y="-891.47" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="9313" y="-876.47" font-family="Times,serif" font-size="14.00">Experts=[12&#45;15]</text>
<text text-anchor="middle" x="9313" y="-861.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9313" y="-846.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="9313" y="-831.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_3 -->
<g id="edge366" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7993.25,-1052C8424.18,-1052 9076.45,-1052 9076.45,-1052 9076.45,-1052 9076.45,-958.2 9076.45,-958.2"/>
<polygon fill="black" stroke="black" points="9079.95,-958.2 9076.45,-948.2 9072.95,-958.2 9079.95,-958.2"/>
</g>
<!-- layer3_expert_0 -->
<g id="node245" class="node">
<title>layer3_expert_0</title>
<polygon fill="lightsteelblue" stroke="black" points="3266.5,-746.17 2801.5,-746.17 2801.5,-678.17 3266.5,-678.17 3266.5,-746.17"/>
<text text-anchor="middle" x="3034" y="-730.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="3034" y="-715.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3034" y="-700.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="3034" y="-685.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_route_0&#45;&gt;layer3_expert_0 -->
<g id="edge340" class="edge">
<title>layer3_route_0&#45;&gt;layer3_expert_0</title>
<path fill="none" stroke="black" d="M3616.15,-865C3392.05,-865 3153,-865 3153,-865 3153,-865 3153,-756.47 3153,-756.47"/>
<polygon fill="black" stroke="black" points="3156.5,-756.47 3153,-746.47 3149.5,-756.47 3156.5,-756.47"/>
</g>
<!-- layer3_expert_1 -->
<g id="node246" class="node">
<title>layer3_expert_1</title>
<polygon fill="lightsteelblue" stroke="black" points="3749.5,-746.17 3284.5,-746.17 3284.5,-678.17 3749.5,-678.17 3749.5,-746.17"/>
<text text-anchor="middle" x="3517" y="-730.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3517" y="-715.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3517" y="-700.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="3517" y="-685.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_route_0&#45;&gt;layer3_expert_1 -->
<g id="edge342" class="edge">
<title>layer3_route_0&#45;&gt;layer3_expert_1</title>
<path fill="none" stroke="black" d="M3633.7,-781.95C3633.7,-781.95 3633.7,-756.23 3633.7,-756.23"/>
<polygon fill="black" stroke="black" points="3637.2,-756.23 3633.7,-746.23 3630.2,-756.23 3637.2,-756.23"/>
</g>
<!-- layer3_expert_2 -->
<g id="node247" class="node">
<title>layer3_expert_2</title>
<polygon fill="lightsteelblue" stroke="black" points="4232.5,-746.17 3767.5,-746.17 3767.5,-678.17 4232.5,-678.17 4232.5,-746.17"/>
<text text-anchor="middle" x="4000" y="-730.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4000" y="-715.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4000" y="-700.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="4000" y="-685.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_route_0&#45;&gt;layer3_expert_2 -->
<g id="edge344" class="edge">
<title>layer3_route_0&#45;&gt;layer3_expert_2</title>
<path fill="none" stroke="black" d="M4000,-781.95C4000,-781.95 4000,-756.23 4000,-756.23"/>
<polygon fill="black" stroke="black" points="4003.5,-756.23 4000,-746.23 3996.5,-756.23 4003.5,-756.23"/>
</g>
<!-- layer3_expert_3 -->
<g id="node248" class="node">
<title>layer3_expert_3</title>
<polygon fill="lightsteelblue" stroke="black" points="4715.5,-746.17 4250.5,-746.17 4250.5,-678.17 4715.5,-678.17 4715.5,-746.17"/>
<text text-anchor="middle" x="4483" y="-730.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4483" y="-715.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4483" y="-700.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="4483" y="-685.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_route_0&#45;&gt;layer3_expert_3 -->
<g id="edge346" class="edge">
<title>layer3_route_0&#45;&gt;layer3_expert_3</title>
<path fill="none" stroke="black" d="M4366.3,-850.5C4366.3,-850.5 4366.3,-756.45 4366.3,-756.45"/>
<polygon fill="black" stroke="black" points="4369.8,-756.45 4366.3,-746.45 4362.8,-756.45 4369.8,-756.45"/>
</g>
<!-- layer3_expert_agg_0 -->
<g id="node249" class="node">
<title>layer3_expert_agg_0</title>
<polygon fill="lightyellow" stroke="black" points="4474.67,-642.17 3719.58,-642.17 3525.33,-506.17 4280.42,-506.17 4474.67,-642.17"/>
<text text-anchor="middle" x="4000" y="-592.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4000" y="-577.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="4000" y="-562.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4000" y="-547.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_expert_0&#45;&gt;layer3_expert_agg_0 -->
<g id="edge341" class="edge">
<title>layer3_expert_0&#45;&gt;layer3_expert_agg_0</title>
<path fill="none" stroke="black" d="M3034,-678.01C3034,-637.1 3034,-574 3034,-574 3034,-574 3612.02,-574 3612.02,-574"/>
<polygon fill="black" stroke="black" points="3612.02,-577.5 3622.02,-574 3612.02,-570.5 3612.02,-577.5"/>
</g>
<!-- layer3_expert_1&#45;&gt;layer3_expert_agg_0 -->
<g id="edge343" class="edge">
<title>layer3_expert_1&#45;&gt;layer3_expert_agg_0</title>
<path fill="none" stroke="black" d="M3637.33,-678.05C3637.33,-678.05 3637.33,-594.65 3637.33,-594.65"/>
<polygon fill="black" stroke="black" points="3640.83,-594.65 3637.33,-584.65 3633.83,-594.65 3640.83,-594.65"/>
</g>
<!-- layer3_expert_2&#45;&gt;layer3_expert_agg_0 -->
<g id="edge345" class="edge">
<title>layer3_expert_2&#45;&gt;layer3_expert_agg_0</title>
<path fill="none" stroke="black" d="M4000,-678.05C4000,-678.05 4000,-652.4 4000,-652.4"/>
<polygon fill="black" stroke="black" points="4003.5,-652.4 4000,-642.4 3996.5,-652.4 4003.5,-652.4"/>
</g>
<!-- layer3_expert_3&#45;&gt;layer3_expert_agg_0 -->
<g id="edge347" class="edge">
<title>layer3_expert_3&#45;&gt;layer3_expert_agg_0</title>
<path fill="none" stroke="black" d="M4362.67,-678.05C4362.67,-678.05 4362.67,-652.4 4362.67,-652.4"/>
<polygon fill="black" stroke="black" points="4366.17,-652.4 4362.67,-642.4 4359.17,-652.4 4366.17,-652.4"/>
</g>
<!-- layer3_expert_allreduce -->
<g id="node268" class="node">
<title>layer3_expert_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="8096.67,-470.17 7341.58,-470.17 7147.33,-334.17 7902.42,-334.17 8096.67,-470.17"/>
<text text-anchor="middle" x="7622" y="-420.97" font-family="Times,serif" font-size="14.00">MoE All&#45;Reduce</text>
<text text-anchor="middle" x="7622" y="-405.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7622" y="-390.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7622" y="-375.97" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer3_expert_agg_0&#45;&gt;layer3_expert_allreduce -->
<g id="edge375" class="edge">
<title>layer3_expert_agg_0&#45;&gt;layer3_expert_allreduce</title>
<path fill="none" stroke="black" d="M4000,-505.91C4000,-449.63 4000,-379 4000,-379 4000,-379 7201.36,-379 7201.36,-379"/>
<polygon fill="black" stroke="black" points="7201.36,-382.5 7211.36,-379 7201.36,-375.5 7201.36,-382.5"/>
</g>
<!-- layer3_expert_4 -->
<g id="node251" class="node">
<title>layer3_expert_4</title>
<polygon fill="lightsteelblue" stroke="black" points="5198.5,-746.17 4733.5,-746.17 4733.5,-678.17 5198.5,-678.17 5198.5,-746.17"/>
<text text-anchor="middle" x="4966" y="-730.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="4966" y="-715.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4966" y="-700.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="4966" y="-685.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_route_1&#45;&gt;layer3_expert_4 -->
<g id="edge349" class="edge">
<title>layer3_route_1&#45;&gt;layer3_expert_4</title>
<path fill="none" stroke="black" d="M5548.15,-865C5353.4,-865 5157.5,-865 5157.5,-865 5157.5,-865 5157.5,-756.47 5157.5,-756.47"/>
<polygon fill="black" stroke="black" points="5161,-756.47 5157.5,-746.47 5154,-756.47 5161,-756.47"/>
</g>
<!-- layer3_expert_5 -->
<g id="node252" class="node">
<title>layer3_expert_5</title>
<polygon fill="lightsteelblue" stroke="black" points="5681.5,-746.17 5216.5,-746.17 5216.5,-678.17 5681.5,-678.17 5681.5,-746.17"/>
<text text-anchor="middle" x="5449" y="-730.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="5449" y="-715.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5449" y="-700.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="5449" y="-685.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_route_1&#45;&gt;layer3_expert_5 -->
<g id="edge351" class="edge">
<title>layer3_route_1&#45;&gt;layer3_expert_5</title>
<path fill="none" stroke="black" d="M5565.7,-781.95C5565.7,-781.95 5565.7,-756.23 5565.7,-756.23"/>
<polygon fill="black" stroke="black" points="5569.2,-756.23 5565.7,-746.23 5562.2,-756.23 5569.2,-756.23"/>
</g>
<!-- layer3_expert_6 -->
<g id="node253" class="node">
<title>layer3_expert_6</title>
<polygon fill="lightsteelblue" stroke="black" points="6164.5,-746.17 5699.5,-746.17 5699.5,-678.17 6164.5,-678.17 6164.5,-746.17"/>
<text text-anchor="middle" x="5932" y="-730.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5932" y="-715.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5932" y="-700.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="5932" y="-685.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_route_1&#45;&gt;layer3_expert_6 -->
<g id="edge353" class="edge">
<title>layer3_route_1&#45;&gt;layer3_expert_6</title>
<path fill="none" stroke="black" d="M5932,-781.95C5932,-781.95 5932,-756.23 5932,-756.23"/>
<polygon fill="black" stroke="black" points="5935.5,-756.23 5932,-746.23 5928.5,-756.23 5935.5,-756.23"/>
</g>
<!-- layer3_expert_7 -->
<g id="node254" class="node">
<title>layer3_expert_7</title>
<polygon fill="lightsteelblue" stroke="black" points="6647.5,-746.17 6182.5,-746.17 6182.5,-678.17 6647.5,-678.17 6647.5,-746.17"/>
<text text-anchor="middle" x="6415" y="-730.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="6415" y="-715.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6415" y="-700.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="6415" y="-685.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_route_1&#45;&gt;layer3_expert_7 -->
<g id="edge355" class="edge">
<title>layer3_route_1&#45;&gt;layer3_expert_7</title>
<path fill="none" stroke="black" d="M6298.3,-850.5C6298.3,-850.5 6298.3,-756.45 6298.3,-756.45"/>
<polygon fill="black" stroke="black" points="6301.8,-756.45 6298.3,-746.45 6294.8,-756.45 6301.8,-756.45"/>
</g>
<!-- layer3_expert_agg_1 -->
<g id="node255" class="node">
<title>layer3_expert_agg_1</title>
<polygon fill="lightyellow" stroke="black" points="6406.67,-642.17 5651.58,-642.17 5457.33,-506.17 6212.42,-506.17 6406.67,-642.17"/>
<text text-anchor="middle" x="5932" y="-592.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5932" y="-577.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="5932" y="-562.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5932" y="-547.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_expert_4&#45;&gt;layer3_expert_agg_1 -->
<g id="edge350" class="edge">
<title>layer3_expert_4&#45;&gt;layer3_expert_agg_1</title>
<path fill="none" stroke="black" d="M4966,-678.01C4966,-637.1 4966,-574 4966,-574 4966,-574 5544.02,-574 5544.02,-574"/>
<polygon fill="black" stroke="black" points="5544.02,-577.5 5554.02,-574 5544.02,-570.5 5544.02,-577.5"/>
</g>
<!-- layer3_expert_5&#45;&gt;layer3_expert_agg_1 -->
<g id="edge352" class="edge">
<title>layer3_expert_5&#45;&gt;layer3_expert_agg_1</title>
<path fill="none" stroke="black" d="M5569.33,-678.05C5569.33,-678.05 5569.33,-594.65 5569.33,-594.65"/>
<polygon fill="black" stroke="black" points="5572.83,-594.65 5569.33,-584.65 5565.83,-594.65 5572.83,-594.65"/>
</g>
<!-- layer3_expert_6&#45;&gt;layer3_expert_agg_1 -->
<g id="edge354" class="edge">
<title>layer3_expert_6&#45;&gt;layer3_expert_agg_1</title>
<path fill="none" stroke="black" d="M5932,-678.05C5932,-678.05 5932,-652.4 5932,-652.4"/>
<polygon fill="black" stroke="black" points="5935.5,-652.4 5932,-642.4 5928.5,-652.4 5935.5,-652.4"/>
</g>
<!-- layer3_expert_7&#45;&gt;layer3_expert_agg_1 -->
<g id="edge356" class="edge">
<title>layer3_expert_7&#45;&gt;layer3_expert_agg_1</title>
<path fill="none" stroke="black" d="M6294.67,-678.05C6294.67,-678.05 6294.67,-652.4 6294.67,-652.4"/>
<polygon fill="black" stroke="black" points="6298.17,-652.4 6294.67,-642.4 6291.17,-652.4 6298.17,-652.4"/>
</g>
<!-- layer3_expert_agg_1&#45;&gt;layer3_expert_allreduce -->
<g id="edge376" class="edge">
<title>layer3_expert_agg_1&#45;&gt;layer3_expert_allreduce</title>
<path fill="none" stroke="black" d="M5932,-506.11C5932,-466.38 5932,-424 5932,-424 5932,-424 7265.41,-424 7265.41,-424"/>
<polygon fill="black" stroke="black" points="7265.41,-427.5 7275.41,-424 7265.41,-420.5 7265.41,-427.5"/>
</g>
<!-- layer3_expert_8 -->
<g id="node257" class="node">
<title>layer3_expert_8</title>
<polygon fill="lightsteelblue" stroke="black" points="7130.5,-746.17 6665.5,-746.17 6665.5,-678.17 7130.5,-678.17 7130.5,-746.17"/>
<text text-anchor="middle" x="6898" y="-730.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="6898" y="-715.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6898" y="-700.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="6898" y="-685.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_route_2&#45;&gt;layer3_expert_8 -->
<g id="edge358" class="edge">
<title>layer3_route_2&#45;&gt;layer3_expert_8</title>
<path fill="none" stroke="black" d="M7143.54,-865.06C7143.54,-860.42 7143.54,-712 7143.54,-712 7143.54,-712 7140.68,-712 7140.68,-712"/>
<polygon fill="black" stroke="black" points="7140.68,-708.5 7130.68,-712 7140.68,-715.5 7140.68,-708.5"/>
</g>
<!-- layer3_expert_9 -->
<g id="node258" class="node">
<title>layer3_expert_9</title>
<polygon fill="lightsteelblue" stroke="black" points="7613.5,-746.17 7148.5,-746.17 7148.5,-678.17 7613.5,-678.17 7613.5,-746.17"/>
<text text-anchor="middle" x="7381" y="-730.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="7381" y="-715.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7381" y="-700.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="7381" y="-685.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_route_2&#45;&gt;layer3_expert_9 -->
<g id="edge360" class="edge">
<title>layer3_route_2&#45;&gt;layer3_expert_9</title>
<path fill="none" stroke="black" d="M7381,-781.95C7381,-781.95 7381,-756.23 7381,-756.23"/>
<polygon fill="black" stroke="black" points="7384.5,-756.23 7381,-746.23 7377.5,-756.23 7384.5,-756.23"/>
</g>
<!-- layer3_expert_10 -->
<g id="node259" class="node">
<title>layer3_expert_10</title>
<polygon fill="lightsteelblue" stroke="black" points="8096.5,-746.17 7631.5,-746.17 7631.5,-678.17 8096.5,-678.17 8096.5,-746.17"/>
<text text-anchor="middle" x="7864" y="-730.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="7864" y="-715.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7864" y="-700.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="7864" y="-685.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_route_2&#45;&gt;layer3_expert_10 -->
<g id="edge362" class="edge">
<title>layer3_route_2&#45;&gt;layer3_expert_10</title>
<path fill="none" stroke="black" d="M7864,-781.95C7864,-781.95 7864,-756.23 7864,-756.23"/>
<polygon fill="black" stroke="black" points="7867.5,-756.23 7864,-746.23 7860.5,-756.23 7867.5,-756.23"/>
</g>
<!-- layer3_expert_11 -->
<g id="node260" class="node">
<title>layer3_expert_11</title>
<polygon fill="lightsteelblue" stroke="black" points="8579.5,-746.17 8114.5,-746.17 8114.5,-678.17 8579.5,-678.17 8579.5,-746.17"/>
<text text-anchor="middle" x="8347" y="-730.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="8347" y="-715.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8347" y="-700.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="8347" y="-685.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_route_2&#45;&gt;layer3_expert_11 -->
<g id="edge364" class="edge">
<title>layer3_route_2&#45;&gt;layer3_expert_11</title>
<path fill="none" stroke="black" d="M8100.46,-865.06C8100.46,-860.42 8100.46,-712 8100.46,-712 8100.46,-712 8104.42,-712 8104.42,-712"/>
<polygon fill="black" stroke="black" points="8104.42,-715.5 8114.42,-712 8104.42,-708.5 8104.42,-715.5"/>
</g>
<!-- layer3_expert_agg_2 -->
<g id="node261" class="node">
<title>layer3_expert_agg_2</title>
<polygon fill="lightyellow" stroke="black" points="8096.67,-642.17 7341.58,-642.17 7147.33,-506.17 7902.42,-506.17 8096.67,-642.17"/>
<text text-anchor="middle" x="7622" y="-592.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7622" y="-577.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="7622" y="-562.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7622" y="-547.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_expert_8&#45;&gt;layer3_expert_agg_2 -->
<g id="edge359" class="edge">
<title>layer3_expert_8&#45;&gt;layer3_expert_agg_2</title>
<path fill="none" stroke="black" d="M6898,-678.01C6898,-637.1 6898,-574 6898,-574 6898,-574 7234.1,-574 7234.1,-574"/>
<polygon fill="black" stroke="black" points="7234.1,-577.5 7244.1,-574 7234.1,-570.5 7234.1,-577.5"/>
</g>
<!-- layer3_expert_9&#45;&gt;layer3_expert_agg_2 -->
<g id="edge361" class="edge">
<title>layer3_expert_9&#45;&gt;layer3_expert_agg_2</title>
<path fill="none" stroke="black" d="M7381,-678.05C7381,-678.05 7381,-652.4 7381,-652.4"/>
<polygon fill="black" stroke="black" points="7384.5,-652.4 7381,-642.4 7377.5,-652.4 7384.5,-652.4"/>
</g>
<!-- layer3_expert_10&#45;&gt;layer3_expert_agg_2 -->
<g id="edge363" class="edge">
<title>layer3_expert_10&#45;&gt;layer3_expert_agg_2</title>
<path fill="none" stroke="black" d="M7864,-678.05C7864,-678.05 7864,-652.4 7864,-652.4"/>
<polygon fill="black" stroke="black" points="7867.5,-652.4 7864,-642.4 7860.5,-652.4 7867.5,-652.4"/>
</g>
<!-- layer3_expert_11&#45;&gt;layer3_expert_agg_2 -->
<g id="edge365" class="edge">
<title>layer3_expert_11&#45;&gt;layer3_expert_agg_2</title>
<path fill="none" stroke="black" d="M8312.25,-678.01C8312.25,-637.1 8312.25,-574 8312.25,-574 8312.25,-574 8009.44,-574 8009.44,-574"/>
<polygon fill="black" stroke="black" points="8009.44,-570.5 7999.44,-574 8009.44,-577.5 8009.44,-570.5"/>
</g>
<!-- layer3_expert_agg_2&#45;&gt;layer3_expert_allreduce -->
<g id="edge377" class="edge">
<title>layer3_expert_agg_2&#45;&gt;layer3_expert_allreduce</title>
<path fill="none" stroke="black" d="M7622,-505.69C7622,-505.69 7622,-480.4 7622,-480.4"/>
<polygon fill="black" stroke="black" points="7625.5,-480.4 7622,-470.4 7618.5,-480.4 7625.5,-480.4"/>
</g>
<!-- layer3_expert_12 -->
<g id="node263" class="node">
<title>layer3_expert_12</title>
<polygon fill="lightsteelblue" stroke="black" points="9062.5,-746.17 8597.5,-746.17 8597.5,-678.17 9062.5,-678.17 9062.5,-746.17"/>
<text text-anchor="middle" x="8830" y="-730.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="8830" y="-715.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8830" y="-700.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="8830" y="-685.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_route_3&#45;&gt;layer3_expert_12 -->
<g id="edge367" class="edge">
<title>layer3_route_3&#45;&gt;layer3_expert_12</title>
<path fill="none" stroke="black" d="M8946.7,-781.95C8946.7,-781.95 8946.7,-756.23 8946.7,-756.23"/>
<polygon fill="black" stroke="black" points="8950.2,-756.23 8946.7,-746.23 8943.2,-756.23 8950.2,-756.23"/>
</g>
<!-- layer3_expert_13 -->
<g id="node264" class="node">
<title>layer3_expert_13</title>
<polygon fill="lightsteelblue" stroke="black" points="9545.5,-746.17 9080.5,-746.17 9080.5,-678.17 9545.5,-678.17 9545.5,-746.17"/>
<text text-anchor="middle" x="9313" y="-730.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="9313" y="-715.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9313" y="-700.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="9313" y="-685.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_route_3&#45;&gt;layer3_expert_13 -->
<g id="edge369" class="edge">
<title>layer3_route_3&#45;&gt;layer3_expert_13</title>
<path fill="none" stroke="black" d="M9313,-781.95C9313,-781.95 9313,-756.23 9313,-756.23"/>
<polygon fill="black" stroke="black" points="9316.5,-756.23 9313,-746.23 9309.5,-756.23 9316.5,-756.23"/>
</g>
<!-- layer3_expert_14 -->
<g id="node265" class="node">
<title>layer3_expert_14</title>
<polygon fill="lightsteelblue" stroke="black" points="10028.5,-746.17 9563.5,-746.17 9563.5,-678.17 10028.5,-678.17 10028.5,-746.17"/>
<text text-anchor="middle" x="9796" y="-730.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="9796" y="-715.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9796" y="-700.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="9796" y="-685.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_route_3&#45;&gt;layer3_expert_14 -->
<g id="edge371" class="edge">
<title>layer3_route_3&#45;&gt;layer3_expert_14</title>
<path fill="none" stroke="black" d="M9679.3,-850.5C9679.3,-850.5 9679.3,-756.45 9679.3,-756.45"/>
<polygon fill="black" stroke="black" points="9682.8,-756.45 9679.3,-746.45 9675.8,-756.45 9682.8,-756.45"/>
</g>
<!-- layer3_expert_15 -->
<g id="node266" class="node">
<title>layer3_expert_15</title>
<polygon fill="lightsteelblue" stroke="black" points="10511.5,-746.17 10046.5,-746.17 10046.5,-678.17 10511.5,-678.17 10511.5,-746.17"/>
<text text-anchor="middle" x="10279" y="-730.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="10279" y="-715.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10279" y="-700.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="10279" y="-685.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_route_3&#45;&gt;layer3_expert_15 -->
<g id="edge373" class="edge">
<title>layer3_route_3&#45;&gt;layer3_expert_15</title>
<path fill="none" stroke="black" d="M9696.52,-865C9966.15,-865 10279,-865 10279,-865 10279,-865 10279,-756.47 10279,-756.47"/>
<polygon fill="black" stroke="black" points="10282.5,-756.47 10279,-746.47 10275.5,-756.47 10282.5,-756.47"/>
</g>
<!-- layer3_expert_agg_3 -->
<g id="node267" class="node">
<title>layer3_expert_agg_3</title>
<polygon fill="lightyellow" stroke="black" points="9787.67,-642.17 9032.58,-642.17 8838.33,-506.17 9593.42,-506.17 9787.67,-642.17"/>
<text text-anchor="middle" x="9313" y="-592.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9313" y="-577.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, expert_dim=16384]</text>
<text text-anchor="middle" x="9313" y="-562.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9313" y="-547.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_expert_12&#45;&gt;layer3_expert_agg_3 -->
<g id="edge368" class="edge">
<title>layer3_expert_12&#45;&gt;layer3_expert_agg_3</title>
<path fill="none" stroke="black" d="M8950.33,-678.05C8950.33,-678.05 8950.33,-594.65 8950.33,-594.65"/>
<polygon fill="black" stroke="black" points="8953.83,-594.65 8950.33,-584.65 8946.83,-594.65 8953.83,-594.65"/>
</g>
<!-- layer3_expert_13&#45;&gt;layer3_expert_agg_3 -->
<g id="edge370" class="edge">
<title>layer3_expert_13&#45;&gt;layer3_expert_agg_3</title>
<path fill="none" stroke="black" d="M9313,-678.05C9313,-678.05 9313,-652.4 9313,-652.4"/>
<polygon fill="black" stroke="black" points="9316.5,-652.4 9313,-642.4 9309.5,-652.4 9316.5,-652.4"/>
</g>
<!-- layer3_expert_14&#45;&gt;layer3_expert_agg_3 -->
<g id="edge372" class="edge">
<title>layer3_expert_14&#45;&gt;layer3_expert_agg_3</title>
<path fill="none" stroke="black" d="M9675.67,-678.05C9675.67,-678.05 9675.67,-652.4 9675.67,-652.4"/>
<polygon fill="black" stroke="black" points="9679.17,-652.4 9675.67,-642.4 9672.17,-652.4 9679.17,-652.4"/>
</g>
<!-- layer3_expert_15&#45;&gt;layer3_expert_agg_3 -->
<g id="edge374" class="edge">
<title>layer3_expert_15&#45;&gt;layer3_expert_agg_3</title>
<path fill="none" stroke="black" d="M10279,-678.01C10279,-637.1 10279,-574 10279,-574 10279,-574 9700.63,-574 9700.63,-574"/>
<polygon fill="black" stroke="black" points="9700.63,-570.5 9690.63,-574 9700.63,-577.5 9700.63,-570.5"/>
</g>
<!-- layer3_expert_agg_3&#45;&gt;layer3_expert_allreduce -->
<g id="edge378" class="edge">
<title>layer3_expert_agg_3&#45;&gt;layer3_expert_allreduce</title>
<path fill="none" stroke="black" d="M9132.08,-506.11C9132.08,-466.38 9132.08,-424 9132.08,-424 9132.08,-424 8041.15,-424 8041.15,-424"/>
<polygon fill="black" stroke="black" points="8041.15,-420.5 8031.15,-424 8041.15,-427.5 8041.15,-420.5"/>
</g>
<!-- layer3_expert_allreduce&#45;&gt;layer3_residual2 -->
<g id="edge379" class="edge">
<title>layer3_expert_allreduce&#45;&gt;layer3_residual2</title>
<path fill="none" stroke="black" d="M7966.58,-379C8228.74,-379 8544.75,-379 8544.75,-379 8544.75,-379 8544.75,-231.79 8544.75,-231.79"/>
<polygon fill="black" stroke="black" points="8548.25,-231.79 8544.75,-221.79 8541.25,-231.79 8548.25,-231.79"/>
</g>
<!-- output -->
<g id="node270" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="8968" cy="-48.08" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="8968" y="-66.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="8968" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8968" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8968" y="-21.88" font-family="Times,serif" font-size="14.00">GPUs: all GPUs</text>
</g>
<!-- layer3_residual2&#45;&gt;output -->
<g id="edge381" class="edge">
<title>layer3_residual2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M8968,-132.11C8968,-132.11 8968,-106.28 8968,-106.28"/>
<polygon fill="black" stroke="black" points="8971.5,-106.28 8968,-96.28 8964.5,-106.28 8971.5,-106.28"/>
</g>
</g>
</svg>
