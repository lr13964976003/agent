digraph baseline_model_dag {
	graph [bb="0,0,25217,3154",
		rankdir=TB,
		size="30,40",
		splines=ortho
	];
	node [fillcolor=lightgray,
		fontname=Arial,
		fontsize=10,
		label="\N",
		shape=diamond,
		style=filled
	];
	subgraph cluster_embedding {
		graph [bb="6670,2965,11772,3110",
			fontsize=12,
			label="Embedding Layer (Pipeline Stage 0, TP=8)",
			lheight=0.18,
			lp="9221,3099.5",
			lwidth=3.60,
			style=rounded
		];
		embed_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Token Embedding</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, vocab=32000]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="6988,3063",
			shape=rectangle,
			width=8.6111];
		pos_enc_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Positional Encoding</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="6988,2991",
			shape=rectangle,
			width=8.6111];
		embed_0 -> pos_enc_0	[pos="e,6988,3009.4 6988,3044.8 6988,3044.8 6988,3019.4 6988,3019.4"];
		embed_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Token Embedding</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, vocab=32000]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="7626,3063",
			shape=rectangle,
			width=8.6111];
		pos_enc_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Positional Encoding</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="7626,2991",
			shape=rectangle,
			width=8.6111];
		embed_1 -> pos_enc_1	[pos="e,7626,3009.4 7626,3044.8 7626,3044.8 7626,3019.4 7626,3019.4"];
		embed_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Token Embedding</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, vocab=32000]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="8264,3063",
			shape=rectangle,
			width=8.6111];
		pos_enc_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Positional Encoding</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="8264,2991",
			shape=rectangle,
			width=8.6111];
		embed_2 -> pos_enc_2	[pos="e,8264,3009.4 8264,3044.8 8264,3044.8 8264,3019.4 8264,3019.4"];
		embed_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Token Embedding</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, vocab=32000]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="8902,3063",
			shape=rectangle,
			width=8.6111];
		pos_enc_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Positional Encoding</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="8902,2991",
			shape=rectangle,
			width=8.6111];
		embed_3 -> pos_enc_3	[pos="e,8902,3009.4 8902,3044.8 8902,3044.8 8902,3019.4 8902,3019.4"];
		embed_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Token Embedding</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, vocab=32000]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9540,3063",
			shape=rectangle,
			width=8.6111];
		pos_enc_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Positional Encoding</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9540,2991",
			shape=rectangle,
			width=8.6111];
		embed_4 -> pos_enc_4	[pos="e,9540,3009.4 9540,3044.8 9540,3044.8 9540,3019.4 9540,3019.4"];
		embed_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Token Embedding</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, vocab=32000]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10178,3063",
			shape=rectangle,
			width=8.6111];
		pos_enc_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Positional Encoding</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10178,2991",
			shape=rectangle,
			width=8.6111];
		embed_5 -> pos_enc_5	[pos="e,10178,3009.4 10178,3044.8 10178,3044.8 10178,3019.4 10178,3019.4"];
		embed_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Token Embedding</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, vocab=32000]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10816,3063",
			shape=rectangle,
			width=8.6111];
		pos_enc_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Positional Encoding</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10816,2991",
			shape=rectangle,
			width=8.6111];
		embed_6 -> pos_enc_6	[pos="e,10816,3009.4 10816,3044.8 10816,3044.8 10816,3019.4 10816,3019.4"];
		embed_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Token Embedding</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, vocab=32000]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11454,3063",
			shape=rectangle,
			width=8.6111];
		pos_enc_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Positional Encoding</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11454,2991",
			shape=rectangle,
			width=8.6111];
		embed_7 -> pos_enc_7	[pos="e,11454,3009.4 11454,3044.8 11454,3044.8 11454,3019.4 11454,3019.4"];
	}
	subgraph cluster_layer0 {
		graph [bb="8,2308,15262,2957",
			fontsize=12,
			label="Layer 0 (Pipeline Stage 0, TP=8)",
			lheight=0.18,
			lp="7635,2946.5",
			lwidth=2.76,
			style=rounded
		];
		l0_q_proj_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="1596,2910",
			shape=rectangle,
			width=8.5833];
		l0_attn_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_0<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="1278,2838",
			shape=rectangle,
			width=9.5833];
		l0_q_proj_0 -> l0_attn_0	[pos="e,1455,2856.4 1455,2891.8 1455,2891.8 1455,2866.4 1455,2866.4"];
		l0_k_proj_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="960,2910",
			shape=rectangle,
			width=8.5694];
		l0_k_proj_0 -> l0_attn_0	[pos="e,1100.8,2856.4 1100.8,2891.8 1100.8,2891.8 1100.8,2866.4 1100.8,2866.4"];
		l0_v_proj_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="325,2910",
			shape=rectangle,
			width=8.5694];
		l0_v_proj_0 -> l0_attn_0	[pos="e,932.97,2838 456,2891.8 456,2870.5 456,2838 456,2838 456,2838 922.97,2838 922.97,2838"];
		l0_out_proj_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="1584,2766",
			shape=rectangle,
			width=8.8889];
		l0_attn_0 -> l0_out_proj_0	[pos="e,1443.5,2784.4 1443.5,2819.8 1443.5,2819.8 1443.5,2794.4 1443.5,2794.4"];
		l0_res_0	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="7030,2694",
			width=14.06];
		l0_out_proj_0 -> l0_res_0	[pos="e,6523.8,2694 1732.2,2747.8 1732.2,2726.5 1732.2,2694 1732.2,2694 1732.2,2694 6513.8,2694 6513.8,2694"];
		l0_ln1_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="7030,2622",
			shape=rectangle,
			width=8.2361];
		l0_res_0 -> l0_ln1_0	[pos="e,7030,2640.4 7030,2675.8 7030,2675.8 7030,2650.4 7030,2650.4"];
		l0_ffn_up_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="7015,2550",
			shape=rectangle,
			width=8.6528];
		l0_ln1_0 -> l0_ffn_up_0	[pos="e,7030,2568.4 7030,2603.8 7030,2603.8 7030,2578.4 7030,2578.4"];
		l0_res2_0	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="7345,2406",
			width=14.268];
		l0_ln1_0 -> l0_res2_0	[pos="e,7433.1,2421.2 7326.6,2622 7387.3,2622 7433.1,2622 7433.1,2622 7433.1,2622 7433.1,2431.2 7433.1,2431.2"];
		l0_ffn_down_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="7012,2478",
			shape=rectangle,
			width=8.8333];
		l0_ffn_up_0 -> l0_ffn_down_0	[pos="e,7015,2496.4 7015,2531.8 7015,2531.8 7015,2506.4 7015,2506.4"];
		l0_ffn_down_0 -> l0_res2_0	[pos="e,7080.7,2415 7080.7,2459.8 7080.7,2459.8 7080.7,2425 7080.7,2425"];
		l0_ln2_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="7616,2334",
			shape=rectangle,
			width=8.2361];
		l0_res2_0 -> l0_ln2_0	[pos="e,7589.1,2352.1 7589.1,2396.3 7589.1,2396.3 7589.1,2362.1 7589.1,2362.1"];
		l0_q_proj_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="3503,2910",
			shape=rectangle,
			width=8.5833];
		l0_attn_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_1<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="3185,2838",
			shape=rectangle,
			width=9.5833];
		l0_q_proj_1 -> l0_attn_1	[pos="e,3362,2856.4 3362,2891.8 3362,2891.8 3362,2866.4 3362,2866.4"];
		l0_k_proj_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="2867,2910",
			shape=rectangle,
			width=8.5694];
		l0_k_proj_1 -> l0_attn_1	[pos="e,3007.8,2856.4 3007.8,2891.8 3007.8,2891.8 3007.8,2866.4 3007.8,2866.4"];
		l0_v_proj_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="2232,2910",
			shape=rectangle,
			width=8.5694];
		l0_v_proj_1 -> l0_attn_1	[pos="e,2839.8,2838 2371,2891.8 2371,2870.5 2371,2838 2371,2838 2371,2838 2829.8,2838 2829.8,2838"];
		l0_out_proj_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="5714,2766",
			shape=rectangle,
			width=8.8889];
		l0_attn_1 -> l0_out_proj_1	[pos="e,5394,2766 3501,2819.8 3501,2798.5 3501,2766 3501,2766 3501,2766 5384,2766 5384,2766"];
		l0_res_1	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="8165,2694",
			width=14.06];
		l0_out_proj_1 -> l0_res_1	[pos="e,7859.7,2701.3 6034.1,2760 6632.2,2760 7859.7,2760 7859.7,2760 7859.7,2760 7859.7,2711.3 7859.7,2711.3"];
		l0_ln1_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="8165,2622",
			shape=rectangle,
			width=8.2361];
		l0_res_1 -> l0_ln1_1	[pos="e,8165,2640.4 8165,2675.8 8165,2675.8 8165,2650.4 8165,2650.4"];
		l0_ffn_up_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="8060,2550",
			shape=rectangle,
			width=8.6528];
		l0_ln1_1 -> l0_ffn_up_1	[pos="e,8120,2568.4 8120,2603.8 8120,2603.8 8120,2578.4 8120,2578.4"];
		l0_res2_1	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="8390,2406",
			width=14.268];
		l0_ln1_1 -> l0_res2_1	[pos="e,8418.2,2423.2 8418.2,2604 8418.2,2604 8418.2,2433.2 8418.2,2433.2"];
		l0_ffn_down_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="8057,2478",
			shape=rectangle,
			width=8.8333];
		l0_ffn_up_1 -> l0_ffn_down_1	[pos="e,8060,2496.4 8060,2531.8 8060,2531.8 8060,2506.4 8060,2506.4"];
		l0_ffn_down_1 -> l0_res2_1	[pos="e,8125.7,2415 8125.7,2459.8 8125.7,2459.8 8125.7,2425 8125.7,2425"];
		l0_ln2_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="8878,2334",
			shape=rectangle,
			width=8.2361];
		l0_res2_1 -> l0_ln2_1	[pos="e,8742.6,2352 8742.6,2400.4 8742.6,2400.4 8742.6,2362 8742.6,2362"];
		l0_q_proj_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="5410,2910",
			shape=rectangle,
			width=8.5833];
		l0_attn_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_2<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="5092,2838",
			shape=rectangle,
			width=9.5833];
		l0_q_proj_2 -> l0_attn_2	[pos="e,5269,2856.4 5269,2891.8 5269,2891.8 5269,2866.4 5269,2866.4"];
		l0_k_proj_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="4774,2910",
			shape=rectangle,
			width=8.5694];
		l0_k_proj_2 -> l0_attn_2	[pos="e,4914.8,2856.4 4914.8,2891.8 4914.8,2891.8 4914.8,2866.4 4914.8,2866.4"];
		l0_v_proj_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="4139,2910",
			shape=rectangle,
			width=8.5694];
		l0_v_proj_2 -> l0_attn_2	[pos="e,4746.9,2838 4277.5,2891.8 4277.5,2870.5 4277.5,2838 4277.5,2838 4277.5,2838 4736.9,2838 4736.9,2838"];
		l0_out_proj_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="8926,2766",
			shape=rectangle,
			width=8.8889];
		l0_attn_2 -> l0_out_proj_2	[pos="e,8605.9,2772 5437.3,2832 5839.1,2832 6448.2,2832 6448.2,2832 6448.2,2832 6448.2,2772 6448.2,2772 6448.2,2772 8595.9,2772 8595.9,\
2772"];
		l0_res_2	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9204,2694",
			width=14.06];
		l0_out_proj_2 -> l0_res_2	[pos="e,9063.3,2707.2 9063.3,2747.8 9063.3,2747.8 9063.3,2717.2 9063.3,2717.2"];
		l0_ln1_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9204,2622",
			shape=rectangle,
			width=8.2361];
		l0_res_2 -> l0_ln1_2	[pos="e,9204,2640.4 9204,2675.8 9204,2675.8 9204,2650.4 9204,2650.4"];
		l0_ffn_up_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="9118,2550",
			shape=rectangle,
			width=8.6528];
		l0_ln1_2 -> l0_ffn_up_2	[pos="e,9168.5,2568.4 9168.5,2603.8 9168.5,2603.8 9168.5,2578.4 9168.5,2578.4"];
		l0_res2_2	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9435,2406",
			width=14.268];
		l0_ln1_2 -> l0_res2_2	[pos="e,9466.8,2422.9 9466.8,2604 9466.8,2604 9466.8,2432.9 9466.8,2432.9"];
		l0_ffn_down_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9115,2478",
			shape=rectangle,
			width=8.8333];
		l0_ffn_up_2 -> l0_ffn_down_2	[pos="e,9118,2496.4 9118,2531.8 9118,2531.8 9118,2506.4 9118,2506.4"];
		l0_ffn_down_2 -> l0_res2_2	[pos="e,9177.2,2415.3 9177.2,2459.8 9177.2,2459.8 9177.2,2425.3 9177.2,2425.3"];
		l0_ln2_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9814,2334",
			shape=rectangle,
			width=8.2361];
		l0_res2_2 -> l0_ln2_2	[pos="e,9733.1,2352 9733.1,2398.3 9733.1,2398.3 9733.1,2362 9733.1,2362"];
		l0_q_proj_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="7317,2910",
			shape=rectangle,
			width=8.5833];
		l0_attn_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_3<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="6999,2838",
			shape=rectangle,
			width=9.5833];
		l0_q_proj_3 -> l0_attn_3	[pos="e,7176,2856.4 7176,2891.8 7176,2891.8 7176,2866.4 7176,2866.4"];
		l0_k_proj_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="6681,2910",
			shape=rectangle,
			width=8.5694];
		l0_k_proj_3 -> l0_attn_3	[pos="e,6821.8,2856.4 6821.8,2891.8 6821.8,2891.8 6821.8,2866.4 6821.8,2866.4"];
		l0_v_proj_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="6046,2910",
			shape=rectangle,
			width=8.5694];
		l0_v_proj_3 -> l0_attn_3	[pos="e,6653.9,2844 6194.2,2892 6194.2,2872.4 6194.2,2844 6194.2,2844 6194.2,2844 6643.9,2844 6643.9,2844"];
		l0_out_proj_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="9890,2766",
			shape=rectangle,
			width=8.8889];
		l0_attn_3 -> l0_out_proj_3	[pos="e,9640.1,2747.8 6999,2819.8 6999,2791.3 6999,2739 6999,2739 6999,2739 9640.1,2739 9640.1,2739 9640.1,2739 9640.1,2739.9 9640.1,2739.9"];
		l0_res_3	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10405,2694",
			width=14.06];
		l0_out_proj_3 -> l0_res_3	[pos="e,10054,2699.7 10054,2747.8 10054,2747.8 10054,2709.7 10054,2709.7"];
		l0_ln1_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10405,2622",
			shape=rectangle,
			width=8.2361];
		l0_res_3 -> l0_ln1_3	[pos="e,10405,2640.4 10405,2675.8 10405,2675.8 10405,2650.4 10405,2650.4"];
		l0_ffn_up_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="10318,2550",
			shape=rectangle,
			width=8.6528];
		l0_ln1_3 -> l0_ffn_up_3	[pos="e,10369,2568.4 10369,2603.8 10369,2603.8 10369,2578.4 10369,2578.4"];
		l0_res2_3	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10480,2406",
			width=14.268];
		l0_ln1_3 -> l0_res2_3	[pos="e,10667,2417.7 10667,2604 10667,2604 10667,2427.7 10667,2427.7"];
		l0_ffn_down_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10314,2478",
			shape=rectangle,
			width=8.8333];
		l0_ffn_up_3 -> l0_ffn_down_3	[pos="e,10318,2496.4 10318,2531.8 10318,2531.8 10318,2506.4 10318,2506.4"];
		l0_ffn_down_3 -> l0_res2_3	[pos="e,10314,2418.3 10314,2459.8 10314,2459.8 10314,2428.3 10314,2428.3"];
		l0_ln2_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10588,2334",
			shape=rectangle,
			width=8.2361];
		l0_res2_3 -> l0_ln2_3	[pos="e,10588,2352 10588,2391.8 10588,2391.8 10588,2362 10588,2362"];
		l0_q_proj_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="9224,2910",
			shape=rectangle,
			width=8.5833];
		l0_attn_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_4<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="8906,2838",
			shape=rectangle,
			width=9.5833];
		l0_q_proj_4 -> l0_attn_4	[pos="e,9083,2856.4 9083,2891.8 9083,2891.8 9083,2866.4 9083,2866.4"];
		l0_k_proj_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="8588,2910",
			shape=rectangle,
			width=8.5694];
		l0_k_proj_4 -> l0_attn_4	[pos="e,8728.8,2856.4 8728.8,2891.8 8728.8,2891.8 8728.8,2866.4 8728.8,2866.4"];
		l0_v_proj_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="7953,2910",
			shape=rectangle,
			width=8.5694];
		l0_v_proj_4 -> l0_attn_4	[pos="e,8560.9,2838 8060.6,2891.8 8060.6,2870.5 8060.6,2838 8060.6,2838 8060.6,2838 8550.9,2838 8550.9,2838"];
		l0_out_proj_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="11018,2766",
			shape=rectangle,
			width=8.8889];
		l0_attn_4 -> l0_out_proj_4	[pos="e,10698,2766 9251.4,2832 9663,2832 10296,2832 10296,2832 10296,2832 10296,2766 10296,2766 10296,2766 10688,2766 10688,2766"];
		l0_res_4	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11452,2694",
			width=14.06];
		l0_out_proj_4 -> l0_res_4	[pos="e,11207,2703.3 11207,2747.8 11207,2747.8 11207,2713.3 11207,2713.3"];
		l0_ln1_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11452,2622",
			shape=rectangle,
			width=8.2361];
		l0_res_4 -> l0_ln1_4	[pos="e,11452,2640.4 11452,2675.8 11452,2675.8 11452,2650.4 11452,2650.4"];
		l0_ffn_up_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="11203,2550",
			shape=rectangle,
			width=8.6528];
		l0_ln1_4 -> l0_ffn_up_4	[pos="e,11335,2568.4 11335,2603.8 11335,2603.8 11335,2578.4 11335,2578.4"];
		l0_res2_4	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11525,2406",
			width=14.268];
		l0_ln1_4 -> l0_res2_4	[pos="e,11633,2420.4 11633,2604 11633,2604 11633,2430.4 11633,2430.4"];
		l0_ffn_down_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11200,2478",
			shape=rectangle,
			width=8.8333];
		l0_ffn_up_4 -> l0_ffn_down_4	[pos="e,11203,2496.4 11203,2531.8 11203,2531.8 11203,2506.4 11203,2506.4"];
		l0_ffn_down_4 -> l0_res2_4	[pos="e,11265,2415 11265,2459.8 11265,2459.8 11265,2425 11265,2425"];
		l0_ln2_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11416,2334",
			shape=rectangle,
			width=8.2361];
		l0_res2_4 -> l0_ln2_4	[pos="e,11416,2352 11416,2391.8 11416,2391.8 11416,2362 11416,2362"];
		l0_q_proj_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="11131,2910",
			shape=rectangle,
			width=8.5833];
		l0_attn_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_5<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="10813,2838",
			shape=rectangle,
			width=9.5833];
		l0_q_proj_5 -> l0_attn_5	[pos="e,10990,2856.4 10990,2891.8 10990,2891.8 10990,2866.4 10990,2866.4"];
		l0_k_proj_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="10495,2910",
			shape=rectangle,
			width=8.5694];
		l0_k_proj_5 -> l0_attn_5	[pos="e,10636,2856.4 10636,2891.8 10636,2891.8 10636,2866.4 10636,2866.4"];
		l0_v_proj_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="9860,2910",
			shape=rectangle,
			width=8.5694];
		l0_v_proj_5 -> l0_attn_5	[pos="e,10468,2844 9869.2,2892 9869.2,2872.4 9869.2,2844 9869.2,2844 9869.2,2844 10458,2844 10458,2844"];
		l0_out_proj_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="11829,2766",
			shape=rectangle,
			width=8.8889];
		l0_attn_5 -> l0_out_proj_5	[pos="e,11698,2784 11158,2832 11407,2832 11698,2832 11698,2832 11698,2832 11698,2794 11698,2794"];
		l0_res_5	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12488,2694",
			width=14.06];
		l0_out_proj_5 -> l0_res_5	[pos="e,12065,2697.1 12065,2747.8 12065,2747.8 12065,2707.1 12065,2707.1"];
		l0_ln1_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12488,2622",
			shape=rectangle,
			width=8.2361];
		l0_res_5 -> l0_ln1_5	[pos="e,12488,2640.4 12488,2675.8 12488,2675.8 12488,2650.4 12488,2650.4"];
		l0_ffn_up_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="12404,2550",
			shape=rectangle,
			width=8.6528];
		l0_ln1_5 -> l0_ffn_up_5	[pos="e,12454,2568.4 12454,2603.8 12454,2603.8 12454,2578.4 12454,2578.4"];
		l0_res2_5	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12570,2406",
			width=14.268];
		l0_ln1_5 -> l0_res2_5	[pos="e,12752,2417.7 12752,2604 12752,2604 12752,2427.7 12752,2427.7"];
		l0_ffn_down_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12401,2478",
			shape=rectangle,
			width=8.8333];
		l0_ffn_up_5 -> l0_ffn_down_5	[pos="e,12404,2496.4 12404,2531.8 12404,2531.8 12404,2506.4 12404,2506.4"];
		l0_ffn_down_5 -> l0_res2_5	[pos="e,12401,2418.3 12401,2459.8 12401,2459.8 12401,2428.3 12401,2428.3"];
		l0_ln2_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12352,2334",
			shape=rectangle,
			width=8.2361];
		l0_res2_5 -> l0_ln2_5	[pos="e,12352,2352.2 12352,2395.4 12352,2395.4 12352,2362.2 12352,2362.2"];
		l0_q_proj_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="13038,2910",
			shape=rectangle,
			width=8.5833];
		l0_attn_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_6<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="12705,2838",
			shape=rectangle,
			width=9.5833];
		l0_q_proj_6 -> l0_attn_6	[pos="e,12890,2856.4 12890,2891.8 12890,2891.8 12890,2866.4 12890,2866.4"];
		l0_k_proj_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="12402,2910",
			shape=rectangle,
			width=8.5694];
		l0_k_proj_6 -> l0_attn_6	[pos="e,12535,2856.4 12535,2891.8 12535,2891.8 12535,2866.4 12535,2866.4"];
		l0_v_proj_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="11767,2910",
			shape=rectangle,
			width=8.5694];
		l0_v_proj_6 -> l0_attn_6	[pos="e,12360,2844 11887,2892 11887,2872.4 11887,2844 11887,2844 11887,2844 12350,2844 12350,2844"];
		l0_out_proj_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="13152,2766",
			shape=rectangle,
			width=8.8889];
		l0_attn_6 -> l0_out_proj_6	[pos="e,12941,2784.4 12941,2819.8 12941,2819.8 12941,2794.4 12941,2794.4"];
		l0_res_6	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13536,2694",
			width=14.06];
		l0_out_proj_6 -> l0_res_6	[pos="e,13251,2702.2 13251,2747.8 13251,2747.8 13251,2712.2 13251,2712.2"];
		l0_ln1_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13536,2622",
			shape=rectangle,
			width=8.2361];
		l0_res_6 -> l0_ln1_6	[pos="e,13536,2640.4 13536,2675.8 13536,2675.8 13536,2650.4 13536,2650.4"];
		l0_ffn_up_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="13532,2550",
			shape=rectangle,
			width=8.6528];
		l0_ln1_6 -> l0_ffn_up_6	[pos="e,13536,2568.4 13536,2603.8 13536,2603.8 13536,2578.4 13536,2578.4"];
		l0_res2_6	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13615,2406",
			width=14.268];
		l0_ln1_6 -> l0_res2_6	[pos="e,13156,2408.4 13239,2622 13191,2622 13156,2622 13156,2622 13156,2622 13156,2418.4 13156,2418.4"];
		l0_ffn_down_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13528,2478",
			shape=rectangle,
			width=8.8333];
		l0_ffn_up_6 -> l0_ffn_down_6	[pos="e,13532,2496.4 13532,2531.8 13532,2531.8 13532,2506.4 13532,2506.4"];
		l0_ffn_down_6 -> l0_res2_6	[pos="e,13528,2421 13528,2459.8 13528,2459.8 13528,2431 13528,2431"];
		l0_ln2_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13343,2334",
			shape=rectangle,
			width=8.2361];
		l0_res2_6 -> l0_ln2_6	[pos="e,13370,2352.1 13370,2396.3 13370,2396.3 13370,2362.1 13370,2362.1"];
		l0_q_proj_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="14945,2910",
			shape=rectangle,
			width=8.5833];
		l0_attn_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_7<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="14334,2838",
			shape=rectangle,
			width=9.5833];
		l0_q_proj_7 -> l0_attn_7	[pos="e,14658,2856.4 14658,2891.8 14658,2891.8 14658,2866.4 14658,2866.4"];
		l0_k_proj_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="14309,2910",
			shape=rectangle,
			width=8.5694];
		l0_k_proj_7 -> l0_attn_7	[pos="e,14309,2856.4 14309,2891.8 14309,2891.8 14309,2866.4 14309,2866.4"];
		l0_v_proj_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="13674,2910",
			shape=rectangle,
			width=8.5694];
		l0_v_proj_7 -> l0_attn_7	[pos="e,13995,2856.2 13983,2910 13990,2910 13995,2910 13995,2910 13995,2910 13995,2866.2 13995,2866.2"];
		l0_out_proj_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="14493,2766",
			shape=rectangle,
			width=8.8889];
		l0_attn_7 -> l0_out_proj_7	[pos="e,14426,2784.4 14426,2819.8 14426,2819.8 14426,2794.4 14426,2794.4"];
		l0_res_7	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="14573,2694",
			width=14.06];
		l0_out_proj_7 -> l0_res_7	[pos="e,14493,2709.5 14493,2747.8 14493,2747.8 14493,2719.5 14493,2719.5"];
		l0_ln1_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="14573,2622",
			shape=rectangle,
			width=8.2361];
		l0_res_7 -> l0_ln1_7	[pos="e,14573,2640.4 14573,2675.8 14573,2675.8 14573,2650.4 14573,2650.4"];
		l0_ffn_up_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="14489,2550",
			shape=rectangle,
			width=8.6528];
		l0_ln1_7 -> l0_ffn_up_7	[pos="e,14538,2568.4 14538,2603.8 14538,2603.8 14538,2578.4 14538,2578.4"];
		l0_res2_7	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="14660,2406",
			width=14.268];
		l0_ln1_7 -> l0_res2_7	[pos="e,14836,2418 14836,2604 14836,2604 14836,2428 14836,2428"];
		l0_ffn_down_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="14485,2478",
			shape=rectangle,
			width=8.8333];
		l0_ffn_up_7 -> l0_ffn_down_7	[pos="e,14489,2496.4 14489,2531.8 14489,2531.8 14489,2506.4 14489,2506.4"];
		l0_ffn_down_7 -> l0_res2_7	[pos="e,14485,2418.3 14485,2459.8 14485,2459.8 14485,2428.3 14485,2428.3"];
		l0_ln2_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="14361,2334",
			shape=rectangle,
			width=8.2361];
		l0_res2_7 -> l0_ln2_7	[pos="e,14402,2352.2 14402,2396.9 14402,2396.9 14402,2362.2 14402,2362.2"];
	}
	subgraph cluster_layer1 {
		graph [bb="271,1587,15618,2236",
			fontsize=12,
			label="Layer 1 (Pipeline Stage 1, TP=8)",
			lheight=0.18,
			lp="7944.5,2225.5",
			lwidth=2.76,
			style=rounded
		];
		l1_q_proj_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="10185,2189",
			shape=rectangle,
			width=8.5833];
		l1_attn_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_8<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="11138,2117",
			shape=rectangle,
			width=9.5833];
		l1_q_proj_0 -> l1_attn_0	[pos="e,10793,2123 10182,2171 10182,2151.4 10182,2123 10182,2123 10182,2123 10783,2123 10783,2123"];
		l1_k_proj_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="11456,2189",
			shape=rectangle,
			width=8.5694];
		l1_k_proj_0 -> l1_attn_0	[pos="e,11315,2135.4 11315,2170.8 11315,2170.8 11315,2145.4 11315,2145.4"];
		l1_v_proj_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="10821,2189",
			shape=rectangle,
			width=8.5694];
		l1_v_proj_0 -> l1_attn_0	[pos="e,10961,2135.4 10961,2170.8 10961,2170.8 10961,2145.4 10961,2145.4"];
		l1_out_proj_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="12312,2045",
			shape=rectangle,
			width=8.8889];
		l1_attn_0 -> l1_out_proj_0	[pos="e,11992,2051 11432,2099 11432,2079.4 11432,2051 11432,2051 11432,2051 11982,2051 11982,2051"];
		l1_res_0	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12917,1973",
			width=14.06];
		l1_out_proj_0 -> l1_res_0	[pos="e,12558,1978.4 12558,2026.8 12558,2026.8 12558,1988.4 12558,1988.4"];
		l1_ln1_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12917,1901",
			shape=rectangle,
			width=8.2361];
		l1_res_0 -> l1_ln1_0	[pos="e,12917,1919.4 12917,1954.8 12917,1954.8 12917,1929.4 12917,1929.4"];
		l1_ffn_up_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="12887,1829",
			shape=rectangle,
			width=8.6528];
		l1_ln1_0 -> l1_ffn_up_0	[pos="e,12910,1847.4 12910,1882.8 12910,1882.8 12910,1857.4 12910,1857.4"];
		l1_res2_0	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12935,1685",
			width=14.268];
		l1_ln1_0 -> l1_res2_0	[pos="e,13207,1693.9 13207,1883 13207,1883 13207,1703.9 13207,1703.9"];
		l1_ffn_down_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12883,1757",
			shape=rectangle,
			width=8.8333];
		l1_ffn_up_0 -> l1_ffn_down_0	[pos="e,12887,1775.4 12887,1810.8 12887,1810.8 12887,1785.4 12887,1785.4"];
		l1_ffn_down_0 -> l1_res2_0	[pos="e,12883,1701.4 12883,1738.8 12883,1738.8 12883,1711.4 12883,1711.4"];
		l1_ln2_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12662,1613",
			shape=rectangle,
			width=8.2361];
		l1_res2_0 -> l1_ln2_0	[pos="e,12690,1631.1 12690,1675.3 12690,1675.3 12690,1641.1 12690,1641.1"];
		l1_q_proj_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="3781,2189",
			shape=rectangle,
			width=8.5833];
		l1_attn_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_9<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="3463,2117",
			shape=rectangle,
			width=9.5833];
		l1_q_proj_1 -> l1_attn_1	[pos="e,3640,2135.4 3640,2170.8 3640,2170.8 3640,2145.4 3640,2145.4"];
		l1_k_proj_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="3145,2189",
			shape=rectangle,
			width=8.5694];
		l1_k_proj_1 -> l1_attn_1	[pos="e,3285.8,2135.4 3285.8,2170.8 3285.8,2170.8 3285.8,2145.4 3285.8,2145.4"];
		l1_v_proj_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="2510,2189",
			shape=rectangle,
			width=8.5694];
		l1_v_proj_1 -> l1_attn_1	[pos="e,3117.9,2123 2735,2171 2735,2151.4 2735,2123 2735,2123 2735,2123 3107.9,2123 3107.9,2123"];
		l1_out_proj_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="4405,2045",
			shape=rectangle,
			width=8.8889];
		l1_attn_1 -> l1_out_proj_1	[pos="e,4098.8,2063 3808.3,2111 3957.6,2111 4098.8,2111 4098.8,2111 4098.8,2111 4098.8,2073 4098.8,2073"];
		l1_res_1	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="8569,1973",
			width=14.06];
		l1_out_proj_1 -> l1_res_1	[pos="e,8068.9,1972.6 4605,2026.7 4605,1995.9 4605,1937 4605,1937 4605,1937 8068.9,1937 8068.9,1937 8068.9,1937 8068.9,1962.6 8068.9,1962.6"];
		l1_ln1_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="8569,1901",
			shape=rectangle,
			width=8.2361];
		l1_res_1 -> l1_ln1_1	[pos="e,8569,1919.4 8569,1954.8 8569,1954.8 8569,1929.4 8569,1929.4"];
		l1_ffn_up_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="8397,1829",
			shape=rectangle,
			width=8.6528];
		l1_ln1_1 -> l1_ffn_up_1	[pos="e,8490.5,1847.4 8490.5,1882.8 8490.5,1882.8 8490.5,1857.4 8490.5,1857.4"];
		l1_res2_1	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="8729,1685",
			width=14.268];
		l1_ln1_1 -> l1_res2_1	[pos="e,8788.2,1701.1 8788.2,1883 8788.2,1883 8788.2,1711.1 8788.2,1711.1"];
		l1_ffn_down_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="8393,1757",
			shape=rectangle,
			width=8.8333];
		l1_ffn_up_1 -> l1_ffn_down_1	[pos="e,8397,1775.4 8397,1810.8 8397,1810.8 8397,1785.4 8397,1785.4"];
		l1_ffn_down_1 -> l1_res2_1	[pos="e,8463.2,1694 8463.2,1738.8 8463.2,1738.8 8463.2,1704 8463.2,1704"];
		l1_ln2_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9222,1613",
			shape=rectangle,
			width=8.2361];
		l1_res2_1 -> l1_ln2_1	[pos="e,9084.1,1631 9084.1,1679.4 9084.1,1679.4 9084.1,1641 9084.1,1641"];
		l1_q_proj_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="6342,2189",
			shape=rectangle,
			width=8.6528];
		l1_attn_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_10<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="7303,2117",
			shape=rectangle,
			width=9.6528];
		l1_q_proj_2 -> l1_attn_2	[pos="e,6955.1,2123 6644.8,2171 6644.8,2151.4 6644.8,2123 6644.8,2123 6644.8,2123 6945.1,2123 6945.1,2123"];
		l1_k_proj_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="7624,2189",
			shape=rectangle,
			width=8.6528];
		l1_k_proj_2 -> l1_attn_2	[pos="e,7481.5,2135.4 7481.5,2170.8 7481.5,2170.8 7481.5,2145.4 7481.5,2145.4"];
		l1_v_proj_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="6983,2189",
			shape=rectangle,
			width=8.6528];
		l1_v_proj_2 -> l1_attn_2	[pos="e,7125,2135.4 7125,2170.8 7125,2170.8 7125,2145.4 7125,2145.4"];
		l1_out_proj_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="8873,2045",
			shape=rectangle,
			width=8.9583];
		l1_attn_2 -> l1_out_proj_2	[pos="e,8559.2,2063 7650.8,2111 8022.6,2111 8559.2,2111 8559.2,2111 8559.2,2111 8559.2,2073 8559.2,2073"];
		l1_res_2	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10713,1973",
			width=14.199];
		l1_out_proj_2 -> l1_res_2	[pos="e,10345,1978.2 9161.9,2026.9 9161.9,2016.7 9161.9,2006 9161.9,2006 9161.9,2006 10345,2006 10345,2006 10345,2006 10345,1988.2 10345,\
1988.2"];
		l1_ln1_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10713,1901",
			shape=rectangle,
			width=8.3056];
		l1_res_2 -> l1_ln1_2	[pos="e,10713,1919.4 10713,1954.8 10713,1954.8 10713,1929.4 10713,1929.4"];
		l1_ffn_up_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="10673,1829",
			shape=rectangle,
			width=8.7361];
		l1_ln1_2 -> l1_ffn_up_2	[pos="e,10701,1847.4 10701,1882.8 10701,1882.8 10701,1857.4 10701,1857.4"];
		l1_res2_2	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10832,1685",
			width=14.384];
		l1_ln1_2 -> l1_res2_2	[pos="e,11001,1697.2 11001,1883 11001,1883 11001,1707.2 11001,1707.2"];
		l1_ffn_down_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10670,1757",
			shape=rectangle,
			width=8.9028];
		l1_ffn_up_2 -> l1_ffn_down_2	[pos="e,10673,1775.4 10673,1810.8 10673,1810.8 10673,1785.4 10673,1785.4"];
		l1_ffn_down_2 -> l1_res2_2	[pos="e,10670,1697.7 10670,1738.8 10670,1738.8 10670,1707.7 10670,1707.7"];
		l1_ln2_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11106,1613",
			shape=rectangle,
			width=8.3056];
		l1_res2_2 -> l1_ln2_2	[pos="e,11078,1631.1 11078,1675.3 11078,1675.3 11078,1641.1 11078,1641.1"];
		l1_q_proj_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="5701,2189",
			shape=rectangle,
			width=8.6528];
		l1_attn_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_11<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="5380,2117",
			shape=rectangle,
			width=9.6528];
		l1_q_proj_3 -> l1_attn_3	[pos="e,5558.5,2135.4 5558.5,2170.8 5558.5,2170.8 5558.5,2145.4 5558.5,2145.4"];
		l1_k_proj_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="5060,2189",
			shape=rectangle,
			width=8.6528];
		l1_k_proj_3 -> l1_attn_3	[pos="e,5202,2135.4 5202,2170.8 5202,2170.8 5202,2145.4 5202,2145.4"];
		l1_v_proj_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="4419,2189",
			shape=rectangle,
			width=8.6528];
		l1_v_proj_3 -> l1_attn_3	[pos="e,5032.4,2123 4416.2,2171 4416.2,2151.4 4416.2,2123 4416.2,2123 4416.2,2123 5022.4,2123 5022.4,2123"];
		l1_out_proj_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="6950,2045",
			shape=rectangle,
			width=8.9583];
		l1_attn_3 -> l1_out_proj_3	[pos="e,6636.2,2063 5727.8,2111 6099.6,2111 6636.2,2111 6636.2,2111 6636.2,2111 6636.2,2073 6636.2,2073"];
		l1_res_3	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9606,1973",
			width=14.199];
		l1_out_proj_3 -> l1_res_3	[pos="e,9128.4,1974.2 7140.7,2026.8 7140.7,2014.7 7140.7,2001 7140.7,2001 7140.7,2001 9128.4,2001 9128.4,2001 9128.4,2001 9128.4,1984.2 \
9128.4,1984.2"];
		l1_ln1_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9606,1901",
			shape=rectangle,
			width=8.3056];
		l1_res_3 -> l1_ln1_3	[pos="e,9606,1919.4 9606,1954.8 9606,1954.8 9606,1929.4 9606,1929.4"];
		l1_ffn_up_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="9539,1829",
			shape=rectangle,
			width=8.7361];
		l1_ln1_3 -> l1_ffn_up_3	[pos="e,9580.2,1847.4 9580.2,1882.8 9580.2,1882.8 9580.2,1857.4 9580.2,1857.4"];
		l1_res2_3	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9778,1685",
			width=14.384];
		l1_ln1_3 -> l1_res2_3	[pos="e,9881.2,1699.6 9881.2,1883 9881.2,1883 9881.2,1709.6 9881.2,1709.6"];
		l1_ffn_down_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9537,1757",
			shape=rectangle,
			width=8.9028];
		l1_ffn_up_3 -> l1_ffn_down_3	[pos="e,9539,1775.4 9539,1810.8 9539,1810.8 9539,1785.4 9539,1785.4"];
		l1_ffn_down_3 -> l1_res2_3	[pos="e,9558.8,1695.6 9558.8,1738.8 9558.8,1738.8 9558.8,1705.6 9558.8,1705.6"];
		l1_ln2_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10272,1613",
			shape=rectangle,
			width=8.3056];
		l1_res2_3 -> l1_ln2_3	[pos="e,10134,1631 10134,1679.4 10134,1679.4 10134,1641 10134,1641"];
		l1_q_proj_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="9547,2189",
			shape=rectangle,
			width=8.6528];
		l1_attn_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_12<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="9226,2117",
			shape=rectangle,
			width=9.6528];
		l1_q_proj_4 -> l1_attn_4	[pos="e,9404.5,2135.4 9404.5,2170.8 9404.5,2170.8 9404.5,2145.4 9404.5,2145.4"];
		l1_k_proj_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="8906,2189",
			shape=rectangle,
			width=8.6528];
		l1_k_proj_4 -> l1_attn_4	[pos="e,9048,2135.4 9048,2170.8 9048,2170.8 9048,2145.4 9048,2145.4"];
		l1_v_proj_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="8265,2189",
			shape=rectangle,
			width=8.6528];
		l1_v_proj_4 -> l1_attn_4	[pos="e,8878.1,2123 8567.8,2171 8567.8,2151.4 8567.8,2123 8567.8,2123 8567.8,2123 8868.1,2123 8868.1,2123"];
		l1_out_proj_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="10166,2045",
			shape=rectangle,
			width=8.9583];
		l1_attn_4 -> l1_out_proj_4	[pos="e,9851,2063 9573.7,2111 9717.4,2111 9851,2111 9851,2111 9851,2111 9851,2073 9851,2073"];
		l1_res_4	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11841,1973",
			width=14.199];
		l1_out_proj_4 -> l1_res_4	[pos="e,11381,1974.9 10489,2039 10849,2039 11381,2039 11381,2039 11381,2039 11381,1984.9 11381,1984.9"];
		l1_ln1_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11841,1901",
			shape=rectangle,
			width=8.3056];
		l1_res_4 -> l1_ln1_4	[pos="e,11841,1919.4 11841,1954.8 11841,1954.8 11841,1929.4 11841,1929.4"];
		l1_ffn_up_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="11696,1829",
			shape=rectangle,
			width=8.7361];
		l1_ln1_4 -> l1_ffn_up_4	[pos="e,11776,1847.4 11776,1882.8 11776,1882.8 11776,1857.4 11776,1857.4"];
		l1_res2_4	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11886,1685",
			width=14.384];
		l1_ln1_4 -> l1_res2_4	[pos="e,12077,1696.7 12077,1883 12077,1883 12077,1706.7 12077,1706.7"];
		l1_ffn_down_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11693,1757",
			shape=rectangle,
			width=8.9028];
		l1_ffn_up_4 -> l1_ffn_down_4	[pos="e,11696,1775.4 11696,1810.8 11696,1810.8 11696,1785.4 11696,1785.4"];
		l1_ffn_down_4 -> l1_res2_4	[pos="e,11693,1696.4 11693,1738.8 11693,1738.8 11693,1706.4 11693,1706.4"];
		l1_ln2_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11831,1613",
			shape=rectangle,
			width=8.3056];
		l1_res2_4 -> l1_ln2_4	[pos="e,11831,1631 11831,1668.7 11831,1668.7 11831,1641 11831,1641"];
		l1_q_proj_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="590,2189",
			shape=rectangle,
			width=8.6528];
		l1_attn_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_13<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="1552,2117",
			shape=rectangle,
			width=9.6528];
		l1_q_proj_5 -> l1_attn_5	[pos="e,1204.4,2117 590,2170.8 590,2149.5 590,2117 590,2117 590,2117 1194.4,2117 1194.4,2117"];
		l1_k_proj_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="1872,2189",
			shape=rectangle,
			width=8.6528];
		l1_k_proj_5 -> l1_attn_5	[pos="e,1730,2135.4 1730,2170.8 1730,2170.8 1730,2145.4 1730,2145.4"];
		l1_v_proj_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="1231,2189",
			shape=rectangle,
			width=8.6528];
		l1_v_proj_5 -> l1_attn_5	[pos="e,1373.5,2135.4 1373.5,2170.8 1373.5,2170.8 1373.5,2145.4 1373.5,2145.4"];
		l1_out_proj_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="2329,2045",
			shape=rectangle,
			width=8.9583];
		l1_attn_5 -> l1_out_proj_5	[pos="e,2095,2063 1899.7,2111 2005.8,2111 2095,2111 2095,2111 2095,2111 2095,2073 2095,2073"];
		l1_res_5	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="7520,1973",
			width=14.199];
		l1_out_proj_5 -> l1_res_5	[pos="e,7008.7,1973 2615.5,2026.8 2615.5,2005.5 2615.5,1973 2615.5,1973 2615.5,1973 6998.7,1973 6998.7,1973"];
		l1_ln1_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="7520,1901",
			shape=rectangle,
			width=8.3056];
		l1_res_5 -> l1_ln1_5	[pos="e,7520,1919.4 7520,1954.8 7520,1954.8 7520,1929.4 7520,1929.4"];
		l1_ffn_up_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="7432,1829",
			shape=rectangle,
			width=8.7361];
		l1_ln1_5 -> l1_ffn_up_5	[pos="e,7483.8,1847.4 7483.8,1882.8 7483.8,1882.8 7483.8,1857.4 7483.8,1857.4"];
		l1_res2_5	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="7680,1685",
			width=14.384];
		l1_ln1_5 -> l1_res2_5	[pos="e,7784.8,1699.4 7784.8,1883 7784.8,1883 7784.8,1709.4 7784.8,1709.4"];
		l1_ffn_down_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="7430,1757",
			shape=rectangle,
			width=8.9028];
		l1_ffn_up_5 -> l1_ffn_down_5	[pos="e,7432,1775.4 7432,1810.8 7432,1810.8 7432,1785.4 7432,1785.4"];
		l1_ffn_down_5 -> l1_res2_5	[pos="e,7456.3,1695.6 7456.3,1738.8 7456.3,1738.8 7456.3,1705.6 7456.3,1705.6"];
		l1_ln2_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="7735,1613",
			shape=rectangle,
			width=8.3056];
		l1_res2_5 -> l1_ln2_5	[pos="e,7735,1631 7735,1668.7 7735,1668.7 7735,1641 7735,1641"];
		l1_q_proj_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="15299,2189",
			shape=rectangle,
			width=8.6528];
		l1_attn_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_14<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="14765,2117",
			shape=rectangle,
			width=9.6528];
		l1_q_proj_6 -> l1_attn_6	[pos="e,15050,2135.4 15050,2170.8 15050,2170.8 15050,2145.4 15050,2145.4"];
		l1_k_proj_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="14658,2189",
			shape=rectangle,
			width=8.6528];
		l1_k_proj_6 -> l1_attn_6	[pos="e,14694,2135.4 14694,2170.8 14694,2170.8 14694,2145.4 14694,2145.4"];
		l1_v_proj_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="14017,2189",
			shape=rectangle,
			width=8.6528];
		l1_v_proj_6 -> l1_attn_6	[pos="e,14417,2117 14125,2170.8 14125,2149.5 14125,2117 14125,2117 14125,2117 14407,2117 14407,2117"];
		l1_out_proj_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="14979,2045",
			shape=rectangle,
			width=8.9583];
		l1_attn_6 -> l1_out_proj_6	[pos="e,14884,2063.4 14884,2098.8 14884,2098.8 14884,2073.4 14884,2073.4"];
		l1_res_6	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="15032,1973",
			width=14.199];
		l1_out_proj_6 -> l1_res_6	[pos="e,14979,1989.4 14979,2026.8 14979,2026.8 14979,1999.4 14979,1999.4"];
		l1_ln1_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="15032,1901",
			shape=rectangle,
			width=8.3056];
		l1_res_6 -> l1_ln1_6	[pos="e,15032,1919.4 15032,1954.8 15032,1954.8 15032,1929.4 15032,1929.4"];
		l1_ffn_up_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="14867,1829",
			shape=rectangle,
			width=8.7361];
		l1_ln1_6 -> l1_ffn_up_6	[pos="e,14957,1847.4 14957,1882.8 14957,1882.8 14957,1857.4 14957,1857.4"];
		l1_res2_6	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="15038,1685",
			width=14.384];
		l1_ln1_6 -> l1_res2_6	[pos="e,15258,1695.7 15258,1883 15258,1883 15258,1705.7 15258,1705.7"];
		l1_ffn_down_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="14864,1757",
			shape=rectangle,
			width=8.9028];
		l1_ffn_up_6 -> l1_ffn_down_6	[pos="e,14867,1775.4 14867,1810.8 14867,1810.8 14867,1785.4 14867,1785.4"];
		l1_ffn_down_6 -> l1_res2_6	[pos="e,14864,1697.3 14864,1738.8 14864,1738.8 14864,1707.3 14864,1707.3"];
		l1_ln2_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="14600,1613",
			shape=rectangle,
			width=8.3056];
		l1_res2_6 -> l1_ln2_6	[pos="e,14710,1631.1 14710,1678.4 14710,1678.4 14710,1641.1 14710,1641.1"];
		l1_q_proj_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="13376,2189",
			shape=rectangle,
			width=8.6528];
		l1_attn_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_15<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="13055,2117",
			shape=rectangle,
			width=9.6528];
		l1_q_proj_7 -> l1_attn_7	[pos="e,13234,2135.4 13234,2170.8 13234,2170.8 13234,2145.4 13234,2145.4"];
		l1_k_proj_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="12735,2189",
			shape=rectangle,
			width=8.6528];
		l1_k_proj_7 -> l1_attn_7	[pos="e,12877,2135.4 12877,2170.8 12877,2170.8 12877,2145.4 12877,2145.4"];
		l1_v_proj_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="12094,2189",
			shape=rectangle,
			width=8.6528];
		l1_v_proj_7 -> l1_attn_7	[pos="e,12707,2117 12199,2170.8 12199,2149.5 12199,2117 12199,2117 12199,2117 12697,2117 12697,2117"];
		l1_out_proj_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="13599,2045",
			shape=rectangle,
			width=8.9583];
		l1_attn_7 -> l1_out_proj_7	[pos="e,13340,2063.4 13340,2098.8 13340,2098.8 13340,2073.4 13340,2073.4"];
		l1_res_7	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13983,1973",
			width=14.199];
		l1_out_proj_7 -> l1_res_7	[pos="e,13697,1981.2 13697,2026.8 13697,2026.8 13697,1991.2 13697,1991.2"];
		l1_ln1_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13983,1901",
			shape=rectangle,
			width=8.3056];
		l1_res_7 -> l1_ln1_7	[pos="e,13983,1919.4 13983,1954.8 13983,1954.8 13983,1929.4 13983,1929.4"];
		l1_ffn_up_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="13653,1829",
			shape=rectangle,
			width=8.7361];
		l1_ln1_7 -> l1_ffn_up_7	[pos="e,13826,1847.4 13826,1882.8 13826,1882.8 13826,1857.4 13826,1857.4"];
		l1_res2_7	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13984,1685",
			width=14.384];
		l1_ln1_7 -> l1_res2_7	[pos="e,14126,1698.3 14126,1883 14126,1883 14126,1708.3 14126,1708.3"];
		l1_ffn_down_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13650,1757",
			shape=rectangle,
			width=8.9028];
		l1_ffn_up_7 -> l1_ffn_down_7	[pos="e,13653,1775.4 13653,1810.8 13653,1810.8 13653,1785.4 13653,1785.4"];
		l1_ffn_down_7 -> l1_res2_7	[pos="e,13718,1694 13718,1738.8 13718,1738.8 13718,1704 13718,1704"];
		l1_ln2_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13602,1613",
			shape=rectangle,
			width=8.3056];
		l1_res2_7 -> l1_ln2_7	[pos="e,13684,1631 13684,1677.3 13684,1677.3 13684,1641 13684,1641"];
	}
	subgraph cluster_layer2 {
		graph [bb="1300,866,16551,1515",
			fontsize=12,
			label="Layer 2 (Pipeline Stage 0, TP=8)",
			lheight=0.18,
			lp="8925.5,1504.5",
			lwidth=2.76,
			style=rounded
		];
		l2_q_proj_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="11150,1468",
			shape=rectangle,
			width=8.5833];
		l2_attn_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_0<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="12103,1396",
			shape=rectangle,
			width=9.5833];
		l2_q_proj_0 -> l2_attn_0	[pos="e,11758,1396 11394,1449.8 11394,1428.5 11394,1396 11394,1396 11394,1396 11748,1396 11748,1396"];
		l2_k_proj_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="12421,1468",
			shape=rectangle,
			width=8.5694];
		l2_k_proj_0 -> l2_attn_0	[pos="e,12280,1414.4 12280,1449.8 12280,1449.8 12280,1424.4 12280,1424.4"];
		l2_v_proj_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="11786,1468",
			shape=rectangle,
			width=8.5694];
		l2_v_proj_0 -> l2_attn_0	[pos="e,11926,1414.4 11926,1449.8 11926,1449.8 11926,1424.4 11926,1424.4"];
		l2_out_proj_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="12738,1324",
			shape=rectangle,
			width=8.8889];
		l2_attn_0 -> l2_out_proj_0	[pos="e,12433,1342.4 12433,1377.8 12433,1377.8 12433,1352.4 12433,1352.4"];
		l2_res_0	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13881,1252",
			width=14.06];
		l2_out_proj_0 -> l2_res_0	[pos="e,13377,1252.2 13058,1324 13218,1324 13377,1324 13377,1324 13377,1324 13377,1262.2 13377,1262.2"];
		l2_ln1_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13881,1180",
			shape=rectangle,
			width=8.2361];
		l2_res_0 -> l2_ln1_0	[pos="e,13881,1198.4 13881,1233.8 13881,1233.8 13881,1208.4 13881,1208.4"];
		l2_ffn_up_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="13716,1108",
			shape=rectangle,
			width=8.6528];
		l2_ln1_0 -> l2_ffn_up_0	[pos="e,13806,1126.4 13806,1161.8 13806,1161.8 13806,1136.4 13806,1136.4"];
		l2_res2_0	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13932,964",
			width=14.268];
		l2_ln1_0 -> l2_res2_0	[pos="e,14104,975.98 14104,1162 14104,1162 14104,985.98 14104,985.98"];
		l2_ffn_down_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13713,1036",
			shape=rectangle,
			width=8.8333];
		l2_ffn_up_0 -> l2_ffn_down_0	[pos="e,13716,1054.4 13716,1089.8 13716,1089.8 13716,1064.4 13716,1064.4"];
		l2_ffn_down_0 -> l2_res2_0	[pos="e,13725,974.98 13725,1017.8 13725,1017.8 13725,984.98 13725,984.98"];
		l2_ln2_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_0<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13714,892",
			shape=rectangle,
			width=8.2361];
		l2_res2_0 -> l2_ln2_0	[pos="e,13714,910.21 13714,953.38 13714,953.38 13714,920.21 13714,920.21"];
		l2_q_proj_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="4794,1468",
			shape=rectangle,
			width=8.5833];
		l2_attn_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_1<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="4476,1396",
			shape=rectangle,
			width=9.5833];
		l2_q_proj_1 -> l2_attn_1	[pos="e,4653,1414.4 4653,1449.8 4653,1449.8 4653,1424.4 4653,1424.4"];
		l2_k_proj_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="4158,1468",
			shape=rectangle,
			width=8.5694];
		l2_k_proj_1 -> l2_attn_1	[pos="e,4298.8,1414.4 4298.8,1449.8 4298.8,1449.8 4298.8,1424.4 4298.8,1424.4"];
		l2_v_proj_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="3523,1468",
			shape=rectangle,
			width=8.5694];
		l2_v_proj_1 -> l2_attn_1	[pos="e,4131,1396 3749.8,1449.8 3749.8,1428.5 3749.8,1396 3749.8,1396 3749.8,1396 4121,1396 4121,1396"];
		l2_out_proj_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="5100,1324",
			shape=rectangle,
			width=8.8889];
		l2_attn_1 -> l2_out_proj_1	[pos="e,4800.5,1342.4 4800.5,1377.8 4800.5,1377.8 4800.5,1352.4 4800.5,1352.4"];
		l2_res_1	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9474,1252",
			width=14.06];
		l2_out_proj_1 -> l2_res_1	[pos="e,9035.9,1249.2 5376.5,1305.7 5376.5,1274.9 5376.5,1216 5376.5,1216 5376.5,1216 9035.9,1216 9035.9,1216 9035.9,1216 9035.9,1239.2 \
9035.9,1239.2"];
		l2_ln1_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9474,1180",
			shape=rectangle,
			width=8.2361];
		l2_res_1 -> l2_ln1_1	[pos="e,9474,1198.4 9474,1233.8 9474,1233.8 9474,1208.4 9474,1208.4"];
		l2_ffn_up_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="9426,1108",
			shape=rectangle,
			width=8.6528];
		l2_ln1_1 -> l2_ffn_up_1	[pos="e,9457.5,1126.4 9457.5,1161.8 9457.5,1161.8 9457.5,1136.4 9457.5,1136.4"];
		l2_res2_1	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9752,964",
			width=14.268];
		l2_ln1_1 -> l2_res2_1	[pos="e,9755.2,982.15 9755.2,1162 9755.2,1162 9755.2,992.15 9755.2,992.15"];
		l2_ffn_down_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9422,1036",
			shape=rectangle,
			width=8.8333];
		l2_ffn_up_1 -> l2_ffn_down_1	[pos="e,9426,1054.4 9426,1089.8 9426,1089.8 9426,1064.4 9426,1064.4"];
		l2_ffn_down_1 -> l2_res2_1	[pos="e,9489.2,972.96 9489.2,1017.8 9489.2,1017.8 9489.2,982.96 9489.2,982.96"];
		l2_ln2_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_1<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10240,892",
			shape=rectangle,
			width=8.2361];
		l2_res2_1 -> l2_ln2_1	[pos="e,10105,910.04 10105,958.35 10105,958.35 10105,920.04 10105,920.04"];
		l2_q_proj_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="7337,1468",
			shape=rectangle,
			width=8.5833];
		l2_attn_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_2<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="8290,1396",
			shape=rectangle,
			width=9.5833];
		l2_q_proj_2 -> l2_attn_2	[pos="e,7944.7,1402 7643,1450 7643,1430.4 7643,1402 7643,1402 7643,1402 7934.7,1402 7934.7,1402"];
		l2_k_proj_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="8608,1468",
			shape=rectangle,
			width=8.5694];
		l2_k_proj_2 -> l2_attn_2	[pos="e,8467.2,1414.4 8467.2,1449.8 8467.2,1449.8 8467.2,1424.4 8467.2,1424.4"];
		l2_v_proj_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="7973,1468",
			shape=rectangle,
			width=8.5694];
		l2_v_proj_2 -> l2_attn_2	[pos="e,8113.2,1414.4 8113.2,1449.8 8113.2,1449.8 8113.2,1424.4 8113.2,1424.4"];
		l2_out_proj_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="10188,1324",
			shape=rectangle,
			width=8.8889];
		l2_attn_2 -> l2_out_proj_2	[pos="e,9867.8,1324 8456,1377.8 8456,1356.5 8456,1324 8456,1324 8456,1324 9857.8,1324 9857.8,1324"];
		l2_res_2	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11770,1252",
			width=14.06];
		l2_out_proj_2 -> l2_res_2	[pos="e,11329,1254.5 10508,1318 10846,1318 11329,1318 11329,1318 11329,1318 11329,1264.5 11329,1264.5"];
		l2_ln1_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11770,1180",
			shape=rectangle,
			width=8.2361];
		l2_res_2 -> l2_ln1_2	[pos="e,11770,1198.4 11770,1233.8 11770,1233.8 11770,1208.4 11770,1208.4"];
		l2_ffn_up_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="11676,1108",
			shape=rectangle,
			width=8.6528];
		l2_ln1_2 -> l2_ffn_up_2	[pos="e,11730,1126.4 11730,1161.8 11730,1161.8 11730,1136.4 11730,1136.4"];
		l2_res2_2	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11842,964",
			width=14.268];
		l2_ln1_2 -> l2_res2_2	[pos="e,12029,975.72 12029,1162 12029,1162 12029,985.72 12029,985.72"];
		l2_ffn_down_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11673,1036",
			shape=rectangle,
			width=8.8333];
		l2_ffn_up_2 -> l2_ffn_down_2	[pos="e,11676,1054.4 11676,1089.8 11676,1089.8 11676,1064.4 11676,1064.4"];
		l2_ffn_down_2 -> l2_res2_2	[pos="e,11673,976.28 11673,1017.8 11673,1017.8 11673,986.28 11673,986.28"];
		l2_ln2_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_2<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11950,892",
			shape=rectangle,
			width=8.2361];
		l2_res2_2 -> l2_ln2_2	[pos="e,11950,910.03 11950,949.78 11950,949.78 11950,920.03 11950,920.03"];
		l2_q_proj_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="6701,1468",
			shape=rectangle,
			width=8.5833];
		l2_attn_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_3<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="6383,1396",
			shape=rectangle,
			width=9.5833];
		l2_q_proj_3 -> l2_attn_3	[pos="e,6560,1414.4 6560,1449.8 6560,1449.8 6560,1424.4 6560,1424.4"];
		l2_k_proj_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="6065,1468",
			shape=rectangle,
			width=8.5694];
		l2_k_proj_3 -> l2_attn_3	[pos="e,6205.8,1414.4 6205.8,1449.8 6205.8,1449.8 6205.8,1424.4 6205.8,1424.4"];
		l2_v_proj_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="5430,1468",
			shape=rectangle,
			width=8.5694];
		l2_v_proj_3 -> l2_attn_3	[pos="e,6037.8,1396 5579.2,1449.8 5579.2,1428.5 5579.2,1396 5579.2,1396 5579.2,1396 6027.8,1396 6027.8,1396"];
		l2_out_proj_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="7957,1324",
			shape=rectangle,
			width=8.8889];
		l2_attn_3 -> l2_out_proj_3	[pos="e,7640,1342 6728.1,1390 7100.3,1390 7640,1390 7640,1390 7640,1390 7640,1352 7640,1352"];
		l2_res_3	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10646,1252",
			width=14.06];
		l2_out_proj_3 -> l2_res_3	[pos="e,10324,1258.6 8103.4,1305.6 8103.4,1296.7 8103.4,1288 8103.4,1288 8103.4,1288 10324,1288 10324,1288 10324,1288 10324,1268.6 10324,\
1268.6"];
		l2_ln1_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10646,1180",
			shape=rectangle,
			width=8.2361];
		l2_res_3 -> l2_ln1_3	[pos="e,10646,1198.4 10646,1233.8 10646,1233.8 10646,1208.4 10646,1208.4"];
		l2_ffn_up_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="10553,1108",
			shape=rectangle,
			width=8.6528];
		l2_ln1_3 -> l2_ffn_up_3	[pos="e,10607,1126.4 10607,1161.8 10607,1161.8 10607,1136.4 10607,1136.4"];
		l2_res2_3	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10797,964",
			width=14.268];
		l2_ln1_3 -> l2_res2_3	[pos="e,10905,978.37 10905,1162 10905,1162 10905,988.37 10905,988.37"];
		l2_ffn_down_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10549,1036",
			shape=rectangle,
			width=8.8333];
		l2_ffn_up_3 -> l2_ffn_down_3	[pos="e,10553,1054.4 10553,1089.8 10553,1089.8 10553,1064.4 10553,1064.4"];
		l2_ffn_down_3 -> l2_res2_3	[pos="e,10575,974.57 10575,1017.8 10575,1017.8 10575,984.57 10575,984.57"];
		l2_ln2_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_3<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11068,892",
			shape=rectangle,
			width=8.2361];
		l2_res2_3 -> l2_ln2_3	[pos="e,11041,910.12 11041,954.29 11041,954.29 11041,920.12 11041,920.12"];
		l2_q_proj_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="10514,1468",
			shape=rectangle,
			width=8.5833];
		l2_attn_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_4<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="10196,1396",
			shape=rectangle,
			width=9.5833];
		l2_q_proj_4 -> l2_attn_4	[pos="e,10373,1414.4 10373,1449.8 10373,1449.8 10373,1424.4 10373,1424.4"];
		l2_k_proj_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="9878,1468",
			shape=rectangle,
			width=8.5694];
		l2_k_proj_4 -> l2_attn_4	[pos="e,10019,1414.4 10019,1449.8 10019,1449.8 10019,1424.4 10019,1424.4"];
		l2_v_proj_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="9243,1468",
			shape=rectangle,
			width=8.5694];
		l2_v_proj_4 -> l2_attn_4	[pos="e,9850.7,1396 9259.7,1449.8 9259.7,1428.5 9259.7,1396 9259.7,1396 9259.7,1396 9840.7,1396 9840.7,1396"];
		l2_out_proj_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="11896,1324",
			shape=rectangle,
			width=8.8889];
		l2_attn_4 -> l2_out_proj_4	[pos="e,11576,1330 10524,1378 10524,1358.4 10524,1330 10524,1330 10524,1330 11566,1330 11566,1330"];
		l2_res_4	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12847,1252",
			width=14.06];
		l2_out_proj_4 -> l2_res_4	[pos="e,12367,1253 12216,1324 12300,1324 12367,1324 12367,1324 12367,1324 12367,1263 12367,1263"];
		l2_ln1_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12847,1180",
			shape=rectangle,
			width=8.2361];
		l2_res_4 -> l2_ln1_4	[pos="e,12847,1198.4 12847,1233.8 12847,1233.8 12847,1208.4 12847,1208.4"];
		l2_ffn_up_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="12560,1108",
			shape=rectangle,
			width=8.6528];
		l2_ln1_4 -> l2_ffn_up_4	[pos="e,12711,1126.4 12711,1161.8 12711,1161.8 12711,1136.4 12711,1136.4"];
		l2_res2_4	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12887,964",
			width=14.268];
		l2_ln1_4 -> l2_res2_4	[pos="e,13009,977.82 13009,1162 13009,1162 13009,987.82 13009,987.82"];
		l2_ffn_down_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12557,1036",
			shape=rectangle,
			width=8.8333];
		l2_ffn_up_4 -> l2_ffn_down_4	[pos="e,12560,1054.4 12560,1089.8 12560,1089.8 12560,1064.4 12560,1064.4"];
		l2_ffn_down_4 -> l2_res2_4	[pos="e,12624,972.96 12624,1017.8 12624,1017.8 12624,982.96 12624,982.96"];
		l2_ln2_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_4<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12778,892",
			shape=rectangle,
			width=8.2361];
		l2_res2_4 -> l2_ln2_4	[pos="e,12778,910.03 12778,949.78 12778,949.78 12778,920.03 12778,920.03"];
		l2_q_proj_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="1617,1468",
			shape=rectangle,
			width=8.5833];
		l2_attn_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_5<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="2570,1396",
			shape=rectangle,
			width=9.5833];
		l2_q_proj_5 -> l2_attn_5	[pos="e,2224.9,1396 1617,1449.8 1617,1428.5 1617,1396 1617,1396 1617,1396 2214.9,1396 2214.9,1396"];
		l2_k_proj_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="2888,1468",
			shape=rectangle,
			width=8.5694];
		l2_k_proj_5 -> l2_attn_5	[pos="e,2747.2,1414.4 2747.2,1449.8 2747.2,1449.8 2747.2,1424.4 2747.2,1424.4"];
		l2_v_proj_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="2253,1468",
			shape=rectangle,
			width=8.5694];
		l2_v_proj_5 -> l2_attn_5	[pos="e,2393.2,1414.4 2393.2,1449.8 2393.2,1449.8 2393.2,1424.4 2393.2,1424.4"];
		l2_out_proj_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="3348,1324",
			shape=rectangle,
			width=8.8889];
		l2_attn_5 -> l2_out_proj_5	[pos="e,3028,1324 2847.8,1377.8 2847.8,1356.5 2847.8,1324 2847.8,1324 2847.8,1324 3018,1324 3018,1324"];
		l2_res_5	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="8436,1252",
			width=14.06];
		l2_out_proj_5 -> l2_res_5	[pos="e,7929.8,1252 3544.8,1305.8 3544.8,1284.5 3544.8,1252 3544.8,1252 3544.8,1252 7919.8,1252 7919.8,1252"];
		l2_ln1_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="8436,1180",
			shape=rectangle,
			width=8.2361];
		l2_res_5 -> l2_ln1_5	[pos="e,8436,1198.4 8436,1233.8 8436,1233.8 8436,1208.4 8436,1208.4"];
		l2_ffn_up_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="8405,1108",
			shape=rectangle,
			width=8.6528];
		l2_ln1_5 -> l2_ffn_up_5	[pos="e,8428,1126.4 8428,1161.8 8428,1161.8 8428,1136.4 8428,1136.4"];
		l2_res2_5	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="8707,964",
			width=14.268];
		l2_ln1_5 -> l2_res2_5	[pos="e,8726.2,981.54 8726.2,1162 8726.2,1162 8726.2,991.54 8726.2,991.54"];
		l2_ffn_down_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="8402,1036",
			shape=rectangle,
			width=8.8333];
		l2_ffn_up_5 -> l2_ffn_down_5	[pos="e,8405,1054.4 8405,1089.8 8405,1089.8 8405,1064.4 8405,1064.4"];
		l2_ffn_down_5 -> l2_res2_5	[pos="e,8456.7,973.35 8456.7,1017.8 8456.7,1017.8 8456.7,983.35 8456.7,983.35"];
		l2_ln2_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_5<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9195,892",
			shape=rectangle,
			width=8.2361];
		l2_res2_5 -> l2_ln2_5	[pos="e,9059.6,910.04 9059.6,958.35 9059.6,958.35 9059.6,920.04 9059.6,920.04"];
		l2_q_proj_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="16234,1468",
			shape=rectangle,
			width=8.5833];
		l2_attn_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_6<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="15686,1396",
			shape=rectangle,
			width=9.5833];
		l2_q_proj_6 -> l2_attn_6	[pos="e,15978,1414.4 15978,1449.8 15978,1449.8 15978,1424.4 15978,1424.4"];
		l2_k_proj_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="15598,1468",
			shape=rectangle,
			width=8.5694];
		l2_k_proj_6 -> l2_attn_6	[pos="e,15624,1414.4 15624,1449.8 15624,1449.8 15624,1424.4 15624,1424.4"];
		l2_v_proj_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="14963,1468",
			shape=rectangle,
			width=8.5694];
		l2_v_proj_6 -> l2_attn_6	[pos="e,15341,1390 15214,1449.9 15214,1426.9 15214,1390 15214,1390 15214,1390 15331,1390 15331,1390"];
		l2_out_proj_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="15863,1324",
			shape=rectangle,
			width=8.8889];
		l2_attn_6 -> l2_out_proj_6	[pos="e,15787,1342.4 15787,1377.8 15787,1377.8 15787,1352.4 15787,1352.4"];
		l2_res_6	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="15974,1252",
			width=14.06];
		l2_out_proj_6 -> l2_res_6	[pos="e,15863,1266.1 15863,1305.8 15863,1305.8 15863,1276.1 15863,1276.1"];
		l2_ln1_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="15974,1180",
			shape=rectangle,
			width=8.2361];
		l2_res_6 -> l2_ln1_6	[pos="e,15974,1198.4 15974,1233.8 15974,1233.8 15974,1208.4 15974,1208.4"];
		l2_ffn_up_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="15832,1108",
			shape=rectangle,
			width=8.6528];
		l2_ln1_6 -> l2_ffn_up_6	[pos="e,15910,1126.4 15910,1161.8 15910,1161.8 15910,1136.4 15910,1136.4"];
		l2_res2_6	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="16022,964",
			width=14.268];
		l2_ln1_6 -> l2_res2_6	[pos="e,16208,975.72 16208,1162 16208,1162 16208,985.72 16208,985.72"];
		l2_ffn_down_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="15828,1036",
			shape=rectangle,
			width=8.8333];
		l2_ffn_up_6 -> l2_ffn_down_6	[pos="e,15832,1054.4 15832,1089.8 15832,1089.8 15832,1064.4 15832,1064.4"];
		l2_ffn_down_6 -> l2_res2_6	[pos="e,15828,975.41 15828,1017.8 15828,1017.8 15828,985.41 15828,985.41"];
		l2_ln2_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_6<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="15723,892",
			shape=rectangle,
			width=8.2361];
		l2_res2_6 -> l2_ln2_6	[pos="e,15764,910.15 15764,954.88 15764,954.88 15764,920.15 15764,920.15"];
		l2_q_proj_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="14327,1468",
			shape=rectangle,
			width=8.5833];
		l2_attn_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_7<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="14009,1396",
			shape=rectangle,
			width=9.5833];
		l2_q_proj_7 -> l2_attn_7	[pos="e,14186,1414.4 14186,1449.8 14186,1449.8 14186,1424.4 14186,1424.4"];
		l2_k_proj_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="13691,1468",
			shape=rectangle,
			width=8.5694];
		l2_k_proj_7 -> l2_attn_7	[pos="e,13832,1414.4 13832,1449.8 13832,1449.8 13832,1424.4 13832,1424.4"];
		l2_v_proj_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="13056,1468",
			shape=rectangle,
			width=8.5694];
		l2_v_proj_7 -> l2_attn_7	[pos="e,13664,1396 13359,1449.8 13359,1428.5 13359,1396 13359,1396 13359,1396 13654,1396 13654,1396"];
		l2_out_proj_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="14837,1324",
			shape=rectangle,
			width=8.8889];
		l2_attn_7 -> l2_out_proj_7	[pos="e,14576,1342.1 14354,1402 14473,1402 14576,1402 14576,1402 14576,1402 14576,1352.1 14576,1352.1"];
		l2_res_7	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="14926,1252",
			width=14.06];
		l2_out_proj_7 -> l2_res_7	[pos="e,14837,1267 14837,1305.8 14837,1305.8 14837,1277 14837,1277"];
		l2_ln1_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="14926,1180",
			shape=rectangle,
			width=8.2361];
		l2_res_7 -> l2_ln1_7	[pos="e,14926,1198.4 14926,1233.8 14926,1233.8 14926,1208.4 14926,1208.4"];
		l2_ffn_up_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="14785,1108",
			shape=rectangle,
			width=8.6528];
		l2_ln1_7 -> l2_ffn_up_7	[pos="e,14863,1126.4 14863,1161.8 14863,1161.8 14863,1136.4 14863,1136.4"];
		l2_res2_7	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="14977,964",
			width=14.268];
		l2_ln1_7 -> l2_res2_7	[pos="e,15161,975.72 15161,1162 15161,1162 15161,985.72 15161,985.72"];
		l2_ffn_down_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="14782,1036",
			shape=rectangle,
			width=8.8333];
		l2_ffn_up_7 -> l2_ffn_down_7	[pos="e,14785,1054.4 14785,1089.8 14785,1089.8 14785,1064.4 14785,1064.4"];
		l2_ffn_down_7 -> l2_res2_7	[pos="e,14782,975.41 14782,1017.8 14782,1017.8 14782,985.41 14782,985.41"];
		l2_ln2_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_7<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="14705,892",
			shape=rectangle,
			width=8.2361];
		l2_res2_7 -> l2_ln2_7	[pos="e,14732,910.12 14732,954.29 14732,954.29 14732,920.12 14732,920.12"];
	}
	subgraph cluster_layer3 {
		graph [bb="2132,145,17479,794",
			fontsize=12,
			label="Layer 3 (Pipeline Stage 1, TP=8)",
			lheight=0.18,
			lp="9805.5,783.5",
			lwidth=2.76,
			style=rounded
		];
		l3_q_proj_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="12046,747",
			shape=rectangle,
			width=8.5833];
		l3_attn_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_8<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="13000,675",
			shape=rectangle,
			width=9.5833];
		l3_q_proj_0 -> l3_attn_0	[pos="e,12655,681 12304,728.97 12304,709.42 12304,681 12304,681 12304,681 12645,681 12645,681"];
		l3_k_proj_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="13317,747",
			shape=rectangle,
			width=8.5694];
		l3_k_proj_0 -> l3_attn_0	[pos="e,13177,693.41 13177,728.83 13177,728.83 13177,703.41 13177,703.41"];
		l3_v_proj_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="12682,747",
			shape=rectangle,
			width=8.5694];
		l3_v_proj_0 -> l3_attn_0	[pos="e,12823,693.41 12823,728.83 12823,728.83 12823,703.41 12823,703.41"];
		l3_out_proj_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="13430,603",
			shape=rectangle,
			width=8.8889];
		l3_attn_0 -> l3_out_proj_0	[pos="e,13228,621.41 13228,656.83 13228,656.83 13228,631.41 13228,631.41"];
		l3_res_0	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="14723,531",
			width=14.06];
		l3_out_proj_0 -> l3_res_0	[pos="e,14233,531.88 13750,609 13974,609 14233,609 14233,609 14233,609 14233,541.88 14233,541.88"];
		l3_ln1_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="14723,459",
			shape=rectangle,
			width=8.2361];
		l3_res_0 -> l3_ln1_0	[pos="e,14723,477.41 14723,512.83 14723,512.83 14723,487.41 14723,487.41"];
		l3_ffn_up_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="14472,387",
			shape=rectangle,
			width=8.6528];
		l3_ln1_0 -> l3_ffn_up_0	[pos="e,14605,405.41 14605,440.83 14605,440.83 14605,415.41 14605,415.41"];
		l3_res2_0	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="14801,243",
			width=14.268];
		l3_ln1_0 -> l3_res2_0	[pos="e,14903,257.64 14903,440.96 14903,440.96 14903,267.64 14903,267.64"];
		l3_ffn_down_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="14469,315",
			shape=rectangle,
			width=8.8333];
		l3_ffn_up_0 -> l3_ffn_down_0	[pos="e,14472,333.41 14472,368.83 14472,368.83 14472,343.41 14472,343.41"];
		l3_ffn_down_0 -> l3_res2_0	[pos="e,14537,251.96 14537,296.83 14537,296.83 14537,261.96 14537,261.96"];
		l3_ln2_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="14259,171",
			shape=rectangle,
			width=8.2361];
		l3_res2_0 -> l3_ln2_0	[pos="e,14421,189.31 14421,238.28 14421,238.28 14421,199.31 14421,199.31"];
		l3_q_proj_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="5642,747",
			shape=rectangle,
			width=8.5833];
		l3_attn_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_9<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="5324,675",
			shape=rectangle,
			width=9.5833];
		l3_q_proj_1 -> l3_attn_1	[pos="e,5501,693.41 5501,728.83 5501,728.83 5501,703.41 5501,703.41"];
		l3_k_proj_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="5006,747",
			shape=rectangle,
			width=8.5694];
		l3_k_proj_1 -> l3_attn_1	[pos="e,5146.8,693.41 5146.8,728.83 5146.8,728.83 5146.8,703.41 5146.8,703.41"];
		l3_v_proj_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="4371,747",
			shape=rectangle,
			width=8.5694];
		l3_v_proj_1 -> l3_attn_1	[pos="e,4978.9,681 4596,728.97 4596,709.42 4596,681 4596,681 4596,681 4968.9,681 4968.9,681"];
		l3_out_proj_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="6266,603",
			shape=rectangle,
			width=8.8889];
		l3_attn_1 -> l3_out_proj_1	[pos="e,5959.8,621.03 5669.3,669 5818.6,669 5959.8,669 5959.8,669 5959.8,669 5959.8,631.03 5959.8,631.03"];
		l3_res_1	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10274,531",
			width=14.06];
		l3_out_proj_1 -> l3_res_1	[pos="e,9832.1,533.35 6266,584.94 6266,573.56 6266,561 6266,561 6266,561 9832.1,561 9832.1,561 9832.1,561 9832.1,543.35 9832.1,543.35"];
		l3_ln1_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10274,459",
			shape=rectangle,
			width=8.2361];
		l3_res_1 -> l3_ln1_1	[pos="e,10274,477.41 10274,512.83 10274,512.83 10274,487.41 10274,487.41"];
		l3_ffn_up_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="10266,387",
			shape=rectangle,
			width=8.6528];
		l3_ln1_1 -> l3_ffn_up_1	[pos="e,10274,405.41 10274,440.83 10274,440.83 10274,415.41 10274,415.41"];
		l3_res2_1	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10595,243",
			width=14.268];
		l3_ln1_1 -> l3_res2_1	[pos="e,10680,258.19 10571,459 10633,459 10680,459 10680,459 10680,459 10680,268.19 10680,268.19"];
		l3_ffn_down_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10262,315",
			shape=rectangle,
			width=8.8333];
		l3_ffn_up_1 -> l3_ffn_down_1	[pos="e,10266,333.41 10266,368.83 10266,368.83 10266,343.41 10266,343.41"];
		l3_ffn_down_1 -> l3_res2_1	[pos="e,10331,251.96 10331,296.83 10331,296.83 10331,261.96 10331,261.96"];
		l3_ln2_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="10812,171",
			shape=rectangle,
			width=8.2361];
		l3_res2_1 -> l3_ln2_1	[pos="e,10812,189.21 10812,232.38 10812,232.38 10812,199.21 10812,199.21"];
		l3_q_proj_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="8203,747",
			shape=rectangle,
			width=8.6528];
		l3_attn_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_10<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="9164,675",
			shape=rectangle,
			width=9.6528];
		l3_q_proj_2 -> l3_attn_2	[pos="e,8816.4,675 8203,728.83 8203,707.5 8203,675 8203,675 8203,675 8806.4,675 8806.4,675"];
		l3_k_proj_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="9485,747",
			shape=rectangle,
			width=8.6528];
		l3_k_proj_2 -> l3_attn_2	[pos="e,9342.5,693.41 9342.5,728.83 9342.5,728.83 9342.5,703.41 9342.5,703.41"];
		l3_v_proj_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="8844,747",
			shape=rectangle,
			width=8.6528];
		l3_v_proj_2 -> l3_attn_2	[pos="e,8986,693.41 8986,728.83 8986,728.83 8986,703.41 8986,703.41"];
		l3_out_proj_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="10931,603",
			shape=rectangle,
			width=8.9583];
		l3_attn_2 -> l3_out_proj_2	[pos="e,10674,621.03 9512,669 9958,669 10674,669 10674,669 10674,669 10674,631.03 10674,631.03"];
		l3_res_2	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12378,531",
			width=14.199];
		l3_out_proj_2 -> l3_res_2	[pos="e,12060,537.94 11108,584.86 11108,578.54 11108,573 11108,573 11108,573 12060,573 12060,573 12060,573 12060,547.94 12060,547.94"];
		l3_ln1_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12378,459",
			shape=rectangle,
			width=8.3056];
		l3_res_2 -> l3_ln1_2	[pos="e,12378,477.41 12378,512.83 12378,512.83 12378,487.41 12378,487.41"];
		l3_ffn_up_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="12368,387",
			shape=rectangle,
			width=8.7361];
		l3_ln1_2 -> l3_ffn_up_2	[pos="e,12378,405.41 12378,440.83 12378,440.83 12378,415.41 12378,415.41"];
		l3_res2_2	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12698,243",
			width=14.384];
		l3_ln1_2 -> l3_res2_2	[pos="e,12788,258.19 12677,459 12740,459 12788,459 12788,459 12788,459 12788,268.19 12788,268.19"];
		l3_ffn_down_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12366,315",
			shape=rectangle,
			width=8.9028];
		l3_ffn_up_2 -> l3_ffn_down_2	[pos="e,12368,333.41 12368,368.83 12368,368.83 12368,343.41 12368,343.41"];
		l3_ffn_down_2 -> l3_res2_2	[pos="e,12433,251.96 12433,296.83 12433,296.83 12433,261.96 12433,261.96"];
		l3_ln2_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="12806,171",
			shape=rectangle,
			width=8.3056];
		l3_res2_2 -> l3_ln2_2	[pos="e,12806,189.13 12806,228.43 12806,228.43 12806,199.13 12806,199.13"];
		l3_q_proj_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="7562,747",
			shape=rectangle,
			width=8.6528];
		l3_attn_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_11<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="7241,675",
			shape=rectangle,
			width=9.6528];
		l3_q_proj_3 -> l3_attn_3	[pos="e,7419.5,693.41 7419.5,728.83 7419.5,728.83 7419.5,703.41 7419.5,703.41"];
		l3_k_proj_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="6921,747",
			shape=rectangle,
			width=8.6528];
		l3_k_proj_3 -> l3_attn_3	[pos="e,7063,693.41 7063,728.83 7063,728.83 7063,703.41 7063,703.41"];
		l3_v_proj_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="6280,747",
			shape=rectangle,
			width=8.6528];
		l3_v_proj_3 -> l3_attn_3	[pos="e,6893.4,681 6277.2,728.97 6277.2,709.42 6277.2,681 6277.2,681 6277.2,681 6883.4,681 6883.4,681"];
		l3_out_proj_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="9638,603",
			shape=rectangle,
			width=8.9583];
		l3_attn_3 -> l3_out_proj_3	[pos="e,9315.4,603 7241,656.83 7241,635.5 7241,603 7241,603 7241,603 9305.4,603 9305.4,603"];
		l3_res_3	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11327,531",
			width=14.199];
		l3_out_proj_3 -> l3_res_3	[pos="e,10962,536.31 9896.3,584.58 9896.3,575.72 9896.3,567 9896.3,567 9896.3,567 10962,567 10962,567 10962,567 10962,546.31 10962,546.31"];
		l3_ln1_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11327,459",
			shape=rectangle,
			width=8.3056];
		l3_res_3 -> l3_ln1_3	[pos="e,11327,477.41 11327,512.83 11327,512.83 11327,487.41 11327,487.41"];
		l3_ffn_up_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="11317,387",
			shape=rectangle,
			width=8.7361];
		l3_ln1_3 -> l3_ffn_up_3	[pos="e,11327,405.41 11327,440.83 11327,440.83 11327,415.41 11327,415.41"];
		l3_res2_3	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11644,243",
			width=14.384];
		l3_ln1_3 -> l3_res2_3	[pos="e,11737,257.85 11626,459 11689,459 11737,459 11737,459 11737,459 11737,267.85 11737,267.85"];
		l3_ffn_down_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11315,315",
			shape=rectangle,
			width=8.9028];
		l3_ffn_up_3 -> l3_ffn_down_3	[pos="e,11317,333.41 11317,368.83 11317,368.83 11317,343.41 11317,343.41"];
		l3_ffn_down_3 -> l3_res2_3	[pos="e,11381,251.96 11381,296.83 11381,296.83 11381,261.96 11381,261.96"];
		l3_ln2_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="11917,171",
			shape=rectangle,
			width=8.3056];
		l3_res2_3 -> l3_ln2_3	[pos="e,11890,189.12 11890,233.29 11890,233.29 11890,199.12 11890,199.12"];
		l3_q_proj_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="11408,747",
			shape=rectangle,
			width=8.6528];
		l3_attn_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_12<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="11088,675",
			shape=rectangle,
			width=9.6528];
		l3_q_proj_4 -> l3_attn_4	[pos="e,11266,693.41 11266,728.83 11266,728.83 11266,703.41 11266,703.41"];
		l3_k_proj_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="10767,747",
			shape=rectangle,
			width=8.6528];
		l3_k_proj_4 -> l3_attn_4	[pos="e,10910,693.41 10910,728.83 10910,728.83 10910,703.41 10910,703.41"];
		l3_v_proj_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="10126,747",
			shape=rectangle,
			width=8.6528];
		l3_v_proj_4 -> l3_attn_4	[pos="e,10740,681 10199,728.97 10199,709.42 10199,681 10199,681 10199,681 10730,681 10730,681"];
		l3_out_proj_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="11930,603",
			shape=rectangle,
			width=8.9583];
		l3_attn_4 -> l3_out_proj_4	[pos="e,11664,621.03 11436,669 11557,669 11664,669 11664,669 11664,669 11664,631.03 11664,631.03"];
		l3_res_4	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13516,531",
			width=14.199];
		l3_out_proj_4 -> l3_res_4	[pos="e,13040,532.25 12253,603 12580,603 13040,603 13040,603 13040,603 13040,542.25 13040,542.25"];
		l3_ln1_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13516,459",
			shape=rectangle,
			width=8.3056];
		l3_res_4 -> l3_ln1_4	[pos="e,13516,477.41 13516,512.83 13516,512.83 13516,487.41 13516,487.41"];
		l3_ffn_up_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="13428,387",
			shape=rectangle,
			width=8.7361];
		l3_ln1_4 -> l3_ffn_up_4	[pos="e,13480,405.41 13480,440.83 13480,440.83 13480,415.41 13480,415.41"];
		l3_res2_4	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13752,243",
			width=14.384];
		l3_ln1_4 -> l3_res2_4	[pos="e,13781,260.24 13781,440.96 13781,440.96 13781,270.24 13781,270.24"];
		l3_ffn_down_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13426,315",
			shape=rectangle,
			width=8.9028];
		l3_ffn_up_4 -> l3_ffn_down_4	[pos="e,13428,333.41 13428,368.83 13428,368.83 13428,343.41 13428,343.41"];
		l3_ffn_down_4 -> l3_res2_4	[pos="e,13490,251.96 13490,296.83 13490,296.83 13490,261.96 13490,261.96"];
		l3_ln2_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="13643,171",
			shape=rectangle,
			width=8.3056];
		l3_res2_4 -> l3_ln2_4	[pos="e,13643,189.03 13643,228.78 13643,228.78 13643,199.03 13643,199.03"];
		l3_q_proj_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="2451,747",
			shape=rectangle,
			width=8.6528];
		l3_attn_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_13<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="3413,675",
			shape=rectangle,
			width=9.6528];
		l3_q_proj_5 -> l3_attn_5	[pos="e,3065.4,675 2451,728.83 2451,707.5 2451,675 2451,675 2451,675 3055.4,675 3055.4,675"];
		l3_k_proj_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="3733,747",
			shape=rectangle,
			width=8.6528];
		l3_k_proj_5 -> l3_attn_5	[pos="e,3591,693.41 3591,728.83 3591,728.83 3591,703.41 3591,703.41"];
		l3_v_proj_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="3092,747",
			shape=rectangle,
			width=8.6528];
		l3_v_proj_5 -> l3_attn_5	[pos="e,3234.5,693.41 3234.5,728.83 3234.5,728.83 3234.5,703.41 3234.5,703.41"];
		l3_out_proj_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="4190,603",
			shape=rectangle,
			width=8.9583];
		l3_attn_5 -> l3_out_proj_5	[pos="e,3956,621.03 3760.7,669 3866.8,669 3956,669 3956,669 3956,669 3956,631.03 3956,631.03"];
		l3_res_5	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9229,531",
			width=14.199];
		l3_out_proj_5 -> l3_res_5	[pos="e,8717.8,531 4190,584.83 4190,563.5 4190,531 4190,531 4190,531 8707.8,531 8707.8,531"];
		l3_ln1_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9229,459",
			shape=rectangle,
			width=8.3056];
		l3_res_5 -> l3_ln1_5	[pos="e,9229,477.41 9229,512.83 9229,512.83 9229,487.41 9229,487.41"];
		l3_ffn_up_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="9220,387",
			shape=rectangle,
			width=8.7361];
		l3_ln1_5 -> l3_ffn_up_5	[pos="e,9229,405.41 9229,440.83 9229,440.83 9229,415.41 9229,415.41"];
		l3_res2_5	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9546,243",
			width=14.384];
		l3_ln1_5 -> l3_res2_5	[pos="e,9639.3,257.85 9528,459 9591.3,459 9639.3,459 9639.3,459 9639.3,459 9639.3,267.85 9639.3,267.85"];
		l3_ffn_down_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9218,315",
			shape=rectangle,
			width=8.9028];
		l3_ffn_up_5 -> l3_ffn_down_5	[pos="e,9220,333.41 9220,368.83 9220,368.83 9220,343.41 9220,343.41"];
		l3_ffn_down_5 -> l3_res2_5	[pos="e,9283.3,251.96 9283.3,296.83 9283.3,296.83 9283.3,261.96 9283.3,261.96"];
		l3_ln2_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="9872,171",
			shape=rectangle,
			width=8.3056];
		l3_res2_5 -> l3_ln2_5	[pos="e,9818.4,189.17 9818.4,234.46 9818.4,234.46 9818.4,199.17 9818.4,199.17"];
		l3_q_proj_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="17160,747",
			shape=rectangle,
			width=8.6528];
		l3_attn_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_14<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="16593,675",
			shape=rectangle,
			width=9.6528];
		l3_q_proj_6 -> l3_attn_6	[pos="e,16894,693.41 16894,728.83 16894,728.83 16894,703.41 16894,703.41"];
		l3_k_proj_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="16519,747",
			shape=rectangle,
			width=8.6528];
		l3_k_proj_6 -> l3_attn_6	[pos="e,16538,693.41 16538,728.83 16538,728.83 16538,703.41 16538,703.41"];
		l3_v_proj_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="15878,747",
			shape=rectangle,
			width=8.6528];
		l3_v_proj_6 -> l3_attn_6	[pos="e,16245,675 16058,728.83 16058,707.5 16058,675 16058,675 16058,675 16235,675 16235,675"];
		l3_out_proj_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="16741,603",
			shape=rectangle,
			width=8.9583];
		l3_attn_6 -> l3_out_proj_6	[pos="e,16680,621.41 16680,656.83 16680,656.83 16680,631.41 16680,631.41"];
		l3_res_6	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="16816,531",
			width=14.199];
		l3_out_proj_6 -> l3_res_6	[pos="e,16741,546.48 16741,584.83 16741,584.83 16741,556.48 16741,556.48"];
		l3_ln1_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="16816,459",
			shape=rectangle,
			width=8.3056];
		l3_res_6 -> l3_ln1_6	[pos="e,16816,477.41 16816,512.83 16816,512.83 16816,487.41 16816,487.41"];
		l3_ffn_up_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="16733,387",
			shape=rectangle,
			width=8.7361];
		l3_ln1_6 -> l3_ffn_up_6	[pos="e,16782,405.41 16782,440.83 16782,440.83 16782,415.41 16782,415.41"];
		l3_res2_6	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="16904,243",
			width=14.384];
		l3_ln1_6 -> l3_res2_6	[pos="e,17083,254.98 17083,440.96 17083,440.96 17083,264.98 17083,264.98"];
		l3_ffn_down_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="16730,315",
			shape=rectangle,
			width=8.9028];
		l3_ffn_up_6 -> l3_ffn_down_6	[pos="e,16733,333.41 16733,368.83 16733,368.83 16733,343.41 16733,343.41"];
		l3_ffn_down_6 -> l3_res2_6	[pos="e,16730,255.28 16730,296.83 16730,296.83 16730,265.28 16730,265.28"];
		l3_ln2_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="16033,171",
			shape=rectangle,
			width=8.3056];
		l3_res2_6 -> l3_ln2_6	[pos="e,16332,171 16904,224.83 16904,203.5 16904,171 16904,171 16904,171 16342,171 16342,171"];
		l3_q_proj_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Q Projection</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="15237,747",
			shape=rectangle,
			width=8.6528];
		l3_attn_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Flash Attention</b><br/>GPU: gpu_15<br/>Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]<br/>Output: [batch=1024, seq=?, heads=\
32, d_v=16]",
			pos="14917,675",
			shape=rectangle,
			width=9.6528];
		l3_q_proj_7 -> l3_attn_7	[pos="e,15095,693.41 15095,728.83 15095,728.83 15095,703.41 15095,703.41"];
		l3_k_proj_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>K Projection</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_k=16]",
			pos="14596,747",
			shape=rectangle,
			width=8.6528];
		l3_k_proj_7 -> l3_attn_7	[pos="e,14738,693.41 14738,728.83 14738,728.83 14738,703.41 14738,703.41"];
		l3_v_proj_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>V Projection</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, heads=32, d_v=16]",
			pos="13955,747",
			shape=rectangle,
			width=8.6528];
		l3_v_proj_7 -> l3_attn_7	[pos="e,14569,675 14250,728.83 14250,707.5 14250,675 14250,675 14250,675 14559,675 14559,675"];
		l3_out_proj_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Output Projection</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, heads=32, d_v=16]<br/>Output: [batch=1024, seq=?, hidden=\
512]",
			pos="15604,603",
			shape=rectangle,
			width=8.9583];
		l3_attn_7 -> l3_out_proj_7	[pos="e,15281,597 15246,656.91 15246,633.87 15246,597 15246,597 15246,597 15271,597 15271,597"];
		l3_res_7	[height=0.5,
			label="<b>Residual Add</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="15773,531",
			width=14.199];
		l3_out_proj_7 -> l3_res_7	[pos="e,15604,543.28 15604,584.83 15604,584.83 15604,553.28 15604,553.28"];
		l3_ln1_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 1</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="15773,459",
			shape=rectangle,
			width=8.3056];
		l3_res_7 -> l3_ln1_7	[pos="e,15773,477.41 15773,512.83 15773,512.83 15773,487.41 15773,487.41"];
		l3_ffn_up_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Up Projection</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, ffn_dim=2048]",
			pos="15521,387",
			shape=rectangle,
			width=8.7361];
		l3_ln1_7 -> l3_ffn_up_7	[pos="e,15655,405.41 15655,440.83 15655,440.83 15655,415.41 15655,415.41"];
		l3_res2_7	[height=0.5,
			label="<b>Residual Add 2</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, hidden=512] × 2<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="15850,243",
			width=14.384];
		l3_ln1_7 -> l3_res2_7	[pos="e,15955,257.37 15955,440.96 15955,440.96 15955,267.37 15955,267.37"];
		l3_ffn_down_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>FFN Down Projection</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, ffn_dim=2048]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="15518,315",
			shape=rectangle,
			width=8.9028];
		l3_ffn_up_7 -> l3_ffn_down_7	[pos="e,15521,333.41 15521,368.83 15521,368.83 15521,343.41 15521,343.41"];
		l3_ffn_down_7 -> l3_res2_7	[pos="e,15585,251.96 15585,296.83 15585,296.83 15585,261.96 15585,261.96"];
		l3_ln2_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Layer Norm 2</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, hidden=512]",
			pos="15416,171",
			shape=rectangle,
			width=8.3056];
		l3_res2_7 -> l3_ln2_7	[pos="e,15524,189.2 15524,236.1 15524,236.1 15524,199.2 15524,199.2"];
	}
	subgraph cluster_output {
		graph [bb="10866,64,15800,137",
			fontsize=12,
			label="Output Layer (Pipeline Stage 1, TP=8)",
			lheight=0.18,
			lp="13333,126.5",
			lwidth=3.22,
			style=rounded
		];
		output_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Linear Output</b><br/>GPU: gpu_8<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, vocab=4000]",
			pos="14258,90",
			shape=rectangle,
			width=8.2639];
		output_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Linear Output</b><br/>GPU: gpu_9<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, vocab=4000]",
			pos="11790,90",
			shape=rectangle,
			width=8.2639];
		output_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Linear Output</b><br/>GPU: gpu_10<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, vocab=4000]",
			pos="13024,90",
			shape=rectangle,
			width=8.3333];
		output_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Linear Output</b><br/>GPU: gpu_11<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, vocab=4000]",
			pos="12406,90",
			shape=rectangle,
			width=8.3333];
		output_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Linear Output</b><br/>GPU: gpu_12<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, vocab=4000]",
			pos="13642,90",
			shape=rectangle,
			width=8.3333];
		output_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Linear Output</b><br/>GPU: gpu_13<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, vocab=4000]",
			pos="11174,90",
			shape=rectangle,
			width=8.3333];
		output_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Linear Output</b><br/>GPU: gpu_14<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, vocab=4000]",
			pos="15492,90",
			shape=rectangle,
			width=8.3333];
		output_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Linear Output</b><br/>GPU: gpu_15<br/>Input: [batch=1024, seq=?, hidden=512]<br/>Output: [batch=1024, seq=?, vocab=4000]",
			pos="14874,90",
			shape=rectangle,
			width=8.3333];
	}
	input	[fillcolor=lightblue,
		height=0.5,
		label="<b>Input</b><br/>Input: [batch_size=1024, seq_len=?, vocab_size=32000]",
		pos="9221,3136",
		shape=ellipse,
		width=5.6577];
	input -> embed_0	[pos="e,6988,3081.2 9044.4,3145 8516.7,3145 6988,3145 6988,3145 6988,3145 6988,3091.2 6988,3091.2"];
	input -> embed_1	[pos="e,7626,3081 9017,3136 8586.8,3136 7626,3136 7626,3136 7626,3136 7626,3091 7626,3091"];
	input -> embed_2	[pos="e,8264,3081.2 9044.4,3127 8767.8,3127 8264,3127 8264,3127 8264,3127 8264,3091.2 8264,3091.2"];
	input -> embed_3	[pos="e,9114.7,3081 9114.7,3120.5 9114.7,3120.5 9114.7,3091 9114.7,3091"];
	input -> embed_4	[pos="e,9268.9,3081 9268.9,3118.3 9268.9,3118.3 9268.9,3091 9268.9,3091"];
	input -> embed_5	[pos="e,9975.6,3081.2 9307.9,3119.7 9307.9,3106.4 9307.9,3090 9307.9,3090 9307.9,3090 9975.6,3090 9975.6,3090 9975.6,3090 9975.6,3089.1 \
9975.6,3089.1"];
	input -> embed_6	[pos="e,10624,3081.4 9346.8,3121.8 9346.8,3111.4 9346.8,3099 9346.8,3099 9346.8,3099 10624,3099 10624,3099 10624,3099 10624,3091.4 10624,\
3091.4"];
	input -> embed_7	[pos="e,11272,3081 9385.7,3125.3 9385.7,3117.4 9385.7,3108 9385.7,3108 9385.7,3108 11272,3108 11272,3108 11272,3108 11272,3091 11272,3091"];
	pos_enc_0 -> l0_q_proj_0	[pos="e,1596,2928.2 6677.8,2982 5530.8,2982 1596,2982 1596,2982 1596,2982 1596,2938.2 1596,2938.2"];
	pos_enc_0 -> l0_k_proj_0	[pos="e,960,2928.4 6677.9,2991 5445.4,2991 960,2991 960,2991 960,2991 960,2938.4 960,2938.4"];
	pos_enc_0 -> l0_v_proj_0	[pos="e,325,2928.2 6677.8,3000 5363.9,3000 325,3000 325,3000 325,3000 325,2938.2 325,2938.2"];
	pos_enc_0 -> l0_res_0	[pos="e,6588.9,2696.4 6998.8,2972.8 6998.8,2937.2 6998.8,2862 6998.8,2862 6998.8,2862 6588.9,2862 6588.9,2862 6588.9,2862 6588.9,2706.4 \
6588.9,2706.4"];
	pos_enc_1 -> l0_q_proj_1	[pos="e,3503,2928.3 7502,2972.8 7502,2968 7502,2964 7502,2964 7502,2964 3503,2964 3503,2964 3503,2964 3503,2938.3 3503,2938.3"];
	pos_enc_1 -> l0_k_proj_1	[pos="e,2867,2928 7440,2972.8 7440,2969.5 7440,2967 7440,2967 7440,2967 2867,2967 2867,2967 2867,2967 2867,2938 2867,2938"];
	pos_enc_1 -> l0_v_proj_1	[pos="e,2232,2928 7378,2972.9 7378,2971.2 7378,2970 7378,2970 7378,2970 2232,2970 2232,2970 2232,2970 2232,2938 2232,2938"];
	pos_enc_1 -> l0_res_1	[pos="e,7658.7,2694 7635.2,2972.9 7635.2,2908.4 7635.2,2694 7635.2,2694 7635.2,2694 7648.7,2694 7648.7,2694"];
	pos_enc_2 -> l0_q_proj_2	[pos="e,5410,2928 8138.5,2972.6 8138.5,2963.7 8138.5,2955 8138.5,2955 8138.5,2955 5410,2955 5410,2955 5410,2955 5410,2938 5410,2938"];
	pos_enc_2 -> l0_k_proj_2	[pos="e,4774,2928.1 8077,2973 8077,2965.3 8077,2958 8077,2958 8077,2958 4774,2958 4774,2958 4774,2958 4774,2938.1 4774,2938.1"];
	pos_enc_2 -> l0_v_proj_2	[pos="e,4139,2928.1 8015.5,2972.9 8015.5,2966.5 8015.5,2961 8015.5,2961 8015.5,2961 4139,2961 4139,2961 4139,2961 4139,2938.1 4139,2938.1"];
	pos_enc_2 -> l0_res_2	[pos="e,8880.6,2700.5 8270.5,2972.9 8270.5,2912.3 8270.5,2721 8270.5,2721 8270.5,2721 8880.6,2721 8880.6,2721 8880.6,2721 8880.6,2710.5 \
8880.6,2710.5"];
	pos_enc_3 -> l0_q_proj_3	[pos="e,7564,2928 8774.7,2972.9 8774.7,2959.3 8774.7,2943 8774.7,2943 8774.7,2943 7564,2943 7564,2943 7564,2943 7564,2938 7564,2938"];
	pos_enc_3 -> l0_k_proj_3	[pos="e,6833.8,2928.4 8713.8,2973 8713.8,2960.4 8713.8,2946 8713.8,2946 8713.8,2946 6833.8,2946 6833.8,2946 6833.8,2946 6833.8,2938.4 \
6833.8,2938.4"];
	pos_enc_3 -> l0_v_proj_3	[pos="e,6046,2928.1 8652.9,2972.9 8652.9,2962.7 8652.9,2952 8652.9,2952 8652.9,2952 6046,2952 6046,2952 6046,2952 6046,2938.1 6046,2938.1"];
	pos_enc_3 -> l0_res_3	[pos="e,10382,2711.3 8905.8,2972.9 8905.8,2938.6 8905.8,2868 8905.8,2868 8905.8,2868 10382,2868 10382,2868 10382,2868 10382,2721.3 10382,\
2721.3"];
	pos_enc_4 -> l0_q_proj_4	[pos="e,9457.2,2928 9457.2,2972.6 9457.2,2972.6 9457.2,2938 9457.2,2938"];
	pos_enc_4 -> l0_k_proj_4	[pos="e,8835.6,2928.2 9381.5,2972.7 9381.5,2957.1 9381.5,2937 9381.5,2937 9381.5,2937 8835.6,2937 8835.6,2937 8835.6,2937 8835.6,2936.1 \
8835.6,2936.1"];
	pos_enc_4 -> l0_v_proj_4	[pos="e,8200,2928.1 9305.8,2972.9 9305.8,2958.2 9305.8,2940 9305.8,2940 9305.8,2940 8200,2940 8200,2940 8200,2940 8200,2938.1 8200,2938.1"];
	pos_enc_4 -> l0_res_4	[pos="e,11077,2698.7 9542.2,2972.6 9542.2,2913.2 9542.2,2730 9542.2,2730 9542.2,2730 11077,2730 11077,2730 11077,2730 11077,2708.7 11077,\
2708.7"];
	pos_enc_5 -> l0_q_proj_5	[pos="e,10898,2928.1 10388,2973 10388,2955.3 10388,2931 10388,2931 10388,2931 10898,2931 10898,2931 10898,2931 10898,2930.7 10898,2930.7"];
	pos_enc_5 -> l0_k_proj_5	[pos="e,10287,2928 10287,2972.6 10287,2972.6 10287,2938 10287,2938"];
	pos_enc_5 -> l0_v_proj_5	[pos="e,10018,2928 10018,2972.6 10018,2972.6 10018,2938 10018,2938"];
	pos_enc_5 -> l0_res_5	[pos="e,12254,2703.9 10178,2973 10178,2940.2 10178,2874 10178,2874 10178,2874 12254,2874 12254,2874 12254,2874 12254,2713.9 12254,2713.9"];
	pos_enc_6 -> l0_q_proj_6	[pos="e,13040,2928.1 11050,2972.9 11050,2961.6 11050,2949 11050,2949 11050,2949 13040,2949 13040,2949 13040,2949 13040,2938.1 13040,2938.1"];
	pos_enc_6 -> l0_k_proj_6	[pos="e,12121,2891.8 10816,2972.7 10816,2942.6 10816,2886 10816,2886 10816,2886 12121,2886 12121,2886 12121,2886 12121,2886.6 12121,2886.6"];
	pos_enc_6 -> l0_v_proj_6	[pos="e,11611,2928.2 10974,2973 10974,2956.3 10974,2934 10974,2934 10974,2934 11611,2934 11611,2934 11611,2934 11611,2933.4 11611,2933.4"];
	pos_enc_6 -> l0_res_6	[pos="e,13727,2705.4 10810,2972.7 10810,2941.1 10810,2880 10810,2880 10810,2880 13727,2880 13727,2880 13727,2880 13727,2715.4 13727,2715.4"];
	pos_enc_7 -> l0_q_proj_7	[pos="e,14663,2928.2 11764,3000 12569,3000 14663,3000 14663,3000 14663,3000 14663,2938.2 14663,2938.2"];
	pos_enc_7 -> l0_k_proj_7	[pos="e,14016,2928.4 11764,2991 12446,2991 14016,2991 14016,2991 14016,2991 14016,2938.4 14016,2938.4"];
	pos_enc_7 -> l0_v_proj_7	[pos="e,13369,2928.2 11764,2982 12306,2982 13369,2982 13369,2982 13369,2982 13369,2938.2 13369,2938.2"];
	pos_enc_7 -> l0_res_7	[pos="e,14120,2696.3 11449,2972.9 11449,2925.6 11449,2802 11449,2802 11449,2802 14120,2802 14120,2802 14120,2802 14120,2706.3 14120,2706.3"];
	comm_stage0_to_stage1	[fillcolor=lightyellow,
		height=0.5,
		label="<b>Pipeline Communication</b><br/>All GPUs 0-7 to All GPUs 8-15<br/>[batch=1024, seq=?, hidden=512]",
		pos="10599,2262",
		shape=parallelogram,
		width=11.676];
	l0_ln2_0 -> comm_stage0_to_stage1	[pos="e,10332,2276 7616,2316 7616,2298.9 7616,2276 7616,2276 7616,2276 10322,2276 10322,2276"];
	l0_ln2_1 -> comm_stage0_to_stage1	[pos="e,10341,2278 8884.5,2316 8884.5,2299.6 8884.5,2278 8884.5,2278 8884.5,2278 10331,2278 10331,2278"];
	l0_ln2_2 -> comm_stage0_to_stage1	[pos="e,10235,2262.1 10111,2334 10181,2334 10235,2334 10235,2334 10235,2334 10235,2272.1 10235,2272.1"];
	l0_ln2_3 -> comm_stage0_to_stage1	[pos="e,10588,2280.4 10588,2315.8 10588,2315.8 10588,2290.4 10588,2290.4"];
	l0_ln2_4 -> comm_stage0_to_stage1	[pos="e,11015,2262.1 11119,2334 11060,2334 11015,2334 11015,2334 11015,2334 11015,2272.1 11015,2272.1"];
	l0_ln2_5 -> comm_stage0_to_stage1	[pos="e,11005,2277 12230,2316 12230,2299.3 12230,2277 12230,2277 12230,2277 11015,2277 11015,2277"];
	l0_ln2_6 -> comm_stage0_to_stage1	[pos="e,10991,2274 13056,2316 13056,2298.3 13056,2274 13056,2274 13056,2274 11001,2274 11001,2274"];
	l0_ln2_7 -> comm_stage0_to_stage1	[pos="e,10976,2271 14196,2315.8 14196,2297.2 14196,2271 14196,2271 14196,2271 10986,2271 10986,2271"];
	comm_stage0_to_stage1 -> l1_q_proj_0	[pos="e,10336,2207.1 10336,2244 10336,2244 10336,2217.1 10336,2217.1"];
	comm_stage0_to_stage1 -> l1_k_proj_0	[pos="e,11430,2207 10857,2246 11101,2246 11430,2246 11430,2246 11430,2246 11430,2217 11430,2217"];
	comm_stage0_to_stage1 -> l1_v_proj_0	[pos="e,10766,2207.1 10766,2244 10766,2244 10766,2217.1 10766,2217.1"];
	comm_stage0_to_stage1 -> l1_res_0	[pos="e,12485,1975.8 10506,2243.9 10506,2187.1 10506,2016 10506,2016 10506,2016 12485,2016 12485,2016 12485,2016 12485,1985.8 12485,1985.8"];
	comm_stage0_to_stage1 -> l1_q_proj_1	[pos="e,3960.2,2207.2 10274,2264 8941.4,2264 3960.2,2264 3960.2,2264 3960.2,2264 3960.2,2217.2 3960.2,2217.2"];
	comm_stage0_to_stage1 -> l1_k_proj_1	[pos="e,3146.8,2207.2 10284,2266 8865.9,2266 3146.8,2266 3146.8,2266 3146.8,2266 3146.8,2217.2 3146.8,2217.2"];
	comm_stage0_to_stage1 -> l1_v_proj_1	[pos="e,2688.5,2207.3 10293,2268 8839.1,2268 2688.5,2268 2688.5,2268 2688.5,2268 2688.5,2217.3 2688.5,2217.3"];
	comm_stage0_to_stage1 -> l1_res_1	[pos="e,8812.8,1982.6 10497,2243.9 10497,2186.4 10497,2011 10497,2011 10497,2011 8812.8,2011 8812.8,2011 8812.8,2011 8812.8,1992.6 8812.8,\
1992.6"];
	comm_stage0_to_stage1 -> l1_q_proj_2	[pos="e,6588.7,2207.2 10241,2257 9257.6,2257 6588.7,2257 6588.7,2257 6588.7,2257 6588.7,2217.2 6588.7,2217.2"];
	comm_stage0_to_stage1 -> l1_k_proj_2	[pos="e,7924,2207.2 10222,2253 9484.5,2253 7924,2253 7924,2253 7924,2253 7924,2217.2 7924,2217.2"];
	comm_stage0_to_stage1 -> l1_v_proj_2	[pos="e,7062.9,2207 10231,2255 9325.6,2255 7062.9,2255 7062.9,2255 7062.9,2255 7062.9,2217 7062.9,2217"];
	comm_stage0_to_stage1 -> l1_res_2	[pos="e,10503,1983.7 10503,2243.9 10503,2243.9 10503,1993.7 10503,1993.7"];
	comm_stage0_to_stage1 -> l1_q_proj_3	[pos="e,5703.2,2207 10250,2259 9131.4,2259 5703.2,2259 5703.2,2259 5703.2,2259 5703.2,2217 5703.2,2217"];
	comm_stage0_to_stage1 -> l1_k_proj_3	[pos="e,5060,2207.2 10260,2261 9056,2261 5060,2261 5060,2261 5060,2261 5060,2217.2 5060,2217.2"];
	comm_stage0_to_stage1 -> l1_v_proj_3	[pos="e,4598,2207 10265,2262 9002.2,2262 4598,2262 4598,2262 4598,2262 4598,2217 4598,2217"];
	comm_stage0_to_stage1 -> l1_res_3	[pos="e,9980.3,1977.9 10500,2243.7 10500,2183.6 10500,1996 10500,1996 10500,1996 9980.3,1996 9980.3,1996 9980.3,1996 9980.3,1987.9 9980.3,\
1987.9"];
	comm_stage0_to_stage1 -> l1_q_proj_4	[pos="e,9688,2207 10183,2245 9943.2,2245 9688,2245 9688,2245 9688,2245 9688,2217 9688,2217"];
	comm_stage0_to_stage1 -> l1_k_proj_4	[pos="e,9196,2207 10193,2247 9778.4,2247 9196,2247 9196,2247 9196,2247 9196,2217 9196,2217"];
	comm_stage0_to_stage1 -> l1_v_proj_4	[pos="e,8265,2207 10202,2249 9536.3,2249 8265,2249 8265,2249 8265,2249 8265,2217 8265,2217"];
	comm_stage0_to_stage1 -> l1_res_4	[pos="e,11774,1988.6 10871,2249 11218,2249 11774,2249 11774,2249 11774,2249 11774,1998.6 11774,1998.6"];
	comm_stage0_to_stage1 -> l1_q_proj_5	[pos="e,776.5,2207 10322,2274 8725.6,2274 776.5,2274 776.5,2274 776.5,2274 776.5,2217 776.5,2217"];
	comm_stage0_to_stage1 -> l1_k_proj_5	[pos="e,2053.5,2207.4 10303,2270 8796.6,2270 2053.5,2270 2053.5,2270 2053.5,2270 2053.5,2217.4 2053.5,2217.4"];
	comm_stage0_to_stage1 -> l1_v_proj_5	[pos="e,1403.2,2207 10312,2272 8757.5,2272 1403.2,2272 1403.2,2272 1403.2,2272 1403.2,2217 1403.2,2217"];
	comm_stage0_to_stage1 -> l1_res_5	[pos="e,7944.5,1976.1 10212,2251 9475.3,2251 7944.5,2251 7944.5,2251 7944.5,2251 7944.5,1986.1 7944.5,1986.1"];
	comm_stage0_to_stage1 -> l1_q_proj_6	[pos="e,15081,2207.3 10962,2268 12029,2268 15081,2268 15081,2268 15081,2268 15081,2217.3 15081,2217.3"];
	comm_stage0_to_stage1 -> l1_k_proj_6	[pos="e,14502,2207.2 10953,2266 11914,2266 14502,2266 14502,2266 14502,2266 14502,2217.2 14502,2217.2"];
	comm_stage0_to_stage1 -> l1_v_proj_6	[pos="e,13885,2207.3 10924,2260 11753,2260 13885,2260 13885,2260 13885,2260 13885,2217.3 13885,2217.3"];
	comm_stage0_to_stage1 -> l1_res_6	[pos="e,14589,1975.6 10509,2243.9 10509,2187.8 10509,2021 10509,2021 10509,2021 14589,2021 14589,2021 14589,2021 14589,1985.6 14589,1985.6"];
	comm_stage0_to_stage1 -> l1_q_proj_7	[pos="e,13352,2207.2 10909,2257 11629,2257 13352,2257 13352,2257 13352,2257 13352,2217.2 13352,2217.2"];
	comm_stage0_to_stage1 -> l1_k_proj_7	[pos="e,12536,2207 10900,2255 11444,2255 12536,2255 12536,2255 12536,2255 12536,2217 12536,2217"];
	comm_stage0_to_stage1 -> l1_v_proj_7	[pos="e,11911,2207.2 10886,2252 11272,2252 11911,2252 11911,2252 11911,2252 11911,2217.2 11911,2217.2"];
	comm_stage0_to_stage1 -> l1_res_7	[pos="e,14338,1978.5 10938,2263 11859,2263 14338,2263 14338,2263 14338,2263 14338,1988.5 14338,1988.5"];
	comm_stage1_to_stage0	[fillcolor=lightyellow,
		height=0.5,
		label="<b>Pipeline Communication</b><br/>All GPUs 8-15 to All GPUs 0-7<br/>[batch=1024, seq=?, hidden=512]",
		pos="11468,1541",
		shape=parallelogram,
		width=11.676];
	l1_ln2_0 -> comm_stage1_to_stage0	[pos="e,11874,1556 12548,1595 12548,1578.3 12548,1556 12548,1556 12548,1556 11884,1556 11884,1556"];
	l1_ln2_1 -> comm_stage1_to_stage0	[pos="e,11200,1555 9226.5,1595 9226.5,1577.9 9226.5,1555 9226.5,1555 9226.5,1555 11190,1555 11190,1555"];
	l1_ln2_2 -> comm_stage1_to_stage0	[pos="e,11226,1559.4 11226,1594.8 11226,1594.8 11226,1569.4 11226,1569.4"];
	l1_ln2_3 -> comm_stage1_to_stage0	[pos="e,11210,1557 10388,1595 10388,1578.6 10388,1557 10388,1557 10388,1557 11200,1557 11200,1557"];
	l1_ln2_4 -> comm_stage1_to_stage0	[pos="e,11710,1559.4 11710,1594.8 11710,1594.8 11710,1569.4 11710,1569.4"];
	l1_ln2_5 -> comm_stage1_to_stage0	[pos="e,11191,1553 7849.2,1595 7849.2,1577.3 7849.2,1553 7849.2,1553 7849.2,1553 11181,1553 11181,1553"];
	l1_ln2_6 -> comm_stage1_to_stage0	[pos="e,11845,1550 14468,1594.8 14468,1576.2 14468,1550 14468,1550 14468,1550 11855,1550 11855,1550"];
	l1_ln2_7 -> comm_stage1_to_stage0	[pos="e,11860,1553 13334,1595 13334,1577.3 13334,1553 13334,1553 13334,1553 11870,1553 11870,1553"];
	comm_stage1_to_stage0 -> l2_q_proj_0	[pos="e,11322,1486.1 11322,1523 11322,1523 11322,1496.1 11322,1496.1"];
	comm_stage1_to_stage0 -> l2_k_proj_0	[pos="e,12121,1486 11726,1525 11909,1525 12121,1525 12121,1525 12121,1525 12121,1496 12121,1496"];
	comm_stage1_to_stage0 -> l2_v_proj_0	[pos="e,11683,1486.1 11683,1523 11683,1523 11683,1496.1 11683,1496.1"];
	comm_stage1_to_stage0 -> l2_res_0	[pos="e,13380,1252.2 11754,1531 12288,1531 13380,1531 13380,1531 13380,1531 13380,1262.2 13380,1262.2"];
	comm_stage1_to_stage0 -> l2_q_proj_1	[pos="e,5067.8,1486.2 11153,1545 9864.6,1545 5067.8,1545 5067.8,1545 5067.8,1545 5067.8,1496.2 5067.8,1496.2"];
	comm_stage1_to_stage0 -> l2_k_proj_1	[pos="e,4275.8,1486.3 11162,1547 9791.5,1547 4275.8,1547 4275.8,1547 4275.8,1547 4275.8,1496.3 4275.8,1496.3"];
	comm_stage1_to_stage0 -> l2_v_proj_1	[pos="e,3819.8,1486.2 11167,1548 9750.8,1548 3819.8,1548 3819.8,1548 3819.8,1548 3819.8,1496.2 3819.8,1496.2"];
	comm_stage1_to_stage0 -> l2_res_1	[pos="e,9560.5,1267.3 11076,1529 10518,1529 9560.5,1529 9560.5,1529 9560.5,1529 9560.5,1277.3 9560.5,1277.3"];
	comm_stage1_to_stage0 -> l2_q_proj_2	[pos="e,7541,1486 11119,1538 10158,1538 7541,1538 7541,1538 7541,1538 7541,1496 7541,1496"];
	comm_stage1_to_stage0 -> l2_k_proj_2	[pos="e,8608,1486.3 11105,1535 10335,1535 8608,1535 8608,1535 8608,1535 8608,1496.3 8608,1496.3"];
	comm_stage1_to_stage0 -> l2_v_proj_2	[pos="e,8248.4,1486.2 11110,1536 10270,1536 8248.4,1536 8248.4,1536 8248.4,1536 8248.4,1496.2 8248.4,1496.2"];
	comm_stage1_to_stage0 -> l2_res_2	[pos="e,11464,1259.2 11464,1522.9 11464,1522.9 11464,1269.2 11464,1269.2"];
	comm_stage1_to_stage0 -> l2_q_proj_3	[pos="e,6818.2,1486.2 11129,1540 10058,1540 6818.2,1540 6818.2,1540 6818.2,1540 6818.2,1496.2 6818.2,1496.2"];
	comm_stage1_to_stage0 -> l2_k_proj_3	[pos="e,6202,1486 11134,1541 9974.8,1541 6202,1541 6202,1541 6202,1541 6202,1496 6202,1496"];
	comm_stage1_to_stage0 -> l2_v_proj_3	[pos="e,5733,1486.2 11143,1543 9930,1543 5733,1543 5733,1543 5733,1543 5733,1496.2 5733,1496.2"];
	comm_stage1_to_stage0 -> l2_res_3	[pos="e,10832,1263.7 11052,1524 10932,1524 10832,1524 10832,1524 10832,1524 10832,1273.7 10832,1273.7"];
	comm_stage1_to_stage0 -> l2_q_proj_4	[pos="e,10815,1486 11062,1526 10929,1526 10815,1526 10815,1526 10815,1526 10815,1496 10815,1496"];
	comm_stage1_to_stage0 -> l2_k_proj_4	[pos="e,10080,1486 11072,1528 10661,1528 10080,1528 10080,1528 10080,1528 10080,1496 10080,1496"];
	comm_stage1_to_stage0 -> l2_v_proj_4	[pos="e,9535,1486.2 11086,1531 10522,1531 9535,1531 9535,1531 9535,1531 9535,1496.2 9535,1496.2"];
	comm_stage1_to_stage0 -> l2_res_4	[pos="e,12392,1254.1 11468,1522.7 11468,1475.7 11468,1354 11468,1354 11468,1354 12392,1354 12392,1354 12392,1354 12392,1264.1 12392,1264.1"];
	comm_stage1_to_stage0 -> l2_q_proj_5	[pos="e,1912.8,1486.4 11185,1522.9 11185,1513.5 11185,1504 11185,1504 11185,1504 1912.8,1504 1912.8,1504 1912.8,1504 1912.8,1496.4 1912.8,\
1496.4"];
	comm_stage1_to_stage0 -> l2_k_proj_5	[pos="e,3157.2,1486.2 11177,1550 9705.2,1550 3157.2,1550 3157.2,1550 3157.2,1550 3157.2,1496.2 3157.2,1496.2"];
	comm_stage1_to_stage0 -> l2_v_proj_5	[pos="e,2284,1486.2 11186,1552 9642.9,1552 2284,1552 2284,1552 2284,1552 2284,1496.2 2284,1496.2"];
	comm_stage1_to_stage0 -> l2_res_5	[pos="e,8930,1252.5 11096,1533 10390,1533 8930,1533 8930,1533 8930,1533 8930,1262.5 8930,1262.5"];
	comm_stage1_to_stage0 -> l2_q_proj_6	[pos="e,15965,1486.3 11831,1547 12901,1547 15965,1547 15965,1547 15965,1547 15965,1496.3 15965,1496.3"];
	comm_stage1_to_stage0 -> l2_k_proj_6	[pos="e,15423,1486.2 11822,1545 12792,1545 15423,1545 15423,1545 15423,1545 15423,1496.2 15423,1496.2"];
	comm_stage1_to_stage0 -> l2_v_proj_6	[pos="e,14777,1486.3 11793,1539 12626,1539 14777,1539 14777,1539 14777,1539 14777,1496.3 14777,1496.3"];
	comm_stage1_to_stage0 -> l2_res_6	[pos="e,15505,1253.6 11473,1522.9 11473,1478.2 11473,1366 11473,1366 11473,1366 15505,1366 15505,1366 15505,1366 15505,1263.6 15505,1263.6"];
	comm_stage1_to_stage0 -> l2_q_proj_7	[pos="e,14160,1486.2 11778,1536 12486,1536 14160,1536 14160,1536 14160,1536 14160,1496.2 14160,1496.2"];
	comm_stage1_to_stage0 -> l2_k_proj_7	[pos="e,13642,1486 11769,1534 12366,1534 13642,1534 13642,1534 13642,1534 13642,1496 13642,1496"];
	comm_stage1_to_stage0 -> l2_v_proj_7	[pos="e,12853,1486 11740,1528 12144,1528 12853,1528 12853,1528 12853,1528 12853,1496 12853,1496"];
	comm_stage1_to_stage0 -> l2_res_7	[pos="e,15280,1257.5 11807,1542 12741,1542 15280,1542 15280,1542 15280,1542 15280,1267.5 15280,1267.5"];
	comm_stage0_to_stage1_2	[fillcolor=lightyellow,
		height=0.5,
		label="<b>Pipeline Communication</b><br/>All GPUs 0-7 to All GPUs 8-15<br/>[batch=1024, seq=?, hidden=512]",
		pos="12364,820",
		shape=parallelogram,
		width=11.676];
	l2_ln2_0 -> comm_stage0_to_stage1_2	[pos="e,12770,835 13522,873.96 13522,857.27 13522,835 13522,835 13522,835 12780,835 12780,835"];
	l2_ln2_1 -> comm_stage0_to_stage1_2	[pos="e,12096,834 10496,873.97 10496,856.94 10496,834 10496,834 10496,834 12086,834 12086,834"];
	l2_ln2_2 -> comm_stage0_to_stage1_2	[pos="e,12095,834.07 12095,873.83 12095,873.83 12095,844.07 12095,844.07"];
	l2_ln2_3 -> comm_stage0_to_stage1_2	[pos="e,12106,836 11230,873.97 11230,857.6 11230,836 11230,836 11230,836 12096,836 12096,836"];
	l2_ln2_4 -> comm_stage0_to_stage1_2	[pos="e,12633,838.41 12633,873.83 12633,873.83 12633,848.41 12633,848.41"];
	l2_ln2_5 -> comm_stage0_to_stage1_2	[pos="e,12087,832 9332.5,874 9332.5,856.32 9332.5,832 9332.5,832 9332.5,832 12077,832 12077,832"];
	l2_ln2_6 -> comm_stage0_to_stage1_2	[pos="e,12742,829 15488,873.78 15488,855.17 15488,829 15488,829 15488,829 12752,829 12752,829"];
	l2_ln2_7 -> comm_stage0_to_stage1_2	[pos="e,12756,832 14658,874 14658,856.32 14658,832 14658,832 14658,832 12766,832 12766,832"];
	comm_stage0_to_stage1_2 -> l3_q_proj_0	[pos="e,12149,765.09 12149,801.96 12149,801.96 12149,775.09 12149,775.09"];
	comm_stage0_to_stage1_2 -> l3_k_proj_0	[pos="e,13042,765.03 12627,805 12817,805 13042,805 13042,805 13042,805 13042,775.03 13042,775.03"];
	comm_stage0_to_stage1_2 -> l3_v_proj_0	[pos="e,12579,765.09 12579,801.96 12579,801.96 12579,775.09 12579,775.09"];
	comm_stage0_to_stage1_2 -> l3_res_0	[pos="e,14276,533.09 12655,811 13190,811 14276,811 14276,811 14276,811 14276,543.09 14276,543.09"];
	comm_stage0_to_stage1_2 -> l3_q_proj_1	[pos="e,5853.8,765.29 12034,821 10711,821 5853.8,821 5853.8,821 5853.8,821 5853.8,775.29 5853.8,775.29"];
	comm_stage0_to_stage1_2 -> l3_k_proj_1	[pos="e,5047.2,765.01 12044,823 10634,823 5047.2,823 5047.2,823 5047.2,823 5047.2,775.01 5047.2,775.01"];
	comm_stage0_to_stage1_2 -> l3_v_proj_1	[pos="e,4405.2,765.09 12054,825 10585,825 4405.2,825 4405.2,825 4405.2,825 4405.2,775.09 4405.2,775.09"];
	comm_stage0_to_stage1_2 -> l3_res_1	[pos="e,10446,543.22 11968,807 11406,807 10446,807 10446,807 10446,807 10446,553.22 10446,553.22"];
	comm_stage0_to_stage1_2 -> l3_q_proj_2	[pos="e,8353.9,765.31 12001,814 11014,814 8353.9,814 8353.9,814 8353.9,814 8353.9,775.31 8353.9,775.31"];
	comm_stage0_to_stage1_2 -> l3_k_proj_2	[pos="e,9644,765.17 11987,811 11239,811 9644,811 9644,811 9644,811 9644,775.17 9644,775.17"];
	comm_stage0_to_stage1_2 -> l3_v_proj_2	[pos="e,9027,765.11 11991,812 11121,812 9027,812 9027,812 9027,812 9027,775.11 9027,775.11"];
	comm_stage0_to_stage1_2 -> l3_res_2	[pos="e,12363,548.7 12363,801.92 12363,801.92 12363,558.7 12363,558.7"];
	comm_stage0_to_stage1_2 -> l3_q_proj_3	[pos="e,7755.2,765.13 12010,816 10932,816 7755.2,816 7755.2,816 7755.2,816 7755.2,775.13 7755.2,775.13"];
	comm_stage0_to_stage1_2 -> l3_k_proj_3	[pos="e,7130.2,765.28 12020,818 10855,818 7130.2,818 7130.2,818 7130.2,818 7130.2,775.28 7130.2,775.28"];
	comm_stage0_to_stage1_2 -> l3_v_proj_3	[pos="e,6314.8,765.04 12030,820 10761,820 6314.8,820 6314.8,820 6314.8,820 6314.8,775.04 6314.8,775.04"];
	comm_stage0_to_stage1_2 -> l3_res_3	[pos="e,11723,535.18 12360,801.79 12360,741.91 12360,555 12360,555 12360,555 11723,555 11723,555 11723,555 11723,545.18 11723,545.18"];
	comm_stage0_to_stage1_2 -> l3_q_proj_4	[pos="e,11686,765.03 11948,803 11808,803 11686,803 11686,803 11686,803 11686,775.03 11686,775.03"];
	comm_stage0_to_stage1_2 -> l3_k_proj_4	[pos="e,10925,765.03 11958,805 11532,805 10925,805 10925,805 10925,805 10925,775.03 10925,775.03"];
	comm_stage0_to_stage1_2 -> l3_v_proj_4	[pos="e,10190,765.27 11977,809 11352,809 10190,809 10190,809 10190,809 10190,775.27 10190,775.27"];
	comm_stage0_to_stage1_2 -> l3_res_4	[pos="e,13075,533.86 12366,801.78 12366,754.23 12366,630 12366,630 12366,630 13075,630 13075,630 13075,630 13075,543.86 13075,543.86"];
	comm_stage0_to_stage1_2 -> l3_q_proj_5	[pos="e,2493.8,765.01 12077,830 10454,830 2493.8,830 2493.8,830 2493.8,830 2493.8,775.01 2493.8,775.01"];
	comm_stage0_to_stage1_2 -> l3_k_proj_5	[pos="e,3947,765.15 12063,827 10561,827 3947,827 3947,827 3947,827 3947,775.15 3947,775.15"];
	comm_stage0_to_stage1_2 -> l3_v_proj_5	[pos="e,3215.8,765.2 12073,829 10512,829 3215.8,829 3215.8,829 3215.8,829 3215.8,775.2 3215.8,775.2"];
	comm_stage0_to_stage1_2 -> l3_res_5	[pos="e,9527.8,538.5 12358,801.89 12358,745.84 12358,579 12358,579 12358,579 9527.8,579 9527.8,579 9527.8,579 9527.8,548.5 9527.8,548.5"];
	comm_stage0_to_stage1_2 -> l3_q_proj_6	[pos="e,17085,765.32 12727,826 13833,826 17085,826 17085,826 17085,826 17085,775.32 17085,775.32"];
	comm_stage0_to_stage1_2 -> l3_k_proj_6	[pos="e,16372,765.01 12713,823 13688,823 16372,823 16372,823 16372,823 16372,775.01 16372,775.01"];
	comm_stage0_to_stage1_2 -> l3_v_proj_6	[pos="e,15793,765.04 12698,820 13561,820 15793,820 15793,820 15793,820 15793,775.04 15793,775.04"];
	comm_stage0_to_stage1_2 -> l3_res_6	[pos="e,16362,533.03 12371,801.92 12371,757.76 12371,648 12371,648 12371,648 16362,648 16362,648 16362,648 16362,543.03 16362,543.03"];
	comm_stage0_to_stage1_2 -> l3_q_proj_7	[pos="e,14964,765.03 12684,817 13379,817 14964,817 14964,817 14964,817 14964,775.03 14964,775.03"];
	comm_stage0_to_stage1_2 -> l3_k_proj_7	[pos="e,14346,765.31 12670,814 13226,814 14346,814 14346,814 14346,814 14346,775.31 14346,775.31"];
	comm_stage0_to_stage1_2 -> l3_v_proj_7	[pos="e,13827,765.3 12641,808 13065,808 13827,808 13827,808 13827,808 13827,775.3 13827,775.3"];
	comm_stage0_to_stage1_2 -> l3_res_7	[pos="e,15273,531.69 12368,801.98 12368,756.2 12368,639 12368,639 12368,639 15273,639 15273,639 15273,639 15273,541.69 15273,541.69"];
	l3_ln2_0 -> output_0	[pos="e,14259,108.03 14259,152.62 14259,152.62 14259,118.03 14259,118.03"];
	l3_ln2_1 -> output_1	[pos="e,11555,108.38 11109,171 11316,171 11555,171 11555,171 11555,171 11555,118.38 11555,118.38"];
	l3_ln2_2 -> output_2	[pos="e,12914,108.03 12914,152.62 12914,152.62 12914,118.03 12914,118.03"];
	l3_ln2_3 -> output_3	[pos="e,12161,108.03 12161,152.62 12161,152.62 12161,118.03 12161,118.03"];
	l3_ln2_4 -> output_4	[pos="e,13643,108.03 13643,152.62 13643,152.62 13643,118.03 13643,118.03"];
	l3_ln2_5 -> output_5	[pos="e,10874,90 9872,152.62 9872,128.72 9872,90 9872,90 9872,90 10864,90 10864,90"];
	l3_ln2_6 -> output_6	[pos="e,15763,108.03 15763,152.62 15763,152.62 15763,118.03 15763,118.03"];
	l3_ln2_7 -> output_7	[pos="e,15146,108.03 15146,152.62 15146,152.62 15146,118.03 15146,118.03"];
	output	[fillcolor=lightblue,
		height=0.5,
		label="<b>Final Output</b><br/>Input: [batch=1024, seq=?, vocab=32000]<br/>Output: [batch=1024, seq=?, vocab=32000]",
		pos="13333,18",
		shape=ellipse,
		width=8.601];
	output_0 -> output	[pos="e,13601,27 14258,71.778 14258,53.171 14258,27 14258,27 14258,27 13611,27 13611,27"];
	output_1 -> output	[pos="e,13023,18 11790,71.831 11790,50.502 11790,18 11790,18 11790,18 13013,18 13013,18"];
	output_2 -> output	[pos="e,13174,33.479 13174,71.831 13174,71.831 13174,43.479 13174,43.479"];
	output_3 -> output	[pos="e,13065,27 12406,71.778 12406,53.171 12406,27 12406,27 12406,27 13055,27 13055,27"];
	output_4 -> output	[pos="e,13492,33.479 13492,71.831 13492,71.831 13492,43.479 13492,43.479"];
	output_5 -> output	[pos="e,13065,9 11174,71.62 11174,47.721 11174,9 11174,9 11174,9 13055,9 13055,9"];
	output_6 -> output	[pos="e,13601,9 15492,71.62 15492,47.721 15492,9 15492,9 15492,9 13611,9 13611,9"];
	output_7 -> output	[pos="e,13643,18 14874,71.831 14874,50.502 14874,18 14874,18 14874,18 13653,18 13653,18"];
	allreduce_0_q_proj	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="9763,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_0_k_proj	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="10421,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_0_v_proj	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="11079,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_0_out_proj	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="11737,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_0_ffn_up	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="12395,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_0_ffn_down	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="13053,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_1_q_proj	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="13711,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_1_k_proj	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="14369,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_1_v_proj	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="15027,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_1_out_proj	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="15685,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_1_ffn_up	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="16343,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_1_ffn_down	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="17001,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_2_q_proj	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="17659,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_2_k_proj	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="18317,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_2_v_proj	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="18975,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_2_out_proj	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="19633,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_2_ffn_up	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="20291,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_2_ffn_down	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="20949,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_3_q_proj	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="21607,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_3_k_proj	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="22265,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_3_v_proj	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="22923,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_3_out_proj	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="23581,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_3_ffn_up	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="24239,3136",
		shape=parallelogram,
		width=8.8946];
	allreduce_3_ffn_down	[fillcolor=lightyellow,
		height=0.5,
		label="<b>All-Reduce</b><br/>TP across 8 GPUs<br/>[batch=1024, seq=?, dim=4096]",
		pos="24897,3136",
		shape=parallelogram,
		width=8.8946];
}
