{
  "models": {
    "baseline": {
      "name": "4-layer-dense-baseline",
      "type": "static-parallel",
      "configuration": {
        "layers": 4,
        "hidden_dim": 4096,
        "attention_heads": 32,
        "ffn_dim": 16384,
        "vocab_size": 32000,
        "max_seq_len": 32768,
        "batch_size": 1024,
        "parameters": "13B"
      },
      "parallel_strategy": {
        "type": "tensor-pipeline-parallel",
        "tensor_parallel": {
          "degree": 8,
          "partition_method": "row-column-split",
          "communication": "all-reduce"
        },
        "pipeline_parallel": {
          "degree": 2,
          "stages": 2,
          "micro_batches": 4
        }
      },
      "device_mapping": {
        "total_gpus": 16,
        "devices": [
          {"device_id": "gpu_0", "type": "A100-80GB", "role": "pipeline_stage_0_tensor_0", "memory": 80},
          {"device_id": "gpu_1", "type": "A100-80GB", "role": "pipeline_stage_0_tensor_1", "memory": 80},
          {"device_id": "gpu_2", "type": "A100-80GB", "role": "pipeline_stage_0_tensor_2", "memory": 80},
          {"device_id": "gpu_3", "type": "A100-80GB", "role": "pipeline_stage_0_tensor_3", "memory": 80},
          {"device_id": "gpu_4", "type": "A100-80GB", "role": "pipeline_stage_0_tensor_4", "memory": 80},
          {"device_id": "gpu_5", "type": "A100-80GB", "role": "pipeline_stage_0_tensor_5", "memory": 80},
          {"device_id": "gpu_6", "type": "A100-80GB", "role": "pipeline_stage_0_tensor_6", "memory": 80},
          {"device_id": "gpu_7", "type": "A100-80GB", "role": "pipeline_stage_0_tensor_7", "memory": 80},
          {"device_id": "gpu_8", "type": "A100-80GB", "role": "pipeline_stage_1_tensor_0", "memory": 80},
          {"device_id": "gpu_9", "type": "A100-80GB", "role": "pipeline_stage_1_tensor_1", "memory": 80},
          {"device_id": "gpu_10", "type": "A100-80GB", "role": "pipeline_stage_1_tensor_2", "memory": 80},
          {"device_id": "gpu_11", "type": "A100-80GB", "role": "pipeline_stage_1_tensor_3", "memory": 80},
          {"device_id": "gpu_12", "type": "A100-80GB", "role": "pipeline_stage_1_tensor_4", "memory": 80},
          {"device_id": "gpu_13", "type": "A100-80GB", "role": "pipeline_stage_1_tensor_5", "memory": 80},
          {"device_id": "gpu_14", "type": "A100-80GB", "role": "pipeline_stage_1_tensor_6", "memory": 80},
          {"device_id": "gpu_15", "type": "A100-80GB", "role": "pipeline_stage_1_tensor_7", "memory": 80}
        ]
      },
      "modules": {
        "embedding": {
          "type": "token_embedding",
          "dimensions": [32000, 4096],
          "devices": ["gpu_0", "gpu_1", "gpu_2", "gpu_3", "gpu_4", "gpu_5", "gpu_6", "gpu_7"],
          "parallel_strategy": "tensor_parallel_row_split"
        },
        "layer_0": {
          "attention": {
            "type": "multi_head_attention",
            "heads": 32,
            "head_dim": 128,
            "devices": ["gpu_0", "gpu_1", "gpu_2", "gpu_3", "gpu_4", "gpu_5", "gpu_6", "gpu_7"],
            "parallel_strategy": "tensor_parallel_column_row_split"
          },
          "ffn": {
            "type": "feed_forward",
            "input_dim": 4096,
            "hidden_dim": 16384,
            "output_dim": 4096,
            "devices": ["gpu_0", "gpu_1", "gpu_2", "gpu_3", "gpu_4", "gpu_5", "gpu_6", "gpu_7"],
            "parallel_strategy": "tensor_parallel_column_row_split"
          }
        },
        "layer_1": {
          "attention": {
            "type": "multi_head_attention",
            "heads": 32,
            "head_dim": 128,
            "devices": ["gpu_0", "gpu_1", "gpu_2", "gpu_3", "gpu_4", "gpu_5", "gpu_6", "gpu_7"],
            "parallel_strategy": "tensor_parallel_column_row_split"
          },
          "ffn": {
            "type": "feed_forward",
            "input_dim": 4096,
            "hidden_dim": 16384,
            "output_dim": 4096,
            "devices": ["gpu_0", "gpu_1", "gpu_2", "gpu_3", "gpu_4", "gpu_5", "gpu_6", "gpu_7"],
            "parallel_strategy": "tensor_parallel_column_row_split"
          }
        },
        "layer_2": {
          "attention": {
            "type": "multi_head_attention",
            "heads": 32,
            "head_dim": 128,
            "devices": ["gpu_8", "gpu_9", "gpu_10", "gpu_11", "gpu_12", "gpu_13", "gpu_14", "gpu_15"],
            "parallel_strategy": "tensor_parallel_column_row_split"
          },
          "ffn": {
            "type": "feed_forward",
            "input_dim": 4096,
            "hidden_dim": 16384,
            "output_dim": 4096,
            "devices": ["gpu_8", "gpu_9", "gpu_10", "gpu_11", "gpu_12", "gpu_13", "gpu_14", "gpu_15"],
            "parallel_strategy": "tensor_parallel_column_row_split"
          }
        },
        "layer_3": {
          "attention": {
            "type": "multi_head_attention",
            "heads": 32,
            "head_dim": 128,
            "devices": ["gpu_8", "gpu_9", "gpu_10", "gpu_11", "gpu_12", "gpu_13", "gpu_14", "gpu_15"],
            "parallel_strategy": "tensor_parallel_column_row_split"
          },
          "ffn": {
            "type": "feed_forward",
            "input_dim": 4096,
            "hidden_dim": 16384,
            "output_dim": 4096,
            "devices": ["gpu_8", "gpu_9", "gpu_10", "gpu_11", "gpu_12", "gpu_13", "gpu_14", "gpu_15"],
            "parallel_strategy": "tensor_parallel_column_row_split"
          }
        },
        "output_layer": {
          "type": "linear_output",
          "dimensions": [4096, 32000],
          "devices": ["gpu_8", "gpu_9", "gpu_10", "gpu_11", "gpu_12", "gpu_13", "gpu_14", "gpu_15"],
          "parallel_strategy": "tensor_parallel_row_split"
        }
      }
    },
    "fa_pool": {
      "name": "4-layer-dense-fa-pool",
      "type": "dynamic-parallel",
      "configuration": {
        "layers": 4,
        "hidden_dim": 4096,
        "attention_heads": 32,
        "ffn_dim": 16384,
        "vocab_size": 32000,
        "max_seq_len": 32768,
        "batch_size": 1024,
        "parameters": "13B",
        "sequence_threshold": 4096,
        "max_attention_pool": 32
      },
      "parallel_strategy": {
        "type": "fa-pool-dynamic",
        "base_layer": {
          "gpus": 8,
          "tensor_parallel": {
            "degree": 8,
            "partition_method": "row-column-split"
          },
          "components": ["embedding", "positional_encoding", "ffn_layers", "output_layer"]
        },
        "attention_pool": {
          "type": "dynamic_attention_computation",
          "max_gpus": 32,
          "allocation_strategy": "sequence_length_based",
          "block_size_calculation": "ceil(sequence_length / num_pool_gpus)",
          "communication": "hierarchical_reduction"
        }
      },
      "device_mapping": {
        "base_layer_devices": [
          {"device_id": "base_gpu_0", "type": "A100-80GB", "role": "base_layer_tensor_0", "memory": 80, "utilization": 65},
          {"device_id": "base_gpu_1", "type": "A100-80GB", "role": "base_layer_tensor_1", "memory": 80, "utilization": 65},
          {"device_id": "base_gpu_2", "type": "A100-80GB", "role": "base_layer_tensor_2", "memory": 80, "utilization": 65},
          {"device_id": "base_gpu_3", "type": "A100-80GB", "role": "base_layer_tensor_3", "memory": 80, "utilization": 65},
          {"device_id": "base_gpu_4", "type": "A100-80GB", "role": "base_layer_tensor_4", "memory": 80, "utilization": 65},
          {"device_id": "base_gpu_5", "type": "A100-80GB", "role": "base_layer_tensor_5", "memory": 80, "utilization": 65},
          {"device_id": "base_gpu_6", "type": "A100-80GB", "role": "base_layer_tensor_6", "memory": 80, "utilization": 65},
          {"device_id": "base_gpu_7", "type": "A100-80GB", "role": "base_layer_tensor_7", "memory": 80, "utilization": 65}
        ],
        "attention_pool_devices": [
          {"device_id": "pool_gpu_0", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_1", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_2", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_3", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_4", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_5", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_6", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_7", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_8", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_9", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_10", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_11", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_12", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_13", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_14", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_15", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_16", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_17", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_18", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_19", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_20", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_21", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_22", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_23", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_24", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_25", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_26", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_27", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_28", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_29", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_30", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false},
          {"device_id": "pool_gpu_31", "type": "A100-80GB", "role": "attention_computation", "memory": 80, "utilization": 45, "activated": false}
        ]
      },
      "modules": {
        "embedding": {
          "type": "token_embedding",
          "dimensions": [32000, 4096],
          "devices": ["base_gpu_0", "base_gpu_1", "base_gpu_2", "base_gpu_3", "base_gpu_4", "base_gpu_5", "base_gpu_6", "base_gpu_7"],
          "parallel_strategy": "tensor_parallel_row_split",
          "memory_per_device": 65
        },
        "positional_encoding": {
          "type": "rope_embedding",
          "dimensions": [32768, 4096],
          "devices": ["base_gpu_0", "base_gpu_1", "base_gpu_2", "base_gpu_3", "base_gpu_4", "base_gpu_5", "base_gpu_6", "base_gpu_7"],
          "parallel_strategy": "tensor_parallel_row_split",
          "memory_per_device": 65
        },
        "layer_0": {
          "attention": {
            "type": "multi_head_attention_flash",
            "heads": 32,
            "head_dim": 128,
            "attention_type": "scaled_dot_product",
            "devices_dynamic": {
              "sequence_length_thresholds": {
                "<4096": ["base_gpu_0", "base_gpu_1", "base_gpu_2", "base_gpu_3", "base_gpu_4", "base_gpu_5", "base_gpu_6", "base_gpu_7"],
                "4096-8192": ["pool_gpu_0", "pool_gpu_1", "pool_gpu_2", "pool_gpu_3", "pool_gpu_4", "pool_gpu_5", "pool_gpu_6", "pool_gpu_7"],
                "8192-16384": ["pool_gpu_0", "pool_gpu_1", "pool_gpu_2", "pool_gpu_3", "pool_gpu_4", "pool_gpu_5", "pool_gpu_6", "pool_gpu_7", "pool_gpu_8", "pool_gpu_9", "pool_gpu_10", "pool_gpu_10", "pool_gpu_11", "pool_gpu_12", "pool_gpu_13", "pool_gpu_14", "pool_gpu_15"],
                ">16384": ["pool_gpu_0", "pool_gpu_1", "pool_gpu_2", "pool_gpu_3", "pool_gpu_4", "pool_gpu_5", "pool_gpu_6", "pool_gpu_7", "pool_gpu_8", "pool_gpu_9", "pool_gpu_10", "pool_gpu_11", "pool_gpu_12", "pool_gpu_13", "pool_gpu_14", "pool_gpu_15", "pool_gpu_16", "pool_gpu_17", "pool_gpu_18", "pool_gpu_19", "pool_gpu_20", "pool_gpu_21", "pool_gpu_22", "pool_gpu_23"]
              }
            },
            "block_size_calculation": "ceil(sequence_length / num_attention_gpus)",
            "memory_per_device": 45
          },
          "ffn": {
            "type": "feed_forward",
            "input_dim": 4096,
            "hidden_dim": 16384,
            "output_dim": 4096,
            "activation": "gelu",
            "devices": ["base_gpu_0", "base_gpu_1", "base_gpu_2", "base_gpu_3", "base_gpu_4", "base_gpu_5", "base_gpu_6", "base_gpu_7"],
            "parallel_strategy": "tensor_parallel_column_row_split",
            "memory_per_device": 65
          }
        },
        "layer_1": {
          "attention": {
            "type": "multi_head_attention_flash",
            "heads": 32,
            "head_dim": 128,
            "attention_type": "scaled_dot_product",
            "devices_dynamic": {
              "sequence_length_thresholds": {
                "<4096": ["base_gpu_0", "base_gpu_1", "base_gpu_2", "base_gpu_3", "base_gpu_4", "base_gpu_5", "base_gpu_6", "base_gpu_7"],
                "4096-8192": ["pool_gpu_0", "pool_gpu_1", "pool_gpu_2", "pool_gpu_3", "pool_gpu_4", "pool_gpu_5", "pool_gpu_6", "pool_gpu_7"],
                "8192-16384": ["pool_gpu_0", "pool_gpu_1", "pool_gpu_2", "pool_gpu_3", "pool_gpu_4", "pool_gpu_5", "pool_gpu_6", "pool_gpu_7", "pool_gpu_8", "pool_gpu_9", "pool_gpu_10", "pool_gpu_11", "pool_gpu_12", "pool_gpu_13", "pool_gpu_14", "pool_gpu_15"],
                ">16384": ["pool_gpu_0", "pool_gpu_1", "pool_gpu_2", "pool_gpu_3", "pool_gpu_4", "pool_gpu_5", "pool_gpu_6", "pool_gpu_7", "pool_gpu_8", "pool_gpu_9", "pool_gpu_10", "pool_gpu_11", "pool_gpu_12", "pool_gpu_13", "pool_gpu_14", "pool_gpu_15", "pool_gpu_16", "pool_gpu_17", "pool_gpu_18", "pool_gpu_19", "pool_gpu_20", "pool_gpu_21", "pool_gpu_22", "pool_gpu_23"]
              }
            },
            "block_size_calculation": "ceil(sequence_length / num_attention_gpus)",
            "memory_per_device": 45
          },
          "ffn": {
            "type": "feed_forward",
            "input_dim": 4096,
            "hidden_dim": 16384,
            "output_dim": 4096,
            "activation": "gelu",
            "devices": ["base_gpu_0", "base_gpu_1", "base_gpu_2", "base_gpu_3", "base_gpu_4", "base_gpu_5", "base_gpu_6", "base_gpu_7"],
            "parallel_strategy": "tensor_parallel_column_row_split",
            "memory_per_device": 65
          }
        },
        "layer_2": {
          "attention": {
            "type": "multi_head_attention_flash",
            "heads": 32,
            "head_dim": 128,
            "attention_type": "scaled_dot_product",
            "devices_dynamic": {
              "sequence_length_thresholds": {
                "<4096": ["base_gpu_0", "base_gpu_1", "base_gpu_2", "base_gpu_3", "base_gpu_4", "base_gpu_5", "base_gpu_6", "base_gpu_7"],
                "4096-8192": ["pool_gpu_0", "pool_gpu_1", "pool_gpu_2", "pool_gpu_3", "pool_gpu_4", "pool_gpu_5", "pool_gpu_6", "pool_gpu_7"],
                "8192-16384": ["pool_gpu_0", "pool_gpu_1", "pool_gpu_2", "pool_gpu_3", "pool_gpu_4", "pool_gpu_5", "pool_gpu_6", "pool_gpu_7", "pool_gpu_8", "pool_gpu_9", "pool_gpu_10", "pool_gpu_11", "pool_gpu_12", "pool_gpu_13", "pool_gpu_14", "pool_gpu_15"],
                ">16384": ["pool_gpu_0", "pool_gpu_1", "pool_gpu_2", "pool_gpu_3", "pool_gpu_4", "pool_gpu_5", "pool_gpu_6", "pool_gpu_7", "pool_gpu_8", "pool_gpu_9", "pool_gpu_10", "pool_gpu_11", "pool_gpu_12", "pool_gpu_13", "pool_gpu_14", "pool_gpu_15", "pool_gpu_16", "pool_gpu_17", "pool_gpu_18", "pool_gpu_19", "pool_gpu_20", "pool_gpu_21", "pool_gpu_22", "pool_gpu_23"]
              }
            },
            "block_size_calculation": "ceil(sequence_length / num_attention_gpus)",
            "memory_per_device": 45
          },
          "ffn": {
            "type": "feed_forward",
            "input_dim": 4096,
            "hidden_dim": 16384,
            "output_dim": 4096,
            "activation": "gelu",
            "devices": ["base_gpu_0", "base_gpu_1", "base_gpu_2", "base_gpu_3", "base_gpu_4", "base_gpu_5", "base_gpu_6", "base_gpu_7"],
            "parallel_strategy": "tensor_parallel_column_row_split",
            "memory_per_device": 65
          }
        },
        "layer_3": {
          "attention": {
            "type": "multi_head_attention_flash",
            "heads": 32,
            "head_dim": 128,
            "attention_type": "scaled_dot_product",
            "devices_dynamic": {
              "sequence_length_thresholds": {
                "<4096": ["base_gpu_0", "base_gpu_1", "base_gpu_2", "base_gpu_3", "base_gpu_4", "base_gpu_5", "base_gpu_6", "base_gpu_7"],
                "4096-8192": ["pool_gpu_0", "pool_gpu_1", "pool_gpu_2", "pool_gpu_3", "pool_gpu_4", "pool_gpu_5", "pool_gpu_6", "pool_gpu_7"],
                "8192-16384": ["pool_gpu_0", "pool_gpu_1", "pool_gpu_2", "pool_gpu_3", "pool_gpu_4", "pool_gpu_5", "pool_gpu_6", "pool_gpu_7", "pool_gpu_8", "pool_gpu_9", "pool_gpu_10", "pool_gpu_11", "pool_gpu_12", "pool_gpu_13", "pool_gpu_14", "pool_gpu_15"],
                ">16384": ["pool_gpu_0", "pool_gpu_1", "pool_gpu_2", "pool_gpu_3", "pool_gpu_4", "pool_gpu_5", "pool_gpu_6", "pool_gpu_7", "pool_gpu_8", "pool_gpu_9", "pool_gpu_10", "pool_gpu_11", "pool_gpu_12", "pool_gpu_13", "pool_gpu_14", "pool_gpu_15", "pool_gpu_16", "pool_gpu_17", "pool_gpu_18", "pool_gpu_19", "pool_gpu_20", "pool_gpu_21", "pool_gpu_22", "pool_gpu_23"]
              }
            },
            "block_size_calculation": "ceil(sequence_length / num_attention_gpus)",
            "memory_per_device": 45
          },
          "ffn": {
            "type": "feed_forward",
            "input_dim": 4096,
            "hidden_dim": 16384,
            "output_dim": 4096,
            "activation": "gelu",
            "devices": ["base_gpu_0", "base_gpu_1", "base_gpu_2", "base_gpu_3", "base_gpu_4", "base_gpu_5", "base_gpu_6", "base_gpu_7"],
            "parallel_strategy": "tensor_parallel_column_row_split",
            "memory_per_device": 65
          }
        },
        "output_layer": {
          "type": "linear_output",
          "dimensions": [4096, 32000],
          "devices": ["base_gpu_0", "base_gpu_1", "base_gpu_2", "base_gpu_3", "base_gpu_4", "base_gpu_5", "base_gpu_6", "base_gpu_7"],
          "parallel_strategy": "tensor_parallel_row_split",
          "memory_per_device": 65
        }
      },
      "communication": {
        "intra_node": {
          "type": "nvlink_3_0",
          "bandwidth": "600_gb_per_sec"
        },
        "inter_node": {
          "type": "infiniband_hdr",
          "bandwidth": "200_gb_per_sec"
        },
        "optimization": {
          "kv_cache_sharing": true,
          "hierarchical_reduction": true,
          "asynchronous_execution": true,
          "overlap_efficiency": 0.85
        }
      },
      "resource_manager": {
        "monitoring": "continuous_sequence_length",
        "threshold": 4096,
        "allocation_policy": "greedy_based_on_sequence_length",
        "deallocation_policy": "lazy_release_after_batch_completion",
        "communication_overhead_limit": 0.15
      }
    }
  },
  "hardware_requirements": {
    "gpu_model": "NVIDIA_A100_80GB",
    "cpu": "AMD_EPYC_7763",
    "memory": "2TB_DDR4",
    "storage": "NVMe_SSD_array",
    "interconnect": {
      "nvlink": "3.0",
      "infiniband": "HDR"
    }
  }
}